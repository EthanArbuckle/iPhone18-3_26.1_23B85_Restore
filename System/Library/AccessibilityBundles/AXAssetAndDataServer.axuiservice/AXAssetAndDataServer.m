void sub_1BAC(void *a1, int a2, void *a3)
{
  v5 = a3;
  if (v5)
  {
    v6 = AXLogCommon();
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 67109378;
      v9 = a2;
      v10 = 2112;
      v11 = v5;
      _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "Requested authorization to send notification for accessibility moments: %d %@", buf, 0x12u);
    }
  }

  v7 = a1[10];
  [objc_opt_class() _sendUserNotification:a1[4] title:a1[5] subtitle:a1[6] message:a1[7] threadIdentifier:@"teachable-moments" teachableItems:a1[8] feature:a1[9]];
}

void sub_1E80(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_2570(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_2594(uint64_t a1, void *a2)
{
  v3 = a2;
  if (v3)
  {
    v4 = AXLogCommon();
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      sub_5ABC(v3, v4);
    }
  }

  else
  {
    [AXTeachableMomentsManager markTeachableMomentSeenForNotification:*(a1 + 32)];
  }
}

void sub_2604(uint64_t a1)
{
  sub_265C();
  *(*(*(a1 + 32) + 8) + 24) = objc_getClass("UNUserNotificationCenter");
  if (*(*(*(a1 + 32) + 8) + 24))
  {
    qword_111A8 = *(*(*(a1 + 32) + 8) + 24);
  }

  else
  {
    sub_5B34();
    sub_265C();
  }
}

void sub_265C()
{
  v1[0] = 0;
  if (!qword_111B0)
  {
    v1[1] = _NSConcreteStackBlock;
    v1[2] = 3221225472;
    v1[3] = sub_2758;
    v1[4] = &unk_C4D0;
    v1[5] = v1;
    v2 = off_C4B8;
    v3 = 0;
    qword_111B0 = _sl_dlopen();
  }

  v0 = v1[0];
  if (!qword_111B0)
  {
    v0 = abort_report_np();
    goto LABEL_7;
  }

  if (v1[0])
  {
LABEL_7:
    free(v0);
  }
}

uint64_t sub_2758(uint64_t a1)
{
  v1 = *(a1 + 32);
  result = _sl_dlopen();
  qword_111B0 = result;
  return result;
}

Class sub_27CC(uint64_t a1)
{
  sub_265C();
  result = objc_getClass("UNNotificationCategory");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (*(*(*(a1 + 32) + 8) + 24))
  {
    qword_111B8 = *(*(*(a1 + 32) + 8) + 24);
  }

  else
  {
    v3 = sub_5B5C();
    return sub_2824(v3);
  }

  return result;
}

Class sub_2824(uint64_t a1)
{
  sub_265C();
  result = objc_getClass("UNMutableNotificationContent");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (*(*(*(a1 + 32) + 8) + 24))
  {
    qword_111C0 = *(*(*(a1 + 32) + 8) + 24);
  }

  else
  {
    v3 = sub_5B84();
    return sub_287C(v3);
  }

  return result;
}

Class sub_287C(uint64_t a1)
{
  sub_265C();
  result = objc_getClass("UNNotificationRequest");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (*(*(*(a1 + 32) + 8) + 24))
  {
    qword_111C8 = *(*(*(a1 + 32) + 8) + 24);
  }

  else
  {
    v3 = sub_5BAC();
    return +[(AXAssetAndDataServer *)v3];
  }

  return result;
}

uint64_t sub_2974(uint64_t a1)
{
  qword_111D0 = objc_alloc_init(*(a1 + 32));

  return _objc_release_x1();
}

void sub_2B5C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, id location)
{
  objc_destroyWeak((v14 + 32));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_2B7C(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _icloudDataChanged:0];
}

void sub_2E00(_Unwind_Exception *exception_object, int a2)
{
  if (a2 == 1)
  {
    v2 = objc_begin_catch(exception_object);
    v3 = VOTLogICloud();
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      sub_5C3C();
    }

    if (!AXIsInternalInstall())
    {

      objc_end_catch();
      JUMPOUT(0x2DBCLL);
    }

    v4 = v2;
    objc_exception_throw(v2);
  }

  _Unwind_Resume(exception_object);
}

void sub_30CC(_Unwind_Exception *exception_object, int a2)
{
  if (a2 == 1)
  {
    v2 = objc_begin_catch(exception_object);
    v3 = VOTLogActivities();
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      sub_5C3C();
    }

    if (!AXIsInternalInstall())
    {

      objc_end_catch();
      JUMPOUT(0x3088);
    }

    v4 = v2;
    objc_exception_throw(v2);
  }

  _Unwind_Resume(exception_object);
}

id sub_31DC(uint64_t a1)
{
  v2 = +[NSUbiquitousKeyValueStore defaultStore];
  [v2 synchronize];

  v3 = +[AXSettings sharedInstance];
  v4 = [v3 syncPronunciationsWithCloudKit];

  if ((v4 & 1) == 0)
  {
    [*(a1 + 32) _reconcilePronunciations];
  }

  v5 = *(a1 + 32);

  return [v5 _reconcileActivities];
}

void sub_3D48(uint64_t a1)
{
  v2 = +[AXSettings sharedInstance];
  v3 = [v2 voiceOverActivities];
  v4 = [v3 copy];

  v5 = [NSKeyedArchiver archivedDataWithRootObject:v4 requiringSecureCoding:1 error:0];
  if ([v5 length])
  {
    v6 = +[NSUbiquitousKeyValueStore defaultStore];
    [v6 setData:v5 forKey:@"AXVoiceOverActivities"];

    v7 = +[NSUbiquitousKeyValueStore defaultStore];
    [v7 synchronize];
  }

  else
  {
    v7 = VOTLogActivities();
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      sub_5CA4(v7);
    }
  }

  v8 = VOTLogActivities();
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = *(a1 + 32);
    v10 = 134218243;
    v11 = v9;
    v12 = 2113;
    v13 = v4;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "ICLOUD[%p]: Publishing data to iCloud %{private}@", &v10, 0x16u);
  }
}

id sub_4098(uint64_t a1)
{
  v2 = +[AXSettings sharedInstance];
  v3 = [v2 syncPronunciationsWithCloudKit];

  if (v3)
  {
    return [*(a1 + 32) _syncToWatch];
  }

  v4 = +[AXSettings sharedInstance];
  v5 = [v4 customPronunciationSubstitutions];
  v6 = [v5 copy];

  v7 = [NSKeyedArchiver archivedDataWithRootObject:v6 requiringSecureCoding:1 error:0];
  if ([v7 length])
  {
    v8 = +[NSUbiquitousKeyValueStore defaultStore];
    [v8 setData:v7 forKey:@"AXCustomPronunciations"];

    v9 = +[NSUbiquitousKeyValueStore defaultStore];
    [v9 synchronize];
  }

  else
  {
    v18 = +[AXSubsystemPronunciations sharedInstance];
    v19 = [v18 ignoreLogging];

    if (v19)
    {
      goto LABEL_5;
    }

    v20 = +[AXSubsystemPronunciations identifier];
    v9 = AXLoggerForFacility();

    v21 = AXOSLogLevelFromAXLogLevel();
    if (os_log_type_enabled(v9, v21))
    {
      v22 = AXColorizeFormatLog();
      v23 = _AXStringForArgs();
      if (os_log_type_enabled(v9, v21))
      {
        *buf = 138543362;
        v27 = v23;
        _os_log_impl(&dword_0, v9, v21, "%{public}@", buf, 0xCu);
      }
    }
  }

LABEL_5:
  v10 = +[AXSubsystemPronunciations sharedInstance];
  v11 = [v10 ignoreLogging];

  if ((v11 & 1) == 0)
  {
    v12 = +[AXSubsystemPronunciations identifier];
    v13 = AXLoggerForFacility();

    v14 = AXOSLogLevelFromAXLogLevel();
    if (os_log_type_enabled(v13, v14))
    {
      v15 = AXColorizeFormatLog();
      v24 = *(a1 + 32);
      v25 = v6;
      v16 = _AXStringForArgs();
      if (os_log_type_enabled(v13, v14))
      {
        *buf = 138543362;
        v27 = v16;
        _os_log_impl(&dword_0, v13, v14, "%{public}@", buf, 0xCu);
      }
    }
  }

  return [*(a1 + 32) _syncToWatch];
}

void sub_4660(_Unwind_Exception *a1)
{
  objc_destroyWeak((v1 + 32));
  objc_destroyWeak((v2 - 72));
  _Unwind_Resume(a1);
}

void sub_4690(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _customPronunciationsSettingsChanged];
}

void sub_46D0(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _saveActivitiesToExternalsAndDelete:0];
}

Class sub_56BC(uint64_t a1)
{
  sub_5714();
  result = objc_getClass("CCSIconElementRequest");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_5CE8();
  }

  qword_111E0 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

void sub_5714()
{
  v1[0] = 0;
  if (!qword_111E8)
  {
    v1[1] = _NSConcreteStackBlock;
    v1[2] = 3221225472;
    v1[3] = sub_5810;
    v1[4] = &unk_C4D0;
    v1[5] = v1;
    v2 = off_C5C0;
    v3 = 0;
    qword_111E8 = _sl_dlopen();
  }

  v0 = v1[0];
  if (!qword_111E8)
  {
    v0 = abort_report_np();
    goto LABEL_7;
  }

  if (v1[0])
  {
LABEL_7:
    free(v0);
  }
}

uint64_t sub_5810(uint64_t a1)
{
  v1 = *(a1 + 32);
  result = _sl_dlopen();
  qword_111E8 = result;
  return result;
}

Class sub_5884(uint64_t a1)
{
  sub_5714();
  result = objc_getClass("CCSControlCenterService");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_5D10();
  }

  qword_111F0 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

Class sub_58DC(uint64_t a1)
{
  v4[0] = 0;
  if (!qword_11200)
  {
    v4[1] = _NSConcreteStackBlock;
    v4[2] = 3221225472;
    v4[3] = sub_5A20;
    v4[4] = &unk_C4D0;
    v4[5] = v4;
    v5 = off_C5D8;
    v6 = 0;
    qword_11200 = _sl_dlopen();
    v2 = v4[0];
    if (qword_11200)
    {
      if (!v4[0])
      {
        goto LABEL_4;
      }
    }

    else
    {
      v2 = abort_report_np();
    }

    free(v2);
  }

LABEL_4:
  result = objc_getClass("CBSNVRamUtil");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_5D38();
  }

  qword_111F8 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

uint64_t sub_5A20(uint64_t a1)
{
  v1 = *(a1 + 32);
  result = _sl_dlopen();
  qword_11200 = result;
  return result;
}

void sub_5A94(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, &a9, 0xCu);
}

void sub_5ABC(uint64_t a1, NSObject *a2)
{
  v2 = 138412290;
  v3 = a1;
  _os_log_error_impl(&dword_0, a2, OS_LOG_TYPE_ERROR, "TeachableMoments: Unable to send notification: %@", &v2, 0xCu);
}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "Writing nvram value for startup sound: %d", buf, 8u);
  }

  v8 = 0;
  v9 = &v8;
  v10 = 0x2050000000;
  v4 = qword_111F8;
  v11 = qword_111F8;
  if (!qword_111F8)
  {
    *buf = _NSConcreteStackBlock;
    v13 = 3221225472;
    v14 = sub_58DC;
    v15 = &unk_C498;
    v16 = &v8;
    sub_58DC(buf);
    v4 = v9[3];
  }

  v5 = v4;
  _Block_object_dispose(&v8, 8);
  v6 = +[AXSettings sharedInstance];
  if ([v6 startupSoundEnabled])
  {
    v7 = @"0";
  }

  else
  {
    v7 = @"1";
  }

  [v4 writeNVRamVariable:@"StartupMute" value:v7];
}

- (void)dictationConnection:(id)a3 didRecognizeTranscriptionObjects:(id)a4 languageModel:(id)a5
{
  v6 = [a4 firstObject];
  v7 = +[AXSubsystemPronunciations sharedInstance];
  v8 = [v7 ignoreLogging];

  if ((v8 & 1) == 0)
  {
    v9 = +[AXSubsystemPronunciations identifier];
    v10 = AXLoggerForFacility();

    v11 = AXOSLogLevelFromAXLogLevel();
    if (os_log_type_enabled(v10, v11))
    {
      v12 = AXColorizeFormatLog();
      v21 = v6;
      v13 = _AXStringForArgs();
      if (os_log_type_enabled(v10, v11))
      {
        *buf = 138543362;
        v25 = v13;
        _os_log_impl(&dword_0, v10, v11, "%{public}@", buf, 0xCu);
      }
    }
  }

  v14 = [v6 phonemeSuggestions];
  v15 = v14;
  if (v14)
  {
    v16 = v14;
  }

  else
  {
    v16 = +[NSMutableArray array];
  }

  v17 = v16;

  v18 = [AXUIClientMessenger clientMessengerWithIdentifier:@"AXSpeechPronunciationClient"];
  v22 = @"results";
  v23 = v17;
  v19 = [NSDictionary dictionaryWithObjects:&v23 forKeys:&v22 count:1];
  v20 = +[AXAccessQueue backgroundAccessQueue];
  [v18 sendAsynchronousMessage:v19 withIdentifier:4 targetAccessQueue:v20 completion:&stru_C5A0];

  self->_isRecording = 0;
  [(AFDictationConnection *)self->_dictationConnection endSession];
}

- (void)_handleFailureForSpeechPronunciation:(id)a3
{
  v4 = a3;
  v5 = +[AXSubsystemPronunciations sharedInstance];
  v6 = [v5 ignoreLogging];

  if ((v6 & 1) == 0)
  {
    v7 = +[AXSubsystemPronunciations identifier];
    v8 = AXLoggerForFacility();

    v9 = AXOSLogLevelFromAXLogLevel();
    if (os_log_type_enabled(v8, v9))
    {
      v10 = AXColorizeFormatLog();
      v16 = v4;
      isRecording = self->_isRecording;
      v11 = _AXStringForArgs();
      if (os_log_type_enabled(v8, v9))
      {
        *buf = 138543362;
        v21 = v11;
        _os_log_impl(&dword_0, v8, v9, "%{public}@", buf, 0xCu);
      }
    }
  }

  if (self->_isRecording)
  {
    self->_isRecording = 0;
    if (v4)
    {
      v12 = [v4 description];
    }

    else
    {
      v12 = @"Error";
    }

    v13 = [AXUIClientMessenger clientMessengerWithIdentifier:@"AXSpeechPronunciationClient", v16, isRecording];
    v18 = @"error";
    v19 = v12;
    v14 = [NSDictionary dictionaryWithObjects:&v19 forKeys:&v18 count:1];
    v15 = +[AXAccessQueue backgroundAccessQueue];
    [v13 sendAsynchronousMessage:v14 withIdentifier:4 targetAccessQueue:v15 completion:0];

    [(AFDictationConnection *)self->_dictationConnection endSession];
  }
}

- (void)_startPronunciationSession:(id)a3
{
  v4 = a3;
  if (!self->_isRecording)
  {
    v5 = objc_alloc_init(AFDictationConnection);
    dictationConnection = self->_dictationConnection;
    self->_dictationConnection = v5;

    [(AFDictationConnection *)self->_dictationConnection setDelegate:self];
    v7 = objc_opt_new();
    [v7 setTranscriptionMode:3];
    v8 = [v4 orthography];
    [v7 setOrthography:v8];

    v9 = [[AFSpeechRequestOptions alloc] initWithActivationEvent:4];
    [v9 setIsEyesFree:1];
    [v9 setEndpointerOperationMode:3];
    v10 = self->_dictationConnection;
    v11 = [v4 language];
    [(AFDictationConnection *)v10 startDictationWithLanguageCode:v11 options:v7 speechOptions:v9];

    v12 = +[AXSubsystemPronunciations sharedInstance];
    LOBYTE(v11) = [v12 ignoreLogging];

    if ((v11 & 1) == 0)
    {
      v13 = +[AXSubsystemPronunciations identifier];
      v14 = AXLoggerForFacility();

      v15 = AXOSLogLevelFromAXLogLevel();
      if (os_log_type_enabled(v14, v15))
      {
        v16 = AXColorizeFormatLog();
        v17 = _AXStringForArgs();
        if (os_log_type_enabled(v14, v15))
        {
          *buf = 138543362;
          v19 = v17;
          _os_log_impl(&dword_0, v14, v15, "%{public}@", buf, 0xCu);
        }
      }
    }

    self->_isRecording = 1;
  }
}

@end