@interface VNObservation
+ (id)defaultOriginatingRequestSpecifierForRevision:(unint64_t)revision;
- (BOOL)isEqual:(id)equal;
- (CMTimeRange)timeRange;
- (VNObservation)initWithCoder:(id)coder;
- (VNObservation)initWithOriginatingRequestSpecifier:(id)specifier;
- (VNObservation)initWithRequestRevision:(unint64_t)revision;
- (VNObservation)observationWithOriginatingRequestSpecifier:(id)specifier;
- (id)VNCoreMLTransformerDetectionprintAndReturnError:(id *)error;
- (id)VNCoreMLTransformerSceneprintsAndReturnError:(id *)error;
- (id)VNEntityIdentificationModelPrintWithOriginatingRequestSpecifier:(id)specifier error:(id *)error;
- (id)debugQuickLookObject;
- (id)description;
- (id)getDataDetectorResults:(id *)results;
- (id)getDataDetectorResultsForString:(id)string error:(id *)error;
- (id)vn_cloneObject;
- (unint64_t)hash;
- (unint64_t)requestRevision;
- (void)encodeWithCoder:(id)coder;
- (void)setTimeRange:(id *)range;
@end

@implementation VNObservation

- (id)VNEntityIdentificationModelPrintWithOriginatingRequestSpecifier:(id)specifier error:(id *)error
{
  specifierCopy = specifier;
  if (error)
  {
    v6 = MEMORY[0x1E696AEC0];
    v7 = objc_opt_class();
    v8 = NSStringFromClass(v7);
    specifierCopy = [v6 stringWithFormat:@"%@ does not provide an entity print that is compatible with a print generated by %@", v8, specifierCopy];

    *error = VNEntityIdentificationModelErrorWithLocalizedDescriptionAndUnderlyingError(3, specifierCopy, 0);
  }

  return 0;
}

- (void)setTimeRange:(id *)range
{
  v3 = *&range->var0.var0;
  v4 = *&range->var1.var1;
  *&self->_timeRange.start.epoch = *&range->var0.var3;
  *&self->_timeRange.duration.timescale = v4;
  *&self->_timeRange.start.value = v3;
}

- (CMTimeRange)timeRange
{
  v3 = *&self[1].start.epoch;
  *&retstr->start.value = *&self[1].start.value;
  *&retstr->start.epoch = v3;
  *&retstr->duration.timescale = *&self[1].duration.timescale;
  return self;
}

- (id)debugQuickLookObject
{
  requestImageBuffersCacheKeys = [(VNObservation *)self requestImageBuffersCacheKeys];
  if ([requestImageBuffersCacheKeys count])
  {
    requestImageBuffers = [(VNObservation *)self requestImageBuffers];
    v5 = [requestImageBuffers count];

    if (!v5)
    {
      goto LABEL_9;
    }

    requestImageBuffers2 = [(VNObservation *)self requestImageBuffers];
    requestImageBuffersCacheKeys = [requestImageBuffers2 pointerAtIndex:0];

    requestImageBuffersCacheKeys2 = [(VNObservation *)self requestImageBuffersCacheKeys];
    v8 = [requestImageBuffersCacheKeys2 pointerAtIndex:0];

    v9 = [requestImageBuffersCacheKeys cachedPixelBufferRepresentationForKey:v8];
    v10 = v9;
    if (v9)
    {
      Width = CVPixelBufferGetWidth(v9);
      Height = CVPixelBufferGetHeight(v10);
      v13 = [MEMORY[0x1E695F658] imageWithCVPixelBuffer:v10];
      CVPixelBufferRelease(v10);
      v14 = [MEMORY[0x1E695F620] contextWithOptions:0];
      v15 = [v14 createCGImage:v13 fromRect:{0.0, 0.0, Width, Height}];
      v5 = VNDebugImageFromCGImage(v15);
      CGImageRelease(v15);
    }

    else
    {
      v5 = 0;
    }
  }

  else
  {
    v5 = 0;
  }

LABEL_9:

  return v5;
}

- (id)getDataDetectorResultsForString:(id)string error:(id *)error
{
  v27 = *MEMORY[0x1E69E9840];
  stringCopy = string;
  v25 = 0;
  v7 = DDScannerCreate();
  v8 = 0;
  if (v7)
  {
    if (DDScannerScanString())
    {
      v11 = DDScannerCopyResultsWithOptions();
      CFRelease(v7);
      if (v11)
      {
        Count = CFArrayGetCount(v11);
        v8 = [MEMORY[0x1E6999A80] resultsFromCoreResults:v11];
        CFRelease(v11);
        if (Count < 1)
        {
          v9 = 0;
        }

        else
        {
          v9 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:Count];
          v23 = 0u;
          v24 = 0u;
          v21 = 0u;
          v22 = 0u;
          v13 = v8;
          v14 = [v13 countByEnumeratingWithState:&v21 objects:v26 count:16];
          if (v14)
          {
            v15 = *v22;
            do
            {
              for (i = 0; i != v14; ++i)
              {
                if (*v22 != v15)
                {
                  objc_enumerationMutation(v13);
                }

                v17 = *(*(&v21 + 1) + 8 * i);
                v18 = [VNDataDetectorResult alloc];
                v19 = [(VNDataDetectorResult *)v18 initWithDDScannerResult:v17 observation:self, v21];
                [v9 addObject:v19];
              }

              v14 = [v13 countByEnumeratingWithState:&v21 objects:v26 count:16];
            }

            while (v14);
          }

          v8 = v13;
        }

        goto LABEL_19;
      }
    }

    else
    {
      CFRelease(v7);
    }

LABEL_17:
    v9 = 0;
    goto LABEL_20;
  }

  if (!error)
  {
    goto LABEL_17;
  }

  [VNError errorWithCode:9 message:@"Could not create DataDetector" underlyingError:v25];
  *error = v9 = 0;
LABEL_19:

LABEL_20:

  return v9;
}

- (id)getDataDetectorResults:(id *)results
{
  if (results)
  {
    v4 = MEMORY[0x1E696AEC0];
    v5 = objc_opt_class();
    v6 = NSStringFromClass(v5);
    v7 = [v4 stringWithFormat:@"Data detecor not supported for %@", v6];
    *results = [VNError errorWithCode:8 message:v7];
  }

  return 0;
}

- (unint64_t)requestRevision
{
  originatingRequestSpecifier = [(VNObservation *)self originatingRequestSpecifier];
  requestRevision = [originatingRequestSpecifier requestRevision];

  return requestRevision;
}

- (BOOL)isEqual:(id)equal
{
  equalCopy = equal;
  if (self == equalCopy)
  {
    v12 = 1;
  }

  else
  {
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v5 = equalCopy;
      originatingRequestSpecifier = self->_originatingRequestSpecifier;
      originatingRequestSpecifier = [(VNObservation *)v5 originatingRequestSpecifier];
      LOBYTE(originatingRequestSpecifier) = [(VNRequestSpecifier *)originatingRequestSpecifier isEqual:originatingRequestSpecifier];

      if (originatingRequestSpecifier & 1) != 0 && (uuid = self->_uuid, [(VNObservation *)v5 uuid], v9 = objc_claimAutoreleasedReturnValue(), LOBYTE(uuid) = [(NSUUID *)uuid isEqual:v9], v9, (uuid) && (confidence = self->_confidence, [(VNObservation *)v5 confidence], confidence == v11))
      {
        v14 = *&self->_timeRange.start.epoch;
        *&range1.start.value = *&self->_timeRange.start.value;
        *&range1.start.epoch = v14;
        *&range1.duration.timescale = *&self->_timeRange.duration.timescale;
        if (v5)
        {
          [(VNObservation *)v5 timeRange];
        }

        else
        {
          memset(&v15, 0, sizeof(v15));
        }

        v12 = CMTimeRangeEqual(&range1, &v15) != 0;
      }

      else
      {
        v12 = 0;
      }
    }

    else
    {
      v12 = 0;
    }
  }

  return v12;
}

- (unint64_t)hash
{
  uuid = [(VNObservation *)self uuid];
  v4 = [uuid hash];

  v5 = [(VNRequestSpecifier *)self->_originatingRequestSpecifier hash]^ __ROR8__(v4, 51);
  confidence = self->_confidence;
  v7 = LODWORD(confidence);
  if (confidence == 0.0)
  {
    v7 = 0;
  }

  return self->_timeRange.duration.epoch ^ __ROR8__(self->_timeRange.duration.flags ^ __ROR8__(self->_timeRange.duration.timescale ^ __ROR8__(self->_timeRange.duration.value ^ __ROR8__(self->_timeRange.start.epoch ^ __ROR8__(self->_timeRange.start.flags ^ __ROR8__(self->_timeRange.start.timescale ^ __ROR8__(self->_timeRange.start.value, 51), 51), 51), 51), 51), 51), 51) ^ __ROR8__(v7 ^ __ROR8__(v5, 51), 51);
}

- (id)description
{
  v3 = objc_alloc_init(MEMORY[0x1E696AD60]);
  v15.receiver = self;
  v15.super_class = VNObservation;
  v4 = [(VNObservation *)&v15 description];
  uuid = [(VNObservation *)self uuid];
  uUIDString = [uuid UUIDString];
  [v3 appendFormat:@"%@ %@", v4, uUIDString];

  if (self->_originatingRequestSpecifier)
  {
    [v3 appendFormat:@" %@", self->_originatingRequestSpecifier];
  }

  [(VNObservation *)self confidence];
  [v3 appendFormat:@" confidence=%f", v7];
  memset(&v14, 0, sizeof(v14));
  [(VNObservation *)self timeRange];
  range1 = v14;
  v8 = *(MEMORY[0x1E6960CA8] + 16);
  *&range2.start.value = *MEMORY[0x1E6960CA8];
  *&range2.start.epoch = v8;
  *&range2.duration.timescale = *(MEMORY[0x1E6960CA8] + 32);
  if (!CMTimeRangeEqual(&range1, &range2))
  {
    v9 = *MEMORY[0x1E695E480];
    range1 = v14;
    v10 = CMTimeRangeCopyDescription(v9, &range1);
    [v3 appendFormat:@" timeRange=%@", v10];
  }

  return v3;
}

- (id)vn_cloneObject
{
  v3 = [objc_alloc(objc_opt_class()) initWithOriginatingRequestSpecifier:self->_originatingRequestSpecifier];
  if (v3)
  {
    v4 = [(NSUUID *)self->_uuid copy];
    v5 = *(v3 + 24);
    *(v3 + 24) = v4;

    *(v3 + 16) = self->_confidence;
    v6 = *&self->_timeRange.start.value;
    v7 = *&self->_timeRange.duration.timescale;
    *(v3 + 64) = *&self->_timeRange.start.epoch;
    *(v3 + 80) = v7;
    *(v3 + 48) = v6;
    objc_storeStrong((v3 + 32), self->_requestImageBuffers);
    objc_storeStrong((v3 + 40), self->_requestImageBuffersCacheKeys);
  }

  return v3;
}

- (void)encodeWithCoder:(id)coder
{
  coderCopy = coder;
  [coderCopy vn_encodeCodingVersion:0 forKey:@"VNObservation"];
  [coderCopy encodeObject:self->_originatingRequestSpecifier forKey:@"request"];
  [coderCopy encodeObject:self->_uuid forKey:@"uuid"];
  *&v5 = self->_confidence;
  [coderCopy vn_encodeValidatedConfidence:@"confidence" forKey:v5];
  v6 = *&self->_timeRange.start.epoch;
  v7[0] = *&self->_timeRange.start.value;
  v7[1] = v6;
  v7[2] = *&self->_timeRange.duration.timescale;
  [coderCopy vn_encodeTimeRange:v7 forKey:@"timeRange"];
}

- (VNObservation)initWithCoder:(id)coder
{
  coderCopy = coder;
  v5 = [coderCopy decodeObjectOfClass:objc_opt_class() forKey:@"request"];
  if (!v5)
  {
    if ([coderCopy containsValueForKey:@"requestRevision"])
    {
      v6 = [coderCopy decodeIntegerForKey:@"requestRevision"];
    }

    else
    {
      v6 = 1;
    }

    v7 = [objc_opt_class() defaultOriginatingRequestClassNameForRequestRevision:v6];
    if (v7)
    {
      v23 = 0;
      v5 = [VNRequestSpecifier specifierForRequestClassName:v7 revision:v6 error:&v23];
      v8 = v23;
      v9 = v8;
      if (!v5)
      {
        [coderCopy failWithError:v8];

        v5 = 0;
LABEL_12:
        selfCopy = 0;
        goto LABEL_18;
      }
    }

    else
    {
      v5 = 0;
    }
  }

  v22.receiver = self;
  v22.super_class = VNObservation;
  self = [(VNObservation *)&v22 init];
  if (!self)
  {
    goto LABEL_12;
  }

  uUID = [MEMORY[0x1E696AFB0] UUID];
  uuid = self->_uuid;
  self->_uuid = uUID;

  objc_storeStrong(&self->_originatingRequestSpecifier, v5);
  self->_confidence = 1.0;
  v12 = MEMORY[0x1E6960CA8];
  v13 = *(MEMORY[0x1E6960CA8] + 16);
  *&self->_timeRange.start.value = *MEMORY[0x1E6960CA8];
  *&self->_timeRange.start.epoch = v13;
  *&self->_timeRange.duration.timescale = *(v12 + 32);
  if ([coderCopy vn_decodeCodingVersionForKey:@"VNObservation"])
  {
    goto LABEL_12;
  }

  v15 = [coderCopy decodeObjectOfClass:objc_opt_class() forKey:@"uuid"];
  v16 = self->_uuid;
  self->_uuid = v15;

  [coderCopy vn_decodeValidatedConfidenceForKey:@"confidence"];
  self->_confidence = v17;
  if (coderCopy)
  {
    [coderCopy vn_decodeTimeRangeForKey:@"timeRange"];
  }

  else
  {
    v20 = 0u;
    v21 = 0u;
    v19 = 0u;
  }

  *&self->_timeRange.start.value = v19;
  *&self->_timeRange.start.epoch = v20;
  *&self->_timeRange.duration.timescale = v21;
  self = self;
  selfCopy = self;
LABEL_18:

  return selfCopy;
}

- (VNObservation)initWithOriginatingRequestSpecifier:(id)specifier
{
  specifierCopy = specifier;
  v12.receiver = self;
  v12.super_class = VNObservation;
  v6 = [(VNObservation *)&v12 init];
  if (v6)
  {
    uUID = [MEMORY[0x1E696AFB0] UUID];
    uuid = v6->_uuid;
    v6->_uuid = uUID;

    objc_storeStrong(&v6->_originatingRequestSpecifier, specifier);
    v6->_confidence = 1.0;
    v9 = MEMORY[0x1E6960CA8];
    v10 = *(MEMORY[0x1E6960CA8] + 16);
    *&v6->_timeRange.start.value = *MEMORY[0x1E6960CA8];
    *&v6->_timeRange.start.epoch = v10;
    *&v6->_timeRange.duration.timescale = *(v9 + 32);
  }

  return v6;
}

- (VNObservation)initWithRequestRevision:(unint64_t)revision
{
  v4 = [objc_opt_class() defaultOriginatingRequestSpecifierForRevision:revision];
  if (v4)
  {
    self = [(VNObservation *)self initWithOriginatingRequestSpecifier:v4];
    selfCopy = self;
  }

  else
  {
    selfCopy = 0;
  }

  return selfCopy;
}

- (VNObservation)observationWithOriginatingRequestSpecifier:(id)specifier
{
  specifierCopy = specifier;
  if ([(VNRequestSpecifier *)self->_originatingRequestSpecifier isEqual:specifierCopy])
  {
    selfCopy = self;
  }

  else
  {
    selfCopy = [(VNObservation *)self vn_cloneObject];
    objc_storeStrong(&selfCopy->_originatingRequestSpecifier, specifier);
  }

  return selfCopy;
}

+ (id)defaultOriginatingRequestSpecifierForRevision:(unint64_t)revision
{
  v4 = [objc_opt_class() defaultOriginatingRequestClassNameForRequestRevision:revision];
  v13 = 0;
  v5 = [VNRequestSpecifier specifierForRequestClassName:v4 revision:revision error:&v13];
  v6 = v13;
  if (!revision || v5)
  {
    v11 = v5;
  }

  else
  {
    v7 = MEMORY[0x1E696AEC0];
    v8 = objc_opt_class();
    v9 = NSStringFromClass(v8);
    v10 = [v7 stringWithFormat:@"%@ could not resolve originating request class of %@: %@", v9, v4, v6];
    [VNError VNAssert:0 log:v10];

    v11 = 0;
  }

  return v11;
}

- (id)VNCoreMLTransformerDetectionprintAndReturnError:(id *)error
{
  if (error)
  {
    v4 = objc_alloc(MEMORY[0x1E696AEC0]);
    v5 = objc_opt_class();
    v6 = NSStringFromClass(v5);
    v7 = [v4 initWithFormat:@"%@ cannot provide a detectionprint", v6];

    *error = [VNError errorForDataUnavailableWithLocalizedDescription:v7];
  }

  return 0;
}

- (id)VNCoreMLTransformerSceneprintsAndReturnError:(id *)error
{
  if (error)
  {
    v4 = objc_alloc(MEMORY[0x1E696AEC0]);
    v5 = objc_opt_class();
    v6 = NSStringFromClass(v5);
    v7 = [v4 initWithFormat:@"%@ cannot provide sceneprints", v6];

    *error = [VNError errorForDataUnavailableWithLocalizedDescription:v7];
  }

  return 0;
}

@end