void sub_1E510DC84(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, uint64_t a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, uint64_t a56, uint64_t a57, uint64_t a58, void *__p, uint64_t a60, uint64_t a61, void *a62, uint64_t a63)
{
  if (a66)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a66);
  }

  BambiCallOptions::~BambiCallOptions(&a69);
  if (v69)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v69);
  }

  v72 = *(v70 - 136);
  if (v72)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v72);
  }

  if (*(v70 - 97) < 0)
  {
    operator delete(*(v70 - 120));
  }

  _Unwind_Resume(a1);
}

uint64_t BambiClient::callCountForStack(uint64_t a1, const void **a2)
{
  v2 = *(a1 + 368);
  if (v2)
  {
    v4 = 0;
    while (1)
    {
      v5 = v2[2];
      if (!v5)
      {
        goto LABEL_40;
      }

      v6 = *(v5 + 408);
      if (!v6 || ((*(*v6 + 264))(v6) & 1) != 0)
      {
        goto LABEL_40;
      }

      v7 = v2[2];
      v8 = v7[51];
      if (v8)
      {
        if (SipSession::terminating(v8))
        {
          goto LABEL_40;
        }

        v7 = v2[2];
      }

      v9 = v7[48];
      if (v9)
      {
        v10 = std::__shared_weak_count::lock(v9);
        if (v10)
        {
          v11 = v10;
          if (v7[47])
          {
            v12 = v2[2];
            v13 = *(v12 + 384);
            if (v13)
            {
              v14 = std::__shared_weak_count::lock(v13);
              if (v14)
              {
                v15 = *(v12 + 376);
              }

              else
              {
                v15 = 0;
              }
            }

            else
            {
              v15 = 0;
              v14 = 0;
            }

            if (*(v15 + 4455) < 0)
            {
              std::string::__init_copy_ctor_external(&__p, *(v15 + 4432), *(v15 + 4440));
            }

            else
            {
              __p = *(v15 + 4432);
            }

            v16 = SHIBYTE(__p.__r_.__value_.__r.__words[2]);
            if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
            {
              size = HIBYTE(__p.__r_.__value_.__r.__words[2]);
            }

            else
            {
              size = __p.__r_.__value_.__l.__size_;
            }

            v18 = *(a2 + 23);
            v19 = v18;
            if (v18 < 0)
            {
              v18 = a2[1];
            }

            if (size == v18)
            {
              if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
              {
                p_p = &__p;
              }

              else
              {
                p_p = __p.__r_.__value_.__r.__words[0];
              }

              if (v19 >= 0)
              {
                v21 = a2;
              }

              else
              {
                v21 = *a2;
              }

              v22 = memcmp(p_p, v21, size) == 0;
              if (v16 < 0)
              {
LABEL_36:
                operator delete(__p.__r_.__value_.__l.__data_);
              }
            }

            else
            {
              v22 = 0;
              if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
              {
                goto LABEL_36;
              }
            }

            if (v14)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v14);
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v11);
            v4 += v22;
            goto LABEL_40;
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v10);
        }
      }

LABEL_40:
      v2 = *v2;
      if (!v2)
      {
        return v4;
      }
    }
  }

  return 0;
}

void sub_1E510DFE4(_Unwind_Exception *a1)
{
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  _Unwind_Resume(a1);
}

void getMatchingPrefix(std::string *a1, std::string *__str, uint64_t a3, uint64_t a4)
{
  if (a3 == a4)
  {
LABEL_26:
    std::string::basic_string[abi:ne200100]<0>(a1, "");
    return;
  }

  v6 = a3;
  while (1)
  {
    size = HIBYTE(__str->__r_.__value_.__r.__words[2]);
    if ((size & 0x80u) != 0)
    {
      size = __str->__r_.__value_.__l.__size_;
    }

    v9 = *(v6 + 23);
    if ((v9 & 0x8000000000000000) != 0)
    {
      v9 = *(v6 + 8);
    }

    if (size < v9)
    {
      goto LABEL_25;
    }

    std::string::basic_string(&__p, __str, 0, v9, &v18);
    v10 = SHIBYTE(__p.__r_.__value_.__r.__words[2]);
    if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v11 = HIBYTE(__p.__r_.__value_.__r.__words[2]);
    }

    else
    {
      v11 = __p.__r_.__value_.__l.__size_;
    }

    v12 = *(v6 + 23);
    v13 = v12;
    if ((v12 & 0x80u) != 0)
    {
      v12 = *(v6 + 8);
    }

    if (v11 != v12)
    {
      v16 = 0;
      if ((SHIBYTE(__p.__r_.__value_.__r.__words[2]) & 0x80000000) == 0)
      {
        goto LABEL_24;
      }

LABEL_23:
      operator delete(__p.__r_.__value_.__l.__data_);
      goto LABEL_24;
    }

    if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      p_p = &__p;
    }

    else
    {
      p_p = __p.__r_.__value_.__r.__words[0];
    }

    if (v13 >= 0)
    {
      v15 = v6;
    }

    else
    {
      v15 = *v6;
    }

    v16 = memcmp(p_p, v15, v11) == 0;
    if (v10 < 0)
    {
      goto LABEL_23;
    }

LABEL_24:
    if (v16)
    {
      break;
    }

LABEL_25:
    v6 += 24;
    if (v6 == a4)
    {
      goto LABEL_26;
    }
  }

  if (*(v6 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(a1, *v6, *(v6 + 8));
  }

  else
  {
    *&a1->__r_.__value_.__l.__data_ = *v6;
    a1->__r_.__value_.__r.__words[2] = *(v6 + 16);
  }
}

void BambiClient::createNewCall(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  if (*(a6 + 312) == 1)
  {
    operator new();
  }

  operator new();
}

void sub_1E510E62C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, std::__shared_weak_count *a13, char a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, char a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, char a37)
{
  ImsResult::~ImsResult(&a14);
  if (a13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a13);
  }

  if (v38)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  }

  ImsResult::~ImsResult(&a25);
  SipUri::~SipUri(&a37);
  if (v37)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v37);
  }

  _Unwind_Resume(a1);
}

void BambiClient::initializeRedial(uint64_t a1@<X0>, uint64_t *a2@<X1>, uint64_t *a3@<X3>, void *a4@<X8>)
{
  v5 = *a2;
  if (!*a2)
  {
    *a4 = 0;
    a4[1] = 0;
    return;
  }

  v9 = *(v5 + 384);
  if (v9)
  {
    v10 = std::__shared_weak_count::lock(v9);
    if (v10)
    {
      v11 = *(v5 + 376);
      goto LABEL_8;
    }
  }

  else
  {
    v10 = 0;
  }

  v11 = 0;
LABEL_8:
  memset(v31, 0, 352);
  BambiCallOptions::BambiCallOptions(v31, (*a2 + 704));
  v30 = 0;
  memset(v29, 0, sizeof(v29));
  SipUri::SipUri(v29, (*a2 + 1080));
  v12 = a3[1];
  if (v12)
  {
    v13 = std::__shared_weak_count::lock(v12);
    v14 = v13;
    if (v13)
    {
      v15 = *a3;
      v16 = v13;
      if (v15)
      {
        goto LABEL_14;
      }
    }
  }

  else
  {
    v14 = 0;
  }

  v15 = *(*a2 + 424);
  v16 = *(*a2 + 432);
  if (v16)
  {
LABEL_14:
    atomic_fetch_add_explicit(&v16->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  if (v11)
  {
    if (!*(*a2 + 552))
    {
      v25[0] = v11;
      v25[1] = v10;
      if (v10)
      {
        atomic_fetch_add_explicit(&v10->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      v24[0] = v15;
      v24[1] = v16;
      if (v16)
      {
        atomic_fetch_add_explicit(&v16->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      }

      BambiCallOptions::BambiCallOptions(v23, v31);
      BambiClient::createNewCall(a4, a1, v25, v29, v24, v23);
    }

    v17 = *(v11 + 4512);
    v18 = *(v11 + 4520);
    if (v18)
    {
      atomic_fetch_add_explicit(&v18->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    BambiEmergencyCallHandler::redialAnonymously(v17, v26);
    v19 = (*(*v27 + 24))(v27, v28);
    ImsResult::~ImsResult(v26);
    if (v18)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v18);
    }

    if ((v19 & 1) == 0)
    {
      SipStack::initiateEmergencyRedial(v11);
      operator new();
    }
  }

  else
  {
    v21 = *(a1 + 16);
    v20 = a1 + 16;
    v22 = (*(v21 + 56))(v20);
    (*(*v20 + 16))(v20, v22);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "Unable to redial call on invalid stack", 38);
    *(v22 + 17) = 0;
    (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v22 + 17) = 0;
  }

  *a4 = 0;
  a4[1] = 0;
  if (v16)
  {
    std::__shared_weak_count::__release_weak(v16);
  }

  if (v14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }

  SipUri::~SipUri(v29);
  BambiCallOptions::~BambiCallOptions(v31);
  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }
}

void sub_1E510EA4C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, uint64_t a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, uint64_t a56, uint64_t a57, uint64_t a58, uint64_t a59, uint64_t a60, uint64_t a61, uint64_t a62, uint64_t a63)
{
  MEMORY[0x1E69235B0](v72, 0x10B2C40F20492F8);
  if (v71)
  {
    std::__shared_weak_count::__release_weak(v71);
  }

  if (v70)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v70);
  }

  SipUri::~SipUri(&a69);
  BambiCallOptions::~BambiCallOptions(&STACK[0x380]);
  if (v69)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v69);
  }

  _Unwind_Resume(a1);
}

void BambiClient::createNewLazuliSession(uint64_t a1)
{
  v1 = a1 + 16;
  v2 = (*(*(a1 + 16) + 64))(a1 + 16);
  (*(*v1 + 16))(v1, v2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v2 + 8), "BambiClient::createNewLazuliSession", 35);
  *(v2 + 17) = 0;
  (*(*v2 + 64))(v2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v2 + 17) = 0;
  operator new();
}

void sub_1E510ED98(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, uint64_t a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, uint64_t a56, uint64_t a57, uint64_t a58, uint64_t a59, uint64_t a60, char a61)
{
  SipUri::~SipUri(&a9);
  SipUri::~SipUri(&a61);
  v63 = *(v61 - 72);
  if (v63)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v63);
  }

  _Unwind_Resume(a1);
}

uint64_t BambiClient::callCountExcludingCall(uint64_t a1, void *a2)
{
  v2 = *(a1 + 368);
  if (!v2)
  {
    return 0;
  }

  v4 = 0;
  do
  {
    v5 = v2[2];
    if (v5 != *a2)
    {
      v6 = *(v5 + 408);
      if (v6)
      {
        if (!SipSession::terminating(v6))
        {
          v7 = *(v2[2] + 408);
          if (v7)
          {
            v8 = (*(*v7 + 264))(v7) ^ 1;
          }

          else
          {
            v8 = 1;
          }

          v4 += v8;
        }
      }
    }

    v2 = *v2;
  }

  while (v2);
  return v4;
}

uint64_t BambiClient::activeCallCountForStack(uint64_t a1, int a2, const void **a3)
{
  v3 = *(a1 + 368);
  if (v3)
  {
    v6 = 0;
    while (1)
    {
      v7 = v3[2];
      if (((*(v7 + 552) != 0) ^ a2))
      {
        goto LABEL_42;
      }

      v8 = *(v7 + 408);
      if (!v8 || !SipSession::confirmed(v8))
      {
        goto LABEL_42;
      }

      v9 = v3[2];
      v10 = v9[51];
      if (v10)
      {
        if (SipSession::terminating(v10))
        {
          goto LABEL_42;
        }

        v9 = v3[2];
        v11 = v9[51];
        if (v11)
        {
          if ((*(*v11 + 264))(v11))
          {
            goto LABEL_42;
          }

          v9 = v3[2];
        }
      }

      v12 = v9[48];
      if (v12)
      {
        v13 = std::__shared_weak_count::lock(v12);
        if (v13)
        {
          v14 = v13;
          if (v9[47])
          {
            v15 = v3[2];
            v16 = *(v15 + 384);
            if (v16)
            {
              v17 = std::__shared_weak_count::lock(v16);
              if (v17)
              {
                v18 = *(v15 + 376);
              }

              else
              {
                v18 = 0;
              }
            }

            else
            {
              v18 = 0;
              v17 = 0;
            }

            if (*(v18 + 4455) < 0)
            {
              std::string::__init_copy_ctor_external(&__p, *(v18 + 4432), *(v18 + 4440));
            }

            else
            {
              __p = *(v18 + 4432);
            }

            v19 = SHIBYTE(__p.__r_.__value_.__r.__words[2]);
            if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
            {
              size = HIBYTE(__p.__r_.__value_.__r.__words[2]);
            }

            else
            {
              size = __p.__r_.__value_.__l.__size_;
            }

            v21 = *(a3 + 23);
            v22 = v21;
            if (v21 < 0)
            {
              v21 = a3[1];
            }

            if (size == v21)
            {
              if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
              {
                p_p = &__p;
              }

              else
              {
                p_p = __p.__r_.__value_.__r.__words[0];
              }

              if (v22 >= 0)
              {
                v24 = a3;
              }

              else
              {
                v24 = *a3;
              }

              v25 = memcmp(p_p, v24, size) == 0;
              if (v19 < 0)
              {
LABEL_38:
                operator delete(__p.__r_.__value_.__l.__data_);
              }
            }

            else
            {
              v25 = 0;
              if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
              {
                goto LABEL_38;
              }
            }

            if (v17)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v17);
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v14);
            v6 += v25;
            goto LABEL_42;
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v13);
        }
      }

LABEL_42:
      v3 = *v3;
      if (!v3)
      {
        return v6;
      }
    }
  }

  return 0;
}

void sub_1E510F0B8(_Unwind_Exception *a1)
{
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  _Unwind_Resume(a1);
}

void BambiClient::callForMediaSession(BambiClient *this, uint64_t a2, unint64_t a3)
{
  v4 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>((a2 + 312), a3);
  if (v4 && (v5 = v4[3]) != 0 && (v6 = *(v5 + 40)) != 0)
  {
    v7 = *(v5 + 32);
    atomic_fetch_add_explicit(&v6->__shared_weak_owners_, 1uLL, memory_order_relaxed);
    *this = 0;
    v8 = std::__shared_weak_count::lock(v6);
    *(this + 1) = v8;
    if (v8)
    {
      *this = v7;
    }

    std::__shared_weak_count::__release_weak(v6);
  }

  else
  {
    *this = 0;
    *(this + 1) = 0;
  }
}

uint64_t BambiClient::unheldCallsExcludingCall(uint64_t a1, void **a2, void *a3)
{
  v3 = *(a1 + 368);
  if (v3)
  {
    v6 = 0;
    do
    {
      v7 = *(v3 + 2);
      if (v7 != *a3)
      {
        v8 = *(v7 + 408);
        if (v8)
        {
          if ((*(v7 + 492) & 1) == 0 && *(v7 + 480) != 3 && SipSession::confirmed(v8))
          {
            v9 = *(*(v3 + 2) + 408);
            if (v9)
            {
              LOBYTE(v9) = (*(*v9 + 264))(v9);
            }

            v6 |= v9 ^ 1;
            if (a2 && (v9 & 1) == 0)
            {
              std::vector<std::shared_ptr<LazuliHeader>>::push_back[abi:ne200100](a2, v3 + 1);
              v6 = 1;
            }
          }
        }
      }

      v3 = *v3;
    }

    while (v3);
  }

  else
  {
    v6 = 0;
  }

  return v6 & 1;
}

uint64_t BambiClient::unconfirmedCallsExcludingCall(uint64_t a1, void **a2, void *a3)
{
  v3 = *(a1 + 368);
  if (v3)
  {
    v6 = 0;
    do
    {
      v7 = *(v3 + 2);
      if (v7 != *a3)
      {
        v8 = *(v7 + 408);
        if (v8)
        {
          v9 = SipSession::confirmed(v8);
          v6 |= v9 ^ 1;
          if (a2)
          {
            if ((v9 & 1) == 0)
            {
              std::vector<std::shared_ptr<LazuliHeader>>::push_back[abi:ne200100](a2, v3 + 1);
              v6 = 1;
            }
          }
        }
      }

      v3 = *v3;
    }

    while (v3);
  }

  else
  {
    v6 = 0;
  }

  return v6 & 1;
}

void BambiClient::initializeConferenceCall(void *a1@<X0>, uint64_t **a2@<X1>, void *a3@<X8>)
{
  if ((atomic_load_explicit(&_MergedGlobals_31, memory_order_acquire) & 1) == 0 && __cxa_guard_acquire(&_MergedGlobals_31))
  {
    std::string::basic_string[abi:ne200100]<0>(byte_1EE2BCA28, "sip:mmtel@conf-factory.");
    __cxa_atexit(MEMORY[0x1E69E52C0], byte_1EE2BCA28, &dword_1E4C3F000);
    __cxa_guard_release(&_MergedGlobals_31);
  }

  v4 = *a2;
  v5 = a2[1];
  if (*a2 != v5)
  {
    v6 = 0;
    v7 = 0;
    while (!v6)
    {
      v12 = *v4;
      v13 = *(*v4 + 384);
      if (v13)
      {
        v14 = std::__shared_weak_count::lock(v13);
        if (v14)
        {
          v6 = *(v12 + 376);
          if (!v7)
          {
            goto LABEL_44;
          }
        }

        else
        {
          v6 = 0;
          if (!v7)
          {
            goto LABEL_44;
          }
        }

LABEL_43:
        std::__shared_weak_count::__release_shared[abi:ne200100](v7);
        goto LABEL_44;
      }

      v6 = 0;
      v14 = 0;
      if (v7)
      {
        goto LABEL_43;
      }

LABEL_44:
      v4 += 2;
      v7 = v14;
      if (v4 == v5)
      {
        goto LABEL_49;
      }
    }

    v8 = *v4;
    v9 = *(*v4 + 384);
    if (v9)
    {
      v10 = std::__shared_weak_count::lock(v9);
      if (v10)
      {
        v11 = *(v8 + 376);
      }

      else
      {
        v11 = 0;
      }
    }

    else
    {
      v11 = 0;
      v10 = 0;
    }

    if (*(v11 + 4455) < 0)
    {
      std::string::__init_copy_ctor_external(v41, *(v11 + 4432), *(v11 + 4440));
    }

    else
    {
      v15 = v11 + 4432;
      *v41 = *v15;
      *&v41[16] = *(v15 + 16);
    }

    if (*(v6 + 4455) < 0)
    {
      std::string::__init_copy_ctor_external(&v35, *(v6 + 4432), *(v6 + 4440));
    }

    else
    {
      v35 = *(v6 + 4432);
    }

    v16 = v41[23];
    if (v41[23] >= 0)
    {
      v17 = v41[23];
    }

    else
    {
      v17 = *&v41[8];
    }

    size = HIBYTE(v35.__r_.__value_.__r.__words[2]);
    v19 = SHIBYTE(v35.__r_.__value_.__r.__words[2]);
    if ((v35.__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
    {
      size = v35.__r_.__value_.__l.__size_;
    }

    if (v17 == size)
    {
      if (v41[23] >= 0)
      {
        v20 = v41;
      }

      else
      {
        v20 = *v41;
      }

      if ((v35.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v21 = &v35;
      }

      else
      {
        v21 = v35.__r_.__value_.__r.__words[0];
      }

      v22 = memcmp(v20, v21, v17) == 0;
      if ((v19 & 0x80000000) == 0)
      {
LABEL_33:
        if ((v16 & 0x80) == 0)
        {
          goto LABEL_34;
        }

        goto LABEL_40;
      }
    }

    else
    {
      v22 = 0;
      if ((SHIBYTE(v35.__r_.__value_.__r.__words[2]) & 0x80000000) == 0)
      {
        goto LABEL_33;
      }
    }

    operator delete(v35.__r_.__value_.__l.__data_);
    if ((v41[23] & 0x80) == 0)
    {
LABEL_34:
      if (!v10)
      {
LABEL_36:
        if (!v22)
        {
          v30 = (*(a1[2] + 56))(a1 + 2);
          (*(a1[2] + 16))(a1 + 2, v30);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v30 + 8), "unable to merge calls on different sip stacks", 45);
          *(v30 + 17) = 0;
          (*(*v30 + 64))(v30, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v30 + 17) = 0;
          *a3 = 0;
          a3[1] = 0;
          goto LABEL_72;
        }

        v14 = v7;
        goto LABEL_44;
      }

LABEL_35:
      std::__shared_weak_count::__release_shared[abi:ne200100](v10);
      goto LABEL_36;
    }

LABEL_40:
    operator delete(*v41);
    if (!v10)
    {
      goto LABEL_36;
    }

    goto LABEL_35;
  }

  v14 = 0;
  v6 = 0;
LABEL_49:
  v7 = v14;
  if (SipStack::registeredForVoice(v6))
  {
    v65 = 0;
    v63 = 0u;
    v64 = 0u;
    v61 = 0u;
    v62 = 0u;
    v59 = 0u;
    v60 = 0u;
    v57 = 0u;
    v58 = 0u;
    v55 = 0u;
    v56 = 0u;
    v53 = 0u;
    v54 = 0u;
    v51 = 0u;
    v52 = 0u;
    v49 = 0u;
    v50 = 0u;
    v47 = 0u;
    v48 = 0u;
    v45 = 0u;
    v46 = 0u;
    v43 = 0u;
    v44 = 0u;
    v42 = 0u;
    memset(v41, 0, sizeof(v41));
    v23 = *(v6 + 248);
    v24 = *(v6 + 256);
    if (v24)
    {
      atomic_fetch_add_explicit(&v24->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    SipUserAgent::conferenceServerUri(v23, v41);
    if (v24)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v24);
    }

    v25 = HIBYTE(v47);
    if (v47 < 0)
    {
      v25 = v47;
    }

    if (v25)
    {
      v26 = a1[95];
      if (v26)
      {
        v27 = std::__shared_weak_count::lock(v26);
        if (v27 && a1[94])
        {
          v40[0] = 0;
          v40[1] = 0;
          v38 = v6;
          v39 = v7;
          if (v7)
          {
            atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          v28 = a1[28];
          v36 = a1[27];
          v37 = v28;
          if (v28)
          {
            atomic_fetch_add_explicit((v28 + 8), 1uLL, memory_order_relaxed);
          }

          BambiConferenceCall::create(v40);
        }
      }

      else
      {
        v27 = 0;
      }

      v32 = (*(a1[2] + 56))(a1 + 2);
      (*(a1[2] + 16))(a1 + 2, v32);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "no call manager delegate specified", 34);
      *(v32 + 17) = 0;
      (*(*v32 + 64))(v32, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v32 + 17) = 0;
      *a3 = 0;
      a3[1] = 0;
      if (v27)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v27);
      }
    }

    else
    {
      v31 = (*(a1[2] + 56))(a1 + 2);
      (*(a1[2] + 16))(a1 + 2, v31);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), "no conference server specified", 30);
      *(v31 + 17) = 0;
      (*(*v31 + 64))(v31, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v31 + 17) = 0;
      *a3 = 0;
      a3[1] = 0;
    }

    SipUri::~SipUri(v41);
  }

  else
  {
    v29 = (*(a1[2] + 56))(a1 + 2);
    (*(a1[2] + 16))(a1 + 2, v29);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "not registered for voice calls", 30);
    *(v29 + 17) = 0;
    (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v29 + 17) = 0;
    *a3 = 0;
    a3[1] = 0;
  }

LABEL_72:
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void BambiClient::initializeUssdSession(void *a1@<X0>, uint64_t a2@<X1>, void *a3@<X8>)
{
  v11 = 0;
  v12 = 0;
  (*(*a1 + 184))(&v11);
  if (v11)
  {
    if (*(v11 + 320) == 2)
    {
      if (v12)
      {
        atomic_fetch_add_explicit(&v12->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      BambiUssdSession::create();
    }

    v10 = a1[2];
    v9 = a1 + 2;
    v8 = (*(v10 + 56))(v9);
    (*(*v9 + 16))(v9, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 1), "initializeUssdSession: SIP stack is not initialized", 51);
    v8[17] = 0;
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  }

  else
  {
    v7 = a1[2];
    v6 = a1 + 2;
    v8 = (*(v7 + 56))(v6);
    (*(*v6 + 16))(v6, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 1), "Inavalid stack ", 15);
    v8[17] = 0;
    (*(*v8 + 32))(v8, a2);
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  }

  v8[17] = 0;
  *a3 = 0;
  a3[1] = 0;
  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }
}

void sub_1E510FFC4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, std::__shared_weak_count *a16)
{
  if (a10)
  {
    std::__shared_weak_count::__release_weak(a10);
  }

  if (a14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  if (a16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a16);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::trackSipSession(uint64_t a1, char ***a2)
{
  v3 = *a2;
  if (*a2)
  {
    v5 = **v3;
    {
      v6 = a2[1];
      if (v6)
      {
        atomic_fetch_add_explicit(&v6->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      std::__hash_table<std::shared_ptr<SipSessionInterface>,std::hash<std::shared_ptr<SipSessionInterface>>,std::equal_to<std::shared_ptr<SipSessionInterface>>,std::allocator<std::shared_ptr<SipSessionInterface>>>::__emplace_unique_key_args<std::shared_ptr<SipSessionInterface>,std::shared_ptr<SipSessionInterface> const&>((a1 + 392), a2);
      if (v6)
      {

        std::__shared_weak_count::__release_shared[abi:ne200100](v6);
      }
    }
  }
}

void sub_1E51100D8(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::untrackSipSession(uint64_t a1, uint64_t *a2)
{
  v3 = *a2;
  v4 = a2[1];
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 1174405120;
  v6[2] = ___ZN11BambiClient17untrackSipSessionENSt3__110shared_ptrI19SipSessionInterfaceEE_block_invoke;
  v6[3] = &__block_descriptor_tmp_58_2;
  v6[4] = a1;
  v6[5] = v3;
  v7 = v4;
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v10 = 0;
  v11 = 0;
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&v10, (a1 + 176));
  v5 = *(a1 + 192);
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 1174405120;
  block[2] = ___ZNK3ctu20SharedSynchronizableI11BambiClientE15execute_wrappedEU13block_pointerFvvE_block_invoke;
  block[3] = &unk_1F5EF5ED0;
  block[5] = v10;
  v9 = v11;
  if (v11)
  {
    atomic_fetch_add_explicit(&v11->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  block[4] = v6;
  dispatch_async(v5, block);
  if (v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  }

  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }

  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }
}

void ___ZN11BambiClient17untrackSipSessionENSt3__110shared_ptrI19SipSessionInterfaceEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = (*(v2[2] + 64))(v2 + 2);
  (*(v2[2] + 16))(v2 + 2, v3);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "Untracking session", 18);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  v4 = v2[50];
  if (!*&v4)
  {
    return;
  }

  v5 = *(a1 + 40);
  v6 = 0x9DDFEA08EB382D69 * ((8 * (v5 & 0x1FFFFFFF) + 8) ^ HIDWORD(v5));
  v7 = 0x9DDFEA08EB382D69 * (HIDWORD(v5) ^ (v6 >> 47) ^ v6);
  v8 = 0x9DDFEA08EB382D69 * (v7 ^ (v7 >> 47));
  v9 = vcnt_s8(v4);
  v9.i16[0] = vaddlv_u8(v9);
  if (v9.u32[0] > 1uLL)
  {
    v10 = v8;
    if (v8 >= *&v4)
    {
      v10 = v8 % *&v4;
    }
  }

  else
  {
    v10 = v8 & (*&v4 - 1);
  }

  v11 = v2[49];
  v12 = *(v11 + 8 * v10);
  if (!v12)
  {
    return;
  }

  v13 = *v12;
  if (!*v12)
  {
    return;
  }

  v14 = *&v4 - 1;
  while (1)
  {
    v15 = v13[1];
    if (v15 == v8)
    {
      break;
    }

    if (v9.u32[0] > 1uLL)
    {
      if (v15 >= *&v4)
      {
        v15 %= *&v4;
      }
    }

    else
    {
      v15 &= v14;
    }

    if (v15 != v10)
    {
      return;
    }

LABEL_17:
    v13 = *v13;
    if (!v13)
    {
      return;
    }
  }

  if (v13[2] != v5)
  {
    goto LABEL_17;
  }

  v16 = *v13;
  if (v9.u32[0] > 1uLL)
  {
    if (v8 >= *&v4)
    {
      v8 %= *&v4;
    }
  }

  else
  {
    v8 &= v14;
  }

  v17 = *(v11 + 8 * v8);
  do
  {
    v18 = v17;
    v17 = *v17;
  }

  while (v17 != v13);
  if (v18 == v2 + 51)
  {
    goto LABEL_36;
  }

  v19 = v18[1];
  if (v9.u32[0] > 1uLL)
  {
    if (v19 >= *&v4)
    {
      v19 %= *&v4;
    }
  }

  else
  {
    v19 &= v14;
  }

  if (v19 == v8)
  {
LABEL_38:
    if (v16)
    {
      v20 = v16[1];
      goto LABEL_40;
    }
  }

  else
  {
LABEL_36:
    if (!v16)
    {
      goto LABEL_37;
    }

    v20 = v16[1];
    if (v9.u32[0] > 1uLL)
    {
      v21 = v16[1];
      if (v20 >= *&v4)
      {
        v21 = v20 % *&v4;
      }
    }

    else
    {
      v21 = v20 & v14;
    }

    if (v21 != v8)
    {
LABEL_37:
      *(v11 + 8 * v8) = 0;
      v16 = *v13;
      goto LABEL_38;
    }

LABEL_40:
    if (v9.u32[0] > 1uLL)
    {
      if (v20 >= *&v4)
      {
        v20 %= *&v4;
      }
    }

    else
    {
      v20 &= v14;
    }

    if (v20 != v8)
    {
      *(v2[49] + 8 * v20) = v18;
      v16 = *v13;
    }
  }

  *v18 = v16;
  *v13 = 0;
  --v2[52];
  v22 = v13[3];
  if (v22)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v22);
  }

  operator delete(v13);
}

uint64_t __copy_helper_block_e8_40c47_ZTSNSt3__110shared_ptrI19SipSessionInterfaceEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c47_ZTSNSt3__110shared_ptrI19SipSessionInterfaceEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }
}

uint64_t BambiClient::sendMessage(void *a1, uint64_t a2, const SipUri *a3, uint64_t a4, uint64_t a5, const std::string *a6, const ims::LocationInfo *a7)
{
  v49 = 0;
  v50 = 0;
  (*(*a1 + 184))(&v49);
  v14 = v49;
  if (v49)
  {
    v15 = *(a4 + 23);
    v16 = v15;
    if ((v15 & 0x80u) != 0)
    {
      v15 = *(a4 + 8);
    }

    if (v15)
    {
      v17 = a1[100];
      v18 = a1[101];
      if (v17 != v18)
      {
        if (v16 >= 0)
        {
          v19 = a4;
        }

        else
        {
          v19 = *a4;
        }

        while (1)
        {
          v20 = *(v17 + 23) >= 0 ? v17 : *v17;
          if (!strcasecmp(v19, v20))
          {
            break;
          }

          v17 += 24;
          if (v17 == v18)
          {
            goto LABEL_29;
          }
        }

        std::__move_impl<std::_ClassicAlgPolicy>::operator()[abi:ne200100]<std::string *,std::string *,std::string *>(v45, (v17 + 24), v18, v17);
        v26 = v25;
        v27 = a1[101];
        while (v27 != v26)
        {
          v28 = *(v27 - 1);
          v27 -= 3;
          if (v28 < 0)
          {
            operator delete(*v27);
          }
        }

        a1[101] = v26;
        v30 = a1[29];
        v29 = a1[30];
        if (v29)
        {
          atomic_fetch_add_explicit(&v29->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        v31 = v50;
        v49 = v30;
        v50 = v29;
        if (v31)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v31);
        }

        v33 = a1[2];
        v32 = a1 + 2;
        v34 = (*(v33 + 64))(v32);
        (*(*v32 + 16))(v32, v34);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v34 + 8), "Message is a response to emergency message with call-id ", 56);
        *(v34 + 17) = 0;
        ObfuscatedString::ObfuscatedString(v45, a4);
        (*(*v34 + 56))(v34, v45);
        (*(*v34 + 64))(v34, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v34 + 17) = 0;
        if (v48 < 0)
        {
          operator delete(__p);
        }

        if (v46 < 0)
        {
          operator delete(v45[0]);
        }

        v14 = v49;
      }
    }

LABEL_29:
    ims::LocationInfo::LocationInfo(v36, a7);
    v24 = SipStack::sendMessage(v14, a3, a4, a5, a6, v36);
    if (v44 < 0)
    {
      operator delete(v43);
    }

    if (v42 < 0)
    {
      operator delete(v41);
    }

    if (v40 < 0)
    {
      operator delete(v39);
    }

    if (v38 < 0)
    {
      operator delete(v37);
    }
  }

  else
  {
    v22 = a1[2];
    v21 = a1 + 2;
    v23 = (*(v22 + 56))(v21);
    (*(*v21 + 16))(v21, v23);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "unable to send message on invalid stack ", 40);
    *(v23 + 17) = 0;
    (*(*v23 + 32))(v23, a2);
    (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v24 = 0;
    *(v23 + 17) = 0;
  }

  if (v50)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v50);
  }

  return v24;
}

void sub_1E511090C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, char a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, char a28)
{
  v30 = *(v28 - 96);
  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::sendLazuli(BambiClient *this, const LazuliSendParams *a2, const SipUri *a3)
{
  v24 = *MEMORY[0x1E69E9840];
  v6 = *(this + 26);
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    (*(*(this + 21) + 16))(v19);
    v7 = v20;
    v8 = v19[0];
    SipUri::asString(a3, __p);
    v9 = v19;
    if (v7 < 0)
    {
      v9 = v8;
    }

    if (v18 >= 0)
    {
      v10 = __p;
    }

    else
    {
      v10 = __p[0];
    }

    *buf = 141558531;
    *&buf[4] = 1752392040;
    *&buf[12] = 2081;
    *&buf[14] = v9;
    v22 = 2085;
    v23 = v10;
    _os_log_impl(&dword_1E4C3F000, v6, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}sBambiClient::sendLazuli %{sensitive}s", buf, 0x20u);
    if (v18 < 0)
    {
      operator delete(__p[0]);
    }

    if (v20 < 0)
    {
      operator delete(v19[0]);
    }
  }

  *buf = 0;
  *&buf[8] = 0;
  (*(*this + 184))(buf, this, a2);
  if (*buf)
  {
    v11 = SipStack::sendLazuli(*buf, a2, a3);
  }

  else
  {
    v13 = *(this + 2);
    v12 = this + 16;
    v14 = (*(v13 + 56))(v12);
    (*(*v12 + 16))(v12, v14);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "unable to send message on invalid stack ", 40);
    *(v14 + 17) = 0;
    (*(*v14 + 32))(v14, a2);
    (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v11 = 0;
    *(v14 + 17) = 0;
  }

  if (*&buf[8])
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](*&buf[8]);
  }

  v15 = *MEMORY[0x1E69E9840];
  return v11;
}

void sub_1E5110BE4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, uint64_t a19)
{
  if (a17 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::addLazuliParticipants(BambiClient *this, const void **a2, const SipUri *a3)
{
  v6 = this + 16;
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "BambiClient::addLazuliParticipants", 34);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v11 = 0;
  v12 = 0;
  (*(*this + 184))(&v11, this, a2);
  if (v11)
  {
    v8 = SipStack::addLazuliParticipants(v11, a2, a3);
  }

  else
  {
    v9 = (*(*v6 + 56))(v6);
    (*(*v6 + 16))(v6, v9);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "unable to add group participant(s) on invalid stack ", 52);
    *(v9 + 17) = 0;
    (*(*v9 + 32))(v9, a2);
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v8 = 0;
    *(v9 + 17) = 0;
  }

  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  return v8;
}

void sub_1E5110E48(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::removeLazuliParticipants(BambiClient *this, const void **a2, const SipUri *a3)
{
  v6 = this + 16;
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "BambiClient::removeLazuliParticipants", 37);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v11 = 0;
  v12 = 0;
  (*(*this + 184))(&v11, this, a2);
  if (v11)
  {
    v8 = SipStack::removeLazuliParticipants(v11, a2, a3);
  }

  else
  {
    v9 = (*(*v6 + 56))(v6);
    (*(*v6 + 16))(v6, v9);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "unable to remove group participant(s) on invalid stack ", 55);
    *(v9 + 17) = 0;
    (*(*v9 + 32))(v9, a2);
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v8 = 0;
    *(v9 + 17) = 0;
  }

  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  return v8;
}

void sub_1E511108C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::changeLazuliGroupInfo(BambiClient *this, const LazuliSendParams *a2, const SipUri *a3)
{
  v6 = this + 16;
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "BambiClient::changeLazuliGroupInfo", 34);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v11 = 0;
  v12 = 0;
  (*(*this + 184))(&v11, this, a2);
  if (v11)
  {
    v8 = SipStack::changeLazuliGroupInfo(v11, a2, a3);
  }

  else
  {
    v9 = (*(*v6 + 56))(v6);
    (*(*v6 + 16))(v6, v9);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "unable to change group info on invalid stack ", 45);
    *(v9 + 17) = 0;
    (*(*v9 + 32))(v9, a2);
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v8 = 0;
    *(v9 + 17) = 0;
  }

  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  return v8;
}

void sub_1E51112D0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::createMessageSession(void *a1, uint64_t a2, uint64_t a3, void *a4, uint64_t *a5)
{
  v30 = *MEMORY[0x1E69E9840];
  v10 = a1 + 2;
  v11 = (*(a1[2] + 64))(a1 + 2);
  (*(*v10 + 16))(v10, v11);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "BambiClient::createMessageSession", 33);
  *(v11 + 17) = 0;
  (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v11 + 17) = 0;
  v12 = *(*a2 + 248);
  v13 = *(*a2 + 256);
  if (v13)
  {
    atomic_fetch_add_explicit(&v13->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  if (v12)
  {
    v14 = *(v12 + 296);
    v15 = *(v12 + 304);
    if (v15)
    {
      atomic_fetch_add_explicit(&v15->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    if (v14)
    {
      v16 = a4[1];
      v23[0] = *a4;
      v23[1] = v16;
      if (v16)
      {
        atomic_fetch_add_explicit((v16 + 16), 1uLL, memory_order_relaxed);
      }

      v17 = a5[1];
      v22[0] = *a5;
      v22[1] = v17;
      if (v17)
      {
        atomic_fetch_add_explicit((v17 + 8), 1uLL, memory_order_relaxed);
      }

      SipLazuliManager::createMessageSession(v14, a3, v23, v22);
    }

    v20 = (*(*v10 + 56))(v10);
    (*(*v10 + 16))(v10, v20);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v20 + 8), "Lazuli manager is null ", 23);
    *(v20 + 17) = 0;
    (*(*v20 + 64))(v20, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v20 + 17) = 0;
    if (v15)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v15);
    }
  }

  else
  {
    v18 = a1[26];
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      (*(a1[21] + 16))(__p, a1 + 21);
      v19 = v25 >= 0 ? __p : __p[0];
      *buf = 141558275;
      v27 = 1752392040;
      v28 = 2081;
      v29 = v19;
      _os_log_error_impl(&dword_1E4C3F000, v18, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno user agent", buf, 0x16u);
      if (v25 < 0)
      {
        operator delete(__p[0]);
      }
    }
  }

  if (v13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v13);
  }

  v21 = *MEMORY[0x1E69E9840];
}

void sub_1E5111624(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, std::__shared_weak_count *a13)
{
  if (v13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v13);
  }

  _Unwind_Resume(exception_object);
}

void sub_1E511166C()
{
  if (v0)
  {
    JUMPOUT(0x1E5111674);
  }

  JUMPOUT(0x1E511164CLL);
}

uint64_t BambiClient::sendOptionsRequest(void *a1, uint64_t a2, uint64_t a3, const SipUri *a4)
{
  v8 = a1 + 2;
  v9 = (*(a1[2] + 64))(a1 + 2);
  (*(*v8 + 16))(v8, v9);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "BambiClient::sendOptionsRequest", 31);
  *(v9 + 17) = 0;
  (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v9 + 17) = 0;
  v13 = 0;
  v14 = 0;
  (*(*a1 + 184))(&v13, a1, a2);
  if (v13)
  {
    v10 = SipStack::sendOptionsRequest(v13, a3, a4);
  }

  else
  {
    v11 = (*(*v8 + 56))(v8);
    (*(*v8 + 16))(v8, v11);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "unable to send optiona request on invalid stack ", 48);
    *(v11 + 17) = 0;
    (*(*v11 + 32))(v11, a2);
    (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v10 = 0;
    *(v11 + 17) = 0;
  }

  if (v14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }

  return v10;
}

void sub_1E51118B4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::reportLazuliSpam(BambiClient *this, const LazuliSpamReportParams *a2)
{
  v4 = this + 16;
  v5 = (*(*(this + 2) + 64))(this + 16);
  (*(*v4 + 16))(v4, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "BambiClient::reportLazuliSpam", 29);
  *(v5 + 17) = 0;
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  v9 = 0;
  v10 = 0;
  (*(*this + 184))(&v9, this, a2);
  if (v9)
  {
    v6 = SipStack::reportLazuliSpam(v9, a2);
  }

  else
  {
    v7 = (*(*v4 + 56))(v4);
    (*(*v4 + 16))(v4, v7);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "unable to send message on invalid stack ", 40);
    *(v7 + 17) = 0;
    (*(*v7 + 32))(v7, a2);
    (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v6 = 0;
    *(v7 + 17) = 0;
  }

  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }

  return v6;
}

void sub_1E5111AE8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::setAuthResponse(void *a1, uint64_t a2, uint64_t a3)
{
  v6 = (a3 + 8);
  if ((*(a3 + 31) & 0x80000000) == 0)
  {
    if (*(a3 + 31) != 3)
    {
      v7 = a3 + 8;
      if (*(a3 + 31) != 9)
      {
LABEL_27:
        v18 = a1 + 2;
        v19 = (*(a1[2] + 56))(a1 + 2);
        (*(*v18 + 16))(v18, v19);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "ignoring auth response with unknown source id '", 47);
        *(v19 + 17) = 0;
        LoggableString::LoggableString(&__p, v6);
        (*(*v19 + 40))(v19, &__p);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "'", 1);
        *(v19 + 17) = 0;
        (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v19 + 17) = 0;
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }

        return;
      }

      goto LABEL_8;
    }

    if (LOWORD(v6->__r_.__value_.__l.__data_) != 26995 || *(a3 + 10) != 112)
    {
      goto LABEL_27;
    }

LABEL_34:
    *&__p.__r_.__value_.__l.__data_ = 0uLL;
    (*(*a1 + 184))(&__p, a1, a2);
    if (__p.__r_.__value_.__r.__words[0])
    {
      v21 = *(__p.__r_.__value_.__r.__words[0] + 248);
      v22 = *(__p.__r_.__value_.__r.__words[0] + 256);
      if (v22)
      {
        atomic_fetch_add_explicit(&v22->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      v23 = *(v21 + 368);
      v24 = *(v21 + 376);
      if (v24)
      {
        atomic_fetch_add_explicit(&v24->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*v23 + 72))(v23, a3);
      if (v24)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v24);
      }

      if (v22)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v22);
      }
    }

    else
    {
      v26 = a1[2];
      v25 = a1 + 2;
      v27 = (*(v26 + 56))(v25);
      (*(*v25 + 16))(v25, v27);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "ignoring auth response for invalid stack ", 41);
      *(v27 + 17) = 0;
      (*(*v27 + 32))(v27, a2);
      (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v27 + 17) = 0;
    }

    if (__p.__r_.__value_.__l.__size_)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](__p.__r_.__value_.__l.__size_);
    }

    return;
  }

  v8 = *(a3 + 16);
  if (v8 == 3)
  {
    if (*v6->__r_.__value_.__l.__data_ != 26995 || *(v6->__r_.__value_.__r.__words[0] + 2) != 112)
    {
      goto LABEL_27;
    }

    goto LABEL_34;
  }

  if (v8 != 9)
  {
    goto LABEL_27;
  }

  v7 = v6->__r_.__value_.__r.__words[0];
LABEL_8:
  v9 = *v7;
  v10 = *(v7 + 8);
  if (v9 != 0x636E656772656D65 || v10 != 121)
  {
    goto LABEL_27;
  }

  v12 = a1[29];
  v13 = *(v12 + 248);
  v14 = *(v12 + 256);
  if (v14)
  {
    atomic_fetch_add_explicit(&v14->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v15 = *(v13 + 368);
  v16 = *(v13 + 376);
  if (v16)
  {
    atomic_fetch_add_explicit(&v16->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  (*(*v15 + 72))(v15, a3);
  if (v16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  }

  if (v14)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }
}

void sub_1E5111F04(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, std::__shared_weak_count *a11, int a12, __int16 a13, char a14, char a15)
{
  if (v16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  }

  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  }

  if (a11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a11);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::handleFatalError(BambiClient *this, const ImsResult *a2)
{
  memset(v18, 0, sizeof(v18));
  if (byte_1EE2BD327 < 0)
  {
    std::string::__init_copy_ctor_external(v18, BambiClientStatus::kStatusInitialized, *(&BambiClientStatus::kStatusInitialized + 1));
  }

  else
  {
    *v18 = BambiClientStatus::kStatusInitialized;
    *&v18[16] = unk_1EE2BD320;
  }

  v18[24] = byte_1EE2BD328;
  v4 = (*(*(this + 2) + 56))(this + 16);
  (*(*(this + 2) + 16))(this + 16, v4);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "received fatal error: ", 22);
  *(v4 + 17) = 0;
  (*(*a2 + 16))(a2, v4);
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  __p = &unk_1F5EBDEF8;
  v11 = &_bambiDomain;
  v12 = 1073741831;
  if (*(a2 + 1) == &_bambiDomain)
  {
    v5 = *(a2 + 4);
    ImsResult::~ImsResult(&__p);
    if (v5 == 1073741831)
    {
      std::string::operator=(v18, BambiClientStatus::kStatusMediaRequestTimedOut);
      v18[24] = byte_1EE2BD2E8;
      goto LABEL_18;
    }
  }

  else
  {
    ImsResult::~ImsResult(&__p);
  }

  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  __p = &unk_1F5EBDEF8;
  v11 = &_bambiDomain;
  v12 = 1073741845;
  if (*(a2 + 1) == &_bambiDomain)
  {
    v6 = *(a2 + 4);
    ImsResult::~ImsResult(&__p);
    if (v6 == 1073741845)
    {
      std::string::basic_string[abi:ne200100]<0>(&__p, "AVConferenceCrash");
      v9[0] = 0;
      v9[1] = 0;
      BambiClient::endAllCalls(this, &__p, v9);
      goto LABEL_16;
    }
  }

  else
  {
    ImsResult::~ImsResult(&__p);
  }

  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  __p = &unk_1F5EBDEF8;
  v11 = &_bambiDomain;
  v12 = 1073741846;
  if (*(a2 + 1) != &_bambiDomain)
  {
    ImsResult::~ImsResult(&__p);
    goto LABEL_18;
  }

  v7 = *(a2 + 4);
  ImsResult::~ImsResult(&__p);
  if (v7 == 1073741846)
  {
    std::string::basic_string[abi:ne200100]<0>(&__p, "BasebandCrash");
    v8[0] = 0;
    v8[1] = 0;
    BambiClient::endAllCalls(this, &__p, v8);
LABEL_16:
    if (v13 < 0)
    {
      operator delete(__p);
    }
  }

LABEL_18:
  if ((v18[23] & 0x80000000) != 0)
  {
    operator delete(*v18);
  }
}

void sub_1E5112288(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, void *__p, uint64_t a15, int a16, __int16 a17, char a18, char a19)
{
  if (a19 < 0)
  {
    operator delete(__p);
  }

  if (*(v19 - 57) < 0)
  {
    operator delete(*(v19 - 80));
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::createMediaSessionForStream(void *a1@<X0>, BambiCallMediaStream *a2@<X1>, int a3@<W3>, uint64_t a4@<X4>, uint64_t a5@<X8>)
{
  v8 = *(a2 + 5);
  if (v8)
  {
    v9 = *(a2 + 4);
    atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
    v10 = std::__shared_weak_count::lock(v8);
    std::__shared_weak_count::__release_weak(v8);
    if (v10)
    {
      if (v9)
      {
        v12 = v9[49];
        v11 = v9[50];
        if (v11)
        {
          LOBYTE(v8) = 1;
          atomic_fetch_add_explicit(&v11->__shared_owners_, 1uLL, memory_order_relaxed);
          std::__shared_weak_count::__release_shared[abi:ne200100](v11);
          if (!v12)
          {
            goto LABEL_31;
          }
        }

        else
        {
          if (!v12)
          {
LABEL_31:
            v22 = a1[2];
            v21 = a1 + 2;
            v23 = (*(v22 + 56))(v21);
            (*(*v21 + 16))(v21, v23);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "No valid mediaManager", 21);
            *(v23 + 17) = 0;
            (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v23 + 17) = 0;
            *(a5 + 40) = 0u;
            *(a5 + 56) = 0u;
            *(a5 + 72) = 0u;
            *a5 = &unk_1F5EBDEF8;
            *(a5 + 8) = &_bambiDomain;
            *(a5 + 16) = 0x40000000;
            *(a5 + 24) = 0;
            *(a5 + 32) = 0;
            goto LABEL_97;
          }

          LOBYTE(v8) = 1;
        }
      }

      else
      {
        LOBYTE(v8) = 0;
      }

      goto LABEL_10;
    }

    LOBYTE(v8) = 0;
  }

  else
  {
    v10 = 0;
  }

  v9 = 0;
LABEL_10:
  v13 = a1[36] + 1;
  a1[36] = v13;
  BambiCallMediaStream::setMediaSessionId(a2, v13);
  v14 = a1[36];
  v15 = a1[40];
  if (!*&v15)
  {
    goto LABEL_27;
  }

  v16 = vcnt_s8(v15);
  v16.i16[0] = vaddlv_u8(v16);
  if (v16.u32[0] > 1uLL)
  {
    v17 = a1[36];
    if (*&v15 <= v14)
    {
      v17 = v14 % *&v15;
    }
  }

  else
  {
    v17 = (*&v15 - 1) & v14;
  }

  v18 = *(a1[39] + 8 * v17);
  if (!v18 || (v19 = *v18) == 0)
  {
LABEL_27:
    operator new();
  }

  while (1)
  {
    v20 = v19[1];
    if (v20 == v14)
    {
      break;
    }

    if (v16.u32[0] > 1uLL)
    {
      if (v20 >= *&v15)
      {
        v20 %= *&v15;
      }
    }

    else
    {
      v20 &= *&v15 - 1;
    }

    if (v20 != v17)
    {
      goto LABEL_27;
    }

LABEL_26:
    v19 = *v19;
    if (!v19)
    {
      goto LABEL_27;
    }
  }

  if (v19[2] != v14)
  {
    goto LABEL_26;
  }

  v19[3] = a2;
  if (v8)
  {
    v24 = *(v9 + 786);
    v25 = v9[69];
    v26 = **v9;
    if (v10 && v27)
    {
      v28 = 1;
      atomic_fetch_add_explicit(&v10->__shared_owners_, 1uLL, memory_order_relaxed);
      std::__shared_weak_count::__release_shared[abi:ne200100](v10);
    }

    else
    {
      v28 = v27 != 0;
    }

    v32 = v9[48];
    if (v32 && (v33 = std::__shared_weak_count::lock(v32)) != 0)
    {
      v34 = v9[47][297];
      std::__shared_weak_count::__release_shared[abi:ne200100](v33);
    }

    else
    {
      v34 = MEMORY[0x129];
    }

    v57 = a1[36];
    memset(&v64, 0, sizeof(v64));
    v35 = v9[48];
    if (v35)
    {
      v36 = std::__shared_weak_count::lock(v35);
      if (v36)
      {
        v37 = v9[47];
      }

      else
      {
        v37 = 0;
      }
    }

    else
    {
      v37 = 0;
      v36 = 0;
    }

    if (v37[2767] < 0)
    {
      std::string::__init_copy_ctor_external(&v64, *(v37 + 343), *(v37 + 344));
    }

    else
    {
      v64 = *(v37 + 2744);
    }

    if (v36)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v36);
    }

    v38 = v9[48];
    if (v38)
    {
      v38 = std::__shared_weak_count::lock(v38);
      v39 = v38;
      if (v38)
      {
        v38 = v9[47];
      }
    }

    else
    {
      v39 = 0;
    }

    v40 = SipStack::prefs(v38);
    v55 = v34;
    if (ImsPrefs::BindMediaToTransportInterface(v40))
    {
      if ((v64.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        size = HIBYTE(v64.__r_.__value_.__r.__words[2]);
      }

      else
      {
        size = v64.__r_.__value_.__l.__size_;
      }

      if (v39)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v39);
      }

      if (!size)
      {
        BambiCall::interface(v9, &v63);
        if (SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v64.__r_.__value_.__l.__data_);
        }

        v64 = v63;
      }
    }

    else if (v39)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v39);
    }

    *(a5 + 80) = 0;
    *(a5 + 48) = 0u;
    *(a5 + 64) = 0u;
    *(a5 + 16) = 0u;
    *(a5 + 32) = 0u;
    *a5 = 0u;
    v43 = v9[49];
    v42 = v9[50];
    if (v42)
    {
      atomic_fetch_add_explicit(&v42->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    v44 = v9[48];
    v54 = v43;
    if (v44 && (v45 = std::__shared_weak_count::lock(v44)) != 0)
    {
      v56 = v45;
      v46 = v9[47];
    }

    else
    {
      v46 = 0;
      v56 = 0;
    }

    v47 = v28;
    v48 = a2;
    if (v46[4455] < 0)
    {
      std::string::__init_copy_ctor_external(&v63, *(v46 + 554), *(v46 + 555));
    }

    else
    {
      v63 = *(v46 + 4432);
    }

    v49 = v24;
    v50 = *(a4 + 8);
    v61 = *a4;
    v62 = v50;
    if (v50)
    {
      atomic_fetch_add_explicit(&v50->__shared_weak_owners_, 1uLL, memory_order_relaxed);
    }

    v51 = *(v48 + 16);
    ims::getQueue(&object);
    if (v25)
    {
      v52 = 1;
    }

    else
    {
      v52 = v47;
    }

    LODWORD(v53) = a3;
    RTPManager::createSession(v54, &v63, v57, v55, &v61, v51, a5, v49, v52, (v9 + 124), v53, &object);
    if (object)
    {
      dispatch_release(object);
    }

    if (v62)
    {
      std::__shared_weak_count::__release_weak(v62);
    }

    if (SHIBYTE(v63.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v63.__r_.__value_.__l.__data_);
    }

    if (v56)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v56);
    }

    if (v42)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v42);
    }

    if ((*(**(a5 + 8) + 24))(*(a5 + 8), *(a5 + 16)))
    {
      BambiClient::setMediaSessionIdForStream(a1, v48, 0);
    }

    if (SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v64.__r_.__value_.__l.__data_);
    }
  }

  else
  {
    v30 = a1[2];
    v29 = a1 + 2;
    v31 = (*(v30 + 56))(v29);
    (*(*v29 + 16))(v29, v31);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), "No valid call", 13);
    *(v31 + 17) = 0;
    (*(*v31 + 64))(v31, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v31 + 17) = 0;
    *(a5 + 40) = 0u;
    *(a5 + 56) = 0u;
    *(a5 + 72) = 0u;
    *a5 = &unk_1F5EBDEF8;
    *(a5 + 8) = &_bambiDomain;
    *(a5 + 16) = 0x40000000;
    *(a5 + 24) = 0;
    *(a5 + 32) = 0;
  }

  if (v10)
  {
LABEL_97:
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }
}

void sub_1E5112CAC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, std::__shared_weak_count *a18, uint64_t a19, uint64_t a20, uint64_t a21, dispatch_object_t object, uint64_t a23, std::__shared_weak_count *a24, void *__p, uint64_t a26, int a27, __int16 a28, char a29, char a30)
{
  if (*(v30 - 89) < 0)
  {
    operator delete(*(v30 - 112));
  }

  if (a18)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a18);
  }

  _Unwind_Resume(exception_object);
}

void *BambiClient::setMediaSessionIdForStream(void *this, BambiCallMediaStream *a2, uint64_t a3)
{
  if (a2)
  {
    v3 = a3;
    v5 = *(a2 + 6);
    if (v5 != a3)
    {
      v6 = this;
      if (a3)
      {
        if (v5)
        {
          v7 = this + 2;
          v8 = (*(this[2] + 56))(this + 2);
          (*(*v7 + 16))(v7, v8);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Tried to setMediaSessionIdForCall to ", 37);
          *(v8 + 17) = 0;
          MEMORY[0x1E69233B0](*(v8 + 8), v3);
          *(v8 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " while we have an active mediaSessionId ", 40);
          *(v8 + 17) = 0;
          v3 = *(a2 + 6);
LABEL_36:
          MEMORY[0x1E69233B0](*(v8 + 8), v3);
          *(v8 + 17) = 0;
          this = (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v8 + 17) = 0;
          return this;
        }

LABEL_35:
        BambiCallMediaStream::setMediaSessionId(a2, v3);
        v21 = v6[2];
        v20 = v6 + 2;
        v8 = (*(v21 + 64))(v20);
        (*(*v20 + 16))(v20, v8);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "setMediaSessionIdForCall to ", 28);
        *(v8 + 17) = 0;
        goto LABEL_36;
      }

      v9 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(this + 39, v5);
      if (!v9)
      {
        goto LABEL_35;
      }

      v10 = v6[40];
      v11 = *v9;
      v12 = v9[1];
      v13 = vcnt_s8(v10);
      v13.i16[0] = vaddlv_u8(v13);
      if (v13.u32[0] > 1uLL)
      {
        if (v12 >= *&v10)
        {
          v12 %= *&v10;
        }
      }

      else
      {
        v12 &= *&v10 - 1;
      }

      v14 = v6[39];
      v15 = *(v14 + 8 * v12);
      do
      {
        v16 = v15;
        v15 = *v15;
      }

      while (v15 != v9);
      if (v16 == v6 + 41)
      {
        goto LABEL_24;
      }

      v17 = v16[1];
      if (v13.u32[0] > 1uLL)
      {
        if (v17 >= *&v10)
        {
          v17 %= *&v10;
        }
      }

      else
      {
        v17 &= *&v10 - 1;
      }

      if (v17 != v12)
      {
LABEL_24:
        if (v11)
        {
          v18 = *(v11 + 8);
          if (v13.u32[0] > 1uLL)
          {
            v19 = *(v11 + 8);
            if (v18 >= *&v10)
            {
              v19 = v18 % *&v10;
            }
          }

          else
          {
            v19 = v18 & (*&v10 - 1);
          }

          if (v19 == v12)
          {
            goto LABEL_28;
          }
        }

        *(v14 + 8 * v12) = 0;
        v11 = *v9;
      }

      if (!v11)
      {
LABEL_34:
        *v16 = v11;
        *v9 = 0;
        --v6[42];
        operator delete(v9);
        goto LABEL_35;
      }

      v18 = *(v11 + 8);
LABEL_28:
      if (v13.u32[0] > 1uLL)
      {
        if (v18 >= *&v10)
        {
          v18 %= *&v10;
        }
      }

      else
      {
        v18 &= *&v10 - 1;
      }

      if (v18 != v12)
      {
        *(v6[39] + 8 * v18) = v16;
        v11 = *v9;
      }

      goto LABEL_34;
    }
  }

  return this;
}

void BambiClient::handleIncomingUssdSession(uint64_t a1@<X0>, uint64_t *a2@<X1>, ImsResult *a3@<X8>)
{
  v5 = *(a1 + 776);
  if (!v5)
  {
    v7 = 0;
    goto LABEL_9;
  }

  v7 = std::__shared_weak_count::lock(v5);
  if (!v7 || !*(a1 + 768))
  {
LABEL_9:
    v17 = 0u;
    v18 = 0u;
    v19 = 0u;
    v20 = 0u;
    v14 = &unk_1F5EBDEF8;
    v15 = &_bambiDomain;
    v16 = 1073741826;
    v10 = ImsResult::operator<<<char [17]>(&v14, "no USSD delegate");
    ImsResult::ImsResult(a3, v10);
    ImsResult::~ImsResult(&v14);
    if (!v7)
    {
      return;
    }

    goto LABEL_10;
  }

  v8 = *a2;
  if (*a2)
  {
    v14 = 0;
    v15 = 0;
    v9 = a2[1];
    v12 = v8;
    v13 = v9;
    if (v9)
    {
      atomic_fetch_add_explicit((v9 + 8), 1uLL, memory_order_relaxed);
    }

    BambiUssdSession::create();
  }

  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v14 = &unk_1F5EBDEF8;
  v15 = &_bambiDomain;
  v16 = 1073741826;
  v11 = ImsResult::operator<<<char [18]>(&v14, "invalid SIP stack");
  ImsResult::ImsResult(a3, v11);
  ImsResult::~ImsResult(&v14);
LABEL_10:
  std::__shared_weak_count::__release_shared[abi:ne200100](v7);
}

void sub_1E51132C0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, std::__shared_weak_count *a11, uint64_t a12, std::__shared_weak_count *a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, char a18)
{
  if (a13)
  {
    std::__shared_weak_count::__release_weak(a13);
  }

  if (a11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a11);
    if (!v20)
    {
LABEL_5:
      if (!v19)
      {
LABEL_10:
        std::__shared_weak_count::__release_shared[abi:ne200100](v18);
        _Unwind_Resume(a1);
      }

LABEL_9:
      std::__shared_weak_count::__release_shared[abi:ne200100](v19);
      goto LABEL_10;
    }
  }

  else if (!v20)
  {
    goto LABEL_5;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v20);
  if (!v19)
  {
    goto LABEL_10;
  }

  goto LABEL_9;
}

void BambiClient::canAcceptIncomingSession(uint64_t a1@<X0>, uint64_t *a2@<X1>, SipStack **a3@<X2>, uint64_t a4@<X8>)
{
  v6 = *a3;
  if (!*a3)
  {
    *v37 = 0u;
    v38 = 0u;
    v39 = 0u;
    *v40 = 0u;
    __p.__r_.__value_.__r.__words[0] = &unk_1F5EBDEF8;
    __p.__r_.__value_.__l.__size_ = &_bambiDomain;
    LODWORD(__p.__r_.__value_.__r.__words[2]) = 1073741826;
    v18 = ImsResult::operator<<<char [18]>(&__p, "invalid SIP stack");
    v19 = ImsLogContainer::logResult(a1 + 16, v18);
    ImsResult::ImsResult(a4, v19);
    ImsResult::~ImsResult(&__p);
    return;
  }

  v9 = *(a1 + 368);
  if (v9)
  {
    do
    {
      v10 = *(v9[2] + 408);
      if (!v10 || (SipSession::confirmed(v10) & 1) == 0)
      {
        v21 = *(a1 + 16);
        v20 = a1 + 16;
        v22 = (*(v21 + 64))(v20);
        (*(*v20 + 16))(v20, v22);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "Can not handle incoming call during an existing unconfirmed call", 64);
        *(v22 + 17) = 0;
        (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v22 + 17) = 0;
        v23 = *a3;
        std::string::basic_string[abi:ne200100]<0>(v35, "EstablishingAnotherCall");
        SipStack::callTerminationReason(v23);
      }

      if (*(v9[2] + 552))
      {
        SipStack::carrierIdentifier(*a3, &__p);
        v11 = *(ImsPrefsManager::emergencyPrefs(&__p.__r_.__value_.__l.__data_) + 1);
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }

        if ((v11 & 1) == 0)
        {
          v30 = *a3;
          std::string::basic_string[abi:ne200100]<0>(v35, "OnEmergencyCall");
          SipStack::callTerminationReason(v30);
        }
      }

      v9 = *v9;
    }

    while (v9);
    v6 = *a3;
  }

  if (!SipStack::callCount(v6))
  {
    goto LABEL_24;
  }

  if (*(*a3 + 2773) != 1 || *a2 && (v12 = SipMessage::body<SipCallWaitingInfoBody>(*a2)) != 0 && (v12[12] & 1) != 0)
  {
    if (*a2)
    {
      v13 = SipMessage::body<SipSdpBody>(*a2);
      if (v13)
      {
        v15 = v13[1];
        v14 = v13[2];
        if (v14)
        {
          atomic_fetch_add_explicit(&v14->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        if (v15 && (*(*a3 + 2774) & 1) == 0)
        {
          v34 = *(v15 + 56);
          v33 = *(v15 + 57);
          while (v34 != v33)
          {
            if (*(v34 + 12) == 3)
            {
              *(a4 + 24) = 0u;
              *(a4 + 40) = 0u;
              *(a4 + 56) = 0u;
              *(a4 + 72) = 0u;
              *a4 = &unk_1F5EBDEF8;
              *(a4 + 8) = &SipResultDomain::_domain;
              *(a4 + 16) = 486;
              if (v14)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v14);
              }

              return;
            }

            v34 += 200;
          }
        }

        if (v14)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v14);
        }
      }
    }

LABEL_24:
    v16 = *a3;
    v17 = SipStack::prefs(*a3);
    if (!ImsPrefs::EnableSignalingReduction(v17) || *(v16 + 4376) != 1 || (*(*a3 + 4504) & 1) != 0)
    {
      *(a4 + 24) = 0u;
      *(a4 + 40) = 0u;
      *(a4 + 56) = 0u;
      *(a4 + 72) = 0u;
      *a4 = &unk_1F5EBDEF8;
      *(a4 + 8) = &_bambiDomain;
      *(a4 + 16) = 0;
      return;
    }

    v32 = *(a1 + 16);
    v31 = a1 + 16;
    v26 = (*(v32 + 64))(v31);
    (*(*v31 + 16))(v31, v26);
    v27 = *(v26 + 8);
    v28 = "Can not handle incoming call while in limited connectivity";
    v29 = 58;
    goto LABEL_33;
  }

  v25 = *(a1 + 16);
  v24 = a1 + 16;
  v26 = (*(v25 + 64))(v24);
  (*(*v24 + 16))(v24, v26);
  v27 = *(v26 + 8);
  v28 = "network based call waiting is enabled. Incoming INVITEs must have a CW indication";
  v29 = 81;
LABEL_33:
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v27, v28, v29);
  *(v26 + 17) = 0;
  (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v26 + 17) = 0;
  *(a4 + 24) = 0u;
  *(a4 + 40) = 0u;
  *(a4 + 56) = 0u;
  *(a4 + 72) = 0u;
  *a4 = &unk_1F5EBDEF8;
  *(a4 + 8) = &SipResultDomain::_domain;
  *(a4 + 16) = 486;
}

void sub_1E5113878(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, uint64_t a16, int a17, __int16 a18, char a19, char a20)
{
  BambiCallTerminationReason::~BambiCallTerminationReason(&a15);
  if (a14 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(a1);
}

void BambiClient::handleIncomingSession(uint64_t a1@<X0>, std::__shared_weak_count **a2@<X1>, uint64_t *a3@<X2>, ImsResult *a4@<X8>)
{
  v6 = *(a1 + 760);
  if (v6)
  {
    v9 = std::__shared_weak_count::lock(v6);
    if (v9 && *(a1 + 752))
    {
      memset(v20, 0, 88);
      v10 = *a3;
      v11 = a3[1];
      v19[0] = v10;
      v19[1] = v11;
      if (v11)
      {
        atomic_fetch_add_explicit(&v11->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      SipSessionInterface::stack(*a2, &v17);
      BambiClient::canAcceptIncomingSession(a1, v19, &v17, v20);
      if (v18)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v18);
      }

      if (v11)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v11);
      }

      if (!(*(**(&v20[0] + 1) + 24))(*(&v20[0] + 1), LODWORD(v20[1])))
      {
        v15 = 0;
        v16 = 0;
        SipSessionInterface::stack(*a2, &v14);
        operator new();
      }

      ImsResult::ImsResult(a4, v20);
      ImsResult::~ImsResult(v20);
      goto LABEL_16;
    }
  }

  else
  {
    v9 = 0;
  }

  memset(&v20[1] + 8, 0, 64);
  *&v20[0] = &unk_1F5EBDEF8;
  *(&v20[0] + 1) = &_bambiDomain;
  LODWORD(v20[1]) = 1073741826;
  v12 = ImsResult::operator<<<char [49]>(v20, "no call manager delegate to handle incoming call");
  v13 = ImsLogContainer::logResult(a1 + 16, v12);
  ImsResult::ImsResult(a4, v13);
  ImsResult::~ImsResult(v20);
  if (v9)
  {
LABEL_16:
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  }
}

void sub_1E5113E28(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, ...)
{
  va_start(va, a15);
  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v19 = *(v17 - 104);
  if (v19)
  {
    std::__shared_weak_count::__release_weak(v19);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  ImsResult::~ImsResult(va);
  std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  _Unwind_Resume(a1);
}

void BambiClient::handleIncomingLazuliSession(uint64_t a1, std::__shared_weak_count **a2)
{
  v2[2] = 0;
  v2[3] = 0;
  SipSessionInterface::stack(*a2, v2);
  std::allocate_shared[abi:ne200100]<LazuliSession,std::allocator<LazuliSession>,std::shared_ptr<SipStack>,0>();
}

void sub_1E5114038(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, std::__shared_weak_count *a13, uint64_t a14, uint64_t a15)
{
  if (a13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a13);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::handleRTPManagerInitializationStatus(BambiClient *this, uint64_t a2, uint64_t a3)
{
  v6 = (this + 16);
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleRTPManagerInitializationStatus appId: ", 44);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923340](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " result: ", 9);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923320](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  for (i = v6[31]; i; i = *i)
  {
    v19 = 0;
    *__p = 0u;
    v18 = 0u;
    std::pair<std::string const,std::shared_ptr<MessageSession>>::pair[abi:ne200100](__p, i + 1);
    v10 = *(&v18 + 1);
    v9 = v19;
    if (v19)
    {
      atomic_fetch_add_explicit(&v19->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    if (v10 && *(v10 + 297) == a2)
    {
      v11 = (*(*v6 + 64))(v6);
      (*(*v6 + 16))(v6, v11);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "sip stack media initialized", 27);
      *(v11 + 17) = 0;
      (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v11 + 17) = 0;
      SipStack::setMediaInitialized(v10, a3);
    }

    if (v9)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v9);
    }

    if (v19)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v19);
    }

    if (SBYTE7(v18) < 0)
    {
      operator delete(__p[0]);
    }
  }

  v12 = *(this + 29);
  if (*(v12 + 297) != a2)
  {
    v13 = *(v12 + 4512);
    v14 = *(v12 + 4520);
    if (v14)
    {
      atomic_fetch_add_explicit(&v14->__shared_owners_, 1uLL, memory_order_relaxed);
      v15 = *(v13 + 251);
      std::__shared_weak_count::__release_shared[abi:ne200100](v14);
      if (v15 != 1)
      {
        return;
      }
    }

    else if ((*(v13 + 251) & 1) == 0)
    {
      return;
    }
  }

  v16 = (*(*(this + 2) + 64))(v6);
  (*(*(this + 2) + 16))(v6, v16);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "emergency sip stack media initialized", 37);
  *(v16 + 17) = 0;
  (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v16 + 17) = 0;
  SipStack::setMediaInitialized(*(this + 29), a3);
}

void sub_1E51143D0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  if (v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  }

  std::pair<std::string const,std::shared_ptr<MessageSession>>::~pair(&a9);
  _Unwind_Resume(a1);
}

void BambiClient::handleMediaSessionCreatedStatus(BambiClient *this, unint64_t a2, uint64_t a3)
{
  v6 = (this + 16);
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleMediaSessionCreatedStatus: ", 33);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " result: ", 9);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923320](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v8 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(v6 + 37, a2);
  if (v8)
  {
    if (a3)
    {
      v9 = v8[3];
      if (v9)
      {
        v10 = *(v9 + 40);
        if (v10)
        {
          v11 = *(v9 + 32);
          atomic_fetch_add_explicit(&v10->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          v12 = std::__shared_weak_count::lock(v10);
          std::__shared_weak_count::__release_weak(v10);
          if (v12 && v11)
          {
            if (*(v11 + 1529) == 1)
            {
              if ((*(*v11 + 80))(v11))
              {
                BambiCall::notifyMergedCallInitialized(v11);
              }

              BambiCall::setMediaSessionCreated(v11);
            }

            else
            {
              BambiCall::setMediaSessionConfigured(v11);
            }

LABEL_14:

            std::__shared_weak_count::__release_shared[abi:ne200100](v12);
            return;
          }

LABEL_13:
          v13 = (*(*v6 + 56))(v6);
          (*(*v6 + 16))(v6, v13);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "handleMediaSessionCreatedStatus couldn't find BambiCall with sessionId: ", 72);
          *(v13 + 17) = 0;
          MEMORY[0x1E69233B0](*(v13 + 8), a2);
          *(v13 + 17) = 0;
          (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v13 + 17) = 0;
          RTPManager::terminateSessionWithId(*(this + 27), a2);
          if (!v12)
          {
            return;
          }

          goto LABEL_14;
        }
      }

LABEL_12:
      v12 = 0;
      goto LABEL_13;
    }
  }

  else if (a3)
  {
    goto LABEL_12;
  }

  BambiClient::terminateCallDueToMediaError(this, a2, 9);
}

void BambiClient::terminateCallDueToMediaError(uint64_t a1, unint64_t a2, int a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>((a1 + 312), a2);
  if (!v6)
  {
    goto LABEL_14;
  }

  v7 = v6[3];
  if (!v7)
  {
    goto LABEL_14;
  }

  if (*(v7 + 64) != 4)
  {
    v12 = *(v7 + 40);
    if (v12)
    {
      v13 = *(v7 + 32);
      atomic_fetch_add_explicit(&v12->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v14 = std::__shared_weak_count::lock(v12);
      std::__shared_weak_count::__release_weak(v12);
      if (v14 && v13)
      {
        v16 = *(v13 + 49);
        v15 = *(v13 + 50);
        if (v15)
        {
          atomic_fetch_add_explicit(&v15->__shared_owners_, 1uLL, memory_order_relaxed);
          std::__shared_weak_count::__release_shared[abi:ne200100](v15);
          if (v16)
          {
            v16 = *(v13 + 49);
            v17 = *(v13 + 50);
            if (v17)
            {
              v18 = 0;
              atomic_fetch_add_explicit(&v17->__shared_owners_, 1uLL, memory_order_relaxed);
              goto LABEL_21;
            }

LABEL_20:
            v18 = 1;
LABEL_21:
            RTPManager::terminateSessionWithId(v16, a2);
            if ((v18 & 1) == 0)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v17);
            }

            BambiClient::setMediaSessionIdForStream(a1, v7, 0);
            memset(&v56, 0, sizeof(v56));
            std::string::basic_string[abi:ne200100]<0>(&v56, "MediaError");
            memset(&v55, 0, sizeof(v55));
            std::string::basic_string[abi:ne200100]<0>(&v55, "");
            switch(a3)
            {
              case 5:
                if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                {
                  v56.__r_.__value_.__l.__size_ = 12;
                  v25 = v56.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v56.__r_.__value_.__s + 23) = 12;
                  v25 = &v56;
                }

                strcpy(v25, "MediaTimeout");
                if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
                {
                  v55.__r_.__value_.__l.__size_ = 11;
                  v31 = v55.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v55.__r_.__value_.__s + 23) = 11;
                  v31 = &v55;
                }

                strcpy(v31, "RTP Timeout");
                break;
              case 6:
                if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                {
                  v56.__r_.__value_.__l.__size_ = 21;
                  v24 = v56.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v56.__r_.__value_.__s + 23) = 21;
                  v24 = &v56;
                }

                strcpy(v24, "MediaHeartbeatTimeout");
                if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
                {
                  v55.__r_.__value_.__l.__size_ = 12;
                  v30 = v55.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v55.__r_.__value_.__s + 23) = 12;
                  v30 = &v55;
                }

                strcpy(v30, "RTCP Timeout");
                break;
              case 7:
                if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                {
                  v56.__r_.__value_.__l.__size_ = 9;
                  v20 = v56.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v56.__r_.__value_.__s + 23) = 9;
                  v20 = &v56;
                }

                strcpy(v20, "AudioUnit");
                if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
                {
                  v55.__r_.__value_.__l.__size_ = 10;
                  v32 = v55.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v55.__r_.__value_.__s + 23) = 10;
                  v32 = &v55;
                }

                strcpy(v32, "Audio Unit");
                break;
              default:
                v26 = *(v13 + 48);
                if (v26)
                {
                  v27 = std::__shared_weak_count::lock(v26);
                  if (v27)
                  {
                    v28 = *(v13 + 47);
                    if (v28)
                    {
                      if (*(v28 + 4626) == 1)
                      {
                        if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                        {
                          v56.__r_.__value_.__l.__size_ = 19;
                          v29 = v56.__r_.__value_.__r.__words[0];
                        }

                        else
                        {
                          *(&v56.__r_.__value_.__s + 23) = 19;
                          v29 = &v56;
                        }

                        strcpy(v29, "RequiresRedialError");
                        std::string::__assign_external(&v55, "Media error requires redial", 0x1BuLL);
LABEL_62:
                        std::__shared_weak_count::__release_shared[abi:ne200100](v27);
                        break;
                      }
                    }
                  }
                }

                else
                {
                  v27 = 0;
                }

                if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                {
                  v56.__r_.__value_.__l.__size_ = 10;
                  v33 = v56.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v56.__r_.__value_.__s + 23) = 10;
                  v33 = &v56;
                }

                strcpy(v33, "MediaError");
                if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
                {
                  v55.__r_.__value_.__l.__size_ = 19;
                  v34 = v55.__r_.__value_.__r.__words[0];
                }

                else
                {
                  *(&v55.__r_.__value_.__s + 23) = 19;
                  v34 = &v55;
                }

                strcpy(v34, "Unknown media error");
                if (v27)
                {
                  goto LABEL_62;
                }

                break;
            }

            if (!*(v13 + 69))
            {
              goto LABEL_78;
            }

            v35 = *(v13 + 48);
            if (!v35)
            {
              goto LABEL_78;
            }

            v36 = std::__shared_weak_count::lock(v35);
            if (!v36)
            {
              goto LABEL_78;
            }

            v37 = v36;
            if (*(v13 + 47))
            {
              v38 = *(v13 + 48);
              if (v38)
              {
                v38 = std::__shared_weak_count::lock(v38);
                v39 = v38;
                if (v38)
                {
                  v38 = *(v13 + 47);
                }
              }

              else
              {
                v39 = 0;
              }

              v40 = SipStack::prefs(v38);
              if (ImsPrefs::ContinueEmergencyCallOnMediaTimeout(v40))
              {
                if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                {
                  if (v56.__r_.__value_.__l.__size_ == 12)
                  {
                    v41 = v56.__r_.__value_.__r.__words[0];
LABEL_86:
                    v45 = v41->__r_.__value_.__r.__words[0];
                    v46 = LODWORD(v41->__r_.__value_.__r.__words[1]);
                    if (v45 == *"MediaTimeout" && v46 == *"eout")
                    {
                      if (v39)
                      {
                        std::__shared_weak_count::__release_shared[abi:ne200100](v39);
                      }

                      std::__shared_weak_count::__release_shared[abi:ne200100](v37);
                      goto LABEL_97;
                    }
                  }
                }

                else if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) == 12)
                {
                  v41 = &v56;
                  goto LABEL_86;
                }

                v48 = std::operator==[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(&v56, "MediaHeartbeatTimeout");
                if (v39)
                {
                  std::__shared_weak_count::__release_shared[abi:ne200100](v39);
                }

                std::__shared_weak_count::__release_shared[abi:ne200100](v37);
                if (v48)
                {
LABEL_97:
                  v50 = *(a1 + 16);
                  v49 = a1 + 16;
                  v51 = (*(v50 + 48))(v49);
                  (*(*v49 + 16))(v49, v51);
                  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v51 + 8), "a media error has been detected, but the emergency call will be continued", 73);
                  *(v51 + 17) = 0;
                  (*(*v51 + 64))(v51, std::endl[abi:ne200100]<char,std::char_traits<char>>);
                  *(v51 + 17) = 0;
                  BambiCall::suspendWithMediaError(v13, &v56, v54);
                  ImsResult::~ImsResult(v54);
LABEL_80:
                  if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
                  {
                    operator delete(v55.__r_.__value_.__l.__data_);
                  }

                  if (SHIBYTE(v56.__r_.__value_.__r.__words[2]) < 0)
                  {
                    operator delete(v56.__r_.__value_.__l.__data_);
                  }

                  goto LABEL_16;
                }

LABEL_78:
                BambiCall::endWithReason(v13, v53);
                ImsResult::~ImsResult(v53);
                v43 = *(a1 + 16);
                v42 = a1 + 16;
                v44 = (*(v43 + 32))(v42);
                (*(*v42 + 16))(v42, v44);
                std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v44 + 8), "terminating call with media session id: ", 40);
                *(v44 + 17) = 0;
                MEMORY[0x1E69233B0](*(v44 + 8), a2);
                *(v44 + 17) = 0;
                std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v44 + 8), " due to ", 8);
                *(v44 + 17) = 0;
                LoggableString::LoggableString(&__p, &v55);
                (*(*v44 + 40))(v44, &__p);
                (*(*v44 + 64))(v44, std::endl[abi:ne200100]<char,std::char_traits<char>>);
                *(v44 + 17) = 0;
                if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
                {
                  operator delete(__p.__r_.__value_.__l.__data_);
                }

                goto LABEL_80;
              }

              if (v39)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v39);
              }
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v37);
            goto LABEL_78;
          }
        }

        else if (v16)
        {
          v17 = 0;
          goto LABEL_20;
        }

        v22 = *(a1 + 16);
        v21 = a1 + 16;
        v23 = (*(v22 + 56))(v21);
        (*(*v21 + 16))(v21, v23);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "No valid mediaManager", 21);
        *(v23 + 17) = 0;
        (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v23 + 17) = 0;
LABEL_16:
        std::__shared_weak_count::__release_shared[abi:ne200100](v14);
        return;
      }

LABEL_15:
      v19 = (*(*(a1 + 16) + 56))(a1 + 16);
      (*(*(a1 + 16) + 16))(a1 + 16, v19);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "couldn't find a call for Media Session. Terminating session id:", 63);
      *(v19 + 17) = 0;
      MEMORY[0x1E69233B0](*(v19 + 8), a2);
      *(v19 + 17) = 0;
      (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v19 + 17) = 0;
      RTPManager::terminateSessionWithId(*(a1 + 216), a2);
      if (!v14)
      {
        return;
      }

      goto LABEL_16;
    }

LABEL_14:
    v14 = 0;
    goto LABEL_15;
  }

  v9 = *(a1 + 16);
  v8 = (a1 + 16);
  v10 = (*(v9 + 64))(v8);
  (*(*v8 + 16))(v8, v10);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "Media error in RTT session does not lead to a call drop", 55);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  v11 = v8[25];

  RTPManager::terminateSessionWithId(v11, a2);
}

void sub_1E5115088(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  if (*(v17 - 105) < 0)
  {
    operator delete(*(v17 - 128));
  }

  if (*(v17 - 81) < 0)
  {
    operator delete(*(v17 - 104));
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  _Unwind_Resume(a1);
}

void BambiClient::handleUpdateSdpStatus(BambiClient *this, unint64_t a2, uint64_t a3)
{
  v6 = (this + 16);
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleUpdateSdpStatus: ", 23);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " result: ", 9);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923320](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v8 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(v6 + 37, a2);
  if (v8)
  {
    if (a3)
    {
      v9 = v8[3];
      if (v9)
      {
        v10 = *(v9 + 40);
        if (v10)
        {
          v11 = *(v9 + 32);
          atomic_fetch_add_explicit(&v10->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          v12 = std::__shared_weak_count::lock(v10);
          std::__shared_weak_count::__release_weak(v10);
          if (v12)
          {
            if (v11)
            {
              BambiCall::setMediaSessionConfigured(v11);
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v12);
          }
        }
      }

      return;
    }
  }

  else if (a3)
  {
    return;
  }

  BambiClient::terminateCallDueToMediaError(this, a2, 9);
}

void BambiClient::handleActivateMediaSessionStatus(uint64_t a1, unint64_t a2, int a3)
{
  v6 = (a1 + 16);
  v7 = (*(*(a1 + 16) + 64))(a1 + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleActivateMediaSessionStatus: ", 34);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " result: ", 9);
  *(v7 + 17) = 0;
  if (a3)
  {
    v8 = "failed";
  }

  else
  {
    v8 = "active";
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), v8, 6);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v9 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(v6 + 37, a2);
  if (v9 && !a3 && (v10 = v9[3]) != 0)
  {
    v11 = *(v10 + 40);
    if (v11)
    {
      v12 = *(v10 + 32);
      atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v13 = std::__shared_weak_count::lock(v11);
      std::__shared_weak_count::__release_weak(v11);
      if (v13)
      {
        if (!v12)
        {
LABEL_71:
          std::__shared_weak_count::__release_shared[abi:ne200100](v13);
          return;
        }

        v14 = *(v12 + 432);
        if (!v14)
        {
          v16 = 0;
LABEL_69:
          (*(*v12 + 72))(v12);
          if (v16)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v16);
          }

          goto LABEL_71;
        }

        v15 = *(v12 + 424);
        atomic_fetch_add_explicit(&v14->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v16 = std::__shared_weak_count::lock(v14);
        std::__shared_weak_count::__release_weak(v14);
        if (!v16 || !v15)
        {
          goto LABEL_69;
        }

        v17 = *(v12 + 384);
        if (v17)
        {
          v18 = std::__shared_weak_count::lock(v17);
          if (v18)
          {
            v19 = *(v12 + 376);
          }

          else
          {
            v19 = 0;
          }
        }

        else
        {
          v19 = 0;
          v18 = 0;
        }

        if (*(v19 + 4455) < 0)
        {
          std::string::__init_copy_ctor_external(&__p, *(v19 + 4432), *(v19 + 4440));
        }

        else
        {
          __p = *(v19 + 4432);
        }

        v20 = *(a1 + 216);
        if (v20)
        {
          v21 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v20 + 280, &__p.__r_.__value_.__l.__data_);
          LODWORD(v20) = v20 + 288 != v21 && *(v21 + 56) == 1;
        }

        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }

        if (v18)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v18);
        }

        if (!v20)
        {
          goto LABEL_69;
        }

        memset(&__p, 0, sizeof(__p));
        if (*(v12 + 1703) < 0)
        {
          std::string::__init_copy_ctor_external(&__p, *(v12 + 1680), *(v12 + 1688));
        }

        else
        {
          __p = *(v12 + 1680);
        }

        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          if (__p.__r_.__value_.__l.__size_ != 3)
          {
            if (__p.__r_.__value_.__l.__size_ == 6 && *__p.__r_.__value_.__l.__data_ == 760368449 && *(__p.__r_.__value_.__r.__words[0] + 4) == 16983)
            {
              v22 = 16000;
              goto LABEL_67;
            }

LABEL_49:
            v22 = 0;
            goto LABEL_67;
          }

          p_p = __p.__r_.__value_.__r.__words[0];
          if (*__p.__r_.__value_.__l.__data_ != 19777 || *(__p.__r_.__value_.__r.__words[0] + 2) != 82)
          {
LABEL_59:
            v27 = bswap32(LOWORD(p_p->__r_.__value_.__l.__data_) | (p_p->__r_.__value_.__s.__data_[2] << 16));
            v28 = v27 >= 0x45565300;
            v29 = v27 > 0x45565300;
            v30 = !v28;
            if (v29 == v30)
            {
              v22 = 16000;
            }

            else
            {
              v22 = 0;
            }

            goto LABEL_67;
          }
        }

        else
        {
          if (HIBYTE(__p.__r_.__value_.__r.__words[2]) != 3)
          {
            if (HIBYTE(__p.__r_.__value_.__r.__words[2]) == 6)
            {
              if (LODWORD(__p.__r_.__value_.__l.__data_) ^ 0x2D524D41 | WORD2(__p.__r_.__value_.__r.__words[0]) ^ 0x4257)
              {
                v22 = 0;
              }

              else
              {
                v22 = 16000;
              }

LABEL_67:
              (*(*v15 + 216))(v15, &__p, v22);
              if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
              {
                operator delete(__p.__r_.__value_.__l.__data_);
              }

              goto LABEL_69;
            }

            goto LABEL_49;
          }

          if (LOWORD(__p.__r_.__value_.__l.__data_) != 19777 || __p.__r_.__value_.__s.__data_[2] != 82)
          {
            p_p = &__p;
            goto LABEL_59;
          }
        }

        v22 = 8000;
        goto LABEL_67;
      }
    }
  }

  else
  {

    BambiClient::terminateCallDueToMediaError(a1, a2, a3);
  }
}

void sub_1E5115790(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  _Unwind_Resume(a1);
}

void BambiClient::handleDeactivateMediaSessionStatus(BambiClient *this, unint64_t a2, uint64_t a3)
{
  v6 = (this + 16);
  v7 = (*(*(this + 2) + 64))(this + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleDeactivateMediaSessionStatus: ", 36);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " result: ", 9);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923320](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v8 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(v6 + 37, a2);
  if (v8)
  {
    if (a3)
    {
      v9 = v8[3];
      if (v9)
      {
        v10 = *(v9 + 40);
        if (v10)
        {
          v11 = *(v9 + 32);
          atomic_fetch_add_explicit(&v10->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          v12 = std::__shared_weak_count::lock(v10);
          std::__shared_weak_count::__release_weak(v10);
          if (v12)
          {
            if (v11)
            {
              BambiCall::handleMediaSessionDeactivated(v11);
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v12);
          }
        }
      }

      return;
    }
  }

  else if (a3)
  {
    return;
  }

  BambiClient::terminateCallDueToMediaError(this, a2, 9);
}

void BambiClient::handleMediaSessionError(uint64_t a1, unint64_t a2, int a3)
{
  v6 = (a1 + 16);
  v7 = (*(*(a1 + 16) + 64))(a1 + 16);
  (*(*v6 + 16))(v6, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleMediaSessionError for Media session Id:", 45);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  v8 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(v6 + 37, a2);
  if (!v8 || (v9 = v8[3]) == 0 || (v10 = *(v9 + 40)) == 0)
  {
    v12 = 0;
    goto LABEL_12;
  }

  v11 = *(v9 + 32);
  atomic_fetch_add_explicit(&v10->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  v12 = std::__shared_weak_count::lock(v10);
  std::__shared_weak_count::__release_weak(v10);
  if (!v12 || !v11)
  {
    goto LABEL_12;
  }

  v13 = *(v11 + 408);
  if (v13)
  {
    LOBYTE(v13) = SipSession::confirmed(v13);
  }

  if (a3 != 6 || (v13 & 1) != 0)
  {
LABEL_12:
    BambiClient::terminateCallDueToMediaError(a1, a2, a3);
    if (!v12)
    {
      return;
    }

    goto LABEL_13;
  }

  v14 = (*(*v6 + 64))(v6);
  (*(*v6 + 16))(v6, v14);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "handleMediaSessionError ignoring RTCP timeout for unconfirmed call", 66);
  *(v14 + 17) = 0;
  (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v14 + 17) = 0;
LABEL_13:

  std::__shared_weak_count::__release_shared[abi:ne200100](v12);
}

void BambiClient::handleBurstDtmfSendComplete(BambiClient *this)
{
  v2 = *(this + 95);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 94);
      if (v5)
      {
        (*(*v5 + 8))(v5);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void BambiClient::handleCallTerminationEvent(BambiClient *this, char **lpsrc)
{
  if (lpsrc)
  {
    v3 = **lpsrc;
    if (v4)
    {
      if ((v4[8] | 4) != 4)
      {
        v13 = *(this + 2);
        v12 = this + 16;
        v8 = (*(v13 + 64))(v12);
        (*(*v12 + 16))(v12, v8);
        v9 = *(v8 + 8);
        v10 = "call termination wasn't local hangup. Not checking for held call to resume.";
        v11 = 75;
        goto LABEL_9;
      }

      BambiClient::activeCall(this, &v43);
      v5 = v43;
      if (v44)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v44);
      }

      if (v5)
      {
        v7 = *(this + 2);
        v6 = this + 16;
        v8 = (*(v7 + 64))(v6);
        (*(*v6 + 16))(v6, v8);
        v9 = *(v8 + 8);
        v10 = "we already have an active call. Not checking for held call to resume.";
        v11 = 69;
LABEL_9:
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v10, v11);
        *(v8 + 17) = 0;
        (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v8 + 17) = 0;
        return;
      }

      v43 = 0;
      v44 = 0;
      v45 = 0;
      v40 = 0;
      v41 = 0;
      BambiClient::unconfirmedCallsExcludingCall(this, &v43, &v40);
      if (v43 != v44)
      {
        v15 = *(this + 2);
        v14 = this + 16;
        v16 = (*(v15 + 64))(v14);
        (*(*v14 + 16))(v14, v16);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "we have an unconfirmed call. Not checking for held call to resume.", 66);
        *(v16 + 17) = 0;
        (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v16 + 17) = 0;
LABEL_39:
        v40 = &v43;
        std::vector<std::shared_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](&v40);
        return;
      }

      v40 = 0;
      v41 = 0;
      v42 = 0;
      v17 = *(this + 46);
      if (!v17)
      {
        goto LABEL_32;
      }

      do
      {
        v18 = *(v17 + 2);
        if (v18)
        {
          if (*(v18 + 480) == 3)
          {
            v19 = *(v18 + 408);
            if (!v19 || ((*(*v19 + 264))(v19) & 1) == 0)
            {
              std::vector<std::shared_ptr<LazuliHeader>>::push_back[abi:ne200100](&v40, v17 + 1);
            }
          }
        }

        v17 = *v17;
      }

      while (v17);
      v20 = v40;
      v21 = v41;
      if (v40 == v41)
      {
LABEL_32:
        v33 = *(this + 2);
        v32 = this + 16;
        v34 = (*(v33 + 64))(v32);
        (*(*v32 + 16))(v32, v34);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v34 + 8), "no held call to resume", 22);
        *(v34 + 17) = 0;
        (*(*v34 + 64))(v34, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v34 + 17) = 0;
LABEL_38:
        v46 = &v40;
        std::vector<std::shared_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](&v46);
        goto LABEL_39;
      }

      v22 = 0;
      v23 = 0;
      do
      {
        v24 = *v20;
        if (!v22 || v24[19].__shared_weak_owners_ > v22[19].__shared_weak_owners_)
        {
          v25 = v20[1];
          if (v25)
          {
            atomic_fetch_add_explicit(&v25->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          if (v23)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v23);
          }

          v23 = v25;
          v22 = v24;
        }

        v20 += 2;
      }

      while (v20 != v21);
      if (v22)
      {
        v27 = *(this + 2);
        v26 = this + 16;
        v28 = *(v27 + 64);
        if (BYTE2(v22[76].__shared_weak_owners_) != 1)
        {
          v38 = v28(v26);
          (*(*v26 + 16))(v26, v38);
          v39 = ImsOutStream::operator<<(v38, "call ended due to local hangup. Auto-resuming last held call.");
          (*(*v39 + 64))(v39, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          v39[17] = 0;
          BambiCall::performLocalResume(v22);
LABEL_36:
          if (v23)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v23);
          }

          goto LABEL_38;
        }

        v29 = v28(v26);
        (*(*v26 + 16))(v26, v29);
        v30 = ImsOutStream::operator<<(v29, "last held call held by user, not auto-resuming call.");
        (*(*v30 + 64))(v30, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        v31 = (v30 + 17);
      }

      else
      {
        v36 = *(this + 2);
        v35 = this + 16;
        v37 = (*(v36 + 56))(v35);
        (*(*v35 + 16))(v35, v37);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v37 + 8), "no last held call to resume", 27);
        *(v37 + 17) = 0;
        v31 = (v37 + 17);
        (*(*v37 + 64))(v37, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      }

      *v31 = 0;
      goto LABEL_36;
    }
  }
}

void sub_1E5116350(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, char a10, uint64_t a11, uint64_t a12, char a13, uint64_t a14, uint64_t a15, void **a16)
{
  if (v16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  }

  a16 = &a10;
  std::vector<std::shared_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](&a16);
  a16 = &a13;
  std::vector<std::shared_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](&a16);
  _Unwind_Resume(a1);
}

uint64_t BambiClient::activeCall@<X0>(uint64_t this@<X0>, void *a2@<X8>)
{
  v3 = *(this + 368);
  if (v3)
  {
    while (1)
    {
      this = *(v3[2] + 408);
      if (this)
      {
        this = SipSession::confirmed(this);
        if (this)
        {
          v4 = v3[2];
          if ((*(v4 + 480) & 0xFFFFFFFE) != 2)
          {
            this = *(v4 + 408);
            if (!this)
            {
              goto LABEL_13;
            }

            this = SipSession::terminating(this);
            if ((this & 1) == 0)
            {
              v4 = v3[2];
              this = *(v4 + 408);
              if (!this)
              {
                goto LABEL_13;
              }

              this = (*(*this + 264))(this);
              if ((this & 1) == 0)
              {
                break;
              }
            }
          }
        }
      }

      v3 = *v3;
      if (!v3)
      {
        goto LABEL_10;
      }
    }

    v4 = v3[2];
LABEL_13:
    v5 = v3[3];
    *a2 = v4;
    a2[1] = v5;
    if (v5)
    {
      atomic_fetch_add_explicit((v5 + 8), 1uLL, memory_order_relaxed);
    }
  }

  else
  {
LABEL_10:
    *a2 = 0;
    a2[1] = 0;
  }

  return this;
}

void BambiClient::invalidateStream(BambiClient *this, BambiCallMediaStream *a2)
{
  if (a2)
  {
    v4 = *(a2 + 5);
    if (v4)
    {
      v5 = *(a2 + 4);
      atomic_fetch_add_explicit(&v4->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v6 = std::__shared_weak_count::lock(v4);
      std::__shared_weak_count::__release_weak(v4);
      if (v6 && v5)
      {
        v7 = *(v5 + 392);
        v8 = *(v5 + 400);
        if (v8)
        {
          atomic_fetch_add_explicit(&v8->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        RTPManager::terminateSessionWithId(v7, *(a2 + 6));
        if (v8)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v8);
        }
      }
    }

    else
    {
      v6 = 0;
    }

    BambiClient::setMediaSessionIdForStream(this, a2, 0);
    if (v6)
    {

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void sub_1E511653C(_Unwind_Exception *a1)
{
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  _Unwind_Resume(a1);
}

void BambiClient::invalidateCall(void *a1, unint64_t *a2)
{
  v4 = a1 + 2;
  v5 = (*(a1[2] + 64))(a1 + 2);
  (*(*v4 + 16))(v4, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "invalidating call ", 18);
  *(v5 + 17) = 0;
  ObfuscatedString::ObfuscatedString(&v41, (*a2 + 504));
  (*(*v5 + 56))(v5, &v41);
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  if (v43 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v41.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v41.__r_.__value_.__l.__data_);
  }

  v6 = *a2;
  v7 = *(*a2 + 384);
  if (v7)
  {
    v8 = std::__shared_weak_count::lock(v7);
    if (v8)
    {
      v9 = v6[15].__r_.__value_.__r.__words[2];
    }

    else
    {
      v9 = 0;
    }
  }

  else
  {
    v9 = 0;
    v8 = 0;
  }

  v10 = std::__hash_table<std::shared_ptr<BambiCall>,std::hash<std::shared_ptr<BambiCall>>,std::equal_to<std::shared_ptr<BambiCall>>,std::allocator<std::shared_ptr<BambiCall>>>::find<std::shared_ptr<BambiCall>>(a1 + 44, *a2);
  if (v10)
  {
    v11 = v10;
    v12 = a1[45];
    v13 = *v10;
    v14 = v10[1];
    v15 = vcnt_s8(v12);
    v15.i16[0] = vaddlv_u8(v15);
    if (v15.u32[0] > 1uLL)
    {
      if (v14 >= *&v12)
      {
        v14 %= *&v12;
      }
    }

    else
    {
      v14 &= *&v12 - 1;
    }

    v16 = a1[44];
    v17 = *(v16 + 8 * v14);
    do
    {
      v18 = v17;
      v17 = *v17;
    }

    while (v17 != v10);
    if (v18 == a1 + 46)
    {
      goto LABEL_28;
    }

    v19 = v18[1];
    if (v15.u32[0] > 1uLL)
    {
      if (v19 >= *&v12)
      {
        v19 %= *&v12;
      }
    }

    else
    {
      v19 &= *&v12 - 1;
    }

    if (v19 != v14)
    {
LABEL_28:
      if (v13)
      {
        v20 = *(v13 + 8);
        if (v15.u32[0] > 1uLL)
        {
          v21 = *(v13 + 8);
          if (v20 >= *&v12)
          {
            v21 = v20 % *&v12;
          }
        }

        else
        {
          v21 = v20 & (*&v12 - 1);
        }

        if (v21 == v14)
        {
          goto LABEL_32;
        }
      }

      *(v16 + 8 * v14) = 0;
      v13 = *v10;
    }

    if (!v13)
    {
LABEL_38:
      *v18 = v13;
      *v10 = 0;
      --a1[47];
      v22 = v10[3];
      if (v22)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v22);
      }

      operator delete(v11);
      goto LABEL_41;
    }

    v20 = *(v13 + 8);
LABEL_32:
    if (v15.u32[0] > 1uLL)
    {
      if (v20 >= *&v12)
      {
        v20 %= *&v12;
      }
    }

    else
    {
      v20 &= *&v12 - 1;
    }

    if (v20 != v14)
    {
      *(a1[44] + 8 * v20) = v18;
      v13 = *v10;
    }

    goto LABEL_38;
  }

LABEL_41:
  if (*(v9 + 4455) < 0)
  {
    std::string::__init_copy_ctor_external(&v40, *(v9 + 4432), *(v9 + 4440));
  }

  else
  {
    v40 = *(v9 + 4432);
  }

  v23 = a1[46];
  if (v23)
  {
    v24 = 0;
    while (1)
    {
      v25 = v23[2];
      if (v25)
      {
        v26 = *(v25 + 384);
        if (v26)
        {
          v27 = std::__shared_weak_count::lock(v26);
          if (v27)
          {
            v28 = v27;
            if (*(v25 + 376))
            {
              v29 = v23[2];
              v30 = *(v29 + 384);
              if (v30)
              {
                v31 = std::__shared_weak_count::lock(v30);
                if (v31)
                {
                  v32 = *(v29 + 376);
                }

                else
                {
                  v32 = 0;
                }
              }

              else
              {
                v32 = 0;
                v31 = 0;
              }

              if (*(v32 + 4455) < 0)
              {
                std::string::__init_copy_ctor_external(&v41, *(v32 + 4432), *(v32 + 4440));
              }

              else
              {
                v41 = *(v32 + 4432);
              }

              v33 = SHIBYTE(v41.__r_.__value_.__r.__words[2]);
              if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
              {
                size = HIBYTE(v41.__r_.__value_.__r.__words[2]);
              }

              else
              {
                size = v41.__r_.__value_.__l.__size_;
              }

              v35 = HIBYTE(v40.__r_.__value_.__r.__words[2]);
              if ((v40.__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
              {
                v35 = v40.__r_.__value_.__l.__size_;
              }

              if (size == v35)
              {
                if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
                {
                  v36 = &v41;
                }

                else
                {
                  v36 = v41.__r_.__value_.__r.__words[0];
                }

                if ((v40.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
                {
                  v37 = &v40;
                }

                else
                {
                  v37 = v40.__r_.__value_.__r.__words[0];
                }

                v38 = memcmp(v36, v37, size) == 0;
                if (v33 < 0)
                {
LABEL_74:
                  operator delete(v41.__r_.__value_.__l.__data_);
                }
              }

              else
              {
                v38 = 0;
                if (SHIBYTE(v41.__r_.__value_.__r.__words[2]) < 0)
                {
                  goto LABEL_74;
                }
              }

              if (v31)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v31);
              }

              std::__shared_weak_count::__release_shared[abi:ne200100](v28);
              v24 += v38;
              goto LABEL_78;
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v27);
          }
        }
      }

LABEL_78:
      v23 = *v23;
      if (!v23)
      {
        v39 = v24 == 0;
        goto LABEL_81;
      }
    }
  }

  v39 = 1;
LABEL_81:
  if (SHIBYTE(v40.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v40.__r_.__value_.__l.__data_);
    if (!v39)
    {
      goto LABEL_86;
    }

    goto LABEL_85;
  }

  if (v39)
  {
LABEL_85:
    SipStack::allCallsEnded(v9);
  }

LABEL_86:
  if (v8)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
  }
}

void sub_1E51169EC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, char a16)
{
  if (v16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::dumpState(uint64_t a1, const std::string *a2, uint64_t *a3, int a4, int a5)
{
  v36[19] = *MEMORY[0x1E69E9840];
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************** STATE DUMP **********************************", 80);
  *(a3 + 17) = 0;
  (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "Reason:             ", 20);
  *(a3 + 17) = 0;
  LoggableString::LoggableString(__p, a2);
  (*(*a3 + 40))(a3, __p);
  (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  if (SBYTE7(v34) < 0)
  {
    operator delete(__p[0]);
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "OS Version:         ", 20);
  *(a3 + 17) = 0;
  ims::osVersion(&v32);
  LoggableString::LoggableString(__p, &v32);
  (*(*a3 + 40))(a3, __p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], " (", 2);
  *(a3 + 17) = 0;
  ims::osBuild(&v30);
  LoggableString::LoggableString(&v31, &v30);
  (*(*a3 + 40))(a3, &v31);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], ")", 1);
  *(a3 + 17) = 0;
  (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  if (SHIBYTE(v31.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v31.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v30.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v30.__r_.__value_.__l.__data_);
  }

  if (SBYTE7(v34) < 0)
  {
    operator delete(__p[0]);
  }

  if (SHIBYTE(v32.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v32.__r_.__value_.__l.__data_);
  }

  for (i = *(a1 + 264); i; i = *i)
  {
    v35[0] = 0;
    *__p = 0u;
    v34 = 0u;
    std::pair<std::string const,std::shared_ptr<MessageSession>>::pair[abi:ne200100](__p, i + 1);
    v11 = *(&v34 + 1);
    v12 = v35[0];
    if (v35[0])
    {
      atomic_fetch_add_explicit(&v35[0]->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    SipStack::dumpState(v11, a3);
    (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a3 + 17) = 0;
    if (v12)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v12);
    }

    if (v35[0])
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v35[0]);
    }

    if (SBYTE7(v34) < 0)
    {
      operator delete(__p[0]);
    }
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "Emergency SIP Stack:", 20);
  *(a3 + 17) = 0;
  (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  SipStack::dumpState(*(a1 + 232), a3);
  if (*(a1 + 376))
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "Calls:", 6);
    *(a3 + 17) = 0;
    (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a3 + 17) = 0;
    for (j = *(a1 + 368); j; j = *j)
    {
      BambiCall::printCallInfo(j[2], a3, 0);
    }
  }

  if (a4)
  {
    v14 = MEMORY[0x1E69E5528] + 64;
    bzero(&__p[1], 0x238uLL);
    v36[0] = v14;
    v15 = MEMORY[0x1E69E54C8];
    v16 = *(MEMORY[0x1E69E54C8] + 16);
    __p[0] = *(MEMORY[0x1E69E54C8] + 8);
    *(__p + *(__p[0] - 3)) = v16;
    __p[1] = 0;
    v17 = (__p + *(__p[0] - 3));
    std::ios_base::init(v17, &v34);
    v18 = (MEMORY[0x1E69E5528] + 24);
    v17[1].__vftable = 0;
    v17[1].__fmtflags_ = -1;
    __p[0] = v18;
    v36[0] = v14;
    MEMORY[0x1E6923240](&v34);
    if (!std::filebuf::open())
    {
      std::ios_base::clear((__p + *(__p[0] - 3)), *(v35 + *(__p[0] - 3)) | 4);
    }

    if ((*(v35 + *(__p[0] - 3)) & 5) == 0)
    {
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "imsCoreInfo:", 12);
      *(a3 + 17) = 0;
      (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(a3 + 17) = 0;
      (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(a3 + 17) = 0;
      memset(&v32, 0, sizeof(v32));
      v19 = MEMORY[0x1E69E5318];
      while (1)
      {
        std::ios_base::getloc((__p + *(__p[0] - 3)));
        v20 = std::locale::use_facet(&v31, v19);
        v21 = (v20->__vftable[2].~facet_0)(v20, 10);
        std::locale::~locale(&v31);
        v22 = std::getline[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(__p, &v32, v21);
        v23 = *a3;
        if ((*(v22 + *(*v22 - 24) + 32) & 5) != 0)
        {
          break;
        }

        (*(v23 + 32))(a3, &v32);
        (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(a3 + 17) = 0;
      }

      (*(v23 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(a3 + 17) = 0;
      if (SHIBYTE(v32.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v32.__r_.__value_.__l.__data_);
      }
    }

    __p[0] = *v15;
    *(__p + *(__p[0] - 3)) = *(v15 + 24);
    MEMORY[0x1E6923250](&v34);
    std::istream::~istream();
    MEMORY[0x1E6923510](v36);
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************************************************************", 80);
  *(a3 + 17) = 0;
  (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  if (a5)
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************** IMS Config **********************************", 80);
    *(a3 + 17) = 0;
    (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a3 + 17) = 0;
    ImsPrefsManager::dumpState(a3, v24);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************************************************************", 80);
    *(a3 + 17) = 0;
    (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a3 + 17) = 0;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************************************************************", 80);
  *(a3 + 17) = 0;
  v25 = (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  v26 = ims::logger(v25);
  ImsLogger::dumpState(v26, a3);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************************************************************", 80);
  *(a3 + 17) = 0;
  v27 = (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  ims::dumpStaticLoggers(v27);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(a3[1], "********************************************************************************", 80);
  *(a3 + 17) = 0;
  result = (*(*a3 + 64))(a3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a3 + 17) = 0;
  v29 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_1E51174D0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *a10, uint64_t a11, int a12, __int16 a13, char a14, char a15, std::locale a16, uint64_t a17, int a18, __int16 a19, char a20, char a21, void *__p, uint64_t a23, int a24, __int16 a25, char a26, char a27, void *a28, uint64_t a29, int a30, __int16 a31, char a32, char a33)
{
  if (a27 < 0)
  {
    operator delete(__p);
  }

  std::ifstream::~ifstream(&a28);
  MEMORY[0x1E6923510](v33);
  _Unwind_Resume(a1);
}

void BambiClient::notifyCallsOfRegistrationChange(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  v12[0] = &unk_1F5EBDEF8;
  v12[1] = &_bambiDomain;
  v13 = 1073741839;
  v7 = *(a3 + 8) == &_bambiDomain && *(a3 + 16) == 1073741839;
  ImsResult::~ImsResult(v12);
  v8 = *(a1 + 760);
  if (v8)
  {
    v9 = std::__shared_weak_count::lock(v8);
    if (v9)
    {
      v10 = v9;
      v11 = *(a1 + 752);
      if (v11)
      {
        (*(*v11 + 24))(v11, a2, v7 | a4);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v10);
    }
  }
}

_BYTE *BambiClient::systemWillNotSleep(_BYTE *this)
{
  if (this[696] == 1)
  {
    return (*(*this + 256))();
  }

  return this;
}

uint64_t non-virtual thunk toBambiClient::systemWillNotSleep(uint64_t this)
{
  if (*(this + 544) == 1)
  {
    return (*(*(this - 152) + 256))();
  }

  return this;
}

void BambiClient::exitEmergencyState(BambiClient *this)
{
  v2 = *(this + 46);
  if (v2)
  {
    while (1)
    {
      v4 = v2[2];
      v3 = v2[3];
      if (v3)
      {
        atomic_fetch_add_explicit(&v3->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      v2 = *v2;
      if (*(v4 + 69))
      {
        std::string::basic_string[abi:ne200100]<0>(&__p, "ExitEmergencyState");
        BambiCall::endWithReason(v4, v9);
        ImsResult::~ImsResult(v9);
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          break;
        }
      }

      if (v3)
      {
        goto LABEL_7;
      }

LABEL_8:
      if (!v2)
      {
        goto LABEL_12;
      }
    }

    operator delete(__p.__r_.__value_.__l.__data_);
    if (!v3)
    {
      goto LABEL_8;
    }

LABEL_7:
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
    goto LABEL_8;
  }

LABEL_12:
  memset(&__p, 0, sizeof(__p));
  v5 = *(this + 29);
  if (*(v5 + 4455) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, *(v5 + 4432), *(v5 + 4440));
    v5 = *(this + 29);
  }

  else
  {
    __p = *(v5 + 4432);
  }

  SipStack::deinitialize(v5, 0, 0, 0);
  IPTelephonyManager::instance(&v6);
  IPTelephonyManager::deinitializeNasClient(v6, &__p.__r_.__value_.__l.__data_);
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }
}

void sub_1E51178CC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  if (a16 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::setMediaManagerForStack(void *a1, void **a2, int a3, int a4, int a5)
{
  v30 = 0;
  v31 = 0;
  (*(*a1 + 184))(&v30);
  v11 = a1 + 2;
  v10 = a1[2];
  if (!v30)
  {
    v24 = (*(v10 + 56))(a1 + 2);
    (*(*v11 + 16))(a1 + 2, v24);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v24 + 8), "Unable to set media manager app Id: invalid stack ", 50);
    *(v24 + 17) = 0;
    v25 = (v24 + 17);
    (*(*v24 + 32))(v24, a2);
    (*(*v24 + 64))(v24, std::endl[abi:ne200100]<char,std::char_traits<char>>);
LABEL_24:
    *v25 = 0;
    goto LABEL_25;
  }

  v12 = (*(v10 + 64))(a1 + 2);
  (*(*v11 + 16))(a1 + 2, v12);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "BambiClient::setMediaManagerForStack to AP ", 43);
  *(v12 + 17) = 0;
  if (a3)
  {
    v13 = "Enable";
  }

  else
  {
    v13 = "Disable";
  }

  if (a3)
  {
    v14 = 6;
  }

  else
  {
    v14 = 7;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), v13, v14);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), " for ", 5);
  *(v12 + 17) = 0;
  (*(*v12 + 32))(v12, a2);
  (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v12 + 17) = 0;
  if (a1[47])
  {
    v15 = SipStack::prefs(v30);
    if (!ImsPrefs::AllowRTPStackHandover(v15))
    {
      v27 = (*(*v11 + 56))(a1 + 2);
      (*(*v11 + 16))(a1 + 2, v27);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "Can't change media manager while ongoing calls", 46);
      *(v27 + 17) = 0;
      v25 = (v27 + 17);
      (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      goto LABEL_24;
    }
  }

  v16 = a1[27];
  v17 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v16 + 280, a2);
  if (v16 + 288 == v17 || (v18 = *(v17 + 56)) == 0)
  {
    v26 = (*(*v11 + 64))(a1 + 2);
    (*(*v11 + 16))(a1 + 2, v26);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "Can't change media manager to unknown type", 42);
    *(v26 + 17) = 0;
    v25 = (v26 + 17);
    (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    goto LABEL_24;
  }

  v19 = (*(*v11 + 64))(a1 + 2);
  (*(*v11 + 16))(a1 + 2, v19);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "BambiClient::setMediaManagerForStack currently ", 47);
  *(v19 + 17) = 0;
  if (v18 == 1)
  {
    v20 = "AP";
  }

  else
  {
    v20 = "Baseband";
  }

  if (v18 == 1)
  {
    v21 = 2;
  }

  else
  {
    v21 = 8;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), v20, v21);
  *(v19 + 17) = 0;
  (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v19 + 17) = 0;
  if (v18 == 1 && (a3 & 1) == 0)
  {
    v22 = (*(*v11 + 64))(a1 + 2);
    (*(*v11 + 16))(a1 + 2, v22);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "Setting mediaManager to Baseband", 32);
    *(v22 + 17) = 0;
    v23 = (v22 + 17);
    (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
LABEL_31:
    *v23 = 0;
    v28 = 1;
    goto LABEL_32;
  }

  v28 = 0;
  if (v18 != 1 && a3)
  {
    v29 = (*(*v11 + 64))(a1 + 2);
    (*(*v11 + 16))(a1 + 2, v29);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "Setting mediaManager to AP", 26);
    *(v29 + 17) = 0;
    v23 = (v29 + 17);
    (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    goto LABEL_31;
  }

LABEL_32:
  RTPManager::setWifiHotspot(a1[27], a2, a4);
  if (v28)
  {
    SipStack::setMediaAppId(v30, a5);
    BambiClient::initializeMediaApplicationId(a1);
  }

LABEL_25:
  if (v31)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v31);
  }
}

void sub_1E5117FF0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::initializeMediaApplicationId(uint64_t a1)
{
  v2 = *(a1 + 216);
  if (v2)
  {
    v3 = *(*v2 + 32);

    return v3();
  }

  else
  {
    v6 = *(a1 + 16);
    v5 = a1 + 16;
    v7 = (*(v6 + 56))(v5);
    (*(*v5 + 16))(v5, v7);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "no media manager to initialize appId", 36);
    *(v7 + 17) = 0;
    result = (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v7 + 17) = 0;
  }

  return result;
}

void BambiClient::handleNetworkEvents(void *a1, uint64_t a2, unsigned int a3)
{
  if (!a3)
  {
    v6 = a1[27];

    RTPManager::srvccHandoverStarted(v6, a2);
  }

  if (a3 > 2)
  {
    v7 = a1 + 2;
    v8 = (*(a1[2] + 48))(a1 + 2);
    (*(*v7 + 16))(v7, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Unsupported network event received: ", 36);
    *(v8 + 17) = 0;
    MEMORY[0x1E6923360](*(v8 + 8), a3);
    *(v8 + 17) = 0;
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v8 + 17) = 0;
  }

  else
  {
    v12 = 0;
    v13 = 0;
    (*(*a1 + 184))(&v12, a1, a2);
    if (v12)
    {
      *(v12 + 4626) = a3 == 1;
    }

    else
    {
      v10 = a1[2];
      v9 = a1 + 2;
      v11 = (*(v10 + 56))(v9);
      (*(*v9 + 16))(v9, v11);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "No stack for ", 13);
      *(v11 + 17) = 0;
      (*(*v11 + 32))(v11, a2);
      (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v11 + 17) = 0;
    }

    if (v13)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v13);
    }
  }
}

void sub_1E5118388(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::handleConnectivityChange(void *a1, uint64_t a2, uint64_t a3)
{
  v9 = 0;
  v10 = 0;
  (*(*a1 + 184))(&v9);
  if (v9)
  {
    SipStack::setConnectivityAvailable(v9, a3);
  }

  else
  {
    v7 = a1[2];
    v6 = a1 + 2;
    v8 = (*(v7 + 56))(v6);
    (*(*v6 + 16))(v6, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "unable to set connectivity: inavlid SIP stack ", 46);
    *(v8 + 17) = 0;
    (*(*v8 + 32))(v8, a2);
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v8 + 17) = 0;
  }

  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }
}

void sub_1E51184FC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::stackDeinitComplete(void *a1, uint64_t *a2)
{
  memset(&v21, 0, sizeof(v21));
  v4 = *a2;
  if (*(*a2 + 4455) < 0)
  {
    std::string::__init_copy_ctor_external(&v21, *(v4 + 4432), *(v4 + 4440));
  }

  else
  {
    v21 = *(v4 + 4432);
  }

  v5 = a1 + 2;
  v6 = (*(a1[2] + 64))(a1 + 2);
  (*(a1[2] + 16))(a1 + 2, v6);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "Sip Stack ", 10);
  *(v6 + 17) = 0;
  (*(*v6 + 32))(v6, &v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " deinitialized", 14);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  std::string::basic_string[abi:ne200100]<0>(v19, "sip.stack");
  v15[0] = 0;
  v18 = 0;
  v7 = ims::info(v19, v15);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "Sip Stack ", 10);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, &v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " deinitialized", 14);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v18 == 1 && v17 < 0)
  {
    operator delete(__p);
  }

  if (v20 < 0)
  {
    operator delete(v19[0]);
  }

  if (*(*a2 + 4562) == 1)
  {
    v8 = (*(*v5 + 64))(a1 + 2);
    (*(*v5 + 16))(a1 + 2, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Stack marked as invalidated-- skipping uninit delegate call", 59);
    *(v8 + 17) = 0;
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v8 + 17) = 0;
    BambiClient::invalidateStack(a1, &v21.__r_.__value_.__l.__data_);
  }

  else
  {
    v9 = a1[93];
    if (v9)
    {
      v10 = std::__shared_weak_count::lock(v9);
      if (v10)
      {
        v11 = v10;
        v12 = a1[92];
        if (v12)
        {
          if (BambiClientStatus::kStatusUninitialized[23] < 0)
          {
            std::string::__init_copy_ctor_external(&v13, *BambiClientStatus::kStatusUninitialized, *&BambiClientStatus::kStatusUninitialized[8]);
          }

          else
          {
            v13 = *BambiClientStatus::kStatusUninitialized;
          }

          v14 = byte_1EE2BD308;
          (*(*v12 + 16))(v12, &v21, &v13);
          if (SHIBYTE(v13.__r_.__value_.__r.__words[2]) < 0)
          {
            operator delete(v13.__r_.__value_.__l.__data_);
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v11);
      }
    }
  }

  if (SHIBYTE(v21.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v21.__r_.__value_.__l.__data_);
  }
}

void sub_1E51188F8(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, uint64_t a16, uint64_t a17, void *a18, uint64_t a19, int a20, __int16 a21, char a22, char a23, uint64_t a24, char a25, void *a26, uint64_t a27, int a28, __int16 a29, char a30, char a31)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v31);
  if (*(v32 - 41) < 0)
  {
    operator delete(*(v32 - 64));
  }

  _Unwind_Resume(a1);
}

void BambiClient::stackInitComplete(void *a1, uint64_t *a2, uint64_t a3)
{
  v6 = (*(**(a3 + 8) + 24))(*(a3 + 8), *(a3 + 16));
  v8 = a1 + 2;
  v7 = a1[2];
  if (v6)
  {
    v9 = (*(v7 + 56))(a1 + 2);
    (*(*v8 + 16))(a1 + 2, v9);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "SIP stack init failed: ", 23);
    *(v9 + 17) = 0;
    (*(*a3 + 16))(a3, v9);
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v9 + 17) = 0;
  }

  else
  {
    v10 = (*(v7 + 64))(a1 + 2);
    (*(*v8 + 16))(a1 + 2, v10);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "Sip Stack ", 10);
    *(v10 + 17) = 0;
    v11 = *a2;
    if (*(*a2 + 4455) < 0)
    {
      std::string::__init_copy_ctor_external(&v34, *(v11 + 4432), *(v11 + 4440));
    }

    else
    {
      v34 = *(v11 + 4432);
    }

    (*(*v10 + 32))(v10, &v34);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " initialized", 12);
    *(v10 + 17) = 0;
    (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v10 + 17) = 0;
    if (SHIBYTE(v34.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v34.__r_.__value_.__l.__data_);
    }

    v12 = std::string::basic_string[abi:ne200100]<0>(&v34, "sip.stack");
    v30[0] = 0;
    v33 = 0;
    v13 = ims::info(v12, v30);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "Sip Stack ", 10);
    *(v13 + 17) = 0;
    v14 = *a2;
    if (*(*a2 + 4455) < 0)
    {
      std::string::__init_copy_ctor_external(&v29, *(v14 + 4432), *(v14 + 4440));
    }

    else
    {
      v29 = *(v14 + 4432);
    }

    (*(*v13 + 32))(v13, &v29);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), " initialized", 12);
    *(v13 + 17) = 0;
    (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v13 + 17) = 0;
    if (SHIBYTE(v29.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v29.__r_.__value_.__l.__data_);
    }

    if (v33 == 1 && v32 < 0)
    {
      operator delete(__p);
    }

    if (SHIBYTE(v34.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v34.__r_.__value_.__l.__data_);
    }
  }

  v15 = a1[93];
  if (v15)
  {
    v16 = std::__shared_weak_count::lock(v15);
    if (v16)
    {
      v17 = v16;
      v18 = a1[92];
      if (v18)
      {
        v19 = *a2;
        if (*(*a2 + 4455) < 0)
        {
          std::string::__init_copy_ctor_external(&v34, *(v19 + 4432), *(v19 + 4440));
        }

        else
        {
          v34 = *(v19 + 4432);
        }

        v20 = (*(**(a3 + 8) + 24))(*(a3 + 8), *(a3 + 16));
        v21 = v20;
        if (v20)
        {
          v22 = BambiClientStatus::kStatusInitFailed;
        }

        else
        {
          v22 = &BambiClientStatus::kStatusInitialized;
        }

        v23 = &BambiClientStatus::kStatusInitFailed[2] + 7;
        if (!v20)
        {
          v23 = &byte_1EE2BD327;
        }

        if (*v23 < 0)
        {
          v24 = *v22;
          if (v20)
          {
            v25 = BambiClientStatus::kStatusInitFailed;
          }

          else
          {
            v25 = &BambiClientStatus::kStatusInitialized;
          }

          std::string::__init_copy_ctor_external(&v27, v24, *(v25 + 1));
        }

        else
        {
          v27 = *v22;
        }

        if (v21)
        {
          v26 = BambiClientStatus::kStatusInitFailed;
        }

        else
        {
          v26 = &BambiClientStatus::kStatusInitialized;
        }

        v28 = *(v26 + 24);
        (*(*v18 + 16))(v18, &v34, &v27);
        if (SHIBYTE(v27.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v27.__r_.__value_.__l.__data_);
        }

        if (SHIBYTE(v34.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v34.__r_.__value_.__l.__data_);
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v17);
    }
  }
}

void BambiClient::handleMediaStackSwitchComplete(void *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  v6 = a1[95];
  if (v6)
  {
    v9 = std::__shared_weak_count::lock(v6);
    if (v9)
    {
      v10 = v9;
      v11 = a1[94];
      if (v11)
      {
        (*(*v11 + 16))(v11, a2, a3, a4);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v10);
    }
  }

  if (a3 == 1)
  {
    v13[0] = MEMORY[0x1E69E9820];
    v13[1] = 0x40000000;
    v13[2] = ___ZN11BambiClient30handleMediaStackSwitchCompleteERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE12RTPStackTypeb_block_invoke;
    v13[3] = &__block_descriptor_tmp_164_0;
    v13[4] = a1;
    v16 = 0;
    v17 = 0;
    std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&v16, a1 + 22);
    v12 = a1[24];
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 1174405120;
    block[2] = ___ZNK3ctu20SharedSynchronizableI11BambiClientE15execute_wrappedEU13block_pointerFvvE_block_invoke;
    block[3] = &unk_1F5EF5ED0;
    block[5] = v16;
    v15 = v17;
    if (v17)
    {
      atomic_fetch_add_explicit(&v17->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    block[4] = v13;
    dispatch_async(v12, block);
    if (v15)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v15);
    }

    if (v17)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v17);
    }
  }
}

void ___ZN11BambiClient30handleMediaStackSwitchCompleteERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE12RTPStackTypeb_block_invoke(uint64_t a1)
{
  for (i = *(*(a1 + 32) + 368); i; i = *i)
  {
    v2 = i[2];
    if (v2)
    {
      v3 = *(v2 + 408);
      if (v3)
      {
        if ((SipSession::confirmed(v3) & 1) == 0 && BambiCall::shouldFakeLocalQOS(i[2]))
        {
          v4 = i[2];
          v5 = 0;
          v7 = 0;
          v8 = 0;
          __p = 0;
          std::vector<unsigned short>::__init_with_size[abi:ne200100]<unsigned short const*,unsigned short const*>(&__p, &v5, &__p, 1);
          BambiCall::setQualityOfServiceEstablished(v4, 0xFFFFFFFFLL, 1, &__p);
          if (__p)
          {
            v7 = __p;
            operator delete(__p);
          }
        }
      }
    }
  }
}

void sub_1E5119170(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::handleInputFrequencyLevelUpdate(BambiClient *this, unint64_t a2, const __CFData *a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(this + 39, a2);
  if (v6 && (v7 = v6[3]) != 0)
  {
    if (*(v7 + 64) != 2)
    {
      v9 = *(this + 2);
      v8 = this + 16;
      v10 = (*(v9 + 48))(v8);
      (*(*v8 + 16))(v8, v10);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "Received request to update input frequency level for non-audio stream type ", 75);
      *(v10 + 17) = 0;
      MEMORY[0x1E6923340](*(v10 + 8), *(v7 + 64));
      *(v10 + 17) = 0;
      (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v10 + 17) = 0;
    }

    v11 = *(v7 + 40);
    if (v11)
    {
      v12 = *(v7 + 32);
      atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v13 = std::__shared_weak_count::lock(v11);
      std::__shared_weak_count::__release_weak(v11);
      if (v13)
      {
        if (v12)
        {
          BambiCall::setInputFrequencyLevel(v12, a3);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v13);
      }
    }
  }

  else
  {
    v15 = *(this + 2);
    v14 = this + 16;
    v16 = (*(v15 + 56))(v14);
    (*(*v14 + 16))(v14, v16);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "handleInputFrequencyLevelUpdate: No stream found for ", 53);
    *(v16 + 17) = 0;
    MEMORY[0x1E69233B0](*(v16 + 8), a2);
    *(v16 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), " frequency: ", 12);
    *(v16 + 17) = 0;
    v18[0] = &unk_1F5EF3658;
    v18[1] = a3;
    if (a3)
    {
      CFRetain(a3);
    }

    v18[0] = &unk_1F5EE1298;
    v17 = off_1F5EE12A8(v18, v16);
    (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v17 + 17) = 0;
    ims::CFType::~CFType(v18);
  }
}

void BambiClient::handleOutputFrequencyLevelUpdate(BambiClient *this, unint64_t a2, const __CFData *a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(this + 39, a2);
  if (v6 && (v7 = v6[3]) != 0)
  {
    if (*(v7 + 64) != 2)
    {
      v9 = *(this + 2);
      v8 = this + 16;
      v10 = (*(v9 + 48))(v8);
      (*(*v8 + 16))(v8, v10);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "Received request to update output frequency level for non-audio stream type ", 76);
      *(v10 + 17) = 0;
      MEMORY[0x1E6923340](*(v10 + 8), *(v7 + 64));
      *(v10 + 17) = 0;
      (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v10 + 17) = 0;
    }

    v11 = *(v7 + 40);
    if (v11)
    {
      v12 = *(v7 + 32);
      atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v13 = std::__shared_weak_count::lock(v11);
      std::__shared_weak_count::__release_weak(v11);
      if (v13)
      {
        if (v12)
        {
          BambiCall::setOutputFrequencyLevel(v12, a3);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v13);
      }
    }
  }

  else
  {
    v15 = *(this + 2);
    v14 = this + 16;
    v16 = (*(v15 + 56))(v14);
    (*(*v14 + 16))(v14, v16);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "handleOutputFrequencyLevelUpdate: No stream found for ", 54);
    *(v16 + 17) = 0;
    MEMORY[0x1E69233B0](*(v16 + 8), a2);
    *(v16 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), " frequency: ", 12);
    *(v16 + 17) = 0;
    v18[0] = &unk_1F5EF3658;
    v18[1] = a3;
    if (a3)
    {
      CFRetain(a3);
    }

    v18[0] = &unk_1F5EE1298;
    v17 = off_1F5EE12A8(v18, v16);
    (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v17 + 17) = 0;
    ims::CFType::~CFType(v18);
  }
}

void BambiClient::updatePortForSession(uint64_t a1, unint64_t a2, unsigned int a3, unsigned int a4)
{
  v8 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>((a1 + 312), a2);
  if (v8 && (v9 = v8[3]) != 0)
  {
    if (*(v9 + 64) != a4)
    {
      v11 = *(a1 + 16);
      v10 = a1 + 16;
      v12 = (*(v11 + 48))(v10);
      (*(*v10 + 16))(v10, v12);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "Request to update port for stream of type ", 42);
      *(v12 + 17) = 0;
      (*(*v12 + 32))(v12, v22);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), ", but actual stream is of type ", 31);
      *(v12 + 17) = 0;
      (*(*v12 + 32))(v12, __p);
      (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v12 + 17) = 0;
      if (v21 < 0)
      {
        operator delete(__p[0]);
      }

      if (v23 < 0)
      {
        operator delete(v22[0]);
      }
    }

    *(v9 + 72) = a3;
    v13 = *(v9 + 40);
    if (v13)
    {
      v14 = *(v9 + 32);
      atomic_fetch_add_explicit(&v13->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v15 = std::__shared_weak_count::lock(v13);
      std::__shared_weak_count::__release_weak(v13);
      if (v15)
      {
        if (v14)
        {
          v16 = *(v14 + 192);
          if (v16)
          {
            SDPSession::updatePortForMedia(v16, a3, a4);
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v15);
      }
    }
  }

  else
  {
    v18 = *(a1 + 16);
    v17 = a1 + 16;
    v19 = (*(v18 + 56))(v17);
    (*(*v17 + 16))(v17, v19);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "Unable to update port for non-existent sessionId ", 49);
    *(v19 + 17) = 0;
    MEMORY[0x1E69233B0](*(v19 + 8), a2);
    *(v19 + 17) = 0;
    (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v19 + 17) = 0;
  }
}

void BambiClient::handleLRBTChanged(BambiClient *this, unint64_t a2, int a3)
{
  v13 = 0;
  v14 = 0;
  BambiClient::callForMediaSession(&v13, this, a2);
  v4 = v13;
  if (v13)
  {
    v5 = *(v13 + 432);
    if (v5)
    {
      v6 = *(v13 + 424);
      atomic_fetch_add_explicit(&v5->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v7 = std::__shared_weak_count::lock(v5);
      std::__shared_weak_count::__release_weak(v5);
      if (v7)
      {
        if (v6)
        {
          v11 = 0u;
          *v12 = 0u;
          v8 = a3 ? 5 : 6;
          v9 = v14;
          v10[0] = v4;
          v10[1] = v14;
          if (v14)
          {
            atomic_fetch_add_explicit(&v14->__shared_owners_, 1uLL, memory_order_relaxed);
            BambiCallEvent::BambiCallEvent(&v11, v8, v10);
            std::__shared_weak_count::__release_shared[abi:ne200100](v9);
          }

          else
          {
            BambiCallEvent::BambiCallEvent(&v11, v8, v10);
          }

          (*(*v6 + 16))(v6, &v11);
          *&v11 = &unk_1F5EC4090;
          if (v12[1])
          {
            std::__shared_weak_count::__release_weak(v12[1]);
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v7);
      }
    }
  }

  if (v14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }
}

void sub_1E5119BD0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14)
{
  if (a14)
  {
    std::__shared_weak_count::__release_weak(a14);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  }

  _Unwind_Resume(a1);
}

void BambiClient::callAudioSourceIdForSession(BambiClient *this@<X0>, unint64_t a2@<X1>, std::string *a3@<X8>)
{
  a3->__r_.__value_.__r.__words[0] = 0;
  a3->__r_.__value_.__l.__size_ = 0;
  a3->__r_.__value_.__r.__words[2] = 0;
  v5 = 0;
  v6 = 0;
  BambiClient::callForMediaSession(&v5, this, a2);
  if (v5)
  {
    std::string::operator=(a3, (v5 + 992));
  }

  v4 = v6;
  if (v6)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }
}

void sub_1E5119C98(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  if (*(v10 + 23) < 0)
  {
    operator delete(*v10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::sdpSessionForSession(BambiClient *this@<X0>, unint64_t a2@<X1>, void *a3@<X8>)
{
  v6 = 0;
  v7 = 0;
  BambiClient::callForMediaSession(&v6, this, a2);
  if (v6)
  {
    v4 = *(v6 + 200);
    *a3 = *(v6 + 192);
    a3[1] = v4;
    if (v4)
    {
      atomic_fetch_add_explicit((v4 + 8), 1uLL, memory_order_relaxed);
    }
  }

  else
  {
    *a3 = 0;
    a3[1] = 0;
  }

  v5 = v7;
  if (v7)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }
}

void BambiClient::interfaceForSession(BambiClient *this@<X0>, unint64_t a2@<X1>, std::string *a3@<X8>)
{
  v5 = 0;
  v6 = 0;
  BambiClient::callForMediaSession(&v5, this, a2);
  if (v5)
  {
    BambiCall::interface(v5, a3);
  }

  else
  {
    std::string::basic_string[abi:ne200100]<0>(a3, "");
  }

  v4 = v6;
  if (v6)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }
}

void sub_1E5119DD4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::addressForSession(BambiClient *this@<X0>, unint64_t a2@<X1>, void *a3@<X8>)
{
  v5 = 0;
  v6 = 0;
  BambiClient::callForMediaSession(&v5, this, a2);
  if (v5)
  {
    BambiCall::address(v5);
  }

  else
  {
    *a3 = 0;
    a3[1] = 0;
  }

  v4 = v6;
  if (v6)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }
}

void sub_1E5119E68(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t BambiClient::sessionMobileOriginated(BambiClient *this, unint64_t a2)
{
  v4 = 0;
  v5 = 0;
  BambiClient::callForMediaSession(&v4, this, a2);
  if (v4)
  {
    v2 = *(v4 + 1529);
  }

  else
  {
    v2 = 0;
  }

  if (v5)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }

  return v2 & 1;
}

void BambiClient::reportCodecForSession(uint64_t a1, unint64_t a2, uint64_t a3)
{
  v6 = 0;
  v7 = 0;
  BambiClient::callForMediaSession(&v6, a1, a2);
  v4 = v6;
  if (v6)
  {
    if (*(a3 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&__p, *a3, *(a3 + 8));
    }

    else
    {
      __p = *a3;
    }

    std::string::operator=(v4 + 70, &__p);
    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }
  }

  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void sub_1E5119F70(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, uint64_t a16, std::__shared_weak_count *a17)
{
  if (a17)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a17);
  }

  _Unwind_Resume(exception_object);
}

void BambiClient::awdCallIdForSession(int8x8_t *this@<X0>, unint64_t a2@<X1>, std::string *a3@<X8>)
{
  v4 = this[40];
  if (!*&v4)
  {
    goto LABEL_17;
  }

  v5 = vcnt_s8(v4);
  v5.i16[0] = vaddlv_u8(v5);
  if (v5.u32[0] > 1uLL)
  {
    v6 = a2;
    if (*&v4 <= a2)
    {
      v6 = a2 % *&v4;
    }
  }

  else
  {
    v6 = (*&v4 - 1) & a2;
  }

  v7 = *(*&this[39] + 8 * v6);
  if (!v7)
  {
    goto LABEL_17;
  }

  v8 = *v7;
  if (!v8)
  {
    goto LABEL_17;
  }

  while (1)
  {
    v9 = v8[1];
    if (v9 == a2)
    {
      break;
    }

    if (v5.u32[0] > 1uLL)
    {
      if (v9 >= *&v4)
      {
        v9 %= *&v4;
      }
    }

    else
    {
      v9 &= *&v4 - 1;
    }

    if (v9 != v6)
    {
      goto LABEL_17;
    }

LABEL_16:
    v8 = *v8;
    if (!v8)
    {
      goto LABEL_17;
    }
  }

  if (v8[2] != a2)
  {
    goto LABEL_16;
  }

  v11 = v8[3];
  if (!v11 || (v12 = *(v11 + 40)) == 0)
  {
LABEL_17:
    v10 = 0;
    goto LABEL_18;
  }

  v13 = *(v11 + 32);
  atomic_fetch_add_explicit(&v12->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  v10 = std::__shared_weak_count::lock(v12);
  std::__shared_weak_count::__release_weak(v12);
  if (v10 && v13)
  {
    if (*(v13 + 551) < 0)
    {
      std::string::__init_copy_ctor_external(a3, *(v13 + 528), *(v13 + 536));
    }

    else
    {
      v14 = *(v13 + 528);
      a3->__r_.__value_.__r.__words[2] = *(v13 + 544);
      *&a3->__r_.__value_.__l.__data_ = v14;
    }

    goto LABEL_19;
  }

LABEL_18:
  std::string::basic_string[abi:ne200100]<0>(a3, "");
  if (v10)
  {
LABEL_19:

    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }
}

void BambiClient::handleTransportErrors(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 744);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(a1 + 736);
      if (v7)
      {
        (*(*v7 + 56))(v7, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void BambiClient::requestNetworkReset(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 744);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(a1 + 736);
      if (v7)
      {
        (*(*v7 + 104))(v7, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void BambiClient::requestCallWaitingState(uint64_t a1)
{
  v2 = *(a1 + 744);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(a1 + 736);
      if (v5)
      {
        (*(*v5 + 112))(v5);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void BambiClient::requestStateDump(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 744);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 736);
      if (v9)
      {
        (*(*v9 + 120))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void BambiClient::handleThumperAuthFailure(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 744);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 736);
      if (v9)
      {
        (*(*v9 + 128))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void BambiClient::handleAudioStreamTokens(uint64_t a1, unint64_t a2, uint64_t a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>((a1 + 312), a2);
  if (v6 && (v7 = v6[3]) != 0)
  {
    if (*(v7 + 64) == 2)
    {
      v8 = *(v7 + 40);
      if (v8)
      {
        v9 = *(v7 + 32);
        atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v10 = std::__shared_weak_count::lock(v8);
        std::__shared_weak_count::__release_weak(v8);
        if (v10)
        {
          if (v9)
          {
            v11 = *(a3 + 8);
            v18[0] = &unk_1F5EF3658;
            v18[1] = v11;
            if (v11)
            {
              CFRetain(v11);
            }

            v18[0] = &unk_1F5EC8AD0;
            BambiCall::handleAudioStreamTokens(v9, v18);
            ims::CFType::~CFType(v18);
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v10);
        }
      }
    }

    else
    {
      v16 = *(a1 + 16);
      v15 = a1 + 16;
      v17 = (*(v16 + 48))(v15);
      (*(*v15 + 16))(v15, v17);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "Audio stream tokens callback for non-audio stream type ", 55);
      *(v17 + 17) = 0;
      (*(*v17 + 32))(v17, __p);
      (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v17 + 17) = 0;
      if (v20 < 0)
      {
        operator delete(__p[0]);
      }
    }
  }

  else
  {
    v13 = *(a1 + 16);
    v12 = a1 + 16;
    v14 = (*(v13 + 56))(v12);
    (*(*v12 + 16))(v12, v14);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "No media stream for sessionId ", 30);
    *(v14 + 17) = 0;
    MEMORY[0x1E69233B0](*(v14 + 8), a2);
    *(v14 + 17) = 0;
    (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v14 + 17) = 0;
  }
}

void BambiClient::handleTextStreamToken(uint64_t a1, unint64_t a2, uint64_t a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>((a1 + 312), a2);
  if (v6 && (v7 = v6[3]) != 0)
  {
    if (*(v7 + 64) == 4)
    {
      v8 = *(v7 + 40);
      if (v8)
      {
        v9 = *(v7 + 32);
        atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v10 = std::__shared_weak_count::lock(v8);
        std::__shared_weak_count::__release_weak(v8);
        if (v10)
        {
          if (v9)
          {
            v11 = *(a3 + 8);
            v18[0] = &unk_1F5EF3658;
            v18[1] = v11;
            if (v11)
            {
              CFRetain(v11);
            }

            v18[0] = &unk_1F5EF3708;
            BambiCall::handleTextStreamToken(v9, v18);
            ims::CFType::~CFType(v18);
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v10);
        }
      }
    }

    else
    {
      v16 = *(a1 + 16);
      v15 = a1 + 16;
      v17 = (*(v16 + 48))(v15);
      (*(*v15 + 16))(v15, v17);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "Text stream token callback for non-text stream type ", 52);
      *(v17 + 17) = 0;
      (*(*v17 + 32))(v17, __p);
      (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v17 + 17) = 0;
      if (v20 < 0)
      {
        operator delete(__p[0]);
      }
    }
  }

  else
  {
    v13 = *(a1 + 16);
    v12 = a1 + 16;
    v14 = (*(v13 + 56))(v12);
    (*(*v12 + 16))(v12, v14);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "No media stream for sessionId ", 30);
    *(v14 + 17) = 0;
    MEMORY[0x1E69233B0](*(v14 + 8), a2);
    *(v14 + 17) = 0;
    (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v14 + 17) = 0;
  }
}

void BambiClient::handleIncomingDtmf(BambiClient *this, unint64_t a2, uint64_t a3)
{
  v6 = std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(this + 39, a2);
  if (v6 && (v7 = v6[3]) != 0)
  {
    v8 = *(v7 + 40);
    if (v8)
    {
      v9 = *(v7 + 32);
      atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v10 = std::__shared_weak_count::lock(v8);
      std::__shared_weak_count::__release_weak(v8);
      if (v10)
      {
        if (v9)
        {
          BambiCall::handleIncomingDtmf(v9, a3);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v10);
      }
    }
  }

  else
  {
    v12 = *(this + 2);
    v11 = this + 16;
    v13 = (*(v12 + 56))(v11);
    (*(*v11 + 16))(v11, v13);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "No media stream for sessionId ", 30);
    *(v13 + 17) = 0;
    MEMORY[0x1E69233B0](*(v13 + 8), a2);
    *(v13 + 17) = 0;
    (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v13 + 17) = 0;
  }
}

void BambiClient::reportIRatTimeout(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 744);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 736);
      if (v9)
      {
        (*(*v9 + 144))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void BambiClient::coalesceLazuliRegistrationRefresh(BambiClient *this, int a2)
{
  v2 = *(this + 33);
  if (v2)
  {
    v4 = this + 16;
    do
    {
      v8 = 0;
      *__p = 0u;
      *v7 = 0u;
      std::pair<std::string const,std::shared_ptr<MessageSession>>::pair[abi:ne200100](__p, v2 + 1);
      if (*(v7[1] + 2817) == 1 && *(v7[1] + 1093) == a2)
      {
        v5 = (*(*v4 + 64))(v4);
        (*(*v4 + 16))(v4, v5);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "Trying to coalesce registration refresh for stack ", 50);
        *(v5 + 17) = 0;
        (*(*v5 + 32))(v5, __p);
        (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v5 + 17) = 0;
        SipStack::coalesceLazuliRegistrationRefresh(v7[1]);
      }

      if (v8)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v8);
      }

      if (SHIBYTE(v7[0]) < 0)
      {
        operator delete(__p[0]);
      }

      v2 = *v2;
    }

    while (v2);
  }
}

void BambiClient::addAssertions(uint64_t a1, uint64_t a2, unsigned int __val)
{
  v21 = *MEMORY[0x1E69E9840];
  memset(&v16, 0, sizeof(v16));
  std::to_string(&v16, __val);
  v19 = ".ipt";
  v20 = ".apns";
  v17 = ".wifi";
  v18 = ".cell";
  v5 = (*(*(a1 + 16) + 64))(a1 + 16);
  (*(*(a1 + 16) + 16))(a1 + 16, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "Add KeepAlive power assertions for stackId=", 43);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, a2);
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  __p[0] = 0;
  __p[1] = 0;
  v15 = 0;
  std::operator+<char>();
  v6 = strlen(v17);
  v7 = std::string::append(&v12, v17, v6);
  v8 = *&v7->__r_.__value_.__l.__data_;
  v13.__r_.__value_.__r.__words[2] = v7->__r_.__value_.__r.__words[2];
  *&v13.__r_.__value_.__l.__data_ = v8;
  v7->__r_.__value_.__l.__size_ = 0;
  v7->__r_.__value_.__r.__words[2] = 0;
  v7->__r_.__value_.__r.__words[0] = 0;
  v9 = strlen(v19);
  v10 = std::string::append(&v13, v19, v9);
  v11 = *&v10->__r_.__value_.__l.__data_;
  v15 = v10->__r_.__value_.__r.__words[2];
  *__p = v11;
  v10->__r_.__value_.__l.__size_ = 0;
  v10->__r_.__value_.__r.__words[2] = 0;
  v10->__r_.__value_.__r.__words[0] = 0;
  if (SHIBYTE(v13.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v13.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v12.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v12.__r_.__value_.__l.__data_);
  }

  PowerAssertionLock::addAssertion();
}

void BambiClient::removeAssertions(uint64_t a1, uint64_t a2, unsigned int __val)
{
  v21[2] = *MEMORY[0x1E69E9840];
  memset(&v19, 0, sizeof(v19));
  std::to_string(&v19, __val);
  v21[0] = ".ipt";
  v21[1] = ".apns";
  v20[0] = ".wifi";
  v20[1] = ".cell";
  v5 = (*(*(a1 + 16) + 64))(a1 + 16);
  (*(*(a1 + 16) + 16))(a1 + 16, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "Remove KeepAlive power assertions for stackId=", 46);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, a2);
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  v6 = 0;
  *(v5 + 17) = 0;
  do
  {
    for (i = 0; i != 2; ++i)
    {
      __p[0] = 0;
      __p[1] = 0;
      v18 = 0;
      std::operator+<char>();
      v8 = strlen(v20[i]);
      v9 = std::string::append(&v15, v20[i], v8);
      v10 = *&v9->__r_.__value_.__l.__data_;
      v16.__r_.__value_.__r.__words[2] = v9->__r_.__value_.__r.__words[2];
      *&v16.__r_.__value_.__l.__data_ = v10;
      v9->__r_.__value_.__l.__size_ = 0;
      v9->__r_.__value_.__r.__words[2] = 0;
      v9->__r_.__value_.__r.__words[0] = 0;
      v11 = strlen(v21[v6]);
      v12 = std::string::append(&v16, v21[v6], v11);
      v13 = *&v12->__r_.__value_.__l.__data_;
      v18 = v12->__r_.__value_.__r.__words[2];
      *__p = v13;
      v12->__r_.__value_.__l.__size_ = 0;
      v12->__r_.__value_.__r.__words[2] = 0;
      v12->__r_.__value_.__r.__words[0] = 0;
      if (SHIBYTE(v16.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v16.__r_.__value_.__l.__data_);
      }

      if (SHIBYTE(v15.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v15.__r_.__value_.__l.__data_);
      }

      std::__tree<std::__value_type<std::string,std::shared_ptr<AssertionCounter>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<AssertionCounter>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<AssertionCounter>>>>::__erase_unique<std::string>((a1 + 432), __p);
      if (SHIBYTE(v18) < 0)
      {
        operator delete(__p[0]);
      }
    }

    ++v6;
  }

  while (v6 != 2);
  if (SHIBYTE(v19.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v19.__r_.__value_.__l.__data_);
  }

  v14 = *MEMORY[0x1E69E9840];
}

void BambiClient::clientConfigForStackId(uint64_t a1@<X8>)
{
  v7 = 0;
  v8 = 0;
  IPTelephonyManager::getBambiClient(&v7);
  v5 = 0;
  v6 = 0;
  (*(*v7 + 184))(&v5);
  v2 = v5;
  if (v5)
  {
    v3 = *(v5 + 200);
    *(a1 + 8) = *(v5 + 208);
    *a1 = v3;
    if (*(v2 + 239) < 0)
    {
      std::string::__init_copy_ctor_external((a1 + 16), *(v2 + 216), *(v2 + 224));
    }

    else
    {
      v4 = *(v2 + 216);
      *(a1 + 32) = *(v2 + 232);
      *(a1 + 16) = v4;
    }

    *(a1 + 40) = *(v2 + 240);
    if (v6)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }

  else
  {
    if (v6)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }

    *a1 = 0;
    *(a1 + 8) = 0;
    *(a1 + 24) = 0;
    *(a1 + 32) = 0;
    *(a1 + 16) = 0;
    *(a1 + 40) = 0;
  }

  if (v8)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
  }
}

void sub_1E511B6E0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10, uint64_t a11, std::__shared_weak_count *a12)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  if (a12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a12);
  }

  _Unwind_Resume(exception_object);
}

std::string *BambiClientStatus::BambiClientStatus(std::string *a1, const std::string *a2, std::string::value_type a3)
{
  a1->__r_.__value_.__r.__words[0] = 0;
  a1->__r_.__value_.__l.__size_ = 0;
  a1->__r_.__value_.__r.__words[2] = 0;
  std::string::operator=(a1, a2);
  a1[1].__r_.__value_.__s.__data_[0] = a3;
  return a1;
}

void sub_1E511B774(_Unwind_Exception *exception_object)
{
  if (*(v1 + 23) < 0)
  {
    operator delete(*v1);
  }

  _Unwind_Resume(exception_object);
}

uint64_t std::ifstream::~ifstream(void *a1)
{
  v1 = MEMORY[0x1E69E54C8];
  v2 = *MEMORY[0x1E69E54C8];
  *a1 = *MEMORY[0x1E69E54C8];
  *(a1 + *(v2 - 24)) = *(v1 + 24);
  MEMORY[0x1E6923250](a1 + 2);

  return std::istream::~istream();
}

uint64_t std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::~__hash_table(uint64_t a1)
{
  v2 = *(a1 + 16);
  if (v2)
  {
    do
    {
      v3 = *v2;
      operator delete(v2);
      v2 = v3;
    }

    while (v3);
  }

  v4 = *a1;
  *a1 = 0;
  if (v4)
  {
    operator delete(v4);
  }

  return a1;
}

uint64_t std::__hash_table<std::shared_ptr<BambiCall>,std::hash<std::shared_ptr<BambiCall>>,std::equal_to<std::shared_ptr<BambiCall>>,std::allocator<std::shared_ptr<BambiCall>>>::~__hash_table(uint64_t a1)
{
  v2 = *(a1 + 16);
  if (v2)
  {
    do
    {
      v3 = *v2;
      v4 = v2[3];
      if (v4)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v4);
      }

      operator delete(v2);
      v2 = v3;
    }

    while (v3);
  }

  v5 = *a1;
  *a1 = 0;
  if (v5)
  {
    operator delete(v5);
  }

  return a1;
}

void std::__shared_ptr_emplace<BambiStrictCallHandler>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5A48;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void sub_1E511BA98(_Unwind_Exception *a1)
{
  std::__shared_weak_count::~__shared_weak_count(v1);
  operator delete(v3);
  _Unwind_Resume(a1);
}

void std::__shared_ptr_emplace<SimpleNetworkManager>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5A98;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<BambiClient::create(void)::Wrapper,std::allocator<BambiClient::create(void)::Wrapper>>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5AE8;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void BambiClient::create(void)::Wrapper::~Wrapper(BambiClient *a1)
{
  BambiClient::~BambiClient(a1);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toBambiClient::create(void)::Wrapper::~Wrapper(uint64_t a1)
{
  BambiClient::~BambiClient((a1 - 8));
}

{
  BambiClient::~BambiClient((a1 - 8));

  JUMPOUT(0x1E69235B0);
}

{
  BambiClient::~BambiClient((a1 - 16));
}

{
  BambiClient::~BambiClient((a1 - 16));

  JUMPOUT(0x1E69235B0);
}

{
  BambiClient::~BambiClient((a1 - 152));
}

{
  BambiClient::~BambiClient((a1 - 152));

  JUMPOUT(0x1E69235B0);
}

{
  BambiClient::~BambiClient((a1 - 160));
}

{
  BambiClient::~BambiClient((a1 - 160));

  JUMPOUT(0x1E69235B0);
}

{
  BambiClient::~BambiClient((a1 - 168));
}

{
  BambiClient::~BambiClient((a1 - 168));

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<RTPManager>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5D98;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<BambiUnlistedEmergencyCall>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5DE8;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<BambiCall>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5E38;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void *std::__hash_table<std::shared_ptr<BambiCall>,std::hash<std::shared_ptr<BambiCall>>,std::equal_to<std::shared_ptr<BambiCall>>,std::allocator<std::shared_ptr<BambiCall>>>::__emplace_unique_key_args<std::shared_ptr<BambiCall>,std::shared_ptr<BambiCall> const&>(void *result, unint64_t a2)
{
  v2 = 0x9DDFEA08EB382D69 * ((8 * (a2 & 0x1FFFFFFF) + 8) ^ HIDWORD(a2));
  v3 = 0x9DDFEA08EB382D69 * (HIDWORD(a2) ^ (v2 >> 47) ^ v2);
  v4 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
  v5 = result[1];
  if (!*&v5)
  {
    goto LABEL_18;
  }

  v6 = vcnt_s8(v5);
  v6.i16[0] = vaddlv_u8(v6);
  if (v6.u32[0] > 1uLL)
  {
    v7 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
    if (v4 >= *&v5)
    {
      v7 = v4 % *&v5;
    }
  }

  else
  {
    v7 = (*&v5 - 1) & v4;
  }

  v8 = *(*result + 8 * v7);
  if (!v8 || (v9 = *v8) == 0)
  {
LABEL_18:
    operator new();
  }

  while (1)
  {
    v10 = v9[1];
    if (v10 == v4)
    {
      break;
    }

    if (v6.u32[0] > 1uLL)
    {
      if (v10 >= *&v5)
      {
        v10 %= *&v5;
      }
    }

    else
    {
      v10 &= *&v5 - 1;
    }

    if (v10 != v7)
    {
      goto LABEL_18;
    }

LABEL_17:
    v9 = *v9;
    if (!v9)
    {
      goto LABEL_18;
    }
  }

  if (v9[2] != a2)
  {
    goto LABEL_17;
  }

  return result;
}

void *std::__hash_table<std::shared_ptr<BambiCall>,std::hash<std::shared_ptr<BambiCall>>,std::equal_to<std::shared_ptr<BambiCall>>,std::allocator<std::shared_ptr<BambiCall>>>::find<std::shared_ptr<BambiCall>>(void *a1, unint64_t a2)
{
  v2 = a1[1];
  if (!*&v2)
  {
    return 0;
  }

  v3 = 0x9DDFEA08EB382D69 * ((8 * (a2 & 0x1FFFFFFF) + 8) ^ HIDWORD(a2));
  v4 = 0x9DDFEA08EB382D69 * (HIDWORD(a2) ^ (v3 >> 47) ^ v3);
  v5 = 0x9DDFEA08EB382D69 * (v4 ^ (v4 >> 47));
  v6 = vcnt_s8(v2);
  v6.i16[0] = vaddlv_u8(v6);
  if (v6.u32[0] > 1uLL)
  {
    v7 = v5;
    if (v5 >= *&v2)
    {
      v7 = v5 % *&v2;
    }
  }

  else
  {
    v7 = (*&v2 - 1) & v5;
  }

  v8 = *(*a1 + 8 * v7);
  if (!v8)
  {
    return 0;
  }

  result = *v8;
  if (*v8)
  {
    do
    {
      v10 = result[1];
      if (v10 == v5)
      {
        if (result[2] == a2)
        {
          return result;
        }
      }

      else
      {
        if (v6.u32[0] > 1uLL)
        {
          if (v10 >= *&v2)
          {
            v10 %= *&v2;
          }
        }

        else
        {
          v10 &= *&v2 - 1;
        }

        if (v10 != v7)
        {
          return 0;
        }
      }

      result = *result;
    }

    while (result);
  }

  return result;
}

void std::__shared_ptr_emplace<LazuliSession>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF5E88;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void *std::__hash_table<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::__unordered_map_hasher<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::hash<unsigned long long>,std::equal_to<unsigned long long>,true>,std::__unordered_map_equal<unsigned long long,std::__hash_value_type<unsigned long long,BambiCallMediaStream *>,std::equal_to<unsigned long long>,std::hash<unsigned long long>,true>,std::allocator<std::__hash_value_type<unsigned long long,BambiCallMediaStream *>>>::find<unsigned long long>(void *a1, unint64_t a2)
{
  v2 = a1[1];
  if (!*&v2)
  {
    return 0;
  }

  v3 = vcnt_s8(v2);
  v3.i16[0] = vaddlv_u8(v3);
  if (v3.u32[0] > 1uLL)
  {
    v4 = a2;
    if (*&v2 <= a2)
    {
      v4 = a2 % *&v2;
    }
  }

  else
  {
    v4 = (*&v2 - 1) & a2;
  }

  v5 = *(*a1 + 8 * v4);
  if (!v5)
  {
    return 0;
  }

  result = *v5;
  if (*v5)
  {
    do
    {
      v7 = result[1];
      if (v7 == a2)
      {
        if (result[2] == a2)
        {
          return result;
        }
      }

      else
      {
        if (v3.u32[0] > 1uLL)
        {
          if (v7 >= *&v2)
          {
            v7 %= *&v2;
          }
        }

        else
        {
          v7 &= *&v2 - 1;
        }

        if (v7 != v4)
        {
          return 0;
        }
      }

      result = *result;
    }

    while (result);
  }

  return result;
}

void *std::__hash_table<std::shared_ptr<BambiCall>,std::hash<std::shared_ptr<BambiCall>>,std::equal_to<std::shared_ptr<BambiCall>>,std::allocator<std::shared_ptr<BambiCall>>>::__emplace_unique_key_args<std::shared_ptr<BambiCall>,std::shared_ptr<BambiCall>>(void *result, unint64_t a2)
{
  v2 = 0x9DDFEA08EB382D69 * ((8 * (a2 & 0x1FFFFFFF) + 8) ^ HIDWORD(a2));
  v3 = 0x9DDFEA08EB382D69 * (HIDWORD(a2) ^ (v2 >> 47) ^ v2);
  v4 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
  v5 = result[1];
  if (!*&v5)
  {
    goto LABEL_18;
  }

  v6 = vcnt_s8(v5);
  v6.i16[0] = vaddlv_u8(v6);
  if (v6.u32[0] > 1uLL)
  {
    v7 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
    if (v4 >= *&v5)
    {
      v7 = v4 % *&v5;
    }
  }

  else
  {
    v7 = (*&v5 - 1) & v4;
  }

  v8 = *(*result + 8 * v7);
  if (!v8 || (v9 = *v8) == 0)
  {
LABEL_18:
    operator new();
  }

  while (1)
  {
    v10 = v9[1];
    if (v10 == v4)
    {
      break;
    }

    if (v6.u32[0] > 1uLL)
    {
      if (v10 >= *&v5)
      {
        v10 %= *&v5;
      }
    }

    else
    {
      v10 &= *&v5 - 1;
    }

    if (v10 != v7)
    {
      goto LABEL_18;
    }

LABEL_17:
    v9 = *v9;
    if (!v9)
    {
      goto LABEL_18;
    }
  }

  if (v9[2] != a2)
  {
    goto LABEL_17;
  }

  return result;
}

void *std::__hash_table<std::shared_ptr<SipSessionInterface>,std::hash<std::shared_ptr<SipSessionInterface>>,std::equal_to<std::shared_ptr<SipSessionInterface>>,std::allocator<std::shared_ptr<SipSessionInterface>>>::__emplace_unique_key_args<std::shared_ptr<SipSessionInterface>,std::shared_ptr<SipSessionInterface> const&>(void *a1, void *a2)
{
  v2 = 0x9DDFEA08EB382D69 * ((8 * (*a2 & 0x1FFFFFFFLL) + 8) ^ HIDWORD(*a2));
  v3 = 0x9DDFEA08EB382D69 * (HIDWORD(*a2) ^ (v2 >> 47) ^ v2);
  v4 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
  v5 = a1[1];
  if (!*&v5)
  {
    goto LABEL_18;
  }

  v6 = vcnt_s8(v5);
  v6.i16[0] = vaddlv_u8(v6);
  if (v6.u32[0] > 1uLL)
  {
    v7 = 0x9DDFEA08EB382D69 * (v3 ^ (v3 >> 47));
    if (v4 >= *&v5)
    {
      v7 = v4 % *&v5;
    }
  }

  else
  {
    v7 = v4 & (*&v5 - 1);
  }

  v8 = *(*a1 + 8 * v7);
  if (!v8 || (v9 = *v8) == 0)
  {
LABEL_18:
    operator new();
  }

  while (1)
  {
    v10 = v9[1];
    if (v10 == v4)
    {
      break;
    }

    if (v6.u32[0] > 1uLL)
    {
      if (v10 >= *&v5)
      {
        v10 %= *&v5;
      }
    }

    else
    {
      v10 &= *&v5 - 1;
    }

    if (v10 != v7)
    {
      goto LABEL_18;
    }

LABEL_17:
    v9 = *v9;
    if (!v9)
    {
      goto LABEL_18;
    }
  }

  if (v9[2] != *a2)
  {
    goto LABEL_17;
  }

  return v9;
}

uint64_t __copy_helper_block_e8_40c40_ZTSNSt3__110shared_ptrIK11BambiClientEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c40_ZTSNSt3__110shared_ptrIK11BambiClientEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }
}

void *std::__shared_ptr_emplace<LazuliSession>::__shared_ptr_emplace[abi:ne200100]<std::shared_ptr<SipStack>,std::allocator<LazuliSession>,0>(void *a1, std::__shared_weak_count **a2)
{
  a1[1] = 0;
  a1[2] = 0;
  *a1 = &unk_1F5EF5E88;
  std::construct_at[abi:ne200100]<LazuliSession,std::shared_ptr<SipStack>,LazuliSession*>((a1 + 3), a2);
  return a1;
}

uint64_t std::construct_at[abi:ne200100]<LazuliSession,std::shared_ptr<SipStack>,LazuliSession*>(uint64_t a1, std::__shared_weak_count **a2)
{
  v3 = a2[1];
  v5[0] = *a2;
  v5[1] = v3;
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  LazuliSession::LazuliSession(a1, v5);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  return a1;
}

void sub_1E511CC24(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }

  _Unwind_Resume(exception_object);
}

uint64_t __cxx_global_var_init_187()
{
  {
    return __cxa_atexit(ctu::PthreadMutexGuardPolicy<IMSMetricsManager>::~PthreadMutexGuardPolicy, &ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance, &dword_1E4C3F000);
  }

  return result;
}

uint64_t _GLOBAL__sub_I_BambiClient_cpp()
{
  std::string::basic_string[abi:ne200100]<0>(&__p, "Uninitialized");
  BambiClientStatus::BambiClientStatus(BambiClientStatus::kStatusUninitialized, &__p, 0);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, BambiClientStatus::kStatusUninitialized, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "Initializing");
  BambiClientStatus::BambiClientStatus(&stru_1EE2BCA40, &__p, 0);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, &stru_1EE2BCA40, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "Initialized");
  BambiClientStatus::BambiClientStatus(&BambiClientStatus::kStatusInitialized, &__p, 0);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, &BambiClientStatus::kStatusInitialized, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "InitFailed");
  BambiClientStatus::BambiClientStatus(BambiClientStatus::kStatusInitFailed, &__p, 1);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, BambiClientStatus::kStatusInitFailed, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "FatalError");
  BambiClientStatus::BambiClientStatus(BambiClientStatus::kStatusFatalError, &__p, 1);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, BambiClientStatus::kStatusFatalError, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "Deinitializing");
  BambiClientStatus::BambiClientStatus(&stru_1EE2BCA60, &__p, 0);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  __cxa_atexit(BambiClientStatus::~BambiClientStatus, &stru_1EE2BCA60, &dword_1E4C3F000);
  std::string::basic_string[abi:ne200100]<0>(&__p, "MediaRequestTimedOut");
  BambiClientStatus::BambiClientStatus(BambiClientStatus::kStatusMediaRequestTimedOut, &__p, 1);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  return __cxa_atexit(BambiClientStatus::~BambiClientStatus, BambiClientStatus::kStatusMediaRequestTimedOut, &dword_1E4C3F000);
}

void sub_1E511CF04(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipUdpSocketMultiplexer::SipUdpSocketMultiplexer(void *a1, uint64_t *a2)
{
  v3 = a2[1];
  v5 = *a2;
  v6 = v3;
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::SipSocketMultiplexer(a1, &v5);
  if (v6)
  {
    std::__shared_weak_count::__release_weak(v6);
  }

  *a1 = &unk_1F5EF5F10;
  a1[6] = 0;
  a1[7] = 0;
  return a1;
}

void *SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::SipSocketMultiplexer(void *a1, uint64_t *a2)
{
  a1[2] = 0;
  *a1 = &unk_1F5EF5F80;
  a1[1] = a1 + 2;
  a1[4] = 0;
  a1[5] = 0;
  a1[3] = 0;
  v3 = *a2;
  v4 = a2[1];
  if (v4)
  {
    atomic_fetch_add_explicit((v4 + 16), 1uLL, memory_order_relaxed);
    v5 = a1[5];
    a1[4] = v3;
    a1[5] = v4;
    if (v5)
    {
      std::__shared_weak_count::__release_weak(v5);
    }
  }

  else
  {
    a1[4] = v3;
    a1[5] = 0;
  }

  return a1;
}

void SipUdpSocketMultiplexer::~SipUdpSocketMultiplexer(SipUdpSocketMultiplexer *this)
{
  *this = &unk_1F5EF5F10;
  v2 = *(this + 6);
  if (v2)
  {
    (*(*v2 + 48))(v2);
    v3 = *(this + 7);
    *(this + 6) = 0;
    *(this + 7) = 0;
    if (v3)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v3);
    }
  }

  v4 = *(this + 7);
  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }

  SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::~SipSocketMultiplexer(this);
}

{
  SipUdpSocketMultiplexer::~SipUdpSocketMultiplexer(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::~SipSocketMultiplexer(uint64_t a1)
{
  *a1 = &unk_1F5EF5F80;
  v2 = *(a1 + 40);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  std::__tree<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>>>::destroy(*(a1 + 16));
  return a1;
}

void SipUdpSocketMultiplexer::processDataFromSocket(void *a1, uint64_t a2, uint64_t a3, uint64_t *a4)
{
  v13 = *MEMORY[0x1E69E9840];
  SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::delegateForRemoteAddress(a1, a4, &__p);
  if (v12)
  {
    v7 = std::__shared_weak_count::lock(v12);
    if (v7)
    {
      v8 = __p;
    }

    else
    {
      v8 = 0;
    }

    if (v12)
    {
      std::__shared_weak_count::__release_weak(v12);
    }

    if (v8)
    {
      (*(*v8 + 24))(v8, a2, a3, a4);
      goto LABEL_11;
    }
  }

  else
  {
    v7 = 0;
  }

  ims::getStaticLoggerFor("transport", &__p);
  v9 = v12;
  ctu::OsLogContext::~OsLogContext(&__p);
  if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
  {
    IpAddress::logStr(*a4);
  }

LABEL_11:
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  v10 = *MEMORY[0x1E69E9840];
}

void sub_1E511D2E8(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  _Unwind_Resume(exception_object);
}

void SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::~SipSocketMultiplexer(uint64_t a1)
{
  SipSocketMultiplexer<ImsUdpSocketInterfaceDelegate>::~SipSocketMultiplexer(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t SDPParser::parseAMROctetAligned(uint64_t a1, uint64_t **a2)
{
  v2 = *(a2 + 23);
  if (v2 < 0)
  {
    if (a2[1] != 1)
    {
LABEL_7:
      v3 = 0;
      goto LABEL_8;
    }

    a2 = *a2;
  }

  else if (v2 != 1)
  {
    goto LABEL_7;
  }

  v3 = *a2 == 49;
LABEL_8:
  *(a1 + 43) = v3;
  *(a1 + 44) = 1;
  return 1;
}

uint64_t SDPParser::parseAMRModeset(uint64_t a1, const std::string *a2)
{
  *(a1 + 46) = SDPMediaFormatAMRParams::modesetFromString(a2);
  *(a1 + 63) = 0;
  return 1;
}

uint64_t SDPParser::parseAMRMaxRedundancy(uint64_t a1, char *__str)
{
  if (__str[23] < 0)
  {
    __str = *__str;
  }

  *(a1 + 48) = strtoul(__str, 0, 10);
  *(a1 + 50) = 1;
  return 1;
}

uint64_t SDPParser::parseAMRModeChangeCapability(uint64_t a1, char *__str)
{
  if (__str[23] < 0)
  {
    __str = *__str;
  }

  *(a1 + 52) = strtoul(__str, 0, 10);
  *(a1 + 54) = 1;
  return 1;
}

uint64_t SDPParser::parseAMRModeChangePeriod(uint64_t a1, char *__str)
{
  if (__str[23] < 0)
  {
    __str = *__str;
  }

  *(a1 + 56) = strtoul(__str, 0, 10);
  *(a1 + 58) = 1;
  return 1;
}

uint64_t SDPParser::parseAMRModeChangeNeighbor(uint64_t a1, char *__str)
{
  if (__str[23] < 0)
  {
    __str = *__str;
  }

  *(a1 + 60) = strtoul(__str, 0, 10);
  *(a1 + 62) = 1;
  return 1;
}

_BYTE *ims::toString<MediaDirection>@<X0>(unsigned int *a1@<X0>, _BYTE *a2@<X8>)
{
  v4 = *a1;
  if (v4 < 5)
  {
  }

  else
  {
    v5 = "Unknown";
  }

  return std::string::basic_string[abi:ne200100]<0>(a2, v5);
}

void SDPAttribute::toStream(SDPAttribute *this, ImsOutStream *a2)
{
  v4 = *(a2 + 1);
  __p.__r_.__value_.__s.__data_[0] = 97;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &__p, 1);
  *(a2 + 17) = 0;
  v5 = *(a2 + 1);
  __p.__r_.__value_.__s.__data_[0] = 61;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, &__p, 1);
  *(a2 + 17) = 0;
  (*(*this + 32))(&v10, this);
  LoggableString::LoggableString(&__p, &v10);
  (*(*a2 + 40))(a2, &__p);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v10.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v10.__r_.__value_.__l.__data_);
  }

  v6 = *(a2 + 18);
  memset(&__p, 0, sizeof(__p));
  (*(*this + 40))(&__p, this, v6);
  size = HIBYTE(__p.__r_.__value_.__r.__words[2]);
  v8 = HIBYTE(__p.__r_.__value_.__r.__words[2]);
  if ((__p.__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
  {
    size = __p.__r_.__value_.__l.__size_;
  }

  if (size)
  {
    v9 = *(a2 + 1);
    v10.__r_.__value_.__s.__data_[0] = 58;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, &v10, 1);
    *(a2 + 17) = 0;
    LoggableString::LoggableString(&v10, &__p);
    (*(*a2 + 40))(a2, &v10);
    if (SHIBYTE(v10.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v10.__r_.__value_.__l.__data_);
    }

    v8 = HIBYTE(__p.__r_.__value_.__r.__words[2]);
  }

  if (v8 < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }
}

void sub_1E511D6D8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, void *a15, uint64_t a16, int a17, __int16 a18, char a19, char a20)
{
  if (a14 < 0)
  {
    operator delete(__p);
  }

  if (a20 < 0)
  {
    operator delete(a15);
  }

  _Unwind_Resume(exception_object);
}

void SDPAttribute::key(SDPAttribute *this@<X0>, std::string *a2@<X8>)
{
  if (*(this + 39) < 0)
  {
    std::string::__init_copy_ctor_external(a2, *(this + 2), *(this + 3));
  }

  else
  {
    *&a2->__r_.__value_.__l.__data_ = *(this + 1);
    a2->__r_.__value_.__r.__words[2] = *(this + 4);
  }
}

void SipPBambiCallIdHeader::~SipPBambiCallIdHeader(void **this)
{
  *this = &unk_1F5EBEF98;
  if (*(this + 87) < 0)
  {
    operator delete(this[8]);
  }

  SipHeader::~SipHeader(this);
}

{
  *this = &unk_1F5EBEF98;
  if (*(this + 87) < 0)
  {
    operator delete(this[8]);
  }

  SipHeader::~SipHeader(this);

  JUMPOUT(0x1E69235B0);
}

void sub_1E511E014(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, void *a23, uint64_t a24, int a25, __int16 a26, char a27, char a28, void *a29, uint64_t a30, int a31, __int16 a32, char a33, char a34, dispatch_object_t object, uint64_t a36, uint64_t a37, void *a38, uint64_t a39, int a40, __int16 a41, char a42, char a43)
{
  if (v45)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v45);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  _Unwind_Resume(a1);
}

void sub_1E511E14C(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, void *__p, uint64_t a16, int a17, __int16 a18, char a19, char a20, uint64_t a21, char a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, void *a30, uint64_t a31, int a32, __int16 a33, char a34, char a35)
{
  if (a22 == 1 && a20 < 0)
  {
    operator delete(__p);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v35);
  if (a35 < 0)
  {
    operator delete(a30);
  }

  JUMPOUT(0x1E511E128);
}

void sub_1E511E190()
{
  if (!v0)
  {
    JUMPOUT(0x1E511E138);
  }

  JUMPOUT(0x1E511E128);
}

void SipOptionsManager::logPrefix(SipOptionsManager *this, ImsOutStream *a2)
{
  (*(*this + 24))(__p);
  (*(*a2 + 40))(a2, __p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), ": ", 2);
  *(a2 + 17) = 0;
  if (v4 < 0)
  {
    operator delete(__p[0]);
  }
}

void sub_1E511E240(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

uint64_t SipOptionsManager::handleNewServerTransaction(void *a1, uint64_t *a2)
{
  v3 = a1[22];
  if (!v3 || (v5 = *a2, v6 = a1[21], (v7 = std::__shared_weak_count::lock(v3)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v8 = v7;
  v9 = v6 + 8;
  atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
  v10 = *(v5 + 344);
  if (!v6)
  {
    v9 = 0;
  }

  *(v5 + 336) = v9;
  *(v5 + 344) = v8;
  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v8);
  v12 = a1[3];
  v11 = a1 + 3;
  v13 = (*(v12 + 64))(v11);
  (*(*v11 + 16))(v11, v13);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "new OPTIONS transaction ", 24);
  *(v13 + 17) = 0;
  (*(*v13 + 32))(v13, *a2 + 312);
  (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v13 + 17) = 0;
  return 1;
}

uint64_t SipOptionsManager::handleRequest(void *a1, uint64_t *a2)
{
  v61 = *MEMORY[0x1E69E9840];
  v4 = (*(**a2 + 120))();
  v5 = *(v4 + 23);
  v6 = v5;
  if ((v5 & 0x80u) != 0)
  {
    v5 = *(v4 + 8);
  }

  if (v5 != 7 || (v6 >= 0 ? (v7 = v4) : (v7 = *v4), (v8 = *v7, v9 = *(v7 + 3), v8 == *"OPTIONS") ? (v10 = v9 == *"IONS") : (v10 = 0), !v10))
  {
    result = 1;
    goto LABEL_12;
  }

  v13 = a1[27];
  if (v13)
  {
    v14 = std::__shared_weak_count::lock(v13);
    if (v14)
    {
      v15 = a1[26];
      if (v15)
      {
        v17 = *(v15 + 248);
        v16 = *(v15 + 256);
        if (v16)
        {
          atomic_fetch_add_explicit(&v16->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        v18 = v17 != 0;
        if (v17)
        {
          if (*(v15 + 2817) == 1)
          {
            v19 = (*(a1[3] + 64))(a1 + 3);
            (*(a1[3] + 16))(a1 + 3, v19);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "Routing MT OPTIONS tags to Lazuli", 33);
            *(v19 + 17) = 0;
            (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v19 + 17) = 0;
            v21 = *(v17 + 296);
            v20 = *(v17 + 304);
            if (v20)
            {
              atomic_fetch_add_explicit(&v20->__shared_owners_, 1uLL, memory_order_relaxed);
            }

            if (v21)
            {
              v57 = 0;
              v55 = 0u;
              v56 = 0u;
              v53 = 0u;
              v54 = 0u;
              v51 = 0u;
              v52 = 0u;
              v49 = 0u;
              v50 = 0u;
              v47 = 0u;
              v48 = 0u;
              v45 = 0u;
              v46 = 0u;
              v43 = 0u;
              v44 = 0u;
              v41 = 0u;
              v42 = 0u;
              v39 = 0u;
              v40 = 0u;
              v37 = 0u;
              v38 = 0u;
              v35 = 0u;
              v36 = 0u;
              v33 = 0u;
              v34 = 0u;
              __p = 0u;
              SipUri::SipUri(&__p);
              v22 = SipMessage::header<SipContactHeader>(*a2);
              if (v22 && (v23 = v22[9]) != 0 && v23 != v22[10] || (v28 = SipMessage::header<SipContactHeader>(*a2)) != 0 && (v23 = v28[9]) != 0 && v23 != v28[10])
              {
                SipUri::operator=(&__p, v23 + 8);
              }

              v29 = a2[1];
              v30 = *a2;
              v31 = v29;
              if (v29)
              {
                atomic_fetch_add_explicit(&v29->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              (*(*v21 + 56))(v21, &v30, 0, 0, &__p);
              if (v31)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v31);
              }

              SipUri::~SipUri(&__p);
            }

            if (v20)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v20);
            }
          }

          buf[0] = 200;
          *&__p = v17 + 384;
          std::allocate_shared[abi:ne200100]<SipResponse,std::allocator<SipResponse>,SipResponse::EnforcePrivateConstructor,unsigned int &,SipMessageEncodingMap const*&,0>();
        }

        v25 = a1[25];
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          (*(a1[20] + 16))(&__p, a1 + 20);
          v26 = (SBYTE7(v33) & 0x80u) == 0 ? &__p : __p;
          buf[0] = 141558275;
          *&buf[1] = 1752392040;
          v59 = 2081;
          v60 = v26;
          _os_log_error_impl(&dword_1E4C3F000, v25, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno user agent", buf, 0x16u);
          if (SBYTE7(v33) < 0)
          {
            operator delete(__p);
          }
        }

        if (v16)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v16);
        }

LABEL_56:
        std::__shared_weak_count::__release_shared[abi:ne200100](v14);
        result = v18;
        goto LABEL_12;
      }
    }
  }

  else
  {
    v14 = 0;
  }

  v24 = a1[25];
  if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
  {
    (*(a1[20] + 16))(&__p, a1 + 20);
    v27 = (SBYTE7(v33) & 0x80u) == 0 ? &__p : __p;
    buf[0] = 141558275;
    *&buf[1] = 1752392040;
    v59 = 2081;
    v60 = v27;
    _os_log_error_impl(&dword_1E4C3F000, v24, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno sipstack", buf, 0x16u);
    if (SBYTE7(v33) < 0)
    {
      operator delete(__p);
    }
  }

  v18 = 0;
  result = 0;
  if (v14)
  {
    goto LABEL_56;
  }

LABEL_12:
  v12 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_1E511EAB8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, std::__shared_weak_count *a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, char a39)
{
  SipUri::~SipUri(&a39);
  if (v40)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v40);
  }

  if (a9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a9);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v39);
  _Unwind_Resume(a1);
}

void SipOptionsManager::fillOptionsResponse(void *a1, void *a2, uint64_t *a3, SipMessage **a4)
{
  v74 = *MEMORY[0x1E69E9840];
  v5 = a1[27];
  if (v5)
  {
    v9 = std::__shared_weak_count::lock(v5);
    if (v9)
    {
      v10 = a1[26];
      if (v10)
      {
        v11 = *(v10 + 248);
        v12 = *(v10 + 256);
        if (v12)
        {
          atomic_fetch_add_explicit(&v12->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        if (!v11)
        {
          v19 = a1[25];
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            (*(a1[20] + 16))(&__p, a1 + 20);
            v20 = SHIBYTE(v56[1]) >= 0 ? &__p : __p;
            LODWORD(buf[0]) = 141558275;
            *(buf + 4) = 1752392040;
            WORD2(buf[1]) = 2081;
            *(&buf[1] + 6) = v20;
            _os_log_error_impl(&dword_1E4C3F000, v19, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno user agent", buf, 0x16u);
            if (SHIBYTE(v56[1]) < 0)
            {
              operator delete(__p);
            }
          }

          goto LABEL_76;
        }

        v13 = *a4;
        v14 = a2[1];
        v63[0] = *a2;
        v63[1] = v14;
        if (v14)
        {
          atomic_fetch_add_explicit(&v14->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        SipResponse::copyHeadersFromRequest(v13, v63);
        v50 = v11;
        if (v14)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v14);
        }

        memset(&v73, 0, 32);
        memset(v66, 0, sizeof(v66));
        v65 = 0u;
        memset(buf, 0, sizeof(buf));
        DWORD2(v65) = 90;
        v66[0] = 1;
        v66[2] = 1;
        *&v66[4] = 0x200000001;
        *&v66[13] = 257;
        *&v66[15] = 0;
        *&v66[23] = 256;
        v68 = 0u;
        v69 = 0u;
        memset(v67, 0, sizeof(v67));
        *v70 = 0x40A7700000000000;
        memset(v72, 0, sizeof(v72));
        memset(&v70[8], 0, 32);
        memset(v71, 0, sizeof(v71));
        v15 = *a3;
        if (*a3)
        {
          LOWORD(buf[0]) = *(v15 + 840);
          std::string::operator=(&buf[1], (v15 + 848));
          v16 = *(v15 + 888);
          v65 = *(v15 + 872);
          *v66 = v16;
          *&v66[16] = *(v15 + 904);
          *&v66[29] = *(v15 + 917);
          std::string::operator=(v67, (v15 + 928));
          std::string::operator=(&v67[24], (v15 + 952));
          v67[48] = *(v15 + 976);
          v17 = *(v15 + 1000);
          v68 = *(v15 + 984);
          v69 = v17;
          *v70 = *(v15 + 1016);
          std::string::operator=(&v70[16], (v15 + 1032));
          std::string::operator=(v71, (v15 + 1056));
          std::string::operator=(&v71[1], (v15 + 1080));
          std::string::operator=(v72, (v15 + 1104));
          std::string::operator=(&v72[24], (v15 + 1128));
          v72[48] = *(v15 + 1152);
          std::__optional_storage_base<std::string,false>::__assign_from[abi:ne200100]<std::__optional_copy_assign_base<std::string,false> const&>(&v73, (v15 + 1160));
        }

        else
        {
          v21 = SipStack::prefs(v10);
          BambiCallOptions::initializeFromPrefs(buf, v21);
        }

        if (*&v66[4] >= 2)
        {
          v22 = *a4;
          std::string::basic_string[abi:ne200100]<0>(&__p, "precondition");
          SipMessage::addSupportedOption(v22, &__p);
          if (SHIBYTE(v56[1]) < 0)
          {
            operator delete(__p);
          }
        }

        if (v66[0] == 1)
        {
          v23 = *a4;
          std::string::basic_string[abi:ne200100]<0>(&__p, "timer");
          SipMessage::addSupportedOption(v23, &__p);
          if (SHIBYTE(v56[1]) < 0)
          {
            operator delete(__p);
          }
        }

        v24 = *(v10 + 280);
        v25 = *(v10 + 288);
        if (v25)
        {
          atomic_fetch_add_explicit(&v25->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        isIPSecAvailableAndEnabled = SipTransportLayer::isIPSecAvailableAndEnabled(v24);
        if (v25)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v25);
        }

        if (isIPSecAvailableAndEnabled)
        {
          v27 = *a4;
          std::string::basic_string[abi:ne200100]<0>(&__p, "sec-agree");
          SipMessage::addSupportedOption(v27, &__p);
          if (SHIBYTE(v56[1]) < 0)
          {
            operator delete(__p);
          }
        }

        if (*(v10 + 2817) == 1)
        {
          v28 = SipStack::allRegisteredServices(v10);
          v30 = a1[3];
          v29 = a1 + 3;
          v31 = (*(v30 + 64))(v29);
          (*(*v29 + 16))(v29, v31);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), "Adding Lazuli tags in OPTIONS response: ", 40);
          *(v31 + 17) = 0;
          std::string::basic_string[abi:ne200100]<0>(&v51, ",");
          BambiServices::namesForServiceMask(v28, &__p);
          (*(*v31 + 32))(v31, &__p);
          (*(*v31 + 64))(v31, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v31 + 17) = 0;
          if (SHIBYTE(v56[1]) < 0)
          {
            operator delete(__p);
          }

          if (v54 < 0)
          {
            operator delete(v51);
          }

          v61 = 0u;
          v62 = 0u;
          v59 = 0u;
          v60 = 0u;
          v57 = 0u;
          v58 = 0u;
          memset(v56, 0, sizeof(v56));
          __p = &unk_1F5ED0580;
          SipUri::SipUri(v56);
          *&v59 = 0;
          *(&v58 + 1) = 0;
          *(&v57 + 1) = &unk_1F5EBEF50;
          *&v58 = &v58 + 8;
          WORD4(v59) = 256;
          v61 = 0uLL;
          *(&v60 + 1) = &v61;
          v62 = 0uLL;
          LODWORD(v60) = 0;
          v32 = (*(**a2 + 120))();
          SipUserAgent::fillContactForServicesAndMethod(v50, &__p, v28, v32, 0, &v51);
          v33 = (*(*v52 + 24))(v52, v53);
          ImsResult::~ImsResult(&v51);
          if ((v33 & 1) == 0)
          {
            SipMessage::setContact(*a4, &__p);
          }

          __p = &unk_1F5ED0580;
          if (*(&v62 + 1))
          {
            std::__shared_weak_count::__release_weak(*(&v62 + 1));
          }

          std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::destroy(&v60 + 8, v61);
          *(&v57 + 1) = &unk_1F5EBEF50;
          std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v58, *(&v58 + 1));
          SipUri::~SipUri(v56);
        }

        v34 = *a4;
        std::string::basic_string[abi:ne200100]<0>(&__p, "application/sdp");
        SipMessage::addHeader(v34, "Accept", &__p, 0);
        if (SHIBYTE(v56[1]) < 0)
        {
          operator delete(__p);
        }

        v35 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((*a2 + 72), "Accept");
        if (!v35)
        {
          goto LABEL_75;
        }

        v36 = v35[5];
        if (!v36)
        {
          goto LABEL_75;
        }

        v37 = **v36;
        if (!v38)
        {
          goto LABEL_75;
        }

        v39 = v38;
        std::string::basic_string[abi:ne200100]<0>(&__p, "application/sdp");
        v40 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>((v39 + 64), &__p);
        v41 = v39 + 72;
        if (SHIBYTE(v56[1]) < 0)
        {
          operator delete(__p);
        }

        if (v41 == v40)
        {
LABEL_75:
          BambiCallOptions::~BambiCallOptions(buf);
LABEL_76:
          if (v12)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v12);
          }

LABEL_78:
          std::__shared_weak_count::__release_shared[abi:ne200100](v9);
          goto LABEL_79;
        }

        __p = 0;
        v56[0] = 0;
        if (*a3)
        {
          (*(**a3 + 128))(&v51);
          v43 = v51;
          v42 = v52;
          if (v52)
          {
            atomic_fetch_add_explicit(v52 + 1, 1uLL, memory_order_relaxed);
          }

          v44 = v56[0];
          __p = v43;
          v56[0] = v42;
          if (v44)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v44);
          }

          v45 = v52;
          if (!v52)
          {
            goto LABEL_70;
          }
        }

        else
        {
          v47 = *(v10 + 4576);
          v48 = *(v10 + 4584);
          if (!v48)
          {
            __p = *(v10 + 4576);
            v56[0] = 0;
            if (v47)
            {
LABEL_72:
              v51 = 0;
              v52 = 0;
              std::allocate_shared[abi:ne200100]<SDPModel,std::allocator<SDPModel>,std::shared_ptr<SDPModel> &,0>();
            }

            goto LABEL_73;
          }

          atomic_fetch_add_explicit(&v48->__shared_owners_, 1uLL, memory_order_relaxed);
          v45 = v56[0];
          __p = v47;
          v56[0] = v48;
          if (!v45)
          {
LABEL_71:
            if (v47)
            {
              goto LABEL_72;
            }

LABEL_73:
            if (v56[0])
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v56[0]);
            }

            goto LABEL_75;
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v45);
LABEL_70:
        v47 = __p;
        goto LABEL_71;
      }
    }
  }

  else
  {
    v9 = 0;
  }

  v18 = a1[25];
  if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
  {
    (*(a1[20] + 16))(&__p, a1 + 20);
    v46 = SHIBYTE(v56[1]) >= 0 ? &__p : __p;
    LODWORD(buf[0]) = 141558275;
    *(buf + 4) = 1752392040;
    WORD2(buf[1]) = 2081;
    *(&buf[1] + 6) = v46;
    _os_log_error_impl(&dword_1E4C3F000, v18, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno sipstack", buf, 0x16u);
    if (SHIBYTE(v56[1]) < 0)
    {
      operator delete(__p);
    }
  }

  if (v9)
  {
    goto LABEL_78;
  }

LABEL_79:
  v49 = *MEMORY[0x1E69E9840];
}

void sub_1E511F600(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, std::__shared_weak_count *a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, void *__p, std::__shared_weak_count *a28)
{
  if (a17)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a17);
  }

  if (a28)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a28);
  }

  BambiCallOptions::~BambiCallOptions(&STACK[0x2A0]);
  if (v29)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v29);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  _Unwind_Resume(a1);
}

void SipOptionsManager::handleTransactionError(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(a1 + 224, (*a3 + 312));
  if (a1 + 232 == v6 || (v7 = *(v6 + 64)) == 0)
  {
    v9 = 0;
    goto LABEL_20;
  }

  v8 = *(v6 + 56);
  atomic_fetch_add_explicit(&v7->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  v9 = std::__shared_weak_count::lock(v7);
  std::__shared_weak_count::__release_weak(v7);
  if (!v9 || !v8)
  {
LABEL_20:
    v16 = *(a1 + 24);
    v15 = a1 + 24;
    v17 = (*(v16 + 48))(v15);
    (*(*v15 + 16))(v15, v17);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "no delegate registered for transaction ", 39);
    *(v17 + 17) = 0;
    (*(*v17 + 32))(v17, *a3 + 312);
    (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v17 + 17) = 0;
    if (!v9)
    {
      return;
    }

    goto LABEL_21;
  }

  v11 = *(*a3 + 264);
  v10 = *(*a3 + 272);
  if (v10)
  {
    atomic_fetch_add_explicit(&v10->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  memset(&v23, 0, sizeof(v23));
  SipMessage::transactionId(v11, &v23);
  v22 = 0;
  memset(v21, 0, sizeof(v21));
  SipUri::SipUri(v21);
  v12 = SipMessage::header<SipContactHeader>(v11);
  if (v12)
  {
    v13 = v12[9];
    if (v13)
    {
      if (v13 != v12[10])
      {
        SipUri::operator=(v21, v13 + 8);
      }
    }
  }

  v19 = v11;
  v20 = v10;
  if (v10)
  {
    atomic_fetch_add_explicit(&v10->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  SipMessage::assertedIdentityList(v11, v18);
  v14.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
  (*(*v8 + 24))(v8, &v19, 408, a2, &v23, v21, v18, ((v14.__d_.__rep_ - *(a1 + 248)) / 1000000.0));
  v24 = v18;
  std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100](&v24);
  if (v20)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v20);
  }

  SipUri::~SipUri(v21);
  if (SHIBYTE(v23.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v23.__r_.__value_.__l.__data_);
  }

  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }

LABEL_21:
  std::__shared_weak_count::__release_shared[abi:ne200100](v9);
}

void sub_1E511FA78(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, std::__shared_weak_count *a7, ...)
{
  va_start(va, a7);
  *(v10 - 72) = v9;
  std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100]((v10 - 72));
  if (a7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a7);
  }

  SipUri::~SipUri(va);
  if (*(v10 - 73) < 0)
  {
    operator delete(*(v10 - 96));
  }

  if (v8)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  _Unwind_Resume(a1);
}

void SipOptionsManager::sendOptionsRequest(uint64_t a1@<X0>, ImsResult *a2@<X8>)
{
  v4 = *(a1 + 216);
  if (v4)
  {
    v5 = std::__shared_weak_count::lock(v4);
    if (v5)
    {
      v6 = *(a1 + 208);
      if (v6)
      {
        v8 = *(v6 + 248);
        v7 = *(v6 + 256);
        if (v7)
        {
          atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        v13 = v7;
        if (v8)
        {
          v21[0] = 0;
          v21[1] = 0;
          v9 = *(v6 + 248);
          ims::AccessNetwork::isWifi((v6 + 3432));
          v10 = *(v6 + 296);
          SipMessageEncodingMap::createRequestFromTemplate(v9 + 384, v21);
        }

        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v20 = 0u;
        __p = &unk_1F5EBDEF8;
        v15 = &_bambiDomain;
        v16 = 1073741826;
        v12 = ImsResult::operator<<<char [14]>(&__p, "no user agent");
        ImsResult::ImsResult(a2, v12);
        ImsResult::~ImsResult(&__p);
        if (v13)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v13);
        }

        goto LABEL_13;
      }
    }
  }

  else
  {
    v5 = 0;
  }

  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  __p = &unk_1F5EBDEF8;
  v15 = &_bambiDomain;
  v16 = 1073741826;
  v11 = ImsResult::operator<<<char [12]>(&__p, "no sipstack");
  ImsResult::ImsResult(a2, v11);
  ImsResult::~ImsResult(&__p);
  if (v5)
  {
LABEL_13:
    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }
}

void sub_1E51201F4(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, std::__shared_weak_count *a13, char a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, std::__shared_weak_count *a32, void *__p, uint64_t a34, int a35, __int16 a36, char a37, char a38)
{
  std::unique_ptr<std::__tree_node<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,void *>,std::__tree_node_destructor<std::allocator<std::__tree_node<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,void *>>>>::~unique_ptr[abi:ne200100](&a14);
  if (a32)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a32);
  }

  ImsResult::~ImsResult(v39);
  SipContactParam::~SipContactParam(&__p);
  v42 = *(v40 - 96);
  if (v42)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v42);
  }

  if (a13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a13);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  _Unwind_Resume(a1);
}

uint64_t SipOptionsManager::handleResponse(void *a1, uint64_t *a2, void *a3)
{
  v4 = a1[27];
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = a1[26];
      if (!v9)
      {
LABEL_49:
        std::__shared_weak_count::__release_shared[abi:ne200100](v8);
        return 1;
      }

      v10 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>((a1 + 28), (*a3 + 312));
      if (a1 + 29 == v10 || (v11 = *(v10 + 64)) == 0)
      {
        v13 = 0;
        v12 = 0;
      }

      else
      {
        v12 = *(v10 + 56);
        atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v13 = std::__shared_weak_count::lock(v11);
        if (!v13)
        {
          v12 = 0;
        }

        std::__shared_weak_count::__release_weak(v11);
      }

      v75 = 0;
      memset(v74, 0, sizeof(v74));
      memset(v73, 0, sizeof(v73));
      SipUri::SipUri(v73);
      v14 = SipMessage::header<SipContactHeader>(*a2);
      if (v14 && (v15 = v14[9]) != 0 && v15 != v14[10])
      {
        SipUri::operator=(v73, v15 + 8);
        v16 = SipMessage::header<SipToHeader>(*a2);
        if (v16 && SipUri::isSipUri(v73) && (isPhoneNumber(v74) & 1) == 0)
        {
          v17 = (*(a1[3] + 64))(a1 + 3);
          (*(a1[3] + 16))(a1 + 3, v17);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "Contact is not a phone number.  Patching in To header", 53);
          *(v17 + 17) = 0;
          (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v17 + 17) = 0;
          SipUri::operator=(v73, v16 + 104);
        }
      }

      else
      {
        v18 = SipMessage::header<SipToHeader>(*a2);
        if (v18)
        {
          v19 = (*(a1[3] + 64))(a1 + 3);
          (*(a1[3] + 16))(a1 + 3, v19);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "Contact header is missing.  Patching in To header", 49);
          *(v19 + 17) = 0;
          (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v19 + 17) = 0;
          SipUri::operator=(v73, v18 + 104);
        }
      }

      v72 = 0;
      memset(v71, 0, sizeof(v71));
      SipResponse::asImsResult(*a2, v71);
      if (!v12)
      {
        v26 = a1[3];
        v25 = a1 + 3;
        v27 = (*(v26 + 56))(v25);
        (*(*v25 + 16))(v25, v27);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "no delegate registered for transaction ", 39);
        *(v27 + 17) = 0;
        (*(*v27 + 32))(v27, *a3 + 312);
        (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v27 + 17) = 0;
        goto LABEL_47;
      }

      v20 = *a2;
      v21 = *(*a2 + 128);
      if ((v21 - 200) <= 0x63)
      {
        v22 = a2[1];
        v69 = *a2;
        v70 = v22;
        if (v22)
        {
          atomic_fetch_add_explicit((v22 + 8), 1uLL, memory_order_relaxed);
          v21 = *(*a2 + 128);
        }

        v23.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
        (*(*v12 + 16))(v12, &v69, v21, ((v23.__d_.__rep_ - a1[31]) / 1000000.0), v73);
        v24 = v70;
        if (!v70)
        {
          goto LABEL_47;
        }

        goto LABEL_46;
      }

      if (v21 == 480)
      {
        v28 = SipMessage::header<SipContactHeader>(v20);
        if (!v28 || (v29 = v28[9], v29 == v28[10]))
        {
LABEL_37:
          v20 = *a2;
          goto LABEL_38;
        }

        v20 = *a2;
        if (v29)
        {
          v30 = SipMessage::header<SipContactHeader>(v20);
          v31 = v30[9];
          if (v31 == v30[10])
          {
            v31 = 0;
          }

          if (*(v31 + 440))
          {
            v32 = (*(a1[3] + 64))(a1 + 3);
            (*(a1[3] + 16))(a1 + 3, v32);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "Currently unregistered, but response has capabilities", 53);
            *(v32 + 17) = 0;
            (*(*v32 + 64))(v32, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v32 + 17) = 0;
            v33 = *a2;
            v34 = a2[1];
            v67 = *a2;
            v68 = v34;
            if (v34)
            {
              atomic_fetch_add_explicit((v34 + 8), 1uLL, memory_order_relaxed);
              v33 = *a2;
            }

            v35 = *(v33 + 128);
            v36.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
            (*(*v12 + 16))(v12, &v67, v35, ((v36.__d_.__rep_ - a1[31]) / 1000000.0), v73);
            v24 = v68;
            if (!v68)
            {
              goto LABEL_47;
            }

            goto LABEL_46;
          }

          goto LABEL_37;
        }
      }

LABEL_38:
      v37 = v20[32];
      if (v37 == 404 || v37 == 480 || v37 == 408)
      {
        v38 = (*(a1[3] + 56))(a1 + 3);
        (*(a1[3] + 16))(a1 + 3, v38);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v38 + 8), "Options response error: ", 24);
        *(v38 + 17) = 0;
        (*(*&v71[0] + 16))(v71, v38);
        (*(*v38 + 64))(v38, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v38 + 17) = 0;
        v39 = *a2;
        v40 = a2[1];
        v65 = *a2;
        v66 = v40;
        if (v40)
        {
          atomic_fetch_add_explicit((v40 + 8), 1uLL, memory_order_relaxed);
          v39 = *a2;
        }

        v41 = v39[32];
        SipMessage::transactionId(v39, &__p);
        SipMessage::assertedIdentityList(*a2, v63);
        v42.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
        (*(*v12 + 24))(v12, &v65, v41, v71, &__p, v73, v63, ((v42.__d_.__rep_ - a1[31]) / 1000000.0));
        v76[0] = v63;
        std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100](v76);
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }

        v24 = v66;
        if (!v66)
        {
          goto LABEL_47;
        }

        goto LABEL_46;
      }

      if (v37 != 503 || (*(v9 + 2817) & 1) == 0)
      {
        v49 = a2[1];
        v57 = v20;
        v58 = v49;
        if (v49)
        {
          atomic_fetch_add_explicit((v49 + 8), 1uLL, memory_order_relaxed);
          v20 = *a2;
          v37 = *(*a2 + 128);
        }

        SipMessage::transactionId(v20, &__p);
        SipMessage::assertedIdentityList(*a2, v63);
        v50.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
        (*(*v12 + 24))(v12, &v57, v37, v71, &__p, v73, v63, ((v50.__d_.__rep_ - a1[31]) / 1000000.0));
        v76[0] = v63;
        std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100](v76);
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }

        v24 = v58;
        if (!v58)
        {
          goto LABEL_47;
        }

LABEL_46:
        std::__shared_weak_count::__release_shared[abi:ne200100](v24);
LABEL_47:
        ImsResult::~ImsResult(v71);
        SipUri::~SipUri(v73);
        if (v13)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v13);
        }

        goto LABEL_49;
      }

      v44 = (*(a1[3] + 56))(a1 + 3);
      (*(a1[3] + 16))(a1 + 3, v44);
      __p.__r_.__value_.__r.__words[0] = "service unavailable";
      v45 = ImsOutStream::putStreamable<char const*&>(v44, &__p.__r_.__value_.__l.__data_);
      (*(*v45 + 64))(v45, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      v45[17] = 0;
      v46 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((*a2 + 72), "Retry-After");
      if (v46)
      {
        v47 = v46[5];
        if (v47)
        {
          memset(&__p, 0, sizeof(__p));
          (*(*v47 + 40))(v47, &__p);
          if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
          {
            v51 = __p.__r_.__value_.__r.__words[0];
            v48 = atoi(__p.__r_.__value_.__l.__data_);
            if (!v48)
            {
              operator delete(v51);
              goto LABEL_71;
            }
          }

          else
          {
            v48 = atoi(&__p);
            if (!v48)
            {
              goto LABEL_71;
            }
          }

          v52 = a3[1];
          v62[0] = *a3;
          v62[1] = v52;
          if (v52)
          {
            atomic_fetch_add_explicit((v52 + 8), 1uLL, memory_order_relaxed);
          }

          v61[0] = v12;
          v61[1] = v13;
          if (v13)
          {
            atomic_fetch_add_explicit(&v13->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          }

          SipOptionsManager::handleServiceUnavailable(a1, v62, v61, v48);
        }
      }

LABEL_71:
      v53 = *a2;
      v54 = a2[1];
      v59 = *a2;
      v60 = v54;
      if (v54)
      {
        atomic_fetch_add_explicit((v54 + 8), 1uLL, memory_order_relaxed);
        v53 = *a2;
      }

      v55 = v53[32];
      SipMessage::transactionId(v53, &__p);
      SipMessage::assertedIdentityList(*a2, v63);
      v56.__d_.__rep_ = std::chrono::steady_clock::now().__d_.__rep_;
      (*(*v12 + 24))(v12, &v59, v55, v71, &__p, v73, v63, ((v56.__d_.__rep_ - a1[31]) / 1000000.0));
      v76[0] = v63;
      std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100](v76);
      if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(__p.__r_.__value_.__l.__data_);
      }

      v24 = v60;
      if (!v60)
      {
        goto LABEL_47;
      }

      goto LABEL_46;
    }
  }

  return 1;
}

void sub_1E5120E5C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, void *__p, uint64_t a21, int a22, __int16 a23, char a24, char a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, char a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, char a44)
{
  if (a25 < 0)
  {
    operator delete(__p);
  }

  ImsResult::~ImsResult(&a32);
  SipUri::~SipUri(&a44);
  if (v45)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v45);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  _Unwind_Resume(a1);
}

void SipOptionsManager::handleServiceUnavailable(void *a1, uint64_t *a2, void *a3, uint64_t a4)
{
  v28 = *MEMORY[0x1E69E9840];
  v9 = *(*a2 + 264);
  v8 = *(*a2 + 272);
  if (v8)
  {
    atomic_fetch_add_explicit((v8 + 8), 1uLL, memory_order_relaxed);
  }

  v26 = 0;
  memset(v25, 0, sizeof(v25));
  SipUri::SipUri(v25, (v9 + 152));
  memset(&v24, 0, sizeof(v24));
  v10 = SipMessage::header<SipCallIdHeader>(v9);
  v11 = (v10 + 64);
  if (!v10)
  {
    v11 = &ims::kEmptyString;
  }

  if (*(v11 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v24, *v11, *(v11 + 1));
  }

  else
  {
    v24 = *v11;
  }

  v23 = 0u;
  memset(__str, 0, sizeof(__str));
  if (SHIBYTE(v24.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(__str, v24.__r_.__value_.__l.__data_, v24.__r_.__value_.__l.__size_);
  }

  else
  {
    __str[0] = v24;
  }

  SipUri::SipUri(&__str[1], v25);
  v12 = a3[1];
  *&v23 = *a3;
  *(&v23 + 1) = v12;
  if (v12)
  {
    atomic_fetch_add_explicit((v12 + 16), 1uLL, memory_order_relaxed);
  }

  v13 = a1[22];
  if (v13)
  {
    v14 = a1[21];
    v15 = std::__shared_weak_count::lock(v13);
    if (v15)
    {
      v16 = v15;
      p_shared_weak_owners = &v15->__shared_weak_owners_;
      atomic_fetch_add_explicit(&v15->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      std::__shared_weak_count::__release_shared[abi:ne200100](v15);
      atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
      __p[0] = 0;
      __p[1] = 0;
      v21 = 0;
      v18 = *a2;
      std::operator+<char>();
      v19 = (*(a1[3] + 64))(a1 + 3);
      (*(a1[3] + 16))(a1 + 3, v19);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "handleServiceUnavailable. Retrying OPTIONS again after ", 55);
      *(v19 + 17) = 0;
      MEMORY[0x1E6923350](*(v19 + 8), a4);
      *(v19 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " seconds.", 9);
      *(v19 + 17) = 0;
      (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v19 + 17) = 0;
      atomic_fetch_add_explicit(&v16->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v27 = 0;
      operator new();
    }
  }

  std::__throw_bad_weak_ptr[abi:ne200100]();
}

void sub_1E51214EC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, void *a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, uint64_t a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, uint64_t a56, uint64_t a57, uint64_t a58, uint64_t a59, uint64_t a60, uint64_t a61, uint64_t a62, uint64_t a63)
{
  operator delete(v75);
  if (a15 < 0)
  {
    operator delete(__p);
  }

  std::__shared_weak_count::__release_weak(v74);
  std::__shared_weak_count::__release_weak(v74);
  ResendOptionsInfo::~ResendOptionsInfo(&a16);
  if (a73 < 0)
  {
    operator delete(a72);
  }

  SipUri::~SipUri(&STACK[0x200]);
  if (v73)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v73);
  }

  _Unwind_Resume(a1);
}

void ResendOptionsInfo::~ResendOptionsInfo(ResendOptionsInfo *this)
{
  v2 = *(this + 55);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  SipUri::~SipUri((this + 24));
  if (*(this + 23) < 0)
  {
    operator delete(*this);
  }
}

void SipOptionsManager::~SipOptionsManager(SipOptionsManager *this)
{
  SipOptionsManager::~SipOptionsManager(this);

  JUMPOUT(0x1E69235B0);
}

{
  *this = &unk_1F5EF6090;
  *(this + 1) = &unk_1F5EF60E8;
  *(this + 2) = &unk_1F5EF6130;
  *(this + 3) = &unk_1F5EF6160;
  *(this + 20) = &unk_1F5EF61C0;
  SipTimerContainer::~SipTimerContainer((this + 280));
  std::__tree<std::__value_type<std::string,ResendOptionsInfo>,std::__map_value_compare<std::string,std::__value_type<std::string,ResendOptionsInfo>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ResendOptionsInfo>>>::destroy(this + 256, *(this + 33));
  std::__tree<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::weak_ptr<SipUserAgentDelegate>>>>::destroy(*(this + 29));
  v2 = *(this + 27);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  MEMORY[0x1E69225A0](this + 200);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 21);
  *(this + 3) = &unk_1F5ED7318;
  if (*(this + 104) == 1 && *(this + 95) < 0)
  {
    operator delete(*(this + 9));
  }

  if (*(this + 55) < 0)
  {
    operator delete(*(this + 4));
  }
}

void non-virtual thunk toSipOptionsManager::~SipOptionsManager(SipOptionsManager *this)
{
  SipOptionsManager::~SipOptionsManager((this - 8));
}

{
  SipOptionsManager::~SipOptionsManager((this - 8));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((this - 16));
}

{
  SipOptionsManager::~SipOptionsManager((this - 16));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((this - 24));
}

{
  SipOptionsManager::~SipOptionsManager((this - 24));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((this - 160));
}

{
  SipOptionsManager::~SipOptionsManager((this - 160));

  JUMPOUT(0x1E69235B0);
}

uint64_t ims::SharedLoggable<SipOptionsManager>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));
  return a1;
}

void ims::SharedLoggable<SipOptionsManager>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));

  JUMPOUT(0x1E69235B0);
}

void std::__tree<std::__value_type<std::string,ResendOptionsInfo>,std::__map_value_compare<std::string,std::__value_type<std::string,ResendOptionsInfo>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ResendOptionsInfo>>>::destroy(uint64_t a1, void *a2)
{
  if (a2)
  {
    std::__tree<std::__value_type<std::string,ResendOptionsInfo>,std::__map_value_compare<std::string,std::__value_type<std::string,ResendOptionsInfo>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ResendOptionsInfo>>>::destroy(a1, *a2);
    std::__tree<std::__value_type<std::string,ResendOptionsInfo>,std::__map_value_compare<std::string,std::__value_type<std::string,ResendOptionsInfo>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ResendOptionsInfo>>>::destroy(a1, a2[1]);
    std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ResendOptionsInfo>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ResendOptionsInfo>,void,0>(a1, (a2 + 4));

    operator delete(a2);
  }
}

void std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ResendOptionsInfo>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ResendOptionsInfo>,void,0>(uint64_t a1, uint64_t a2)
{
  v3 = *(a2 + 464);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  SipUri::~SipUri((a2 + 48));
  if (*(a2 + 47) < 0)
  {
    operator delete(*(a2 + 24));
  }

  if (*(a2 + 23) < 0)
  {
    v4 = *a2;

    operator delete(v4);
  }
}

void std::__shared_ptr_emplace<SipOptionsManager::create(std::weak_ptr<SipStack>)::Wrapper,std::allocator<SipOptionsManager::create(std::weak_ptr<SipStack>)::Wrapper>>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6310;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void SipOptionsManager::create(std::weak_ptr<SipStack>)::Wrapper::~Wrapper(SipOptionsManager *a1)
{
  SipOptionsManager::~SipOptionsManager(a1);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toSipOptionsManager::create(std::weak_ptr<SipStack>)::Wrapper::~Wrapper(uint64_t a1)
{
  SipOptionsManager::~SipOptionsManager((a1 - 8));
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 8));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 16));
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 16));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 24));
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 24));

  JUMPOUT(0x1E69235B0);
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 160));
}

{
  SipOptionsManager::~SipOptionsManager((a1 - 160));

  JUMPOUT(0x1E69235B0);
}

void std::__tree<std::__value_type<std::string,std::weak_ptr<SipOptionsDelegate>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::weak_ptr<SipOptionsDelegate>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::weak_ptr<SipOptionsDelegate>>>>::__erase_unique<std::string>(void *a1, void **a2)
{
  v3 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(a1, a2);
  if (a1 + 1 != v3)
  {
    v4 = v3;
    v5 = *(v3 + 8);
    if (v5)
    {
      do
      {
        v6 = v5;
        v5 = *v5;
      }

      while (v5);
    }

    else
    {
      v7 = v3;
      do
      {
        v6 = v7[2];
        v8 = *v6 == v7;
        v7 = v6;
      }

      while (!v8);
    }

    if (*a1 == v3)
    {
      *a1 = v6;
    }

    v9 = a1[1];
    --a1[2];
    std::__tree_remove[abi:ne200100]<std::__tree_node_base<void *> *>(v9, v4);
    std::__destroy_at[abi:ne200100]<std::pair<std::string const,std::weak_ptr<SipUserAgentDelegate>>,0>((v4 + 4));

    operator delete(v4);
  }
}

void *std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF64D0;
  v2 = a1[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  return a1;
}

void std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF64D0;
  v1 = a1[3];
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }

  JUMPOUT(0x1E69235B0);
}

uint64_t std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::__clone(uint64_t result, uint64_t a2)
{
  *a2 = &unk_1F5EF64D0;
  *(a2 + 8) = *(result + 8);
  v2 = *(result + 24);
  *(a2 + 24) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::destroy(uint64_t a1)
{
  v1 = *(a1 + 24);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::destroy_deallocate(void *__p)
{
  v2 = __p[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  operator delete(__p);
}

void std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::operator()(void *a1, void **a2)
{
  v3 = a1[3];
  if (v3)
  {
    v5 = a1[1];
    v6 = std::__shared_weak_count::lock(v3);
    if (v6)
    {
      v7 = v6;
      if (a1[2])
      {
        v8 = v5[33];
        if (!v8)
        {
          goto LABEL_14;
        }

        v9 = v5 + 33;
        do
        {
          v10 = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v8 + 4, a2);
          if ((v10 & 0x80u) == 0)
          {
            v9 = v8;
          }

          v8 = *(v8 + ((v10 >> 4) & 8));
        }

        while (v8);
        if (v9 == v5 + 33 || (std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(a2, v9 + 4) & 0x80) != 0)
        {
LABEL_14:
          v13 = v5[3];
          v12 = v5 + 3;
          v14 = (*(v13 + 48))(v12);
          (*(*v12 + 16))(v12, v14);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "Timer fired for unknown id ", 27);
          *(v14 + 17) = 0;
          (*(*v14 + 32))(v14, a2);
          (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v14 + 17) = 0;
        }

        else
        {
          v11 = (*(v5[3] + 64))(v5 + 3);
          (*(v5[3] + 16))(v5 + 3, v11);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "Retrying OPTIONS request again as recommended by Server", 55);
          *(v11 + 17) = 0;
          (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v11 + 17) = 0;
          v25 = 0u;
          memset(v24, 0, sizeof(v24));
          if (*(v9 + 79) < 0)
          {
            std::string::__init_copy_ctor_external(v24, v9[7], v9[8]);
          }

          else
          {
            v24[0] = *(v9 + 7);
          }

          SipUri::SipUri(&v24[1], (v9 + 10));
          v15 = v9[62];
          *&v25 = v9[61];
          *(&v25 + 1) = v15;
          if (v15)
          {
            v16 = 1;
            atomic_fetch_add_explicit((v15 + 16), 1uLL, memory_order_relaxed);
            v17 = *(&v25 + 1);
            if (*(&v25 + 1))
            {
              v16 = 0;
              atomic_fetch_add_explicit((*(&v25 + 1) + 16), 1uLL, memory_order_relaxed);
            }
          }

          else
          {
            v17 = 0;
            v16 = 1;
          }

          SipOptionsManager::sendOptionsRequest(v5, v23);
          ImsResult::~ImsResult(v23);
          if ((v16 & 1) == 0)
          {
            std::__shared_weak_count::__release_weak(v17);
          }

          v18 = v9[1];
          if (v18)
          {
            do
            {
              v19 = v18;
              v18 = *v18;
            }

            while (v18);
          }

          else
          {
            v20 = v9;
            do
            {
              v19 = v20[2];
              v21 = *v19 == v20;
              v20 = v19;
            }

            while (!v21);
          }

          if (v5[32] == v9)
          {
            v5[32] = v19;
          }

          v22 = v5[33];
          --v5[34];
          std::__tree_remove[abi:ne200100]<std::__tree_node_base<void *> *>(v22, v9);
          std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ResendOptionsInfo>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ResendOptionsInfo>,void,0>((v5 + 32), (v9 + 4));
          operator delete(v9);
          if (*(&v25 + 1))
          {
            std::__shared_weak_count::__release_weak(*(&v25 + 1));
          }

          SipUri::~SipUri(&v24[1]);
          if (SHIBYTE(v24[0].__r_.__value_.__r.__words[2]) < 0)
          {
            operator delete(v24[0].__r_.__value_.__l.__data_);
          }
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v7);
    }
  }
}

void sub_1E51222A0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, void *__p, uint64_t a24, int a25, __int16 a26, char a27, char a28)
{
  ResendOptionsInfo::~ResendOptionsInfo(&__p);
  std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  _Unwind_Resume(a1);
}

uint64_t std::__function::__func<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0,std::allocator<SipOptionsManager::handleServiceUnavailable(std::shared_ptr<SipTransaction>,std::weak_ptr<SipOptionsDelegate>,unsigned int)::$_0>,void ()(std::string &)>::target(uint64_t a1, uint64_t a2)
{
  {
    return a1 + 8;
  }

  else
  {
    return 0;
  }
}

void SipWWWAuthenticateHeader::~SipWWWAuthenticateHeader(SipWWWAuthenticateHeader *this)
{
  SipAuthenticateHeader::~SipAuthenticateHeader(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t SDPTiming::toStream(SDPTiming *this, ImsOutStream *a2)
{
  v4 = *(a2 + 1);
  v12 = 116;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &v12, 1);
  *(a2 + 17) = 0;
  v5 = *(a2 + 1);
  v13 = 61;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, &v13, 1);
  *(a2 + 17) = 0;
  MEMORY[0x1E69233B0](*(a2 + 1), *(this + 2));
  *(a2 + 17) = 0;
  v6 = *(a2 + 1);
  v14 = 32;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, &v14, 1);
  *(a2 + 17) = 0;
  result = MEMORY[0x1E69233B0](*(a2 + 1), *(this + 3));
  *(a2 + 17) = 0;
  v8 = this + 32;
  for (i = *(this + 5); i != v8; i = *(v10 - 8))
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r\n", 2);
    *(a2 + 17) = 0;
    v11 = *(i + 16);
    v10 = i + 16;
    result = (*(v11 + 16))(v10, a2);
  }

  return result;
}

uint64_t SDPRepeatTime::toStream(SDPRepeatTime *this, ImsOutStream *a2)
{
  v4 = *(a2 + 1);
  v12 = 114;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &v12, 1);
  *(a2 + 17) = 0;
  v5 = *(a2 + 1);
  v13 = 61;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, &v13, 1);
  *(a2 + 17) = 0;
  MEMORY[0x1E69233B0](*(a2 + 1), *(this + 2));
  *(a2 + 17) = 0;
  v6 = *(a2 + 1);
  v14 = 32;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, &v14, 1);
  *(a2 + 17) = 0;
  result = MEMORY[0x1E69233B0](*(a2 + 1), *(this + 3));
  *(a2 + 17) = 0;
  v8 = this + 32;
  for (i = *(this + 5); i != v8; i = *(i + 8))
  {
    v10 = *(i + 16);
    v11 = *(a2 + 1);
    v15 = 32;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, &v15, 1);
    *(a2 + 17) = 0;
    result = MEMORY[0x1E69233B0](*(a2 + 1), v10);
    *(a2 + 17) = 0;
  }

  return result;
}

void *SDPTimeZone::toStream(SDPTimeZone *this, ImsOutStream *a2)
{
  v4 = *(a2 + 1);
  v12 = 122;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &v12, 1);
  *(a2 + 17) = 0;
  v5 = *(a2 + 1);
  v13 = 61;
  result = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, &v13, 1);
  *(a2 + 17) = 0;
  v7 = this + 16;
  v8 = *(this + 3);
  if (v8 != this + 16)
  {
    do
    {
      v9 = *(v8 + 3);
      MEMORY[0x1E69233B0](*(a2 + 1), *(v8 + 2));
      *(a2 + 17) = 0;
      v10 = *(a2 + 1);
      v14 = 32;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, &v14, 1);
      *(a2 + 17) = 0;
      MEMORY[0x1E6923360](*(a2 + 1), v9);
      *(a2 + 17) = 0;
      v11 = *(a2 + 1);
      v15 = 32;
      result = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, &v15, 1);
      *(a2 + 17) = 0;
      v8 = *(v8 + 1);
    }

    while (v8 != v7);
  }

  return result;
}

void SDPRepeatTime::~SDPRepeatTime(SDPRepeatTime *this)
{
  *this = &unk_1F5EF65F8;
  std::__list_imp<unsigned long long>::clear(this + 4);
}

{
  *this = &unk_1F5EF65F8;
  std::__list_imp<unsigned long long>::clear(this + 4);

  JUMPOUT(0x1E69235B0);
}

void SDPTiming::~SDPTiming(SDPTiming *this)
{
  *this = &unk_1F5EF6640;
  std::__list_imp<SDPRepeatTime>::clear(this + 4);
}

{
  *this = &unk_1F5EF6640;
  std::__list_imp<SDPRepeatTime>::clear(this + 4);

  JUMPOUT(0x1E69235B0);
}

void SDPTimeZone::~SDPTimeZone(SDPTimeZone *this)
{
  *this = &unk_1F5EF6688;
  std::__list_imp<unsigned long long>::clear(this + 2);
}

{
  *this = &unk_1F5EF6688;
  std::__list_imp<unsigned long long>::clear(this + 2);

  JUMPOUT(0x1E69235B0);
}

uint64_t SipTransactionState::SipTransactionState(uint64_t a1, uint64_t a2)
{
  SipTransaction::stack(*a2, &__str);
  size = __str.__r_.__value_.__l.__size_;
  v26 = *&__str.__r_.__value_.__l.__data_;
  if (__str.__r_.__value_.__l.__size_)
  {
    atomic_fetch_add_explicit((__str.__r_.__value_.__l.__size_ + 16), 1uLL, memory_order_relaxed);
  }

  SipState::SipState(a1, &v26);
  if (*(&v26 + 1))
  {
    std::__shared_weak_count::__release_weak(*(&v26 + 1));
  }

  if (size)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](size);
  }

  std::string::basic_string[abi:ne200100]<0>(v24, "sip.txn");
  SipTransaction::stack(*a2, &v18);
  v5 = v18;
  v20 = *(v18 + 200);
  v21 = *(v18 + 208);
  if (*(v18 + 239) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, *(v18 + 216), *(v18 + 224));
  }

  else
  {
    __p = *(v18 + 216);
  }

  v23 = *(v5 + 240);
  ims::getQueue(&v29);
  ClientConfig::getLogTag(&v20, &v27);
  if ((v25 & 0x80u) == 0)
  {
    v6 = v24;
  }

  else
  {
    v6 = v24[0];
  }

  if ((v25 & 0x80u) == 0)
  {
    v7 = v25;
  }

  else
  {
    v7 = v24[1];
  }

  v8 = std::string::insert(&v27, 0, v6, v7);
  v9 = *&v8->__r_.__value_.__l.__data_;
  __str.__r_.__value_.__r.__words[2] = v8->__r_.__value_.__r.__words[2];
  *&__str.__r_.__value_.__l.__data_ = v9;
  v8->__r_.__value_.__l.__size_ = 0;
  v8->__r_.__value_.__r.__words[2] = 0;
  v8->__r_.__value_.__r.__words[0] = 0;
  if ((__str.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    p_str = &__str;
  }

  else
  {
    p_str = __str.__r_.__value_.__r.__words[0];
  }

  *(a1 + 216) = 0;
  *(a1 + 224) = 0;
  v11 = v29;
  *(a1 + 232) = v29;
  if (v11)
  {
    dispatch_retain(v11);
  }

  *(a1 + 240) = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 248), "com.apple.ipTelephony", p_str);
  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v27.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v27.__r_.__value_.__l.__data_);
  }

  if (v11)
  {
    dispatch_release(v11);
  }

  *(a1 + 208) = &unk_1F5EF6968;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v19)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v19);
  }

  if (v25 < 0)
  {
    operator delete(v24[0]);
  }

  *a1 = &unk_1F5EF66D0;
  *(a1 + 8) = &unk_1F5EF6750;
  *(a1 + 208) = &unk_1F5EF6780;
  *(a1 + 256) = 0;
  *(a1 + 264) = 0;
  v12 = *a2;
  v13 = *(a2 + 8);
  if (v13)
  {
    atomic_fetch_add_explicit((v13 + 16), 1uLL, memory_order_relaxed);
    v14 = *(a1 + 264);
    *(a1 + 256) = v12;
    *(a1 + 264) = v13;
    if (v14)
    {
      std::__shared_weak_count::__release_weak(v14);
    }
  }

  else
  {
    *(a1 + 256) = v12;
    *(a1 + 264) = 0;
  }

  std::string::basic_string[abi:ne200100]<0>(&__str, "sip.txn");
  SipTransaction::stack(*a2, &v27);
  v15 = v27.__r_.__value_.__r.__words[0];
  std::string::operator=((a1 + 64), &__str);
  v16 = *(v15 + 200);
  *(a1 + 96) = *(v15 + 208);
  *(a1 + 88) = v16;
  std::string::operator=((a1 + 104), (v15 + 216));
  *(a1 + 128) = *(v15 + 240);
  if (v27.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v27.__r_.__value_.__l.__size_);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  return a1;
}

void sub_1E5122C38(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10, uint64_t a11, uint64_t a12, void *a13, uint64_t a14, int a15, __int16 a16, char a17, char a18, uint64_t a19, void *__p, uint64_t a21, int a22, __int16 a23, char a24, char a25, uint64_t a26, std::__shared_weak_count *a27)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  if (a25 < 0)
  {
    operator delete(__p);
  }

  SipState::~SipState(v27);
  _Unwind_Resume(a1);
}

uint64_t SipTransactionState::stateMachine(SipTransactionState *this)
{
  v2 = *(this + 33);
  if (!v2)
  {
    return 0;
  }

  v3 = std::__shared_weak_count::lock(v2);
  if (!v3)
  {
    return 0;
  }

  v4 = v3;
  if (*(this + 32) && (v5 = *(this + 33)) != 0 && (v6 = std::__shared_weak_count::lock(v5)) != 0)
  {
    v7 = *(this + 32);
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  else
  {
    v7 = 0;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  return v7;
}

{
  v2 = *(this + 33);
  if (!v2)
  {
    return 0;
  }

  v3 = std::__shared_weak_count::lock(v2);
  if (!v3)
  {
    return 0;
  }

  v4 = v3;
  if (*(this + 32) && (v5 = *(this + 33)) != 0 && (v6 = std::__shared_weak_count::lock(v5)) != 0)
  {
    v7 = *(this + 32);
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  else
  {
    v7 = 0;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  return v7;
}

uint64_t SipTerminatedTransactionState::handleResponse(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 264);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(a1 + 256);
      if (v7)
      {
        v9 = *(v7 + 128);
        v8 = v7 + 128;
        v10 = (*(v9 + 64))(v8);
        (*(*v8 + 16))(v8, v10);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "ignoring ", 9);
        *(v10 + 17) = 0;
        MEMORY[0x1E6923350](*(v10 + 8), *(*a2 + 128));
        *(v10 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " response", 9);
        *(v10 + 17) = 0;
        (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v10 + 17) = 0;
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }

  return 0;
}

void non-virtual thunk toSipTransactionState::~SipTransactionState(SipTransactionState *this)
{
  SipTransactionState::~SipTransactionState((this - 8));
}

{
  SipTransactionState::~SipTransactionState((this - 8));

  JUMPOUT(0x1E69235B0);
}

{
  SipTransactionState::~SipTransactionState((this - 208));
}

{
  SipTransactionState::~SipTransactionState((this - 208));

  JUMPOUT(0x1E69235B0);
}

void SipTerminatedTransactionState::~SipTerminatedTransactionState(SipTerminatedTransactionState *this)
{
  SipTransactionState::~SipTransactionState(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toSipTerminatedTransactionState::~SipTerminatedTransactionState(SipTerminatedTransactionState *this)
{
  SipTransactionState::~SipTransactionState((this - 8));
}

{
  SipTransactionState::~SipTransactionState((this - 8));

  JUMPOUT(0x1E69235B0);
}

{
  SipTransactionState::~SipTransactionState((this - 208));
}

{
  SipTransactionState::~SipTransactionState((this - 208));

  JUMPOUT(0x1E69235B0);
}

uint64_t ims::SharedLoggable<SipTransactionState>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));
  return a1;
}

void ims::SharedLoggable<SipTransactionState>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));

  JUMPOUT(0x1E69235B0);
}

void *IMSNetworkPolicySession::IMSNetworkPolicySession(void *a1, uint64_t a2)
{
  std::string::basic_string[abi:ne200100]<0>(&v9, "ipsec");
  v5[0] = 0;
  v8 = 0;
  ImsLogContainer::ImsLogContainer(a1, &v9, v5);
  if (v8 == 1 && v7 < 0)
  {
    operator delete(__p);
  }

  if (v10 < 0)
  {
    operator delete(v9);
  }

  ctu::OsLogLogger::OsLogLogger((a1 + 18), "com.apple.ipTelephony", "ipsec");
  *a1 = &unk_1F5EF6990;
  a1[17] = &unk_1F5EF69F0;
  a1[19] = 0;
  a1[20] = a2;
  return a1;
}

void IMSNetworkPolicySession::~IMSNetworkPolicySession(IMSNetworkPolicySession *this)
{
  *this = &unk_1F5EF6990;
  *(this + 17) = &unk_1F5EF69F0;
  IMSNetworkPolicySession::deinitialize(this);
  MEMORY[0x1E69225A0](this + 144);
  *this = &unk_1F5ED7318;
  if (*(this + 80) == 1 && *(this + 71) < 0)
  {
    operator delete(*(this + 6));
  }

  if (*(this + 31) < 0)
  {
    operator delete(*(this + 1));
  }
}

{
  IMSNetworkPolicySession::~IMSNetworkPolicySession(this);

  JUMPOUT(0x1E69235B0);
}

void IMSNetworkPolicySession::deinitialize(IMSNetworkPolicySession *this)
{
  if (*(this + 19))
  {
    v2 = (*(*this + 64))(this);
    (*(*this + 16))(this, v2);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v2 + 8), "deinitializing network policy session", 37);
    *(v2 + 17) = 0;
    (*(*v2 + 64))(v2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v2 + 17) = 0;
    PolicyDeleteAll(*(this + 19));
    CFRelease(*(this + 19));
    *(this + 19) = 0;
  }
}

void non-virtual thunk toIMSNetworkPolicySession::~IMSNetworkPolicySession(IMSNetworkPolicySession *this)
{
  IMSNetworkPolicySession::~IMSNetworkPolicySession((this - 136));
}

{
  IMSNetworkPolicySession::~IMSNetworkPolicySession((this - 136));

  JUMPOUT(0x1E69235B0);
}

void IMSNetworkPolicySession::initialize(IMSNetworkPolicySession *this@<X0>, uint64_t a2@<X8>)
{
  v4 = *(this + 19);
  v5 = (*(*this + 64))(this);
  (*(*this + 16))(this, v5);
  v6 = *(v5 + 8);
  if (v4)
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, "policy session already initialized", 34);
    *(v5 + 17) = 0;
    (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v5 + 17) = 0;
LABEL_3:
    *(a2 + 24) = 0u;
    *(a2 + 40) = 0u;
    *(a2 + 56) = 0u;
    *(a2 + 72) = 0u;
    *a2 = &unk_1F5EBDEF8;
    *(a2 + 8) = &_bambiDomain;
    *(a2 + 16) = 0;
    return;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, "initializing network policy session", 35);
  *(v5 + 17) = 0;
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  Session = PolicyCreateSession(0, 0x1F5EFB918, _callback, this);
  *(this + 19) = Session;
  if (Session)
  {
    if (PolicySetSessionPriority(Session, @"High"))
    {
      goto LABEL_3;
    }

    IMSNetworkPolicySession::deinitialize(this);
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v12 = &unk_1F5EBDEF8;
    v13 = &_bambiDomain;
    v14 = 0x40000000;
    v8 = ImsResult::operator<<<char [34]>(&v12, "NEPolicySetSessionPriority failed");
    v9 = ImsLogContainer::logResult(this, v8);
    ImsResult::ImsResult(a2, v9);
  }

  else
  {
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v12 = &unk_1F5EBDEF8;
    v13 = &_bambiDomain;
    v14 = 0x40000000;
    v10 = ImsResult::operator<<<char [29]>(&v12, "NEPolicyCreateSession failed");
    v11 = ImsLogContainer::logResult(this, v10);
    ImsResult::ImsResult(a2, v11);
  }

  ImsResult::~ImsResult(&v12);
}

void sub_1E5123754(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void _callback(uint64_t a1, uint64_t a2, uint64_t a3)
{
  std::string::basic_string[abi:ne200100]<0>(v10, "ipsec");
  v6[0] = 0;
  v9 = 0;
  v5 = ims::debug(v10, v6);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "NEPolicyCallback called with itemID ", 36);
  *(v5 + 17) = 0;
  MEMORY[0x1E6923350](*(v5 + 8), a2);
  *(v5 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), ", notificationType ", 19);
  *(v5 + 17) = 0;
  MEMORY[0x1E6923350](*(v5 + 8), a3);
  *(v5 + 17) = 0;
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  if (v9 == 1 && v8 < 0)
  {
    operator delete(__p);
  }

  if (v11 < 0)
  {
    operator delete(v10[0]);
  }
}

void sub_1E5123880(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

void IMSNetworkPolicySession::addPolicy(uint64_t a1@<X0>, uint64_t *a2@<X1>, char *a3@<X4>, ImsResult *a4@<X8>)
{
  if (*(a1 + 152))
  {
    v12[0] = &unk_1F5EBE6A8;
    v12[1] = 0;
    v11[0] = &unk_1F5EBED08;
    v11[1] = 0;
    ims::CFMutableDictionary::setValue(v11, @"ConditionType", @"BoundInterface");
    ims::CFString::CFString(&v13, a3);
    ims::CFMutableDictionary::setValue(v11, @"InterfaceName", v14);
    ims::CFType::~CFType(&v13);
    ims::CFMutableArray::appendValue(v12, v11);
    (*(v11[0] + 48))(v11, 0, 0);
    ims::CFMutableDictionary::setValue(v11, @"ConditionType", @"LocalAddressSubnet");
    v8 = *a2;
    IpAddress::asString(&v13);
  }

  v16 = 0u;
  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v13 = &unk_1F5EBDEF8;
  v14 = &_bambiDomain;
  v15 = 1073741826;
  v9 = ImsResult::operator<<<char [33]>(&v13, "policy session isn't initialized");
  v10 = ImsLogContainer::logResult(a1, v9);
  ImsResult::ImsResult(a4, v10);
  ImsResult::~ImsResult(&v13);
}

void sub_1E5124258(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, void *__p, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, int a33, __int16 a34, char a35, char a36, uint64_t a37, char a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, int a43, __int16 a44, char a45, char a46, uint64_t a47, char a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, int a53, __int16 a54, char a55, char a56, uint64_t a57, char a58)
{
  ims::CFType::~CFType((v58 - 216));
  ims::CFType::~CFType((v58 - 200));
  ims::CFType::~CFType((v58 - 184));
  _Unwind_Resume(a1);
}

void IMSNetworkPolicySession::applyPolicies(IMSNetworkPolicySession *this@<X0>, uint64_t a2@<X8>)
{
  v4 = *(this + 19);
  if (v4)
  {
    v5 = PolicyApply(v4);
    *(a2 + 40) = 0u;
    *(a2 + 56) = 0u;
    *(a2 + 72) = 0u;
    *a2 = &unk_1F5EBDEF8;
    *(a2 + 8) = &_bambiDomain;
    *(a2 + 16) = (v5 == 0) << 30;
    *(a2 + 24) = 0;
    *(a2 + 32) = 0;
  }

  else
  {
    v10 = 0u;
    v11 = 0u;
    v12 = 0u;
    v13 = 0u;
    v8[0] = &unk_1F5EBDEF8;
    v8[1] = &_bambiDomain;
    v9 = 1073741826;
    v6 = ImsResult::operator<<<char [26]>(v8, "applyPolicies: no session");
    v7 = ImsLogContainer::logResult(this, v6);
    ImsResult::ImsResult(a2, v7);
    ImsResult::~ImsResult(v8);
  }
}

void sub_1E51244E4(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void IMSNetworkPolicySession::deletePolicy(IMSNetworkPolicySession *this@<X0>, uint64_t a2@<X1>, uint64_t a3@<X8>)
{
  if (a2)
  {
    if (*(this + 19))
    {
      if (PolicyDelete())
      {
        v6 = (*(*this + 64))(this);
        (*(*this + 16))(this, v6);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "removed NEPolicy ", 17);
        *(v6 + 17) = 0;
        MEMORY[0x1E6923350](*(v6 + 8), a2);
        *(v6 + 17) = 0;
        (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v6 + 17) = 0;
        *(a3 + 24) = 0u;
        *(a3 + 40) = 0u;
        *(a3 + 56) = 0u;
        *(a3 + 72) = 0u;
        *a3 = &unk_1F5EBDEF8;
        *(a3 + 8) = &_bambiDomain;
        *(a3 + 16) = 0;
        return;
      }

      v16 = 0u;
      v17 = 0u;
      v18 = 0u;
      v19 = 0u;
      v13 = &unk_1F5EBDEF8;
      v14 = &_bambiDomain;
      v15 = 0x40000000;
      v11 = ImsResult::operator<<<char [22]>(&v13, "NEPolicyDelete failed");
      v12 = ImsLogContainer::logResult(this, v11);
      ImsResult::ImsResult(a3, v12);
    }

    else
    {
      v16 = 0u;
      v17 = 0u;
      v18 = 0u;
      v19 = 0u;
      v13 = &unk_1F5EBDEF8;
      v14 = &_bambiDomain;
      v15 = 1073741826;
      v9 = ImsResult::operator<<<char [33]>(&v13, "policy session isn't initialized");
      v10 = ImsLogContainer::logResult(this, v9);
      ImsResult::ImsResult(a3, v10);
    }
  }

  else
  {
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v19 = 0u;
    v13 = &unk_1F5EBDEF8;
    v14 = &_bambiDomain;
    v15 = 1073741825;
    v7 = ImsResult::operator<<<char [18]>(&v13, "invalid policy ID");
    v8 = ImsLogContainer::logResult(this, v7);
    ImsResult::ImsResult(a3, v8);
  }

  ImsResult::~ImsResult(&v13);
}

void sub_1E5124790(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void *IMSNetworkPolicySession::logPrefix(IMSNetworkPolicySession *this, ImsOutStream *a2)
{
  result = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "NetworkPolicySession: ", 22);
  *(a2 + 17) = 0;
  return result;
}

void RTPActiveSessionSet::setActive(uint64_t a1, uint64_t a2, int a3)
{
  v9 = a3;
  v5 = a1 + 8;
  v6 = *(a1 + 8);
  if (!v6)
  {
    goto LABEL_8;
  }

  v7 = a1 + 8;
  do
  {
    if (*(v6 + 32) >= a3)
    {
      v7 = v6;
    }

    v6 = *(v6 + 8 * (*(v6 + 32) < a3));
  }

  while (v6);
  if (v7 == v5 || *(v7 + 32) > a3)
  {
LABEL_8:
    v7 = a1 + 8;
  }

  if (a2)
  {
    if (v7 != v5)
    {
      v8 = *(v7 + 40);
      v10 = &v9;
      std::__tree<std::__value_type<SDPMedia::MediaType,unsigned long long>,std::__map_value_compare<SDPMedia::MediaType,std::__value_type<SDPMedia::MediaType,unsigned long long>,std::less<SDPMedia::MediaType>,true>,std::allocator<std::__value_type<SDPMedia::MediaType,unsigned long long>>>::__emplace_unique_key_args<SDPMedia::MediaType,std::piecewise_construct_t const&,std::tuple<SDPMedia::MediaType const&>,std::tuple<>>(a1 + 24, &v9)[5] = v8;
    }

    v10 = &v9;
    std::__tree<std::__value_type<SDPMedia::MediaType,unsigned long long>,std::__map_value_compare<SDPMedia::MediaType,std::__value_type<SDPMedia::MediaType,unsigned long long>,std::less<SDPMedia::MediaType>,true>,std::allocator<std::__value_type<SDPMedia::MediaType,unsigned long long>>>::__emplace_unique_key_args<SDPMedia::MediaType,std::piecewise_construct_t const&,std::tuple<SDPMedia::MediaType const&>,std::tuple<>>(a1, &v9)[5] = a2;
  }

  else if (v7 != v5)
  {
    std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__remove_node_pointer(a1, v7);

    operator delete(v7);
  }
}

void *RTPActiveSessionSet::active(void *this, void *a2)
{
  this[2] = 0;
  this[1] = 0;
  *this = this + 1;
  v2 = a2 + 1;
  v3 = *a2;
  if (*a2 != a2 + 1)
  {
    v4 = this;
    do
    {
      this = std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>(v4, *(v3 + 4) >> 64);
      v5 = v3[1];
      if (v5)
      {
        do
        {
          v6 = v5;
          v5 = *v5;
        }

        while (v5);
      }

      else
      {
        do
        {
          v6 = v3[2];
          v7 = *v6 == v3;
          v3 = v6;
        }

        while (!v7);
      }

      v3 = v6;
    }

    while (v6 != v2);
  }

  return this;
}

uint64_t RTPManager::RTPManager(uint64_t a1, void *a2, NSObject **a3)
{
  ims::SharedLoggable<RTPSharedPointerBase>::SharedLoggable((a1 + 440));
  *a1 = &unk_1F5EF6D00;
  *(a1 + 440) = &unk_1F5EF6D30;
  *(a1 + 8) = &unk_1F5EF6DE0;
  *(a1 + 16) = &unk_1F5ECE5C0;
  *(a1 + 24) = &unk_1F5ED5E68;
  MediaSessionCollection::MediaSessionCollection((a1 + 32));
  *a1 = &unk_1F5EF6A90;
  *(a1 + 440) = &unk_1F5EF6CD0;
  *(a1 + 8) = &unk_1F5EF6B88;
  *(a1 + 16) = &unk_1F5EF6BA8;
  *(a1 + 24) = &unk_1F5EF6BE8;
  *(a1 + 32) = &unk_1F5EF6C20;
  *(a1 + 40) = &unk_1F5EF6C90;
  *(a1 + 48) = *a2;
  v6 = a2[1];
  *(a1 + 56) = v6;
  if (v6)
  {
    atomic_fetch_add_explicit((v6 + 16), 1uLL, memory_order_relaxed);
  }

  *(a1 + 72) = 0;
  *(a1 + 64) = a1 + 72;
  *(a1 + 104) = 0;
  *(a1 + 112) = 0;
  *(a1 + 96) = 0;
  *(a1 + 80) = 0;
  *(a1 + 88) = a1 + 96;
  MediaSessionCollection::MediaSessionCollection((a1 + 120));
  *(a1 + 136) = 0;
  *(a1 + 128) = a1 + 136;
  *(a1 + 120) = &unk_1F5EC16A8;
  *(a1 + 144) = 0;
  v7 = std::string::basic_string[abi:ne200100]<0>(&v23, "rtp.collection");
  LOBYTE(v19[0]) = 0;
  v22 = 0;
  v8 = ims::debug(v7, v19);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "MediaSessionBaseCollection", 26);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v22 == 1 && v21 < 0)
  {
    operator delete(__p);
  }

  if (v24 < 0)
  {
    operator delete(v23);
  }

  *(a1 + 192) = 0;
  *(a1 + 200) = 0;
  *(a1 + 152) = 0u;
  *(a1 + 168) = 0u;
  *(a1 + 184) = a1 + 192;
  *(a1 + 216) = 0;
  *(a1 + 208) = a1 + 216;
  *(a1 + 224) = 0;
  *(a1 + 240) = 0;
  *(a1 + 232) = a1 + 240;
  *(a1 + 264) = 0;
  *(a1 + 256) = a1 + 264;
  *(a1 + 248) = 0;
  *(a1 + 296) = 0;
  *(a1 + 288) = 0;
  *(a1 + 272) = 0;
  *(a1 + 280) = a1 + 288;
  *(a1 + 304) = 1;
  v9 = *a3;
  *(a1 + 312) = *a3;
  if (v9)
  {
    dispatch_retain(v9);
  }

  *(a1 + 328) = 0;
  *(a1 + 336) = 0;
  *(a1 + 320) = a1 + 328;
  std::string::basic_string[abi:ne200100]<0>((a1 + 344), "UnknownStackID");
  std::string::basic_string[abi:ne200100]<0>((a1 + 368), &str_2_23);
  *(a1 + 392) = a1 + 400;
  *(a1 + 400) = 0;
  *(a1 + 408) = 0;
  *(a1 + 416) = 0;
  *(a1 + 424) = 0;
  *(a1 + 432) = 0;
  std::string::basic_string[abi:ne200100]<0>(v19, "rtp.mgr");
  v15[0] = 0;
  v18 = 0;
  v10 = ims::debug(v19, v15);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "RTPManager", 10);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v18 == 1 && v17 < 0)
  {
    operator delete(v16);
  }

  if (SHIBYTE(__p) < 0)
  {
    operator delete(v19[0]);
  }

  v11 = a2[1];
  if (v11)
  {
    v12 = std::__shared_weak_count::lock(v11);
  }

  else
  {
    v12 = 0;
  }

  v13 = TelephonyRadiosGetRadioVendor() - 1;
  if (v13 < 3)
  {
    *(a1 + 308) = dword_1E51817B8[v13];
  }

  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  return a1;
}

void sub_1E5124E84(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, void *a20, uint64_t a21, int a22, __int16 a23, char a24, char a25, uint64_t a26, int a27, __int16 a28, char a29, char a30, uint64_t a31, char a32)
{
  if (v39)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v39);
  }

  a20 = (v32 + 416);
  std::vector<std::weak_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](&a20);
  std::__tree<std::string>::destroy(v32 + 392, *(v32 + 400));
  if (*(v32 + 391) < 0)
  {
    operator delete(*(v32 + 368));
  }

  if (*(v32 + 367) < 0)
  {
    operator delete(*(v32 + 344));
  }

  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(v32 + 328));
  v41 = *(v32 + 312);
  if (v41)
  {
    dispatch_release(v41);
  }

  std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::destroy(*(v32 + 288));
  std::__tree<unsigned int>::destroy(v38, *(v32 + 264));
  std::__tree<unsigned int>::destroy(v37, *(v32 + 240));
  std::__tree<unsigned int>::destroy(v36, *(v32 + 216));
  std::__tree<std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::__map_value_compare<unsigned int,std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::less<unsigned int>,true>,std::allocator<std::__value_type<unsigned int,std::shared_ptr<IBISession>>>>::destroy(*(v32 + 192));
  v42 = *(v32 + 176);
  if (v42)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v42);
  }

  v43 = *(v32 + 160);
  if (v43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  }

  MediaSessionBaseCollection::~MediaSessionBaseCollection(v35);
  RTPActiveSessionSet::~RTPActiveSessionSet(v34);
  v44 = *(v32 + 56);
  if (v44)
  {
    std::__shared_weak_count::__release_weak(v44);
  }

  MediaSessionCollection::~MediaSessionCollection(v33);
  MEMORY[0x1E69225A0](v32 + 480);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((v32 + 448));
  _Unwind_Resume(a1);
}

void RTPManager::~RTPManager(RTPManager *this)
{
  *this = &unk_1F5EF6A90;
  *(this + 55) = &unk_1F5EF6CD0;
  *(this + 1) = &unk_1F5EF6B88;
  *(this + 2) = &unk_1F5EF6BA8;
  *(this + 3) = &unk_1F5EF6BE8;
  v2 = (this + 32);
  *(this + 4) = &unk_1F5EF6C20;
  *(this + 5) = &unk_1F5EF6C90;
  std::string::basic_string[abi:ne200100]<0>(v18, "rtp.mgr");
  v14[0] = 0;
  v17 = 0;
  v3 = ims::debug(v18, v14);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "~RTPManager", 11);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v17 == 1 && v16 < 0)
  {
    operator delete(__p);
  }

  if (v19 < 0)
  {
    operator delete(v18[0]);
  }

  std::vector<std::weak_ptr<BambiConferenceParticipant>>::clear[abi:ne200100](this + 52);
  std::__tree<std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::__map_value_compare<unsigned int,std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::less<unsigned int>,true>,std::allocator<std::__value_type<unsigned int,std::shared_ptr<IBISession>>>>::destroy(*(this + 24));
  *(this + 24) = 0;
  *(this + 25) = 0;
  *(this + 23) = this + 192;
  v4 = *(this + 40);
  v5 = this + 328;
  if (v4 != this + 328)
  {
    do
    {
      v6 = *(v4 + 5);
      if (v6)
      {
        ImsPowerAssertion::~ImsPowerAssertion(v6);
        MEMORY[0x1E69235B0]();
      }

      v7 = *(v4 + 1);
      if (v7)
      {
        do
        {
          v8 = v7;
          v7 = *v7;
        }

        while (v7);
      }

      else
      {
        do
        {
          v8 = *(v4 + 2);
          v9 = *v8 == v4;
          v4 = v8;
        }

        while (!v9);
      }

      v4 = v8;
    }

    while (v8 != v5);
  }

  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 41));
  *(this + 41) = 0;
  *(this + 42) = 0;
  *(this + 40) = v5;
  v18[0] = this + 416;
  std::vector<std::weak_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](v18);
  std::__tree<std::string>::destroy(this + 392, *(this + 50));
  if (*(this + 391) < 0)
  {
    operator delete(*(this + 46));
  }

  if (*(this + 367) < 0)
  {
    operator delete(*(this + 43));
  }

  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 41));
  v10 = *(this + 39);
  if (v10)
  {
    dispatch_release(v10);
  }

  std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::destroy(*(this + 36));
  std::__tree<unsigned int>::destroy(this + 256, *(this + 33));
  std::__tree<unsigned int>::destroy(this + 232, *(this + 30));
  std::__tree<unsigned int>::destroy(this + 208, *(this + 27));
  std::__tree<std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::__map_value_compare<unsigned int,std::__value_type<unsigned int,std::shared_ptr<IBISession>>,std::less<unsigned int>,true>,std::allocator<std::__value_type<unsigned int,std::shared_ptr<IBISession>>>>::destroy(*(this + 24));
  v11 = *(this + 22);
  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }

  v12 = *(this + 20);
  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  MediaSessionBaseCollection::~MediaSessionBaseCollection((this + 120));
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 12));
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 9));
  v13 = *(this + 7);
  if (v13)
  {
    std::__shared_weak_count::__release_weak(v13);
  }

  MediaSessionCollection::~MediaSessionCollection(v2);
  MEMORY[0x1E69225A0](this + 480);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 56);
}

{
  RTPManager::~RTPManager(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toRTPManager::~RTPManager(RTPManager *this)
{
  RTPManager::~RTPManager((this - 24));
}

{
  RTPManager::~RTPManager((this - 32));
}

{
  RTPManager::~RTPManager((this - 40));
}

{
  RTPManager::~RTPManager((this - 24));

  JUMPOUT(0x1E69235B0);
}

{
  RTPManager::~RTPManager((this - 32));

  JUMPOUT(0x1E69235B0);
}

{
  RTPManager::~RTPManager((this - 40));

  JUMPOUT(0x1E69235B0);
}

void virtual thunk toRTPManager::~RTPManager(RTPManager *this)
{
  RTPManager::~RTPManager((this + *(*this - 24)));
}

{
  RTPManager::~RTPManager((this + *(*this - 24)));

  JUMPOUT(0x1E69235B0);
}

uint64_t RTPManager::initialize(uint64_t a1, std::string *a2, uint64_t a3, int a4)
{
  v8 = std::string::basic_string[abi:ne200100]<0>(&v48, "rtp.mgr");
  v44[0] = 0;
  v47 = 0;
  v9 = ims::debug(v8, v44);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v10 = v9;
  v11 = *(*(*a1 - 8) + 8);
  v12 = *(v9 + 8);
  v13 = strlen((v11 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v12, v11 & 0x7FFFFFFFFFFFFFFFLL, v13);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "::", 2);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "initialize", 10);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " [stackId=", 10);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "]", 1);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v47 == 1 && v46 < 0)
  {
    operator delete(__p);
  }

  if (v49 < 0)
  {
    operator delete(v48);
  }

  RTPManager::setRTPStackType(a1, a2, a3);
  RTPSharedPointerBase::getShared<MediaSessionCollectionIterator>(a1, &v48);
  v14 = v48;
  v48 = 0uLL;
  v15 = *(a1 + 160);
  *(a1 + 152) = v14;
  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
    if (*(&v48 + 1))
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](*(&v48 + 1));
    }
  }

  if (a4)
  {
    std::string::operator=((a1 + 344), a2);
  }

  v17 = (a1 + 192);
  v16 = *(a1 + 192);
  if (!v16)
  {
    goto LABEL_21;
  }

  v18 = a1 + 192;
  do
  {
    if (*(v16 + 32) >= 2)
    {
      v18 = v16;
    }

    v16 = *(v16 + 8 * (*(v16 + 32) < 2));
  }

  while (v16);
  if (v18 == v17 || *(v18 + 32) >= 3)
  {
LABEL_21:
    if (*(a1 + 308) == 2 && (TelephonyRadiosGetRadioVendor() == 2 || TelephonyRadiosGetRadioVendor() == 3))
    {
      v19 = std::string::basic_string[abi:ne200100]<0>(&v48, "rtp.mgr");
      v40[0] = 0;
      v43 = 0;
      v20 = ims::debug(v19, v40);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v20 + 8), "Create IBI RTP Stack", 20);
      *(v20 + 17) = 0;
      (*(*v20 + 64))(v20, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v20 + 17) = 0;
      if (v43 == 1 && v42 < 0)
      {
        operator delete(v41);
      }

      if (v49 < 0)
      {
        operator delete(v48);
      }

      RTPSharedPointerBase::getShared<RTPStackControllerDelegate>(&v51, a1);
      RTPSharedPointerBase::getShared<RTPManager>(&v50, a1);
      operator new();
    }

    if (TelephonyRadiosGetRadioVendor() == 1)
    {
      v21 = std::string::basic_string[abi:ne200100]<0>(&v48, "rtp.mgr");
      v36[0] = 0;
      v39 = 0;
      v22 = ims::debug(v21, v36);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "Create QMI RTP Stack", 20);
      *(v22 + 17) = 0;
      (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v22 + 17) = 0;
      if (v39 == 1 && v38 < 0)
      {
        operator delete(v37);
      }

      if (v49 < 0)
      {
        operator delete(v48);
      }

      RTPSharedPointerBase::getShared<RTPStackControllerDelegate>(&v51, a1);
      RTPSharedPointerBase::getShared<RTPManager>(&v50, a1);
      operator new();
    }
  }

  v23 = *v17;
  if (!*v17)
  {
    goto LABEL_42;
  }

  v24 = a1 + 192;
  do
  {
    if (*(v23 + 32) >= 1)
    {
      v24 = v23;
    }

    v23 = *(v23 + 8 * (*(v23 + 32) < 1));
  }

  while (v23);
  if (v24 == v17 || *(v24 + 32) >= 2)
  {
LABEL_42:
    v25 = std::string::basic_string[abi:ne200100]<0>(&v48, "rtp.mgr");
    v32[0] = 0;
    v35 = 0;
    v26 = ims::debug(v25, v32);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "Create AVC RTP Stack", 20);
    *(v26 + 17) = 0;
    (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v26 + 17) = 0;
    if (v35 == 1 && v34 < 0)
    {
      operator delete(v33);
    }

    if (v49 < 0)
    {
      operator delete(v48);
    }

    v31[0] = 0;
    v31[1] = 0;
    IPTelephonyManager::getBambiClient(&v48);
    (*(*v48 + 184))(v31);
    if (*(&v48 + 1))
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](*(&v48 + 1));
    }

    RTPSharedPointerBase::getShared<RTPStackControllerDelegate>(&v30, a1);
    RTPSharedPointerBase::getShared<RTPManager>(&v29, a1);
    if (v31[0])
    {
      v27 = SipStack::prefs(v31[0]);
      ImsPrefs::EnableAPOnlyMode(v27);
    }

    operator new();
  }

  return 1;
}

void sub_1E5125EFC(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, uint64_t a26, void *__p, uint64_t a28, int a29, __int16 a30, char a31, char a32, uint64_t a33, char a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, int a39, __int16 a40, char a41, char a42, uint64_t a43, char a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, int a49, __int16 a50, char a51, char a52, uint64_t a53, char a54)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v54);
  v57 = *(v55 - 96);
  if (v57)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v57);
  }

  _Unwind_Resume(a1);
}

void RTPManager::setRTPStackType(uint64_t a1, std::string *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp.mgr");
  v58[0] = 0;
  v61 = 0;
  v7 = ims::debug(v6, v58);
  v8 = *(*(*a1 - 8) + 8);
  v9 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), v8 & 0x7FFFFFFFFFFFFFFFLL, v9);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "setRTPStackType", 15);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [stackId=", 10);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " stackType=", 11);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923340](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " isDeinit=", 10);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923320](*(v7 + 8), 0);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v61 == 1 && v60 < 0)
  {
    operator delete(v59);
  }

  if (v63 < 0)
  {
    operator delete(v62[0]);
  }

  v10 = *(a1 + 288);
  if (!v10)
  {
    goto LABEL_27;
  }

  v11 = a1 + 288;
  do
  {
    v12 = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>((v10 + 32), &a2->__r_.__value_.__l.__data_);
    if ((v12 & 0x80u) == 0)
    {
      v11 = v10;
    }

    v10 = *(v10 + ((v12 >> 4) & 8));
  }

  while (v10);
  if (v11 == a1 + 288 || (std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(a2, (v11 + 32)) & 0x80) != 0 || (v62[0] = a2, !*(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, &a2->__r_.__value_.__l.__data_) + 56)))
  {
LABEL_27:
    v18 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp");
    v54[0] = 0;
    v57 = 0;
    v19 = ims::debug(v18, v54);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "Initializing active stack type for ", 35);
    *(v19 + 17) = 0;
    (*(*v19 + 32))(v19, a2);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " to ", 4);
    *(v19 + 17) = 0;
    v20 = "Undefined RTP stack";
    if (a3 == 2)
    {
      v20 = "kRTPStackTypeBaseband";
    }

    if (a3 == 1)
    {
      v21 = "kRTPStackTypeAVC";
    }

    else
    {
      v21 = v20;
    }

    std::string::basic_string[abi:ne200100]<0>(&v52, v21);
    LoggableString::LoggableString(&v53, &v52);
    (*(*v19 + 40))(v19, &v53);
    (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v19 + 17) = 0;
    if (SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v53.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v52.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v52.__r_.__value_.__l.__data_);
    }

    if (v57 == 1 && v56 < 0)
    {
      operator delete(v55);
    }

    if (v63 < 0)
    {
      operator delete(v62[0]);
    }

    v62[0] = a2;
    *(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, &a2->__r_.__value_.__l.__data_) + 56) = a3;
  }

  else
  {
    v62[0] = a2;
    if (*(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, &a2->__r_.__value_.__l.__data_) + 56) == a3)
    {
      v13 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp");
      v48[0] = 0;
      v51 = 0;
      v14 = ims::debug(v13, v48);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "Not changing active stack type for ", 35);
      *(v14 + 17) = 0;
      (*(*v14 + 32))(v14, a2);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), ", leaving it as: ", 17);
      *(v14 + 17) = 0;
      v15 = "Undefined RTP stack";
      if (a3 == 2)
      {
        v15 = "kRTPStackTypeBaseband";
      }

      if (a3 == 1)
      {
        v16 = "kRTPStackTypeAVC";
      }

      else
      {
        v16 = v15;
      }

      std::string::basic_string[abi:ne200100]<0>(&v52, v16);
      LoggableString::LoggableString(&v53, &v52);
      (*(*v14 + 40))(v14, &v53);
      (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v14 + 17) = 0;
      if (SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v53.__r_.__value_.__l.__data_);
      }

      if (SHIBYTE(v52.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v52.__r_.__value_.__l.__data_);
      }

      if (v51 != 1 || (v50 & 0x80000000) == 0)
      {
        goto LABEL_75;
      }

      v17 = v49;
      goto LABEL_74;
    }

    v22 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp");
    v44[0] = 0;
    v47 = 0;
    v23 = ims::debug(v22, v44);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "Changing active stack type for ", 31);
    *(v23 + 17) = 0;
    (*(*v23 + 32))(v23, a2);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), ", old: ", 7);
    *(v23 + 17) = 0;
    __p.__r_.__value_.__r.__words[0] = a2;
    v24 = *(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, &a2->__r_.__value_.__l.__data_) + 56);
    if (v24 == 2)
    {
      v25 = "kRTPStackTypeBaseband";
    }

    else
    {
      v25 = "Undefined RTP stack";
    }

    if (v24 == 1)
    {
      v26 = "kRTPStackTypeAVC";
    }

    else
    {
      v26 = v25;
    }

    std::string::basic_string[abi:ne200100]<0>(&v52, v26);
    LoggableString::LoggableString(&v53, &v52);
    (*(*v23 + 40))(v23, &v53);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), " new: ", 6);
    *(v23 + 17) = 0;
    if (a3 == 2)
    {
      v27 = "kRTPStackTypeBaseband";
    }

    else
    {
      v27 = "Undefined RTP stack";
    }

    if (a3 == 1)
    {
      v28 = "kRTPStackTypeAVC";
    }

    else
    {
      v28 = v27;
    }

    std::string::basic_string[abi:ne200100]<0>(&v42, v28);
    LoggableString::LoggableString(&__p, &v42);
    (*(*v23 + 40))(v23, &__p);
    (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v23 + 17) = 0;
    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v42.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v42.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v53.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v52.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v52.__r_.__value_.__l.__data_);
    }

    if (v47 == 1 && v46 < 0)
    {
      operator delete(v45);
    }

    if (v63 < 0)
    {
      operator delete(v62[0]);
    }

    v62[0] = a2;
    *(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, &a2->__r_.__value_.__l.__data_) + 56) = a3;
    v29 = *(a1 + 391);
    if (v29 < 0)
    {
      v29 = *(a1 + 376);
    }

    if (v29)
    {
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(a1 + 392, &a2->__r_.__value_.__l.__data_);
      v30 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp");
      v38[0] = 0;
      v41 = 0;
      v31 = ims::debug(v30, v38);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), "A handover is already in progress on ", 37);
      *(v31 + 17) = 0;
      (*(*v31 + 32))(v31, a1 + 368);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), ".  Deferring until current handover completes.", 46);
      *(v31 + 17) = 0;
      (*(*v31 + 64))(v31, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v31 + 17) = 0;
      if (v41 != 1 || (v40 & 0x80000000) == 0)
      {
        goto LABEL_75;
      }

      v17 = v39;
LABEL_74:
      operator delete(v17);
LABEL_75:
      if (v63 < 0)
      {
        operator delete(v62[0]);
      }

      return;
    }

    std::string::operator=((a1 + 368), a2);
    if (*(a1 + 168))
    {
      v32 = std::string::basic_string[abi:ne200100]<0>(v62, "rtp");
      v34[0] = 0;
      v37 = 0;
      v33 = ims::debug(v32, v34);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v33 + 8), "SRVCC handover is already in progress. Deferring until SRVCC handover completes.", 80);
      *(v33 + 17) = 0;
      (*(*v33 + 64))(v33, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v33 + 17) = 0;
      if (v37 == 1 && v36 < 0)
      {
        operator delete(v35);
      }

      if (v63 < 0)
      {
        operator delete(v62[0]);
      }

      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(a1 + 392, &a2->__r_.__value_.__l.__data_);
    }

    else
    {
      RTPManager::handoverStack(a1, &a2->__r_.__value_.__l.__data_);
    }
  }
}

void sub_1E5126AB0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, void *a30, uint64_t a31, int a32, __int16 a33, char a34, char a35, void *a36, uint64_t a37, int a38, __int16 a39, char a40, char a41, uint64_t a42, uint64_t a43, uint64_t a44, uint64_t a45, int a46, __int16 a47, char a48, char a49, uint64_t a50, char a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, int a56, __int16 a57, char a58, char a59, uint64_t a60, char a61)
{
  if (a19 == 1 && a17 < 0)
  {
    operator delete(__p);
  }

  if (*(v61 - 65) < 0)
  {
    operator delete(*(v61 - 88));
  }

  _Unwind_Resume(exception_object);
}

void RTPSharedPointerBase::getShared<RTPStackControllerDelegate>(void **p_lpsrc, void *a2)
{
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&lpsrc, (a2 + *(*a2 - 24) + 8));
  if (lpsrc)
  {
    v3 = **lpsrc;
    if (v4)
    {
      v5 = v7;
      *p_lpsrc = v4;
      p_lpsrc[1] = v5;
      p_lpsrc = &lpsrc;
    }
  }

  *p_lpsrc = 0;
  p_lpsrc[1] = 0;
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void RTPManager::initializeApplicationId(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  v32 = a4;
  v8 = std::string::basic_string[abi:ne200100]<0>(&v30, "rtp.mgr");
  v26[0] = 0;
  v29 = 0;
  v9 = ims::debug(v8, v26);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v10 = v9;
  v11 = *(*(*a1 - 8) + 8);
  v12 = *(v9 + 8);
  v13 = strlen((v11 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v12, v11 & 0x7FFFFFFFFFFFFFFFLL, v13);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "::", 2);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "initializeApplicationId", 23);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " [stackId=", 10);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " appId=", 7);
  *(v10 + 17) = 0;
  MEMORY[0x1E6923340](*(v10 + 8), a3);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "]", 1);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v29 == 1 && v28 < 0)
  {
    operator delete(__p);
  }

  if (v31 < 0)
  {
    operator delete(v30);
  }

  v14 = *(a1 + 192);
  if (!v14)
  {
    goto LABEL_14;
  }

  v15 = a1 + 192;
  do
  {
    if (*(v14 + 32) >= a4)
    {
      v15 = v14;
    }

    v14 = *(v14 + 8 * (*(v14 + 32) < a4));
  }

  while (v14);
  if (v15 != a1 + 192 && *(v15 + 32) <= a4)
  {
    *(a1 + 304) = a4;
    v30 = &v32;
    v16 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType const&>,std::tuple<>>(a1 + 184, &v32);
    (*(*v16[5] + 24))(v16[5], a2, a3);
  }

  else
  {
LABEL_14:
    v24 = 0;
    v25 = 0;
    v21 = 0u;
    v22 = 0u;
    v23 = 0u;
    v17[0] = &unk_1F5EBDEF8;
    v17[1] = &_bambiDomain;
    v18 = 0x40000000;
    v19 = 0;
    v20 = 0;
    (*(*a1 + 112))(a1, &v24, a2, a3, v17);
    ImsResult::~ImsResult(v17);
    if (v25)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v25);
    }
  }
}

void sub_1E512700C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, std::__shared_weak_count *a21, uint64_t a22, uint64_t a23, void *__p, uint64_t a25, int a26, __int16 a27, char a28, char a29, uint64_t a30, char a31)
{
  ImsResult::~ImsResult(&a9);
  if (a21)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a21);
  }

  _Unwind_Resume(a1);
}

void RTPManager::deinitializeSessions(uint64_t a1, const void **a2)
{
  std::string::basic_string[abi:ne200100]<0>(&v46, "rtp.mgr");
  v42[0] = 0;
  v45 = 0;
  v4 = ims::debug(&v46, v42);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v5 = v4;
  v6 = *(*(*a1 - 8) + 8);
  v7 = *(v4 + 8);
  v8 = strlen((v6 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v7, v6 & 0x7FFFFFFFFFFFFFFFLL, v8);
  *(v5 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "::", 2);
  *(v5 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "deinitializeSessions", 20);
  *(v5 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), " [stackId=", 10);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "]", 1);
  *(v5 + 17) = 0;
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  if (v45 == 1 && v44 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v48) < 0)
  {
    operator delete(v46);
  }

  v46 = 0;
  v47 = 0;
  v48 = 0;
  RTPActiveSessionSet::active(&v46, (a1 + 64));
  v9 = v46;
  if (v46 != &v47)
  {
    v10 = 0;
    v11 = (a1 + 72);
    while (1)
    {
      v12 = v9[4];
      RTPManager::stackIdForSession(a1, v12, &v41);
      v13 = SHIBYTE(v41.__r_.__value_.__r.__words[2]);
      if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        size = HIBYTE(v41.__r_.__value_.__r.__words[2]);
      }

      else
      {
        size = v41.__r_.__value_.__l.__size_;
      }

      v15 = *(a2 + 23);
      v16 = v15;
      if (v15 < 0)
      {
        v15 = a2[1];
      }

      if (size == v15)
      {
        break;
      }

      v19 = 0;
      if (SHIBYTE(v41.__r_.__value_.__r.__words[2]) < 0)
      {
        goto LABEL_24;
      }

LABEL_25:
      if (v19)
      {
        v20 = *(a1 + 64);
        if (v20 != v11)
        {
          do
          {
            if (v20[5] == v12)
            {
              v21 = std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__remove_node_pointer((a1 + 64), v20);
              operator delete(v20);
            }

            else
            {
              v22 = v20[1];
              if (v22)
              {
                do
                {
                  v21 = v22;
                  v22 = *v22;
                }

                while (v22);
              }

              else
              {
                do
                {
                  v21 = v20[2];
                  v23 = *v21 == v20;
                  v20 = v21;
                }

                while (!v23);
              }
            }

            v20 = v21;
          }

          while (v21 != v11);
        }

        v10 = 1;
      }

      v24 = v9[1];
      if (v24)
      {
        do
        {
          v25 = v24;
          v24 = *v24;
        }

        while (v24);
      }

      else
      {
        do
        {
          v25 = v9[2];
          v23 = *v25 == v9;
          v9 = v25;
        }

        while (!v23);
      }

      v9 = v25;
      if (v25 == &v47)
      {
        goto LABEL_44;
      }
    }

    if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v17 = &v41;
    }

    else
    {
      v17 = v41.__r_.__value_.__r.__words[0];
    }

    if (v16 >= 0)
    {
      v18 = a2;
    }

    else
    {
      v18 = *a2;
    }

    v19 = memcmp(v17, v18, size) == 0;
    if ((v13 & 0x80000000) == 0)
    {
      goto LABEL_25;
    }

LABEL_24:
    operator delete(v41.__r_.__value_.__l.__data_);
    goto LABEL_25;
  }

  v10 = 0;
LABEL_44:
  v26 = *(a1 + 112);
  if (v26)
  {
    RTPManager::stackIdForSession(a1, v26, &v41);
    v27 = SHIBYTE(v41.__r_.__value_.__r.__words[2]);
    if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v28 = HIBYTE(v41.__r_.__value_.__r.__words[2]);
    }

    else
    {
      v28 = v41.__r_.__value_.__l.__size_;
    }

    v29 = *(a2 + 23);
    v30 = v29;
    if (v29 < 0)
    {
      v29 = a2[1];
    }

    if (v28 == v29)
    {
      if ((v41.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v31 = &v41;
      }

      else
      {
        v31 = v41.__r_.__value_.__r.__words[0];
      }

      if (v30 >= 0)
      {
        v32 = a2;
      }

      else
      {
        v32 = *a2;
      }

      v33 = memcmp(v31, v32, v28) == 0;
      if ((v27 & 0x80000000) == 0)
      {
LABEL_61:
        if (v33)
        {
          *(a1 + 112) = 0;
          v10 = 1;
        }

        goto LABEL_63;
      }
    }

    else
    {
      v33 = 0;
      if ((SHIBYTE(v41.__r_.__value_.__r.__words[2]) & 0x80000000) == 0)
      {
        goto LABEL_61;
      }
    }

    operator delete(v41.__r_.__value_.__l.__data_);
    goto LABEL_61;
  }

LABEL_63:
  v34 = *(a1 + 184);
  if (v34 != (a1 + 192))
  {
    do
    {
      v35 = v34[5];
      if (v35)
      {
        (*(*v35 + 32))(v35, a2, 1);
      }

      v36 = v34[1];
      if (v36)
      {
        do
        {
          v37 = v36;
          v36 = *v36;
        }

        while (v36);
      }

      else
      {
        do
        {
          v37 = v34[2];
          v23 = *v37 == v34;
          v34 = v37;
        }

        while (!v23);
      }

      v34 = v37;
    }

    while (v37 != (a1 + 192));
  }

  if (v10)
  {
    (*(**(a1 + 152) + 72))(*(a1 + 152));
    RTPSharedPointerBase::getShared<MediaSessionCollectionIterator>(a1, &v41);
    v38 = *&v41.__r_.__value_.__l.__data_;
    *&v41.__r_.__value_.__l.__data_ = 0uLL;
    v39 = *(a1 + 160);
    *(a1 + 152) = v38;
    if (v39)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v39);
      if (v41.__r_.__value_.__l.__size_)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v41.__r_.__value_.__l.__size_);
      }
    }
  }

  v40 = (*(**(a1 + 152) + 64))(*(a1 + 152));
  if (v40)
  {
    RTPTransportManager::clearAll(v40);
  }

  std::__tree<unsigned int>::destroy(&v46, v47);
}

void RTPManager::stackIdForSession(RTPManager *this@<X0>, uint64_t a2@<X1>, std::string *a3@<X8>)
{
  v10 = 0;
  v11 = 0;
  RTPManager::sdpSessionForSession(this, a2, &v10);
  v4 = v10;
  if (v10)
  {
    v5 = *(v10 + 128);
    if (v5)
    {
      v6 = std::__shared_weak_count::lock(v5);
      if (v6)
      {
        v7 = *(v4 + 120);
      }

      else
      {
        v7 = 0;
      }
    }

    else
    {
      v7 = 0;
      v6 = 0;
    }

    if (*(v7 + 4455) < 0)
    {
      std::string::__init_copy_ctor_external(a3, *(v7 + 4432), *(v7 + 4440));
    }

    else
    {
      v8 = (v7 + 4432);
      v9 = *v8;
      a3->__r_.__value_.__r.__words[2] = *(v8 + 2);
      *&a3->__r_.__value_.__l.__data_ = v9;
    }

    if (v6)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }

  else
  {
    std::string::basic_string[abi:ne200100]<0>(a3, &str_2_23);
  }

  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }
}

void sub_1E5127648(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (v10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v10);
  }

  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::createSession(void *a1@<X0>, void *a2@<X1>, unint64_t a3@<X2>, uint64_t a4@<X3>, std::__shared_weak_count ***a5@<X6>, unsigned int a6@<W7>, uint64_t a7@<X8>, unsigned __int8 a8, char a9, uint64_t a10, uint64_t a11, uint64_t a12)
{
  v93 = a3;
  std::string::basic_string[abi:ne200100]<0>(v78, "rtp.mgr");
  v89[0] = 0;
  v92 = 0;
  v18 = ims::debug(v78, v89);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v19 = v18;
  v20 = *(*(*a1 - 8) + 8);
  v21 = *(v18 + 8);
  v22 = strlen((v20 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v21, v20 & 0x7FFFFFFFFFFFFFFFLL, v22);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "::", 2);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "createSession", 13);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " [stackId=", 10);
  *(v19 + 17) = 0;
  (*(*v19 + 32))(v19, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " appId=", 7);
  *(v19 + 17) = 0;
  MEMORY[0x1E6923340](*(v19 + 8), a4);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " sessionId=", 11);
  *(v19 + 17) = 0;
  MEMORY[0x1E69233B0](*(v19 + 8), a3);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " isRelayCall=", 13);
  *(v19 + 17) = 0;
  MEMORY[0x1E6923320](*(v19 + 8), a8);
  *(v19 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "]", 1);
  *(v19 + 17) = 0;
  (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v19 + 17) = 0;
  if (v92 == 1 && v91 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v79) < 0)
  {
    operator delete(v78[0]);
  }

  v23 = a5[1];
  if (v23)
  {
    v24 = std::__shared_weak_count::lock(v23);
    if (v24)
    {
      v25 = *a5;
      if (*a5)
      {
        if (a8)
        {
          std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>((a1 + 26), a3);
        }

        if (a9)
        {
          std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>((a1 + 32), a3);
        }

        v79 = 0;
        v80 = 0;
        v82 = 0u;
        v83 = 0u;
        v84 = 0u;
        v78[0] = &unk_1F5EBDEF8;
        v78[1] = &_bambiDomain;
        v81 = 0;
        v67 = a2;
        v26 = *(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>((a1 + 35), a2) + 56);
        v77 = v26;
        if (v26 == 2)
        {
          std::string::basic_string[abi:ne200100]<0>(&v67, "rtp.mgr");
          v73[0] = 0;
          v76 = 0;
          v27 = ims::debug(&v67, v73);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "Update appId (if appropriate) to : ", 35);
          *(v27 + 17) = 0;
          MEMORY[0x1E6923340](*(v27 + 8), a4);
          *(v27 + 17) = 0;
          (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v27 + 17) = 0;
          if (v76 == 1 && v75 < 0)
          {
            operator delete(v74);
          }

          if (SHIBYTE(v68) < 0)
          {
            operator delete(v67);
          }

          v67 = &v77;
          v28 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType const&>,std::tuple<>>((a1 + 23), &v77);
          (*(*v28[5] + 64))(v28[5], a2, a4);
          v26 = v77;
        }

        RTPSharedPointerBase::getShared<MediaSessionDelegate>(a1, &v71);
        v29 = v71;
        v30 = v72;
        if (v72)
        {
          atomic_fetch_add_explicit(&v72->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        }

        atomic_fetch_add_explicit(&v24->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v107[0] = v26;
        v31 = std::string::basic_string[abi:ne200100]<0>(&v101, "rtp.mgr");
        v65 = v29;
        LOBYTE(v67) = 0;
        v70 = 0;
        v32 = ims::debug(v31, &v67);
        v33 = *(*(*a1 - 8) + 8);
        v34 = strlen((v33 & 0x7FFFFFFFFFFFFFFFLL));
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), v33 & 0x7FFFFFFFFFFFFFFFLL, v34);
        *(v32 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "::", 2);
        *(v32 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "createSessionOnStack", 20);
        *(v32 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), " [sessionId=", 12);
        *(v32 + 17) = 0;
        MEMORY[0x1E69233B0](*(v32 + 8), a3);
        *(v32 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "]", 1);
        *(v32 + 17) = 0;
        (*(*v32 + 64))(v32, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v32 + 17) = 0;
        if (v70 == 1 && v69 < 0)
        {
          operator delete(v68);
        }

        if (SHIBYTE(v103) < 0)
        {
          operator delete(v101);
        }

        v35 = std::__shared_weak_count::lock(v24);
        if (!v35)
        {
          v40 = std::string::basic_string[abi:ne200100]<0>(&v106, "rtp.mgr");
          LOBYTE(v101) = 0;
          v105 = 0;
          v41 = ims::error(v40, &v101);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v41 + 8), "SDPSession expired in RTPManager::createSessionOnStack", 54);
          *(v41 + 17) = 0;
          (*(*v41 + 64))(v41, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v41 + 17) = 0;
          if (v105 == 1 && v104 < 0)
          {
            operator delete(v103);
          }

          if (SHIBYTE(v106.__r_.__value_.__r.__words[2]) < 0)
          {
            operator delete(v106.__r_.__value_.__l.__data_);
          }

          v42 = 0;
          v43 = 0;
          goto LABEL_87;
        }

        v36 = v35;
        v37 = v25[16];
        if (v37)
        {
          v37 = std::__shared_weak_count::lock(v37);
          v38 = v37;
          if (v37)
          {
            v37 = v25[15];
          }
        }

        else
        {
          v38 = 0;
        }

        v44 = SipStack::prefs(v37);
        v45 = ImsPrefs::EnableAPOnlyMode(v44);
        if (v38)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v38);
        }

        memset(&v106, 0, sizeof(v106));
        v46 = v25[16];
        if (v46)
        {
          v47 = std::__shared_weak_count::lock(v46);
          if (v47)
          {
            v48 = v25[15];
          }

          else
          {
            v48 = 0;
          }
        }

        else
        {
          v48 = 0;
          v47 = 0;
        }

        if (SHIBYTE(v48[185].__shared_owners_) < 0)
        {
          std::string::__init_copy_ctor_external(&v106, v48[184].__shared_weak_owners_, v48[185].__vftable);
        }

        else
        {
          v106 = *(v48 + 4432);
        }

        if (v47)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v47);
        }

        v101 = v107;
        v49 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType const&>,std::tuple<>>((a1 + 23), v107);
        v51 = v49[5];
        v50 = v49[6];
        if (v50)
        {
          atomic_fetch_add_explicit(&v50->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        if (v45)
        {
          LODWORD(v97) = 1;
          v101 = &v97;
          v52 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType&&>,std::tuple<>>((a1 + 23), 1);
          v51 = v52[5];
          v53 = v52[6];
          if (v53)
          {
            atomic_fetch_add_explicit(&v53->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          if (v50)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v50);
          }

          v50 = v53;
        }

        if (a6 == 2)
        {
          v97 = v65;
          v98 = v30;
          if (v30)
          {
            atomic_fetch_add_explicit(&v30->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          }

          v94 = v25;
          v95 = v36;
          atomic_fetch_add_explicit(&v36->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          (*(*v51 + 48))(&v101, v51, &v97, a3, &v94, 2, &v106, a12);
        }

        else
        {
          if (a6 != 4)
          {
            v63 = std::string::basic_string[abi:ne200100]<0>(&v97, "rtp.mgr");
            LOBYTE(v101) = 0;
            v105 = 0;
            v64 = ims::error(v63, &v101);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), "Unable to create session for media type ", 40);
            *(v64 + 17) = 0;
            (*(*v64 + 32))(v64, &v94);
            (*(*v64 + 64))(v64, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v64 + 17) = 0;
            if (v96 < 0)
            {
              operator delete(v94);
            }

            if (v105 == 1 && v104 < 0)
            {
              operator delete(v103);
            }

            if (v99 < 0)
            {
              operator delete(v97);
            }

            v42 = 0;
            v43 = 0;
            if (!v50)
            {
              goto LABEL_84;
            }

LABEL_83:
            std::__shared_weak_count::__release_shared[abi:ne200100](v50);
LABEL_84:
            if (SHIBYTE(v106.__r_.__value_.__r.__words[2]) < 0)
            {
              operator delete(v106.__r_.__value_.__l.__data_);
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v36);
LABEL_87:
            std::__shared_weak_count::__release_weak(v24);
            if (v30)
            {
              std::__shared_weak_count::__release_weak(v30);
            }

            if (v72)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v72);
            }

            if (v43)
            {
              LODWORD(v102) = 0;
              v101 = 0;
              v55 = std::__shared_weak_count::lock(v25[16]);
              v56 = v25[15];
              shared_weak_owners = v56[11].__shared_weak_owners_;
              v58 = v56[12].__vftable;
              if (v58)
              {
                atomic_fetch_add_explicit(&v58->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              (*(*shared_weak_owners + 144))(&v101);
              if (v58)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v58);
              }

              std::__shared_weak_count::__release_shared[abi:ne200100](v55);
              v59 = v25[16];
              if (v59)
              {
                v59 = std::__shared_weak_count::lock(v59);
                v60 = v59;
                if (v59)
                {
                  v59 = v25[15];
                }
              }

              else
              {
                v60 = 0;
              }

              v61 = SipStack::prefs(v59);
              if (ImsPrefs::EnableAPOnlyMode(v61))
              {
                v62 = _os_feature_enabled_impl();
                if (v60)
                {
                  std::__shared_weak_count::__release_shared[abi:ne200100](v60);
                }

                if (v62)
                {
                  SDPSession::localSdp(v25);
                }
              }

              else if (v60)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v60);
              }

              SDPSession::localSdp(v25);
            }

            *(a7 + 24) = 0u;
            *(a7 + 40) = 0u;
            *(a7 + 56) = 0u;
            *(a7 + 72) = 0u;
            *a7 = &unk_1F5EBDEF8;
            *(a7 + 8) = &_bambiDomain;
            *(a7 + 16) = 1073741825;
            if (v42)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v42);
            }

            ImsResult::~ImsResult(v78);
LABEL_121:
            std::__shared_weak_count::__release_shared[abi:ne200100](v24);
            return;
          }

          v100 = 1;
          v97 = &v100;
          v54 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType&&>,std::tuple<>>((a1 + 23), 1)[5];
          v97 = v65;
          v98 = v30;
          if (v30)
          {
            atomic_fetch_add_explicit(&v30->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          }

          v94 = v25;
          v95 = v36;
          atomic_fetch_add_explicit(&v36->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          (*(*v54 + 48))(&v101);
        }

        v42 = v102;
        if (v101)
        {
          v43 = (v101 + 2);
        }

        else
        {
          v43 = 0;
        }

        v101 = 0;
        v102 = 0;
        if (v95)
        {
          std::__shared_weak_count::__release_weak(v95);
        }

        if (v98)
        {
          std::__shared_weak_count::__release_weak(v98);
        }

        if (!v50)
        {
          goto LABEL_84;
        }

        goto LABEL_83;
      }
    }
  }

  else
  {
    v24 = 0;
  }

  std::string::basic_string[abi:ne200100]<0>(v78, "rtp.mgr");
  v85[0] = 0;
  v88 = 0;
  v39 = ims::error(v78, v85);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v39 + 8), "SDPSession expired in RTPManager::createSession", 47);
  *(v39 + 17) = 0;
  (*(*v39 + 64))(v39, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v39 + 17) = 0;
  if (v88 == 1 && v87 < 0)
  {
    operator delete(v86);
  }

  if (SHIBYTE(v79) < 0)
  {
    operator delete(v78[0]);
  }

  *(a7 + 24) = 0u;
  *(a7 + 40) = 0u;
  *(a7 + 56) = 0u;
  *(a7 + 72) = 0u;
  *a7 = &unk_1F5EBDEF8;
  *(a7 + 8) = &_bambiDomain;
  *(a7 + 16) = 1073741825;
  if (v24)
  {
    goto LABEL_121;
  }
}

void sub_1E5128714(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, void *a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, std::__shared_weak_count *a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, std::__shared_weak_count *a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, void *__p, uint64_t a43, uint64_t a44, uint64_t a45, uint64_t a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, uint64_t a51, uint64_t a52, uint64_t a53, uint64_t a54, uint64_t a55, uint64_t a56, void *a57, uint64_t a58, uint64_t a59, uint64_t a60, uint64_t a61, uint64_t a62, void *a63)
{
  if (v64)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v64);
  }

  ImsResult::~ImsResult(&a63);
  std::__shared_weak_count::__release_shared[abi:ne200100](v63);
  _Unwind_Resume(a1);
}

uint64_t RTPManager::sessionMobileOriginated(RTPManager *this, uint64_t a2)
{
  v3 = *(this + 7);
  if (!v3)
  {
    return 0;
  }

  v5 = std::__shared_weak_count::lock(v3);
  if (!v5)
  {
    return 0;
  }

  v6 = v5;
  v7 = *(this + 6);
  if (v7)
  {
    v8 = (*(*v7 + 144))(v7, a2);
  }

  else
  {
    v8 = 0;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  return v8;
}

void RTPManager::awdCallIdForSession(RTPManager *this@<X0>, uint64_t a2@<X1>, _BYTE *a3@<X8>)
{
  v5 = *(this + 7);
  if (v5)
  {
    v7 = std::__shared_weak_count::lock(v5);
    if (v7)
    {
      v8 = v7;
      v9 = *(this + 6);
      if (v9)
      {
        (*(*v9 + 104))(v9, a2);

        std::__shared_weak_count::__release_shared[abi:ne200100](v8);
        return;
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }

  std::string::basic_string[abi:ne200100]<0>(a3, &str_2_23);
}

void RTPManager::activateSessionWithId(uint64_t a1, uint64_t a2, unsigned int a3, int a4)
{
  v56 = a3;
  v7 = std::string::basic_string[abi:ne200100]<0>(v54, "rtp.mgr");
  v50[0] = 0;
  v53 = 0;
  v8 = ims::debug(v7, v50);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v9 = v8;
  v10 = *(*(*a1 - 8) + 8);
  v11 = *(v8 + 8);
  v12 = strlen((v10 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, v10 & 0x7FFFFFFFFFFFFFFFLL, v12);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "::", 2);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "activateSessionWithId", 21);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), " [sessionId=", 12);
  *(v9 + 17) = 0;
  MEMORY[0x1E69233B0](*(v9 + 8), a2);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), " direction=", 11);
  *(v9 + 17) = 0;
  ims::toString<MediaDirection>(&v56, &v48);
  LoggableString::LoggableString(&v49, &v48);
  (*(*v9 + 40))(v9, &v49);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "]", 1);
  *(v9 + 17) = 0;
  (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v9 + 17) = 0;
  if (SHIBYTE(v49.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v49.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v48.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v48.__r_.__value_.__l.__data_);
  }

  if (v53 == 1 && v52 < 0)
  {
    operator delete(v51);
  }

  if ((v55 & 0x80000000) == 0)
  {
    if (!a4)
    {
      goto LABEL_12;
    }

    goto LABEL_11;
  }

  operator delete(v54[0]);
  if (a4)
  {
LABEL_11:
    (*(*a1 + 48))(a1, a2);
  }

LABEL_12:
  *&v49.__r_.__value_.__l.__data_ = 0uLL;
  (*(**(a1 + 152) + 24))(&v49);
  if (v49.__r_.__value_.__r.__words[0])
  {
    v13 = (*(*v49.__r_.__value_.__l.__data_ + 104))(v49.__r_.__value_.__r.__words[0]);
    v14 = *(a1 + 72);
    if (v14)
    {
      v15 = a1 + 72;
      do
      {
        if (*(v14 + 32) >= v13)
        {
          v15 = v14;
        }

        v14 = *(v14 + 8 * (*(v14 + 32) < v13));
      }

      while (v14);
      if (v15 != a1 + 72 && *(v15 + 32) <= v13)
      {
        v16 = *(v15 + 40);
        if (v16 && v16 != a2)
        {
          v18 = std::string::basic_string[abi:ne200100]<0>(v54, "rtp.mgr");
          v40[0] = 0;
          v43 = 0;
          v19 = ims::debug(v18, v40);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "Deactivating active session ", 28);
          *(v19 + 17) = 0;
          MEMORY[0x1E69233B0](*(v19 + 8), v16);
          *(v19 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), " before activating session ", 27);
          *(v19 + 17) = 0;
          MEMORY[0x1E69233B0](*(v19 + 8), a2);
          *(v19 + 17) = 0;
          (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v19 + 17) = 0;
          if (v43 == 1 && v42 < 0)
          {
            operator delete(__p);
          }

          if (v55 < 0)
          {
            operator delete(v54[0]);
          }

          RTPManager::deactivateSessionWithId(a1, v16, 4u);
        }
      }
    }

    (*(*v49.__r_.__value_.__l.__data_ + 48))(v49.__r_.__value_.__r.__words[0], &v56, 0);
    v20 = std::string::basic_string[abi:ne200100]<0>(v54, "rtp.mgr");
    v36[0] = 0;
    v39 = 0;
    v21 = ims::debug(v20, v36);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), "Automatically reconfiguring session if required: ", 49);
    *(v21 + 17) = 0;
    MEMORY[0x1E69233B0](*(v21 + 8), a2);
    *(v21 + 17) = 0;
    (*(*v21 + 64))(v21, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v21 + 17) = 0;
    if (v39 == 1 && v38 < 0)
    {
      operator delete(v37);
    }

    if (v55 < 0)
    {
      operator delete(v54[0]);
    }

    v22 = v49.__r_.__value_.__r.__words[0];
    if (*(v49.__r_.__value_.__r.__words[0] + 81) == 1)
    {
      *(v49.__r_.__value_.__r.__words[0] + 81) = 0;
      (*(*v22 + 64))(v22, 0);
      v22 = v49.__r_.__value_.__r.__words[0];
    }

    (*(*v22 + 32))(v22, 0);
    v23 = std::string::basic_string[abi:ne200100]<0>(v54, "rtp.mgr");
    v32[0] = 0;
    v35 = 0;
    v24 = ims::debug(v23, v32);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v24 + 8), "Activating session ", 19);
    *(v24 + 17) = 0;
    MEMORY[0x1E69233B0](*(v24 + 8), a2);
    *(v24 + 17) = 0;
    (*(*v24 + 64))(v24, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v24 + 17) = 0;
    if (v35 == 1 && v34 < 0)
    {
      operator delete(v33);
    }

    if (v55 < 0)
    {
      operator delete(v54[0]);
    }

    v25 = (*(*v49.__r_.__value_.__l.__data_ + 104))(v49.__r_.__value_.__r.__words[0]);
    RTPActiveSessionSet::setActive(a1 + 64, a2, v25);
  }

  else
  {
    v26 = std::string::basic_string[abi:ne200100]<0>(v54, "rtp.mgr");
    v44[0] = 0;
    v47 = 0;
    v27 = ims::error(v26, v44);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "Couldn't find session for id: ", 30);
    *(v27 + 17) = 0;
    MEMORY[0x1E69233B0](*(v27 + 8), a2);
    *(v27 + 17) = 0;
    (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v27 + 17) = 0;
    if (v47 == 1 && v46 < 0)
    {
      operator delete(v45);
    }

    if (v55 < 0)
    {
      operator delete(v54[0]);
    }

    v28 = *(a1 + 56);
    if (v28)
    {
      v29 = std::__shared_weak_count::lock(v28);
      if (v29)
      {
        v30 = v29;
        v31 = *(a1 + 48);
        if (v31)
        {
          (*(*v31 + 24))(v31, a2, 9);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v30);
      }
    }
  }

  if (v49.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v49.__r_.__value_.__l.__size_);
  }
}

void sub_1E5129328(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, uint64_t a30, uint64_t a31, void *__p, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, char a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, int a44, __int16 a45, char a46, char a47, uint64_t a48, char a49)
{
  v51 = *(v49 - 168);
  if (v51)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v51);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::deactivateSessionWithId(uint64_t a1, uint64_t a2, unsigned int a3)
{
  v42 = a3;
  v5 = std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
  v36[0] = 0;
  v39 = 0;
  v6 = ims::debug(v5, v36);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v7 = v6;
  v8 = *(*(*a1 - 8) + 8);
  v9 = *(v6 + 8);
  v10 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v8 & 0x7FFFFFFFFFFFFFFFLL, v10);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "deactivateSessionWithId", 23);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [sessionId=", 12);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " direction=", 11);
  *(v7 + 17) = 0;
  ims::toString<MediaDirection>(&v42, &__p);
  LoggableString::LoggableString(&v35, &__p);
  (*(*v7 + 40))(v7, &v35);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (SHIBYTE(v35.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v35.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v39 == 1 && v38 < 0)
  {
    operator delete(v37);
  }

  if (v41 < 0)
  {
    operator delete(v40[0]);
  }

  *&v35.__r_.__value_.__l.__data_ = 0uLL;
  (*(**(a1 + 152) + 24))(&v35);
  if (v35.__r_.__value_.__r.__words[0])
  {
    v11 = (*(*v35.__r_.__value_.__l.__data_ + 104))(v35.__r_.__value_.__r.__words[0]);
    v12 = *(a1 + 72);
    if (!v12)
    {
      goto LABEL_19;
    }

    v13 = a1 + 72;
    do
    {
      if (*(v12 + 32) >= v11)
      {
        v13 = v12;
      }

      v12 = *(v12 + 8 * (*(v12 + 32) < v11));
    }

    while (v12);
    if (v13 != a1 + 72 && *(v13 + 32) <= v11)
    {
      v14 = *(v13 + 40);
    }

    else
    {
LABEL_19:
      v14 = 0;
    }

    v15 = std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
    v26[0] = 0;
    v29 = 0;
    v16 = ims::debug(v15, v26);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "Deactivating session ", 21);
    *(v16 + 17) = 0;
    MEMORY[0x1E69233B0](*(v16 + 8), a2);
    *(v16 + 17) = 0;
    (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v16 + 17) = 0;
    if (v29 == 1 && v28 < 0)
    {
      operator delete(v27);
    }

    if (v41 < 0)
    {
      operator delete(v40[0]);
    }

    (*(*v35.__r_.__value_.__l.__data_ + 48))(v35.__r_.__value_.__r.__words[0], &v42, 0);
    if (v42 == 4 && v14 == a2)
    {
      v17 = std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
      v22[0] = 0;
      v25 = 0;
      v18 = ims::debug(v17, v22);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "Deactivating session ", 21);
      *(v18 + 17) = 0;
      MEMORY[0x1E69233B0](*(v18 + 8), a2);
      *(v18 + 17) = 0;
      (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v18 + 17) = 0;
      if (v25 == 1 && v24 < 0)
      {
        operator delete(v23);
      }

      if (v41 < 0)
      {
        operator delete(v40[0]);
      }

      v19 = (*(*v35.__r_.__value_.__l.__data_ + 104))(v35.__r_.__value_.__r.__words[0]);
      RTPActiveSessionSet::setActive(a1 + 64, 0, v19);
    }
  }

  else
  {
    v20 = std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
    v30[0] = 0;
    v33 = 0;
    v21 = ims::error(v20, v30);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), "RTPManager::deactivateSessionWithId could not find session id: ", 63);
    *(v21 + 17) = 0;
    MEMORY[0x1E69233B0](*(v21 + 8), a2);
    *(v21 + 17) = 0;
    (*(*v21 + 64))(v21, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v21 + 17) = 0;
    if (v33 == 1 && v32 < 0)
    {
      operator delete(v31);
    }

    if (v41 < 0)
    {
      operator delete(v40[0]);
    }
  }

  if (v35.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v35.__r_.__value_.__l.__size_);
  }
}

void sub_1E51299A8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, int a33, __int16 a34, char a35, char a36, uint64_t a37, char a38, void *__p, uint64_t a40, int a41, __int16 a42, char a43, char a44)
{
  v46 = *(v44 - 152);
  if (v46)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v46);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::reconfigureSession(uint64_t a1, uint64_t a2, void ***a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v93, "rtp.mgr");
  v83[0] = 0;
  v86 = 0;
  v7 = ims::debug(v6, v83);
  v8 = *(*(*a1 - 8) + 8);
  v9 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), v8 & 0x7FFFFFFFFFFFFFFFLL, v9);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "reconfigureSession", 18);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [sessionId=", 12);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " session=", 9);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923310](*(v7 + 8), *a3);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v86 == 1 && v85 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v94) < 0)
  {
    operator delete(v93[0]);
  }

  v10 = *a3;
  if (*a3)
  {
    v11 = a3[1];
    if (v11)
    {
      atomic_fetch_add_explicit(&v11->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    v68 = v11;
    v12 = (*(*v10 + 13))(v10);
    v13 = *(a1 + 72);
    if (!v13)
    {
      goto LABEL_18;
    }

    v14 = a1 + 72;
    do
    {
      if (*(v13 + 32) >= v12)
      {
        v14 = v13;
      }

      v13 = *(v13 + 8 * (*(v13 + 32) < v12));
    }

    while (v13);
    if (v14 != a1 + 72 && *(v14 + 32) <= v12 && (v15 = *(v14 + 40)) != 0)
    {
      v70 = 0;
    }

    else
    {
LABEL_18:
      v16 = (*(*v10 + 13))(v10);
      v17 = *(a1 + 96);
      if (!v17)
      {
        goto LABEL_25;
      }

      v18 = a1 + 96;
      do
      {
        if (*(v17 + 32) >= v16)
        {
          v18 = v17;
        }

        v17 = *(v17 + 8 * (*(v17 + 32) < v16));
      }

      while (v17);
      if (v18 != a1 + 96 && *(v18 + 32) <= v16)
      {
        v19 = *(v18 + 40);
      }

      else
      {
LABEL_25:
        v19 = 0;
      }

      v15 = 0;
      v70 = v19 != a2;
    }

    if (*(a1 + 308) != 1)
    {
      goto LABEL_38;
    }

    if (TelephonyRadiosGetRadioVendor() == 1)
    {
      goto LABEL_38;
    }

    v93[0] = v10 + 7;
    if (*(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, v10 + 7) + 56) != 2)
    {
      goto LABEL_38;
    }

    v20 = std::string::basic_string[abi:ne200100]<0>(&v87, "rtp.mgr");
    LOBYTE(v93[0]) = 0;
    v96 = 0;
    v21 = ims::debug(v20, v93);
    v22 = *(*(*a1 - 8) + 8);
    v23 = strlen((v22 & 0x7FFFFFFFFFFFFFFFLL));
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), v22 & 0x7FFFFFFFFFFFFFFFLL, v23);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), "::", 2);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), "canReconfigureSession", 21);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), " [sessionId=", 12);
    *(v21 + 17) = 0;
    MEMORY[0x1E69233B0](*(v21 + 8), a2);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), " notRecentlyDeactivated=", 24);
    *(v21 + 17) = 0;
    MEMORY[0x1E6923320](*(v21 + 8), v70);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), " isActive=", 10);
    *(v21 + 17) = 0;
    MEMORY[0x1E6923320](*(v21 + 8), v15 == a2);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), " _basebandType=kRTPStackQMI", 27);
    *(v21 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), " _activeStackType=kRTPStackTypeBaseband]", 40);
    *(v21 + 17) = 0;
    (*(*v21 + 64))(v21, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v21 + 17) = 0;
    if (v96 == 1 && v95 < 0)
    {
      operator delete(v94);
    }

    v24 = v68;
    if (SBYTE7(v88) < 0)
    {
      operator delete(v87);
    }

    v25 = v70;
    if (v15 == a2)
    {
      v25 = 1;
    }

    if ((v25 & 1) == 0)
    {
      v56 = 0;
      v52 = (a1 + 72);
      if (!v68)
      {
LABEL_104:
        if (v56)
        {
          v57 = std::string::basic_string[abi:ne200100]<0>(v93, "rtp.mgr");
          v75[0] = 0;
          v78 = 0;
          v58 = ims::debug(v57, v75);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v58 + 8), "Reconfiguring session ", 22);
          *(v58 + 17) = 0;
          MEMORY[0x1E69233B0](*(v58 + 8), a2);
          *(v58 + 17) = 0;
          (*(*v58 + 64))(v58, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v58 + 17) = 0;
          if (v78 == 1 && v77 < 0)
          {
            operator delete(v76);
          }

          if (SHIBYTE(v94) < 0)
          {
            operator delete(v93[0]);
          }

          (*(**a3 + 8))(*a3, 0);
        }

        else
        {
          v59 = std::string::basic_string[abi:ne200100]<0>(v93, "rtp.mgr");
          v71[0] = 0;
          v74 = 0;
          v60 = ims::warn(v59, v71);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v60 + 8), "Unable to configure session ", 28);
          *(v60 + 17) = 0;
          MEMORY[0x1E69233B0](*(v60 + 8), a2);
          *(v60 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v60 + 8), " while session ", 15);
          *(v60 + 17) = 0;
          v61 = (*(**a3 + 13))();
          v62 = *v52;
          if (!*v52)
          {
            goto LABEL_118;
          }

          v63 = v52;
          do
          {
            if (*(v62 + 32) >= v61)
            {
              v63 = v62;
            }

            v62 = *(v62 + 8 * (*(v62 + 32) < v61));
          }

          while (v62);
          if (v63 != v52 && *(v63 + 8) <= v61)
          {
            v64 = v63[5];
          }

          else
          {
LABEL_118:
            v64 = 0;
          }

          MEMORY[0x1E69233B0](*(v60 + 8), v64);
          *(v60 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v60 + 8), " is the active session", 22);
          *(v60 + 17) = 0;
          (*(*v60 + 64))(v60, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v60 + 17) = 0;
          if (v74 == 1 && v73 < 0)
          {
            operator delete(v72);
          }

          if (SHIBYTE(v94) < 0)
          {
            operator delete(v93[0]);
          }

          *(*a3 + 81) = 1;
        }

        return;
      }
    }

    else
    {
LABEL_38:
      v69 = (*(**(a1 + 152) + 56))(*(a1 + 152));
      *&v87 = v10 + 7;
      v26 = std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, v10 + 7);
      v65 = v15;
      v66 = a2;
      v67 = a3;
      v27 = *(a1 + 280);
      if (v27 == (a1 + 288))
      {
        v29 = 1;
      }

      else
      {
        v28 = *(v26 + 56);
        LODWORD(v29) = 1;
        while (1)
        {
          v87 = 0u;
          v88 = 0u;
          if (*(v27 + 55) < 0)
          {
            std::string::__init_copy_ctor_external(&v87, v27[4], v27[5]);
          }

          else
          {
            v87 = *(v27 + 2);
            *&v88 = v27[6];
          }

          v30 = *(v27 + 14);
          DWORD2(v88) = v30;
          v31 = SBYTE7(v88);
          if ((SBYTE7(v88) & 0x80u) == 0)
          {
            v32 = BYTE7(v88);
          }

          else
          {
            v32 = *(&v87 + 1);
          }

          v33 = *(v10 + 79);
          v34 = v33;
          if (v33 < 0)
          {
            v33 = v10[8];
          }

          if (v32 == v33)
          {
            if ((SBYTE7(v88) & 0x80u) == 0)
            {
              v35 = &v87;
            }

            else
            {
              v35 = v87;
            }

            if (v34 >= 0)
            {
              v36 = v10 + 7;
            }

            else
            {
              v36 = v10[7];
            }

            v37 = memcmp(v35, v36, v32) == 0;
          }

          else
          {
            v37 = 0;
          }

          v38 = v30 == v28 || v37;
          if (v31 < 0)
          {
            operator delete(v87);
          }

          if (!v38)
          {
            break;
          }

          v39 = v27[1];
          if (v39)
          {
            do
            {
              v40 = v39;
              v39 = *v39;
            }

            while (v39);
          }

          else
          {
            do
            {
              v40 = v27[2];
              v53 = *v40 == v27;
              v27 = v40;
            }

            while (!v53);
          }

          v29 = v38 & v29;
          v27 = v40;
          if (v40 == (a1 + 288))
          {
            goto LABEL_77;
          }
        }

        v29 = 0;
      }

LABEL_77:
      v43 = **v10;
      if (v44)
      {
        v45 = v44;
        a2 = v66;
        a3 = v67;
        v24 = v68;
        v46 = v15;
        if (v68)
        {
          atomic_fetch_add_explicit(&v68->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        if (v44[285] == 1 && v44[286] == 1 && (*(*v44 + 144))(v44) == 2)
        {
          v47 = v45[293];
        }

        else
        {
          v47 = 1;
        }

        if (v68)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v68);
        }
      }

      else
      {
        v47 = 1;
        a2 = v66;
        a3 = v67;
        v24 = v68;
        v46 = v65;
      }

      v48 = std::string::basic_string[abi:ne200100]<0>(&v91, "rtp.mgr");
      LOBYTE(v87) = 0;
      v90 = 0;
      v49 = ims::debug(v48, &v87);
      v50 = *(*(*a1 - 8) + 8);
      v51 = strlen((v50 & 0x7FFFFFFFFFFFFFFFLL));
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), v50 & 0x7FFFFFFFFFFFFFFFLL, v51);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), "::", 2);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), "canReconfigureSession", 21);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " [sessionId=", 12);
      *(v49 + 17) = 0;
      MEMORY[0x1E69233B0](*(v49 + 8), a2);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " session=", 9);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923310](*(v49 + 8), v10);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " notRecentlyDeactivated=", 24);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923320](*(v49 + 8), v70);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " isActive=", 10);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923320](*(v49 + 8), v46 == a2);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " onlySession=", 13);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923320](*(v49 + 8), v69 == 1);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " onlyStack=", 11);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923320](*(v49 + 8), v29);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), " isAutoStartConfigurable=", 25);
      *(v49 + 17) = 0;
      MEMORY[0x1E6923320](*(v49 + 8), v47 & 1);
      *(v49 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v49 + 8), "]", 1);
      *(v49 + 17) = 0;
      (*(*v49 + 64))(v49, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v49 + 17) = 0;
      if (v90 == 1 && v89 < 0)
      {
        operator delete(v88);
      }

      v52 = (a1 + 72);
      if (v92 < 0)
      {
        operator delete(v91);
      }

      v53 = v46 == a2 || v69 == 1;
      v54 = v53;
      v55 = v54 | v29;
      if (v70 || (v47 & 1) == 0)
      {
        v56 = v47;
      }

      else
      {
        v56 = v55;
      }

      if (!v24)
      {
        goto LABEL_104;
      }
    }

    std::__shared_weak_count::__release_shared[abi:ne200100](v24);
    goto LABEL_104;
  }

  v41 = std::string::basic_string[abi:ne200100]<0>(v93, "rtp.mgr");
  v79[0] = 0;
  v82 = 0;
  v42 = ims::error(v41, v79);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v42 + 8), "Session is nil! This should never happen.", 41);
  *(v42 + 17) = 0;
  if (v82 == 1 && v81 < 0)
  {
    operator delete(v80);
  }

  if (SHIBYTE(v94) < 0)
  {
    operator delete(v93[0]);
  }
}

void sub_1E512A6B8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, int a21, __int16 a22, char a23, char a24, uint64_t a25, char a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, char a36, uint64_t a37, uint64_t a38, void *__p, uint64_t a40, int a41, __int16 a42, char a43, char a44, uint64_t a45, char a46, uint64_t a47, uint64_t a48, uint64_t a49, uint64_t a50, int a51, __int16 a52, char a53, char a54, uint64_t a55, char a56)
{
  if (v56)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::updateSdpForSession(uint64_t a1, uint64_t a2, uint64_t *a3, unsigned int a4)
{
  v56 = a4;
  std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
  v52[0] = 0;
  v55 = 0;
  v7 = ims::debug(v40, v52);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "updateSdpForSession", 19);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [sessionId=", 12);
  *(v8 + 17) = 0;
  MEMORY[0x1E69233B0](*(v8 + 8), a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " direction=", 11);
  *(v8 + 17) = 0;
  ims::toString<MediaDirection>(&v56, &v51);
  LoggableString::LoggableString(&__p, &v51);
  (*(*v8 + 40))(v8, &__p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v51.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v51.__r_.__value_.__l.__data_);
  }

  if (v55 == 1 && v54 < 0)
  {
    operator delete(v53);
  }

  if (v42 < 0)
  {
    operator delete(v40[0]);
  }

  *&v51.__r_.__value_.__l.__data_ = 0uLL;
  (*(**(a1 + 152) + 24))(&v51);
  if (v51.__r_.__value_.__r.__words[0])
  {
    std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
    v43[0] = 0;
    v46 = 0;
    v12 = ims::debug(v40, v43);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "Updating SDP for session ", 25);
    *(v12 + 17) = 0;
    MEMORY[0x1E69233B0](*(v12 + 8), a2);
    *(v12 + 17) = 0;
    (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v12 + 17) = 0;
    if (v46 == 1 && v45 < 0)
    {
      operator delete(v44);
    }

    if (v42 < 0)
    {
      operator delete(v40[0]);
    }

    (*(*v51.__r_.__value_.__l.__data_ + 48))(v51.__r_.__value_.__r.__words[0], &v56, 0);
    v13 = v51.__r_.__value_.__r.__words[0];
    v14 = a3[1];
    v38 = *a3;
    v39 = v14;
    if (v14)
    {
      atomic_fetch_add_explicit(&v14->__shared_weak_owners_, 1uLL, memory_order_relaxed);
    }

    (*(*v13 + 56))(v40);
    v34 = 0u;
    v35 = 0u;
    v36 = 0u;
    v37 = 0u;
    __p.__r_.__value_.__r.__words[0] = &unk_1F5EBDEF8;
    __p.__r_.__value_.__l.__size_ = &_bambiDomain;
    LODWORD(__p.__r_.__value_.__r.__words[2]) = 0;
    v16 = v40[1] == &_bambiDomain && v41 == 0;
    ImsResult::~ImsResult(&__p);
    ImsResult::~ImsResult(v40);
    if (v39)
    {
      std::__shared_weak_count::__release_weak(v39);
    }

    if (v16)
    {
      std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
      v29[0] = 0;
      v32 = 0;
      v17 = ims::debug(v40, v29);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "Valid configuration given for session ", 38);
      *(v17 + 17) = 0;
      MEMORY[0x1E69233B0](*(v17 + 8), a2);
      *(v17 + 17) = 0;
      (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v17 + 17) = 0;
      if (v32 == 1 && v31 < 0)
      {
        operator delete(v30);
      }

      if (v42 < 0)
      {
        operator delete(v40[0]);
      }

      size = v51.__r_.__value_.__l.__size_;
      v28 = *&v51.__r_.__value_.__l.__data_;
      if (v51.__r_.__value_.__l.__size_)
      {
        atomic_fetch_add_explicit((v51.__r_.__value_.__l.__size_ + 8), 1uLL, memory_order_relaxed);
      }

      RTPManager::reconfigureSession(a1, a2, &v28);
      if (!size)
      {
        goto LABEL_52;
      }

LABEL_46:
      std::__shared_weak_count::__release_shared[abi:ne200100](size);
      goto LABEL_52;
    }

    std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
    v24[0] = 0;
    v27 = 0;
    v23 = ims::debug(v40, v24);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "setConfiguration failed for session ", 36);
    *(v23 + 17) = 0;
    MEMORY[0x1E69233B0](*(v23 + 8), a2);
    *(v23 + 17) = 0;
    (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v23 + 17) = 0;
    if (v27 == 1 && v26 < 0)
    {
      operator delete(v25);
    }

    if (v42 < 0)
    {
      operator delete(v40[0]);
    }
  }

  else
  {
    std::string::basic_string[abi:ne200100]<0>(v40, "rtp.mgr");
    v47[0] = 0;
    v50 = 0;
    v19 = ims::error(v40, v47);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "updateSdpForSession() got an invalid session id: ", 49);
    *(v19 + 17) = 0;
    MEMORY[0x1E69233B0](*(v19 + 8), a2);
    *(v19 + 17) = 0;
    (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v19 + 17) = 0;
    if (v50 == 1 && v49 < 0)
    {
      operator delete(v48);
    }

    if (v42 < 0)
    {
      operator delete(v40[0]);
    }

    v20 = *(a1 + 56);
    if (v20)
    {
      v21 = std::__shared_weak_count::lock(v20);
      if (v21)
      {
        size = v21;
        v22 = *(a1 + 48);
        if (v22)
        {
          (*(*v22 + 16))(v22, a2, 0);
        }

        goto LABEL_46;
      }
    }
  }

LABEL_52:
  if (v51.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v51.__r_.__value_.__l.__size_);
  }
}

void sub_1E512AE8C(_Unwind_Exception *a1)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  v4 = *(v2 - 144);
  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }

  _Unwind_Resume(a1);
}

void RTPManager::terminateSessionWithId(RTPManager *this, unint64_t a2)
{
  v48 = a2;
  std::string::basic_string[abi:ne200100]<0>(__p, "rtp.mgr");
  v44[0] = 0;
  v47 = 0;
  v3 = ims::debug(__p, v44);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v4 = v3;
  v5 = *(*(*this - 8) + 8);
  v6 = *(v3 + 8);
  v7 = strlen((v5 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, v5 & 0x7FFFFFFFFFFFFFFFLL, v7);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "::", 2);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "terminateSessionWithId", 22);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), " [sessionId=", 12);
  *(v4 + 17) = 0;
  MEMORY[0x1E69233B0](*(v4 + 8), v48);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "]", 1);
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v47 == 1 && v46 < 0)
  {
    operator delete(v45);
  }

  if (SBYTE7(v26) < 0)
  {
    operator delete(__p[0]);
  }

  v42 = 0;
  v43 = 0;
  (*(**(this + 19) + 24))(&v42);
  if (v42)
  {
    (*(*this + 48))(this, v48);
    v8 = (*(*v42 + 104))(v42);
    v9 = *(this + 9);
    if (!v9)
    {
      goto LABEL_15;
    }

    v10 = this + 72;
    do
    {
      if (*(v9 + 8) >= v8)
      {
        v10 = v9;
      }

      v9 = *&v9[8 * (*(v9 + 8) < v8)];
    }

    while (v9);
    if (v10 != this + 72 && *(v10 + 8) <= v8)
    {
      v11 = *(v10 + 5);
    }

    else
    {
LABEL_15:
      v11 = 0;
    }

    if (v11 == v48)
    {
      v12 = (*(*v42 + 104))(v42);
      RTPActiveSessionSet::setActive(this + 64, 0, v12);
    }

    if (v42)
    {
      if (!ims::getValueFromMap<unsigned long long,ImsPowerAssertion *>(this + 320, &v48, 0))
      {
        v41 = 0;
        v39 = 0u;
        v40 = 0u;
        v37 = 0u;
        v38 = 0u;
        v35 = 0u;
        v36 = 0u;
        v33 = 0u;
        v34 = 0u;
        v31 = 0u;
        v32 = 0u;
        *v29 = 0u;
        v30 = 0u;
        v27 = 0u;
        v28 = 0u;
        *__p = 0u;
        v26 = 0u;
        std::ostringstream::basic_ostringstream[abi:ne200100](__p);
        v16 = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(__p, "com.apple.ipTelephony.terminateMedia.", 37);
        MEMORY[0x1E69233B0](v16, v48);
        operator new();
      }

      std::string::basic_string[abi:ne200100]<0>(__p, "rtp.mgr");
      v21[0] = 0;
      v24 = 0;
      v13 = ims::warn(__p, v21);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "not terminating session, power assertion for this session already exists", 72);
      *(v13 + 17) = 0;
      (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v13 + 17) = 0;
      if (v24 != 1 || (v23 & 0x80000000) == 0)
      {
        goto LABEL_27;
      }

      v14 = v22;
    }

    else
    {
      std::string::basic_string[abi:ne200100]<0>(__p, "rtp.mgr");
      v17[0] = 0;
      v20 = 0;
      v15 = ims::warn(__p, v17);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "No session to terminate for id ", 31);
      *(v15 + 17) = 0;
      MEMORY[0x1E69233B0](*(v15 + 8), v48);
      *(v15 + 17) = 0;
      (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v15 + 17) = 0;
      if (v20 != 1 || (v19 & 0x80000000) == 0)
      {
LABEL_27:
        if (SBYTE7(v26) < 0)
        {
          operator delete(__p[0]);
        }

        goto LABEL_31;
      }

      v14 = v18;
    }

    operator delete(v14);
    goto LABEL_27;
  }

LABEL_31:
  if (v43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  }
}

void sub_1E512B6A0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, void *__p, uint64_t a41, int a42, __int16 a43, char a44, char a45, void *a46, uint64_t a47, int a48, __int16 a49, char a50, char a51)
{
  if (a45 < 0)
  {
    operator delete(__p);
  }

  MEMORY[0x1E69235B0](v51, 0x1012C405C87E9CELL);
  std::ostringstream::~ostringstream(&a46);
  v54 = *(v52 - 120);
  if (v54)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v54);
  }

  _Unwind_Resume(a1);
}

uint64_t ims::getValueFromMap<unsigned long long,ImsPowerAssertion *>(uint64_t a1, unint64_t *a2, uint64_t a3)
{
  v7 = *(a1 + 8);
  v5 = a1 + 8;
  v6 = v7;
  if (!v7)
  {
    goto LABEL_9;
  }

  v8 = *a2;
  v9 = v5;
  do
  {
    v10 = *(v6 + 32);
    v11 = v10 >= v8;
    v12 = v10 < v8;
    if (v11)
    {
      v9 = v6;
    }

    v6 = *(v6 + 8 * v12);
  }

  while (v6);
  if (v9 != v5 && v8 >= *(v9 + 32))
  {
    return *(v9 + 40);
  }

LABEL_9:
  std::string::basic_string[abi:ne200100]<0>(v19, "rtp.util");
  v15[0] = 0;
  v18 = 0;
  v13 = ims::debug(v19, v15);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "getValueFromMap", 15);
  *(v13 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), " Object not found [key=", 23);
  *(v13 + 17) = 0;
  MEMORY[0x1E69233B0](*(v13 + 8), *a2);
  *(v13 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "]", 1);
  *(v13 + 17) = 0;
  (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v13 + 17) = 0;
  if (v18 == 1 && v17 < 0)
  {
    operator delete(__p);
  }

  if (v20 < 0)
  {
    operator delete(v19[0]);
  }

  return a3;
}

void sub_1E512B8FC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

uint64_t RTPManager::dtmfEventForASCIIChar(RTPManager *this)
{
  if (this == 42)
  {
    return 10;
  }

  else if (this == 35)
  {
    return 11;
  }

  else
  {
    v2 = this - 48;
    if ((this - 48) >= 0xA)
    {
      v3 = std::string::basic_string[abi:ne200100]<0>(&v10, "rtp.mgr");
      v6[0] = 0;
      v9 = 0;
      v4 = ims::error(v3, v6);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "RTPManager:: dtmfEventForASCIIChar got invalid input: ", 54);
      *(v4 + 17) = 0;
      MEMORY[0x1E6923340](*(v4 + 8), this);
      *(v4 + 17) = 0;
      (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v4 + 17) = 0;
      if (v9 == 1 && v8 < 0)
      {
        operator delete(__p);
      }

      if (v11 < 0)
      {
        operator delete(v10);
      }

      return 16;
    }
  }

  return v2;
}

void sub_1E512BA44(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (*(v18 - 17) < 0)
  {
    operator delete(*(v18 - 40));
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::setRelayMode(RTPManager *this, unint64_t a2, uint64_t a3)
{
  v48 = a2;
  v6 = std::string::basic_string[abi:ne200100]<0>(&v45, "rtp.mgr");
  v41[0] = 0;
  v44 = 0;
  v7 = ims::debug(v6, v41);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*this - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "setRelayMode", 12);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [sessionId=", 12);
  *(v8 + 17) = 0;
  MEMORY[0x1E69233B0](*(v8 + 8), a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " isRelayCall=", 13);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923320](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v44 == 1 && v43 < 0)
  {
    operator delete(__p);
  }

  if (v47 < 0)
  {
    operator delete(v45);
  }

  v12 = (this + 216);
  v13 = *(this + 27);
  if (!v13)
  {
    goto LABEL_15;
  }

  v14 = (this + 216);
  v15 = *(this + 27);
  do
  {
    v16 = *(v15 + 4);
    v17 = v16 >= a2;
    v18 = v16 < a2;
    if (v17)
    {
      v14 = v15;
    }

    v15 = *&v15[8 * v18];
  }

  while (v15);
  if (v14 != v12 && v14[4] <= a2)
  {
    if (a3)
    {
      return;
    }

    v25 = (this + 216);
    do
    {
      v26 = v13[4];
      v17 = v26 >= a2;
      v27 = v26 < a2;
      if (v17)
      {
        v25 = v13;
      }

      v13 = v13[v27];
    }

    while (v13);
    if (v25 != v12 && v25[4] <= a2)
    {
      std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer(this + 26, v25);
      operator delete(v25);
    }
  }

  else
  {
LABEL_15:
    if ((a3 & 1) == 0)
    {
      return;
    }

    std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>(this + 208, a2);
  }

  v39 = 0;
  v40 = 0;
  (*(**(this + 19) + 24))(&v39);
  if (v39)
  {
    v19 = *(this + 7);
    if (v19)
    {
      v20 = std::__shared_weak_count::lock(v19);
      if (v20)
      {
        v21 = v20;
        v22 = *(this + 6);
        if (v22)
        {
          v45 = 0;
          v46 = 0;
          (*(*v22 + 184))(&v45);
          v33 = (v39 + 56);
          if (*(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(this + 280, (v39 + 56)) + 56) == 1 || v45 && (v23 = SipStack::prefs(v45), ImsPrefs::EnableAPOnlyMode(v23)))
          {
            v33 = 0;
            v34 = 0;
            RTPManager::getStackControllerByType(this, 1, &v31);
            std::dynamic_pointer_cast[abi:ne200100]<AVCRTPStackController,RTPStackController>(&v31, &v33);
            if (v32)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v32);
            }

            if (v33)
            {
              AVCRTPStackController::setRelayMode(v33, (v39 + 56), a2, a3);
            }

            if (v34)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v34);
            }

            v24 = v40;
            v30[0] = v39;
            v30[1] = &v40->__vftable;
            if (v40)
            {
              atomic_fetch_add_explicit(&v40->__shared_owners_, 1uLL, memory_order_relaxed);
            }

            RTPManager::reconfigureSession(this, a2, v30);
            if (v24)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v24);
            }
          }

          if (v46)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v46);
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v21);
      }
    }
  }

  else
  {
    v28 = std::string::basic_string[abi:ne200100]<0>(&v45, "rtp.mgr");
    v35[0] = 0;
    v38 = 0;
    v29 = ims::error(v28, v35);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "Session not found [sessionId=", 29);
    *(v29 + 17) = 0;
    MEMORY[0x1E69233B0](*(v29 + 8), a2);
    *(v29 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "]", 1);
    *(v29 + 17) = 0;
    (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v29 + 17) = 0;
    if (v38 == 1 && v37 < 0)
    {
      operator delete(v36);
    }

    if (v47 < 0)
    {
      operator delete(v45);
    }
  }

  if (v40)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v40);
  }
}

void sub_1E512BF0C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, uint64_t a16, void *__p, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, std::__shared_weak_count *a26, uint64_t a27, uint64_t a28, void *a29, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, char a36)
{
  if (a14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  v39 = *(v37 - 88);
  if (v39)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v39);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v36);
  if (a26)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a26);
  }

  _Unwind_Resume(a1);
}

uint64_t RTPManager::getStackControllerByType@<X0>(uint64_t a1@<X0>, int a2@<W1>, void *a3@<X8>)
{
  v5 = *(a1 + 192);
  result = a1 + 192;
  v4 = v5;
  if (!v5)
  {
    goto LABEL_8;
  }

  v6 = result;
  do
  {
    if (*(v4 + 32) >= a2)
    {
      v6 = v4;
    }

    v4 = *(v4 + 8 * (*(v4 + 32) < a2));
  }

  while (v4);
  if (v6 != result && *(v6 + 32) <= a2)
  {
    v8 = *(v6 + 40);
    v7 = *(v6 + 48);
    *a3 = v8;
    a3[1] = v7;
    if (v7)
    {
      atomic_fetch_add_explicit((v7 + 8), 1uLL, memory_order_relaxed);
    }
  }

  else
  {
LABEL_8:
    *a3 = 0;
    a3[1] = 0;
  }

  return result;
}

void RTPManager::setScreeningMode(RTPManager *this, unint64_t a2, uint64_t a3)
{
  v48 = a2;
  v6 = std::string::basic_string[abi:ne200100]<0>(&v45, "rtp.mgr");
  v41[0] = 0;
  v44 = 0;
  v7 = ims::debug(v6, v41);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*this - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "setScreeningMode", 16);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [sessionId=", 12);
  *(v8 + 17) = 0;
  MEMORY[0x1E69233B0](*(v8 + 8), a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " isScreeningCall=", 17);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923320](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v44 == 1 && v43 < 0)
  {
    operator delete(__p);
  }

  if (v47 < 0)
  {
    operator delete(v45);
  }

  v12 = (this + 240);
  v13 = *(this + 30);
  if (!v13)
  {
    goto LABEL_15;
  }

  v14 = (this + 240);
  v15 = *(this + 30);
  do
  {
    v16 = *(v15 + 4);
    v17 = v16 >= a2;
    v18 = v16 < a2;
    if (v17)
    {
      v14 = v15;
    }

    v15 = *&v15[8 * v18];
  }

  while (v15);
  if (v14 != v12 && v14[4] <= a2)
  {
    if (a3)
    {
      return;
    }

    v25 = (this + 240);
    do
    {
      v26 = v13[4];
      v17 = v26 >= a2;
      v27 = v26 < a2;
      if (v17)
      {
        v25 = v13;
      }

      v13 = v13[v27];
    }

    while (v13);
    if (v25 != v12 && v25[4] <= a2)
    {
      std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer(this + 29, v25);
      operator delete(v25);
    }
  }

  else
  {
LABEL_15:
    if ((a3 & 1) == 0)
    {
      return;
    }

    std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>(this + 232, a2);
  }

  v39 = 0;
  v40 = 0;
  (*(**(this + 19) + 24))(&v39);
  if (v39)
  {
    v19 = *(this + 7);
    if (v19)
    {
      v20 = std::__shared_weak_count::lock(v19);
      if (v20)
      {
        v21 = v20;
        v22 = *(this + 6);
        if (v22)
        {
          v45 = 0;
          v46 = 0;
          (*(*v22 + 184))(&v45);
          v33 = (v39 + 56);
          if (*(std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(this + 280, (v39 + 56)) + 56) == 1 || v45 && (v23 = SipStack::prefs(v45), ImsPrefs::EnableAPOnlyMode(v23)))
          {
            v33 = 0;
            v34 = 0;
            RTPManager::getStackControllerByType(this, 1, &v31);
            std::dynamic_pointer_cast[abi:ne200100]<AVCRTPStackController,RTPStackController>(&v31, &v33);
            if (v32)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v32);
            }

            if (v33)
            {
              AVCRTPStackController::setScreeningMode(v33, (v39 + 56), a2, a3);
            }

            if (v34)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v34);
            }

            v24 = v40;
            v30[0] = v39;
            v30[1] = &v40->__vftable;
            if (v40)
            {
              atomic_fetch_add_explicit(&v40->__shared_owners_, 1uLL, memory_order_relaxed);
            }

            RTPManager::reconfigureSession(this, a2, v30);
            if (v24)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v24);
            }
          }

          if (v46)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v46);
          }
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v21);
      }
    }
  }

  else
  {
    v28 = std::string::basic_string[abi:ne200100]<0>(&v45, "rtp.mgr");
    v35[0] = 0;
    v38 = 0;
    v29 = ims::error(v28, v35);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "Session not found [sessionId=", 29);
    *(v29 + 17) = 0;
    MEMORY[0x1E69233B0](*(v29 + 8), a2);
    *(v29 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "]", 1);
    *(v29 + 17) = 0;
    (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v29 + 17) = 0;
    if (v38 == 1 && v37 < 0)
    {
      operator delete(v36);
    }

    if (v47 < 0)
    {
      operator delete(v45);
    }
  }

  if (v40)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v40);
  }
}

void sub_1E512C4C0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, uint64_t a16, void *__p, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, std::__shared_weak_count *a26, uint64_t a27, uint64_t a28, void *a29, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, char a36)
{
  if (a14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  v39 = *(v37 - 88);
  if (v39)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v39);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v36);
  if (a26)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a26);
  }

  _Unwind_Resume(a1);
}

void RTPManager::setMute(RTPManager *this)
{
  v1 = std::string::basic_string[abi:ne200100]<0>(&v7, "rtp.mgr");
  v3[0] = 0;
  v6 = 0;
  v2 = ims::error(v1, v3);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v2 + 8), "RTPManager::setMuteVoiceCall called for non-OSX platform, ignoring", 66);
  *(v2 + 17) = 0;
  (*(*v2 + 64))(v2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v2 + 17) = 0;
  if (v6 == 1 && v5 < 0)
  {
    operator delete(__p);
  }

  if (v8 < 0)
  {
    operator delete(v7);
  }
}

void sub_1E512C650(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (*(v18 - 17) < 0)
  {
    operator delete(*(v18 - 40));
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::startSendingDTMF(RTPManager *this, RTPManager *a2)
{
  v3 = *(this + 9);
  if (!v3)
  {
    goto LABEL_8;
  }

  v4 = this + 72;
  do
  {
    if (v3[8] >= 2)
    {
      v4 = v3;
    }

    v3 = *&v3[2 * (v3[8] < 2)];
  }

  while (v3);
  if (v4 != this + 72 && *(v4 + 8) <= 2)
  {
    v5 = *(v4 + 5);
  }

  else
  {
LABEL_8:
    v5 = 0;
  }

  v16 = 0;
  v17 = 0;
  (*(**(this + 19) + 24))(&v16);
  if (v16)
  {
    v6 = RTPManager::dtmfEventForASCIIChar(a2);
    if (v6 != 16)
    {
      v7 = std::string::basic_string[abi:ne200100]<0>(&v14, "rtp.mgr");
      v10[0] = 0;
      v13 = 0;
      v8 = ims::debug(v7, v10);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Long tone - Starting to send digit: ", 36);
      *(v8 + 17) = 0;
      MEMORY[0x1E6923340](*(v8 + 8), v6);
      *(v8 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " To Session: ", 13);
      *(v8 + 17) = 0;
      MEMORY[0x1E69233B0](*(v8 + 8), v5);
      *(v8 + 17) = 0;
      (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v8 + 17) = 0;
      if (v13 == 1 && v12 < 0)
      {
        operator delete(__p);
      }

      if (v15 < 0)
      {
        operator delete(v14);
      }

      (*(*v16 + 128))(v9);
      ImsResult::~ImsResult(v9);
    }
  }

  if (v17)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v17);
  }
}

void sub_1E512C870(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, void *__p, uint64_t a24, int a25, __int16 a26, char a27, char a28, uint64_t a29, char a30)
{
  v32 = *(v30 - 40);
  if (v32)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v32);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::stopSendingDTMF(RTPManager *this)
{
  v1 = *(this + 9);
  if (!v1)
  {
    goto LABEL_8;
  }

  v2 = this + 72;
  do
  {
    if (v1[8] >= 2)
    {
      v2 = v1;
    }

    v1 = *&v1[2 * (v1[8] < 2)];
  }

  while (v1);
  if (v2 != this + 72 && *(v2 + 8) <= 2)
  {
    v3 = *(v2 + 5);
  }

  else
  {
LABEL_8:
    v3 = 0;
  }

  v13 = 0;
  v14 = 0;
  (*(**(this + 19) + 24))(&v13);
  if (v13)
  {
    v4 = std::string::basic_string[abi:ne200100]<0>(&v11, "rtp.mgr");
    v7[0] = 0;
    v10 = 0;
    v5 = ims::debug(v4, v7);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "Long tone - Stopping to send digit Session: ", 44);
    *(v5 + 17) = 0;
    MEMORY[0x1E69233B0](*(v5 + 8), v3);
    *(v5 + 17) = 0;
    (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v5 + 17) = 0;
    if (v10 == 1 && v9 < 0)
    {
      operator delete(__p);
    }

    if (v12 < 0)
    {
      operator delete(v11);
    }

    (*(*v13 + 136))(v6);
    ImsResult::~ImsResult(v6);
  }

  if (v14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }
}

void sub_1E512CA5C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, void *__p, uint64_t a24, int a25, __int16 a26, char a27, char a28, uint64_t a29, char a30)
{
  v32 = *(v30 - 24);
  if (v32)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v32);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::sendDTMFDigits(uint64_t a1, unsigned __int8 **a2)
{
  v4 = *(a1 + 72);
  if (!v4)
  {
    goto LABEL_8;
  }

  v5 = a1 + 72;
  do
  {
    if (*(v4 + 32) >= 2)
    {
      v5 = v4;
    }

    v4 = *(v4 + 8 * (*(v4 + 32) < 2));
  }

  while (v4);
  if (v5 != a1 + 72 && *(v5 + 32) <= 2)
  {
    v6 = *(v5 + 40);
  }

  else
  {
LABEL_8:
    v6 = 0;
  }

  v59 = 0;
  v60 = 0;
  (*(**(a1 + 152) + 24))(&v59);
  v7 = v59;
  if (v59)
  {
    v56 = 0;
    v57 = 0;
    v58 = 0;
    v8 = *a2;
    v9 = a2[1];
    if (*a2 != v9)
    {
      do
      {
        v10 = *v8;
        if (RTPManager::dtmfEventForASCIIChar(v10) != 16)
        {
          v11 = RTPManager::dtmfEventForASCIIChar(v10);
          v12 = v57;
          if (v57 >= v58)
          {
            v14 = v56;
            v15 = (v57 - v56);
            v16 = v57 - v56 + 1;
            if (v16 < 0)
            {
              std::vector<unsigned char>::__throw_length_error[abi:ne200100]();
            }

            v17 = v58 - v56;
            if (2 * (v58 - v56) > v16)
            {
              v16 = 2 * v17;
            }

            if (v17 >= 0x3FFFFFFFFFFFFFFFLL)
            {
              v18 = 0x7FFFFFFFFFFFFFFFLL;
            }

            else
            {
              v18 = v16;
            }

            if (v18)
            {
              operator new();
            }

            v19 = v57 - v56;
            *v15 = v11;
            v13 = v15 + 1;
            memcpy(0, v14, v19);
            v56 = 0;
            v57 = v15 + 1;
            v58 = 0;
          }

          else
          {
            *v57 = v11;
            v13 = v12 + 1;
          }

          v57 = v13;
        }

        ++v8;
      }

      while (v8 != v9);
      v7 = v59;
    }

    (*(*v7 + 144))(v53);
    v49 = 0u;
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v47[0] = &unk_1F5EBDEF8;
    v47[1] = &_bambiDomain;
    v48 = 0;
    v20 = v53[1];
    v21 = v54;
    ImsResult::~ImsResult(v47);
    ImsResult::~ImsResult(v53);
    if (v20 == &_bambiDomain && !v21)
    {
      v22 = *(a1 + 56);
      if (v22)
      {
        v23 = std::__shared_weak_count::lock(v22);
        if (v23)
        {
          v24 = v23;
          v25 = *(a1 + 48);
          if (v25)
          {
            (*(*v25 + 48))(v25);
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v24);
        }
      }
    }

    v26 = std::string::basic_string[abi:ne200100]<0>(v53, "rtp.mgr");
    v43[0] = 0;
    v46 = 0;
    v27 = ims::debug(v26, v43);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v27 + 8), "Short tone - Sending digits: ", 29);
    *(v27 + 17) = 0;
    if (v46 == 1 && v45 < 0)
    {
      operator delete(__p);
    }

    if (v55 < 0)
    {
      operator delete(v53[0]);
    }

    v28 = v56;
    for (i = v57; v28 != i; ++v28)
    {
      v30 = *v28;
      v31 = std::string::basic_string[abi:ne200100]<0>(v53, "rtp.mgr");
      v39[0] = 0;
      v42 = 0;
      v32 = ims::debug(v31, v39);
      MEMORY[0x1E6923340](*(v32 + 8), v30);
      *(v32 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), " ", 1);
      *(v32 + 17) = 0;
      if (v42 == 1 && v41 < 0)
      {
        operator delete(v40);
      }

      if (v55 < 0)
      {
        operator delete(v53[0]);
      }
    }

    v33 = std::string::basic_string[abi:ne200100]<0>(v53, "rtp.mgr");
    v35[0] = 0;
    v38 = 0;
    v34 = ims::debug(v33, v35);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v34 + 8), "To Session: ", 12);
    *(v34 + 17) = 0;
    MEMORY[0x1E69233B0](*(v34 + 8), v6);
    *(v34 + 17) = 0;
    (*(*v34 + 64))(v34, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v34 + 17) = 0;
    if (v38 == 1 && v37 < 0)
    {
      operator delete(v36);
    }

    if (v55 < 0)
    {
      operator delete(v53[0]);
    }

    if (v56)
    {
      v57 = v56;
      operator delete(v56);
    }
  }

  if (v60)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v60);
  }
}

void sub_1E512CF30(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, uint64_t a30, uint64_t a31, void *__p, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, char a39)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v39);
  v42 = *(v40 - 128);
  if (v42)
  {
    *(v40 - 120) = v42;
    operator delete(v42);
  }

  v43 = *(v40 - 96);
  if (v43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  }

  _Unwind_Resume(a1);
}

void RTPManager::startRingbackTone(RTPManager *this, uint64_t a2)
{
  v4 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
  v59[0] = 0;
  v62 = 0;
  v5 = ims::debug(v4, v59);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v6 = v5;
  v7 = *(*(*this - 8) + 8);
  v8 = *(v5 + 8);
  v9 = strlen((v7 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v8, v7 & 0x7FFFFFFFFFFFFFFFLL, v9);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "::", 2);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "startRingbackTone", 17);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " [sessionId=", 12);
  *(v6 + 17) = 0;
  MEMORY[0x1E69233B0](*(v6 + 8), a2);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "]", 1);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  if (v62 == 1 && v61 < 0)
  {
    operator delete(v60);
  }

  if (v64 < 0)
  {
    operator delete(v63[0]);
  }

  v57 = 0;
  v58 = 0;
  (*(**(this + 19) + 24))(&v57);
  if (v57)
  {
    v10 = (*(*v57 + 104))(v57);
    v11 = *(this + 9);
    if (!v11)
    {
      goto LABEL_15;
    }

    v12 = this + 72;
    do
    {
      if (*(v11 + 8) >= v10)
      {
        v12 = v11;
      }

      v11 = *&v11[8 * (*(v11 + 8) < v10)];
    }

    while (v11);
    if (v12 != this + 72 && *(v12 + 8) <= v10)
    {
      v13 = *(v12 + 5);
    }

    else
    {
LABEL_15:
      v13 = 0;
    }

    v51 = 0;
    v52 = 0;
    RTPManager::sdpSessionForSession(this, a2, &v51);
    v14 = v51;
    if (!v51)
    {
      goto LABEL_30;
    }

    v15 = *(v51 + 128);
    if (v15)
    {
      v15 = std::__shared_weak_count::lock(v15);
      v16 = v15;
      if (v15)
      {
        v15 = *(v14 + 120);
      }
    }

    else
    {
      v16 = 0;
    }

    v19 = SipStack::prefs(v15);
    if (ImsPrefs::UseRTPDetectionAutoStart(v19) && v57)
    {
      v20 = (*(*v57 + 80))(v57);
      if (!v16)
      {
        goto LABEL_29;
      }
    }

    else
    {
      v20 = 0;
      if (!v16)
      {
LABEL_29:
        if (!v20)
        {
          goto LABEL_30;
        }

        goto LABEL_35;
      }
    }

    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
    if ((v20 & 1) == 0)
    {
LABEL_30:
      if (v13 && v13 == a2)
      {
        v21 = (*(*v57 + 104))(v57);
        RTPActiveSessionSet::setActive(this + 64, 0, v21);
        (*(*v57 + 40))(v57, 0);
        goto LABEL_42;
      }

      if (!v13)
      {
LABEL_42:
        if (!*(this + 14))
        {
          v29 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
          v39[0] = 0;
          v42 = 0;
          v30 = ims::debug(v29, v39);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v30 + 8), "starting local ringback tone", 28);
          *(v30 + 17) = 0;
          (*(*v30 + 64))(v30, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v30 + 17) = 0;
          if (v42 == 1 && v41 < 0)
          {
            operator delete(v40);
          }

          if (v64 < 0)
          {
            operator delete(v63[0]);
          }

          v31 = *(this + 7);
          if (v31)
          {
            v32 = std::__shared_weak_count::lock(v31);
            if (v32)
            {
              v33 = v32;
              v34 = *(this + 6);
              if (v34)
              {
                (*(*v34 + 96))(v34, a2, 1);
              }

              std::__shared_weak_count::__release_shared[abi:ne200100](v33);
            }
          }

          *(this + 14) = a2;
          goto LABEL_61;
        }

        v27 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
        v35[0] = 0;
        v38 = 0;
        v28 = ims::error(v27, v35);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v28 + 8), "RTPManager::startRingbackTone already playing for session id: ", 62);
        *(v28 + 17) = 0;
        MEMORY[0x1E69233B0](*(v28 + 8), *(this + 14));
        *(v28 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v28 + 8), " Received: ", 11);
        *(v28 + 17) = 0;
        MEMORY[0x1E69233B0](*(v28 + 8), a2);
        *(v28 + 17) = 0;
        (*(*v28 + 64))(v28, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v28 + 17) = 0;
        if (v38 == 1 && v37 < 0)
        {
          v24 = __p;
          goto LABEL_46;
        }

LABEL_47:
        if (v64 < 0)
        {
          operator delete(v63[0]);
        }

LABEL_61:
        if (v52)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v52);
        }

        goto LABEL_63;
      }

      v25 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
      v43[0] = 0;
      v46 = 0;
      v26 = ims::error(v25, v43);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "RTPManager startRingbackTone will not be playing ringtone, called for session: ", 79);
      *(v26 + 17) = 0;
      MEMORY[0x1E69233B0](*(v26 + 8), a2);
      *(v26 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), " while the active session is: ", 30);
      *(v26 + 17) = 0;
      MEMORY[0x1E69233B0](*(v26 + 8), v13);
      *(v26 + 17) = 0;
      (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v26 + 17) = 0;
      if (v46 != 1 || (v45 & 0x80000000) == 0)
      {
        goto LABEL_47;
      }

      v24 = v44;
LABEL_46:
      operator delete(v24);
      goto LABEL_47;
    }

LABEL_35:
    v22 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
    v47[0] = 0;
    v50 = 0;
    v23 = ims::debug(v22, v47);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "Ignoring startRingbackTone. A session with autostart feature has started on its own for session ", 96);
    *(v23 + 17) = 0;
    MEMORY[0x1E69233B0](*(v23 + 8), a2);
    *(v23 + 17) = 0;
    (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v23 + 17) = 0;
    if (v50 != 1 || (v49 & 0x80000000) == 0)
    {
      goto LABEL_47;
    }

    v24 = v48;
    goto LABEL_46;
  }

  v17 = std::string::basic_string[abi:ne200100]<0>(v63, "rtp.mgr");
  v53[0] = 0;
  v56 = 0;
  v18 = ims::error(v17, v53);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "Session is null", 15);
  *(v18 + 17) = 0;
  (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v18 + 17) = 0;
  if (v56 == 1 && v55 < 0)
  {
    operator delete(v54);
  }

  if (v64 < 0)
  {
    operator delete(v63[0]);
  }

LABEL_63:
  if (v58)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v58);
  }
}

void sub_1E512D734(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, void *__p, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, char a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43, int a44, __int16 a45, char a46, char a47, uint64_t a48, char a49)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v49);
  v52 = *(v50 - 208);
  if (v52)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v52);
  }

  v53 = *(v50 - 136);
  if (v53)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v53);
  }

  _Unwind_Resume(a1);
}

void RTPManager::sdpSessionForSession(RTPManager *this@<X0>, uint64_t a2@<X1>, void *a3@<X8>)
{
  v5 = *(this + 7);
  if (!v5)
  {
    goto LABEL_8;
  }

  v7 = std::__shared_weak_count::lock(v5);
  if (!v7)
  {
    goto LABEL_8;
  }

  v8 = v7;
  v9 = *(this + 6);
  if (!v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
LABEL_8:
    *a3 = 0;
    a3[1] = 0;
    return;
  }

  (*(*v9 + 120))(v9, a2);

  std::__shared_weak_count::__release_shared[abi:ne200100](v8);
}

void RTPManager::stopRingbackTone(RTPManager *this, uint64_t a2)
{
  v4 = std::string::basic_string[abi:ne200100]<0>(v31, "rtp.mgr");
  v27[0] = 0;
  v30 = 0;
  v5 = ims::debug(v4, v27);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v6 = v5;
  v7 = *(*(*this - 8) + 8);
  v8 = *(v5 + 8);
  v9 = strlen((v7 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v8, v7 & 0x7FFFFFFFFFFFFFFFLL, v9);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "::", 2);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "stopRingbackTone", 16);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " [sessionId=", 12);
  *(v6 + 17) = 0;
  MEMORY[0x1E69233B0](*(v6 + 8), a2);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "]", 1);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  if (v30 == 1 && v29 < 0)
  {
    operator delete(__p);
  }

  if (v32 < 0)
  {
    operator delete(v31[0]);
    if (!a2)
    {
      return;
    }
  }

  else if (!a2)
  {
    return;
  }

  v10 = *(this + 14);
  if (v10 == a2)
  {
    v11 = std::string::basic_string[abi:ne200100]<0>(v31, "rtp.mgr");
    v23[0] = 0;
    v26 = 0;
    v12 = ims::debug(v11, v23);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "stopping local ringback tone", 28);
    *(v12 + 17) = 0;
    (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v12 + 17) = 0;
    if (v26 == 1 && v25 < 0)
    {
      operator delete(v24);
    }

    if (v32 < 0)
    {
      operator delete(v31[0]);
    }

    v13 = *(this + 7);
    if (v13)
    {
      v14 = std::__shared_weak_count::lock(v13);
      if (v14)
      {
        v15 = v14;
        v16 = *(this + 6);
        if (v16)
        {
          (*(*v16 + 96))(v16, a2, 0);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v15);
      }
    }

    *(this + 14) = 0;
  }

  else if (v10)
  {
    v17 = std::string::basic_string[abi:ne200100]<0>(v31, "rtp.mgr");
    v19[0] = 0;
    v22 = 0;
    v18 = ims::debug(v17, v19);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "stopRingbackTone Session id mismatch, expecting: ", 49);
    *(v18 + 17) = 0;
    MEMORY[0x1E69233B0](*(v18 + 8), *(this + 14));
    *(v18 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), " Received: ", 11);
    *(v18 + 17) = 0;
    MEMORY[0x1E69233B0](*(v18 + 8), a2);
    *(v18 + 17) = 0;
    (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v18 + 17) = 0;
    if (v22 == 1 && v21 < 0)
    {
      operator delete(v20);
    }

    if (v32 < 0)
    {
      operator delete(v31[0]);
    }
  }
}

void RTPManager::stackControllerInitialized(void *a1, void *a2, std::string *a3, uint64_t a4, uint64_t a5)
{
  v10 = std::string::basic_string[abi:ne200100]<0>(v39, "rtp.mgr");
  v35[0] = 0;
  v38 = 0;
  v11 = ims::debug(v10, v35);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v12 = v11;
  v13 = *(*(*a1 - 8) + 8);
  v14 = *(v11 + 8);
  v15 = strlen((v13 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v14, v13 & 0x7FFFFFFFFFFFFFFFLL, v15);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "::", 2);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "stackControllerInitialized", 26);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), " [stackController=", 18);
  *(v12 + 17) = 0;
  MEMORY[0x1E6923310](*(v12 + 8), *a2);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), " stackId=", 9);
  *(v12 + 17) = 0;
  (*(*v12 + 32))(v12, a3);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), " appId=", 7);
  *(v12 + 17) = 0;
  MEMORY[0x1E6923340](*(v12 + 8), a4);
  *(v12 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), " result=", 8);
  *(v12 + 17) = 0;
  (*(*a5 + 16))(a5, v12);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "]", 1);
  *(v12 + 17) = 0;
  (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v12 + 17) = 0;
  if (v38 == 1 && v37 < 0)
  {
    operator delete(__p);
  }

  if (v40 < 0)
  {
    operator delete(v39[0]);
  }

  v16 = a1[7];
  if (v16)
  {
    v17 = std::__shared_weak_count::lock(v16);
    if (v17)
    {
      v18 = v17;
      v19 = a1[6];
      if (v19)
      {
        v20 = std::string::basic_string[abi:ne200100]<0>(v39, "rtp.mgr");
        v31[0] = 0;
        v34 = 0;
        v21 = ims::debug(v20, v31);
        v22 = "Undefined RTP stack";
        if (*a2)
        {
          v23 = *(*a2 + 64);
          v24 = "kRTPStackTypeBaseband";
          if (v23 != 2)
          {
            v24 = "Undefined RTP stack";
          }

          if (v23 == 1)
          {
            v22 = "kRTPStackTypeAVC";
          }

          else
          {
            v22 = v24;
          }
        }

        std::string::basic_string[abi:ne200100]<0>(&v29, v22);
        LoggableString::LoggableString(&v30, &v29);
        (*(*v21 + 40))(v21, &v30);
        if (*a2)
        {
          v25 = " stack controller initialized!";
        }

        else
        {
          v25 = " stack controller NOT initialized properly!";
        }

        if (*a2)
        {
          v26 = 30;
        }

        else
        {
          v26 = 43;
        }

        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v21 + 8), v25, v26);
        *(v21 + 17) = 0;
        (*(*v21 + 64))(v21, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v21 + 17) = 0;
        if (SHIBYTE(v30.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v30.__r_.__value_.__l.__data_);
        }

        if (SHIBYTE(v29.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v29.__r_.__value_.__l.__data_);
        }

        if (v34 == 1 && v33 < 0)
        {
          operator delete(v32);
        }

        if (v40 < 0)
        {
          operator delete(v39[0]);
        }

        if (*a2)
        {
          v27 = *(*a2 + 64);
        }

        else
        {
          v27 = 0;
        }

        RTPManager::setRTPStackType(a1, a3, v27);
        v28 = (*(**(a5 + 8) + 24))(*(a5 + 8), *(a5 + 16));
        (**v19)(v19, a4, v28 ^ 1u);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v18);
    }
  }
}

void sub_1E512E184(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, void *a16, uint64_t a17, int a18, __int16 a19, char a20, char a21, uint64_t a22, uint64_t a23, void *a24, uint64_t a25, int a26, __int16 a27, char a28, char a29, uint64_t a30, char a31, uint64_t a32, uint64_t a33, void *a34, uint64_t a35, int a36, __int16 a37, char a38, char a39, uint64_t a40, char a41)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  if (a31 == 1 && a29 < 0)
  {
    operator delete(a24);
  }

  if (*(v42 - 81) < 0)
  {
    operator delete(*(v42 - 104));
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v41);
  _Unwind_Resume(a1);
}

void RTPManager::stackError(uint64_t a1, void *a2, uint64_t a3)
{
  std::string::basic_string[abi:ne200100]<0>(v20, "rtp.mgr");
  v16[0] = 0;
  v19 = 0;
  v6 = ims::debug(v20, v16);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v7 = v6;
  v8 = *(*(*a1 - 8) + 8);
  v9 = *(v6 + 8);
  v10 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v8 & 0x7FFFFFFFFFFFFFFFLL, v10);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "stackError", 10);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [stackController=", 18);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923310](*(v7 + 8), *a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " error=", 7);
  *(v7 + 17) = 0;
  (*(*a3 + 16))(a3, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v19 == 1 && v18 < 0)
  {
    operator delete(__p);
  }

  if (v21 < 0)
  {
    operator delete(v20[0]);
  }

  v11 = *(a1 + 56);
  if (v11)
  {
    v12 = std::__shared_weak_count::lock(v11);
    if (v12)
    {
      v13 = v12;
      v14 = *(a1 + 48);
      if (v14)
      {
        v15 = *(*a2 + 64);
        if (v15 == *(a1 + 304) || v15 == 1 && RTPManager::kRTTSessionCount)
        {
          (*(*v14 + 56))(v14, a3);
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v13);
    }
  }
}

void RTPManager::handleMediaSessionInitialized(void *a1, void *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v25[0] = 0;
  v28 = 0;
  v7 = ims::debug(v6, v25);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "handleMediaSessionInitialized", 29);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [session=", 10);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923310](*(v8 + 8), *a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " error=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v28 == 1 && v27 < 0)
  {
    operator delete(__p);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v12 = (*(**a2 + 176))();
  v13 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v21[0] = 0;
  v24 = 0;
  v14 = ims::debug(v13, v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "handleMediaSessionInitialized ", 30);
  *(v14 + 17) = 0;
  MEMORY[0x1E69233B0](*(v14 + 8), v12);
  *(v14 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), " result: ", 9);
  *(v14 + 17) = 0;
  if (a3)
  {
    v15 = "failed!";
  }

  else
  {
    v15 = "success!";
  }

  if (a3)
  {
    v16 = 7;
  }

  else
  {
    v16 = 8;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), v15, v16);
  *(v14 + 17) = 0;
  (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v14 + 17) = 0;
  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v17 = a1[7];
  if (v17)
  {
    v18 = std::__shared_weak_count::lock(v17);
    if (v18)
    {
      v19 = v18;
      v20 = a1[6];
      if (v20)
      {
        (*(*v20 + 8))(v20, v12, a3 == 0);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v19);
    }
  }
}

void RTPManager::handleMediaSessionTerminated(uint64_t a1, void *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v66, "rtp.mgr");
  v62[0] = 0;
  v65 = 0;
  v7 = ims::debug(v6, v62);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "handleMediaSessionTerminated", 28);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [session=", 10);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923310](*(v8 + 8), *a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " error=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v65 == 1 && v64 < 0)
  {
    operator delete(v63);
  }

  if (SHIBYTE(v67) < 0)
  {
    operator delete(v66[0]);
  }

  if (*a2)
  {
    v12 = (*(**a2 + 176))(*a2);
    memset(&v61, 0, sizeof(v61));
    v13 = *a2;
    if (*(*a2 + 79) < 0)
    {
      std::string::__init_copy_ctor_external(&v61, *(v13 + 56), *(v13 + 64));
    }

    else
    {
      v61 = *(v13 + 56);
    }

    RTPManager::releaseTerminationAssertion(a1, v12);
    RTPTransportManager::removeTransport(v12);
    if (a3 == 2)
    {
      v14 = std::string::basic_string[abi:ne200100]<0>(v66, "rtp.mgr");
      v57[0] = 0;
      v60 = 0;
      v15 = ims::debug(v14, v57);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "handleMediaSessionTerminated called with kInvalidState", 54);
      *(v15 + 17) = 0;
      MEMORY[0x1E69233B0](*(v15 + 8), v12);
      *(v15 + 17) = 0;
      (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v15 + 17) = 0;
      if (v60 != 1 || (v59 & 0x80000000) == 0)
      {
        goto LABEL_25;
      }

      v16 = v58;
    }

    else
    {
      v17 = std::string::basic_string[abi:ne200100]<0>(v66, "rtp.mgr");
      v53[0] = 0;
      v56 = 0;
      v18 = ims::debug(v17, v53);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "handleMediaSessionTerminated ", 29);
      *(v18 + 17) = 0;
      MEMORY[0x1E69233B0](*(v18 + 8), v12);
      *(v18 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), " result: ", 9);
      *(v18 + 17) = 0;
      if (a3)
      {
        v19 = "failed!";
      }

      else
      {
        v19 = "success!";
      }

      if (a3)
      {
        v20 = 7;
      }

      else
      {
        v20 = 8;
      }

      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), v19, v20);
      *(v18 + 17) = 0;
      (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v18 + 17) = 0;
      if (v56 != 1 || (v55 & 0x80000000) == 0)
      {
        goto LABEL_25;
      }

      v16 = __p;
    }

    operator delete(v16);
LABEL_25:
    if (SHIBYTE(v67) < 0)
    {
      operator delete(v66[0]);
    }

    (*(**(a1 + 152) + 32))(&v51);
    if (v52)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v52);
    }

    MediaSessionBaseCollection::remove((a1 + 120), v12, &v49);
    if (v50)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v50);
    }

    v21 = *(a1 + 216);
    if (v21)
    {
      v22 = (a1 + 216);
      do
      {
        v23 = v21[4];
        v24 = v23 >= v12;
        v25 = v23 < v12;
        if (v24)
        {
          v22 = v21;
        }

        v21 = v21[v25];
      }

      while (v21);
      if (v22 != (a1 + 216) && v12 >= v22[4])
      {
        std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 208), v22);
        operator delete(v22);
      }
    }

    v26 = *(a1 + 240);
    if (v26)
    {
      v27 = (a1 + 240);
      do
      {
        v28 = v26[4];
        v24 = v28 >= v12;
        v29 = v28 < v12;
        if (v24)
        {
          v27 = v26;
        }

        v26 = v26[v29];
      }

      while (v26);
      if (v27 != (a1 + 240) && v12 >= v27[4])
      {
        std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 232), v27);
        operator delete(v27);
      }
    }

    v30 = *(a1 + 264);
    if (v30)
    {
      v31 = (a1 + 264);
      do
      {
        v32 = v30[4];
        v24 = v32 >= v12;
        v33 = v32 < v12;
        if (v24)
        {
          v31 = v30;
        }

        v30 = v30[v33];
      }

      while (v30);
      if (v31 != (a1 + 264) && v12 >= v31[4])
      {
        std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 256), v31);
        operator delete(v31);
      }
    }

    std::string::basic_string[abi:ne200100]<0>(v47, "rtp.mgr");
    v43[0] = 0;
    v46 = 0;
    v34 = ims::debug(v47, v43);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v34 + 8), "There are ", 10);
    *(v34 + 17) = 0;
    (*(**(a1 + 152) + 80))(v66);
    v35 = v67;
    std::__list_imp<unsigned long long>::clear(v66);
    MEMORY[0x1E6923370](*(v34 + 8), v35);
    *(v34 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v34 + 8), " sessions remaining for stack ID ", 33);
    *(v34 + 17) = 0;
    (*(*v34 + 32))(v34, &v61);
    (*(*v34 + 64))(v34, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v34 + 17) = 0;
    if (v46 == 1 && v45 < 0)
    {
      operator delete(v44);
    }

    if (v48 < 0)
    {
      operator delete(v47[0]);
    }

    if (a3 != 13)
    {
      (*(**(a1 + 152) + 80))(v66);
      v36 = v67;
      std::__list_imp<unsigned long long>::clear(v66);
      if (!v36)
      {
        v37 = *(a1 + 184);
        v38 = (a1 + 192);
        if (v37 != v38)
        {
          do
          {
            v39 = v37[5];
            if (v39)
            {
              (*(*v39 + 32))(v39, &v61, 0);
            }

            v40 = v37[1];
            if (v40)
            {
              do
              {
                v41 = v40;
                v40 = *v40;
              }

              while (v40);
            }

            else
            {
              do
              {
                v41 = v37[2];
                v42 = *v41 == v37;
                v37 = v41;
              }

              while (!v42);
            }

            v37 = v41;
          }

          while (v41 != v38);
        }
      }
    }

    if (SHIBYTE(v61.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v61.__r_.__value_.__l.__data_);
    }
  }
}

void sub_1E512EF7C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, int a21, __int16 a22, char a23, char a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, int a33, __int16 a34, char a35, char a36, uint64_t a37, char a38, uint64_t a39, uint64_t a40, void *__p, uint64_t a42, int a43, __int16 a44, char a45, char a46, uint64_t a47, char a48)
{
  if (*(v48 - 153) < 0)
  {
    operator delete(*(v48 - 176));
  }

  _Unwind_Resume(exception_object);
}

void **RTPManager::releaseTerminationAssertion(uint64_t **this, unint64_t a2)
{
  v5 = a2;
  result = ims::getValueFromMap<unsigned long long,ImsPowerAssertion *>((this + 40), &v5, 0);
  if (result)
  {
    v4 = result;
    std::__tree<std::__value_type<unsigned long long,ImsPowerAssertion *>,std::__map_value_compare<unsigned long long,std::__value_type<unsigned long long,ImsPowerAssertion *>,std::less<unsigned long long>,true>,std::allocator<std::__value_type<unsigned long long,ImsPowerAssertion *>>>::__erase_unique<unsigned long long>(this + 40, &v5);
    ImsPowerAssertion::~ImsPowerAssertion(v4);
    return MEMORY[0x1E69235B0]();
  }

  return result;
}

void RTPManager::handleMediaSessionConfigured(void *a1, void *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v25[0] = 0;
  v28 = 0;
  v7 = ims::debug(v6, v25);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "handleMediaSessionConfigured", 28);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [session=", 10);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923310](*(v8 + 8), *a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " error=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v28 == 1 && v27 < 0)
  {
    operator delete(__p);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v12 = (*(**a2 + 176))();
  v13 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v21[0] = 0;
  v24 = 0;
  v14 = ims::debug(v13, v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "handleMediaSessionConfigured ", 29);
  *(v14 + 17) = 0;
  MEMORY[0x1E69233B0](*(v14 + 8), v12);
  *(v14 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), " result: ", 9);
  *(v14 + 17) = 0;
  if (a3)
  {
    v15 = "failed!";
  }

  else
  {
    v15 = "success!";
  }

  if (a3)
  {
    v16 = 7;
  }

  else
  {
    v16 = 8;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), v15, v16);
  *(v14 + 17) = 0;
  (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v14 + 17) = 0;
  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v17 = a1[7];
  if (v17)
  {
    v18 = std::__shared_weak_count::lock(v17);
    if (v18)
    {
      v19 = v18;
      v20 = a1[6];
      if (v20)
      {
        (*(*v20 + 16))(v20, v12, a3 == 0);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v19);
    }
  }
}

void RTPManager::handleMediaSessionActivated(void *a1, void *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v45, "rtp.mgr");
  v41[0] = 0;
  v44 = 0;
  v7 = ims::debug(v6, v41);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "handleMediaSessionActivated", 27);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [session=", 10);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923310](*(v8 + 8), *a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " error=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v44 == 1 && v43 < 0)
  {
    operator delete(__p);
  }

  if (v46 < 0)
  {
    operator delete(v45[0]);
  }

  v12 = (*(**a2 + 176))();
  v13 = std::string::basic_string[abi:ne200100]<0>(v45, "rtp.mgr");
  v37[0] = 0;
  v40 = 0;
  v14 = ims::debug(v13, v37);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "handleMediaSessionActivated ", 28);
  *(v14 + 17) = 0;
  MEMORY[0x1E69233B0](*(v14 + 8), v12);
  *(v14 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), " result: ", 9);
  *(v14 + 17) = 0;
  if (a3)
  {
    v15 = "failed!";
  }

  else
  {
    v15 = "success!";
  }

  if (a3)
  {
    v16 = 7;
  }

  else
  {
    v16 = 8;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), v15, v16);
  *(v14 + 17) = 0;
  (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v14 + 17) = 0;
  if (v40 == 1 && v39 < 0)
  {
    operator delete(v38);
  }

  if (v46 < 0)
  {
    operator delete(v45[0]);
  }

  if (a3)
  {
    v17 = (*(**a2 + 104))();
    v18 = a1[9];
    if (!v18)
    {
      goto LABEL_26;
    }

    v19 = a1 + 9;
    do
    {
      if (*(v18 + 32) >= v17)
      {
        v19 = v18;
      }

      v18 = *(v18 + 8 * (*(v18 + 32) < v17));
    }

    while (v18);
    if (v19 != a1 + 9 && *(v19 + 8) <= v17)
    {
      v20 = v19[5];
    }

    else
    {
LABEL_26:
      v20 = 0;
    }

    if (v20 == v12)
    {
      v21 = (*(**a2 + 104))();
      RTPActiveSessionSet::setActive((a1 + 8), 0, v21);
    }
  }

  v22 = a1[7];
  if (v22)
  {
    v23 = std::__shared_weak_count::lock(v22);
    if (v23)
    {
      v24 = a1[6];
      if (v24)
      {
        v25 = (*(**a2 + 104))();
        v28 = a1[9];
        v27 = a1 + 9;
        v26 = v28;
        if (!v28)
        {
          goto LABEL_39;
        }

        v29 = v27;
        do
        {
          if (*(v26 + 32) >= v25)
          {
            v29 = v26;
          }

          v26 = *(v26 + 8 * (*(v26 + 32) < v25));
        }

        while (v26);
        if (v29 != v27 && *(v29 + 8) <= v25)
        {
          v30 = v29[5];
          if (a3)
          {
            goto LABEL_41;
          }
        }

        else
        {
LABEL_39:
          v30 = 0;
          if (a3)
          {
LABEL_41:
            (*(*v24 + 24))(v24, v12, a3);
            goto LABEL_48;
          }
        }

        if (v12 == v30)
        {
          goto LABEL_41;
        }
      }
    }
  }

  else
  {
    v23 = 0;
  }

  v31 = std::string::basic_string[abi:ne200100]<0>(v45, "rtp.mgr");
  v33[0] = 0;
  v36 = 0;
  v32 = ims::debug(v31, v33);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v32 + 8), "Not forwarding activated notification to delegate for session ", 62);
  *(v32 + 17) = 0;
  MEMORY[0x1E69233B0](*(v32 + 8), v12);
  *(v32 + 17) = 0;
  (*(*v32 + 64))(v32, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v32 + 17) = 0;
  if (v36 == 1 && v35 < 0)
  {
    operator delete(v34);
  }

  if (v46 < 0)
  {
    operator delete(v45[0]);
  }

LABEL_48:
  if (v23)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v23);
  }
}

void sub_1E512F980(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, int a33, __int16 a34, char a35, char a36, uint64_t a37, char a38)
{
  if (v38)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::handleMediaSessionDeactivated(void *a1, void *a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v25[0] = 0;
  v28 = 0;
  v7 = ims::debug(v6, v25);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v8 = v7;
  v9 = *(*(*a1 - 8) + 8);
  v10 = *(v7 + 8);
  v11 = strlen((v9 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v10, v9 & 0x7FFFFFFFFFFFFFFFLL, v11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "::", 2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "handleMediaSessionDeactivated", 29);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " [session=", 10);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923310](*(v8 + 8), *a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " error=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "]", 1);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v28 == 1 && v27 < 0)
  {
    operator delete(__p);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v12 = (*(**a2 + 176))();
  v13 = std::string::basic_string[abi:ne200100]<0>(v29, "rtp.mgr");
  v21[0] = 0;
  v24 = 0;
  v14 = ims::debug(v13, v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "handleMediaSessionDeactivated ", 30);
  *(v14 + 17) = 0;
  MEMORY[0x1E69233B0](*(v14 + 8), v12);
  *(v14 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), " result: ", 9);
  *(v14 + 17) = 0;
  if (a3)
  {
    v15 = "failed!";
  }

  else
  {
    v15 = "success!";
  }

  if (a3)
  {
    v16 = 7;
  }

  else
  {
    v16 = 8;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), v15, v16);
  *(v14 + 17) = 0;
  (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v14 + 17) = 0;
  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  v17 = a1[7];
  if (v17)
  {
    v18 = std::__shared_weak_count::lock(v17);
    if (v18)
    {
      v19 = v18;
      v20 = a1[6];
      if (v20)
      {
        (*(*v20 + 32))(v20, v12, a3 == 0);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v19);
    }
  }
}

uint64_t RTPManager::handleMediaSessionMediaError(uint64_t a1, void *a2, uint64_t a3)
{
  std::string::basic_string[abi:ne200100]<0>(v17, "rtp.mgr");
  v13[0] = 0;
  v16 = 0;
  v6 = ims::debug(v17, v13);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v7 = v6;
  v8 = *(*(*a1 - 8) + 8);
  v9 = *(v6 + 8);
  v10 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v8 & 0x7FFFFFFFFFFFFFFFLL, v10);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleMediaSessionMediaError", 28);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [session=", 10);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923310](*(v7 + 8), *a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " error=", 7);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923340](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v16 == 1 && v15 < 0)
  {
    operator delete(__p);
  }

  if (v18 < 0)
  {
    operator delete(v17[0]);
  }

  v11 = (*(**a2 + 176))();
  return (*(*a1 + 104))(a1, v11, a3);
}

void sub_1E512FFC0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::handleMediaSessionMediaError(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(v21, "rtp.mgr");
  v17[0] = 0;
  v20 = 0;
  v7 = ims::debug(v6, v17);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "handleMediaSessionMediaError ", 29);
  *(v7 + 17) = 0;
  MEMORY[0x1E69233B0](*(v7 + 8), a2);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v20 == 1 && v19 < 0)
  {
    operator delete(__p);
  }

  if (v22 < 0)
  {
    operator delete(v21[0]);
  }

  v8 = *(a1 + 56);
  if (v8)
  {
    v9 = std::__shared_weak_count::lock(v8);
    if (v9)
    {
      v10 = *(a1 + 48);
      if (v10)
      {
        (*(*v10 + 40))(v10, a2, a3);
LABEL_17:
        std::__shared_weak_count::__release_shared[abi:ne200100](v9);
        return;
      }
    }
  }

  else
  {
    v9 = 0;
  }

  v11 = std::string::basic_string[abi:ne200100]<0>(v21, "rtp.mgr");
  v13[0] = 0;
  v16 = 0;
  v12 = ims::error(v11, v13);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "handleMediaSessionError() does not have a delegate", 50);
  *(v12 + 17) = 0;
  (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v12 + 17) = 0;
  if (v16 == 1 && v15 < 0)
  {
    operator delete(v14);
  }

  if (v22 < 0)
  {
    operator delete(v21[0]);
  }

  if (v9)
  {
    goto LABEL_17;
  }
}

void RTPManager::sendInputFrequencyLevelUpdate(RTPManager *this, uint64_t a2, const __CFData *a3)
{
  v4 = *(this + 7);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(this + 6);
      if (v9)
      {
        (*(*v9 + 72))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void RTPManager::sendOutputFrequencyLevelUpdate(RTPManager *this, uint64_t a2, const __CFData *a3)
{
  v4 = *(this + 7);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(this + 6);
      if (v9)
      {
        (*(*v9 + 80))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void RTPManager::sendPortUpdate(void *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  std::string::basic_string[abi:ne200100]<0>(v21, "rtp.mgr");
  v17[0] = 0;
  v20 = 0;
  v8 = ims::debug(v21, v17);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v9 = v8;
  v10 = *(*(*a1 - 8) + 8);
  v11 = *(v8 + 8);
  v12 = strlen((v10 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, v10 & 0x7FFFFFFFFFFFFFFFLL, v12);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "::", 2);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "sendPortUpdate", 14);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), " [sessionId=", 12);
  *(v9 + 17) = 0;
  MEMORY[0x1E69233B0](*(v9 + 8), a2);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), " port=", 6);
  *(v9 + 17) = 0;
  MEMORY[0x1E6923390](*(v9 + 8), a3);
  *(v9 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "]", 1);
  *(v9 + 17) = 0;
  (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v9 + 17) = 0;
  if (v20 == 1 && v19 < 0)
  {
    operator delete(__p);
  }

  if (v22 < 0)
  {
    operator delete(v21[0]);
  }

  v13 = a1[7];
  if (v13)
  {
    v14 = std::__shared_weak_count::lock(v13);
    if (v14)
    {
      v15 = v14;
      v16 = a1[6];
      if (v16)
      {
        (*(*v16 + 88))(v16, a2, a3, a4);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v15);
    }
  }
}

void RTPManager::handoverStack(uint64_t a1, void **a2)
{
  v4 = std::string::basic_string[abi:ne200100]<0>(&v92, "rtp.mgr");
  v82[0] = 0;
  v85 = 0;
  v5 = ims::debug(v4, v82);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v6 = v5;
  v7 = *(*(*a1 - 8) + 8);
  v8 = *(v5 + 8);
  v9 = strlen((v7 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v8, v7 & 0x7FFFFFFFFFFFFFFFLL, v9);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "::", 2);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "handoverStack", 13);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " [stackId=", 10);
  *(v6 + 17) = 0;
  (*(*v6 + 32))(v6, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " isDeinit=", 10);
  *(v6 + 17) = 0;
  MEMORY[0x1E6923320](*(v6 + 8), 0);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "]", 1);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  if (v85 == 1 && v84 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v93) < 0)
  {
    operator delete(v92);
  }

  v10 = *(a1 + 56);
  if (v10)
  {
    v11 = std::__shared_weak_count::lock(v10);
    if (v11)
    {
      v12 = *(a1 + 48);
      if (v12)
      {
        v76 = 0;
        v77 = 0;
        (*(*v12 + 184))(&v76);
        if (v76)
        {
          v13 = SipStack::prefs(v76);
          ImsPrefs::MediaSessionHandoverTimeoutMilliseconds(v13);
          v69 = 0;
          v70 = 0;
          v71 = 0;
          (*(**(a1 + 152) + 80))(&v69);
          *&v92 = a2;
          v14 = std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, a2);
          v15 = *(v14 + 56);
          v68 = *(v14 + 56);
          v60 = a2;
          if (!v71)
          {
            v16 = std::string::basic_string[abi:ne200100]<0>(&v86, "rtp");
            LOBYTE(v92) = 0;
            v95 = 0;
            v17 = ims::debug(v16, &v92);
            v18 = *(*(*a1 - 8) + 8);
            v19 = strlen((v18 & 0x7FFFFFFFFFFFFFFFLL));
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), v18 & 0x7FFFFFFFFFFFFFFFLL, v19);
            *(v17 + 17) = 0;
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "::", 2);
            *(v17 + 17) = 0;
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "handoverComplete", 16);
            *(v17 + 17) = 0;
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), " Sending handover complete notification for stack type [stackId=", 64);
            *(v17 + 17) = 0;
            (*(*v17 + 32))(v17, v60);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), " stackType=", 11);
            *(v17 + 17) = 0;
            if (v15 == 2)
            {
              v20 = "baseband";
            }

            else
            {
              v20 = "avc";
            }

            if (v15 == 2)
            {
              v21 = 8;
            }

            else
            {
              v21 = 3;
            }

            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), v20, v21);
            *(v17 + 17) = 0;
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "]", 1);
            *(v17 + 17) = 0;
            (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v17 + 17) = 0;
            if (v95 == 1 && v94 < 0)
            {
              operator delete(v93);
            }

            if (SHIBYTE(v87) < 0)
            {
              operator delete(v86);
            }

            v22 = *(a1 + 56);
            if (v22)
            {
              v23 = std::__shared_weak_count::lock(v22);
              if (v23)
              {
                v24 = v23;
                v25 = *(a1 + 48);
                if (v25)
                {
                  v26 = *(v60 + 23);
                  if (v26 >= 0)
                  {
                    v27 = *(v60 + 23);
                  }

                  else
                  {
                    v27 = v60[1];
                  }

                  v28 = *(a1 + 367);
                  v29 = v28;
                  if ((v28 & 0x80u) != 0)
                  {
                    v28 = *(a1 + 352);
                  }

                  if (v27 == v28)
                  {
                    if (v26 >= 0)
                    {
                      v30 = v60;
                    }

                    else
                    {
                      v30 = *v60;
                    }

                    v31 = *(a1 + 344);
                    if (v29 >= 0)
                    {
                      v32 = (a1 + 344);
                    }

                    else
                    {
                      v32 = *(a1 + 344);
                    }

                    v33 = memcmp(v30, v32, v27) == 0;
                  }

                  else
                  {
                    v33 = 0;
                  }

                  (*(*v25 + 64))(v25, v60, v15, v33);
                }

                std::__shared_weak_count::__release_shared[abi:ne200100](v24);
              }
            }

            v38 = (a1 + 368);
            v39 = *(v60 + 23);
            if (v39 >= 0)
            {
              v40 = *(v60 + 23);
            }

            else
            {
              v40 = v60[1];
            }

            v41 = *(a1 + 391);
            v42 = v41;
            if ((v41 & 0x80u) != 0)
            {
              v41 = *(a1 + 376);
            }

            if (v40 == v41 && (v39 >= 0 ? (v43 = v60) : (v43 = *v60), (v44 = *v38, v42 >= 0) ? (v45 = (a1 + 368)) : (v45 = *v38), !memcmp(v43, v45, v40)))
            {
              v48 = std::string::basic_string[abi:ne200100]<0>(&v90, "rtp");
              LOBYTE(v86) = 0;
              v89 = 0;
              v47 = ims::debug(v48, &v86);
              std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v47 + 8), "Empty handover completed for ", 29);
              *(v47 + 17) = 0;
              (*(*v47 + 32))(v47, v60);
              (*(*v47 + 64))(v47, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            }

            else
            {
              v46 = std::string::basic_string[abi:ne200100]<0>(&v90, "rtp");
              LOBYTE(v86) = 0;
              v89 = 0;
              v47 = ims::error(v46, &v86);
              std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v47 + 8), "Empty handover completed for stack ", 35);
              *(v47 + 17) = 0;
              (*(*v47 + 32))(v47, v60);
              std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v47 + 8), " which is not currently being handed over ", 42);
              *(v47 + 17) = 0;
              (*(*v47 + 32))(v47, a1 + 368);
              (*(*v47 + 64))(v47, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            }

            *(v47 + 17) = 0;
            if (v89 == 1 && v88 < 0)
            {
              operator delete(v87);
            }

            a2 = v60;
            if (v91 < 0)
            {
              operator delete(v90);
            }

            if (*(a1 + 408))
            {
              std::string::operator=((a1 + 368), (*(a1 + 392) + 32));
              std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::erase((a1 + 392), *(a1 + 392));
              RTPManager::handoverStack(a1, a1 + 368);
            }

            else if (*(a1 + 391) < 0)
            {
              **(a1 + 368) = 0;
              *(a1 + 376) = 0;
            }

            else
            {
              *(a1 + 368) = 0;
              *(a1 + 391) = 0;
            }
          }

          v49 = std::string::basic_string[abi:ne200100]<0>(&v92, "rtp");
          v64[0] = 0;
          v67 = 0;
          v50 = ims::debug(v49, v64);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v50 + 8), "Performing handover for media sessions to stack [stackId=", 57);
          *(v50 + 17) = 0;
          (*(*v50 + 32))(v50, a2);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v50 + 8), " sessionCountOnStack=", 21);
          *(v50 + 17) = 0;
          MEMORY[0x1E6923370](*(v50 + 8), v71);
          *(v50 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v50 + 8), "]", 1);
          *(v50 + 17) = 0;
          (*(*v50 + 64))(v50, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v50 + 17) = 0;
          if (v67 == 1 && v66 < 0)
          {
            operator delete(v65);
          }

          if (SHIBYTE(v93) < 0)
          {
            operator delete(v92);
          }

          *&v92 = &v68;
          v51 = std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType const&>,std::tuple<>>(a1 + 184, &v68);
          v52 = v51[6];
          v59 = v51[5];
          if (v52)
          {
            atomic_fetch_add_explicit(&v52->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          v92 = 0uLL;
          v93 = 0;
          v53 = v70;
          if (v70 != &v69)
          {
            do
            {
              v54 = v53[2];
              v62 = 0;
              v63 = 0;
              (*(**(a1 + 152) + 24))(&v62);
              v55 = (*(*v62 + 184))(v62);
              v56 = *(*v62 + 192);
              if (v55)
              {
                v56();
                RTPSharedPointerBase::getShared<RTPManager>(&v61, a1);
                operator new();
              }

              v56();
              RTPManager::handoverComplete(a1, v54, 0, v68, a2);
              if (v63)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v63);
              }

              v53 = v53[1];
            }

            while (v53 != &v69);
            if (v92 != *(&v92 + 1))
            {
              v57 = *v92;
              v58 = *(v92 + 8);
              if (v58)
              {
                atomic_fetch_add_explicit((v58 + 8), 1uLL, memory_order_relaxed);
              }

              MediaSessionHandover::handover(v57);
            }
          }

          v86 = &v92;
          std::vector<std::shared_ptr<IMSCallInfo>>::__destroy_vector::operator()[abi:ne200100](&v86);
          if (v52)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v52);
          }

          std::__list_imp<unsigned long long>::clear(&v69);
        }

        else
        {
          v36 = std::string::basic_string[abi:ne200100]<0>(&v92, "rtp.mgr");
          v72[0] = 0;
          v75 = 0;
          v37 = ims::error(v36, v72);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v37 + 8), "SipStack is null", 16);
          *(v37 + 17) = 0;
          (*(*v37 + 64))(v37, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v37 + 17) = 0;
          if (v75 == 1 && v74 < 0)
          {
            operator delete(v73);
          }

          if (SHIBYTE(v93) < 0)
          {
            operator delete(v92);
          }
        }

        if (v77)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v77);
        }

        goto LABEL_100;
      }
    }
  }

  else
  {
    v11 = 0;
  }

  v34 = std::string::basic_string[abi:ne200100]<0>(&v92, "rtp.mgr");
  v78[0] = 0;
  v81 = 0;
  v35 = ims::error(v34, v78);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v35 + 8), "RTPManagerDelegate is null", 26);
  *(v35 + 17) = 0;
  (*(*v35 + 64))(v35, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v35 + 17) = 0;
  if (v81 == 1 && v80 < 0)
  {
    operator delete(v79);
  }

  if (SHIBYTE(v93) < 0)
  {
    operator delete(v92);
  }

LABEL_100:
  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }
}

void sub_1E51314C4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, void *a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, void *__p, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, uint64_t a43)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  std::__list_imp<unsigned long long>::clear(&a32);
  if (a43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a43);
  }

  if (v44)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  }

  _Unwind_Resume(a1);
}

void RTPManager::handoverComplete(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4, uint64_t a5)
{
  v9 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp");
  v164[0] = 0;
  v167 = 0;
  v10 = ims::debug(v9, v164);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v11 = v10;
  v12 = *(*(*a1 - 8) + 8);
  v13 = *(v10 + 8);
  v14 = strlen((v12 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v13, v12 & 0x7FFFFFFFFFFFFFFFLL, v14);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "::", 2);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "handoverComplete", 16);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), " Session completed handover [sessionId=", 39);
  *(v11 + 17) = 0;
  MEMORY[0x1E69233B0](*(v11 + 8), a2);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), " stackId=", 9);
  *(v11 + 17) = 0;
  (*(*v11 + 32))(v11, a5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), " stackType=", 11);
  *(v11 + 17) = 0;
  if (a4 == 2)
  {
    v15 = "baseband";
  }

  else
  {
    v15 = "avc";
  }

  if (a4 == 2)
  {
    v16 = 8;
  }

  else
  {
    v16 = 3;
  }

  v107 = v16;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), v15, v16);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "]", 1);
  *(v11 + 17) = 0;
  (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v11 + 17) = 0;
  if (v167 == 1 && v166 < 0)
  {
    operator delete(v165);
  }

  if (SHIBYTE(v170) < 0)
  {
    operator delete(v168);
  }

  v162 = 0;
  v163 = 0;
  (*(**(a1 + 152) + 24))(&v168);
  {
    v162 = v18;
    v163 = v169;
    v19 = &v168;
  }

  else
  {
    v19 = &v162;
  }

  *v19 = 0;
  v19[1] = 0;
  if (v169)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v169);
  }

  v20 = v162;
  v106 = v15;
  if (v162)
  {
    v21 = v162[16];
    if (v21)
    {
      v22 = v162[15];
      atomic_fetch_add_explicit(&v21->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v23 = std::__shared_weak_count::lock(v21);
      if (v23)
      {
        v24 = v22;
      }

      else
      {
        v24 = 0;
      }

      std::__shared_weak_count::__release_weak(v21);
    }

    else
    {
      v24 = 0;
      v23 = 0;
    }

    (*(**(a1 + 152) + 32))(&v156);
    if (v157)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v157);
    }

    if (v24)
    {
      RTPSharedPointerBase::getShared<RTPManager>(&v168, a1);
      v29 = v169;
      if (v168)
      {
        v30 = v168 + 16;
      }

      else
      {
        v30 = 0;
      }

      v154 = v30;
      v155 = v169;
      if (v169)
      {
        atomic_fetch_add_explicit(&v169->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*v24 + 160))(v24, &v154);
      if (v155)
      {
        std::__shared_weak_count::__release_weak(v155);
      }

      if (v29)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v29);
      }

      v31 = *(a1 + 152);
      v150 = v24;
      v151 = v23;
      if (v23)
      {
        atomic_fetch_add_explicit(&v23->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*v31 + 16))(&v152);
      if (v153)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v153);
      }

      if (v151)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v151);
      }
    }

    else
    {
      v32 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
      v146[0] = 0;
      v149 = 0;
      v33 = ims::warn(v32, v146);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v33 + 8), "Session that completed handover does not have a valid queued interface [sessionId=", 82);
      *(v33 + 17) = 0;
      MEMORY[0x1E69233B0](*(v33 + 8), a2);
      *(v33 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v33 + 8), "]", 1);
      *(v33 + 17) = 0;
      (*(*v33 + 64))(v33, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v33 + 17) = 0;
      if (v149 == 1 && v148 < 0)
      {
        operator delete(v147);
      }

      if (SHIBYTE(v170) < 0)
      {
        operator delete(v168);
      }
    }

    v34 = (*(*v20 + 104))(v20);
    v35 = *(a1 + 72);
    if (!v35)
    {
      goto LABEL_61;
    }

    v36 = a1 + 72;
    do
    {
      if (*(v35 + 32) >= v34)
      {
        v36 = v35;
      }

      v35 = *(v35 + 8 * (*(v35 + 32) < v34));
    }

    while (v35);
    if (v36 != a1 + 72 && *(v36 + 32) <= v34)
    {
      v37 = *(v36 + 40);
      if (a3)
      {
        goto LABEL_70;
      }
    }

    else
    {
LABEL_61:
      v37 = 0;
      if (a3)
      {
        goto LABEL_70;
      }
    }

    if (v37 != a2)
    {
      v38 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
      v142[0] = 0;
      v145 = 0;
      v39 = ims::debug(v38, v142);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v39 + 8), "Unblock queued actions for non-active session [sessionId=", 57);
      *(v39 + 17) = 0;
      MEMORY[0x1E69233B0](*(v39 + 8), a2);
      *(v39 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v39 + 8), "]", 1);
      *(v39 + 17) = 0;
      (*(*v39 + 64))(v39, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v39 + 17) = 0;
      if (v145 == 1 && v144 < 0)
      {
        operator delete(v143);
      }

      if (SHIBYTE(v170) < 0)
      {
        operator delete(v168);
      }

      (*(*v20 + 192))(v20);
      goto LABEL_74;
    }

LABEL_70:
    if (a3 == 12)
    {
      v140 = v24;
      v141 = v23;
      if (v23)
      {
        atomic_fetch_add_explicit(&v23->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*a1 + 64))(a1, &v140, 12);
      v40 = v141;
      goto LABEL_83;
    }

LABEL_74:
    v41 = *(a1 + 56);
    if (v41)
    {
      v41 = std::__shared_weak_count::lock(v41);
      v40 = v41;
      if (v41)
      {
        v41 = *(a1 + 48);
      }

      if (!a3)
      {
        goto LABEL_83;
      }
    }

    else
    {
      v40 = 0;
      if (!a3)
      {
LABEL_83:
        if (v40)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v40);
        }

        if (v23)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v23);
        }

        goto LABEL_87;
      }
    }

    if (a3 != 11 && v41)
    {
      (v41->__vftable[1].~__shared_weak_count)(v41, a2, a3);
    }

    goto LABEL_83;
  }

  v25 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp");
  v158[0] = 0;
  v161 = 0;
  v26 = ims::warn(v25, v158);
  v27 = *(*(*a1 - 8) + 8);
  v28 = strlen((v27 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), v27 & 0x7FFFFFFFFFFFFFFFLL, v28);
  *(v26 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "::", 2);
  *(v26 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "handoverComplete", 16);
  *(v26 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), " handover completed for non-handover session", 44);
  *(v26 + 17) = 0;
  (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v26 + 17) = 0;
  if (v161 == 1 && v160 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v170) < 0)
  {
    operator delete(v168);
  }

LABEL_87:
  v42 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
  v136[0] = 0;
  v139 = 0;
  v43 = ims::debug(v42, v136);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v43 + 8), "Checking if all sessions have completed handover [stackId=", 58);
  *(v43 + 17) = 0;
  (*(*v43 + 32))(v43, a5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v43 + 8), "]", 1);
  *(v43 + 17) = 0;
  (*(*v43 + 64))(v43, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v43 + 17) = 0;
  if (v139 == 1 && v138 < 0)
  {
    operator delete(v137);
  }

  if (SHIBYTE(v170) < 0)
  {
    operator delete(v168);
  }

  v133 = 0;
  v134 = 0;
  v135 = 0;
  (*(**(a1 + 152) + 80))(&v133);
  v44 = v134;
  if (v134 == &v133)
  {
    goto LABEL_113;
  }

  v104 = a2;
  v105 = a5;
  LOBYTE(v45) = 1;
  do
  {
    v46 = v44[2];
    v173 = 0;
    v174 = 0;
    (*(**(a1 + 152) + 24))(&v173);
    {
      v49 = v48;
      v45 = v174;
      if (v174)
      {
        atomic_fetch_add_explicit(&v174->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      v50 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
      v129[0] = 0;
      v132 = 0;
      v51 = ims::debug(v50, v129);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v51 + 8), "Session has not completed handover yet [sessionId=", 50);
      *(v51 + 17) = 0;
      MEMORY[0x1E69233B0](*(v51 + 8), v46);
      *(v51 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v51 + 8), "]", 1);
      *(v51 + 17) = 0;
      (*(*v51 + 64))(v51, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v51 + 17) = 0;
      if (v132 == 1 && v131 < 0)
      {
        operator delete(v130);
      }

      if (SHIBYTE(v170) < 0)
      {
        operator delete(v168);
      }

      v52 = v49[512];
      if (v52 == 1)
      {
        MediaSessionHandover::cancelTimerForDelayedStackSwitch(v49, 1);
      }

      v53 = v52 ^ 1;
      if (v45)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v45);
        LOBYTE(v45) = 0;
      }
    }

    else
    {
      v53 = 1;
    }

    if (v174)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v174);
    }

    if (!v53)
    {
      break;
    }

    v44 = v44[1];
  }

  while (v44 != &v133);
  a2 = v104;
  a5 = v105;
  if (v45)
  {
LABEL_113:
    v54 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
    v125[0] = 0;
    v128 = 0;
    v55 = ims::debug(v54, v125);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v55 + 8), "All sessions completed handover", 31);
    *(v55 + 17) = 0;
    (*(*v55 + 64))(v55, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v55 + 17) = 0;
    if (v128 == 1 && v127 < 0)
    {
      operator delete(v126);
    }

    if (SHIBYTE(v170) < 0)
    {
      operator delete(v168);
    }

    v56 = v162;
    if (v162)
    {
      v57 = (*(*v162 + 104))(v162);
      v58 = *(a1 + 72);
      if (!v58)
      {
        goto LABEL_126;
      }

      v59 = a1 + 72;
      do
      {
        if (*(v58 + 32) >= v57)
        {
          v59 = v58;
        }

        v58 = *(v58 + 8 * (*(v58 + 32) < v57));
      }

      while (v58);
      if (v59 != a1 + 72 && *(v59 + 32) <= v57)
      {
        v60 = *(v59 + 40);
      }

      else
      {
LABEL_126:
        v60 = 0;
      }

      if (v60 == a2)
      {
        v61 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp.mgr");
        v121[0] = 0;
        v124 = 0;
        v62 = ims::debug(v61, v121);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v62 + 8), "Unblock queued actions for active session [sessionId=", 53);
        *(v62 + 17) = 0;
        MEMORY[0x1E69233B0](*(v62 + 8), a2);
        *(v62 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v62 + 8), "]", 1);
        *(v62 + 17) = 0;
        (*(*v62 + 64))(v62, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v62 + 17) = 0;
        if (v124 == 1 && v123 < 0)
        {
          operator delete(v122);
        }

        if (SHIBYTE(v170) < 0)
        {
          operator delete(v168);
        }

        (*(*v56 + 192))(v56);
      }
    }

    v63 = std::string::basic_string[abi:ne200100]<0>(&v173, "rtp.mgr");
    LOBYTE(v168) = 0;
    v172 = 0;
    v64 = ims::debug(v63, &v168);
    v65 = *(*(*a1 - 8) + 8);
    v66 = strlen((v65 & 0x7FFFFFFFFFFFFFFFLL));
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), v65 & 0x7FFFFFFFFFFFFFFFLL, v66);
    *(v64 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), "::", 2);
    *(v64 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), "cleanupNonActiveStackControllers", 32);
    *(v64 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), " [stackId=", 10);
    *(v64 + 17) = 0;
    (*(*v64 + 32))(v64, a5);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v64 + 8), "]", 1);
    *(v64 + 17) = 0;
    (*(*v64 + 64))(v64, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v64 + 17) = 0;
    if (v172 == 1 && v171 < 0)
    {
      operator delete(v170);
    }

    if (v175 < 0)
    {
      operator delete(v173);
    }

    v67 = *(a1 + 184);
    if (v67 != (a1 + 192))
    {
      do
      {
        v68 = v67[5];
        if (v68)
        {
          v69 = *(v68 + 64);
          v70 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(a1 + 280, a5);
          v71 = a1 + 288 == v70 ? 0 : *(v70 + 56);
          if (v69 != v71)
          {
            (*(*v67[5] + 40))(v67[5], a5);
          }
        }

        v72 = v67[1];
        if (v72)
        {
          do
          {
            v73 = v72;
            v72 = *v72;
          }

          while (v72);
        }

        else
        {
          do
          {
            v73 = v67[2];
            v74 = *v73 == v67;
            v67 = v73;
          }

          while (!v74);
        }

        v67 = v73;
      }

      while (v73 != (a1 + 192));
    }

    v75 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp");
    v117[0] = 0;
    v120 = 0;
    v76 = ims::debug(v75, v117);
    v77 = *(*(*a1 - 8) + 8);
    v78 = strlen((v77 & 0x7FFFFFFFFFFFFFFFLL));
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), v77 & 0x7FFFFFFFFFFFFFFFLL, v78);
    *(v76 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), "::", 2);
    *(v76 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), "handoverComplete", 16);
    *(v76 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), " Sending handover complete notification for stack type [stackId=", 64);
    *(v76 + 17) = 0;
    (*(*v76 + 32))(v76, a5);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), " stackType=", 11);
    *(v76 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), v106, v107);
    *(v76 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v76 + 8), "]", 1);
    *(v76 + 17) = 0;
    (*(*v76 + 64))(v76, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v76 + 17) = 0;
    if (v120 == 1 && v119 < 0)
    {
      operator delete(v118);
    }

    if (SHIBYTE(v170) < 0)
    {
      operator delete(v168);
    }

    v79 = *(a1 + 56);
    if (v79)
    {
      v80 = std::__shared_weak_count::lock(v79);
      if (v80)
      {
        v81 = v80;
        v82 = *(a1 + 48);
        if (v82)
        {
          v83 = *(a5 + 23);
          if (v83 >= 0)
          {
            v84 = *(a5 + 23);
          }

          else
          {
            v84 = *(a5 + 8);
          }

          v85 = *(a1 + 367);
          v86 = v85;
          if ((v85 & 0x80u) != 0)
          {
            v85 = *(a1 + 352);
          }

          if (v84 == v85)
          {
            if (v83 >= 0)
            {
              v87 = a5;
            }

            else
            {
              v87 = *a5;
            }

            v88 = *(a1 + 344);
            if (v86 >= 0)
            {
              v89 = (a1 + 344);
            }

            else
            {
              v89 = *(a1 + 344);
            }

            v90 = memcmp(v87, v89, v84) == 0;
          }

          else
          {
            v90 = 0;
          }

          (*(*v82 + 64))(v82, a5, a4, v90);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v81);
      }
    }

    v91 = (a1 + 368);
    v92 = *(a5 + 23);
    if (v92 >= 0)
    {
      v93 = *(a5 + 23);
    }

    else
    {
      v93 = *(a5 + 8);
    }

    v94 = *(a1 + 391);
    v95 = v94;
    if ((v94 & 0x80u) != 0)
    {
      v94 = *(a1 + 376);
    }

    if (v93 == v94 && (v92 >= 0 ? (v96 = a5) : (v96 = *a5), (v97 = *v91, v95 >= 0) ? (v98 = (a1 + 368)) : (v98 = *v91), !memcmp(v96, v98, v93)))
    {
      v102 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp");
      v113[0] = 0;
      v116 = 0;
      v103 = ims::debug(v102, v113);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v103 + 8), "Handover completed for ", 23);
      *(v103 + 17) = 0;
      (*(*v103 + 32))(v103, a5);
      (*(*v103 + 64))(v103, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v103 + 17) = 0;
      if (v116 != 1 || (v115 & 0x80000000) == 0)
      {
        goto LABEL_194;
      }

      v101 = v114;
    }

    else
    {
      v99 = std::string::basic_string[abi:ne200100]<0>(&v168, "rtp");
      v109[0] = 0;
      v112 = 0;
      v100 = ims::error(v99, v109);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v100 + 8), "Handover completed for stack ", 29);
      *(v100 + 17) = 0;
      (*(*v100 + 32))(v100, a5);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v100 + 8), " which is not currently being handed over ", 42);
      *(v100 + 17) = 0;
      (*(*v100 + 32))(v100, a1 + 368);
      (*(*v100 + 64))(v100, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v100 + 17) = 0;
      if (v112 != 1 || (v111 & 0x80000000) == 0)
      {
        goto LABEL_194;
      }

      v101 = v110;
    }

    operator delete(v101);
LABEL_194:
    if (SHIBYTE(v170) < 0)
    {
      operator delete(v168);
    }

    if (*(a1 + 408))
    {
      std::string::operator=((a1 + 368), (*(a1 + 392) + 32));
      std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::erase((a1 + 392), *(a1 + 392));
      RTPManager::handoverStack(a1, a1 + 368);
    }

    else if (*(a1 + 391) < 0)
    {
      **(a1 + 368) = 0;
      *(a1 + 376) = 0;
    }

    else
    {
      *(a1 + 368) = 0;
      *(a1 + 391) = 0;
    }
  }

  std::__list_imp<unsigned long long>::clear(&v133);
  if (v163)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v163);
  }
}

void sub_1E5132B6C(_Unwind_Exception *a1)
{
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  v5 = *(v3 - 232);
  if (v5)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }

  _Unwind_Resume(a1);
}

void RTPSharedPointerBase::getShared<RTPManager>(void **p_lpsrc, void *a2)
{
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&lpsrc, (a2 + *(*a2 - 24) + 8));
  if (lpsrc)
  {
    v3 = **lpsrc;
    if (v4)
    {
      v5 = v7;
      *p_lpsrc = v4;
      p_lpsrc[1] = v5;
      p_lpsrc = &lpsrc;
    }
  }

  *p_lpsrc = 0;
  p_lpsrc[1] = 0;
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void RTPManager::processDataFromSocket(uint64_t a1, uint64_t a2, unint64_t a3, void *a4)
{
  std::string::basic_string[abi:ne200100]<0>(__p, "rtp");
  v28[0] = 0;
  v31 = 0;
  v7 = ims::warn(__p, v28);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "RTPManager::processDataFromSocket received unexpected data with ", 64);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923370](*(v7 + 8), a3);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " bytes from: ", 13);
  *(v7 + 17) = 0;
  if (*a4)
  {
    (*(**a4 + 40))(*a4, v7);
  }

  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v31 == 1 && v30 < 0)
  {
    operator delete(v29);
  }

  if (SHIBYTE(v20[0].__locale_) < 0)
  {
    operator delete(__p[0]);
  }

  v26 = 0uLL;
  v27 = 0;
  std::string::basic_string[abi:ne200100]<0>(&v26, &str_2_23);
  if (a3 >= 0xC)
  {
    v25 = 0;
    v23 = 0u;
    memset(v24, 0, sizeof(v24));
    *v21 = 0u;
    v22 = 0u;
    *__p = 0u;
    memset(v20, 0, sizeof(v20));
    std::ostringstream::basic_ostringstream[abi:ne200100](__p);
    for (i = 0; i != 12; ++i)
    {
      v9 = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(__p, "0x", 2);
      *(v9 + *(*v9 - 24) + 8) = *(v9 + *(*v9 - 24) + 8) & 0xFFFFFFB5 | 8;
      v10 = *(a2 + i);
      v11 = MEMORY[0x1E6923340]();
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, " ", 1);
    }

    std::ostringstream::str[abi:ne200100](__p, &v17);
    if (SHIBYTE(v27) < 0)
    {
      operator delete(v26);
    }

    v26 = v17;
    v27 = v18;
    __p[0] = *MEMORY[0x1E69E54E8];
    *(__p + *(__p[0] - 3)) = *(MEMORY[0x1E69E54E8] + 24);
    __p[1] = (MEMORY[0x1E69E5548] + 16);
    if (SHIBYTE(v22) < 0)
    {
      operator delete(v21[1]);
    }

    __p[1] = (MEMORY[0x1E69E5538] + 16);
    std::locale::~locale(v20);
    std::ostream::~ostream();
    MEMORY[0x1E6923510](v24);
  }

  if (SHIBYTE(v27) < 0)
  {
    if (!*(&v26 + 1))
    {
LABEL_26:
      operator delete(v26);
      return;
    }
  }

  else if (!HIBYTE(v27))
  {
    return;
  }

  std::string::basic_string[abi:ne200100]<0>(__p, "rtp");
  v13[0] = 0;
  v16 = 0;
  v12 = ims::warn(__p, v13);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "First 12 Bytes: ", 16);
  *(v12 + 17) = 0;
  (*(*v12 + 32))(v12, &v26);
  (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v12 + 17) = 0;
  if (v16 == 1 && v15 < 0)
  {
    operator delete(v14);
  }

  if (SHIBYTE(v20[0].__locale_) < 0)
  {
    operator delete(__p[0]);
  }

  if (SHIBYTE(v27) < 0)
  {
    goto LABEL_26;
  }
}

void sub_1E513331C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, uint64_t a21, void *a22, uint64_t a23, int a24, __int16 a25, char a26, char a27)
{
  std::ostringstream::~ostringstream(&a22);
  if (*(v27 - 105) < 0)
  {
    operator delete(*(v27 - 128));
  }

  _Unwind_Resume(a1);
}

void RTPManager::processDataFromNw(RTPManager *this, uint64_t a2)
{
  v3 = std::string::basic_string[abi:ne200100]<0>(&v9, "rtp.mgr");
  v5[0] = 0;
  v8 = 0;
  v4 = ims::warn(v3, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "processDataFromNw", 17);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), " received unexpected data with ", 31);
  *(v4 + 17) = 0;
  MEMORY[0x1E6923370](*(v4 + 8), a2);
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v8 == 1 && v7 < 0)
  {
    operator delete(__p);
  }

  if (v10 < 0)
  {
    operator delete(v9);
  }
}

void sub_1E51334AC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (*(v18 - 17) < 0)
  {
    operator delete(*(v18 - 40));
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::reportCodecForSessionId(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 56);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 48);
      if (v9)
      {
        if (*(a3 + 23) < 0)
        {
          std::string::__init_copy_ctor_external(&__p, *a3, *(a3 + 8));
        }

        else
        {
          __p = *a3;
        }

        (*(*v9 + 152))(v9, a2, &__p);
        if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(__p.__r_.__value_.__l.__data_);
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void RTPManager::interfaceForSession(RTPManager *this@<X0>, void *a2@<X8>)
{
  *a2 = 0;
  a2[1] = 0;
  a2[2] = 0;
  v3 = *(this + 7);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(this + 6);
      if (v7)
      {
        (*(*v7 + 128))(&v8);
        *a2 = v8;
        a2[2] = v9;
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void RTPManager::addressForSession(RTPManager *this@<X0>, uint64_t a2@<X1>, void *a3@<X8>)
{
  v5 = *(this + 7);
  if (!v5)
  {
    goto LABEL_8;
  }

  v7 = std::__shared_weak_count::lock(v5);
  if (!v7)
  {
    goto LABEL_8;
  }

  v8 = v7;
  v9 = *(this + 6);
  if (!v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
LABEL_8:
    *a3 = 0;
    a3[1] = 0;
    return;
  }

  (*(*v9 + 136))(v9, a2);

  std::__shared_weak_count::__release_shared[abi:ne200100](v8);
}

void RTPManager::iterationComplete(void *a1@<X0>, void *a2@<X1>, char ***a3@<X8>)
{
  std::string::basic_string[abi:ne200100]<0>(v25, "rtp.mgr");
  v21[0] = 0;
  v24 = 0;
  v6 = ims::debug(v25, v21);
  if (!a1)
  {
    __cxa_bad_typeid();
  }

  v7 = v6;
  v8 = *(*(*a1 - 8) + 8);
  v9 = *(v6 + 8);
  v10 = strlen((v8 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v8 & 0x7FFFFFFFFFFFFFFFLL, v10);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "::", 2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "iterationComplete", 17);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " [collection=", 13);
  *(v7 + 17) = 0;
  MEMORY[0x1E6923310](*(v7 + 8), *a2);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v24 == 1 && v23 < 0)
  {
    operator delete(__p);
  }

  if (v26 < 0)
  {
    operator delete(v25[0]);
  }

  RTPSharedPointerBase::getShared<MediaSessionCollectionIterator>(a1, v25);
  v11 = *a2;
  v12 = v25[0];
  if (v25[1])
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v25[1]);
  }

  if (v11 != v12)
  {
    RTPSharedPointerBase::getShared<MediaSessionCollectionIterator>(a1, v25);
    v13 = a1[19];
    v14 = v25[0];
    if (v25[1])
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v25[1]);
    }

    if (v13 != v14)
    {
      v15 = a1[19];
      v16 = a2[1];
      v19 = *a2;
      v20 = v16;
      if (v16)
      {
        atomic_fetch_add_explicit(&v16->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*v15 + 88))(v25);
      v17 = *v25;
      v25[0] = 0;
      v25[1] = 0;
      v18 = a1[20];
      *(a1 + 19) = v17;
      if (v18)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v18);
        if (v25[1])
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v25[1]);
        }
      }

      if (v20)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v20);
      }
    }
  }

  RTPSharedPointerBase::getShared<MediaSessionCollectionIterator>(a1, a3);
}

void sub_1E5133998(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, std::__shared_weak_count *a11, uint64_t a12, uint64_t a13, void *__p, uint64_t a15, int a16, __int16 a17, char a18, char a19, uint64_t a20, char a21, void *a22, uint64_t a23, int a24, __int16 a25, char a26, char a27)
{
  if (a11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a11);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::srvccHandoverStarted(uint64_t a1, uint64_t a2)
{
  v4 = std::string::basic_string[abi:ne200100]<0>(v33, "rtp.mgr");
  v29[0] = 0;
  v32 = 0;
  v5 = ims::debug(v4, v29);
  if (a1)
  {
    v6 = v5;
    v7 = *(*(*a1 - 8) + 8);
    v8 = *(v5 + 8);
    v9 = strlen((v7 & 0x7FFFFFFFFFFFFFFFLL));
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v8, v7 & 0x7FFFFFFFFFFFFFFFLL, v9);
    *(v6 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "::", 2);
    *(v6 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "srvccHandoverStarted", 20);
    *(v6 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), " [stackId=", 10);
    *(v6 + 17) = 0;
    (*(*v6 + 32))(v6, a2);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "]", 1);
    *(v6 + 17) = 0;
    (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v6 + 17) = 0;
    if (v32 == 1 && v31 < 0)
    {
      operator delete(__p);
    }

    if (v34 < 0)
    {
      operator delete(v33[0]);
    }

    v10 = *(a1 + 391);
    if (v10 >= 0)
    {
      v11 = *(a1 + 391);
    }

    else
    {
      v11 = *(a1 + 376);
    }

    v12 = *(a2 + 23);
    v13 = v12;
    if ((v12 & 0x80u) != 0)
    {
      v12 = *(a2 + 8);
    }

    if (v11 == v12)
    {
      v14 = v10 >= 0 ? (a1 + 368) : *(a1 + 368);
      v15 = *a2;
      v16 = v13 >= 0 ? a2 : *a2;
      if (!memcmp(v14, v16, v11))
      {
        v17 = std::string::basic_string[abi:ne200100]<0>(v33, "rtp.mgr");
        v25[0] = 0;
        v28 = 0;
        v18 = ims::warn(v17, v25);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), " SRVCC handover started while RTP handover is in progress. Aborting RTP handover for [stackId=", 94);
        *(v18 + 17) = 0;
        (*(*v18 + 32))(v18, a2);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "]", 1);
        *(v18 + 17) = 0;
        (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v18 + 17) = 0;
        if (v28 == 1 && v27 < 0)
        {
          operator delete(v26);
        }

        if (v34 < 0)
        {
          operator delete(v33[0]);
        }

        (*(**(a1 + 152) + 80))(v33);
        for (i = v33[1]; i != v33; i = i[1])
        {
          v20 = i[2];
          v24 = a2;
          v21 = std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 280, a2);
          RTPManager::handoverComplete(a1, v20, 11, *(v21 + 56), a2);
        }

        std::__list_imp<unsigned long long>::clear(v33);
      }
    }

    v22 = (a1 + 64);
    if (*(a1 + 308) == 2)
    {
      RTPActiveSessionSet::active(&v24, v22);
      RTPSharedPointerBase::getShared<RTPManager>(&v23, a1);
      operator new();
    }

    RTPActiveSessionSet::active(&v24, v22);
    RTPSharedPointerBase::getShared<RTPManager>(&v23, a1);
    operator new();
  }

  __cxa_bad_typeid();
}

void sub_1E5133FE0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, char a12, void *a13, uint64_t a14, uint64_t a15, uint64_t a16, void *__p, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, int a29, __int16 a30, char a31, char a32, uint64_t a33, char a34)
{
  v37 = *(v35 - 104);
  if (v37)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v37);
  }

  std::__tree<unsigned int>::destroy(v35 - 88, *(v35 - 80));
  v38 = *(v35 - 56);
  if (v38)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  }

  std::__shared_weak_count::~__shared_weak_count(v34);
  operator delete(v39);
  std::__tree<unsigned int>::destroy(&a12, a13);
  _Unwind_Resume(a1);
}

void RTPManager::srvccHandoverFailed(RTPManager *this)
{
  std::string::basic_string[abi:ne200100]<0>(v13, "rtp.mgr");
  v9[0] = 0;
  v12 = 0;
  v2 = ims::debug(v13, v9);
  if (!this)
  {
    __cxa_bad_typeid();
  }

  v3 = v2;
  v4 = *(*(*this - 8) + 8);
  v5 = *(v2 + 8);
  v6 = strlen((v4 & 0x7FFFFFFFFFFFFFFFLL));
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, v4 & 0x7FFFFFFFFFFFFFFFLL, v6);
  *(v3 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "::", 2);
  *(v3 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "srvccHandoverFailed", 19);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v12 == 1 && v11 < 0)
  {
    operator delete(__p);
  }

  if (v14 < 0)
  {
    operator delete(v13[0]);
  }

  v7 = *(this + 21);
  if (v7)
  {
    (*(*v7 + 104))(v7);
    v8 = *(this + 22);
    *(this + 21) = 0;
    *(this + 22) = 0;
    if (v8)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }

  if (*(this + 51))
  {
    std::string::operator=((this + 368), (*(this + 49) + 32));
    std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::erase(this + 49, *(this + 49));
    RTPManager::handoverStack(this, this + 46);
  }
}

void sub_1E5134254(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::srvccHandoverCompleted(RTPManager *this)
{
  v2 = std::string::basic_string[abi:ne200100]<0>(&v13, "rtp.mgr");
  v9[0] = 0;
  v12 = 0;
  v3 = ims::debug(v2, v9);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "RTPManager::srvccHandoverCompleted()", 36);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v12 == 1 && v11 < 0)
  {
    operator delete(__p);
  }

  if (v14 < 0)
  {
    operator delete(v13);
  }

  v4 = *(this + 21);
  if (v4)
  {
    (*(*v4 + 112))(v4);
    v5 = *(this + 22);
    *(this + 21) = 0;
    *(this + 22) = 0;
    if (v5)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v5);
    }
  }

  if (*(this + 51))
  {
    std::string::operator=((this + 368), (*(this + 49) + 32));
    std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::erase(this + 49, *(this + 49));
    v6 = dispatch_time(0, 200000000);
    v7 = *(this + 39);
    if (v7)
    {
      dispatch_retain(*(this + 39));
    }

    block[0] = MEMORY[0x1E69E9820];
    block[1] = 0x40000000;
    block[2] = ___ZN10RTPManager22srvccHandoverCompletedEv_block_invoke;
    block[3] = &__block_descriptor_tmp_28;
    block[4] = this;
    dispatch_after(v6, v7, block);
    if (v7)
    {
      dispatch_release(v7);
    }
  }
}

void sub_1E5134448(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, void *__p, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24)
{
  if (a24 == 1 && a22 < 0)
  {
    operator delete(__p);
  }

  if (*(v24 - 33) < 0)
  {
    operator delete(*(v24 - 56));
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::logRTPError(RTPManager *this, uint64_t a2)
{
  v3 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v4 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v3);
  }

  v5 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  AnalyticsLogger::logRTPError(*(v4 + 184), a2);
  if (v5)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }
}

void RTPManager::logCodec(RTPManager *this, __int16 a2, __int16 a3)
{
  v5 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v6 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v5);
  }

  v7 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v8 = *(v6 + 184);
  *(v8 + 536) = a2;
  *(v8 + 538) = a3;
  if (v7)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void RTPManager::logRemoteRTCPRRPacket(RTPManager *this, const RTCPRRPacket *a2, int a3)
{
  v5 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v6 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v5);
  }

  v7 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  AnalyticsLogger::logRemoteRTCPRRPacket(*(v6 + 184), a2, a3);
  if (v7)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void RTPManager::logLocalRTCPRRPacket(RTPManager *this, const RTCPRRPacket *a2, int a3)
{
  v5 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v6 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v5);
  }

  v7 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  AnalyticsLogger::logLocalRTCPRRPacket(*(v6 + 184), a2, a3);
  if (v7)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void RTPManager::logSdesRTCPTime(RTPManager *this)
{
  v1 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v2 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v1);
  }

  v3 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v4 = *(v2 + 184);
  *(v4 + 584) = time(0);
  if (v3)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }
}

void RTPManager::logRemoteRTCPSRPacket(RTPManager *this, const RTCPSRPacket *a2)
{
  v3 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v4 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v3);
  }

  v5 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  AnalyticsLogger::logRemoteRTCPSRPacket(*(v4 + 184), a2);
  if (v5)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }
}

void RTPManager::logLocalRTCPSRPacket(RTPManager *this, const RTCPSRPacket *a2)
{
  v3 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v4 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v3);
  }

  v5 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v6 = *(v4 + 184);
  *(v6 + 592) = time(0);
  v7 = 312;
  if (*(v6 + 192))
  {
    v7 = 368;
  }

  AnalyticsLogger::processRTCPSRPacket(v6, a2, v6 + v7);
  if (v5)
  {

    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }
}

void RTPManager::registerAudioReadyHandler(void *a1, uint64_t *a2)
{
  v3 = a2[1];
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *a2;
      if (v7)
      {
        atomic_fetch_add_explicit(&v5->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v9 = a1[53];
        v8 = a1[54];
        if (v9 >= v8)
        {
          v11 = a1[52];
          v12 = v9 - v11;
          v13 = (v9 - v11) >> 4;
          v14 = v13 + 1;
          if ((v13 + 1) >> 60)
          {
            std::vector<std::shared_ptr<MediaSessionHandover>>::__throw_length_error[abi:ne200100]();
          }

          v15 = v8 - v11;
          if (v15 >> 3 > v14)
          {
            v14 = v15 >> 3;
          }

          v16 = v15 >= 0x7FFFFFFFFFFFFFF0;
          v17 = 0xFFFFFFFFFFFFFFFLL;
          if (!v16)
          {
            v17 = v14;
          }

          v23[4] = a1 + 52;
          if (v17)
          {
            std::__allocate_at_least[abi:ne200100]<std::allocator<std::shared_ptr<BambiConferenceParticipant>>>((a1 + 52), v17);
          }

          v18 = v13;
          v19 = (16 * v13);
          *v19 = v7;
          v19[1] = v5;
          v10 = 16 * v13 + 16;
          v20 = &v19[-2 * v18];
          memcpy(v20, v11, v12);
          v21 = a1[52];
          a1[52] = v20;
          a1[53] = v10;
          v22 = a1[54];
          a1[54] = 0;
          v23[2] = v21;
          v23[3] = v22;
          v23[0] = v21;
          v23[1] = v21;
          std::__split_buffer<std::weak_ptr<BambiConferenceParticipant>>::~__split_buffer(v23);
        }

        else
        {
          *v9 = v7;
          *(v9 + 1) = v5;
          v10 = (v9 + 16);
        }

        a1[53] = v10;
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void sub_1E5134D30(_Unwind_Exception *a1)
{
  std::__shared_weak_count::__release_weak(v1);
  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  _Unwind_Resume(a1);
}

void RTPManager::handleAudioReadyEvent(RTPManager *this)
{
  v1 = *(*this - 24);
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 0x40000000;
  v4[2] = ___ZN10RTPManager21handleAudioReadyEventEv_block_invoke;
  v4[3] = &__block_descriptor_tmp_133;
  v2 = this + v1;
  v4[4] = this;
  v7 = 0;
  v8 = 0;
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&v7, (this + v1 + 8));
  v3 = *(v2 + 3);
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 1174405120;
  block[2] = ___ZNK3ctu20SharedSynchronizableI20RTPSharedPointerBaseE15execute_wrappedEU13block_pointerFvvE_block_invoke_3;
  block[3] = &unk_1F5EF6FD8;
  block[5] = v7;
  v6 = v8;
  if (v8)
  {
    atomic_fetch_add_explicit(&v8->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  block[4] = v4;
  dispatch_async(v3, block);
  if (v6)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  if (v8)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v8);
  }
}

void ___ZN10RTPManager21handleAudioReadyEventEv_block_invoke(uint64_t a1)
{
  v1 = *(a1 + 32);
  v2 = *(v1 + 416);
  v3 = *(v1 + 424);
  if (v2 == v3)
  {
    std::string::basic_string[abi:ne200100]<0>(v13, "rtp.mgr");
    v9[0] = 0;
    v12 = 0;
    v4 = ims::warn(v13, v9);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "No registered callbacks for AudioReady notification", 51);
    *(v4 + 17) = 0;
    (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v4 + 17) = 0;
    if (v12 == 1 && v11 < 0)
    {
      operator delete(__p);
    }

    if (v14 < 0)
    {
      operator delete(v13[0]);
    }

    v2 = *(v1 + 416);
    v3 = *(v1 + 424);
  }

  for (; v2 != v3; v2 += 2)
  {
    v5 = v2[1];
    if (v5)
    {
      v6 = *v2;
      atomic_fetch_add_explicit(&v5->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v7 = std::__shared_weak_count::lock(v5);
      if (v7)
      {
        v8 = v7;
        if (v6)
        {
          (*(*v6 + 16))(v6);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v8);
      }

      std::__shared_weak_count::__release_weak(v5);
    }
  }

  std::vector<std::weak_ptr<BambiConferenceParticipant>>::clear[abi:ne200100]((v1 + 416));
}

void sub_1E5134FE4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

void RTPManager::handleAudioStreamTokens(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 56);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 48);
      if (v9)
      {
        v10 = *(a3 + 8);
        v11[0] = &unk_1F5EF3658;
        v11[1] = v10;
        if (v10)
        {
          CFRetain(v10);
        }

        v11[0] = &unk_1F5EC8AD0;
        (*(*v9 + 168))(v9, a2, v11);
        ims::CFType::~CFType(v11);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void RTPManager::handleTextStreamToken(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v4 = *(a1 + 56);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(a1 + 48);
      if (v9)
      {
        v10 = *(a3 + 8);
        v11[0] = &unk_1F5EF3658;
        v11[1] = v10;
        if (v10)
        {
          CFRetain(v10);
        }

        v11[0] = &unk_1F5EF3708;
        (*(*v9 + 160))(v9, a2, v11);
        ims::CFType::~CFType(v11);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

void RTPManager::handleIncomingDtmf(RTPManager *this, uint64_t a2, uint64_t a3)
{
  v4 = *(this + 7);
  if (v4)
  {
    v7 = std::__shared_weak_count::lock(v4);
    if (v7)
    {
      v8 = v7;
      v9 = *(this + 6);
      if (v9)
      {
        (*(*v9 + 176))(v9, a2, a3);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }
  }
}

uint64_t RTPManager::sessionsThatCanChangeMediaStack(uint64_t a1)
{
  v8 = 0;
  v9 = 0;
  v10 = 0;
  (*(**(a1 + 152) + 80))(&v8);
  if (!v10 || (v2 = v9, v9 == &v8))
  {
    v3 = 0;
  }

  else
  {
    v3 = 0;
    do
    {
      v4 = v2[2];
      v6 = 0;
      v7 = 0;
      (*(**(a1 + 152) + 24))(&v6);
      if (v6)
      {
        v3 += (*(*v6 + 184))(v6);
      }

      if (v7)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v7);
      }

      v2 = v2[1];
    }

    while (v2 != &v8);
  }

  std::__list_imp<unsigned long long>::clear(&v8);
  return v3;
}

void sub_1E513540C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, std::__shared_weak_count *a4, ...)
{
  va_start(va, a4);
  if (a4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a4);
  }

  std::__list_imp<unsigned long long>::clear(va);
  _Unwind_Resume(a1);
}

void *RTPManager::setWifiHotspot(uint64_t a1, uint64_t a2, int a3)
{
  v6 = std::string::basic_string[abi:ne200100]<0>(&v39, "rtp.mgr");
  v35[0] = 0;
  v38 = 0;
  v7 = ims::debug(v6, v35);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "RTPManager::setWifiHotspot [stackId=", 36);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "; enabled=", 10);
  *(v7 + 17) = 0;
  if (a3)
  {
    v8 = "true";
  }

  else
  {
    v8 = "false";
  }

  std::string::basic_string[abi:ne200100]<0>(&__p, v8);
  (*(*v7 + 32))(v7, &__p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "]", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (SHIBYTE(v34) < 0)
  {
    operator delete(__p);
  }

  if (v38 == 1 && v37 < 0)
  {
    operator delete(v36);
  }

  if (SHIBYTE(v41) < 0)
  {
    operator delete(v39);
  }

  v39 = 0;
  v40 = 0;
  v41 = 0;
  (*(**(a1 + 152) + 80))(&v39);
  v9 = *(a1 + 192);
  if (!v9)
  {
    goto LABEL_18;
  }

  v10 = a1 + 192;
  do
  {
    if (*(v9 + 32) >= 1)
    {
      v10 = v9;
    }

    v9 = *(v9 + 8 * (*(v9 + 32) < 1));
  }

  while (v9);
  if (v10 != a1 + 192 && *(v10 + 32) < 2)
  {
    v12 = *(a1 + 56);
    if (v12 && (v13 = std::__shared_weak_count::lock(v12)) != 0)
    {
      v14 = v13;
      v15 = *(a1 + 48);
      if (v15)
      {
        __p = 0;
        v33 = 0;
        (*(*v15 + 184))(&__p);
        if (a3 && (v16 = SipStack::prefs(__p), !ImsPrefs::IgnoreWifiHotspot(v16)))
        {
          v19 = *(__p + 583);
        }

        else
        {
          v17 = *(__p + 35);
          v18 = *(__p + 36);
          if (v18)
          {
            atomic_fetch_add_explicit(&v18->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          (*(*v17 + 144))(v27);
          v19 = HIDWORD(v27[0]);
          if (v18)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v18);
          }
        }

        if (v33)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v33);
        }
      }

      else
      {
        v19 = 0;
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v14);
    }

    else
    {
      v19 = 0;
    }

    for (i = v40; i != &v39; i = *(i + 8))
    {
      v21 = *(i + 16);
      if ((*(**(v10 + 40) + 104))(*(v10 + 40), a2, v21))
      {
        __p = 0;
        v33 = 0;
        v34 = 0;
        RTPTransportManager::getTransports(v21, &__p);
        v22 = __p;
        v23 = v33;
        while (v22 != v23)
        {
          v24 = v22->__vftable;
          shared_owners = v22->__shared_owners_;
          if (shared_owners)
          {
            atomic_fetch_add_explicit(&shared_owners->__shared_owners_, 1uLL, memory_order_relaxed);
          }

          if (v24)
          {
            (*(v24->~__shared_weak_count + 15))(v24, v19);
          }

          if (shared_owners)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](shared_owners);
          }

          v22 = (v22 + 16);
        }

        v27[0] = &__p;
        std::vector<std::shared_ptr<BambiConferenceParticipant>>::__destroy_vector::operator()[abi:ne200100](v27);
      }
    }
  }

  else
  {
LABEL_18:
    std::string::basic_string[abi:ne200100]<0>(&__p, "rtp.mgr");
    v28[0] = 0;
    v31 = 0;
    v11 = ims::debug(&__p, v28);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "No AVC stack controller!", 24);
    *(v11 + 17) = 0;
    (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v11 + 17) = 0;
    if (v31 == 1 && v30 < 0)
    {
      operator delete(v29);
    }

    if (SHIBYTE(v34) < 0)
    {
      operator delete(__p);
    }
  }

  return std::__list_imp<unsigned long long>::clear(&v39);
}

void sub_1E51358C0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, void *a14, uint64_t a15, int a16, __int16 a17, char a18, char a19, uint64_t a20, char a21, void *a22, std::__shared_weak_count *a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, uint64_t a29, void *__p, uint64_t a31, int a32, __int16 a33, char a34, char a35, uint64_t a36, char a37)
{
  if (v37)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v37);
  }

  if (a23)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a23);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  std::__list_imp<unsigned long long>::clear((v39 - 112));
  _Unwind_Resume(a1);
}

void RTPManager::add(uint64_t a1@<X0>, unint64_t a2@<X1>, uint64_t *a3@<X2>, _OWORD *a4@<X8>)
{
  v4 = a3[1];
  v5 = *a3;
  v6 = v4;
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  MediaSessionBaseCollection::add((a1 + 120), a2, &v5, a4);
  if (v6)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }
}

void sub_1E5135A14(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t RTPManager::contains(uint64_t a1, uint64_t *a2)
{
  v2 = a2[1];
  v5 = *a2;
  v6 = v2;
  if (v2)
  {
    atomic_fetch_add_explicit(&v2->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v3 = MediaSessionBaseCollection::contains((a1 + 120), &v5);
  if (v6)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  return v3;
}

void sub_1E5135AA0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t *std::__tree<std::__value_type<SDPMedia::MediaType,unsigned long long>,std::__map_value_compare<SDPMedia::MediaType,std::__value_type<SDPMedia::MediaType,unsigned long long>,std::less<SDPMedia::MediaType>,true>,std::allocator<std::__value_type<SDPMedia::MediaType,unsigned long long>>>::__emplace_unique_key_args<SDPMedia::MediaType,std::piecewise_construct_t const&,std::tuple<SDPMedia::MediaType const&>,std::tuple<>>(uint64_t a1, int *a2)
{
  v2 = *(a1 + 8);
  if (!v2)
  {
LABEL_8:
    operator new();
  }

  v3 = *a2;
  while (1)
  {
    while (1)
    {
      v4 = v2;
      v5 = *(v2 + 32);
      if (v3 >= v5)
      {
        break;
      }

      v2 = *v4;
      if (!*v4)
      {
        goto LABEL_8;
      }
    }

    if (v5 >= v3)
    {
      return v4;
    }

    v2 = v4[1];
    if (!v2)
    {
      goto LABEL_8;
    }
  }
}

uint64_t std::__tree<unsigned long long>::__emplace_unique_key_args<unsigned long long,unsigned long long const&>(uint64_t result, unint64_t a2)
{
  v2 = *(result + 8);
  if (!v2)
  {
LABEL_7:
    operator new();
  }

  while (1)
  {
    while (1)
    {
      v3 = v2;
      v4 = v2[4];
      if (v4 <= a2)
      {
        break;
      }

      v2 = *v3;
      if (!*v3)
      {
        goto LABEL_7;
      }
    }

    if (v4 >= a2)
    {
      return result;
    }

    v2 = v3[1];
    if (!v2)
    {
      goto LABEL_7;
    }
  }
}

uint64_t *std::__tree<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::__map_value_compare<RTPStackType,std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>,std::less<RTPStackType>,true>,std::allocator<std::__value_type<RTPStackType,std::shared_ptr<RTPStackController>>>>::__emplace_unique_key_args<RTPStackType,std::piecewise_construct_t const&,std::tuple<RTPStackType&&>,std::tuple<>>(uint64_t a1, int a2)
{
  v2 = *(a1 + 8);
  if (!v2)
  {
LABEL_8:
    operator new();
  }

  while (1)
  {
    while (1)
    {
      v3 = v2;
      v4 = *(v2 + 32);
      if (v4 <= a2)
      {
        break;
      }

      v2 = *v3;
      if (!*v3)
      {
        goto LABEL_8;
      }
    }

    if (v4 >= a2)
    {
      return v3;
    }

    v2 = v3[1];
    if (!v2)
    {
      goto LABEL_8;
    }
  }
}

void std::__shared_ptr_emplace<IBIRTPStackController>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6E00;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<QMIRTPStackController>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6E50;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<AVCRTPStackController>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6EA0;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t std::__tree<std::__value_type<std::string,RTPStackType>,std::__map_value_compare<std::string,std::__value_type<std::string,RTPStackType>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,RTPStackType>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(uint64_t a1, void **a2)
{
  v3 = (a1 + 8);
  v2 = *(a1 + 8);
  if (!v2)
  {
    goto LABEL_7;
  }

  while (1)
  {
    while (1)
    {
      v5 = v2;
      if ((std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(a2, (v2 + 32)) & 0x80) == 0)
      {
        break;
      }

      v2 = *v5;
      v3 = v5;
      if (!*v5)
      {
        goto LABEL_7;
      }
    }

    if ((std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v5 + 4, a2) & 0x80) == 0)
    {
      break;
    }

    v3 = v5 + 1;
    v2 = v5[1];
    if (!v2)
    {
      goto LABEL_7;
    }
  }

  if (!*v3)
  {
LABEL_7:
    operator new();
  }

  return *v3;
}

uint64_t std::__tree<std::__value_type<unsigned long long,ImsPowerAssertion *>,std::__map_value_compare<unsigned long long,std::__value_type<unsigned long long,ImsPowerAssertion *>,std::less<unsigned long long>,true>,std::allocator<std::__value_type<unsigned long long,ImsPowerAssertion *>>>::__erase_unique<unsigned long long>(uint64_t **a1, unint64_t *a2)
{
  v2 = a1[1];
  if (!v2)
  {
    return 0;
  }

  v3 = *a2;
  v4 = (a1 + 1);
  do
  {
    v5 = v2[4];
    v6 = v5 >= v3;
    v7 = v5 < v3;
    if (v6)
    {
      v4 = v2;
    }

    v2 = v2[v7];
  }

  while (v2);
  if (v4 == (a1 + 1) || v3 < v4[4])
  {
    return 0;
  }

  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__remove_node_pointer(a1, v4);
  operator delete(v4);
  return 1;
}

void std::__shared_ptr_emplace<MediaSessionHandover>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6EF0;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<MediaSessionSRVCCHandover>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6F40;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void std::__shared_ptr_emplace<MediaSessionQMISRVCCHandover>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF6F90;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t __cxx_global_var_init_148()
{
  {
    return __cxa_atexit(ctu::PthreadMutexGuardPolicy<IMSMetricsManager>::~PthreadMutexGuardPolicy, &ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance, &dword_1E4C3F000);
  }

  return result;
}

void IMSSMSManager::IMSSMSManager(IMSSMSManager *this)
{
  *this = &unk_1F5EE3A68;
  *(this + 1) = &unk_1F5EF7240;
  *(this + 2) = &unk_1F5EBFC88;
  ims::getQueue(&object);
  *(this + 4) = 0;
  *(this + 5) = 0;
  v2 = object;
  *(this + 6) = object;
  if (v2)
  {
    dispatch_retain(v2);
  }

  *(this + 7) = 0;
  ctu::OsLogLogger::OsLogLogger((this + 64), "com.apple.ipTelephony", "sms.mgr");
  if (v2)
  {
    dispatch_release(v2);
  }

  *this = &unk_1F5EF7018;
  *(this + 1) = &unk_1F5EF70A0;
  *(this + 2) = &unk_1F5EF70F0;
  *(this + 3) = &unk_1F5EF7118;
  *(this + 72) = 0;
  SipTimerContainer::SipTimerContainer((this + 80));
  *(this + 248) = 0u;
  *(this + 264) = 0u;
  *(this + 35) = 0x40A7700000000000;
  *(this + 52) = 0;
  *(this + 53) = 0;
  *(this + 54) = 0;
  *(this + 56) = 0;
  *(this + 18) = 0u;
  *(this + 19) = 0u;
  *(this + 20) = 0u;
  *(this + 21) = 0u;
  *(this + 22) = 0u;
  *(this + 23) = 0u;
  *(this + 24) = 0u;
  *(this + 393) = 0u;
  *(this + 55) = this + 448;
  *(this + 59) = 0;
  *(this + 57) = 0;
  *(this + 58) = this + 472;
  *(this + 62) = 0;
  *(this + 63) = 0;
  *(this + 60) = 0;
  *(this + 61) = this + 496;
  *(this + 33) = 0u;
  *(this + 32) = 0u;
  *(this + 136) = 1065353216;
  *(this + 26) = 0;
  std::string::basic_string[abi:ne200100]<0>(&__str, "sms");
  object = 0;
  v4 = 0;
  memset(&__p, 0, sizeof(__p));
  v6 = 0;
  std::string::operator=((this + 128), &__str);
  *(this + 19) = object;
  *(this + 40) = v4;
  std::string::operator=(this + 7, &__p);
  *(this + 192) = v6;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }
}

void sub_1E51365B8(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  std::__hash_table<std::__hash_value_type<std::string,std::string>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::string>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::string>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::string>>>::~__hash_table(v27);
  std::__tree<unsigned int>::destroy((v26 + 30), *(v24 + 496));
  std::__tree<unsigned int>::destroy((v26 + 27), *(v24 + 472));
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(v24 + 448));
  std::vector<PendingSMS>::__destroy_vector::operator()[abi:ne200100](&a10);
  v29 = *(v24 + 400);
  if (v29)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v29);
  }

  ims::LocationInfo::~LocationInfo(v26);
  SipTimerContainer::~SipTimerContainer((v24 + 80));
  MEMORY[0x1E69225A0](v24 + 64);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(v25);
  _Unwind_Resume(a1);
}

void IMSSMSManager::~IMSSMSManager(IMSSMSManager *this)
{
  *this = &unk_1F5EF7018;
  *(this + 1) = &unk_1F5EF70A0;
  *(this + 2) = &unk_1F5EF70F0;
  *(this + 3) = &unk_1F5EF7118;
  std::__hash_table<std::__hash_value_type<std::string,std::string>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::string>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::string>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::string>>>::~__hash_table(this + 512);
  std::__tree<unsigned int>::destroy(this + 488, *(this + 62));
  std::__tree<unsigned int>::destroy(this + 464, *(this + 59));
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 56));
  v3 = (this + 416);
  std::vector<PendingSMS>::__destroy_vector::operator()[abi:ne200100](&v3);
  v2 = *(this + 50);
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  if (*(this + 391) < 0)
  {
    operator delete(*(this + 46));
  }

  if (*(this + 367) < 0)
  {
    operator delete(*(this + 43));
  }

  if (*(this + 343) < 0)
  {
    operator delete(*(this + 40));
  }

  if (*(this + 319) < 0)
  {
    operator delete(*(this + 37));
  }

  SipTimerContainer::~SipTimerContainer((this + 80));
  MEMORY[0x1E69225A0](this + 64);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 4);
}

{
  IMSSMSManager::~IMSSMSManager(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toIMSSMSManager::~IMSSMSManager(IMSSMSManager *this)
{
  IMSSMSManager::~IMSSMSManager((this - 8));
}

{
  IMSSMSManager::~IMSSMSManager((this - 16));
}

{
  IMSSMSManager::~IMSSMSManager((this - 24));
}

{
  IMSSMSManager::~IMSSMSManager((this - 8));

  JUMPOUT(0x1E69235B0);
}

{
  IMSSMSManager::~IMSSMSManager((this - 16));

  JUMPOUT(0x1E69235B0);
}

{
  IMSSMSManager::~IMSSMSManager((this - 24));

  JUMPOUT(0x1E69235B0);
}

uint64_t IMSSMSManager::sendSMS(IMSSMSManager *a1, uint64_t a2, std::string *a3, uint64_t a4, char **a5, uint64_t a6, char a7)
{
  v80 = 0;
  v81 = 0;
  IPTelephonyManager::getBambiClient(&v80);
  v14 = v80;
  if (v80)
  {
    v74 = 0;
    v75 = 0;
    (*(*v80 + 184))(&v74, v80, a2);
    if (!v74)
    {
      std::string::basic_string[abi:ne200100]<0>(__p, "sms");
      v62[0] = 0;
      v65 = 0;
      v17 = ims::error(__p, v62);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "SIP stack not found", 19);
      *(v17 + 17) = 0;
      (*(*v17 + 32))(v17, a2);
      (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v17 + 17) = 0;
      if (v65 == 1 && v64 < 0)
      {
        operator delete(v63);
      }

      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      std::string::basic_string[abi:ne200100]<0>(__p, "SIP stack not found");
      IMSSMSManager::reportFailure(a2, __p);
      goto LABEL_23;
    }

    if (BambiAccessBarring::isServiceBarred(v74 + 395, 4))
    {
      std::string::basic_string[abi:ne200100]<0>(__p, "sms");
      v70[0] = 0;
      v73 = 0;
      v15 = ims::debug(__p, v70);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "Service Barred", 14);
      *(v15 + 17) = 0;
      (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v15 + 17) = 0;
      if (v73 == 1 && v72 < 0)
      {
        operator delete(v71);
      }

      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      std::string::basic_string[abi:ne200100]<0>(__p, "Service Barred");
      IMSSMSManager::reportFailure(a2, __p);
LABEL_23:
      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      goto LABEL_102;
    }

    v18 = v74;
    v19 = SipStack::prefs(v74);
    if (ImsPrefs::EnableSignalingReduction(v19) && *(v18 + 4376) == 1 && (*(v74 + 4504) & 1) == 0)
    {
      std::string::basic_string[abi:ne200100]<0>(__p, "sms");
      v66[0] = 0;
      v69 = 0;
      v26 = ims::debug(__p, v66);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "Limited Connectivity", 20);
      *(v26 + 17) = 0;
      (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v26 + 17) = 0;
      if (v69 == 1 && v68 < 0)
      {
        operator delete(v67);
      }

      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      std::string::basic_string[abi:ne200100]<0>(__p, "Limited Connectivity");
      IMSSMSManager::reportFailure(a2, __p);
      goto LABEL_23;
    }

    v61 = 0;
    memset(v60, 0, sizeof(v60));
    SipUri::SipUri(v60);
    if (isPhoneNumber(a3))
    {
      IPTelephonyManager::instance(__p);
      v20 = __p[0];
      (*(*v14 + 184))(&v58, v14, a2);
      OutgoingUri = IPTelephonyManager::makeOutgoingUri(v20, &v58, a3, v60);
      if (v59)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v59);
      }

      if (__p[1])
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](__p[1]);
      }

      if ((OutgoingUri & 1) == 0)
      {
        std::string::basic_string[abi:ne200100]<0>(__p, "sms");
        v54[0] = 0;
        v57 = 0;
        v22 = ims::error(__p, v54);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "Invalid URI", 11);
        *(v22 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), ": ", 2);
        *(v22 + 17) = 0;
        (*(*v22 + 32))(v22, a3);
        (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v22 + 17) = 0;
        if (v57 == 1 && v56 < 0)
        {
          operator delete(v55);
        }

        if (SBYTE7(v39[0]) < 0)
        {
          operator delete(__p[0]);
        }

LABEL_39:
        std::string::basic_string[abi:ne200100]<0>(__p, "Invalid URI");
        IMSSMSManager::reportFailure(a2, __p);
LABEL_56:
        if ((SBYTE7(v39[0]) & 0x80000000) == 0)
        {
LABEL_101:
          SipUri::~SipUri(v60);
LABEL_102:
          if (v75)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v75);
          }

          goto LABEL_104;
        }

        v25 = __p[0];
LABEL_100:
        operator delete(v25);
        goto LABEL_101;
      }
    }

    else
    {
      SipUri::fromString(v60, a3);
      if (!SipUri::isValidUri(v60))
      {
        std::string::basic_string[abi:ne200100]<0>(__p, "sms");
        v50[0] = 0;
        v53 = 0;
        v23 = ims::error(__p, v50);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), "Invalid URI", 11);
        *(v23 + 17) = 0;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v23 + 8), ": ", 2);
        *(v23 + 17) = 0;
        (*(*v23 + 32))(v23, a3);
        (*(*v23 + 64))(v23, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v23 + 17) = 0;
        if (v53 == 1 && v52 < 0)
        {
          operator delete(v51);
        }

        if (SBYTE7(v39[0]) < 0)
        {
          operator delete(__p[0]);
        }

        goto LABEL_39;
      }
    }

    {
      std::string::basic_string[abi:ne200100]<0>(__p, "sms");
      v46[0] = 0;
      v49 = 0;
      v24 = ims::error(__p, v46);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v24 + 8), "Invalid content type", 20);
      *(v24 + 17) = 0;
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v24 + 8), ": ", 2);
      *(v24 + 17) = 0;
      (*(*v24 + 32))(v24, a6);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v24 + 8), "  Cannot send SMS", 17);
      *(v24 + 17) = 0;
      (*(*v24 + 64))(v24, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v24 + 17) = 0;
      if (v49 == 1 && v48 < 0)
      {
        operator delete(v47);
      }

      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      std::string::basic_string[abi:ne200100]<0>(__p, "Invalid content type");
      IMSSMSManager::reportFailure(a2, __p);
      goto LABEL_56;
    }

    __sz[1] = 0;
    __sz[0] = 0;
    v45 = 0;
    std::string::__init_with_size[abi:ne200100]<std::__wrap_iter<unsigned char const*>,std::__wrap_iter<unsigned char const*>>(__sz, *a5, a5[1], a5[1] - *a5);
    *v42 = 0u;
    v43 = 0u;
    memset(v41, 0, sizeof(v41));
    *v40 = 0u;
    *__p = 0u;
    memset(v39, 0, sizeof(v39));
    if (*(a2 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(__p, *a2, *(a2 + 8));
    }

    else
    {
      *__p = *a2;
      *&v39[0] = *(a2 + 16);
    }

    SipUri::SipUri((v39 + 8), v60);
    if (SHIBYTE(v45) < 0)
    {
      std::string::__init_copy_ctor_external(v40, __sz[0], __sz[1]);
    }

    else
    {
      *v40 = *__sz;
      v41[0] = v45;
    }

    if (*(a4 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&v41[1], *a4, *(a4 + 8));
    }

    else
    {
      *&v41[1] = *a4;
      v41[3] = *(a4 + 16);
    }

    if (*(a6 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(v42, *a6, *(a6 + 8));
    }

    else
    {
      *v42 = *a6;
      *&v43 = *(a6 + 16);
    }

    BYTE8(v43) = a7;
    HIDWORD(v43) = 0;
    if (TelephonyRadiosGetRadioVendor() == 1)
    {
      v27 = v74;
    }

    else
    {
      if (TelephonyRadiosGetRadioVendor() != 3)
      {
        goto LABEL_88;
      }

      v27 = v74;
      if (!ims::AccessNetwork::isNR((v74 + 3432)))
      {
        goto LABEL_88;
      }
    }

    if (ims::AccessNetwork::isLTE((v27 + 3432)) || ims::AccessNetwork::isNR((v27 + 3432)))
    {
      std::string::basic_string[abi:ne200100]<0>(&v35, "sms");
      v31[0] = 0;
      v34 = 0;
      v28 = ims::debug(&v35, v31);
      v82 = "Sending call status request before sending SMS message on ";
      v29 = ImsOutStream::putStreamable<char const*&>(v28, &v82);
      (*(*v29 + 32))(v29, a2);
      (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      v29[17] = 0;
      if (v34 == 1 && v33 < 0)
      {
        operator delete(v32);
      }

      if (v37 < 0)
      {
        operator delete(v35);
      }

      IPTelephonyManager::instance(&v35);
      IPTelephonyManager::sendCallStatusRequest(v35, a2, 0, 4, 1, 0);
      if (v36)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v36);
      }

      HIDWORD(v43) = 1;
      std::vector<PendingSMS>::push_back[abi:ne200100](a1 + 416, __p);
LABEL_90:
      if (SBYTE7(v43) < 0)
      {
        operator delete(v42[0]);
      }

      if (SHIBYTE(v41[3]) < 0)
      {
        operator delete(v41[1]);
      }

      if (SHIBYTE(v41[0]) < 0)
      {
        operator delete(v40[0]);
      }

      SipUri::~SipUri((v39 + 8));
      if (SBYTE7(v39[0]) < 0)
      {
        operator delete(__p[0]);
      }

      if ((SHIBYTE(v45) & 0x80000000) == 0)
      {
        goto LABEL_101;
      }

      v25 = __sz[0];
      goto LABEL_100;
    }

LABEL_88:
    HIDWORD(v43) = 0;
    if ((IMSSMSManager::prepareSMS(a1, __p) & 1) == 0)
    {
      std::vector<PendingSMS>::push_back[abi:ne200100](a1 + 416, __p);
    }

    goto LABEL_90;
  }

  std::string::basic_string[abi:ne200100]<0>(__p, "sms");
  v76[0] = 0;
  v79 = 0;
  v16 = ims::error(__p, v76);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "SIP client not found", 20);
  *(v16 + 17) = 0;
  (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v16 + 17) = 0;
  if (v79 == 1 && v78 < 0)
  {
    operator delete(v77);
  }

  if (SBYTE7(v39[0]) < 0)
  {
    operator delete(__p[0]);
  }

  std::string::basic_string[abi:ne200100]<0>(__p, "SIP client not found");
  IMSSMSManager::reportFailure(a2, __p);
  if (SBYTE7(v39[0]) < 0)
  {
    operator delete(__p[0]);
  }

LABEL_104:
  if (v81)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v81);
  }

  return 1;
}

void sub_1E5137490(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, void *a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, void *a16, uint64_t a17, uint64_t a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (SLOBYTE(STACK[0x22F]) < 0)
  {
    operator delete(STACK[0x218]);
  }

  if (SLOBYTE(STACK[0x217]) < 0)
  {
    operator delete(STACK[0x200]);
  }

  SipUri::~SipUri((v24 + 24));
  if (a24 < 0)
  {
    operator delete(a19);
  }

  if (SLOBYTE(STACK[0x267]) < 0)
  {
    operator delete(STACK[0x250]);
  }

  SipUri::~SipUri(&STACK[0x320]);
  v27 = *(v25 - 168);
  if (v27)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v27);
  }

  v28 = *(v25 - 96);
  if (v28)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::reportFailure(void **a1, const std::string *a2)
{
  *__p = 0u;
  v8 = 0u;
  *v5 = 0u;
  v6 = 0u;
  std::string::operator=(&v5[1], a2);
  v3 = IMSClientManager::delegateForStack(a1);
  (*(*(v3 + 48) + 16))(v3 + 48);
  v4 = IMSClientManager::delegateForStack(a1);
  (*(*(v4 + 48) + 24))(v4 + 48);
  if (SHIBYTE(v8) < 0)
  {
    operator delete(__p[1]);
  }

  if (SHIBYTE(v6) < 0)
  {
    operator delete(v5[1]);
  }
}

uint64_t anonymous namespace::isValidContentType(void **a1)
{
  v15 = *MEMORY[0x1E69E9840];
  if ((atomic_load_explicit(&_MergedGlobals_32, memory_order_acquire) & 1) == 0 && __cxa_guard_acquire(&_MergedGlobals_32))
  {
    std::string::basic_string[abi:ne200100]<0>(__p, "application/vnd.3gpp.sms");
    std::string::basic_string[abi:ne200100]<0>(&v10 + 8, "application/vnd.3gpp2.sms");
    std::string::basic_string[abi:ne200100]<0>(&v11, "text/plain");
    std::string::basic_string[abi:ne200100]<0>(&v12 + 8, "message/cpim");
    std::string::basic_string[abi:ne200100]<0>(&v13, "application/im-iscomposing+xml");
    std::string::basic_string[abi:ne200100]<0>(v14, "application/vnd.gsma.rcsrevoke+xml");
    std::set<std::string>::set[abi:ne200100](__p, 6);
    for (i = 0; i != -144; i -= 24)
    {
      if (v14[i + 23] < 0)
      {
        operator delete(*&v14[i]);
      }
    }

    __cxa_atexit(std::set<std::string>::~set[abi:ne200100], &qword_1EE2BCA88, &dword_1E4C3F000);
    __cxa_guard_release(&_MergedGlobals_32);
  }

  if (std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(&qword_1EE2BCA88, a1) == &qword_1EE2BCA90)
  {
    v7 = 0u;
    v8 = 0u;
    *&v5[0].__locale_ = 0u;
    v6 = 0u;
    std::basic_regex<char,std::regex_traits<char>>::basic_regex[abi:ne200100](v5, "multipart/mixed;boundary=\\d{2}", 0);
  }

  v2 = *MEMORY[0x1E69E9840];
  return 1;
}

void sub_1E5137A90(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, std::locale a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, void *__p, uint64_t a32)
{
  v34 = (v32 + 143);
  v35 = -144;
  v36 = (v32 + 143);
  while (1)
  {
    v37 = *v36;
    v36 -= 24;
    if (v37 < 0)
    {
      operator delete(*(v34 - 23));
    }

    v34 = v36;
    v35 += 24;
    if (!v35)
    {
      __cxa_guard_abort(&_MergedGlobals_32);
      _Unwind_Resume(a1);
    }
  }
}

void std::vector<PendingSMS>::push_back[abi:ne200100](uint64_t a1, PendingSMS *a2)
{
  v4 = *(a1 + 8);
  v3 = *(a1 + 16);
  if (v4 >= v3)
  {
    v6 = (v4 - *a1) >> 9;
    if ((v6 + 1) >> 55)
    {
      std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
    }

    v7 = v3 - *a1;
    v8 = v7 >> 8;
    if (v7 >> 8 <= (v6 + 1))
    {
      v8 = v6 + 1;
    }

    if (v7 >= 0x7FFFFFFFFFFFFE00)
    {
      v9 = 0x7FFFFFFFFFFFFFLL;
    }

    else
    {
      v9 = v8;
    }

    v22 = a1;
    if (v9)
    {
      if (!(v9 >> 55))
      {
        operator new();
      }

      std::__throw_bad_array_new_length[abi:ne200100]();
    }

    v18 = 0;
    v19 = v6 << 9;
    v21 = 0;
    PendingSMS::PendingSMS((v6 << 9), a2);
    v5 = (v6 << 9) + 512;
    v20 = v5;
    v10 = *a1;
    v11 = *(a1 + 8);
    v12 = *a1 - v11;
    v13 = v19 + v12;
    if (*a1 != v11)
    {
      v14 = 0;
      v15 = (v19 + v12);
      v16 = *a1;
      do
      {
        PendingSMS::PendingSMS(v15, v16);
        v16 = (v16 + 512);
        v15 = (v15 + 512);
        v14 -= 512;
      }

      while (v16 != v11);
      do
      {
        std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(v10);
        v10 += 512;
      }

      while (v10 != v11);
      v10 = *a1;
      v5 = v20;
    }

    *a1 = v13;
    *(a1 + 8) = v5;
    v17 = *(a1 + 16);
    *(a1 + 16) = v21;
    v20 = v10;
    v21 = v17;
    v18 = v10;
    v19 = v10;
    std::__split_buffer<PendingSMS>::~__split_buffer(&v18);
  }

  else
  {
    PendingSMS::PendingSMS(*(a1 + 8), a2);
    v5 = v4 + 512;
    *(a1 + 8) = v5;
  }

  *(a1 + 8) = v5;
}

void sub_1E5137CB4(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  std::__split_buffer<PendingSMS>::~__split_buffer(va);
  _Unwind_Resume(a1);
}

uint64_t IMSSMSManager::prepareSMS(IMSSMSManager *this, PendingSMS *a2)
{
  v33 = *MEMORY[0x1E69E9840];
  memset(v23, 0, sizeof(v23));
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v24 = 0x40A7700000000000;
  v31 = 0;
  v21 = 0;
  v22 = 0;
  IPTelephonyManager::getBambiClient(&v21);
  v19 = 0;
  v20 = 0;
  (*(*v21 + 184))(&v19);
  if (*(a2 + 504) == 1)
  {
    v4 = *(this + 5);
    if (v4)
    {
      v5 = *(this + 4);
      v6 = std::__shared_weak_count::lock(v4);
      if (v6)
      {
        p_shared_weak_owners = &v6->__shared_weak_owners_;
        atomic_fetch_add_explicit(&v6->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        std::__shared_weak_count::__release_shared[abi:ne200100](v6);
        atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
        std::string::basic_string[abi:ne200100]<0>(__p, "SMSEmergencyMode");
        atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
        v32 = 0;
        operator new();
      }
    }

    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  ims::LocationInfo::LocationInfo(v10, v23);
  IMSSMSManager::sendSMS(this, a2, v10);
  if (v17 < 0)
  {
    operator delete(v16);
  }

  if (v15 < 0)
  {
    operator delete(v14);
  }

  if (v13 < 0)
  {
    operator delete(v12);
  }

  if (v11 < 0)
  {
    operator delete(*&v10[6]);
  }

  if (v20)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v20);
  }

  if (v22)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v22);
  }

  if (SHIBYTE(v31) < 0)
  {
    operator delete(v30);
  }

  if (SHIBYTE(v29) < 0)
  {
    operator delete(*(&v28 + 1));
  }

  if (SBYTE7(v28) < 0)
  {
    operator delete(v27);
  }

  if (SHIBYTE(v26) < 0)
  {
    operator delete(*(&v25 + 1));
  }

  v8 = *MEMORY[0x1E69E9840];
  return 1;
}

void sub_1E513831C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, char a36, uint64_t a37, uint64_t a38, void *a39, uint64_t a40, int a41, __int16 a42, char a43, char a44, uint64_t a45, char a46, void *__p, uint64_t a48, int a49, __int16 a50, char a51, char a52, uint64_t a53, uint64_t a54, std::__shared_weak_count *a55, uint64_t a56, std::__shared_weak_count *a57, void *a58)
{
  v62 = *(v60 - 144);
  if (v62)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v62);
  }

  v63 = *(v60 - 128);
  if (v63)
  {
    std::__shared_weak_count::__release_weak(v63);
  }

  if (v59)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v59);
  }

  std::__shared_weak_count::__release_weak(v58);
  std::__shared_weak_count::__release_weak(v58);
  if (a55)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a55);
  }

  if (a57)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a57);
  }

  ims::LocationInfo::~LocationInfo(&a58);
  _Unwind_Resume(a1);
}

void PendingSMS::~PendingSMS(void **this)
{
  if (*(this + 503) < 0)
  {
    operator delete(this[60]);
  }

  if (*(this + 479) < 0)
  {
    operator delete(this[57]);
  }

  if (*(this + 455) < 0)
  {
    operator delete(this[54]);
  }

  SipUri::~SipUri((this + 3));
  if (*(this + 23) < 0)
  {
    operator delete(*this);
  }
}

void IMSSMSManager::sendLazuli(IMSSMSManager *this, std::string *a2)
{
  v90 = *MEMORY[0x1E69E9840];
  v4 = *(this + 8);
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    (*(*(this + 3) + 16))(__p);
    if (v57 >= 0)
    {
      v5 = __p;
    }

    else
    {
      v5 = *__p;
    }

    data = a2 + 2;
    if ((a2[2].__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
    {
      data = a2[2].__r_.__value_.__l.__data_;
    }

    *buf = 141558531;
    *&buf[4] = 1752392040;
    *&buf[12] = 2081;
    *&buf[14] = v5;
    *&buf[22] = 2085;
    *&buf[24] = data;
    _os_log_impl(&dword_1E4C3F000, v4, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}sIMSSMSManager::sendLazuli %{sensitive}s", buf, 0x20u);
    if (SHIBYTE(v57) < 0)
    {
      operator delete(*__p);
    }
  }

  v54 = 0;
  v55 = 0;
  IPTelephonyManager::getBambiClient(&v54);
  v89 = 0;
  v87 = 0u;
  v88 = 0u;
  v85 = 0u;
  v86 = 0u;
  v83 = 0u;
  v84 = 0u;
  v81 = 0u;
  v82 = 0u;
  v79 = 0u;
  v80 = 0u;
  v77 = 0u;
  v78 = 0u;
  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  v67 = 0u;
  v68 = 0u;
  v66 = 0u;
  memset(buf, 0, sizeof(buf));
  SipUri::SipUri(buf);
  IPTelephonyManager::instance(__p);
  v7 = *__p;
  v8 = v54;
  (*(*v54 + 184))(&v52, v54, a2);
  OutgoingUri = IPTelephonyManager::makeOutgoingUri(v7, &v52, a2 + 2, buf);
  if (v53)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v53);
  }

  if (*&__p[8])
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](*&__p[8]);
  }

  if (OutgoingUri)
  {
    {
      *__p = BambiClient::sendLazuli(v8, a2, buf);
      if (*__p)
      {
        std::__tree<unsigned int>::__emplace_unique_key_args<unsigned int,unsigned int const&>(this + 464, __p);
      }

      goto LABEL_71;
    }

    v13 = *(this + 8);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      (*(*(this + 3) + 16))(v50, this + 24);
      v28 = v50[0];
      v29 = a2[1].__r_.__value_.__l.__data_;
      if (v51 >= 0)
      {
        v28 = v50;
      }

      if ((a2[2].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v30 = a2 + 2;
      }

      else
      {
        v30 = a2[2].__r_.__value_.__l.__data_;
      }

      if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v29 = a2 + 1;
      }

      v31 = a2[7].__r_.__value_.__l.__data_;
      if ((a2[7].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v31 = a2 + 7;
      }

      *__p = 141559299;
      *&__p[4] = 1752392040;
      *&__p[12] = 2081;
      *&__p[14] = v28;
      v57 = 2080;
      v58 = "Invalid content type";
      v59 = 2085;
      v60 = v30;
      v61 = 2080;
      v62 = v29;
      v63 = 2080;
      v64 = v31;
      _os_log_error_impl(&dword_1E4C3F000, v13, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}ssend %s: uri %{sensitive}s trx %s content type %s", __p, 0x3Eu);
      if (v51 < 0)
      {
        operator delete(v50[0]);
      }
    }

    v50[0] = 0;
    v14 = xpc_dictionary_create(0, 0, 0);
    v15 = v14;
    if (v14)
    {
      v50[0] = v14;
    }

    else
    {
      v15 = xpc_null_create();
      v50[0] = v15;
      if (!v15)
      {
        v17 = xpc_null_create();
        v15 = 0;
        goto LABEL_52;
      }
    }

    if (MEMORY[0x1E6924740](v15) == MEMORY[0x1E69E9E80])
    {
      xpc_retain(v15);
LABEL_53:
      xpc_release(v15);
      v39 = xpc_BOOL_create(0);
      if (!v39)
      {
        v39 = xpc_null_create();
      }

      *__p = v50;
      *&__p[8] = "kIsSuccess";
      xpc::dict::object_proxy::operator=(__p, &v39, &v40);
      xpc_release(v40);
      v40 = 0;
      xpc_release(v39);
      v39 = 0;
      v37 = xpc_string_create("Invalid content type");
      if (!v37)
      {
        v37 = xpc_null_create();
      }

      *__p = v50;
      *&__p[8] = "kReason";
      xpc::dict::object_proxy::operator=(__p, &v37, &v38);
      xpc_release(v38);
      v38 = 0;
      xpc_release(v37);
      v37 = 0;
      if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v21 = &a2[3];
      }

      else
      {
        v21 = a2[3].__r_.__value_.__l.__data_;
      }

      v35 = xpc_string_create(v21);
      if (!v35)
      {
        v35 = xpc_null_create();
      }

      *__p = v50;
      *&__p[8] = "kConversationId";
      xpc::dict::object_proxy::operator=(__p, &v35, &v36);
      xpc_release(v36);
      v36 = 0;
      xpc_release(v35);
      v35 = 0;
      if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v22 = &a2[1];
      }

      else
      {
        v22 = a2[1].__r_.__value_.__l.__data_;
      }

      v33 = xpc_string_create(v22);
      if (!v33)
      {
        v33 = xpc_null_create();
      }

      *__p = v50;
      *&__p[8] = "kTransactionId";
      xpc::dict::object_proxy::operator=(__p, &v33, &v34);
      xpc_release(v34);
      v34 = 0;
      xpc_release(v33);
      v23 = v50[0];
      v32 = v50[0];
      v33 = 0;
      if (v50[0])
      {
        xpc_retain(v50[0]);
      }

      else
      {
        v23 = xpc_null_create();
        v32 = v23;
      }

      IMSSMSManager::reportSendStatus(&a2->__r_.__value_.__l.__data_, &v32);
      xpc_release(v23);
      v32 = 0;
      xpc_release(v50[0]);
      goto LABEL_71;
    }

    v17 = xpc_null_create();
LABEL_52:
    v50[0] = v17;
    goto LABEL_53;
  }

  v10 = *(this + 8);
  if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
  {
    (*(*(this + 3) + 16))(v50, this + 24);
    v25 = v50[0];
    v26 = a2 + 1;
    if (v51 >= 0)
    {
      v25 = v50;
    }

    if ((a2[2].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v27 = a2 + 2;
    }

    else
    {
      v27 = a2[2].__r_.__value_.__l.__data_;
    }

    if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
    {
      v26 = a2[1].__r_.__value_.__l.__data_;
    }

    *__p = 141559043;
    *&__p[4] = 1752392040;
    *&__p[12] = 2081;
    *&__p[14] = v25;
    v57 = 2080;
    v58 = "Invalid URI";
    v59 = 2085;
    v60 = v27;
    v61 = 2080;
    v62 = v26;
    _os_log_error_impl(&dword_1E4C3F000, v10, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}ssend %s: uri %{sensitive}s trx %s", __p, 0x34u);
    if (v51 < 0)
    {
      operator delete(v50[0]);
    }
  }

  v50[0] = 0;
  v11 = xpc_dictionary_create(0, 0, 0);
  v12 = v11;
  if (v11)
  {
    v50[0] = v11;
  }

  else
  {
    v12 = xpc_null_create();
    v50[0] = v12;
    if (!v12)
    {
      v16 = xpc_null_create();
      v12 = 0;
      goto LABEL_32;
    }
  }

  if (MEMORY[0x1E6924740](v12) != MEMORY[0x1E69E9E80])
  {
    v16 = xpc_null_create();
LABEL_32:
    v50[0] = v16;
    goto LABEL_33;
  }

  xpc_retain(v12);
LABEL_33:
  xpc_release(v12);
  v48 = xpc_BOOL_create(0);
  if (!v48)
  {
    v48 = xpc_null_create();
  }

  *__p = v50;
  *&__p[8] = "kIsSuccess";
  xpc::dict::object_proxy::operator=(__p, &v48, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v48);
  v48 = 0;
  v46 = xpc_string_create("Invalid URI");
  if (!v46)
  {
    v46 = xpc_null_create();
  }

  *__p = v50;
  *&__p[8] = "kReason";
  xpc::dict::object_proxy::operator=(__p, &v46, &v47);
  xpc_release(v47);
  v47 = 0;
  xpc_release(v46);
  v46 = 0;
  if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v18 = &a2[3];
  }

  else
  {
    v18 = a2[3].__r_.__value_.__l.__data_;
  }

  v44 = xpc_string_create(v18);
  if (!v44)
  {
    v44 = xpc_null_create();
  }

  *__p = v50;
  *&__p[8] = "kConversationId";
  xpc::dict::object_proxy::operator=(__p, &v44, &v45);
  xpc_release(v45);
  v45 = 0;
  xpc_release(v44);
  v44 = 0;
  if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v19 = &a2[1];
  }

  else
  {
    v19 = a2[1].__r_.__value_.__l.__data_;
  }

  v42 = xpc_string_create(v19);
  if (!v42)
  {
    v42 = xpc_null_create();
  }

  *__p = v50;
  *&__p[8] = "kTransactionId";
  xpc::dict::object_proxy::operator=(__p, &v42, &v43);
  xpc_release(v43);
  v43 = 0;
  xpc_release(v42);
  v20 = v50[0];
  v41 = v50[0];
  v42 = 0;
  if (v50[0])
  {
    xpc_retain(v50[0]);
  }

  else
  {
    v20 = xpc_null_create();
    v41 = v20;
  }

  IMSSMSManager::reportSendStatus(&a2->__r_.__value_.__l.__data_, &v41);
  xpc_release(v20);
  v41 = 0;
  xpc_release(v50[0]);
LABEL_71:
  SipUri::~SipUri(buf);
  if (v55)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v55);
  }

  v24 = *MEMORY[0x1E69E9840];
}

void sub_1E5138D40(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, xpc_object_t object, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, uint64_t a42, char a43)
{
  if (a2)
  {
    __clang_call_terminate(exception_object);
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::reportSendStatus(void **a1, void **a2)
{
  v6 = 0;
  v7 = 0;
  IMSClientManager::lazuliDelegateForStack(a1, &v6);
  v3 = v6;
  if (v6)
  {
    v4 = *a2;
    object = v4;
    if (v4)
    {
      xpc_retain(v4);
    }

    else
    {
      object = xpc_null_create();
    }

    LazuliDelegate::handleMessageSend(v3, &object);
    xpc_release(object);
    object = 0;
  }

  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }
}

void sub_1E5138F34(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, xpc_object_t object, uint64_t a11, std::__shared_weak_count *a12)
{
  xpc_release(object);
  if (a12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a12);
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::addParticipants(IMSSMSManager *this, std::string *a2)
{
  v68 = 0u;
  v69 = 0u;
  v67 = 0u;
  BambiClient::clientConfigForStackId(&v67);
  std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
  v62 = v67;
  v63 = DWORD2(v67);
  if (SBYTE7(v69) < 0)
  {
    std::string::__init_copy_ctor_external(&v64, v68, *(&v68 + 1));
  }

  else
  {
    *&v64.__r_.__value_.__l.__data_ = v68;
    v64.__r_.__value_.__r.__words[2] = v69;
  }

  v65 = BYTE8(v69);
  v66 = 1;
  v3 = ims::debug(&__p, &v62);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "IMSSMSManager::addParticipants", 30);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v66 == 1 && SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v64.__r_.__value_.__l.__data_);
  }

  if (SBYTE7(v35) < 0)
  {
    operator delete(__p);
  }

  v60 = 0;
  v61 = 0;
  IPTelephonyManager::getBambiClient(&v60);
  v59 = 0;
  v57 = 0u;
  v58 = 0u;
  v55 = 0u;
  v56 = 0u;
  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  __p = 0u;
  SipUri::SipUri(&__p);
  IPTelephonyManager::instance(&v29);
  v4 = v29;
  v5 = v60;
  (*(*v60 + 184))(&v32, v60, a2);
  OutgoingUri = IPTelephonyManager::makeOutgoingUri(v4, &v32, a2 + 2, &__p);
  if (v33)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v33);
  }

  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  if (OutgoingUri)
  {
    BambiClient::addLazuliParticipants(v5, &a2->__r_.__value_.__l.__data_, &__p);
    goto LABEL_56;
  }

  std::string::basic_string[abi:ne200100]<0>(&v29, "laz.mgr");
  v24 = v67;
  v25 = DWORD2(v67);
  if (SBYTE7(v69) < 0)
  {
    std::string::__init_copy_ctor_external(&v26, v68, *(&v68 + 1));
  }

  else
  {
    *&v26.__r_.__value_.__l.__data_ = v68;
    v26.__r_.__value_.__r.__words[2] = v69;
  }

  v27 = BYTE8(v69);
  v28 = 1;
  v7 = ims::error(&v29, &v24);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "Invalid URI", 11);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ": ", 2);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2 + 1);
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v28 == 1 && SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v26.__r_.__value_.__l.__data_);
  }

  if (v31 < 0)
  {
    operator delete(v29);
  }

  v23 = 0;
  v8 = xpc_dictionary_create(0, 0, 0);
  v9 = v8;
  if (v8)
  {
    v23 = v8;
  }

  else
  {
    v9 = xpc_null_create();
    v23 = v9;
    if (!v9)
    {
      v10 = xpc_null_create();
      v9 = 0;
      goto LABEL_30;
    }
  }

  if (MEMORY[0x1E6924740](v9) != MEMORY[0x1E69E9E80])
  {
    v10 = xpc_null_create();
LABEL_30:
    v23 = v10;
    goto LABEL_31;
  }

  xpc_retain(v9);
LABEL_31:
  xpc_release(v9);
  v21 = xpc_BOOL_create(0);
  if (!v21)
  {
    v21 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v29, &v21, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v21);
  v21 = 0;
  v19 = xpc_string_create("Invalid URI");
  if (!v19)
  {
    v19 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kReason";
  xpc::dict::object_proxy::operator=(&v29, &v19, &v20);
  xpc_release(v20);
  v20 = 0;
  xpc_release(v19);
  v19 = 0;
  if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    data = &a2[3];
  }

  else
  {
    data = a2[3].__r_.__value_.__l.__data_;
  }

  v17 = xpc_string_create(data);
  if (!v17)
  {
    v17 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v29, &v17, &v18);
  xpc_release(v18);
  v18 = 0;
  xpc_release(v17);
  v17 = 0;
  if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v12 = &a2[1];
  }

  else
  {
    v12 = a2[1].__r_.__value_.__l.__data_;
  }

  v15 = xpc_string_create(v12);
  if (!v15)
  {
    v15 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v29, &v15, &v16);
  xpc_release(v16);
  v16 = 0;
  xpc_release(v15);
  v15 = 0;
  v13 = v23;
  if (v23)
  {
    xpc_retain(v23);
  }

  else
  {
    v13 = xpc_null_create();
  }

  v29 = 0;
  v30 = 0;
  IMSClientManager::lazuliDelegateForStack(&a2->__r_.__value_.__l.__data_, &v29);
  v14 = v29;
  if (v29)
  {
    v70 = v13;
    if (v13)
    {
      xpc_retain(v13);
    }

    else
    {
      v70 = xpc_null_create();
    }

    LazuliDelegate::handleParticipantAdded(v14, &v70);
    xpc_release(v70);
    v70 = 0;
  }

  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  xpc_release(v13);
  xpc_release(v23);
LABEL_56:
  SipUri::~SipUri(&__p);
  if (v61)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v61);
  }

  if (SBYTE7(v69) < 0)
  {
    operator delete(v68);
  }
}

void sub_1E5139540(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, xpc_object_t object, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, void *__p, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, uint64_t a36, void *a37, uint64_t a38, int a39, __int16 a40, char a41, char a42)
{
  if (a34 < 0)
  {
    operator delete(__p);
  }

  SipUri::~SipUri(&a37);
  v44 = *(v42 - 176);
  if (v44)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  }

  if (*(v42 - 73) < 0)
  {
    operator delete(*(v42 - 96));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::removeParticipants(IMSSMSManager *this, std::string *a2)
{
  v68 = 0u;
  v69 = 0u;
  v67 = 0u;
  BambiClient::clientConfigForStackId(&v67);
  std::string::basic_string[abi:ne200100]<0>(__p, "laz.mgr");
  v62 = v67;
  v63 = DWORD2(v67);
  if (SBYTE7(v69) < 0)
  {
    std::string::__init_copy_ctor_external(&v64, v68, *(&v68 + 1));
  }

  else
  {
    *&v64.__r_.__value_.__l.__data_ = v68;
    v64.__r_.__value_.__r.__words[2] = v69;
  }

  v65 = BYTE8(v69);
  v66 = 1;
  v3 = ims::debug(__p, &v62);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "IMSSMSManager::removeParticipants", 33);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v66 == 1 && SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v64.__r_.__value_.__l.__data_);
  }

  if (SBYTE7(v35) < 0)
  {
    operator delete(__p[0]);
  }

  v60 = 0;
  v61 = 0;
  IPTelephonyManager::getBambiClient(&v60);
  v59 = 0;
  v57 = 0u;
  v58 = 0u;
  v55 = 0u;
  v56 = 0u;
  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  *__p = 0u;
  SipUri::SipUri(__p);
  IPTelephonyManager::instance(&v29);
  v4 = v29;
  v5 = v60;
  (*(*v60 + 184))(&v32, v60, a2);
  OutgoingUri = IPTelephonyManager::makeOutgoingUri(v4, &v32, a2 + 2, __p);
  if (v33)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v33);
  }

  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  if (OutgoingUri)
  {
    BambiClient::removeLazuliParticipants(v5, &a2->__r_.__value_.__l.__data_, __p);
    goto LABEL_53;
  }

  std::string::basic_string[abi:ne200100]<0>(&v29, "laz.mgr");
  v24 = v67;
  v25 = DWORD2(v67);
  if (SBYTE7(v69) < 0)
  {
    std::string::__init_copy_ctor_external(&v26, v68, *(&v68 + 1));
  }

  else
  {
    *&v26.__r_.__value_.__l.__data_ = v68;
    v26.__r_.__value_.__r.__words[2] = v69;
  }

  v27 = BYTE8(v69);
  v28 = 1;
  v7 = ims::error(&v29, &v24);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "Invalid URI", 11);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ": ", 2);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2 + 1);
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v28 == 1 && SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v26.__r_.__value_.__l.__data_);
  }

  if (v31 < 0)
  {
    operator delete(v29);
  }

  v23 = 0;
  v8 = xpc_dictionary_create(0, 0, 0);
  v9 = v8;
  if (v8)
  {
    v23 = v8;
  }

  else
  {
    v9 = xpc_null_create();
    v23 = v9;
    if (!v9)
    {
      v10 = xpc_null_create();
      v9 = 0;
      goto LABEL_30;
    }
  }

  if (MEMORY[0x1E6924740](v9) != MEMORY[0x1E69E9E80])
  {
    v10 = xpc_null_create();
LABEL_30:
    v23 = v10;
    goto LABEL_31;
  }

  xpc_retain(v9);
LABEL_31:
  xpc_release(v9);
  v21 = xpc_BOOL_create(0);
  if (!v21)
  {
    v21 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v29, &v21, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v21);
  v21 = 0;
  v19 = xpc_string_create("Invalid URI");
  if (!v19)
  {
    v19 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kReason";
  xpc::dict::object_proxy::operator=(&v29, &v19, &v20);
  xpc_release(v20);
  v20 = 0;
  xpc_release(v19);
  v19 = 0;
  if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    data = &a2[3];
  }

  else
  {
    data = a2[3].__r_.__value_.__l.__data_;
  }

  v17 = xpc_string_create(data);
  if (!v17)
  {
    v17 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v29, &v17, &v18);
  xpc_release(v18);
  v18 = 0;
  xpc_release(v17);
  v17 = 0;
  if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v12 = &a2[1];
  }

  else
  {
    v12 = a2[1].__r_.__value_.__l.__data_;
  }

  v15 = xpc_string_create(v12);
  if (!v15)
  {
    v15 = xpc_null_create();
  }

  v29 = &v23;
  v30 = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v29, &v15, &v16);
  xpc_release(v16);
  v16 = 0;
  xpc_release(v15);
  v15 = 0;
  v29 = 0;
  v30 = 0;
  IMSClientManager::lazuliDelegateForStack(&a2->__r_.__value_.__l.__data_, &v29);
  v13 = v29;
  if (v29)
  {
    v14 = v23;
    if (v23)
    {
      xpc_retain(v23);
    }

    else
    {
      v14 = xpc_null_create();
    }

    LazuliDelegate::handleParticipantRemoved(v13, &v14);
    xpc_release(v14);
    v14 = 0;
  }

  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  xpc_release(v23);
LABEL_53:
  SipUri::~SipUri(__p);
  if (v61)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v61);
  }

  if (SBYTE7(v69) < 0)
  {
    operator delete(v68);
  }
}

void sub_1E5139C78(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, xpc_object_t object, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, xpc_object_t a18, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28, void *__p, uint64_t a30, int a31, __int16 a32, char a33, char a34, uint64_t a35, uint64_t a36, void *a37, uint64_t a38, int a39, __int16 a40, char a41, char a42)
{
  if (a34 < 0)
  {
    operator delete(__p);
  }

  SipUri::~SipUri(&a37);
  v44 = *(v42 - 160);
  if (v44)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  }

  if (*(v42 - 57) < 0)
  {
    operator delete(*(v42 - 80));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::changeLazuliGroupInfo(IMSSMSManager *this, std::string *a2)
{
  v90 = 0u;
  v91 = 0u;
  v89 = 0u;
  BambiClient::clientConfigForStackId(&v89);
  std::string::basic_string[abi:ne200100]<0>(__p, "laz.mgr");
  v84 = v89;
  v85 = DWORD2(v89);
  if (SBYTE7(v91) < 0)
  {
    std::string::__init_copy_ctor_external(&v86, v90, *(&v90 + 1));
  }

  else
  {
    *&v86.__r_.__value_.__l.__data_ = v90;
    v86.__r_.__value_.__r.__words[2] = v91;
  }

  v87 = BYTE8(v91);
  v88 = 1;
  v4 = ims::debug(__p, &v84);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "IMSSMSManager::changeLazuliGroupInfo", 36);
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v88 == 1 && SHIBYTE(v86.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v86.__r_.__value_.__l.__data_);
  }

  if (SBYTE7(v57) < 0)
  {
    operator delete(__p[0]);
  }

  v82 = 0;
  v83 = 0;
  IPTelephonyManager::getBambiClient(&v82);
  v81 = 0;
  v79 = 0u;
  v80 = 0u;
  v77 = 0u;
  v78 = 0u;
  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v59 = 0u;
  v60 = 0u;
  v57 = 0u;
  v58 = 0u;
  *__p = 0u;
  SipUri::SipUri(__p);
  IPTelephonyManager::instance(&v51);
  v5 = v51;
  v6 = v82;
  (*(*v82 + 184))(&v54, v82, a2);
  OutgoingUri = IPTelephonyManager::makeOutgoingUri(v5, &v54, a2 + 2, __p);
  if (v55)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v55);
  }

  if (v52)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v52);
  }

  if (OutgoingUri)
  {
    {
      LODWORD(v51) = BambiClient::changeLazuliGroupInfo(v6, a2, __p);
      if (v51)
      {
        std::__tree<unsigned int>::__emplace_unique_key_args<unsigned int,unsigned int const&>(this + 464, &v51);
      }

      goto LABEL_85;
    }

    std::string::basic_string[abi:ne200100]<0>(&v51, "laz.mgr");
    v31 = v89;
    v32 = DWORD2(v89);
    if (SBYTE7(v91) < 0)
    {
      std::string::__init_copy_ctor_external(&v33, v90, *(&v90 + 1));
    }

    else
    {
      *&v33.__r_.__value_.__l.__data_ = v90;
      v33.__r_.__value_.__r.__words[2] = v91;
    }

    v34 = BYTE8(v91);
    v35 = 1;
    v12 = ims::error(&v51, &v31);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "Invalid content type", 20);
    *(v12 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), ": ", 2);
    *(v12 + 17) = 0;
    (*(*v12 + 32))(v12, a2 + 7);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "  Cannot send message", 21);
    *(v12 + 17) = 0;
    (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v12 + 17) = 0;
    if (v35 == 1 && SHIBYTE(v33.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v33.__r_.__value_.__l.__data_);
    }

    if (v53 < 0)
    {
      operator delete(v51);
    }

    v45 = 0;
    v13 = xpc_dictionary_create(0, 0, 0);
    v14 = v13;
    if (v13)
    {
      v45 = v13;
    }

    else
    {
      v14 = xpc_null_create();
      v45 = v14;
      if (!v14)
      {
        v15 = xpc_null_create();
        v14 = 0;
        goto LABEL_66;
      }
    }

    if (MEMORY[0x1E6924740](v14) == MEMORY[0x1E69E9E80])
    {
      xpc_retain(v14);
LABEL_67:
      xpc_release(v14);
      v29 = xpc_BOOL_create(0);
      if (!v29)
      {
        v29 = xpc_null_create();
      }

      v51 = &v45;
      v52 = "kIsSuccess";
      xpc::dict::object_proxy::operator=(&v51, &v29, &v30);
      xpc_release(v30);
      v30 = 0;
      xpc_release(v29);
      v29 = 0;
      v27 = xpc_string_create("Invalid content type");
      if (!v27)
      {
        v27 = xpc_null_create();
      }

      v51 = &v45;
      v52 = "kReason";
      xpc::dict::object_proxy::operator=(&v51, &v27, &v28);
      xpc_release(v28);
      v28 = 0;
      xpc_release(v27);
      v27 = 0;
      if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        data = &a2[3];
      }

      else
      {
        data = a2[3].__r_.__value_.__l.__data_;
      }

      v25 = xpc_string_create(data);
      if (!v25)
      {
        v25 = xpc_null_create();
      }

      v51 = &v45;
      v52 = "kConversationId";
      xpc::dict::object_proxy::operator=(&v51, &v25, &v26);
      xpc_release(v26);
      v26 = 0;
      xpc_release(v25);
      v25 = 0;
      if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
      {
        v20 = &a2[1];
      }

      else
      {
        v20 = a2[1].__r_.__value_.__l.__data_;
      }

      v23 = xpc_string_create(v20);
      if (!v23)
      {
        v23 = xpc_null_create();
      }

      v51 = &v45;
      v52 = "kTransactionId";
      xpc::dict::object_proxy::operator=(&v51, &v23, &v24);
      xpc_release(v24);
      v24 = 0;
      xpc_release(v23);
      v21 = v45;
      v22 = v45;
      v23 = 0;
      if (v45)
      {
        xpc_retain(v45);
      }

      else
      {
        v21 = xpc_null_create();
        v22 = v21;
      }

      IMSSMSManager::reportSendStatus(&a2->__r_.__value_.__l.__data_, &v22);
      xpc_release(v21);
      v22 = 0;
      xpc_release(v45);
      goto LABEL_85;
    }

    v15 = xpc_null_create();
LABEL_66:
    v45 = v15;
    goto LABEL_67;
  }

  std::string::basic_string[abi:ne200100]<0>(&v51, "laz.mgr");
  v46 = v89;
  v47 = DWORD2(v89);
  if (SBYTE7(v91) < 0)
  {
    std::string::__init_copy_ctor_external(&v48, v90, *(&v90 + 1));
  }

  else
  {
    *&v48.__r_.__value_.__l.__data_ = v90;
    v48.__r_.__value_.__r.__words[2] = v91;
  }

  v49 = BYTE8(v91);
  v50 = 1;
  v8 = ims::error(&v51, &v46);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Invalid URI", 11);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), ": ", 2);
  *(v8 + 17) = 0;
  (*(*v8 + 32))(v8, a2 + 1);
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v50 == 1 && SHIBYTE(v48.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v48.__r_.__value_.__l.__data_);
  }

  if (v53 < 0)
  {
    operator delete(v51);
  }

  v45 = 0;
  v9 = xpc_dictionary_create(0, 0, 0);
  v10 = v9;
  if (v9)
  {
    v45 = v9;
  }

  else
  {
    v10 = xpc_null_create();
    v45 = v10;
    if (!v10)
    {
      v11 = xpc_null_create();
      v10 = 0;
      goto LABEL_46;
    }
  }

  if (MEMORY[0x1E6924740](v10) != MEMORY[0x1E69E9E80])
  {
    v11 = xpc_null_create();
LABEL_46:
    v45 = v11;
    goto LABEL_47;
  }

  xpc_retain(v10);
LABEL_47:
  xpc_release(v10);
  v43 = xpc_BOOL_create(0);
  if (!v43)
  {
    v43 = xpc_null_create();
  }

  v51 = &v45;
  v52 = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v51, &v43, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v43);
  v43 = 0;
  v41 = xpc_string_create("Invalid URI");
  if (!v41)
  {
    v41 = xpc_null_create();
  }

  v51 = &v45;
  v52 = "kReason";
  xpc::dict::object_proxy::operator=(&v51, &v41, &v42);
  xpc_release(v42);
  v42 = 0;
  xpc_release(v41);
  v41 = 0;
  if ((a2[3].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v16 = &a2[3];
  }

  else
  {
    v16 = a2[3].__r_.__value_.__l.__data_;
  }

  v39 = xpc_string_create(v16);
  if (!v39)
  {
    v39 = xpc_null_create();
  }

  v51 = &v45;
  v52 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v51, &v39, &v40);
  xpc_release(v40);
  v40 = 0;
  xpc_release(v39);
  v39 = 0;
  if ((a2[1].__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v17 = &a2[1];
  }

  else
  {
    v17 = a2[1].__r_.__value_.__l.__data_;
  }

  v37 = xpc_string_create(v17);
  if (!v37)
  {
    v37 = xpc_null_create();
  }

  v51 = &v45;
  v52 = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v51, &v37, &v38);
  xpc_release(v38);
  v38 = 0;
  xpc_release(v37);
  v18 = v45;
  v36 = v45;
  v37 = 0;
  if (v45)
  {
    xpc_retain(v45);
  }

  else
  {
    v18 = xpc_null_create();
    v36 = v18;
  }

  IMSSMSManager::reportSendStatus(&a2->__r_.__value_.__l.__data_, &v36);
  xpc_release(v18);
  v36 = 0;
  xpc_release(v45);
LABEL_85:
  SipUri::~SipUri(__p);
  if (v83)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v83);
  }

  if (SBYTE7(v91) < 0)
  {
    operator delete(v90);
  }
}

void sub_1E513A708(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, void *a20, uint64_t a21, int a22, __int16 a23, char a24, char a25, uint64_t a26, char a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, xpc_object_t object, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41, int a42, __int16 a43, char a44, char a45, uint64_t a46, char a47, void *__p, uint64_t a49, int a50, __int16 a51, char a52, char a53, uint64_t a54, uint64_t a55, void *a56, uint64_t a57, int a58, __int16 a59, char a60, char a61)
{
  if (a53 < 0)
  {
    operator delete(__p);
  }

  SipUri::~SipUri(&a56);
  v63 = *(v61 - 160);
  if (v63)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v63);
  }

  if (*(v61 - 57) < 0)
  {
    operator delete(*(v61 - 80));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::reportLazuliSpam(uint64_t a1, uint64_t a2, uint64_t a3, std::string *a4, int a5, std::string *a6, uint64_t a7, void **a8, char **a9, uint64_t a10, char **a11)
{
  v95 = 0u;
  v94 = 0u;
  v93 = 0u;
  BambiClient::clientConfigForStackId(&v93);
  std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
  v88 = v93;
  v89 = DWORD2(v93);
  if (SBYTE7(v95) < 0)
  {
    std::string::__init_copy_ctor_external(&v90, v94, *(&v94 + 1));
  }

  else
  {
    *&v90.__r_.__value_.__l.__data_ = v94;
    v90.__r_.__value_.__r.__words[2] = v95;
  }

  v91 = BYTE8(v95);
  v92 = 1;
  v18 = ims::debug(&__p, &v88);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), "IMSSMSManager::reportLazuliSpam for ", 36);
  *(v18 + 17) = 0;
  if (a5)
  {
    v19 = "Chatbot";
  }

  else
  {
    v19 = "Contact";
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v18 + 8), v19, 7);
  *(v18 + 17) = 0;
  (*(*v18 + 64))(v18, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v18 + 17) = 0;
  if (v92 == 1 && SHIBYTE(v90.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v90.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  v86 = 0;
  v87 = 0;
  IPTelephonyManager::getBambiClient(&v86);
  v85 = 0;
  memset(v84, 0, sizeof(v84));
  SipUri::SipUri(v84);
  v83 = 0;
  memset(v82, 0, sizeof(v82));
  SipUri::SipUri(v82);
  memset(&v81, 0, sizeof(v81));
  memset(v80, 0, sizeof(v80));
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(v80, *a2, *(a2 + 8));
  }

  else
  {
    v80[0] = *a2;
  }

  if (*(a7 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v80[1], *a7, *(a7 + 8));
  }

  else
  {
    v80[1] = *a7;
  }

  if (*(a3 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v81, *a3, *(a3 + 8));
  }

  else
  {
    v81 = *a3;
  }

  if ((SipUri::fromString(v84, a4) & 1) == 0)
  {
    std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
    v75 = v93;
    v76 = DWORD2(v93);
    if (SBYTE7(v95) < 0)
    {
      std::string::__init_copy_ctor_external(&v77, v94, *(&v94 + 1));
    }

    else
    {
      *&v77.__r_.__value_.__l.__data_ = v94;
      v77.__r_.__value_.__r.__words[2] = v95;
    }

    v78 = BYTE8(v95);
    v79 = 1;
    v20 = ims::error(&__p, &v75);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v20 + 8), "Invalid URI", 11);
    *(v20 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v20 + 8), " (destination) : ", 17);
    *(v20 + 17) = 0;
    (*(*v20 + 32))(v20, a4);
    (*(*v20 + 64))(v20, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v20 + 17) = 0;
    if (v79 == 1 && SHIBYTE(v77.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v77.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

    goto LABEL_34;
  }

  if (SipUri::fromString(v82, a6))
  {
    goto LABEL_45;
  }

  if ((a5 & 1) == 0)
  {
    std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
    v70 = v93;
    v71 = DWORD2(v93);
    if (SBYTE7(v95) < 0)
    {
      std::string::__init_copy_ctor_external(&v72, v94, *(&v94 + 1));
    }

    else
    {
      *&v72.__r_.__value_.__l.__data_ = v94;
      v72.__r_.__value_.__r.__words[2] = v95;
    }

    v73 = BYTE8(v95);
    v74 = 1;
    v29 = ims::error(&__p, &v70);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), "Invalid URI", 11);
    *(v29 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v29 + 8), " (spam reporting uri) : ", 24);
    *(v29 + 17) = 0;
    (*(*v29 + 32))(v29, a6);
    (*(*v29 + 64))(v29, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v29 + 17) = 0;
    if (v74 == 1 && SHIBYTE(v72.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v72.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

LABEL_34:
    std::string::basic_string[abi:ne200100]<0>(&__p, "Invalid URI");
    IMSSMSManager::reportLazuliSpam(std::string const&,std::string const&,std::string const&,BOOL,std::string,std::string const&,xpc::array const&,std::vector<unsigned char> const&,std::string const&,std::vector<unsigned char> const&)::$_0::operator()(v80, &__p);
    if ((SHIBYTE(__p.__r_.__value_.__r.__words[2]) & 0x80000000) == 0)
    {
      goto LABEL_134;
    }

    v21 = __p.__r_.__value_.__r.__words[0];
    goto LABEL_133;
  }

  std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
  v65 = v93;
  v66 = DWORD2(v93);
  if (SBYTE7(v95) < 0)
  {
    std::string::__init_copy_ctor_external(&v67, v94, *(&v94 + 1));
  }

  else
  {
    *&v67.__r_.__value_.__l.__data_ = v94;
    v67.__r_.__value_.__r.__words[2] = v95;
  }

  v68 = BYTE8(v95);
  v69 = 1;
  v22 = ims::warn(&__p, &v65);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), "spam reporting uri (", 20);
  *(v22 + 17) = 0;
  (*(*v22 + 32))(v22, a6);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v22 + 8), ") is invalid. Reporting chatbot spam to chatbot URI ", 52);
  *(v22 + 17) = 0;
  (*(*v22 + 64))(v22, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v22 + 17) = 0;
  if (v69 == 1 && SHIBYTE(v67.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v67.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  SipUri::clear(v82);
LABEL_45:
  memset(&v64, 0, sizeof(v64));
  std::string::__init_with_size[abi:ne200100]<std::__wrap_iter<unsigned char const*>,std::__wrap_iter<unsigned char const*>>(&v64, *a11, a11[1], a11[1] - *a11);
  ims::escapeXMLString(&v64, &__p);
  if (SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v64.__r_.__value_.__l.__data_);
  }

  v64 = __p;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0 && v64.__r_.__value_.__l.__size_ >= 0x1F5)
  {
    std::string::resize(&v64, 0x1F4uLL, 0);
  }

  memset(&v63, 0, sizeof(v63));
  std::string::__init_with_size[abi:ne200100]<std::__wrap_iter<unsigned char const*>,std::__wrap_iter<unsigned char const*>>(&v63, *a9, a9[1], a9[1] - *a9);
  ims::escapeXMLString(&v63, &__p);
  if (SHIBYTE(v63.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v63.__r_.__value_.__l.__data_);
  }

  v63 = __p;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0 && v63.__r_.__value_.__l.__size_ >= 0x7D1)
  {
    std::string::resize(&v63, 0x7D0uLL, 0);
  }

  memset(&__s, 0, sizeof(__s));
  std::string::basic_string[abi:ne200100]<0>(&__s, "");
  v37 = 0;
  v38 = 0;
  v23 = v86;
  (*(*v86 + 184))(&v37, v86, a2);
  v24 = v37;
  if (v37)
  {
    ImsUuid::generate(&__p);
    if (v42.__r_.__value_.__s.__data_[7] < 0)
    {
      std::string::__init_copy_ctor_external(&v61, __p.__r_.__value_.__l.__size_, __p.__r_.__value_.__r.__words[2]);
    }

    else
    {
      *&v61.__r_.__value_.__l.__data_ = *&__p.__r_.__value_.__r.__words[1];
      v61.__r_.__value_.__r.__words[2] = v42.__r_.__value_.__r.__words[0];
    }

    if (SHIBYTE(__s.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__s.__r_.__value_.__l.__data_);
    }

    __s = v61;
    *(&v61.__r_.__value_.__s + 23) = 0;
    v61.__r_.__value_.__s.__data_[0] = 0;
    __p.__r_.__value_.__r.__words[0] = &unk_1F5EBEE78;
    if (v42.__r_.__value_.__s.__data_[7] < 0)
    {
      operator delete(__p.__r_.__value_.__l.__size_);
    }

    __p.__r_.__value_.__r.__words[0] = &__s;
    v25 = std::__hash_table<std::__hash_value_type<std::string,std::string>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::string>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::string>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::string>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>((a1 + 512), &__s.__r_.__value_.__l.__data_);
    std::string::operator=((v25 + 5), a3);
    std::string::basic_string[abi:ne200100]<0>(&__p, "laz.mgr");
    v56 = v93;
    v57 = DWORD2(v93);
    if (SBYTE7(v95) < 0)
    {
      std::string::__init_copy_ctor_external(&v58, v94, *(&v94 + 1));
    }

    else
    {
      *&v58.__r_.__value_.__l.__data_ = v94;
      v58.__r_.__value_.__r.__words[2] = v95;
    }

    v59 = BYTE8(v95);
    v60 = 1;
    v26 = ims::debug(&__p, &v56);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "Mapping callId: ", 16);
    *(v26 + 17) = 0;
    (*(*v26 + 32))(v26, &__s);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), " with ctTransId: ", 17);
    *(v26 + 17) = 0;
    (*(*v26 + 32))(v26, a3);
    (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v26 + 17) = 0;
    if (v60 == 1 && SHIBYTE(v58.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v58.__r_.__value_.__l.__data_);
    }
  }

  else
  {
    memset(&__p, 0, sizeof(__p));
    std::string::basic_string[abi:ne200100]<0>(&__p, "Invalid IMS Stack");
    std::string::basic_string[abi:ne200100]<0>(&v61, "laz.mgr");
    v51 = v93;
    v52 = DWORD2(v93);
    if (SBYTE7(v95) < 0)
    {
      std::string::__init_copy_ctor_external(&v53, v94, *(&v94 + 1));
    }

    else
    {
      *&v53.__r_.__value_.__l.__data_ = v94;
      v53.__r_.__value_.__r.__words[2] = v95;
    }

    v54 = BYTE8(v95);
    v55 = 1;
    v27 = ims::error(&v61, &v51);
    (*(*v27 + 32))(v27, &__p);
    (*(*v27 + 64))(v27, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v27[17] = 0;
    if (v55 == 1 && SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v53.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v61.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v61.__r_.__value_.__l.__data_);
    }

    IMSSMSManager::reportLazuliSpam(std::string const&,std::string const&,std::string const&,BOOL,std::string,std::string const&,xpc::array const&,std::vector<unsigned char> const&,std::string const&,std::vector<unsigned char> const&)::$_0::operator()(v80, &__p);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v38)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v38);
  }

  if (v24)
  {
    bzero(&__p, 0x3E8uLL);
    if (*(a2 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&__p, *a2, *(a2 + 8));
    }

    else
    {
      __p = *a2;
    }

    if (*(a3 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&v42, *a3, *(a3 + 8));
    }

    else
    {
      v42 = *a3;
    }

    if (*(a7 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&v43, *a7, *(a7 + 8));
    }

    else
    {
      v43 = *a7;
    }

    if (SHIBYTE(__s.__r_.__value_.__r.__words[2]) < 0)
    {
      std::string::__init_copy_ctor_external(&v44, __s.__r_.__value_.__l.__data_, __s.__r_.__value_.__l.__size_);
    }

    else
    {
      v44 = __s;
    }

    SipUri::SipUri(v45, v82);
    v45[408] = a5;
    SipUri::SipUri(&v46, v84);
    v28 = *a8;
    v47 = v28;
    if (v28)
    {
      xpc_retain(v28);
    }

    else
    {
      v47 = xpc_null_create();
    }

    if (SHIBYTE(v63.__r_.__value_.__r.__words[2]) < 0)
    {
      std::string::__init_copy_ctor_external(&v48, v63.__r_.__value_.__l.__data_, v63.__r_.__value_.__l.__size_);
    }

    else
    {
      v48 = v63;
    }

    if (*(a10 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&v49, *a10, *(a10 + 8));
    }

    else
    {
      *&v49.__r_.__value_.__l.__data_ = *a10;
      v49.__r_.__value_.__r.__words[2] = *(a10 + 16);
    }

    if (SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
    {
      std::string::__init_copy_ctor_external(&v50, v64.__r_.__value_.__l.__data_, v64.__r_.__value_.__l.__size_);
    }

    else
    {
      v50 = v64;
    }

    v40 = BambiClient::reportLazuliSpam(v23, &__p);
    if (v40)
    {
      std::__tree<unsigned int>::__emplace_unique_key_args<unsigned int,unsigned int const&>(a1 + 488, &v40);
    }

    else
    {
      memset(&v61, 0, sizeof(v61));
      std::string::basic_string[abi:ne200100]<0>(&v61, "Invalid IMS Stack");
      std::string::basic_string[abi:ne200100]<0>(&v37, "laz.mgr");
      v32 = v93;
      v33 = DWORD2(v93);
      if (SBYTE7(v95) < 0)
      {
        std::string::__init_copy_ctor_external(&v34, v94, *(&v94 + 1));
      }

      else
      {
        *&v34.__r_.__value_.__l.__data_ = v94;
        v34.__r_.__value_.__r.__words[2] = v95;
      }

      v35 = BYTE8(v95);
      v36 = 1;
      v30 = ims::error(&v37, &v32);
      (*(*v30 + 32))(v30, &v61);
      (*(*v30 + 64))(v30, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      v30[17] = 0;
      if (v36 == 1 && SHIBYTE(v34.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v34.__r_.__value_.__l.__data_);
      }

      if (v39 < 0)
      {
        operator delete(v37);
      }

      IMSSMSManager::reportLazuliSpam(std::string const&,std::string const&,std::string const&,BOOL,std::string,std::string const&,xpc::array const&,std::vector<unsigned char> const&,std::string const&,std::vector<unsigned char> const&)::$_0::operator()(v80, &v61);
      if (SHIBYTE(v61.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v61.__r_.__value_.__l.__data_);
      }
    }

    LazuliSpamReportParams::~LazuliSpamReportParams(&__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__s.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__s.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v63.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v63.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v64.__r_.__value_.__r.__words[2]) < 0)
  {
    v21 = v64.__r_.__value_.__r.__words[0];
LABEL_133:
    operator delete(v21);
  }

LABEL_134:
  if (SHIBYTE(v81.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v81.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v80[1].__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v80[1].__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v80[0].__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v80[0].__r_.__value_.__l.__data_);
  }

  SipUri::~SipUri(v82);
  SipUri::~SipUri(v84);
  if (v87)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v87);
  }

  if (SBYTE7(v95) < 0)
  {
    operator delete(v94);
  }
}

void sub_1E513B7EC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, uint64_t a16, ...)
{
  va_start(va, a16);
  if (a15 < 0)
  {
    operator delete(__p);
  }

  if (SLOBYTE(STACK[0x4D7]) < 0)
  {
    operator delete(STACK[0x4C0]);
  }

  LazuliSpamReportParams::~LazuliSpamReportParams(va);
  if (SLOBYTE(STACK[0x4F7]) < 0)
  {
    operator delete(STACK[0x4E0]);
  }

  if (SLOBYTE(STACK[0x517]) < 0)
  {
    operator delete(STACK[0x500]);
  }

  if (SLOBYTE(STACK[0x537]) < 0)
  {
    operator delete(STACK[0x520]);
  }

  SipLazuliManager::OutgoingMsrp::~OutgoingMsrp(&STACK[0x5E0]);
  SipUri::~SipUri(&STACK[0x630]);
  SipUri::~SipUri(&STACK[0x7D0]);
  v18 = *(v16 - 208);
  if (v18)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v18);
  }

  if (*(v16 - 105) < 0)
  {
    operator delete(*(v16 - 128));
  }

  _Unwind_Resume(a1);
}

void sub_1E513BB88(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26)
{
  if (*(v26 - 152) == 1 && *(v26 - 161) < 0)
  {
    operator delete(*(v26 - 184));
  }

  if (a26 < 0)
  {
    operator delete(a21);
  }

  JUMPOUT(0x1E513BB70);
}

void IMSSMSManager::reportLazuliSpam(std::string const&,std::string const&,std::string const&,BOOL,std::string,std::string const&,xpc::array const&,std::vector<unsigned char> const&,std::string const&,std::vector<unsigned char> const&)::$_0::operator()(uint64_t a1, uint64_t a2)
{
  v23 = 0;
  v24 = 0;
  IMSClientManager::lazuliDelegateForStack(a1, &v23);
  if (!v23)
  {
    goto LABEL_29;
  }

  v22 = 0;
  v4 = xpc_dictionary_create(0, 0, 0);
  v5 = v4;
  if (v4)
  {
    v22 = v4;
  }

  else
  {
    v5 = xpc_null_create();
    v22 = v5;
    if (!v5)
    {
      v6 = xpc_null_create();
      v5 = 0;
      goto LABEL_9;
    }
  }

  if (MEMORY[0x1E6924740](v5) != MEMORY[0x1E69E9E80])
  {
    v6 = xpc_null_create();
LABEL_9:
    v22 = v6;
    goto LABEL_10;
  }

  xpc_retain(v5);
LABEL_10:
  xpc_release(v5);
  object = xpc_BOOL_create(0);
  if (!object)
  {
    object = xpc_null_create();
  }

  v18 = &v22;
  v19 = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v18, &object, &v21);
  xpc_release(v21);
  v21 = 0;
  xpc_release(object);
  object = 0;
  if (*(a2 + 23) >= 0)
  {
    v7 = a2;
  }

  else
  {
    v7 = *a2;
  }

  v16 = xpc_string_create(v7);
  if (!v16)
  {
    v16 = xpc_null_create();
  }

  v18 = &v22;
  v19 = "kReason";
  xpc::dict::object_proxy::operator=(&v18, &v16, &v17);
  xpc_release(v17);
  v17 = 0;
  xpc_release(v16);
  v16 = 0;
  v8 = (a1 + 24);
  if (*(a1 + 47) < 0)
  {
    v8 = *v8;
  }

  v14 = xpc_string_create(v8);
  if (!v14)
  {
    v14 = xpc_null_create();
  }

  v18 = &v22;
  v19 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v18, &v14, &v15);
  xpc_release(v15);
  v15 = 0;
  xpc_release(v14);
  v14 = 0;
  v9 = (a1 + 48);
  if (*(a1 + 71) < 0)
  {
    v9 = *v9;
  }

  v12 = xpc_string_create(v9);
  if (!v12)
  {
    v12 = xpc_null_create();
  }

  v18 = &v22;
  v19 = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v18, &v12, &v13);
  xpc_release(v13);
  v13 = 0;
  xpc_release(v12);
  v10 = v23;
  v11 = v22;
  v12 = 0;
  if (v22)
  {
    xpc_retain(v22);
  }

  else
  {
    v11 = xpc_null_create();
  }

  (*(*v10 + 120))(v10, &v11);
  xpc_release(v11);
  v11 = 0;
  xpc_release(v22);
LABEL_29:
  if (v24)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v24);
  }
}

void sub_1E513BE5C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, xpc_object_t object)
{
  xpc_release(object);
  xpc_release(*(v9 - 56));
  v11 = *(v9 - 40);
  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::handleLazuliSpamReportResponse(uint64_t a1, void **a2, unsigned int a3, uint64_t a4)
{
  v51 = 0u;
  v52 = 0u;
  v50 = 0u;
  BambiClient::clientConfigForStackId(&v50);
  std::string::basic_string[abi:ne200100]<0>(&v53, "laz.mgr");
  v45 = v50;
  v46 = DWORD2(v50);
  if (SBYTE7(v52) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v51, *(&v51 + 1));
  }

  else
  {
    *&__p.__r_.__value_.__l.__data_ = v51;
    __p.__r_.__value_.__r.__words[2] = v52;
  }

  v48 = BYTE8(v52);
  v49 = 1;
  v8 = ims::debug(&v53, &v45);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "IMSSMSManager::handleLazuliSpamReportResponse - statusCode: ", 60);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923340](*(v8 + 8), *(a4 + 16));
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v49 == 1 && SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v53.__r_.__value_.__l.__data_);
  }

  v44 = 0;
  v9 = xpc_dictionary_create(0, 0, 0);
  v10 = v9;
  if (v9)
  {
    v44 = v9;
  }

  else
  {
    v10 = xpc_null_create();
    v44 = v10;
    if (!v10)
    {
      v11 = xpc_null_create();
      v10 = 0;
      goto LABEL_16;
    }
  }

  if (MEMORY[0x1E6924740](v10) == MEMORY[0x1E69E9E80])
  {
    xpc_retain(v10);
    goto LABEL_17;
  }

  v11 = xpc_null_create();
LABEL_16:
  v44 = v11;
LABEL_17:
  xpc_release(v10);
  v12 = *(a4 + 16);
  if ((v12 - 200) > 0x63)
  {
    v40 = xpc_BOOL_create(0);
    if (!v40)
    {
      v40 = xpc_null_create();
    }

    v53.__r_.__value_.__r.__words[0] = &v44;
    v53.__r_.__value_.__l.__size_ = "kIsSuccess";
    xpc::dict::object_proxy::operator=(&v53, &v40, &v41);
    xpc_release(v41);
    v41 = 0;
    xpc_release(v40);
    v40 = 0;
  }

  else
  {
    v42 = xpc_BOOL_create(1);
    if (!v42)
    {
      v42 = xpc_null_create();
    }

    v53.__r_.__value_.__r.__words[0] = &v44;
    v53.__r_.__value_.__l.__size_ = "kIsSuccess";
    xpc::dict::object_proxy::operator=(&v53, &v42, &object);
    xpc_release(object);
    object = 0;
    xpc_release(v42);
    v42 = 0;
  }

  v38 = xpc_int64_create(v12);
  if (!v38)
  {
    v38 = xpc_null_create();
  }

  v53.__r_.__value_.__r.__words[0] = &v44;
  v53.__r_.__value_.__l.__size_ = "kErrorCode";
  xpc::dict::object_proxy::operator=(&v53, &v38, &v39);
  xpc_release(v39);
  v39 = 0;
  xpc_release(v38);
  v38 = 0;
  memset(&v53, 0, sizeof(v53));
  (*(*a4 + 24))(&v37, a4);
  if (SHIBYTE(v37.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&v53, v37.__r_.__value_.__l.__data_, v37.__r_.__value_.__l.__size_);
    if (SHIBYTE(v37.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v37.__r_.__value_.__l.__data_);
    }
  }

  else
  {
    v53 = v37;
  }

  size = HIBYTE(v53.__r_.__value_.__r.__words[2]);
  v14 = HIBYTE(v53.__r_.__value_.__r.__words[2]);
  if ((v53.__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
  {
    size = v53.__r_.__value_.__l.__size_;
  }

  if (size)
  {
    (*(*a4 + 24))(&v37, a4);
    if ((v37.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v15 = &v37;
    }

    else
    {
      v15 = v37.__r_.__value_.__r.__words[0];
    }

    v35 = xpc_string_create(v15);
    if (!v35)
    {
      v35 = xpc_null_create();
    }

    v34[0] = &v44;
    v34[1] = "kReason";
    xpc::dict::object_proxy::operator=(v34, &v35, &v36);
    xpc_release(v36);
    v36 = 0;
    xpc_release(v35);
    v35 = 0;
    if (SHIBYTE(v37.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v37.__r_.__value_.__l.__data_);
    }

    v14 = HIBYTE(v53.__r_.__value_.__r.__words[2]);
  }

  if (v14 < 0)
  {
    operator delete(v53.__r_.__value_.__l.__data_);
  }

  memset(&v37, 0, sizeof(v37));
  if (*(a4 + 87) < 0)
  {
    std::string::__init_copy_ctor_external(&v37, *(a4 + 64), *(a4 + 72));
  }

  else
  {
    v37 = *(a4 + 64);
  }

  v16 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 512), &v37.__r_.__value_.__l.__data_);
  v17 = v16;
  if (v16)
  {
    v18 = (v16 + 5);
    if (*(v17 + 63) < 0)
    {
      v18 = *v18;
    }

    v32 = xpc_string_create(v18);
    if (!v32)
    {
      v32 = xpc_null_create();
    }

    v53.__r_.__value_.__r.__words[0] = &v44;
    v53.__r_.__value_.__l.__size_ = "kTransactionId";
    xpc::dict::object_proxy::operator=(&v53, &v32, &v33);
    xpc_release(v33);
    v33 = 0;
    xpc_release(v32);
    v32 = 0;
    std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>>>::remove((a1 + 512), v17, &v53);
    std::unique_ptr<std::__hash_node<std::__hash_value_type<std::string,std::string>,void *>,std::__hash_node_destructor<std::allocator<std::__hash_node<std::__hash_value_type<std::string,std::string>,void *>>>>::~unique_ptr[abi:ne200100](&v53);
  }

  else
  {
    std::string::basic_string[abi:ne200100]<0>(&v53, "laz.mgr");
    v27 = v50;
    v28 = DWORD2(v50);
    if (SBYTE7(v52) < 0)
    {
      std::string::__init_copy_ctor_external(&v29, v51, *(&v51 + 1));
    }

    else
    {
      *&v29.__r_.__value_.__l.__data_ = v51;
      v29.__r_.__value_.__r.__words[2] = v52;
    }

    v30 = BYTE8(v52);
    v31 = 1;
    v19 = ims::warn(&v53, &v27);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "IMSSMSManager::handleLazuliSpamReportResponse - unknown callId: ", 64);
    *(v19 + 17) = 0;
    (*(*v19 + 32))(v19, &v37);
    (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v19 + 17) = 0;
    if (v31 == 1 && SHIBYTE(v29.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v29.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(v53.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v53.__r_.__value_.__l.__data_);
    }
  }

  *&v53.__r_.__value_.__l.__data_ = 0uLL;
  IMSClientManager::lazuliDelegateForStack(a2, &v53);
  v20 = v53.__r_.__value_.__r.__words[0];
  if (v53.__r_.__value_.__r.__words[0])
  {
    v26 = v44;
    if (v44)
    {
      xpc_retain(v44);
    }

    else
    {
      v26 = xpc_null_create();
    }

    (*(*v20 + 120))(v20, &v26);
    xpc_release(v26);
    v26 = 0;
  }

  if (v53.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v53.__r_.__value_.__l.__size_);
  }

  v21 = *(a1 + 496);
  if (v21)
  {
    v22 = a1 + 496;
    do
    {
      v23 = *(v21 + 28);
      v24 = v23 >= a3;
      v25 = v23 < a3;
      if (v24)
      {
        v22 = v21;
      }

      v21 = *(v21 + 8 * v25);
    }

    while (v21);
    if (v22 != a1 + 496 && *(v22 + 28) <= a3)
    {
      std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 488), v22);
      operator delete(v22);
    }
  }

  if (SHIBYTE(v37.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v37.__r_.__value_.__l.__data_);
  }

  xpc_release(v44);
  if (SBYTE7(v52) < 0)
  {
    operator delete(v51);
  }
}

void sub_1E513C5A0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, xpc_object_t a9, uint64_t a10, uint64_t a11, void *a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, void *__p, uint64_t a27, int a28, __int16 a29, char a30, char a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, xpc_object_t object, uint64_t a40, uint64_t a41, void *a42, uint64_t a43, int a44, __int16 a45, char a46, char a47, uint64_t a48, char a49)
{
  if (*(v49 - 73) < 0)
  {
    operator delete(*(v49 - 96));
  }

  if (a31 < 0)
  {
    operator delete(__p);
  }

  xpc_release(object);
  if (*(v49 - 105) < 0)
  {
    operator delete(*(v49 - 128));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::getCapabilities(uint64_t a1, void **a2, uint64_t a3, uint64_t a4)
{
  v79 = 0u;
  v80 = 0u;
  v78 = 0u;
  BambiClient::clientConfigForStackId(&v78);
  std::string::basic_string[abi:ne200100]<0>(__p, "laz.mgr");
  v73 = v78;
  v74 = DWORD2(v78);
  if (SBYTE7(v80) < 0)
  {
    std::string::__init_copy_ctor_external(&v75, v79, *(&v79 + 1));
  }

  else
  {
    *&v75.__r_.__value_.__l.__data_ = v79;
    v75.__r_.__value_.__r.__words[2] = v80;
  }

  v76 = BYTE8(v80);
  v77 = 1;
  v7 = ims::debug(__p, &v73);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "IMSSMSManager::getCapabilities", 30);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v77 == 1 && SHIBYTE(v75.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v75.__r_.__value_.__l.__data_);
  }

  if (SBYTE7(v46) < 0)
  {
    operator delete(__p[0]);
  }

  v71 = 0;
  v72 = 0;
  IPTelephonyManager::getBambiClient(&v71);
  v70 = 0;
  v68 = 0u;
  v69 = 0u;
  v66 = 0u;
  v67 = 0u;
  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  *__p = 0u;
  SipUri::SipUri(__p);
  IPTelephonyManager::instance(&v40);
  v8 = v40;
  v9 = v71;
  (*(*v71 + 184))(&v43, v71, a2);
  OutgoingUri = IPTelephonyManager::makeOutgoingUri(v8, &v43, a4, __p);
  if (v44)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v44);
  }

  if (v41)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v41);
  }

  if (OutgoingUri)
  {
    BambiClient::sendOptionsRequest(v9, a2, a3, __p);
    goto LABEL_59;
  }

  std::string::basic_string[abi:ne200100]<0>(&v40, "laz.mgr");
  v35 = v78;
  v36 = DWORD2(v78);
  if (SBYTE7(v80) < 0)
  {
    std::string::__init_copy_ctor_external(&v37, v79, *(&v79 + 1));
  }

  else
  {
    *&v37.__r_.__value_.__l.__data_ = v79;
    v37.__r_.__value_.__r.__words[2] = v80;
  }

  v38 = BYTE8(v80);
  v39 = 1;
  v11 = ims::error(&v40, &v35);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "Invalid URI", 11);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), ": ", 2);
  *(v11 + 17) = 0;
  (*(*v11 + 32))(v11, a3);
  (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v11 + 17) = 0;
  if (v39 == 1 && SHIBYTE(v37.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v37.__r_.__value_.__l.__data_);
  }

  if (v42 < 0)
  {
    operator delete(v40);
  }

  v40 = 0;
  v41 = 0;
  IMSClientManager::lazuliDelegateForStack(a2, &v40);
  if (v40)
  {
    v34 = 0;
    v12 = xpc_dictionary_create(0, 0, 0);
    v13 = v12;
    if (v12)
    {
      v34 = v12;
    }

    else
    {
      v13 = xpc_null_create();
      v34 = v13;
      if (!v13)
      {
        v14 = xpc_null_create();
        v13 = 0;
        goto LABEL_31;
      }
    }

    if (MEMORY[0x1E6924740](v13) == MEMORY[0x1E69E9E80])
    {
      xpc_retain(v13);
LABEL_32:
      xpc_release(v13);
      v32 = xpc_BOOL_create(0);
      if (!v32)
      {
        v32 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kIsSuccess";
      xpc::dict::object_proxy::operator=(&v30, &v32, &object);
      xpc_release(object);
      object = 0;
      xpc_release(v32);
      v32 = 0;
      v28 = xpc_int64_create(0);
      if (!v28)
      {
        v28 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kServiceMask";
      xpc::dict::object_proxy::operator=(&v30, &v28, &v29);
      xpc_release(v29);
      v29 = 0;
      xpc_release(v28);
      v28 = 0;
      v26 = xpc_string_create("Invalid URI");
      if (!v26)
      {
        v26 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kReason";
      xpc::dict::object_proxy::operator=(&v30, &v26, &v27);
      xpc_release(v27);
      v27 = 0;
      xpc_release(v26);
      v26 = 0;
      if (*(a3 + 23) >= 0)
      {
        v15 = a3;
      }

      else
      {
        v15 = *a3;
      }

      v24 = xpc_string_create(v15);
      if (!v24)
      {
        v24 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kTransactionId";
      xpc::dict::object_proxy::operator=(&v30, &v24, &v25);
      xpc_release(v25);
      v25 = 0;
      xpc_release(v24);
      v24 = 0;
      if (*(a4 + 23) >= 0)
      {
        v16 = a4;
      }

      else
      {
        v16 = *a4;
      }

      v22 = xpc_string_create(v16);
      if (!v22)
      {
        v22 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kRemoteUri";
      xpc::dict::object_proxy::operator=(&v30, &v22, &v23);
      xpc_release(v23);
      v23 = 0;
      xpc_release(v22);
      v22 = 0;
      if (*(a4 + 23) >= 0)
      {
        v17 = a4;
      }

      else
      {
        v17 = *a4;
      }

      v20 = xpc_string_create(v17);
      if (!v20)
      {
        v20 = xpc_null_create();
      }

      v30 = &v34;
      v31 = "kRemoteIdentity";
      xpc::dict::object_proxy::operator=(&v30, &v20, &v21);
      xpc_release(v21);
      v21 = 0;
      xpc_release(v20);
      v18 = v40;
      v19 = v34;
      v20 = 0;
      if (v34)
      {
        xpc_retain(v34);
      }

      else
      {
        v19 = xpc_null_create();
      }

      (*(*v18 + 96))(v18, &v19);
      xpc_release(v19);
      v19 = 0;
      xpc_release(v34);
      goto LABEL_57;
    }

    v14 = xpc_null_create();
LABEL_31:
    v34 = v14;
    goto LABEL_32;
  }

LABEL_57:
  if (v41)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v41);
  }

LABEL_59:
  SipUri::~SipUri(__p);
  if (v72)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v72);
  }

  if (SBYTE7(v80) < 0)
  {
    operator delete(v79);
  }
}

void sub_1E513CDB4(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, xpc_object_t object, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, xpc_object_t a24, uint64_t a25, uint64_t a26, void *a27, uint64_t a28, int a29, __int16 a30, char a31, char a32, uint64_t a33, char a34, void *__p, uint64_t a36, int a37, __int16 a38, char a39, char a40, uint64_t a41, uint64_t a42, void *a43, uint64_t a44, int a45, __int16 a46, char a47, char a48)
{
  if (a40 < 0)
  {
    operator delete(__p);
  }

  SipUri::~SipUri(&a43);
  v50 = *(v48 - 176);
  if (v50)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v50);
  }

  if (*(v48 - 73) < 0)
  {
    operator delete(*(v48 - 96));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::handleIncomingLazuli(IMSSMSManager *this, const LazuliReceiveParams *a2)
{
  v60 = *MEMORY[0x1E69E9840];
  v57[0] = 0;
  v57[1] = 0;
  v58 = 0;
  SipUri::asString(a2 + 24, v57);
  v55[0] = 0;
  v55[1] = 0;
  v56 = 0;
  v4 = SipUri::anonymousUri(v3);
  if ((SipUri::equals(v4, (a2 + 432), 1) & 1) == 0)
  {
    SipUri::asString(a2 + 432, v55);
  }

  v53 = 0u;
  v54 = 0u;
  v52 = 0u;
  BambiClient::clientConfigForStackId(&v52);
  std::string::basic_string[abi:ne200100]<0>(&v49, "laz.mgr");
  v44 = v52;
  v45 = DWORD2(v52);
  if (SBYTE7(v54) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v53, *(&v53 + 1));
  }

  else
  {
    *&__p.__r_.__value_.__l.__data_ = v53;
    __p.__r_.__value_.__r.__words[2] = v54;
  }

  v47 = BYTE8(v54);
  v48 = 1;
  v5 = ims::debug(&v49, &v44);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "incoming(stackId: ", 18);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), " sender: ", 9);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, v57);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), " remote identity: <", 19);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, v55);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "> Contribution-ID: [", 20);
  *(v5 + 17) = 0;
  (*(*v5 + 32))(v5, a2 + 864);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "] body length:", 14);
  *(v5 + 17) = 0;
  MEMORY[0x1E6923370](*(v5 + 8), *(a2 + 118) - *(a2 + 117));
  *(v5 + 17) = 0;
  v6 = *(v5 + 8);
  LOBYTE(v25) = 41;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, &v25, 1);
  *(v5 + 17) = 0;
  (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v5 + 17) = 0;
  if (v48 == 1 && SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v51 < 0)
  {
    operator delete(v49);
  }

  v43 = 0;
  v7 = xpc_dictionary_create(0, 0, 0);
  v8 = v7;
  if (v7)
  {
    v43 = v7;
  }

  else
  {
    v8 = xpc_null_create();
    v43 = v8;
    if (!v8)
    {
      v9 = xpc_null_create();
      v8 = 0;
      goto LABEL_18;
    }
  }

  if (MEMORY[0x1E6924740](v8) == MEMORY[0x1E69E9E80])
  {
    xpc_retain(v8);
    goto LABEL_19;
  }

  v9 = xpc_null_create();
LABEL_18:
  v43 = v9;
LABEL_19:
  xpc_release(v8);
  if (*(a2 + 863) >= 0)
  {
    v10 = a2 + 840;
  }

  else
  {
    v10 = *(a2 + 105);
  }

  v41 = xpc_string_create(v10);
  if (!v41)
  {
    v41 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v49, &v41, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v41);
  v41 = 0;
  if (*(a2 + 887) >= 0)
  {
    v11 = a2 + 864;
  }

  else
  {
    v11 = *(a2 + 108);
  }

  v39 = xpc_string_create(v11);
  if (!v39)
  {
    v39 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kContributionId";
  xpc::dict::object_proxy::operator=(&v49, &v39, &v40);
  xpc_release(v40);
  v40 = 0;
  xpc_release(v39);
  v39 = 0;
  if (v58 >= 0)
  {
    v12 = v57;
  }

  else
  {
    v12 = v57[0];
  }

  v37 = xpc_string_create(v12);
  if (!v37)
  {
    v37 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kRemoteUri";
  xpc::dict::object_proxy::operator=(&v49, &v37, &v38);
  xpc_release(v38);
  v38 = 0;
  xpc_release(v37);
  v37 = 0;
  if (v56 >= 0)
  {
    v13 = v55;
  }

  else
  {
    v13 = v55[0];
  }

  v35 = xpc_string_create(v13);
  if (!v35)
  {
    v35 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kRemoteIdentity";
  xpc::dict::object_proxy::operator=(&v49, &v35, &v36);
  xpc_release(v36);
  v36 = 0;
  xpc_release(v35);
  v35 = 0;
  if (*(a2 + 911) >= 0)
  {
    v14 = a2 + 888;
  }

  else
  {
    v14 = *(a2 + 111);
  }

  v33 = xpc_string_create(v14);
  if (!v33)
  {
    v33 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kInReplyToContributionId";
  xpc::dict::object_proxy::operator=(&v49, &v33, &v34);
  xpc_release(v34);
  v34 = 0;
  xpc_release(v33);
  v33 = 0;
  if (*(a2 + 935) >= 0)
  {
    v15 = a2 + 912;
  }

  else
  {
    v15 = *(a2 + 114);
  }

  v31 = xpc_string_create(v15);
  if (!v31)
  {
    v31 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kContentType";
  xpc::dict::object_proxy::operator=(&v49, &v31, &v32);
  xpc_release(v32);
  v32 = 0;
  xpc_release(v31);
  v31 = 0;
  v29 = xpc_data_create(*(a2 + 117), *(a2 + 118) - *(a2 + 117));
  if (!v29)
  {
    v29 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kBody";
  xpc::dict::object_proxy::operator=(&v49, &v29, &v30);
  xpc_release(v30);
  v30 = 0;
  xpc_release(v29);
  v29 = 0;
  v27 = xpc_BOOL_create(*(a2 + 960));
  if (!v27)
  {
    v27 = xpc_null_create();
  }

  v49 = &v43;
  v50 = "kIsGroupChat";
  xpc::dict::object_proxy::operator=(&v49, &v27, &v28);
  xpc_release(v28);
  v28 = 0;
  xpc_release(v27);
  v26 = 0;
  v27 = 0;
  v25 = 0;
  IMSClientManager::lazuliDelegateForStack(a2, &v25);
  v16 = v25;
  if (v25)
  {
    v24 = v43;
    if (v43)
    {
      xpc_retain(v43);
    }

    else
    {
      v24 = xpc_null_create();
    }

    std::__function::__value_func<void ()(void)>::__value_func[abi:ne200100](v59, a2 + 968);
    LazuliDelegate::handleMessageReceivedWithCompletion(v16, &v24, v59);
    std::__function::__value_func<void ()(void)>::~__value_func[abi:ne200100](v59);
    xpc_release(v24);
    v24 = 0;
  }

  else
  {
    std::string::basic_string[abi:ne200100]<0>(&v49, "laz.mgr");
    v19 = v52;
    v20 = DWORD2(v52);
    if (SBYTE7(v54) < 0)
    {
      std::string::__init_copy_ctor_external(&v21, v53, *(&v53 + 1));
    }

    else
    {
      *&v21.__r_.__value_.__l.__data_ = v53;
      v21.__r_.__value_.__r.__words[2] = v54;
    }

    v22 = BYTE8(v54);
    v23 = 1;
    v17 = ims::error(&v49, &v19);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "No lazuli delegate set for stackId ", 35);
    *(v17 + 17) = 0;
    (*(*v17 + 32))(v17, a2);
    (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v17 + 17) = 0;
    if (v23 == 1 && SHIBYTE(v21.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v21.__r_.__value_.__l.__data_);
    }

    if (v51 < 0)
    {
      operator delete(v49);
    }
  }

  if (v26)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v26);
  }

  xpc_release(v43);
  if (SBYTE7(v54) < 0)
  {
    operator delete(v53);
  }

  if (SHIBYTE(v56) < 0)
  {
    operator delete(v55[0]);
  }

  if (SHIBYTE(v58) < 0)
  {
    operator delete(v57[0]);
  }

  v18 = *MEMORY[0x1E69E9840];
}

void sub_1E513D73C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, xpc_object_t a20, uint64_t a21, std::__shared_weak_count *a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, xpc_object_t object, uint64_t a40, uint64_t a41, void *a42, uint64_t a43, int a44, __int16 a45, char a46, char a47, uint64_t a48, char a49)
{
  if (*(v49 - 193) < 0)
  {
    operator delete(*(v49 - 216));
  }

  if (a22)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a22);
  }

  xpc_release(object);
  if (*(v49 - 153) < 0)
  {
    operator delete(*(v49 - 176));
  }

  if (*(v49 - 113) < 0)
  {
    operator delete(*(v49 - 136));
  }

  if (*(v49 - 89) < 0)
  {
    operator delete(*(v49 - 112));
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::handleLazuliError(uint64_t a1, void **a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  v57 = 0u;
  v58 = 0u;
  v56 = 0u;
  BambiClient::clientConfigForStackId(&v56);
  std::string::basic_string[abi:ne200100]<0>(&v55, "laz.mgr");
  v50 = v56;
  v51 = DWORD2(v56);
  if (SBYTE7(v58) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v57, *(&v57 + 1));
  }

  else
  {
    *&__p.__r_.__value_.__l.__data_ = v57;
    __p.__r_.__value_.__r.__words[2] = v58;
  }

  v53 = BYTE8(v58);
  v54 = 1;
  v10 = ims::debug(&v55, &v50);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "error(stackId: ", 15);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " messageSequence: ", 18);
  *(v10 + 17) = 0;
  MEMORY[0x1E6923350](*(v10 + 8), a3);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " error: ", 8);
  *(v10 + 17) = 0;
  (*(*a5 + 16))(a5, v10);
  v11 = *(v10 + 8);
  v46.__r_.__value_.__s.__data_[0] = 41;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v11, &v46, 1);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v54 == 1 && SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v55.__r_.__value_.__l.__data_);
  }

  v12 = *(a1 + 496);
  if (v12)
  {
    v13 = a1 + 496;
    do
    {
      v14 = *(v12 + 28);
      v15 = v14 >= a3;
      v16 = v14 < a3;
      if (v15)
      {
        v13 = v12;
      }

      v12 = *(v12 + 8 * v16);
    }

    while (v12);
    if (v13 != a1 + 496 && *(v13 + 28) <= a3)
    {
      (*(*a1 + 104))(a1, a2, a3, a5);
      goto LABEL_89;
    }
  }

  if (*(a5 + 8) != &SipResultDomain::_domain)
  {
    v17 = 0;
LABEL_19:
    v18 = 0;
    goto LABEL_24;
  }

  v17 = *(a5 + 16);
  if (v17 - 486 >= 2 && v17 != 408 && v17 != 380)
  {
    goto LABEL_19;
  }

  v18 = 1;
LABEL_24:
  v49 = 0;
  v19 = xpc_dictionary_create(0, 0, 0);
  v20 = v19;
  if (v19)
  {
    v49 = v19;
  }

  else
  {
    v20 = xpc_null_create();
    v49 = v20;
    if (!v20)
    {
      v21 = xpc_null_create();
      v20 = 0;
      goto LABEL_32;
    }
  }

  if (MEMORY[0x1E6924740](v20) == MEMORY[0x1E69E9E80])
  {
    xpc_retain(v20);
    goto LABEL_33;
  }

  v21 = xpc_null_create();
LABEL_32:
  v49 = v21;
LABEL_33:
  xpc_release(v20);
  v47 = xpc_BOOL_create(0);
  if (!v47)
  {
    v47 = xpc_null_create();
  }

  v55.__r_.__value_.__r.__words[0] = &v49;
  v55.__r_.__value_.__l.__size_ = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v55, &v47, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v47);
  v47 = 0;
  memset(&v55, 0, sizeof(v55));
  (*(*a5 + 24))(&v46, a5);
  if (SHIBYTE(v46.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&v55, v46.__r_.__value_.__l.__data_, v46.__r_.__value_.__l.__size_);
    if (SHIBYTE(v46.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v46.__r_.__value_.__l.__data_);
    }
  }

  else
  {
    v55 = v46;
  }

  size = HIBYTE(v55.__r_.__value_.__r.__words[2]);
  v23 = HIBYTE(v55.__r_.__value_.__r.__words[2]);
  if ((v55.__r_.__value_.__r.__words[2] & 0x8000000000000000) != 0)
  {
    size = v55.__r_.__value_.__l.__size_;
  }

  if (size)
  {
    (*(*a5 + 24))(&v46, a5);
    if ((v46.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v24 = &v46;
    }

    else
    {
      v24 = v46.__r_.__value_.__r.__words[0];
    }

    v44 = xpc_string_create(v24);
    if (!v44)
    {
      v44 = xpc_null_create();
    }

    v43[0] = &v49;
    v43[1] = "kReason";
    xpc::dict::object_proxy::operator=(v43, &v44, &v45);
    xpc_release(v45);
    v45 = 0;
    xpc_release(v44);
    v44 = 0;
    if (SHIBYTE(v46.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v46.__r_.__value_.__l.__data_);
    }

    v23 = HIBYTE(v55.__r_.__value_.__r.__words[2]);
  }

  if ((v23 & 0x80) == 0)
  {
    if (!v17)
    {
      goto LABEL_57;
    }

LABEL_54:
    v41 = xpc_int64_create(v17);
    if (!v41)
    {
      v41 = xpc_null_create();
    }

    v55.__r_.__value_.__r.__words[0] = &v49;
    v55.__r_.__value_.__l.__size_ = "kErrorCode";
    xpc::dict::object_proxy::operator=(&v55, &v41, &v42);
    xpc_release(v42);
    v42 = 0;
    xpc_release(v41);
    v41 = 0;
    goto LABEL_57;
  }

  operator delete(v55.__r_.__value_.__l.__data_);
  if (v17)
  {
    goto LABEL_54;
  }

LABEL_57:
  if (*(a4 + 23) >= 0)
  {
    v25 = a4;
  }

  else
  {
    v25 = *a4;
  }

  v39 = xpc_string_create(v25);
  if (!v39)
  {
    v39 = xpc_null_create();
  }

  v55.__r_.__value_.__r.__words[0] = &v49;
  v55.__r_.__value_.__l.__size_ = "kConversationId";
  xpc::dict::object_proxy::operator=(&v55, &v39, &v40);
  xpc_release(v40);
  v40 = 0;
  xpc_release(v39);
  v39 = 0;
  if (*(a5 + 87) < 0)
  {
    std::string::__init_copy_ctor_external(&v55, *(a5 + 64), *(a5 + 72));
  }

  else
  {
    v55 = *(a5 + 64);
  }

  if ((v55.__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
  {
    v26 = &v55;
  }

  else
  {
    v26 = v55.__r_.__value_.__r.__words[0];
  }

  v37 = xpc_string_create(v26);
  if (!v37)
  {
    v37 = xpc_null_create();
  }

  v46.__r_.__value_.__r.__words[0] = &v49;
  v46.__r_.__value_.__l.__size_ = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v46, &v37, &v38);
  xpc_release(v38);
  v38 = 0;
  xpc_release(v37);
  v37 = 0;
  if (SHIBYTE(v55.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v55.__r_.__value_.__l.__data_);
  }

  v35 = xpc_BOOL_create(v18);
  if (!v35)
  {
    v35 = xpc_null_create();
  }

  v55.__r_.__value_.__r.__words[0] = &v49;
  v55.__r_.__value_.__l.__size_ = "kFallbackNeeded";
  xpc::dict::object_proxy::operator=(&v55, &v35, &v36);
  xpc_release(v36);
  v36 = 0;
  xpc_release(v35);
  v35 = 0;
  v33 = xpc_BOOL_create(0);
  if (!v33)
  {
    v33 = xpc_null_create();
  }

  v55.__r_.__value_.__r.__words[0] = &v49;
  v55.__r_.__value_.__l.__size_ = "kChatbotConversationNeeded";
  xpc::dict::object_proxy::operator=(&v55, &v33, &v34);
  xpc_release(v34);
  v34 = 0;
  xpc_release(v33);
  v27 = v49;
  v32 = v49;
  v33 = 0;
  if (v49)
  {
    xpc_retain(v49);
  }

  else
  {
    v27 = xpc_null_create();
    v32 = v27;
  }

  IMSSMSManager::reportSendStatus(a2, &v32);
  xpc_release(v27);
  v32 = 0;
  v28 = *(a1 + 472);
  if (v28)
  {
    v29 = a1 + 472;
    do
    {
      v30 = *(v28 + 28);
      v15 = v30 >= a3;
      v31 = v30 < a3;
      if (v15)
      {
        v29 = v28;
      }

      v28 = *(v28 + 8 * v31);
    }

    while (v28);
    if (v29 != a1 + 472 && *(v29 + 28) <= a3)
    {
      std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 464), v29);
      operator delete(v29);
    }
  }

  xpc_release(v49);
LABEL_89:
  if (SBYTE7(v58) < 0)
  {
    operator delete(v57);
  }
}

void sub_1E513E058(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, void *__p, uint64_t a25, int a26, __int16 a27, char a28, char a29, uint64_t a30, uint64_t a31, xpc_object_t object, uint64_t a33, uint64_t a34, void *a35, uint64_t a36, int a37, __int16 a38, char a39, char a40, uint64_t a41, char a42)
{
  if (*(v42 - 89) < 0)
  {
    operator delete(*(v42 - 112));
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleLazuliSent(uint64_t a1, void **a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  v49 = 0u;
  v50 = 0u;
  v48 = 0u;
  BambiClient::clientConfigForStackId(&v48);
  std::string::basic_string[abi:ne200100]<0>(&v36, "laz.mgr");
  v43 = v48;
  v44 = DWORD2(v48);
  if (SBYTE7(v50) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v49, *(&v49 + 1));
  }

  else
  {
    *&__p.__r_.__value_.__l.__data_ = v49;
    __p.__r_.__value_.__r.__words[2] = v50;
  }

  v46 = BYTE8(v50);
  v47 = 1;
  v10 = ims::debug(&v36, &v43);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "sent(stackId: ", 14);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " messageSequence:", 17);
  *(v10 + 17) = 0;
  MEMORY[0x1E6923350](*(v10 + 8), a3);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), " ctTransactionId:", 17);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), ")", 1);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v47 == 1 && SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v38) < 0)
  {
    operator delete(v36);
  }

  v11 = *(a1 + 496);
  if (v11)
  {
    v12 = a1 + 496;
    do
    {
      v13 = *(v11 + 28);
      v14 = v13 >= a3;
      v15 = v13 < a3;
      if (v14)
      {
        v12 = v11;
      }

      v11 = *(v11 + 8 * v15);
    }

    while (v11);
    if (v12 != a1 + 496 && *(v12 + 28) <= a3)
    {
      v38 = 0;
      v39 = 0;
      v41 = 0u;
      memset(v42, 0, sizeof(v42));
      v36 = &unk_1F5EBDEF8;
      v37 = &_bambiDomain;
      v40 = 0;
      std::string::operator=(&v42[1], a5);
      LODWORD(v38) = 200;
      (*(*a1 + 104))(a1, a2, a3, &v36);
      ImsResult::~ImsResult(&v36);
      goto LABEL_53;
    }
  }

  v16 = *(a1 + 472);
  if (v16)
  {
    v17 = a1 + 472;
    do
    {
      v18 = *(v16 + 28);
      v14 = v18 >= a3;
      v19 = v18 < a3;
      if (v14)
      {
        v17 = v16;
      }

      v16 = *(v16 + 8 * v19);
    }

    while (v16);
    if (v17 != a1 + 472 && *(v17 + 28) <= a3)
    {
      std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 464), v17);
      operator delete(v17);
    }
  }

  v35 = 0;
  v20 = xpc_dictionary_create(0, 0, 0);
  v21 = v20;
  if (v20)
  {
    v35 = v20;
  }

  else
  {
    v21 = xpc_null_create();
    v35 = v21;
    if (!v21)
    {
      v22 = xpc_null_create();
      v21 = 0;
      goto LABEL_34;
    }
  }

  if (MEMORY[0x1E6924740](v21) != MEMORY[0x1E69E9E80])
  {
    v22 = xpc_null_create();
LABEL_34:
    v35 = v22;
    goto LABEL_35;
  }

  xpc_retain(v21);
LABEL_35:
  xpc_release(v21);
  v33 = xpc_BOOL_create(1);
  if (!v33)
  {
    v33 = xpc_null_create();
  }

  v36 = &v35;
  v37 = "kIsSuccess";
  xpc::dict::object_proxy::operator=(&v36, &v33, &object);
  xpc_release(object);
  object = 0;
  xpc_release(v33);
  v33 = 0;
  v31 = xpc_int64_create(202);
  if (!v31)
  {
    v31 = xpc_null_create();
  }

  v36 = &v35;
  v37 = "kErrorCode";
  xpc::dict::object_proxy::operator=(&v36, &v31, &v32);
  xpc_release(v32);
  v32 = 0;
  xpc_release(v31);
  v31 = 0;
  if (*(a4 + 23) >= 0)
  {
    v23 = a4;
  }

  else
  {
    v23 = *a4;
  }

  v29 = xpc_string_create(v23);
  if (!v29)
  {
    v29 = xpc_null_create();
  }

  v36 = &v35;
  v37 = "kConversationId";
  xpc::dict::object_proxy::operator=(&v36, &v29, &v30);
  xpc_release(v30);
  v30 = 0;
  xpc_release(v29);
  v29 = 0;
  if (*(a5 + 23) >= 0)
  {
    v24 = a5;
  }

  else
  {
    v24 = *a5;
  }

  v27 = xpc_string_create(v24);
  if (!v27)
  {
    v27 = xpc_null_create();
  }

  v36 = &v35;
  v37 = "kTransactionId";
  xpc::dict::object_proxy::operator=(&v36, &v27, &v28);
  xpc_release(v28);
  v28 = 0;
  xpc_release(v27);
  v25 = v35;
  v26 = v35;
  v27 = 0;
  if (v35)
  {
    xpc_retain(v35);
  }

  else
  {
    v25 = xpc_null_create();
    v26 = v25;
  }

  IMSSMSManager::reportSendStatus(a2, &v26);
  xpc_release(v25);
  v26 = 0;
  xpc_release(v35);
LABEL_53:
  if (SBYTE7(v50) < 0)
  {
    operator delete(v49);
  }
}

void sub_1E513E6FC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, xpc_object_t object, void *__p, uint64_t a20, int a21, __int16 a22, char a23, char a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, void *a35, uint64_t a36, int a37, __int16 a38, char a39, char a40, uint64_t a41, char a42)
{
  if (a24 < 0)
  {
    operator delete(__p);
  }

  if (*(v42 - 73) < 0)
  {
    operator delete(*(v42 - 96));
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleLazuliCapabilitiesReceived(int a1, int a2, SipUri *a3, uint64_t a4, int a5, int a6, int a7, int a8, int64_t value)
{
  v11 = xpc_array_create(0, 0);
  if (v11 || (v11 = xpc_null_create()) != 0)
  {
    if (MEMORY[0x1E6924740](v11) == MEMORY[0x1E69E9E50])
    {
      xpc_retain(v11);
    }

    else
    {
      xpc_null_create();
    }
  }

  else
  {
    xpc_null_create();
    v11 = 0;
  }

  xpc_release(v11);
  if (*a4 != *(a4 + 8))
  {
    SipUri::getUriString(*a4);
  }

  v20[0] = 0;
  v12 = xpc_dictionary_create(0, 0, 0);
  v13 = v12;
  if (v12)
  {
    v20[0] = v12;
  }

  else
  {
    v13 = xpc_null_create();
    v20[0] = v13;
    if (!v13)
    {
      v14 = xpc_null_create();
      v13 = 0;
      goto LABEL_16;
    }
  }

  if (MEMORY[0x1E6924740](v13) == MEMORY[0x1E69E9E80])
  {
    xpc_retain(v13);
    goto LABEL_17;
  }

  v14 = xpc_null_create();
LABEL_16:
  v20[0] = v14;
LABEL_17:
  xpc_release(v13);
  v18 = xpc_BOOL_create(1);
  if (!v18)
  {
    v18 = xpc_null_create();
  }

  __p[0] = v20;
  __p[1] = "kIsSuccess";
  xpc::dict::object_proxy::operator=(__p, &v18, &v19);
  xpc_release(v19);
  v19 = 0;
  xpc_release(v18);
  v18 = 0;
  if (value)
  {
    v16 = xpc_int64_create(value);
    if (!v16)
    {
      v16 = xpc_null_create();
    }

    __p[0] = v20;
    __p[1] = "kErrorCode";
    xpc::dict::object_proxy::operator=(__p, &v16, &v17);
    xpc_release(v17);
    v17 = 0;
    xpc_release(v16);
    v16 = 0;
  }

  SipUri::getUriString(a3);
}

void sub_1E513F000(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, void *a13, uint64_t a14, int a15, __int16 a16, char a17, char a18, uint64_t a19, char a20, xpc_object_t object, uint64_t a22, std::__shared_weak_count *a23, uint64_t a24, uint64_t a25, void *a26, uint64_t a27, int a28, __int16 a29, char a30, char a31, uint64_t a32, char a33, void *__p, uint64_t a35, int a36, __int16 a37, char a38, char a39, void *a40, uint64_t a41, void *a42, uint64_t a43, int a44, __int16 a45, char a46, char a47)
{
  if (a39 < 0)
  {
    operator delete(__p);
  }

  if (a23)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a23);
  }

  if (a47 < 0)
  {
    operator delete(a42);
  }

  xpc_release(*(v48 - 96));
  xpc_release(v47);
  _Unwind_Resume(a1);
}

void IMSSMSManager::handleLazuliCapabilitiesError(uint64_t a1, void **a2, uint64_t a3, uint64_t a4, SipUri *a5, uint64_t a6)
{
  v9 = xpc_array_create(0, 0);
  if (v9 || (v9 = xpc_null_create()) != 0)
  {
    if (MEMORY[0x1E6924740](v9) == MEMORY[0x1E69E9E50])
    {
      xpc_retain(v9);
      v10 = v9;
    }

    else
    {
      v10 = xpc_null_create();
    }
  }

  else
  {
    v10 = xpc_null_create();
    v9 = 0;
  }

  xpc_release(v9);
  if (*a6 != *(a6 + 8))
  {
    SipUri::getUriString(*a6);
  }

  v34 = 0u;
  v35 = 0u;
  v33 = 0u;
  BambiClient::clientConfigForStackId(&v33);
  std::string::basic_string[abi:ne200100]<0>(v31, "laz.mgr");
  v26 = v33;
  v27 = DWORD2(v33);
  if (SBYTE7(v35) < 0)
  {
    std::string::__init_copy_ctor_external(&v28, v34, *(&v34 + 1));
  }

  else
  {
    *&v28.__r_.__value_.__l.__data_ = v34;
    v28.__r_.__value_.__r.__words[2] = v35;
  }

  v29 = BYTE8(v35);
  v30 = 1;
  v11 = ims::debug(v31, &v26);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "IMSSMSManager::handleLazuliCapabilitiesError(stackId: ", 54);
  *(v11 + 17) = 0;
  (*(*v11 + 32))(v11, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), ")", 1);
  *(v11 + 17) = 0;
  (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v11 + 17) = 0;
  if (v30 == 1 && SHIBYTE(v28.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v28.__r_.__value_.__l.__data_);
  }

  if (v32 < 0)
  {
    operator delete(v31[0]);
  }

  v24 = 0;
  v25 = 0;
  IMSClientManager::lazuliDelegateForStack(a2, &v24);
  if (v24)
  {
    v23 = 0;
    v12 = xpc_dictionary_create(0, 0, 0);
    v13 = v12;
    if (v12)
    {
      v23 = v12;
    }

    else
    {
      v13 = xpc_null_create();
      v23 = v13;
      if (!v13)
      {
        v14 = xpc_null_create();
        v13 = 0;
        goto LABEL_33;
      }
    }

    if (MEMORY[0x1E6924740](v13) == MEMORY[0x1E69E9E80])
    {
      xpc_retain(v13);
      goto LABEL_34;
    }

    v14 = xpc_null_create();
LABEL_33:
    v23 = v14;
LABEL_34:
    xpc_release(v13);
    v21 = xpc_BOOL_create(1);
    if (!v21)
    {
      v21 = xpc_null_create();
    }

    v31[0] = &v23;
    v31[1] = "kIsSuccess";
    xpc::dict::object_proxy::operator=(v31, &v21, &object);
    xpc_release(object);
    object = 0;
    xpc_release(v21);
    v21 = 0;
    SipUri::getUriString(a5);
  }

  std::string::basic_string[abi:ne200100]<0>(v31, "laz.mgr");
  v16 = v33;
  v17 = DWORD2(v33);
  if (SBYTE7(v35) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v34, *(&v34 + 1));
  }

  else
  {
    *&__p.__r_.__value_.__l.__data_ = v34;
    __p.__r_.__value_.__r.__words[2] = v35;
  }

  v19 = BYTE8(v35);
  v20 = 1;
  v15 = ims::error(v31, &v16);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "No lazuli delegate set for stackId ", 35);
  *(v15 + 17) = 0;
  (*(*v15 + 32))(v15, a2);
  (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v15 + 17) = 0;
  if (v20 == 1 && SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v32 < 0)
  {
    operator delete(v31[0]);
  }

  if (v25)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v25);
  }

  if (SBYTE7(v35) < 0)
  {
    operator delete(v34);
  }

  xpc_release(v10);
}

void sub_1E513F9A8(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, xpc_object_t object, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, xpc_object_t a39, uint64_t a40, std::__shared_weak_count *a41)
{
  if (*(v42 - 129) < 0)
  {
    operator delete(*(v42 - 152));
  }

  if (a41)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a41);
  }

  if (*(v42 - 89) < 0)
  {
    operator delete(*(v42 - 112));
  }

  xpc_release(v41);
  _Unwind_Resume(a1);
}

void IMSSMSManager::handleIncomingMessage(uint64_t a1, void **a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  memset(&__str, 0, sizeof(__str));
  v42 = 0;
  v43 = 0;
  v44 = 0;
  memset(&v41, 0, sizeof(v41));
  SipUri::asString(a3, &__str);
  (*(*a7 + 56))(a7, &v42);
  v10 = (*(*a7 + 40))(a7);
  std::string::operator=(&v41, v10);
  std::string::basic_string[abi:ne200100]<0>(&v27, "sms");
  v37[0] = 0;
  v40 = 0;
  v11 = ims::debug(&v27, v37);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), "IMSSMSManager::handleIncomingMessage(stackId: ", 46);
  *(v11 + 17) = 0;
  (*(*v11 + 32))(v11, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), ", sender:", 9);
  *(v11 + 17) = 0;
  (*(*v11 + 32))(v11, &__str);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), ", body length:", 14);
  *(v11 + 17) = 0;
  if (v44 >= 0)
  {
    v12 = HIBYTE(v44);
  }

  else
  {
    v12 = v43;
  }

  MEMORY[0x1E6923370](*(v11 + 8), v12);
  *(v11 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v11 + 8), ")", 1);
  *(v11 + 17) = 0;
  (*(*v11 + 64))(v11, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v11 + 17) = 0;
  if (v40 == 1 && v39 < 0)
  {
    operator delete(__p);
  }

  if (SBYTE7(v28) < 0)
  {
    operator delete(v27);
  }

  memset(&v36, 0, sizeof(v36));
  if (*(a5 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v36, *a5, *(a5 + 8));
  }

  else
  {
    v36 = *a5;
  }

  *__dst = 0u;
  v35 = 0u;
  v32 = 0u;
  *v33 = 0u;
  *v30 = 0u;
  *v31 = 0u;
  v28 = 0u;
  v29 = 0u;
  v27 = 0u;
  std::string::operator=(&v27, &__str);
  std::string::operator=(&v31[1], &v41);
  std::string::operator=(v33, &v36);
  if (v44 >= 0)
  {
    v13 = &v42;
  }

  else
  {
    v13 = v42;
  }

  if (v44 >= 0)
  {
    v14 = HIBYTE(v44);
  }

  else
  {
    v14 = v43;
  }

  v15 = __dst[1];
  if (*(&v35 + 1) - __dst[1] < v14)
  {
    if (__dst[1])
    {
      *&v35 = __dst[1];
      operator delete(__dst[1]);
      __dst[1] = 0;
      v35 = 0uLL;
    }

    if ((v14 & 0x8000000000000000) == 0)
    {
      operator new();
    }

    std::vector<unsigned char>::__throw_length_error[abi:ne200100]();
  }

  v16 = v35;
  v17 = v35 - __dst[1];
  if (v35 - __dst[1] >= v14)
  {
    if (v14)
    {
      memmove(__dst[1], v13, v14);
    }

    v23 = &v15[v14];
  }

  else
  {
    v18 = v13 + v14;
    v19 = v13 + v17;
    if (v35 != __dst[1])
    {
      memmove(__dst[1], v13, v17);
      v16 = v35;
    }

    v20 = v16;
    if (v19 != v18)
    {
      v20 = (&v16[v13 + v14] - v19);
      v21 = v16;
      do
      {
        v22 = *v19++;
        *v21++ = v22;
      }

      while (v19 != v18);
    }

    v23 = v20;
  }

  *&v35 = v23;
  v24 = IMSClientManager::delegateForStack(a2);
  (*(*(v24 + 48) + 48))();
  if (TelephonyRadiosGetRadioVendor() == 1)
  {
    IPTelephonyManager::instance(&v25);
    IPTelephonyManager::sendCallStatusRequest(v25, a2, 2, 4, 0, 0);
    if (v26)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v26);
    }
  }

  if (__dst[1])
  {
    *&v35 = __dst[1];
    operator delete(__dst[1]);
  }

  if (SHIBYTE(__dst[0]) < 0)
  {
    operator delete(v33[0]);
  }

  if (SHIBYTE(v32) < 0)
  {
    operator delete(v31[1]);
  }

  if (SHIBYTE(v31[0]) < 0)
  {
    operator delete(v30[0]);
  }

  if (SHIBYTE(v29) < 0)
  {
    operator delete(*(&v28 + 1));
  }

  if (SBYTE7(v28) < 0)
  {
    operator delete(v27);
  }

  if (SHIBYTE(v36.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v36.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v41.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v41.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v44) < 0)
  {
    operator delete(v42);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }
}

void sub_1E5140068(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, void *__p, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, uint64_t a39, uint64_t a40, void *a41, uint64_t a42, int a43, __int16 a44, char a45, char a46, uint64_t a47, char a48)
{
  if (*(v48 - 113) < 0)
  {
    operator delete(*(v48 - 136));
  }

  if (*(v48 - 89) < 0)
  {
    operator delete(*(v48 - 112));
  }

  if (*(v48 - 65) < 0)
  {
    operator delete(*(v48 - 88));
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleMessageRequestReceived(uint64_t a1, uint64_t a2)
{
  if (TelephonyRadiosGetRadioVendor() == 1)
  {
    IPTelephonyManager::instance(&v3);
    IPTelephonyManager::sendCallStatusRequest(v3, a2, 0, 4, 0, 0);
    if (v4)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void sub_1E5140178(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleMessageRequestError(uint64_t a1, uint64_t a2)
{
  if (TelephonyRadiosGetRadioVendor() == 1)
  {
    IPTelephonyManager::instance(&v3);
    IPTelephonyManager::sendCallStatusRequest(v3, a2, 2, 4, 0, 0);
    if (v4)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void sub_1E51401F4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleMessageError(uint64_t a1, void **a2, uint64_t a3, uint64_t a4, char a5)
{
  std::string::basic_string[abi:ne200100]<0>(__p, "sms");
  v33[0] = 0;
  v36 = 0;
  v10 = ims::debug(__p, v33);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "IMSSMSManager::handleMessageError(stackId: ", 43);
  *(v10 + 17) = 0;
  (*(*v10 + 32))(v10, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), ", messageId: ", 13);
  *(v10 + 17) = 0;
  MEMORY[0x1E6923350](*(v10 + 8), a3);
  *(v10 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), ", error: ", 9);
  *(v10 + 17) = 0;
  (*(*a4 + 16))(a4, v10);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), ")", 1);
  *(v10 + 17) = 0;
  (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v10 + 17) = 0;
  if (v36 == 1 && v35 < 0)
  {
    operator delete(v34);
  }

  if (SHIBYTE(__p[2]) < 0)
  {
    operator delete(__p[0]);
  }

  v31 = 0;
  v32 = 0;
  IPTelephonyManager::getBambiClient(&v31);
  v29 = 0;
  v30 = 0;
  (*(*v31 + 184))(&v29);
  v11 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v12 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v11);
  }

  v13 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v27 = v29;
  v28 = v30;
  if (v30)
  {
    atomic_fetch_add_explicit(&v30->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  IMSMetricsManager::logSmsSendCompletedEvent(v12, &v27);
  if (v28)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  }

  if (v13)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v13);
  }

  if (ims::AccessNetwork::isIMS((v29 + 3432)) && TelephonyRadiosGetRadioVendor() == 1)
  {
    IPTelephonyManager::instance(__p);
    IPTelephonyManager::sendCallStatusRequest(__p[0], a2, 2, 4, 1, 0);
    if (__p[1])
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](__p[1]);
    }
  }

  v14 = *(a1 + 448);
  if (!v14)
  {
    goto LABEL_28;
  }

  v15 = a1 + 448;
  do
  {
    v16 = *(v14 + 28);
    v17 = v16 >= a3;
    v18 = v16 < a3;
    if (v17)
    {
      v15 = v14;
    }

    v14 = *(v14 + 8 * v18);
  }

  while (v14);
  if (v15 == a1 + 448 || *(v15 + 28) > a3)
  {
LABEL_28:
    std::string::basic_string[abi:ne200100]<0>(__p, "Unknown error / message ID");
    IMSSMSManager::reportFailure(a2, __p);
    if ((SHIBYTE(__p[2]) & 0x80000000) == 0)
    {
      goto LABEL_48;
    }

    v19 = __p[0];
    goto LABEL_30;
  }

  __p[0] = 202;
  memset(&v26, 0, sizeof(v26));
  v25 = 0;
  memset(&__p[1], 0, 24);
  BYTE4(__p[0]) = *(v15 + 33);
  BYTE5(__p[0]) = a5;
  (*(*a4 + 24))(&v22, a4);
  if (SHIBYTE(v22.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&v23, v22.__r_.__value_.__l.__data_, v22.__r_.__value_.__l.__size_);
  }

  else
  {
    v23 = v22;
  }

  if (SHIBYTE(__p[3]) < 0)
  {
    operator delete(__p[1]);
  }

  *&__p[1] = v23;
  *(&v23.__r_.__value_.__s + 23) = 0;
  v23.__r_.__value_.__s.__data_[0] = 0;
  if (SHIBYTE(v22.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v22.__r_.__value_.__l.__data_);
  }

  if (*(a4 + 87) < 0)
  {
    std::string::__init_copy_ctor_external(&v23, *(a4 + 64), *(a4 + 72));
  }

  else
  {
    v23 = *(a4 + 64);
  }

  if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v26.__r_.__value_.__l.__data_);
  }

  v26 = v23;
  if (*(a4 + 8) == &SipResultDomain::_domain)
  {
    LODWORD(__p[0]) = *(a4 + 16);
  }

  v20 = IMSClientManager::delegateForStack(a2);
  (*(*(v20 + 48) + 16))();
  v21 = IMSClientManager::delegateForStack(a2);
  (*(*(v21 + 48) + 24))();
  std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 440), v15);
  operator delete(v15);
  if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v26.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(__p[3]) < 0)
  {
    v19 = __p[1];
LABEL_30:
    operator delete(v19);
  }

LABEL_48:
  if (v30)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v30);
  }

  if (v32)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v32);
  }
}

void sub_1E514072C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, void *a20, uint64_t a21, int a22, __int16 a23, char a24, char a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, std::__shared_weak_count *a35)
{
  ims::MessageResult::~MessageResult(&a20);
  if (a35)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a35);
  }

  v37 = *(v35 - 128);
  if (v37)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v37);
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::handleMessageSent(uint64_t a1, void **a2, uint64_t a3)
{
  std::string::basic_string[abi:ne200100]<0>(__p, "sms");
  v32[0] = 0;
  v35 = 0;
  v6 = ims::debug(__p, v32);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "IMSSMSManager::handleMessageSent(stackId: ", 42);
  *(v6 + 17) = 0;
  (*(*v6 + 32))(v6, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), ", messageId:", 12);
  *(v6 + 17) = 0;
  MEMORY[0x1E6923350](*(v6 + 8), a3);
  *(v6 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), ")", 1);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  if (v35 == 1 && v34 < 0)
  {
    operator delete(v33);
  }

  if (SBYTE7(v23) < 0)
  {
    operator delete(__p[0]);
  }

  v30 = 0;
  v31 = 0;
  IPTelephonyManager::getBambiClient(&v30);
  v28 = 0;
  v29 = 0;
  (*(*v30 + 184))(&v28);
  v7 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v8 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v7);
  }

  v9 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v26 = v28;
  v27 = v29;
  if (v29)
  {
    atomic_fetch_add_explicit(&v29->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  IMSMetricsManager::logSmsSendCompletedEvent(v8, &v26);
  if (v27)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v27);
  }

  if (v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  }

  if (ims::AccessNetwork::isIMS((v28 + 3432)) && TelephonyRadiosGetRadioVendor() == 1)
  {
    IPTelephonyManager::instance(__p);
    IPTelephonyManager::sendCallStatusRequest(__p[0], a2, 2, 4, 1, 0);
    if (__p[1])
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](__p[1]);
    }
  }

  *v24 = 0u;
  v25 = 0u;
  *__p = 0u;
  v23 = 0u;
  LODWORD(__p[0]) = 202;
  v10 = *(a1 + 448);
  if (v10)
  {
    v11 = a1 + 448;
    v12 = a1 + 448;
    v13 = *(a1 + 448);
    do
    {
      v14 = *(v13 + 28);
      v15 = v14 >= a3;
      v16 = v14 < a3;
      if (v15)
      {
        v12 = v13;
      }

      v13 = *(v13 + 8 * v16);
    }

    while (v13);
    if (v12 != v11 && *(v12 + 28) <= a3)
    {
      BYTE4(__p[0]) = *(v12 + 33);
      v17 = a1 + 448;
      do
      {
        v18 = *(v10 + 28);
        v15 = v18 >= a3;
        v19 = v18 < a3;
        if (v15)
        {
          v17 = v10;
        }

        v10 = *(v10 + 8 * v19);
      }

      while (v10);
      if (v17 != v11 && *(v17 + 28) <= a3)
      {
        std::__tree<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::__map_value_compare<nas::CallMediaType,std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>,std::less<nas::CallMediaType>,true>,std::allocator<std::__value_type<nas::CallMediaType,QMINasCache::CallStatusRecord>>>::__remove_node_pointer((a1 + 440), v17);
        operator delete(v17);
      }
    }
  }

  v20 = IMSClientManager::delegateForStack(a2);
  (*(*(v20 + 48) + 32))(v20 + 48);
  v21 = IMSClientManager::delegateForStack(a2);
  (*(*(v21 + 48) + 40))(v21 + 48);
  if (SHIBYTE(v25) < 0)
  {
    operator delete(v24[1]);
  }

  if (SHIBYTE(v23) < 0)
  {
    operator delete(__p[1]);
  }

  if (v29)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v29);
  }

  if (v31)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v31);
  }
}

void sub_1E5140BE8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, std::__shared_weak_count *a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, std::__shared_weak_count *a24, uint64_t a25, std::__shared_weak_count *a26)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  if (a24)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a24);
  }

  if (a26)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a26);
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::handleUacBarringResponse(IMSSMSManager *a1, uint64_t a2, unsigned int a3)
{
  v27 = 0;
  v28 = 0;
  IPTelephonyManager::getBambiClient(&v27);
  if (!v27)
  {
    std::string::basic_string[abi:ne200100]<0>(&v26, "sms");
    v22[0] = 0;
    v25 = 0;
    v6 = ims::error(&v26, v22);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "SIP client not found", 20);
    *(v6 + 17) = 0;
    (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v6 + 17) = 0;
    if (v25 == 1 && v24 < 0)
    {
      operator delete(__p);
    }

    if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v26.__r_.__value_.__l.__data_);
    }

    std::string::basic_string[abi:ne200100]<0>(&v26, "SIP client not found");
    IMSSMSManager::reportFailure(a2, &v26);
    if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v26.__r_.__value_.__l.__data_);
    }
  }

  v7 = *(a1 + 52);
  v8 = *(a1 + 53);
  while (v7 != v8)
  {
    v9 = *(v7 + 23);
    if (v9 >= 0)
    {
      v10 = *(v7 + 23);
    }

    else
    {
      v10 = *(v7 + 8);
    }

    v11 = *(a2 + 23);
    v12 = v11;
    if ((v11 & 0x80u) != 0)
    {
      v11 = *(a2 + 8);
    }

    if (v10 == v11)
    {
      v13 = v9 >= 0 ? v7 : *v7;
      v14 = *a2;
      v15 = v12 >= 0 ? a2 : *a2;
      if (!memcmp(v13, v15, v10) && *(v7 + 508) == 1)
      {
        if (a3)
        {
          if (a3 <= 2)
          {
            std::string::basic_string[abi:ne200100]<0>(&v26, "sms");
            v18[0] = 0;
            v21 = 0;
            v16 = ims::error(&v26, v18);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "Unable to send SMS message: ", 28);
            *(v16 + 17) = 0;
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "Service Barred", 14);
            *(v16 + 17) = 0;
            (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v16 + 17) = 0;
            if (v21 == 1 && v20 < 0)
            {
              operator delete(v19);
            }

            if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
            {
              operator delete(v26.__r_.__value_.__l.__data_);
            }

            std::string::basic_string[abi:ne200100]<0>(&v26, "Service Barred");
            IMSSMSManager::reportFailure(a2, &v26);
            if (SHIBYTE(v26.__r_.__value_.__r.__words[2]) < 0)
            {
              operator delete(v26.__r_.__value_.__l.__data_);
            }

LABEL_34:
            v8 = std::__move_impl<std::_ClassicAlgPolicy>::operator()[abi:ne200100]<PendingSMS *,PendingSMS *,PendingSMS *>(v7 + 512, *(a1 + 53), v7);
            for (i = *(a1 + 53); i != v8; std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(i))
            {
              i -= 512;
            }

            *(a1 + 53) = v8;
            continue;
          }
        }

        else
        {
          if (IMSSMSManager::prepareSMS(a1, v7))
          {
            goto LABEL_34;
          }

          v8 = *(a1 + 53);
        }
      }
    }

    v7 += 512;
  }

  if (v28)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  }
}

void sub_1E5140FBC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, void *a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, void *__p, uint64_t a31, int a32, __int16 a33, char a34, char a35)
{
  if (a35 < 0)
  {
    operator delete(__p);
  }

  v37 = *(v35 - 88);
  if (v37)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v37);
  }

  _Unwind_Resume(exception_object);
}

void IMSSMSManager::clearLocation(IMSSMSManager *this)
{
  v2 = *(this + 50);
  *(this + 49) = 0;
  *(this + 50) = 0;
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  *(this + 248) = 0u;
  *(this + 264) = 0u;
  *(this + 35) = 0x40A7700000000000;
  *(this + 36) = 0;
  if (*(this + 319) < 0)
  {
    operator delete(*(this + 37));
  }

  *(this + 37) = 0;
  *(this + 38) = 0;
  *(this + 39) = 0;
  if (*(this + 343) < 0)
  {
    operator delete(*(this + 40));
  }

  *(this + 40) = 0;
  *(this + 41) = 0;
  *(this + 42) = 0;
  if (*(this + 367) < 0)
  {
    operator delete(*(this + 43));
  }

  *(this + 43) = 0;
  *(this + 44) = 0;
  *(this + 45) = 0;
  if (*(this + 391) < 0)
  {
    operator delete(*(this + 46));
  }

  *(this + 46) = 0;
  *(this + 47) = 0;
  *(this + 48) = 0;
  *(this + 408) = 0;
}

void IMSSMSManager::sendSMS(uint64_t a1, uint64_t a2, double *a3)
{
  v42 = 0;
  v43 = 0;
  IPTelephonyManager::getBambiClient(&v42);
  v6 = std::string::basic_string[abi:ne200100]<0>(&v40, "sms");
  v36[0] = 0;
  v39 = 0;
  v7 = ims::debug(v6, v36);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "IMSSMSManager::sendSMS(stackId: ", 32);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ", destination: ", 15);
  *(v7 + 17) = 0;
  (*(*(a2 + 24) + 40))(a2 + 24, v7);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ", size: ", 8);
  *(v7 + 17) = 0;
  if (*(a2 + 455) >= 0)
  {
    v8 = *(a2 + 455);
  }

  else
  {
    v8 = *(a2 + 440);
  }

  MEMORY[0x1E6923370](*(v7 + 8), v8);
  *(v7 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ", content-type: ", 16);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2 + 480);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), ")", 1);
  *(v7 + 17) = 0;
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v39 == 1 && v38 < 0)
  {
    operator delete(v37);
  }

  if (v41 < 0)
  {
    operator delete(v40);
  }

  v9 = pthread_mutex_lock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v10 = off_1EE2BBBC0;
  if (!off_1EE2BBBC0)
  {
    IMSMetricsManager::create_default_global(v9);
  }

  v11 = *(&off_1EE2BBBC0 + 1);
  if (*(&off_1EE2BBBC0 + 1))
  {
    atomic_fetch_add_explicit((*(&off_1EE2BBBC0 + 1) + 8), 1uLL, memory_order_relaxed);
  }

  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v12 = v42;
  (*(*v42 + 184))(&v34, v42, a2);
  IMSMetricsManager::logSmsSendAttemptedEvent(v10, &v34);
  if (v35)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v35);
  }

  if (v11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v11);
  }

  v13 = a3[5];
  v14 = *(a2 + 504);
  ims::LocationInfo::LocationInfo(v25, a3);
  v15 = BambiClient::sendMessage(v12, a2, (a2 + 24), a2 + 456, a2 + 432, (a2 + 480), v25);
  if (v33 < 0)
  {
    operator delete(__p);
  }

  if (v31 < 0)
  {
    operator delete(v30);
  }

  if (v29 < 0)
  {
    operator delete(v28);
  }

  if (v27 < 0)
  {
    operator delete(v26);
  }

  v16 = std::string::basic_string[abi:ne200100]<0>(&v40, "sms");
  v21[0] = 0;
  v24 = 0;
  v17 = ims::debug(v16, v21);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), "IMSSMSManager::sendSMS(stackId: ", 32);
  *(v17 + 17) = 0;
  (*(*v17 + 32))(v17, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), ", messageId:", 12);
  *(v17 + 17) = 0;
  MEMORY[0x1E6923350](*(v17 + 8), v15);
  *(v17 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v17 + 8), ")", 1);
  *(v17 + 17) = 0;
  (*(*v17 + 64))(v17, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v17 + 17) = 0;
  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (v41 < 0)
  {
    operator delete(v40);
  }

  v18 = *(a1 + 448);
  if (!v18)
  {
LABEL_36:
    operator new();
  }

  while (1)
  {
    while (1)
    {
      v19 = v18;
      v20 = *(v18 + 7);
      if (v20 <= v15)
      {
        break;
      }

      v18 = *v19;
      if (!*v19)
      {
        goto LABEL_36;
      }
    }

    if (v20 >= v15)
    {
      break;
    }

    v18 = v19[1];
    if (!v18)
    {
      goto LABEL_36;
    }
  }

  *(v19 + 32) = v14;
  *(v19 + 33) = v13 > 0.0;
  if (v43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  }
}

void sub_1E5141610(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, uint64_t a37, uint64_t a38, uint64_t a39, uint64_t a40, uint64_t a41)
{
  pthread_mutex_unlock(&ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance);
  v43 = *(v41 - 88);
  if (v43)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v43);
  }

  _Unwind_Resume(a1);
}

void IMSSMSManager::handleLocationUpdate(uint64_t a1, __int128 *a2)
{
  *(a1 + 408) = 0;
  std::string::basic_string[abi:ne200100]<0>(__p, "sms");
  v25[0] = 0;
  v28 = 0;
  v4 = ims::debug(__p, v25);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "Acquired updated location with ", 31);
  *(v4 + 17) = 0;
  MEMORY[0x1E6923330](*(v4 + 8), *a2);
  *(v4 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), ", ", 2);
  *(v4 + 17) = 0;
  MEMORY[0x1E6923330](*(v4 + 8), *(a2 + 1));
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v28 == 1 && v27 < 0)
  {
    operator delete(v26);
  }

  if (SBYTE7(v19[0]) < 0)
  {
    operator delete(__p[0]);
  }

  if (*(a1 + 72) == 1 && *(a2 + 5) > 0.0)
  {
    v5 = *a2;
    v6 = a2[2];
    *(a1 + 264) = a2[1];
    *(a1 + 280) = v6;
    *(a1 + 248) = v5;
    std::string::operator=((a1 + 296), a2 + 2);
    std::string::operator=((a1 + 320), a2 + 3);
    std::string::operator=((a1 + 344), a2 + 4);
    std::string::operator=((a1 + 368), a2 + 5);
  }

  v7 = *(a1 + 416);
  while (v7 != *(a1 + 424))
  {
    *v23 = 0u;
    v24 = 0u;
    *v21 = 0u;
    v22 = 0u;
    *v20 = 0u;
    *__p = 0u;
    memset(v19, 0, sizeof(v19));
    PendingSMS::PendingSMS(__p, v7);
    if (HIDWORD(v24) == 2)
    {
      ims::LocationInfo::LocationInfo(v10, a2);
      IMSSMSManager::sendSMS(a1, __p, v10);
      if (v17 < 0)
      {
        operator delete(v16);
      }

      if (v15 < 0)
      {
        operator delete(v14);
      }

      if (v13 < 0)
      {
        operator delete(v12);
      }

      if (v11 < 0)
      {
        operator delete(*&v10[6]);
      }

      v8 = std::__move_impl<std::_ClassicAlgPolicy>::operator()[abi:ne200100]<PendingSMS *,PendingSMS *,PendingSMS *>(v7 + 512, *(a1 + 424), v7);
      for (i = *(a1 + 424); i != v8; std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(i))
      {
        i -= 512;
      }

      *(a1 + 424) = v8;
    }

    else
    {
      v7 = (v7 + 512);
    }

    if (SBYTE7(v24) < 0)
    {
      operator delete(v23[0]);
    }

    if (SHIBYTE(v22) < 0)
    {
      operator delete(v21[1]);
    }

    if (SHIBYTE(v21[0]) < 0)
    {
      operator delete(v20[0]);
    }

    SipUri::~SipUri((v19 + 8));
    if (SBYTE7(v19[0]) < 0)
    {
      operator delete(__p[0]);
    }
  }
}

void sub_1E51419B8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, void *__p, uint64_t a28, int a29, __int16 a30, char a31, char a32)
{
  if (*(v32 - 72) == 1 && *(v32 - 81) < 0)
  {
    operator delete(*(v32 - 104));
  }

  if (a32 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void std::vector<PendingSMS>::__destroy_vector::operator()[abi:ne200100](void ***a1)
{
  v1 = *a1;
  v2 = **a1;
  if (v2)
  {
    v4 = v1[1];
    v5 = **a1;
    if (v4 != v2)
    {
      do
      {
        v4 -= 512;
        std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(v4);
      }

      while (v4 != v2);
      v5 = **a1;
    }

    v1[1] = v2;

    operator delete(v5);
  }
}

void std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(uint64_t a1)
{
  if (*(a1 + 503) < 0)
  {
    operator delete(*(a1 + 480));
  }

  if (*(a1 + 479) < 0)
  {
    operator delete(*(a1 + 456));
  }

  if (*(a1 + 455) < 0)
  {
    operator delete(*(a1 + 432));
  }

  SipUri::~SipUri((a1 + 24));
  if (*(a1 + 23) < 0)
  {
    v2 = *a1;

    operator delete(v2);
  }
}

void **std::set<std::string>::set[abi:ne200100](void **result, uint64_t a2)
{
  qword_1EE2BCA98 = 0;
  qword_1EE2BCA90 = 0;
  qword_1EE2BCA88 = &qword_1EE2BCA90;
  if (a2)
  {
    v2 = result;
    v3 = 24 * a2;
    do
    {
      result = std::__tree<std::string>::__emplace_hint_unique_key_args<std::string,std::string const&>(&qword_1EE2BCA88, &qword_1EE2BCA90, v2);
      v2 += 3;
      v3 -= 24;
    }

    while (v3);
  }

  return result;
}

uint64_t std::__split_buffer<PendingSMS>::~__split_buffer(uint64_t a1)
{
  v3 = *(a1 + 8);
  for (i = *(a1 + 16); i != v3; i = *(a1 + 16))
  {
    *(a1 + 16) = i - 512;
    std::allocator_traits<std::allocator<PendingSMS>>::destroy[abi:ne200100]<PendingSMS,void,0>(i - 512);
  }

  if (*a1)
  {
    operator delete(*a1);
  }

  return a1;
}

void LazuliSpamReportParams::~LazuliSpamReportParams(void **this)
{
  if (*(this + 999) < 0)
  {
    operator delete(this[122]);
  }

  if (*(this + 975) < 0)
  {
    operator delete(this[119]);
  }

  if (*(this + 951) < 0)
  {
    operator delete(this[116]);
  }

  xpc_release(this[115]);
  this[115] = 0;
  SipUri::~SipUri((this + 64));
  SipUri::~SipUri((this + 12));
  if (*(this + 95) < 0)
  {
    operator delete(this[9]);
  }

  if (*(this + 71) < 0)
  {
    operator delete(this[6]);
  }

  if (*(this + 47) < 0)
  {
    operator delete(this[3]);
  }

  if (*(this + 23) < 0)
  {
    operator delete(*this);
  }
}

uint64_t std::__move_impl<std::_ClassicAlgPolicy>::operator()[abi:ne200100]<PendingSMS *,PendingSMS *,PendingSMS *>(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a1 != a2)
  {
    v6 = 0;
    do
    {
      v7 = a3 + v6;
      if (*(a3 + v6 + 23) < 0)
      {
        operator delete(*v7);
      }

      v8 = a1 + v6;
      v9 = *(a1 + v6);
      *(v7 + 16) = *(a1 + v6 + 16);
      *v7 = v9;
      *(a1 + v6 + 23) = 0;
      *(a1 + v6) = 0;
      SipUri::operator=((v7 + 24), a1 + v6 + 24);
      if (*(v7 + 455) < 0)
      {
        operator delete(*(v7 + 432));
      }

      v10 = *(v8 + 432);
      *(v7 + 448) = *(v8 + 448);
      *(v7 + 432) = v10;
      *(v8 + 455) = 0;
      *(v8 + 432) = 0;
      v11 = a3 + v6;
      v12 = (a3 + v6 + 456);
      if (*(a3 + v6 + 479) < 0)
      {
        operator delete(*v12);
      }

      v13 = *(v8 + 456);
      *(a3 + v6 + 472) = *(v8 + 472);
      *v12 = v13;
      *(v8 + 479) = 0;
      *(v8 + 456) = 0;
      if (*(v11 + 503) < 0)
      {
        operator delete(*(v11 + 480));
      }

      v14 = *(v8 + 480);
      *(v11 + 496) = *(v8 + 496);
      *(v11 + 480) = v14;
      *(v8 + 503) = 0;
      *(v8 + 480) = 0;
      *(a3 + v6 + 504) = *(v8 + 504);
      v6 += 512;
    }

    while (v8 + 512 != a2);
    a3 += v6;
  }

  return a3;
}

void PendingSMS::PendingSMS(std::string *this, const PendingSMS *a2)
{
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(this, *a2, *(a2 + 1));
  }

  else
  {
    v4 = *a2;
    this->__r_.__value_.__r.__words[2] = *(a2 + 2);
    *&this->__r_.__value_.__l.__data_ = v4;
  }

  SipUri::SipUri(&this[1], (a2 + 24));
  if (*(a2 + 455) < 0)
  {
    std::string::__init_copy_ctor_external(this + 18, *(a2 + 54), *(a2 + 55));
  }

  else
  {
    v5 = *(a2 + 27);
    this[18].__r_.__value_.__r.__words[2] = *(a2 + 56);
    *&this[18].__r_.__value_.__l.__data_ = v5;
  }

  if (*(a2 + 479) < 0)
  {
    std::string::__init_copy_ctor_external(this + 19, *(a2 + 57), *(a2 + 58));
  }

  else
  {
    v6 = *(a2 + 456);
    this[19].__r_.__value_.__r.__words[2] = *(a2 + 59);
    *&this[19].__r_.__value_.__l.__data_ = v6;
  }

  if (*(a2 + 503) < 0)
  {
    std::string::__init_copy_ctor_external(this + 20, *(a2 + 60), *(a2 + 61));
  }

  else
  {
    v7 = *(a2 + 30);
    this[20].__r_.__value_.__r.__words[2] = *(a2 + 62);
    *&this[20].__r_.__value_.__l.__data_ = v7;
  }

  this[21].__r_.__value_.__r.__words[0] = *(a2 + 63);
}

void sub_1E5141F08(_Unwind_Exception *a1)
{
  if (*(v1 + 479) < 0)
  {
    operator delete(*v2);
  }

  if (*(v1 + 455) < 0)
  {
    operator delete(*(v1 + 432));
  }

  SipUri::~SipUri((v1 + 24));
  if (*(v1 + 23) < 0)
  {
    operator delete(*v1);
  }

  _Unwind_Resume(a1);
}

void *std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF7290;
  v2 = a1[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  return a1;
}

void std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF7290;
  v1 = a1[3];
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }

  JUMPOUT(0x1E69235B0);
}

uint64_t std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::__clone(uint64_t result, uint64_t a2)
{
  *a2 = &unk_1F5EF7290;
  *(a2 + 8) = *(result + 8);
  v2 = *(result + 24);
  *(a2 + 24) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::destroy(uint64_t a1)
{
  v1 = *(a1 + 24);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::destroy_deallocate(void *__p)
{
  v2 = __p[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  operator delete(__p);
}

void std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::operator()(void *a1, uint64_t **a2)
{
  v3 = a1[3];
  if (!v3)
  {
    return;
  }

  v5 = a1[1];
  v6 = std::__shared_weak_count::lock(v3);
  if (!v6)
  {
    return;
  }

  v7 = v6;
  if (a1[2])
  {
    v8 = *(a2 + 23);
    if ((v8 & 0x80000000) == 0)
    {
      if (v8 != 16)
      {
        goto LABEL_16;
      }

LABEL_10:
      if (*a2 == 0x6772656D45534D53 && a2[1] == 0x65646F4D79636E65)
      {
        *(v5 + 72) = 0;
        IMSSMSManager::clearLocation(v5);
      }

      goto LABEL_16;
    }

    if (a2[1] == 16)
    {
      a2 = *a2;
      goto LABEL_10;
    }
  }

LABEL_16:

  std::__shared_weak_count::__release_shared[abi:ne200100](v7);
}

uint64_t std::__function::__func<IMSSMSManager::prepareSMS(PendingSMS &)::$_0,std::allocator<IMSSMSManager::prepareSMS(PendingSMS &)::$_0>,void ()(std::string &)>::target(uint64_t a1, uint64_t a2)
{
  {
    return a1 + 8;
  }

  else
  {
    return 0;
  }
}

uint64_t __cxx_global_var_init_4()
{
  {
    return __cxa_atexit(ctu::PthreadMutexGuardPolicy<IMSMetricsManager>::~PthreadMutexGuardPolicy, &ctu::Singleton<IMSMetricsManager,IMSMetricsManager,ctu::PthreadMutexGuardPolicy<IMSMetricsManager>>::sInstance, &dword_1E4C3F000);
  }

  return result;
}

void std::__shared_ptr_emplace<anonymous namespace::MessageSessionEndEventImpl>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF7310;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void anonymous namespace::MessageSessionEndEventImpl::~MessageSessionEndEventImpl(xpc_object_t *this)
{
  *this = &unk_1F5EF7360;
  xpc_release(this[1]);
  this[1] = 0;
}

{
  *this = &unk_1F5EF7360;
  xpc_release(this[1]);
  this[1] = 0;

  JUMPOUT(0x1E69235B0);
}

xpc_object_t anonymous namespace::MessageSessionEndEventImpl::getDict@<X0>(_anonymous_namespace_::MessageSessionEndEventImpl *this@<X0>, void *a2@<X8>)
{
  v2 = *(this + 1);
  *a2 = v2;
  if (v2)
  {
    return xpc_retain(v2);
  }

  result = xpc_null_create();
  *a2 = result;
  return result;
}

void SipContributionIdHeader::~SipContributionIdHeader(void **this)
{
  *this = &unk_1F5EBEF98;
  if (*(this + 87) < 0)
  {
    operator delete(this[8]);
  }

  SipHeader::~SipHeader(this);
}

{
  *this = &unk_1F5EBEF98;
  if (*(this + 87) < 0)
  {
    operator delete(this[8]);
  }

  SipHeader::~SipHeader(this);

  JUMPOUT(0x1E69235B0);
}

void SipMessage::SipMessage(SipMessage *this, const SipMessage *a2)
{
  v4 = ims::SharedLoggable<SharedImsResultItem>::SharedLoggable(this, "sip.message");
  *v4 = &unk_1F5EF7460;
  *(v4 + 3) = 0u;
  *(v4 + 4) = 0u;
  *(v4 + 5) = 0u;
  v4[12] = 0;
  *(v4 + 26) = 1065353216;
  v4[15] = *(a2 + 15);
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&v6, a2 + 1);
  std::dynamic_pointer_cast[abi:ne200100]<SipMessage const,SharedImsResultItem const>(&v6, &v8);
  SipMessage::copyHeadersFromMessage(this, &v8);
  if (v9)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  }

  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  v5 = *(a2 + 14);
  if (v5)
  {
    v5 = (*(*v5 + 24))(v5);
  }

  *(this + 14) = v5;
}

void sub_1E5142B88(_Unwind_Exception *a1)
{
  std::__hash_table<std::string,std::hash<std::string>,std::equal_to<std::string>,std::allocator<std::string>>::~__hash_table(v1 + 72);
  v4 = *v2;
  if (*v2)
  {
    *(v1 + 56) = v4;
    operator delete(v4);
  }

  MEMORY[0x1E69225A0](v1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((v1 + 8));
  _Unwind_Resume(a1);
}

const void **SipMessage::copyHeadersFromMessage(const void **result, uint64_t a2)
{
  v2 = *(*a2 + 48);
  if (*(*a2 + 56) != v2)
  {
    v4 = result;
    v5 = 0;
    v6 = 1;
    do
    {
      v7 = (*(**(v2 + 8 * v5) + 32))(*(v2 + 8 * v5));
      result = SipMessage::addHeader(v4, v7, 0);
      v5 = v6;
      v2 = *(*a2 + 48);
      ++v6;
    }

    while (v5 < (*(*a2 + 56) - v2) >> 3);
  }

  return result;
}

void SipMessage::~SipMessage(SipMessage *this)
{
  *this = &unk_1F5EF7460;
  v2 = *(this + 14);
  if (v2)
  {
    (*(*v2 + 8))(v2);
  }

  v4 = *(this + 6);
  v3 = *(this + 7);
  if (v3 != v4)
  {
    v5 = 0;
    v6 = 1;
    do
    {
      v7 = *(v4 + 8 * v5);
      if (v7)
      {
        (*(*v7 + 8))(v7);
        v4 = *(this + 6);
        v3 = *(this + 7);
      }

      v5 = v6++;
    }

    while (v5 < (v3 - v4) >> 3);
  }

  std::__hash_table<std::string,std::hash<std::string>,std::equal_to<std::string>,std::allocator<std::string>>::~__hash_table(this + 72);
  v8 = *(this + 6);
  if (v8)
  {
    *(this + 7) = v8;
    operator delete(v8);
  }

  MEMORY[0x1E69225A0](this + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 1);
}

void SipMessage::clone(SipMessage *this@<X0>, char ***a2@<X8>)
{
  (*(*this + 24))(&v3);
  std::dynamic_pointer_cast[abi:ne200100]<SipMessage const,SharedImsResultItem const>(&v3, a2);
  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }
}

const void **SipMessage::addHeader(SipMessage *this, SipHeader *a2, int a3)
{
  v57 = a2;
  if (!a2)
  {
    return 0;
  }

  v4 = a2;
  if ((*(*a2 + 80))(a2) && (*(*(this + 15) + 129) != 1 || !(*(*v4 + 88))(v4)))
  {
    goto LABEL_36;
  }

  v7 = *(this + 6);
  v6 = *(this + 7);
  v8 = v6 - v7;
  if (v6 == v7)
  {
    goto LABEL_36;
  }

  v9 = 0;
  v10 = v8 >> 3;
  v11 = *(v4 + 31);
  v12 = 1;
  while (1)
  {
    v13 = v11;
    v14 = v4 + 8;
    if ((v11 & 0x80) != 0)
    {
      v14 = *(v4 + 1);
      v13 = *(v4 + 2);
    }

    v15 = *(v7 + 8 * v9);
    v18 = *(v15 + 8);
    v16 = v15 + 8;
    v17 = v18;
    v19 = *(v16 + 23);
    v20 = v19 >= 0 ? *(v16 + 23) : *(v16 + 8);
    v21 = (v19 >= 0 ? v16 : v17);
    v22 = v20 >= v13 ? v13 : v20;
    v23 = memcmp(v14, v21, v22);
    if (v20 == v13 && v23 == 0)
    {
      break;
    }

    v9 = v12;
    v50 = v10 > v12++;
    if (!v50)
    {
      goto LABEL_36;
    }
  }

  if (!v12)
  {
    goto LABEL_36;
  }

  v26 = v12 - 1;
  if (*(*(this + 15) + 129) != 1 || ((v27 = (v7 + 8 * v26), !a3) ? (v28 = v4) : (v28 = *v27, v27 = &v57), v25 = *v27, !(*(**v27 + 96))(*v27, v28)))
  {
    if (((*(*v4 + 80))(v4) & 1) == 0)
    {
      v55 = *(this + 6);
      v56 = *(v55 + 8 * v26);
      if (v56)
      {
        (*(*v56 + 8))(v56);
        v55 = *(this + 6);
      }

      *(v55 + 8 * v26) = v4;
      v58 = (v4 + 8);
      v53 = (this + 72);
      v52 = (v4 + 8);
      goto LABEL_75;
    }

LABEL_36:
    if (a3)
    {
      v30 = *(this + 6);
      v29 = *(this + 7);
      v31 = *(this + 8);
      if (v29 < v31)
      {
        if (v30 == v29)
        {
          *v29 = v4;
          *(this + 7) = v29 + 1;
        }

        else
        {
          v32 = (v30 + 1);
          if (v29 < 8)
          {
            v33 = *(this + 7);
          }

          else
          {
            *v29 = *(v29 - 1);
            v33 = v29 + 1;
          }

          *(this + 7) = v33;
          if (v29 != v32)
          {
            memmove(v30 + 1, v30, v29 - v32);
            v33 = *(this + 7);
          }

          v50 = v33 <= &v57 || v30 > &v57;
          v51 = 8;
          if (v50)
          {
            v51 = 0;
          }

          *v30 = *(&v57 + v51);
        }

        goto LABEL_74;
      }

      v37 = v29 - v30 + 1;
      if (!(v37 >> 61))
      {
        v38 = v31 - v30;
        if (v38 >> 2 > v37)
        {
          v37 = v38 >> 2;
        }

        if (v38 >= 0x7FFFFFFFFFFFFFF8)
        {
          v39 = 0x1FFFFFFFFFFFFFFFLL;
        }

        else
        {
          v39 = v37;
        }

        if (v39)
        {
          std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(this + 48, v39);
        }

        std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(this + 48, 1uLL);
      }

LABEL_80:
      std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
    }

    v35 = *(this + 7);
    v34 = *(this + 8);
    if (v35 >= v34)
    {
      v40 = *(this + 6);
      v41 = (v35 - v40) >> 3;
      if ((v41 + 1) >> 61)
      {
        goto LABEL_80;
      }

      v42 = v34 - v40;
      v43 = v42 >> 2;
      if (v42 >> 2 <= (v41 + 1))
      {
        v43 = v41 + 1;
      }

      if (v42 >= 0x7FFFFFFFFFFFFFF8)
      {
        v44 = 0x1FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v44 = v43;
      }

      if (v44)
      {
        std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(this + 48, v44);
      }

      v45 = (8 * v41);
      v4 = v57;
      *v45 = v57;
      v36 = v45 + 1;
      v46 = *(this + 6);
      v47 = *(this + 7) - v46;
      v48 = v45 - v47;
      memcpy(v45 - v47, v46, v47);
      v49 = *(this + 6);
      *(this + 6) = v48;
      *(this + 7) = v36;
      *(this + 8) = 0;
      if (v49)
      {
        operator delete(v49);
      }
    }

    else
    {
      *v35 = v4;
      v36 = v35 + 1;
    }

    *(this + 7) = v36;
LABEL_74:
    v52 = (v4 + 8);
    v58 = (v4 + 8);
    v53 = (this + 72);
LABEL_75:
    std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(v53, v52)[5] = v4;
    return v57;
  }

  if (v25 == v4)
  {
    *(*(this + 6) + 8 * v26) = v25;
    v58 = v25 + 1;
    std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(this + 9, v25 + 1)[5] = v25;
  }

  if (v28)
  {
    (*(*v28 + 8))(v28);
  }

  return v25;
}

void sub_1E5143290(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    operator delete(v1);
  }

  _Unwind_Resume(exception_object);
}

uint64_t SipMessage::copyHeaderFromMessage(SipMessage *a1, uint64_t *a2, const void **a3)
{
  v3 = *a2;
  v4 = *(*a2 + 48);
  if (*(*a2 + 56) == v4)
  {
    v9 = 0;
  }

  else
  {
    v8 = 0;
    v9 = 0;
    v10 = 1;
    do
    {
      v11 = *(v4 + 8 * v8);
      v12 = *(v11 + 31);
      if (v12 >= 0)
      {
        v13 = *(v11 + 31);
      }

      else
      {
        v13 = *(v11 + 16);
      }

      v14 = *(a3 + 23);
      v15 = v14;
      if (v14 < 0)
      {
        v14 = a3[1];
      }

      if (v13 == v14)
      {
        if (v12 >= 0)
        {
          v16 = (v11 + 8);
        }

        else
        {
          v16 = *(v11 + 8);
        }

        v17 = *a3;
        if (v15 >= 0)
        {
          v18 = a3;
        }

        else
        {
          v18 = *a3;
        }

        if (!memcmp(v16, v18, v13))
        {
          v19 = (*(*v11 + 32))(v11);
          SipMessage::addHeader(a1, v19, 0);
          v3 = *a2;
          v9 = 1;
        }
      }

      v8 = v10;
      v4 = *(v3 + 48);
      ++v10;
    }

    while (v8 < (*(v3 + 56) - v4) >> 3);
  }

  return v9 & 1;
}

uint64_t SipMessage::addBody(SipMessage *this, SipBody *a2)
{
  v3 = *(this + 14);
  if (v3 != a2)
  {
    if (v3)
    {
      v5 = **v3;
      if (!v6)
      {
        operator new();
      }

      SipMultiPartBody::addPart(v6, a2);
    }

    *(this + 14) = a2;
  }

  return 0;
}

char **SipMessage::bodyWithContentType(uint64_t a1, uint64_t a2)
{
  v3 = (a1 + 112);
  result = *(a1 + 112);
  if (result)
  {
    v5 = (*(*result + 5))(result);
    v6 = *(v5 + 23);
    if (v6 >= 0)
    {
      v7 = *(v5 + 23);
    }

    else
    {
      v7 = v5[1];
    }

    v8 = *(a2 + 23);
    v9 = v8;
    if ((v8 & 0x80u) != 0)
    {
      v8 = *(a2 + 8);
    }

    if (v7 == v8)
    {
      if (v6 < 0)
      {
        v5 = *v5;
      }

      v10 = *a2;
      v11 = v9 >= 0 ? a2 : *a2;
      if (!memcmp(v5, v11, v7))
      {
        return *v3;
      }
    }

    result = *v3;
    if (*v3)
    {
      v12 = **result;
      if (result)
      {
        result = SipMultiPartBody::partWithContentType(result, a2);
        if (result)
        {
          v3 = (result + 3);
          return *v3;
        }
      }
    }
  }

  return result;
}

char **SipMessage::body<SipSdpBody>(uint64_t a1)
{
  result = SipMessage::bodyWithContentType(a1, "application/sdp");
  if (result)
  {
    v2 = **result;
  }

  return result;
}

const void **SipMessage::addHeader(SipMessage *a1, uint64_t a2, uint64_t a3, int a4)
{
  result = *(a1 + 15);
  if (result)
  {
    Header = SipMessageEncodingMap::createHeader(result, a2, a3);

    return SipMessage::addHeader(a1, Header, a4);
  }

  return result;
}

const void **SipMessage::addHeader(SipMessage *a1, uint64_t a2, int a3, int a4)
{
  v4 = *(a1 + 15);
  if (!v4)
  {
    return 0;
  }

  std::string::basic_string[abi:ne200100]<0>(__p, "");
  Header = SipMessageEncodingMap::createHeader(v4, a2, __p);
  v10 = Header;
  if (v23 < 0)
  {
    operator delete(__p[0]);
    if (!v10)
    {
LABEL_9:
      std::string::basic_string[abi:ne200100]<0>(__p, "sip.message");
      v18[0] = 0;
      v21 = 0;
      v15 = ims::error(__p, v18);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "Can't assign a uint to header of type ", 38);
      *(v15 + 17) = 0;
      if (!v10)
      {
        __cxa_bad_typeid();
      }

      v16 = *(*(*v10 - 1) + 8);
      v17 = strlen((v16 & 0x7FFFFFFFFFFFFFFFLL));
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), v16 & 0x7FFFFFFFFFFFFFFFLL, v17);
      *(v15 + 17) = 0;
      (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v15 + 17) = 0;
      if (v21 == 1 && v20 < 0)
      {
        operator delete(v19);
      }

      if (v23 < 0)
      {
        operator delete(__p[0]);
      }

      (*(*v10 + 1))(v10);
      return 0;
    }
  }

  else if (!Header)
  {
    goto LABEL_9;
  }

  v11 = **v10;
  if (!v12)
  {
    goto LABEL_9;
  }

  *(v12 + 15) = a3;
  result = SipMessage::addHeader(a1, v12, a4);
  if (result)
  {
    v14 = **result;
  }

  return result;
}

void sub_1E51439B0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *__p, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a24 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

const void **SipMessage::headerWithName(SipMessage *a1, const void **a2, int a3)
{
  v6 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>(a1 + 9, a2);
  if (v6)
  {
    return v6[5];
  }

  if (!a3)
  {
    return 0;
  }

  return SipMessage::addHeader(a1, a2, &ims::kEmptyString, 0);
}

const void **SipMessage::firstHeaderWithName(SipMessage *a1, uint64_t a2, int a3)
{
  v7 = *(a1 + 6);
  v6 = *(a1 + 7);
  v8 = v6 - v7;
  if (v6 != v7)
  {
    v9 = 0;
    v10 = v8 >> 3;
    v11 = *(a2 + 23);
    if (v11 >= 0)
    {
      v12 = *(a2 + 23);
    }

    else
    {
      v12 = *(a2 + 8);
    }

    if (v11 >= 0)
    {
      v13 = a2;
    }

    else
    {
      v13 = *a2;
    }

    v14 = 1;
    do
    {
      v15 = *(v7 + 8 * v9);
      v16 = *(v15 + 31);
      if ((v16 & 0x8000000000000000) != 0)
      {
        v17 = *(v15 + 8);
        v16 = *(v15 + 16);
      }

      else
      {
        v17 = (v15 + 8);
      }

      v18 = v12 >= v16 ? v16 : v12;
      v19 = memcmp(v17, v13, v18);
      if (v12 == v16 && v19 == 0)
      {
        return v15;
      }

      v9 = v14;
    }

    while (v10 > v14++);
  }

  if (!a3)
  {
    return 0;
  }

  return SipMessage::addHeader(a1, a2, &ims::kEmptyString, 0);
}

uint64_t SipMessage::firstHeaderWithName(uint64_t a1, const void **a2)
{
  v3 = *(a1 + 48);
  v2 = *(a1 + 56);
  v4 = v2 - v3;
  if (v2 == v3)
  {
    return 0;
  }

  v5 = 0;
  v6 = v4 >> 3;
  v7 = *(a2 + 23);
  if (v7 >= 0)
  {
    v8 = *(a2 + 23);
  }

  else
  {
    v8 = a2[1];
  }

  if (v7 >= 0)
  {
    v9 = a2;
  }

  else
  {
    v9 = *a2;
  }

  v10 = 1;
  while (1)
  {
    v11 = *(v3 + 8 * v5);
    v12 = *(v11 + 31);
    if ((v12 & 0x8000000000000000) != 0)
    {
      v13 = *(v11 + 8);
      v12 = *(v11 + 16);
    }

    else
    {
      v13 = (v11 + 8);
    }

    v14 = v8 >= v12 ? v12 : v8;
    v15 = memcmp(v13, v9, v14);
    if (v8 == v12 && v15 == 0)
    {
      break;
    }

    v5 = v10;
    if (v6 <= v10++)
    {
      return 0;
    }
  }

  return v11;
}

void SipMessage::transactionId(SipMessage *this@<X0>, std::string *a2@<X8>)
{
  HeaderWith = SipMessage::firstHeaderWithType<SipViaHeader>(this);
  if (HeaderWith && (v4 = HeaderWith[8], v4 != HeaderWith[9]) && *v4)
  {
    v5 = SipViaHop::branch(*v4);
    if (*(v5 + 23) < 0)
    {
      v7 = *v5;
      v8 = *(v5 + 1);

      std::string::__init_copy_ctor_external(a2, v7, v8);
    }

    else
    {
      v6 = *v5;
      a2->__r_.__value_.__r.__words[2] = *(v5 + 2);
      *&a2->__r_.__value_.__l.__data_ = v6;
    }
  }

  else
  {
    a2->__r_.__value_.__r.__words[0] = 0;
    a2->__r_.__value_.__l.__size_ = 0;
    a2->__r_.__value_.__r.__words[2] = 0;
  }
}

const void **SipMessage::firstHeaderWithType<SipViaHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::firstHeaderWithName(a1, &SipHeader::kHeaderVia, a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

char **SipMessage::firstHeaderWithType<SipViaHeader>(uint64_t a1)
{
  result = SipMessage::firstHeaderWithName(a1, &SipHeader::kHeaderVia);
  if (result)
  {
    v2 = **result;
  }

  return result;
}

void SipMessage::addRouteHop(SipMessage *this, const SipUri *a2, BOOL a3, BOOL a4)
{
  v7 = SipMessage::header<SipRouteHeader>(this, 1);
  v9[0] = 0;
  v9[1] = 0;
  v8[0] = &unk_1F5EBEF50;
  v8[1] = v9;
  v10 = 256;
  SipRouteSet::addHop((v7 + 8), a2, a3, a4, v8);
}

const void **SipMessage::header<SipRouteHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Route", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

uint64_t *SipMessage::removeHeadersWithName(void *a1, const void **a2)
{
  v4 = a1[6];
  v5 = a1[7];
  while (v4 != v5)
  {
    v6 = *v4;
    v7 = *(*v4 + 31);
    if (v7 >= 0)
    {
      v8 = *(*v4 + 31);
    }

    else
    {
      v8 = *(*v4 + 16);
    }

    v9 = *(a2 + 23);
    v10 = v9;
    if (v9 < 0)
    {
      v9 = a2[1];
    }

    if (v8 == v9 && (v7 >= 0 ? (v11 = v6 + 1) : (v11 = v6[1]), (v12 = *a2, v10 >= 0) ? (v13 = a2) : (v13 = *a2), !memcmp(v11, v13, v8)))
    {
      (*(*v6 + 8))(v6);
      v14 = a1[7];
      v15 = v14 - (v4 + 8);
      if (v14 != v4 + 8)
      {
        memmove(v4, (v4 + 8), v14 - (v4 + 8));
      }

      v5 = v4 + v15;
      a1[7] = v4 + v15;
    }

    else
    {
      v4 += 8;
    }
  }

  return std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::__erase_unique<std::string>(a1 + 9, a2);
}

uint64_t SipMessage::headerValueAsString(uint64_t a1, const void **a2)
{
  v2 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), a2);
  if (!v2)
  {
    return 0;
  }

  v3 = v2[5];
  if (!v3)
  {
    return 0;
  }

  v4 = *(*v3 + 40);

  return v4();
}

uint64_t SipMessage::headerValueAsUint32(uint64_t a1, const void **a2, _DWORD *a3)
{
  v6 = SipMessage::headerWithName<SipUint32Header>(a1, a2);
  if (v6)
  {
    *a3 = v6[15];
    return 1;
  }

  else
  {
    __p[0] = 0;
    __p[1] = 0;
    v11 = 0;
    v7 = SipMessage::headerValueAsString(a1, a2);
    if (v7)
    {
      if (v11 >= 0)
      {
        v8 = __p;
      }

      else
      {
        v8 = __p[0];
      }

      *a3 = strtoul(v8, 0, 10);
    }

    if (SHIBYTE(v11) < 0)
    {
      operator delete(__p[0]);
    }
  }

  return v7;
}

void sub_1E5144108(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipMessage::headerWithName<SipUint32Header>(uint64_t a1, const void **a2)
{
  v2 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), a2);
  if (!v2)
  {
    return 0;
  }

  v3 = v2[5];
  if (!v3)
  {
    return 0;
  }

  v4 = **v3;
}

void SipMessage::encodeToString()
{
  v1 = 0;
  memset(v0, 0, sizeof(v0));
  ImsStringOutStream::ImsStringOutStream(v0);
}

void sub_1E5144278(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, char a15)
{
  if (a15 == 1)
  {
    if (a14)
    {
      (*(*a14 + 8))(a14);
    }
  }

  _Unwind_Resume(exception_object);
}

void SipMessage::encode(SipMessage *this, ImsOutStream *a2)
{
  (*(*this + 96))(this);
  if (((*(*a2 + 16))(a2) & 1) == 0)
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
  }

  (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(a2 + 17) = 0;
  SipMessage::encodeHeaders(this, a2);
  v4 = *(this + 14);
  if (!v4)
  {
    goto LABEL_12;
  }

  v5 = (*(*v4 + 40))(v4);
  v6 = *(v5 + 23);
  if ((v6 & 0x80u) != 0)
  {
    v6 = *(v5 + 8);
  }

  if (v6)
  {
    v18 = 0;
    *v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v13 = 0u;
    memset(v12, 0, sizeof(v12));
    std::string::basic_string[abi:ne200100]<0>(&__p, "");
    SipStringParameterHeader::SipStringParameterHeader(v12, "Content-Type", &__p);
    *&v12[0] = &unk_1F5EE1048;
    BYTE8(v13) = 0;
    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

    (*(**(this + 14) + 32))(*(this + 14), v12);
    SipHeader::encode(v12, a2, *(*(this + 15) + 128));
    SipParameterMap::toStream(&v14, a2, 0, 0, 0, 0);
    v7 = *(a2 + 18);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "Content-Length: ", 16);
    *(a2 + 17) = 0;
    v8 = (*(**(this + 14) + 48))(*(this + 14), v7);
    MEMORY[0x1E6923370](*(a2 + 1), v8);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    v9 = *(this + 14);
    v10 = (*(*a2 + 16))(a2);
    (*(*v9 + 64))(v9, a2, v10);
    *&v12[0] = &unk_1F5ECDC48;
    if (SHIBYTE(v17) < 0)
    {
      operator delete(v16[1]);
    }

    *&v12[0] = &unk_1F5EEE300;
    *&v14 = &unk_1F5EBEF50;
    std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v14 + 8, v15);
    SipHeader::~SipHeader(v12);
  }

  else
  {
LABEL_12:
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "Content-Length: 0\r", 18);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
  }
}

void sub_1E51447AC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, char a16)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipMessage::encodeHeaders(void *this, ImsOutStream *a2)
{
  v2 = this[6];
  if (this[7] != v2)
  {
    v4 = this;
    v5 = 0;
    v6 = 1;
    do
    {
      (*(**(v2 + 8 * v5) + 104))(*(v2 + 8 * v5), a2, *(v4[15] + 128));
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
      *(a2 + 17) = 0;
      this = (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(a2 + 17) = 0;
      v5 = v6;
      v2 = v4[6];
      ++v6;
    }

    while (v5 < (v4[7] - v2) >> 3);
  }

  return this;
}

void SipMessage::encodeBody(SipMessage *this, ImsOutStream *a2)
{
  v4 = *(this + 14);
  if (!v4)
  {
    goto LABEL_10;
  }

  v5 = (*(*v4 + 40))(v4);
  v6 = *(v5 + 23);
  if ((v6 & 0x80u) != 0)
  {
    v6 = *(v5 + 8);
  }

  if (v6)
  {
    v18 = 0;
    *v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v13 = 0u;
    memset(v12, 0, sizeof(v12));
    std::string::basic_string[abi:ne200100]<0>(&__p, "");
    SipStringParameterHeader::SipStringParameterHeader(v12, "Content-Type", &__p);
    *&v12[0] = &unk_1F5EE1048;
    BYTE8(v13) = 0;
    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

    (*(**(this + 14) + 32))(*(this + 14), v12);
    SipHeader::encode(v12, a2, *(*(this + 15) + 128));
    SipParameterMap::toStream(&v14, a2, 0, 0, 0, 0);
    v7 = *(a2 + 18);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "Content-Length: ", 16);
    *(a2 + 17) = 0;
    v8 = (*(**(this + 14) + 48))(*(this + 14), v7);
    MEMORY[0x1E6923370](*(a2 + 1), v8);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    v9 = *(this + 14);
    v10 = (*(*a2 + 16))(a2);
    (*(*v9 + 64))(v9, a2, v10);
    *&v12[0] = &unk_1F5ECDC48;
    if (SHIBYTE(v17) < 0)
    {
      operator delete(v16[1]);
    }

    *&v12[0] = &unk_1F5EEE300;
    *&v14 = &unk_1F5EBEF50;
    std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v14 + 8, v15);
    SipHeader::~SipHeader(v12);
  }

  else
  {
LABEL_10:
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "Content-Length: 0\r", 18);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "\r", 1);
    *(a2 + 17) = 0;
    (*(*a2 + 64))(a2, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(a2 + 17) = 0;
  }
}

void sub_1E5144CE0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, char a16)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

BOOL SipMessage::supportsOption(uint64_t a1, void **a2)
{
  __p = 0;
  v10 = 0;
  v11 = 0;
  SipMessage::allHeadersWithType<SipSupportedHeader>(a1, &__p);
  v4 = __p;
  if (v10 == __p)
  {
LABEL_5:
    v7 = SipMessage::requiresOption(a1, a2);
  }

  else
  {
    v5 = 0;
    while (1)
    {
      v6 = v4[v5];
      if (v6 + 72 != std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v6 + 64, a2))
      {
        break;
      }

      ++v5;
      v4 = __p;
      if (v5 >= (v10 - __p) >> 3)
      {
        goto LABEL_5;
      }
    }

    v7 = 1;
  }

  if (__p)
  {
    v10 = __p;
    operator delete(__p);
  }

  return v7;
}

void sub_1E5144DC0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

BOOL SipMessage::allHeadersWithType<SipSupportedHeader>(uint64_t a1, uint64_t a2)
{
  v2 = *a2;
  *(a2 + 8) = *a2;
  v4 = *(a1 + 48);
  v3 = *(a1 + 56);
  if (v3 == v4)
  {
    v24 = v2;
  }

  else
  {
    v7 = 0;
    v8 = 1;
    do
    {
      v9 = *(v4 + 8 * v7);
      v10 = *(v9 + 31);
      if ((v10 & 0x8000000000000000) != 0)
      {
        v11 = v9[1];
        v10 = v9[2];
      }

      else
      {
        v11 = v9 + 1;
      }

      if (v10 >= 9)
      {
        v12 = 9;
      }

      else
      {
        v12 = v10;
      }

      v13 = memcmp(v11, "Supported", v12);
      if (v10 == 9 && v13 == 0)
      {
        v15 = **v9;
        v17 = *(a2 + 16);
        if (v2 >= v17)
        {
          v18 = *a2;
          v19 = v2 - *a2;
          v20 = (v19 >> 3) + 1;
          if (v20 >> 61)
          {
            std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
          }

          v21 = v17 - v18;
          if (v21 >> 2 > v20)
          {
            v20 = v21 >> 2;
          }

          if (v21 >= 0x7FFFFFFFFFFFFFF8)
          {
            v22 = 0x1FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v22 = v20;
          }

          if (v22)
          {
            if (!(v22 >> 61))
            {
              operator new();
            }

            std::__throw_bad_array_new_length[abi:ne200100]();
          }

          v23 = (8 * (v19 >> 3));
          *v23 = v16;
          v2 = v23 + 1;
          memcpy(0, v18, v19);
          *a2 = 0;
          *(a2 + 8) = v2;
          *(a2 + 16) = 0;
          if (v18)
          {
            operator delete(v18);
          }
        }

        else
        {
          *v2++ = v16;
        }

        *(a2 + 8) = v2;
        v4 = *(a1 + 48);
        v3 = *(a1 + 56);
      }

      v7 = v8++;
    }

    while (v7 < (v3 - v4) >> 3);
    v24 = *a2;
  }

  return v24 != v2;
}

BOOL SipMessage::requiresOption(uint64_t a1, void **a2)
{
  __p = 0;
  v11 = 0;
  v12 = 0;
  SipMessage::allHeadersWithType<SipRequireHeader>(a1, &__p);
  v3 = __p;
  if (v11 == __p)
  {
    v8 = 0;
    if (!__p)
    {
      return v8;
    }

    goto LABEL_7;
  }

  v4 = 0;
  do
  {
    v5 = v3[v4];
    v6 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v5 + 64, a2);
    v3 = __p;
    v7 = v5 + 72 == v6;
    v8 = v5 + 72 != v6;
    if (!v7)
    {
      break;
    }

    ++v4;
  }

  while (v4 < (v11 - __p) >> 3);
  if (__p)
  {
LABEL_7:
    v11 = v3;
    operator delete(v3);
  }

  return v8;
}

void sub_1E5145060(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void SipMessage::addSupportedOption(SipMessage *a1, void **a2)
{
  __p = 0;
  v10 = 0;
  v11 = 0;
  SipMessage::allHeadersWithType<SipSupportedHeader>(a1, &__p);
  v4 = __p;
  v5 = v10;
  if (v10 == __p)
  {
LABEL_5:
    if (v4 == v5)
    {
      v8 = SipMessage::addHeader<SipSupportedHeader>(a1, 0);
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(v8 + 64, a2);
    }

    else
    {
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(*v4 + 64, a2);
    }
  }

  else
  {
    v6 = 0;
    while (1)
    {
      v7 = v4[v6];
      if (v7 + 72 != std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v7 + 64, a2))
      {
        break;
      }

      ++v6;
      v4 = __p;
      v5 = v10;
      if (v6 >= (v10 - __p) >> 3)
      {
        goto LABEL_5;
      }
    }
  }

  if (__p)
  {
    v10 = __p;
    operator delete(__p);
  }
}

void sub_1E5145150(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipMessage::addHeader<SipSupportedHeader>(SipMessage *a1, int a2)
{
  v4 = SipMessageEncodingMap::headerPrototype<SipSupportedHeader>(*(a1 + 15));
  if (!v4)
  {
    return 0;
  }

  v5 = (*(*v4 + 4))(v4);
  if (!v5)
  {
    return 0;
  }

  v6 = SipMessage::addHeader(a1, v5, a2);
  if (!v6)
  {
    return 0;
  }

  v7 = **v6;
}

BOOL SipMessage::allHeadersWithType<SipRequireHeader>(uint64_t a1, uint64_t a2)
{
  v2 = *a2;
  *(a2 + 8) = *a2;
  v4 = *(a1 + 48);
  v3 = *(a1 + 56);
  if (v3 == v4)
  {
    v24 = v2;
  }

  else
  {
    v7 = 0;
    v8 = 1;
    do
    {
      v9 = *(v4 + 8 * v7);
      v10 = *(v9 + 31);
      if ((v10 & 0x8000000000000000) != 0)
      {
        v11 = v9[1];
        v10 = v9[2];
      }

      else
      {
        v11 = v9 + 1;
      }

      if (v10 >= 7)
      {
        v12 = 7;
      }

      else
      {
        v12 = v10;
      }

      v13 = memcmp(v11, "Require", v12);
      if (v10 == 7 && v13 == 0)
      {
        v15 = **v9;
        v17 = *(a2 + 16);
        if (v2 >= v17)
        {
          v18 = *a2;
          v19 = v2 - *a2;
          v20 = (v19 >> 3) + 1;
          if (v20 >> 61)
          {
            std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
          }

          v21 = v17 - v18;
          if (v21 >> 2 > v20)
          {
            v20 = v21 >> 2;
          }

          if (v21 >= 0x7FFFFFFFFFFFFFF8)
          {
            v22 = 0x1FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v22 = v20;
          }

          if (v22)
          {
            if (!(v22 >> 61))
            {
              operator new();
            }

            std::__throw_bad_array_new_length[abi:ne200100]();
          }

          v23 = (8 * (v19 >> 3));
          *v23 = v16;
          v2 = v23 + 1;
          memcpy(0, v18, v19);
          *a2 = 0;
          *(a2 + 8) = v2;
          *(a2 + 16) = 0;
          if (v18)
          {
            operator delete(v18);
          }
        }

        else
        {
          *v2++ = v16;
        }

        *(a2 + 8) = v2;
        v4 = *(a1 + 48);
        v3 = *(a1 + 56);
      }

      v7 = v8++;
    }

    while (v7 < (v3 - v4) >> 3);
    v24 = *a2;
  }

  return v24 != v2;
}

BOOL SipMessage::allHeadersWithType<SipProxyRequireHeader>(uint64_t a1, uint64_t a2)
{
  v2 = *a2;
  *(a2 + 8) = *a2;
  v4 = *(a1 + 48);
  v3 = *(a1 + 56);
  if (v3 == v4)
  {
    v24 = v2;
  }

  else
  {
    v7 = 0;
    v8 = 1;
    do
    {
      v9 = *(v4 + 8 * v7);
      v10 = *(v9 + 31);
      if ((v10 & 0x8000000000000000) != 0)
      {
        v11 = v9[1];
        v10 = v9[2];
      }

      else
      {
        v11 = v9 + 1;
      }

      if (v10 >= 0xD)
      {
        v12 = 13;
      }

      else
      {
        v12 = v10;
      }

      v13 = memcmp(v11, "Proxy-Require", v12);
      if (v10 == 13 && v13 == 0)
      {
        v15 = **v9;
        v17 = *(a2 + 16);
        if (v2 >= v17)
        {
          v18 = *a2;
          v19 = v2 - *a2;
          v20 = (v19 >> 3) + 1;
          if (v20 >> 61)
          {
            std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
          }

          v21 = v17 - v18;
          if (v21 >> 2 > v20)
          {
            v20 = v21 >> 2;
          }

          if (v21 >= 0x7FFFFFFFFFFFFFF8)
          {
            v22 = 0x1FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v22 = v20;
          }

          if (v22)
          {
            if (!(v22 >> 61))
            {
              operator new();
            }

            std::__throw_bad_array_new_length[abi:ne200100]();
          }

          v23 = (8 * (v19 >> 3));
          *v23 = v16;
          v2 = v23 + 1;
          memcpy(0, v18, v19);
          *a2 = 0;
          *(a2 + 8) = v2;
          *(a2 + 16) = 0;
          if (v18)
          {
            operator delete(v18);
          }
        }

        else
        {
          *v2++ = v16;
        }

        *(a2 + 8) = v2;
        v4 = *(a1 + 48);
        v3 = *(a1 + 56);
      }

      v7 = v8++;
    }

    while (v7 < (v3 - v4) >> 3);
    v24 = *a2;
  }

  return v24 != v2;
}

void SipMessage::addRequiredOption(SipMessage *a1, void **a2)
{
  __p = 0;
  v10 = 0;
  v11 = 0;
  SipMessage::allHeadersWithType<SipRequireHeader>(a1, &__p);
  v4 = __p;
  v5 = v10;
  if (v10 == __p)
  {
LABEL_5:
    if (v4 == v5)
    {
      v8 = SipMessage::addHeader<SipRequireHeader>(a1, 0);
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(v8 + 64, a2);
    }

    else
    {
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(*v4 + 64, a2);
    }
  }

  else
  {
    v6 = 0;
    while (1)
    {
      v7 = v4[v6];
      if (v7 + 72 != std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v7 + 64, a2))
      {
        break;
      }

      ++v6;
      v4 = __p;
      v5 = v10;
      if (v6 >= (v10 - __p) >> 3)
      {
        goto LABEL_5;
      }
    }
  }

  if (__p)
  {
    v10 = __p;
    operator delete(__p);
  }
}

void sub_1E51456BC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipMessage::addHeader<SipRequireHeader>(SipMessage *a1, int a2)
{
  v4 = SipMessageEncodingMap::headerPrototype<SipRequireHeader>(*(a1 + 15));
  if (!v4)
  {
    return 0;
  }

  v5 = (*(*v4 + 4))(v4);
  if (!v5)
  {
    return 0;
  }

  v6 = SipMessage::addHeader(a1, v5, a2);
  if (!v6)
  {
    return 0;
  }

  v7 = **v6;
}

void SipMessage::addProxyRequiredOption(SipMessage *a1, void **a2)
{
  __p = 0;
  v10 = 0;
  v11 = 0;
  SipMessage::allHeadersWithType<SipProxyRequireHeader>(a1, &__p);
  v4 = __p;
  v5 = v10;
  if (v10 == __p)
  {
LABEL_5:
    if (v4 == v5)
    {
      v8 = SipMessage::addHeader<SipProxyRequireHeader>(a1, 0);
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(v8 + 64, a2);
    }

    else
    {
      std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(*v4 + 64, a2);
    }
  }

  else
  {
    v6 = 0;
    while (1)
    {
      v7 = v4[v6];
      if (v7 + 72 != std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(v7 + 64, a2))
      {
        break;
      }

      ++v6;
      v4 = __p;
      v5 = v10;
      if (v6 >= (v10 - __p) >> 3)
      {
        goto LABEL_5;
      }
    }
  }

  if (__p)
  {
    v10 = __p;
    operator delete(__p);
  }
}

void sub_1E5145878(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void *SipMessage::addHeader<SipProxyRequireHeader>(SipMessage *a1, int a2)
{
  v4 = SipMessageEncodingMap::headerPrototype<SipProxyRequireHeader>(*(a1 + 15));
  if (!v4)
  {
    return 0;
  }

  v5 = (*(*v4 + 4))(v4);
  if (!v5)
  {
    return 0;
  }

  v6 = SipMessage::addHeader(a1, v5, a2);
  if (!v6)
  {
    return 0;
  }

  v7 = **v6;
}

void *SipMessage::header<SipCallIdHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), "Call-ID");
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

void *SipMessage::header<SipConversationIdHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), "Conversation-ID");
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

void *SipMessage::header<SipContributionIdHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), "Contribution-ID");
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

void *SipMessage::header<SipInReplyToContributionIdHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), &SipHeader::kInReplyToContributionId);
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

void SipMessage::reasonText(SipMessage *this@<X0>, std::string *a2@<X8>)
{
  v3 = SipMessage::header<SipReasonHeader>(this);
  if (v3 && (v4 = SipReasonHeader::bestReason(v3)) != 0)
  {

    SipReason::text(v4, a2);
  }

  else
  {
    a2->__r_.__value_.__r.__words[0] = 0;
    a2->__r_.__value_.__l.__size_ = 0;
    a2->__r_.__value_.__r.__words[2] = 0;
  }
}

void SipMessage::reasonProtocol(SipMessage *this@<X0>, std::string *a2@<X8>)
{
  v3 = SipMessage::header<SipReasonHeader>(this);
  if (v3 && (v4 = SipReasonHeader::bestReason(v3)) != 0)
  {
    if (*(v4 + 23) < 0)
    {
      v6 = *v4;
      v7 = *(v4 + 1);

      std::string::__init_copy_ctor_external(a2, v6, v7);
    }

    else
    {
      v5 = *v4;
      a2->__r_.__value_.__r.__words[2] = *(v4 + 2);
      *&a2->__r_.__value_.__l.__data_ = v5;
    }
  }

  else
  {
    a2->__r_.__value_.__r.__words[0] = 0;
    a2->__r_.__value_.__l.__size_ = 0;
    a2->__r_.__value_.__r.__words[2] = 0;
  }
}

unint64_t SipMessage::reasonCause(SipMessage *this)
{
  v1 = SipMessage::header<SipReasonHeader>(this);
  if (!v1)
  {
    return 0;
  }

  v2 = SipReasonHeader::bestReason(v1);
  if (!v2)
  {
    return 0;
  }

  return SipReason::cause(v2);
}

const void **SipMessage::header<SipCallIdHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Call-ID", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

void *SipMessage::header<SipSessionIdHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), "Session-ID");
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

const void **SipMessage::header<SipConversationIdHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Conversation-ID", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

const void **SipMessage::header<SipContributionIdHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Contribution-ID", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

const void **SipMessage::header<SipInReplyToContributionIdHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, &SipHeader::kInReplyToContributionId, a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

const void **SipMessage::header<SipSessionIdHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Session-ID", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

const void **SipMessage::header<SipUserAgentHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "User-Agent", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

const void **SipMessage::header<SipFromHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "From", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

__int128 *SipMessage::toTag(SipMessage *this)
{
  v1 = SipMessage::header<SipToHeader>(this);
  if (!v1)
  {
    return &ims::kEmptyString;
  }

  return SipUriHeader::tag(v1);
}

const void **SipMessage::header<SipToHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, &SipHeader::kHeaderTo, a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

void *SipMessage::header<SipSubjectHeader>(uint64_t a1)
{
  v1 = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>((a1 + 72), "Subject");
  if (!v1)
  {
    return 0;
  }

  v2 = v1[5];
  if (!v2)
  {
    return 0;
  }

  v3 = **v2;
}

void SipMessage::referredBy(SipMessage *this@<X0>, std::string *a2@<X8>)
{
  v3 = SipMessage::header<SipReferredByHeader>(this);
  if (v3)
  {
    v4 = (v3 + 104);

    SipUri::normalizedPhoneNumber(v4, a2);
  }

  else
  {
    a2->__r_.__value_.__r.__words[0] = 0;
    a2->__r_.__value_.__l.__size_ = 0;
    a2->__r_.__value_.__r.__words[2] = 0;
  }
}

const void **SipMessage::header<SipSubjectHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Subject", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

void SipMessage::validate(SipMessage *this@<X0>, uint64_t a2@<X8>)
{
  HeaderWith = SipMessage::firstHeaderWithType<SipViaHeader>(this);
  if (HeaderWith && (v5 = HeaderWith[8], v5 != HeaderWith[9]) && *v5)
  {
    if (SipMessage::header<SipToHeader>(this))
    {
      if (SipMessage::header<SipFromHeader>(this))
      {
        v6 = SipMessage::header<SipCallIdHeader>(this);
        v7 = &ims::kEmptyString;
        if (v6)
        {
          v7 = (v6 + 64);
        }

        v8 = *(v7 + 23);
        if (v8 < 0)
        {
          v8 = *(v7 + 1);
        }

        if (v8)
        {
          v9 = SipMessage::header<SipCSeqHeader>(this);
          if (v9 && v9[15])
          {
            *(a2 + 24) = 0u;
            *(a2 + 40) = 0u;
            *(a2 + 56) = 0u;
            *(a2 + 72) = 0u;
            *a2 = &unk_1F5EBDEF8;
            *(a2 + 8) = &_bambiDomain;
            *(a2 + 16) = 0;
            return;
          }

          v18 = 0u;
          v19 = 0u;
          v20 = 0u;
          v21 = 0u;
          v15 = &unk_1F5EBDEF8;
          v16 = &_bambiDomain;
          v17 = 1073741828;
          v13 = ImsResult::operator<<<char [13]>(&v15, "invalid CSeq");
          ImsResult::ImsResult(a2, v13);
        }

        else
        {
          v18 = 0u;
          v19 = 0u;
          v20 = 0u;
          v21 = 0u;
          v15 = &unk_1F5EBDEF8;
          v16 = &_bambiDomain;
          v17 = 1073741828;
          v14 = ImsResult::operator<<<char [23]>(&v15, "missing Call-ID header");
          ImsResult::ImsResult(a2, v14);
        }
      }

      else
      {
        v18 = 0u;
        v19 = 0u;
        v20 = 0u;
        v21 = 0u;
        v15 = &unk_1F5EBDEF8;
        v16 = &_bambiDomain;
        v17 = 1073741828;
        v12 = ImsResult::operator<<<char [21]>(&v15, "missing From: header");
        ImsResult::ImsResult(a2, v12);
      }
    }

    else
    {
      v18 = 0u;
      v19 = 0u;
      v20 = 0u;
      v21 = 0u;
      v15 = &unk_1F5EBDEF8;
      v16 = &_bambiDomain;
      v17 = 1073741828;
      v11 = ImsResult::operator<<<char [19]>(&v15, "missing To: header");
      ImsResult::ImsResult(a2, v11);
    }
  }

  else
  {
    v18 = 0u;
    v19 = 0u;
    v20 = 0u;
    v21 = 0u;
    v15 = &unk_1F5EBDEF8;
    v16 = &_bambiDomain;
    v17 = 1073741828;
    v10 = ImsResult::operator<<<char [19]>(&v15, "invalid Via header");
    ImsResult::ImsResult(a2, v10);
  }

  ImsResult::~ImsResult(&v15);
}

void sub_1E5146554(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

const void **SipMessage::header<SipReasonHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Reason", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

void SipMessage::addReasonWithParams(SipMessage *a1, uint64_t a2, const SipParameterMap **a3, uint64_t a4, const std::string *a5)
{
  v9 = SipMessage::header<SipReasonHeader>(a1, 1);
  *__p = 0u;
  memset(v11, 0, sizeof(v11));
  SipReason::SipReason(__p, a5, a2, a4);
  if (*a3)
  {
    SipParameterMap::addParameters((v11 + 8), *a3);
  }

  SipReasonHeader::addReason(v9, __p);
}

const void **SipMessage::header<SipContactHeader>(SipMessage *a1, int a2)
{
  result = SipMessage::headerWithName(a1, "Contact", a2);
  if (result)
  {
    v3 = **result;
  }

  return result;
}

uint64_t SipMessage::setContact(SipMessage *this, const SipContactParam *a2)
{
  v3 = SipMessage::header<SipContactHeader>(this, 1);
  v5 = v3[9];
  v4 = v3[10];
  if (v4 != v5)
  {
    v6 = v4 - 504;
    v7 = v4 - 504;
    do
    {
      (**v7)(v7);
      v6 -= 504;
      v8 = v7 == v5;
      v7 -= 504;
    }

    while (!v8);
  }

  v3[10] = v5;

  return SipContactParamList::addContact((v3 + 8), a2);
}

uint64_t SipContactParamList::addContact(SipContactParamList *this, const SipContactParam *a2)
{
  v3 = *(this + 2);
  if (v3 >= *(this + 3))
  {
    result = std::vector<SipContactParam>::__emplace_back_slow_path<SipContactParam const&>(this + 8, a2);
  }

  else
  {
    std::allocator_traits<std::allocator<SipContactParam>>::construct[abi:ne200100]<SipContactParam,SipContactParam const&,void,0>(this + 8, v3, a2);
    result = v3 + 504;
    *(this + 2) = v3 + 504;
  }

  *(this + 2) = result;
  return result;
}

char **SipMessage::body<SipCallWaitingInfoBody>(uint64_t a1)
{
  result = SipMessage::bodyWithContentType(a1, &SipCallWaitingInfoBody::kContentType);
  if (result)
  {
    v2 = **result;
  }

  return result;
}

BOOL SipMessage::hasPreconditions(SipMessage *this)
{
  v1 = SipMessage::body<SipSdpBody>(this);
  if (!v1)
  {
    return 0;
  }

  v2 = v1;
  v3 = v1[1];
  v4 = v2[2];
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  if (v3)
  {
    hasPreconditions = SDPModel::hasPreconditions(v3);
    if (!v4)
    {
      return hasPreconditions;
    }

    goto LABEL_9;
  }

  hasPreconditions = 0;
  if (v4)
  {
LABEL_9:
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }

  return hasPreconditions;
}

void sub_1E5146944(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  _Unwind_Resume(exception_object);
}

char *SipMessage::assertedIdentity(uint64_t a1, int a2)
{
  if (a2 == 3)
  {
    v4 = SipMessage::header<SipFromHeader>(a1);
    if (v4)
    {
      return v4 + 104;
    }
  }

  __p = 0;
  v20 = 0;
  v21 = 0;
  isTelUri = SipMessage::allHeadersWithType<SipPAssertedIdentityHeader>(a1, &__p);
  v7 = __p;
  v8 = v20;
  if (__p == v20)
  {
    goto LABEL_26;
  }

  v9 = 0;
  v5 = 0;
  do
  {
    v10 = *v7;
    v16 = 0;
    v17 = 0;
    v18 = 0;
    SipRouteSet::allHops(v10 + 64, &v16);
    v11 = v16;
    v12 = v17;
    if (v16 == v17)
    {
      v14 = 1;
      if (v16)
      {
        goto LABEL_22;
      }

      goto LABEL_23;
    }

    while (1)
    {
      v13 = *v11;
      if (!v5)
      {
        v5 = *v11;
      }

      if (a2 == 1)
      {
        break;
      }

      if (a2 == 2)
      {
        isTelUri = SipUri::isTelUri(*v11);
        goto LABEL_15;
      }

      if (!a2)
      {
        goto LABEL_20;
      }

LABEL_16:
      if (++v11 == v12)
      {
        v14 = 1;
        v13 = v9;
        goto LABEL_21;
      }
    }

    isTelUri = SipUri::isSipUri(*v11);
LABEL_15:
    if (!isTelUri)
    {
      goto LABEL_16;
    }

LABEL_20:
    v14 = 0;
LABEL_21:
    v11 = v16;
    v9 = v13;
    if (v16)
    {
LABEL_22:
      v17 = v11;
      operator delete(v11);
    }

LABEL_23:
    if ((v14 & 1) == 0)
    {
      v5 = v9;
      goto LABEL_28;
    }

    ++v7;
  }

  while (v7 != v8);
  if (!v5)
  {
LABEL_26:
    v5 = SipUri::anonymousUri(isTelUri);
  }

LABEL_28:
  if (__p)
  {
    v20 = __p;
    operator delete(__p);
  }

  return v5;
}

void sub_1E5146ABC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13)
{
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void SipMessage::assertedIdentityList(SipMessage *this@<X0>, uint64_t a2@<X8>)
{
  *a2 = 0;
  *(a2 + 8) = 0;
  *(a2 + 16) = 0;
  __p = 0;
  v18 = 0;
  v19 = 0;
  v3 = SipMessage::allHeadersWithType<SipPAssertedIdentityHeader>(this, &__p);
  v4 = __p;
  v5 = v18;
  while (v4 != v5)
  {
    v6 = *v4;
    v14 = 0;
    v15 = 0;
    v16 = 0;
    SipRouteSet::allHops(v6 + 64, &v14);
    v7 = v14;
    v8 = v15;
    if (v14 != v15)
    {
      v9 = *(a2 + 8);
      do
      {
        v10 = *v7;
        if (v9 >= *(a2 + 16))
        {
          v3 = std::vector<SipUri>::__emplace_back_slow_path<SipUri const&>(a2, v10);
          v9 = v3;
        }

        else
        {
          SipUri::SipUri(v9, v10);
          v9 = (v9 + 408);
        }

        *(a2 + 8) = v9;
        ++v7;
      }

      while (v7 != v8);
      v7 = v14;
    }

    if (v7)
    {
      v15 = v7;
      operator delete(v7);
    }

    ++v4;
  }

  if (*a2 == *(a2 + 8))
  {
    v11 = SipUri::anonymousUri(v3);
    v12 = *(a2 + 8);
    if (v12 >= *(a2 + 16))
    {
      v13 = std::vector<SipUri>::__emplace_back_slow_path<SipUri const&>(a2, v11);
    }

    else
    {
      SipUri::SipUri(*(a2 + 8), v11);
      v13 = v12 + 408;
    }

    *(a2 + 8) = v13;
  }

  if (__p)
  {
    v18 = __p;
    operator delete(__p);
  }
}

void sub_1E5146C1C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13)
{
  v13[1] = v14;
  if (__p)
  {
    a13 = __p;
    operator delete(__p);
  }

  __p = v13;
  std::vector<SipUri>::__destroy_vector::operator()[abi:ne200100](&__p);
  _Unwind_Resume(a1);
}

void SipMessage::logStr(SipMessage *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E5146D58(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, char a11)
{
  if (a11 == 1)
  {
    if (a10)
    {
      (*(*a10 + 8))(a10);
    }
  }

  _Unwind_Resume(exception_object);
}

uint64_t *std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::__erase_unique<std::string>(void *a1, const void **a2)
{
  result = std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<MessageSession>>>>::find<std::string>(a1, a2);
  if (result)
  {
    std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::erase(a1, result);
    return 1;
  }

  return result;
}

uint64_t std::__hash_table<std::__hash_value_type<std::string,SipHeader *>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,SipHeader *>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,SipHeader *>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,SipHeader *>>>::erase(void *a1, uint64_t *a2)
{
  v2 = *a2;
  std::__hash_table<std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::__unordered_map_hasher<std::string,std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::hash<std::string>,std::equal_to<std::string>,true>,std::__unordered_map_equal<std::string,std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>,std::equal_to<std::string>,std::hash<std::string>,true>,std::allocator<std::__hash_value_type<std::string,std::shared_ptr<SipDialog>>>>::remove(a1, a2, &__p);
  v3 = __p;
  __p = 0;
  if (v3)
  {
    std::__hash_node_destructor<std::allocator<std::__hash_node<std::string,void *>>>::operator()[abi:ne200100](&v6, v3);
  }

  return v2;
}

char **SipMessageEncodingMap::headerPrototype<SipSupportedHeader>(void *a1)
{
  result = SipMessageEncodingMap::headerPrototypeWithName(a1, "Supported");
  if (result)
  {
    v2 = **result;
  }

  return result;
}

char **SipMessageEncodingMap::headerPrototype<SipRequireHeader>(void *a1)
{
  result = SipMessageEncodingMap::headerPrototypeWithName(a1, "Require");
  if (result)
  {
    v2 = **result;
  }

  return result;
}

char **SipMessageEncodingMap::headerPrototype<SipProxyRequireHeader>(void *a1)
{
  result = SipMessageEncodingMap::headerPrototypeWithName(a1, "Proxy-Require");
  if (result)
  {
    v2 = **result;
  }

  return result;
}

void IMSSecureNetworkSession::deinitialize(IMSSecureNetworkSession *this)
{
  IMSSecureNetworkSession::flush(this);
  if (*this)
  {
    IPSecDBInvalidateSession();
    CFRelease(*this);
    *this = 0;
  }
}

uint64_t IMSSecureNetworkSession::initialize(IMSSecureNetworkSession *this)
{
  if (*this)
  {
    return 1;
  }

  if (isIPSecLibraryLoaded())
  {
    goto LABEL_11;
  }

  v2 = std::string::basic_string[abi:ne200100]<0>(v23, "ipsec");
  v19[0] = 0;
  v22 = 0;
  v3 = ims::debug(v2, v19);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "initializing IPSec library", 26);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v22 == 1 && v21 < 0)
  {
    operator delete(v20);
  }

  if (v24 < 0)
  {
    operator delete(v23[0]);
  }

  if (qword_1EE2BCAD8 != -1)
  {
    dispatch_once(&qword_1EE2BCAD8, &__block_literal_global_14);
  }

  if (isIPSecLibraryLoaded())
  {
LABEL_11:
    v4 = _MergedGlobals_33(0, @"com.apple.ipTelephony", IPSecDBCallBack, this);
    *this = v4;
    if (v4)
    {
      return 1;
    }

    v6 = std::string::basic_string[abi:ne200100]<0>(v23, "ipsec");
    v11[0] = 0;
    v14 = 0;
    v7 = ims::error(v6, v11);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "unable to create IPSec DB", 25);
    *(v7 + 17) = 0;
    (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v7 + 17) = 0;
    if (v14 == 1 && v13 < 0)
    {
      v8 = v12;
LABEL_19:
      operator delete(v8);
    }
  }

  else
  {
    v9 = std::string::basic_string[abi:ne200100]<0>(v23, "ipsec");
    v15[0] = 0;
    v18 = 0;
    v10 = ims::error(v9, v15);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "unable to load IPSec library.  IPSec won't be working.", 54);
    *(v10 + 17) = 0;
    (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v10 + 17) = 0;
    if (v18 == 1 && v17 < 0)
    {
      v8 = __p;
      goto LABEL_19;
    }
  }

  if (v24 < 0)
  {
    operator delete(v23[0]);
  }

  return 0;
}

void sub_1E514729C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, void *__p, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28)
{
  if (a28 == 1 && a26 < 0)
  {
    operator delete(__p);
  }

  if (*(v28 - 17) < 0)
  {
    operator delete(*(v28 - 40));
  }

  _Unwind_Resume(exception_object);
}

BOOL isIPSecLibraryLoaded(void)
{
  result = 0;
  if (VirtualInterfaceAddAddress)
  {
    if (VirtualInterfaceCopyName)
    {
      if (VirtualInterfaceCreateNexus)
      {
        if (VirtualInterfaceUpdateAdHocService)
        {
          if (VirtualInterfaceSetDelegateInterface)
          {
            if (VirtualInterfaceInvalidate)
            {
              if (PolicyAdd)
              {
                if (PolicyDelete)
                {
                  if (PolicyDeleteAll)
                  {
                    if (PolicySetSessionPriority)
                    {
                      if (PolicyCreateSession)
                      {
                        if (PolicyApply)
                        {
                          result = 0;
                          if (_MergedGlobals_33)
                          {
                            if (off_1EE2BCAA8 && IPSecDBInvalidateSession && qword_1EE2BCAB0 && qword_1EE2BCAB8 && IPSecDBAddLarvalSA && IPSecDBAddSA && IPSecDBUpdateSA && IPSecDBDeleteSA && qword_1EE2BCAC0)
                            {
                              if (IPSecDBAddPolicy)
                              {
                                return qword_1EE2BCAC8 != 0;
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }

  return result;
}

void IPSecDBCallBack(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v5 = std::string::basic_string[abi:ne200100]<0>(v17, "ipsec");
  v13[0] = 0;
  v16 = 0;
  v6 = ims::debug(v5, v13);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "IPSecDBCallBack", 15);
  *(v6 + 17) = 0;
  (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v6 + 17) = 0;
  if (v16 == 1 && v15 < 0)
  {
    operator delete(__p);
  }

  if (v18 < 0)
  {
    operator delete(v17[0]);
  }

  v7 = std::string::basic_string[abi:ne200100]<0>(v17, "ipsec");
  v9[0] = 0;
  v12 = 0;
  v8 = ims::debug(v7, v9);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "itemID=", 7);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923350](*(v8 + 8), a2);
  *(v8 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), " notificationType=", 18);
  *(v8 + 17) = 0;
  MEMORY[0x1E6923350](*(v8 + 8), a3);
  *(v8 + 17) = 0;
  (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v8 + 17) = 0;
  if (v12 == 1 && v11 < 0)
  {
    operator delete(v10);
  }

  if (v18 < 0)
  {
    operator delete(v17[0]);
  }
}

void sub_1E51475EC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, void *__p, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29)
{
  if (a29 == 1 && a27 < 0)
  {
    operator delete(__p);
  }

  if (*(v29 - 33) < 0)
  {
    operator delete(*(v29 - 56));
  }

  _Unwind_Resume(exception_object);
}

uint64_t IMSSecureNetworkSession::flush(IMSSecureNetworkSession *this)
{
  if (!*this || off_1EE2BCAA8())
  {
    return 1;
  }

  v2 = std::string::basic_string[abi:ne200100]<0>(&v8, "ipsec");
  v4[0] = 0;
  v7 = 0;
  v3 = ims::error(v2, v4);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "flush failed", 12);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v7 == 1 && v6 < 0)
  {
    operator delete(__p);
  }

  if (v9 < 0)
  {
    operator delete(v8);
  }

  return 0;
}

void sub_1E5147730(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (*(v18 - 17) < 0)
  {
    operator delete(*(v18 - 40));
  }

  _Unwind_Resume(exception_object);
}

void ___ZL16loadIPSecLibraryv_block_invoke()
{
  v0 = dlopen("/System/Library/Frameworks/NetworkExtension.framework/NetworkExtension", 1);
  if (v0)
  {
    v1 = v0;
    v2 = std::string::basic_string[abi:ne200100]<0>(v20, "ipsec");
    v12[0] = 0;
    v15 = 0;
    v3 = ims::debug(v2, v12);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "loading IPSec functions", 23);
    *(v3 + 17) = 0;
    (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v3 + 17) = 0;
    if (v15 == 1 && v14 < 0)
    {
      operator delete(__p);
    }

    if (v21 < 0)
    {
      operator delete(v20[0]);
    }

    _MergedGlobals_33 = dlsym(v1, "NEIPSecDBCreateSession");
    off_1EE2BCAA8 = dlsym(v1, "NEIPSecDBFlushAll");
    IPSecDBInvalidateSession = dlsym(v1, "NEIPSecDBInvalidateSession");
    qword_1EE2BCAB0 = dlsym(v1, "NEIPSecDBScheduleWithRunLoop");
    qword_1EE2BCAB8 = dlsym(v1, "NEIPSecDBUnScheduleWithRunLoop");
    IPSecDBAddLarvalSA = dlsym(v1, "NEIPSecDBAddLarvalSA");
    IPSecDBAddSA = dlsym(v1, "NEIPSecDBAddSA");
    IPSecDBUpdateSA = dlsym(v1, "NEIPSecDBUpdateSA");
    IPSecDBDeleteSA = dlsym(v1, "NEIPSecDBDeleteSA");
    qword_1EE2BCAC0 = dlsym(v1, "NEIPSecDBFlushSAs");
    IPSecDBAddPolicy = dlsym(v1, "NEIPSecDBAddPolicy");
    qword_1EE2BCAC8 = dlsym(v1, "NEIPSecDBDeletePolicy");
    VirtualInterfaceAddAddress = dlsym(v1, "NEVirtualInterfaceAddAddress");
    VirtualInterfaceCopyName = dlsym(v1, "NEVirtualInterfaceCopyName");
    VirtualInterfaceCreateNexus = dlsym(v1, "NEVirtualInterfaceCreateNexus");
    VirtualInterfaceUpdateAdHocService = dlsym(v1, "NEVirtualInterfaceUpdateAdHocService");
    VirtualInterfaceSetDelegateInterface = dlsym(v1, "NEVirtualInterfaceSetDelegateInterface");
    VirtualInterfaceSetRankNever = dlsym(v1, "NEVirtualInterfaceSetRankNever");
    VirtualInterfaceInvalidate = dlsym(v1, "NEVirtualInterfaceInvalidate");
    VirtualInterfaceSetMTU = dlsym(v1, "NEVirtualInterfaceSetMTU");
    VirtualInterfaceSetOutputTrafficClass = dlsym(v1, "NEVirtualInterfaceSetOutputTrafficClass");
    PolicyAdd = dlsym(v1, "NEPolicyAdd");
    PolicyDelete = dlsym(v1, "NEPolicyDelete");
    PolicyDeleteAll = dlsym(v1, "NEPolicyDeleteAll");
    PolicySetSessionPriority = dlsym(v1, "NEPolicySetSessionPriority");
    PolicyCreateSession = dlsym(v1, "NEPolicyCreateSession");
    PolicyApply = dlsym(v1, "NEPolicyApply");
    qword_1EE2BCAD0 = dlsym(v1, "NEPolicyLockSessionToProcess");
    v4 = std::string::basic_string[abi:ne200100]<0>(v20, "ipsec");
    v8[0] = 0;
    v11 = 0;
    v5 = ims::debug(v4, v8);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "loading IPSec functions -- done!", 32);
    *(v5 + 17) = 0;
    (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v5 + 17) = 0;
    if (v11 == 1 && v10 < 0)
    {
      operator delete(v9);
    }

    if (v21 < 0)
    {
      operator delete(v20[0]);
    }

    dlclose(v1);
  }

  else
  {
    v6 = std::string::basic_string[abi:ne200100]<0>(v20, "ipsec");
    v16[0] = 0;
    v19 = 0;
    v7 = ims::error(v6, v16);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "unable to load IPSec library", 28);
    *(v7 + 17) = 0;
    (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v7 + 17) = 0;
    if (v19 == 1 && v18 < 0)
    {
      operator delete(v17);
    }

    if (v21 < 0)
    {
      operator delete(v20[0]);
    }
  }
}

void sub_1E5147C28(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, char a28)
{
  if (*(v28 - 48) == 1 && *(v28 - 57) < 0)
  {
    operator delete(*(v28 - 80));
  }

  if (*(v28 - 17) < 0)
  {
    operator delete(*(v28 - 40));
  }

  _Unwind_Resume(exception_object);
}

uint64_t SDPMediaRTPMap::value@<X0>(SDPMediaRTPMap *this@<X0>, _BYTE *a2@<X8>)
{
  v23 = 0;
  v21 = 0u;
  memset(v22, 0, sizeof(v22));
  *__p = 0u;
  v20 = 0u;
  v17 = 0u;
  *__src = 0u;
  v15 = 0u;
  v16 = 0u;
  std::ostringstream::basic_ostringstream[abi:ne200100](&v15);
  v4 = MEMORY[0x1E6923390](&v15, *(this + 20));
  v24 = 32;
  v5 = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &v24, 1);
  v6 = *(this + 71);
  if (v6 >= 0)
  {
    v7 = this + 48;
  }

  else
  {
    v7 = *(this + 6);
  }

  if (v6 >= 0)
  {
    v8 = *(this + 71);
  }

  else
  {
    v8 = *(this + 7);
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, v7, v8);
  if (*(this + 36))
  {
    v24 = 47;
    v9 = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(&v15, &v24, 1);
    MEMORY[0x1E6923390](v9, *(this + 36));
  }

  if (*(this + 37) >= 2u)
  {
    v24 = 47;
    v10 = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(&v15, &v24, 1);
    MEMORY[0x1E6923390](v10, *(this + 37));
  }

  if ((BYTE8(v21) & 0x10) != 0)
  {
    v12 = v21;
    if (v21 < __src[1])
    {
      *&v21 = __src[1];
      v12 = __src[1];
    }

    v13 = __src[0];
  }

  else
  {
    if ((BYTE8(v21) & 8) == 0)
    {
      v11 = 0;
      a2[23] = 0;
      goto LABEL_24;
    }

    v13 = *(&v16 + 1);
    v12 = *(&v17 + 1);
  }

  v11 = v12 - v13;
  if ((v12 - v13) >= 0x7FFFFFFFFFFFFFF8)
  {
    std::string::__throw_length_error[abi:ne200100]();
  }

  if (v11 >= 0x17)
  {
    operator new();
  }

  a2[23] = v11;
  if (v11)
  {
    memmove(a2, v13, v11);
  }

LABEL_24:
  a2[v11] = 0;
  *&v15 = *MEMORY[0x1E69E54E8];
  *(&v15 + *(v15 - 24)) = *(MEMORY[0x1E69E54E8] + 24);
  *(&v15 + 1) = MEMORY[0x1E69E5548] + 16;
  if (SHIBYTE(v20) < 0)
  {
    operator delete(__p[1]);
  }

  *(&v15 + 1) = MEMORY[0x1E69E5538] + 16;
  std::locale::~locale(&v16);
  std::ostream::~ostream();
  return MEMORY[0x1E6923510](v22);
}

void sub_1E5147F5C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  std::ostringstream::~ostringstream(&a9, MEMORY[0x1E69E54E8]);
  MEMORY[0x1E6923510](v9 + 112);
  _Unwind_Resume(a1);
}

BOOL SDPMediaRTPMap::valid(SDPMediaRTPMap *this)
{
  v1 = *(this + 71);
  if (v1 < 0)
  {
    v1 = *(this + 7);
  }

  return v1 != 0;
}

void SipAckRetransmitHandler::create(void *a1@<X8>)
{
  *a1 = 0;
  a1[1] = 0;
  std::allocate_shared[abi:ne200100]<SipAckRetransmitHandler,std::allocator<SipAckRetransmitHandler>,SipAckRetransmitHandler::PrivateConstructorParam,std::shared_ptr<SipSessionInterface> &,std::shared_ptr<SipClientInviteTransaction> &,0>();
}

void sub_1E51480AC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, std::__shared_weak_count *a11)
{
  if (a11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a11);
  }

  if (v12)
  {
    std::__shared_weak_count::__release_weak(v12);
  }

  v14 = *(v11 + 8);
  if (v14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v14);
  }

  _Unwind_Resume(exception_object);
}

void SipAckRetransmitHandler::~SipAckRetransmitHandler(SipAckRetransmitHandler *this)
{
  *this = &unk_1F5EF7580;
  *(this + 52) = &unk_1F5EF7680;
  *(this + 6) = &unk_1F5EF75E0;
  *(this + 23) = &unk_1F5EF7640;
  SipTimerContainer::cancelAllTimers((this + 240));
  v5 = 0;
  v6 = 0;
  (*(*this + 48))(this, &v5, 1);
  if (v6)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  SipTimerContainer::~SipTimerContainer((this + 240));
  v2 = *(this + 29);
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  v3 = *(this + 27);
  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  v4 = *(this + 25);
  if (v4)
  {
    std::__shared_weak_count::__release_weak(v4);
  }

  *(this + 6) = &unk_1F5ED7318;
  if (*(this + 128) == 1 && *(this + 119) < 0)
  {
    operator delete(*(this + 12));
  }

  if (*(this + 79) < 0)
  {
    operator delete(*(this + 7));
  }

  SipConnectionUser::~SipConnectionUser(this, off_1F5EF76A0);
  MEMORY[0x1E69225A0](this + 456);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 53);
}

{
  SipAckRetransmitHandler::~SipAckRetransmitHandler(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toSipAckRetransmitHandler::~SipAckRetransmitHandler(SipAckRetransmitHandler *this)
{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this - 48));
}

{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this - 184));
}

{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this - 48));

  JUMPOUT(0x1E69235B0);
}

{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this - 184));

  JUMPOUT(0x1E69235B0);
}

void virtual thunk toSipAckRetransmitHandler::~SipAckRetransmitHandler(SipAckRetransmitHandler *this)
{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this + *(*this - 24)));
}

{
  SipAckRetransmitHandler::~SipAckRetransmitHandler((this + *(*this - 24)));

  JUMPOUT(0x1E69235B0);
}

void SipAckRetransmitHandler::loggableName(SipAckRetransmitHandler *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E5148620(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *__p, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, char a20)
{
  if (v21)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v21);
  }

  if (v20)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v20);
  }

  if (a20 == 1)
  {
    if (a19)
    {
      (*(*a19 + 8))(a19);
    }
  }

  _Unwind_Resume(exception_object);
}

void SipAckRetransmitHandler::logPrefix(SipAckRetransmitHandler *this, ImsOutStream *a2)
{
  (*(*this + 72))(__p);
  (*(*a2 + 40))(a2, __p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), ": ", 2);
  *(a2 + 17) = 0;
  if (v4 < 0)
  {
    operator delete(__p[0]);
  }
}

void sub_1E5148780(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

uint64_t SipAckRetransmitHandler::initialize(uint64_t a1, uint64_t *a2, void *a3)
{
  v67 = *MEMORY[0x1E69E9840];
  v4 = *(a1 + 208);
  if (v4)
  {
    if ((*(*v4 + 24))(v4) == 5)
    {
      v7 = *(a1 + 200);
      if (v7)
      {
        v8 = std::__shared_weak_count::lock(v7);
        if (v8)
        {
          v9 = *(a1 + 192);
          if (v9)
          {
            v60 = 0;
            v61 = 0;
            SipSessionInterface::stack(v9, &v60);
            if (!v60)
            {
              v32 = (a1 + *(*a1 - 24));
              v33 = v32[5];
              if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
              {
                (*(*v32 + 16))(__p, v32);
                v50 = v57 >= 0 ? __p : __p[0];
                *buf = 141558275;
                v64 = 1752392040;
                v65 = 2081;
                v66 = v50;
                _os_log_error_impl(&dword_1E4C3F000, v33, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno sipstack", buf, 0x16u);
                if (v57 < 0)
                {
                  operator delete(__p[0]);
                }
              }

              goto LABEL_56;
            }

            v10 = *(v60 + 31);
            v11 = *(v60 + 32);
            if (v11)
            {
              atomic_fetch_add_explicit(&v11->__shared_owners_, 1uLL, memory_order_relaxed);
            }

            if (!v10)
            {
              v34 = (a1 + *(*a1 - 24));
              v35 = v34[5];
              if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
              {
                (*(*v34 + 16))(__p, v34);
                v51 = v57 >= 0 ? __p : __p[0];
                *buf = 141558275;
                v64 = 1752392040;
                v65 = 2081;
                v66 = v51;
                _os_log_error_impl(&dword_1E4C3F000, v35, OS_LOG_TYPE_ERROR, "#E %{private, mask.hash}sno sipstack", buf, 0x16u);
                if (v57 < 0)
                {
                  operator delete(__p[0]);
                }
              }

              goto LABEL_54;
            }

            if (*(SipUserAgent::config(v10) + 858) == 1)
            {
              v12 = v9[10].__vftable;
              shared_owners = v9[10].__shared_owners_;
              if (shared_owners)
              {
                atomic_fetch_add_explicit(&shared_owners->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              SipDialog::createRequestInDialog(v12, 0, __p);
              v14 = *__p;
              __p[0] = 0;
              __p[1] = 0;
              v15 = *(a1 + 232);
              *(a1 + 224) = v14;
              if (v15)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v15);
                if (__p[1])
                {
                  std::__shared_weak_count::__release_shared[abi:ne200100](__p[1]);
                }
              }

              if (!shared_owners)
              {
                goto LABEL_39;
              }

              v16 = shared_owners;
            }

            else
            {
              v36 = *(a1 + 208);
              v37 = *(v36 + 264);
              v38 = *(v36 + 272);
              if (v38)
              {
                atomic_fetch_add_explicit(&v38->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              v39 = *a2;
              v40 = a2[1];
              v59[0] = v39;
              v59[1] = v40;
              if (v40)
              {
                atomic_fetch_add_explicit(&v40->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              SipRequest::createMatchingAckForResponse(v37, v59, __p);
              v41 = *(a1 + 232);
              *(a1 + 224) = *__p;
              if (v41)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v41);
              }

              if (v40)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v40);
              }

              if (!v38)
              {
                goto LABEL_39;
              }

              v16 = v38;
            }

            std::__shared_weak_count::__release_shared[abi:ne200100](v16);
LABEL_39:
            if (*(a1 + 224))
            {
              if (*a3)
              {
                operator new();
              }

              v42 = *(a1 + 232);
              v54 = *(a1 + 224);
              v55 = v42;
              if (v42)
              {
                atomic_fetch_add_explicit(&v42->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              v43 = *(a1 + 216);
              v52 = *(a1 + 208);
              v53 = v43;
              if (v43)
              {
                atomic_fetch_add_explicit(&v43->__shared_owners_, 1uLL, memory_order_relaxed);
              }

              (v9->__vftable[2].__on_zero_shared)(__p, v9, &v54, &v52, 0);
              ImsLogContainer::logResult(a1 + 48, __p, v58);
              ImsResult::~ImsResult(v58);
              ImsResult::~ImsResult(__p);
              if (v53)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v53);
              }

              if (v55)
              {
                std::__shared_weak_count::__release_shared[abi:ne200100](v55);
              }

              __p[0] = 0;
              __p[1] = 0;
              ctu::SharedSynchronizable<SipSessionInterface>::weak_from_this(__p, (a1 + *(*a1 - 24) + 8));
              v44 = __p[1];
              if (__p[1])
              {
                atomic_fetch_add_explicit(__p[1] + 2, 1uLL, memory_order_relaxed);
                atomic_fetch_add_explicit(v44 + 2, 1uLL, memory_order_relaxed);
              }

              v62 = 0;
              operator new();
            }

            v46 = *(a1 + 48);
            v45 = a1 + 48;
            v47 = (*(v46 + 56))(v45);
            (*(*v45 + 16))(v45, v47);
            __p[0] = "couldn't create ACK";
            v48 = ImsOutStream::putStreamable<char const*&>(v47, __p);
            (*(*v48 + 64))(v48, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            v48[17] = 0;
LABEL_54:
            if (v11)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v11);
            }

LABEL_56:
            if (v61)
            {
              std::__shared_weak_count::__release_shared[abi:ne200100](v61);
            }

LABEL_58:
            std::__shared_weak_count::__release_shared[abi:ne200100](v8);
            result = 0;
            goto LABEL_59;
          }
        }
      }

      else
      {
        v8 = 0;
      }

      v30 = *(a1 + 48);
      v29 = a1 + 48;
      v31 = (*(v30 + 56))(v29);
      (*(*v29 + 16))(v29, v31);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v31 + 8), "no session specified", 20);
      *(v31 + 17) = 0;
      (*(*v31 + 64))(v31, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      result = 0;
      *(v31 + 17) = 0;
      if (!v8)
      {
        goto LABEL_59;
      }

      goto LABEL_58;
    }

    v24 = *(a1 + 48);
    v23 = (a1 + 48);
    v19 = (*(v24 + 56))(v23);
    (*(*v23 + 16))(v23, v19);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v19 + 8), "transaction is in state ", 24);
    *(v19 + 17) = 0;
    v25 = v23[20];
    v26 = (*(*v25 + 24))(v25);
    v27 = (*(*v25 + 16))(v25, v26);
    (*(*v19 + 32))(v19, v27);
    v20 = *(v19 + 8);
    v21 = ", not in TerminationPending state";
    v22 = 33;
  }

  else
  {
    v18 = *(a1 + 48);
    v17 = a1 + 48;
    v19 = (*(v18 + 56))(v17);
    (*(*v17 + 16))(v17, v19);
    v20 = *(v19 + 8);
    v21 = "no transaction specified";
    v22 = 24;
  }

  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v20, v21, v22);
  *(v19 + 17) = 0;
  (*(*v19 + 64))(v19, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  result = 0;
  *(v19 + 17) = 0;
LABEL_59:
  v49 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_1E5149050(_Unwind_Exception *a1)
{
  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }

  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  v7 = *(v5 - 136);
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  _Unwind_Resume(a1);
}

uint64_t SipAckRetransmitHandler::handleTimer(uint64_t a1, void *a2)
{
  result = operator==(a2, &SipTimers::kTimerAckRetransmitTimeout);
  if (result)
  {
    *(a1 + 408) = 1;
    result = *(a1 + 208);
    if (result)
    {
      v4 = *(*result + 32);

      return v4();
    }
  }

  return result;
}

uint64_t SipAckRetransmitHandler::retransmitAck(SipAckRetransmitHandler *this)
{
  v2 = *(this + 25);
  if (!v2)
  {
    return 0;
  }

  v3 = std::__shared_weak_count::lock(v2);
  if (!v3)
  {
    return 0;
  }

  v4 = v3;
  v5 = 0;
  if (*(this + 26))
  {
    v6 = *(this + 24);
    if (v6)
    {
      v7 = *(this + 29);
      v13 = *(this + 28);
      v14 = v7;
      if (v7)
      {
        atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
        v8 = *(this + 26);
      }

      v9 = *(this + 27);
      v12 = v9;
      if (v9)
      {
        atomic_fetch_add_explicit(&v9->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      (*(*v6 + 96))(v15);
      ImsLogContainer::logResult(this + 48, v15, v16);
      v10 = (*(*v17 + 24))(v17, v18);
      ImsResult::~ImsResult(v16);
      ImsResult::~ImsResult(v15);
      if (v12)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v12);
      }

      v5 = v10 ^ 1u;
      if (v14)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v14);
      }
    }
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  return v5;
}

void sub_1E51492FC(_Unwind_Exception *a1, uint64_t a2, std::__shared_weak_count *a3, uint64_t a4, std::__shared_weak_count *a5, ...)
{
  va_start(va1, a5);
  va_start(va, a5);
  v7 = va_arg(va1, void);
  v9 = va_arg(va1, void);
  v10 = va_arg(va1, void);
  v11 = va_arg(va1, void);
  v12 = va_arg(va1, void);
  v13 = va_arg(va1, void);
  v14 = va_arg(va1, void);
  v15 = va_arg(va1, void);
  v16 = va_arg(va1, void);
  v17 = va_arg(va1, void);
  v18 = va_arg(va1, void);
  ImsResult::~ImsResult(va1);
  ImsResult::~ImsResult(va);
  if (a3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a3);
  }

  if (a5)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a5);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  _Unwind_Resume(a1);
}

void *std::__shared_ptr_emplace<SipAckRetransmitHandler>::__shared_ptr_emplace[abi:ne200100]<SipAckRetransmitHandler::PrivateConstructorParam,std::shared_ptr<SipSessionInterface> &,std::shared_ptr<SipClientInviteTransaction> &,std::allocator<SipAckRetransmitHandler>,0>(void *a1, uint64_t a2, uint64_t *a3, uint64_t *a4)
{
  a1[1] = 0;
  a1[2] = 0;
  *a1 = &unk_1F5EF7798;
  std::construct_at[abi:ne200100]<SipAckRetransmitHandler,SipAckRetransmitHandler::PrivateConstructorParam,std::shared_ptr<SipSessionInterface> &,std::shared_ptr<SipClientInviteTransaction> &,SipAckRetransmitHandler*>((a1 + 3), a2, a3, a4);
  return a1;
}

void std::__shared_ptr_emplace<SipAckRetransmitHandler>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF7798;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t std::construct_at[abi:ne200100]<SipAckRetransmitHandler,SipAckRetransmitHandler::PrivateConstructorParam,std::shared_ptr<SipSessionInterface> &,std::shared_ptr<SipClientInviteTransaction> &,SipAckRetransmitHandler*>(uint64_t a1, uint64_t a2, uint64_t *a3, uint64_t *a4)
{
  v6 = *a3;
  v5 = a3[1];
  if (v5)
  {
    atomic_fetch_add_explicit(&v5->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v8 = *a4;
  v7 = a4[1];
  if (v7)
  {
    atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  std::string::basic_string[abi:ne200100]<0>(v29, "sip.session");
  v25 = *(v6 + 192);
  v26 = *(v6 + 200);
  if (*(v6 + 231) < 0)
  {
    std::string::__init_copy_ctor_external(&v27, *(v6 + 208), *(v6 + 216));
  }

  else
  {
    v27 = *(v6 + 208);
  }

  v28 = *(v6 + 232);
  ims::getQueue(&v32);
  ClientConfig::getLogTag(&v25, &__str);
  if ((v30 & 0x80u) == 0)
  {
    v9 = v29;
  }

  else
  {
    v9 = v29[0];
  }

  if ((v30 & 0x80u) == 0)
  {
    v10 = v30;
  }

  else
  {
    v10 = v29[1];
  }

  v11 = std::string::insert(&__str, 0, v9, v10);
  v12 = *&v11->__r_.__value_.__l.__data_;
  v22 = v11->__r_.__value_.__r.__words[2];
  *__p = v12;
  v11->__r_.__value_.__l.__size_ = 0;
  v11->__r_.__value_.__r.__words[2] = 0;
  v11->__r_.__value_.__r.__words[0] = 0;
  if (SHIBYTE(v22) >= 0)
  {
    v13 = __p;
  }

  else
  {
    v13 = __p[0];
  }

  *(a1 + 424) = 0;
  *(a1 + 432) = 0;
  v14 = v32;
  *(a1 + 440) = v32;
  if (v14)
  {
    dispatch_retain(v14);
  }

  *(a1 + 448) = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 456), "com.apple.ipTelephony", v13);
  if (SHIBYTE(v22) < 0)
  {
    operator delete(__p[0]);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  if (v14)
  {
    dispatch_release(v14);
  }

  *(a1 + 416) = &unk_1F5EC2BF8;
  if (SHIBYTE(v27.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v27.__r_.__value_.__l.__data_);
  }

  if (v30 < 0)
  {
    operator delete(v29[0]);
  }

  SipConnectionUser::SipConnectionUser(a1, off_1F5EF76A0);
  std::string::basic_string[abi:ne200100]<0>(&__str, "sip.session");
  std::__optional_destruct_base<ClientConfig const,false>::__optional_destruct_base[abi:ne200100]<ClientConfig const&>(__p, (v6 + 192));
  ImsLogContainer::ImsLogContainer(a1 + 48, &__str, __p);
  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  *a1 = &unk_1F5EF7580;
  *(a1 + 416) = &unk_1F5EF7680;
  *(a1 + 48) = &unk_1F5EF75E0;
  *(a1 + 184) = &unk_1F5EF7640;
  *(a1 + 192) = 0u;
  *(a1 + 208) = 0u;
  *(a1 + 224) = 0u;
  SipTimerContainer::SipTimerContainer((a1 + 240));
  *(a1 + 408) = 0;
  if (v5)
  {
    atomic_fetch_add_explicit(&v5->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  v15 = *(a1 + 200);
  *(a1 + 192) = v6;
  *(a1 + 200) = v5;
  if (v15)
  {
    std::__shared_weak_count::__release_weak(v15);
  }

  if (v7)
  {
    atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v16 = *(a1 + 216);
  *(a1 + 208) = v8;
  *(a1 + 216) = v7;
  if (v16)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
  }

  *(a1 + 368) = a1 + 184;
  std::string::basic_string[abi:ne200100]<0>(&__str, "sip.session");
  std::string::operator=((a1 + 288), &__str);
  v17 = *(v6 + 192);
  *(a1 + 320) = *(v6 + 200);
  *(a1 + 312) = v17;
  std::string::operator=((a1 + 328), (v6 + 208));
  *(a1 + 352) = *(v6 + 232);
  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  SipSessionInterface::stack(v6, &__str);
  v18 = *(__str.__r_.__value_.__r.__words[0] + 248);
  v19 = *(__str.__r_.__value_.__r.__words[0] + 256);
  if (v19)
  {
    atomic_fetch_add_explicit(&v19->__shared_owners_, 1uLL, memory_order_relaxed);
    *(a1 + 400) = SipUserAgent::config(v18) + 512;
    std::__shared_weak_count::__release_shared[abi:ne200100](v19);
  }

  else
  {
    *(a1 + 400) = SipUserAgent::config(v18) + 512;
  }

  if (__str.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](__str.__r_.__value_.__l.__size_);
  }

  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  if (v5)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v5);
  }

  return a1;
}

void sub_1E51498F0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, void *a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, uint64_t a19, uint64_t a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26, uint64_t a27, void *__p, uint64_t a29, int a30, __int16 a31, char a32, char a33)
{
  if (a33 < 0)
  {
    operator delete(__p);
    if (!v34)
    {
LABEL_3:
      if (!v33)
      {
        goto LABEL_5;
      }

      goto LABEL_4;
    }
  }

  else if (!v34)
  {
    goto LABEL_3;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v34);
  if (!v33)
  {
LABEL_5:
    _Unwind_Resume(exception_object);
  }

LABEL_4:
  std::__shared_weak_count::__release_shared[abi:ne200100](v33);
  goto LABEL_5;
}

void *std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF77E8;
  v2 = a1[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  return a1;
}

void std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::~__func(void *a1)
{
  *a1 = &unk_1F5EF77E8;
  v1 = a1[3];
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }

  JUMPOUT(0x1E69235B0);
}

uint64_t std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::__clone(uint64_t result, uint64_t a2)
{
  *a2 = &unk_1F5EF77E8;
  *(a2 + 8) = *(result + 8);
  v2 = *(result + 24);
  *(a2 + 24) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::destroy(uint64_t a1)
{
  v1 = *(a1 + 24);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::destroy_deallocate(void *__p)
{
  v2 = __p[3];
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  operator delete(__p);
}

void std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::operator()(void *a1, uint64_t a2)
{
  v3 = a1[3];
  if (v3)
  {
    v5 = a1[1];
    v6 = std::__shared_weak_count::lock(v3);
    if (v6)
    {
      v7 = v6;
      if (a1[2])
      {
        (*(*v5 + 56))(v5, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v7);
    }
  }
}

uint64_t std::__function::__func<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0,std::allocator<SipAckRetransmitHandler::initialize(std::shared_ptr<SipResponse const>,std::shared_ptr<SDPModel>)::$_0>,void ()(std::string &)>::target(uint64_t a1, uint64_t a2)
{
  {
    return a1 + 8;
  }

  else
  {
    return 0;
  }
}

void SDPOrigin::toStream(SDPOrigin *this, ImsOutStream *a2)
{
  v4 = *(a2 + 1);
  v9 = 111;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v4, &v9, 1);
  *(a2 + 17) = 0;
  v5 = *(a2 + 1);
  v10 = 61;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v5, &v10, 1);
  *(a2 + 17) = 0;
  (*(*a2 + 32))(a2, this + 72);
  v6 = *(a2 + 1);
  v11 = 32;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v6, &v11, 1);
  *(a2 + 17) = 0;
  MEMORY[0x1E69233B0](*(a2 + 1), *(this + 12));
  *(a2 + 17) = 0;
  v7 = *(a2 + 1);
  v12 = 32;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v7, &v12, 1);
  *(a2 + 17) = 0;
  MEMORY[0x1E69233B0](*(a2 + 1), *(this + 13));
  *(a2 + 17) = 0;
  v8 = *(a2 + 1);
  v13 = 32;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v8, &v13, 1);
  *(a2 + 17) = 0;
  SDPConnection::valueToStream((this + 16), a2);
}

BOOL SDPOrigin::valid(SDPOrigin *this)
{
  if (*(this + 8) != 1)
  {
    return 0;
  }

  if (*(this + 95) < 0)
  {
    if (!*(this + 10))
    {
      return 0;
    }
  }

  else if (!*(this + 95))
  {
    return 0;
  }

  if ((*(this + 63) & 0x8000000000000000) != 0)
  {
    if (!*(this + 6))
    {
      return 0;
    }
  }

  else if (!*(this + 63))
  {
    return 0;
  }

  if (*(this + 8))
  {
    return *(this + 7) != 0;
  }

  return 0;
}

void SipContactParam::clear(SipContactParam *this)
{
  SipUri::clear((this + 8));
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(this + 424, *(this + 54));
  *(this + 54) = 0;
  *(this + 55) = 0;
  *(this + 53) = this + 432;
  std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::destroy(this + 464, *(this + 59));
  *(this + 59) = 0;
  *(this + 60) = 0;
  *(this + 58) = this + 472;
}

void SipContactParam::setAdditionalFeatureTagsForService(uint64_t a1, void **a2, CFTypeRef cf)
{
  v12[0] = &unk_1F5EF3658;
  v12[1] = cf;
  if (cf)
  {
    CFRetain(cf);
  }

  v11[1] = 0;
  v12[0] = &unk_1F5EF3760;
  v10 = v11;
  v11[0] = 0;
  ims::CFDictionary::asStringMap(v12, &v10, &v7);
  v5 = (*(*v8 + 24))(v8, v9);
  ImsResult::~ImsResult(&v7);
  if ((v5 & 1) == 0)
  {
    v7 = a2;
    v6 = (std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 464, a2) + 56);
    if (v6 != &v10)
    {
      std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__assign_multi<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>(v6, v10, v11);
    }
  }

  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v10, v11[0]);
  ims::CFType::~CFType(v12);
}

void sub_1E514A044(_Unwind_Exception *a1)
{
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(v1 - 80, *(v1 - 72));
  ims::CFType::~CFType((v1 - 56));
  _Unwind_Resume(a1);
}

void SipContactParam::setAdditionalFeatureTags(SipContactParam *this, CFTypeRef cf)
{
  v10[0] = &unk_1F5EF3658;
  v10[1] = cf;
  if (cf)
  {
    CFRetain(cf);
  }

  v9 = 0;
  v10[0] = &unk_1F5EF3760;
  v7 = 0;
  v8 = 0;
  ims::CFDictionary::keysAsStrings(v10, &v7, 0x8000100);
  v3 = v7;
  for (i = v8; v3 != i; v3 += 3)
  {
    v5 = &unk_1F5EF3760;
    cfa = 0;
    if (ims::CFDictionary::getValue<ims::CFDictionary>(v10, v3, &v5))
    {
      SipContactParam::setAdditionalFeatureTagsForService(this, v3, cfa);
    }

    ims::CFType::~CFType(&v5);
  }

  v5 = &v7;
  std::vector<std::string>::__destroy_vector::operator()[abi:ne200100](&v5);
  ims::CFType::~CFType(v10);
}

void sub_1E514A188(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va2, a2);
  va_start(va1, a2);
  va_start(va, a2);
  va_arg(va1, void);
  v5 = va_arg(va1, void);
  va_copy(va2, va1);
  v6 = va_arg(va2, void);
  v8 = va_arg(va2, void);
  v9 = va_arg(va2, void);
  va_copy(v3, va1);
  std::vector<std::string>::__destroy_vector::operator()[abi:ne200100](va);
  ims::CFType::~CFType(va2);
  _Unwind_Resume(a1);
}

ImsOutStream *SipContactParam::toStream(SipContactParam *this, ImsOutStream *a2)
{
  v26 = 0u;
  v25 = 0u;
  v24 = &unk_1F5EBEF50;
  std::map<std::string,std::string>::map[abi:ne200100]<std::__map_const_iterator<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>>(&v25, *(this + 53), this + 54);
  BYTE9(v26) = 1;
  BYTE8(v26) = *(this + 448);
  v4 = *(this + 114);
  v22 = 0;
  v23 = 0;
  v5 = *(this + 62);
  if (v5)
  {
    v23 = std::__shared_weak_count::lock(v5);
    if (v23)
    {
      v22 = *(this + 61);
    }
  }

  BambiServices::addServiceParameters(v4, &v24, &v22);
  if (v23)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v23);
  }

  v19 = 0;
  v20 = 0;
  v21 = 0;
  BambiServices::nameArrayForServiceMask(*(this + 114), &v19);
  v6 = v19;
  v7 = v20;
  if (v19 != v20)
  {
    v8 = (this + 472);
    do
    {
      v9 = *v8;
      if (*v8)
      {
        v10 = (this + 472);
        do
        {
          v11 = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v9 + 4, v6);
          if ((v11 & 0x80u) == 0)
          {
            v10 = v9;
          }

          v9 = *&v9[(v11 >> 4) & 8];
        }

        while (v9);
        if (v10 != v8 && (std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v6, v10 + 4) & 0x80) == 0)
        {
          v12 = v10[7];
          v13 = (v10 + 8);
          if (v12 != v13)
          {
            do
            {
              v27 = (v12 + 32);
              v14 = std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(&v25, v12 + 4);
              std::string::operator=((v14 + 56), (v12 + 56));
              v15 = *(v12 + 1);
              if (v15)
              {
                do
                {
                  v16 = v15;
                  v15 = *v15;
                }

                while (v15);
              }

              else
              {
                do
                {
                  v16 = *(v12 + 2);
                  v17 = *v16 == v12;
                  v12 = v16;
                }

                while (!v17);
              }

              v12 = v16;
            }

            while (v16 != v13);
          }
        }
      }

      v6 += 3;
    }

    while (v6 != v7);
  }

  SipUri::toStream(this + 8, a2, 2 * (v26 == 0));
  v24[2](&v24, a2);
  v27 = &v19;
  std::vector<std::string>::__destroy_vector::operator()[abi:ne200100](&v27);
  v24 = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v25, *(&v25 + 1));
  return a2;
}

void sub_1E514A400(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, uint64_t a16, void *a17)
{
  if (a14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(v17 + 8, a17);
  _Unwind_Resume(a1);
}

void SipContactParam::logStr(SipContactParam *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E514A5A8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, char a11)
{
  if (a11 == 1)
  {
    if (a10)
    {
      (*(*a10 + 8))(a10);
    }
  }

  _Unwind_Resume(exception_object);
}

ImsOutStream *SipContactParamList::toStream(SipContactParamList *this, ImsOutStream *a2)
{
  v3 = *(this + 1);
  if (*(this + 2) != v3)
  {
    v5 = 0;
    v6 = 0;
    do
    {
      if (v6)
      {
        v7 = *(a2 + 1);
        v9 = 44;
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v7, &v9, 1);
        *(a2 + 17) = 0;
        v3 = *(this + 1);
      }

      (*(*(v3 + v5) + 16))(v3 + v5, a2);
      ++v6;
      v3 = *(this + 1);
      v5 += 504;
    }

    while (v6 < 0xEFBEFBEFBEFBEFBFLL * ((*(this + 2) - v3) >> 3));
  }

  return a2;
}

BOOL SipContactParamList::fromString(uint64_t a1, std::string *a2)
{
  v3 = 0;
  memset(&__str, 0, sizeof(__str));
  while (1)
  {
    v3 = ims::nextTokenQ(a2, v3, &__str, 0x2Cu);
    if (v3 == -1)
    {
      break;
    }

    v18 = 0u;
    v19 = 0u;
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    memset(v13, 0, sizeof(v13));
    v12 = &unk_1F5ED0580;
    SipUri::SipUri(v13);
    *(&v15 + 1) = 0;
    *&v16 = 0;
    *(&v14 + 1) = &unk_1F5EBEF50;
    *&v15 = &v15 + 8;
    WORD4(v16) = 256;
    v18 = 0uLL;
    *(&v17 + 1) = &v18;
    v19 = 0uLL;
    LODWORD(v17) = 0;
    UriHeaderParameterMarker = SipUriHeader::findUriHeaderParameterMarker(&__str);
    if (UriHeaderParameterMarker == -1)
    {
      if ((SipUri::fromString(v13, &__str) & 1) == 0)
      {
        goto LABEL_18;
      }
    }

    else
    {
      std::string::basic_string(&v21, &__str, 0, UriHeaderParameterMarker, v22);
      v5 = SipUri::fromString(v13, &v21);
      if (SHIBYTE(v21.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v21.__r_.__value_.__l.__data_);
      }

      if ((v5 & 1) == 0)
      {
        goto LABEL_18;
      }

      std::string::basic_string(&v21, &__str, UriHeaderParameterMarker + 1, 0xFFFFFFFFFFFFFFFFLL, v22);
      v7 = SipParameterMap::fromString(&v14 + 8, &v21, 0, 0);
      if (SHIBYTE(v21.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v21.__r_.__value_.__l.__data_);
      }

      if ((v7 & 1) == 0)
      {
LABEL_18:
        v12 = &unk_1F5ED0580;
        if (*(&v19 + 1))
        {
          std::__shared_weak_count::__release_weak(*(&v19 + 1));
        }

        std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::destroy(&v17 + 8, v18);
        *(&v14 + 1) = &unk_1F5EBEF50;
        std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v15, *(&v15 + 1));
        SipUri::~SipUri(v13);
        break;
      }

      LODWORD(v17) = BambiServices::serviceMaskFromParameters((&v14 + 8), v6);
    }

    v8 = *(a1 + 16);
    if (v8 >= *(a1 + 24))
    {
      v9 = std::vector<SipContactParam>::__emplace_back_slow_path<SipContactParam const&>(a1 + 8, &v12);
    }

    else
    {
      std::allocator_traits<std::allocator<SipContactParam>>::construct[abi:ne200100]<SipContactParam,SipContactParam const&,void,0>(a1 + 8, *(a1 + 16), &v12);
      v9 = v8 + 504;
      *(a1 + 16) = v8 + 504;
    }

    *(a1 + 16) = v9;
    v12 = &unk_1F5ED0580;
    if (*(&v19 + 1))
    {
      std::__shared_weak_count::__release_weak(*(&v19 + 1));
    }

    std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::destroy(&v17 + 8, v18);
    *(&v14 + 1) = &unk_1F5EBEF50;
    std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v15, *(&v15 + 1));
    SipUri::~SipUri(v13);
  }

  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  return v3 == -1;
}

void sub_1E514A984(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, ...)
{
  va_start(va, a4);
  *(v4 + 16) = v5;
  SipContactParam::~SipContactParam(va);
  if (*(v6 - 121) < 0)
  {
    operator delete(*(v6 - 144));
  }

  _Unwind_Resume(a1);
}

char *std::vector<SipContactParam>::__insert_with_size[abi:ne200100]<std::__wrap_iter<SipContactParam const*>,std::__wrap_iter<SipContactParam const*>>(uint64_t *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  v5 = a2;
  if (a5 < 1)
  {
    return v5;
  }

  v7 = a3;
  v10 = a1[1];
  v9 = a1[2];
  if ((0xEFBEFBEFBEFBEFBFLL * ((v9 - v10) >> 3)) < a5)
  {
    v11 = *a1;
    v12 = a5 - 0x1041041041041041 * ((v10 - *a1) >> 3);
    if (v12 > 0x82082082082082)
    {
      std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
    }

    v13 = a2 - v11;
    v14 = 0xEFBEFBEFBEFBEFBFLL * ((v9 - v11) >> 3);
    if (2 * v14 > v12)
    {
      v12 = 2 * v14;
    }

    if (v14 >= 0x41041041041041)
    {
      v15 = 0x82082082082082;
    }

    else
    {
      v15 = v12;
    }

    v38 = a1;
    if (v15)
    {
      std::__allocate_at_least[abi:ne200100]<std::allocator<SipContactParam>>(a1, v15);
    }

    v24 = 8 * (v13 >> 3);
    v35 = 0;
    v36 = v24;
    v37 = v24;
    v25 = 504 * a5;
    v26 = v24 + 504 * a5;
    do
    {
      std::allocator_traits<std::allocator<SipContactParam>>::construct[abi:ne200100]<SipContactParam,SipContactParam const&,void,0>(v38, v24, v7);
      v24 += 504;
      v7 += 504;
      v25 -= 504;
    }

    while (v25);
    *&v37 = v26;
    v27 = v36;
    std::__uninitialized_allocator_relocate[abi:ne200100]<std::allocator<SipContactParam>,SipContactParam*>(a1, v5, a1[1], v26);
    v28 = *a1;
    v29 = v36;
    *&v37 = v26 + a1[1] - v5;
    a1[1] = v5;
    v30 = v29 + v28 - v5;
    std::__uninitialized_allocator_relocate[abi:ne200100]<std::allocator<SipContactParam>,SipContactParam*>(a1, v28, v5, v30);
    v31 = *a1;
    *a1 = v30;
    v32 = a1[2];
    *(a1 + 1) = v37;
    *&v37 = v31;
    *(&v37 + 1) = v32;
    v35 = v31;
    v36 = v31;
    std::__split_buffer<SipContactParam>::~__split_buffer(&v35);
    return v27;
  }

  v16 = v10 - a2;
  if ((0xEFBEFBEFBEFBEFBFLL * ((v10 - a2) >> 3)) >= a5)
  {
    v23 = 504 * a5;
    std::vector<SipContactParam>::__move_range(a1, a2, a1[1], a2 + 504 * a5);
    v22 = v23 + v7;
    v21 = v7;
    goto LABEL_18;
  }

  v34 = v10 - a2;
  v18 = v16 + a3;
  v19 = a1[1];
  if (v16 + a3 != a4)
  {
    v20 = 0;
    v19 = a1[1];
    do
    {
      std::allocator_traits<std::allocator<SipContactParam>>::construct[abi:ne200100]<SipContactParam,SipContactParam const&,void,0>(a1, v10 + v20, v18 + v20);
      v19 += 504;
      v20 += 504;
    }

    while (v18 + v20 != a4);
  }

  a1[1] = v19;
  if (v34 >= 1)
  {
    std::vector<SipContactParam>::__move_range(a1, v5, v10, &v5[504 * a5]);
    v21 = v7;
    v22 = v18;
LABEL_18:
    std::__copy_impl::operator()[abi:ne200100]<SipContactParam const*,SipContactParam const*,SipContactParam*>(v21, v22, v5);
  }

  return v5;
}

void sub_1E514AC58(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  std::__split_buffer<SipContactParam>::~__split_buffer(va);
  _Unwind_Resume(a1);
}

void std::vector<SipContactParam>::__move_range(uint64_t a1, uint64_t a2, unint64_t a3, uint64_t a4)
{
  v6 = *(a1 + 8);
  v7 = a2 + v6 - a4;
  v8 = v6;
  if (v7 < a3)
  {
    v33 = a1;
    v10 = 0;
    v11 = v6 + a2 - a4 + 432;
    do
    {
      *(v6 + v10) = &unk_1F5ED0580;
      SipUri::SipUri((v6 + v10 + 8), (v7 + v10 + 8));
      *(v6 + v10 + 416) = &unk_1F5EBEF50;
      std::map<std::string,std::string>::map[abi:ne200100]<std::__map_const_iterator<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>>((v6 + v10 + 424), *(v7 + v10 + 424), (v11 + v10));
      v12 = v6 + v10;
      *(v12 + 449) = 1;
      v13 = (v7 + v10);
      *(v12 + 448) = *(v7 + v10 + 448);
      *(v12 + 456) = *(v7 + v10 + 456);
      *(v12 + 464) = *(v7 + v10 + 464);
      v14 = v6 + v10 + 472;
      v15 = *(v7 + v10 + 472);
      v16 = *(v7 + v10 + 480);
      *(v12 + 472) = v15;
      *(v12 + 480) = v16;
      if (v16)
      {
        *(v15 + 16) = v14;
        v13[58] = v13 + 59;
        v13[59] = 0;
        v13[60] = 0;
      }

      else
      {
        *(v12 + 464) = v14;
      }

      v17 = v6 + v10;
      v18 = v7 + v10;
      v19 = *(v7 + v10 + 496);
      *(v17 + 488) = *(v7 + v10 + 488);
      *(v17 + 496) = v19;
      *(v18 + 488) = 0;
      *(v18 + 496) = 0;
      v10 += 504;
    }

    while (v7 + v10 < a3);
    v8 = v6 + v10;
    a1 = v33;
  }

  *(a1 + 8) = v8;
  if (v6 != a4)
  {
    v20 = 0;
    v21 = a4 - v6;
    v22 = v6 + a2 - a4 - 72;
    do
    {
      v23 = v6 + v20;
      v24 = v7 + v20;
      SipUri::operator=((v6 + v20 - 496), v7 + v20 - 496);
      if (v7 != v6)
      {
        std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__assign_multi<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>((v23 - 80), *(v24 - 80), (v22 + v20));
      }

      v26 = *(v23 - 32);
      v25 = (v23 - 32);
      *(v25 - 24) = *(v24 - 56);
      *(v25 - 4) = *(v24 - 48);
      std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::destroy((v25 - 1), v26);
      *(v25 - 1) = *(v24 - 40);
      v27 = (v24 - 32);
      v28 = *(v24 - 32);
      v29 = *(v24 - 24);
      *v25 = v28;
      v25[1] = v29;
      if (v29)
      {
        *(v28 + 16) = v25;
        *(v24 - 40) = v27;
        *v27 = 0;
        *(v24 - 24) = 0;
      }

      else
      {
        *(v25 - 1) = v25;
      }

      v30 = v7 + v20;
      v31 = *(v7 + v20 - 16);
      *(v30 - 16) = 0;
      *(v30 - 8) = 0;
      v32 = *(v6 + v20 - 8);
      *(v6 + v20 - 16) = v31;
      if (v32)
      {
        std::__shared_weak_count::__release_weak(v32);
      }

      v20 -= 504;
    }

    while (v21 != v20);
  }
}

void std::__copy_impl::operator()[abi:ne200100]<SipContactParam const*,SipContactParam const*,SipContactParam*>(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a1 != a2)
  {
    v6 = 0;
    do
    {
      v7 = a3 + v6;
      v8 = a1 + v6;
      SipUri::operator=((a3 + v6 + 8), a1 + v6 + 8);
      if (a1 == a3)
      {
        *(v7 + 448) = *(v8 + 448);
        *(v7 + 456) = *(v8 + 456);
      }

      else
      {
        std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__assign_multi<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>((v7 + 424), *(v8 + 424), (v8 + 432));
        *(v7 + 448) = *(v8 + 448);
        *(v7 + 456) = *(v8 + 456);
        std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::__assign_multi<std::__tree_const_iterator<std::__value_type<std::string,std::map<std::string,std::string>>,std::__tree_node<std::__value_type<std::string,std::map<std::string,std::string>>,void *> *,long>>((v7 + 464), *(v8 + 464), (v8 + 472));
      }

      v10 = *(v8 + 488);
      v9 = *(v8 + 496);
      if (v9)
      {
        atomic_fetch_add_explicit((v9 + 16), 1uLL, memory_order_relaxed);
      }

      v11 = *(v7 + 496);
      *(v7 + 488) = v10;
      *(v7 + 496) = v9;
      if (v11)
      {
        std::__shared_weak_count::__release_weak(v11);
      }

      v6 += 504;
    }

    while (v8 + 504 != a2);
  }
}

uint64_t std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(uint64_t a1, void **a2)
{
  v7 = 0;
  v2 = *std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__find_equal<std::string>(a1, &v7, a2);
  if (!v2)
  {
    v4 = 0;
    v5 = 0;
    v6 = 0;
    std::__tree<std::__value_type<std::string,std::map<std::string,std::string>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::map<std::string,std::string>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::map<std::string,std::string>>>>::__construct_node<std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>();
  }

  return v2;
}

void std::__shared_ptr_emplace<anonymous namespace::MessageSipOptionsEventImpl>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF78B0;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void anonymous namespace::MessageSipOptionsEventImpl::~MessageSipOptionsEventImpl(xpc_object_t *this)
{
  *this = &unk_1F5EF7900;
  xpc_release(this[1]);
  this[1] = 0;
}

{
  *this = &unk_1F5EF7900;
  xpc_release(this[1]);
  this[1] = 0;

  JUMPOUT(0x1E69235B0);
}

xpc_object_t anonymous namespace::MessageSipOptionsEventImpl::getDict@<X0>(_anonymous_namespace_::MessageSipOptionsEventImpl *this@<X0>, void *a2@<X8>)
{
  v2 = *(this + 1);
  *a2 = v2;
  if (v2)
  {
    return xpc_retain(v2);
  }

  result = xpc_null_create();
  *a2 = result;
  return result;
}

_BYTE *anonymous namespace::sRegistrationStateNames(_anonymous_namespace_ *this)
{
  {
  }
}

_anonymous_namespace_ *operator<<(_anonymous_namespace_ *a1, unsigned int *a2)
{
  (*(*a1 + 40))(a1, &__p);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  return a1;
}

void sub_1E514BE98(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void SipRegistrationState::logStr(SipRegistrationState *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E514BF74(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, char a11)
{
  if (a11 == 1)
  {
    if (a10)
    {
      (*(*a10 + 8))(a10);
    }
  }

  _Unwind_Resume(exception_object);
}

_anonymous_namespace_ *SipRegistrationState::stateWithName(_anonymous_namespace_ *result, uint64_t a2)
{
  v3 = result;
  for (i = 0; ; ++i)
  {
    v6 = v5[23];
    if (v6 < 0)
    {
      v6 = *(v5 + 1);
    }

    if (!v6)
    {
      break;
    }

    v7 = *(a2 + 23);
    if (v7 >= 0)
    {
      v8 = *(a2 + 23);
    }

    else
    {
      v8 = *(a2 + 8);
    }

    v9 = v5[23];
    v10 = v9;
    if ((v9 & 0x80u) != 0)
    {
      v9 = *(v5 + 1);
    }

    if (v8 == v9)
    {
      v11 = v7 >= 0 ? a2 : *a2;
      v12 = *v5;
      result = memcmp(v11, v13, v8);
      if (!result)
      {
        goto LABEL_20;
      }
    }
  }

  i = 0;
LABEL_20:
  *v3 = i;
  return result;
}

uint64_t SipContact::SipContact(uint64_t a1, uint64_t a2)
{
  *a1 = &unk_1F5EF7968;
  *(a1 + 12) = 0;
  v4 = (a1 + 12);
  *(a1 + 28) = 0;
  *(a1 + 20) = 0;
  *(a1 + 36) = 0;
  SipUri::SipUri((a1 + 40));
  *(a1 + 480) = 0;
  *(a1 + 488) = 0;
  *(a1 + 464) = &unk_1F5EBEF50;
  *(a1 + 472) = a1 + 480;
  *(a1 + 496) = 256;
  *(a1 + 8) = 0;
  *(a1 + 448) = a2;
  if (v4 != &SipRegistrationState::kStateUnknown)
  {
    *v4 = 0;
  }

  *(a1 + 456) = -1;
  *(a1 + 504) = 0;
  return a1;
}

void sub_1E514C154(_Unwind_Exception *exception_object)
{
  if (*(v1 + 39) < 0)
  {
    operator delete(*(v1 + 16));
  }

  _Unwind_Resume(exception_object);
}

void SipContact::SipContact(SipContact *this, const SipContact *a2, SipRegistration *a3)
{
  *this = &unk_1F5EF7968;
  *(this + 12) = 0;
  v6 = (this + 12);
  *(this + 28) = 0;
  *(this + 20) = 0;
  *(this + 9) = 0;
  SipUri::SipUri((this + 40));
  *(this + 60) = 0;
  *(this + 61) = 0;
  *(this + 58) = &unk_1F5EBEF50;
  *(this + 59) = this + 480;
  *(this + 248) = 256;
  *(this + 56) = a3;
  SipUri::operator=((this + 40), a2 + 40);
  *(this + 2) = *(a2 + 2);
  if (this != a2)
  {
    *v6 = *(a2 + 3);
  }

  std::string::operator=((this + 16), (a2 + 16));
  *(this + 114) = *(a2 + 114);
  if (this != a2)
  {
    std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__assign_multi<std::__tree_const_iterator<std::__value_type<std::string,std::string>,std::__tree_node<std::__value_type<std::string,std::string>,void *> *,long>>(this + 59, *(a2 + 59), a2 + 60);
  }

  *(this + 496) = *(a2 + 496);
  *(this + 126) = *(a2 + 126);
}

void sub_1E514C284(_Unwind_Exception *exception_object)
{
  if (*(v1 + 39) < 0)
  {
    operator delete(*(v1 + 16));
  }

  _Unwind_Resume(exception_object);
}

ImsOutStream *SipContact::log(SipContact *this, ImsOutStream *a2)
{
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "  ", 2);
  *(a2 + 17) = 0;
  (*(*(this + 5) + 40))(this + 40, a2);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), " id=", 4);
  *(a2 + 17) = 0;
  MEMORY[0x1E6923350](*(a2 + 1), *(this + 2));
  *(a2 + 17) = 0;
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), " state=", 7);
  *(a2 + 17) = 0;
  operator<<(a2, this + 3);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), " expires=", 9);
  *(a2 + 17) = 0;
  MEMORY[0x1E6923350](*(a2 + 1), *(this + 114));
  *(a2 + 17) = 0;
  if (*(this + 61))
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), " params=", 8);
    *(a2 + 17) = 0;
    (*(*(this + 58) + 16))(this + 464, a2);
  }

  if (*(this + 126))
  {
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), " services=", 10);
    *(a2 + 17) = 0;
    v4 = *(this + 126);
    std::string::basic_string[abi:ne200100]<0>(&v6, ",");
    BambiServices::namesForServiceMask(v4, __p);
    (*(*a2 + 32))(a2, __p);
    if (v9 < 0)
    {
      operator delete(__p[0]);
    }

    if (v7 < 0)
    {
      operator delete(v6);
    }
  }

  return a2;
}

void sub_1E514C494(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, int a11, __int16 a12, char a13, char a14, void *__p, uint64_t a16, int a17, __int16 a18, char a19, char a20)
{
  if (a20 < 0)
  {
    operator delete(__p);
  }

  if (a14 < 0)
  {
    operator delete(a9);
  }

  _Unwind_Resume(exception_object);
}

std::string *SipContact::setAttribute(std::string *result, unsigned __int16 **a2, std::string *__str)
{
  v3 = result;
  if (*(a2 + 23) < 0)
  {
    v5 = a2[1];
    if (v5 != 2)
    {
      if (v5 != 5)
      {
        if (v5 != 7)
        {
          return result;
        }

        a2 = *a2;
LABEL_10:
        if (*a2 == 1768978533 && *(a2 + 3) == 1936028265)
        {
          if ((__str->__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
          {
            v7 = __str;
          }

          else
          {
            v7 = __str->__r_.__value_.__r.__words[0];
          }

          result = strtoul(v7, 0, 10);
          LODWORD(v3[19].__r_.__value_.__l.__data_) = result;
        }

        return result;
      }

      v11 = *a2;
      if (**a2 != 1952543859 || *(*a2 + 4) != 101)
      {
        v13 = *v11;
        v14 = *(v11 + 4);
        if (v13 != 1852143205 || v14 != 116)
        {
          return result;
        }

        goto LABEL_39;
      }

LABEL_42:
      result = SipRegistrationState::stateWithName(&v18, __str);
      HIDWORD(v3->__r_.__value_.__r.__words[1]) = v18;
      return result;
    }

    v10 = **a2;
  }

  else
  {
    v4 = *(a2 + 23);
    if (v4 != 2)
    {
      if (v4 != 5)
      {
        if (v4 != 7)
        {
          return result;
        }

        goto LABEL_10;
      }

      if (*a2 != 1952543859 || *(a2 + 4) != 101)
      {
        if (*a2 != 1852143205 || *(a2 + 4) != 116)
        {
          return result;
        }

LABEL_39:
        v16 = &result->__r_.__value_.__r.__words[2];

        return std::string::operator=(v16, __str);
      }

      goto LABEL_42;
    }

    v10 = *a2;
  }

  if (v10 == 25705)
  {
    if ((__str->__r_.__value_.__r.__words[2] & 0x8000000000000000) == 0)
    {
      v17 = __str;
    }

    else
    {
      v17 = __str->__r_.__value_.__r.__words[0];
    }

    result = strtoul(v17, 0, 10);
    LODWORD(v3->__r_.__value_.__r.__words[1]) = result;
  }

  return result;
}

void SipContact::parseChild(uint64_t a1, uint64_t a2, uint64_t *a3)
{
  if (*(a2 + 23) < 0)
  {
    v5 = *(a2 + 8);
    if (v5 != 3)
    {
      if (v5 != 13)
      {
LABEL_29:

        bambi::XmlParserItem::parseChild(a1, a2, a3);
        return;
      }

      v4 = *a2;
      goto LABEL_8;
    }

    if (**a2 != 29301 || *(*a2 + 2) != 105)
    {
      goto LABEL_29;
    }

LABEL_37:
    v13 = *(*a1 + 88);

    v13();
    return;
  }

  if (*(a2 + 23) == 3)
  {
    if (*a2 != 29301 || *(a2 + 2) != 105)
    {
      goto LABEL_29;
    }

    goto LABEL_37;
  }

  v4 = a2;
  if (*(a2 + 23) != 13)
  {
    goto LABEL_29;
  }

LABEL_8:
  v6 = *v4;
  v7 = *(v4 + 5);
  if (v6 != 0x2D6E776F6E6B6E75 || v7 != 0x6D617261702D6E77)
  {
    goto LABEL_29;
  }

  v16 = &unk_1F5EF7AD8;
  *v17 = 0u;
  *v18 = 0u;
  v19 = 0u;
  bambi::XmlParser::parseNode(&v16, a3, 0);
  v9 = HIBYTE(v18[0]);
  if (SHIBYTE(v18[0]) < 0)
  {
    v9 = v17[1];
  }

  if (v9)
  {
    ims::removeQuotes(v17, &__p);
    ims::removeQuotes(&v18[1], &__str);
    p_p = &__p;
    v10 = std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(a1 + 472, &__p.__r_.__value_.__l.__data_);
    std::string::operator=((v10 + 56), &__str);
    if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__str.__r_.__value_.__l.__data_);
    }

    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }
  }

  v16 = &unk_1F5EF7AD8;
  if (SHIBYTE(v19) < 0)
  {
    operator delete(v18[1]);
  }

  if (SHIBYTE(v18[0]) < 0)
  {
    operator delete(v17[0]);
  }
}

void sub_1E514C8BC(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *a10, uint64_t a11, int a12, __int16 a13, char a14, char a15, void *__p, uint64_t a17, int a18, __int16 a19, char a20, char a21, void *a22)
{
  if (a21 < 0)
  {
    operator delete(__p);
  }

  SipParamItem::~SipParamItem(&a22);
  _Unwind_Resume(a1);
}

void SipParamItem::setText(uint64_t a1, int a2, std::string *__str)
{
  std::string::operator=((a1 + 32), __str);

  ims::chomp((a1 + 32), "\r\n\t ", 3);
}

std::string *SipParamItem::setAttribute(std::string *result, uint64_t **a2, std::string *__str)
{
  v3 = *(a2 + 23);
  if (v3 < 0)
  {
    if (a2[1] != 4)
    {
      return result;
    }

    a2 = *a2;
  }

  else if (v3 != 4)
  {
    return result;
  }

  if (*a2 == 1701667182)
  {
    return std::string::operator=(&result->__r_.__value_.__r.__words[1], __str);
  }

  return result;
}

void SipParamItem::~SipParamItem(void **this)
{
  *this = &unk_1F5EF7AD8;
  if (*(this + 55) < 0)
  {
    operator delete(this[4]);
  }

  if (*(this + 31) < 0)
  {
    operator delete(this[1]);
  }
}

{
  *this = &unk_1F5EF7AD8;
  if (*(this + 55) < 0)
  {
    operator delete(this[4]);
  }

  if (*(this + 31) < 0)
  {
    operator delete(this[1]);
  }

  JUMPOUT(0x1E69235B0);
}

{
  *this = &unk_1F5EF7AD8;
  if (*(this + 55) < 0)
  {
    operator delete(this[4]);
  }

  if (*(this + 31) < 0)
  {
    operator delete(this[1]);
  }
}

void SipContact::parseCompleted(uint64_t a1, const SipParameterMap *a2)
{
  *(a1 + 504) = BambiServices::serviceMaskFromParameters((a1 + 464), a2);
  v3 = *(a1 + 448);
  if (v3)
  {
    v5 = v3[57];
    v4 = v3[58];
    if (v5 >= v4)
    {
      v7 = v3[56];
      v8 = (v5 - v7) >> 3;
      if ((v8 + 1) >> 61)
      {
        std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
      }

      v9 = v4 - v7;
      v10 = v9 >> 2;
      if (v9 >> 2 <= (v8 + 1))
      {
        v10 = v8 + 1;
      }

      if (v9 >= 0x7FFFFFFFFFFFFFF8)
      {
        v11 = 0x1FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v11 = v10;
      }

      if (v11)
      {
        std::__allocate_at_least[abi:ne200100]<std::allocator<SipConferenceEndpoint *>>(v11);
      }

      v12 = (8 * v8);
      *v12 = a1;
      v6 = 8 * v8 + 8;
      v13 = v3[56];
      v14 = v3[57] - v13;
      v15 = v12 - v14;
      memcpy(v12 - v14, v13, v14);
      v16 = v3[56];
      v3[56] = v15;
      v3[57] = v6;
      v3[58] = 0;
      if (v16)
      {
        operator delete(v16);
      }
    }

    else
    {
      *v5 = a1;
      v6 = (v5 + 1);
    }

    v3[57] = v6;
  }
}

void SipRegistration::SipRegistration(SipRegistration *this, const SipRegistration *a2, SipRegistrationInfo *a3, char a4)
{
  *this = &unk_1F5EF79D8;
  SipUri::SipUri((this + 8));
  *(this + 56) = 0;
  *(this + 57) = 0;
  *(this + 53) = 0;
  *(this + 54) = 0;
  *(this + 52) = 0;
  *(this + 110) = 0;
  *(this + 58) = 0;
  *(this + 59) = a3;
  SipUri::operator=((this + 8), a2 + 8);
  std::string::operator=((this + 416), (a2 + 416));
  if (this != a2)
  {
    *(this + 110) = *(a2 + 110);
  }

  v9 = *(a2 + 56);
  v8 = *(a2 + 57);
  if (v8 != v9)
  {
    v10 = 0;
    do
    {
      if (*(*(v9 + 8 * v10) + 12) == 2 || (a4 & 1) == 0)
      {
        operator new();
      }

      ++v10;
    }

    while (v10 < (v8 - v9) >> 3);
  }
}

void sub_1E514CC84(_Unwind_Exception *a1)
{
  v3 = *(v1 + 448);
  if (v3)
  {
    *(v1 + 456) = v3;
    operator delete(v3);
  }

  if (*(v1 + 439) < 0)
  {
    operator delete(*(v1 + 416));
  }

  SipUri::~SipUri((v1 + 8));
  _Unwind_Resume(a1);
}

void SipRegistration::~SipRegistration(SipRegistration *this)
{
  *this = &unk_1F5EF79D8;
  v4 = this + 448;
  v2 = *(this + 56);
  v3 = *(v4 + 1);
  if (v3 != v2)
  {
    v5 = 0;
    do
    {
      v6 = v2[v5];
      if (v6)
      {
        (*(*v6 + 8))(v2[v5]);
        v2 = *(this + 56);
        v3 = *(this + 57);
      }

      ++v5;
    }

    while (v5 < (v3 - v2) >> 3);
  }

  if (v2)
  {
    *(this + 57) = v2;
    operator delete(v2);
  }

  if (*(this + 439) < 0)
  {
    operator delete(*(this + 52));
  }

  SipUri::~SipUri((this + 8));
}

{
  SipRegistration::~SipRegistration(this);

  JUMPOUT(0x1E69235B0);
}

std::string *SipRegistration::setAttribute(std::string *result, unsigned __int16 *a2, std::string *__str)
{
  v3 = result;
  if ((*(a2 + 23) & 0x80000000) == 0)
  {
    v4 = *(a2 + 23);
    if (v4 != 2)
    {
      if (v4 != 3)
      {
        if (v4 != 5)
        {
          return result;
        }

LABEL_10:
        if (*a2 == 1952543859 && *(a2 + 4) == 101)
        {
          result = SipRegistrationState::stateWithName(&v12, __str);
          *(v3 + 440) = v12;
        }

        return result;
      }

      if (*a2 != 28513 || *(a2 + 2) != 114)
      {
        return result;
      }

LABEL_28:
      p_size = &result->__r_.__value_.__l.__size_;

      return SipUri::fromString(p_size, __str);
    }

    v8 = *a2;
LABEL_32:
    if (v8 == 25705)
    {
      v11 = (result + 416);

      return std::string::operator=(v11, __str);
    }

    return result;
  }

  v5 = *(a2 + 1);
  if (v5 == 2)
  {
    v8 = **a2;
    goto LABEL_32;
  }

  if (v5 != 3)
  {
    if (v5 != 5)
    {
      return result;
    }

    a2 = *a2;
    goto LABEL_10;
  }

  if (**a2 == 28513 && *(*a2 + 2) == 114)
  {
    goto LABEL_28;
  }

  return result;
}

uint64_t SipRegistration::createChild(uint64_t a1, uint64_t *a2)
{
  v2 = *(a2 + 23);
  if (v2 < 0)
  {
    if (a2[1] != 7)
    {
      return 0;
    }

    a2 = *a2;
  }

  else if (v2 != 7)
  {
    return 0;
  }

  if (*a2 == 1953394531 && *(a2 + 3) == 1952670068)
  {
    operator new();
  }

  return 0;
}

uint64_t SipRegistration::parseCompleted(uint64_t a1)
{
  result = *(a1 + 472);
  if (result)
  {
    return (*(*result + 96))(result, a1);
  }

  return result;
}

uint64_t SipRegistration::contactForParam(uint64_t a1, void **a2, uint64_t *a3)
{
  v3 = *(a1 + 448);
  v4 = *(a1 + 456);
  if (v3 == v4)
  {
    return 0;
  }

  while (1)
  {
    v7 = *v3;
    v8 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(*v3 + 472, a2);
    if (v7 + 480 == v8)
    {
      v9 = &ims::kEmptyString;
    }

    else
    {
      v9 = (v8 + 56);
    }

    v10 = *(v9 + 23);
    if (v10 >= 0)
    {
      v11 = *(v9 + 23);
    }

    else
    {
      v11 = *(v9 + 1);
    }

    v12 = *(a3 + 23);
    v13 = v12;
    if ((v12 & 0x80u) != 0)
    {
      v12 = a3[1];
    }

    if (v11 == v12)
    {
      v14 = v10 >= 0 ? v9 : *v9;
      v15 = *a3;
      v16 = v13 >= 0 ? a3 : *a3;
      if (!memcmp(v14, v16, v11))
      {
        break;
      }
    }

    if (++v3 == v4)
    {
      return 0;
    }
  }

  return v7;
}

void SipRegistrationInfo::SipRegistrationInfo(SipRegistrationInfo *this, const SipRegistrationInfo *a2)
{
  *this = &unk_1F5EF7A48;
  *(this + 2) = 0;
  *(this + 3) = 0;
  *(this + 4) = 0;
  *(this + 1) = *(a2 + 1);
  *(this + 5) = *(a2 + 5);
  if (*(a2 + 3) != *(a2 + 2))
  {
    operator new();
  }
}

void sub_1E514D1D0(_Unwind_Exception *a1)
{
  MEMORY[0x1E69235B0](v3, 0x10B3C40B0A97B0BLL);
  v5 = *v2;
  if (*v2)
  {
    *(v1 + 24) = v5;
    operator delete(v5);
  }

  _Unwind_Resume(a1);
}

void SipRegistrationInfo::~SipRegistrationInfo(SipRegistrationInfo *this)
{
  *this = &unk_1F5EF7A48;
  v4 = this + 16;
  v2 = *(this + 2);
  v3 = *(v4 + 1);
  if (v3 != v2)
  {
    v5 = 0;
    do
    {
      v6 = v2[v5];
      if (v6)
      {
        (*(*v6 + 8))(v2[v5]);
        v2 = *(this + 2);
        v3 = *(this + 3);
      }

      ++v5;
    }

    while (v5 < (v3 - v2) >> 3);
  }

  if (v2)
  {
    *(this + 3) = v2;
    operator delete(v2);
  }
}

{
  SipRegistrationInfo::~SipRegistrationInfo(this);

  JUMPOUT(0x1E69235B0);
}

unint64_t SipRegistrationInfo::setAttribute(unint64_t result, uint64_t *a2, const char *a3)
{
  v3 = result;
  if ((*(a2 + 23) & 0x80000000) == 0)
  {
    v4 = *(a2 + 23);
    if (v4 != 5)
    {
      if (v4 != 7)
      {
        return result;
      }

      if (*a2 != 1936876918 || *(a2 + 3) != 1852795251)
      {
        return result;
      }

LABEL_17:
      if (a3[23] >= 0)
      {
        v8 = a3;
      }

      else
      {
        v8 = *a3;
      }

      result = strtoul(v8, 0, 10);
      *(v3 + 12) = result;
      return result;
    }

LABEL_22:
    if (*a2 != 1952543859 || *(a2 + 4) != 101)
    {
      return result;
    }

    v10 = a3[23];
    if (v10 < 0)
    {
      if (*(a3 + 1) != 4)
      {
        goto LABEL_33;
      }

      a3 = *a3;
    }

    else if (v10 != 4)
    {
      goto LABEL_33;
    }

    if (*a3 == 1819047270)
    {
      v11 = 1;
      goto LABEL_34;
    }

LABEL_33:
    v11 = 2;
LABEL_34:
    *(result + 8) = v11;
    return result;
  }

  v6 = a2[1];
  if (v6 == 5)
  {
    a2 = *a2;
    goto LABEL_22;
  }

  if (v6 == 7 && **a2 == 1936876918 && *(*a2 + 3) == 1852795251)
  {
    goto LABEL_17;
  }

  return result;
}

uint64_t SipRegistrationInfo::createChild(uint64_t a1, uint64_t *a2)
{
  v2 = *(a2 + 23);
  if (v2 < 0)
  {
    if (a2[1] != 12)
    {
      return 0;
    }

    a2 = *a2;
  }

  else if (v2 != 12)
  {
    return 0;
  }

  if (*a2 == 0x6172747369676572 && *(a2 + 2) == 1852795252)
  {
    operator new();
  }

  return 0;
}

void SipContact::logStr(SipContact *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E514D5F4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, char a11)
{
  if (a11 == 1)
  {
    if (a10)
    {
      (*(*a10 + 8))(a10);
    }
  }

  _Unwind_Resume(exception_object);
}

_BYTE *ctu::NeverDestroyed<std::array<std::string,6ul>>::NeverDestroyed<char const(&)[8],char const(&)[5],char const(&)[7],char const(&)[11],char const(&)[6],char const(&)[1]>(_BYTE *a1, char *a2, char *a3, char *a4, char *a5, char *a6, char *a7)
{
  v13 = std::string::basic_string[abi:ne200100]<0>(a1, a2);
  std::string::basic_string[abi:ne200100]<0>(v13 + 24, a3);
  std::string::basic_string[abi:ne200100]<0>(a1 + 48, a4);
  std::string::basic_string[abi:ne200100]<0>(a1 + 72, a5);
  std::string::basic_string[abi:ne200100]<0>(a1 + 96, a6);
  std::string::basic_string[abi:ne200100]<0>(a1 + 120, a7);
  return a1;
}

void sub_1E514D7B4(_Unwind_Exception *exception_object)
{
  while (1)
  {
    v4 = *(v2 - 1);
    v2 -= 3;
    if (v4 < 0)
    {
      operator delete(*v2);
    }

    if (v2 == v1)
    {
      _Unwind_Resume(exception_object);
    }
  }
}

void SipEventPackage::~SipEventPackage(SipEventPackage *this)
{
  *this = &unk_1F5EF7B90;
  v2 = *(this + 1);
  if (v2)
  {
    (*(*v2 + 8))(v2);
  }

  v3 = *(this + 3);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }
}

void SipEventPackage::terminateWithoutUnsubscribing(SipEventPackage *this)
{
  v2 = *(this + 3);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 2);
      if (v5)
      {
        SipSubscription::terminateWithoutUnsubscribing(v5);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

std::string *SipEventPackage::setSubscriptionParameter(uint64_t a1, void **a2, const std::string *a3)
{
  v4 = *(a1 + 8);
  if (!v4)
  {
    operator new();
  }

  v5 = std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(v4 + 8, a2);
  return std::string::operator=((v5 + 56), a3);
}

void Sip3gppImsInfoBody::Sip3gppImsInfoBody(Sip3gppImsInfoBody *this, const Sip3gppImsInfoBody *a2)
{
  v3 = SipXmlBody::SipXmlBody(this, a2);
  *v3 = &unk_1F5ED5B18;
  Sip3gppImsInfo::Sip3gppImsInfo((v3 + 4), (a2 + 32));
}

void sub_1E514DA3C(_Unwind_Exception *exception_object)
{
  *v1 = &unk_1F5ED9B90;
  if (*(v1 + 31) < 0)
  {
    operator delete(*(v1 + 8));
  }

  _Unwind_Resume(exception_object);
}

uint64_t _GLOBAL__sub_I_Sip3gppImsInfoBody_cpp()
{
  std::string::basic_string[abi:ne200100]<0>(Sip3gppImsInfoBody::kContentType, "application/3gpp-ims+xml");
  v0 = MEMORY[0x1E69E52C0];

  return __cxa_atexit(v0, Sip3gppImsInfoBody::kContentType, &dword_1E4C3F000);
}

void BambiCallDelegate::handleEvent(BambiCallDelegate *this, std::__shared_weak_count **lpsrc)
{
  switch(*(lpsrc + 2))
  {
    case 0:
      return;
    case 1:
      v4 = *(*this + 24);

      goto LABEL_94;
    case 2:
      v14 = (*lpsrc)->__vftable;
      if (!v15)
      {
        return;
      }

      v7 = v15;
      v8 = *(*this + 40);
      v9 = this;

      goto LABEL_90;
    case 4:
      v22 = (*lpsrc)->__vftable;
      if (!v23)
      {
        return;
      }

      v7 = v23;
      v8 = *(*this + 48);
      v9 = this;

      goto LABEL_90;
    case 5:
      v10 = *(*this + 56);
      goto LABEL_45;
    case 6:
      v10 = *(*this + 56);
LABEL_45:

      goto LABEL_35;
    case 8:
      v24 = (*lpsrc)->__vftable;
      if (!v25)
      {
        return;
      }

      v7 = v25;
      v8 = *(*this + 72);
      v9 = this;

      goto LABEL_90;
    case 9:
      v26 = (*lpsrc)->__vftable;
      if (!v27)
      {
        return;
      }

      v7 = v27;
      v8 = *(*this + 80);
      v9 = this;

      goto LABEL_90;
    case 0xA:
      v4 = *(*this + 104);

      goto LABEL_94;
    case 0xB:
      v4 = *(*this + 112);

      goto LABEL_94;
    case 0xC:
      v11 = lpsrc[3];
      if (v11)
      {
        v12 = lpsrc[2];
        atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        v13 = std::__shared_weak_count::lock(v11);
        std::__shared_weak_count::__release_weak(v11);
        if (v13)
        {
          if (v12 && (v12[20].__vftable & 0xFFFFFFFE) == 2)
          {
            (*(*this + 120))(this, lpsrc);
          }

          std::__shared_weak_count::__release_shared[abi:ne200100](v13);
        }
      }

      return;
    case 0xE:
      v20 = (*lpsrc)->__vftable;
      if (!v21)
      {
        return;
      }

      v7 = v21;
      v8 = *(*this + 88);
      v9 = this;

      goto LABEL_90;
    case 0xF:
      v16 = (*lpsrc)->__vftable;
      if (!v17)
      {
        return;
      }

      v7 = v17;
      v8 = *(*this + 96);
      v9 = this;

      goto LABEL_90;
    case 0x10:
      v4 = *(*this + 144);

      goto LABEL_94;
    case 0x11:
      v4 = *(*this + 152);

      goto LABEL_94;
    case 0x12:
      v28 = (*lpsrc)->__vftable;
      if (!v29)
      {
        return;
      }

      v7 = v29;
      v8 = *(*this + 176);
      v9 = this;

      goto LABEL_90;
    case 0x13:
      v32 = (*lpsrc)->__vftable;
      if (!v33)
      {
        return;
      }

      v7 = v33;
      v8 = *(*this + 184);
      v9 = this;

      goto LABEL_90;
    case 0x14:
      v30 = (*lpsrc)->__vftable;
      if (!v31)
      {
        return;
      }

      v7 = v31;
      v8 = *(*this + 128);
      v9 = this;

      goto LABEL_90;
    case 0x15:
      v5 = (*lpsrc)->__vftable;
      if (!v6)
      {
        return;
      }

      v7 = v6;
      v8 = *(*this + 136);
      v9 = this;

      goto LABEL_90;
    case 0x17:
      v18 = (*lpsrc)->__vftable;
      if (!v19)
      {
        return;
      }

      v7 = v19;
      v8 = *(*this + 32);
      v9 = this;

LABEL_90:
      v8(v9, v7);
      return;
    case 0x18:
      v4 = *(*this + 264);

      goto LABEL_94;
    case 0x19:
      v10 = *(*this + 272);
      goto LABEL_33;
    case 0x1A:
      v10 = *(*this + 272);
LABEL_33:

LABEL_35:
      v10();
      return;
    case 0x1D:
      v4 = *(*this + 64);

      goto LABEL_94;
    case 0x1E:
      v4 = *(*this + 160);

      goto LABEL_94;
    case 0x1F:
      v4 = *(*this + 168);

      goto LABEL_94;
    default:
      v4 = *(*this + 280);

LABEL_94:
      v4();
      return;
  }
}

void SipTransportInterface::~SipTransportInterface(SipTransportInterface *this)
{
  *this = &unk_1F5EF7D48;
  *(this + 1) = &unk_1F5EF7DB8;
  if (*(this + 183) < 0)
  {
    operator delete(*(this + 20));
  }

  *(this + 1) = &unk_1F5ED7318;
  if (*(this + 88) == 1 && *(this + 79) < 0)
  {
    operator delete(*(this + 7));
  }

  if (*(this + 39) < 0)
  {
    operator delete(*(this + 2));
  }
}

void SipDigestAuthResponse::SipDigestAuthResponse(SipDigestAuthResponse *this, SipStandardDigestAuthScheme *a2)
{
  *(this + 40) = 0u;
  *(this + 24) = 0u;
  *(this + 8) = 0u;
  *this = &unk_1F5EF7E50;
  *(this + 7) = 0u;
  *(this + 8) = 0u;
  *(this + 9) = 0u;
  *(this + 9) = &unk_1F5EBDEF8;
  *(this + 10) = &_bambiDomain;
  *(this + 22) = 0;
  *(this + 12) = 0;
  *(this + 13) = 0;
  if (!a2)
  {
    operator new();
  }

  *(this + 8) = a2;
}

void sub_1E514E82C(_Unwind_Exception *a1)
{
  ImsResult::~ImsResult(v2);
  SipAuthResponse::~SipAuthResponse(v1);
  _Unwind_Resume(a1);
}

void SipDigestAuthResponse::SipDigestAuthResponse(SipDigestAuthResponse *this, const SipDigestAuthChallenge *a2)
{
  SipAuthResponse::SipAuthResponse(this, a2);
  *v4 = &unk_1F5EF7E50;
  *(v4 + 128) = 0u;
  *(v4 + 144) = 0u;
  *(v4 + 112) = 0u;
  *(v4 + 72) = &unk_1F5EBDEF8;
  *(v4 + 80) = &_bambiDomain;
  *(v4 + 88) = 0;
  *(v4 + 96) = 0;
  *(v4 + 104) = 0;
  v5 = (*(*a2 + 32))(a2);
  *(this + 8) = (*(*v5 + 32))(v5);
}

void sub_1E514E924(_Unwind_Exception *a1)
{
  ImsResult::~ImsResult(v2);
  SipAuthResponse::~SipAuthResponse(v1);
  _Unwind_Resume(a1);
}

void SipDigestAuthResponse::~SipDigestAuthResponse(SipDigestAuthResponse *this)
{
  *this = &unk_1F5EF7E50;
  v2 = *(this + 8);
  if (v2)
  {
    (*(*v2 + 24))(v2);
  }

  ImsResult::~ImsResult((this + 72));

  SipAuthResponse::~SipAuthResponse(this);
}

{
  SipDigestAuthResponse::~SipDigestAuthResponse(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t SipDigestAuthResponse::scheme(SipDigestAuthResponse *this)
{
  return *(this + 8);
}

{
  return *(this + 8);
}

uint64_t SipDigestAuthResponse::computeResponse(uint64_t a1, uint64_t *a2)
{
  v2 = *(a1 + 64);
  v3 = a2[1];
  v6 = *a2;
  v7 = v3;
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  v4 = (*(*v2 + 136))(v2, &v6);
  if (v7)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v7);
  }

  return v4;
}

void sub_1E514EA8C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t mavims::tlv::writeField(uint64_t a1, uint64_t a2)
{
  *a1 = *a2;
  *(a1 + 1) = *(a2 + 1);
  *(a1 + 2) = *(a2 + 2);
  *(a1 + 3) = *(a2 + 4);
  *(a1 + 5) = *(a2 + 6);
  *(a1 + 6) = *(a2 + 7);
  *(a1 + 7) = *(a2 + 8);
  *(a1 + 8) = *(a2 + 12);
  v3 = a1 + 10;
  memcpy((a1 + 10), *(a2 + 16), *(a2 + 24) - *(a2 + 16));
  return v3 + *(a2 + 24) - *(a2 + 16);
}

void *tlv::writeV<mavims::tlv::IncomingCallInfo>(_BYTE **a1, uint64_t a2)
{
  v4 = *a1;
  *v4 = *a2;
  v4[1] = *(a2 + 4);
  v4[2] = *(a2 + 8);
  v4[3] = *(a2 + 12);
  v4[4] = *(a2 + 16);
  v4[5] = *(a2 + 20);
  v5 = v4 + 7;
  v4[6] = *(a2 + 24);
  result = memcpy(v4 + 7, *(a2 + 32), *(a2 + 40) - *(a2 + 32));
  *a1 = &v5[*(a2 + 40) - *(a2 + 32)];
  return result;
}

uint64_t tlv::parseV<mavims::tlv::IncomingCallBasebandCallId>(tlv **a1, int a2)
{
  v3 = *a1;
  tlv::throwIfNotEnoughBytes(*a1, *a1 + a2, 1);
  result = *v3;
  *a1 = (v3 + 1);
  return result;
}

void sub_1E514ED3C(void *a1)
{
  __cxa_begin_catch(a1);
  *v1 = 0;
  __cxa_end_catch();
  JUMPOUT(0x1E514ED30);
}

uint64_t SipDialogEventPackage::SipDialogEventPackage(uint64_t a1, uint64_t *a2)
{
  *(a1 + 8) = 0;
  *(a1 + 16) = 0;
  *(a1 + 24) = 0;
  *(a1 + 32) = 0;
  *a1 = &unk_1F5EF7ED0;
  *(a1 + 40) = 0;
  v3 = *a2;
  v4 = a2[1];
  if (v4)
  {
    atomic_fetch_add_explicit((v4 + 16), 1uLL, memory_order_relaxed);
    v5 = *(a1 + 40);
    *(a1 + 32) = v3;
    *(a1 + 40) = v4;
    if (v5)
    {
      std::__shared_weak_count::__release_weak(v5);
    }
  }

  else
  {
    *(a1 + 32) = v3;
    *(a1 + 40) = 0;
  }

  *(a1 + 48) = 600000;
  return a1;
}

uint64_t SipDialogEventPackage::handleNotification(uint64_t a1, uint64_t *a2)
{
  v4 = SipMessage::bodyWithContentType(*a2, &SipDialogInfoBody::kContentType);
  {
    v7 = v6;
    v30[0] = 0;
    v30[1] = 0;
    v31 = 0;
    (*(*v6 + 56))(v6, v30);
    std::string::basic_string[abi:ne200100]<0>(&v25, "sip.dialog-event");
    v21[0] = 0;
    v24 = 0;
    v8 = ims::debug(&v25, v21);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 1), "handleNotification", 18);
    v8[17] = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 1), " : content type = ", 18);
    v8[17] = 0;
    v9 = (*(*v7 + 40))(v7);
    LoggableString::LoggableString(&__p, v9);
    (*(*v8 + 40))(v8, &__p);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 1), ", content = \n", 13);
    v8[17] = 0;
    (*(*v8 + 32))(v8, v30);
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v8[17] = 0;
    if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(__p.__r_.__value_.__l.__data_);
    }

    if (v24 == 1 && v23 < 0)
    {
      operator delete(v22);
    }

    if (SHIBYTE(v25.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v25.__r_.__value_.__l.__data_);
    }

    v10 = *(a1 + 40);
    if (v10 && (v11 = std::__shared_weak_count::lock(v10)) != 0)
    {
      v12 = v11;
      v13 = *(a1 + 32);
      if (v13)
      {
        LOBYTE(v7) = SipDialogEventClient::handleNotification(v13, v7);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v12);
      v18 = (v13 != 0) & v7;
    }

    else
    {
      v18 = 0;
    }

    if (SHIBYTE(v31) < 0)
    {
      operator delete(v30[0]);
    }
  }

  else
  {
    v14 = std::string::basic_string[abi:ne200100]<0>(v30, "sip.dialog-event");
    v26[0] = 0;
    v29 = 0;
    v15 = ims::debug(v14, v26);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "Received empty dialog events notification of type ", 50);
    *(v15 + 17) = 0;
    v16 = *(*a2 + 112);
    if (v16)
    {
      v17 = (*(*v16 + 40))(v16);
    }

    else
    {
      v17 = &SipBody::kGenericContentType;
    }

    LoggableString::LoggableString(&v25, v17);
    (*(*v15 + 40))(v15, &v25);
    (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v15 + 17) = 0;
    if (SHIBYTE(v25.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v25.__r_.__value_.__l.__data_);
    }

    if (v29 == 1 && v28 < 0)
    {
      operator delete(v27);
    }

    if (SHIBYTE(v31) < 0)
    {
      operator delete(v30[0]);
    }

    return 0;
  }

  return v18;
}

void sub_1E514F198(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *a10, uint64_t a11, int a12, __int16 a13, char a14, char a15, uint64_t a16, uint64_t a17, void *__p, uint64_t a19, int a20, __int16 a21, char a22, char a23, uint64_t a24, char a25, void *a26, uint64_t a27, int a28, __int16 a29, char a30, char a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, int a36, __int16 a37, char a38, char a39, uint64_t a40, char a41)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v41);
  if (*(v42 - 33) < 0)
  {
    operator delete(*(v42 - 56));
  }

  _Unwind_Resume(a1);
}

void SipDialogEventPackage::handleSubscriptionFailed(SipDialogEventPackage *this, ImsResult *a2)
{
  v3 = *(this + 5);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(this + 4);
      if (v7)
      {
        SipDialogEventClient::dialogEventSubscriptionFailed(v7, this, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void SipDialogEventPackage::handleSubscriptionTerminated(SipDialogEventPackage *this)
{
  v2 = *(this + 5);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 4);
      if (v5)
      {
        SipDialogEventClient::dialogEventSubscriptionTerminated(v5, this);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

std::__split_buffer<std::string>::pointer SipDialogEventPackage::acceptedContentTypes(uint64_t a1, uint64_t a2)
{
  if (a2)
  {
    return std::vector<std::string>::push_back[abi:ne200100](a2, &SipDialogEventPackage::kContentType);
  }

  return result;
}

unint64_t SipDialogEventPackage::subscribe(SipDialogEventPackage *this, int a2)
{
  if (a2)
  {
    *(this + 12) = a2;
  }

  v3 = *(this + 3);
  if (v3)
  {
    v4 = std::__shared_weak_count::lock(v3);
    if (v4)
    {
      v5 = *(this + 2);
      if (v5)
      {
        if (SipSubscription::subscribeWithExpiration(v5, *(this + 12)))
        {
          v6 = 1;
LABEL_31:
          std::__shared_weak_count::__release_shared[abi:ne200100](v4);
          return v6;
        }
      }
    }
  }

  else
  {
    v4 = 0;
  }

  v7 = *(this + 5);
  if (!v7 || (v8 = std::__shared_weak_count::lock(v7)) == 0)
  {
    v6 = 0;
    goto LABEL_30;
  }

  v9 = v8;
  v10 = *(this + 4);
  if (!v10 || (v11 = *(v10 + 200)) == 0)
  {
    v6 = 0;
LABEL_29:
    std::__shared_weak_count::__release_shared[abi:ne200100](v9);
    goto LABEL_30;
  }

  v12 = *(v10 + 192);
  atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  v6 = std::__shared_weak_count::lock(v11);
  std::__shared_weak_count::__release_weak(v11);
  if (!v6)
  {
    goto LABEL_29;
  }

  if (v12)
  {
    v14 = *(v12 + 248);
    v13 = *(v12 + 256);
    if (v13)
    {
      atomic_fetch_add_explicit(&v13->__shared_owners_, 1uLL, memory_order_relaxed);
    }

    if (v14)
    {
      SipUserAgent::publicUri(v14);
      v15 = *(v14 + 31);
      v16 = *(v14 + 32);
      if (v16)
      {
        atomic_fetch_add_explicit(&v16->__shared_owners_, 1uLL, memory_order_relaxed);
      }

      SipDialogManager::subscribeToEventPackage(v15, this, &v19);
      v12 = v19;
      v17 = v20;
      v19 = 0;
      v20 = 0;
      if (v16)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v16);
      }
    }

    else
    {
      v17 = 0;
      v12 = 0;
    }

    if (v13)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v13);
    }
  }

  else
  {
    v17 = 0;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  v6 = v12 != 0;
  std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  v9 = v17;
  if (v17)
  {
    goto LABEL_29;
  }

LABEL_30:
  if (v4)
  {
    goto LABEL_31;
  }

  return v6;
}

void sub_1E514F540(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
    if (!v19)
    {
LABEL_3:
      if (!v18)
      {
        goto LABEL_5;
      }

      goto LABEL_4;
    }
  }

  else if (!v19)
  {
    goto LABEL_3;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v19);
  if (!v18)
  {
LABEL_5:
    std::__shared_weak_count::__release_shared[abi:ne200100](v17);
    std::__shared_weak_count::__release_shared[abi:ne200100](v16);
    if (v15)
    {
      std::__shared_weak_count::__release_shared[abi:ne200100](v15);
    }

    _Unwind_Resume(a1);
  }

LABEL_4:
  std::__shared_weak_count::__release_shared[abi:ne200100](v18);
  goto LABEL_5;
}

void SipDialogEventPackage::unsubscribe(SipDialogEventPackage *this)
{
  v2 = *(this + 3);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 2);
      if (v5)
      {
        SipSubscription::unsubscribe(v5);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void SipDialogEventPackage::~SipDialogEventPackage(SipDialogEventPackage *this)
{
  *this = &unk_1F5EF7ED0;
  v2 = *(this + 5);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  SipEventPackage::~SipEventPackage(this);
}

{
  *this = &unk_1F5EF7ED0;
  v2 = *(this + 5);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  SipEventPackage::~SipEventPackage(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t _GLOBAL__sub_I_SipDialogEventPackage_cpp()
{
  std::string::basic_string[abi:ne200100]<0>(&SipDialogEventPackage::kContentType, "application/dialog-info+xml");
  v0 = MEMORY[0x1E69E52C0];

  return __cxa_atexit(v0, &SipDialogEventPackage::kContentType, &dword_1E4C3F000);
}

void sub_1E514FC24(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, void *a9, uint64_t a10, int a11, __int16 a12, char a13, char a14, uint64_t a15, void *a16, uint64_t a17, int a18, __int16 a19, char a20, char a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, void *__p, uint64_t a28, int a29, __int16 a30, char a31, char a32)
{
  if (a32 < 0)
  {
    operator delete(__p);
  }

  if (v33)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v33);
  }

  xpc::dict::~dict(v34);
  if (a14 < 0)
  {
    operator delete(a9);
  }

  if (a21 < 0)
  {
    operator delete(a16);
  }

  if (v33)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v33);
  }

  std::__shared_weak_count::~__shared_weak_count(v32);
  operator delete(v36);
  _Unwind_Resume(a1);
}

void std::__shared_ptr_emplace<anonymous namespace::LazuliReferEventImpl>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF7F48;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void anonymous namespace::LazuliReferEventImpl::~LazuliReferEventImpl(xpc_object_t *this)
{
  *this = &unk_1F5EF7F98;
  xpc_release(this[1]);
  this[1] = 0;
}

{
  *this = &unk_1F5EF7F98;
  xpc_release(this[1]);
  this[1] = 0;

  JUMPOUT(0x1E69235B0);
}

xpc_object_t anonymous namespace::LazuliReferEventImpl::getDict@<X0>(_anonymous_namespace_::LazuliReferEventImpl *this@<X0>, void *a2@<X8>)
{
  v2 = *(this + 1);
  *a2 = v2;
  if (v2)
  {
    return xpc_retain(v2);
  }

  result = xpc_null_create();
  *a2 = result;
  return result;
}

void LazuliRouteSet::LazuliRouteSet(LazuliRouteSet *this, const LazuliRouteSet *a2)
{
  *(this + 8) = 0u;
  *this = &unk_1F5EF8000;
  *(this + 24) = 0u;
  *(this + 40) = 0u;
  v2 = *(a2 + 1);
  if (*(a2 + 2) != v2)
  {
    LazuliRouteSet::addHop(this, *v2, 0, 0, **(a2 + 4));
  }
}

void sub_1E514FFA4(_Unwind_Exception *exception_object)
{
  v4 = v1[4];
  if (v4)
  {
    v1[5] = v4;
    operator delete(v4);
  }

  v5 = *v2;
  if (*v2)
  {
    v1[2] = v5;
    operator delete(v5);
  }

  _Unwind_Resume(exception_object);
}

LazuliRouteSet *LazuliRouteSet::operator=(LazuliRouteSet *a1, const LazuliUri ***a2)
{
  LazuliRouteSet::clear(a1);
  v4 = a2[1];
  if (a2[2] != v4)
  {
    LazuliRouteSet::addHop(a1, *v4, 0, 0, *a2[4]);
  }

  return a1;
}

void *LazuliRouteSet::clear(void *this)
{
  v1 = this;
  v2 = this[1];
  if (this[2] != v2)
  {
    v3 = 0;
    do
    {
      v4 = *(v2 + 8 * v3);
      if (v4)
      {
        (*(*v4 + 8))(v4);
      }

      this = *(v1[4] + 8 * v3);
      if (this)
      {
        this = (*(*this + 8))(this);
      }

      ++v3;
      v2 = v1[1];
    }

    while (v3 < (v1[2] - v2) >> 3);
  }

  v1[2] = v2;
  v1[5] = v1[4];
  return this;
}

void LazuliRouteSet::~LazuliRouteSet(LazuliRouteSet *this)
{
  *this = &unk_1F5EF8000;
  LazuliRouteSet::clear(this);
  v2 = *(this + 4);
  if (v2)
  {
    *(this + 5) = v2;
    operator delete(v2);
  }

  v3 = *(this + 1);
  if (v3)
  {
    *(this + 2) = v3;
    operator delete(v3);
  }
}

{
  LazuliRouteSet::~LazuliRouteSet(this);

  JUMPOUT(0x1E69235B0);
}

char *std::vector<LazuliUri *>::insert(void *a1, char *__src, char *a3)
{
  v4 = __src;
  v6 = a1[1];
  v7 = a1[2];
  if (v6 >= v7)
  {
    v10 = *a1;
    v11 = (&v6[-*a1] >> 3) + 1;
    if (v11 >> 61)
    {
      std::vector<LazuliUri *>::__throw_length_error[abi:ne200100]();
    }

    v12 = __src - v10;
    v13 = v7 - v10;
    if (v13 >> 2 > v11)
    {
      v11 = v13 >> 2;
    }

    if (v13 >= 0x7FFFFFFFFFFFFFF8)
    {
      v14 = 0x1FFFFFFFFFFFFFFFLL;
    }

    else
    {
      v14 = v11;
    }

    v15 = v12 >> 3;
    if (v14)
    {
      std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(a1, v14);
    }

    v16 = (8 * v15);
    if (!v15)
    {
      if (v12 < 1)
      {
        if (v10 == v4)
        {
          v19 = 1;
        }

        else
        {
          v19 = v12 >> 2;
        }

        std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(a1, v19);
      }

      v16 = (v16 - (((v12 >> 1) + 4) & 0xFFFFFFFFFFFFFFF8));
    }

    *v16 = *a3;
    memcpy(v16 + 1, v4, a1[1] - v4);
    v20 = *a1;
    v21 = v16 + a1[1] - v4 + 8;
    a1[1] = v4;
    v22 = v4 - v20;
    v23 = v16 - (v4 - v20);
    memcpy(v23, v20, v22);
    v24 = *a1;
    *a1 = v23;
    a1[1] = v21;
    a1[2] = 0;
    if (v24)
    {
      operator delete(v24);
    }

    return v16;
  }

  else if (__src == v6)
  {
    *v6 = *a3;
    a1[1] = v6 + 8;
  }

  else
  {
    v8 = __src + 8;
    if (v6 < 8)
    {
      v9 = a1[1];
    }

    else
    {
      *v6 = *(v6 - 1);
      v9 = v6 + 8;
    }

    a1[1] = v9;
    if (v6 != v8)
    {
      memmove(__src + 8, __src, v6 - v8);
      v9 = a1[1];
    }

    v17 = v9 <= a3 || v4 > a3;
    v18 = 8;
    if (v17)
    {
      v18 = 0;
    }

    *v4 = *&a3[v18];
  }

  return v4;
}

void sub_1E5150560(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    operator delete(v1);
  }

  _Unwind_Resume(exception_object);
}

void std::vector<LazuliUri *>::push_back[abi:ne200100](uint64_t a1, void *a2)
{
  v5 = *(a1 + 8);
  v4 = *(a1 + 16);
  if (v5 >= v4)
  {
    v7 = (v5 - *a1) >> 3;
    if ((v7 + 1) >> 61)
    {
      std::vector<LazuliUri *>::__throw_length_error[abi:ne200100]();
    }

    v8 = v4 - *a1;
    v9 = v8 >> 2;
    if (v8 >> 2 <= (v7 + 1))
    {
      v9 = v7 + 1;
    }

    if (v8 >= 0x7FFFFFFFFFFFFFF8)
    {
      v10 = 0x1FFFFFFFFFFFFFFFLL;
    }

    else
    {
      v10 = v9;
    }

    if (v10)
    {
      std::__allocate_at_least[abi:ne200100]<std::allocator<XmlParserGenericItem *>>(a1, v10);
    }

    v11 = (8 * v7);
    *v11 = *a2;
    v6 = 8 * v7 + 8;
    v12 = *(a1 + 8) - *a1;
    v13 = v11 - v12;
    memcpy(v11 - v12, *a1, v12);
    v14 = *a1;
    *a1 = v13;
    *(a1 + 8) = v6;
    *(a1 + 16) = 0;
    if (v14)
    {
      operator delete(v14);
    }
  }

  else
  {
    *v5 = *a2;
    v6 = (v5 + 1);
  }

  *(a1 + 8) = v6;
}

ImsOutStream *LazuliRouteSet::toStream(LazuliRouteSet *this, ImsOutStream *a2)
{
  v3 = *(this + 1);
  if (*(this + 2) != v3)
  {
    v5 = 0;
    do
    {
      if (v5)
      {
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), ", ", 2);
        *(a2 + 17) = 0;
        v3 = *(this + 1);
      }

      (*(**(v3 + 8 * v5) + 48))(*(v3 + 8 * v5), a2);
      v6 = *(*(this + 4) + 8 * v5);
      (*(*v6 + 16))(v6, a2);
      ++v5;
      v3 = *(this + 1);
    }

    while (v5 < (*(this + 2) - v3) >> 3);
  }

  return a2;
}

BOOL LazuliRouteSet::fromString(LazuliRouteSet *a1, std::string *a2)
{
  LazuliRouteSet::clear(a1);
  std::string::basic_string[abi:ne200100]<0>(&__p, "LazuliRouteSet");
  v38[0] = 0;
  v41 = 0;
  v4 = ims::debug(&__p, v38);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "LazuliRouteSet::fromString ", 27);
  *(v4 + 17) = 0;
  (*(*v4 + 32))(v4, a2);
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v41 == 1 && v40 < 0)
  {
    operator delete(v39);
  }

  if (SHIBYTE(v22) < 0)
  {
    operator delete(__p);
  }

  memset(&__str, 0, sizeof(__str));
  v29 = 0;
  v35 = 0u;
  v36 = 0;
  __p = &unk_1F5EE2808;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v30 = 0;
  v31 = 0;
  v25 = &unk_1F5ED7D40;
  v26 = 0;
  v27 = 0;
  v28 = 0;
  v34 = 0;
  *&v35 = 0;
  v32 = &unk_1F5EBEF50;
  v33 = &v34;
  BYTE9(v35) = 1;
  v20[1] = 0;
  v20[2] = 256;
  v18 = &unk_1F5EBEF50;
  v19 = v20;
  v20[0] = 0;
  v5 = ims::nextTokenQ(a2, 0, &__str, 0x2Cu);
  if (v5 != -1)
  {
    v6 = std::string::find(a2, 59, v5);
    std::string::basic_string[abi:ne200100]<0>(&v11, "LazuliRouteSet");
    v14[0] = 0;
    v17 = 0;
    v7 = ims::debug(&v11, v14);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "LazuliRouteSet token ", 21);
    *(v7 + 17) = 0;
    (*(*v7 + 32))(v7, &__str);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), " semicolon ", 11);
    *(v7 + 17) = 0;
    MEMORY[0x1E6923370](*(v7 + 8), v6);
    *(v7 + 17) = 0;
    (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v7 + 17) = 0;
    if (v17 == 1 && v16 < 0)
    {
      operator delete(v15);
    }

    if (SHIBYTE(v11.__r_.__value_.__r.__words[2]) < 0)
    {
      operator delete(v11.__r_.__value_.__l.__data_);
    }

    if (v6 == -1)
    {
      if (LazuliUri::fromString(&__p, &__str))
      {
        v11.__r_.__value_.__r.__words[2] = 0;
        v12 = 0;
        v11.__r_.__value_.__r.__words[0] = &unk_1F5EBEF50;
        v11.__r_.__value_.__l.__size_ = &v11.__r_.__value_.__r.__words[2];
        v13 = 256;
        LazuliRouteSet::addHop(a1, &__p, 0, 0, &v11);
      }
    }

    else
    {
      std::string::basic_string(&v11, &__str, 0, v6, v42);
      v8 = LazuliUri::fromString(&__p, &v11);
      if (SHIBYTE(v11.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v11.__r_.__value_.__l.__data_);
      }

      if (v8)
      {
        std::string::basic_string(&v11, &__str, v6 + 1, 0xFFFFFFFFFFFFFFFFLL, v42);
        v9 = SipParameterMap::fromString(&v18, &v11, 0, 0);
        if (SHIBYTE(v11.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v11.__r_.__value_.__l.__data_);
        }

        if (v9)
        {
          LazuliRouteSet::addHop(a1, &__p, 0, 0, &v18);
        }
      }
    }
  }

  v18 = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(&v19, v20[0]);
  LazuliUri::~LazuliUri(&__p);
  if (SHIBYTE(__str.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__str.__r_.__value_.__l.__data_);
  }

  return v5 == -1;
}

void sub_1E5150BB0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, void *a17, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, void *__p, uint64_t a31, int a32, __int16 a33, char a34, char a35)
{
  if (*(v35 - 104) == 1 && *(v35 - 113) < 0)
  {
    operator delete(*(v35 - 136));
  }

  if (a35 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

uint64_t LazuliRouteSet::operator==(void *a1, void *a2)
{
  v2 = a1[1];
  v3 = a1[2];
  if (v3 - v2 != a2[2] - a2[1])
  {
    return 0;
  }

  v6 = a1[4];
  v7 = a1[5];
  if (v7 - v6 != a2[5] - a2[4])
  {
    return 0;
  }

  if (v3 != v2)
  {
    v8 = 0;
    while ((LazuliUri::operator==(*(v2 + 8 * v8), *(a2[1] + 8 * v8)) & 1) != 0)
    {
      ++v8;
      v2 = a1[1];
      if (v8 >= (a1[2] - v2) >> 3)
      {
        v6 = a1[4];
        v7 = a1[5];
        goto LABEL_8;
      }
    }

    return 0;
  }

LABEL_8:
  if (v7 == v6)
  {
    return 1;
  }

  v9 = 0;
  do
  {
    result = SipParameterMap::operator==(*(v6 + 8 * v9), *(a2[4] + 8 * v9));
    if ((result & 1) == 0)
    {
      break;
    }

    ++v9;
    v6 = a1[4];
  }

  while (v9 < (a1[5] - v6) >> 3);
  return result;
}

void IPSecurityManager::IPSecurityManager(IPSecurityManager *this)
{
  *this = &unk_1F5EF8240;
  v2 = this + 8;
  std::string::basic_string[abi:ne200100]<0>(object, "ipsec");
  v4[0] = 0;
  v7 = 0;
  ImsLogContainer::ImsLogContainer(v2, object, v4);
  if (v7 == 1 && v6 < 0)
  {
    operator delete(__p);
  }

  if (v9 < 0)
  {
    operator delete(object[0]);
  }

  ims::getQueue(object);
  *(this + 19) = 0;
  *(this + 20) = 0;
  v3 = object[0];
  *(this + 21) = object[0];
  if (v3)
  {
    dispatch_retain(v3);
  }

  *(this + 22) = 0;
  ctu::OsLogLogger::OsLogLogger((this + 184), "com.apple.ipTelephony", "ipsec");
  if (v3)
  {
    dispatch_release(v3);
  }

  *this = &unk_1F5EF8030;
  *(this + 1) = &unk_1F5EF80B0;
  *(this + 18) = &unk_1F5EF8110;
  *(this + 24) = 0;
  *(this + 50) = 1;
  *(this + 27) = 0;
  *(this + 28) = 0;
  *(this + 26) = this + 216;
  *(this + 30) = 0;
  *(this + 29) = this + 240;
  *(this + 31) = 0;
  IMSNetworkPolicySession::IMSNetworkPolicySession(this + 32, this);
  *(this + 53) = 0;
}

void sub_1E5150F20(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  v31 = v29;
  v32 = v27;
  std::__tree<std::string>::destroy(v28, *v30);
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*v31);
  IMSSecureNetworkSession::deinitialize(v32);
  MEMORY[0x1E69225A0](v25 + 184);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(v26);
  ImsLogContainer::~ImsLogContainer(v24);
  _Unwind_Resume(a1);
}

void IPSecurityManager::~IPSecurityManager(IPSecurityManager *this)
{
  *this = &unk_1F5EF8030;
  *(this + 1) = &unk_1F5EF80B0;
  *(this + 18) = &unk_1F5EF8110;
  IPSecurityManager::deinitializePolicies(this);
  IMSNetworkPolicySession::~IMSNetworkPolicySession((this + 256));
  std::__tree<std::string>::destroy(this + 232, *(this + 30));
  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 27));
  IMSSecureNetworkSession::deinitialize((this + 192));
  MEMORY[0x1E69225A0](this + 184);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 19);
  *(this + 1) = &unk_1F5ED7318;
  if (*(this + 88) == 1 && *(this + 79) < 0)
  {
    operator delete(*(this + 7));
  }

  if (*(this + 39) < 0)
  {
    operator delete(*(this + 2));
  }
}

{
  IPSecurityManager::~IPSecurityManager(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toIPSecurityManager::~IPSecurityManager(IPSecurityManager *this)
{
  IPSecurityManager::~IPSecurityManager((this - 8));
}

{
  IPSecurityManager::~IPSecurityManager((this - 144));
}

{
  IPSecurityManager::~IPSecurityManager((this - 8));

  JUMPOUT(0x1E69235B0);
}

{
  IPSecurityManager::~IPSecurityManager((this - 144));

  JUMPOUT(0x1E69235B0);
}

uint64_t IPSecurityManager::initializePolicies(IPSecurityManager *this)
{
  v3 = *(this + 24);
  v2 = (this + 192);
  if (v3)
  {
    return 1;
  }

  if (IMSSecureNetworkSession::initialize(v2))
  {
    v17 = 0;
    v15 = 0u;
    v16 = 0u;
    v13 = 0u;
    v14 = 0u;
    v12 = 0u;
    IMSNetworkPolicySession::initialize((this + 256), &v12);
    v4 = (*(**(&v12 + 1) + 24))(*(&v12 + 1), v13) ^ 1;
    if (v4)
    {
      if (!*(this + 53))
      {
        operator new();
      }

      v9 = *(this + 1);
      v8 = this + 8;
      v10 = (*(v9 + 64))(v8);
      (*(*v8 + 16))(v8, v10);
      std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "initialized!", 12);
      *(v10 + 17) = 0;
      (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
      *(v10 + 17) = 0;
    }

    else
    {
      ImsLogContainer::logResult(this + 8, &v12);
    }

    ImsResult::~ImsResult(&v12);
  }

  else
  {
    v6 = *(this + 1);
    v5 = this + 8;
    v7 = (*(v6 + 56))(v5);
    (*(*v5 + 16))(v5, v7);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "unable to create secure networking session", 42);
    *(v7 + 17) = 0;
    (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    v4 = 0;
    *(v7 + 17) = 0;
  }

  return v4;
}

void IPSecurityManager::applyChanges(IPSecurityManager *this)
{
  if (*(this + 51))
  {
    IMSNetworkPolicySession::applyPolicies((this + 256), v3);
    ImsResult::~ImsResult(v3);
  }

  v2 = *(this + 53);
  if (v2)
  {
    if (v2[3] != v2[4])
    {
      PolicyApply(v2[9]);
    }
  }
}

IMSSecurityPolicyManager *IPSecurityManager::deinitializePolicies(IPSecurityManager *this)
{
  v2 = *(this + 26);
  v3 = this + 216;
  if (v2 != this + 216)
  {
    do
    {
      v4 = *(v2 + 5);
      if (v4)
      {
        IMSSecurityAssociationPair::~IMSSecurityAssociationPair(v4);
        MEMORY[0x1E69235B0]();
      }

      v5 = *(v2 + 1);
      if (v5)
      {
        do
        {
          v6 = v5;
          v5 = *v5;
        }

        while (v5);
      }

      else
      {
        do
        {
          v6 = *(v2 + 2);
          v7 = *v6 == v2;
          v2 = v6;
        }

        while (!v7);
      }

      v2 = v6;
    }

    while (v6 != v3);
  }

  std::__tree<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::__map_value_compare<SDPType,std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>,std::less<SDPType>,true>,std::allocator<std::__value_type<SDPType,BOOL (*)(SDPParser::SDPParserContext const&,std::string &,std::istringstream &)>>>::destroy(*(this + 27));
  *(this + 27) = 0;
  *(this + 28) = 0;
  *(this + 26) = v3;
  IMSSecureNetworkSession::deinitialize((this + 192));
  std::__tree<std::string>::destroy(this + 232, *(this + 30));
  *(this + 30) = 0;
  *(this + 31) = 0;
  *(this + 29) = this + 240;
  IMSNetworkPolicySession::deinitialize((this + 256));
  result = *(this + 53);
  if (result)
  {
    IMSSecurityPolicyManager::~IMSSecurityPolicyManager(result);
    result = MEMORY[0x1E69235B0]();
  }

  *(this + 53) = 0;
  return result;
}

void *IPSecurityManager::logPrefix(IPSecurityManager *this, ImsOutStream *a2)
{
  result = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "IPSecurityManager: ", 19);
  *(a2 + 17) = 0;
  return result;
}

void *non-virtual thunk toIPSecurityManager::logPrefix(IPSecurityManager *this, ImsOutStream *a2)
{
  result = std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(a2 + 1), "IPSecurityManager: ", 19);
  *(a2 + 17) = 0;
  return result;
}

uint64_t *IPSecurityManager::removeSecurityAssociationPairWithInboundSpi(IPSecurityManager *this, unsigned int a2)
{
  v4 = this + 216;
  result = *(this + 27);
  if (result)
  {
    v5 = v4;
    v6 = result;
    do
    {
      v7 = *(v6 + 8);
      v8 = v7 >= a2;
      v9 = v7 < a2;
      if (v8)
      {
        v5 = v6;
      }

      v6 = v6[v9];
    }

    while (v6);
    if (v5 != v4 && *(v5 + 8) <= a2)
    {
      v10 = v5[5];
      if (v10)
      {
        v11 = v4;
        v12 = result;
        while (1)
        {
          v13 = *(v12 + 8);
          v8 = v13 >= a2;
          v14 = v13 < a2;
          if (v8)
          {
            v11 = v12;
          }

          v12 = v12[v14];
          if (!v12)
          {
            if (v11 != v4 && *(v11 + 8) <= a2)
            {
              v15 = v11[1];
              if (v15)
              {
                do
                {
                  v16 = v15;
                  v15 = *v15;
                }

                while (v15);
              }

              else
              {
                v17 = v11;
                do
                {
                  v16 = v17[2];
                  v18 = *v16 == v17;
                  v17 = v16;
                }

                while (!v18);
              }

              if (*(this + 26) == v11)
              {
                *(this + 26) = v16;
              }

              --*(this + 28);
              std::__tree_remove[abi:ne200100]<std::__tree_node_base<void *> *>(result, v11);
              operator delete(v11);
            }

            IMSSecurityAssociationPair::~IMSSecurityAssociationPair(v10);

            JUMPOUT(0x1E69235B0);
          }
        }
      }
    }
  }

  return result;
}

void IPSecurityManager::createTemporarySecurityAssociationPair(uint64_t a1@<X0>, ImsResult *a2@<X8>)
{
  if (*(a1 + 192))
  {
    operator new();
  }

  v6 = 0u;
  v7 = 0u;
  v8 = 0u;
  v9 = 0u;
  v4[0] = &unk_1F5EBDEF8;
  v4[1] = &_bambiDomain;
  v5 = 1073741826;
  v3 = ImsResult::operator<<<char [24]>(v4, "session not initialized");
  ImsResult::ImsResult(a2, v3);
  ImsResult::~ImsResult(v4);
}

void sub_1E5151C38(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, ...)
{
  va_start(va, a13);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void *IPSecurityManager::addPolicyForInterface@<X0>(uint64_t a1@<X0>, char *a2@<X1>, uint64_t a3@<X8>)
{
  *(a3 + 16) = 0;
  *(a3 + 24) = 0;
  *(a3 + 40) = 0u;
  *(a3 + 56) = 0u;
  *(a3 + 72) = 0u;
  *a3 = &unk_1F5EBDEF8;
  *(a3 + 8) = &_bambiDomain;
  *(a3 + 32) = 0;
  result = *(a1 + 424);
  if (result)
  {
    if (result[3] == result[4])
    {
      IMSSecurityPolicyManager::addSkipPolicy(result, &ims::kEmptyString, v8);
      ImsResult::~ImsResult(v8);
      result = *(a1 + 424);
    }

    IMSSecurityPolicyManager::addPolicyForInterface(result, a2, v7);
    ImsResult::operator=(a3, v7);
    ImsResult::~ImsResult(v7);
    return PolicyApply(*(*(a1 + 424) + 72));
  }

  return result;
}

void sub_1E5151D50(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  ImsResult::~ImsResult(&a9);
  ImsResult::~ImsResult(v9);
  _Unwind_Resume(a1);
}

IMSSecurityPolicyManager *IPSecurityManager::addPolicyForInterface@<X0>(IPSecurityManager *this@<X0>, NetworkInterface *a2@<X1>, uint64_t a3@<X8>)
{
  *(a3 + 16) = 0;
  *(a3 + 24) = 0;
  *(a3 + 40) = 0u;
  *(a3 + 56) = 0u;
  *(a3 + 72) = 0u;
  *a3 = &unk_1F5EBDEF8;
  *(a3 + 8) = &_bambiDomain;
  *(a3 + 32) = 0;
  result = *(this + 53);
  if (result)
  {
    if (*(result + 3) == *(result + 4))
    {
      IMSSecurityPolicyManager::addSkipPolicy(result, &ims::kEmptyString, v8);
      ImsResult::~ImsResult(v8);
      result = *(this + 53);
    }

    IMSSecurityPolicyManager::addPolicyForInterface(result, a2, v7);
    ImsResult::operator=(a3, v7);
    ImsResult::~ImsResult(v7);
    return PolicyApply(*(*(this + 53) + 72));
  }

  return result;
}

void sub_1E5151E50(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  ImsResult::~ImsResult(&a9);
  ImsResult::~ImsResult(v9);
  _Unwind_Resume(a1);
}

uint64_t IPSecurityManager::removePolicyForInterface(uint64_t a1, std::string *a2)
{
  result = *(a1 + 424);
  if (result)
  {
    return IMSSecurityPolicyManager::removePolicyForInterface(result, a2);
  }

  return result;
}

void IPSecurityManager::updateSecurityAssociationPair(uint64_t a1@<X0>, unsigned int a2@<W1>, uint64_t a3@<X3>, uint64_t a4@<X4>, const unsigned __int8 (*a5)[16]@<X5>, unsigned __int8 (*a6)[16]@<X6>, void *a7@<X7>, ImsResult *a8@<X8>)
{
  v27 = a2;
  if (!*(a1 + 192))
  {
    v23 = 0u;
    v24 = 0u;
    v25 = 0u;
    v26 = 0u;
    v20 = &unk_1F5EBDEF8;
    v21 = &_bambiDomain;
    v22 = 1073741826;
    v19 = ImsResult::operator<<<char [24]>(&v20, "library not initialized");
    ImsResult::ImsResult(a8, v19);
    goto LABEL_16;
  }

  v11 = *(a1 + 216);
  v9 = a1 + 216;
  v10 = v11;
  if (!v11)
  {
    goto LABEL_14;
  }

  v12 = v9;
  do
  {
    v13 = *(v10 + 32);
    v14 = v13 >= a2;
    v15 = v13 < a2;
    if (v14)
    {
      v12 = v10;
    }

    v10 = *(v10 + 8 * v15);
  }

  while (v10);
  if (v12 == v9 || *(v12 + 32) > a2 || (v16 = *(v12 + 40)) == 0)
  {
LABEL_14:
    v23 = 0u;
    v24 = 0u;
    v25 = 0u;
    v26 = 0u;
    v20 = &unk_1F5EBDEF8;
    v21 = &_bambiDomain;
    v22 = 1073741825;
    v17 = ImsResult::operator<<<char [37]>(&v20, "can't find SA pair with inbound SPI ");
    v18 = ImsResult::operator<<<unsigned int>(v17, &v27);
    ImsResult::ImsResult(a8, v18);
LABEL_16:
    ImsResult::~ImsResult(&v20);
    return;
  }

  IMSSecurityAssociationPair::update(v16, a3, a4, a5, a6, a7, a8);
}

void IPSecurityManager::updatePoliciesFromList(uint64_t a1, void ***a2)
{
  if (!*(a1 + 424))
  {
    v7 = a1 + 8;
    v8 = (*(*(a1 + 8) + 64))(a1 + 8);
    (*(*v7 + 16))(v7, v8);
    v9 = *(v8 + 8);
    v10 = "Not updating interfaces - security policy not initialized";
    v11 = 57;
LABEL_40:
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(v9, v10, v11);
    *(v8 + 17) = 0;
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v8 + 17) = 0;
    return;
  }

  IPTelephonyManager::instance(&__p);
  v4 = *(__p.__r_.__value_.__r.__words[0] + 232);
  if (v4)
  {
    v5 = *(v4 + 680);
    v6 = *(v4 + 688);
    if (v6)
    {
      atomic_fetch_add_explicit(&v6->__shared_owners_, 1uLL, memory_order_relaxed);
      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }

  else
  {
    v5 = 0;
  }

  if (__p.__r_.__value_.__l.__size_)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](__p.__r_.__value_.__l.__size_);
  }

  if (!v5)
  {
    v26 = *(a1 + 8);
    v25 = a1 + 8;
    v8 = (*(v26 + 56))(v25);
    (*(*v25 + 16))(v25, v8);
    v9 = *(v8 + 8);
    v10 = "Network manager not initialized";
    v11 = 31;
    goto LABEL_40;
  }

  std::string::basic_string[abi:ne200100]<0>(&__p, "policy interfaces before update");
  printInterfaces(&__p, (a1 + 232));
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  v34 = 0;
  v35[0] = 0;
  v35[1] = 0;
  std::set<std::string>::set[abi:ne200100](&v34, a1 + 232);
  std::__tree<std::string>::destroy(a1 + 232, *(a1 + 240));
  *(a1 + 240) = 0;
  *(a1 + 248) = 0;
  *(a1 + 232) = a1 + 240;
  v12 = *a2;
  v13 = a2[1];
  if (*a2 != v13)
  {
    v14 = a1 + 8;
    do
    {
      v15 = std::__tree<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::list<SipLazuliManager::OutgoingMsrp>>>>::find<std::string>(&v34, v12);
      __p.__r_.__value_.__l.__size_ = &_bambiDomain;
      __p.__r_.__value_.__r.__words[2] = 0;
      v30 = 0u;
      v31 = 0u;
      v32 = 0u;
      v33 = 0u;
      __p.__r_.__value_.__r.__words[0] = &unk_1F5EBDEF8;
      if (v35 == v15)
      {
        IPTelephonyManager::instance(&v27);
        v16 = *(v27 + 232);
        v17 = *(v16 + 680);
        v18 = *(v16 + 688);
        if (v18)
        {
          atomic_fetch_add_explicit(&v18->__shared_owners_, 1uLL, memory_order_relaxed);
        }

        v19 = (*(*v17 + 40))(v17, v12);
        if (v18)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v18);
        }

        if (v28)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v28);
        }

        if (v19)
        {
          (*(*a1 + 56))(&v27, a1, v19);
          ImsResult::operator=(&__p, &v27);
          ImsResult::~ImsResult(&v27);
          (*(*v19 + 8))(v19);
        }

        else
        {
          (*(*a1 + 64))(&v27, a1, v12);
          ImsResult::operator=(&__p, &v27);
          ImsResult::~ImsResult(&v27);
        }
      }

      else
      {
        std::__tree<std::__value_type<std::string,BOOL>,std::__map_value_compare<std::string,std::__value_type<std::string,BOOL>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,BOOL>>>::erase(&v34, v15);
      }

      if ((*(*__p.__r_.__value_.__l.__size_ + 24))(__p.__r_.__value_.__l.__size_, LODWORD(__p.__r_.__value_.__r.__words[2])))
      {
        v20 = (*(*v14 + 56))(a1 + 8);
        (*(*v14 + 16))(a1 + 8, v20);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v20 + 8), "Unable to add policy for interface ", 35);
        *(v20 + 17) = 0;
        (*(*v20 + 32))(v20, v12);
        (*(*v20 + 64))(v20, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v20 + 17) = 0;
      }

      else
      {
        std::__tree<std::string>::__emplace_unique_key_args<std::string,std::string const&>(a1 + 232, v12);
      }

      ImsResult::~ImsResult(&__p);
      v12 += 3;
    }

    while (v12 != v13);
  }

  v21 = v34;
  if (v34 != v35)
  {
    do
    {
      (*(*a1 + 72))(a1, v21 + 4);
      v22 = v21[1];
      if (v22)
      {
        do
        {
          v23 = v22;
          v22 = *v22;
        }

        while (v22);
      }

      else
      {
        do
        {
          v23 = v21[2];
          v24 = *v23 == v21;
          v21 = v23;
        }

        while (!v24);
      }

      v21 = v23;
    }

    while (v23 != v35);
  }

  PolicyApply(*(*(a1 + 424) + 72));
  std::string::basic_string[abi:ne200100]<0>(&__p, "policy interfaces after update");
  printInterfaces(&__p, (a1 + 232));
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  std::__tree<std::string>::destroy(&v34, v35[0]);
}

void sub_1E51525E0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, void *__p, uint64_t a21, int a22, __int16 a23, char a24, char a25)
{
  if (a25 < 0)
  {
    operator delete(__p);
  }

  std::__tree<std::string>::destroy(v25 - 112, *(v25 - 104));
  _Unwind_Resume(a1);
}

void printInterfaces(const std::string *a1, void *a2)
{
  v4 = std::string::basic_string[abi:ne200100]<0>(v30, "policy");
  v26[0] = 0;
  v29 = 0;
  v5 = ims::debug(v4, v26);
  LoggableString::LoggableString(&__p, a1);
  (*(*v5 + 40))(v5, &__p);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), " (", 2);
  *(v5 + 17) = 0;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v29 == 1 && v28 < 0)
  {
    operator delete(v27);
  }

  if (v31 < 0)
  {
    operator delete(v30[0]);
  }

  v8 = *a2;
  v6 = a2 + 1;
  v7 = v8;
  v9 = std::string::basic_string[abi:ne200100]<0>(v30, "policy");
  v21[0] = 0;
  v24 = 0;
  v10 = ims::debug(v9, v21);
  std::string::basic_string[abi:ne200100]<0>(&__p, " ");
  if (v8 != v6)
  {
    v11 = 1;
    do
    {
      if ((v11 & 1) == 0)
      {
        (*(*v10 + 32))(v10, &__p);
      }

      (*(*v10 + 32))(v10, v7 + 4);
      v12 = v7[1];
      if (v12)
      {
        do
        {
          v13 = v12;
          v12 = *v12;
        }

        while (v12);
      }

      else
      {
        do
        {
          v13 = v7[2];
          v14 = *v13 == v7;
          v7 = v13;
        }

        while (!v14);
      }

      v11 = 0;
      v7 = v13;
    }

    while (v13 != v6);
  }

  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v24 == 1 && v23 < 0)
  {
    operator delete(v22);
  }

  if (v31 < 0)
  {
    operator delete(v30[0]);
  }

  v15 = std::string::basic_string[abi:ne200100]<0>(v30, "policy");
  v17[0] = 0;
  v20 = 0;
  v16 = ims::debug(v15, v17);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), ")", 1);
  *(v16 + 17) = 0;
  (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v16 + 17) = 0;
  if (v20 == 1 && v19 < 0)
  {
    operator delete(v18);
  }

  if (v31 < 0)
  {
    operator delete(v30[0]);
  }
}

void sub_1E515292C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, void *__p, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, void *a30, uint64_t a31, int a32, __int16 a33, char a34, char a35)
{
  if (a29 == 1 && a27 < 0)
  {
    operator delete(__p);
  }

  if (*(v35 - 49) < 0)
  {
    operator delete(*(v35 - 72));
  }

  _Unwind_Resume(exception_object);
}

double BambiSecurityDelegate::addPolicyForInterface@<D0>(uint64_t a1@<X8>)
{
  result = 0.0;
  *(a1 + 24) = 0u;
  *(a1 + 40) = 0u;
  *(a1 + 56) = 0u;
  *(a1 + 72) = 0u;
  *a1 = &unk_1F5EBDEF8;
  *(a1 + 8) = &_bambiDomain;
  *(a1 + 16) = 0x40000000;
  return result;
}

{
  result = 0.0;
  *(a1 + 24) = 0u;
  *(a1 + 40) = 0u;
  *(a1 + 56) = 0u;
  *(a1 + 72) = 0u;
  *a1 = &unk_1F5EBDEF8;
  *(a1 + 8) = &_bambiDomain;
  *(a1 + 16) = 0x40000000;
  return result;
}

uint64_t Rfc5626RegistrationPolicy::Rfc5626RegistrationPolicy(uint64_t a1, std::__shared_weak_count **a2)
{
  v3 = a2[1];
  v5 = *a2;
  v6 = v3;
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  SipRegistrationPolicy::SipRegistrationPolicy(a1, &v5);
  if (v6)
  {
    std::__shared_weak_count::__release_weak(v6);
  }

  *a1 = &unk_1F5EF82B8;
  *(a1 + 136) = &unk_1F5EF8518;
  *(a1 + 144) = &unk_1F5EF8548;
  *(a1 + 152) = &unk_1F5EF8560;
  *(a1 + 2376) = 0;
  return a1;
}

void sub_1E5152B68(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_weak(a10);
  }

  _Unwind_Resume(exception_object);
}

uint64_t Rfc5626RegistrationPolicy::computeRetryInterval(Rfc5626RegistrationPolicy *this)
{
  v24 = *MEMORY[0x1E69E9840];
  v2 = *(this + 594) + 1;
  *(this + 594) = v2;
  v3 = *(this + 465);
  v4 = (*(this + 464) / v3) >> v2;
  v5 = v3 << v2;
  if (v4)
  {
    v6 = v5;
  }

  else
  {
    v6 = *(this + 464);
  }

  v7 = (random() % (v6 >> 1)) + (v6 >> 1);
  v8 = *(this + 24);
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    (*(*this + 184))(__p, this);
    if (v13 >= 0)
    {
      v9 = __p;
    }

    else
    {
      v9 = __p[0];
    }

    *buf = 141559043;
    v15 = 1752392040;
    v16 = 2081;
    v17 = v9;
    v18 = 1024;
    v19 = v6 >> 1;
    v20 = 1024;
    v21 = v6;
    v22 = 2048;
    v23 = v7;
    _os_log_impl(&dword_1E4C3F000, v8, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}schoosing actual wait time in range [%u, %u] = %lu s", buf, 0x2Cu);
    if (v13 < 0)
    {
      operator delete(__p[0]);
    }
  }

  v10 = *MEMORY[0x1E69E9840];
  return v7;
}

uint64_t Rfc5626RegistrationPolicy::handleGeneralErrorFromAllProxies(Rfc5626RegistrationPolicy *this, const ImsResult *a2)
{
  SipRegistrationPolicy::setProxyOffset(this, 0);
  SipRegistrationPolicy::clearLastProxyErrors(this);
  v4 = SipRegistrationPolicy::retryTimeFromResult(this, a2);
  if (v4 == -1)
  {
    v4 = Rfc5626RegistrationPolicy::computeRetryInterval(this);
  }

  v5 = *(*this + 584);

  return v5(this, a2, v4);
}

void Rfc5626RegistrationPolicy::~Rfc5626RegistrationPolicy(Rfc5626RegistrationPolicy *this)
{
  SipRegistrationPolicy::~SipRegistrationPolicy(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toRfc5626RegistrationPolicy::~Rfc5626RegistrationPolicy(Rfc5626RegistrationPolicy *this)
{
  SipRegistrationPolicy::~SipRegistrationPolicy((this - 136));
}

{
  SipRegistrationPolicy::~SipRegistrationPolicy((this - 136));

  JUMPOUT(0x1E69235B0);
}

{
  SipRegistrationPolicy::~SipRegistrationPolicy((this - 152));
}

{
  SipRegistrationPolicy::~SipRegistrationPolicy((this - 152));

  JUMPOUT(0x1E69235B0);
}

void SipLocationDiscoveryBody::SipLocationDiscoveryBody(SipLocationDiscoveryBody *this)
{
  *(this + 1) = 0;
  *(this + 2) = 0;
  *(this + 3) = 0;
  *this = &unk_1F5EF85A0;
  SipLocationDiscoveryData::SipLocationDiscoveryData((this + 32));
}

void sub_1E5152F14(_Unwind_Exception *exception_object)
{
  *v1 = &unk_1F5ED9B90;
  if (*(v1 + 31) < 0)
  {
    operator delete(*v2);
  }

  _Unwind_Resume(exception_object);
}

void SipLocationDiscoveryBody::generateXml(SipLocationDiscoveryBody *this@<X0>, std::string *a2@<X8>)
{
  v4 = 0;
  memset(v3, 0, sizeof(v3));
  SipLocationDiscoveryData::SipLocationDiscoveryData(v3, (this + 32));
  bambi::XmlTreeItem::encode((v3 + 8), 0, 1, a2);
  bambi::XmlTreeItem::~XmlTreeItem(v3 + 1);
}

void SipLocationDiscoveryBody::~SipLocationDiscoveryBody(void **this)
{
  SipLocationDiscoveryBody::~SipLocationDiscoveryBody(this);

  JUMPOUT(0x1E69235B0);
}

{
  *this = &unk_1F5EF85A0;
  bambi::XmlTreeItem::~XmlTreeItem(this + 5);
  *this = &unk_1F5ED9B90;
  if (*(this + 31) < 0)
  {
    operator delete(this[1]);
  }
}

void sub_1E5153080(_Unwind_Exception *a1)
{
  *v2 = &unk_1F5ED9B90;
  if (*(v2 + 31) < 0)
  {
    operator delete(*(v2 + 8));
  }

  MEMORY[0x1E69235B0](v2, v1);
  _Unwind_Resume(a1);
}

void SipReferToHeader::~SipReferToHeader(SipReferToHeader *this)
{
  *this = &unk_1F5EE3838;
  SipUri::~SipUri((this + 104));
  *this = &unk_1F5EEE300;
  *(this + 8) = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(this + 72, *(this + 10));

  SipHeader::~SipHeader(this);
}

{
  *this = &unk_1F5EE3838;
  SipUri::~SipUri((this + 104));
  *this = &unk_1F5EEE300;
  *(this + 8) = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(this + 72, *(this + 10));
  SipHeader::~SipHeader(this);

  JUMPOUT(0x1E69235B0);
}

void ImsNetworkPathManager::ImsNetworkPathManager(ImsNetworkPathManager *this)
{
  *this = &unk_1F5EF8920;
  ims::SharedLoggable<ImsNetworkPathManager>::SharedLoggable(this + 1, "net");
  *this = &unk_1F5EF86C8;
  *(this + 1) = &unk_1F5EF86F8;
  *(this + 9) = 0;
  *(this + 10) = 0;
  *(this + 8) = 0;
  *(this + 7) = this + 64;
  v2 = dispatch_queue_create("com.apple.ipTelephony.eval", 0);
  v3 = *(this + 10);
  *(this + 10) = v2;
  if (v3)
  {
    dispatch_release(v3);
  }
}

void *ims::SharedLoggable<ImsNetworkPathManager>::SharedLoggable(void *a1, const char *a2)
{
  v5 = a2;
  ims::getQueue(&object);
  ctu::SharedLoggable<ImsNetworkPathManager,ctu::OsLogLogger>::SharedLoggable<char const(&)[22],char const*&>(a1 + 1, &object, "com.apple.ipTelephony", &v5);
  if (object)
  {
    dispatch_release(object);
  }

  *a1 = &unk_1F5EF8940;
  return a1;
}

void sub_1E51534E8(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, dispatch_object_t object)
{
  if (object)
  {
    dispatch_release(object);
  }

  _Unwind_Resume(exception_object);
}

void ImsNetworkPathManager::~ImsNetworkPathManager(ImsNetworkPathManager *this)
{
  *this = &unk_1F5EF86C8;
  *(this + 1) = &unk_1F5EF86F8;
  v2 = *(this + 10);
  if (v2)
  {
    dispatch_release(v2);
  }

  std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::destroy(*(this + 8));
  MEMORY[0x1E69225A0](this + 48);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 2);
}

{
  ImsNetworkPathManager::~ImsNetworkPathManager(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toImsNetworkPathManager::~ImsNetworkPathManager(ImsNetworkPathManager *this)
{
  ImsNetworkPathManager::~ImsNetworkPathManager((this - 8));
}

{
  ImsNetworkPathManager::~ImsNetworkPathManager((this - 8));

  JUMPOUT(0x1E69235B0);
}

void ImsNetworkPathManager::interfaceAvailable(uint64_t a1, uint64_t a2)
{
  memset(&v5, 0, sizeof(v5));
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v5, *a2, *(a2 + 8));
  }

  else
  {
    v5 = *a2;
  }

  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 1174405120;
  v3[2] = ___ZN21ImsNetworkPathManager18interfaceAvailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke;
  v3[3] = &__block_descriptor_tmp_64;
  v3[4] = a1;
  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v5.__r_.__value_.__l.__data_, v5.__r_.__value_.__l.__size_);
  }

  else
  {
    __p = v5;
  }

  dispatch_async(*(a1 + 80), v3);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v5.__r_.__value_.__l.__data_);
  }
}

void sub_1E51536FC(_Unwind_Exception *exception_object)
{
  if (*(v1 - 25) < 0)
  {
    operator delete(*(v1 - 48));
  }

  _Unwind_Resume(exception_object);
}

void ___ZN21ImsNetworkPathManager18interfaceAvailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = std::string::basic_string[abi:ne200100]<0>(block, "net");
  v39[0] = 0;
  v42 = 0;
  v4 = ims::debug(v3, v39);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "inteface ", 9);
  v5 = (a1 + 40);
  *(v4 + 17) = 0;
  (*(*v4 + 32))(v4, v5);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), " path satisified", 16);
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v42 == 1 && v41 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v44) < 0)
  {
    operator delete(block[0]);
  }

  v6 = *(v2 + 56);
  if (v6 != (v2 + 64))
  {
    do
    {
      v8 = v6 + 10;
      v7 = v6[10];
      if (!v7)
      {
        goto LABEL_51;
      }

      v9 = (v6 + 9);
      v10 = v6 + 10;
      do
      {
        v11 = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>((v7 + 32), v5);
        if ((v11 & 0x80u) == 0)
        {
          v10 = v7;
        }

        v7 = *(v7 + ((v11 >> 4) & 8));
      }

      while (v7);
      if (v10 == v8 || (std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v5, v10 + 4) & 0x80) != 0)
      {
        goto LABEL_51;
      }

      block[0] = v5;
      *(std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Interface>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Interface>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Interface>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>((v6 + 9), v5) + 72) = 1;
      v12 = *v9;
      if (*v9 == v8)
      {
        goto LABEL_34;
      }

      v13 = 1;
      do
      {
        v14 = std::string::basic_string[abi:ne200100]<0>(&v49, "net");
        LOBYTE(block[0]) = 0;
        LOBYTE(v48) = 0;
        v15 = ims::spam(v14, block);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "interface ", 10);
        *(v15 + 17) = 0;
        (*(*v15 + 32))(v15, v12 + 4);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), " is ", 4);
        *(v15 + 17) = 0;
        if (*(v12 + 72))
        {
          v16 = "satisfied";
        }

        else
        {
          v16 = "UNsatisfied";
        }

        if (*(v12 + 72))
        {
          v17 = 9;
        }

        else
        {
          v17 = 11;
        }

        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), v16, v17);
        *(v15 + 17) = 0;
        (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v15 + 17) = 0;
        if (v48 == 1 && SHIBYTE(v46) < 0)
        {
          operator delete(v44);
        }

        if (v50 < 0)
        {
          operator delete(v49);
        }

        v18 = *(v12 + 72);
        v19 = v12[1];
        if (v19)
        {
          do
          {
            v20 = v19;
            v19 = *v19;
          }

          while (v19);
        }

        else
        {
          do
          {
            v20 = v12[2];
            v21 = *v20 == v12;
            v12 = v20;
          }

          while (!v21);
        }

        v13 &= v18;
        v12 = v20;
      }

      while (v20 != v8);
      if (v13)
      {
LABEL_34:
        v22 = v6[7];
        v23 = v6[8];
        if (v23)
        {
          atomic_fetch_add_explicit(&v23->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        }

        v24 = std::string::basic_string[abi:ne200100]<0>(block, "net");
        v35[0] = 0;
        v38 = 0;
        v25 = ims::debug(v24, v35);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v25 + 8), "All interface paths satisfied for delegate!", 43);
        *(v25 + 17) = 0;
        (*(*v25 + 64))(v25, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v25 + 17) = 0;
        if (v38 == 1 && v37 < 0)
        {
          operator delete(v36);
        }

        if (SHIBYTE(v44) < 0)
        {
          operator delete(block[0]);
        }

        v33[0] = MEMORY[0x1E69E9820];
        v33[1] = 1174405120;
        v33[2] = ___ZN21ImsNetworkPathManager24handleInterfaceAvailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke;
        v33[3] = &__block_descriptor_tmp_9_1;
        v33[4] = v22;
        v34 = v23;
        if (v23)
        {
          atomic_fetch_add_explicit(&v23->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        }

        v26 = *(v2 + 24);
        if (!v26 || (v27 = *(v2 + 16), (v28 = std::__shared_weak_count::lock(v26)) == 0))
        {
          std::__throw_bad_weak_ptr[abi:ne200100]();
        }

        v29 = v28;
        v30 = *(v2 + 32);
        block[0] = MEMORY[0x1E69E9820];
        block[1] = 1174405120;
        v44 = ___ZNK3ctu20SharedSynchronizableI21ImsNetworkPathManagerE15execute_wrappedEU13block_pointerFvvE_block_invoke;
        v45 = &unk_1F5EF8960;
        v47 = v27;
        v48 = v29;
        atomic_fetch_add_explicit(&v29->__shared_owners_, 1uLL, memory_order_relaxed);
        v46 = v33;
        dispatch_async(v30, block);
        if (v48)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v48);
        }

        std::__shared_weak_count::__release_shared[abi:ne200100](v29);
        ImsNetworkPathManager::Evaluation::cleanup((v6 + 7));
        v31 = std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::erase((v2 + 56), v6);
        if (v34)
        {
          std::__shared_weak_count::__release_weak(v34);
        }

        if (v23)
        {
          std::__shared_weak_count::__release_weak(v23);
        }
      }

      else
      {
LABEL_51:
        v32 = v6[1];
        if (v32)
        {
          do
          {
            v31 = v32;
            v32 = *v32;
          }

          while (v32);
        }

        else
        {
          do
          {
            v31 = v6[2];
            v21 = *v31 == v6;
            v6 = v31;
          }

          while (!v21);
        }
      }

      v6 = v31;
    }

    while (v31 != (v2 + 64));
  }
}

void sub_1E5153C88(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, void *a24, uint64_t a25, int a26, __int16 a27, char a28, char a29, uint64_t a30, char a31, uint64_t a32, uint64_t a33, void *__p, uint64_t a35, int a36, __int16 a37, char a38, char a39, uint64_t a40, char a41)
{
  if (v41)
  {
    std::__shared_weak_count::__release_weak(v41);
  }

  _Unwind_Resume(exception_object);
}

void ImsNetworkPathManager::interfaceUnavailable(uint64_t a1, uint64_t a2)
{
  memset(&v5, 0, sizeof(v5));
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v5, *a2, *(a2 + 8));
  }

  else
  {
    v5 = *a2;
  }

  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 1174405120;
  v3[2] = ___ZN21ImsNetworkPathManager20interfaceUnavailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke;
  v3[3] = &__block_descriptor_tmp_5_5;
  v3[4] = a1;
  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v5.__r_.__value_.__l.__data_, v5.__r_.__value_.__l.__size_);
  }

  else
  {
    __p = v5;
  }

  dispatch_async(*(a1 + 80), v3);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v5.__r_.__value_.__l.__data_);
  }
}

void sub_1E5153E34(_Unwind_Exception *exception_object)
{
  if (*(v1 - 25) < 0)
  {
    operator delete(*(v1 - 48));
  }

  _Unwind_Resume(exception_object);
}

void ___ZN21ImsNetworkPathManager20interfaceUnavailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  std::string::basic_string[abi:ne200100]<0>(v18, "net");
  v25[0] = 0;
  v28 = 0;
  v3 = ims::error(v18, v25);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), "inteface ", 9);
  *(v3 + 17) = 0;
  (*(*v3 + 32))(v3, a1 + 40);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v3 + 8), " path failed!", 13);
  *(v3 + 17) = 0;
  (*(*v3 + 64))(v3, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v3 + 17) = 0;
  if (v28 == 1 && v27 < 0)
  {
    operator delete(__p);
  }

  if (SHIBYTE(v19) < 0)
  {
    operator delete(v18[0]);
  }

  v4 = *(v2 + 56);
  if (v4 != (v2 + 64))
  {
    while (1)
    {
      v5 = v4[10];
      if (!v5)
      {
        goto LABEL_18;
      }

      v6 = v4 + 10;
      do
      {
        v7 = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>((v5 + 32), (a1 + 40));
        if ((v7 & 0x80u) == 0)
        {
          v6 = v5;
        }

        v5 = *(v5 + ((v7 >> 4) & 8));
      }

      while (v5);
      if (v6 == v4 + 10 || (std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>((a1 + 40), v6 + 4) & 0x80) != 0)
      {
LABEL_18:
        v10 = v4[1];
        if (v10)
        {
          do
          {
            v11 = v10;
            v10 = *v10;
          }

          while (v10);
        }

        else
        {
          do
          {
            v11 = v4[2];
            v12 = *v11 == v4;
            v4 = v11;
          }

          while (!v12);
        }

        goto LABEL_41;
      }

      v9 = v4[7];
      v8 = v4[8];
      if (v8)
      {
        atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      }

      memset(&v24, 0, sizeof(v24));
      if (*(a1 + 63) < 0)
      {
        std::string::__init_copy_ctor_external(&v24, *(a1 + 40), *(a1 + 48));
      }

      else
      {
        v24 = *(a1 + 40);
      }

      v18[0] = MEMORY[0x1E69E9820];
      v18[1] = 1174405120;
      v19 = ___ZN21ImsNetworkPathManager26handleInterfaceUnavailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke;
      v20 = &__block_descriptor_tmp_11_2;
      v21 = v9;
      v22 = v8;
      if (v8)
      {
        atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      }

      if (SHIBYTE(v24.__r_.__value_.__r.__words[2]) < 0)
      {
        std::string::__init_copy_ctor_external(&v23, v24.__r_.__value_.__l.__data_, v24.__r_.__value_.__l.__size_);
      }

      else
      {
        v23 = v24;
      }

      v13 = *(v2 + 24);
      if (!v13 || (v14 = *(v2 + 16), (v15 = std::__shared_weak_count::lock(v13)) == 0))
      {
        std::__throw_bad_weak_ptr[abi:ne200100]();
      }

      v16 = v15;
      v17 = *(v2 + 32);
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 1174405120;
      block[2] = ___ZNK3ctu20SharedSynchronizableI21ImsNetworkPathManagerE15execute_wrappedEU13block_pointerFvvE_block_invoke;
      block[3] = &unk_1F5EF8960;
      block[5] = v14;
      v30 = v16;
      atomic_fetch_add_explicit(&v16->__shared_owners_, 1uLL, memory_order_relaxed);
      block[4] = v18;
      dispatch_async(v17, block);
      if (v30)
      {
        std::__shared_weak_count::__release_shared[abi:ne200100](v30);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v16);
      ImsNetworkPathManager::Evaluation::cleanup((v4 + 7));
      v11 = std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::erase((v2 + 56), v4);
      if (SHIBYTE(v23.__r_.__value_.__r.__words[2]) < 0)
      {
        operator delete(v23.__r_.__value_.__l.__data_);
      }

      if (v22)
      {
        std::__shared_weak_count::__release_weak(v22);
      }

      if (SHIBYTE(v24.__r_.__value_.__r.__words[2]) < 0)
      {
        break;
      }

      if (v8)
      {
        goto LABEL_40;
      }

LABEL_41:
      v4 = v11;
      if (v11 == (v2 + 64))
      {
        return;
      }
    }

    operator delete(v24.__r_.__value_.__l.__data_);
    if (!v8)
    {
      goto LABEL_41;
    }

LABEL_40:
    std::__shared_weak_count::__release_weak(v8);
    goto LABEL_41;
  }
}

void sub_1E51541F4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, uint64_t a19, std::__shared_weak_count *a20, uint64_t a21, uint64_t a22, uint64_t a23, void *__p, uint64_t a25, int a26, __int16 a27, char a28, char a29, uint64_t a30, uint64_t a31, void *a32, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, char a39)
{
  if (a20)
  {
    std::__shared_weak_count::__release_weak(a20);
  }

  if (a29 < 0)
  {
    operator delete(__p);
  }

  if (v39)
  {
    std::__shared_weak_count::__release_weak(v39);
  }

  _Unwind_Resume(exception_object);
}

void ___ZN21ImsNetworkPathManager24handleInterfaceAvailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 40);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(a1 + 32);
      if (v5)
      {
        (**v5)(v5);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

uint64_t __copy_helper_block_e8_32c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 40);
  *(result + 32) = *(a2 + 32);
  *(result + 40) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_32c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE(uint64_t a1)
{
  v1 = *(a1 + 40);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void ImsNetworkPathManager::Evaluation::cleanup(ImsNetworkPathManager::Evaluation *this)
{
  v2 = (this + 24);
  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(*(this + 3));
  *(this + 4) = 0;
  *v2 = 0;
  v3 = *(this + 1);
  *this = 0;
  *(this + 1) = 0;
  *(this + 2) = v2;
  if (v3)
  {

    std::__shared_weak_count::__release_weak(v3);
  }
}

void ___ZN21ImsNetworkPathManager26handleInterfaceUnavailableERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 40);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(a1 + 32);
      if (v5)
      {
        (*(*v5 + 8))(v5, a1 + 48);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void __copy_helper_block_e8_32c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE48c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE(std::string *a1, uint64_t a2)
{
  v2 = *(a2 + 40);
  a1[1].__r_.__value_.__l.__size_ = *(a2 + 32);
  a1[1].__r_.__value_.__r.__words[2] = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  if (*(a2 + 71) < 0)
  {
    std::string::__init_copy_ctor_external(a1 + 2, *(a2 + 48), *(a2 + 56));
  }

  else
  {
    v3 = *(a2 + 48);
    a1[2].__r_.__value_.__r.__words[2] = *(a2 + 64);
    *&a1[2].__r_.__value_.__l.__data_ = v3;
  }
}

void sub_1E5154484(_Unwind_Exception *exception_object)
{
  v3 = *(v1 + 40);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  _Unwind_Resume(exception_object);
}

void __destroy_helper_block_e8_32c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE48c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE(uint64_t a1)
{
  if (*(a1 + 71) < 0)
  {
    operator delete(*(a1 + 48));
  }

  v2 = *(a1 + 40);
  if (v2)
  {

    std::__shared_weak_count::__release_weak(v2);
  }
}

void ImsNetworkPathManager::evaluateInterface(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t *a4)
{
  memset(v15, 0, sizeof(v15));
  std::vector<std::string>::__init_with_size[abi:ne200100]<std::string*,std::string*>(v15, *a4, a4[1], 0xAAAAAAAAAAAAAAABLL * ((a4[1] - *a4) >> 3));
  memset(&v14, 0, sizeof(v14));
  if (*(a3 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v14, *a3, *(a3 + 8));
  }

  else
  {
    v14 = *a3;
  }

  v6 = std::string::basic_string[abi:ne200100]<0>(&v13, "net");
  v11[0] = 0;
  v12 = 0;
  v7 = ims::debug(v6, v11);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "Attempting to evaluate interfaces ", 34);
  *(v7 + 17) = 0;
  std::string::basic_string[abi:ne200100]<0>(&v10, " ");
  v8 = *a4;
  v9 = a4[1];
  ims::join<std::__wrap_iter<std::string const*>>();
}

void sub_1E51547AC(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, void *__p, uint64_t a16, int a17, __int16 a18, char a19, char a20, uint64_t a21, std::__shared_weak_count *a22, uint64_t a23, uint64_t a24, uint64_t a25, void *a26, uint64_t a27, int a28, __int16 a29, char a30, char a31, void *a32, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, uint64_t a39, void *a40, uint64_t a41, int a42, __int16 a43, char a44, char a45, uint64_t a46, char a47)
{
  if (*(v47 - 73) < 0)
  {
    operator delete(*(v47 - 96));
  }

  *(v47 - 96) = v47 - 72;
  std::vector<std::string>::__destroy_vector::operator()[abi:ne200100]((v47 - 96));
  _Unwind_Resume(a1);
}

void ___ZN21ImsNetworkPathManager17evaluateInterfaceENSt3__18weak_ptrI22ImsNetworkPathDelegateEERKNS0_12basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEERKNS0_6vectorIS9_NS7_IS9_EEEE_block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  ImsNetworkPathManager::abort_sync(v2, (a1 + 40));
  *v31 = 0u;
  v33[0] = 0;
  v33[1] = 0;
  v32 = v33;
  v4 = *(a1 + 64);
  v3 = *(a1 + 72);
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  v31[0] = v4;
  v31[1] = v3;
  v5 = *(a1 + 80);
  if (v5 != *(a1 + 88))
  {
    memset(&v25, 0, sizeof(v25));
    if (*(v5 + 23) < 0)
    {
      std::string::__init_copy_ctor_external(&v25, *v5, *(v5 + 1));
    }

    else
    {
      v6 = *v5;
      v25.__r_.__value_.__r.__words[2] = *(v5 + 2);
      *&v25.__r_.__value_.__l.__data_ = v6;
    }

    v7 = v2[3];
    if (v7)
    {
      v8 = v2[2];
      v9 = std::__shared_weak_count::lock(v7);
      if (v9)
      {
        v10 = v9;
        atomic_fetch_add_explicit(&v9->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        std::__shared_weak_count::__release_shared[abi:ne200100](v9);
        v29 = 0;
        v30 = 0;
        v11 = std::__shared_weak_count::lock(v10);
        v12 = v11;
        if (v11)
        {
          atomic_fetch_add_explicit(&v11->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        }

        else
        {
          v8 = 0;
        }

        v13 = v30;
        v29 = v8;
        v30 = v12;
        if (v13)
        {
          std::__shared_weak_count::__release_weak(v13);
        }

        std::__shared_weak_count::__release_weak(v10);
        if (v12)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v12);
        }

        ImsNetworkPathEvaluator::create(&v34);
      }
    }

    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  if (*(a1 + 63) < 0)
  {
    std::string::__init_copy_ctor_external(&v25, *(a1 + 40), *(a1 + 48));
  }

  else
  {
    v25 = *(a1 + 40);
  }

  v26[0] = v31[0];
  v26[1] = v31[1];
  if (v31[1])
  {
    atomic_fetch_add_explicit(&v31[1]->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  v28[0] = 0;
  v28[1] = 0;
  v27 = v28;
  v14 = v32;
  if (v32 != v33)
  {
    while (1)
    {
      v35 = 0;
      v15 = v28[0];
      if (v27 == v28)
      {
        break;
      }

      v16 = v28;
      if (v28[0])
      {
        do
        {
          v17 = v15;
          v15 = v15[1];
        }

        while (v15);
      }

      else
      {
        do
        {
          v17 = v16[2];
          v18 = *v17 == v16;
          v16 = v17;
        }

        while (v18);
      }

      if ((std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v17 + 4, v14 + 4) & 0x80) != 0)
      {
        if (!v28[0])
        {
LABEL_35:
          v35 = v28;
LABEL_36:
          operator new();
        }

        goto LABEL_31;
      }

      v19 = std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__find_equal<std::string>(&v27, &v35, v14 + 4);
LABEL_32:
      if (!*v19)
      {
        goto LABEL_36;
      }

      v20 = v14[1];
      if (v20)
      {
        do
        {
          v21 = v20;
          v20 = *v20;
        }

        while (v20);
      }

      else
      {
        do
        {
          v21 = v14[2];
          v18 = *v21 == v14;
          v14 = v21;
        }

        while (!v18);
      }

      v14 = v21;
      if (v21 == v33)
      {
        goto LABEL_43;
      }
    }

    v17 = v28;
    if (!v28[0])
    {
      goto LABEL_35;
    }

LABEL_31:
    v35 = v17;
    v19 = v17 + 1;
    goto LABEL_32;
  }

LABEL_43:
  v23 = v2 + 8;
  v22 = v2[8];
  if (!v22)
  {
    goto LABEL_49;
  }

  while (1)
  {
    while (1)
    {
      v24 = v22;
      if ((std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(&v25, (v22 + 32)) & 0x80) == 0)
      {
        break;
      }

      v22 = *v24;
      v23 = v24;
      if (!*v24)
      {
        goto LABEL_49;
      }
    }

    if ((std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(v24 + 4, &v25.__r_.__value_.__l.__data_) & 0x80) == 0)
    {
      break;
    }

    v23 = v24 + 1;
    v22 = v24[1];
    if (!v22)
    {
      goto LABEL_49;
    }
  }

  if (!*v23)
  {
LABEL_49:
    operator new();
  }

  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(v28[0]);
  if (v26[1])
  {
    std::__shared_weak_count::__release_weak(v26[1]);
  }

  if (SHIBYTE(v25.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v25.__r_.__value_.__l.__data_);
  }

  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(v33[0]);
  if (v31[1])
  {
    std::__shared_weak_count::__release_weak(v31[1]);
  }
}

uint64_t ImsNetworkPathManager::abort_sync(uint64_t result, void **a2)
{
  v2 = result + 64;
  v3 = *(result + 64);
  if (v3)
  {
    v5 = result + 64;
    do
    {
      result = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>((v3 + 32), a2);
      if ((result & 0x80u) == 0)
      {
        v5 = v3;
      }

      v3 = *(v3 + ((result >> 4) & 8));
    }

    while (v3);
    if (v5 != v2)
    {
      result = std::operator<=>[abi:ne200100]<char,std::char_traits<char>,std::allocator<char>>(a2, (v5 + 32));
      if ((result & 0x80) == 0)
      {
        std::string::basic_string[abi:ne200100]<0>(v11, "net");
        v7[0] = 0;
        v10 = 0;
        v6 = ims::error(v11, v7);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v6 + 8), "Aborting path evaluation for old interfaces", 43);
        *(v6 + 17) = 0;
        (*(*v6 + 64))(v6, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v6 + 17) = 0;
        if (v10 == 1 && v9 < 0)
        {
          operator delete(__p);
        }

        if (v12 < 0)
        {
          operator delete(v11[0]);
        }

        ImsNetworkPathManager::Evaluation::cleanup((v5 + 56));
        return std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::erase((v2 - 8), v5);
      }
    }
  }

  return result;
}

void sub_1E5154F40(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

uint64_t __copy_helper_block_e8_40c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE64c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE80c89_ZTSNSt3__16vectorINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEENS4_IS6_EEEE(uint64_t a1, uint64_t a2)
{
  if (*(a2 + 63) < 0)
  {
    std::string::__init_copy_ctor_external((a1 + 40), *(a2 + 40), *(a2 + 48));
  }

  else
  {
    v4 = *(a2 + 40);
    *(a1 + 56) = *(a2 + 56);
    *(a1 + 40) = v4;
  }

  v5 = *(a2 + 72);
  *(a1 + 64) = *(a2 + 64);
  *(a1 + 72) = v5;
  if (v5)
  {
    atomic_fetch_add_explicit((v5 + 16), 1uLL, memory_order_relaxed);
  }

  *(a1 + 80) = 0;
  *(a1 + 88) = 0;
  *(a1 + 96) = 0;
  return std::vector<std::string>::__init_with_size[abi:ne200100]<std::string*,std::string*>(a1 + 80, *(a2 + 80), *(a2 + 88), 0xAAAAAAAAAAAAAAABLL * ((*(a2 + 88) - *(a2 + 80)) >> 3));
}

void sub_1E5155004(_Unwind_Exception *exception_object)
{
  v3 = *(v1 + 72);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  if (*(v1 + 63) < 0)
  {
    operator delete(*(v1 + 40));
  }

  _Unwind_Resume(exception_object);
}

void __destroy_helper_block_e8_40c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE64c47_ZTSNSt3__18weak_ptrI22ImsNetworkPathDelegateEE80c89_ZTSNSt3__16vectorINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEENS4_IS6_EEEE(uint64_t a1)
{
  v3 = (a1 + 80);
  std::vector<std::string>::__destroy_vector::operator()[abi:ne200100](&v3);
  v2 = *(a1 + 72);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  if (*(a1 + 63) < 0)
  {
    operator delete(*(a1 + 40));
  }
}

void ImsNetworkPathManager::abort(uint64_t a1, uint64_t a2)
{
  memset(&v5, 0, sizeof(v5));
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v5, *a2, *(a2 + 8));
  }

  else
  {
    v5 = *a2;
  }

  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 1174405120;
  v3[2] = ___ZN21ImsNetworkPathManager5abortERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE_block_invoke;
  v3[3] = &__block_descriptor_tmp_17_2;
  v3[4] = a1;
  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, v5.__r_.__value_.__l.__data_, v5.__r_.__value_.__l.__size_);
  }

  else
  {
    __p = v5;
  }

  dispatch_async(*(a1 + 80), v3);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (SHIBYTE(v5.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v5.__r_.__value_.__l.__data_);
  }
}

void sub_1E5155178(_Unwind_Exception *exception_object)
{
  if (*(v1 - 25) < 0)
  {
    operator delete(*(v1 - 48));
  }

  _Unwind_Resume(exception_object);
}

uint64_t std::pair<std::string,ImsNetworkPathManager::Evaluation>::~pair(uint64_t a1)
{
  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(*(a1 + 48));
  v2 = *(a1 + 32);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  if (*(a1 + 23) < 0)
  {
    operator delete(*a1);
  }

  return a1;
}

void ImsNetworkPathManager::Evaluation::~Evaluation(ImsNetworkPathManager::Evaluation *this)
{
  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(*(this + 3));
  v2 = *(this + 1);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }
}

uint64_t std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Interface>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Interface>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Interface>>>::__emplace_unique_key_args<std::string,std::piecewise_construct_t const&,std::tuple<std::string const&>,std::tuple<>>(uint64_t a1, void **a2)
{
  v4 = 0;
  v2 = *std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::__find_equal<std::string>(a1, &v4, a2);
  if (!v2)
  {
    operator new();
  }

  return v2;
}

void *ctu::SharedLoggable<ImsNetworkPathManager,ctu::OsLogLogger>::SharedLoggable<char const(&)[22],char const*&>(void *a1, NSObject **a2, char *a3, const char **a4)
{
  *a1 = 0;
  a1[1] = 0;
  v7 = *a2;
  a1[2] = *a2;
  if (v7)
  {
    dispatch_retain(v7);
  }

  a1[3] = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 4), a3, *a4);
  return a1;
}

uint64_t ims::SharedLoggable<ImsNetworkPathManager>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));
  return a1;
}

void ims::SharedLoggable<ImsNetworkPathManager>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));

  JUMPOUT(0x1E69235B0);
}

void std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::destroy(void *a1)
{
  if (a1)
  {
    std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::destroy(*a1);
    std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::destroy(a1[1]);
    std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ImsNetworkPathManager::Evaluation>,void,0>((a1 + 4));

    operator delete(a1);
  }
}

void std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ImsNetworkPathManager::Evaluation>,void,0>(uint64_t a1)
{
  std::__tree<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::__map_value_compare<std::string,std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::shared_ptr<SipPreconditions::ForkStatus>>>>::destroy(*(a1 + 48));
  v2 = *(a1 + 32);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  if (*(a1 + 23) < 0)
  {
    v3 = *a1;

    operator delete(v3);
  }
}

uint64_t __copy_helper_block_e8_40c50_ZTSNSt3__110shared_ptrIK21ImsNetworkPathManagerEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c50_ZTSNSt3__110shared_ptrIK21ImsNetworkPathManagerEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }
}

uint64_t *std::__tree<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::__map_value_compare<std::string,std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>>>::erase(uint64_t **a1, uint64_t *a2)
{
  v3 = a2[1];
  if (v3)
  {
    do
    {
      v4 = v3;
      v3 = *v3;
    }

    while (v3);
  }

  else
  {
    v5 = a2;
    do
    {
      v4 = v5[2];
      v6 = *v4 == v5;
      v5 = v4;
    }

    while (!v6);
  }

  if (*a1 == a2)
  {
    *a1 = v4;
  }

  v7 = a1[1];
  a1[2] = (a1[2] - 1);
  std::__tree_remove[abi:ne200100]<std::__tree_node_base<void *> *>(v7, a2);
  std::allocator_traits<std::allocator<std::__tree_node<std::__value_type<std::string,ImsNetworkPathManager::Evaluation>,void *>>>::destroy[abi:ne200100]<std::pair<std::string const,ImsNetworkPathManager::Evaluation>,void,0>((a2 + 4));
  operator delete(a2);
  return v4;
}

void sub_1E5155620(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void SipRegistrationMode::logStr(SipRegistrationMode *this)
{
  v2 = 0;
  memset(v1, 0, sizeof(v1));
  ImsStringOutStream::ImsStringOutStream(v1);
}

void sub_1E5155780(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, char a11)
{
  if (a11 == 1)
  {
    if (a10)
    {
      (*(*a10 + 8))(a10);
    }
  }

  _Unwind_Resume(exception_object);
}

void __cxx_global_array_dtor_5()
{
  v0 = &byte_1EE2BBCAF;
  v1 = -144;
  v2 = &byte_1EE2BBCAF;
  do
  {
    v3 = *v2;
    v2 -= 24;
    if (v3 < 0)
    {
      operator delete(*(v0 - 23));
    }

    v0 = v2;
    v1 += 24;
  }

  while (v1);
}

uint64_t _GLOBAL__sub_I_SipRegistrationMode_cpp()
{
  result = __cxa_atexit(__cxx_global_array_dtor_5, 0, &dword_1E4C3F000);
  SipRegistrationMode::kModeNormal = 0;
  SipRegistrationMode::kModeLimitedAccess = 1;
  SipRegistrationMode::kModeEmergency = 2;
  SipRegistrationMode::kModeDisabled = 3;
  SipRegistrationMode::kModeDisabledCountry = 4;
  SipRegistrationMode::kModeReprovision = 5;
  return result;
}

void SipPrivateTokenAuthResponse::SipPrivateTokenAuthResponse(SipPrivateTokenAuthResponse *this, SipPrivateTokenAuthScheme *a2)
{
  *(this + 40) = 0u;
  *(this + 24) = 0u;
  *(this + 8) = 0u;
  *this = &unk_1F5EF89A0;
  *(this + 7) = 0u;
  *(this + 8) = 0u;
  *(this + 9) = 0u;
  *(this + 8) = 0;
  *(this + 9) = &unk_1F5EBDEF8;
  *(this + 10) = &_bambiDomain;
  *(this + 22) = 0;
  *(this + 12) = 0;
  *(this + 13) = 0;
  if (!a2)
  {
    operator new();
  }

  *(this + 8) = a2;
}

void sub_1E5155988(_Unwind_Exception *a1)
{
  ImsResult::~ImsResult(v2);
  SipAuthResponse::~SipAuthResponse(v1);
  _Unwind_Resume(a1);
}

void SipPrivateTokenAuthResponse::~SipPrivateTokenAuthResponse(SipPrivateTokenAuthResponse *this)
{
  *this = &unk_1F5EF89A0;
  v2 = *(this + 8);
  if (v2)
  {
    (*(*v2 + 24))(v2);
  }

  ImsResult::~ImsResult((this + 72));

  SipAuthResponse::~SipAuthResponse(this);
}

{
  SipPrivateTokenAuthResponse::~SipPrivateTokenAuthResponse(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t SipPrivateTokenAuthResponse::scheme(SipPrivateTokenAuthResponse *this)
{
  return *(this + 8);
}

{
  return *(this + 8);
}

uint64_t SipPrivateTokenAuthResponse::computeResponse()
{
  return 1;
}

{
  return 1;
}

uint64_t SipRegistrationNotification::SipRegistrationNotification(uint64_t a1, uint64_t *a2, uint64_t a3)
{
  *a1 = &unk_1F5EF8B20;
  *(a1 + 24) = 1;
  *(a1 + 32) = 0;
  *(a1 + 40) = 0;
  v5 = *a2;
  v6 = a2[1];
  if (v6)
  {
    atomic_fetch_add_explicit((v6 + 16), 1uLL, memory_order_relaxed);
    v7 = *(a1 + 40);
    *(a1 + 32) = v5;
    *(a1 + 40) = v6;
    if (v7)
    {
      std::__shared_weak_count::__release_weak(v7);
    }
  }

  else
  {
    *(a1 + 40) = 0;
    *(a1 + 32) = v5;
  }

  v8 = time(0);
  if ((a3 + 1) >= 2)
  {
    v9 = v8;
  }

  else
  {
    v9 = 0;
  }

  *(a1 + 8) = v8;
  *(a1 + 16) = v9 + a3;
  return a1;
}

void sub_1E5155C54(_Unwind_Exception *exception_object)
{
  if (*v1)
  {
    std::__shared_weak_count::__release_weak(*v1);
  }

  _Unwind_Resume(exception_object);
}

uint64_t SipRegistrationNotification::SipRegistrationNotification(uint64_t a1, uint64_t a2)
{
  *a1 = &unk_1F5EF8B20;
  *(a1 + 24) = 1;
  *(a1 + 32) = 0;
  *(a1 + 40) = 0;
  v4 = *(a2 + 32);
  v5 = *(a2 + 40);
  if (v5)
  {
    atomic_fetch_add_explicit((v5 + 16), 1uLL, memory_order_relaxed);
    v6 = *(a1 + 40);
    *(a1 + 32) = v4;
    *(a1 + 40) = v5;
    if (v6)
    {
      std::__shared_weak_count::__release_weak(v6);
    }
  }

  else
  {
    *(a1 + 32) = v4;
    *(a1 + 40) = 0;
  }

  *(a1 + 8) = *(a2 + 8);
  return a1;
}

time_t SipRegistrationNotification::secondsUntilNextRetry(SipRegistrationNotification *this)
{
  result = *(this + 2);
  if ((result + 1) >= 2)
  {
    v3 = time(0);
    v4 = *(this + 2);
    v5 = v4 < v3;
    v6 = v4 - v3;
    if (v5)
    {
      return 0;
    }

    else
    {
      return v6;
    }
  }

  return result;
}

uint64_t SipRegistrationNotification::isEmergency(SipRegistrationNotification *this)
{
  v2 = *(this + 5);
  if (!v2)
  {
    return 0;
  }

  v3 = std::__shared_weak_count::lock(v2);
  if (!v3)
  {
    return 0;
  }

  v4 = v3;
  v5 = *(this + 4);
  if (v5)
  {
    v6 = (*(*v5 + 288))(v5);
  }

  else
  {
    v6 = 0;
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  return v6;
}

uint64_t SipRegistrationNotification::isInitialRegistration(SipRegistrationNotification *this)
{
  v2 = *(this + 5);
  if (v2 && (v3 = std::__shared_weak_count::lock(v2)) != 0)
  {
    v4 = *(this + 4);
    if (v4 && (v5 = *(v4 + 3840)) != 0)
    {
      v6 = *(v5 + 220);
    }

    else
    {
      v6 = 0;
    }

    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  else
  {
    v6 = 0;
  }

  return v6 & 1;
}

void SipRegistrationStateNotification::SipRegistrationStateNotification(void *a1, uint64_t *a2, uint64_t a3)
{
  v4 = a2[1];
  v5[0] = *a2;
  v5[1] = v4;
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  SipRegistrationNotification::SipRegistrationNotification(a1, v5, a3);
  if (v4)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  }

  *a1 = &unk_1F5EF8A20;
  operator new();
}

void sub_1E5155EDC(_Unwind_Exception *a1)
{
  MEMORY[0x1E69235B0](v2, 0x10B3C40A119BF27);
  *v1 = &unk_1F5EF8B20;
  v4 = v1[5];
  if (v4)
  {
    std::__shared_weak_count::__release_weak(v4);
  }

  _Unwind_Resume(a1);
}

void sub_1E5155FC0(_Unwind_Exception *a1)
{
  MEMORY[0x1E69235B0](v2, 0x10B3C40A119BF27);
  *v1 = &unk_1F5EF8B20;
  v4 = v1[5];
  if (v4)
  {
    std::__shared_weak_count::__release_weak(v4);
  }

  _Unwind_Resume(a1);
}

void SipRegistrationStateNotification::~SipRegistrationStateNotification(SipRegistrationStateNotification *this)
{
  *this = &unk_1F5EF8A20;
  v2 = *(this + 6);
  if (v2)
  {
    (*(*v2 + 8))(v2);
  }

  *this = &unk_1F5EF8B20;
  v3 = *(this + 5);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }
}

void SipRegistrationActiveNotification::SipRegistrationActiveNotification(void *a1, uint64_t *a2)
{
  v2 = a2[1];
  v3[0] = *a2;
  v3[1] = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  SipRegistrationStateNotification::SipRegistrationStateNotification(a1, v3, 0);
}

void sub_1E51561F8(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  _Unwind_Resume(exception_object);
}

void SipRegistrationActiveNotification::notifyDelegate(SipRegistrationActiveNotification *this)
{
  v2 = *(this + 5);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 4);
      if (v5)
      {
        SipRegistrationClient::notifyDelegateOfRegistrationActive(v5, this);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void SipRegistrationTerminatedNotification::SipRegistrationTerminatedNotification(void *a1, uint64_t *a2)
{
  v2 = a2[1];
  v3[0] = *a2;
  v3[1] = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  SipRegistrationStateNotification::SipRegistrationStateNotification(a1, v3, -1);
}

void sub_1E51563B0(_Unwind_Exception *a1)
{
  v3 = *(v1 + 9);
  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  SipRegistrationStateNotification::~SipRegistrationStateNotification(v1);
  _Unwind_Resume(a1);
}

void SipRegistrationTerminatedNotification::notifyDelegate(SipRegistrationTerminatedNotification *this, char a2)
{
  v3 = *(this + 5);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(this + 4);
      if (v7)
      {
        SipRegistrationClient::notifyDelegateOfRegistrationTermination(v7, this, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

uint64_t SipRegistrationTerminatedNotification::shouldNotifyDelegate(SipRegistrationTerminatedNotification *this)
{
  if (*(this + 24) == 1)
  {
    v1 = *(this + 81) ^ 1;
  }

  else
  {
    v1 = 0;
  }

  return v1 & 1;
}

uint64_t SipRegistrationErrorNotification::SipRegistrationErrorNotification(uint64_t a1, uint64_t *a2, uint64_t a3, uint64_t a4)
{
  v6 = a2[1];
  v11[0] = *a2;
  v11[1] = v6;
  if (v6)
  {
    atomic_fetch_add_explicit(&v6->__shared_owners_, 1uLL, memory_order_relaxed);
  }

  SipRegistrationNotification::SipRegistrationNotification(a1, v11, a3);
  if (v6)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v6);
  }

  *a1 = &unk_1F5EF8AE0;
  *(a1 + 48) = *a4;
  ImsResult::ImsResult((a1 + 64), (a4 + 16));
  v7 = *(a4 + 104);
  *(a1 + 160) = *(a4 + 112);
  *(a1 + 152) = v7;
  if (*(a4 + 143) < 0)
  {
    std::string::__init_copy_ctor_external((a1 + 168), *(a4 + 120), *(a4 + 128));
  }

  else
  {
    v8 = *(a4 + 120);
    *(a1 + 184) = *(a4 + 136);
    *(a1 + 168) = v8;
  }

  if (*(a4 + 167) < 0)
  {
    std::string::__init_copy_ctor_external((a1 + 192), *(a4 + 144), *(a4 + 152));
  }

  else
  {
    v9 = *(a4 + 144);
    *(a1 + 208) = *(a4 + 160);
    *(a1 + 192) = v9;
  }

  *(a1 + 216) = *(a4 + 168);
  return a1;
}

void sub_1E5156620(_Unwind_Exception *a1)
{
  if (*(v1 + 191) < 0)
  {
    operator delete(*(v1 + 168));
  }

  ImsResult::~ImsResult((v1 + 64));
  *v1 = &unk_1F5EF8B20;
  v3 = *(v1 + 40);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  _Unwind_Resume(a1);
}

void SipRegistrationErrorNotification::SipRegistrationErrorNotification(SipRegistrationErrorNotification *this, const SipRegistrationErrorNotification *a2)
{
  v4 = SipRegistrationNotification::SipRegistrationNotification(this, a2);
  *v4 = &unk_1F5EF8AE0;
  *(v4 + 48) = *(a2 + 3);
  ImsResult::ImsResult((v4 + 64), (a2 + 64));
  v5 = *(a2 + 19);
  *(this + 160) = *(a2 + 160);
  *(this + 19) = v5;
  if (*(a2 + 191) < 0)
  {
    std::string::__init_copy_ctor_external(this + 7, *(a2 + 21), *(a2 + 22));
  }

  else
  {
    v6 = *(a2 + 168);
    *(this + 23) = *(a2 + 23);
    *(this + 168) = v6;
  }

  if (*(a2 + 215) < 0)
  {
    std::string::__init_copy_ctor_external(this + 8, *(a2 + 24), *(a2 + 25));
  }

  else
  {
    v7 = *(a2 + 12);
    *(this + 26) = *(a2 + 26);
    *(this + 12) = v7;
  }

  *(this + 216) = *(a2 + 216);
}

void sub_1E5156754(_Unwind_Exception *a1)
{
  if (*(v1 + 191) < 0)
  {
    operator delete(*(v1 + 168));
  }

  ImsResult::~ImsResult((v1 + 64));
  *v1 = &unk_1F5EF8B20;
  v3 = *(v1 + 40);
  if (v3)
  {
    std::__shared_weak_count::__release_weak(v3);
  }

  _Unwind_Resume(a1);
}

void SipRegistrationErrorNotification::notifyDelegate(SipRegistrationErrorNotification *this, char a2)
{
  v3 = *(this + 5);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(this + 4);
      if (v7)
      {
        SipRegistrationClient::notifyDelegateOfRegistrationError(v7, this, a2, 0);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

uint64_t _GLOBAL__sub_I_SipRegistrationNotification_cpp()
{
  v29 = *MEMORY[0x1E69E9840];
  std::string::basic_string[abi:ne200100]<0>(v3, "RegistrationExpired");
  std::string::basic_string[abi:ne200100]<0>(v4, "NotifyRequest");
  std::string::basic_string[abi:ne200100]<0>(v5, "PcscfRestoration");
  std::string::basic_string[abi:ne200100]<0>(v6, "SuccessfulDeregistration");
  std::string::basic_string[abi:ne200100]<0>(v7, "FailedDeregistration");
  std::string::basic_string[abi:ne200100]<0>(v8, "TransactionErrorRequiringRegistration");
  std::string::basic_string[abi:ne200100]<0>(v9, "TransactionErrorRequiringCSFB");
  std::string::basic_string[abi:ne200100]<0>(v10, "SRVCC");
  std::string::basic_string[abi:ne200100]<0>(v11, "RegistrationTimeoutOverIPSec");
  std::string::basic_string[abi:ne200100]<0>(v12, "ServiceUnavailable");
  std::string::basic_string[abi:ne200100]<0>(v13, "LimitedAccessMode");
  std::string::basic_string[abi:ne200100]<0>(v14, "DisabledMode");
  std::string::basic_string[abi:ne200100]<0>(v15, "SystemClockChange");
  std::string::basic_string[abi:ne200100]<0>(v16, "DisabledCountryMode");
  std::string::basic_string[abi:ne200100]<0>(v17, "AirplaneModeToggled");
  std::string::basic_string[abi:ne200100]<0>(v18, "TlsConnectionLost");
  std::string::basic_string[abi:ne200100]<0>(v19, "IPSecTransportExpiration");
  std::string::basic_string[abi:ne200100]<0>(v20, "ConnectivityReset");
  std::string::basic_string[abi:ne200100]<0>(v21, "CallFailure");
  std::string::basic_string[abi:ne200100]<0>(v22, "ProxyRedirect");
  std::string::basic_string[abi:ne200100]<0>(v23, "EmergencyRedial");
  std::string::basic_string[abi:ne200100]<0>(v24, "NoLegacyFallback");
  std::string::basic_string[abi:ne200100]<0>(v25, "OutOfServiceExpiration");
  std::string::basic_string[abi:ne200100]<0>(v26, "LazuliTlsConnectionLost");
  std::string::basic_string[abi:ne200100]<0>(v27, "LazuliTcpConnectionLost");
  std::string::basic_string[abi:ne200100]<0>(v28, "CrlfPingPongTimeout");
  _terminationReasonStrings = 0;
  *algn_1EE2BD548 = 0;
  qword_1EE2BD550 = 0;
  std::vector<std::string>::__init_with_size[abi:ne200100]<std::string const*,std::string const*>(&_terminationReasonStrings, v3, &v29, 0x1AuLL);
  v0 = 624;
  do
  {
    if (v3[v0 - 1] < 0)
    {
      operator delete(*&v3[v0 - 24]);
    }

    v0 -= 24;
  }

  while (v0);
  result = __cxa_atexit(std::vector<std::string>::~vector[abi:ne200100], &_terminationReasonStrings, &dword_1E4C3F000);
  v2 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_1E5156F2C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, char a10)
{
  v12 = (v10 + 623);
  v13 = -624;
  v14 = v12;
  while (1)
  {
    v15 = *v14;
    v14 -= 24;
    if (v15 < 0)
    {
      operator delete(*(v12 - 23));
    }

    v12 = v14;
    v13 += 24;
    if (!v13)
    {
      _Unwind_Resume(exception_object);
    }
  }
}

void ClientConfig::initFromConfig(uint64_t a1, uint64_t a2)
{
  *&v8 = a2;
  *(&v8 + 1) = "kClientSlot";
  xpc::dict::object_proxy::operator xpc::object(&v8, object);
  *a1 = xpc::dyn_cast_or_default(object, 1);
  xpc_release(object[0]);
  *&v8 = a2;
  *(&v8 + 1) = "kClientPurpose";
  xpc::dict::object_proxy::operator xpc::object(&v8, object);
  *(a1 + 4) = xpc::dyn_cast_or_default(object, 0);
  xpc_release(object[0]);
  *&v8 = a2;
  *(&v8 + 1) = "kClientGeneration";
  xpc::dict::object_proxy::operator xpc::object(&v8, object);
  *(a1 + 8) = xpc::dyn_cast_or_default(object, 1);
  xpc_release(object[0]);
  v6[0] = a2;
  v6[1] = "kMlsHomeKdsId";
  xpc::dict::object_proxy::operator xpc::object(v6, &v7);
  object[0] = 0;
  object[1] = 0;
  v5 = 0;
  xpc::dyn_cast_or_default();
  if (*(a1 + 39) < 0)
  {
    operator delete(*(a1 + 16));
  }

  *(a1 + 16) = v8;
  *(a1 + 32) = v9;
  HIBYTE(v9) = 0;
  LOBYTE(v8) = 0;
  if (SHIBYTE(v5) < 0)
  {
    operator delete(object[0]);
  }

  xpc_release(v7);
  *&v8 = a2;
  *(&v8 + 1) = "kIsThirdPartyApp";
  xpc::dict::object_proxy::operator xpc::object(&v8, object);
  *(a1 + 40) = xpc::dyn_cast_or_default(object, 0);
  xpc_release(object[0]);
}

const char *audio::asString(unsigned int a1)
{
  if (a1 > 0x13)
  {
    return "???";
  }

  else
  {
    return off_1E876CBE0[a1];
  }
}

void XcapCallForwardManager::_fetchCallForward(uint64_t a1, unsigned int a2)
{
  if ((*(a1 + 360) & 1) != 0 || a2 <= 6 && ((1 << a2) & 0x64) != 0)
  {
    operator new();
  }

  std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::find<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>(a1 + 384, a2, 0);
  operator new();
}

void sub_1E5157314(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, ...)
{
  va_start(va, a8);
  XcapNodeSelector::~XcapNodeSelector(va);
  MEMORY[0x1E69235B0](v9, v8);
  _Unwind_Resume(a1);
}

void XcapCallForwardManager::setCallForward(uint64_t a1, uint64_t a2, int a3, std::string *a4, int a5)
{
  v20 = 0;
  memset(v19, 0, sizeof(v19));
  SipUri::SipUri(v19, a4);
  if (SipUri::needsPhoneContext(v19))
  {
    SipUri::setPhoneContext(v19, a1 + 64);
  }

  if (!*(a1 + 400))
  {
    std::string::basic_string[abi:ne200100]<0>(v17, kXcapLoggingFacility);
    v13[0] = 0;
    v16 = 0;
    v9 = ims::info(v17, v13);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), ": ", 2);
    *(v9 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "No Rule-Ids. Perform GET before PUT", 35);
    *(v9 + 17) = 0;
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v9 + 17) = 0;
    if (v16 == 1 && v15 < 0)
    {
      operator delete(__p);
    }

    if (v18 < 0)
    {
      operator delete(v17[0]);
    }

    v11 = a2;
    v12 = a3;
    SipUri::SipUri(v10, v19);
    v10[102] = a5;
    XcapCallForwardManager::_fetchCallForward(a1, 5u);
  }

  XcapCallForwardManager::_setCallForward(a1, a2, a3, v19, a5);
  SipUri::~SipUri(v19);
}

void sub_1E5157558(_Unwind_Exception *a1)
{
  SipUri::~SipUri((v1 + 48));
  SipUri::~SipUri(&STACK[0x220]);
  _Unwind_Resume(a1);
}

void XcapCallForwardManager::_setCallForward(uint64_t a1, uint64_t a2, int a3, uint64_t a4, int a5)
{
  v9 = 0;
  v10 = 0;
  v11 = 0;
  XcapCallForwardManager::CallForwardInfo::fetchMappedConditions(&v9, (a1 + 376), a3);
  if ((*(a1 + 361) & 1) != 0 || !*(a1 + 400))
  {
    memset(v8, 0, sizeof(v8));
    std::vector<XcapCDCondition::Condition>::__init_with_size[abi:ne200100]<XcapCDCondition::Condition*,XcapCDCondition::Condition*>(v8, v9, v10, v10 - v9);
    *&v13 = 0;
    memset(v12, 0, sizeof(v12));
    XcapCallForwardManager::_generateNodeSelectorForCFDoc(v12);
  }

  if (v9 != v10)
  {
    v7 = *v9;
    v16 = 0;
    v14 = 0u;
    v15 = 0u;
    XcapCallForwardManager::_generateNodeSelectorForCFRule(&v14);
  }

  if (a5)
  {
    v16 = 0;
    v14 = 0u;
    v15 = 0u;
    XcapNodeSelector::XcapNodeSelector(&v14);
  }

  if (v9)
  {
    operator delete(v9);
  }
}

void sub_1E5157BAC(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, void *a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, void *a17, uint64_t a18, int a19, __int16 a20, char a21, char a22, uint64_t a23, char a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, uint64_t a33, uint64_t a34, uint64_t a35, uint64_t a36, void *a37, uint64_t a38, int a39, __int16 a40, char a41, char a42)
{
  if (*(v43 - 153) < 0)
  {
    operator delete(*(v43 - 176));
  }

  MEMORY[0x1E69235B0](v42, 0x10B2C409DA9FE99);
  bambi::XmlTreeItem::~XmlTreeItem(&a25);
  XcapNodeSelector::~XcapNodeSelector((v43 - 144));
  if (__p)
  {
    operator delete(__p);
  }

  _Unwind_Resume(a1);
}

void XcapCallForwardManager::activateCallForward(uint64_t a1, uint64_t a2, int a3)
{
  if (!*(a1 + 400))
  {
    v4 = std::string::basic_string[abi:ne200100]<0>(&v10, kXcapLoggingFacility);
    v6[0] = 0;
    v9 = 0;
    v5 = ims::info(v4, v6);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), ": ", 2);
    *(v5 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v5 + 8), "No Rule-Ids. Perform GET before PUT", 35);
    *(v5 + 17) = 0;
    (*(*v5 + 64))(v5, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v5 + 17) = 0;
    if (v9 == 1 && v8 < 0)
    {
      operator delete(__p);
    }

    if (v11 < 0)
    {
      operator delete(v10);
    }

    XcapCallForwardManager::_fetchCallForward(a1, 5u);
  }

  XcapCallForwardManager::_setCallForwardActivationMode(a1, a3);
}

void sub_1E5157F1C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, void *__p, uint64_t a20, int a21, __int16 a22, char a23, char a24, uint64_t a25, char a26)
{
  if (a26 == 1 && a24 < 0)
  {
    operator delete(__p);
  }

  if (*(v26 - 49) < 0)
  {
    operator delete(*(v26 - 72));
  }

  _Unwind_Resume(exception_object);
}

void ___ZN22XcapCallForwardManager19activateCallForwardEbN15XcapCDCondition9ConditionEU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1)
{
  v1 = *(a1 + 49);
  v2 = *(a1 + 32);
  XcapCallForwardManager::_setCallForwardActivationMode(*(a1 + 40), *(a1 + 48));
}

void XcapCallForwardManager::_setCallForwardActivationMode(uint64_t a1, int a2)
{
  v5 = 0;
  v6 = 0;
  v7 = 0;
  XcapCallForwardManager::CallForwardInfo::fetchMappedConditions(&v5, (a1 + 376), a2);
  if ((*(a1 + 361) & 1) != 0 || !*(a1 + 400))
  {
    memset(v4, 0, sizeof(v4));
    std::vector<XcapCDCondition::Condition>::__init_with_size[abi:ne200100]<XcapCDCondition::Condition*,XcapCDCondition::Condition*>(v4, v5, v6, v6 - v5);
    v10 = 0;
    v8 = 0u;
    v9 = 0u;
    XcapCallForwardManager::_generateNodeSelectorForCFDoc(&v8);
  }

  if (v5 != v6)
  {
    v3 = *v5;
    v10 = 0;
    v8 = 0u;
    v9 = 0u;
    XcapCallForwardManager::_generateNodeSelectorForCFRule(&v8);
  }

  if (v5)
  {
    operator delete(v5);
  }
}

void sub_1E5158410(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, int a20, __int16 a21, char a22, char a23, uint64_t a24, uint64_t a25, void *a26, uint64_t a27, int a28, __int16 a29, char a30, char a31, void *__p, uint64_t a33, int a34, __int16 a35, char a36, char a37, uint64_t a38, std::__shared_weak_count *a39)
{
  MEMORY[0x1E69235B0](v39, 0x10B2C409DA9FE99);
  if (a37 < 0)
  {
    operator delete(__p);
  }

  if (a39)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a39);
  }

  XcapNodeSelector::~XcapNodeSelector((v41 - 160));
  if (a12)
  {
    operator delete(a12);
  }

  if (v40)
  {
    operator delete(v40);
  }

  _Unwind_Resume(a1);
}

void XcapCallForwardManager::_generateNodeSelectorForCFDoc(XcapCallForwardManager *this)
{
  *(this + 4) = 0;
  *this = 0u;
  *(this + 1) = 0u;
  XcapNodeSelector::XcapNodeSelector(this);
}

void XcapCallForwardManager::_generateNodeSelectorForCFRule(uint64_t a1)
{
  *(a1 + 32) = 0;
  *a1 = 0u;
  *(a1 + 16) = 0u;
  XcapNodeSelector::XcapNodeSelector(a1);
}

void sub_1E5158694(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (a15 < 0)
  {
    operator delete(__p);
  }

  XcapNodeSelector::~XcapNodeSelector(v15);
  _Unwind_Resume(a1);
}

void ___ZN22XcapCallForwardManager17_fetchCallForwardEN15XcapCDCondition9ConditionEU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, uint64_t a2)
{
  v6 = *(a1 + 40);
  if (((*(**(a2 + 8) + 24))(*(a2 + 8), *(a2 + 16)) & 1) == 0)
  {
    v4 = *(a1 + 48);
    operator new();
  }

  v5 = *(a1 + 32);
  ImsResult::ImsResult(v7, a2);
  (*(v5 + 16))(v5, v7, 0);
  ImsResult::~ImsResult(v7);
}

void XcapCallForwardManager::CallForwardInfo::fetchMappedConditions(void *a1, void *a2, int a3)
{
  v13 = a3;
  a1[1] = 0;
  a1[2] = 0;
  *a1 = 0;
  if ((a3 - 5) > 1)
  {
    std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, &v13);
    if (a3 == 3 && a2 + 2 != std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::find<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>((a2 + 1), 3u, 0) && a2 + 2 != std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::find<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>((a2 + 1), 4u, 0))
    {
      LOBYTE(__p[0]) = 4;
      std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    }
  }

  else if (a2[3])
  {
    v6 = a2[1];
    v7 = a2 + 2;
    if (v6 != a2 + 2)
    {
      do
      {
        memset(__p, 0, 32);
        LOWORD(v8) = *(v6 + 16);
        LOWORD(__p[0]) = v8;
        if (*(v6 + 63) < 0)
        {
          std::string::__init_copy_ctor_external(&__p[1], v6[5], v6[6]);
          v8 = LOBYTE(__p[0]);
        }

        else
        {
          v8 = v8;
          *&__p[1] = *(v6 + 5);
          __p[3] = *(v6 + 7);
        }

        if (a3 != 6 || v8)
        {
          std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
        }

        if (SHIBYTE(__p[3]) < 0)
        {
          operator delete(__p[1]);
        }

        v9 = v6[1];
        if (v9)
        {
          do
          {
            v10 = v9;
            v9 = *v9;
          }

          while (v9);
        }

        else
        {
          do
          {
            v10 = v6[2];
            v11 = *v10 == v6;
            v6 = v10;
          }

          while (!v11);
        }

        v6 = v10;
      }

      while (v10 != v7);
    }
  }

  else
  {
    LOBYTE(__p[0]) = 1;
    std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    LOBYTE(__p[0]) = 2;
    std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    LOBYTE(__p[0]) = 3;
    std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    LOBYTE(__p[0]) = 4;
    std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    if (a3 == 5)
    {
      LOBYTE(__p[0]) = 0;
      std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](a1, __p);
    }
  }
}

void sub_1E5158F90(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  v17 = *v15;
  if (*v15)
  {
    *(v15 + 8) = v17;
    operator delete(v17);
  }

  _Unwind_Resume(exception_object);
}

void sub_1E51590AC(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15)
{
  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  }

  _Unwind_Resume(exception_object);
}

void ___ZN22XcapCallForwardManager21_setCallForwardForDocEbNSt3__16vectorIN15XcapCDCondition9ConditionENS0_9allocatorIS3_EEEERK6SipUriiU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, const ImsResult *a2)
{
  v2 = *(a1 + 32);
  ImsResult::ImsResult(v3, a2);
  (*(v2 + 16))(v2, v3, 0);
  ImsResult::~ImsResult(v3);
}

void sub_1E5159140(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void ___ZN22XcapCallForwardManager22_setCallForwardForRuleEbN15XcapCDCondition9ConditionERK6SipUriU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, const ImsResult *a2)
{
  v2 = *(a1 + 32);
  ImsResult::ImsResult(v3, a2);
  (*(v2 + 16))(v2, v3, 0);
  ImsResult::~ImsResult(v3);
}

void sub_1E51591A4(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void ___ZN22XcapCallForwardManager35_setCallForwardActivationModeForDocENSt3__16vectorIN15XcapCDCondition9ConditionENS0_9allocatorIS3_EEEEbU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, const ImsResult *a2)
{
  v2 = *(a1 + 32);
  ImsResult::ImsResult(v3, a2);
  (*(v2 + 16))(v2, v3, 0);
  ImsResult::~ImsResult(v3);
}

void sub_1E5159208(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void ___ZN22XcapCallForwardManager36_setCallForwardActivationModeForRuleEN15XcapCDCondition9ConditionEbU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, const ImsResult *a2)
{
  v2 = *(a1 + 32);
  ImsResult::ImsResult(v3, a2);
  (*(v2 + 16))(v2, v3, 0);
  ImsResult::~ImsResult(v3);
}

void sub_1E515926C(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void ___ZN22XcapCallForwardManager27_setCallForwardNoReplyTimerEiU13block_pointerFv9ImsResultPK16XcapDocumentBaseE_block_invoke(uint64_t a1, const ImsResult *a2)
{
  v2 = *(a1 + 32);
  ImsResult::ImsResult(v3, a2);
  (*(v2 + 16))(v2, v3, 0);
  ImsResult::~ImsResult(v3);
}

void sub_1E51592D0(_Unwind_Exception *a1, uint64_t a2, ...)
{
  va_start(va, a2);
  ImsResult::~ImsResult(va);
  _Unwind_Resume(a1);
}

void XcapCallForwardManager::CallForwardInfo::fetchRuleIdOrDefaultForCondition(std::string *a1, uint64_t a2, __int16 a3)
{
  a1->__r_.__value_.__r.__words[0] = 0;
  a1->__r_.__value_.__l.__size_ = 0;
  a1->__r_.__value_.__r.__words[2] = 0;
  v6 = std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::find<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>(a2 + 8, a3, HIBYTE(a3));
  if (a2 + 16 != v6)
  {
    std::string::operator=(a1, (v6 + 40));
    return;
  }

  if (*(a2 + 24))
  {
    std::string::operator=(a1, (*(a2 + 8) + 40));
    v7 = std::string::basic_string[abi:ne200100]<0>(v35, kXcapLoggingFacility);
    v31[0] = 0;
    v34 = 0;
    v8 = ims::error(v7, v31);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), ": ", 2);
    *(v8 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "Rule not exist. Choose the first one - ", 39);
    *(v8 + 17) = 0;
    (*(*v8 + 32))(v8, a1);
    (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v8 + 17) = 0;
    if (v34 != 1 || (v33 & 0x80000000) == 0)
    {
      goto LABEL_38;
    }

    v9 = v32;
  }

  else
  {
    v10 = qword_1EE2BD3E8;
    if (!qword_1EE2BD3E8)
    {
      goto LABEL_33;
    }

    v11 = &qword_1EE2BD3E8;
    do
    {
      v12 = *(v10 + 32);
      v13 = v12 == a3;
      if (v12 >= a3)
      {
        v14 = 1;
      }

      else
      {
        v14 = -1;
      }

      if (v13)
      {
        v15 = *(v10 + 33);
        v16 = v15 == HIBYTE(a3);
        v14 = v15 >= HIBYTE(a3) ? 1 : -1;
        if (v16)
        {
          v14 = 0;
        }
      }

      v17 = v14 & 0x80;
      v13 = v17 == 0;
      v18 = v17 >> 4;
      if (v13)
      {
        v11 = v10;
      }

      v10 = *(v10 + v18);
    }

    while (v10);
    if (v11 == &qword_1EE2BD3E8)
    {
      goto LABEL_33;
    }

    v19 = *(v11 + 32);
    v20 = v19 == a3;
    v21 = v19 > a3;
    v22 = -1;
    if (!v21)
    {
      v22 = 1;
    }

    if (v20)
    {
      v23 = *(v11 + 33);
      v24 = -1;
      if (v23 <= HIBYTE(a3))
      {
        v24 = 1;
      }

      if (v23 == HIBYTE(a3))
      {
        v22 = 0;
      }

      else
      {
        v22 = v24;
      }
    }

    if (v22 < 0)
    {
LABEL_33:
      v11 = &qword_1EE2BD3E8;
    }

    std::string::operator=(a1, (v11 + 5));
    v25 = std::string::basic_string[abi:ne200100]<0>(v35, kXcapLoggingFacility);
    v27[0] = 0;
    v30 = 0;
    v26 = ims::error(v25, v27);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), ": ", 2);
    *(v26 + 17) = 0;
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v26 + 8), "Rule not exist. Choose from the default rules - ", 48);
    *(v26 + 17) = 0;
    (*(*v26 + 32))(v26, a1);
    (*(*v26 + 64))(v26, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v26 + 17) = 0;
    if (v30 != 1 || (v29 & 0x80000000) == 0)
    {
      goto LABEL_38;
    }

    v9 = __p;
  }

  operator delete(v9);
LABEL_38:
  if (v36 < 0)
  {
    operator delete(v35[0]);
  }
}

void sub_1E51595C4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29)
{
  if (*(v29 + 23) < 0)
  {
    operator delete(*v29);
  }

  _Unwind_Resume(exception_object);
}

void std::vector<XcapCDCondition::Condition>::push_back[abi:ne200100](uint64_t a1, _BYTE *a2)
{
  v4 = *(a1 + 8);
  v3 = *(a1 + 16);
  if (v4 >= v3)
  {
    v6 = *a1;
    v7 = &v4[-*a1];
    v8 = (v7 + 1);
    if ((v7 + 1) < 0)
    {
      std::vector<bambi::XmlParserNamespace>::__throw_length_error[abi:ne200100]();
    }

    v9 = v3 - v6;
    if (2 * v9 > v8)
    {
      v8 = 2 * v9;
    }

    if (v9 >= 0x3FFFFFFFFFFFFFFFLL)
    {
      v10 = 0x7FFFFFFFFFFFFFFFLL;
    }

    else
    {
      v10 = v8;
    }

    if (v10)
    {
      operator new();
    }

    v11 = &v4[-*a1];
    *v7 = *a2;
    v5 = v7 + 1;
    memcpy(0, v6, v11);
    *a1 = 0;
    *(a1 + 8) = v7 + 1;
    *(a1 + 16) = 0;
    if (v6)
    {
      operator delete(v6);
    }
  }

  else
  {
    *v4 = *a2;
    v5 = v4 + 1;
  }

  *(a1 + 8) = v5;
}

void XcapCallForwardManager::~XcapCallForwardManager(XcapCallForwardManager *this)
{
  *this = &unk_1F5EF8C00;
  std::__tree<std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>,std::__map_value_compare<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>,std::less<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>>,true>,std::allocator<std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>>>::destroy(*(this + 49));
  *this = &unk_1F5EC7B28;
  XcapConfig::~XcapConfig(this + 1);
}

{
  *this = &unk_1F5EF8C00;
  std::__tree<std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>,std::__map_value_compare<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>,std::less<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>>,true>,std::allocator<std::__value_type<std::tuple<XcapDocumentCallBarring::Direction,XcapCBCondition::Condition,XcapCBCondition::Media>,std::string>>>::destroy(*(this + 49));
  *this = &unk_1F5EC7B28;
  XcapConfig::~XcapConfig(this + 1);

  JUMPOUT(0x1E69235B0);
}

uint64_t std::vector<XcapCDCondition::Condition>::__init_with_size[abi:ne200100]<XcapCDCondition::Condition*,XcapCDCondition::Condition*>(uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (a4)
  {
    std::vector<XcapCDCondition::Condition>::__vallocate[abi:ne200100](result, a4);
  }

  return result;
}

void sub_1E5159918(_Unwind_Exception *exception_object)
{
  v3 = *v1;
  if (*v1)
  {
    *(v1 + 8) = v3;
    operator delete(v3);
  }

  _Unwind_Resume(exception_object);
}

void sub_1E5159998(_Unwind_Exception *a1)
{
  std::__shared_weak_count::~__shared_weak_count(v1);
  operator delete(v3);
  _Unwind_Resume(a1);
}

void std::__shared_ptr_emplace<XcapDocumentCommDiversion>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF8C70;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void sub_1E5159AB4(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    (*(*v1 + 8))(v1);
  }

  _Unwind_Resume(exception_object);
}

void std::__shared_ptr_pointer<XcapCDRule *,std::shared_ptr<XcapCDRule>::__shared_ptr_default_delete<XcapCDRule,XcapCDRule>,std::allocator<XcapCDRule>>::~__shared_ptr_pointer(std::__shared_weak_count *a1)
{
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t std::__shared_ptr_pointer<XcapCDRule *,std::shared_ptr<XcapCDRule>::__shared_ptr_default_delete<XcapCDRule,XcapCDRule>,std::allocator<XcapCDRule>>::__on_zero_shared(uint64_t a1)
{
  result = *(a1 + 24);
  if (result)
  {
    return (*(*result + 8))();
  }

  return result;
}

uint64_t std::__shared_ptr_pointer<XcapCDRule *,std::shared_ptr<XcapCDRule>::__shared_ptr_default_delete<XcapCDRule,XcapCDRule>,std::allocator<XcapCDRule>>::__get_deleter(uint64_t a1, uint64_t a2)
{
  {
    return a1;
  }

  else
  {
    return 0;
  }
}

uint64_t **std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::__emplace_unique_key_args<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::piecewise_construct_t const&,std::tuple<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>&&>,std::tuple<>>(uint64_t a1, unsigned __int8 a2, unsigned __int8 a3)
{
  v3 = *(a1 + 8);
  if (!v3)
  {
LABEL_19:
    operator new();
  }

  while (1)
  {
    v4 = v3;
    v5 = *(v3 + 32);
    if (v5 != a2)
    {
      break;
    }

    v6 = *(v4 + 33);
    v7 = v6 == a3;
    if (v6 > a3)
    {
LABEL_12:
      v3 = *v4;
      if (!*v4)
      {
        goto LABEL_19;
      }
    }

    else
    {
      if (v6 >= a3)
      {
        v8 = 1;
      }

      else
      {
        v8 = -1;
      }

      if (v7)
      {
        v8 = 0;
      }

      if ((v8 & 0x80) == 0)
      {
        return v4;
      }

LABEL_18:
      v3 = v4[1];
      if (!v3)
      {
        goto LABEL_19;
      }
    }
  }

  if (v5 > a2)
  {
    goto LABEL_12;
  }

  if (v5 >= a2)
  {
    v9 = 1;
  }

  else
  {
    v9 = -1;
  }

  if (v9 < 0)
  {
    goto LABEL_18;
  }

  return v4;
}

uint64_t std::__tree<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::__map_value_compare<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>,std::less<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>,true>,std::allocator<std::__value_type<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>,std::string>>>::find<std::pair<XcapCDCondition::Condition,XcapCDCondition::Media>>(uint64_t a1, unsigned __int8 a2, unsigned __int8 a3)
{
  v5 = *(a1 + 8);
  v3 = a1 + 8;
  v4 = v5;
  if (!v5)
  {
    return v3;
  }

  v6 = v3;
  do
  {
    v7 = *(v4 + 32);
    v8 = v7 == a2;
    if (v7 >= a2)
    {
      v9 = 1;
    }

    else
    {
      v9 = -1;
    }

    if (v8)
    {
      v10 = *(v4 + 33);
      v11 = v10 == a3;
      v9 = v10 >= a3 ? 1 : -1;
      if (v11)
      {
        v9 = 0;
      }
    }

    v12 = v9 & 0x80;
    v8 = v12 == 0;
    v13 = v12 >> 4;
    if (v8)
    {
      v6 = v4;
    }

    v4 = *(v4 + v13);
  }

  while (v4);
  if (v3 == v6)
  {
    return v3;
  }

  v14 = *(v6 + 32);
  if (v14 <= a2)
  {
    v15 = 1;
  }

  else
  {
    v15 = -1;
  }

  if (v14 == a2)
  {
    v16 = *(v6 + 33);
    v17 = -1;
    if (v16 <= a3)
    {
      v17 = 1;
    }

    if (v16 == a3)
    {
      v15 = 0;
    }

    else
    {
      v15 = v17;
    }
  }

  if (v15 < 0)
  {
    return v3;
  }

  return v6;
}

void SipAuthPatInfo::~SipAuthPatInfo(SipAuthPatInfo *this)
{
  *this = &unk_1F5EF8D38;
  v2 = *(this + 7);
  if (v2)
  {
    (*(*v2 + 8))(v2);
  }

  MEMORY[0x1E69225A0](this + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 1);
}

{
  SipAuthPatInfo::~SipAuthPatInfo(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t SipAuthPatInfo::setResponse(SipAuthPatInfo *this, const SipAuthResponse *a2)
{
  v4 = *(this + 7);
  if (v4)
  {
    (*(*v4 + 8))(v4);
  }

  result = (*(*a2 + 16))(a2);
  *(this + 7) = result;
  return result;
}

double SipAuthPatInfo::addAuthorizationToRequest@<D0>(uint64_t a1@<X8>)
{
  result = 0.0;
  *(a1 + 24) = 0u;
  *(a1 + 40) = 0u;
  *(a1 + 56) = 0u;
  *(a1 + 72) = 0u;
  *a1 = &unk_1F5EBDEF8;
  *(a1 + 8) = &_bambiDomain;
  *(a1 + 16) = 0;
  return result;
}

void sub_1E515A2D8(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, objc_super a9)
{
  a9.super_class = ImsNetworkPath;
  [(_Unwind_Exception *)&a9 dealloc];
  _Unwind_Resume(a1);
}

void sub_1E515A3EC(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, id a10)
{
  std::__shared_weak_count::__release_shared[abi:ne200100](v12);

  _Unwind_Resume(a1);
}

uint64_t ImsNetworkPathEvaluator::ImsNetworkPathEvaluator(uint64_t a1, uint64_t a2, uint64_t *a3)
{
  *a1 = &unk_1F5EDE3F0;
  ims::getQueue(object);
  *(a1 + 16) = 0;
  *(a1 + 24) = 0;
  v6 = object[0];
  *(a1 + 32) = object[0];
  if (v6)
  {
    dispatch_retain(v6);
  }

  *(a1 + 40) = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 48), "com.apple.ipTelephony", "net");
  if (v6)
  {
    dispatch_release(v6);
  }

  *a1 = &unk_1F5EF8DC0;
  *(a1 + 8) = &unk_1F5EF8DF0;
  *(a1 + 56) = 0u;
  *(a1 + 72) = 0u;
  std::string::basic_string[abi:ne200100]<0>(object, "net");
  v12[0] = 0;
  v15 = 0;
  v7 = ims::debug(object, v12);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v7 + 8), "creating path evaluator for ", 28);
  *(v7 + 17) = 0;
  (*(*v7 + 32))(v7, a2);
  (*(*v7 + 64))(v7, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v7 + 17) = 0;
  if (v15 == 1 && v14 < 0)
  {
    operator delete(__p);
  }

  if (v17 < 0)
  {
    operator delete(object[0]);
  }

  v9 = *a3;
  v8 = a3[1];
  if (v8)
  {
    atomic_fetch_add_explicit((v8 + 16), 1uLL, memory_order_relaxed);
  }

  v10 = *(a1 + 80);
  *(a1 + 72) = v9;
  *(a1 + 80) = v8;
  if (v10)
  {
    std::__shared_weak_count::__release_weak(v10);
  }

  return a1;
}

void sub_1E515A66C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  v27 = *(v24 + 80);
  if (v27)
  {
    std::__shared_weak_count::__release_weak(v27);
  }

  v28 = *(v24 + 64);
  if (v28)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v28);
  }

  MEMORY[0x1E69225A0](v24 + 48);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(v25);
  _Unwind_Resume(a1);
}

void ImsNetworkPathEvaluator::init(uint64_t a1)
{
  std::shared_ptr<RTPSharedPointerBase>::shared_ptr[abi:ne200100]<RTPSharedPointerBase,0>(&v2, (a1 + 16));
  v1 = v3;
  if (v3)
  {
    atomic_fetch_add_explicit(&v3->__shared_weak_owners_, 1uLL, memory_order_relaxed);
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }

  std::allocate_shared[abi:ne200100]<ImsNetworkPathWrapper,std::allocator<ImsNetworkPathWrapper>,std::string const&,std::weak_ptr<ImsNetworkPathEvaluator>,0>();
}

void sub_1E515A798(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10)
{
  if (a10)
  {
    std::__shared_weak_count::__release_weak(a10);
  }

  _Unwind_Resume(exception_object);
}

void ImsNetworkPathEvaluator::create(void *a1@<X8>)
{
  *a1 = 0;
  a1[1] = 0;
  std::allocate_shared[abi:ne200100]<ImsNetworkPathEvaluator,std::allocator<ImsNetworkPathEvaluator>,std::string const&,std::weak_ptr<ImsNetworkPathManagerInterface> &,ImsNetworkPathEvaluator::EnforcePrivateConstruction,0>();
}

void sub_1E515A800(_Unwind_Exception *exception_object)
{
  v3 = *(v1 + 8);
  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  _Unwind_Resume(exception_object);
}

void ImsNetworkPathEvaluator::~ImsNetworkPathEvaluator(ImsNetworkPathEvaluator *this)
{
  *this = &unk_1F5EF8DC0;
  *(this + 1) = &unk_1F5EF8DF0;
  v2 = *(this + 10);
  if (v2)
  {
    std::__shared_weak_count::__release_weak(v2);
  }

  v3 = *(this + 8);
  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }

  MEMORY[0x1E69225A0](this + 48);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 2);
}

{
  ImsNetworkPathEvaluator::~ImsNetworkPathEvaluator(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toImsNetworkPathEvaluator::~ImsNetworkPathEvaluator(ImsNetworkPathEvaluator *this)
{
  ImsNetworkPathEvaluator::~ImsNetworkPathEvaluator((this - 8));
}

{
  ImsNetworkPathEvaluator::~ImsNetworkPathEvaluator((this - 8));

  JUMPOUT(0x1E69235B0);
}

void ImsNetworkPathEvaluator::handlePathSatisfied(ImsNetworkPathEvaluator *this)
{
  v2 = *(this + 10);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      v5 = *(this + 9);
      if (v5)
      {
        v6 = *(this + 7);
        if (v6)
        {
          if (*v6)
          {
            [*v6 ifaceName];
          }

          else
          {
            __p[0] = 0;
            __p[1] = 0;
            v8 = 0;
          }

          (**v5)(v5, __p);
          if (SHIBYTE(v8) < 0)
          {
            operator delete(__p[0]);
          }
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void ImsNetworkPathEvaluator::handlePathFailed(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 80);
  if (v3)
  {
    v5 = std::__shared_weak_count::lock(v3);
    if (v5)
    {
      v6 = v5;
      v7 = *(a1 + 72);
      if (v7)
      {
        (*(*v7 + 8))(v7, a2);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v6);
    }
  }
}

void *std::__shared_ptr_emplace<ImsNetworkPathWrapper>::__shared_ptr_emplace[abi:ne200100]<std::string const&,std::weak_ptr<ImsNetworkPathEvaluator>,std::allocator<ImsNetworkPathWrapper>,0>(void *a1, uint64_t a2, uint64_t *a3)
{
  a1[1] = 0;
  a1[2] = 0;
  *a1 = &unk_1F5EF8EE8;
  std::construct_at[abi:ne200100]<ImsNetworkPathWrapper,std::string const&,std::weak_ptr<ImsNetworkPathEvaluator>,ImsNetworkPathWrapper*>(a1 + 3, a2, a3);
  return a1;
}

void std::__shared_ptr_emplace<ImsNetworkPathWrapper>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF8EE8;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t *std::construct_at[abi:ne200100]<ImsNetworkPathWrapper,std::string const&,std::weak_ptr<ImsNetworkPathEvaluator>,ImsNetworkPathWrapper*>(uint64_t *a1, uint64_t a2, uint64_t *a3)
{
  v6 = a3[1];
  if (v6)
  {
    v7 = std::__shared_weak_count::lock(v6);
    if (v7)
    {
      v8 = v7;
      v9 = *a3;
      atomic_fetch_add_explicit(&v7->__shared_weak_owners_, 1uLL, memory_order_relaxed);
      v10 = a3[1];
      *a3 = 0;
      a3[1] = 0;
      if (v10)
      {
        std::__shared_weak_count::__release_weak(v10);
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v8);
    }

    else
    {
      v11 = a3[1];
      *a3 = 0;
      a3[1] = 0;
      if (v11)
      {
        std::__shared_weak_count::__release_weak(v11);
      }

      v9 = 0;
      v8 = 0;
    }
  }

  else
  {
    v9 = 0;
    v8 = 0;
    *a3 = 0;
    a3[1] = 0;
  }

  *a1 = 0;
  v12 = [ImsNetworkPath alloc];
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&v18, *a2, *(a2 + 8));
  }

  else
  {
    v18 = *a2;
  }

  v16 = v9;
  v17 = v8;
  if (v8)
  {
    atomic_fetch_add_explicit(&v8->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  v13 = [(ImsNetworkPath *)v12 initWithInterface:&v18 delegate:&v16];
  v14 = *a1;
  *a1 = v13;

  if (v17)
  {
    std::__shared_weak_count::__release_weak(v17);
  }

  if (SHIBYTE(v18.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v18.__r_.__value_.__l.__data_);
  }

  if (v8)
  {
    std::__shared_weak_count::__release_weak(v8);
  }

  return a1;
}

void sub_1E515AD48(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, std::__shared_weak_count *a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16)
{
  if (a10)
  {
    std::__shared_weak_count::__release_weak(a10);
  }

  if (a16 < 0)
  {
    operator delete(__p);
  }

  if (v17)
  {
    std::__shared_weak_count::__release_weak(v17);
  }

  _Unwind_Resume(a1);
}

void *std::__shared_ptr_emplace<ImsNetworkPathEvaluator>::__shared_ptr_emplace[abi:ne200100]<std::string const&,std::weak_ptr<ImsNetworkPathManagerInterface> &,ImsNetworkPathEvaluator::EnforcePrivateConstruction,std::allocator<ImsNetworkPathEvaluator>,0>(void *a1, uint64_t a2, uint64_t *a3)
{
  a1[1] = 0;
  a1[2] = 0;
  *a1 = &unk_1F5EF8F38;
  std::construct_at[abi:ne200100]<ImsNetworkPathEvaluator,std::string const&,std::weak_ptr<ImsNetworkPathManagerInterface> &,ImsNetworkPathEvaluator::EnforcePrivateConstruction,ImsNetworkPathEvaluator*>((a1 + 3), a2, a3);
  return a1;
}

void std::__shared_ptr_emplace<ImsNetworkPathEvaluator>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF8F38;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

uint64_t std::construct_at[abi:ne200100]<ImsNetworkPathEvaluator,std::string const&,std::weak_ptr<ImsNetworkPathManagerInterface> &,ImsNetworkPathEvaluator::EnforcePrivateConstruction,ImsNetworkPathEvaluator*>(uint64_t a1, uint64_t a2, uint64_t *a3)
{
  v4 = a3[1];
  v6[0] = *a3;
  v6[1] = v4;
  if (v4)
  {
    atomic_fetch_add_explicit(&v4->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  }

  ImsNetworkPathEvaluator::ImsNetworkPathEvaluator(a1, a2, v6);
  if (v4)
  {
    std::__shared_weak_count::__release_weak(v4);
  }

  return a1;
}

void sub_1E515AF7C(_Unwind_Exception *exception_object)
{
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }

  _Unwind_Resume(exception_object);
}

uint64_t LazuliStringParameterHeader::LazuliStringParameterHeader(uint64_t a1, const std::string *a2, uint64_t a3)
{
  v5 = LazuliHeader::LazuliHeader(a1, a2);
  v5[3].__r_.__value_.__l.__size_ = 0;
  v5[3].__r_.__value_.__r.__words[0] = 0;
  v5[2].__r_.__value_.__l.__size_ = &unk_1F5EBEF50;
  v5[2].__r_.__value_.__r.__words[2] = &v5[3];
  LOWORD(v5[3].__r_.__value_.__r.__words[2]) = 256;
  v5->__r_.__value_.__r.__words[0] = &unk_1F5EF8F88;
  v5[4].__r_.__value_.__r.__words[0] = 0;
  p_data = &v5[4].__r_.__value_.__l.__data_;
  v5[4].__r_.__value_.__l.__size_ = 0;
  v5[4].__r_.__value_.__r.__words[2] = 0;
  ims::chomp("\r\n\t ", a3, 3, &v8);
  if (*(a1 + 119) < 0)
  {
    operator delete(*p_data);
  }

  *p_data = v8;
  return a1;
}

void sub_1E515B064(_Unwind_Exception *a1)
{
  if (v1[119] < 0)
  {
    operator delete(*v2);
  }

  LazuliParameterHeader::~LazuliParameterHeader(v1);
  _Unwind_Resume(a1);
}

void LazuliParameterHeader::~LazuliParameterHeader(LazuliParameterHeader *this)
{
  *this = &unk_1F5EC66B8;
  *(this + 7) = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy(this + 64, *(this + 9));

  LazuliHeader::~LazuliHeader(this);
}

void LazuliStringParameterHeader::LazuliStringParameterHeader(LazuliStringParameterHeader *this, const LazuliStringParameterHeader *a2)
{
  LazuliParameterHeader::LazuliParameterHeader(this, a2);
  v3->__r_.__value_.__r.__words[0] = &unk_1F5EF8F88;
  v4 = v3 + 4;
  if (*(a2 + 119) < 0)
  {
    std::string::__init_copy_ctor_external(v4, *(a2 + 12), *(a2 + 13));
  }

  else
  {
    v5 = *(a2 + 6);
    v4->__r_.__value_.__r.__words[2] = *(a2 + 14);
    *&v4->__r_.__value_.__l.__data_ = v5;
  }
}

uint64_t LazuliStringParameterHeader::setValueFromString(uint64_t a1, uint64_t a2)
{
  ims::chomp("\r\n\t ", a2, 3, &v4);
  if (*(a1 + 119) < 0)
  {
    operator delete(*(a1 + 96));
  }

  *(a1 + 96) = v4;
  return 1;
}

void LazuliStringParameterHeader::~LazuliStringParameterHeader(void **this)
{
  *this = &unk_1F5EF8F88;
  if (*(this + 119) < 0)
  {
    operator delete(this[12]);
  }

  *this = &unk_1F5EC66B8;
  this[7] = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy((this + 8), this[9]);

  LazuliHeader::~LazuliHeader(this);
}

{
  *this = &unk_1F5EF8F88;
  if (*(this + 119) < 0)
  {
    operator delete(this[12]);
  }

  *this = &unk_1F5EC66B8;
  this[7] = &unk_1F5EBEF50;
  std::__tree<std::__value_type<std::string,std::string>,std::__map_value_compare<std::string,std::__value_type<std::string,std::string>,std::less<std::string>,true>,std::allocator<std::__value_type<std::string,std::string>>>::destroy((this + 8), this[9]);
  LazuliHeader::~LazuliHeader(this);

  JUMPOUT(0x1E69235B0);
}

void sub_1E515B490(_Unwind_Exception *a1)
{
  std::__shared_weak_count::~__shared_weak_count(v1);
  operator delete(v3);
  _Unwind_Resume(a1);
}

void std::__shared_ptr_emplace<LazuliStringParameterHeader>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF9010;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void SipPEarlyMediaHeader::~SipPEarlyMediaHeader(char **this)
{
  *this = &unk_1F5ED5A80;
  std::__tree<std::string>::destroy((this + 8), this[9]);

  SipHeader::~SipHeader(this);
}

{
  *this = &unk_1F5ED5A80;
  std::__tree<std::string>::destroy((this + 8), this[9]);
  SipHeader::~SipHeader(this);

  JUMPOUT(0x1E69235B0);
}

uint64_t ImsRtpNw::ImsRtpNw(uint64_t a1, void *a2, uint64_t *a3)
{
  *a1 = &unk_1F5EF92E0;
  v6 = (a1 + 8);
  std::string::basic_string[abi:ne200100]<0>(v25, "net.rtpnw");
  v7 = *a2;
  v21 = *(*a2 + 200);
  v22 = *(v7 + 208);
  if (*(v7 + 239) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, *(v7 + 216), *(v7 + 224));
  }

  else
  {
    __p = *(v7 + 216);
  }

  v24 = *(v7 + 240);
  ims::getQueue(&v30);
  ClientConfig::getLogTag(&v21, &v27);
  if ((v26 & 0x80u) == 0)
  {
    v8 = v25;
  }

  else
  {
    v8 = v25[0];
  }

  if ((v26 & 0x80u) == 0)
  {
    v9 = v26;
  }

  else
  {
    v9 = v25[1];
  }

  v10 = std::string::insert(&v27, 0, v8, v9);
  v11 = *&v10->__r_.__value_.__l.__data_;
  v29 = v10->__r_.__value_.__r.__words[2];
  v28 = v11;
  v10->__r_.__value_.__l.__size_ = 0;
  v10->__r_.__value_.__r.__words[2] = 0;
  v10->__r_.__value_.__r.__words[0] = 0;
  if (v29 >= 0)
  {
    v12 = &v28;
  }

  else
  {
    v12 = v28;
  }

  *(a1 + 16) = 0;
  *(a1 + 24) = 0;
  v13 = v30;
  *(a1 + 32) = v30;
  if (v13)
  {
    dispatch_retain(v13);
  }

  *(a1 + 40) = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 48), "com.apple.ipTelephony", v12);
  if (SHIBYTE(v29) < 0)
  {
    operator delete(v28);
  }

  if (SHIBYTE(v27.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v27.__r_.__value_.__l.__data_);
  }

  if (v13)
  {
    dispatch_release(v13);
  }

  *v6 = &unk_1F5EF9310;
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (v26 < 0)
  {
    operator delete(v25[0]);
  }

  *a1 = &unk_1F5EF90E0;
  *(a1 + 8) = &unk_1F5EF9110;
  *(a1 + 56) = 0u;
  *(a1 + 72) = 0u;
  *(a1 + 88) = 0;
  *(a1 + 96) = 0;
  *(a1 + 104) = 0;
  *(a1 + 111) = 0;
  v14 = dispatch_queue_attr_make_with_qos_class(0, QOS_CLASS_DEFAULT, 0);
  *(a1 + 120) = dispatch_queue_create("com.apple.ipTelephony.nwlistener", v14);
  v15 = dispatch_queue_attr_make_with_qos_class(0, QOS_CLASS_DEFAULT, 0);
  v16 = dispatch_queue_create("com.apple.ipTelephony.nwconnection", v15);
  v18 = *a3;
  v17 = a3[1];
  *(a1 + 128) = v16;
  *(a1 + 136) = v18;
  *(a1 + 144) = v17;
  if (v17)
  {
    atomic_fetch_add_explicit((v17 + 16), 1uLL, memory_order_relaxed);
  }

  v19 = a2[1];
  *(a1 + 152) = *a2;
  *(a1 + 160) = v19;
  if (v19)
  {
    atomic_fetch_add_explicit((v19 + 16), 1uLL, memory_order_relaxed);
  }

  return a1;
}

void sub_1E515B920(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *a11, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, void *__p, uint64_t a19, int a20, __int16 a21, char a22, char a23, void *a24, uint64_t a25, int a26, __int16 a27, char a28, char a29)
{
  if (a23 < 0)
  {
    operator delete(__p);
  }

  _Unwind_Resume(exception_object);
}

void ImsRtpNw::~ImsRtpNw(ImsRtpNw *this)
{
  *this = &unk_1F5EF90E0;
  *(this + 1) = &unk_1F5EF9110;
  v2 = *(this + 9);
  if (v2)
  {
    nw_listener_cancel(v2);
    nw_release(*(this + 9));
    *(this + 9) = 0;
  }

  v3 = *(this + 7);
  if (v3)
  {
    nw_release(v3);
    *(this + 7) = 0;
  }

  v4 = *(this + 8);
  if (v4)
  {
    nw_release(v4);
    *(this + 8) = 0;
  }

  v5 = *(this + 10);
  if (v5)
  {
    nw_release(v5);
    *(this + 10) = 0;
  }

  v6 = *(this + 20);
  if (v6)
  {
    std::__shared_weak_count::__release_weak(v6);
  }

  v7 = *(this + 18);
  if (v7)
  {
    std::__shared_weak_count::__release_weak(v7);
  }

  v8 = *(this + 16);
  if (v8)
  {
    dispatch_release(v8);
  }

  v9 = *(this + 15);
  if (v9)
  {
    dispatch_release(v9);
  }

  v10 = *(this + 13);
  if (v10)
  {
    dispatch_release(v10);
  }

  v11 = *(this + 12);
  if (v11)
  {
    dispatch_release(v11);
  }

  MEMORY[0x1E69225A0](this + 48);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 2);
}

{
  ImsRtpNw::~ImsRtpNw(this);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toImsRtpNw::~ImsRtpNw(ImsRtpNw *this)
{
  ImsRtpNw::~ImsRtpNw((this - 8));
}

{
  ImsRtpNw::~ImsRtpNw((this - 8));

  JUMPOUT(0x1E69235B0);
}

void ImsRtpNw::initializeNwListener(ImsRtpNw *this@<X0>, nw_parameters *obj@<X1>, NSObject *a3@<X2>, uint32_t a4@<W3>, uint64_t a5@<X8>)
{
  v10 = *(this + 8);
  if (v10)
  {
    nw_release(v10);
  }

  v11 = *(this + 7);
  if (v11)
  {
    nw_release(v11);
  }

  *(this + 7) = a3;
  *(this + 8) = obj;
  nw_retain(obj);
  nw_retain(*(this + 7));
  v12 = dispatch_semaphore_create(0);
  ClientUniquePIDStatic = AVCRTPStackController::getClientUniquePIDStatic(v12);
  v14 = *(this + 8);
  nw_parameters_set_delegated_unique_pid();
  std::string::basic_string[abi:ne200100]<0>(&__p, "net.rtpnw");
  v39[0] = 0;
  v42 = 0;
  v15 = ims::debug(&__p, v39);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "set PID to ", 11);
  *(v15 + 17) = 0;
  MEMORY[0x1E69233B0](*(v15 + 8), ClientUniquePIDStatic);
  *(v15 + 17) = 0;
  (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v15 + 17) = 0;
  if (v42 == 1 && v41 < 0)
  {
    operator delete(v40);
  }

  if (SHIBYTE(v37) < 0)
  {
    operator delete(__p);
  }

  v16 = *(this + 9);
  if (v16)
  {
    nw_listener_cancel(v16);
    nw_release(*(this + 9));
  }

  *(this + 9) = nw_listener_create(*(this + 8));
  v17 = *(this + 8);
  nw_parameters_allow_sharing_port_with_listener();
  v18 = *(this + 8);
  nw_parameters_set_source_application_by_bundle_id();
  nw_listener_set_new_connection_limit(*(this + 9), a4);
  __p = 0;
  p_p = &__p;
  v37 = 0x2000000000;
  v38 = 0;
  v33[0] = 0;
  v33[1] = v33;
  v33[2] = 0x2000000000;
  port = nw_endpoint_get_port(a3);
  v19 = *(this + 3);
  if (!v19 || (v20 = *(this + 2), (v21 = std::__shared_weak_count::lock(v19)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v22 = v21;
  p_shared_weak_owners = &v21->__shared_weak_owners_;
  atomic_fetch_add_explicit(&v21->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  std::__shared_weak_count::__release_shared[abi:ne200100](v21);
  v24 = *(this + 9);
  handler[0] = MEMORY[0x1E69E9820];
  handler[1] = 1174405120;
  handler[2] = ___ZN8ImsRtpNw20initializeNwListenerEP13nw_parametersP11nw_endpointb_block_invoke;
  handler[3] = &unk_1F5EF9130;
  handler[6] = this;
  handler[7] = v20;
  v31 = v22;
  atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
  handler[4] = &__p;
  object = v12;
  if (v12)
  {
    dispatch_retain(v12);
  }

  handler[5] = v33;
  nw_listener_set_state_changed_handler(v24, handler);
  v25 = *(this + 9);
  v27[0] = MEMORY[0x1E69E9820];
  v27[1] = 1174405120;
  v27[2] = ___ZN8ImsRtpNw20initializeNwListenerEP13nw_parametersP11nw_endpointb_block_invoke_11;
  v27[3] = &__block_descriptor_tmp_15_0;
  v27[4] = this;
  v27[5] = v20;
  v28 = v22;
  atomic_fetch_add_explicit(&v22->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  v29 = a4;
  nw_listener_set_new_connection_handler(v25, v27);
  *(this + 112) = 0;
  nw_listener_set_queue(*(this + 9), *(this + 15));
  nw_listener_start(*(this + 9));
  dispatch_semaphore_wait(v12, 0xFFFFFFFFFFFFFFFFLL);
  if (p_p[3])
  {
    v26 = 0;
  }

  else
  {
    if ((*(this + 112) & 1) == 0)
    {
      nw_listener_cancel(*(this + 9));
    }

    v26 = 0x40000000;
  }

  *(a5 + 24) = 0u;
  *(a5 + 40) = 0u;
  *(a5 + 56) = 0u;
  *(a5 + 72) = 0u;
  *a5 = &unk_1F5EBDEF8;
  *(a5 + 8) = &_bambiDomain;
  *(a5 + 16) = v26;
  if (v28)
  {
    std::__shared_weak_count::__release_weak(v28);
  }

  if (object)
  {
    dispatch_release(object);
  }

  if (v31)
  {
    std::__shared_weak_count::__release_weak(v31);
  }

  std::__shared_weak_count::__release_weak(v22);
  _Block_object_dispose(v33, 8);
  _Block_object_dispose(&__p, 8);
  if (v12)
  {
    dispatch_release(v12);
  }
}

void sub_1E515BEE0(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, std::__shared_weak_count *a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, std::__shared_weak_count *a26, dispatch_object_t object, char a28, uint64_t a29, uint64_t a30, uint64_t a31, void *__p, uint64_t a33, int a34, __int16 a35, char a36, char a37)
{
  if (a16)
  {
    std::__shared_weak_count::__release_weak(a16);
  }

  if (object)
  {
    dispatch_release(object);
  }

  if (a26)
  {
    std::__shared_weak_count::__release_weak(a26);
  }

  std::__shared_weak_count::__release_weak(v38);
  _Block_object_dispose(&a28, 8);
  _Block_object_dispose(&__p, 8);
  if (v37)
  {
    dispatch_release(v37);
  }

  _Unwind_Resume(a1);
}

void ___ZN8ImsRtpNw20initializeNwListenerEP13nw_parametersP11nw_endpointb_block_invoke(uint64_t a1, int a2)
{
  v3 = *(a1 + 64);
  if (v3)
  {
    v5 = *(a1 + 48);
    v6 = std::__shared_weak_count::lock(v3);
    if (v6)
    {
      v7 = v6;
      if (!*(a1 + 56))
      {
LABEL_31:
        std::__shared_weak_count::__release_shared[abi:ne200100](v7);
        return;
      }

      switch(a2)
      {
        case 4:
          v13 = std::string::basic_string[abi:ne200100]<0>(v33, "net.rtpnw");
          v21[0] = 0;
          v24 = 0;
          v14 = ims::debug(v13, v21);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v14 + 8), "NW listener cancelled", 21);
          *(v14 + 17) = 0;
          (*(*v14 + 64))(v14, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v14 + 17) = 0;
          if (v24 == 1 && v23 < 0)
          {
            operator delete(v22);
          }

          if (v34 < 0)
          {
            operator delete(v33[0]);
          }

          *(*(*(a1 + 32) + 8) + 24) = 1;
          *(v5 + 112) = 1;
          if (*(v5 + 113) == 1)
          {
            dispatch_semaphore_signal(*(v5 + 104));
          }

          goto LABEL_30;
        case 2:
          v11 = std::string::basic_string[abi:ne200100]<0>(v33, "net.rtpnw");
          v25[0] = 0;
          v28 = 0;
          v12 = ims::debug(v11, v25);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "Port is available ", 18);
          *(v12 + 17) = 0;
          MEMORY[0x1E6923390](*(v12 + 8), *(*(*(a1 + 40) + 8) + 24));
          *(v12 + 17) = 0;
          (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v12 + 17) = 0;
          if (v28 == 1 && v27 < 0)
          {
            v10 = __p;
            goto LABEL_13;
          }

          break;
        case 1:
          v8 = std::string::basic_string[abi:ne200100]<0>(v33, "net.rtpnw");
          v29[0] = 0;
          v32 = 0;
          v9 = ims::debug(v8, v29);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "NW listener waiting", 19);
          *(v9 + 17) = 0;
          (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v9 + 17) = 0;
          if (v32 == 1 && v31 < 0)
          {
            v10 = v30;
LABEL_13:
            operator delete(v10);
          }

          break;
        default:
          v15 = std::string::basic_string[abi:ne200100]<0>(v33, "net.rtpnw");
          v17[0] = 0;
          v20 = 0;
          v16 = ims::debug(v15, v17);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "NW listener failed", 18);
          *(v16 + 17) = 0;
          (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v16 + 17) = 0;
          if (v20 == 1 && v19 < 0)
          {
            operator delete(v18);
          }

          if (v34 < 0)
          {
            operator delete(v33[0]);
          }

          *(*(*(a1 + 32) + 8) + 24) = 0;
          goto LABEL_30;
      }

      if (v34 < 0)
      {
        operator delete(v33[0]);
      }

      *(*(*(a1 + 32) + 8) + 24) = 1;
LABEL_30:
      dispatch_semaphore_signal(*(a1 + 72));
      goto LABEL_31;
    }
  }
}

void __copy_helper_block_e8_56c32_ZTSNSt3__18weak_ptrI8ImsRtpNwEE72c25_ZTSN8dispatch9semaphoreE(void *a1, void *a2)
{
  v2 = a2[8];
  a1[7] = a2[7];
  a1[8] = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  v3 = a2[9];
  a1[9] = v3;
  if (v3)
  {
    dispatch_retain(v3);
  }
}

void __destroy_helper_block_e8_56c32_ZTSNSt3__18weak_ptrI8ImsRtpNwEE72c25_ZTSN8dispatch9semaphoreE(uint64_t a1)
{
  v2 = *(a1 + 72);
  if (v2)
  {
    dispatch_release(v2);
  }

  v3 = *(a1 + 64);
  if (v3)
  {

    std::__shared_weak_count::__release_weak(v3);
  }
}

void ___ZN8ImsRtpNw20initializeNwListenerEP13nw_parametersP11nw_endpointb_block_invoke_11(uint64_t a1, NSObject *a2)
{
  v47 = *MEMORY[0x1E69E9840];
  v3 = *(a1 + 48);
  if (v3)
  {
    v5 = *(a1 + 32);
    v6 = std::__shared_weak_count::lock(v3);
    if (v6)
    {
      v7 = v6;
      v8 = *(a1 + 40);
      if (v8)
      {
        std::string::basic_string[abi:ne200100]<0>(handler, "net.rtpnw");
        v29[0] = 0;
        v32 = 0;
        v9 = ims::debug(handler, v29);
        std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "RTP nw_listener_set_new_connection_handler configured", 53);
        *(v9 + 17) = 0;
        (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
        *(v9 + 17) = 0;
        if (v32 == 1 && v31 < 0)
        {
          operator delete(__p);
        }

        if (SHIBYTE(v34) < 0)
        {
          operator delete(handler[0]);
        }

        if (*(a1 + 56) != 1 || (*(v5 + 113) & 1) != 0 || (*(v5 + 114) & 1) != 0)
        {
          std::string::basic_string[abi:ne200100]<0>(handler, "net.rtpnw");
          v25[0] = 0;
          v28 = 0;
          v10 = ims::debug(handler, v25);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v10 + 8), "skipping RTCP conn. connectionId=", 33);
          *(v10 + 17) = 0;
          id = nw_connection_get_id();
          MEMORY[0x1E69233B0](*(v10 + 8), id);
          *(v10 + 17) = 0;
          (*(*v10 + 64))(v10, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v10 + 17) = 0;
          if (v28 == 1 && v27 < 0)
          {
            operator delete(v26);
          }

          if (SHIBYTE(v34) < 0)
          {
            operator delete(handler[0]);
          }

          nw_connection_cancel(a2);
        }

        else
        {
          nw_listener_set_new_connection_limit(*(v5 + 72), 0);
          v13 = *(a1 + 56);
          *(v8 + 80) = a2;
          nw_retain(a2);
          *uu = 0;
          v46 = 0;
          v14 = *(v8 + 80);
          nw_connection_get_uuid();
          memset(out, 0, 37);
          uuid_unparse(uu, out);
          std::string::basic_string[abi:ne200100]<0>(handler, "net.nw");
          v40[0] = 0;
          v43 = 0;
          v15 = ims::debug(handler, v40);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "setConnection, connectionId=", 28);
          *(v15 + 17) = 0;
          v16 = *(v8 + 80);
          v17 = nw_connection_get_id();
          MEMORY[0x1E69233B0](*(v15 + 8), v17);
          *(v15 + 17) = 0;
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), " uuid=", 6);
          *(v15 + 17) = 0;
          v18 = strlen(out);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), out, v18);
          *(v15 + 17) = 0;
          (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v15 + 17) = 0;
          if (v43 == 1 && v42 < 0)
          {
            operator delete(v41);
          }

          if (SHIBYTE(v34) < 0)
          {
            operator delete(handler[0]);
          }

          nw_connection_set_queue(*(v8 + 80), *(v8 + 128));
          v19 = *(v8 + 24);
          if (!v19 || (v20 = *(v8 + 16), (v21 = std::__shared_weak_count::lock(v19)) == 0))
          {
            std::__throw_bad_weak_ptr[abi:ne200100]();
          }

          v22 = v21;
          p_shared_weak_owners = &v21->__shared_weak_owners_;
          atomic_fetch_add_explicit(&v21->__shared_weak_owners_, 1uLL, memory_order_relaxed);
          std::__shared_weak_count::__release_shared[abi:ne200100](v21);
          v24 = *(v8 + 80);
          handler[0] = MEMORY[0x1E69E9820];
          handler[1] = 1174405120;
          v34 = ___ZN8ImsRtpNw13setConnectionEP13nw_connectionb_block_invoke;
          v35 = &__block_descriptor_tmp_29_3;
          v36 = v8;
          v37 = v20;
          v38 = v22;
          atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
          v39 = v13;
          nw_connection_set_state_changed_handler(v24, handler);
          nw_connection_start(*(v8 + 80));
          if (v38)
          {
            std::__shared_weak_count::__release_weak(v38);
          }

          std::__shared_weak_count::__release_weak(v22);
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v7);
    }
  }

  v12 = *MEMORY[0x1E69E9840];
}

void sub_1E515C854(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29, void *a30, uint64_t a31, int a32, __int16 a33, char a34, char a35, uint64_t a36, uint64_t a37, uint64_t a38, std::__shared_weak_count *a39, uint64_t a40, uint64_t a41, uint64_t a42, void *__p, uint64_t a44, int a45, __int16 a46, char a47, char a48, uint64_t a49, char a50)
{
  if (a39)
  {
    std::__shared_weak_count::__release_weak(a39);
  }

  std::__shared_weak_count::__release_weak(v51);
  std::__shared_weak_count::__release_shared[abi:ne200100](v50);
  _Unwind_Resume(a1);
}

uint64_t __copy_helper_block_e8_40c32_ZTSNSt3__18weak_ptrI8ImsRtpNwEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c32_ZTSNSt3__18weak_ptrI8ImsRtpNwEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void ImsRtpNw::cancelNwListener(ImsRtpNw *this)
{
  v2 = *(this + 20);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = v3;
      if (*(this + 9))
      {
        v5 = *(this + 19);
        if (v5)
        {
          if ((*(this + 113) & 1) == 0)
          {
            v6 = dispatch_semaphore_create(0);
            v7 = *(this + 13);
            *(this + 13) = v6;
            if (v7)
            {
              dispatch_release(v7);
            }

            v8 = std::string::basic_string[abi:ne200100]<0>(v24, "net.nw");
            v20[0] = 0;
            v23 = 0;
            v9 = ims::debug(v8, v20);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "cancel listener", 15);
            *(v9 + 17) = 0;
            (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v9 + 17) = 0;
            if (v23 == 1 && v22 < 0)
            {
              operator delete(__p);
            }

            if (v25 < 0)
            {
              operator delete(v24[0]);
            }

            *(this + 113) = 1;
            nw_listener_cancel(*(this + 9));
            v10 = SipStack::prefs(v5);
            v11 = ImsPrefs::InactivityTimerRTPSeconds(v10);
            v12 = dispatch_time(0, 1000000000 * v11);
            v13 = dispatch_semaphore_wait(*(this + 13), v12);
            v14 = std::string::basic_string[abi:ne200100]<0>(v24, "net.nw");
            v16[0] = 0;
            v19 = 0;
            v15 = ims::debug(v14, v16);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v15 + 8), "cancel listener complete result = ", 34);
            *(v15 + 17) = 0;
            MEMORY[0x1E6923360](*(v15 + 8), v13);
            *(v15 + 17) = 0;
            (*(*v15 + 64))(v15, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v15 + 17) = 0;
            if (v19 == 1 && v18 < 0)
            {
              operator delete(v17);
            }

            if (v25 < 0)
            {
              operator delete(v24[0]);
            }

            *(this + 113) = 0;
            nw_release(*(this + 9));
            *(this + 9) = 0;
          }
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v4);
    }
  }
}

void ImsRtpNw::cancelNwConnection(ImsRtpNw *this)
{
  v2 = *(this + 20);
  if (v2)
  {
    v3 = std::__shared_weak_count::lock(v2);
    if (v3)
    {
      v4 = *(this + 19);
    }

    else
    {
      v4 = 0;
    }
  }

  else
  {
    v4 = 0;
    v3 = 0;
  }

  nw_listener_set_new_connection_limit(*(this + 9), 0);
  if (*(this + 10))
  {
    v5 = v4 == 0;
  }

  else
  {
    v5 = 1;
  }

  if (!v5 && (*(this + 114) & 1) == 0)
  {
    v6 = dispatch_semaphore_create(0);
    v7 = *(this + 12);
    *(this + 12) = v6;
    if (v7)
    {
      dispatch_release(v7);
    }

    v8 = std::string::basic_string[abi:ne200100]<0>(v27, "net.nw");
    v23[0] = 0;
    v26 = 0;
    v9 = ims::debug(v8, v23);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v9 + 8), "cancel connectionId=", 20);
    *(v9 + 17) = 0;
    v10 = *(this + 10);
    id = nw_connection_get_id();
    MEMORY[0x1E69233B0](*(v9 + 8), id);
    *(v9 + 17) = 0;
    (*(*v9 + 64))(v9, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v9 + 17) = 0;
    if (v26 == 1 && v25 < 0)
    {
      operator delete(__p);
    }

    if (v28 < 0)
    {
      operator delete(v27[0]);
    }

    *(this + 114) = 1;
    nw_connection_cancel(*(this + 10));
    v12 = SipStack::prefs(v4);
    v13 = ImsPrefs::InactivityTimerRTPSeconds(v12);
    v14 = dispatch_time(0, 1000000000 * v13);
    dispatch_semaphore_wait(*(this + 12), v14);
    v15 = std::string::basic_string[abi:ne200100]<0>(v27, "net.nw");
    v19[0] = 0;
    v22 = 0;
    v16 = ims::debug(v15, v19);
    std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "cancel complete connectionId=", 29);
    *(v16 + 17) = 0;
    v17 = *(this + 10);
    v18 = nw_connection_get_id();
    MEMORY[0x1E69233B0](*(v16 + 8), v18);
    *(v16 + 17) = 0;
    (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
    *(v16 + 17) = 0;
    if (v22 == 1 && v21 < 0)
    {
      operator delete(v20);
    }

    if (v28 < 0)
    {
      operator delete(v27[0]);
    }

    *(this + 114) = 0;
    nw_release(*(this + 10));
    *(this + 10) = 0;
  }

  if (v3)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v3);
  }
}

void sub_1E515CE3C(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, void *__p, uint64_t a13, int a14, __int16 a15, char a16, char a17, uint64_t a18, char a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, int a24, __int16 a25, char a26, char a27, uint64_t a28, char a29)
{
  if (v29)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v29);
  }

  _Unwind_Resume(exception_object);
}

void ImsRtpNw::setNwDelegate(uint64_t a1, uint64_t *a2)
{
  std::string::basic_string[abi:ne200100]<0>(v12, "net.nw");
  v8[0] = 0;
  v11 = 0;
  v4 = ims::debug(v12, v8);
  std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v4 + 8), "setNwDelegate", 13);
  *(v4 + 17) = 0;
  (*(*v4 + 64))(v4, std::endl[abi:ne200100]<char,std::char_traits<char>>);
  *(v4 + 17) = 0;
  if (v11 == 1 && v10 < 0)
  {
    operator delete(__p);
  }

  if (v13 < 0)
  {
    operator delete(v12[0]);
  }

  v6 = *a2;
  v5 = a2[1];
  if (v5)
  {
    atomic_fetch_add_explicit((v5 + 16), 1uLL, memory_order_relaxed);
  }

  v7 = *(a1 + 144);
  *(a1 + 136) = v6;
  *(a1 + 144) = v5;
  if (v7)
  {
    std::__shared_weak_count::__release_weak(v7);
  }
}

void sub_1E515CFB4(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, char a18, void *a19, uint64_t a20, int a21, __int16 a22, char a23, char a24)
{
  if (a18 == 1 && a16 < 0)
  {
    operator delete(__p);
  }

  if (a24 < 0)
  {
    operator delete(a19);
  }

  _Unwind_Resume(exception_object);
}

void ___ZN8ImsRtpNw13setConnectionEP13nw_connectionb_block_invoke(uint64_t a1, int a2, NSObject *a3)
{
  v4 = *(a1 + 48);
  if (v4)
  {
    v7 = *(a1 + 32);
    v8 = std::__shared_weak_count::lock(v4);
    if (v8)
    {
      v9 = v8;
      v10 = *(a1 + 40);
      if (v10)
      {
        if (a3)
        {
          v11 = std::string::basic_string[abi:ne200100]<0>(v36, "net.hw");
          v32[0] = 0;
          v35 = 0;
          v12 = ims::error(v11, v32);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v12 + 8), "connection receive error: ", 26);
          *(v12 + 17) = 0;
          error_code = nw_error_get_error_code(a3);
          MEMORY[0x1E6923340](*(v12 + 8), error_code);
          *(v12 + 17) = 0;
          (*(*v12 + 64))(v12, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v12 + 17) = 0;
          if (v35 != 1 || (v34 & 0x80000000) == 0)
          {
            goto LABEL_9;
          }

          v14 = __p;
LABEL_8:
          operator delete(v14);
LABEL_9:
          if (v37 < 0)
          {
            operator delete(v36[0]);
          }

          goto LABEL_25;
        }

        if (a2 != 3)
        {
          if (a2 == 5)
          {
            v15 = std::string::basic_string[abi:ne200100]<0>(v36, "net.nw");
            v28[0] = 0;
            v31 = 0;
            v16 = ims::debug(v15, v28);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "cancelled connectionId=", 23);
            *(v16 + 17) = 0;
            v17 = *(v7 + 80);
            id = nw_connection_get_id();
            MEMORY[0x1E69233B0](*(v16 + 8), id);
            *(v16 + 17) = 0;
            (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v16 + 17) = 0;
            if (v31 == 1 && v30 < 0)
            {
              operator delete(v29);
            }

            if (v37 < 0)
            {
              operator delete(v36[0]);
            }

            if (*(v7 + 114) == 1)
            {
              dispatch_semaphore_signal(*(v7 + 96));
            }
          }

          goto LABEL_25;
        }

        if ((*(v10 + 88) & 1) == 0 && *(a1 + 56) == 1)
        {
          *(v10 + 88) = 1;
          ImsRtpNw::receiveData(v10);
          v19 = std::string::basic_string[abi:ne200100]<0>(v36, "net.nw");
          v24[0] = 0;
          v27 = 0;
          v20 = ims::debug(v19, v24);
          v38 = "ready connectionId=";
          v21 = ImsOutStream::putStreamable<char const*&>(v20, &v38);
          v22 = *(v7 + 80);
          v23 = nw_connection_get_id();
          MEMORY[0x1E69233B0](*(v21 + 8), v23);
          *(v21 + 17) = 0;
          (*(*v21 + 64))(v21, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v21 + 17) = 0;
          if (v27 != 1 || (v26 & 0x80000000) == 0)
          {
            goto LABEL_9;
          }

          v14 = v25;
          goto LABEL_8;
        }
      }

LABEL_25:
      std::__shared_weak_count::__release_shared[abi:ne200100](v9);
    }
  }
}

void ImsRtpNw::receiveData(ImsRtpNw *this)
{
  v2 = *(this + 3);
  if (!v2 || (v3 = *(this + 2), (v4 = std::__shared_weak_count::lock(v2)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v5 = v4;
  p_shared_weak_owners = &v4->__shared_weak_owners_;
  atomic_fetch_add_explicit(&v4->__shared_weak_owners_, 1uLL, memory_order_relaxed);
  std::__shared_weak_count::__release_shared[abi:ne200100](v4);
  v7 = *(this + 10);
  completion[0] = MEMORY[0x1E69E9820];
  completion[1] = 1174405120;
  completion[2] = ___ZN8ImsRtpNw11receiveDataEv_block_invoke;
  completion[3] = &__block_descriptor_tmp_34_3;
  completion[4] = this;
  completion[5] = v3;
  v9 = v5;
  atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
  nw_connection_receive_message(v7, completion);
  if (v9)
  {
    std::__shared_weak_count::__release_weak(v9);
  }

  std::__shared_weak_count::__release_weak(v5);
}

void sub_1E515D428(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, std::__shared_weak_count *a16)
{
  if (a16)
  {
    std::__shared_weak_count::__release_weak(a16);
  }

  std::__shared_weak_count::__release_weak(v16);
  _Unwind_Resume(a1);
}

void ___ZN8ImsRtpNw11receiveDataEv_block_invoke(void *a1, NSObject *a2, uint64_t a3, uint64_t a4, NSObject *a5)
{
  v6 = a1[6];
  if (v6)
  {
    v9 = a1[4];
    v10 = std::__shared_weak_count::lock(v6);
    if (v10)
    {
      v11 = v10;
      if (a1[5])
      {
        if (a5)
        {
          v12 = std::string::basic_string[abi:ne200100]<0>(v29, "net.hw");
          v25[0] = 0;
          v28 = 0;
          v13 = ims::error(v12, v25);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v13 + 8), "connection receive error: ", 26);
          *(v13 + 17) = 0;
          error_code = nw_error_get_error_code(a5);
          MEMORY[0x1E6923340](*(v13 + 8), error_code);
          *(v13 + 17) = 0;
          (*(*v13 + 64))(v13, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v13 + 17) = 0;
          if (v28 == 1 && v27 < 0)
          {
            operator delete(__p);
          }

          if (v30 < 0)
          {
            operator delete(v29[0]);
          }
        }

        else if (a2)
        {
          dispatch_data_get_size(a2);
          v15 = std::string::basic_string[abi:ne200100]<0>(v29, "net.nw");
          v21[0] = 0;
          v24 = 0;
          v16 = ims::debug(v15, v21);
          std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v16 + 8), "data received connectionId=", 27);
          *(v16 + 17) = 0;
          v17 = *(v9 + 80);
          id = nw_connection_get_id();
          MEMORY[0x1E69233B0](*(v16 + 8), id);
          *(v16 + 17) = 0;
          (*(*v16 + 64))(v16, std::endl[abi:ne200100]<char,std::char_traits<char>>);
          *(v16 + 17) = 0;
          if (v24 == 1 && v23 < 0)
          {
            operator delete(v22);
          }

          if (v30 < 0)
          {
            operator delete(v29[0]);
          }

          v20 = a1[5];
          v19 = a1[6];
          if (v19)
          {
            atomic_fetch_add_explicit((v19 + 16), 1uLL, memory_order_relaxed);
          }

          operator new();
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v11);
    }
  }
}

uint64_t ImsRtpNw::getNwDelegate@<X0>(uint64_t this@<X0>, void *a2@<X8>)
{
  v2 = *(this + 144);
  *a2 = *(this + 136);
  a2[1] = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return this;
}

uint64_t ims::SharedLoggable<ImsRtpNw>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));
  return a1;
}

void ims::SharedLoggable<ImsRtpNw>::~SharedLoggable(uint64_t a1)
{
  MEMORY[0x1E69225A0](a1 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable((a1 + 8));

  JUMPOUT(0x1E69235B0);
}

uint64_t *_ZNSt3__110unique_ptrIZZN8ImsRtpNw11receiveDataEvEUb_E3__0NS_14default_deleteIS2_EEED1B8ne200100Ev(uint64_t *a1)
{
  v2 = *a1;
  *a1 = 0;
  if (v2)
  {
    v3 = *(v2 + 8);
    if (v3)
    {
      std::__shared_weak_count::__release_weak(v3);
    }

    MEMORY[0x1E69235B0](v2, 0x1020C407DCD39BELL);
  }

  return a1;
}

uint64_t *_ZZN8dispatch5asyncIZZN8ImsRtpNw11receiveDataEvEUb_E3__0EEvP16dispatch_queue_sNSt3__110unique_ptrIT_NS5_14default_deleteIS7_EEEEENUlPvE_8__invokeESB_(void *a1)
{
  v10 = a1;
  v2 = a1[1];
  if (v2)
  {
    v3 = a1[3];
    v4 = std::__shared_weak_count::lock(v2);
    if (v4)
    {
      v5 = v4;
      if (*a1)
      {
        (*(*v3 + 24))(&v11, v3);
        if (v12)
        {
          v6 = std::__shared_weak_count::lock(v12);
          if (v6)
          {
            v7 = v11;
          }

          else
          {
            v7 = 0;
          }

          if (v12)
          {
            std::__shared_weak_count::__release_weak(v12);
          }

          if (v7)
          {
            std::string::basic_string[abi:ne200100]<0>(v16, "net.nw");
            LOBYTE(v11) = 0;
            v15 = 0;
            v8 = ims::debug(v16, &v11);
            std::__put_character_sequence[abi:ne200100]<char,std::char_traits<char>>(*(v8 + 8), "process receive", 15);
            *(v8 + 17) = 0;
            (*(*v8 + 64))(v8, std::endl[abi:ne200100]<char,std::char_traits<char>>);
            *(v8 + 17) = 0;
            if (v15 == 1 && v14 < 0)
            {
              operator delete(__p);
            }

            if (v17 < 0)
            {
              operator delete(v16[0]);
            }

            (*(*v7 + 16))(v7, a1[2]);
          }

          if (v6)
          {
            std::__shared_weak_count::__release_shared[abi:ne200100](v6);
          }
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v5);
    }
  }

  return _ZNSt3__110unique_ptrIZZN8ImsRtpNw11receiveDataEvEUb_E3__0NS_14default_deleteIS2_EEED1B8ne200100Ev(&v10);
}

void sub_1E515D9E8(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, void *__p, uint64_t a14, int a15, __int16 a16, char a17, char a18, uint64_t a19, char a20, void *a21, uint64_t a22, int a23, __int16 a24, char a25, char a26)
{
  if (v27)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v27);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v26);
  _ZNSt3__110unique_ptrIZZN8ImsRtpNw11receiveDataEvEUb_E3__0NS_14default_deleteIS2_EEED1B8ne200100Ev(&a10);
  _Unwind_Resume(a1);
}

void RegistrationAwareQueue::RegistrationAwareQueue(uint64_t a1, uint64_t *a2)
{
  ims::getQueue(object);
  *(a1 + 8) = 0;
  *(a1 + 16) = 0;
  v4 = object[0];
  *(a1 + 24) = object[0];
  if (v4)
  {
    dispatch_retain(v4);
  }

  *(a1 + 32) = 0;
  ctu::OsLogLogger::OsLogLogger((a1 + 40), "com.apple.ipTelephony", "push.mo.queue");
  if (v4)
  {
    dispatch_release(v4);
  }

  *a1 = &unk_1F5EF9338;
  *(a1 + 48) = &unk_1F5EF9368;
  *(a1 + 56) = 0;
  *(a1 + 64) = a1 + 64;
  *(a1 + 72) = a1 + 64;
  *(a1 + 80) = 0;
  v5 = *a2;
  *(a1 + 88) = *a2;
  v6 = a2[1];
  *(a1 + 96) = v6;
  if (v6)
  {
    atomic_fetch_add_explicit((v6 + 8), 1uLL, memory_order_relaxed);
    v5 = *(a1 + 88);
  }

  if (*(v5 + 47) < 0)
  {
    std::string::__init_copy_ctor_external(&v9, *(v5 + 24), *(v5 + 32));
  }

  else
  {
    v9 = *(v5 + 24);
  }

  v7 = std::string::append(&v9, "_RegistrationAwareQueueListener", 0x1FuLL);
  v8 = *&v7->__r_.__value_.__l.__data_;
  v11 = v7->__r_.__value_.__r.__words[2];
  *object = v8;
  v7->__r_.__value_.__l.__size_ = 0;
  v7->__r_.__value_.__r.__words[2] = 0;
  v7->__r_.__value_.__r.__words[0] = 0;
  ims::detail::to_string_impl<unsigned int,std::integral_constant<BOOL,false>>::operator()();
}

void sub_1E515DC28(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, void *__p, uint64_t a11, int a12, __int16 a13, char a14, char a15, void *a16, uint64_t a17, int a18, __int16 a19, char a20, char a21, uint64_t a22, void *a23, uint64_t a24, int a25, __int16 a26, char a27, char a28)
{
  v32 = *(v28 + 96);
  if (v32)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v32);
  }

  std::__list_imp<dispatch::block<void({block_pointer})(void)>>::clear(v30);
  MEMORY[0x1E69225A0](v28 + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(v29);
  _Unwind_Resume(a1);
}

void sub_1E515DCA0()
{
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(v0);
  if (v1)
  {
    dispatch_release(v1);
  }

  JUMPOUT(0x1E515DC98);
}

void RegistrationAwareQueue::~RegistrationAwareQueue(RegistrationAwareQueue *this)
{
  *this = &unk_1F5EF9338;
  *(this + 6) = &unk_1F5EF9368;
  RegistrationAwareQueue::runPendingBlocks_sync(this);
  (*(**(this + 11) + 200))(*(this + 11), this + 104);
  if (*(this + 127) < 0)
  {
    operator delete(*(this + 13));
  }

  v2 = *(this + 12);
  if (v2)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v2);
  }

  std::__list_imp<dispatch::block<void({block_pointer})(void)>>::clear(this + 8);
  MEMORY[0x1E69225A0](this + 40);
  ctu::SharedSynchronizable<SharedImsResultItem>::~SharedSynchronizable(this + 1);
}

{
  RegistrationAwareQueue::~RegistrationAwareQueue(this);

  JUMPOUT(0x1E69235B0);
}

void RegistrationAwareQueue::runPendingBlocks_sync(RegistrationAwareQueue *this)
{
  v16 = *MEMORY[0x1E69E9840];
  if (*(this + 10))
  {
    v2 = *(this + 5);
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      (*(*this + 16))(__p, this);
      if (v9 >= 0)
      {
        v3 = __p;
      }

      else
      {
        v3 = __p[0];
      }

      v4 = *(this + 10);
      *buf = 141558531;
      v11 = 1752392040;
      v12 = 2081;
      v13 = v3;
      v14 = 2048;
      v15 = v4;
      _os_log_impl(&dword_1E4C3F000, v2, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}sRunning %zu pending blocks", buf, 0x20u);
      if (v9 < 0)
      {
        operator delete(__p[0]);
      }
    }

    v5 = (this + 64);
    for (i = *(this + 9); i != v5; i = i[1])
    {
      (*(i[2] + 16))();
    }

    std::__list_imp<dispatch::block<void({block_pointer})(void)>>::clear(v5);
  }

  v7 = *MEMORY[0x1E69E9840];
}

void non-virtual thunk toRegistrationAwareQueue::~RegistrationAwareQueue(RegistrationAwareQueue *this)
{
  RegistrationAwareQueue::~RegistrationAwareQueue((this - 48));
}

{
  RegistrationAwareQueue::~RegistrationAwareQueue((this - 48));

  JUMPOUT(0x1E69235B0);
}

void RegistrationAwareQueue::init(RegistrationAwareQueue *this)
{
  v23 = *MEMORY[0x1E69E9840];
  v2 = *(this + 2);
  if (!v2 || (v3 = *(this + 11), v4 = *(this + 1), (v5 = std::__shared_weak_count::lock(v2)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v6 = v4 + 48;
  if (!v4)
  {
    v6 = 0;
  }

  v19 = v6;
  v20 = v5;
  (*(*v3 + 152))(v3, this + 104, &v19, *(this + 3));
  if (v20)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v20);
  }

  IPTelephonyManager::instance(&v17);
  IPTelephonyManager::getRegistrationManager(&__p);
  v7 = __p;
  v8 = *(this + 11);
  if (*(v8 + 47) < 0)
  {
    std::string::__init_copy_ctor_external(&v21, *(v8 + 24), *(v8 + 32));
  }

  else
  {
    v21 = *(v8 + 24);
  }

  atomic_store(IMSRegistrationManager::getImsRegistrationState(v7, &v21), this + 14);
  if (SHIBYTE(v21.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(v21.__r_.__value_.__l.__data_);
  }

  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  }

  if (v18)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v18);
  }

  v9 = *(this + 5);
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    (*(*this + 16))(&__p, this);
    p_p = __p;
    v11 = atomic_load(this + 14);
    if (v11 > 4)
    {
      v12 = "???";
    }

    else
    {
      v12 = off_1E876CF50[v11];
    }

    LODWORD(v21.__r_.__value_.__l.__data_) = 141558531;
    if (v16 >= 0)
    {
      p_p = &__p;
    }

    *(v21.__r_.__value_.__r.__words + 4) = 1752392040;
    WORD2(v21.__r_.__value_.__r.__words[1]) = 2081;
    *(&v21.__r_.__value_.__r.__words[1] + 6) = p_p;
    HIWORD(v21.__r_.__value_.__r.__words[2]) = 2080;
    v22 = v12;
    _os_log_impl(&dword_1E4C3F000, v9, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}sInitial state %s", &v21, 0x20u);
    if (v16 < 0)
    {
      operator delete(__p);
    }
  }

  v13 = *MEMORY[0x1E69E9840];
}

void sub_1E515E328(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, std::__shared_weak_count *a11, uint64_t a12, uint64_t a13, std::__shared_weak_count *a14, uint64_t a15, uint64_t a16, void *__p, uint64_t a18, int a19, __int16 a20, char a21, char a22)
{
  if (a11)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a11);
  }

  if (a14)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a14);
  }

  _Unwind_Resume(exception_object);
}

void RegistrationAwareQueue::addBlock(void *a1, uint64_t a2, void **a3)
{
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 1174405120;
  v11[2] = ___ZN22RegistrationAwareQueue8addBlockENSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEEN8dispatch5blockIU13block_pointerFvvEEE_block_invoke;
  v11[3] = &__block_descriptor_tmp_67;
  v11[4] = a1;
  v5 = *a3;
  if (*a3)
  {
    v5 = _Block_copy(v5);
  }

  aBlock = v5;
  if (*(a2 + 23) < 0)
  {
    std::string::__init_copy_ctor_external(&__p, *a2, *(a2 + 8));
  }

  else
  {
    __p = *a2;
  }

  v6 = a1[2];
  if (!v6 || (v7 = a1[1], (v8 = std::__shared_weak_count::lock(v6)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v9 = v8;
  v10 = a1[3];
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 1174405120;
  block[2] = ___ZNK3ctu20SharedSynchronizableI22RegistrationAwareQueueE15execute_wrappedEU13block_pointerFvvE_block_invoke;
  block[3] = &unk_1F5EF9668;
  block[5] = v7;
  v15 = v9;
  atomic_fetch_add_explicit(&v9->__shared_owners_, 1uLL, memory_order_relaxed);
  block[4] = v11;
  dispatch_async(v10, block);
  if (v15)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v15);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v9);
  if (SHIBYTE(__p.__r_.__value_.__r.__words[2]) < 0)
  {
    operator delete(__p.__r_.__value_.__l.__data_);
  }

  if (aBlock)
  {
    _Block_release(aBlock);
  }
}

void sub_1E515E4F0(_Unwind_Exception *exception_object, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, void *aBlock)
{
  if (aBlock)
  {
    _Block_release(aBlock);
  }

  _Unwind_Resume(exception_object);
}

uint64_t ___ZN22RegistrationAwareQueue8addBlockENSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEEN8dispatch5blockIU13block_pointerFvvEEE_block_invoke(uint64_t a1)
{
  v2 = atomic_load((*(a1 + 32) + 56));
  if (v2 != 2)
  {
    operator new();
  }

  RegistrationAwareQueue::runPendingBlocks_sync(*(a1 + 32));
  v3 = *(*(a1 + 40) + 16);

  return v3();
}

void sub_1E515E748(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, xpc_object_t object, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, std::__shared_weak_count *a18)
{
  if (a18)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a18);
  }

  xpc_release(*(v18 - 40));
  _Unwind_Resume(a1);
}

void __copy_helper_block_e8_40c43_ZTSN8dispatch5blockIU13block_pointerFvvEEE48c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE(std::string *a1, uint64_t a2)
{
  v4 = *(a2 + 40);
  if (v4)
  {
    v4 = _Block_copy(v4);
  }

  a1[1].__r_.__value_.__r.__words[2] = v4;
  if (*(a2 + 71) < 0)
  {
    std::string::__init_copy_ctor_external(a1 + 2, *(a2 + 48), *(a2 + 56));
  }

  else
  {
    v5 = *(a2 + 48);
    a1[2].__r_.__value_.__r.__words[2] = *(a2 + 64);
    *&a1[2].__r_.__value_.__l.__data_ = v5;
  }
}

void sub_1E515E828(_Unwind_Exception *exception_object)
{
  v3 = *(v1 + 40);
  if (v3)
  {
    _Block_release(v3);
  }

  _Unwind_Resume(exception_object);
}

void __destroy_helper_block_e8_40c43_ZTSN8dispatch5blockIU13block_pointerFvvEEE48c66_ZTSNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEE(uint64_t a1)
{
  if (*(a1 + 71) < 0)
  {
    operator delete(*(a1 + 48));
  }

  v2 = *(a1 + 40);
  if (v2)
  {
    _Block_release(v2);
  }
}

void RegistrationAwareQueue::handleRegistrationStateChanged(void *a1, int *a2)
{
  v3 = *a2;
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 0x40000000;
  v9[2] = ___ZN22RegistrationAwareQueue30handleRegistrationStateChangedERKN3ims17RegistrationStateE_block_invoke;
  v9[3] = &__block_descriptor_tmp_5_4;
  v9[4] = a1;
  v10 = v3;
  v4 = a1[2];
  if (!v4 || (v5 = a1[1], (v6 = std::__shared_weak_count::lock(v4)) == 0))
  {
    std::__throw_bad_weak_ptr[abi:ne200100]();
  }

  v7 = v6;
  v8 = a1[3];
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 1174405120;
  block[2] = ___ZNK3ctu20SharedSynchronizableI22RegistrationAwareQueueE15execute_wrappedEU13block_pointerFvvE_block_invoke;
  block[3] = &unk_1F5EF9668;
  block[5] = v5;
  v12 = v7;
  atomic_fetch_add_explicit(&v7->__shared_owners_, 1uLL, memory_order_relaxed);
  block[4] = v9;
  dispatch_async(v8, block);
  if (v12)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v12);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v7);
}

void ___ZN22RegistrationAwareQueue30handleRegistrationStateChangedERKN3ims17RegistrationStateE_block_invoke(uint64_t a1)
{
  v35 = *MEMORY[0x1E69E9840];
  v1 = *(a1 + 32);
  v2 = *(a1 + 40);
  v3 = atomic_load(v1 + 14);
  if (v2 != v3)
  {
    v5 = *(v1 + 5);
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      (*(*v1 + 16))(__p, v1);
      v6 = v26 >= 0 ? __p : __p[0];
      v7 = atomic_load(v1 + 14);
      v8 = v7 > 4 ? "???" : off_1E876CF50[v7];
      v9 = *(a1 + 40);
      v10 = v9 > 4 ? "???" : off_1E876CF50[v9];
      *buf = 141558787;
      v28 = 1752392040;
      v29 = 2081;
      v30 = v6;
      v31 = 2080;
      v32 = v8;
      v33 = 2080;
      v34 = v10;
      _os_log_impl(&dword_1E4C3F000, v5, OS_LOG_TYPE_DEFAULT, "%{private, mask.hash}sRegistration state changed from %s to %s", buf, 0x2Au);
      if (v26 < 0)
      {
        operator delete(__p[0]);
      }
    }

    v11 = *(a1 + 40);
    if (v11 == 4)
    {
      if (*(v1 + 10))
      {
        v12 = *(v1 + 5);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
        {
          (*(*v1 + 16))(__p, v1);
          v13 = v26 >= 0 ? __p : __p[0];
          v14 = *(v1 + 10);
          *buf = 141558531;
          v28 = 1752392040;
          v29 = 2081;
          v30 = v13;
          v31 = 2048;
          v32 = v14;
          _os_log_impl(&dword_1E4C3F000, v12, OS_LOG_TYPE_DEFAULT, "#W %{private, mask.hash}sSomething triggered deregister while %lu MO workitems are pending.  Registering again...", buf, 0x20u);
          if (v26 < 0)
          {
            operator delete(__p[0]);
          }
        }

        v15 = *(v1 + 2);
        if (!v15 || (v16 = *(v1 + 1), (v17 = std::__shared_weak_count::lock(v15)) == 0))
        {
          std::__throw_bad_weak_ptr[abi:ne200100]();
        }

        v18 = v17;
        p_shared_weak_owners = &v17->__shared_weak_owners_;
        atomic_fetch_add_explicit(&v17->__shared_weak_owners_, 1uLL, memory_order_relaxed);
        std::__shared_weak_count::__release_shared[abi:ne200100](v17);
        v20 = dispatch_time(0, 1000000000);
        v21 = *(v1 + 3);
        v23[0] = MEMORY[0x1E69E9820];
        v23[1] = 1174405120;
        v23[2] = ___ZN22RegistrationAwareQueue30handleRegistrationStateChangedERKN3ims17RegistrationStateE_block_invoke_3;
        v23[3] = &__block_descriptor_tmp_4_3;
        v23[4] = v1;
        v23[5] = v16;
        v24 = v18;
        atomic_fetch_add_explicit(p_shared_weak_owners, 1uLL, memory_order_relaxed);
        dispatch_after(v20, v21, v23);
        if (v24)
        {
          std::__shared_weak_count::__release_weak(v24);
        }

        std::__shared_weak_count::__release_weak(v18);
      }
    }

    else if (v11 == 2)
    {
      RegistrationAwareQueue::runPendingBlocks_sync(v1);
    }

    atomic_store(*(a1 + 40), v1 + 14);
  }

  v22 = *MEMORY[0x1E69E9840];
}

void ___ZN22RegistrationAwareQueue30handleRegistrationStateChangedERKN3ims17RegistrationStateE_block_invoke_3(void *a1)
{
  v2 = a1[6];
  if (v2)
  {
    v3 = a1[4];
    v4 = std::__shared_weak_count::lock(v2);
    if (v4)
    {
      v5 = v4;
      if (a1[5])
      {
        IPTelephonyManager::instance(&v10);
        v6 = v10;
        v7 = *(v3 + 88);
        if (*(v7 + 47) < 0)
        {
          std::string::__init_copy_ctor_external(&v9, *(v7 + 24), *(v7 + 32));
        }

        else
        {
          v9 = *(v7 + 24);
        }

        object = xpc_null_create();
        IPTelephonyManager::initializeTransient(v6, &v9, &object);
        xpc_release(object);
        object = 0;
        if (SHIBYTE(v9.__r_.__value_.__r.__words[2]) < 0)
        {
          operator delete(v9.__r_.__value_.__l.__data_);
        }

        if (v11)
        {
          std::__shared_weak_count::__release_shared[abi:ne200100](v11);
        }
      }

      std::__shared_weak_count::__release_shared[abi:ne200100](v5);
    }
  }
}

void sub_1E515ED9C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, xpc_object_t object, void *__p, uint64_t a12, int a13, __int16 a14, char a15, char a16, uint64_t a17, uint64_t a18, std::__shared_weak_count *a19)
{
  if (a19)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](a19);
  }

  std::__shared_weak_count::__release_shared[abi:ne200100](v19);
  _Unwind_Resume(a1);
}

uint64_t __copy_helper_block_e8_40c48_ZTSKNSt3__18weak_ptrI22RegistrationAwareQueueEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 16), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c48_ZTSKNSt3__18weak_ptrI22RegistrationAwareQueueEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_weak(v1);
  }
}

void std::__list_imp<dispatch::block<void({block_pointer})(void)>>::clear(uint64_t *a1)
{
  if (a1[2])
  {
    v2 = a1[1];
    v3 = *(*a1 + 8);
    v4 = *v2;
    *(v4 + 8) = v3;
    *v3 = v4;
    a1[2] = 0;
    if (v2 != a1)
    {
      do
      {
        v6 = v2[1];
        v5 = v2[2];
        if (v5)
        {
          _Block_release(v5);
        }

        operator delete(v2);
        v2 = v6;
      }

      while (v6 != a1);
    }
  }
}

void std::__shared_ptr_emplace<RegistrationAwareQueue::create(std::shared_ptr<ims::Client>)::QueueWrapper,std::allocator<RegistrationAwareQueue::create(std::shared_ptr<ims::Client>)::QueueWrapper>>::~__shared_ptr_emplace(std::__shared_weak_count *a1)
{
  a1->__vftable = &unk_1F5EF9538;
  std::__shared_weak_count::~__shared_weak_count(a1);

  JUMPOUT(0x1E69235B0);
}

void RegistrationAwareQueue::create(std::shared_ptr<ims::Client>)::QueueWrapper::~QueueWrapper(RegistrationAwareQueue *a1)
{
  RegistrationAwareQueue::~RegistrationAwareQueue(a1);

  JUMPOUT(0x1E69235B0);
}

void non-virtual thunk toRegistrationAwareQueue::create(std::shared_ptr<ims::Client>)::QueueWrapper::~QueueWrapper(uint64_t a1)
{
  RegistrationAwareQueue::~RegistrationAwareQueue((a1 - 48));
}

{
  RegistrationAwareQueue::~RegistrationAwareQueue((a1 - 48));

  JUMPOUT(0x1E69235B0);
}

uint64_t __copy_helper_block_e8_40c51_ZTSNSt3__110shared_ptrIK22RegistrationAwareQueueEE(uint64_t result, uint64_t a2)
{
  v2 = *(a2 + 48);
  *(result + 40) = *(a2 + 40);
  *(result + 48) = v2;
  if (v2)
  {
    atomic_fetch_add_explicit((v2 + 8), 1uLL, memory_order_relaxed);
  }

  return result;
}

void __destroy_helper_block_e8_40c51_ZTSNSt3__110shared_ptrIK22RegistrationAwareQueueEE(uint64_t a1)
{
  v1 = *(a1 + 48);
  if (v1)
  {
    std::__shared_weak_count::__release_shared[abi:ne200100](v1);
  }
}

CFStreamError CFReadStreamGetError(CFReadStreamRef stream)
{
  v1 = MEMORY[0x1EEDB7470](stream);
  result.error = v2;
  result.domain = v1;
  return result;
}

CFStreamError CFWriteStreamGetError(CFWriteStreamRef stream)
{
  v1 = MEMORY[0x1EEDB7F38](stream);
  result.error = v2;
  result.domain = v1;
  return result;
}

uint64_t ctu::cf::assign()
{
  return MEMORY[0x1EEE630D8]();
}

{
  return MEMORY[0x1EEE630E0]();
}

{
  return MEMORY[0x1EEE630E8]();
}

uint64_t xpc::dyn_cast_or_default()
{
  return MEMORY[0x1EEE63220]();
}

{
  return MEMORY[0x1EEE63228]();
}

uint64_t xpc::dyn_cast_or_default(xpc *this, const object *a2)
{
  return MEMORY[0x1EEE63230](this, a2);
}

{
  return MEMORY[0x1EEE63240](this, a2);
}

{
  return MEMORY[0x1EEE63258](this, a2);
}

uint64_t std::istream::operator>>()
{
  return MEMORY[0x1EEE63E28]();
}

{
  return MEMORY[0x1EEE63E40]();
}

{
  return MEMORY[0x1EEE63E50]();
}

uint64_t std::ostream::operator<<()
{
  return MEMORY[0x1EEE63EA0]();
}

{
  return MEMORY[0x1EEE63EB0]();
}

{
  return MEMORY[0x1EEE63EB8]();
}

{
  return MEMORY[0x1EEE63ED0]();
}

{
  return MEMORY[0x1EEE63ED8]();
}

{
  return MEMORY[0x1EEE63EE0]();
}

{
  return MEMORY[0x1EEE63EE8]();
}

{
  return MEMORY[0x1EEE63EF0]();
}

{
  return MEMORY[0x1EEE63EF8]();
}

{
  return MEMORY[0x1EEE63F00]();
}

{
  return MEMORY[0x1EEE63F08]();
}

void operator delete[]()
{
    ;
  }
}

void operator delete(void *__p)
{
    ;
  }
}

void operator delete()
{
    ;
  }
}

void operator new[]()
{
    ;
  }
}

void operator new()
{
    ;
  }
}