uint64_t sub_195A005F4()
{
  qword_1ED5DE090 = objc_alloc_init(IDSInternalQueueController);

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A00674(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00684(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00694(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006A4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006B4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006C4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006D4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006E4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A006F4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00704(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00714(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00724(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00734(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00744(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00754(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00764(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00774(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00784(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00794(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007A4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007B4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007C4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007D4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007E4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A007F4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00804(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00814(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00824(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00834(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00844(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A00854(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t sub_195A008A8()
{
  qword_1ED5DE060 = objc_alloc_init(IDSServiceAvailabilityController);

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A00A50()
{
  qword_1EAEDC060 = os_log_create("com.apple.IDS", "ServiceAvailability");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A00C30(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A00D74(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A00DB8(uint64_t a1)
{
  if ([*(*(a1 + 32) + 32) isValid])
  {
    v3 = [*(a1 + 32) listener];
    v2 = [v3 isSetupComplete];
    if (v2)
    {
      LOBYTE(v2) = [*(*(a1 + 32) + 16) isValid];
    }

    *(*(*(a1 + 40) + 8) + 24) = v2;
  }

  else
  {
    *(*(*(a1 + 40) + 8) + 24) = 0;
  }
}

void sub_195A00E94(uint64_t a1)
{
  if ([*(a1 + 32) isConnected])
  {
    v2 = +[IDSLogging DaemonController];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_INFO))
    {
      v11 = 0;
      v3 = " => Not blocking, already connected";
      v4 = &v11;
LABEL_9:
      _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_INFO, v3, v4, 2u);
      goto LABEL_10;
    }

    goto LABEL_10;
  }

  v5 = [MEMORY[0x1E69A6160] sharedInstance];
  if ([v5 systemIsShuttingDown])
  {

    goto LABEL_7;
  }

  v6 = *(*(a1 + 32) + 164);

  if (v6)
  {
LABEL_7:
    v2 = +[IDSLogging DaemonController];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_INFO))
    {
      *buf = 0;
      v3 = " => Not blocking, shutting down";
      v4 = buf;
      goto LABEL_9;
    }

LABEL_10:

    *(*(*(a1 + 40) + 8) + 24) = 0;
    return;
  }

  if (([*(a1 + 32) isConnected] & 1) == 0 && (objc_msgSend(*(a1 + 32), "isConnecting") & 1) == 0)
  {
    v7 = +[IDSLogging DaemonController];
    if (os_log_type_enabled(v7, OS_LOG_TYPE_INFO))
    {
      *v9 = 0;
      _os_log_impl(&dword_1959FF000, v7, OS_LOG_TYPE_INFO, " => Starting connect", v9, 2u);
    }

    [*(a1 + 32) connectToDaemonWithLaunch:1];
  }

  if (([*(a1 + 32) remoteObjectExists] & 1) == 0 && (*(*(a1 + 32) + 162) & 1) == 0)
  {
    v2 = +[IDSLogging DaemonController];
    if (!os_log_type_enabled(v2, OS_LOG_TYPE_INFO))
    {
      goto LABEL_10;
    }

    v8 = 0;
    v3 = " => No remote object, can't block";
    v4 = &v8;
    goto LABEL_9;
  }
}

void sub_195A01144(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A01204(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A01230(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) devices];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A01844(uint64_t a1)
{
  qword_1ED5DDFD8 = objc_alloc_init(*(a1 + 32));

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A01A00()
{
  qword_1ED5DDFD0 = os_log_create("com.apple.IDS", "_IDSService");

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A01A58()
{
  qword_1ED5DE058 = objc_alloc_init(IDSDaemonController);

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A01E3C()
{
  qword_1ED5DE088 = objc_alloc_init(IDSIDQueryController);

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A02010()
{
  qword_1ED5DDF88 = [[IDSInternalQueueController alloc] initWithName:"IDSIDQueryControllerQueue" contextKey:&unk_1EAEDDA08];

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A02060(uint64_t a1)
{
  v2 = [[_IDSIDQueryController alloc] initWithDelegateContext:*(a1 + 32) queueController:*(*(a1 + 32) + 16)];
  v3 = *(a1 + 32);
  v4 = *(v3 + 8);
  *(v3 + 8) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A02118()
{
  v0 = IDSGetMainBundleIdentifier();
  byte_1ED5DDF30 = [v0 isEqualToIgnoringCase:@"com.apple.springboard"];
}

void sub_195A0232C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A02430(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A024F0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A02698(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A03128(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 104);
  if (v2)
  {
    v3 = v2;
  }

  else
  {
    v3 = [MEMORY[0x1E695DFD8] set];
  }

  v4 = v3;
  if ([*(*(a1 + 32) + 112) count])
  {
    v5 = [v4 setByAddingObjectsFromSet:*(*(a1 + 32) + 112)];
    v6 = *(*(a1 + 40) + 8);
    v7 = *(v6 + 40);
    *(v6 + 40) = v5;
  }

  if (!*(*(*(a1 + 40) + 8) + 40))
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    if ([*(*(a1 + 32) + 96) count])
    {
      v9 = *(*(a1 + 32) + 96);
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = sub_195A03988;
      v15[3] = &unk_1E743E918;
      v16 = v8;
      [v9 enumerateKeysAndObjectsUsingBlock:v15];
    }

    v10 = *(a1 + 32);
    if (*(v10 + 112))
    {
      [v8 unionSet:?];
      v11 = *(a1 + 32);
      v12 = *(v11 + 112);
      *(v11 + 112) = 0;

      v10 = *(a1 + 32);
    }

    objc_storeStrong((v10 + 112), v8);
    v13 = *(*(a1 + 40) + 8);
    v14 = *(v13 + 40);
    *(v13 + 40) = v8;
  }
}

void sub_195A0329C(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 128);
  if (v2)
  {
    v3 = v2;
  }

  else
  {
    v3 = [MEMORY[0x1E695DFD8] set];
  }

  v4 = v3;
  if ([*(*(a1 + 32) + 136) count])
  {
    v5 = [v4 setByAddingObjectsFromSet:*(*(a1 + 32) + 136)];
    v6 = *(*(a1 + 40) + 8);
    v7 = *(v6 + 40);
    *(v6 + 40) = v5;
  }

  if (!*(*(*(a1 + 40) + 8) + 40))
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    if ([*(*(a1 + 32) + 120) count])
    {
      v9 = *(*(a1 + 32) + 120);
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = sub_195A03410;
      v15[3] = &unk_1E743E918;
      v16 = v8;
      [v9 enumerateKeysAndObjectsUsingBlock:v15];
    }

    v10 = *(a1 + 32);
    if (*(v10 + 136))
    {
      [v8 unionSet:?];
      v11 = *(a1 + 32);
      v12 = *(v11 + 136);
      *(v11 + 136) = 0;

      v10 = *(a1 + 32);
    }

    objc_storeStrong((v10 + 136), v8);
    v13 = *(*(a1 + 40) + 8);
    v14 = *(v13 + 40);
    *(v13 + 40) = v8;
  }
}

uint64_t sub_195A03790()
{
  qword_1ED5DE030 = os_log_create("com.apple.IDS", "DaemonController");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A03844(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = *(v2 + 112);
  *(v2 + 112) = 0;

  v4 = *(a1 + 32);
  v5 = *(v4 + 136);
  *(v4 + 136) = 0;

  *(*(a1 + 32) + 152) = 0;
  if ([*(*(a1 + 32) + 96) count])
  {
    [*(a1 + 32) _setAutoReconnect:1];
    v6 = *(a1 + 32);
    v9 = [v6 services];
    v7 = [*(a1 + 32) commands];
    [v6 connectToDaemonWithLaunch:1 services:v9 commands:v7 capabilities:{objc_msgSend(*(a1 + 32), "capabilities")}];
  }

  else
  {
    v8 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_1959FF000, v8, OS_LOG_TYPE_DEFAULT, "Disconnecting from daemon - no listeners", buf, 2u);
    }

    [*(a1 + 32) _setAutoReconnect:0];
    [*(a1 + 32) disconnectFromDaemon];
  }
}

uint64_t sub_195A039A4()
{
  qword_1ED5DDF60 = os_log_create("com.apple.IDS", "IDQuery");

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A039E8(uint64_t result)
{
  v1 = result;
  v2 = *(result + 32);
  if (!*(v2 + 152))
  {
    result = [*(v2 + 144) count];
    v2 = *(v1 + 32);
    if (result)
    {
      v3 = *(v2 + 144);
      v4[0] = MEMORY[0x1E69E9820];
      v4[1] = 3221225472;
      v4[2] = sub_195A03A94;
      v4[3] = &unk_1E743E918;
      v4[4] = v2;
      result = [v3 enumerateKeysAndObjectsUsingBlock:v4];
      v2 = *(v1 + 32);
    }
  }

  *(*(*(v1 + 40) + 8) + 24) = *(v2 + 152);
  return result;
}

uint64_t sub_195A03A94(uint64_t a1, uint64_t a2, void *a3)
{
  result = [a3 unsignedIntValue];
  *(*(a1 + 32) + 152) |= result;
  return result;
}

void sub_195A03B3C(uint64_t a1)
{
  v1 = [*(a1 + 32) listener];
  [v1 _noteDisconnected];
}

void sub_195A03BF4(uint64_t a1)
{
  v2 = *(a1 + 32);
  if (*(v2 + 162) == 1)
  {
    *(*(*(a1 + 40) + 8) + 24) = 1;
  }

  else if ([*(v2 + 32) isValid])
  {
    v4 = [*(a1 + 32) listener];
    if ([v4 isSetupComplete])
    {
      v3 = 0;
    }

    else
    {
      v3 = [*(*(a1 + 32) + 16) isValid];
    }

    *(*(*(a1 + 40) + 8) + 24) = v3;
  }

  else
  {
    *(*(*(a1 + 40) + 8) + 24) = 0;
  }
}

uint64_t sub_195A03CB0(uint64_t a1)
{
  *(*(a1 + 32) + 168) = 0;
  *(*(a1 + 32) + 169) = 0;
  *(*(a1 + 32) + 170) = 0;
  *(*(a1 + 32) + 171) = 0;
  return [*(a1 + 32) _callHandlersWithBlockOnIvarQueue:&unk_1F09E5DA0];
}

void sub_195A03DE0(void *a1, void *a2, void *a3, void *a4, void *a5)
{
  v9 = a1;
  v10 = a2;
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = [MEMORY[0x1E69A60F0] sharedInstance];
  v15 = [v14 isNonUIInstall];

  if (!v15)
  {
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = sub_195A05374;
    v18[3] = &unk_1E743FFD8;
    v16 = v20;
    v20[0] = v13;
    v17 = &v19;
    v19 = v12;
    sub_195A03F7C(v9, v10, v11, v18);
    goto LABEL_5;
  }

  if (v13)
  {
    v20[1] = MEMORY[0x1E69E9820];
    v20[2] = 3221225472;
    v20[3] = sub_195A5133C;
    v20[4] = &unk_1E743FF88;
    v16 = &v21;
    v21 = v11;
    v17 = &v22;
    v22 = v13;
    im_dispatch_after_primary_queue();
LABEL_5:
  }
}

void sub_195A03F7C(void *a1, void *a2, void *a3, void *a4)
{
  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  if (qword_1ED5DE040 != -1)
  {
    sub_195A042AC();
  }

  v11 = *MEMORY[0x1E69A5430];
  [v11 UTF8String];
  v12 = IMXPCCreateConnectionForServiceWithQueue();
  v13 = v11;
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = sub_195A04324;
  block[3] = &unk_1E743E878;
  v27 = v13;
  if (qword_1ED5DDFC8 != -1)
  {
    dispatch_once(&qword_1ED5DDFC8, block);
  }

  v14 = byte_1ED5DDFC0;

  if ((v14 & 1) == 0)
  {
    v15 = +[IDSLogging Connection];
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
    {
      sub_195B2A964(v13, v15);
    }
  }

  if (v12)
  {
    v9[2](v9, v12);
    handler[0] = MEMORY[0x1E69E9820];
    handler[1] = 3221225472;
    handler[2] = sub_195A05C2C;
    handler[3] = &unk_1E743FF38;
    v16 = v12;
    v25 = v16;
    xpc_connection_set_event_handler(v16, handler);
    xpc_connection_resume(v16);
    v17 = xpc_dictionary_create(0, 0, 0);
    if (v17)
    {
      IMInsertNSStringsToXPCDictionary();
      IMInsertDictionariesToXPCDictionary();
      xpc_dictionary_set_BOOL(v17, "setup-request", 1);
      v21[0] = MEMORY[0x1E69E9820];
      v21[1] = 3221225472;
      v21[2] = sub_195A04E8C;
      v21[3] = &unk_1E743FF60;
      v18 = v16;
      v22 = v18;
      v23 = v10;
      v19 = MEMORY[0x19A8BBEF0](v21);
      v20 = xpc_connection_send_message_with_reply_sync(v18, v17);
      (v19)[2](v19, v20);
    }
  }

  else if (v10)
  {
    (*(v10 + 2))(v10, 0, 0, 0);
  }
}

void sub_195A042C0()
{
  v2 = dispatch_queue_attr_make_with_autorelease_frequency(0, DISPATCH_AUTORELEASE_FREQUENCY_WORK_ITEM);
  v0 = dispatch_queue_create("com.apple.IDSDaemonRequestConnectionQueue", v2);
  v1 = qword_1ED5DE028;
  qword_1ED5DE028 = v0;
}

uint64_t sub_195A04324(uint64_t a1)
{
  getpid();
  v2 = *MEMORY[0x1E69E9BD0];
  [*(a1 + 32) UTF8String];
  result = sandbox_check();
  byte_1ED5DDFC0 = result == 0;
  return result;
}

void sub_195A04444(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A044B4()
{
  qword_1ED5DE020 = os_log_create("com.apple.IDS", "IDSAccountController");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A045C0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A04684(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A04728(uint64_t a1)
{
  if (*(*(a1 + 32) + 32))
  {
    v2 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
    {
      sub_195B271D8();
    }

    [*(*(a1 + 32) + 32) setTarget:0];
    [*(*(a1 + 32) + 32) invalidate];
    v3 = *(a1 + 32);
    v4 = *(v3 + 32);
    *(v3 + 32) = 0;
  }
}

void sub_195A047B4(uint64_t a1, void *a2)
{
  v2 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v2 daemonDisconnected];
  }
}

uint64_t sub_195A048BC(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) accounts];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A04A84(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A04E58(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A04E8C(uint64_t a1, void *a2)
{
  v18 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = v3;
  if (!v3)
  {
    v7 = +[IDSLogging Connection];
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      sub_195B2AA44();
    }

    goto LABEL_7;
  }

  if (MEMORY[0x19A8BC560](v3) == MEMORY[0x1E69E9E80])
  {
    v9 = xpc_dictionary_get_value(v4, "response");
    v5 = IMCreateDictionaryFromXPCObjectWithStandardAllowlist();
    if (v5)
    {
      v10 = 1;
    }

    else
    {
      v10 = xpc_dictionary_get_BOOL(v4, "granted");
    }

    v11 = +[IDSLogging Connection];
    if (os_log_type_enabled(v11, OS_LOG_TYPE_INFO))
    {
      v17[0] = 67109120;
      v17[1] = [v5 count];
      _os_log_impl(&dword_1959FF000, v11, OS_LOG_TYPE_INFO, " => Found response with %d keys", v17, 8u);
    }

    if (!v10)
    {
      v12 = +[IDSLogging Connection];
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        sub_195B2AA10();
      }
    }

    v6 = !v10;

    goto LABEL_22;
  }

  if (MEMORY[0x19A8BC560](v4) != MEMORY[0x1E69E9E98])
  {
LABEL_4:
    v5 = 0;
    v6 = 0;
LABEL_22:
    v8 = 1;
    goto LABEL_23;
  }

  if (v4 != MEMORY[0x1E69E9E20])
  {
    if (v4 != MEMORY[0x1E69E9E18])
    {
      goto LABEL_4;
    }

    v7 = +[IDSLogging Connection];
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      sub_195B2A9DC();
    }

LABEL_7:

    xpc_connection_cancel(*(a1 + 32));
    v5 = 0;
    v6 = 0;
    v8 = 0;
    goto LABEL_23;
  }

  v16 = +[IDSLogging Connection];
  if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
  {
    sub_195A05C34();
  }

  xpc_connection_cancel(*(a1 + 32));
  v5 = 0;
  v8 = 0;
  v6 = 1;
LABEL_23:
  v13 = *(a1 + 40);
  if (v13)
  {
    if (v8)
    {
      v14 = *(a1 + 32);
    }

    else
    {
      v14 = 0;
    }

    (*(v13 + 16))(v13, v14, v5, v6);
  }

  v15 = *MEMORY[0x1E69E9840];
}

void +[IDSDaemonController _blockUntilSendQueueIsEmpty](id a1, SEL a2)
{
  v2 = +[IDSDaemonController sharedInstance];
  [v2 _blockUntilSendQueueIsEmpty];
}

void -[IDSDaemonController _blockUntilSendQueueIsEmpty](IDSDaemonController *self, SEL a2)
{
  v5 = [MEMORY[0x1E69A60F0] sharedInstance];
  if ([v5 isNonUIInstall])
  {
  }

  else
  {
    v3 = [MEMORY[0x1E69A6160] sharedInstance];
    v4 = [v3 systemIsShuttingDown];

    if ((v4 & 1) == 0)
    {
      v6[0] = MEMORY[0x1E69E9820];
      v6[1] = 3221225472;
      v6[2] = sub_195A05308;
      v6[3] = &unk_1E743E878;
      v6[4] = self;
      [(IDSDaemonController *)self _performBlock:v6 wait:1];
    }
  }
}

uint64_t sub_195A052C4()
{
  qword_1ED5DE038 = os_log_create("com.apple.IDS", "Connection");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A05308(uint64_t a1)
{
  v2 = *(a1 + 32);
  if ((*(v2 + 162) & 1) == 0)
  {
    v3 = *(v2 + 80);
    if (v3)
    {
      dispatch_sync(v3, &unk_1F09E5B00);
    }

    v4 = [MEMORY[0x1E69A6148] defaultBroadcaster];
    [v4 blockUntilSendQueueIsEmpty];
  }
}

void sub_195A05374(uint64_t a1, void *a2, void *a3, char a4)
{
  v7 = a2;
  v8 = a3;
  if (v7)
  {
    v9 = [objc_alloc(MEMORY[0x1E69A6140]) initWithConnection:v7 protocol:&unk_1F0A2D150 alreadyConfigured:1 forceSecureCoding:1];
  }

  else
  {
    v9 = 0;
  }

  v10 = *(a1 + 40);
  if (v10)
  {
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = sub_195A05520;
    v14[3] = &unk_1E743FFB0;
    v17 = v10;
    v15 = v9;
    v16 = v8;
    v18 = a4;
    v11 = MEMORY[0x19A8BBEF0](v14);
    v12 = *(a1 + 32);
    if (!v12)
    {
      v12 = MEMORY[0x1E69E96A0];
      v13 = MEMORY[0x1E69E96A0];
    }

    dispatch_sync(v12, v11);
  }
}

void sub_195A054D4()
{
  v0 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEBUG))
  {
    sub_195B26DD0();
  }
}

void sub_195A055AC(uint64_t a1)
{
  if (*(*(a1 + 32) + 16))
  {
    v2 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
    {
      sub_195B2720C();
    }

    [*(*(a1 + 32) + 16) invalidate];
    v3 = *(a1 + 32);
    v4 = *(v3 + 16);
    *(v3 + 16) = 0;
  }
}

void sub_195A05714(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A059B0(uint64_t a1)
{
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "Connection complete, notifying", v5, 2u);
  }

  *(*(a1 + 32) + 169) = 1;
  v3 = +[IDSDaemonController sharedInstance];
  [v3 _noteSetupComplete];

  return [*(a1 + 32) _callHandlersWithBlockOnIvarQueue:&unk_1F09E5DC0];
}

void sub_195A05AC8(uint64_t a1)
{
  v2 = +[IDSLogging IDQuery];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "Purging idStatusCache", v5, 2u);
  }

  v3 = *(a1 + 32);
  v4 = *(v3 + 24);
  *(v3 + 24) = 0;
}

void sub_195A05B58(uint64_t a1)
{
  v10 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(*(a1 + 32) + 72);
    v8 = 134217984;
    v9 = v3;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "Cleaning up daemonConnectedGroup %p", &v8, 0xCu);
  }

  v4 = *(*(a1 + 32) + 72);
  if (v4)
  {
    dispatch_group_leave(v4);
    v5 = *(a1 + 32);
    v6 = *(v5 + 72);
    *(v5 + 72) = 0;
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A05C84(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, v9, OS_LOG_TYPE_ERROR, a4, &a9, 0x16u);
}

void sub_195A05CB0(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, &a9, 0xCu);
}

void sub_195A05CD8(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, &a9, 2u);
}

void sub_195A05D0C(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, v9, OS_LOG_TYPE_ERROR, a4, &a9, 0xCu);
}

void sub_195A05D2C(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, &a9, 0x16u);
}

void sub_195A05D6C(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_fault_impl(a1, a2, OS_LOG_TYPE_FAULT, a4, &a9, 0xCu);
}

uint64_t sub_195A05D88@<X0>(uint64_t result@<X0>, uint64_t a2@<X1>, uint64_t a3@<X8>)
{
  *(a2 + 4) = a3;
  *(a2 + 12) = 2112;
  *(a2 + 14) = result;
  return result;
}

uint64_t sub_195A05DF4()
{
  qword_1ED5DE000 = os_log_create("com.apple.IDS", "Accounts");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A06044(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0605C(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) state];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

id IDSCopyLocalDeviceUniqueID()
{
  v0 = +[IDSDaemonController sharedInstance];
  [v0 blockUntilConnected];

  v6 = 0;
  v7[0] = &v6;
  v7[1] = 0x3032000000;
  v7[2] = sub_195A00774;
  v7[3] = sub_195A03D60;
  v8 = 0;
  v1 = +[IDSInternalQueueController sharedInstance];
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = sub_195A06204;
  v5[3] = &unk_1E743E648;
  v5[4] = &v6;
  [v1 performBlock:v5 waitUntilDone:1];

  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
  {
    sub_195B33C60(v7, v2);
  }

  v3 = *(v7[0] + 40);
  _Block_object_dispose(&v6, 8);

  return v3;
}

void sub_195A061E8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A06204(uint64_t a1)
{
  v7 = +[IDSDaemonController sharedInstance];
  v2 = [v7 listener];
  v3 = [v2 deviceIdentifier];
  v4 = [v3 copy];
  v5 = *(*(a1 + 32) + 8);
  v6 = *(v5 + 40);
  *(v5 + 40) = v4;
}

void sub_195A0637C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A06394(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 144) copy];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A064F4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0669C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, os_activity_scope_state_s state, char a13)
{
  os_activity_scope_leave(&state);
  cut_arc_os_release();
  _Unwind_Resume(a1);
}

void IDSOSVersionFromString(void *a1@<X0>, void *a2@<X8>)
{
  *a2 = 0;
  a2[1] = 0;
  a2[2] = 0;
  v8 = [a1 componentsSeparatedByString:@"."];
  v3 = [v8 count];
  if (v3)
  {
    v4 = v3;
    v5 = [v8 objectAtIndexedSubscript:0];
    *a2 = [v5 integerValue];

    if (v4 != 1)
    {
      v6 = [v8 objectAtIndexedSubscript:1];
      a2[1] = [v6 integerValue];

      if (v4 >= 3)
      {
        v7 = [v8 objectAtIndexedSubscript:2];
        a2[2] = [v7 integerValue];
      }
    }
  }
}

void sub_195A06C64(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A06C7C(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) modelIdentifier];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A06DDC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A06DF4(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) uniqueIDOverride];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A06FF8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A07114(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) nsuuid];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A07338(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A07350(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) name];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A075A4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A075BC(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) productVersion];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A077A4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A077BC(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) supportsApplePay];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A0798C(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal];
  *(*(*(a1 + 40) + 8) + 24) = [v2 accountType];
}

void sub_195A07AB8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A08134(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0814C(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) isLocallyPaired];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A083CC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A083E4(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) uniqueID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

id sub_195A0868C(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = *MEMORY[0x1E69A5570];
  v5 = [v3 objectForKey:*MEMORY[0x1E69A5570]];

  if (v5 && (v6 = *(a1 + 32), [v3 objectForKey:v4], v7 = objc_claimAutoreleasedReturnValue(), LOBYTE(v6) = objc_msgSend(v6, "_isInvisibleAlias:", v7), v7, (v6 & 1) == 0))
  {
    v8 = v3;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

uint64_t IDSCopyRawAddressForDestination(void *a1)
{
  v1 = [a1 _stripPotentialTokenURIWithToken:0];
  v2 = [v1 _stripFZIDPrefix];

  return v2;
}

void sub_195A08808(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 accountInfo];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A08980(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A08BDC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A08BF4(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 serviceName];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A08C5C(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal];
  *(*(*(a1 + 40) + 8) + 24) = [v2 registrationStatus];
}

void sub_195A08DC8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A08DE0(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 loginID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A08E48(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 uniqueID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A08FC0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A090A8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A090C0(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal];
  *(*(*(a1 + 40) + 8) + 24) = [v2 isActive];
}

void sub_195A09374(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0938C(uint64_t a1, void *a2)
{
  result = [a2 count];
  *(*(*(a1 + 32) + 8) + 24) = result != 0;
  return result;
}

void sub_195A094A8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A095DC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A095F4(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) isActive];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A098C8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A098E0(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) relationship];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

uint64_t IDSCopyIDForDevice(void *a1)
{
  v24 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (![v1 isLocallyPaired])
  {
    goto LABEL_13;
  }

  if (([v1 relationship] & 2) != 0)
  {
    v21 = 0u;
    v22 = 0u;
    v19 = 0u;
    v20 = 0u;
    v2 = [v1 identities];
    v3 = [v2 countByEnumeratingWithState:&v19 objects:v23 count:16];
    if (v3)
    {
      v4 = v3;
      v5 = 0;
      v6 = *v20;
      v7 = *MEMORY[0x1E69A4BF8];
      v8 = *MEMORY[0x1E69A4E08];
      do
      {
        for (i = 0; i != v4; ++i)
        {
          if (*v20 != v6)
          {
            objc_enumerationMutation(v2);
          }

          v10 = [*(*(&v19 + 1) + 8 * i) objectForKey:v7];
          v11 = [v10 isEqualToString:v8];

          v5 |= v11;
        }

        v4 = [v2 countByEnumeratingWithState:&v19 objects:v23 count:16];
      }

      while (v4);

      if (v5)
      {
        goto LABEL_11;
      }
    }

    else
    {
    }

LABEL_13:
    v13 = [v1 pushToken];
    v15 = [v1 identities];
    v16 = [v1 service];
    v14 = _IDSCopyIDForPushTokenAndIdentitiesWithService();

    goto LABEL_14;
  }

LABEL_11:
  v12 = objc_alloc(MEMORY[0x1E696AEC0]);
  v13 = [v1 uniqueIDOverride];
  v14 = [v12 initWithFormat:@"device:%@", v13];
LABEL_14:

  v17 = *MEMORY[0x1E69E9840];
  return v14;
}

void sub_195A0A02C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0A044(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) productName];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A0A2B0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0A2C8(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) isNearby];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

id sub_195A0A984(uint64_t a1, void *a2)
{
  v2 = a2;
  v3 = *MEMORY[0x1E69A5570];
  v4 = [v2 objectForKey:*MEMORY[0x1E69A5570]];

  if (v4)
  {
    v5 = [v2 objectForKey:v3];
    v6 = [objc_alloc(MEMORY[0x1E69A5428]) initWithUnprefixedURI:v5];
    v7 = [v2 objectForKey:*MEMORY[0x1E69A5578]];
    v8 = [v7 integerValue];

    v9 = [v2 objectForKey:*MEMORY[0x1E69A5568]];
    v10 = v9;
    if (v9)
    {
      v11 = [v9 BOOLValue];
    }

    else
    {
      v11 = 1;
    }

    v12 = [objc_alloc(MEMORY[0x1E69A52A8]) initWithURI:v6 isUserVisible:v11 validationStatus:v8];
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

id sub_195A0AAB0(void *a1)
{
  v1 = a1;
  v2 = v1;
  if (!v1)
  {
    v8 = 0;
    goto LABEL_15;
  }

  v3 = [v1 domain];
  v4 = [v3 isEqualToIgnoringCase:*MEMORY[0x1E69A48E8]];

  if (!v4)
  {
    v9 = [v2 domain];
    v10 = [v9 isEqualToIgnoringCase:*MEMORY[0x1E69A5098]];

    if (v10)
    {
      v5 = [v2 code] - 1;
      if (v5 < 0x25)
      {
        v6 = &off_1E74426C8[v5];
        v7 = &unk_195B54150;
        goto LABEL_12;
      }
    }

    else
    {
      v11 = [v2 domain];
      v12 = [v11 isEqualToIgnoringCase:*MEMORY[0x1E69A49F8]];

      if (v12)
      {
        v5 = [v2 code] + 1;
        if (v5 < 4)
        {
          v6 = &off_1E74427F0[v5];
          v7 = &unk_195B54278;
          goto LABEL_12;
        }
      }
    }

LABEL_13:
    v13 = 0;
    v14 = 200;
    goto LABEL_14;
  }

  v5 = [v2 code] - 101;
  if (v5 >= 5)
  {
    goto LABEL_13;
  }

  v6 = &off_1E74426A0[v5];
  v7 = &unk_195B54128;
LABEL_12:
  v13 = *v6;
  v14 = v7[v5];
LABEL_14:
  v15 = objc_alloc(MEMORY[0x1E695DF20]);
  v16 = [v15 initWithObjectsAndKeys:{v2, *MEMORY[0x1E696AA08], v13, *MEMORY[0x1E696A578], 0}];
  v8 = [objc_alloc(MEMORY[0x1E696ABC0]) initWithDomain:@"com.apple.identityservices.error" code:v14 userInfo:v16];

LABEL_15:

  return v8;
}

uint64_t sub_195A0AD44(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) isDefaultPairedDevice];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A0AE4C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0B1B4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, ...)
{
  va_start(va, a8);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0B2C0(uint64_t a1, void *a2)
{
  v4 = a2;
  if (objc_opt_respondsToSelector())
  {
    v3 = [*(*(a1 + 32) + 56) object];
    [v4 account:v3 devicesChanged:*(a1 + 40)];
  }
}

void sub_195A0B53C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, os_activity_scope_state_s state, char a15)
{
  os_activity_scope_leave(&state);
  cut_arc_os_release();
  _Unwind_Resume(a1);
}

uint64_t sub_195A0B7D0(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) iCloudAccount];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A0B94C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0BA34(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0BC94(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0BCAC(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 accountRegisteredURIs];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

id sub_195A0BDFC(uint64_t a1, void *a2)
{
  v2 = MEMORY[0x1E69A5428];
  v3 = a2;
  v4 = [[v2 alloc] initWithPrefixedURI:v3];

  return v4;
}

void sub_195A0BFE4()
{
  v0 = dispatch_queue_attr_make_with_autorelease_frequency(0, DISPATCH_AUTORELEASE_FREQUENCY_WORK_ITEM);
  attr = dispatch_queue_attr_make_with_qos_class(v0, QOS_CLASS_UTILITY, 0);

  v1 = dispatch_queue_create("com.apple.IDS.IDSDeviceStateMonitoring", attr);
  v2 = qword_1ED5DDF78;
  qword_1ED5DDF78 = v1;
}

void sub_195A0C068(uint64_t a1, void *a2, void *a3)
{
  v13 = *MEMORY[0x1E69E9840];
  v4 = a2;
  v5 = a3;
  v6 = +[IDSLogging _IDSService];
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v7 = [v5 _internal];
    v9 = 138412546;
    v10 = v4;
    v11 = 2112;
    v12 = v7;
    _os_log_impl(&dword_1959FF000, v6, OS_LOG_TYPE_DEFAULT, "   %@ => %@", &v9, 0x16u);
  }

  v8 = *MEMORY[0x1E69E9840];
}

void sub_195A0C154(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal];
  *(*(*(a1 + 40) + 8) + 24) = [v2 canSend];
}

void sub_195A0C314(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0C32C(uint64_t a1)
{
  v5 = [*(a1 + 32) _internal];
  v2 = [v5 devices];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A0C4A4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0C4BC(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) pushToken];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A0CBF4(void *a1)
{
  v22 = *MEMORY[0x1E69E9840];
  v13 = 0u;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v1 = a1;
  v2 = [v1 countByEnumeratingWithState:&v13 objects:v21 count:16];
  if (v2)
  {
    v3 = v2;
    v4 = *v14;
    while (2)
    {
      for (i = 0; i != v3; ++i)
      {
        if (*v14 != v4)
        {
          objc_enumerationMutation(v1);
        }

        v6 = *(*(&v13 + 1) + 8 * i);
        if (([v6 isTransientAllowlistedAccount] & 1) != 0 || objc_msgSend(v6, "isFirstGDRAllowlistedAccount"))
        {
          v8 = [MEMORY[0x1E69A6138] IDSService];
          if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
          {
            if ([v6 isTransientAllowlistedAccount])
            {
              v9 = @"YES";
            }

            else
            {
              v9 = @"NO";
            }

            if ([v6 isFirstGDRAllowlistedAccount])
            {
              v10 = @"YES";
            }

            else
            {
              v10 = @"NO";
            }

            *buf = 138412546;
            v18 = v9;
            v19 = 2112;
            v20 = v10;
            _os_log_impl(&dword_1959FF000, v8, OS_LOG_TYPE_DEFAULT, "*** Account wants to drop devicesChanged callback {account.isTransientAllowlistedAccount: %@, account.isFirstGDRAllowlistedAccount: %@}", buf, 0x16u);
          }

          v7 = 1;
          goto LABEL_21;
        }
      }

      v3 = [v1 countByEnumeratingWithState:&v13 objects:v21 count:16];
      v7 = 0;
      if (v3)
      {
        continue;
      }

      break;
    }
  }

  else
  {
    v7 = 0;
  }

LABEL_21:

  v11 = *MEMORY[0x1E69E9840];
  return v7;
}

void sub_195A0D6F0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0D708(uint64_t a1)
{
  v5 = [*(*(a1 + 32) + 8) serviceProperties];
  v2 = [v5 identifier];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A0E018(uint64_t a1, void *a2)
{
  v4 = a2;
  if (objc_opt_respondsToSelector())
  {
    v3 = [*(*(a1 + 32) + 40) object];
    [v4 service:v3 devicesChanged:*(a1 + 40)];
  }
}

void sub_195A0E268(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0E280(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) supportsTethering];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A0E3C8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0E4F0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0E508(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) isConnected];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

uint64_t sub_195A0E5E4(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) service];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A0E634(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) identities];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

uint64_t IDSCopyIDForRapportPublicDeviceIdentifier(void *a1)
{
  v1 = MEMORY[0x1E696AEC0];
  v2 = a1;
  v3 = [[v1 alloc] initWithFormat:@"guest-device:%@", v2];

  return v3;
}

void sub_195A0E7AC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0E7C4()
{
  qword_1ED5DDFA8 = os_log_create("com.apple.IDS", "DaemonListener");

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A0E918(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0E930(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) description];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A0EA50(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0EA68(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) deviceType];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A0EC9C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0ECB4(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) productBuildVersion];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A0F064(void *a1)
{
  v2 = [[_IDSContinuity alloc] initWithDelegate:a1[5] queue:a1[6] delegateContext:a1[4]];
  v3 = a1[4];
  v4 = *(v3 + 8);
  *(v3 + 8) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A0F1CC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A0F2F8(void *a1)
{
  v1 = a1[5];
  v3 = a1[6];
  v2 = a1[7];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_startAdvertisingOfType_withData_withOptions_);
}

uint64_t sub_195A0F4DC(void *a1)
{
  v1 = a1[5];
  v3 = a1[7];
  v2 = a1[8];
  v4 = a1[6];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_startScanningForType_withData_mask_peers_);
}

uint64_t sub_195A0F5DC(void *a1)
{
  v1 = a1[5];
  v3 = a1[6];
  v2 = a1[7];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_startScanningForType_withData_mask_);
}

uint64_t sub_195A0F740(uint64_t a1)
{
  v1 = *(a1 + 40);
  v3 = *(a1 + 56);
  v2 = *(a1 + 64);
  v4 = *(a1 + 48);
  v5 = *(a1 + 72);
  v6 = *(a1 + 73);
  return MEMORY[0x1EEE66B58](*(*(a1 + 32) + 8), sel_startScanningForType_withData_mask_peers_boostedScan_duplicates_);
}

uint64_t sub_195A0F860(uint64_t a1)
{
  v1 = *(a1 + 40);
  v3 = *(a1 + 48);
  v2 = *(a1 + 56);
  v4 = *(a1 + 64);
  v5 = *(a1 + 65);
  return MEMORY[0x1EEE66B58](*(*(a1 + 32) + 8), sel_startScanningForType_withData_mask_boostedScan_duplicates_);
}

void sub_195A0FA74()
{
  v0 = +[IDSDaemonController sharedInstance];
  [v0 _agentDidLaunchNotification:0];
}

void sub_195A0FD0C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A0FD24(uint64_t a1)
{
  v45 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
  {
    sub_195B26B88(a1);
  }

  v4 = (a1 + 32);
  v3 = *(a1 + 32);
  if (*(v3 + 160) == 1 && *(a1 + 56) != 1)
  {
    v30 = 0;
    goto LABEL_42;
  }

  *(v3 + 160) = 1;
  if (![*(*v4 + 4) isValid] || (objc_msgSend(*(*v4 + 2), "isValid") & 1) == 0)
  {
    v6 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26C18((a1 + 32));
    }

    [*v4 _noteDisconnected];
    [*v4 _localObjectCleanup];
    v7 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v5 = v7;
    v8 = *(*v4 + 7);
    if (v8)
    {
      CFDictionarySetValue(v7, @"listenerID", v8);
    }

    v9 = [*v4 services];
    v10 = [v9 allObjects];

    if (v10)
    {
      CFDictionarySetValue(v5, @"services", v10);
    }

    v11 = [*v4 commands];
    v12 = [v11 allObjects];

    if (v12)
    {
      CFDictionarySetValue(v5, @"commands", v12);
    }

    v13 = [*(*v4 + 22) allObjects];
    if (v13)
    {
      CFDictionarySetValue(v5, @"notificationServices", v13);
    }

    v14 = IMGetMainBundleIdentifier();
    if (v14)
    {
      CFDictionarySetValue(v5, @"bundleID", v14);
    }

    v15 = [MEMORY[0x1E696AE30] processInfo];
    v16 = [v15 processName];

    if (v16)
    {
      CFDictionarySetValue(v5, @"processName", v16);
    }

    v17 = [MEMORY[0x1E69A6138] timing];
    v18 = os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT);

    if (v18)
    {
      v19 = [MEMORY[0x1E695DF00] date];
      if (v19)
      {
        CFDictionarySetValue(v5, @"agentRequested", v19);
      }
    }

    if ([*v4 remoteObjectExists])
    {
      v20 = *(a1 + 40);
      if (!v20)
      {
        goto LABEL_34;
      }

      v21 = *v4;
      v37[0] = MEMORY[0x1E69E9820];
      v37[1] = 3221225472;
      v37[2] = sub_195A1094C;
      v37[3] = &unk_1E743E850;
      v38 = v20;
      [v21 _performBlock:v37];
      v22 = v38;
    }

    else
    {
      v23 = ++*(*v4 + 11);
      v24 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 134217984;
        v44 = v23;
        _os_log_impl(&dword_1959FF000, v24, OS_LOG_TYPE_DEFAULT, "Requesting connectionID %lu usingSync YES", buf, 0xCu);
      }

      v39[0] = MEMORY[0x1E69E9820];
      v39[1] = 3221225472;
      v39[2] = sub_195A1028C;
      v39[3] = &unk_1E743E828;
      v39[4] = *(a1 + 32);
      v40 = v5;
      v42 = v23;
      v41 = *(a1 + 40);
      v25 = MEMORY[0x19A8BBEF0](v39);
      v26 = [*(a1 + 32) connectingQueue];
      dispatch_async(v26, v25);

      *(*(*(a1 + 48) + 8) + 24) = 1;
      v22 = v40;
    }

LABEL_34:
    if (*(*(*(a1 + 48) + 8) + 24) == 1)
    {
      if (qword_1ED5DDFB8 != -1)
      {
        sub_195B26C8C();
      }

      WeakRetained = objc_loadWeakRetained(*v4 + 1);
      v28 = dispatch_get_global_queue(0, 0);
      v32 = MEMORY[0x1E69E9820];
      v33 = 3221225472;
      v34 = sub_195A10998;
      v35 = &unk_1E743E878;
      v29 = WeakRetained;
      v36 = v29;
      dispatch_async(v28, &v32);

      if (([*(*v4 + 5) _hidingDisconnect] & 1) == 0)
      {
        dispatch_async(MEMORY[0x1E69E96A0], &unk_1F09E5AE0);
      }
    }

    goto LABEL_40;
  }

  v5 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEBUG))
  {
    sub_195B26CB4();
  }

LABEL_40:

  v30 = 1;
LABEL_42:
  *(*(*(a1 + 48) + 8) + 24) = v30;
  v31 = *MEMORY[0x1E69E9840];
}

void sub_195A1028C(uint64_t a1)
{
  v1 = *(a1 + 32);
  v2 = *(a1 + 40);
  v3 = *(v1 + 56);
  v4 = *(v1 + 64);
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = sub_195A1037C;
  v9[3] = &unk_1E743E7D8;
  v5 = *(a1 + 56);
  v9[4] = v1;
  v9[5] = v5;
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A10588;
  v6[3] = &unk_1E743E800;
  v8 = v5;
  v6[4] = v1;
  v7 = *(a1 + 48);
  sub_195A03DE0(v3, v2, v9, v4, v6);
}

void sub_195A1037C(uint64_t a1, void *a2)
{
  v3 = a2;
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = sub_195A1041C;
  v7[3] = &unk_1E743E7B0;
  v5 = *(a1 + 32);
  v4 = *(a1 + 40);
  v8 = v3;
  v9 = v4;
  v7[4] = v5;
  v6 = v3;
  [v5 _performBlock:v7 wait:1];
}

void sub_195A1041C(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  if (*(a1 + 48) == *(*(a1 + 32) + 88))
  {
    v2 = [MEMORY[0x1E696AD88] defaultCenter];
    [v2 removeObserver:*(a1 + 32) name:*MEMORY[0x1E69A5FB8] object:*(*(a1 + 32) + 32)];

    [*(a1 + 32) _localObjectCleanup];
    v3 = [objc_alloc(MEMORY[0x1E69A60E8]) initWithTarget:*(*(a1 + 32) + 40) connection:*(a1 + 40) protocol:&unk_1F0A32F70 forceSecureCoding:1 offMainThread:1];
    v4 = *(a1 + 32);
    v5 = *(v4 + 32);
    *(v4 + 32) = v3;
    v6 = *MEMORY[0x1E69E9840];

    MEMORY[0x1EEE66BB8]();
  }

  else
  {
    v7 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = *(*(a1 + 32) + 88);
      v10 = 134217984;
      v11 = v8;
      _os_log_impl(&dword_1959FF000, v7, OS_LOG_TYPE_DEFAULT, "ConnectionID %lu is more recent, ignoring.", &v10, 0xCu);
    }

    v9 = *MEMORY[0x1E69E9840];
  }
}

void sub_195A10588(uint64_t *a1, void *a2, void *a3, int a4)
{
  v46 = *MEMORY[0x1E69E9840];
  v8 = a2;
  v9 = a3;
  v11 = (a1 + 4);
  v10 = a1[4];
  if (a1[6] == *(v10 + 88) && (v12 = *(v10 + 32)) != 0 && ([v12 wasInterrupted] & 1) == 0)
  {
    v13 = *(*v11 + 162);
  }

  else
  {
    v13 = 0;
  }

  v14 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    v15 = a1[6];
    v16 = @"NO";
    if (a4)
    {
      v17 = @"YES";
    }

    else
    {
      v17 = @"NO";
    }

    if (v13)
    {
      v18 = @"YES";
    }

    else
    {
      v18 = @"NO";
    }

    v19 = a1[4];
    v20 = *(v19 + 32);
    if (*(v19 + 162))
    {
      v16 = @"YES";
    }

    v36 = 134219010;
    v37 = v15;
    v38 = 2112;
    v39 = v17;
    v40 = 2112;
    v41 = v18;
    v42 = 2112;
    v43 = v20;
    v44 = 2112;
    v45 = v16;
    _os_log_impl(&dword_1959FF000, v14, OS_LOG_TYPE_DEFAULT, "Completed connection {connectionID %lu, fatalError %@, relevantConnection: %@, localObject: %@, acquiringDaemonConnection: %@}", &v36, 0x34u);
  }

  v21 = *v11;
  if (v13)
  {
    *(v21 + 165) = a4;
    v21 = *v11;
    if (a4)
    {
      if (*(v21 + 9))
      {
        dispatch_group_leave(*(v21 + 9));
        v22 = *(*v11 + 9);
        *(*v11 + 9) = 0;

        v21 = *v11;
      }
    }
  }

  if (a1[6] == *(v21 + 11))
  {
    [v21 _remoteObjectCleanup];
    objc_storeStrong(*v11 + 2, a2);
    if ([*v11 remoteObjectExists] && (objc_msgSend(*v11, "localObject"), v23 = objc_claimAutoreleasedReturnValue(), v24 = objc_msgSend(v23, "isValid"), v23, v24))
    {
      v25 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v25, OS_LOG_TYPE_DEBUG))
      {
        sub_195B26D5C(a1 + 4);
      }

      v26 = [MEMORY[0x1E696AD88] defaultCenter];
      [v26 addObserver:*v11 selector:sel_remoteObjectDiedNotification_ name:*MEMORY[0x1E69A6038] object:*(*v11 + 2)];

      v27 = [MEMORY[0x1E696AD88] defaultCenter];
      [v27 addObserver:*v11 selector:sel_localObjectDiedNotification_ name:*MEMORY[0x1E69A5FB8] object:*(*v11 + 4)];

      [*(*v11 + 5) connectionComplete:1 withResponse:v9];
    }

    else
    {
      v29 = [MEMORY[0x1E69A6138] warning];
      if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
      {
        v30 = *(*v11 + 7);
        v36 = 138412290;
        v37 = v30;
        _os_log_impl(&dword_1959FF000, v29, OS_LOG_TYPE_DEFAULT, "  Failed to build remote object for listener: %@", &v36, 0xCu);
      }

      [*v11 _remoteObjectCleanup];
      [*v11 _localObjectCleanup];
    }

    *(a1[4] + 156) = 0;
    v31 = a1[4];
    v32 = [v31 services];
    v33 = [a1[4] commands];
    [v31 _setServices:v32 commands:v33 capabilities:{objc_msgSend(a1[4], "capabilities")}];

    v34 = a1[5];
    if (v34)
    {
      (*(v34 + 16))();
    }
  }

  else
  {
    v28 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26CE8(v11);
    }
  }

  v35 = *MEMORY[0x1E69E9840];
}

uint64_t sub_195A10998(uint64_t a1)
{
  v2 = *(a1 + 32);
  result = objc_opt_respondsToSelector();
  if (result)
  {
    v4 = *(a1 + 32);

    return [v4 performSelector:sel_daemonControllerWillConnect withObject:0];
  }

  return result;
}

void sub_195A109F8()
{
  v0 = [MEMORY[0x1E696AD88] defaultCenter];
  [v0 postNotificationName:@"__kIDSDaemonWillConnectNotification" object:0];
}

uint64_t sub_195A10B88(uint64_t a1)
{
  v24 = *MEMORY[0x1E69E9840];
  *(*(a1 + 32) + 160) = 0;
  v2 = *(a1 + 32);
  if (*(v2 + 162) == 1)
  {
    v3 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = *(*(a1 + 32) + 80);
      *buf = 134217984;
      v23 = v4;
      _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "Resume at disconnect %p", buf, 0xCu);
    }

    *(*(a1 + 32) + 162) = 0;
    dispatch_resume(*(*(a1 + 32) + 80));
    v2 = *(a1 + 32);
  }

  v5 = *(v2 + 104);
  *(v2 + 104) = 0;

  v6 = *(a1 + 32);
  v7 = *(v6 + 128);
  *(v6 + 128) = 0;

  *(*(a1 + 32) + 156) = 0;
  if (([*(a1 + 32) localObjectExists] & 1) != 0 || objc_msgSend(*(a1 + 32), "remoteObjectExists"))
  {
    if ((*(a1 + 40) & 1) == 0)
    {
      +[IDSDaemonController _blockUntilSendQueueIsEmpty];
    }

    v8 = [MEMORY[0x1E696AD88] defaultCenter];
    [v8 removeObserver:*(a1 + 32) name:*MEMORY[0x1E69A6038] object:0];

    v9 = [MEMORY[0x1E696AD88] defaultCenter];
    [v9 removeObserver:*(a1 + 32) name:*MEMORY[0x1E69A5FB8] object:0];

    [*(a1 + 32) _remoteObjectCleanup];
    [*(a1 + 32) _localObjectCleanup];
    if ((*(a1 + 40) & 1) == 0)
    {
      *(*(a1 + 32) + 161) = 1;
    }

    v21[0] = MEMORY[0x1E69E9820];
    v21[1] = 3221225472;
    v21[2] = sub_195A10E7C;
    v21[3] = &unk_1E743E878;
    v21[4] = *(a1 + 32);
    v10 = MEMORY[0x19A8BBEF0](v21);
    dispatch_async(MEMORY[0x1E69E96A0], &unk_1F09E5B40);
    v11 = [*(a1 + 32) listener];
    [v11 _setHidingDisconnect:1];

    if ([*(a1 + 32) _autoReconnect])
    {
      v12 = dispatch_time(0, 5000000000);
      v13 = *(*(a1 + 32) + 64);
      v16 = MEMORY[0x1E69E9820];
      v17 = 3221225472;
      v18 = sub_195A1118C;
      v19 = &unk_1E743E850;
      v20 = v10;
      dispatch_after(v12, v13, &v16);
    }

    else
    {
      v10[2](v10);
    }
  }

  result = [*(a1 + 32) _noteDisconnected];
  v15 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_195A10E7C(uint64_t a1)
{
  v2 = [*(a1 + 32) listener];
  [v2 _setHidingDisconnect:0];

  if ([*(a1 + 32) isConnected] & 1) != 0 || (objc_msgSend(*(a1 + 32), "isConnecting"))
  {
    v3 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26E38();
    }
  }

  else
  {
    v4 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26E04();
    }

    WeakRetained = objc_loadWeakRetained((*(a1 + 32) + 8));
    v6 = objc_opt_respondsToSelector();

    if (v6)
    {
      v7 = objc_loadWeakRetained((*(a1 + 32) + 8));
      [v7 performSelector:sel_daemonControllerDidDisconnect withObject:0];
    }

    v8 = objc_loadWeakRetained((*(a1 + 32) + 8));
    v9 = objc_opt_respondsToSelector();

    if (v9)
    {
      v10 = objc_loadWeakRetained((*(a1 + 32) + 8));
      [v10 performSelector:sel_daemonConnectionLost withObject:0];
    }

    dispatch_async(MEMORY[0x1E69E96A0], &unk_1F09E5B20);
  }
}

void sub_195A10FE8()
{
  v0 = [MEMORY[0x1E696AD88] defaultCenter];
  [v0 postNotificationName:@"__kIDSDaemonConnectionLostNotification" object:0];

  v1 = [MEMORY[0x1E696AD88] defaultCenter];
  [v1 postNotificationName:@"__kIDSDaemonDidDisconnectNotification" object:0];
}

void sub_195A110CC()
{
  v0 = [MEMORY[0x1E696AD88] defaultCenter];
  [v0 postNotificationName:@"__k_IDSDaemonDidDisconnectNotification" object:0];
}

void sub_195A113E0(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  if (*(a1 + 40) == 1)
  {
    v2 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = [MEMORY[0x1E69A6160] sharedInstance];
      v4 = [v3 systemIsShuttingDown];
      v5 = @"NO";
      if (v4)
      {
        v6 = @"YES";
      }

      else
      {
        v6 = @"NO";
      }

      if (*(*(a1 + 32) + 164))
      {
        v5 = @"YES";
      }

      v8 = 138412546;
      v9 = v6;
      v10 = 2112;
      v11 = v5;
      _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "  Connecting to idsdaemon system is shutting down: %@  hasBeenSuspended %@", &v8, 0x16u);
    }
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A114F0()
{
  v0 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v1 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "XPC has informed us that a fatal error has occured, we will not be attempting to reconnect any further", v1, 2u);
  }
}

void sub_195A11560(uint64_t a1)
{
  v27 = *MEMORY[0x1E69E9840];
  if (*(a1 + 60) == 1)
  {
    v2 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      *buf = 67109120;
      LODWORD(v20) = v3;
      _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "connectToDaemonWithLaunch calling into _setServices capabilities %d", buf, 8u);
    }
  }

  [*(a1 + 32) _setServices:*(a1 + 40) commands:*(a1 + 48) capabilities:*(a1 + 56)];
  if (([*(a1 + 32) isConnected] & 1) != 0 || objc_msgSend(*(a1 + 32), "isConnecting"))
  {
    if (*(a1 + 60) == 1)
    {
      v4 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "Already connected... not connecting", buf, 2u);
      }
    }
  }

  else
  {
    if (*(a1 + 60) == 1)
    {
      v6 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        v7 = @"NO";
        if (*(a1 + 61))
        {
          v7 = @"YES";
        }

        v8 = *(a1 + 40);
        v9 = *(a1 + 48);
        v10 = *(a1 + 56);
        *buf = 138413058;
        v20 = v7;
        v21 = 2112;
        v22 = v8;
        v23 = 2112;
        v24 = v9;
        v25 = 1024;
        v26 = v10;
        _os_log_impl(&dword_1959FF000, v6, OS_LOG_TYPE_DEFAULT, "_connectToDaemonWithLaunch: %@ services: %@ commands: %@ capabilities: %d", buf, 0x26u);
      }
    }

    if (![*(a1 + 32) remoteObjectExists] || (objc_msgSend(*(*(a1 + 32) + 32), "isValid") & 1) == 0)
    {
      *(*(a1 + 32) + 161) = 0;
      v11 = *(a1 + 32);
      if ((*(v11 + 162) & 1) == 0)
      {
        *(v11 + 162) = 1;
        v12 = [MEMORY[0x1E69A6138] registration];
        if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
        {
          v13 = *(*(a1 + 32) + 80);
          *buf = 134217984;
          v20 = v13;
          _os_log_impl(&dword_1959FF000, v12, OS_LOG_TYPE_DEFAULT, "Suspend at connect %p", buf, 0xCu);
        }

        dispatch_suspend(*(*(a1 + 32) + 80));
        v18[0] = MEMORY[0x1E69E9820];
        v18[1] = 3221225472;
        v18[2] = sub_195A118E0;
        v18[3] = &unk_1E743E878;
        v18[4] = *(a1 + 32);
        v14 = MEMORY[0x19A8BBEF0](v18);
        if (([*(a1 + 32) _makeConnectionWithLaunch:*(a1 + 61) completionBlock:v14] & 1) == 0)
        {
          v15 = *(a1 + 32);
          if (*(v15 + 162) == 1)
          {
            *(v15 + 162) = 0;
            v16 = [MEMORY[0x1E69A6138] registration];
            if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
            {
              v17 = *(*(a1 + 32) + 80);
              *buf = 134217984;
              v20 = v17;
              _os_log_impl(&dword_1959FF000, v16, OS_LOG_TYPE_DEFAULT, "Resume due to failed connect %p", buf, 0xCu);
            }

            dispatch_resume(*(*(a1 + 32) + 80));
          }
        }
      }
    }
  }

  v5 = *MEMORY[0x1E69E9840];
}

void sub_195A118E0(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  v2 = *(a1 + 32);
  if (v2[162] == 1)
  {
    v3 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = *(*(a1 + 32) + 80);
      v10 = 134217984;
      v11 = v4;
      _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "Resume due to connect completion %p", &v10, 0xCu);
    }

    *(*(a1 + 32) + 162) = 0;
    dispatch_resume(*(*(a1 + 32) + 80));
    v2 = *(a1 + 32);
  }

  if ([v2 remoteObjectExists])
  {
    WeakRetained = objc_loadWeakRetained((*(a1 + 32) + 8));
    v6 = objc_opt_respondsToSelector();

    if (v6)
    {
      v7 = objc_loadWeakRetained((*(a1 + 32) + 8));
      [v7 performSelector:sel_daemonControllerDidConnect withObject:0];
    }

    dispatch_async(MEMORY[0x1E69E96A0], &unk_1F09E5B80);
  }

  else
  {
    v8 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26E6C();
    }

    [*(a1 + 32) remoteObjectDiedNotification:0];
  }

  v9 = *MEMORY[0x1E69E9840];
}

void sub_195A11A68()
{
  v0 = [MEMORY[0x1E696AD88] defaultCenter];
  [v0 postNotificationName:@"__k_IDSDaemonDidConnectNotification" object:0];
}

void sub_195A11EE4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A11EFC(uint64_t a1)
{
  v2 = a1 + 32;
  v3 = *(*(a1 + 32) + 104);
  if (!v3 || ([v3 isEqualToSet:*(a1 + 40)] & 1) == 0)
  {
    v4 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEBUG))
    {
      sub_195B26EA0(a1, v2);
    }

    objc_storeStrong((*(a1 + 32) + 104), *(a1 + 40));
    *(*(*(a1 + 48) + 8) + 24) = 1;
  }
}

void sub_195A12074(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A1208C(uint64_t a1)
{
  v14 = *MEMORY[0x1E69E9840];
  v2 = *(*(a1 + 32) + 128);
  if (v2)
  {
    v3 = 0;
  }

  else
  {
    v5 = *(a1 + 40);
    if (!v5)
    {
      v3 = 0;
      goto LABEL_9;
    }

    v3 = [v5 count] != 0;
    v2 = *(*(a1 + 32) + 128);
    if (!v2)
    {
      goto LABEL_9;
    }
  }

  if (*(a1 + 40))
  {
    v4 = [v2 isEqualToSet:?] ^ 1;
    goto LABEL_10;
  }

LABEL_9:
  v4 = 0;
LABEL_10:
  if (v4 | v3)
  {
    v6 = +[IDSLogging DaemonController];
    if (os_log_type_enabled(v6, OS_LOG_TYPE_INFO))
    {
      v7 = *(a1 + 40);
      v8 = *(*(a1 + 32) + 128);
      v10 = 138412546;
      v11 = v7;
      v12 = 2112;
      v13 = v8;
      _os_log_impl(&dword_1959FF000, v6, OS_LOG_TYPE_INFO, "Set commands: %@  (Previous: %@)", &v10, 0x16u);
    }

    objc_storeStrong((*(a1 + 32) + 128), *(a1 + 40));
    *(*(*(a1 + 48) + 8) + 24) = 1;
  }

  v9 = *MEMORY[0x1E69E9840];
}

void sub_195A1228C(uint64_t a1)
{
  v11 = *MEMORY[0x1E69E9840];
  v2 = [*(a1 + 32) capabilities];
  v3 = *(a1 + 32);
  if (*(v3 + 156) != v2)
  {
    *(v3 + 156) = v2;
    *(*(*(a1 + 40) + 8) + 24) = 1;
    v4 = +[IDSLogging DaemonController];
    if (os_log_type_enabled(v4, OS_LOG_TYPE_INFO))
    {
      v5 = *(a1 + 48);
      v6 = *(*(a1 + 32) + 156);
      v8[0] = 67109376;
      v8[1] = v5;
      v9 = 1024;
      v10 = v6;
      _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_INFO, "Updating capabilities: %d  (Previous: %d)", v8, 0xEu);
    }
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A124C4(void *a1)
{
  v20 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = a1[4];
    v4 = *(a1[5] + 176);
    v14 = 136315650;
    v15 = "[IDSDaemonController addedDelegateForService:withCompletion:]_block_invoke";
    v16 = 2112;
    v17 = v3;
    v18 = 2112;
    v19 = v4;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "%s: adding delegate on service %@ _notificationServices %@", &v14, 0x20u);
  }

  if (([*(a1[5] + 176) containsObject:a1[4]] & 1) == 0)
  {
    v5 = *(a1[5] + 176);
    if (!v5)
    {
      v6 = objc_alloc_init(MEMORY[0x1E695DFA8]);
      v7 = a1[5];
      v8 = *(v7 + 176);
      *(v7 + 176) = v6;

      v5 = *(a1[5] + 176);
    }

    [v5 addObject:a1[4]];
    v9 = a1[6];
    v10 = +[IDSDaemonController sharedInstance];
    v11 = v10;
    if (v9)
    {
      v12 = [v10 forwarderWithCompletion:a1[6]];

      v11 = v12;
    }

    [v11 registerForNotificationsOnServices:*(a1[5] + 176)];
  }

  v13 = *MEMORY[0x1E69E9840];
}

void sub_195A1275C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A12774(uint64_t a1)
{
  v35 = *MEMORY[0x1E69E9840];
  v2 = *(a1 + 32);
  if (v2)
  {
    v3 = v2;
  }

  else
  {
    v3 = [MEMORY[0x1E695DFD8] set];
  }

  v4 = v3;
  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = v5;
  }

  else
  {
    v6 = [MEMORY[0x1E695DFD8] set];
  }

  v7 = v6;
  if ([*(a1 + 48) length])
  {
    v8 = *MEMORY[0x1E69A51B8];
    if ([v4 containsObject:*MEMORY[0x1E69A51B8]])
    {
      v9 = [MEMORY[0x1E695DFD8] setWithObject:v8];
    }

    else
    {
      v9 = v4;
    }

    v10 = v9;
    v11 = [*(a1 + 56) hasListenerForID:*(a1 + 48)];
    v12 = *(a1 + 56);
    if (v11)
    {
      v13 = [v12 setServices:v10 forListenerID:*(a1 + 48)];
      *(*(*(a1 + 64) + 8) + 24) = v13 & [*(a1 + 56) setCommands:v7 forListenerID:*(a1 + 48)];
    }

    else
    {
      if (!v12[12])
      {
        v14 = objc_alloc_init(MEMORY[0x1E695DF90]);
        v15 = *(a1 + 56);
        v16 = *(v15 + 96);
        *(v15 + 96) = v14;
      }

      if ([*(a1 + 32) containsObject:@"com.apple.private.alloy.pbbridge"])
      {
        v17 = [MEMORY[0x1E69A6138] registration];
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          v18 = *(a1 + 48);
          v29 = 138412802;
          v30 = v18;
          v31 = 2112;
          v32 = v4;
          v33 = 2112;
          v34 = v7;
          _os_log_impl(&dword_1959FF000, v17, OS_LOG_TYPE_DEFAULT, "Adding listener with ID: %@    services: %@   commands %@", &v29, 0x20u);
        }
      }

      [*(*(a1 + 56) + 96) setObject:v10 forKey:*(a1 + 48)];
      v19 = *(*(a1 + 56) + 120);
      if (!v19)
      {
        v20 = objc_alloc_init(MEMORY[0x1E695DF90]);
        v21 = *(a1 + 56);
        v22 = *(v21 + 120);
        *(v21 + 120) = v20;

        v19 = *(*(a1 + 56) + 120);
      }

      [v19 setObject:v7 forKey:*(a1 + 48)];
      v23 = *(*(a1 + 56) + 144);
      if (!v23)
      {
        v24 = objc_alloc_init(MEMORY[0x1E695DF90]);
        v25 = *(a1 + 56);
        v26 = *(v25 + 144);
        *(v25 + 144) = v24;

        v23 = *(*(a1 + 56) + 144);
      }

      v27 = [MEMORY[0x1E696AD98] numberWithUnsignedInt:0];
      [v23 setObject:v27 forKey:*(a1 + 48)];

      [*(a1 + 56) _listenerSetUpdated];
    }
  }

  else
  {
    *(*(*(a1 + 64) + 8) + 24) = 0;
  }

  v28 = *MEMORY[0x1E69E9840];
}

void sub_195A12B10(void *a1)
{
  v2 = [*(a1[4] + 96) objectForKey:a1[5]];
  *(*(a1[6] + 8) + 24) = v2 != 0;
}

void sub_195A12C04(uint64_t a1)
{
  v21 = *MEMORY[0x1E69E9840];
  v2 = (a1 + 40);
  v3 = [*(*(a1 + 32) + 96) objectForKey:*(a1 + 40)];

  v4 = [MEMORY[0x1E69A6138] registration];
  v5 = v4;
  if (v3)
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      v6 = *(a1 + 40);
      v7 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:{objc_msgSend(*(*(a1 + 32) + 96), "count")}];
      v8 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:{objc_msgSend(*(*(a1 + 32) + 120), "count")}];
      v9 = [*(*(a1 + 32) + 144) objectForKey:*(a1 + 40)];
      *buf = 138413058;
      v14 = v6;
      v15 = 2112;
      v16 = v7;
      v17 = 2112;
      v18 = v8;
      v19 = 2112;
      v20 = v9;
      _os_log_impl(&dword_1959FF000, v5, OS_LOG_TYPE_DEFAULT, "Removing listener with ID: %@    services (count): %@   commands (count): %@   capabilities %@", buf, 0x2Au);
    }

    [*(*(a1 + 32) + 96) removeObjectForKey:*(a1 + 40)];
    [*(*(a1 + 32) + 120) removeObjectForKey:*(a1 + 40)];
    [*(*(a1 + 32) + 144) removeObjectForKey:*(a1 + 40)];
    v10 = *(a1 + 32);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A12E08;
    v12[3] = &unk_1E743E878;
    v12[4] = v10;
    [v10 _performBlock:v12];
  }

  else
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEBUG))
    {
      sub_195B27068(v2);
    }
  }

  v11 = *MEMORY[0x1E69E9840];
}

void sub_195A12F40(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A12F58(void *a1)
{
  v5 = [*(a1[4] + 96) objectForKey:a1[5]];
  v2 = [v5 copy];
  v3 = *(a1[6] + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A130BC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A130D4(uint64_t a1)
{
  v2 = (a1 + 32);
  if ([*(a1 + 32) length] && (objc_msgSend(*(a1 + 40), "hasListenerForID:", *(a1 + 32)) & 1) != 0)
  {
    v3 = *(a1 + 48);
    if (v3)
    {
      v4 = v3;
    }

    else
    {
      v4 = [MEMORY[0x1E695DFD8] set];
    }

    v5 = v4;
    v6 = [*(a1 + 40) servicesForListenerID:*(a1 + 32)];
    v7 = [v6 isEqualToSet:v5];

    if (v7)
    {
      *(*(*(a1 + 56) + 8) + 24) = 1;
    }

    else
    {
      v8 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v8, OS_LOG_TYPE_DEBUG))
      {
        sub_195B270D8(v5, v2);
      }

      [*(*(a1 + 40) + 96) setObject:v5 forKey:*(a1 + 32)];
      [*(a1 + 40) _listenerSetUpdated];
    }
  }

  else
  {
    *(*(*(a1 + 56) + 8) + 24) = 0;
  }
}

void sub_195A132DC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A132F4(uint64_t a1)
{
  v2 = (a1 + 32);
  if ([*(a1 + 32) length] && (objc_msgSend(*(a1 + 40), "hasListenerForID:", *(a1 + 32)) & 1) != 0)
  {
    v3 = *(a1 + 48);
    if (v3)
    {
      v4 = v3;
    }

    else
    {
      v4 = [MEMORY[0x1E695DFD8] set];
    }

    v5 = v4;
    v6 = [*(a1 + 40) commandsForListenerID:*(a1 + 32)];
    v7 = [v6 isEqualToSet:v5];

    if (v7)
    {
      *(*(*(a1 + 56) + 8) + 24) = 1;
    }

    else
    {
      v8 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v8, OS_LOG_TYPE_DEBUG))
      {
        sub_195B27158(v5, v2);
      }

      [*(*(a1 + 40) + 120) setObject:v5 forKey:*(a1 + 32)];
      [*(a1 + 40) _listenerSetUpdated];
    }
  }

  else
  {
    *(*(*(a1 + 56) + 8) + 24) = 0;
  }
}

void sub_195A13530(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A13548(void *a1)
{
  v5 = [*(a1[4] + 120) objectForKey:a1[5]];
  v2 = [v5 copy];
  v3 = *(a1[6] + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A13698(void *a1)
{
  v2 = [*(a1[4] + 144) objectForKey:a1[5]];
  *(*(a1[6] + 8) + 24) = [v2 unsignedIntValue];
}

void sub_195A137E8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A13800(uint64_t a1)
{
  v23 = *MEMORY[0x1E69E9840];
  if (![*(a1 + 32) length])
  {
    if (*(a1 + 60) == 1)
    {
      v7 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
      {
        v8 = *(a1 + 56);
        v9 = *(a1 + 32);
        v19 = 67109378;
        v20 = v8;
        v21 = 2112;
        v22 = v9;
        v10 = "setCapabilities %d for listenerID %@ has no ID";
LABEL_16:
        _os_log_impl(&dword_1959FF000, v7, OS_LOG_TYPE_DEFAULT, v10, &v19, 0x12u);
      }

LABEL_17:
    }

LABEL_18:
    *(*(*(a1 + 48) + 8) + 24) = 0;
    goto LABEL_25;
  }

  if (([*(a1 + 40) hasListenerForID:*(a1 + 32)] & 1) == 0)
  {
    if (*(a1 + 60) == 1)
    {
      v7 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
      {
        v11 = *(a1 + 56);
        v12 = *(a1 + 32);
        v19 = 67109378;
        v20 = v11;
        v21 = 2112;
        v22 = v12;
        v10 = "setCapabilities %d for listenerID %@ is not a valid listener";
        goto LABEL_16;
      }

      goto LABEL_17;
    }

    goto LABEL_18;
  }

  if (*(a1 + 56))
  {
    v2 = [*(a1 + 40) capabilitiesForListenerID:*(a1 + 32)];
    v3 = *(a1 + 56);
    if (v2 == v3)
    {
      if (*(a1 + 60) == 1)
      {
        v4 = [MEMORY[0x1E69A6138] registration];
        if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
        {
          v5 = *(a1 + 56);
          v6 = *(a1 + 32);
          v19 = 67109378;
          v20 = v5;
          v21 = 2112;
          v22 = v6;
          _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "setCapabilities %d for listenerID %@ - listener map already contains our capabilities", &v19, 0x12u);
        }
      }

      *(*(*(a1 + 48) + 8) + 24) = 1;
      goto LABEL_25;
    }
  }

  else
  {
    v3 = 0;
  }

  if (*(a1 + 60) == 1)
  {
    v13 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = *(a1 + 56);
      v15 = *(a1 + 32);
      v19 = 67109378;
      v20 = v14;
      v21 = 2112;
      v22 = v15;
      _os_log_impl(&dword_1959FF000, v13, OS_LOG_TYPE_DEFAULT, "Set caps: %d  for listener ID: %@", &v19, 0x12u);
    }

    v3 = *(a1 + 56);
  }

  v16 = *(*(a1 + 40) + 144);
  v17 = [MEMORY[0x1E696AD98] numberWithInt:v3];
  [v16 setObject:v17 forKey:*(a1 + 32)];

  [*(a1 + 40) _listenerSetUpdated];
LABEL_25:
  v18 = *MEMORY[0x1E69E9840];
}

void sub_195A13BAC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A13BD8()
{
  v0 = +[IDSLogging DaemonController];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_INFO))
  {
    *v1 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_INFO, "Finished blocking for daemon connection", v1, 2u);
  }
}

_BYTE *sub_195A13CB8(uint64_t a1)
{
  result = *(a1 + 32);
  if ((result[161] & 1) == 0)
  {
    return [result connectToDaemonWithLaunch:0];
  }

  return result;
}

void sub_195A13D40(uint64_t a1)
{
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
  {
    sub_195B27240();
  }

  [*(a1 + 32) _noteDisconnected];
  [*(a1 + 32) _localObjectCleanup];
  [*(a1 + 32) _remoteObjectCleanup];
  [*(a1 + 32) _disconnectFromDaemonWithForce:1];
  if ((byte_1ED5DDF31 & 1) == 0)
  {
    byte_1ED5DDF31 = 1;
    v3 = dispatch_time(0, 2000000000);
    v4 = *(a1 + 32);
    v5 = *(v4 + 64);
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = sub_195A13E38;
    block[3] = &unk_1E743E878;
    block[4] = v4;
    dispatch_after(v3, v5, block);
  }
}

uint64_t sub_195A13E38(uint64_t a1)
{
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    *v4 = 0;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, " ... disconnection from agent (local) being handled by ivarQueue", v4, 2u);
  }

  result = [*(a1 + 32) connectToDaemon];
  byte_1ED5DDF31 = 0;
  return result;
}

uint64_t sub_195A13F2C(uint64_t a1)
{
  result = [*(a1 + 32) _noteDisconnected];
  if ((byte_1ED5DDF31 & 1) == 0)
  {
    byte_1ED5DDF31 = 1;
    v3 = [MEMORY[0x1E69A6138] registration];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEBUG))
    {
      sub_195B27274();
    }

    v4 = *(a1 + 32);
    v5[0] = MEMORY[0x1E69E9820];
    v5[1] = 3221225472;
    v5[2] = sub_195A13FF4;
    v5[3] = &unk_1E743E878;
    v5[4] = v4;
    return [v4 _performBlock:v5];
  }

  return result;
}

void sub_195A13FF4(uint64_t a1)
{
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, " ... disconnection from agent (remote) being handled by ivarQueue", buf, 2u);
  }

  [*(a1 + 32) _disconnectFromDaemonWithForce:1];
  v3 = [MEMORY[0x1E69A6160] sharedInstance];
  if (([v3 systemIsShuttingDown] & 1) != 0 || !objc_msgSend(*(a1 + 32), "_autoReconnect"))
  {
  }

  else
  {
    v4 = *(*(a1 + 32) + 161);

    if ((v4 & 1) == 0)
    {
      v5 = [MEMORY[0x1E69A6138] registration];
      if (os_log_type_enabled(v5, OS_LOG_TYPE_DEBUG))
      {
        sub_195B272A8();
      }

      v6 = dispatch_time(0, 2000000000);
      v7 = *(a1 + 32);
      v8 = *(v7 + 64);
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = sub_195A14158;
      block[3] = &unk_1E743E878;
      block[4] = v7;
      dispatch_after(v6, v8, block);
    }
  }

  byte_1ED5DDF31 = 0;
}

uint64_t sub_195A14158(uint64_t a1)
{
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
  {
    sub_195B272DC();
  }

  return [*(a1 + 32) connectToDaemon];
}

void sub_195A1432C(uint64_t a1)
{
  v1 = *(a1 + 32);
  v2[0] = MEMORY[0x1E69E9820];
  v2[1] = 3221225472;
  v2[2] = sub_195A143C0;
  v2[3] = &unk_1E743EA30;
  v2[4] = v1;
  v3 = *(a1 + 40);
  [v1 _performBlock:v2 wait:0];
}

void sub_195A143C0(uint64_t a1)
{
  if ([*(a1 + 32) connectToDaemon])
  {
    v4 = *(*(a1 + 32) + 16);
    v2 = [MEMORY[0x1E69A6148] defaultBroadcaster];
    v3 = [v2 broadcastProxyForTarget:v4 messageContext:0 protocol:&unk_1F0A2D150];

    if (v3)
    {
      [v3 sendXPCObject:*(a1 + 40)];
    }
  }
}

void sub_195A1447C(uint64_t a1)
{
  if ([*(a1 + 32) connectToDaemon])
  {
    v2 = *(a1 + 40);
    v3 = *(*(a1 + 32) + 80);

    dispatch_async(v3, v2);
  }
}

void sub_195A14ED0(uint64_t a1)
{
  v19[0] = 0;
  v19[1] = v19;
  v19[2] = 0x3032000000;
  v19[3] = sub_195A00684;
  v19[4] = sub_195A03CE8;
  v20 = os_transaction_create();
  v17[0] = 0;
  v17[1] = v17;
  v17[2] = 0x3032000000;
  v17[3] = sub_195A00684;
  v17[4] = sub_195A03CE8;
  v18 = *(a1 + 32);
  v5 = MEMORY[0x1E69E9820];
  v6 = 3221225472;
  v7 = sub_195A1512C;
  v8 = &unk_1E743EAF8;
  v9 = *(a1 + 40);
  v14 = *(a1 + 64);
  v2 = *(a1 + 48);
  v15 = *(a1 + 68);
  v16 = *(a1 + 69);
  v10 = v2;
  v12 = v17;
  v13 = v19;
  v11 = *(a1 + 56);
  v3 = dispatch_block_create(DISPATCH_BLOCK_ENFORCE_QOS_CLASS|DISPATCH_BLOCK_ASSIGN_CURRENT, &v5);
  if (!_os_feature_enabled_impl())
  {
    if (![*(a1 + 40) connectToDaemon])
    {
      goto LABEL_9;
    }

LABEL_8:
    [*(a1 + 48) retainArguments];
    dispatch_async(*(*(a1 + 32) + 32), v3);
    goto LABEL_9;
  }

  v4 = *(a1 + 40);
  if (*(a1 + 68) != 1)
  {
    if (![v4 connectToDaemon])
    {
      goto LABEL_9;
    }

    goto LABEL_8;
  }

  if ([v4 connectToDaemon])
  {
    [*(a1 + 40) blockUntilConnected];
    [*(a1 + 48) retainArguments];
    dispatch_sync(*(*(a1 + 32) + 32), v3);
  }

LABEL_9:

  _Block_object_dispose(v17, 8);
  _Block_object_dispose(v19, 8);
}

void sub_195A15108(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Block_object_dispose((v11 - 96), 8);
  _Unwind_Resume(a1);
}

void sub_195A1512C(uint64_t a1)
{
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = sub_195A15240;
  v8[3] = &unk_1E743EAF8;
  v9 = *(a1 + 32);
  v13 = *(a1 + 72);
  v2 = *(a1 + 40);
  v14 = *(a1 + 76);
  v15 = *(a1 + 77);
  v3 = *(a1 + 64);
  v10 = v2;
  v12 = v3;
  v7 = *(a1 + 48);
  v4 = v7;
  v11 = v7;
  v5 = MEMORY[0x19A8BBEF0](v8);
  v6 = v5;
  if (*(a1 + 76) == 1)
  {
    (*(v5 + 16))(v5);
  }

  else
  {
    [*(a1 + 32) _performBlock:v5 wait:0];
  }
}

void sub_195A15240(uint64_t a1)
{
  if ([*(a1 + 32) connectToDaemon])
  {
    v2 = [*(a1 + 32) remoteObject];
    v3 = *(a1 + 72);
    if (v3)
    {
      if ([*(a1 + 40) selector] == sel_sendMessageWithSendParameters_)
      {
        v3 = v3;
      }

      else
      {
        v3 = 0;
      }
    }

    if (*(a1 + 76) == 1)
    {
      v4 = objc_alloc_init(MEMORY[0x1E69A6100]);
      [v4 setSync:1];
    }

    else if (*(a1 + 77) == 1)
    {
      v4 = objc_alloc_init(MEMORY[0x1E69A6100]);
      [v4 setNeedReply:1];
    }

    else if (*(a1 + 78) == 1)
    {
      v4 = objc_alloc_init(MEMORY[0x1E69A6100]);
      [v4 setShouldBoost:1];
    }

    else
    {
      v4 = 0;
    }

    v7 = [MEMORY[0x1E69A6148] defaultBroadcaster];
    v11[0] = MEMORY[0x1E69E9820];
    v11[1] = 3221225472;
    v11[2] = sub_195A15434;
    v11[3] = &unk_1E743EAD0;
    v13 = *(a1 + 64);
    v10 = *(a1 + 48);
    v8 = v10;
    v12 = v10;
    v9 = [v7 broadcastProxyForTarget:v2 messageContext:v4 protocol:&unk_1F0A2D150 priority:v3 completion:v11];

    if (v9)
    {
      [*(a1 + 40) invokeWithTarget:v9];
    }
  }

  else
  {
    v5 = *(*(a1 + 64) + 8);
    v6 = *(v5 + 40);
    *(v5 + 40) = 0;
  }
}

void sub_195A15434(void *a1)
{
  if (*(*(a1[5] + 8) + 40))
  {
    v2 = [MEMORY[0x1E696AE30] processInfo];
    v3 = [v2 processName];
    v4 = [v3 isEqualToString:@"accountsd"];

    if (v4)
    {
      v5 = dispatch_time(0, 2000000000);
      v6 = *(*(*(a1[5] + 8) + 40) + 24);
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = sub_195A15588;
      block[3] = &unk_1E743E648;
      block[4] = a1[6];
      dispatch_after(v5, v6, block);
    }

    else
    {
      v7 = *(a1[6] + 8);
      v8 = *(v7 + 40);
      *(v7 + 40) = 0;
    }

    v9 = a1[4];
    if (v9)
    {
      (*(v9 + 16))();
    }

    v10 = *(*(a1[5] + 8) + 40);
    v11 = objc_opt_self();
    v12 = *(a1[5] + 8);
    v13 = *(v12 + 40);
    *(v12 + 40) = 0;
  }
}

void sub_195A15588(uint64_t a1)
{
  v1 = *(*(a1 + 32) + 8);
  v2 = *(v1 + 40);
  *(v1 + 40) = 0;
}

void sub_195A15678(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_debug_impl(a1, a2, OS_LOG_TYPE_DEBUG, a4, &a9, 2u);
}

uint64_t *sub_195A156EC@<X0>(uint64_t *result@<X0>, uint64_t a2@<X8>)
{
  *(v2 - 8) = a2;
  v3 = *result;
  return result;
}

void sub_195A1573C()
{
  v0 = [MEMORY[0x1E696B0D0] interfaceWithProtocol:&unk_1F0A52B88];
  v1 = qword_1ED5DDE20;
  qword_1ED5DDE20 = v0;

  v2 = qword_1ED5DDE20;
  v3 = MEMORY[0x1E695DFD8];
  v4 = objc_opt_class();
  v5 = objc_opt_class();
  v6 = [v3 setWithObjects:{v4, v5, objc_opt_class(), 0}];
  [v2 setClasses:v6 forSelector:sel_fetchEndpointCacheStateForServiceIdentifier_localURI_remoteURI_completion_ argumentIndex:1 ofReply:1];

  v7 = qword_1ED5DDE20;
  v8 = MEMORY[0x1E695DFD8];
  v9 = objc_opt_class();
  v10 = objc_opt_class();
  v11 = objc_opt_class();
  v12 = objc_opt_class();
  v13 = [v8 setWithObjects:{v9, v10, v11, v12, objc_opt_class(), 0}];
  [v7 setClasses:v13 forSelector:sel_fetchTransparentEndpointsForServiceIdentifier_localURI_remoteURI_verifyAgainstTrustCircle_completion_ argumentIndex:0 ofReply:1];

  v14 = qword_1ED5DDE20;
  v15 = MEMORY[0x1E695DFD8];
  v16 = objc_opt_class();
  v17 = [v15 setWithObjects:{v16, objc_opt_class(), 0}];
  [v14 setClasses:v17 forSelector:sel_sendFakePushFromFile_completion_ argumentIndex:0 ofReply:1];

  v18 = qword_1ED5DDE20;
  v19 = MEMORY[0x1E695DFD8];
  v20 = objc_opt_class();
  v21 = [v19 setWithObjects:{v20, objc_opt_class(), 0}];
  [v18 setClasses:v21 forSelector:sel_listSenderKeysForURIs_completion_ argumentIndex:0 ofReply:0];

  v22 = qword_1ED5DDE20;
  v23 = [MEMORY[0x1E695DFD8] setWithObjects:{objc_opt_class(), 0}];
  [v22 setClasses:v23 forSelector:sel_setOffGridMode_options_completion_ argumentIndex:0 ofReply:0];

  v24 = qword_1ED5DDE20;
  v25 = MEMORY[0x1E695DFD8];
  v26 = objc_opt_class();
  v27 = objc_opt_class();
  v28 = [v25 setWithObjects:{v26, v27, objc_opt_class(), 0}];
  [v24 setClasses:v28 forSelector:sel_listRegistrationEventTracesForService_summary_completion_ argumentIndex:0 ofReply:1];
}

id sub_195A15A18()
{
  if (qword_1EAEDC098 != -1)
  {
    sub_195B273F4();
  }

  v1 = qword_1EAEDC090;

  return v1;
}

uint64_t sub_195A15A5C()
{
  qword_1EAEDC090 = nw_framer_create_definition("LengthOnlyHeaderProtocol", 0, &unk_1F09E5C00);

  return MEMORY[0x1EEE66BB8]();
}

uint64_t sub_195A15AA4(uint64_t a1, void *a2)
{
  v2 = a2;
  nw_framer_set_input_handler(v2, &unk_1F09E5C20);
  nw_framer_set_output_handler(v2, &unk_1F09E5C60);

  return 1;
}

uint64_t sub_195A15AEC(uint64_t a1, void *a2)
{
  v2 = a2;
  while (1)
  {
    *temp_buffer = 0;
    if (!nw_framer_parse_input(v2, 4uLL, 4uLL, temp_buffer, &unk_1F09E5C40))
    {
      break;
    }

    v3 = nw_framer_message_create(v2);
    kdebug_trace();
    v4 = nw_framer_deliver_input_no_copy(v2, bswap32(*temp_buffer), v3, 1);

    if (!v4)
    {
      v5 = 0;
      goto LABEL_6;
    }
  }

  v5 = 4;
LABEL_6:

  return v5;
}

uint64_t sub_195A15BA8(uint64_t a1, uint64_t a2, unint64_t a3)
{
  if (a3 < 4 || a2 == 0)
  {
    return 0;
  }

  else
  {
    return 4;
  }
}

void sub_195A15BBC(uint64_t a1, void *a2, uint64_t a3, size_t a4)
{
  v5 = a2;
  kdebug_trace();
  *output_buffer = bswap32(a4);
  nw_framer_write_output(v5, output_buffer, 4uLL);
  nw_framer_write_output_no_copy(v5, a4);
}

void sub_195A15C74()
{
  v84[4] = *MEMORY[0x1E69E9840];
  v0 = [MEMORY[0x1E696B0D0] interfaceWithProtocol:&unk_1F0A52BE8];
  v1 = qword_1ED5DDE28;
  qword_1ED5DDE28 = v0;

  v2 = [MEMORY[0x1E696B0D0] interfaceWithProtocol:&unk_1F0A3C798];
  v3 = MEMORY[0x1E695DFD8];
  v84[0] = objc_opt_class();
  v84[1] = objc_opt_class();
  v84[2] = objc_opt_class();
  v84[3] = objc_opt_class();
  v4 = [MEMORY[0x1E695DEC8] arrayWithObjects:v84 count:4];
  v5 = [v3 setWithArray:v4];
  [v2 setClasses:v5 forSelector:sel_handleRegistrationStateUpdate_ argumentIndex:0 ofReply:0];

  [qword_1ED5DDE28 setInterface:v2 forSelector:sel_setupKeyTransparencyManager_uuid_ argumentIndex:0 ofReply:0];
  v6 = qword_1ED5DDE28;
  v7 = MEMORY[0x1E695DFD8];
  v83[0] = objc_opt_class();
  v83[1] = objc_opt_class();
  v8 = [MEMORY[0x1E695DEC8] arrayWithObjects:v83 count:2];
  v9 = [v7 setWithArray:v8];
  [v6 setClasses:v9 forSelector:sel_fetchPeerVerificationInfoForApplication_forURIs_withCompletion_ argumentIndex:1 ofReply:0];

  v10 = qword_1ED5DDE28;
  v11 = MEMORY[0x1E695DFD8];
  v82[0] = objc_opt_class();
  v82[1] = objc_opt_class();
  v69 = 0;
  v70 = &v69;
  v71 = 0x2050000000;
  v12 = qword_1ED5DDF10;
  v72 = qword_1ED5DDF10;
  if (!qword_1ED5DDF10)
  {
    v64 = MEMORY[0x1E69E9820];
    v65 = 3221225472;
    v66 = sub_195A166B4;
    v67 = &unk_1E743E648;
    v68 = &v69;
    sub_195A166B4(&v64);
    v12 = v70[3];
  }

  v13 = v12;
  _Block_object_dispose(&v69, 8);
  v82[2] = v12;
  v82[3] = objc_opt_class();
  v69 = 0;
  v70 = &v69;
  v71 = 0x2050000000;
  v14 = qword_1ED5DDF08;
  v72 = qword_1ED5DDF08;
  if (!qword_1ED5DDF08)
  {
    v64 = MEMORY[0x1E69E9820];
    v65 = 3221225472;
    v66 = sub_195A16864;
    v67 = &unk_1E743E648;
    v68 = &v69;
    sub_195A16864(&v64);
    v14 = v70[3];
  }

  v15 = v14;
  _Block_object_dispose(&v69, 8);
  v82[4] = v14;
  v16 = [MEMORY[0x1E695DEC8] arrayWithObjects:v82 count:5];
  v17 = [v11 setWithArray:v16];
  [v10 setClasses:v17 forSelector:sel_fetchPeerVerificationInfoForApplication_forURIs_withCompletion_ argumentIndex:0 ofReply:1];

  v18 = qword_1ED5DDE28;
  v19 = MEMORY[0x1E695DFD8];
  v69 = 0;
  v70 = &v69;
  v71 = 0x2050000000;
  v20 = qword_1ED5DDF00;
  v72 = qword_1ED5DDF00;
  if (!qword_1ED5DDF00)
  {
    v64 = MEMORY[0x1E69E9820];
    v65 = 3221225472;
    v66 = sub_195A168BC;
    v67 = &unk_1E743E648;
    v68 = &v69;
    sub_195A168BC(&v64);
    v20 = v70[3];
  }

  v21 = v20;
  _Block_object_dispose(&v69, 8);
  v81[0] = v20;
  v81[1] = objc_opt_class();
  v81[2] = objc_opt_class();
  v81[3] = objc_opt_class();
  v81[4] = objc_opt_class();
  v22 = [MEMORY[0x1E695DEC8] arrayWithObjects:v81 count:5];
  v23 = [v19 setWithArray:v22];
  [v18 setClasses:v23 forSelector:sel_healSelfForApplication_withHealableErrors_withCompletion_ argumentIndex:1 ofReply:0];

  v24 = qword_1ED5DDE28;
  v25 = MEMORY[0x1E695DFD8];
  v80[0] = objc_opt_class();
  v80[1] = objc_opt_class();
  v80[2] = objc_opt_class();
  v26 = [MEMORY[0x1E695DEC8] arrayWithObjects:v80 count:3];
  v27 = [v25 setWithArray:v26];
  [v24 setClasses:v27 forSelector:sel_sendOptInUpdateForApplications_withCompletion_ argumentIndex:0 ofReply:1];

  v28 = qword_1ED5DDE28;
  v29 = MEMORY[0x1E695DFD8];
  v79 = objc_opt_class();
  v30 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v79 count:1];
  v31 = [v29 setWithArray:v30];
  [v28 setClasses:v31 forSelector:sel_fetchKTRegistrationStatusWithCompletion_ argumentIndex:0 ofReply:1];

  v32 = qword_1ED5DDE28;
  v33 = MEMORY[0x1E695DFD8];
  v69 = 0;
  v70 = &v69;
  v71 = 0x2050000000;
  v34 = qword_1ED5DDEF0;
  v72 = qword_1ED5DDEF0;
  if (!qword_1ED5DDEF0)
  {
    v64 = MEMORY[0x1E69E9820];
    v65 = 3221225472;
    v66 = sub_195A16914;
    v67 = &unk_1E743E648;
    v68 = &v69;
    sub_195A16914(&v64);
    v34 = v70[3];
  }

  v35 = v34;
  _Block_object_dispose(&v69, 8);
  v78[0] = v34;
  v78[1] = objc_opt_class();
  v36 = [MEMORY[0x1E695DEC8] arrayWithObjects:v78 count:2];
  v37 = [v33 setWithArray:v36];
  [v32 setClasses:v37 forSelector:sel_peerVerificationFinishedWithResults_ argumentIndex:0 ofReply:0];

  v38 = qword_1ED5DDE28;
  v39 = MEMORY[0x1E695DFD8];
  v77[0] = objc_opt_class();
  v77[1] = objc_opt_class();
  v77[2] = objc_opt_class();
  v77[3] = objc_opt_class();
  v77[4] = objc_opt_class();
  v40 = [MEMORY[0x1E695DEC8] arrayWithObjects:v77 count:5];
  v41 = [v39 setWithArray:v40];
  [v38 setClasses:v41 forSelector:sel_sendOptInUpdateRequest_withCompletion_ argumentIndex:0 ofReply:0];

  v42 = qword_1ED5DDE28;
  v43 = MEMORY[0x1E695DFD8];
  v76 = objc_opt_class();
  v44 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v76 count:1];
  v45 = [v43 setWithArray:v44];
  [v42 setClasses:v45 forSelector:sel_sendOptInUpdateRequest_withCompletion_ argumentIndex:0 ofReply:1];

  v46 = qword_1ED5DDE28;
  v47 = MEMORY[0x1E695DFD8];
  v69 = 0;
  v70 = &v69;
  v71 = 0x2050000000;
  v48 = qword_1ED5DDEC8;
  v72 = qword_1ED5DDEC8;
  if (!qword_1ED5DDEC8)
  {
    v64 = MEMORY[0x1E69E9820];
    v65 = 3221225472;
    v66 = sub_195A1696C;
    v67 = &unk_1E743E648;
    v68 = &v69;
    sub_195A1696C(&v64);
    v48 = v70[3];
  }

  v49 = v48;
  _Block_object_dispose(&v69, 8);
  v50 = [v47 setWithObjects:{v48, 0}];
  [v46 setClasses:v50 forSelector:sel_registrationMightNeedUpdate_ argumentIndex:0 ofReply:0];

  v51 = qword_1ED5DDE28;
  v52 = MEMORY[0x1E695DFD8];
  v75[0] = objc_opt_class();
  v75[1] = objc_opt_class();
  v75[2] = objc_opt_class();
  v53 = [MEMORY[0x1E695DEC8] arrayWithObjects:v75 count:3];
  v54 = [v52 setWithArray:v53];
  [v51 setClasses:v54 forSelector:sel_cacheClearRequest_ argumentIndex:0 ofReply:0];

  v55 = qword_1ED5DDE28;
  v56 = MEMORY[0x1E695DFD8];
  v74[0] = objc_opt_class();
  v74[1] = objc_opt_class();
  v74[2] = objc_opt_class();
  v74[3] = objc_opt_class();
  v57 = [MEMORY[0x1E695DEC8] arrayWithObjects:v74 count:4];
  v58 = [v56 setWithArray:v57];
  [v55 setClasses:v58 forSelector:sel_getCurrentRegistrationState_withCompletion_ argumentIndex:0 ofReply:1];

  v59 = qword_1ED5DDE28;
  v60 = MEMORY[0x1E695DFD8];
  v73[0] = objc_opt_class();
  v73[1] = objc_opt_class();
  v73[2] = objc_opt_class();
  v61 = [MEMORY[0x1E695DEC8] arrayWithObjects:v73 count:3];
  v62 = [v60 setWithArray:v61];
  [v59 setClasses:v62 forSelector:sel_getCurrentRegistrationState_withCompletion_ argumentIndex:0 ofReply:0];

  v63 = *MEMORY[0x1E69E9840];
}

void sub_195A16684(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

Class sub_195A166B4(uint64_t a1)
{
  sub_195A1670C();
  result = objc_getClass("KTVerificationInfo");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_195B2741C();
  }

  qword_1ED5DDF10 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

void sub_195A1670C()
{
  v1[9] = *MEMORY[0x1E69E9840];
  v1[0] = 0;
  if (!qword_1ED5DDF18)
  {
    v1[1] = MEMORY[0x1E69E9820];
    v1[2] = 3221225472;
    v1[3] = sub_195A167F8;
    v1[4] = &unk_1E743EBC0;
    v1[5] = v1;
    v1[7] = 0;
    v1[8] = 0;
    v1[6] = "/System/Library/PrivateFrameworks/Transparency.framework/Transparency";
    qword_1ED5DDF18 = _sl_dlopen();
  }

  if (!qword_1ED5DDF18)
  {
    sub_195B27498(v1);
  }

  if (v1[0])
  {
    free(v1[0]);
  }

  v0 = *MEMORY[0x1E69E9840];
}

uint64_t sub_195A167F8(uint64_t a1)
{
  v4 = *MEMORY[0x1E69E9840];
  v1 = *(a1 + 32);
  result = _sl_dlopen();
  qword_1ED5DDF18 = result;
  v3 = *MEMORY[0x1E69E9840];
  return result;
}

Class sub_195A16864(uint64_t a1)
{
  sub_195A1670C();
  result = objc_getClass("KTLoggableData");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_195B27518();
  }

  qword_1ED5DDF08 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

Class sub_195A168BC(uint64_t a1)
{
  sub_195A1670C();
  result = objc_getClass("KTSelfVerificationHealableErrors");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_195B27594();
  }

  qword_1ED5DDF00 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

Class sub_195A16914(uint64_t a1)
{
  sub_195A1670C();
  result = objc_getClass("KTVerifierResult");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_195B27610();
  }

  qword_1ED5DDEF0 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

Class sub_195A1696C(uint64_t a1)
{
  sub_195A1670C();
  result = objc_getClass("TransparencyIDSRegistrationResponse");
  *(*(*(a1 + 32) + 8) + 24) = result;
  if (!*(*(*(a1 + 32) + 8) + 24))
  {
    sub_195B2768C();
  }

  qword_1ED5DDEC8 = *(*(*(a1 + 32) + 8) + 24);
  return result;
}

void IDSSecurityKeyRollingRollKeys()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B27708();
  }

  v0 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "Received deprecated call to roll keys -- posting key rolling complete notification immediately", v2, 2u);
  }

  v1 = [MEMORY[0x1E696AD88] defaultCenter];
  [v1 postNotificationName:@"__kIDSKeyRollingCompleteNotification" object:0];
}

void IDSSecurityKeyRollingRegenerateRegisteredIdentity()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B27734();
  }

  v0 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "Received call to roll encryption keys", v2, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 regenerateRegisteredIdentity];
}

uint64_t sub_195A17148()
{
  qword_1ED5DDE30 = [MEMORY[0x1E696B0D0] interfaceWithProtocol:&unk_1F0A52C48];

  return MEMORY[0x1EEE66BB8]();
}

void IDSLocalSetupStart()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B27774();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "IDSLocalSetupStart", v2, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 startLocalSetup];
}

void IDSLocalSetupCompleted()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B277A0();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "IDSLocalSetupCompleted", v2, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 localSetupCompleted];
}

void IDSLocalSetupStop()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B277CC();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "IDSLocalSetupStop", v2, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 stopLocalSetup];
}

uint64_t IDSLocalSetupUnpair()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B277F8();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v3 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "IDSLocalSetupUnpair", v3, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 localSetupUnpair];

  return sleep(0xAu);
}

void IDSLocalSetupUnpairStart()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B27824();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    *v2 = 0;
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "IDSLocalSetupUnpairStart", v2, 2u);
  }

  v1 = +[IDSDaemonController sharedInstance];
  [v1 localSetupUnpairStart];
}

void IDSAddPairedDevice(void *a1)
{
  v8 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B27850();
  }

  v2 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v6 = 138412290;
    v7 = v1;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "IDSAddPairedDevice %@", &v6, 0xCu);
  }

  v3 = [MEMORY[0x1E69A6138] NRPairing];
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    v6 = 138412290;
    v7 = v1;
    _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "Asked to pair device with cbuuid: %@", &v6, 0xCu);
  }

  v4 = +[IDSDaemonController sharedInstance];
  [v4 addPairedDevice:v1];

  v5 = *MEMORY[0x1E69E9840];
}

void IDSConfigureDemoMode()
{
  if (_IDSRunningInDaemon())
  {
    sub_195B2787C();
  }

  v0 = +[IDSDaemonController sharedInstance];
  [v0 addListenerID:@"DemoModeConfig" services:0];

  IDSLocalSetupStart();
  IDSAddPairedDevice(@"12345678-0000-DADA-DADA-DEADBEEEEEEE");
  IDSLocalSetupCompleted();
  v1 = dispatch_time(0, 10000000000);
  v2 = MEMORY[0x1E69E96A0];

  dispatch_after(v1, v2, &unk_1F09E5CC0);
}

void sub_195A17664()
{
  v0 = +[IDSDaemonController sharedInstance];
  [v0 removeListenerID:@"DemoModeConfig"];
}

void IDSConnectPairedDevice(void *a1)
{
  v7 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B278A8();
  }

  v2 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v5 = 138412290;
    v6 = v1;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "IDSConnectPairedDevice %@", &v5, 0xCu);
  }

  v3 = +[IDSDaemonController sharedInstance];
  [v3 connectPairedDevice:v1];

  v4 = *MEMORY[0x1E69E9840];
}

void IDSDeletePairedDevice(void *a1)
{
  v8 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B278D4();
  }

  v2 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v4 = 136315394;
    v5 = "IDSDeletePairedDevice";
    v6 = 2112;
    v7 = v1;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "%s %@", &v4, 0x16u);
  }

  IDSDeletePairedDeviceWithCompletion(v1, 0, MEMORY[0x1E69E96A0]);
  v3 = *MEMORY[0x1E69E9840];
}

void IDSDeletePairedDeviceWithCompletion(void *a1, void *a2, void *a3)
{
  v23 = *MEMORY[0x1E69E9840];
  v5 = a1;
  v6 = a2;
  v7 = a3;
  if (_IDSRunningInDaemon())
  {
    sub_195B27900();
  }

  v8 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = MEMORY[0x19A8BBEF0](v6);
    *buf = 136315906;
    v16 = "IDSDeletePairedDeviceWithCompletion";
    v17 = 2112;
    v18 = v5;
    v19 = 2048;
    v20 = v9;
    v21 = 2048;
    v22 = v7;
    _os_log_impl(&dword_1959FF000, v8, OS_LOG_TYPE_DEFAULT, "%s %@ %p %p", buf, 0x2Au);
  }

  v10 = +[IDSPairedDeviceManager sharedInstance];
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = sub_195A17A28;
  v13[3] = &unk_1E743EBF0;
  v14 = v6;
  v11 = v6;
  [v10 deletePairedDevice:v5 withCompletionBlock:v13 queue:v7];

  v12 = *MEMORY[0x1E69E9840];
}

uint64_t sub_195A17A28(uint64_t a1)
{
  result = *(a1 + 32);
  if (result)
  {
    return (*(result + 16))();
  }

  return result;
}

void IDSDeletePairedDeviceWithCompletionBlock(void *a1, void *a2)
{
  v4 = a1;
  v3 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B2792C();
  }

  IDSDeletePairedDeviceWithCompletion(v4, v3, MEMORY[0x1E69E96A0]);
}

void IDSGetPairedDevicesWithCompletionBlock(void *a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a1;
  v4 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B27958();
  }

  if (v3)
  {
    v5 = +[IDSTransportLog IDSLocalSetup];
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136315138;
      v11 = "IDSGetPairedDevicesWithCompletionBlock";
      _os_log_impl(&dword_1959FF000, v5, OS_LOG_TYPE_DEFAULT, "%s", buf, 0xCu);
    }

    v6 = +[IDSPairedDeviceManager sharedInstance];
    v8[0] = MEMORY[0x1E69E9820];
    v8[1] = 3221225472;
    v8[2] = sub_195A17C10;
    v8[3] = &unk_1E743EBF0;
    v9 = v3;
    [v6 getPairedDeviceInfoWithCompletionBlock:v8 queue:v4];
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A17C10(uint64_t a1, void *a2)
{
  v3 = [a2 objectForKey:*MEMORY[0x1E69A4C28]];
  if (v3)
  {
    v4 = [objc_alloc(MEMORY[0x1E695DEC8]) initWithObjects:{v3, 0}];
  }

  else
  {
    v4 = 0;
  }

  v5 = v4;
  (*(*(a1 + 32) + 16))();
}

uint64_t IDSGetPairedDevices()
{
  v5 = *MEMORY[0x1E69E9840];
  if (_IDSRunningInDaemon())
  {
    sub_195B27984();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    v3 = 136315138;
    v4 = "IDSGetPairedDevices";
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "%s is DEPRECATED! Please use IDSGetPairedDevicesWithCompletionBlock", &v3, 0xCu);
  }

  v1 = *MEMORY[0x1E69E9840];
  return 0;
}

void IDSGetDeliveryStatsWithCompletionBlock(void *a1, void *a2)
{
  v3 = a1;
  v4 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B279B0();
  }

  if (v3)
  {
    v5 = +[IDSPairedDeviceManager sharedInstance];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = sub_195A17E3C;
    v6[3] = &unk_1E743EBF0;
    v7 = v3;
    [v5 getDeliveryStatsWithCompletionBlock:v6 queue:v4];
  }
}

void IDSInitialLocalSyncStarted()
{
  v4 = *MEMORY[0x1E69E9840];
  if (_IDSRunningInDaemon())
  {
    sub_195B279DC();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    v2 = 136315138;
    v3 = "IDSInitialLocalSyncStarted";
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "%s is DEPRECATED! Please use IDSInitialLocalSyncStartedForServices", &v2, 0xCu);
  }

  IDSInitialLocalSyncStartedForServices(0);
  v1 = *MEMORY[0x1E69E9840];
}

void IDSInitialLocalSyncStartedForServices(void *a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B27A08();
  }

  v2 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v5 = 136315394;
    v6 = "IDSInitialLocalSyncStartedForServices";
    v7 = 2112;
    v8 = v1;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "%s %@", &v5, 0x16u);
  }

  v3 = +[IDSDaemonController sharedInstance];
  [v3 initialLocalSyncStartedForServices:v1];

  v4 = *MEMORY[0x1E69E9840];
}

void IDSInitialLocalSyncCompleted()
{
  v4 = *MEMORY[0x1E69E9840];
  if (_IDSRunningInDaemon())
  {
    sub_195B27A34();
  }

  v0 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v0, OS_LOG_TYPE_DEFAULT))
  {
    v2 = 136315138;
    v3 = "IDSInitialLocalSyncCompleted";
    _os_log_impl(&dword_1959FF000, v0, OS_LOG_TYPE_DEFAULT, "%s is DEPRECATED! Please use IDSInitialLocalSyncCompletedForServices", &v2, 0xCu);
  }

  IDSInitialLocalSyncCompletedForServices(0);
  v1 = *MEMORY[0x1E69E9840];
}

void IDSInitialLocalSyncCompletedForServices(void *a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B27A60();
  }

  v2 = +[IDSTransportLog IDSLocalSetup];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v5 = 136315394;
    v6 = "IDSInitialLocalSyncCompletedForServices";
    v7 = 2112;
    v8 = v1;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "%s %@", &v5, 0x16u);
  }

  v3 = +[IDSDaemonController sharedInstance];
  [v3 initialLocalSyncCompletedForServices:v1];

  v4 = *MEMORY[0x1E69E9840];
}

void IDSIncomingAccountSyncMessage(void *a1, void *a2)
{
  v3 = a1;
  v4 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B27A8C();
  }

  v5 = [MEMORY[0x1E69A6138] accountSync];
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1959FF000, v5, OS_LOG_TYPE_DEFAULT, "Local setup - received incoming sync message", v7, 2u);
  }

  v6 = +[IDSDaemonController sharedInstance];
  [v6 incomingAccountSyncMessage:v3 fromID:v4];
}

void IDSSetAllowedTrafficClassifiersForDevice(void *a1, void *a2)
{
  v16 = *MEMORY[0x1E69E9840];
  v3 = a1;
  v4 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B27AB8();
  }

  if ([v4 isDefaultPairedDevice])
  {
    v5 = +[IDSInternalQueueController sharedInstance];
    v10[0] = MEMORY[0x1E69E9820];
    v10[1] = 3221225472;
    v10[2] = sub_195A18414;
    v10[3] = &unk_1E743E878;
    v6 = v3;
    v11 = v6;
    [v5 performBlock:v10];

    v7 = +[IDSPairedDeviceManager sharedInstance];
    [v7 setAllowedTrafficClassifiers:v6];

    v8 = v11;
  }

  else
  {
    v8 = +[IDSTransportLog IDSLocalSetup];
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136315394;
      v13 = "IDSSetAllowedTrafficClassifiersForDevice";
      v14 = 2112;
      v15 = v4;
      _os_log_impl(&dword_1959FF000, v8, OS_LOG_TYPE_DEFAULT, "%s: invalid device %@", buf, 0x16u);
    }
  }

  v9 = *MEMORY[0x1E69E9840];
}

void sub_195A18414(uint64_t a1)
{
  v2 = +[IDSDaemonController sharedInstance];
  [v2 setAllowedTrafficClasses:*(a1 + 32)];
}

id IDSGetAllowedTrafficClassifiersForDevice(void *a1)
{
  v11 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (_IDSRunningInDaemon())
  {
    sub_195B27AE4();
  }

  if ([v1 isDefaultPairedDevice])
  {
    v2 = +[IDSPairedDeviceManager sharedInstance];
    v3 = [v2 allowedTrafficClassifiers];
  }

  else
  {
    v4 = +[IDSTransportLog IDSLocalSetup];
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      v7 = 136315394;
      v8 = "IDSGetAllowedTrafficClassifiersForDevice";
      v9 = 2112;
      v10 = v1;
      _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "%s: invalid device %@", &v7, 0x16u);
    }

    v3 = 0;
  }

  v5 = *MEMORY[0x1E69E9840];

  return v3;
}

void IDSDropAllMessagesWithoutAnyAllowedTrafficClassifier(void *a1)
{
  v8 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if ([v1 isDefaultPairedDevice])
  {
    v2 = +[IDSPairedDeviceManager sharedInstance];
    [v2 dropAllMessagesWithoutAnyAllowedClassifier];
  }

  else
  {
    v2 = +[IDSTransportLog IDSLocalSetup];
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v4 = 136315394;
      v5 = "IDSDropAllMessagesWithoutAnyAllowedTrafficClassifier";
      v6 = 2112;
      v7 = v1;
      _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "%s: invalid device %@", &v4, 0x16u);
    }
  }

  v3 = *MEMORY[0x1E69E9840];
}

void sub_195A198B8(_Unwind_Exception *a1)
{
  objc_destroyWeak((v1 + 32));
  objc_destroyWeak((v2 - 80));
  _Unwind_Resume(a1);
}

void sub_195A198E0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    WeakRetained[23] = a3;
    v5 = WeakRetained;
    [WeakRetained parseDirectMessagingState];
    WeakRetained = v5;
  }
}

void sub_195A19B18(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, id location)
{
  objc_destroyWeak((v16 + 40));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A19B38(uint64_t a1, int a2, uint64_t a3)
{
  v15 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  v7 = WeakRetained;
  if (WeakRetained && *(WeakRetained + 10) == *(a1 + 32))
  {
    WeakRetained[5] = a2;
    v8 = +[IDSLogging IDSDirectMessagingConnection];
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 138412546;
      v12 = v7;
      v13 = 1024;
      v14 = a2;
      _os_log_impl(&dword_1959FF000, v8, OS_LOG_TYPE_DEFAULT, "%@ connection entered state: %d", &v11, 0x12u);
    }

    v9 = v7[5];
    if (v9 == 5)
    {
      goto LABEL_10;
    }

    if (v9 == 3)
    {
      *(v7 + 8) = 0;
      [v7 receiveMessages];
      [v7 dequeueMessages];
      goto LABEL_11;
    }

    if (a3 || v9 == 4)
    {
LABEL_10:
      [v7 resetConnection];
      [v7 setupConnectionIfApplicable];
    }
  }

LABEL_11:

  v10 = *MEMORY[0x1E69E9840];
}

void sub_195A19F98(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, id location)
{
  objc_destroyWeak((v15 + 32));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A19FC4(uint64_t a1, int a2, void *a3)
{
  v16 = *MEMORY[0x1E69E9840];
  v5 = a3;
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    v7 = +[IDSLogging IDSDirectMessagingConnection];
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v10 = 138412802;
      v11 = WeakRetained;
      v12 = 1024;
      v13 = a2;
      v14 = 2112;
      v15 = v5;
      _os_log_impl(&dword_1959FF000, v7, OS_LOG_TYPE_DEFAULT, "%@ direct messaging socket: %d, error: %@", &v10, 0x1Cu);
    }

    if (v5)
    {
      [WeakRetained resetConnection];
    }

    else
    {
      v8 = nw_connection_create_with_connected_socket();
      [WeakRetained updateConnection:v8];
    }
  }

  v9 = *MEMORY[0x1E69E9840];
}

void sub_195A1A528(_Unwind_Exception *a1)
{
  objc_destroyWeak((v1 + 40));
  objc_destroyWeak((v2 - 40));
  _Unwind_Resume(a1);
}

void sub_195A1A544(uint64_t a1, void *a2, uint64_t a3, uint64_t a4, void *a5)
{
  v44 = *MEMORY[0x1E69E9840];
  v7 = a2;
  v8 = a5;
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  v10 = WeakRetained;
  if (!WeakRetained || *(WeakRetained + 10) != *(a1 + 32))
  {
    goto LABEL_17;
  }

  if (!v8)
  {
    v12 = v7;
    if ([v12 length])
    {
      v13 = [v12 bytes];
      v14 = *v13;
      v15 = v13[1];
      if (v15 <= 6 && ((1 << v15) & 0x54) != 0)
      {
        v16 = +[IDSLogging IDSDirectMessagingConnection];
        if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
        {
          v17 = *(v10 + 7);
          v18 = *(v10 + 8);
          if (!v18)
          {
            v18 = "<unknown>";
          }

          *buf = 134218242;
          v35 = v17;
          v36 = 2080;
          v37 = v18;
          _os_log_impl(&dword_1959FF000, v16, OS_LOG_TYPE_DEFAULT, "[%llu %s] Ignoring HS Header", buf, 0x16u);
        }
      }

      else
      {
        v20 = *(v13 + 1);
        v21 = *(v13 + 2);
        v22 = bswap32(v21);
        v23 = [v12 length];
        v24 = vdupq_n_s64(1uLL);
        v24.i64[0] = v23 + v22;
        *(v10 + 232) = vaddq_s64(v24, *(v10 + 232));
        v25 = +[IDSLogging IDSDirectMessagingConnection];
        if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
        {
          v26 = *(v10 + 7);
          v27 = *(v10 + 8);
          if (!v27)
          {
            v27 = "<unknown>";
          }

          *buf = 134219010;
          v35 = v26;
          v36 = 2080;
          v37 = v27;
          v38 = 1024;
          v39 = v14;
          v40 = 1024;
          v41 = v15;
          v42 = 1024;
          v43 = v22;
          _os_log_impl(&dword_1959FF000, v25, OS_LOG_TYPE_DEFAULT, "[%llu %s] Received Header: v %u t %u l %u", buf, 0x28u);
        }

        v28 = bswap32(v20);

        if (v21)
        {
          v29 = *(v10 + 10);
          v30[0] = MEMORY[0x1E69E9820];
          v30[1] = 3221225472;
          v30[2] = sub_195A1A858;
          v30[3] = &unk_1E743ED00;
          v31 = v10;
          v33 = v15;
          v32 = v28;
          nw_connection_receive(v29, v22, v22, v30);

          goto LABEL_16;
        }

        [v10 processIncomingMessage:0 messageType:v15 messageIdentifier:v28];
      }
    }

    [v10 receiveMessages];
LABEL_16:

    goto LABEL_17;
  }

  v11 = +[IDSLogging IDSDirectMessagingConnection];
  if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
  {
    sub_195B27E8C();
  }

  [v10 resetConnection];
LABEL_17:

  v19 = *MEMORY[0x1E69E9840];
}

uint64_t sub_195A1A858(uint64_t a1, uint64_t a2)
{
  [*(a1 + 32) processIncomingMessage:a2 messageType:*(a1 + 44) messageIdentifier:*(a1 + 40)];
  v3 = *(a1 + 32);

  return [v3 receiveMessages];
}

id sub_195A1B278(void *a1)
{
  v36 = *MEMORY[0x1E69E9840];
  v1 = a1;
  if (v1)
  {
    v24 = 0;
    v25 = &v24;
    v26 = 0x3032000000;
    v27 = sub_195A00694;
    v28 = sub_195A03CF0;
    v29 = 0;
    Mutable = CFDictionaryCreateMutable(0, 0, MEMORY[0x1E695E9D8], MEMORY[0x1E695E9E8]);
    v3 = v25[5];
    v25[5] = Mutable;

    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v21 = sub_195A1BB8C;
    v22 = &unk_1E743EDA0;
    v23 = &v24;
    v4 = v1;
    v5 = v20;
    v6 = v4;
    v7 = [v4 bytes];
    if ([v4 length])
    {
      v8 = 0;
      v9 = v7;
      while ((v8 + 5) <= [v4 length])
      {
        v10 = *v9;
        v11 = *(v9 + 1);
        v12 = (v9 + 5);
        v13 = bswap32(v11);
        v14 = v12 - v7;
        if (v12 + v13 - v7 > [v4 length])
        {
          v16 = +[IDSLogging IDSDirectMessagingConnection];
          if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
          {
            v19 = [v4 length];
            *buf = 67109632;
            v31 = v14;
            v32 = 1024;
            v33 = v13;
            v34 = 2048;
            v35 = v19;
            _os_log_error_impl(&dword_1959FF000, v16, OS_LOG_TYPE_ERROR, "malformed tlv received ((%d + %u > %lu)", buf, 0x18u);
          }

          goto LABEL_13;
        }

        v21(v5, v10, v13, v12);
        v9 = v12 + v13;
        v8 = &v9[-v7];
        if (&v9[-v7] >= [v4 length])
        {
          goto LABEL_14;
        }
      }

      v16 = +[IDSLogging IDSDirectMessagingConnection];
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        sub_195B27F00(v8, buf, [v4 length], v16);
      }

LABEL_13:
    }

LABEL_14:

    v15 = v25[5];
    _Block_object_dispose(&v24, 8);
  }

  else
  {
    v15 = 0;
  }

  v17 = *MEMORY[0x1E69E9840];

  return v15;
}

void sub_195A1B558(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A1B71C(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, id location)
{
  objc_destroyWeak((v17 + 40));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A1B740(uint64_t a1)
{
  v17 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  if (WeakRetained)
  {
    v3 = +[IDSLogging IDSDirectMessagingConnection];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = "<unknown>";
      v5 = WeakRetained[7];
      if (WeakRetained[8])
      {
        v4 = WeakRetained[8];
      }

      v6 = *(a1 + 32);
      v7 = *(a1 + 48);
      v9 = 134218754;
      v10 = v5;
      v11 = 2080;
      v12 = v4;
      v13 = 2112;
      v14 = v6;
      v15 = 1024;
      v16 = v7;
      _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "[%llu %s] connection wrote ack for guid: %@(%u)", &v9, 0x26u);
    }
  }

  v8 = *MEMORY[0x1E69E9840];
}

void sub_195A1BA70(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, id location)
{
  objc_destroyWeak((v15 + 40));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A1BA94(uint64_t a1)
{
  v14 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  if (WeakRetained)
  {
    v3 = +[IDSLogging IDSDirectMessagingConnection];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = WeakRetained[7];
      v5 = WeakRetained[8];
      if (!v5)
      {
        v5 = "<unknown>";
      }

      v6 = *(a1 + 32);
      v8 = 134218498;
      v9 = v4;
      v10 = 2080;
      v11 = v5;
      v12 = 2112;
      v13 = v6;
      _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "[%llu %s] connection wrote app-ack for guid: %@(0)", &v8, 0x20u);
    }
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A1BB8C(uint64_t a1, int a2, unsigned int a3, unsigned int *a4)
{
  if (a2 <= 5)
  {
    if (a2 <= 3)
    {
      if (a2 == 1)
      {
        if (a3 == 4)
        {
          v5 = [MEMORY[0x1E696AD98] numberWithUnsignedInt:bswap32(*a4)];
          v14 = v5;
          v6 = *(*(*(a1 + 32) + 8) + 40);
          v7 = @"ids-dm-sqnm";
          goto LABEL_26;
        }

        v13 = +[IDSLogging IDSDirectMessagingConnection];
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
          sub_195B2817C();
        }
      }

      else
      {
        if (a2 != 3)
        {
          return;
        }

        if (a3 == 1)
        {
          v5 = [MEMORY[0x1E696AD98] numberWithUnsignedChar:*a4];
          v14 = v5;
          v6 = *(*(*(a1 + 32) + 8) + 40);
          v7 = @"ids-dm-spmf";
          goto LABEL_26;
        }

        v13 = +[IDSLogging IDSDirectMessagingConnection];
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
          sub_195B28100();
        }
      }

LABEL_40:

      return;
    }

    if (a2 == 4)
    {
      v5 = [objc_alloc(MEMORY[0x1E696AEC0]) initWithBytes:a4 length:a3 encoding:4];
      v14 = v5;
      v6 = *(*(*(a1 + 32) + 8) + 40);
      v7 = @"ids-dm-iri";
      goto LABEL_26;
    }

    if (a3 != 16)
    {
      v13 = +[IDSLogging IDSDirectMessagingConnection];
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        sub_195B281F8();
      }

      goto LABEL_40;
    }

    v14 = [objc_alloc(MEMORY[0x1E696AFB0]) initWithUUIDBytes:a4];
    v8 = [v14 UUIDString];
    v9 = [v8 copy];

    [*(*(*(a1 + 32) + 8) + 40) setObject:v9 forKeyedSubscript:@"ids-dm-ori"];
  }

  else
  {
    if (a2 <= 7)
    {
      if (a2 == 6)
      {
        v5 = [objc_alloc(MEMORY[0x1E695DEF0]) initWithBytes:a4 length:a3];
        v14 = v5;
        v6 = *(*(*(a1 + 32) + 8) + 40);
        v7 = @"ids-dm-cd";
        goto LABEL_26;
      }

      v14 = [objc_alloc(MEMORY[0x1E695DEF0]) initWithBytes:a4 length:a3];
      v10 = [MEMORY[0x1E695DF20] dictionaryWithPlistData:v14];
      v11 = *(*(*(a1 + 32) + 8) + 40);
      v12 = @"ids-dm-cm";
    }

    else
    {
      if (a2 != 8)
      {
        if (a2 == 10)
        {
          if (a3 == 2)
          {
            v5 = [MEMORY[0x1E696AD98] numberWithUnsignedShort:bswap32(*a4) >> 16];
            v14 = v5;
            v6 = *(*(*(a1 + 32) + 8) + 40);
            v7 = @"ids-dm-tc";
            goto LABEL_26;
          }

          v13 = +[IDSLogging IDSDirectMessagingConnection];
          if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
          {
            sub_195B28084();
          }
        }

        else
        {
          if (a2 != 11)
          {
            return;
          }

          if (a3 == 4)
          {
            v5 = [MEMORY[0x1E696AD98] numberWithUnsignedInt:*a4];
            v14 = v5;
            v6 = *(*(*(a1 + 32) + 8) + 40);
            v7 = @"ids-dm-afsqnm";
LABEL_26:
            [v6 setObject:v5 forKeyedSubscript:v7];
            goto LABEL_27;
          }

          v13 = +[IDSLogging IDSDirectMessagingConnection];
          if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
          {
            sub_195B28008();
          }
        }

        goto LABEL_40;
      }

      v14 = [objc_alloc(MEMORY[0x1E695DEF0]) initWithBytes:a4 length:a3];
      v10 = [MEMORY[0x1E695DF20] dictionaryWithPlistData:v14];
      v11 = *(*(*(a1 + 32) + 8) + 40);
      v12 = @"ids-dm-cpb";
    }

    [v11 setObject:v10 forKeyedSubscript:v12];
  }

LABEL_27:
}

void sub_195A1D138(uint64_t a1)
{
  v41 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  v3 = WeakRetained;
  if (WeakRetained && WeakRetained[14] == *(a1 + 32))
  {
    v4 = mach_continuous_time();
    v5 = [*(v3 + 17) copy];
    v30 = 0u;
    v31 = 0u;
    v32 = 0u;
    v33 = 0u;
    v6 = v5;
    v7 = [v6 countByEnumeratingWithState:&v30 objects:v40 count:16];
    if (v7)
    {
      v9 = v7;
      v10 = *v31;
      *&v8 = 134218498;
      v27 = v8;
      v28 = v6;
      do
      {
        v11 = 0;
        v29 = v9;
        do
        {
          if (*v31 != v10)
          {
            objc_enumerationMutation(v6);
          }

          v12 = [v6 objectForKeyedSubscript:{*(*(&v30 + 1) + 8 * v11), v27, v28}];
          v13 = [v12 objectForKeyedSubscript:@"ids-dm-snd-time"];
          v14 = [v13 unsignedLongLongValue];
          v17 = 0.0;
          if (v14)
          {
            v18 = v4 > v14;
          }

          else
          {
            v18 = 0;
          }

          if (v18)
          {
            v19 = v14;
            if (qword_1EAEDC0A8 != -1)
            {
              sub_195B2830C();
            }

            LODWORD(v15) = dword_1EAEDC0B0;
            LODWORD(v16) = *algn_1EAEDC0B4;
            v17 = (v4 - v19) * v15 / v16 / 1000000.0;
          }

          if (v17 <= *(v3 + 8))
          {
            if (v17 > *(v3 + 9))
            {
              v20 = +[IDSLogging IDSDirectMessagingConnection];
              if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
              {
                v21 = *(v3 + 7);
                v22 = v4;
                v23 = v10;
                if (*(v3 + 8))
                {
                  v24 = *(v3 + 8);
                }

                else
                {
                  v24 = "<unknown>";
                }

                v25 = [v12 objectForKeyedSubscript:@"ids-dm-msg-guid"];
                *buf = v27;
                v35 = v21;
                v36 = 2080;
                v37 = v24;
                v10 = v23;
                v4 = v22;
                v6 = v28;
                v9 = v29;
                v38 = 2112;
                v39 = v25;
                _os_log_impl(&dword_1959FF000, v20, OS_LOG_TYPE_DEFAULT, "[%llu %s] Message %@ taking long, retrying", buf, 0x20u);
              }

              [v3 dequeueMessages];
            }
          }

          else
          {
            [v3 failedToSendMessage:v12 responseCode:12];
          }

          ++v11;
        }

        while (v9 != v11);
        v9 = [v6 countByEnumeratingWithState:&v30 objects:v40 count:16];
      }

      while (v9);
    }
  }

  v26 = *MEMORY[0x1E69E9840];
}

void sub_195A1D668(_Unwind_Exception *a1)
{
  objc_destroyWeak((v1 + 40));
  objc_destroyWeak((v2 - 88));
  _Unwind_Resume(a1);
}

void sub_195A1D694(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  if (WeakRetained)
  {
    v3 = WeakRetained;
    [WeakRetained failedToSendMessage:*(a1 + 32) responseCode:15];
    [v3 dequeueMessages];
    WeakRetained = v3;
  }
}

void sub_195A1D6F4(uint64_t a1)
{
  v18 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  if (WeakRetained)
  {
    v3 = +[IDSLogging IDSDirectMessagingConnection];
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = "<unknown>";
      v5 = WeakRetained[7];
      if (WeakRetained[8])
      {
        v4 = WeakRetained[8];
      }

      v6 = *(a1 + 56);
      v7 = *(a1 + 32);
      v10 = 134218754;
      v11 = v5;
      v12 = 2080;
      v13 = v4;
      v14 = 1024;
      v15 = v6;
      v16 = 2112;
      v17 = v7;
      _os_log_impl(&dword_1959FF000, v3, OS_LOG_TYPE_DEFAULT, "[%llu %s] connection wrote message w/ seq num %u guid %@", &v10, 0x26u);
    }

    v8 = WeakRetained[27];
    ++WeakRetained[28];
    WeakRetained[27] = v8 + *(a1 + 48);
    [WeakRetained dequeueMessages];
  }

  v9 = *MEMORY[0x1E69E9840];
}

void sub_195A1DB08(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained logConnectionStatisticsInPowerDictionary];
}

void sub_195A1E3F0(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a4;
  v8 = a3;
  v9 = [a2 copy];
  v10 = *(a1 + 32);
  v11 = *(v10 + 32);
  *(v10 + 32) = v9;

  v12 = [v8 copy];
  v13 = *(a1 + 32);
  v14 = *(v13 + 40);
  *(v13 + 40) = v12;

  v15 = [v7 copy];
  v16 = *(a1 + 32);
  v17 = *(v16 + 24);
  *(v16 + 24) = v15;
}

void sub_195A1E494(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = MEMORY[0x1E69A6128];
  v8 = a4;
  v9 = a3;
  v10 = [a2 copy];
  v11 = [v9 copy];

  v12 = [v7 pairWithFirst:v10 second:v11];

  [*(*(a1 + 32) + 56) setObject:v12 forKeyedSubscript:v8];
}

uint64_t sub_195A209B8(void *a1)
{
  v2 = [[_IDSGroupSession alloc] initWithAccount:a1[5] destinations:a1[6] options:a1[7] delegateContext:a1[4]];
  v3 = a1[4];
  v4 = *(v3 + 8);
  *(v3 + 8) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A20B70(uint64_t a1)
{
  v2 = MEMORY[0x1E695DFD8];
  v3 = [*(a1 + 32) objectForKeyedSubscript:*MEMORY[0x1E69A4D68]];
  v7 = [v2 setWithArray:v3];

  v4 = [[_IDSGroupSession alloc] initWithAccount:*(a1 + 48) destinations:v7 options:*(a1 + 32) delegateContext:*(a1 + 40)];
  v5 = *(a1 + 40);
  v6 = *(v5 + 8);
  *(v5 + 8) = v4;
}

uint64_t sub_195A20DF0(void *a1)
{
  v2 = [[_IDSGroupSession alloc] initWithAccount:a1[5] destinations:a1[6] options:a1[7] delegateContext:a1[4] delegate:a1[8] queue:a1[9]];
  v3 = a1[4];
  v4 = *(v3 + 8);
  *(v3 + 8) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A20FF4(uint64_t a1)
{
  v2 = MEMORY[0x1E695DFD8];
  v3 = [*(a1 + 32) objectForKeyedSubscript:*MEMORY[0x1E69A4D68]];
  v7 = [v2 setWithArray:v3];

  v4 = [[_IDSGroupSession alloc] initWithAccount:*(a1 + 48) destinations:v7 options:*(a1 + 32) delegateContext:*(a1 + 40) delegate:*(a1 + 56) queue:*(a1 + 64)];
  v5 = *(a1 + 40);
  v6 = *(v5 + 8);
  *(v5 + 8) = v4;
}

void sub_195A211B8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A2128C(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  v2 = +[IDSLogging _IDSGroupSession];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = *(v3 + 8);
    v8 = 134218240;
    v9 = v3;
    v10 = 2048;
    v11 = v4;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "Invalidating _IDSGroupSession { self: %p, _internal: %p }", &v8, 0x16u);
  }

  [*(*(a1 + 32) + 8) invalidate];
  v5 = *(a1 + 32);
  v6 = *(v5 + 8);
  *(v5 + 8) = 0;

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A2154C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A21564(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) uniqueID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A216EC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A21704(void *a1)
{
  v2 = [*(a1[4] + 8) sessionIDAliasWithSalt:a1[5]];
  v3 = *(a1[6] + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A219C0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A219E4(void *a1)
{
  v14 = *MEMORY[0x1E69E9840];
  v2 = [*(a1[4] + 8) localParticipantID];
  v3 = a1[5];
  *(*(a1[6] + 8) + 24) = IDSIDAliasHashUInt64();
  v4 = +[IDSLogging _IDSGroupSession];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    v5 = a1[5];
    v6 = *(*(a1[6] + 8) + 24);
    v8 = 134218498;
    v9 = v6;
    v10 = 2048;
    v11 = v2;
    v12 = 2112;
    v13 = v5;
    _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "createAliasForLocalParticipantIDWithSalt created %llu from %llu and %@", &v8, 0x20u);
  }

  v7 = *MEMORY[0x1E69E9840];
}

void sub_195A21C74(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A21C90(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(*(a1 + 32) + 8);
  v3 = *(a1 + 64);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A21D40;
  v6[3] = &unk_1E743EF88;
  v5 = *(a1 + 48);
  v4 = v5;
  v7 = v5;
  [v2 getParticipantIDForAlias:v3 salt:v1 completionHandler:v6];
}

uint64_t sub_195A21E30(void *a1)
{
  v1 = a1[5];
  v2 = a1[6];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_createSessionIDAliasWithSalt_delegateQueueCompletionHandler_);
}

uint64_t sub_195A21F2C(void *a1)
{
  v1 = a1[5];
  v3 = a1[6];
  v2 = a1[7];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_createAliasForParticipantID_salt_delegateQueueCompletionHandler_);
}

uint64_t sub_195A2201C(void *a1)
{
  v1 = a1[5];
  v2 = a1[6];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_createAliasForLocalParticipantIDWithSalt_delegateQueueCompletionHandler_);
}

uint64_t sub_195A22118(void *a1)
{
  v1 = a1[5];
  v3 = a1[6];
  v2 = a1[7];
  return MEMORY[0x1EEE66B58](*(a1[4] + 8), sel_getParticipantIDForAlias_salt_delegateQueueCompletionHandler_);
}

void sub_195A2223C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A22254(uint64_t a1)
{
  v5 = [*(*(a1 + 32) + 8) uniqueID];
  v2 = [@"session:" stringByAppendingString:v5];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void sub_195A2239C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A223B4(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) state];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A224BC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A224D4(uint64_t a1)
{
  result = [*(*(a1 + 32) + 8) sessionEndedReason];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

void sub_195A2261C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A22634(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) requiredCapabilities];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A22794(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A227AC(uint64_t a1)
{
  v2 = [*(*(a1 + 32) + 8) requiredLackOfCapabilities];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A228D8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setDelegate:*(a1 + 40) queue:*(a1 + 48)];
}

void sub_195A22AA8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateMembers:*(a1 + 40) withContext:*(a1 + 48) triggeredLocally:*(a1 + 56)];
}

void sub_195A22C0C(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateMembers:*(a1 + 40) withContext:*(a1 + 48) messagingCapabilities:*(a1 + 56) triggeredLocally:*(a1 + 64)];
}

void sub_195A22DB8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 manageDesignatedMembers:*(a1 + 40) withType:*(a1 + 48)];
}

void sub_195A22EC8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 removeParticipantIDs:*(a1 + 40)];
}

void sub_195A22FF8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateParticipantData:*(a1 + 40) withContext:*(a1 + 48)];
}

void sub_195A23104(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateParticipantInfo:*(a1 + 40)];
}

void sub_195A23210(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setParticipantInfo:*(a1 + 40)];
}

void sub_195A23358(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateParticipantType:*(a1 + 56) members:*(a1 + 40) withContext:*(a1 + 48) triggeredLocally:*(a1 + 58)];
}

void sub_195A234C8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 updateParticipantType:*(a1 + 72) members:*(a1 + 40) withContext:*(a1 + 48) triggeredLocally:*(a1 + 74) timestamp:*(a1 + 64) identifier:*(a1 + 56)];
}

void sub_195A235E4(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 joinWithOptions:*(a1 + 40)];
}

void sub_195A236C8(uint64_t a1)
{
  v1 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v1 leaveGroupSessionWithOptions:0];
}

void sub_195A237C8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 leaveGroupSessionWithOptions:*(a1 + 40)];
}

void sub_195A238AC(uint64_t a1)
{
  v1 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v1 reconnectUPlusOneSession];
}

void sub_195A239A8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setPreferences:*(a1 + 40)];
}

void sub_195A23AEC(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setRequiredCapabilities:*(a1 + 40) requiredLackOfCapabilities:*(a1 + 48)];
}

void sub_195A23BD0(uint64_t a1)
{
  v1 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v1 requestActiveParticipants];
}

void sub_195A23CD0(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 registerPluginWithOptions:*(a1 + 40)];
}

void sub_195A23DDC(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 unregisterPluginWithOptions:*(a1 + 40)];
}

void sub_195A23ED0(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setCallScreeningMode:*(a1 + 40)];
}

void sub_195A23FC4(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setForceTCPFallbackOnWiFiUsingReinitiate:*(a1 + 40)];
}

void sub_195A240B8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 setForceTCPFallbackOnCellUsingReinitiate:*(a1 + 40)];
}

void sub_195A241E8(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 requestURIsForParticipantIDs:*(a1 + 40) completionHandler:*(a1 + 48)];
}

void sub_195A24970(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 requestDataCryptorForTopic:*(a1 + 40) completionHandler:*(a1 + 48)];
}

void sub_195A24A7C(uint64_t a1)
{
  v2 = [*(a1 + 32) _internal_sessionWithValidityCheck];
  [v2 requestEncryptionKeyForParticipants:*(a1 + 40)];
}

void sub_195A24C28()
{
  v0 = [MEMORY[0x1E696B0D0] interfaceWithProtocol:&unk_1F0A52CA8];
  v1 = qword_1ED5DDE38;
  qword_1ED5DDE38 = v0;

  v2 = qword_1ED5DDE38;
  v3 = MEMORY[0x1E695DFD8];
  v4 = objc_opt_class();
  v5 = objc_opt_class();
  v6 = [v3 setWithObjects:{v4, v5, objc_opt_class(), 0}];
  [v2 setClasses:v6 forSelector:sel_requestSelectedSubscriptionsWithCompletion_ argumentIndex:0 ofReply:1];

  v7 = qword_1ED5DDE38;
  v8 = MEMORY[0x1E695DFD8];
  v9 = objc_opt_class();
  v10 = objc_opt_class();
  v11 = [v8 setWithObjects:{v9, v10, objc_opt_class(), 0}];
  [v7 setClasses:v11 forSelector:sel_requestUnselectedTemporaryPhoneAliasesWithCompletion_ argumentIndex:0 ofReply:1];

  v12 = qword_1ED5DDE38;
  v13 = MEMORY[0x1E695DFD8];
  v14 = objc_opt_class();
  v15 = objc_opt_class();
  v16 = [v13 setWithObjects:{v14, v15, objc_opt_class(), 0}];
  [v12 setClasses:v16 forSelector:sel_selectSubscription_withCompletion_ argumentIndex:0 ofReply:0];

  v17 = qword_1ED5DDE38;
  v18 = MEMORY[0x1E695DFD8];
  v19 = objc_opt_class();
  v20 = objc_opt_class();
  v21 = [v18 setWithObjects:{v19, v20, objc_opt_class(), 0}];
  [v17 setClasses:v21 forSelector:sel_selectSubscription_withCompletion_ argumentIndex:0 ofReply:1];

  v22 = qword_1ED5DDE38;
  v23 = MEMORY[0x1E695DFD8];
  v24 = objc_opt_class();
  v25 = objc_opt_class();
  v26 = [v23 setWithObjects:{v24, v25, objc_opt_class(), 0}];
  [v22 setClasses:v26 forSelector:sel_unselectSubscription_withCompletion_ argumentIndex:0 ofReply:0];

  v27 = qword_1ED5DDE38;
  v28 = MEMORY[0x1E695DFD8];
  v29 = objc_opt_class();
  v30 = objc_opt_class();
  v31 = [v28 setWithObjects:{v29, v30, objc_opt_class(), 0}];
  [v27 setClasses:v31 forSelector:sel_unselectSubscription_withCompletion_ argumentIndex:0 ofReply:1];

  v32 = qword_1ED5DDE38;
  v33 = MEMORY[0x1E695DFD8];
  v34 = objc_opt_class();
  v35 = objc_opt_class();
  v36 = [v33 setWithObjects:{v34, v35, objc_opt_class(), 0}];
  [v32 setClasses:v36 forSelector:sel_setSelectedSubscriptions_withCompletion_ argumentIndex:0 ofReply:0];

  v37 = qword_1ED5DDE38;
  v38 = MEMORY[0x1E695DFD8];
  v39 = objc_opt_class();
  v40 = objc_opt_class();
  v41 = [v38 setWithObjects:{v39, v40, objc_opt_class(), 0}];
  [v37 setClasses:v41 forSelector:sel_setSelectedSubscriptions_withCompletion_ argumentIndex:0 ofReply:1];
}

void sub_195A25368(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, ...)
{
  va_start(va, a13);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A25384(uint64_t a1)
{
  *(*(a1 + 32) + 32) = *(a1 + 64);
  v2 = [*(a1 + 32) _serviceNameForServiceType:?];
  v3 = *(a1 + 32);
  v4 = *(v3 + 24);
  *(v3 + 24) = v2;

  v5 = [objc_alloc(MEMORY[0x1E69A5408]) initWithServiceIdentifier:*(*(a1 + 32) + 24)];
  v6 = *(a1 + 32);
  v7 = *(v6 + 40);
  *(v6 + 40) = v5;

  v8 = [_IDSService alloc];
  v9 = *(a1 + 32);
  v10 = v9[3];
  v11 = [v9 _commandsForServiceType:*(a1 + 64)];
  v12 = [(_IDSService *)v8 initWithService:v10 commands:v11 manuallyAckMessages:0 delegateContext:0];
  v13 = *(a1 + 32);
  v14 = *(v13 + 48);
  *(v13 + 48) = v12;

  objc_storeStrong((*(a1 + 32) + 56), *(a1 + 40));
  objc_storeStrong((*(a1 + 32) + 8), *(a1 + 48));
  v15 = [MEMORY[0x1E696AEC0] stringGUID];
  v16 = *(a1 + 32);
  v17 = *(v16 + 16);
  *(v16 + 16) = v15;

  v18 = [*(*(a1 + 32) + 48) serviceProperties];
  *(*(*(a1 + 56) + 8) + 24) = [v18 supportsOfflineDelivery];
}

void sub_195A25698(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, id location)
{
  objc_destroyWeak((v14 + 32));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A256B4(uint64_t a1)
{
  v7 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v2 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [WeakRetained uuid];
    v5 = 138412290;
    v6 = v3;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "XPC interruption for client %@", &v5, 0xCu);
  }

  [WeakRetained _setupXPC];
  v4 = *MEMORY[0x1E69E9840];
}

void sub_195A258D4(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, id location)
{
  objc_destroyWeak((v15 + 32));
  objc_destroyWeak(&location);
  _Unwind_Resume(a1);
}

void sub_195A258F8(uint64_t a1, void *a2)
{
  v3 = a2;
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v4 = [v3 offGridMessengerCollaboratorWithErrorHandler:&unk_1F09E5D20];

  v5 = [WeakRetained uuid];
  [v4 setupOffGridMessengerClient:WeakRetained withUUID:v5 forServiceType:{objc_msgSend(WeakRetained, "serviceType")}];
}

void sub_195A25998(uint64_t a1, void *a2)
{
  v2 = a2;
  v3 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }
}

void sub_195A25AF4(uint64_t a1)
{
  v26 = *MEMORY[0x1E69E9840];
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  obj = [*(*(a1 + 32) + 48) accounts];
  v2 = [obj countByEnumeratingWithState:&v20 objects:v25 count:16];
  if (v2)
  {
    v3 = v2;
    v4 = *v21;
    do
    {
      for (i = 0; i != v3; ++i)
      {
        if (*v21 != v4)
        {
          objc_enumerationMutation(obj);
        }

        v6 = *(*(&v20 + 1) + 8 * i);
        if ([v6 isActive])
        {
          v18 = 0u;
          v19 = 0u;
          v16 = 0u;
          v17 = 0u;
          v7 = [v6 handles];
          v8 = [v7 countByEnumeratingWithState:&v16 objects:v24 count:16];
          if (v8)
          {
            v9 = v8;
            v10 = *v17;
            do
            {
              for (j = 0; j != v9; ++j)
              {
                if (*v17 != v10)
                {
                  objc_enumerationMutation(v7);
                }

                v12 = *(a1 + 40);
                v13 = [*(*(&v16 + 1) + 8 * j) URI];
                [v12 addObject:v13];
              }

              v9 = [v7 countByEnumeratingWithState:&v16 objects:v24 count:16];
            }

            while (v9);
          }
        }
      }

      v3 = [obj countByEnumeratingWithState:&v20 objects:v25 count:16];
    }

    while (v3);
  }

  v14 = *MEMORY[0x1E69E9840];
}

void sub_195A25DC8(uint64_t a1, void *a2)
{
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = sub_195A25EF0;
  v12[3] = &unk_1E743F138;
  v4 = *(a1 + 64);
  v12[4] = *(a1 + 32);
  v13 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v12];
  v6 = *(a1 + 40);
  v7 = *(a1 + 48);
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A25FF8;
  v10[3] = &unk_1E743F188;
  v8 = *(a1 + 56);
  v9 = *(a1 + 64);
  v10[4] = *(a1 + 32);
  v11 = v9;
  [v5 donateHandlesForMessagingKeys:v6 fromURI:v7 options:v8 completion:v10];
}

void sub_195A25EF0(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A25FE0;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A25FF8(uint64_t a1, char a2, void *a3)
{
  v5 = a3;
  v6 = *(a1 + 40);
  if (v6)
  {
    v7 = *(*(a1 + 32) + 56);
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = sub_195A260BC;
    block[3] = &unk_1E743F160;
    v10 = v6;
    v11 = a2;
    v9 = v5;
    dispatch_async(v7, block);
  }
}

void sub_195A261E8(uint64_t a1, void *a2)
{
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = sub_195A2631C;
  v13[3] = &unk_1E743F138;
  v4 = *(a1 + 64);
  v13[4] = *(a1 + 32);
  v14 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v13];
  v6 = *(a1 + 40);
  v7 = *(*(a1 + 32) + 24);
  v8 = *(a1 + 48);
  v9 = *(a1 + 56);
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = sub_195A26478;
  v11[3] = &unk_1E743F200;
  v10 = *(a1 + 64);
  v11[4] = *(a1 + 32);
  v12 = v10;
  [v5 resultsForDestinationURIs:v6 senderURI:v8 service:v7 options:v9 completion:v11];
}

void sub_195A2631C(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A2640C;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A2640C(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = [MEMORY[0x1E695DF20] dictionary];
  (*(v2 + 16))(v2, v3, *(a1 + 32));
}

void sub_195A26478(uint64_t a1, void *a2, void *a3)
{
  v5 = a2;
  v6 = a3;
  v7 = *(a1 + 40);
  if (v7)
  {
    v8 = *(*(a1 + 32) + 56);
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = sub_195A26554;
    block[3] = &unk_1E743F1D8;
    v12 = v7;
    v10 = v5;
    v11 = v6;
    dispatch_async(v8, block);
  }
}

void sub_195A26690(uint64_t a1, void *a2)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A267A4;
  v10[3] = &unk_1E743F138;
  v4 = *(a1 + 48);
  v10[4] = *(a1 + 32);
  v11 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v10];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = sub_195A268B0;
  v8[3] = &unk_1E743F250;
  v6 = *(a1 + 40);
  v7 = *(a1 + 48);
  v8[4] = *(a1 + 32);
  v9 = v7;
  [v5 encryptOffGridMessage:v6 completion:v8];
}

void sub_195A267A4(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A26894;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A268B0(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1 + 40);
  if (v10)
  {
    v11 = *(*(a1 + 32) + 56);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A269AC;
    v12[3] = &unk_1E743F228;
    v16 = v10;
    v13 = v7;
    v14 = v8;
    v15 = v9;
    dispatch_async(v11, v12);
  }
}

void sub_195A26A8C(uint64_t a1, void *a2)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A26BA0;
  v10[3] = &unk_1E743F138;
  v4 = *(a1 + 48);
  v10[4] = *(a1 + 32);
  v11 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v10];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = sub_195A26CAC;
  v8[3] = &unk_1E743F2A0;
  v6 = *(a1 + 40);
  v7 = *(a1 + 48);
  v8[4] = *(a1 + 32);
  v9 = v7;
  [v5 decryptOffGridMessage:v6 completion:v8];
}

void sub_195A26BA0(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A26C90;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A26CAC(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1 + 40);
  if (v10)
  {
    v11 = *(*(a1 + 32) + 56);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A26DA8;
    v12[3] = &unk_1E743F228;
    v16 = v10;
    v13 = v7;
    v14 = v8;
    v15 = v9;
    dispatch_async(v11, v12);
  }
}

void sub_195A27210(uint64_t a1, void *a2)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A27330;
  v10[3] = &unk_1E743F138;
  v4 = *(a1 + 56);
  v10[4] = *(a1 + 32);
  v11 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v10];
  v6 = *(a1 + 40);
  v7 = *(a1 + 48);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = sub_195A2743C;
  v8[3] = &unk_1E743F2C8;
  v8[4] = *(a1 + 32);
  v9 = *(a1 + 56);
  [v5 sendEncryptedOffGridMessage:v6 options:v7 completion:v8];
}

void sub_195A27330(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A27420;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A2743C(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(*(a1 + 32) + 56);
  v15[0] = MEMORY[0x1E69E9820];
  v15[1] = 3221225472;
  v15[2] = sub_195A27540;
  v15[3] = &unk_1E743F228;
  v11 = *(a1 + 40);
  v16 = v7;
  v17 = v8;
  v18 = v9;
  v19 = v11;
  v12 = v9;
  v13 = v8;
  v14 = v7;
  dispatch_async(v10, v15);
}

void sub_195A27558(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = *(*(a1 + 32) + 48);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A27600;
  v6[3] = &unk_1E743F250;
  v4 = *(a1 + 48);
  v5 = *(a1 + 56);
  v6[4] = *(a1 + 32);
  v7 = v5;
  [v3 sendEncryptedOffGridMessage:v2 options:v4 completion:v6];
}

void sub_195A27600(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1 + 40);
  if (v10)
  {
    v11 = *(*(a1 + 32) + 56);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A276FC;
    v12[3] = &unk_1E743F228;
    v16 = v10;
    v13 = v7;
    v14 = v8;
    v15 = v9;
    dispatch_async(v11, v12);
  }
}

void sub_195A27818(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A278CC;
  v6[3] = &unk_1E743F340;
  v4 = *(a1 + 48);
  v5 = *(a1 + 32);
  v7 = v4;
  v8 = v5;
  v9 = *(a1 + 56);
  [v2 encryptOffGridMessage:v3 completion:v6];
}

void sub_195A278CC(uint64_t a1, void *a2, void *a3, uint64_t a4)
{
  v14 = *MEMORY[0x1E69E9840];
  v7 = a2;
  v8 = a3;
  v9 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  v10 = os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT);
  if (v7 && v8 && !a4)
  {
    if (v10)
    {
      v12 = 138412290;
      v13 = v8;
      _os_log_impl(&dword_1959FF000, v9, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Successfully encrypted message with identifier: %@", &v12, 0xCu);
    }

    [*(a1 + 32) setIdentifier:v8];
    [*(a1 + 40) sendEncryptedOffGridMessage:v7 options:*(a1 + 32) completion:*(a1 + 48)];
  }

  else
  {
    if (v10)
    {
      LOWORD(v12) = 0;
      _os_log_impl(&dword_1959FF000, v9, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Failed to encrypt message", &v12, 2u);
    }
  }

  v11 = *MEMORY[0x1E69E9840];
}

void sub_195A27D68(uint64_t a1, void *a2)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A27E88;
  v10[3] = &unk_1E743F138;
  v4 = *(a1 + 56);
  v10[4] = *(a1 + 32);
  v11 = v4;
  v5 = [a2 offGridMessengerCollaboratorWithErrorHandler:v10];
  v6 = *(a1 + 40);
  v7 = *(a1 + 48);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = sub_195A27F90;
  v8[3] = &unk_1E743F368;
  v8[4] = *(a1 + 32);
  v9 = *(a1 + 56);
  [v5 sendFetchRequestForHandles:v6 fromHandle:v7 completion:v8];
}

void sub_195A27E88(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    sub_195B28764();
  }

  v5 = *(a1 + 40);
  if (v5)
  {
    v6 = *(*(a1 + 32) + 56);
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = sub_195A27F78;
    v7[3] = &unk_1E743F110;
    v9 = v5;
    v8 = v3;
    dispatch_async(v6, v7);
  }
}

void sub_195A27F90(uint64_t a1, void *a2, void *a3)
{
  v5 = a2;
  v6 = a3;
  v7 = *(*(a1 + 32) + 56);
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = sub_195A2806C;
  block[3] = &unk_1E743F1D8;
  v8 = *(a1 + 40);
  v13 = v6;
  v14 = v8;
  v12 = v5;
  v9 = v6;
  v10 = v5;
  dispatch_async(v7, block);
}

void sub_195A281A8(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = *(*(a1 + 32) + 48);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A28250;
  v6[3] = &unk_1E743F390;
  v4 = *(a1 + 48);
  v5 = *(a1 + 56);
  v6[4] = *(a1 + 32);
  v7 = v5;
  [v3 sendServiceUpdateMessage:v2 options:v4 completion:v6];
}

void sub_195A28250(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1 + 40);
  if (v10)
  {
    v11 = *(*(a1 + 32) + 56);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A2834C;
    v12[3] = &unk_1E743F228;
    v16 = v10;
    v13 = v7;
    v14 = v8;
    v15 = v9;
    dispatch_async(v11, v12);
  }
}

uint64_t sub_195A285C0(void *a1)
{
  result = a1[6];
  if (result)
  {
    return (*(result + 16))(result, a1[4], 0, a1[5]);
  }

  return result;
}

void sub_195A285E4(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = *(*(a1 + 32) + 48);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = sub_195A2868C;
  v6[3] = &unk_1E743F3B8;
  v4 = *(a1 + 48);
  v5 = *(a1 + 56);
  v6[4] = *(a1 + 32);
  v7 = v5;
  [v3 sendServerMessage:v2 options:v4 completion:v6];
}

void sub_195A2868C(uint64_t a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1 + 40);
  if (v10)
  {
    v11 = *(*(a1 + 32) + 56);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = sub_195A28788;
    v12[3] = &unk_1E743F228;
    v16 = v10;
    v13 = v7;
    v14 = v8;
    v15 = v9;
    dispatch_async(v11, v12);
  }
}

void sub_195A28A7C(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((*(a1 + 32) + 64));
  v3 = objc_opt_respondsToSelector();

  if (v3)
  {
    v4 = [*(a1 + 32) delegate];
    v5 = *(a1 + 32);
    v6 = *(a1 + 40);
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = sub_195A28BC4;
    v14[3] = &unk_1E743F3E0;
    v7 = *(a1 + 48);
    v8 = *(a1 + 56);
    v9 = *(a1 + 64);
    v10 = *(a1 + 72);
    v11 = *(a1 + 48);
    *&v12 = v10;
    *(&v12 + 1) = v11;
    *&v13 = v8;
    *(&v13 + 1) = v9;
    v15 = v13;
    v16 = v12;
    v17 = *(a1 + 32);
    [v4 messenger:v5 incomingMessage:v6 context:v7 clientErrorAcknowledgementBlock:v14];
  }
}

void sub_195A28BC4(uint64_t a1, void *a2)
{
  v31 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    v5 = [*(a1 + 32) originalGUID];
    v6 = *(a1 + 40);
    v7 = *(a1 + 48);
    v8 = *(a1 + 56);
    *buf = 138413314;
    v22 = v5;
    v23 = 2112;
    v24 = v6;
    v25 = 2112;
    v26 = v7;
    v27 = 2112;
    v28 = v8;
    v29 = 2112;
    v30 = v3;
    _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Client ack block called for - %@, Internet Message %@, fromID %@, context %@, error %@", buf, 0x34u);
  }

  v9 = [*(a1 + 32) certifiedDeliveryContext];

  if (v9)
  {
    if (v3)
    {
      v10 = [v3 domain];
      v11 = [v10 isEqualToString:@"SenderKeyEncryptionControllerErrorDomain"];

      if (v11)
      {
        v12 = MEMORY[0x1E696AEC0];
        v13 = [v3 domain];
        v14 = [v12 stringWithFormat:@"paddy-%@-%ld", v13, objc_msgSend(v3, "code")];
        v15 = [*(a1 + 32) certifiedDeliveryContext];
        [v15 setFailureReasonMessage:v14];

        v16 = [*(a1 + 32) certifiedDeliveryContext];
        [v16 setFailureReason:&unk_1F0A29840];
      }
    }

    v17 = +[IDSInternalQueueController sharedInstance];
    v19[0] = MEMORY[0x1E69E9820];
    v19[1] = 3221225472;
    v19[2] = sub_195A28E14;
    v19[3] = &unk_1E743EA30;
    v19[4] = *(a1 + 64);
    v20 = *(a1 + 32);
    [v17 performBlock:v19];
  }

  v18 = *MEMORY[0x1E69E9840];
}

void sub_195A28E14(uint64_t a1)
{
  v1 = *(*(a1 + 32) + 48);
  v2 = [*(a1 + 40) certifiedDeliveryContext];
  [v1 sendCertifiedDeliveryReceipt:v2];
}

void sub_195A29078(uint64_t a1)
{
  v2 = [*(a1 + 32) delegate];
  v3 = objc_opt_respondsToSelector();

  if (v3)
  {
    v6 = [*(a1 + 32) delegate];
    v4 = *(a1 + 32);
    v5 = [*(a1 + 40) originalGUID];
    [v6 messenger:v4 receivedIncomingDeliveryReceiptForIdentifier:v5 fromURI:*(a1 + 48) context:*(a1 + 56)];
  }
}

void sub_195A29334(uint64_t a1)
{
  v2 = [*(a1 + 32) delegate];
  v3 = objc_opt_respondsToSelector();

  if (v3)
  {
    v4 = [*(a1 + 32) delegate];
    v5 = *(a1 + 32);
    v6 = *(a1 + 40);
    v10[0] = MEMORY[0x1E69E9820];
    v10[1] = 3221225472;
    v10[2] = sub_195A29448;
    v10[3] = &unk_1E743EEE8;
    v7 = *(a1 + 48);
    v11 = *(a1 + 56);
    v12 = *(a1 + 64);
    v8 = *(a1 + 48);
    v9 = *(a1 + 32);
    v13 = v8;
    v14 = v9;
    [v4 messenger:v5 incomingServiceUpdateMessage:v6 context:v7 clientAcknowledgementBlock:v10];
  }
}

void sub_195A29448(uint64_t a1)
{
  v17 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [*(a1 + 32) originalGUID];
    v4 = *(a1 + 40);
    v5 = *(a1 + 48);
    *buf = 138412802;
    v12 = v3;
    v13 = 2112;
    v14 = v4;
    v15 = 2112;
    v16 = v5;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Client ack block called for service update message - %@, fromID %@, context %@", buf, 0x20u);
  }

  v6 = [*(a1 + 32) certifiedDeliveryContext];

  if (v6)
  {
    v7 = +[IDSInternalQueueController sharedInstance];
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = sub_195A295C4;
    v9[3] = &unk_1E743EA30;
    v9[4] = *(a1 + 56);
    v10 = *(a1 + 32);
    [v7 performBlock:v9];
  }

  v8 = *MEMORY[0x1E69E9840];
}

void sub_195A295C4(uint64_t a1)
{
  v1 = *(*(a1 + 32) + 48);
  v2 = [*(a1 + 40) certifiedDeliveryContext];
  [v1 sendCertifiedDeliveryReceipt:v2];
}

void sub_195A29A80(uint64_t a1)
{
  v23 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((*(a1 + 32) + 64));
  v3 = objc_opt_respondsToSelector();

  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  v5 = os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT);
  if (v3)
  {
    if (v5)
    {
      v6 = *(a1 + 40);
      v7 = *(a1 + 48);
      *buf = 138412546;
      v20 = v6;
      v21 = 2112;
      v22 = v7;
      _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Calling out to client delegate for - %@, Stewie Message, context %@", buf, 0x16u);
    }

    v8 = [*(a1 + 32) delegate];
    v10 = *(a1 + 32);
    v9 = *(a1 + 40);
    v11 = *(a1 + 48);
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = sub_195A29C88;
    v15[3] = &unk_1E743F408;
    v16 = v9;
    v17 = *(a1 + 48);
    v18 = *(a1 + 56);
    [v8 messenger:v10 incomingMessage:v16 context:v11 clientErrorAcknowledgementBlock:v15];

    v4 = v16;
  }

  else if (v5)
  {
    v12 = [*(a1 + 48) identifier];
    v13 = *(a1 + 48);
    *buf = 138412546;
    v20 = v12;
    v21 = 2112;
    v22 = v13;
    _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - incoming iMessage Lite but delegate does not respond, dropping! {messageContext.identifier: %@, messageContext: %@}", buf, 0x16u);
  }

  v14 = *MEMORY[0x1E69E9840];
}

void sub_195A29C88(void *a1, void *a2)
{
  v17 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    v5 = a1[4];
    v6 = [v5 senderURI];
    v7 = a1[5];
    v9 = 138413058;
    v10 = v5;
    v11 = 2112;
    v12 = v6;
    v13 = 2112;
    v14 = v7;
    v15 = 2112;
    v16 = v3;
    _os_log_impl(&dword_1959FF000, v4, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Client ack block called for - %@, Stewie Message fromID %@, context %@, error %@", &v9, 0x2Au);
  }

  (*(a1[6] + 16))();
  v8 = *MEMORY[0x1E69E9840];
}

void sub_195A29F64(uint64_t a1)
{
  v18 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    *buf = 138412546;
    v15 = v3;
    v16 = 2112;
    v17 = v4;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Calling out to client delegate for - %@, Stewie Message summary, context %@", buf, 0x16u);
  }

  v5 = [*(a1 + 48) delegate];
  v7 = *(a1 + 40);
  v6 = *(a1 + 48);
  v8 = *(a1 + 32);
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = sub_195A2A0E4;
  v10[3] = &unk_1E743E9B8;
  v11 = v8;
  v12 = *(a1 + 40);
  v13 = *(a1 + 56);
  [v5 messenger:v6 incomingSummaryMessage:v11 context:v7 clientAcknowledgementBlock:v10];

  v9 = *MEMORY[0x1E69E9840];
}

uint64_t sub_195A2A0E4(void *a1)
{
  v11 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A5270] IDSOffGridMessenger];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = a1[4];
    v4 = a1[5];
    v7 = 138412546;
    v8 = v3;
    v9 = 2112;
    v10 = v4;
    _os_log_impl(&dword_1959FF000, v2, OS_LOG_TYPE_DEFAULT, "IDSOffGridMessenger - Client ack block called for - %@, Stewie Message summary, context %@", &v7, 0x16u);
  }

  result = (*(a1[6] + 16))();
  v6 = *MEMORY[0x1E69E9840];
  return result;
}

void IDSReportiMessageSpam(void *a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a1;
  v4 = a2;
  if (_IDSRunningInDaemon())
  {
    sub_195B28908();
  }

  v5 = +[IDSTransportLog IDSReportSpam];
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    v8 = 138412546;
    v9 = v3;
    v10 = 2112;
    v11 = v4;
    _os_log_impl(&dword_1959FF000, v5, OS_LOG_TYPE_DEFAULT, "IDSReportiMessageSpam - %@  (toURI: %@)", &v8, 0x16u);
  }

  v6 = +[IDSDaemonController sharedInstance];
  [v6 reportiMessageSpam:v3 toURI:v4];

  v7 = *MEMORY[0x1E69E9840];
}

void IDSReportiMessageUnknownSenderWithBlackholeAndJunkStatus(void *a1, void *a2, uint64_t a3, uint64_t a4, void *a5, void *a6)
{
  v32 = *MEMORY[0x1E69E9840];
  v11 = a1;
  v12 = a2;
  v13 = a5;
  v14 = a6;
  if (_IDSRunningInDaemon())
  {
    sub_195B28934();
  }

  v15 = +[IDSTransportLog IDSReportSpam];
  if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
  {
    v16 = @"NO";
    v20 = 138413570;
    v21 = v11;
    if (a3)
    {
      v17 = @"YES";
    }

    else
    {
      v17 = @"NO";
    }

    if (a4)
    {
      v16 = @"YES";
    }

    v22 = 2112;
    v23 = v12;
    v24 = 2112;
    v25 = v17;
    v26 = 2112;
    v27 = v16;
    v28 = 2112;
    v29 = v13;
    v30 = 2112;
    v31 = v14;
    _os_log_impl(&dword_1959FF000, v15, OS_LOG_TYPE_DEFAULT, "IDSReportiMessageUnknownSenderWithBlackholeAndJunkStatus - %@, %@, %@, %@, %@  (toURI: %@)", &v20, 0x3Eu);
  }

  v18 = +[IDSDaemonController sharedInstance];
  [v18 reportiMessageUnknownSender:v11 messageID:v12 isBlackholed:a3 isJunked:a4 messageServerTimestamp:v13 toURI:v14];

  v19 = *MEMORY[0x1E69E9840];
}

void IDSCheckiMessageUnknownSender(void *a1, void *a2, void *a3, void *a4)
{
  v27 = *MEMORY[0x1E69E9840];
  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  if (_IDSRunningInDaemon())
  {
    sub_195B28A0C();
  }

  v11 = +[IDSTransportLog IDSReportSpam];
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    *v24 = 138412546;
    *&v24[4] = v7;
    *&v24[12] = 2112;
    *&v24[14] = v8;
    _os_log_impl(&dword_1959FF000, v11, OS_LOG_TYPE_DEFAULT, "IDSCheckiMessageUnknownSender (toURI: %@ Count: %@)", v24, 0x16u);
  }

  v12 = v9;
  v13 = v10;
  if (_IDSRunningInDaemon())
  {
    sub_195B289E0();
  }

  v14 = MEMORY[0x19A8BBEF0](v12);
  *v24 = MEMORY[0x1E69E9820];
  *&v24[8] = 3221225472;
  *&v24[16] = sub_195A2AA10;
  v25 = &unk_1E743E850;
  v15 = v12;
  v26 = v15;
  v16 = v14;
  v17 = v13;
  v18 = v24;
  if (_IDSRunningInDaemon())
  {
    sub_195B289B4();
  }

  v19 = [[IDSDaemonResponseHandler alloc] initWithBlock:v16 queue:v17];
  v20 = sub_195A2AAA0();
  v21 = [v20 scheduleTimeoutWithResponseHandler:v19 timeoutInterval:v18 timeoutBlock:60.0];

  if (v21)
  {
    if (_IDSRunningInDaemon())
    {
      sub_195B28988();
    }

    if (qword_1EAEDBEF8 != -1)
    {
      sub_195B28960();
    }

    v22 = +[IDSDaemonController sharedInstance];
    [v22 reportiMessageSpamCheckUnknown:v7 count:v8 requestID:v21];
  }

  v23 = *MEMORY[0x1E69E9840];
}

void sub_195A2AA10(uint64_t a1)
{
  if (*(a1 + 32))
  {
    v2 = objc_alloc(MEMORY[0x1E696ABC0]);
    v3 = [v2 initWithDomain:*MEMORY[0x1E69A4CB8] code:-100 userInfo:0];
    (*(*(a1 + 32) + 16))(-1.0);
  }
}

id sub_195A2AAA0()
{
  if (qword_1EAEDBF48 != -1)
  {
    sub_195B28A38();
  }

  v1 = qword_1EAEDBF28;

  return v1;
}

uint64_t sub_195A2AAE4()
{
  qword_1EAEDBF28 = objc_alloc_init(IDSDaemonRequestTimer);

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A2AB20()
{
  v0 = [IDSReportiMessageSpamDaemonResponseListener alloc];
  v1 = sub_195A2AAA0();
  v2 = [(IDSReportiMessageSpamDaemonResponseListener *)v0 initWithRequestTimer:v1];
  v3 = qword_1EAEDBF00;
  qword_1EAEDBF00 = v2;

  v5 = +[IDSDaemonController sharedInstance];
  v4 = [v5 listener];
  [v4 addHandler:qword_1EAEDBF00];
}

void sub_195A2B9C4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A2BB84(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (([*(*(a1 + 32) + 24) containsObject:*(a1 + 40)] & 1) == 0)
  {
    v3 = *(*(a1 + 32) + 24);
    if (!v3)
    {
      v4 = [MEMORY[0x1E696AC70] weakObjectsHashTable];
      v5 = *(a1 + 32);
      v6 = *(v5 + 24);
      *(v5 + 24) = v4;

      v3 = *(*(a1 + 32) + 24);
    }

    [v3 addObject:*(a1 + 40)];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_195A2BC9C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  [*(*(a1 + 32) + 24) removeObject:*(a1 + 40)];
  if (![*(*(a1 + 32) + 24) count])
  {
    v3 = *(a1 + 32);
    v4 = *(v3 + 24);
    *(v3 + 24) = 0;
  }

  objc_autoreleasePoolPop(v2);
}

void sub_195A2BE88(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  v3 = [*(*(a1 + 32) + 24) copy];
  v4 = *(*(a1 + 40) + 8);
  v5 = *(v4 + 40);
  *(v4 + 40) = v3;

  objc_autoreleasePoolPop(v2);
}

uint64_t sub_195A2BEE4(void *a1)
{
  v16 = *MEMORY[0x1E69E9840];
  v2 = objc_autoreleasePoolPush();
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v3 = *(*(a1[6] + 8) + 40);
  v4 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v4)
  {
    v5 = *v12;
    do
    {
      for (i = 0; i != v4; ++i)
      {
        if (*v12 != v5)
        {
          objc_enumerationMutation(v3);
        }

        v7 = *(*(&v11 + 1) + 8 * i);
        v8 = objc_autoreleasePoolPush();
        (*(a1[4] + 16))();
        objc_autoreleasePoolPop(v8);
      }

      v4 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
    }

    while (v4);
  }

  objc_autoreleasePoolPop(v2);
  result = a1[5];
  if (result)
  {
    result = (*(result + 16))();
  }

  v10 = *MEMORY[0x1E69E9840];
  return result;
}

void sub_195A2C3E8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A2C400(uint64_t a1)
{
  v19 = *MEMORY[0x1E69E9840];
  if ([*(a1 + 32) isEqualToIgnoringCase:*MEMORY[0x1E69A51B8]])
  {
    v2 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v3 = [*(*(a1 + 40) + 40) allValues];
    v4 = [v3 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v4)
    {
      v5 = v4;
      v6 = *v15;
      do
      {
        v7 = 0;
        do
        {
          if (*v15 != v6)
          {
            objc_enumerationMutation(v3);
          }

          [v2 addObjectsFromArray:*(*(&v14 + 1) + 8 * v7++)];
        }

        while (v5 != v7);
        v5 = [v3 countByEnumeratingWithState:&v14 objects:v18 count:16];
      }

      while (v5);
    }

    v8 = *(*(a1 + 48) + 8);
    v9 = *(v8 + 40);
    *(v8 + 40) = v2;
  }

  else
  {
    v10 = [*(*(a1 + 40) + 40) objectForKey:*(a1 + 32)];
    v11 = *(*(a1 + 48) + 8);
    v9 = *(v11 + 40);
    *(v11 + 40) = v10;
  }

  v12 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEBUG))
  {
    sub_195B28B3C(a1);
  }

  v13 = *MEMORY[0x1E69E9840];
}

void sub_195A2C76C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A2C78C(uint64_t a1)
{
  v17 = *MEMORY[0x1E69E9840];
  v2 = [MEMORY[0x1E69A6138] registration];
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEBUG))
  {
    sub_195B28BB0(a1);
  }

  if ([*(a1 + 40) isEqualToIgnoringCase:*MEMORY[0x1E69A51B8]])
  {
    v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v12 = 0u;
    v13 = 0u;
    v14 = 0u;
    v15 = 0u;
    v4 = [*(*(a1 + 32) + 48) allValues];
    v5 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
    if (v5)
    {
      v6 = v5;
      v7 = *v13;
      do
      {
        v8 = 0;
        do
        {
          if (*v13 != v7)
          {
            objc_enumerationMutation(v4);
          }

          [v3 addObjectsFromArray:*(*(&v12 + 1) + 8 * v8++)];
        }

        while (v6 != v8);
        v6 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
      }

      while (v6);
    }
  }

  else
  {
    v3 = [*(*(a1 + 32) + 48) objectForKey:*(a1 + 40)];
  }

  v9 = *(*(a1 + 48) + 8);
  v10 = *(v9 + 40);
  *(v9 + 40) = v3;

  v11 = *MEMORY[0x1E69E9840];
}

void sub_195A2CAD4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_195A2CAEC(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v7 = [a2 objectForKey:*MEMORY[0x1E69A5650]];
  v8 = [v7 isEqualToString:*(a1 + 32)];

  if (v8)
  {
    *(*(*(a1 + 40) + 8) + 24) = a3;
    *a4 = 1;
  }
}

void sub_195A2CDA0(uint64_t a1)
{
  [*(a1 + 32) _removeAccountOnIvarQueue:*(a1 + 40)];
  v2 = [*(*(a1 + 32) + 40) objectForKey:*(a1 + 48)];
  if (!v2)
  {
    v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
    [*(*(a1 + 32) + 40) setObject:v3 forKey:*(a1 + 48)];
    v2 = v3;
  }

  v4 = v2;
  [v2 addObject:*(a1 + 40)];
}

void sub_195A2CE34(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 accountAdded:*(a1 + 32)];
  }
}

void sub_195A2D0C8(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 accountRemoved:*(a1 + 32)];
  }
}

void sub_195A2D330(void *a1)
{
  v2 = [*(a1[4] + 48) objectForKey:a1[5]];
  v3 = [v2 mutableCopy];

  if (!v3)
  {
    v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
  }

  if (([v3 containsObject:a1[6]] & 1) == 0)
  {
    [v3 addObject:a1[6]];
    [*(a1[4] + 48) setObject:v3 forKey:a1[5]];
  }
}

void sub_195A2D3D0(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 accountEnabled:*(a1 + 32) onService:*(a1 + 40)];
  }
}

void sub_195A2D638(void *a1)
{
  v2 = [*(a1[4] + 48) objectForKey:a1[5]];
  v3 = [v2 mutableCopy];

  if (!v3)
  {
    v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
  }

  if ([v3 containsObject:a1[6]])
  {
    [v3 removeObject:a1[6]];
    [*(a1[4] + 48) setObject:v3 forKey:a1[5]];
  }
}

void sub_195A2D6D8(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 accountDisabled:*(a1 + 32) onService:*(a1 + 40)];
  }
}

void sub_195A2D9E4(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 service:*(a1 + 32) restrictionReasonChanged:*(a1 + 40)];
  }
}

void sub_195A2DC24(uint64_t a1)
{
  [*(a1 + 32) _removeAccountOnIvarQueue:*(a1 + 40)];
  v2 = [*(*(a1 + 32) + 40) objectForKey:*(a1 + 48)];
  if (!v2)
  {
    v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
    [*(*(a1 + 32) + 40) setObject:v3 forKey:*(a1 + 48)];
    v2 = v3;
  }

  v4 = v2;
  [v2 addObject:*(a1 + 40)];
}

void sub_195A2DD6C(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 accountUpdated:*(a1 + 32)];
  }
}

void sub_195A2DE88(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) registrationStatusInfoChanged:*(a1 + 40)];
  }
}

void sub_195A2DFA4(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) aliasesChanged:*(a1 + 40)];
  }
}

void sub_195A2E0C0(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) vettedAliasesChanged:*(a1 + 40)];
  }
}

void sub_195A2E1DC(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) profileChanged:*(a1 + 40)];
  }
}

void sub_195A2E2F8(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) loginChanged:*(a1 + 40)];
  }
}

void sub_195A2E414(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) displayNameChanged:*(a1 + 40)];
  }
}

void sub_195A2E680(uint64_t a1)
{
  v34 = *MEMORY[0x1E69E9840];
  [*(*(a1 + 32) + 56) removeObjectForKey:*(a1 + 40)];
  v2 = [*(*(a1 + 32) + 120) objectForKey:*(a1 + 40)];
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v3 = *(a1 + 48);
  v4 = [v3 countByEnumeratingWithState:&v25 objects:v33 count:16];
  if (v4)
  {
    v5 = v4;
    v24 = *v26;
    v6 = *MEMORY[0x1E69A4C00];
    v23 = *MEMORY[0x1E69A4C58];
    v22 = v3;
    do
    {
      for (i = 0; i != v5; ++i)
      {
        if (*v26 != v24)
        {
          objc_enumerationMutation(v3);
        }

        v8 = [objc_alloc(MEMORY[0x1E695DF90]) initWithDictionary:*(*(&v25 + 1) + 8 * i)];
        v9 = [*(a1 + 32) _uniqueIDForDevice:v8];
        if ([v2 length])
        {
          v10 = [v9 isEqualToIgnoringCase:v2];
        }

        else
        {
          v11 = [v8 objectForKey:v6];
          v10 = [v11 BOOLValue];

          if (v10)
          {
            v12 = v9 == 0;
          }

          else
          {
            v12 = 1;
          }

          if (!v12)
          {
            if (*(a1 + 40))
            {
              [*(*(a1 + 32) + 120) setObject:v9 forKey:?];
              v13 = v9;

              v14 = [v8 objectForKey:v23];
              if (v14)
              {
                [*(*(a1 + 32) + 128) setObject:v13 forKey:v14];
              }

              v15 = [MEMORY[0x1E69A6138] activeID];
              if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
              {
                v16 = [*(*(a1 + 32) + 120) objectForKey:*(a1 + 40)];
                v17 = *(a1 + 40);
                *buf = 138412546;
                v30 = v16;
                v31 = 2112;
                v32 = v17;
                _os_log_impl(&dword_1959FF000, v15, OS_LOG_TYPE_DEFAULT, "Found active device in dependent devices update, updating activeDevice ID to %@ for %@", buf, 0x16u);

                v3 = v22;
              }

              v10 = 1;
              v2 = v13;
            }

            else
            {
              v10 = 1;
            }
          }
        }

        v18 = [MEMORY[0x1E696AD98] numberWithBool:{v10, v22}];
        [v8 setObject:v18 forKey:v6];

        v19 = [MEMORY[0x1E69A6138] activeID];
        if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138412546;
          v20 = @"NO";
          if (v10)
          {
            v20 = @"YES";
          }

          v30 = v9;
          v31 = 2112;
          v32 = v20;
          _os_log_impl(&dword_1959FF000, v19, OS_LOG_TYPE_DEFAULT, "Dependent devices updated, setting %@ to (isActive: %@)", buf, 0x16u);
        }

        [*(a1 + 56) addObject:v8];
      }

      v5 = [v3 countByEnumeratingWithState:&v25 objects:v33 count:16];
    }

    while (v5);
  }

  if (*(a1 + 48) && *(a1 + 40))
  {
    [*(*(a1 + 32) + 56) setObject:*(a1 + 56) forKey:?];
  }

  v21 = *MEMORY[0x1E69E9840];
}

void sub_195A2EA08(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) dependentDevicesUpdated:*(a1 + 40)];
  }
}

void sub_195A2ED50(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, uint64_t a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, uint64_t a29, uint64_t a30, uint64_t a31, uint64_t a32, char a33)
{
  _Block_object_dispose(&a33, 8);
  _Block_object_dispose((v33 - 176), 8);
  _Block_object_dispose((v33 - 128), 8);
  _Unwind_Resume(a1);
}

void sub_195A2ED88(uint64_t a1)
{
  v72 = *MEMORY[0x1E69E9840];
  if (!*(a1 + 32) || !*(a1 + 40))
  {
    goto LABEL_61;
  }

  v2 = [objc_alloc(MEMORY[0x1E695DF90]) initWithDictionary:*(a1 + 32)];
  v3 = *(*(a1 + 56) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  v5 = [*(a1 + 48) _uniqueIDForDevice:*(*(*(a1 + 56) + 8) + 40)];
  v6 = [*(*(*(a1 + 56) + 8) + 40) objectForKey:*MEMORY[0x1E69A4C58]];
  v7 = *(*(a1 + 64) + 8);
  v8 = *(v7 + 40);
  *(v7 + 40) = v6;

  v9 = objc_alloc(MEMORY[0x1E695DF70]);
  v10 = [*(*(a1 + 48) + 56) objectForKey:*(a1 + 40)];
  v11 = [v9 initWithArray:v10];

  v12 = [MEMORY[0x1E69A6138] activeID];
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    v13 = *(a1 + 40);
    *buf = 138412546;
    v69 = v13;
    v70 = 2112;
    v71 = v11;
    _os_log_impl(&dword_1959FF000, v12, OS_LOG_TYPE_DEFAULT, "Current devices for account %@: %@", buf, 0x16u);
  }

  v14 = v5;

  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  obj = v11;
  v15 = [obj countByEnumeratingWithState:&v62 objects:v67 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = 0;
    v18 = 0;
    v19 = *v63;
    v20 = *MEMORY[0x1E69A4BD0];
    do
    {
      for (i = 0; i != v16; ++i)
      {
        if (*v63 != v19)
        {
          objc_enumerationMutation(obj);
        }

        v22 = *(*(&v62 + 1) + 8 * i);
        v23 = [*(a1 + 48) _uniqueIDForDevice:v22];
        if (v17 || ![v14 isEqualToIgnoringCase:v23])
        {
          if (v18)
          {
            v18 = 1;
          }

          else
          {
            v24 = [v22 objectForKey:v20];
            v18 = [v24 BOOLValue];
          }
        }

        else
        {
          v17 = v22;
        }
      }

      v16 = [obj countByEnumeratingWithState:&v62 objects:v67 count:16];
    }

    while (v16);
  }

  else
  {
    v17 = 0;
    v18 = 0;
  }

  v25 = *(a1 + 64);
  if (*(*(v25 + 8) + 40))
  {
    v26 = v14;
    if ((v18 & 1) == 0)
    {
      v60 = 0u;
      v61 = 0u;
      v58 = 0u;
      v59 = 0u;
      v56 = [*(*(a1 + 48) + 64) objectForKey:*(*(v25 + 8) + 40)];
      v27 = [v56 countByEnumeratingWithState:&v58 objects:v66 count:16];
      if (v27)
      {
        v28 = v27;
        v29 = *v59;
        v30 = *MEMORY[0x1E69A4BD0];
        while (2)
        {
          for (j = 0; j != v28; ++j)
          {
            if (*v59 != v29)
            {
              objc_enumerationMutation(v56);
            }

            v32 = *(*(&v58 + 1) + 8 * j);
            v33 = [*(a1 + 48) _uniqueIDForDevice:v32];
            if ([v26 isEqualToString:v33])
            {
            }

            else
            {
              v34 = [v32 objectForKey:v30];
              v35 = [v34 BOOLValue];

              if (v35)
              {
                v18 = 1;
                v26 = v14;
                goto LABEL_34;
              }
            }

            v26 = v14;
          }

          v28 = [v56 countByEnumeratingWithState:&v58 objects:v66 count:16];
          if (v28)
          {
            continue;
          }

          break;
        }
      }

      v18 = 0;
LABEL_34:
    }
  }

  else
  {
    v26 = v14;
  }

  if (v17)
  {
    v36 = [MEMORY[0x1E69A6138] warning];
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
    {
      sub_195B28E90();
    }

    [obj removeObject:v17];
  }

  v37 = [*(*(a1 + 48) + 120) objectForKey:*(a1 + 40)];
  if (![v37 length])
  {
    if (v18)
    {
      v45 = [MEMORY[0x1E69A6138] activeID];
      if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v69 = v26;
        _os_log_impl(&dword_1959FF000, v45, OS_LOG_TYPE_DEFAULT, "Local device added %@, we'll trigger didSwitchActivePairedDevice callback since we already had a locally paired device", buf, 0xCu);
      }

      v46 = *(*(a1 + 72) + 8);
      v47 = v26;
      v48 = *(v46 + 40);
      *(v46 + 40) = v47;
    }

    else
    {
      if (v26)
      {
        if (*(a1 + 40))
        {
          [*(*(a1 + 48) + 120) setObject:v26 forKey:?];
          if (*(*(*(a1 + 64) + 8) + 40))
          {
            [*(*(a1 + 48) + 128) setObject:v26 forKey:?];
          }
        }
      }

      v49 = v26;

      v48 = [MEMORY[0x1E69A6138] activeID];
      if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
      {
        v50 = [*(*(a1 + 48) + 120) objectForKey:*(a1 + 40)];
        *buf = 138412290;
        v69 = v50;
        _os_log_impl(&dword_1959FF000, v48, OS_LOG_TYPE_DEFAULT, "Local device added, updating activeDevice ID to %@", buf, 0xCu);
      }

      v37 = v49;
    }

    v51 = [v26 isEqualToIgnoringCase:v37];
    v52 = *(*(*(a1 + 56) + 8) + 40);
    v44 = [MEMORY[0x1E696AD98] numberWithBool:v51];
    [v52 setObject:v44 forKey:*MEMORY[0x1E69A4C00]];
    goto LABEL_57;
  }

  v38 = [v26 isEqualToIgnoringCase:v37];
  v39 = *(*(*(a1 + 56) + 8) + 40);
  v40 = [MEMORY[0x1E696AD98] numberWithBool:v38];
  [v39 setObject:v40 forKey:*MEMORY[0x1E69A4C00]];

  if ((v38 & 1) == 0)
  {
    v41 = [MEMORY[0x1E69A6138] activeID];
    if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v69 = v26;
      v70 = 2112;
      v71 = v37;
      _os_log_impl(&dword_1959FF000, v41, OS_LOG_TYPE_DEFAULT, "Local device added %@, we'll trigger didSwitchActivePairedDevice callback since we already have an active device %@", buf, 0x16u);
    }

    v42 = *(*(a1 + 72) + 8);
    v43 = v26;
    v44 = *(v42 + 40);
    *(v42 + 40) = v43;
LABEL_57:
  }

  [*(*(a1 + 48) + 56) removeObjectForKey:*(a1 + 40)];
  [obj addObject:*(*(*(a1 + 56) + 8) + 40)];
  [*(*(a1 + 48) + 56) setObject:obj forKey:*(a1 + 40)];
  v53 = [MEMORY[0x1E69A6138] activeID];
  if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
  {
    v54 = *(a1 + 40);
    *buf = 138412290;
    v69 = v54;
    _os_log_impl(&dword_1959FF000, v53, OS_LOG_TYPE_DEFAULT, "New devices for account %@", buf, 0xCu);
  }

LABEL_61:
  v55 = *MEMORY[0x1E69E9840];
}

void sub_195A2F4B4(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) localDeviceAdded:*(a1 + 40)];
  }
}

void sub_195A2F65C(uint64_t a1)
{
  v18 = *MEMORY[0x1E69E9840];
  if (*(a1 + 32) && *(a1 + 40))
  {
    v2 = [*(*(a1 + 48) + 56) objectForKey:?];
    v3 = [v2 mutableCopy];

    if (v3)
    {
      v4 = objc_alloc_init(MEMORY[0x1E696AD50]);
      v5 = [*(a1 + 48) _uniqueIDForDevice:*(a1 + 40)];
      v13[0] = MEMORY[0x1E69E9820];
      v13[1] = 3221225472;
      v13[2] = sub_195A2F88C;
      v13[3] = &unk_1E743F580;
      v13[4] = *(a1 + 48);
      v6 = v5;
      v14 = v6;
      v7 = v4;
      v15 = v7;
      [v3 enumerateObjectsUsingBlock:v13];
      [v3 removeObjectsAtIndexes:v7];
      if (*(a1 + 32))
      {
        [*(*(a1 + 48) + 56) setObject:v3 forKey:?];
        v8 = *(a1 + 32);
      }

      else
      {
        v8 = 0;
      }

      v9 = [*(*(a1 + 48) + 120) objectForKey:v8];
      if ([v9 isEqualToIgnoringCase:v6])
      {
        v10 = [MEMORY[0x1E69A6138] activeID];
        if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138412290;
          v17 = v9;
          _os_log_impl(&dword_1959FF000, v10, OS_LOG_TYPE_DEFAULT, "Active device was removed, clearing active uniqueID %@", buf, 0xCu);
        }

        [*(*(a1 + 48) + 120) removeObjectForKey:*(a1 + 32)];
        v11 = [*(a1 + 40) objectForKey:*MEMORY[0x1E69A4C58]];
        if (v11)
        {
          [*(*(a1 + 48) + 128) removeObjectForKey:v11];
        }
      }
    }
  }

  v12 = *MEMORY[0x1E69E9840];
}

void sub_195A2F88C(id *a1, uint64_t a2, uint64_t a3)
{
  v5 = [a1[4] _uniqueIDForDevice:a2];
  if ([a1[5] isEqualToIgnoringCase:?])
  {
    [a1[6] addIndex:a3];
  }
}

void sub_195A2F8FC(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 account:*(a1 + 32) localDeviceRemoved:*(a1 + 40)];
  }
}

void sub_195A2FAFC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Block_object_dispose((v11 - 112), 8);
  _Unwind_Resume(a1);
}

void sub_195A2FB20(uint64_t a1)
{
  v114 = *MEMORY[0x1E69E9840];
  if (!*(a1 + 32) || !*(a1 + 40))
  {
    goto LABEL_98;
  }

  v2 = [objc_alloc(MEMORY[0x1E695DF90]) initWithDictionary:*(a1 + 32)];
  v3 = *(*(a1 + 56) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  v5 = [*(a1 + 48) _uniqueIDForDevice:*(*(*(a1 + 56) + 8) + 40)];
  v6 = [*(*(a1 + 48) + 64) objectForKey:*(a1 + 40)];
  v7 = [v6 mutableCopy];
  v8 = v7;
  if (v7)
  {
    v9 = v7;
  }

  else
  {
    v9 = objc_alloc_init(MEMORY[0x1E695DF70]);
  }

  v10 = v9;

  v11 = [v10 count];
  v12 = MEMORY[0x1E69A4BD0];
  v13 = v11 - 1;
  v84 = v10;
  if (v11 - 1 < 0)
  {
    goto LABEL_18;
  }

  LOBYTE(v14) = 0;
  v15 = *MEMORY[0x1E69A4BD0];
  while (1)
  {
    v16 = [v10 objectAtIndex:v13];
    v17 = [*(a1 + 48) _uniqueIDForDevice:v16];
    v18 = [v5 isEqualToString:v17];

    if (v18)
    {
      [v10 removeObjectAtIndex:v13];
      goto LABEL_14;
    }

    if ((v14 & 1) == 0)
    {
      break;
    }

    v14 = 1;
    if (v13 <= 0)
    {
      goto LABEL_39;
    }

LABEL_15:
    --v13;
  }

  v19 = [v16 objectForKey:v15];
  LOBYTE(v14) = [v19 BOOLValue];

LABEL_14:
  if (v13 >= 1)
  {
    goto LABEL_15;
  }

  if (v14)
  {
    v14 = 1;
    goto LABEL_39;
  }

LABEL_18:
  v103 = 0u;
  v104 = 0u;
  v101 = 0u;
  v102 = 0u;
  v20 = [*(*(a1 + 48) + 48) objectForKey:*(a1 + 40)];
  v81 = [v20 countByEnumeratingWithState:&v101 objects:v113 count:16];
  if (v81)
  {
    v21 = *v102;
    v22 = *v12;
    v83 = v20;
    v80 = *v102;
    do
    {
      v23 = 0;
      do
      {
        if (*v102 != v21)
        {
          objc_enumerationMutation(v20);
        }

        v82 = v23;
        v24 = *(*(&v101 + 1) + 8 * v23);
        v97 = 0u;
        v98 = 0u;
        v99 = 0u;
        v100 = 0u;
        v25 = [*(*(a1 + 48) + 56) objectForKey:v24];
        v26 = [v25 countByEnumeratingWithState:&v97 objects:v112 count:16];
        if (v26)
        {
          v27 = v26;
          v28 = *v98;
          while (2)
          {
            for (i = 0; i != v27; ++i)
            {
              if (*v98 != v28)
              {
                objc_enumerationMutation(v25);
              }

              v30 = *(*(&v97 + 1) + 8 * i);
              v31 = [*(a1 + 48) _uniqueIDForDevice:v30];
              if ([v31 isEqualToString:v5])
              {
              }

              else
              {
                v32 = [v30 objectForKey:v22];
                v33 = [v32 BOOLValue];

                if (v33)
                {

                  v14 = 1;
                  v20 = v83;
                  v10 = v84;
                  goto LABEL_38;
                }
              }
            }

            v27 = [v25 countByEnumeratingWithState:&v97 objects:v112 count:16];
            if (v27)
            {
              continue;
            }

            break;
          }
        }

        v23 = v82 + 1;
        v20 = v83;
        v10 = v84;
        v21 = v80;
      }

      while (v82 + 1 != v81);
      v14 = 0;
      v81 = [v83 countByEnumeratingWithState:&v101 objects:v113 count:16];
    }

    while (v81);
  }

  else
  {
    v14 = 0;
  }

LABEL_38:

LABEL_39:
  v34 = [*(*(a1 + 48) + 128) objectForKey:*(a1 + 40)];
  v35 = v34;
  if (*(a1 + 72) != 1)
  {
    if ([(__CFString *)v34 isEqualToIgnoringCase:v5])
    {
      [*(*(a1 + 48) + 128) removeObjectForKey:*(a1 + 40)];
      v87 = 0u;
      v88 = 0u;
      v85 = 0u;
      v86 = 0u;
      v45 = [*(*(a1 + 48) + 48) objectForKey:*(a1 + 40)];
      v46 = [v45 countByEnumeratingWithState:&v85 objects:v105 count:16];
      if (v46)
      {
        v47 = v46;
        v48 = *v86;
        do
        {
          for (j = 0; j != v47; ++j)
          {
            if (*v86 != v48)
            {
              objc_enumerationMutation(v45);
            }

            [*(*(a1 + 48) + 120) removeObjectForKey:*(*(&v85 + 1) + 8 * j)];
          }

          v47 = [v45 countByEnumeratingWithState:&v85 objects:v105 count:16];
        }

        while (v47);
      }

      v10 = v84;
    }

    goto LABEL_97;
  }

  v36 = *(a1 + 73);
  v37 = [(__CFString *)v34 length];
  if (v36 != 1)
  {
    v10 = v84;
    if (v37)
    {
      v50 = [v5 isEqualToIgnoringCase:v35];
      v51 = *MEMORY[0x1E69A4C00];
    }

    else
    {
      v51 = *MEMORY[0x1E69A4C00];
      v56 = [*(*(*(a1 + 56) + 8) + 40) objectForKey:*MEMORY[0x1E69A4C00]];
      v50 = [v56 BOOLValue];

      if (v50)
      {
        v57 = v5 == 0;
      }

      else
      {
        v57 = 1;
      }

      if (!v57)
      {
        if (*(a1 + 40))
        {
          [*(*(a1 + 48) + 128) setObject:v5 forKey:?];
          v91 = 0u;
          v92 = 0u;
          v89 = 0u;
          v90 = 0u;
          v58 = [*(*(a1 + 48) + 48) objectForKey:*(a1 + 40)];
          v59 = [v58 countByEnumeratingWithState:&v89 objects:v106 count:16];
          if (v59)
          {
            v60 = v59;
            v61 = *v90;
            do
            {
              for (k = 0; k != v60; ++k)
              {
                if (*v90 != v61)
                {
                  objc_enumerationMutation(v58);
                }

                [*(*(a1 + 48) + 120) setObject:v5 forKey:*(*(&v89 + 1) + 8 * k)];
              }

              v60 = [v58 countByEnumeratingWithState:&v89 objects:v106 count:16];
            }

            while (v60);
          }

          v63 = v5;
          v64 = [MEMORY[0x1E69A6138] activeID];
          if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
          {
            v65 = [*(*(a1 + 48) + 128) objectForKey:*(a1 + 40)];
            v66 = *(a1 + 40);
            *buf = 138412546;
            v109 = v65;
            v110 = 2112;
            v111 = v66;
            _os_log_impl(&dword_1959FF000, v64, OS_LOG_TYPE_DEFAULT, "Found active device in tinker device update, updating activeDevice ID to %@ for %@", buf, 0x16u);
          }

          v50 = 1;
          v35 = v63;
          v10 = v84;
        }

        else
        {
          v50 = 1;
        }
      }
    }

    v76 = *(*(*(a1 + 56) + 8) + 40);
    v77 = [MEMORY[0x1E696AD98] numberWithBool:v50];
    [v76 setObject:v77 forKey:v51];

    v44 = [MEMORY[0x1E69A6138] activeID];
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      v78 = @"NO";
      if (v50)
      {
        v78 = @"YES";
      }

      *buf = 138412546;
      v109 = v5;
      v110 = 2112;
      v111 = v78;
      _os_log_impl(&dword_1959FF000, v44, OS_LOG_TYPE_DEFAULT, "Tinker device updated, setting %@ to (isActive: %@)", buf, 0x16u);
    }

    goto LABEL_95;
  }

  v10 = v84;
  if (!v37)
  {
    if (v14)
    {
      v52 = [MEMORY[0x1E69A6138] activeID];
      if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v109 = v5;
        _os_log_impl(&dword_1959FF000, v52, OS_LOG_TYPE_DEFAULT, "Tinker device added %@, we'll trigger didSwitchActivePairedDevice callback since we already had a locally paired device", buf, 0xCu);
      }

      v53 = *(*(a1 + 64) + 8);
      v54 = v5;
      v55 = *(v53 + 40);
      *(v53 + 40) = v54;
      v10 = v84;
    }

    else
    {
      if (v5 && *(a1 + 40))
      {
        [*(*(a1 + 48) + 128) setObject:v5 forKey:?];
        v95 = 0u;
        v96 = 0u;
        v93 = 0u;
        v94 = 0u;
        v67 = [*(*(a1 + 48) + 48) objectForKey:*(a1 + 40)];
        v68 = [v67 countByEnumeratingWithState:&v93 objects:v107 count:16];
        if (v68)
        {
          v69 = v68;
          v70 = *v94;
          do
          {
            for (m = 0; m != v69; ++m)
            {
              if (*v94 != v70)
              {
                objc_enumerationMutation(v67);
              }

              [*(*(a1 + 48) + 120) setObject:v5 forKey:*(*(&v93 + 1) + 8 * m)];
            }

            v69 = [v67 countByEnumeratingWithState:&v93 objects:v107 count:16];
          }

          while (v69);
        }

        v10 = v84;
      }

      v72 = v5;

      v55 = [MEMORY[0x1E69A6138] activeID];
      if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
      {
        v73 = [*(*(a1 + 48) + 128) objectForKey:*(a1 + 40)];
        *buf = 138412290;
        v109 = v73;
        _os_log_impl(&dword_1959FF000, v55, OS_LOG_TYPE_DEFAULT, "Tinker device added, updating activeDevice ID to %@", buf, 0xCu);
      }

      v35 = v72;
    }

    v74 = [v5 isEqualToIgnoringCase:v35];
    v75 = *(*(*(a1 + 56) + 8) + 40);
    v44 = [MEMORY[0x1E696AD98] numberWithBool:v74];
    [v75 setObject:v44 forKey:*MEMORY[0x1E69A4C00]];
LABEL_95:

    goto LABEL_96;
  }

  v38 = [v5 isEqualToIgnoringCase:v35];
  v39 = *(*(*(a1 + 56) + 8) + 40);
  v40 = [MEMORY[0x1E696AD98] numberWithBool:v38];
  [v39 setObject:v40 forKey:*MEMORY[0x1E69A4C00]];

  if ((v38 & 1) == 0)
  {
    v41 = [MEMORY[0x1E69A6138] activeID];
    if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v109 = v5;
      v110 = 2112;
      v111 = v35;
      _os_log_impl(&dword_1959FF000, v41, OS_LOG_TYPE_DEFAULT, "Tinker device added %@, we'll trigger didSwitchActivePairedDevice callback since we already have an active device %@", buf, 0x16u);
    }

    v42 = *(*(a1 + 64) + 8);
    v43 = v5;
    v44 = *(v42 + 40);
    *(v42 + 40) = v43;
    v10 = v84;
    goto LABEL_95;
  }

LABEL_96:
  [v10 addObject:*(*(*(a1 + 56) + 8) + 40)];
LABEL_97:
  [*(*(a1 + 48) + 64) setObject:v10 forKey:*(a1 + 40)];

LABEL_98:
  v79 = *MEMORY[0x1E69E9840];
}

void sub_195A306FC(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 service:*(a1 + 32) tinkerDeviceAdded:*(a1 + 40)];
  }
}

void sub_195A308D0(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 service:*(a1 + 32) tinkerDeviceRemoved:*(a1 + 40)];
  }
}

void sub_195A30A94(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 service:*(a1 + 32) tinkerDeviceUpdated:*(a1 + 40)];
  }
}

void sub_195A30D64(uint64_t a1, void *a2)
{
  v3 = a2;
  if (objc_opt_respondsToSelector())
  {
    [v3 service:*(a1 + 32) familyInfoUpdated:*(a1 + 40)];
  }
}

void sub_195A30EF0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_195A30F08(void *a1)
{
  v2 = [*(a1[4] + 72) objectForKey:a1[5]];
  v3 = *(a1[6] + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  return MEMORY[0x1EEE66BB8]();
}

void sub_195A31040(uint64_t a1)
{
  v37 = *MEMORY[0x1E69E9840];
  context = objc_autoreleasePoolPush();
  v1 = [*(*(a1 + 32) + 72) objectForKey:*(a1 + 40)];
  v2 = [v1 objectForKey:*MEMORY[0x1E69A4CB0]];

  v3 = objc_alloc_init(MEMORY[0x1E695DF90]);
  v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  obj = v2;
  v5 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v33;
    v8 = *MEMORY[0x1E69A4C98];
    v9 = *MEMORY[0x1E69A4CA0];
    do
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v33 != v7)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v32 + 1) + 8 * i);
        v12 = [v11 objectForKey:v8];
        v13 = [v11 objectForKey:v9];
        [v3 setObject:v12 forKey:v13];

        v14 = [v11 objectForKey:v8];
        if ([v14 _appearsToBeEmail])
        {
          v15 = IDSCopyIDForEmailAddress();
        }

        else
        {
          v15 = IDSCopyIDForPhoneNumber();
        }

        v16 = v15;

        [v4 addObject:v16];
      }

      v6 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v6);
  }

  v17 = +[IDSIDQueryController sharedInstance];
  v18 = *(a1 + 40);
  v19 = *(a1 + 48);
  v26[0] = MEMORY[0x1E69E9820];
  v26[1] = 3221225472;
  v26[2] = sub_195A31328;
  v26[3] = &unk_1E743F5F8;
  v27 = v18;
  v28 = *(a1 + 48);
  v29 = v3;
  v30 = obj;
  v31 = *(a1 + 56);
  v20 = obj;
  v21 = v3;
  [v17 refreshIDStatusForDestinations:v4 service:v18 listenerID:v19 queue:MEMORY[0x1E69E96A0] completionBlock:v26];

  objc_autoreleasePoolPop(context);
  v22 = *MEMORY[0x1E69E9840];
}

void sub_195A31328(uint64_t a1, void *a2)
{
  v29 = *MEMORY[0x1E69E9840];
  v2 = a2;
  v3 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v25 = 0u;
  v4 = v2;
  v5 = [v4 countByEnumeratingWithState:&v22 objects:v28 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v23;
    do
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v23 != v7)
        {
          objc_enumerationMutation(v4);
        }

        v9 = *(*(&v22 + 1) + 8 * i);
        v10 = [v4 objectForKeyedSubscript:v9];
        v11 = [v10 isEqualToNumber:&unk_1F0A29858];

        if (v11)
        {
          [v3 addObject:v9];
        }

        else
        {
          v12 = [MEMORY[0x1E69A6138] registration];
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138412290;
            v27 = v9;
            _os_log_impl(&dword_1959FF000, v12, OS_LOG_TYPE_DEFAULT, "ID status not valid for %@", buf, 0xCu);
          }
        }
      }

      v6 = [v4 countByEnumeratingWithState:&v22 objects:v28 count:16];
    }

    while (v6);
  }

  v13 = +[IDSIDQueryController sharedInstance];
  v14 = *(a1 + 32);
  v15 = *(a1 + 40);
  v18[0] = MEMORY[0x1E69E9820];
  v18[1] = 3221225472;
  v18[2] = sub_195A315A0;
  v18[3] = &unk_1E743F5D0;
  v19 = *(a1 + 48);
  v20 = *(a1 + 56);
  v21 = *(a1 + 64);
  [v13 currentRemoteDevicesForDestinations:v3 service:v14 listenerID:v15 queue:MEMORY[0x1E69E96A0] completionBlock:v18];

  v16 = *MEMORY[0x1E69E9840];
}