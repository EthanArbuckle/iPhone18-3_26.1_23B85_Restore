@interface CAMViewfinderViewController
+ (int64_t)_pressTypeForCaptureButton:(int64_t)a3;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_advancedPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_desiredAdvancedPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_essentialPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)currentPhotoFormat;
- ($76EADD4ED24426C67044446678BAA581)_dynamicShutterSettingsForGraphConfiguration:(SEL)a3;
- ($E5C720D6BB068A42F0C2CD001350366C)_dynamicShutterPrivateSettingsForGraphConfiguration:(id)a3;
- ($F24F406B2B787EFB06265DBA3D28CBD5)_nightModeDurationMapping;
- (BOOL)_allowsPhysicalCaptureInteraction;
- (BOOL)_arePhotoFormatConflictsSupportedForMode:(int64_t)a3 device:(int64_t)a4;
- (BOOL)_autoHideHomeIndicatorForOrientation:(int64_t)a3;
- (BOOL)_canPerformModeChangeForSwipeAtLocation:(CGPoint)a3;
- (BOOL)_canShowIndicatorDuringTrueVideoRecordingForType:(unint64_t)a3 withGraphConfiguration:(id)a4;
- (BOOL)_captureStillImageWithCurrentSettings;
- (BOOL)_captureStillImageWithRequest:(id)a3 error:(id *)a4;
- (BOOL)_depthEffectEnabledFromSuggestion;
- (BOOL)_hasBeenPromptedForICPLToday;
- (BOOL)_hasSignificantAmountOfRecordingTimeForCurrentConfiguration;
- (BOOL)_isActiveZooming;
- (BOOL)_isCTMVideoSupportedForGraphConfiguration:(id)a3;
- (BOOL)_isCapturing;
- (BOOL)_isCapturingTimelapse;
- (BOOL)_isControlDrawerShowingPersistentControl;
- (BOOL)_isDepthEffectApertureSupportedForGraphConfiguration:(id)a3;
- (BOOL)_isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:(int64_t)a3;
- (BOOL)_isDepthSuggestionAllowedForCurrentConfigurationIsBurst:(BOOL)a3;
- (BOOL)_isDisplayingDocumentScanningButton;
- (BOOL)_isDisplayingMRCButton;
- (BOOL)_isExpectedNightModeDurationCancelable;
- (BOOL)_isFlashCompromisedForDevicePosition:(int64_t)a3;
- (BOOL)_isFlashOrTorchSupportedForGraphConfiguration:(id)a3;
- (BOOL)_isFlashUnavailableForMode:(int64_t)a3;
- (BOOL)_isFlipButtonSupportedForMode:(int64_t)a3;
- (BOOL)_isFrontRearSimultaneousVideoActiveForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (BOOL)_isFrontRearSimultaneousVideoSupportedForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (BOOL)_isHDRSupportedForGraphConfiguration:(id)a3;
- (BOOL)_isLivePhotoSupportedForGraphConfiguration:(id)a3;
- (BOOL)_isLivePhotoSupportedForMode:(int64_t)a3 device:(int64_t)a4;
- (BOOL)_isMenuButtonConflictingWithView:(id)a3;
- (BOOL)_isNightModeCaptureCanceling;
- (BOOL)_isNightModePortraitAvailableForMode:(int64_t)a3 device:(int64_t)a4 zoomFactor:(double)a5;
- (BOOL)_isNightModeUpdatingDeferred;
- (BOOL)_isPinchToZoomAllowed;
- (BOOL)_isPrimaryDisplayAssetForCoordinationInfo:(id)a3;
- (BOOL)_isScreenExternalDisplay;
- (BOOL)_isShowingBurstIndicatorView;
- (BOOL)_isShowingCameraRoll;
- (BOOL)_isSwipeToModeSwitchEnabled;
- (BOOL)_isVideoStabilizationIndicatorPrimary;
- (BOOL)_isZoomAllowedCurrently;
- (BOOL)_isZoomAllowedForGraphConfiguration:(id)a3;
- (BOOL)_isZooming;
- (BOOL)_modeChangeSwipeMatchesExposureBiasPanDirection;
- (BOOL)_pauseCapturingVideo;
- (BOOL)_redirectShutterEventIfNecessary:(unint64_t)a3;
- (BOOL)_resolvedFlipAspectRatioForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 devicePosition:(int64_t)a5 trueVideoEnabled:(BOOL)a6;
- (BOOL)_resolvedSmartFramingAutoRotationEnabled;
- (BOOL)_resolvedSmartFramingAutoZoomEnabled;
- (BOOL)_resumeCaptureVideo;
- (BOOL)_shouldAllowControlDrawerForGraphConfiguration:(id)a3;
- (BOOL)_shouldAllowControlDrawerToggleForGraphConfiguration:(id)a3 orientation:(int64_t)a4;
- (BOOL)_shouldAllowHapticsForCurrentState;
- (BOOL)_shouldAnimateViewfinderCloseForReason:(int64_t)a3;
- (BOOL)_shouldApplyTopBarRotationForGraphConfiguration:(id)a3;
- (BOOL)_shouldCaptureWithTimer;
- (BOOL)_shouldCreateAndEmbedControl:(int64_t)a3;
- (BOOL)_shouldDisableDepthSuggestionForNightModeForConfiguration:(id)a3;
- (BOOL)_shouldDisableEventInteractionForGraphConfiguration:(id)a3 callActive:(BOOL)a4;
- (BOOL)_shouldDisableEventInteractionForModeDisabledReasons:(id)a3;
- (BOOL)_shouldDisableModeForGraphConfiguration:(id)a3 callActive:(BOOL)a4;
- (BOOL)_shouldEmulateAggregateCameraZoomForGraphConfiguration:(id)a3;
- (BOOL)_shouldEnableApertureButton;
- (BOOL)_shouldEnableAspectRatioButton;
- (BOOL)_shouldEnableControlDrawerToggle;
- (BOOL)_shouldEnableControlStatusIndicator:(unint64_t)a3;
- (BOOL)_shouldEnableDrawerControl:(int64_t)a3;
- (BOOL)_shouldEnableExposureControlButton;
- (BOOL)_shouldEnableFilterButton;
- (BOOL)_shouldEnableFlashButton;
- (BOOL)_shouldEnableFlipButton;
- (BOOL)_shouldEnableHDRButton;
- (BOOL)_shouldEnableIntensityButton;
- (BOOL)_shouldEnableLivePhotoButton;
- (BOOL)_shouldEnableModeDial;
- (BOOL)_shouldEnableNightModeControl;
- (BOOL)_shouldEnablePhotoFormatButton;
- (BOOL)_shouldEnableProResButton;
- (BOOL)_shouldEnableRAWButton;
- (BOOL)_shouldEnableSemanticStyleControl;
- (BOOL)_shouldEnableSharedLibraryButton;
- (BOOL)_shouldEnableSmartStyleControl;
- (BOOL)_shouldEnableSmartStylesSwipeGestures;
- (BOOL)_shouldEnableSwipeToModeSwitch;
- (BOOL)_shouldEnableTextAnalysisButton;
- (BOOL)_shouldEnableTimerButton;
- (BOOL)_shouldEnableVideoConfigurationControl;
- (BOOL)_shouldEnableVideoStabilizationButton;
- (BOOL)_shouldEnableZoomControl;
- (BOOL)_shouldHideApertureButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideAspectRatioControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideBadgesForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideControlStatusIndicatorsForCommonStateForType:(unint64_t)a3;
- (BOOL)_shouldHideElapsedTimeViewForGraphConfiguration:(id)a3 orientation:(int64_t)a4;
- (BOOL)_shouldHideFilterButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideFilterNameBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideFlashButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideFlipButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideFocusAndExposureLockBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideGridViewForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideHDRButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideImageWellForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideIntensityButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideLightingControlBadgeForGraphConfiguration:(id)a3 orientation:(int64_t)a4;
- (BOOL)_shouldHideLightingControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideLightingNameBadgeForGraphConfiguration:(id)a3 orientation:(int64_t)a4;
- (BOOL)_shouldHideLightingNameBadgesForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideLivePhotoBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideLivePhotoButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)a3 isCapturingBurst:(BOOL)a4;
- (BOOL)_shouldHidePanoramaViewForGraphConfiguration:(id)a3;
- (BOOL)_shouldHidePortraitModeInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideQRCodeInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideShutterButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideStillDuringVideoButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideTimerButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideTopBarForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideUtilityBarForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideZoomControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldHideZoomSliderForGraphConfiguration:(id)a3 ignoreExpiredVisibilityTimer:(BOOL)a4;
- (BOOL)_shouldMonitorDeviceMotionForGraphConfiguration:(id)a3;
- (BOOL)_shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4;
- (BOOL)_shouldProcessMachineReadableMetadata;
- (BOOL)_shouldProcessTextRegions;
- (BOOL)_shouldReportUserInitiationTimeForCurrentSettings;
- (BOOL)_shouldRequestDepthDeliveryForBurst:(BOOL)a3;
- (BOOL)_shouldResetZoomForChangeFromMode:(int64_t)a3 toMode:(int64_t)a4;
- (BOOL)_shouldRotateTopBarForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowAutoMacroButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowChromeExternalStorageIconForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowCleanLensesInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowDepthSuggestionButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowDescriptionOverlayViewForGraphConfiguration:(id)a3 viewClass:(Class *)a4;
- (BOOL)_shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowDocumentScanningButton;
- (BOOL)_shouldShowDrawerControlOfType:(int64_t)a3 forGraphConfiguration:(id)a4;
- (BOOL)_shouldShowExposureButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowFlashCompromisedInstructionsForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowFlipAspectRatioButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowFreeResourcesInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowFrontPIPButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowImageAnalysisButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowImageAnalysisInstructionLabel;
- (BOOL)_shouldShowIndicatorOfType:(unint64_t)a3 forGraphConfiguration:(id)a4;
- (BOOL)_shouldShowNightModeControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowPhotoFormatButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowPhotoVideoModeSwitchForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowPreviewOverlayButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowProResButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowRAWButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSemanticStyleControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSharedLibraryBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSharedLibraryButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSharedLibraryIndicatorForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowShutterButtonDisabled;
- (BOOL)_shouldShowSmartFramingAutoRotationForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSmartFramingAutoZoomForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSmartStyleControlForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSmartStyleIndicatorForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSpatialBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowSpatialCaptureInstructionsForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowTextBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowUnsupportedExternalStorageFormat;
- (BOOL)_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:(int64_t)a3;
- (BOOL)_shouldShowVideoConfigurationIndicatorForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowVideoStabilizationBadgeForGraphConfiguration:(id)a3;
- (BOOL)_shouldShowVideoStabilizationButtonForGraphConfiguration:(id)a3;
- (BOOL)_shouldSuspendCaptureSessionForGraphConfiguration:(id)a3 callActive:(BOOL)a4;
- (BOOL)_shouldSuspendCaptureSessionForModeDisabledReasons:(id)a3;
- (BOOL)_shouldUpdateCaptureOrientation;
- (BOOL)_shouldUseBurstForCaptureTimer;
- (BOOL)_shouldUseFiltersForGraphConfiguration:(id)a3;
- (BOOL)_shouldUsePhotoModePortraitEffect;
- (BOOL)_shouldUsePhotoModePortraitEffectIsBurst:(BOOL)a3;
- (BOOL)_shouldUseTransientLightingBadgesForGraphConfiguration:(id)a3;
- (BOOL)_shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice;
- (BOOL)_shouldUseZoomButtonForCameraToggleForGraphConfiguration:(id)a3;
- (BOOL)_shouldUseZoomControlInsteadOfSlider;
- (BOOL)_smartFramingAutoRotationMonitoringEnabled;
- (BOOL)_smartStyleChangeSwipeMatchesExposureBiasPanDirection;
- (BOOL)_startCapturingPanoramaWithRequest:(id)a3;
- (BOOL)_startCapturingVideoWithRequest:(id)a3;
- (BOOL)_startTimelapse;
- (BOOL)_stillDuringVideoButtonPressed:(id)a3;
- (BOOL)_stillDuringVideoButtonReleased:(id)a3;
- (BOOL)_stopCapturingPanorama;
- (BOOL)_stopCapturingVideo;
- (BOOL)_stopTimelapse;
- (BOOL)_takePhotoForExternalClientWithCountdown:(unint64_t)a3 internalTimerOverridesCountdown:(BOOL)a4;
- (BOOL)_trueVideoIsActive;
- (BOOL)_trueVideoIsCapturing;
- (BOOL)_trueVideoIsTransitioningFromCapture;
- (BOOL)_trueVideoIsTransitioningToCapture;
- (BOOL)_trueVideoIsTransitioningToCapturingOrCapturing;
- (BOOL)_updateDuetSystemConstraintsIfNecessary;
- (BOOL)_urgentlyNeedsToPurgeDiskSpace;
- (BOOL)_useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:(id)a3;
- (BOOL)_wantsCaptureAnimationForRequest:(id)a3;
- (BOOL)_wantsExternalStorageOutputEnabled;
- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 desiredProResVideoMode:(int64_t)a5;
- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)a3 videoEncodingBehavior:(int64_t)a4;
- (BOOL)_wantsHDRControlsVisible;
- (BOOL)_wantsHDRControlsVisibleForGraphConfiguration:(id)a3;
- (BOOL)_wantsLightingControlForGraphConfiguration:(id)a3;
- (BOOL)_wantsLightingControlForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (BOOL)_wantsZoomControlForGraphConfiguration:(id)a3;
- (BOOL)_wantsZoomSliderForGraphConfiguration:(id)a3;
- (BOOL)_zoomControlReconfiguresGraphConfiguration:(id)a3;
- (BOOL)cameraRollControllerShouldRequestUnlock:(id)a3;
- (BOOL)canToggleBetweenZoomFactorsForZoomControl:(id)a3;
- (BOOL)captureControllerShouldPlayAudioCue:(id)a3;
- (BOOL)capturePhoto;
- (BOOL)dynamicShutterControlCanStartOnTouchDown:(id)a3;
- (BOOL)dynamicShutterControlShouldBeginGesture:(id)a3;
- (BOOL)fullscreenViewfinderCanUpdatePreviewSemanticStyles:(id)a3;
- (BOOL)gestureRecognizer:(id)a3 shouldReceiveTouch:(id)a4;
- (BOOL)gestureRecognizer:(id)a3 shouldRecognizeSimultaneouslyWithGestureRecognizer:(id)a4;
- (BOOL)gestureRecognizer:(id)a3 shouldRequireFailureOfGestureRecognizer:(id)a4;
- (BOOL)gestureRecognizerShouldBegin:(id)a3;
- (BOOL)handleURLIfNeeded:(id)a3;
- (BOOL)imageAnalysisInteraction:(id)a3 shouldBeginAtPoint:(CGPoint)a4 forAnalysisType:(unint64_t)a5;
- (BOOL)isCapturingLivePhoto;
- (BOOL)isCapturingPhoto;
- (BOOL)isDockAccessoryConnectedAndTracking;
- (BOOL)isDockKitTrackingLocked;
- (BOOL)isInCameraRollView;
- (BOOL)isRecording;
- (BOOL)navigateToViewfinderView;
- (BOOL)prefersHomeIndicatorAutoHidden;
- (BOOL)prefersInterfaceOrientationLocked;
- (BOOL)prefersStatusBarHidden;
- (BOOL)pressShutterButtonWithTouchUpDelay:(double)a3 shutterBehavior:(int64_t)a4;
- (BOOL)previewViewControllerShouldRestrictExposureBiasPanToTouchesNearSlider:(id)a3;
- (BOOL)remoteShutterBeginBurstCapture:(id)a3;
- (BOOL)remoteShutterEndBurstCapture:(id)a3;
- (BOOL)remoteShutterPauseCapture:(id)a3;
- (BOOL)remoteShutterResumeCapture:(id)a3;
- (BOOL)remoteShutterStartCapture:(id)a3;
- (BOOL)remoteShutterStopCapture:(id)a3;
- (BOOL)shouldEnableFlashMenuCommand;
- (BOOL)shouldEnableFlipCameraMenuCommand;
- (BOOL)shouldEnableLivePhotoMenuCommand;
- (BOOL)shouldEnableTimerMenuCommand;
- (BOOL)shouldHideCleanLensInstructionLabel;
- (BOOL)shouldHideElapsedTimeView;
- (BOOL)shouldHideFilterNameBadge;
- (BOOL)shouldHideFlashButton;
- (BOOL)shouldHideFlipButton;
- (BOOL)shouldHideHDRButton;
- (BOOL)shouldHideLightingControl;
- (BOOL)shouldHideLightingNameBadgeForOrientation:(int64_t)a3;
- (BOOL)shouldHideLivePhotoButton;
- (BOOL)shouldHidePortraitModeInstructionLabel;
- (BOOL)shouldHideQRCodeInstructionLabel;
- (BOOL)shouldHideTimerButton;
- (BOOL)shouldHideTopBar;
- (BOOL)shouldShiftPreviewForUtilityBar;
- (BOOL)shouldShowInstructionLabel;
- (BOOL)shouldSwitchToVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4;
- (BOOL)startRecording;
- (BOOL)stopRecording;
- (BOOL)takeStillDuringVideoWithTouchUpDelay:(double)a3;
- (BOOL)videoConfigurationStatusIndicatorShouldRespondToTap:(id)a3;
- (BOOL)zoomControlShouldSnapDialToSwitchOverZoomFactors:(id)a3;
- (CAMCameraConfigurationDelegate)configurationDelegate;
- (CAMCaptureDelegate)captureDelegate;
- (CAMControlDrawer)_controlDrawer;
- (CAMElapsedTimeView)_targetElapsedTimeView;
- (CAMFullscreenViewfinder)_fullscreenViewfinder;
- (CAMPortraitModeInstructionLabel)_targetPortraitModeInstructionLabel;
- (CAMQRCodeInstructionLabel)_targetQRCodeInstructionLabel;
- (CAMVideoConfigurationStatusIndicator)_targetVideoConfigurationStatusIndicator;
- (CAMViewfinderPresentationDelegate)presentationDelegate;
- (CAMViewfinderReviewButtonSource)reviewButtonSource;
- (CAMViewfinderTransitionable)_viewfinderTransitionable;
- (CAMViewfinderViewController)initWithCaptureController:(id)a3 captureConfiguration:(id)a4 conflictingControlConfiguration:(id)a5 locationController:(id)a6 motionController:(id)a7 timelapseController:(id)a8 keepAliveController:(id)a9 remoteShutterController:(id)a10 powerController:(id)a11 cameraRollController:(id)a12 librarySelectionController:(id)a13 callStatusMonitor:(id)a14 storageController:(id)a15 usingEmulationMode:(int64_t)a16 initialLayoutStyle:(int64_t)a17 options:(int64_t)a18;
- (CAMViewfinderViewControllerCameraRollTestingDelegate)cameraRollControllerTestDelegate;
- (CAMViewfinderViewControllerStillImageCaptureRequestTestingDelegate)stillImageCaptureTestDelegate;
- (CAMViewfinderViewControllerUnlockDelegate)unlockDelegate;
- (CAMViewfinderViewControllerVideoCaptureRequestTestingDelegate)videoCaptureTestDelegate;
- (CGAffineTransform)customPreviewViewTransform;
- (CGPoint)prominentObjectManagerPointOfInterestInNormalizedDeviceSpace:(id)a3;
- (CGRect)_rectForModeChangeSwipeAllowedZone;
- (CGRect)chromeSidebarFrame;
- (CGRect)reviewUsingOverlayFrame;
- (CGRect)sourceRectForPopoverActionPicker:(id)a3;
- (CGSize)_desiredPreviewSizeForStillImageCapture;
- (CGSize)_portraitOrientedSizeForSize:(CGSize)a3;
- (NSArray)_smartStyles;
- (UIControl)_primaryShutterControl;
- (UIView)_captureAnimationPreviewOverlay;
- (double)_calculateVerticalOffsetFromZoomPlatterToFrame:(CGRect)a3 fromView:(id)a4;
- (double)_currentMaximumZoomFactor;
- (double)_defaultZoomFactorForGraphConfiguration:(id)a3;
- (double)_defaultZoomFactorForGraphConfiguration:(id)a3 captureOrientation:(int64_t)a4;
- (double)_exposureBiasForMode:(int64_t)a3 trueVideoEnabled:(BOOL)a4;
- (double)_minimumExecutionTimeForChangeToGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4;
- (double)_zoomFactorForSelectButtonDisplayZoomFactor:(double)a3 device:(int64_t)a4;
- (double)_zoomFactorForZoomSliderValue:(double)a3;
- (double)_zoomSliderValueForZoomFactor:(double)a3;
- (double)timeIntervalForDuration:(int64_t)a3;
- (id)_acceptableSizeMRCResultsFromResults:(id)a3;
- (id)_autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:(id)a3;
- (id)_captureEventSoundWithURL:(id)a3;
- (id)_controlTypesForGraphConfiguration:(id)a3;
- (id)_currentCaptureFiltersForBurst:(BOOL)a3;
- (id)_currentSmartStyle;
- (id)_debugEnabledDescriptionForControl:(id)a3 withReason:(id)a4;
- (id)_debugStringForApplicationDeactivationReason:(int)a3;
- (id)_debugStringForDisabledModeReasons:(id)a3;
- (id)_disabledModeReasonsForGraphConfiguration:(id)a3 callActive:(BOOL)a4;
- (id)_embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:(id)a3;
- (id)_enabledPhotoFormatsForMode:(int64_t)a3 device:(int64_t)a4;
- (id)_filteredTextResults:(id)a3;
- (id)_flashOrTorchDisabledMessageForCurrentPowerPressure;
- (id)_generateAnalyticsCaptureEventForTimelapse;
- (id)_generateAnalyticsCaptureEventWithRequest:(id)a3 burst:(BOOL)a4;
- (id)_graphConfigurationForChangeToMode:(int64_t)a3 device:(int64_t)a4 fromGraphConfiguration:(id)a5;
- (id)_headphoneInteractionCaptureSoundForCurrentCaptureMode;
- (id)_imageAnalysisButton;
- (id)_imageAnalysisInstructionLabel;
- (id)_nightModeInstructionLabel;
- (id)_originalCaptureFiltersForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (id)_panoramaCaptureRequestWithCurrentSettings;
- (id)_previewFiltersForMode:(int64_t)a3 device:(int64_t)a4 wantsPhotoModePortraitEffect:(BOOL)a5;
- (id)_primaryControlStatusIndicatorTypes;
- (id)_referenceStyleForSmartStyle:(id)a3;
- (id)_secondaryControlStatusIndicatorTypes;
- (id)_semanticStyleForCapture;
- (id)_semanticStyleForCaptureWithSupport:(unint64_t)a3;
- (id)_semanticStyleForPreview;
- (id)_semanticStyleForPreviewWithSupport:(unint64_t)a3;
- (id)_stillImageCaptureRequestForTextAnalysis;
- (id)_stillImageCaptureRequestWithCurrentSettingsAsBurst:(BOOL)a3 maximumLength:(int64_t)a4;
- (id)_supportedCaptureModes;
- (id)_targetLightingControl;
- (id)_textInteractionInsert;
- (id)_videoCaptureRequestWithCurrentSettings;
- (id)cameraRollControllerSourceAssetRegionOfInterest:(id)a3;
- (id)currentContentSize;
- (id)matchingDockKitTrackedSubjectForAnstID:(int64_t)a3;
- (id)modesForModeDial:(id)a3;
- (id)viewfinderView;
- (int64_t)_aspectRatioCropForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (int64_t)_aspectRatioForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 devicePosition:(int64_t)a5 trueVideoEnabled:(BOOL)a6;
- (int64_t)_autorotationStyleForLayoutStyle:(int64_t)a3;
- (int64_t)_availableDefaultCaptureMode;
- (int64_t)_bottomBarBackgroundStyleForMode:(int64_t)a3;
- (int64_t)_configuredDevice;
- (int64_t)_configuredMode;
- (int64_t)_currentCaptureRequestOrigin;
- (int64_t)_currentDevice;
- (int64_t)_currentDevicePosition;
- (int64_t)_currentMaxPhotoResolution;
- (int64_t)_currentMode;
- (int64_t)_currentPhotoEncodingBehavior;
- (int64_t)_currentRawFileFormatEncodingBehavior;
- (int64_t)_currentVideoChromeVideoFormat;
- (int64_t)_currentVideoConfiguration;
- (int64_t)_defaultSmartFramingFieldOfViewForOrientation:(int64_t)a3;
- (int64_t)_deviceForSelectButtonZoomDisplayZoomFactor:(double)a3;
- (int64_t)_diskSpaceAlertType;
- (int64_t)_displayedFlashModeForMode:(int64_t)a3 flashActive:(BOOL *)a4;
- (int64_t)_effectFilterTypeForMode:(int64_t)a3;
- (int64_t)_elapsedTimeViewIdleBackgroundStyle;
- (int64_t)_filterTypeForItemIndex:(int64_t)a3;
- (int64_t)_focusAndExposureLockBadgeTypeForCurrentState;
- (int64_t)_itemIndexForFilterType:(int64_t)a3;
- (int64_t)_lastCapturedFilterTypeForMode:(int64_t)a3;
- (int64_t)_lightingControlLayoutPositionForGraphConfiguration:(id)a3;
- (int64_t)_mappedVideoConfigurationForVideoConfiguration:(int64_t)a3 proResVideoMode:(int64_t)a4 outputToExternalStorage:(BOOL)a5;
- (int64_t)_maximumBurstLengthForTimer;
- (int64_t)_nextFramerateVideoConfigurationForVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4;
- (int64_t)_nextResolutionVideoConfigurationForVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4;
- (int64_t)_nightModeForMode:(int64_t)a3 captureMode:(int64_t)a4 device:(int64_t)a5 isBurst:(BOOL)a6;
- (int64_t)_persistenceOptionsForBehavior:(unint64_t)a3 allowingOptionalLocalPersistence:(BOOL)a4;
- (int64_t)_preferredControlToOpenInDrawerForMode:(int64_t)a3;
- (int64_t)_primaryInstructionLabelForGraphConfiguration:(id)a3;
- (int64_t)_resolvedColorSpaceForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 videoEncodingBehavior:(int64_t)a5 device:(int64_t)a6;
- (int64_t)_resolvedDeviceForZoomFactor:(double)a3 fromGraphConfiguration:(id)a4 toGraphConfiguration:(id)a5;
- (int64_t)_resolvedSmartFramingFieldOfViewForMode:(int64_t)a3 devicePosition:(int64_t)a4;
- (int64_t)_resolvedTorchModeForGraphConfiguration:(id)a3;
- (int64_t)_resolvedVideoStabilizationMode;
- (int64_t)_resolvedVideoStabilizationModeForVideoConfiguration:(int64_t)a3;
- (int64_t)_sanitizedLightingTypeForMode:(int64_t)a3 device:(int64_t)a4;
- (int64_t)_sanitizedVideoConfigurationForMode:(int64_t)a3 device:(int64_t)a4 allowOverrides:(BOOL)a5;
- (int64_t)_secondaryInstructionLabelForGraphConfiguration:(id)a3;
- (int64_t)_shutterButtonModeForCameraMode:(int64_t)a3 isCapturing:(BOOL)a4;
- (int64_t)_temporaryPersistenceOptionsForBehavior:(unint64_t)a3;
- (int64_t)_topBarBackgroundStyleForMode:(int64_t)a3 capturing:(BOOL)a4;
- (int64_t)_videoConfigurationForImagePickerQualityType:(int64_t)a3;
- (int64_t)_videoConfigurationFramerateForGraphConfiguration:(id)a3;
- (int64_t)_videoConfigurationResolutionForGraphConfiguration:(id)a3;
- (int64_t)_visibleSuggestionButtonForGraphConfiguration:(id)a3;
- (int64_t)_zoomControlLayoutPositionForGraphConfiguration:(id)a3;
- (int64_t)cameraRollControllerPreferredPresentationOrientation:(id)a3;
- (int64_t)expandedControlTypeForExpandingDrawerInFullscreenViewfinder:(id)a3;
- (unint64_t)_currentSemanticStyleSupport;
- (unint64_t)_fullscreenViewfinderZoomStyle;
- (unint64_t)_nextModeSwitchDirectionForLayoutStyle:(int64_t)a3;
- (unint64_t)_previewConfigurationForMode:(int64_t)a3 devicePosition:(int64_t)a4 videoThumbnailOutputEnabled:(BOOL)a5;
- (unint64_t)_previousModeSwipeDirectionForLayoutStyle:(int64_t)a3;
- (unint64_t)_reasonsToDisableShutterButton;
- (unint64_t)_shutterButtonFeedbackForCurrentConfiguration;
- (unint64_t)_supportedInterfaceOrientationsForLayoutStyle:(int64_t)a3 wantsTextAnalysis:(BOOL)a4;
- (unint64_t)preferredScreenEdgesDeferringSystemGestures;
- (unint64_t)supportedInterfaceOrientations;
- (unint64_t)zoomControl:(id)a3 accessoryButtonTapIndexInDisplayZoomFactors:(id)a4;
- (void)_acknowledgeDescriptionOverlayViewForMode:(int64_t)a3;
- (void)_advanceVideoFrameRate;
- (void)_advanceVideoResolution;
- (void)_apertureSliderDidChangeApertureValue:(id)a3;
- (void)_applyAutorotationCorrectingTransformForOrientation:(int64_t)a3;
- (void)_applySelectedEffectFilterType:(int64_t)a3;
- (void)_applyTransformsForAutorotationStyle:(int64_t)a3;
- (void)_attemptShutterPressWithBlock:(id)a3;
- (void)_attemptShutterReleaseWithBlock:(id)a3;
- (void)_availableDefaultCaptureMode;
- (void)_beginCapturingBurst;
- (void)_beginNightModeInstructionLabelCountDown;
- (void)_cancelCTMCapture;
- (void)_cancelCaptureAnimation;
- (void)_captureControllerDidOutputMRC;
- (void)_captureOrientationChanged:(id)a3;
- (void)_captureRequest:(id)a3 didCompleteVideoCaptureWithResponse:(id)a4 error:(id)a5;
- (void)_changeToGraphConfiguration:(id)a3 zoomFactor:(double)a4 fromGraphConfiguration:(id)a5;
- (void)_changeToZoomFactor:(double)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 shouldAnimate:(BOOL)a6 updateOverlay:(BOOL)a7;
- (void)_clearCurrentHeadphonesEventWithReason:(id)a3;
- (void)_clearFilterScrubberLayerContentsIfNotNeededFromCallsite:(id)a3;
- (void)_closeViewfinderForChangeFromMode:(int64_t)a3 toMode:(int64_t)a4 fromDevice:(int64_t)a5 toDevice:(int64_t)a6;
- (void)_collapseExpandedButtonsAnimated:(BOOL)a3;
- (void)_commitCTMCaptureWithType:(int64_t)a3;
- (void)_configureImageAnalysisButton;
- (void)_configureSwipeToModeSwitchGestureRecognizersDirection;
- (void)_configureZoomControlForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_createApertureButtonIfNecessary;
- (void)_createBurstIndicatorViewIfNecessary;
- (void)_createCameraCaseShutterNotifierIfNeeded;
- (void)_createChromeConfiguratorWithGraphConfiguration:(id)a3;
- (void)_createChromeViewControllerIfNeeded;
- (void)_createCleanLensesInstructionLabelIfNecessary;
- (void)_createCommonControlsIfNecessary;
- (void)_createCommonGestureRecognizersIfNecessary;
- (void)_createElapsedTimeViewIfNecessary;
- (void)_createFilterNameBadgeIfNecessary;
- (void)_createFlashButtonIfNecessary;
- (void)_createFlipButtonIfNecessary;
- (void)_createFocusAndExposureLockBadgeIfNecessary;
- (void)_createGridViewIfNecessary;
- (void)_createHDRButtonIfNecessary;
- (void)_createHeadphonesTimerSoundsIfNeeded;
- (void)_createHorizonLevelViewIfNecessary;
- (void)_createImageAnalysisButtonIfNeededForConfiguration:(id)a3;
- (void)_createImageAnalysisInstructionLabelIfNeeded;
- (void)_createIntensityButtonIfNecessary;
- (void)_createLevelViewIfNecessary;
- (void)_createLightingControlIfNecessary;
- (void)_createLightingNameBadgeIfNecessary;
- (void)_createLivePhotoBadgeIfNecessary;
- (void)_createLivePhotoButtonIfNecessary;
- (void)_createModeDialIfNecessary;
- (void)_createModeSpecificControlsForConfiguration:(id)a3;
- (void)_createOrDestroyHDRButtonIfNecessary;
- (void)_createOrDestroyHorizonLevelViewIfNecessary;
- (void)_createOrDestroyLevelViewIfNecessary;
- (void)_createOrDestroyLevelViewModelIfNecessary;
- (void)_createOrDestroySharedLibraryBadgeIfNecessary;
- (void)_createOrDestroySharedLibraryButtonIfNecessary;
- (void)_createOrDestroySharedLibraryControlsIfNecessary;
- (void)_createPanoramaControlsIfNecessary;
- (void)_createPanoramaViewControllerIfNecessary;
- (void)_createPhysicalCaptureInteractionIfNeeded;
- (void)_createPortraitApertureSliderIfNecessary;
- (void)_createPortraitIntensitySliderIfNecessary;
- (void)_createPortraitModeControlsIfNecessary;
- (void)_createPortraitModeInstructionLabelIfNecessary;
- (void)_createQRCodeInstructionLabelIfNecessary;
- (void)_createShallowDepthOfFieldBadgeIfNecessary;
- (void)_createShutterButtonIfNecessary;
- (void)_createStillDuringVideoButtonIfNecessary;
- (void)_createStillImageControlsIfNecessary;
- (void)_createSwipeToModeSwitchGestureRecognizersIfNecessary;
- (void)_createTimerButtonIfNecessary;
- (void)_createTimerIndicatorViewIfNecessary;
- (void)_createUtilityBarIfNecessary;
- (void)_createVideoConfigurationStatusIndicatorIfNecessary;
- (void)_createVideoControlsIfNecessary;
- (void)_createZoomControlIfNecessary;
- (void)_createZoomPinchGestureRecognizerIfNecessary;
- (void)_createZoomSliderIfNecessary;
- (void)_destroyGestureRecognizersRequiringStandardControls;
- (void)_destroyGridViewIfNecessary;
- (void)_destroyHDRButtonIfNecessary;
- (void)_destroyHorizonLevelViewIfNecessary;
- (void)_destroyLevelViewIfNecessary;
- (void)_deviceOrientationChanged:(id)a3;
- (void)_didChangeToGraphConfiguration:(id)a3 forDesiredConfiguration:(id)a4 requestID:(int)a5;
- (void)_didStartTimer:(unint64_t)a3;
- (void)_disableAutoSmartFramingIfSupported;
- (void)_dismissDescriptionOverlayView:(id)a3 withDuration:(double)a4 fromUserAction:(BOOL)a5;
- (void)_dismissDiskSpaceAlertViewAnimated:(BOOL)a3;
- (void)_dismissDockedMRCButtonIfNeededAnimated:(BOOL)a3;
- (void)_dismissDocumentScanningButton;
- (void)_dismissFlashOrTorchUnavailableAlertViewAnimated:(BOOL)a3;
- (void)_dismissOverlays;
- (void)_displayLensSmudgeDetected:(int64_t)a3;
- (void)_embedAllControlsWithLayoutStyle:(int64_t)a3;
- (void)_embedApertureButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedBurstIndicatorView;
- (void)_embedCleanLensesInstructionLabel;
- (void)_embedDescriptionOverlayView:(id)a3 forMode:(int64_t)a4;
- (void)_embedDisabledModeOverlayView:(id)a3;
- (void)_embedElapsedTimeViewWithLayoutStyle:(int64_t)a3;
- (void)_embedFilterNameBadge;
- (void)_embedFlashButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedFlipButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedFocusAndExposureLockBadge;
- (void)_embedGridView;
- (void)_embedHDRButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedHorizonLevelView;
- (void)_embedIntensityButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedLevelView;
- (void)_embedLightingControl;
- (void)_embedLightingNameBadge;
- (void)_embedLivePhotoBadge;
- (void)_embedLivePhotoButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedModeDial;
- (void)_embedPanoramaView;
- (void)_embedPortraitApertureSlider;
- (void)_embedPortraitIntensitySlider;
- (void)_embedPortraitModeInstructionLabel;
- (void)_embedQRCodeInstructionLabel;
- (void)_embedShallowDepthOfFieldBadge;
- (void)_embedSharedLibraryBadge;
- (void)_embedShutterButton;
- (void)_embedStillDuringVideoButton;
- (void)_embedTimerButtonWithLayoutStyle:(int64_t)a3;
- (void)_embedTimerIndicatorView;
- (void)_embedUtilityBar;
- (void)_embedVideoConfigurationStatusIndicatorWithLayoutStyle:(int64_t)a3;
- (void)_embedZoomControl;
- (void)_embedZoomSlider;
- (void)_ensureSensitiveContentHidden;
- (void)_fallbackToValidProResVideoConfigurationIfNeeded;
- (void)_forceHideBadgesAnimated:(BOOL)a3;
- (void)_handleApertureButtonTapped:(id)a3;
- (void)_handleApplicationDidBecomeActive:(id)a3;
- (void)_handleApplicationDidEnterBackground:(id)a3;
- (void)_handleApplicationDidRemoveDeactivationReason:(id)a3;
- (void)_handleApplicationWillAddDeactivationReason:(id)a3;
- (void)_handleApplicationWillEnterForeground:(id)a3;
- (void)_handleApplicationWillResignActive:(id)a3;
- (void)_handleBurstTimerFired:(id)a3;
- (void)_handleCallStatusMonitorDidChangeCallActive:(id)a3;
- (void)_handleCleanLensesInstructionLabelTapped:(id)a3;
- (void)_handleContentSizeCategoryDidChange:(id)a3;
- (void)_handleDisabledShutterTap;
- (void)_handleDocumentScanningPillPress;
- (void)_handleExposureSliderDidChangeValue:(id)a3;
- (void)_handleFlashButtonChangedFlashMode;
- (void)_handleFlashIndicator;
- (void)_handleFlashIndicatorChangedMode:(id)a3;
- (void)_handleFlashIndicatorLongPressed:(id)a3;
- (void)_handleFlipAspectRatioButtonTapped:(id)a3;
- (void)_handleFlipButtonTouchDown:(id)a3;
- (void)_handleFreeResourcesLabelTapped:(id)a3;
- (void)_handleGeneralCaptureControllerSuspension;
- (void)_handleHDRButtonChangedHDRMode;
- (void)_handleHDRIndicator;
- (void)_handleImageAnalysisButtonTapped:(id)a3;
- (void)_handleIntensityButtonTapped:(id)a3;
- (void)_handleIntensitySliderDidChangeValue:(id)a3;
- (void)_handleLivePhotoButtonChangedLivePhotoMode;
- (void)_handleLivePhotoIndicator;
- (void)_handleModeDialTouchDown:(id)a3;
- (void)_handleModeDialValueChanged:(id)a3;
- (void)_handleNightModeIndicator;
- (void)_handleNightModeSliderDidChangeValue:(id)a3;
- (void)_handlePhotoFormatPickerChangedPhotoFormat:(id)a3;
- (void)_handlePhotoFormatPickerLongPressed:(id)a3;
- (void)_handlePhotoFormatPickerTapped;
- (void)_handlePhotoVideoModeSwitchValueChanged:(id)a3;
- (void)_handlePhysicalButtonCancelled:(int64_t)a3;
- (void)_handlePhysicalButtonPressed:(int64_t)a3;
- (void)_handlePhysicalButtonReleased:(int64_t)a3;
- (void)_handlePhysicalCaptureInteractionDidChangePhase:(unint64_t)a3 forButton:(int64_t)a4 event:(id)a5;
- (void)_handlePillPressForCurrentMRCAction;
- (void)_handleProResIndicator;
- (void)_handleRAWIndicator;
- (void)_handleSceneDidEnterBackground:(id)a3;
- (void)_handleSemanticStyleControlDidChangeValue:(id)a3;
- (void)_handleSessionWasPrewarmed:(id)a3;
- (void)_handleSharedLibraryButton;
- (void)_handleSharedLibraryIndicator;
- (void)_handleShutterButtonActionWithEventTriggerDescription:(id)a3;
- (void)_handleShutterButtonCancelled:(id)a3;
- (void)_handleShutterButtonDragEnter:(id)a3;
- (void)_handleShutterButtonPressed:(id)a3;
- (void)_handleShutterButtonReleased:(id)a3 fromDragExit:(BOOL)a4;
- (void)_handleSmartStyleIntensitySliderChangedValue:(double)a3;
- (void)_handleSmartStylePickerSwipe:(id)a3;
- (void)_handleSmartStyleResetButton;
- (void)_handleSmartStyleShutterButtonPressed:(id)a3;
- (void)_handleSmartStyleShutterButtonReleased:(id)a3;
- (void)_handleTextAnalysisStillImageResponse:(id)a3 error:(id)a4 forRequest:(id)a5;
- (void)_handleTimelapseLowDiskSpaceNotification:(id)a3;
- (void)_handleTimerButtonChangedTimerDuration;
- (void)_handleTouchDownForZoomControl:(id)a3;
- (void)_handleTouchDownForZoomSlider:(id)a3;
- (void)_handleUserChangedRAWMode:(int64_t)a3;
- (void)_handleUserChangedSemanticStyle:(id)a3;
- (void)_handleUserChangedToDevice:(int64_t)a3;
- (void)_handleUserChangedToExposureSliderBias:(double)a3 updateSystemOverlayValues:(BOOL)a4;
- (void)_handleVideoStabilizationIndicator;
- (void)_handleZoomPinchGestureRecognizer:(id)a3;
- (void)_hideBurstIndicatorView;
- (void)_hideControlsForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_hideUtilityBarAnimated:(BOOL)a3;
- (void)_imageWellSetContentHidden:(BOOL)a3;
- (void)_indicateCaptureTimerProgressUsingTorch;
- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:(unint64_t)a3;
- (void)_layoutViewfinderForShowingFilterScrubber:(BOOL)a3 animated:(BOOL)a4;
- (void)_limitZoomRangeForRecordingIfNecessary;
- (void)_openViewfinderForAllModeAndDeviceChangeReasons;
- (void)_pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4;
- (void)_performCaptureAnimationWithDuration:(double)a3;
- (void)_performCaptureAnimationWithDuration:(double)a3 curve:(id)a4 color:(id)a5 fadeOut:(BOOL)a6;
- (void)_performChangeFromGraphConfiguration:(id)a3 toGraphConfiguration:(id)a4 zoomFactor:(double)a5 deferIfConfigurationInFlight:(BOOL)a6;
- (void)_performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange;
- (void)_playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable;
- (void)_populateZoomForCaptureEvent:(id)a3;
- (void)_prepareDeferredProcessingIfNeeded;
- (void)_preparePhotoOutputForExpectedPhotoResolution;
- (void)_prepareTopBarForOrientationChangeDuringConfiguration;
- (void)_presentCameraRollViewControllerAnimated:(BOOL)a3 interactive:(BOOL)a4;
- (void)_presentCameraRollViewControllerIfPossibleAnimated:(BOOL)a3 interactive:(BOOL)a4;
- (void)_presentImageWellImage:(id)a3 uuid:(id)a4 animated:(BOOL)a5;
- (void)_presentInitialImageWellImageForSession;
- (void)_previewDidStartRunning:(id)a3;
- (void)_processResults:(id)a3 completionHandler:(id)a4;
- (void)_processTextRegionResults;
- (void)_reconfigureCaptureGraphWithCurrentMode;
- (void)_remoteShutterSetZoomFactor:(double)a3;
- (void)_requestPasscodeUnlockForCameraRollController:(id)a3 forAction:(unint64_t)a4 completionBlock:(id)a5;
- (void)_requestPasscodeUnlockForDocumentScanningWithCompletionBlock:(id)a3;
- (void)_requestPasscodeUnlockWithCompletionBlock:(id)a3;
- (void)_resetDynamicAspectRatio;
- (void)_resetExposureClipping;
- (void)_resetMachineReadableMetadataAndProcessing;
- (void)_resetNightModeDurationMappingAnimated:(BOOL)a3;
- (void)_resetObjectResults;
- (void)_resetPortraitLightingToDefaultAnimated:(BOOL)a3;
- (void)_resetPortraitModeApertureValueIfNeededForGraphConfiguration:(id)a3 zoomFactor:(double)a4;
- (void)_resetSmartFramingFieldOfViewAnimated:(BOOL)a3;
- (void)_resetZoom;
- (void)_resolveAndUpdatePotentiallyConflictingControls:(BOOL)a3 animated:(BOOL)a4;
- (void)_resolvePotentiallyConflictingControlsForMode:(int64_t)a3 device:(int64_t)a4 resolvedFlashMode:(int64_t *)a5 resolvedHDRMode:(int64_t *)a6 resolvedLivePhotoMode:(int64_t *)a7 resolvedRAWMode:(int64_t *)a8 resolvedPhotoResolution:(int64_t *)a9;
- (void)_restoreZoomRangeAfterRecordingIfNecessary;
- (void)_rotateTopBarAndControlsToOrientation:(int64_t)a3 shouldAnimate:(BOOL)a4;
- (void)_setCapturingFromTimer:(BOOL)a3;
- (void)_setCurrentGraphConfiguration:(id)a3;
- (void)_setDesiredTorchMode:(int64_t)a3 animated:(BOOL)a4;
- (void)_setEffectFilterType:(int64_t)a3 forMode:(int64_t)a4;
- (void)_setExposureBias:(double)a3 forMode:(int64_t)a4;
- (void)_setExternalStorageOutputEnabled:(BOOL)a3 animated:(BOOL)a4;
- (void)_setHomeIndicatorAutoHideOrientation:(int64_t)a3;
- (void)_setInternalShutterButtonSpinning:(BOOL)a3;
- (void)_setLayoutStyle:(int64_t)a3;
- (void)_setLightingType:(int64_t)a3 forMode:(int64_t)a4;
- (void)_setOutOfDiskSpace:(BOOL)a3;
- (void)_setOverrideSmartFramingAutoRotateInLandscapeEnabled:(BOOL)a3;
- (void)_setOverrideSmartFramingAutoZoomInLandscapeEnabled:(BOOL)a3;
- (void)_setPhotoFormatConflict:(unint64_t)a3 isConflicting:(BOOL)a4;
- (void)_setPreferredControlToOpenInDrawer:(int64_t)a3 forMode:(int64_t)a4;
- (void)_setPreventingAdditionalCaptures:(BOOL)a3;
- (void)_setResolvedTimerDuration:(int64_t)a3;
- (void)_setResolvedTorchMode:(int64_t)a3 animated:(BOOL)a4;
- (void)_setShallowDepthOfFieldStatus:(int64_t)a3 stagePreviewStatus:(int64_t)a4 animated:(BOOL)a5;
- (void)_setShowingFilterScrubber:(BOOL)a3 animated:(BOOL)a4;
- (void)_setShowingPortraitApertureSlider:(BOOL)a3 animated:(BOOL)a4;
- (void)_setShowingPortraitIntensitySlider:(BOOL)a3 animated:(BOOL)a4;
- (void)_setSmartFramingAutoRotationEnabled:(BOOL)a3;
- (void)_setSmartFramingAutoZoomEnabled:(BOOL)a3;
- (void)_setSpatialModeHasVideoSelected:(BOOL)a3;
- (void)_setSwipeToModeSwitchEnabled:(BOOL)a3;
- (void)_setTimerDurationAndUpdateUI:(int64_t)a3 animated:(BOOL)a4;
- (void)_setUpTipManagerIfNeeded;
- (void)_setView:(id)a3 hidden:(BOOL)a4 delayedInTotalAnimationTime:(double)a5 normalizedFadeoutDuration:(double)a6;
- (void)_setWantsFilterScrubberVisible:(BOOL)a3 animated:(BOOL)a4;
- (void)_setWantsSmartFramingAutoRotationDefault:(BOOL)a3;
- (void)_setWantsSmartFramingAutoZoomDefault:(BOOL)a3;
- (void)_setWantsVisualTextAnalysis:(BOOL)a3 animated:(BOOL)a4;
- (void)_setupAndStartSynchronizedCaptureTimerDelegate;
- (void)_setupBurstTimerWithDelay:(double)a3;
- (void)_showBurstIndicatorView;
- (void)_showControlChangeBadgeWithUpdateHandler:(id)a3;
- (void)_showControlsForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_showDiskSpaceAlertView;
- (void)_showExternalStorageRecordingFailedAlert;
- (void)_showFlashOrTorchUnavailableAlertView;
- (void)_showFrameDropsAlert;
- (void)_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:(int64_t)a3;
- (void)_showSmartFramingAutoBadgeForSmartFramingFieldOfView:(int64_t)a3 previousSmartFramingFieldOfView:(int64_t)a4;
- (void)_showUnsupportedFormatAlert;
- (void)_snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:(id)a3;
- (void)_snapshotAndFadeDisappearingView:(id)a3 parentViewOverride:(id)a4 shouldHideView:(BOOL)a5;
- (void)_spatialModeToggledTo:(unint64_t)a3;
- (void)_startCaptureSessionIfNecessaryIfVisibleAndInterrupted;
- (void)_startCapturingBurstWithRequest:(id)a3;
- (void)_startCountdownForCaptureTimer;
- (void)_startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:(id)a3;
- (void)_startFlashingVideoStabilizationBadge;
- (void)_startOrCancelPurgeIfNecessary;
- (void)_startSynchronizedCaptureTimerDelegate;
- (void)_startTimer:(unint64_t)a3;
- (void)_startTransitioningToTrueVideoCaptureFromSourceMode:(int64_t)a3 sourceAspectRatio:(int64_t)a4 toDestinationMode:(int64_t)a5;
- (void)_stillImageCaptureRequestForTextAnalysis;
- (void)_stopCaptureTimerProgressUsingTorch;
- (void)_stopCapturingBurst;
- (void)_stopCapturingCTMVideo;
- (void)_stopCountdownForCaptureTimer;
- (void)_stopFlashingVideoStabilizationBadge;
- (void)_stopRecordingForDeactivationReason:(id)a3;
- (void)_swipedToNextCameraMode:(id)a3;
- (void)_swipedToPreviousCameraMode:(id)a3;
- (void)_synchronizedCaptureTimerDelegateFired:(id)a3;
- (void)_teardownBurstTimer;
- (void)_teardownSynchronizedCaptureTimerDelegate;
- (void)_toggleBetweenBackFacingZoomFactorsForZoomControl:(id)a3;
- (void)_toggleBetweenFrontFacingZoomFactorsForZoomControl:(id)a3;
- (void)_toggleZoomForSmartFramingFieldOfView:(int64_t)a3;
- (void)_trueVideoStartCapture;
- (void)_trueVideoStopCapture;
- (void)_unembedAndDestroyAllControls;
- (void)_unembedDisabledModeOverlayView:(id)a3;
- (void)_unembedGridView;
- (void)_unembedHorizonLevelView;
- (void)_unembedLevelView;
- (void)_updateAllControlsWithContentSize:(id)a3;
- (void)_updateAutoMacroButton;
- (void)_updateAutoMacroStatus;
- (void)_updateBadgeVisibilityAnimated:(BOOL)a3;
- (void)_updateCachedMRCResults:(id)a3;
- (void)_updateCaptureTimerIndicatorWithFaceResult:(id)a3;
- (void)_updateChromeAvailableCaptureModes;
- (void)_updateChromeClassicModeSwitching;
- (void)_updateChromeConfiguratorForCurrentGraphConfiguration:(id)a3;
- (void)_updateChromeControlsForGraphConfiguration:(id)a3;
- (void)_updateChromeFilterScrubberForGraphConfiguration:(id)a3;
- (void)_updateChromePhotoFormatsAndResolutions;
- (void)_updateChromeSharedLibraryState;
- (void)_updateChromeViewControllerVideoRecordingState;
- (void)_updateChromeViewfinderGeometryWithViewportFrame:(CGRect)a3;
- (void)_updateCleanLensesInstructionLabelForCurrentState;
- (void)_updateControlDrawerContentsVisibilityAnimated:(BOOL)a3;
- (void)_updateControlDrawerContentsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateControlStatusBarContentsVisibilityAnimated:(BOOL)a3;
- (void)_updateControlStatusBarContentsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateControlsDisabledByNightModeAnimated:(BOOL)a3;
- (void)_updateControlsForVisibleFilterScrubberAnimated:(BOOL)a3;
- (void)_updateControlsRelatedToDepthSuggestionAnimated:(BOOL)a3;
- (void)_updateCurrentPreviewFiltersOnCaptureController;
- (void)_updateDepthEffectApertureForGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4 zoomFactor:(double)a5;
- (void)_updateDepthEffectSuggestionButton;
- (void)_updateDescriptionOverlayVisibilityForMode:(int64_t)a3 allowShow:(BOOL)a4 allowHide:(BOOL)a5 animated:(BOOL)a6;
- (void)_updateDisabledModeOverlayViewForCurrentState;
- (void)_updateDisabledModeUIAnimated:(BOOL)a3;
- (void)_updateDiskSpaceAlertViewVisibilityAnimated:(BOOL)a3;
- (void)_updateDocumentScanningButtonIfNeeded;
- (void)_updateEnabledControlsWithReason:(id)a3 forceLog:(BOOL)a4;
- (void)_updateExposureButtonForCurrentState;
- (void)_updateExposureSliderForCurrentState;
- (void)_updateExternalStorageDataSources;
- (void)_updateExternalStorageMonitoringState:(unint64_t)a3;
- (void)_updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController;
- (void)_updateFilterButtonOnState;
- (void)_updateFilterNameBadgeAnimated:(BOOL)a3;
- (void)_updateFilterScrubberAfterCapture;
- (void)_updateFilterScrubberForGraphConfiguration:(id)a3;
- (void)_updateFlashButtonAvailability;
- (void)_updateFlashButtonForMode:(int64_t)a3 animated:(BOOL)a4;
- (void)_updateFlashModeOnControllerForMode:(int64_t)a3;
- (void)_updateFlipAspectRatioButtonForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateFocusAfterZoomIfNecessary;
- (void)_updateFocusAndExposureLockBadgeAnimated:(BOOL)a3;
- (void)_updateForCurrentConfiguration;
- (void)_updateForCurrentMachineReadableCodeAction;
- (void)_updateForShallowDepthOfFieldStatusChangedAnimated:(BOOL)a3;
- (void)_updateFreeResourcesInstructionLabelForCurrentState;
- (void)_updateFrontRearSimultaneousVideoEnabled:(BOOL)a3 performGraphConfiguration:(BOOL)a4;
- (void)_updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:(id)a3;
- (void)_updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateFullscreenViewfinderZoomSliderIfNecessary;
- (void)_updateHDRButtonAnimated:(BOOL)a3;
- (void)_updateHomeIndicatorBehaviorsForCaptureOrientation;
- (void)_updateImageAnalysisButton;
- (void)_updateImageAnalysisInstructions;
- (void)_updateImageWellWithStillImageResponse:(id)a3 forRequest:(id)a4 error:(id)a5;
- (void)_updateIntensityButtonForCurrentState;
- (void)_updateInterfaceModulationForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateLayoutStyle;
- (void)_updateLensPositionLockedByUser:(BOOL)a3;
- (void)_updateLevelMotionTracking;
- (void)_updateLightingControlFadesForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateLightingUIForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateLivePhotoButtonAnimated:(BOOL)a3;
- (void)_updateMachineReadableCodeButtonForAction:(id)a3 animated:(BOOL)a4;
- (void)_updateMachineReadableCodeButtonFromAction:(id)a3;
- (void)_updateMacroButtonState;
- (void)_updateMaxRecordingTimeInstructionLabelForGraphConfiguration:(id)a3;
- (void)_updateModeDisabledForCurrentStateAnimated:(BOOL)a3;
- (void)_updateModeDisabledForGraphConfiguration:(id)a3 callActive:(BOOL)a4 animated:(BOOL)a5;
- (void)_updateNightModeConflict:(unint64_t)a3 isConflicting:(BOOL)a4 performResolution:(BOOL)a5;
- (void)_updateNightModeControlsAnimated:(BOOL)a3;
- (void)_updateNightModePhotoModeDepthConflictAndPerformResolution:(BOOL)a3;
- (void)_updateNightModeSlider;
- (void)_updateObjectResults:(id)a3 headResults:(id)a4 bodyResults:(id)a5;
- (void)_updateOriginForRequest:(id)a3;
- (void)_updatePairedVideoCaptureOnControllerForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4;
- (void)_updatePanoramaSizeIfNeededForGraphConfiguration:(id)a3;
- (void)_updatePanoramaViewForCurrentState;
- (void)_updatePanoramaViewVisibilityForViewfinderTransition;
- (void)_updatePhotoFormatPickerAnimated:(BOOL)a3;
- (void)_updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:(BOOL)a3;
- (void)_updatePortraitApertureButtonForGraphConfiguration:(id)a3 zoomFactor:(double)a4 animated:(BOOL)a5;
- (void)_updatePortraitApertureSliderForGraphConfiguration:(id)a3 zoomFactor:(double)a4;
- (void)_updatePortraitIntensitySliderForCurrentState;
- (void)_updatePortraitModeInstructionLabelForCurrentState;
- (void)_updatePreviewControllerIndicatorStyle;
- (void)_updatePreviewControllerPortraitStatus;
- (void)_updatePreviewSemanticStyleAnimated:(BOOL)a3;
- (void)_updateProResButtonAnimated:(BOOL)a3;
- (void)_updateProResControlsForCurrentState;
- (void)_updateProminentObjectManagerWithCachedMetadataResults;
- (void)_updatePropertiesForCaptureConfiguration:(id)a3 conflictingControlConfiguration:(id)a4;
- (void)_updateQRCodeInstructionLabelForCurrentState;
- (void)_updateRAWButtonAnimated:(BOOL)a3;
- (void)_updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:(BOOL)a3;
- (void)_updateResolvedNightModeAnimated:(BOOL)a3;
- (void)_updateSelectedSmartStyle:(id)a3 animateSliders:(BOOL)a4;
- (void)_updateSelectedSmartStyleFromPicker;
- (void)_updateSemanticStyleControlsForCurrentStateAnimated:(BOOL)a3;
- (void)_updateSharedLibraryBadgeForCurrentState;
- (void)_updateSharedLibraryButtonAnimated:(BOOL)a3;
- (void)_updateSharedLibraryButtonOnSubviewsForLayoutStyle:(int64_t)a3;
- (void)_updateShutterButtonForEndOfNightModeCapture;
- (void)_updateShutterButtonForGraphConfiguration:(id)a3 isCapturing:(BOOL)a4 animated:(BOOL)a5;
- (void)_updateShutterButtonLegibility;
- (void)_updateShutterButtonSpinning;
- (void)_updateShutterEffectsEnablementForSystemPressureState;
- (void)_updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:(double)a3 zoomRampTuning:(int64_t)a4;
- (void)_updateSmartFramingFieldOfViewForGraphConfiguration:(id)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 animated:(BOOL)a6;
- (void)_updateSmartFramingForCaptureOrientation:(int64_t)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 animated:(BOOL)a6;
- (void)_updateSmartFramingMonitorForGraphConfiguration:(id)a3;
- (void)_updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateSmartStyleControlsForCurrentStateAnimateSliders:(BOOL)a3 animateOtherControls:(BOOL)a4;
- (void)_updateSmartStyleOnSession;
- (void)_updateSpatialCaptureUIStateForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateStateForClearedNightModeConflicts:(unint64_t)a3;
- (void)_updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:(int64_t)a3;
- (void)_updateTextAnalysisWithInsert:(id)a3 instructions:(BOOL)a4 animated:(BOOL)a5;
- (void)_updateTopBarForLightingType:(int64_t)a3;
- (void)_updateTopBarStyleForGraphConfiguration:(id)a3 capturing:(BOOL)a4 animated:(BOOL)a5;
- (void)_updateTorchModeForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateTorchModeOnControllerForMode:(int64_t)a3;
- (void)_updateTransientLightingBadgeVisibilityAnimated:(BOOL)a3;
- (void)_updateUIForCaptureOrientationAnimated:(BOOL)a3;
- (void)_updateUIForCapturing:(BOOL)a3 animated:(BOOL)a4 updateProResControls:(BOOL)a5;
- (void)_updateUserInitiationTimeForRequest:(id)a3;
- (void)_updateUserPreferencesForFilterUsage;
- (void)_updateVideoConfigurationStatusIndicatorForGraphConfiguration:(id)a3 animated:(BOOL)a4;
- (void)_updateVideoStabilizationButtonAnimated:(BOOL)a3;
- (void)_updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:(id)a3;
- (void)_updateViewfinderForExternalChromeState:(id)a3;
- (void)_updateViewfinderMaterialAnimated:(BOOL)a3;
- (void)_updateViewfinderMaterialFromStatus:(int64_t)a3 animated:(BOOL)a4;
- (void)_updateVisibleChromeSuggestionButton:(int64_t)a3;
- (void)_updateZoomButtonSymbolForMode:(int64_t)a3 device:(int64_t)a4 videoConfiguration:(int64_t)a5 zoomFactor:(double)a6 videoStabilizationStrength:(int64_t)a7 animated:(BOOL)a8;
- (void)_updateZoomControlAccessoryStateAnimated:(BOOL)a3;
- (void)_updateZoomControlLayoutForGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4 animated:(BOOL)a5;
- (void)_updateZoomFactorForZoomFactor:(double)a3 rampDuration:(double)a4 interactionType:(int64_t)a5 didChangeDevice:(id)a6;
- (void)_updateZoomUIWithZoomFactor:(double)a3 animated:(BOOL)a4;
- (void)_willChangeToGraphConfiguration:(id)a3 zoomFactor:(double)a4 fromGraphConfiguration:(id)a5 animated:(BOOL)a6;
- (void)_writeUserPreferences;
- (void)_zoomControlDidChangeZoomFactor:(double)a3 interactionType:(int64_t)a4;
- (void)_zoomSliderValueDidChange:(id)a3 forEvent:(id)a4;
- (void)_zoomUIDidChangeToFactor:(double)a3;
- (void)accessoryConnectedAndTracking:(BOOL)a3;
- (void)accessoryPanoramaMotionCompleted;
- (void)accessoryZoomInByDisplayZoomValue:(double)a3;
- (void)actionDidUpdateTitle:(id)a3;
- (void)addChildViewController:(id)a3 toView:(id)a4;
- (void)animateAlongsideFadeOutForTextLiftingView:(id)a3;
- (void)animateAlongsideTextLiftingForView:(id)a3;
- (void)applyCaptureConfiguration:(id)a3 conflictingControlConfiguration:(id)a4;
- (void)availableDiskSpaceChanged:(id)a3;
- (void)badgeTray:(id)a3 didCreateBadgeForType:(unint64_t)a4;
- (void)cameraRollController:(id)a3 didChangeImageWellImage:(id)a4 withUUID:(id)a5 animated:(BOOL)a6;
- (void)cameraRollController:(id)a3 didDismissPreviewControllerShouldStartCaptureSession:(BOOL)a4;
- (void)cameraRollController:(id)a3 willShowPresentingViewControllerShouldStartCaptureSession:(BOOL)a4;
- (void)cameraRollControllerDidDismissFullyPresentedCameraRoll:(id)a3;
- (void)cameraRollControllerDidFullyPresentCameraRoll:(id)a3;
- (void)cameraRollControllerRequestsCaptureSessionStopped:(id)a3;
- (void)cameraRollControllerWillPresentCameraRoll:(id)a3 withOneUpController:(id)a4;
- (void)captureController:(id)a3 didChangeCameraSystemPressureState:(id)a4;
- (void)captureController:(id)a3 didChangeDocumentSceneConfidenceResults:(float)a4;
- (void)captureController:(id)a3 didChangePreviewZoomPIPRect:(CGRect)a4;
- (void)captureController:(id)a3 didChangeRampingVideoZoom:(BOOL)a4;
- (void)captureController:(id)a3 didChangeToGraphConfiguration:(id)a4 forDesiredConfiguration:(id)a5 requestID:(int)a6;
- (void)captureController:(id)a3 didOutputAppClipCodeResults:(id)a4;
- (void)captureController:(id)a3 didOutputFaceResults:(id)a4 headResults:(id)a5 bodyResults:(id)a6 salientObjectResults:(id)a7;
- (void)captureController:(id)a3 didOutputFlashActive:(BOOL)a4;
- (void)captureController:(id)a3 didOutputFlashAvailability:(BOOL)a4;
- (void)captureController:(id)a3 didOutputFlashCompromise:(unint64_t)a4;
- (void)captureController:(id)a3 didOutputHistogramResult:(id)a4;
- (void)captureController:(id)a3 didOutputLensPosition:(double)a4;
- (void)captureController:(id)a3 didOutputLensSmudgeStatus:(int64_t)a4;
- (void)captureController:(id)a3 didOutputMinAvailableVideoZoomFactor:(double)a4;
- (void)captureController:(id)a3 didOutputNightModeDurationMapping:(id)a4;
- (void)captureController:(id)a3 didOutputNightModeStatus:(int64_t)a4;
- (void)captureController:(id)a3 didOutputOverCapturePreviewStatus:(int64_t)a4;
- (void)captureController:(id)a3 didOutputQRCodeResults:(id)a4;
- (void)captureController:(id)a3 didOutputRecommendedSmartFramingFieldOfView:(int64_t)a4;
- (void)captureController:(id)a3 didOutputShallowDepthOfFieldStatus:(int64_t)a4 stagePreviewStatus:(int64_t)a5;
- (void)captureController:(id)a3 didOutputStereoCaptureStatus:(int64_t)a4;
- (void)captureController:(id)a3 didOutputTextRegionResults:(id)a4;
- (void)captureController:(id)a3 didOutputTorchActive:(BOOL)a4;
- (void)captureController:(id)a3 didOutputTorchAvailability:(BOOL)a4;
- (void)captureController:(id)a3 didOutputVideoZoomFactor:(double)a4;
- (void)captureController:(id)a3 didUpdateActivePrimaryConstituentDeviceType:(int64_t)a4;
- (void)captureController:(id)a3 receivedFocusLocked:(BOOL)a4;
- (void)captureController:(id)a3 receivedOverlayApertureControlActive:(BOOL)a4;
- (void)captureController:(id)a3 receivedOverlayChangeSmartStyle:(id)a4;
- (void)captureController:(id)a3 receivedOverlayUpdateSmartStyle:(id)a4;
- (void)captureController:(id)a3 receivedOverlayVisible:(BOOL)a4;
- (void)captureController:(id)a3 receivedQuietUIActive:(BOOL)a4;
- (void)captureController:(id)a3 receivedSystemOverlayLensSelectorZoomFactor:(double)a4;
- (void)captureController:(id)a3 receivedSystemOverlayUpdateExposureBias:(double)a4;
- (void)captureController:(id)a3 willRecoverFromRuntimeError:(id)a4;
- (void)captureControllerDidReachMaximumBurstLength:(id)a3;
- (void)captureControllerDidStartRunning:(id)a3;
- (void)captureControllerDidStopCapturingBurst:(id)a3;
- (void)captureControllerDidStopPlayingBurstEndSound:(id)a3;
- (void)captureControllerDidStopRunning:(id)a3;
- (void)captureControllerInterruptionEnded:(id)a3;
- (void)captureControllerWasInterrupted:(id)a3;
- (void)captureControllerWillStartCapturingBurst:(id)a3;
- (void)captureControllerWillStartPlayingBurstEndSound:(id)a3;
- (void)changeToMode:(int64_t)a3;
- (void)changeToMode:(int64_t)a3 device:(int64_t)a4 animated:(BOOL)a5;
- (void)closedViewfinderController:(id)a3 wantsViewfinderClosedForReason:(int64_t)a4;
- (void)closedViewfinderController:(id)a3 wantsViewfinderOpenForReason:(int64_t)a4;
- (void)controlDrawer:(id)a3 didChangeSharedLibraryMode:(int64_t)a4;
- (void)controlDrawer:(id)a3 didChangeValueForControlType:(int64_t)a4;
- (void)controlDrawer:(id)a3 didCreateControlForType:(int64_t)a4;
- (void)controlDrawer:(id)a3 didSelectMenuItemForControlType:(int64_t)a4;
- (void)controlDrawer:(id)a3 wantsFilterScrubberVisible:(BOOL)a4;
- (void)controlDrawerDidCreateApertureSlider:(id)a3;
- (void)controlDrawerDidCreateExposureSlider:(id)a3;
- (void)controlDrawerDidCreateFilterScrubber:(id)a3;
- (void)controlDrawerDidCreateIntensitySlider:(id)a3;
- (void)controlDrawerDidCreateNightModeSlider:(id)a3;
- (void)controlDrawerDidCreateSemanticStyleControl:(id)a3;
- (void)controlStatusBar:(id)a3 didCreateIndicatorForType:(unint64_t)a4;
- (void)controlStatusBar:(id)a3 didReceiveTapInIndicatorForType:(unint64_t)a4;
- (void)controlStatusBar:(id)a3 willChangeExpandingControl:(id)a4 expanded:(BOOL)a5;
- (void)dealloc;
- (void)descriptionOverlayView:(id)a3 willBecomeVisible:(BOOL)a4;
- (void)descriptionOverlayViewDidSelectDetail:(id)a3;
- (void)descriptionOverlayViewSetTextViewFrame:(id)a3 textViewFrame:(CGRect)a4;
- (void)determinedBurstLength:(int64_t)a3 forPersistenceUUID:(id)a4;
- (void)disabledPreviewController:(id)a3 wantsPreviewDisabledForReason:(int64_t)a4;
- (void)disabledPreviewController:(id)a3 wantsPreviewEnabledForReason:(int64_t)a4;
- (void)dismissCameraRoll;
- (void)documentScanFlowControllerDidCancel:(id)a3;
- (void)documentScanFlowControllerDidFail:(id)a3 withError:(id)a4;
- (void)documentScanFlowControllerDidFinish:(id)a3;
- (void)dynamicShutterControl:(id)a3 didChangeRelativeZoomProgress:(double)a4;
- (void)dynamicShutterControlDidDismissCounter:(id)a3;
- (void)dynamicShutterControlDidPresentCounter:(id)a3;
- (void)dynamicShutterControlDidPressLockButton:(id)a3;
- (void)dynamicShutterControlDidPressPauseResumeButton:(id)a3;
- (void)dynamicShutterControlDidShortPress:(id)a3;
- (void)dynamicShutterControlDidStart:(id)a3 withGesture:(int64_t)a4;
- (void)dynamicShutterControlDidStartZoomGesture:(id)a3;
- (void)dynamicShutterControlDidStop:(id)a3;
- (void)dynamicShutterControlDidStopZoomGesture:(id)a3;
- (void)dynamicShutterControlGesturesDidBegin:(id)a3;
- (void)dynamicShutterControlGesturesDidCancel:(id)a3;
- (void)dynamicShutterControlGesturesDidEnd:(id)a3;
- (void)externalStorageMonitor:(id)a3 didChangeConnectedStorageDevices:(id)a4;
- (void)fadeOutAnimationDidEndForView:(id)a3;
- (void)frontPIPFrameDidChange:(CGRect)a3;
- (void)frontPIPWillAnimateToAnchor:(int64_t)a3 withFrame:(CGRect)a4;
- (void)fullScreenViewfinderDidCreateFlipAspectRatioButton:(id)a3;
- (void)fullscreenViewFinder:(id)a3 willDismissControlDrawerModallyForControlType:(int64_t)a4 reason:(int64_t)a5;
- (void)fullscreenViewFinder:(id)a3 willPresentControlDrawerModallyForControlType:(int64_t)a4 reason:(int64_t)a5;
- (void)fullscreenViewfinder:(id)a3 didChangeControlDrawerVisibility:(BOOL)a4 animated:(BOOL)a5 forReason:(int64_t)a6;
- (void)fullscreenViewfinder:(id)a3 didChangeExpanded:(BOOL)a4 forDrawerControlOfType:(int64_t)a5 animated:(BOOL)a6 updatePreferredDrawerControl:(BOOL)a7;
- (void)fullscreenViewfinder:(id)a3 didChangeSmartStyleControlsVisibility:(BOOL)a4 animated:(BOOL)a5;
- (void)fullscreenViewfinder:(id)a3 didCreateInstructionLabel:(int64_t)a4;
- (void)fullscreenViewfinderDidChangeSemanticStyle:(id)a3;
- (void)fullscreenViewfinderDidCreateControlDrawer:(id)a3;
- (void)fullscreenViewfinderDidCreatePortraitControls:(id)a3;
- (void)fullscreenViewfinderDidCreateSmartStyleControls:(id)a3;
- (void)fullscreenViewfinderDidCreateSpotlightControlPanel:(id)a3;
- (void)fullscreenViewfinderDidFinishChangingPreviewGeometry:(id)a3;
- (void)generateAnalyticsSessionEventIfNeeded;
- (void)generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:(int64_t)a3 captureDevice:(int64_t)a4;
- (void)handleChangedToFlashMode:(int64_t)a3 allowFlashOrTorchUnavailableAlert:(BOOL)a4;
- (void)handleChromeControlPanelIsExpanded:(BOOL)a3;
- (void)handleChromeTopBarMenuState:(int64_t)a3;
- (void)handleChromeTopInset:(double)a3;
- (void)handleDoneButtonReleased;
- (void)handleExternalChromeFilterScrubberSelectedIndexChanged:(int64_t)a3;
- (void)handleExternalChromeImageAnalysisButtonChanged:(id)a3;
- (void)handleExternalChromeShutterControlChanged:(id)a3;
- (void)handleFlipButtonReleased;
- (void)handleImageWellReleased;
- (void)handleReviewButtonReleased;
- (void)handleSmartStylePadValueChanged:(CGPoint)a3;
- (void)handleUserChangedFiltersUIVisible:(BOOL)a3;
- (void)handleUserChangedFlippedAspectRatioEnabled:(BOOL)a3;
- (void)handleUserChangedFrontPIPEnabled:(BOOL)a3;
- (void)handleUserChangedIsLensPositionLocked:(BOOL)a3;
- (void)handleUserChangedLensPosition:(double)a3;
- (void)handleUserChangedPortraitIntensity:(double)a3;
- (void)handleUserChangedProResMode:(int64_t)a3;
- (void)handleUserChangedProResMode:(int64_t)a3 chromeSelectedProResColorSpace:(int64_t)a4;
- (void)handleUserChangedSemanticStylePreset:(int64_t)a3 sceneBias:(double)a4 warmthBias:(double)a5;
- (void)handleUserChangedSemanticStylesUIVisible:(BOOL)a3;
- (void)handleUserChangedSmartFramingAutoRotationEnabled:(BOOL)a3;
- (void)handleUserChangedSmartFramingAutoZoomEnabled:(BOOL)a3;
- (void)handleUserChangedSmartStylesUIVisible:(BOOL)a3;
- (void)handleUserChangedToApertureValue:(double)a3 enableDepthSuggestion:(BOOL)a4;
- (void)handleUserChangedToAspectRatioCrop:(int64_t)a3;
- (void)handleUserChangedToHDRMode:(int64_t)a3;
- (void)handleUserChangedToLivePhotoMode:(int64_t)a3;
- (void)handleUserChangedToMacroMode:(int64_t)a3;
- (void)handleUserChangedToMode:(int64_t)a3;
- (void)handleUserChangedToMode:(int64_t)a3 device:(int64_t)a4;
- (void)handleUserChangedToMode:(int64_t)a3 device:(int64_t)a4 zoomFactor:(double)a5;
- (void)handleUserChangedToNightMode:(unint64_t)a3;
- (void)handleUserChangedToPhotoFormat:(id)a3;
- (void)handleUserChangedToSharedLibraryMode:(int64_t)a3;
- (void)handleUserChangedToVideoConfiguration:(int64_t)a3;
- (void)handleUserChangedVideoStabilizationMode:(int64_t)a3;
- (void)handleUserDidToggleSpatialMode;
- (void)imageAnalysisButton:(id)a3 didChangeContextMenuDisplayed:(BOOL)a4;
- (void)lensSmudgeDisplayShouldBeHiddenForDevicePosition:(int64_t)a3;
- (void)librarySelectionDidChangeSharedLibraryMode:(int64_t)a3;
- (void)lightingControl:(id)a3 willChangeExpanded:(BOOL)a4;
- (void)lightingControlDidChangeExpanded:(id)a3;
- (void)lightingControlDidChangeSelectedLightingType:(id)a3;
- (void)loadView;
- (void)machineReadableCodeButtonDidTapDismiss:(id)a3;
- (void)panoramaRequest:(id)a3 didGeneratePaintingStatus:(id)a4;
- (void)panoramaRequest:(id)a3 didStopWithReason:(int64_t)a4;
- (void)panoramaRequestDidCompleteCapture:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)panoramaRequestDidCompleteLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)panoramaRequestDidCompleteRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)panoramaRequestDidStartCapturing:(id)a3;
- (void)panoramaRequestDidStopCapturing:(id)a3 interrupted:(BOOL)a4;
- (void)performDiscreteFeedback:(unint64_t)a3;
- (void)physicalCaptureNotifierDidChangeState:(id)a3 forButton:(int64_t)a4;
- (void)prepareDiscreteFeedback:(unint64_t)a3;
- (void)prepareForDefaultImageSnapshotForScreen:(id)a3;
- (void)presentCameraRollViewControllerAnimated:(BOOL)a3 withAction:(unint64_t)a4 selectedAssetIndexFromEnd:(unint64_t)a5;
- (void)presentDocumentScanningViewControllerAnimated:(BOOL)a3;
- (void)pressShutterForRemoteShutter;
- (void)pressShutterForRemoteShutterWaitingForViewfinder:(BOOL)a3 timeout:(double)a4;
- (void)pressStillDuringVideoForRemoteShutter;
- (void)previewViewController:(id)a3 willResetFocus:(BOOL)a4 exposure:(BOOL)a5;
- (void)previewViewControllerDidChangeFocusOrExposure:(id)a3;
- (void)previewViewControllerDidChangeFocusOrExposureLocked:(id)a3 shouldAnimate:(BOOL)a4;
- (void)previewViewControllerDidChangeVideoFillAspectRatio:(id)a3;
- (void)prominentObjectManager:(id)a3 didChangeCurrentObject:(id)a4;
- (void)readUserPreferencesAndHandleChangesWithOverrides:(id)a3 bypassXPCWhenReadingSystemStyle:(BOOL)a4;
- (void)remoteShutter:(id)a3 setCaptureDevice:(int64_t)a4;
- (void)remoteShutter:(id)a3 setMode:(int64_t)a4;
- (void)remoteShutter:(id)a3 setZoomAmount:(double)a4;
- (void)remoteShutter:(id)a3 takePhotoWithCountdown:(unint64_t)a4;
- (void)remoteShutterCancelCountdown:(id)a3;
- (void)request:(id)a3 didDetectTextWithResult:(id)a4;
- (void)request:(id)a3 didFailWithError:(id)a4;
- (void)request:(id)a3 didRecgonizeTextWithAnalysis:(id)a4;
- (void)resumeCameraSessionWithCompletion:(id)a3;
- (void)setAutomaticallyAdjustsApplicationIdleTimer:(BOOL)a3;
- (void)setAutorotationStyle:(int64_t)a3;
- (void)setAvailableCaptureModes:(id)a3;
- (void)setConfigurationDelegate:(id)a3;
- (void)setCustomPreviewViewTransform:(CGAffineTransform *)a3;
- (void)setDisablingAdditionalCaptures:(BOOL)a3;
- (void)setDockKitController:(id)a3;
- (void)setHDRMode:(int64_t)a3;
- (void)setImagePickerVideoConfiguration:(int64_t)a3;
- (void)setMessagesTransitionState:(int64_t)a3 animated:(BOOL)a4;
- (void)setPerformingReviewUsingOverlay:(BOOL)a3;
- (void)setPersistenceBehavior:(unint64_t)a3;
- (void)setPhotoResolution:(int64_t)a3;
- (void)setPresentedImageWellImage:(id)a3;
- (void)setRawMode:(int64_t)a3;
- (void)setShowingStandardControls:(BOOL)a3;
- (void)setShutterButtonSpinning:(BOOL)a3;
- (void)setSingleUseTimerWithDuration:(int64_t)a3;
- (void)setTorchMode:(int64_t)a3;
- (void)setUserInteractionLoggingEnabled:(BOOL)a3;
- (void)sharedLibraryTapToRadarAction;
- (void)shutterControlDidUpdateLiquidShutter:(id)a3;
- (void)shutterControlTouchAttemptedWhileDisabled:(id)a3;
- (void)simulateShutterButtonPressForCaptureMenuItem;
- (void)spotlightControlPanel:(id)a3 didChangeOpenForSpotlight:(int64_t)a4;
- (void)spotlightControlPanel:(id)a3 didChangeValueForSpotlight:(int64_t)a4;
- (void)spotlightControlPanelDidCreateApertureSlider:(id)a3;
- (void)stillImageRequestDidBeginCaptureBeforeResolvingSettings:(id)a3;
- (void)stillImageRequestDidCompleteCapture:(id)a3 error:(id)a4;
- (void)stillImageRequestDidCompleteStillImageCapture:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)stillImageRequestDidCompleteStillImageLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)stillImageRequestDidCompleteStillImageRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)stillImageRequestDidCompleteVideoCapture:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)stillImageRequestDidStartCapturing:(id)a3 resolvedSettings:(id)a4;
- (void)stillImageRequestDidStopCapturingStillImage:(id)a3;
- (void)stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:(BOOL)a3;
- (void)stillImageRequestsDidCompleteCapturingLivePhotoVideo;
- (void)stillImageRequestsDidStopCapturingCTMVideo;
- (void)stillImageRequestsWillRequestCTMVideoCaptureEnd;
- (void)stillImageRequestsWillRequestCTMVideoCaptureStart;
- (void)stillImageRequestsWillStartCapturingLivePhotoVideo;
- (void)stopMonitoringForAccidentalLaunchIfNeeded;
- (void)storageControllerDidChangePurgingState:(id)a3;
- (void)suspendCameraSessionWithCompletion:(id)a3;
- (void)tapToFocusTriggeredAtPoint:(CGPoint)a3;
- (void)timelapseController:(id)a3 generatedPlaceholderResult:(id)a4 withThumbnailImage:(id)a5 forAssetUUID:(id)a6 inCaptureSession:(unsigned __int16)a7;
- (void)timelapseController:(id)a3 persistedPlaceholderResult:(id)a4 error:(id)a5;
- (void)timelapseController:(id)a3 startedWithCaptureOrientation:(int64_t)a4;
- (void)timelapseControllerStopped:(id)a3;
- (void)timerCache:(id)a3 timerDidFireForKey:(id)a4;
- (void)toggleBetweenZoomFactorsForZoomControl:(id)a3;
- (void)updateControlVisibilityAnimated:(BOOL)a3;
- (void)updateDepthEffectSuggestionEnabled:(BOOL)a3;
- (void)videoRequestDidCompleteCapture:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)videoRequestDidCompleteLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)videoRequestDidCompleteRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5;
- (void)videoRequestDidResumeCapturing:(id)a3;
- (void)videoRequestDidStartCapturing:(id)a3;
- (void)videoRequestDidStopCapturing:(id)a3;
- (void)videoThumbnailOutputWillBeginRenderingThumbnailsWithContents:(id)a3;
- (void)videoThumbnailOutputWillEndRenderingThumbnails;
- (void)viewDidAppear:(BOOL)a3;
- (void)viewDidDisappear:(BOOL)a3;
- (void)viewDidLayoutSubviews;
- (void)viewDidLoad;
- (void)viewWillAppear:(BOOL)a3;
- (void)viewWillDisappear:(BOOL)a3;
- (void)viewWillLayoutSubviews;
- (void)viewWillTransitionToSize:(CGSize)a3 withTransitionCoordinator:(id)a4;
- (void)willHideZoomSlider:(id)a3 withAnimationDuration:(double)a4;
- (void)willShowZoomSlider:(id)a3 withAnimationDuration:(double)a4;
- (void)zoomControl:(id)a3 didChangeSelectedButtonIndex:(unint64_t)a4 displayZoomFactor:(double)a5;
- (void)zoomControl:(id)a3 didChangeZoomFactor:(double)a4 interactionType:(int64_t)a5;
- (void)zoomControlDidChangePlatterExpanded:(id)a3;
- (void)zoomControlDidChangeShowingZoomDial:(id)a3;
- (void)zoomControlDidTapZoomButtonAccessory:(id)a3;
- (void)zoomSliderDidBeginAutozooming:(id)a3;
@end

@implementation CAMViewfinderViewController

- (unint64_t)supportedInterfaceOrientations
{
  v3 = [(CAMViewfinderViewController *)self _layoutStyle];
  v4 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];

  return [(CAMViewfinderViewController *)self _supportedInterfaceOrientationsForLayoutStyle:v3 wantsTextAnalysis:v4];
}

- (BOOL)prefersStatusBarHidden
{
  v2 = [(CAMViewfinderViewController *)self _cameraRollController];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 prefersPresentingStatusbarHidden];
  }

  else
  {
    v4 = 1;
  }

  return v4;
}

- (unint64_t)preferredScreenEdgesDeferringSystemGestures
{
  if (([(CAMViewfinderViewController *)self _layoutStyle]| 2) != 2)
  {
    return 0;
  }

  v3 = [(CAMViewfinderViewController *)self view];
  v4 = [v3 window];
  v5 = CAMInterfaceOrientationForWindow(v4);

  v6 = 1;
  v7 = 4;
  if (v5 != 1)
  {
    v7 = 0;
    v6 = 0;
  }

  if (v5 == 2)
  {
    v8 = 1;
  }

  else
  {
    v8 = v7;
  }

  if (v5 == 2)
  {
    v9 = 4;
  }

  else
  {
    v9 = v6;
  }

  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (v10)
  {
    v11 = v9;
  }

  else
  {
    v11 = 0;
  }

  return v11 | v8;
}

- (void)loadView
{
  v35 = [(CAMViewfinderViewController *)self _previewViewController];
  v3 = [v35 previewView];
  v4 = [MEMORY[0x1E695DF70] array];
  [(CAMViewfinderViewController *)self _setAccessibilityHUDManagers:v4];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 videoPreviewLayer];

  [v3 setVideoPreviewLayer:v7];
  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v8 secondaryVideoPreviewLayer];

  [v3 setFrontPIPVideoPreviewLayer:v9];
  if ([v5 wantsFullscreenViewfinder])
  {
    v10 = [[CAMFullscreenViewfinder alloc] initWithMetalContext:0];
    [(CAMViewfinderViewController *)self _updateViewfinderForExternalChromeState:v10];
    [(CAMFullscreenViewfinder *)v10 setPreviewView:v3];
    [(CAMFullscreenViewfinder *)v10 setDelegate:self];
    [(CAMViewfinderViewController *)self setView:v10];
    [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:0];
    [(CAMFullscreenViewfinder *)v10 setZoomStyle:[(CAMViewfinderViewController *)self _fullscreenViewfinderZoomStyle]];
    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderZoomSliderIfNecessary];
    v11 = [(CAMFullscreenViewfinder *)v10 flipButton];
    [v11 addTarget:self action:sel__handleFlipButtonTouchDown_ forControlEvents:1];

    v12 = [(CAMFullscreenViewfinder *)v10 flipButton];
    [v12 addTarget:self action:sel_handleFlipButtonReleased forControlEvents:64];

    v13 = [(CAMFullscreenViewfinder *)v10 zoomControl];
    [v13 addTarget:self action:sel__handleTouchDownForZoomControl_ forControlEvents:1];

    v14 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [v14 addTarget:self action:sel__handleTouchDownForZoomSlider_ forControlEvents:1];

    v15 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [v15 addTarget:self action:sel__zoomSliderValueDidChange_forEvent_ forControlEvents:4096];

    v16 = [(CAMFullscreenViewfinder *)v10 photoVideoModeSwitch];
    [v16 addTarget:self action:sel__handlePhotoVideoModeSwitchValueChanged_ forControlEvents:4096];

    v17 = [(CAMViewfinderViewController *)self currentContentSize];
    IsAccessibilityCategory = UIContentSizeCategoryIsAccessibilityCategory(v17);

    if (IsAccessibilityCategory)
    {
      v19 = [[CAMBarsAccessibilityHUDManager alloc] initWithView:v10 delegate:self cancelsTouchesInView:1];
      [v4 addObject:v19];
    }

    v20 = [(CAMFullscreenViewfinder *)v10 shutterControl];
    [v20 setDelegate:self];

    v21 = [(CAMFullscreenViewfinder *)v10 zoomControl];
    [v21 setDelegate:self];

    v22 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [v22 setDelegate:self];

    v23 = [(CAMFullscreenViewfinder *)v10 controlStatusBar];
    [v23 setDelegate:self];

    v24 = [(CAMFullscreenViewfinder *)v10 badgeTray];
    [v24 setDelegate:self];

    v25 = [(CAMFullscreenViewfinder *)v10 flipButton];
    flipButton = self->__flipButton;
    self->__flipButton = v25;

    v27 = [(CAMFullscreenViewfinder *)v10 zoomControl];
    zoomControl = self->__zoomControl;
    self->__zoomControl = v27;

    v29 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    zoomSlider = self->__zoomSlider;
    self->__zoomSlider = v29;

    v31 = [(CAMFullscreenViewfinder *)v10 shutterControl];
    dynamicShutterControl = self->__dynamicShutterControl;
    self->__dynamicShutterControl = v31;

    v33 = [(CAMViewfinderViewController *)self _transitionController];
    [v33 setTarget:v10];
  }

  else
  {
    v10 = [[CAMViewfinderView alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    [(CAMFullscreenViewfinder *)v10 setPreviewView:v3];
    [(CAMFullscreenViewfinder *)v10 setVisibilityDelegate:self];
    [(CAMFullscreenViewfinder *)v10 setChromePanoramaLayoutDelegate:self];
    [(CAMFullscreenViewfinder *)v10 setUseMessagesLayout:[(CAMViewfinderViewController *)self _useMessagesControls]];
    [(CAMFullscreenViewfinder *)v10 setShowingStandardControls:[(CAMViewfinderViewController *)self isShowingStandardControls]];
    v34 = [(CAMViewfinderViewController *)self _transitionController];
    [v34 setTarget:v10];

    [(CAMViewfinderViewController *)self setView:v10];
  }

  [(CAMViewfinderViewController *)self _createPhysicalCaptureInteractionIfNeeded];
  [(CAMViewfinderViewController *)self _createChromeViewControllerIfNeeded];
}

- (id)currentContentSize
{
  v2 = [(CAMViewfinderViewController *)self traitCollection];
  v3 = [v2 preferredContentSizeCategory];

  return v3;
}

- (void)viewDidLoad
{
  v7.receiver = self;
  v7.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v7 viewDidLoad];
  v3 = [(CAMViewfinderViewController *)self view];
  [v3 _accessibilitySetInterfaceStyleIntent:2];

  v4 = [(CAMViewfinderViewController *)self _previewViewController];
  [v4 didMoveToParentViewController:self];
  [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
  [(CAMViewfinderViewController *)self _createCommonGestureRecognizersIfNecessary];
  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  [(CAMViewfinderViewController *)self _updateDisabledModeUIAnimated:0];
  [(CAMViewfinderViewController *)self _presentInitialImageWellImageForSession];
  v5 = [(CAMViewfinderViewController *)self modesForModeDial:0];
  v6 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v6 setAvailableCaptureModes:v5];

  [(CAMViewfinderViewController *)self _updateChromeAvailableCaptureModes];
  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_createCommonControlsIfNecessary
{
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    [(CAMViewfinderViewController *)self _createShutterButtonIfNecessary];
    if ([v4 isFrontCameraSupported] && objc_msgSend(v4, "isBackCameraSupported"))
    {
      [(CAMViewfinderViewController *)self _createFlipButtonIfNecessary];
    }

    if ([CAMBottomBar wantsVerticalBarForLayoutStyle:v3])
    {
      [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
      if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
      {
        [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
      }

      if ([v4 isLivePhotoSupported])
      {
        [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
      }
    }

    [(CAMViewfinderViewController *)self _createModeDialIfNecessary];
    [(CAMViewfinderViewController *)self _createFocusAndExposureLockBadgeIfNecessary];
    if (([v4 isBackFlashSupported] & 1) != 0 || objc_msgSend(v4, "isFrontFlashSupported"))
    {
      [(CAMViewfinderViewController *)self _createFlashButtonIfNecessary];
    }

    [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryControlsIfNecessary];
  }
}

- (void)_createShutterButtonIfNecessary
{
  if (!self->__shutterButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:19])
  {
    v3 = [CUShutterButton shutterButtonWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    shutterButton = self->__shutterButton;
    self->__shutterButton = v3;

    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonPressed_ forControlEvents:1];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonReleased_ forControlEvents:64];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonDragEnter_ forControlEvents:16];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonDragExited_ forControlEvents:32];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonCancelled_ forControlEvents:256];
    [(CUShutterButton *)self->__shutterButton setMode:0];
    [(CUShutterButton *)self->__shutterButton setExclusiveTouch:1];
    [(CUShutterButton *)self->__shutterButton setDelegate:self];

    [(CAMViewfinderViewController *)self _embedShutterButton];
  }
}

- (id)viewfinderView
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 wantsFullscreenViewfinder];

  if (v4)
  {
    v5 = 0;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self view];
  }

  return v5;
}

- (void)_createFlipButtonIfNecessary
{
  if (!self->__flipButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:4])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = +[CAMCaptureCapabilities capabilities];
    v5 = [v4 overContentFlipButtonSupported];

    if (v5)
    {
      +[CAMFlipButton flipButtonOverContent];
    }

    else
    {
      [CAMFlipButton flipButtonWithLayoutStyle:v3];
    }
    v6 = ;
    flipButton = self->__flipButton;
    self->__flipButton = v6;

    [(CAMFlipButton *)self->__flipButton addTarget:self action:sel__handleFlipButtonTouchDown_ forControlEvents:1];
    [(CAMFlipButton *)self->__flipButton addTarget:self action:sel_handleFlipButtonReleased forControlEvents:64];
    [(CAMFlipButton *)self->__flipButton setExclusiveTouch:1];

    [(CAMViewfinderViewController *)self _embedFlipButtonWithLayoutStyle:v3];
  }
}

- (void)_createModeDialIfNecessary
{
  if (!self->__modeDial && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:13])
  {
    v3 = [[CAMModeDial alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    modeDial = self->__modeDial;
    self->__modeDial = v3;

    [(CAMModeDial *)self->__modeDial addTarget:self action:sel__handleModeDialTouchDown_ forControlEvents:1];
    [(CAMModeDial *)self->__modeDial addTarget:self action:sel__handleModeDialValueChanged_ forControlEvents:4096];
    [(CAMModeDial *)self->__modeDial setDataSource:self];
    [(CAMModeDial *)self->__modeDial reloadData];

    [(CAMViewfinderViewController *)self _embedModeDial];
  }
}

- (void)_createFocusAndExposureLockBadgeIfNecessary
{
  if (!self->__focusAndExposureLockBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:5])
  {
    v3 = [CAMFocusLockBadge alloc];
    v4 = [(CAMFocusLockBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    focusAndExposureLockBadge = self->__focusAndExposureLockBadge;
    self->__focusAndExposureLockBadge = v4;
  }

  [(CAMViewfinderViewController *)self _embedFocusAndExposureLockBadge];
}

- (CAMViewfinderReviewButtonSource)reviewButtonSource
{
  WeakRetained = objc_loadWeakRetained(&self->_reviewButtonSource);

  return WeakRetained;
}

- (void)_createFlashButtonIfNecessary
{
  if (!self->__flashButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:3])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMFlashButton alloc] initWithLayoutStyle:v3];
    flashButton = self->__flashButton;
    self->__flashButton = v4;

    [(CAMFlashButton *)self->__flashButton addTarget:self action:sel__handleFlashButtonChangedFlashMode forControlEvents:4096];
    [(CAMFlashButton *)self->__flashButton addTarget:self action:sel__handleFlashButtonWhileFlashUnavailable forControlEvents:0x1000000];
    [(CAMFlashButton *)self->__flashButton setExclusiveTouch:1];
    [(CAMFlashButton *)self->__flashButton setAllowsAutomaticFlash:1 needsReloadData:0];
    [(CAMFlashButton *)self->__flashButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedFlashButtonWithLayoutStyle:v3];
  }
}

- (BOOL)_isShowingCameraRoll
{
  v2 = [(CAMViewfinderViewController *)self _cameraRollController];
  v3 = [v2 isCameraRollViewControllerPresented];

  return v3;
}

- (BOOL)_isShowingBurstIndicatorView
{
  v2 = [(CAMViewfinderViewController *)self _burstIndicatorView];
  [v2 alpha];
  v4 = v3 > 0.0;

  return v4;
}

- (void)_updateLevelMotionTracking
{
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [(CAMViewfinderViewController *)self _shouldMonitorDeviceMotionForGraphConfiguration:?];
  v4 = [(CAMViewfinderViewController *)self _motionController];
  v5 = v4;
  if (v3)
  {
    v6 = [(CAMViewfinderViewController *)self _levelViewModel];
    [v5 beginUpdatingLevelViewModel:v6];
  }

  else
  {
    [v4 endUpdatingActiveLevelViewModel];
  }
}

- (void)_createCommonGestureRecognizersIfNecessary
{
  [(CAMViewfinderViewController *)self _createZoomPinchGestureRecognizerIfNecessary];
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {

    [(CAMViewfinderViewController *)self _createSwipeToModeSwitchGestureRecognizersIfNecessary];
  }
}

- (void)_createZoomPinchGestureRecognizerIfNecessary
{
  if (!self->__zoomPinchGestureRecognizer)
  {
    v3 = [(UIPinchGestureRecognizer *)[CAMZoomPinchGestureRecognizer alloc] initWithTarget:self action:sel__handleZoomPinchGestureRecognizer_];
    zoomPinchGestureRecognizer = self->__zoomPinchGestureRecognizer;
    self->__zoomPinchGestureRecognizer = &v3->super;

    [(UIPinchGestureRecognizer *)self->__zoomPinchGestureRecognizer setDelegate:self];
    v5 = [(CAMViewfinderViewController *)self view];
    [v5 addGestureRecognizer:self->__zoomPinchGestureRecognizer];
  }
}

- (void)_createSwipeToModeSwitchGestureRecognizersIfNecessary
{
  if (!self->__previousModeGestureRecognizer)
  {
    v3 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__swipedToPreviousCameraMode_];
    previousModeGestureRecognizer = self->__previousModeGestureRecognizer;
    self->__previousModeGestureRecognizer = v3;

    [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer setDelegate:self];
    v5 = [(CAMViewfinderViewController *)self view];
    [v5 addGestureRecognizer:self->__previousModeGestureRecognizer];
  }

  if (!self->__nextModeGestureRecognizer)
  {
    v6 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__swipedToNextCameraMode_];
    nextModeGestureRecognizer = self->__nextModeGestureRecognizer;
    self->__nextModeGestureRecognizer = v6;

    [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer setDelegate:self];
    v8 = [(CAMViewfinderViewController *)self view];
    [v8 addGestureRecognizer:self->__nextModeGestureRecognizer];
  }

  [(CAMViewfinderViewController *)self _configureSwipeToModeSwitchGestureRecognizersDirection];
}

- (void)_updateForCurrentConfiguration
{
  v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [v14 mode];
  [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
  [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:v14];
  v4 = [(CAMViewfinderViewController *)self _topBar];
  [v4 configureForMode:v3];
  v5 = [(CAMViewfinderViewController *)self _modeDial];
  [v5 reloadData];
  [v5 setSelectedMode:v3 animated:0];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v14 isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:0];
  v6 = [(CAMViewfinderViewController *)self viewfinderView];
  v7 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", v3, [v14 videoConfiguration], objc_msgSend(v14, "devicePosition"), objc_msgSend(v14, "trueVideoEnabled"));
  [v6 setDesiredAspectRatio:v7];
  [v6 setMaskingAspectRatio:v7];
  [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:0];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
  }

  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v8 animated:0];

  [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:0];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:v14 fromGraphConfiguration:v14 animated:0];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:v14 animated:0];
  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
  [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:[(CAMViewfinderViewController *)self _resolvedTimerDuration] animated:0];
  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
  }

  [(CAMViewfinderViewController *)self _updateHomeIndicatorBehaviorsForCaptureOrientation];
  [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:v14];
  [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:0];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v14 zoomFactor:?];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v14 zoomFactor:0 animated:?];
  [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v14 animated:0];
  v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v9 setViewportAspectRatio:v7 animated:0];
  v10 = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
  v11 = [(CAMViewfinderViewController *)self _controlDrawer];
  v12 = [v11 aspectRatioButton];
  [v12 setAspectRatio:v10];

  [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:v14 animated:0];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  [(CAMViewfinderViewController *)self _updateAutoMacroButton];
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:0];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:v14];
  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:v14 animated:0];
  [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v14 animated:0];
  v13 = [(CAMViewfinderViewController *)self _previewViewController];
  [v13 willChangeToGraphConfiguration:v14];
  [v13 didChangeToGraphConfiguration:v14 animated:0];
}

- (int64_t)_currentMode
{
  v2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [v2 mode];

  return v3;
}

- (void)_createStillImageControlsIfNecessary
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v3 = [v4 isLivePhotoSupported];
  if (v3)
  {
    [(CAMViewfinderViewController *)self _createLivePhotoBadgeIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createTimerIndicatorViewIfNecessary];
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {
    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  if (([v4 isBackBurstSupported] & 1) != 0 || objc_msgSend(v4, "isFrontBurstSupported"))
  {
    [(CAMViewfinderViewController *)self _createBurstIndicatorViewIfNecessary];
  }

  if (v3)
  {
    [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createQRCodeInstructionLabelIfNecessary];
}

- (void)_createTimerButtonIfNecessary
{
  if (!self->__timerButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:21])
  {
    v3 = [[CAMTimerButton alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    timerButton = self->__timerButton;
    self->__timerButton = v3;

    [(CAMTimerButton *)self->__timerButton addTarget:self action:sel__handleTimerButtonChangedTimerDuration forControlEvents:4096];
    [(CAMTimerButton *)self->__timerButton setDelegate:self];
    [(CAMTimerButton *)self->__timerButton setHideOffWhenCollapsed:1 needsReloadData:0];
    [(CAMTimerButton *)self->__timerButton reloadData];
    [(CAMTimerButton *)self->__timerButton setDuration:[(CAMViewfinderViewController *)self _resolvedTimerDuration]];
  }

  v5 = [(CAMViewfinderViewController *)self _layoutStyle];

  [(CAMViewfinderViewController *)self _embedTimerButtonWithLayoutStyle:v5];
}

- (void)_createTimerIndicatorViewIfNecessary
{
  if (!self->__timerIndicatorView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:22])
  {
    v3 = objc_alloc_init(CAMTimerIndicatorView);
    timerIndicatorView = self->__timerIndicatorView;
    self->__timerIndicatorView = v3;

    v5 = [MEMORY[0x1E695DF00] dateWithTimeIntervalSinceReferenceDate:0.0];
    [(CAMViewfinderViewController *)self _setLastTimerIndicatorFaceUpdateDate:v5];
  }

  [(CAMViewfinderViewController *)self _embedTimerIndicatorView];
}

- (BOOL)_wantsHDRControlsVisible
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _wantsHDRControlsVisibleForGraphConfiguration:v3];

  return v2;
}

- (void)_createHDRButtonIfNecessary
{
  if (!self->__HDRButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:6])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMHDRButton alloc] initWithLayoutStyle:v3];
    HDRButton = self->__HDRButton;
    self->__HDRButton = v4;

    [(CAMHDRButton *)self->__HDRButton addTarget:self action:sel__handleHDRButtonChangedHDRMode forControlEvents:4096];
    [(CAMHDRButton *)self->__HDRButton setExclusiveTouch:1];
    [(CAMHDRButton *)self->__HDRButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedHDRButtonWithLayoutStyle:v3];
  }
}

- (BOOL)_shouldUseZoomControlInsteadOfSlider
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 zoomControlSupported];

  LOBYTE(v3) = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  return v4 & (v3 ^ 1 | [(CAMViewfinderViewController *)self isShowingStandardControls]);
}

- (void)_createBurstIndicatorViewIfNecessary
{
  if (!self->__burstIndicatorView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:1])
  {
    v3 = [[CAMBurstIndicatorView alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    burstIndicatorView = self->__burstIndicatorView;
    self->__burstIndicatorView = v3;

    [(CAMBurstIndicatorView *)self->__burstIndicatorView setAlpha:0.0];

    [(CAMViewfinderViewController *)self _embedBurstIndicatorView];
  }
}

- (void)_updateFilterButtonOnState
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v3];
  v5 = v4 != [CAMUserPreferences defaultFilterTypeForMode:v3];
  v6 = [(CAMViewfinderViewController *)self _controlDrawer];
  v7 = [v6 filterButton];
  [v7 setOn:v5];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 controlStatusBar];
  v10 = [v9 filterIndicator];
  [v10 setOn:v5];

  v11 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v11 setIsFilterActive:v5];
}

- (void)_createQRCodeInstructionLabelIfNecessary
{
  if (!self->__qrCodeInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:16])
  {
    v3 = [CAMQRCodeInstructionLabel alloc];
    v4 = [(CAMInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    qrCodeInstructionLabel = self->__qrCodeInstructionLabel;
    self->__qrCodeInstructionLabel = v4;

    [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedQRCodeInstructionLabel];
  }
}

- (void)_updateQRCodeInstructionLabelForCurrentState
{
  v5 = [(CAMViewfinderViewController *)self _targetQRCodeInstructionLabel];
  v3 = [(CAMViewfinderViewController *)self _currentDevice]- 1;
  if (v3 > 0xA)
  {
    v4 = 0;
  }

  else
  {
    v4 = qword_1A3A685B0[v3];
  }

  [v5 setDevicePosition:v4];
  [v5 setMRCResults:MEMORY[0x1E695E0F0]];
}

- (int64_t)_currentDevice
{
  v2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [v2 device];

  return v3;
}

- (void)_destroyGridViewIfNecessary
{
  if (self->__gridView)
  {
    [(CAMViewfinderViewController *)self _unembedGridView];
    gridView = self->__gridView;
    self->__gridView = 0;
  }
}

- (void)_createOrDestroyLevelViewIfNecessary
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMUserPreferences preferences];
  v4 = [v6 shouldShowLevelView];
  v5 = [(CAMViewfinderViewController *)self _shouldCreateLevelViewForMode:v3];
  if (v4)
  {
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createLevelViewIfNecessary];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _destroyLevelViewIfNecessary];
  }
}

- (void)_destroyLevelViewIfNecessary
{
  if (self->__levelView)
  {
    [(CAMViewfinderViewController *)self _unembedLevelView];
    levelView = self->__levelView;
    self->__levelView = 0;
  }
}

- (BOOL)_shouldEnableFlashButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableHDRButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableTimerButton
{
  v3 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v4 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v5 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 isCapturingNightModeImage];

  return (((v3 || v4 || v5) | v7) & 1) == 0;
}

- (BOOL)_shouldEnableLivePhotoButton
{
  v3 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 isCapturingNightModeImage];

  return ((v3 | v5) & 1) == 0;
}

- (BOOL)_shouldEnableFlipButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isConfigurationAvailable];
  LOBYTE(v2) = ![(CAMViewfinderViewController *)v2 _isOutOfDiskSpace];

  return v4 & v2;
}

- (unint64_t)_reasonsToDisableShutterButton
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = 1;
  if (v3 <= 9 && ((1 << v3) & 0x3D7) != 0)
  {
    if ([v5 isCapturingNightModeImage])
    {
      v6 = [(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable];
    }

    else
    {
      v6 = [v5 isCaptureAvailable];
    }
  }

  v29 = v6;
  v28 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  if ([v5 isCapturingNightModeImage] && -[CAMViewfinderViewController _isCurrentNightModeCaptureCancelable](self, "_isCurrentNightModeCaptureCancelable"))
  {
    v7 = 1;
  }

  else
  {
    v7 = ![(CAMViewfinderViewController *)self isPreventingAdditionalCaptures];
  }

  v27 = v7;
  v26 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v8 = [v26 isViewfinderClosed];
  v9 = [(CAMViewfinderViewController *)self _isOpeningViewfinder];
  v10 = [(CAMViewfinderViewController *)self _isClosingViewfinder];
  v11 = [v5 isInterrupted];
  v12 = 0;
  v30 = v5;
  if ((v11 & 1) == 0 && v9)
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    if ([v13 allowCaptureWhileViewfinderIsOpeningForMode:v3 devicePosition:v4])
    {
      v12 = 0;
    }

    else
    {
      v12 = ![(CAMViewfinderViewController *)self isEmulatingImagePicker];
    }
  }

  v14 = v8 | v10;
  v15 = v11 ^ 1;
  v16 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v17 = [(CAMViewfinderViewController *)self _storageController];
  v18 = [v17 purgeableStorageContainer];
  v19 = [v18 isPurging];

  v20 = +[CAMCaptureCapabilities capabilities];
  v21 = [v20 isProResVideoSupportedForMode:v3 videoConfiguration:-[CAMViewfinderViewController _currentVideoConfiguration](self outputToExternalStorage:"_currentVideoConfiguration") frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  v22 = [(CAMViewfinderViewController *)self _desiredProResVideoMode]== 1;
  v23 = v29 ^ 1u;
  if (v28)
  {
    v23 |= 2uLL;
  }

  if ((v15 & v14) != 0)
  {
    v23 |= 4uLL;
  }

  if (v12)
  {
    v23 |= 0x40uLL;
  }

  if (!v27)
  {
    v23 |= 8uLL;
  }

  if (v16)
  {
    v23 |= 0x10uLL;
  }

  if ((v19 & v21 & v22) != 0)
  {
    v24 = v23 | 0x80;
  }

  else
  {
    v24 = v23;
  }

  return v24;
}

- (BOOL)_shouldEnableFilterButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableModeDial
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isConfigurationAvailable];
  v5 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v6];

  v8 = !v5 & ([(CAMViewfinderViewController *)self _layoutStyle]== 1 || v7);
  if (v4)
  {
    v9 = v8;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_shouldEnableZoomControl
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v5 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v6 = ((v4 || v5) | [v3 isCapturingNightModeImage]) ^ 1;
  if ([(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice])
  {
    LOBYTE(v6) = v6 & [v3 isConfigurationAvailable];
  }

  return v6 & 1;
}

- (BOOL)_shouldShowShutterButtonDisabled
{
  v3 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  if ([v4 isCapturingNightModeImage])
  {
    v5 = ![(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable];
  }

  else
  {
    v5 = 0;
  }

  v6 = v5 | [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling];
  if (v3)
  {
    v7 = 1;
  }

  else
  {
    v7 = v6;
  }

  return v7 & 1;
}

- (BOOL)_shouldEnableSwipeToModeSwitch
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldHideModeDialForGraphConfiguration:v3 isCapturingBurst:0];

  LODWORD(v3) = [(CAMViewfinderViewController *)self _shouldEnableModeDial];
  v5 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v6 isSemanticStyleControlVisible];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 isSmartStylePickerVisible];

  return ((v3 ^ 1 | v4 | v5 | v7 | v9 | [(CAMViewfinderViewController *)self _trueVideoIsActive]) & 1) == 0;
}

- (CGAffineTransform)customPreviewViewTransform
{
  v3 = *&self[57].d;
  *&retstr->a = *&self[57].b;
  *&retstr->c = v3;
  *&retstr->tx = *&self[57].ty;
  return self;
}

- (BOOL)shouldHideLightingControl
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideLightingControlForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideFilterNameBadge
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideFilterNameBadgeForGraphConfiguration:v3];

  return v2;
}

- (void)_updateHomeIndicatorBehaviorsForCaptureOrientation
{
  if ([(CAMViewfinderViewController *)self _layoutStyle]== 3)
  {
    v6 = [(CAMViewfinderViewController *)self _motionController];
    v3 = [v6 captureOrientation];
    v4 = [MEMORY[0x1E69DC668] sharedApplication];
    v5 = +[CAMCaptureCapabilities capabilities];
    if (([v5 hostProcess] | 4) == 4)
    {
      [v4 _setReachabilitySupported:(v3 - 5) < 0xFFFFFFFFFFFFFFFELL];
    }

    [(CAMViewfinderViewController *)self _setHomeIndicatorAutoHideOrientation:v3];
  }
}

- (void)_updatePortraitModeInstructionLabelForCurrentState
{
  v10 = [(CAMViewfinderViewController *)self _targetPortraitModeInstructionLabel];
  v3 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:[(CAMViewfinderViewController *)self _currentMode] flashActive:0];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isFlashOrTorchSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ([(CAMViewfinderViewController *)self _currentMode]== 1)
  {
    v5 = ([(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode]!= 1) & v5;
  }

  [v10 setShallowDepthOfFieldStatus:{-[CAMViewfinderViewController _shallowDepthOfFieldStatus](self, "_shallowDepthOfFieldStatus")}];
  [v10 setFlashSupported:v5];
  [v10 setFlashMode:v3];
  v6 = [(CAMViewfinderViewController *)self _currentDevice]- 1;
  if (v6 > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[v6];
  }

  [v10 setDevicePosition:v7];
  [v10 setLightingType:{-[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice"))}];
  [v10 setNightMode:{-[CAMViewfinderViewController _resolvedNightMode](self, "_resolvedNightMode")}];
  v8 = [(CAMViewfinderViewController *)self _captureController];
  [v10 setNightModeStatus:{objc_msgSend(v8, "nightModeStatus")}];

  v9 = +[CAMCaptureCapabilities capabilities];
  [v10 setNightModePortraitSupported:{objc_msgSend(v9, "isNightModeWithDepthSupportedForMode:device:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice"))}];
}

- (BOOL)prefersHomeIndicatorAutoHidden
{
  v3 = [(CAMViewfinderViewController *)self _homeIndicatorAutoHideOrientation];

  return [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:v3];
}

- (void)viewWillLayoutSubviews
{
  v3.receiver = self;
  v3.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v3 viewWillLayoutSubviews];
  [(CAMViewfinderViewController *)self _updateLayoutStyle];
  [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
}

- (BOOL)shouldShiftPreviewForUtilityBar
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideUtilityBarForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (double)_currentMaximumZoomFactor
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v3 maximumZoomFactorForMode:objc_msgSend(v4 device:"mode") videoConfiguration:objc_msgSend(v4 videoStabilizationStrength:{"device"), objc_msgSend(v4, "videoConfiguration"), objc_msgSend(v4, "videoStabilizationStrength")}];
  v6 = v5;

  return v6;
}

- (void)_updateFlashButtonAvailability
{
  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v4 = [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:v3];

    if (v4)
    {
      v5 = [(CAMViewfinderViewController *)self _isFlashUnavailableForMode:[(CAMViewfinderViewController *)self _currentMode]];
      v6 = [(CAMViewfinderViewController *)self _flashButton];
      [v6 setUnavailable:v5];

      v7 = [(CAMViewfinderViewController *)self _controlDrawer];
      v8 = [v7 flashButton];
      [v8 setFlashUnavailable:v5];

      v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v10 = [v9 controlStatusBar];
      v11 = [v10 flashIndicator];
      [v11 setFlashUnavailable:v5];

      v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
      v13 = [(CAMViewfinderViewController *)self _captureController];
      [v12 setIsFlashCurrentlyUnavailable:{objc_msgSend(v13, "isFlashAvailable") ^ 1}];

      v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
      v14 = [(CAMViewfinderViewController *)self _captureController];
      [v15 setIsTorchCurrentlyUnavailable:{objc_msgSend(v14, "isTorchAvailable") ^ 1}];
    }
  }
}

- (void)_openViewfinderForAllModeAndDeviceChangeReasons
{
  v2 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v2 removeClosedViewfinderReason:0];
  [v2 removeClosedViewfinderReason:1];
}

- (unint64_t)_shutterButtonFeedbackForCurrentConfiguration
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  if (v3 > 9)
  {
    return 0;
  }

  if (((1 << v3) & 0x1AE) != 0)
  {
    v4 = [(CAMViewfinderViewController *)self _captureController];
    if ([v4 isCapturingTimelapse] & 1) != 0 || (objc_msgSend(v4, "isCapturingVideo"))
    {
      v5 = 2;
    }

    else if ([v4 isCapturingPanorama])
    {
      v5 = 2;
    }

    else
    {
      v5 = 1;
    }
  }

  else if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    return 2;
  }

  else
  {
    return [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
  }

  return v5;
}

- (BOOL)_shouldCaptureWithTimer
{
  v3 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v4 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
  return (v4 != 0) & ~v3 & ![(CAMViewfinderViewController *)self isEmulatingImagePicker];
}

- (BOOL)_shouldReportUserInitiationTimeForCurrentSettings
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 hostProcess] & 0xFFFFFFFFFFFFFFFBLL;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingBurst];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    LOBYTE(v7) = 0;
  }

  else
  {
    v7 = ![(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
  }

  v8 = (v6 ^ 1) & v7;
  if (v4)
  {
    v9 = 0;
  }

  else
  {
    v9 = v8;
  }

  return v9;
}

- (void)_teardownBurstTimer
{
  v3 = [(CAMViewfinderViewController *)self _currentBurstTimer];
  [v3 invalidate];
  [(CAMViewfinderViewController *)self _setCurrentBurstTimer:0];
}

- (BOOL)_captureStillImageWithCurrentSettings
{
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  v3 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
  v4 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v3 burst:0];
  v5 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v6 = [v3 persistenceUUID];
  [v5 setObject:v4 forKey:v6];

  v7 = [(CAMViewfinderViewController *)self _captureStillImageWithRequest:v3 error:0];
  if (v7)
  {
    [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
    v8 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [v8 viewfinderViewController:self willCaptureStillImageForRequest:v3];

    v9 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [v9 didCaptureWithRequest:v3 currentConfiguration:v10];
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to capture still image capture"];
  }

  return v7;
}

- (int64_t)_currentCaptureRequestOrigin
{
  v2 = +[CAMCaptureCapabilities capabilities];
  v3 = ([v2 hostProcess] - 1) < 2;

  return v3;
}

- (void)_updateUserPreferencesForFilterUsage
{
  v4 = +[CAMUserPreferences preferences];
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  switch(v3)
  {
    case 6:
      [v4 setPortraitModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _portraitModeEffectFilterType](self, "_portraitModeEffectFilterType")}];
      break;
    case 4:
      [v4 setSquareModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _squareModeEffectFilterType](self, "_squareModeEffectFilterType")}];
      break;
    case 0:
      [v4 setPhotoModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _photoModeEffectFilterType](self, "_photoModeEffectFilterType")}];
      break;
  }

  MEMORY[0x1EEE66BB8]();
}

- (void)_updateFilterScrubberAfterCapture
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isLiveFilteringSupported];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:[(CAMViewfinderViewController *)self _effectFilterTypeForMode:[(CAMViewfinderViewController *)self _currentMode]]];
    v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v6 setFiltersMarkedIndex:v5];
  }
}

- (BOOL)shouldHideElapsedTimeView
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)v2 _motionController];
  LOBYTE(v2) = -[CAMViewfinderViewController _shouldHideElapsedTimeViewForGraphConfiguration:orientation:](v2, "_shouldHideElapsedTimeViewForGraphConfiguration:orientation:", v3, [v4 captureOrientation]);

  return v2;
}

- (BOOL)shouldHideTopBar
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideTopBarForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHidePortraitModeInstructionLabel
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHidePortraitModeInstructionLabelForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideQRCodeInstructionLabel
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideQRCodeInstructionLabelForGraphConfiguration:v3];

  return v2;
}

- (void)_writeUserPreferences
{
  if (![(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v53 = +[CAMUserPreferences preferences];
    v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v4 = [v3 mode];
    v5 = [v3 device];
    v52 = v3;
    v48 = [v3 videoConfiguration];
    v47 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
    v46 = [(CAMViewfinderViewController *)self _desiredTorchMode];
    v45 = [(CAMViewfinderViewController *)self _resolvedHDRMode];
    v51 = [(CAMViewfinderViewController *)self _desiredLivePhotoMode];
    v44 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
    v43 = [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
    v42 = [(CAMViewfinderViewController *)self _squareModeEffectFilterType];
    v41 = [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
    v6 = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v7 = [v6 isCallActive];

    v49 = v5;
    v40 = [v53 audioConfigurationForMode:v4 device:v5 emulationMode:-[CAMViewfinderViewController emulationMode](self duringCall:{"emulationMode"), v7}];
    v39 = v4;
    if ([v53 shouldMirrorFrontCameraCaptures])
    {
      v8 = +[CAMCaptureCapabilities capabilities];
      v37 = [v8 mirroredFrontCapturesSupportedForMode:v4];
    }

    else
    {
      v37 = 0;
    }

    v36 = [CAMCaptureConfiguration alloc];
    v38 = [v53 shouldMixAudioWithOthers];
    v35 = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
    v34 = [(CAMViewfinderViewController *)self portraitModeLightingEffectType];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v10 = v9;
    [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
    v12 = v11;
    v33 = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
    v32 = [(CAMViewfinderViewController *)self _resolvedMacroMode];
    v31 = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
    v30 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
    v13 = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
    v14 = [(CAMViewfinderViewController *)self _semanticStyles];
    v15 = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    v16 = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    v17 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
    v18 = [v53 isZoomPIPEnabled];
    v19 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    v20 = [(CAMViewfinderViewController *)self _librarySelectionController];
    v21 = [v20 sharedLibraryMode];
    LOBYTE(v29) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
    BYTE1(v28) = v19;
    LOBYTE(v28) = v18;
    LOBYTE(v27) = v37;
    v50 = [(CAMCaptureConfiguration *)v36 initWithCaptureMode:v39 captureDevice:v49 videoConfiguration:v48 audioConfiguration:v40 mixAudioWithOthers:v38 flashMode:v47 torchMode:v10 HDRMode:v12 irisMode:v46 timerDuration:v45 photoModeAspectRatioCrop:v51 photoModeEffectFilterType:v44 squareModeEffectFilterType:v35 portraitModeEffectFilterType:v43 portraitModeLightingEffectType:v42 portraitModeApertureValue:v41 portraitModeIntensityValue:v34 mirrorFrontCameraCaptures:v27 exposureBiasesByMode:v33 macroMode:v32 photoResolution:v31 rawMode:v30 proResVideoMode:v13 semanticStyles:v14 selectedSemanticStyleIndex:v15 smartStyleSystemStyleIndex:v16 videoStabilizationMode:v17 zoomPIPEnabled:v28 optionalDepthEffectEnabled:v21 sharedLibraryMode:v29 frontRearSimultaneousVideoEnabled:?];

    v22 = [[CAMConflictingControlConfiguration alloc] initWithDesiredFlashMode:[(CAMViewfinderViewController *)self _desiredFlashMode] desiredHDRMode:[(CAMViewfinderViewController *)self _desiredHDRMode] desiredLivePhotoMode:v51 desiredRAWMode:[(CAMViewfinderViewController *)self _desiredRAWMode] desiredPhotoResolution:[(CAMViewfinderViewController *)self _desiredPhotoResolution] photoFormatConflicts:[(CAMViewfinderViewController *)self _photoFormatConflicts] desiredNightModeControlMode:[(CAMViewfinderViewController *)self _desiredNightModeControlMode] nightModeConflicts:[(CAMViewfinderViewController *)self _nightModeConflicts] desiredMacroMode:[(CAMViewfinderViewController *)self _desiredMacroMode]];
    [v53 setCaptureConfiguration:v50];
    [v53 setConflictingControlConfiguration:v22];
    v23 = [(CAMViewfinderViewController *)self _openHalfPressSpotlightControls];
    if (v23)
    {
      [v53 setOpenHalfPressSpotlightControls:v23];
    }

    v24 = [(CAMViewfinderViewController *)self _controlDrawer];

    if (v24)
    {
      v25 = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
      v26 = [v25 copy];
      [v53 setPreferredDrawerControlByMode:v26];
    }

    [v53 setWantsSmartFramingAutoZoomDefault:{-[CAMViewfinderViewController _wantsSmartFramingAutoZoomDefault](self, "_wantsSmartFramingAutoZoomDefault")}];
    [v53 setWantsSmartFramingAutoRotationDefault:{-[CAMViewfinderViewController _wantsSmartFramingAutoRotationDefault](self, "_wantsSmartFramingAutoRotationDefault")}];
    [v53 writePreferences];
  }
}

- (void)_updatePanoramaViewVisibilityForViewfinderTransition
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldHidePanoramaViewForGraphConfiguration:v3];
  v5 = [(CAMViewfinderViewController *)self _panoramaViewController];
  v6 = MEMORY[0x1E69DD250];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __83__CAMViewfinderViewController__updatePanoramaViewVisibilityForViewfinderTransition__block_invoke;
  v8[3] = &unk_1E76F7850;
  v9 = v5;
  v10 = v4;
  v7 = v5;
  [v6 animateWithDuration:v8 animations:0.25];
}

- (void)_ensureSensitiveContentHidden
{
  v3 = [(CAMViewfinderViewController *)self _imageWell];
  [v3 setThumbnailImage:0 uuid:0 animated:0];

  [(CAMViewfinderViewController *)self setPresentedImageWellImage:0];
  v4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v4 removeThumbnailImage];

  v5 = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [v5 removeInflightBlurAnimations];
}

- (CAMViewfinderViewController)initWithCaptureController:(id)a3 captureConfiguration:(id)a4 conflictingControlConfiguration:(id)a5 locationController:(id)a6 motionController:(id)a7 timelapseController:(id)a8 keepAliveController:(id)a9 remoteShutterController:(id)a10 powerController:(id)a11 cameraRollController:(id)a12 librarySelectionController:(id)a13 callStatusMonitor:(id)a14 storageController:(id)a15 usingEmulationMode:(int64_t)a16 initialLayoutStyle:(int64_t)a17 options:(int64_t)a18
{
  v98 = a3;
  v23 = a4;
  v24 = a5;
  v108 = a6;
  v110 = a7;
  v95 = a8;
  v109 = a8;
  v107 = a9;
  v106 = a10;
  v105 = a11;
  v104 = a12;
  v103 = a13;
  v102 = a14;
  v101 = a15;
  v111.receiver = self;
  v111.super_class = CAMViewfinderViewController;
  v25 = [(CAMViewfinderViewController *)&v111 initWithNibName:0 bundle:0];
  v26 = v25;
  if (v25)
  {
    v97 = v24;
    v100 = v23;
    v25->_options = a18;
    v27 = [(CAMViewfinderViewController *)v25 _supportedCaptureModes];
    availableCaptureModes = v26->_availableCaptureModes;
    v26->_availableCaptureModes = v27;

    [(CAMViewfinderViewController *)v26 _updateDuetSystemConstraintsIfNecessary];
    v29 = +[CAMCaptureCapabilities capabilities];
    v26->__layoutStyle = a17;
    v26->__useMessagesControls = a18 & 1;
    v26->__currentlyPressedButton = -1;
    objc_storeStrong(&v26->__captureController, a3);
    objc_storeStrong(&v26->__locationController, a6);
    objc_storeStrong(&v26->__motionController, a7);
    objc_storeStrong(&v26->__timelapseController, v95);
    objc_storeStrong(&v26->__keepAliveController, a9);
    objc_storeStrong(&v26->__remoteShutterController, a10);
    objc_storeStrong(&v26->__powerController, a11);
    objc_storeStrong(&v26->__cameraRollController, a12);
    objc_storeStrong(&v26->__callStatusMonitor, a14);
    objc_storeStrong(&v26->__storageController, a15);
    [(CAMStorageController *)v26->__storageController setDelegate:v26];
    v30 = [[CAMPreviewViewController alloc] initWithCaptureController:v98 motionController:v110 timelapseController:v109];
    previewViewController = v26->__previewViewController;
    v26->__previewViewController = v30;

    [(CAMPreviewViewController *)v26->__previewViewController setDelegate:v26];
    [(CAMPreviewViewController *)v26->__previewViewController setLayoutStyle:a17];
    [(CAMViewfinderViewController *)v26 addChildViewController:v26->__previewViewController];
    v32 = objc_alloc_init(CAMViewfinderTransitionController);
    transitionController = v26->__transitionController;
    v26->__transitionController = v32;

    v34 = [[CAMTorchPatternController alloc] initWithCaptureController:v98];
    torchPatternController = v26->__torchPatternController;
    v26->__torchPatternController = v34;

    [(CAMCameraRollController *)v26->__cameraRollController setImageWellDelegate:v26];
    [(CAMCameraRollController *)v26->__cameraRollController setSessionDelegate:v26];
    [(CAMCameraRollController *)v26->__cameraRollController setPresentationDelegate:v26];
    v36 = objc_alloc_init(CAMIdleController);
    idleController = v26->__idleController;
    v26->__idleController = v36;

    v38 = objc_alloc_init(CAMClosedViewfinderController);
    closedViewfinderController = v26->__closedViewfinderController;
    v26->__closedViewfinderController = v38;

    [(CAMClosedViewfinderController *)v26->__closedViewfinderController setDelegate:v26];
    v40 = objc_alloc_init(CAMDisabledPreviewController);
    disabledPreviewController = v26->__disabledPreviewController;
    v26->__disabledPreviewController = v40;

    [(CAMDisabledPreviewController *)v26->__disabledPreviewController setDelegate:v26];
    if ([v29 librarySelectionSupported])
    {
      objc_storeStrong(&v26->__librarySelectionController, a13);
      [(CAMLibrarySelectionController *)v26->__librarySelectionController setDelegate:v26];
    }

    v42 = objc_alloc_init(MEMORY[0x1E695DF90]);
    preferredControlToOpenInDrawerForMode = v26->__preferredControlToOpenInDrawerForMode;
    v26->__preferredControlToOpenInDrawerForMode = v42;

    v26->_emulationMode = a16;
    v26->_showingStandardControls = 1;
    v26->_maximumVideoRecordingDuration = 0.0;
    customOverlayView = v26->_customOverlayView;
    v26->_customOverlayView = 0;

    v45 = MEMORY[0x1E695EFD0];
    v46 = *(MEMORY[0x1E695EFD0] + 16);
    *&v26->_customPreviewViewTransform.a = *MEMORY[0x1E695EFD0];
    *&v26->_customPreviewViewTransform.c = v46;
    *&v26->_customPreviewViewTransform.tx = *(v45 + 32);
    v47 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", v100, -[CAMViewfinderViewController _externalStorageOutputEnabled](v26, "_externalStorageOutputEnabled"), [v110 captureOrientation]);
    [(CAMViewfinderViewController *)v26 _createChromeConfiguratorWithGraphConfiguration:v47];
    v48 = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v49 = +[CAMCaptureCapabilities capabilities];
    [v49 minimumPortraitEffectIntensity];
    [v48 setPortraitEffectIntensityMinimum:?];

    v50 = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v51 = +[CAMCaptureCapabilities capabilities];
    [v51 maximumPortraitEffectIntensity];
    [v50 setPortraitEffectIntensityMaximum:?];

    v52 = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v53 = +[CAMCaptureCapabilities capabilities];
    [v53 defaultPortraitEffectIntensity];
    [v52 setPortraitEffectIntensityDefault:?];

    [(CAMPreviewViewController *)v26->__previewViewController setChromeConfigurator:v26->_chromeConfigurator];
    [(CAMViewfinderViewController *)v26 _updatePropertiesForCaptureConfiguration:v100 conflictingControlConfiguration:v97];
    objc_storeStrong(&v26->__configuredGraphConfiguration, v47);
    v26->__lastConfigurationRequestID = -1;
    v26->__stereoCaptureStatus = 1;
    [v29 zoomEventReportingInterval];
    v55 = -[CAMZoomEventReporter initWithRateLimit:reportingAllEvents:]([CAMZoomEventReporter alloc], "initWithRateLimit:reportingAllEvents:", [v29 zoomEventReportAllChanges], v54);
    zoomReporter = v26->__zoomReporter;
    v26->__zoomReporter = v55;

    [v98 setFacesDelegate:v26];
    [v98 setMachineReadableCodeDelegate:v26];
    [v98 setHistogramDelegate:v26];
    [v98 setTextRegionResultDelegate:v26];
    [v98 setDocumentSceneResultDelegate:v26];
    [v98 setConfigurationDelegate:v26];
    [v98 setSuggestionDelegate:v26];
    [v98 setAvailabilityDelegate:v26];
    [v98 setBurstDelegate:v26];
    [v98 setRecoveryDelegate:v26];
    [v98 setInterruptionDelegate:v26];
    [v98 setRunningDelegate:v26];
    [v98 setZoomDelegate:v26];
    [v98 setControlsDelegate:v26];
    [v98 setStillImageCapturingVideoDelegate:v26];
    [v98 setPreviewLayerOverCaptureStatusDelegate:v26];
    [v98 setSystemPressureStateDelegate:v26];
    [v98 setAudioCuePlaybackDelegate:v26];
    [v98 setStereoCaptureStatusDelegate:v26];
    [v98 setLensPositionDelegate:v26];
    [v98 setLensSmudgeStatusDelegate:v26];
    [v98 setConstituentDeviceDelegate:v26];
    [v98 setRecommendedSmartFramingDelegate:v26];
    v26->__shallowDepthOfFieldStatus = 0;
    [v98 setShallowDepthOfFieldStatusDelegate:v26];
    if ([v29 isLiveFilteringSupported])
    {
      [v98 registerVideoThumbnailContentsDelegate:v26];
    }

    v57 = +[CAMPriorityNotificationCenter defaultCenter];
    [v57 addObserver:v26 selector:sel__previewDidStartRunning_ name:*MEMORY[0x1E6986B70] object:0];
    [v57 addObserver:v26 selector:sel__captureOrientationChanged_ name:@"CAMMotionControllerCaptureOrientationChangedNotification" object:0];
    [v57 addObserver:v26 selector:sel__deviceOrientationChanged_ name:@"CAMMotionControllerCaptureDeviceOrientationChangedNotification" object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidBecomeActive_ name:*MEMORY[0x1E69DDAB0] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillResignActive_ name:*MEMORY[0x1E69DDBC8] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillAddDeactivationReason_ name:*MEMORY[0x1E69DE878] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidRemoveDeactivationReason_ name:*MEMORY[0x1E69DE840] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillEnterForeground_ name:*MEMORY[0x1E69DDBC0] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidEnterBackground_ name:*MEMORY[0x1E69DDAC8] object:0];
    [v57 addObserver:v26 selector:sel__handleSceneDidEnterBackground_ name:*MEMORY[0x1E69DE348] object:0];
    [v57 addObserver:v26 selector:sel__handleContentSizeCategoryDidChange_ name:*MEMORY[0x1E69DDC48] object:0];
    [v57 addObserver:v26 selector:sel__handleCallStatusMonitorDidChangeCallActive_ name:@"CAMCallStatusMonitorDidChangeCallActiveNotification" object:0];
    [v57 addObserver:v26 selector:sel__handleTimelapseLowDiskSpaceNotification_ name:@"CAMTimelapseLowDiskSpaceNotification" object:0];
    v96 = [MEMORY[0x1E696AD88] defaultCenter];
    [v96 addObserver:v26 selector:sel__handleSessionWasPrewarmed_ name:@"AVCaptureSessionWasPrewarmedNotification" object:0];
    v26->__overCapturePreviewStatus = 0;
    v58 = 3;
    if (!a16)
    {
      v58 = 0;
    }

    v26->_persistenceBehavior = v58;
    v59 = 1;
    if (!a16)
    {
      v59 = [v29 multipleCaptureFeaturesSupported] ^ 1;
    }

    v26->_disablingMultipleCaptureFeatures = v59;
    v26->__internalAutorotationStyle = [(CAMViewfinderViewController *)v26 _autorotationStyleForLayoutStyle:*(&v26->super.super.super.isa + v93)];
    v26->_automaticallyAdjustsAutorotationStyle = a16 == 0;
    v26->_automaticallyAdjustsApplicationIdleTimer = 1;
    v60 = [(CAMViewfinderViewController *)v26 _supportedCaptureModes];
    v61 = v26->_availableCaptureModes;
    v26->_availableCaptureModes = v60;

    v62 = objc_alloc_init(CAMMachineReadableCodeLoggingController);
    machineReadableCodeLoggingController = v26->__machineReadableCodeLoggingController;
    v26->__machineReadableCodeLoggingController = v62;

    if ([v29 isImageAnalysisSupported])
    {
      v64 = objc_alloc_init(CAMProminentObjectManager);
      prominentObjectManager = v26->__prominentObjectManager;
      v26->__prominentObjectManager = v64;

      [(CAMProminentObjectManager *)v26->__prominentObjectManager setDelegate:v26];
    }

    if ([v29 allowHaptics])
    {
      v66 = +[CAMFeedbackController sharedController];
      feedbackController = v26->__feedbackController;
      v26->__feedbackController = v66;
    }

    v68 = objc_alloc_init(MEMORY[0x1E695DF90]);
    descriptionOverlayViewByMode = v26->__descriptionOverlayViewByMode;
    v26->__descriptionOverlayViewByMode = v68;

    v70 = objc_alloc_init(CAMTimerCache);
    timerCache = v26->__timerCache;
    v26->__timerCache = v70;

    [(CAMTimerCache *)v26->__timerCache setDelegate:v26];
    [(CAMViewfinderViewController *)v26 setOverrideUserInterfaceStyle:2];
    [(CAMViewfinderViewController *)v26 generateAnalyticsSessionEventIfNeeded];
    if ([v29 externalStorageSupported])
    {
      v72 = objc_alloc_init(CAMExternalStorageMonitor);
      storageMonitor = v26->__storageMonitor;
      v26->__storageMonitor = v72;

      v74 = [(CAMViewfinderViewController *)v26 _storageMonitor];
      [v74 setDelegate:v26];
    }

    if ([v29 shouldPreventConnectionHandover])
    {
      v75 = objc_alloc_init(CAMPreventConnectionHandoverAssertionController);
      preventConnectionHandoverAssertionController = v26->__preventConnectionHandoverAssertionController;
      v26->__preventConnectionHandoverAssertionController = v75;
    }

    v77 = [CAMLensSmudgeDisplayState alloc];
    v78 = +[CAMCaptureCapabilities capabilities];
    v79 = [v78 smudgeDetectionAutoDismissTimeoutSeconds];
    v80 = +[CAMUserPreferences preferences];
    v81 = [(CAMLensSmudgeDisplayState *)v77 initWithDelegate:v26 devicePosition:1 displayDuration:v80 preferences:v79];
    lensSmudgeDisplayFrontState = v26->__lensSmudgeDisplayFrontState;
    v26->__lensSmudgeDisplayFrontState = v81;

    v83 = [CAMLensSmudgeDisplayState alloc];
    v84 = +[CAMCaptureCapabilities capabilities];
    v85 = [v84 smudgeDetectionAutoDismissTimeoutSeconds];
    v86 = +[CAMUserPreferences preferences];
    v87 = [(CAMLensSmudgeDisplayState *)v83 initWithDelegate:v26 devicePosition:0 displayDuration:v86 preferences:v85];
    lensSmudgeDisplayBackState = v26->__lensSmudgeDisplayBackState;
    v26->__lensSmudgeDisplayBackState = v87;

    v26->__smartFramingAutoZoomEnabled = 1;
    v26->__smartFramingAutoRotationEnabled = 1;
    v26->__frontRearSimultaneousVideoPIPAnchor = +[CAMPIPVideoPreviewView defaultAnchor];
    v89 = objc_alloc_init(MEMORY[0x1E695DF90]);
    analyticsEventsByIdentifier = v26->__analyticsEventsByIdentifier;
    v26->__analyticsEventsByIdentifier = v89;

    v91 = v26;
    v23 = v100;
    v24 = v97;
  }

  return v26;
}

- (void)dealloc
{
  v3 = +[CAMPriorityNotificationCenter defaultCenter];
  [v3 removeObserver:self];

  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:0];
  [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:0];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  [v4 invalidateController];

  v5.receiver = self;
  v5.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v5 dealloc];
}

- (int64_t)_currentDevicePosition
{
  v2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [v2 devicePosition];

  return v3;
}

- (int64_t)_currentVideoConfiguration
{
  v2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [v2 videoConfiguration];

  return v3;
}

- (int64_t)_configuredMode
{
  v2 = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  v3 = [v2 mode];

  return v3;
}

- (int64_t)_configuredDevice
{
  v2 = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  v3 = [v2 device];

  return v3;
}

- (void)_setCurrentGraphConfiguration:(id)a3
{
  v5 = a3;
  if (self->__currentGraphConfiguration != v5)
  {
    v8 = v5;
    objc_storeStrong(&self->__currentGraphConfiguration, a3);
    v6 = [(CAMViewfinderViewController *)self _storageController];
    [v6 setGraphConfiguration:v8];

    v7 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v7 setCurrentGraphConfiguration:v8];

    v5 = [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:v8];
  }

  MEMORY[0x1EEE66BE0](v5);
}

- (void)_updateChromeConfiguratorForCurrentGraphConfiguration:(id)a3
{
  v4 = a3;
  if (([v4 videoStabilizationStrength] & 0xFFFFFFFFFFFFFFFELL) == 2)
  {
    v5 = +[CAMUserPreferences preferences];
    [v5 setDidRecentlyUseActionMode];
  }

  [(CAMViewfinderViewController *)self _updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:v4];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __85__CAMViewfinderViewController__updateChromeConfiguratorForCurrentGraphConfiguration___block_invoke;
  v8[3] = &unk_1E76F7960;
  v8[4] = self;
  v9 = v4;
  v7 = v4;
  [v6 performChanges:v8];
}

void __85__CAMViewfinderViewController__updateChromeConfiguratorForCurrentGraphConfiguration___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _updateChromePhotoFormatsAndResolutions];
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setCaptureGraphConfiguration:v2];

  v4 = *(a1 + 32);
  v5 = [v4 _currentGraphConfiguration];
  v6 = [v4 _shouldShowSmartFramingAutoZoomForGraphConfiguration:v5];
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setIsSmartFramingAutoZoomSupported:v6];

  v8 = *(a1 + 32);
  v9 = [v8 _currentGraphConfiguration];
  v10 = [v8 _shouldShowSmartFramingAutoRotationForGraphConfiguration:v9];
  v11 = [*(a1 + 32) chromeConfigurator];
  [v11 setIsSmartFramingAutoRotationSupported:v10];

  v12 = +[CAMCaptureCapabilities capabilities];
  v13 = [v12 isLensPositionControlSupportedForMode:objc_msgSend(*(a1 + 40) device:"mode") videoConfiguration:objc_msgSend(*(a1 + 40) videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:{objc_msgSend(*(a1 + 40), "videoConfiguration"), objc_msgSend(*(a1 + 40), "videoStabilizationStrength"), objc_msgSend(*(a1 + 40), "frontRearSimultaneousVideoEnabled")}];
  v14 = [*(a1 + 32) chromeConfigurator];
  [v14 setIsLensPositionSupported:v13];

  v15 = +[CAMUserPreferences preferences];
  v16 = [v15 preserveExposure];
  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setPreserveExposure:v16];

  v18 = [*(a1 + 32) _captureController];
  [v18 lastObservedLensPosition];
  v20 = v19;
  v21 = [*(a1 + 32) chromeConfigurator];
  [v21 setLensPosition:v20];

  v22 = [*(a1 + 32) _aspectRatioCropForMode:objc_msgSend(*(a1 + 40) devicePosition:{"mode"), objc_msgSend(*(a1 + 40), "devicePosition")}];
  v23 = [*(a1 + 32) chromeConfigurator];
  [v23 setAspectRatioCrop:v22];

  v26 = +[CAMCaptureCapabilities capabilities];
  v24 = [v26 isNightModeSupportedForMode:objc_msgSend(*(a1 + 40) device:{"mode"), objc_msgSend(*(a1 + 40), "device")}];
  v25 = [*(a1 + 32) chromeConfigurator];
  [v25 setIsNightModeSupported:v24];
}

- (void)_updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:(id)a3
{
  v59 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [v4 videoEncodingBehavior];
  v6 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v53 = 0u;
  v54 = 0u;
  v55 = 0u;
  v56 = 0u;
  v7 = [&unk_1F16C92A8 countByEnumeratingWithState:&v53 objects:v58 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v54;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v54 != v9)
        {
          objc_enumerationMutation(&unk_1F16C92A8);
        }

        v11 = *(*(&v53 + 1) + 8 * i);
        if (-[CAMViewfinderViewController shouldSwitchToVideoConfiguration:videoEncodingBehavior:](self, "shouldSwitchToVideoConfiguration:videoEncodingBehavior:", [v11 intValue], v5))
        {
          [v6 addIndex:{objc_msgSend(v11, "integerValue")}];
        }
      }

      v8 = [&unk_1F16C92A8 countByEnumeratingWithState:&v53 objects:v58 count:16];
    }

    while (v8);
  }

  v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v12 setSupportedVideoConfigurationRawValues:v6];

  v13 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v14 = +[CAMUserPreferences preferences];
  v15 = [v14 videoEncodingBehaviorForConfiguration:0 mode:objc_msgSend(v4 desiredProResVideoMode:"mode") outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:{0, objc_msgSend(v4, "frontRearSimultaneousVideoEnabled")}];

  if (v15 <= 2)
  {
    [v13 addObject:qword_1E76F9DF8[v15]];
  }

  v16 = +[CAMUserPreferences preferences];
  v17 = [v16 allowExplicitProResColorSpace];

  if (v17)
  {
    v18 = +[CAMCaptureCapabilities capabilities];
    v19 = [v18 supportedProResColorSpaces];

    if ([v19 containsObject:&unk_1F16C7628])
    {
      [v13 addObject:&unk_1F16C7640];
    }

    if ([v19 containsObject:&unk_1F16C7610])
    {
      [v13 addObject:&unk_1F16C7628];
    }

    if (([v19 containsObject:&unk_1F16C7748] & 1) != 0 || objc_msgSend(v19, "containsObject:", &unk_1F16C75F8))
    {
      v20 = &unk_1F16C7610;
LABEL_25:
      v50 = v19;
      [v13 addObject:v20];
      goto LABEL_27;
    }
  }

  else
  {
    v21 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", [v4 mode], objc_msgSend(v4, "videoConfiguration"), objc_msgSend(v4, "videoEncodingBehavior"), objc_msgSend(v4, "device"));
    v22 = [MEMORY[0x1E696AD98] numberWithInteger:v21];
    v57 = v22;
    v19 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v57 count:1];

    if (([v19 containsObject:&unk_1F16C7748] & 1) != 0 || objc_msgSend(v19, "containsObject:", &unk_1F16C75F8))
    {
      [v13 addObject:&unk_1F16C7610];
    }

    if ([v19 containsObject:&unk_1F16C7610])
    {
      v20 = &unk_1F16C7628;
      goto LABEL_25;
    }
  }

  v50 = v19;
LABEL_27:
  v23 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v51 = v13;
  [v23 setSupportedVideoFormatsRawValues:v13];

  v24 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:v4];
  v25 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v25 setIsProResControlEnabled:v24];

  v26 = [(CAMViewfinderViewController *)self _currentVideoChromeVideoFormat];
  v27 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v27 setVideoFormat:v26];

  v28 = -[CAMViewfinderViewController _sanitizedVideoConfigurationForMode:device:allowOverrides:](self, "_sanitizedVideoConfigurationForMode:device:allowOverrides:", [v4 mode], objc_msgSend(v4, "devicePosition") == 1, 0);
  v29 = +[CAMCaptureCapabilities capabilities];
  v30 = [v4 mode];
  v31 = [v4 device];
  v32 = [v4 videoEncodingBehavior];
  v33 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v34 = [v4 prefersHDR10BitVideo];
  LOBYTE(v49) = [v4 frontRearSimultaneousVideoEnabled];
  v35 = [v29 resolvedVideoConfigurationForMode:v30 device:v31 videoEncodingBehavior:v32 videoConfiguration:v28 outputToExternalStorage:v33 prefersHDR10BitVideo:v34 frontRearSimultaneousVideoEnabled:v49];

  v36 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v36 setCurrentDefaultVideoConfiguration:v35];

  v37 = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
  v38 = +[CAMUserPreferences preferences];
  v39 = [v38 videoEncodingBehaviorForConfiguration:v35 mode:objc_msgSend(v4 desiredProResVideoMode:"mode") outputToExternalStorage:v37 frontRearSimultaneousVideoEnabled:{0, objc_msgSend(v4, "frontRearSimultaneousVideoEnabled")}];

  v40 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v52[0] = MEMORY[0x1E69E9820];
  v52[1] = 3221225472;
  v52[2] = __107__CAMViewfinderViewController__updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration___block_invoke;
  v52[3] = &unk_1E76F7A38;
  v52[4] = self;
  v52[5] = v39;
  [v40 performChanges:v52];

  v41 = +[CAMUserPreferences preferences];
  v42 = [v41 alwaysShowActionModeIndicator];
  if (v42)
  {
    v43 = 1;
  }

  else
  {
    v30 = +[CAMUserPreferences preferences];
    v43 = [v30 didRecentlyUseActionMode];
  }

  v44 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v44 setShowActionModeIndicator:v43];

  if ((v42 & 1) == 0)
  {
  }

  v45 = +[CAMUserPreferences preferences];
  v46 = [v45 alwaysShowFrontPIPIndicator];
  if (v46)
  {
    v47 = 1;
  }

  else
  {
    v30 = +[CAMUserPreferences preferences];
    v47 = [v30 didRecentlyUseFrontPIP];
  }

  v48 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v48 setShowFrontPIPIndicator:v47];

  if ((v46 & 1) == 0)
  {
  }
}

void __107__CAMViewfinderViewController__updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration___block_invoke(uint64_t a1)
{
  v2 = +[CAMUserPreferences preferences];
  v3 = [v2 explicitProResColorSpace];
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setExplicitProResColorSpace:v3];

  v5 = *(a1 + 40);
  v6 = [*(a1 + 32) chromeConfigurator];
  [v6 setCurrentDefaultVideoEncodingBehavior:v5];
}

- (int64_t)_currentVideoChromeVideoFormat
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 videoEncodingBehavior];

  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 videoConfiguration];
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", v5, v7, v4, [v8 device]);

  if (v4 != 2)
  {
    return v4 == 1;
  }

  if (v9 > 3)
  {
    return 0;
  }

  return qword_1A3A68330[v9];
}

- (void)_updatePropertiesForCaptureConfiguration:(id)a3 conflictingControlConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = +[CAMUserPreferences preferences];
  self->__desiredFlashMode = [v7 desiredFlashMode];
  self->__desiredHDRMode = [v7 desiredHDRMode];
  self->__desiredLivePhotoMode = [v7 desiredLivePhotoMode];
  self->__desiredRAWMode = [v7 desiredRAWMode];
  self->__desiredPhotoResolution = [v7 desiredPhotoResolution];
  self->__photoFormatConflicts = [v7 photoFormatConflicts];
  self->__desiredMacroMode = [v7 desiredMacroMode];
  self->__desiredProResVideoMode = [v6 proResVideoMode];
  v9 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v10 = [(CAMViewfinderViewController *)self _motionController];
  v11 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", v6, v9, [v10 captureOrientation]);

  [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:v11];
  self->__resolvedFlashMode = [v6 flashMode];
  self->__resolvedHDRMode = [v6 HDRMode];
  self->__desiredTorchMode = [v6 torchMode];
  self->__resolvedTorchMode = [(CAMViewfinderViewController *)self _resolvedTorchModeForGraphConfiguration:v11];
  self->__resolvedTimerDuration = [v6 timerDuration];
  self->_photoModeAspectRatioCrop = [v6 photoModeAspectRatioCrop];
  self->__photoModeEffectFilterType = [v6 photoModeEffectFilterType];
  self->__squareModeEffectFilterType = [v6 squareModeEffectFilterType];
  self->__portraitModeEffectFilterType = [v6 portraitModeEffectFilterType];
  self->__resolvedLivePhotoMode = [v6 irisMode];
  self->_portraitModeLightingEffectType = [v6 portraitModeLightingEffectType];
  [v6 portraitModeApertureValue];
  self->__portraitModeApertureValue = v12;
  [v6 portraitModeIntensityValue];
  self->__portraitModeIntensityValue = v13;
  v14 = [v6 exposureBiasesByMode];
  v15 = [v14 mutableCopy];
  exposureBiasesByMode = self->__exposureBiasesByMode;
  self->__exposureBiasesByMode = v15;

  self->__resolvedMacroMode = [v6 macroMode];
  self->__resolvedPhotoResolution = [v6 photoResolution];
  self->__resolvedRAWMode = [v6 rawMode];
  v17 = [v6 semanticStyles];
  v18 = [v17 mutableCopy];
  semanticStyles = self->__semanticStyles;
  self->__semanticStyles = v18;

  self->__selectedSemanticStyleIndex = [v6 selectedSemanticStyleIndex];
  self->__smartStyleSystemStyleIndex = [v6 smartStyleSystemStyleIndex];
  v20 = [v11 videoDynamicAspectRatio];
  if (v20 <= 2)
  {
    self->__wantsFlipAspectRatio = 0x100u >> (8 * v20);
  }

  v21 = [v11 smartFramingFieldOfView];
  if ((v21 - 1) >= 4)
  {
    if (!v21)
    {
      v22 = [(CAMViewfinderViewController *)self _motionController];
      self->__desiredFieldOfView = -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [v22 captureOrientation]);
    }
  }

  else
  {
    self->__desiredFieldOfView = [v11 smartFramingFieldOfView];
  }

  [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:1];
  [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:1];
  [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
  v23 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v24 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v49[0] = MEMORY[0x1E69E9820];
  v49[1] = 3221225472;
  v49[2] = __104__CAMViewfinderViewController__updatePropertiesForCaptureConfiguration_conflictingControlConfiguration___block_invoke;
  v49[3] = &unk_1E76F7960;
  v25 = v23;
  v50 = v25;
  v51 = self;
  [v24 performChanges:v49];

  self->__desiredVideoStabilizationMode = [v6 videoStabilizationMode];
  v26 = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", v11, [v26 captureOrientation]);
  self->__cachedVideoZoomFactor = v27;

  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:v11 zoomFactor:?];
  v28 = +[CAMCaptureCapabilities capabilities];
  v29 = [v28 isNightModeSupported];

  if (v29)
  {
    v47 = v8;
    self->__desiredNightModeControlMode = [v7 desiredNightModeControlMode];
    v30 = [v7 nightModeConflicts];
    self->__nightModeConflicts = v30;
    v48 = v7;
    desiredNightModeControlMode = self->__desiredNightModeControlMode;
    resolvedFlashMode = self->__resolvedFlashMode;
    v32 = v25;
    v33 = [v11 mode];
    v34 = [v11 device];
    v35 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    v37 = v36;
    LOBYTE(v45) = [v6 optionalDepthEffectEnabled];
    v38 = desiredNightModeControlMode;
    v39 = v33;
    v25 = v32;
    v40 = v34;
    v8 = v47;
    v7 = v48;
    self->__resolvedNightModeControlMode = [CAMConflictingControlConfiguration resolveDesiredNightModeControlMode:v38 nightModeConflicts:v30 resolvedFlashMode:resolvedFlashMode captureMode:v39 captureDevice:v40 photoFormat:v35 depthEffectEnabledFromSuggestion:v37, v45];
  }

  self->__depthEffectEnabledFromSuggestion = [v6 optionalDepthEffectEnabled];
  self->encoding = [v8 photoFormatControlSecondaryFormat];
  self->resolution = v41;
  self->__lastZoomInteractionType = 0;
  self->__spatialModeHasVideoSelected = [v8 spatialModeHasVideoSelected];
  v42 = [v8 preferredDrawerControlByMode];
  if (v42)
  {
    v43 = [v8 preferredDrawerControlByMode];
    v44 = [v43 mutableCopy];
    [(CAMViewfinderViewController *)self set_preferredControlToOpenInDrawerForMode:v44];
  }

  else
  {
    v43 = objc_alloc_init(MEMORY[0x1E695DF90]);
    [(CAMViewfinderViewController *)self set_preferredControlToOpenInDrawerForMode:v43];
  }

  -[CAMViewfinderViewController set_chromeSelectedProResColorSpace:](self, "set_chromeSelectedProResColorSpace:", [v8 explicitProResColorSpace]);
  -[CAMViewfinderViewController _setWantsSmartFramingAutoZoomDefault:](self, "_setWantsSmartFramingAutoZoomDefault:", [v8 wantsSmartFramingAutoZoomDefault]);
  -[CAMViewfinderViewController _setWantsSmartFramingAutoRotationDefault:](self, "_setWantsSmartFramingAutoRotationDefault:", [v8 wantsSmartFramingAutoRotationDefault]);
}

uint64_t __104__CAMViewfinderViewController__updatePropertiesForCaptureConfiguration_conflictingControlConfiguration___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setFlashMode:{objc_msgSend(*(a1 + 40), "_resolvedFlashMode")}];
  [*(a1 + 32) setTorchMode:{objc_msgSend(*(a1 + 40), "_resolvedTorchMode")}];
  [*(a1 + 32) setHdrMode:{objc_msgSend(*(a1 + 40), "_resolvedHDRMode")}];
  v2 = *(a1 + 40);
  v3 = [v2 _currentMode];
  v4 = [*(a1 + 40) _currentGraphConfiguration];
  [v2 _exposureBiasForMode:v3 trueVideoEnabled:{objc_msgSend(v4, "trueVideoEnabled")}];
  [*(a1 + 32) setExposureBias:?];

  v5 = *(a1 + 40);

  return [v5 _updateChromeSharedLibraryState];
}

- (void)applyCaptureConfiguration:(id)a3 conflictingControlConfiguration:(id)a4
{
  [(CAMViewfinderViewController *)self _updatePropertiesForCaptureConfiguration:a3 conflictingControlConfiguration:a4];

  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
}

- (void)_reconfigureCaptureGraphWithCurrentMode
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _currentDevice];

  [(CAMViewfinderViewController *)self changeToMode:v3 device:v4];
}

- (void)_setLayoutStyle:(int64_t)a3
{
  layoutStyle = self->__layoutStyle;
  if (layoutStyle != a3)
  {
    self->__layoutStyle = a3;
    v6 = [(CAMViewfinderViewController *)self _panoramaViewController];
    [v6 setLayoutStyle:a3];

    v7 = [(CAMViewfinderViewController *)self viewfinderView];
    [v7 setLayoutStyle:a3];

    v8 = [(CAMViewfinderViewController *)self _previewViewController];
    [v8 setLayoutStyle:a3];

    v9 = [(CAMViewfinderViewController *)self _bottomBar];
    [v9 setLayoutStyle:a3];

    v10 = [(CAMViewfinderViewController *)self _flashButton];
    [v10 setLayoutStyle:a3];

    v11 = [(CAMViewfinderViewController *)self _elapsedTimeView];
    [v11 setLayoutStyle:a3];

    v12 = [(CAMViewfinderViewController *)self _HDRButton];
    [v12 setLayoutStyle:a3];

    v13 = [(CAMViewfinderViewController *)self _livePhotoButton];
    [v13 setLayoutStyle:a3];

    v14 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    [v14 setLayoutStyle:a3];

    v15 = [(CAMViewfinderViewController *)self _flipButton];
    [v15 setLayoutStyle:a3];

    v16 = [(CAMViewfinderViewController *)self _timerButton];
    [v16 setLayoutStyle:a3];

    v17 = [(CAMViewfinderViewController *)self _modeDial];
    [v17 setLayoutStyle:a3];

    v18 = [(CAMViewfinderViewController *)self _imageWell];
    [v18 setLayoutStyle:a3];

    v19 = [(CAMViewfinderViewController *)self _zoomSlider];
    [v19 setLayoutStyle:a3];

    v20 = [(CAMViewfinderViewController *)self _burstIndicatorView];
    [v20 setLayoutStyle:a3];

    v21 = [(CAMViewfinderViewController *)self _shutterButton];
    [v21 setLayoutStyle:a3];

    v22 = [(CAMViewfinderViewController *)self _controlDrawer];
    [v22 setLayoutStyle:a3];

    v23 = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
    [v23 setLayoutStyle:a3];

    [(CAMViewfinderViewController *)self _embedAllControlsWithLayoutStyle:a3];
    [(CAMViewfinderViewController *)self _updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:a3];
    [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
    if ([(CAMViewfinderViewController *)self automaticallyAdjustsAutorotationStyle])
    {
      [(CAMViewfinderViewController *)self _setInternalAutorotationStyle:[(CAMViewfinderViewController *)self _autorotationStyleForLayoutStyle:a3]];
    }

    [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
    v24 = [(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:layoutStyle];
    if (v24 != [(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:a3])
    {

      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
    }
  }
}

- (void)_updateLayoutStyle
{
  v3 = [(CAMViewfinderViewController *)self view];
  v4 = CAMLayoutStyleForView(v3);

  [(CAMViewfinderViewController *)self _setLayoutStyle:v4];
}

- (CGSize)_portraitOrientedSizeForSize:(CGSize)a3
{
  height = a3.height;
  width = a3.width;
  v5 = [(CAMViewfinderViewController *)self view];
  v6 = [v5 window];
  v7 = [v6 screen];

  [v7 _referenceBounds];
  v8 = width < height;
  if (v9 < v10)
  {
    v8 = width > height;
  }

  if (v8)
  {
    v11 = width;
  }

  else
  {
    v11 = height;
  }

  if (!v8)
  {
    height = width;
  }

  v12 = height;
  v13 = v11;
  result.height = v13;
  result.width = v12;
  return result;
}

- (CAMViewfinderTransitionable)_viewfinderTransitionable
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = v3;
  if (v3)
  {
    v5 = v3;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self viewfinderView];
  }

  v6 = v5;

  return v6;
}

- (CAMFullscreenViewfinder)_fullscreenViewfinder
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 wantsFullscreenViewfinder];

  if (v4)
  {
    if (([(CAMViewfinderViewController *)self isViewLoaded]& 1) != 0)
    {
      v5 = [(CAMViewfinderViewController *)self view];
      goto LABEL_8;
    }

    v6 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEBUG))
    {
      [CAMViewfinderViewController _fullscreenViewfinder];
    }
  }

  v5 = 0;
LABEL_8:

  return v5;
}

- (CAMControlDrawer)_controlDrawer
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 controlDrawer];

  return v3;
}

- (void)viewWillAppear:(BOOL)a3
{
  v3 = a3;
  v7.receiver = self;
  v7.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v7 viewWillAppear:?];
  v5 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v5 presentingViewControllerViewWillAppear:v3];

  v6 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v6 removeClosedViewfinderReason:8];
}

- (void)viewDidAppear:(BOOL)a3
{
  v3 = a3;
  v15.receiver = self;
  v15.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v15 viewDidAppear:?];
  [(CAMViewfinderViewController *)self _createCameraCaseShutterNotifierIfNeeded];
  [(CAMViewfinderViewController *)self _createPhysicalCaptureInteractionIfNeeded];
  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
  v5 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v5 setShowingPreview:1];

  v6 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v6 presentingViewControllerViewDidAppear:v3];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:v7 isShowingCameraRoll:0];
  if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
  }

  v8 = [(CAMViewfinderViewController *)self _librarySelectionController];
  v9 = CAMSharedLibraryModeIsOn([v8 sharedLibraryMode]);

  if (v9)
  {
    [(CAMViewfinderViewController *)self _startTimer:2];
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  }

  v10 = [(CAMViewfinderViewController *)self view];
  v11 = [v10 window];
  v12 = [v11 windowScene];
  [v12 _setSystemVolumeHUDEnabled:0];

  if (![(CAMViewfinderViewController *)self viewAlreadyDidAppear])
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    v14 = [v13 fallbackCameraEnabled];

    if (v14)
    {
      +[CAMFallbackConfiguration checkAvailableCameraModules];
    }
  }

  [(CAMViewfinderViewController *)self setViewAlreadyDidAppear:1];
}

- (void)viewWillDisappear:(BOOL)a3
{
  v3 = a3;
  v13.receiver = self;
  v13.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v13 viewWillDisappear:?];
  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:1];
  [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  v5 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v5 setShowingPreview:0];

  v6 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v6 presentingViewControllerViewWillDisappear:v3];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:1];
  v7 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v7 addClosedViewfinderReason:8];

  v8 = +[CAMUserPreferences preferences];
  LODWORD(v6) = [v8 sharedLibraryAutoBehaviorEnabled];

  if (v6)
  {
    v9 = [(CAMViewfinderViewController *)self _librarySelectionController];
    [v9 stopAcquiringSignals];
  }

  [(CAMViewfinderViewController *)self _writeUserPreferences];
  v10 = [(CAMViewfinderViewController *)self view];
  v11 = [v10 window];
  v12 = [v11 windowScene];
  [v12 _setSystemVolumeHUDEnabled:1];
}

- (BOOL)prefersInterfaceOrientationLocked
{
  if ([(CAMViewfinderViewController *)self autorotationStyle]!= 2)
  {
    return 0;
  }

  if ([(CAMViewfinderViewController *)self isRecording])
  {
    return 1;
  }

  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 isCapturingBurst];

  return v5;
}

- (unint64_t)_supportedInterfaceOrientationsForLayoutStyle:(int64_t)a3 wantsTextAnalysis:(BOOL)a4
{
  v28 = *MEMORY[0x1E69E9840];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 forceAllowAllInterfaceOrientations];

  if ([(CAMViewfinderViewController *)self _layoutStyle]!= 3)
  {
    return 30;
  }

  v8 = [(CAMViewfinderViewController *)self view];
  v9 = [v8 window];
  v10 = [v9 screen];

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v11 = [MEMORY[0x1E69DCEB0] screens];
  v12 = [v11 countByEnumeratingWithState:&v21 objects:v27 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v22;
    while (2)
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v22 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v21 + 1) + 8 * i);
        v17 = [v16 mirroredScreen];

        if (v10 && v17 == v10)
        {
          v19 = os_log_create("com.apple.camera", "Camera");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543362;
            v26 = v16;
            _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "Detected mirrored screen, allowing all interface orientations (%{public}@)", buf, 0xCu);
          }

          v18 = 30;
          goto LABEL_18;
        }
      }

      v13 = [v11 countByEnumeratingWithState:&v21 objects:v27 count:16];
      if (v13)
      {
        continue;
      }

      break;
    }
  }

  if ((a4 | v7))
  {
    v18 = 30;
  }

  else
  {
    v18 = 2;
  }

LABEL_18:

  return v18;
}

- (void)viewDidDisappear:(BOOL)a3
{
  v3 = a3;
  v8.receiver = self;
  v8.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v8 viewDidDisappear:?];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v5 setControlDrawerExpanded:0 forReason:7 animated:0];

  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  v6 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v6 presentingViewControllerViewDidDisappear:v3];

  v7 = [(CAMViewfinderViewController *)self view];
  [v7 _removeAllAnimations:1];
}

- (void)viewDidLayoutSubviews
{
  v14.receiver = self;
  v14.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v14 viewDidLayoutSubviews];
  v3 = [(CAMViewfinderViewController *)self view];
  v4 = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [v3 bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  v13 = [v4 superview];
  [v3 convertRect:v13 toView:{v6, v8, v10, v12}];
  [v4 setFrame:?];
}

- (void)viewWillTransitionToSize:(CGSize)a3 withTransitionCoordinator:(id)a4
{
  height = a3.height;
  width = a3.width;
  v10.receiver = self;
  v10.super_class = CAMViewfinderViewController;
  v7 = a4;
  [(CAMViewfinderViewController *)&v10 viewWillTransitionToSize:v7 withTransitionCoordinator:width, height];
  v8 = [(CAMViewfinderViewController *)self view];
  [v8 setNeedsLayout];
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __82__CAMViewfinderViewController_viewWillTransitionToSize_withTransitionCoordinator___block_invoke;
  v9[3] = &unk_1E76F95A8;
  v9[4] = self;
  [v7 animateAlongsideTransition:0 completion:v9];
}

uint64_t __82__CAMViewfinderViewController_viewWillTransitionToSize_withTransitionCoordinator___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setNeedsUpdateOfHomeIndicatorAutoHidden];
  v2 = *(a1 + 32);

  return [v2 setNeedsUpdateOfScreenEdgesDeferringSystemGestures];
}

- (BOOL)_autoHideHomeIndicatorForOrientation:(int64_t)a3
{
  v3 = a3 - 3;
  v4 = [(CAMViewfinderViewController *)self view];
  v5 = [v4 window];
  v6 = CAMInterfaceOrientationForWindow(v5);

  return ((v6 - 3) | v3) < 2;
}

- (void)_setHomeIndicatorAutoHideOrientation:(int64_t)a3
{
  if (a3 != 2 && self->__homeIndicatorAutoHideOrientation != a3)
  {
    self->__homeIndicatorAutoHideOrientation = a3;
    v5 = [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:?];
    if (v5 != [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:a3])
    {

      [(CAMViewfinderViewController *)self setNeedsUpdateOfHomeIndicatorAutoHidden];
    }
  }
}

- (void)_commitCTMCaptureWithType:(int64_t)a3
{
  v38 = *MEMORY[0x1E69E9840];
  if (a3)
  {
    v5 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    v6 = @"Photo";
    if (a3 != 1)
    {
      v6 = 0;
    }

    if (a3 == 2)
    {
      v6 = @"Video";
    }

    v7 = v6;
    if (!v5)
    {
      v13 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _commitCTMCaptureWithType:];
      }

      v8 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v8 resetAnimated:1];
      goto LABEL_38;
    }

    v8 = [(CAMViewfinderViewController *)self _captureController];
    v9 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = [v5 nightMode];
      v11 = [v8 nightModeStatus];
      if (v10 > 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = off_1E76FA020[v10];
      }

      v14 = v11 + 1;
      if (v14 > 3)
      {
        v15 = 0;
      }

      else
      {
        v15 = off_1E76F9F50[v14];
      }

      v16 = [MEMORY[0x1E696AEC0] stringWithFormat:@"NightMode%@/%@", v12, v15];
      *buf = 138543618;
      v33 = v7;
      v34 = 2114;
      v35 = v16;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Commit CTM capture with type %{public}@, %{public}@", buf, 0x16u);
    }

    [v5 setCtmCaptureType:a3];
    v17 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v5 burst:0];
    v18 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v19 = [v5 persistenceUUID];
    [v18 setObject:v17 forKey:v19];

    v31 = 0;
    LOBYTE(v19) = [v8 commitCTMCaptureWithRequest:v5 error:&v31];
    v20 = v31;
    if ((v19 & 1) == 0)
    {
      v22 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        v30 = [v20 localizedDescription];
        *buf = 138543874;
        v33 = v7;
        v34 = 2114;
        v35 = v5;
        v36 = 2114;
        v37 = v30;
        _os_log_error_impl(&dword_1A3640000, v22, OS_LOG_TYPE_ERROR, "Failed to capture %{public}@ with request %{public}@ (%{public}@)", buf, 0x20u);
      }

      if (a3 == 2 || [(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
      {
        [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
        v23 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [v23 resetAnimated:1];
      }

      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to commit CTM capture"];
      goto LABEL_37;
    }

    [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
    if (a3 == 1)
    {
      v21 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
      [v21 viewfinderViewController:self willCaptureStillImageForRequest:v5];
    }

    else if (a3 == 2)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
LABEL_33:
      v24 = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
      v25 = [(CAMViewfinderViewController *)self _captureController];
      v26 = [v25 isCapturingVideo];

      if (v24 && (v26 & 1) == 0)
      {
        [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
      }

      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
      v27 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      v28 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v27 didCaptureWithRequest:v5 currentConfiguration:v28];

LABEL_37:
      v29 = [(CAMViewfinderViewController *)self _motionController];
      [v29 debugValidateCaptureOrientationForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

LABEL_38:
      [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
      [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];

      goto LABEL_39;
    }

    if ([v5 nightMode])
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture began"];
    }

    goto LABEL_33;
  }

  v5 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController _commitCTMCaptureWithType:];
  }

LABEL_39:
}

- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:(unint64_t)a3
{
  v22 = *MEMORY[0x1E69E9840];
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

  if (v5)
  {
    v6 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _initiateCTMCaptureWithCurrentSettingsAtSystemTime:];
    }

    v7 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    [v4 cancelCTMCaptureForSettings:v7];

    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
  }

  v8 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
  v19 = 0;
  v9 = [v4 initiateCTMCaptureWithSettings:v8 error:&v19];
  v10 = v19;
  if (v9)
  {
    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:v8];
    v11 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v12 = [v8 nightMode];
      v13 = [v4 nightModeStatus];
      if (v12 > 2)
      {
        v14 = 0;
      }

      else
      {
        v14 = off_1E76FA020[v12];
      }

      v16 = v13 + 1;
      if (v16 > 3)
      {
        v17 = 0;
      }

      else
      {
        v17 = off_1E76F9F50[v16];
      }

      v18 = [MEMORY[0x1E696AEC0] stringWithFormat:@"NightMode%@/%@", v14, v17];
      *buf = 138543362;
      v21 = v18;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Initiated moment with %{public}@", buf, 0xCu);
    }
  }

  else
  {
    v15 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v21 = v10;
      _os_log_impl(&dword_1A3640000, v15, OS_LOG_TYPE_DEFAULT, "Failed to initiate CTM capture: %{public}@", buf, 0xCu);
    }

    if (v5)
    {
      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    }
  }
}

- (int64_t)_currentPhotoEncodingBehavior
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  v5 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v3 photoEncodingBehaviorForMode:v4 resolvedRAWMode:v5 isCapturingVideo:objc_msgSend(v6 isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  return v7;
}

- (int64_t)_currentRawFileFormatEncodingBehavior
{
  v2 = +[CAMUserPreferences preferences];
  v3 = [v2 rawFileFormatBehavior];

  return v3;
}

- (int64_t)_currentMaxPhotoResolution
{
  v3 = +[CAMUserPreferences preferences];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = [(CAMViewfinderViewController *)self _currentDevice];
  if ([v3 shouldUsePhotoFormatControlForMode:v5])
  {
    v7 = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  }

  else if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== 1)
  {
    v7 = [v3 maximumRAWPhotoResolution];
  }

  else
  {
    v7 = [v3 preferredHEICPhotoResolutionForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  }

  v8 = v7;
  v9 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v10 = [(CAMViewfinderViewController *)self _captureController];
  v11 = [v3 photoEncodingBehaviorForMode:v5 resolvedRAWMode:v9 isCapturingVideo:objc_msgSend(v10 isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  if (![v4 isPhotoResolutionSupported:v8 forMode:v5 device:v6 photoEncoding:v11])
  {
    v8 = 0;
  }

  if ([v4 isPhotoResolutionSupported:v8 forLightingType:{-[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", v5, v6)}])
  {
    v12 = v8;
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (void)_stopCapturingCTMVideo
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  [v3 endCTMVideoCapture];

  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];

  [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:1];
}

- (void)_cancelCTMCapture
{
  v3 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _isReconfiguring];
    v5 = os_log_create("com.apple.camera", "Capture");
    v6 = os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT);
    if (v4)
    {
      if (v6)
      {
        v11 = 0;
        v7 = "Cancelling CTM capture for reconfiguring";
        v8 = &v11;
LABEL_7:
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, v7, v8, 2u);
      }
    }

    else if (v6)
    {
      v10 = 0;
      v7 = "Cancelling CTM capture";
      v8 = &v10;
      goto LABEL_7;
    }

    v9 = [(CAMViewfinderViewController *)self _captureController];
    [v9 cancelCTMCaptureForSettings:v3];
    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
    [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  }
}

- (void)_updateOriginForRequest:(id)a3
{
  v4 = a3;
  [v4 setOrigin:{-[CAMViewfinderViewController _currentCaptureRequestOrigin](self, "_currentCaptureRequestOrigin")}];
}

- (void)_updateUserInitiationTimeForRequest:(id)a3
{
  v5 = a3;
  if ([(CAMViewfinderViewController *)self _shouldReportUserInitiationTimeForCurrentSettings])
  {
    v4 = [(CAMViewfinderViewController *)self _lastShutterButtonTouchDownTime];
  }

  else
  {
    v4 = 0;
  }

  [v5 setUserInitiationTime:v4];
}

- (BOOL)_captureStillImageWithRequest:(id)a3 error:(id *)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [v7 captureStillImageWithRequest:v6 error:a4];
  v9 = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  v10 = [v7 isCapturingVideo];
  if (v8 && v9 && (v10 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  if (((v8 ^ 1 | [v7 isCaptureAvailable]) & 1) == 0)
  {
    v11 = +[CAMCaptureCapabilities capabilities];
    v12 = [v11 portraitModeOverlappingCapturesSupported];

    if ((v12 & 1) == 0 && [(CAMViewfinderViewController *)self _currentMode]== 6)
    {
      v13 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
      if (v13 <= 0xE && ((1 << v13) & 0x6202) != 0 && ![v6 nightMode])
      {
        [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
      }
    }
  }

  [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
  [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];

  return v8;
}

- (id)_stillImageCaptureRequestWithCurrentSettingsAsBurst:(BOOL)a3 maximumLength:(int64_t)a4
{
  v5 = a3;
  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [(CAMViewfinderViewController *)self _motionController];
  v50 = [(CAMViewfinderViewController *)self _cameraRollController];
  v49 = +[CAMCaptureCapabilities capabilities];
  v9 = [(CAMViewfinderViewController *)self _currentMode];
  v10 = [(CAMViewfinderViewController *)self _currentDevice];
  v45 = [(CAMViewfinderViewController *)self persistenceBehavior];
  v47 = v7;
  v11 = [v7 isCapturingVideo];
  v12 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v9];
  v52 = [(CAMViewfinderViewController *)self _currentCaptureFiltersForBurst:v5];
  v13 = v9;
  v51 = [(CAMViewfinderViewController *)self _originalCaptureFiltersForMode:v9 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
  v46 = v8;
  v14 = [v8 captureOrientation];
  v44 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  v15 = +[CAMUserPreferences preferences];
  v16 = objc_alloc_init(CAMMutableStillImageCaptureRequest);
  [(CAMMutableStillImageCaptureRequest *)v16 setDelegate:self];
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureOrientation:v14];
  if ((v10 - 1) > 0xA)
  {
    v17 = 0;
  }

  else
  {
    v17 = qword_1A3A685B0[v10 - 1];
  }

  v48 = v15;
  -[CAMMutableStillImageCaptureRequest setCaptureMirrored:](v16, "setCaptureMirrored:", [v15 mirrorCameraCapturesForDevicePosition:v17 mode:v13]);
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureDevice:v10];
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureMode:v13];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsSquareCrop:v13 == 4];
  [(CAMMutableStillImageCaptureRequest *)v16 setAspectRatioCrop:[(CAMViewfinderViewController *)self _aspectRatioCropForMode:v13 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v16 setEffectFilterType:v12];
  -[CAMMutableStillImageCaptureRequest setSessionIdentifier:](v16, "setSessionIdentifier:", [v50 sessionIdentifier]);
  [(CAMMutableStillImageCaptureRequest *)v16 setAdjustmentFilters:v52];
  [(CAMMutableStillImageCaptureRequest *)v16 setOriginalFilters:v51];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsHighResolutionStills:1];
  [(CAMMutableStillImageCaptureRequest *)v16 setStillDuringVideo:v11];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsAutoDualCameraFusion:v5 ^ 1];
  if ([v15 semanticDevelopmentEnabled])
  {
    v18 = [(CAMViewfinderViewController *)self _resolvedRAWMode]!= 1;
  }

  else
  {
    v18 = 0;
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setWantsSemanticSceneFilter:v18];
  v19 = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
  [(CAMMutableStillImageCaptureRequest *)v16 setSemanticStyle:v19];

  v20 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (v20)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setWantsShutterSoundSuppression:1];
  }

  if (v5)
  {
    v21 = v13;
    v22 = [v49 isBurstSupportedForMode:v13 device:v10] ^ 1;
  }

  else
  {
    v21 = v13;
    if (v11)
    {
      v22 = 0;
    }

    else if ([(CAMViewfinderViewController *)self _isBurstEndSoundPlaying])
    {
      v22 = [(CAMViewfinderViewController *)self _desiredLivePhotoMode]== 0;
    }

    else
    {
      v22 = 1;
    }
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setWantsAudioForCapture:v22];
  [(CAMMutableStillImageCaptureRequest *)v16 setLightingEffectType:[(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:v21 device:v10]];
  -[CAMMutableStillImageCaptureRequest setWantsWhiteBalanceLockedDuringVideoRecording:](v16, "setWantsWhiteBalanceLockedDuringVideoRecording:", [v15 shouldLockWhiteBalanceDuringVideoRecording]);
  if (v5)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setFlashMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setHdrMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setIrisMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoQualityPrioritization:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setNightMode:0];
    if (a4 >= 1)
    {
      [(CAMMutableStillImageCaptureRequest *)v16 setMaximumBurstLength:a4];
    }

    v23 = v49;
    v24 = v45;
    if ([v15 burstFollowsEncoderSettings])
    {
      v25 = [v15 photoEncodingBehavior];
    }

    else
    {
      v25 = 0;
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoEncodingBehavior:v25];
    [(CAMMutableStillImageCaptureRequest *)v16 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:v45 allowingOptionalLocalPersistence:1]];
  }

  else
  {
    v53 = 0;
    v26 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:v21 flashActive:&v53];
    [(CAMMutableStillImageCaptureRequest *)v16 setFlashMode:v53];
    if (v26)
    {
      v27 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
    }

    else
    {
      v27 = 0;
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setTorchMode:[CAMCaptureConversions torchModeForFlashMode:v27]];
    if (v44)
    {
      v28 = 0;
      LOBYTE(v11) = 1;
    }

    else
    {
      v28 = [(CAMViewfinderViewController *)self _resolvedHDRMode];
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setHdrMode:v28];
    -[CAMMutableStillImageCaptureRequest setWantsEV0ForHDR:](v16, "setWantsEV0ForHDR:", [v15 shouldCaptureHDREV0]);
    v29 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v30 = [v29 photoQualityPrioritization];

    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoQualityPrioritization:v30];
    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoEncodingBehavior:[(CAMViewfinderViewController *)self _currentPhotoEncodingBehavior]];
    [(CAMMutableStillImageCaptureRequest *)v16 setRawFileFormatBehavior:[(CAMViewfinderViewController *)self _currentRawFileFormatEncodingBehavior]];
    v21 = v13;
    [(CAMMutableStillImageCaptureRequest *)v16 setNightMode:[(CAMViewfinderViewController *)self _nightModeForMode:[(CAMViewfinderViewController *)self _resolvedNightMode] captureMode:v13 device:v10 isBurst:0]];
    -[CAMMutableStillImageCaptureRequest setDisablesCameraSwitchingDuringRecording:](v16, "setDisablesCameraSwitchingDuringRecording:", [v15 shouldDisableCameraSwitchingDuringVideoRecordingForMode:v13]);
    [(CAMMutableStillImageCaptureRequest *)v16 setMaximumPhotoResolution:[(CAMViewfinderViewController *)self _currentMaxPhotoResolution]];
    [(CAMMutableStillImageCaptureRequest *)v16 setWantsDepthData:[(CAMViewfinderViewController *)self _shouldRequestDepthDeliveryForBurst:0]];
    if (v11)
    {
      v31 = 0;
    }

    else
    {
      v31 = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
    }

    v24 = v45;
    [(CAMMutableStillImageCaptureRequest *)v16 setIrisMode:v31];
    v32 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    -[CAMMutableStillImageCaptureRequest setVideoEncodingBehavior:](v16, "setVideoEncodingBehavior:", [v32 videoEncodingBehavior]);

    [(CAMMutableStillImageCaptureRequest *)v16 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:v45 allowingOptionalLocalPersistence:v31 == 0]];
    [(CAMViewfinderViewController *)self _updateUserInitiationTimeForRequest:v16];
    v23 = v49;
  }

  v33 = [(CAMViewfinderViewController *)self _locationController];
  v34 = [v33 currentLocation];
  if (v34)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setLocation:v34];
  }

  v35 = [v33 headingForOrientation:v14];
  if (v35)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setHeading:v35];
  }

  if ([v23 isInternalInstall])
  {
    -[CAMMutableStillImageCaptureRequest setShouldDelayRemotePersistence:](v16, "setShouldDelayRemotePersistence:", [v15 shouldDelayRemotePersistence]);
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:v24]];
  [(CAMViewfinderViewController *)self _updateOriginForRequest:v16];
  [(CAMViewfinderViewController *)self _desiredPreviewSizeForStillImageCapture];
  [(CAMMutableStillImageCaptureRequest *)v16 setDesiredPreviewSize:?];
  if ([v15 sharedLibraryEnabled])
  {
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      [(CAMMutableStillImageCaptureRequest *)v16 setSharedLibraryMode:[(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState]];
    }

    else
    {
      v36 = [(CAMViewfinderViewController *)self _librarySelectionController];
      -[CAMMutableStillImageCaptureRequest setSharedLibraryMode:](v16, "setSharedLibraryMode:", [v36 sharedLibraryMode]);
    }

    if ([v23 isInternalInstall])
    {
      v37 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v38 = [v37 librarySelectionDiagnostics];
      [(CAMMutableStillImageCaptureRequest *)v16 setSharedLibraryDiagnostics:v38];

      v21 = v13;
    }

    if ([v23 peopleProximityPersistenceSupported])
    {
      v39 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v40 = [v39 acquiredSignalResults];

      v41 = [v40 identitiesInProximity];
      v42 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(v41);
      [(CAMMutableStillImageCaptureRequest *)v16 setContactIDsInProximity:v42];

      v15 = v48;
      v23 = v49;

      v21 = v13;
    }
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setStereoCaptureStatus:[(CAMViewfinderViewController *)self _stereoCaptureStatus]];
  [(CAMMutableStillImageCaptureRequest *)v16 setFrontRearSimultaneousCaptureEnabled:[(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:v21 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v16 setFrontRearSimultaneousCaptureMirrored:[(CAMStillImageCaptureRequest *)v16 isFrontRearSimultaneousCaptureEnabled]];
  [(CAMMutableStillImageCaptureRequest *)v16 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];

  return v16;
}

- (CGSize)_desiredPreviewSizeForStillImageCapture
{
  v2 = [(CAMViewfinderViewController *)self view];
  v3 = [v2 window];
  v4 = [v3 screen];

  [v4 _referenceBounds];
  v6 = v5;
  v8 = v7;
  [v4 scale];
  v10 = v9 * v8;
  v11 = v9 * v6;

  v12 = v10;
  v13 = v11;
  result.height = v13;
  result.width = v12;
  return result;
}

- (BOOL)_isPrimaryDisplayAssetForCoordinationInfo:(id)a3
{
  if (a3)
  {
    return [a3 isUnfilteredImageForFilteredPair] ^ 1;
  }

  else
  {
    return 1;
  }
}

- (BOOL)_wantsCaptureAnimationForRequest:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  if ([v5 isCapturingVideo])
  {
    v6 = [v5 videoCapturePaused];
  }

  else
  {
    v6 = 1;
  }

  v7 = [v5 isCapturingBurst];
  v8 = [v4 burstIdentifier];

  v9 = [v4 textAnalysisIdentifier];

  if (v9)
  {
    v10 = 0;
  }

  else
  {
    v10 = v6;
  }

  if (v8)
  {
    v10 = 0;
  }

  if (v7)
  {
    v11 = 0;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (void)stillImageRequestDidBeginCaptureBeforeResolvingSettings:(id)a3
{
  if ([(CAMViewfinderViewController *)self _wantsCaptureAnimationForRequest:a3])
  {

    [(CAMViewfinderViewController *)self _performCaptureAnimation];
  }
}

- (void)stillImageRequestDidStartCapturing:(id)a3 resolvedSettings:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v10 = [v7 isCaptureBeforeResolvingSettingsEnabled];
  v11 = [(CAMViewfinderViewController *)self _wantsCaptureAnimationForRequest:v6];
  [v7 nightModeCaptureTime];
  if (v11 && (v10 & 1) == 0)
  {
    v13 = v12;
    v14 = [v6 nightMode];
    if ((v14 - 1) < 2)
    {
      if (v13 >= 2.0)
      {
        [v9 setPreviewAlignmentGuideVisible:1 animated:1];
        v15 = [(CAMViewfinderViewController *)self _motionController];
        v16 = [v9 previewAlignmentGuide];
        v17 = [v16 alignmentModel];
        [v15 beginUpdatingPreviewAlignmentModel:v17];

        objc_initWeak(&location, self);
        v18 = [(CAMViewfinderViewController *)self _controlDrawer];
        v19 = [v18 nightModeSlider];
        v56[0] = MEMORY[0x1E69E9820];
        v56[1] = 3221225472;
        v56[2] = __83__CAMViewfinderViewController_stillImageRequestDidStartCapturing_resolvedSettings___block_invoke;
        v56[3] = &unk_1E76F95D0;
        objc_copyWeak(&v57, &location);
        [v19 performCaptureAnimationWithDuration:v56 completion:v13];

        [(CAMViewfinderViewController *)self _beginNightModeInstructionLabelCountDown];
        [(CAMViewfinderViewController *)self _setNightModeCaptureUIVisible:1];
        v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
        [v20 setIsNightModeCaptureUIVisible:1];

        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
        objc_destroyWeak(&v57);
        objc_destroyWeak(&location);
      }

      v21 = [v8 nightModePreviewOverlayStyleForDevicePosition:objc_msgSend(v6 sensitiveToChangingDisplayFeedback:"captureDevicePosition") sensitiveToInitialFeedback:objc_msgSend(v7 duration:{"nightModeCaptureHasConstantPreviewFeedbackSensitivity"), objc_msgSend(v7, "nightModeCaptureHasInitialPreviewFeedbackSensitivity"), v13}];
      v22 = [MEMORY[0x1E69DC888] colorWithCGColor:{objc_msgSend(v7, "nightModePreviewColorEstimate")}];
      v23 = v22;
      if (v22)
      {
        v24 = v22;
      }

      else
      {
        v24 = [MEMORY[0x1E69DC888] blackColor];
      }

      v25 = v24;

      v29 = 0;
      v30 = 1;
      if (v21 > 2)
      {
        if (v21 != 3)
        {
          if (v21 == 4)
          {
            v30 = 0;
            v29 = 0;
          }

          goto LABEL_22;
        }

        v31 = MEMORY[0x1E69793D0];
        v32 = MEMORY[0x1E6979EA0];
      }

      else
      {
        if (v21 >= 2)
        {
          if (v21 != 2)
          {
LABEL_22:
            [(CAMViewfinderViewController *)self _performCaptureAnimationWithDuration:v29 curve:v25 color:v30 fadeOut:v13];
            v34 = [(CAMViewfinderViewController *)self _feedbackController];
            [v34 prepareDiscreteFeedback:5];

            goto LABEL_23;
          }

          LODWORD(v26) = 1.0;
          LODWORD(v27) = 1.0;
          LODWORD(v28) = 1.0;
          v33 = [MEMORY[0x1E69793D0] functionWithControlPoints:v26 :0.0 :v27 :v28];
LABEL_21:
          v29 = v33;
          v30 = 1;
          goto LABEL_22;
        }

        v31 = MEMORY[0x1E69793D0];
        v32 = MEMORY[0x1E6979ED8];
      }

      v33 = [v31 functionWithName:*v32];
      goto LABEL_21;
    }

    if (!v14)
    {
      [(CAMViewfinderViewController *)self _performCaptureAnimation];
    }
  }

LABEL_23:
  v35 = [v6 burstIdentifier];

  if (v35)
  {
    v36 = [(CAMViewfinderViewController *)self _feedbackController];
    [v36 performDiscreteFeedback:1];

    v37 = [(CAMViewfinderViewController *)self _feedbackController];
    [v37 prepareDiscreteFeedback:1];

    v38 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (v38)
    {
      v39 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      v40 = [v39 incrementCounter];
    }

    else
    {
      v39 = [(CAMViewfinderViewController *)self _burstIndicatorView];
      v40 = [v39 incrementWithCaptureAnimation:1];
    }

    v41 = v40;

    v42 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v42 burstCaptureNumberOfPhotosDidChange:v41];
  }

  v43 = v9;
  v54 = [v7 isHDREnabled];
  v55 = v7;
  v53 = [v7 isPortraitEffectEnabled];
  v44 = [v8 portraitModeOverlappingCapturesSupported];
  v45 = v8;
  v46 = [v8 isSmartHDRSupported];
  v47 = [v6 nightMode];
  v48 = [v6 maximumPhotoResolution];
  v49 = v45;
  v50 = [v45 supportsOverlappingCapturesForResolution:3];
  if ([v6 captureMode] == 9)
  {
    v51 = v6;
    v52 = ([v6 stereoCaptureStatus] >> 1) & 1;
    if (v47)
    {
      goto LABEL_34;
    }
  }

  else
  {
    v51 = v6;
    LOBYTE(v52) = 0;
    if (v47)
    {
      goto LABEL_34;
    }
  }

  if (v52 & 1 | (((v54 ^ 1 | v46) & (v53 ^ 1 | v44) & ((v48 != 3) | v50) & 1) == 0))
  {
    [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
  }

LABEL_34:
  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
}

void __83__CAMViewfinderViewController_stillImageRequestDidStartCapturing_resolvedSettings___block_invoke(uint64_t a1, int a2)
{
  if (a2)
  {
    WeakRetained = objc_loadWeakRetained((a1 + 32));
    [WeakRetained _updateShutterButtonForEndOfNightModeCapture];
  }
}

- (void)_beginNightModeInstructionLabelCountDown
{
  v3 = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode];
  if (v3 == 2)
  {
    v6 = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
    v4 = v5;
  }

  else
  {
    if (v3 != 1)
    {
      return;
    }

    v6 = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
  }

  [v6 countDownFrom:v4];
}

- (void)stillImageRequestDidStopCapturingStillImage:(id)a3
{
  v10 = a3;
  v4 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [v5 viewfinderViewController:self didReceiveStillImageRequestDidStopCapturingStillImage:v10];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  if ([v10 nightMode])
  {
    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v6 setPreviewAlignmentGuideVisible:0 animated:1];
    v7 = [(CAMViewfinderViewController *)self _motionController];
    [v7 endUpdatingPreviewAlignmentModel];

    v8 = [(CAMViewfinderViewController *)self _feedbackController];
    [v8 performDiscreteFeedback:5];

    [(CAMViewfinderViewController *)self _updateShutterButtonForEndOfNightModeCapture];
  }

  v9 = [(CAMViewfinderViewController *)self _idleController];
  [v9 stillImageRequestDidStopCapturingStillImage:v10];
}

- (void)stillImageRequestDidCompleteStillImageCapture:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v45 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [v8 textAnalysisIdentifier];

  if (v11)
  {
    [(CAMViewfinderViewController *)self _handleTextAnalysisStillImageResponse:v9 error:v10 forRequest:v8];
  }

  else
  {
    v12 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

    if (v12)
    {
      v13 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
      [v13 viewfinderViewController:self didReceiveStillImageRequestDidCompleteStillImageCapture:v8 withResponse:v9 error:v10];
    }

    v14 = [v9 coordinationInfo];
    v15 = [v14 isFinalExpectedStillImageResult];
    v16 = [v14 isEV0ForHDREV0Pair];
    v17 = [(CAMViewfinderViewController *)self _cameraRollController];
    if ((v10 || v15) && ![(CAMViewfinderViewController *)self _isNightModeCaptureCanceling])
    {
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    }

    [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
    if (v16)
    {
      v18 = os_log_create("com.apple.camera", "ImageWell");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        v19 = [v9 persistenceUUID];
        v41 = 138543618;
        v42 = v19;
        v43 = 2114;
        v44 = v14;
        _os_log_impl(&dword_1A3640000, v18, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: ignoring future updates for EV0 result from stillImageRequestDidCompleteStillImageCapture %{public}@", &v41, 0x16u);
      }

      v20 = [v8 EV0PersistenceUUID];
      v21 = [v8 persistenceUUID];
      [v17 ignoreImageWellChangeNotificationForEV0UUID:v20 withHDRUUID:v21];
    }

    [(CAMViewfinderViewController *)self _updateImageWellWithStillImageResponse:v9 forRequest:v8 error:v10];
    if (!v10)
    {
      if ([(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:v14])
      {
        [v17 processTransientAssetUpdate:v9 preventingInsertion:0 persistenceOptions:{objc_msgSend(v8, "persistenceOptions")}];
      }

      v22 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
      v23 = [v8 persistenceUUID];
      v24 = [v22 objectForKeyedSubscript:v23];

      [v24 populateFromStillImageCaptureResponse:v9];
    }

    v25 = [v8 burstIdentifier];

    if (v25)
    {
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
    }

    else
    {
      v26 = [(CAMViewfinderViewController *)self _captureController];
      v27 = [(CAMViewfinderViewController *)self _currentBurstTimer];
      if (([v26 isCapturingBurst] & 1) == 0 && (objc_msgSend(v26, "isCapturingStillImage") & 1) == 0 && objc_msgSend(v27, "fired"))
      {
        v28 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
        {
          LOWORD(v41) = 0;
          _os_log_impl(&dword_1A3640000, v28, OS_LOG_TYPE_DEFAULT, "Starting burst because image capture finished after burst timer fired", &v41, 2u);
        }

        [(CAMViewfinderViewController *)self _beginCapturingBurst];
      }
    }

    if ([v8 nightMode])
    {
      [(CAMViewfinderViewController *)self _setNightModeCaptureUIVisible:0];
      v29 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [v29 setIsNightModeCaptureUIVisible:0];

      [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture ended"];
      v30 = [(CAMViewfinderViewController *)self _controlDrawer];
      v31 = [v30 nightModeSlider];
      [v31 endCaptureAnimationAnimated:1];

      v32 = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
      [v32 cancelCountDown];

      v33 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v33 dismissModalControlDrawerIfNeededForReason:2];
    }

    v34 = [(CAMViewfinderViewController *)self captureDelegate];
    [v34 viewfinderViewControllerDidCompleteStillImageCapture:self];

    if ([(CAMViewfinderViewController *)self _resolvedTimerDuration])
    {
      v35 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      if (v35)
      {
        v36 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      }

      else
      {
        v37 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v36 = [v37 timerIndicator];
      }

      v38 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
      if (v38 > 2)
      {
        v39 = 0;
      }

      else
      {
        v39 = qword_1A3A68368[v38];
      }

      if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
      {
        [v36 resetWithNumberOfTicks:v39 showBeforeAnimationStarts:0];
      }

      else
      {
        v40 = [(CAMViewfinderViewController *)self _captureController];
        [v36 resetWithNumberOfTicks:v39 showBeforeAnimationStarts:{objc_msgSend(v40, "isCapturingBurst") ^ 1}];
      }
    }
  }
}

- (void)stillImageRequestDidCompleteVideoCapture:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v13 = a3;
  v8 = a4;
  v9 = a5;
  if ([v13 isCTMVideo])
  {
    v10 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v11 = [v13 persistenceUUID];
    v12 = [v10 objectForKeyedSubscript:v11];

    [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v12];
    [(CAMViewfinderViewController *)self _captureRequest:v13 didCompleteVideoCaptureWithResponse:v8 error:v9];
  }

  else
  {
    if (v9)
    {
      goto LABEL_6;
    }

    v12 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v12 processTransientPairedVideoUpdate:v8 filterType:{objc_msgSend(v13, "effectFilterType")}];
  }

LABEL_6:
}

- (void)stillImageRequestDidCompleteStillImageLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = v9;
  if (a5)
  {
    v11 = [a5 userInfo];
    v12 = [v11 objectForKeyedSubscript:*MEMORY[0x1E696AA08]];

    v13 = [v12 domain];
    if ([v13 isEqual:*MEMORY[0x1E696A798]])
    {
      v14 = [v12 code];

      if (v14 != 28)
      {
LABEL_10:

        goto LABEL_13;
      }

      v15 = [v8 captureMode];
      v16 = [v8 captureDevice];
      v17 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v13 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:v15 device:v16 fromGraphConfiguration:v17];

      v18 = [(CAMViewfinderViewController *)self _storageController];
      LODWORD(v17) = [v18 hasDiskSpaceToAllowCaptureWithConfiguration:v13 allowPurging:1 verbose:1];

      v19 = @"insufficient";
      if (v17)
      {
        v19 = @"sufficient";
      }

      v20 = v19;
      v21 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController stillImageRequestDidCompleteStillImageLocalPersistence:withResponse:error:];
      }

      [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:1];
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
    }

    goto LABEL_10;
  }

  v22 = [v9 coordinationInfo];
  v23 = [(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:v22];

  if (v23)
  {
    v24 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v24 processTransientAssetUpdate:v10 preventingInsertion:0 persistenceOptions:{objc_msgSend(v8, "persistenceOptions")}];
  }

LABEL_13:
}

- (void)stillImageRequestDidCompleteStillImageRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  if (!a5)
  {
    v7 = a4;
    v8 = a3;
    v9 = [v7 persistenceUUID];
    v10 = [v7 sessionIdentifier];
    v11 = [(CAMViewfinderViewController *)self _cameraRollController];
    v12 = [v8 persistenceOptions];

    [v11 processTransientAssetUpdate:v7 preventingInsertion:1 persistenceOptions:v12];
    [v11 didPersistAssetWithUUID:v9 captureSession:v10];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, a4];
}

- (void)stillImageRequestDidCompleteCapture:(id)a3 error:(id)a4
{
  v14 = a3;
  v6 = a4;
  v7 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

  if (v7)
  {
    v8 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [v8 viewfinderViewController:self didReceiveStillImageRequestDidCompleteCapture:v14 error:v6];
  }

  if (v6 && [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
  }

  if (([v14 isCTMVideo] & 1) == 0)
  {
    v9 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v10 = [v14 persistenceUUID];
    v11 = [v9 objectForKeyedSubscript:v10];

    [v11 publish];
    v12 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v13 = [v14 persistenceUUID];
    [v12 removeObjectForKey:v13];
  }
}

- (void)stillImageRequestsWillStartCapturingLivePhotoVideo
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isCapturingLivePhotoVideo];

  if (v4)
  {
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke;
    v6[3] = &unk_1E76F95F8;
    v6[4] = self;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }

  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke_2;
  v5[3] = &unk_1E76F77B0;
  v5[4] = self;
  [MEMORY[0x1E69DD250] animateWithDuration:2 delay:v5 options:0 animations:0.25 completion:0.0];
}

void __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke(uint64_t a1, void *a2)
{
  v2 = *(a1 + 32);
  v3 = a2;
  [v3 updateForLivePhotoMode:{objc_msgSend(v2, "_resolvedLivePhotoMode")}];
}

void __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke_2(uint64_t a1)
{
  v1 = [*(a1 + 32) viewfinderView];
  [v1 setNeedsLayout];
  [v1 layoutIfNeeded];
}

- (void)stillImageRequestsDidCompleteCapturingLivePhotoVideo
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __83__CAMViewfinderViewController_stillImageRequestsDidCompleteCapturingLivePhotoVideo__block_invoke;
  v3[3] = &unk_1E76F77B0;
  v3[4] = self;
  [MEMORY[0x1E69DD250] animateWithDuration:2 delay:v3 options:0 animations:0.25 completion:0.0];
}

void __83__CAMViewfinderViewController_stillImageRequestsDidCompleteCapturingLivePhotoVideo__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) viewfinderView];
  [v1 setNeedsLayout];
  [v1 layoutIfNeeded];
}

- (void)stillImageRequestsWillRequestCTMVideoCaptureStart
{
  v3 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v4 = objc_opt_respondsToSelector();

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v5 stillImageRequestsWillRequestCTMVideoCaptureStartForViewfinderViewController:self];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];

  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

- (void)stillImageRequestsWillRequestCTMVideoCaptureEnd
{
  v3 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v4 = objc_opt_respondsToSelector();

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v5 stillImageRequestsWillRequestCTMVideoCaptureEndForViewfinderViewController:self];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];

  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

- (BOOL)_isCTMVideoSupportedForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];

  LOBYTE(v3) = [v4 isCTMVideoCaptureSupportedForMode:v5];
  return v3;
}

- (void)stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:(BOOL)a3
{
  v14 = *MEMORY[0x1E69E9840];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _isCTMVideoSupportedForGraphConfiguration:v5];

  if (v6)
  {
    if (!a3)
    {
      v7 = [(CAMViewfinderViewController *)self _idleController];
      [v7 stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:0];
    }

    v11 = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
    [v11 startTimer];
    [v11 setBackgroundStyle:1 animated:1];
    v8 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v8 didStartCaptureTimer];

    [(CAMViewfinderViewController *)self _limitZoomRangeForRecordingIfNecessary];
  }

  else
  {
    v9 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      *buf = 138543362;
      v13 = v10;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Received stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight in unsupported configuration %{public}@", buf, 0xCu);
    }
  }
}

- (void)stillImageRequestsDidStopCapturingCTMVideo
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _isCTMVideoSupportedForGraphConfiguration:v3];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _captureController];
    v6 = [v5 isCapturingCTMVideo];

    if (v6)
    {
      return;
    }

    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    [(CAMViewfinderViewController *)self _restoreZoomRangeAfterRecordingIfNecessary];
  }

  else
  {
    v7 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v10 = 138543362;
      v11 = v8;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Received stillImageRequestsDidStopCapturingCTMVideo in unsupported configuration %{public}@", &v10, 0xCu);
    }
  }

  v9 = [(CAMViewfinderViewController *)self _idleController];
  [v9 stillImageRequestsDidStopCapturingCTMVideo];
}

- (void)_presentImageWellImage:(id)a3 uuid:(id)a4 animated:(BOOL)a5
{
  v5 = a5;
  v8 = a4;
  v9 = a3;
  [(CAMViewfinderViewController *)self setPresentedImageWellImage:v9];
  v10 = [(CAMViewfinderViewController *)self _imageWell];
  [v10 setThumbnailImage:v9 uuid:v8 animated:v5];

  v11 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v11 updateThumbnailImage:v9 uuid:v8 animated:v5];
}

- (void)setPresentedImageWellImage:(id)a3
{
  v5 = a3;
  if (self->_presentedImageWellImage != v5)
  {
    v6 = v5;
    objc_storeStrong(&self->_presentedImageWellImage, a3);
    v5 = v6;
  }
}

- (void)_updateImageWellWithStillImageResponse:(id)a3 forRequest:(id)a4 error:(id)a5
{
  v27 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a4;
  v10 = [v8 coordinationInfo];
  v11 = [v8 persistenceUUID];
  v12 = [v10 representsFinalProcessedStillImage];
  if (a5 || !v12)
  {
    v13 = os_log_create("com.apple.camera", "ImageWell");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v21 = 138543618;
      v22 = v11;
      v23 = 2114;
      v24 = v10;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: ignoring non-final image well update from still image capture %{public}@", &v21, 0x16u);
    }
  }

  else
  {
    v13 = [v8 imageWellImage];
    if (v13)
    {
      v14 = [(CAMViewfinderViewController *)self _cameraRollController];
      v15 = [v8 sessionIdentifier];
      v16 = [v8 persistenceUUID];
      if ([v14 isCaptureSessionCurrent:v15])
      {
        [v14 willPersistAssetWithUUID:v16 captureSession:v15];
        v17 = os_log_create("com.apple.camera", "ImageWell");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          v21 = 138543874;
          v22 = v16;
          v23 = 2114;
          v24 = v13;
          v25 = 2114;
          v26 = v10;
          _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: updating from still image capture %{public}@ %{public}@", &v21, 0x20u);
        }

        [(CAMViewfinderViewController *)self _presentImageWellImage:v13 uuid:v16 animated:1];
        CAMSignpostWithIDAndArgs(75, [v8 captureID], objc_msgSend(v8, "captureID"), 0, 0, 0);
        if (![v9 conformsToProtocol:&unk_1F1759928] || (objc_msgSend(v9, "burstIdentifier"), v18 = objc_claimAutoreleasedReturnValue(), v18, !v18))
        {
          v19 = [(CAMViewfinderViewController *)self _remoteShutterController];
          [v19 sendThumbnailImage:v13 isVideo:0];
        }

        v20 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
        [v20 viewfinderViewController:self didUpdateImageWellWithRequest:v9 response:v8 error:0];
      }
    }

    else
    {
      v14 = os_log_create("com.apple.camera", "ImageWell");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        v21 = 138543618;
        v22 = v11;
        v23 = 2114;
        v24 = v10;
        _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: no image well image found, so calling recoverFromFailedThumbnailUpdate for still image capture %{public}@", &v21, 0x16u);
      }
    }
  }
}

- (id)_videoCaptureRequestWithCurrentSettings
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [(CAMViewfinderViewController *)self _motionController];
  v40 = [(CAMViewfinderViewController *)self _cameraRollController];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v5 mode];
  v7 = [v5 device];
  if ((v7 - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7 - 1];
  }

  v9 = [v5 videoConfiguration];
  if ([(CAMViewfinderViewController *)self _isProactiveFlashSuggestionSuppressed])
  {
    v10 = 0;
  }

  else
  {
    v10 = [(CAMViewfinderViewController *)self _resolvedTorchMode];
  }

  v38 = v4;
  v11 = [v4 captureOrientation];
  v12 = objc_alloc_init(CAMMutableVideoCaptureRequest);
  [(CAMMutableVideoCaptureRequest *)v12 setTorchMode:v10];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureOrientation:v11];
  -[CAMMutableVideoCaptureRequest setCaptureMirrored:](v12, "setCaptureMirrored:", [v3 mirrorCameraCapturesForDevicePosition:v8 mode:v6]);
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureDevice:v7];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureMode:v6];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureVideoConfiguration:v9];
  -[CAMMutableVideoCaptureRequest setWantsWhiteBalanceLocked:](v12, "setWantsWhiteBalanceLocked:", [v3 shouldLockWhiteBalanceDuringVideoRecording]);
  [(CAMMutableVideoCaptureRequest *)v12 setDelegate:self];
  -[CAMMutableVideoCaptureRequest setSessionIdentifier:](v12, "setSessionIdentifier:", [v40 sessionIdentifier]);
  [(CAMMutableVideoCaptureRequest *)v12 setUserInitiationTimestamp:CFAbsoluteTimeGetCurrent()];
  -[CAMMutableVideoCaptureRequest setAudioConfiguration:](v12, "setAudioConfiguration:", [v5 audioConfiguration]);
  [(CAMMutableVideoCaptureRequest *)v12 setTrueVideoEnabled:[(CAMViewfinderViewController *)self _trueVideoIsActive]];
  [(CAMMutableVideoCaptureRequest *)v12 setFrontRearSimultaneousVideoEnabled:[(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:v6 devicePosition:v8]];
  [(CAMMutableVideoCaptureRequest *)v12 setFrontRearSimultaneousVideoMirrored:[(CAMVideoCaptureRequest *)v12 isFrontRearSimultaneousVideoEnabled]];
  v13 = [(CAMViewfinderViewController *)self _locationController];
  v14 = [v13 currentLocation];
  if (v14)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setLocation:v14];
  }

  v15 = [v13 headingForOrientation:v11];
  if (v15)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setHeading:v15];
  }

  v16 = +[CAMCaptureCapabilities capabilities];
  if ([v16 isInternalInstall])
  {
    -[CAMMutableVideoCaptureRequest setShouldDelayRemotePersistence:](v12, "setShouldDelayRemotePersistence:", [v3 shouldDelayRemotePersistence]);
  }

  v39 = v3;
  -[CAMMutableVideoCaptureRequest setVideoEncodingBehavior:](v12, "setVideoEncodingBehavior:", [v5 videoEncodingBehavior]);
  v17 = [(CAMViewfinderViewController *)self _storageController];
  -[CAMMutableVideoCaptureRequest setRemainingDiskUsageThreshold:](v12, "setRemainingDiskUsageThreshold:", [v17 minimumDiskUsageThresholdInBytesForGraphConfiguration:v5]);
  [(CAMViewfinderViewController *)self maximumVideoRecordingDuration];
  if (v18 > 0.0)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setMaximumRecordedDuration:?];
  }

  v19 = [(CAMViewfinderViewController *)self persistenceBehavior];
  v20 = [(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:v19 allowingOptionalLocalPersistence:0];
  [(CAMMutableVideoCaptureRequest *)v12 setPersistenceOptions:v20];
  [(CAMMutableVideoCaptureRequest *)v12 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:v19]];
  if (v20 == 3)
  {
    v21 = [(CAMViewfinderViewController *)self _storageController];
    v22 = [v21 externalStorage];
    v23 = [v22 generateDestinationURLWithExtension:@"MOV"];

    [(CAMMutableVideoCaptureRequest *)v12 setLocalDestinationURL:v23];
  }

  [(CAMViewfinderViewController *)self _updateOriginForRequest:v12];
  [(CAMMutableVideoCaptureRequest *)v12 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];
  v24 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v12 burst:0];
  v25 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v26 = [(CAMCaptureRequest *)v12 persistenceUUID];
  [v25 setObject:v24 forKey:v26];

  if ([(CAMVideoCaptureRequest *)v12 isFrontRearSimultaneousVideoEnabled])
  {
    v27 = [(CAMCaptureRequest *)v12 persistenceUUID];
    [(CAMViewfinderViewController *)self _setFRSVAnalyticsId:v27];

    [v24 trackFrontRearSimultaneousVideoPIPMoveToAnchor:{-[CAMViewfinderViewController _frontRearSimultaneousVideoPIPAnchor](self, "_frontRearSimultaneousVideoPIPAnchor")}];
  }

  v28 = v39;
  if ([v39 sharedLibraryEnabled] && !-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"))
  {
    v29 = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMMutableVideoCaptureRequest setSharedLibraryMode:](v12, "setSharedLibraryMode:", [v29 sharedLibraryMode]);

    if ([v16 isInternalInstall])
    {
      v30 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v31 = [v30 librarySelectionDiagnostics];
      [(CAMMutableVideoCaptureRequest *)v12 setSharedLibraryDiagnostics:v31];
    }

    v28 = v39;
    if ([v16 peopleProximityPersistenceSupported])
    {
      v32 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v33 = [v32 acquiredSignalResults];

      v34 = [v33 identitiesInProximity];
      v35 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(v34);
      [(CAMMutableVideoCaptureRequest *)v12 setContactIDsInProximity:v35];

      v28 = v39;
    }
  }

  return v12;
}

- (BOOL)_startCapturingVideoWithRequest:(id)a3
{
  v4 = a3;
  if ([v4 persistenceOptions] == 3 && (objc_msgSend(v4, "localDestinationURL"), v5 = objc_claimAutoreleasedReturnValue(), v5, !v5))
  {
    v13 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingVideoWithRequest:];
    }

    [(CAMViewfinderViewController *)self _showExternalStorageRecordingFailedAlert];
    v8 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v8 resetAnimated:1];
    v7 = 0;
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _captureController];
    v14 = 0;
    v7 = [v6 startCapturingVideoWithRequest:v4 error:&v14];
    v8 = v14;
    if (v7)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
      v9 = [(CAMViewfinderViewController *)self _previewViewController];
      [v9 notifyWillStartCapturing];
      v10 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v10 didCaptureWithRequest:v4 currentConfiguration:v11];
    }

    else
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start video capture"];
    }
  }

  return v7;
}

- (BOOL)_stopCapturingVideo
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 stopCapturingVideo];
  [MEMORY[0x1E69DD258] attemptRotationToDeviceOrientation];
  [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:1];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1 updateProResControls:0];
  v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v5 resetAnimated:1];

  v6 = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  if (v4 && v6)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  if (v4)
  {
    if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
    {
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to stop video capture"];
  }

  return v4;
}

- (BOOL)_pauseCapturingVideo
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 pauseCapturingVideo];
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v5 setPausedDuringVideo:1 animated:1];

    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v7 = [v6 elapsedTimeView];
    [v7 setTimerPaused:1];

    v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v9 = [v8 elapsedTimeView];
    [v9 setBackgroundStyle:2 animated:1];

    v10 = [(CAMViewfinderViewController *)self _remoteShutterController];
    v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v12 = [v11 elapsedTimeView];
    v13 = [v12 pausedTime];
    [v10 didPauseCaptureTimerWithPauseTime:v13];

    v14 = [(CAMViewfinderViewController *)self _idleController];
    [v14 updateForVideoPaused];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  return v4;
}

- (BOOL)_resumeCaptureVideo
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 resumeCaptureVideo];
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v5 setPausedDuringVideo:0 animated:1];

    v6 = [(CAMViewfinderViewController *)self _idleController];
    [v6 updateForVideoResumed];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  return v4;
}

- (int64_t)_resolvedColorSpaceForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 videoEncodingBehavior:(int64_t)a5 device:(int64_t)a6
{
  v11 = +[CAMUserPreferences preferences];
  v12 = [v11 explicitProResColorSpace];
  v13 = [(CAMViewfinderViewController *)self chromeViewController];

  if (v13)
  {
    v12 = [(CAMViewfinderViewController *)self _chromeSelectedProResColorSpace];
  }

  v14 = [v11 colorSpaceForMode:a3 videoConfiguration:a4 videoEncodingBehavior:a5 device:a6 preferredProResColorSpace:v12];

  return v14;
}

- (void)videoRequestDidStartCapturing:(id)a3
{
  v10 = a3;
  v4 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    v6 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v6 viewfinderViewController:self didReceiveVideoRequestDidStartCapturing:v10];
  }

  v7 = [(CAMViewfinderViewController *)self _idleController];
  [v7 videoRequestDidStartCapturing:v10];
  v8 = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
  [v8 startTimer];
  [v8 setBackgroundStyle:1 animated:1];
  v9 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v9 didStartCaptureTimer];

  [(CAMViewfinderViewController *)self _limitZoomRangeForRecordingIfNecessary];
  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (void)videoRequestDidStopCapturing:(id)a3
{
  v15 = a3;
  v4 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    v6 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v6 viewfinderViewController:self didReceiveVideoRequestDidStopCapturing:v15];
  }

  v7 = [(CAMViewfinderViewController *)self _captureController];
  if (([v7 isCapturingVideo] & 1) == 0)
  {
    v8 = [(CAMViewfinderViewController *)self _idleController];
    [v8 videoRequestDidStopCapturing:v15];
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    v9 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v10 = [v15 persistenceUUID];
    v11 = [v9 objectForKeyedSubscript:v10];

    [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v11];
    [(CAMViewfinderViewController *)self _restoreZoomRangeAfterRecordingIfNecessary];
    [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    if ([(CAMViewfinderViewController *)self _trueVideoIsCapturing])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
    }

    v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v13 = [v12 enableDepthSuggestion];

    v14 = [(CAMViewfinderViewController *)self _captureController];
    [v14 updateCaptureButtonControlsForCaptureMode:-[CAMViewfinderViewController _currentMode](self devicePosition:"_currentMode") isRecording:-[CAMViewfinderViewController _currentDevicePosition](self depthSuggestionEnabled:{"_currentDevicePosition"), -[CAMViewfinderViewController isRecording](self, "isRecording"), v13}];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }
}

- (void)videoRequestDidCompleteCapture:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v13 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    v12 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v12 viewfinderViewController:self didReceiveVideoRequestDidCompleteCapture:v13 withResponse:v8 error:v9];
  }

  [(CAMViewfinderViewController *)self _captureRequest:v13 didCompleteVideoCaptureWithResponse:v8 error:v9];
}

- (void)_captureRequest:(id)a3 didCompleteVideoCaptureWithResponse:(id)a4 error:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(CAMViewfinderViewController *)self _captureController];
  if (([v11 isCapturingBurst] & 1) == 0 && (objc_msgSend(v11, "isCapturingVideo") & 1) == 0)
  {
    v12 = [v11 isCapturingNightModeImage];
    if (v10)
    {
      goto LABEL_4;
    }

LABEL_6:
    v13 = 0;
    goto LABEL_7;
  }

  v12 = 1;
  if (!v10)
  {
    goto LABEL_6;
  }

LABEL_4:
  v13 = CAMErrorIsVideoCaptureRequestError(v10, -28003) ^ 1;
LABEL_7:
  if (!(v12 & 1 | ((([v9 stoppedUnexpectedly] | v13) & 1) == 0)))
  {
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    v14 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v14 resetAnimated:1];

    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }

  v15 = [v9 coordinationInfo];
  v16 = v15;
  if (v15)
  {
    v17 = [v15 representsFinalProcessedVideo];
    if (v10 || (v17 & 1) == 0)
    {
      if (v10)
      {
        goto LABEL_22;
      }

      goto LABEL_19;
    }
  }

  else if (v10)
  {
    goto LABEL_22;
  }

  v18 = [(CAMViewfinderViewController *)self _cameraRollController];
  v19 = [v9 sessionIdentifier];
  v20 = [v9 persistenceUUID];
  if ([v18 isCaptureSessionCurrent:v19])
  {
    [v18 willPersistAssetWithUUID:v20 captureSession:v19];
    v21 = [v9 imageWellImage];
    [(CAMViewfinderViewController *)self _presentImageWellImage:v21 uuid:v20 animated:1];
    v22 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v22 sendThumbnailImage:v21 isVideo:1];
  }

LABEL_19:
  if ([(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:v16])
  {
    v23 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v23 processTransientAssetUpdate:v9 preventingInsertion:0 persistenceOptions:{objc_msgSend(v8, "persistenceOptions")}];
  }

  v24 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v25 = [v8 persistenceUUID];
  v26 = [v24 objectForKeyedSubscript:v25];

  [v26 populateFromVideoCaptureResponse:v9];
  [v26 publish];

LABEL_22:
  v27 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v28 = [v8 persistenceUUID];
  [v27 removeObjectForKey:v28];

  [(CAMViewfinderViewController *)self _setFRSVAnalyticsId:0];
  v29 = [v9 reason];
  if (v29 == 3)
  {
    v30 = @"MAX_RECORDING_FILE_SIZE_REACHED";
  }

  else
  {
    if (v29 != 2)
    {
      if (v29 == 1)
      {
        [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:1];
        [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
      }

      goto LABEL_30;
    }

    v30 = @"MAX_RECORDING_DURATION_REACHED";
  }

  v31 = CAMLocalizedFrameworkString(v30, 0);
  if (v31)
  {
    v32 = v31;
    v33 = MEMORY[0x1E69DC650];
    v34 = CAMLocalizedFrameworkString(@"RECORDING_STOPPED_TITLE", 0);
    v35 = [v33 alertControllerWithTitle:v34 message:v32 preferredStyle:1];

    v36 = MEMORY[0x1E69DC648];
    v37 = CAMLocalizedFrameworkString(@"OK", 0);
    v38 = [v36 actionWithTitle:v37 style:1 handler:0];
    [v35 addAction:v38];

    v39 = [(CAMViewfinderViewController *)self view];
    v40 = [v39 window];

    [v40 pl_presentViewController:v35 animated:1];
    goto LABEL_32;
  }

LABEL_30:
  if ([v9 slowWriterFrameDrops])
  {
    [(CAMViewfinderViewController *)self _showFrameDropsAlert];
  }

LABEL_32:
  if ([(CAMViewfinderViewController *)self _resolvedTorchMode]== 2)
  {
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _configuredMode]];
  }

  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled]&& ![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v41 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
    {
      *v42 = 0;
      _os_log_impl(&dword_1A3640000, v41, OS_LOG_TYPE_DEFAULT, "External storage: enabling deferred SSD output on didCompleteVideoCaptureWithResponse", v42, 2u);
    }

    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
  }
}

- (void)videoRequestDidCompleteLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v16 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    v12 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v12 viewfinderViewController:self didReceiveVideoRequestDidCompleteLocalPersistence:v16 withResponse:v8 error:v9];
  }

  if (!v9)
  {
    v13 = [v8 coordinationInfo];
    v14 = [(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:v13];

    if (v14)
    {
      v15 = [(CAMViewfinderViewController *)self _cameraRollController];
      [v15 processTransientAssetUpdate:v8 preventingInsertion:0 persistenceOptions:{objc_msgSend(v16, "persistenceOptions")}];
    }
  }
}

- (void)videoRequestDidCompleteRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v16 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    v12 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [v12 viewfinderViewController:self didReceiveVideoRequestDidCompleteRemotePersistence:v16 withResponse:v8 error:v9];
  }

  if (!v9)
  {
    v13 = [v8 persistenceUUID];
    v14 = [v8 sessionIdentifier];
    v15 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v15 processTransientAssetUpdate:v8 preventingInsertion:1 persistenceOptions:{objc_msgSend(v16, "persistenceOptions")}];
    [v15 didPersistAssetWithUUID:v13 captureSession:v14];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
}

- (void)videoRequestDidResumeCapturing:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v13 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "CAMViewfinderViewController videoRequestDidResumeCapturing", v13, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [v5 elapsedTimeView];
  [v6 setTimerPaused:0];

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 elapsedTimeView];
  [v8 setBackgroundStyle:1 animated:1];

  v9 = [(CAMViewfinderViewController *)self _remoteShutterController];
  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = [v10 elapsedTimeView];
  v12 = [v11 startTime];
  [v9 didResumeCaptureTimerWithNewStartTime:v12];

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (id)_panoramaCaptureRequestWithCurrentSettings
{
  v3 = [(CAMViewfinderViewController *)self _motionController];
  v4 = [(CAMViewfinderViewController *)self _cameraRollController];
  v5 = [v3 panoramaCaptureOrientation];
  v6 = objc_alloc_init(CAMMutablePanoramaCaptureRequest);
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureOrientation:v5];
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureDevice:[(CAMViewfinderViewController *)self _currentDevice]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureMode:[(CAMViewfinderViewController *)self _currentMode]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setDelegate:self];
  v26 = v4;
  -[CAMMutablePanoramaCaptureRequest setSessionIdentifier:](v6, "setSessionIdentifier:", [v4 sessionIdentifier]);
  v7 = [(CAMViewfinderViewController *)self _locationController];
  v8 = [v7 currentLocation];
  if (v8)
  {
    [(CAMMutablePanoramaCaptureRequest *)v6 setLocation:v8];
  }

  v9 = [v7 headingForOrientation:v5];
  if (v9)
  {
    [(CAMMutablePanoramaCaptureRequest *)v6 setHeading:v9];
  }

  v10 = +[CAMCaptureCapabilities capabilities];
  if ([v10 isInternalInstall])
  {
    v11 = +[CAMUserPreferences preferences];
    -[CAMMutablePanoramaCaptureRequest setShouldDelayRemotePersistence:](v6, "setShouldDelayRemotePersistence:", [v11 shouldDelayRemotePersistence]);
  }

  v12 = [(CAMViewfinderViewController *)self persistenceBehavior];
  [(CAMMutablePanoramaCaptureRequest *)v6 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:v12 allowingOptionalLocalPersistence:0]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:v12]];
  v13 = +[CAMUserPreferences preferences];
  -[CAMMutablePanoramaCaptureRequest setPhotoEncodingBehavior:](v6, "setPhotoEncodingBehavior:", [v13 photoEncodingBehavior]);
  if ([v13 sharedLibraryEnabled])
  {
    v25 = v3;
    v14 = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMMutablePanoramaCaptureRequest setSharedLibraryMode:](v6, "setSharedLibraryMode:", [v14 sharedLibraryMode]);

    if ([v10 isInternalInstall])
    {
      v15 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v16 = [v15 librarySelectionDiagnostics];
      [(CAMMutablePanoramaCaptureRequest *)v6 setSharedLibraryDiagnostics:v16];
    }

    v3 = v25;
    if ([v10 peopleProximityPersistenceSupported])
    {
      v17 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v18 = [v17 acquiredSignalResults];

      v19 = [v18 identitiesInProximity];
      v20 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(v19);
      [(CAMMutablePanoramaCaptureRequest *)v6 setContactIDsInProximity:v20];

      v3 = v25;
    }
  }

  [(CAMViewfinderViewController *)self _updateOriginForRequest:v6];
  [(CAMMutablePanoramaCaptureRequest *)v6 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];
  v21 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v6 burst:0];
  v22 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v23 = [(CAMCaptureRequest *)v6 persistenceUUID];
  [v22 setObject:v21 forKey:v23];

  return v6;
}

- (BOOL)_startCapturingPanoramaWithRequest:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v11 = 0;
  v6 = [v5 startCapturingPanoramaWithRequest:v4 error:&v11];
  v7 = v11;
  if (v6)
  {
    [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
    v8 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [v8 didCaptureWithRequest:v4 currentConfiguration:v9];
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start panorama capture"];
    v8 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingPanoramaWithRequest:];
    }
  }

  return v6;
}

- (BOOL)_stopCapturingPanorama
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 stopCapturingPanoramaInterrupted:0];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
  v5 = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  if (v4 && v5)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  return v4;
}

- (void)panoramaRequestDidStartCapturing:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _idleController];
  [v5 panoramaRequestDidStartCapturing:v4];
  v6 = [(CAMViewfinderViewController *)self _panoramaViewController];
  v7 = [v6 analyticsCaptureEvent];
  if (v7)
  {
    v8 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController panoramaRequestDidStartCapturing:];
    }
  }

  v9 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v10 = [v4 persistenceUUID];
  v11 = [v9 objectForKeyedSubscript:v10];

  [v6 setAnalyticsCaptureEvent:v11];
  v12 = [(CAMViewfinderViewController *)self _dockKitController];
  v13 = [v6 panoramaView];
  [v12 panoramaCaptureDidStart:{objc_msgSend(v13, "direction")}];
}

- (void)panoramaRequest:(id)a3 didGeneratePaintingStatus:(id)a4
{
  v5 = a4;
  v6 = [(CAMViewfinderViewController *)self _panoramaViewController];
  [v6 updateWithStatus:v5];
}

- (void)panoramaRequestDidStopCapturing:(id)a3 interrupted:(BOOL)a4
{
  v4 = a4;
  v12 = a3;
  v6 = [(CAMViewfinderViewController *)self _panoramaViewController];
  [v6 startProcessingPanorama];
  v7 = [(CAMViewfinderViewController *)self _captureController];
  if (([v7 isCapturingPanorama] & 1) == 0)
  {
    [v6 setAnalyticsCaptureEvent:0];
    v8 = [(CAMViewfinderViewController *)self _idleController];
    [v8 panoramaRequestDidStopCapturing:v12 interrupted:v4];
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if (v4)
    {
      v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v9 resetAnimated:1];
    }

    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    v10 = [(CAMViewfinderViewController *)self _dockKitController];
    v11 = [v6 panoramaView];
    [v10 panoramaCaptureDidStop:{objc_msgSend(v11, "direction")}];
  }
}

- (void)panoramaRequestDidCompleteCapture:(id)a3 withResponse:(id)a4 error:(id)a5
{
  v17 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(CAMViewfinderViewController *)self _panoramaViewController];
  [v10 finishedProcessingPanorama];
  [(CAMViewfinderViewController *)self _updateImageWellWithStillImageResponse:v8 forRequest:v17 error:v9];

  if (v9)
  {
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }

  else
  {
    v11 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v11 processTransientAssetUpdate:v8 preventingInsertion:0 persistenceOptions:{objc_msgSend(v17, "persistenceOptions")}];
    v12 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v13 = [v17 persistenceUUID];
    v14 = [v12 objectForKeyedSubscript:v13];

    [v14 populateFromStillImageCaptureResponse:v8];
    [v14 publish];
  }

  [v10 setAnalyticsCaptureEvent:0];
  v15 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v16 = [v17 persistenceUUID];
  [v15 removeObjectForKey:v16];
}

- (void)panoramaRequestDidCompleteLocalPersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  if (!a5)
  {
    v8 = a4;
    v9 = a3;
    v11 = [(CAMViewfinderViewController *)self _cameraRollController];
    v10 = [v9 persistenceOptions];

    [v11 processTransientAssetUpdate:v8 preventingInsertion:0 persistenceOptions:v10];
  }
}

- (void)panoramaRequestDidCompleteRemotePersistence:(id)a3 withResponse:(id)a4 error:(id)a5
{
  if (!a5)
  {
    v7 = a4;
    v8 = a3;
    v9 = [v7 persistenceUUID];
    v10 = [v7 sessionIdentifier];
    v11 = [(CAMViewfinderViewController *)self _cameraRollController];
    v12 = [v8 persistenceOptions];

    [v11 processTransientAssetUpdate:v7 preventingInsertion:1 persistenceOptions:v12];
    [v11 didPersistAssetWithUUID:v9 captureSession:v10];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, a4];
}

- (void)panoramaRequest:(id)a3 didStopWithReason:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v8 = [v6 persistenceUUID];

  v9 = [v7 objectForKeyedSubscript:v8];

  [v9 populateFromPanoramaCaptureStoppingReason:a4];
}

- (BOOL)_isCapturingTimelapse
{
  if ([(CAMViewfinderViewController *)self _currentMode]!= 5)
  {
    return 0;
  }

  v3 = [(CAMViewfinderViewController *)self _timelapseController];
  v4 = [v3 isCapturing];

  return v4;
}

- (BOOL)_startTimelapse
{
  v3 = [(CAMViewfinderViewController *)self _timelapseController];
  v4 = [(CAMViewfinderViewController *)self _cameraRollController];
  v5 = [v3 delegate];

  if (v5 != self)
  {
    [v3 setDelegate:self];
  }

  v6 = [v3 startCapturingWithCaptureDevice:-[CAMViewfinderViewController _currentDevice](self captureSession:{"_currentDevice"), objc_msgSend(v4, "sessionIdentifier")}];
  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [v7 didCaptureTimelapseWithConfiguration:v8];
  }

  return v6;
}

- (BOOL)_stopTimelapse
{
  v2 = [(CAMViewfinderViewController *)self _timelapseController];
  v3 = [v2 stopCapturingWithReasons:1];

  return v3;
}

- (void)timelapseController:(id)a3 startedWithCaptureOrientation:(int64_t)a4
{
  [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
  v6 = [(CAMViewfinderViewController *)self _idleController];
  [v6 timelapseRequestDidStartCapturing];
  v5 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventForTimelapse];
  [(CAMViewfinderViewController *)self set_timelapseAnalyticsEvent:v5];
}

- (void)timelapseControllerStopped:(id)a3
{
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  v6 = [(CAMViewfinderViewController *)self _idleController];
  [v6 timelapseRequestDidStopCapturing];
  v4 = +[CAMApplication appOrPlugInState]!= 2;
  v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v5 resetAnimated:v4];

  [(CAMViewfinderViewController *)self set_timelapseAnalyticsEvent:0];
}

- (void)timelapseController:(id)a3 generatedPlaceholderResult:(id)a4 withThumbnailImage:(id)a5 forAssetUUID:(id)a6 inCaptureSession:(unsigned __int16)a7
{
  v7 = a7;
  v20 = a3;
  v12 = a4;
  v13 = a5;
  v14 = a6;
  if (v12)
  {
    v15 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v15 processTransientAssetUpdate:v12 preventingInsertion:0 persistenceOptions:2];
  }

  if (v13)
  {
    v16 = [(CAMViewfinderViewController *)self _cameraRollController];
    if ([v16 isCaptureSessionCurrent:v7])
    {
      [v16 willPersistAssetWithUUID:v14 captureSession:v7];
      [(CAMViewfinderViewController *)self _presentImageWellImage:v13 uuid:v14 animated:1];
      v17 = [(CAMViewfinderViewController *)self _remoteShutterController];
      [v17 sendThumbnailImage:v13 isVideo:1];
    }

    v18 = [(CAMViewfinderViewController *)self _timelapseAnalyticsEvent];
    [v12 timelapseDuration];
    [v18 populateDuration:?];

    v19 = [(CAMViewfinderViewController *)self _timelapseAnalyticsEvent];
    [v19 publish];
  }
}

- (void)timelapseController:(id)a3 persistedPlaceholderResult:(id)a4 error:(id)a5
{
  if (!a5)
  {
    v6 = a4;
    v7 = [v6 assetUUID];
    v8 = [v6 sessionIdentifier];
    v9 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v9 processTransientAssetUpdate:v6 preventingInsertion:1 persistenceOptions:2];

    [v9 didPersistAssetWithUUID:v7 captureSession:v8];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, a4];
}

- (void)generateAnalyticsSessionEventIfNeeded
{
  v3 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];

  if (!v3)
  {
    v10 = +[CAMCaptureCapabilities capabilities];
    v4 = [CAMAnalyticsSessionEvent alloc];
    v5 = [(CAMViewfinderViewController *)self _supportedCaptureModes];
    v6 = [(CAMViewfinderViewController *)self _currentMode];
    v7 = [(CAMViewfinderViewController *)self _currentDevice];
    v8 = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v9 = [(CAMAnalyticsSessionEvent *)v4 initWithCapabilities:v10 availableCaptureModes:v5 currentCaptureMode:v6 currentCaptureDevice:v7 callStatusMonitor:v8];
    [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:v9];
  }
}

- (void)generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:(int64_t)a3 captureDevice:(int64_t)a4
{
  v7 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];

  if (v7)
  {
    v12 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [v12 setFirstConfiguredCaptureMode:a3 captureDevice:a4];
  }

  else
  {
    v12 = +[CAMCaptureCapabilities capabilities];
    v8 = [CAMAnalyticsSessionEvent alloc];
    v9 = [(CAMViewfinderViewController *)self _supportedCaptureModes];
    v10 = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v11 = [(CAMAnalyticsSessionEvent *)v8 initWithCapabilities:v12 availableCaptureModes:v9 currentCaptureMode:a3 currentCaptureDevice:a4 callStatusMonitor:v10];
    [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:v11];
  }
}

- (void)_handleSessionWasPrewarmed:(id)a3
{
  v4 = [a3 userInfo];
  v6 = [v4 objectForKeyedSubscript:*MEMORY[0x1E6986A38]];

  [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
  v5 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v5 didPrewarmWithReason:v6];
}

- (BOOL)handleURLIfNeeded:(id)a3
{
  v29 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if ([v4 isConfigurationURL])
  {
    v5 = [v4 configurationRequest];
    v6 = v5;
    v7 = v5 != 0;
    if (v5)
    {
      if ([v5 wantsQRCodeForSession])
      {
        v8 = +[CAMUserPreferences preferences];
        [v8 setForceEnableQRBanners:1];
        v9 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Launched with a URL request to force enable QR scanning", buf, 2u);
        }
      }

      v10 = [v6 requestedCaptureMode];
      if (v10 > 9)
      {
        v24 = 0;
      }

      else
      {
        v24 = off_1E76FA1E8[v10];
      }

      v11 = [v6 requestedCaptureDevice];
      if (v11 > 0xB)
      {
        v12 = 0;
      }

      else
      {
        v12 = off_1E76F9E10[v11];
      }

      v13 = [v6 requestedCaptureMode];
      v14 = [(CAMViewfinderViewController *)self currentCaptureMode];
      v15 = [v6 requestedCaptureDevice] - 1;
      if (v15 > 0xA)
      {
        v16 = 0;
      }

      else
      {
        v16 = qword_1A3A685B0[v15];
      }

      v17 = [(CAMViewfinderViewController *)self currentCaptureDevice]- 1;
      if (v17 > 0xA)
      {
        v18 = 0;
      }

      else
      {
        v18 = qword_1A3A685B0[v17];
      }

      if ([(CAMViewfinderViewController *)self isRecording])
      {
        v19 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543618;
          v26 = v24;
          v27 = 2114;
          v28 = v12;
          _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "Ignoring URL request mode:%{public}@ device:%{public}@ because device is recording", buf, 0x16u);
        }
      }

      else
      {
        v20 = os_log_create("com.apple.camera", "Camera");
        v21 = os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT);
        if (v13 == v14 && v16 == v18)
        {
          if (v21)
          {
            *buf = 138543618;
            v26 = v24;
            v27 = 2114;
            v28 = v12;
            _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Ignoring URL request since already configured for mode:%{public}@ device:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          if (v21)
          {
            *buf = 138543618;
            v26 = v24;
            v27 = 2114;
            v28 = v12;
            _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Launched with a URL request for mode:%{public}@ device:%{public}@", buf, 0x16u);
          }

          -[CAMViewfinderViewController changeToMode:device:](self, "changeToMode:device:", [v6 requestedCaptureMode], objc_msgSend(v6, "requestedCaptureDevice"));
        }

        -[CAMViewfinderViewController generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:captureDevice:](self, "generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:captureDevice:", [v6 requestedCaptureMode], objc_msgSend(v6, "requestedCaptureDevice"));
      }

      v22 = [(CAMViewfinderViewController *)self _cameraRollController];
      if ([v22 isCameraRollViewControllerPresented])
      {
        [v22 dismissCameraRollViewControllerForced:1 animated:1];
      }
    }
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)_populateZoomForCaptureEvent:(id)a3
{
  v12 = a3;
  v4 = [(CAMViewfinderViewController *)self _zoomControl];
  v5 = [(CAMViewfinderViewController *)self _lastZoomInteractionType];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [v6 mode], objc_msgSend(v6, "devicePosition"));
  if (v4)
  {
    v8 = [v4 zoomButtonContentType];
    if (v8 == 2)
    {
LABEL_5:
      [v4 displayZoomValue];
      v10 = v9;
      v11 = [v4 zoomPoints];
      [v12 populateZoomFromDisplayZoomValue:v11 zoomPoints:v5 zoomInteractionType:v10];

      goto LABEL_8;
    }

    if (v8 != 1)
    {
      if (v8)
      {
        goto LABEL_8;
      }

      goto LABEL_5;
    }

    [v12 populateZoomFromZoomButtonSymbol:objc_msgSend(v4 zoomInteractionType:{"zoomButtonSymbol"), v5}];
  }

  else
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [v12 populateZoomFromDisplayZoomValue:0 zoomPoints:v5 zoomInteractionType:?];
  }

LABEL_8:
  [v12 populateZoomFieldOfView:v7 graphConfiguration:v6 smartFramingSource:{-[CAMViewfinderViewController _smartFramingFieldOfViewSource](self, "_smartFramingFieldOfViewSource")}];
}

- (id)_generateAnalyticsCaptureEventWithRequest:(id)a3 burst:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [[CAMAnalyticsCaptureEvent alloc] initWithGraphConfiguration:v7 outputToExternalStorage:[(CAMViewfinderViewController *)self _externalStorageOutputEnabled]];
  v9 = [(CAMViewfinderViewController *)self _previewViewController];
  v10 = [v6 type];
  if (v10 == 2)
  {
    [(CAMAnalyticsCaptureEvent *)v8 populateFromPanoramaCaptureRequest:v6];
    v11 = [(CAMViewfinderViewController *)self _panoramaViewController];
    v12 = [v11 panoramaView];
    -[CAMAnalyticsCaptureEvent populatePanoramaDirection:](v8, "populatePanoramaDirection:", [v12 direction]);
  }

  else if (v10 == 1)
  {
    v11 = +[CAMUserPreferences preferences];
    [(CAMAnalyticsCaptureEvent *)v8 populateFromVideoCaptureRequest:v6 preferences:v11];
  }

  else
  {
    if (v10)
    {
      goto LABEL_8;
    }

    v11 = +[CAMUserPreferences preferences];
    [(CAMAnalyticsCaptureEvent *)v8 populateFromStillImageCaptureRequest:v6 burst:v4 preferences:v11];
  }

LABEL_8:
  [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v8];
  [(CAMAnalyticsCaptureEvent *)v8 populateDesiredFlashMode:[(CAMViewfinderViewController *)self _desiredFlashMode] desiredLivePhotoMode:[(CAMViewfinderViewController *)self _desiredLivePhotoMode] desiredHDRMode:[(CAMViewfinderViewController *)self _desiredHDRMode] timerDuration:[(CAMViewfinderViewController *)self _resolvedTimerDuration]];
  [(CAMAnalyticsCaptureEvent *)v8 populateDesiredTorchMode:[(CAMViewfinderViewController *)self _desiredTorchMode]];
  [v9 baselineExposureBias];
  v14 = v13;
  [v9 cachedExposureTargetBias];
  v16 = v15;
  [v9 totalExposureBias];
  LODWORD(v18) = v17;
  LODWORD(v19) = v14;
  LODWORD(v20) = v16;
  [(CAMAnalyticsCaptureEvent *)v8 populateExposureSliderBias:v19 exposureTapAndBias:v20 totalExposureBias:v18];
  v21 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  v23 = v22;
  [(CAMViewfinderViewController *)self _portraitModeApertureValue];
  v25 = v24;
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  v38 = v6;
  [(CAMAnalyticsCaptureEvent *)v8 populatePortraitStatus:v21 lightingEffectIntensity:[(CAMViewfinderViewController *)self _isDepthSuggestionAllowedForCurrentConfigurationIsBurst:v4] apertureValue:v6 zoomFactor:v23 isDepthSuggestionAllowed:v25 request:v26];
  v27 = [(CAMViewfinderViewController *)self _captureController];
  -[CAMAnalyticsCaptureEvent populateDesiredNightModeControlMode:resolvedNightModeControlMode:resolvedNightMode:nightModeStatus:](v8, "populateDesiredNightModeControlMode:resolvedNightModeControlMode:resolvedNightMode:nightModeStatus:", -[CAMViewfinderViewController _desiredNightModeControlMode](self, "_desiredNightModeControlMode"), -[CAMViewfinderViewController _resolvedNightModeControlMode](self, "_resolvedNightModeControlMode"), -[CAMViewfinderViewController _resolvedNightMode](self, "_resolvedNightMode"), [v27 nightModeStatus]);
  v28 = [v7 mode];
  v29 = [v7 devicePosition];
  v30 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  if (![CAMConflictingControlConfiguration shouldDisableMacroForLockedPortraitForMode:v28 devicePosition:v29 photoFormat:v30 optionalDepthEffectEnabled:v31, [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]])
  {
    v32 = [(CAMViewfinderViewController *)self _autoMacroSuggested];
    v33 = v32 && [(CAMViewfinderViewController *)self _autoMacroActive];
    [(CAMAnalyticsCaptureEvent *)v8 populateDesiredMacroMode:[(CAMViewfinderViewController *)self _desiredMacroMode] isMacroCapture:v33 isMacroSuggested:v32];
  }

  if (![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v34 = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMAnalyticsCaptureEvent populateSharedLibraryMode:](v8, "populateSharedLibraryMode:", [v34 sharedLibraryMode]);
  }

  [(CAMAnalyticsCaptureEvent *)v8 populateObjectResultsWithNumberOfFaces:[(CAMViewfinderViewController *)self _faceCount] numberOfCats:[(CAMViewfinderViewController *)self _catCount] numberOfDogs:[(CAMViewfinderViewController *)self _dogCount]];
  v35 = [(CAMViewfinderViewController *)self _motionController];
  v36 = [v35 deviceOrientation];

  [(CAMAnalyticsCaptureEvent *)v8 populateDeviceOrientation:v36 isDeviceOrientationLocked:CAMIsDeviceOrientationLocked()];

  return v8;
}

- (id)_generateAnalyticsCaptureEventForTimelapse
{
  v3 = [CAMAnalyticsCaptureEvent alloc];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMAnalyticsCaptureEvent *)v3 initWithGraphConfiguration:v4 outputToExternalStorage:0];

  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  v7 = [(CAMViewfinderViewController *)self _motionController];
  v8 = [v7 captureOrientation];

  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = +[CAMUserPreferences preferences];
  v11 = [v9 device] - 1;
  if (v11 > 0xA)
  {
    v12 = 0;
  }

  else
  {
    v12 = qword_1A3A685B0[v11];
  }

  v13 = [v10 mirrorCameraCapturesForDevicePosition:v12 mode:5];

  v14 = [(CAMViewfinderViewController *)self _currentCaptureRequestOrigin];
  v15 = [MEMORY[0x1E695DF00] now];
  [(CAMAnalyticsCaptureEvent *)v5 populateForTimelapseCaptureOrientation:v8 captureMirrored:v13 origin:v14 pressType:-1 startDate:v15];

  [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v5];
  [v6 baselineExposureBias];
  v17 = v16;
  [v6 cachedExposureTargetBias];
  v19 = v18;
  [v6 totalExposureBias];
  LODWORD(v21) = v20;
  LODWORD(v22) = v17;
  LODWORD(v23) = v19;
  [(CAMAnalyticsCaptureEvent *)v5 populateExposureSliderBias:v22 exposureTapAndBias:v23 totalExposureBias:v21];

  return v5;
}

- (int64_t)_persistenceOptionsForBehavior:(unint64_t)a3 allowingOptionalLocalPersistence:(BOOL)a4
{
  v4 = a4;
  v6 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v7 = 2;
  if (a3 == 2)
  {
    v7 = 1;
  }

  if (a3 == 3)
  {
    v7 = !v4;
  }

  if (v6)
  {
    return 3;
  }

  else
  {
    return v7;
  }
}

- (int64_t)_temporaryPersistenceOptionsForBehavior:(unint64_t)a3
{
  if (a3 - 1 > 2)
  {
    return 0;
  }

  else
  {
    return qword_1A3A68350[a3 - 1];
  }
}

- (void)_setResolvedTimerDuration:(int64_t)a3
{
  if (self->__resolvedTimerDuration != a3)
  {
    self->__resolvedTimerDuration = a3;
    v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v6 setTimerDuration:a3];

    v7 = [(CAMViewfinderViewController *)self _timerIndicatorView];
    if (v7)
    {
      v10 = [(CAMViewfinderViewController *)self _timerIndicatorView];
    }

    else
    {
      v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v10 = [v8 timerIndicator];
    }

    if ((a3 - 1) > 2)
    {
      v9 = 0;
    }

    else
    {
      v9 = qword_1A3A68368[a3 - 1];
    }

    [v10 resetWithNumberOfTicks:v9 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
  }
}

- (void)_setTimerDurationAndUpdateUI:(int64_t)a3 animated:(BOOL)a4
{
  v4 = a4;
  [(CAMTimerButton *)self->__timerButton setDuration:?];
  [(CAMViewfinderViewController *)self _setResolvedTimerDuration:a3];
  v7 = [(CAMViewfinderViewController *)self _controlDrawer];
  v8 = [v7 timerButton];
  [v8 setTimerDuration:a3];

  v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v10 = [v9 controlStatusBar];
  v11 = [v10 timerIndicator];
  [v11 setTimerDuration:a3];

  v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v12 animated:v4];

  v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v13 isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:v4];

  v14 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v14 setTimerDuration:a3];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
  v15 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if (v15)
  {
    v18 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  }

  else
  {
    v16 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v18 = [v16 timerIndicator];
  }

  if ((a3 - 1) > 2)
  {
    v17 = 0;
  }

  else
  {
    v17 = qword_1A3A68368[a3 - 1];
  }

  [v18 resetWithNumberOfTicks:v17 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
}

- (void)_setCapturingFromTimer:(BOOL)a3
{
  if (self->__capturingFromTimer != a3)
  {
    v4 = a3;
    self->__capturingFromTimer = a3;
    v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v6 setIsCapturingFromTimer:v4];

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capturing from timer"];
  }
}

- (void)_startCountdownForCaptureTimer
{
  v3 = [(CAMViewfinderViewController *)self _librarySelectionController];
  -[CAMViewfinderViewController set_cachedSharedLibraryTimerState:](self, "set_cachedSharedLibraryTimerState:", [v3 sharedLibraryMode]);

  [(CAMViewfinderViewController *)self _setCapturingFromTimer:1];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _setupAndStartSynchronizedCaptureTimerDelegate];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v4 isCapturing:1 animated:1];

  [(CAMViewfinderViewController *)self _indicateCaptureTimerProgressUsingTorch];
}

- (void)_stopCountdownForCaptureTimer
{
  v19 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self _remainingCaptureTimerTicks];
  [(CAMViewfinderViewController *)self _setCapturingFromTimer:0];
  [(CAMViewfinderViewController *)self _teardownSynchronizedCaptureTimerDelegate];
  [(CAMViewfinderViewController *)self _teardownBurstTimer];
  [(CAMViewfinderViewController *)self _stopCapturingBurst];
  if ([(CAMViewfinderViewController *)self _resetTimerDurationAfterDelayedCapture])
  {
    if ([(CAMViewfinderViewController *)self _isHeadphonesEventCaptureWithUserSpecifiedDuration])
    {
      [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:[(CAMViewfinderViewController *)self _resolvedTimerDuration] animated:1];
      [(CAMViewfinderViewController *)self set_isHeadphonesEventCaptureWithUserSpecifiedDuration:0];
    }

    else
    {
      [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:0 animated:1];
    }
  }

  [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:0];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v4 isCapturing:0 animated:1];

  if (![(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v5 resetAnimated:1];
  }

  v6 = [(CAMViewfinderViewController *)self _librarySelectionController];
  v7 = [v6 sharedLibraryMode];

  if ([(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState]!= v7)
  {
    v8 = os_log_create("com.apple.camera", "SharedLibrary");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      v9 = CAMSharedLibraryModeDescription(v7);
      v17 = 138543362;
      v18 = v9;
      _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Updating library selection mode to %{public}@ after timer capture ended", &v17, 0xCu);
    }

    [(CAMViewfinderViewController *)self librarySelectionDidChangeSharedLibraryMode:v7];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _stopCaptureTimerProgressUsingTorch];
  if (v3)
  {
    [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:0];
    v10 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

    if (v10)
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Timer countdown was interrupted."];
    }

    v11 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v11 countdownCanceled];

    [(CAMViewfinderViewController *)self _cancelCTMCapture];
    if ([(CAMViewfinderViewController *)self _resolvedTimerDuration])
    {
      v12 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      if (v12)
      {
        v13 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      }

      else
      {
        v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v13 = [v14 timerIndicator];
      }

      v15 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
      if (v15 > 2)
      {
        v16 = 0;
      }

      else
      {
        v16 = qword_1A3A68368[v15];
      }

      [v13 resetWithNumberOfTicks:v16 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
    }
  }
}

- (BOOL)_shouldUseBurstForCaptureTimer
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [(CAMViewfinderViewController *)self _currentDevice];
  v6 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v27 = [v4 isFlashSupportedForDevicePosition:v6];
  v7 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  v28 = v3;
  if ([(CAMViewfinderViewController *)self _resolvedFlashMode]== 2)
  {
    v8 = [v3 isFlashActive];
  }

  else
  {
    v8 = 0;
  }

  v9 = v7 == 1;
  v10 = [v4 isHDRSupportedForDevicePosition:v6];
  v11 = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  v12 = [v4 isLivePhotoSupportedForDevicePosition:v6];
  v13 = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode]- 1;
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), v5}];

  v16 = 0;
  v17 = v27 & (v9 | v8);
  if (v10 && v11 == 1)
  {
    v16 = [v4 isSmartHDRSupported] ^ 1;
  }

  if (v13 < 2)
  {
    v18 = v12;
  }

  else
  {
    v18 = 0;
  }

  v19 = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
  v20 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v21 = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  v22 = [(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
  v23 = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v24 = 0;
  if (v17 & 1 | ((v15 & 1) == 0) || (v16 & 1) != 0 || (v18 & 1) != 0 || v22)
  {
    v25 = v28;
  }

  else
  {
    v25 = v28;
    if (!v19 && v20 != 1)
    {
      v24 = v21 != 3 && !v23;
    }
  }

  return v24;
}

- (void)_setupAndStartSynchronizedCaptureTimerDelegate
{
  v3 = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  if (v3)
  {
    [(CAMViewfinderViewController *)self _teardownSynchronizedCaptureTimerDelegate];
  }

  v4 = objc_alloc_init(CAMAnimationDelegate);
  [(CAMViewfinderViewController *)self _setSynchronizedCaptureTimerDelegate:v4];
  objc_initWeak(&location, self);
  objc_initWeak(&from, v4);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke;
  v8[3] = &unk_1E76F8580;
  objc_copyWeak(&v9, &location);
  [(CAMAnimationDelegate *)v4 setStart:v8];
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke_2;
  v5[3] = &unk_1E76F9620;
  objc_copyWeak(&v6, &location);
  objc_copyWeak(&v7, &from);
  [(CAMAnimationDelegate *)v4 setCompletion:v5];
  [(CAMViewfinderViewController *)self _startSynchronizedCaptureTimerDelegate];
  objc_destroyWeak(&v7);
  objc_destroyWeak(&v6);
  objc_destroyWeak(&v9);
  objc_destroyWeak(&from);
  objc_destroyWeak(&location);
}

void __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
}

void __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v2 = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _synchronizedCaptureTimerDelegateFired:v2];
}

- (void)_startSynchronizedCaptureTimerDelegate
{
  v7 = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  v3 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
  if (v3 > 2)
  {
    v4 = 0;
  }

  else
  {
    v4 = qword_1A3A68368[v3];
  }

  [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:v4];
  v5 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if (!v5)
  {
    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v5 = [v6 timerIndicator];
  }

  [v5 stopCountdown];
  [v5 resetWithNumberOfTicks:v4 showBeforeAnimationStarts:0];
  [v5 startCountdownWithAnimationDelegate:v7];
}

- (void)_teardownSynchronizedCaptureTimerDelegate
{
  v3 = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  if (v3)
  {
    v4 = v3;
    [(CAMViewfinderViewController *)self _setSynchronizedCaptureTimerDelegate:0];
    v3 = v4;
  }
}

- (void)_synchronizedCaptureTimerDelegateFired:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v16 = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  v6 = [(CAMViewfinderViewController *)self _captureController];

  if (!v5 || v16 != v4)
  {
    goto LABEL_17;
  }

  v7 = [(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]- 1;
  [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:v7];
  v8 = [(CAMViewfinderViewController *)self _shouldUseBurstForCaptureTimer];
  v9 = [v6 isCapturingBurst];
  if (v8 && v7 == 1)
  {
    [(CAMViewfinderViewController *)self _setupBurstTimerWithDelay:0.6];
LABEL_11:
    v11 = [(CAMViewfinderViewController *)self _timerIndicatorView];
    [v11 decrement];

    v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [v12 timerIndicator];
    [v13 decrement];

    v14 = [(CAMViewfinderViewController *)self _currentBurstTimer];

    if (!v14)
    {
      [(CAMViewfinderViewController *)self _indicateCaptureTimerProgressUsingTorch];
    }

    goto LABEL_17;
  }

  if (v7)
  {
    v10 = 1;
  }

  else
  {
    v10 = v9;
  }

  if ((v10 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:[(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable]];
    v15 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

    if (v15)
    {
      [(CAMViewfinderViewController *)self _commitCTMCaptureWithType:1];
    }

    else
    {
      [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
    goto LABEL_17;
  }

  if (v7)
  {
    goto LABEL_11;
  }

LABEL_17:
}

- (void)_indicateCaptureTimerProgressUsingTorch
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 isTorchPatternSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v3 = [(CAMViewfinderViewController *)self _torchPatternController];
    v4 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
    if ((v4 - 2) >= 2)
    {
      if (v4 != 1)
      {
        goto LABEL_7;
      }
    }

    else if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]> 3)
    {
      [v3 blink];
LABEL_7:

      goto LABEL_8;
    }

    [v3 doubleBlink];
    goto LABEL_7;
  }

LABEL_8:
}

- (void)_stopCaptureTimerProgressUsingTorch
{
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 isTorchPatternSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v3 = [(CAMViewfinderViewController *)self _torchPatternController];
    [v3 stopPerformingPattern];
  }
}

- (double)timeIntervalForDuration:(int64_t)a3
{
  result = 0.0;
  if ((a3 - 1) <= 2)
  {
    return dbl_1A3A68380[a3 - 1];
  }

  return result;
}

- (void)setConfigurationDelegate:(id)a3
{
  obj = a3;
  WeakRetained = objc_loadWeakRetained(&self->_configurationDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_configurationDelegate, obj);
    p_configurationDelegateFlags = &self->_configurationDelegateFlags;
    p_configurationDelegateFlags->respondsToWillBeginConfiguration = objc_opt_respondsToSelector() & 1;
    p_configurationDelegateFlags->respondsToDidCompleteConfiguration = objc_opt_respondsToSelector() & 1;
  }
}

- (void)_handleUserChangedToDevice:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:v5 device:a3];
}

- (void)handleUserChangedToMode:(int64_t)a3
{
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:a3 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:a3 device:v6];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v7 setControlDrawerExpanded:0 forReason:3 animated:1];
}

- (void)handleUserChangedToMode:(int64_t)a3 device:(int64_t)a4
{
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [v7 mode];

  v9 = [(CAMViewfinderViewController *)self _shouldResetZoomForChangeFromMode:v8 toMode:a3];
  if (v9)
  {
    v10 = [(CAMViewfinderViewController *)self _motionController];
    -[CAMViewfinderViewController set_desiredFieldOfView:](self, "set_desiredFieldOfView:", -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [v10 captureOrientation]));
  }

  v27 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:a3 device:a4 fromGraphConfiguration:?];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  v13 = v12;
  if ([v11 trueVideoEnabled] && (objc_msgSend(v27, "trueVideoEnabled") & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setTrueVideoSourceZoomFactor:v13];
  }

  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSmartFramingSupportedForMode:objc_msgSend(v11 devicePosition:{"mode"), objc_msgSend(v11, "devicePosition")}];

  if ([v27 trueVideoEnabled] && (v16 = objc_msgSend(v11, "mode"), v16 == -[CAMViewfinderViewController _trueVideoSourceCaptureMode](self, "_trueVideoSourceCaptureMode")) && !objc_msgSend(v11, "mode"))
  {
    v17 = ([v11 devicePosition] == 1) & (v15 ^ 1);
  }

  else
  {
    v17 = 0;
  }

  if (v9)
  {
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v11];
LABEL_14:
    v13 = v18;
    goto LABEL_15;
  }

  if (v17)
  {
    [(CAMViewfinderViewController *)self _trueVideoSourceZoomFactor];
    goto LABEL_14;
  }

  if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    +[CAMZoomControlUtilities equivalentZoomFactor:forDevice:fromDevice:](CAMZoomControlUtilities, "equivalentZoomFactor:forDevice:fromDevice:", -[CAMViewfinderViewController _resolvedDeviceForZoomFactor:fromGraphConfiguration:toGraphConfiguration:](self, "_resolvedDeviceForZoomFactor:fromGraphConfiguration:toGraphConfiguration:", v27, v11, v13), [v27 device], v13);
    v13 = v19;
    if ([(CAMViewfinderViewController *)self _useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:v11])
    {
      v20 = +[CAMCaptureCapabilities capabilities];
      [v20 maximumZoomFactorForMode:objc_msgSend(v11 device:"mode") videoConfiguration:a4 videoStabilizationStrength:{objc_msgSend(v11, "videoConfiguration"), objc_msgSend(v11, "videoStabilizationStrength")}];
      v22 = v21;

      if (v13 >= v22)
      {
        v13 = v22;
      }
    }

    v23 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [v11 mode], objc_msgSend(v11, "devicePosition"));
    if (v23)
    {
      v24 = v23;
      v25 = +[CAMCaptureCapabilities capabilities];
      [v25 zoomFactorForSmartFramingFieldOfView:v24];
      v13 = v26;
    }
  }

LABEL_15:
  [(CAMViewfinderViewController *)self handleUserChangedToMode:a3 device:a4 zoomFactor:v13];
}

- (void)_performChangeFromGraphConfiguration:(id)a3 toGraphConfiguration:(id)a4 zoomFactor:(double)a5 deferIfConfigurationInFlight:(BOOL)a6
{
  v6 = a6;
  v18 = *MEMORY[0x1E69E9840];
  v10 = a3;
  v11 = a4;
  v12 = [(CAMViewfinderViewController *)self _hasInFlightConfiguration];
  [(CAMViewfinderViewController *)self _willChangeToGraphConfiguration:v11 zoomFactor:v10 fromGraphConfiguration:1 animated:a5];
  if (v6 && v12)
  {
    v13 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 138543618;
      v15 = v11;
      v16 = 2114;
      v17 = v10;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Deferring change to: %{public}@, from: %{public}@", &v14, 0x16u);
    }

    [(CAMViewfinderViewController *)self _setNeedsDeferredGraphConfiguration:1];
  }

  else
  {
    [(CAMViewfinderViewController *)self _changeToGraphConfiguration:v11 zoomFactor:v10 fromGraphConfiguration:a5];
  }
}

- (void)handleUserChangedToMode:(int64_t)a3 device:(int64_t)a4 zoomFactor:(double)a5
{
  v15 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v15 mode];
  v10 = [v15 device];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  if (v9 != a3 || v10 != a4 || v11 != a5)
  {
    v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [v12 trueVideoState] == 0;

    v14 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:a3 device:a4 fromGraphConfiguration:v15];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v15 toGraphConfiguration:v14 zoomFactor:v13 deferIfConfigurationInFlight:a5];
  }
}

- (void)_willChangeToGraphConfiguration:(id)a3 zoomFactor:(double)a4 fromGraphConfiguration:(id)a5 animated:(BOOL)a6
{
  v6 = a6;
  v100 = *MEMORY[0x1E69E9840];
  v10 = a3;
  v11 = a5;
  v12 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  [v12 modeWillChange];

  v13 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  [v13 modeWillChange];

  v14 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543874;
    v95 = v10;
    v96 = 2114;
    v97 = v11;
    v98 = 2048;
    v99 = a4;
    _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Will change to: %{public}@ from: %{public}@ with zoomFactor=%.3f", buf, 0x20u);
  }

  v91 = +[CAMCaptureCapabilities capabilities];
  v15 = [v10 mode];
  v90 = [v10 device];
  v16 = [v11 mode];
  v89 = [v11 device];
  v85 = [(CAMViewfinderViewController *)self _livePhotoButton];
  [v85 interruptEnablingAnimation];
  v17 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v18 = [v17 controlStatusBar];
  v19 = [v18 livePhotoIndicator];
  [v19 stopAnimating];

  v20 = [(CAMViewfinderViewController *)self _timerCache];
  [v20 cancelAllTimers];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v6];
  [(CAMViewfinderViewController *)self _setReconfiguring:1];
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:v6];
  [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:v10];
  if (v6)
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:v10];
  }

  v21 = [(CAMViewfinderViewController *)self viewfinderView];
  v22 = [(CAMViewfinderViewController *)self _previewViewController];
  [v22 willChangeToGraphConfiguration:v10];
  if (![(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    [(CAMViewfinderViewController *)self _closeViewfinderForChangeFromMode:v16 toMode:v15 fromDevice:v89 toDevice:v90];
  }

  v84 = v22;
  if (![(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
  {
    v23 = [(CAMViewfinderViewController *)self _modeDial];
    [v23 reloadData];
    [v23 setSelectedMode:v15 animated:v6];
  }

  v83 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v10 animated:v6];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v10 isCapturing:0 animated:v6];
  [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:v10];
  v24 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v24 setIsGraphConfigurationReconfiguring:1];

  [(CAMViewfinderViewController *)self _pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:v10 isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
  v25 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", v15, [v10 videoConfiguration], objc_msgSend(v10, "devicePosition"), objc_msgSend(v10, "trueVideoEnabled"));
  [v21 setDesiredAspectRatio:v25];
  if (v15)
  {
    v26 = v15 == 6;
  }

  else
  {
    v26 = 1;
  }

  v28 = v26 && v16 == 4;
  if (v15 == 4 || v28)
  {
    [v21 setMaskingAspectRatio:v25 animated:v6];
  }

  v82 = v25;
  [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:v10 animated:v6];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v10 animated:v6];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:v10 fromGraphConfiguration:v11 animated:v6];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:v10 animated:v6];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:v10];
  if ([v10 mode] != 8)
  {
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v10 animated:v6];
  }

  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:v10 animated:v6];
  v29 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v30 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", v10, [v29 isCallActive]);

  if (v30)
  {
    [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:v6];
  }

  v31 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v10];
  if (v31)
  {
    v32 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:v10];
    v33 = v32;
    v34 = 0.25;
    if (!v6)
    {
      v34 = 0.0;
    }

    [v32 setVisible:1 animationDuration:0 completion:v34];
  }

  v35 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v35 setIsShowingOverlayDescription:v31];

  if ([v91 isLivePhotoSupported])
  {
    v37 = v15 == 4 && v16 == 0;
    v39 = v16 == 4 && v15 == 0 || v37;
  }

  else
  {
    v39 = 0;
  }

  v88 = v11;
  v41 = v16 != v15 && (v15 == 6 || v16 == 6);
  v87 = v21;
  v42 = [(CAMViewfinderViewController *)self _useMessagesControls];
  v43 = v16 != 3 && v42;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke;
  aBlock[3] = &__block_descriptor_33_e19_v20__0__UIView_8B16l;
  v93 = v6;
  v86 = _Block_copy(aBlock);
  if (((v39 | v41) & 1) != 0 || v43)
  {
    v44 = [(CAMViewfinderViewController *)self _topBar];
    v45 = [v44 _expandedMenuButton];
    v46 = v45 != 0;

    v81 = v46 & [v44 _shouldExpandButtonsHorizontally];
    if ((v81 & 1) == 0 && ![(CAMViewfinderViewController *)self _shouldHideLivePhotoButtonForGraphConfiguration:v10])
    {
      v86[2](v86, v85, 0);
    }

    if (([v91 isDepthEffectApertureSupported] & v41) == 1)
    {
      v47 = [(CAMViewfinderViewController *)self _apertureButton];

      if (!v47)
      {
        [(CAMViewfinderViewController *)self _createApertureButtonIfNecessary];
        v48 = ([(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:v88]^ 1);
        v49 = [(CAMViewfinderViewController *)self _apertureButton];
        [v49 setAlpha:v48];
      }

      v50 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:v10];
      v51 = [(CAMViewfinderViewController *)self _apertureButton];
      v86[2](v86, v51, v50);

      [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:v10 zoomFactor:a4];
      [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v10 zoomFactor:a4];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v10 zoomFactor:0 animated:a4];
    }

    v52 = [v91 isPortraitEffectIntensitySupportedForMode:v15];
    v53 = [v91 isPortraitEffectIntensitySupportedForMode:v16];
    v54 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:v15 device:v90];
    if (((v52 & 1) != 0 || v53) && ([v91 isPortraitEffectIntensitySupportedForLightingType:v54] & v41) == 1)
    {
      [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
      v55 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:v10];
      v56 = [(CAMViewfinderViewController *)self _intensityButton];
      v86[2](v86, v56, v55);
    }

    if (v43)
    {
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:v10];
      [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:v10 animated:0];
      [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:v10 animated:v6];
    }

    [v44 configureForMode:v15 animated:v81 ^ 1u];
  }

  v57 = [(CAMViewfinderViewController *)self _shouldResetZoomForChangeFromMode:v16 toMode:v15];
  v58 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v59 = -[CAMViewfinderViewController _isFrontRearSimultaneousVideoActiveForMode:devicePosition:](self, "_isFrontRearSimultaneousVideoActiveForMode:devicePosition:", [v10 mode], objc_msgSend(v10, "devicePosition"));
  if (v57 || v58 || v59)
  {
    if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
    {
      v86[2](v86, self->__zoomSlider, 1);
    }

    if (![(CAMViewfinderViewController *)self _isReconfiguringForZoomChange]&& !v58)
    {
      if (v6)
      {
        v60 = 2;
      }

      else
      {
        v60 = 0;
      }

      [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:v60];
    }

    [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:a4];
    [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
    [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v10 animated:v6];
    v61 = [(CAMViewfinderViewController *)self _zoomSlider];

    if (v61)
    {
      [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:a4];
      v63 = v62;
      v64 = [(CAMViewfinderViewController *)self _zoomSlider];
      *&v65 = v63;
      [v64 setValue:v6 animated:v65];
    }

    if (!v58)
    {
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }
  }

  v66 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:v88];
  if (v66 != [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:v10])
  {
    [(CAMViewfinderViewController *)self _prepareTopBarForOrientationChangeDuringConfiguration];
  }

  [v87 setAutomaticallyAdjustsTopBarOrientation:{-[CAMViewfinderViewController _shouldRotateTopBarForGraphConfiguration:](self, "_shouldRotateTopBarForGraphConfiguration:", v10)}];
  if (v16 != v15)
  {
    [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:1];
  }

  if ((v89 - 1) > 0xA)
  {
    v67 = 0;
  }

  else
  {
    v67 = qword_1A3A685B0[v89 - 1];
  }

  v68 = [(CAMViewfinderViewController *)self _wantsLightingControlForMode:v16 devicePosition:v67];
  if ((v90 - 1) > 0xA)
  {
    v69 = 0;
  }

  else
  {
    v69 = qword_1A3A685B0[v90 - 1];
  }

  if ((v68 & [(CAMViewfinderViewController *)self _wantsLightingControlForMode:v15 devicePosition:v69]) == 1)
  {
    v70 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [v88 mode], objc_msgSend(v88, "device"));
    v71 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [v10 mode], objc_msgSend(v10, "device"));
    if (v71 != v70)
    {
      [(CAMViewfinderViewController *)self _setLightingType:v71 forMode:6];
      [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
    }

    [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:v10 animated:1];
  }

  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", v15, [v10 trueVideoEnabled]);
  *&v72 = v72;
  [v84 setBaselineExposureBias:v72];
  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0 animated:v6];
  v73 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v74 = [v73 controlDrawer];
  [v74 setExpanded:0 forControlType:10 animated:1 updatePreferredDrawerControl:0];

  v75 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v76 = [v75 controlDrawer];
  [v76 setExpanded:0 forControlType:11 animated:1 updatePreferredDrawerControl:0];

  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  v77 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  v78 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v77 countEventsFromAnalyticsVisionSession:v78];

  v79 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v79 publish];

  [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:0];
  if ((v16 != v15 || v90 != v89) && self->_configurationDelegateFlags.respondsToWillBeginConfiguration)
  {
    v80 = [(CAMViewfinderViewController *)self configurationDelegate];
    [v80 cameraViewControllerWillBeginConfigurationForCaptureMode:v15 captureDevice:v90];
  }

  if ([(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
  {
    [v83 setViewportAspectRatio:v82 animated:1];
  }

  [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:v10];
  [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:v10];
  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
}

void __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke(uint64_t a1, void *a2, char a3)
{
  v5 = a2;
  if (*(a1 + 32))
  {
    v6 = 0.25;
  }

  else
  {
    v6 = 0.0;
  }

  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke_2;
  v8[3] = &unk_1E76F7850;
  v9 = v5;
  v10 = a3;
  v7 = v5;
  [CAMView animateIfNeededWithDuration:v8 animations:v6];
}

- (void)_closeViewfinderForChangeFromMode:(int64_t)a3 toMode:(int64_t)a4 fromDevice:(int64_t)a5 toDevice:(int64_t)a6
{
  if ((a5 - 1) > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[a5 - 1];
  }

  if ((a6 - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[a6 - 1];
  }

  v10 = a3 != a4 || v7 == v8;
  v11 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v11 addClosedViewfinderReason:v10];
}

- (void)_didChangeToGraphConfiguration:(id)a3 forDesiredConfiguration:(id)a4 requestID:(int)a5
{
  *&v57[5] = *MEMORY[0x1E69E9840];
  v7 = a3;
  v8 = [v7 mode];
  v9 = [v7 device];
  v10 = v9;
  if ((v9 - 8) < 3 || v9 == 11 || v9 == 1)
  {
    v11 = 0;
    v12 = 1;
  }

  else
  {
    v12 = 0;
    v11 = 1;
  }

  v13 = +[CAMCaptureCapabilities capabilities];
  [(CAMViewfinderViewController *)self set_completedInitialConfiguration:1];
  v14 = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  [(CAMViewfinderViewController *)self _setConfiguredGraphConfiguration:v7];
  CAMSignpostWithIDAndArgs(10, 0xEEEEB0B5B2B2EEEELL, v8, v10, 0, 0);
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  v15 = [(CAMViewfinderViewController *)self _lastConfigurationRequestID];
  if (v15 == -1 || (v16 = v15, v15 == a5))
  {
    v51 = v11;
    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:0xFFFFFFFFLL];
    v17 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    if ([(CAMViewfinderViewController *)self _needsDeferredGraphConfiguration])
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      v19 = v18;
      v20 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v55 = v17;
        v56 = 2048;
        *v57 = v19;
        _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Performing deferred change to: %{public}@ with zoom factor %.3f", buf, 0x16u);
      }

      [(CAMViewfinderViewController *)self _changeToGraphConfiguration:v17 zoomFactor:v7 fromGraphConfiguration:v19];
    }

    else
    {
      v53 = [(CAMViewfinderViewController *)self _captureController];
      if (v8 == [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode]&& [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
      {
        [(CAMViewfinderViewController *)self _trueVideoStartCapture];
      }

      [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:v7];
      [(CAMViewfinderViewController *)self _setReconfiguring:0];
      if ([(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
      {
        [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:0];
        v21 = os_log_create("com.apple.camera", "Zoom");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
          *buf = 134217984;
          v55 = v22;
          _os_log_impl(&dword_1A3640000, v21, OS_LOG_TYPE_DEFAULT, "Changing to zoom factor %.3f after reconfig", buf, 0xCu);
        }

        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [v53 changeToVideoZoomFactor:v7 graphConfiguration:?];
      }

      v47 = a5;
      [(CAMViewfinderViewController *)self _setPerformingTopBarOrientationChange:0];
      v23 = [(CAMViewfinderViewController *)self viewfinderView];
      v24 = [(CAMViewfinderViewController *)self _aspectRatioForMode:v8 videoConfiguration:[v7 videoConfiguration] devicePosition:v12 trueVideoEnabled:[v7 trueVideoEnabled]];
      [v23 setDesiredAspectRatio:v24];
      v50 = v23;
      [v23 setMaskingAspectRatio:v24];
      v25 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v25 setViewportAspectRatio:v24 animated:1];
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:v7];
      v49 = [(CAMViewfinderViewController *)self _previewViewController];
      [v49 didChangeToGraphConfiguration:v7 animated:1];
      [(CAMViewfinderViewController *)self _updatePanoramaSizeIfNeededForGraphConfiguration:v7];
      v26 = [CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
      v27 = [(CAMZoomSlider *)self->__zoomSlider isHidden];
      v28 = 0;
      if ((v27 & 1) == 0)
      {
        [(CAMZoomSlider *)self->__zoomSlider alpha];
        v28 = v29 != 0.0;
      }

      if (v26 && !v28)
      {
        [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
      }

      [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
      [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:v7 animated:0];
      [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:v7 animated:1];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v7 animated:1];
      [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v7 animated:1];
      [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:v7 fromGraphConfiguration:v17 animated:1];
      [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:v17 animated:1];
      [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
      [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
      if (![(CAMViewfinderViewController *)self _isControlDrawerShowingPersistentControl])
      {
        [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      }

      v48 = [(CAMViewfinderViewController *)self _topBar];
      [v48 configureForMode:v8 animated:0];
      [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:v7];
      v30 = +[CAMUserPreferences preferences];
      v31 = v30;
      v32 = v51 ^ 1;
      if (v8 != 6)
      {
        v32 = 1;
      }

      if ((v32 & 1) == 0)
      {
        [v30 setPortraitModeRearDevice:v10];
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [v31 setPortraitModeRearZoomValue:?];
      }

      v52 = v31;
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updateDepthEffectApertureForGraphConfiguration:v7 fromGraphConfiguration:v14 zoomFactor:?];
      if ([v13 isPortraitEffectIntensitySupportedForMode:v8])
      {
        [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
        [v53 changeToPortraitLightingEffectStrength:?];
        [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
        [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      }

      [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:v7 animated:[(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v14]];
      [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
      [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
      [(CAMViewfinderViewController *)self _resetExposureClipping];
      [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
      [(CAMViewfinderViewController *)self _updateShutterButtonLegibility];
      [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
      [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v7 animated:0];
      [(CAMViewfinderViewController *)self _updateMaxRecordingTimeInstructionLabelForGraphConfiguration:v7];
      [(CAMViewfinderViewController *)self _startOrCancelPurgeIfNecessary];
      [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
      [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:1];
      v33 = [(CAMViewfinderViewController *)self _closedViewfinderController];
      v34 = [v33 isViewfinderClosed];

      if ((v34 & 1) == 0)
      {
        [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
        [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:1];
      }

      [(CAMViewfinderViewController *)self _openViewfinderForAllModeAndDeviceChangeReasons];
      v35 = [MEMORY[0x1E69DC668] sharedApplication];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        [v35 didChangeToMode:v8 device:v10];
      }

      v36 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v55 = v7;
        v56 = 1024;
        *v57 = v47;
        _os_log_impl(&dword_1A3640000, v36, OS_LOG_TYPE_DEFAULT, "Did change to: %{public}@ (requestID=%d)", buf, 0x12u);
      }

      if (self->_configurationDelegateFlags.respondsToDidCompleteConfiguration)
      {
        v37 = [(CAMViewfinderViewController *)self configurationDelegate];
        [v37 cameraViewControllerDidCompleteConfigurationForCaptureMode:v8 captureDevice:v10];
      }

      [(CAMViewfinderViewController *)self captureController:v53 didOutputFaceResults:MEMORY[0x1E695E0F0] headResults:MEMORY[0x1E695E0F0] bodyResults:MEMORY[0x1E695E0F0] salientObjectResults:MEMORY[0x1E695E0F0]];
      [(CAMViewfinderViewController *)self _resetObjectResults];
      [(CAMViewfinderViewController *)self _updateInterfaceModulationForGraphConfiguration:v17 animated:1];
      [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:[(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled] animated:1];
      if ([(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormat])
      {
        [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
      }

      [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:v17];
      [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
      if ([v7 mode]== 9 || [v7 mode]== 8)
      {
        v38 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        if ([v38 isOrientationInstructionVisible])
        {
        }

        else
        {
          v39 = [(CAMViewfinderViewController *)self _trueVideoIsActive];

          if (!v39)
          {
            [(CAMViewfinderViewController *)self _startTimer:7];
            [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
          }
        }
      }

      v40 = [(CAMViewfinderViewController *)self _motionController];
      if (([v40 captureOrientation] - 3) > 1)
      {
      }

      else
      {
        v41 = [(CAMViewfinderViewController *)self _trueVideoIsActive];

        if (!v41)
        {
          [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:1];
          [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:1];
        }
      }

      if (v8 == [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]&& [(CAMViewfinderViewController *)self _trueVideoIsActive])
      {
        v42 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        [v42 setTrueVideoState:0];

        [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
        [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"True video state changed to idle"];
        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
      }

      [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:v7];
      v43 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [v43 setIsGraphConfigurationReconfiguring:0];

      [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v7 animated:1];
      v44 = [v13 isSmartFramingSupportedForMode:-[NSObject mode](v7 devicePosition:{"mode"), -[NSObject devicePosition](v7, "devicePosition")}];
      [v25 setOverCaptureGradientVisible:v44 animated:1];
      [(CAMViewfinderViewController *)self _updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:v7 animated:1];
      [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v7];
      if ((v44 & 1) == 0 && [(CAMViewfinderViewController *)self _smartFramingFieldOfViewSource])
      {
        [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
      }

      [CAMLensSmudgeDisplayState logModeChangedWithMode:[v7 mode]];
      v45 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
      [v45 modeDidChange];

      v46 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
      [v46 modeDidChange];
    }
  }

  else
  {
    v17 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v55 = v7;
      v56 = 1024;
      *v57 = a5;
      v57[2] = 1024;
      *&v57[3] = v16;
      _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Did change to: %{public}@ (requestID=%d) (waiting on another in-flight configuration before completing configuration changes (requestID=%d)", buf, 0x18u);
    }
  }
}

- (void)_updateDepthEffectApertureForGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4 zoomFactor:(double)a5
{
  v29 = a3;
  v8 = a4;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v29 device];
  v11 = [v29 devicePosition];
  v12 = [v29 mode];
  if ([v9 isDepthEffectApertureSupportedForMode:v12 devicePosition:v11 depthSuggestionEnabled:{objc_msgSend(v29, "enableDepthSuggestion")}])
  {
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v14 = v13;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v16 = v15;
    [v9 defaultDepthEffectApertureForMode:v12 device:v10 zoomFactor:a5];
    v18 = v17;
    [(CAMViewfinderViewController *)self _setLastDefaultApertureValue:?];
    v19 = +[CAMUserPreferences preferences];
    v20 = [v9 isDepthEffectApertureSupportedForMode:objc_msgSend(v8 devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(v8, "devicePosition"), objc_msgSend(v8, "enableDepthSuggestion")}];
    if (([v19 preserveAperture] & 1) == 0 && ((vabdd_f64(v16, v14) >= 0.0001) & v20) == 0)
    {
      [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:v18];
    }

    [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:v29 zoomFactor:a5];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v22 = v21;
    [v9 minimumDepthEffectApertureForMode:v12 device:v10];
    v24 = v23;
    [v9 maximumDepthEffectApertureForMode:v12 device:v10];
    if (v24 >= v22)
    {
      v26 = v24;
    }

    else
    {
      v26 = v22;
    }

    if (v25 >= v26)
    {
      v27 = v26;
    }

    else
    {
      v27 = v25;
    }

    v28 = [(CAMViewfinderViewController *)self _captureController];
    [v28 changeToPortraitAperture:v27];

    [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v29 zoomFactor:a5];
    [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v29 zoomFactor:0 animated:a5];
  }
}

- (void)_prepareDeferredProcessingIfNeeded
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 isDeferredProcessingPrewarmingSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v3 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
    v4 = [(CAMViewfinderViewController *)self _captureController];
    [v4 prepareDeferredProcessingWithStillImageRequest:v3];
  }
}

- (void)_updateInterfaceModulationForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = [a3 colorSpace] == 2;
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v7 setInterfaceModulation:v6 animated:v4];
}

- (int64_t)_resolvedDeviceForZoomFactor:(double)a3 fromGraphConfiguration:(id)a4 toGraphConfiguration:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 resolvedDeviceForDesiredDevice:objc_msgSend(v7 mode:"device") videoConfiguration:objc_msgSend(v7 videoStabilizationStrength:"mode") frontRearSimultaneousVideoEnabled:{objc_msgSend(v7, "videoConfiguration"), objc_msgSend(v7, "videoStabilizationStrength"), objc_msgSend(v7, "frontRearSimultaneousVideoEnabled")}];

  v11 = [v8 device];
  [CAMZoomControlUtilities equivalentZoomFactor:v10 forDevice:v11 fromDevice:a3];
  v13 = v12;
  v14 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", [v7 mode], v10, objc_msgSend(v7, "videoConfiguration"), objc_msgSend(v7, "videoStabilizationStrength"), objc_msgSend(v7, "frontRearSimultaneousVideoEnabled"), 0, 0);
  v15 = [v7 mode];

  return [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v10 fromDevice:v15 mode:v14 continuousZoomSupported:v13];
}

- (void)captureController:(id)a3 didChangeToGraphConfiguration:(id)a4 forDesiredConfiguration:(id)a5 requestID:(int)a6
{
  [(CAMViewfinderViewController *)self _didChangeToGraphConfiguration:a4 forDesiredConfiguration:a5 requestID:*&a6];
  v7 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  [v7 removeDisabledReason:0];
}

- (void)captureController:(id)a3 didOutputFaceResults:(id)a4 headResults:(id)a5 bodyResults:(id)a6 salientObjectResults:(id)a7
{
  v12 = a7;
  v13 = a6;
  v14 = a5;
  v15 = a4;
  v16 = a3;
  v17 = [(CAMViewfinderViewController *)self _previewViewController];
  [v17 captureController:v16 didOutputFaceResults:v15 headResults:v14 bodyResults:v13 salientObjectResults:v12];

  v20 = [v15 firstObject];
  [(CAMViewfinderViewController *)self _updateCaptureTimerIndicatorWithFaceResult:v20];
  v18 = [v15 count];
  v19 = [(CAMViewfinderViewController *)self _targetPortraitModeInstructionLabel];
  [v19 setNumberOfPeopleFound:v18];

  [(CAMViewfinderViewController *)self _updateObjectResults:v15 headResults:v14 bodyResults:v13];
}

- (void)_updateCaptureTimerIndicatorWithFaceResult:(id)a3
{
  v19 = a3;
  v4 = [MEMORY[0x1E695DF00] date];
  v5 = [(CAMViewfinderViewController *)self _lastTimerIndicatorFaceUpdateDate];
  [v4 timeIntervalSinceDate:v5];
  if (v6 >= 1.5)
  {
    [v19 bounds];
    x = v21.origin.x;
    y = v21.origin.y;
    width = v21.size.width;
    height = v21.size.height;
    CGRectGetMaxX(v21);
    v22.origin.x = x;
    v22.origin.y = y;
    v22.size.width = width;
    v22.size.height = height;
    CGRectGetMaxY(v22);
    UIDistanceBetweenPoints();
    v12 = v11;
    v13 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
    v15 = v12 <= 0.35 || v19 == 0;
    if (v15 && v13)
    {
      v16 = 2;
    }

    else
    {
      v16 = 0;
    }

    v17 = [(CAMViewfinderViewController *)self _timerIndicatorView];
    if (!v17)
    {
      v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v17 = [v18 timerIndicator];
    }

    if (v16 != [v17 style])
    {
      [v17 setStyle:v16 animated:v13];
      [(CAMViewfinderViewController *)self _setLastTimerIndicatorFaceUpdateDate:v4];
    }
  }
}

- (void)_updateObjectResults:(id)a3 headResults:(id)a4 bodyResults:(id)a5
{
  v78 = *MEMORY[0x1E69E9840];
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v10 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v70 = 0u;
  v71 = 0u;
  v72 = 0u;
  v73 = 0u;
  v11 = v7;
  v12 = [v11 countByEnumeratingWithState:&v70 objects:v77 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v71;
    do
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v71 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = [*(*(&v70 + 1) + 8 * i) underlyingMetadataObject];
        [v10 addObject:v16];
      }

      v13 = [v11 countByEnumeratingWithState:&v70 objects:v77 count:16];
    }

    while (v13);
  }

  v68 = 0u;
  v69 = 0u;
  v66 = 0u;
  v67 = 0u;
  v17 = v8;
  v18 = [v17 countByEnumeratingWithState:&v66 objects:v76 count:16];
  if (v18)
  {
    v19 = v18;
    v20 = *v67;
    do
    {
      for (j = 0; j != v19; ++j)
      {
        if (*v67 != v20)
        {
          objc_enumerationMutation(v17);
        }

        v22 = [*(*(&v66 + 1) + 8 * j) underlyingMetadataObject];
        [v10 addObject:v22];
      }

      v19 = [v17 countByEnumeratingWithState:&v66 objects:v76 count:16];
    }

    while (v19);
  }

  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  v23 = v9;
  v24 = [v23 countByEnumeratingWithState:&v62 objects:v75 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v63;
    do
    {
      for (k = 0; k != v25; ++k)
      {
        if (*v63 != v26)
        {
          objc_enumerationMutation(v23);
        }

        v28 = [*(*(&v62 + 1) + 8 * k) underlyingMetadataObject];
        [v10 addObject:v28];
      }

      v25 = [v23 countByEnumeratingWithState:&v62 objects:v75 count:16];
    }

    while (v25);
  }

  v52 = v17;
  v53 = v11;
  v51 = v23;

  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v29 = v10;
  v30 = [v29 countByEnumeratingWithState:&v58 objects:v74 count:16];
  if (v30)
  {
    v31 = v30;
    v55 = 0;
    v32 = 0;
    v33 = 0;
    v57 = 0;
    v34 = 0;
    v35 = 0;
    v36 = *v59;
    while (1)
    {
      for (m = 0; m != v31; ++m)
      {
        if (*v59 != v36)
        {
          objc_enumerationMutation(v29);
        }

        v38 = *(*(&v58 + 1) + 8 * m);
        v39 = [v38 groupID];
        if ([v38 isHumanFace])
        {
          if (v39 >= 1)
          {
            if (!v35)
            {
              v35 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v40 = [MEMORY[0x1E696AD98] numberWithInteger:v39];
            v41 = v35;
LABEL_37:
            [v41 addObject:v40];

            continue;
          }

          ++v33;
        }

        else if ([v38 isCat])
        {
          if (v39 >= 1)
          {
            if (!v34)
            {
              v34 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v40 = [MEMORY[0x1E696AD98] numberWithInteger:v39];
            v41 = v34;
            goto LABEL_37;
          }

          ++v32;
        }

        else if ([v38 isDog])
        {
          if (v39 < 1)
          {
            ++v55;
          }

          else
          {
            v56 = v35;
            v42 = v29;
            v43 = v33;
            v44 = v32;
            v45 = v34;
            v46 = v57;
            if (!v57)
            {
              v46 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v47 = [MEMORY[0x1E696AD98] numberWithInteger:v39];
            v57 = v46;
            [v46 addObject:v47];

            v34 = v45;
            v32 = v44;
            v33 = v43;
            v29 = v42;
            v35 = v56;
          }
        }
      }

      v31 = [v29 countByEnumeratingWithState:&v58 objects:v74 count:16];
      if (!v31)
      {
        goto LABEL_50;
      }
    }
  }

  v55 = 0;
  v32 = 0;
  v33 = 0;
  v57 = 0;
  v34 = 0;
  v35 = 0;
LABEL_50:

  v48 = [v35 count];
  v49 = [v34 count];
  v50 = [v57 count];
  [(CAMViewfinderViewController *)self set_faceCount:v48 + v33];
  [(CAMViewfinderViewController *)self set_catCount:v49 + v32];
  [(CAMViewfinderViewController *)self set_dogCount:v50 + v55];
}

- (void)_resetObjectResults
{
  [(CAMViewfinderViewController *)self set_faceCount:0];
  [(CAMViewfinderViewController *)self set_catCount:0];

  [(CAMViewfinderViewController *)self set_dogCount:0];
}

- (void)captureController:(id)a3 didOutputTextRegionResults:(id)a4
{
  [(CAMViewfinderViewController *)self _setCachedTextRegionResults:a4];

  [(CAMViewfinderViewController *)self _processTextRegionResults];
}

- (void)_processTextRegionResults
{
  if ([(CAMViewfinderViewController *)self _shouldProcessTextRegions])
  {
    v3 = [(CAMViewfinderViewController *)self _cachedTextRegionResults];
    v7 = [(CAMViewfinderViewController *)self _filteredTextResults:v3];
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  v4 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v4 cachedTextRegionResults];

  if ([v7 count] || objc_msgSend(v5, "count"))
  {
    v6 = [(CAMViewfinderViewController *)self _previewViewController];
    [v6 setCachedTextRegionResults:v7];

    [(CAMViewfinderViewController *)self _updateProminentObjectManagerWithCachedMetadataResults];
  }
}

- (void)documentScanFlowControllerDidFinish:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v4 countDocumentScanningCompletedScans];

  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)documentScanFlowControllerDidCancel:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v4 countDocumentScanningCanceledScans];

  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)documentScanFlowControllerDidFail:(id)a3 withError:(id)a4
{
  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)captureController:(id)a3 didChangeDocumentSceneConfidenceResults:(float)a4
{
  v6 = +[CAMCaptureCapabilities capabilities];
  [v6 documentScanningMinimumConfidenceLevel];
  v8 = v7;

  [(CAMViewfinderViewController *)self _setDocumentInScene:v8 <= a4];

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (id)_filteredTextResults:(id)a3
{
  v23 = *MEMORY[0x1E69E9840];
  v3 = a3;
  v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v3, "count")}];
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v5 = v3;
  v6 = [v5 countByEnumeratingWithState:&v18 objects:v22 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v19;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v19 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v18 + 1) + 8 * i);
        v11 = [v10 underlyingMetadataObject];
        [v11 bounds];
        v13 = v12;
        v15 = v14;

        v16 = v15 * 3.0 * 0.25;
        if (fmin(v13, v16) >= 0.03 && v13 * v16 >= 0.0025)
        {
          [v4 addObject:v10];
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v18 objects:v22 count:16];
    }

    while (v7);
  }

  return v4;
}

- (BOOL)_shouldProcessTextRegions
{
  if (![(CAMViewfinderViewController *)self _shouldProcessMachineReadableMetadata])
  {
    return 0;
  }

  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v3];
  v5 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v3];
  v6 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:v3];
  v7 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:v3];
  v8 = v6 == 2 && v4;
  v9 = !v8 && (!v5 || v7 != 2);

  return v9;
}

- (BOOL)_shouldProcessMachineReadableMetadata
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isCapturingBurst];
  v5 = [v3 isCapturingVideo];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v6 = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v7 = v6 != 0;
  }

  else
  {
    v7 = 0;
  }

  v8 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v9 = [MEMORY[0x1E696AD98] numberWithInteger:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
  v10 = [v8 objectForKeyedSubscript:v9];

  v11 = +[CAMCaptureCapabilities capabilities];
  v12 = [v11 imageAnalysisShowsInactiveTextRegions];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v14 = [v13 isSemanticStyleControlVisible];

  v15 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v16 = [v15 isSmartStylePickerVisible];

  if ((v4 & 1) != 0 || (v5 & (v12 ^ 1) | v7) & 1 | (v10 != 0) | v14 & 1 | v16 & 1)
  {
    LOBYTE(v17) = 0;
  }

  else
  {
    v17 = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v17;
}

- (void)_resetMachineReadableMetadataAndProcessing
{
  v4 = [(CAMViewfinderViewController *)self _previewViewController];
  [v4 setCachedSignificantMRCResult:0];
  [v4 setCachedMRCResults:0];
  [v4 setCachedTextRegionResults:0];
  [v4 setCachedSignificantTextRegionResult:0];
  [(CAMViewfinderViewController *)self _setLastMRCResultsCount:0];
  [(CAMViewfinderViewController *)self _setCachedQRCodeResults:0];
  [(CAMViewfinderViewController *)self _setCachedTextRegionResults:0];
  [(CAMViewfinderViewController *)self _setCachedAppClipCodeResults:0];
  [(CAMViewfinderViewController *)self _setBarcodeParsingSession:0];
  v3 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  [v3 reset];
}

- (id)_textInteractionInsert
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = [v3 textInteractionInsert];
  v5 = v4;
  if (v4)
  {
    v6 = v4;
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self viewfinderView];
    v6 = [v7 textInteractionInsert];
  }

  return v6;
}

- (id)_imageAnalysisButton
{
  v3 = [(CAMViewfinderViewController *)self _externalChromeImageAnalysisButton];

  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _externalChromeImageAnalysisButton];
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v6 = [v5 imageAnalysisButton];
    v7 = v6;
    if (v6)
    {
      v4 = v6;
    }

    else
    {
      v8 = [(CAMViewfinderViewController *)self _bottomBar];
      v4 = [v8 imageAnalysisButton];
    }
  }

  return v4;
}

- (id)_nightModeInstructionLabel
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 nightModeInstructionLabel];

  return v3;
}

- (id)_imageAnalysisInstructionLabel
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = [v3 imageAnalysisInstructionLabel];
  v5 = v4;
  if (v4)
  {
    v6 = v4;
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self viewfinderView];
    v6 = [v7 imageAnalysisInstructionLabel];
  }

  return v6;
}

- (void)_createImageAnalysisInstructionLabelIfNeeded
{
  if ([(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:7])
  {
    v4 = objc_alloc_init(CAMImageAnalysisInstructionLabel);
    v3 = [(CAMViewfinderViewController *)self viewfinderView];
    [v3 setImageAnalysisInstructionLabel:v4];

    [(CAMImageAnalysisInstructionLabel *)v4 setAlpha:0.0];
  }
}

- (void)_configureImageAnalysisButton
{
  v3 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v4 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [v4 setShowsMenuAsPrimaryAction:1];
  [v4 setPrefersDarkGlyphWhenSelected:1];
  [v4 setAdjustsImageWhenHighlighted:0];
  [v4 setAdjustsImageWhenDisabled:0];
  v5 = [MEMORY[0x1E69DC888] systemYellowColor];
  [v4 setTintColor:v5];

  [v4 setDelegate:self];
  [v4 addTarget:self action:sel__handleImageAnalysisButtonTapped_ forControlEvents:64];
  [CAMAnimationHelper highlightScaleForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
  v7 = v6;
  v8 = +[CAMAnimationHelper highlightTransformAnimation];
  [v4 setHighlightedGlyphScaleFactor:v8 animation:v7];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __60__CAMViewfinderViewController__configureImageAnalysisButton__block_invoke;
  v10[3] = &unk_1E76F9668;
  v11 = v3;
  v9 = v3;
  [v4 _setMenuProvider:v10];
}

id __60__CAMViewfinderViewController__configureImageAnalysisButton__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) currentMachineReadableCodeAction];
  v2 = [v1 menuElements];
  if (v2)
  {
    v3 = MEMORY[0x1E69DCC60];
    v4 = [v1 contentPreviewString];
    v5 = [v3 menuWithTitle:v4 children:v2];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (void)_createImageAnalysisButtonIfNeededForConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 devicePosition];

  LODWORD(v4) = [v5 isImageAnalysisSupportedForMode:v6 devicePosition:v7];
  if (v4)
  {
    v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v8 = [(CAMViewfinderViewController *)self _imageAnalysisButton];

    if (!v8)
    {
      v9 = objc_alloc_init(CAMImageAnalysisButton);
      [(CAMImageAnalysisButton *)v9 setAlpha:0.0];
      if (v11)
      {
        [v11 setImageAnalysisButton:v9];
      }

      else
      {
        v10 = [(CAMViewfinderViewController *)self _bottomBar];
        [v10 setImageAnalysisButton:v9];
      }

      [(CAMViewfinderViewController *)self _configureImageAnalysisButton];
      [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
    }
  }
}

- (void)handleExternalChromeImageAnalysisButtonChanged:(id)a3
{
  [(CAMViewfinderViewController *)self _setExternalChromeImageAnalysisButton:a3];
  [(CAMViewfinderViewController *)self _configureImageAnalysisButton];

  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_handleImageAnalysisButtonTapped:(id)a3
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v11 = 0;
    v4 = 0;
    goto LABEL_11;
  }

  v5 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v6 = [v5 currentObjectType];
  v7 = [v5 currentMachineReadableCodeAction];
  v8 = v7;
  if (v6 >= 2)
  {
    if (v6 != 2 || [v7 menuElementsCount] != 1)
    {
      v11 = 0;
      v4 = 0;
      goto LABEL_10;
    }

    v11 = v8;
    v9 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    v10 = [v5 currentObject];
    [v9 countButtonPressForMRC:v10 action:v11];

    v4 = 0;
  }

  else
  {
    v9 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    [v9 countTextButtonPress];
    v11 = 0;
    v4 = 1;
  }

LABEL_10:
LABEL_11:
  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:v4 animated:1];
  [v11 performActionWithCompletion:&__block_literal_global_13];
}

void __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke_cold_1();
    }
  }
}

- (void)_setWantsVisualTextAnalysis:(BOOL)a3 animated:(BOOL)a4
{
  if (self->__wantsVisualTextAnalysis != a3)
  {
    v35[11] = v4;
    v35[12] = v5;
    v6 = a4;
    v7 = a3;
    self->__wantsVisualTextAnalysis = a3;
    v9 = [(CAMViewfinderViewController *)self _motionController];
    v10 = [v9 captureOrientation];

    v11 = [(CAMViewfinderViewController *)self _supportedInterfaceOrientationsForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle] wantsTextAnalysis:0];
    v12 = [(CAMViewfinderViewController *)self view];
    v13 = [v12 window];

    v14 = [v13 _windowOwnsInterfaceOrientation];
    if (!v7)
    {
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisIdentifier:0];
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisStartDate:0];
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisEndDate:0];
      [(CAMViewfinderViewController *)self _setCurrentTextAnalysisDetectionEndDate:0];
      v26 = [(CAMViewfinderViewController *)self _imageAnalyzer];
      [v26 cancelAllRequests];

      v27 = [(CAMViewfinderViewController *)self _textInteractionInsert];
      v28 = [v27 imageInteraction];
      v19 = [v28 feedbackGestureRecognizer];

      v29 = [(CAMViewfinderViewController *)self view];
      [v29 removeGestureRecognizer:v19];

      [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
      [(CAMViewfinderViewController *)self _updateTextAnalysisWithInsert:0 instructions:0 animated:v6];
      [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
      if (v11 == 2)
      {
        if (v14)
        {
          [v13 _setRotatableViewOrientation:1 updateStatusBar:1 duration:1 force:0.0];
        }

        else
        {
          v33[0] = MEMORY[0x1E69E9820];
          v33[1] = 3221225472;
          v33[2] = __68__CAMViewfinderViewController__setWantsVisualTextAnalysis_animated___block_invoke_617;
          v33[3] = &unk_1E76F77B0;
          v33[4] = self;
          [MEMORY[0x1E69DD250] performWithoutAnimation:v33];
        }

        [(CAMViewfinderViewController *)self setNeedsUpdateOfHomeIndicatorAutoHidden];
      }

      goto LABEL_24;
    }

    v15 = [(CAMViewfinderViewController *)self _prominentObjectManager];
    v16 = [v15 currentObjectType];

    if (v16 == 1 || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v17 = objc_claimAutoreleasedReturnValue(), v18 = [v17 isImageAnalysisButtonAlwaysVisible], v17, v18))
    {
      v19 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestForTextAnalysis];
      v20 = [(CAMViewfinderViewController *)self _captureController];
      v35[0] = 0;
      v21 = [v20 captureStillImageWithRequest:v19 error:v35];
      v22 = v35[0];

      if (v21)
      {
        v23 = [MEMORY[0x1E695DF00] now];
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisStartDate:v23];

        v24 = [v19 textAnalysisIdentifier];
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisIdentifier:v24];

        if (v11 == 2)
        {
          if ((v10 - 3) < 2)
          {
            v25 = v14;
          }

          else
          {
            v25 = 0;
          }

          if (v25 == 1)
          {
            [v13 _setRotatableViewOrientation:v10 updateStatusBar:1 duration:1 force:0.0];
          }

          else if ((v14 & 1) == 0)
          {
            v34[0] = MEMORY[0x1E69E9820];
            v34[1] = 3221225472;
            v34[2] = __68__CAMViewfinderViewController__setWantsVisualTextAnalysis_animated___block_invoke;
            v34[3] = &unk_1E76F77B0;
            v34[4] = self;
            [MEMORY[0x1E69DD250] performWithoutAnimation:v34];
          }
        }

LABEL_21:

LABEL_24:
        [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];

        return;
      }
    }

    else
    {
      v19 = 0;
      v22 = 0;
    }

    v30 = @"no prominent text region";
    if (v16 == 1)
    {
      v30 = v22;
    }

    v31 = v30;
    v32 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _setWantsVisualTextAnalysis:animated:];
    }

    [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
    goto LABEL_21;
  }
}

- (void)_handleTextAnalysisStillImageResponse:(id)a3 error:(id)a4 forRequest:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [MEMORY[0x1E695DF00] now];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v12 = [v10 textAnalysisIdentifier];
    v13 = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisIdentifier];
    v14 = [v12 isEqualToString:v13];

    if (v14)
    {
      v15 = [v8 textAnalysisImage];
      if (v15)
      {
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisEndDate:v11];
        v16 = [(CAMViewfinderViewController *)self _imageAnalyzer];
        if (!v16)
        {
          v16 = objc_alloc_init(MEMORY[0x1E69DFA18]);
          [(CAMViewfinderViewController *)self _setImageAnalyzer:v16];
        }

        v17 = [v10 textAnalysisRegion];
        [v17 bounds];
        [v10 captureOrientation];
        _UIConvertRectFromOrientationToOrientation();
        if (CGRectIsEmpty(v24))
        {
          v18 = +[CAMCaptureCapabilities capabilities];
          [v18 isImageAnalysisButtonAlwaysVisible];
        }

        [v15 size];
        CEKExpandNormalizedRect();
        v19 = [MEMORY[0x1E69DFA30] quadFromCGRect:?];
        [v17 baselineAngle];
        v21 = [v19 quadFromRotatingAroundCentroidWithAngle:-v20];
        v22 = [objc_alloc(MEMORY[0x1E69DFA10]) initWithImage:v15 focusQuad:v21 delegate:self];
        [v16 processRequest:v22];
      }

      else
      {
        v23 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController _handleTextAnalysisStillImageResponse:error:forRequest:];
        }

        [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
      }
    }
  }
}

- (void)_updateTextAnalysisWithInsert:(id)a3 instructions:(BOOL)a4 animated:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v8 = a3;
  [(CAMViewfinderViewController *)self _setWantsVisualTextSelectionInstructions:v6];
  if (v6)
  {
    v9 = [(CAMViewfinderViewController *)self _timerCache];
    [v9 cancelTimerForKey:&unk_1F16C7760];

    [(CAMViewfinderViewController *)self _createImageAnalysisInstructionLabelIfNeeded];
  }

  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
  [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v5];
  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = [(CAMViewfinderViewController *)self viewfinderView];
  if (v8)
  {
    v12 = [(CAMViewfinderViewController *)self _textInteractionBackground];
    if (!v12)
    {
      v13 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
      v12 = objc_alloc_init(CAMCounterRotatingView);
      v14 = [MEMORY[0x1E69DC888] colorWithWhite:0.0 alpha:0.5];
      [(CAMCounterRotatingView *)v12 setBackgroundColor:v14];

      [(CAMCounterRotatingView *)v12 setAlpha:0.0];
      [(CAMViewfinderViewController *)self _setTextInteractionBackground:v12];
      if (v10)
      {
        v15 = [v13 superview];
        [v15 insertSubview:v12 belowSubview:v13];
      }

      else
      {
        v15 = [(CAMViewfinderViewController *)self _bottomBar];
        [v15 setImageAnalysisButtonBackgroundOverlay:v12];
      }

      v18 = [objc_alloc(MEMORY[0x1E69DD060]) initWithTarget:self action:sel__handleDismissLiftedTextGestureRecognizer_];
      [(CAMCounterRotatingView *)v12 addGestureRecognizer:v18];
    }

    [v10 setTextInteractionInsert:v8];
    [v11 setTextInteractionInsert:v8];
    [v8 setDelegate:self];
    if (v5)
    {
      [v8 performLiftAnimation];
    }

    else
    {
      v19 = MEMORY[0x1E69DD250];
      v21[0] = MEMORY[0x1E69E9820];
      v21[1] = 3221225472;
      v21[2] = __83__CAMViewfinderViewController__updateTextAnalysisWithInsert_instructions_animated___block_invoke;
      v21[3] = &unk_1E76F77B0;
      v22 = v8;
      [v19 performWithoutAnimation:v21];
    }

    goto LABEL_15;
  }

  v16 = [(CAMViewfinderViewController *)self _textInteractionInsert];
  v12 = v16;
  if (v5)
  {
    [(CAMCounterRotatingView *)v16 fadeOutAndRemoveFromSuperview];
LABEL_15:

    goto LABEL_16;
  }

  [(CAMViewfinderViewController *)self animateAlongsideFadeOutForTextLiftingView:v16];

  v17 = [(CAMViewfinderViewController *)self _textInteractionInsert];
  [(CAMViewfinderViewController *)self fadeOutAnimationDidEndForView:v17];

LABEL_16:
  v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v20 setIsShowingLiftingTextView:v8 != 0];
}

- (void)_updateImageAnalysisButton
{
  v16 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v3 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _shouldShowImageAnalysisButtonForGraphConfiguration:v4];

  v6 = [v3 isContextMenuDisplayed];
  v7 = v6;
  if (v5 && (v6 & 1) == 0)
  {
    v8 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
    v9 = [v16 currentObjectType];
    if (v8 || v9 != 2)
    {
      [v3 setMode:0];
    }

    else
    {
      v10 = [v16 currentObject];
      v11 = [v10 mrcType];
      if (v11 > 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = qword_1A3A68398[v11];
      }

      [v3 setMode:v12];
      v8 = [(CAMViewfinderViewController *)self _layoutStyle]== 1;
    }

    [v3 setSelected:v8];
  }

  if ((v7 & 1) == 0)
  {
    v13 = [v16 currentMachineReadableCodeAction];
    v14 = v13;
    if (v13 && [v13 menuElementsCount] >= 2)
    {
      v15 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis]^ 1;
    }

    else
    {
      v15 = 0;
    }

    [v3 setContextMenuInteractionEnabled:v15];
  }
}

- (void)_updateImageAnalysisInstructions
{
  v9 = [(CAMViewfinderViewController *)self _imageAnalysisInstructionLabel];
  v3 = [v9 instruction];
  v4 = [(CAMViewfinderViewController *)self _wantsVisualTextSelectionInstructions];
  v5 = [(CAMViewfinderViewController *)self _timerCache];
  v6 = [v5 isRunningTimerForKey:&unk_1F16C7760];

  if (v6)
  {
    v7 = 1;
  }

  else
  {
    v7 = v3;
  }

  if (v4)
  {
    v8 = 0;
  }

  else
  {
    v8 = v7;
  }

  [v9 setInstruction:v8];
}

- (id)_stillImageCaptureRequestForTextAnalysis
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = objc_alloc_init(CAMMutableStillImageCaptureRequest);
  [(CAMMutableStillImageCaptureRequest *)v4 setDelegate:self];
  v5 = [MEMORY[0x1E696AFB0] UUID];
  v6 = [v5 UUIDString];
  [(CAMMutableStillImageCaptureRequest *)v4 setTextAnalysisIdentifier:v6];

  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureMirrored:[(CAMViewfinderViewController *)self _currentDevicePosition]== 1];
  v7 = [(CAMViewfinderViewController *)self _motionController];
  -[CAMMutableStillImageCaptureRequest setCaptureOrientation:](v4, "setCaptureOrientation:", [v7 captureOrientation]);

  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureDevice:[(CAMViewfinderViewController *)self _currentDevice]];
  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureMode:v3];
  [(CAMMutableStillImageCaptureRequest *)v4 setAspectRatioCrop:[(CAMViewfinderViewController *)self _aspectRatioCropForMode:v3 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsAudioForCapture:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setPhotoQualityPrioritization:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setFlashMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setHdrMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setIrisMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsAutoDualCameraFusion:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setPersistenceOptions:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setUserInitiationTime:mach_absolute_time()];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsSemanticSceneFilter:0];
  v8 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v9 = [v8 currentObject];
  if ([v8 currentObjectType] == 1)
  {
    v10 = v9;
  }

  else
  {
    v10 = 0;
  }

  [(CAMMutableStillImageCaptureRequest *)v4 setTextAnalysisRegion:v10];
  if (!v10)
  {
    v11 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _stillImageCaptureRequestForTextAnalysis];
    }
  }

  [(CAMViewfinderViewController *)self _desiredPreviewSizeForStillImageCapture];
  [(CAMMutableStillImageCaptureRequest *)v4 setDesiredPreviewSize:round(v12 * 1.2), round(v13 * 1.2)];

  return v4;
}

- (void)animateAlongsideTextLiftingForView:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [v3 setAlpha:1.0];
}

- (void)animateAlongsideFadeOutForTextLiftingView:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [v3 setAlpha:0.0];
}

- (void)fadeOutAnimationDidEndForView:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _textInteractionInsert];

  if (v5 == v4)
  {
    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v6 setTextInteractionInsert:0];

    v7 = [(CAMViewfinderViewController *)self viewfinderView];
    [v7 setTextInteractionInsert:0];
  }
}

- (void)imageAnalysisButton:(id)a3 didChangeContextMenuDisplayed:(BOOL)a4
{
  if (a4)
  {
    v8 = [(CAMViewfinderViewController *)self _prominentObjectManager];
    v5 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    v6 = [v8 currentObject];
    v7 = [v8 currentMachineReadableCodeAction];
    [v5 countButtonPressForMRC:v6 action:v7];
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateForCurrentMachineReadableCodeAction];

    [(CAMViewfinderViewController *)self _dismissDockedMRCButtonIfNeededAnimated:1];
  }
}

- (BOOL)imageAnalysisInteraction:(id)a3 shouldBeginAtPoint:(CGPoint)a4 forAnalysisType:(unint64_t)a5
{
  [(CAMViewfinderViewController *)self _setWantsVisualTextSelectionInstructions:0, a5, a4.x, a4.y];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  return 1;
}

- (void)request:(id)a3 didFailWithError:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController request:didFailWithError:];
  }

  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0 animated:1];
  [(CAMViewfinderViewController *)self _startTimer:3];
  [(CAMViewfinderViewController *)self _createImageAnalysisInstructionLabelIfNeeded];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isInternalInstall];

  if (v10)
  {
    v11 = [MEMORY[0x1E69DC650] alertControllerWithTitle:@"Text Analysis Error" message:@"An error occurred during text analysis request processing." preferredStyle:1];
    v12 = MEMORY[0x1E69DC648];
    v15 = MEMORY[0x1E69E9820];
    v16 = 3221225472;
    v17 = __56__CAMViewfinderViewController_request_didFailWithError___block_invoke;
    v18 = &unk_1E76F96B0;
    v19 = v6;
    v20 = v7;
    v13 = [v12 actionWithTitle:@"File Radar" style:0 handler:&v15];
    [v11 addAction:{v13, v15, v16, v17, v18}];

    v14 = [MEMORY[0x1E69DC648] actionWithTitle:@"Cancel" style:1 handler:0];
    [v11 addAction:v14];

    [(CAMViewfinderViewController *)self presentViewController:v11 animated:1 completion:0];
  }
}

void __56__CAMViewfinderViewController_request_didFailWithError___block_invoke(uint64_t a1)
{
  v2 = objc_alloc_init(MEMORY[0x1E69DFA20]);
  [v2 setAssetsProvider:*(a1 + 32)];
  [v2 setError:*(a1 + 40)];
  [v2 provideFeedbackWithType:2 options:-1 metadata:0 promisedAttachments:0 userResponseHandler:&__block_literal_global_641];
}

void __56__CAMViewfinderViewController_request_didFailWithError___block_invoke_2(uint64_t a1, char a2)
{
  if ((a2 & 1) == 0)
  {
    v2 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      *v3 = 0;
      _os_log_impl(&dword_1A3640000, v2, OS_LOG_TYPE_DEFAULT, "Launched TTR for text analysis failure", v3, 2u);
    }
  }
}

- (void)request:(id)a3 didDetectTextWithResult:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [MEMORY[0x1E695DF00] now];
  [(CAMViewfinderViewController *)self _setCurrentTextAnalysisDetectionEndDate:v8];

  v9 = [v7 boundingPathWithPadding:8.0 cornerRadius:8.0];
  v10 = objc_alloc(MEMORY[0x1E69DFA38]);
  v11 = [v6 image];
  [v7 baselineAngle];
  v12 = [v10 initWithImage:v11 cutoutPath:v9 baselineAngle:?];

  [v12 setMaxScale:4.0];
  [v12 setPresentsQuickActions:1];
  objc_initWeak(&location, self);
  v13 = MEMORY[0x1E69E9820];
  v14 = 3221225472;
  v15 = __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke;
  v16 = &unk_1E76F9700;
  objc_copyWeak(&v17, &location);
  [v12 setQuickActionConfigurationUpdateHandler:&v13];
  [(CAMViewfinderViewController *)self _updateTextAnalysisWithInsert:v12 instructions:1 animated:1, v13, v14, v15, v16];
  objc_destroyWeak(&v17);
  objc_destroyWeak(&location);
}

void __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [v3 configuration];
  if ([v3 state] == 4)
  {
    v5 = [MEMORY[0x1E69DC888] blackColor];
    [v4 setBaseForegroundColor:v5];

    [MEMORY[0x1E69DC888] systemYellowColor];
  }

  else
  {
    v6 = [MEMORY[0x1E69DC888] whiteColor];
    [v4 setBaseForegroundColor:v6];

    [MEMORY[0x1E69DC888] colorWithWhite:0.0 alpha:0.5];
  }
  v7 = ;
  [v4 setBaseBackgroundColor:v7];

  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke_2;
  v8[3] = &unk_1E76F96D8;
  objc_copyWeak(&v9, (a1 + 32));
  [v4 setTitleTextAttributesTransformer:v8];
  [v3 setConfiguration:v4];
  objc_destroyWeak(&v9);
}

id __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke_2(uint64_t a1, void *a2)
{
  v3 = [a2 mutableCopy];
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v5 = [WeakRetained traitCollection];
  v6 = [v5 preferredContentSizeCategory];

  v7 = [CAMFont cameraModeDialFontForContentSize:v6];
  [v3 setObject:v7 forKeyedSubscript:*MEMORY[0x1E69DB648]];

  return v3;
}

- (void)request:(id)a3 didRecgonizeTextWithAnalysis:(id)a4
{
  v32 = *MEMORY[0x1E69E9840];
  v5 = MEMORY[0x1E695DF00];
  v6 = a4;
  v7 = [v5 now];
  v8 = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisStateDate];
  v9 = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisEndDate];
  v10 = [(CAMViewfinderViewController *)self _currentTextAnalysisDetectionEndDate];
  v11 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    [v9 timeIntervalSinceDate:v8];
    v13 = v12;
    [v10 timeIntervalSinceDate:v9];
    v15 = v14;
    [v7 timeIntervalSinceDate:v10];
    v17 = v16;
    [v7 timeIntervalSinceDate:v8];
    v24 = 134218752;
    v25 = v13;
    v26 = 2048;
    v27 = v15;
    v28 = 2048;
    v29 = v17;
    v30 = 2048;
    v31 = v18;
    _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Text analysis completed with time for capture: %.3fs detection: %.3fs recognition: %.3fs total: %.3fs", &v24, 0x2Au);
  }

  v19 = [objc_alloc(MEMORY[0x1E69DFA28]) initWithInteractionOptions:5];
  [v19 setActiveInteractionTypes:3];
  [v19 setDataDetectorTypes:4091];
  [v19 setAnalysis:v6];

  [v19 setDelegate:self];
  [v19 set_customAnalyticsIdentifier:@"com.apple.camera.livetext"];
  v20 = [(CAMViewfinderViewController *)self _textInteractionInsert];
  [v20 setImageInteraction:v19];

  v21 = [(CAMViewfinderViewController *)self view];
  [v21 setNeedsLayout];

  v22 = [(CAMViewfinderViewController *)self view];
  v23 = [v19 feedbackGestureRecognizer];
  [v22 addGestureRecognizer:v23];
}

- (void)captureController:(id)a3 didOutputQRCodeResults:(id)a4
{
  [(CAMViewfinderViewController *)self _setCachedQRCodeResults:a4];

  [(CAMViewfinderViewController *)self _captureControllerDidOutputMRC];
}

- (void)captureController:(id)a3 didOutputAppClipCodeResults:(id)a4
{
  [(CAMViewfinderViewController *)self _setCachedAppClipCodeResults:a4];

  [(CAMViewfinderViewController *)self _captureControllerDidOutputMRC];
}

- (void)_captureControllerDidOutputMRC
{
  if ([(CAMViewfinderViewController *)self _shouldProcessMachineReadableMetadata])
  {
    v3 = ![(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  }

  else
  {
    v3 = 0;
  }

  v4 = [(CAMViewfinderViewController *)self _cachedQRCodeResults];
  v5 = v4;
  v6 = MEMORY[0x1E695E0F0];
  if (v4)
  {
    v7 = v4;
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  v8 = v7;

  v9 = [(CAMViewfinderViewController *)self _cachedAppClipCodeResults];
  v10 = v9;
  if (v9)
  {
    v11 = v9;
  }

  else
  {
    v11 = v6;
  }

  v12 = v11;

  if (v3)
  {
    v6 = [v8 arrayByAddingObjectsFromArray:v12];
  }

  if ([v6 count] || -[CAMViewfinderViewController _lastMRCResultsCount](self, "_lastMRCResultsCount"))
  {
    -[CAMViewfinderViewController _setLastMRCResultsCount:](self, "_setLastMRCResultsCount:", [v6 count]);
    v13 = [(CAMViewfinderViewController *)self _previewViewController];
    v14 = [(CAMViewfinderViewController *)self _machineReadableCodeLoggingController];
    v15 = +[CAMApplication appOrPlugInState];
    if ([v6 count])
    {
      if (v15)
      {
        [v14 logMachineReadableCodeResultDuringInactiveAppState];
      }
    }

    else
    {
      [v14 resetLoggingState];
    }

    [(CAMViewfinderViewController *)self _updateCachedMRCResults:v6];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    v16 = +[CAMCaptureCapabilities capabilities];
    v17 = [v16 isImageAnalysisSupported];

    if (v17)
    {
      [(CAMViewfinderViewController *)self _updateProminentObjectManagerWithCachedMetadataResults];
    }

    else
    {
      v18 = [(CAMViewfinderViewController *)self _acceptableSizeMRCResultsFromResults:v6];
      v19 = v18;
      if (!v15 && [v18 count])
      {
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke;
        v20[3] = &unk_1E76F9728;
        v21 = v13;
        [(CAMViewfinderViewController *)self _processResults:v19 completionHandler:v20];
      }
    }
  }
}

void __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if (v3)
  {
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke_2;
    v4[3] = &unk_1E76F7960;
    v5 = *(a1 + 32);
    v6 = v3;
    dispatch_async(MEMORY[0x1E69E96A0], v4);
  }
}

- (void)_updateCachedMRCResults:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _previewViewController];
  [v5 setCachedMRCResults:v4];

  v6 = [(CAMViewfinderViewController *)self _targetQRCodeInstructionLabel];
  [v6 setMRCResults:v4];
}

- (id)_acceptableSizeMRCResultsFromResults:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _machineReadableCodeLoggingController];
  v6 = MEMORY[0x1E696AE18];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __68__CAMViewfinderViewController__acceptableSizeMRCResultsFromResults___block_invoke;
  v11[3] = &unk_1E76F9750;
  v12 = v5;
  v7 = v5;
  v8 = [v6 predicateWithBlock:v11];
  v9 = [v4 filteredArrayUsingPredicate:v8];

  return v9;
}

uint64_t __68__CAMViewfinderViewController__acceptableSizeMRCResultsFromResults___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [v3 isOfSignificantSize];
  [*(a1 + 32) logMachineReadableCodeResult:v3 isOfSignificantSize:v4];

  return v4;
}

- (void)_processResults:(id)a3 completionHandler:(id)a4
{
  v35 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  if (![v6 count])
  {
    v7[2](v7, 0);
  }

  v8 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v9 = v6;
  v10 = [v9 countByEnumeratingWithState:&v21 objects:v34 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      v12 = 0;
      do
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(v9);
        }

        v13 = [*(*(&v21 + 1) + 8 * v12) underlyingMachineReadableCodeObject];
        [v8 addObject:v13];

        ++v12;
      }

      while (v10 != v12);
      v10 = [v9 countByEnumeratingWithState:&v21 objects:v34 count:16];
    }

    while (v10);
  }

  v14 = [(CAMViewfinderViewController *)self _barcodeParsingSession];
  if (!v14)
  {
    v15 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_1A3640000, v15, OS_LOG_TYPE_DEFAULT, "Recognized the first acceptable size QR Code, starting new barcode parsing session", buf, 2u);
    }

    v30 = 0;
    v31 = &v30;
    v32 = 0x2050000000;
    v16 = getBCSAVParsingSessionClass_softClass;
    v33 = getBCSAVParsingSessionClass_softClass;
    if (!getBCSAVParsingSessionClass_softClass)
    {
      *buf = MEMORY[0x1E69E9820];
      v26 = 3221225472;
      v27 = __getBCSAVParsingSessionClass_block_invoke;
      v28 = &unk_1E76F8100;
      v29 = &v30;
      __getBCSAVParsingSessionClass_block_invoke(buf);
      v16 = v31[3];
    }

    v17 = v16;
    _Block_object_dispose(&v30, 8);
    v14 = objc_alloc_init(v16);
    [(CAMViewfinderViewController *)self _setBarcodeParsingSession:v14];
  }

  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __65__CAMViewfinderViewController__processResults_completionHandler___block_invoke;
  v19[3] = &unk_1E76F9778;
  v20 = v7;
  v18 = v7;
  [v14 updateSessionWithMetadataObjects:v8 completionHandler:v19];
}

void __65__CAMViewfinderViewController__processResults_completionHandler___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v13 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v7 = v6;
  if (v5)
  {
    v8 = [[CAMMachineReadableCodeResult alloc] initWithMachineReadableCodeObject:v5];
    if (!v7)
    {
      goto LABEL_8;
    }
  }

  else
  {
    v8 = 0;
    if (!v6)
    {
      goto LABEL_8;
    }
  }

  v9 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    v10 = [v7 description];
    v11 = 138543362;
    v12 = v10;
    _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "There was an error updating the QR barcode parsing session: %{public}@", &v11, 0xCu);
  }

LABEL_8:
  (*(*(a1 + 32) + 16))();
}

- (void)_dismissDockedMRCButtonIfNeededAnimated:(BOOL)a3
{
  v3 = a3;
  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v6 = [v5 currentMachineReadableCodeAction];

  v7 = [v10 imageAnalysisButton];
  v8 = [v7 isContextMenuDisplayed];

  if (!v6 && (v8 & 1) == 0 && ![(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton]|| [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded])
  {
    if (v10)
    {
      [v10 dismissMachineReadableCodeButtonAnimated:v3];
    }

    else
    {
      v9 = [(CAMViewfinderViewController *)self viewfinderView];
      [v9 dismissMachineReadableCodeButtonAnimated:v3];
    }
  }

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)machineReadableCodeButtonDidTapDismiss:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = [v5 machineReadableCodeButton];

  if (v6 == v4)
  {
    v7 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v8 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Tapped to dismiss MRC button", v8, 2u);
    }

    [v5 dismissMachineReadableCodeButtonAnimated:1];
    [v4 setDelegate:0];
  }

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)_updateProminentObjectManagerWithCachedMetadataResults
{
  if (!+[CAMApplication appOrPlugInState])
  {
    v17 = [(CAMViewfinderViewController *)self _previewViewController];
    v3 = [v17 cachedTextRegionResults];
    v4 = v3;
    v5 = MEMORY[0x1E695E0F0];
    if (v3)
    {
      v6 = v3;
    }

    else
    {
      v6 = MEMORY[0x1E695E0F0];
    }

    v7 = v6;

    v8 = [v17 cachedMRCResults];
    v9 = v8;
    if (v8)
    {
      v10 = v8;
    }

    else
    {
      v10 = v5;
    }

    v11 = v10;

    v12 = [(CAMViewfinderViewController *)self _acceptableSizeMRCResultsFromResults:v11];
    v13 = [v7 arrayByAddingObjectsFromArray:v12];
    v14 = [(CAMViewfinderViewController *)self _prominentObjectManager];
    [v14 updateWithCandidateObjects:v13];

    v15 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    [v15 countObservedSignficantMRCs:v12];
    v16 = [v7 count];

    [v15 countObservedSignficantTextRegionCount:v16];
  }
}

- (void)_updateDocumentScanningButtonIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isDocumentScanningSupported];

  if (v4)
  {
    v15 = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = [(CAMViewfinderViewController *)self _shouldShowDocumentScanningButton];
    v6 = [(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton];
    v7 = [(CAMViewfinderViewController *)self _timerCache];
    v8 = [v7 isRunningTimerForKey:&unk_1F16C7778];

    if (v5)
    {
      if (v6)
      {
        v9 = [(CAMViewfinderViewController *)self _timerCache];
        [v9 cancelTimerForKey:&unk_1F16C7778];
      }

      else
      {
        v10 = [MEMORY[0x1E69DCAB8] systemImageNamed:@"doc.viewfinder"];
        v11 = CAMLocalizedFrameworkString(@"DOCUMENT_SCANNING_TITLE", 0);
        v12 = [CAMMachineReadableCodeButton buttonWithType:0];
        [v12 setAttributedTitleWithTitle:v11 image:v10];
        [v12 addTarget:self action:sel__handleDocumentScanningPillPress forControlEvents:64];
        if (v15)
        {
          [v15 adoptMachineReadableCodeButton:v12 animated:1];
        }

        else
        {
          v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
          [v13 adoptMachineReadableCodeButton:v12 fromOriginalParent:0 animated:1];
        }

        v14 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
        [v14 countObservedDocumentScanning];
      }
    }

    else if (!(v8 & 1 | !v6))
    {
      [(CAMViewfinderViewController *)self _startTimer:4];
    }
  }
}

- (void)_dismissDocumentScanningButton
{
  if (![(CAMViewfinderViewController *)self _shouldShowDocumentScanningButton]&& [(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton])
  {
    v3 = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = v3;
    if (v3)
    {
      [v3 dismissMachineReadableCodeButtonAnimated:1];
    }

    else
    {
      v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v4 dismissMachineReadableCodeButtonAnimated:1];
    }
  }
}

- (BOOL)_shouldShowDocumentScanningButton
{
  v3 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  if (([(CAMViewfinderViewController *)self _currentMode]| 4) != 4 || v3)
  {
    goto LABEL_3;
  }

  v4 = [(CAMViewfinderViewController *)self _isDocumentInScene];
  if (!v4)
  {
    return v4;
  }

  if ([(CAMViewfinderViewController *)self _isDisplayingMRCButton]|| [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
LABEL_3:
    LOBYTE(v4) = 0;
  }

  else
  {
    LOBYTE(v4) = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v4;
}

- (BOOL)_isDisplayingDocumentScanningButton
{
  v3 = [(CAMViewfinderViewController *)self viewfinderView];
  v4 = v3;
  if (v3)
  {
    v5 = [v3 machineReadableCodeButton];
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v5 = [v6 machineReadableCodeButton];
  }

  v7 = [v5 title];
  v8 = CAMLocalizedFrameworkString(@"DOCUMENT_SCANNING_TITLE", 0);
  v9 = [v7 isEqualToString:v8];

  return v9;
}

- (BOOL)_isDisplayingMRCButton
{
  v3 = [(CAMViewfinderViewController *)self viewfinderView];
  v4 = v3;
  if (!v3)
  {
    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v5 = [v7 machineReadableCodeButton];

    if (v5)
    {
      goto LABEL_3;
    }

LABEL_5:
    LOBYTE(v6) = 0;
    goto LABEL_6;
  }

  v5 = [v3 machineReadableCodeButton];
  if (!v5)
  {
    goto LABEL_5;
  }

LABEL_3:
  v6 = ![(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton];
LABEL_6:

  return v6;
}

- (CGPoint)prominentObjectManagerPointOfInterestInNormalizedDeviceSpace:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  [v3 pointOfInterestInNormalizedCaptureDeviceSpace];
  v5 = v4;
  v7 = v6;

  v8 = v5;
  v9 = v7;
  result.y = v9;
  result.x = v8;
  return result;
}

- (void)prominentObjectManager:(id)a3 didChangeCurrentObject:(id)a4
{
  v17 = *MEMORY[0x1E69E9840];
  v5 = a4;
  v6 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v7 = [v5 metadataType];
    v15 = 138543362;
    v16 = v7;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Current prominent object metadata type: %{public}@", &v15, 0xCu);
  }

  v8 = [(CAMViewfinderViewController *)self _previewViewController];
  v9 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v10 = [v9 currentObjectType];

  v11 = 0;
  if (v10 == 2)
  {
    v13 = v5;
    goto LABEL_7;
  }

  v12 = 0;
  if (v10 == 1)
  {
    v13 = 0;
    v11 = v5;
LABEL_7:
    v12 = v11;
    v14 = v5;
    v11 = v13;
  }

  [v8 setCachedSignificantTextRegionResult:v12];
  [v8 setCachedSignificantMRCResult:v11];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _dismissDockedMRCButtonIfNeededAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_updateMachineReadableCodeButtonFromAction:(id)a3
{
  v17 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  v6 = [v5 isContextMenuDisplayed];
  v7 = os_log_create("com.apple.camera", "MachineReadableCode");
  v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
  if (v6)
  {
    if (!v8)
    {
LABEL_11:

      goto LABEL_12;
    }

    v9 = [v4 dataTypeDisplayString];
    v15 = 138543362;
    v16 = v9;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Already showing MRC menu, ignoring new prominent MRC type: %{public}@", &v15, 0xCu);
LABEL_10:

    goto LABEL_11;
  }

  if (v8)
  {
    v10 = [v4 dataTypeDisplayString];
    v15 = 138543362;
    v16 = v10;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Current prominent MRC type: %{public}@", &v15, 0xCu);
  }

  [(CAMViewfinderViewController *)self _updateForCurrentMachineReadableCodeAction];
  if (v4)
  {
    v7 = [CAMMachineReadableCodeButton buttonWithType:0];
    v11 = [v4 shortDescription];
    v12 = [v4 actionIcon];
    [v7 setAttributedTitleWithTitle:v11 image:v12];

    [v7 addTarget:self action:sel__handlePillPressForCurrentMRCAction forControlEvents:64];
    v13 = [(CAMViewfinderViewController *)self viewfinderView];
    v9 = v13;
    if (v13)
    {
      [v13 adoptMachineReadableCodeButton:v7 animated:1];
      [v7 setDelegate:self];
      [v7 setDismissable:1];
    }

    else
    {
      v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v14 adoptMachineReadableCodeButton:v7 fromOriginalParent:0 animated:1];
    }

    goto LABEL_10;
  }

LABEL_12:
  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)_updateMachineReadableCodeButtonForAction:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v21 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self viewfinderView];
  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = v8;
  if (v7)
  {
    v8 = v7;
  }

  v10 = [v8 machineReadableCodeButton];
  if (v10)
  {
    v11 = [v6 shortDescription];
    v12 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v20 = v11;
      _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Updating MRC button with title: %{public}@", buf, 0xCu);
    }

    v13 = [v6 actionIcon];
    [v10 setAttributedTitleWithTitle:v11 image:v13];

    if (v7)
    {
      v14 = v7;
    }

    else
    {
      v14 = v9;
    }

    v15 = v14;
    [v15 setNeedsLayout];
    if (v4)
    {
      v16 = MEMORY[0x1E69DD250];
      v17[0] = MEMORY[0x1E69E9820];
      v17[1] = 3221225472;
      v17[2] = __82__CAMViewfinderViewController__updateMachineReadableCodeButtonForAction_animated___block_invoke;
      v17[3] = &unk_1E76F77B0;
      v18 = v15;
      [v16 animateWithDuration:2 delay:v17 usingSpringWithDamping:0 initialSpringVelocity:0.5 options:0.0 animations:1.0 completion:1.0];
    }
  }
}

- (void)_updateForCurrentMachineReadableCodeAction
{
  v3 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v4 = [v3 currentMachineReadableCodeAction];

  [v4 setDelegate:self];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_handlePillPressForCurrentMRCAction
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v4 = [v3 cachedSignificantMRCResult];

  v5 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v6 = [v5 currentMachineReadableCodeAction];

  v7 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v7 countPillPressForMRC:v4 action:v6];

  v8 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = [v6 detectedCode];
    v10 = 138543362;
    v11 = v9;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Performing action for MRC code: %{public}@", &v10, 0xCu);
  }

  [v6 performActionWithCompletion:&__block_literal_global_674];
}

void __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke_cold_1();
    }
  }
}

- (void)_handleDocumentScanningPillPress
{
  objc_initWeak(&location, self);
  v3 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v3 countButtonPressForDocumentScanning];

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke;
  aBlock[3] = &unk_1E76F8580;
  objc_copyWeak(&v9, &location);
  v4 = _Block_copy(aBlock);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_4;
  v6[3] = &unk_1E76F97A0;
  v5 = v4;
  v7 = v5;
  [(CAMViewfinderViewController *)self _requestPasscodeUnlockForDocumentScanningWithCompletionBlock:v6];

  objc_destroyWeak(&v9);
  objc_destroyWeak(&location);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_2;
  v3[3] = &unk_1E76F8580;
  objc_copyWeak(&v4, (a1 + 32));
  [WeakRetained suspendCameraSessionWithCompletion:v3];

  objc_destroyWeak(&v4);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_2(uint64_t a1)
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_3;
  block[3] = &unk_1E76F8580;
  objc_copyWeak(&v2, (a1 + 32));
  dispatch_async(MEMORY[0x1E69E96A0], block);
  objc_destroyWeak(&v2);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_3(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained presentDocumentScanningViewControllerAnimated:1];
}

uint64_t __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_4(uint64_t result, int a2)
{
  if (a2)
  {
    return (*(*(result + 32) + 16))();
  }

  return result;
}

- (void)presentDocumentScanningViewControllerAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = objc_alloc_init(CAMDocumentScanFlowController);
  [(CAMDocumentScanFlowController *)v5 setDocumentFlowDelegate:self];
  [(CAMViewfinderViewController *)self presentModalViewController:v5 animated:v3];
}

- (CGRect)sourceRectForPopoverActionPicker:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [v4 bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  v13 = [(CAMViewfinderViewController *)self view];
  [v4 convertRect:v13 toView:{v6, v8, v10, v12}];
  v15 = v14;
  v17 = v16;
  v19 = v18;
  v21 = v20;

  v22 = v15;
  v23 = v17;
  v24 = v19;
  v25 = v21;
  result.size.height = v25;
  result.size.width = v24;
  result.origin.y = v23;
  result.origin.x = v22;
  return result;
}

- (void)actionDidUpdateTitle:(id)a3
{
  v4 = a3;
  v9 = 0;
  v10 = &v9;
  v11 = 0x2050000000;
  v5 = getBCSActionClass_softClass;
  v12 = getBCSActionClass_softClass;
  if (!getBCSActionClass_softClass)
  {
    v8[0] = MEMORY[0x1E69E9820];
    v8[1] = 3221225472;
    v8[2] = __getBCSActionClass_block_invoke;
    v8[3] = &unk_1E76F8100;
    v8[4] = &v9;
    __getBCSActionClass_block_invoke(v8);
    v5 = v10[3];
  }

  v6 = v5;
  _Block_object_dispose(&v9, 8);
  if (objc_opt_isKindOfClass())
  {
    [(CAMViewfinderViewController *)self _updateMachineReadableCodeButtonForAction:v4 animated:1];
  }

  else
  {
    v7 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController actionDidUpdateTitle:];
    }
  }
}

- (void)captureController:(id)a3 didOutputHistogramResult:(id)a4
{
  v5 = a4;
  [(CAMViewfinderViewController *)self _shadowClippingValue];
  v7 = v6;
  [v5 shadowClipping];
  [(CAMViewfinderViewController *)self _setShadowClippingValue:v8 * 0.3 + v7 * 0.7];
  [(CAMViewfinderViewController *)self _highlightClippingValue];
  v10 = v9;
  [v5 highlightClipping];
  v12 = v11;

  [(CAMViewfinderViewController *)self _setHighlightClippingValue:v12 * 0.3 + v10 * 0.7];

  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_resetExposureClipping
{
  [(CAMViewfinderViewController *)self _setShadowClippingValue:0.0];
  [(CAMViewfinderViewController *)self _setHighlightClippingValue:0.0];

  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_previewDidStartRunning:(id)a3
{
  v40 = *MEMORY[0x1E69E9840];
  v4 = a3;
  CAMSignpostWithIDAndArgs(7, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v5 = [v4 object];

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 videoPreviewLayer];

  if (v5 == v7)
  {
    v8 = [(CAMViewfinderViewController *)self _closedViewfinderController];
    v9 = [(CAMViewfinderViewController *)self _locationController];
    v10 = [(CAMViewfinderViewController *)self _keepAliveController];
    v37 = +[CAMCaptureCapabilities capabilities];
    v11 = [(CAMViewfinderViewController *)self _currentMode];
    v12 = [(CAMViewfinderViewController *)self _currentDevicePosition];
    v13 = [v8 descriptionForTimeBetweenReferenceAndNow];
    v14 = os_log_create("com.apple.camera", "CaptureSession");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v39 = v13;
      _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Received AVCaptureVideoPreviewLayerDidStartRunningNotification %{public}@", buf, 0xCu);
    }

    v36 = v13;

    [v8 removeClosedViewfinderReason:5];
    [v8 removeClosedViewfinderReason:3];
    if (![(CUCaptureController *)self->__captureController isCapturingTimelapse])
    {
      [v9 setEnabled:1];
    }

    [v9 setHeadingEnabled:1];
    if ([(CAMViewfinderViewController *)self automaticallyAdjustsApplicationIdleTimer])
    {
      v15 = [(CAMViewfinderViewController *)self _idleController];
      [v15 startUpdatingIdleTimer];
    }

    v16 = [(CAMViewfinderViewController *)self _cameraRollController];
    [v16 preload];

    v35 = v10;
    [v10 startKeepAliveSession];
    v17 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v17 createConnectionIfNecessary];
    v18 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    if (!v18)
    {
      if (![v37 isImageAnalysisSupportedForMode:v11 devicePosition:v12])
      {
        goto LABEL_12;
      }

      v19 = +[CAMUserPreferences preferences];
      v34 = [v19 isImageAnalysisEnabled];

      v20 = +[CAMUserPreferences preferences];
      v21 = [v20 shouldShowQRBanners];

      v22 = +[CAMCaptureCapabilities capabilities];
      v23 = [v22 isDocumentScanningSupported];

      v18 = [[CAMAnalyticsVisionSession alloc] initWithTextDetectionEnabled:v34 MRCDetectionEnabled:v21 documentScanningEnabled:v23];
      [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:v18];
    }

LABEL_12:
    v24 = +[CAMUserPreferences preferences];
    v25 = [v24 sharedLibraryAutoBehaviorEnabled];

    if (v25)
    {
      v26 = [(CAMViewfinderViewController *)self _librarySelectionController];
      [v26 startAcquiringSignals];
    }

    if (+[CAMApplication appOrPlugInState]!= 2)
    {
      [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
      v27 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      [v27 didStartPreview];
    }

    [(CAMViewfinderViewController *)self _setUpTipManagerIfNeeded];
    [(CAMViewfinderViewController *)self _resetObjectResults];
    v28 = +[CAMCaptureCapabilities capabilities];
    v29 = v36;
    if ([(CAMDockKitController *)v28 isiPhone])
    {
      dockKitController = self->__dockKitController;

      if (dockKitController)
      {
LABEL_20:
        v33 = [MEMORY[0x1E69C4598] sharedScheduler];
        [v33 applicationDidFinishExtendedLaunch];

        goto LABEL_21;
      }

      v31 = [_TtC8CameraUI20CAMDockKitController alloc];
      v32 = [(CAMViewfinderViewController *)self _motionController];
      v28 = [(CAMDockKitController *)v31 initWithMotionController:v32];

      v29 = v36;
      [(CAMViewfinderViewController *)self setDockKitController:v28];
    }

    goto LABEL_20;
  }

LABEL_21:
}

- (void)_setOutOfDiskSpace:(BOOL)a3
{
  if (self->__outOfDiskSpace != a3)
  {
    v4 = a3;
    self->__outOfDiskSpace = a3;
    if (a3)
    {
      v6 = @"Out of disk space";
    }

    else
    {
      v6 = @"No longer out of disk space";
    }

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v6];
    v8 = [(CAMViewfinderViewController *)self _closedViewfinderController];
    v7 = [(CAMViewfinderViewController *)self _disabledPreviewController];
    if (v4)
    {
      [v8 addClosedViewfinderReason:6];
      [v7 addDisabledPreviewReason:0];
    }

    else
    {
      [v8 removeClosedViewfinderReason:6];
      [v7 removeDisabledPreviewReason:0];
    }
  }
}

- (void)_configureSwipeToModeSwitchGestureRecognizersDirection
{
  v3 = [(CAMViewfinderViewController *)self _layoutStyle];
  [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer setDirection:[(CAMViewfinderViewController *)self _previousModeSwipeDirectionForLayoutStyle:v3]];
  v4 = [(CAMViewfinderViewController *)self _nextModeSwitchDirectionForLayoutStyle:v3];
  nextModeGestureRecognizer = self->__nextModeGestureRecognizer;

  [(UISwipeGestureRecognizer *)nextModeGestureRecognizer setDirection:v4];
}

- (BOOL)_shouldCreateAndEmbedControl:(int64_t)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 wantsFullscreenViewfinder];

  LOBYTE(v6) = 0;
  if (a3 <= 0x18 && (v5 & 1) == 0)
  {
    v6 = 0x143CEA4u >> a3;
  }

  return v6 & 1;
}

- (void)_createOrDestroySharedLibraryControlsIfNecessary
{
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryBadgeIfNecessary];
  v4 = [(CAMViewfinderViewController *)self _remoteShutterController];
  v3 = +[CAMUserPreferences preferences];
  [v4 setSharedLibrarySupported:{objc_msgSend(v3, "sharedLibrarySwitchEnabled")}];
}

- (void)_createModeSpecificControlsForConfiguration:(id)a3
{
  v6 = a3;
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v6])
    {
      [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
    }

    if ([(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:v6]&& ![CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
    {
      [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
    }

    [(CAMViewfinderViewController *)self _createOrDestroyLevelViewModelIfNecessary];
    [(CAMViewfinderViewController *)self _createGridViewIfNecessary];
    [(CAMViewfinderViewController *)self _createOrDestroyLevelViewIfNecessary];
    [(CAMViewfinderViewController *)self _createOrDestroyHorizonLevelViewIfNecessary];
    v4 = [v6 mode];
    if (v4 <= 3)
    {
      if ((v4 - 1) >= 2)
      {
        if (v4)
        {
          if (v4 == 3)
          {
            [(CAMViewfinderViewController *)self _createPanoramaControlsIfNecessary];
          }

          goto LABEL_21;
        }

        goto LABEL_20;
      }
    }

    else
    {
      if (v4 <= 7)
      {
        if ((v4 - 6) < 2)
        {
          [(CAMViewfinderViewController *)self _createPortraitModeControlsIfNecessary];
LABEL_21:
          v5 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:v6];
          [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Controls created"];
          goto LABEL_22;
        }

        if (v4 != 4)
        {
          goto LABEL_21;
        }

LABEL_20:
        [(CAMViewfinderViewController *)self _createStillImageControlsIfNecessary];
        goto LABEL_21;
      }

      if (v4 != 8)
      {
        if (v4 != 9)
        {
          goto LABEL_21;
        }

        goto LABEL_20;
      }
    }

    [(CAMViewfinderViewController *)self _createVideoControlsIfNecessary];
    goto LABEL_21;
  }

LABEL_22:
}

- (void)_createPortraitModeControlsIfNecessary
{
  v5 = +[CAMCaptureCapabilities capabilities];
  [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createTimerIndicatorViewIfNecessary];
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {
    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  if ([v5 isLivePhotoSupported])
  {
    [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
    [(CAMViewfinderViewController *)self _createLivePhotoBadgeIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createPortraitModeInstructionLabelIfNecessary];
  if ([v5 arePortraitEffectsSupported])
  {
    [(CAMViewfinderViewController *)self _createLightingControlIfNecessary];
    [(CAMViewfinderViewController *)self _createLightingNameBadgeIfNecessary];
  }

  else
  {
    [(CAMViewfinderViewController *)self _createShallowDepthOfFieldBadgeIfNecessary];
  }

  if ([v5 isDepthEffectApertureSupported])
  {
    [(CAMViewfinderViewController *)self _createApertureButtonIfNecessary];
  }

  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isPortraitEffectIntensitySupportedForLightingType:{-[CAMViewfinderViewController portraitModeLightingEffectType](self, "portraitModeLightingEffectType")}];

  if (v4)
  {
    [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
  }
}

- (void)_createVideoControlsIfNecessary
{
  [(CAMViewfinderViewController *)self _createElapsedTimeViewIfNecessary];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isStillDuringVideoSupported];

  if (v4)
  {
    [(CAMViewfinderViewController *)self _createStillDuringVideoButtonIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createVideoConfigurationStatusIndicatorIfNecessary];
}

- (void)_createPanoramaControlsIfNecessary
{
  v3 = +[CAMCaptureCapabilities capabilities];
  if (([v3 isBackPanoramaSupported] & 1) != 0 || objc_msgSend(v3, "isFrontPanoramaSupported"))
  {
    [(CAMViewfinderViewController *)self _createPanoramaViewControllerIfNecessary];
  }
}

- (void)_createApertureButtonIfNecessary
{
  if (!self->__apertureButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:0])
  {
    v3 = objc_alloc(MEMORY[0x1E6993818]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    apertureButton = self->__apertureButton;
    self->__apertureButton = v4;

    [(CEKApertureButton *)self->__apertureButton addTarget:self action:sel__handleApertureButtonTapped_ forControlEvents:64];
    [(CEKApertureButton *)self->__apertureButton setExclusiveTouch:1];
    v6 = [(CAMViewfinderViewController *)self _layoutStyle];
    [(CEKApertureButton *)self->__apertureButton setWantsBackground:v6 == 1];
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v8];
    [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v7 zoomFactor:0 animated:?];

    [(CAMViewfinderViewController *)self _embedApertureButtonWithLayoutStyle:v6];
  }
}

- (void)_createIntensityButtonIfNecessary
{
  if (!self->__intensityButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:8])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMIntensityButton alloc] initWithLayoutStyle:v3];
    intensityButton = self->__intensityButton;
    self->__intensityButton = v4;

    [(CAMIntensityButton *)self->__intensityButton addTarget:self action:sel__handleIntensityButtonTapped_ forControlEvents:64];
    [(CAMIntensityButton *)self->__intensityButton setExclusiveTouch:1];
    [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];

    [(CAMViewfinderViewController *)self _embedIntensityButtonWithLayoutStyle:v3];
  }
}

- (UIControl)_primaryShutterControl
{
  v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v4 = v3;
  if (v3)
  {
    v5 = v3;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _shutterButton];
  }

  v6 = v5;

  return v6;
}

- (void)_updateShutterEffectsEnablementForSystemPressureState
{
  v6 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v6 currentCameraSystemPressureState];
  v4 = [v3 shouldDisableOptionalUIEffects];
  v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v5 setDisableOptionalUIEffects:v4];
}

- (void)_createStillDuringVideoButtonIfNecessary
{
  if (!self->__stillDuringVideoButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:20])
  {
    v3 = [CUShutterButton smallShutterButtonWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    stillDuringVideoButton = self->__stillDuringVideoButton;
    self->__stillDuringVideoButton = v3;

    [(CUShutterButton *)self->__stillDuringVideoButton addTarget:self action:sel__handleStillDuringVideoButtonPressed_ forControlEvents:1];
    [(CUShutterButton *)self->__stillDuringVideoButton addTarget:self action:sel__handleStillDuringVideoButtonReleased_ forControlEvents:96];
    [(CUShutterButton *)self->__stillDuringVideoButton setMode:0];
    [(CUShutterButton *)self->__stillDuringVideoButton setExclusiveTouch:1];

    [(CAMViewfinderViewController *)self _embedStillDuringVideoButton];
  }
}

- (void)_createElapsedTimeViewIfNecessary
{
  if (!self->__elapsedTimeView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:2])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMElapsedTimeView alloc] initWithLayoutStyle:v3];
    elapsedTimeView = self->__elapsedTimeView;
    self->__elapsedTimeView = v4;

    [(CAMViewfinderViewController *)self _embedElapsedTimeViewWithLayoutStyle:v3];
  }
}

- (CAMElapsedTimeView)_targetElapsedTimeView
{
  v3 = [(CAMViewfinderViewController *)self _elapsedTimeView];
  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v3 = [v4 elapsedTimeView];
  }

  return v3;
}

- (void)_destroyHDRButtonIfNecessary
{
  if (self->__HDRButton)
  {
    v5 = [(CAMViewfinderViewController *)self _bottomBar];
    v3 = [(CAMViewfinderViewController *)self _topBar];
    [v3 setHDRButton:0];
    [v5 setHDRButton:0];
    HDRButton = self->__HDRButton;
    self->__HDRButton = 0;

    [v3 configureForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];
  }
}

- (void)_createOrDestroyHDRButtonIfNecessary
{
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {

    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  else
  {

    [(CAMViewfinderViewController *)self _destroyHDRButtonIfNecessary];
  }
}

- (void)_createLivePhotoButtonIfNecessary
{
  if (!self->__livePhotoButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:12])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = +[CAMCaptureCapabilities capabilities];
    v5 = [v4 isLivePhotoAutoModeSupported];

    v6 = [[CAMLivePhotoButton alloc] initWithLayoutStyle:v3];
    livePhotoButton = self->__livePhotoButton;
    self->__livePhotoButton = v6;

    [(CAMLivePhotoButton *)self->__livePhotoButton setExclusiveTouch:1];
    [(CAMLivePhotoButton *)self->__livePhotoButton addTarget:self action:sel__handleLivePhotoButtonChangedLivePhotoMode forControlEvents:4096];
    [(CAMLivePhotoButton *)self->__livePhotoButton setAllowsAutomaticMode:v5 needsReloadData:0];
    [(CAMLivePhotoButton *)self->__livePhotoButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedLivePhotoButtonWithLayoutStyle:v3];
  }
}

- (void)_createLivePhotoBadgeIfNecessary
{
  if (!self->__livePhotoBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:11])
  {
    v3 = [CAMLivePhotoBadge alloc];
    v4 = [(CAMLivePhotoBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    livePhotoBadge = self->__livePhotoBadge;
    self->__livePhotoBadge = v4;
  }

  [(CAMViewfinderViewController *)self _embedLivePhotoBadge];
}

- (void)_createOrDestroySharedLibraryButtonIfNecessary
{
  v3 = [(CAMViewfinderViewController *)self _layoutStyle];
  v4 = +[CAMUserPreferences preferences];
  if ([v4 sharedLibrarySwitchEnabled])
  {
    v5 = [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:18];

    if (v5)
    {
      if (self->__sharedLibraryButton)
      {
        return;
      }

      v6 = [[CAMSharedLibraryButton alloc] initWithLayoutStyle:v3];
      sharedLibraryButton = self->__sharedLibraryButton;
      self->__sharedLibraryButton = v6;

      [(CAMSharedLibraryButton *)self->__sharedLibraryButton setExclusiveTouch:1];
      [(CAMSharedLibraryButton *)self->__sharedLibraryButton addTarget:self action:sel__handleSharedLibraryButton forControlEvents:4096];
      [(CAMExpandableMenuButton *)self->__sharedLibraryButton reloadData];
      v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v9 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:v8];

      [(CAMSharedLibraryButton *)self->__sharedLibraryButton setAlpha:v9];
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      goto LABEL_8;
    }
  }

  else
  {
  }

  v10 = self->__sharedLibraryButton;
  if (!v10)
  {
    return;
  }

  self->__sharedLibraryButton = 0;

LABEL_8:

  [(CAMViewfinderViewController *)self _updateSharedLibraryButtonOnSubviewsForLayoutStyle:v3];
}

- (void)_createOrDestroySharedLibraryBadgeIfNecessary
{
  v3 = +[CAMUserPreferences preferences];
  if ([v3 sharedLibrarySwitchEnabled])
  {
    v4 = [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:17];

    if (v4)
    {
      if (self->__sharedLibraryBadge)
      {
        return;
      }

      v5 = objc_alloc_init(CAMSharedLibraryBadge);
      sharedLibraryBadge = self->__sharedLibraryBadge;
      self->__sharedLibraryBadge = v5;

      v7 = [(CAMViewfinderViewController *)self _librarySelectionController];
      -[CAMSharedLibraryBadge setSharedLibraryMode:](self->__sharedLibraryBadge, "setSharedLibraryMode:", [v7 sharedLibraryMode]);
      goto LABEL_8;
    }
  }

  else
  {
  }

  v7 = self->__sharedLibraryBadge;
  if (!v7)
  {
    return;
  }

  self->__sharedLibraryBadge = 0;
LABEL_8:

  [(CAMViewfinderViewController *)self _embedSharedLibraryBadge];
}

- (void)_createShallowDepthOfFieldBadgeIfNecessary
{
  if (!self->__shallowDepthOfFieldBadge)
  {
    v3 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    v4 = [CAMShallowDepthOfFieldBadge alloc];
    v5 = [(CAMShallowDepthOfFieldBadge *)v4 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    shallowDepthOfFieldBadge = self->__shallowDepthOfFieldBadge;
    self->__shallowDepthOfFieldBadge = v5;

    [(CAMShallowDepthOfFieldBadge *)self->__shallowDepthOfFieldBadge setShallowDepthOfFieldStatus:v3];

    [(CAMViewfinderViewController *)self _embedShallowDepthOfFieldBadge];
  }
}

- (void)_createPortraitModeInstructionLabelIfNecessary
{
  if (!self->__portraitModeInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:14])
  {
    v3 = [CAMPortraitModeInstructionLabel alloc];
    v4 = [(CAMInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    portraitModeInstructionLabel = self->__portraitModeInstructionLabel;
    self->__portraitModeInstructionLabel = v4;

    [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedPortraitModeInstructionLabel];
  }
}

- (void)_createCleanLensesInstructionLabelIfNecessary
{
  if (!self->__cleanLensesInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:15])
  {
    v3 = [CAMCleanLensesInstructionLabel alloc];
    v4 = [(CAMCleanLensesInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    cleanLensesInstructionLabel = self->__cleanLensesInstructionLabel;
    self->__cleanLensesInstructionLabel = v4;

    [(CAMCleanLensesInstructionLabel *)self->__cleanLensesInstructionLabel labelWasTappedWithTarget:self andAction:sel__handleCleanLensesInstructionLabelTapped_];
    [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedCleanLensesInstructionLabel];
  }
}

- (void)fullscreenViewfinderDidFinishChangingPreviewGeometry:(id)a3
{
  if ([(CAMViewfinderViewController *)self _delaySmartFramingDynamicAspectRatioUpdate])
  {
    [(CAMViewfinderViewController *)self set_delaySmartFramingDynamicAspectRatioUpdate:0];

    [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:0 zoomRampTuning:0.0];
  }
}

- (void)fullscreenViewfinderDidCreateControlDrawer:(id)a3
{
  v4 = [a3 controlDrawer];
  [v4 setDelegate:self];

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:0];
}

- (void)fullScreenViewfinderDidCreateFlipAspectRatioButton:(id)a3
{
  v4 = [a3 flipAspectRatioButton];
  [v4 addTarget:self action:sel__handleFlipAspectRatioButtonTapped_ forControlEvents:64];
}

- (void)fullscreenViewfinderDidCreatePortraitControls:(id)a3
{
  v4 = [a3 lightingControl];
  [v4 setDelegate:self];

  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:v5 animated:0];

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:v6 animated:0];

  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
}

- (void)fullscreenViewfinderDidChangeSemanticStyle:(id)a3
{
  v4 = [a3 semanticStylePicker];
  -[CAMViewfinderViewController _setSelectedSemanticStyleIndex:](self, "_setSelectedSemanticStyleIndex:", [v4 selectedStyleIndex]);

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  v5 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [v5 didChangeValueForControlType:10];
}

- (void)_updateSelectedSmartStyleFromPicker
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)fullscreenViewfinder:(id)a3 didChangeControlDrawerVisibility:(BOOL)a4 animated:(BOOL)a5 forReason:(int64_t)a6
{
  v7 = a5;
  if (a4)
  {
    [(CAMViewfinderViewController *)self _dismissOverlays];
    v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v10 = [v9 controlStatusBar];
    [v10 collapseExpandedIndicatorAnimated:v7];

    v11 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];

    if (!v11)
    {
      v12 = [[CAMAnalyticsControlDrawerEvent alloc] initWithReason:a6 captureMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
      [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:v12];
    }

    v13 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [v13 didPresentControlDrawerForReason:a6];
  }

  else
  {
    v14 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [v14 dismissedControlDrawerWithReason:a6];

    [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:0];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v7];
}

- (void)fullscreenViewFinder:(id)a3 willPresentControlDrawerModallyForControlType:(int64_t)a4 reason:(int64_t)a5
{
  v8 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];

  if (!v8)
  {
    v9 = [[CAMAnalyticsControlDrawerEvent alloc] initWithReason:a5 captureMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
    [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:v9];

    v10 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [v10 setOpeningControlType:a4];
  }
}

- (void)fullscreenViewFinder:(id)a3 willDismissControlDrawerModallyForControlType:(int64_t)a4 reason:(int64_t)a5
{
  v6 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent:a3];
  [v6 setDismissingControlType:a4];
}

- (void)fullscreenViewfinder:(id)a3 didCreateInstructionLabel:(int64_t)a4
{
  v6 = a3;
  v16 = v6;
  if (a4 <= 4)
  {
    if (a4 > 2)
    {
      if (a4 == 3)
      {
        [(CAMViewfinderViewController *)self _beginNightModeInstructionLabelCountDown];
      }

      else
      {
        v8 = [(CAMViewfinderViewController *)self _captureController];
        v9 = [v8 flashCompromise];
        v10 = [v16 flashCompromisedInstructionLabel];
        [v10 setCompromise:v9];
      }
    }

    else if (a4 == 1)
    {
      [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
    }

    else
    {
      if (a4 != 2)
      {
        goto LABEL_22;
      }

      [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
    }
  }

  else if (a4 <= 7)
  {
    if (a4 == 5)
    {
      [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
    }

    else
    {
      if (a4 != 6)
      {
        goto LABEL_22;
      }

      v11 = [objc_alloc(MEMORY[0x1E69DD060]) initWithTarget:self action:sel__handleFreeResourcesLabelTapped_];
      v12 = [v16 freeResourcesInstructionLabel];
      [v12 addGestureRecognizer:v11];

      [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
    }
  }

  else
  {
    switch(a4)
    {
      case 8:
        v13 = [(CAMViewfinderViewController *)self _currentMode]== 9;
        v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        [v14 setStereoCaptureStatus:-[CAMViewfinderViewController _stereoCaptureStatus](self useHoldStillStereoLowLightInstruction:"_stereoCaptureStatus") animated:{v13, 1}];

        break;
      case 9:
        v15 = [v6 smartStyleCategoryInstructionLabel];
        [v15 setStyle:2];

        [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
        break;
      case 10:
        v7 = [v6 cleanLensesInstructionLabel];
        [v7 labelWasTappedWithTarget:self andAction:sel__handleCleanLensesInstructionLabelTapped_];

        [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
        break;
      default:
        goto LABEL_22;
    }
  }

  v6 = v16;
LABEL_22:
}

- (void)fullscreenViewfinder:(id)a3 didChangeExpanded:(BOOL)a4 forDrawerControlOfType:(int64_t)a5 animated:(BOOL)a6 updatePreferredDrawerControl:(BOOL)a7
{
  v7 = a7;
  v8 = a6;
  v10 = a4;
  v15 = a3;
  if (a5 > 7)
  {
    switch(a5)
    {
      case 8:
        [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
        v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v13 animated:v8];

        v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v12 animated:v8];
        break;
      case 10:
        [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
        v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v14 animated:v8];

        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v8];
        [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
        [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Expanding SemanticStyles control"];
        [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:v8];
        if (!v7)
        {
          goto LABEL_22;
        }

        goto LABEL_19;
      case 11:
        [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
        v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v12 animated:v8];
        break;
      default:
        goto LABEL_18;
    }

    goto LABEL_17;
  }

  switch(a5)
  {
    case 4:
      if (!v10 && [(CAMViewfinderViewController *)self _wantsFilterScrubberVisible])
      {
        [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0 animated:v8];
        if (!v7)
        {
          goto LABEL_22;
        }

        goto LABEL_19;
      }

      break;
    case 6:
      v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v12 zoomFactor:v8 animated:?];
LABEL_17:

      break;
    case 7:
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      if (!v7)
      {
        goto LABEL_22;
      }

      goto LABEL_19;
  }

LABEL_18:
  if (!v7)
  {
    goto LABEL_22;
  }

LABEL_19:
  if (!v10)
  {
    a5 = -1;
  }

  [(CAMViewfinderViewController *)self _setPreferredControlToOpenInDrawer:a5 forMode:[(CAMViewfinderViewController *)self _currentMode]];
LABEL_22:
}

- (int64_t)expandedControlTypeForExpandingDrawerInFullscreenViewfinder:(id)a3
{
  v4 = +[CAMUserPreferences preferences];
  v5 = [v4 preservePreferredDrawerControl];

  result = -1;
  if (v5)
  {
    result = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode:[(CAMViewfinderViewController *)self _currentMode]];
  }

  if (result == 11)
  {
    v7 = [(CAMViewfinderViewController *)self _controlDrawer];
    v8 = [v7 smartStyleButton];
    v9 = [v8 showDisabled];

    result = -1;
    if (!v9)
    {
      return 11;
    }
  }

  if (result == 4)
  {
    [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:1 animated:1];
    return 4;
  }

  return result;
}

- (BOOL)fullscreenViewfinderCanUpdatePreviewSemanticStyles:(id)a3
{
  if ([(CAMViewfinderViewController *)self _isReconfiguring]|| [(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self _completedInitialConfiguration];
}

- (void)fullscreenViewfinderDidCreateSpotlightControlPanel:(id)a3
{
  v18 = *MEMORY[0x1E69E9840];
  v4 = [a3 spotlightControlPanel];
  [v4 setDelegate:self];
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 openHalfPressSpotlightControls];

  v7 = [v6 mutableCopy];
  [(CAMViewfinderViewController *)self _setOpenHalfPressSpotlightControls:v7];

  v15 = 0u;
  v16 = 0u;
  v13 = 0u;
  v14 = 0u;
  v8 = v6;
  v9 = [v8 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v14;
    do
    {
      v12 = 0;
      do
      {
        if (*v14 != v11)
        {
          objc_enumerationMutation(v8);
        }

        [v4 setControlType:objc_msgSend(*(*(&v13 + 1) + 8 * v12++) open:"integerValue" animated:{v13), 1, 0}];
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v10);
  }
}

- (void)fullscreenViewfinderDidCreateSmartStyleControls:(id)a3
{
  v4 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__handleSmartStylePickerSwipe_];
  smartStylesSwipeLeftGestureRecognizer = self->__smartStylesSwipeLeftGestureRecognizer;
  self->__smartStylesSwipeLeftGestureRecognizer = v4;

  v6 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__handleSmartStylePickerSwipe_];
  smartStylesSwipeRightGestureRecognizer = self->__smartStylesSwipeRightGestureRecognizer;
  self->__smartStylesSwipeRightGestureRecognizer = v6;

  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setDelegate:self];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setDelegate:self];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setDirection:2];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setDirection:1];
  v8 = [(CAMViewfinderViewController *)self view];
  [v8 addGestureRecognizer:self->__smartStylesSwipeLeftGestureRecognizer];

  v9 = [(CAMViewfinderViewController *)self view];
  [v9 addGestureRecognizer:self->__smartStylesSwipeRightGestureRecognizer];

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
}

- (void)addChildViewController:(id)a3 toView:(id)a4
{
  v6 = a4;
  v8 = a3;
  [(CAMViewfinderViewController *)self addChildViewController:v8];
  v7 = [v8 view];
  [v6 addSubview:v7];

  [v8 didMoveToParentViewController:self];
}

- (void)_handleSmartStyleIntensitySliderChangedValue:(double)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (v5)
  {
    v6 = objc_alloc(MEMORY[0x1E6993890]);
    v7 = [v5 presetType];
    [v5 toneBias];
    v9 = v8;
    [v5 colorBias];
    v11 = [v6 initWithPresetType:v7 castIntensity:a3 toneBias:v9 colorBias:v10];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v11 animateSliders:0];
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)handleSmartStylePadValueChanged:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  v6 = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (v6)
  {
    [CAMSmartStyleUtilities colorAndToneBiasForSlider2DValue:0 limitRangeForSystemStyles:x, y];
    v7 = objc_alloc(MEMORY[0x1E6993890]);
    v8 = [v6 presetType];
    [v6 castIntensity];
    v9 = [v7 initWithPresetType:v8 castIntensity:? toneBias:? colorBias:?];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v9 animateSliders:0];
  }

  else
  {
    v10 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)_updateSelectedSmartStyle:(id)a3 animateSliders:(BOOL)a4
{
  v4 = a4;
  v14 = a3;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 8) != 0)
  {
    v11 = [(CAMViewfinderViewController *)self _semanticStyles];
    v12 = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    goto LABEL_6;
  }

  if (v7)
  {
    v8 = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    v9 = [(CAMViewfinderViewController *)self _semanticStyles];
    v10 = [v9 count];

    if (v8 < v10)
    {
      v11 = [(CAMViewfinderViewController *)self _semanticStyles];
      v12 = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
LABEL_6:
      [v11 setObject:v14 atIndexedSubscript:v12];
    }
  }

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:v4 animateOtherControls:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  v13 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [v13 didChangeValueForControlType:11];
}

- (void)_handleSmartStyleResetButton
{
  v3 = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _referenceStyleForSmartStyle:v3];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v4 animateSliders:1];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)_handleSmartStyleShutterButtonPressed:(id)a3
{
  v4 = os_log_create("com.apple.camera", "SmartStyle");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: SmartStyle shutter button pressed", v6, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if ([v5 isEnabled])
  {
    [(CAMViewfinderViewController *)self dynamicShutterControlGesturesDidBegin:v5];
    [(CAMViewfinderViewController *)self dynamicShutterControlDidShortPress:v5];
  }

  else
  {
    [(CAMViewfinderViewController *)self shutterControlTouchAttemptedWhileDisabled:v5];
  }
}

- (void)_handleSmartStyleShutterButtonReleased:(id)a3
{
  v4 = os_log_create("com.apple.camera", "SmartStyle");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: SmartStyle shutter button released", v6, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if ([v5 isEnabled])
  {
    [(CAMViewfinderViewController *)self dynamicShutterControlGesturesDidEnd:v5];
  }
}

- (void)fullscreenViewfinder:(id)a3 didChangeSmartStyleControlsVisibility:(BOOL)a4 animated:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v15 = a3;
  if (!v6)
  {
    if (![(CAMViewfinderViewController *)self _useMessagesControls])
    {
      goto LABEL_10;
    }

    v12 = [v15 controlStatusBar];
    v13 = [v12 secondaryAccessoryControl];

    if (v13)
    {
      goto LABEL_10;
    }

LABEL_9:
    v14 = [v15 controlStatusBar];
    [v14 setSecondaryAccessoryControl:0 animated:v5];

    goto LABEL_10;
  }

  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v8];

  if (v9)
  {
    [(CAMViewfinderViewController *)self _resetPortraitLightingToDefaultAnimated:v5];
  }

  if ([(CAMViewfinderViewController *)self _useMessagesControls])
  {
    v10 = [v15 controlStatusBar];
    v11 = [v10 secondaryAccessoryControl];

    if (v11)
    {
      goto LABEL_9;
    }
  }

LABEL_10:
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v5];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"SmartStyles control visibility changed"];
  [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:v5];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:v5];
}

- (void)spotlightControlPanelDidCreateApertureSlider:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v4 zoomFactor:?];
}

- (void)spotlightControlPanel:(id)a3 didChangeValueForSpotlight:(int64_t)a4
{
  v6 = a3;
  if (a4 == 2)
  {
    v8 = v6;
    v7 = [v6 exposureSlider];
    [(CAMViewfinderViewController *)self _handleExposureSliderDidChangeValue:v7];
  }

  else
  {
    if (a4 != 3)
    {
      goto LABEL_6;
    }

    v8 = v6;
    v7 = [v6 apertureSlider];
    [(CAMViewfinderViewController *)self _apertureSliderDidChangeApertureValue:v7];
  }

  v6 = v8;
LABEL_6:
}

- (void)spotlightControlPanel:(id)a3 didChangeOpenForSpotlight:(int64_t)a4
{
  v6 = [a3 isControlTypeOpen:a4];
  v8 = [(CAMViewfinderViewController *)self _openHalfPressSpotlightControls];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
  if (v6)
  {
    [v8 addObject:v7];
  }

  else
  {
    [v8 removeObject:v7];
  }
}

- (CAMPortraitModeInstructionLabel)_targetPortraitModeInstructionLabel
{
  v3 = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v3 = [v4 portraitInstructionLabel];
  }

  return v3;
}

- (CAMQRCodeInstructionLabel)_targetQRCodeInstructionLabel
{
  v3 = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v3 = [v4 qrCodeInstructionLabel];
  }

  return v3;
}

- (void)_updateCleanLensesInstructionLabelForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v4 = [(CAMViewfinderViewController *)self _cleanLensesInstructionLabel];
  [v4 setDevicePosition:v3];

  v5 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [v7 cleanLensesInstructionLabel];
  [v6 setDevicePosition:v5];
}

- (void)_createPanoramaViewControllerIfNecessary
{
  if (!self->__panoramaViewController)
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [(CAMViewfinderViewController *)self _captureController];
    v5 = [[CAMPanoramaViewController alloc] initWithCaptureController:v4 layoutStyle:v3];
    panoramaViewController = self->__panoramaViewController;
    self->__panoramaViewController = v5;

    [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
    [(CAMViewfinderViewController *)self addChildViewController:self->__panoramaViewController];
    [(CAMViewfinderViewController *)self _embedPanoramaView];
  }

  v7 = [(CAMViewfinderViewController *)self _panoramaViewController];
  v9 = [v7 view];

  v8 = [(CAMViewfinderViewController *)self _dockKitController];
  [v9 setDockKitController:v8];
}

- (void)_createZoomSliderIfNecessary
{
  if (!self->__zoomSlider)
  {
    v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v4 = [(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:v3];

    if (v4)
    {
      v5 = [[CAMZoomSlider alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
      zoomSlider = self->__zoomSlider;
      self->__zoomSlider = v5;

      [(CAMZoomSlider *)self->__zoomSlider setExclusiveTouch:1];
      [(CAMZoomSlider *)self->__zoomSlider setMinimumValue:0.0];
      LODWORD(v7) = 1.0;
      [(CAMZoomSlider *)self->__zoomSlider setMaximumValue:v7];
      [(CAMZoomSlider *)self->__zoomSlider addTarget:self action:sel__handleTouchDownForZoomSlider_ forControlEvents:1];
      [(CAMZoomSlider *)self->__zoomSlider addTarget:self action:sel__zoomSliderValueDidChange_forEvent_ forControlEvents:4096];
      [(CAMZoomSlider *)self->__zoomSlider setDelegate:self];
      [(CAMZoomSlider *)self->__zoomSlider setAlpha:0.0];
      [(CAMZoomSlider *)self->__zoomSlider setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomSlider]];
      [(CAMViewfinderViewController *)self _embedZoomSlider];

      [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
    }
  }
}

- (void)_createZoomControlIfNecessary
{
  if (!self->__zoomControl)
  {
    if ([(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:24])
    {
      v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v4 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v3];

      if (v4)
      {
        v5 = [[CAMZoomControl alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
        zoomControl = self->__zoomControl;
        self->__zoomControl = v5;

        [(CAMZoomControl *)self->__zoomControl setDelegate:self];
        [(CAMZoomControl *)self->__zoomControl addTarget:self action:sel__handleTouchDownForZoomControl_ forControlEvents:1];
        v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v7 animated:0];

        [(CAMZoomControl *)self->__zoomControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomControl]];
        [(CAMViewfinderViewController *)self _embedZoomControl];

        [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
      }
    }
  }
}

- (void)_createOrDestroyLevelViewModelIfNecessary
{
  v11 = +[CAMUserPreferences preferences];
  v3 = [v11 shouldShowHorizonLevelView];
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  v5 = [v11 shouldShowLevelView];
  if (v4 == 8)
  {
    v6 = 1;
  }

  else
  {
    v6 = v3;
  }

  v7 = v6 | v5;
  v8 = [(CAMViewfinderViewController *)self _levelViewModel];

  if ((v7 & 1) == 0 || v8)
  {
    if (v7 & 1 | (v8 == 0))
    {
      goto LABEL_10;
    }

    v9 = 0;
  }

  else
  {
    v9 = objc_alloc_init(CAMLevelViewModel);
  }

  levelViewModel = self->__levelViewModel;
  self->__levelViewModel = v9;

LABEL_10:
}

- (void)_createLevelViewIfNecessary
{
  if (!self->__levelView)
  {
    v3 = [[CAMLevelIndicatorView alloc] initWithViewModel:self->__levelViewModel];
    levelView = self->__levelView;
    self->__levelView = v3;

    [(CAMViewfinderViewController *)self _embedLevelView];
  }
}

- (void)_createHorizonLevelViewIfNecessary
{
  if (!self->__horizonLevelView)
  {
    v3 = [[CAMHorizonLevelView alloc] initWithViewModel:self->__levelViewModel];
    horizonLevelView = self->__horizonLevelView;
    self->__horizonLevelView = v3;

    [(CAMHorizonLevelView *)self->__horizonLevelView setDelegate:self];

    [(CAMViewfinderViewController *)self _embedHorizonLevelView];
  }
}

- (void)_destroyHorizonLevelViewIfNecessary
{
  if (self->__horizonLevelView)
  {
    [(CAMViewfinderViewController *)self _unembedHorizonLevelView];
    horizonLevelView = self->__horizonLevelView;
    self->__horizonLevelView = 0;
  }
}

- (void)_createVideoConfigurationStatusIndicatorIfNecessary
{
  if (!self->__videoConfigurationStatusIndicator && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:23])
  {
    v3 = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMVideoConfigurationStatusIndicator alloc] initWithLayoutStyle:v3];
    videoConfigurationStatusIndicator = self->__videoConfigurationStatusIndicator;
    self->__videoConfigurationStatusIndicator = v4;

    [(CAMVideoConfigurationStatusIndicator *)self->__videoConfigurationStatusIndicator setTouchDelegate:self];
    v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v8 animated:0];
    [(CAMViewfinderViewController *)self _embedVideoConfigurationStatusIndicatorWithLayoutStyle:v3];
    if ([(CAMViewfinderViewController *)self _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:v8])
    {
      v6 = 0.0;
    }

    else
    {
      v6 = 1.0;
    }

    v7 = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
    [v7 setAlpha:v6];
  }
}

- (CAMVideoConfigurationStatusIndicator)_targetVideoConfigurationStatusIndicator
{
  v3 = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v5 = [v4 controlStatusBar];
    v3 = [v5 videoConfigurationIndicator];
  }

  return v3;
}

- (void)_createUtilityBarIfNecessary
{
  if (!self->__utilityBar)
  {
    v3 = [CAMUtilityBar alloc];
    v4 = [(CAMUtilityBar *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    utilityBar = self->__utilityBar;
    self->__utilityBar = v4;

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v7 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v6];

    [(CAMUtilityBar *)self->__utilityBar setAlpha:!v7];

    [(CAMViewfinderViewController *)self _embedUtilityBar];
  }
}

- (void)_createFilterNameBadgeIfNecessary
{
  if (!self->__filterNameBadge)
  {
    v3 = [CAMFilterNameBadge alloc];
    v4 = [(CAMFilterNameBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    filterNameBadge = self->__filterNameBadge;
    self->__filterNameBadge = v4;

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v7 = [(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:v6];

    [(CAMFilterNameBadge *)self->__filterNameBadge setAlpha:!v7];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:0];

    [(CAMViewfinderViewController *)self _embedFilterNameBadge];
  }
}

- (void)_createPortraitApertureSliderIfNecessary
{
  [(CAMViewfinderViewController *)self _createUtilityBarIfNecessary];
  if (!self->__portraitApertureSlider)
  {
    v3 = objc_alloc_init(MEMORY[0x1E6993820]);
    portraitApertureSlider = self->__portraitApertureSlider;
    self->__portraitApertureSlider = v3;

    [(CEKApertureSlider *)self->__portraitApertureSlider addTarget:self action:sel__apertureSliderDidChangeApertureValue_ forControlEvents:4096];

    [(CAMViewfinderViewController *)self _embedPortraitApertureSlider];
  }
}

- (void)_createPortraitIntensitySliderIfNecessary
{
  [(CAMViewfinderViewController *)self _createUtilityBarIfNecessary];
  if (!self->__portraitIntensitySlider)
  {
    v7 = CAMLocalizedFrameworkString(@"PORTRAIT_INTENSITY_SLIDER_TITLE", 0);
    v3 = [objc_alloc(MEMORY[0x1E6993888]) initWithTitle:v7];
    portraitIntensitySlider = self->__portraitIntensitySlider;
    self->__portraitIntensitySlider = v3;

    [(CEKSlider *)self->__portraitIntensitySlider setSliderVerticalAlignment:2];
    v5 = self->__portraitIntensitySlider;
    v6 = [MEMORY[0x1E69DC888] blackColor];
    [(CEKSlider *)v5 setOpaqueGradientsWithColor:v6];

    [(CEKSlider *)self->__portraitIntensitySlider setTitleAlignment:0];
    [(CEKSlider *)self->__portraitIntensitySlider setValueLabelVisibility:2];
    [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
    [(CEKSlider *)self->__portraitIntensitySlider addTarget:self action:sel__handleIntensitySliderDidChangeValue_ forControlEvents:4096];
    [(CAMViewfinderViewController *)self _embedPortraitIntensitySlider];
  }
}

- (void)_createLightingControlIfNecessary
{
  if (!self->__lightingControl && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:9])
  {
    v3 = objc_alloc(MEMORY[0x1E6993868]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    lightingControl = self->__lightingControl;
    self->__lightingControl = v4;

    [(CEKLightingControl *)self->__lightingControl setDelegate:self];
    [(CEKLightingControl *)self->__lightingControl preloadEffectChangeAnimation];

    [(CAMViewfinderViewController *)self _embedLightingControl];
  }
}

- (void)_createLightingNameBadgeIfNecessary
{
  if (!self->__lightingNameBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:10])
  {
    v3 = objc_alloc(MEMORY[0x1E6993878]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    lightingNameBadge = self->__lightingNameBadge;
    self->__lightingNameBadge = v4;

    [(CAMViewfinderViewController *)self _embedLightingNameBadge];
  }
}

- (void)_unembedAndDestroyAllControls
{
  v31 = [(CAMViewfinderViewController *)self _topBar];
  [v31 setFlashButton:0];
  [v31 setElapsedTimeView:0];
  [v31 setHDRButton:0];
  [v31 setApertureButton:0];
  [v31 setTimerButton:0];
  [v31 setLivePhotoButton:0];
  [v31 setVideoConfigurationStatusIndicator:0];
  v3 = [(CAMViewfinderViewController *)self _utilityBar];
  [v3 setFilterScrubberView:0];
  v4 = [(CAMViewfinderViewController *)self _bottomBar];
  [v4 setShutterButton:0];
  [v4 setStillDuringVideoButton:0];
  [v4 setModeDial:0];
  [v4 setImageWell:0];
  [v4 setReviewButton:0];
  [v4 setFlipButton:0];
  [v4 setFlashButton:0];
  [v4 setHDRButton:0];
  [v4 setTimerButton:0];
  [v4 setLivePhotoButton:0];
  [v4 setUtilityBar:0];
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  [v5 setTopBar:0];
  [v5 setBottomBar:0];
  [v5 setShutterButton:0];
  [v5 setFlipButton:0];
  [v5 setFocusAndExposureLockBadge:0];
  [v5 setLivePhotoBadge:0];
  [v5 setShallowDepthOfFieldBadge:0];
  [v5 setPortraitModeInstructionLabel:0];
  [v5 setQrCodeInstructionLabel:0];
  [v5 setElapsedTimeView:0];
  [v5 setBurstIndicatorView:0];
  [v5 setTimerIndicatorView:0];
  [v5 setPanoramaView:0];
  [v5 setZoomSlider:0];
  [v5 setZoomControl:0];
  [v5 setFilterNameBadge:0];
  [v5 setChromeView:0];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v6 setChromeView:0];

  flashButton = self->__flashButton;
  self->__flashButton = 0;

  elapsedTimeView = self->__elapsedTimeView;
  self->__elapsedTimeView = 0;

  HDRButton = self->__HDRButton;
  self->__HDRButton = 0;

  apertureButton = self->__apertureButton;
  self->__apertureButton = 0;

  timerButton = self->__timerButton;
  self->__timerButton = 0;

  livePhotoButton = self->__livePhotoButton;
  self->__livePhotoButton = 0;

  sharedLibraryButton = self->__sharedLibraryButton;
  self->__sharedLibraryButton = 0;

  videoConfigurationStatusIndicator = self->__videoConfigurationStatusIndicator;
  self->__videoConfigurationStatusIndicator = 0;

  shutterButton = self->__shutterButton;
  self->__shutterButton = 0;

  stillDuringVideoButton = self->__stillDuringVideoButton;
  self->__stillDuringVideoButton = 0;

  modeDial = self->__modeDial;
  self->__modeDial = 0;

  flipButton = self->__flipButton;
  self->__flipButton = 0;

  topBar = self->__topBar;
  self->__topBar = 0;

  bottomBar = self->__bottomBar;
  self->__bottomBar = 0;

  utilityBar = self->__utilityBar;
  self->__utilityBar = 0;

  focusAndExposureLockBadge = self->__focusAndExposureLockBadge;
  self->__focusAndExposureLockBadge = 0;

  livePhotoBadge = self->__livePhotoBadge;
  self->__livePhotoBadge = 0;

  shallowDepthOfFieldBadge = self->__shallowDepthOfFieldBadge;
  self->__shallowDepthOfFieldBadge = 0;

  portraitModeInstructionLabel = self->__portraitModeInstructionLabel;
  self->__portraitModeInstructionLabel = 0;

  cleanLensesInstructionLabel = self->__cleanLensesInstructionLabel;
  self->__cleanLensesInstructionLabel = 0;

  qrCodeInstructionLabel = self->__qrCodeInstructionLabel;
  self->__qrCodeInstructionLabel = 0;

  burstIndicatorView = self->__burstIndicatorView;
  self->__burstIndicatorView = 0;

  timerIndicatorView = self->__timerIndicatorView;
  self->__timerIndicatorView = 0;

  filterNameBadge = self->__filterNameBadge;
  self->__filterNameBadge = 0;

  [(CAMViewfinderViewController *)self _destroyGridViewIfNecessary];
  [(CAMViewfinderViewController *)self _destroyLevelViewIfNecessary];
}

- (void)_destroyGestureRecognizersRequiringStandardControls
{
  v7 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _previousModeGestureRecognizer];
  [v7 removeGestureRecognizer:v3];
  previousModeGestureRecognizer = self->__previousModeGestureRecognizer;
  self->__previousModeGestureRecognizer = 0;

  v5 = [(CAMViewfinderViewController *)self _nextModeGestureRecognizer];
  [v7 removeGestureRecognizer:v5];
  nextModeGestureRecognizer = self->__nextModeGestureRecognizer;
  self->__nextModeGestureRecognizer = 0;
}

- (void)_embedAllControlsWithLayoutStyle:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _embedFlashButtonWithLayoutStyle:?];
  [(CAMViewfinderViewController *)self _embedElapsedTimeViewWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedHDRButtonWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedFocusAndExposureLockBadge];
  [(CAMViewfinderViewController *)self _embedLivePhotoButtonWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _updateSharedLibraryButtonOnSubviewsForLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedSharedLibraryBadge];
  [(CAMViewfinderViewController *)self _embedLivePhotoBadge];
  [(CAMViewfinderViewController *)self _embedShallowDepthOfFieldBadge];
  [(CAMViewfinderViewController *)self _embedPortraitModeInstructionLabel];
  [(CAMViewfinderViewController *)self _embedCleanLensesInstructionLabel];
  [(CAMViewfinderViewController *)self _embedQRCodeInstructionLabel];
  [(CAMViewfinderViewController *)self _embedFlipButtonWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedTimerButtonWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedTimerIndicatorView];
  [(CAMViewfinderViewController *)self _embedShutterButton];
  [(CAMViewfinderViewController *)self _embedStillDuringVideoButton];
  [(CAMViewfinderViewController *)self _embedModeDial];
  [(CAMViewfinderViewController *)self _embedApertureButtonWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedBurstIndicatorView];
  [(CAMViewfinderViewController *)self _embedPanoramaView];
  [(CAMViewfinderViewController *)self _embedZoomSlider];
  [(CAMViewfinderViewController *)self _embedZoomControl];
  [(CAMViewfinderViewController *)self _embedGridView];
  [(CAMViewfinderViewController *)self _embedLevelView];
  [(CAMViewfinderViewController *)self _embedVideoConfigurationStatusIndicatorWithLayoutStyle:a3];
  [(CAMViewfinderViewController *)self _embedUtilityBar];
  [(CAMViewfinderViewController *)self _embedFilterNameBadge];
  [(CAMViewfinderViewController *)self _embedLightingControl];

  [(CAMViewfinderViewController *)self _embedLightingNameBadge];
}

- (void)_embedFlashButtonWithLayoutStyle:(int64_t)a3
{
  v11 = [(CAMViewfinderViewController *)self _bottomBar];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _flashButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v8 = !v7;
  if (v7)
  {
    v9 = v5;
  }

  else
  {
    v9 = v11;
  }

  if (v8)
  {
    v10 = v5;
  }

  else
  {
    v10 = v11;
  }

  [v9 setFlashButton:0];
  [v10 setFlashButton:v6];
}

- (void)_embedElapsedTimeViewWithLayoutStyle:(int64_t)a3
{
  v11 = [(CAMViewfinderViewController *)self viewfinderView];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _elapsedTimeView];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v8 = !v7;
  if (v7)
  {
    v9 = v5;
  }

  else
  {
    v9 = v11;
  }

  if (v8)
  {
    v10 = v5;
  }

  else
  {
    v10 = v11;
  }

  [v9 setElapsedTimeView:0];
  [v10 setElapsedTimeView:v6];
}

- (void)_embedHDRButtonWithLayoutStyle:(int64_t)a3
{
  v10 = [(CAMViewfinderViewController *)self _bottomBar];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _HDRButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v5 setHDRButton:0];
    v8 = v10;
    v9 = 0;
LABEL_5:
    [v8 setHDRButton:v9];
    goto LABEL_7;
  }

  if (v7)
  {
    [v5 setHDRButton:0];
    v8 = v10;
    v9 = v6;
    goto LABEL_5;
  }

  [v10 setHDRButton:0];
  [v5 setHDRButton:v6];
  [v5 configureForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
LABEL_7:
}

- (void)_embedFocusAndExposureLockBadge
{
  v4 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  [v4 setFocusAndExposureLockBadge:v3];
}

- (void)_embedLivePhotoButtonWithLayoutStyle:(int64_t)a3
{
  v10 = [(CAMViewfinderViewController *)self _livePhotoButton];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _bottomBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v5 setLivePhotoButton:0];
    v8 = v6;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [v5 setLivePhotoButton:0];
      v8 = v6;
    }

    else
    {
      [v6 setLivePhotoButton:0];
      v8 = v5;
    }

    v9 = v10;
  }

  [v8 setLivePhotoButton:v9];
}

- (void)_updateSharedLibraryButtonOnSubviewsForLayoutStyle:(int64_t)a3
{
  v10 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _bottomBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v5 setSharedLibraryButton:0];
    v8 = v6;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [v5 setSharedLibraryButton:0];
      v8 = v6;
    }

    else
    {
      [v6 setSharedLibraryButton:0];
      v8 = v5;
    }

    v9 = v10;
  }

  [v8 setSharedLibraryButton:v9];
}

- (void)_embedSharedLibraryBadge
{
  v3 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v3)
  {
    v5 = 0;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
  }

  v4 = [(CAMViewfinderViewController *)self viewfinderView];
  [v4 setSharedLibraryBadge:v5];

  if (!v3)
  {
  }
}

- (void)_embedLivePhotoBadge
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _livePhotoBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setLivePhotoBadge:v4];
}

- (void)_embedShallowDepthOfFieldBadge
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setShallowDepthOfFieldBadge:v4];
}

- (void)_embedPortraitModeInstructionLabel
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setPortraitModeInstructionLabel:v4];
}

- (void)_embedCleanLensesInstructionLabel
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _cleanLensesInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setCleanLensesInstructionLabel:v4];
}

- (void)_embedQRCodeInstructionLabel
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setQrCodeInstructionLabel:v4];
}

- (void)_embedFlipButtonWithLayoutStyle:(int64_t)a3
{
  v12 = [(CAMViewfinderViewController *)self viewfinderView];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _bottomBar];
  v7 = [(CAMViewfinderViewController *)self _flipButton];
  v8 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v9 = dyld_program_sdk_at_least();
  if (v8)
  {
    v10 = v5;
  }

  else
  {
    v10 = v6;
  }

  if (v9)
  {
    v10 = v12;
  }

  if ((v9 | v8))
  {
    v11 = v6;
  }

  else
  {
    v11 = v5;
  }

  [v10 setFlipButton:0];
  [v11 setFlipButton:v7];
}

- (void)_embedTimerButtonWithLayoutStyle:(int64_t)a3
{
  v10 = [(CAMViewfinderViewController *)self _bottomBar];
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _timerButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v5 setTimerButton:0];
    v8 = v10;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [v5 setTimerButton:0];
      v8 = v10;
    }

    else
    {
      [v10 setTimerButton:0];
      v8 = v5;
    }

    v9 = v6;
  }

  [v8 setTimerButton:v9];
}

- (void)_embedTimerIndicatorView
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setTimerIndicatorView:v4];
}

- (void)_embedShutterButton
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [v5 bottomBar];
  v4 = [(CAMViewfinderViewController *)self _shutterButton];
  [v5 setShutterButton:0];
  [v3 setShutterButton:v4];
}

- (void)_embedStillDuringVideoButton
{
  v6 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [v6 bottomBar];
  v4 = [(CAMViewfinderViewController *)self _stillDuringVideoButton];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v5 = 0;
  }

  else
  {
    v5 = v4;
  }

  [v3 setStillDuringVideoButton:v5];
}

- (void)_embedModeDial
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [v5 bottomBar];
  v4 = [(CAMViewfinderViewController *)self _modeDial];
  [v3 setModeDial:v4];
}

- (void)_embedApertureButtonWithLayoutStyle:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v11 = [v5 topBar];

  v6 = [(CAMViewfinderViewController *)self viewfinderView];
  v7 = [v6 bottomBar];

  v8 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v11 setApertureButton:0];
  }

  else
  {
    if (v8)
    {
      [v11 setApertureButton:0];
      v9 = [(CAMViewfinderViewController *)self _apertureButton];
      [v7 setApertureButton:v9];

      goto LABEL_7;
    }

    v10 = [(CAMViewfinderViewController *)self _apertureButton];
    [v11 setApertureButton:v10];
  }

  [v7 setApertureButton:0];
LABEL_7:
}

- (void)_embedIntensityButtonWithLayoutStyle:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v8 = [v5 topBar];

  v6 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker]|| v6)
  {
    [v8 setIntensityButton:0];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _intensityButton];
    [v8 setIntensityButton:v7];
  }
}

- (void)_embedBurstIndicatorView
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _burstIndicatorView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setBurstIndicatorView:v4];
}

- (void)_embedPanoramaView
{
  v9 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _panoramaViewController];
  v4 = [v3 view];
  v5 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v9)
  {
    if (v5)
    {
      v6 = v9;
      v7 = 0;
    }

    else
    {
      v6 = v9;
      v7 = v4;
    }

    [v6 setPanoramaView:v7];
  }

  else
  {
    v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v8 setPanoramaView:v4];
  }
}

- (void)_embedZoomSlider
{
  v4 = [(CAMViewfinderViewController *)self viewfinderView];
  if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
  {
    zoomSlider = 0;
  }

  else
  {
    zoomSlider = self->__zoomSlider;
  }

  [v4 setZoomSlider:zoomSlider];
}

- (void)_embedZoomControl
{
  v3 = [(CAMViewfinderViewController *)self viewfinderView];
  [v3 setZoomControl:self->__zoomControl];
}

- (void)_embedGridView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v6 = [v3 previewView];

  v4 = [(CAMViewfinderViewController *)self _gridView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v5 = 0;
  }

  else
  {
    v5 = v4;
  }

  [v6 setGridView:v5];
}

- (void)_unembedGridView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v3 previewView];

  [v5 setGridView:0];
  v4 = [(CAMViewfinderViewController *)self _gridView];
  [v4 removeFromSuperview];
}

- (void)_embedLevelView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v3 previewView];

  v4 = [(CAMViewfinderViewController *)self _levelView];
  [v5 setLevelView:v4];
}

- (void)_unembedLevelView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v3 previewView];

  [v5 setLevelView:0];
  v4 = [(CAMViewfinderViewController *)self _levelView];
  [v4 removeFromSuperview];
}

- (void)_embedHorizonLevelView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v3 previewView];

  v4 = [(CAMViewfinderViewController *)self _horizonLevelView];
  [v5 setHorizonLevelView:v4];
}

- (void)_unembedHorizonLevelView
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v5 = [v3 previewView];

  [v5 setHorizonLevelView:0];
  v4 = [(CAMViewfinderViewController *)self _horizonLevelView];
  [v4 removeFromSuperview];
}

- (void)_embedVideoConfigurationStatusIndicatorWithLayoutStyle:(int64_t)a3
{
  v12 = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = [(CAMViewfinderViewController *)self _topBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v8 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v7)
  {
    v9 = v12;
  }

  else
  {
    v9 = 0;
  }

  if (v8 || v7)
  {
    v10 = 0;
  }

  else
  {
    v10 = v12;
  }

  if (v8)
  {
    v11 = 0;
  }

  else
  {
    v11 = v9;
  }

  [v6 setVideoConfigurationStatusIndicator:v10];
  [v5 setVideoConfigurationStatusIndicator:v11];
}

- (void)_embedUtilityBar
{
  v5 = [(CAMViewfinderViewController *)self _utilityBar];
  v3 = [(CAMViewfinderViewController *)self _bottomBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v5;
  }

  [v3 setUtilityBar:v4];
}

- (void)_embedFilterNameBadge
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _filterNameBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setFilterNameBadge:v4];
}

- (void)_embedPortraitApertureSlider
{
  v4 = [(CAMViewfinderViewController *)self _utilityBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v4 setApertureSlider:0];
  }

  else
  {
    v3 = [(CAMViewfinderViewController *)self _portraitApertureSlider];
    [v4 setApertureSlider:v3];
  }
}

- (void)_embedPortraitIntensitySlider
{
  v4 = [(CAMViewfinderViewController *)self _utilityBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [v4 setIntensitySlider:0];
  }

  else
  {
    v3 = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
    [v4 setIntensitySlider:v3];
  }
}

- (void)_embedLightingControl
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _lightingControl];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setLightingControl:v4];
}

- (void)_embedLightingNameBadge
{
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v3 = [(CAMViewfinderViewController *)self _lightingNameBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = v3;
  }

  [v5 setLightingNameBadge:v4];
}

- (BOOL)_shouldAllowControlDrawerForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingVideo];
  v7 = [v5 isCapturingBurst];
  v8 = [v5 isCapturingTimelapse];
  v9 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v10 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v11 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", v4, [v10 isCallActive]);

  v12 = [(CAMViewfinderViewController *)self _controlTypesForGraphConfiguration:v4];

  v13 = [v12 count] != 0 && !v11;
  if (v9)
  {
    v13 = 0;
  }

  if (v8)
  {
    v13 = 0;
  }

  if (v7)
  {
    v13 = 0;
  }

  v14 = (v6 & 1) == 0 && v13;

  return v14;
}

- (BOOL)_shouldAllowControlDrawerToggleForGraphConfiguration:(id)a3 orientation:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerForGraphConfiguration:v6];
  v8 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v9 = [(CAMViewfinderViewController *)self _shouldHideElapsedTimeViewForGraphConfiguration:v6 orientation:a4];

  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = [v10 smartStyleControlsVisible];

  v12 = (a4 - 3) < 2 || v9;
  v13 = v12 & (v11 ^ 1);
  if (v8)
  {
    v13 = 0;
  }

  if (v7)
  {
    return v13;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldHideTopBarForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingTimelapse];
  v7 = [(CAMViewfinderViewController *)self _isPerformingTopBarOrientationChange];
  v8 = [(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay];
  v9 = [v5 isCapturingPanorama];
  v10 = [v4 mode];
  if (v10 == 5 || v10 == 3)
  {
    v11 = [(CAMViewfinderViewController *)self _useMessagesControls];
    v12 = [(CAMViewfinderViewController *)self _topBar];
    v13 = [v12 sharedLibraryButton];
    if (v13)
    {
      v14 = v13;
      v15 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:v4];

      v11 |= v15;
    }

    else
    {
    }

    if (v6 & 1 | ((v11 & 1) == 0) | v9 & 1)
    {
      goto LABEL_9;
    }
  }

  else if ((v6 | v9))
  {
LABEL_9:
    v16 = 1;
    goto LABEL_10;
  }

  v16 = v7 || v8;
LABEL_10:

  return v16 & 1;
}

- (BOOL)_shouldHideFlashButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [(CAMViewfinderViewController *)self _topBar];
  v7 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v8 = [v5 isCapturingVideo];
  v9 = [v5 isCapturingTimelapse];
  v10 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v11 = [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:v4];
  if ((v8 & 1) != 0 || (v9 & 1) != 0 || v10)
  {
    v13 = [(CAMViewfinderViewController *)self _controlDrawer];
    v12 = v13 == 0;
  }

  else
  {
    v12 = 0;
  }

  v14 = v7 | (!v11 || v12);
  v15 = [(CAMViewfinderViewController *)self _flashButton];
  v16 = [v6 flashButton];

  if (v15 == v16)
  {
    v14 |= [v6 shouldHideFlashButtonForGraphConfiguration:v4];
  }

  return v14 & 1;
}

- (BOOL)_isMenuButtonConflictingWithView:(id)a3
{
  v4 = a3;
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _topBar];
    v6 = [v5 _shouldExpandButtonsHorizontally];
    v7 = [v5 _expandedMenuButton];
    v8 = [(CAMViewfinderViewController *)self _bottomBar];
    v9 = [v8 _expandedMenuButton];

    if (v7)
    {
      if (v9)
      {
        v10 = 0;
      }

      else
      {
        v10 = v6;
      }

      if (v10)
      {
        goto LABEL_7;
      }
    }

    else if (!v9)
    {
LABEL_7:
      v11 = 0;
LABEL_17:

      goto LABEL_18;
    }

    if (v9)
    {
      v12 = v9;
    }

    else
    {
      v12 = v7;
    }

    v13 = v12;
    v14 = [(CAMViewfinderViewController *)self _layoutStyle];
    v11 = 0;
    if (v14 <= 3 && v14 != 2)
    {
      v15 = [(CAMViewfinderViewController *)self view];
      [v13 bounds];
      [v15 convertRect:v13 fromView:?];
      v17 = v16;
      v19 = v18;
      v21 = v20;
      v23 = v22;

      v24 = [(CAMViewfinderViewController *)self view];
      [v4 bounds];
      [v24 convertRect:v4 fromView:?];
      v26 = v25;
      v28 = v27;
      v30 = v29;
      v32 = v31;

      v34.origin.x = v17;
      v34.origin.y = v19;
      v34.size.width = v21;
      v34.size.height = v23;
      v35.origin.x = v26;
      v35.origin.y = v28;
      v35.size.width = v30;
      v35.size.height = v32;
      v11 = CGRectIntersectsRect(v34, v35);
    }

    goto LABEL_17;
  }

  v11 = 0;
LABEL_18:

  return v11;
}

- (BOOL)_shouldShowTextBadgeForGraphConfiguration:(id)a3
{
  if ([(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:a3])
  {
    v4 = 0;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _timerCache];
    v6 = [v5 isRunningTimerForKey:&unk_1F16C7790];

    v7 = [(CAMViewfinderViewController *)self _captureController];
    LOBYTE(v5) = [v7 isCapturingLivePhotoVideo];

    v4 = v6 | v5;
  }

  return v4 & 1;
}

- (BOOL)_shouldHideHDRButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v7 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v8 = [(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:v4];
  v9 = v7 | ![(CAMViewfinderViewController *)self _wantsHDRControlsVisible];
  if (v6)
  {
    LOBYTE(v9) = 1;
  }

  if (v8)
  {
    v10 = v9;
  }

  else
  {
    v10 = 1;
  }

  v11 = [(CAMViewfinderViewController *)self _HDRButton];
  v12 = [v5 HDRButton];

  if (v11 == v12)
  {
    v10 |= [v5 shouldHideHDRButtonForGraphConfiguration:v4];
  }

  return v10 & 1;
}

- (BOOL)_shouldHideElapsedTimeViewForGraphConfiguration:(id)a3 orientation:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _topBar];
  v8 = [v6 mode];
  v9 = 1;
  if (v8 <= 8)
  {
    if (((1 << v8) & 0x186) != 0)
    {
      v10 = [(CAMViewfinderViewController *)self _layoutStyle];
      v11 = [(CAMViewfinderViewController *)self _captureController];
      v12 = [v11 isCapturingVideo];
      v9 = 0;
      if ((a4 - 3) >= 2 && (v12 & 1) == 0 && v10 != 1)
      {
        v9 = [(CAMViewfinderViewController *)self _useMessagesControls];
      }
    }

    else
    {
      if (v8)
      {
        goto LABEL_10;
      }

      v11 = [(CAMViewfinderViewController *)self _captureController];
      v9 = [v11 isCapturingVideo] ^ 1;
    }
  }

LABEL_10:
  v32 = v9;
  v33 = v7;
  v13 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:13 forGraphConfiguration:v6];
  v31 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:7 forGraphConfiguration:v6];
  v30 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:8 forGraphConfiguration:v6];
  v14 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:5 forGraphConfiguration:v6];
  v15 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:14 forGraphConfiguration:v6];
  v16 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:15 forGraphConfiguration:v6];
  v17 = [(CAMViewfinderViewController *)self _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:v6];
  v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v19 = [v18 controlStatusBar];
  v20 = [v19 isControlExpanded];

  v21 = 1;
  if (v13 && v31)
  {
    v22 = v33;
    v23 = v32;
  }

  else
  {
    v22 = v33;
    v23 = v32;
    if ((!v30 || !v14) && (!v13 || !v15) && (!v13 || !v16))
    {
      v21 = (v16 && v15 && !v17) | v20;
    }
  }

  v24 = v23 | v21;
  v25 = [(CAMViewfinderViewController *)self _elapsedTimeView];
  v26 = [v22 elapsedTimeView];

  if (v25 == v26)
  {
    v24 |= [v22 shouldHideElapsedTimeViewForGraphConfiguration:v6];
  }

  v27 = [(CAMViewfinderViewController *)self _captureController];
  v28 = [v27 isCapturingVideo];

  return v24 & 1 | ((v28 & 1) == 0);
}

- (BOOL)_shouldHideLivePhotoButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v7 = v6 | ![(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:v4];
  v8 = [(CAMViewfinderViewController *)self _livePhotoButton];
  v9 = [v5 livePhotoButton];

  if (v8 == v9)
  {
    LOBYTE(v7) = v7 | [v5 shouldHideLivePhotoButtonForGraphConfiguration:v4];
  }

  return v7 & 1;
}

- (BOOL)_shouldHideLivePhotoBadgeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingLivePhotoVideo];
  v7 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v8 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:v4];
  v9 = [(CAMViewfinderViewController *)self _timerCache];
  v10 = [v9 isRunningTimerForKey:&unk_1F16C77A8];

  v11 = [(CAMViewfinderViewController *)self _livePhotoBadge];
  v12 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v11];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  return (v12 || ((v7 ^ 1) & v8 & (v6 | v10) & 1) == 0) | self & 1;
}

- (BOOL)_shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode] != 6;
  v6 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  v7 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  v8 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v7];

  LOBYTE(v7) = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 arePortraitEffectsSupported];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  return ((v5 || v8) | v7 | v10 | v6 | self) & 1;
}

- (BOOL)_shouldShowSpatialBadgeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = -[CAMViewfinderViewController _isSpatialMode:devicePosition:](self, "_isSpatialMode:devicePosition:", [v4 mode], objc_msgSend(v4, "devicePosition"));
  v6 = [(CAMViewfinderViewController *)self _timerCache];
  v7 = [v6 isRunningTimerForKey:&unk_1F16C77C0];

  LOBYTE(v6) = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 isOrientationInstructionVisible];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  return v7 & (self ^ 1) & v5 & ((v6 | v9) ^ 1);
}

- (BOOL)_shouldHidePortraitModeInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  if ((v5 - 6) < 2)
  {
    v6 = 0;
    v7 = 1;
  }

  else if (v5)
  {
    v6 = 0;
    v7 = v5 == 1 && ([v4 videoStabilizationStrength] & 0xFFFFFFFFFFFFFFFELL) == 2;
  }

  else
  {
    v8 = +[CAMCaptureCapabilities capabilities];
    v9 = [v4 mode];
    v10 = [v4 devicePosition];
    v11 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    v13 = [v8 isDepthSuggestionSupportedForMode:v9 devicePosition:v10 photoFormat:v11, v12];
    v14 = +[CAMCaptureCapabilities capabilities];
    v15 = [v14 portraitInPhotoModeBehavior];

    v7 = 0;
    if (v13 && (v15 & 1) != 0)
    {
      v7 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    }

    v6 = [(CAMViewfinderViewController *)self isRecording];
  }

  v16 = [CAMPortraitModeInstructionLabel shouldDisplayInstructionForShallowDepthOfFieldStatus:[(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]];
  v17 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  v18 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v19 = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  v20 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v19];

  v21 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v22 = [v21 isSemanticStyleControlVisible];

  v23 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  LOBYTE(v21) = [v23 isSmartStylePickerVisible];

  return ((!v7 || !v16) | v18 | v20 | v17 | v6 | v22 | v21) & 1;
}

- (BOOL)_shouldHideQRCodeInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  v7 = [v4 devicePosition];

  v8 = [v6 cachedMRCResults];
  v9 = [CAMQRCodeInstructionLabel shouldDisplayInstructionForMRCResults:v8 devicePosition:v7];
  v10 = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v10];

  v11 = (self & 1) != 0 || (v5 & 0xFFFFFFFFFFFFFFFBLL) != 0 || !v9;
  return v11 & 1;
}

- (BOOL)_shouldHideFlipButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = +[CAMCaptureCapabilities capabilities];
  v25 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v26 = v6;
  if ([v6 isBackCameraSupported])
  {
    v7 = [v6 isFrontCameraSupported] ^ 1;
  }

  else
  {
    LOBYTE(v7) = 1;
  }

  v24 = v7;
  v23 = [v5 isCapturingVideo];
  v8 = [v5 isCapturingTimelapse];
  v9 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v10 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v11 = -[CAMViewfinderViewController _isFlipButtonSupportedForMode:](self, "_isFlipButtonSupportedForMode:", [v4 mode]);
  v27 = v4;
  v12 = [v5 isCapturingBurst];
  v13 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v14 = (v13 != 0) & v12;

  v15 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v16 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v17 = [v16 smartStyleControlsVisible];

  v18 = v24 | !v11 | v23 | v25 | v14 | v8 | v9 | v10 | v15 | v17;
  v19 = [(CAMViewfinderViewController *)self _topBar];
  v20 = [(CAMViewfinderViewController *)self _flipButton];
  v21 = [v19 flipButton];

  if (v20 == v21)
  {
    v18 |= [v19 shouldHideFlipButtonForGraphConfiguration:v27];
  }

  return v18 & 1;
}

- (BOOL)_isFlipButtonSupportedForMode:(int64_t)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = v4;
  v6 = 0;
  if (a3 <= 3)
  {
    if (a3 >= 2)
    {
      if (a3 == 2)
      {
        if ([v4 isFrontSlomoSupported])
        {
          v7 = [v5 isBackSlomoSupported];
          goto LABEL_17;
        }

        goto LABEL_18;
      }

      if (a3 == 3)
      {
        if ([v4 isFrontPanoramaSupported])
        {
          v7 = [v5 isBackPanoramaSupported];
LABEL_17:
          v6 = v7;
          goto LABEL_19;
        }

        goto LABEL_18;
      }

      goto LABEL_19;
    }

LABEL_12:
    v6 = 1;
    goto LABEL_19;
  }

  if ((a3 - 4) < 2)
  {
    goto LABEL_12;
  }

  if (a3 == 6)
  {
    if ([v4 isFrontPortraitModeSupported])
    {
      v7 = [v5 isBackPortraitModeSupported];
      goto LABEL_17;
    }

    goto LABEL_18;
  }

  if (a3 == 7)
  {
    if ([v4 isFrontCinematicModeSupported])
    {
      v7 = [v5 isBackCinematicModeSupported];
      goto LABEL_17;
    }

LABEL_18:
    v6 = 0;
  }

LABEL_19:

  return v6;
}

- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  LOBYTE(self) = -[CAMViewfinderViewController _shouldHideModeDialForGraphConfiguration:isCapturingBurst:](self, "_shouldHideModeDialForGraphConfiguration:isCapturingBurst:", v4, [v5 isCapturingBurst]);

  return self;
}

- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)a3 isCapturingBurst:(BOOL)a4
{
  v5 = a3;
  v6 = [(CAMViewfinderViewController *)self _captureController];
  v18 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v17 = [v6 isCapturingVideo];
  v7 = [v6 isCapturingPanorama];
  v8 = [v6 isCapturingTimelapse];
  v9 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v10 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v5];

  v11 = [(CAMViewfinderViewController *)self _layoutStyle];
  v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if (v13)
  {
    v14 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  }

  else
  {
    v14 = 0;
  }

  v15 = v18 | v17 | (v12 != 0 && a4) | v7 | v8 | v9 | v14 | (v11 != 1) & ~v10 | [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture];
  return v15 & 1;
}

- (BOOL)_shouldHideImageWellForGraphConfiguration:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v17 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v5 = [v4 isCapturingVideo];
  v6 = [v4 isCapturingPanorama];
  v7 = [v4 isCapturingTimelapse];
  v8 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v9 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v10 = [v4 isCapturingBurst];
  v11 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if (v11)
  {
    v12 = ![(CAMViewfinderViewController *)self _capturingFromPhysicalButton]& v10;
  }

  else
  {
    LOBYTE(v12) = 0;
  }

  v13 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v15 = [v14 smartStyleControlsVisible];

  return (v17 | v5 | v12 | v6 | v7 | v8 | (v9 || v13) | v15) & 1;
}

- (BOOL)_shouldHideStillDuringVideoButtonForGraphConfiguration:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isCapturingVideo];

  return v4 ^ 1;
}

- (BOOL)_shouldHideShutterButtonForGraphConfiguration:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = [v3 smartStyleControlsVisible];

  return v4;
}

- (BOOL)_shouldHideFilterButtonForGraphConfiguration:(id)a3
{
  v4 = MEMORY[0x1E69DC668];
  v5 = a3;
  LOBYTE(v4) = [v4 shouldMakeUIForDefaultPNG];
  v6 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:v5];

  return (v6 || (self & 1) == 0) | v4 & 1;
}

- (BOOL)_shouldHideApertureButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isDepthEffectApertureSupportedForMode:objc_msgSend(v4 devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(v4, "devicePosition"), objc_msgSend(v4, "enableDepthSuggestion")}];

  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v4 mode];
  v10 = [v4 devicePosition];
  v11 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(v9) = [v8 isDepthSuggestionSupportedForMode:v9 devicePosition:v10 photoFormat:v11, v12];

  LODWORD(v8) = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v13 = +[CAMCaptureCapabilities capabilities];
  v14 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v16 = [v13 isDepthEffectApertureSupportedForPhotoFormat:v14, v15];

  v17 = v7 & ![(CAMViewfinderViewController *)self _isCapturingFromTimer]& v16 & (v9 ^ 1 | v8) ^ 1;
  v18 = [(CAMViewfinderViewController *)self _apertureButton];
  v19 = [v5 apertureButton];

  if (v18 == v19)
  {
    LOBYTE(v17) = v17 | [v5 shouldHideApertureButtonForGraphConfiguration:v4];
  }

  return v17 & 1;
}

- (BOOL)_shouldHideIntensityButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [v4 mode], objc_msgSend(v4, "device"));
  v8 = [v6 isPortraitEffectIntensitySupportedForMode:{objc_msgSend(v4, "mode")}];
  v9 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LODWORD(v7) = [v6 isPortraitEffectIntensitySupportedForLightingType:v7];
  v10 = +[CAMCaptureCapabilities capabilities];
  v11 = [v4 mode];
  v12 = [v4 devicePosition];
  v13 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(v11) = [v10 isDepthSuggestionSupportedForMode:v11 devicePosition:v12 photoFormat:v13, v14];

  v15 = v7 ^ 1 | v11 & ![(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  if (v9)
  {
    LOBYTE(v15) = 1;
  }

  if (v8)
  {
    v16 = v15;
  }

  else
  {
    v16 = 1;
  }

  v17 = [(CAMViewfinderViewController *)self _intensityButton];
  v18 = [v5 intensityButton];

  if (v17 == v18)
  {
    v16 |= [v5 shouldHideIntensityButtonForGraphConfiguration:v4];
  }

  return v16 & 1;
}

- (BOOL)_shouldShowExposureButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];

  LODWORD(v4) = [v5 isExposureSliderSupportedForMode:v6];
  if (v4)
  {
    return ![(CAMViewfinderViewController *)self _isCapturingFromTimer];
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldHideUtilityBarForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 wantsFullscreenViewfinder];

  if (v6)
  {
    v7 = 1;
  }

  else
  {
    v8 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
    v9 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
    v10 = v9 & [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:v4];
    v11 = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider];
    v12 = v10 | v11 | [(CAMViewfinderViewController *)self _isShowingPortraitIntensitySlider];
    v13 = [(CAMViewfinderViewController *)self _utilityBar];
    v14 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v13];

    v7 = v12 ^ 1 | v14 | v8;
  }

  return v7 & 1;
}

- (BOOL)_shouldHideFilterNameBadgeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v6 = [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:v4];
  v7 = [(CAMViewfinderViewController *)self _isShowingBurstIndicatorView];
  v8 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v9 = [(CAMViewfinderViewController *)self _filterNameBadge];
  v10 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v9];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  return (v7 || !v6 || !v5 || v10) | self & 1 | v8 & 1;
}

- (BOOL)_shouldHidePanoramaViewForGraphConfiguration:(id)a3
{
  v4 = MEMORY[0x1E69DC668];
  v5 = a3;
  LOBYTE(v4) = [v4 shouldMakeUIForDefaultPNG];
  v6 = [v5 mode] != 3;
  v7 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v5];

  v8 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  LOBYTE(v4) = v6 | [v8 isViewfinderClosed] | v7 | v4;

  return v4 & 1;
}

- (BOOL)_shouldHideZoomSliderForGraphConfiguration:(id)a3 ignoreExpiredVisibilityTimer:(BOOL)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:v6];
  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v8 isCapturingBurst];
  v10 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v11 = !a4 && [(CAMZoomSlider *)self->__zoomSlider shouldHideForExpiredVisibilityTimer];
  v12 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v13 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v6];

  v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v15 = [v14 isSemanticStyleControlVisible];

  v16 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  v17 = v11 | ~v7 | v9 | v10;
  v18 = 1;
  if ((v17 & 1) == 0 && !v12 && v13 && (v15 & 1) == 0 && !v16)
  {
    v18 = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v18;
}

- (BOOL)_wantsZoomSliderForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider];
  v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v4];
  v7 = [v4 devicePosition];

  v8 = v7 != 1 && v6;
  return !v5 && v8;
}

- (BOOL)_shouldHideZoomControlForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v31 = [v5 isCapturingBurst];
  v6 = [v5 isCapturingVideo];
  v7 = [v5 isCapturingTimelapse];
  v8 = [v5 isCapturingPanorama];
  v30 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v29 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v4];
  v9 = [(CAMViewfinderViewController *)self _zoomControlReconfiguresGraphConfiguration:v4];
  if (v6 & 1 | !v9)
  {
    v10 = v9;
  }

  else
  {
    v10 = v7 | v8;
  }

  v28 = v10;
  v11 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v12 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v27 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v4];
  v26 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:v4];
  v13 = [(CAMViewfinderViewController *)self _targetLightingControl];
  v25 = [v13 isExpanded];
  v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v24 = [v14 isFilterScrubberVisible];

  v15 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v16 = [v15 isSemanticStyleControlVisible];

  v17 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v18 = [v17 smartStyleControlsVisible];

  v19 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v20 = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v21 = v20 != 0;
  }

  else
  {
    v21 = 0;
  }

  v22 = 1;
  if (((!v29 | v31 | v30 | v28 | v11 | v12) & 1) == 0 && v27 && ((!v26 & v25 | v24 | v19 | v16 | v18 | v21) & 1) == 0 && [(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    v22 = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v22;
}

- (BOOL)_wantsZoomControlForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider];
  v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v4];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForGraphConfiguration:v4];

  return v5 & (v6 | self);
}

- (BOOL)_shouldUseZoomButtonForCameraToggleForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 devicePosition];
  v7 = [v3 videoConfiguration];
  v8 = [v3 videoStabilizationStrength];
  v9 = [v3 frontRearSimultaneousVideoEnabled];

  LOBYTE(v3) = [v4 shouldAllowCameraToggleForMode:v5 devicePosition:v6 videoConfiguration:v7 videoStabilizationStrength:v8 frontRearSimultaneousVideoEnabled:v9];
  return v3;
}

- (BOOL)_shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldUseZoomButtonForCameraToggleForGraphConfiguration:v3];

  return v2;
}

- (BOOL)_shouldHideLightingControlForGraphConfiguration:(id)a3
{
  v4 = a3;
  v24 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v4];
  v23 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v5 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  v6 = [(CAMViewfinderViewController *)self _zoomControl];
  v7 = [v6 isShowingZoomDial];

  v8 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v4 mode];
  v11 = [v4 devicePosition];
  v12 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v14 = [v9 isDepthSuggestionSupportedForMode:v10 devicePosition:v11 photoFormat:v12, v13];

  v15 = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v16 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v17 = [v16 smartStyleControlsVisible];

  v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v19 = [v18 isSystemOverlayVisible];

  v20 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:v4];
  if (v20 == 2)
  {
    v21 = v19;
  }

  else
  {
    v21 = 0;
  }

  if (!v24 || v23 || v5 || (v7 & 1) != 0 || v8 || (v14 & !v15 & 1) != 0 || (v17 & 1) != 0 || (v21 & 1) != 0)
  {
    return 1;
  }

  return [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
}

- (BOOL)_wantsLightingControlForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = [v4 devicePosition];

  return [(CAMViewfinderViewController *)self _wantsLightingControlForMode:v5 devicePosition:v6];
}

- (BOOL)_wantsLightingControlForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  if (![v7 isLightingControlSupportedForMode:a3])
  {
    goto LABEL_6;
  }

  if (!a3)
  {
    v9 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v7 isDepthSuggestionSupportedForMode:0 devicePosition:a4 photoFormat:v9, v10])
    {
      v8 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
      goto LABEL_7;
    }

LABEL_6:
    v8 = 0;
    goto LABEL_7;
  }

  v8 = 1;
LABEL_7:

  return v8;
}

- (BOOL)_shouldHideLightingControlBadgeForGraphConfiguration:(id)a3 orientation:(int64_t)a4
{
  v5 = a4 - 3;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _layoutStyle];
  v8 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v6];

  v10 = v5 < 2 || v7 == 1;
  return v10 || v8;
}

- (BOOL)_shouldHideLightingNameBadgeForGraphConfiguration:(id)a3 orientation:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:v6];
  v8 = [(CAMViewfinderViewController *)self _isShowingBurstIndicatorView];
  v9 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v10 = [(CAMViewfinderViewController *)self _lightingNameBadge];
  v11 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v10];

  LOBYTE(a4) = [(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v6 orientation:a4];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v6];

  return ((v7 || v8 || v11) | v9) & 1 | ((a4 & 1) == 0) | self & 1;
}

- (BOOL)_shouldHideGridViewForGraphConfiguration:(id)a3
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 shouldShowGridView];

  return v4 ^ 1;
}

- (BOOL)_shouldShowChromeExternalStorageIconForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = [v4 videoEncodingBehavior];

  LOBYTE(v4) = [(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabledForMode:v5 videoEncodingBehavior:v6];
  return v4 & [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
}

- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)a3 videoEncodingBehavior:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(a4) = [v7 isExternalStorageOutputSupportedForMode:a3 videoEncodingBehavior:a4];

  v8 = [(CAMViewfinderViewController *)self _connectedStorage];
  LOBYTE(a3) = v8 != 0;

  return a3 & a4;
}

- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 desiredProResVideoMode:(int64_t)a5
{
  v9 = +[CAMUserPreferences preferences];
  LOBYTE(a5) = -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](self, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", a3, [v9 videoEncodingBehaviorForConfiguration:a4 mode:a3 desiredProResVideoMode:a5 outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}]);

  return a5;
}

- (BOOL)_wantsExternalStorageOutputEnabled
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](v2, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", -[CAMViewfinderViewController _currentMode](v2, "_currentMode"), [v3 videoEncodingBehavior]);

  return v2;
}

- (BOOL)_shouldShowUnsupportedExternalStorageFormat
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = -[CAMViewfinderViewController _shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:](v2, "_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:", [v3 videoEncodingBehavior]);

  return v2;
}

- (BOOL)_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMCaptureCapabilities capabilities];
  LODWORD(a3) = [v6 isExternalStorageOutputSupportedForMode:v5 videoEncodingBehavior:a3];

  if (!a3)
  {
    return 0;
  }

  v7 = [(CAMViewfinderViewController *)self _connectedStorage];
  if (v7)
  {
    v8 = 0;
  }

  else
  {
    v9 = [(CAMViewfinderViewController *)self _storageMonitor];
    v8 = [v9 hasExternalStorageNotRecommendedForCapture];
  }

  return v8;
}

- (BOOL)_shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v6 = +[CAMUserPreferences preferences];
  if ([v6 isVideoConfigurationControlEnabled])
  {

    v7 = 0;
  }

  else
  {
    v8 = +[CAMCaptureCapabilities capabilities];
    v9 = [v8 interactiveVideoFormatControlAlwaysEnabled];

    if (v9)
    {
      v7 = 0;
    }

    else
    {
      v10 = +[CAMCaptureCapabilities capabilities];
      v11 = [v4 mode];
      v12 = [v4 device];
      v13 = [v4 videoEncodingBehavior];
      v14 = [v4 videoConfiguration];
      v15 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
      v16 = [v4 prefersHDR10BitVideo];
      LOBYTE(v36) = [v4 frontRearSimultaneousVideoEnabled];
      v17 = [v10 resolvedVideoConfigurationForMode:v11 device:v12 videoEncodingBehavior:v13 videoConfiguration:v14 outputToExternalStorage:v15 prefersHDR10BitVideo:v16 frontRearSimultaneousVideoEnabled:v36];

      v18 = +[CAMCaptureCapabilities capabilities];
      v19 = [v4 mode];
      v20 = [v4 device];
      v21 = [v4 videoEncodingBehavior];
      v22 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
      v23 = [v4 prefersHDR10BitVideo];
      LOBYTE(v37) = [v4 frontRearSimultaneousVideoEnabled];
      v24 = [v18 resolvedVideoConfigurationForMode:v19 device:v20 videoEncodingBehavior:v21 videoConfiguration:0 outputToExternalStorage:v22 prefersHDR10BitVideo:v23 frontRearSimultaneousVideoEnabled:v37];

      v7 = v17 == v24;
    }
  }

  v25 = [v4 mode];
  v26 = (v25 > 8) | (0x79u >> v25);
  v27 = [(CAMViewfinderViewController *)self _captureController];
  v28 = [v27 isCapturingVideo];
  v29 = [(CAMViewfinderViewController *)self _topBar];
  v30 = [(CAMViewfinderViewController *)self _elapsedTimeView];
  v31 = [v29 elapsedTimeView];

  if (v30 == v31)
  {
    v32 = [v29 shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:v4];
    v33 = [(CAMViewfinderViewController *)self _topBarStyleForGraphConfiguration:v4 capturing:v28];
    if ([(CAMViewfinderViewController *)self _useMessagesControls])
    {
      v32 |= [CAMTopBar isFloatingStyle:v33];
    }
  }

  else
  {
    LOBYTE(v32) = 0;
  }

  if ((v7 | v26 | v5))
  {
    v34 = 1;
  }

  else
  {
    v34 = v28 | v32;
  }

  return v34 & 1;
}

- (BOOL)_shouldHideFocusAndExposureLockBadgeForGraphConfiguration:(id)a3
{
  previewViewController = self->__previewViewController;
  v5 = a3;
  if (-[CAMPreviewViewController isFocusLockedByUser](previewViewController, "isFocusLockedByUser") || -[CAMPreviewViewController isExposureLockedByUser](self->__previewViewController, "isExposureLockedByUser") || (-[CAMViewfinderViewController _previewViewController](self, "_previewViewController"), v6 = objc_claimAutoreleasedReturnValue(), v7 = [v6 isFocusLockedOnCinematicSubject], v6, (v7 & 1) != 0))
  {
    LOBYTE(v8) = 0;
  }

  else
  {
    v16 = [(CAMViewfinderViewController *)self _previewViewController];
    v8 = [v16 isFocusLockedOnDockKitSubject] ^ 1;
  }

  v9 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v5];
  v10 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryBadgeForGraphConfiguration:v5];
  v11 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationBadgeForGraphConfiguration:v5];
  v12 = [(CAMViewfinderViewController *)self _livePhotoBadge];
  v13 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:v12];

  v14 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v5];
  return (v8 | v13 | !v9 | (v14 || v10 || v11)) & 1;
}

- (BOOL)_shouldHideTimerButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _topBar];
  v6 = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isTimerSupportedForMode:{objc_msgSend(v4, "mode")}];

  v9 = v8 ^ 1 | v6;
  v10 = [(CAMViewfinderViewController *)self _timerButton];
  v11 = [v5 timerButton];

  if (v10 == v11)
  {
    v9 |= [v5 shouldHideTimerButtonForGraphConfiguration:v4];
  }

  return v9 & 1;
}

- (BOOL)_shouldShowNightModeControlForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device];

  v8 = [v5 isNightModeSupportedForMode:v6 device:v7];
  v9 = [(CAMViewfinderViewController *)self _controlDrawer];
  v10 = [v9 visibleControlTypes];
  v11 = [v10 containsObject:&unk_1F16C76B8];

  v12 = [(CAMViewfinderViewController *)self _captureController];
  v13 = [v12 nightModeStatus];

  if (v13 == -1)
  {
    v14 = v11;
  }

  else
  {
    v14 = 0;
  }

  if ((v13 - 1) >= 2)
  {
    v15 = v14;
  }

  else
  {
    v15 = 1;
  }

  return v8 & v15;
}

- (BOOL)_shouldShowVideoConfigurationIndicatorForGraphConfiguration:(id)a3
{
  v3 = [a3 mode];
  if ((v3 - 1) < 2 || v3 == 8)
  {
    return 1;
  }

  if (v3 != 7)
  {
    return 0;
  }

  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 cinematic4KSupported];

  return v7;
}

- (BOOL)_shouldHideAspectRatioControlForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 devicePosition];

  LOBYTE(v3) = [v4 isAspectRatioCropSupportedForMode:v5 devicePosition:v6];
  return v3 ^ 1;
}

- (BOOL)_shouldShowSemanticStyleControlForGraphConfiguration:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 smartStylesSupported];

  if (v5)
  {
    LOBYTE(v6) = 0;
  }

  else
  {
    return ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]>> 3) & 1;
  }

  return v6;
}

- (BOOL)_shouldShowSmartStyleControlForGraphConfiguration:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 smartStylesSupported];

  return v5 && ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]& 9) != 0;
}

- (BOOL)_shouldShowSmartStyleIndicatorForGraphConfiguration:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 smartStylesSupported];

  if (v5)
  {
    return ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]>> 3) & 1;
  }

  else
  {
    LOBYTE(v6) = 0;
  }

  return v6;
}

- (BOOL)_shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([v4 isSmartStylePickerVisible])
  {
    v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v6 = [v5 smartStylePicker];
    v7 = [v6 expanded];
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (BOOL)_shouldShowRAWButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = +[CAMUserPreferences preferences];
  v7 = [v6 rawControlEnabled];

  LODWORD(v6) = [v5 isLinearDNGSupportedForMode:{objc_msgSend(v4, "mode")}];
  v8 = [(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:v4];

  if (v6)
  {
    v9 = v7 & !v8;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_shouldShowPhotoFormatButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 shouldUsePhotoFormatControlForMode:{objc_msgSend(v4, "mode")}];

  if (v6)
  {
    v7 = -[CAMViewfinderViewController _enabledPhotoFormatsForMode:device:](self, "_enabledPhotoFormatsForMode:device:", [v4 mode], objc_msgSend(v4, "device"));
    v8 = [v7 count] > 1;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)_shouldShowProResButtonForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 isProResControlEnabled];

  v7 = [v3 frontRearSimultaneousVideoEnabled];
  v8 = [v3 mode];

  LOBYTE(v3) = [v4 isProResVideoSupportedForMode:v8 frontRearSimultaneousVideoEnabled:v7];
  return v6 & v3;
}

- (BOOL)_shouldShowVideoStabilizationButtonForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 device];
  v7 = [v3 videoConfiguration];
  v8 = [v3 videoEncodingBehavior];
  v9 = [v3 trueVideoEnabled];
  v10 = [v3 prefersHDR10BitVideo];
  v11 = [v3 frontRearSimultaneousVideoEnabled];

  LOBYTE(v13) = v11;
  LOBYTE(v3) = [v4 isActionModeControlSupportedForMode:v5 device:v6 videoConfiguration:v7 videoEncodingBehavior:v8 trueVideoEnabled:v9 prefersHDR10BitVideo:v10 frontRearSimultaneousVideoEnabled:v13];

  return v3;
}

- (BOOL)_shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 devicePosition];

  v8 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v10 = [v5 isDepthSuggestionSupportedForMode:v6 devicePosition:v7 photoFormat:v8, v9];

  if ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 6)
  {
    return v10;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldShowFreeResourcesInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled])
  {
    v5 = 0;
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:v4];
    v7 = [v4 videoEncodingBehavior];
    v8 = [(CAMViewfinderViewController *)self _captureController];
    v9 = [v8 isCapturingVideo];

    v10 = (v9 | [(CAMViewfinderViewController *)self _hasSignificantAmountOfRecordingTimeForCurrentConfiguration]) ^ 1;
    if (v7 != 2)
    {
      LOBYTE(v10) = 0;
    }

    if (v6)
    {
      v5 = v10;
    }

    else
    {
      v5 = 0;
    }
  }

  return v5 & 1;
}

- (BOOL)_shouldShowCleanLensesInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isSmudgeDetectionSupportedForMode:{objc_msgSend(v4, "mode")}];

  if (v6)
  {
    v7 = [v4 devicePosition];
    if (!v7)
    {
      v8 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
      goto LABEL_7;
    }

    if (v7 == 1)
    {
      v8 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
LABEL_7:
      v9 = v8;
      LOBYTE(v5) = [v8 shouldDisplayLensIsSmudged];
    }
  }

  else
  {
    LOBYTE(v5) = 0;
  }

  return v5 & 1;
}

- (BOOL)_shouldShowSharedLibraryBadgeForGraphConfiguration:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:a3];
  v5 = [(CAMViewfinderViewController *)self _timerCache];
  v6 = [v5 isRunningTimerForKey:&unk_1F16C77D8];

  v7 = +[CAMUserPreferences preferences];
  if ([v7 sharedLibrarySwitchEnabled])
  {
    v8 = v6 & !v4;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)_shouldShowVideoStabilizationBadgeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v17 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device];
  v8 = [v4 videoConfiguration];
  v9 = [v4 videoEncodingBehavior];
  v10 = [v4 trueVideoEnabled];
  v11 = [v4 prefersHDR10BitVideo];
  v12 = [v4 frontRearSimultaneousVideoEnabled];

  LOBYTE(v16) = v12;
  v13 = [v5 isActionModeControlSupportedForMode:v6 device:v7 videoConfiguration:v8 videoEncodingBehavior:v9 trueVideoEnabled:v10 prefersHDR10BitVideo:v11 frontRearSimultaneousVideoEnabled:v16];

  v14 = [(CAMViewfinderViewController *)self _isFlashingVideoStabilizationBadge];
  return v13 && v14 && !v17;
}

- (BOOL)_shouldShowImageAnalysisButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  v6 = +[CAMCaptureCapabilities capabilities];
  v22 = [v6 isImageAnalysisSupportedForMode:objc_msgSend(v4 devicePosition:{"mode"), objc_msgSend(v4, "devicePosition")}];
  v7 = [v5 isContextMenuDisplayed];
  v8 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  v9 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  v10 = [v9 currentObjectType];
  v11 = [v9 currentMachineReadableCodeAction];

  v12 = 1;
  v24 = v5;
  if (!v8 && v10 != 1 && !v11 && (v7 & 1) == 0)
  {
    v12 = [v6 isImageAnalysisButtonAlwaysVisible];
  }

  v23 = v6;
  v13 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v4];
  v14 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v4];
  v15 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:v4];
  v16 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:v4];
  v17 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v18 = [v17 isSystemOverlayVisible];

  if ((v22 & v12) == 1 && !(v18 & 1 | ((([(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:v4]&& (!v13 || v15 != 2)) & ((v16 != 2) | ~v14) & 1) == 0)))
  {
    v19 = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded]^ 1;
  }

  else
  {
    v19 = 0;
  }

  v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v20 setShouldShowImageAnalysisButton:v19];

  return v19;
}

- (BOOL)_shouldShowImageAnalysisInstructionLabel
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextSelectionInstructions])
  {
    return 1;
  }

  v4 = [(CAMViewfinderViewController *)self _timerCache];
  v5 = [v4 isRunningTimerForKey:&unk_1F16C7760];

  return v5;
}

- (BOOL)_shouldShowSharedLibraryIndicatorForGraphConfiguration:(id)a3
{
  if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    return 0;
  }

  v4 = +[CAMUserPreferences preferences];
  v5 = [v4 sharedLibrarySwitchEnabled];

  return v5;
}

- (BOOL)_shouldShowPreviewOverlayButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _zoomControl];
  v6 = [v5 isShowingZoomDial];

  v7 = [(CAMViewfinderViewController *)self _zoomSlider];
  [v7 alpha];
  v9 = v8;

  v10 = [(CAMViewfinderViewController *)self _layoutStyle];
  if (v9 > 0.0)
  {
    v11 = 1;
  }

  else
  {
    v11 = v6;
  }

  if (v10 == 1)
  {
    v12 = 0;
  }

  else
  {
    v12 = v11;
  }

  v13 = [(CAMViewfinderViewController *)self _targetLightingControl];
  v14 = [v13 isExpanded];

  v15 = [(CAMViewfinderViewController *)self _layoutStyle]!= 1;
  v16 = [(CAMViewfinderViewController *)self _captureController];
  v17 = [v16 isCapturingVideo];
  v18 = [v16 isCapturingBurst];
  v19 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v20 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];

  v21 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LOBYTE(v4) = 0;
  if ((v17 & 1) == 0 && !v19 && (v18 & 1) == 0 && !v20 && (v12 & 1) == 0 && !v21 && (v15 & v14 & 1) == 0)
  {
    LODWORD(v4) = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v4;
}

- (BOOL)_shouldShowFrontPIPButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = [v4 devicePosition];

  v7 = v6 == 0;
  LOBYTE(v6) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:v5 devicePosition:v6];
  LOBYTE(v7) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:v5 devicePosition:v7];
  v8 = [(CAMViewfinderViewController *)self _captureController];
  LOBYTE(v7) = (v6 | v7) & ~[v8 isCapturingVideo];

  return v7 & 1;
}

- (BOOL)_shouldShowAutoMacroButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isSuperWideAutoMacroSupportedForMode:v5 device:objc_msgSend(v4 videoConfiguration:"device") videoStabilizationStrength:objc_msgSend(v4 frontRearSimultaneousVideoEnabled:{"videoConfiguration"), objc_msgSend(v4, "videoStabilizationStrength"), objc_msgSend(v4, "frontRearSimultaneousVideoEnabled")}];

  v8 = [v4 devicePosition];
  v9 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [CAMConflictingControlConfiguration shouldDisableMacroForLockedPortraitForMode:v5 devicePosition:v8 photoFormat:v9 optionalDepthEffectEnabled:v10, [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]];
  v12 = +[CAMUserPreferences preferences];
  v13 = [v12 isSuperWideAutoMacroControlAllowed];

  v14 = [(CAMViewfinderViewController *)self _autoMacroSuggested];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v15 = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v16 = v15 != 0;
  }

  else
  {
    v16 = 0;
  }

  v17 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  v18 = 0;
  if ((v7 & v13 & v14) == 1 && !v16)
  {
    v19 = v17;
    if ([(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:v4])
    {
      v18 = !v11 && !v19;
    }

    else
    {
      v18 = 0;
    }
  }

  return v18;
}

- (BOOL)_shouldShowDepthSuggestionButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  v9 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v5 isDepthSuggestionSupportedForMode:v6 devicePosition:v8 photoFormat:v9, v10];
  v12 = [(CAMViewfinderViewController *)self _isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:[(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v13 = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v14 = v13 != 0;
  }

  else
  {
    v14 = 0;
  }

  v15 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v16 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v17 = [v16 isSemanticStyleControlVisible];

  v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v19 = [v18 isSmartStylePickerVisible];

  v20 = 0;
  if ((v11 & v12) == 1 && !v14 && v15 != 1 && (v17 & 1) == 0 && (v19 & 1) == 0)
  {
    v20 = [(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:v4];
  }

  return v20;
}

- (int64_t)_visibleSuggestionButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _isReconfiguring];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [(CAMViewfinderViewController *)self _shouldShowAutoMacroButtonForGraphConfiguration:v4];
  if (v7 && v5)
  {
    v7 = [v6 visibleSuggestionButtonType] == 1;
  }

  v8 = [(CAMViewfinderViewController *)self _resolvedMacroMode];
  v9 = [(CAMViewfinderViewController *)self _shouldShowDepthSuggestionButtonForGraphConfiguration:v4];
  if (v9 && v5)
  {
    v9 = [v6 visibleSuggestionButtonType] == 2;
  }

  v10 = v7;
  if (v9)
  {
    v10 = 2;
  }

  if (v7 && v8 == 1)
  {
    v11 = 1;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (BOOL)_shouldHideControlStatusIndicatorsForCommonStateForType:(unint64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v7 = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v9 = (-[CAMViewfinderViewController _isCapturingFromTimer](self, "_isCapturingFromTimer") || ([v5 isCapturingBurst] & 1) != 0 || objc_msgSend(v5, "isCapturingVideo") && ((v8 = objc_msgSend(v5, "videoCapturePaused"), a3) || !v8) || (objc_msgSend(v5, "isCapturingTimelapse") & 1) != 0 || ((objc_msgSend(v5, "isCapturingPanorama") | v7) & 1) != 0) && !v6;

  return v9;
}

- (BOOL)_shouldHideBadgesForGraphConfiguration:(id)a3
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis]|| ([(CAMViewfinderViewController *)self chromeTopBarMenuState]== 3 || [(CAMViewfinderViewController *)self chromeTopBarMenuState]== 2) && ![(CAMViewfinderViewController *)self _currentHalfPressSpotlight])
  {
    return 1;
  }

  if (![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded])
  {
    return 0;
  }

  v4 = [(CAMViewfinderViewController *)self _motionController];
  v5 = ([v4 captureOrientation] - 3) < 2;

  return v5;
}

- (BOOL)_shouldShowIndicatorOfType:(unint64_t)a3 forGraphConfiguration:(id)a4
{
  v6 = a4;
  if ([(CAMViewfinderViewController *)self _shouldHideControlStatusIndicatorsForCommonStateForType:a3])
  {
    v7 = 0;
  }

  else
  {
    switch(a3)
    {
      case 0uLL:
        if ([(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:v6])
        {
          goto LABEL_49;
        }

        goto LABEL_51;
      case 1uLL:
        if (![(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 2uLL:
        if (![(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:v6]|| ![(CAMViewfinderViewController *)self _wantsHDRControlsVisible]|| [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 3uLL:
        v12 = +[CAMCaptureCapabilities capabilities];
        if (([v12 isTimerSupportedForMode:{objc_msgSend(v6, "mode")}] & 1) == 0)
        {
          goto LABEL_50;
        }

        v13 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];

        if (!v13)
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 4uLL:
        v8 = [v6 mode];
        v9 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v8];
        v10 = [CAMUserPreferences defaultFilterTypeForMode:v8];
        v11 = 0;
        if (![(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:v6]|| v9 == v10)
        {
          goto LABEL_52;
        }

        goto LABEL_49;
      case 5uLL:
        v24 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:v6];
        [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
        v26 = v25;
        [(CAMViewfinderViewController *)self _portraitModeApertureValue];
        v28 = vabdd_f64(v26, v27) < 0.0001;
        v29 = +[CAMCaptureCapabilities capabilities];
        v30 = [v6 mode];
        v31 = [v6 devicePosition];
        v32 = [(CAMViewfinderViewController *)self currentPhotoFormat];
        LODWORD(v30) = [v29 isDepthSuggestionSupportedForMode:v30 devicePosition:v31 photoFormat:v32, v33];

        v11 = 0;
        if ((v28 & v30 & 1) != 0 || v24)
        {
          goto LABEL_52;
        }

        goto LABEL_49;
      case 6uLL:
        if ([(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 7uLL:
        -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), [v6 trueVideoEnabled]);
        v15 = v14;
        v16 = +[CAMUserPreferences preferences];
        v17 = [v16 preserveExposure];

        v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v19 = [v18 isExposureSliderVisible];

        v20 = [(CAMViewfinderViewController *)self _isExposureBiasNonDefault:v15];
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 isExposureSliderSupportedForMode:{objc_msgSend(v6, "mode")}];

        if (v17 & 1 | ((v22 & 1) == 0))
        {
          v23 = v22;
        }

        else
        {
          v23 = v19 | v20;
        }

        if ((v23 & 1) == 0)
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 8uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowVideoConfigurationIndicatorForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 9uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowNightModeControlForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xAuLL:
        v34 = [(CAMViewfinderViewController *)self _semanticStyleForPreview];
        v12 = v34;
        if (v34)
        {
          v35 = [v34 isNeutral] ^ 1;
        }

        else
        {
          LOBYTE(v35) = 0;
        }

        v36 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v37 = [v36 isSemanticStyleControlVisible];

        if ([(CAMViewfinderViewController *)self _shouldShowSemanticStyleControlForGraphConfiguration:v6])
        {

          if ((v35 | v37))
          {
LABEL_49:
            v11 = [(CAMViewfinderViewController *)self _canShowIndicatorDuringTrueVideoRecordingForType:a3 withGraphConfiguration:v6];
            goto LABEL_52;
          }
        }

        else
        {
LABEL_50:
        }

LABEL_51:
        v11 = 0;
LABEL_52:
        v38 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v39 = [v38 smartStyleControlsVisible] ^ 1;

        if (a3 == 11)
        {
          v40 = 1;
        }

        else
        {
          v40 = v39;
        }

        v7 = v40 & v11;
        break;
      case 0xBuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowSmartStyleIndicatorForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xCuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xDuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xEuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowSharedLibraryIndicatorForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xFuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowVideoStabilizationButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0x10uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:v6])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      default:
        goto LABEL_51;
    }
  }

  return v7;
}

- (BOOL)_canShowIndicatorDuringTrueVideoRecordingForType:(unint64_t)a3 withGraphConfiguration:(id)a4
{
  v5 = [a4 trueVideoEnabled] ^ 1;
  if (a3 == 8)
  {
    return 1;
  }

  else
  {
    return v5;
  }
}

- (BOOL)_shouldShowDrawerControlOfType:(int64_t)a3 forGraphConfiguration:(id)a4
{
  v6 = a4;
  switch(a3)
  {
    case 0:
      v7 = [(CAMViewfinderViewController *)self _shouldHideFlashButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 1:
      v7 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 2:
      v7 = [(CAMViewfinderViewController *)self _shouldHideAspectRatioControlForGraphConfiguration:v6];
      goto LABEL_16;
    case 3:
      v7 = [(CAMViewfinderViewController *)self _shouldHideTimerButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 4:
      v7 = [(CAMViewfinderViewController *)self _shouldHideFilterButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 5:
      v7 = [(CAMViewfinderViewController *)self _shouldHideHDRButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 6:
      v7 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:v6];
      goto LABEL_16;
    case 7:
      v7 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:v6];
LABEL_16:
      v9 = !v7;
      break;
    case 8:
      v8 = [(CAMViewfinderViewController *)self _shouldShowExposureButtonForGraphConfiguration:v6];
      goto LABEL_19;
    case 9:
      v8 = [(CAMViewfinderViewController *)self _shouldShowNightModeControlForGraphConfiguration:v6];
      goto LABEL_19;
    case 10:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSemanticStyleControlForGraphConfiguration:v6];
      goto LABEL_19;
    case 11:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSmartStyleControlForGraphConfiguration:v6];
      goto LABEL_19;
    case 12:
      v8 = [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:v6];
      goto LABEL_19;
    case 13:
      v8 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:v6];
      goto LABEL_19;
    case 14:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:v6];
      goto LABEL_19;
    case 15:
      v8 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationButtonForGraphConfiguration:v6];
LABEL_19:
      v9 = v8;
      break;
    default:
      v9 = 0;
      break;
  }

  return v9;
}

- (void)_hideControlsForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _motionController];
  v8 = [v7 captureOrientation];

  v9 = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v10 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:v6 orientation:v8];
  if (v4)
  {
    v11 = 0.25;
  }

  else
  {
    v11 = 0.0;
  }

  v35[0] = MEMORY[0x1E69E9820];
  v35[1] = 3221225472;
  v35[2] = __75__CAMViewfinderViewController__hideControlsForGraphConfiguration_animated___block_invoke;
  v35[3] = &unk_1E76F97C8;
  v35[4] = self;
  v12 = v6;
  v36 = v12;
  v37 = v8;
  v33 = v10;
  v34 = v9;
  v38 = v10;
  v39 = v9;
  [CAMView animateIfNeededWithDuration:v35 animations:v11];
  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v12 mode], 0, 1, v4);
  if ([(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v12 orientation:v8])
  {
    [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:1 animated:v4];
  }

  v13 = [(CAMViewfinderViewController *)self viewfinderView];
  v14 = MEMORY[0x1E695DFD8];
  v15 = [v13 visibleTopBadges];
  v16 = [v14 setWithArray:v15];

  v17 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v12];
  v18 = [(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:v12];
  v19 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v12];
  v20 = [MEMORY[0x1E695DF70] arrayWithCapacity:{objc_msgSend(v16, "count")}];
  if (!v17)
  {
    v21 = [(CAMViewfinderViewController *)self _livePhotoBadge];
    v22 = [v16 containsObject:v21];

    if (v22)
    {
      v23 = [(CAMViewfinderViewController *)self _livePhotoBadge];
      [v20 addObject:v23];
    }
  }

  if (!v18)
  {
    v24 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
    v25 = [v16 containsObject:v24];

    if (v25)
    {
      v26 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
      [v20 addObject:v26];
    }
  }

  if (!v19)
  {
    v27 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    v28 = [v16 containsObject:v27];

    if (v28)
    {
      v29 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
      [v20 addObject:v29];
    }
  }

  if (!v33 && !v34)
  {
    v30 = [(CAMViewfinderViewController *)self _lightingNameBadge];
    v31 = [v16 containsObject:v30];

    if (v31)
    {
      v32 = [(CAMViewfinderViewController *)self _lightingNameBadge];
      [v20 addObject:v32];
    }
  }

  [v13 setVisibleTopBadges:v20 animated:v4];
}

void __75__CAMViewfinderViewController__hideControlsForGraphConfiguration_animated___block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1640) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1632) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1648) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1656) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)])
  {
    [*(*(a1 + 32) + 1728) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1672) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1680) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHidePortraitModeInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1760) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowCleanLensesInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1768) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideQRCodeInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1792) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)])
  {
    v2 = [*(a1 + 32) viewfinderView];
    v3 = [v2 flipButton];
    [v3 setAlpha:0.0];

    v4 = [*(a1 + 32) _bottomBar];
    v5 = [v4 flipButton];
    [v5 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)])
  {
    v6 = [*(a1 + 32) _bottomBar];
    v7 = [v6 modeDial];
    [v7 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1816) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1832) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1856) setAlpha:0.0];
  }

  v8 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if (v8)
  {
    [*(*(a1 + 32) + 1864) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1936) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1712) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)])
  {
    v9 = [*(a1 + 32) _panoramaViewController];
    v10 = [v9 view];
    [v10 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1888) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)])
  {
    v11 = [*(a1 + 32) viewfinderView];
    v12 = [v11 zoomControl];
    [v12 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1960) setAlpha:0.0];
  }

  if (*(a1 + 56) == 1 && *(a1 + 57) == 1)
  {
    [*(*(a1 + 32) + 1968) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1904) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1912) setAlpha:0.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if ([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1920) setAlpha:0.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if ([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1984) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1664) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1880) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v13 = [*(a1 + 32) _bottomBar];
    v14 = [v13 imageAnalysisButton];
    [v14 setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel] & 1) == 0)
  {
    v15 = [*(a1 + 32) _imageAnalysisInstructionLabel];
    [v15 setAlpha:0.0];
  }

  v16 = [*(a1 + 32) chromeConfigurator];
  [v16 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setIsPortraitEffectIntensitySliderSupported:v8 ^ 1u];
}

- (void)_showControlsForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _motionController];
  v8 = [v7 captureOrientation];

  v9 = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v10 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:v6 orientation:v8];
  if (v4)
  {
    v11 = 0.25;
  }

  else
  {
    v11 = 0.0;
  }

  v42[0] = MEMORY[0x1E69E9820];
  v42[1] = 3221225472;
  v42[2] = __75__CAMViewfinderViewController__showControlsForGraphConfiguration_animated___block_invoke;
  v42[3] = &unk_1E76F97C8;
  v42[4] = self;
  v12 = v6;
  v43 = v12;
  v44 = v8;
  v39 = v10;
  v40 = v9;
  v45 = v10;
  v46 = v9;
  [CAMView animateIfNeededWithDuration:v42 animations:v11];
  if (![(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v12 orientation:v8])
  {
    [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:0 animated:v4];
  }

  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v12 mode], 1, 0, v4);
  v13 = [(CAMViewfinderViewController *)self viewfinderView];
  v14 = MEMORY[0x1E695DFD8];
  v15 = [v13 visibleTopBadges];
  v16 = [v14 setWithArray:v15];

  v17 = [(CAMViewfinderViewController *)self _livePhotoBadge];
  if (v17)
  {
    v18 = ![(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v12];
  }

  else
  {
    v18 = 0;
  }

  v41 = v4;

  v19 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  if (v19)
  {
    v20 = ![(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:v12];
  }

  else
  {
    v20 = 0;
  }

  v21 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  if (v21)
  {
    v22 = ![(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v12];
  }

  else
  {
    v22 = 0;
  }

  v23 = [(CAMViewfinderViewController *)self _lightingNameBadge];
  v24 = v23 == 0;

  v25 = [MEMORY[0x1E695DF70] arrayWithCapacity:{objc_msgSend(v16, "count")}];
  if ((v18 & 1) != 0 || (-[CAMViewfinderViewController _livePhotoBadge](self, "_livePhotoBadge"), v26 = objc_claimAutoreleasedReturnValue(), v27 = [v16 containsObject:v26], v26, v27))
  {
    v28 = [(CAMViewfinderViewController *)self _livePhotoBadge];
    [v25 addObject:v28];
  }

  v29 = v24 || v39;
  if ((v20 & 1) != 0 || (-[CAMViewfinderViewController _shallowDepthOfFieldBadge](self, "_shallowDepthOfFieldBadge"), v30 = objc_claimAutoreleasedReturnValue(), v31 = [v16 containsObject:v30], v30, v31))
  {
    v32 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
    [v25 addObject:v32];
  }

  if ((v22 & 1) != 0 || (-[CAMViewfinderViewController _focusAndExposureLockBadge](self, "_focusAndExposureLockBadge"), v33 = objc_claimAutoreleasedReturnValue(), v34 = [v16 containsObject:v33], v33, v34))
  {
    v35 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    [v25 addObject:v35];
  }

  if (!v29 && !v40 || (-[CAMViewfinderViewController _lightingNameBadge](self, "_lightingNameBadge"), v36 = objc_claimAutoreleasedReturnValue(), v37 = [v16 containsObject:v36], v36, v37))
  {
    v38 = [(CAMViewfinderViewController *)self _lightingNameBadge];
    [v25 addObject:v38];
  }

  [v13 setVisibleTopBadges:v25 animated:v41];
}

void __75__CAMViewfinderViewController__showControlsForGraphConfiguration_animated___block_invoke(uint64_t a1)
{
  if (([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1640) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1632) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1648) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1656) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1728) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1672) setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1680) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHidePortraitModeInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1760) setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowCleanLensesInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1768) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideQRCodeInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1792) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v2 = [*(a1 + 32) viewfinderView];
    v3 = [v2 flipButton];
    [v3 setAlpha:1.0];

    v4 = [*(a1 + 32) _bottomBar];
    v5 = [v4 flipButton];
    [v5 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v6 = [*(a1 + 32) _bottomBar];
    v7 = [v6 modeDial];
    [v7 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1816) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1832) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1856) setAlpha:1.0];
  }

  v8 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if ((v8 & 1) == 0)
  {
    [*(*(a1 + 32) + 1864) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1936) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1712) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v9 = [*(a1 + 32) _panoramaViewController];
    v10 = [v9 view];
    [v10 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1888) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v11 = [*(a1 + 32) viewfinderView];
    v12 = [v11 zoomControl];
    [v12 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1960) setAlpha:1.0];
  }

  if ((*(a1 + 56) & 1) == 0 && *(a1 + 57) == 1)
  {
    [*(*(a1 + 32) + 1968) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1904) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1912) setAlpha:1.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if (([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1920) setAlpha:1.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if (([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1984) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1664) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1880) setAlpha:1.0];
  }

  v13 = [*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)];
  if (v13)
  {
    [*(a1 + 32) _createImageAnalysisButtonIfNeededForConfiguration:*(a1 + 40)];
    v14 = [*(a1 + 32) _bottomBar];
    v15 = [v14 imageAnalysisButton];
    [v15 setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel])
  {
    v16 = [*(a1 + 32) _imageAnalysisInstructionLabel];
    [v16 setAlpha:1.0];
  }

  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setShouldShowImageAnalysisButton:v13];

  v19 = [*(a1 + 32) chromeConfigurator];
  [v19 setIsPortraitEffectIntensitySliderSupported:v8 ^ 1u];
}

- (void)updateControlVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _motionController];
  v7 = [v6 captureOrientation];

  if (v3)
  {
    v8 = 0.25;
  }

  else
  {
    v8 = 0.0;
  }

  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __63__CAMViewfinderViewController_updateControlVisibilityAnimated___block_invoke;
  v10[3] = &unk_1E76F97F0;
  v10[4] = self;
  v11 = v5;
  v12 = v7;
  v9 = v5;
  [CAMView animateIfNeededWithDuration:v10 animations:v8];
  [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:[(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v9 orientation:v7] animated:v3];
  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v9 mode], 1, 1, v3);
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:v3];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v9 animated:v3];
}

void __63__CAMViewfinderViewController_updateControlVisibilityAnimated___block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)])
  {
    v2 = 0.0;
  }

  else
  {
    v2 = 1.0;
  }

  [*(*(a1 + 32) + 1640) setAlpha:v2];
  if ([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)])
  {
    v3 = 0.0;
  }

  else
  {
    v3 = 1.0;
  }

  [*(*(a1 + 32) + 1632) setAlpha:v3];
  if ([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)])
  {
    v4 = 0.0;
  }

  else
  {
    v4 = 1.0;
  }

  [*(*(a1 + 32) + 1648) setAlpha:v4];
  if ([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)])
  {
    v5 = 0.0;
  }

  else
  {
    v5 = 1.0;
  }

  [*(*(a1 + 32) + 1656) setAlpha:v5];
  if ([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)])
  {
    v6 = 0.0;
  }

  else
  {
    v6 = 1.0;
  }

  [*(*(a1 + 32) + 1728) setAlpha:v6];
  if ([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)])
  {
    v7 = 0.0;
  }

  else
  {
    v7 = 1.0;
  }

  [*(*(a1 + 32) + 1672) setAlpha:v7];
  if ([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)])
  {
    v8 = 1.0;
  }

  else
  {
    v8 = 0.0;
  }

  [*(*(a1 + 32) + 1680) setAlpha:v8];
  if ([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)])
  {
    v9 = 0.0;
  }

  else
  {
    v9 = 1.0;
  }

  v10 = [*(a1 + 32) viewfinderView];
  v11 = [v10 flipButton];
  [v11 setAlpha:v9];

  v12 = [*(a1 + 32) _bottomBar];
  v13 = [v12 flipButton];
  [v13 setAlpha:v9];

  if ([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)])
  {
    v14 = 0.0;
  }

  else
  {
    v14 = 1.0;
  }

  v15 = [*(a1 + 32) _bottomBar];
  v16 = [v15 modeDial];
  [v16 setAlpha:v14];

  if ([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)])
  {
    v17 = 0.0;
  }

  else
  {
    v17 = 1.0;
  }

  [*(*(a1 + 32) + 1816) setAlpha:v17];
  if ([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)])
  {
    v18 = 0.0;
  }

  else
  {
    v18 = 1.0;
  }

  [*(*(a1 + 32) + 1832) setAlpha:v18];
  if ([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)])
  {
    v19 = 0.0;
  }

  else
  {
    v19 = 1.0;
  }

  [*(*(a1 + 32) + 1856) setAlpha:v19];
  v20 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if (v20)
  {
    v21 = 0.0;
  }

  else
  {
    v21 = 1.0;
  }

  [*(*(a1 + 32) + 1864) setAlpha:v21];
  if ([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)])
  {
    v22 = 0.0;
  }

  else
  {
    v22 = 1.0;
  }

  [*(*(a1 + 32) + 1936) setAlpha:v22];
  if ([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)])
  {
    v23 = 0.0;
  }

  else
  {
    v23 = 1.0;
  }

  [*(*(a1 + 32) + 1712) setAlpha:v23];
  if ([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)])
  {
    v24 = 0.0;
  }

  else
  {
    v24 = 1.0;
  }

  v25 = [*(a1 + 32) _panoramaViewController];
  v26 = [v25 view];
  [v26 setAlpha:v24];

  if ([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)])
  {
    v27 = 0.0;
  }

  else
  {
    v27 = 1.0;
  }

  [*(*(a1 + 32) + 1888) setAlpha:v27];
  if ([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)])
  {
    v28 = 0.0;
  }

  else
  {
    v28 = 1.0;
  }

  v29 = [*(a1 + 32) viewfinderView];
  v30 = [v29 zoomControl];
  [v30 setAlpha:v28];

  if ([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)])
  {
    v31 = 0.0;
  }

  else
  {
    v31 = 1.0;
  }

  [*(*(a1 + 32) + 1960) setAlpha:v31];
  if ([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)])
  {
    v32 = 0.0;
  }

  else
  {
    v32 = 1.0;
  }

  [*(*(a1 + 32) + 1904) setAlpha:v32];
  if ([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    v33 = 0.0;
  }

  else
  {
    v33 = 1.0;
  }

  [*(*(a1 + 32) + 1912) setAlpha:v33];
  if ([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    v34 = 0.0;
  }

  else
  {
    v34 = 1.0;
  }

  [*(*(a1 + 32) + 1920) setAlpha:v34];
  [*(a1 + 32) _updateLevelMotionTracking];
  if ([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)])
  {
    v35 = 0.0;
  }

  else
  {
    v35 = 1.0;
  }

  [*(*(a1 + 32) + 1984) setAlpha:v35];
  if ([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)])
  {
    v36 = 0.0;
  }

  else
  {
    v36 = 1.0;
  }

  [*(*(a1 + 32) + 1664) setAlpha:v36];
  if ([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)])
  {
    v37 = 0.0;
  }

  else
  {
    v37 = 1.0;
  }

  [*(*(a1 + 32) + 1880) setAlpha:v37];
  v38 = [*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)];
  if (v38)
  {
    v39 = 1.0;
  }

  else
  {
    v39 = 0.0;
  }

  v40 = [*(a1 + 32) _bottomBar];
  v41 = [v40 imageAnalysisButton];
  [v41 setAlpha:v39];

  if ([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel])
  {
    v42 = 1.0;
  }

  else
  {
    v42 = 0.0;
  }

  v43 = [*(a1 + 32) _imageAnalysisInstructionLabel];
  [v43 setAlpha:v42];

  v44 = [*(a1 + 32) chromeConfigurator];
  [v44 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v45 = [*(a1 + 32) chromeConfigurator];
  [v45 setShouldShowImageAnalysisButton:v38];

  v46 = [*(a1 + 32) chromeConfigurator];
  [v46 setIsPortraitEffectIntensitySliderSupported:v20 ^ 1u];
}

- (void)handleExternalChromeShutterControlChanged:(id)a3
{
  objc_storeStrong(&self->__dynamicShutterControl, a3);
  v6 = a3;
  [v6 setDelegate:self];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v5 isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:0];

  [(CAMViewfinderViewController *)self _updateShutterEffectsEnablementForSystemPressureState];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl convergeAllSprings];
}

- (void)handleExternalChromeFilterScrubberSelectedIndexChanged:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _filterTypeForItemIndex:a3];

  [(CAMViewfinderViewController *)self _applySelectedEffectFilterType:v4];
}

- (void)_updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v46 = a3;
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [(CAMViewfinderViewController *)self _isReconfiguring];
  v8 = [(CAMViewfinderViewController *)self _motionController];
  v9 = [v8 captureOrientation];

  v10 = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerForGraphConfiguration:v46];
  v11 = !v7;
  if (v10 && v7)
  {
    v10 = [v6 isControlDrawerVisible];
  }

  v12 = [(CAMViewfinderViewController *)self _shouldHideModeDialForGraphConfiguration:v46];
  if ((v12 | v11))
  {
    v13 = !v12;
  }

  else
  {
    v13 = [v6 isModeUIVisible];
  }

  [v6 setControlDrawerVisible:v10 modeUIVisible:v13 animated:v4];
  v14 = [(CAMViewfinderViewController *)self _shouldHideShutterButtonForGraphConfiguration:v46];
  if ((v14 | v11))
  {
    v15 = !v14;
  }

  else
  {
    v15 = [v6 isShutterButtonVisible];
  }

  [v6 setShutterControlVisible:v15 animated:v4];
  v16 = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerToggleForGraphConfiguration:v46 orientation:v9];
  if ((v16 & v7) == 1)
  {
    v17 = [v6 controlStatusBar];
    v16 = [v17 isDirectionIndicatorVisible];
  }

  v18 = [v6 controlStatusBar];
  [v18 setDirectionIndicatorVisible:v16 animated:v4];

  v19 = [(CAMViewfinderViewController *)self _shouldHideElapsedTimeViewForGraphConfiguration:v46 orientation:v9];
  if ((v19 | v11))
  {
    v20 = !v19;
  }

  else
  {
    v20 = [v6 isElapsedTimeViewVisible];
  }

  [v6 setElapsedTimeViewVisible:v20 animated:v4];
  v21 = [(CAMViewfinderViewController *)self _shouldHideTimerIndicatorViewForGraphConfiguration:v46];
  if ((v21 | v11))
  {
    v22 = !v21;
  }

  else
  {
    v22 = [v6 isTimerIndicatorVisible];
  }

  [v6 setTimerIndicatorVisible:v22 animated:v4];
  v23 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:v46];
  if ((v23 | v11))
  {
    v24 = !v23;
  }

  else
  {
    v24 = [v6 isPortraitControlsAllowed];
  }

  [v6 setPortraitControlsAllowed:v24 animated:v4];
  v25 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:v46];
  if ((v25 | v11))
  {
    v26 = !v25;
  }

  else
  {
    v26 = [v6 isZoomControlVisible];
  }

  [v6 setZoomControlVisible:v26 animated:v4];
  v27 = [(CAMViewfinderViewController *)self _shouldHideFlipButtonForGraphConfiguration:v46];
  if ((v27 | v11))
  {
    v28 = !v27;
  }

  else
  {
    v28 = [v6 isFlipButtonVisible];
  }

  [v6 setFlipButtonVisible:v28 animated:v4];
  v29 = [(CAMViewfinderViewController *)self _shouldShowImageAnalysisButtonForGraphConfiguration:v46];
  if (v29 && v7)
  {
    if (([v6 isImageAnalysisButtonVisible] & 1) == 0)
    {
LABEL_29:
      v30 = 0;
      goto LABEL_32;
    }
  }

  else if (!v29)
  {
    goto LABEL_29;
  }

  [(CAMViewfinderViewController *)self _createImageAnalysisButtonIfNeededForConfiguration:v46];
  v30 = 1;
LABEL_32:
  [v6 setImageAnalysisButtonVisible:v30 animated:v4];
  v31 = [(CAMViewfinderViewController *)self _shouldShowPhotoVideoModeSwitchForGraphConfiguration:v46];
  if ((v31 & v7) == 1)
  {
    v31 = [v6 isModeSwitchVisible];
  }

  [v6 setPhotoVideoModeSwitchVisible:v31 animated:v4];
  v32 = [(CAMViewfinderViewController *)self _shouldShowFlipAspectRatioButtonForGraphConfiguration:v46];
  if ((v32 & v7) == 1)
  {
    v32 = [v6 isFlipAspectRatioButtonVisible];
  }

  [v6 setFlipAspectRatioButtonVisible:v32 animated:v4];
  v33 = +[CAMCaptureCapabilities capabilities];
  v34 = [v33 isSmartFramingSupportedForMode:objc_msgSend(v46 devicePosition:{"mode"), objc_msgSend(v46, "devicePosition")}];

  v35 = -[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [v46 mode], objc_msgSend(v46, "devicePosition")));
  if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    v36 = +[CAMCaptureCapabilities capabilities];
    v37 = [v36 isSmartFramingSupportedForMode:-[CAMViewfinderViewController _trueVideoSourceCaptureMode](self devicePosition:{"_trueVideoSourceCaptureMode"), objc_msgSend(v46, "devicePosition")}];

    if (!v35)
    {
LABEL_38:
      v38 = 0;
      goto LABEL_41;
    }
  }

  else
  {
    v37 = 0;
    if (!v35)
    {
      goto LABEL_38;
    }
  }

  v38 = v34 | v37;
LABEL_41:
  [v6 setOffsetZoomButtonForFlipAspectRatioButton:v38 & 1 animated:v4];
  v39 = [(CAMViewfinderViewController *)self _visibleSuggestionButtonForGraphConfiguration:v46];
  [v6 setVisiblePreviewSuggestionButton:v39 animated:v4];
  [(CAMViewfinderViewController *)self _updateVisibleChromeSuggestionButton:v39];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  v40 = [v6 visibleInstructionLabel];
  v41 = [(CAMViewfinderViewController *)self _primaryInstructionLabelForGraphConfiguration:v46];
  if (v7 && v41 != v40)
  {
    v42 = 0;
  }

  else
  {
    v42 = v41;
  }

  v43 = [v6 visibleSecondaryInstructionLabel];
  v44 = [(CAMViewfinderViewController *)self _secondaryInstructionLabelForGraphConfiguration:v46];
  if (v7 && v44 != v43)
  {
    v45 = 0;
  }

  else
  {
    v45 = v44;
  }

  [v6 setVisibleInstructionLabel:v42 visibleSecondaryInstructionLabel:v45 animated:v4];
  [v6 setLightingNameBadgesHidden:-[CAMViewfinderViewController _shouldHideLightingNameBadgesForGraphConfiguration:](self animated:{"_shouldHideLightingNameBadgesForGraphConfiguration:", v46), v4}];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:v46 animated:v4];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v46 animated:v4];
}

- (void)_updateControlsRelatedToDepthSuggestionAnimated:(BOOL)a3
{
  v3 = a3;
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [(CAMViewfinderViewController *)self _visibleSuggestionButtonForGraphConfiguration:v7];
  [v5 setVisiblePreviewSuggestionButton:v6 animated:v3];
  [(CAMViewfinderViewController *)self _updateVisibleChromeSuggestionButton:v6];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:v7 animated:v3];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v7 animated:v3];
}

- (void)_updateVisibleChromeSuggestionButton:(int64_t)a3
{
  v4 = a3 != 2 && a3 == 1;
  v5 = a3 == 2;
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __68__CAMViewfinderViewController__updateVisibleChromeSuggestionButton___block_invoke;
  v7[3] = &unk_1E76F9818;
  v7[4] = self;
  v8 = v4;
  v9 = v5;
  [v6 performChanges:v7];
}

void __68__CAMViewfinderViewController__updateVisibleChromeSuggestionButton___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) chromeConfigurator];
  [v2 setIsAutoMacroButtonVisible:*(a1 + 40)];

  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setIsDepthButtonVisible:*(a1 + 41)];
}

- (void)_updateControlDrawerContentsVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:v5 animated:v3];
}

- (void)_updateControlDrawerContentsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v18 = a4;
  v25 = *MEMORY[0x1E69E9840];
  v5 = a3;
  v6 = [(CAMViewfinderViewController *)self _controlDrawer];
  v7 = MEMORY[0x1E695DFD8];
  v8 = [v6 visibleControlTypes];
  v9 = [v7 setWithArray:v8];

  v10 = [MEMORY[0x1E695DF70] array];
  v11 = [(CAMViewfinderViewController *)self _isReconfiguring];
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v19 = v5;
  v12 = [(CAMViewfinderViewController *)self _controlTypesForGraphConfiguration:v5];
  v13 = [v12 countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v21;
    do
    {
      v16 = 0;
      do
      {
        if (*v21 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v20 + 1) + 8 * v16);
        if (!v11 || [v9 containsObject:*(*(&v20 + 1) + 8 * v16)])
        {
          [v10 addObject:v17];
        }

        ++v16;
      }

      while (v14 != v16);
      v14 = [v12 countByEnumeratingWithState:&v20 objects:v24 count:16];
    }

    while (v14);
  }

  [v6 setVisibleControlTypes:v10 animated:v18];
  [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:v19];
}

- (id)_controlTypesForGraphConfiguration:(id)a3
{
  v18 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [MEMORY[0x1E695DF70] array];
  v13 = 0u;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v6 = [(CAMViewfinderViewController *)self _allControlDrawerTypes];
  v7 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v14;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v14 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = *(*(&v13 + 1) + 8 * i);
        if (-[CAMViewfinderViewController _shouldShowDrawerControlOfType:forGraphConfiguration:](self, "_shouldShowDrawerControlOfType:forGraphConfiguration:", [v11 integerValue], v4))
        {
          [v5 addObject:v11];
        }
      }

      v8 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v8);
  }

  return v5;
}

- (BOOL)shouldShowInstructionLabel
{
  if ([(CAMViewfinderViewController *)self chromeTopBarMenuState]&& [(CAMViewfinderViewController *)self chromeTopBarMenuState]!= 1)
  {
    return 0;
  }

  else
  {
    return ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }
}

- (int64_t)_primaryInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  if ([(CAMViewfinderViewController *)self shouldShowInstructionLabel])
  {
    if ([(CAMViewfinderViewController *)self _shouldShowImageAnalysisInstructionLabel])
    {
      v5 = 5;
    }

    else if ([(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible])
    {
      v5 = 3;
    }

    else if ([(CAMViewfinderViewController *)self _shouldHidePortraitModeInstructionLabelForGraphConfiguration:v4])
    {
      if ([(CAMViewfinderViewController *)self _shouldShowFlashCompromisedInstructionsForGraphConfiguration:v4])
      {
        v5 = 4;
      }

      else if ([(CAMViewfinderViewController *)self _shouldHideQRCodeInstructionLabelForGraphConfiguration:v4])
      {
        if ([(CAMViewfinderViewController *)self _shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:v4])
        {
          v5 = 7;
        }

        else if ([(CAMViewfinderViewController *)self _shouldShowSpatialCaptureInstructionsForGraphConfiguration:v4])
        {
          v5 = 8;
        }

        else if ([(CAMViewfinderViewController *)self _shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:v4])
        {
          v5 = 9;
        }

        else
        {
          v5 = 0;
        }
      }

      else
      {
        v5 = 2;
      }
    }

    else
    {
      v5 = 1;
    }
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (int64_t)_secondaryInstructionLabelForGraphConfiguration:(id)a3
{
  v4 = a3;
  if ([(CAMViewfinderViewController *)self shouldShowInstructionLabel])
  {
    if ([(CAMViewfinderViewController *)self _shouldShowFreeResourcesInstructionLabelForGraphConfiguration:v4])
    {
      v5 = 6;
    }

    else if ([(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:v4])
    {
      v5 = 10;
    }

    else
    {
      v5 = 0;
    }
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (BOOL)_isVideoStabilizationIndicatorPrimary
{
  v2 = +[CAMUserPreferences preferences];
  if ([v2 preserveExposure] & 1) != 0 || (objc_msgSend(v2, "isProResControlEnabled"))
  {
    LOBYTE(v3) = 0;
  }

  else
  {
    v3 = [v2 sharedLibraryEnabled] ^ 1;
  }

  return v3;
}

- (id)_primaryControlStatusIndicatorTypes
{
  v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithArray:&unk_1F16C92D8];
  if ([(CAMViewfinderViewController *)self _isVideoStabilizationIndicatorPrimary])
  {
    [v3 addObject:&unk_1F16C7850];
  }

  return v3;
}

- (id)_secondaryControlStatusIndicatorTypes
{
  v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithArray:&unk_1F16C92F0];
  if (![(CAMViewfinderViewController *)self _isVideoStabilizationIndicatorPrimary])
  {
    [v3 addObject:&unk_1F16C7850];
  }

  return v3;
}

- (void)_updateControlStatusBarContentsVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v5 animated:v3];
}

- (void)_updateControlStatusBarContentsVisibilityForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v23 = a4;
  v38 = *MEMORY[0x1E69E9840];
  v5 = a3;
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v6 controlStatusBar];

  v25 = [MEMORY[0x1E695DF70] array];
  v24 = [MEMORY[0x1E695DF70] array];
  v8 = ![(CAMViewfinderViewController *)self _isReconfiguring];
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  obj = [(CAMViewfinderViewController *)self _primaryControlStatusIndicatorTypes];
  v9 = [obj countByEnumeratingWithState:&v32 objects:v37 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v33;
    do
    {
      for (i = 0; i != v10; ++i)
      {
        if (*v33 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v32 + 1) + 8 * i);
        v14 = [v13 integerValue];
        v15 = [v7 isIndicatorDesiredForType:v14];
        if ([(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:v14 forGraphConfiguration:v5]&& ((v8 | v15) & 1) != 0)
        {
          [v25 addObject:v13];
        }
      }

      v10 = [obj countByEnumeratingWithState:&v32 objects:v37 count:16];
    }

    while (v10);
  }

  v30 = 0u;
  v31 = 0u;
  v28 = 0u;
  v29 = 0u;
  obja = [(CAMViewfinderViewController *)self _secondaryControlStatusIndicatorTypes];
  v16 = [obja countByEnumeratingWithState:&v28 objects:v36 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v29;
    do
    {
      for (j = 0; j != v17; ++j)
      {
        if (*v29 != v18)
        {
          objc_enumerationMutation(obja);
        }

        v20 = *(*(&v28 + 1) + 8 * j);
        v21 = [v20 integerValue];
        v22 = [v7 isIndicatorDesiredForType:v21];
        if ([(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:v21 forGraphConfiguration:v5]&& ((v8 | v22) & 1) != 0)
        {
          [v24 addObject:v20];
        }
      }

      v17 = [obja countByEnumeratingWithState:&v28 objects:v36 count:16];
    }

    while (v17);
  }

  [v7 setPrimaryDesiredIndicatorTypes:v25 secondaryDesiredIndicatorTypes:v24 animated:v23];
}

- (void)_updatePanoramaSizeIfNeededForGraphConfiguration:(id)a3
{
  v10 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPanoramaSupportedForDevice:{objc_msgSend(v10, "device")}];

  if (v5 && [v10 mode] == 3)
  {
    v6 = +[CAMPanoramaConfiguration sharedInstance];
    v7 = [v6 maxWidthForDevice:{objc_msgSend(v10, "device")}];
    v8 = [v6 sampleBufferWidth];
    v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v9 setPanoramaCaptureSize:{v7, v8}];
  }
}

- (int64_t)_zoomControlLayoutPositionForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v4]&& ![(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:v4])
  {
    v8 = [v4 mode];
    v9 = [v4 devicePosition];
    v10 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v5 isDepthSuggestionSupportedForMode:v8 devicePosition:v9 photoFormat:v10, v11])
    {
      v6 = 2;
    }

    else
    {
      v6 = 1;
    }
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (int64_t)_lightingControlLayoutPositionForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 devicePosition];

  v8 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(self) = [v5 isDepthSuggestionSupportedForMode:v6 devicePosition:v7 photoFormat:v8, v9];
  v10 = [v5 portraitInPhotoModeBehavior];
  if (self)
  {
    v11 = ~v10 & 2;
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (void)_updateZoomControlLayoutForGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4 animated:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:a4];
  v10 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v8];
  v11 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:v8];

  if (!v9 || v10)
  {
    v12 = v9 | ~v10;
    v13 = 0.0;
    if (v11 == 1)
    {
      v13 = 14.0;
    }

    if (v11 == 2)
    {
      v14 = -14.0;
    }

    else
    {
      v14 = v13;
    }

    v15 = [(CAMViewfinderViewController *)self _zoomControl];
    [v15 setEdgeMargin:v12 & v5 animated:v14];

    v16 = [(CAMViewfinderViewController *)self _zoomControl];
    [v16 setPlatterLayoutCompact:v14 != 0.0 animated:v12 & v5];
  }
}

- (void)_snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:(id)a3
{
  v10 = a3;
  if ([(CAMViewfinderViewController *)self _shouldHidePanoramaViewForGraphConfiguration:?])
  {
    v4 = [(CAMViewfinderViewController *)self _panoramaViewController];
    v5 = [v4 view];
    v6 = v5;
    if (v5)
    {
      [v5 alpha];
      if (v7 > 0.0)
      {
        [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:v6];
        v8 = [v6 instructionView];
        v9 = [v6 superview];
        [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:v8 parentViewOverride:v9 shouldHideView:0];
      }
    }
  }

  if ([(CAMViewfinderViewController *)self _shouldHidePortraitModeInstructionLabelForGraphConfiguration:v10])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__portraitModeInstructionLabel];
  }

  if (![(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:v10])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__cleanLensesInstructionLabel];
  }

  if ([(CAMViewfinderViewController *)self _shouldHideQRCodeInstructionLabelForGraphConfiguration:v10])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__qrCodeInstructionLabel];
  }

  if ([(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:v10])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__filterNameBadge];
  }
}

- (void)_snapshotAndFadeDisappearingView:(id)a3 parentViewOverride:(id)a4 shouldHideView:(BOOL)a5
{
  v7 = a3;
  v8 = a4;
  if (v7)
  {
    if (([v7 isHidden] & 1) == 0)
    {
      [v7 alpha];
      if (v9 != 0.0)
      {
        if (v8)
        {
          v10 = v8;
        }

        else
        {
          v10 = [v7 superview];
        }

        v11 = v10;
        v12 = [v7 snapshotViewAfterScreenUpdates:0];
        v13 = MEMORY[0x1E69DD250];
        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke;
        v22[3] = &unk_1E76F9840;
        v23 = v7;
        v24 = v11;
        v14 = v12;
        v25 = v14;
        v26 = a5;
        v15 = v11;
        [v13 performWithoutAnimation:v22];
        v16 = MEMORY[0x1E69DD250];
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke_2;
        v20[3] = &unk_1E76F77B0;
        v21 = v14;
        v18[0] = MEMORY[0x1E69E9820];
        v18[1] = 3221225472;
        v18[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke_3;
        v18[3] = &unk_1E76F7988;
        v19 = v21;
        v17 = v21;
        [v16 animateWithDuration:v20 animations:v18 completion:0.25];
      }
    }
  }
}

void __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) superview];
  [*(a1 + 32) center];
  [v2 convertPoint:*(a1 + 40) toView:?];
  v4 = v3;
  v6 = v5;
  v7 = *(a1 + 48);
  [*(a1 + 32) bounds];
  [v7 setBounds:?];
  [*(a1 + 48) setCenter:{v4, v6}];
  v8 = *(a1 + 48);
  v9 = *(a1 + 32);
  if (v9)
  {
    [v9 transform];
  }

  else
  {
    memset(v10, 0, sizeof(v10));
  }

  [v8 setTransform:v10];
  [*(a1 + 40) addSubview:*(a1 + 48)];
  if (*(a1 + 56) == 1)
  {
    [*(a1 + 32) setAlpha:0.0];
  }
}

- (void)_updateBadgeVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v35 = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v5];
  v7 = [(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:v5];
  v8 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v5];
  v9 = [(CAMViewfinderViewController *)self _motionController];
  v10 = -[CAMViewfinderViewController _shouldHideLightingNameBadgeForGraphConfiguration:orientation:](self, "_shouldHideLightingNameBadgeForGraphConfiguration:orientation:", v5, [v9 captureOrientation]);

  v11 = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v12 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryBadgeForGraphConfiguration:v5];
  v34 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationBadgeForGraphConfiguration:v5];
  v13 = [(CAMViewfinderViewController *)self _captureController];
  v33 = [v13 videoCapturePaused];

  v31 = [(CAMViewfinderViewController *)self _shouldShowTextBadgeForGraphConfiguration:v5];
  v32 = [(CAMViewfinderViewController *)self _shouldShowSpatialBadgeForGraphConfiguration:v5];
  v14 = [MEMORY[0x1E695DF70] array];
  if (!v6)
  {
    v15 = [(CAMViewfinderViewController *)self _livePhotoBadge];

    if (v15)
    {
      v16 = [(CAMViewfinderViewController *)self _livePhotoBadge];
      [v14 addObject:v16];
    }
  }

  if (!v7)
  {
    v17 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];

    if (v17)
    {
      v18 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
      [v14 addObject:v18];
    }
  }

  if (!v8)
  {
    v19 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];

    if (v19)
    {
      v20 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
      [v14 addObject:v20];
    }
  }

  if (!v10 && !v11)
  {
    v21 = [(CAMViewfinderViewController *)self _lightingNameBadge];

    if (v21)
    {
      v22 = [(CAMViewfinderViewController *)self _lightingNameBadge];
      [v14 addObject:v22];
    }
  }

  if (v12)
  {
    v23 = [(CAMViewfinderViewController *)self _sharedLibraryBadge];

    if (v23)
    {
      v24 = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
      [v14 addObject:v24];
    }
  }

  [v35 setVisibleTopBadges:v14 animated:v3];
  if (v3)
  {
    v25 = 0.25;
  }

  else
  {
    v25 = 0.0;
  }

  v36[0] = MEMORY[0x1E69E9820];
  v36[1] = 3221225472;
  v36[2] = __62__CAMViewfinderViewController__updateBadgeVisibilityAnimated___block_invoke;
  v36[3] = &unk_1E76F9868;
  v36[4] = self;
  v37 = v5;
  v38 = v11;
  v39 = v10;
  v26 = v5;
  [CAMView animateIfNeededWithDuration:v36 animations:v25];
  v27 = 128;
  if (!v31)
  {
    v27 = 0;
  }

  if (!v8)
  {
    v27 |= 2uLL;
  }

  if (v34)
  {
    v27 |= 8uLL;
  }

  if (v33)
  {
    v27 |= 0x10uLL;
  }

  if (v32)
  {
    v28 = v27 | 0x40;
  }

  else
  {
    v28 = v27;
  }

  v29 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v30 = [v29 badgeTray];
  [v30 setVisibleBadges:v28 animated:v3];
}

uint64_t __62__CAMViewfinderViewController__updateBadgeVisibilityAnimated___block_invoke(uint64_t a1)
{
  [*(*(a1 + 32) + 1760) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHidePortraitModeInstructionLabelForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  [*(*(a1 + 32) + 1768) setAlpha:{objc_msgSend(*(a1 + 32), "_shouldShowCleanLensesInstructionLabelForGraphConfiguration:", *(a1 + 40))}];
  [*(*(a1 + 32) + 1792) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHideQRCodeInstructionLabelForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  result = [*(*(a1 + 32) + 1712) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHideFilterNameBadgeForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  if (*(a1 + 48) == 1)
  {
    v3 = (*(a1 + 49) ^ 1u);
    v4 = *(*(a1 + 32) + 1968);

    return [v4 setAlpha:v3];
  }

  return result;
}

- (void)_forceHideBadgesAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  [v5 setVisibleTopBadges:MEMORY[0x1E695E0F0] animated:v3];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v6 badgeTray];
  [v7 setVisibleBadges:0 animated:v3];

  v8 = 0.25;
  if (!v3)
  {
    v8 = 0.0;
  }

  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __56__CAMViewfinderViewController__forceHideBadgesAnimated___block_invoke;
  v9[3] = &unk_1E76F77B0;
  v9[4] = self;
  [CAMView animateIfNeededWithDuration:v9 animations:v8];
}

uint64_t __56__CAMViewfinderViewController__forceHideBadgesAnimated___block_invoke(uint64_t a1)
{
  [*(*(a1 + 32) + 1760) setAlpha:0.0];
  [*(*(a1 + 32) + 1768) setAlpha:0.0];
  v2 = *(*(a1 + 32) + 1792);

  return [v2 setAlpha:0.0];
}

- (void)_updateUIForCapturing:(BOOL)a3 animated:(BOOL)a4 updateProResControls:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v7 = a3;
  [(CAMViewfinderViewController *)self setNeedsUpdateOfSupportedInterfaceOrientations];
  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
  v23 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v23 mode];
  if (v5)
  {
    [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v6];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:v6];
  if (!-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v10 = objc_claimAutoreleasedReturnValue(), v11 = [v10 isSpatialModeTrueVideoSupported], v10, v11))
  {
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v23 animated:v6];
  }

  [(CAMViewfinderViewController *)self _setSwipeToModeSwitchEnabled:[(CAMViewfinderViewController *)self _shouldEnableSwipeToModeSwitch]];
  [(CAMViewfinderViewController *)self _updateTopBarStyleForGraphConfiguration:v23 capturing:v7 animated:v6];
  if (![(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
  {
    if (v6)
    {
      v12 = 3;
    }

    else
    {
      v12 = 0;
    }

    v13 = [(CAMViewfinderViewController *)self _zoomControl];
    [v13 setShouldShowZoomDial:0 animationDuration:v12];
  }

  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v23 isCapturing:v7 animated:v6];
  if (v9 <= 8)
  {
    if (((1 << v9) & 0x186) != 0)
    {
      if (v7)
      {
        v14 = [(CAMViewfinderViewController *)self _previewViewController];
LABEL_24:
        [v14 notifyWillStartCapturing];
        v21 = [(CAMViewfinderViewController *)self _remoteShutterController];
        [v21 willStartCapturing];
        goto LABEL_26;
      }

      goto LABEL_21;
    }

    if (v9)
    {
      if (v9 != 3)
      {
        goto LABEL_23;
      }

      v15 = [(CAMViewfinderViewController *)self _panoramaViewController];
      v16 = v15;
      if (v7)
      {
        [v15 startPainting];
      }

      else
      {
        [v15 stopPainting];
      }

      goto LABEL_22;
    }

    v17 = +[CAMCaptureCapabilities capabilities];
    v18 = [v17 isLongPressVideoCaptureFromPhotoModeSupported];

    if (v18 && !v7)
    {
LABEL_21:
      v16 = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
      [v16 endTimer];
      [v16 setBackgroundStyle:-[CAMViewfinderViewController _elapsedTimeViewIdleBackgroundStyle](self animated:{"_elapsedTimeViewIdleBackgroundStyle"), 1}];
      v19 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v19 setSpatialCaptureRecordingIndicatorVisible:0 animated:1];

LABEL_22:
    }
  }

LABEL_23:
  v20 = [(CAMViewfinderViewController *)self _previewViewController];
  v14 = v20;
  if (v7)
  {
    goto LABEL_24;
  }

  [v20 notifyDidStopCapture];
  v22 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v22 didStopCapture];

  v21 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v21 setPausedDuringVideo:0 animated:v6];
LABEL_26:

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (int64_t)_elapsedTimeViewIdleBackgroundStyle
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _motionController];
    v5 = ([v4 captureOrientation] - 3) < 2;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _layoutStyle]== 1;
  }

  if (v5)
  {
    return 3;
  }

  else
  {
    return 0;
  }
}

- (void)_collapseExpandedButtonsAnimated:(BOOL)a3
{
  v3 = a3;
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v7 controlDrawer];
  [v5 collapseExpandableButtonsAnimated:v3 updatePreferredDrawerControl:0];

  v6 = [v7 controlStatusBar];
  [v6 collapseExpandedIndicatorAnimated:v3];

  [(CAMExpandableMenuButton *)self->__flashButton collapseMenuAnimated:v3];
  [(CAMExpandableMenuButton *)self->__HDRButton collapseMenuAnimated:v3];
  [(CAMExpandableMenuButton *)self->__timerButton collapseMenuAnimated:v3];
  [(CAMExpandableMenuButton *)self->__livePhotoButton collapseMenuAnimated:v3];
  [(CAMExpandableMenuButton *)self->__sharedLibraryButton collapseMenuAnimated:v3];
}

- (void)_startTimer:(unint64_t)a3
{
  +[CAMLivePhotoButton enablingAnimationDuration];
  if (a3 - 3 > 2)
  {
    v6 = v5;
  }

  else
  {
    v6 = dbl_1A3A683B0[a3 - 3];
  }

  v7 = [(CAMViewfinderViewController *)self _timerCache];
  v8 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:a3];
  [v7 startTimerForKey:v8 duration:v6];

  [(CAMViewfinderViewController *)self _didStartTimer:a3];
}

- (void)_didStartTimer:(unint64_t)a3
{
  if (!a3)
  {
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  }
}

- (void)timerCache:(id)a3 timerDidFireForKey:(id)a4
{
  v6 = a4;
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  v5 = [v6 unsignedIntegerValue];
  switch(v5)
  {
    case 5:
      [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
      break;
    case 4:
      [(CAMViewfinderViewController *)self _dismissDocumentScanningButton];
      break;
    case 3:
      [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
      break;
  }
}

- (BOOL)shouldHideFlashButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideFlashButtonForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideHDRButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideHDRButtonForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideTimerButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideTimerButtonForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideFlipButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideFlipButtonForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideLivePhotoButton
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideLivePhotoButtonForGraphConfiguration:v3];

  return v2;
}

- (BOOL)shouldHideCleanLensInstructionLabel
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldShowCleanLensesInstructionLabelForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (BOOL)shouldHideLightingNameBadgeForOrientation:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(a3) = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:v5 orientation:a3];

  return a3;
}

- (BOOL)_shouldEnableAspectRatioButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableIntensityButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableExposureControlButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableVideoConfigurationControl
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isConfigurationAvailable];

  v4 = +[CAMUserPreferences preferences];
  if ([v4 isVideoConfigurationControlEnabled])
  {
    v5 = 1;
  }

  else
  {
    v6 = +[CAMCaptureCapabilities capabilities];
    v5 = [v6 interactiveVideoFormatControlAlwaysEnabled];
  }

  return v3 & v5;
}

- (BOOL)_shouldEnableRAWButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnablePhotoFormatButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableProResButton
{
  v3 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 isCapturingNightModeImage];

  return ((v3 | v5) & 1) == 0;
}

- (BOOL)_shouldEnableVideoStabilizationButton
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isConfigurationAvailable];

  return v3;
}

- (BOOL)_shouldEnableApertureButton
{
  v3 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v4 = [(CAMViewfinderViewController *)self _isModeDisabled];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCapturingNightModeImage];

  return (((v3 || v4) | v6) & 1) == 0;
}

- (BOOL)_shouldEnableNightModeControl
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldEnableSemanticStyleControl
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldEnableSmartStyleControl
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldEnableSmartStylesSwipeGestures
{
  if ([(CAMViewfinderViewController *)self _currentHalfPressSpotlight])
  {
    return 0;
  }

  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 isSmartStylePickerVisible];

  return v5;
}

- (BOOL)_shouldEnableControlDrawerToggle
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldEnableTextAnalysisButton
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldEnableSharedLibraryButton
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingNightModeImage];

  return v3 ^ 1;
}

- (BOOL)_shouldShowSharedLibraryButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 sharedLibrarySwitchEnabled];

  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [v7 isCapturingVideo];

  v12 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  v9 = [(CAMViewfinderViewController *)self _topBar];
  v10 = [v9 sharedLibraryButton];

  v11 = v12 == v10;
  LOBYTE(v12) = (v12 != v10) & v6;
  if (v11 && (v6 & 1) != 0)
  {
    v13 = [(CAMViewfinderViewController *)self _topBar];
    LODWORD(v12) = [v13 shouldHideSharedLibraryButtonForGraphConfiguration:v4] ^ 1;
  }

  return v12 & (v8 ^ 1);
}

- (BOOL)_shouldEnableDrawerControl:(int64_t)a3
{
  switch(a3)
  {
    case 0:
      result = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
      break;
    case 1:
      result = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
      break;
    case 2:
      result = [(CAMViewfinderViewController *)self _shouldEnableAspectRatioButton];
      break;
    case 3:
      result = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
      break;
    case 4:
      result = [(CAMViewfinderViewController *)self _shouldEnableFilterButton];
      break;
    case 5:
      result = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
      break;
    case 6:
      result = [(CAMViewfinderViewController *)self _shouldEnableApertureButton];
      break;
    case 7:
      result = [(CAMViewfinderViewController *)self _shouldEnableIntensityButton];
      break;
    case 8:
      result = [(CAMViewfinderViewController *)self _shouldEnableExposureControlButton];
      break;
    case 9:
      result = [(CAMViewfinderViewController *)self _shouldEnableNightModeControl];
      break;
    case 10:
      result = [(CAMViewfinderViewController *)self _shouldEnableSemanticStyleControl];
      break;
    case 11:
      result = [(CAMViewfinderViewController *)self _shouldEnableSmartStyleControl];
      break;
    case 12:
      result = [(CAMViewfinderViewController *)self _shouldEnableRAWButton];
      break;
    case 13:
      result = [(CAMViewfinderViewController *)self _shouldEnableProResButton];
      break;
    case 14:
      result = [(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton];
      break;
    case 15:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoStabilizationButton];
      break;
    default:
      result = 0;
      break;
  }

  return result;
}

- (BOOL)_shouldEnableControlStatusIndicator:(unint64_t)a3
{
  switch(a3)
  {
    case 0uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
      break;
    case 1uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
      break;
    case 2uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
      break;
    case 3uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
      break;
    case 4uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableFilterButton];
      break;
    case 5uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableApertureButton];
      break;
    case 6uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableIntensityButton];
      break;
    case 7uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableExposureControlButton];
      break;
    case 8uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoConfigurationControl];
      break;
    case 9uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableNightModeControl];
      break;
    case 0xAuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSemanticStyleControl];
      break;
    case 0xBuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSmartStyleControl];
      break;
    case 0xCuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableRAWButton];
      break;
    case 0xDuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableProResButton];
      break;
    case 0xEuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton];
      break;
    case 0xFuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoStabilizationButton];
      break;
    case 0x10uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnablePhotoFormatButton];
      break;
    default:
      result = 0;
      break;
  }

  return result;
}

- (void)_updateEnabledControlsWithReason:(id)a3 forceLog:(BOOL)a4
{
  v79 = a4;
  v93 = *MEMORY[0x1E69E9840];
  v80 = a3;
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [v5 controlDrawer];
  v78 = v5;
  v7 = [v5 controlStatusBar];
  v8 = [(CAMViewfinderViewController *)self _shouldEnableControlDrawerToggle];
  v9 = [v7 directionIndicator];
  [v9 setEnabled:v8];

  v10 = [(CAMViewfinderViewController *)self _primaryControlStatusIndicatorTypes];
  v11 = [(CAMViewfinderViewController *)self _secondaryControlStatusIndicatorTypes];
  v12 = [v10 arrayByAddingObjectsFromArray:v11];

  v87 = 0u;
  v88 = 0u;
  v85 = 0u;
  v86 = 0u;
  v13 = v12;
  v14 = [v13 countByEnumeratingWithState:&v85 objects:v92 count:16];
  if (v14)
  {
    v15 = v14;
    v16 = *v86;
    do
    {
      for (i = 0; i != v15; ++i)
      {
        if (*v86 != v16)
        {
          objc_enumerationMutation(v13);
        }

        v18 = [*(*(&v85 + 1) + 8 * i) integerValue];
        v19 = [(CAMViewfinderViewController *)self _shouldEnableControlStatusIndicator:v18];
        v20 = [v7 indicatorForType:v18];
        [v20 setEnabled:v19];
      }

      v15 = [v13 countByEnumeratingWithState:&v85 objects:v92 count:16];
    }

    while (v15);
  }

  v83 = 0u;
  v84 = 0u;
  v81 = 0u;
  v82 = 0u;
  v21 = [(CAMViewfinderViewController *)self _allControlDrawerTypes];
  v22 = [v21 countByEnumeratingWithState:&v81 objects:v91 count:16];
  if (v22)
  {
    v23 = v22;
    v24 = *v82;
    do
    {
      for (j = 0; j != v23; ++j)
      {
        if (*v82 != v24)
        {
          objc_enumerationMutation(v21);
        }

        v26 = [*(*(&v81 + 1) + 8 * j) integerValue];
        v27 = [(CAMViewfinderViewController *)self _shouldEnableDrawerControl:v26];
        v28 = [v6 buttonForType:v26];
        [v28 setEnabled:v27];
      }

      v23 = [v21 countByEnumeratingWithState:&v81 objects:v91 count:16];
    }

    while (v23);
  }

  v76 = [(CAMFlashButton *)self->__flashButton isEnabled];
  v75 = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
  v74 = [(CAMHDRButton *)self->__HDRButton isEnabled];
  v73 = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
  v72 = [(CAMTimerButton *)self->__timerButton isEnabled];
  v71 = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
  v70 = [(CAMLivePhotoButton *)self->__livePhotoButton isEnabled];
  v69 = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
  v68 = [(CAMFlipButton *)self->__flipButton isEnabled];
  v67 = [(CAMViewfinderViewController *)self _shouldEnableFlipButton];
  v29 = [(CAMDynamicShutterControl *)self->__dynamicShutterControl isEnabled];
  v77 = v29 ^ [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  v66 = [(CUShutterButton *)self->__stillDuringVideoButton isEnabled];
  v65 = [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  v64 = [(CAMModeDial *)self->__modeDial isEnabled];
  v63 = [(CAMViewfinderViewController *)self _shouldEnableModeDial];
  v62 = [(CAMZoomSlider *)self->__zoomSlider isEnabled];
  v61 = [(CAMViewfinderViewController *)self _shouldEnableZoomSlider];
  v60 = [(CAMZoomControl *)self->__zoomControl isEnabled];
  v59 = [(CAMViewfinderViewController *)self _shouldEnableZoomControl];
  [(CAMFlashButton *)self->__flashButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableFlashButton]];
  [(CAMHDRButton *)self->__HDRButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableHDRButton]];
  [(CAMTimerButton *)self->__timerButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableTimerButton]];
  [(CAMLivePhotoButton *)self->__livePhotoButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton]];
  [(CAMSharedLibraryButton *)self->__sharedLibraryButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton]];
  [(CAMFlipButton *)self->__flipButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableFlipButton]];
  [(CUShutterButton *)self->__shutterButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CUShutterButton *)self->__shutterButton setShowDisabled:[(CAMViewfinderViewController *)self _shouldShowShutterButtonDisabled]];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl setShowDisabled:[(CAMViewfinderViewController *)self _shouldShowShutterButtonDisabled] animated:1];
  [(CUShutterButton *)self->__stillDuringVideoButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CEKApertureButton *)self->__apertureButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableApertureButton]];
  [(CAMModeDial *)self->__modeDial setEnabled:[(CAMViewfinderViewController *)self _shouldEnableModeDial]];
  [(CAMZoomSlider *)self->__zoomSlider setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomSlider]];
  [(CAMZoomControl *)self->__zoomControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomControl]];
  [(CAMVideoConfigurationStatusIndicator *)self->__videoConfigurationStatusIndicator setEnabled:[(CAMViewfinderViewController *)self _shouldEnableVideoConfigurationControl]];
  v30 = [(CAMViewfinderViewController *)self _shouldEnableTextAnalysisButton];
  v31 = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [v31 setEnabled:v30];

  [(CAMViewfinderViewController *)self _setSwipeToModeSwitchEnabled:[(CAMViewfinderViewController *)self _shouldEnableSwipeToModeSwitch]];
  v32 = [(CAMViewfinderViewController *)self _shouldEnableSmartStylesSwipeGestures];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setEnabled:v32];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setEnabled:v32];
  v33 = v80;
  if (self->_userInteractionLoggingEnabled)
  {
    v34 = v70 ^ v69;
    if (v76 != v75)
    {
      goto LABEL_17;
    }

    if (!v79)
    {
      if (((v74 ^ v73) & 1) == 0)
      {
LABEL_32:
        if ((v72 ^ v71))
        {
          goto LABEL_37;
        }

        if (!v79)
        {
          v33 = v80;
          v40 = v62 ^ v61;
          v41 = v64 ^ v63;
          if ((v34 & 1) == 0)
          {
            goto LABEL_48;
          }

          goto LABEL_45;
        }

LABEL_34:
        if (([(CAMTimerButton *)self->__timerButton isEnabled]& 1) != 0)
        {
          v33 = v80;
          v40 = v62 ^ v61;
          v41 = v64 ^ v63;
          if (v34)
          {
LABEL_45:
            v45 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
            {
              v46 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__livePhotoButton withReason:v33];
              *buf = 138543362;
              v90 = v46;
              _os_log_impl(&dword_1A3640000, v45, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

LABEL_48:
            if (((v68 ^ v67) & 1) == 0)
            {
              if (!v79)
              {
                if ((v66 ^ v65))
                {
LABEL_61:
                  v49 = os_log_create("com.apple.camera", "ControlEnablement");
                  if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
                  {
                    v50 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__stillDuringVideoButton withReason:v33];
                    *buf = 138543362;
                    v90 = v50;
                    _os_log_impl(&dword_1A3640000, v49, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                  }

                  goto LABEL_64;
                }

                goto LABEL_64;
              }

              goto LABEL_50;
            }

            goto LABEL_53;
          }

LABEL_41:
          if (([(CAMLivePhotoButton *)self->__livePhotoButton isEnabled]& 1) != 0)
          {
            if (((v68 ^ v67) & 1) == 0)
            {
LABEL_50:
              if (([(CAMFlipButton *)self->__flipButton isEnabled]& 1) != 0)
              {
                if ((v66 ^ v65))
                {
                  goto LABEL_61;
                }

LABEL_57:
                if (([(CUShutterButton *)self->__stillDuringVideoButton isEnabled]& 1) != 0)
                {
                  if (v41)
                  {
                    goto LABEL_69;
                  }

                  goto LABEL_66;
                }

                goto LABEL_61;
              }
            }

LABEL_53:
            v47 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
            {
              v48 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__flipButton withReason:v33];
              *buf = 138543362;
              v90 = v48;
              _os_log_impl(&dword_1A3640000, v47, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

            if ((v66 ^ v65))
            {
              goto LABEL_61;
            }

            if (v79)
            {
              goto LABEL_57;
            }

LABEL_64:
            if (v41)
            {
              goto LABEL_69;
            }

            if (!v79)
            {
              if ((v40 & 1) == 0)
              {
                goto LABEL_80;
              }

              goto LABEL_77;
            }

LABEL_66:
            if (([(CAMModeDial *)self->__modeDial isEnabled]& 1) != 0)
            {
              if (v40)
              {
LABEL_77:
                v53 = os_log_create("com.apple.camera", "ControlEnablement");
                if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                {
                  v54 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__zoomSlider withReason:v33];
                  *buf = 138543362;
                  v90 = v54;
                  _os_log_impl(&dword_1A3640000, v53, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                }

LABEL_80:
                if (((v60 ^ v59) & 1) == 0)
                {
                  if (!v79)
                  {
                    goto LABEL_86;
                  }

LABEL_82:
                  if (([(CAMZoomControl *)self->__zoomControl isEnabled]& 1) != 0)
                  {
                    goto LABEL_86;
                  }
                }

LABEL_83:
                v55 = os_log_create("com.apple.camera", "ControlEnablement");
                if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
                {
                  v56 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__zoomControl withReason:v33];
                  *buf = 138543362;
                  v90 = v56;
                  _os_log_impl(&dword_1A3640000, v55, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                }

                goto LABEL_86;
              }

LABEL_73:
              if (([(CAMZoomSlider *)self->__zoomSlider isEnabled]& 1) != 0)
              {
                if (((v60 ^ v59) & 1) == 0)
                {
                  goto LABEL_82;
                }

                goto LABEL_83;
              }

              goto LABEL_77;
            }

LABEL_69:
            v51 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
            {
              v52 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__modeDial withReason:v33];
              *buf = 138543362;
              v90 = v52;
              _os_log_impl(&dword_1A3640000, v51, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

            if (v40)
            {
              goto LABEL_77;
            }

            if (!v79)
            {
              goto LABEL_80;
            }

            goto LABEL_73;
          }

          goto LABEL_45;
        }

LABEL_37:
        v42 = os_log_create("com.apple.camera", "ControlEnablement");
        v33 = v80;
        if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
        {
          [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__timerButton withReason:v80];
          v44 = v43 = v34;
          *buf = 138543362;
          v90 = v44;
          _os_log_impl(&dword_1A3640000, v42, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

          v34 = v43;
        }

        v40 = v62 ^ v61;
        v41 = v64 ^ v63;
        if (v34)
        {
          goto LABEL_45;
        }

        if (!v79)
        {
          goto LABEL_48;
        }

        goto LABEL_41;
      }

      goto LABEL_29;
    }

    if (([(CAMFlashButton *)self->__flashButton isEnabled]& 1) != 0)
    {
      if (((v74 ^ v73) & 1) == 0)
      {
LABEL_25:
        if (([(CAMHDRButton *)self->__HDRButton isEnabled]& 1) != 0)
        {
          if ((v72 ^ v71))
          {
            goto LABEL_37;
          }

          goto LABEL_34;
        }
      }
    }

    else
    {
LABEL_17:
      v35 = os_log_create("com.apple.camera", "ControlEnablement");
      if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
      {
        v36 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__flashButton withReason:v80];
        *buf = 138543362;
        v90 = v36;
        _os_log_impl(&dword_1A3640000, v35, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

        v34 = v70 ^ v69;
      }

      if (((v74 ^ v73) & 1) == 0)
      {
        if (!v79)
        {
          goto LABEL_32;
        }

        goto LABEL_25;
      }
    }

LABEL_29:
    v37 = os_log_create("com.apple.camera", "ControlEnablement");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
      [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__HDRButton withReason:v80];
      v39 = v38 = v34;
      *buf = 138543362;
      v90 = v39;
      _os_log_impl(&dword_1A3640000, v37, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

      v34 = v38;
    }

    goto LABEL_32;
  }

LABEL_86:
  if (v77)
  {
    v57 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
    {
      v58 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__dynamicShutterControl withReason:v33];
      *buf = 138543362;
      v90 = v58;
      _os_log_impl(&dword_1A3640000, v57, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
    }
  }
}

- (void)setUserInteractionLoggingEnabled:(BOOL)a3
{
  if (self->_userInteractionLoggingEnabled != a3)
  {
    self->_userInteractionLoggingEnabled = a3;
    if (a3)
    {
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"User Interaction Logging Enabled" forceLog:1];
    }
  }
}

- (id)_debugEnabledDescriptionForControl:(id)a3 withReason:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [v7 isEnabled];
  v9 = MEMORY[0x1E696AD60];
  v10 = objc_opt_class();
  if (v8)
  {
    v11 = [v9 stringWithFormat:@"<%@: %p> is enabled. (%@)", v10, v7, v6];
  }

  else
  {
    v11 = [v9 stringWithFormat:@"<%@: %p> is disabled. We're", v10, v7];

    if ([(CAMViewfinderViewController *)self _isOutOfDiskSpace])
    {
      [v11 appendString:{@" out of disk space, "}];
    }

    [v11 replaceOccurrencesOfString:@" withString:" options:@"." range:{1, objc_msgSend(v11, "length") - 1, 1}];
    v7 = [MEMORY[0x1E696AEC0] stringWithFormat:@" (%@)", v6];

    [v11 appendString:v7];
  }

  return v11;
}

- (BOOL)pressShutterButtonWithTouchUpDelay:(double)a3 shutterBehavior:(int64_t)a4
{
  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [v7 isCaptureAvailable];

  if (v8)
  {
    v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (v9)
    {
      v10 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      v11 = [v10 externalButtonPressedWithBehavior:a4];

      if (v11)
      {
        dispatch_time(0, (a3 * 1000000000.0));
        v24 = MEMORY[0x1E69E9820];
        v25 = 3221225472;
        v26 = __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke;
        v27 = &unk_1E76F77B0;
        v28 = self;
        pl_dispatch_after();
        LOBYTE(v11) = 1;
      }
    }

    else
    {
      v13 = [(CAMViewfinderViewController *)self _shutterButton];
      v11 = [v13 isEnabled];
      if (v11)
      {
        [(CAMViewfinderViewController *)self _handleShutterButtonPressed:v13];
        v14 = +[CAMCaptureCapabilities capabilities];
        v15 = [v14 captureOnTouchDown];

        if (v15)
        {
          dispatch_time(0, (a3 * 1000000000.0));
          v18 = MEMORY[0x1E69E9820];
          v19 = 3221225472;
          v20 = __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke_2;
          v21 = &unk_1E76F7960;
          v22 = self;
          v23 = v13;
          pl_dispatch_after();
        }

        else
        {
          [(CAMViewfinderViewController *)self _handleShutterButtonReleased:v13];
        }
      }
    }
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *v17 = 0;
      _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Capture not available for pressShutterButtonWithTouchUpDelay:shutterBehavior:", v17, 2u);
    }

    LOBYTE(v11) = 0;
  }

  return v11;
}

void __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) _dynamicShutterControl];
  [v1 externalButtonReleased];
}

- (BOOL)takeStillDuringVideoWithTouchUpDelay:(double)a3
{
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 isCaptureAvailable];

  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 captureOnTouchDown];

  if (!v6)
  {
    return 0;
  }

  v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (v9)
  {
    v10 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    v11 = [v10 externalLockButtonPressed];

    dispatch_time(0, (a3 * 1000000000.0));
    pl_dispatch_after();
    return v11;
  }

  v14 = [(CAMViewfinderViewController *)self _stillDuringVideoButtonPressed:self->__stillDuringVideoButton];
  if (v8)
  {
    v13 = v14;
    dispatch_time(0, (a3 * 1000000000.0));
    pl_dispatch_after();
    return v13;
  }

  stillDuringVideoButton = self->__stillDuringVideoButton;

  return [(CAMViewfinderViewController *)self _stillDuringVideoButtonReleased:stillDuringVideoButton];
}

void __68__CAMViewfinderViewController_takeStillDuringVideoWithTouchUpDelay___block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) _dynamicShutterControl];
  [v1 externalLockButtonReleased];
}

- (void)_updateAllControlsWithContentSize:(id)a3
{
  topBar = self->__topBar;
  v5 = a3;
  [(CAMTopBar *)topBar invalidateIntrinsicContentSize];
  [(CAMTopBar *)self->__topBar setNeedsLayout];
  [(CAMBottomBar *)self->__bottomBar setNeedsLayout];
  v13 = [(CAMViewfinderViewController *)self _accessibilityHUDManagers];
  LODWORD(topBar) = UIContentSizeCategoryIsAccessibilityCategory(v5);

  if (topBar && ![v13 count])
  {
    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

    v7 = [CAMBarsAccessibilityHUDManager alloc];
    v8 = v7;
    if (v6)
    {
      v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v10 = [(CAMBarsAccessibilityHUDManager *)v8 initWithView:v9 delegate:self cancelsTouchesInView:1];
      [v13 addObject:v10];
    }

    else
    {
      v11 = [(CAMBarsAccessibilityHUDManager *)v7 initWithView:self->__topBar delegate:self cancelsTouchesInView:1];
      [v13 addObject:v11];

      v9 = [[CAMBarsAccessibilityHUDManager alloc] initWithView:self->__bottomBar delegate:self cancelsTouchesInView:0];
      [v13 addObject:v9];
    }
  }

  v12 = [(CAMViewfinderViewController *)self view];
  [v12 setNeedsLayout];
}

- (void)_handleContentSizeCategoryDidChange:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self currentContentSize];
  [(CAMViewfinderViewController *)self _updateAllControlsWithContentSize:v4];
}

void __83__CAMViewfinderViewController__updatePanoramaViewVisibilityForViewfinderTransition__block_invoke(uint64_t a1)
{
  v1 = (*(a1 + 40) ^ 1u);
  v2 = [*(a1 + 32) view];
  [v2 setAlpha:v1];
}

- (BOOL)_shouldAnimateViewfinderCloseForReason:(int64_t)a3
{
  if ((a3 - 10) < 2 || a3 == 19)
  {
    return 0;
  }

  if (a3 == 8)
  {
    return ![(CAMViewfinderViewController *)self _isShowingCameraRoll:v3];
  }

  return 1;
}

- (void)closedViewfinderController:(id)a3 wantsViewfinderClosedForReason:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  if (v7)
  {
    [(CAMViewfinderViewController *)self _setClosingViewfinder:1];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began closing viewfinder"];
    v8 = [MEMORY[0x1E69DC668] sharedApplication];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v9 = v8;
      [v9 willCloseViewfinderForReason:a4];
    }

    else
    {
      v9 = 0;
    }

    v10 = [(CAMViewfinderViewController *)self _shouldAnimateViewfinderCloseForReason:a4];
    objc_initWeak(&location, self);
    v18 = MEMORY[0x1E69E9820];
    v19 = 3221225472;
    v20 = __89__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderClosedForReason___block_invoke;
    v21 = &unk_1E76F9890;
    objc_copyWeak(v23, &location);
    v11 = v9;
    v22 = v11;
    v23[1] = a4;
    v12 = _Block_copy(&v18);
    if (a4 <= 0x14)
    {
      if (((1 << a4) & 0x17F3FE) != 0)
      {
        v13 = [(CAMViewfinderViewController *)self _transitionController:v18];
        [v13 closeWithBlur:1 animated:v10 withCompletionHandler:v12];
      }

      else if (((1 << a4) & 0x80C00) != 0)
      {
        v13 = [(CAMViewfinderViewController *)self _transitionController:v18];
        [v13 closeWithBlur:0 animated:v10 withCompletionHandler:v12];
      }

      else
      {
        v15 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:v18];
        v16 = [v15 device];

        if ((v16 - 1) > 0xA)
        {
          v17 = 0;
        }

        else
        {
          v17 = qword_1A3A685B0[v16 - 1];
        }

        v13 = [(CAMViewfinderViewController *)self _transitionController];
        [v13 closeAndRotateWithDirection:v17 withCompletionHandler:v12];
      }
    }

    if ([(CAMViewfinderViewController *)self _isShowingFilterScrubber:v18])
    {
      v14 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [v14 setIsFiltersSuspended:1];
    }

    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];

    objc_destroyWeak(v23);
    objc_destroyWeak(&location);
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began closing viewfinder"];
    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
  }
}

void __89__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderClosedForReason___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _setClosingViewfinder:0];
  [WeakRetained _updateEnabledControlsWithReason:@"Finished closing viewfinder"];
  [*(a1 + 32) didCloseViewfinderForReason:*(a1 + 48)];
}

- (void)closedViewfinderController:(id)a3 wantsViewfinderOpenForReason:(int64_t)a4
{
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  if (v7)
  {
    [(CAMViewfinderViewController *)self _setOpeningViewfinder:1];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began opening viewfinder"];
    v8 = [MEMORY[0x1E69DC668] sharedApplication];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v9 = v8;
      [v9 willOpenViewfinderForReason:a4];
    }

    else
    {
      v9 = 0;
    }

    if ([(CAMViewfinderViewController *)self _isSpatialMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]])
    {
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v10 animated:0];
    }

    objc_initWeak(&location, self);
    v11 = [(CAMViewfinderViewController *)self _transitionController];
    v14 = MEMORY[0x1E69E9820];
    v15 = 3221225472;
    v16 = __87__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderOpenForReason___block_invoke;
    v17 = &unk_1E76F9890;
    objc_copyWeak(v19, &location);
    v12 = v9;
    v18 = v12;
    v19[1] = a4;
    [v11 openForReason:a4 animated:1 withCompletionHandler:&v14];

    v13 = [(CAMViewfinderViewController *)self chromeConfigurator:v14];
    [v13 setIsFiltersSuspended:0];

    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
    [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:1];

    objc_destroyWeak(v19);
    objc_destroyWeak(&location);
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Finished opening viewfinder"];
    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
  }
}

void __87__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderOpenForReason___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _setOpeningViewfinder:0];
  [WeakRetained _updateEnabledControlsWithReason:@"Finished opening viewfinder"];
  [*(a1 + 32) didOpenViewfinderForReason:*(a1 + 48)];
  v2 = [WeakRetained queuedViewfinderAction];

  if (v2)
  {
    v3 = [WeakRetained queuedViewfinderAction];
    v3[2]();

    [WeakRetained setQueuedViewfinderAction:0];
  }
}

- (void)disabledPreviewController:(id)a3 wantsPreviewDisabledForReason:(int64_t)a4
{
  v4 = [(CAMViewfinderViewController *)self _captureController:a3];
  [v4 changeToPreviewDisabled];
}

- (void)disabledPreviewController:(id)a3 wantsPreviewEnabledForReason:(int64_t)a4
{
  v5 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:[(CAMViewfinderViewController *)self _currentMode:a3] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition] videoThumbnailOutputEnabled:[(CAMViewfinderViewController *)self _wantsFilterScrubberVisible]];
  v6 = [(CAMViewfinderViewController *)self _captureController];
  [v6 changeToPreviewEnabledWithConfiguration:v5];
}

- (void)captureController:(id)a3 didOutputOverCapturePreviewStatus:(int64_t)a4
{
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 spatialOverCaptureSupportForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  v8 = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];
  [(CAMViewfinderViewController *)self _setOverCapturePreviewStatus:a4 & (v7 << 62 >> 63)];

  [(CAMViewfinderViewController *)self _updateViewfinderMaterialFromStatus:v8 animated:1];
}

- (void)_updateViewfinderMaterialAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];

  [(CAMViewfinderViewController *)self _updateViewfinderMaterialFromStatus:v5 animated:v3];
}

- (void)_updateViewfinderMaterialFromStatus:(int64_t)a3 animated:(BOOL)a4
{
  v4 = a4;
  v7 = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];
  v8 = v7;
  if (v7 > 2)
  {
    if ((v7 - 4) >= 3)
    {
      v34 = v4;
      v9 = a3;
      if (v7 == 3)
      {
        v10 = 3;
      }

      else
      {
        v10 = 0;
      }

      goto LABEL_11;
    }

    goto LABEL_9;
  }

  if (!v7)
  {
    v9 = a3;
    v34 = 0;
    goto LABEL_10;
  }

  if (v7 != 1)
  {
    if (v7 != 2)
    {
      v34 = v4;
      v9 = a3;
      v10 = 0;
      goto LABEL_11;
    }

LABEL_9:
    v34 = v4;
    v9 = a3;
LABEL_10:
    v10 = 4;
    goto LABEL_11;
  }

  v28 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v29 = [v28 isSemanticStyleControlVisible];

  v30 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v31 = [v30 isSmartStylePickerVisible];

  v10 = 2;
  v34 = v4;
  if (v29 & 1) != 0 || (v31)
  {
    v9 = a3;
  }

  else
  {
    v9 = a3;
    v32 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    v33 = 2;
    if (((1 << v32) & 0x6202) == 0)
    {
      v33 = 0;
    }

    if (v32 <= 0xE)
    {
      v10 = v33;
    }

    else
    {
      v10 = 0;
    }
  }

LABEL_11:
  v11 = +[CAMCaptureCapabilities capabilities];
  if ([v11 isSpatialOverCaptureSupported])
  {
    v12 = +[CAMUserPreferences preferences];
    v13 = [v12 isOverCapturePreviewEnabled];

    if ((v13 & 1) == 0)
    {
      v10 = 4;
    }
  }

  else
  {

    v10 = 4;
  }

  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 spatialOverCaptureSupportForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  v16 = [(CAMViewfinderViewController *)self _isZooming];
  v17 = [(CAMViewfinderViewController *)self _isReconfiguring];
  v18 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v19 = [v18 isReticleAnimating];

  v20 = 3.0;
  if (v8 == 2)
  {
    v21 = +[CAMCaptureCapabilities capabilities];
    if ([v21 isBackQuadraSuperWideSupported])
    {
      v20 = 1.0;
    }

    else
    {
      v20 = 3.0;
    }
  }

  v23 = (v9 & 0xFFFFFFFFFFFFFFFDLL) == 4 && v8 == 1;
  v24 = v23 | (v16 || v17) | v19;
  if ((v15 & 2) == 0)
  {
    v10 = 4;
  }

  v25 = 0.35;
  if ((v24 & 1) == 0)
  {
    v25 = v20;
  }

  if (v34)
  {
    v26 = v25;
  }

  else
  {
    v26 = 0.0;
  }

  v27 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v27 setMaterial:v10 withDuration:v26];

  v35 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v35 setOverscanOverlayAlpha:dbl_1A3A683C8[v10] duration:v26];
}

- (int64_t)_topBarBackgroundStyleForMode:(int64_t)a3 capturing:(BOOL)a4
{
  v4 = a4;
  v7 = [(CAMViewfinderViewController *)self _layoutStyle];
  if (a3 > 9)
  {
    return 0;
  }

  if (((1 << a3) & 0x1A6) != 0)
  {
    return v4;
  }

  v9 = v7;
  v10 = [CAMBottomBar wantsVerticalBarForLayoutStyle:v7];
  v11 = [(CAMViewfinderViewController *)self view];
  v12 = [v11 window];
  v13 = [v12 screen];
  v14 = CAMIsTallScreen(v13);

  v15 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v9)
  {
    v16 = 2;
  }

  else
  {
    v17 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
    v18 = [(CAMViewfinderViewController *)self _isAnimatingFilterScrubberDismissal];
    v16 = 2;
    if ((v17 | v18))
    {
      v16 = 0;
    }
  }

  if (v10 || !v14)
  {
    return 0;
  }

  if (v15)
  {
    return 0;
  }

  return v16;
}

- (int64_t)_bottomBarBackgroundStyleForMode:(int64_t)a3
{
  if (![CAMBottomBar wantsVerticalBarForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    v6 = [(CAMViewfinderViewController *)self _captureController];
    v7 = [v6 isCapturingVideo];
    v8 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    v5 = 0;
    if (a3 <= 3)
    {
      if ((a3 - 1) < 2)
      {
        goto LABEL_14;
      }

      if (a3)
      {
        if (a3 == 3)
        {
          v9 = [v6 isCapturingPanorama];
          goto LABEL_13;
        }

LABEL_18:

        return v5;
      }
    }

    else
    {
      if (a3 > 9)
      {
        goto LABEL_18;
      }

      if (((1 << a3) & 0x250) == 0)
      {
        if (((1 << a3) & 0x180) == 0)
        {
          if (a3 == 5)
          {
            v9 = [v6 isCapturingTimelapse];
LABEL_13:
            v5 = v9;
            goto LABEL_18;
          }

          goto LABEL_18;
        }

LABEL_14:
        v5 = v7;
        goto LABEL_18;
      }
    }

    v10 = [(CAMViewfinderViewController *)self view];
    v11 = [v10 window];
    v12 = [v11 screen];
    v13 = CAMIsTallScreen(v12);

    if (v8 || !v13)
    {
      v5 = 0;
    }

    else
    {
      v5 = 2;
    }

    goto LABEL_18;
  }

  return 1;
}

- (int64_t)_preferredControlToOpenInDrawerForMode:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
  v5 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
  v6 = [v4 objectForKeyedSubscript:v5];

  if (v6)
  {
    v7 = [v6 integerValue];
  }

  else
  {
    v7 = -1;
  }

  return v7;
}

- (void)_setPreferredControlToOpenInDrawer:(int64_t)a3 forMode:(int64_t)a4
{
  if (a3 == -1)
  {
    v8 = 0;
  }

  else
  {
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:?];
  }

  v6 = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
  [v6 setObject:v8 forKeyedSubscript:v7];
}

- (BOOL)_isControlDrawerShowingPersistentControl
{
  v2 = [(CAMViewfinderViewController *)self _controlDrawer];
  v3 = v2;
  if (v2)
  {
    if ([v2 isControlExpandedForType:4] & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 6) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 7) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 9) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 8) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 10))
    {
      v4 = 1;
    }

    else
    {
      v4 = [v3 isControlExpandedForType:11];
    }
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (void)controlDrawer:(id)a3 didSelectMenuItemForControlType:(int64_t)a4
{
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder:a3];
  [v4 dismissModalControlDrawerIfNeededForReason:5];
}

- (void)controlDrawer:(id)a3 wantsFilterScrubberVisible:(BOOL)a4
{
  v4 = a4;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:a4 animated:1];
  if (v4)
  {
    v6 = 4;
  }

  else
  {
    v6 = -1;
  }

  v7 = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _setPreferredControlToOpenInDrawer:v6 forMode:v7];
}

- (void)controlDrawer:(id)a3 didCreateControlForType:(int64_t)a4
{
  v19 = a3;
  switch(a4)
  {
    case 0:
      [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:0];
      [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
      break;
    case 1:
      [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:0];
      break;
    case 2:
      v17 = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
      v16 = [v19 aspectRatioButton];
      [v16 setAspectRatio:v17];
      goto LABEL_16;
    case 3:
      v18 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
      v16 = [v19 timerButton];
      [v16 setTimerDuration:v18];
      goto LABEL_16;
    case 4:
      v13 = [(CAMViewfinderViewController *)self _currentMode];
      v14 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v13];
      v15 = v14 != [CAMUserPreferences defaultFilterTypeForMode:v13];
      v16 = [v19 filterButton];
      [v16 setOn:v15];
      goto LABEL_16;
    case 5:
      [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:0];
      break;
    case 6:
      v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v16 zoomFactor:0 animated:?];
LABEL_16:

      break;
    case 7:
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      break;
    case 8:
      [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
      break;
    case 9:
      [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:0];
      break;
    case 10:
      [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
      break;
    case 11:
      v6 = [v19 smartStyleButton];
      v7 = [v6 resetButton];
      [v7 addTarget:self action:sel__handleSmartStyleResetButton forControlEvents:64];

      v8 = [v19 smartStyleButton];
      v9 = [v8 shutterButton];
      [v9 addTarget:self action:sel__handleSmartStyleShutterButtonPressed_ forControlEvents:1];

      v10 = [v19 smartStyleButton];
      v11 = [v10 shutterButton];
      [v11 addTarget:self action:sel__handleSmartStyleShutterButtonReleased_ forControlEvents:64];

      v12 = [v19 smartStyleButton];
      [v12 setResetButtonVisibleWhenExpanded:0];

      [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
      break;
    case 12:
      [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:0];
      break;
    case 13:
      [(CAMViewfinderViewController *)self _updateProResButtonAnimated:0];
      break;
    case 14:
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      break;
    case 15:
      [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:0];
      break;
    default:
      break;
  }
}

- (void)controlDrawerDidCreateFilterScrubber:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:v4];
}

- (void)controlDrawerDidCreateApertureSlider:(id)a3
{
  v4 = [a3 apertureSlider];
  [v4 addTarget:self action:sel__apertureSliderDidChangeApertureValue_ forControlEvents:4096];

  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v5 zoomFactor:?];
}

- (void)controlDrawerDidCreateIntensitySlider:(id)a3
{
  v4 = a3;
  v7 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 intensitySlider];

  [v5 addTarget:self action:sel__handleIntensitySliderDidChangeValue_ forControlEvents:4096];
  [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
  if (([v7 isAspectRatioCropSupportedForMode:6 devicePosition:0] & 1) != 0 || objc_msgSend(v7, "isAspectRatioCropSupportedForMode:devicePosition:", 6, 1))
  {
    [v5 setTransparentGradients];
    v6 = [v5 tickMarksConfiguration];
    [v6 setUseTickMarkLegibilityShadows:1];
  }
}

- (void)controlDrawerDidCreateExposureSlider:(id)a3
{
  v4 = [a3 exposureSlider];
  [v4 addTarget:self action:sel__handleExposureSliderDidChangeValue_ forControlEvents:4096];
  [v4 setUseTickMarkLegibilityShadows:1];
  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
}

- (void)controlDrawerDidCreateNightModeSlider:(id)a3
{
  v4 = [a3 nightModeSlider];
  [v4 addTarget:self action:sel__handleNightModeSliderDidChangeValue_ forControlEvents:4096];
  [v4 setUseTickMarkLegibilityShadows:1];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
}

- (void)controlDrawerDidCreateSemanticStyleControl:(id)a3
{
  v4 = [a3 semanticStyleControl];
  [v4 addTarget:self action:sel__handleSemanticStyleControlDidChangeValue_ forControlEvents:4096];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
}

- (void)controlDrawer:(id)a3 didChangeSharedLibraryMode:(int64_t)a4
{
  v5 = [(CAMViewfinderViewController *)self _librarySelectionController];
  [v5 userDidPickSharedLibraryMode:a4];
}

- (void)controlDrawer:(id)a3 didChangeValueForControlType:(int64_t)a4
{
  v5 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [v5 didChangeValueForControlType:a4];
}

- (void)controlStatusBar:(id)a3 didCreateIndicatorForType:(unint64_t)a4
{
  v15 = a3;
  switch(a4)
  {
    case 0uLL:
      v6 = [v15 flashIndicator];
      [v6 addTarget:self action:sel__handleFlashIndicatorChangedMode_ forControlEvents:4096];

      [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:0];
      v7 = [v15 flashIndicator];
      v8 = v7;
      v9 = sel__handleFlashIndicatorLongPressed_;
      goto LABEL_14;
    case 1uLL:
      [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:0];
      break;
    case 2uLL:
      [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:0];
      break;
    case 3uLL:
      v12 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
      v13 = [v15 timerIndicator];
      [v13 setTimerDuration:v12];

      v14 = [v15 timerIndicator];
      [v14 setShowingValue:1];

      break;
    case 4uLL:
      [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
      break;
    case 5uLL:
      v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v8 zoomFactor:0 animated:?];
      goto LABEL_15;
    case 7uLL:
      [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
      break;
    case 8uLL:
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v10 animated:0];

      v8 = [v15 videoConfigurationIndicator];
      [v8 setTouchDelegate:self];
      goto LABEL_15;
    case 9uLL:
      [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:0];
      break;
    case 0xAuLL:
      [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
      break;
    case 0xBuLL:
      [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
      break;
    case 0xCuLL:
      [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:0];
      break;
    case 0xDuLL:
      [(CAMViewfinderViewController *)self _updateProResButtonAnimated:0];
      break;
    case 0xEuLL:
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      break;
    case 0xFuLL:
      [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:0];
      break;
    case 0x10uLL:
      v11 = [v15 photoFormatStatusIndicator];
      [v11 addTarget:self action:sel__handlePhotoFormatPickerChangedPhotoFormat_ forControlEvents:4096];

      [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:0];
      v7 = [v15 photoFormatStatusIndicator];
      v8 = v7;
      v9 = sel__handlePhotoFormatPickerLongPressed_;
LABEL_14:
      [v7 addTarget:self action:v9 forControlEvents:0x1000000];
LABEL_15:

      break;
    default:
      break;
  }
}

- (void)controlStatusBar:(id)a3 didReceiveTapInIndicatorForType:(unint64_t)a4
{
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v15 = MEMORY[0x1E69E9820];
  v16 = 3221225472;
  v17 = __80__CAMViewfinderViewController_controlStatusBar_didReceiveTapInIndicatorForType___block_invoke;
  v18 = &unk_1E76F98B8;
  v19 = v6;
  v20 = self;
  v7 = v6;
  v8 = _Block_copy(&v15);
  v13 = v8;
  switch(a4)
  {
    case 0uLL:
      [(CAMViewfinderViewController *)self _handleFlashIndicator:v15];
      break;
    case 1uLL:
      [(CAMViewfinderViewController *)self _handleLivePhotoIndicator:v15];
      break;
    case 2uLL:
      [(CAMViewfinderViewController *)self _handleHDRIndicator:v15];
      break;
    case 3uLL:
      (*(v8 + 2))(v8, 3, v9, v10, v11, v12);
      break;
    case 4uLL:
      (*(v8 + 2))(v8, 4, v9, v10, v11, v12);
      break;
    case 5uLL:
      (*(v8 + 2))(v8, 6);
      v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:v15];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v14 zoomFactor:1 animated:?];

      break;
    case 6uLL:
      (*(v8 + 2))(v8, 7, v9, v10, v11, v12);
      break;
    case 7uLL:
      (*(v8 + 2))(v8, 8, v9, v10, v11, v12);
      break;
    case 9uLL:
      [(CAMViewfinderViewController *)self _handleNightModeIndicator:v15];
      break;
    case 0xAuLL:
      (*(v8 + 2))(v8, 10, v9, v10, v11, v12);
      break;
    case 0xBuLL:
      (*(v8 + 2))(v8, 11, v9, v10, v11, v12);
      break;
    case 0xCuLL:
      [(CAMViewfinderViewController *)self _handleRAWIndicator:v15];
      break;
    case 0xDuLL:
      [(CAMViewfinderViewController *)self _handleProResIndicator:v15];
      break;
    case 0xEuLL:
      [(CAMViewfinderViewController *)self _handleSharedLibraryIndicator:v15];
      break;
    case 0xFuLL:
      [(CAMViewfinderViewController *)self _handleVideoStabilizationIndicator:v15];
      break;
    case 0x10uLL:
      [(CAMViewfinderViewController *)self _handlePhotoFormatPickerTapped:v15];
      break;
    default:
      break;
  }
}

void __80__CAMViewfinderViewController_controlStatusBar_didReceiveTapInIndicatorForType___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) controlDrawer];
  if ([*(a1 + 32) isControlDrawerPresentedModallyWithControlType:a2])
  {
    [*(a1 + 32) dismissModalControlDrawerIfNeededForReason:1];
  }

  else if ([v4 isControlExpandedForType:a2])
  {
    [v4 collapseExpandableButtonsAnimated:1 updatePreferredDrawerControl:1];
  }

  else
  {
    if (a2 == 4)
    {
      [*(a1 + 40) _setWantsFilterScrubberVisible:1 animated:1];
    }

    [*(a1 + 32) presentControlDrawerModally:1 forReason:1 controlType:a2];
  }
}

- (void)controlStatusBar:(id)a3 willChangeExpandingControl:(id)a4 expanded:(BOOL)a5
{
  if (a5)
  {
    v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder:a3];
    [v5 setControlDrawerExpanded:0 forReason:9 animated:1];
  }
}

- (void)badgeTray:(id)a3 didCreateBadgeForType:(unint64_t)a4
{
  v10 = a3;
  switch(a4)
  {
    case 0x40uLL:
      v9 = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
      v7 = [v10 spatialBadge];
      [v7 setSpatialModeHasVideoSelected:v9];
      break;
    case 8uLL:
      v8 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
      v7 = [v10 videoStabilizationBadge];
      [v7 setVideoStabilizationMode:v8];
      break;
    case 2uLL:
      v6 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadgeTypeForCurrentState];
      v7 = [v10 focusLockBadge];
      [v7 setFocusLockType:v6];
      break;
    default:
      goto LABEL_8;
  }

LABEL_8:
}

- (void)_showControlChangeBadgeWithUpdateHandler:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [v5 badgeTray];
  [v6 createBadgesIfNecessary:128];

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 badgeTray];
  v9 = [v8 controlChangeBadge];
  v4[2](v4, v9);

  [(CAMViewfinderViewController *)self _startTimer:0];
}

- (void)_handleFlashIndicator
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 controlStatusBar];
  v10 = [v5 flashIndicator];

  if ([v10 isExpanded])
  {
    v6 = [v10 setExpanded:0 animated:1];
  }

  else if ([(CAMViewfinderViewController *)self _isFlashUnavailableForMode:v3])
  {
    v6 = [(CAMViewfinderViewController *)self _showFlashOrTorchUnavailableAlertView];
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:v3 flashActive:0];
    if ((v6 - 1) >= 2)
    {
      v9 = v10;
      if (v6)
      {
        goto LABEL_11;
      }

      v7 = self;
      v8 = 2;
    }

    else
    {
      v7 = self;
      v8 = 0;
    }

    v6 = [(CAMViewfinderViewController *)v7 handleUserChangedToFlashMode:v8];
  }

  v9 = v10;
LABEL_11:

  MEMORY[0x1EEE66BB8](v6, v9);
}

- (void)_handleLivePhotoIndicator
{
  v3 = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings]|| !v3)
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    v6 = [v5 isLivePhotoAutoModeSupported];

    if (v6)
    {
      v4 = 2;
    }

    else
    {
      v4 = 1;
    }
  }

  else
  {
    v4 = 0;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToLivePhotoMode:v4];
}

- (void)_handleHDRIndicator
{
  v3 = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings]|| ![(CAMViewfinderViewController *)self _resolvedHDRMode];

  [(CAMViewfinderViewController *)self handleUserChangedToHDRMode:v3];
}

- (void)_handleNightModeIndicator
{
  v3 = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedToNightMode:v3];
}

- (BOOL)_isFlashOrTorchSupportedForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 devicePosition];
  v6 = [v3 mode];

  LOBYTE(v3) = [v4 isFlashOrTorchSupportedForMode:v6 devicePosition:v5];
  return v3;
}

- (void)_handleFlashButtonChangedFlashMode
{
  v3 = [(CAMViewfinderViewController *)self _flashButton];
  v4 = [v3 flashMode];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:v4];
}

- (void)handleChangedToFlashMode:(int64_t)a3 allowFlashOrTorchUnavailableAlert:(BOOL)a4
{
  v4 = a4;
  if ([(CAMViewfinderViewController *)self _isFlashUnavailableForMode:[(CAMViewfinderViewController *)self _currentMode]]&& v4)
  {

    [(CAMViewfinderViewController *)self _showFlashOrTorchUnavailableAlertView];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _currentMode];
    if (v7 <= 9)
    {
      if (((1 << v7) & 0x186) != 0)
      {
        v8 = [CAMCaptureConversions torchModeForFlashMode:a3];
        if (v8 != [(CAMViewfinderViewController *)self _resolvedTorchMode])
        {
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __90__CAMViewfinderViewController_handleChangedToFlashMode_allowFlashOrTorchUnavailableAlert___block_invoke_2;
          v9[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
          v9[4] = v8;
          [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v9];
        }

        [(CAMViewfinderViewController *)self _setDesiredTorchMode:v8 animated:1];
      }

      else if (((1 << v7) & 0x251) != 0)
      {
        [(CAMViewfinderViewController *)self _setDesiredFlashMode:a3];
        if ([(CAMViewfinderViewController *)self _resolvedFlashMode]!= a3)
        {
          v10[0] = MEMORY[0x1E69E9820];
          v10[1] = 3221225472;
          v10[2] = __90__CAMViewfinderViewController_handleChangedToFlashMode_allowFlashOrTorchUnavailableAlert___block_invoke;
          v10[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
          v10[4] = a3;
          [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v10];
        }

        if (a3 && [(CAMViewfinderViewController *)self _shouldDisableCompromisedFlashForDevicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]])
        {
          [(CAMViewfinderViewController *)self _setDidAcceptCompromisedFlash:1];
        }

        [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
        [(CAMViewfinderViewController *)self _updateNightModeConflict:1 isConflicting:[(CAMViewfinderViewController *)self _resolvedFlashMode]!= 0];
      }
    }

    [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:1];
  }
}

- (void)handleUserChangedToMacroMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setDesiredMacroMode:a3];

  [(CAMViewfinderViewController *)self _updateMacroButtonState];
}

- (int64_t)_resolvedVideoStabilizationMode
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = -[CAMViewfinderViewController _resolvedVideoStabilizationModeForVideoConfiguration:](self, "_resolvedVideoStabilizationModeForVideoConfiguration:", [v3 videoConfiguration]);

  return v4;
}

- (int64_t)_resolvedVideoStabilizationModeForVideoConfiguration:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v5 mode];
  v8 = [v5 device];
  v9 = [v5 videoEncodingBehavior];
  v10 = [v5 trueVideoEnabled];
  v11 = [v5 prefersHDR10BitVideo];
  LOBYTE(v14) = [v5 frontRearSimultaneousVideoEnabled];
  if ([v6 isActionModeControlSupportedForMode:v7 device:v8 videoConfiguration:a3 videoEncodingBehavior:v9 trueVideoEnabled:v10 prefersHDR10BitVideo:v11 frontRearSimultaneousVideoEnabled:v14])
  {
    v12 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (void)_setDesiredTorchMode:(int64_t)a3 animated:(BOOL)a4
{
  if (self->__desiredTorchMode != a3)
  {
    self->__desiredTorchMode = a3;
    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:v6 animated:1];
  }
}

- (void)_updateTorchModeForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = [(CAMViewfinderViewController *)self _resolvedTorchModeForGraphConfiguration:a3];

  [(CAMViewfinderViewController *)self _setResolvedTorchMode:v6 animated:v4];
}

- (int64_t)_resolvedTorchModeForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _desiredTorchMode];
  if ([v4 trueVideoEnabled])
  {
    v5 = [CAMCaptureConversions torchModeForFlashMode:[(CAMViewfinderViewController *)self _resolvedFlashMode]];
  }

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 isTorchAvailable];
  if ((v7 & [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:v4]) != 0)
  {
    v8 = v5;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_setResolvedTorchMode:(int64_t)a3 animated:(BOOL)a4
{
  if (self->__resolvedTorchMode != a3)
  {
    v5 = a4;
    self->__resolvedTorchMode = a3;
    v7 = [(CAMViewfinderViewController *)self _currentMode];
    [(CAMViewfinderViewController *)self _updateFlashButtonForMode:v7 animated:v5];

    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:v7];
  }
}

- (void)_updateTorchModeOnControllerForMode:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _captureController];
  if ([v5 isCapturingVideo])
  {
    v6 = [(CAMViewfinderViewController *)self _captureController];
    v7 = [v6 videoCapturePaused];

    if (!v7)
    {
      return;
    }
  }

  else
  {
  }

  v8 = 0;
  if (a3 <= 8 && ((1 << a3) & 0x186) != 0)
  {
    v8 = [(CAMViewfinderViewController *)self _resolvedTorchMode];
  }

  if ([(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay])
  {
    v9 = 0;
  }

  else
  {
    v9 = v8;
  }

  v10 = [(CAMViewfinderViewController *)self _captureController];
  [v10 changeToTorchMode:v9];
}

- (void)_handleFlashIndicatorChangedMode:(id)a3
{
  v4 = [a3 flashMode];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:v4];
}

- (void)_handleFlashIndicatorLongPressed:(id)a3
{
  v3 = a3;
  if (([v3 isExpanded] & 1) == 0 && (objc_msgSend(v3, "isFlashUnavailable") & 1) == 0)
  {
    [v3 setExpanded:1 animated:1];
  }
}

- (id)_flashOrTorchDisabledMessageForCurrentPowerPressure
{
  v2 = [(CAMViewfinderViewController *)self _powerController];
  v3 = [v2 powerPressureLevel];

  if (v3)
  {
    v4 = @"FLASH_DISABLED_POWER_PRESSURE_MESSAGE_%@";
  }

  else
  {
    v4 = @"FLASH_DISABLED_MESSAGE_%@";
  }

  v5 = MEMORY[0x1E696AEC0];
  v6 = [MEMORY[0x1E69DC938] currentDevice];
  v7 = [v6 model];
  v8 = [v5 stringWithValidatedFormat:v4 validFormatSpecifiers:@"%@" error:0, v7];

  v9 = CAMLocalizedFrameworkString(v8, 0);

  return v9;
}

- (void)_showFlashOrTorchUnavailableAlertView
{
  v3 = [(CAMViewfinderViewController *)self _flashOrTorchUnavailableAlertController];
  if (!v3)
  {
    v4 = CAMLocalizedFrameworkString(@"FLASH_DISABLED_TITLE", 0);
    v5 = CAMLocalizedFrameworkString(@"OK_REPLY", 0);
    v6 = [(CAMViewfinderViewController *)self _flashOrTorchDisabledMessageForCurrentPowerPressure];
    v3 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v4 message:v6 preferredStyle:1];
    objc_initWeak(&location, self);
    v7 = MEMORY[0x1E69DC648];
    v9 = MEMORY[0x1E69E9820];
    v10 = 3221225472;
    v11 = __68__CAMViewfinderViewController__showFlashOrTorchUnavailableAlertView__block_invoke;
    v12 = &unk_1E76F9900;
    objc_copyWeak(&v13, &location);
    v8 = [v7 actionWithTitle:v5 style:0 handler:&v9];
    [v3 addAction:{v8, v9, v10, v11, v12}];
    [v3 setPreferredAction:v8];
    [(CAMViewfinderViewController *)self _setFlashOrTorchUnavailableAlertController:v3];
    [(CAMViewfinderViewController *)self presentViewController:v3 animated:1 completion:0];

    objc_destroyWeak(&v13);
    objc_destroyWeak(&location);
  }
}

void __68__CAMViewfinderViewController__showFlashOrTorchUnavailableAlertView__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _setFlashOrTorchUnavailableAlertController:0];
}

- (void)_dismissFlashOrTorchUnavailableAlertViewAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _flashOrTorchUnavailableAlertController];
  if (v5)
  {
    v7 = v5;
    v6 = [(CAMViewfinderViewController *)self presentedViewController];

    if (v6 == v7)
    {
      [(CAMViewfinderViewController *)self dismissViewControllerAnimated:v3 completion:0];
    }

    [(CAMViewfinderViewController *)self _setFlashOrTorchUnavailableAlertController:0];
    v5 = v7;
  }
}

- (BOOL)_isHDRSupportedForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 devicePosition];

  LOBYTE(v3) = [v4 isHDRSupportedForMode:v5 devicePosition:v6];
  return v3;
}

- (void)_handleHDRButtonChangedHDRMode
{
  v3 = [(CAMViewfinderViewController *)self _HDRButton];
  v4 = [v3 HDRMode];

  [(CAMViewfinderViewController *)self handleUserChangedToHDRMode:v4];
}

- (void)handleUserChangedToHDRMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setDesiredHDRMode:a3];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
  v4 = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  [(CAMViewfinderViewController *)self _updateNightModeConflict:2 isConflicting:v4 != 0];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 shouldSuspendVideoHDRForHDRMode:v4 captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  v7 = [(CAMViewfinderViewController *)self _captureController];
  [v7 changeToVideoHDRSuspended:v6];
}

- (BOOL)_wantsHDRControlsVisibleForGraphConfiguration:(id)a3
{
  if ([(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:a3])
  {
    v3 = +[CAMUserPreferences preferences];
    v4 = [v3 shouldUseModernHDRBehavior] ^ 1;
  }

  else
  {
    LOBYTE(v4) = 0;
  }

  return v4;
}

- (void)_updateHDRButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings])
  {
    v5 = 0;
  }

  v6 = [(CAMViewfinderViewController *)self _HDRButton];
  [v6 setHDRMode:v5];

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 controlStatusBar];
  v9 = [v8 hdrIndicator];

  v10 = [(CAMViewfinderViewController *)self _controlDrawer];
  v11 = [v10 hdrButton];

  [v11 setHDRMode:v5 animated:v3];
  [v9 setHDRMode:v5 animated:v3];
  v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v15[0] = MEMORY[0x1E69E9820];
  v15[1] = 3221225472;
  v15[2] = __56__CAMViewfinderViewController__updateHDRButtonAnimated___block_invoke;
  v15[3] = &unk_1E76F97F0;
  v17 = self;
  v18 = v5;
  v16 = v12;
  v13 = v12;
  [v13 performChanges:v15];
  v14 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v14 setHdrMode:v5];
}

uint64_t __56__CAMViewfinderViewController__updateHDRButtonAnimated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setHdrMode:*(a1 + 48)];
  v2 = [*(a1 + 40) _wantsHDRControlsVisible];
  v3 = *(a1 + 32);

  return [v3 setIsHDRSupported:v2];
}

- (void)_resolvePotentiallyConflictingControlsForMode:(int64_t)a3 device:(int64_t)a4 resolvedFlashMode:(int64_t *)a5 resolvedHDRMode:(int64_t *)a6 resolvedLivePhotoMode:(int64_t *)a7 resolvedRAWMode:(int64_t *)a8 resolvedPhotoResolution:(int64_t *)a9
{
  v40 = [(CAMViewfinderViewController *)self _captureController];
  if ((a4 - 1) > 0xA)
  {
    v12 = 0;
  }

  else
  {
    v12 = qword_1A3A685B0[a4 - 1];
  }

  v13 = +[CAMCaptureCapabilities capabilities];
  v33 = [v13 isHDROnSupportedForDevicePosition:v12];
  v14 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForMode:a3 device:a4];
  v15 = [v13 isHDRSupportedForMode:a3 devicePosition:v12];
  v16 = [v13 isFlashOrTorchSupportedForMode:a3 devicePosition:v12];
  v17 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  v18 = [v40 isFlashAvailable];
  v19 = [(CAMViewfinderViewController *)self _shouldDisableCompromisedFlashForDevicePosition:v12];
  if (v16)
  {
    v16 = v18 & !v19;
  }

  v20 = +[CAMUserPreferences preferences];
  v39 = v20;
  if ([v13 isLinearDNGSupportedForMode:a3] && objc_msgSend(v20, "rawControlEnabled"))
  {
    v21 = [(CAMViewfinderViewController *)self _desiredRAWMode];
  }

  else
  {
    v21 = 0;
  }

  v44 = v21;
  if ([(CAMViewfinderViewController *)self _arePhotoFormatConflictsSupportedForMode:a3 device:a4])
  {
    v34 = [(CAMViewfinderViewController *)self _photoFormatConflicts];
  }

  else
  {
    v34 = 0;
  }

  v32 = a4;
  if (v16)
  {
    v22 = [(CAMViewfinderViewController *)self _desiredFlashMode];
  }

  else
  {
    v22 = 0;
  }

  if (v17 || (v15 & 1) == 0)
  {
    v23 = 0;
  }

  else
  {
    v23 = [(CAMViewfinderViewController *)self _desiredHDRMode];
  }

  if (v17 || !v14)
  {
    v24 = 0;
  }

  else
  {
    v24 = [(CAMViewfinderViewController *)self _desiredLivePhotoMode];
  }

  v25 = [(CAMViewfinderViewController *)self _desiredPhotoResolution];
  if ([v13 isModernHDRSupported] && (objc_msgSend(v39, "shouldUseModernHDRBehavior") & 1) != 0)
  {
    v23 = 1;
  }

  else
  {
    if (v23 == 1)
    {
      v26 = v33;
    }

    else
    {
      v26 = 1;
    }

    if (!v26)
    {
      v23 = 0;
    }
  }

  v43 = v22;
  v41 = v25;
  v42 = v24;
  if ([v40 isCapturingBurst])
  {
    v23 = 0;
    v43 = 0;
    v44 = 0;
    v41 = 0;
    v42 = 0;
    v27 = v39;
  }

  else
  {
    if ([(CAMViewfinderViewController *)self _isBurstEndSoundPlaying])
    {
      v28 = 0;
    }

    else
    {
      v28 = v24;
    }

    [CAMConflictingControlConfiguration resolveDesiredRAWMode:v21 photoFormatConflicts:v34 desiredLivePhotoMode:v28 desiredFlashMode:v22 toRAWMode:&v44 toLivePhotoMode:&v42 toFlashMode:&v43];
    v29 = v44;
    v30 = [(CAMViewfinderViewController *)self _captureController];
    v31 = [v39 photoEncodingBehaviorForMode:a3 resolvedRAWMode:v29 isCapturingVideo:objc_msgSend(v30 isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

    if (([v13 isPhotoResolutionSupported:v25 forMode:a3 device:v32 photoEncoding:v31] & 1) == 0)
    {
      v25 = [v13 defaultPhotoResolutionForMode:a3 devicePosition:v12 encodingBehavior:v31];
    }

    v27 = v39;
    [v39 resolveDesiredPhotoResolution:v25 livePhotoMode:v42 rawMode:v44 conflicts:v34 mode:a3 device:v32 resolvedPhotoResolution:&v41 resolvedLivePhotoMode:&v42];
  }

  if (a5)
  {
    *a5 = v43;
  }

  if (a6)
  {
    *a6 = v23;
  }

  if (a7)
  {
    *a7 = v42;
  }

  if (a8)
  {
    *a8 = v44;
  }

  if (a9)
  {
    *a9 = v41;
  }
}

- (void)_resolveAndUpdatePotentiallyConflictingControls:(BOOL)a3 animated:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [v7 mode];
  v21 = 0;
  v22 = 0;
  v20 = 0;
  v18 = 0;
  v19 = 0;
  -[CAMViewfinderViewController _resolvePotentiallyConflictingControlsForMode:device:resolvedFlashMode:resolvedHDRMode:resolvedLivePhotoMode:resolvedRAWMode:resolvedPhotoResolution:](self, "_resolvePotentiallyConflictingControlsForMode:device:resolvedFlashMode:resolvedHDRMode:resolvedLivePhotoMode:resolvedRAWMode:resolvedPhotoResolution:", v8, [v7 device], &v22, &v21, &v20, &v19, &v18);
  [(CAMViewfinderViewController *)self _setResolvedFlashMode:v22];
  [(CAMViewfinderViewController *)self _setResolvedHDRMode:v21];
  [(CAMViewfinderViewController *)self _setResolvedLivePhotoMode:v20];
  [(CAMViewfinderViewController *)self _setResolvedRAWMode:v19];
  [(CAMViewfinderViewController *)self _setResolvedPhotoResolution:v18];
  [(CAMViewfinderViewController *)self _updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:v4];
  v9 = +[CAMCaptureCapabilities capabilities];
  if ([v9 isProResVideoSupportedForMode:v8 frontRearSimultaneousVideoEnabled:{objc_msgSend(v7, "frontRearSimultaneousVideoEnabled")}] && (objc_msgSend(v9, "isProResVideoSupportedForMode:videoConfiguration:outputToExternalStorage:frontRearSimultaneousVideoEnabled:", v8, objc_msgSend(v7, "videoConfiguration"), -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](self, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", v8, objc_msgSend(v7, "videoEncodingBehavior")), objc_msgSend(v7, "frontRearSimultaneousVideoEnabled")) & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setDesiredProResVideoMode:0];
  }

  v10 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __88__CAMViewfinderViewController__resolveAndUpdatePotentiallyConflictingControls_animated___block_invoke;
  v12[3] = &unk_1E76F9928;
  v15 = v22;
  v16 = v20;
  v17 = v21;
  v13 = v10;
  v14 = self;
  v11 = v10;
  [v11 performChanges:v12];
  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:v8 animated:v4];
  [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:v4];
  [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:v4];
  [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:v4];
  [(CAMViewfinderViewController *)self _updateProResButtonAnimated:v4];
  [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:v4];
  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:v4];
  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:v4];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:v4];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:v4];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:v7 isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
  if (v5)
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  }

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:v8];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

uint64_t __88__CAMViewfinderViewController__resolveAndUpdatePotentiallyConflictingControls_animated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setFlashMode:*(a1 + 48)];
  [*(a1 + 32) setLivePhotoMode:*(a1 + 56)];
  [*(a1 + 32) setHdrMode:*(a1 + 64)];
  v2 = *(a1 + 40);

  return [v2 _updateChromePhotoFormatsAndResolutions];
}

- (void)_updateFlashModeOnControllerForMode:(int64_t)a3
{
  v4 = 0;
  if (a3 <= 6 && ((1 << a3) & 0x51) != 0)
  {
    v4 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  }

  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 changeToFlashMode:v4];
}

- (int64_t)_displayedFlashModeForMode:(int64_t)a3 flashActive:(BOOL *)a4
{
  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [v7 isFlashActive];
  v9 = [v7 isTorchActive];
  v10 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  if (a3 > 9)
  {
    goto LABEL_8;
  }

  if (((1 << a3) & 0x186) != 0)
  {
    v10 = [CAMCaptureConversions flashModeForTorchMode:[(CAMViewfinderViewController *)self _resolvedTorchMode]];
    goto LABEL_10;
  }

  if (((1 << a3) & 0x51) == 0)
  {
    v10 = 0;
LABEL_8:
    v9 = 0;
    goto LABEL_10;
  }

  v11 = [v7 isCapturingVideo];
  if ((v11 | v8))
  {
    v9 |= v11 ^ 1;
  }

  else
  {
    v9 = [(CAMViewfinderViewController *)self _resolvedFlashMode]== 1;
  }

LABEL_10:
  v12 = [(CAMViewfinderViewController *)self _resolvedNightMode];
  v13 = 2;
  if (v10 != 1)
  {
    v13 = v10;
  }

  if (v12 == 1)
  {
    v14 = 0;
  }

  else
  {
    v13 = v10;
    v14 = v9;
  }

  if (v12 == 2)
  {
    v15 = 0;
  }

  else
  {
    v15 = v13;
  }

  if (v12 == 2)
  {
    v16 = v9;
  }

  else
  {
    v16 = v14;
  }

  if (a4)
  {
    *a4 = v16 & 1;
  }

  return v15;
}

- (void)_updateFlashButtonForMode:(int64_t)a3 animated:(BOOL)a4
{
  v4 = a4;
  v22 = 0;
  v7 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:a3 flashActive:&v22];
  v8 = [(CAMViewfinderViewController *)self _flashButton];
  [v8 setFlashMode:v7];

  v9 = [(CAMViewfinderViewController *)self _controlDrawer];
  v10 = [v9 flashButton];
  [v10 setFlashMode:v7 animated:v4];

  v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v12 = [v11 controlStatusBar];
  v13 = [v12 flashIndicator];

  [v13 setFlashActive:v22];
  [v13 setFlashMode:v7 animated:v4];
  v14 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v14 setFlashMode:v7];

  v15 = +[CAMCaptureCapabilities capabilities];
  if ([v15 isFlashSupportedForMode:a3 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v16 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v16 setFlashMode:v7];

    v17 = v22;
    v18 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v18 setIsFlashActive:v17];
LABEL_5:

    goto LABEL_6;
  }

  if ([v15 isTorchSupportedForMode:a3 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v19 = [CAMCaptureConversions torchModeForFlashMode:v7];
    v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v20 setTorchMode:v19];

    v21 = v22;
    v18 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v18 setIsTorchActive:v21];
    goto LABEL_5;
  }

LABEL_6:
}

- (void)_handleSharedLibraryIndicator
{
  v4 = [(CAMViewfinderViewController *)self _librarySelectionController];
  if (CAMSharedLibraryModeIsOn([v4 sharedLibraryMode]))
  {
    v3 = 3;
  }

  else
  {
    v3 = 2;
  }

  [v4 userDidPickSharedLibraryMode:v3];
  [(CAMViewfinderViewController *)self _startTimer:2];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (void)_updateSharedLibraryButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _librarySelectionController];
  v6 = [v5 sharedLibraryMode];

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 controlStatusBar];
  v17 = [v8 sharedLibraryIndicator];

  v9 = [(CAMViewfinderViewController *)self _controlDrawer];
  v10 = [v9 sharedLibraryButton];

  [v17 setSharedLibraryMode:v6 animated:v3];
  [v10 setSharedLibraryMode:v6 animated:v3];
  v11 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [v11 setSharedLibraryMode:v6];

  v12 = +[CAMCaptureCapabilities capabilities];
  if ([v12 isInternalInstall])
  {
    sharedLibraryLongPressGestureRecognizer = self->__sharedLibraryLongPressGestureRecognizer;

    if (sharedLibraryLongPressGestureRecognizer)
    {
      goto LABEL_5;
    }

    v14 = [objc_alloc(MEMORY[0x1E69DCC48]) initWithTarget:self action:sel_sharedLibraryTapToRadarAction];
    v15 = self->__sharedLibraryLongPressGestureRecognizer;
    self->__sharedLibraryLongPressGestureRecognizer = v14;

    [(UILongPressGestureRecognizer *)self->__sharedLibraryLongPressGestureRecognizer setDelegate:self];
    [v17 addGestureRecognizer:self->__sharedLibraryLongPressGestureRecognizer];
    v12 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    [v12 addGestureRecognizer:self->__sharedLibraryLongPressGestureRecognizer];
  }

LABEL_5:
  v16 = [(CAMViewfinderViewController *)self _remoteShutterController];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    v6 = [(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState];
  }

  [v16 setSharedLibraryMode:v6];

  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
}

- (void)_updateChromeSharedLibraryState
{
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 sharedLibraryEnabled];
  v5 = [(CAMViewfinderViewController *)self _librarySelectionController];
  [v6 setSharedLibraryEnabled:v4 mode:{objc_msgSend(v5, "sharedLibraryMode")}];
}

- (void)_updateChromeClassicModeSwitching
{
  v3 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v2 = +[CAMUserPreferences preferences];
  [v3 setIsClassicModeSwitchingEnabled:{objc_msgSend(v2, "classicModeSwitchingEnabled")}];
}

- (void)_updateSharedLibraryBadgeForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _librarySelectionController];
  v4 = [v3 sharedLibraryMode];

  v5 = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
  [v5 setSharedLibraryMode:v4];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (void)sharedLibraryTapToRadarAction
{
  v3 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  v4 = [v3 touchingGestureRecognizer];
  [v4 cancelGesture];

  v5 = [(CAMViewfinderViewController *)self _librarySelectionController];
  v6 = [v5 tapToRadarAlertController];

  [(CAMViewfinderViewController *)self presentViewController:v6 animated:1 completion:0];
}

- (void)librarySelectionDidChangeSharedLibraryMode:(int64_t)a3
{
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    v4 = os_log_create("com.apple.camera", "SharedLibrary");
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *v5 = 0;
      _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Library selection controller changed shared library mode when timer was active, not updating shared library state", v5, 2u);
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _startTimer:2];
    [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:1];

    [(CAMViewfinderViewController *)self _updateSharedLibraryBadgeForCurrentState];
  }
}

- (void)_updateLivePhotoButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:v5];

  v7 = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
  v8 = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
  if (v6)
  {
    if (v8)
    {
      v7 = 0;
    }

    v9 = [(CAMViewfinderViewController *)self _livePhotoButton];
    [v9 setLivePhotoMode:v7];

    v10 = [(CAMViewfinderViewController *)self _livePhotoBadge];
    [v10 setIrisMode:v7];

    v11 = [(CAMViewfinderViewController *)self _controlDrawer];
    v12 = [v11 livePhotoButton];
    [v12 setLivePhotoMode:v7 animated:v3];

    v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v14 = [v13 controlStatusBar];
    v15 = [v14 livePhotoIndicator];
    [v15 setLivePhotoMode:v7 animated:v3];

    v16 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v16 setIrisMode:v7];

    v17 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v17 setLivePhotoMode:v7];
  }
}

- (BOOL)_isLivePhotoSupportedForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v6 = [v4 device];

  return [(CAMViewfinderViewController *)self _isLivePhotoSupportedForMode:v5 device:v6];
}

- (BOOL)_isLivePhotoSupportedForMode:(int64_t)a3 device:(int64_t)a4
{
  if ((a4 - 1) > 0xA)
  {
    v5 = 0;
  }

  else
  {
    v5 = qword_1A3A685B0[a4 - 1];
  }

  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isLivePhotoSupportedForMode:a3 devicePosition:v5];

  return v7;
}

- (BOOL)_shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4
{
  v12 = 0;
  v6 = a3;
  v7 = [v6 mode];
  v8 = [v6 device];

  [(CAMViewfinderViewController *)self _resolvePotentiallyConflictingControlsForMode:v7 device:v8 resolvedFlashMode:0 resolvedHDRMode:0 resolvedLivePhotoMode:&v12 resolvedRAWMode:0 resolvedPhotoResolution:0];
  v9 = [(CAMViewfinderViewController *)self _isBurstEndSoundPlaying];
  if (v12)
  {
    v10 = a4;
  }

  else
  {
    v10 = 1;
  }

  return v10 || v9;
}

- (void)_updatePairedVideoCaptureOnControllerForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(v4) = [(CAMViewfinderViewController *)self _shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:v6 isShowingCameraRoll:v4];

  if (v4)
  {
    [v7 pauseCapturingStillImagePairedVideo];
  }

  else
  {
    [v7 resumeCapturingStillImagePairedVideo];
  }
}

- (void)_pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:(id)a3 isShowingCameraRoll:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(v4) = [(CAMViewfinderViewController *)self _shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:v6 isShowingCameraRoll:v4];

  if (v4)
  {
    [v7 pauseCapturingStillImagePairedVideo];
  }
}

- (int64_t)_aspectRatioCropForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(a4) = [v7 isAspectRatioCropSupportedForMode:a3 devicePosition:a4];

  if (!a4 || a3 != 6 && a3)
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
}

- (void)handleUserChangedToAspectRatioCrop:(int64_t)a3
{
  [(CAMViewfinderViewController *)self setPhotoModeAspectRatioCrop:?];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 videoConfiguration];
  v8 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", v5, v7, v8, [v9 trueVideoEnabled]);

  v30 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v30 setViewportAspectRatio:v10 animated:1];
  v11 = [(CAMViewfinderViewController *)self _prominentObjectManager];
  [v11 setViewportAspectRatio:v10];

  v12 = [(CAMViewfinderViewController *)self _captureController];
  [v12 changeToAspectRatioCrop:a3];

  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateShutterButtonLegibility];
  v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v13 zoomFactor:?];

  v14 = [v30 controlDrawer];
  v15 = [v14 aspectRatioButton];
  [v15 setAspectRatio:a3];

  v16 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v16 setAspectRatioCrop:a3];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  v17 = +[CAMCaptureCapabilities capabilities];
  v18 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v19 = [v18 mode];
  v20 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(v19) = [v17 isSmartFramingSupportedForMode:v19 devicePosition:{objc_msgSend(v20, "devicePosition")}];

  if (v19)
  {
    v21 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v21 animated:1];

    v22 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:v22 animated:1];

    v23 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v24 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoZoomForGraphConfiguration:v23];
    v25 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v25 setIsSmartFramingAutoZoomSupported:v24];

    v26 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v27 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoRotationForGraphConfiguration:v26];
    v28 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v28 setIsSmartFramingAutoRotationSupported:v27];

    v29 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v29];
  }
}

- (int64_t)_videoConfigurationResolutionForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device];
  v8 = [v4 videoEncodingBehavior];
  v9 = [v4 videoConfiguration];
  v10 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v11 = [v4 prefersHDR10BitVideo];
  LOBYTE(v15) = [v4 frontRearSimultaneousVideoEnabled];
  v12 = [v5 resolvedVideoConfigurationForMode:v6 device:v7 videoEncodingBehavior:v8 videoConfiguration:v9 outputToExternalStorage:v10 prefersHDR10BitVideo:v11 frontRearSimultaneousVideoEnabled:v15];

  v13 = [v4 videoStabilizationStrength];
  result = 0;
  if (v12 <= 0xE)
  {
    if (((1 << v12) & 0x7620) != 0)
    {
      if (v13 > 3)
      {
        return 0;
      }

      else
      {
        return qword_1A3A683F0[v13];
      }
    }

    else if (((1 << v12) & 0x992) != 0)
    {
      return 2;
    }

    else
    {
      return ((1 << v12) & 0x4C) != 0;
    }
  }

  return result;
}

- (int64_t)_videoConfigurationFramerateForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device];
  v8 = [v4 videoEncodingBehavior];
  v9 = [v4 videoConfiguration];
  v10 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v11 = [v4 prefersHDR10BitVideo];
  v12 = [v4 frontRearSimultaneousVideoEnabled];

  LOBYTE(v15) = v12;
  v13 = [v5 resolvedVideoConfigurationForMode:v6 device:v7 videoEncodingBehavior:v8 videoConfiguration:v9 outputToExternalStorage:v10 prefersHDR10BitVideo:v11 frontRearSimultaneousVideoEnabled:v15];

  if ((v13 - 1) > 0xD)
  {
    return 0;
  }

  else
  {
    return qword_1A3A68410[v13 - 1];
  }
}

- (void)_updateVideoConfigurationStatusIndicatorForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(CAMViewfinderViewController *)self _videoConfigurationResolutionForGraphConfiguration:v6];
  v8 = [(CAMViewfinderViewController *)self _videoConfigurationFramerateForGraphConfiguration:v6];

  if (v7 && v8)
  {
    v9 = [(CAMViewfinderViewController *)self _targetVideoConfigurationStatusIndicator];
    [v9 setResolution:v7 framerate:v8 animated:v4];
  }
}

- (void)_handleRAWIndicator
{
  v3 = [(CAMViewfinderViewController *)self _resolvedRAWMode]== 0;

  [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:v3];
}

- (BOOL)_arePhotoFormatConflictsSupportedForMode:(int64_t)a3 device:(int64_t)a4
{
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = +[CAMUserPreferences preferences];
  if ([v6 isLinearDNGSupportedForMode:a3])
  {
    v8 = [v7 rawControlEnabled];
  }

  else
  {
    v8 = 0;
  }

  v9 = [v6 isPhotoResolutionSupported:3 forMode:a3 device:a4 photoEncoding:1];
  if (v9)
  {
    LOBYTE(v9) = [v7 photoFormatControlEnabled];
  }

  v10 = v8 | v9;

  return v10 & 1;
}

- (void)_setPhotoFormatConflict:(unint64_t)a3 isConflicting:(BOOL)a4
{
  v4 = a4;
  if ([(CAMViewfinderViewController *)self _arePhotoFormatConflictsSupportedForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]])
  {
    v7 = [(CAMViewfinderViewController *)self _photoFormatConflicts];
    if (v4)
    {
      v8 = v7 | a3;
    }

    else
    {
      v8 = v7 & ~a3;
    }

    [(CAMViewfinderViewController *)self _setPhotoFormatConflicts:v8];
  }
}

- (void)_handleUserChangedRAWMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setDesiredRAWMode:?];
  if (a3 == 1)
  {
    [(CAMViewfinderViewController *)self _setPhotoFormatConflicts:0];
  }

  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];

  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:1];
  [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_updateRAWButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v6 controlStatusBar];
  v10 = [v7 rawIndicator];

  v8 = [(CAMViewfinderViewController *)self _controlDrawer];
  v9 = [v8 rawButton];

  [v9 setRAWMode:v5 animated:v3];
  [v10 setRAWMode:v5 animated:v3];
}

- (void)setRawMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:a3];

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)setPhotoResolution:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self currentPhotoFormat];

  [(CAMViewfinderViewController *)self handleUserChangedToPhotoFormat:v5, a3];
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_essentialPhotoFormat
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 fallbackPhotoFormatForDesiredFormat:objc_msgSend(v3 mode:"photoEncodingBehavior") device:objc_msgSend(v3, "preferredHEICPhotoResolutionForDevicePosition:", -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")), -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")];
  v6 = v5;

  v7 = v4;
  v8 = v6;
  result.var1 = v8;
  result.var0 = v7;
  return result;
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_advancedPhotoFormat
{
  v3 = [(CAMViewfinderViewController *)self _desiredAdvancedPhotoFormat];
  v5 = v4;
  v6 = [(CAMViewfinderViewController *)self _currentMode];
  v7 = [(CAMViewfinderViewController *)self _currentDevice];
  v8 = +[CAMUserPreferences preferences];
  v9 = [v8 isPhotoFormat:v3 enabledForMode:v5 device:v6, v7];

  if ((v9 & 1) == 0)
  {
    v10 = [(CAMViewfinderViewController *)self _enabledPhotoFormatsForMode:v6 device:v7];
    v11 = [(CAMViewfinderViewController *)self _essentialPhotoFormat];
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __51__CAMViewfinderViewController__advancedPhotoFormat__block_invoke;
    v18[3] = &__block_descriptor_48_e24_B32__0__NSValue_8Q16_B24l;
    v18[4] = v11;
    v18[5] = v12;
    v13 = [v10 indexOfObjectWithOptions:2 passingTest:v18];
    if (v13 == 0x7FFFFFFFFFFFFFFFLL)
    {
      v14 = 0;
    }

    else
    {
      v14 = v13;
    }

    v15 = [v10 objectAtIndexedSubscript:v14];
    v19 = 0;
    v20 = 0;
    [v15 getValue:&v19 size:16];
    v3 = v19;
    v5 = v20;
  }

  v16 = v3;
  v17 = v5;
  result.var1 = v17;
  result.var0 = v16;
  return result;
}

BOOL __51__CAMViewfinderViewController__advancedPhotoFormat__block_invoke(uint64_t a1, void *a2)
{
  v5 = 0;
  v6 = 0;
  [a2 getValue:&v5 size:16];
  return v5 != *(a1 + 32) || v6 != *(a1 + 40);
}

- (void)_handlePhotoFormatPickerTapped
{
  v1 = [a1 _currentGraphConfiguration];
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0(&dword_1A3640000, v2, v3, "Photo format picker tapped from unsupported configuration: %{public}@", v4, v5, v6, v7, v8);
}

- (void)_handlePhotoFormatPickerChangedPhotoFormat:(id)a3
{
  v4 = [a3 photoFormat];
  v6 = v5;
  [(CAMViewfinderViewController *)self _setDesiredPhotoFormat:v4, v5];

  [(CAMViewfinderViewController *)self handleUserChangedToPhotoFormat:v4, v6];
}

- (void)handleUserChangedToPhotoFormat:(id)a3
{
  var1 = a3.var1;
  var0 = a3.var0;
  v6 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v8 = v7;
  v9 = var0 == 2;
  [(CAMViewfinderViewController *)self _setDesiredPhotoResolution:var1];
  [(CAMViewfinderViewController *)self _setDesiredRAWMode:v9];
  if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== v9)
  {
    if (var1 == 3)
    {
      [(CAMViewfinderViewController *)self _setPhotoFormatConflict:2 isConflicting:0];
    }

    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
  }

  else
  {
    [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:v9];
  }

  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:v10 fromGraphConfiguration:v11 animated:1];

  v20 = +[CAMCaptureCapabilities capabilities];
  v12 = [v20 isDepthSuggestionSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:"_currentMode") photoFormat:-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition"), v6, v8];
  v13 = [(CAMViewfinderViewController *)self _currentMode];
  v14 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v15 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(v14) = [v20 isDepthSuggestionSupportedForMode:v13 devicePosition:v14 photoFormat:v15, v16];
  v17 = [v20 portraitInPhotoModeBehavior];
  if (v12 != v14)
  {
    v18 = v17;
    if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
    {
      if ((v18 & 4) != 0)
      {
        v19 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v19 animated:1];
      }
    }
  }
}

- (void)_handlePhotoFormatPickerLongPressed:(id)a3
{
  v3 = a3;
  if (([v3 isExpanded] & 1) == 0)
  {
    [v3 setExpanded:1 animated:1];
  }
}

- (void)_updatePhotoFormatPickerAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:v5];

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _enabledPhotoFormatsForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]];
    v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v9 = [v8 controlStatusBar];
    v10 = [v9 photoFormatStatusIndicator];

    v19 = [(CAMViewfinderViewController *)self _essentialPhotoFormat];
    v20 = v11;
    v12 = [MEMORY[0x1E696B098] valueWithBytes:&v19 objCType:"{?=qq}"];
    v13 = [v7 indexOfObject:v12];

    v19 = [(CAMViewfinderViewController *)self _advancedPhotoFormat];
    v20 = v14;
    v15 = [MEMORY[0x1E696B098] valueWithBytes:&v19 objCType:"{?=qq}"];
    v16 = [v7 indexOfObject:v15];

    [v10 setAllowedFormats:v7 essentialFormatIndex:v13 advancedFormatIndex:v16];
    v17 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    [v10 setPhotoFormat:v17 animated:v18, v3];
    [v10 setLongPressEnabled:{objc_msgSend(v7, "count") > 2}];
  }
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)currentPhotoFormat
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 resolvedPhotoFormatForResolvedResolution:-[CAMViewfinderViewController _resolvedPhotoResolution](self rawMode:{"_resolvedPhotoResolution"), -[CAMViewfinderViewController _resolvedRAWMode](self, "_resolvedRAWMode")}];
  v6 = v5;

  v7 = v4;
  v8 = v6;
  result.var1 = v8;
  result.var0 = v7;
  return result;
}

- (id)_enabledPhotoFormatsForMode:(int64_t)a3 device:(int64_t)a4
{
  v18 = *MEMORY[0x1E69E9840];
  v6 = +[CAMUserPreferences preferences];
  v14[0] = [v6 photoEncodingBehavior];
  v14[1] = 1;
  v14[2] = v14[0];
  v14[3] = 2;
  v14[4] = v14[0];
  v15 = xmmword_1A3A68310;
  v16 = xmmword_1A3A681C0;
  v17 = 3;
  v7 = [MEMORY[0x1E695DF70] array];
  for (i = 0; i != 10; i += 2)
  {
    v9 = v14[i];
    v10 = v14[i + 1];
    if ([v6 isPhotoFormat:v9 enabledForMode:v10 device:a3, a4])
    {
      v13[0] = v9;
      v13[1] = v10;
      v11 = [MEMORY[0x1E696B098] valueWithBytes:v13 objCType:"{?=qq}"];
      [v7 addObject:v11];
    }
  }

  return v7;
}

- (void)_handleProResIndicator
{
  v3 = [(CAMViewfinderViewController *)self _desiredProResVideoMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedProResMode:v3];
}

- (void)handleUserChangedProResMode:(int64_t)a3 chromeSelectedProResColorSpace:(int64_t)a4
{
  [(CAMViewfinderViewController *)self set_chromeSelectedProResColorSpace:a4];
  v6 = +[CAMUserPreferences preferences];
  [v6 setExplicitProResColorSpace:{-[CAMViewfinderViewController _chromeSelectedProResColorSpace](self, "_chromeSelectedProResColorSpace")}];
  [(CAMViewfinderViewController *)self handleUserChangedProResMode:a3];
}

- (void)handleUserChangedProResMode:(int64_t)a3
{
  v27 = *MEMORY[0x1E69E9840];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v8 = v7;
  if (a3 || !v7)
  {
    if (a3 == 1)
    {
      v9 = [(CAMViewfinderViewController *)self _connectedStorage];
      v10 = v9 != 0;

      v8 |= v10;
    }
  }

  else
  {
    v8 = 0;
  }

  v11 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    if (a3 == 1)
    {
      v12 = @"ON";
    }

    else
    {
      v12 = @"OFF";
    }

    v13 = [(CAMViewfinderViewController *)self _connectedStorage];
    if (v13)
    {
      v3 = [(CAMViewfinderViewController *)self _connectedStorage];
      v14 = [v3 displayName];
    }

    else
    {
      v14 = @"NONE";
    }

    v15 = @"NO";
    if (v8)
    {
      v15 = @"YES";
    }

    v16 = v15;
    v21 = 138543874;
    v22 = v12;
    v23 = 2114;
    v24 = v14;
    v25 = 2114;
    v26 = v16;
    _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "External storage: userChangedProResMode proResMode=%{public}@, connectedStorage=%{public}@, resolvedExternalStorageOutput=%{public}@", &v21, 0x20u);
    if (v13)
    {
    }
  }

  v17 = +[CAMCaptureCapabilities capabilities];
  v18 = [v17 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:objc_msgSend(v6 frontRearSimultaneousVideoEnabled:{"videoConfiguration"), v8 & 1, objc_msgSend(v6, "frontRearSimultaneousVideoEnabled")}];

  if (a3 == 1 && v18 && [(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:2])
  {
    [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
  }

  else if ((a3 != 1) | v18 & 1)
  {
    [(CAMViewfinderViewController *)self _setDesiredProResVideoMode:a3];
    v19 = [v6 device];
    -[CAMViewfinderViewController set_videoConfigurationOverride:](self, "set_videoConfigurationOverride:", -[CAMViewfinderViewController _mappedVideoConfigurationForVideoConfiguration:proResVideoMode:outputToExternalStorage:](self, "_mappedVideoConfigurationForVideoConfiguration:proResVideoMode:outputToExternalStorage:", [v6 videoConfiguration], -[CAMViewfinderViewController _desiredProResVideoMode](self, "_desiredProResVideoMode"), v8 & 1));
    v20 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:v19 fromGraphConfiguration:v6];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v6 toGraphConfiguration:v20 zoomFactor:1 deferIfConfigurationInFlight:?];
    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:v8 & 1 animated:1];
  }

  else
  {
    -[CAMViewfinderViewController _showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:](self, "_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:", [v6 videoConfiguration]);
  }
}

- (void)_updateProResButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v6 controlStatusBar];
  v14 = [v7 proResIndicator];

  v8 = [(CAMViewfinderViewController *)self _controlDrawer];
  v9 = [v8 proResButton];

  [v9 setProResVideoMode:v5 animated:v3];
  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [v10 videoConfiguration];
  v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v13 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", 1, v11, 2, [v12 device]);

  [v14 setProResVideoMode:v5 colorSpace:v13 animated:v3];
}

- (void)_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:(int64_t)a3
{
  v21 = CAMLocalizedFrameworkString(@"PRO_RES_UNSUPPORTED_ALERT_TITLE", 0);
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  v7 = +[CAMCaptureCapabilities capabilities];
  if ([v7 externalStorageSupported])
  {
    if (((a3 < 7) & (0x4Cu >> a3)) != 0)
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_720P";
    }

    else
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_1080P_HFR";
    }

    if (((a3 < 7) & (0x4Cu >> a3)) != 0 || ((a3 < 7) & (0x10u >> a3)) != 0)
    {
      goto LABEL_23;
    }

    if (!v6)
    {
      v10 = [v7 isBack4k120VideoSupported];
      v11 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_1080P30_MAX";
      v12 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_1080P30_MAX_4k120";
LABEL_17:
      if (v10)
      {
        v8 = v12;
      }

      else
      {
        v8 = v11;
      }

      goto LABEL_23;
    }

    v9 = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode];
    if (v9 != 1)
    {
      if (!v9)
      {
        v10 = [v7 isBack4k120VideoSupported];
        v11 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_4k30_MAX";
        v12 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_4k30_MAX_4k120";
        goto LABEL_17;
      }

LABEL_20:
      v14 = 0;
      goto LABEL_24;
    }

    v8 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_28K30_MAX";
  }

  else if (v6)
  {
    v13 = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode];
    if (v13)
    {
      if (v13 != 1)
      {
        goto LABEL_20;
      }

      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_28K30_MAX";
    }

    else
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_4k30_MAX";
    }
  }

  else
  {
    v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_1080P30_MAX";
  }

LABEL_23:
  v14 = CAMLocalizedFrameworkString(v8, 0);
LABEL_24:
  v15 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v21 message:v14 preferredStyle:1];
  v16 = MEMORY[0x1E69DC648];
  v17 = CAMLocalizedFrameworkString(@"PRO_RES_UNSUPPORTED_ALERT_OK", 0);
  v18 = [v16 actionWithTitle:v17 style:0 handler:0];
  [v15 addAction:v18];

  [(CAMViewfinderViewController *)self presentViewController:v15 animated:1 completion:0];
  v19 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v20 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v19 setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", v20)}];
}

- (void)_startOrCancelPurgeIfNecessary
{
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isProResVideoSupportedForMode:objc_msgSend(v9 videoConfiguration:"mode") outputToExternalStorage:objc_msgSend(v9 frontRearSimultaneousVideoEnabled:{"videoConfiguration"), -[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), objc_msgSend(v9, "frontRearSimultaneousVideoEnabled")}];

  v5 = [v9 videoEncodingBehavior];
  v6 = [(CAMViewfinderViewController *)self _storageController];
  v7 = [v6 purgeableStorageContainer];
  v8 = v7;
  if (v4 && v5 == 2)
  {
    [v7 purgeFastPurgeableSpaceWithRequestType:0];
  }

  else
  {
    [v7 cancelPurge];
  }
}

- (void)_updateMaxRecordingTimeInstructionLabelForGraphConfiguration:(id)a3
{
  v14 = a3;
  v4 = [v14 videoConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isProResVideoSupportedForMode:objc_msgSend(v14 videoConfiguration:"mode") outputToExternalStorage:objc_msgSend(v14 frontRearSimultaneousVideoEnabled:{"videoConfiguration"), -[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), objc_msgSend(v14, "frontRearSimultaneousVideoEnabled")}];

  v7 = [v14 videoEncodingBehavior];
  if (v6)
  {
    v8 = v4 == 0;
  }

  else
  {
    v8 = 1;
  }

  if (!v8 && v7 == 2)
  {
    v10 = [(CAMViewfinderViewController *)self _storageController];
    [v10 availableRecordingTimeInSecondsForGraphConfiguration:v14];
    v12 = v11;

    v13 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v13 setRemainingRecordingTime:v12];
  }
}

- (void)_updateFreeResourcesInstructionLabelForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v16 = [v3 freeResourcesInstructionLabel];

  v4 = [(CAMViewfinderViewController *)self _storageController];
  v5 = [(CAMViewfinderViewController *)self _urgentlyNeedsToPurgeDiskSpace];
  v6 = [v4 purgeableStorageContainer];
  v7 = [v6 isPurging];

  v8 = [v4 purgeableStorageContainer];
  v9 = [v8 isCancelingPurge];

  LOBYTE(v8) = [(CAMViewfinderViewController *)self _hasSignificantAmountOfRecordingTimeForCurrentConfiguration];
  v10 = [v4 purgeableStorageContainer];
  v11 = [v10 hasPurgeableResources];

  v12 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v13 = 3;
  if (((v8 | v12) | v11))
  {
    v13 = 0;
  }

  v14 = 1;
  if (v5)
  {
    v14 = 2;
  }

  if (v9)
  {
    v14 = 4;
  }

  if (v7)
  {
    v15 = v14;
  }

  else
  {
    v15 = v13;
  }

  [v16 setFreeResourceInstructionState:v15];
}

- (void)_handleFreeResourcesLabelTapped:(id)a3
{
  v8 = [(CAMViewfinderViewController *)self _storageController];
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 freeResourcesInstructionLabel];

  v6 = [v5 freeResourceInstructionState];
  if (v6 == 3)
  {
    CAMShowStorageUsageInSettings();
  }

  else
  {
    if (v6 == 1)
    {
      v7 = [v8 purgeableStorageContainer];
      [v7 cancelPurge];
    }

    else
    {
      if (v6)
      {
        goto LABEL_8;
      }

      v7 = [v8 purgeableStorageContainer];
      [v7 purgeFastPurgeableSpaceWithRequestType:1];
    }
  }

LABEL_8:
}

- (void)_handleCleanLensesInstructionLabelTapped:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v4 devicePosition];

  if (v5)
  {
    if (v5 != 1)
    {
      goto LABEL_6;
    }

    v6 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  }

  v7 = v6;
  [v6 acknowledgeSmudgeDetection];

LABEL_6:
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v8 animated:1];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (BOOL)_urgentlyNeedsToPurgeDiskSpace
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 videoConfiguration];

  if (!v4)
  {
    return 0;
  }

  v5 = [(CAMViewfinderViewController *)self _storageController];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v5 availableRecordingTimeInSecondsForGraphConfiguration:v6];
  v8 = v7;

  v9 = v8 <= 10.0;
  return v9;
}

- (BOOL)_hasSignificantAmountOfRecordingTimeForCurrentConfiguration
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 videoConfiguration];

  if (!v4)
  {
    return 1;
  }

  v5 = [(CAMViewfinderViewController *)self _storageController];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v5 availableRecordingTimeInSecondsForGraphConfiguration:v6];
  v8 = v7;

  v9 = v8 > 900.0;
  return v9;
}

- (int64_t)_mappedVideoConfigurationForVideoConfiguration:(int64_t)a3 proResVideoMode:(int64_t)a4 outputToExternalStorage:(BOOL)a5
{
  v5 = a5;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:a3 frontRearSimultaneousVideoEnabled:{v5, -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  if (!a4 || (v10 & 1) != 0)
  {
    return a3;
  }

  if (a3 <= 9)
  {
    if (a3 != 1 && a3 != 5)
    {
      if (a3 == 9)
      {
        v11 = +[CAMCaptureCapabilities capabilities];
        v12 = [v11 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

        if (v12)
        {
          return 1;
        }

        else
        {
          return 7;
        }
      }

      return a3;
    }

    return 7;
  }

  if ((a3 - 13) < 2)
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    v14 = [v13 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:9 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

    v15 = +[CAMCaptureCapabilities capabilities];
    v16 = [v15 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

    v17 = 7;
    if (v16)
    {
      v17 = 1;
    }

    if (v14)
    {
      return 9;
    }

    else
    {
      return v17;
    }
  }

  else
  {
    if (a3 == 12)
    {
      return 11;
    }

    if (a3 == 10)
    {
      return 7;
    }
  }

  return a3;
}

- (void)_updateVideoStabilizationButtonAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  v6 = [(CAMViewfinderViewController *)self _controlDrawer];
  v7 = [v6 videoStabilizationButton];
  [v7 setVideoStabilizationMode:v5 animated:v3];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 controlStatusBar];
  v10 = [v9 videoStabilizationIndicator];
  [v10 setVideoStabilizationMode:v5 animated:v3];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = [v13 badgeTray];
  v12 = [v11 videoStabilizationBadge];
  [v12 setVideoStabilizationMode:v5];
}

- (void)_handleVideoStabilizationIndicator
{
  v3 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedVideoStabilizationMode:v3];
}

- (void)handleUserChangedVideoStabilizationMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setDesiredVideoStabilizationMode:?];
  [(CAMViewfinderViewController *)self _startFlashingVideoStabilizationBadge];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:1];
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __71__CAMViewfinderViewController_handleUserChangedVideoStabilizationMode___block_invoke;
  v12[3] = &unk_1E76F9970;
  v14 = self;
  v15 = a3;
  v13 = v5;
  v9 = v5;
  -[CAMViewfinderViewController set_videoConfigurationOverride:](self, "set_videoConfigurationOverride:", [v7 validatedVideoConfigurationForVideoConfiguration:v8 withBlock:v12]);

  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:v6 fromGraphConfiguration:v10];
  [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v11];
  [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v10 toGraphConfiguration:v11 zoomFactor:1 deferIfConfigurationInFlight:?];
}

uint64_t __71__CAMViewfinderViewController_handleUserChangedVideoStabilizationMode___block_invoke(uint64_t a1, uint64_t a2)
{
  v17 = [*(a1 + 32) videoStabilizationStrengthForVideoStabilizationMode:*(a1 + 48) captureMode:{objc_msgSend(*(a1 + 40), "_currentMode")}];
  v3 = +[CAMCaptureCapabilities capabilities];
  v16 = [*(a1 + 40) _currentMode];
  v4 = [*(a1 + 40) _currentDevice];
  v5 = [*(a1 + 40) _currentGraphConfiguration];
  v6 = [v5 videoEncodingBehavior];
  v7 = [*(a1 + 40) _externalStorageOutputEnabled];
  v8 = [*(a1 + 40) _currentGraphConfiguration];
  v9 = [v8 trueVideoEnabled];
  v10 = [*(a1 + 40) _currentGraphConfiguration];
  v11 = [v10 prefersHDR10BitVideo];
  v12 = [*(a1 + 40) _currentGraphConfiguration];
  BYTE2(v15) = [v12 frontRearSimultaneousVideoEnabled];
  BYTE1(v15) = v11;
  LOBYTE(v15) = v9;
  v13 = [v3 isVideoStabilizationStrength:v17 supportedForMode:v16 device:v4 videoConfiguration:a2 videoEncodingBehavior:v6 outputToExternalStorage:v7 trueVideoEnabled:v15 prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:?];

  return v13;
}

- (void)_startFlashingVideoStabilizationBadge
{
  [CAMViewfinderViewController cancelPreviousPerformRequestsWithTarget:self selector:sel__stopFlashingVideoStabilizationBadge object:0];
  [(CAMViewfinderViewController *)self _setFlashingVideoStabilizationBadge:1];
  +[CAMLivePhotoButton enablingAnimationDuration];

  [(CAMViewfinderViewController *)self performSelector:sel__stopFlashingVideoStabilizationBadge withObject:0 afterDelay:?];
}

- (void)_stopFlashingVideoStabilizationBadge
{
  [CAMViewfinderViewController cancelPreviousPerformRequestsWithTarget:self selector:sel__stopFlashingVideoStabilizationBadge object:0];
  [(CAMViewfinderViewController *)self _setFlashingVideoStabilizationBadge:0];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (BOOL)videoConfigurationStatusIndicatorShouldRespondToTap:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 trueVideoEnabled];

  return v4 ^ 1;
}

- (void)handleUserChangedToVideoConfiguration:(int64_t)a3
{
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self frontRearSimultaneousVideoEnabled:{"_currentMode"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
  v8 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:a3 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
  if (!v7 || (v8 & 1) != 0 || [(CAMViewfinderViewController *)self _desiredProResVideoMode]!= 1)
  {
    v9 = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
    v10 = +[CAMUserPreferences preferences];
    v11 = [v10 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    v12 = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationModeForVideoConfiguration:a3];
    v13 = +[CAMUserPreferences preferences];
    v14 = [v13 videoStabilizationStrengthForVideoStabilizationMode:v12 captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

    v15 = +[CAMCaptureCapabilities capabilities];
    v16 = [v15 resolvedDeviceForDesiredDevice:v11 mode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") videoStabilizationStrength:a3 frontRearSimultaneousVideoEnabled:{v14, v9}];

    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [CAMZoomControlUtilities equivalentZoomFactor:v16 forDevice:[(CAMViewfinderViewController *)self _currentDevice] fromDevice:v17];
    v19 = v18;
    v20 = [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v16 fromDevice:[(CAMViewfinderViewController *)self _currentMode] mode:[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 videoConfiguration:a3 videoStabilizationStrength:v14 frontRearSimultaneousVideoEnabled:v9 zoomFactors:0 displayZoomFactors:0] continuousZoomSupported:v18];
    v21 = +[CAMCaptureCapabilities capabilities];
    v22 = [v21 isSupportedVideoConfiguration:a3 forMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), v20}];

    if (v22)
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [CAMZoomControlUtilities equivalentZoomFactor:v20 forDevice:[(CAMViewfinderViewController *)self _currentDevice] fromDevice:v23];
      v25 = v24;
      v16 = v20;
    }

    else
    {
      v35 = 0;
      [CAMZoomControlUtilities shouldApplyContinuousZoomForMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 videoConfiguration:a3 videoStabilizationStrength:v14 frontRearSimultaneousVideoEnabled:v9 zoomFactors:&v35 displayZoomFactors:0];
      v26 = v35;
      v27 = [v26 lastObject];
      [v27 floatValue];
      v29 = v28;

      if (v19 >= v29)
      {
        [v26 lastObject];
      }

      else
      {
        [v26 firstObject];
      }
      v30 = ;

      [v30 floatValue];
      v32 = v31;

      v25 = v32;
    }

    v33 = [(CAMViewfinderViewController *)self _currentMode];
    if (v33 > 9)
    {
      goto LABEL_16;
    }

    if (((1 << v33) & 0x378) != 0)
    {
      goto LABEL_21;
    }

    if (v33 == 2)
    {
      [(CAMViewfinderViewController *)self set_slomoConfigurationOverride:a3];
      goto LABEL_20;
    }

    if (v33 == 7)
    {
      [(CAMViewfinderViewController *)self set_cinematicConfigurationOverride:a3];
    }

    else
    {
LABEL_16:
      if (!v33)
      {
        goto LABEL_21;
      }

      if (v33 == 1)
      {
        [(CAMViewfinderViewController *)self set_videoConfigurationOverride:a3];
      }
    }

LABEL_20:
    v34 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 fromGraphConfiguration:v6];
    [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v34 animated:1];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v6 toGraphConfiguration:v34 zoomFactor:1 deferIfConfigurationInFlight:v25];

    goto LABEL_21;
  }

  [(CAMViewfinderViewController *)self _showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:a3];
LABEL_21:
}

- (void)_advanceVideoFrameRate
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 videoConfiguration];

  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v5 videoEncodingBehavior];

  v7 = [(CAMViewfinderViewController *)self _nextFramerateVideoConfigurationForVideoConfiguration:v4 videoEncodingBehavior:v6];
  if (v7 != v4)
  {

    [(CAMViewfinderViewController *)self handleUserChangedToVideoConfiguration:v7];
  }
}

- (BOOL)shouldSwitchToVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4
{
  v7 = +[CAMUserPreferences preferences];
  v8 = [(CAMViewfinderViewController *)self _currentMode];
  if (-[CAMViewfinderViewController _isFrontRearSimultaneousVideoActiveForMode:devicePosition:](self, "_isFrontRearSimultaneousVideoActiveForMode:devicePosition:", v8, -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")) && (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v9 = objc_claimAutoreleasedReturnValue(), v10 = [v9 isFrontRearSimultaneousVideoSupportedForVideoConfiguration:a3], v9, !v10))
  {
    v18 = 0;
  }

  else
  {
    v11 = [v7 defaultDeviceForModeChange:v8 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
    v12 = +[CAMCaptureCapabilities capabilities];
    v13 = [v12 isSupportedVideoConfiguration:a3 forMode:v8 device:v11];

    v14 = [v7 isPALVideoEnabled];
    if ([v7 usingMostCompatibleEncoding])
    {
      v15 = 1;
    }

    else
    {
      +[CAMCaptureCapabilities capabilities];
      v17 = v16 = a3;
      v15 = [v17 isHEVCEncodingSupported] ^ 1;

      a3 = v16;
    }

    v37 = a4;
    switch(a3)
    {
      case 1:
      case 5:
      case 7:
      case 10:
        goto LABEL_7;
      case 2:
        break;
      case 3:
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 is1080p240SupportedForDevice:v11];

        LOBYTE(v15) = v15 | v22 ^ 1;
        break;
      case 4:
        if (v8 != 2)
        {
          goto LABEL_21;
        }

        goto LABEL_7;
      case 6:
        v19 = +[CAMCaptureCapabilities capabilities];
        v20 = [v19 is4k30VideoSupportedForDevice:v11];

        if (v20)
        {
          LOBYTE(v15) = [v7 videoConfiguration] == 6;
        }

        else
        {
LABEL_7:
          LOBYTE(v15) = 1;
        }

        break;
      case 8:
        v15 = v15 ^ 1 | [v7 didConfirmSlomoMostCompatible];
        break;
      case 9:
      case 13:
LABEL_21:
        v25 = [v7 didConfirmVideoMostCompatible];
        v15 = v15 ^ 1 | v25 | (a4 == 2) | [v7 didConfirmSlomoMostCompatible];
        break;
      case 11:
      case 12:
        LOBYTE(v15) = v14;
        break;
      case 14:
        v23 = [v7 didConfirmVideoMostCompatible];
        if (a4 == 2)
        {
          v24 = 1;
        }

        else
        {
          v24 = v23;
        }

        if ((v14 & v15) != 0)
        {
          LOBYTE(v15) = v24;
        }

        else
        {
          LOBYTE(v15) = v14;
        }

        break;
      default:
        LOBYTE(v15) = 0;
        break;
    }

    v26 = v13 & v15;
    if ([(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode]== 1)
    {
      v27 = +[CAMCaptureCapabilities capabilities];
      v36 = [(CAMViewfinderViewController *)self _currentMode];
      v28 = [(CAMViewfinderViewController *)self _currentDevice];
      v29 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v30 = [v29 trueVideoEnabled];
      v31 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v32 = [v31 prefersHDR10BitVideo];
      LOBYTE(v35) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
      v33 = [v27 isActionModeControlSupportedForMode:v36 device:v28 videoConfiguration:a3 videoEncodingBehavior:v37 trueVideoEnabled:v30 prefersHDR10BitVideo:v32 frontRearSimultaneousVideoEnabled:v35];
    }

    else
    {
      v33 = 1;
    }

    v18 = v26 & v33;
  }

  return v18;
}

- (int64_t)_nextFramerateVideoConfigurationForVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4
{
  v5 = a3;
  v19 = *MEMORY[0x1E69E9840];
  if ((a3 - 1) > 0xD)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1E76F9E70[a3 - 1];
  }

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    while (2)
    {
      for (i = 0; i != v9; ++i)
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = [*(*(&v14 + 1) + 8 * i) intValue];
        if ([(CAMViewfinderViewController *)self shouldSwitchToVideoConfiguration:v12 videoEncodingBehavior:a4])
        {
          return v12;
        }
      }

      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v9)
      {
        continue;
      }

      break;
    }
  }

  return v5;
}

- (void)_advanceVideoResolution
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v3 videoConfiguration];

  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v5 videoEncodingBehavior];

  v7 = [(CAMViewfinderViewController *)self _nextResolutionVideoConfigurationForVideoConfiguration:v4 videoEncodingBehavior:v6];
  if (v7 != v4)
  {

    [(CAMViewfinderViewController *)self handleUserChangedToVideoConfiguration:v7];
  }
}

- (int64_t)_nextResolutionVideoConfigurationForVideoConfiguration:(int64_t)a3 videoEncodingBehavior:(int64_t)a4
{
  v5 = a3;
  v19 = *MEMORY[0x1E69E9840];
  if ((a3 - 1) > 0xD)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1E76F9EE0[a3 - 1];
  }

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    while (2)
    {
      for (i = 0; i != v9; ++i)
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = [*(*(&v14 + 1) + 8 * i) intValue];
        if ([(CAMViewfinderViewController *)self shouldSwitchToVideoConfiguration:v12 videoEncodingBehavior:a4])
        {
          return v12;
        }
      }

      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v9)
      {
        continue;
      }

      break;
    }
  }

  return v5;
}

- (void)captureController:(id)a3 didOutputFlashActive:(BOOL)a4
{
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1, a4];
  v5 = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:v5 animated:1];
}

- (void)captureController:(id)a3 didOutputTorchActive:(BOOL)a4
{
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1, a4];
  v5 = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:v5 animated:1];
}

- (void)captureController:(id)a3 didOutputNightModeStatus:(int64_t)a4
{
  v13 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "NightMode");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    if ((a4 + 1) > 3)
    {
      v7 = 0;
    }

    else
    {
      v7 = off_1E76F9F50[a4 + 1];
    }

    v11 = 138543362;
    v12 = v7;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "NightModeStatus: %{public}@", &v11, 0xCu);
  }

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  v8 = [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling];
  if (a4 != -1)
  {
    v9 = v8;
    if (!a4)
    {
      [(CAMViewfinderViewController *)self _resetNightModeDurationMappingAnimated:1];
    }

    if (v9)
    {
      v10 = [(CAMViewfinderViewController *)self _closedViewfinderController];
      [v10 removeClosedViewfinderReason:11];

      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture cancel ended"];
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    }
  }

  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
}

- (void)captureController:(id)a3 didOutputNightModeDurationMapping:(id)a4
{
  [(CAMViewfinderViewController *)self _setNightModeDurationMapping:a3, a4.var0, a4.var1];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:1];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v5 isCapturing:0 animated:1];
}

- (void)captureController:(id)a3 didOutputFlashAvailability:(BOOL)a4
{
  v4 = a4;
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
  v6 = [(CAMViewfinderViewController *)self _currentMode];
  if (v6 <= 9 && ((1 << v6) & 0x279) != 0 && v4)
  {

    [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  }
}

- (void)captureController:(id)a3 didOutputTorchAvailability:(BOOL)a4
{
  v4 = a4;
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:v6 animated:1];

  [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
  v7 = [(CAMViewfinderViewController *)self _currentMode];
  if (v7 <= 8 && ((1 << v7) & 0x186) != 0 && v4)
  {

    [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  }
}

- (void)captureController:(id)a3 didOutputFlashCompromise:(unint64_t)a4
{
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v6 animated:1];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [v8 flashCompromisedInstructionLabel];
  [v7 setCompromise:a4];
}

- (BOOL)_isFlashUnavailableForMode:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  if (v5 > 9)
  {
    v7 = 0;
  }

  else
  {
    if (((1 << v5) & 0x279) != 0)
    {
      v6 = [v4 isFlashAvailable];
    }

    else
    {
      v6 = [v4 isTorchAvailable];
    }

    v7 = v6 ^ 1;
  }

  return v7;
}

- (BOOL)_isFlashCompromisedForDevicePosition:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 flashCompromise];

  if (a3)
  {
    v6 = 1;
  }

  else
  {
    v6 = (v5 - 1) >= 2;
  }

  return !v6;
}

- (BOOL)_shouldShowFlashCompromisedInstructionsForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 devicePosition];
  v6 = [(CAMViewfinderViewController *)self _isFlashCompromisedForDevicePosition:v5];
  if ((-[CAMViewfinderViewController _displayedFlashModeForMode:flashActive:](self, "_displayedFlashModeForMode:flashActive:", [v4 mode], 0) - 1) > 1)
  {
    v8 = 0;
  }

  else
  {
    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 isFlashSupportedForMode:objc_msgSend(v4 devicePosition:{"mode"), v5}];
  }

  return v6 & v8;
}

- (void)_handleTimerButtonChangedTimerDuration
{
  v3 = [(CAMViewfinderViewController *)self _timerButton];
  -[CAMViewfinderViewController _setResolvedTimerDuration:](self, "_setResolvedTimerDuration:", [v3 duration]);
}

- (void)handleUserChangedToLivePhotoMode:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setDesiredLivePhotoMode:?];
  [(CAMViewfinderViewController *)self _startTimer:1];
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __64__CAMViewfinderViewController_handleUserChangedToLivePhotoMode___block_invoke;
  v9[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
  v9[4] = a3;
  [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v9];
  [(CAMViewfinderViewController *)self _setPhotoFormatConflict:2 isConflicting:a3 != 0];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateNightModeConflict:4 isConflicting:[(CAMViewfinderViewController *)self _resolvedLivePhotoMode]!= 0];
  if (([(CAMViewfinderViewController *)self _resolvedLivePhotoMode]- 1) <= 1)
  {
    v5 = [(CAMViewfinderViewController *)self _livePhotoButton];
    [v5 performEnablingAnimation];

    v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v7 = [v6 controlStatusBar];
    v8 = [v7 livePhotoIndicator];
    [v8 startAnimating];
  }

  if ([CAMBottomBar wantsVerticalBarForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
  }

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_handleLivePhotoButtonChangedLivePhotoMode
{
  v3 = [(CAMViewfinderViewController *)self _livePhotoButton];
  -[CAMViewfinderViewController handleUserChangedToLivePhotoMode:](self, "handleUserChangedToLivePhotoMode:", [v3 livePhotoMode]);
}

- (void)_handleSharedLibraryButton
{
  v4 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  if (CAMSharedLibraryModeIsOn([v4 sharedLibraryMode]))
  {
    v3 = 3;
  }

  else
  {
    v3 = 2;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToSharedLibraryMode:v3];
}

- (void)handleUserChangedToSharedLibraryMode:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [v5 setSharedLibraryMode:a3];
  v6 = [(CAMViewfinderViewController *)self _librarySelectionController];
  [v6 userDidPickSharedLibraryMode:a3];

  [(CAMViewfinderViewController *)self _startTimer:2];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __68__CAMViewfinderViewController_handleUserChangedToSharedLibraryMode___block_invoke;
  v7[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
  v7[4] = a3;
  [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v7];
  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
}

- (void)_setExternalStorageOutputEnabled:(BOOL)a3 animated:(BOOL)a4
{
  v14 = *MEMORY[0x1E69E9840];
  if (self->__externalStorageOutputEnabled != a3)
  {
    v4 = a3;
    v6 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v7 = @"OFF";
      if (v4)
      {
        v7 = @"ON";
      }

      v12 = 138543362;
      v13 = v7;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "External storage: changing external storage output to %{public}@.", &v12, 0xCu);
    }

    if ([(CAMViewfinderViewController *)self _currentMode]== 1 && !v4)
    {
      [(CAMViewfinderViewController *)self _fallbackToValidProResVideoConfigurationIfNeeded];
    }

    self->__externalStorageOutputEnabled = v4;
    if (!v4)
    {
      if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
      {
        v8 = [(CAMViewfinderViewController *)self _cameraRollController];
        [v8 dismissCameraRollViewControllerForced:1 animated:0];
      }
    }

    [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
    [(CAMViewfinderViewController *)self _updateExternalStorageDataSources];
    v9 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v9 setExternalStorageOutputEnabled:v4];

    v10 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [v10 setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", v11)}];
  }
}

- (void)_updateExternalStorageDataSources
{
  if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v5 = [(CAMViewfinderViewController *)self _connectedStorage];
  }

  else
  {
    v5 = 0;
  }

  v3 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v3 setExternalStorage:v5];

  v4 = [(CAMViewfinderViewController *)self _storageController];
  [v4 setExternalStorage:v5];
}

- (void)_fallbackToValidProResVideoConfigurationIfNeeded
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  if ([(CAMViewfinderViewController *)self _desiredProResVideoMode])
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __79__CAMViewfinderViewController__fallbackToValidProResVideoConfigurationIfNeeded__block_invoke;
    aBlock[3] = &unk_1E76F9970;
    v5 = v4;
    v17 = self;
    v18 = v3;
    v16 = v5;
    v6 = _Block_copy(aBlock);
    if ((v6[2](v6, [(CAMViewfinderViewController *)self _currentVideoConfiguration]) & 1) == 0)
    {
      v7 = +[CAMCaptureCapabilities capabilities];
      v8 = [v7 validatedVideoConfigurationForVideoConfiguration:-[CAMViewfinderViewController _currentVideoConfiguration](self withBlock:{"_currentVideoConfiguration"), v6}];

      [(CAMViewfinderViewController *)self set_videoConfigurationOverride:v8];
      v9 = [(CAMViewfinderViewController *)self _currentMode];
      v10 = [(CAMViewfinderViewController *)self _currentDevicePosition];
      v11 = +[CAMUserPreferences preferences];
      v12 = [v11 defaultDeviceForModeChange:v9 devicePosition:v10];

      v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v14 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:v9 device:v12 fromGraphConfiguration:v13];
      [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v14];
      [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v13 toGraphConfiguration:v14 zoomFactor:1 deferIfConfigurationInFlight:?];
    }
  }
}

uint64_t __79__CAMViewfinderViewController__fallbackToValidProResVideoConfigurationIfNeeded__block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 32);
  v4 = *(a1 + 48);
  v5 = [*(a1 + 40) _isFrontRearSimultaneousVideoEnabled];

  return [v3 isProResVideoSupportedForMode:v4 videoConfiguration:a2 outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:v5];
}

- (void)_showExternalStorageRecordingFailedAlert
{
  v3 = MEMORY[0x1E69DC650];
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_RECORDING_FAILED_TITLE", 0);
  v5 = CAMLocalizedFrameworkString(@"EXTERNAL_RECORDING_FAILED_MESSAGE", 0);
  v11 = [v3 alertControllerWithTitle:v4 message:v5 preferredStyle:1];

  v6 = MEMORY[0x1E69DC648];
  v7 = CAMLocalizedFrameworkString(@"OK", 0);
  v8 = [v6 actionWithTitle:v7 style:1 handler:0];
  [v11 addAction:v8];

  v9 = [(CAMViewfinderViewController *)self view];
  v10 = [v9 window];

  [v10 pl_presentViewController:v11 animated:1];
}

- (unint64_t)_previousModeSwipeDirectionForLayoutStyle:(int64_t)a3
{
  v3 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v4 = +[CAMUserPreferences preferences];
  v5 = [v4 classicModeSwitchingEnabled];

  v6 = 4;
  if (v5)
  {
    v6 = 8;
  }

  v7 = 1;
  if (!v5)
  {
    v7 = 2;
  }

  if (v3)
  {
    return v6;
  }

  else
  {
    return v7;
  }
}

- (unint64_t)_nextModeSwitchDirectionForLayoutStyle:(int64_t)a3
{
  v3 = [CAMBottomBar wantsVerticalBarForLayoutStyle:a3];
  v4 = +[CAMUserPreferences preferences];
  v5 = [v4 classicModeSwitchingEnabled];

  v6 = 8;
  if (v5)
  {
    v6 = 4;
  }

  v7 = 1;
  if (v5)
  {
    v7 = 2;
  }

  if (v3)
  {
    return v6;
  }

  else
  {
    return v7;
  }
}

- (void)_updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:(int64_t)a3
{
  v6 = [(CAMViewfinderViewController *)self _previousModeGestureRecognizer];
  [v6 setDirection:{-[CAMViewfinderViewController _previousModeSwipeDirectionForLayoutStyle:](self, "_previousModeSwipeDirectionForLayoutStyle:", a3)}];
  v5 = [(CAMViewfinderViewController *)self _nextModeGestureRecognizer];
  [v5 setDirection:{-[CAMViewfinderViewController _nextModeSwitchDirectionForLayoutStyle:](self, "_nextModeSwitchDirectionForLayoutStyle:", a3)}];
}

- (BOOL)_isSwipeToModeSwitchEnabled
{
  v3 = [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer isEnabled];
  if (v3)
  {
    previousModeGestureRecognizer = self->__previousModeGestureRecognizer;

    LOBYTE(v3) = [(UISwipeGestureRecognizer *)previousModeGestureRecognizer isEnabled];
  }

  return v3;
}

- (void)_setSwipeToModeSwitchEnabled:(BOOL)a3
{
  v3 = a3;
  [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer setEnabled:?];
  previousModeGestureRecognizer = self->__previousModeGestureRecognizer;

  [(UISwipeGestureRecognizer *)previousModeGestureRecognizer setEnabled:v3];
}

- (void)_swipedToNextCameraMode:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self view];
  [v4 locationInView:v5];
  v7 = v6;
  v9 = v8;

  if ([(CAMViewfinderViewController *)self _canPerformModeChangeForSwipeAtLocation:v7, v9])
  {
    v10 = [(CAMViewfinderViewController *)self _currentMode];
    v16 = [(CAMViewfinderViewController *)self modesForModeDial:0];
    v11 = [MEMORY[0x1E696AD98] numberWithInteger:v10];
    v12 = [v16 indexOfObject:v11];

    v13 = [v16 count];
    if (v12 + 1 < (v13 - 1))
    {
      v14 = v12 + 1;
    }

    else
    {
      v14 = v13 - 1;
    }

    if (v12 != v14)
    {
      v15 = [v16 objectAtIndexedSubscript:?];
      -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [v15 integerValue]);
    }
  }
}

- (void)_swipedToPreviousCameraMode:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self view];
  [v4 locationInView:v5];
  v7 = v6;
  v9 = v8;

  if ([(CAMViewfinderViewController *)self _canPerformModeChangeForSwipeAtLocation:v7, v9])
  {
    v10 = [(CAMViewfinderViewController *)self _currentMode];
    v15 = [(CAMViewfinderViewController *)self modesForModeDial:0];
    v11 = [MEMORY[0x1E696AD98] numberWithInteger:v10];
    v12 = [v15 indexOfObject:v11];

    if (v12 <= 1)
    {
      v13 = 1;
    }

    else
    {
      v13 = v12;
    }

    if (v12 != v13 - 1)
    {
      v14 = [v15 objectAtIndexedSubscript:?];
      -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [v14 integerValue]);
    }
  }
}

- (CGRect)_rectForModeChangeSwipeAllowedZone
{
  if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
  {
    v3 = [(CAMViewfinderViewController *)self view];
    [v3 bounds];
    v5 = v4;
    v7 = v6;
    v9 = v8;
    v11 = v10;
  }

  else
  {
    v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v12 collapsedTopBarFrame];
    v14 = v13;
    v16 = v15;

    v17 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v17 externalChromeShutterButtonFrame];
    v19 = v18;

    v7 = v14 + v16;
    v3 = [(CAMViewfinderViewController *)self view];
    [v3 bounds];
    v9 = v20 + -40.0;
    v11 = v19 - v7;
    v5 = 20.0;
  }

  v21 = v5;
  v22 = v7;
  v23 = v9;
  v24 = v11;
  result.size.height = v24;
  result.size.width = v23;
  result.origin.y = v22;
  result.origin.x = v21;
  return result;
}

- (BOOL)_canPerformModeChangeForSwipeAtLocation:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  [(CAMViewfinderViewController *)self _rectForModeChangeSwipeAllowedZone];
  v9 = x;
  v10 = y;

  return CGRectContainsPoint(*&v5, *&v9);
}

- (void)_handleModeDialTouchDown:(id)a3
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 allowHapticsOnConfigurationTaps])
  {
    v4 = [(CAMViewfinderViewController *)self _feedbackController];
    [v4 prepareDiscreteFeedback:0];
  }
}

- (void)_handleModeDialValueChanged:(id)a3
{
  v6 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 allowHapticsOnConfigurationTaps])
  {
    v5 = [(CAMViewfinderViewController *)self _feedbackController];
    [v5 performDiscreteFeedback:0];
  }

  -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [v6 selectedMode]);
}

- (void)_handleFlipButtonTouchDown:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _feedbackController];
  [v3 prepareDiscreteFeedback:0];
}

- (void)handleFlipButtonReleased
{
  v3 = [(CAMViewfinderViewController *)self _feedbackController];
  [v3 performDiscreteFeedback:0];

  v4 = [(CAMViewfinderViewController *)self _currentDevicePosition]== 0;
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), v4}];

  [(CAMViewfinderViewController *)self _handleUserChangedToDevice:v6];
}

- (void)_attemptShutterPressWithBlock:(id)a3
{
  v13 = a3;
  v4 = mach_absolute_time();
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:v4];
  CAMSignpostWithIDAndArgs(11, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  [MEMORY[0x1E69E58C0] cancelPreviousPerformRequestsWithTarget:self selector:sel_pressShutterForRemoteShutter object:0];
  v5 = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
  v6 = [(CAMViewfinderViewController *)self _capturingFromPhysicalButton];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isCameraButtonSupported];

  v9 = v6 & v8;
  if ((v6 & v8 & 1) == 0)
  {
    v10 = [(CAMViewfinderViewController *)self _feedbackController];
    [v10 prepareButtonFeedback:v5];
  }

  if (![(CAMViewfinderViewController *)self _isControlDrawerShowingPersistentControl])
  {
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
  }

  [(CAMViewfinderViewController *)self _dismissOverlays];
  if ([(CAMViewfinderViewController *)self _redirectShutterEventIfNecessary:1])
  {
    v11 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v11 resetAnimated:1];
  }

  else
  {
    [(CAMPreviewViewController *)self->__previewViewController notifyShutterButtonPressed];
    if (v13)
    {
      v13[2](v13, v4);
    }
  }

  if ((v9 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:v5];
    v12 = [(CAMViewfinderViewController *)self _feedbackController];
    [v12 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }
}

- (void)_attemptShutterReleaseWithBlock:(id)a3
{
  v11 = a3;
  CAMSignpostWithIDAndArgs(12, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v4 = [(CAMViewfinderViewController *)self _capturingFromPhysicalButton];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isCameraButtonSupported];

  v7 = v4 & v6;
  if ((v4 & v6 & 1) == 0)
  {
    v8 = [(CAMViewfinderViewController *)self _feedbackController];
    [v8 prepareButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }

  v9 = [(CAMViewfinderViewController *)self _redirectShutterEventIfNecessary:64];
  if (v11 && !v9)
  {
    v11[2]();
  }

  if ((v7 & 1) == 0)
  {
    v10 = [(CAMViewfinderViewController *)self _feedbackController];
    [v10 performReleaseButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }
}

- (BOOL)dynamicShutterControlCanStartOnTouchDown:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  if (v4 > 9 || ((1 << v4) & 0x211) == 0)
  {
    return 1;
  }

  return [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
}

- (BOOL)dynamicShutterControlShouldBeginGesture:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  v5 = [(CAMViewfinderViewController *)self _isActiveZooming];
  if (!v4)
  {
    v6 = [(CAMViewfinderViewController *)self _reasonsToDisableShutterButton];
    v7 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlShouldBeginGesture:v6];
    }
  }

  return v4 && !v5;
}

- (void)dynamicShutterControlGesturesDidBegin:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidBegin", buf, 2u);
  }

  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __69__CAMViewfinderViewController_dynamicShutterControlGesturesDidBegin___block_invoke;
  v5[3] = &unk_1E76F9998;
  v5[4] = self;
  [(CAMViewfinderViewController *)self _attemptShutterPressWithBlock:v5];
}

uint64_t __69__CAMViewfinderViewController_dynamicShutterControlGesturesDidBegin___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isCTMVideoCaptureSupportedForMode:{objc_msgSend(*(a1 + 32), "_currentMode")}];

  v6 = [*(a1 + 32) _captureController];
  v7 = [v6 isCapturingVideo];

  v8 = [*(a1 + 32) _captureController];
  v9 = [v8 isCapturingNightModeImage];

  v10 = [*(a1 + 32) _isCapturingFromTimer];
  result = [*(a1 + 32) _resolvedTimerDuration];
  if (v5 && (v7 & 1) == 0 && (v10 & 1) == 0 && !result && (v9 & 1) == 0)
  {
    v12 = *(a1 + 32);

    return [v12 _initiateCTMCaptureWithCurrentSettingsAtSystemTime:a2];
  }

  return result;
}

- (void)dynamicShutterControlGesturesDidEnd:(id)a3
{
  v4 = a3;
  v5 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    *v9 = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidEnd", v9, 2u);
  }

  [(CAMViewfinderViewController *)self _attemptShutterReleaseWithBlock:0];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v6 setIsUserInteractingWithShutter:0];

  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  if ([(CAMViewfinderViewController *)self _trueVideoIsActive]&& ![(CAMViewfinderViewController *)self _lockedTrueVideoRecording])
  {
    -[CAMViewfinderViewController _setLockedTrueVideoRecording:](self, "_setLockedTrueVideoRecording:", [v4 isLocked]);
  }

  if ([v4 isShutterStateDefault] && -[CAMViewfinderViewController _trueVideoIsTransitioningToCapture](self, "_trueVideoIsTransitioningToCapture"))
  {
    v7 = [(CAMViewfinderViewController *)self _currentMode];
    if (v7 == [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
    }

    else
    {
      v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v8 setTrueVideoState:0];

      [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"True video state changed to idle"];
      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }
  }
}

- (void)dynamicShutterControlGesturesDidCancel:(id)a3
{
  v10 = *MEMORY[0x1E69E9840];
  v4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v4 setIsUserInteractingWithShutter:0];

  if (([(CAMViewfinderViewController *)self _currentMode]| 4) == 4)
  {
    v5 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    if (v5)
    {
      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      v6 = @"cancel CTM capture";
    }

    else
    {
      v6 = @"no context";
    }
  }

  else
  {
    v6 = @"no context";
  }

  v7 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    v8 = 138543362;
    v9 = v6;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidCancel: %{public}@", &v8, 0xCu);
  }
}

- (void)dynamicShutterControlDidShortPress:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v9 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidShortPress", v9, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (v5 <= 9)
  {
    if (((1 << v5) & 0x1AE) != 0)
    {
      [(CAMViewfinderViewController *)self currentCaptureMode];
      v7 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidShortPress:];
      }
    }

    else if (((1 << v5) & 0x11) != 0 && ([(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings], v6 = objc_claimAutoreleasedReturnValue(), v6, v6))
    {
      [(CAMViewfinderViewController *)self _commitCTMCaptureWithType:1];
    }

    else
    {
      [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }
  }
}

- (void)dynamicShutterControlDidStart:(id)a3 withGesture:(int64_t)a4
{
  v6 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidStart", buf, 2u);
  }

  v7 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v7 setIsUserInteractingWithShutter:1];

  v8 = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (v8 <= 3)
  {
    if ((v8 - 1) < 2)
    {
      goto LABEL_17;
    }

    if (v8)
    {
      if (v8 != 3)
      {
        return;
      }

      v10 = [(CAMViewfinderViewController *)self _captureController];
      v11 = [v10 isCapturingPanorama];

      if (v11)
      {
        v9 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
        }

        goto LABEL_20;
      }

      v15 = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:v15];
      goto LABEL_26;
    }

LABEL_21:
    if ([(CAMViewfinderViewController *)self _shouldCaptureWithTimer])
    {
      v14 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *v28 = 0;
        _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: Starting timer countdown", v28, 2u);
      }

      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      [(CAMViewfinderViewController *)self _startCountdownForCaptureTimer];
      return;
    }

    if (a4 == 1)
    {
      [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:1];
      v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v16 isCapturing:1 animated:1];

      v17 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

      v18 = self;
      if (!v17)
      {
        [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
        return;
      }

      v19 = 1;
      goto LABEL_46;
    }

    if ([(CAMViewfinderViewController *)self currentCaptureMode]== 6)
    {
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
      }

      goto LABEL_20;
    }

    v20 = +[CAMCaptureCapabilities capabilities];
    if ([v20 isTrueVideoSupported])
    {
      v21 = [(CAMViewfinderViewController *)self currentCaptureMode];

      if (!v21)
      {
        v15 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v22 = [v15 viewportAspectRatio];
        v23 = self;
        v24 = 0;
        v25 = 1;
LABEL_43:
        [(CAMViewfinderViewController *)v23 _startTransitioningToTrueVideoCaptureFromSourceMode:v24 sourceAspectRatio:v22 toDestinationMode:v25];
LABEL_26:

        return;
      }
    }

    else
    {
    }

    v26 = +[CAMCaptureCapabilities capabilities];
    if ([v26 isSpatialModeTrueVideoSupported])
    {
      v27 = [(CAMViewfinderViewController *)self currentCaptureMode];

      if (v27 == 9)
      {
        v15 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v22 = [v15 viewportAspectRatio];
        v23 = self;
        v24 = 9;
        v25 = 8;
        goto LABEL_43;
      }
    }

    else
    {
    }

    v18 = self;
    v19 = 2;
LABEL_46:
    [(CAMViewfinderViewController *)v18 _commitCTMCaptureWithType:v19];
    return;
  }

  if (v8 > 9)
  {
    return;
  }

  if (((1 << v8) & 0x250) != 0)
  {
    goto LABEL_21;
  }

  if (((1 << v8) & 0x180) != 0)
  {
LABEL_17:
    v12 = [(CAMViewfinderViewController *)self _captureController];
    v13 = [v12 isCapturingVideo];

    if (v13)
    {
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
      }

      goto LABEL_20;
    }

    v15 = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
    [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:v15];
    goto LABEL_26;
  }

  if (v8 != 5)
  {
    return;
  }

  if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
  {
    v9 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
    }

LABEL_20:

    return;
  }

  [(CAMViewfinderViewController *)self _startTimelapse];
}

- (void)dynamicShutterControlDidStartZoomGesture:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didStartZoomGesture", v7, 2u);
  }

  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _setVideoZoomFactorAtDynamicShutterStart:?];
  v5 = [(CAMViewfinderViewController *)self _zoomReporter];
  [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
  [v5 zoomBeganWithFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{5, v6}];
}

- (void)dynamicShutterControlDidStopZoomGesture:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didStopZoomGesture", v6, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _zoomReporter];
  [v5 zoomEndedFromSource:2];
}

- (void)dynamicShutterControl:(id)a3 didChangeRelativeZoomProgress:(double)a4
{
  v15 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 134217984;
    v14 = a4;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didChangeRelativeZoomProgress: %f", buf, 0xCu);
  }

  v7 = +[CAMUserPreferences preferences];
  v8 = [v7 defaultCustomLens];

  if (v8 > 5)
  {
    v9 = NAN;
  }

  else
  {
    v9 = dbl_1A3A684B0[v8] / dbl_1A3A68480[v8];
  }

  v10 = pow(1.0 / (0.5 / v9), a4);
  [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __83__CAMViewfinderViewController_dynamicShutterControl_didChangeRelativeZoomProgress___block_invoke;
  v12[3] = &unk_1E76F99C0;
  v12[4] = self;
  [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:5 rampDuration:v12 interactionType:v11 * v10 didChangeDevice:0.5];
  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:5];
}

uint64_t __83__CAMViewfinderViewController_dynamicShutterControl_didChangeRelativeZoomProgress___block_invoke(uint64_t a1, double a2)
{
  v3 = *(a1 + 32);
  [v3 _videoZoomFactorAtDynamicShutterStart];
  v5 = v4 * a2;

  return [v3 _setVideoZoomFactorAtDynamicShutterStart:v5];
}

- (void)dynamicShutterControlDidStop:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidStop", buf, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (v6 <= 3)
  {
    if ((v6 - 1) < 2)
    {
      goto LABEL_15;
    }

    if (v6)
    {
      if (v6 != 3)
      {
        goto LABEL_33;
      }

      if ([v5 isCapturingPanorama])
      {
        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        goto LABEL_33;
      }

      v11 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStop:];
      }

      goto LABEL_32;
    }

LABEL_17:
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
      goto LABEL_33;
    }

    if ([v5 isCapturingNightModeImage])
    {
      v7 = [(CAMViewfinderViewController *)self _closedViewfinderController];
      [v7 addClosedViewfinderReason:11];

      [(CAMViewfinderViewController *)self _cancelCaptureAnimation];
      v12[0] = MEMORY[0x1E69E9820];
      v12[1] = 3221225472;
      v12[2] = __60__CAMViewfinderViewController_dynamicShutterControlDidStop___block_invoke;
      v12[3] = &unk_1E76F77B0;
      v13 = v5;
      [v13 stopCaptureSessionWithCompletion:v12];
      [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture cancel began"];
      v8 = [(CAMViewfinderViewController *)self _controlDrawer];
      v9 = [v8 nightModeSlider];
      [v9 endCaptureAnimationAnimated:1];

      v10 = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
      [v10 cancelCountDown];

      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
      goto LABEL_33;
    }

    if ([(CAMViewfinderViewController *)self currentCaptureMode]!= 6)
    {
      [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

    goto LABEL_32;
  }

  if (v6 > 9)
  {
    goto LABEL_33;
  }

  if (((1 << v6) & 0x250) != 0)
  {
    goto LABEL_17;
  }

  if (((1 << v6) & 0x180) != 0)
  {
LABEL_15:
    if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
      goto LABEL_33;
    }

    if ([v5 isCapturingVideo])
    {
      [(CAMViewfinderViewController *)self _stopCapturingVideo];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

    goto LABEL_32;
  }

  if (v6 == 5)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
    {
      [(CAMViewfinderViewController *)self _stopTimelapse];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

LABEL_32:
  }

LABEL_33:
}

- (void)dynamicShutterControlDidPressLockButton:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v14 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressLockButton", v14, 2u);
  }

  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  CAMSignpostWithIDAndArgs(13, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  CAMSignpostWithIDAndArgs(14, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v5 = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (v5 <= 9)
  {
    if (((1 << v5) & 0x3E8) != 0)
    {
      [(CAMViewfinderViewController *)self currentCaptureMode];
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
      }

      return;
    }

    if (((1 << v5) & 6) != 0)
    {
      v6 = [(CAMViewfinderViewController *)self _captureController];
      v7 = [v6 isCapturingVideo];

      if (!v7)
      {
        v8 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
        }

        return;
      }
    }

    else
    {
      v11 = [(CAMViewfinderViewController *)self _captureController];
      v12 = [v11 isCapturingVideo];

      if ((v12 & 1) == 0)
      {
        v13 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
        }
      }
    }

    [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
  }
}

- (void)dynamicShutterControlDidPressPauseResumeButton:(id)a3
{
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (v5)
  {
    v6 = [(CAMViewfinderViewController *)self _captureController];
    v7 = [v6 isCapturingVideo];

    if (v7)
    {
      v8 = [(CAMViewfinderViewController *)self _captureController];
      v9 = [v8 videoCapturePaused];

      v10 = os_log_create("com.apple.camera", "DynamicShutter");
      v11 = os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT);
      if (v9)
      {
        if (v11)
        {
          *buf = 0;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressResume", buf, 2u);
        }

        [(CAMViewfinderViewController *)self _resumeCaptureVideo];
      }

      else
      {
        if (v11)
        {
          *v14 = 0;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressPause", v14, 2u);
        }

        [(CAMViewfinderViewController *)self _pauseCapturingVideo];
      }

      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }

    else
    {
      v13 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidPressPauseResumeButton:];
      }
    }
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidPressPauseResumeButton:?];
    }
  }
}

- (void)dynamicShutterControlDidPresentCounter:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPresentCounter", v7, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  if (v5)
  {
    [(CAMViewfinderViewController *)self _cancelCTMCapture];
  }

  else
  {
    v6 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidPresentCounter:];
    }
  }

  [(CAMViewfinderViewController *)self _beginCapturingBurst];
}

- (void)dynamicShutterControlDidDismissCounter:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidDismissCounter", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _stopCapturingBurst];
}

- (void)shutterControlTouchAttemptedWhileDisabled:(id)a3
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: TouchAttemptedWhileDisabled", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _handleDisabledShutterTap];
}

- (void)shutterControlDidUpdateLiquidShutter:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v4 updateChromeViewModel:v5];
}

- (BOOL)_redirectShutterEventIfNecessary:(unint64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v7 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", v5, [v6 isCallActive]);

  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v8 isInterrupted];

  v10 = +[CAMCaptureCapabilities capabilities];
  v11 = [v10 captureOnTouchDown];

  if (a3 != 1)
  {
    if (a3 != 128 && a3 != 64)
    {
      LOBYTE(v9) = 0;
      goto LABEL_14;
    }

    v11 ^= 1u;
  }

  if (v7)
  {
    v12 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Ignoring shutter button while current mode is disabled", buf, 2u);
    }

LABEL_12:

    LOBYTE(v9) = 1;
    goto LABEL_14;
  }

  if ((v9 & v11) == 1)
  {
    v13 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *v15 = 0;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Ignoring capture from shutter button: we're interrupted, attempting to end interruption", v15, 2u);
    }

    v12 = [(CAMViewfinderViewController *)self _captureController];
    [v12 attemptToEndInterruptions];
    goto LABEL_12;
  }

LABEL_14:

  return v9;
}

- (void)_handleDisabledShutterTap
{
  v17 = *MEMORY[0x1E69E9840];
  CAMSignpostWithIDAndArgs(65, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v3 = [(CAMViewfinderViewController *)self _reasonsToDisableShutterButton];
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    v5 = CAMDebugStringForControlDisableReasons(v3);
    *v16 = 138543362;
    *&v16[4] = v5;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Disabled shutter button was tapped, disabled for reasons: %{public}@", v16, 0xCu);
  }

  if (v3)
  {
    v6 = [(CAMViewfinderViewController *)self _captureController];
    [v6 logCaptureAvailabilityDescription];
  }

  v7 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v8 = v7 != 0;

  v9 = +[CAMUserPreferences preferences];
  v10 = [v9 responsiveShutterEnabled];

  v11 = mach_absolute_time();
  v12 = v11 - [(CAMViewfinderViewController *)self _lastShutterButtonTouchDownTime];
  *v16 = 0;
  mach_timebase_info(v16);
  v13 = [[CAMAnalyticsIgnoredShutterEvent alloc] initWithReasons:v3 timeSinceLastPress:v8 dynamicShutterEnabled:v10 responsiveShutterEnabled:(v12 * *v16 / *&v16[4]) / 1000000000.0];
  [(CAMAnalyticsEvent *)v13 publish];
  if ((v3 & 0x80) != 0)
  {
    v14 = [(CAMViewfinderViewController *)self _storageController];
    v15 = [v14 purgeableStorageContainer];
    [v15 cancelPurge];
  }
}

- (void)_handleShutterButtonPressed:(id)a3
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __59__CAMViewfinderViewController__handleShutterButtonPressed___block_invoke;
  v3[3] = &unk_1E76F9998;
  v3[4] = self;
  [(CAMViewfinderViewController *)self _attemptShutterPressWithBlock:v3];
}

void __59__CAMViewfinderViewController__handleShutterButtonPressed___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 captureOnTouchDown];

  v10 = [*(a1 + 32) _captureController];
  v6 = [*(a1 + 32) _currentGraphConfiguration];
  v7 = v6;
  if (v5)
  {
    [*(a1 + 32) _handleShutterButtonActionWithEventTriggerDescription:@"Shutter button pressed"];
  }

  else
  {
    v8 = [v6 mode];
    v9 = v8 > 9 || ((1 << v8) & 0x251) == 0;
    if (!v9 && [*(a1 + 32) _shouldReportUserInitiationTimeForCurrentSettings])
    {
      [v10 prepareToCaptureStillImageAtSystemTime:a2];
    }
  }

  if (([v7 mode] | 4) == 4 && (objc_msgSend(*(a1 + 32), "isDisablingMultipleCaptureFeatures") & 1) == 0)
  {
    [*(a1 + 32) _setupBurstTimerWithDelay:0.4];
  }
}

- (void)_handleShutterButtonDragEnter:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
  v5 = [(CAMViewfinderViewController *)self _feedbackController];
  [v5 prepareButtonFeedback:v4];

  [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:v4];
  v6 = [(CAMViewfinderViewController *)self _feedbackController];
  [v6 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
}

- (void)_handleShutterButtonReleased:(id)a3 fromDragExit:(BOOL)a4
{
  v5 = @"Shutter button released";
  if (a4)
  {
    v5 = @"Shutter button drag exit";
  }

  v6 = v5;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __73__CAMViewfinderViewController__handleShutterButtonReleased_fromDragExit___block_invoke;
  v8[3] = &unk_1E76F7960;
  v8[4] = self;
  v9 = v6;
  v7 = v6;
  [(CAMViewfinderViewController *)self _attemptShutterReleaseWithBlock:v8];
}

void __73__CAMViewfinderViewController__handleShutterButtonReleased_fromDragExit___block_invoke(uint64_t a1)
{
  v13 = *MEMORY[0x1E69E9840];
  v2 = +[CAMCaptureCapabilities capabilities];
  v3 = [v2 captureOnTouchDown];

  v4 = [*(a1 + 32) _captureController];
  v5 = *(a1 + 32);
  if (v3)
  {
    [v5 _teardownBurstTimer];
    v6 = [v4 isCapturingBurst];
    v7 = os_log_create("com.apple.camera", "Camera");
    v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
    if (v6)
    {
      if (v8)
      {
        v9 = *(a1 + 40);
        v11 = 138543362;
        v12 = v9;
        _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "%{public}@: Stop capturing burst", &v11, 0xCu);
      }

      [*(a1 + 32) _stopCapturingBurst];
    }

    else
    {
      if (v8)
      {
        v10 = *(a1 + 40);
        v11 = 138543362;
        v12 = v10;
        _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "%{public}@", &v11, 0xCu);
      }
    }
  }

  else
  {
    [v5 _handleShutterButtonActionWithEventTriggerDescription:*(a1 + 40)];
  }
}

- (void)_handleShutterButtonActionWithEventTriggerDescription:(id)a3
{
  v24 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 mode];
  v8 = @"no context";
  if (v7 <= 3)
  {
    if ((v7 - 1) < 2)
    {
      goto LABEL_13;
    }

    if (v7)
    {
      if (v7 != 3)
      {
        goto LABEL_24;
      }

      if ([v5 isCapturingPanorama])
      {
        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        v8 = @"stop capturing panorama";
        goto LABEL_24;
      }

      v15 = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      v16 = [v15 captureOrientation];
      v17 = [CAMOrientationUtilities captureOrientationFromPanoramaCaptureOrientation:v16];
      if (v16 >= 5)
      {
        v18 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Unexpected:%ld", v16];
      }

      else
      {
        v18 = off_1E76F9F70[v16];
      }

      if (v17 >= 5)
      {
        v19 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Unexpected:%ld", v17];
      }

      else
      {
        v19 = off_1E76F9F70[v17];
      }

      v8 = [MEMORY[0x1E696AEC0] stringWithFormat:@"start capturing panorama (device in %@, image in %@)", v19, v18];
      [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:v15];

      goto LABEL_18;
    }

LABEL_15:
    [(CAMViewfinderViewController *)self _teardownBurstTimer];
    v9 = [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
    v10 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
    v11 = [v5 isCapturingBurst];
    if (v10)
    {
      [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
      v8 = @"stop timer countdown";
      goto LABEL_24;
    }

    if (v11)
    {
      [(CAMViewfinderViewController *)self _stopCapturingBurst];
      v8 = @"stop capturing burst";
      goto LABEL_24;
    }

    if (v9)
    {
      [(CAMViewfinderViewController *)self _startCountdownForCaptureTimer];
      v8 = @"start timer countdown";
      goto LABEL_24;
    }

    [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    v8 = @"capture still image";
    goto LABEL_18;
  }

  if (v7 > 9)
  {
    goto LABEL_24;
  }

  if (((1 << v7) & 0x250) != 0)
  {
    goto LABEL_15;
  }

  if (((1 << v7) & 0x180) != 0)
  {
LABEL_13:
    if ([v5 isCapturingVideo])
    {
      [(CAMViewfinderViewController *)self _stopCapturingVideo];
      v8 = @"stop capturing video";
      goto LABEL_24;
    }

    v12 = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
    [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:v12];

    v8 = @"start capturing video";
    goto LABEL_18;
  }

  if (v7 == 5)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
    {
      [(CAMViewfinderViewController *)self _stopTimelapse];
      v8 = @"stop capturing timelapse";
      goto LABEL_24;
    }

    [(CAMViewfinderViewController *)self _startTimelapse];
    v8 = @"start capturing timelapse";
LABEL_18:
    v13 = [(CAMViewfinderViewController *)self _motionController];
    [v13 debugValidateCaptureOrientationForMode:{objc_msgSend(v6, "mode")}];

    if (!v8)
    {
      goto LABEL_27;
    }
  }

LABEL_24:
  v14 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v21 = v4;
    v22 = 2114;
    v23 = v8;
    _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }

LABEL_27:
}

- (void)_handleShutterButtonCancelled:(id)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (([(CAMViewfinderViewController *)self _currentMode]| 4) == 4)
  {
    [(CAMViewfinderViewController *)self _teardownBurstTimer];
    v4 = [(CAMViewfinderViewController *)self _captureController];
    if ([v4 isCapturingBurst])
    {
      [(CAMViewfinderViewController *)self _stopCapturingBurst];
      v5 = @"stop capturing burst";
    }

    else
    {
      v5 = @"no context";
    }
  }

  else
  {
    v5 = @"no context";
  }

  v6 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v7 = 138543362;
    v8 = v5;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Shutter button cancelled: %{public}@", &v7, 0xCu);
  }
}

- (BOOL)_stillDuringVideoButtonPressed:(id)a3
{
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  CAMSignpostWithIDAndArgs(13, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v4 = [(CUCaptureController *)self->__captureController isCapturingVideo];
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
    v6 = [(CAMViewfinderViewController *)self _feedbackController];
    [v6 prepareButtonFeedback:v5];

    [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:v5];
    v7 = [(CAMViewfinderViewController *)self _feedbackController];
    [v7 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    v8 = +[CAMCaptureCapabilities capabilities];
    LODWORD(v6) = [v8 captureOnTouchDown];

    if (v6)
    {

      LOBYTE(v4) = [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }

    else
    {
      LOBYTE(v4) = 1;
    }
  }

  return v4;
}

- (BOOL)_stillDuringVideoButtonReleased:(id)a3
{
  CAMSignpostWithIDAndArgs(14, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  v4 = [(CUCaptureController *)self->__captureController isCapturingVideo];
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _feedbackController];
    [v5 prepareButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    v6 = [(CAMViewfinderViewController *)self _feedbackController];
    [v6 performReleaseButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 captureOnTouchDown];

    if (v8)
    {
      LOBYTE(v4) = 1;
    }

    else
    {

      LOBYTE(v4) = [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }
  }

  return v4;
}

- (void)_createPhysicalCaptureInteractionIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isHalfPressOverlayInProcess];

  if ((v4 & 1) == 0)
  {
    v5 = [(CAMViewfinderViewController *)self _physicalButtonInteraction];
    if (v5)
    {
    }

    else if (([(CAMViewfinderViewController *)self isViewLoaded]& 1) != 0)
    {
      objc_initWeak(&location, self);
      v6 = objc_alloc(MEMORY[0x1E69585C0]);
      v11[0] = MEMORY[0x1E69E9820];
      v11[1] = 3221225472;
      v11[2] = __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke;
      v11[3] = &unk_1E76F99E8;
      objc_copyWeak(&v12, &location);
      v9[0] = MEMORY[0x1E69E9820];
      v9[1] = 3221225472;
      v9[2] = __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke_1105;
      v9[3] = &unk_1E76F99E8;
      objc_copyWeak(&v10, &location);
      v7 = [v6 initWithPrimaryEventHandler:v11 secondaryEventHandler:v9];
      v8 = [(CAMViewfinderViewController *)self view];
      [v8 addInteraction:v7];

      [MEMORY[0x1E69585C0] setDefaultCaptureSoundDisabled:1];
      [(CAMViewfinderViewController *)self set_physicalButtonInteraction:v7];

      objc_destroyWeak(&v10);
      objc_destroyWeak(&v12);
      objc_destroyWeak(&location);
    }
  }
}

void __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = +[CAMCaptureConversions buttonPhaseForCaptureButtonPhase:](CAMCaptureConversions, "buttonPhaseForCaptureButtonPhase:", [v3 phase]);
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    if (v4 > 3)
    {
      v6 = 0;
    }

    else
    {
      v6 = off_1E76F9F98[v4];
    }

    v10 = 138543362;
    v11 = v6;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Primary button press stage: %{public}@", &v10, 0xCu);
  }

  v7 = [v3 physicalButton] - 1;
  if (v7 > 6)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A684E0[v7];
  }

  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handlePhysicalCaptureInteractionDidChangePhase:v4 forButton:v8 event:v3];
}

void __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke_1105(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = +[CAMCaptureConversions buttonPhaseForCaptureButtonPhase:](CAMCaptureConversions, "buttonPhaseForCaptureButtonPhase:", [v3 phase]);
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    if (v4 > 3)
    {
      v6 = 0;
    }

    else
    {
      v6 = off_1E76F9F98[v4];
    }

    v10 = 138543362;
    v11 = v6;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Secondary button press stage: %{public}@", &v10, 0xCu);
  }

  v7 = [v3 physicalButton] - 1;
  if (v7 > 6)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A684E0[v7];
  }

  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handlePhysicalCaptureInteractionDidChangePhase:v4 forButton:v8 event:v3];
}

- (void)_playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable
{
  v8 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _headphoneInteractionCaptureSoundForCurrentCaptureMode];
    v5 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      v7[0] = 67240192;
      v7[1] = [(CAMViewfinderViewController *)self currentCaptureMode];
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Playing headphone interaction capture sound for current capture mode %{public}d", v7, 8u);
    }

    v6 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    [v6 playSound:v4];

    if (![(CAMViewfinderViewController *)self _remainingCaptureTimerTicks])
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Done playing capture sound for headphone event"];
    }
  }
}

- (void)_createHeadphonesTimerSoundsIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v3 isTimerSupportedForMode:{objc_msgSend(v4, "mode")}];

  if (v5)
  {
    v6 = [(CAMViewfinderViewController *)self _countdownTimerTickSound];

    if (!v6)
    {
      v7 = CAMCameraUIFrameworkBundle();
      v8 = [v7 URLForResource:@"camera_timer_countdown" withExtension:@"caf"];

      v9 = [(CAMViewfinderViewController *)self _captureEventSoundWithURL:v8];
      [(CAMViewfinderViewController *)self set_countdownTimerTickSound:v9];
    }

    v10 = [(CAMViewfinderViewController *)self _countdownTimerFinalTickSound];

    if (!v10)
    {
      v11 = CAMCameraUIFrameworkBundle();
      v13 = [v11 URLForResource:@"camera_timer_final_second" withExtension:@"caf"];

      v12 = [(CAMViewfinderViewController *)self _captureEventSoundWithURL:v13];
      [(CAMViewfinderViewController *)self set_countdownTimerFinalTickSound:v12];
    }
  }
}

- (id)_captureEventSoundWithURL:(id)a3
{
  v3 = MEMORY[0x1E69585C8];
  v4 = a3;
  v9 = 0;
  v5 = [[v3 alloc] initWithURL:v4 error:&v9];

  v6 = v9;
  if (v6)
  {
    v7 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _captureEventSoundWithURL:];
    }
  }

  return v5;
}

- (id)_headphoneInteractionCaptureSoundForCurrentCaptureMode
{
  v3 = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (v3 > 9)
  {
    v4 = 0;
  }

  else
  {
    if (((1 << v3) & 0x1AE) != 0)
    {
      if ([(CAMViewfinderViewController *)self isRecording])
      {
        [MEMORY[0x1E69585C8] beginVideoRecordingSound];
      }

      else
      {
        [MEMORY[0x1E69585C8] endVideoRecordingSound];
      }

      v4 = LABEL_5:;
      goto LABEL_13;
    }

    if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]< 2)
    {
      if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]== 1)
      {
        [(CAMViewfinderViewController *)self _countdownTimerFinalTickSound];
      }

      else
      {
        [MEMORY[0x1E69585C8] cameraShutterSound];
      }

      goto LABEL_5;
    }

    v4 = [(CAMViewfinderViewController *)self _countdownTimerTickSound];
  }

LABEL_13:

  return v4;
}

- (void)_clearCurrentHeadphonesEventWithReason:(id)a3
{
  v11 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    v6 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    v7 = 138543618;
    v8 = v6;
    v9 = 2114;
    v10 = v4;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Clearing current headphone capture event: %{public}@ for reason: %{public}@", &v7, 0x16u);
  }

  [(CAMViewfinderViewController *)self set_currentHeadphonesCaptureEvent:0];
}

- (void)_handlePhysicalCaptureInteractionDidChangePhase:(unint64_t)a3 forButton:(int64_t)a4 event:(id)a5
{
  v13 = *MEMORY[0x1E69E9840];
  v8 = a5;
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    if (v8)
    {
      v9 = [(CAMViewfinderViewController *)self _isHeadphonesButton:a4];
    }

    else
    {
      v9 = 0;
    }

    switch(a3)
    {
      case 3uLL:
        [(CAMViewfinderViewController *)self _handlePhysicalButtonCancelled:a4];
        break;
      case 2uLL:
        [(CAMViewfinderViewController *)self _handlePhysicalButtonReleased:a4];
        break;
      case 0uLL:
        if (v9)
        {
          [(CAMViewfinderViewController *)self set_currentHeadphonesCaptureEvent:v8];
          [(CAMViewfinderViewController *)self _createHeadphonesTimerSoundsIfNeeded];
          v10 = os_log_create("com.apple.camera", "PhysicalButton");
          if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
          {
            v11 = 138543362;
            v12 = v8;
            _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Storing current headphone capture event: %{public}@", &v11, 0xCu);
          }
        }

        [(CAMViewfinderViewController *)self _handlePhysicalButtonPressed:a4];
        break;
    }
  }
}

- (void)_createCameraCaseShutterNotifierIfNeeded
{
  v3 = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];

  if (!v3)
  {
    v4 = [CAMPhysicalCaptureNotifier alloc];
    v5 = [(CAMViewfinderViewController *)self view];
    v6 = [(CAMPhysicalCaptureNotifier *)v4 initWithView:v5 includeVolumeButtons:0];
    [(CAMViewfinderViewController *)self set_cameraCaseShutterNotifier:v6];

    v7 = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];
    [v7 setDelegate:self];
  }
}

- (void)_updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:(BOOL)a3
{
  v5 = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
  v6 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v9 = -[CAMViewfinderViewController _shouldDisableEventInteractionForGraphConfiguration:callActive:](self, "_shouldDisableEventInteractionForGraphConfiguration:callActive:", v7, [v8 isCallActive]);

  v10 = 0;
  if (!v5 && !a3)
  {
    v10 = ![(CAMViewfinderViewController *)self _shouldDisableUserInteractionForTransitioning]&& !v6 && !v9;
  }

  v11 = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];
  [v11 setEnabled:v10];

  v12 = [(CAMViewfinderViewController *)self _physicalButtonInteraction];
  [v12 setEnabled:v10];
}

- (void)physicalCaptureNotifierDidChangeState:(id)a3 forButton:(int64_t)a4
{
  v6 = [a3 cameraCaseButtonState];
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    if (v6)
    {
      if (v6 == 1)
      {

        [(CAMViewfinderViewController *)self _handlePhysicalButtonPressed:a4];
      }
    }

    else
    {

      [(CAMViewfinderViewController *)self _handlePhysicalButtonReleased:a4];
    }
  }
}

- (BOOL)_allowsPhysicalCaptureInteraction
{
  v2 = [MEMORY[0x1E695E000] standardUserDefaults];
  v3 = [v2 BOOLForKey:@"PLIgnoreVolumeButtons"];

  return v3 ^ 1;
}

- (void)_handlePhysicalButtonPressed:(int64_t)a3
{
  v24 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction])
  {
    v5 = [(CAMViewfinderViewController *)self _primaryShutterControl];
    v6 = [v5 isEnabled];
    v7 = [v5 isTracking];
    if (!v6 || (v7 & 1) != 0)
    {
      goto LABEL_27;
    }

    if (a3 > 8)
    {
      v8 = 0;
    }

    else
    {
      v8 = off_1E76F9FB8[a3];
    }

    v9 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v22 = 138543362;
      v23 = v8;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Physical capture button pressed: %{public}@", &v22, 0xCu);
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:[CAMViewfinderViewController _pressTypeForCaptureButton:a3]];
    [v5 setHighlighted:1];
    v10 = [@"Physical capture button pressed: " stringByAppendingString:v8];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v10];
    v11 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    if (v11)
    {
      v12 = v11;
      v13 = [(CAMViewfinderViewController *)self currentCaptureMode];
      if (v13 > 8 || ((1 << v13) & 0x1AE) == 0)
      {

        [(CAMViewfinderViewController *)self _takePhotoForExternalClientWithCountdown:3 internalTimerOverridesCountdown:1];
        goto LABEL_26;
      }
    }

    v14 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (!v14)
    {
      v17 = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonPressed:v17];

LABEL_26:
LABEL_27:

      return;
    }

    v15 = +[CAMCaptureCapabilities capabilities];
    if ([v15 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}])
    {
      v16 = ![(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
    }

    else
    {
      v16 = 0;
    }

    if (![v15 isLongPressVideoCaptureFromPhotoModeSupported])
    {
      if (v16)
      {
        v18 = 2;
      }

      else
      {
        v18 = 0;
      }

      goto LABEL_25;
    }

    v18 = 0;
    if (a3 <= 8)
    {
      if (((1 << a3) & 0x1D4) == 0)
      {
        if (a3 == 1)
        {
          if (v16)
          {
            v20 = +[CAMUserPreferences preferences];
            v21 = [v20 shouldUseVolumeUpBurst];

            if (v21)
            {
              v18 = 2;
            }

            else
            {
              v18 = 1;
            }

            goto LABEL_25;
          }
        }

        else if (a3 != 5)
        {
          goto LABEL_25;
        }
      }

      v18 = 1;
    }

LABEL_25:
    v19 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v19 externalButtonPressedWithBehavior:v18];

    goto LABEL_26;
  }
}

- (void)_handlePhysicalButtonReleased:(int64_t)a3
{
  v13 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction]&& [(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
  {
    if (a3 > 8)
    {
      v5 = 0;
    }

    else
    {
      v5 = off_1E76F9FB8[a3];
    }

    v6 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 138543362;
      v12 = v5;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Physical capture button released: %{public}@", &v11, 0xCu);
    }

    v7 = [(CAMViewfinderViewController *)self _primaryShutterControl];
    [v7 setHighlighted:0];
    v8 = [@"Physical capture button released: " stringByAppendingString:v5];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v8];
    v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (v9)
    {
      v10 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v10 externalButtonReleased];
    }

    else
    {
      v10 = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonReleased:v10];
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:-1];
  }
}

- (void)_handlePhysicalButtonCancelled:(int64_t)a3
{
  v13 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction]&& [(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
  {
    if (a3 > 8)
    {
      v5 = 0;
    }

    else
    {
      v5 = off_1E76F9FB8[a3];
    }

    v6 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 138543362;
      v12 = v5;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Physical capture button cancelled: %{public}@", &v11, 0xCu);
    }

    v7 = [(CAMViewfinderViewController *)self _primaryShutterControl];
    [v7 setHighlighted:0];
    v8 = [@"Physical capture button cancelled: " stringByAppendingString:v5];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v8];
    v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (v9)
    {
      v10 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v10 externalButtonCancelled];
    }

    else
    {
      v10 = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonCancelled:v10];
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:-1];
  }
}

- (void)_updateFocusAndExposureLockBadgeAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v5];

  if (!v6)
  {
    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v8 = [v7 badgeTray];
    v9 = [v8 focusLockBadge];
    v10 = v9;
    if (v9)
    {
      v11 = v9;
    }

    else
    {
      v11 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    }

    v12 = v11;

    [v12 setFocusLockType:{-[CAMViewfinderViewController _focusAndExposureLockBadgeTypeForCurrentState](self, "_focusAndExposureLockBadgeTypeForCurrentState")}];
  }

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:v3];
  v13 = [(CAMViewfinderViewController *)self viewfinderView];
  [v13 setNeedsLayout];
  if (v3)
  {
    v14 = MEMORY[0x1E69DD250];
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = __72__CAMViewfinderViewController__updateFocusAndExposureLockBadgeAnimated___block_invoke;
    v15[3] = &unk_1E76F77B0;
    v16 = v13;
    [v14 animateWithDuration:2 delay:v15 options:0 animations:0.25 completion:0.0];
  }
}

- (int64_t)_focusAndExposureLockBadgeTypeForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 badgeTray];
  v6 = [v5 focusLockBadge];
  v7 = v6;
  if (v6)
  {
    v8 = v6;
  }

  else
  {
    v8 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  }

  v9 = v8;

  v10 = [v9 focusLockType];
  v11 = [v3 isFocusLockedByUser];
  v12 = [v3 isExposureLockedByUser];
  if ([v3 isFocusLockedOnCinematicSubject])
  {
    v13 = 3;
  }

  else
  {
    v14 = 2;
    if ((v12 & v11) == 0)
    {
      v14 = 0;
    }

    v15 = v11 | v12;
    if (v11)
    {
      v13 = v14;
    }

    else
    {
      v13 = 1;
    }

    if ((v15 & 1) == 0)
    {
      if ([v3 isFocusLockedOnDockKitSubject])
      {
        v13 = 4;
      }

      else
      {
        v13 = v10;
      }
    }
  }

  return v13;
}

- (void)_setupBurstTimerWithDelay:(double)a3
{
  objc_initWeak(&location, self);
  v5 = [CAMPreciseTimer alloc];
  v7 = MEMORY[0x1E69E9820];
  v8 = 3221225472;
  v9 = __57__CAMViewfinderViewController__setupBurstTimerWithDelay___block_invoke;
  v10 = &unk_1E76F9A10;
  objc_copyWeak(&v11, &location);
  v6 = [(CAMPreciseTimer *)v5 initWithDelay:&v7 interval:a3 handler:1.79769313e308];
  [(CAMPreciseTimer *)v6 start:v7];
  [(CAMViewfinderViewController *)self _setCurrentBurstTimer:v6];

  objc_destroyWeak(&v11);
  objc_destroyWeak(&location);
}

void __57__CAMViewfinderViewController__setupBurstTimerWithDelay___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handleBurstTimerFired:v3];
  [v3 invalidate];
}

- (void)_handleBurstTimerFired:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentBurstTimer];

  if (v5 == v4)
  {
    v6 = +[CAMCaptureCapabilities capabilities];
    v7 = [v6 captureOnTouchDown];

    v8 = [(CAMViewfinderViewController *)self _captureController];
    v9 = [v8 isCapturingStillImage];

    if (!v9 || (v7 & 1) == 0)
    {
      v10 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        *v12 = 0;
        _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Starting burst because no still image was being captured when burst timer fired", v12, 2u);
      }

      [(CAMViewfinderViewController *)self _beginCapturingBurst];
    }

    v11 = [(CAMViewfinderViewController *)self _feedbackController];
    [v11 prepareDiscreteFeedback:1];
  }
}

- (void)_beginCapturingBurst
{
  v13 = *MEMORY[0x1E69E9840];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v4)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      v5 = [(CAMViewfinderViewController *)self _maximumBurstLengthForTimer];
      v6 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        v11 = 134217984;
        v12 = v5;
        _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Starting burst capture of %ld shots for timer", &v11, 0xCu);
      }
    }

    else
    {
      v6 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        LOWORD(v11) = 0;
        _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Starting burst capture", &v11, 2u);
      }

      v5 = 0;
    }

    v7 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:1 maximumLength:v5];
    v8 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v7 burst:1];
    v9 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    v10 = [v7 persistenceUUID];
    [v9 setObject:v8 forKey:v10];

    [(CAMViewfinderViewController *)self _startCapturingBurstWithRequest:v7];
  }
}

- (int64_t)_maximumBurstLengthForTimer
{
  v3 = +[CAMCaptureCapabilities capabilities];
  [v3 captureIntervalForDevice:{-[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];
  if (v4 * 10.0 <= 2.0)
  {
    v5 = 10;
  }

  else
  {
    v5 = 5;
  }

  return v5;
}

- (void)_startCapturingBurstWithRequest:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v14 = 0;
  v6 = [v5 startCapturingBurstWithRequest:v4 error:&v14];
  v7 = v14;
  if (v6)
  {
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:1];
    v8 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    v9 = [v4 captureRequest];
    v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [v8 didCaptureWithRequest:v9 currentConfiguration:v10];

    v11 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v11 setIsCapturingBurst:1];
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingBurstWithRequest:];
    }

    v13 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v13 resetAnimated:1];

    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start capturing a burst"];
  }

  [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
  [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];
}

- (void)_stopCapturingBurst
{
  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 stopCapturingBurst];
  v3 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v3 processPendingBursts];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  v4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v4 setIsCapturingBurst:0];
}

- (void)captureControllerWillStartCapturingBurst:(id)a3
{
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v5)
  {
    [(CAMViewfinderViewController *)self _showBurstIndicatorView];
    v6 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v6 burstCaptureWillStart];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];

  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
}

- (void)captureControllerDidReachMaximumBurstLength:(id)a3
{
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }
}

- (void)captureControllerDidStopCapturingBurst:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v5)
  {
    [(CAMViewfinderViewController *)self _hideBurstIndicatorView];
    v6 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v6 burstCaptureDidStop];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];

  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
}

- (void)captureControllerWillStartPlayingBurstEndSound:(id)a3
{
  [(CAMViewfinderViewController *)self _setBurstEndSoundPlaying:1];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:v4 isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
}

- (void)captureControllerDidStopPlayingBurstEndSound:(id)a3
{
  [(CAMViewfinderViewController *)self _setBurstEndSoundPlaying:0];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:v4 isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
}

- (void)determinedBurstLength:(int64_t)a3 forPersistenceUUID:(id)a4
{
  v6 = a4;
  v7 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v9 = [v7 objectForKeyedSubscript:v6];

  [v9 populateBurstLength:a3];
  [v9 publish];
  v8 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  [v8 setObject:0 forKeyedSubscript:v6];
}

- (void)_showBurstIndicatorView
{
  v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v4 resetCounter];
  }

  else
  {
    v4 = [(CAMViewfinderViewController *)self _burstIndicatorView];
    [v4 reset];
    [v4 setAlpha:1.0];
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:0];
  }
}

- (void)_hideBurstIndicatorView
{
  v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _burstIndicatorView];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke;
    v6[3] = &unk_1E76F9A38;
    v7 = v4;
    v8 = self;
    v5 = v4;
    [v5 finishIncrementingWithCompletionHandler:v6];
  }
}

void __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke(uint64_t a1)
{
  v2 = MEMORY[0x1E69DD250];
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke_2;
  v5[3] = &unk_1E76F77B0;
  v6 = *(a1 + 32);
  [v2 animateWithDuration:327682 delay:v5 options:0 animations:0.415 completion:0.395];
  v3 = dispatch_time(0, ((0.81 - 0.25) * 1000000000.0));
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke_3;
  v4[3] = &unk_1E76F77B0;
  v4[4] = *(a1 + 40);
  dispatch_after(v3, MEMORY[0x1E69E96A0], v4);
}

- (void)_performCaptureAnimationWithDuration:(double)a3
{
  v6 = [MEMORY[0x1E69793D0] functionWithName:*MEMORY[0x1E6979EA0]];
  v5 = [MEMORY[0x1E69DC888] blackColor];
  [(CAMViewfinderViewController *)self _performCaptureAnimationWithDuration:v6 curve:v5 color:1 fadeOut:a3];
}

- (void)_performCaptureAnimationWithDuration:(double)a3 curve:(id)a4 color:(id)a5 fadeOut:(BOOL)a6
{
  v6 = a6;
  v10 = a5;
  v11 = a4;
  v12 = [(CAMViewfinderViewController *)self _previewViewController];
  v13 = [v12 previewView];

  v14 = objc_alloc(MEMORY[0x1E69DD250]);
  [v13 bounds];
  v15 = [v14 initWithFrame:?];
  [v15 setBackgroundColor:v10];

  [v13 addSubview:v15];
  if (v6)
  {
    v16 = 0.0;
  }

  else
  {
    v16 = 1.0;
  }

  v17 = [v15 layer];
  v18 = [MEMORY[0x1E6979318] animationWithKeyPath:@"opacity"];
  [v18 setFromValue:&unk_1F16C8A58];
  v19 = [MEMORY[0x1E696AD98] numberWithDouble:v16];
  [v18 setToValue:v19];

  [v17 convertTime:0 fromLayer:CACurrentMediaTime()];
  [v18 setBeginTime:v20 + 0.075];
  UIAnimationDragCoefficient();
  [v18 setDuration:v21 * a3];
  [v18 setTimingFunction:v11];

  [v18 setFillMode:*MEMORY[0x1E69797E0]];
  v22 = objc_alloc_init(CAMAnimationDelegate);
  v25 = MEMORY[0x1E69E9820];
  v26 = 3221225472;
  v27 = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke;
  v28 = &unk_1E76F8AA0;
  v30 = v6;
  v29 = v15;
  v23 = v15;
  [(CAMAnimationDelegate *)v22 setCompletion:&v25];
  [v18 setDelegate:{v22, v25, v26, v27, v28}];
  [v17 addAnimation:v18 forKey:@"opacityAnimation"];
  *&v24 = v16;
  [v17 setOpacity:v24];
  [(CAMViewfinderViewController *)self _setCaptureAnimationPreviewOverlay:v23];
}

void __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke(uint64_t a1)
{
  if (*(a1 + 40) == 1)
  {
    v2 = *(a1 + 32);

    [v2 removeFromSuperview];
  }

  else
  {
    v3 = MEMORY[0x1E69DD250];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke_2;
    v6[3] = &unk_1E76F77B0;
    v7 = *(a1 + 32);
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke_3;
    v4[3] = &unk_1E76F7988;
    v5 = *(a1 + 32);
    [v3 animateWithDuration:v6 animations:v4 completion:0.25];
  }
}

- (void)_cancelCaptureAnimation
{
  v2 = [(CAMViewfinderViewController *)self _captureAnimationPreviewOverlay];
  v3 = [v2 layer];

  [v3 removeAllAnimations];
}

- (void)_applyAutorotationCorrectingTransformForOrientation:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self view];
  v36 = 0u;
  v37 = 0u;
  v35 = 0u;
  v6 = [(CAMViewfinderViewController *)self view:CAMTransformCorrectingForOrientation(a3];
  v7 = [v6 window];
  v8 = [v7 screen];

  [v8 _referenceBounds];
  v10 = v9;
  v12 = v11;
  v14 = v13;
  v16 = v15;
  [v5 bounds];
  [(CAMViewfinderViewController *)self _portraitOrientedSizeForSize:v17, v18];
  v19 = [v5 superview];
  v20 = [v19 layer];

  v21 = [v20 needsLayoutOnGeometryChange];
  [v20 setNeedsLayoutOnGeometryChange:0];
  v22 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v24 = v23;

  v25 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v27 = v26;

  v28 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v30 = v29;

  v31 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v33 = v32;

  if (v24 == v30 && v27 == v33)
  {
    [v5 setBounds:{v10, v12, v14, v16}];
  }

  v34[0] = v35;
  v34[1] = v36;
  v34[2] = v37;
  [v5 setTransform:v34];
  [v20 setNeedsLayoutOnGeometryChange:v21];
}

- (int64_t)_autorotationStyleForLayoutStyle:(int64_t)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isSplitScreenSupported];
  if ((a3 - 1) < 2)
  {
    v6 = 2;
  }

  else if (a3 != 3 && a3)
  {
    v6 = 0;
  }

  else if (v5)
  {
    v6 = 2;
  }

  else
  {
    v6 = 1;
  }

  return v6;
}

- (BOOL)_isScreenExternalDisplay
{
  v2 = [(CAMViewfinderViewController *)self view];
  v3 = [v2 window];
  v4 = [v3 screen];
  v5 = [v4 _isEmbeddedScreen];

  return v5 ^ 1;
}

- (void)_applyTransformsForAutorotationStyle:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self view];
  v6 = [(CAMViewfinderViewController *)self viewfinderView];
  v7 = [(CAMViewfinderViewController *)self _previewViewController];
  v8 = [v7 previewView];

  memset(&v23, 0, sizeof(v23));
  v9 = 1;
  CAMTransformCorrectingForOrientation(1, &v23);
  memset(&v22, 0, sizeof(v22));
  [(CAMViewfinderViewController *)self customPreviewViewTransform];
  switch(a3)
  {
    case 2:
      v21 = v23;
      [v5 setTransform:&v21];
      v13 = [(CAMViewfinderViewController *)self view];
      v14 = [v13 window];
      v9 = CAMInterfaceOrientationForWindow(v14);

      [v6 setPreviewViewOrientation:v9];
      if ([(CAMViewfinderViewController *)self _isScreenExternalDisplay])
      {
        v15 = [(CAMViewfinderViewController *)self _motionController];
        v9 = [v15 captureOrientation];
      }

      memset(&v21, 0, sizeof(v21));
      [v6 setExternalDisplayPreviewOrientation:{v9, CAMTransformCorrectingForOrientation(v9, &v21)}];
      t2 = v22;
      memset(&t1, 0, sizeof(t1));
      v18 = v21;
      CGAffineTransformConcat(&t1, &t2, &v18);
      t2 = t1;
      [v8 setTransform:&t2];
      v16 = [(CAMViewfinderViewController *)self _textInteractionBackground];
      t2 = t1;
      [v16 setTransform:&t2];
      [v6 prepareForAutorotation];

      break;
    case 1:
      v9 = 1;
      [v6 setPreviewViewOrientation:1];
      v10 = [(CAMViewfinderViewController *)self view];
      v11 = [v10 window];
      v12 = CAMInterfaceOrientationForWindow(v11);

      [(CAMViewfinderViewController *)self _applyAutorotationCorrectingTransformForOrientation:v12];
      goto LABEL_6;
    case 0:
      v21 = v23;
      [v5 setTransform:&v21];
      v9 = 1;
      [v6 setPreviewViewOrientation:1];
LABEL_6:
      t1 = v22;
      memset(&v21, 0, sizeof(v21));
      t2 = v23;
      CGAffineTransformConcat(&v21, &t1, &t2);
      t1 = v21;
      [v8 setTransform:&t1];
      break;
  }

  v17 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v17 setPreviewViewOrientation:v9];
}

- (void)setAutorotationStyle:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setInternalAutorotationStyle:a3];

  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
}

- (BOOL)_shouldUpdateCaptureOrientation
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingVideo];

  return v3 ^ 1;
}

- (void)_captureOrientationChanged:(id)a3
{
  v4 = +[CAMApplication appOrPlugInState];
  v21 = [(CAMViewfinderViewController *)self _captureController];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:v4 == 0];
    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v5];

    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 shouldAdjustZoomOnOrientationChangeForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    if (v6 && v8)
    {
      v9 = +[CAMCaptureCapabilities capabilities];
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v11 = [v10 mode];
      v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      LODWORD(v11) = [v9 isSmartFramingSupportedForMode:v11 devicePosition:{objc_msgSend(v12, "devicePosition")}];

      if (v11)
      {
        v13 = [(CAMViewfinderViewController *)self _motionController];
        -[CAMViewfinderViewController _updateSmartFramingForCaptureOrientation:rampDuration:zoomRampTuning:animated:](self, "_updateSmartFramingForCaptureOrientation:rampDuration:zoomRampTuning:animated:", [v13 captureOrientation], 0, v4 == 0, 0.5);
      }

      else
      {
        v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v17 = [(CAMViewfinderViewController *)self _motionController];
        -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", v16, [v17 captureOrientation]);
        v19 = v18;

        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        if (v20 != v19)
        {
          [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:v4 == 0 zoomRampTuning:v19 shouldAnimate:0.5];
        }
      }

      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }

    [(CAMViewfinderViewController *)self _resetDynamicAspectRatio];
  }

  else
  {
    v14 = [(CAMViewfinderViewController *)self _motionController];
    v15 = [v14 captureOrientation];
    if (v15)
    {
      [v21 changeToVideoRecordingCaptureOrientation:v15];
    }
  }

  [(CAMViewfinderViewController *)self _updateHomeIndicatorBehaviorsForCaptureOrientation];
}

- (void)_deviceOrientationChanged:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [(CAMViewfinderViewController *)self _motionController];
  [v4 setDeviceOrientation:objc_msgSend(v5 animated:{"deviceOrientation"), 1}];

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v6 animated:1];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)_updateUIForCaptureOrientationAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self autorotationStyle];
  v6 = [(CAMViewfinderViewController *)self _motionController];
  v7 = [v6 captureOrientation];
  v8 = [(CAMViewfinderViewController *)self viewfinderView];
  if ([(CAMViewfinderViewController *)self _isScreenExternalDisplay])
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke;
    aBlock[3] = &unk_1E76F97F0;
    aBlock[4] = self;
    v37 = v5;
    v9 = v8;
    v36 = v9;
    v10 = _Block_copy(aBlock);
    v11 = v10;
    if (v3)
    {
      v12 = MEMORY[0x1E69DD250];
      v32[0] = MEMORY[0x1E69E9820];
      v32[1] = 3221225472;
      v32[2] = __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke_2;
      v32[3] = &unk_1E76F83B0;
      v34 = v10;
      v33 = v9;
      [v12 animateWithDuration:v32 animations:0.3];
    }

    else
    {
      v10[2](v10);
    }
  }

  if (v5 == 1)
  {
    v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v14 = [(CAMViewfinderViewController *)self _shouldRotateTopBarForGraphConfiguration:v13];

    [v8 setAutomaticallyAdjustsTopBarOrientation:v14];
    v15 = v7;
  }

  else
  {
    v15 = 1;
  }

  [(CAMViewfinderViewController *)self _rotateTopBarAndControlsToOrientation:v15 shouldAnimate:v3];
  v16 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v16 setOrientation:v15 animated:v3];

  v17 = [(CAMViewfinderViewController *)self _imageWell];
  [v17 setCameraOrientation:v15 animated:v3];

  v18 = [(CAMViewfinderViewController *)self _burstIndicatorView];
  [CAMView rotateView:v18 toInterfaceOrientation:v15 animated:v3];

  v19 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  [v19 setOrientation:v15 animated:v3];

  [v8 setOrientation:v15 animated:v3];
  v20 = [(CAMViewfinderViewController *)self _zoomSlider];
  [v20 setOrientation:v15 animated:v3];

  v21 = [(CAMViewfinderViewController *)self _layoutStyle];
  v22 = [(CAMViewfinderViewController *)self _zoomControl];
  v23 = v22;
  if (v21 == 1)
  {
    v24 = [v22 isTracking];

    if (v24)
    {
      goto LABEL_14;
    }

    v23 = [(CAMViewfinderViewController *)self _zoomControl];
    [v23 setShouldShowZoomDial:0 animationDuration:0];
  }

  else
  {
    [v22 setOrientation:v15 animated:v3];
  }

LABEL_14:
  if (dyld_program_sdk_at_least())
  {
    v25 = [(CAMViewfinderViewController *)self _flipButton];
    [v25 setOrientation:v15 animated:v3];
  }

  v26 = [(CAMViewfinderViewController *)self _lightingControl];
  [v26 setOrientation:v7];

  v27 = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
  [v27 setBackgroundStyle:-[CAMViewfinderViewController _elapsedTimeViewIdleBackgroundStyle](self animated:{"_elapsedTimeViewIdleBackgroundStyle"), v3}];
  v28 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v28 setSpatialCaptureRecordingIndicatorVisible:0 animated:v3];

  v29 = [(CAMViewfinderViewController *)self _panoramaViewController];
  [v29 didChangeToCaptureOrientation:v7];
  v30 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v30 setOrientation:v15 animated:v3];

  v31 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v31 setControlOrientation:v15];
}

uint64_t __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _applyTransformsForAutorotationStyle:*(a1 + 48)];
  v2 = *(a1 + 40);

  return [v2 setNeedsLayout];
}

uint64_t __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke_2(uint64_t a1)
{
  (*(*(a1 + 40) + 16))();
  v2 = *(a1 + 32);

  return [v2 layoutIfNeeded];
}

- (void)_updateTopBarStyleForGraphConfiguration:(id)a3 capturing:(BOOL)a4 animated:(BOOL)a5
{
  v5 = a5;
  v7 = [(CAMViewfinderViewController *)self _topBarStyleForGraphConfiguration:a3 capturing:a4];
  v8 = [(CAMViewfinderViewController *)self _topBar];
  [v8 setStyle:v7 animated:v5];
}

- (void)_rotateTopBarAndControlsToOrientation:(int64_t)a3 shouldAnimate:(BOOL)a4
{
  v4 = a4;
  v21 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v21 isCapturingVideo];
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateTopBarStyleForGraphConfiguration:v8 capturing:v7 animated:v4];
  v9 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:v8];
  v10 = [(CAMViewfinderViewController *)self _topBar];

  if (v10)
  {
    v11 = [(CAMViewfinderViewController *)self _topBar];
    [v11 setOrientation:a3];
  }

  else
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
  }

  if (v9)
  {
    a3 = 1;
  }

  v12 = [(CAMViewfinderViewController *)self _flashButton];
  [v12 setOrientation:a3 animated:v4];

  v13 = [(CAMViewfinderViewController *)self _HDRButton];
  [v13 setOrientation:a3 animated:v4];

  v14 = [(CAMViewfinderViewController *)self _livePhotoButton];
  [v14 setOrientation:a3 animated:v4];

  v15 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [v15 setOrientation:a3 animated:v4];

  v16 = [(CAMViewfinderViewController *)self _timerButton];
  [v16 setOrientation:a3 animated:v4];

  v17 = [(CAMViewfinderViewController *)self _apertureButton];
  [v17 setOrientation:a3 animated:v4];

  v18 = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  [CAMView rotateView:v18 toInterfaceOrientation:a3 animated:v4];

  v19 = [(CAMViewfinderViewController *)self _intensityButton];
  [v19 setOrientation:a3 animated:v4];

  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    v20 = [(CAMViewfinderViewController *)self _flipButton];
    [v20 setOrientation:a3 animated:v4];
  }
}

- (BOOL)_shouldRotateTopBarForGraphConfiguration:(id)a3
{
  v4 = [a3 mode];
  v5 = (v4 < 9) & (0x186u >> v4);
  if ([(CAMViewfinderViewController *)self autorotationStyle]== 1)
  {
    return v5;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldApplyTopBarRotationForGraphConfiguration:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _shouldRotateTopBarForGraphConfiguration:a3];
  v5 = [(CAMViewfinderViewController *)self _motionController];
  if (([v5 captureOrientation] - 3) >= 2)
  {
    v4 = 0;
  }

  return v4;
}

- (void)_prepareTopBarForOrientationChangeDuringConfiguration
{
  v3 = [(CAMViewfinderViewController *)self _topBar];
  v4 = [v3 snapshotViewAfterScreenUpdates:0];
  [v3 bounds];
  [v4 setBounds:?];
  [v3 center];
  [v4 setCenter:?];
  if (v3)
  {
    [v3 transform];
  }

  else
  {
    memset(v15, 0, sizeof(v15));
  }

  [v4 setTransform:v15];
  v5 = [v3 superview];
  [v5 addSubview:v4];

  [v3 setAlpha:0.0];
  v6 = MEMORY[0x1E69DD250];
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __84__CAMViewfinderViewController__prepareTopBarForOrientationChangeDuringConfiguration__block_invoke;
  v13[3] = &unk_1E76F77B0;
  v14 = v4;
  v8 = MEMORY[0x1E69E9820];
  v9 = 3221225472;
  v10 = __84__CAMViewfinderViewController__prepareTopBarForOrientationChangeDuringConfiguration__block_invoke_2;
  v11 = &unk_1E76F7988;
  v12 = v14;
  v7 = v14;
  [v6 animateWithDuration:327682 delay:v13 options:&v8 animations:0.3 completion:0.0];
  [(CAMViewfinderViewController *)self _setPerformingTopBarOrientationChange:1, v8, v9, v10, v11];
}

- (void)handleImageWellReleased
{
  [(CAMViewfinderViewController *)self _presentCameraRollViewControllerIfPossibleAnimated:1 interactive:0];

  [(CAMViewfinderViewController *)self stopMonitoringForAccidentalLaunchIfNeeded];
}

- (void)_presentCameraRollViewControllerIfPossibleAnimated:(BOOL)a3 interactive:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v7 = [(CAMViewfinderViewController *)self _cameraRollController];
  if ([v7 canPresentCameraRollViewController])
  {
    if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled]&& +[CAMFrameworkUtilities isPasscodeLocked])
    {
      objc_initWeak(&location, self);
      v8[0] = MEMORY[0x1E69E9820];
      v8[1] = 3221225472;
      v8[2] = __94__CAMViewfinderViewController__presentCameraRollViewControllerIfPossibleAnimated_interactive___block_invoke;
      v8[3] = &unk_1E76F9A60;
      objc_copyWeak(&v9, &location);
      v10 = v5;
      v11 = v4;
      [(CAMViewfinderViewController *)self _requestPasscodeUnlockForCameraRollController:v7 forAction:0 completionBlock:v8];
      objc_destroyWeak(&v9);
      objc_destroyWeak(&location);
    }

    else
    {
      [(CAMViewfinderViewController *)self _presentCameraRollViewControllerAnimated:v5 interactive:v4];
    }
  }
}

void __94__CAMViewfinderViewController__presentCameraRollViewControllerIfPossibleAnimated_interactive___block_invoke(uint64_t a1, int a2)
{
  if (a2)
  {
    WeakRetained = objc_loadWeakRetained((a1 + 32));
    v4 = [WeakRetained _connectedStorage];

    if (v4)
    {
      v5 = objc_loadWeakRetained((a1 + 32));
      [v5 _presentCameraRollViewControllerAnimated:*(a1 + 40) interactive:*(a1 + 41)];
    }
  }
}

- (void)_presentCameraRollViewControllerAnimated:(BOOL)a3 interactive:(BOOL)a4
{
  v24 = a3;
  v25 = a4;
  v33 = *MEMORY[0x1E69E9840];
  v5 = [(CAMViewfinderViewController *)self _motionController];
  [v5 setForceLandscapeOrientation:0];

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _shouldDeferMediaLoadingForGraphConfiguration:v6];
  v29[0] = 0;
  v29[1] = v29;
  v29[2] = 0x2020000000;
  v30 = 0;
  v27[0] = 0;
  v27[1] = v27;
  v27[2] = 0x2020000000;
  v28 = 0;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __84__CAMViewfinderViewController__presentCameraRollViewControllerAnimated_interactive___block_invoke;
  aBlock[3] = &unk_1E76F9A88;
  aBlock[4] = v27;
  aBlock[5] = v29;
  v8 = _Block_copy(aBlock);
  v9 = [(CAMViewfinderViewController *)self supportedInterfaceOrientations];
  v10 = [(CAMViewfinderViewController *)self _motionController];
  v11 = [v10 captureOrientation];

  v12 = [(CAMViewfinderViewController *)self view];
  v13 = [v12 window];
  v14 = [v13 _windowOwnsInterfaceOrientation];

  v15 = (v11 - 3) < 0xFFFFFFFFFFFFFFFELL && v9 == 2;
  if ((v15 & v14) == 1)
  {
    v16 = v8[2](v8) ^ 1;
  }

  else
  {
    v16 = 0;
  }

  v17 = [MEMORY[0x1E69DC938] currentDevice];
  v18 = [v17 orientation];
  if (v9 == 2 && v18 == 1 && v11 != 1 && (v8[2](v8) & 1) == 0)
  {
    v19 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      if (v11 == 3)
      {
        v20 = @"UIInterfaceOrientationLandscapeRight";
      }

      else if (v11 == 4)
      {
        v20 = @"UIInterfaceOrientationLandscapeLeft";
      }

      else
      {
        v20 = @"UIInterfaceOrientationPortraitUpsideDown";
        if (v11 != 2)
        {
          v20 = 0;
        }
      }

      *buf = 138543362;
      v32 = v20;
      _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "UIDevice has Portrait orientation, but capture orientation is %{public}@. Applying capture orientation to the device.", buf, 0xCu);
    }

    [v17 setOrientation:v11];
  }

  if (v16)
  {
    [*MEMORY[0x1E69DDA98] _setStatusBarOrientation:v11];
  }

  v21 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v21 presentCameraRollViewControllerAnimated:v24 interactive:v25 deferringStagedMediaLoading:v7];
  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  [(CAMViewfinderViewController *)self _pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:v6 isShowingCameraRoll:1];
  v22 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v22 didPresentCameraRoll];

  v23 = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [v23 viewfinderViewController:self didPresentCameraRoll:v21];

  _Block_object_dispose(v27, 8);
  _Block_object_dispose(v29, 8);
}

uint64_t __84__CAMViewfinderViewController__presentCameraRollViewControllerAnimated_interactive___block_invoke(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 8);
  if (*(v2 + 24) == 1)
  {
    v3 = a1 + 40;
  }

  else
  {
    *(v2 + 24) = 1;
    v4 = CAMIsDeviceOrientationLocked();
    v5 = *(a1 + 40);
    v3 = a1 + 40;
    *(*(v5 + 8) + 24) = v4;
  }

  return *(*(*v3 + 8) + 24);
}

- (void)presentCameraRollViewControllerAnimated:(BOOL)a3 withAction:(unint64_t)a4 selectedAssetIndexFromEnd:(unint64_t)a5
{
  [(CAMViewfinderViewController *)self _presentCameraRollViewControllerAnimated:a3 interactive:1];
  objc_initWeak(&location, self);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __108__CAMViewfinderViewController_presentCameraRollViewControllerAnimated_withAction_selectedAssetIndexFromEnd___block_invoke;
  v8[3] = &unk_1E76F9AB0;
  objc_copyWeak(v9, &location);
  v9[1] = a5;
  v9[2] = a4;
  [(CAMViewfinderViewController *)self set_cameraRollControllerAction:v8];
  objc_destroyWeak(v9);
  objc_destroyWeak(&location);
}

void __108__CAMViewfinderViewController_presentCameraRollViewControllerAnimated_withAction_selectedAssetIndexFromEnd___block_invoke(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 32));

  if (WeakRetained)
  {
    v3 = objc_loadWeakRetained((a1 + 32));
    v4 = [v3 _cameraRollController];

    if (*(a1 + 40))
    {
      [v4 setCurrentAssetIndexFromEnd:?];
    }

    if (*(a1 + 48))
    {
      v5 = os_log_create("com.apple.camera", "CameraRoll");
      if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
      {
        v6 = *(a1 + 48);
        v10 = 134217984;
        v11 = v6;
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "CameraRoll: executing oneup action: %ld", &v10, 0xCu);
      }

      v7 = *(a1 + 48);
      v8 = [v4 oneUpViewController];
      [CAMViewfinderLockScreenExtensionHelper executeUnlockOneUpAction:v7 on:v8];
    }

    v9 = objc_loadWeakRetained((a1 + 32));
    [v9 set_cameraRollControllerAction:0];
  }
}

- (void)cameraRollController:(id)a3 didChangeImageWellImage:(id)a4 withUUID:(id)a5 animated:(BOOL)a6
{
  v6 = a6;
  v10 = a4;
  v9 = a5;
  if (![(CAMViewfinderViewController *)self _externalStorageOutputEnabled]|| ![(CAMViewfinderViewController *)self isRecording])
  {
    [(CAMViewfinderViewController *)self _presentImageWellImage:v10 uuid:v9 animated:v6];
  }
}

- (void)_presentInitialImageWellImageForSession
{
  v3 = objc_alloc(MEMORY[0x1E696AEC0]);
  v4 = [(CAMViewfinderViewController *)self _cameraRollController];
  v5 = [v3 initWithFormat:@"CAMPersistedThumbnailImage-session(%d)", objc_msgSend(v4, "sessionIdentifier")];

  v6 = [(CAMViewfinderViewController *)self _imageWell];
  v7 = [v6 thumbnailImageUUID];
  v8 = [v7 isEqualToString:v5];

  if ((v8 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _presentImageWellImage:0 uuid:0 animated:0];
    v9 = dispatch_get_global_queue(21, 0);
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke;
    block[3] = &unk_1E76F7960;
    block[4] = self;
    block[5] = v5;
    dispatch_async(v9, block);
  }
}

void __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _cameraRollController];
  v3 = [v2 persistedThumbnailImage];

  if (v3)
  {
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke_2;
    block[3] = &unk_1E76F7938;
    block[4] = *(a1 + 32);
    v4 = v3;
    v5 = *(a1 + 40);
    v7 = v4;
    v8 = v5;
    dispatch_async(MEMORY[0x1E69E96A0], block);
  }
}

- (void)changeToMode:(int64_t)a3
{
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];
  }

  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:a3 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self changeToMode:a3 device:v6 animated:1];
}

- (BOOL)_shouldResetZoomForChangeFromMode:(int64_t)a3 toMode:(int64_t)a4
{
  v6 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  if (a3 == 4 && !a4)
  {
    return 0;
  }

  if (a3)
  {
    v8 = 0;
  }

  else
  {
    v8 = a4 == 4;
  }

  v9 = !v8;
  return v9 & !v6;
}

- (id)_graphConfigurationForChangeToMode:(int64_t)a3 device:(int64_t)a4 fromGraphConfiguration:(id)a5
{
  v80 = a5;
  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 sanitizeDesiredDevice:a4 forMode:a3];
  v87 = [(CAMViewfinderViewController *)self emulationMode];
  if ((v9 - 1) > 0xA)
  {
    v10 = 0;
  }

  else
  {
    v10 = qword_1A3A685B0[v9 - 1];
  }

  v11 = +[CAMUserPreferences preferences];
  v79 = [v11 photoEncodingBehavior];
  if ([(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:a3 devicePosition:v10])
  {
    v12 = [v11 shouldEnableFrontRearSimultaneousVideo];
  }

  else
  {
    v12 = 0;
  }

  v89 = [(CAMViewfinderViewController *)self _sanitizedVideoConfigurationForMode:a3 device:v9 allowOverrides:1];
  v85 = v8;
  if ([(CAMViewfinderViewController *)self _trueVideoIsCapturing])
  {
    [v8 isProResVideoSupportedForMode:a3 frontRearSimultaneousVideoEnabled:v12];
    v13 = 0;
    v14 = 1;
  }

  else
  {
    v14 = [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture];
    v15 = [v8 isProResVideoSupportedForMode:a3 frontRearSimultaneousVideoEnabled:v12];
    v13 = 0;
    if (!v14 && v15)
    {
      v13 = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
      v14 = 0;
    }
  }

  v86 = v14;
  v16 = [(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabledForMode:a3 videoConfiguration:v89 desiredProResVideoMode:v13];
  v17 = [v11 videoEncodingBehaviorForConfiguration:v89 mode:a3 desiredProResVideoMode:v13 outputToExternalStorage:v16 frontRearSimultaneousVideoEnabled:v12];
  v18 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v19 = [v18 isCallActive];

  v83 = [v11 audioConfigurationForMode:a3 device:v9 emulationMode:v87 duringCall:v19];
  if ([(CAMViewfinderViewController *)self _wantsFilterScrubberVisible])
  {
    v20 = [v80 mode] == a3;
  }

  else
  {
    v20 = 0;
  }

  v78 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:a3 devicePosition:v10 videoThumbnailOutputEnabled:v20];
  v21 = +[CAMCaptureCapabilities capabilities];
  v22 = [v21 portraitInPhotoModeBehavior];

  v23 = (v22 & 1) != 0 && [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v77 = [(CAMViewfinderViewController *)self _previewFiltersForMode:a3 device:v9 wantsPhotoModePortraitEffect:v23];
  v76 = [v11 videoThumbnailOutputConfigurationForMode:a3 devicePosition:v10];
  v90 = 0;
  v91 = 0;
  [(CAMViewfinderViewController *)self _resolvePotentiallyConflictingControlsForMode:a3 device:v9 resolvedFlashMode:0 resolvedHDRMode:&v91 resolvedLivePhotoMode:0 resolvedRAWMode:&v90 resolvedPhotoResolution:0];
  v75 = [v11 isAutoFPSVideoEnabledForMode:a3 device:v9 videoConfiguration:v89 encodingBehavior:v17 outputToExternalStorage:v16 frontRearSimultaneousVideoEnabled:v12];
  v24 = +[CAMCaptureCapabilities capabilities];
  v74 = [v24 shouldSuspendVideoHDRForHDRMode:v91 captureMode:a3];

  v73 = [(CAMViewfinderViewController *)self _aspectRatioCropForMode:a3 devicePosition:v10];
  v72 = [v85 maxSupportedPhotoQualityPrioritizationForMode:a3 devicePosition:v10];
  v71 = [v11 mirrorCameraCapturesForDevicePosition:v10 mode:a3];
  if ([v11 rawControlEnabled])
  {
    v69 = [v85 isLinearDNGSupportedForMode:a3];
  }

  else
  {
    v69 = 0;
  }

  v68 = [v85 semanticStyleSupportForMode:a3 devicePosition:v10];
  v70 = [(CAMViewfinderViewController *)self _semanticStyleForPreviewWithSupport:?];
  if ([v11 shouldUseContentAwareDistortionCorrection])
  {
    v67 = [v85 isContentAwareDistortionCorrectionSupportedForMode:a3];
  }

  else
  {
    v67 = 0;
  }

  v88 = v12;
  if ([v11 responsiveShutterEnabled])
  {
    v65 = [v85 isResponsiveShutterSupportedForMode:a3];
  }

  else
  {
    v65 = 0;
  }

  v66 = v10;
  v25 = +[CAMUserPreferences preferences];
  v26 = +[CAMCaptureCapabilities capabilities];
  v27 = [v25 prefersHDR10BitVideoForCapabilities:v26];

  LOBYTE(v47) = v12;
  v82 = v27;
  v84 = v17;
  if ([v85 isEnhancedStabilizationSupportedForMode:a3 device:v9 videoConfiguration:v89 videoEncodingBehavior:v17 trueVideoEnabled:v86 prefersHDR10BitVideo:v27 frontRearSimultaneousVideoEnabled:v47])
  {
    v28 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  }

  else
  {
    v28 = 0;
  }

  v29 = [v11 videoStabilizationStrengthForVideoStabilizationMode:v28 captureMode:a3];
  BYTE2(v48) = v12;
  BYTE1(v48) = v27;
  LOBYTE(v48) = v86;
  if ([v85 isVideoStabilizationStrength:v29 supportedForMode:a3 device:v9 videoConfiguration:v89 videoEncodingBehavior:v17 outputToExternalStorage:v16 trueVideoEnabled:v48 prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:?])
  {
    v30 = v29;
  }

  else
  {
    v30 = 0;
  }

  v81 = v30;
  v64 = [v11 maximumPhotoResolutionForMode:a3 device:v9];
  v60 = v90;
  v63 = [(CAMViewfinderViewController *)self _resolvedColorSpaceForMode:a3 videoConfiguration:v89 videoEncodingBehavior:v17 device:v9];
  v62 = [v85 useVideoBinnedForMode:a3 videoConfiguration:v89 devicePosition:v66];
  v61 = [v11 shouldUseDepthSuggestionInPhotoMode];
  v31 = +[CAMUserPreferences preferences];
  if ([v31 isZoomPIPEnabled])
  {
    v32 = +[CAMCaptureCapabilities capabilities];
    v58 = [v32 isZoomPIPSupportedForMode:a3 devicePosition:v66 frontRearSimultaneousVideoEnabled:v12];
  }

  else
  {
    v58 = 0;
  }

  if ([v85 isCustomLensSupportedForMode:a3 device:v9 isTrueVideo:v86])
  {
    v59 = [v11 customLensGroup];
  }

  else
  {
    v59 = 0;
  }

  v33 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v35 = v34;
  v36 = [(CAMViewfinderViewController *)self _desiredMacroMode];
  BYTE1(v50) = v12;
  LOBYTE(v50) = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v57 = [CAMConflictingControlConfiguration resolveDesiredMacroMode:v36 forMode:a3 device:v9 videoConfiguration:v89 videoStabilizationStrength:v81 photoFormat:v33 optionalDepthEffectEnabled:v35 frontRearSimultaneousVideoEnabled:v50];
  v56 = [v11 windRemovalEnabledForAudioConfiguration:v83];
  v37 = +[CAMCaptureCapabilities capabilities];
  LODWORD(v36) = [v37 isDynamicAspectRatioSupportedForMode:a3 videoConfiguration:v89 devicePosition:v66];

  if (v36)
  {
    v38 = v86;
    if ([(CAMViewfinderViewController *)self _resolvedFlipAspectRatioForMode:a3 videoConfiguration:v89 devicePosition:v66 trueVideoEnabled:v86])
    {
      v39 = 1;
    }

    else
    {
      v39 = 2;
    }
  }

  else
  {
    v39 = 0;
    v38 = v86;
  }

  if (v60 == 1)
  {
    v40 = v69;
  }

  else
  {
    v40 = 0;
  }

  v41 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:a3 devicePosition:v66];
  v42 = [CAMCaptureGraphConfiguration alloc];
  v43 = [v11 shouldMixAudioWithOthers];
  v44 = [(CAMViewfinderViewController *)self _smartStyles];
  BYTE2(v55) = v88;
  BYTE1(v55) = v82;
  LOBYTE(v55) = v38;
  BYTE2(v54) = v58;
  BYTE1(v54) = v61;
  LOBYTE(v54) = v62;
  BYTE2(v53) = v40;
  BYTE1(v53) = v65;
  LOBYTE(v53) = v67;
  BYTE1(v52) = v69;
  LOBYTE(v52) = v71;
  BYTE1(v51) = v74;
  LOBYTE(v51) = v75;
  LOBYTE(v49) = v56;
  v45 = [CAMCaptureGraphConfiguration initWithCaptureMode:v42 captureDevice:"initWithCaptureMode:captureDevice:macroMode:videoConfiguration:audioConfiguration:mixAudioWithOthers:windNoiseRemovalEnabled:previewConfiguration:previewSampleBufferVideoFormat:previewFilters:videoThumbnailOutputConfiguration:photoEncodingBehavior:videoEncodingBehavior:enableAutoFPSVideo:videoHDRSuspended:aspectRatioCrop:photoQualityPrioritization:captureMirrored:enableRAWCaptureIfSupported:semanticStyleSupport:previewSemanticStyle:smartStyles:enableContentAwareDistortionCorrection:enableResponsiveShutter:suspendLivePhotoCapture:videoStabilizationStrength:maximumPhotoResolution:colorSpace:videoBinned:enableDepthSuggestion:enableZoomPIP:customLensGroup:trueVideoEnabled:prefersHDR10BitVideo:frontRearSimultaneousVideoEnabled:videoDynamicAspectRatio:smartFramingFieldOfView:" macroMode:a3 videoConfiguration:v9 audioConfiguration:v57 mixAudioWithOthers:v89 windNoiseRemovalEnabled:v83 previewConfiguration:v43 previewSampleBufferVideoFormat:v49 previewFilters:v78 videoThumbnailOutputConfiguration:0 photoEncodingBehavior:v77 videoEncodingBehavior:v76 enableAutoFPSVideo:v79 videoHDRSuspended:v84 aspectRatioCrop:v51 photoQualityPrioritization:v73 captureMirrored:v72 enableRAWCaptureIfSupported:v52 semanticStyleSupport:v68 previewSemanticStyle:v70 smartStyles:v44 enableContentAwareDistortionCorrection:v53 enableResponsiveShutter:v81 suspendLivePhotoCapture:v64 videoStabilizationStrength:v63 maximumPhotoResolution:v54 colorSpace:v59 videoBinned:v55 enableDepthSuggestion:v39 enableZoomPIP:v41 customLensGroup:? trueVideoEnabled:? prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:? videoDynamicAspectRatio:? smartFramingFieldOfView:?];

  return v45;
}

- (int64_t)_sanitizedVideoConfigurationForMode:(int64_t)a3 device:(int64_t)a4 allowOverrides:(BOOL)a5
{
  v5 = a5;
  if (![(CAMViewfinderViewController *)self emulationMode])
  {
    v10 = +[CAMUserPreferences preferences];
    v11 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
    v12 = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
    v13 = 0;
    if (a3 > 6)
    {
      if (a3 == 7)
      {
        if (v5 && [(CAMViewfinderViewController *)self _cinematicConfigurationOverride])
        {
          v18 = [(CAMViewfinderViewController *)self _cinematicConfigurationOverride];
        }

        else
        {
          v18 = [v10 cinematicConfiguration];
        }

        v15 = v18;
        v16 = 7;
      }

      else
      {
        if (a3 != 8)
        {
LABEL_30:

          return v13;
        }

        v15 = 7;
        v16 = 8;
      }
    }

    else
    {
      if (a3 != 1)
      {
        if (a3 == 2)
        {
          v14 = v5 && -[CAMViewfinderViewController _slomoConfigurationOverride](self, "_slomoConfigurationOverride") ? -[CAMViewfinderViewController _slomoConfigurationOverride](self, "_slomoConfigurationOverride") : [v10 slomoConfiguration];
          v13 = [CAMCaptureConfiguration sanitizeVideoConfigurationForDesiredConfiguration:v14 mode:2 device:a4 trueVideoEnabled:v11 frontRearSimultaneousVideoEnabled:v12];
          if (!v13)
          {
            v19 = +[CAMCaptureCapabilities capabilities];
            v20 = [v10 videoEncodingBehaviorForConfiguration:0 mode:2 desiredProResVideoMode:0 outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:v12];
            v21 = [v10 HDR10BitVideoEnabled];
            v22 = 0;
            if (v21)
            {
              v22 = [v19 isHDR10BitVideoSupportedForMode:2];
            }

            LOBYTE(v23) = v12;
            v13 = [v19 resolvedVideoConfigurationForMode:2 device:a4 videoEncodingBehavior:v20 videoConfiguration:0 outputToExternalStorage:0 prefersHDR10BitVideo:v22 frontRearSimultaneousVideoEnabled:v23];
          }
        }

        goto LABEL_30;
      }

      if (v5 && [(CAMViewfinderViewController *)self _videoConfigurationOverride])
      {
        v17 = [(CAMViewfinderViewController *)self _videoConfigurationOverride];
      }

      else
      {
        v17 = [v10 videoConfiguration];
      }

      v15 = v17;
      v16 = 1;
    }

    v13 = [CAMCaptureConfiguration sanitizeVideoConfigurationForDesiredConfiguration:v15 mode:v16 device:a4 trueVideoEnabled:v11 frontRearSimultaneousVideoEnabled:v12];
    goto LABEL_30;
  }

  return [(CAMViewfinderViewController *)self imagePickerVideoConfiguration];
}

- (void)_changeToGraphConfiguration:(id)a3 zoomFactor:(double)a4 fromGraphConfiguration:(id)a5
{
  v30 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a5;
  v10 = [v8 mode];
  v11 = [v8 device];
  v12 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v13 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", v9, [v12 isCallActive]);

  v14 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v15 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", v8, [v14 isCallActive]);

  if (v15)
  {
    [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
  }

  else
  {
    CAMSignpostWithIDAndArgs(9, 0xEEEEB0B5B2B2EEEELL, v10, v11, 0, 0);
    [(CAMViewfinderViewController *)self _setNeedsDeferredGraphConfiguration:0];
    [(CAMViewfinderViewController *)self _minimumExecutionTimeForChangeToGraphConfiguration:v8 fromGraphConfiguration:v9];
    v17 = v16;
    v18 = [(CAMViewfinderViewController *)self _captureController];
    v19 = [v18 changeToGraphConfiguration:v8 zoomFactor:-[CAMViewfinderViewController _externalStorageOutputEnabled](self minimumExecutionTime:"_externalStorageOutputEnabled") outputToExternalStorage:{a4, v17}];
    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:v19];
    v20 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v24 = 138543874;
      v25 = v8;
      v26 = 1024;
      v27 = v19;
      v28 = 2048;
      v29 = a4;
      _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Requested change to %{public}@ (requestID=%d) (zoom=%.3f)", &v24, 0x1Cu);
    }

    if (v13)
    {
      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
    }

    [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:v8 animated:1];
    [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:v10];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:v10];
    v21 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v21 setCaptureMode:v10];

    v22 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v22 setCaptureDevice:v11];

    v23 = [(CAMViewfinderViewController *)self _dockKitController];
    [v23 captureModeDidChange:v10];
  }
}

- (double)_minimumExecutionTimeForChangeToGraphConfiguration:(id)a3 fromGraphConfiguration:(id)a4
{
  v5 = a4;
  v6 = a3;
  v7 = [v6 mode];
  v8 = [v5 mode];
  v9 = [v6 device];

  if ((v9 - 1) > 0xA)
  {
    v10 = 0;
  }

  else
  {
    v10 = qword_1A3A685B0[v9 - 1];
  }

  v11 = [v5 device];

  if ((v11 - 1) > 0xA)
  {
    v12 = 0;
    if (v8)
    {
      goto LABEL_16;
    }
  }

  else
  {
    v12 = qword_1A3A685B0[v11 - 1];
    if (v8)
    {
      goto LABEL_16;
    }
  }

  if (v7 == 4)
  {
    v13 = 1;
    goto LABEL_10;
  }

LABEL_16:
  v13 = v8 == 4 && v7 == 0;
  if (v8 == 5 && v7 == 1)
  {
    v15 = 1;
    goto LABEL_25;
  }

LABEL_10:
  v15 = v8 == 1 && v7 == 5;
LABEL_25:
  result = 0.285;
  if (v12 != v10 || v8 != v7 && !v13 && !v15)
  {
    return 0.0;
  }

  return result;
}

- (int64_t)_aspectRatioForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 devicePosition:(int64_t)a5 trueVideoEnabled:(BOOL)a6
{
  result = 0;
  if (a3 > 4)
  {
    if (a3 <= 6)
    {
      if (a3 == 5)
      {
        return 1;
      }
    }

    else
    {
      if (a3 == 7)
      {
LABEL_12:
        if ([(CAMViewfinderViewController *)self _resolvedFlipAspectRatioForMode:a3 videoConfiguration:a4 devicePosition:a5 trueVideoEnabled:a6])
        {
          return 6;
        }

        else
        {
          return 1;
        }
      }

      if (a3 == 8)
      {
        return 1;
      }

      if (a3 != 9)
      {
        return result;
      }
    }
  }

  else
  {
    if (a3 > 1)
    {
      if ((a3 - 2) >= 2)
      {
        v10 = a3 == 4;
        goto LABEL_19;
      }

      return 1;
    }

    if (a3)
    {
      if (a3 != 1)
      {
        return result;
      }

      goto LABEL_12;
    }
  }

  v11 = [(CAMViewfinderViewController *)self _aspectRatioCropForMode:a3 devicePosition:a5, a5, a6];
  v12 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:a3 devicePosition:a5]- 3;
  if (v11 > 1)
  {
    v13 = 6;
    if (v12 >= 2)
    {
      v13 = 1;
    }

    v14 = 2;
    if (v11 != 3)
    {
      v14 = 0;
    }

    if (v11 == 2)
    {
      return v13;
    }

    else
    {
      return v14;
    }
  }

  else
  {
    if (v11)
    {
      v10 = v11 == 1;
LABEL_19:
      if (v10)
      {
        return 3;
      }

      else
      {
        return 0;
      }
    }

    v15 = [(CAMViewfinderViewController *)self emulationMode];
    v16 = 5;
    if (v12 >= 2)
    {
      v16 = 0;
    }

    if (v15 == 2)
    {
      return 4;
    }

    else
    {
      return v16;
    }
  }
}

- (int64_t)_shutterButtonModeForCameraMode:(int64_t)a3 isCapturing:(BOOL)a4
{
  v4 = a4;
  if (a3 <= 2)
  {
    if (a3)
    {
      if (a3 != 1)
      {
        v6 = 2;
        if (a4)
        {
          v6 = 7;
        }

        v7 = a3 == 2;
        goto LABEL_28;
      }

LABEL_22:
      if (a4)
      {
        return 6;
      }

      else
      {
        return 1;
      }
    }
  }

  else
  {
    if (a3 > 9)
    {
LABEL_25:
      v6 = 5;
      if (!a4)
      {
        v6 = 0;
      }

      v7 = a3 == 3;
LABEL_28:
      if (v7)
      {
        return v6;
      }

      else
      {
        return 0;
      }
    }

    if (((1 << a3) & 0x250) == 0)
    {
      if (((1 << a3) & 0x180) == 0)
      {
        if (a3 == 5)
        {
          if (a4)
          {
            return 8;
          }

          else
          {
            return 3;
          }
        }

        goto LABEL_25;
      }

      goto LABEL_22;
    }
  }

  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 isLivePhotoSupported];
  v10 = 4;
  if (v4)
  {
    v10 = 9;
  }

  v11 = 5;
  if (!v4)
  {
    v11 = 0;
  }

  if (v9)
  {
    v5 = v10;
  }

  else
  {
    v5 = v11;
  }

  return v5;
}

- ($76EADD4ED24426C67044446678BAA581)_dynamicShutterSettingsForGraphConfiguration:(SEL)a3
{
  v30 = a4;
  *&retstr->var4 = xmmword_1A3A6AA58;
  *&retstr->var6 = unk_1A3A6AA68;
  retstr->var8 = 0;
  *&retstr->var0 = CAMDynamicShutterSettingsDefault;
  *&retstr->var2 = unk_1A3A6AA48;
  v6 = [(CAMViewfinderViewController *)self timerDuration];
  v7 = [(CAMViewfinderViewController *)self _useMessagesControls];
  v8 = +[CAMCaptureCapabilities capabilities];
  if (v7 || ![v8 isStillDuringVideoSupportedForVideoEncodingBehavior:{objc_msgSend(v30, "videoEncodingBehavior")}])
  {
    v9 = 0;
  }

  else
  {
    v9 = [v8 isStillDuringVideoSupportedForMode:{objc_msgSend(v30, "mode")}];
  }

  v10 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v30];
  v11 = [v30 mode];
  if (v11 > 4)
  {
    if (v11 <= 6)
    {
      if (v11 == 5)
      {
        retstr->var0 = 1;
        retstr->var8 = 1;
        *&retstr->var6 = xmmword_1A3A681A0;
        goto LABEL_41;
      }

      if (v6)
      {
        goto LABEL_30;
      }
    }

    else
    {
      if (v11 == 7)
      {
        v18 = 1;
        v15 = vdupq_n_s64(1uLL);
        *&retstr->var0 = v15;
        retstr->var2 = 1;
        if (v9)
        {
          v18 = 2;
        }

        retstr->var5 = v18;
        goto LABEL_39;
      }

      if (v11 == 8)
      {
LABEL_19:
        *&retstr->var0 = vdupq_n_s64(1uLL);
        retstr->var2 = 1;
        if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
        {
          retstr->var2 = 0;
        }

        if (v9)
        {
          v14 = 2;
        }

        else
        {
          v14 = 1;
        }

        retstr->var5 = v14;
        v15 = vdupq_n_s64(1uLL);
LABEL_39:
        *&retstr->var7 = v15;
        goto LABEL_40;
      }

      if (v11 != 9)
      {
        goto LABEL_41;
      }

      if (v6)
      {
        goto LABEL_30;
      }

      v12 = +[CAMCaptureCapabilities capabilities];
      v13 = [v12 isSpatialModeTrueVideoSupported];

      if (v13)
      {
        *&retstr->var0 = xmmword_1A3A67B10;
        *&retstr->var2 = xmmword_1A3A68320;
        retstr->var5 = 1;
        retstr->var7 = 1;
LABEL_40:
        retstr->var4 = v10;
        goto LABEL_41;
      }
    }

    if (![(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable])
    {
      goto LABEL_41;
    }

LABEL_30:
    retstr->var0 = 1;
    goto LABEL_41;
  }

  if (v11 <= 1)
  {
    if (!v11)
    {
LABEL_29:
      if (v6)
      {
        goto LABEL_30;
      }

      if ([(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
      {
        v20 = 1;
      }

      else
      {
        v21 = [(CAMViewfinderViewController *)self _captureController];
        v20 = [v21 isCapturingNightModeImage];
      }

      v22 = [(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
      if ([v8 isLongPressVideoCaptureFromPhotoModeSupported])
      {
        retstr->var0 = [(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable];
        v23 = v20 ^ 1u;
        retstr->var2 = v23;
        retstr->var3 = ((v22 | v20) & 1) == 0;
        v24 = 1;
        if (v22)
        {
          v25 = 1;
        }

        else
        {
          v25 = 2;
        }

        if (v20)
        {
          v25 = 0;
        }

        retstr->var5 = v25;
      }

      else
      {
        if (v22)
        {
          v24 = 0;
        }

        else
        {
          v24 = 2;
        }

        v23 = v20 ^ 1u;
      }

      retstr->var1 = v24;
      retstr->var7 = v23;
      if ([v8 isTrueVideoSupported])
      {
        v26 = [v8 isTrueVideoSupportedForMode:{objc_msgSend(v30, "mode")}];
        v27 = v30;
        v28 = v26;
      }

      else
      {
        v28 = 0;
        v27 = v30;
      }

      v29 = [v8 isDynamicAspectRatioSupportedForMode:1 devicePosition:{objc_msgSend(v27, "devicePosition")}];
      if (v10 && v28 && v29)
      {
        LOBYTE(v10) = [v8 dynamicAspectRatioZoomSupported];
      }

      goto LABEL_40;
    }

    if (v11 != 1)
    {
      goto LABEL_41;
    }

    goto LABEL_19;
  }

  if (v11 == 2)
  {
    v16 = vdupq_n_s64(1uLL);
    *&retstr->var0 = v16;
    retstr->var2 = v9;
    if (v9)
    {
      v17 = 2;
    }

    else
    {
      v17 = 1;
    }

    retstr->var5 = v17;
    retstr->var8 = 1;
    *&retstr->var6 = v16;
    goto LABEL_40;
  }

  if (v11 != 3)
  {
    goto LABEL_29;
  }

  *&retstr->var0 = vdupq_n_s64(1uLL);
LABEL_41:

  return result;
}

- ($E5C720D6BB068A42F0C2CD001350366C)_dynamicShutterPrivateSettingsForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];

  LOBYTE(v3) = [v4 isPauseVideoSupportedForMode:v5];
  return v3;
}

- (void)_updateShutterButtonForGraphConfiguration:(id)a3 isCapturing:(BOOL)a4 animated:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v8 = a3;
  v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (v9)
  {
    v22 = 0;
    v20 = 0u;
    v21 = 0u;
    v18 = 0u;
    v19 = 0u;
    [(CAMViewfinderViewController *)self _dynamicShutterSettingsForGraphConfiguration:v8];
    v10.var0 = [(CAMViewfinderViewController *)self _dynamicShutterPrivateSettingsForGraphConfiguration:v8];

    v11 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    v16[2] = v20;
    v16[3] = v21;
    v17 = v22;
    v16[0] = v18;
    v16[1] = v19;
    [v11 setSettings:v16 privateSettings:v10.var0 animated:v5];

    v12 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    v13 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v12 updateChromeViewModel:v13];
  }

  else
  {
    v15 = [(CAMViewfinderViewController *)self _shutterButton];
    v14 = [v8 mode];

    [v15 setMode:-[CAMViewfinderViewController _shutterButtonModeForCameraMode:isCapturing:](self animated:{"_shutterButtonModeForCameraMode:isCapturing:", v14, v6), v5}];
  }
}

- (void)setShutterButtonSpinning:(BOOL)a3
{
  if (a3)
  {
    if (self->_shutterButtonSpinning)
    {
      return;
    }

    self->_shutterButtonSpinning = a3;
  }

  else
  {
    if (![(CAMViewfinderViewController *)self isShutterButtonSpinning])
    {
      return;
    }

    self->_shutterButtonSpinning = a3;
    self->__internalShutterButtonSpinning = 0;
  }

  [(CAMViewfinderViewController *)self _updateShutterButtonSpinning];
}

- (void)_setInternalShutterButtonSpinning:(BOOL)a3
{
  if (self->__internalShutterButtonSpinning != a3)
  {
    self->__internalShutterButtonSpinning = a3;
    [(CAMViewfinderViewController *)self _updateShutterButtonSpinning];
  }
}

- (void)_updateShutterButtonSpinning
{
  v3 = [(CAMViewfinderViewController *)self isShutterButtonSpinning];
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 isSmartStylePickerVisible];

  if (v5)
  {
    v9 = [(CAMViewfinderViewController *)self _controlDrawer];
    v6 = [v9 smartStyleButton];
    v7 = [v6 shutterButton];
    [v7 setSpinning:v3];
  }

  else
  {
    v8 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (v8)
    {
      [(CAMViewfinderViewController *)self _dynamicShutterControl];
    }

    else
    {
      [(CAMViewfinderViewController *)self _shutterButton];
    }
    v9 = ;
    [v9 setSpinning:v3];
  }
}

- (void)_updateShutterButtonForEndOfNightModeCapture
{
  v6 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = ([v3 isCapturingNightModeImage] & 1) != 0 || -[CAMViewfinderViewController _isNightModeCaptureCanceling](self, "_isNightModeCaptureCanceling");
  [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:v4];

  [v6 resetAnimated:1];
  if ([(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
  {
    [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture finished exposing"];
    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v5 isCapturing:0 animated:1];
  }
}

- (void)_updateShutterButtonLegibility
{
  v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = [v3 viewportAspectRatio];

  v6 = v4 == 4 || v4 == 1;
  v7 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v7 setShowContrastBorder:v6];
}

- (id)modesForModeDial:(id)a3
{
  v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v5 = [(CAMViewfinderViewController *)self availableCaptureModes];
  if ([v5 containsObject:&unk_1F16C7658])
  {
    [v4 addObject:&unk_1F16C7658];
  }

  if ([v5 containsObject:&unk_1F16C7610])
  {
    [v4 addObject:&unk_1F16C7610];
  }

  if ([v5 containsObject:&unk_1F16C7688])
  {
    [v4 addObject:&unk_1F16C7688];
  }

  if ([v5 containsObject:&unk_1F16C75F8])
  {
    [v4 addObject:&unk_1F16C75F8];
  }

  if ([v5 containsObject:&unk_1F16C7748])
  {
    [v4 addObject:&unk_1F16C7748];
  }

  if ([v5 containsObject:&unk_1F16C7670])
  {
    [v4 addObject:&unk_1F16C7670];
  }

  v6 = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
  if ([v5 containsObject:&unk_1F16C76A0] && v6)
  {
    [v4 addObject:&unk_1F16C76A0];
  }

  if (!(v6 | (([v5 containsObject:&unk_1F16C76B8] & 1) == 0)))
  {
    [v4 addObject:&unk_1F16C76B8];
  }

  if ([v5 containsObject:&unk_1F16C7640])
  {
    [v4 addObject:&unk_1F16C7640];
  }

  if ([v5 containsObject:&unk_1F16C7628])
  {
    [v4 addObject:&unk_1F16C7628];
  }

  return v4;
}

- (BOOL)_modeChangeSwipeMatchesExposureBiasPanDirection
{
  v3 = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = ([v4 previewViewOrientation] - 3) < 2;
    v6 = [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer direction];
    v7 = v5 ^ [v3 _canPanVertically];
    v9 = v6 != 4 && v6 != 8;
    v10 = v9 ^ v7;
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_smartStyleChangeSwipeMatchesExposureBiasPanDirection
{
  v3 = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
  if (v3)
  {
    v4 = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = ([v4 previewViewOrientation] - 5) < 0xFFFFFFFFFFFFFFFELL;

    v6 = [v3 _canPanVertically] ^ v5;
  }

  else
  {
    LOBYTE(v6) = 0;
  }

  return v6;
}

- (BOOL)gestureRecognizer:(id)a3 shouldRecognizeSimultaneouslyWithGestureRecognizer:(id)a4
{
  v6 = a3;
  v7 = a4;
  if ([(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection])
  {
    v8 = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
    v9 = v8 == v7 && (self->__previousModeGestureRecognizer == v6 || self->__nextModeGestureRecognizer == v6);
  }

  else
  {
    v9 = 0;
  }

  if (self->__zoomPinchGestureRecognizer == v6)
  {
    v11 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    v12 = [v11 gestureRecognizers];
    v10 = [v12 containsObject:v7];
  }

  else
  {
    v10 = 0;
  }

  v13 = [(CAMViewfinderViewController *)self _sharedLibraryLongPressGestureRecognizer];

  if (v13 == v6)
  {
    v15 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    v16 = [v15 touchingGestureRecognizer];
    v14 = v16 == v7;
  }

  else
  {
    v14 = v9 | v10;
  }

  return v14;
}

- (BOOL)gestureRecognizerShouldBegin:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  if (([v5 isCapturingNightModeImage] & 1) != 0 || -[CAMViewfinderViewController _wantsVisualTextAnalysis](self, "_wantsVisualTextAnalysis"))
  {
    v6 = 0;
  }

  else if (self->__zoomPinchGestureRecognizer == v4)
  {
    v8 = [(CAMViewfinderViewController *)self _isPinchToZoomAllowed];
    v9 = [(CAMViewfinderViewController *)self _isModeDisabled];
    v10 = [v5 isCapturingBurst];
    v11 = (v10 | [(CAMViewfinderViewController *)self _isCapturingFromTimer]) ^ 1;
    if (v9)
    {
      LOBYTE(v11) = 0;
    }

    if (v8)
    {
      v6 = v11;
    }

    else
    {
      v6 = 0;
    }
  }

  else if (self->__nextModeGestureRecognizer == v4 || self->__previousModeGestureRecognizer == v4)
  {
    v6 = [v5 isCapturingBurst] ^ 1;
  }

  else if (self->__smartStylesSwipeLeftGestureRecognizer == v4 || self->__smartStylesSwipeRightGestureRecognizer == v4)
  {
    v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [v12 smartStylePicker];

    [(UISwipeGestureRecognizer *)v4 locationInView:v13];
    v15 = v14;
    v17 = v16;
    [v13 bounds];
    v18.x = v15;
    v18.y = v17;
    v6 = CGRectContainsPoint(v19, v18);
  }

  else
  {
    v6 = 1;
  }

  return v6 & 1;
}

- (BOOL)gestureRecognizer:(id)a3 shouldReceiveTouch:(id)a4
{
  v6 = a3;
  v7 = a4;
  zoomPinchGestureRecognizer = self->__zoomPinchGestureRecognizer;
  v9 = [(CAMViewfinderViewController *)self _primaryShutterControl];
  v10 = [v9 isTracking];

  if (!v10 || zoomPinchGestureRecognizer == v6)
  {
    if (self->__nextModeGestureRecognizer != v6 && self->__previousModeGestureRecognizer != v6)
    {
      if (self->__zoomPinchGestureRecognizer != v6)
      {
        v11 = 1;
        goto LABEL_45;
      }

      v12 = [(CAMViewfinderViewController *)self _topBar];
      [v7 locationInView:v12];
      v34 = v33;
      if (v12)
      {
        v35 = v32;
        [v12 bounds];
        v87.x = v35;
        v87.y = v34;
        v36 = CGRectContainsPoint(v90, v87);
      }

      else
      {
        v36 = 0;
      }

      v78 = [(CAMViewfinderViewController *)self _bottomBar];
      [v7 locationInView:v78];
      if (v78)
      {
        v82 = v80;
        v83 = v81;
        [v78 bounds];
        v88.x = v82;
        v88.y = v83;
        v84 = !CGRectContainsPoint(v93, v88);
      }

      else
      {
        LOBYTE(v84) = 1;
      }

      if (v34 < 0.0 && v12 != 0)
      {
        LOBYTE(v84) = 0;
      }

      v11 = !v36 && v84;
LABEL_44:

      goto LABEL_45;
    }

    v12 = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
    if (v12)
    {
      if ([(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection])
      {
        if (!self->__modeDial || ([v7 locationInView:?], v14 = v13, v16 = v15, -[CAMModeDial bounds](self->__modeDial, "bounds"), v89.origin.x = v17 + 0.0, v89.origin.y = v18 + -10.0, v89.size.height = v19 + 10.0, v86.x = v14, v86.y = v16, !CGRectContainsPoint(v89, v86)))
        {
          v11 = 0;
LABEL_43:
          v78 = [(CAMViewfinderViewController *)self _feedbackController];
          [v78 prepareDiscreteFeedback:0];
          goto LABEL_44;
        }
      }
    }

    v20 = [v7 view];
    v21 = [(CAMViewfinderViewController *)self _layoutStyle];
    if (v21 != 3 && v21)
    {
      v11 = 1;
LABEL_40:
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v77 = [(CAMViewfinderViewController *)self _modeDial];
        v11 = v20 == v77;
      }

      goto LABEL_43;
    }

    v22 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v23 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v24 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v23];

    if ([v22 isControlDrawerExpanded])
    {
      v25 = [v22 isControlDrawerVisible];
    }

    else
    {
      v25 = 0;
    }

    v26 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v27 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:v26];

    v28 = [(CAMViewfinderViewController *)self _topBar];
    if (!v28 || v27)
    {
      v29 = [v22 controlStatusBar];
    }

    else
    {
      v29 = [(CAMViewfinderViewController *)self _topBar];
    }

    v30 = v29;

    if (v25)
    {
      v31 = [v22 controlDrawer];
    }

    else
    {
      if (v24)
      {
        [(CAMViewfinderViewController *)self _primaryShutterControl];
      }

      else
      {
        [(CAMViewfinderViewController *)self _utilityBar];
      }
      v31 = ;
    }

    v37 = v31;
    [v30 bounds];
    v39 = v38;
    v41 = v40;
    v43 = v42;
    v45 = v44;
    v46 = [(CAMViewfinderViewController *)self view];
    [v30 convertRect:v46 toView:{v39, v41, v43, v45}];
    v48 = v47;
    v50 = v49;
    v52 = v51;
    v54 = v53;

    [v37 bounds];
    v56 = v55;
    v58 = v57;
    v60 = v59;
    v62 = v61;
    v63 = [(CAMViewfinderViewController *)self view];
    [v37 convertRect:v63 toView:{v56, v58, v60, v62}];
    v65 = v64;
    v67 = v66;
    v69 = v68;
    v71 = v70;

    if (v30)
    {
      v91.origin.x = v48;
      v91.origin.y = v50;
      v91.size.width = v52;
      v91.size.height = v54;
      MaxY = CGRectGetMaxY(v91);
      if (v37)
      {
LABEL_33:
        v92.origin.x = v65;
        v92.origin.y = v67;
        v92.size.width = v69;
        v92.size.height = v71;
        MinY = CGRectGetMinY(v92);
LABEL_36:
        v74 = [(CAMViewfinderViewController *)self view];
        [v7 locationInView:v74];
        v76 = v75;

        v11 = v76 > MaxY && v76 < MinY;
        goto LABEL_40;
      }
    }

    else
    {
      MaxY = 0.0;
      if (v37)
      {
        goto LABEL_33;
      }
    }

    MinY = 1.79769313e308;
    goto LABEL_36;
  }

  v11 = 0;
LABEL_45:

  return v11;
}

- (BOOL)gestureRecognizer:(id)a3 shouldRequireFailureOfGestureRecognizer:(id)a4
{
  v6 = a4;
  previewViewController = self->__previewViewController;
  v8 = a3;
  v9 = [(CAMPreviewViewController *)previewViewController activeExposureBiasPanGestureRecognizer];

  v10 = v9 == v8 && ![(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection]&& (self->__previousModeGestureRecognizer == v6 || self->__nextModeGestureRecognizer == v6);
  return v10;
}

- (void)previewViewControllerDidChangeFocusOrExposureLocked:(id)a3 shouldAnimate:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  [(CAMViewfinderViewController *)self _updateFocusAndExposureLockBadgeAnimated:v4];
  LODWORD(v4) = [v6 isFocusLockedByUser];

  if (v4)
  {
    v7 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [v7 didFocusLockInteraction];
  }
}

- (void)previewViewControllerDidChangeFocusOrExposure:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "previewViewControllerDidChangeFocusOrExposure", v7, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v5 didFocusInteraction];

  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v6 animated:1];
}

- (void)previewViewController:(id)a3 willResetFocus:(BOOL)a4 exposure:(BOOL)a5
{
  v5 = a4;
  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle:a3];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v7 animated:1];

  if (v5)
  {
    v8 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v8 setIsLensPositionLockedByUser:0];
  }
}

- (BOOL)previewViewControllerShouldRestrictExposureBiasPanToTouchesNearSlider:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _motionController];
  v5 = [v4 captureOrientation];

  v6 = v5 - 1;
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 allowControlDrawer];

  if (v6 < 2)
  {
    v9 = v8;
  }

  else
  {
    v9 = 0;
  }

  if ([(CAMViewfinderViewController *)self _shouldEnableSmartStylesSwipeGestures])
  {
    v9 |= [(CAMViewfinderViewController *)self _smartStyleChangeSwipeMatchesExposureBiasPanDirection];
  }

  return v9 & 1;
}

- (void)previewViewControllerDidChangeVideoFillAspectRatio:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self viewfinderView];
  [v3 setNeedsLayout];
}

- (void)frontPIPFrameDidChange:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v8 = [(CAMViewfinderViewController *)self chromeViewController];
  v9 = [v8 view];
  v10 = [(CAMViewfinderViewController *)self _previewViewController];
  v11 = [v10 view];
  [v9 convertRect:v11 fromView:{x, y, width, height}];
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v19 = v18;

  v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v20 setFrontPIPFrame:{v13, v15, v17, v19}];
}

- (void)frontPIPWillAnimateToAnchor:(int64_t)a3 withFrame:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  v8 = a3;
  v10 = (a3 & 0xFFFFFFFFFFFFFFFELL) == 2;
  v11 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v12 = [(CAMViewfinderViewController *)self _frsvAnalyticsId];
  v13 = [v11 objectForKey:v12];

  [v13 trackFrontRearSimultaneousVideoPIPMoveToAnchor:v8];
  [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoPIPAnchor:v8];
  LODWORD(v8) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
  v14 = [(CAMViewfinderViewController *)self _previewViewController];
  v15 = [v14 view];
  [(CAMViewfinderViewController *)self _calculateVerticalOffsetFromZoomPlatterToFrame:v15 fromView:x, y, width, height];
  v17 = v16;

  if ((v10 & v8) == 0)
  {
    v17 = 0.0;
  }

  v18 = [(CAMViewfinderViewController *)self _zoomControl];
  [v18 buttonPlatterVerticalOffset];
  v20 = v19;

  if ((BSFloatEqualToFloat() & 1) == 0)
  {
    v21 = objc_alloc_init(MEMORY[0x1E6993858]);
    [v21 setDefaultCriticallyDampedValues];
    v22 = [(CAMViewfinderViewController *)self _zoomControl];
    v23 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v24 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v25 = MEMORY[0x1E6993860];
    v39[0] = MEMORY[0x1E69E9820];
    v39[1] = 3221225472;
    v39[2] = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke;
    v39[3] = &unk_1E76F9AD8;
    v40 = v22;
    v41 = v24;
    v42 = v23;
    v43 = v17;
    v26 = v23;
    v27 = v24;
    v28 = v22;
    v29 = [v25 floatAnimatablePropertyWithInitialValue:v39 cancelableFrameCallback:v20];
    v30 = MEMORY[0x1E69DD250];
    v33 = MEMORY[0x1E69E9820];
    v34 = 3221225472;
    v35 = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_3;
    v36 = &unk_1E76F7A38;
    v37 = v29;
    v38 = v17;
    v31 = v29;
    [v30 cek_animateWithSettings:v21 mode:3 animations:&v33 completion:0];
    v32 = [(CAMViewfinderViewController *)self _zoomButtonPlatterOffsetAnimator:v33];
    [v32 invalidate];

    [(CAMViewfinderViewController *)self set_zoomButtonPlatterOffsetAnimator:v31];
  }
}

BOOL __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  [v3 presentationValue];
  [*(a1 + 32) setButtonPlatterVerticalOffset:?];
  [*(a1 + 40) setNeedsLayout];
  v4 = *(a1 + 48);
  v8 = MEMORY[0x1E69E9820];
  v9 = 3221225472;
  v10 = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_2;
  v11 = &unk_1E76F7960;
  v12 = v4;
  v5 = v3;
  v13 = v5;
  [v12 performChanges:&v8];
  [v5 velocity];
  v6 = 0;
  if (BSFloatIsZero())
  {
    [v5 presentationValue];
    if (BSFloatEqualToFloat())
    {
      v6 = 1;
    }
  }

  return v6;
}

uint64_t __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_2(uint64_t a1)
{
  [*(a1 + 40) presentationValue];
  v2 = *(a1 + 32);

  return [v2 setButtonPlatterVerticalOffset:?];
}

- (double)_calculateVerticalOffsetFromZoomPlatterToFrame:(CGRect)a3 fromView:(id)a4
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v9 = a4;
  v10 = [(CAMViewfinderViewController *)self view];
  [v10 convertRect:v9 fromView:{x, y, width, height}];
  v12 = v11;

  v13 = [(CAMViewfinderViewController *)self view];
  v14 = [(CAMViewfinderViewController *)self _zoomControl];
  [v14 buttonPlatterDefaultFrame];
  v16 = v15;
  v18 = v17;
  v20 = v19;
  v22 = v21;
  v23 = [(CAMViewfinderViewController *)self _zoomControl];
  [v13 convertRect:v23 fromView:{v16, v18, v20, v22}];
  v25 = v24;
  v27 = v26;

  v28 = v25 + v27 - v12;
  v29 = v28 + 8.0;
  v30 = v28 <= 0.0;
  result = 0.0;
  if (!v30)
  {
    return v29;
  }

  return result;
}

- (void)captureController:(id)a3 didOutputLensPosition:(double)a4
{
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v7 = [v6 isTrackingLensPositionSlider];

  if ((v7 & 1) == 0)
  {
    v8 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v8 setLensPosition:a4];
  }
}

- (void)captureController:(id)a3 didOutputLensSmudgeStatus:(int64_t)a4
{
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 devicePosition];

  if (v7)
  {
    if (v7 == 1)
    {
      v8 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
    }

    else
    {
      v8 = 0;
    }
  }

  else
  {
    v8 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  }

  v10 = v8;
  v9 = [v8 status];
  [v10 setStatus:a4];
  if (a4 == 2 && v9 != 2)
  {
    [(CAMViewfinderViewController *)self _displayLensSmudgeDetected:v7];
  }
}

- (void)_displayLensSmudgeDetected:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];

  [(CAMViewfinderViewController *)self _createCleanLensesInstructionLabelIfNecessary];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:v6 animated:1];

  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:v7];

  v9 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v9 didDetectSmudgedLensForDevicePosition:a3 didNotifyUser:v8];
}

- (void)lensSmudgeDisplayShouldBeHiddenForDevicePosition:(int64_t)a3
{
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== a3)
  {
    v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v4 animated:1];

    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:v5 animated:1];
  }
}

- (CGRect)chromeSidebarFrame
{
  v2 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v2 chromeSidebarFrame];
  v4 = v3;
  v6 = v5;
  v8 = v7;
  v10 = v9;

  v11 = v4;
  v12 = v6;
  v13 = v8;
  v14 = v10;
  result.size.height = v14;
  result.size.width = v13;
  result.origin.y = v12;
  result.origin.x = v11;
  return result;
}

- (void)captureController:(id)a3 didUpdateActivePrimaryConstituentDeviceType:(int64_t)a4
{
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v6 setActivePrimaryConstituentDeviceType:a4];

  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
}

- (int64_t)_effectFilterTypeForMode:(int64_t)a3
{
  if ([(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    if (a3 == 6)
    {

      return [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
    }

    else if (a3 == 4)
    {

      return [(CAMViewfinderViewController *)self _squareModeEffectFilterType];
    }

    else if (a3)
    {
      return 0;
    }

    else
    {

      return [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
    }
  }

  else
  {

    return [CAMUserPreferences defaultFilterTypeForMode:a3];
  }
}

- (int64_t)_itemIndexForFilterType:(int64_t)a3
{
  v13 = *MEMORY[0x1E69E9840];
  v4 = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
  v6 = [v4 indexOfObject:v5];

  if (v6 == 0x7FFFFFFFFFFFFFFFLL)
  {
    v7 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v9 = 134218242;
      v10 = a3;
      v11 = 2114;
      v12 = v4;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Tried to get index for filterType %ld; only filterTypes are %{public}@", &v9, 0x16u);
    }

    v6 = 0;
  }

  return v6;
}

- (int64_t)_filterTypeForItemIndex:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = v4;
  if (a3 < 0 || [v4 count] <= a3)
  {
    v7 = 0;
  }

  else
  {
    v6 = [v5 objectAtIndexedSubscript:a3];
    v7 = [v6 integerValue];
  }

  return v7;
}

- (void)_setEffectFilterType:(int64_t)a3 forMode:(int64_t)a4
{
  v8 = *MEMORY[0x1E69E9840];
  if (a4 > 9)
  {
LABEL_13:
    if (!a4)
    {

      [(CAMViewfinderViewController *)self _setPhotoModeEffectFilterType:a3];
    }

    return;
  }

  if (((1 << a4) & 0x3AE) != 0)
  {
    if (a3)
    {
      v5 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
      {
        v6 = 134217984;
        v7 = a4;
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Trying to set filter type on unhandled mode %ld", &v6, 0xCu);
      }
    }

    return;
  }

  if (a4 != 4)
  {
    if (a4 == 6)
    {

      [(CAMViewfinderViewController *)self _setPortraitModeEffectFilterType:a3];
      return;
    }

    goto LABEL_13;
  }

  [(CAMViewfinderViewController *)self _setSquareModeEffectFilterType:a3];
}

- (int64_t)_lastCapturedFilterTypeForMode:(int64_t)a3
{
  v4 = +[CAMUserPreferences preferences];
  v5 = v4;
  if (a3 == 6)
  {
    v6 = [v4 portraitModeLastCapturedEffectFilterType];
  }

  else if (a3 == 4)
  {
    v6 = [v4 squareModeLastCapturedEffectFilterType];
  }

  else
  {
    if (a3)
    {
      v7 = 0;
      goto LABEL_9;
    }

    v6 = [v4 photoModeLastCapturedEffectFilterType];
  }

  v7 = v6;
LABEL_9:

  return v7;
}

- (BOOL)_shouldUseFiltersForGraphConfiguration:(id)a3
{
  v3 = [a3 mode];
  if (v3 > 6 || ((1 << v3) & 0x51) == 0)
  {
    return 0;
  }

  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isLiveFilteringSupported];

  return v5;
}

- (unint64_t)_previewConfigurationForMode:(int64_t)a3 devicePosition:(int64_t)a4 videoThumbnailOutputEnabled:(BOOL)a5
{
  v5 = a5;
  v7 = [(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay:a3];
  v8 = v7 | [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v9 = 5;
  if (!v5)
  {
    v9 = 1;
  }

  if (v8)
  {
    return 0;
  }

  else
  {
    return v9;
  }
}

- (id)_previewFiltersForMode:(int64_t)a3 device:(int64_t)a4 wantsPhotoModePortraitEffect:(BOOL)a5
{
  v5 = a5;
  v9 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:?];
  v10 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:a3 device:a4];
  v11 = a3 - 6;
  if (v5)
  {
    v12 = v10;
  }

  else
  {
    v12 = 0;
  }

  if (a3)
  {
    v13 = 0;
  }

  else
  {
    v13 = v5;
  }

  if (a3)
  {
    v12 = v10;
  }

  v14 = v11 < 2 || v13;
  if (v11 >= 2)
  {
    v15 = v12;
  }

  else
  {
    v15 = v10;
  }

  return [CAMEffectFilterManager filtersForFilterType:v9 lightingType:v15 applyDepthEffect:v14];
}

- (void)_updateCurrentPreviewFiltersOnCaptureController
{
  if (![(CAMViewfinderViewController *)self _isReconfiguring])
  {
    v4 = [(CAMViewfinderViewController *)self _previewFiltersForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice] wantsPhotoModePortraitEffect:[(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect]];
    v3 = [(CAMViewfinderViewController *)self _captureController];
    [v3 changeToPreviewFilters:v4 captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
  }
}

- (id)_currentCaptureFiltersForBurst:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v5 mode];
  v7 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", v6, [v5 device]);
  if (v6)
  {
    if (v6 == 7)
    {
      v9 = 0;
LABEL_9:
      v10 = 1;
      goto LABEL_13;
    }

    if (v6 == 6)
    {
      v8 = [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
LABEL_8:
      v9 = v8;
      goto LABEL_9;
    }

    v10 = 0;
  }

  else
  {
    if ([(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffectIsBurst:v3])
    {
      v8 = [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
      goto LABEL_8;
    }

    v10 = 0;
    v7 = 0;
  }

  v9 = 0;
LABEL_13:
  v11 = [CAMEffectFilterManager filtersForFilterType:v9 lightingType:v7 applyDepthEffect:v10];

  return v11;
}

- (id)_originalCaptureFiltersForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  if ([v7 isNaturalLightingAppliedToOriginal] && -[CAMViewfinderViewController _wantsLightingControlForMode:devicePosition:](self, "_wantsLightingControlForMode:devicePosition:", a3, a4))
  {
    v8 = [MEMORY[0x1E6993870] portraitOriginalPhotoFilters];
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_updateFilterScrubberForGraphConfiguration:(id)a3
{
  v9 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isLiveFilteringSupported];

  if (v5)
  {
    v6 = [v9 mode];
    v7 = +[CAMUserPreferences preferences];
    v8 = [v7 filterTypesForMode:v6];
    [(CAMViewfinderViewController *)self set_filterTypes:v8];
    [(CAMViewfinderViewController *)self _updateChromeFilterScrubberForGraphConfiguration:v9];
  }
}

- (void)_updateChromeFilterScrubberForGraphConfiguration:(id)a3
{
  v22 = a3;
  v4 = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = [v4 count];

  v6 = v22;
  if (v5 >= 1)
  {
    v7 = [v22 mode];
    v8 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v7];
    v9 = [(CAMViewfinderViewController *)self _lastCapturedFilterTypeForMode:v7];
    v10 = [CAMUserPreferences defaultFilterTypeForMode:v7];
    v11 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v5];
    for (i = 0; i != v5; ++i)
    {
      v13 = [CAMEffectFilterManager displayNameForType:[(CAMViewfinderViewController *)self _filterTypeForItemIndex:i]];
      [v11 addObject:v13];
    }

    v14 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v14 setFiltersItemCount:v5];

    v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v15 setFilterItemDisplayNames:v11];

    v16 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v10];
    v17 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v17 setFiltersDefaultIndex:v16];

    v18 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v8];
    v19 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v19 setFiltersSelectedIndex:v18];

    v20 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v9];
    v21 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v21 setFiltersMarkedIndex:v20];

    v6 = v22;
  }
}

- (void)_setWantsFilterScrubberVisible:(BOOL)a3 animated:(BOOL)a4
{
  if (self->__wantsFilterScrubberVisible != a3)
  {
    v5 = a4;
    v6 = a3;
    self->__wantsFilterScrubberVisible = a3;
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:a4];
    [(CAMViewfinderViewController *)self _setShouldShowFilterScrubberAfterNextRender:v6 & v5];
    if (![(CAMViewfinderViewController *)self _shouldShowFilterScrubberAfterNextRender])
    {
      [(CAMViewfinderViewController *)self _setShowingFilterScrubber:v6 animated:v5];
    }

    v8 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition] videoThumbnailOutputEnabled:v6];
    v9 = [(CAMViewfinderViewController *)self _captureController];
    [v9 changeToPreviewConfiguration:v8];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Filter scrubber desired visibility changed"];
  }
}

- (void)_setShowingFilterScrubber:(BOOL)a3 animated:(BOOL)a4
{
  if (self->__showingFilterScrubber == a3)
  {
    return;
  }

  v4 = a4;
  v5 = a3;
  v7 = [(CAMViewfinderViewController *)self _controlDrawer];

  if (!v7)
  {
    v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v9];
    if (v5)
    {
      v11 = v10;
      [(CAMViewfinderViewController *)self _createFilterNameBadgeIfNecessary];
      [(CAMViewfinderViewController *)self _updateControlsForVisibleFilterScrubberAnimated:v4];
      v12 = [(CAMViewfinderViewController *)self _utilityBar];
      v13 = v12;
      v14 = !v11 && [v12 visibleContent] != 0;
      [v13 setVisibleContent:1 animated:v4 & v14];
    }

    v15 = [(CAMViewfinderViewController *)self viewfinderView];
    v16 = v15;
    if (v4)
    {
      [v15 layoutIfNeeded];
    }

    goto LABEL_14;
  }

  v8 = [(CAMViewfinderViewController *)self _controlDrawer];
  v9 = v8;
  if (!v5)
  {
    [v8 collapseExpandableButtonsAnimated:v4 updatePreferredDrawerControl:0];
LABEL_14:

    goto LABEL_15;
  }

  [v8 expandControlForType:4 animated:v4 updatePreferredDrawerControl:0];

  [(CAMViewfinderViewController *)self _updateControlsForVisibleFilterScrubberAnimated:v4];
LABEL_15:
  self->__showingFilterScrubber = v5;
  v17 = [(CAMViewfinderViewController *)self _controlDrawer];

  if (!v17)
  {
    [(CAMViewfinderViewController *)self _layoutViewfinderForShowingFilterScrubber:v5 animated:v4];
  }

  [(CAMViewfinderViewController *)self _dismissOverlays];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Filter scrubber actual visibility changed"];
  if (v5)
  {
    [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0];
    [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0];
  }

  v18 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v18 setIsFilterThumbnailContentValid:v5];
}

- (void)_layoutViewfinderForShowingFilterScrubber:(BOOL)a3 animated:(BOOL)a4
{
  v4 = a4;
  v8 = [(CAMViewfinderViewController *)self viewfinderView];
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v8 setNeedsLayout];
  if (v4)
  {
    if (!a3)
    {
      [(CAMViewfinderViewController *)self _setAnimatingFilterScrubberDismissal:1];
    }

    v10 = MEMORY[0x1E69DD250];
    v16[0] = MEMORY[0x1E69E9820];
    v16[1] = 3221225472;
    v16[2] = __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke;
    v16[3] = &unk_1E76F77B0;
    v17 = v8;
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke_2;
    v14[3] = &unk_1E76F9B00;
    v15 = a3;
    v14[4] = self;
    v14[5] = a2;
    [v10 animateWithDuration:6 delay:v16 options:v14 animations:0.25 completion:0.0];

    [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v9] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
    [(CAMViewfinderViewController *)self _setView:self->__filterNameBadge hidden:[(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:v9] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
    v11 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:v9];
    v12 = [(CAMViewfinderViewController *)self viewfinderView];
    v13 = [v12 zoomControl];
    [(CAMViewfinderViewController *)self _setView:v13 hidden:v11 delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
  }
}

void __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke_2(uint64_t a1)
{
  if ((*(a1 + 48) & 1) == 0)
  {
    [*(a1 + 32) _setAnimatingFilterScrubberDismissal:0];
    v3 = *(a1 + 32);
    v4 = NSStringFromSelector(*(a1 + 40));
    [v3 _clearFilterScrubberLayerContentsIfNotNeededFromCallsite:v4];
  }
}

- (void)_updateControlsForVisibleFilterScrubberAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isLiveFilteringSupported];

  if (v6)
  {
    v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:v8];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:v3];
    v7 = [(CAMViewfinderViewController *)self _zoomSlider];
    [v7 makeInvisibleAnimated:v3];

    [(CAMViewfinderViewController *)self _resetPortraitLightingToDefaultAnimated:v3];
  }
}

- (void)_resetPortraitLightingToDefaultAnimated:(BOOL)a3
{
  v3 = a3;
  v18 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isLightingControlSupportedForMode:{objc_msgSend(v18, "mode")}];

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _targetLightingControl];
    [v7 setSelectedLightingType:{objc_msgSend(v7, "defaultLightingType")}];
    v8 = [v7 defaultLightingType];
    v9 = [(CAMViewfinderViewController *)self _lightingNameBadge];
    [v9 setLightingType:v8];

    v10 = [v7 defaultLightingType];
    v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v12 = [v11 lightingNameBadge];
    [v12 setLightingType:v10];

    v13 = [v7 defaultLightingType];
    v14 = [(CAMViewfinderViewController *)self _previewViewController];
    [v14 setLightingType:v13];

    v15 = [v18 mode];
    v16 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", v15, [v18 device]);
    v17 = [CAMUserPreferences defaultLightingTypeForMode:v15];
    if (v16 != v17)
    {
      [(CAMViewfinderViewController *)self _setLightingType:v17 forMode:v15];
      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
      [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:v3];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v18 animated:v3];
    }

    [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  }
}

- (void)_hideUtilityBarAnimated:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0 animated:a3];
  [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0 animated:v3];

  [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0 animated:v3];
}

- (void)_updateFilterNameBadgeAnimated:(BOOL)a3
{
  v4 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:[(CAMViewfinderViewController *)self _currentMode]];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (v5)
  {
    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v6 = [v7 filterNameBadge];
    [v6 setFilterType:v4];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _filterNameBadge];
    [v7 setFilterType:v4];
  }
}

- (void)_dismissOverlays
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:?])
  {
    v3 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:v4];
    [(CAMViewfinderViewController *)self _dismissDescriptionOverlayView:v3 withDuration:0 fromUserAction:0.5];
  }
}

- (BOOL)_isDepthEffectApertureSupportedForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v12 = 0;
  if ([v5 isDepthEffectApertureSupportedForMode:objc_msgSend(v4 devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(v4, "devicePosition"), objc_msgSend(v4, "enableDepthSuggestion")}])
  {
    v6 = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v5 isDepthEffectApertureSupportedForPhotoFormat:v6, v7])
    {
      v8 = [v4 mode];
      v9 = [v4 devicePosition];
      v10 = [(CAMViewfinderViewController *)self currentPhotoFormat];
      if (![v5 isDepthSuggestionSupportedForMode:v8 devicePosition:v9 photoFormat:v10, v11] || -[CAMViewfinderViewController _depthEffectEnabledFromSuggestion](self, "_depthEffectEnabledFromSuggestion"))
      {
        v12 = 1;
      }
    }
  }

  return v12;
}

- (void)_resetPortraitModeApertureValueIfNeededForGraphConfiguration:(id)a3 zoomFactor:(double)a4
{
  v11 = a3;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v11 mode];
  if ([v6 isDepthEffectApertureSupportedForMode:v7 devicePosition:objc_msgSend(v11 depthSuggestionEnabled:{"devicePosition"), objc_msgSend(v11, "enableDepthSuggestion")}])
  {
    v8 = [v11 device];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    if (v9 <= 0.0)
    {
      v10 = +[CAMCaptureCapabilities capabilities];
      [v10 defaultDepthEffectApertureForMode:v7 device:v8 zoomFactor:a4];
      [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:?];
    }
  }
}

- (void)_setShowingPortraitApertureSlider:(BOOL)a3 animated:(BOOL)a4
{
  if (self->__showingPortraitApertureSlider != a3)
  {
    v4 = a4;
    v5 = a3;
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v7];
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createPortraitApertureSliderIfNecessary];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v7 zoomFactor:?];
      v9 = [(CAMViewfinderViewController *)self _utilityBar];
      v10 = v9;
      v11 = !v8 && [v9 visibleContent] != 0;
      [v10 setVisibleContent:2 animated:v4 & v11];
    }

    v12 = [(CAMViewfinderViewController *)self viewfinderView];
    v13 = v12;
    if (v4)
    {
      [v12 layoutIfNeeded];
      self->__showingPortraitApertureSlider = v5;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v7 zoomFactor:1 animated:?];
      [v13 setNeedsLayout];
      v14 = MEMORY[0x1E69DD250];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __74__CAMViewfinderViewController__setShowingPortraitApertureSlider_animated___block_invoke;
      v15[3] = &unk_1E76F77B0;
      v16 = v13;
      [v14 animateWithDuration:6 delay:v15 options:0 animations:0.25 completion:0.0];

      if (v8)
      {
        [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v7] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
      }
    }

    else
    {
      self->__showingPortraitApertureSlider = v5;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v7 zoomFactor:0 animated:?];
      [v13 setNeedsLayout];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Portrait depth slider visibility changed"];
    if (v5)
    {
      [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0];
      [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0];
    }
  }
}

- (void)_updatePortraitApertureSliderForGraphConfiguration:(id)a3 zoomFactor:(double)a4
{
  v5 = a3;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [(CAMViewfinderViewController *)self _portraitApertureSlider];
  if (v7)
  {
    v8 = v7;
    goto LABEL_6;
  }

  v9 = [(CAMViewfinderViewController *)self _controlDrawer];
  v8 = [v9 apertureSlider];

  if (v8)
  {
LABEL_6:
    v11 = [v5 device];
    v12 = [v5 mode];
    [v6 minimumDepthEffectApertureForMode:v12 device:v11];
    v14 = v13;
    [v6 maximumDepthEffectApertureForMode:v12 device:v11];
    v16 = v15;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v18 = v17;
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke;
    aBlock[3] = &unk_1E76F9B28;
    aBlock[5] = v14;
    aBlock[6] = v16;
    aBlock[4] = self;
    aBlock[7] = v17;
    v19 = _Block_copy(aBlock);
    v19[2](v19, v8);
    v20 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v21 = [v20 spotlightControlPanel];
    v22 = [v21 apertureSlider];
    v19[2](v19, v22);

    v23 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v38[0] = MEMORY[0x1E69E9820];
    v38[1] = 3221225472;
    v38[2] = __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke_2;
    v38[3] = &unk_1E76F9B50;
    v38[4] = self;
    v38[5] = v14;
    v38[6] = v16;
    v38[7] = v18;
    [v23 performChanges:v38];

    [v8 apertureValue];
    v25 = v24;
    v26 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v27 = [v26 viewportAspectRatio];

    if ((v27 - 2) < 5)
    {
LABEL_7:
      v28 = +[CAMCaptureCapabilities capabilities];
      if ([v28 isCinematicModeSupported])
      {
        LODWORD(v27) = 1;
      }

      else
      {
        v29 = +[CAMCaptureCapabilities capabilities];
        LODWORD(v27) = [v29 photoModeDepthSuggestionSupported];
      }

      goto LABEL_14;
    }

    if (v27 != 1)
    {
      if (!v27)
      {
        goto LABEL_7;
      }

      LODWORD(v27) = 0;
    }

LABEL_14:
    v30 = [(CAMViewfinderViewController *)self _layoutStyle];
    if ((v30 - 2) < 2)
    {
      goto LABEL_17;
    }

    if (v30 == 1)
    {
      [v8 removeGradients];
      v32 = 1;
      v31 = 1;
      goto LABEL_22;
    }

    if (!v30)
    {
LABEL_17:
      if (v27)
      {
        [v8 setTransparentGradients];
        v31 = 0;
        v32 = 1;
LABEL_22:
        [v8 setUseTickMarkLegibilityShadows:v32];
        [v8 setUseTextLegibilityBackgrounds:v31];
        v34 = [(CAMViewfinderViewController *)self _apertureButton];
        [v34 setApertureValue:v25];
        v35 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v36 = [v35 controlStatusBar];
        v37 = [v36 apertureIndicator];
        [v37 setApertureValue:v25];

        goto LABEL_23;
      }

      v33 = [MEMORY[0x1E69DC888] blackColor];
      [v8 setOpaqueGradientsWithColor:v33];
    }

    v32 = 0;
    v31 = 0;
    goto LABEL_22;
  }

  v10 = [(CAMViewfinderViewController *)self chromeViewController];

  if (v10)
  {
    v8 = 0;
    goto LABEL_6;
  }

LABEL_23:
}

void __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke(uint64_t a1, void *a2)
{
  v3 = *(a1 + 40);
  v4 = *(a1 + 48);
  v5 = a2;
  [v5 setMinimumApertureValueClosestTo:v3 maximumApertureValueClosestTo:v4];
  [*(a1 + 32) _portraitModeApertureValue];
  [v5 setApertureValueClosestTo:?];
  [v5 setMarkedApertureValueClosestTo:*(a1 + 56)];
}

void __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke_2(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setApertureValueMinimum:v2];

  v4 = *(a1 + 48);
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setApertureValueMaximum:v4];

  v6 = *(a1 + 56);
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setApertureValueMarked:v6];

  [*(a1 + 32) _portraitModeApertureValue];
  v9 = v8;
  v10 = [*(a1 + 32) chromeConfigurator];
  [v10 setApertureValue:v9];
}

- (void)_updatePortraitApertureButtonForGraphConfiguration:(id)a3 zoomFactor:(double)a4 animated:(BOOL)a5
{
  v5 = a5;
  v7 = a3;
  v34 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 mode];
  v9 = [v7 device];
  v10 = [v7 devicePosition];
  v11 = [v7 enableDepthSuggestion];

  v12 = [v34 isDepthEffectApertureSupportedForMode:v8 devicePosition:v10 depthSuggestionEnabled:v11];
  v13 = v34;
  if (v12)
  {
    [v34 minimumDepthEffectApertureForMode:v8 device:v9];
    v15 = v14;
    [v34 maximumDepthEffectApertureForMode:v8 device:v9];
    v17 = v16;
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v19 = v18;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v21 = v20;
    if (v17 >= v19)
    {
      v22 = v19;
    }

    else
    {
      v22 = v17;
    }

    if (v15 < v22)
    {
      v15 = v22;
    }

    v23 = [(CAMViewfinderViewController *)self _apertureButton];
    v24 = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider];
    v25 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v26 = [v25 controlDrawer];
    if (v24)
    {
      v27 = 1;
    }

    else
    {
      v27 = [v25 isApertureSliderVisible];
    }

    if (vabdd_f64(v21, v15) >= 0.0001)
    {
      v28 = v27 ^ 1;
    }

    else
    {
      v28 = 0;
    }

    [v23 setActive:v27 animated:v5];
    [v23 setShouldShowApertureValue:v28 animated:v5];
    [v23 setApertureValue:v15];
    v29 = [v25 controlStatusBar];
    v30 = [v29 apertureIndicator];

    [v30 setApertureValue:v15];
    [v30 setShowingValue:v28 animated:v5];
    v31 = [v26 apertureButton];
    [v31 setOn:v28];

    v32 = [v25 controlStatusBar];
    v33 = [v32 apertureIndicator];
    [v33 setOn:v27];

    v13 = v34;
  }

  MEMORY[0x1EEE66BB8](v12, v13);
}

- (void)_apertureSliderDidChangeApertureValue:(id)a3
{
  [a3 apertureValue];

  [(CAMViewfinderViewController *)self handleUserChangedToApertureValue:?];
}

- (void)handleUserChangedToApertureValue:(double)a3 enableDepthSuggestion:(BOOL)a4
{
  v4 = a4;
  [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:?];
  v7 = [(CAMViewfinderViewController *)self _captureController];
  [v7 changeToPortraitAperture:a3];

  v18 = [(CAMViewfinderViewController *)self _apertureButton];
  [v18 setApertureValue:a3];
  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 controlStatusBar];
  v10 = [v9 apertureIndicator];
  [v10 setApertureValue:a3];

  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v11 animated:1];

  v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:v12 zoomFactor:?];

  v13 = +[CAMCaptureCapabilities capabilities];
  v14 = [(CAMViewfinderViewController *)self _currentMode];
  v15 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v16 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(v14) = [v13 isDepthSuggestionSupportedForMode:v14 devicePosition:v15 photoFormat:v16, v17];

  if (v14 && v4)
  {
    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:1];
  }
}

- (void)_handleApertureButtonTapped:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider]^ 1;

  [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:v4 animated:1];
}

- (void)_handleIntensityButtonTapped:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _isShowingPortraitIntensitySlider]^ 1;

  [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:v4 animated:1];
}

- (void)_setShowingPortraitIntensitySlider:(BOOL)a3 animated:(BOOL)a4
{
  if (self->__showingPortraitIntensitySlider != a3)
  {
    v4 = a4;
    v5 = a3;
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v7];
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createPortraitIntensitySliderIfNecessary];
      [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
      v9 = [(CAMViewfinderViewController *)self _utilityBar];
      v10 = v9;
      v11 = !v8 && [v9 visibleContent] != 0;
      [v10 setVisibleContent:3 animated:v4 & v11];
    }

    v12 = [(CAMViewfinderViewController *)self viewfinderView];
    v13 = v12;
    if (v4)
    {
      [v12 layoutIfNeeded];
      self->__showingPortraitIntensitySlider = v5;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      [v13 setNeedsLayout];
      v14 = MEMORY[0x1E69DD250];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __75__CAMViewfinderViewController__setShowingPortraitIntensitySlider_animated___block_invoke;
      v15[3] = &unk_1E76F77B0;
      v16 = v13;
      [v14 animateWithDuration:6 delay:v15 options:0 animations:0.25 completion:0.0];

      if (v8)
      {
        [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:v7] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
      }
    }

    else
    {
      self->__showingPortraitIntensitySlider = v5;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      [v13 setNeedsLayout];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Portrait intensity slider visibility changed"];
    if (v5)
    {
      [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0];
      [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0 animated:v4];
    }
  }
}

- (void)_updatePortraitIntensitySliderForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _controlDrawer];
  v4 = [v3 intensitySlider];
  v5 = v4;
  if (v4)
  {
    v6 = v4;
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
  }

  v11 = v6;

  v7 = +[CAMCaptureCapabilities capabilities];
  [v7 minimumPortraitEffectIntensity];
  [v11 setMinimumValue:?];
  [v7 defaultPortraitEffectIntensity];
  [v11 setDefaultValue:?];
  [v7 maximumPortraitEffectIntensity];
  [v11 setMaximumValue:?];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [v11 setValue:?];
  v8 = [MEMORY[0x1E69DC888] clearColor];
  [v11 setBackgroundColor:v8];

  v9 = [(CAMViewfinderViewController *)self _intensityButton];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [v9 setIntensityValue:?];
  v10 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [v10 setPortraitEffectIntensity:?];
}

- (void)_handleIntensitySliderDidChangeValue:(id)a3
{
  v9 = a3;
  v4 = [(CAMViewfinderViewController *)self _controlDrawer];
  v5 = [v4 intensitySlider];
  v6 = v5;
  if (v5)
  {
    v7 = v5;
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
  }

  v8 = v7;

  if (v8 == v9)
  {
    [v9 value];
    [(CAMViewfinderViewController *)self handleUserChangedPortraitIntensity:?];
  }
}

- (void)_updateIntensityButtonForCurrentState
{
  [(CAMViewfinderViewController *)self _updateTopBarForLightingType:[(CAMViewfinderViewController *)self portraitModeLightingEffectType]];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  v4 = v3;
  v5 = [(CAMViewfinderViewController *)self _intensityButton];
  [v5 setIntensityValue:v4];

  v6 = [(CAMViewfinderViewController *)self _intensityButton];
  [v6 setActive:-[CAMViewfinderViewController _isShowingPortraitIntensitySlider](self animated:{"_isShowingPortraitIntensitySlider"), 1}];

  v16 = [(CAMViewfinderViewController *)self _controlDrawer];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 isIntensitySliderVisible];

  v9 = +[CAMCaptureCapabilities capabilities];
  [v9 defaultPortraitEffectIntensity];
  v11 = vabdd_f64(v4, v10) > 0.005;

  v12 = [v16 intensityButton];
  [v12 setOn:v11 & (v8 ^ 1)];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v14 = [v13 controlStatusBar];
  v15 = [v14 intensityIndicator];
  [v15 setOn:v8];
}

- (void)handleUserChangedPortraitIntensity:(double)a3
{
  v7 = [(CAMViewfinderViewController *)self _intensityButton];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 changeToPortraitLightingEffectStrength:a3];

  [v7 setIntensityValue:a3];
  [(CAMViewfinderViewController *)self _setPortraitModeIntensityValue:a3];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v6 setPortraitEffectIntensity:a3];
}

- (double)_exposureBiasForMode:(int64_t)a3 trueVideoEnabled:(BOOL)a4
{
  v4 = a3;
  if (a4 && [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode]== a3)
  {
    v4 = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
  }

  v6 = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:v4];
  v8 = [v6 objectForKeyedSubscript:v7];
  [v8 floatValue];
  v10 = v9;

  return v10;
}

- (void)_setExposureBias:(double)a3 forMode:(int64_t)a4
{
  v8 = [MEMORY[0x1E696AD98] numberWithDouble:a3];
  v6 = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
  [v6 setObject:v8 forKeyedSubscript:v7];
}

- (void)_updateExposureSliderForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _controlDrawer];
  v18 = [v3 exposureSlider];

  v4 = [(CAMViewfinderViewController *)self _currentMode];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", v4, [v5 trueVideoEnabled]);
  v7 = v6;

  [v18 setExposureValueClosestTo:v7];
  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 spotlightControlPanel];
  v10 = [v9 exposureSlider];
  [v10 setExposureValueClosestTo:v7];

  v11 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v11 setExposureBias:v7];

  v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v13 = [v12 viewportAspectRatio];

  v15 = v13 == 4 || v13 == 1;
  [v18 setUseTextLegibilityShadows:v15];
  v16 = [(CAMViewfinderViewController *)self _previewViewController];
  *&v17 = v7;
  [v16 setBaselineExposureBias:v17];
}

- (void)_handleExposureSliderDidChangeValue:(id)a3
{
  [a3 exposureValue];

  [(CAMViewfinderViewController *)self handleUserChangedExposureSliderBias:?];
}

- (void)handleUserChangedLensPosition:(double)a3
{
  [(CAMViewfinderViewController *)self _updateLensPositionLockedByUser:1];
  v6 = [(CAMViewfinderViewController *)self _captureController];
  *&v5 = a3;
  [v6 lockFocusAtLensPosition:0 completionBlock:v5];
}

- (void)handleUserChangedIsLensPositionLocked:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self _updateLensPositionLockedByUser:?];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  if (v3)
  {
    +[CUCaptureController focusLensPositionCurrentSentinel];
    [v5 lockFocusAtLensPosition:0 completionBlock:?];
  }

  else
  {
    [v5 resetFocusAndExposure];
  }
}

- (void)_updateLensPositionLockedByUser:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v6 = [v5 isLensPositionLockedByUser];

  if (v6 != v3)
  {
    v7 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v7 setIsLensPositionLockedByUser:v3];

    if (v3)
    {
      v8 = 2;
    }

    else
    {
      v8 = 0;
    }

    v9 = [(CAMViewfinderViewController *)self _captureController];
    [v9 setPrimaryConstituentDeviceSwitchingBehavior:v8];
  }
}

- (void)_handleUserChangedToExposureSliderBias:(double)a3 updateSystemOverlayValues:(BOOL)a4
{
  +[CAMExposureSlider minimumValue];
  v7 = v6;
  +[CAMExposureSlider maximumValue];
  v9 = fmin(fmax(v7, a3), v8);
  [(CAMViewfinderViewController *)self _setExposureBias:[(CAMViewfinderViewController *)self _currentMode] forMode:v9];
  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:v10 animated:1];

  v11 = [(CAMViewfinderViewController *)self _previewViewController];
  *&v7 = v9;
  LODWORD(v12) = LODWORD(v7);
  [v11 setBaselineExposureBias:v12];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v14 = [v13 controlStatusBar];
  v15 = [v14 exposureBiasIndicator];

  [v15 setExposureBiasValue:v9];
  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_updateExposureButtonForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", v3, [v4 trueVideoEnabled]);
  v6 = v5;

  v7 = +[CAMUserPreferences preferences];
  LOBYTE(v3) = [v7 preserveExposure];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 isExposureSliderVisible];

  LODWORD(v8) = [(CAMViewfinderViewController *)self _isExposureBiasNonDefault:v6];
  v10 = v9 ^ 1;
  v11 = [(CAMViewfinderViewController *)self _controlDrawer];
  v12 = [v11 exposureButton];
  [v12 setOn:v8 & v10];

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v14 = [v13 controlStatusBar];
  v15 = [v14 exposureBiasIndicator];

  [v15 setExposureBiasValue:v6];
  [v15 setExposureValueVisible:(v3 | v8) & v10 & 1];
  [(CAMViewfinderViewController *)self _shadowClippingValue];
  [v15 setShadowClipping:?];
  [(CAMViewfinderViewController *)self _highlightClippingValue];
  [v15 setHighlightClipping:?];
}

- (unint64_t)_currentSemanticStyleSupport
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 smartStylesSupported];
  v5 = [v3 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  if (v4)
  {
    if ([(CAMViewfinderViewController *)self _wantsLightingControlForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]&& [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]]!= 1)
    {
      v5 &= 0xFFFFFFFFFFFFFFF8;
    }

    v6 = -16;
  }

  else
  {
    v6 = -15;
  }

  if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== 1)
  {
    v7 = v6;
  }

  else
  {
    v7 = -1;
  }

  v8 = v7 & v5;
  v9 = [(CAMViewfinderViewController *)self _captureController];
  v10 = [v9 isCapturingBurst];

  if (v10)
  {
    v11 = v8 & 0xFFFFFFFFFFFFFFF8;
  }

  else
  {
    v11 = v8;
  }

  v12 = [(CAMViewfinderViewController *)self _captureController];
  v13 = [v12 isCapturingCTMVideo];

  if (v13)
  {
    v14 = v11 & 0xFFFFFFFFFFFFFFFDLL;
  }

  else
  {
    v14 = v11;
  }

  return v14;
}

- (id)_semanticStyleForPreview
{
  v3 = [(CAMViewfinderViewController *)self _currentSemanticStyleSupport];

  return [(CAMViewfinderViewController *)self _semanticStyleForPreviewWithSupport:v3];
}

- (id)_semanticStyleForPreviewWithSupport:(unint64_t)a3
{
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _semanticStyles];
  v7 = [v5 captureStyleForPreviewWithSupport:a3 styles:v6 selectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self smartStyleSystemStyleIndex:{"_selectedSemanticStyleIndex"), -[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];

  return v7;
}

- (id)_semanticStyleForCapture
{
  v3 = [(CAMViewfinderViewController *)self _currentSemanticStyleSupport];

  return [(CAMViewfinderViewController *)self _semanticStyleForCaptureWithSupport:v3];
}

- (id)_semanticStyleForCaptureWithSupport:(unint64_t)a3
{
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _semanticStyles];
  v7 = [v5 captureStyleForCaptureWithSupport:a3 styles:v6 selectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self smartStyleSystemStyleIndex:{"_selectedSemanticStyleIndex"), -[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];

  return v7;
}

- (void)_updateSemanticStyleControlsForCurrentStateAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 smartStylesSupported];

  if ((v6 & 1) == 0)
  {
    v23 = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
    v7 = [(CAMViewfinderViewController *)self _controlDrawer];
    v8 = [v7 semanticStyleControl];
    [v8 setSemanticStyle:v23 animated:v3];

    v9 = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v11 = [v10 semanticStylePicker];
    [v11 setSelectedStyleIndex:v9];

    v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [v12 isSemanticStyleControlVisible];

    if (v23)
    {
      v14 = [v23 isNeutral] ^ 1;
    }

    else
    {
      v14 = 0;
    }

    v15 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v16 = [v15 controlStatusBar];
    v17 = [v16 semanticStyleIndicator];
    [v17 setSemanticStyle:v23 animated:v3];

    v18 = [v7 semanticStyleButton];
    [v18 setSemanticStyle:v23 animated:v3];

    v19 = [v7 semanticStyleButton];
    [v19 setOn:v14 & (v13 ^ 1u)];

    v20 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v20 setSemanticStylePreset:{objc_msgSend(v23, "presetType")}];

    v21 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v23 sceneBias];
    [v21 setSemanticStyleSceneBias:?];

    v22 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v23 warmthBias];
    [v22 setSemanticStyleWarmthBias:?];
  }
}

- (NSArray)_smartStyles
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 smartStylesSupported];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _semanticStyles];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (id)_currentSmartStyle
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 smartStylesSupported];

  if (v4)
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    v6 = [v5 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    v7 = [(CAMViewfinderViewController *)self _semanticStyleForCaptureWithSupport:v6];
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)_updateSmartStyleControlsForCurrentStateAnimateSliders:(BOOL)a3 animateOtherControls:(BOOL)a4
{
  v4 = a4;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 9) != 0)
  {
    HIDWORD(v38) = v4;
    v8 = [(CAMViewfinderViewController *)self _currentSmartStyle];
    v9 = [(CAMViewfinderViewController *)self _referenceStyleForSmartStyle:v8];
    v41 = [v8 isEqualToSmartStyle:v9] ^ 1;
    v10 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]];
    v11 = +[CAMCaptureCapabilities capabilities];
    LODWORD(v38) = [v11 smartStylesSupportedForLightingType:v10] ^ 1;

    v40 = [(CAMViewfinderViewController *)self _controlDrawer];
    v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [v12 smartStyleNameBadge];
    [v13 setSmartStyle:v8];

    [CAMSmartStyleUtilities slider2DValueForStyle:v8 limitRangeForSystemStyles:0];
    v15 = v14;
    v17 = v16;
    v42 = v9;
    [CAMSmartStyleUtilities slider2DValueForStyle:v9 limitRangeForSystemStyles:0];
    v19 = v18;
    v21 = v20;
    v22 = [v12 smartStylePicker];
    v23 = [(CAMViewfinderViewController *)self _semanticStyles];
    [v22 setNumberOfStyles:{objc_msgSend(v23, "count")}];

    [v22 setSelectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self animated:{"_selectedSemanticStyleIndex"), 0}];
    if ([v22 numberOfStyles])
    {
      v24 = 0;
      do
      {
        if (v24 == [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex])
        {
          v25 = [MEMORY[0x1E69DCAB8] systemImageNamed:@"dot.square.fill"];
        }

        else
        {
          v25 = 0;
        }

        v26 = [v22 pageControl];
        [v26 setIndicatorImage:v25 forPage:v24];

        ++v24;
      }

      while (v24 < [v22 numberOfStyles]);
    }

    v27 = HIDWORD(v38);
    [v12 setWantsSmartStylePicker:(v7 >> 3) & 1 animated:{HIDWORD(v38), v38}];
    v28 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v29 = [v28 smartStyleControlsVisible];

    if (v8)
    {
      v30 = [v8 isNeutral] ^ 1;
    }

    else
    {
      v30 = 0;
    }

    v31 = [v40 smartStyleButton];
    [v31 setSmartStyle:v8 animated:v27];

    v32 = [v40 smartStyleButton];
    [v32 setShowDisabled:v39 animated:v27];

    v33 = [v40 smartStyleButton];
    [v33 setOn:v30 & (v29 ^ 1u)];

    v34 = [v8 presetType];
    v35 = [v12 smartStyleCategoryInstructionLabel];
    [v35 setPresetType:v34];

    v36 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v43[0] = MEMORY[0x1E69E9820];
    v43[1] = 3221225472;
    v43[2] = __107__CAMViewfinderViewController__updateSmartStyleControlsForCurrentStateAnimateSliders_animateOtherControls___block_invoke;
    v43[3] = &unk_1E76F9B78;
    v45 = v15;
    v46 = v17;
    v47 = v19;
    v48 = v21;
    v43[4] = self;
    v44 = v8;
    v49 = v41;
    v50 = v39;
    v37 = v8;
    [v36 performChanges:v43];
  }
}

void __107__CAMViewfinderViewController__updateSmartStyleControlsForCurrentStateAnimateSliders_animateOtherControls___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 48);
  v3 = *(a1 + 56);
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setSmartStyleDPadValue:{v2, v3}];

  v5 = *(a1 + 64);
  v6 = *(a1 + 72);
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setSmartStyleDPadDefaultValue:{v5, v6}];

  v8 = [*(a1 + 40) castType];
  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setSmartStyleCastType:v8];

  v10 = [*(a1 + 40) presetType];
  v11 = [*(a1 + 32) chromeConfigurator];
  [v11 setSmartStylePresetType:v10];

  [*(a1 + 40) castIntensity];
  v13 = v12;
  v14 = [*(a1 + 32) chromeConfigurator];
  [v14 setSmartStyleCastIntensity:v13];

  v15 = *(a1 + 80);
  v16 = [*(a1 + 32) chromeConfigurator];
  [v16 setIsSmartStyleCustomized:v15];

  v17 = *(a1 + 81);
  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setIsSmartStyleDisabled:v17];

  v19 = [*(a1 + 40) castType];
  v23 = +[CAMUserPreferences preferences];
  v20 = [v23 lastReadSystemStyle];
  v21 = v19 == [v20 castType];
  v22 = [*(a1 + 32) chromeConfigurator];
  [v22 setSmartStyleIsUsersSystemStyle:v21];
}

- (id)_referenceStyleForSmartStyle:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _semanticStyles];
  v6 = [v5 indexOfObject:v4];

  if (v6 == 0x7FFFFFFFFFFFFFFFLL || v6 != [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex])
  {
    v8 = [objc_alloc(MEMORY[0x1E6993890]) initWithPresetType:{objc_msgSend(v4, "presetType")}];
  }

  else
  {
    v7 = +[CAMUserPreferences preferences];
    v8 = [v7 lastReadSystemStyle];
  }

  return v8;
}

- (void)_handleSemanticStyleControlDidChangeValue:(id)a3
{
  v4 = [a3 semanticStyle];
  [(CAMViewfinderViewController *)self _handleUserChangedSemanticStyle:v4];
}

- (void)_handleUserChangedSemanticStyle:(id)a3
{
  v8 = a3;
  v4 = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _semanticStyles];
    [v5 replaceObjectAtIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self withObject:{"_selectedSemanticStyleIndex"), v8}];
  }

  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v6 reloadSemanticStyleBadgesDelayIfNeeded:1];

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v7 requestPreviewUpdateForSemanticStyleAnimated:0];
}

- (void)_updatePreviewSemanticStyleAnimated:(BOOL)a3
{
  v3 = a3;
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v4 requestPreviewUpdateForSemanticStyleAnimated:v3];
}

- (void)_updateSmartStyleOnSession
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 smartStylesSupported] && !-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") && !-[CAMViewfinderViewController _hasInFlightConfiguration](self, "_hasInFlightConfiguration") && -[CAMViewfinderViewController _completedInitialConfiguration](self, "_completedInitialConfiguration"))
  {
    v3 = [(CAMViewfinderViewController *)self _semanticStyleForPreview];
    v4 = [(CAMViewfinderViewController *)self _captureController];
    [v4 changeToSmartStyle:v3];
  }
}

- (void)_handleSmartStylePickerSwipe:(id)a3
{
  v12 = a3;
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v5 = [v4 smartStylePicker];

  v6 = [v5 effectiveUserInterfaceLayoutDirection];
  v7 = [v5 selectedStyleIndex];
  if ([v12 direction] == 1)
  {
    if (v6 == 1)
    {
      v8 = 1;
    }

    else
    {
      v8 = -1;
    }

    v9 = v8 + v7;
    if (v8 + v7 < 0)
    {
      goto LABEL_15;
    }

    goto LABEL_13;
  }

  v10 = [v12 direction];
  v11 = v7 - 1;
  if (v6 != 1)
  {
    v11 = v7 + 1;
  }

  if (v10 == 2)
  {
    v9 = v11;
  }

  else
  {
    v9 = v7;
  }

  if ((v9 & 0x8000000000000000) == 0)
  {
LABEL_13:
    if (v9 < [v5 numberOfStyles])
    {
      [v5 setSelectedStyleIndex:v9 animated:1];
      [(CAMViewfinderViewController *)self _updateSelectedSmartStyleFromPicker];
    }
  }

LABEL_15:
}

- (id)_targetLightingControl
{
  v3 = [(CAMViewfinderViewController *)self _lightingControl];
  if (!v3)
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v3 = [v4 lightingControl];
  }

  return v3;
}

- (void)_updateLightingUIForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v17 = a3;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v17 device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  v9 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [v17 mode], objc_msgSend(v17, "device"));
  if ([v6 isLightingControlSupportedForMode:{objc_msgSend(v17, "mode")}])
  {
    v10 = [(CAMViewfinderViewController *)self _previewViewController];
    [v10 setLightingType:v9];
  }

  if ([(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v17])
  {
    v11 = [(CAMViewfinderViewController *)self _lightingNameBadge];
    v12 = [(CAMViewfinderViewController *)self _targetLightingControl];
    v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v14 = v13;
    if (!v11)
    {
      v11 = [v13 lightingNameBadge];
    }

    if (v9)
    {
      [v11 setLightingType:v9];
    }

    [v12 setLightingEffectSet:objc_msgSend(v6 animated:{"supportedEffectSetForDevicePosition:", v8), v4}];
    [v12 setSelectedLightingType:v9 animated:v4];
    v15 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:v17];
    if (v15 == 2)
    {
      v16 = 2;
    }

    else
    {
      v16 = v15 == 1;
    }

    [v12 setCollapsedSelectionCenterPointEdgeInset:44.0];
    [v12 setCollapsedControlLocation:v16 animated:v4];
  }
}

- (int64_t)_sanitizedLightingTypeForMode:(int64_t)a3 device:(int64_t)a4
{
  if ((a4 - 1) > 0xA)
  {
    v6 = 0;
  }

  else
  {
    v6 = qword_1A3A685B0[a4 - 1];
  }

  v7 = +[CAMCaptureCapabilities capabilities];
  if ([(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]]&& [(CAMViewfinderViewController *)self _wantsLightingControlForMode:a3 devicePosition:v6])
  {
    v8 = [(CAMViewfinderViewController *)self portraitModeLightingEffectType];
    v9 = [v7 supportedEffectSetForDevicePosition:v6];
    if (v9 > 3)
    {
      v10 = 0;
    }

    else
    {
      v10 = qword_1E76FA000[v9];
    }

    v12 = [MEMORY[0x1E696AD98] numberWithInteger:v8];
    v13 = [v10 containsObject:v12];

    if ((v13 & 1) == 0)
    {
      v8 = [CAMUserPreferences defaultLightingTypeForMode:a3];
    }
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_setLightingType:(int64_t)a3 forMode:(int64_t)a4
{
  v12 = *MEMORY[0x1E69E9840];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isLightingControlSupportedForMode:a4];

  if (v8)
  {
    [(CAMViewfinderViewController *)self setPortraitModeLightingEffectType:a3];
  }

  else if (a3)
  {
    v9 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = 134217984;
      v11 = a4;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Trying to set filter type on unhandled mode %ld", &v10, 0xCu);
    }
  }

  [(CAMViewfinderViewController *)self _updateTopBarForLightingType:a3];
}

- (void)_updateTopBarForLightingType:(int64_t)a3
{
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isPortraitEffectIntensitySupportedForLightingType:a3];

  v7 = [(CAMViewfinderViewController *)self _topBar];
  v8 = v7;
  if (v6)
  {
    v9 = [(CAMViewfinderViewController *)self _intensityButton];

    [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
    v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v11 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:v10];

    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __60__CAMViewfinderViewController__updateTopBarForLightingType___block_invoke;
    v18[3] = &unk_1E76F7850;
    v18[4] = self;
    v19 = v11;
    [MEMORY[0x1E69DD250] animateWithDuration:v18 animations:0.25];
    v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v12 setIsPortraitEffectIntensitySliderSupported:!v11];

    v13 = [(CAMViewfinderViewController *)self _intensityButton];
    if (v9)
    {
      v14 = [v8 intensityButton];

      v15 = [(CAMViewfinderViewController *)self _intensityButton];
      [v8 setIntensityButton:v15];

      if (v13 == v14)
      {
        goto LABEL_9;
      }
    }

    else
    {
      [v8 setIntensityButton:v13];
    }
  }

  else
  {
    v16 = [v7 intensityButton];

    [v8 setIntensityButton:0];
    [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0 animated:1];
    v17 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v17 setIsPortraitEffectIntensitySliderSupported:0];

    if (!v16)
    {
      goto LABEL_9;
    }
  }

  [v8 configureForMode:-[CAMViewfinderViewController _currentMode](self animated:{"_currentMode"), 1}];
LABEL_9:
}

void __60__CAMViewfinderViewController__updateTopBarForLightingType___block_invoke(uint64_t a1)
{
  v1 = (*(a1 + 40) ^ 1u);
  v2 = [*(a1 + 32) _intensityButton];
  [v2 setAlpha:v1];
}

- (void)_updateLightingControlFadesForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v12 = a3;
  v6 = [(CAMViewfinderViewController *)self _targetLightingControl];
  v7 = [v12 mode];
  if (v7 == 6)
  {
    if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v12])
    {
      v10 = [(CAMViewfinderViewController *)self _zoomControl];
      v11 = [v10 isPlatterExpanded];

      v8 = 0;
      if (v11)
      {
        v9 = 2;
      }

      else
      {
        v9 = 1;
      }
    }

    else
    {
      v8 = 0;
      v9 = 0;
    }
  }

  else
  {
    if (v7)
    {
      v8 = 0;
    }

    else
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = 2;
    }
  }

  [v6 setCollapsedItemFading:v9 animated:{v8, v4}];
}

- (void)_applySelectedEffectFilterType:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setEffectFilterType:a3 forMode:[(CAMViewfinderViewController *)self _currentMode]];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateChromeFilterScrubberForGraphConfiguration:v4];

  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];

  [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:1];
}

- (BOOL)_isNightModeUpdatingDeferred
{
  v3 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  v4 = v3 != 0;

  return (v4 | [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling]) & 1;
}

- (void)_updateNightModeSlider
{
  if (![(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    v3 = [(CAMViewfinderViewController *)self _controlDrawer];
    v4 = [v3 nightModeSlider];

    [v4 setNightMode:{-[CAMViewfinderViewController _resolvedNightModeControlMode](self, "_resolvedNightModeControlMode")}];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
    [v4 setDurationMapping:?];
    [v4 setNightModeActive:{-[CAMViewfinderViewController _isNightModeActiveForCurrentSettings](self, "_isNightModeActiveForCurrentSettings")}];
  }
}

- (void)_updateNightModeControlsAnimated:(BOOL)a3
{
  v3 = a3;
  if (![(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    v5 = [(CAMViewfinderViewController *)self _resolvedNightMode];
    v6 = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode]== 0;
    v7 = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
    v8 = [(CAMViewfinderViewController *)self _controlDrawer];
    v9 = [v8 nightModeButton];
    [v9 setOn:v7];
    [v9 setDisabled:v6 animated:v3];
    v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v11 = [v10 controlStatusBar];
    v12 = [v11 nightModeIndicator];

    [v12 setShowingValue:v7 animated:v3];
    [v12 setNightMode:v5];
    [v12 setNightModeDisabled:v6 animated:v3];
    if (v7)
    {
      [(CAMViewfinderViewController *)self _nightModeDurationMapping];
      if (v5 != 1)
      {
        v13 = 0.0;
      }

      if (v5 == 2)
      {
        v13 = v14;
      }

      [v12 setDuration:v13];
    }

    v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v16[0] = MEMORY[0x1E69E9820];
    v16[1] = 3221225472;
    v16[2] = __64__CAMViewfinderViewController__updateNightModeControlsAnimated___block_invoke;
    v16[3] = &unk_1E76F77B0;
    v16[4] = self;
    [v15 performChanges:v16];
  }
}

void __64__CAMViewfinderViewController__updateNightModeControlsAnimated___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _resolvedNightModeControlMode];
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setNightModeControlMode:v2];

  v4 = [*(a1 + 32) _resolvedNightMode];
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setNightModeCaptureState:v4];

  v6 = [*(a1 + 32) _captureController];
  v7 = [v6 nightModeStatus];
  v8 = [*(a1 + 32) chromeConfigurator];
  [v8 setNightModeStatus:v7];

  [*(a1 + 32) _nightModeDurationMapping];
  v10 = v9;
  v12 = v11;
  v13 = [*(a1 + 32) chromeConfigurator];
  [v13 setNightModeDurationMapping:{v10, v12}];
}

- (void)_handleNightModeSliderDidChangeValue:(id)a3
{
  v4 = [a3 nightMode];

  [(CAMViewfinderViewController *)self handleUserChangedToNightMode:v4];
}

- (void)handleUserChangedToNightMode:(unint64_t)a3
{
  if ([(CAMViewfinderViewController *)self _resolvedNightModeControlMode]!= a3)
  {
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __60__CAMViewfinderViewController_handleUserChangedToNightMode___block_invoke;
    v6[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
    v6[4] = a3;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }

  [(CAMViewfinderViewController *)self _setDesiredNightModeControlMode:a3];
  if (a3)
  {
    v5 = [(CAMViewfinderViewController *)self _nightModeConflicts];
    [(CAMViewfinderViewController *)self _setNightModeConflicts:0];
    [(CAMViewfinderViewController *)self _updateStateForClearedNightModeConflicts:v5];
  }

  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
}

- (void)_updateStateForClearedNightModeConflicts:(unint64_t)a3
{
  if ((a3 & 8) != 0)
  {
    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:0];
  }
}

- (void)_updateNightModePhotoModeDepthConflictAndPerformResolution:(BOOL)a3
{
  v3 = a3;
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v9 mode];
  v6 = [v9 device];
  v7 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  if ([CAMConflictingControlConfiguration isNightModePhotoModeDepthConflictRelevantForMode:v5 device:v6 photoFormat:v7, v8])
  {
    [(CAMViewfinderViewController *)self _updateNightModeConflict:8 isConflicting:[(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion] performResolution:v3];
  }
}

- (void)_resetNightModeDurationMappingAnimated:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self _setNightModeDurationMapping:1.0, 5.0];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:v3];
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v5 isCapturing:0 animated:v3];
}

- (BOOL)_isExpectedNightModeDurationCancelable
{
  v3 = [(CAMViewfinderViewController *)self _resolvedNightMode];
  [(CAMViewfinderViewController *)self _nightModeDurationMapping];
  if (v3 != 1)
  {
    v4 = 0.0;
  }

  if (v3 == 2)
  {
    v4 = v5;
  }

  return v4 > 3.5;
}

- (void)_updateResolvedNightModeAnimated:(BOOL)a3
{
  v3 = a3;
  v31 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    return;
  }

  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [v5 nightModeStatus];
  v28 = v5;
  if (v6 == 2)
  {
    v7 = 1;
LABEL_8:
    LODWORD(v27) = v7;
    goto LABEL_9;
  }

  if (v6 != 1)
  {
    if (v6 != -1)
    {
      v27 = 0;
      goto LABEL_11;
    }

    v7 = [(CAMViewfinderViewController *)self _resolvedNightMode]!= 0;
    goto LABEL_8;
  }

  LODWORD(v27) = 0;
  v7 = 1;
LABEL_9:
  HIDWORD(v27) = v7;
LABEL_11:
  [(CAMViewfinderViewController *)self _updateNightModePhotoModeDepthConflictAndPerformResolution:0];
  v8 = [(CAMViewfinderViewController *)self _desiredNightModeControlMode];
  v9 = [(CAMViewfinderViewController *)self _nightModeConflicts];
  v10 = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  v11 = [(CAMViewfinderViewController *)self _currentMode];
  v12 = [(CAMViewfinderViewController *)self _currentDevice];
  v13 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v15 = v14;
  LOBYTE(v26) = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v16 = [CAMConflictingControlConfiguration resolveDesiredNightModeControlMode:v8 nightModeConflicts:v9 resolvedFlashMode:v10 captureMode:v11 captureDevice:v12 photoFormat:v13 depthEffectEnabledFromSuggestion:v15, v26];
  v17 = +[CAMCaptureCapabilities capabilities];
  LODWORD(v8) = [v17 isNightModeSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  v18 = 0;
  if (v8)
  {
    v19 = v28;
    if (HIDWORD(v27) && v16)
    {
      v18 = [v28 isCapturingBurst] ^ 1;
    }
  }

  else
  {
    v19 = v28;
  }

  if (v16 == 2)
  {
    if (v18)
    {
      v20 = 2;
    }

    else
    {
      v20 = 0;
    }
  }

  else if (v16 == 1 && (v18 & v27) == 1)
  {
    v20 = [v19 isCapturingLivePhotoVideo] ^ 1;
  }

  else
  {
    v20 = 0;
  }

  if (v20 != [(CAMViewfinderViewController *)self _resolvedNightMode])
  {
    v21 = os_log_create("com.apple.camera", "NightMode");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v22 = off_1E76FA020[v20];
      *buf = 138543362;
      v30 = v22;
      _os_log_impl(&dword_1A3640000, v21, OS_LOG_TYPE_DEFAULT, "Resolved NightMode: %{public}@", buf, 0xCu);
    }

    v23 = [(CAMViewfinderViewController *)self _captureController];
    [v23 changeToNightMode:v20];
  }

  [(CAMViewfinderViewController *)self _setResolvedNightMode:v20];
  [(CAMViewfinderViewController *)self _setResolvedNightModeControlMode:v16];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:v3];
  [(CAMViewfinderViewController *)self _updateControlsDisabledByNightModeAnimated:v3];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  v24 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v24 animated:v3];

  v25 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:v25 isCapturing:0 animated:v3];
}

- (int64_t)_nightModeForMode:(int64_t)a3 captureMode:(int64_t)a4 device:(int64_t)a5 isBurst:(BOOL)a6
{
  v11 = +[CAMCaptureCapabilities capabilities];
  v12 = [v11 isNightModeSupportedForMode:a4 device:a5];

  v13 = [(CAMViewfinderViewController *)self _captureController];
  if ([v13 isCapturingVideo] & 1) != 0 || (objc_msgSend(v13, "isCapturingPanorama") & 1) != 0 || (objc_msgSend(v13, "isCapturingBurst"))
  {
    v14 = 1;
  }

  else
  {
    v14 = [v13 isCapturingTimelapse];
  }

  if (v14 & 1 | ((v12 & 1) == 0) | a6)
  {
    a3 = 0;
  }

  return a3;
}

- (void)_updateNightModeConflict:(unint64_t)a3 isConflicting:(BOOL)a4 performResolution:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isNightModeSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v10)
  {
    v11 = [(CAMViewfinderViewController *)self _nightModeConflicts];
    v12 = v6 ? v11 | a3 : v11 & ~a3;
    [(CAMViewfinderViewController *)self _setNightModeConflicts:v12];
    if (v5)
    {

      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    }
  }
}

- (BOOL)_isNightModeCaptureCanceling
{
  v2 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v3 = [v2 hasClosedViewfinderReason:11];

  return v3;
}

- (void)_updateControlsDisabledByNightModeAnimated:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:a3];
  [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:v3];

  [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:v3];
}

- (void)_updateFlipAspectRatioButtonForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = -[CAMViewfinderViewController _resolvedFlipAspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_resolvedFlipAspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", [v6 mode], objc_msgSend(v6, "videoConfiguration"), objc_msgSend(v6, "devicePosition"), objc_msgSend(v6, "trueVideoEnabled"));
  v8 = [v6 mode];
  v9 = [v6 devicePosition];

  v10 = ([(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:v8 devicePosition:v9]- 3) < 2 || v7;
  v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = [v12 flipAspectRatioButton];
  [v11 setActive:v10 animated:v4];
}

- (void)_handleFlipAspectRatioButtonTapped:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _wantsFlipAspectRatio]^ 1;

  [(CAMViewfinderViewController *)self handleUserChangedFlippedAspectRatioEnabled:v4];
}

- (void)handleUserChangedFlippedAspectRatioEnabled:(BOOL)a3
{
  v3 = a3;
  v24 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _isReconfiguring])
  {
    goto LABEL_5;
  }

  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([v5 isReticleAnimating])
  {

    goto LABEL_5;
  }

  v6 = [(CAMViewfinderViewController *)self _isZooming];

  if (v6)
  {
LABEL_5:
    v7 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = [(CAMViewfinderViewController *)self _isReconfiguring];
      v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v19[0] = 67109632;
      v19[1] = v8;
      v20 = 1024;
      v21 = [v9 isReticleAnimating];
      v22 = 1024;
      v23 = [(CAMViewfinderViewController *)self _isZooming];
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Ignoring request to flip aspect ratio - reconfiguring: %d reticleAnimating: %d zooming: %d", v19, 0x14u);
    }

LABEL_7:

    return;
  }

  v10 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

  if (!v10 && ![(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v11 = +[CAMCaptureCapabilities capabilities];
    v12 = [v11 isDynamicAspectRatioSupportedForMode:-[NSObject mode](v7 videoConfiguration:"mode") devicePosition:{-[NSObject videoConfiguration](v7, "videoConfiguration"), -[NSObject devicePosition](v7, "devicePosition")}];

    v13 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:[v7 mode] devicePosition:[v7 devicePosition]];
    if (v12)
    {
      [(CAMViewfinderViewController *)self set_wantsFlipAspectRatio:v3];
      v14 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v15 = [v14 flipAspectRatioButton];
      [v15 setActive:-[CAMViewfinderViewController _wantsFlipAspectRatio](self animated:{"_wantsFlipAspectRatio"), 1}];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _currentMode]];
    }

    else
    {
      v16 = v13;
      if (v13)
      {
        if ([(CAMViewfinderViewController *)self _delaySmartFramingDynamicAspectRatioUpdate])
        {
          v17 = os_log_create("com.apple.camera", "SmartFraming");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
          {
            LOWORD(v19[0]) = 0;
            _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Ignoring request to flip aspect ratio - smart framing is in transition", v19, 2u);
          }
        }

        else
        {
          if (v16 <= 4)
          {
            [(CAMViewfinderViewController *)self set_desiredFieldOfView:qword_1A3A68518[v16 - 1]];
          }

          v18 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v18 animated:1];

          [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
        }
      }
    }

    goto LABEL_7;
  }
}

- (BOOL)_resolvedFlipAspectRatioForMode:(int64_t)a3 videoConfiguration:(int64_t)a4 devicePosition:(int64_t)a5 trueVideoEnabled:(BOOL)a6
{
  v6 = a6;
  v11 = +[CAMCaptureCapabilities capabilities];
  LODWORD(a4) = [v11 isDynamicAspectRatioSupportedForMode:a3 videoConfiguration:a4 devicePosition:a5];

  if (!a4)
  {
    return 0;
  }

  if (v6)
  {
    return ([(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode] devicePosition:a5]- 3) < 2;
  }

  return [(CAMViewfinderViewController *)self _wantsFlipAspectRatio];
}

- (BOOL)_shouldShowFlipAspectRatioButtonForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isDynamicAspectRatioSupportedForMode:objc_msgSend(v4 videoConfiguration:"mode") devicePosition:{objc_msgSend(v4, "videoConfiguration"), objc_msgSend(v4, "devicePosition")}];

  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isSmartFramingSupportedForMode:objc_msgSend(v4 devicePosition:{"mode"), objc_msgSend(v4, "devicePosition")}];

  v9 = [(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:v4];
  v10 = v9;
  if (!v8)
  {
    if ((v6 & v9) == 1)
    {
      v13 = ![(CAMViewfinderViewController *)self _trueVideoIsActive];
      goto LABEL_7;
    }

LABEL_6:
    v13 = 0;
    goto LABEL_7;
  }

  v11 = -[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [v4 mode], objc_msgSend(v4, "devicePosition")));
  v12 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:v4];
  if (!v10 || !v11)
  {
    goto LABEL_6;
  }

  v13 = ![(CAMViewfinderViewController *)self _trueVideoIsActive]&& !v12;
LABEL_7:

  return v13 & 1;
}

- (void)_resetDynamicAspectRatio
{
  if ([(CAMViewfinderViewController *)self _wantsFlipAspectRatio])
  {
    [(CAMViewfinderViewController *)self set_wantsFlipAspectRatio:0];
    v3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v4 = [v3 flipAspectRatioButton];
    [v4 setActive:0 animated:1];

    v5 = [(CAMViewfinderViewController *)self _currentMode];

    [(CAMViewfinderViewController *)self handleUserChangedToMode:v5];
  }
}

- (void)_updateAutoMacroStatus
{
  v14 = +[CAMCaptureCapabilities capabilities];
  if ([v14 isSuperWideAutoMacroSupported])
  {
    v3 = [(CAMViewfinderViewController *)self _captureController];
    v4 = [v3 preferredPrimaryConstituentDeviceType];
    v5 = [v3 activePrimaryConstituentDeviceType];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v7 = v6;
    [v14 superWideToWideZoomFactorForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
    v9 = v7 < v8;
    v10 = v7 >= v8 && v4 == 1;
    v11 = v7 >= v8 && v5 == 1;
    [(CAMViewfinderViewController *)self _setAutoMacroActive:v11];
    v12 = [(CAMViewfinderViewController *)self _shouldIgnoreZoomFactorKVOForRamping];
    if (v10 != [(CAMViewfinderViewController *)self _autoMacroSuggested]&& (v9 || !v12))
    {
      [(CAMViewfinderViewController *)self _setAutoMacroSuggested:v10];
      v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v13 animated:1];

      [(CAMViewfinderViewController *)self _updateAutoMacroButton];
    }
  }
}

- (void)_updateAutoMacroButton
{
  [(CAMViewfinderViewController *)self _desiredMacroMode];
  v3 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v3 setMacroMode:{-[CAMViewfinderViewController _desiredMacroMode](self, "_desiredMacroMode")}];
}

- (void)_updateMacroButtonState
{
  if (![(CAMViewfinderViewController *)self _desiredMacroMode])
  {
    v3 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v4 = [v3 isLensPositionLockedByUser];

    if (v4)
    {
      [(CAMViewfinderViewController *)self handleUserChangedIsLensPositionLocked:0];
    }
  }

  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];

  [(CAMViewfinderViewController *)self _updateAutoMacroButton];
}

- (void)_updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:(BOOL)a3
{
  HIDWORD(v14) = a3;
  v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v6 = v5;
  v7 = [(CAMViewfinderViewController *)self _desiredMacroMode];
  v8 = [v16 mode];
  v9 = [v16 device];
  v10 = [v16 videoConfiguration];
  v11 = [v16 videoStabilizationStrength];
  v12 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  BYTE1(v14) = [v16 frontRearSimultaneousVideoEnabled];
  LOBYTE(v14) = v12;
  v13 = [CAMConflictingControlConfiguration resolveDesiredMacroMode:v7 forMode:v8 device:v9 videoConfiguration:v10 videoStabilizationStrength:v11 photoFormat:v4 optionalDepthEffectEnabled:v6 frontRearSimultaneousVideoEnabled:v14];
  if (v13 != [(CAMViewfinderViewController *)self _resolvedMacroMode])
  {
    [(CAMViewfinderViewController *)self _setResolvedMacroMode:v13];
    if (v15)
    {
      [(CAMViewfinderViewController *)self _updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController];
    }
  }
}

- (void)_updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController
{
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 fallbackPrimaryConstituentDeviceSelectionForMode:objc_msgSend(v6 device:"mode") videoConfiguration:objc_msgSend(v6 videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:objc_msgSend(v6 macroMode:{"videoConfiguration"), objc_msgSend(v6, "videoStabilizationStrength"), objc_msgSend(v6, "frontRearSimultaneousVideoEnabled"), -[CAMViewfinderViewController _resolvedMacroMode](self, "_resolvedMacroMode")}];

  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 setFallbackPrimaryConstituentDeviceSelection:v4];
}

- (BOOL)_depthEffectEnabledFromSuggestion
{
  if (self->__depthEffectEnabledFromSuggestion)
  {
    return 1;
  }

  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 featureDevelopmentForceDepthEffectInPhotoMode];

  return v4;
}

- (void)_updateDepthEffectSuggestionButton
{
  if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
  {
    v3 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    if (v3 <= 0xE && ((1 << v3) & 0x6202) != 0 || [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 11)
    {
      v4 = 1;
    }

    else if ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 12)
    {
      v4 = 1;
    }

    else
    {
      v4 = 2;
    }
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _shouldDisableDepthSuggestionForNightModeForConfiguration:v5];

    if (v6)
    {
      v4 = 3;
    }

    else
    {
      v4 = 0;
    }
  }

  v7 = +[CAMCaptureCapabilities capabilities];
  if (([v7 isDepthSuggestionSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), 0}] & 1) != 0 || objc_msgSend(v7, "isDepthSuggestionSupportedForMode:devicePosition:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), 1))
  {
    v8 = +[CAMUserPreferences preferences];
    v9 = [v8 shouldUseDepthSuggestionInPhotoMode];
  }

  else
  {
    v9 = 0;
  }

  v10 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __65__CAMViewfinderViewController__updateDepthEffectSuggestionButton__block_invoke;
  v11[3] = &unk_1E76F9BA0;
  v12 = v9;
  v11[4] = self;
  v11[5] = v4;
  [v10 performChanges:v11];
}

void __65__CAMViewfinderViewController__updateDepthEffectSuggestionButton__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) chromeConfigurator];
  [v2 setIsDepthInPhotoSupported:*(a1 + 48)];

  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setIsDepthInPhotoEnabled:{objc_msgSend(*(a1 + 32), "_depthEffectEnabledFromSuggestion")}];

  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setDepthEffectSuggestionButtonMode:*(a1 + 40)];
}

- (void)updateDepthEffectSuggestionEnabled:(BOOL)a3
{
  v3 = a3;
  if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]!= a3)
  {
    [(CAMViewfinderViewController *)self set_depthEffectEnabledFromSuggestion:v3];
    [(CAMViewfinderViewController *)self _updateNightModePhotoModeDepthConflictAndPerformResolution:1];
    [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:v5 fromGraphConfiguration:v6 animated:1];

    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _processTextRegionResults];
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:v7 animated:0];

    v8 = +[CAMCaptureCapabilities capabilities];
    LOBYTE(v6) = [v8 portraitInPhotoModeBehavior];

    if ((v6 & 4) != 0)
    {
      v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v9 animated:1];
    }

    if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
    {
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:v10];
    }
  }
}

- (BOOL)_shouldUsePhotoModePortraitEffect
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = [v3 isCapturingBurst];

  return [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffectIsBurst:v4];
}

- (BOOL)_shouldUsePhotoModePortraitEffectIsBurst:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v6 = [(CAMViewfinderViewController *)self _shouldUseDepthFromSuggestionForCurrentConfigurationIsBurst:v3];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 isSemanticStyleControlVisible];

  if (v5)
  {
    return v6 & (v8 ^ 1);
  }

  else
  {
    return 0;
  }
}

- (BOOL)_isDepthSuggestionAllowedForCurrentConfigurationIsBurst:(BOOL)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  v9 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v5 isDepthSuggestionSupportedForMode:v6 devicePosition:v8 photoFormat:v9, v10];

  v12 = [(CAMViewfinderViewController *)self _captureController];
  v13 = [v12 isCapturingVideo];
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSuperWideAutoMacroSupportedForMode:objc_msgSend(v4 device:"mode") videoConfiguration:objc_msgSend(v4 videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:{objc_msgSend(v4, "videoConfiguration"), objc_msgSend(v4, "videoStabilizationStrength"), objc_msgSend(v4, "frontRearSimultaneousVideoEnabled")}];

  v16 = +[CAMUserPreferences preferences];
  v17 = [v16 isSuperWideAutoMacroControlAllowed];

  v18 = [(CAMViewfinderViewController *)self _resolvedMacroMode]== 1 && [(CAMViewfinderViewController *)self _autoMacroSuggested];
  v19 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  if ((v15 & v17) == 1 && v18)
  {
    v20 = 0;
  }

  else
  {
    v21 = [(CAMViewfinderViewController *)self _shouldDisableDepthSuggestionForNightModeForConfiguration:v4];
    v20 = 0;
    if (!(v13 & 1 | ((v11 & 1) == 0)) && !a3)
    {
      v20 = v19 != 1 && !v21;
    }
  }

  return v20;
}

- (BOOL)_shouldDisableDepthSuggestionForNightModeForConfiguration:(id)a3
{
  v4 = a3;
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings])
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    v6 = [v5 isNightModeWithDepthSupportedForMode:objc_msgSend(v4 device:{"mode"), objc_msgSend(v4, "device")}];

    if (!v6)
    {
      LOBYTE(v9) = 1;
      goto LABEL_7;
    }

    v7 = [v4 mode];
    v8 = [v4 device];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    if (![(CAMViewfinderViewController *)self _isNightModePortraitAvailableForMode:v7 device:v8 zoomFactor:?])
    {
      v9 = ![(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
      goto LABEL_7;
    }
  }

  LOBYTE(v9) = 0;
LABEL_7:

  return v9;
}

- (BOOL)_isNightModePortraitAvailableForMode:(int64_t)a3 device:(int64_t)a4 zoomFactor:(double)a5
{
  v8 = +[CAMCaptureCapabilities capabilities];
  if ([v8 isNightModeWithDepthSupportedForMode:a3 device:a4])
  {
    [v8 superWideToWideZoomFactorForDevicePosition:0];
    v10 = v9 * 1.1 > a5 && v9 <= a5;
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:(int64_t)a3
{
  v5 = (a3 < 0xF) & (0x7A02u >> a3);
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  v7 = [v6 isShowingPointIndicator];

  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 portraitInPhotoModeBehavior];

  if (v9)
  {
    v10 = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    if (!v5)
    {
      goto LABEL_3;
    }

LABEL_5:
    v12 = +[CAMUserPreferences preferences];
    v11 = [v12 shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable];

    return (a3 < 0xF) & (0x6A02u >> a3) | v10 | v5 & v7 & 1 | v11 & 1;
  }

  v10 = 0;
  if (v5)
  {
    goto LABEL_5;
  }

LABEL_3:
  v11 = 0;
  return (a3 < 0xF) & (0x6A02u >> a3) | v10 | v5 & v7 & 1 | v11 & 1;
}

- (void)_updatePreviewControllerIndicatorStyle
{
  v3 = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v4 = [(CAMViewfinderViewController *)self _previewViewController];
  [v4 setShouldUsePortraitStyleIndicatorsInPhotoMode:v3];
}

- (BOOL)_shouldRequestDepthDeliveryForBurst:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v5 mode];
  if (v6 == 9 || v6 == 6)
  {
    v8 = 1;
  }

  else if (v6)
  {
    v8 = 0;
  }

  else
  {
    v9 = +[CAMCaptureCapabilities capabilities];
    v8 = [v9 featureDevelopmentForceDepthDataCaptureInPhotoMode];
  }

  v10 = v8 | [(CAMViewfinderViewController *)self _shouldUseDepthFromSuggestionForCurrentConfigurationIsBurst:v3];

  return v10 & 1;
}

- (BOOL)_shouldUseTransientLightingBadgesForGraphConfiguration:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _targetLightingControl];
  v4 = [v3 collapsedControlLocation] != 0;

  return v4;
}

- (BOOL)_shouldHideLightingNameBadgesForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:v4];
  v6 = [(CAMViewfinderViewController *)self _targetLightingControl];
  v7 = [v6 isExpanded];

  LOBYTE(v6) = [(CAMViewfinderViewController *)self _shouldUseTransientLightingBadgesForGraphConfiguration:v4];
  v8 = [(CAMViewfinderViewController *)self _timerCache];
  LOBYTE(v4) = [v8 isRunningTimerForKey:&unk_1F16C7898];

  v9 = v6 & (v4 ^ 1);
  if (v7)
  {
    v9 = v5;
  }

  if (v5)
  {
    return v5;
  }

  else
  {
    return v9;
  }
}

- (void)_updateTransientLightingBadgeVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgesForGraphConfiguration:v5];

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v7 setLightingNameBadgesHidden:v6 animated:v3];
}

- (void)_startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:(id)a3
{
  if ([(CAMViewfinderViewController *)self _shouldUseTransientLightingBadgesForGraphConfiguration:a3])
  {
    [(CAMViewfinderViewController *)self _startTimer:5];

    [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
  }
}

- (void)handleUserDidToggleSpatialMode
{
  v3 = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected]^ 1;

  [(CAMViewfinderViewController *)self _spatialModeToggledTo:v3];
}

- (void)_handlePhotoVideoModeSwitchValueChanged:(id)a3
{
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = [v5 photoVideoModeSwitch];
  -[CAMViewfinderViewController _spatialModeToggledTo:](self, "_spatialModeToggledTo:", [v4 mode]);
}

- (void)_spatialModeToggledTo:(unint64_t)a3
{
  v4 = 9;
  if (a3)
  {
    v4 = 0;
  }

  if (a3 == 1)
  {
    v5 = 8;
  }

  else
  {
    v5 = v4;
  }

  v6 = a3 == 1;
  [(CAMViewfinderViewController *)self _setSpatialModeHasVideoSelected:v6];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 badgeTray];
  v9 = [v8 spatialBadge];
  [v9 setSpatialModeHasVideoSelected:v6];

  v10 = [(CAMViewfinderViewController *)self _modeDial];
  [v10 reloadData];
  [v10 setSelectedMode:v5 animated:0];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:v5];
}

- (void)_setSpatialModeHasVideoSelected:(BOOL)a3
{
  if (self->__spatialModeHasVideoSelected != a3)
  {
    v4 = a3;
    self->__spatialModeHasVideoSelected = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setSpatialModeHasVideoSelected:v4];
  }
}

- (void)_updateSpatialCaptureUIStateForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v20 = [(CAMViewfinderViewController *)self _motionController];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v6];
  v9 = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
  v10 = [v7 photoVideoModeSwitch];
  [v10 setMode:v9 animated:v4];

  v11 = !v8;
  v12 = [v7 photoVideoModeSwitch];
  [v12 setEnabled:v11];

  v13 = [v6 mode];
  v14 = [v6 devicePosition];

  if ([(CAMViewfinderViewController *)self _isSpatialMode:v13 devicePosition:v14]&& v11)
  {
    v15 = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
    v16 = [(CAMViewfinderViewController *)self _motionController];
    [v16 setForceLandscapeOrientation:!v15];

    v17 = [v20 deviceOrientation];
    if (v17 > 6)
    {
      goto LABEL_9;
    }

    if (((1 << v17) & 0x79) == 0)
    {
      [v7 setOrientationInstructionVisible:1 animated:v4];
      if ([(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
      {
        v18 = 0;
      }

      else
      {
        v18 = ![(CAMViewfinderViewController *)self _trueVideoIsCapturing];
      }

      [v7 setOrientationInstructionBackgroundBlurred:(-[CAMViewfinderViewController isRecording](self animated:{"isRecording") ^ 1) & v18, v4}];
      goto LABEL_9;
    }
  }

  else
  {
    v19 = [(CAMViewfinderViewController *)self _motionController];
    [v19 setForceLandscapeOrientation:0];
  }

  [v7 setOrientationInstructionVisible:0 animated:v4];
LABEL_9:
}

- (BOOL)_shouldShowSpatialCaptureInstructionsForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode] == 8;
  v6 = [(CAMViewfinderViewController *)self _motionController];
  v7 = [v6 deviceOrientation];

  v8 = [(CAMViewfinderViewController *)self _stereoCaptureStatus];
  v9 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4];
  v10 = [v4 mode];
  v11 = [v4 devicePosition];

  v12 = [(CAMViewfinderViewController *)self _isSpatialMode:v10 devicePosition:v11];
  result = 0;
  if ((v5 || v12) && (v7 - 1) >= 2 && (v8 & 6) != 0 && !v9)
  {
    return ![(CAMViewfinderViewController *)self _isReconfiguring];
  }

  return result;
}

- (BOOL)_shouldShowPhotoVideoModeSwitchForGraphConfiguration:(id)a3
{
  v4 = [a3 mode];
  v5 = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v6 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v7 = 0;
  if (!v5 && (v4 & 0xFFFFFFFFFFFFFFFELL) == 8)
  {
    v7 = ![(CAMViewfinderViewController *)self isRecording]&& !v6;
  }

  return v7 & 1;
}

- (void)captureController:(id)a3 didOutputStereoCaptureStatus:(int64_t)a4
{
  [(CAMViewfinderViewController *)self _setStereoCaptureStatus:a4];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isSpatialModeSupported];

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _currentMode]== 9;
    v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v8 setStereoCaptureStatus:-[CAMViewfinderViewController _stereoCaptureStatus](self useHoldStillStereoLowLightInstruction:"_stereoCaptureStatus") animated:{v7, 1}];

    if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
    {
      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }
  }

  v9 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v9 setStereoCaptureStatus:{-[CAMViewfinderViewController _stereoCaptureStatus](self, "_stereoCaptureStatus")}];
}

- (BOOL)_isFrontRearSimultaneousVideoSupportedForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(a4) = [v7 isFrontRearSimultaneousVideoSupportedForMode:a3 devicePosition:a4];

  return a4 & ![(CAMViewfinderViewController *)self _trueVideoIsActive];
}

- (BOOL)_isFrontRearSimultaneousVideoActiveForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v5 = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:a3 devicePosition:a4];
  if (v5)
  {

    LOBYTE(v5) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
  }

  return v5;
}

- (void)handleUserChangedFrontPIPEnabled:(BOOL)a3
{
  v3 = a3;
  v5 = +[CAMUserPreferences preferences];
  [v5 setDidRecentlyUseFrontPIP];

  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabled:v3 performGraphConfiguration:1];
}

- (void)_updateFrontRearSimultaneousVideoEnabled:(BOOL)a3 performGraphConfiguration:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  if ([(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled]!= a3)
  {
    [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoEnabled:v5];
    if (!v5)
    {
      v7 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [v7 setFrontPIPFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    }

    v8 = +[CAMUserPreferences preferences];
    [v8 setShouldEnableFrontRearSimultaneousVideo:{-[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
    if (v4)
    {
      [(CAMViewfinderViewController *)self _performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange];
    }
  }
}

- (void)_performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange
{
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:0 fromGraphConfiguration:v9];
  v4 = [v9 devicePosition];
  if (v4 == [v3 devicePosition])
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v6 = v5;
    v7 = [(CAMViewfinderViewController *)self _resolvedDeviceForZoomFactor:v9 fromGraphConfiguration:v3 toGraphConfiguration:?];
    v8 = -[CAMViewfinderViewController _graphConfigurationForChangeToMode:device:fromGraphConfiguration:](self, "_graphConfigurationForChangeToMode:device:fromGraphConfiguration:", [v3 mode], v7, v9);

    +[CAMZoomControlUtilities equivalentZoomFactor:forDevice:fromDevice:](CAMZoomControlUtilities, "equivalentZoomFactor:forDevice:fromDevice:", v7, [v9 device], v6);
    v3 = v8;
  }

  else
  {
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v3];
  }

  [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:v9 toGraphConfiguration:v3 zoomFactor:1 deferIfConfigurationInFlight:?];
}

- (void)_updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:(id)a3
{
  v4 = [a3 frontRearSimultaneousVideoEnabled];
  if (v4 != [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled])
  {

    [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoEnabled:v4];
  }
}

- (void)_setView:(id)a3 hidden:(BOOL)a4 delayedInTotalAnimationTime:(double)a5 normalizedFadeoutDuration:(double)a6
{
  v8 = a4;
  v9 = a3;
  v10 = v9;
  v11 = !v8;
  if (a5 <= 0.0)
  {
    [v9 setAlpha:!v8];
  }

  else
  {
    v12 = a5 * a6;
    if (v8)
    {
      v13 = 0.0;
    }

    else
    {
      v13 = a5 - v12;
    }

    v14 = MEMORY[0x1E69DD250];
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = __101__CAMViewfinderViewController__setView_hidden_delayedInTotalAnimationTime_normalizedFadeoutDuration___block_invoke;
    v15[3] = &unk_1E76F7A38;
    v16 = v9;
    v17 = v11;
    [v14 animateWithDuration:0 delay:v15 options:0 animations:v12 completion:v13];
  }
}

- (void)videoThumbnailOutputWillBeginRenderingThumbnailsWithContents:(id)a3
{
  v9 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    v7 = 138543362;
    v8 = v4;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Setting thumbnail contents %{public}@", &v7, 0xCu);
  }

  [(CAMViewfinderViewController *)self set_filterScrubberLayerContents:v4];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v6 setFilterThumbnailContents:v4];

  if ([(CAMViewfinderViewController *)self _shouldShowFilterScrubberAfterNextRender])
  {
    [(CAMViewfinderViewController *)self _setShouldShowFilterScrubberAfterNextRender:0];
    [(CAMViewfinderViewController *)self _setShowingFilterScrubber:1 animated:1];
  }
}

- (void)videoThumbnailOutputWillEndRenderingThumbnails
{
  v3 = NSStringFromSelector(a2);
  [(CAMViewfinderViewController *)self _clearFilterScrubberLayerContentsIfNotNeededFromCallsite:v3];
}

- (void)_clearFilterScrubberLayerContentsIfNotNeededFromCallsite:(id)a3
{
  v26 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v6 = [(CAMViewfinderViewController *)self _wantsFilterScrubberVisible];
  v7 = [(CAMViewfinderViewController *)self _isAnimatingFilterScrubberDismissal];
  v8 = v7;
  if (v5 || v6 || v7)
  {
    v11 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      if (v5)
      {
        v12 = @"YES";
      }

      else
      {
        v12 = @"NO";
      }

      v13 = v12;
      if (v6)
      {
        v14 = @"YES";
      }

      else
      {
        v14 = @"NO";
      }

      v15 = v14;
      if (v8)
      {
        v16 = @"YES";
      }

      else
      {
        v16 = @"NO";
      }

      v17 = v16;
      v18 = 138544130;
      v19 = v4;
      v20 = 2114;
      v21 = v13;
      v22 = 2114;
      v23 = v15;
      v24 = 2114;
      v25 = v17;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Not clearing thumbnail contents from %{public}@ because showingFilterScrubber=%{public}@, wantsFilterScrubberVisible=%{public}@, and animatingFilterScrubberDismissal=%{public}@", &v18, 0x2Au);
    }

    goto LABEL_19;
  }

  v9 = [(CAMViewfinderViewController *)self _filterScrubberLayerContents];

  if (v9)
  {
    v10 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v18 = 138543362;
      v19 = v4;
      _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Clearing thumbnail contents from %{public}@", &v18, 0xCu);
    }

    [(CAMViewfinderViewController *)self set_filterScrubberLayerContents:0];
    v11 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v11 setFilterThumbnailContents:0];
LABEL_19:
  }
}

- (BOOL)_isZoomAllowedForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 device];
  v7 = [v3 videoConfiguration];
  v8 = [v3 videoStabilizationStrength];

  LOBYTE(v3) = [v4 isZoomAllowedForMode:v5 device:v6 videoConfiguration:v7 videoStabilizationStrength:v8];
  return v3;
}

- (BOOL)_isZoomAllowedCurrently
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _isPinchToZoomAllowed];
  v4 = [(CAMViewfinderViewController *)v2 _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _isZoomAllowedForGraphConfiguration:v4];

  return v3 & v2;
}

- (BOOL)_zoomControlReconfiguresGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v4];
  v6 = [(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForGraphConfiguration:v4]&& !v5;
  if ([v4 devicePosition] == 1)
  {
    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 frontZoomBehaviorForCaptureMode:objc_msgSend(v4 videoConfiguration:{"mode"), objc_msgSend(v4, "videoConfiguration")}];

    LOBYTE(v6) = ((v8 & 0xFFFFFFFFFFFFFFFELL) == 2) | v6;
  }

  return v6 & 1;
}

- (BOOL)_isPinchToZoomAllowed
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  v5 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v6 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [v7 videoStabilizationStrength];
  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = [v3 shouldAllowCameraToggleForMode:v4 devicePosition:v5 videoConfiguration:v6 videoStabilizationStrength:v8 frontRearSimultaneousVideoEnabled:{objc_msgSend(v9, "frontRearSimultaneousVideoEnabled")}];

  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v12 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v11];

  v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v14 = [(CAMViewfinderViewController *)self _zoomControlReconfiguresGraphConfiguration:v13];

  v15 = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v16 = [(CAMViewfinderViewController *)self _captureController];
  v17 = [v16 isCapturingVideo];

  v18 = [(CAMViewfinderViewController *)self _captureController];
  v19 = [v18 isCapturingBurst];

  v20 = [(CAMViewfinderViewController *)self _captureController];
  v21 = [v20 isCapturingPanorama];

  v22 = [(CAMViewfinderViewController *)self _captureController];
  v23 = [v22 isCapturingTimelapse];

  if (v15 || v19 & 1 | (((v12 | v10) & 1) == 0) | (v21 | v23) & 1)
  {
    v24 = 0;
  }

  else
  {
    v24 = v17 & v14 ^ 1;
  }

  return v24;
}

- (double)_defaultZoomFactorForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", v4, [v5 captureOrientation]);
  v7 = v6;

  return v7;
}

- (BOOL)_shouldEmulateAggregateCameraZoomForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = [v3 mode];
  v5 = [v3 device];
  v6 = [v3 videoConfiguration];
  v7 = +[CAMZoomControlUtilities shouldEmulateTripleCameraZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "shouldEmulateTripleCameraZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", v4, v5, v6, [v3 videoStabilizationStrength], objc_msgSend(v3, "frontRearSimultaneousVideoEnabled"));
  v8 = [v3 videoStabilizationStrength];
  v9 = [v3 frontRearSimultaneousVideoEnabled];

  return (v7 | [CAMZoomControlUtilities shouldEmulateWideDualCameraZoomForMode:v4 device:v5 videoConfiguration:v6 videoStabilizationStrength:v8 frontRearSimultaneousVideoEnabled:v9]) & 1;
}

- (void)_limitZoomRangeForRecordingIfNecessary
{
  v29 = +[CAMCaptureCapabilities capabilities];
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:v3];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _zoomControl];
    [v5 minAvailableZoomFactor];
    if (v6 < 1.0)
    {
      [v5 setMinAvailableZoomFactor:1.0];
    }
  }

  v7 = [(CAMViewfinderViewController *)self _currentDevice];
  if (v7 <= 0xB)
  {
    if (((1 << v7) & 0xF2B) != 0)
    {
      v8 = [(CAMViewfinderViewController *)self _currentMode];
      v9 = [(CAMViewfinderViewController *)self _currentDevice];
      v10 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
      v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v29 maximumZoomFactorForMode:v8 device:v9 videoConfiguration:v10 videoStabilizationStrength:{objc_msgSend(v11, "videoStabilizationStrength")}];
      v13 = v12;
    }

    else
    {
      if (((1 << v7) & 0xC0) != 0)
      {
        v16 = +[CAMUserPreferences preferences];
        v17 = [v16 shouldDisableCameraSwitchingDuringVideoRecordingForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

        if (!v17)
        {
          goto LABEL_12;
        }

        [v29 wideDualCameraSwitchOverZoomFactorForDevicePosition:0];
        v19 = v18;
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        v13 = 6.0;
        if (v20 >= v19)
        {
          goto LABEL_12;
        }

        goto LABEL_9;
      }

      if (v7 != 2)
      {
        goto LABEL_12;
      }

      v21 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      if ([v21 trueVideoEnabled])
      {
        v22 = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      }

      else
      {
        v22 = [(CAMViewfinderViewController *)self _currentMode];
      }

      v23 = v22;

      v24 = [(CAMViewfinderViewController *)self _currentDevice];
      v25 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
      v26 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v29 maximumZoomFactorForMode:v23 device:v24 videoConfiguration:v25 videoStabilizationStrength:{objc_msgSend(v26, "videoStabilizationStrength")}];
      v13 = v27;

      if ([v29 isBackTelephotoSupported])
      {
        [v29 wideToTelephotoZoomFactorForDevicePosition:0];
        if (v28 > v13)
        {
          v13 = v28;
        }
      }
    }

    if (v13 <= 0.0)
    {
      goto LABEL_12;
    }

LABEL_9:
    v14 = [(CAMViewfinderViewController *)self _zoomControl];
    [v14 maxAvailableZoomFactor];
    if (v15 > v13)
    {
      [v14 setMaxAvailableZoomFactor:v13];
    }
  }

LABEL_12:
}

- (void)_restoreZoomRangeAfterRecordingIfNecessary
{
  v11 = [(CAMViewfinderViewController *)self _zoomControl];
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:v3];

  if (v4)
  {
    [v11 minAvailableZoomFactor];
    v6 = v5;
    [v11 minimumZoomFactor];
    if (v6 > v7)
    {
      [v11 minimumZoomFactor];
      [v11 setMinAvailableZoomFactor:?];
    }

    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [CAMViewfinderViewController _changeToZoomFactor:"_changeToZoomFactor:rampDuration:zoomRampTuning:shouldAnimate:" rampDuration:0 zoomRampTuning:0 shouldAnimate:?];
  }

  [v11 maxAvailableZoomFactor];
  v9 = v8;
  [v11 maximumZoomFactor];
  if (v9 < v10)
  {
    [v11 maximumZoomFactor];
    [v11 setMaxAvailableZoomFactor:?];
  }
}

- (void)captureController:(id)a3 didOutputVideoZoomFactor:(double)a4
{
  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration]&& ![(CAMViewfinderViewController *)self _shouldIgnoreZoomFactorKVOForRamping]&& ![(CAMViewfinderViewController *)self _isPinchingForZoom])
  {
    v6 = [(CAMZoomSlider *)self->__zoomSlider isTracking];
    v7 = [(CAMViewfinderViewController *)self _zoomSlider];
    v8 = [v7 isAutozooming];

    if ((!v6 || v8 != 0) && ([(CAMZoomControl *)self->__zoomControl isTracking]& 1) == 0)
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      if (vabdd_f64(a4, v10) >= 0.0001)
      {
        v19 = [(CAMViewfinderViewController *)self _zoomControl];
        v11 = [(CAMViewfinderViewController *)self _currentMode];
        v12 = [(CAMViewfinderViewController *)self _currentDevice];
        v13 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
        v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v15 = [v14 videoStabilizationStrength];
        v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v17 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", v11, v12, v13, v15, [v16 frontRearSimultaneousVideoEnabled], 0, 0);

        if (v19)
        {
          if (v17 && ([v19 zoomButtonContentType] | 2) == 2)
          {
            [v19 maximumZoomFactor];
            if (v18 - a4 < 0.0001)
            {
              a4 = v18;
            }
          }
        }

        [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:a4];
        [(CAMViewfinderViewController *)self _updateZoomUIWithZoomFactor:0 animated:a4];
        [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
        [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:0];
      }
    }
  }
}

- (unint64_t)_fullscreenViewfinderZoomStyle
{
  if (![(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    return 0;
  }

  if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
  {
    return 1;
  }

  return 2;
}

- (void)_updateFullscreenViewfinderZoomSliderIfNecessary
{
  v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([v9 zoomStyle] == 2)
  {
    v3 = [v9 zoomSlider];
    [v3 setMinimumValue:0.0];

    v4 = [v9 zoomSlider];
    LODWORD(v5) = 1.0;
    [v4 setMaximumValue:v5];

    v6 = [(CAMViewfinderViewController *)self _shouldEnableZoomSlider];
    v7 = [v9 zoomSlider];
    [v7 setEnabled:v6];

    v8 = [v9 zoomSlider];
    [v8 setAlpha:0.0];
  }
}

- (void)_updateZoomUIWithZoomFactor:(double)a3 animated:(BOOL)a4
{
  v4 = a4;
  [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:?];
  v8 = v7;
  *&v7 = v7;
  [(CAMZoomSlider *)self->__zoomSlider setValue:0 animated:v7];
  v9 = [(CAMViewfinderViewController *)self _zoomControl];
  v10 = [v9 allowsContinuousZoom];

  if (v10)
  {
    v11 = [(CAMViewfinderViewController *)self _zoomControl];
    [v11 setZoomFactor:a3];
  }

  v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _updateZoomButtonSymbolForMode:device:videoConfiguration:zoomFactor:videoStabilizationStrength:animated:](self, "_updateZoomButtonSymbolForMode:device:videoConfiguration:zoomFactor:videoStabilizationStrength:animated:", [v14 mode], objc_msgSend(v14, "device"), objc_msgSend(v14, "videoConfiguration"), objc_msgSend(v14, "videoStabilizationStrength"), v4, a3);
  v12 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v12 setZoomAmount:v8];

  v13 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v13 setZoomFactor:a3];
}

- (void)_updateZoomButtonSymbolForMode:(int64_t)a3 device:(int64_t)a4 videoConfiguration:(int64_t)a5 zoomFactor:(double)a6 videoStabilizationStrength:(int64_t)a7 animated:(BOOL)a8
{
  v8 = a8;
  v15 = +[CAMCaptureCapabilities capabilities];
  v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v17 = [v15 resolvedDeviceForDesiredDevice:a4 mode:a3 videoConfiguration:a5 videoStabilizationStrength:a7 frontRearSimultaneousVideoEnabled:{objc_msgSend(v16, "frontRearSimultaneousVideoEnabled")}];

  v18 = [(CAMViewfinderViewController *)self _zoomControl];
  if (v17 <= 0xB && ((0xFDu >> v17) & 1) == 0)
  {
    if (v18)
    {
      v25 = v18;
      v19 = [v18 zoomButtonContentType] == 1;
      v18 = v25;
      if (v19)
      {
        v20 = [v25 zoomButtonSymbol];
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 frontZoomBehaviorForCaptureMode:a3 videoConfiguration:a5];

        if ((v22 - 1) >= 2)
        {
          if (v22 == 3)
          {
            v20 = v17 != 10;
          }
        }

        else
        {
          v20 = fabs(a6 + -1.0) >= 0.001;
        }

        if ((a4 - 1) > 0xA)
        {
          v23 = 0;
        }

        else
        {
          v23 = qword_1A3A685B0[a4 - 1];
        }

        v24 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:a3 devicePosition:v23]- 1;
        if (v24 <= 3)
        {
          v20 = qword_1A3A68538[v24];
        }

        [v25 setZoomButtonSymbol:v20 animated:v8];
        v18 = v25;
      }
    }
  }
}

- (void)captureController:(id)a3 didOutputMinAvailableVideoZoomFactor:(double)a4
{
  v16 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    v6 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 134217984;
      v15 = a4;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Ignoring didOutputMinAvailableVideoZoomFactor:%f because we are waiting on an in-flight configuration", buf, 0xCu);
    }
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _zoomControl];
    v8 = [v7 allowsContinuousZoom];

    if (v8)
    {
      if (a4 == 1.0)
      {
        v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v10 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:v9];

        a4 = 1.0;
        if (v10)
        {
          v11 = [(CAMViewfinderViewController *)self _zoomControl];
          [v11 minimumZoomFactor];
          a4 = v12;
        }
      }

      v13 = [(CAMViewfinderViewController *)self _zoomControl];
      [v13 setMinAvailableZoomFactor:a4];
    }
  }
}

- (void)captureController:(id)a3 didChangeRampingVideoZoom:(BOOL)a4
{
  if (!a4)
  {
    [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:0];

    [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  }
}

- (void)captureController:(id)a3 didChangePreviewZoomPIPRect:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  v8 = [(CAMViewfinderViewController *)self _previewViewController];
  [v8 setNormalizedZoomPIPRect:{x, y, width, height}];
}

- (void)_changeToZoomFactor:(double)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 shouldAnimate:(BOOL)a6 updateOverlay:(BOOL)a7
{
  v7 = a6;
  v55 = *MEMORY[0x1E69E9840];
  v12 = [(CAMViewfinderViewController *)self _currentMode:a5];
  v13 = +[CAMCaptureCapabilities capabilities];
  v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v15 = [v14 devicePosition];
  v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v17 = [v13 isQuadraWideBinningReconfigurationSupportedForMode:v12 devicePosition:v15 videoConfiguration:{objc_msgSend(v16, "videoConfiguration")}];

  if (v12 != 6 || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v18 = objc_claimAutoreleasedReturnValue(), v19 = [v18 continuousZoomSupportedForPortraitMode] | v17, v18, (v19 & 1) != 0))
  {
    v51 = v7;
    v50 = a5;
    v20 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v52 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:v20];

    v21 = [(CAMViewfinderViewController *)self _captureController];
    v22 = [v21 isCapturingVideo];

    v23 = +[CAMCaptureCapabilities capabilities];
    v24 = [(CAMViewfinderViewController *)self _currentDevice];
    v25 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
    v26 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v27 = [v26 videoStabilizationStrength];
    v28 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v29 = [v23 resolvedDeviceForDesiredDevice:v24 mode:v12 videoConfiguration:v25 videoStabilizationStrength:v27 frontRearSimultaneousVideoEnabled:{objc_msgSend(v28, "frontRearSimultaneousVideoEnabled")}];

    v30 = 0;
    if (v29 == 2)
    {
      v31 = v17;
    }

    else
    {
      v31 = 0;
    }

    if (v31 == 1 && v12 == 6)
    {
      v32 = +[CAMCaptureCapabilities capabilities];
      v30 = [v32 continuousZoomSupportedForPortraitMode] ^ 1;
    }

    if (((v52 & (v22 ^ 1) & 1) != 0 || v30) && (v33 = -[CAMViewfinderViewController _currentVideoConfiguration](self, "_currentVideoConfiguration"), -[CAMViewfinderViewController _currentGraphConfiguration](self, "_currentGraphConfiguration"), v34 = objc_claimAutoreleasedReturnValue(), v35 = [v34 videoStabilizationStrength], -[CAMViewfinderViewController _currentGraphConfiguration](self, "_currentGraphConfiguration"), v36 = objc_claimAutoreleasedReturnValue(), v37 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", v12, v29, v33, v35, objc_msgSend(v36, "frontRearSimultaneousVideoEnabled"), 0, 0), v36, v34, v38 = +[CAMZoomControlUtilities deviceForEmulatingZoomFactor:fromDevice:mode:continuousZoomSupported:](CAMZoomControlUtilities, "deviceForEmulatingZoomFactor:fromDevice:mode:continuousZoomSupported:", v29, v12, v37, a3), +[CAMZoomControlUtilities zoomScaleFromDevice:toDevice:](CAMZoomControlUtilities, "zoomScaleFromDevice:toDevice:", v29, v38), (v38 != v29) | v30 & 1))
    {
      v40 = v39;
      [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
      [(CAMViewfinderViewController *)self _setVideoZoomFactorAtPinchStart:v40 * v41];
      [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
      [(CAMViewfinderViewController *)self _setVideoZoomFactorAtDynamicShutterStart:v40 * v42];
      [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:v12 device:v38 zoomFactor:v40 * a3];
    }

    else
    {
      [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:a3];
      [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:v51];
      [(CAMViewfinderViewController *)self _updateZoomUIWithZoomFactor:v51 animated:a3];
      v43 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v44 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateDepthEffectApertureForGraphConfiguration:v43 fromGraphConfiguration:v44 zoomFactor:a3];

      if ([(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
      {
        v45 = os_log_create("com.apple.camera", "Zoom");
        if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 134217984;
          v54 = a3;
          _os_log_impl(&dword_1A3640000, v45, OS_LOG_TYPE_DEFAULT, "Ignoring zoom change to %.3f during reconfiguration", buf, 0xCu);
        }
      }

      else
      {
        if (a4 > 0.0 || v50)
        {
          [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:1];
          captureController = self->__captureController;
          v47 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CUCaptureController *)captureController startRampToVideoZoomFactor:v50 withDuration:v47 zoomRampTuning:a3 graphConfiguration:a4];
        }

        else
        {
          v46 = self->__captureController;
          v47 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CUCaptureController *)v46 changeToVideoZoomFactor:v47 graphConfiguration:a3];
        }
      }

      [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
      if (v12 == 6 && ![(CAMViewfinderViewController *)self _currentDevicePosition])
      {
        v49 = +[CAMUserPreferences preferences];
        [v49 setPortraitModeRearDevice:{-[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [v49 setPortraitModeRearZoomValue:?];
      }
    }
  }
}

- (void)_resetZoom
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  v5 = [(CAMViewfinderViewController *)self _currentDevice];
  v6 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(v4) = [v3 isZoomAllowedForMode:v4 device:v5 videoConfiguration:v6 videoStabilizationStrength:{objc_msgSend(v7, "videoStabilizationStrength")}];

  if (v4)
  {
    v8 = [(CAMViewfinderViewController *)self _currentMode];
    v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", v8, [v9 devicePosition]);

    if (v10)
    {

      [(CAMViewfinderViewController *)self _resetSmartFramingFieldOfViewAnimated:0];
    }

    else
    {
      v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v11 = [(CAMViewfinderViewController *)self _motionController];
      -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", v14, [v11 captureOrientation]);
      v13 = v12;

      [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:0 zoomRampTuning:v13 shouldAnimate:0.0];
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }
  }
}

- (double)_defaultZoomFactorForGraphConfiguration:(id)a3 captureOrientation:(int64_t)a4
{
  v6 = a3;
  v7 = +[CAMUserPreferences preferences];
  [v7 defaultZoomFactorForGraphConfiguration:v6 captureOrientation:a4 outputToExternalStorage:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled")}];
  v9 = v8;

  return v9;
}

- (double)_zoomSliderValueForZoomFactor:(double)a3
{
  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
  v5 = v4;
  v6 = log(a3);
  return v6 / log(v5);
}

- (double)_zoomFactorForZoomSliderValue:(double)a3
{
  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];

  return pow(v4, a3);
}

- (void)_handleTouchDownForZoomSlider:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v4 cancelZoom];

  v5 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v5 didZoomInteraction:2];
}

- (void)_zoomSliderValueDidChange:(id)a3 forEvent:(id)a4
{
  v5 = [(CAMViewfinderViewController *)self _zoomSlider:a3];
  v6 = [v5 isAutozooming];

  if ((v6 & 1) == 0)
  {
    [(CAMZoomSlider *)self->__zoomSlider value];
    [(CAMViewfinderViewController *)self _zoomFactorForZoomSliderValue:v7];
    [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:?];

    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:2];
  }
}

- (void)_zoomUIDidChangeToFactor:(double)a3
{
  [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:?];
  [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:1];
  v12 = [(CAMViewfinderViewController *)self _captureController];
  if ([v12 isCapturingVideo])
  {
    v5 = 0.5;
  }

  else
  {
    v5 = 0.25;
  }

  [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:1];
  captureController = self->__captureController;
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CUCaptureController *)captureController startRampToVideoZoomFactor:3 withDuration:v7 zoomRampTuning:a3 graphConfiguration:v5];

  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  if (![(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice])
  {
    [(CAMZoomControl *)self->__zoomControl setZoomFactor:a3];
  }

  [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:a3];
  v9 = v8;
  v10 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v10 setZoomAmount:v9];

  v11 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [v11 setZoomFactor:a3];
}

- (BOOL)_isActiveZooming
{
  if ([(CAMViewfinderViewController *)self _isPinchingForZoom])
  {
    return 1;
  }

  v4 = [(CAMViewfinderViewController *)self _zoomControl];
  if ([v4 isTracking])
  {
    v3 = 1;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _zoomSlider];
    if ([v5 isTracking])
    {
      v3 = 1;
    }

    else
    {
      v6 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      v3 = [v6 isZooming];
    }
  }

  return v3;
}

- (BOOL)_isZooming
{
  if ([(CAMViewfinderViewController *)self _isActiveZooming])
  {
    return 1;
  }

  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 isRampingVideoZoom];

  return v5;
}

- (void)_handleZoomPinchGestureRecognizer:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [v4 state];
  if (v6 > 3)
  {
    if ((v6 - 4) < 2)
    {
      [(CAMZoomSlider *)self->__zoomSlider setVisibilityTimerSuspended:0];
      goto LABEL_8;
    }
  }

  else
  {
    switch(v6)
    {
      case 1:
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [(CAMViewfinderViewController *)self _setVideoZoomFactorAtPinchStart:?];
        v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [v9 cancelZoom];

        if ([v5 devicePosition] != 1)
        {
          if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
          {
            [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
          }

          else
          {
            [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
          }

          if (![(CAMViewfinderViewController *)self _shouldHideZoomSliderForGraphConfiguration:v5 ignoreExpiredVisibilityTimer:1])
          {
            v13 = [(CAMViewfinderViewController *)self _zoomSlider];
            [v13 makeVisibleAnimated:0];

            v14 = [(CAMViewfinderViewController *)self _zoomSlider];
            [v14 setVisibilityTimerSuspended:1];
          }
        }

        v15 = [(CAMViewfinderViewController *)self _zoomReporter];
        [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
        [v15 zoomBeganWithFactor:objc_msgSend(v5 device:"device") interactionType:{1, v16}];

        break;
      case 2:
        [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
        v11 = v10;
        [v4 zoomScale];
        v17[0] = MEMORY[0x1E69E9820];
        v17[1] = 3221225472;
        v17[2] = __65__CAMViewfinderViewController__handleZoomPinchGestureRecognizer___block_invoke;
        v17[3] = &unk_1E76F99C0;
        v17[4] = self;
        [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:1 rampDuration:v17 interactionType:v11 * v12 didChangeDevice:0.0];
        break;
      case 3:
        [(CAMViewfinderViewController *)self _updateFocusAfterZoomIfNecessary];
        [(CAMZoomSlider *)self->__zoomSlider setVisibilityTimerSuspended:0];
        v7 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
        [v7 didZoomInteraction:1];

LABEL_8:
        v8 = [(CAMViewfinderViewController *)self _zoomReporter];
        [v8 zoomEndedFromSource:1];

        break;
    }
  }
}

uint64_t __65__CAMViewfinderViewController__handleZoomPinchGestureRecognizer___block_invoke(uint64_t a1, double a2)
{
  v3 = *(a1 + 32);
  [v3 _videoZoomFactorAtPinchStart];
  v5 = v4 * a2;

  return [v3 _setVideoZoomFactorAtPinchStart:v5];
}

- (void)_updateZoomFactorForZoomFactor:(double)a3 rampDuration:(double)a4 interactionType:(int64_t)a5 didChangeDevice:(id)a6
{
  v64 = a6;
  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [v10 mode];
  v12 = [v10 device];
  v13 = [v10 devicePosition];
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSmartFramingSupportedForMode:v11 devicePosition:{objc_msgSend(v10, "devicePosition")}];

  if (v13 == 1)
  {
    v16 = +[CAMCaptureCapabilities capabilities];
    v17 = [v16 frontZoomBehaviorForCaptureMode:objc_msgSend(v10 videoConfiguration:{"mode"), objc_msgSend(v10, "videoConfiguration")}];

    v18 = v17 > 3;
    v19 = 2u >> (v17 & 0xF);
    if (v17 <= 3)
    {
      v20 = 8u >> (v17 & 0xF);
    }

    else
    {
      v20 = 0;
    }

    if (v17 <= 3)
    {
      v21 = 4u >> (v17 & 0xF);
    }

    else
    {
      v21 = 0;
    }

    if (v18)
    {
      v22 = 0;
    }

    else
    {
      v22 = v19;
    }
  }

  else
  {
    v20 = 0;
    v21 = 0;
    v22 = 0;
  }

  if ((a5 - 1) > 6)
  {
    v23 = 0;
  }

  else
  {
    v23 = qword_1A3A68558[a5 - 1];
  }

  if ((v21 | v22))
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v25 = v24;
    v26 = +[CAMCaptureCapabilities capabilities];
    [v26 maximumZoomFactorForMode:v11 device:v12 videoConfiguration:objc_msgSend(v10 videoStabilizationStrength:{"videoConfiguration"), objc_msgSend(v10, "videoStabilizationStrength")}];
    v28 = v27;

    v29 = fabs(v25 + -1.0) < 0.001;
    if (v28 > a3)
    {
      v29 = 0;
    }

    if (v29 || vabdd_f64(v25, v28) >= 0.001)
    {
      if (v29)
      {
        v30 = v28;
      }

      else
      {
        v30 = -1.0;
      }

      if (v30 <= 0.0)
      {
        goto LABEL_76;
      }
    }

    else
    {
      v30 = 1.0;
      if (a3 > 1.0)
      {
        goto LABEL_76;
      }
    }

    if (v22)
    {
      [(CAMViewfinderViewController *)self _changeToZoomFactor:1 rampDuration:1 zoomRampTuning:v30 shouldAnimate:0.25];
    }

    else if (v21)
    {
      [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];
      [(CAMViewfinderViewController *)self handleUserChangedToMode:v11 device:v12 zoomFactor:v30];
      v40.n128_u64[0] = 1.0;
      v64[2](v40);
    }

LABEL_75:
    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:a5];
    goto LABEL_76;
  }

  if ((v20 & 1) == 0)
  {
    if (!v15)
    {
      if ([(CAMViewfinderViewController *)self _isZoomAllowedCurrently])
      {
        v41 = [(CAMViewfinderViewController *)self _zoomControl];
        if (v41)
        {
          v42 = [(CAMViewfinderViewController *)self _zoomControl];
          [v42 minAvailableZoomFactor];
          v44 = v43;
        }

        else
        {
          v44 = 1.0;
        }

        v56 = [(CAMViewfinderViewController *)self _zoomControl];
        if (v56)
        {
          v57 = [(CAMViewfinderViewController *)self _zoomControl];
          [v57 maxAvailableZoomFactor];
          v59 = v58;
        }

        else
        {
          [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
          v59 = v60;
        }

        if (v59 >= a3)
        {
          v61 = a3;
        }

        else
        {
          v61 = v59;
        }

        if (v61 >= v44)
        {
          v62 = v61;
        }

        else
        {
          v62 = v44;
        }

        [(CAMViewfinderViewController *)self _changeToZoomFactor:v23 rampDuration:1 zoomRampTuning:v62 shouldAnimate:a4];
        v63 = [(CAMViewfinderViewController *)self _zoomReporter];
        [v63 zoomChangedToFactor:v12 device:a5 interactionType:v62];

        goto LABEL_75;
      }

      v46 = +[CAMCaptureCapabilities capabilities];
      v47 = [v46 resolvedDeviceForDesiredDevice:v12 mode:v11 videoConfiguration:objc_msgSend(v10 videoStabilizationStrength:"videoConfiguration") frontRearSimultaneousVideoEnabled:{objc_msgSend(v10, "videoStabilizationStrength"), objc_msgSend(v10, "frontRearSimultaneousVideoEnabled")}];

      v48 = [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v47 fromDevice:v11 mode:0 continuousZoomSupported:a3];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [CAMZoomControlUtilities appropriateSignificantZoomFactorForDevice:"appropriateSignificantZoomFactorForDevice:fromDevice:currentZoomFactor:targetZoomFactor:mode:" fromDevice:v48 currentZoomFactor:v47 targetZoomFactor:v11 mode:?];
      v50 = v49;
      if (v48 != v47 || ([(CAMViewfinderViewController *)self _cachedVideoZoomFactor], v51 != v50))
      {
        [(CAMViewfinderViewController *)self handleUserChangedToMode:v11 device:v48 zoomFactor:v50];
        [CAMZoomControlUtilities zoomScaleFromDevice:v47 toDevice:v48];
        (v64[2])();
        [(CAMViewfinderViewController *)self _setLastZoomInteractionType:a5];
        v47 = v48;
      }

      v52 = [(CAMViewfinderViewController *)self _zoomReporter];
      [v52 zoomChangedToFactor:v47 device:a5 interactionType:v50];

      goto LABEL_76;
    }

    v35 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", v11, [v10 devicePosition]);
    v36 = +[CAMCaptureCapabilities capabilities];
    v37 = v36;
    if (v35 > 2)
    {
      if (v35 != 3)
      {
        if (v35 != 4)
        {
          goto LABEL_63;
        }

        [v36 smartFramingFieldOfViewZoomedOutLandscapeZoomFactor];
        if (v45 < a3)
        {
          goto LABEL_63;
        }

        v39 = 3;
        goto LABEL_62;
      }

      [v36 smartFramingFieldOfViewLandscapeZoomFactor];
      if (v54 <= a3)
      {
        v39 = 4;
        goto LABEL_62;
      }
    }

    else
    {
      if (v35 != 1)
      {
        if (v35 != 2)
        {
          goto LABEL_63;
        }

        [v36 smartFramingFieldOfViewPortraitZoomFactor];
        if (v38 > a3)
        {
          goto LABEL_63;
        }

        v39 = 1;
        goto LABEL_62;
      }

      [v36 smartFramingFieldOfViewZoomedOutPortraitZoomFactor];
      if (v53 >= a3)
      {
        v39 = 2;
LABEL_62:
        [(CAMViewfinderViewController *)self set_desiredFieldOfView:v39];
        [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
        v55 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v55 rampDuration:v23 zoomRampTuning:1 animated:a4];
      }
    }

LABEL_63:

    goto LABEL_76;
  }

  v31 = 10;
  if (a3 > 0.5)
  {
    v31 = v12;
  }

  if (v12 != 10 || a3 < 2.0)
  {
    v33 = v31;
  }

  else
  {
    v33 = 8;
  }

  if (v33 != v12)
  {
    [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];
    [(CAMViewfinderViewController *)self handleUserChangedToMode:v11 device:v33];
    [CAMZoomControlUtilities zoomScaleFromDevice:v12 toDevice:v33];
    v64[2](v34);
    goto LABEL_75;
  }

LABEL_76:
}

- (void)zoomSliderDidBeginAutozooming:(id)a3
{
  captureController = self->__captureController;
  v5 = a3;
  if ([(CUCaptureController *)captureController isCapturingVideo])
  {
    v6 = 0.75;
  }

  else
  {
    v6 = 1.5;
  }

  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
  v8 = v7;
  v9 = [v5 isMinimumAutozooming];

  if (v9)
  {
    v8 = 1.0;
  }

  [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:0];
  v10 = self->__captureController;
  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  *&v12 = v6;
  [(CUCaptureController *)v10 startRampToVideoZoomFactor:v11 withRate:v8 graphConfiguration:v12];

  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (void)willShowZoomSlider:(id)a3 withAnimationDuration:(double)a4
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:a3];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];
}

- (void)willHideZoomSlider:(id)a3 withAnimationDuration:(double)a4
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:a3];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];
}

- (void)_updateFocusAfterZoomIfNecessary
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  if (v3 <= 8 && ((1 << v3) & 0x107) != 0)
  {
    v4 = [(CAMViewfinderViewController *)self _captureController];
    if ([v4 isCapturingVideo])
    {
      [v4 focusAtCenterForVideoRecording];
    }
  }
}

- (void)_configureZoomControlForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v6])
  {
    v64 = v4;
    v7 = [(CAMViewfinderViewController *)self _zoomControl];
    v8 = [v6 videoStabilizationStrength];
    if (v8 <= 3)
    {
      [v7 setHideFocalLengthLabels:(0xCu >> (v8 & 0xF)) & 1];
    }

    v9 = [v6 mode];
    v10 = [v6 device];
    if ((v10 - 1) > 0xA)
    {
      v11 = 0;
    }

    else
    {
      v11 = qword_1A3A685B0[v10 - 1];
    }

    v12 = [v6 videoConfiguration];
    v13 = +[CAMCaptureCapabilities capabilities];
    v14 = [v13 resolvedDeviceForDesiredDevice:v10 mode:v9 videoConfiguration:v12 videoStabilizationStrength:objc_msgSend(v6 frontRearSimultaneousVideoEnabled:{"videoStabilizationStrength"), objc_msgSend(v6, "frontRearSimultaneousVideoEnabled")}];
    v15 = [v13 isZoomAllowedForMode:v9 device:v14 videoConfiguration:v12 videoStabilizationStrength:{objc_msgSend(v6, "videoStabilizationStrength")}];
    v16 = [v13 shouldAllowCameraToggleForMode:v9 devicePosition:v11 videoConfiguration:v12 videoStabilizationStrength:objc_msgSend(v6 frontRearSimultaneousVideoEnabled:{"videoStabilizationStrength"), objc_msgSend(v6, "frontRearSimultaneousVideoEnabled")}];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v18 = v17;
    v19 = [v13 isQuadraWideBinningReconfigurationSupportedForMode:v9 devicePosition:v11 videoConfiguration:v12];
    if (v15)
    {
      v20 = [(CAMViewfinderViewController *)self currentPhotoFormat];
      if ([v13 isDepthSuggestionSupportedForMode:v9 devicePosition:v11 photoFormat:v20, v21] && -[CAMViewfinderViewController _depthEffectEnabledFromSuggestion](self, "_depthEffectEnabledFromSuggestion"))
      {
        if (([v13 portraitInPhotoModeBehavior] & 4) != 0)
        {
          v22 = 6;
        }

        else
        {
          v22 = v9;
        }

        v61 = ([v13 portraitInPhotoModeBehavior] >> 1) & 1;
      }

      else
      {
        v61 = 0;
        v22 = v9;
      }

      v29 = [(CAMViewfinderViewController *)self _useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:v6];
      v30 = v7;
      if ([v6 trueVideoEnabled] && !v29)
      {
        v22 = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      }

      v66 = 0;
      v67 = 0;
      v31 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", v22, v14, v12, [v6 videoStabilizationStrength], objc_msgSend(v6, "frontRearSimultaneousVideoEnabled"), &v67, &v66);
      v32 = v67;
      v33 = v66;
      if (v31)
      {
        v34 = +[CAMUserPreferences preferences];
        if (v61 & 1 | (([v13 isCustomLensSupportedForMode:v9 device:v14 isTrueVideo:{objc_msgSend(v6, "trueVideoEnabled")}] & 1) == 0))
        {
          v35 = 0;
        }

        else
        {
          v35 = [v34 customLensGroup];
        }

        v57 = [CAMZoomPoint zoomPointsWithFactors:v32 displayZoomFactors:v33 customLensGroup:v35];
        v7 = v30;
        if (v9 == 6 && ([v13 continuousZoomSupportedForPortraitMode] & 1) != 0)
        {
          v61 = 1;
        }

        [v30 setPreferredCustomLens:{objc_msgSend(v34, "defaultCustomLens")}];
        [v30 configureForContinuousZoomWithZoomFactor:v57 zoomPoints:0 createButtonForMaxZoomFactor:v61 compactPlatterLayout:v64 animated:v18];
      }

      else
      {
        v7 = v30;
        if (!((v14 > 0xB) | (0xFDu >> v14) & 1))
        {
          v54 = [v30 zoomButtonContentType] == 1 && v64;
          [v30 configureForZoomSymbolToggle];
          v55 = [v6 videoStabilizationStrength];
          v56 = v54;
          v7 = v30;
          [(CAMViewfinderViewController *)self _updateZoomButtonSymbolForMode:v9 device:v14 videoConfiguration:v12 zoomFactor:v55 videoStabilizationStrength:v56 animated:v18];
        }
      }
    }

    else
    {
      if (v14 == 2)
      {
        v23 = v19;
      }

      else
      {
        v23 = 0;
      }

      if (v23 == 1 && v9 == 6)
      {
        [v13 maximumZoomFactorForMode:6 device:2 videoConfiguration:v12 videoStabilizationStrength:{objc_msgSend(v6, "videoStabilizationStrength")}];
        v25 = v24;
        [v13 quadraWideRelativeZoomFactor];
        v27 = v25 * v26;
        [v13 wideDisplayZoomFactor];
        [v7 configureForSingleCameraToggleOnlyWithZoomFactor:v18 minimumZoomFactor:1.0 displayMinimumZoomFactor:v28 maximumZoomFactor:v27 displayMaximumZoomFactor:v27];
      }

      else if (v16)
      {
        v63 = v7;
        v36 = [v13 isSuperWideSupportedForDevicePosition:v11];
        v62 = [v13 isTelephotoSupportedForDevicePosition:v11];
        v37 = [v13 isDualDeviceDisparitySupportedForMode:v9 devicePosition:v11];
        v60 = [v13 isQuadraWideZoomButtonSupportedForMode:v9 devicePosition:v11 videoConfiguration:v12];
        v38 = [v13 isQuadraTeleZoomButtonSupportedForMode:v9 devicePosition:v11 videoConfiguration:v12];
        [v13 quadraWideDisplayZoomFactor];
        v40 = v39;
        if ([v13 isZoomPlatterSupportedForMode:v9 devicePosition:v11 videoConfiguration:v12])
        {
          v59 = v38;
          v41 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:4];
          if (!(v37 & 1 | ((v36 & 1) == 0)))
          {
            v42 = MEMORY[0x1E696AD98];
            [v13 superWideDisplayZoomFactor];
            v43 = [v42 numberWithDouble:?];
            [v41 addObject:v43];
          }

          v44 = MEMORY[0x1E696AD98];
          [v13 wideDisplayZoomFactor];
          v45 = [v44 numberWithDouble:?];
          [v41 addObject:v45];

          if (v60)
          {
            v46 = [MEMORY[0x1E696AD98] numberWithDouble:v40];
            [v41 addObject:v46];
          }

          if (v62)
          {
            v47 = MEMORY[0x1E696AD98];
            [v13 telephotoDisplayZoomFactor];
            v48 = [v47 numberWithDouble:?];
            [v41 addObject:v48];
          }

          if (v59)
          {
            v49 = MEMORY[0x1E696AD98];
            [v13 quadraTeleDisplayZoomFactor];
            v50 = [v49 numberWithDouble:?];
            [v41 addObject:v50];
          }

          +[CAMZoomControlUtilities zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", v9, v14, v12, [v6 videoStabilizationStrength], objc_msgSend(v6, "frontRearSimultaneousVideoEnabled"), v18);
          v65[0] = MEMORY[0x1E69E9820];
          v65[1] = 3221225472;
          v65[2] = __83__CAMViewfinderViewController__configureZoomControlForGraphConfiguration_animated___block_invoke;
          v65[3] = &__block_descriptor_40_e25_B32__0__NSNumber_8Q16_B24l;
          v65[4] = v51;
          v52 = [v41 indexOfObjectPassingTest:v65];
          v53 = [v41 count] >= 2 && -[CAMViewfinderViewController _wantsLightingControlForGraphConfiguration:](self, "_wantsLightingControlForGraphConfiguration:", v6);
          v7 = v63;
          [v63 configureForSelectionOnlyWithDisplayZoomFactors:v41 selectedIndex:v52 compactPlatterLayout:v53 animated:v64];
        }

        else
        {
          +[CAMZoomControlUtilities zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", v9, v14, v12, [v6 videoStabilizationStrength], objc_msgSend(v6, "frontRearSimultaneousVideoEnabled"), 1.0);
          v7 = v63;
          [v63 configureForToggleOnlyWithZoomFactor:1.0 displayZoomFactor:v58];
        }
      }
    }
  }
}

- (void)_updateZoomControlAccessoryStateAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]- 9) < 2;
  v6 = [(CAMViewfinderViewController *)self _zoomControl];
  [v6 setZoomButtonAccessoryState:v5 animated:v3];
}

- (void)_handleTouchDownForZoomControl:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v3 cancelZoom];
}

- (void)zoomControl:(id)a3 didChangeZoomFactor:(double)a4 interactionType:(int64_t)a5
{
  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = 3;
  if (a5 != 1)
  {
    v8 = 0;
  }

  if (a5)
  {
    v9 = v8;
  }

  else
  {
    v9 = 2;
  }

  [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:a5 interactionType:a4];
  v10 = [(CAMViewfinderViewController *)self _zoomReporter];
  [v10 zoomChangedToFactor:objc_msgSend(v11 device:"device") interactionType:{v9, a4}];
}

- (void)_zoomControlDidChangeZoomFactor:(double)a3 interactionType:(int64_t)a4
{
  v23 = *MEMORY[0x1E69E9840];
  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v7])
  {
    v8 = [(CAMViewfinderViewController *)self _captureController];
    v9 = [v8 isCapturingVideo];

    if (a4 == 1)
    {
      if (v9)
      {
        v16 = 0.2;
      }

      else
      {
        v16 = 0.1;
      }

      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      v10 = v16 * fabs(log(a3 / v17) / 0.693147181);
      v12 = 1;
      v11 = 3;
    }

    else
    {
      v10 = 0.25;
      if (v9)
      {
        v10 = 0.5;
      }

      if (a4)
      {
        v10 = 0.0;
        v11 = 0;
      }

      else
      {
        v11 = 2;
      }

      if (a4)
      {
        v12 = 0;
      }

      else
      {
        v12 = 3;
      }
    }

    [(CAMViewfinderViewController *)self _changeToZoomFactor:v12 rampDuration:0 zoomRampTuning:a3 shouldAnimate:v10];
    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:v11];
    if (a4 == 1)
    {
      v18 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      [v18 didZoomInteraction:3];
    }
  }

  else
  {
    v13 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = @"tap";
      if (a4 != 1)
      {
        v14 = 0;
      }

      if (!a4)
      {
        v14 = @"drag";
      }

      v15 = v14;
      v19 = 138543618;
      v20 = v15;
      v21 = 2114;
      v22 = v7;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Ignoring zoom control %{public}@ because zoom control should not be enabled for %{public}@", &v19, 0x16u);
    }
  }
}

- (BOOL)canToggleBetweenZoomFactorsForZoomControl:(id)a3
{
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== 1)
  {
    LOBYTE(v4) = 1;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _captureController];
    v4 = [v5 isCapturingVideo] ^ 1;
  }

  return v4;
}

- (void)toggleBetweenZoomFactorsForZoomControl:(id)a3
{
  v16 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:v5];

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [v7 mode];
    v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", v8, [v9 devicePosition]);

    if (v10)
    {
      [(CAMViewfinderViewController *)self _toggleZoomForSmartFramingFieldOfView:v10];
    }

    else
    {
      v13 = [(CAMViewfinderViewController *)self _currentDevicePosition];
      if (v13 == 1)
      {
        [(CAMViewfinderViewController *)self _toggleBetweenFrontFacingZoomFactorsForZoomControl:v4];
      }

      else if (!v13)
      {
        [(CAMViewfinderViewController *)self _toggleBetweenBackFacingZoomFactorsForZoomControl:v4];
      }
    }
  }

  else
  {
    v11 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v14 = 138543362;
      v15 = v12;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Ignoring zoom control tap because zoom control should not be enabled for %{public}@", &v14, 0xCu);
    }
  }
}

- (void)_toggleZoomForSmartFramingFieldOfView:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [v5 isReticleAnimating];

  if (v6)
  {
    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v11 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Ignoring smart framing zoom toggle, reticle animating", v11, 2u);
    }
  }

  else
  {
    if ((a3 - 1) <= 3)
    {
      [(CAMViewfinderViewController *)self set_desiredFieldOfView:qword_1A3A68590[a3 - 1]];
    }

    v8 = +[CAMCaptureCapabilities capabilities];
    [v8 zoomFactorForSmartFramingFieldOfView:{-[CAMViewfinderViewController _desiredFieldOfView](self, "_desiredFieldOfView")}];
    v10 = v9;

    [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:1 interactionType:v10];

    [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
  }
}

- (void)_toggleBetweenBackFacingZoomFactorsForZoomControl:(id)a3
{
  v20 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [v20 mode];
  v5 = [v20 device];
  v6 = [v20 devicePosition];
  v7 = [v20 videoConfiguration];
  v8 = [v20 videoStabilizationStrength];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isTelephotoSupportedForDevicePosition:v6];
  v11 = [v9 isDualSupportedForMode:v4 devicePosition:v6 videoConfiguration:v7 videoStabilizationStrength:v8];
  v12 = [v9 isSuperWideSupportedForDevicePosition:v6];
  v13 = [v9 isWideDualSupportedForMode:v4 devicePosition:v6 videoConfiguration:v7 videoStabilizationStrength:v8];
  if (v5 > 3)
  {
    v14 = 4;
    if (v13)
    {
      v14 = 6;
    }

    v15 = 2;
    v18 = 4;
    if (v5 != 6)
    {
      v18 = v5;
    }

    if (v5 != 5)
    {
      v15 = v18;
    }

    v17 = v5 == 4;
  }

  else
  {
    v14 = 5;
    if (!v12)
    {
      v14 = 0;
    }

    if (v10)
    {
      v14 = 3;
    }

    if ((v13 & v11) != 0)
    {
      v14 = 6;
    }

    v15 = 2;
    if (v12)
    {
      v15 = 5;
    }

    if (v10)
    {
      v15 = 3;
    }

    v16 = 2;
    if (v12)
    {
      v16 = 5;
    }

    if (v5 != 3)
    {
      v16 = v5;
    }

    if (v5 != 2)
    {
      v15 = v16;
    }

    v17 = v5 == 0;
  }

  if (v17)
  {
    v19 = v14;
  }

  else
  {
    v19 = v15;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToMode:v4 device:v19];
  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (void)_toggleBetweenFrontFacingZoomFactorsForZoomControl:(id)a3
{
  v4 = a3;
  v18 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v18 mode];
  v6 = [v18 device];
  v7 = [v18 devicePosition];
  v8 = [v18 videoConfiguration];
  v9 = [v4 zoomButtonSymbol];

  v10 = +[CAMCaptureCapabilities capabilities];
  v11 = [v10 isSuperWideSupportedForDevicePosition:v7];

  v12 = +[CAMCaptureCapabilities capabilities];
  v13 = v12;
  if (v11)
  {
    [v12 superWideToWideZoomFactorForDevicePosition:v7];
  }

  else
  {
    [v12 maximumZoomFactorForMode:v5 device:v6 videoConfiguration:v8 videoStabilizationStrength:{objc_msgSend(v18, "videoStabilizationStrength")}];
  }

  v15 = v14;

  v16 = v15 + 0.01;
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  if (v9 == 1)
  {
    v17 = v17 / v16;
  }

  else if (!v9)
  {
    v17 = v17 * v16;
  }

  [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:3 rampDuration:&__block_literal_global_1195 interactionType:v17 didChangeDevice:0.25];
}

- (void)zoomControl:(id)a3 didChangeSelectedButtonIndex:(unint64_t)a4 displayZoomFactor:(double)a5
{
  v7 = a3;
  v8 = [(CAMViewfinderViewController *)self _currentMode];
  v9 = [(CAMViewfinderViewController *)self _deviceForSelectButtonZoomDisplayZoomFactor:a5];
  [(CAMViewfinderViewController *)self _zoomFactorForSelectButtonDisplayZoomFactor:v9 device:a5];
  v11 = v10;
  [v7 setZoomButtonAccessoryState:0 animated:1];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:v8 device:v9 zoomFactor:v11];

  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (int64_t)_deviceForSelectButtonZoomDisplayZoomFactor:(double)a3
{
  v5 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v6 = [(CAMViewfinderViewController *)self _currentDevice];
  v7 = [(CAMViewfinderViewController *)self _currentMode];
  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 isDualDeviceDisparitySupportedForMode:v7 devicePosition:v5];
  if (!v5)
  {
    v10 = v9;
    [v8 superWideDisplayZoomFactor];
    if (v11 == a3)
    {
      v6 = 5;
      goto LABEL_12;
    }

    [v8 wideDisplayZoomFactor];
    if (v12 == a3)
    {
      goto LABEL_5;
    }

    [v8 telephotoDisplayZoomFactor];
    if (v13 == a3)
    {
      goto LABEL_9;
    }

    [v8 quadraWideDisplayZoomFactor];
    if (v15 == a3)
    {
LABEL_5:
      if (v10)
      {
        v6 = 6;
      }

      else
      {
        v6 = 2;
      }

      goto LABEL_12;
    }

    [v8 quadraTeleDisplayZoomFactor];
    if (v16 == a3)
    {
LABEL_9:
      if (v10)
      {
        v6 = 4;
      }

      else
      {
        v6 = 3;
      }
    }

    else
    {
      v17 = os_log_create("com.apple.camera", "Zoom");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _deviceForSelectButtonZoomDisplayZoomFactor:];
      }
    }
  }

LABEL_12:

  return v6;
}

- (double)_zoomFactorForSelectButtonDisplayZoomFactor:(double)a3 device:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [(CAMViewfinderViewController *)self _currentMode];
  if ((a4 - 1) > 0xA)
  {
    v9 = 0;
  }

  else
  {
    v9 = qword_1A3A685B0[a4 - 1];
  }

  v10 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  if (![v7 isDualDeviceDisparitySupportedForMode:v8 devicePosition:v9])
  {
    if ([v7 isQuadraWideZoomButtonSupportedForMode:v8 devicePosition:v9 videoConfiguration:v10] && (objc_msgSend(v7, "quadraWideDisplayZoomFactor"), v13 == a3))
    {
      [v7 quadraWideRelativeZoomFactor];
    }

    else
    {
      v11 = 1.0;
      if (![v7 isQuadraTeleZoomButtonSupportedForMode:v8 devicePosition:v9 videoConfiguration:v10])
      {
        goto LABEL_16;
      }

      [v7 quadraTeleDisplayZoomFactor];
      if (v15 != a3)
      {
        goto LABEL_16;
      }

      [v7 quadraTeleRelativeZoomFactor];
    }

    v11 = v14;
    goto LABEL_16;
  }

  if (a4 == 4)
  {
    v11 = a3;
  }

  else
  {
    v11 = 1.0;
    if (a4 == 6)
    {
      [v7 superWideToWideZoomFactorForDevicePosition:0];
      v11 = v12 * a3;
    }
  }

LABEL_16:

  return v11;
}

- (BOOL)zoomControlShouldSnapDialToSwitchOverZoomFactors:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _captureController];
  v5 = [v4 isCapturingVideo];

  v6 = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(v4) = [v6 isCapturingLivePhotoVideo];

  return ((v5 | v4) & 1) == 0;
}

- (BOOL)_shouldAllowHapticsForCurrentState
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingVideo];

  return v3 ^ 1;
}

- (void)zoomControlDidChangeShowingZoomDial:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];

  LODWORD(v5) = [v4 isShowingZoomDial];
  if (v5)
  {
    v6 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [v6 didZoomInteraction:2];
  }
}

- (void)zoomControlDidChangePlatterExpanded:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:v4 animated:1];
}

- (unint64_t)zoomControl:(id)a3 accessoryButtonTapIndexInDisplayZoomFactors:(id)a4
{
  v5 = a4;
  if ([a3 zoomButtonAccessoryState] == 1)
  {
    if ([v5 count] < 2)
    {
      v6 = 0;
    }

    else
    {
      v6 = [v5 indexOfObject:&unk_1F16C8A58];
    }
  }

  else
  {
    v6 = 0x7FFFFFFFFFFFFFFFLL;
  }

  return v6;
}

- (void)zoomControlDidTapZoomButtonAccessory:(id)a3
{
  v3 = a3;
  if ([v3 zoomButtonAccessoryState] == 1)
  {
    [v3 setZoomButtonAccessoryState:0 animated:1];
  }
}

- (void)lightingControlDidChangeSelectedLightingType:(id)a3
{
  v4 = [a3 selectedLightingType];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = [(CAMViewfinderViewController *)self _currentMaxPhotoResolution];
  [(CAMViewfinderViewController *)self _setLightingType:v4 forMode:v5];
  v13 = +[CAMCaptureCapabilities capabilities];
  if ([v13 smartStylesSupported])
  {
    [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
    [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  }

  if ([(CAMViewfinderViewController *)self _currentMaxPhotoResolution]!= v6)
  {
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
    [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
  }

  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  v7 = [(CAMViewfinderViewController *)self _lightingNameBadge];
  [v7 setLightingType:v4];

  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [v8 lightingNameBadge];
  [v9 setLightingType:v4];

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  v10 = [(CAMViewfinderViewController *)self _previewViewController];
  [v10 setLightingType:v4 animated:1];

  v11 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v11 didChangePortraitLighting];

  v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:v12];
}

- (void)lightingControl:(id)a3 willChangeExpanded:(BOOL)a4
{
  v4 = a4;
  v15 = a3;
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  v7 = [v6 previewView];

  if (v4)
  {
    v8 = [(CAMViewfinderViewController *)self _currentMode];
    v9 = [CAMUserPreferences defaultFilterTypeForMode:v8];
    v10 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:v8];
    [(CAMViewfinderViewController *)self _setEffectFilterType:v9 forMode:v8];
    -[CAMViewfinderViewController _setLightingType:forMode:](self, "_setLightingType:forMode:", [v15 selectedLightingType], v8);
    if (v10 != v9)
    {
      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
    }

    v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:v11];

    [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:1];
  }

  v12 = [(CAMViewfinderViewController *)self _layoutStyle];
  v13 = 0.0;
  if ((v12 == 3 || !v12) && v4)
  {
    [v15 frame];
    [v15 alignmentRectForFrame:?];
    v13 = v14;
  }

  [v7 setBottomContentInset:v13];
}

- (void)lightingControlDidChangeExpanded:(id)a3
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];

  [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
}

- (void)captureController:(id)a3 receivedOverlayChangeSmartStyle:(id)a4
{
  v21 = *MEMORY[0x1E69E9840];
  v5 = a4;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 9) != 0)
  {
    if ((v7 & 8) != 0)
    {
      v9 = [(CAMViewfinderViewController *)self _semanticStyles];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __81__CAMViewfinderViewController_captureController_receivedOverlayChangeSmartStyle___block_invoke;
      v15[3] = &unk_1E76F91A8;
      v10 = v5;
      v16 = v10;
      v11 = [v9 indexOfObjectPassingTest:v15];

      if (v11 == 0x7FFFFFFFFFFFFFFFLL)
      {
        v12 = os_log_create("com.apple.camera", "SmartStyle");
        if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
        {
          v13 = [(CAMViewfinderViewController *)self _semanticStyles];
          *buf = 138543618;
          v18 = v10;
          v19 = 2114;
          v20 = v13;
          _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Received overlay update for style %{public}@ that is not in array of styles: %{public}@", buf, 0x16u);
        }
      }

      else
      {
        [(CAMViewfinderViewController *)self _setSelectedSemanticStyleIndex:v11];
        v12 = [(CAMViewfinderViewController *)self _semanticStyles];
        [v12 setObject:v10 atIndexedSubscript:[(CAMViewfinderViewController *)self _selectedSemanticStyleIndex]];
      }
    }

    else if (v7)
    {
      v8 = [(CAMViewfinderViewController *)self _semanticStyles];
      [v8 setObject:v5 atIndexedSubscript:{-[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];
    }

    [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
    v14 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [v14 didChangeValueForControlType:11];
  }
}

- (void)captureController:(id)a3 receivedOverlayUpdateSmartStyle:(id)a4
{
  v13 = a4;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v6 & 8) != 0)
  {
    v10 = [(CAMViewfinderViewController *)self _semanticStyles];
    v11 = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    goto LABEL_6;
  }

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    v8 = [(CAMViewfinderViewController *)self _semanticStyles];
    v9 = [v8 count];

    if (v7 < v9)
    {
      v10 = [(CAMViewfinderViewController *)self _semanticStyles];
      v11 = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
LABEL_6:
      [v10 setObject:v13 atIndexedSubscript:v11];
    }
  }

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
  v12 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [v12 didChangeValueForControlType:11];
}

- (void)captureController:(id)a3 receivedOverlayApertureControlActive:(BOOL)a4
{
  v4 = a4;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [(CAMViewfinderViewController *)self _currentMode];
  v8 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v9 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v6 isDepthSuggestionSupportedForMode:v7 devicePosition:v8 photoFormat:v9, v10];

  v12 = +[CAMUserPreferences preferences];
  v13 = [v12 shouldUseDepthSuggestionInPhotoMode];

  if (v4 && v11 && v13)
  {

    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:1];
  }
}

- (void)captureController:(id)a3 receivedSystemOverlayUpdateExposureBias:(double)a4
{
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  [v6 cachedExposureTargetBias];
  v8 = v7;

  v9 = a4 - v8;
  v10 = v9;

  [(CAMViewfinderViewController *)self _handleUserChangedToExposureSliderBias:0 updateSystemOverlayValues:v10];
}

- (void)captureController:(id)a3 receivedSystemOverlayLensSelectorZoomFactor:(double)a4
{
  v6 = *MEMORY[0x1E69938E8];
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== (v6 == a4))
  {
    if ([(CAMViewfinderViewController *)self _isReconfiguring])
    {

      [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:0 zoomRampTuning:0 shouldAnimate:a4 updateOverlay:0.0];
    }

    else
    {
      [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:1 interactionType:a4];
      v10 = [(CAMViewfinderViewController *)self _zoomReporter];
      [v10 zoomChangedToFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{7, a4}];
    }
  }

  else
  {
    v7 = +[CAMUserPreferences preferences];
    v8 = [v7 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), v6 == a4}];

    if (v6 == a4)
    {

      [(CAMViewfinderViewController *)self _handleUserChangedToDevice:v8];
    }

    else
    {
      v9 = [(CAMViewfinderViewController *)self _currentMode];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:v9 device:v8 zoomFactor:a4];
    }
  }
}

- (void)captureController:(id)a3 receivedOverlayVisible:(BOOL)a4
{
  v4 = a4;
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v6 setSystemOverlayVisible:v4 animated:1];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)captureController:(id)a3 receivedQuietUIActive:(BOOL)a4
{
  v4 = a4;
  v6 = a4;
  [(CAMViewfinderViewController *)self _setCurrentHalfPressSpotlight:a4];
  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v7 setSpotlightControl:v6 animated:1];

  v8 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v8 setIsQuietUIActive:v4];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];

  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Spotlight changed"];
}

- (void)captureController:(id)a3 receivedFocusLocked:(BOOL)a4
{
  v4 = a4;
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  [v6 setFocusAndExposureExternallyLocked:v4];

  if (v4)
  {
    v7 = [(CAMViewfinderViewController *)self _feedbackController];
    [v7 performDiscreteFeedback:2];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)captureController:(id)a3 willRecoverFromRuntimeError:(id)a4
{
  v4 = [(CAMViewfinderViewController *)self _closedViewfinderController:a3];
  [v4 addClosedViewfinderReason:5];
}

- (void)captureControllerDidStartRunning:(id)a3
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerDidStartRunning:", v11, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v5 removeClosedViewfinderReason:2];
  v6 = [(CAMViewfinderViewController *)self _disabledPreviewController];
  v7 = [v6 isPreviewDisabled];

  if ((v7 & 1) == 0)
  {
    [v5 removeClosedViewfinderReason:3 afterDelay:0.5];
  }

  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 shouldPreventConnectionHandover];

  if (v9)
  {
    v10 = [(CAMViewfinderViewController *)self _preventConnectionHandoverAssertionController];
    [v10 requestAssertionIfUnheld];
  }
}

- (void)captureControllerDidStopRunning:(id)a3
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerDidStopRunning:", v8, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v5 addClosedViewfinderReason:2];
  [v5 cancelDelayedRemovalOfReason:3];
  [v5 addClosedViewfinderReason:3];
  v6 = [(CAMViewfinderViewController *)self _previewViewController];
  [v6 notifyCaptureSessionDidStopRunning];
  [(CAMViewfinderViewController *)self _handleGeneralCaptureControllerSuspension];
  v7 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v7 resetNavigation];
  [v7 beginAllowingStagedMediaLoading];
}

- (void)_handleGeneralCaptureControllerSuspension
{
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  if (![(CAMViewfinderViewController *)self _isCapturingTimelapse])
  {
    v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v3 resetAnimated:1];
  }

  v4 = [(CAMViewfinderViewController *)self _controlDrawer];
  v5 = [v4 nightModeSlider];
  [v5 endCaptureAnimationAnimated:1];

  v6 = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
  [v6 cancelCountDown];

  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(v5) = [v7 shouldPreventConnectionHandover];

  if (v5)
  {
    v8 = [(CAMViewfinderViewController *)self _preventConnectionHandoverAssertionController];
    [v8 releaseAssertionIfHeld];
  }
}

- (void)captureControllerWasInterrupted:(id)a3
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerWasInterrupted:", v8, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v5 addClosedViewfinderReason:4];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }

  [(CAMViewfinderViewController *)self _handleGeneralCaptureControllerSuspension];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capture Controller Interrupted"];
  v6 = +[CAMCaptureCapabilities capabilities];
  if ([v6 isLongPressVideoCaptureFromPhotoModeSupported])
  {
    v7 = [(CAMViewfinderViewController *)self _currentMode];

    if (!v7)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:0];
    }
  }

  else
  {
  }
}

- (void)captureControllerInterruptionEnded:(id)a3
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerInterruptionEnded:", v7, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v5 removeClosedViewfinderReason:4];
  if (!+[CAMApplication appOrPlugInState])
  {
    v6 = [(CAMViewfinderViewController *)self _currentMode];
    [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:v6];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:v6];
  }

  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capture Controller Interruption Ended"];
}

- (void)prepareForDefaultImageSnapshotForScreen:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "prepareForDefaultImageSnapshotForScreen:", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _ensureSensitiveContentHidden];
  [(CAMViewfinderViewController *)self _forceHideBadgesAnimated:0];
  [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:0];
}

- (id)_debugStringForApplicationDeactivationReason:(int)a3
{
  if (a3 < 0x1F && ((0x4000FDFFu >> a3) & 1) != 0)
  {
    v3 = off_1E76FA038[a3];
  }

  else
  {
    v3 = [objc_alloc(MEMORY[0x1E696AEC0]) initWithFormat:@"Unknown deactivation reason %lu", a3];
  }

  return v3;
}

- (void)_handleApplicationWillAddDeactivationReason:(id)a3
{
  v15 = *MEMORY[0x1E69E9840];
  v4 = [a3 userInfo];
  v5 = [v4 objectForKeyedSubscript:*MEMORY[0x1E69DE838]];
  v6 = [v5 integerValue];

  v7 = [(CAMViewfinderViewController *)self _debugStringForApplicationDeactivationReason:v6];
  v8 = os_log_create("com.apple.camera", "DeactivationReasons");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v13 = 138543362;
    v14 = v7;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Will add deactivation reason %{public}@", &v13, 0xCu);
  }

  v9 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v10 = v9;
  switch(v6)
  {
    case 0:
    case 4:
    case 5:
    case 12:
    case 15:
      break;
    case 1:
      v11 = 12;
      goto LABEL_13;
    case 2:
      [v9 addClosedViewfinderReason:13];
      if ([(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
      {
        goto LABEL_15;
      }

      break;
    case 3:
      [v9 addClosedViewfinderReason:14];
      if ([(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
      {
        [(CAMViewfinderViewController *)self _stopRecordingForDeactivationReason:v7];
      }

      if ([(CAMViewfinderViewController *)self _currentMode]!= 6)
      {
        break;
      }

      v12 = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [v12 addDisabledPreviewReason:2];
      goto LABEL_21;
    case 6:
      v11 = 16;
      goto LABEL_13;
    case 7:
      [v9 addClosedViewfinderReason:17];
LABEL_15:
      [(CAMViewfinderViewController *)self _stopRecordingForDeactivationReason:v7];
      break;
    case 8:
      v11 = 18;
      goto LABEL_13;
    case 10:
      v12 = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_20;
      }

      goto LABEL_21;
    case 11:
      [v9 addClosedViewfinderReason:19];
      v12 = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [v12 removeDisabledPreviewReason:2];
      goto LABEL_21;
    case 13:
      v11 = 20;
LABEL_13:
      [v9 addClosedViewfinderReason:v11];
      break;
    default:
      v12 = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
LABEL_20:
        [CAMViewfinderViewController _handleApplicationWillAddDeactivationReason:];
      }

LABEL_21:

      break;
  }
}

- (void)_stopRecordingForDeactivationReason:(id)a3
{
  v13 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  v6 = [(CAMViewfinderViewController *)self _currentMode];
  if (v6 <= 8)
  {
    if (((1 << v6) & 0x186) != 0)
    {
      if ([v5 isCapturingVideo])
      {
        v7 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = v4;
          _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Stopping video capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingVideo];
LABEL_7:
        v8 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [v8 resetAnimated:1];
      }
    }

    else
    {
      if (!v6)
      {
        if (![v5 isCapturingCTMVideo])
        {
          goto LABEL_8;
        }

        v10 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = v4;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Stopping video capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
        goto LABEL_7;
      }

      if (v6 == 3 && [v5 isCapturingPanorama])
      {
        v9 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = v4;
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Stopping panorama capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        goto LABEL_7;
      }
    }
  }

LABEL_8:
}

- (void)_handleApplicationDidRemoveDeactivationReason:(id)a3
{
  v15 = *MEMORY[0x1E69E9840];
  v4 = [a3 userInfo];
  v5 = [v4 objectForKeyedSubscript:*MEMORY[0x1E69DE838]];
  v6 = [v5 integerValue];

  v7 = [(CAMViewfinderViewController *)self _debugStringForApplicationDeactivationReason:v6];
  v8 = os_log_create("com.apple.camera", "DeactivationReasons");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v13 = 138543362;
    v14 = v7;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Did remove deactivation reason %{public}@", &v13, 0xCu);
  }

  v9 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v10 = v9;
  switch(v6)
  {
    case 0:
    case 5:
    case 10:
    case 12:
    case 15:
      break;
    case 1:
      v11 = 12;
      goto LABEL_13;
    case 2:
      v11 = 13;
      goto LABEL_13;
    case 3:
      [v9 removeClosedViewfinderReason:14];
      v12 = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [v12 removeDisabledPreviewReason:2];
      goto LABEL_17;
    case 4:
      v11 = 15;
      goto LABEL_13;
    case 6:
      v11 = 16;
      goto LABEL_13;
    case 7:
      v11 = 17;
      goto LABEL_13;
    case 8:
      v11 = 18;
      goto LABEL_13;
    case 11:
      v11 = 19;
      goto LABEL_13;
    case 13:
      v11 = 20;
LABEL_13:
      [v9 removeClosedViewfinderReason:v11];
      break;
    default:
      v12 = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _handleApplicationWillAddDeactivationReason:];
      }

LABEL_17:

      break;
  }
}

- (void)_handleApplicationDidBecomeActive:(id)a3
{
  v4 = a3;
  v5 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    LOWORD(buf[0]) = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Received UIApplicationDidBecomeActiveNotification", buf, 2u);
  }

  v6 = +[CAMUserPreferences preferences];
  v7 = [v6 resetTimeoutDate];
  v8 = [v7 dateByAddingTimeInterval:-0.01];

  v9 = [MEMORY[0x1E695DF00] date];
  [v9 timeIntervalSinceDate:v8];
  v11 = v10;

  if (v11 > 0.0 && [(CAMViewfinderViewController *)self _isAutoResumeCancelingWithoutBackgrounding])
  {
    v12 = [(CAMViewfinderViewController *)self _captureController];
    [v12 startCaptureSessionWithRetryCount:3 retryInterval:@"became active with no auto-resume" logReason:0 completion:0.05];
  }

  [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:0];
  objc_initWeak(buf, self);
  v13 = [MEMORY[0x1E69C4598] sharedScheduler];
  v15[0] = MEMORY[0x1E69E9820];
  v15[1] = 3221225472;
  v15[2] = __65__CAMViewfinderViewController__handleApplicationDidBecomeActive___block_invoke;
  v15[3] = &unk_1E76F8580;
  objc_copyWeak(&v16, buf);
  [v13 scheduleDeferredMainQueueTask:v15];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  v14 = [(CAMViewfinderViewController *)self _currentMode];
  [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:v14];
  [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:v14];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:0];
  objc_destroyWeak(&v16);
  objc_destroyWeak(buf);
}

void __65__CAMViewfinderViewController__handleApplicationDidBecomeActive___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _updateDiskSpaceAlertViewVisibilityAnimated:0];
}

- (void)_handleApplicationWillResignActive:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v16 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationWillResignActiveNotification", v16, 2u);
  }

  [(CAMViewfinderViewController *)self _writeUserPreferences];
  v5 = +[CAMUserPreferences preferences];
  if ([v5 preserveCaptureMode])
  {
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];

    if (!v6)
    {
      v7 = [(CAMViewfinderViewController *)self _currentMode];
      v8 = +[CAMUserPreferences defaultMode];
      v9 = [(CAMViewfinderViewController *)self _currentDevicePosition];
      v10 = +[CAMUserPreferences defaultDevicePosition];
      if (v7 != v8 || v9 != v10)
      {
        v11 = [(CAMViewfinderViewController *)self _captureController];
        v12 = +[CAMUserPreferences preferences];
        v13 = [v12 resetTimeoutDate];
        [v11 cancelAutoResumeAfterDate:v13];

        [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:1];
      }
    }
  }

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:1];
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isImageAnalysisSupported];

  if (v15)
  {
    [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  }
}

- (void)_handleApplicationWillEnterForeground:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationWillEnterForegroundNotification", buf, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _updateDuetSystemConstraintsIfNecessary];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:0];
  if (![(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [(CAMViewfinderViewController *)self readUserPreferencesAndHandleChangesWithOverrides:0];
  }

  if (!v5)
  {
    [(CAMViewfinderViewController *)self _updateDuetSystemConstraintsIfNecessary];
  }

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = v6;
  if (self->_performingReviewUsingOverlay)
  {
    v8 = os_log_create("com.apple.camera", "CaptureSession");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *v13 = 0;
      _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Skipping session start since we're showing the review overlay screen", v13, 2u);
    }
  }

  else
  {
    [v6 startCaptureSessionWithRetryCount:3 retryInterval:@"application will enter foreground" logReason:0 completion:0.05];
  }

  [(CAMViewfinderViewController *)self _resetZoom];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:0];
  v9 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v9 removeClosedViewfinderReason:7];
  [v9 removeClosedViewfinderReason:19];
  [v9 removeClosedViewfinderReason:13];
  v10 = +[CAMUserPreferences preferences];
  v11 = [v10 sharedLibraryEnabled];

  if (v11)
  {
    v12 = [(CAMViewfinderViewController *)self _librarySelectionController];
    [v12 startNewSession];
  }

  [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
}

- (void)_handleApplicationDidEnterBackground:(id)a3
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v31 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationDidEnterBackgroundNotification", v31, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v5 addClosedViewfinderReason:7];
  [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:0];
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  v6 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  v7 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v6 countEventsFromAnalyticsVisionSession:v7];

  v8 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [v8 publish];

  [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:0];
  v9 = +[CAMUserPreferences preferences];
  v10 = [v9 sharedLibraryAutoBehaviorEnabled];

  if (v10)
  {
    v11 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    v12 = [v11 didCapture];

    if (v12)
    {
      v13 = [CAMAnalyticsSharedLibraryModeEvent alloc];
      v14 = [(CAMViewfinderViewController *)self _librarySelectionController];
      v15 = [(CAMAnalyticsSharedLibraryModeEvent *)v13 initWithLibrarySelectionController:v14];

      [(CAMAnalyticsSharedLibraryModeEvent *)v15 publish];
    }
  }

  v16 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  v17 = [(CAMViewfinderViewController *)self _locationController];
  [v16 updateForLocationController:v17];

  v18 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v18 publish];

  [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:0];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }

  [(CAMViewfinderViewController *)self _setResolvedNightMode:0];
  v19 = [(CAMViewfinderViewController *)self _captureController];
  [v19 changeToNightMode:0];

  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  v20 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v20 setControlDrawerExpanded:0 forReason:6 animated:0];

  [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:0];
  if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
  }

  [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:0];
  v21 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v21 dismissCameraRollViewControllerForced:1 animated:0];
  v22 = +[CAMCaptureCapabilities capabilities];
  if (([v22 hostProcess] | 4) == 4 && objc_msgSend(v22, "isImageAnalysisSupported"))
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:0 completion:0];
  }

  if (v10)
  {
    v23 = [(CAMViewfinderViewController *)self _librarySelectionController];
    [v23 stopAndClearAcquiredSignals];
  }

  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:0];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  [(CAMViewfinderViewController *)self _ensureSensitiveContentHidden];
  v24 = [(CAMViewfinderViewController *)self _transitionController];
  [v24 handleApplicationDidEnterBackground];

  v25 = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [v25 prepareForResumingUsingCrossfade];

  [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:2];
  v26 = [(CAMViewfinderViewController *)self _storageController];
  v27 = [v26 purgeableStorageContainer];
  [v27 cancelPurge];

  +[CAMLensSmudgeDisplayState logDidEnterBackground];
  v28 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  [v28 didEnterBackground];

  v29 = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  [v29 didEnterBackground];

  v30 = [(CAMViewfinderViewController *)self queuedViewfinderAction];

  if (v30)
  {
    [(CAMViewfinderViewController *)self setQueuedViewfinderAction:0];
  }
}

- (void)_handleSceneDidEnterBackground:(id)a3
{
  v23 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v5 = [(CAMViewfinderViewController *)self _captureController];
    v6 = [v5 isCapturingVideo];

    if (v6)
    {
      v7 = [v4 object];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v20 = 0u;
        v21 = 0u;
        v18 = 0u;
        v19 = 0u;
        v8 = [v7 windows];
        v9 = [v8 countByEnumeratingWithState:&v18 objects:v22 count:16];
        if (v9)
        {
          v10 = v9;
          v11 = *v19;
          while (2)
          {
            v12 = 0;
            do
            {
              if (*v19 != v11)
              {
                objc_enumerationMutation(v8);
              }

              v13 = *(*(&v18 + 1) + 8 * v12);
              v14 = [(CAMViewfinderViewController *)self view];
              v15 = [v14 window];

              if (v13 == v15)
              {

                v16 = os_log_create("com.apple.camera", "Capture");
                if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
                {
                  *v17 = 0;
                  _os_log_impl(&dword_1A3640000, v16, OS_LOG_TYPE_DEFAULT, "Stop recording video for backgrounded scene", v17, 2u);
                }

                [(CAMViewfinderViewController *)self _stopCapturingVideo];
                goto LABEL_16;
              }

              ++v12;
            }

            while (v10 != v12);
            v10 = [v8 countByEnumeratingWithState:&v18 objects:v22 count:16];
            if (v10)
            {
              continue;
            }

            break;
          }
        }
      }

LABEL_16:
    }
  }
}

- (void)_updateProResControlsForCurrentState
{
  [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateMaxRecordingTimeInstructionLabelForGraphConfiguration:v3];
}

- (void)availableDiskSpaceChanged:(id)a3
{
  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v4 animated:1];

  [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];
}

- (void)storageControllerDidChangePurgingState:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v4 animated:1];

  [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];

  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"did change purging state"];
}

- (void)_handleTimelapseLowDiskSpaceNotification:(id)a3
{
  v4 = a3;
  v5 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    LOWORD(buf[0]) = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Received CAMTimelapseLowDiskSpaceNotification", buf, 2u);
  }

  v6 = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (!v6)
  {
    v7 = [v4 userInfo];
    v8 = [v7 objectForKeyedSubscript:@"CAMTimelapseLowDiskSpaceTitleInfo"];
    v9 = [v7 objectForKeyedSubscript:@"CAMTimelapseLowDiskSpaceMessageInfo"];
    objc_initWeak(buf, self);
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke;
    aBlock[3] = &unk_1E76F9900;
    objc_copyWeak(&v22, buf);
    v10 = _Block_copy(aBlock);
    v6 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v8 message:v9 preferredStyle:1];
    v11 = MEMORY[0x1E69DC648];
    v12 = CAMStorageAlertDismissTitle([(CAMViewfinderViewController *)self _diskSpaceAlertType]);
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke_2;
    v20[3] = &unk_1E76F89F0;
    v20[4] = self;
    v13 = [v11 actionWithTitle:v12 style:0 handler:v20];
    [v6 addAction:v13];

    v14 = CAMStorageAlertResolveTitle(1);
    if (v14)
    {
      v15 = MEMORY[0x1E69DC648];
      v16 = CAMStorageAlertResolveTitle(1);
      v17 = [v15 actionWithTitle:v16 style:0 handler:v10];
      [v6 addAction:v17];
    }

    [(CAMViewfinderViewController *)self presentViewController:v6 animated:1 completion:0];
    [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:v6];
    v18 = [(CAMViewfinderViewController *)self _storageController];
    v19 = [v18 purgeableStorageContainer];
    [v19 reportLowDiskEventWithIdentifier:@"com.apple.camera.timelapse"];

    objc_destroyWeak(&v22);
    objc_destroyWeak(buf);
  }
}

void __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  CAMShowStorageUsageInSettings();
}

- (int64_t)_diskSpaceAlertType
{
  v3 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v4 = PLIsCPLDataclassEnabled();
  IsEnabled = PLCloudPhotoLibraryKeepOriginalsIsEnabled();
  v6 = [(CAMViewfinderViewController *)self _hasBeenPromptedForICPLToday];
  if (v3)
  {
    return 2;
  }

  else
  {
    return v4 & IsEnabled & !v6 ^ 1u;
  }
}

- (BOOL)_hasBeenPromptedForICPLToday
{
  CFPreferencesAppSynchronize(@"com.apple.mobileslideshow");
  v2 = CFPreferencesCopyAppValue(@"CPLKeepOriginalsPromptShownDate", @"com.apple.mobileslideshow");
  if (v2 && ([MEMORY[0x1E695DF00] date], v3 = objc_claimAutoreleasedReturnValue(), v4 = objc_msgSend(v3, "compare:", v2), v3, v4 != 1))
  {
    v7 = 1;
  }

  else
  {
    v5 = [MEMORY[0x1E695DF00] date];
    v6 = [v5 dateByAddingTimeInterval:86400.0];

    CFPreferencesSetAppValue(@"CPLKeepOriginalsPromptShownDate", v6, @"com.apple.mobileslideshow");
    CFPreferencesAppSynchronize(@"com.apple.mobileslideshow");

    v7 = 0;
  }

  return v7;
}

- (void)_updateDiskSpaceAlertViewVisibilityAnimated:(BOOL)a3
{
  v3 = a3;
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {

    [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:v3];
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _captureController];
    v6 = [v5 isCapturingBurst];
    v7 = [(CAMViewfinderViewController *)self _storageController];
    v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __75__CAMViewfinderViewController__updateDiskSpaceAlertViewVisibilityAnimated___block_invoke;
    v9[3] = &unk_1E76F8AA0;
    v9[4] = self;
    v10 = v3;
    [v7 hasDiskSpaceToAllowCaptureWithConfiguration:v8 allowPurging:v6 ^ 1u completion:v9];
  }
}

uint64_t __75__CAMViewfinderViewController__updateDiskSpaceAlertViewVisibilityAnimated___block_invoke(uint64_t a1, int a2)
{
  v28 = *MEMORY[0x1E69E9840];
  v4 = [*(a1 + 32) _storageController];
  v5 = [v4 purgeableStorageContainer];
  v6 = [v5 isPurging];

  LODWORD(v4) = [*(a1 + 32) _hasInFlightConfiguration];
  v7 = [*(a1 + 32) _currentGraphConfiguration];
  v8 = [v7 videoEncodingBehavior] == 2;

  v9 = (a2 | v8 & (v6 | v4)) ^ 1;
  if ([*(a1 + 32) _externalStorageOutputEnabled])
  {
    v10 = [*(a1 + 32) _storageMonitor];
    v11 = [v10 monitoringState] != 2;

    v9 = v11 & v9;
  }

  if ([*(a1 + 32) _externalStorageOutputEnabled])
  {
    v12 = [*(a1 + 32) _connectedStorage];
    v13 = [v12 connected];

    v14 = [*(a1 + 32) _connectedStorage];
    v15 = [v14 totalFreeBytes];

    if (v15 >= 0)
    {
      v16 = v13;
    }

    else
    {
      v16 = 0;
    }

    if ((v16 & v9) == 1)
    {
      v17 = os_log_create("com.apple.camera", "ExternalStorage");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        v18 = [*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture];
        v19 = @"NO";
        if (v18)
        {
          v19 = @"YES";
        }

        v20 = v19;
        v22 = 138543874;
        v23 = @"YES";
        v24 = 2048;
        v25 = v15;
        v26 = 2114;
        v27 = v20;
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "External storage: setting out of disk space alert, connected=%{public}@, totalFreeBytes=%lld, receivedOutOfDiskSpaceErrorDuringCapture=%{public}@", &v22, 0x20u);
      }

      [*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture];
      v9 = 1;
      goto LABEL_17;
    }

    v9 = 0;
  }

  if (([*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture] & 1) != 0 || v9)
  {
LABEL_17:
    [*(a1 + 32) _showDiskSpaceAlertView];
    return [*(a1 + 32) _setOutOfDiskSpace:v9];
  }

  [*(a1 + 32) _dismissDiskSpaceAlertViewAnimated:*(a1 + 40)];
  return [*(a1 + 32) _setOutOfDiskSpace:v9];
}

- (void)_showDiskSpaceAlertView
{
  v3 = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (v3)
  {
    goto LABEL_11;
  }

  v4 = [(CAMViewfinderViewController *)self _diskSpaceAlertType];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  objc_initWeak(&location, self);
  if ((v4 - 1) >= 2)
  {
    if (v4)
    {
      v9 = 0;
      goto LABEL_8;
    }

    v6 = &v26;
    v7 = v25;
    v25[0] = MEMORY[0x1E69E9820];
    v25[1] = 3221225472;
    v8 = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke;
  }

  else
  {
    v6 = &v24;
    v7 = v23;
    v23[0] = MEMORY[0x1E69E9820];
    v23[1] = 3221225472;
    v8 = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_2;
  }

  v7[2] = v8;
  v7[3] = &unk_1E76F9900;
  objc_copyWeak(v6, &location);
  v9 = _Block_copy(v7);
  objc_destroyWeak(v6);
LABEL_8:
  v10 = MEMORY[0x1E69DC650];
  v11 = CAMStorageAlertTitle(v4);
  v12 = CAMStorageAlertMessage(v4, v5);
  v3 = [v10 alertControllerWithTitle:v11 message:v12 preferredStyle:1];

  v13 = MEMORY[0x1E69DC648];
  v14 = CAMStorageAlertDismissTitle(v4);
  v22[0] = MEMORY[0x1E69E9820];
  v22[1] = 3221225472;
  v22[2] = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_3;
  v22[3] = &unk_1E76F89F0;
  v22[4] = self;
  v15 = [v13 actionWithTitle:v14 style:0 handler:v22];
  [v3 addAction:v15];

  v16 = CAMStorageAlertResolveTitle(v4);
  if (v16)
  {
    v17 = [MEMORY[0x1E69DC648] actionWithTitle:v16 style:0 handler:v9];
    [v3 addAction:v17];
  }

  v18 = [v3 actions];
  v19 = [v18 lastObject];
  [v3 setPreferredAction:v19];

  [(CAMViewfinderViewController *)self presentViewController:v3 animated:1 completion:0];
  [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:v3];
  v20 = [(CAMViewfinderViewController *)self _storageController];
  v21 = [v20 purgeableStorageContainer];
  [v21 reportLowDiskEventWithIdentifier:@"com.apple.camera.generic"];

  objc_destroyWeak(&location);
LABEL_11:
}

uint64_t __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  return MEMORY[0x1EEE286D0](0);
}

void __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  CAMShowStorageUsageInSettings();
}

- (void)_dismissDiskSpaceAlertViewAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (v5)
  {
    v7 = v5;
    v6 = [v5 presentingViewController];
    [v6 dismissViewControllerAnimated:v3 completion:0];

    [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:0];
    [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:0];
    v5 = v7;
  }
}

- (void)_showUnsupportedFormatAlert
{
  v3 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "External storage: cannot enable external storage output due to unsupported format", buf, 2u);
  }

  v17 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_UNSUPPORTED_FORMAT_TITLE", 0);
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_UNSUPPORTED_FORMAT_MESSAGE", 0);
  v5 = CAMLocalizedFrameworkString(@"OK", 0);
  v6 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_TITLE", 0);
  v7 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_URL", 0);
  v8 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v17 message:v4 preferredStyle:1];
  v9 = MEMORY[0x1E69DC648];
  v20[0] = MEMORY[0x1E69E9820];
  v20[1] = 3221225472;
  v20[2] = __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke;
  v20[3] = &unk_1E76F89F0;
  v21 = v8;
  v10 = v8;
  v11 = [v9 actionWithTitle:v5 style:0 handler:v20];
  v12 = MEMORY[0x1E69DC648];
  v18[0] = MEMORY[0x1E69E9820];
  v18[1] = 3221225472;
  v18[2] = __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke_2;
  v18[3] = &unk_1E76F89F0;
  v19 = v7;
  v13 = v7;
  v14 = [v12 actionWithTitle:v6 style:0 handler:v18];
  [v10 addAction:v11];
  [v10 addAction:v14];
  [v10 setPreferredAction:v11];
  [(CAMViewfinderViewController *)self presentViewController:v10 animated:1 completion:0];
  v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v15 setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", v16)}];
}

void __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) presentingViewController];
  [v1 dismissViewControllerAnimated:1 completion:0];
}

void __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke_2(uint64_t a1)
{
  v1 = [MEMORY[0x1E695DFF8] URLWithString:*(a1 + 32)];
  CAMOpenURL(v1, MEMORY[0x1E695E0F8]);
}

- (void)_showFrameDropsAlert
{
  v3 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_FRAME_DROPS_ALERT_TITLE", 0);
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_FRAME_DROPS_ALERT_MESSAGE", 0);
  v5 = CAMLocalizedFrameworkString(@"OK", 0);
  v6 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_TITLE", 0);
  v7 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_URL", 0);
  v8 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v3 message:v4 preferredStyle:1];
  v9 = MEMORY[0x1E69DC648];
  v20[0] = MEMORY[0x1E69E9820];
  v20[1] = 3221225472;
  v20[2] = __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke;
  v20[3] = &unk_1E76F89F0;
  v21 = v8;
  v10 = v8;
  v11 = [v9 actionWithTitle:v5 style:0 handler:v20];
  v12 = MEMORY[0x1E69DC648];
  v15 = MEMORY[0x1E69E9820];
  v16 = 3221225472;
  v17 = __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke_2;
  v18 = &unk_1E76F89F0;
  v19 = v7;
  v13 = v7;
  v14 = [v12 actionWithTitle:v6 style:0 handler:&v15];
  [v10 addAction:{v11, v15, v16, v17, v18}];
  [v10 addAction:v14];
  [v10 setPreferredAction:v11];
  [(CAMViewfinderViewController *)self presentViewController:v10 animated:1 completion:0];
}

void __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) presentingViewController];
  [v1 dismissViewControllerAnimated:1 completion:0];
}

void __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke_2(uint64_t a1)
{
  v1 = [MEMORY[0x1E695DFF8] URLWithString:*(a1 + 32)];
  CAMOpenURL(v1, MEMORY[0x1E695E0F8]);
}

- (void)pressShutterForRemoteShutter
{
  v3 = os_log_create("com.apple.camera", "RemoteShutter");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "Remote triggered shutter press and release", v8, 2u);
  }

  v4 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v5 externalButtonPressedWithBehavior:1];

    v6 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v6 externalButtonReleased];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _shutterButton];
    [(CAMViewfinderViewController *)self _handleShutterButtonPressed:v7];

    v6 = [(CAMViewfinderViewController *)self _shutterButton];
    [(CAMViewfinderViewController *)self _handleShutterButtonReleased:v6];
  }
}

- (void)pressShutterForRemoteShutterWaitingForViewfinder:(BOOL)a3 timeout:(double)a4
{
  v5 = a3;
  v7 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v8 = [v7 isViewfinderClosed];

  if (v5 && v8)
  {
    objc_initWeak(&location, self);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke;
    v12[3] = &unk_1E76F8580;
    objc_copyWeak(&v13, &location);
    [(CAMViewfinderViewController *)self setQueuedViewfinderAction:v12];
    v9 = dispatch_time(0, (a4 * 1000000000.0));
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke_2;
    block[3] = &unk_1E76F8580;
    objc_copyWeak(&v11, &location);
    dispatch_after(v9, MEMORY[0x1E69E96A0], block);
    objc_destroyWeak(&v11);
    objc_destroyWeak(&v13);
    objc_destroyWeak(&location);
  }

  else
  {

    [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
  }
}

void __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained pressShutterForRemoteShutter];
}

void __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v3 = [WeakRetained queuedViewfinderAction];

  if (v3)
  {
    v4 = objc_loadWeakRetained((a1 + 32));
    [v4 setQueuedViewfinderAction:0];
  }
}

- (void)pressStillDuringVideoForRemoteShutter
{
  v3 = os_log_create("com.apple.camera", "RemoteShutter");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "Remote triggered still during video press and release", v7, 2u);
  }

  v4 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v5 externalLockButtonPressed];

    v6 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [v6 externalLockButtonReleased];
  }

  else
  {
    [(CAMViewfinderViewController *)self _handleStillDuringVideoButtonPressed:self->__stillDuringVideoButton];
    [(CAMViewfinderViewController *)self _handleStillDuringVideoButtonReleased:self->__stillDuringVideoButton];
  }
}

- (void)remoteShutter:(id)a3 takePhotoWithCountdown:(unint64_t)a4
{
  v7 = a3;
  v6 = [(CAMViewfinderViewController *)self _takePhotoForExternalClientWithCountdown:a4 internalTimerOverridesCountdown:0];
  if (a4 && !v6)
  {
    [v7 countdownCanceled];
  }
}

- (BOOL)_takePhotoForExternalClientWithCountdown:(unint64_t)a3 internalTimerOverridesCountdown:(BOOL)a4
{
  v7 = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
  if (!v7)
  {
    if (a3)
    {
      if (a4)
      {
        if ([(CAMViewfinderViewController *)self isEmulatingImagePicker]|| [(CAMViewfinderViewController *)self _isCapturingFromTimer])
        {
          goto LABEL_18;
        }

        v8 = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
        v9 = v8 == 0;
        if (v8)
        {
          v10 = v8;
        }

        else
        {
          v10 = 1;
        }

        [(CAMViewfinderViewController *)self set_isHeadphonesEventCaptureWithUserSpecifiedDuration:v8 != 0];
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:v9];
        v11 = self;
        v12 = v10;
        goto LABEL_17;
      }

      if (a3 <= 2)
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:0];
        [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:0 animated:1];
        v13 = a3;
        v14 = self;
        v15 = 0;
LABEL_23:
        [(CAMViewfinderViewController *)v14 performSelector:sel_pressShutterForRemoteShutter withObject:v15 afterDelay:v13];
        return !v7;
      }

      v16 = a3 - 3;
      if (a3 == 3)
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        v11 = self;
        v12 = 1;
        goto LABEL_17;
      }

      if (a3 > 4)
      {
        v16 = a3 - 5;
        if (a3 == 5)
        {
          [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
          v11 = self;
          v12 = 2;
          goto LABEL_17;
        }

        if (a3 > 9)
        {
          [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
          [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:3 animated:1];
          if (a3 == 10)
          {
            goto LABEL_18;
          }

          v13 = (a3 - 10);
          goto LABEL_22;
        }

        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        v17 = self;
        v18 = 2;
      }

      else
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        v17 = self;
        v18 = 1;
      }

      [(CAMViewfinderViewController *)v17 _setTimerDurationAndUpdateUI:v18 animated:1];
      v13 = v16;
LABEL_22:
      v14 = self;
      v15 = self;
      goto LABEL_23;
    }

    if (![(CAMViewfinderViewController *)self isRecording])
    {
      v11 = self;
      v12 = 0;
LABEL_17:
      [(CAMViewfinderViewController *)v11 _setTimerDurationAndUpdateUI:v12 animated:1];
LABEL_18:
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
      return !v7;
    }

    [(CAMViewfinderViewController *)self pressStillDuringVideoForRemoteShutter];
  }

  return !v7;
}

- (void)remoteShutterCancelCountdown:(id)a3
{
  [MEMORY[0x1E69E58C0] cancelPreviousPerformRequestsWithTarget:self selector:sel_pressShutterForRemoteShutter object:0];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }
}

- (BOOL)remoteShutterBeginBurstCapture:(id)a3
{
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    if (v5)
    {
      v6 = v5;
      if ([v5 isEnabled] && (objc_msgSend(v6, "isTracking") & 1) == 0)
      {
        v4 = 1;
        [v6 externalButtonPressedWithBehavior:1];
LABEL_10:

        return v4;
      }
    }

    else
    {
      v6 = [(CAMViewfinderViewController *)self _shutterButton];
      if ([v6 isEnabled] && (objc_msgSend(v6, "isHighlighted") & 1) == 0)
      {
        v4 = 1;
        [v6 setHighlighted:1];
        [(CAMViewfinderViewController *)self _handleShutterButtonPressed:v6];
        goto LABEL_10;
      }
    }

    v4 = 0;
    goto LABEL_10;
  }

  return 0;
}

- (BOOL)remoteShutterEndBurstCapture:(id)a3
{
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    if (v5)
    {
      v6 = v5;
      [v5 externalButtonReleased];
    }

    else
    {
      v6 = [(CAMViewfinderViewController *)self _shutterButton];
      if (![v6 isHighlighted])
      {
        v4 = 0;
        goto LABEL_8;
      }

      [v6 setHighlighted:0];
      [(CAMViewfinderViewController *)self _handleShutterButtonReleased:v6];
    }

    v4 = 1;
LABEL_8:

    return v4;
  }

  return 0;
}

- (void)remoteShutter:(id)a3 setMode:(int64_t)a4
{
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];
  }

  v6 = +[CAMUserPreferences preferences];
  v7 = [v6 defaultDeviceForModeChange:a4 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self changeToMode:a4 device:v7 animated:1];
}

- (BOOL)remoteShutterStartCapture:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentMode];
  LOBYTE(v5) = 0;
  if (v4 <= 8)
  {
    if (((1 << v4) & 0x1AE) != 0)
    {
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
      LOBYTE(v5) = 1;
    }

    else if (!v4)
    {
      v5 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

      if (v5)
      {
        v7 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        LOBYTE(v5) = 1;
        [v7 externalButtonPressedWithBehavior:1];
      }
    }
  }

  return v5;
}

- (BOOL)remoteShutterPauseCapture:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (!v5)
  {
    return 0;
  }

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 isCapturingVideo];

  if (!v7)
  {
    return 0;
  }

  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v8 videoCapturePaused];

  if (v9)
  {
    return 0;
  }

  [(CAMViewfinderViewController *)self dynamicShutterControlDidPressPauseResumeButton:0];
  return 1;
}

- (BOOL)remoteShutterResumeCapture:(id)a3
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (!v5)
  {
    return 0;
  }

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 isCapturingVideo];

  if (!v7)
  {
    return 0;
  }

  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v8 videoCapturePaused];

  if (!v9)
  {
    return 0;
  }

  [(CAMViewfinderViewController *)self dynamicShutterControlDidPressPauseResumeButton:0];
  return 1;
}

- (BOOL)remoteShutterStopCapture:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self isRecording];
  if (v4)
  {
    if ([(CAMViewfinderViewController *)self _currentMode]|| ([(CAMViewfinderViewController *)self _dynamicShutterControl], v5 = objc_claimAutoreleasedReturnValue(), v5, !v5))
    {
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
    }

    else
    {
      v6 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v6 externalButtonReleased];
    }
  }

  return v4;
}

- (void)remoteShutter:(id)a3 setZoomAmount:(double)a4
{
  [(CAMViewfinderViewController *)self _zoomFactorForZoomSliderValue:a3, a4];

  [(CAMViewfinderViewController *)self _remoteShutterSetZoomFactor:?];
}

- (void)_remoteShutterSetZoomFactor:(double)a3
{
  if ([(CAMViewfinderViewController *)self _isZoomAllowedCurrently])
  {
    if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
    {
      [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
      [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:a3];
    }

    else
    {
      [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
      zoomSlider = self->__zoomSlider;
      [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:a3];
      *&v7 = v7;
      [(CAMZoomSlider *)zoomSlider setValue:0 animated:v7];
      [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:a3];
      [(CAMViewfinderViewController *)self zoomSliderDidEndZooming:self->__zoomSlider];
    }

    v8 = [(CAMViewfinderViewController *)self _zoomReporter];
    [v8 zoomChangedToFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{4, a3}];

    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:4];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "RemoteShutter");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      *v9 = 0;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Ignoring zoom change from Watch because not allowed at this time", v9, 2u);
    }
  }
}

- (void)remoteShutter:(id)a3 setCaptureDevice:(int64_t)a4
{
  v6 = [(CAMViewfinderViewController *)self _currentDevice];
  if ((v6 - 1) > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[v6 - 1];
  }

  if ((a4 - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[a4 - 1];
  }

  if (v7 != v8)
  {

    [(CAMViewfinderViewController *)self handleFlipButtonReleased];
  }
}

- (void)readUserPreferencesAndHandleChangesWithOverrides:(id)a3 bypassXPCWhenReadingSystemStyle:(BOOL)a4
{
  v4 = a4;
  v63 = *MEMORY[0x1E69E9840];
  v52 = a3;
  v6 = +[CAMUserPreferences preferences];
  v50 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v7 = [v50 isCallActive];
  v51 = [v6 resetTimeoutDate];
  v8 = [v6 isVideoConfigurationControlEnabled];
  v56 = 0;
  [v6 readPreferencesWithOverrides:v52 emulationMode:-[CAMViewfinderViewController emulationMode](self callActive:"emulationMode") shouldResetCaptureConfiguration:v7 bypassXPCWhenReadingSystemStyle:{&v56, v4}];
  v9 = [v6 captureConfiguration];
  v10 = [v9 semanticStyles];
  v11 = [v10 mutableCopy];
  [(CAMViewfinderViewController *)self _setSemanticStyles:v11];

  v12 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setSelectedSemanticStyleIndex:](self, "_setSelectedSemanticStyleIndex:", [v12 selectedSemanticStyleIndex]);

  v13 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setSmartStyleSystemStyleIndex:](self, "_setSmartStyleSystemStyleIndex:", [v13 smartStyleSystemStyleIndex]);

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  objc_initWeak(&location, self);
  v14 = [MEMORY[0x1E69C4598] sharedScheduler];
  v53[0] = MEMORY[0x1E69E9820];
  v53[1] = 3221225472;
  v53[2] = __112__CAMViewfinderViewController_readUserPreferencesAndHandleChangesWithOverrides_bypassXPCWhenReadingSystemStyle___block_invoke;
  v53[3] = &unk_1E76F8580;
  objc_copyWeak(&v54, &location);
  [v14 scheduleDeferredMainQueueTask:v53];

  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:0];
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryControlsIfNecessary];
  v47 = [v6 resetTimeoutDate];
  v15 = [v51 isEqual:?];
  if (v8)
  {
    v16 = [v6 isVideoConfigurationControlEnabled] ^ 1;
  }

  else
  {
    LOBYTE(v16) = 0;
  }

  if ((v56 & 1) == 0)
  {
    v17 = [v52 videoConfiguration];
    if ((v17 != 0) | v16 & 1 || ([v52 slomoConfiguration], (v17 = objc_claimAutoreleasedReturnValue()) != 0))
    {
    }

    else
    {
      v43 = [v52 cinematicConfiguration];
      v44 = v43 == 0;

      if (v44)
      {
        goto LABEL_9;
      }
    }
  }

  [(CAMViewfinderViewController *)self set_videoConfigurationOverride:0];
  [(CAMViewfinderViewController *)self set_slomoConfigurationOverride:0];
  [(CAMViewfinderViewController *)self set_cinematicConfigurationOverride:0];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabled:0 performGraphConfiguration:0];
LABEL_9:
  v18 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setDesiredProResVideoMode:](self, "_setDesiredProResVideoMode:", [v18 proResVideoMode]);

  if ((v56 & 1) != 0 || ((v15 ^ 1) & 1) != 0 || [v52 hasOverrides])
  {
    v19 = [v6 captureConfiguration];
    v48 = [v6 conflictingControlConfiguration];
    v20 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
    v21 = [(CAMViewfinderViewController *)self _motionController];
    v49 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", v19, v20, [v21 captureOrientation]);

    v22 = [v52 hasOverrides];
    v23 = @"Reset";
    if (v22)
    {
      v23 = @"Overrides";
    }

    v46 = v23;
    v24 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
    {
      v25 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      *buf = 138543874;
      v58 = v46;
      v59 = 2114;
      v60 = v49;
      v61 = 2114;
      v62 = v25;
      _os_log_impl(&dword_1A3640000, v24, OS_LOG_TYPE_DEFAULT, "%{public}@: will change to: %{public}@ from: %{public}@", buf, 0x20u);
    }

    v26 = [(CAMViewfinderViewController *)self _currentMode];
    v27 = [(CAMViewfinderViewController *)self _currentDevice];
    v28 = [(CAMViewfinderViewController *)self _currentDevicePosition];
    v29 = [v19 mode];
    v30 = [v19 device];
    v31 = v30;
    v45 = v27;
    if ((v30 - 1) > 0xA)
    {
      v32 = 0;
    }

    else
    {
      v32 = qword_1A3A685B0[v30 - 1];
    }

    v33 = [MEMORY[0x1E695DF00] now];
    v34 = [v51 dateByAddingTimeInterval:0.01];
    v35 = [v33 compare:v34];
    v36 = v28 == v32 && v26 == v29;
    if (!v36 && v35 != 1)
    {
      [(CAMViewfinderViewController *)self _startCaptureSessionIfNecessaryIfVisibleAndInterrupted];
    }

    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v49];
    v38 = v37;
    v39 = [(CAMViewfinderViewController *)self _captureController];
    v40 = [v39 applyCaptureConfiguration:v19 zoomFactor:-[CAMViewfinderViewController _externalStorageOutputEnabled](self outputToExternalStorage:{"_externalStorageOutputEnabled"), v38}];

    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:v40];
    v41 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v41 applyCaptureConfiguration:v19];
    [(CAMViewfinderViewController *)self applyCaptureConfiguration:v19 conflictingControlConfiguration:v48];
    [(CAMViewfinderViewController *)self _closeViewfinderForChangeFromMode:v26 toMode:v29 fromDevice:v45 toDevice:v31];

    [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
  }

  [(CAMViewfinderViewController *)self _createOrDestroyLevelViewModelIfNecessary];
  [(CAMViewfinderViewController *)self _createGridViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyLevelViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyHorizonLevelViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyHDRButtonIfNecessary];
  [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:0];
  v42 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v42 animated:0];
  [(CAMViewfinderViewController *)self _updateInterfaceModulationForGraphConfiguration:v42 animated:0];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _configureSwipeToModeSwitchGestureRecognizersDirection];
  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
  [(CAMViewfinderViewController *)self _updateChromeClassicModeSwitching];

  objc_destroyWeak(&v54);
  objc_destroyWeak(&location);
}

void __112__CAMViewfinderViewController_readUserPreferencesAndHandleChangesWithOverrides_bypassXPCWhenReadingSystemStyle___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v1 = [WeakRetained _fullscreenViewfinder];
  [v1 reloadSemanticStyleBadgesDelayIfNeeded:0];
}

- (void)_startCaptureSessionIfNecessaryIfVisibleAndInterrupted
{
  v7 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v7 isInterrupted];
  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {
    v4 = [(CAMViewfinderViewController *)self view];
    v5 = [v4 window];

    v6 = v5 ? v3 : 0;
    if (v6 == 1)
    {
      [v7 startCaptureSessionWithRetryCount:3 retryInterval:@"resetting graph configuration" logReason:0 completion:0.05];
    }
  }
}

- (void)_createGridViewIfNecessary
{
  v6 = +[CAMUserPreferences preferences];
  if ([v6 shouldShowGridView] && !self->__gridView)
  {
    v3 = [CAMGridView alloc];
    v4 = [(CAMGridView *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    gridView = self->__gridView;
    self->__gridView = v4;

    [(CAMViewfinderViewController *)self _embedGridView];
  }

  [(CAMGridView *)self->__gridView setLevelViewModel:self->__levelViewModel];
}

- (void)_createOrDestroyHorizonLevelViewIfNecessary
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMUserPreferences preferences];
  v4 = [v6 shouldShowHorizonLevelView];
  v5 = [(CAMViewfinderViewController *)self _shouldCreateHorizonLevelViewForMode:v3];
  if ((v4 & 1) != 0 || v3 == 8)
  {
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createHorizonLevelViewIfNecessary];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _destroyHorizonLevelViewIfNecessary];
  }
}

- (BOOL)_shouldMonitorDeviceMotionForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = +[CAMApplication appOrPlugInState];
  v6 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v7 = [v6 isViewfinderClosed];
  v8 = [(CAMViewfinderViewController *)self _levelViewModel];
  v9 = [(CAMViewfinderViewController *)self _shouldHideLevelViewForGraphConfiguration:v4];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideHorizonLevelViewForGraphConfiguration:v4];

  if (v9 & self)
  {
    v10 = 0;
  }

  else
  {
    v10 = (v8 != 0) & ~v7;
  }

  if (v5)
  {
    v11 = 0;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (void)suspendCameraSessionWithCompletion:(id)a3
{
  v4 = a3;
  v7 = [(CAMViewfinderViewController *)self _captureController];
  [v7 stopCaptureSessionWithCompletion:v4];

  v5 = [(CAMViewfinderViewController *)self _locationController];
  [v5 setEnabled:0];
  if ([(CAMViewfinderViewController *)self automaticallyAdjustsApplicationIdleTimer])
  {
    v6 = [(CAMViewfinderViewController *)self _idleController];
    [v6 stopUpdatingIdleTimer];
  }
}

- (void)resumeCameraSessionWithCompletion:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 startCaptureSessionWithRetryCount:0 retryInterval:@"resumeCameraSession" logReason:v4 completion:0.0];
}

- (void)cameraRollControllerDidFullyPresentCameraRoll:(id)a3
{
  v4 = a3;
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 changeToTorchMode:0];
  v6 = [(CAMViewfinderViewController *)self _imageWell];
  [v6 setScaledForInteraction:0];

  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldDeferMediaLoadingForGraphConfiguration:v7];

  if (v8)
  {
    [v4 sessionIdentifier];
    dispatch_time(0, 500000000);
    v11 = MEMORY[0x1E69E9820];
    v12 = 3221225472;
    v13 = __77__CAMViewfinderViewController_cameraRollControllerDidFullyPresentCameraRoll___block_invoke;
    v14 = &unk_1E76F9818;
    v15 = v4;
    pl_dispatch_after();
  }

  v9 = [(CAMViewfinderViewController *)self _cameraRollControllerAction:v11];

  if (v9)
  {
    v10 = [(CAMViewfinderViewController *)self _cameraRollControllerAction];
    v10[2]();
  }
}

uint64_t __77__CAMViewfinderViewController_cameraRollControllerDidFullyPresentCameraRoll___block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) sessionIdentifier];
  if (result == *(a1 + 40))
  {
    v3 = *(a1 + 32);

    return [v3 beginAllowingStagedMediaLoading];
  }

  return result;
}

- (void)cameraRollControllerDidDismissFullyPresentedCameraRoll:(id)a3
{
  v4 = a3;
  [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _currentMode]];
  v5 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v5 didDismissCameraRoll];

  v6 = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [v6 viewfinderViewController:self didDismissPresentedCameraRoll:v4];

  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled]&& ![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v7 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v10 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "External storage: enabling deferred SSD output on cameraRollControllerDidDismissFullyPresentedCameraRoll", v10, 2u);
    }

    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
  }

  v8 = [(CAMViewfinderViewController *)self _isSpatialMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
  v9 = [(CAMViewfinderViewController *)self _motionController];
  [v9 setForceLandscapeOrientation:v8];
}

- (void)cameraRollControllerRequestsCaptureSessionStopped:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [v4 addClosedViewfinderReason:8];

  [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
}

- (void)cameraRollController:(id)a3 willShowPresentingViewControllerShouldStartCaptureSession:(BOOL)a4
{
  if (a4)
  {
    v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v7 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", v5, [v6 isCallActive]);

    if (!v7)
    {

      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
    }
  }
}

- (void)cameraRollController:(id)a3 didDismissPreviewControllerShouldStartCaptureSession:(BOOL)a4
{
  v4 = a4;
  v9 = a3;
  if (v4)
  {
    [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
  }

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:v6 isShowingCameraRoll:0];
  v7 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [v7 didDismissCameraRoll];

  v8 = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [v8 viewfinderViewController:self didDismissPresentedCameraRoll:v9];
}

- (BOOL)cameraRollControllerShouldRequestUnlock:(id)a3
{
  v3 = [(CAMViewfinderViewController *)self unlockDelegate];

  if (v3)
  {
    return 1;
  }

  return +[CAMFrameworkUtilities isPasscodeLocked];
}

- (id)cameraRollControllerSourceAssetRegionOfInterest:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self chromeViewController];

  if (v4)
  {
    v5 = [(CAMViewfinderViewController *)self chromeViewController];
    v6 = [v5 imageWellSourceView];

    v7 = objc_alloc(MEMORY[0x1E69C45A0]);
    [v6 bounds];
    v8 = [v7 initWithRect:v6 inCoordinateSpace:?];
    v9 = objc_alloc_init(MEMORY[0x1E69C4520]);
    v10 = [(CAMViewfinderViewController *)self chromeViewController];
    [v10 imageWellCornerRadius];
    [v9 setCornerRadius:?];

    [v8 setImageViewSpec:v9];
  }

  else
  {
    v11 = [(CAMViewfinderViewController *)self _imageWell];
    v12 = [(CAMViewfinderViewController *)self _imageWell];
    [v12 bounds];
    v14 = v13;
    v16 = v15;
    v18 = v17;
    v20 = v19;
    v21 = [(CAMViewfinderViewController *)self _imageWell];
    [v11 alignmentRectForFrame:objc_msgSend(v21 scaledForInteraction:{"isScaledForInteraction"), v14, v16, v18, v20}];
    v23 = v22;
    v25 = v24;
    v27 = v26;
    v29 = v28;

    v30 = objc_alloc(MEMORY[0x1E69C45A0]);
    v6 = [(CAMViewfinderViewController *)self _imageWell];
    v8 = [v30 initWithRect:v6 inCoordinateSpace:{v23, v25, v27, v29}];
  }

  return v8;
}

- (void)_imageWellSetContentHidden:(BOOL)a3
{
  v3 = a3;
  v4 = [(CAMViewfinderViewController *)self _imageWell];
  [v4 setThumbnailImageHidden:v3];
}

- (void)cameraRollControllerWillPresentCameraRoll:(id)a3 withOneUpController:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [v8 viewfinderViewController:self willPresentCameraRoll:v7 withOneUpController:v6];
}

- (int64_t)cameraRollControllerPreferredPresentationOrientation:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self view];
  v5 = [v4 window];
  v6 = CAMInterfaceOrientationForWindow(v5);

  if ([(CAMViewfinderViewController *)self _layoutStyle]== 3)
  {
    homeIndicatorAutoHideOrientation = self->__homeIndicatorAutoHideOrientation;
    v8 = [(CAMViewfinderViewController *)self _motionController];
    v9 = [v8 captureOrientation];
    v10 = CAMIsDeviceOrientationLocked();
    v11 = [MEMORY[0x1E69DC938] currentDevice];
    v12 = [v11 orientation] - 5;

    if (v9 == 2)
    {
      v13 = 1;
    }

    else
    {
      v13 = v10;
    }

    if (v12 < 2)
    {
      v13 = 1;
    }

    if (v13)
    {
      v6 = 1;
    }

    else
    {
      v6 = homeIndicatorAutoHideOrientation;
    }
  }

  return v6;
}

- (void)_handleCallStatusMonitorDidChangeCallActive:(id)a3
{
  v4 = os_log_create("com.apple.camera", "CallStatus");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received CAMCallStatusMonitorDidChangeCallActiveNotification", buf, 2u);
  }

  v5 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v6 = [v5 isCallActive];

  v7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldSuspendCaptureSessionForGraphConfiguration:v7 callActive:v6 ^ 1];

  v9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = [(CAMViewfinderViewController *)self _shouldSuspendCaptureSessionForGraphConfiguration:v9 callActive:v6];

  v11 = [(CAMViewfinderViewController *)self _currentMode];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  if (v11 <= 9 && ((1 << v11) & 0x251) != 0 || !v10 && v8)
  {
    v12 = [(CAMViewfinderViewController *)self _captureController];
    v13 = [v12 isCapturingCTMVideo];

    if (v13)
    {
      v14 = os_log_create("com.apple.camera", "CallStatus");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *v16 = 0;
        _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "CAMCallStatusMonitorDidChangeCallActiveNotification: Ending quick take recording due to audio configuration update", v16, 2u);
      }

      [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
      v15 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [v15 resetAnimated:1];
    }

    [(CAMViewfinderViewController *)self _reconfigureCaptureGraphWithCurrentMode];
  }
}

- (void)setTorchMode:(int64_t)a3
{
  v4 = [CAMCaptureConversions flashModeForTorchMode:a3];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:v4];
}

- (void)setHDRMode:(int64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _HDRButton];
  [v5 setHDRMode:a3];
  [(CAMViewfinderViewController *)self _handleHDRButtonChangedHDRMode];
}

- (void)changeToMode:(int64_t)a3 device:(int64_t)a4 animated:(BOOL)a5
{
  v5 = a5;
  v26 = *MEMORY[0x1E69E9840];
  v9 = [(CAMViewfinderViewController *)self availableCaptureModes];
  v10 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
  v11 = [v9 containsObject:v10];

  if (v11)
  {
    v12 = a3;
  }

  else
  {
    v12 = [(CAMViewfinderViewController *)self _availableDefaultCaptureMode];
    v13 = os_log_create("com.apple.camera", "Camera");
    v14 = os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT);
    if (v12 == -1)
    {
      if (v14)
      {
        if (a3 > 9)
        {
          v15 = 0;
        }

        else
        {
          v15 = off_1E76FA1E8[a3];
        }

        v22 = 138543362;
        v23 = v15;
        _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Ignoring request to change to unavailable mode %{public}@ because no valid mode is available", &v22, 0xCu);
      }

      goto LABEL_28;
    }

    if (v14)
    {
      if (v12 > 9)
      {
        v16 = 0;
      }

      else
      {
        v16 = off_1E76FA1E8[v12];
      }

      if (a3 > 9)
      {
        v17 = 0;
      }

      else
      {
        v17 = off_1E76FA1E8[a3];
      }

      v22 = 138543618;
      v23 = v16;
      v24 = 2114;
      v25 = v17;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Falling back to mode %{public}@ because requested mode %{public}@ is unavailable", &v22, 0x16u);
    }
  }

  if (v12 != -1)
  {
    if (v12 == 8)
    {
      v18 = 1;
    }

    else
    {
      if (v12 != 9)
      {
LABEL_24:
        v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v19 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:v12 device:a4 fromGraphConfiguration:v13];
        if (-[CAMViewfinderViewController _shouldResetZoomForChangeFromMode:toMode:](self, "_shouldResetZoomForChangeFromMode:toMode:", -[NSObject mode](v13, "mode"), [v19 mode]))
        {
          [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v19];
        }

        else
        {
          [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        }

        v21 = v20;
        [(CAMViewfinderViewController *)self _willChangeToGraphConfiguration:v19 zoomFactor:v13 fromGraphConfiguration:v5 animated:?];
        [(CAMViewfinderViewController *)self _changeToGraphConfiguration:v19 zoomFactor:v13 fromGraphConfiguration:v21];

LABEL_28:
        goto LABEL_29;
      }

      v18 = 0;
    }

    [(CAMViewfinderViewController *)self _setSpatialModeHasVideoSelected:v18];
    goto LABEL_24;
  }

LABEL_29:
}

- (BOOL)_isCapturing
{
  v3 = [(CAMViewfinderViewController *)self _captureController];
  v4 = ([v3 isCapturingVideo] & 1) != 0 || (objc_msgSend(v3, "isCapturingPanorama") & 1) != 0 || (objc_msgSend(v3, "isCapturingTimelapse") & 1) != 0 || (objc_msgSend(v3, "isCapturingNightModeImage") & 1) != 0 || -[CAMViewfinderViewController _isCapturingFromTimer](self, "_isCapturingFromTimer");

  return v4;
}

- (BOOL)isRecording
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  if ([v2 isCapturingVideo] & 1) != 0 || (objc_msgSend(v2, "isCapturingPanorama"))
  {
    v3 = 1;
  }

  else
  {
    v3 = [v2 isCapturingTimelapse];
  }

  return v3;
}

- (BOOL)isCapturingPhoto
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingStillImage];

  return v3;
}

- (BOOL)isCapturingLivePhoto
{
  v2 = [(CAMViewfinderViewController *)self _captureController];
  v3 = [v2 isCapturingLivePhotoVideo];

  return v3;
}

- (BOOL)capturePhoto
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  if (v3 > 9 || ((1 << v3) & 0x253) == 0)
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
}

- (BOOL)startRecording
{
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v5 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", v3, [v4 isCallActive]);

  if (!v5)
  {
    v8 = [(CAMViewfinderViewController *)self _currentMode];
    v7 = 0;
    if (v8 > 8)
    {
      goto LABEL_16;
    }

    if (((1 << v8) & 0x186) != 0)
    {
      v9 = [(CAMViewfinderViewController *)self _dynamicShutterControl];

      if (v9)
      {
        v10 = [(CAMViewfinderViewController *)self pressShutterButtonWithTouchUpDelay:0.1];
        goto LABEL_12;
      }

      v11 = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
      v12 = [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:v11];
    }

    else
    {
      if (v8 != 3)
      {
        if (v8 != 5)
        {
          goto LABEL_16;
        }

        v10 = [(CAMViewfinderViewController *)self _startTimelapse];
LABEL_12:
        v7 = v10;
        goto LABEL_16;
      }

      v11 = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      v12 = [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:v11];
    }

    v7 = v12;

    goto LABEL_16;
  }

  v6 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *v14 = 0;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Ignoring startRecording while current mode is disabled", v14, 2u);
  }

  v7 = 0;
LABEL_16:

  return v7;
}

- (BOOL)stopRecording
{
  v3 = [(CAMViewfinderViewController *)self _currentMode];
  if (v3 > 8)
  {
    return 0;
  }

  if (((1 << v3) & 0x186) != 0)
  {

    return [(CAMViewfinderViewController *)self _stopCapturingVideo];
  }

  if (v3 != 3)
  {
    if (v3 == 5)
    {

      return [(CAMViewfinderViewController *)self _stopTimelapse];
    }

    return 0;
  }

  return [(CAMViewfinderViewController *)self _stopCapturingPanorama];
}

- (void)setAvailableCaptureModes:(id)a3
{
  if (self->_availableCaptureModes != a3)
  {
    v4 = a3;
    v5 = [v4 copy];
    availableCaptureModes = self->_availableCaptureModes;
    self->_availableCaptureModes = v5;

    v7 = [(CAMViewfinderViewController *)self _currentMode];
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:v7];
    v9 = [v4 containsObject:v8];

    if ([(CAMViewfinderViewController *)self isViewLoaded])
    {
      v10 = [(CAMViewfinderViewController *)self _modeDial];
      [v10 reloadData];
      v11 = [(CAMViewfinderViewController *)self _availableDefaultCaptureMode];
      if (v7 == v11)
      {
        v12 = 1;
      }

      else
      {
        v12 = v9;
      }

      if ((v12 & 1) == 0)
      {
        v13 = v11;
        if (v11 != -1)
        {
          v14 = +[CAMUserPreferences preferences];
          v15 = [v14 defaultDeviceForModeChange:v13 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

          [(CAMViewfinderViewController *)self changeToMode:v13 device:v15 animated:0];
        }
      }
    }

    else
    {
      if (v9)
      {
LABEL_13:
        [(CAMViewfinderViewController *)self _updateChromeAvailableCaptureModes];
        return;
      }

      v10 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        *v16 = 0;
        _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Unable to automatically change to a valid mode view isn't loaded yet", v16, 2u);
      }
    }

    goto LABEL_13;
  }
}

- (void)setDisablingAdditionalCaptures:(BOOL)a3
{
  if (self->_disablingAdditionalCaptures != a3)
  {
    self->_disablingAdditionalCaptures = a3;
    if (!a3)
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }
}

- (void)setMessagesTransitionState:(int64_t)a3 animated:(BOOL)a4
{
  v24 = *MEMORY[0x1E69E9840];
  if (self->_messagesTransitionState == a3)
  {
    return;
  }

  v4 = a4;
  self->_messagesTransitionState = a3;
  v7 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    if (a3 > 3)
    {
      v8 = 0;
    }

    else
    {
      v8 = off_1E76FA130[a3];
    }

    v22 = 138543362;
    v23 = v8;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "MessagesTransitionState set to %{public}@", &v22, 0xCu);
  }

  v9 = [(CAMViewfinderViewController *)self _shouldDisableUserInteractionForTransitioning];
  v10 = [(CAMViewfinderViewController *)self view];
  [v10 setUserInteractionEnabled:!v9];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  v11 = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v12 = [(CAMViewfinderViewController *)self messagesTransitionState];
  if (v12 <= 1)
  {
    if (v12)
    {
      if (v12 == 1)
      {
        [v11 addClosedViewfinderReason:10];
      }

      goto LABEL_15;
    }

LABEL_13:
    [v11 removeClosedViewfinderReason:10];
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    goto LABEL_15;
  }

  if (v12 == 2)
  {
    v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v13 setControlDrawerExpanded:0 forReason:7 animated:0];

    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
    goto LABEL_15;
  }

  if (v12 == 3)
  {
    goto LABEL_13;
  }

LABEL_15:
  if ([(CAMViewfinderViewController *)self messagesTransitionState]== 3)
  {
    v14 = [(CAMViewfinderViewController *)self _closedViewfinderController];
    v15 = [v14 isViewfinderClosed];

    if (v15)
    {
      v16 = [(CAMViewfinderViewController *)self _transitionController];
      [v16 closeWithBlur:1 animated:0 withCompletionHandler:0];
    }
  }

  v17 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v18 = [(CAMViewfinderViewController *)self _shouldHideShutterButtonForGraphConfiguration:v17];

  v19 = !v18;
  v20 = [(CAMViewfinderViewController *)self _shutterButton];
  [v20 setAlpha:v19];

  v21 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v21 setShutterControlVisible:v19];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v4];
}

- (int64_t)_availableDefaultCaptureMode
{
  v2 = [(CAMViewfinderViewController *)self availableCaptureModes];
  v3 = [v2 count];
  if (v3 == 1)
  {
LABEL_8:
    v8 = [v2 anyObject];
    v5 = [v8 integerValue];

    goto LABEL_10;
  }

  if (v3)
  {
    v6 = [v2 containsObject:&unk_1F16C7748];
    v7 = [v2 containsObject:&unk_1F16C75F8];
    if ((v6 & 1) != 0 || v7)
    {
      v5 = v6 ^ 1u;
      goto LABEL_10;
    }

    goto LABEL_8;
  }

  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController _availableDefaultCaptureMode];
  }

  v5 = -1;
LABEL_10:

  return v5;
}

- (id)_supportedCaptureModes
{
  v3 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 isBackTimelapseSupported])
  {
    v14 = 0;
  }

  else
  {
    v14 = [v4 isFrontTimelapseSupported] ^ 1;
  }

  if ([v4 isBackSlomoSupported])
  {
    v5 = 0;
  }

  else
  {
    v5 = [v4 isFrontSlomoSupported] ^ 1;
  }

  v6 = [v4 isVideoSupported];
  if ([v4 isSquareModeSupported])
  {
    v15 = [v4 wantsFullscreenViewfinder];
  }

  else
  {
    v15 = 1;
  }

  if ([v4 isBackPanoramaSupported])
  {
    v7 = 0;
  }

  else
  {
    v7 = [v4 isFrontPanoramaSupported] ^ 1;
  }

  v8 = [v4 isPortraitModeSupported];
  v9 = [v4 isCinematicModeSupported];
  v10 = [v4 isSpatialModeSupported];
  v11 = ([v4 portraitInPhotoModeBehavior] & 8) == 0;
  v12 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (((v14 | v12) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7658];
  }

  if (((v5 | v12) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7610];
  }

  if (v6)
  {
    [v3 addObject:&unk_1F16C75F8];
  }

  [v3 addObject:&unk_1F16C7748];
  if ((v11 & v8) != 0)
  {
    [v3 addObject:&unk_1F16C7670];
  }

  if (((v15 | v12) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7640];
  }

  if (((v7 | v12) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7628];
  }

  if (!v12 && (v9 & 1) != 0)
  {
    [v3 addObject:&unk_1F16C7688];
  }

  if (!v12 && (v10 & 1) != 0)
  {
    [v3 addObject:&unk_1F16C76B8];
    [v3 addObject:&unk_1F16C76A0];
  }

  return v3;
}

- (void)_setPreventingAdditionalCaptures:(BOOL)a3
{
  v7 = *MEMORY[0x1E69E9840];
  if (self->_preventingAdditionalCaptures != a3)
  {
    v3 = a3;
    v5 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      v6[0] = 67109120;
      v6[1] = v3;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Preventing additional captures %d", v6, 8u);
    }

    self->_preventingAdditionalCaptures = v3;
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Preventing Multiple Captures for Single-Capture-Only Client"];
  }
}

- (void)setAutomaticallyAdjustsApplicationIdleTimer:(BOOL)a3
{
  if (self->_automaticallyAdjustsApplicationIdleTimer != a3)
  {
    v4 = a3;
    self->_automaticallyAdjustsApplicationIdleTimer = a3;
    v5 = [(CAMViewfinderViewController *)self _idleController];
    v6 = v5;
    if (v4)
    {
      [v5 startUpdatingIdleTimer];
    }

    else
    {
      [v5 stopUpdatingIdleTimer];
    }
  }
}

- (void)setPersistenceBehavior:(unint64_t)a3
{
  if (self->_persistenceBehavior != a3)
  {
    v5 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    v6 = 3;
    if (!v5)
    {
      v6 = a3;
    }

    self->_persistenceBehavior = v6;
  }
}

- (void)setShowingStandardControls:(BOOL)a3
{
  if (self->_showingStandardControls != a3)
  {
    v4 = a3;
    self->_showingStandardControls = a3;
    v11 = [(CAMViewfinderViewController *)self _previewViewController];
    [v11 setShowingStandardControls:v4];
    v6 = [(CAMViewfinderViewController *)self viewfinderView];
    [v6 setShowingStandardControls:v4];

    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v7 setShowingStandardControls:v4];

    v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinderZoomStyle];
    v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v9 setZoomStyle:v8];

    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderZoomSliderIfNecessary];
    if (v4)
    {
      [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
      [(CAMViewfinderViewController *)self _createCommonGestureRecognizersIfNecessary];
      v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:v10];
    }

    else
    {
      [(CAMViewfinderViewController *)self _destroyGestureRecognizersRequiringStandardControls];
      [(CAMViewfinderViewController *)self _unembedAndDestroyAllControls];
    }
  }
}

- (void)setImagePickerVideoConfiguration:(int64_t)a3
{
  if (self->_imagePickerVideoConfiguration != a3)
  {
    self->_imagePickerVideoConfiguration = a3;
    v4 = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    v5 = [(CAMViewfinderViewController *)self _currentMode];
    if (v4 && v5 == 1)
    {

      [(CAMViewfinderViewController *)self _reconfigureCaptureGraphWithCurrentMode];
    }
  }
}

- (void)setCustomPreviewViewTransform:(CGAffineTransform *)a3
{
  if ([(CAMViewfinderViewController *)self emulationMode])
  {
    v5 = *&self->_customPreviewViewTransform.c;
    *&t1.a = *&self->_customPreviewViewTransform.a;
    *&t1.c = v5;
    *&t1.tx = *&self->_customPreviewViewTransform.tx;
    v6 = *&a3->c;
    *&v9.a = *&a3->a;
    *&v9.c = v6;
    *&v9.tx = *&a3->tx;
    if (!CGAffineTransformEqualToTransform(&t1, &v9))
    {
      v7 = *&a3->a;
      v8 = *&a3->tx;
      *&self->_customPreviewViewTransform.c = *&a3->c;
      *&self->_customPreviewViewTransform.tx = v8;
      *&self->_customPreviewViewTransform.a = v7;
      [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
    }
  }
}

- (void)setPerformingReviewUsingOverlay:(BOOL)a3
{
  if (self->_performingReviewUsingOverlay != a3)
  {
    v4 = a3;
    self->_performingReviewUsingOverlay = a3;
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _currentMode]];
    v7 = [(CAMViewfinderViewController *)self _closedViewfinderController];
    v6 = [(CAMViewfinderViewController *)self _disabledPreviewController];
    if (v4)
    {
      [v7 addClosedViewfinderReason:9];
      [v6 addDisabledPreviewReason:1];
      [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
    }

    else
    {
      [v7 removeClosedViewfinderReason:9];
      [v6 removeDisabledPreviewReason:1];
      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
      if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
      {
        [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
      }
    }
  }
}

- (CGRect)reviewUsingOverlayFrame
{
  v3 = [(CAMViewfinderViewController *)self _previewViewController];
  v4 = [v3 previewView];

  [v4 bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  Width = v11;
  v13 = [(CAMViewfinderViewController *)self view];
  v14 = [v13 window];
  v15 = CAMInterfaceOrientationForWindow(v14);

  if ((v15 - 3) <= 1)
  {
    v25.origin.x = v6;
    v25.origin.y = v8;
    v25.size.width = v10;
    v25.size.height = Width;
    MinX = CGRectGetMinX(v25);
    v26.origin.x = v6;
    v26.origin.y = v8;
    v26.size.width = v10;
    v26.size.height = Width;
    MinY = CGRectGetMinY(v26);
    v27.origin.x = v6;
    v27.origin.y = v8;
    v27.size.width = v10;
    v27.size.height = Width;
    Height = CGRectGetHeight(v27);
    v28.origin.x = v6;
    v28.origin.y = v8;
    v28.size.width = v10;
    v28.size.height = Width;
    Width = CGRectGetWidth(v28);
    v10 = Height;
    v8 = MinY;
    v6 = MinX;
  }

  v29.origin.x = v6;
  v29.origin.y = v8;
  v29.size.width = v10;
  v29.size.height = Width;
  v19 = CGRectGetWidth(v29);
  v30.origin.x = v6;
  v30.origin.y = v8;
  v30.size.width = v10;
  v30.size.height = Width;
  v20 = CGRectGetHeight(v30);

  v21 = 0.0;
  v22 = 0.0;
  v23 = v19;
  v24 = v20;
  result.size.height = v24;
  result.size.width = v23;
  result.origin.y = v22;
  result.origin.x = v21;
  return result;
}

- (int64_t)_videoConfigurationForImagePickerQualityType:(int64_t)a3
{
  if (a3 >= 6)
  {
    return 0;
  }

  else
  {
    return a3 + 10000;
  }
}

- (void)_setUpTipManagerIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  if ([v3 smartStylesSupported])
  {
    if (!CFPreferencesGetAppBooleanValue(@"CAMSmartStylesTipWasPresented", @"com.apple.camera", 0))
    {
      v4 = AVSmartStyleSettingsGetSystemStyleFast();

      if (!v4)
      {
        v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v6 = [v5 controlStatusBar];

        v7 = [v6 smartStyleIndicator];

        if (v7)
        {
          v8 = dispatch_get_global_queue(21, 0);
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke;
          v9[3] = &unk_1E76F9C08;
          v9[4] = self;
          v10 = v6;
          v11 = @"CAMSmartStylesTipWasPresented";
          v12 = @"com.apple.camera";
          dispatch_async(v8, v9);
        }
      }
    }
  }
}

void __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke(uint64_t a1)
{
  if ([MEMORY[0x1E69C4320] sharedPhotoLibraryIsEligibleForStylesSetupTip])
  {
    v3[0] = MEMORY[0x1E69E9820];
    v3[1] = 3221225472;
    v3[2] = __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke_2;
    v3[3] = &unk_1E76F9C08;
    v2 = *(a1 + 40);
    v3[4] = *(a1 + 32);
    v4 = v2;
    v5 = *(a1 + 48);
    dispatch_async(MEMORY[0x1E69E96A0], v3);
  }
}

void __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke_2(uint64_t a1)
{
  if (!+[CAMApplication appOrPlugInState](CAMApplication, "appOrPlugInState") && ([*(a1 + 32) _isShowingCameraRoll] & 1) == 0 && (objc_msgSend(*(a1 + 32), "isPreventingAdditionalCaptures") & 1) == 0)
  {
    v2 = [*(a1 + 32) _primaryShutterControl];
    v3 = [v2 isTracking];

    if ((v3 & 1) == 0)
    {
      v4 = [*(a1 + 32) _motionController];
      v5 = [v4 captureOrientation];

      if (v5 == 1)
      {
        [*(a1 + 40) frame];
        MaxY = CGRectGetMaxY(v15);
        v7 = [*(a1 + 32) view];
        [v7 safeAreaInsets];
        v9 = MaxY - v8 + 55.0;

        v10 = [*(a1 + 40) directionIndicator];
        v13 = [CAMViewfinderTipManager stylesTipViewControllerWithSourceItem:v10];

        v11 = [v13 popoverPresentationController];
        [v11 setPermittedArrowDirections:0];

        v12 = [v13 popoverPresentationController];
        [v12 setPopoverLayoutMargins:{v9, 0.0, 0.0, 0.0}];

        [*(a1 + 32) presentViewController:v13 animated:1 completion:0];
        CFPreferencesSetAppValue(*(a1 + 48), MEMORY[0x1E695E118], *(a1 + 56));
      }
    }
  }
}

- (void)captureController:(id)a3 didOutputShallowDepthOfFieldStatus:(int64_t)a4 stagePreviewStatus:(int64_t)a5
{
  v25 = *MEMORY[0x1E69E9840];
  v8 = [(CAMViewfinderViewController *)self _currentMode];
  v9 = v8;
  if (v8 > 9)
  {
LABEL_27:
    if (!v8)
    {
      v16 = +[CAMCaptureCapabilities capabilities];
      if ([v16 isPhotoModeDepthSuggestionSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
      {
        v17 = +[CAMCaptureCapabilities capabilities];
        if ([v17 featureDevelopmentIgnoreDepthSuggestionInPhotoMode])
        {
          a4 = 0;
        }
      }

      else
      {
        a4 = 0;
      }
    }

    goto LABEL_4;
  }

  if (((1 << v8) & 0x33C) != 0)
  {
    a4 = 0;
    goto LABEL_4;
  }

  if (v8 != 1)
  {
    if (v8 == 7)
    {
      if (a4 - 1) < 0xF && ((0x7DE7u >> (a4 - 1)))
      {
        a4 = 0;
      }

      goto LABEL_4;
    }

    goto LABEL_27;
  }

  if ((0x7DEFu >> (a4 - 1)))
  {
    v18 = 0;
  }

  else
  {
    v18 = a4;
  }

  if ((a4 - 1) < 0xF)
  {
    a4 = v18;
  }

LABEL_4:
  if (([(CAMViewfinderViewController *)self portraitModeLightingEffectType]- 7) < 0xFFFFFFFFFFFFFFFDLL || a4 == 0)
  {
    a5 = 0;
  }

  v11 = +[CAMApplication appOrPlugInState];
  v12 = os_log_create("com.apple.camera", "Portrait");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    if (v9 > 9)
    {
      v13 = 0;
    }

    else
    {
      v13 = off_1E76FA1E8[v9];
    }

    if (a4 > 0xF)
    {
      v14 = 0;
    }

    else
    {
      v14 = off_1E76FA150[a4];
    }

    if (a5 > 2)
    {
      v15 = 0;
    }

    else
    {
      v15 = off_1E76FA1D0[a5];
    }

    v19 = 138543874;
    v20 = v13;
    v21 = 2114;
    v22 = v14;
    v23 = 2114;
    v24 = v15;
    _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Updating shallow depth of field status in %{public}@ Mode: %{public}@/%{public}@", &v19, 0x20u);
  }

  [(CAMViewfinderViewController *)self _setShallowDepthOfFieldStatus:a4 stagePreviewStatus:a5 animated:v11 != 2];
}

- (void)_setShallowDepthOfFieldStatus:(int64_t)a3 stagePreviewStatus:(int64_t)a4 animated:(BOOL)a5
{
  v5 = a5;
  if (self->__shallowDepthOfFieldStatus != a3 || self->__stagePreviewStatus != a4)
  {
    self->__stagePreviewStatus = a4;
    self->__shallowDepthOfFieldStatus = a3;
    [(CAMViewfinderViewController *)self _updateForShallowDepthOfFieldStatusChangedAnimated:a5];
    [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:v5];
    v7 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [v7 setShallowDepthOfFieldStatus:self->__shallowDepthOfFieldStatus];
  }
}

- (void)_updateForShallowDepthOfFieldStatusChangedAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
  v6 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v6 setShallowDepthOfFieldStatus:v5 animated:v3];

  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  v7 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  [v7 setShallowDepthOfFieldStatus:v5 animated:v3];

  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  LODWORD(v7) = v5 < 0xF;
  v8 = 0x6202u >> v5;
  v10 = [(CAMViewfinderViewController *)self _lightingControl];
  [v10 setHighlighted:v7 & (0x6202u >> v5) animated:v3];
  v9 = [(CAMViewfinderViewController *)self _lightingNameBadge];
  [v9 setHighlighted:v7 & v8 animated:v3];

  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:v3];
  }

  [(CAMViewfinderViewController *)self _updateZoomControlAccessoryStateAnimated:v3];
}

- (void)_updatePreviewControllerPortraitStatus
{
  v3 = [(CAMViewfinderViewController *)self _stagePreviewStatus];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:v4];

  if (v5)
  {
    v6 = v3;
  }

  else
  {
    v6 = 0;
  }

  v7 = [(CAMViewfinderViewController *)self _captureController];
  v8 = [v7 isCapturingBurst];

  v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v10 = [v9 isSemanticStyleControlVisible];

  v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v12 = [v11 isSmartStylePickerVisible];

  if ((v12 | v10 | v8))
  {
    v13 = 0;
  }

  else
  {
    v13 = v6;
  }

  v14 = [(CAMViewfinderViewController *)self _previewViewController];
  [v14 setShallowDepthOfFieldStatus:-[CAMViewfinderViewController _shallowDepthOfFieldStatus](self stagePreviewStatus:{"_shallowDepthOfFieldStatus"), v13}];
}

- (BOOL)_shouldShowDescriptionOverlayViewForGraphConfiguration:(id)a3 viewClass:(Class *)a4
{
  v6 = a3;
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = +[CAMUserPreferences preferences];
  v9 = [v7 bypassWelcomeScreens];
  v10 = [v6 mode];

  if ([v7 hostProcess])
  {
    if (([v7 hostProcess] != 4) | v9 & 1)
    {
      goto LABEL_5;
    }
  }

  else if (v9)
  {
    goto LABEL_5;
  }

  if (([v8 didAcknowledgeSolCamDescription] & 1) != 0 || -[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") == 1)
  {
    LOBYTE(v12) = 0;
    v11 = 0;
    if (v10 <= 7)
    {
      if (v10)
      {
        if (v10 == 6)
        {
          if ([v7 allowPortraitDescriptionOverlay])
          {
            v12 = [v8 didAcknowledgePortraitModeDescription] ^ 1;
          }

          else
          {
            LOBYTE(v12) = 0;
          }
        }

        else
        {
          if (v10 != 7)
          {
            goto LABEL_35;
          }

          v12 = [v8 didAcknowledgeCinematicModeDescription] ^ 1;
        }

        goto LABEL_34;
      }

      v13 = [v7 semanticStylesSupport];
      if ([v7 isDepthEffectApertureSupportedForMode:0 devicePosition:0])
      {
        if ((v13 & 8) == 0 || ![v7 smartStylesOnboardingSupported])
        {
          goto LABEL_30;
        }

        goto LABEL_28;
      }

      v14 = [v7 isDepthEffectApertureSupportedForMode:0 devicePosition:1];
      v15 = v14;
      if ((v13 & 8) != 0)
      {
        if ([v7 smartStylesOnboardingSupported])
        {
LABEL_28:
          v12 = [v8 didAcknowledgeSmartStylesDescription] ^ 1;
          goto LABEL_34;
        }

        if ((v15 & 1) == 0)
        {
          v12 = [v8 didAcknowledgeSemanticStylesDescription] ^ 1;
          goto LABEL_34;
        }
      }

      else if (!v14)
      {
        if ([v7 isLongPressVideoCaptureFromPhotoModeSupported])
        {
          v12 = [v8 didAcknowledgeCTMDescription] ^ 1;
        }

        else
        {
          LOBYTE(v12) = 0;
        }

        goto LABEL_34;
      }

LABEL_30:
      if (([v7 smartStylesSupported] & 1) == 0)
      {
        v12 = [v8 didAcknowledgeDepthInPhotoModeDescription] ^ 1;
        goto LABEL_34;
      }

LABEL_5:
      v11 = 0;
      LOBYTE(v12) = 0;
      goto LABEL_35;
    }

    if ((v10 - 8) >= 2)
    {
      goto LABEL_35;
    }

    v12 = [v8 didAcknowledgeSpatialModeOverlayDescription] ^ 1;
  }

  else
  {
    LOBYTE(v12) = 1;
  }

LABEL_34:
  v11 = objc_opt_class();
LABEL_35:
  if (a4)
  {
    *a4 = v11;
  }

  return v12;
}

- (void)_acknowledgeDescriptionOverlayViewForMode:(int64_t)a3
{
  v5 = +[CAMUserPreferences preferences];
  if (a3 > 7)
  {
    if ((a3 - 8) >= 2)
    {
      goto LABEL_20;
    }

    v14 = v5;
    [v5 setDidAcknowledgeSpatialModeOverlayDescription:1];
    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:v6 animated:1];
  }

  else
  {
    if (a3)
    {
      if (a3 == 6)
      {
        v14 = v5;
        [v5 setDidAcknowledgePortraitModeDescription:1];
      }

      else
      {
        if (a3 != 7)
        {
          goto LABEL_20;
        }

        v14 = v5;
        [v5 setDidAcknowledgeCinematicModeDescription:1];
      }

      goto LABEL_19;
    }

    v14 = v5;
    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 semanticStylesSupport];

    v9 = +[CAMCaptureCapabilities capabilities];
    if ([v9 isDepthEffectApertureSupportedForMode:0 devicePosition:0])
    {

      if ((v8 & 8) == 0)
      {
        goto LABEL_18;
      }

      LOBYTE(v10) = 1;
LABEL_15:
      v12 = +[CAMCaptureCapabilities capabilities];
      v13 = [v12 smartStylesSupported];

      if (v13)
      {
        [v14 setDidAcknowledgeSmartStylesDescription:1];
        goto LABEL_19;
      }

      if ((v10 & 1) == 0)
      {
        [v14 setDidAcknowledgeSemanticStylesDescription:1];
        goto LABEL_19;
      }

LABEL_18:
      [v14 setDidAcknowledgeDepthInPhotoModeDescription:1];
      goto LABEL_19;
    }

    v11 = +[CAMCaptureCapabilities capabilities];
    v10 = [v11 isDepthEffectApertureSupportedForMode:0 devicePosition:1];

    if ((v8 & 8) != 0)
    {
      goto LABEL_15;
    }

    if (v10)
    {
      goto LABEL_18;
    }

    [v14 setDidAcknowledgeCTMDescription:1];
  }

LABEL_19:
  v5 = v14;
LABEL_20:
}

- (id)_embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 mode];
  v18 = 0;
  v6 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v4 viewClass:&v18];

  v7 = 0;
  if (v6)
  {
    v8 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:v5];
    v10 = [v8 objectForKeyedSubscript:v9];
    v11 = [v10 isMemberOfClass:objc_opt_class()];

    v12 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v13 = [MEMORY[0x1E696AD98] numberWithInteger:v5];
    if (v11)
    {
      [v12 setObject:0 forKeyedSubscript:v13];
    }

    else
    {
      v7 = [v12 objectForKeyedSubscript:v13];

      if (v7)
      {
        goto LABEL_7;
      }
    }

    v14 = [v18 alloc];
    v7 = [v14 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    [v7 setVisible:0 animationDuration:0 completion:0.0];
    [v7 setDelegate:self];
  }

  [(CAMViewfinderViewController *)self _embedDescriptionOverlayView:v7 forMode:v5];
  v15 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v16 = [MEMORY[0x1E696AD98] numberWithInteger:v5];
  [v15 setObject:v7 forKeyedSubscript:v16];

LABEL_7:

  return v7;
}

- (void)_embedDescriptionOverlayView:(id)a3 forMode:(int64_t)a4
{
  v6 = a3;
  v9 = [(CAMViewfinderViewController *)self viewfinderView];
  if (v9)
  {
    v7 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
    [v9 setDescriptionOverlayView:v6 forKey:v7];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
    [v7 setDescriptionOverlayView:v6 forKey:v8];

    v6 = v8;
  }
}

- (void)_dismissDescriptionOverlayView:(id)a3 withDuration:(double)a4 fromUserAction:(BOOL)a5
{
  v8 = a3;
  if (v8)
  {
    if (!a5 && [v8 isMemberOfClass:objc_opt_class()])
    {
      [CAMPreferencesUtilities setBool:1 inCameraDomainForKey:@"CAMSmartStylesOnboardingCameraAppDidDismissForAction"];
    }

    v24 = 0;
    v25 = &v24;
    v26 = 0x2020000000;
    v27 = 0;
    v9 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v21[0] = MEMORY[0x1E69E9820];
    v21[1] = 3221225472;
    v21[2] = __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke;
    v21[3] = &unk_1E76F9C30;
    v10 = v8;
    v22 = v10;
    v23 = &v24;
    [v9 enumerateKeysAndObjectsUsingBlock:v21];

    v11 = +[CAMUserPreferences preferences];
    if (([v10 isMemberOfClass:objc_opt_class()] & 1) == 0 || (objc_msgSend(v11, "setDidAcknowledgeSolCamDescription:", 1), !a5))
    {
      [(CAMViewfinderViewController *)self _acknowledgeDescriptionOverlayViewForMode:v25[3]];
    }

    v12 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v13 = [MEMORY[0x1E696AD98] numberWithInteger:v25[3]];
    [v12 setObject:0 forKeyedSubscript:v13];

    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    LODWORD(v12) = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:v14];

    v19[0] = MEMORY[0x1E69E9820];
    v19[1] = 3221225472;
    v19[2] = __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke_2;
    v19[3] = &unk_1E76F9C58;
    v20 = v12;
    v19[4] = self;
    v19[5] = &v24;
    [v10 setVisible:0 animationDuration:v19 completion:a4];
    [v10 setDelegate:0];
    v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v15 setIsShowingOverlayDescription:0];

    if (([v10 isMemberOfClass:objc_opt_class()] & v12) == 1)
    {
      v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v17 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:v16];
      [v17 setVisible:1 animationDuration:0 completion:a4];

      v18 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [v18 setIsShowingOverlayDescription:1];
    }

    _Block_object_dispose(&v24, 8);
  }
}

uint64_t __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke(uint64_t result, void *a2, uint64_t a3, _BYTE *a4)
{
  if (*(result + 32) == a3)
  {
    v5 = result;
    result = [a2 integerValue];
    *(*(*(v5 + 40) + 8) + 24) = result;
    *a4 = 1;
  }

  return result;
}

uint64_t __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke_2(uint64_t result)
{
  if ((*(result + 48) & 1) == 0)
  {
    return [*(result + 32) _embedDescriptionOverlayView:0 forMode:*(*(*(result + 40) + 8) + 24)];
  }

  return result;
}

- (void)_updateDescriptionOverlayVisibilityForMode:(int64_t)a3 allowShow:(BOOL)a4 allowHide:(BOOL)a5 animated:(BOOL)a6
{
  v11 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v16[0] = MEMORY[0x1E69E9820];
  v16[1] = 3221225472;
  v16[2] = __103__CAMViewfinderViewController__updateDescriptionOverlayVisibilityForMode_allowShow_allowHide_animated___block_invoke;
  v16[3] = &__block_descriptor_43_e52_v32__0__NSNumber_8__CAMDescriptionOverlayView_16_B24l;
  v16[4] = a3;
  v17 = a4;
  v18 = a5;
  v19 = a6;
  [v11 enumerateKeysAndObjectsUsingBlock:v16];

  v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v13 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v14 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
  v15 = [v13 objectForKeyedSubscript:v14];
  [v12 setIsShowingOverlayDescription:{objc_msgSend(v15, "isVisible")}];
}

void __103__CAMViewfinderViewController__updateDescriptionOverlayVisibilityForMode_allowShow_allowHide_animated___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v10 = a3;
  v5 = [a2 integerValue];
  v6 = *(a1 + 32);
  v7 = *(a1 + 40) == 1 && v5 == v6;
  if (v7 || (*(a1 + 41) == 1 ? (v8 = v5 == v6) : (v8 = 1), !v8))
  {
    v9 = 0.25;
    if (!*(a1 + 42))
    {
      v9 = 0.0;
    }

    [v10 setVisible:v5 == v6 animationDuration:0 completion:v9];
  }
}

- (void)descriptionOverlayView:(id)a3 willBecomeVisible:(BOOL)a4
{
  v4 = a4;
  v9 = a3;
  if ([v9 isMemberOfClass:objc_opt_class()])
  {
    if (v4)
    {
      v6 = objc_alloc_init(CAMSmartStyleSettingsController);
      prewarmedSmartStylesController = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = v6;

      v8 = [(CAMSmartStyleSettingsController *)self->__prewarmedSmartStylesController view];
      [v8 setAlpha:0.0];
      [v9 bounds];
      [v8 setFrame:?];
      [v8 setAutoresizingMask:18];
      [v9 addSubview:v8];
    }

    else
    {
      v8 = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = 0;
    }
  }
}

- (void)descriptionOverlayViewDidSelectDetail:(id)a3
{
  v4 = a3;
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  v5 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __69__CAMViewfinderViewController_descriptionOverlayViewDidSelectDetail___block_invoke;
  v13[3] = &unk_1E76F9C30;
  v6 = v4;
  v14 = v6;
  v15 = &v16;
  [v5 enumerateKeysAndObjectsUsingBlock:v13];

  if (!v17[3])
  {
    if ([v6 isMemberOfClass:objc_opt_class()])
    {
      v7 = objc_alloc_init(CAMSemanticStyleSettingsController);
      [(CAMSemanticStyleSettingsController *)v7 setControllerDelegate:self];
      if (![(CAMViewfinderViewController *)self _layoutStyle])
      {
        [(CAMSemanticStyleSettingsController *)v7 setModalPresentationStyle:0];
      }

      if (!v7)
      {
        goto LABEL_13;
      }
    }

    else
    {
      if (![v6 isMemberOfClass:objc_opt_class()])
      {
        v7 = 0;
        goto LABEL_13;
      }

      v8 = os_log_create("com.apple.camera", "SmartStyleSettings");
      if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
      {
        *v12 = 0;
        _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Onboarding: presenting smart style settings", v12, 2u);
      }

      v9 = self->__prewarmedSmartStylesController;
      [(CAMSmartStyleSettingsController *)v9 setControllerDelegate:self];
      [(CAMSmartStyleSettingsController *)v9 setModalPresentationStyle:0];
      v10 = [(CAMSmartStyleSettingsController *)v9 view];
      [v10 setAlpha:1.0];
      [v10 removeFromSuperview];
      [(CAMSmartStyleSettingsController *)v9 speedUpFadeInAnimations];
      v7 = v9;
      prewarmedSmartStylesController = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = 0;

      [CAMPreferencesUtilities setBool:1 inCameraDomainForKey:@"CAMSmartStylesOnboardingCameraAppDidTapChooseStyle"];
      if (!v7)
      {
        goto LABEL_13;
      }
    }

    [(CAMViewfinderViewController *)self presentViewController:v7 animated:1 completion:0];
    [(CAMViewfinderViewController *)self _dismissDescriptionOverlayView:v6 withDuration:1 fromUserAction:0.5];
LABEL_13:
  }

  _Block_object_dispose(&v16, 8);
}

uint64_t __69__CAMViewfinderViewController_descriptionOverlayViewDidSelectDetail___block_invoke(uint64_t result, void *a2, uint64_t a3, _BYTE *a4)
{
  if (*(result + 32) == a3)
  {
    v5 = result;
    result = [a2 integerValue];
    *(*(*(v5 + 40) + 8) + 24) = result;
    *a4 = 1;
  }

  return result;
}

- (void)descriptionOverlayViewSetTextViewFrame:(id)a3 textViewFrame:(CGRect)a4
{
  [a3 textViewFrame];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  v13 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v13 setDescriptionOverlayTextViewFrame:{v6, v8, v10, v12}];
}

- (BOOL)_shouldDisableModeForGraphConfiguration:(id)a3 callActive:(BOOL)a4
{
  v4 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:a3 callActive:a4];
  v5 = [v4 count] != 0;

  return v5;
}

- (id)_disabledModeReasonsForGraphConfiguration:(id)a3 callActive:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [v6 mode];
  v9 = v7 <= 8 && ((1 << v7) & 0x186) != 0 && v4;
  v10 = [(CAMViewfinderViewController *)self _captureController];
  if ([v10 isInterrupted])
  {
    v11 = [v10 currentCameraSystemPressureState];
    v12 = [v11 isCameraTooHot];
  }

  else
  {
    v12 = 0;
  }

  v18 = 0;
  v19 = &v18;
  v20 = 0x3032000000;
  v21 = __Block_byref_object_copy__5;
  v22 = __Block_byref_object_dispose__5;
  v23 = 0;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __84__CAMViewfinderViewController__disabledModeReasonsForGraphConfiguration_callActive___block_invoke;
  aBlock[3] = &unk_1E76F9CA0;
  aBlock[4] = &v18;
  v13 = _Block_copy(aBlock);
  v14 = v13;
  if (v9)
  {
    (*(v13 + 2))(v13, 0);
  }

  if (v12)
  {
    v14[2](v14, 1);
  }

  v15 = v19[5];

  _Block_object_dispose(&v18, 8);

  return v15;
}

void __84__CAMViewfinderViewController__disabledModeReasonsForGraphConfiguration_callActive___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(*(*(a1 + 32) + 8) + 40);
  if (!v3)
  {
    v5 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    v6 = *(*(a1 + 32) + 8);
    v7 = *(v6 + 40);
    *(v6 + 40) = v5;

    v3 = *(*(*(a1 + 32) + 8) + 40);
  }

  v8 = [MEMORY[0x1E696AD98] numberWithInteger:a2];
  [v3 addObject:v8];
}

- (BOOL)_shouldSuspendCaptureSessionForGraphConfiguration:(id)a3 callActive:(BOOL)a4
{
  v4 = self;
  v5 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:a3 callActive:a4];
  LOBYTE(v4) = [(CAMViewfinderViewController *)v4 _shouldSuspendCaptureSessionForModeDisabledReasons:v5];

  return v4;
}

- (BOOL)_shouldSuspendCaptureSessionForModeDisabledReasons:(id)a3
{
  v16 = *MEMORY[0x1E69E9840];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v4 = a3;
  v5 = [v4 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v12;
    while (2)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v12 != v7)
        {
          objc_enumerationMutation(v4);
        }

        if (-[CAMViewfinderViewController _shouldSuspendCaptureSessionForModeDisabledReason:](self, "_shouldSuspendCaptureSessionForModeDisabledReason:", [*(*(&v11 + 1) + 8 * i) integerValue]))
        {
          v9 = 1;
          goto LABEL_11;
        }
      }

      v6 = [v4 countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v6)
      {
        continue;
      }

      break;
    }
  }

  v9 = 0;
LABEL_11:

  return v9;
}

- (BOOL)_shouldDisableEventInteractionForGraphConfiguration:(id)a3 callActive:(BOOL)a4
{
  v4 = self;
  v5 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:a3 callActive:a4];
  LOBYTE(v4) = [(CAMViewfinderViewController *)v4 _shouldDisableEventInteractionForModeDisabledReasons:v5];

  return v4;
}

- (BOOL)_shouldDisableEventInteractionForModeDisabledReasons:(id)a3
{
  v16 = *MEMORY[0x1E69E9840];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v4 = a3;
  v5 = [v4 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v12;
    while (2)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v12 != v7)
        {
          objc_enumerationMutation(v4);
        }

        if (-[CAMViewfinderViewController _shouldDisableEventInteractionForModeDisabledReason:](self, "_shouldDisableEventInteractionForModeDisabledReason:", [*(*(&v11 + 1) + 8 * i) integerValue]))
        {
          v9 = 1;
          goto LABEL_11;
        }
      }

      v6 = [v4 countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v6)
      {
        continue;
      }

      break;
    }
  }

  v9 = 0;
LABEL_11:

  return v9;
}

- (id)_debugStringForDisabledModeReasons:(id)a3
{
  v20 = *MEMORY[0x1E69E9840];
  v3 = a3;
  if ([v3 count])
  {
    v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v3, "count")}];
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v5 = v3;
    v6 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v16;
      do
      {
        for (i = 0; i != v7; ++i)
        {
          if (*v16 != v8)
          {
            objc_enumerationMutation(v5);
          }

          v10 = [*(*(&v15 + 1) + 8 * i) integerValue];
          if (v10 == 1)
          {
            v11 = @"CameraTooHot";
          }

          else
          {
            v11 = 0;
          }

          if (v10)
          {
            v12 = v11;
          }

          else
          {
            v12 = @"ActiveCall";
          }

          [v4 addObject:v12];
        }

        v7 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
      }

      while (v7);
    }

    v13 = [v4 componentsJoinedByString:{@", "}];
  }

  else
  {
    v13 = @"<none>";
  }

  return v13;
}

- (void)_embedDisabledModeOverlayView:(id)a3
{
  v4 = a3;
  v7 = [(CAMViewfinderViewController *)self viewfinderView];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = v7;
  if (!v7)
  {
    v6 = v5;
  }

  [v6 setDisabledModeOverlayView:v4];
}

- (void)_unembedDisabledModeOverlayView:(id)a3
{
  v10 = a3;
  v4 = [(CAMViewfinderViewController *)self viewfinderView];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = v5;
  if (v4)
  {
    v7 = [v4 disabledModeOverlayView];

    if (v7 != v10)
    {
      goto LABEL_7;
    }

    v8 = v4;
  }

  else
  {
    v9 = [v5 disabledModeOverlayView];

    if (v9 != v10)
    {
      goto LABEL_7;
    }

    v8 = v6;
  }

  [v8 setDisabledModeOverlayView:v10];
LABEL_7:
}

- (void)_updateDisabledModeUIAnimated:(BOOL)a3
{
  v3 = a3;
  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {
    v5 = [(CAMViewfinderViewController *)self _isModeDisabled];
    v6 = [(CAMViewfinderViewController *)self _disabledModeOverlayView];
    v7 = v6;
    if ((v5 ^ (v6 != 0)))
    {
      if (v6)
      {
        if (v3)
        {
          v8 = v6;
          [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:0];
          v9 = MEMORY[0x1E69DD250];
          v14[0] = MEMORY[0x1E69E9820];
          v14[1] = 3221225472;
          v14[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke_3;
          v14[3] = &unk_1E76F77B0;
          v15 = v8;
          v12[0] = MEMORY[0x1E69E9820];
          v12[1] = 3221225472;
          v12[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke_4;
          v12[3] = &unk_1E76F9A38;
          v12[4] = self;
          v13 = v15;
          v7 = v15;
          [v9 animateWithDuration:2 delay:v14 options:v12 animations:0.25 completion:0.0];
        }

        else
        {
          [(CAMViewfinderViewController *)self _embedDisabledModeOverlayView:0];
          [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:0];
        }
      }

      else
      {
        v10 = [CAMDisabledModeOverlayView alloc];
        v7 = [(CAMDisabledModeOverlayView *)v10 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
        [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:v7];
        [(CAMViewfinderViewController *)self _embedDisabledModeOverlayView:v7];
        [(CAMViewfinderViewController *)self _updateDisabledModeOverlayViewForCurrentState];
        if (v3)
        {
          [(CAMDisabledModeOverlayView *)v7 setAlpha:0.0];
          v11 = MEMORY[0x1E69DD250];
          v16[0] = MEMORY[0x1E69E9820];
          v16[1] = 3221225472;
          v16[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke;
          v16[3] = &unk_1E76F77B0;
          v7 = v7;
          v17 = v7;
          [v11 animateWithDuration:2 delay:v16 options:&__block_literal_global_1352 animations:0.1 completion:0.0];
        }
      }
    }

    else
    {
      [(CAMViewfinderViewController *)self _updateDisabledModeOverlayViewForCurrentState];
    }
  }
}

- (void)_updateModeDisabledForCurrentStateAnimated:(BOOL)a3
{
  v3 = a3;
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  -[CAMViewfinderViewController _updateModeDisabledForGraphConfiguration:callActive:animated:](self, "_updateModeDisabledForGraphConfiguration:callActive:animated:", v6, [v5 isCallActive], v3);
}

- (void)_updateModeDisabledForGraphConfiguration:(id)a3 callActive:(BOOL)a4 animated:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v20 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:v8 callActive:v6];
  v10 = [v9 count];
  if ([(CAMViewfinderViewController *)self _isModeDisabled]!= (v10 != 0))
  {
    [(CAMViewfinderViewController *)self _setModeDisabled:v10 != 0];
    v11 = os_log_create("com.apple.camera", "Camera");
    v12 = os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT);
    if (v10)
    {
      if (v12)
      {
        v13 = [v8 mode];
        if (v13 > 9)
        {
          v14 = 0;
        }

        else
        {
          v14 = off_1E76FA1E8[v13];
        }

        v15 = [(CAMViewfinderViewController *)self _debugStringForDisabledModeReasons:v9];
        v16 = 138543618;
        v17 = v14;
        v18 = 2114;
        v19 = v15;
        _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Disabling %{public}@ mode for reasons: %{public}@", &v16, 0x16u);
      }
    }

    else if (v12)
    {
      LOWORD(v16) = 0;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Re-enabling mode", &v16, 2u);
    }

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"ModeDisabled"];
    [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
    [(CAMViewfinderViewController *)self _updateDisabledModeUIAnimated:v5];
  }
}

- (void)_updateDisabledModeOverlayViewForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _disabledModeOverlayView];
  if (v3)
  {
    v8 = v3;
    v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v5 = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v6 = -[CAMViewfinderViewController _disabledModeReasonsForGraphConfiguration:callActive:](self, "_disabledModeReasonsForGraphConfiguration:callActive:", v4, [v5 isCallActive]);

    if ([v6 containsObject:&unk_1F16C75F8])
    {
      v7 = 1;
    }

    else
    {
      [v6 containsObject:&unk_1F16C7748];
      v7 = 0;
    }

    [v8 setDisabledModeReason:v7];

    v3 = v8;
  }
}

- (void)prepareDiscreteFeedback:(unint64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _feedbackController];
  [v4 prepareDiscreteFeedback:a3];
}

- (void)performDiscreteFeedback:(unint64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _feedbackController];
  [v4 performDiscreteFeedback:a3];
}

- (void)handleDoneButtonReleased
{
  v3 = [(CAMViewfinderViewController *)self presentationDelegate];
  [v3 viewfinderViewControllerRequestedDismissal:self];
}

- (BOOL)_trueVideoIsCapturing
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 trueVideoState];

  return v3 == 2;
}

- (BOOL)_trueVideoIsTransitioningToCapture
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 trueVideoState];

  return v3 == 1;
}

- (BOOL)_trueVideoIsTransitioningToCapturingOrCapturing
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 trueVideoState];

  return (v3 - 1) < 2;
}

- (BOOL)_trueVideoIsTransitioningFromCapture
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 trueVideoState];

  return v3 == 3;
}

- (BOOL)_trueVideoIsActive
{
  v2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v3 = [v2 trueVideoState];

  return (v3 - 1) < 3;
}

- (void)_trueVideoStopCapture
{
  if ([(CAMViewfinderViewController *)self _lockedTrueVideoRecording])
  {
    v3 = 1;
  }

  else
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    v5 = [v4 isTrueVideoCaptureStillOnCancelEnabled];

    v3 = v5 ^ 1;
  }

  v6 = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v6 isCapturingVideo];

  if ((v3 & 1) == 0 && v7 && (-[CAMViewfinderViewController _captureController](self, "_captureController"), v8 = objc_claimAutoreleasedReturnValue(), v9 = [v8 waitingForRecordingToStart], v8, v9))
  {
    v10 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v15 = 0;
      v11 = "True video aborted while waiting for recording to start, capture photo instead";
      v12 = &v15;
LABEL_12:
      _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, v11, v12, 2u);
    }
  }

  else
  {
    if ((v3 | v7))
    {
      goto LABEL_14;
    }

    v10 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      LOWORD(v14) = 0;
      v11 = "True video aborted before video capture started, capture photo instead";
      v12 = &v14;
      goto LABEL_12;
    }
  }

  [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
LABEL_14:
  if (v7)
  {
    [(CAMViewfinderViewController *)self _stopCapturingVideo];
  }

  v13 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v13 setTrueVideoState:3];

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]];
}

- (void)_startTransitioningToTrueVideoCaptureFromSourceMode:(int64_t)a3 sourceAspectRatio:(int64_t)a4 toDestinationMode:(int64_t)a5
{
  v17 = *MEMORY[0x1E69E9840];
  v9 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    if (a3 > 9)
    {
      v10 = 0;
    }

    else
    {
      v10 = off_1E76FA1E8[a3];
    }

    if (a5 > 9)
    {
      v11 = 0;
    }

    else
    {
      v11 = off_1E76FA1E8[a5];
    }

    v13 = 138543618;
    v14 = v10;
    v15 = 2114;
    v16 = v11;
    _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "True Video starting transition to capture. Source: %{public}@ destination: %{public}@", &v13, 0x16u);
  }

  v12 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [(CAMViewfinderViewController *)self _setLockedTrueVideoRecording:0];
  [(CAMViewfinderViewController *)self _setTrueVideoSourceCaptureMode:a3];
  [(CAMViewfinderViewController *)self _setTrueVideoDestinationCaptureMode:a5];
  [v12 setUseSlowerTrueVideoTransitionAnimationDuration:a4 == 3];
  [v12 setTrueVideoState:1];
  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:a5];
}

- (void)_trueVideoStartCapture
{
  v15 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
  if ([(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:v3])
  {
    v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v4 setTrueVideoState:2];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      v6 = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      if (v6 > 9)
      {
        v7 = 0;
      }

      else
      {
        v7 = off_1E76FA1E8[v6];
      }

      v8 = [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode];
      if (v8 > 9)
      {
        v9 = 0;
      }

      else
      {
        v9 = off_1E76FA1E8[v8];
      }

      v11 = 138543618;
      v12 = v7;
      v13 = 2114;
      v14 = v9;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "True Video failed to start capture. Source: %{public}@ destination: %{public}@", &v11, 0x16u);
    }

    v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v10 setTrueVideoState:3];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
    [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]];
  }
}

- (BOOL)_useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = [v3 trueVideoEnabled] && objc_msgSend(v3, "mode") == 1 && objc_msgSend(v3, "devicePosition") == 1;

  return v4;
}

- (BOOL)_updateDuetSystemConstraintsIfNecessary
{
  v11[1] = *MEMORY[0x1E69E9840];
  v2 = +[CAMUserPreferences preferences];
  if ([v2 isProResControlEnabled])
  {
    v3 = +[CAMCaptureCapabilities capabilities];
    if (![v3 hostProcess])
    {

LABEL_8:
      v7 = [MEMORY[0x1E699A4C0] sharedInstance];
      v10 = *MEMORY[0x1E699A608];
      v11[0] = &unk_1F16C7910;
      v6 = 1;
      v8 = [MEMORY[0x1E695DF20] dictionaryWithObjects:v11 forKeys:&v10 count:1];
      [v7 updateSystemConstraintsWithParameters:v8];

      return v6;
    }

    v4 = +[CAMCaptureCapabilities capabilities];
    v5 = [v4 hostProcess];

    if (v5 == 4)
    {
      goto LABEL_8;
    }
  }

  else
  {
  }

  return 0;
}

- (void)externalStorageMonitor:(id)a3 didChangeConnectedStorageDevices:(id)a4
{
  v27 = *MEMORY[0x1E69E9840];
  v5 = a4;
  v6 = [(CAMViewfinderViewController *)self _connectedStorage];
  v7 = [v5 count];
  if (v7)
  {
    if (([v5 containsObject:v6] & 1) == 0)
    {
      v8 = [v5 firstObject];
      [(CAMViewfinderViewController *)self _setConnectedStorage:v8];
    }

    if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled])
    {
      if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
      {
        v9 = os_log_create("com.apple.camera", "ExternalStorage");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *v20 = 0;
          v10 = "External storage: device connected when Camera Roll is visible, deferring SSD enablement";
LABEL_13:
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, v10, v20, 2u);
          goto LABEL_14;
        }

        goto LABEL_14;
      }

      v11 = [(CAMViewfinderViewController *)self _captureController];
      v12 = [v11 isCapturingVideo];

      if (v12)
      {
        v9 = os_log_create("com.apple.camera", "ExternalStorage");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *v20 = 0;
          v10 = "External storage: device connected during recording for internal storage, deferring SSD enablement";
          goto LABEL_13;
        }

LABEL_14:

        goto LABEL_15;
      }

      if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
      {
        [(CAMViewfinderViewController *)self _updateExternalStorageDataSources];
      }

      else
      {
        [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
      }
    }
  }

  else if (v6)
  {
    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:0 animated:1];
    [(CAMViewfinderViewController *)self _setConnectedStorage:0];
  }

LABEL_15:
  if ((v6 != 0) != (v7 != 0))
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  }

  if ([(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormat])
  {
    [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
  }

  v13 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    v14 = [v6 description];
    v15 = [v6 uniqueIdentifier];
    v16 = [(CAMViewfinderViewController *)self _connectedStorage];
    v17 = [v16 description];
    v18 = [(CAMViewfinderViewController *)self _connectedStorage];
    v19 = [v18 uniqueIdentifier];
    *v20 = 138544130;
    *&v20[4] = v14;
    v21 = 2114;
    v22 = v15;
    v23 = 2114;
    v24 = v17;
    v25 = 2114;
    v26 = v19;
    _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "External storage: available storage devices changed. Connected device (%{public}@/%{public}@) updated to  (%{public}@/%{public}@).", v20, 0x2Au);
  }
}

- (void)_updateExternalStorageMonitoringState:(unint64_t)a3
{
  v5 = [(CAMViewfinderViewController *)self _storageMonitor];

  if (v5)
  {
    v6 = +[CAMUserPreferences preferences];
    v7 = [v6 isProResControlEnabled];

    if (v7)
    {
      v8 = [(CAMViewfinderViewController *)self _storageMonitor];
      [v8 setMonitoringState:a3];
    }
  }
}

- (void)captureController:(id)a3 didChangeCameraSystemPressureState:(id)a4
{
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1, a4];

  [(CAMViewfinderViewController *)self _updateShutterEffectsEnablementForSystemPressureState];
}

- (BOOL)captureControllerShouldPlayAudioCue:(id)a3
{
  v4 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (!v4)
  {
    return 1;
  }

  [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isRegionalShutterSoundEnabled];

  return v6;
}

- (BOOL)isInCameraRollView
{
  v2 = [(CAMViewfinderViewController *)self _cameraRollController];
  v3 = [v2 isCameraRollViewControllerPresented];

  return v3;
}

- (BOOL)navigateToViewfinderView
{
  v2 = [(CAMViewfinderViewController *)self _cameraRollController];
  if ([v2 isCameraRollViewControllerPresented])
  {
    v3 = [v2 dismissCameraRollViewControllerForced:0 animated:1];
  }

  else
  {
    v3 = 1;
  }

  return v3;
}

- (void)setSingleUseTimerWithDuration:(int64_t)a3
{
  [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];

  [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:a3 animated:1];
}

- (void)_requestPasscodeUnlockForCameraRollController:(id)a3 forAction:(unint64_t)a4 completionBlock:(id)a5
{
  v8 = a3;
  v9 = a5;
  v10 = [(CAMViewfinderViewController *)self unlockDelegate];

  if (v10)
  {
    v9[2](v9, 0);
    v11 = [(CAMViewfinderViewController *)self unlockDelegate];
    [v11 viewfinderViewController:self didRequestUnlockForCameraRollController:v8 withCameraRollActionType:a4 completionHandler:&__block_literal_global_1362];
  }

  else
  {
    v12 = v9;
    SBSRequestPasscodeUnlockUI();
  }
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1();
    }
  }
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_1363(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_requestPasscodeUnlockForDocumentScanningWithCompletionBlock:(id)a3
{
  v4 = a3;
  v5 = [(CAMViewfinderViewController *)self unlockDelegate];

  if (v5)
  {
    v4[2](v4, 0);
    v6 = [(CAMViewfinderViewController *)self unlockDelegate];
    [v6 viewfinderViewControllerDidRequestUnlockForDocumentScanning:self completionHandler:&__block_literal_global_1366];
  }

  else
  {
    v7 = v4;
    SBSRequestPasscodeUnlockUI();
  }
}

void __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1();
    }
  }
}

void __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke_1367(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_requestPasscodeUnlockWithCompletionBlock:(id)a3
{
  v4 = a3;
  v3 = v4;
  SBSRequestPasscodeUnlockUI();
}

void __73__CAMViewfinderViewController__requestPasscodeUnlockWithCompletionBlock___block_invoke(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __73__CAMViewfinderViewController__requestPasscodeUnlockWithCompletionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_preparePhotoOutputForExpectedPhotoResolution
{
  v3 = [(CAMViewfinderViewController *)self _currentMaxPhotoResolution];
  v4 = [(CAMViewfinderViewController *)self _captureController];
  [v4 preparePhotoOutputForExpectedPhotoResolution:v3];
}

- (void)_updatePanoramaViewForCurrentState
{
  v3 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v4 = [(CAMViewfinderViewController *)self _panoramaViewController];
  [v4 setDevicePosition:v3];
}

- (void)_updateChromeViewfinderGeometryWithViewportFrame:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v8 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __80__CAMViewfinderViewController__updateChromeViewfinderGeometryWithViewportFrame___block_invoke;
  v11[3] = &unk_1E76F8428;
  v11[4] = self;
  v12 = v8;
  v13 = x;
  v14 = y;
  v15 = width;
  v16 = height;
  v10 = v8;
  [v9 performChanges:v11];
}

void __80__CAMViewfinderViewController__updateChromeViewfinderGeometryWithViewportFrame___block_invoke(uint64_t a1)
{
  [*(a1 + 40) previewAspectRatio];
  v3 = v2;
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setViewfinderAspectRatio:v3];

  v5 = *(a1 + 48);
  v6 = *(a1 + 56);
  v7 = *(a1 + 64);
  v8 = *(a1 + 72);
  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setCurrentViewportFrame:{v5, v6, v7, v8}];

  [*(a1 + 40) currentFourThreeViewportFrame];
  v11 = v10;
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setCurrentFourThreeViewportFrame:{v11, v13, v15, v17}];
}

- (void)_updateChromeViewControllerVideoRecordingState
{
  v5 = [(CAMViewfinderViewController *)self _captureController];
  if (([v5 isCapturingVideo] & 1) != 0 || -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing"))
  {
    if ([v5 videoCapturePaused])
    {
      v3 = 2;
    }

    else
    {
      v3 = 1;
    }
  }

  else
  {
    v3 = -[CAMViewfinderViewController _isCapturingTimelapse](self, "_isCapturingTimelapse") || [v5 isCapturingPanorama];
  }

  v4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v4 setVideoRecordingState:v3];
}

- (void)handleChromeControlPanelIsExpanded:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self setChromeControlPanelIsExpanded:?];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __66__CAMViewfinderViewController_handleChromeControlPanelIsExpanded___block_invoke;
  v10[3] = &unk_1E76F7850;
  v10[4] = self;
  v11 = v3;
  [CAMView animateIfNeededWithDuration:v10 animations:0.25];
  v5 = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = v5;
  if (v3)
  {
    if (v5)
    {
      [v5 dismissMachineReadableCodeButtonAnimated:0];
    }

    else
    {
      v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v9 dismissMachineReadableCodeButtonAnimated:0];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
  }

  else
  {
    v7 = [(CAMViewfinderViewController *)self _prominentObjectManager];
    v8 = [v7 currentMachineReadableCodeAction];
    [(CAMViewfinderViewController *)self _updateMachineReadableCodeButtonFromAction:v8];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
}

void __66__CAMViewfinderViewController_handleChromeControlPanelIsExpanded___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v3 = [*(a1 + 32) _previewViewController];
  v2 = [v3 previewView];
  [v2 setHideAllIndicators:v1];
}

- (void)handleChromeTopBarMenuState:(int64_t)a3
{
  [(CAMViewfinderViewController *)self setChromeTopBarMenuState:a3];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
}

- (void)handleChromeTopInset:(double)a3
{
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v4 setExternalChromeTopInset:1 animated:a3];
}

- (void)handleUserChangedFiltersUIVisible:(BOOL)a3
{
  v3 = a3;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:a3 animated:1];
  v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v5 setExternalChromeFilterScrubberVisible:v3];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)handleUserChangedSemanticStylesUIVisible:(BOOL)a3
{
  v3 = a3;
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v4 setExternalChromeSemanticStyleControlsVisible:v3];
}

- (void)handleUserChangedSemanticStylePreset:(int64_t)a3 sceneBias:(double)a4 warmthBias:(double)a5
{
  v6 = [[CAMSemanticStyle alloc] initWithPresetType:a3 sceneBias:a4 warmthBias:a5];
  [(CAMViewfinderViewController *)self _handleUserChangedSemanticStyle:v6];
}

- (void)handleUserChangedSmartStylesUIVisible:(BOOL)a3
{
  v3 = a3;
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v4 setExternalChromeSmartStyleControlsVisible:v3];
}

- (void)setDockKitController:(id)a3
{
  objc_storeStrong(&self->__dockKitController, a3);
  v4 = [(CAMViewfinderViewController *)self _dockKitController];
  [v4 setDelegate:self];
}

- (void)accessoryPanoramaMotionCompleted
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __63__CAMViewfinderViewController_accessoryPanoramaMotionCompleted__block_invoke;
  block[3] = &unk_1E76F77B0;
  block[4] = self;
  dispatch_async(MEMORY[0x1E69E96A0], block);
}

void __63__CAMViewfinderViewController_accessoryPanoramaMotionCompleted__block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) isRecording])
  {
    v2 = [*(a1 + 32) _dynamicShutterControl];

    v3 = *(a1 + 32);
    if (v2)
    {
      v4 = [*(a1 + 32) _dynamicShutterControl];
      [v4 externalButtonPressedWithBehavior:1];

      v7 = [*(a1 + 32) _dynamicShutterControl];
      [v7 externalButtonReleased];
    }

    else
    {
      v5 = [*(a1 + 32) _shutterButton];
      [v3 _handleShutterButtonPressed:v5];

      v6 = *(a1 + 32);
      v7 = [v6 _shutterButton];
      [v6 _handleShutterButtonReleased:?];
    }
  }
}

- (void)accessoryZoomInByDisplayZoomValue:(double)a3
{
  v5 = [(CAMViewfinderViewController *)self _zoomControl];
  [v5 displayZoomValue];
  v7 = v6 + a3;

  v8 = [(CAMViewfinderViewController *)self _zoomControl];
  [v8 zoomFactorForDisplayZoomValue:v7];
  v10 = v9;

  [(CAMViewfinderViewController *)self _remoteShutterSetZoomFactor:v10];
}

- (void)accessoryConnectedAndTracking:(BOOL)a3
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __61__CAMViewfinderViewController_accessoryConnectedAndTracking___block_invoke;
  v3[3] = &unk_1E76F7850;
  v3[4] = self;
  v4 = a3;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

void __61__CAMViewfinderViewController_accessoryConnectedAndTracking___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _previewViewController];
  [v2 accessoryConnectedAndTracking:*(a1 + 40)];
}

- (void)tapToFocusTriggeredAtPoint:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  v6 = [(CAMViewfinderViewController *)self _dockKitController];
  [v6 tapToTrackTriggeredAtPoint:-[CAMViewfinderViewController _currentDevicePosition](self devicePosition:{"_currentDevicePosition"), x, y}];
}

- (BOOL)isDockAccessoryConnectedAndTracking
{
  v2 = [(CAMViewfinderViewController *)self _dockKitController];
  v3 = [v2 shouldShowTrackingSummaryViews];

  return v3;
}

- (id)matchingDockKitTrackedSubjectForAnstID:(int64_t)a3
{
  v4 = [(CAMViewfinderViewController *)self _dockKitController];
  v5 = [v4 matchingTrackedSubjectForAnstID:a3];

  return v5;
}

- (BOOL)isDockKitTrackingLocked
{
  v2 = [(CAMViewfinderViewController *)self _dockKitController];
  v3 = [v2 isTrackingLocked];

  return v3;
}

- (void)captureController:(id)a3 didOutputRecommendedSmartFramingFieldOfView:(int64_t)a4
{
  v35 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "SmartFraming");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v25 = 134217984;
    *v26 = a4;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Received new smart framing recommendation: %ld", &v25, 0xCu);
  }

  v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [v7 isReticleAnimating];

  if (v8)
  {
    v9 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      LOWORD(v25) = 0;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: reticle is animating", &v25, 2u);
    }
  }

  else
  {
    v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9 = [(CAMViewfinderViewController *)self _autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:v10];

    v11 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
    v12 = [v9 containsObject:v11];

    v13 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

    v14 = [(CAMViewfinderViewController *)self _trueVideoIsActive];
    v15 = [(CAMViewfinderViewController *)self isRecording];
    v16 = v15;
    if (!a4 || !v12 || v13 || v14 || v15)
    {
      v18 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        v25 = 67110400;
        *v26 = v12;
        *&v26[4] = 1024;
        *&v26[6] = a4 == 0;
        v27 = 1024;
        v28 = v13 != 0;
        v29 = 1024;
        v30 = v14;
        v31 = 1024;
        v32 = v16;
        v33 = 2048;
        v34 = a4;
        _os_log_impl(&dword_1A3640000, v18, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: isSupported: %d, isNoneRecommended: %d, hasCurrentStillImageCaptureMomentSettings %d, isTrueVideoActive %d, isRecording: %d, suggested FOV: %ld", &v25, 0x2Au);
      }
    }

    else if ([(CAMViewfinderViewController *)self _desiredFieldOfView]== a4)
    {
      v17 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        LOWORD(v25) = 0;
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: already equal to desired FOV", &v25, 2u);
      }
    }

    else
    {
      v19 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v20 = [v19 mode];
      v21 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v22 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", v20, [v21 devicePosition]);

      [(CAMViewfinderViewController *)self set_desiredFieldOfView:a4];
      v23 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v23 rampDuration:1 zoomRampTuning:1 animated:0.5];

      v24 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        v25 = 134217984;
        *v26 = a4;
        _os_log_impl(&dword_1A3640000, v24, OS_LOG_TYPE_DEFAULT, "Using auto smart framing recommendation, updating to: %ld", &v25, 0xCu);
      }

      [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:1];
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
      [(CAMViewfinderViewController *)self _showSmartFramingAutoBadgeForSmartFramingFieldOfView:a4 previousSmartFramingFieldOfView:v22];
    }
  }
}

- (void)_showSmartFramingAutoBadgeForSmartFramingFieldOfView:(int64_t)a3 previousSmartFramingFieldOfView:(int64_t)a4
{
  if (a3 && a4 && (((a3 & 0xFFFFFFFFFFFFFFFELL) == 2) != ((a4 & 0xFFFFFFFFFFFFFFFELL) == 2) || (a3 - 3) < 2 != (a4 - 3) < 2))
  {
    v9 = v4;
    v10 = v5;
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __116__CAMViewfinderViewController__showSmartFramingAutoBadgeForSmartFramingFieldOfView_previousSmartFramingFieldOfView___block_invoke;
    v6[3] = &__block_descriptor_34_e22_v16__0__CAMTextBadge_8l;
    v7 = ((a3 & 0xFFFFFFFFFFFFFFFELL) == 2) ^ ((a4 & 0xFFFFFFFFFFFFFFFELL) == 2);
    v8 = ((a3 - 3) < 2) ^ ((a4 - 3) < 2);
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (BOOL)_resolvedSmartFramingAutoZoomEnabled
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isAutoSmartFramingSupported];

  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 mode];
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v5 isSmartFramingSupportedForMode:v7 devicePosition:{objc_msgSend(v8, "devicePosition")}];

  v10 = [(CAMViewfinderViewController *)self _motionController];
  v11 = [v10 captureOrientation] - 3;

  if (v11 > 1)
  {
    LOBYTE(v12) = 1;
  }

  else
  {
    v12 = ![(CAMViewfinderViewController *)self _overrideSmartFramingAutoZoomInLandscapeEnabled];
  }

  if ((v4 & v9) == 1)
  {
    v13 = [(CAMViewfinderViewController *)self _wantsSmartFramingAutoZoomDefault];
    if (v13)
    {
      LOBYTE(v13) = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]& v12;
    }
  }

  else
  {
    LOBYTE(v13) = 0;
  }

  return v13;
}

- (BOOL)_resolvedSmartFramingAutoRotationEnabled
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isAutoSmartFramingSupported];

  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 mode];
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v5 isSmartFramingSupportedForMode:v7 devicePosition:{objc_msgSend(v8, "devicePosition")}];

  v10 = [(CAMViewfinderViewController *)self _motionController];
  v11 = [v10 captureOrientation] - 3;

  if (v11 > 1)
  {
    LOBYTE(v12) = 1;
  }

  else
  {
    v12 = ![(CAMViewfinderViewController *)self _overrideSmartFramingAutoRotateInLandscapeEnabled];
  }

  if ((v4 & v9) == 1)
  {
    v13 = [(CAMViewfinderViewController *)self _wantsSmartFramingAutoRotationDefault];
    if (v13)
    {
      LOBYTE(v13) = [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled]& v12;
    }
  }

  else
  {
    LOBYTE(v13) = 0;
  }

  return v13;
}

- (void)_setOverrideSmartFramingAutoZoomInLandscapeEnabled:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__overrideSmartFramingAutoZoomInLandscapeEnabled != a3)
  {
    v3 = a3;
    self->__overrideSmartFramingAutoZoomInLandscapeEnabled = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setOverrideSmartFramingAutoZoomInLandscapeEnabled:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating overrideSmartFramingAutoZoomInLandscapeEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_setOverrideSmartFramingAutoRotateInLandscapeEnabled:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__overrideSmartFramingAutoRotateInLandscapeEnabled != a3)
  {
    v3 = a3;
    self->__overrideSmartFramingAutoRotateInLandscapeEnabled = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setOverrideSmartFramingAutoRotateInLandscapeEnabled:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating overrideSmartFramingAutoRotateInLandscapeEnabled to: %d", v8, 8u);
    }
  }
}

- (int64_t)_resolvedSmartFramingFieldOfViewForMode:(int64_t)a3 devicePosition:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(a4) = [v7 isSmartFramingSupportedForMode:a3 devicePosition:a4];

  if (!a4)
  {
    return 0;
  }

  result = [(CAMViewfinderViewController *)self _desiredFieldOfView];
  if (!result)
  {
    v9 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:];
    }

    return 1;
  }

  return result;
}

- (void)_updateSmartFramingMonitorForGraphConfiguration:(id)a3
{
  v4 = a3;
  v13 = [(CAMViewfinderViewController *)self _autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:v4];
  v5 = [(CAMViewfinderViewController *)self _captureController];
  [v5 setAutoSmartFramingEnabledFieldOfViews:v13];

  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v4 mode];
  v8 = [v4 devicePosition];

  LODWORD(v4) = [v6 isSmartFramingSupportedForMode:v7 devicePosition:v8];
  v9 = +[CAMCaptureCapabilities capabilities];
  LODWORD(v7) = [v9 isAutoSmartFramingSupported];

  LODWORD(v9) = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
  v10 = v7 & (v9 | [(CAMViewfinderViewController *)self _smartFramingAutoRotationMonitoringEnabled]);
  if (v4)
  {
    v11 = v10;
  }

  else
  {
    v11 = 0;
  }

  v12 = [(CAMViewfinderViewController *)self _captureController];
  [v12 setSmartFramingMonitorEnabled:v11];
}

- (id)_autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:(id)a3
{
  v24 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v4 mode];
  v7 = [v4 devicePosition];

  v8 = [v5 isSmartFramingSupportedForMode:v6 devicePosition:v7];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isAutoSmartFramingSupported];

  v11 = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]|| [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled];
  if ((v8 & v10) == 1 && v11)
  {
    v12 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v13 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
    v14 = [(CAMViewfinderViewController *)self _smartFramingAutoRotationMonitoringEnabled];
    if (v13 && v14)
    {
      [v12 addObject:&unk_1F16C75F8];
      v15 = &unk_1F16C7628;
      v16 = &unk_1F16C7610;
    }

    else
    {
      if (v13)
      {
        v15 = &unk_1F16C7610;
      }

      else
      {
        v15 = &unk_1F16C7628;
      }

      if (!v13 && !v14)
      {
        goto LABEL_20;
      }

      v16 = &unk_1F16C75F8;
    }

    [v12 addObject:v16];
    [v12 addObject:v15];
  }

  else
  {
    if (v8)
    {
      v17 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        v19[0] = 67109632;
        v19[1] = v10;
        v20 = 1024;
        v21 = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled];
        v22 = 1024;
        v23 = [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled];
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Smart framing supported but has no enabled auto framings - isAutoFramingSupported: %d, smartFramingAutoZoomEnabled: %d, smartFramingAutoRotationEnabled: %d", v19, 0x14u);
      }
    }

    v12 = MEMORY[0x1E695E0F0];
  }

LABEL_20:

  return v12;
}

- (BOOL)_smartFramingAutoRotationMonitoringEnabled
{
  v3 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled];
  v4 = [(CAMViewfinderViewController *)self _motionController];
  v5 = [v4 captureOrientation] - 5;

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v6 mode];
  v8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", v7, [v8 devicePosition]);

  v10 = [(CAMViewfinderViewController *)self _smartFramingSupportsAspectRatioCrop:v9];
  v11 = v5 < 0xFFFFFFFFFFFFFFFELL && v3;
  return v11 && v10;
}

- (void)_updateSmartFramingFieldOfViewForGraphConfiguration:(id)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 animated:(BOOL)a6
{
  v6 = a6;
  v24 = a3;
  v10 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = +[CAMCaptureCapabilities capabilities];
  v12 = [v11 isSmartFramingSupportedForMode:objc_msgSend(v24 devicePosition:{"mode"), objc_msgSend(v24, "devicePosition")}];

  v13 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [v24 mode], objc_msgSend(v24, "devicePosition"));
  if ((v12 & 1) == 0)
  {
    v17 = +[CAMCaptureCapabilities capabilities];
    v18 = [v17 isSmartFramingSupported];

    if (!v18)
    {
      goto LABEL_23;
    }

    goto LABEL_7;
  }

  v14 = v13;
  if (!-[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [v24 mode], objc_msgSend(v24, "devicePosition"))))
  {
    [v10 setSmartFramingFieldOfView:0 useTransition:0 animated:v6];
    v19 = +[CAMCaptureCapabilities capabilities];
    [v19 zoomFactorForSmartFramingFieldOfView:v14];
    v21 = v20;

    [(CAMViewfinderViewController *)self _changeToZoomFactor:a5 rampDuration:v6 zoomRampTuning:v21 shouldAnimate:a4];
    goto LABEL_23;
  }

  if (!v14)
  {
LABEL_7:
    [v10 setSmartFramingFieldOfView:0 useTransition:0 animated:v6];
    goto LABEL_23;
  }

  v15 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", [v24 mode], objc_msgSend(v24, "videoConfiguration"), objc_msgSend(v24, "devicePosition"), objc_msgSend(v24, "trueVideoEnabled"));
  v16 = [v10 smartFramingFieldOfView];
  if (v16 != v14)
  {
    if ((v16 - 3) < 2)
    {
      v22 = v14 >= 3;
    }

    else
    {
      if ((v16 - 1) > 1)
      {
        v23 = 0;
        goto LABEL_20;
      }

      v22 = v14 - 3 >= 2;
    }

    v23 = !v22;
    if (v23 && v6)
    {
      v23 = 1;
      [(CAMViewfinderViewController *)self set_delaySmartFramingDynamicAspectRatioUpdate:1];
LABEL_21:
      [v10 setViewportAspectRatio:v15 animated:v6];
      [v10 setSmartFramingFieldOfView:v14 useTransition:v23 animated:v6];
      goto LABEL_22;
    }

LABEL_20:
    [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:a5 zoomRampTuning:a4];
    goto LABEL_21;
  }

  [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:a5 zoomRampTuning:a4];
LABEL_22:
  [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:v24 animated:v6];
  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:v24 animated:v6];
LABEL_23:
}

- (void)_resetSmartFramingFieldOfViewAnimated:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController set_desiredFieldOfView:](self, "set_desiredFieldOfView:", -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [v5 captureOrientation]));

  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v6 animated:v3];
}

- (int64_t)_defaultSmartFramingFieldOfViewForOrientation:(int64_t)a3
{
  if ((a3 - 3) >= 2)
  {
    return 1;
  }

  else
  {
    return 2;
  }
}

- (void)_updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:(double)a3 zoomRampTuning:(int64_t)a4
{
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isSmartFramingUsingDynamicAspectRatioSupported];

  if (v8)
  {
    v15 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [v15 mode], objc_msgSend(v15, "devicePosition"));
    if (v9)
    {
      v10 = v9;
      v11 = [(CAMViewfinderViewController *)self _captureController];
      [v11 changeToSmartFramingFieldOfView:v10 mode:objc_msgSend(v15 videoConfiguration:"mode") devicePosition:{objc_msgSend(v15, "videoConfiguration"), objc_msgSend(v15, "devicePosition")}];

      v12 = +[CAMCaptureCapabilities capabilities];
      [v12 zoomFactorForSmartFramingFieldOfView:v10];
      v14 = v13;

      [(CAMViewfinderViewController *)self _changeToZoomFactor:a4 rampDuration:0 zoomRampTuning:v14 shouldAnimate:a3];
    }
  }
}

- (void)handleUserChangedSmartFramingAutoZoomEnabled:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled]^ a3;
  [(CAMViewfinderViewController *)self _setWantsSmartFramingAutoZoomDefault:v3];
  if (v3)
  {
    [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:1];
  }

  if (v5)
  {
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:0];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __76__CAMViewfinderViewController_handleUserChangedSmartFramingAutoZoomEnabled___block_invoke;
    v6[3] = &__block_descriptor_33_e22_v16__0__CAMTextBadge_8l;
    v7 = v3;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (void)handleUserChangedSmartFramingAutoRotationEnabled:(BOOL)a3
{
  v3 = a3;
  v5 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled]^ a3;
  [(CAMViewfinderViewController *)self _setWantsSmartFramingAutoRotationDefault:v3];
  if (v3)
  {
    [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:1];
  }

  if (v5)
  {
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:0];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __80__CAMViewfinderViewController_handleUserChangedSmartFramingAutoRotationEnabled___block_invoke;
    v6[3] = &__block_descriptor_33_e22_v16__0__CAMTextBadge_8l;
    v7 = v3;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (void)_setWantsSmartFramingAutoZoomDefault:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__wantsSmartFramingAutoZoomDefault != a3)
  {
    v3 = a3;
    self->__wantsSmartFramingAutoZoomDefault = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setWantsSmartFramingAutoZoomDefault:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating wantsSmartFramingAutoZoomDefault to: %d", v8, 8u);
    }
  }
}

- (void)_setWantsSmartFramingAutoRotationDefault:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__wantsSmartFramingAutoRotationDefault != a3)
  {
    v3 = a3;
    self->__wantsSmartFramingAutoRotationDefault = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setWantsSmartFramingAutoRotationDefault:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating wantsSmartFramingAutoRotationDefault to: %d", v8, 8u);
    }
  }
}

- (void)_setSmartFramingAutoZoomEnabled:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__smartFramingAutoZoomEnabled != a3)
  {
    v3 = a3;
    self->__smartFramingAutoZoomEnabled = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setSmartFramingAutoZoomEnabled:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating smartFramingAutoZoomEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_setSmartFramingAutoRotationEnabled:(BOOL)a3
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__smartFramingAutoRotationEnabled != a3)
  {
    v3 = a3;
    self->__smartFramingAutoRotationEnabled = a3;
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [v5 setSmartFramingAutoRotationEnabled:v3];

    v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v6];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = v3;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating smartFramingAutoRotationEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_disableAutoSmartFramingIfSupported
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v4 mode];
  v6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(v5) = [v3 isSmartFramingSupportedForMode:v5 devicePosition:{objc_msgSend(v6, "devicePosition")}];

  if (v5)
  {
    v7 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
    v8 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled];
    if (v7 || v8)
    {
      [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:&__block_literal_global_1372];
    }

    [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:0];
    [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:0];
    if ([(CAMViewfinderViewController *)self _smartFramingFieldOfViewSource]== 1)
    {

      [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:2];
    }
  }
}

- (BOOL)_shouldShowSmartFramingAutoZoomForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 devicePosition];

  LOBYTE(v3) = [v4 isSmartFramingSupportedForMode:v5 devicePosition:v6];
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(v5) = [v7 isAutoSmartFramingSupported];

  return v3 & v5;
}

- (BOOL)_shouldShowSmartFramingAutoRotationForGraphConfiguration:(id)a3
{
  v3 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v3 mode];
  v6 = [v3 devicePosition];

  LOBYTE(v3) = [v4 isSmartFramingSupportedForMode:v5 devicePosition:v6];
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(v5) = [v7 isAutoSmartFramingSupported];

  return v3 & v5;
}

- (void)_updateSmartFramingForCaptureOrientation:(int64_t)a3 rampDuration:(double)a4 zoomRampTuning:(int64_t)a5 animated:(BOOL)a6
{
  v6 = a6;
  if ((a3 - 3) < 2)
  {
    [(CAMViewfinderViewController *)self set_desiredFieldOfView:2];
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:1];
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:1];
  }

  else if ((a3 - 1) <= 1)
  {
    [(CAMViewfinderViewController *)self set_desiredFieldOfView:1];
  }

  v10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoZoomForGraphConfiguration:v10];
  v12 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v12 setIsSmartFramingAutoZoomSupported:v11];

  v13 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v14 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoRotationForGraphConfiguration:v13];
  v15 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v15 setIsSmartFramingAutoRotationSupported:v14];

  v16 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:v16 rampDuration:a5 zoomRampTuning:v6 animated:a4];

  v17 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:v17];
}

- (void)_updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:(id)a3 animated:(BOOL)a4
{
  v4 = a4;
  v12 = a3;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isSmartFramingSupportedForMode:objc_msgSend(v12 devicePosition:{"mode"), objc_msgSend(v12, "devicePosition")}];

  v8 = 0.0;
  if (v7)
  {
    v9 = -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [v12 mode], objc_msgSend(v12, "devicePosition"));
    v10 = 60.0;
    if (v9 != 1)
    {
      v10 = 0.0;
    }

    if (v9)
    {
      v8 = v10;
    }

    else
    {
      v8 = 50.0;
    }
  }

  v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [v11 setOverCaptureGradientHeight:v4 animated:v8];
}

- (void)handleReviewButtonReleased
{
  v4 = [(CAMViewfinderViewController *)self reviewButtonSource];
  v3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v3 resetAnimated:1];

  [v4 handleReviewButtonReleased:0];
}

- (void)simulateShutterButtonPressForCaptureMenuItem
{
  v2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [v2 captureMenuItemTapped];
}

- (BOOL)shouldEnableFlashMenuCommand
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideFlashButtonForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (BOOL)shouldEnableLivePhotoMenuCommand
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideLivePhotoButtonForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (BOOL)shouldEnableTimerMenuCommand
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideTimerButtonForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (BOOL)shouldEnableFlipCameraMenuCommand
{
  v2 = self;
  v3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(v2) = [(CAMViewfinderViewController *)v2 _shouldHideFlipButtonForGraphConfiguration:v3];

  return v2 ^ 1;
}

- (void)dismissCameraRoll
{
  v2 = [(CAMViewfinderViewController *)self _cameraRollController];
  [v2 dismissCameraRollViewControllerForced:0 animated:1];
}

+ (int64_t)_pressTypeForCaptureButton:(int64_t)a3
{
  if ((a3 - 1) > 7)
  {
    return -1;
  }

  else
  {
    return qword_1A3A68608[a3 - 1];
  }
}

- (void)stopMonitoringForAccidentalLaunchIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 hostProcess];

  v5 = v4 & 0xFFFFFFFFFFFFFFFBLL;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 shouldEnableUserNotifications];

  if (v5)
  {
    v8 = 1;
  }

  else
  {
    v8 = v7 == 0;
  }

  if (!v8)
  {
    v9 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *v11 = 0;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "stopMonitoringForAccidentalLaunchIfNeeded: Interaction with Camera disable TTR", v11, 2u);
    }

    v10 = [(CAMViewfinderViewController *)self _captureController];
    [v10 stopMonitoringForAccidentalLaunch];
  }
}

- (void)_createChromeConfiguratorWithGraphConfiguration:(id)a3
{
  v4 = a3;
  v7 = [[CAMCameraChromeEventHandler alloc] initWithViewfinderViewController:self];
  v5 = [[CAMChromeConfigurator alloc] initWithEventHandler:v7 captureGraphConfiguration:v4];
  [(CAMViewfinderViewController *)self setChromeConfigurator:v5];
  [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:v4];

  [(CAMChromeConfigurator *)v5 setUseMessagesUI:[(CAMViewfinderViewController *)self _useMessagesControls]];
  v6 = +[CAMCaptureCapabilities capabilities];
  -[CAMChromeConfigurator setDeviceHasDynamicIsland:](v5, "setDeviceHasDynamicIsland:", [v6 hasDynamicIsland]);
  -[CAMChromeConfigurator setDeviceHasNotch:](v5, "setDeviceHasNotch:", [v6 hasNotch]);
  -[CAMChromeConfigurator setFrontCameraOnRightEdge:](v5, "setFrontCameraOnRightEdge:", [v6 isFrontCameraOnRightEdge]);
  [(CAMChromeConfigurator *)v5 setWantsSmartFramingAutoZoomDefault:[(CAMViewfinderViewController *)self _wantsSmartFramingAutoZoomDefault]];
  [(CAMChromeConfigurator *)v5 setWantsSmartFramingAutoRotationDefault:[(CAMViewfinderViewController *)self _wantsSmartFramingAutoRotationDefault]];
  [(CAMChromeConfigurator *)v5 setSmartFramingAutoZoomEnabled:[(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]];
  [(CAMChromeConfigurator *)v5 setSmartFramingAutoRotationEnabled:[(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled]];
  [(CAMChromeConfigurator *)v5 setIsImagePickerController:[(CAMViewfinderViewController *)self emulationMode]!= 0];
}

- (void)_createChromeViewControllerIfNeeded
{
  v3 = [(CAMViewfinderViewController *)self chromeConfigurator];

  if (v3)
  {
    v4 = [CAMChromeViewController alloc];
    v5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v6 = [(CAMChromeViewController *)v4 initWithConfigurator:v5];

    [(CAMViewfinderViewController *)self setChromeViewController:v6];
    v7 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [v7 frameForReticleViewport];
    [(CAMViewfinderViewController *)self _updateChromeViewfinderGeometryWithViewportFrame:?];

    objc_initWeak(&location, self);
    v12 = MEMORY[0x1E69E9820];
    v13 = 3221225472;
    v14 = __66__CAMViewfinderViewController__createChromeViewControllerIfNeeded__block_invoke;
    v15 = &unk_1E76F9D98;
    objc_copyWeak(&v16, &location);
    [(CAMChromeViewController *)v6 observeShutterButtonFrameWithHandler:&v12];
    v8 = [(CAMViewfinderViewController *)self viewfinderView:v12];
    v9 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

    if (v9)
    {
      v10 = [(CAMChromeViewController *)v6 view];
      v11 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [v11 setChromeView:v10];
    }

    else
    {
      if (!v8)
      {
LABEL_7:

        objc_destroyWeak(&v16);
        objc_destroyWeak(&location);

        return;
      }

      v10 = [(CAMChromeViewController *)v6 view];
      [v8 setChromeView:v10];
    }

    goto LABEL_7;
  }
}

void __66__CAMViewfinderViewController__createChromeViewControllerIfNeeded__block_invoke(uint64_t a1, double a2, double a3, double a4, double a5)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v11 = [WeakRetained _fullscreenViewfinder];
  [v11 setExternalChromeShutterButtonFrame:1 animated:{a2, a3, a4, a5}];

  v13 = objc_loadWeakRetained((a1 + 32));
  v12 = [v13 viewfinderView];
  [v12 setExternalChromeShutterButtonFrame:{a2, a3, a4, a5}];
}

- (void)_updateViewfinderForExternalChromeState:(id)a3
{
  v4 = [a3 controlStatusBar];
  [v4 setDelegate:self];

  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {

    [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
  }
}

- (void)_updateChromeAvailableCaptureModes
{
  v16 = *MEMORY[0x1E69E9840];
  v3 = [(CAMViewfinderViewController *)self availableCaptureModes];
  v4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v5 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v6 = v3;
  v7 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v12;
    do
    {
      v10 = 0;
      do
      {
        if (*v12 != v9)
        {
          objc_enumerationMutation(v6);
        }

        [v5 addIndex:{objc_msgSend(*(*(&v11 + 1) + 8 * v10++), "integerValue", v11)}];
      }

      while (v8 != v10);
      v8 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
    }

    while (v8);
  }

  [v4 setAvailableCaptureModeRawValues:v5];
}

- (void)_updateChromeControlsForGraphConfiguration:(id)a3
{
  v17 = a3;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = +[CAMUserPreferences preferences];
  v6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [v6 setCaptureGraphConfiguration:v17];
  [v6 setSpatialModeHasVideoSelected:{-[CAMViewfinderViewController _spatialModeHasVideoSelected](self, "_spatialModeHasVideoSelected")}];
  [v6 setIsDepthEffectApertureSupported:{-[CAMViewfinderViewController _isDepthEffectApertureSupportedForGraphConfiguration:](self, "_isDepthEffectApertureSupportedForGraphConfiguration:", v17)}];
  [v6 setIsSmartStylesSupported:{-[CAMViewfinderViewController _shouldShowSmartStyleControlForGraphConfiguration:](self, "_shouldShowSmartStyleControlForGraphConfiguration:", v17)}];
  [v6 setIsVideoStabilizationSupported:{-[CAMViewfinderViewController _shouldShowVideoStabilizationButtonForGraphConfiguration:](self, "_shouldShowVideoStabilizationButtonForGraphConfiguration:", v17)}];
  [v6 setIsFrontPIPSupported:{-[CAMViewfinderViewController _shouldShowFrontPIPButtonForGraphConfiguration:](self, "_shouldShowFrontPIPButtonForGraphConfiguration:", v17)}];
  [v6 setIsSemanticStylesSupported:{-[CAMViewfinderViewController _shouldShowSemanticStyleControlForGraphConfiguration:](self, "_shouldShowSemanticStyleControlForGraphConfiguration:", v17)}];
  [v6 setIsFiltersSupported:{-[CAMViewfinderViewController _shouldUseFiltersForGraphConfiguration:](self, "_shouldUseFiltersForGraphConfiguration:", v17)}];
  [v6 setIsHDRSupported:{-[CAMViewfinderViewController _wantsHDRControlsVisibleForGraphConfiguration:](self, "_wantsHDRControlsVisibleForGraphConfiguration:", v17)}];
  if (-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") && ([v6 isFlashSupported] & 1) == 0)
  {
    v7 = [v6 isTorchSupported];
  }

  else
  {
    v7 = 1;
  }

  v8 = [v4 isFlashSupportedForMode:objc_msgSend(v17 devicePosition:{"mode"), objc_msgSend(v17, "devicePosition")}];
  [v6 setIsFlashSupported:v8 & v7];
  if (v8)
  {
    v9 = [v5 alwaysShowFlashIndicator];
  }

  else
  {
    v9 = 0;
  }

  [v6 setShowFlashInTopBarForAllStates:v9];
  v10 = [v4 isTorchSupportedForMode:objc_msgSend(v17 devicePosition:{"mode"), objc_msgSend(v17, "devicePosition")}] & v7;
  [v6 setIsTorchSupported:v10];
  if (v10 == 1)
  {
    v11 = [v5 alwaysShowFlashIndicator];
  }

  else
  {
    v11 = 0;
  }

  [v6 setShowTorchInTopBarForAllStates:v11];
  v12 = [v4 isLivePhotoSupportedForMode:objc_msgSend(v17 devicePosition:{"mode"), objc_msgSend(v17, "devicePosition")}];
  v13 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v14 = v13;
  if (v12)
  {
    [v13 addIndex:1];
    [v14 addIndex:0];
    if ([v4 isLivePhotoAutoModeSupported])
    {
      [v14 addIndex:2];
    }

    [v6 setSupportedLivePhotoModeRawValues:v14];
    v15 = [v5 alwaysShowLivePhotoIndicator];
  }

  else
  {
    [v6 setSupportedLivePhotoModeRawValues:v13];
    v15 = 0;
  }

  [v6 setShowLivePhotoInTopBar:v15];
  [v6 setIsAspectRatioCropSupported:{objc_msgSend(v4, "isAspectRatioCropSupportedForMode:devicePosition:", objc_msgSend(v17, "mode"), objc_msgSend(v17, "devicePosition"))}];
  [v6 setIsExposureSliderSupported:{objc_msgSend(v4, "isExposureSliderSupportedForMode:", objc_msgSend(v17, "mode"))}];
  [v6 setIsTimerSupported:{objc_msgSend(v4, "isTimerSupportedForMode:", objc_msgSend(v17, "mode"))}];
  [v6 setIsFlipSupported:{-[CAMViewfinderViewController _isFlipButtonSupportedForMode:](self, "_isFlipButtonSupportedForMode:", objc_msgSend(v17, "mode"))}];
  v16 = [(CAMViewfinderViewController *)self _captureController];
  [v6 setActivePrimaryConstituentDeviceType:{objc_msgSend(v16, "activePrimaryConstituentDeviceType")}];

  [v6 setExpandedModeWheelOnboardingSupported:{objc_msgSend(v4, "isExpandedModeWheelOnboardingSupported")}];
}

- (void)_updateChromePhotoFormatsAndResolutions
{
  v48 = *MEMORY[0x1E69E9840];
  v3 = +[CAMUserPreferences preferences];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [(CAMViewfinderViewController *)self _currentMode];
  v6 = [(CAMViewfinderViewController *)self _currentDevice];
  v31 = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  v7 = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  v8 = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v3 photoEncodingBehaviorForMode:v5 resolvedRAWMode:v7 isCapturingVideo:objc_msgSend(v8 isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  v10 = self;
  v33 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v32 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v11 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:v11])
  {
  }

  else
  {
    v12 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v13 = [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:v12];

    if (!v13)
    {
      goto LABEL_18;
    }
  }

  v30 = self;
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v14 = [&unk_1F16C9560 countByEnumeratingWithState:&v43 objects:v47 count:16];
  if (v14)
  {
    v15 = v14;
    v16 = *v44;
    do
    {
      for (i = 0; i != v15; ++i)
      {
        if (*v44 != v16)
        {
          objc_enumerationMutation(&unk_1F16C9560);
        }

        v18 = *(*(&v43 + 1) + 8 * i);
        v19 = [v4 isPhotoResolutionSupported:objc_msgSend(v18 forMode:"intValue") device:v5 photoEncoding:{v6, v9}];
        v20 = [v3 isPhotoFormat:v9 enabledForMode:objc_msgSend(v18 device:"intValue"), v5, v6];
        if (v19)
        {
          v21 = v20 == 0;
        }

        else
        {
          v21 = 1;
        }

        if (!v21)
        {
          [v33 addIndex:{objc_msgSend(v18, "integerValue")}];
        }
      }

      v15 = [&unk_1F16C9560 countByEnumeratingWithState:&v43 objects:v47 count:16];
    }

    while (v15);
  }

  [v32 addIndex:{objc_msgSend(v3, "photoEncodingBehavior") != 0}];
  v10 = v30;
  if ([v3 rawControlEnabled])
  {
    [v32 addIndex:2];
  }

LABEL_18:
  v22 = [(CAMViewfinderViewController *)v10 _storageController];
  v23 = [(CAMViewfinderViewController *)v10 _currentGraphConfiguration];
  [v22 availableRecordingTimeInSecondsForGraphConfiguration:v23];
  v25 = v24;

  v26 = [v3 photoEncodingBehavior];
  v42 = [v3 preferredHEICPhotoResolutionForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](v10, "_currentDevicePosition")}];
  [v3 resolveDesiredPhotoResolution:v42 livePhotoMode:-[CAMViewfinderViewController _desiredLivePhotoMode](v10 rawMode:"_desiredLivePhotoMode") conflicts:-[CAMViewfinderViewController _desiredRAWMode](v10 mode:"_desiredRAWMode") device:-[CAMViewfinderViewController _photoFormatConflicts](v10 resolvedPhotoResolution:"_photoFormatConflicts") resolvedLivePhotoMode:{-[CAMViewfinderViewController _currentMode](v10, "_currentMode"), -[CAMViewfinderViewController _currentDevice](v10, "_currentDevice"), &v42, 0}];
  v27 = [(CAMViewfinderViewController *)v10 chromeConfigurator];
  v34[0] = MEMORY[0x1E69E9820];
  v34[1] = 3221225472;
  v34[2] = __70__CAMViewfinderViewController__updateChromePhotoFormatsAndResolutions__block_invoke;
  v34[3] = &unk_1E76F9DC0;
  v34[4] = v10;
  v35 = v33;
  v36 = v32;
  v37 = v31;
  v38 = v42;
  v39 = v9;
  v40 = v26;
  v41 = v25;
  v28 = v32;
  v29 = v33;
  [v27 performChanges:v34];
}

void __70__CAMViewfinderViewController__updateChromePhotoFormatsAndResolutions__block_invoke(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setSupportedPhotoResolutionRawValues:v2];

  v4 = *(a1 + 48);
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setSupportedPhotoEncodingBehaviorRawValues:v4];

  v6 = [*(a1 + 32) chromeConfigurator];
  [v6 setPhotoResolution:*(a1 + 56)];

  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setDefaultPhotoResolution:*(a1 + 64)];

  v8 = [*(a1 + 32) chromeConfigurator];
  [v8 setPhotoEncodingBehavior:*(a1 + 72)];

  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setDefaultPhotoEncodingBehavior:*(a1 + 80)];

  v10 = [*(a1 + 32) chromeConfigurator];
  [v10 setRemainingRecordingTime:*(a1 + 88)];
}

- (CAMViewfinderPresentationDelegate)presentationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_presentationDelegate);

  return WeakRetained;
}

- ($F24F406B2B787EFB06265DBA3D28CBD5)_nightModeDurationMapping
{
  minimumDuration = self->minimumDuration;
  maximumDuration = self->maximumDuration;
  result.var1 = maximumDuration;
  result.var0 = minimumDuration;
  return result;
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_desiredAdvancedPhotoFormat
{
  v2 = &self->2728;
  encoding = self->encoding;
  resolution = v2->resolution;
  result.var1 = resolution;
  result.var0 = encoding;
  return result;
}

- (UIView)_captureAnimationPreviewOverlay
{
  WeakRetained = objc_loadWeakRetained(&self->__captureAnimationPreviewOverlay);

  return WeakRetained;
}

- (CAMViewfinderViewControllerStillImageCaptureRequestTestingDelegate)stillImageCaptureTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_stillImageCaptureTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerVideoCaptureRequestTestingDelegate)videoCaptureTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_videoCaptureTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerCameraRollTestingDelegate)cameraRollControllerTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_cameraRollControllerTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerUnlockDelegate)unlockDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_unlockDelegate);

  return WeakRetained;
}

- (CAMCameraConfigurationDelegate)configurationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_configurationDelegate);

  return WeakRetained;
}

- (CAMCaptureDelegate)captureDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_captureDelegate);

  return WeakRetained;
}

- (void)_commitCTMCaptureWithType:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_commitCTMCaptureWithType:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)stillImageRequestDidCompleteStillImageLocalPersistence:withResponse:error:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_startCapturingVideoWithRequest:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)panoramaRequestDidStartCapturing:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

void __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_setWantsVisualTextAnalysis:animated:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_handleTextAnalysisStillImageResponse:error:forRequest:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_stillImageCaptureRequestForTextAnalysis
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)request:didFailWithError:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

void __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)actionDidUpdateTitle:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_handleSmartStyleIntensitySliderChangedValue:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlShouldBeginGesture:(unint64_t)a1 .cold.1(unint64_t a1)
{
  v1 = CAMDebugStringForControlDisableReasons(a1);
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0(&dword_1A3640000, v2, v3, "Shutter control should already be disabled for reasons: %{public}@", v4, v5, v6, v7, v8);
}

- (void)dynamicShutterControlDidShortPress:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.4()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.4()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressPauseResumeButton:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPresentCounter:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_captureEventSoundWithURL:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_deviceForSelectButtonZoomDisplayZoomFactor:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_handleApplicationWillAddDeactivationReason:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_availableDefaultCaptureMode
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_resolvedSmartFramingFieldOfViewForMode:devicePosition:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

@end