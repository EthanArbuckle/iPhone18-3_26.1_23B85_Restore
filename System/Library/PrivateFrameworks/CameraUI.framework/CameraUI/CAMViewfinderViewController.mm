@interface CAMViewfinderViewController
+ (int64_t)_pressTypeForCaptureButton:(int64_t)button;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_advancedPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_desiredAdvancedPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)_essentialPhotoFormat;
- ($0AC6E346AE4835514AAA8AC86D8F4844)currentPhotoFormat;
- ($76EADD4ED24426C67044446678BAA581)_dynamicShutterSettingsForGraphConfiguration:(SEL)configuration;
- ($E5C720D6BB068A42F0C2CD001350366C)_dynamicShutterPrivateSettingsForGraphConfiguration:(id)configuration;
- ($F24F406B2B787EFB06265DBA3D28CBD5)_nightModeDurationMapping;
- (BOOL)_allowsPhysicalCaptureInteraction;
- (BOOL)_arePhotoFormatConflictsSupportedForMode:(int64_t)mode device:(int64_t)device;
- (BOOL)_autoHideHomeIndicatorForOrientation:(int64_t)orientation;
- (BOOL)_canPerformModeChangeForSwipeAtLocation:(CGPoint)location;
- (BOOL)_canShowIndicatorDuringTrueVideoRecordingForType:(unint64_t)type withGraphConfiguration:(id)configuration;
- (BOOL)_captureStillImageWithCurrentSettings;
- (BOOL)_captureStillImageWithRequest:(id)request error:(id *)error;
- (BOOL)_depthEffectEnabledFromSuggestion;
- (BOOL)_hasBeenPromptedForICPLToday;
- (BOOL)_hasSignificantAmountOfRecordingTimeForCurrentConfiguration;
- (BOOL)_isActiveZooming;
- (BOOL)_isCTMVideoSupportedForGraphConfiguration:(id)configuration;
- (BOOL)_isCapturing;
- (BOOL)_isCapturingTimelapse;
- (BOOL)_isControlDrawerShowingPersistentControl;
- (BOOL)_isDepthEffectApertureSupportedForGraphConfiguration:(id)configuration;
- (BOOL)_isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:(int64_t)status;
- (BOOL)_isDepthSuggestionAllowedForCurrentConfigurationIsBurst:(BOOL)burst;
- (BOOL)_isDisplayingDocumentScanningButton;
- (BOOL)_isDisplayingMRCButton;
- (BOOL)_isExpectedNightModeDurationCancelable;
- (BOOL)_isFlashCompromisedForDevicePosition:(int64_t)position;
- (BOOL)_isFlashOrTorchSupportedForGraphConfiguration:(id)configuration;
- (BOOL)_isFlashUnavailableForMode:(int64_t)mode;
- (BOOL)_isFlipButtonSupportedForMode:(int64_t)mode;
- (BOOL)_isFrontRearSimultaneousVideoActiveForMode:(int64_t)mode devicePosition:(int64_t)position;
- (BOOL)_isFrontRearSimultaneousVideoSupportedForMode:(int64_t)mode devicePosition:(int64_t)position;
- (BOOL)_isHDRSupportedForGraphConfiguration:(id)configuration;
- (BOOL)_isLivePhotoSupportedForGraphConfiguration:(id)configuration;
- (BOOL)_isLivePhotoSupportedForMode:(int64_t)mode device:(int64_t)device;
- (BOOL)_isMenuButtonConflictingWithView:(id)view;
- (BOOL)_isNightModeCaptureCanceling;
- (BOOL)_isNightModePortraitAvailableForMode:(int64_t)mode device:(int64_t)device zoomFactor:(double)factor;
- (BOOL)_isNightModeUpdatingDeferred;
- (BOOL)_isPinchToZoomAllowed;
- (BOOL)_isPrimaryDisplayAssetForCoordinationInfo:(id)info;
- (BOOL)_isScreenExternalDisplay;
- (BOOL)_isShowingBurstIndicatorView;
- (BOOL)_isShowingCameraRoll;
- (BOOL)_isSwipeToModeSwitchEnabled;
- (BOOL)_isVideoStabilizationIndicatorPrimary;
- (BOOL)_isZoomAllowedCurrently;
- (BOOL)_isZoomAllowedForGraphConfiguration:(id)configuration;
- (BOOL)_isZooming;
- (BOOL)_modeChangeSwipeMatchesExposureBiasPanDirection;
- (BOOL)_pauseCapturingVideo;
- (BOOL)_redirectShutterEventIfNecessary:(unint64_t)necessary;
- (BOOL)_resolvedFlipAspectRatioForMode:(int64_t)mode videoConfiguration:(int64_t)configuration devicePosition:(int64_t)position trueVideoEnabled:(BOOL)enabled;
- (BOOL)_resolvedSmartFramingAutoRotationEnabled;
- (BOOL)_resolvedSmartFramingAutoZoomEnabled;
- (BOOL)_resumeCaptureVideo;
- (BOOL)_shouldAllowControlDrawerForGraphConfiguration:(id)configuration;
- (BOOL)_shouldAllowControlDrawerToggleForGraphConfiguration:(id)configuration orientation:(int64_t)orientation;
- (BOOL)_shouldAllowHapticsForCurrentState;
- (BOOL)_shouldAnimateViewfinderCloseForReason:(int64_t)reason;
- (BOOL)_shouldApplyTopBarRotationForGraphConfiguration:(id)configuration;
- (BOOL)_shouldCaptureWithTimer;
- (BOOL)_shouldCreateAndEmbedControl:(int64_t)control;
- (BOOL)_shouldDisableDepthSuggestionForNightModeForConfiguration:(id)configuration;
- (BOOL)_shouldDisableEventInteractionForGraphConfiguration:(id)configuration callActive:(BOOL)active;
- (BOOL)_shouldDisableEventInteractionForModeDisabledReasons:(id)reasons;
- (BOOL)_shouldDisableModeForGraphConfiguration:(id)configuration callActive:(BOOL)active;
- (BOOL)_shouldEmulateAggregateCameraZoomForGraphConfiguration:(id)configuration;
- (BOOL)_shouldEnableApertureButton;
- (BOOL)_shouldEnableAspectRatioButton;
- (BOOL)_shouldEnableControlDrawerToggle;
- (BOOL)_shouldEnableControlStatusIndicator:(unint64_t)indicator;
- (BOOL)_shouldEnableDrawerControl:(int64_t)control;
- (BOOL)_shouldEnableExposureControlButton;
- (BOOL)_shouldEnableFilterButton;
- (BOOL)_shouldEnableFlashButton;
- (BOOL)_shouldEnableFlipButton;
- (BOOL)_shouldEnableHDRButton;
- (BOOL)_shouldEnableIntensityButton;
- (BOOL)_shouldEnableLivePhotoButton;
- (BOOL)_shouldEnableModeDial;
- (BOOL)_shouldEnableNightModeControl;
- (BOOL)_shouldEnablePhotoFormatButton;
- (BOOL)_shouldEnableProResButton;
- (BOOL)_shouldEnableRAWButton;
- (BOOL)_shouldEnableSemanticStyleControl;
- (BOOL)_shouldEnableSharedLibraryButton;
- (BOOL)_shouldEnableSmartStyleControl;
- (BOOL)_shouldEnableSmartStylesSwipeGestures;
- (BOOL)_shouldEnableSwipeToModeSwitch;
- (BOOL)_shouldEnableTextAnalysisButton;
- (BOOL)_shouldEnableTimerButton;
- (BOOL)_shouldEnableVideoConfigurationControl;
- (BOOL)_shouldEnableVideoStabilizationButton;
- (BOOL)_shouldEnableZoomControl;
- (BOOL)_shouldHideApertureButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideAspectRatioControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideBadgesForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideControlStatusIndicatorsForCommonStateForType:(unint64_t)type;
- (BOOL)_shouldHideElapsedTimeViewForGraphConfiguration:(id)configuration orientation:(int64_t)orientation;
- (BOOL)_shouldHideFilterButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideFilterNameBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideFlashButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideFlipButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideFocusAndExposureLockBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideGridViewForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideHDRButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideImageWellForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideIntensityButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideLightingControlBadgeForGraphConfiguration:(id)configuration orientation:(int64_t)orientation;
- (BOOL)_shouldHideLightingControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideLightingNameBadgeForGraphConfiguration:(id)configuration orientation:(int64_t)orientation;
- (BOOL)_shouldHideLightingNameBadgesForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideLivePhotoBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideLivePhotoButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)configuration isCapturingBurst:(BOOL)burst;
- (BOOL)_shouldHidePanoramaViewForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHidePortraitModeInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideQRCodeInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideShutterButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideStillDuringVideoButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideTimerButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideTopBarForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideUtilityBarForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideZoomControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldHideZoomSliderForGraphConfiguration:(id)configuration ignoreExpiredVisibilityTimer:(BOOL)timer;
- (BOOL)_shouldMonitorDeviceMotionForGraphConfiguration:(id)configuration;
- (BOOL)_shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll;
- (BOOL)_shouldProcessMachineReadableMetadata;
- (BOOL)_shouldProcessTextRegions;
- (BOOL)_shouldReportUserInitiationTimeForCurrentSettings;
- (BOOL)_shouldRequestDepthDeliveryForBurst:(BOOL)burst;
- (BOOL)_shouldResetZoomForChangeFromMode:(int64_t)mode toMode:(int64_t)toMode;
- (BOOL)_shouldRotateTopBarForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowAutoMacroButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowChromeExternalStorageIconForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowCleanLensesInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowDepthSuggestionButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowDescriptionOverlayViewForGraphConfiguration:(id)configuration viewClass:(Class *)class;
- (BOOL)_shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowDocumentScanningButton;
- (BOOL)_shouldShowDrawerControlOfType:(int64_t)type forGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowExposureButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowFlashCompromisedInstructionsForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowFlipAspectRatioButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowFreeResourcesInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowFrontPIPButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowImageAnalysisButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowImageAnalysisInstructionLabel;
- (BOOL)_shouldShowIndicatorOfType:(unint64_t)type forGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowNightModeControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowPhotoFormatButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowPhotoVideoModeSwitchForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowPreviewOverlayButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowProResButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowRAWButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSemanticStyleControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSharedLibraryBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSharedLibraryButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSharedLibraryIndicatorForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowShutterButtonDisabled;
- (BOOL)_shouldShowSmartFramingAutoRotationForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSmartFramingAutoZoomForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSmartStyleControlForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSmartStyleIndicatorForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSpatialBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowSpatialCaptureInstructionsForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowTextBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowUnsupportedExternalStorageFormat;
- (BOOL)_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:(int64_t)behavior;
- (BOOL)_shouldShowVideoConfigurationIndicatorForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowVideoStabilizationBadgeForGraphConfiguration:(id)configuration;
- (BOOL)_shouldShowVideoStabilizationButtonForGraphConfiguration:(id)configuration;
- (BOOL)_shouldSuspendCaptureSessionForGraphConfiguration:(id)configuration callActive:(BOOL)active;
- (BOOL)_shouldSuspendCaptureSessionForModeDisabledReasons:(id)reasons;
- (BOOL)_shouldUpdateCaptureOrientation;
- (BOOL)_shouldUseBurstForCaptureTimer;
- (BOOL)_shouldUseFiltersForGraphConfiguration:(id)configuration;
- (BOOL)_shouldUsePhotoModePortraitEffect;
- (BOOL)_shouldUsePhotoModePortraitEffectIsBurst:(BOOL)burst;
- (BOOL)_shouldUseTransientLightingBadgesForGraphConfiguration:(id)configuration;
- (BOOL)_shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice;
- (BOOL)_shouldUseZoomButtonForCameraToggleForGraphConfiguration:(id)configuration;
- (BOOL)_shouldUseZoomControlInsteadOfSlider;
- (BOOL)_smartFramingAutoRotationMonitoringEnabled;
- (BOOL)_smartStyleChangeSwipeMatchesExposureBiasPanDirection;
- (BOOL)_startCapturingPanoramaWithRequest:(id)request;
- (BOOL)_startCapturingVideoWithRequest:(id)request;
- (BOOL)_startTimelapse;
- (BOOL)_stillDuringVideoButtonPressed:(id)pressed;
- (BOOL)_stillDuringVideoButtonReleased:(id)released;
- (BOOL)_stopCapturingPanorama;
- (BOOL)_stopCapturingVideo;
- (BOOL)_stopTimelapse;
- (BOOL)_takePhotoForExternalClientWithCountdown:(unint64_t)countdown internalTimerOverridesCountdown:(BOOL)overridesCountdown;
- (BOOL)_trueVideoIsActive;
- (BOOL)_trueVideoIsCapturing;
- (BOOL)_trueVideoIsTransitioningFromCapture;
- (BOOL)_trueVideoIsTransitioningToCapture;
- (BOOL)_trueVideoIsTransitioningToCapturingOrCapturing;
- (BOOL)_updateDuetSystemConstraintsIfNecessary;
- (BOOL)_urgentlyNeedsToPurgeDiskSpace;
- (BOOL)_useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:(id)configuration;
- (BOOL)_wantsCaptureAnimationForRequest:(id)request;
- (BOOL)_wantsExternalStorageOutputEnabled;
- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)mode videoConfiguration:(int64_t)configuration desiredProResVideoMode:(int64_t)videoMode;
- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)mode videoEncodingBehavior:(int64_t)behavior;
- (BOOL)_wantsHDRControlsVisible;
- (BOOL)_wantsHDRControlsVisibleForGraphConfiguration:(id)configuration;
- (BOOL)_wantsLightingControlForGraphConfiguration:(id)configuration;
- (BOOL)_wantsLightingControlForMode:(int64_t)mode devicePosition:(int64_t)position;
- (BOOL)_wantsZoomControlForGraphConfiguration:(id)configuration;
- (BOOL)_wantsZoomSliderForGraphConfiguration:(id)configuration;
- (BOOL)_zoomControlReconfiguresGraphConfiguration:(id)configuration;
- (BOOL)cameraRollControllerShouldRequestUnlock:(id)unlock;
- (BOOL)canToggleBetweenZoomFactorsForZoomControl:(id)control;
- (BOOL)captureControllerShouldPlayAudioCue:(id)cue;
- (BOOL)capturePhoto;
- (BOOL)dynamicShutterControlCanStartOnTouchDown:(id)down;
- (BOOL)dynamicShutterControlShouldBeginGesture:(id)gesture;
- (BOOL)fullscreenViewfinderCanUpdatePreviewSemanticStyles:(id)styles;
- (BOOL)gestureRecognizer:(id)recognizer shouldReceiveTouch:(id)touch;
- (BOOL)gestureRecognizer:(id)recognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(id)gestureRecognizer;
- (BOOL)gestureRecognizer:(id)recognizer shouldRequireFailureOfGestureRecognizer:(id)gestureRecognizer;
- (BOOL)gestureRecognizerShouldBegin:(id)begin;
- (BOOL)handleURLIfNeeded:(id)needed;
- (BOOL)imageAnalysisInteraction:(id)interaction shouldBeginAtPoint:(CGPoint)point forAnalysisType:(unint64_t)type;
- (BOOL)isCapturingLivePhoto;
- (BOOL)isCapturingPhoto;
- (BOOL)isDockAccessoryConnectedAndTracking;
- (BOOL)isDockKitTrackingLocked;
- (BOOL)isInCameraRollView;
- (BOOL)isRecording;
- (BOOL)navigateToViewfinderView;
- (BOOL)prefersHomeIndicatorAutoHidden;
- (BOOL)prefersInterfaceOrientationLocked;
- (BOOL)prefersStatusBarHidden;
- (BOOL)pressShutterButtonWithTouchUpDelay:(double)delay shutterBehavior:(int64_t)behavior;
- (BOOL)previewViewControllerShouldRestrictExposureBiasPanToTouchesNearSlider:(id)slider;
- (BOOL)remoteShutterBeginBurstCapture:(id)capture;
- (BOOL)remoteShutterEndBurstCapture:(id)capture;
- (BOOL)remoteShutterPauseCapture:(id)capture;
- (BOOL)remoteShutterResumeCapture:(id)capture;
- (BOOL)remoteShutterStartCapture:(id)capture;
- (BOOL)remoteShutterStopCapture:(id)capture;
- (BOOL)shouldEnableFlashMenuCommand;
- (BOOL)shouldEnableFlipCameraMenuCommand;
- (BOOL)shouldEnableLivePhotoMenuCommand;
- (BOOL)shouldEnableTimerMenuCommand;
- (BOOL)shouldHideCleanLensInstructionLabel;
- (BOOL)shouldHideElapsedTimeView;
- (BOOL)shouldHideFilterNameBadge;
- (BOOL)shouldHideFlashButton;
- (BOOL)shouldHideFlipButton;
- (BOOL)shouldHideHDRButton;
- (BOOL)shouldHideLightingControl;
- (BOOL)shouldHideLightingNameBadgeForOrientation:(int64_t)orientation;
- (BOOL)shouldHideLivePhotoButton;
- (BOOL)shouldHidePortraitModeInstructionLabel;
- (BOOL)shouldHideQRCodeInstructionLabel;
- (BOOL)shouldHideTimerButton;
- (BOOL)shouldHideTopBar;
- (BOOL)shouldShiftPreviewForUtilityBar;
- (BOOL)shouldShowInstructionLabel;
- (BOOL)shouldSwitchToVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior;
- (BOOL)startRecording;
- (BOOL)stopRecording;
- (BOOL)takeStillDuringVideoWithTouchUpDelay:(double)delay;
- (BOOL)videoConfigurationStatusIndicatorShouldRespondToTap:(id)tap;
- (BOOL)zoomControlShouldSnapDialToSwitchOverZoomFactors:(id)factors;
- (CAMCameraConfigurationDelegate)configurationDelegate;
- (CAMCaptureDelegate)captureDelegate;
- (CAMControlDrawer)_controlDrawer;
- (CAMElapsedTimeView)_targetElapsedTimeView;
- (CAMFullscreenViewfinder)_fullscreenViewfinder;
- (CAMPortraitModeInstructionLabel)_targetPortraitModeInstructionLabel;
- (CAMQRCodeInstructionLabel)_targetQRCodeInstructionLabel;
- (CAMVideoConfigurationStatusIndicator)_targetVideoConfigurationStatusIndicator;
- (CAMViewfinderPresentationDelegate)presentationDelegate;
- (CAMViewfinderReviewButtonSource)reviewButtonSource;
- (CAMViewfinderTransitionable)_viewfinderTransitionable;
- (CAMViewfinderViewController)initWithCaptureController:(id)controller captureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration locationController:(id)locationController motionController:(id)motionController timelapseController:(id)timelapseController keepAliveController:(id)aliveController remoteShutterController:(id)self0 powerController:(id)self1 cameraRollController:(id)self2 librarySelectionController:(id)self3 callStatusMonitor:(id)self4 storageController:(id)self5 usingEmulationMode:(int64_t)self6 initialLayoutStyle:(int64_t)self7 options:(int64_t)self8;
- (CAMViewfinderViewControllerCameraRollTestingDelegate)cameraRollControllerTestDelegate;
- (CAMViewfinderViewControllerStillImageCaptureRequestTestingDelegate)stillImageCaptureTestDelegate;
- (CAMViewfinderViewControllerUnlockDelegate)unlockDelegate;
- (CAMViewfinderViewControllerVideoCaptureRequestTestingDelegate)videoCaptureTestDelegate;
- (CGAffineTransform)customPreviewViewTransform;
- (CGPoint)prominentObjectManagerPointOfInterestInNormalizedDeviceSpace:(id)space;
- (CGRect)_rectForModeChangeSwipeAllowedZone;
- (CGRect)chromeSidebarFrame;
- (CGRect)reviewUsingOverlayFrame;
- (CGRect)sourceRectForPopoverActionPicker:(id)picker;
- (CGSize)_desiredPreviewSizeForStillImageCapture;
- (CGSize)_portraitOrientedSizeForSize:(CGSize)size;
- (NSArray)_smartStyles;
- (UIControl)_primaryShutterControl;
- (UIView)_captureAnimationPreviewOverlay;
- (double)_calculateVerticalOffsetFromZoomPlatterToFrame:(CGRect)frame fromView:(id)view;
- (double)_currentMaximumZoomFactor;
- (double)_defaultZoomFactorForGraphConfiguration:(id)configuration;
- (double)_defaultZoomFactorForGraphConfiguration:(id)configuration captureOrientation:(int64_t)orientation;
- (double)_exposureBiasForMode:(int64_t)mode trueVideoEnabled:(BOOL)enabled;
- (double)_minimumExecutionTimeForChangeToGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration;
- (double)_zoomFactorForSelectButtonDisplayZoomFactor:(double)factor device:(int64_t)device;
- (double)_zoomFactorForZoomSliderValue:(double)value;
- (double)_zoomSliderValueForZoomFactor:(double)factor;
- (double)timeIntervalForDuration:(int64_t)duration;
- (id)_acceptableSizeMRCResultsFromResults:(id)results;
- (id)_autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:(id)configuration;
- (id)_captureEventSoundWithURL:(id)l;
- (id)_controlTypesForGraphConfiguration:(id)configuration;
- (id)_currentCaptureFiltersForBurst:(BOOL)burst;
- (id)_currentSmartStyle;
- (id)_debugEnabledDescriptionForControl:(id)control withReason:(id)reason;
- (id)_debugStringForApplicationDeactivationReason:(int)reason;
- (id)_debugStringForDisabledModeReasons:(id)reasons;
- (id)_disabledModeReasonsForGraphConfiguration:(id)configuration callActive:(BOOL)active;
- (id)_embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:(id)configuration;
- (id)_enabledPhotoFormatsForMode:(int64_t)mode device:(int64_t)device;
- (id)_filteredTextResults:(id)results;
- (id)_flashOrTorchDisabledMessageForCurrentPowerPressure;
- (id)_generateAnalyticsCaptureEventForTimelapse;
- (id)_generateAnalyticsCaptureEventWithRequest:(id)request burst:(BOOL)burst;
- (id)_graphConfigurationForChangeToMode:(int64_t)mode device:(int64_t)device fromGraphConfiguration:(id)configuration;
- (id)_headphoneInteractionCaptureSoundForCurrentCaptureMode;
- (id)_imageAnalysisButton;
- (id)_imageAnalysisInstructionLabel;
- (id)_nightModeInstructionLabel;
- (id)_originalCaptureFiltersForMode:(int64_t)mode devicePosition:(int64_t)position;
- (id)_panoramaCaptureRequestWithCurrentSettings;
- (id)_previewFiltersForMode:(int64_t)mode device:(int64_t)device wantsPhotoModePortraitEffect:(BOOL)effect;
- (id)_primaryControlStatusIndicatorTypes;
- (id)_referenceStyleForSmartStyle:(id)style;
- (id)_secondaryControlStatusIndicatorTypes;
- (id)_semanticStyleForCapture;
- (id)_semanticStyleForCaptureWithSupport:(unint64_t)support;
- (id)_semanticStyleForPreview;
- (id)_semanticStyleForPreviewWithSupport:(unint64_t)support;
- (id)_stillImageCaptureRequestForTextAnalysis;
- (id)_stillImageCaptureRequestWithCurrentSettingsAsBurst:(BOOL)burst maximumLength:(int64_t)length;
- (id)_supportedCaptureModes;
- (id)_targetLightingControl;
- (id)_textInteractionInsert;
- (id)_videoCaptureRequestWithCurrentSettings;
- (id)cameraRollControllerSourceAssetRegionOfInterest:(id)interest;
- (id)currentContentSize;
- (id)matchingDockKitTrackedSubjectForAnstID:(int64_t)d;
- (id)modesForModeDial:(id)dial;
- (id)viewfinderView;
- (int64_t)_aspectRatioCropForMode:(int64_t)mode devicePosition:(int64_t)position;
- (int64_t)_aspectRatioForMode:(int64_t)mode videoConfiguration:(int64_t)configuration devicePosition:(int64_t)position trueVideoEnabled:(BOOL)enabled;
- (int64_t)_autorotationStyleForLayoutStyle:(int64_t)style;
- (int64_t)_availableDefaultCaptureMode;
- (int64_t)_bottomBarBackgroundStyleForMode:(int64_t)mode;
- (int64_t)_configuredDevice;
- (int64_t)_configuredMode;
- (int64_t)_currentCaptureRequestOrigin;
- (int64_t)_currentDevice;
- (int64_t)_currentDevicePosition;
- (int64_t)_currentMaxPhotoResolution;
- (int64_t)_currentMode;
- (int64_t)_currentPhotoEncodingBehavior;
- (int64_t)_currentRawFileFormatEncodingBehavior;
- (int64_t)_currentVideoChromeVideoFormat;
- (int64_t)_currentVideoConfiguration;
- (int64_t)_defaultSmartFramingFieldOfViewForOrientation:(int64_t)orientation;
- (int64_t)_deviceForSelectButtonZoomDisplayZoomFactor:(double)factor;
- (int64_t)_diskSpaceAlertType;
- (int64_t)_displayedFlashModeForMode:(int64_t)mode flashActive:(BOOL *)active;
- (int64_t)_effectFilterTypeForMode:(int64_t)mode;
- (int64_t)_elapsedTimeViewIdleBackgroundStyle;
- (int64_t)_filterTypeForItemIndex:(int64_t)index;
- (int64_t)_focusAndExposureLockBadgeTypeForCurrentState;
- (int64_t)_itemIndexForFilterType:(int64_t)type;
- (int64_t)_lastCapturedFilterTypeForMode:(int64_t)mode;
- (int64_t)_lightingControlLayoutPositionForGraphConfiguration:(id)configuration;
- (int64_t)_mappedVideoConfigurationForVideoConfiguration:(int64_t)configuration proResVideoMode:(int64_t)mode outputToExternalStorage:(BOOL)storage;
- (int64_t)_maximumBurstLengthForTimer;
- (int64_t)_nextFramerateVideoConfigurationForVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior;
- (int64_t)_nextResolutionVideoConfigurationForVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior;
- (int64_t)_nightModeForMode:(int64_t)mode captureMode:(int64_t)captureMode device:(int64_t)device isBurst:(BOOL)burst;
- (int64_t)_persistenceOptionsForBehavior:(unint64_t)behavior allowingOptionalLocalPersistence:(BOOL)persistence;
- (int64_t)_preferredControlToOpenInDrawerForMode:(int64_t)mode;
- (int64_t)_primaryInstructionLabelForGraphConfiguration:(id)configuration;
- (int64_t)_resolvedColorSpaceForMode:(int64_t)mode videoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior device:(int64_t)device;
- (int64_t)_resolvedDeviceForZoomFactor:(double)factor fromGraphConfiguration:(id)configuration toGraphConfiguration:(id)graphConfiguration;
- (int64_t)_resolvedSmartFramingFieldOfViewForMode:(int64_t)mode devicePosition:(int64_t)position;
- (int64_t)_resolvedTorchModeForGraphConfiguration:(id)configuration;
- (int64_t)_resolvedVideoStabilizationMode;
- (int64_t)_resolvedVideoStabilizationModeForVideoConfiguration:(int64_t)configuration;
- (int64_t)_sanitizedLightingTypeForMode:(int64_t)mode device:(int64_t)device;
- (int64_t)_sanitizedVideoConfigurationForMode:(int64_t)mode device:(int64_t)device allowOverrides:(BOOL)overrides;
- (int64_t)_secondaryInstructionLabelForGraphConfiguration:(id)configuration;
- (int64_t)_shutterButtonModeForCameraMode:(int64_t)mode isCapturing:(BOOL)capturing;
- (int64_t)_temporaryPersistenceOptionsForBehavior:(unint64_t)behavior;
- (int64_t)_topBarBackgroundStyleForMode:(int64_t)mode capturing:(BOOL)capturing;
- (int64_t)_videoConfigurationForImagePickerQualityType:(int64_t)type;
- (int64_t)_videoConfigurationFramerateForGraphConfiguration:(id)configuration;
- (int64_t)_videoConfigurationResolutionForGraphConfiguration:(id)configuration;
- (int64_t)_visibleSuggestionButtonForGraphConfiguration:(id)configuration;
- (int64_t)_zoomControlLayoutPositionForGraphConfiguration:(id)configuration;
- (int64_t)cameraRollControllerPreferredPresentationOrientation:(id)orientation;
- (int64_t)expandedControlTypeForExpandingDrawerInFullscreenViewfinder:(id)viewfinder;
- (unint64_t)_currentSemanticStyleSupport;
- (unint64_t)_fullscreenViewfinderZoomStyle;
- (unint64_t)_nextModeSwitchDirectionForLayoutStyle:(int64_t)style;
- (unint64_t)_previewConfigurationForMode:(int64_t)mode devicePosition:(int64_t)position videoThumbnailOutputEnabled:(BOOL)enabled;
- (unint64_t)_previousModeSwipeDirectionForLayoutStyle:(int64_t)style;
- (unint64_t)_reasonsToDisableShutterButton;
- (unint64_t)_shutterButtonFeedbackForCurrentConfiguration;
- (unint64_t)_supportedInterfaceOrientationsForLayoutStyle:(int64_t)style wantsTextAnalysis:(BOOL)analysis;
- (unint64_t)preferredScreenEdgesDeferringSystemGestures;
- (unint64_t)supportedInterfaceOrientations;
- (unint64_t)zoomControl:(id)control accessoryButtonTapIndexInDisplayZoomFactors:(id)factors;
- (void)_acknowledgeDescriptionOverlayViewForMode:(int64_t)mode;
- (void)_advanceVideoFrameRate;
- (void)_advanceVideoResolution;
- (void)_apertureSliderDidChangeApertureValue:(id)value;
- (void)_applyAutorotationCorrectingTransformForOrientation:(int64_t)orientation;
- (void)_applySelectedEffectFilterType:(int64_t)type;
- (void)_applyTransformsForAutorotationStyle:(int64_t)style;
- (void)_attemptShutterPressWithBlock:(id)block;
- (void)_attemptShutterReleaseWithBlock:(id)block;
- (void)_availableDefaultCaptureMode;
- (void)_beginCapturingBurst;
- (void)_beginNightModeInstructionLabelCountDown;
- (void)_cancelCTMCapture;
- (void)_cancelCaptureAnimation;
- (void)_captureControllerDidOutputMRC;
- (void)_captureOrientationChanged:(id)changed;
- (void)_captureRequest:(id)request didCompleteVideoCaptureWithResponse:(id)response error:(id)error;
- (void)_changeToGraphConfiguration:(id)configuration zoomFactor:(double)factor fromGraphConfiguration:(id)graphConfiguration;
- (void)_changeToZoomFactor:(double)factor rampDuration:(double)duration zoomRampTuning:(int64_t)tuning shouldAnimate:(BOOL)animate updateOverlay:(BOOL)overlay;
- (void)_clearCurrentHeadphonesEventWithReason:(id)reason;
- (void)_clearFilterScrubberLayerContentsIfNotNeededFromCallsite:(id)callsite;
- (void)_closeViewfinderForChangeFromMode:(int64_t)mode toMode:(int64_t)toMode fromDevice:(int64_t)device toDevice:(int64_t)toDevice;
- (void)_collapseExpandedButtonsAnimated:(BOOL)animated;
- (void)_commitCTMCaptureWithType:(int64_t)type;
- (void)_configureImageAnalysisButton;
- (void)_configureSwipeToModeSwitchGestureRecognizersDirection;
- (void)_configureZoomControlForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_createApertureButtonIfNecessary;
- (void)_createBurstIndicatorViewIfNecessary;
- (void)_createCameraCaseShutterNotifierIfNeeded;
- (void)_createChromeConfiguratorWithGraphConfiguration:(id)configuration;
- (void)_createChromeViewControllerIfNeeded;
- (void)_createCleanLensesInstructionLabelIfNecessary;
- (void)_createCommonControlsIfNecessary;
- (void)_createCommonGestureRecognizersIfNecessary;
- (void)_createElapsedTimeViewIfNecessary;
- (void)_createFilterNameBadgeIfNecessary;
- (void)_createFlashButtonIfNecessary;
- (void)_createFlipButtonIfNecessary;
- (void)_createFocusAndExposureLockBadgeIfNecessary;
- (void)_createGridViewIfNecessary;
- (void)_createHDRButtonIfNecessary;
- (void)_createHeadphonesTimerSoundsIfNeeded;
- (void)_createHorizonLevelViewIfNecessary;
- (void)_createImageAnalysisButtonIfNeededForConfiguration:(id)configuration;
- (void)_createImageAnalysisInstructionLabelIfNeeded;
- (void)_createIntensityButtonIfNecessary;
- (void)_createLevelViewIfNecessary;
- (void)_createLightingControlIfNecessary;
- (void)_createLightingNameBadgeIfNecessary;
- (void)_createLivePhotoBadgeIfNecessary;
- (void)_createLivePhotoButtonIfNecessary;
- (void)_createModeDialIfNecessary;
- (void)_createModeSpecificControlsForConfiguration:(id)configuration;
- (void)_createOrDestroyHDRButtonIfNecessary;
- (void)_createOrDestroyHorizonLevelViewIfNecessary;
- (void)_createOrDestroyLevelViewIfNecessary;
- (void)_createOrDestroyLevelViewModelIfNecessary;
- (void)_createOrDestroySharedLibraryBadgeIfNecessary;
- (void)_createOrDestroySharedLibraryButtonIfNecessary;
- (void)_createOrDestroySharedLibraryControlsIfNecessary;
- (void)_createPanoramaControlsIfNecessary;
- (void)_createPanoramaViewControllerIfNecessary;
- (void)_createPhysicalCaptureInteractionIfNeeded;
- (void)_createPortraitApertureSliderIfNecessary;
- (void)_createPortraitIntensitySliderIfNecessary;
- (void)_createPortraitModeControlsIfNecessary;
- (void)_createPortraitModeInstructionLabelIfNecessary;
- (void)_createQRCodeInstructionLabelIfNecessary;
- (void)_createShallowDepthOfFieldBadgeIfNecessary;
- (void)_createShutterButtonIfNecessary;
- (void)_createStillDuringVideoButtonIfNecessary;
- (void)_createStillImageControlsIfNecessary;
- (void)_createSwipeToModeSwitchGestureRecognizersIfNecessary;
- (void)_createTimerButtonIfNecessary;
- (void)_createTimerIndicatorViewIfNecessary;
- (void)_createUtilityBarIfNecessary;
- (void)_createVideoConfigurationStatusIndicatorIfNecessary;
- (void)_createVideoControlsIfNecessary;
- (void)_createZoomControlIfNecessary;
- (void)_createZoomPinchGestureRecognizerIfNecessary;
- (void)_createZoomSliderIfNecessary;
- (void)_destroyGestureRecognizersRequiringStandardControls;
- (void)_destroyGridViewIfNecessary;
- (void)_destroyHDRButtonIfNecessary;
- (void)_destroyHorizonLevelViewIfNecessary;
- (void)_destroyLevelViewIfNecessary;
- (void)_deviceOrientationChanged:(id)changed;
- (void)_didChangeToGraphConfiguration:(id)configuration forDesiredConfiguration:(id)desiredConfiguration requestID:(int)d;
- (void)_didStartTimer:(unint64_t)timer;
- (void)_disableAutoSmartFramingIfSupported;
- (void)_dismissDescriptionOverlayView:(id)view withDuration:(double)duration fromUserAction:(BOOL)action;
- (void)_dismissDiskSpaceAlertViewAnimated:(BOOL)animated;
- (void)_dismissDockedMRCButtonIfNeededAnimated:(BOOL)animated;
- (void)_dismissDocumentScanningButton;
- (void)_dismissFlashOrTorchUnavailableAlertViewAnimated:(BOOL)animated;
- (void)_dismissOverlays;
- (void)_displayLensSmudgeDetected:(int64_t)detected;
- (void)_embedAllControlsWithLayoutStyle:(int64_t)style;
- (void)_embedApertureButtonWithLayoutStyle:(int64_t)style;
- (void)_embedBurstIndicatorView;
- (void)_embedCleanLensesInstructionLabel;
- (void)_embedDescriptionOverlayView:(id)view forMode:(int64_t)mode;
- (void)_embedDisabledModeOverlayView:(id)view;
- (void)_embedElapsedTimeViewWithLayoutStyle:(int64_t)style;
- (void)_embedFilterNameBadge;
- (void)_embedFlashButtonWithLayoutStyle:(int64_t)style;
- (void)_embedFlipButtonWithLayoutStyle:(int64_t)style;
- (void)_embedFocusAndExposureLockBadge;
- (void)_embedGridView;
- (void)_embedHDRButtonWithLayoutStyle:(int64_t)style;
- (void)_embedHorizonLevelView;
- (void)_embedIntensityButtonWithLayoutStyle:(int64_t)style;
- (void)_embedLevelView;
- (void)_embedLightingControl;
- (void)_embedLightingNameBadge;
- (void)_embedLivePhotoBadge;
- (void)_embedLivePhotoButtonWithLayoutStyle:(int64_t)style;
- (void)_embedModeDial;
- (void)_embedPanoramaView;
- (void)_embedPortraitApertureSlider;
- (void)_embedPortraitIntensitySlider;
- (void)_embedPortraitModeInstructionLabel;
- (void)_embedQRCodeInstructionLabel;
- (void)_embedShallowDepthOfFieldBadge;
- (void)_embedSharedLibraryBadge;
- (void)_embedShutterButton;
- (void)_embedStillDuringVideoButton;
- (void)_embedTimerButtonWithLayoutStyle:(int64_t)style;
- (void)_embedTimerIndicatorView;
- (void)_embedUtilityBar;
- (void)_embedVideoConfigurationStatusIndicatorWithLayoutStyle:(int64_t)style;
- (void)_embedZoomControl;
- (void)_embedZoomSlider;
- (void)_ensureSensitiveContentHidden;
- (void)_fallbackToValidProResVideoConfigurationIfNeeded;
- (void)_forceHideBadgesAnimated:(BOOL)animated;
- (void)_handleApertureButtonTapped:(id)tapped;
- (void)_handleApplicationDidBecomeActive:(id)active;
- (void)_handleApplicationDidEnterBackground:(id)background;
- (void)_handleApplicationDidRemoveDeactivationReason:(id)reason;
- (void)_handleApplicationWillAddDeactivationReason:(id)reason;
- (void)_handleApplicationWillEnterForeground:(id)foreground;
- (void)_handleApplicationWillResignActive:(id)active;
- (void)_handleBurstTimerFired:(id)fired;
- (void)_handleCallStatusMonitorDidChangeCallActive:(id)active;
- (void)_handleCleanLensesInstructionLabelTapped:(id)tapped;
- (void)_handleContentSizeCategoryDidChange:(id)change;
- (void)_handleDisabledShutterTap;
- (void)_handleDocumentScanningPillPress;
- (void)_handleExposureSliderDidChangeValue:(id)value;
- (void)_handleFlashButtonChangedFlashMode;
- (void)_handleFlashIndicator;
- (void)_handleFlashIndicatorChangedMode:(id)mode;
- (void)_handleFlashIndicatorLongPressed:(id)pressed;
- (void)_handleFlipAspectRatioButtonTapped:(id)tapped;
- (void)_handleFlipButtonTouchDown:(id)down;
- (void)_handleFreeResourcesLabelTapped:(id)tapped;
- (void)_handleGeneralCaptureControllerSuspension;
- (void)_handleHDRButtonChangedHDRMode;
- (void)_handleHDRIndicator;
- (void)_handleImageAnalysisButtonTapped:(id)tapped;
- (void)_handleIntensityButtonTapped:(id)tapped;
- (void)_handleIntensitySliderDidChangeValue:(id)value;
- (void)_handleLivePhotoButtonChangedLivePhotoMode;
- (void)_handleLivePhotoIndicator;
- (void)_handleModeDialTouchDown:(id)down;
- (void)_handleModeDialValueChanged:(id)changed;
- (void)_handleNightModeIndicator;
- (void)_handleNightModeSliderDidChangeValue:(id)value;
- (void)_handlePhotoFormatPickerChangedPhotoFormat:(id)format;
- (void)_handlePhotoFormatPickerLongPressed:(id)pressed;
- (void)_handlePhotoFormatPickerTapped;
- (void)_handlePhotoVideoModeSwitchValueChanged:(id)changed;
- (void)_handlePhysicalButtonCancelled:(int64_t)cancelled;
- (void)_handlePhysicalButtonPressed:(int64_t)pressed;
- (void)_handlePhysicalButtonReleased:(int64_t)released;
- (void)_handlePhysicalCaptureInteractionDidChangePhase:(unint64_t)phase forButton:(int64_t)button event:(id)event;
- (void)_handlePillPressForCurrentMRCAction;
- (void)_handleProResIndicator;
- (void)_handleRAWIndicator;
- (void)_handleSceneDidEnterBackground:(id)background;
- (void)_handleSemanticStyleControlDidChangeValue:(id)value;
- (void)_handleSessionWasPrewarmed:(id)prewarmed;
- (void)_handleSharedLibraryButton;
- (void)_handleSharedLibraryIndicator;
- (void)_handleShutterButtonActionWithEventTriggerDescription:(id)description;
- (void)_handleShutterButtonCancelled:(id)cancelled;
- (void)_handleShutterButtonDragEnter:(id)enter;
- (void)_handleShutterButtonPressed:(id)pressed;
- (void)_handleShutterButtonReleased:(id)released fromDragExit:(BOOL)exit;
- (void)_handleSmartStyleIntensitySliderChangedValue:(double)value;
- (void)_handleSmartStylePickerSwipe:(id)swipe;
- (void)_handleSmartStyleResetButton;
- (void)_handleSmartStyleShutterButtonPressed:(id)pressed;
- (void)_handleSmartStyleShutterButtonReleased:(id)released;
- (void)_handleTextAnalysisStillImageResponse:(id)response error:(id)error forRequest:(id)request;
- (void)_handleTimelapseLowDiskSpaceNotification:(id)notification;
- (void)_handleTimerButtonChangedTimerDuration;
- (void)_handleTouchDownForZoomControl:(id)control;
- (void)_handleTouchDownForZoomSlider:(id)slider;
- (void)_handleUserChangedRAWMode:(int64_t)mode;
- (void)_handleUserChangedSemanticStyle:(id)style;
- (void)_handleUserChangedToDevice:(int64_t)device;
- (void)_handleUserChangedToExposureSliderBias:(double)bias updateSystemOverlayValues:(BOOL)values;
- (void)_handleVideoStabilizationIndicator;
- (void)_handleZoomPinchGestureRecognizer:(id)recognizer;
- (void)_hideBurstIndicatorView;
- (void)_hideControlsForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_hideUtilityBarAnimated:(BOOL)animated;
- (void)_imageWellSetContentHidden:(BOOL)hidden;
- (void)_indicateCaptureTimerProgressUsingTorch;
- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:(unint64_t)time;
- (void)_layoutViewfinderForShowingFilterScrubber:(BOOL)scrubber animated:(BOOL)animated;
- (void)_limitZoomRangeForRecordingIfNecessary;
- (void)_openViewfinderForAllModeAndDeviceChangeReasons;
- (void)_pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll;
- (void)_performCaptureAnimationWithDuration:(double)duration;
- (void)_performCaptureAnimationWithDuration:(double)duration curve:(id)curve color:(id)color fadeOut:(BOOL)out;
- (void)_performChangeFromGraphConfiguration:(id)configuration toGraphConfiguration:(id)graphConfiguration zoomFactor:(double)factor deferIfConfigurationInFlight:(BOOL)flight;
- (void)_performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange;
- (void)_playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable;
- (void)_populateZoomForCaptureEvent:(id)event;
- (void)_prepareDeferredProcessingIfNeeded;
- (void)_preparePhotoOutputForExpectedPhotoResolution;
- (void)_prepareTopBarForOrientationChangeDuringConfiguration;
- (void)_presentCameraRollViewControllerAnimated:(BOOL)animated interactive:(BOOL)interactive;
- (void)_presentCameraRollViewControllerIfPossibleAnimated:(BOOL)animated interactive:(BOOL)interactive;
- (void)_presentImageWellImage:(id)image uuid:(id)uuid animated:(BOOL)animated;
- (void)_presentInitialImageWellImageForSession;
- (void)_previewDidStartRunning:(id)running;
- (void)_processResults:(id)results completionHandler:(id)handler;
- (void)_processTextRegionResults;
- (void)_reconfigureCaptureGraphWithCurrentMode;
- (void)_remoteShutterSetZoomFactor:(double)factor;
- (void)_requestPasscodeUnlockForCameraRollController:(id)controller forAction:(unint64_t)action completionBlock:(id)block;
- (void)_requestPasscodeUnlockForDocumentScanningWithCompletionBlock:(id)block;
- (void)_requestPasscodeUnlockWithCompletionBlock:(id)block;
- (void)_resetDynamicAspectRatio;
- (void)_resetExposureClipping;
- (void)_resetMachineReadableMetadataAndProcessing;
- (void)_resetNightModeDurationMappingAnimated:(BOOL)animated;
- (void)_resetObjectResults;
- (void)_resetPortraitLightingToDefaultAnimated:(BOOL)animated;
- (void)_resetPortraitModeApertureValueIfNeededForGraphConfiguration:(id)configuration zoomFactor:(double)factor;
- (void)_resetSmartFramingFieldOfViewAnimated:(BOOL)animated;
- (void)_resetZoom;
- (void)_resolveAndUpdatePotentiallyConflictingControls:(BOOL)controls animated:(BOOL)animated;
- (void)_resolvePotentiallyConflictingControlsForMode:(int64_t)mode device:(int64_t)device resolvedFlashMode:(int64_t *)flashMode resolvedHDRMode:(int64_t *)rMode resolvedLivePhotoMode:(int64_t *)photoMode resolvedRAWMode:(int64_t *)wMode resolvedPhotoResolution:(int64_t *)resolution;
- (void)_restoreZoomRangeAfterRecordingIfNecessary;
- (void)_rotateTopBarAndControlsToOrientation:(int64_t)orientation shouldAnimate:(BOOL)animate;
- (void)_setCapturingFromTimer:(BOOL)timer;
- (void)_setCurrentGraphConfiguration:(id)configuration;
- (void)_setDesiredTorchMode:(int64_t)mode animated:(BOOL)animated;
- (void)_setEffectFilterType:(int64_t)type forMode:(int64_t)mode;
- (void)_setExposureBias:(double)bias forMode:(int64_t)mode;
- (void)_setExternalStorageOutputEnabled:(BOOL)enabled animated:(BOOL)animated;
- (void)_setHomeIndicatorAutoHideOrientation:(int64_t)orientation;
- (void)_setInternalShutterButtonSpinning:(BOOL)spinning;
- (void)_setLayoutStyle:(int64_t)style;
- (void)_setLightingType:(int64_t)type forMode:(int64_t)mode;
- (void)_setOutOfDiskSpace:(BOOL)space;
- (void)_setOverrideSmartFramingAutoRotateInLandscapeEnabled:(BOOL)enabled;
- (void)_setOverrideSmartFramingAutoZoomInLandscapeEnabled:(BOOL)enabled;
- (void)_setPhotoFormatConflict:(unint64_t)conflict isConflicting:(BOOL)conflicting;
- (void)_setPreferredControlToOpenInDrawer:(int64_t)drawer forMode:(int64_t)mode;
- (void)_setPreventingAdditionalCaptures:(BOOL)captures;
- (void)_setResolvedTimerDuration:(int64_t)duration;
- (void)_setResolvedTorchMode:(int64_t)mode animated:(BOOL)animated;
- (void)_setShallowDepthOfFieldStatus:(int64_t)status stagePreviewStatus:(int64_t)previewStatus animated:(BOOL)animated;
- (void)_setShowingFilterScrubber:(BOOL)scrubber animated:(BOOL)animated;
- (void)_setShowingPortraitApertureSlider:(BOOL)slider animated:(BOOL)animated;
- (void)_setShowingPortraitIntensitySlider:(BOOL)slider animated:(BOOL)animated;
- (void)_setSmartFramingAutoRotationEnabled:(BOOL)enabled;
- (void)_setSmartFramingAutoZoomEnabled:(BOOL)enabled;
- (void)_setSpatialModeHasVideoSelected:(BOOL)selected;
- (void)_setSwipeToModeSwitchEnabled:(BOOL)enabled;
- (void)_setTimerDurationAndUpdateUI:(int64_t)i animated:(BOOL)animated;
- (void)_setUpTipManagerIfNeeded;
- (void)_setView:(id)view hidden:(BOOL)hidden delayedInTotalAnimationTime:(double)time normalizedFadeoutDuration:(double)duration;
- (void)_setWantsFilterScrubberVisible:(BOOL)visible animated:(BOOL)animated;
- (void)_setWantsSmartFramingAutoRotationDefault:(BOOL)default;
- (void)_setWantsSmartFramingAutoZoomDefault:(BOOL)default;
- (void)_setWantsVisualTextAnalysis:(BOOL)analysis animated:(BOOL)animated;
- (void)_setupAndStartSynchronizedCaptureTimerDelegate;
- (void)_setupBurstTimerWithDelay:(double)delay;
- (void)_showBurstIndicatorView;
- (void)_showControlChangeBadgeWithUpdateHandler:(id)handler;
- (void)_showControlsForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_showDiskSpaceAlertView;
- (void)_showExternalStorageRecordingFailedAlert;
- (void)_showFlashOrTorchUnavailableAlertView;
- (void)_showFrameDropsAlert;
- (void)_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:(int64_t)configuration;
- (void)_showSmartFramingAutoBadgeForSmartFramingFieldOfView:(int64_t)view previousSmartFramingFieldOfView:(int64_t)ofView;
- (void)_showUnsupportedFormatAlert;
- (void)_snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:(id)configuration;
- (void)_snapshotAndFadeDisappearingView:(id)view parentViewOverride:(id)override shouldHideView:(BOOL)hideView;
- (void)_spatialModeToggledTo:(unint64_t)to;
- (void)_startCaptureSessionIfNecessaryIfVisibleAndInterrupted;
- (void)_startCapturingBurstWithRequest:(id)request;
- (void)_startCountdownForCaptureTimer;
- (void)_startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:(id)configuration;
- (void)_startFlashingVideoStabilizationBadge;
- (void)_startOrCancelPurgeIfNecessary;
- (void)_startSynchronizedCaptureTimerDelegate;
- (void)_startTimer:(unint64_t)timer;
- (void)_startTransitioningToTrueVideoCaptureFromSourceMode:(int64_t)mode sourceAspectRatio:(int64_t)ratio toDestinationMode:(int64_t)destinationMode;
- (void)_stillImageCaptureRequestForTextAnalysis;
- (void)_stopCaptureTimerProgressUsingTorch;
- (void)_stopCapturingBurst;
- (void)_stopCapturingCTMVideo;
- (void)_stopCountdownForCaptureTimer;
- (void)_stopFlashingVideoStabilizationBadge;
- (void)_stopRecordingForDeactivationReason:(id)reason;
- (void)_swipedToNextCameraMode:(id)mode;
- (void)_swipedToPreviousCameraMode:(id)mode;
- (void)_synchronizedCaptureTimerDelegateFired:(id)fired;
- (void)_teardownBurstTimer;
- (void)_teardownSynchronizedCaptureTimerDelegate;
- (void)_toggleBetweenBackFacingZoomFactorsForZoomControl:(id)control;
- (void)_toggleBetweenFrontFacingZoomFactorsForZoomControl:(id)control;
- (void)_toggleZoomForSmartFramingFieldOfView:(int64_t)view;
- (void)_trueVideoStartCapture;
- (void)_trueVideoStopCapture;
- (void)_unembedAndDestroyAllControls;
- (void)_unembedDisabledModeOverlayView:(id)view;
- (void)_unembedGridView;
- (void)_unembedHorizonLevelView;
- (void)_unembedLevelView;
- (void)_updateAllControlsWithContentSize:(id)size;
- (void)_updateAutoMacroButton;
- (void)_updateAutoMacroStatus;
- (void)_updateBadgeVisibilityAnimated:(BOOL)animated;
- (void)_updateCachedMRCResults:(id)results;
- (void)_updateCaptureTimerIndicatorWithFaceResult:(id)result;
- (void)_updateChromeAvailableCaptureModes;
- (void)_updateChromeClassicModeSwitching;
- (void)_updateChromeConfiguratorForCurrentGraphConfiguration:(id)configuration;
- (void)_updateChromeControlsForGraphConfiguration:(id)configuration;
- (void)_updateChromeFilterScrubberForGraphConfiguration:(id)configuration;
- (void)_updateChromePhotoFormatsAndResolutions;
- (void)_updateChromeSharedLibraryState;
- (void)_updateChromeViewControllerVideoRecordingState;
- (void)_updateChromeViewfinderGeometryWithViewportFrame:(CGRect)frame;
- (void)_updateCleanLensesInstructionLabelForCurrentState;
- (void)_updateControlDrawerContentsVisibilityAnimated:(BOOL)animated;
- (void)_updateControlDrawerContentsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateControlStatusBarContentsVisibilityAnimated:(BOOL)animated;
- (void)_updateControlStatusBarContentsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateControlsDisabledByNightModeAnimated:(BOOL)animated;
- (void)_updateControlsForVisibleFilterScrubberAnimated:(BOOL)animated;
- (void)_updateControlsRelatedToDepthSuggestionAnimated:(BOOL)animated;
- (void)_updateCurrentPreviewFiltersOnCaptureController;
- (void)_updateDepthEffectApertureForGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration zoomFactor:(double)factor;
- (void)_updateDepthEffectSuggestionButton;
- (void)_updateDescriptionOverlayVisibilityForMode:(int64_t)mode allowShow:(BOOL)show allowHide:(BOOL)hide animated:(BOOL)animated;
- (void)_updateDisabledModeOverlayViewForCurrentState;
- (void)_updateDisabledModeUIAnimated:(BOOL)animated;
- (void)_updateDiskSpaceAlertViewVisibilityAnimated:(BOOL)animated;
- (void)_updateDocumentScanningButtonIfNeeded;
- (void)_updateEnabledControlsWithReason:(id)reason forceLog:(BOOL)log;
- (void)_updateExposureButtonForCurrentState;
- (void)_updateExposureSliderForCurrentState;
- (void)_updateExternalStorageDataSources;
- (void)_updateExternalStorageMonitoringState:(unint64_t)state;
- (void)_updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController;
- (void)_updateFilterButtonOnState;
- (void)_updateFilterNameBadgeAnimated:(BOOL)animated;
- (void)_updateFilterScrubberAfterCapture;
- (void)_updateFilterScrubberForGraphConfiguration:(id)configuration;
- (void)_updateFlashButtonAvailability;
- (void)_updateFlashButtonForMode:(int64_t)mode animated:(BOOL)animated;
- (void)_updateFlashModeOnControllerForMode:(int64_t)mode;
- (void)_updateFlipAspectRatioButtonForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateFocusAfterZoomIfNecessary;
- (void)_updateFocusAndExposureLockBadgeAnimated:(BOOL)animated;
- (void)_updateForCurrentConfiguration;
- (void)_updateForCurrentMachineReadableCodeAction;
- (void)_updateForShallowDepthOfFieldStatusChangedAnimated:(BOOL)animated;
- (void)_updateFreeResourcesInstructionLabelForCurrentState;
- (void)_updateFrontRearSimultaneousVideoEnabled:(BOOL)enabled performGraphConfiguration:(BOOL)configuration;
- (void)_updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:(id)configuration;
- (void)_updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateFullscreenViewfinderZoomSliderIfNecessary;
- (void)_updateHDRButtonAnimated:(BOOL)animated;
- (void)_updateHomeIndicatorBehaviorsForCaptureOrientation;
- (void)_updateImageAnalysisButton;
- (void)_updateImageAnalysisInstructions;
- (void)_updateImageWellWithStillImageResponse:(id)response forRequest:(id)request error:(id)error;
- (void)_updateIntensityButtonForCurrentState;
- (void)_updateInterfaceModulationForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateLayoutStyle;
- (void)_updateLensPositionLockedByUser:(BOOL)user;
- (void)_updateLevelMotionTracking;
- (void)_updateLightingControlFadesForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateLightingUIForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateLivePhotoButtonAnimated:(BOOL)animated;
- (void)_updateMachineReadableCodeButtonForAction:(id)action animated:(BOOL)animated;
- (void)_updateMachineReadableCodeButtonFromAction:(id)action;
- (void)_updateMacroButtonState;
- (void)_updateMaxRecordingTimeInstructionLabelForGraphConfiguration:(id)configuration;
- (void)_updateModeDisabledForCurrentStateAnimated:(BOOL)animated;
- (void)_updateModeDisabledForGraphConfiguration:(id)configuration callActive:(BOOL)active animated:(BOOL)animated;
- (void)_updateNightModeConflict:(unint64_t)conflict isConflicting:(BOOL)conflicting performResolution:(BOOL)resolution;
- (void)_updateNightModeControlsAnimated:(BOOL)animated;
- (void)_updateNightModePhotoModeDepthConflictAndPerformResolution:(BOOL)resolution;
- (void)_updateNightModeSlider;
- (void)_updateObjectResults:(id)results headResults:(id)headResults bodyResults:(id)bodyResults;
- (void)_updateOriginForRequest:(id)request;
- (void)_updatePairedVideoCaptureOnControllerForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll;
- (void)_updatePanoramaSizeIfNeededForGraphConfiguration:(id)configuration;
- (void)_updatePanoramaViewForCurrentState;
- (void)_updatePanoramaViewVisibilityForViewfinderTransition;
- (void)_updatePhotoFormatPickerAnimated:(BOOL)animated;
- (void)_updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:(BOOL)disappearing;
- (void)_updatePortraitApertureButtonForGraphConfiguration:(id)configuration zoomFactor:(double)factor animated:(BOOL)animated;
- (void)_updatePortraitApertureSliderForGraphConfiguration:(id)configuration zoomFactor:(double)factor;
- (void)_updatePortraitIntensitySliderForCurrentState;
- (void)_updatePortraitModeInstructionLabelForCurrentState;
- (void)_updatePreviewControllerIndicatorStyle;
- (void)_updatePreviewControllerPortraitStatus;
- (void)_updatePreviewSemanticStyleAnimated:(BOOL)animated;
- (void)_updateProResButtonAnimated:(BOOL)animated;
- (void)_updateProResControlsForCurrentState;
- (void)_updateProminentObjectManagerWithCachedMetadataResults;
- (void)_updatePropertiesForCaptureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration;
- (void)_updateQRCodeInstructionLabelForCurrentState;
- (void)_updateRAWButtonAnimated:(BOOL)animated;
- (void)_updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:(BOOL)selection;
- (void)_updateResolvedNightModeAnimated:(BOOL)animated;
- (void)_updateSelectedSmartStyle:(id)style animateSliders:(BOOL)sliders;
- (void)_updateSelectedSmartStyleFromPicker;
- (void)_updateSemanticStyleControlsForCurrentStateAnimated:(BOOL)animated;
- (void)_updateSharedLibraryBadgeForCurrentState;
- (void)_updateSharedLibraryButtonAnimated:(BOOL)animated;
- (void)_updateSharedLibraryButtonOnSubviewsForLayoutStyle:(int64_t)style;
- (void)_updateShutterButtonForEndOfNightModeCapture;
- (void)_updateShutterButtonForGraphConfiguration:(id)configuration isCapturing:(BOOL)capturing animated:(BOOL)animated;
- (void)_updateShutterButtonLegibility;
- (void)_updateShutterButtonSpinning;
- (void)_updateShutterEffectsEnablementForSystemPressureState;
- (void)_updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:(double)duration zoomRampTuning:(int64_t)tuning;
- (void)_updateSmartFramingFieldOfViewForGraphConfiguration:(id)configuration rampDuration:(double)duration zoomRampTuning:(int64_t)tuning animated:(BOOL)animated;
- (void)_updateSmartFramingForCaptureOrientation:(int64_t)orientation rampDuration:(double)duration zoomRampTuning:(int64_t)tuning animated:(BOOL)animated;
- (void)_updateSmartFramingMonitorForGraphConfiguration:(id)configuration;
- (void)_updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateSmartStyleControlsForCurrentStateAnimateSliders:(BOOL)sliders animateOtherControls:(BOOL)controls;
- (void)_updateSmartStyleOnSession;
- (void)_updateSpatialCaptureUIStateForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateStateForClearedNightModeConflicts:(unint64_t)conflicts;
- (void)_updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:(int64_t)style;
- (void)_updateTextAnalysisWithInsert:(id)insert instructions:(BOOL)instructions animated:(BOOL)animated;
- (void)_updateTopBarForLightingType:(int64_t)type;
- (void)_updateTopBarStyleForGraphConfiguration:(id)configuration capturing:(BOOL)capturing animated:(BOOL)animated;
- (void)_updateTorchModeForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateTorchModeOnControllerForMode:(int64_t)mode;
- (void)_updateTransientLightingBadgeVisibilityAnimated:(BOOL)animated;
- (void)_updateUIForCaptureOrientationAnimated:(BOOL)animated;
- (void)_updateUIForCapturing:(BOOL)capturing animated:(BOOL)animated updateProResControls:(BOOL)controls;
- (void)_updateUserInitiationTimeForRequest:(id)request;
- (void)_updateUserPreferencesForFilterUsage;
- (void)_updateVideoConfigurationStatusIndicatorForGraphConfiguration:(id)configuration animated:(BOOL)animated;
- (void)_updateVideoStabilizationButtonAnimated:(BOOL)animated;
- (void)_updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:(id)configuration;
- (void)_updateViewfinderForExternalChromeState:(id)state;
- (void)_updateViewfinderMaterialAnimated:(BOOL)animated;
- (void)_updateViewfinderMaterialFromStatus:(int64_t)status animated:(BOOL)animated;
- (void)_updateVisibleChromeSuggestionButton:(int64_t)button;
- (void)_updateZoomButtonSymbolForMode:(int64_t)mode device:(int64_t)device videoConfiguration:(int64_t)configuration zoomFactor:(double)factor videoStabilizationStrength:(int64_t)strength animated:(BOOL)animated;
- (void)_updateZoomControlAccessoryStateAnimated:(BOOL)animated;
- (void)_updateZoomControlLayoutForGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration animated:(BOOL)animated;
- (void)_updateZoomFactorForZoomFactor:(double)factor rampDuration:(double)duration interactionType:(int64_t)type didChangeDevice:(id)device;
- (void)_updateZoomUIWithZoomFactor:(double)factor animated:(BOOL)animated;
- (void)_willChangeToGraphConfiguration:(id)configuration zoomFactor:(double)factor fromGraphConfiguration:(id)graphConfiguration animated:(BOOL)animated;
- (void)_writeUserPreferences;
- (void)_zoomControlDidChangeZoomFactor:(double)factor interactionType:(int64_t)type;
- (void)_zoomSliderValueDidChange:(id)change forEvent:(id)event;
- (void)_zoomUIDidChangeToFactor:(double)factor;
- (void)accessoryConnectedAndTracking:(BOOL)tracking;
- (void)accessoryPanoramaMotionCompleted;
- (void)accessoryZoomInByDisplayZoomValue:(double)value;
- (void)actionDidUpdateTitle:(id)title;
- (void)addChildViewController:(id)controller toView:(id)view;
- (void)animateAlongsideFadeOutForTextLiftingView:(id)view;
- (void)animateAlongsideTextLiftingForView:(id)view;
- (void)applyCaptureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration;
- (void)availableDiskSpaceChanged:(id)changed;
- (void)badgeTray:(id)tray didCreateBadgeForType:(unint64_t)type;
- (void)cameraRollController:(id)controller didChangeImageWellImage:(id)image withUUID:(id)d animated:(BOOL)animated;
- (void)cameraRollController:(id)controller didDismissPreviewControllerShouldStartCaptureSession:(BOOL)session;
- (void)cameraRollController:(id)controller willShowPresentingViewControllerShouldStartCaptureSession:(BOOL)session;
- (void)cameraRollControllerDidDismissFullyPresentedCameraRoll:(id)roll;
- (void)cameraRollControllerDidFullyPresentCameraRoll:(id)roll;
- (void)cameraRollControllerRequestsCaptureSessionStopped:(id)stopped;
- (void)cameraRollControllerWillPresentCameraRoll:(id)roll withOneUpController:(id)controller;
- (void)captureController:(id)controller didChangeCameraSystemPressureState:(id)state;
- (void)captureController:(id)controller didChangeDocumentSceneConfidenceResults:(float)results;
- (void)captureController:(id)controller didChangePreviewZoomPIPRect:(CGRect)rect;
- (void)captureController:(id)controller didChangeRampingVideoZoom:(BOOL)zoom;
- (void)captureController:(id)controller didChangeToGraphConfiguration:(id)configuration forDesiredConfiguration:(id)desiredConfiguration requestID:(int)d;
- (void)captureController:(id)controller didOutputAppClipCodeResults:(id)results;
- (void)captureController:(id)controller didOutputFaceResults:(id)results headResults:(id)headResults bodyResults:(id)bodyResults salientObjectResults:(id)objectResults;
- (void)captureController:(id)controller didOutputFlashActive:(BOOL)active;
- (void)captureController:(id)controller didOutputFlashAvailability:(BOOL)availability;
- (void)captureController:(id)controller didOutputFlashCompromise:(unint64_t)compromise;
- (void)captureController:(id)controller didOutputHistogramResult:(id)result;
- (void)captureController:(id)controller didOutputLensPosition:(double)position;
- (void)captureController:(id)controller didOutputLensSmudgeStatus:(int64_t)status;
- (void)captureController:(id)controller didOutputMinAvailableVideoZoomFactor:(double)factor;
- (void)captureController:(id)controller didOutputNightModeDurationMapping:(id)mapping;
- (void)captureController:(id)controller didOutputNightModeStatus:(int64_t)status;
- (void)captureController:(id)controller didOutputOverCapturePreviewStatus:(int64_t)status;
- (void)captureController:(id)controller didOutputQRCodeResults:(id)results;
- (void)captureController:(id)controller didOutputRecommendedSmartFramingFieldOfView:(int64_t)view;
- (void)captureController:(id)controller didOutputShallowDepthOfFieldStatus:(int64_t)status stagePreviewStatus:(int64_t)previewStatus;
- (void)captureController:(id)controller didOutputStereoCaptureStatus:(int64_t)status;
- (void)captureController:(id)controller didOutputTextRegionResults:(id)results;
- (void)captureController:(id)controller didOutputTorchActive:(BOOL)active;
- (void)captureController:(id)controller didOutputTorchAvailability:(BOOL)availability;
- (void)captureController:(id)controller didOutputVideoZoomFactor:(double)factor;
- (void)captureController:(id)controller didUpdateActivePrimaryConstituentDeviceType:(int64_t)type;
- (void)captureController:(id)controller receivedFocusLocked:(BOOL)locked;
- (void)captureController:(id)controller receivedOverlayApertureControlActive:(BOOL)active;
- (void)captureController:(id)controller receivedOverlayChangeSmartStyle:(id)style;
- (void)captureController:(id)controller receivedOverlayUpdateSmartStyle:(id)style;
- (void)captureController:(id)controller receivedOverlayVisible:(BOOL)visible;
- (void)captureController:(id)controller receivedQuietUIActive:(BOOL)active;
- (void)captureController:(id)controller receivedSystemOverlayLensSelectorZoomFactor:(double)factor;
- (void)captureController:(id)controller receivedSystemOverlayUpdateExposureBias:(double)bias;
- (void)captureController:(id)controller willRecoverFromRuntimeError:(id)error;
- (void)captureControllerDidReachMaximumBurstLength:(id)length;
- (void)captureControllerDidStartRunning:(id)running;
- (void)captureControllerDidStopCapturingBurst:(id)burst;
- (void)captureControllerDidStopPlayingBurstEndSound:(id)sound;
- (void)captureControllerDidStopRunning:(id)running;
- (void)captureControllerInterruptionEnded:(id)ended;
- (void)captureControllerWasInterrupted:(id)interrupted;
- (void)captureControllerWillStartCapturingBurst:(id)burst;
- (void)captureControllerWillStartPlayingBurstEndSound:(id)sound;
- (void)changeToMode:(int64_t)mode;
- (void)changeToMode:(int64_t)mode device:(int64_t)device animated:(BOOL)animated;
- (void)closedViewfinderController:(id)controller wantsViewfinderClosedForReason:(int64_t)reason;
- (void)closedViewfinderController:(id)controller wantsViewfinderOpenForReason:(int64_t)reason;
- (void)controlDrawer:(id)drawer didChangeSharedLibraryMode:(int64_t)mode;
- (void)controlDrawer:(id)drawer didChangeValueForControlType:(int64_t)type;
- (void)controlDrawer:(id)drawer didCreateControlForType:(int64_t)type;
- (void)controlDrawer:(id)drawer didSelectMenuItemForControlType:(int64_t)type;
- (void)controlDrawer:(id)drawer wantsFilterScrubberVisible:(BOOL)visible;
- (void)controlDrawerDidCreateApertureSlider:(id)slider;
- (void)controlDrawerDidCreateExposureSlider:(id)slider;
- (void)controlDrawerDidCreateFilterScrubber:(id)scrubber;
- (void)controlDrawerDidCreateIntensitySlider:(id)slider;
- (void)controlDrawerDidCreateNightModeSlider:(id)slider;
- (void)controlDrawerDidCreateSemanticStyleControl:(id)control;
- (void)controlStatusBar:(id)bar didCreateIndicatorForType:(unint64_t)type;
- (void)controlStatusBar:(id)bar didReceiveTapInIndicatorForType:(unint64_t)type;
- (void)controlStatusBar:(id)bar willChangeExpandingControl:(id)control expanded:(BOOL)expanded;
- (void)dealloc;
- (void)descriptionOverlayView:(id)view willBecomeVisible:(BOOL)visible;
- (void)descriptionOverlayViewDidSelectDetail:(id)detail;
- (void)descriptionOverlayViewSetTextViewFrame:(id)frame textViewFrame:(CGRect)viewFrame;
- (void)determinedBurstLength:(int64_t)length forPersistenceUUID:(id)d;
- (void)disabledPreviewController:(id)controller wantsPreviewDisabledForReason:(int64_t)reason;
- (void)disabledPreviewController:(id)controller wantsPreviewEnabledForReason:(int64_t)reason;
- (void)dismissCameraRoll;
- (void)documentScanFlowControllerDidCancel:(id)cancel;
- (void)documentScanFlowControllerDidFail:(id)fail withError:(id)error;
- (void)documentScanFlowControllerDidFinish:(id)finish;
- (void)dynamicShutterControl:(id)control didChangeRelativeZoomProgress:(double)progress;
- (void)dynamicShutterControlDidDismissCounter:(id)counter;
- (void)dynamicShutterControlDidPresentCounter:(id)counter;
- (void)dynamicShutterControlDidPressLockButton:(id)button;
- (void)dynamicShutterControlDidPressPauseResumeButton:(id)button;
- (void)dynamicShutterControlDidShortPress:(id)press;
- (void)dynamicShutterControlDidStart:(id)start withGesture:(int64_t)gesture;
- (void)dynamicShutterControlDidStartZoomGesture:(id)gesture;
- (void)dynamicShutterControlDidStop:(id)stop;
- (void)dynamicShutterControlDidStopZoomGesture:(id)gesture;
- (void)dynamicShutterControlGesturesDidBegin:(id)begin;
- (void)dynamicShutterControlGesturesDidCancel:(id)cancel;
- (void)dynamicShutterControlGesturesDidEnd:(id)end;
- (void)externalStorageMonitor:(id)monitor didChangeConnectedStorageDevices:(id)devices;
- (void)fadeOutAnimationDidEndForView:(id)view;
- (void)frontPIPFrameDidChange:(CGRect)change;
- (void)frontPIPWillAnimateToAnchor:(int64_t)anchor withFrame:(CGRect)frame;
- (void)fullScreenViewfinderDidCreateFlipAspectRatioButton:(id)button;
- (void)fullscreenViewFinder:(id)finder willDismissControlDrawerModallyForControlType:(int64_t)type reason:(int64_t)reason;
- (void)fullscreenViewFinder:(id)finder willPresentControlDrawerModallyForControlType:(int64_t)type reason:(int64_t)reason;
- (void)fullscreenViewfinder:(id)viewfinder didChangeControlDrawerVisibility:(BOOL)visibility animated:(BOOL)animated forReason:(int64_t)reason;
- (void)fullscreenViewfinder:(id)viewfinder didChangeExpanded:(BOOL)expanded forDrawerControlOfType:(int64_t)type animated:(BOOL)animated updatePreferredDrawerControl:(BOOL)control;
- (void)fullscreenViewfinder:(id)viewfinder didChangeSmartStyleControlsVisibility:(BOOL)visibility animated:(BOOL)animated;
- (void)fullscreenViewfinder:(id)viewfinder didCreateInstructionLabel:(int64_t)label;
- (void)fullscreenViewfinderDidChangeSemanticStyle:(id)style;
- (void)fullscreenViewfinderDidCreateControlDrawer:(id)drawer;
- (void)fullscreenViewfinderDidCreatePortraitControls:(id)controls;
- (void)fullscreenViewfinderDidCreateSmartStyleControls:(id)controls;
- (void)fullscreenViewfinderDidCreateSpotlightControlPanel:(id)panel;
- (void)fullscreenViewfinderDidFinishChangingPreviewGeometry:(id)geometry;
- (void)generateAnalyticsSessionEventIfNeeded;
- (void)generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:(int64_t)mode captureDevice:(int64_t)device;
- (void)handleChangedToFlashMode:(int64_t)mode allowFlashOrTorchUnavailableAlert:(BOOL)alert;
- (void)handleChromeControlPanelIsExpanded:(BOOL)expanded;
- (void)handleChromeTopBarMenuState:(int64_t)state;
- (void)handleChromeTopInset:(double)inset;
- (void)handleDoneButtonReleased;
- (void)handleExternalChromeFilterScrubberSelectedIndexChanged:(int64_t)changed;
- (void)handleExternalChromeImageAnalysisButtonChanged:(id)changed;
- (void)handleExternalChromeShutterControlChanged:(id)changed;
- (void)handleFlipButtonReleased;
- (void)handleImageWellReleased;
- (void)handleReviewButtonReleased;
- (void)handleSmartStylePadValueChanged:(CGPoint)changed;
- (void)handleUserChangedFiltersUIVisible:(BOOL)visible;
- (void)handleUserChangedFlippedAspectRatioEnabled:(BOOL)enabled;
- (void)handleUserChangedFrontPIPEnabled:(BOOL)enabled;
- (void)handleUserChangedIsLensPositionLocked:(BOOL)locked;
- (void)handleUserChangedLensPosition:(double)position;
- (void)handleUserChangedPortraitIntensity:(double)intensity;
- (void)handleUserChangedProResMode:(int64_t)mode;
- (void)handleUserChangedProResMode:(int64_t)mode chromeSelectedProResColorSpace:(int64_t)space;
- (void)handleUserChangedSemanticStylePreset:(int64_t)preset sceneBias:(double)bias warmthBias:(double)warmthBias;
- (void)handleUserChangedSemanticStylesUIVisible:(BOOL)visible;
- (void)handleUserChangedSmartFramingAutoRotationEnabled:(BOOL)enabled;
- (void)handleUserChangedSmartFramingAutoZoomEnabled:(BOOL)enabled;
- (void)handleUserChangedSmartStylesUIVisible:(BOOL)visible;
- (void)handleUserChangedToApertureValue:(double)value enableDepthSuggestion:(BOOL)suggestion;
- (void)handleUserChangedToAspectRatioCrop:(int64_t)crop;
- (void)handleUserChangedToHDRMode:(int64_t)mode;
- (void)handleUserChangedToLivePhotoMode:(int64_t)mode;
- (void)handleUserChangedToMacroMode:(int64_t)mode;
- (void)handleUserChangedToMode:(int64_t)mode;
- (void)handleUserChangedToMode:(int64_t)mode device:(int64_t)device;
- (void)handleUserChangedToMode:(int64_t)mode device:(int64_t)device zoomFactor:(double)factor;
- (void)handleUserChangedToNightMode:(unint64_t)mode;
- (void)handleUserChangedToPhotoFormat:(id)format;
- (void)handleUserChangedToSharedLibraryMode:(int64_t)mode;
- (void)handleUserChangedToVideoConfiguration:(int64_t)configuration;
- (void)handleUserChangedVideoStabilizationMode:(int64_t)mode;
- (void)handleUserDidToggleSpatialMode;
- (void)imageAnalysisButton:(id)button didChangeContextMenuDisplayed:(BOOL)displayed;
- (void)lensSmudgeDisplayShouldBeHiddenForDevicePosition:(int64_t)position;
- (void)librarySelectionDidChangeSharedLibraryMode:(int64_t)mode;
- (void)lightingControl:(id)control willChangeExpanded:(BOOL)expanded;
- (void)lightingControlDidChangeExpanded:(id)expanded;
- (void)lightingControlDidChangeSelectedLightingType:(id)type;
- (void)loadView;
- (void)machineReadableCodeButtonDidTapDismiss:(id)dismiss;
- (void)panoramaRequest:(id)request didGeneratePaintingStatus:(id)status;
- (void)panoramaRequest:(id)request didStopWithReason:(int64_t)reason;
- (void)panoramaRequestDidCompleteCapture:(id)capture withResponse:(id)response error:(id)error;
- (void)panoramaRequestDidCompleteLocalPersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)panoramaRequestDidCompleteRemotePersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)panoramaRequestDidStartCapturing:(id)capturing;
- (void)panoramaRequestDidStopCapturing:(id)capturing interrupted:(BOOL)interrupted;
- (void)performDiscreteFeedback:(unint64_t)feedback;
- (void)physicalCaptureNotifierDidChangeState:(id)state forButton:(int64_t)button;
- (void)prepareDiscreteFeedback:(unint64_t)feedback;
- (void)prepareForDefaultImageSnapshotForScreen:(id)screen;
- (void)presentCameraRollViewControllerAnimated:(BOOL)animated withAction:(unint64_t)action selectedAssetIndexFromEnd:(unint64_t)end;
- (void)presentDocumentScanningViewControllerAnimated:(BOOL)animated;
- (void)pressShutterForRemoteShutter;
- (void)pressShutterForRemoteShutterWaitingForViewfinder:(BOOL)viewfinder timeout:(double)timeout;
- (void)pressStillDuringVideoForRemoteShutter;
- (void)previewViewController:(id)controller willResetFocus:(BOOL)focus exposure:(BOOL)exposure;
- (void)previewViewControllerDidChangeFocusOrExposure:(id)exposure;
- (void)previewViewControllerDidChangeFocusOrExposureLocked:(id)locked shouldAnimate:(BOOL)animate;
- (void)previewViewControllerDidChangeVideoFillAspectRatio:(id)ratio;
- (void)prominentObjectManager:(id)manager didChangeCurrentObject:(id)object;
- (void)readUserPreferencesAndHandleChangesWithOverrides:(id)overrides bypassXPCWhenReadingSystemStyle:(BOOL)style;
- (void)remoteShutter:(id)shutter setCaptureDevice:(int64_t)device;
- (void)remoteShutter:(id)shutter setMode:(int64_t)mode;
- (void)remoteShutter:(id)shutter setZoomAmount:(double)amount;
- (void)remoteShutter:(id)shutter takePhotoWithCountdown:(unint64_t)countdown;
- (void)remoteShutterCancelCountdown:(id)countdown;
- (void)request:(id)request didDetectTextWithResult:(id)result;
- (void)request:(id)request didFailWithError:(id)error;
- (void)request:(id)request didRecgonizeTextWithAnalysis:(id)analysis;
- (void)resumeCameraSessionWithCompletion:(id)completion;
- (void)setAutomaticallyAdjustsApplicationIdleTimer:(BOOL)timer;
- (void)setAutorotationStyle:(int64_t)style;
- (void)setAvailableCaptureModes:(id)modes;
- (void)setConfigurationDelegate:(id)delegate;
- (void)setCustomPreviewViewTransform:(CGAffineTransform *)transform;
- (void)setDisablingAdditionalCaptures:(BOOL)captures;
- (void)setDockKitController:(id)controller;
- (void)setHDRMode:(int64_t)mode;
- (void)setImagePickerVideoConfiguration:(int64_t)configuration;
- (void)setMessagesTransitionState:(int64_t)state animated:(BOOL)animated;
- (void)setPerformingReviewUsingOverlay:(BOOL)overlay;
- (void)setPersistenceBehavior:(unint64_t)behavior;
- (void)setPhotoResolution:(int64_t)resolution;
- (void)setPresentedImageWellImage:(id)image;
- (void)setRawMode:(int64_t)mode;
- (void)setShowingStandardControls:(BOOL)controls;
- (void)setShutterButtonSpinning:(BOOL)spinning;
- (void)setSingleUseTimerWithDuration:(int64_t)duration;
- (void)setTorchMode:(int64_t)mode;
- (void)setUserInteractionLoggingEnabled:(BOOL)enabled;
- (void)sharedLibraryTapToRadarAction;
- (void)shutterControlDidUpdateLiquidShutter:(id)shutter;
- (void)shutterControlTouchAttemptedWhileDisabled:(id)disabled;
- (void)simulateShutterButtonPressForCaptureMenuItem;
- (void)spotlightControlPanel:(id)panel didChangeOpenForSpotlight:(int64_t)spotlight;
- (void)spotlightControlPanel:(id)panel didChangeValueForSpotlight:(int64_t)spotlight;
- (void)spotlightControlPanelDidCreateApertureSlider:(id)slider;
- (void)stillImageRequestDidBeginCaptureBeforeResolvingSettings:(id)settings;
- (void)stillImageRequestDidCompleteCapture:(id)capture error:(id)error;
- (void)stillImageRequestDidCompleteStillImageCapture:(id)capture withResponse:(id)response error:(id)error;
- (void)stillImageRequestDidCompleteStillImageLocalPersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)stillImageRequestDidCompleteStillImageRemotePersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)stillImageRequestDidCompleteVideoCapture:(id)capture withResponse:(id)response error:(id)error;
- (void)stillImageRequestDidStartCapturing:(id)capturing resolvedSettings:(id)settings;
- (void)stillImageRequestDidStopCapturingStillImage:(id)image;
- (void)stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:(BOOL)flight;
- (void)stillImageRequestsDidCompleteCapturingLivePhotoVideo;
- (void)stillImageRequestsDidStopCapturingCTMVideo;
- (void)stillImageRequestsWillRequestCTMVideoCaptureEnd;
- (void)stillImageRequestsWillRequestCTMVideoCaptureStart;
- (void)stillImageRequestsWillStartCapturingLivePhotoVideo;
- (void)stopMonitoringForAccidentalLaunchIfNeeded;
- (void)storageControllerDidChangePurgingState:(id)state;
- (void)suspendCameraSessionWithCompletion:(id)completion;
- (void)tapToFocusTriggeredAtPoint:(CGPoint)point;
- (void)timelapseController:(id)controller generatedPlaceholderResult:(id)result withThumbnailImage:(id)image forAssetUUID:(id)d inCaptureSession:(unsigned __int16)session;
- (void)timelapseController:(id)controller persistedPlaceholderResult:(id)result error:(id)error;
- (void)timelapseController:(id)controller startedWithCaptureOrientation:(int64_t)orientation;
- (void)timelapseControllerStopped:(id)stopped;
- (void)timerCache:(id)cache timerDidFireForKey:(id)key;
- (void)toggleBetweenZoomFactorsForZoomControl:(id)control;
- (void)updateControlVisibilityAnimated:(BOOL)animated;
- (void)updateDepthEffectSuggestionEnabled:(BOOL)enabled;
- (void)videoRequestDidCompleteCapture:(id)capture withResponse:(id)response error:(id)error;
- (void)videoRequestDidCompleteLocalPersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)videoRequestDidCompleteRemotePersistence:(id)persistence withResponse:(id)response error:(id)error;
- (void)videoRequestDidResumeCapturing:(id)capturing;
- (void)videoRequestDidStartCapturing:(id)capturing;
- (void)videoRequestDidStopCapturing:(id)capturing;
- (void)videoThumbnailOutputWillBeginRenderingThumbnailsWithContents:(id)contents;
- (void)videoThumbnailOutputWillEndRenderingThumbnails;
- (void)viewDidAppear:(BOOL)appear;
- (void)viewDidDisappear:(BOOL)disappear;
- (void)viewDidLayoutSubviews;
- (void)viewDidLoad;
- (void)viewWillAppear:(BOOL)appear;
- (void)viewWillDisappear:(BOOL)disappear;
- (void)viewWillLayoutSubviews;
- (void)viewWillTransitionToSize:(CGSize)size withTransitionCoordinator:(id)coordinator;
- (void)willHideZoomSlider:(id)slider withAnimationDuration:(double)duration;
- (void)willShowZoomSlider:(id)slider withAnimationDuration:(double)duration;
- (void)zoomControl:(id)control didChangeSelectedButtonIndex:(unint64_t)index displayZoomFactor:(double)factor;
- (void)zoomControl:(id)control didChangeZoomFactor:(double)factor interactionType:(int64_t)type;
- (void)zoomControlDidChangePlatterExpanded:(id)expanded;
- (void)zoomControlDidChangeShowingZoomDial:(id)dial;
- (void)zoomControlDidTapZoomButtonAccessory:(id)accessory;
- (void)zoomSliderDidBeginAutozooming:(id)autozooming;
@end

@implementation CAMViewfinderViewController

- (unint64_t)supportedInterfaceOrientations
{
  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];

  return [(CAMViewfinderViewController *)self _supportedInterfaceOrientationsForLayoutStyle:_layoutStyle wantsTextAnalysis:_wantsVisualTextAnalysis];
}

- (BOOL)prefersStatusBarHidden
{
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  v3 = _cameraRollController;
  if (_cameraRollController)
  {
    prefersPresentingStatusbarHidden = [_cameraRollController prefersPresentingStatusbarHidden];
  }

  else
  {
    prefersPresentingStatusbarHidden = 1;
  }

  return prefersPresentingStatusbarHidden;
}

- (unint64_t)preferredScreenEdgesDeferringSystemGestures
{
  if (([(CAMViewfinderViewController *)self _layoutStyle]| 2) != 2)
  {
    return 0;
  }

  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  v5 = CAMInterfaceOrientationForWindow(window);

  v6 = 1;
  v7 = 4;
  if (v5 != 1)
  {
    v7 = 0;
    v6 = 0;
  }

  if (v5 == 2)
  {
    v8 = 1;
  }

  else
  {
    v8 = v7;
  }

  if (v5 == 2)
  {
    v9 = 4;
  }

  else
  {
    v9 = v6;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (_fullscreenViewfinder)
  {
    v11 = v9;
  }

  else
  {
    v11 = 0;
  }

  return v11 | v8;
}

- (void)loadView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];
  array = [MEMORY[0x1E695DF70] array];
  [(CAMViewfinderViewController *)self _setAccessibilityHUDManagers:array];
  v5 = +[CAMCaptureCapabilities capabilities];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  videoPreviewLayer = [_captureController videoPreviewLayer];

  [previewView setVideoPreviewLayer:videoPreviewLayer];
  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  secondaryVideoPreviewLayer = [_captureController2 secondaryVideoPreviewLayer];

  [previewView setFrontPIPVideoPreviewLayer:secondaryVideoPreviewLayer];
  if ([v5 wantsFullscreenViewfinder])
  {
    v10 = [[CAMFullscreenViewfinder alloc] initWithMetalContext:0];
    [(CAMViewfinderViewController *)self _updateViewfinderForExternalChromeState:v10];
    [(CAMFullscreenViewfinder *)v10 setPreviewView:previewView];
    [(CAMFullscreenViewfinder *)v10 setDelegate:self];
    [(CAMViewfinderViewController *)self setView:v10];
    [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:0];
    [(CAMFullscreenViewfinder *)v10 setZoomStyle:[(CAMViewfinderViewController *)self _fullscreenViewfinderZoomStyle]];
    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderZoomSliderIfNecessary];
    flipButton = [(CAMFullscreenViewfinder *)v10 flipButton];
    [flipButton addTarget:self action:sel__handleFlipButtonTouchDown_ forControlEvents:1];

    flipButton2 = [(CAMFullscreenViewfinder *)v10 flipButton];
    [flipButton2 addTarget:self action:sel_handleFlipButtonReleased forControlEvents:64];

    zoomControl = [(CAMFullscreenViewfinder *)v10 zoomControl];
    [zoomControl addTarget:self action:sel__handleTouchDownForZoomControl_ forControlEvents:1];

    zoomSlider = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [zoomSlider addTarget:self action:sel__handleTouchDownForZoomSlider_ forControlEvents:1];

    zoomSlider2 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [zoomSlider2 addTarget:self action:sel__zoomSliderValueDidChange_forEvent_ forControlEvents:4096];

    photoVideoModeSwitch = [(CAMFullscreenViewfinder *)v10 photoVideoModeSwitch];
    [photoVideoModeSwitch addTarget:self action:sel__handlePhotoVideoModeSwitchValueChanged_ forControlEvents:4096];

    currentContentSize = [(CAMViewfinderViewController *)self currentContentSize];
    IsAccessibilityCategory = UIContentSizeCategoryIsAccessibilityCategory(currentContentSize);

    if (IsAccessibilityCategory)
    {
      v19 = [[CAMBarsAccessibilityHUDManager alloc] initWithView:v10 delegate:self cancelsTouchesInView:1];
      [array addObject:v19];
    }

    shutterControl = [(CAMFullscreenViewfinder *)v10 shutterControl];
    [shutterControl setDelegate:self];

    zoomControl2 = [(CAMFullscreenViewfinder *)v10 zoomControl];
    [zoomControl2 setDelegate:self];

    zoomSlider3 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    [zoomSlider3 setDelegate:self];

    controlStatusBar = [(CAMFullscreenViewfinder *)v10 controlStatusBar];
    [controlStatusBar setDelegate:self];

    badgeTray = [(CAMFullscreenViewfinder *)v10 badgeTray];
    [badgeTray setDelegate:self];

    flipButton3 = [(CAMFullscreenViewfinder *)v10 flipButton];
    flipButton = self->__flipButton;
    self->__flipButton = flipButton3;

    zoomControl3 = [(CAMFullscreenViewfinder *)v10 zoomControl];
    zoomControl = self->__zoomControl;
    self->__zoomControl = zoomControl3;

    zoomSlider4 = [(CAMFullscreenViewfinder *)v10 zoomSlider];
    zoomSlider = self->__zoomSlider;
    self->__zoomSlider = zoomSlider4;

    shutterControl2 = [(CAMFullscreenViewfinder *)v10 shutterControl];
    dynamicShutterControl = self->__dynamicShutterControl;
    self->__dynamicShutterControl = shutterControl2;

    _transitionController = [(CAMViewfinderViewController *)self _transitionController];
    [_transitionController setTarget:v10];
  }

  else
  {
    v10 = [[CAMViewfinderView alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    [(CAMFullscreenViewfinder *)v10 setPreviewView:previewView];
    [(CAMFullscreenViewfinder *)v10 setVisibilityDelegate:self];
    [(CAMFullscreenViewfinder *)v10 setChromePanoramaLayoutDelegate:self];
    [(CAMFullscreenViewfinder *)v10 setUseMessagesLayout:[(CAMViewfinderViewController *)self _useMessagesControls]];
    [(CAMFullscreenViewfinder *)v10 setShowingStandardControls:[(CAMViewfinderViewController *)self isShowingStandardControls]];
    _transitionController2 = [(CAMViewfinderViewController *)self _transitionController];
    [_transitionController2 setTarget:v10];

    [(CAMViewfinderViewController *)self setView:v10];
  }

  [(CAMViewfinderViewController *)self _createPhysicalCaptureInteractionIfNeeded];
  [(CAMViewfinderViewController *)self _createChromeViewControllerIfNeeded];
}

- (id)currentContentSize
{
  traitCollection = [(CAMViewfinderViewController *)self traitCollection];
  preferredContentSizeCategory = [traitCollection preferredContentSizeCategory];

  return preferredContentSizeCategory;
}

- (void)viewDidLoad
{
  v7.receiver = self;
  v7.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v7 viewDidLoad];
  view = [(CAMViewfinderViewController *)self view];
  [view _accessibilitySetInterfaceStyleIntent:2];

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController didMoveToParentViewController:self];
  [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
  [(CAMViewfinderViewController *)self _createCommonGestureRecognizersIfNecessary];
  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  [(CAMViewfinderViewController *)self _updateDisabledModeUIAnimated:0];
  [(CAMViewfinderViewController *)self _presentInitialImageWellImageForSession];
  v5 = [(CAMViewfinderViewController *)self modesForModeDial:0];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setAvailableCaptureModes:v5];

  [(CAMViewfinderViewController *)self _updateChromeAvailableCaptureModes];
  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_createCommonControlsIfNecessary
{
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    [(CAMViewfinderViewController *)self _createShutterButtonIfNecessary];
    if ([v4 isFrontCameraSupported] && objc_msgSend(v4, "isBackCameraSupported"))
    {
      [(CAMViewfinderViewController *)self _createFlipButtonIfNecessary];
    }

    if ([CAMBottomBar wantsVerticalBarForLayoutStyle:_layoutStyle])
    {
      [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
      if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
      {
        [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
      }

      if ([v4 isLivePhotoSupported])
      {
        [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
      }
    }

    [(CAMViewfinderViewController *)self _createModeDialIfNecessary];
    [(CAMViewfinderViewController *)self _createFocusAndExposureLockBadgeIfNecessary];
    if (([v4 isBackFlashSupported] & 1) != 0 || objc_msgSend(v4, "isFrontFlashSupported"))
    {
      [(CAMViewfinderViewController *)self _createFlashButtonIfNecessary];
    }

    [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryControlsIfNecessary];
  }
}

- (void)_createShutterButtonIfNecessary
{
  if (!self->__shutterButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:19])
  {
    v3 = [CUShutterButton shutterButtonWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    shutterButton = self->__shutterButton;
    self->__shutterButton = v3;

    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonPressed_ forControlEvents:1];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonReleased_ forControlEvents:64];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonDragEnter_ forControlEvents:16];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonDragExited_ forControlEvents:32];
    [(CUShutterButton *)self->__shutterButton addTarget:self action:sel__handleShutterButtonCancelled_ forControlEvents:256];
    [(CUShutterButton *)self->__shutterButton setMode:0];
    [(CUShutterButton *)self->__shutterButton setExclusiveTouch:1];
    [(CUShutterButton *)self->__shutterButton setDelegate:self];

    [(CAMViewfinderViewController *)self _embedShutterButton];
  }
}

- (id)viewfinderView
{
  v3 = +[CAMCaptureCapabilities capabilities];
  wantsFullscreenViewfinder = [v3 wantsFullscreenViewfinder];

  if (wantsFullscreenViewfinder)
  {
    view = 0;
  }

  else
  {
    view = [(CAMViewfinderViewController *)self view];
  }

  return view;
}

- (void)_createFlipButtonIfNecessary
{
  if (!self->__flipButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:4])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = +[CAMCaptureCapabilities capabilities];
    overContentFlipButtonSupported = [v4 overContentFlipButtonSupported];

    if (overContentFlipButtonSupported)
    {
      +[CAMFlipButton flipButtonOverContent];
    }

    else
    {
      [CAMFlipButton flipButtonWithLayoutStyle:_layoutStyle];
    }
    v6 = ;
    flipButton = self->__flipButton;
    self->__flipButton = v6;

    [(CAMFlipButton *)self->__flipButton addTarget:self action:sel__handleFlipButtonTouchDown_ forControlEvents:1];
    [(CAMFlipButton *)self->__flipButton addTarget:self action:sel_handleFlipButtonReleased forControlEvents:64];
    [(CAMFlipButton *)self->__flipButton setExclusiveTouch:1];

    [(CAMViewfinderViewController *)self _embedFlipButtonWithLayoutStyle:_layoutStyle];
  }
}

- (void)_createModeDialIfNecessary
{
  if (!self->__modeDial && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:13])
  {
    v3 = [[CAMModeDial alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    modeDial = self->__modeDial;
    self->__modeDial = v3;

    [(CAMModeDial *)self->__modeDial addTarget:self action:sel__handleModeDialTouchDown_ forControlEvents:1];
    [(CAMModeDial *)self->__modeDial addTarget:self action:sel__handleModeDialValueChanged_ forControlEvents:4096];
    [(CAMModeDial *)self->__modeDial setDataSource:self];
    [(CAMModeDial *)self->__modeDial reloadData];

    [(CAMViewfinderViewController *)self _embedModeDial];
  }
}

- (void)_createFocusAndExposureLockBadgeIfNecessary
{
  if (!self->__focusAndExposureLockBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:5])
  {
    v3 = [CAMFocusLockBadge alloc];
    v4 = [(CAMFocusLockBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    focusAndExposureLockBadge = self->__focusAndExposureLockBadge;
    self->__focusAndExposureLockBadge = v4;
  }

  [(CAMViewfinderViewController *)self _embedFocusAndExposureLockBadge];
}

- (CAMViewfinderReviewButtonSource)reviewButtonSource
{
  WeakRetained = objc_loadWeakRetained(&self->_reviewButtonSource);

  return WeakRetained;
}

- (void)_createFlashButtonIfNecessary
{
  if (!self->__flashButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:3])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMFlashButton alloc] initWithLayoutStyle:_layoutStyle];
    flashButton = self->__flashButton;
    self->__flashButton = v4;

    [(CAMFlashButton *)self->__flashButton addTarget:self action:sel__handleFlashButtonChangedFlashMode forControlEvents:4096];
    [(CAMFlashButton *)self->__flashButton addTarget:self action:sel__handleFlashButtonWhileFlashUnavailable forControlEvents:0x1000000];
    [(CAMFlashButton *)self->__flashButton setExclusiveTouch:1];
    [(CAMFlashButton *)self->__flashButton setAllowsAutomaticFlash:1 needsReloadData:0];
    [(CAMFlashButton *)self->__flashButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedFlashButtonWithLayoutStyle:_layoutStyle];
  }
}

- (BOOL)_isShowingCameraRoll
{
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  isCameraRollViewControllerPresented = [_cameraRollController isCameraRollViewControllerPresented];

  return isCameraRollViewControllerPresented;
}

- (BOOL)_isShowingBurstIndicatorView
{
  _burstIndicatorView = [(CAMViewfinderViewController *)self _burstIndicatorView];
  [_burstIndicatorView alpha];
  v4 = v3 > 0.0;

  return v4;
}

- (void)_updateLevelMotionTracking
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [(CAMViewfinderViewController *)self _shouldMonitorDeviceMotionForGraphConfiguration:?];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v5 = _motionController;
  if (v3)
  {
    _levelViewModel = [(CAMViewfinderViewController *)self _levelViewModel];
    [v5 beginUpdatingLevelViewModel:_levelViewModel];
  }

  else
  {
    [_motionController endUpdatingActiveLevelViewModel];
  }
}

- (void)_createCommonGestureRecognizersIfNecessary
{
  [(CAMViewfinderViewController *)self _createZoomPinchGestureRecognizerIfNecessary];
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {

    [(CAMViewfinderViewController *)self _createSwipeToModeSwitchGestureRecognizersIfNecessary];
  }
}

- (void)_createZoomPinchGestureRecognizerIfNecessary
{
  if (!self->__zoomPinchGestureRecognizer)
  {
    v3 = [(UIPinchGestureRecognizer *)[CAMZoomPinchGestureRecognizer alloc] initWithTarget:self action:sel__handleZoomPinchGestureRecognizer_];
    zoomPinchGestureRecognizer = self->__zoomPinchGestureRecognizer;
    self->__zoomPinchGestureRecognizer = &v3->super;

    [(UIPinchGestureRecognizer *)self->__zoomPinchGestureRecognizer setDelegate:self];
    view = [(CAMViewfinderViewController *)self view];
    [view addGestureRecognizer:self->__zoomPinchGestureRecognizer];
  }
}

- (void)_createSwipeToModeSwitchGestureRecognizersIfNecessary
{
  if (!self->__previousModeGestureRecognizer)
  {
    v3 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__swipedToPreviousCameraMode_];
    previousModeGestureRecognizer = self->__previousModeGestureRecognizer;
    self->__previousModeGestureRecognizer = v3;

    [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer setDelegate:self];
    view = [(CAMViewfinderViewController *)self view];
    [view addGestureRecognizer:self->__previousModeGestureRecognizer];
  }

  if (!self->__nextModeGestureRecognizer)
  {
    v6 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__swipedToNextCameraMode_];
    nextModeGestureRecognizer = self->__nextModeGestureRecognizer;
    self->__nextModeGestureRecognizer = v6;

    [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer setDelegate:self];
    view2 = [(CAMViewfinderViewController *)self view];
    [view2 addGestureRecognizer:self->__nextModeGestureRecognizer];
  }

  [(CAMViewfinderViewController *)self _configureSwipeToModeSwitchGestureRecognizersDirection];
}

- (void)_updateForCurrentConfiguration
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
  [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:_currentGraphConfiguration];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  [_topBar configureForMode:mode];
  _modeDial = [(CAMViewfinderViewController *)self _modeDial];
  [_modeDial reloadData];
  [_modeDial setSelectedMode:mode animated:0];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:0];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v7 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", mode, [_currentGraphConfiguration videoConfiguration], objc_msgSend(_currentGraphConfiguration, "devicePosition"), objc_msgSend(_currentGraphConfiguration, "trueVideoEnabled"));
  [viewfinderView setDesiredAspectRatio:v7];
  [viewfinderView setMaskingAspectRatio:v7];
  [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:0];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
  }

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:_currentGraphConfiguration2 animated:0];

  [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:0];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:_currentGraphConfiguration fromGraphConfiguration:_currentGraphConfiguration animated:0];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:_currentGraphConfiguration animated:0];
  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
  [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:[(CAMViewfinderViewController *)self _resolvedTimerDuration] animated:0];
  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
  }

  [(CAMViewfinderViewController *)self _updateHomeIndicatorBehaviorsForCaptureOrientation];
  [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:_currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:0];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration zoomFactor:?];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration zoomFactor:0 animated:?];
  [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration animated:0];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setViewportAspectRatio:v7 animated:0];
  photoModeAspectRatioCrop = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  aspectRatioButton = [_controlDrawer aspectRatioButton];
  [aspectRatioButton setAspectRatio:photoModeAspectRatioCrop];

  [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:_currentGraphConfiguration animated:0];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  [(CAMViewfinderViewController *)self _updateAutoMacroButton];
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:0];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:_currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:_currentGraphConfiguration animated:0];
  [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:_currentGraphConfiguration animated:0];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController willChangeToGraphConfiguration:_currentGraphConfiguration];
  [_previewViewController didChangeToGraphConfiguration:_currentGraphConfiguration animated:0];
}

- (int64_t)_currentMode
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];

  return mode;
}

- (void)_createStillImageControlsIfNecessary
{
  v4 = +[CAMCaptureCapabilities capabilities];
  isLivePhotoSupported = [v4 isLivePhotoSupported];
  if (isLivePhotoSupported)
  {
    [(CAMViewfinderViewController *)self _createLivePhotoBadgeIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createTimerIndicatorViewIfNecessary];
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {
    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  if (([v4 isBackBurstSupported] & 1) != 0 || objc_msgSend(v4, "isFrontBurstSupported"))
  {
    [(CAMViewfinderViewController *)self _createBurstIndicatorViewIfNecessary];
  }

  if (isLivePhotoSupported)
  {
    [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createQRCodeInstructionLabelIfNecessary];
}

- (void)_createTimerButtonIfNecessary
{
  if (!self->__timerButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:21])
  {
    v3 = [[CAMTimerButton alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    timerButton = self->__timerButton;
    self->__timerButton = v3;

    [(CAMTimerButton *)self->__timerButton addTarget:self action:sel__handleTimerButtonChangedTimerDuration forControlEvents:4096];
    [(CAMTimerButton *)self->__timerButton setDelegate:self];
    [(CAMTimerButton *)self->__timerButton setHideOffWhenCollapsed:1 needsReloadData:0];
    [(CAMTimerButton *)self->__timerButton reloadData];
    [(CAMTimerButton *)self->__timerButton setDuration:[(CAMViewfinderViewController *)self _resolvedTimerDuration]];
  }

  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];

  [(CAMViewfinderViewController *)self _embedTimerButtonWithLayoutStyle:_layoutStyle];
}

- (void)_createTimerIndicatorViewIfNecessary
{
  if (!self->__timerIndicatorView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:22])
  {
    v3 = objc_alloc_init(CAMTimerIndicatorView);
    timerIndicatorView = self->__timerIndicatorView;
    self->__timerIndicatorView = v3;

    v5 = [MEMORY[0x1E695DF00] dateWithTimeIntervalSinceReferenceDate:0.0];
    [(CAMViewfinderViewController *)self _setLastTimerIndicatorFaceUpdateDate:v5];
  }

  [(CAMViewfinderViewController *)self _embedTimerIndicatorView];
}

- (BOOL)_wantsHDRControlsVisible
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _wantsHDRControlsVisibleForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (void)_createHDRButtonIfNecessary
{
  if (!self->__HDRButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:6])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMHDRButton alloc] initWithLayoutStyle:_layoutStyle];
    HDRButton = self->__HDRButton;
    self->__HDRButton = v4;

    [(CAMHDRButton *)self->__HDRButton addTarget:self action:sel__handleHDRButtonChangedHDRMode forControlEvents:4096];
    [(CAMHDRButton *)self->__HDRButton setExclusiveTouch:1];
    [(CAMHDRButton *)self->__HDRButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedHDRButtonWithLayoutStyle:_layoutStyle];
  }
}

- (BOOL)_shouldUseZoomControlInsteadOfSlider
{
  v3 = +[CAMCaptureCapabilities capabilities];
  zoomControlSupported = [v3 zoomControlSupported];

  LOBYTE(v3) = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  return zoomControlSupported & (v3 ^ 1 | [(CAMViewfinderViewController *)self isShowingStandardControls]);
}

- (void)_createBurstIndicatorViewIfNecessary
{
  if (!self->__burstIndicatorView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:1])
  {
    v3 = [[CAMBurstIndicatorView alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    burstIndicatorView = self->__burstIndicatorView;
    self->__burstIndicatorView = v3;

    [(CAMBurstIndicatorView *)self->__burstIndicatorView setAlpha:0.0];

    [(CAMViewfinderViewController *)self _embedBurstIndicatorView];
  }
}

- (void)_updateFilterButtonOnState
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v4 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:_currentMode];
  v5 = v4 != [CAMUserPreferences defaultFilterTypeForMode:_currentMode];
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  filterButton = [_controlDrawer filterButton];
  [filterButton setOn:v5];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  filterIndicator = [controlStatusBar filterIndicator];
  [filterIndicator setOn:v5];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsFilterActive:v5];
}

- (void)_createQRCodeInstructionLabelIfNecessary
{
  if (!self->__qrCodeInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:16])
  {
    v3 = [CAMQRCodeInstructionLabel alloc];
    v4 = [(CAMInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    qrCodeInstructionLabel = self->__qrCodeInstructionLabel;
    self->__qrCodeInstructionLabel = v4;

    [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedQRCodeInstructionLabel];
  }
}

- (void)_updateQRCodeInstructionLabelForCurrentState
{
  _targetQRCodeInstructionLabel = [(CAMViewfinderViewController *)self _targetQRCodeInstructionLabel];
  v3 = [(CAMViewfinderViewController *)self _currentDevice]- 1;
  if (v3 > 0xA)
  {
    v4 = 0;
  }

  else
  {
    v4 = qword_1A3A685B0[v3];
  }

  [_targetQRCodeInstructionLabel setDevicePosition:v4];
  [_targetQRCodeInstructionLabel setMRCResults:MEMORY[0x1E695E0F0]];
}

- (int64_t)_currentDevice
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  device = [_currentGraphConfiguration device];

  return device;
}

- (void)_destroyGridViewIfNecessary
{
  if (self->__gridView)
  {
    [(CAMViewfinderViewController *)self _unembedGridView];
    gridView = self->__gridView;
    self->__gridView = 0;
  }
}

- (void)_createOrDestroyLevelViewIfNecessary
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMUserPreferences preferences];
  shouldShowLevelView = [v6 shouldShowLevelView];
  v5 = [(CAMViewfinderViewController *)self _shouldCreateLevelViewForMode:_currentMode];
  if (shouldShowLevelView)
  {
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createLevelViewIfNecessary];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _destroyLevelViewIfNecessary];
  }
}

- (void)_destroyLevelViewIfNecessary
{
  if (self->__levelView)
  {
    [(CAMViewfinderViewController *)self _unembedLevelView];
    levelView = self->__levelView;
    self->__levelView = 0;
  }
}

- (BOOL)_shouldEnableFlashButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableHDRButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableTimerButton
{
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isCapturingFromTimer || _isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableLivePhotoButton
{
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return ((_isModeDisabled | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableFlipButton
{
  selfCopy = self;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isConfigurationAvailable = [_captureController isConfigurationAvailable];
  LOBYTE(selfCopy) = ![(CAMViewfinderViewController *)selfCopy _isOutOfDiskSpace];

  return isConfigurationAvailable & selfCopy;
}

- (unint64_t)_reasonsToDisableShutterButton
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _isCurrentNightModeCaptureCancelable = 1;
  if (_currentMode <= 9 && ((1 << _currentMode) & 0x3D7) != 0)
  {
    if ([_captureController isCapturingNightModeImage])
    {
      _isCurrentNightModeCaptureCancelable = [(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable];
    }

    else
    {
      _isCurrentNightModeCaptureCancelable = [_captureController isCaptureAvailable];
    }
  }

  v29 = _isCurrentNightModeCaptureCancelable;
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  if ([_captureController isCapturingNightModeImage] && -[CAMViewfinderViewController _isCurrentNightModeCaptureCancelable](self, "_isCurrentNightModeCaptureCancelable"))
  {
    v7 = 1;
  }

  else
  {
    v7 = ![(CAMViewfinderViewController *)self isPreventingAdditionalCaptures];
  }

  v27 = v7;
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  isViewfinderClosed = [_closedViewfinderController isViewfinderClosed];
  _isOpeningViewfinder = [(CAMViewfinderViewController *)self _isOpeningViewfinder];
  _isClosingViewfinder = [(CAMViewfinderViewController *)self _isClosingViewfinder];
  isInterrupted = [_captureController isInterrupted];
  v12 = 0;
  v30 = _captureController;
  if ((isInterrupted & 1) == 0 && _isOpeningViewfinder)
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    if ([v13 allowCaptureWhileViewfinderIsOpeningForMode:_currentMode devicePosition:_currentDevicePosition])
    {
      v12 = 0;
    }

    else
    {
      v12 = ![(CAMViewfinderViewController *)self isEmulatingImagePicker];
    }
  }

  v14 = isViewfinderClosed | _isClosingViewfinder;
  v15 = isInterrupted ^ 1;
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  purgeableStorageContainer = [_storageController purgeableStorageContainer];
  isPurging = [purgeableStorageContainer isPurging];

  v20 = +[CAMCaptureCapabilities capabilities];
  v21 = [v20 isProResVideoSupportedForMode:_currentMode videoConfiguration:-[CAMViewfinderViewController _currentVideoConfiguration](self outputToExternalStorage:"_currentVideoConfiguration") frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  v22 = [(CAMViewfinderViewController *)self _desiredProResVideoMode]== 1;
  v23 = v29 ^ 1u;
  if (_isOutOfDiskSpace)
  {
    v23 |= 2uLL;
  }

  if ((v15 & v14) != 0)
  {
    v23 |= 4uLL;
  }

  if (v12)
  {
    v23 |= 0x40uLL;
  }

  if (!v27)
  {
    v23 |= 8uLL;
  }

  if (_isModeDisabled)
  {
    v23 |= 0x10uLL;
  }

  if ((isPurging & v21 & v22) != 0)
  {
    v24 = v23 | 0x80;
  }

  else
  {
    v24 = v23;
  }

  return v24;
}

- (BOOL)_shouldEnableFilterButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableModeDial
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isConfigurationAvailable = [_captureController isConfigurationAvailable];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];

  v8 = !_isCapturingFromTimer & ([(CAMViewfinderViewController *)self _layoutStyle]== 1 || v7);
  if (isConfigurationAvailable)
  {
    v9 = v8;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_shouldEnableZoomControl
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  v6 = ((_isOutOfDiskSpace || _isModeDisabled) | [_captureController isCapturingNightModeImage]) ^ 1;
  if ([(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice])
  {
    LOBYTE(v6) = v6 & [_captureController isConfigurationAvailable];
  }

  return v6 & 1;
}

- (BOOL)_shouldShowShutterButtonDisabled
{
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingNightModeImage])
  {
    v5 = ![(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable];
  }

  else
  {
    v5 = 0;
  }

  v6 = v5 | [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling];
  if (_isModeDisabled)
  {
    v7 = 1;
  }

  else
  {
    v7 = v6;
  }

  return v7 & 1;
}

- (BOOL)_shouldEnableSwipeToModeSwitch
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldHideModeDialForGraphConfiguration:_currentGraphConfiguration isCapturingBurst:0];

  LODWORD(_currentGraphConfiguration) = [(CAMViewfinderViewController *)self _shouldEnableModeDial];
  _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  return ((_currentGraphConfiguration ^ 1 | v4 | _isShowingFilterScrubber | isSemanticStyleControlVisible | isSmartStylePickerVisible | [(CAMViewfinderViewController *)self _trueVideoIsActive]) & 1) == 0;
}

- (CGAffineTransform)customPreviewViewTransform
{
  v3 = *&self[57].d;
  *&retstr->a = *&self[57].b;
  *&retstr->c = v3;
  *&retstr->tx = *&self[57].ty;
  return self;
}

- (BOOL)shouldHideLightingControl
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideLightingControlForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideFilterNameBadge
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideFilterNameBadgeForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (void)_updateHomeIndicatorBehaviorsForCaptureOrientation
{
  if ([(CAMViewfinderViewController *)self _layoutStyle]== 3)
  {
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    captureOrientation = [_motionController captureOrientation];
    mEMORY[0x1E69DC668] = [MEMORY[0x1E69DC668] sharedApplication];
    v5 = +[CAMCaptureCapabilities capabilities];
    if (([v5 hostProcess] | 4) == 4)
    {
      [mEMORY[0x1E69DC668] _setReachabilitySupported:(captureOrientation - 5) < 0xFFFFFFFFFFFFFFFELL];
    }

    [(CAMViewfinderViewController *)self _setHomeIndicatorAutoHideOrientation:captureOrientation];
  }
}

- (void)_updatePortraitModeInstructionLabelForCurrentState
{
  _targetPortraitModeInstructionLabel = [(CAMViewfinderViewController *)self _targetPortraitModeInstructionLabel];
  v3 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:[(CAMViewfinderViewController *)self _currentMode] flashActive:0];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isFlashOrTorchSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ([(CAMViewfinderViewController *)self _currentMode]== 1)
  {
    v5 = ([(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode]!= 1) & v5;
  }

  [_targetPortraitModeInstructionLabel setShallowDepthOfFieldStatus:{-[CAMViewfinderViewController _shallowDepthOfFieldStatus](self, "_shallowDepthOfFieldStatus")}];
  [_targetPortraitModeInstructionLabel setFlashSupported:v5];
  [_targetPortraitModeInstructionLabel setFlashMode:v3];
  v6 = [(CAMViewfinderViewController *)self _currentDevice]- 1;
  if (v6 > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[v6];
  }

  [_targetPortraitModeInstructionLabel setDevicePosition:v7];
  [_targetPortraitModeInstructionLabel setLightingType:{-[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice"))}];
  [_targetPortraitModeInstructionLabel setNightMode:{-[CAMViewfinderViewController _resolvedNightMode](self, "_resolvedNightMode")}];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_targetPortraitModeInstructionLabel setNightModeStatus:{objc_msgSend(_captureController, "nightModeStatus")}];

  v9 = +[CAMCaptureCapabilities capabilities];
  [_targetPortraitModeInstructionLabel setNightModePortraitSupported:{objc_msgSend(v9, "isNightModeWithDepthSupportedForMode:device:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice"))}];
}

- (BOOL)prefersHomeIndicatorAutoHidden
{
  _homeIndicatorAutoHideOrientation = [(CAMViewfinderViewController *)self _homeIndicatorAutoHideOrientation];

  return [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:_homeIndicatorAutoHideOrientation];
}

- (void)viewWillLayoutSubviews
{
  v3.receiver = self;
  v3.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v3 viewWillLayoutSubviews];
  [(CAMViewfinderViewController *)self _updateLayoutStyle];
  [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
}

- (BOOL)shouldShiftPreviewForUtilityBar
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (double)_currentMaximumZoomFactor
{
  v3 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [v3 maximumZoomFactorForMode:objc_msgSend(_currentGraphConfiguration device:"mode") videoConfiguration:objc_msgSend(_currentGraphConfiguration videoStabilizationStrength:{"device"), objc_msgSend(_currentGraphConfiguration, "videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength")}];
  v6 = v5;

  return v6;
}

- (void)_updateFlashButtonAvailability
{
  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v4 = [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:_currentGraphConfiguration];

    if (v4)
    {
      v5 = [(CAMViewfinderViewController *)self _isFlashUnavailableForMode:[(CAMViewfinderViewController *)self _currentMode]];
      _flashButton = [(CAMViewfinderViewController *)self _flashButton];
      [_flashButton setUnavailable:v5];

      _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
      flashButton = [_controlDrawer flashButton];
      [flashButton setFlashUnavailable:v5];

      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      controlStatusBar = [_fullscreenViewfinder controlStatusBar];
      flashIndicator = [controlStatusBar flashIndicator];
      [flashIndicator setFlashUnavailable:v5];

      chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      [chromeConfigurator setIsFlashCurrentlyUnavailable:{objc_msgSend(_captureController, "isFlashAvailable") ^ 1}];

      chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
      _captureController2 = [(CAMViewfinderViewController *)self _captureController];
      [chromeConfigurator2 setIsTorchCurrentlyUnavailable:{objc_msgSend(_captureController2, "isTorchAvailable") ^ 1}];
    }
  }
}

- (void)_openViewfinderForAllModeAndDeviceChangeReasons
{
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController removeClosedViewfinderReason:0];
  [_closedViewfinderController removeClosedViewfinderReason:1];
}

- (unint64_t)_shutterButtonFeedbackForCurrentConfiguration
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode > 9)
  {
    return 0;
  }

  if (((1 << _currentMode) & 0x1AE) != 0)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    if ([_captureController isCapturingTimelapse] & 1) != 0 || (objc_msgSend(_captureController, "isCapturingVideo"))
    {
      v5 = 2;
    }

    else if ([_captureController isCapturingPanorama])
    {
      v5 = 2;
    }

    else
    {
      v5 = 1;
    }
  }

  else if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    return 2;
  }

  else
  {
    return [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
  }

  return v5;
}

- (BOOL)_shouldCaptureWithTimer
{
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
  return (_resolvedTimerDuration != 0) & ~_isCapturingFromTimer & ![(CAMViewfinderViewController *)self isEmulatingImagePicker];
}

- (BOOL)_shouldReportUserInitiationTimeForCurrentSettings
{
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 hostProcess] & 0xFFFFFFFFFFFFFFFBLL;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    LOBYTE(v7) = 0;
  }

  else
  {
    v7 = ![(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
  }

  v8 = (isCapturingBurst ^ 1) & v7;
  if (v4)
  {
    v9 = 0;
  }

  else
  {
    v9 = v8;
  }

  return v9;
}

- (void)_teardownBurstTimer
{
  _currentBurstTimer = [(CAMViewfinderViewController *)self _currentBurstTimer];
  [_currentBurstTimer invalidate];
  [(CAMViewfinderViewController *)self _setCurrentBurstTimer:0];
}

- (BOOL)_captureStillImageWithCurrentSettings
{
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  v3 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
  v4 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v3 burst:0];
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID = [v3 persistenceUUID];
  [_analyticsEventsByIdentifier setObject:v4 forKey:persistenceUUID];

  v7 = [(CAMViewfinderViewController *)self _captureStillImageWithRequest:v3 error:0];
  if (v7)
  {
    [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
    stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [stillImageCaptureTestDelegate viewfinderViewController:self willCaptureStillImageForRequest:v3];

    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [_analyticsSessionEvent didCaptureWithRequest:v3 currentConfiguration:_currentGraphConfiguration];
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to capture still image capture"];
  }

  return v7;
}

- (int64_t)_currentCaptureRequestOrigin
{
  v2 = +[CAMCaptureCapabilities capabilities];
  v3 = ([v2 hostProcess] - 1) < 2;

  return v3;
}

- (void)_updateUserPreferencesForFilterUsage
{
  v4 = +[CAMUserPreferences preferences];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  switch(_currentMode)
  {
    case 6:
      [v4 setPortraitModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _portraitModeEffectFilterType](self, "_portraitModeEffectFilterType")}];
      break;
    case 4:
      [v4 setSquareModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _squareModeEffectFilterType](self, "_squareModeEffectFilterType")}];
      break;
    case 0:
      [v4 setPhotoModeLastCapturedEffectFilterType:{-[CAMViewfinderViewController _photoModeEffectFilterType](self, "_photoModeEffectFilterType")}];
      break;
  }

  MEMORY[0x1EEE66BB8]();
}

- (void)_updateFilterScrubberAfterCapture
{
  v3 = +[CAMCaptureCapabilities capabilities];
  isLiveFilteringSupported = [v3 isLiveFilteringSupported];

  if (isLiveFilteringSupported)
  {
    v5 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:[(CAMViewfinderViewController *)self _effectFilterTypeForMode:[(CAMViewfinderViewController *)self _currentMode]]];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setFiltersMarkedIndex:v5];
  }
}

- (BOOL)shouldHideElapsedTimeView
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _motionController = [(CAMViewfinderViewController *)selfCopy _motionController];
  LOBYTE(selfCopy) = -[CAMViewfinderViewController _shouldHideElapsedTimeViewForGraphConfiguration:orientation:](selfCopy, "_shouldHideElapsedTimeViewForGraphConfiguration:orientation:", _currentGraphConfiguration, [_motionController captureOrientation]);

  return selfCopy;
}

- (BOOL)shouldHideTopBar
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideTopBarForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHidePortraitModeInstructionLabel
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHidePortraitModeInstructionLabelForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideQRCodeInstructionLabel
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideQRCodeInstructionLabelForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (void)_writeUserPreferences
{
  if (![(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v53 = +[CAMUserPreferences preferences];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    mode = [_currentGraphConfiguration mode];
    device = [_currentGraphConfiguration device];
    v52 = _currentGraphConfiguration;
    videoConfiguration = [_currentGraphConfiguration videoConfiguration];
    _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
    _desiredTorchMode = [(CAMViewfinderViewController *)self _desiredTorchMode];
    _resolvedHDRMode = [(CAMViewfinderViewController *)self _resolvedHDRMode];
    _desiredLivePhotoMode = [(CAMViewfinderViewController *)self _desiredLivePhotoMode];
    _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
    _photoModeEffectFilterType = [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
    _squareModeEffectFilterType = [(CAMViewfinderViewController *)self _squareModeEffectFilterType];
    _portraitModeEffectFilterType = [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
    _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
    isCallActive = [_callStatusMonitor isCallActive];

    v49 = device;
    v40 = [v53 audioConfigurationForMode:mode device:device emulationMode:-[CAMViewfinderViewController emulationMode](self duringCall:{"emulationMode"), isCallActive}];
    v39 = mode;
    if ([v53 shouldMirrorFrontCameraCaptures])
    {
      v8 = +[CAMCaptureCapabilities capabilities];
      v37 = [v8 mirroredFrontCapturesSupportedForMode:mode];
    }

    else
    {
      v37 = 0;
    }

    v36 = [CAMCaptureConfiguration alloc];
    shouldMixAudioWithOthers = [v53 shouldMixAudioWithOthers];
    photoModeAspectRatioCrop = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
    portraitModeLightingEffectType = [(CAMViewfinderViewController *)self portraitModeLightingEffectType];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v10 = v9;
    [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
    v12 = v11;
    _exposureBiasesByMode = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
    _resolvedMacroMode = [(CAMViewfinderViewController *)self _resolvedMacroMode];
    _resolvedPhotoResolution = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
    _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
    _desiredProResVideoMode = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
    _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    _smartStyleSystemStyleIndex = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    _desiredVideoStabilizationMode = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
    isZoomPIPEnabled = [v53 isZoomPIPEnabled];
    _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    sharedLibraryMode = [_librarySelectionController sharedLibraryMode];
    LOBYTE(v29) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
    BYTE1(v28) = _depthEffectEnabledFromSuggestion;
    LOBYTE(v28) = isZoomPIPEnabled;
    LOBYTE(v27) = v37;
    v50 = [(CAMCaptureConfiguration *)v36 initWithCaptureMode:v39 captureDevice:v49 videoConfiguration:videoConfiguration audioConfiguration:v40 mixAudioWithOthers:shouldMixAudioWithOthers flashMode:_resolvedFlashMode torchMode:v10 HDRMode:v12 irisMode:_desiredTorchMode timerDuration:_resolvedHDRMode photoModeAspectRatioCrop:_desiredLivePhotoMode photoModeEffectFilterType:_resolvedTimerDuration squareModeEffectFilterType:photoModeAspectRatioCrop portraitModeEffectFilterType:_photoModeEffectFilterType portraitModeLightingEffectType:_squareModeEffectFilterType portraitModeApertureValue:_portraitModeEffectFilterType portraitModeIntensityValue:portraitModeLightingEffectType mirrorFrontCameraCaptures:v27 exposureBiasesByMode:_exposureBiasesByMode macroMode:_resolvedMacroMode photoResolution:_resolvedPhotoResolution rawMode:_resolvedRAWMode proResVideoMode:_desiredProResVideoMode semanticStyles:_semanticStyles selectedSemanticStyleIndex:_selectedSemanticStyleIndex smartStyleSystemStyleIndex:_smartStyleSystemStyleIndex videoStabilizationMode:_desiredVideoStabilizationMode zoomPIPEnabled:v28 optionalDepthEffectEnabled:sharedLibraryMode sharedLibraryMode:v29 frontRearSimultaneousVideoEnabled:?];

    v22 = [[CAMConflictingControlConfiguration alloc] initWithDesiredFlashMode:[(CAMViewfinderViewController *)self _desiredFlashMode] desiredHDRMode:[(CAMViewfinderViewController *)self _desiredHDRMode] desiredLivePhotoMode:_desiredLivePhotoMode desiredRAWMode:[(CAMViewfinderViewController *)self _desiredRAWMode] desiredPhotoResolution:[(CAMViewfinderViewController *)self _desiredPhotoResolution] photoFormatConflicts:[(CAMViewfinderViewController *)self _photoFormatConflicts] desiredNightModeControlMode:[(CAMViewfinderViewController *)self _desiredNightModeControlMode] nightModeConflicts:[(CAMViewfinderViewController *)self _nightModeConflicts] desiredMacroMode:[(CAMViewfinderViewController *)self _desiredMacroMode]];
    [v53 setCaptureConfiguration:v50];
    [v53 setConflictingControlConfiguration:v22];
    _openHalfPressSpotlightControls = [(CAMViewfinderViewController *)self _openHalfPressSpotlightControls];
    if (_openHalfPressSpotlightControls)
    {
      [v53 setOpenHalfPressSpotlightControls:_openHalfPressSpotlightControls];
    }

    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];

    if (_controlDrawer)
    {
      _preferredControlToOpenInDrawerForMode = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
      v26 = [_preferredControlToOpenInDrawerForMode copy];
      [v53 setPreferredDrawerControlByMode:v26];
    }

    [v53 setWantsSmartFramingAutoZoomDefault:{-[CAMViewfinderViewController _wantsSmartFramingAutoZoomDefault](self, "_wantsSmartFramingAutoZoomDefault")}];
    [v53 setWantsSmartFramingAutoRotationDefault:{-[CAMViewfinderViewController _wantsSmartFramingAutoRotationDefault](self, "_wantsSmartFramingAutoRotationDefault")}];
    [v53 writePreferences];
  }
}

- (void)_updatePanoramaViewVisibilityForViewfinderTransition
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldHidePanoramaViewForGraphConfiguration:_currentGraphConfiguration];
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  v6 = MEMORY[0x1E69DD250];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __83__CAMViewfinderViewController__updatePanoramaViewVisibilityForViewfinderTransition__block_invoke;
  v8[3] = &unk_1E76F7850;
  v9 = _panoramaViewController;
  v10 = v4;
  v7 = _panoramaViewController;
  [v6 animateWithDuration:v8 animations:0.25];
}

- (void)_ensureSensitiveContentHidden
{
  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  [_imageWell setThumbnailImage:0 uuid:0 animated:0];

  [(CAMViewfinderViewController *)self setPresentedImageWellImage:0];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator removeThumbnailImage];

  _viewfinderTransitionable = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [_viewfinderTransitionable removeInflightBlurAnimations];
}

- (CAMViewfinderViewController)initWithCaptureController:(id)controller captureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration locationController:(id)locationController motionController:(id)motionController timelapseController:(id)timelapseController keepAliveController:(id)aliveController remoteShutterController:(id)self0 powerController:(id)self1 cameraRollController:(id)self2 librarySelectionController:(id)self3 callStatusMonitor:(id)self4 storageController:(id)self5 usingEmulationMode:(int64_t)self6 initialLayoutStyle:(int64_t)self7 options:(int64_t)self8
{
  controllerCopy = controller;
  configurationCopy = configuration;
  controlConfigurationCopy = controlConfiguration;
  locationControllerCopy = locationController;
  motionControllerCopy = motionController;
  timelapseControllerCopy = timelapseController;
  timelapseControllerCopy2 = timelapseController;
  aliveControllerCopy = aliveController;
  shutterControllerCopy = shutterController;
  powerControllerCopy = powerController;
  rollControllerCopy = rollController;
  selectionControllerCopy = selectionController;
  monitorCopy = monitor;
  storageControllerCopy = storageController;
  v111.receiver = self;
  v111.super_class = CAMViewfinderViewController;
  v25 = [(CAMViewfinderViewController *)&v111 initWithNibName:0 bundle:0];
  v26 = v25;
  if (v25)
  {
    v97 = controlConfigurationCopy;
    v100 = configurationCopy;
    v25->_options = options;
    _supportedCaptureModes = [(CAMViewfinderViewController *)v25 _supportedCaptureModes];
    availableCaptureModes = v26->_availableCaptureModes;
    v26->_availableCaptureModes = _supportedCaptureModes;

    [(CAMViewfinderViewController *)v26 _updateDuetSystemConstraintsIfNecessary];
    v29 = +[CAMCaptureCapabilities capabilities];
    v26->__layoutStyle = style;
    v26->__useMessagesControls = options & 1;
    v26->__currentlyPressedButton = -1;
    objc_storeStrong(&v26->__captureController, controller);
    objc_storeStrong(&v26->__locationController, locationController);
    objc_storeStrong(&v26->__motionController, motionController);
    objc_storeStrong(&v26->__timelapseController, timelapseControllerCopy);
    objc_storeStrong(&v26->__keepAliveController, aliveController);
    objc_storeStrong(&v26->__remoteShutterController, shutterController);
    objc_storeStrong(&v26->__powerController, powerController);
    objc_storeStrong(&v26->__cameraRollController, rollController);
    objc_storeStrong(&v26->__callStatusMonitor, monitor);
    objc_storeStrong(&v26->__storageController, storageController);
    [(CAMStorageController *)v26->__storageController setDelegate:v26];
    v30 = [[CAMPreviewViewController alloc] initWithCaptureController:controllerCopy motionController:motionControllerCopy timelapseController:timelapseControllerCopy2];
    previewViewController = v26->__previewViewController;
    v26->__previewViewController = v30;

    [(CAMPreviewViewController *)v26->__previewViewController setDelegate:v26];
    [(CAMPreviewViewController *)v26->__previewViewController setLayoutStyle:style];
    [(CAMViewfinderViewController *)v26 addChildViewController:v26->__previewViewController];
    v32 = objc_alloc_init(CAMViewfinderTransitionController);
    transitionController = v26->__transitionController;
    v26->__transitionController = v32;

    v34 = [[CAMTorchPatternController alloc] initWithCaptureController:controllerCopy];
    torchPatternController = v26->__torchPatternController;
    v26->__torchPatternController = v34;

    [(CAMCameraRollController *)v26->__cameraRollController setImageWellDelegate:v26];
    [(CAMCameraRollController *)v26->__cameraRollController setSessionDelegate:v26];
    [(CAMCameraRollController *)v26->__cameraRollController setPresentationDelegate:v26];
    v36 = objc_alloc_init(CAMIdleController);
    idleController = v26->__idleController;
    v26->__idleController = v36;

    v38 = objc_alloc_init(CAMClosedViewfinderController);
    closedViewfinderController = v26->__closedViewfinderController;
    v26->__closedViewfinderController = v38;

    [(CAMClosedViewfinderController *)v26->__closedViewfinderController setDelegate:v26];
    v40 = objc_alloc_init(CAMDisabledPreviewController);
    disabledPreviewController = v26->__disabledPreviewController;
    v26->__disabledPreviewController = v40;

    [(CAMDisabledPreviewController *)v26->__disabledPreviewController setDelegate:v26];
    if ([v29 librarySelectionSupported])
    {
      objc_storeStrong(&v26->__librarySelectionController, selectionController);
      [(CAMLibrarySelectionController *)v26->__librarySelectionController setDelegate:v26];
    }

    v42 = objc_alloc_init(MEMORY[0x1E695DF90]);
    preferredControlToOpenInDrawerForMode = v26->__preferredControlToOpenInDrawerForMode;
    v26->__preferredControlToOpenInDrawerForMode = v42;

    v26->_emulationMode = mode;
    v26->_showingStandardControls = 1;
    v26->_maximumVideoRecordingDuration = 0.0;
    customOverlayView = v26->_customOverlayView;
    v26->_customOverlayView = 0;

    v45 = MEMORY[0x1E695EFD0];
    v46 = *(MEMORY[0x1E695EFD0] + 16);
    *&v26->_customPreviewViewTransform.a = *MEMORY[0x1E695EFD0];
    *&v26->_customPreviewViewTransform.c = v46;
    *&v26->_customPreviewViewTransform.tx = *(v45 + 32);
    v47 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", v100, -[CAMViewfinderViewController _externalStorageOutputEnabled](v26, "_externalStorageOutputEnabled"), [motionControllerCopy captureOrientation]);
    [(CAMViewfinderViewController *)v26 _createChromeConfiguratorWithGraphConfiguration:v47];
    chromeConfigurator = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v49 = +[CAMCaptureCapabilities capabilities];
    [v49 minimumPortraitEffectIntensity];
    [chromeConfigurator setPortraitEffectIntensityMinimum:?];

    chromeConfigurator2 = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v51 = +[CAMCaptureCapabilities capabilities];
    [v51 maximumPortraitEffectIntensity];
    [chromeConfigurator2 setPortraitEffectIntensityMaximum:?];

    chromeConfigurator3 = [(CAMViewfinderViewController *)v26 chromeConfigurator];
    v53 = +[CAMCaptureCapabilities capabilities];
    [v53 defaultPortraitEffectIntensity];
    [chromeConfigurator3 setPortraitEffectIntensityDefault:?];

    [(CAMPreviewViewController *)v26->__previewViewController setChromeConfigurator:v26->_chromeConfigurator];
    [(CAMViewfinderViewController *)v26 _updatePropertiesForCaptureConfiguration:v100 conflictingControlConfiguration:v97];
    objc_storeStrong(&v26->__configuredGraphConfiguration, v47);
    v26->__lastConfigurationRequestID = -1;
    v26->__stereoCaptureStatus = 1;
    [v29 zoomEventReportingInterval];
    v55 = -[CAMZoomEventReporter initWithRateLimit:reportingAllEvents:]([CAMZoomEventReporter alloc], "initWithRateLimit:reportingAllEvents:", [v29 zoomEventReportAllChanges], v54);
    zoomReporter = v26->__zoomReporter;
    v26->__zoomReporter = v55;

    [controllerCopy setFacesDelegate:v26];
    [controllerCopy setMachineReadableCodeDelegate:v26];
    [controllerCopy setHistogramDelegate:v26];
    [controllerCopy setTextRegionResultDelegate:v26];
    [controllerCopy setDocumentSceneResultDelegate:v26];
    [controllerCopy setConfigurationDelegate:v26];
    [controllerCopy setSuggestionDelegate:v26];
    [controllerCopy setAvailabilityDelegate:v26];
    [controllerCopy setBurstDelegate:v26];
    [controllerCopy setRecoveryDelegate:v26];
    [controllerCopy setInterruptionDelegate:v26];
    [controllerCopy setRunningDelegate:v26];
    [controllerCopy setZoomDelegate:v26];
    [controllerCopy setControlsDelegate:v26];
    [controllerCopy setStillImageCapturingVideoDelegate:v26];
    [controllerCopy setPreviewLayerOverCaptureStatusDelegate:v26];
    [controllerCopy setSystemPressureStateDelegate:v26];
    [controllerCopy setAudioCuePlaybackDelegate:v26];
    [controllerCopy setStereoCaptureStatusDelegate:v26];
    [controllerCopy setLensPositionDelegate:v26];
    [controllerCopy setLensSmudgeStatusDelegate:v26];
    [controllerCopy setConstituentDeviceDelegate:v26];
    [controllerCopy setRecommendedSmartFramingDelegate:v26];
    v26->__shallowDepthOfFieldStatus = 0;
    [controllerCopy setShallowDepthOfFieldStatusDelegate:v26];
    if ([v29 isLiveFilteringSupported])
    {
      [controllerCopy registerVideoThumbnailContentsDelegate:v26];
    }

    v57 = +[CAMPriorityNotificationCenter defaultCenter];
    [v57 addObserver:v26 selector:sel__previewDidStartRunning_ name:*MEMORY[0x1E6986B70] object:0];
    [v57 addObserver:v26 selector:sel__captureOrientationChanged_ name:@"CAMMotionControllerCaptureOrientationChangedNotification" object:0];
    [v57 addObserver:v26 selector:sel__deviceOrientationChanged_ name:@"CAMMotionControllerCaptureDeviceOrientationChangedNotification" object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidBecomeActive_ name:*MEMORY[0x1E69DDAB0] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillResignActive_ name:*MEMORY[0x1E69DDBC8] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillAddDeactivationReason_ name:*MEMORY[0x1E69DE878] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidRemoveDeactivationReason_ name:*MEMORY[0x1E69DE840] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationWillEnterForeground_ name:*MEMORY[0x1E69DDBC0] object:0];
    [v57 addObserver:v26 selector:sel__handleApplicationDidEnterBackground_ name:*MEMORY[0x1E69DDAC8] object:0];
    [v57 addObserver:v26 selector:sel__handleSceneDidEnterBackground_ name:*MEMORY[0x1E69DE348] object:0];
    [v57 addObserver:v26 selector:sel__handleContentSizeCategoryDidChange_ name:*MEMORY[0x1E69DDC48] object:0];
    [v57 addObserver:v26 selector:sel__handleCallStatusMonitorDidChangeCallActive_ name:@"CAMCallStatusMonitorDidChangeCallActiveNotification" object:0];
    [v57 addObserver:v26 selector:sel__handleTimelapseLowDiskSpaceNotification_ name:@"CAMTimelapseLowDiskSpaceNotification" object:0];
    defaultCenter = [MEMORY[0x1E696AD88] defaultCenter];
    [defaultCenter addObserver:v26 selector:sel__handleSessionWasPrewarmed_ name:@"AVCaptureSessionWasPrewarmedNotification" object:0];
    v26->__overCapturePreviewStatus = 0;
    v58 = 3;
    if (!mode)
    {
      v58 = 0;
    }

    v26->_persistenceBehavior = v58;
    v59 = 1;
    if (!mode)
    {
      v59 = [v29 multipleCaptureFeaturesSupported] ^ 1;
    }

    v26->_disablingMultipleCaptureFeatures = v59;
    v26->__internalAutorotationStyle = [(CAMViewfinderViewController *)v26 _autorotationStyleForLayoutStyle:*(&v26->super.super.super.isa + v93)];
    v26->_automaticallyAdjustsAutorotationStyle = mode == 0;
    v26->_automaticallyAdjustsApplicationIdleTimer = 1;
    _supportedCaptureModes2 = [(CAMViewfinderViewController *)v26 _supportedCaptureModes];
    v61 = v26->_availableCaptureModes;
    v26->_availableCaptureModes = _supportedCaptureModes2;

    v62 = objc_alloc_init(CAMMachineReadableCodeLoggingController);
    machineReadableCodeLoggingController = v26->__machineReadableCodeLoggingController;
    v26->__machineReadableCodeLoggingController = v62;

    if ([v29 isImageAnalysisSupported])
    {
      v64 = objc_alloc_init(CAMProminentObjectManager);
      prominentObjectManager = v26->__prominentObjectManager;
      v26->__prominentObjectManager = v64;

      [(CAMProminentObjectManager *)v26->__prominentObjectManager setDelegate:v26];
    }

    if ([v29 allowHaptics])
    {
      v66 = +[CAMFeedbackController sharedController];
      feedbackController = v26->__feedbackController;
      v26->__feedbackController = v66;
    }

    v68 = objc_alloc_init(MEMORY[0x1E695DF90]);
    descriptionOverlayViewByMode = v26->__descriptionOverlayViewByMode;
    v26->__descriptionOverlayViewByMode = v68;

    v70 = objc_alloc_init(CAMTimerCache);
    timerCache = v26->__timerCache;
    v26->__timerCache = v70;

    [(CAMTimerCache *)v26->__timerCache setDelegate:v26];
    [(CAMViewfinderViewController *)v26 setOverrideUserInterfaceStyle:2];
    [(CAMViewfinderViewController *)v26 generateAnalyticsSessionEventIfNeeded];
    if ([v29 externalStorageSupported])
    {
      v72 = objc_alloc_init(CAMExternalStorageMonitor);
      storageMonitor = v26->__storageMonitor;
      v26->__storageMonitor = v72;

      _storageMonitor = [(CAMViewfinderViewController *)v26 _storageMonitor];
      [_storageMonitor setDelegate:v26];
    }

    if ([v29 shouldPreventConnectionHandover])
    {
      v75 = objc_alloc_init(CAMPreventConnectionHandoverAssertionController);
      preventConnectionHandoverAssertionController = v26->__preventConnectionHandoverAssertionController;
      v26->__preventConnectionHandoverAssertionController = v75;
    }

    v77 = [CAMLensSmudgeDisplayState alloc];
    v78 = +[CAMCaptureCapabilities capabilities];
    smudgeDetectionAutoDismissTimeoutSeconds = [v78 smudgeDetectionAutoDismissTimeoutSeconds];
    v80 = +[CAMUserPreferences preferences];
    v81 = [(CAMLensSmudgeDisplayState *)v77 initWithDelegate:v26 devicePosition:1 displayDuration:v80 preferences:smudgeDetectionAutoDismissTimeoutSeconds];
    lensSmudgeDisplayFrontState = v26->__lensSmudgeDisplayFrontState;
    v26->__lensSmudgeDisplayFrontState = v81;

    v83 = [CAMLensSmudgeDisplayState alloc];
    v84 = +[CAMCaptureCapabilities capabilities];
    smudgeDetectionAutoDismissTimeoutSeconds2 = [v84 smudgeDetectionAutoDismissTimeoutSeconds];
    v86 = +[CAMUserPreferences preferences];
    v87 = [(CAMLensSmudgeDisplayState *)v83 initWithDelegate:v26 devicePosition:0 displayDuration:v86 preferences:smudgeDetectionAutoDismissTimeoutSeconds2];
    lensSmudgeDisplayBackState = v26->__lensSmudgeDisplayBackState;
    v26->__lensSmudgeDisplayBackState = v87;

    v26->__smartFramingAutoZoomEnabled = 1;
    v26->__smartFramingAutoRotationEnabled = 1;
    v26->__frontRearSimultaneousVideoPIPAnchor = +[CAMPIPVideoPreviewView defaultAnchor];
    v89 = objc_alloc_init(MEMORY[0x1E695DF90]);
    analyticsEventsByIdentifier = v26->__analyticsEventsByIdentifier;
    v26->__analyticsEventsByIdentifier = v89;

    v91 = v26;
    configurationCopy = v100;
    controlConfigurationCopy = v97;
  }

  return v26;
}

- (void)dealloc
{
  v3 = +[CAMPriorityNotificationCenter defaultCenter];
  [v3 removeObserver:self];

  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:0];
  [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:0];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController invalidateController];

  v5.receiver = self;
  v5.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v5 dealloc];
}

- (int64_t)_currentDevicePosition
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  devicePosition = [_currentGraphConfiguration devicePosition];

  return devicePosition;
}

- (int64_t)_currentVideoConfiguration
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];

  return videoConfiguration;
}

- (int64_t)_configuredMode
{
  _configuredGraphConfiguration = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  mode = [_configuredGraphConfiguration mode];

  return mode;
}

- (int64_t)_configuredDevice
{
  _configuredGraphConfiguration = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  device = [_configuredGraphConfiguration device];

  return device;
}

- (void)_setCurrentGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if (self->__currentGraphConfiguration != configurationCopy)
  {
    v8 = configurationCopy;
    objc_storeStrong(&self->__currentGraphConfiguration, configuration);
    _storageController = [(CAMViewfinderViewController *)self _storageController];
    [_storageController setGraphConfiguration:v8];

    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController setCurrentGraphConfiguration:v8];

    configurationCopy = [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:v8];
  }

  MEMORY[0x1EEE66BE0](configurationCopy);
}

- (void)_updateChromeConfiguratorForCurrentGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if (([configurationCopy videoStabilizationStrength] & 0xFFFFFFFFFFFFFFFELL) == 2)
  {
    v5 = +[CAMUserPreferences preferences];
    [v5 setDidRecentlyUseActionMode];
  }

  [(CAMViewfinderViewController *)self _updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:configurationCopy];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __85__CAMViewfinderViewController__updateChromeConfiguratorForCurrentGraphConfiguration___block_invoke;
  v8[3] = &unk_1E76F7960;
  v8[4] = self;
  v9 = configurationCopy;
  v7 = configurationCopy;
  [chromeConfigurator performChanges:v8];
}

void __85__CAMViewfinderViewController__updateChromeConfiguratorForCurrentGraphConfiguration___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _updateChromePhotoFormatsAndResolutions];
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setCaptureGraphConfiguration:v2];

  v4 = *(a1 + 32);
  v5 = [v4 _currentGraphConfiguration];
  v6 = [v4 _shouldShowSmartFramingAutoZoomForGraphConfiguration:v5];
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setIsSmartFramingAutoZoomSupported:v6];

  v8 = *(a1 + 32);
  v9 = [v8 _currentGraphConfiguration];
  v10 = [v8 _shouldShowSmartFramingAutoRotationForGraphConfiguration:v9];
  v11 = [*(a1 + 32) chromeConfigurator];
  [v11 setIsSmartFramingAutoRotationSupported:v10];

  v12 = +[CAMCaptureCapabilities capabilities];
  v13 = [v12 isLensPositionControlSupportedForMode:objc_msgSend(*(a1 + 40) device:"mode") videoConfiguration:objc_msgSend(*(a1 + 40) videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:{objc_msgSend(*(a1 + 40), "videoConfiguration"), objc_msgSend(*(a1 + 40), "videoStabilizationStrength"), objc_msgSend(*(a1 + 40), "frontRearSimultaneousVideoEnabled")}];
  v14 = [*(a1 + 32) chromeConfigurator];
  [v14 setIsLensPositionSupported:v13];

  v15 = +[CAMUserPreferences preferences];
  v16 = [v15 preserveExposure];
  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setPreserveExposure:v16];

  v18 = [*(a1 + 32) _captureController];
  [v18 lastObservedLensPosition];
  v20 = v19;
  v21 = [*(a1 + 32) chromeConfigurator];
  [v21 setLensPosition:v20];

  v22 = [*(a1 + 32) _aspectRatioCropForMode:objc_msgSend(*(a1 + 40) devicePosition:{"mode"), objc_msgSend(*(a1 + 40), "devicePosition")}];
  v23 = [*(a1 + 32) chromeConfigurator];
  [v23 setAspectRatioCrop:v22];

  v26 = +[CAMCaptureCapabilities capabilities];
  v24 = [v26 isNightModeSupportedForMode:objc_msgSend(*(a1 + 40) device:{"mode"), objc_msgSend(*(a1 + 40), "device")}];
  v25 = [*(a1 + 32) chromeConfigurator];
  [v25 setIsNightModeSupported:v24];
}

- (void)_updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration:(id)configuration
{
  v59 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  v6 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v53 = 0u;
  v54 = 0u;
  v55 = 0u;
  v56 = 0u;
  v7 = [&unk_1F16C92A8 countByEnumeratingWithState:&v53 objects:v58 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v54;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v54 != v9)
        {
          objc_enumerationMutation(&unk_1F16C92A8);
        }

        v11 = *(*(&v53 + 1) + 8 * i);
        if (-[CAMViewfinderViewController shouldSwitchToVideoConfiguration:videoEncodingBehavior:](self, "shouldSwitchToVideoConfiguration:videoEncodingBehavior:", [v11 intValue], videoEncodingBehavior))
        {
          [v6 addIndex:{objc_msgSend(v11, "integerValue")}];
        }
      }

      v8 = [&unk_1F16C92A8 countByEnumeratingWithState:&v53 objects:v58 count:16];
    }

    while (v8);
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setSupportedVideoConfigurationRawValues:v6];

  v13 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v14 = +[CAMUserPreferences preferences];
  v15 = [v14 videoEncodingBehaviorForConfiguration:0 mode:objc_msgSend(configurationCopy desiredProResVideoMode:"mode") outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:{0, objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];

  if (v15 <= 2)
  {
    [v13 addObject:qword_1E76F9DF8[v15]];
  }

  v16 = +[CAMUserPreferences preferences];
  allowExplicitProResColorSpace = [v16 allowExplicitProResColorSpace];

  if (allowExplicitProResColorSpace)
  {
    v18 = +[CAMCaptureCapabilities capabilities];
    supportedProResColorSpaces = [v18 supportedProResColorSpaces];

    if ([supportedProResColorSpaces containsObject:&unk_1F16C7628])
    {
      [v13 addObject:&unk_1F16C7640];
    }

    if ([supportedProResColorSpaces containsObject:&unk_1F16C7610])
    {
      [v13 addObject:&unk_1F16C7628];
    }

    if (([supportedProResColorSpaces containsObject:&unk_1F16C7748] & 1) != 0 || objc_msgSend(supportedProResColorSpaces, "containsObject:", &unk_1F16C75F8))
    {
      v20 = &unk_1F16C7610;
LABEL_25:
      v50 = supportedProResColorSpaces;
      [v13 addObject:v20];
      goto LABEL_27;
    }
  }

  else
  {
    v21 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", [configurationCopy mode], objc_msgSend(configurationCopy, "videoConfiguration"), objc_msgSend(configurationCopy, "videoEncodingBehavior"), objc_msgSend(configurationCopy, "device"));
    v22 = [MEMORY[0x1E696AD98] numberWithInteger:v21];
    v57 = v22;
    supportedProResColorSpaces = [MEMORY[0x1E695DEC8] arrayWithObjects:&v57 count:1];

    if (([supportedProResColorSpaces containsObject:&unk_1F16C7748] & 1) != 0 || objc_msgSend(supportedProResColorSpaces, "containsObject:", &unk_1F16C75F8))
    {
      [v13 addObject:&unk_1F16C7610];
    }

    if ([supportedProResColorSpaces containsObject:&unk_1F16C7610])
    {
      v20 = &unk_1F16C7628;
      goto LABEL_25;
    }
  }

  v50 = supportedProResColorSpaces;
LABEL_27:
  chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v51 = v13;
  [chromeConfigurator2 setSupportedVideoFormatsRawValues:v13];

  v24 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:configurationCopy];
  chromeConfigurator3 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator3 setIsProResControlEnabled:v24];

  _currentVideoChromeVideoFormat = [(CAMViewfinderViewController *)self _currentVideoChromeVideoFormat];
  chromeConfigurator4 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator4 setVideoFormat:_currentVideoChromeVideoFormat];

  v28 = -[CAMViewfinderViewController _sanitizedVideoConfigurationForMode:device:allowOverrides:](self, "_sanitizedVideoConfigurationForMode:device:allowOverrides:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition") == 1, 0);
  v29 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoEncodingBehavior2 = [configurationCopy videoEncodingBehavior];
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
  LOBYTE(v49) = [configurationCopy frontRearSimultaneousVideoEnabled];
  v35 = [v29 resolvedVideoConfigurationForMode:mode device:device videoEncodingBehavior:videoEncodingBehavior2 videoConfiguration:v28 outputToExternalStorage:_externalStorageOutputEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v49];

  chromeConfigurator5 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator5 setCurrentDefaultVideoConfiguration:v35];

  _desiredProResVideoMode = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
  v38 = +[CAMUserPreferences preferences];
  v39 = [v38 videoEncodingBehaviorForConfiguration:v35 mode:objc_msgSend(configurationCopy desiredProResVideoMode:"mode") outputToExternalStorage:_desiredProResVideoMode frontRearSimultaneousVideoEnabled:{0, objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];

  chromeConfigurator6 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v52[0] = MEMORY[0x1E69E9820];
  v52[1] = 3221225472;
  v52[2] = __107__CAMViewfinderViewController__updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration___block_invoke;
  v52[3] = &unk_1E76F7A38;
  v52[4] = self;
  v52[5] = v39;
  [chromeConfigurator6 performChanges:v52];

  v41 = +[CAMUserPreferences preferences];
  alwaysShowActionModeIndicator = [v41 alwaysShowActionModeIndicator];
  if (alwaysShowActionModeIndicator)
  {
    didRecentlyUseActionMode = 1;
  }

  else
  {
    mode = +[CAMUserPreferences preferences];
    didRecentlyUseActionMode = [mode didRecentlyUseActionMode];
  }

  chromeConfigurator7 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator7 setShowActionModeIndicator:didRecentlyUseActionMode];

  if ((alwaysShowActionModeIndicator & 1) == 0)
  {
  }

  v45 = +[CAMUserPreferences preferences];
  alwaysShowFrontPIPIndicator = [v45 alwaysShowFrontPIPIndicator];
  if (alwaysShowFrontPIPIndicator)
  {
    didRecentlyUseFrontPIP = 1;
  }

  else
  {
    mode = +[CAMUserPreferences preferences];
    didRecentlyUseFrontPIP = [mode didRecentlyUseFrontPIP];
  }

  chromeConfigurator8 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator8 setShowFrontPIPIndicator:didRecentlyUseFrontPIP];

  if ((alwaysShowFrontPIPIndicator & 1) == 0)
  {
  }
}

void __107__CAMViewfinderViewController__updateViewModelAvailableVideoFrameRatesAndResolutionsforGraphConfiguration___block_invoke(uint64_t a1)
{
  v2 = +[CAMUserPreferences preferences];
  v3 = [v2 explicitProResColorSpace];
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setExplicitProResColorSpace:v3];

  v5 = *(a1 + 40);
  v6 = [*(a1 + 32) chromeConfigurator];
  [v6 setCurrentDefaultVideoEncodingBehavior:v5];
}

- (int64_t)_currentVideoChromeVideoFormat
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoEncodingBehavior = [_currentGraphConfiguration videoEncodingBehavior];

  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration2 videoConfiguration];
  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", _currentMode, videoConfiguration, videoEncodingBehavior, [_currentGraphConfiguration3 device]);

  if (videoEncodingBehavior != 2)
  {
    return videoEncodingBehavior == 1;
  }

  if (v9 > 3)
  {
    return 0;
  }

  return qword_1A3A68330[v9];
}

- (void)_updatePropertiesForCaptureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration
{
  configurationCopy = configuration;
  controlConfigurationCopy = controlConfiguration;
  v8 = +[CAMUserPreferences preferences];
  self->__desiredFlashMode = [controlConfigurationCopy desiredFlashMode];
  self->__desiredHDRMode = [controlConfigurationCopy desiredHDRMode];
  self->__desiredLivePhotoMode = [controlConfigurationCopy desiredLivePhotoMode];
  self->__desiredRAWMode = [controlConfigurationCopy desiredRAWMode];
  self->__desiredPhotoResolution = [controlConfigurationCopy desiredPhotoResolution];
  self->__photoFormatConflicts = [controlConfigurationCopy photoFormatConflicts];
  self->__desiredMacroMode = [controlConfigurationCopy desiredMacroMode];
  self->__desiredProResVideoMode = [configurationCopy proResVideoMode];
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v11 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", configurationCopy, _externalStorageOutputEnabled, [_motionController captureOrientation]);

  [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:v11];
  self->__resolvedFlashMode = [configurationCopy flashMode];
  self->__resolvedHDRMode = [configurationCopy HDRMode];
  self->__desiredTorchMode = [configurationCopy torchMode];
  self->__resolvedTorchMode = [(CAMViewfinderViewController *)self _resolvedTorchModeForGraphConfiguration:v11];
  self->__resolvedTimerDuration = [configurationCopy timerDuration];
  self->_photoModeAspectRatioCrop = [configurationCopy photoModeAspectRatioCrop];
  self->__photoModeEffectFilterType = [configurationCopy photoModeEffectFilterType];
  self->__squareModeEffectFilterType = [configurationCopy squareModeEffectFilterType];
  self->__portraitModeEffectFilterType = [configurationCopy portraitModeEffectFilterType];
  self->__resolvedLivePhotoMode = [configurationCopy irisMode];
  self->_portraitModeLightingEffectType = [configurationCopy portraitModeLightingEffectType];
  [configurationCopy portraitModeApertureValue];
  self->__portraitModeApertureValue = v12;
  [configurationCopy portraitModeIntensityValue];
  self->__portraitModeIntensityValue = v13;
  exposureBiasesByMode = [configurationCopy exposureBiasesByMode];
  v15 = [exposureBiasesByMode mutableCopy];
  exposureBiasesByMode = self->__exposureBiasesByMode;
  self->__exposureBiasesByMode = v15;

  self->__resolvedMacroMode = [configurationCopy macroMode];
  self->__resolvedPhotoResolution = [configurationCopy photoResolution];
  self->__resolvedRAWMode = [configurationCopy rawMode];
  semanticStyles = [configurationCopy semanticStyles];
  v18 = [semanticStyles mutableCopy];
  semanticStyles = self->__semanticStyles;
  self->__semanticStyles = v18;

  self->__selectedSemanticStyleIndex = [configurationCopy selectedSemanticStyleIndex];
  self->__smartStyleSystemStyleIndex = [configurationCopy smartStyleSystemStyleIndex];
  videoDynamicAspectRatio = [v11 videoDynamicAspectRatio];
  if (videoDynamicAspectRatio <= 2)
  {
    self->__wantsFlipAspectRatio = 0x100u >> (8 * videoDynamicAspectRatio);
  }

  smartFramingFieldOfView = [v11 smartFramingFieldOfView];
  if ((smartFramingFieldOfView - 1) >= 4)
  {
    if (!smartFramingFieldOfView)
    {
      _motionController2 = [(CAMViewfinderViewController *)self _motionController];
      self->__desiredFieldOfView = -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [_motionController2 captureOrientation]);
    }
  }

  else
  {
    self->__desiredFieldOfView = [v11 smartFramingFieldOfView];
  }

  [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:1];
  [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:1];
  [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
  v49[0] = MEMORY[0x1E69E9820];
  v49[1] = 3221225472;
  v49[2] = __104__CAMViewfinderViewController__updatePropertiesForCaptureConfiguration_conflictingControlConfiguration___block_invoke;
  v49[3] = &unk_1E76F7960;
  v25 = chromeConfigurator;
  v50 = v25;
  selfCopy = self;
  [chromeConfigurator2 performChanges:v49];

  self->__desiredVideoStabilizationMode = [configurationCopy videoStabilizationMode];
  _motionController3 = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", v11, [_motionController3 captureOrientation]);
  self->__cachedVideoZoomFactor = v27;

  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:v11 zoomFactor:?];
  v28 = +[CAMCaptureCapabilities capabilities];
  isNightModeSupported = [v28 isNightModeSupported];

  if (isNightModeSupported)
  {
    v47 = v8;
    self->__desiredNightModeControlMode = [controlConfigurationCopy desiredNightModeControlMode];
    nightModeConflicts = [controlConfigurationCopy nightModeConflicts];
    self->__nightModeConflicts = nightModeConflicts;
    v48 = controlConfigurationCopy;
    desiredNightModeControlMode = self->__desiredNightModeControlMode;
    resolvedFlashMode = self->__resolvedFlashMode;
    v32 = v25;
    mode = [v11 mode];
    device = [v11 device];
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    v37 = v36;
    LOBYTE(v45) = [configurationCopy optionalDepthEffectEnabled];
    v38 = desiredNightModeControlMode;
    v39 = mode;
    v25 = v32;
    v40 = device;
    v8 = v47;
    controlConfigurationCopy = v48;
    self->__resolvedNightModeControlMode = [CAMConflictingControlConfiguration resolveDesiredNightModeControlMode:v38 nightModeConflicts:nightModeConflicts resolvedFlashMode:resolvedFlashMode captureMode:v39 captureDevice:v40 photoFormat:currentPhotoFormat depthEffectEnabledFromSuggestion:v37, v45];
  }

  self->__depthEffectEnabledFromSuggestion = [configurationCopy optionalDepthEffectEnabled];
  self->encoding = [v8 photoFormatControlSecondaryFormat];
  self->resolution = v41;
  self->__lastZoomInteractionType = 0;
  self->__spatialModeHasVideoSelected = [v8 spatialModeHasVideoSelected];
  preferredDrawerControlByMode = [v8 preferredDrawerControlByMode];
  if (preferredDrawerControlByMode)
  {
    preferredDrawerControlByMode2 = [v8 preferredDrawerControlByMode];
    v44 = [preferredDrawerControlByMode2 mutableCopy];
    [(CAMViewfinderViewController *)self set_preferredControlToOpenInDrawerForMode:v44];
  }

  else
  {
    preferredDrawerControlByMode2 = objc_alloc_init(MEMORY[0x1E695DF90]);
    [(CAMViewfinderViewController *)self set_preferredControlToOpenInDrawerForMode:preferredDrawerControlByMode2];
  }

  -[CAMViewfinderViewController set_chromeSelectedProResColorSpace:](self, "set_chromeSelectedProResColorSpace:", [v8 explicitProResColorSpace]);
  -[CAMViewfinderViewController _setWantsSmartFramingAutoZoomDefault:](self, "_setWantsSmartFramingAutoZoomDefault:", [v8 wantsSmartFramingAutoZoomDefault]);
  -[CAMViewfinderViewController _setWantsSmartFramingAutoRotationDefault:](self, "_setWantsSmartFramingAutoRotationDefault:", [v8 wantsSmartFramingAutoRotationDefault]);
}

uint64_t __104__CAMViewfinderViewController__updatePropertiesForCaptureConfiguration_conflictingControlConfiguration___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setFlashMode:{objc_msgSend(*(a1 + 40), "_resolvedFlashMode")}];
  [*(a1 + 32) setTorchMode:{objc_msgSend(*(a1 + 40), "_resolvedTorchMode")}];
  [*(a1 + 32) setHdrMode:{objc_msgSend(*(a1 + 40), "_resolvedHDRMode")}];
  v2 = *(a1 + 40);
  v3 = [v2 _currentMode];
  v4 = [*(a1 + 40) _currentGraphConfiguration];
  [v2 _exposureBiasForMode:v3 trueVideoEnabled:{objc_msgSend(v4, "trueVideoEnabled")}];
  [*(a1 + 32) setExposureBias:?];

  v5 = *(a1 + 40);

  return [v5 _updateChromeSharedLibraryState];
}

- (void)applyCaptureConfiguration:(id)configuration conflictingControlConfiguration:(id)controlConfiguration
{
  [(CAMViewfinderViewController *)self _updatePropertiesForCaptureConfiguration:configuration conflictingControlConfiguration:controlConfiguration];

  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
}

- (void)_reconfigureCaptureGraphWithCurrentMode
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];

  [(CAMViewfinderViewController *)self changeToMode:_currentMode device:_currentDevice];
}

- (void)_setLayoutStyle:(int64_t)style
{
  layoutStyle = self->__layoutStyle;
  if (layoutStyle != style)
  {
    self->__layoutStyle = style;
    _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
    [_panoramaViewController setLayoutStyle:style];

    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    [viewfinderView setLayoutStyle:style];

    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    [_previewViewController setLayoutStyle:style];

    _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
    [_bottomBar setLayoutStyle:style];

    _flashButton = [(CAMViewfinderViewController *)self _flashButton];
    [_flashButton setLayoutStyle:style];

    _elapsedTimeView = [(CAMViewfinderViewController *)self _elapsedTimeView];
    [_elapsedTimeView setLayoutStyle:style];

    _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
    [_HDRButton setLayoutStyle:style];

    _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
    [_livePhotoButton setLayoutStyle:style];

    _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    [_sharedLibraryButton setLayoutStyle:style];

    _flipButton = [(CAMViewfinderViewController *)self _flipButton];
    [_flipButton setLayoutStyle:style];

    _timerButton = [(CAMViewfinderViewController *)self _timerButton];
    [_timerButton setLayoutStyle:style];

    _modeDial = [(CAMViewfinderViewController *)self _modeDial];
    [_modeDial setLayoutStyle:style];

    _imageWell = [(CAMViewfinderViewController *)self _imageWell];
    [_imageWell setLayoutStyle:style];

    _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
    [_zoomSlider setLayoutStyle:style];

    _burstIndicatorView = [(CAMViewfinderViewController *)self _burstIndicatorView];
    [_burstIndicatorView setLayoutStyle:style];

    _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
    [_shutterButton setLayoutStyle:style];

    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    [_controlDrawer setLayoutStyle:style];

    _videoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
    [_videoConfigurationStatusIndicator setLayoutStyle:style];

    [(CAMViewfinderViewController *)self _embedAllControlsWithLayoutStyle:style];
    [(CAMViewfinderViewController *)self _updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:style];
    [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
    if ([(CAMViewfinderViewController *)self automaticallyAdjustsAutorotationStyle])
    {
      [(CAMViewfinderViewController *)self _setInternalAutorotationStyle:[(CAMViewfinderViewController *)self _autorotationStyleForLayoutStyle:style]];
    }

    [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
    v24 = [(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:layoutStyle];
    if (v24 != [(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:style])
    {

      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
    }
  }
}

- (void)_updateLayoutStyle
{
  view = [(CAMViewfinderViewController *)self view];
  v4 = CAMLayoutStyleForView(view);

  [(CAMViewfinderViewController *)self _setLayoutStyle:v4];
}

- (CGSize)_portraitOrientedSizeForSize:(CGSize)size
{
  height = size.height;
  width = size.width;
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  screen = [window screen];

  [screen _referenceBounds];
  v8 = width < height;
  if (v9 < v10)
  {
    v8 = width > height;
  }

  if (v8)
  {
    v11 = width;
  }

  else
  {
    v11 = height;
  }

  if (!v8)
  {
    height = width;
  }

  v12 = height;
  v13 = v11;
  result.height = v13;
  result.width = v12;
  return result;
}

- (CAMViewfinderTransitionable)_viewfinderTransitionable
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v4 = _fullscreenViewfinder;
  if (_fullscreenViewfinder)
  {
    viewfinderView = _fullscreenViewfinder;
  }

  else
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  }

  v6 = viewfinderView;

  return v6;
}

- (CAMFullscreenViewfinder)_fullscreenViewfinder
{
  v3 = +[CAMCaptureCapabilities capabilities];
  wantsFullscreenViewfinder = [v3 wantsFullscreenViewfinder];

  if (wantsFullscreenViewfinder)
  {
    if (([(CAMViewfinderViewController *)self isViewLoaded]& 1) != 0)
    {
      view = [(CAMViewfinderViewController *)self view];
      goto LABEL_8;
    }

    v6 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEBUG))
    {
      [CAMViewfinderViewController _fullscreenViewfinder];
    }
  }

  view = 0;
LABEL_8:

  return view;
}

- (CAMControlDrawer)_controlDrawer
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlDrawer = [_fullscreenViewfinder controlDrawer];

  return controlDrawer;
}

- (void)viewWillAppear:(BOOL)appear
{
  appearCopy = appear;
  v7.receiver = self;
  v7.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v7 viewWillAppear:?];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController presentingViewControllerViewWillAppear:appearCopy];

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController removeClosedViewfinderReason:8];
}

- (void)viewDidAppear:(BOOL)appear
{
  appearCopy = appear;
  v15.receiver = self;
  v15.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v15 viewDidAppear:?];
  [(CAMViewfinderViewController *)self _createCameraCaseShutterNotifierIfNeeded];
  [(CAMViewfinderViewController *)self _createPhysicalCaptureInteractionIfNeeded];
  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setShowingPreview:1];

  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController presentingViewControllerViewDidAppear:appearCopy];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:0];
  if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
  }

  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  v9 = CAMSharedLibraryModeIsOn([_librarySelectionController sharedLibraryMode]);

  if (v9)
  {
    [(CAMViewfinderViewController *)self _startTimer:2];
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  }

  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  windowScene = [window windowScene];
  [windowScene _setSystemVolumeHUDEnabled:0];

  if (![(CAMViewfinderViewController *)self viewAlreadyDidAppear])
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    fallbackCameraEnabled = [v13 fallbackCameraEnabled];

    if (fallbackCameraEnabled)
    {
      +[CAMFallbackConfiguration checkAvailableCameraModules];
    }
  }

  [(CAMViewfinderViewController *)self setViewAlreadyDidAppear:1];
}

- (void)viewWillDisappear:(BOOL)disappear
{
  disappearCopy = disappear;
  v13.receiver = self;
  v13.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v13 viewWillDisappear:?];
  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:1];
  [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setShowingPreview:0];

  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController presentingViewControllerViewWillDisappear:disappearCopy];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:1];
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:8];

  v8 = +[CAMUserPreferences preferences];
  LODWORD(_cameraRollController) = [v8 sharedLibraryAutoBehaviorEnabled];

  if (_cameraRollController)
  {
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    [_librarySelectionController stopAcquiringSignals];
  }

  [(CAMViewfinderViewController *)self _writeUserPreferences];
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  windowScene = [window windowScene];
  [windowScene _setSystemVolumeHUDEnabled:1];
}

- (BOOL)prefersInterfaceOrientationLocked
{
  if ([(CAMViewfinderViewController *)self autorotationStyle]!= 2)
  {
    return 0;
  }

  if ([(CAMViewfinderViewController *)self isRecording])
  {
    return 1;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];

  return isCapturingBurst;
}

- (unint64_t)_supportedInterfaceOrientationsForLayoutStyle:(int64_t)style wantsTextAnalysis:(BOOL)analysis
{
  v28 = *MEMORY[0x1E69E9840];
  v6 = +[CAMCaptureCapabilities capabilities];
  forceAllowAllInterfaceOrientations = [v6 forceAllowAllInterfaceOrientations];

  if ([(CAMViewfinderViewController *)self _layoutStyle]!= 3)
  {
    return 30;
  }

  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  screen = [window screen];

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  screens = [MEMORY[0x1E69DCEB0] screens];
  v12 = [screens countByEnumeratingWithState:&v21 objects:v27 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v22;
    while (2)
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v22 != v14)
        {
          objc_enumerationMutation(screens);
        }

        v16 = *(*(&v21 + 1) + 8 * i);
        mirroredScreen = [v16 mirroredScreen];

        if (screen && mirroredScreen == screen)
        {
          v19 = os_log_create("com.apple.camera", "Camera");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543362;
            v26 = v16;
            _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "Detected mirrored screen, allowing all interface orientations (%{public}@)", buf, 0xCu);
          }

          v18 = 30;
          goto LABEL_18;
        }
      }

      v13 = [screens countByEnumeratingWithState:&v21 objects:v27 count:16];
      if (v13)
      {
        continue;
      }

      break;
    }
  }

  if ((analysis | forceAllowAllInterfaceOrientations))
  {
    v18 = 30;
  }

  else
  {
    v18 = 2;
  }

LABEL_18:

  return v18;
}

- (void)viewDidDisappear:(BOOL)disappear
{
  disappearCopy = disappear;
  v8.receiver = self;
  v8.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v8 viewDidDisappear:?];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setControlDrawerExpanded:0 forReason:7 animated:0];

  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController presentingViewControllerViewDidDisappear:disappearCopy];

  view = [(CAMViewfinderViewController *)self view];
  [view _removeAllAnimations:1];
}

- (void)viewDidLayoutSubviews
{
  v14.receiver = self;
  v14.super_class = CAMViewfinderViewController;
  [(CAMViewfinderViewController *)&v14 viewDidLayoutSubviews];
  view = [(CAMViewfinderViewController *)self view];
  _textInteractionBackground = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [view bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  superview = [_textInteractionBackground superview];
  [view convertRect:superview toView:{v6, v8, v10, v12}];
  [_textInteractionBackground setFrame:?];
}

- (void)viewWillTransitionToSize:(CGSize)size withTransitionCoordinator:(id)coordinator
{
  height = size.height;
  width = size.width;
  v10.receiver = self;
  v10.super_class = CAMViewfinderViewController;
  coordinatorCopy = coordinator;
  [(CAMViewfinderViewController *)&v10 viewWillTransitionToSize:coordinatorCopy withTransitionCoordinator:width, height];
  view = [(CAMViewfinderViewController *)self view];
  [view setNeedsLayout];
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __82__CAMViewfinderViewController_viewWillTransitionToSize_withTransitionCoordinator___block_invoke;
  v9[3] = &unk_1E76F95A8;
  v9[4] = self;
  [coordinatorCopy animateAlongsideTransition:0 completion:v9];
}

uint64_t __82__CAMViewfinderViewController_viewWillTransitionToSize_withTransitionCoordinator___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setNeedsUpdateOfHomeIndicatorAutoHidden];
  v2 = *(a1 + 32);

  return [v2 setNeedsUpdateOfScreenEdgesDeferringSystemGestures];
}

- (BOOL)_autoHideHomeIndicatorForOrientation:(int64_t)orientation
{
  v3 = orientation - 3;
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  v6 = CAMInterfaceOrientationForWindow(window);

  return ((v6 - 3) | v3) < 2;
}

- (void)_setHomeIndicatorAutoHideOrientation:(int64_t)orientation
{
  if (orientation != 2 && self->__homeIndicatorAutoHideOrientation != orientation)
  {
    self->__homeIndicatorAutoHideOrientation = orientation;
    v5 = [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:?];
    if (v5 != [(CAMViewfinderViewController *)self _autoHideHomeIndicatorForOrientation:orientation])
    {

      [(CAMViewfinderViewController *)self setNeedsUpdateOfHomeIndicatorAutoHidden];
    }
  }
}

- (void)_commitCTMCaptureWithType:(int64_t)type
{
  v38 = *MEMORY[0x1E69E9840];
  if (type)
  {
    _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    v6 = @"Photo";
    if (type != 1)
    {
      v6 = 0;
    }

    if (type == 2)
    {
      v6 = @"Video";
    }

    v7 = v6;
    if (!_currentStillImageCaptureMomentSettings)
    {
      v13 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _commitCTMCaptureWithType:];
      }

      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl resetAnimated:1];
      goto LABEL_38;
    }

    _dynamicShutterControl = [(CAMViewfinderViewController *)self _captureController];
    v9 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      nightMode = [_currentStillImageCaptureMomentSettings nightMode];
      nightModeStatus = [_dynamicShutterControl nightModeStatus];
      if (nightMode > 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = off_1E76FA020[nightMode];
      }

      v14 = nightModeStatus + 1;
      if (v14 > 3)
      {
        v15 = 0;
      }

      else
      {
        v15 = off_1E76F9F50[v14];
      }

      v16 = [MEMORY[0x1E696AEC0] stringWithFormat:@"NightMode%@/%@", v12, v15];
      *buf = 138543618;
      v33 = v7;
      v34 = 2114;
      v35 = v16;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Commit CTM capture with type %{public}@, %{public}@", buf, 0x16u);
    }

    [_currentStillImageCaptureMomentSettings setCtmCaptureType:type];
    v17 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:_currentStillImageCaptureMomentSettings burst:0];
    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [_currentStillImageCaptureMomentSettings persistenceUUID];
    [_analyticsEventsByIdentifier setObject:v17 forKey:persistenceUUID];

    v31 = 0;
    LOBYTE(persistenceUUID) = [_dynamicShutterControl commitCTMCaptureWithRequest:_currentStillImageCaptureMomentSettings error:&v31];
    v20 = v31;
    if ((persistenceUUID & 1) == 0)
    {
      v22 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        localizedDescription = [v20 localizedDescription];
        *buf = 138543874;
        v33 = v7;
        v34 = 2114;
        v35 = _currentStillImageCaptureMomentSettings;
        v36 = 2114;
        v37 = localizedDescription;
        _os_log_error_impl(&dword_1A3640000, v22, OS_LOG_TYPE_ERROR, "Failed to capture %{public}@ with request %{public}@ (%{public}@)", buf, 0x20u);
      }

      if (type == 2 || [(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
      {
        [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
        _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [_dynamicShutterControl2 resetAnimated:1];
      }

      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to commit CTM capture"];
      goto LABEL_37;
    }

    [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
    if (type == 1)
    {
      stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
      [stillImageCaptureTestDelegate viewfinderViewController:self willCaptureStillImageForRequest:_currentStillImageCaptureMomentSettings];
    }

    else if (type == 2)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
LABEL_33:
      isDisablingAdditionalCaptures = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      isCapturingVideo = [_captureController isCapturingVideo];

      if (isDisablingAdditionalCaptures && (isCapturingVideo & 1) == 0)
      {
        [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
      }

      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
      _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [_analyticsSessionEvent didCaptureWithRequest:_currentStillImageCaptureMomentSettings currentConfiguration:_currentGraphConfiguration];

LABEL_37:
      _motionController = [(CAMViewfinderViewController *)self _motionController];
      [_motionController debugValidateCaptureOrientationForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

LABEL_38:
      [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
      [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];

      goto LABEL_39;
    }

    if ([_currentStillImageCaptureMomentSettings nightMode])
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture began"];
    }

    goto LABEL_33;
  }

  _currentStillImageCaptureMomentSettings = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(_currentStillImageCaptureMomentSettings, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController _commitCTMCaptureWithType:];
  }

LABEL_39:
}

- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:(unint64_t)time
{
  v22 = *MEMORY[0x1E69E9840];
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

  if (_currentStillImageCaptureMomentSettings)
  {
    v6 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _initiateCTMCaptureWithCurrentSettingsAtSystemTime:];
    }

    _currentStillImageCaptureMomentSettings2 = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    [_captureController cancelCTMCaptureForSettings:_currentStillImageCaptureMomentSettings2];

    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
  }

  v8 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
  v19 = 0;
  v9 = [_captureController initiateCTMCaptureWithSettings:v8 error:&v19];
  v10 = v19;
  if (v9)
  {
    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:v8];
    v11 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      nightMode = [v8 nightMode];
      nightModeStatus = [_captureController nightModeStatus];
      if (nightMode > 2)
      {
        v14 = 0;
      }

      else
      {
        v14 = off_1E76FA020[nightMode];
      }

      v16 = nightModeStatus + 1;
      if (v16 > 3)
      {
        v17 = 0;
      }

      else
      {
        v17 = off_1E76F9F50[v16];
      }

      v18 = [MEMORY[0x1E696AEC0] stringWithFormat:@"NightMode%@/%@", v14, v17];
      *buf = 138543362;
      v21 = v18;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Initiated moment with %{public}@", buf, 0xCu);
    }
  }

  else
  {
    v15 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v21 = v10;
      _os_log_impl(&dword_1A3640000, v15, OS_LOG_TYPE_DEFAULT, "Failed to initiate CTM capture: %{public}@", buf, 0xCu);
    }

    if (_currentStillImageCaptureMomentSettings)
    {
      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    }
  }
}

- (int64_t)_currentPhotoEncodingBehavior
{
  v3 = +[CAMUserPreferences preferences];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v7 = [v3 photoEncodingBehaviorForMode:_currentMode resolvedRAWMode:_resolvedRAWMode isCapturingVideo:objc_msgSend(_captureController isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  return v7;
}

- (int64_t)_currentRawFileFormatEncodingBehavior
{
  v2 = +[CAMUserPreferences preferences];
  rawFileFormatBehavior = [v2 rawFileFormatBehavior];

  return rawFileFormatBehavior;
}

- (int64_t)_currentMaxPhotoResolution
{
  v3 = +[CAMUserPreferences preferences];
  v4 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  if ([v3 shouldUsePhotoFormatControlForMode:_currentMode])
  {
    _resolvedPhotoResolution = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  }

  else if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== 1)
  {
    _resolvedPhotoResolution = [v3 maximumRAWPhotoResolution];
  }

  else
  {
    _resolvedPhotoResolution = [v3 preferredHEICPhotoResolutionForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  }

  v8 = _resolvedPhotoResolution;
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v11 = [v3 photoEncodingBehaviorForMode:_currentMode resolvedRAWMode:_resolvedRAWMode isCapturingVideo:objc_msgSend(_captureController isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  if (![v4 isPhotoResolutionSupported:v8 forMode:_currentMode device:_currentDevice photoEncoding:v11])
  {
    v8 = 0;
  }

  if ([v4 isPhotoResolutionSupported:v8 forLightingType:{-[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", _currentMode, _currentDevice)}])
  {
    v12 = v8;
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (void)_stopCapturingCTMVideo
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController endCTMVideoCapture];

  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];

  [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:1];
}

- (void)_cancelCTMCapture
{
  _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  if (_currentStillImageCaptureMomentSettings)
  {
    _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
    v5 = os_log_create("com.apple.camera", "Capture");
    v6 = os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT);
    if (_isReconfiguring)
    {
      if (v6)
      {
        v11 = 0;
        v7 = "Cancelling CTM capture for reconfiguring";
        v8 = &v11;
LABEL_7:
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, v7, v8, 2u);
      }
    }

    else if (v6)
    {
      v10 = 0;
      v7 = "Cancelling CTM capture";
      v8 = &v10;
      goto LABEL_7;
    }

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController cancelCTMCaptureForSettings:_currentStillImageCaptureMomentSettings];
    [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureMomentSettings:0];
    [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  }
}

- (void)_updateOriginForRequest:(id)request
{
  requestCopy = request;
  [requestCopy setOrigin:{-[CAMViewfinderViewController _currentCaptureRequestOrigin](self, "_currentCaptureRequestOrigin")}];
}

- (void)_updateUserInitiationTimeForRequest:(id)request
{
  requestCopy = request;
  if ([(CAMViewfinderViewController *)self _shouldReportUserInitiationTimeForCurrentSettings])
  {
    _lastShutterButtonTouchDownTime = [(CAMViewfinderViewController *)self _lastShutterButtonTouchDownTime];
  }

  else
  {
    _lastShutterButtonTouchDownTime = 0;
  }

  [requestCopy setUserInitiationTime:_lastShutterButtonTouchDownTime];
}

- (BOOL)_captureStillImageWithRequest:(id)request error:(id *)error
{
  requestCopy = request;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v8 = [_captureController captureStillImageWithRequest:requestCopy error:error];
  isDisablingAdditionalCaptures = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  isCapturingVideo = [_captureController isCapturingVideo];
  if (v8 && isDisablingAdditionalCaptures && (isCapturingVideo & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  if (((v8 ^ 1 | [_captureController isCaptureAvailable]) & 1) == 0)
  {
    v11 = +[CAMCaptureCapabilities capabilities];
    portraitModeOverlappingCapturesSupported = [v11 portraitModeOverlappingCapturesSupported];

    if ((portraitModeOverlappingCapturesSupported & 1) == 0 && [(CAMViewfinderViewController *)self _currentMode]== 6)
    {
      _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
      if (_shallowDepthOfFieldStatus <= 0xE && ((1 << _shallowDepthOfFieldStatus) & 0x6202) != 0 && ![requestCopy nightMode])
      {
        [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
      }
    }
  }

  [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
  [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];

  return v8;
}

- (id)_stillImageCaptureRequestWithCurrentSettingsAsBurst:(BOOL)burst maximumLength:(int64_t)length
{
  burstCopy = burst;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  v49 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  persistenceBehavior = [(CAMViewfinderViewController *)self persistenceBehavior];
  v47 = _captureController;
  isCapturingVideo = [_captureController isCapturingVideo];
  v12 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:_currentMode];
  v52 = [(CAMViewfinderViewController *)self _currentCaptureFiltersForBurst:burstCopy];
  v13 = _currentMode;
  v51 = [(CAMViewfinderViewController *)self _originalCaptureFiltersForMode:_currentMode devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
  v46 = _motionController;
  captureOrientation = [_motionController captureOrientation];
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  v15 = +[CAMUserPreferences preferences];
  v16 = objc_alloc_init(CAMMutableStillImageCaptureRequest);
  [(CAMMutableStillImageCaptureRequest *)v16 setDelegate:self];
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureOrientation:captureOrientation];
  if ((_currentDevice - 1) > 0xA)
  {
    v17 = 0;
  }

  else
  {
    v17 = qword_1A3A685B0[_currentDevice - 1];
  }

  v48 = v15;
  -[CAMMutableStillImageCaptureRequest setCaptureMirrored:](v16, "setCaptureMirrored:", [v15 mirrorCameraCapturesForDevicePosition:v17 mode:v13]);
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureDevice:_currentDevice];
  [(CAMMutableStillImageCaptureRequest *)v16 setCaptureMode:v13];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsSquareCrop:v13 == 4];
  [(CAMMutableStillImageCaptureRequest *)v16 setAspectRatioCrop:[(CAMViewfinderViewController *)self _aspectRatioCropForMode:v13 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v16 setEffectFilterType:v12];
  -[CAMMutableStillImageCaptureRequest setSessionIdentifier:](v16, "setSessionIdentifier:", [_cameraRollController sessionIdentifier]);
  [(CAMMutableStillImageCaptureRequest *)v16 setAdjustmentFilters:v52];
  [(CAMMutableStillImageCaptureRequest *)v16 setOriginalFilters:v51];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsHighResolutionStills:1];
  [(CAMMutableStillImageCaptureRequest *)v16 setStillDuringVideo:isCapturingVideo];
  [(CAMMutableStillImageCaptureRequest *)v16 setWantsAutoDualCameraFusion:burstCopy ^ 1];
  if ([v15 semanticDevelopmentEnabled])
  {
    v18 = [(CAMViewfinderViewController *)self _resolvedRAWMode]!= 1;
  }

  else
  {
    v18 = 0;
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setWantsSemanticSceneFilter:v18];
  _semanticStyleForCapture = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
  [(CAMMutableStillImageCaptureRequest *)v16 setSemanticStyle:_semanticStyleForCapture];

  _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (_currentHeadphonesCaptureEvent)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setWantsShutterSoundSuppression:1];
  }

  if (burstCopy)
  {
    v21 = v13;
    v22 = [v49 isBurstSupportedForMode:v13 device:_currentDevice] ^ 1;
  }

  else
  {
    v21 = v13;
    if (isCapturingVideo)
    {
      v22 = 0;
    }

    else if ([(CAMViewfinderViewController *)self _isBurstEndSoundPlaying])
    {
      v22 = [(CAMViewfinderViewController *)self _desiredLivePhotoMode]== 0;
    }

    else
    {
      v22 = 1;
    }
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setWantsAudioForCapture:v22];
  [(CAMMutableStillImageCaptureRequest *)v16 setLightingEffectType:[(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:v21 device:_currentDevice]];
  -[CAMMutableStillImageCaptureRequest setWantsWhiteBalanceLockedDuringVideoRecording:](v16, "setWantsWhiteBalanceLockedDuringVideoRecording:", [v15 shouldLockWhiteBalanceDuringVideoRecording]);
  if (burstCopy)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setFlashMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setHdrMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setIrisMode:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoQualityPrioritization:0];
    [(CAMMutableStillImageCaptureRequest *)v16 setNightMode:0];
    if (length >= 1)
    {
      [(CAMMutableStillImageCaptureRequest *)v16 setMaximumBurstLength:length];
    }

    v23 = v49;
    v24 = persistenceBehavior;
    if ([v15 burstFollowsEncoderSettings])
    {
      photoEncodingBehavior = [v15 photoEncodingBehavior];
    }

    else
    {
      photoEncodingBehavior = 0;
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoEncodingBehavior:photoEncodingBehavior];
    [(CAMMutableStillImageCaptureRequest *)v16 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:persistenceBehavior allowingOptionalLocalPersistence:1]];
  }

  else
  {
    v53 = 0;
    v26 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:v21 flashActive:&v53];
    [(CAMMutableStillImageCaptureRequest *)v16 setFlashMode:v53];
    if (v26)
    {
      _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
    }

    else
    {
      _resolvedFlashMode = 0;
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setTorchMode:[CAMCaptureConversions torchModeForFlashMode:_resolvedFlashMode]];
    if (isEmulatingImagePicker)
    {
      _resolvedHDRMode = 0;
      LOBYTE(isCapturingVideo) = 1;
    }

    else
    {
      _resolvedHDRMode = [(CAMViewfinderViewController *)self _resolvedHDRMode];
    }

    [(CAMMutableStillImageCaptureRequest *)v16 setHdrMode:_resolvedHDRMode];
    -[CAMMutableStillImageCaptureRequest setWantsEV0ForHDR:](v16, "setWantsEV0ForHDR:", [v15 shouldCaptureHDREV0]);
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    photoQualityPrioritization = [_currentGraphConfiguration photoQualityPrioritization];

    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoQualityPrioritization:photoQualityPrioritization];
    [(CAMMutableStillImageCaptureRequest *)v16 setPhotoEncodingBehavior:[(CAMViewfinderViewController *)self _currentPhotoEncodingBehavior]];
    [(CAMMutableStillImageCaptureRequest *)v16 setRawFileFormatBehavior:[(CAMViewfinderViewController *)self _currentRawFileFormatEncodingBehavior]];
    v21 = v13;
    [(CAMMutableStillImageCaptureRequest *)v16 setNightMode:[(CAMViewfinderViewController *)self _nightModeForMode:[(CAMViewfinderViewController *)self _resolvedNightMode] captureMode:v13 device:_currentDevice isBurst:0]];
    -[CAMMutableStillImageCaptureRequest setDisablesCameraSwitchingDuringRecording:](v16, "setDisablesCameraSwitchingDuringRecording:", [v15 shouldDisableCameraSwitchingDuringVideoRecordingForMode:v13]);
    [(CAMMutableStillImageCaptureRequest *)v16 setMaximumPhotoResolution:[(CAMViewfinderViewController *)self _currentMaxPhotoResolution]];
    [(CAMMutableStillImageCaptureRequest *)v16 setWantsDepthData:[(CAMViewfinderViewController *)self _shouldRequestDepthDeliveryForBurst:0]];
    if (isCapturingVideo)
    {
      _resolvedLivePhotoMode = 0;
    }

    else
    {
      _resolvedLivePhotoMode = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
    }

    v24 = persistenceBehavior;
    [(CAMMutableStillImageCaptureRequest *)v16 setIrisMode:_resolvedLivePhotoMode];
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    -[CAMMutableStillImageCaptureRequest setVideoEncodingBehavior:](v16, "setVideoEncodingBehavior:", [_currentGraphConfiguration2 videoEncodingBehavior]);

    [(CAMMutableStillImageCaptureRequest *)v16 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:persistenceBehavior allowingOptionalLocalPersistence:_resolvedLivePhotoMode == 0]];
    [(CAMViewfinderViewController *)self _updateUserInitiationTimeForRequest:v16];
    v23 = v49;
  }

  _locationController = [(CAMViewfinderViewController *)self _locationController];
  currentLocation = [_locationController currentLocation];
  if (currentLocation)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setLocation:currentLocation];
  }

  v35 = [_locationController headingForOrientation:captureOrientation];
  if (v35)
  {
    [(CAMMutableStillImageCaptureRequest *)v16 setHeading:v35];
  }

  if ([v23 isInternalInstall])
  {
    -[CAMMutableStillImageCaptureRequest setShouldDelayRemotePersistence:](v16, "setShouldDelayRemotePersistence:", [v15 shouldDelayRemotePersistence]);
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:v24]];
  [(CAMViewfinderViewController *)self _updateOriginForRequest:v16];
  [(CAMViewfinderViewController *)self _desiredPreviewSizeForStillImageCapture];
  [(CAMMutableStillImageCaptureRequest *)v16 setDesiredPreviewSize:?];
  if ([v15 sharedLibraryEnabled])
  {
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      [(CAMMutableStillImageCaptureRequest *)v16 setSharedLibraryMode:[(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState]];
    }

    else
    {
      _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
      -[CAMMutableStillImageCaptureRequest setSharedLibraryMode:](v16, "setSharedLibraryMode:", [_librarySelectionController sharedLibraryMode]);
    }

    if ([v23 isInternalInstall])
    {
      _librarySelectionController2 = [(CAMViewfinderViewController *)self _librarySelectionController];
      librarySelectionDiagnostics = [_librarySelectionController2 librarySelectionDiagnostics];
      [(CAMMutableStillImageCaptureRequest *)v16 setSharedLibraryDiagnostics:librarySelectionDiagnostics];

      v21 = v13;
    }

    if ([v23 peopleProximityPersistenceSupported])
    {
      _librarySelectionController3 = [(CAMViewfinderViewController *)self _librarySelectionController];
      acquiredSignalResults = [_librarySelectionController3 acquiredSignalResults];

      identitiesInProximity = [acquiredSignalResults identitiesInProximity];
      v42 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(identitiesInProximity);
      [(CAMMutableStillImageCaptureRequest *)v16 setContactIDsInProximity:v42];

      v15 = v48;
      v23 = v49;

      v21 = v13;
    }
  }

  [(CAMMutableStillImageCaptureRequest *)v16 setStereoCaptureStatus:[(CAMViewfinderViewController *)self _stereoCaptureStatus]];
  [(CAMMutableStillImageCaptureRequest *)v16 setFrontRearSimultaneousCaptureEnabled:[(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:v21 devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v16 setFrontRearSimultaneousCaptureMirrored:[(CAMStillImageCaptureRequest *)v16 isFrontRearSimultaneousCaptureEnabled]];
  [(CAMMutableStillImageCaptureRequest *)v16 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];

  return v16;
}

- (CGSize)_desiredPreviewSizeForStillImageCapture
{
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  screen = [window screen];

  [screen _referenceBounds];
  v6 = v5;
  v8 = v7;
  [screen scale];
  v10 = v9 * v8;
  v11 = v9 * v6;

  v12 = v10;
  v13 = v11;
  result.height = v13;
  result.width = v12;
  return result;
}

- (BOOL)_isPrimaryDisplayAssetForCoordinationInfo:(id)info
{
  if (info)
  {
    return [info isUnfilteredImageForFilteredPair] ^ 1;
  }

  else
  {
    return 1;
  }
}

- (BOOL)_wantsCaptureAnimationForRequest:(id)request
{
  requestCopy = request;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingVideo])
  {
    videoCapturePaused = [_captureController videoCapturePaused];
  }

  else
  {
    videoCapturePaused = 1;
  }

  isCapturingBurst = [_captureController isCapturingBurst];
  burstIdentifier = [requestCopy burstIdentifier];

  textAnalysisIdentifier = [requestCopy textAnalysisIdentifier];

  if (textAnalysisIdentifier)
  {
    v10 = 0;
  }

  else
  {
    v10 = videoCapturePaused;
  }

  if (burstIdentifier)
  {
    v10 = 0;
  }

  if (isCapturingBurst)
  {
    v11 = 0;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (void)stillImageRequestDidBeginCaptureBeforeResolvingSettings:(id)settings
{
  if ([(CAMViewfinderViewController *)self _wantsCaptureAnimationForRequest:settings])
  {

    [(CAMViewfinderViewController *)self _performCaptureAnimation];
  }
}

- (void)stillImageRequestDidStartCapturing:(id)capturing resolvedSettings:(id)settings
{
  capturingCopy = capturing;
  settingsCopy = settings;
  v8 = +[CAMCaptureCapabilities capabilities];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isCaptureBeforeResolvingSettingsEnabled = [settingsCopy isCaptureBeforeResolvingSettingsEnabled];
  v11 = [(CAMViewfinderViewController *)self _wantsCaptureAnimationForRequest:capturingCopy];
  [settingsCopy nightModeCaptureTime];
  if (v11 && (isCaptureBeforeResolvingSettingsEnabled & 1) == 0)
  {
    v13 = v12;
    nightMode = [capturingCopy nightMode];
    if ((nightMode - 1) < 2)
    {
      if (v13 >= 2.0)
      {
        [_fullscreenViewfinder setPreviewAlignmentGuideVisible:1 animated:1];
        _motionController = [(CAMViewfinderViewController *)self _motionController];
        previewAlignmentGuide = [_fullscreenViewfinder previewAlignmentGuide];
        alignmentModel = [previewAlignmentGuide alignmentModel];
        [_motionController beginUpdatingPreviewAlignmentModel:alignmentModel];

        objc_initWeak(&location, self);
        _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
        nightModeSlider = [_controlDrawer nightModeSlider];
        v56[0] = MEMORY[0x1E69E9820];
        v56[1] = 3221225472;
        v56[2] = __83__CAMViewfinderViewController_stillImageRequestDidStartCapturing_resolvedSettings___block_invoke;
        v56[3] = &unk_1E76F95D0;
        objc_copyWeak(&v57, &location);
        [nightModeSlider performCaptureAnimationWithDuration:v56 completion:v13];

        [(CAMViewfinderViewController *)self _beginNightModeInstructionLabelCountDown];
        [(CAMViewfinderViewController *)self _setNightModeCaptureUIVisible:1];
        chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
        [chromeConfigurator setIsNightModeCaptureUIVisible:1];

        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
        objc_destroyWeak(&v57);
        objc_destroyWeak(&location);
      }

      v21 = [v8 nightModePreviewOverlayStyleForDevicePosition:objc_msgSend(capturingCopy sensitiveToChangingDisplayFeedback:"captureDevicePosition") sensitiveToInitialFeedback:objc_msgSend(settingsCopy duration:{"nightModeCaptureHasConstantPreviewFeedbackSensitivity"), objc_msgSend(settingsCopy, "nightModeCaptureHasInitialPreviewFeedbackSensitivity"), v13}];
      v22 = [MEMORY[0x1E69DC888] colorWithCGColor:{objc_msgSend(settingsCopy, "nightModePreviewColorEstimate")}];
      v23 = v22;
      if (v22)
      {
        blackColor = v22;
      }

      else
      {
        blackColor = [MEMORY[0x1E69DC888] blackColor];
      }

      v25 = blackColor;

      v29 = 0;
      v30 = 1;
      if (v21 > 2)
      {
        if (v21 != 3)
        {
          if (v21 == 4)
          {
            v30 = 0;
            v29 = 0;
          }

          goto LABEL_22;
        }

        v31 = MEMORY[0x1E69793D0];
        v32 = MEMORY[0x1E6979EA0];
      }

      else
      {
        if (v21 >= 2)
        {
          if (v21 != 2)
          {
LABEL_22:
            [(CAMViewfinderViewController *)self _performCaptureAnimationWithDuration:v29 curve:v25 color:v30 fadeOut:v13];
            _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
            [_feedbackController prepareDiscreteFeedback:5];

            goto LABEL_23;
          }

          LODWORD(v26) = 1.0;
          LODWORD(v27) = 1.0;
          LODWORD(v28) = 1.0;
          v33 = [MEMORY[0x1E69793D0] functionWithControlPoints:v26 :0.0 :v27 :v28];
LABEL_21:
          v29 = v33;
          v30 = 1;
          goto LABEL_22;
        }

        v31 = MEMORY[0x1E69793D0];
        v32 = MEMORY[0x1E6979ED8];
      }

      v33 = [v31 functionWithName:*v32];
      goto LABEL_21;
    }

    if (!nightMode)
    {
      [(CAMViewfinderViewController *)self _performCaptureAnimation];
    }
  }

LABEL_23:
  burstIdentifier = [capturingCopy burstIdentifier];

  if (burstIdentifier)
  {
    _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController2 performDiscreteFeedback:1];

    _feedbackController3 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController3 prepareDiscreteFeedback:1];

    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (_dynamicShutterControl)
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      incrementCounter = [_dynamicShutterControl2 incrementCounter];
    }

    else
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _burstIndicatorView];
      incrementCounter = [_dynamicShutterControl2 incrementWithCaptureAnimation:1];
    }

    v41 = incrementCounter;

    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController burstCaptureNumberOfPhotosDidChange:v41];
  }

  v43 = _fullscreenViewfinder;
  isHDREnabled = [settingsCopy isHDREnabled];
  v55 = settingsCopy;
  isPortraitEffectEnabled = [settingsCopy isPortraitEffectEnabled];
  portraitModeOverlappingCapturesSupported = [v8 portraitModeOverlappingCapturesSupported];
  v45 = v8;
  isSmartHDRSupported = [v8 isSmartHDRSupported];
  nightMode2 = [capturingCopy nightMode];
  maximumPhotoResolution = [capturingCopy maximumPhotoResolution];
  v49 = v45;
  v50 = [v45 supportsOverlappingCapturesForResolution:3];
  if ([capturingCopy captureMode] == 9)
  {
    v51 = capturingCopy;
    v52 = ([capturingCopy stereoCaptureStatus] >> 1) & 1;
    if (nightMode2)
    {
      goto LABEL_34;
    }
  }

  else
  {
    v51 = capturingCopy;
    LOBYTE(v52) = 0;
    if (nightMode2)
    {
      goto LABEL_34;
    }
  }

  if (v52 & 1 | (((isHDREnabled ^ 1 | isSmartHDRSupported) & (isPortraitEffectEnabled ^ 1 | portraitModeOverlappingCapturesSupported) & ((maximumPhotoResolution != 3) | v50) & 1) == 0))
  {
    [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
  }

LABEL_34:
  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
}

void __83__CAMViewfinderViewController_stillImageRequestDidStartCapturing_resolvedSettings___block_invoke(uint64_t a1, int a2)
{
  if (a2)
  {
    WeakRetained = objc_loadWeakRetained((a1 + 32));
    [WeakRetained _updateShutterButtonForEndOfNightModeCapture];
  }
}

- (void)_beginNightModeInstructionLabelCountDown
{
  _resolvedNightModeControlMode = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode];
  if (_resolvedNightModeControlMode == 2)
  {
    _nightModeInstructionLabel = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
    v4 = v5;
  }

  else
  {
    if (_resolvedNightModeControlMode != 1)
    {
      return;
    }

    _nightModeInstructionLabel = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
  }

  [_nightModeInstructionLabel countDownFrom:v4];
}

- (void)stillImageRequestDidStopCapturingStillImage:(id)image
{
  imageCopy = image;
  stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

  if (stillImageCaptureTestDelegate)
  {
    stillImageCaptureTestDelegate2 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [stillImageCaptureTestDelegate2 viewfinderViewController:self didReceiveStillImageRequestDidStopCapturingStillImage:imageCopy];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  if ([imageCopy nightMode])
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setPreviewAlignmentGuideVisible:0 animated:1];
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    [_motionController endUpdatingPreviewAlignmentModel];

    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController performDiscreteFeedback:5];

    [(CAMViewfinderViewController *)self _updateShutterButtonForEndOfNightModeCapture];
  }

  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController stillImageRequestDidStopCapturingStillImage:imageCopy];
}

- (void)stillImageRequestDidCompleteStillImageCapture:(id)capture withResponse:(id)response error:(id)error
{
  v45 = *MEMORY[0x1E69E9840];
  captureCopy = capture;
  responseCopy = response;
  errorCopy = error;
  textAnalysisIdentifier = [captureCopy textAnalysisIdentifier];

  if (textAnalysisIdentifier)
  {
    [(CAMViewfinderViewController *)self _handleTextAnalysisStillImageResponse:responseCopy error:errorCopy forRequest:captureCopy];
  }

  else
  {
    stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

    if (stillImageCaptureTestDelegate)
    {
      stillImageCaptureTestDelegate2 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
      [stillImageCaptureTestDelegate2 viewfinderViewController:self didReceiveStillImageRequestDidCompleteStillImageCapture:captureCopy withResponse:responseCopy error:errorCopy];
    }

    coordinationInfo = [responseCopy coordinationInfo];
    isFinalExpectedStillImageResult = [coordinationInfo isFinalExpectedStillImageResult];
    isEV0ForHDREV0Pair = [coordinationInfo isEV0ForHDREV0Pair];
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    if ((errorCopy || isFinalExpectedStillImageResult) && ![(CAMViewfinderViewController *)self _isNightModeCaptureCanceling])
    {
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    }

    [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
    if (isEV0ForHDREV0Pair)
    {
      v18 = os_log_create("com.apple.camera", "ImageWell");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        persistenceUUID = [responseCopy persistenceUUID];
        v41 = 138543618;
        v42 = persistenceUUID;
        v43 = 2114;
        v44 = coordinationInfo;
        _os_log_impl(&dword_1A3640000, v18, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: ignoring future updates for EV0 result from stillImageRequestDidCompleteStillImageCapture %{public}@", &v41, 0x16u);
      }

      eV0PersistenceUUID = [captureCopy EV0PersistenceUUID];
      persistenceUUID2 = [captureCopy persistenceUUID];
      [_cameraRollController ignoreImageWellChangeNotificationForEV0UUID:eV0PersistenceUUID withHDRUUID:persistenceUUID2];
    }

    [(CAMViewfinderViewController *)self _updateImageWellWithStillImageResponse:responseCopy forRequest:captureCopy error:errorCopy];
    if (!errorCopy)
    {
      if ([(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:coordinationInfo])
      {
        [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:0 persistenceOptions:{objc_msgSend(captureCopy, "persistenceOptions")}];
      }

      _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
      persistenceUUID3 = [captureCopy persistenceUUID];
      v24 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID3];

      [v24 populateFromStillImageCaptureResponse:responseCopy];
    }

    burstIdentifier = [captureCopy burstIdentifier];

    if (burstIdentifier)
    {
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
    }

    else
    {
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      _currentBurstTimer = [(CAMViewfinderViewController *)self _currentBurstTimer];
      if (([_captureController isCapturingBurst] & 1) == 0 && (objc_msgSend(_captureController, "isCapturingStillImage") & 1) == 0 && objc_msgSend(_currentBurstTimer, "fired"))
      {
        v28 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
        {
          LOWORD(v41) = 0;
          _os_log_impl(&dword_1A3640000, v28, OS_LOG_TYPE_DEFAULT, "Starting burst because image capture finished after burst timer fired", &v41, 2u);
        }

        [(CAMViewfinderViewController *)self _beginCapturingBurst];
      }
    }

    if ([captureCopy nightMode])
    {
      [(CAMViewfinderViewController *)self _setNightModeCaptureUIVisible:0];
      chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
      [chromeConfigurator setIsNightModeCaptureUIVisible:0];

      [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture ended"];
      _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
      nightModeSlider = [_controlDrawer nightModeSlider];
      [nightModeSlider endCaptureAnimationAnimated:1];

      _nightModeInstructionLabel = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
      [_nightModeInstructionLabel cancelCountDown];

      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder dismissModalControlDrawerIfNeededForReason:2];
    }

    captureDelegate = [(CAMViewfinderViewController *)self captureDelegate];
    [captureDelegate viewfinderViewControllerDidCompleteStillImageCapture:self];

    if ([(CAMViewfinderViewController *)self _resolvedTimerDuration])
    {
      _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
      if (_timerIndicatorView)
      {
        _timerIndicatorView2 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      }

      else
      {
        _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        _timerIndicatorView2 = [_fullscreenViewfinder2 timerIndicator];
      }

      v38 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
      if (v38 > 2)
      {
        v39 = 0;
      }

      else
      {
        v39 = qword_1A3A68368[v38];
      }

      if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
      {
        [_timerIndicatorView2 resetWithNumberOfTicks:v39 showBeforeAnimationStarts:0];
      }

      else
      {
        _captureController2 = [(CAMViewfinderViewController *)self _captureController];
        [_timerIndicatorView2 resetWithNumberOfTicks:v39 showBeforeAnimationStarts:{objc_msgSend(_captureController2, "isCapturingBurst") ^ 1}];
      }
    }
  }
}

- (void)stillImageRequestDidCompleteVideoCapture:(id)capture withResponse:(id)response error:(id)error
{
  captureCopy = capture;
  responseCopy = response;
  errorCopy = error;
  if ([captureCopy isCTMVideo])
  {
    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [captureCopy persistenceUUID];
    _cameraRollController = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

    [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:_cameraRollController];
    [(CAMViewfinderViewController *)self _captureRequest:captureCopy didCompleteVideoCaptureWithResponse:responseCopy error:errorCopy];
  }

  else
  {
    if (errorCopy)
    {
      goto LABEL_6;
    }

    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientPairedVideoUpdate:responseCopy filterType:{objc_msgSend(captureCopy, "effectFilterType")}];
  }

LABEL_6:
}

- (void)stillImageRequestDidCompleteStillImageLocalPersistence:(id)persistence withResponse:(id)response error:(id)error
{
  persistenceCopy = persistence;
  responseCopy = response;
  v10 = responseCopy;
  if (error)
  {
    userInfo = [error userInfo];
    v12 = [userInfo objectForKeyedSubscript:*MEMORY[0x1E696AA08]];

    domain = [v12 domain];
    if ([domain isEqual:*MEMORY[0x1E696A798]])
    {
      code = [v12 code];

      if (code != 28)
      {
LABEL_10:

        goto LABEL_13;
      }

      captureMode = [persistenceCopy captureMode];
      captureDevice = [persistenceCopy captureDevice];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      domain = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:captureMode device:captureDevice fromGraphConfiguration:_currentGraphConfiguration];

      _storageController = [(CAMViewfinderViewController *)self _storageController];
      LODWORD(_currentGraphConfiguration) = [_storageController hasDiskSpaceToAllowCaptureWithConfiguration:domain allowPurging:1 verbose:1];

      v19 = @"insufficient";
      if (_currentGraphConfiguration)
      {
        v19 = @"sufficient";
      }

      v20 = v19;
      v21 = os_log_create("com.apple.camera", "Capture");
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController stillImageRequestDidCompleteStillImageLocalPersistence:withResponse:error:];
      }

      [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:1];
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
    }

    goto LABEL_10;
  }

  coordinationInfo = [responseCopy coordinationInfo];
  v23 = [(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:coordinationInfo];

  if (v23)
  {
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientAssetUpdate:v10 preventingInsertion:0 persistenceOptions:{objc_msgSend(persistenceCopy, "persistenceOptions")}];
  }

LABEL_13:
}

- (void)stillImageRequestDidCompleteStillImageRemotePersistence:(id)persistence withResponse:(id)response error:(id)error
{
  if (!error)
  {
    responseCopy = response;
    persistenceCopy = persistence;
    persistenceUUID = [responseCopy persistenceUUID];
    sessionIdentifier = [responseCopy sessionIdentifier];
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    persistenceOptions = [persistenceCopy persistenceOptions];

    [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:1 persistenceOptions:persistenceOptions];
    [_cameraRollController didPersistAssetWithUUID:persistenceUUID captureSession:sessionIdentifier];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, response];
}

- (void)stillImageRequestDidCompleteCapture:(id)capture error:(id)error
{
  captureCopy = capture;
  errorCopy = error;
  stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];

  if (stillImageCaptureTestDelegate)
  {
    stillImageCaptureTestDelegate2 = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
    [stillImageCaptureTestDelegate2 viewfinderViewController:self didReceiveStillImageRequestDidCompleteCapture:captureCopy error:errorCopy];
  }

  if (errorCopy && [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
  }

  if (([captureCopy isCTMVideo] & 1) == 0)
  {
    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [captureCopy persistenceUUID];
    v11 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

    [v11 publish];
    _analyticsEventsByIdentifier2 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID2 = [captureCopy persistenceUUID];
    [_analyticsEventsByIdentifier2 removeObjectForKey:persistenceUUID2];
  }
}

- (void)stillImageRequestsWillStartCapturingLivePhotoVideo
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingLivePhotoVideo = [_captureController isCapturingLivePhotoVideo];

  if (isCapturingLivePhotoVideo)
  {
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke;
    v6[3] = &unk_1E76F95F8;
    v6[4] = self;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }

  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke_2;
  v5[3] = &unk_1E76F77B0;
  v5[4] = self;
  [MEMORY[0x1E69DD250] animateWithDuration:2 delay:v5 options:0 animations:0.25 completion:0.0];
}

void __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke(uint64_t a1, void *a2)
{
  v2 = *(a1 + 32);
  v3 = a2;
  [v3 updateForLivePhotoMode:{objc_msgSend(v2, "_resolvedLivePhotoMode")}];
}

void __81__CAMViewfinderViewController_stillImageRequestsWillStartCapturingLivePhotoVideo__block_invoke_2(uint64_t a1)
{
  v1 = [*(a1 + 32) viewfinderView];
  [v1 setNeedsLayout];
  [v1 layoutIfNeeded];
}

- (void)stillImageRequestsDidCompleteCapturingLivePhotoVideo
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __83__CAMViewfinderViewController_stillImageRequestsDidCompleteCapturingLivePhotoVideo__block_invoke;
  v3[3] = &unk_1E76F77B0;
  v3[4] = self;
  [MEMORY[0x1E69DD250] animateWithDuration:2 delay:v3 options:0 animations:0.25 completion:0.0];
}

void __83__CAMViewfinderViewController_stillImageRequestsDidCompleteCapturingLivePhotoVideo__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) viewfinderView];
  [v1 setNeedsLayout];
  [v1 layoutIfNeeded];
}

- (void)stillImageRequestsWillRequestCTMVideoCaptureStart
{
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v4 = objc_opt_respondsToSelector();

  if (v4)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 stillImageRequestsWillRequestCTMVideoCaptureStartForViewfinderViewController:self];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];

  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

- (void)stillImageRequestsWillRequestCTMVideoCaptureEnd
{
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v4 = objc_opt_respondsToSelector();

  if (v4)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 stillImageRequestsWillRequestCTMVideoCaptureEndForViewfinderViewController:self];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];

  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

- (BOOL)_isCTMVideoSupportedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];

  LOBYTE(configurationCopy) = [v4 isCTMVideoCaptureSupportedForMode:mode];
  return configurationCopy;
}

- (void)stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:(BOOL)flight
{
  v14 = *MEMORY[0x1E69E9840];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _isCTMVideoSupportedForGraphConfiguration:_currentGraphConfiguration];

  if (v6)
  {
    if (!flight)
    {
      _idleController = [(CAMViewfinderViewController *)self _idleController];
      [_idleController stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight:0];
    }

    _targetElapsedTimeView = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
    [_targetElapsedTimeView startTimer];
    [_targetElapsedTimeView setBackgroundStyle:1 animated:1];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController didStartCaptureTimer];

    [(CAMViewfinderViewController *)self _limitZoomRangeForRecordingIfNecessary];
  }

  else
  {
    v9 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      *buf = 138543362;
      v13 = _currentGraphConfiguration2;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Received stillImageRequestWillStartCapturingCTMVideoWithCaptureInFlight in unsupported configuration %{public}@", buf, 0xCu);
    }
  }
}

- (void)stillImageRequestsDidStopCapturingCTMVideo
{
  v12 = *MEMORY[0x1E69E9840];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _isCTMVideoSupportedForGraphConfiguration:_currentGraphConfiguration];

  if (v4)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingCTMVideo = [_captureController isCapturingCTMVideo];

    if (isCapturingCTMVideo)
    {
      return;
    }

    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    [(CAMViewfinderViewController *)self _restoreZoomRangeAfterRecordingIfNecessary];
  }

  else
  {
    v7 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v10 = 138543362;
      v11 = _currentGraphConfiguration2;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Received stillImageRequestsDidStopCapturingCTMVideo in unsupported configuration %{public}@", &v10, 0xCu);
    }
  }

  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController stillImageRequestsDidStopCapturingCTMVideo];
}

- (void)_presentImageWellImage:(id)image uuid:(id)uuid animated:(BOOL)animated
{
  animatedCopy = animated;
  uuidCopy = uuid;
  imageCopy = image;
  [(CAMViewfinderViewController *)self setPresentedImageWellImage:imageCopy];
  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  [_imageWell setThumbnailImage:imageCopy uuid:uuidCopy animated:animatedCopy];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator updateThumbnailImage:imageCopy uuid:uuidCopy animated:animatedCopy];
}

- (void)setPresentedImageWellImage:(id)image
{
  imageCopy = image;
  if (self->_presentedImageWellImage != imageCopy)
  {
    v6 = imageCopy;
    objc_storeStrong(&self->_presentedImageWellImage, image);
    imageCopy = v6;
  }
}

- (void)_updateImageWellWithStillImageResponse:(id)response forRequest:(id)request error:(id)error
{
  v27 = *MEMORY[0x1E69E9840];
  responseCopy = response;
  requestCopy = request;
  coordinationInfo = [responseCopy coordinationInfo];
  persistenceUUID = [responseCopy persistenceUUID];
  representsFinalProcessedStillImage = [coordinationInfo representsFinalProcessedStillImage];
  if (error || !representsFinalProcessedStillImage)
  {
    imageWellImage = os_log_create("com.apple.camera", "ImageWell");
    if (os_log_type_enabled(imageWellImage, OS_LOG_TYPE_DEFAULT))
    {
      v21 = 138543618;
      v22 = persistenceUUID;
      v23 = 2114;
      v24 = coordinationInfo;
      _os_log_impl(&dword_1A3640000, imageWellImage, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: ignoring non-final image well update from still image capture %{public}@", &v21, 0x16u);
    }
  }

  else
  {
    imageWellImage = [responseCopy imageWellImage];
    if (imageWellImage)
    {
      _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
      sessionIdentifier = [responseCopy sessionIdentifier];
      persistenceUUID2 = [responseCopy persistenceUUID];
      if ([_cameraRollController isCaptureSessionCurrent:sessionIdentifier])
      {
        [_cameraRollController willPersistAssetWithUUID:persistenceUUID2 captureSession:sessionIdentifier];
        v17 = os_log_create("com.apple.camera", "ImageWell");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          v21 = 138543874;
          v22 = persistenceUUID2;
          v23 = 2114;
          v24 = imageWellImage;
          v25 = 2114;
          v26 = coordinationInfo;
          _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: updating from still image capture %{public}@ %{public}@", &v21, 0x20u);
        }

        [(CAMViewfinderViewController *)self _presentImageWellImage:imageWellImage uuid:persistenceUUID2 animated:1];
        CAMSignpostWithIDAndArgs(75, [responseCopy captureID], objc_msgSend(responseCopy, "captureID"), 0, 0, 0);
        if (![requestCopy conformsToProtocol:&unk_1F1759928] || (objc_msgSend(requestCopy, "burstIdentifier"), v18 = objc_claimAutoreleasedReturnValue(), v18, !v18))
        {
          _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
          [_remoteShutterController sendThumbnailImage:imageWellImage isVideo:0];
        }

        stillImageCaptureTestDelegate = [(CAMViewfinderViewController *)self stillImageCaptureTestDelegate];
        [stillImageCaptureTestDelegate viewfinderViewController:self didUpdateImageWellWithRequest:requestCopy response:responseCopy error:0];
      }
    }

    else
    {
      _cameraRollController = os_log_create("com.apple.camera", "ImageWell");
      if (os_log_type_enabled(_cameraRollController, OS_LOG_TYPE_DEFAULT))
      {
        v21 = 138543618;
        v22 = persistenceUUID;
        v23 = 2114;
        v24 = coordinationInfo;
        _os_log_impl(&dword_1A3640000, _cameraRollController, OS_LOG_TYPE_DEFAULT, "ImageWell %{public}@: no image well image found, so calling recoverFromFailedThumbnailUpdate for still image capture %{public}@", &v21, 0x16u);
      }
    }
  }
}

- (id)_videoCaptureRequestWithCurrentSettings
{
  v3 = +[CAMUserPreferences preferences];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  if ((device - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[device - 1];
  }

  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  if ([(CAMViewfinderViewController *)self _isProactiveFlashSuggestionSuppressed])
  {
    _resolvedTorchMode = 0;
  }

  else
  {
    _resolvedTorchMode = [(CAMViewfinderViewController *)self _resolvedTorchMode];
  }

  v38 = _motionController;
  captureOrientation = [_motionController captureOrientation];
  v12 = objc_alloc_init(CAMMutableVideoCaptureRequest);
  [(CAMMutableVideoCaptureRequest *)v12 setTorchMode:_resolvedTorchMode];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureOrientation:captureOrientation];
  -[CAMMutableVideoCaptureRequest setCaptureMirrored:](v12, "setCaptureMirrored:", [v3 mirrorCameraCapturesForDevicePosition:v8 mode:mode]);
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureDevice:device];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureMode:mode];
  [(CAMMutableVideoCaptureRequest *)v12 setCaptureVideoConfiguration:videoConfiguration];
  -[CAMMutableVideoCaptureRequest setWantsWhiteBalanceLocked:](v12, "setWantsWhiteBalanceLocked:", [v3 shouldLockWhiteBalanceDuringVideoRecording]);
  [(CAMMutableVideoCaptureRequest *)v12 setDelegate:self];
  -[CAMMutableVideoCaptureRequest setSessionIdentifier:](v12, "setSessionIdentifier:", [_cameraRollController sessionIdentifier]);
  [(CAMMutableVideoCaptureRequest *)v12 setUserInitiationTimestamp:CFAbsoluteTimeGetCurrent()];
  -[CAMMutableVideoCaptureRequest setAudioConfiguration:](v12, "setAudioConfiguration:", [_currentGraphConfiguration audioConfiguration]);
  [(CAMMutableVideoCaptureRequest *)v12 setTrueVideoEnabled:[(CAMViewfinderViewController *)self _trueVideoIsActive]];
  [(CAMMutableVideoCaptureRequest *)v12 setFrontRearSimultaneousVideoEnabled:[(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:mode devicePosition:v8]];
  [(CAMMutableVideoCaptureRequest *)v12 setFrontRearSimultaneousVideoMirrored:[(CAMVideoCaptureRequest *)v12 isFrontRearSimultaneousVideoEnabled]];
  _locationController = [(CAMViewfinderViewController *)self _locationController];
  currentLocation = [_locationController currentLocation];
  if (currentLocation)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setLocation:currentLocation];
  }

  v15 = [_locationController headingForOrientation:captureOrientation];
  if (v15)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setHeading:v15];
  }

  v16 = +[CAMCaptureCapabilities capabilities];
  if ([v16 isInternalInstall])
  {
    -[CAMMutableVideoCaptureRequest setShouldDelayRemotePersistence:](v12, "setShouldDelayRemotePersistence:", [v3 shouldDelayRemotePersistence]);
  }

  v39 = v3;
  -[CAMMutableVideoCaptureRequest setVideoEncodingBehavior:](v12, "setVideoEncodingBehavior:", [_currentGraphConfiguration videoEncodingBehavior]);
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  -[CAMMutableVideoCaptureRequest setRemainingDiskUsageThreshold:](v12, "setRemainingDiskUsageThreshold:", [_storageController minimumDiskUsageThresholdInBytesForGraphConfiguration:_currentGraphConfiguration]);
  [(CAMViewfinderViewController *)self maximumVideoRecordingDuration];
  if (v18 > 0.0)
  {
    [(CAMMutableVideoCaptureRequest *)v12 setMaximumRecordedDuration:?];
  }

  persistenceBehavior = [(CAMViewfinderViewController *)self persistenceBehavior];
  v20 = [(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:persistenceBehavior allowingOptionalLocalPersistence:0];
  [(CAMMutableVideoCaptureRequest *)v12 setPersistenceOptions:v20];
  [(CAMMutableVideoCaptureRequest *)v12 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:persistenceBehavior]];
  if (v20 == 3)
  {
    _storageController2 = [(CAMViewfinderViewController *)self _storageController];
    externalStorage = [_storageController2 externalStorage];
    v23 = [externalStorage generateDestinationURLWithExtension:@"MOV"];

    [(CAMMutableVideoCaptureRequest *)v12 setLocalDestinationURL:v23];
  }

  [(CAMViewfinderViewController *)self _updateOriginForRequest:v12];
  [(CAMMutableVideoCaptureRequest *)v12 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];
  v24 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v12 burst:0];
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID = [(CAMCaptureRequest *)v12 persistenceUUID];
  [_analyticsEventsByIdentifier setObject:v24 forKey:persistenceUUID];

  if ([(CAMVideoCaptureRequest *)v12 isFrontRearSimultaneousVideoEnabled])
  {
    persistenceUUID2 = [(CAMCaptureRequest *)v12 persistenceUUID];
    [(CAMViewfinderViewController *)self _setFRSVAnalyticsId:persistenceUUID2];

    [v24 trackFrontRearSimultaneousVideoPIPMoveToAnchor:{-[CAMViewfinderViewController _frontRearSimultaneousVideoPIPAnchor](self, "_frontRearSimultaneousVideoPIPAnchor")}];
  }

  v28 = v39;
  if ([v39 sharedLibraryEnabled] && !-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"))
  {
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMMutableVideoCaptureRequest setSharedLibraryMode:](v12, "setSharedLibraryMode:", [_librarySelectionController sharedLibraryMode]);

    if ([v16 isInternalInstall])
    {
      _librarySelectionController2 = [(CAMViewfinderViewController *)self _librarySelectionController];
      librarySelectionDiagnostics = [_librarySelectionController2 librarySelectionDiagnostics];
      [(CAMMutableVideoCaptureRequest *)v12 setSharedLibraryDiagnostics:librarySelectionDiagnostics];
    }

    v28 = v39;
    if ([v16 peopleProximityPersistenceSupported])
    {
      _librarySelectionController3 = [(CAMViewfinderViewController *)self _librarySelectionController];
      acquiredSignalResults = [_librarySelectionController3 acquiredSignalResults];

      identitiesInProximity = [acquiredSignalResults identitiesInProximity];
      v35 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(identitiesInProximity);
      [(CAMMutableVideoCaptureRequest *)v12 setContactIDsInProximity:v35];

      v28 = v39;
    }
  }

  return v12;
}

- (BOOL)_startCapturingVideoWithRequest:(id)request
{
  requestCopy = request;
  if ([requestCopy persistenceOptions] == 3 && (objc_msgSend(requestCopy, "localDestinationURL"), v5 = objc_claimAutoreleasedReturnValue(), v5, !v5))
  {
    v13 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingVideoWithRequest:];
    }

    [(CAMViewfinderViewController *)self _showExternalStorageRecordingFailedAlert];
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];
    v7 = 0;
  }

  else
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    v14 = 0;
    v7 = [_captureController startCapturingVideoWithRequest:requestCopy error:&v14];
    _dynamicShutterControl = v14;
    if (v7)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
      _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
      [_previewViewController notifyWillStartCapturing];
      _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [_analyticsSessionEvent didCaptureWithRequest:requestCopy currentConfiguration:_currentGraphConfiguration];
    }

    else
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start video capture"];
    }
  }

  return v7;
}

- (BOOL)_stopCapturingVideo
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  stopCapturingVideo = [_captureController stopCapturingVideo];
  [MEMORY[0x1E69DD258] attemptRotationToDeviceOrientation];
  [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:1];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1 updateProResControls:0];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl resetAnimated:1];

  isDisablingAdditionalCaptures = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  if (stopCapturingVideo && isDisablingAdditionalCaptures)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  if (stopCapturingVideo)
  {
    if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
    {
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to stop video capture"];
  }

  return stopCapturingVideo;
}

- (BOOL)_pauseCapturingVideo
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  pauseCapturingVideo = [_captureController pauseCapturingVideo];
  if (pauseCapturingVideo)
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl setPausedDuringVideo:1 animated:1];

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    elapsedTimeView = [_fullscreenViewfinder elapsedTimeView];
    [elapsedTimeView setTimerPaused:1];

    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    elapsedTimeView2 = [_fullscreenViewfinder2 elapsedTimeView];
    [elapsedTimeView2 setBackgroundStyle:2 animated:1];

    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    elapsedTimeView3 = [_fullscreenViewfinder3 elapsedTimeView];
    pausedTime = [elapsedTimeView3 pausedTime];
    [_remoteShutterController didPauseCaptureTimerWithPauseTime:pausedTime];

    _idleController = [(CAMViewfinderViewController *)self _idleController];
    [_idleController updateForVideoPaused];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  return pauseCapturingVideo;
}

- (BOOL)_resumeCaptureVideo
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  resumeCaptureVideo = [_captureController resumeCaptureVideo];
  if (resumeCaptureVideo)
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl setPausedDuringVideo:0 animated:1];

    _idleController = [(CAMViewfinderViewController *)self _idleController];
    [_idleController updateForVideoResumed];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  return resumeCaptureVideo;
}

- (int64_t)_resolvedColorSpaceForMode:(int64_t)mode videoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior device:(int64_t)device
{
  v11 = +[CAMUserPreferences preferences];
  explicitProResColorSpace = [v11 explicitProResColorSpace];
  chromeViewController = [(CAMViewfinderViewController *)self chromeViewController];

  if (chromeViewController)
  {
    explicitProResColorSpace = [(CAMViewfinderViewController *)self _chromeSelectedProResColorSpace];
  }

  v14 = [v11 colorSpaceForMode:mode videoConfiguration:configuration videoEncodingBehavior:behavior device:device preferredProResColorSpace:explicitProResColorSpace];

  return v14;
}

- (void)videoRequestDidStartCapturing:(id)capturing
{
  capturingCopy = capturing;
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 viewfinderViewController:self didReceiveVideoRequestDidStartCapturing:capturingCopy];
  }

  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController videoRequestDidStartCapturing:capturingCopy];
  _targetElapsedTimeView = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
  [_targetElapsedTimeView startTimer];
  [_targetElapsedTimeView setBackgroundStyle:1 animated:1];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController didStartCaptureTimer];

  [(CAMViewfinderViewController *)self _limitZoomRangeForRecordingIfNecessary];
  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (void)videoRequestDidStopCapturing:(id)capturing
{
  capturingCopy = capturing;
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 viewfinderViewController:self didReceiveVideoRequestDidStopCapturing:capturingCopy];
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (([_captureController isCapturingVideo] & 1) == 0)
  {
    _idleController = [(CAMViewfinderViewController *)self _idleController];
    [_idleController videoRequestDidStopCapturing:capturingCopy];
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [capturingCopy persistenceUUID];
    v11 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

    [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v11];
    [(CAMViewfinderViewController *)self _restoreZoomRangeAfterRecordingIfNecessary];
    [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    if ([(CAMViewfinderViewController *)self _trueVideoIsCapturing])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
    }

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    enableDepthSuggestion = [_currentGraphConfiguration enableDepthSuggestion];

    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    [_captureController2 updateCaptureButtonControlsForCaptureMode:-[CAMViewfinderViewController _currentMode](self devicePosition:"_currentMode") isRecording:-[CAMViewfinderViewController _currentDevicePosition](self depthSuggestionEnabled:{"_currentDevicePosition"), -[CAMViewfinderViewController isRecording](self, "isRecording"), enableDepthSuggestion}];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }
}

- (void)videoRequestDidCompleteCapture:(id)capture withResponse:(id)response error:(id)error
{
  captureCopy = capture;
  responseCopy = response;
  errorCopy = error;
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 viewfinderViewController:self didReceiveVideoRequestDidCompleteCapture:captureCopy withResponse:responseCopy error:errorCopy];
  }

  [(CAMViewfinderViewController *)self _captureRequest:captureCopy didCompleteVideoCaptureWithResponse:responseCopy error:errorCopy];
}

- (void)_captureRequest:(id)request didCompleteVideoCaptureWithResponse:(id)response error:(id)error
{
  requestCopy = request;
  responseCopy = response;
  errorCopy = error;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (([_captureController isCapturingBurst] & 1) == 0 && (objc_msgSend(_captureController, "isCapturingVideo") & 1) == 0)
  {
    isCapturingNightModeImage = [_captureController isCapturingNightModeImage];
    if (errorCopy)
    {
      goto LABEL_4;
    }

LABEL_6:
    v13 = 0;
    goto LABEL_7;
  }

  isCapturingNightModeImage = 1;
  if (!errorCopy)
  {
    goto LABEL_6;
  }

LABEL_4:
  v13 = CAMErrorIsVideoCaptureRequestError(errorCopy, -28003) ^ 1;
LABEL_7:
  if (!(isCapturingNightModeImage & 1 | ((([responseCopy stoppedUnexpectedly] | v13) & 1) == 0)))
  {
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];

    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }

  coordinationInfo = [responseCopy coordinationInfo];
  v16 = coordinationInfo;
  if (coordinationInfo)
  {
    representsFinalProcessedVideo = [coordinationInfo representsFinalProcessedVideo];
    if (errorCopy || (representsFinalProcessedVideo & 1) == 0)
    {
      if (errorCopy)
      {
        goto LABEL_22;
      }

      goto LABEL_19;
    }
  }

  else if (errorCopy)
  {
    goto LABEL_22;
  }

  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  sessionIdentifier = [responseCopy sessionIdentifier];
  persistenceUUID = [responseCopy persistenceUUID];
  if ([_cameraRollController isCaptureSessionCurrent:sessionIdentifier])
  {
    [_cameraRollController willPersistAssetWithUUID:persistenceUUID captureSession:sessionIdentifier];
    imageWellImage = [responseCopy imageWellImage];
    [(CAMViewfinderViewController *)self _presentImageWellImage:imageWellImage uuid:persistenceUUID animated:1];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController sendThumbnailImage:imageWellImage isVideo:1];
  }

LABEL_19:
  if ([(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:v16])
  {
    _cameraRollController2 = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController2 processTransientAssetUpdate:responseCopy preventingInsertion:0 persistenceOptions:{objc_msgSend(requestCopy, "persistenceOptions")}];
  }

  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID2 = [requestCopy persistenceUUID];
  v26 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID2];

  [v26 populateFromVideoCaptureResponse:responseCopy];
  [v26 publish];

LABEL_22:
  _analyticsEventsByIdentifier2 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID3 = [requestCopy persistenceUUID];
  [_analyticsEventsByIdentifier2 removeObjectForKey:persistenceUUID3];

  [(CAMViewfinderViewController *)self _setFRSVAnalyticsId:0];
  reason = [responseCopy reason];
  if (reason == 3)
  {
    v30 = @"MAX_RECORDING_FILE_SIZE_REACHED";
  }

  else
  {
    if (reason != 2)
    {
      if (reason == 1)
      {
        [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:1];
        [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
      }

      goto LABEL_30;
    }

    v30 = @"MAX_RECORDING_DURATION_REACHED";
  }

  v31 = CAMLocalizedFrameworkString(v30, 0);
  if (v31)
  {
    v32 = v31;
    v33 = MEMORY[0x1E69DC650];
    v34 = CAMLocalizedFrameworkString(@"RECORDING_STOPPED_TITLE", 0);
    v35 = [v33 alertControllerWithTitle:v34 message:v32 preferredStyle:1];

    v36 = MEMORY[0x1E69DC648];
    v37 = CAMLocalizedFrameworkString(@"OK", 0);
    v38 = [v36 actionWithTitle:v37 style:1 handler:0];
    [v35 addAction:v38];

    view = [(CAMViewfinderViewController *)self view];
    window = [view window];

    [window pl_presentViewController:v35 animated:1];
    goto LABEL_32;
  }

LABEL_30:
  if ([responseCopy slowWriterFrameDrops])
  {
    [(CAMViewfinderViewController *)self _showFrameDropsAlert];
  }

LABEL_32:
  if ([(CAMViewfinderViewController *)self _resolvedTorchMode]== 2)
  {
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _configuredMode]];
  }

  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled]&& ![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v41 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
    {
      *v42 = 0;
      _os_log_impl(&dword_1A3640000, v41, OS_LOG_TYPE_DEFAULT, "External storage: enabling deferred SSD output on didCompleteVideoCaptureWithResponse", v42, 2u);
    }

    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
  }
}

- (void)videoRequestDidCompleteLocalPersistence:(id)persistence withResponse:(id)response error:(id)error
{
  persistenceCopy = persistence;
  responseCopy = response;
  errorCopy = error;
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 viewfinderViewController:self didReceiveVideoRequestDidCompleteLocalPersistence:persistenceCopy withResponse:responseCopy error:errorCopy];
  }

  if (!errorCopy)
  {
    coordinationInfo = [responseCopy coordinationInfo];
    v14 = [(CAMViewfinderViewController *)self _isPrimaryDisplayAssetForCoordinationInfo:coordinationInfo];

    if (v14)
    {
      _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
      [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:0 persistenceOptions:{objc_msgSend(persistenceCopy, "persistenceOptions")}];
    }
  }
}

- (void)videoRequestDidCompleteRemotePersistence:(id)persistence withResponse:(id)response error:(id)error
{
  persistenceCopy = persistence;
  responseCopy = response;
  errorCopy = error;
  videoCaptureTestDelegate = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
  v11 = objc_opt_respondsToSelector();

  if (v11)
  {
    videoCaptureTestDelegate2 = [(CAMViewfinderViewController *)self videoCaptureTestDelegate];
    [videoCaptureTestDelegate2 viewfinderViewController:self didReceiveVideoRequestDidCompleteRemotePersistence:persistenceCopy withResponse:responseCopy error:errorCopy];
  }

  if (!errorCopy)
  {
    persistenceUUID = [responseCopy persistenceUUID];
    sessionIdentifier = [responseCopy sessionIdentifier];
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:1 persistenceOptions:{objc_msgSend(persistenceCopy, "persistenceOptions")}];
    [_cameraRollController didPersistAssetWithUUID:persistenceUUID captureSession:sessionIdentifier];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
}

- (void)videoRequestDidResumeCapturing:(id)capturing
{
  v4 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v13 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "CAMViewfinderViewController videoRequestDidResumeCapturing", v13, 2u);
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  elapsedTimeView = [_fullscreenViewfinder elapsedTimeView];
  [elapsedTimeView setTimerPaused:0];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  elapsedTimeView2 = [_fullscreenViewfinder2 elapsedTimeView];
  [elapsedTimeView2 setBackgroundStyle:1 animated:1];

  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  elapsedTimeView3 = [_fullscreenViewfinder3 elapsedTimeView];
  startTime = [elapsedTimeView3 startTime];
  [_remoteShutterController didResumeCaptureTimerWithNewStartTime:startTime];

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (id)_panoramaCaptureRequestWithCurrentSettings
{
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  panoramaCaptureOrientation = [_motionController panoramaCaptureOrientation];
  v6 = objc_alloc_init(CAMMutablePanoramaCaptureRequest);
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureOrientation:panoramaCaptureOrientation];
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureDevice:[(CAMViewfinderViewController *)self _currentDevice]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setCaptureMode:[(CAMViewfinderViewController *)self _currentMode]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setDelegate:self];
  v26 = _cameraRollController;
  -[CAMMutablePanoramaCaptureRequest setSessionIdentifier:](v6, "setSessionIdentifier:", [_cameraRollController sessionIdentifier]);
  _locationController = [(CAMViewfinderViewController *)self _locationController];
  currentLocation = [_locationController currentLocation];
  if (currentLocation)
  {
    [(CAMMutablePanoramaCaptureRequest *)v6 setLocation:currentLocation];
  }

  v9 = [_locationController headingForOrientation:panoramaCaptureOrientation];
  if (v9)
  {
    [(CAMMutablePanoramaCaptureRequest *)v6 setHeading:v9];
  }

  v10 = +[CAMCaptureCapabilities capabilities];
  if ([v10 isInternalInstall])
  {
    v11 = +[CAMUserPreferences preferences];
    -[CAMMutablePanoramaCaptureRequest setShouldDelayRemotePersistence:](v6, "setShouldDelayRemotePersistence:", [v11 shouldDelayRemotePersistence]);
  }

  persistenceBehavior = [(CAMViewfinderViewController *)self persistenceBehavior];
  [(CAMMutablePanoramaCaptureRequest *)v6 setPersistenceOptions:[(CAMViewfinderViewController *)self _persistenceOptionsForBehavior:persistenceBehavior allowingOptionalLocalPersistence:0]];
  [(CAMMutablePanoramaCaptureRequest *)v6 setTemporaryPersistenceOptions:[(CAMViewfinderViewController *)self _temporaryPersistenceOptionsForBehavior:persistenceBehavior]];
  v13 = +[CAMUserPreferences preferences];
  -[CAMMutablePanoramaCaptureRequest setPhotoEncodingBehavior:](v6, "setPhotoEncodingBehavior:", [v13 photoEncodingBehavior]);
  if ([v13 sharedLibraryEnabled])
  {
    v25 = _motionController;
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMMutablePanoramaCaptureRequest setSharedLibraryMode:](v6, "setSharedLibraryMode:", [_librarySelectionController sharedLibraryMode]);

    if ([v10 isInternalInstall])
    {
      _librarySelectionController2 = [(CAMViewfinderViewController *)self _librarySelectionController];
      librarySelectionDiagnostics = [_librarySelectionController2 librarySelectionDiagnostics];
      [(CAMMutablePanoramaCaptureRequest *)v6 setSharedLibraryDiagnostics:librarySelectionDiagnostics];
    }

    _motionController = v25;
    if ([v10 peopleProximityPersistenceSupported])
    {
      _librarySelectionController3 = [(CAMViewfinderViewController *)self _librarySelectionController];
      acquiredSignalResults = [_librarySelectionController3 acquiredSignalResults];

      identitiesInProximity = [acquiredSignalResults identitiesInProximity];
      v20 = CAMLibrarySelectionIdentityContactIdentifiersForIdentities(identitiesInProximity);
      [(CAMMutablePanoramaCaptureRequest *)v6 setContactIDsInProximity:v20];

      _motionController = v25;
    }
  }

  [(CAMViewfinderViewController *)self _updateOriginForRequest:v6];
  [(CAMMutablePanoramaCaptureRequest *)v6 setPressType:[(CAMViewfinderViewController *)self _currentlyPressedButton]];
  v21 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v6 burst:0];
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID = [(CAMCaptureRequest *)v6 persistenceUUID];
  [_analyticsEventsByIdentifier setObject:v21 forKey:persistenceUUID];

  return v6;
}

- (BOOL)_startCapturingPanoramaWithRequest:(id)request
{
  requestCopy = request;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v11 = 0;
  v6 = [_captureController startCapturingPanoramaWithRequest:requestCopy error:&v11];
  v7 = v11;
  if (v6)
  {
    [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [_analyticsSessionEvent didCaptureWithRequest:requestCopy currentConfiguration:_currentGraphConfiguration];
  }

  else
  {
    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start panorama capture"];
    _analyticsSessionEvent = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(_analyticsSessionEvent, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingPanoramaWithRequest:];
    }
  }

  return v6;
}

- (BOOL)_stopCapturingPanorama
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v4 = [_captureController stopCapturingPanoramaInterrupted:0];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
  isDisablingAdditionalCaptures = [(CAMViewfinderViewController *)self isDisablingAdditionalCaptures];
  if (v4 && isDisablingAdditionalCaptures)
  {
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
  }

  return v4;
}

- (void)panoramaRequestDidStartCapturing:(id)capturing
{
  capturingCopy = capturing;
  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController panoramaRequestDidStartCapturing:capturingCopy];
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  analyticsCaptureEvent = [_panoramaViewController analyticsCaptureEvent];
  if (analyticsCaptureEvent)
  {
    v8 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController panoramaRequestDidStartCapturing:];
    }
  }

  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID = [capturingCopy persistenceUUID];
  v11 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

  [_panoramaViewController setAnalyticsCaptureEvent:v11];
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  panoramaView = [_panoramaViewController panoramaView];
  [_dockKitController panoramaCaptureDidStart:{objc_msgSend(panoramaView, "direction")}];
}

- (void)panoramaRequest:(id)request didGeneratePaintingStatus:(id)status
{
  statusCopy = status;
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  [_panoramaViewController updateWithStatus:statusCopy];
}

- (void)panoramaRequestDidStopCapturing:(id)capturing interrupted:(BOOL)interrupted
{
  interruptedCopy = interrupted;
  capturingCopy = capturing;
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  [_panoramaViewController startProcessingPanorama];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (([_captureController isCapturingPanorama] & 1) == 0)
  {
    [_panoramaViewController setAnalyticsCaptureEvent:0];
    _idleController = [(CAMViewfinderViewController *)self _idleController];
    [_idleController panoramaRequestDidStopCapturing:capturingCopy interrupted:interruptedCopy];
    [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
    if (interruptedCopy)
    {
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl resetAnimated:1];
    }

    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:1];
    }

    _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
    panoramaView = [_panoramaViewController panoramaView];
    [_dockKitController panoramaCaptureDidStop:{objc_msgSend(panoramaView, "direction")}];
  }
}

- (void)panoramaRequestDidCompleteCapture:(id)capture withResponse:(id)response error:(id)error
{
  captureCopy = capture;
  responseCopy = response;
  errorCopy = error;
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  [_panoramaViewController finishedProcessingPanorama];
  [(CAMViewfinderViewController *)self _updateImageWellWithStillImageResponse:responseCopy forRequest:captureCopy error:errorCopy];

  if (errorCopy)
  {
    if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }

  else
  {
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:0 persistenceOptions:{objc_msgSend(captureCopy, "persistenceOptions")}];
    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [captureCopy persistenceUUID];
    v14 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

    [v14 populateFromStillImageCaptureResponse:responseCopy];
    [v14 publish];
  }

  [_panoramaViewController setAnalyticsCaptureEvent:0];
  _analyticsEventsByIdentifier2 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID2 = [captureCopy persistenceUUID];
  [_analyticsEventsByIdentifier2 removeObjectForKey:persistenceUUID2];
}

- (void)panoramaRequestDidCompleteLocalPersistence:(id)persistence withResponse:(id)response error:(id)error
{
  if (!error)
  {
    responseCopy = response;
    persistenceCopy = persistence;
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    persistenceOptions = [persistenceCopy persistenceOptions];

    [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:0 persistenceOptions:persistenceOptions];
  }
}

- (void)panoramaRequestDidCompleteRemotePersistence:(id)persistence withResponse:(id)response error:(id)error
{
  if (!error)
  {
    responseCopy = response;
    persistenceCopy = persistence;
    persistenceUUID = [responseCopy persistenceUUID];
    sessionIdentifier = [responseCopy sessionIdentifier];
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    persistenceOptions = [persistenceCopy persistenceOptions];

    [_cameraRollController processTransientAssetUpdate:responseCopy preventingInsertion:1 persistenceOptions:persistenceOptions];
    [_cameraRollController didPersistAssetWithUUID:persistenceUUID captureSession:sessionIdentifier];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, response];
}

- (void)panoramaRequest:(id)request didStopWithReason:(int64_t)reason
{
  requestCopy = request;
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  persistenceUUID = [requestCopy persistenceUUID];

  v9 = [_analyticsEventsByIdentifier objectForKeyedSubscript:persistenceUUID];

  [v9 populateFromPanoramaCaptureStoppingReason:reason];
}

- (BOOL)_isCapturingTimelapse
{
  if ([(CAMViewfinderViewController *)self _currentMode]!= 5)
  {
    return 0;
  }

  _timelapseController = [(CAMViewfinderViewController *)self _timelapseController];
  isCapturing = [_timelapseController isCapturing];

  return isCapturing;
}

- (BOOL)_startTimelapse
{
  _timelapseController = [(CAMViewfinderViewController *)self _timelapseController];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  delegate = [_timelapseController delegate];

  if (delegate != self)
  {
    [_timelapseController setDelegate:self];
  }

  v6 = [_timelapseController startCapturingWithCaptureDevice:-[CAMViewfinderViewController _currentDevice](self captureSession:{"_currentDevice"), objc_msgSend(_cameraRollController, "sessionIdentifier")}];
  if (v6)
  {
    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [_analyticsSessionEvent didCaptureTimelapseWithConfiguration:_currentGraphConfiguration];
  }

  return v6;
}

- (BOOL)_stopTimelapse
{
  _timelapseController = [(CAMViewfinderViewController *)self _timelapseController];
  v3 = [_timelapseController stopCapturingWithReasons:1];

  return v3;
}

- (void)timelapseController:(id)controller startedWithCaptureOrientation:(int64_t)orientation
{
  [(CAMViewfinderViewController *)self _updateUIForCapturing:1 animated:1];
  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController timelapseRequestDidStartCapturing];
  _generateAnalyticsCaptureEventForTimelapse = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventForTimelapse];
  [(CAMViewfinderViewController *)self set_timelapseAnalyticsEvent:_generateAnalyticsCaptureEventForTimelapse];
}

- (void)timelapseControllerStopped:(id)stopped
{
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:1];
  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  _idleController = [(CAMViewfinderViewController *)self _idleController];
  [_idleController timelapseRequestDidStopCapturing];
  v4 = +[CAMApplication appOrPlugInState]!= 2;
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl resetAnimated:v4];

  [(CAMViewfinderViewController *)self set_timelapseAnalyticsEvent:0];
}

- (void)timelapseController:(id)controller generatedPlaceholderResult:(id)result withThumbnailImage:(id)image forAssetUUID:(id)d inCaptureSession:(unsigned __int16)session
{
  sessionCopy = session;
  controllerCopy = controller;
  resultCopy = result;
  imageCopy = image;
  dCopy = d;
  if (resultCopy)
  {
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientAssetUpdate:resultCopy preventingInsertion:0 persistenceOptions:2];
  }

  if (imageCopy)
  {
    _cameraRollController2 = [(CAMViewfinderViewController *)self _cameraRollController];
    if ([_cameraRollController2 isCaptureSessionCurrent:sessionCopy])
    {
      [_cameraRollController2 willPersistAssetWithUUID:dCopy captureSession:sessionCopy];
      [(CAMViewfinderViewController *)self _presentImageWellImage:imageCopy uuid:dCopy animated:1];
      _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
      [_remoteShutterController sendThumbnailImage:imageCopy isVideo:1];
    }

    _timelapseAnalyticsEvent = [(CAMViewfinderViewController *)self _timelapseAnalyticsEvent];
    [resultCopy timelapseDuration];
    [_timelapseAnalyticsEvent populateDuration:?];

    _timelapseAnalyticsEvent2 = [(CAMViewfinderViewController *)self _timelapseAnalyticsEvent];
    [_timelapseAnalyticsEvent2 publish];
  }
}

- (void)timelapseController:(id)controller persistedPlaceholderResult:(id)result error:(id)error
{
  if (!error)
  {
    resultCopy = result;
    assetUUID = [resultCopy assetUUID];
    sessionIdentifier = [resultCopy sessionIdentifier];
    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController processTransientAssetUpdate:resultCopy preventingInsertion:1 persistenceOptions:2];

    [_cameraRollController didPersistAssetWithUUID:assetUUID captureSession:sessionIdentifier];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1, result];
}

- (void)generateAnalyticsSessionEventIfNeeded
{
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];

  if (!_analyticsSessionEvent)
  {
    v10 = +[CAMCaptureCapabilities capabilities];
    v4 = [CAMAnalyticsSessionEvent alloc];
    _supportedCaptureModes = [(CAMViewfinderViewController *)self _supportedCaptureModes];
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
    _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v9 = [(CAMAnalyticsSessionEvent *)v4 initWithCapabilities:v10 availableCaptureModes:_supportedCaptureModes currentCaptureMode:_currentMode currentCaptureDevice:_currentDevice callStatusMonitor:_callStatusMonitor];
    [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:v9];
  }
}

- (void)generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:(int64_t)mode captureDevice:(int64_t)device
{
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];

  if (_analyticsSessionEvent)
  {
    _analyticsSessionEvent2 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [_analyticsSessionEvent2 setFirstConfiguredCaptureMode:mode captureDevice:device];
  }

  else
  {
    _analyticsSessionEvent2 = +[CAMCaptureCapabilities capabilities];
    v8 = [CAMAnalyticsSessionEvent alloc];
    _supportedCaptureModes = [(CAMViewfinderViewController *)self _supportedCaptureModes];
    _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v11 = [(CAMAnalyticsSessionEvent *)v8 initWithCapabilities:_analyticsSessionEvent2 availableCaptureModes:_supportedCaptureModes currentCaptureMode:mode currentCaptureDevice:device callStatusMonitor:_callStatusMonitor];
    [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:v11];
  }
}

- (void)_handleSessionWasPrewarmed:(id)prewarmed
{
  userInfo = [prewarmed userInfo];
  v6 = [userInfo objectForKeyedSubscript:*MEMORY[0x1E6986A38]];

  [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didPrewarmWithReason:v6];
}

- (BOOL)handleURLIfNeeded:(id)needed
{
  v29 = *MEMORY[0x1E69E9840];
  neededCopy = needed;
  if ([neededCopy isConfigurationURL])
  {
    configurationRequest = [neededCopy configurationRequest];
    v6 = configurationRequest;
    v7 = configurationRequest != 0;
    if (configurationRequest)
    {
      if ([configurationRequest wantsQRCodeForSession])
      {
        v8 = +[CAMUserPreferences preferences];
        [v8 setForceEnableQRBanners:1];
        v9 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Launched with a URL request to force enable QR scanning", buf, 2u);
        }
      }

      requestedCaptureMode = [v6 requestedCaptureMode];
      if (requestedCaptureMode > 9)
      {
        v24 = 0;
      }

      else
      {
        v24 = off_1E76FA1E8[requestedCaptureMode];
      }

      requestedCaptureDevice = [v6 requestedCaptureDevice];
      if (requestedCaptureDevice > 0xB)
      {
        v12 = 0;
      }

      else
      {
        v12 = off_1E76F9E10[requestedCaptureDevice];
      }

      requestedCaptureMode2 = [v6 requestedCaptureMode];
      currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
      v15 = [v6 requestedCaptureDevice] - 1;
      if (v15 > 0xA)
      {
        v16 = 0;
      }

      else
      {
        v16 = qword_1A3A685B0[v15];
      }

      v17 = [(CAMViewfinderViewController *)self currentCaptureDevice]- 1;
      if (v17 > 0xA)
      {
        v18 = 0;
      }

      else
      {
        v18 = qword_1A3A685B0[v17];
      }

      if ([(CAMViewfinderViewController *)self isRecording])
      {
        v19 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543618;
          v26 = v24;
          v27 = 2114;
          v28 = v12;
          _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "Ignoring URL request mode:%{public}@ device:%{public}@ because device is recording", buf, 0x16u);
        }
      }

      else
      {
        v20 = os_log_create("com.apple.camera", "Camera");
        v21 = os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT);
        if (requestedCaptureMode2 == currentCaptureMode && v16 == v18)
        {
          if (v21)
          {
            *buf = 138543618;
            v26 = v24;
            v27 = 2114;
            v28 = v12;
            _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Ignoring URL request since already configured for mode:%{public}@ device:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          if (v21)
          {
            *buf = 138543618;
            v26 = v24;
            v27 = 2114;
            v28 = v12;
            _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Launched with a URL request for mode:%{public}@ device:%{public}@", buf, 0x16u);
          }

          -[CAMViewfinderViewController changeToMode:device:](self, "changeToMode:device:", [v6 requestedCaptureMode], objc_msgSend(v6, "requestedCaptureDevice"));
        }

        -[CAMViewfinderViewController generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:captureDevice:](self, "generateOrUpdateAnalyticsSessionEventIfNeededWithCaptureMode:captureDevice:", [v6 requestedCaptureMode], objc_msgSend(v6, "requestedCaptureDevice"));
      }

      _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
      if ([_cameraRollController isCameraRollViewControllerPresented])
      {
        [_cameraRollController dismissCameraRollViewControllerForced:1 animated:1];
      }
    }
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)_populateZoomForCaptureEvent:(id)event
{
  eventCopy = event;
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  _lastZoomInteractionType = [(CAMViewfinderViewController *)self _lastZoomInteractionType];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [_currentGraphConfiguration mode], objc_msgSend(_currentGraphConfiguration, "devicePosition"));
  if (_zoomControl)
  {
    zoomButtonContentType = [_zoomControl zoomButtonContentType];
    if (zoomButtonContentType == 2)
    {
LABEL_5:
      [_zoomControl displayZoomValue];
      v10 = v9;
      zoomPoints = [_zoomControl zoomPoints];
      [eventCopy populateZoomFromDisplayZoomValue:zoomPoints zoomPoints:_lastZoomInteractionType zoomInteractionType:v10];

      goto LABEL_8;
    }

    if (zoomButtonContentType != 1)
    {
      if (zoomButtonContentType)
      {
        goto LABEL_8;
      }

      goto LABEL_5;
    }

    [eventCopy populateZoomFromZoomButtonSymbol:objc_msgSend(_zoomControl zoomInteractionType:{"zoomButtonSymbol"), _lastZoomInteractionType}];
  }

  else
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [eventCopy populateZoomFromDisplayZoomValue:0 zoomPoints:_lastZoomInteractionType zoomInteractionType:?];
  }

LABEL_8:
  [eventCopy populateZoomFieldOfView:v7 graphConfiguration:_currentGraphConfiguration smartFramingSource:{-[CAMViewfinderViewController _smartFramingFieldOfViewSource](self, "_smartFramingFieldOfViewSource")}];
}

- (id)_generateAnalyticsCaptureEventWithRequest:(id)request burst:(BOOL)burst
{
  burstCopy = burst;
  requestCopy = request;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [[CAMAnalyticsCaptureEvent alloc] initWithGraphConfiguration:_currentGraphConfiguration outputToExternalStorage:[(CAMViewfinderViewController *)self _externalStorageOutputEnabled]];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  type = [requestCopy type];
  if (type == 2)
  {
    [(CAMAnalyticsCaptureEvent *)v8 populateFromPanoramaCaptureRequest:requestCopy];
    _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
    panoramaView = [_panoramaViewController panoramaView];
    -[CAMAnalyticsCaptureEvent populatePanoramaDirection:](v8, "populatePanoramaDirection:", [panoramaView direction]);
  }

  else if (type == 1)
  {
    _panoramaViewController = +[CAMUserPreferences preferences];
    [(CAMAnalyticsCaptureEvent *)v8 populateFromVideoCaptureRequest:requestCopy preferences:_panoramaViewController];
  }

  else
  {
    if (type)
    {
      goto LABEL_8;
    }

    _panoramaViewController = +[CAMUserPreferences preferences];
    [(CAMAnalyticsCaptureEvent *)v8 populateFromStillImageCaptureRequest:requestCopy burst:burstCopy preferences:_panoramaViewController];
  }

LABEL_8:
  [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v8];
  [(CAMAnalyticsCaptureEvent *)v8 populateDesiredFlashMode:[(CAMViewfinderViewController *)self _desiredFlashMode] desiredLivePhotoMode:[(CAMViewfinderViewController *)self _desiredLivePhotoMode] desiredHDRMode:[(CAMViewfinderViewController *)self _desiredHDRMode] timerDuration:[(CAMViewfinderViewController *)self _resolvedTimerDuration]];
  [(CAMAnalyticsCaptureEvent *)v8 populateDesiredTorchMode:[(CAMViewfinderViewController *)self _desiredTorchMode]];
  [_previewViewController baselineExposureBias];
  v14 = v13;
  [_previewViewController cachedExposureTargetBias];
  v16 = v15;
  [_previewViewController totalExposureBias];
  LODWORD(v18) = v17;
  LODWORD(v19) = v14;
  LODWORD(v20) = v16;
  [(CAMAnalyticsCaptureEvent *)v8 populateExposureSliderBias:v19 exposureTapAndBias:v20 totalExposureBias:v18];
  _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  v23 = v22;
  [(CAMViewfinderViewController *)self _portraitModeApertureValue];
  v25 = v24;
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  v38 = requestCopy;
  [(CAMAnalyticsCaptureEvent *)v8 populatePortraitStatus:_shallowDepthOfFieldStatus lightingEffectIntensity:[(CAMViewfinderViewController *)self _isDepthSuggestionAllowedForCurrentConfigurationIsBurst:burstCopy] apertureValue:requestCopy zoomFactor:v23 isDepthSuggestionAllowed:v25 request:v26];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  -[CAMAnalyticsCaptureEvent populateDesiredNightModeControlMode:resolvedNightModeControlMode:resolvedNightMode:nightModeStatus:](v8, "populateDesiredNightModeControlMode:resolvedNightModeControlMode:resolvedNightMode:nightModeStatus:", -[CAMViewfinderViewController _desiredNightModeControlMode](self, "_desiredNightModeControlMode"), -[CAMViewfinderViewController _resolvedNightModeControlMode](self, "_resolvedNightModeControlMode"), -[CAMViewfinderViewController _resolvedNightMode](self, "_resolvedNightMode"), [_captureController nightModeStatus]);
  mode = [_currentGraphConfiguration mode];
  devicePosition = [_currentGraphConfiguration devicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  if (![CAMConflictingControlConfiguration shouldDisableMacroForLockedPortraitForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat optionalDepthEffectEnabled:v31, [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]])
  {
    _autoMacroSuggested = [(CAMViewfinderViewController *)self _autoMacroSuggested];
    v33 = _autoMacroSuggested && [(CAMViewfinderViewController *)self _autoMacroActive];
    [(CAMAnalyticsCaptureEvent *)v8 populateDesiredMacroMode:[(CAMViewfinderViewController *)self _desiredMacroMode] isMacroCapture:v33 isMacroSuggested:_autoMacroSuggested];
  }

  if (![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    -[CAMAnalyticsCaptureEvent populateSharedLibraryMode:](v8, "populateSharedLibraryMode:", [_librarySelectionController sharedLibraryMode]);
  }

  [(CAMAnalyticsCaptureEvent *)v8 populateObjectResultsWithNumberOfFaces:[(CAMViewfinderViewController *)self _faceCount] numberOfCats:[(CAMViewfinderViewController *)self _catCount] numberOfDogs:[(CAMViewfinderViewController *)self _dogCount]];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  deviceOrientation = [_motionController deviceOrientation];

  [(CAMAnalyticsCaptureEvent *)v8 populateDeviceOrientation:deviceOrientation isDeviceOrientationLocked:CAMIsDeviceOrientationLocked()];

  return v8;
}

- (id)_generateAnalyticsCaptureEventForTimelapse
{
  v3 = [CAMAnalyticsCaptureEvent alloc];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMAnalyticsCaptureEvent *)v3 initWithGraphConfiguration:_currentGraphConfiguration outputToExternalStorage:0];

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = +[CAMUserPreferences preferences];
  v11 = [_currentGraphConfiguration2 device] - 1;
  if (v11 > 0xA)
  {
    v12 = 0;
  }

  else
  {
    v12 = qword_1A3A685B0[v11];
  }

  v13 = [v10 mirrorCameraCapturesForDevicePosition:v12 mode:5];

  _currentCaptureRequestOrigin = [(CAMViewfinderViewController *)self _currentCaptureRequestOrigin];
  v15 = [MEMORY[0x1E695DF00] now];
  [(CAMAnalyticsCaptureEvent *)v5 populateForTimelapseCaptureOrientation:captureOrientation captureMirrored:v13 origin:_currentCaptureRequestOrigin pressType:-1 startDate:v15];

  [(CAMViewfinderViewController *)self _populateZoomForCaptureEvent:v5];
  [_previewViewController baselineExposureBias];
  v17 = v16;
  [_previewViewController cachedExposureTargetBias];
  v19 = v18;
  [_previewViewController totalExposureBias];
  LODWORD(v21) = v20;
  LODWORD(v22) = v17;
  LODWORD(v23) = v19;
  [(CAMAnalyticsCaptureEvent *)v5 populateExposureSliderBias:v22 exposureTapAndBias:v23 totalExposureBias:v21];

  return v5;
}

- (int64_t)_persistenceOptionsForBehavior:(unint64_t)behavior allowingOptionalLocalPersistence:(BOOL)persistence
{
  persistenceCopy = persistence;
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v7 = 2;
  if (behavior == 2)
  {
    v7 = 1;
  }

  if (behavior == 3)
  {
    v7 = !persistenceCopy;
  }

  if (_externalStorageOutputEnabled)
  {
    return 3;
  }

  else
  {
    return v7;
  }
}

- (int64_t)_temporaryPersistenceOptionsForBehavior:(unint64_t)behavior
{
  if (behavior - 1 > 2)
  {
    return 0;
  }

  else
  {
    return qword_1A3A68350[behavior - 1];
  }
}

- (void)_setResolvedTimerDuration:(int64_t)duration
{
  if (self->__resolvedTimerDuration != duration)
  {
    self->__resolvedTimerDuration = duration;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setTimerDuration:duration];

    _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
    if (_timerIndicatorView)
    {
      _timerIndicatorView2 = [(CAMViewfinderViewController *)self _timerIndicatorView];
    }

    else
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      _timerIndicatorView2 = [_fullscreenViewfinder timerIndicator];
    }

    if ((duration - 1) > 2)
    {
      v9 = 0;
    }

    else
    {
      v9 = qword_1A3A68368[duration - 1];
    }

    [_timerIndicatorView2 resetWithNumberOfTicks:v9 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
  }
}

- (void)_setTimerDurationAndUpdateUI:(int64_t)i animated:(BOOL)animated
{
  animatedCopy = animated;
  [(CAMTimerButton *)self->__timerButton setDuration:?];
  [(CAMViewfinderViewController *)self _setResolvedTimerDuration:i];
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  timerButton = [_controlDrawer timerButton];
  [timerButton setTimerDuration:i];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  timerIndicator = [controlStatusBar timerIndicator];
  [timerIndicator setTimerDuration:i];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration2 isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:animatedCopy];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setTimerDuration:i];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if (_timerIndicatorView)
  {
    _timerIndicatorView2 = [(CAMViewfinderViewController *)self _timerIndicatorView];
  }

  else
  {
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _timerIndicatorView2 = [_fullscreenViewfinder2 timerIndicator];
  }

  if ((i - 1) > 2)
  {
    v17 = 0;
  }

  else
  {
    v17 = qword_1A3A68368[i - 1];
  }

  [_timerIndicatorView2 resetWithNumberOfTicks:v17 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
}

- (void)_setCapturingFromTimer:(BOOL)timer
{
  if (self->__capturingFromTimer != timer)
  {
    timerCopy = timer;
    self->__capturingFromTimer = timer;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setIsCapturingFromTimer:timerCopy];

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capturing from timer"];
  }
}

- (void)_startCountdownForCaptureTimer
{
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  -[CAMViewfinderViewController set_cachedSharedLibraryTimerState:](self, "set_cachedSharedLibraryTimerState:", [_librarySelectionController sharedLibraryMode]);

  [(CAMViewfinderViewController *)self _setCapturingFromTimer:1];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _setupAndStartSynchronizedCaptureTimerDelegate];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:1 animated:1];

  [(CAMViewfinderViewController *)self _indicateCaptureTimerProgressUsingTorch];
}

- (void)_stopCountdownForCaptureTimer
{
  v19 = *MEMORY[0x1E69E9840];
  _remainingCaptureTimerTicks = [(CAMViewfinderViewController *)self _remainingCaptureTimerTicks];
  [(CAMViewfinderViewController *)self _setCapturingFromTimer:0];
  [(CAMViewfinderViewController *)self _teardownSynchronizedCaptureTimerDelegate];
  [(CAMViewfinderViewController *)self _teardownBurstTimer];
  [(CAMViewfinderViewController *)self _stopCapturingBurst];
  if ([(CAMViewfinderViewController *)self _resetTimerDurationAfterDelayedCapture])
  {
    if ([(CAMViewfinderViewController *)self _isHeadphonesEventCaptureWithUserSpecifiedDuration])
    {
      [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:[(CAMViewfinderViewController *)self _resolvedTimerDuration] animated:1];
      [(CAMViewfinderViewController *)self set_isHeadphonesEventCaptureWithUserSpecifiedDuration:0];
    }

    else
    {
      [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:0 animated:1];
    }
  }

  [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:0];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:0 animated:1];

  if (![(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];
  }

  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  sharedLibraryMode = [_librarySelectionController sharedLibraryMode];

  if ([(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState]!= sharedLibraryMode)
  {
    v8 = os_log_create("com.apple.camera", "SharedLibrary");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      v9 = CAMSharedLibraryModeDescription(sharedLibraryMode);
      v17 = 138543362;
      v18 = v9;
      _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Updating library selection mode to %{public}@ after timer capture ended", &v17, 0xCu);
    }

    [(CAMViewfinderViewController *)self librarySelectionDidChangeSharedLibraryMode:sharedLibraryMode];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _stopCaptureTimerProgressUsingTorch];
  if (_remainingCaptureTimerTicks)
  {
    [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:0];
    _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

    if (_currentHeadphonesCaptureEvent)
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Timer countdown was interrupted."];
    }

    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController countdownCanceled];

    [(CAMViewfinderViewController *)self _cancelCTMCapture];
    if ([(CAMViewfinderViewController *)self _resolvedTimerDuration])
    {
      _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
      if (_timerIndicatorView)
      {
        _timerIndicatorView2 = [(CAMViewfinderViewController *)self _timerIndicatorView];
      }

      else
      {
        _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        _timerIndicatorView2 = [_fullscreenViewfinder timerIndicator];
      }

      v15 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
      if (v15 > 2)
      {
        v16 = 0;
      }

      else
      {
        v16 = qword_1A3A68368[v15];
      }

      [_timerIndicatorView2 resetWithNumberOfTicks:v16 showBeforeAnimationStarts:{-[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") != 1}];
    }
  }
}

- (BOOL)_shouldUseBurstForCaptureTimer
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v4 = +[CAMCaptureCapabilities capabilities];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  v27 = [v4 isFlashSupportedForDevicePosition:_currentDevicePosition];
  _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  v28 = _captureController;
  if ([(CAMViewfinderViewController *)self _resolvedFlashMode]== 2)
  {
    isFlashActive = [_captureController isFlashActive];
  }

  else
  {
    isFlashActive = 0;
  }

  v9 = _resolvedFlashMode == 1;
  v10 = [v4 isHDRSupportedForDevicePosition:_currentDevicePosition];
  _resolvedHDRMode = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  v12 = [v4 isLivePhotoSupportedForDevicePosition:_currentDevicePosition];
  v13 = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode]- 1;
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), _currentDevice}];

  v16 = 0;
  v17 = v27 & (v9 | isFlashActive);
  if (v10 && _resolvedHDRMode == 1)
  {
    v16 = [v4 isSmartHDRSupported] ^ 1;
  }

  if (v13 < 2)
  {
    v18 = v12;
  }

  else
  {
    v18 = 0;
  }

  _isNightModeActiveForCurrentSettings = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _resolvedPhotoResolution = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  isDisablingMultipleCaptureFeatures = [(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
  _shouldUsePhotoModePortraitEffect = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v24 = 0;
  if (v17 & 1 | ((v15 & 1) == 0) || (v16 & 1) != 0 || (v18 & 1) != 0 || isDisablingMultipleCaptureFeatures)
  {
    v25 = v28;
  }

  else
  {
    v25 = v28;
    if (!_isNightModeActiveForCurrentSettings && _resolvedRAWMode != 1)
    {
      v24 = _resolvedPhotoResolution != 3 && !_shouldUsePhotoModePortraitEffect;
    }
  }

  return v24;
}

- (void)_setupAndStartSynchronizedCaptureTimerDelegate
{
  _synchronizedCaptureTimerDelegate = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  if (_synchronizedCaptureTimerDelegate)
  {
    [(CAMViewfinderViewController *)self _teardownSynchronizedCaptureTimerDelegate];
  }

  v4 = objc_alloc_init(CAMAnimationDelegate);
  [(CAMViewfinderViewController *)self _setSynchronizedCaptureTimerDelegate:v4];
  objc_initWeak(&location, self);
  objc_initWeak(&from, v4);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke;
  v8[3] = &unk_1E76F8580;
  objc_copyWeak(&v9, &location);
  [(CAMAnimationDelegate *)v4 setStart:v8];
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke_2;
  v5[3] = &unk_1E76F9620;
  objc_copyWeak(&v6, &location);
  objc_copyWeak(&v7, &from);
  [(CAMAnimationDelegate *)v4 setCompletion:v5];
  [(CAMViewfinderViewController *)self _startSynchronizedCaptureTimerDelegate];
  objc_destroyWeak(&v7);
  objc_destroyWeak(&v6);
  objc_destroyWeak(&v9);
  objc_destroyWeak(&from);
  objc_destroyWeak(&location);
}

void __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
}

void __77__CAMViewfinderViewController__setupAndStartSynchronizedCaptureTimerDelegate__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v2 = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _synchronizedCaptureTimerDelegateFired:v2];
}

- (void)_startSynchronizedCaptureTimerDelegate
{
  _synchronizedCaptureTimerDelegate = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  v3 = [(CAMViewfinderViewController *)self _resolvedTimerDuration]- 1;
  if (v3 > 2)
  {
    v4 = 0;
  }

  else
  {
    v4 = qword_1A3A68368[v3];
  }

  [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:v4];
  _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if (!_timerIndicatorView)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _timerIndicatorView = [_fullscreenViewfinder timerIndicator];
  }

  [_timerIndicatorView stopCountdown];
  [_timerIndicatorView resetWithNumberOfTicks:v4 showBeforeAnimationStarts:0];
  [_timerIndicatorView startCountdownWithAnimationDelegate:_synchronizedCaptureTimerDelegate];
}

- (void)_teardownSynchronizedCaptureTimerDelegate
{
  _synchronizedCaptureTimerDelegate = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  if (_synchronizedCaptureTimerDelegate)
  {
    v4 = _synchronizedCaptureTimerDelegate;
    [(CAMViewfinderViewController *)self _setSynchronizedCaptureTimerDelegate:0];
    _synchronizedCaptureTimerDelegate = v4;
  }
}

- (void)_synchronizedCaptureTimerDelegateFired:(id)fired
{
  firedCopy = fired;
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _synchronizedCaptureTimerDelegate = [(CAMViewfinderViewController *)self _synchronizedCaptureTimerDelegate];
  _captureController = [(CAMViewfinderViewController *)self _captureController];

  if (!_isCapturingFromTimer || _synchronizedCaptureTimerDelegate != firedCopy)
  {
    goto LABEL_17;
  }

  v7 = [(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]- 1;
  [(CAMViewfinderViewController *)self _setRemainingCaptureTimerTicks:v7];
  _shouldUseBurstForCaptureTimer = [(CAMViewfinderViewController *)self _shouldUseBurstForCaptureTimer];
  isCapturingBurst = [_captureController isCapturingBurst];
  if (_shouldUseBurstForCaptureTimer && v7 == 1)
  {
    [(CAMViewfinderViewController *)self _setupBurstTimerWithDelay:0.6];
LABEL_11:
    _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
    [_timerIndicatorView decrement];

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    timerIndicator = [_fullscreenViewfinder timerIndicator];
    [timerIndicator decrement];

    _currentBurstTimer = [(CAMViewfinderViewController *)self _currentBurstTimer];

    if (!_currentBurstTimer)
    {
      [(CAMViewfinderViewController *)self _indicateCaptureTimerProgressUsingTorch];
    }

    goto LABEL_17;
  }

  if (v7)
  {
    v10 = 1;
  }

  else
  {
    v10 = isCapturingBurst;
  }

  if ((v10 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:[(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable]];
    _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

    if (_currentStillImageCaptureMomentSettings)
    {
      [(CAMViewfinderViewController *)self _commitCTMCaptureWithType:1];
    }

    else
    {
      [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
    goto LABEL_17;
  }

  if (v7)
  {
    goto LABEL_11;
  }

LABEL_17:
}

- (void)_indicateCaptureTimerProgressUsingTorch
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 isTorchPatternSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    _torchPatternController = [(CAMViewfinderViewController *)self _torchPatternController];
    _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
    if ((_resolvedTimerDuration - 2) >= 2)
    {
      if (_resolvedTimerDuration != 1)
      {
        goto LABEL_7;
      }
    }

    else if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]> 3)
    {
      [_torchPatternController blink];
LABEL_7:

      goto LABEL_8;
    }

    [_torchPatternController doubleBlink];
    goto LABEL_7;
  }

LABEL_8:
}

- (void)_stopCaptureTimerProgressUsingTorch
{
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 isTorchPatternSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    _torchPatternController = [(CAMViewfinderViewController *)self _torchPatternController];
    [_torchPatternController stopPerformingPattern];
  }
}

- (double)timeIntervalForDuration:(int64_t)duration
{
  result = 0.0;
  if ((duration - 1) <= 2)
  {
    return dbl_1A3A68380[duration - 1];
  }

  return result;
}

- (void)setConfigurationDelegate:(id)delegate
{
  obj = delegate;
  WeakRetained = objc_loadWeakRetained(&self->_configurationDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_configurationDelegate, obj);
    p_configurationDelegateFlags = &self->_configurationDelegateFlags;
    p_configurationDelegateFlags->respondsToWillBeginConfiguration = objc_opt_respondsToSelector() & 1;
    p_configurationDelegateFlags->respondsToDidCompleteConfiguration = objc_opt_respondsToSelector() & 1;
  }
}

- (void)_handleUserChangedToDevice:(int64_t)device
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:_currentMode device:device];
}

- (void)handleUserChangedToMode:(int64_t)mode
{
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:mode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:v6];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setControlDrawerExpanded:0 forReason:3 animated:1];
}

- (void)handleUserChangedToMode:(int64_t)mode device:(int64_t)device
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];

  v9 = [(CAMViewfinderViewController *)self _shouldResetZoomForChangeFromMode:mode toMode:mode];
  if (v9)
  {
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    -[CAMViewfinderViewController set_desiredFieldOfView:](self, "set_desiredFieldOfView:", -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [_motionController captureOrientation]));
  }

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:mode device:device fromGraphConfiguration:?];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  v13 = v12;
  if ([v11 trueVideoEnabled] && (objc_msgSend(_currentGraphConfiguration2, "trueVideoEnabled") & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setTrueVideoSourceZoomFactor:v13];
  }

  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSmartFramingSupportedForMode:objc_msgSend(v11 devicePosition:{"mode"), objc_msgSend(v11, "devicePosition")}];

  if ([_currentGraphConfiguration2 trueVideoEnabled] && (v16 = objc_msgSend(v11, "mode"), v16 == -[CAMViewfinderViewController _trueVideoSourceCaptureMode](self, "_trueVideoSourceCaptureMode")) && !objc_msgSend(v11, "mode"))
  {
    v17 = ([v11 devicePosition] == 1) & (v15 ^ 1);
  }

  else
  {
    v17 = 0;
  }

  if (v9)
  {
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v11];
LABEL_14:
    v13 = v18;
    goto LABEL_15;
  }

  if (v17)
  {
    [(CAMViewfinderViewController *)self _trueVideoSourceZoomFactor];
    goto LABEL_14;
  }

  if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    +[CAMZoomControlUtilities equivalentZoomFactor:forDevice:fromDevice:](CAMZoomControlUtilities, "equivalentZoomFactor:forDevice:fromDevice:", -[CAMViewfinderViewController _resolvedDeviceForZoomFactor:fromGraphConfiguration:toGraphConfiguration:](self, "_resolvedDeviceForZoomFactor:fromGraphConfiguration:toGraphConfiguration:", _currentGraphConfiguration2, v11, v13), [_currentGraphConfiguration2 device], v13);
    v13 = v19;
    if ([(CAMViewfinderViewController *)self _useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:v11])
    {
      v20 = +[CAMCaptureCapabilities capabilities];
      [v20 maximumZoomFactorForMode:objc_msgSend(v11 device:"mode") videoConfiguration:device videoStabilizationStrength:{objc_msgSend(v11, "videoConfiguration"), objc_msgSend(v11, "videoStabilizationStrength")}];
      v22 = v21;

      if (v13 >= v22)
      {
        v13 = v22;
      }
    }

    v23 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [v11 mode], objc_msgSend(v11, "devicePosition"));
    if (v23)
    {
      v24 = v23;
      v25 = +[CAMCaptureCapabilities capabilities];
      [v25 zoomFactorForSmartFramingFieldOfView:v24];
      v13 = v26;
    }
  }

LABEL_15:
  [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:device zoomFactor:v13];
}

- (void)_performChangeFromGraphConfiguration:(id)configuration toGraphConfiguration:(id)graphConfiguration zoomFactor:(double)factor deferIfConfigurationInFlight:(BOOL)flight
{
  flightCopy = flight;
  v18 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  graphConfigurationCopy = graphConfiguration;
  _hasInFlightConfiguration = [(CAMViewfinderViewController *)self _hasInFlightConfiguration];
  [(CAMViewfinderViewController *)self _willChangeToGraphConfiguration:graphConfigurationCopy zoomFactor:configurationCopy fromGraphConfiguration:1 animated:factor];
  if (flightCopy && _hasInFlightConfiguration)
  {
    v13 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 138543618;
      v15 = graphConfigurationCopy;
      v16 = 2114;
      v17 = configurationCopy;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Deferring change to: %{public}@, from: %{public}@", &v14, 0x16u);
    }

    [(CAMViewfinderViewController *)self _setNeedsDeferredGraphConfiguration:1];
  }

  else
  {
    [(CAMViewfinderViewController *)self _changeToGraphConfiguration:graphConfigurationCopy zoomFactor:configurationCopy fromGraphConfiguration:factor];
  }
}

- (void)handleUserChangedToMode:(int64_t)mode device:(int64_t)device zoomFactor:(double)factor
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  if (mode != mode || device != device || v11 != factor)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v13 = [_fullscreenViewfinder trueVideoState] == 0;

    v14 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:mode device:device fromGraphConfiguration:_currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v14 zoomFactor:v13 deferIfConfigurationInFlight:factor];
  }
}

- (void)_willChangeToGraphConfiguration:(id)configuration zoomFactor:(double)factor fromGraphConfiguration:(id)graphConfiguration animated:(BOOL)animated
{
  animatedCopy = animated;
  v100 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  graphConfigurationCopy = graphConfiguration;
  _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  [_lensSmudgeDisplayFrontState modeWillChange];

  _lensSmudgeDisplayBackState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  [_lensSmudgeDisplayBackState modeWillChange];

  v14 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543874;
    v95 = configurationCopy;
    v96 = 2114;
    v97 = graphConfigurationCopy;
    v98 = 2048;
    factorCopy = factor;
    _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Will change to: %{public}@ from: %{public}@ with zoomFactor=%.3f", buf, 0x20u);
  }

  v91 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  mode2 = [graphConfigurationCopy mode];
  device2 = [graphConfigurationCopy device];
  _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
  [_livePhotoButton interruptEnablingAnimation];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  livePhotoIndicator = [controlStatusBar livePhotoIndicator];
  [livePhotoIndicator stopAnimating];

  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  [_timerCache cancelAllTimers];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _setReconfiguring:1];
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:animatedCopy];
  [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:configurationCopy];
  if (animatedCopy)
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:configurationCopy];
  }

  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController willChangeToGraphConfiguration:configurationCopy];
  if (![(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    [(CAMViewfinderViewController *)self _closeViewfinderForChangeFromMode:mode2 toMode:mode fromDevice:device2 toDevice:device];
  }

  v84 = _previewViewController;
  if (![(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
  {
    _modeDial = [(CAMViewfinderViewController *)self _modeDial];
    [_modeDial reloadData];
    [_modeDial setSelectedMode:mode animated:animatedCopy];
  }

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:configurationCopy isCapturing:0 animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:configurationCopy];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsGraphConfigurationReconfiguring:1];

  [(CAMViewfinderViewController *)self _pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:configurationCopy isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
  v25 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", mode, [configurationCopy videoConfiguration], objc_msgSend(configurationCopy, "devicePosition"), objc_msgSend(configurationCopy, "trueVideoEnabled"));
  [viewfinderView setDesiredAspectRatio:v25];
  if (mode)
  {
    v26 = mode == 6;
  }

  else
  {
    v26 = 1;
  }

  v28 = v26 && mode2 == 4;
  if (mode == 4 || v28)
  {
    [viewfinderView setMaskingAspectRatio:v25 animated:animatedCopy];
  }

  v82 = v25;
  [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:configurationCopy fromGraphConfiguration:graphConfigurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:configurationCopy];
  if ([configurationCopy mode] != 8)
  {
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:configurationCopy animated:animatedCopy];
  }

  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:configurationCopy animated:animatedCopy];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v30 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", configurationCopy, [_callStatusMonitor isCallActive]);

  if (v30)
  {
    [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:animatedCopy];
  }

  v31 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  if (v31)
  {
    v32 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:configurationCopy];
    v33 = v32;
    v34 = 0.25;
    if (!animatedCopy)
    {
      v34 = 0.0;
    }

    [v32 setVisible:1 animationDuration:0 completion:v34];
  }

  chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator2 setIsShowingOverlayDescription:v31];

  if ([v91 isLivePhotoSupported])
  {
    v37 = mode == 4 && mode2 == 0;
    v39 = mode2 == 4 && mode == 0 || v37;
  }

  else
  {
    v39 = 0;
  }

  v88 = graphConfigurationCopy;
  v41 = mode2 != mode && (mode == 6 || mode2 == 6);
  v87 = viewfinderView;
  _useMessagesControls = [(CAMViewfinderViewController *)self _useMessagesControls];
  v43 = mode2 != 3 && _useMessagesControls;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke;
  aBlock[3] = &__block_descriptor_33_e19_v20__0__UIView_8B16l;
  v93 = animatedCopy;
  v86 = _Block_copy(aBlock);
  if (((v39 | v41) & 1) != 0 || v43)
  {
    _topBar = [(CAMViewfinderViewController *)self _topBar];
    _expandedMenuButton = [_topBar _expandedMenuButton];
    v46 = _expandedMenuButton != 0;

    v81 = v46 & [_topBar _shouldExpandButtonsHorizontally];
    if ((v81 & 1) == 0 && ![(CAMViewfinderViewController *)self _shouldHideLivePhotoButtonForGraphConfiguration:configurationCopy])
    {
      v86[2](v86, _livePhotoButton, 0);
    }

    if (([v91 isDepthEffectApertureSupported] & v41) == 1)
    {
      _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];

      if (!_apertureButton)
      {
        [(CAMViewfinderViewController *)self _createApertureButtonIfNecessary];
        v48 = ([(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:v88]^ 1);
        _apertureButton2 = [(CAMViewfinderViewController *)self _apertureButton];
        [_apertureButton2 setAlpha:v48];
      }

      v50 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:configurationCopy];
      _apertureButton3 = [(CAMViewfinderViewController *)self _apertureButton];
      v86[2](v86, _apertureButton3, v50);

      [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:configurationCopy zoomFactor:factor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:configurationCopy zoomFactor:factor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:configurationCopy zoomFactor:0 animated:factor];
    }

    v52 = [v91 isPortraitEffectIntensitySupportedForMode:mode];
    v53 = [v91 isPortraitEffectIntensitySupportedForMode:mode2];
    v54 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:mode device:device];
    if (((v52 & 1) != 0 || v53) && ([v91 isPortraitEffectIntensitySupportedForLightingType:v54] & v41) == 1)
    {
      [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
      v55 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:configurationCopy];
      _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
      v86[2](v86, _intensityButton, v55);
    }

    if (v43)
    {
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:configurationCopy];
      [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:configurationCopy animated:0];
      [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:configurationCopy animated:animatedCopy];
    }

    [_topBar configureForMode:mode animated:v81 ^ 1u];
  }

  v57 = [(CAMViewfinderViewController *)self _shouldResetZoomForChangeFromMode:mode2 toMode:mode];
  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v59 = -[CAMViewfinderViewController _isFrontRearSimultaneousVideoActiveForMode:devicePosition:](self, "_isFrontRearSimultaneousVideoActiveForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition"));
  if (v57 || _trueVideoIsActive || v59)
  {
    if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
    {
      v86[2](v86, self->__zoomSlider, 1);
    }

    if (![(CAMViewfinderViewController *)self _isReconfiguringForZoomChange]&& !_trueVideoIsActive)
    {
      if (animatedCopy)
      {
        v60 = 2;
      }

      else
      {
        v60 = 0;
      }

      [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:v60];
    }

    [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:factor];
    [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
    [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:configurationCopy animated:animatedCopy];
    _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];

    if (_zoomSlider)
    {
      [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:factor];
      v63 = v62;
      _zoomSlider2 = [(CAMViewfinderViewController *)self _zoomSlider];
      *&v65 = v63;
      [_zoomSlider2 setValue:animatedCopy animated:v65];
    }

    if (!_trueVideoIsActive)
    {
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }
  }

  v66 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:v88];
  if (v66 != [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:configurationCopy])
  {
    [(CAMViewfinderViewController *)self _prepareTopBarForOrientationChangeDuringConfiguration];
  }

  [v87 setAutomaticallyAdjustsTopBarOrientation:{-[CAMViewfinderViewController _shouldRotateTopBarForGraphConfiguration:](self, "_shouldRotateTopBarForGraphConfiguration:", configurationCopy)}];
  if (mode2 != mode)
  {
    [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:1];
  }

  if ((device2 - 1) > 0xA)
  {
    v67 = 0;
  }

  else
  {
    v67 = qword_1A3A685B0[device2 - 1];
  }

  v68 = [(CAMViewfinderViewController *)self _wantsLightingControlForMode:mode2 devicePosition:v67];
  if ((device - 1) > 0xA)
  {
    v69 = 0;
  }

  else
  {
    v69 = qword_1A3A685B0[device - 1];
  }

  if ((v68 & [(CAMViewfinderViewController *)self _wantsLightingControlForMode:mode devicePosition:v69]) == 1)
  {
    v70 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [v88 mode], objc_msgSend(v88, "device"));
    v71 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [configurationCopy mode], objc_msgSend(configurationCopy, "device"));
    if (v71 != v70)
    {
      [(CAMViewfinderViewController *)self _setLightingType:v71 forMode:6];
      [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
    }

    [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:configurationCopy animated:1];
  }

  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", mode, [configurationCopy trueVideoEnabled]);
  *&v72 = v72;
  [v84 setBaselineExposureBias:v72];
  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0 animated:animatedCopy];
  _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlDrawer = [_fullscreenViewfinder3 controlDrawer];
  [controlDrawer setExpanded:0 forControlType:10 animated:1 updatePreferredDrawerControl:0];

  _fullscreenViewfinder4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlDrawer2 = [_fullscreenViewfinder4 controlDrawer];
  [controlDrawer2 setExpanded:0 forControlType:11 animated:1 updatePreferredDrawerControl:0];

  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_analyticsSessionEvent countEventsFromAnalyticsVisionSession:_visionAnalyticsSession];

  _visionAnalyticsSession2 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession2 publish];

  [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:0];
  if ((mode2 != mode || device != device2) && self->_configurationDelegateFlags.respondsToWillBeginConfiguration)
  {
    configurationDelegate = [(CAMViewfinderViewController *)self configurationDelegate];
    [configurationDelegate cameraViewControllerWillBeginConfigurationForCaptureMode:mode captureDevice:device];
  }

  if ([(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
  {
    [_fullscreenViewfinder2 setViewportAspectRatio:v82 animated:1];
  }

  [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:configurationCopy];
  [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:configurationCopy];
  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
}

void __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke(uint64_t a1, void *a2, char a3)
{
  v5 = a2;
  if (*(a1 + 32))
  {
    v6 = 0.25;
  }

  else
  {
    v6 = 0.0;
  }

  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __106__CAMViewfinderViewController__willChangeToGraphConfiguration_zoomFactor_fromGraphConfiguration_animated___block_invoke_2;
  v8[3] = &unk_1E76F7850;
  v9 = v5;
  v10 = a3;
  v7 = v5;
  [CAMView animateIfNeededWithDuration:v8 animations:v6];
}

- (void)_closeViewfinderForChangeFromMode:(int64_t)mode toMode:(int64_t)toMode fromDevice:(int64_t)device toDevice:(int64_t)toDevice
{
  if ((device - 1) > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[device - 1];
  }

  if ((toDevice - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[toDevice - 1];
  }

  v10 = mode != toMode || v7 == v8;
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:v10];
}

- (void)_didChangeToGraphConfiguration:(id)configuration forDesiredConfiguration:(id)desiredConfiguration requestID:(int)d
{
  *&v57[5] = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  v10 = device;
  if ((device - 8) < 3 || device == 11 || device == 1)
  {
    v11 = 0;
    v12 = 1;
  }

  else
  {
    v12 = 0;
    v11 = 1;
  }

  v13 = +[CAMCaptureCapabilities capabilities];
  [(CAMViewfinderViewController *)self set_completedInitialConfiguration:1];
  _configuredGraphConfiguration = [(CAMViewfinderViewController *)self _configuredGraphConfiguration];
  [(CAMViewfinderViewController *)self _setConfiguredGraphConfiguration:configurationCopy];
  CAMSignpostWithIDAndArgs(10, 0xEEEEB0B5B2B2EEEELL, mode, v10, 0, 0);
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  _lastConfigurationRequestID = [(CAMViewfinderViewController *)self _lastConfigurationRequestID];
  if (_lastConfigurationRequestID == -1 || (v16 = _lastConfigurationRequestID, _lastConfigurationRequestID == d))
  {
    v51 = v11;
    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:0xFFFFFFFFLL];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    if ([(CAMViewfinderViewController *)self _needsDeferredGraphConfiguration])
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      v19 = v18;
      v20 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v55 = _currentGraphConfiguration;
        v56 = 2048;
        *v57 = v19;
        _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Performing deferred change to: %{public}@ with zoom factor %.3f", buf, 0x16u);
      }

      [(CAMViewfinderViewController *)self _changeToGraphConfiguration:_currentGraphConfiguration zoomFactor:configurationCopy fromGraphConfiguration:v19];
    }

    else
    {
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      if (mode == [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode]&& [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
      {
        [(CAMViewfinderViewController *)self _trueVideoStartCapture];
      }

      [(CAMViewfinderViewController *)self _setCurrentGraphConfiguration:configurationCopy];
      [(CAMViewfinderViewController *)self _setReconfiguring:0];
      if ([(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
      {
        [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:0];
        v21 = os_log_create("com.apple.camera", "Zoom");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
          *buf = 134217984;
          v55 = v22;
          _os_log_impl(&dword_1A3640000, v21, OS_LOG_TYPE_DEFAULT, "Changing to zoom factor %.3f after reconfig", buf, 0xCu);
        }

        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [_captureController changeToVideoZoomFactor:configurationCopy graphConfiguration:?];
      }

      dCopy = d;
      [(CAMViewfinderViewController *)self _setPerformingTopBarOrientationChange:0];
      viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
      v24 = [(CAMViewfinderViewController *)self _aspectRatioForMode:mode videoConfiguration:[configurationCopy videoConfiguration] devicePosition:v12 trueVideoEnabled:[configurationCopy trueVideoEnabled]];
      [viewfinderView setDesiredAspectRatio:v24];
      v50 = viewfinderView;
      [viewfinderView setMaskingAspectRatio:v24];
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder setViewportAspectRatio:v24 animated:1];
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:configurationCopy];
      _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
      [_previewViewController didChangeToGraphConfiguration:configurationCopy animated:1];
      [(CAMViewfinderViewController *)self _updatePanoramaSizeIfNeededForGraphConfiguration:configurationCopy];
      v26 = [CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
      isHidden = [(CAMZoomSlider *)self->__zoomSlider isHidden];
      v28 = 0;
      if ((isHidden & 1) == 0)
      {
        [(CAMZoomSlider *)self->__zoomSlider alpha];
        v28 = v29 != 0.0;
      }

      if (v26 && !v28)
      {
        [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
      }

      [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
      [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:configurationCopy animated:0];
      [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:configurationCopy animated:1];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:configurationCopy animated:1];
      [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:configurationCopy animated:1];
      [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:configurationCopy fromGraphConfiguration:_currentGraphConfiguration animated:1];
      [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:_currentGraphConfiguration animated:1];
      [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
      [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
      if (![(CAMViewfinderViewController *)self _isControlDrawerShowingPersistentControl])
      {
        [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      }

      _topBar = [(CAMViewfinderViewController *)self _topBar];
      [_topBar configureForMode:mode animated:0];
      [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:configurationCopy];
      v30 = +[CAMUserPreferences preferences];
      v31 = v30;
      v32 = v51 ^ 1;
      if (mode != 6)
      {
        v32 = 1;
      }

      if ((v32 & 1) == 0)
      {
        [v30 setPortraitModeRearDevice:v10];
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [v31 setPortraitModeRearZoomValue:?];
      }

      v52 = v31;
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updateDepthEffectApertureForGraphConfiguration:configurationCopy fromGraphConfiguration:_configuredGraphConfiguration zoomFactor:?];
      if ([v13 isPortraitEffectIntensitySupportedForMode:mode])
      {
        [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
        [_captureController changeToPortraitLightingEffectStrength:?];
        [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
        [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      }

      [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:configurationCopy animated:[(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:_configuredGraphConfiguration]];
      [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
      [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
      [(CAMViewfinderViewController *)self _resetExposureClipping];
      [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
      [(CAMViewfinderViewController *)self _updateShutterButtonLegibility];
      [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
      [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:configurationCopy animated:0];
      [(CAMViewfinderViewController *)self _updateMaxRecordingTimeInstructionLabelForGraphConfiguration:configurationCopy];
      [(CAMViewfinderViewController *)self _startOrCancelPurgeIfNecessary];
      [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
      [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
      [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:1];
      _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
      isViewfinderClosed = [_closedViewfinderController isViewfinderClosed];

      if ((isViewfinderClosed & 1) == 0)
      {
        [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
        [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:1];
      }

      [(CAMViewfinderViewController *)self _openViewfinderForAllModeAndDeviceChangeReasons];
      mEMORY[0x1E69DC668] = [MEMORY[0x1E69DC668] sharedApplication];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        [mEMORY[0x1E69DC668] didChangeToMode:mode device:v10];
      }

      v36 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v55 = configurationCopy;
        v56 = 1024;
        *v57 = dCopy;
        _os_log_impl(&dword_1A3640000, v36, OS_LOG_TYPE_DEFAULT, "Did change to: %{public}@ (requestID=%d)", buf, 0x12u);
      }

      if (self->_configurationDelegateFlags.respondsToDidCompleteConfiguration)
      {
        configurationDelegate = [(CAMViewfinderViewController *)self configurationDelegate];
        [configurationDelegate cameraViewControllerDidCompleteConfigurationForCaptureMode:mode captureDevice:v10];
      }

      [(CAMViewfinderViewController *)self captureController:_captureController didOutputFaceResults:MEMORY[0x1E695E0F0] headResults:MEMORY[0x1E695E0F0] bodyResults:MEMORY[0x1E695E0F0] salientObjectResults:MEMORY[0x1E695E0F0]];
      [(CAMViewfinderViewController *)self _resetObjectResults];
      [(CAMViewfinderViewController *)self _updateInterfaceModulationForGraphConfiguration:_currentGraphConfiguration animated:1];
      [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:[(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled] animated:1];
      if ([(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormat])
      {
        [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
      }

      [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:_currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
      if ([configurationCopy mode]== 9 || [configurationCopy mode]== 8)
      {
        _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        if ([_fullscreenViewfinder2 isOrientationInstructionVisible])
        {
        }

        else
        {
          _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];

          if (!_trueVideoIsActive)
          {
            [(CAMViewfinderViewController *)self _startTimer:7];
            [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
          }
        }
      }

      _motionController = [(CAMViewfinderViewController *)self _motionController];
      if (([_motionController captureOrientation] - 3) > 1)
      {
      }

      else
      {
        _trueVideoIsActive2 = [(CAMViewfinderViewController *)self _trueVideoIsActive];

        if (!_trueVideoIsActive2)
        {
          [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:1];
          [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:1];
        }
      }

      if (mode == [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]&& [(CAMViewfinderViewController *)self _trueVideoIsActive])
      {
        _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        [_fullscreenViewfinder3 setTrueVideoState:0];

        [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
        [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"True video state changed to idle"];
        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
      }

      [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:configurationCopy];
      chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
      [chromeConfigurator setIsGraphConfigurationReconfiguring:0];

      [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:configurationCopy animated:1];
      v44 = [v13 isSmartFramingSupportedForMode:-[NSObject mode](configurationCopy devicePosition:{"mode"), -[NSObject devicePosition](configurationCopy, "devicePosition")}];
      [_fullscreenViewfinder setOverCaptureGradientVisible:v44 animated:1];
      [(CAMViewfinderViewController *)self _updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:configurationCopy animated:1];
      [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:configurationCopy];
      if ((v44 & 1) == 0 && [(CAMViewfinderViewController *)self _smartFramingFieldOfViewSource])
      {
        [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:0];
      }

      [CAMLensSmudgeDisplayState logModeChangedWithMode:[configurationCopy mode]];
      _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
      [_lensSmudgeDisplayFrontState modeDidChange];

      _lensSmudgeDisplayBackState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
      [_lensSmudgeDisplayBackState modeDidChange];
    }
  }

  else
  {
    _currentGraphConfiguration = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(_currentGraphConfiguration, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v55 = configurationCopy;
      v56 = 1024;
      *v57 = d;
      v57[2] = 1024;
      *&v57[3] = v16;
      _os_log_impl(&dword_1A3640000, _currentGraphConfiguration, OS_LOG_TYPE_DEFAULT, "Did change to: %{public}@ (requestID=%d) (waiting on another in-flight configuration before completing configuration changes (requestID=%d)", buf, 0x18u);
    }
  }
}

- (void)_updateDepthEffectApertureForGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration zoomFactor:(double)factor
{
  configurationCopy = configuration;
  graphConfigurationCopy = graphConfiguration;
  v9 = +[CAMCaptureCapabilities capabilities];
  device = [configurationCopy device];
  devicePosition = [configurationCopy devicePosition];
  mode = [configurationCopy mode];
  if ([v9 isDepthEffectApertureSupportedForMode:mode devicePosition:devicePosition depthSuggestionEnabled:{objc_msgSend(configurationCopy, "enableDepthSuggestion")}])
  {
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v14 = v13;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v16 = v15;
    [v9 defaultDepthEffectApertureForMode:mode device:device zoomFactor:factor];
    v18 = v17;
    [(CAMViewfinderViewController *)self _setLastDefaultApertureValue:?];
    v19 = +[CAMUserPreferences preferences];
    v20 = [v9 isDepthEffectApertureSupportedForMode:objc_msgSend(graphConfigurationCopy devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(graphConfigurationCopy, "devicePosition"), objc_msgSend(graphConfigurationCopy, "enableDepthSuggestion")}];
    if (([v19 preserveAperture] & 1) == 0 && ((vabdd_f64(v16, v14) >= 0.0001) & v20) == 0)
    {
      [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:v18];
    }

    [(CAMViewfinderViewController *)self _resetPortraitModeApertureValueIfNeededForGraphConfiguration:configurationCopy zoomFactor:factor];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v22 = v21;
    [v9 minimumDepthEffectApertureForMode:mode device:device];
    v24 = v23;
    [v9 maximumDepthEffectApertureForMode:mode device:device];
    if (v24 >= v22)
    {
      v26 = v24;
    }

    else
    {
      v26 = v22;
    }

    if (v25 >= v26)
    {
      v27 = v26;
    }

    else
    {
      v27 = v25;
    }

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController changeToPortraitAperture:v27];

    [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:configurationCopy zoomFactor:factor];
    [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:configurationCopy zoomFactor:0 animated:factor];
  }
}

- (void)_prepareDeferredProcessingIfNeeded
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 isDeferredProcessingPrewarmingSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v3 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:0 maximumLength:0];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController prepareDeferredProcessingWithStillImageRequest:v3];
  }
}

- (void)_updateInterfaceModulationForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  v6 = [configuration colorSpace] == 2;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setInterfaceModulation:v6 animated:animatedCopy];
}

- (int64_t)_resolvedDeviceForZoomFactor:(double)factor fromGraphConfiguration:(id)configuration toGraphConfiguration:(id)graphConfiguration
{
  graphConfigurationCopy = graphConfiguration;
  configurationCopy = configuration;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 resolvedDeviceForDesiredDevice:objc_msgSend(graphConfigurationCopy mode:"device") videoConfiguration:objc_msgSend(graphConfigurationCopy videoStabilizationStrength:"mode") frontRearSimultaneousVideoEnabled:{objc_msgSend(graphConfigurationCopy, "videoConfiguration"), objc_msgSend(graphConfigurationCopy, "videoStabilizationStrength"), objc_msgSend(graphConfigurationCopy, "frontRearSimultaneousVideoEnabled")}];

  device = [configurationCopy device];
  [CAMZoomControlUtilities equivalentZoomFactor:v10 forDevice:device fromDevice:factor];
  v13 = v12;
  v14 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", [graphConfigurationCopy mode], v10, objc_msgSend(graphConfigurationCopy, "videoConfiguration"), objc_msgSend(graphConfigurationCopy, "videoStabilizationStrength"), objc_msgSend(graphConfigurationCopy, "frontRearSimultaneousVideoEnabled"), 0, 0);
  mode = [graphConfigurationCopy mode];

  return [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v10 fromDevice:mode mode:v14 continuousZoomSupported:v13];
}

- (void)captureController:(id)controller didChangeToGraphConfiguration:(id)configuration forDesiredConfiguration:(id)desiredConfiguration requestID:(int)d
{
  [(CAMViewfinderViewController *)self _didChangeToGraphConfiguration:configuration forDesiredConfiguration:desiredConfiguration requestID:*&d];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  [_callStatusMonitor removeDisabledReason:0];
}

- (void)captureController:(id)controller didOutputFaceResults:(id)results headResults:(id)headResults bodyResults:(id)bodyResults salientObjectResults:(id)objectResults
{
  objectResultsCopy = objectResults;
  bodyResultsCopy = bodyResults;
  headResultsCopy = headResults;
  resultsCopy = results;
  controllerCopy = controller;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController captureController:controllerCopy didOutputFaceResults:resultsCopy headResults:headResultsCopy bodyResults:bodyResultsCopy salientObjectResults:objectResultsCopy];

  firstObject = [resultsCopy firstObject];
  [(CAMViewfinderViewController *)self _updateCaptureTimerIndicatorWithFaceResult:firstObject];
  v18 = [resultsCopy count];
  _targetPortraitModeInstructionLabel = [(CAMViewfinderViewController *)self _targetPortraitModeInstructionLabel];
  [_targetPortraitModeInstructionLabel setNumberOfPeopleFound:v18];

  [(CAMViewfinderViewController *)self _updateObjectResults:resultsCopy headResults:headResultsCopy bodyResults:bodyResultsCopy];
}

- (void)_updateCaptureTimerIndicatorWithFaceResult:(id)result
{
  resultCopy = result;
  date = [MEMORY[0x1E695DF00] date];
  _lastTimerIndicatorFaceUpdateDate = [(CAMViewfinderViewController *)self _lastTimerIndicatorFaceUpdateDate];
  [date timeIntervalSinceDate:_lastTimerIndicatorFaceUpdateDate];
  if (v6 >= 1.5)
  {
    [resultCopy bounds];
    x = v21.origin.x;
    y = v21.origin.y;
    width = v21.size.width;
    height = v21.size.height;
    CGRectGetMaxX(v21);
    v22.origin.x = x;
    v22.origin.y = y;
    v22.size.width = width;
    v22.size.height = height;
    CGRectGetMaxY(v22);
    UIDistanceBetweenPoints();
    v12 = v11;
    _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
    v15 = v12 <= 0.35 || resultCopy == 0;
    if (v15 && _isCapturingFromTimer)
    {
      v16 = 2;
    }

    else
    {
      v16 = 0;
    }

    _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
    if (!_timerIndicatorView)
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      _timerIndicatorView = [_fullscreenViewfinder timerIndicator];
    }

    if (v16 != [_timerIndicatorView style])
    {
      [_timerIndicatorView setStyle:v16 animated:_isCapturingFromTimer];
      [(CAMViewfinderViewController *)self _setLastTimerIndicatorFaceUpdateDate:date];
    }
  }
}

- (void)_updateObjectResults:(id)results headResults:(id)headResults bodyResults:(id)bodyResults
{
  v78 = *MEMORY[0x1E69E9840];
  resultsCopy = results;
  headResultsCopy = headResults;
  bodyResultsCopy = bodyResults;
  v10 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v70 = 0u;
  v71 = 0u;
  v72 = 0u;
  v73 = 0u;
  v11 = resultsCopy;
  v12 = [v11 countByEnumeratingWithState:&v70 objects:v77 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v71;
    do
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v71 != v14)
        {
          objc_enumerationMutation(v11);
        }

        underlyingMetadataObject = [*(*(&v70 + 1) + 8 * i) underlyingMetadataObject];
        [v10 addObject:underlyingMetadataObject];
      }

      v13 = [v11 countByEnumeratingWithState:&v70 objects:v77 count:16];
    }

    while (v13);
  }

  v68 = 0u;
  v69 = 0u;
  v66 = 0u;
  v67 = 0u;
  v17 = headResultsCopy;
  v18 = [v17 countByEnumeratingWithState:&v66 objects:v76 count:16];
  if (v18)
  {
    v19 = v18;
    v20 = *v67;
    do
    {
      for (j = 0; j != v19; ++j)
      {
        if (*v67 != v20)
        {
          objc_enumerationMutation(v17);
        }

        underlyingMetadataObject2 = [*(*(&v66 + 1) + 8 * j) underlyingMetadataObject];
        [v10 addObject:underlyingMetadataObject2];
      }

      v19 = [v17 countByEnumeratingWithState:&v66 objects:v76 count:16];
    }

    while (v19);
  }

  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  v23 = bodyResultsCopy;
  v24 = [v23 countByEnumeratingWithState:&v62 objects:v75 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v63;
    do
    {
      for (k = 0; k != v25; ++k)
      {
        if (*v63 != v26)
        {
          objc_enumerationMutation(v23);
        }

        underlyingMetadataObject3 = [*(*(&v62 + 1) + 8 * k) underlyingMetadataObject];
        [v10 addObject:underlyingMetadataObject3];
      }

      v25 = [v23 countByEnumeratingWithState:&v62 objects:v75 count:16];
    }

    while (v25);
  }

  v52 = v17;
  v53 = v11;
  v51 = v23;

  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v29 = v10;
  v30 = [v29 countByEnumeratingWithState:&v58 objects:v74 count:16];
  if (v30)
  {
    v31 = v30;
    v55 = 0;
    v32 = 0;
    v33 = 0;
    v57 = 0;
    v34 = 0;
    v35 = 0;
    v36 = *v59;
    while (1)
    {
      for (m = 0; m != v31; ++m)
      {
        if (*v59 != v36)
        {
          objc_enumerationMutation(v29);
        }

        v38 = *(*(&v58 + 1) + 8 * m);
        groupID = [v38 groupID];
        if ([v38 isHumanFace])
        {
          if (groupID >= 1)
          {
            if (!v35)
            {
              v35 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v40 = [MEMORY[0x1E696AD98] numberWithInteger:groupID];
            v41 = v35;
LABEL_37:
            [v41 addObject:v40];

            continue;
          }

          ++v33;
        }

        else if ([v38 isCat])
        {
          if (groupID >= 1)
          {
            if (!v34)
            {
              v34 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v40 = [MEMORY[0x1E696AD98] numberWithInteger:groupID];
            v41 = v34;
            goto LABEL_37;
          }

          ++v32;
        }

        else if ([v38 isDog])
        {
          if (groupID < 1)
          {
            ++v55;
          }

          else
          {
            v56 = v35;
            v42 = v29;
            v43 = v33;
            v44 = v32;
            v45 = v34;
            v46 = v57;
            if (!v57)
            {
              v46 = objc_alloc_init(MEMORY[0x1E695DFA8]);
            }

            v47 = [MEMORY[0x1E696AD98] numberWithInteger:groupID];
            v57 = v46;
            [v46 addObject:v47];

            v34 = v45;
            v32 = v44;
            v33 = v43;
            v29 = v42;
            v35 = v56;
          }
        }
      }

      v31 = [v29 countByEnumeratingWithState:&v58 objects:v74 count:16];
      if (!v31)
      {
        goto LABEL_50;
      }
    }
  }

  v55 = 0;
  v32 = 0;
  v33 = 0;
  v57 = 0;
  v34 = 0;
  v35 = 0;
LABEL_50:

  v48 = [v35 count];
  v49 = [v34 count];
  v50 = [v57 count];
  [(CAMViewfinderViewController *)self set_faceCount:v48 + v33];
  [(CAMViewfinderViewController *)self set_catCount:v49 + v32];
  [(CAMViewfinderViewController *)self set_dogCount:v50 + v55];
}

- (void)_resetObjectResults
{
  [(CAMViewfinderViewController *)self set_faceCount:0];
  [(CAMViewfinderViewController *)self set_catCount:0];

  [(CAMViewfinderViewController *)self set_dogCount:0];
}

- (void)captureController:(id)controller didOutputTextRegionResults:(id)results
{
  [(CAMViewfinderViewController *)self _setCachedTextRegionResults:results];

  [(CAMViewfinderViewController *)self _processTextRegionResults];
}

- (void)_processTextRegionResults
{
  if ([(CAMViewfinderViewController *)self _shouldProcessTextRegions])
  {
    _cachedTextRegionResults = [(CAMViewfinderViewController *)self _cachedTextRegionResults];
    v7 = [(CAMViewfinderViewController *)self _filteredTextResults:_cachedTextRegionResults];
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  cachedTextRegionResults = [_previewViewController cachedTextRegionResults];

  if ([v7 count] || objc_msgSend(cachedTextRegionResults, "count"))
  {
    _previewViewController2 = [(CAMViewfinderViewController *)self _previewViewController];
    [_previewViewController2 setCachedTextRegionResults:v7];

    [(CAMViewfinderViewController *)self _updateProminentObjectManagerWithCachedMetadataResults];
  }
}

- (void)documentScanFlowControllerDidFinish:(id)finish
{
  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession countDocumentScanningCompletedScans];

  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)documentScanFlowControllerDidCancel:(id)cancel
{
  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession countDocumentScanningCanceledScans];

  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)documentScanFlowControllerDidFail:(id)fail withError:(id)error
{
  [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];

  [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
}

- (void)captureController:(id)controller didChangeDocumentSceneConfidenceResults:(float)results
{
  v6 = +[CAMCaptureCapabilities capabilities];
  [v6 documentScanningMinimumConfidenceLevel];
  v8 = v7;

  [(CAMViewfinderViewController *)self _setDocumentInScene:v8 <= results];

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (id)_filteredTextResults:(id)results
{
  v23 = *MEMORY[0x1E69E9840];
  resultsCopy = results;
  v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(resultsCopy, "count")}];
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v5 = resultsCopy;
  v6 = [v5 countByEnumeratingWithState:&v18 objects:v22 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v19;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v19 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v18 + 1) + 8 * i);
        underlyingMetadataObject = [v10 underlyingMetadataObject];
        [underlyingMetadataObject bounds];
        v13 = v12;
        v15 = v14;

        v16 = v15 * 3.0 * 0.25;
        if (fmin(v13, v16) >= 0.03 && v13 * v16 >= 0.0025)
        {
          [v4 addObject:v10];
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v18 objects:v22 count:16];
    }

    while (v7);
  }

  return v4;
}

- (BOOL)_shouldProcessTextRegions
{
  if (![(CAMViewfinderViewController *)self _shouldProcessMachineReadableMetadata])
  {
    return 0;
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:_currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:_currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:_currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:_currentGraphConfiguration];
  v8 = v6 == 2 && v4;
  v9 = !v8 && (!v5 || v7 != 2);

  return v9;
}

- (BOOL)_shouldProcessMachineReadableMetadata
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];
  isCapturingVideo = [_captureController isCapturingVideo];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v7 = _textInteractionInsert != 0;
  }

  else
  {
    v7 = 0;
  }

  _descriptionOverlayViewByMode = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v9 = [MEMORY[0x1E696AD98] numberWithInteger:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
  v10 = [_descriptionOverlayViewByMode objectForKeyedSubscript:v9];

  v11 = +[CAMCaptureCapabilities capabilities];
  imageAnalysisShowsInactiveTextRegions = [v11 imageAnalysisShowsInactiveTextRegions];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  if ((isCapturingBurst & 1) != 0 || (isCapturingVideo & (imageAnalysisShowsInactiveTextRegions ^ 1) | v7) & 1 | (v10 != 0) | isSemanticStyleControlVisible & 1 | isSmartStylePickerVisible & 1)
  {
    LOBYTE(v17) = 0;
  }

  else
  {
    v17 = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return v17;
}

- (void)_resetMachineReadableMetadataAndProcessing
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setCachedSignificantMRCResult:0];
  [_previewViewController setCachedMRCResults:0];
  [_previewViewController setCachedTextRegionResults:0];
  [_previewViewController setCachedSignificantTextRegionResult:0];
  [(CAMViewfinderViewController *)self _setLastMRCResultsCount:0];
  [(CAMViewfinderViewController *)self _setCachedQRCodeResults:0];
  [(CAMViewfinderViewController *)self _setCachedTextRegionResults:0];
  [(CAMViewfinderViewController *)self _setCachedAppClipCodeResults:0];
  [(CAMViewfinderViewController *)self _setBarcodeParsingSession:0];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  [_prominentObjectManager reset];
}

- (id)_textInteractionInsert
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  textInteractionInsert = [_fullscreenViewfinder textInteractionInsert];
  v5 = textInteractionInsert;
  if (textInteractionInsert)
  {
    textInteractionInsert2 = textInteractionInsert;
  }

  else
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    textInteractionInsert2 = [viewfinderView textInteractionInsert];
  }

  return textInteractionInsert2;
}

- (id)_imageAnalysisButton
{
  _externalChromeImageAnalysisButton = [(CAMViewfinderViewController *)self _externalChromeImageAnalysisButton];

  if (_externalChromeImageAnalysisButton)
  {
    _externalChromeImageAnalysisButton2 = [(CAMViewfinderViewController *)self _externalChromeImageAnalysisButton];
  }

  else
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    imageAnalysisButton = [_fullscreenViewfinder imageAnalysisButton];
    v7 = imageAnalysisButton;
    if (imageAnalysisButton)
    {
      _externalChromeImageAnalysisButton2 = imageAnalysisButton;
    }

    else
    {
      _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
      _externalChromeImageAnalysisButton2 = [_bottomBar imageAnalysisButton];
    }
  }

  return _externalChromeImageAnalysisButton2;
}

- (id)_nightModeInstructionLabel
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  nightModeInstructionLabel = [_fullscreenViewfinder nightModeInstructionLabel];

  return nightModeInstructionLabel;
}

- (id)_imageAnalysisInstructionLabel
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  imageAnalysisInstructionLabel = [_fullscreenViewfinder imageAnalysisInstructionLabel];
  v5 = imageAnalysisInstructionLabel;
  if (imageAnalysisInstructionLabel)
  {
    imageAnalysisInstructionLabel2 = imageAnalysisInstructionLabel;
  }

  else
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    imageAnalysisInstructionLabel2 = [viewfinderView imageAnalysisInstructionLabel];
  }

  return imageAnalysisInstructionLabel2;
}

- (void)_createImageAnalysisInstructionLabelIfNeeded
{
  if ([(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:7])
  {
    v4 = objc_alloc_init(CAMImageAnalysisInstructionLabel);
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    [viewfinderView setImageAnalysisInstructionLabel:v4];

    [(CAMImageAnalysisInstructionLabel *)v4 setAlpha:0.0];
  }
}

- (void)_configureImageAnalysisButton
{
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [_imageAnalysisButton setShowsMenuAsPrimaryAction:1];
  [_imageAnalysisButton setPrefersDarkGlyphWhenSelected:1];
  [_imageAnalysisButton setAdjustsImageWhenHighlighted:0];
  [_imageAnalysisButton setAdjustsImageWhenDisabled:0];
  systemYellowColor = [MEMORY[0x1E69DC888] systemYellowColor];
  [_imageAnalysisButton setTintColor:systemYellowColor];

  [_imageAnalysisButton setDelegate:self];
  [_imageAnalysisButton addTarget:self action:sel__handleImageAnalysisButtonTapped_ forControlEvents:64];
  [CAMAnimationHelper highlightScaleForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
  v7 = v6;
  v8 = +[CAMAnimationHelper highlightTransformAnimation];
  [_imageAnalysisButton setHighlightedGlyphScaleFactor:v8 animation:v7];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __60__CAMViewfinderViewController__configureImageAnalysisButton__block_invoke;
  v10[3] = &unk_1E76F9668;
  v11 = _prominentObjectManager;
  v9 = _prominentObjectManager;
  [_imageAnalysisButton _setMenuProvider:v10];
}

id __60__CAMViewfinderViewController__configureImageAnalysisButton__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) currentMachineReadableCodeAction];
  v2 = [v1 menuElements];
  if (v2)
  {
    v3 = MEMORY[0x1E69DCC60];
    v4 = [v1 contentPreviewString];
    v5 = [v3 menuWithTitle:v4 children:v2];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (void)_createImageAnalysisButtonIfNeededForConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LODWORD(configurationCopy) = [v5 isImageAnalysisSupportedForMode:mode devicePosition:devicePosition];
  if (configurationCopy)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];

    if (!_imageAnalysisButton)
    {
      v9 = objc_alloc_init(CAMImageAnalysisButton);
      [(CAMImageAnalysisButton *)v9 setAlpha:0.0];
      if (_fullscreenViewfinder)
      {
        [_fullscreenViewfinder setImageAnalysisButton:v9];
      }

      else
      {
        _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
        [_bottomBar setImageAnalysisButton:v9];
      }

      [(CAMViewfinderViewController *)self _configureImageAnalysisButton];
      [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
    }
  }
}

- (void)handleExternalChromeImageAnalysisButtonChanged:(id)changed
{
  [(CAMViewfinderViewController *)self _setExternalChromeImageAnalysisButton:changed];
  [(CAMViewfinderViewController *)self _configureImageAnalysisButton];

  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_handleImageAnalysisButtonTapped:(id)tapped
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    v11 = 0;
    v4 = 0;
    goto LABEL_11;
  }

  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentObjectType = [_prominentObjectManager currentObjectType];
  currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];
  v8 = currentMachineReadableCodeAction;
  if (currentObjectType >= 2)
  {
    if (currentObjectType != 2 || [currentMachineReadableCodeAction menuElementsCount] != 1)
    {
      v11 = 0;
      v4 = 0;
      goto LABEL_10;
    }

    v11 = v8;
    _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    currentObject = [_prominentObjectManager currentObject];
    [_visionAnalyticsSession countButtonPressForMRC:currentObject action:v11];

    v4 = 0;
  }

  else
  {
    _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    [_visionAnalyticsSession countTextButtonPress];
    v11 = 0;
    v4 = 1;
  }

LABEL_10:
LABEL_11:
  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:v4 animated:1];
  [v11 performActionWithCompletion:&__block_literal_global_13];
}

void __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke_cold_1();
    }
  }
}

- (void)_setWantsVisualTextAnalysis:(BOOL)analysis animated:(BOOL)animated
{
  if (self->__wantsVisualTextAnalysis != analysis)
  {
    v35[11] = v4;
    v35[12] = v5;
    animatedCopy = animated;
    analysisCopy = analysis;
    self->__wantsVisualTextAnalysis = analysis;
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    captureOrientation = [_motionController captureOrientation];

    v11 = [(CAMViewfinderViewController *)self _supportedInterfaceOrientationsForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle] wantsTextAnalysis:0];
    view = [(CAMViewfinderViewController *)self view];
    window = [view window];

    _windowOwnsInterfaceOrientation = [window _windowOwnsInterfaceOrientation];
    if (!analysisCopy)
    {
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisIdentifier:0];
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisStartDate:0];
      [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisEndDate:0];
      [(CAMViewfinderViewController *)self _setCurrentTextAnalysisDetectionEndDate:0];
      _imageAnalyzer = [(CAMViewfinderViewController *)self _imageAnalyzer];
      [_imageAnalyzer cancelAllRequests];

      _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
      imageInteraction = [_textInteractionInsert imageInteraction];
      feedbackGestureRecognizer = [imageInteraction feedbackGestureRecognizer];

      view2 = [(CAMViewfinderViewController *)self view];
      [view2 removeGestureRecognizer:feedbackGestureRecognizer];

      [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
      [(CAMViewfinderViewController *)self _updateTextAnalysisWithInsert:0 instructions:0 animated:animatedCopy];
      [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
      if (v11 == 2)
      {
        if (_windowOwnsInterfaceOrientation)
        {
          [window _setRotatableViewOrientation:1 updateStatusBar:1 duration:1 force:0.0];
        }

        else
        {
          v33[0] = MEMORY[0x1E69E9820];
          v33[1] = 3221225472;
          v33[2] = __68__CAMViewfinderViewController__setWantsVisualTextAnalysis_animated___block_invoke_617;
          v33[3] = &unk_1E76F77B0;
          v33[4] = self;
          [MEMORY[0x1E69DD250] performWithoutAnimation:v33];
        }

        [(CAMViewfinderViewController *)self setNeedsUpdateOfHomeIndicatorAutoHidden];
      }

      goto LABEL_24;
    }

    _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
    currentObjectType = [_prominentObjectManager currentObjectType];

    if (currentObjectType == 1 || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v17 = objc_claimAutoreleasedReturnValue(), v18 = [v17 isImageAnalysisButtonAlwaysVisible], v17, v18))
    {
      feedbackGestureRecognizer = [(CAMViewfinderViewController *)self _stillImageCaptureRequestForTextAnalysis];
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      v35[0] = 0;
      v21 = [_captureController captureStillImageWithRequest:feedbackGestureRecognizer error:v35];
      v22 = v35[0];

      if (v21)
      {
        v23 = [MEMORY[0x1E695DF00] now];
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisStartDate:v23];

        textAnalysisIdentifier = [feedbackGestureRecognizer textAnalysisIdentifier];
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisIdentifier:textAnalysisIdentifier];

        if (v11 == 2)
        {
          if ((captureOrientation - 3) < 2)
          {
            v25 = _windowOwnsInterfaceOrientation;
          }

          else
          {
            v25 = 0;
          }

          if (v25 == 1)
          {
            [window _setRotatableViewOrientation:captureOrientation updateStatusBar:1 duration:1 force:0.0];
          }

          else if ((_windowOwnsInterfaceOrientation & 1) == 0)
          {
            v34[0] = MEMORY[0x1E69E9820];
            v34[1] = 3221225472;
            v34[2] = __68__CAMViewfinderViewController__setWantsVisualTextAnalysis_animated___block_invoke;
            v34[3] = &unk_1E76F77B0;
            v34[4] = self;
            [MEMORY[0x1E69DD250] performWithoutAnimation:v34];
          }
        }

LABEL_21:

LABEL_24:
        [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];

        return;
      }
    }

    else
    {
      feedbackGestureRecognizer = 0;
      v22 = 0;
    }

    v30 = @"no prominent text region";
    if (currentObjectType == 1)
    {
      v30 = v22;
    }

    v31 = v30;
    v32 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _setWantsVisualTextAnalysis:animated:];
    }

    [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
    goto LABEL_21;
  }
}

- (void)_handleTextAnalysisStillImageResponse:(id)response error:(id)error forRequest:(id)request
{
  responseCopy = response;
  errorCopy = error;
  requestCopy = request;
  v11 = [MEMORY[0x1E695DF00] now];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    textAnalysisIdentifier = [requestCopy textAnalysisIdentifier];
    _currentStillImageCaptureTextAnalysisIdentifier = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisIdentifier];
    v14 = [textAnalysisIdentifier isEqualToString:_currentStillImageCaptureTextAnalysisIdentifier];

    if (v14)
    {
      textAnalysisImage = [responseCopy textAnalysisImage];
      if (textAnalysisImage)
      {
        [(CAMViewfinderViewController *)self _setCurrentStillImageCaptureTextAnalysisEndDate:v11];
        _imageAnalyzer = [(CAMViewfinderViewController *)self _imageAnalyzer];
        if (!_imageAnalyzer)
        {
          _imageAnalyzer = objc_alloc_init(MEMORY[0x1E69DFA18]);
          [(CAMViewfinderViewController *)self _setImageAnalyzer:_imageAnalyzer];
        }

        textAnalysisRegion = [requestCopy textAnalysisRegion];
        [textAnalysisRegion bounds];
        [requestCopy captureOrientation];
        _UIConvertRectFromOrientationToOrientation();
        if (CGRectIsEmpty(v24))
        {
          v18 = +[CAMCaptureCapabilities capabilities];
          [v18 isImageAnalysisButtonAlwaysVisible];
        }

        [textAnalysisImage size];
        CEKExpandNormalizedRect();
        v19 = [MEMORY[0x1E69DFA30] quadFromCGRect:?];
        [textAnalysisRegion baselineAngle];
        v21 = [v19 quadFromRotatingAroundCentroidWithAngle:-v20];
        v22 = [objc_alloc(MEMORY[0x1E69DFA10]) initWithImage:textAnalysisImage focusQuad:v21 delegate:self];
        [_imageAnalyzer processRequest:v22];
      }

      else
      {
        v23 = os_log_create("com.apple.camera", "Camera");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController _handleTextAnalysisStillImageResponse:error:forRequest:];
        }

        [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
      }
    }
  }
}

- (void)_updateTextAnalysisWithInsert:(id)insert instructions:(BOOL)instructions animated:(BOOL)animated
{
  animatedCopy = animated;
  instructionsCopy = instructions;
  insertCopy = insert;
  [(CAMViewfinderViewController *)self _setWantsVisualTextSelectionInstructions:instructionsCopy];
  if (instructionsCopy)
  {
    _timerCache = [(CAMViewfinderViewController *)self _timerCache];
    [_timerCache cancelTimerForKey:&unk_1F16C7760];

    [(CAMViewfinderViewController *)self _createImageAnalysisInstructionLabelIfNeeded];
  }

  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
  [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  if (insertCopy)
  {
    _textInteractionBackground = [(CAMViewfinderViewController *)self _textInteractionBackground];
    if (!_textInteractionBackground)
    {
      _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
      _textInteractionBackground = objc_alloc_init(CAMCounterRotatingView);
      v14 = [MEMORY[0x1E69DC888] colorWithWhite:0.0 alpha:0.5];
      [(CAMCounterRotatingView *)_textInteractionBackground setBackgroundColor:v14];

      [(CAMCounterRotatingView *)_textInteractionBackground setAlpha:0.0];
      [(CAMViewfinderViewController *)self _setTextInteractionBackground:_textInteractionBackground];
      if (_fullscreenViewfinder)
      {
        superview = [_imageAnalysisButton superview];
        [superview insertSubview:_textInteractionBackground belowSubview:_imageAnalysisButton];
      }

      else
      {
        superview = [(CAMViewfinderViewController *)self _bottomBar];
        [superview setImageAnalysisButtonBackgroundOverlay:_textInteractionBackground];
      }

      v18 = [objc_alloc(MEMORY[0x1E69DD060]) initWithTarget:self action:sel__handleDismissLiftedTextGestureRecognizer_];
      [(CAMCounterRotatingView *)_textInteractionBackground addGestureRecognizer:v18];
    }

    [_fullscreenViewfinder setTextInteractionInsert:insertCopy];
    [viewfinderView setTextInteractionInsert:insertCopy];
    [insertCopy setDelegate:self];
    if (animatedCopy)
    {
      [insertCopy performLiftAnimation];
    }

    else
    {
      v19 = MEMORY[0x1E69DD250];
      v21[0] = MEMORY[0x1E69E9820];
      v21[1] = 3221225472;
      v21[2] = __83__CAMViewfinderViewController__updateTextAnalysisWithInsert_instructions_animated___block_invoke;
      v21[3] = &unk_1E76F77B0;
      v22 = insertCopy;
      [v19 performWithoutAnimation:v21];
    }

    goto LABEL_15;
  }

  _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
  _textInteractionBackground = _textInteractionInsert;
  if (animatedCopy)
  {
    [(CAMCounterRotatingView *)_textInteractionInsert fadeOutAndRemoveFromSuperview];
LABEL_15:

    goto LABEL_16;
  }

  [(CAMViewfinderViewController *)self animateAlongsideFadeOutForTextLiftingView:_textInteractionInsert];

  _textInteractionInsert2 = [(CAMViewfinderViewController *)self _textInteractionInsert];
  [(CAMViewfinderViewController *)self fadeOutAnimationDidEndForView:_textInteractionInsert2];

LABEL_16:
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsShowingLiftingTextView:insertCopy != 0];
}

- (void)_updateImageAnalysisButton
{
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _shouldShowImageAnalysisButtonForGraphConfiguration:_currentGraphConfiguration];

  isContextMenuDisplayed = [_imageAnalysisButton isContextMenuDisplayed];
  v7 = isContextMenuDisplayed;
  if (v5 && (isContextMenuDisplayed & 1) == 0)
  {
    _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
    currentObjectType = [_prominentObjectManager currentObjectType];
    if (_wantsVisualTextAnalysis || currentObjectType != 2)
    {
      [_imageAnalysisButton setMode:0];
    }

    else
    {
      currentObject = [_prominentObjectManager currentObject];
      mrcType = [currentObject mrcType];
      if (mrcType > 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = qword_1A3A68398[mrcType];
      }

      [_imageAnalysisButton setMode:v12];
      _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _layoutStyle]== 1;
    }

    [_imageAnalysisButton setSelected:_wantsVisualTextAnalysis];
  }

  if ((v7 & 1) == 0)
  {
    currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];
    v14 = currentMachineReadableCodeAction;
    if (currentMachineReadableCodeAction && [currentMachineReadableCodeAction menuElementsCount] >= 2)
    {
      v15 = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis]^ 1;
    }

    else
    {
      v15 = 0;
    }

    [_imageAnalysisButton setContextMenuInteractionEnabled:v15];
  }
}

- (void)_updateImageAnalysisInstructions
{
  _imageAnalysisInstructionLabel = [(CAMViewfinderViewController *)self _imageAnalysisInstructionLabel];
  instruction = [_imageAnalysisInstructionLabel instruction];
  _wantsVisualTextSelectionInstructions = [(CAMViewfinderViewController *)self _wantsVisualTextSelectionInstructions];
  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v6 = [_timerCache isRunningTimerForKey:&unk_1F16C7760];

  if (v6)
  {
    v7 = 1;
  }

  else
  {
    v7 = instruction;
  }

  if (_wantsVisualTextSelectionInstructions)
  {
    v8 = 0;
  }

  else
  {
    v8 = v7;
  }

  [_imageAnalysisInstructionLabel setInstruction:v8];
}

- (id)_stillImageCaptureRequestForTextAnalysis
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v4 = objc_alloc_init(CAMMutableStillImageCaptureRequest);
  [(CAMMutableStillImageCaptureRequest *)v4 setDelegate:self];
  uUID = [MEMORY[0x1E696AFB0] UUID];
  uUIDString = [uUID UUIDString];
  [(CAMMutableStillImageCaptureRequest *)v4 setTextAnalysisIdentifier:uUIDString];

  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureMirrored:[(CAMViewfinderViewController *)self _currentDevicePosition]== 1];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  -[CAMMutableStillImageCaptureRequest setCaptureOrientation:](v4, "setCaptureOrientation:", [_motionController captureOrientation]);

  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureDevice:[(CAMViewfinderViewController *)self _currentDevice]];
  [(CAMMutableStillImageCaptureRequest *)v4 setCaptureMode:_currentMode];
  [(CAMMutableStillImageCaptureRequest *)v4 setAspectRatioCrop:[(CAMViewfinderViewController *)self _aspectRatioCropForMode:_currentMode devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsAudioForCapture:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setPhotoQualityPrioritization:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setFlashMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setHdrMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setIrisMode:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsAutoDualCameraFusion:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setPersistenceOptions:0];
  [(CAMMutableStillImageCaptureRequest *)v4 setUserInitiationTime:mach_absolute_time()];
  [(CAMMutableStillImageCaptureRequest *)v4 setWantsSemanticSceneFilter:0];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentObject = [_prominentObjectManager currentObject];
  if ([_prominentObjectManager currentObjectType] == 1)
  {
    v10 = currentObject;
  }

  else
  {
    v10 = 0;
  }

  [(CAMMutableStillImageCaptureRequest *)v4 setTextAnalysisRegion:v10];
  if (!v10)
  {
    v11 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _stillImageCaptureRequestForTextAnalysis];
    }
  }

  [(CAMViewfinderViewController *)self _desiredPreviewSizeForStillImageCapture];
  [(CAMMutableStillImageCaptureRequest *)v4 setDesiredPreviewSize:round(v12 * 1.2), round(v13 * 1.2)];

  return v4;
}

- (void)animateAlongsideTextLiftingForView:(id)view
{
  _textInteractionBackground = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [_textInteractionBackground setAlpha:1.0];
}

- (void)animateAlongsideFadeOutForTextLiftingView:(id)view
{
  _textInteractionBackground = [(CAMViewfinderViewController *)self _textInteractionBackground];
  [_textInteractionBackground setAlpha:0.0];
}

- (void)fadeOutAnimationDidEndForView:(id)view
{
  viewCopy = view;
  _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];

  if (_textInteractionInsert == viewCopy)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setTextInteractionInsert:0];

    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    [viewfinderView setTextInteractionInsert:0];
  }
}

- (void)imageAnalysisButton:(id)button didChangeContextMenuDisplayed:(BOOL)displayed
{
  if (displayed)
  {
    _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
    _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    currentObject = [_prominentObjectManager currentObject];
    currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];
    [_visionAnalyticsSession countButtonPressForMRC:currentObject action:currentMachineReadableCodeAction];
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateForCurrentMachineReadableCodeAction];

    [(CAMViewfinderViewController *)self _dismissDockedMRCButtonIfNeededAnimated:1];
  }
}

- (BOOL)imageAnalysisInteraction:(id)interaction shouldBeginAtPoint:(CGPoint)point forAnalysisType:(unint64_t)type
{
  [(CAMViewfinderViewController *)self _setWantsVisualTextSelectionInstructions:0, type, point.x, point.y];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  return 1;
}

- (void)request:(id)request didFailWithError:(id)error
{
  requestCopy = request;
  errorCopy = error;
  v8 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController request:didFailWithError:];
  }

  [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0 animated:1];
  [(CAMViewfinderViewController *)self _startTimer:3];
  [(CAMViewfinderViewController *)self _createImageAnalysisInstructionLabelIfNeeded];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
  v9 = +[CAMCaptureCapabilities capabilities];
  isInternalInstall = [v9 isInternalInstall];

  if (isInternalInstall)
  {
    v11 = [MEMORY[0x1E69DC650] alertControllerWithTitle:@"Text Analysis Error" message:@"An error occurred during text analysis request processing." preferredStyle:1];
    v12 = MEMORY[0x1E69DC648];
    v15 = MEMORY[0x1E69E9820];
    v16 = 3221225472;
    v17 = __56__CAMViewfinderViewController_request_didFailWithError___block_invoke;
    v18 = &unk_1E76F96B0;
    v19 = requestCopy;
    v20 = errorCopy;
    v13 = [v12 actionWithTitle:@"File Radar" style:0 handler:&v15];
    [v11 addAction:{v13, v15, v16, v17, v18}];

    v14 = [MEMORY[0x1E69DC648] actionWithTitle:@"Cancel" style:1 handler:0];
    [v11 addAction:v14];

    [(CAMViewfinderViewController *)self presentViewController:v11 animated:1 completion:0];
  }
}

void __56__CAMViewfinderViewController_request_didFailWithError___block_invoke(uint64_t a1)
{
  v2 = objc_alloc_init(MEMORY[0x1E69DFA20]);
  [v2 setAssetsProvider:*(a1 + 32)];
  [v2 setError:*(a1 + 40)];
  [v2 provideFeedbackWithType:2 options:-1 metadata:0 promisedAttachments:0 userResponseHandler:&__block_literal_global_641];
}

void __56__CAMViewfinderViewController_request_didFailWithError___block_invoke_2(uint64_t a1, char a2)
{
  if ((a2 & 1) == 0)
  {
    v2 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      *v3 = 0;
      _os_log_impl(&dword_1A3640000, v2, OS_LOG_TYPE_DEFAULT, "Launched TTR for text analysis failure", v3, 2u);
    }
  }
}

- (void)request:(id)request didDetectTextWithResult:(id)result
{
  requestCopy = request;
  resultCopy = result;
  v8 = [MEMORY[0x1E695DF00] now];
  [(CAMViewfinderViewController *)self _setCurrentTextAnalysisDetectionEndDate:v8];

  v9 = [resultCopy boundingPathWithPadding:8.0 cornerRadius:8.0];
  v10 = objc_alloc(MEMORY[0x1E69DFA38]);
  image = [requestCopy image];
  [resultCopy baselineAngle];
  v12 = [v10 initWithImage:image cutoutPath:v9 baselineAngle:?];

  [v12 setMaxScale:4.0];
  [v12 setPresentsQuickActions:1];
  objc_initWeak(&location, self);
  v13 = MEMORY[0x1E69E9820];
  v14 = 3221225472;
  v15 = __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke;
  v16 = &unk_1E76F9700;
  objc_copyWeak(&v17, &location);
  [v12 setQuickActionConfigurationUpdateHandler:&v13];
  [(CAMViewfinderViewController *)self _updateTextAnalysisWithInsert:v12 instructions:1 animated:1, v13, v14, v15, v16];
  objc_destroyWeak(&v17);
  objc_destroyWeak(&location);
}

void __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [v3 configuration];
  if ([v3 state] == 4)
  {
    v5 = [MEMORY[0x1E69DC888] blackColor];
    [v4 setBaseForegroundColor:v5];

    [MEMORY[0x1E69DC888] systemYellowColor];
  }

  else
  {
    v6 = [MEMORY[0x1E69DC888] whiteColor];
    [v4 setBaseForegroundColor:v6];

    [MEMORY[0x1E69DC888] colorWithWhite:0.0 alpha:0.5];
  }
  v7 = ;
  [v4 setBaseBackgroundColor:v7];

  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke_2;
  v8[3] = &unk_1E76F96D8;
  objc_copyWeak(&v9, (a1 + 32));
  [v4 setTitleTextAttributesTransformer:v8];
  [v3 setConfiguration:v4];
  objc_destroyWeak(&v9);
}

id __63__CAMViewfinderViewController_request_didDetectTextWithResult___block_invoke_2(uint64_t a1, void *a2)
{
  v3 = [a2 mutableCopy];
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v5 = [WeakRetained traitCollection];
  v6 = [v5 preferredContentSizeCategory];

  v7 = [CAMFont cameraModeDialFontForContentSize:v6];
  [v3 setObject:v7 forKeyedSubscript:*MEMORY[0x1E69DB648]];

  return v3;
}

- (void)request:(id)request didRecgonizeTextWithAnalysis:(id)analysis
{
  v32 = *MEMORY[0x1E69E9840];
  v5 = MEMORY[0x1E695DF00];
  analysisCopy = analysis;
  v7 = [v5 now];
  _currentStillImageCaptureTextAnalysisStateDate = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisStateDate];
  _currentStillImageCaptureTextAnalysisEndDate = [(CAMViewfinderViewController *)self _currentStillImageCaptureTextAnalysisEndDate];
  _currentTextAnalysisDetectionEndDate = [(CAMViewfinderViewController *)self _currentTextAnalysisDetectionEndDate];
  v11 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    [_currentStillImageCaptureTextAnalysisEndDate timeIntervalSinceDate:_currentStillImageCaptureTextAnalysisStateDate];
    v13 = v12;
    [_currentTextAnalysisDetectionEndDate timeIntervalSinceDate:_currentStillImageCaptureTextAnalysisEndDate];
    v15 = v14;
    [v7 timeIntervalSinceDate:_currentTextAnalysisDetectionEndDate];
    v17 = v16;
    [v7 timeIntervalSinceDate:_currentStillImageCaptureTextAnalysisStateDate];
    v24 = 134218752;
    v25 = v13;
    v26 = 2048;
    v27 = v15;
    v28 = 2048;
    v29 = v17;
    v30 = 2048;
    v31 = v18;
    _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Text analysis completed with time for capture: %.3fs detection: %.3fs recognition: %.3fs total: %.3fs", &v24, 0x2Au);
  }

  v19 = [objc_alloc(MEMORY[0x1E69DFA28]) initWithInteractionOptions:5];
  [v19 setActiveInteractionTypes:3];
  [v19 setDataDetectorTypes:4091];
  [v19 setAnalysis:analysisCopy];

  [v19 setDelegate:self];
  [v19 set_customAnalyticsIdentifier:@"com.apple.camera.livetext"];
  _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
  [_textInteractionInsert setImageInteraction:v19];

  view = [(CAMViewfinderViewController *)self view];
  [view setNeedsLayout];

  view2 = [(CAMViewfinderViewController *)self view];
  feedbackGestureRecognizer = [v19 feedbackGestureRecognizer];
  [view2 addGestureRecognizer:feedbackGestureRecognizer];
}

- (void)captureController:(id)controller didOutputQRCodeResults:(id)results
{
  [(CAMViewfinderViewController *)self _setCachedQRCodeResults:results];

  [(CAMViewfinderViewController *)self _captureControllerDidOutputMRC];
}

- (void)captureController:(id)controller didOutputAppClipCodeResults:(id)results
{
  [(CAMViewfinderViewController *)self _setCachedAppClipCodeResults:results];

  [(CAMViewfinderViewController *)self _captureControllerDidOutputMRC];
}

- (void)_captureControllerDidOutputMRC
{
  if ([(CAMViewfinderViewController *)self _shouldProcessMachineReadableMetadata])
  {
    v3 = ![(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  }

  else
  {
    v3 = 0;
  }

  _cachedQRCodeResults = [(CAMViewfinderViewController *)self _cachedQRCodeResults];
  v5 = _cachedQRCodeResults;
  v6 = MEMORY[0x1E695E0F0];
  if (_cachedQRCodeResults)
  {
    v7 = _cachedQRCodeResults;
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  v8 = v7;

  _cachedAppClipCodeResults = [(CAMViewfinderViewController *)self _cachedAppClipCodeResults];
  v10 = _cachedAppClipCodeResults;
  if (_cachedAppClipCodeResults)
  {
    v11 = _cachedAppClipCodeResults;
  }

  else
  {
    v11 = v6;
  }

  v12 = v11;

  if (v3)
  {
    v6 = [v8 arrayByAddingObjectsFromArray:v12];
  }

  if ([v6 count] || -[CAMViewfinderViewController _lastMRCResultsCount](self, "_lastMRCResultsCount"))
  {
    -[CAMViewfinderViewController _setLastMRCResultsCount:](self, "_setLastMRCResultsCount:", [v6 count]);
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    _machineReadableCodeLoggingController = [(CAMViewfinderViewController *)self _machineReadableCodeLoggingController];
    v15 = +[CAMApplication appOrPlugInState];
    if ([v6 count])
    {
      if (v15)
      {
        [_machineReadableCodeLoggingController logMachineReadableCodeResultDuringInactiveAppState];
      }
    }

    else
    {
      [_machineReadableCodeLoggingController resetLoggingState];
    }

    [(CAMViewfinderViewController *)self _updateCachedMRCResults:v6];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    v16 = +[CAMCaptureCapabilities capabilities];
    isImageAnalysisSupported = [v16 isImageAnalysisSupported];

    if (isImageAnalysisSupported)
    {
      [(CAMViewfinderViewController *)self _updateProminentObjectManagerWithCachedMetadataResults];
    }

    else
    {
      v18 = [(CAMViewfinderViewController *)self _acceptableSizeMRCResultsFromResults:v6];
      v19 = v18;
      if (!v15 && [v18 count])
      {
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke;
        v20[3] = &unk_1E76F9728;
        v21 = _previewViewController;
        [(CAMViewfinderViewController *)self _processResults:v19 completionHandler:v20];
      }
    }
  }
}

void __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if (v3)
  {
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __61__CAMViewfinderViewController__captureControllerDidOutputMRC__block_invoke_2;
    v4[3] = &unk_1E76F7960;
    v5 = *(a1 + 32);
    v6 = v3;
    dispatch_async(MEMORY[0x1E69E96A0], v4);
  }
}

- (void)_updateCachedMRCResults:(id)results
{
  resultsCopy = results;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setCachedMRCResults:resultsCopy];

  _targetQRCodeInstructionLabel = [(CAMViewfinderViewController *)self _targetQRCodeInstructionLabel];
  [_targetQRCodeInstructionLabel setMRCResults:resultsCopy];
}

- (id)_acceptableSizeMRCResultsFromResults:(id)results
{
  resultsCopy = results;
  _machineReadableCodeLoggingController = [(CAMViewfinderViewController *)self _machineReadableCodeLoggingController];
  v6 = MEMORY[0x1E696AE18];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __68__CAMViewfinderViewController__acceptableSizeMRCResultsFromResults___block_invoke;
  v11[3] = &unk_1E76F9750;
  v12 = _machineReadableCodeLoggingController;
  v7 = _machineReadableCodeLoggingController;
  v8 = [v6 predicateWithBlock:v11];
  v9 = [resultsCopy filteredArrayUsingPredicate:v8];

  return v9;
}

uint64_t __68__CAMViewfinderViewController__acceptableSizeMRCResultsFromResults___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = [v3 isOfSignificantSize];
  [*(a1 + 32) logMachineReadableCodeResult:v3 isOfSignificantSize:v4];

  return v4;
}

- (void)_processResults:(id)results completionHandler:(id)handler
{
  v35 = *MEMORY[0x1E69E9840];
  resultsCopy = results;
  handlerCopy = handler;
  if (![resultsCopy count])
  {
    handlerCopy[2](handlerCopy, 0);
  }

  v8 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v9 = resultsCopy;
  v10 = [v9 countByEnumeratingWithState:&v21 objects:v34 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      v12 = 0;
      do
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(v9);
        }

        underlyingMachineReadableCodeObject = [*(*(&v21 + 1) + 8 * v12) underlyingMachineReadableCodeObject];
        [v8 addObject:underlyingMachineReadableCodeObject];

        ++v12;
      }

      while (v10 != v12);
      v10 = [v9 countByEnumeratingWithState:&v21 objects:v34 count:16];
    }

    while (v10);
  }

  _barcodeParsingSession = [(CAMViewfinderViewController *)self _barcodeParsingSession];
  if (!_barcodeParsingSession)
  {
    v15 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_1A3640000, v15, OS_LOG_TYPE_DEFAULT, "Recognized the first acceptable size QR Code, starting new barcode parsing session", buf, 2u);
    }

    v30 = 0;
    v31 = &v30;
    v32 = 0x2050000000;
    v16 = getBCSAVParsingSessionClass_softClass;
    v33 = getBCSAVParsingSessionClass_softClass;
    if (!getBCSAVParsingSessionClass_softClass)
    {
      *buf = MEMORY[0x1E69E9820];
      v26 = 3221225472;
      v27 = __getBCSAVParsingSessionClass_block_invoke;
      v28 = &unk_1E76F8100;
      v29 = &v30;
      __getBCSAVParsingSessionClass_block_invoke(buf);
      v16 = v31[3];
    }

    v17 = v16;
    _Block_object_dispose(&v30, 8);
    _barcodeParsingSession = objc_alloc_init(v16);
    [(CAMViewfinderViewController *)self _setBarcodeParsingSession:_barcodeParsingSession];
  }

  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __65__CAMViewfinderViewController__processResults_completionHandler___block_invoke;
  v19[3] = &unk_1E76F9778;
  v20 = handlerCopy;
  v18 = handlerCopy;
  [_barcodeParsingSession updateSessionWithMetadataObjects:v8 completionHandler:v19];
}

void __65__CAMViewfinderViewController__processResults_completionHandler___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v13 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v7 = v6;
  if (v5)
  {
    v8 = [[CAMMachineReadableCodeResult alloc] initWithMachineReadableCodeObject:v5];
    if (!v7)
    {
      goto LABEL_8;
    }
  }

  else
  {
    v8 = 0;
    if (!v6)
    {
      goto LABEL_8;
    }
  }

  v9 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    v10 = [v7 description];
    v11 = 138543362;
    v12 = v10;
    _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "There was an error updating the QR barcode parsing session: %{public}@", &v11, 0xCu);
  }

LABEL_8:
  (*(*(a1 + 32) + 16))();
}

- (void)_dismissDockedMRCButtonIfNeededAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];

  imageAnalysisButton = [_fullscreenViewfinder imageAnalysisButton];
  isContextMenuDisplayed = [imageAnalysisButton isContextMenuDisplayed];

  if (!currentMachineReadableCodeAction && (isContextMenuDisplayed & 1) == 0 && ![(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton]|| [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded])
  {
    if (_fullscreenViewfinder)
    {
      [_fullscreenViewfinder dismissMachineReadableCodeButtonAnimated:animatedCopy];
    }

    else
    {
      viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
      [viewfinderView dismissMachineReadableCodeButtonAnimated:animatedCopy];
    }
  }

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)machineReadableCodeButtonDidTapDismiss:(id)dismiss
{
  dismissCopy = dismiss;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  machineReadableCodeButton = [viewfinderView machineReadableCodeButton];

  if (machineReadableCodeButton == dismissCopy)
  {
    v7 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v8 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Tapped to dismiss MRC button", v8, 2u);
    }

    [viewfinderView dismissMachineReadableCodeButtonAnimated:1];
    [dismissCopy setDelegate:0];
  }

  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)_updateProminentObjectManagerWithCachedMetadataResults
{
  if (!+[CAMApplication appOrPlugInState])
  {
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    cachedTextRegionResults = [_previewViewController cachedTextRegionResults];
    v4 = cachedTextRegionResults;
    v5 = MEMORY[0x1E695E0F0];
    if (cachedTextRegionResults)
    {
      v6 = cachedTextRegionResults;
    }

    else
    {
      v6 = MEMORY[0x1E695E0F0];
    }

    v7 = v6;

    cachedMRCResults = [_previewViewController cachedMRCResults];
    v9 = cachedMRCResults;
    if (cachedMRCResults)
    {
      v10 = cachedMRCResults;
    }

    else
    {
      v10 = v5;
    }

    v11 = v10;

    v12 = [(CAMViewfinderViewController *)self _acceptableSizeMRCResultsFromResults:v11];
    v13 = [v7 arrayByAddingObjectsFromArray:v12];
    _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
    [_prominentObjectManager updateWithCandidateObjects:v13];

    _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    [_visionAnalyticsSession countObservedSignficantMRCs:v12];
    v16 = [v7 count];

    [_visionAnalyticsSession countObservedSignficantTextRegionCount:v16];
  }
}

- (void)_updateDocumentScanningButtonIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  isDocumentScanningSupported = [v3 isDocumentScanningSupported];

  if (isDocumentScanningSupported)
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    _shouldShowDocumentScanningButton = [(CAMViewfinderViewController *)self _shouldShowDocumentScanningButton];
    _isDisplayingDocumentScanningButton = [(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton];
    _timerCache = [(CAMViewfinderViewController *)self _timerCache];
    v8 = [_timerCache isRunningTimerForKey:&unk_1F16C7778];

    if (_shouldShowDocumentScanningButton)
    {
      if (_isDisplayingDocumentScanningButton)
      {
        _timerCache2 = [(CAMViewfinderViewController *)self _timerCache];
        [_timerCache2 cancelTimerForKey:&unk_1F16C7778];
      }

      else
      {
        v10 = [MEMORY[0x1E69DCAB8] systemImageNamed:@"doc.viewfinder"];
        v11 = CAMLocalizedFrameworkString(@"DOCUMENT_SCANNING_TITLE", 0);
        v12 = [CAMMachineReadableCodeButton buttonWithType:0];
        [v12 setAttributedTitleWithTitle:v11 image:v10];
        [v12 addTarget:self action:sel__handleDocumentScanningPillPress forControlEvents:64];
        if (viewfinderView)
        {
          [viewfinderView adoptMachineReadableCodeButton:v12 animated:1];
        }

        else
        {
          _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
          [_fullscreenViewfinder adoptMachineReadableCodeButton:v12 fromOriginalParent:0 animated:1];
        }

        _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
        [_visionAnalyticsSession countObservedDocumentScanning];
      }
    }

    else if (!(v8 & 1 | !_isDisplayingDocumentScanningButton))
    {
      [(CAMViewfinderViewController *)self _startTimer:4];
    }
  }
}

- (void)_dismissDocumentScanningButton
{
  if (![(CAMViewfinderViewController *)self _shouldShowDocumentScanningButton]&& [(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton])
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = viewfinderView;
    if (viewfinderView)
    {
      [viewfinderView dismissMachineReadableCodeButtonAnimated:1];
    }

    else
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder dismissMachineReadableCodeButtonAnimated:1];
    }
  }
}

- (BOOL)_shouldShowDocumentScanningButton
{
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  if (([(CAMViewfinderViewController *)self _currentMode]| 4) != 4 || _currentDevicePosition)
  {
    goto LABEL_3;
  }

  _isDocumentInScene = [(CAMViewfinderViewController *)self _isDocumentInScene];
  if (!_isDocumentInScene)
  {
    return _isDocumentInScene;
  }

  if ([(CAMViewfinderViewController *)self _isDisplayingMRCButton]|| [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
LABEL_3:
    LOBYTE(_isDocumentInScene) = 0;
  }

  else
  {
    LOBYTE(_isDocumentInScene) = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return _isDocumentInScene;
}

- (BOOL)_isDisplayingDocumentScanningButton
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v4 = viewfinderView;
  if (viewfinderView)
  {
    machineReadableCodeButton = [viewfinderView machineReadableCodeButton];
  }

  else
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    machineReadableCodeButton = [_fullscreenViewfinder machineReadableCodeButton];
  }

  title = [machineReadableCodeButton title];
  v8 = CAMLocalizedFrameworkString(@"DOCUMENT_SCANNING_TITLE", 0);
  v9 = [title isEqualToString:v8];

  return v9;
}

- (BOOL)_isDisplayingMRCButton
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v4 = viewfinderView;
  if (!viewfinderView)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    machineReadableCodeButton = [_fullscreenViewfinder machineReadableCodeButton];

    if (machineReadableCodeButton)
    {
      goto LABEL_3;
    }

LABEL_5:
    LOBYTE(v6) = 0;
    goto LABEL_6;
  }

  machineReadableCodeButton = [viewfinderView machineReadableCodeButton];
  if (!machineReadableCodeButton)
  {
    goto LABEL_5;
  }

LABEL_3:
  v6 = ![(CAMViewfinderViewController *)self _isDisplayingDocumentScanningButton];
LABEL_6:

  return v6;
}

- (CGPoint)prominentObjectManagerPointOfInterestInNormalizedDeviceSpace:(id)space
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController pointOfInterestInNormalizedCaptureDeviceSpace];
  v5 = v4;
  v7 = v6;

  v8 = v5;
  v9 = v7;
  result.y = v9;
  result.x = v8;
  return result;
}

- (void)prominentObjectManager:(id)manager didChangeCurrentObject:(id)object
{
  v17 = *MEMORY[0x1E69E9840];
  objectCopy = object;
  v6 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    metadataType = [objectCopy metadataType];
    v15 = 138543362;
    v16 = metadataType;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Current prominent object metadata type: %{public}@", &v15, 0xCu);
  }

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentObjectType = [_prominentObjectManager currentObjectType];

  v11 = 0;
  if (currentObjectType == 2)
  {
    v13 = objectCopy;
    goto LABEL_7;
  }

  v12 = 0;
  if (currentObjectType == 1)
  {
    v13 = 0;
    v11 = objectCopy;
LABEL_7:
    v12 = v11;
    v14 = objectCopy;
    v11 = v13;
  }

  [_previewViewController setCachedSignificantTextRegionResult:v12];
  [_previewViewController setCachedSignificantMRCResult:v11];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _dismissDockedMRCButtonIfNeededAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_updateMachineReadableCodeButtonFromAction:(id)action
{
  v17 = *MEMORY[0x1E69E9840];
  actionCopy = action;
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  isContextMenuDisplayed = [_imageAnalysisButton isContextMenuDisplayed];
  v7 = os_log_create("com.apple.camera", "MachineReadableCode");
  v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
  if (isContextMenuDisplayed)
  {
    if (!v8)
    {
LABEL_11:

      goto LABEL_12;
    }

    dataTypeDisplayString = [actionCopy dataTypeDisplayString];
    v15 = 138543362;
    v16 = dataTypeDisplayString;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Already showing MRC menu, ignoring new prominent MRC type: %{public}@", &v15, 0xCu);
LABEL_10:

    goto LABEL_11;
  }

  if (v8)
  {
    dataTypeDisplayString2 = [actionCopy dataTypeDisplayString];
    v15 = 138543362;
    v16 = dataTypeDisplayString2;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Current prominent MRC type: %{public}@", &v15, 0xCu);
  }

  [(CAMViewfinderViewController *)self _updateForCurrentMachineReadableCodeAction];
  if (actionCopy)
  {
    v7 = [CAMMachineReadableCodeButton buttonWithType:0];
    shortDescription = [actionCopy shortDescription];
    actionIcon = [actionCopy actionIcon];
    [v7 setAttributedTitleWithTitle:shortDescription image:actionIcon];

    [v7 addTarget:self action:sel__handlePillPressForCurrentMRCAction forControlEvents:64];
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    dataTypeDisplayString = viewfinderView;
    if (viewfinderView)
    {
      [viewfinderView adoptMachineReadableCodeButton:v7 animated:1];
      [v7 setDelegate:self];
      [v7 setDismissable:1];
    }

    else
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder adoptMachineReadableCodeButton:v7 fromOriginalParent:0 animated:1];
    }

    goto LABEL_10;
  }

LABEL_12:
  [(CAMViewfinderViewController *)self _updateDocumentScanningButtonIfNeeded];
}

- (void)_updateMachineReadableCodeButtonForAction:(id)action animated:(BOOL)animated
{
  animatedCopy = animated;
  v21 = *MEMORY[0x1E69E9840];
  actionCopy = action;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v9 = _fullscreenViewfinder;
  if (viewfinderView)
  {
    _fullscreenViewfinder = viewfinderView;
  }

  machineReadableCodeButton = [_fullscreenViewfinder machineReadableCodeButton];
  if (machineReadableCodeButton)
  {
    shortDescription = [actionCopy shortDescription];
    v12 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v20 = shortDescription;
      _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Updating MRC button with title: %{public}@", buf, 0xCu);
    }

    actionIcon = [actionCopy actionIcon];
    [machineReadableCodeButton setAttributedTitleWithTitle:shortDescription image:actionIcon];

    if (viewfinderView)
    {
      v14 = viewfinderView;
    }

    else
    {
      v14 = v9;
    }

    v15 = v14;
    [v15 setNeedsLayout];
    if (animatedCopy)
    {
      v16 = MEMORY[0x1E69DD250];
      v17[0] = MEMORY[0x1E69E9820];
      v17[1] = 3221225472;
      v17[2] = __82__CAMViewfinderViewController__updateMachineReadableCodeButtonForAction_animated___block_invoke;
      v17[3] = &unk_1E76F77B0;
      v18 = v15;
      [v16 animateWithDuration:2 delay:v17 usingSpringWithDamping:0 initialSpringVelocity:0.5 options:0.0 animations:1.0 completion:1.0];
    }
  }
}

- (void)_updateForCurrentMachineReadableCodeAction
{
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];

  [currentMachineReadableCodeAction setDelegate:self];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateImageAnalysisButton];
}

- (void)_handlePillPressForCurrentMRCAction
{
  v12 = *MEMORY[0x1E69E9840];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  cachedSignificantMRCResult = [_previewViewController cachedSignificantMRCResult];

  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];

  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession countPillPressForMRC:cachedSignificantMRCResult action:currentMachineReadableCodeAction];

  v8 = os_log_create("com.apple.camera", "MachineReadableCode");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    detectedCode = [currentMachineReadableCodeAction detectedCode];
    v10 = 138543362;
    v11 = detectedCode;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Performing action for MRC code: %{public}@", &v10, 0xCu);
  }

  [currentMachineReadableCodeAction performActionWithCompletion:&__block_literal_global_674];
}

void __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke_cold_1();
    }
  }
}

- (void)_handleDocumentScanningPillPress
{
  objc_initWeak(&location, self);
  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession countButtonPressForDocumentScanning];

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke;
  aBlock[3] = &unk_1E76F8580;
  objc_copyWeak(&v9, &location);
  v4 = _Block_copy(aBlock);
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_4;
  v6[3] = &unk_1E76F97A0;
  v5 = v4;
  v7 = v5;
  [(CAMViewfinderViewController *)self _requestPasscodeUnlockForDocumentScanningWithCompletionBlock:v6];

  objc_destroyWeak(&v9);
  objc_destroyWeak(&location);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_2;
  v3[3] = &unk_1E76F8580;
  objc_copyWeak(&v4, (a1 + 32));
  [WeakRetained suspendCameraSessionWithCompletion:v3];

  objc_destroyWeak(&v4);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_2(uint64_t a1)
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_3;
  block[3] = &unk_1E76F8580;
  objc_copyWeak(&v2, (a1 + 32));
  dispatch_async(MEMORY[0x1E69E96A0], block);
  objc_destroyWeak(&v2);
}

void __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_3(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained presentDocumentScanningViewControllerAnimated:1];
}

uint64_t __63__CAMViewfinderViewController__handleDocumentScanningPillPress__block_invoke_4(uint64_t result, int a2)
{
  if (a2)
  {
    return (*(*(result + 32) + 16))();
  }

  return result;
}

- (void)presentDocumentScanningViewControllerAnimated:(BOOL)animated
{
  animatedCopy = animated;
  v5 = objc_alloc_init(CAMDocumentScanFlowController);
  [(CAMDocumentScanFlowController *)v5 setDocumentFlowDelegate:self];
  [(CAMViewfinderViewController *)self presentModalViewController:v5 animated:animatedCopy];
}

- (CGRect)sourceRectForPopoverActionPicker:(id)picker
{
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [_imageAnalysisButton bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  view = [(CAMViewfinderViewController *)self view];
  [_imageAnalysisButton convertRect:view toView:{v6, v8, v10, v12}];
  v15 = v14;
  v17 = v16;
  v19 = v18;
  v21 = v20;

  v22 = v15;
  v23 = v17;
  v24 = v19;
  v25 = v21;
  result.size.height = v25;
  result.size.width = v24;
  result.origin.y = v23;
  result.origin.x = v22;
  return result;
}

- (void)actionDidUpdateTitle:(id)title
{
  titleCopy = title;
  v9 = 0;
  v10 = &v9;
  v11 = 0x2050000000;
  v5 = getBCSActionClass_softClass;
  v12 = getBCSActionClass_softClass;
  if (!getBCSActionClass_softClass)
  {
    v8[0] = MEMORY[0x1E69E9820];
    v8[1] = 3221225472;
    v8[2] = __getBCSActionClass_block_invoke;
    v8[3] = &unk_1E76F8100;
    v8[4] = &v9;
    __getBCSActionClass_block_invoke(v8);
    v5 = v10[3];
  }

  v6 = v5;
  _Block_object_dispose(&v9, 8);
  if (objc_opt_isKindOfClass())
  {
    [(CAMViewfinderViewController *)self _updateMachineReadableCodeButtonForAction:titleCopy animated:1];
  }

  else
  {
    v7 = os_log_create("com.apple.camera", "MachineReadableCode");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController actionDidUpdateTitle:];
    }
  }
}

- (void)captureController:(id)controller didOutputHistogramResult:(id)result
{
  resultCopy = result;
  [(CAMViewfinderViewController *)self _shadowClippingValue];
  v7 = v6;
  [resultCopy shadowClipping];
  [(CAMViewfinderViewController *)self _setShadowClippingValue:v8 * 0.3 + v7 * 0.7];
  [(CAMViewfinderViewController *)self _highlightClippingValue];
  v10 = v9;
  [resultCopy highlightClipping];
  v12 = v11;

  [(CAMViewfinderViewController *)self _setHighlightClippingValue:v12 * 0.3 + v10 * 0.7];

  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_resetExposureClipping
{
  [(CAMViewfinderViewController *)self _setShadowClippingValue:0.0];
  [(CAMViewfinderViewController *)self _setHighlightClippingValue:0.0];

  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_previewDidStartRunning:(id)running
{
  v40 = *MEMORY[0x1E69E9840];
  runningCopy = running;
  CAMSignpostWithIDAndArgs(7, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  object = [runningCopy object];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  videoPreviewLayer = [_captureController videoPreviewLayer];

  if (object == videoPreviewLayer)
  {
    _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
    _locationController = [(CAMViewfinderViewController *)self _locationController];
    _keepAliveController = [(CAMViewfinderViewController *)self _keepAliveController];
    v37 = +[CAMCaptureCapabilities capabilities];
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
    descriptionForTimeBetweenReferenceAndNow = [_closedViewfinderController descriptionForTimeBetweenReferenceAndNow];
    v14 = os_log_create("com.apple.camera", "CaptureSession");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v39 = descriptionForTimeBetweenReferenceAndNow;
      _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Received AVCaptureVideoPreviewLayerDidStartRunningNotification %{public}@", buf, 0xCu);
    }

    v36 = descriptionForTimeBetweenReferenceAndNow;

    [_closedViewfinderController removeClosedViewfinderReason:5];
    [_closedViewfinderController removeClosedViewfinderReason:3];
    if (![(CUCaptureController *)self->__captureController isCapturingTimelapse])
    {
      [_locationController setEnabled:1];
    }

    [_locationController setHeadingEnabled:1];
    if ([(CAMViewfinderViewController *)self automaticallyAdjustsApplicationIdleTimer])
    {
      _idleController = [(CAMViewfinderViewController *)self _idleController];
      [_idleController startUpdatingIdleTimer];
    }

    _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
    [_cameraRollController preload];

    v35 = _keepAliveController;
    [_keepAliveController startKeepAliveSession];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController createConnectionIfNecessary];
    _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
    if (!_visionAnalyticsSession)
    {
      if (![v37 isImageAnalysisSupportedForMode:_currentMode devicePosition:_currentDevicePosition])
      {
        goto LABEL_12;
      }

      v19 = +[CAMUserPreferences preferences];
      isImageAnalysisEnabled = [v19 isImageAnalysisEnabled];

      v20 = +[CAMUserPreferences preferences];
      shouldShowQRBanners = [v20 shouldShowQRBanners];

      v22 = +[CAMCaptureCapabilities capabilities];
      isDocumentScanningSupported = [v22 isDocumentScanningSupported];

      _visionAnalyticsSession = [[CAMAnalyticsVisionSession alloc] initWithTextDetectionEnabled:isImageAnalysisEnabled MRCDetectionEnabled:shouldShowQRBanners documentScanningEnabled:isDocumentScanningSupported];
      [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:_visionAnalyticsSession];
    }

LABEL_12:
    v24 = +[CAMUserPreferences preferences];
    sharedLibraryAutoBehaviorEnabled = [v24 sharedLibraryAutoBehaviorEnabled];

    if (sharedLibraryAutoBehaviorEnabled)
    {
      _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
      [_librarySelectionController startAcquiringSignals];
    }

    if (+[CAMApplication appOrPlugInState]!= 2)
    {
      [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
      _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      [_analyticsSessionEvent didStartPreview];
    }

    [(CAMViewfinderViewController *)self _setUpTipManagerIfNeeded];
    [(CAMViewfinderViewController *)self _resetObjectResults];
    v28 = +[CAMCaptureCapabilities capabilities];
    v29 = v36;
    if ([(CAMDockKitController *)v28 isiPhone])
    {
      dockKitController = self->__dockKitController;

      if (dockKitController)
      {
LABEL_20:
        mEMORY[0x1E69C4598] = [MEMORY[0x1E69C4598] sharedScheduler];
        [mEMORY[0x1E69C4598] applicationDidFinishExtendedLaunch];

        goto LABEL_21;
      }

      v31 = [_TtC8CameraUI20CAMDockKitController alloc];
      _motionController = [(CAMViewfinderViewController *)self _motionController];
      v28 = [(CAMDockKitController *)v31 initWithMotionController:_motionController];

      v29 = v36;
      [(CAMViewfinderViewController *)self setDockKitController:v28];
    }

    goto LABEL_20;
  }

LABEL_21:
}

- (void)_setOutOfDiskSpace:(BOOL)space
{
  if (self->__outOfDiskSpace != space)
  {
    spaceCopy = space;
    self->__outOfDiskSpace = space;
    if (space)
    {
      v6 = @"Out of disk space";
    }

    else
    {
      v6 = @"No longer out of disk space";
    }

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v6];
    _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
    _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
    if (spaceCopy)
    {
      [_closedViewfinderController addClosedViewfinderReason:6];
      [_disabledPreviewController addDisabledPreviewReason:0];
    }

    else
    {
      [_closedViewfinderController removeClosedViewfinderReason:6];
      [_disabledPreviewController removeDisabledPreviewReason:0];
    }
  }
}

- (void)_configureSwipeToModeSwitchGestureRecognizersDirection
{
  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer setDirection:[(CAMViewfinderViewController *)self _previousModeSwipeDirectionForLayoutStyle:_layoutStyle]];
  v4 = [(CAMViewfinderViewController *)self _nextModeSwitchDirectionForLayoutStyle:_layoutStyle];
  nextModeGestureRecognizer = self->__nextModeGestureRecognizer;

  [(UISwipeGestureRecognizer *)nextModeGestureRecognizer setDirection:v4];
}

- (BOOL)_shouldCreateAndEmbedControl:(int64_t)control
{
  v4 = +[CAMCaptureCapabilities capabilities];
  wantsFullscreenViewfinder = [v4 wantsFullscreenViewfinder];

  LOBYTE(v6) = 0;
  if (control <= 0x18 && (wantsFullscreenViewfinder & 1) == 0)
  {
    v6 = 0x143CEA4u >> control;
  }

  return v6 & 1;
}

- (void)_createOrDestroySharedLibraryControlsIfNecessary
{
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryBadgeIfNecessary];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  v3 = +[CAMUserPreferences preferences];
  [_remoteShutterController setSharedLibrarySupported:{objc_msgSend(v3, "sharedLibrarySwitchEnabled")}];
}

- (void)_createModeSpecificControlsForConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy])
    {
      [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
    }

    if ([(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:configurationCopy]&& ![CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
    {
      [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
    }

    [(CAMViewfinderViewController *)self _createOrDestroyLevelViewModelIfNecessary];
    [(CAMViewfinderViewController *)self _createGridViewIfNecessary];
    [(CAMViewfinderViewController *)self _createOrDestroyLevelViewIfNecessary];
    [(CAMViewfinderViewController *)self _createOrDestroyHorizonLevelViewIfNecessary];
    mode = [configurationCopy mode];
    if (mode <= 3)
    {
      if ((mode - 1) >= 2)
      {
        if (mode)
        {
          if (mode == 3)
          {
            [(CAMViewfinderViewController *)self _createPanoramaControlsIfNecessary];
          }

          goto LABEL_21;
        }

        goto LABEL_20;
      }
    }

    else
    {
      if (mode <= 7)
      {
        if ((mode - 6) < 2)
        {
          [(CAMViewfinderViewController *)self _createPortraitModeControlsIfNecessary];
LABEL_21:
          v5 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:configurationCopy];
          [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Controls created"];
          goto LABEL_22;
        }

        if (mode != 4)
        {
          goto LABEL_21;
        }

LABEL_20:
        [(CAMViewfinderViewController *)self _createStillImageControlsIfNecessary];
        goto LABEL_21;
      }

      if (mode != 8)
      {
        if (mode != 9)
        {
          goto LABEL_21;
        }

        goto LABEL_20;
      }
    }

    [(CAMViewfinderViewController *)self _createVideoControlsIfNecessary];
    goto LABEL_21;
  }

LABEL_22:
}

- (void)_createPortraitModeControlsIfNecessary
{
  v5 = +[CAMCaptureCapabilities capabilities];
  [(CAMViewfinderViewController *)self _createTimerButtonIfNecessary];
  [(CAMViewfinderViewController *)self _createTimerIndicatorViewIfNecessary];
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {
    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  if ([v5 isLivePhotoSupported])
  {
    [(CAMViewfinderViewController *)self _createLivePhotoButtonIfNecessary];
    [(CAMViewfinderViewController *)self _createLivePhotoBadgeIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createPortraitModeInstructionLabelIfNecessary];
  if ([v5 arePortraitEffectsSupported])
  {
    [(CAMViewfinderViewController *)self _createLightingControlIfNecessary];
    [(CAMViewfinderViewController *)self _createLightingNameBadgeIfNecessary];
  }

  else
  {
    [(CAMViewfinderViewController *)self _createShallowDepthOfFieldBadgeIfNecessary];
  }

  if ([v5 isDepthEffectApertureSupported])
  {
    [(CAMViewfinderViewController *)self _createApertureButtonIfNecessary];
  }

  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isPortraitEffectIntensitySupportedForLightingType:{-[CAMViewfinderViewController portraitModeLightingEffectType](self, "portraitModeLightingEffectType")}];

  if (v4)
  {
    [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
  }
}

- (void)_createVideoControlsIfNecessary
{
  [(CAMViewfinderViewController *)self _createElapsedTimeViewIfNecessary];
  v3 = +[CAMCaptureCapabilities capabilities];
  isStillDuringVideoSupported = [v3 isStillDuringVideoSupported];

  if (isStillDuringVideoSupported)
  {
    [(CAMViewfinderViewController *)self _createStillDuringVideoButtonIfNecessary];
  }

  [(CAMViewfinderViewController *)self _createVideoConfigurationStatusIndicatorIfNecessary];
}

- (void)_createPanoramaControlsIfNecessary
{
  v3 = +[CAMCaptureCapabilities capabilities];
  if (([v3 isBackPanoramaSupported] & 1) != 0 || objc_msgSend(v3, "isFrontPanoramaSupported"))
  {
    [(CAMViewfinderViewController *)self _createPanoramaViewControllerIfNecessary];
  }
}

- (void)_createApertureButtonIfNecessary
{
  if (!self->__apertureButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:0])
  {
    v3 = objc_alloc(MEMORY[0x1E6993818]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    apertureButton = self->__apertureButton;
    self->__apertureButton = v4;

    [(CEKApertureButton *)self->__apertureButton addTarget:self action:sel__handleApertureButtonTapped_ forControlEvents:64];
    [(CEKApertureButton *)self->__apertureButton setExclusiveTouch:1];
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    [(CEKApertureButton *)self->__apertureButton setWantsBackground:_layoutStyle == 1];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:_currentGraphConfiguration2];
    [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration zoomFactor:0 animated:?];

    [(CAMViewfinderViewController *)self _embedApertureButtonWithLayoutStyle:_layoutStyle];
  }
}

- (void)_createIntensityButtonIfNecessary
{
  if (!self->__intensityButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:8])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMIntensityButton alloc] initWithLayoutStyle:_layoutStyle];
    intensityButton = self->__intensityButton;
    self->__intensityButton = v4;

    [(CAMIntensityButton *)self->__intensityButton addTarget:self action:sel__handleIntensityButtonTapped_ forControlEvents:64];
    [(CAMIntensityButton *)self->__intensityButton setExclusiveTouch:1];
    [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];

    [(CAMViewfinderViewController *)self _embedIntensityButtonWithLayoutStyle:_layoutStyle];
  }
}

- (UIControl)_primaryShutterControl
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v4 = _dynamicShutterControl;
  if (_dynamicShutterControl)
  {
    _shutterButton = _dynamicShutterControl;
  }

  else
  {
    _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
  }

  v6 = _shutterButton;

  return v6;
}

- (void)_updateShutterEffectsEnablementForSystemPressureState
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  currentCameraSystemPressureState = [_captureController currentCameraSystemPressureState];
  shouldDisableOptionalUIEffects = [currentCameraSystemPressureState shouldDisableOptionalUIEffects];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl setDisableOptionalUIEffects:shouldDisableOptionalUIEffects];
}

- (void)_createStillDuringVideoButtonIfNecessary
{
  if (!self->__stillDuringVideoButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:20])
  {
    v3 = [CUShutterButton smallShutterButtonWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
    stillDuringVideoButton = self->__stillDuringVideoButton;
    self->__stillDuringVideoButton = v3;

    [(CUShutterButton *)self->__stillDuringVideoButton addTarget:self action:sel__handleStillDuringVideoButtonPressed_ forControlEvents:1];
    [(CUShutterButton *)self->__stillDuringVideoButton addTarget:self action:sel__handleStillDuringVideoButtonReleased_ forControlEvents:96];
    [(CUShutterButton *)self->__stillDuringVideoButton setMode:0];
    [(CUShutterButton *)self->__stillDuringVideoButton setExclusiveTouch:1];

    [(CAMViewfinderViewController *)self _embedStillDuringVideoButton];
  }
}

- (void)_createElapsedTimeViewIfNecessary
{
  if (!self->__elapsedTimeView && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:2])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMElapsedTimeView alloc] initWithLayoutStyle:_layoutStyle];
    elapsedTimeView = self->__elapsedTimeView;
    self->__elapsedTimeView = v4;

    [(CAMViewfinderViewController *)self _embedElapsedTimeViewWithLayoutStyle:_layoutStyle];
  }
}

- (CAMElapsedTimeView)_targetElapsedTimeView
{
  _elapsedTimeView = [(CAMViewfinderViewController *)self _elapsedTimeView];
  if (!_elapsedTimeView)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _elapsedTimeView = [_fullscreenViewfinder elapsedTimeView];
  }

  return _elapsedTimeView;
}

- (void)_destroyHDRButtonIfNecessary
{
  if (self->__HDRButton)
  {
    _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
    _topBar = [(CAMViewfinderViewController *)self _topBar];
    [_topBar setHDRButton:0];
    [_bottomBar setHDRButton:0];
    HDRButton = self->__HDRButton;
    self->__HDRButton = 0;

    [_topBar configureForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];
  }
}

- (void)_createOrDestroyHDRButtonIfNecessary
{
  if ([(CAMViewfinderViewController *)self _wantsHDRControlsVisible])
  {

    [(CAMViewfinderViewController *)self _createHDRButtonIfNecessary];
  }

  else
  {

    [(CAMViewfinderViewController *)self _destroyHDRButtonIfNecessary];
  }
}

- (void)_createLivePhotoButtonIfNecessary
{
  if (!self->__livePhotoButton && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:12])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = +[CAMCaptureCapabilities capabilities];
    isLivePhotoAutoModeSupported = [v4 isLivePhotoAutoModeSupported];

    v6 = [[CAMLivePhotoButton alloc] initWithLayoutStyle:_layoutStyle];
    livePhotoButton = self->__livePhotoButton;
    self->__livePhotoButton = v6;

    [(CAMLivePhotoButton *)self->__livePhotoButton setExclusiveTouch:1];
    [(CAMLivePhotoButton *)self->__livePhotoButton addTarget:self action:sel__handleLivePhotoButtonChangedLivePhotoMode forControlEvents:4096];
    [(CAMLivePhotoButton *)self->__livePhotoButton setAllowsAutomaticMode:isLivePhotoAutoModeSupported needsReloadData:0];
    [(CAMLivePhotoButton *)self->__livePhotoButton reloadData];
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:0];

    [(CAMViewfinderViewController *)self _embedLivePhotoButtonWithLayoutStyle:_layoutStyle];
  }
}

- (void)_createLivePhotoBadgeIfNecessary
{
  if (!self->__livePhotoBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:11])
  {
    v3 = [CAMLivePhotoBadge alloc];
    v4 = [(CAMLivePhotoBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    livePhotoBadge = self->__livePhotoBadge;
    self->__livePhotoBadge = v4;
  }

  [(CAMViewfinderViewController *)self _embedLivePhotoBadge];
}

- (void)_createOrDestroySharedLibraryButtonIfNecessary
{
  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  v4 = +[CAMUserPreferences preferences];
  if ([v4 sharedLibrarySwitchEnabled])
  {
    v5 = [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:18];

    if (v5)
    {
      if (self->__sharedLibraryButton)
      {
        return;
      }

      v6 = [[CAMSharedLibraryButton alloc] initWithLayoutStyle:_layoutStyle];
      sharedLibraryButton = self->__sharedLibraryButton;
      self->__sharedLibraryButton = v6;

      [(CAMSharedLibraryButton *)self->__sharedLibraryButton setExclusiveTouch:1];
      [(CAMSharedLibraryButton *)self->__sharedLibraryButton addTarget:self action:sel__handleSharedLibraryButton forControlEvents:4096];
      [(CAMExpandableMenuButton *)self->__sharedLibraryButton reloadData];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v9 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:_currentGraphConfiguration];

      [(CAMSharedLibraryButton *)self->__sharedLibraryButton setAlpha:v9];
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      goto LABEL_8;
    }
  }

  else
  {
  }

  v10 = self->__sharedLibraryButton;
  if (!v10)
  {
    return;
  }

  self->__sharedLibraryButton = 0;

LABEL_8:

  [(CAMViewfinderViewController *)self _updateSharedLibraryButtonOnSubviewsForLayoutStyle:_layoutStyle];
}

- (void)_createOrDestroySharedLibraryBadgeIfNecessary
{
  v3 = +[CAMUserPreferences preferences];
  if ([v3 sharedLibrarySwitchEnabled])
  {
    v4 = [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:17];

    if (v4)
    {
      if (self->__sharedLibraryBadge)
      {
        return;
      }

      v5 = objc_alloc_init(CAMSharedLibraryBadge);
      sharedLibraryBadge = self->__sharedLibraryBadge;
      self->__sharedLibraryBadge = v5;

      _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
      -[CAMSharedLibraryBadge setSharedLibraryMode:](self->__sharedLibraryBadge, "setSharedLibraryMode:", [_librarySelectionController sharedLibraryMode]);
      goto LABEL_8;
    }
  }

  else
  {
  }

  _librarySelectionController = self->__sharedLibraryBadge;
  if (!_librarySelectionController)
  {
    return;
  }

  self->__sharedLibraryBadge = 0;
LABEL_8:

  [(CAMViewfinderViewController *)self _embedSharedLibraryBadge];
}

- (void)_createShallowDepthOfFieldBadgeIfNecessary
{
  if (!self->__shallowDepthOfFieldBadge)
  {
    _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    v4 = [CAMShallowDepthOfFieldBadge alloc];
    v5 = [(CAMShallowDepthOfFieldBadge *)v4 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    shallowDepthOfFieldBadge = self->__shallowDepthOfFieldBadge;
    self->__shallowDepthOfFieldBadge = v5;

    [(CAMShallowDepthOfFieldBadge *)self->__shallowDepthOfFieldBadge setShallowDepthOfFieldStatus:_shallowDepthOfFieldStatus];

    [(CAMViewfinderViewController *)self _embedShallowDepthOfFieldBadge];
  }
}

- (void)_createPortraitModeInstructionLabelIfNecessary
{
  if (!self->__portraitModeInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:14])
  {
    v3 = [CAMPortraitModeInstructionLabel alloc];
    v4 = [(CAMInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    portraitModeInstructionLabel = self->__portraitModeInstructionLabel;
    self->__portraitModeInstructionLabel = v4;

    [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedPortraitModeInstructionLabel];
  }
}

- (void)_createCleanLensesInstructionLabelIfNecessary
{
  if (!self->__cleanLensesInstructionLabel && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:15])
  {
    v3 = [CAMCleanLensesInstructionLabel alloc];
    v4 = [(CAMCleanLensesInstructionLabel *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    cleanLensesInstructionLabel = self->__cleanLensesInstructionLabel;
    self->__cleanLensesInstructionLabel = v4;

    [(CAMCleanLensesInstructionLabel *)self->__cleanLensesInstructionLabel labelWasTappedWithTarget:self andAction:sel__handleCleanLensesInstructionLabelTapped_];
    [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];

    [(CAMViewfinderViewController *)self _embedCleanLensesInstructionLabel];
  }
}

- (void)fullscreenViewfinderDidFinishChangingPreviewGeometry:(id)geometry
{
  if ([(CAMViewfinderViewController *)self _delaySmartFramingDynamicAspectRatioUpdate])
  {
    [(CAMViewfinderViewController *)self set_delaySmartFramingDynamicAspectRatioUpdate:0];

    [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:0 zoomRampTuning:0.0];
  }
}

- (void)fullscreenViewfinderDidCreateControlDrawer:(id)drawer
{
  controlDrawer = [drawer controlDrawer];
  [controlDrawer setDelegate:self];

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:0];
}

- (void)fullScreenViewfinderDidCreateFlipAspectRatioButton:(id)button
{
  flipAspectRatioButton = [button flipAspectRatioButton];
  [flipAspectRatioButton addTarget:self action:sel__handleFlipAspectRatioButtonTapped_ forControlEvents:64];
}

- (void)fullscreenViewfinderDidCreatePortraitControls:(id)controls
{
  lightingControl = [controls lightingControl];
  [lightingControl setDelegate:self];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:_currentGraphConfiguration animated:0];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:_currentGraphConfiguration2 animated:0];

  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
}

- (void)fullscreenViewfinderDidChangeSemanticStyle:(id)style
{
  semanticStylePicker = [style semanticStylePicker];
  -[CAMViewfinderViewController _setSelectedSemanticStyleIndex:](self, "_setSelectedSemanticStyleIndex:", [semanticStylePicker selectedStyleIndex]);

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:1];
  _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [_analyticsControlDrawerEvent didChangeValueForControlType:10];
}

- (void)_updateSelectedSmartStyleFromPicker
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)fullscreenViewfinder:(id)viewfinder didChangeControlDrawerVisibility:(BOOL)visibility animated:(BOOL)animated forReason:(int64_t)reason
{
  animatedCopy = animated;
  if (visibility)
  {
    [(CAMViewfinderViewController *)self _dismissOverlays];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    [controlStatusBar collapseExpandedIndicatorAnimated:animatedCopy];

    _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];

    if (!_analyticsControlDrawerEvent)
    {
      v12 = [[CAMAnalyticsControlDrawerEvent alloc] initWithReason:reason captureMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
      [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:v12];
    }

    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [_analyticsSessionEvent didPresentControlDrawerForReason:reason];
  }

  else
  {
    _analyticsControlDrawerEvent2 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [_analyticsControlDrawerEvent2 dismissedControlDrawerWithReason:reason];

    [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:0];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
}

- (void)fullscreenViewFinder:(id)finder willPresentControlDrawerModallyForControlType:(int64_t)type reason:(int64_t)reason
{
  _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];

  if (!_analyticsControlDrawerEvent)
  {
    v9 = [[CAMAnalyticsControlDrawerEvent alloc] initWithReason:reason captureMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
    [(CAMViewfinderViewController *)self _setAnalyticsControlDrawerEvent:v9];

    _analyticsControlDrawerEvent2 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [_analyticsControlDrawerEvent2 setOpeningControlType:type];
  }
}

- (void)fullscreenViewFinder:(id)finder willDismissControlDrawerModallyForControlType:(int64_t)type reason:(int64_t)reason
{
  v6 = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent:finder];
  [v6 setDismissingControlType:type];
}

- (void)fullscreenViewfinder:(id)viewfinder didCreateInstructionLabel:(int64_t)label
{
  viewfinderCopy = viewfinder;
  v16 = viewfinderCopy;
  if (label <= 4)
  {
    if (label > 2)
    {
      if (label == 3)
      {
        [(CAMViewfinderViewController *)self _beginNightModeInstructionLabelCountDown];
      }

      else
      {
        _captureController = [(CAMViewfinderViewController *)self _captureController];
        flashCompromise = [_captureController flashCompromise];
        flashCompromisedInstructionLabel = [v16 flashCompromisedInstructionLabel];
        [flashCompromisedInstructionLabel setCompromise:flashCompromise];
      }
    }

    else if (label == 1)
    {
      [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
    }

    else
    {
      if (label != 2)
      {
        goto LABEL_22;
      }

      [(CAMViewfinderViewController *)self _updateQRCodeInstructionLabelForCurrentState];
    }
  }

  else if (label <= 7)
  {
    if (label == 5)
    {
      [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
    }

    else
    {
      if (label != 6)
      {
        goto LABEL_22;
      }

      v11 = [objc_alloc(MEMORY[0x1E69DD060]) initWithTarget:self action:sel__handleFreeResourcesLabelTapped_];
      freeResourcesInstructionLabel = [v16 freeResourcesInstructionLabel];
      [freeResourcesInstructionLabel addGestureRecognizer:v11];

      [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
    }
  }

  else
  {
    switch(label)
    {
      case 8:
        v13 = [(CAMViewfinderViewController *)self _currentMode]== 9;
        _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        [_fullscreenViewfinder setStereoCaptureStatus:-[CAMViewfinderViewController _stereoCaptureStatus](self useHoldStillStereoLowLightInstruction:"_stereoCaptureStatus") animated:{v13, 1}];

        break;
      case 9:
        smartStyleCategoryInstructionLabel = [viewfinderCopy smartStyleCategoryInstructionLabel];
        [smartStyleCategoryInstructionLabel setStyle:2];

        [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
        break;
      case 10:
        cleanLensesInstructionLabel = [viewfinderCopy cleanLensesInstructionLabel];
        [cleanLensesInstructionLabel labelWasTappedWithTarget:self andAction:sel__handleCleanLensesInstructionLabelTapped_];

        [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
        break;
      default:
        goto LABEL_22;
    }
  }

  viewfinderCopy = v16;
LABEL_22:
}

- (void)fullscreenViewfinder:(id)viewfinder didChangeExpanded:(BOOL)expanded forDrawerControlOfType:(int64_t)type animated:(BOOL)animated updatePreferredDrawerControl:(BOOL)control
{
  controlCopy = control;
  animatedCopy = animated;
  expandedCopy = expanded;
  viewfinderCopy = viewfinder;
  if (type > 7)
  {
    switch(type)
    {
      case 8:
        [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
        _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];

        _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration2 animated:animatedCopy];
        break;
      case 10:
        [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
        _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration3 animated:animatedCopy];

        [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
        [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
        [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Expanding SemanticStyles control"];
        [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:animatedCopy];
        if (!controlCopy)
        {
          goto LABEL_22;
        }

        goto LABEL_19;
      case 11:
        [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
        _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration2 animated:animatedCopy];
        break;
      default:
        goto LABEL_18;
    }

    goto LABEL_17;
  }

  switch(type)
  {
    case 4:
      if (!expandedCopy && [(CAMViewfinderViewController *)self _wantsFilterScrubberVisible])
      {
        [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0 animated:animatedCopy];
        if (!controlCopy)
        {
          goto LABEL_22;
        }

        goto LABEL_19;
      }

      break;
    case 6:
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration2 zoomFactor:animatedCopy animated:?];
LABEL_17:

      break;
    case 7:
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      if (!controlCopy)
      {
        goto LABEL_22;
      }

      goto LABEL_19;
  }

LABEL_18:
  if (!controlCopy)
  {
    goto LABEL_22;
  }

LABEL_19:
  if (!expandedCopy)
  {
    type = -1;
  }

  [(CAMViewfinderViewController *)self _setPreferredControlToOpenInDrawer:type forMode:[(CAMViewfinderViewController *)self _currentMode]];
LABEL_22:
}

- (int64_t)expandedControlTypeForExpandingDrawerInFullscreenViewfinder:(id)viewfinder
{
  v4 = +[CAMUserPreferences preferences];
  preservePreferredDrawerControl = [v4 preservePreferredDrawerControl];

  result = -1;
  if (preservePreferredDrawerControl)
  {
    result = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode:[(CAMViewfinderViewController *)self _currentMode]];
  }

  if (result == 11)
  {
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    smartStyleButton = [_controlDrawer smartStyleButton];
    showDisabled = [smartStyleButton showDisabled];

    result = -1;
    if (!showDisabled)
    {
      return 11;
    }
  }

  if (result == 4)
  {
    [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:1 animated:1];
    return 4;
  }

  return result;
}

- (BOOL)fullscreenViewfinderCanUpdatePreviewSemanticStyles:(id)styles
{
  if ([(CAMViewfinderViewController *)self _isReconfiguring]|| [(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self _completedInitialConfiguration];
}

- (void)fullscreenViewfinderDidCreateSpotlightControlPanel:(id)panel
{
  v18 = *MEMORY[0x1E69E9840];
  spotlightControlPanel = [panel spotlightControlPanel];
  [spotlightControlPanel setDelegate:self];
  v5 = +[CAMUserPreferences preferences];
  openHalfPressSpotlightControls = [v5 openHalfPressSpotlightControls];

  v7 = [openHalfPressSpotlightControls mutableCopy];
  [(CAMViewfinderViewController *)self _setOpenHalfPressSpotlightControls:v7];

  v15 = 0u;
  v16 = 0u;
  v13 = 0u;
  v14 = 0u;
  v8 = openHalfPressSpotlightControls;
  v9 = [v8 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v14;
    do
    {
      v12 = 0;
      do
      {
        if (*v14 != v11)
        {
          objc_enumerationMutation(v8);
        }

        [spotlightControlPanel setControlType:objc_msgSend(*(*(&v13 + 1) + 8 * v12++) open:"integerValue" animated:{v13), 1, 0}];
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v10);
  }
}

- (void)fullscreenViewfinderDidCreateSmartStyleControls:(id)controls
{
  v4 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__handleSmartStylePickerSwipe_];
  smartStylesSwipeLeftGestureRecognizer = self->__smartStylesSwipeLeftGestureRecognizer;
  self->__smartStylesSwipeLeftGestureRecognizer = v4;

  v6 = [objc_alloc(MEMORY[0x1E69DCFC8]) initWithTarget:self action:sel__handleSmartStylePickerSwipe_];
  smartStylesSwipeRightGestureRecognizer = self->__smartStylesSwipeRightGestureRecognizer;
  self->__smartStylesSwipeRightGestureRecognizer = v6;

  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setDelegate:self];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setDelegate:self];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setDirection:2];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setDirection:1];
  view = [(CAMViewfinderViewController *)self view];
  [view addGestureRecognizer:self->__smartStylesSwipeLeftGestureRecognizer];

  view2 = [(CAMViewfinderViewController *)self view];
  [view2 addGestureRecognizer:self->__smartStylesSwipeRightGestureRecognizer];

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
}

- (void)addChildViewController:(id)controller toView:(id)view
{
  viewCopy = view;
  controllerCopy = controller;
  [(CAMViewfinderViewController *)self addChildViewController:controllerCopy];
  view = [controllerCopy view];
  [viewCopy addSubview:view];

  [controllerCopy didMoveToParentViewController:self];
}

- (void)_handleSmartStyleIntensitySliderChangedValue:(double)value
{
  _currentSmartStyle = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (_currentSmartStyle)
  {
    v6 = objc_alloc(MEMORY[0x1E6993890]);
    presetType = [_currentSmartStyle presetType];
    [_currentSmartStyle toneBias];
    v9 = v8;
    [_currentSmartStyle colorBias];
    v11 = [v6 initWithPresetType:presetType castIntensity:value toneBias:v9 colorBias:v10];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v11 animateSliders:0];
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)handleSmartStylePadValueChanged:(CGPoint)changed
{
  y = changed.y;
  x = changed.x;
  _currentSmartStyle = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (_currentSmartStyle)
  {
    [CAMSmartStyleUtilities colorAndToneBiasForSlider2DValue:0 limitRangeForSystemStyles:x, y];
    v7 = objc_alloc(MEMORY[0x1E6993890]);
    presetType = [_currentSmartStyle presetType];
    [_currentSmartStyle castIntensity];
    v9 = [v7 initWithPresetType:presetType castIntensity:? toneBias:? colorBias:?];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v9 animateSliders:0];
  }

  else
  {
    v10 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)_updateSelectedSmartStyle:(id)style animateSliders:(BOOL)sliders
{
  slidersCopy = sliders;
  styleCopy = style;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 8) != 0)
  {
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
    _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    goto LABEL_6;
  }

  if (v7)
  {
    _smartStyleSystemStyleIndex = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    _semanticStyles2 = [(CAMViewfinderViewController *)self _semanticStyles];
    v10 = [_semanticStyles2 count];

    if (_smartStyleSystemStyleIndex < v10)
    {
      _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
      _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
LABEL_6:
      [_semanticStyles setObject:styleCopy atIndexedSubscript:_selectedSemanticStyleIndex];
    }
  }

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:slidersCopy animateOtherControls:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [_analyticsControlDrawerEvent didChangeValueForControlType:11];
}

- (void)_handleSmartStyleResetButton
{
  _currentSmartStyle = [(CAMViewfinderViewController *)self _currentSmartStyle];
  if (_currentSmartStyle)
  {
    v4 = [(CAMViewfinderViewController *)self _referenceStyleForSmartStyle:_currentSmartStyle];
    [(CAMViewfinderViewController *)self _updateSelectedSmartStyle:v4 animateSliders:1];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "SmartStyle");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _handleSmartStyleIntensitySliderChangedValue:];
    }
  }
}

- (void)_handleSmartStyleShutterButtonPressed:(id)pressed
{
  v4 = os_log_create("com.apple.camera", "SmartStyle");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: SmartStyle shutter button pressed", v6, 2u);
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if ([_dynamicShutterControl isEnabled])
  {
    [(CAMViewfinderViewController *)self dynamicShutterControlGesturesDidBegin:_dynamicShutterControl];
    [(CAMViewfinderViewController *)self dynamicShutterControlDidShortPress:_dynamicShutterControl];
  }

  else
  {
    [(CAMViewfinderViewController *)self shutterControlTouchAttemptedWhileDisabled:_dynamicShutterControl];
  }
}

- (void)_handleSmartStyleShutterButtonReleased:(id)released
{
  v4 = os_log_create("com.apple.camera", "SmartStyle");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: SmartStyle shutter button released", v6, 2u);
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if ([_dynamicShutterControl isEnabled])
  {
    [(CAMViewfinderViewController *)self dynamicShutterControlGesturesDidEnd:_dynamicShutterControl];
  }
}

- (void)fullscreenViewfinder:(id)viewfinder didChangeSmartStyleControlsVisibility:(BOOL)visibility animated:(BOOL)animated
{
  animatedCopy = animated;
  visibilityCopy = visibility;
  viewfinderCopy = viewfinder;
  if (!visibilityCopy)
  {
    if (![(CAMViewfinderViewController *)self _useMessagesControls])
    {
      goto LABEL_10;
    }

    controlStatusBar = [viewfinderCopy controlStatusBar];
    secondaryAccessoryControl = [controlStatusBar secondaryAccessoryControl];

    if (secondaryAccessoryControl)
    {
      goto LABEL_10;
    }

LABEL_9:
    controlStatusBar2 = [viewfinderCopy controlStatusBar];
    [controlStatusBar2 setSecondaryAccessoryControl:0 animated:animatedCopy];

    goto LABEL_10;
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:_currentGraphConfiguration];

  if (v9)
  {
    [(CAMViewfinderViewController *)self _resetPortraitLightingToDefaultAnimated:animatedCopy];
  }

  if ([(CAMViewfinderViewController *)self _useMessagesControls])
  {
    controlStatusBar3 = [viewfinderCopy controlStatusBar];
    secondaryAccessoryControl2 = [controlStatusBar3 secondaryAccessoryControl];

    if (secondaryAccessoryControl2)
    {
      goto LABEL_9;
    }
  }

LABEL_10:
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"SmartStyles control visibility changed"];
  [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:animatedCopy];
}

- (void)spotlightControlPanelDidCreateApertureSlider:(id)slider
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration zoomFactor:?];
}

- (void)spotlightControlPanel:(id)panel didChangeValueForSpotlight:(int64_t)spotlight
{
  panelCopy = panel;
  if (spotlight == 2)
  {
    v8 = panelCopy;
    exposureSlider = [panelCopy exposureSlider];
    [(CAMViewfinderViewController *)self _handleExposureSliderDidChangeValue:exposureSlider];
  }

  else
  {
    if (spotlight != 3)
    {
      goto LABEL_6;
    }

    v8 = panelCopy;
    exposureSlider = [panelCopy apertureSlider];
    [(CAMViewfinderViewController *)self _apertureSliderDidChangeApertureValue:exposureSlider];
  }

  panelCopy = v8;
LABEL_6:
}

- (void)spotlightControlPanel:(id)panel didChangeOpenForSpotlight:(int64_t)spotlight
{
  v6 = [panel isControlTypeOpen:spotlight];
  _openHalfPressSpotlightControls = [(CAMViewfinderViewController *)self _openHalfPressSpotlightControls];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:spotlight];
  if (v6)
  {
    [_openHalfPressSpotlightControls addObject:v7];
  }

  else
  {
    [_openHalfPressSpotlightControls removeObject:v7];
  }
}

- (CAMPortraitModeInstructionLabel)_targetPortraitModeInstructionLabel
{
  _portraitModeInstructionLabel = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  if (!_portraitModeInstructionLabel)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _portraitModeInstructionLabel = [_fullscreenViewfinder portraitInstructionLabel];
  }

  return _portraitModeInstructionLabel;
}

- (CAMQRCodeInstructionLabel)_targetQRCodeInstructionLabel
{
  _qrCodeInstructionLabel = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  if (!_qrCodeInstructionLabel)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _qrCodeInstructionLabel = [_fullscreenViewfinder qrCodeInstructionLabel];
  }

  return _qrCodeInstructionLabel;
}

- (void)_updateCleanLensesInstructionLabelForCurrentState
{
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _cleanLensesInstructionLabel = [(CAMViewfinderViewController *)self _cleanLensesInstructionLabel];
  [_cleanLensesInstructionLabel setDevicePosition:_currentDevicePosition];

  _currentDevicePosition2 = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  cleanLensesInstructionLabel = [_fullscreenViewfinder cleanLensesInstructionLabel];
  [cleanLensesInstructionLabel setDevicePosition:_currentDevicePosition2];
}

- (void)_createPanoramaViewControllerIfNecessary
{
  if (!self->__panoramaViewController)
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    v5 = [[CAMPanoramaViewController alloc] initWithCaptureController:_captureController layoutStyle:_layoutStyle];
    panoramaViewController = self->__panoramaViewController;
    self->__panoramaViewController = v5;

    [(CAMViewfinderViewController *)self _updatePanoramaViewForCurrentState];
    [(CAMViewfinderViewController *)self addChildViewController:self->__panoramaViewController];
    [(CAMViewfinderViewController *)self _embedPanoramaView];
  }

  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  view = [_panoramaViewController view];

  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  [view setDockKitController:_dockKitController];
}

- (void)_createZoomSliderIfNecessary
{
  if (!self->__zoomSlider)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v4 = [(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:_currentGraphConfiguration];

    if (v4)
    {
      v5 = [[CAMZoomSlider alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
      zoomSlider = self->__zoomSlider;
      self->__zoomSlider = v5;

      [(CAMZoomSlider *)self->__zoomSlider setExclusiveTouch:1];
      [(CAMZoomSlider *)self->__zoomSlider setMinimumValue:0.0];
      LODWORD(v7) = 1.0;
      [(CAMZoomSlider *)self->__zoomSlider setMaximumValue:v7];
      [(CAMZoomSlider *)self->__zoomSlider addTarget:self action:sel__handleTouchDownForZoomSlider_ forControlEvents:1];
      [(CAMZoomSlider *)self->__zoomSlider addTarget:self action:sel__zoomSliderValueDidChange_forEvent_ forControlEvents:4096];
      [(CAMZoomSlider *)self->__zoomSlider setDelegate:self];
      [(CAMZoomSlider *)self->__zoomSlider setAlpha:0.0];
      [(CAMZoomSlider *)self->__zoomSlider setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomSlider]];
      [(CAMViewfinderViewController *)self _embedZoomSlider];

      [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
    }
  }
}

- (void)_createZoomControlIfNecessary
{
  if (!self->__zoomControl)
  {
    if ([(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:24])
    {
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v4 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:_currentGraphConfiguration];

      if (v4)
      {
        v5 = [[CAMZoomControl alloc] initWithLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]];
        zoomControl = self->__zoomControl;
        self->__zoomControl = v5;

        [(CAMZoomControl *)self->__zoomControl setDelegate:self];
        [(CAMZoomControl *)self->__zoomControl addTarget:self action:sel__handleTouchDownForZoomControl_ forControlEvents:1];
        _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:_currentGraphConfiguration2 animated:0];

        [(CAMZoomControl *)self->__zoomControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomControl]];
        [(CAMViewfinderViewController *)self _embedZoomControl];

        [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
      }
    }
  }
}

- (void)_createOrDestroyLevelViewModelIfNecessary
{
  v11 = +[CAMUserPreferences preferences];
  shouldShowHorizonLevelView = [v11 shouldShowHorizonLevelView];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  shouldShowLevelView = [v11 shouldShowLevelView];
  if (_currentMode == 8)
  {
    v6 = 1;
  }

  else
  {
    v6 = shouldShowHorizonLevelView;
  }

  v7 = v6 | shouldShowLevelView;
  _levelViewModel = [(CAMViewfinderViewController *)self _levelViewModel];

  if ((v7 & 1) == 0 || _levelViewModel)
  {
    if (v7 & 1 | (_levelViewModel == 0))
    {
      goto LABEL_10;
    }

    v9 = 0;
  }

  else
  {
    v9 = objc_alloc_init(CAMLevelViewModel);
  }

  levelViewModel = self->__levelViewModel;
  self->__levelViewModel = v9;

LABEL_10:
}

- (void)_createLevelViewIfNecessary
{
  if (!self->__levelView)
  {
    v3 = [[CAMLevelIndicatorView alloc] initWithViewModel:self->__levelViewModel];
    levelView = self->__levelView;
    self->__levelView = v3;

    [(CAMViewfinderViewController *)self _embedLevelView];
  }
}

- (void)_createHorizonLevelViewIfNecessary
{
  if (!self->__horizonLevelView)
  {
    v3 = [[CAMHorizonLevelView alloc] initWithViewModel:self->__levelViewModel];
    horizonLevelView = self->__horizonLevelView;
    self->__horizonLevelView = v3;

    [(CAMHorizonLevelView *)self->__horizonLevelView setDelegate:self];

    [(CAMViewfinderViewController *)self _embedHorizonLevelView];
  }
}

- (void)_destroyHorizonLevelViewIfNecessary
{
  if (self->__horizonLevelView)
  {
    [(CAMViewfinderViewController *)self _unembedHorizonLevelView];
    horizonLevelView = self->__horizonLevelView;
    self->__horizonLevelView = 0;
  }
}

- (void)_createVideoConfigurationStatusIndicatorIfNecessary
{
  if (!self->__videoConfigurationStatusIndicator && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:23])
  {
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v4 = [[CAMVideoConfigurationStatusIndicator alloc] initWithLayoutStyle:_layoutStyle];
    videoConfigurationStatusIndicator = self->__videoConfigurationStatusIndicator;
    self->__videoConfigurationStatusIndicator = v4;

    [(CAMVideoConfigurationStatusIndicator *)self->__videoConfigurationStatusIndicator setTouchDelegate:self];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:_currentGraphConfiguration animated:0];
    [(CAMViewfinderViewController *)self _embedVideoConfigurationStatusIndicatorWithLayoutStyle:_layoutStyle];
    if ([(CAMViewfinderViewController *)self _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:_currentGraphConfiguration])
    {
      v6 = 0.0;
    }

    else
    {
      v6 = 1.0;
    }

    _videoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
    [_videoConfigurationStatusIndicator setAlpha:v6];
  }
}

- (CAMVideoConfigurationStatusIndicator)_targetVideoConfigurationStatusIndicator
{
  _videoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  if (!_videoConfigurationStatusIndicator)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    _videoConfigurationStatusIndicator = [controlStatusBar videoConfigurationIndicator];
  }

  return _videoConfigurationStatusIndicator;
}

- (void)_createUtilityBarIfNecessary
{
  if (!self->__utilityBar)
  {
    v3 = [CAMUtilityBar alloc];
    v4 = [(CAMUtilityBar *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    utilityBar = self->__utilityBar;
    self->__utilityBar = v4;

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v7 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];

    [(CAMUtilityBar *)self->__utilityBar setAlpha:!v7];

    [(CAMViewfinderViewController *)self _embedUtilityBar];
  }
}

- (void)_createFilterNameBadgeIfNecessary
{
  if (!self->__filterNameBadge)
  {
    v3 = [CAMFilterNameBadge alloc];
    v4 = [(CAMFilterNameBadge *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    filterNameBadge = self->__filterNameBadge;
    self->__filterNameBadge = v4;

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v7 = [(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:_currentGraphConfiguration];

    [(CAMFilterNameBadge *)self->__filterNameBadge setAlpha:!v7];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:0];

    [(CAMViewfinderViewController *)self _embedFilterNameBadge];
  }
}

- (void)_createPortraitApertureSliderIfNecessary
{
  [(CAMViewfinderViewController *)self _createUtilityBarIfNecessary];
  if (!self->__portraitApertureSlider)
  {
    v3 = objc_alloc_init(MEMORY[0x1E6993820]);
    portraitApertureSlider = self->__portraitApertureSlider;
    self->__portraitApertureSlider = v3;

    [(CEKApertureSlider *)self->__portraitApertureSlider addTarget:self action:sel__apertureSliderDidChangeApertureValue_ forControlEvents:4096];

    [(CAMViewfinderViewController *)self _embedPortraitApertureSlider];
  }
}

- (void)_createPortraitIntensitySliderIfNecessary
{
  [(CAMViewfinderViewController *)self _createUtilityBarIfNecessary];
  if (!self->__portraitIntensitySlider)
  {
    v7 = CAMLocalizedFrameworkString(@"PORTRAIT_INTENSITY_SLIDER_TITLE", 0);
    v3 = [objc_alloc(MEMORY[0x1E6993888]) initWithTitle:v7];
    portraitIntensitySlider = self->__portraitIntensitySlider;
    self->__portraitIntensitySlider = v3;

    [(CEKSlider *)self->__portraitIntensitySlider setSliderVerticalAlignment:2];
    v5 = self->__portraitIntensitySlider;
    blackColor = [MEMORY[0x1E69DC888] blackColor];
    [(CEKSlider *)v5 setOpaqueGradientsWithColor:blackColor];

    [(CEKSlider *)self->__portraitIntensitySlider setTitleAlignment:0];
    [(CEKSlider *)self->__portraitIntensitySlider setValueLabelVisibility:2];
    [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
    [(CEKSlider *)self->__portraitIntensitySlider addTarget:self action:sel__handleIntensitySliderDidChangeValue_ forControlEvents:4096];
    [(CAMViewfinderViewController *)self _embedPortraitIntensitySlider];
  }
}

- (void)_createLightingControlIfNecessary
{
  if (!self->__lightingControl && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:9])
  {
    v3 = objc_alloc(MEMORY[0x1E6993868]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    lightingControl = self->__lightingControl;
    self->__lightingControl = v4;

    [(CEKLightingControl *)self->__lightingControl setDelegate:self];
    [(CEKLightingControl *)self->__lightingControl preloadEffectChangeAnimation];

    [(CAMViewfinderViewController *)self _embedLightingControl];
  }
}

- (void)_createLightingNameBadgeIfNecessary
{
  if (!self->__lightingNameBadge && [(CAMViewfinderViewController *)self _shouldCreateAndEmbedControl:10])
  {
    v3 = objc_alloc(MEMORY[0x1E6993878]);
    v4 = [v3 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    lightingNameBadge = self->__lightingNameBadge;
    self->__lightingNameBadge = v4;

    [(CAMViewfinderViewController *)self _embedLightingNameBadge];
  }
}

- (void)_unembedAndDestroyAllControls
{
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  [_topBar setFlashButton:0];
  [_topBar setElapsedTimeView:0];
  [_topBar setHDRButton:0];
  [_topBar setApertureButton:0];
  [_topBar setTimerButton:0];
  [_topBar setLivePhotoButton:0];
  [_topBar setVideoConfigurationStatusIndicator:0];
  _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
  [_utilityBar setFilterScrubberView:0];
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  [_bottomBar setShutterButton:0];
  [_bottomBar setStillDuringVideoButton:0];
  [_bottomBar setModeDial:0];
  [_bottomBar setImageWell:0];
  [_bottomBar setReviewButton:0];
  [_bottomBar setFlipButton:0];
  [_bottomBar setFlashButton:0];
  [_bottomBar setHDRButton:0];
  [_bottomBar setTimerButton:0];
  [_bottomBar setLivePhotoButton:0];
  [_bottomBar setUtilityBar:0];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setTopBar:0];
  [viewfinderView setBottomBar:0];
  [viewfinderView setShutterButton:0];
  [viewfinderView setFlipButton:0];
  [viewfinderView setFocusAndExposureLockBadge:0];
  [viewfinderView setLivePhotoBadge:0];
  [viewfinderView setShallowDepthOfFieldBadge:0];
  [viewfinderView setPortraitModeInstructionLabel:0];
  [viewfinderView setQrCodeInstructionLabel:0];
  [viewfinderView setElapsedTimeView:0];
  [viewfinderView setBurstIndicatorView:0];
  [viewfinderView setTimerIndicatorView:0];
  [viewfinderView setPanoramaView:0];
  [viewfinderView setZoomSlider:0];
  [viewfinderView setZoomControl:0];
  [viewfinderView setFilterNameBadge:0];
  [viewfinderView setChromeView:0];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setChromeView:0];

  flashButton = self->__flashButton;
  self->__flashButton = 0;

  elapsedTimeView = self->__elapsedTimeView;
  self->__elapsedTimeView = 0;

  HDRButton = self->__HDRButton;
  self->__HDRButton = 0;

  apertureButton = self->__apertureButton;
  self->__apertureButton = 0;

  timerButton = self->__timerButton;
  self->__timerButton = 0;

  livePhotoButton = self->__livePhotoButton;
  self->__livePhotoButton = 0;

  sharedLibraryButton = self->__sharedLibraryButton;
  self->__sharedLibraryButton = 0;

  videoConfigurationStatusIndicator = self->__videoConfigurationStatusIndicator;
  self->__videoConfigurationStatusIndicator = 0;

  shutterButton = self->__shutterButton;
  self->__shutterButton = 0;

  stillDuringVideoButton = self->__stillDuringVideoButton;
  self->__stillDuringVideoButton = 0;

  modeDial = self->__modeDial;
  self->__modeDial = 0;

  flipButton = self->__flipButton;
  self->__flipButton = 0;

  topBar = self->__topBar;
  self->__topBar = 0;

  bottomBar = self->__bottomBar;
  self->__bottomBar = 0;

  utilityBar = self->__utilityBar;
  self->__utilityBar = 0;

  focusAndExposureLockBadge = self->__focusAndExposureLockBadge;
  self->__focusAndExposureLockBadge = 0;

  livePhotoBadge = self->__livePhotoBadge;
  self->__livePhotoBadge = 0;

  shallowDepthOfFieldBadge = self->__shallowDepthOfFieldBadge;
  self->__shallowDepthOfFieldBadge = 0;

  portraitModeInstructionLabel = self->__portraitModeInstructionLabel;
  self->__portraitModeInstructionLabel = 0;

  cleanLensesInstructionLabel = self->__cleanLensesInstructionLabel;
  self->__cleanLensesInstructionLabel = 0;

  qrCodeInstructionLabel = self->__qrCodeInstructionLabel;
  self->__qrCodeInstructionLabel = 0;

  burstIndicatorView = self->__burstIndicatorView;
  self->__burstIndicatorView = 0;

  timerIndicatorView = self->__timerIndicatorView;
  self->__timerIndicatorView = 0;

  filterNameBadge = self->__filterNameBadge;
  self->__filterNameBadge = 0;

  [(CAMViewfinderViewController *)self _destroyGridViewIfNecessary];
  [(CAMViewfinderViewController *)self _destroyLevelViewIfNecessary];
}

- (void)_destroyGestureRecognizersRequiringStandardControls
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _previousModeGestureRecognizer = [(CAMViewfinderViewController *)self _previousModeGestureRecognizer];
  [viewfinderView removeGestureRecognizer:_previousModeGestureRecognizer];
  previousModeGestureRecognizer = self->__previousModeGestureRecognizer;
  self->__previousModeGestureRecognizer = 0;

  _nextModeGestureRecognizer = [(CAMViewfinderViewController *)self _nextModeGestureRecognizer];
  [viewfinderView removeGestureRecognizer:_nextModeGestureRecognizer];
  nextModeGestureRecognizer = self->__nextModeGestureRecognizer;
  self->__nextModeGestureRecognizer = 0;
}

- (void)_embedAllControlsWithLayoutStyle:(int64_t)style
{
  [(CAMViewfinderViewController *)self _embedFlashButtonWithLayoutStyle:?];
  [(CAMViewfinderViewController *)self _embedElapsedTimeViewWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedHDRButtonWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedFocusAndExposureLockBadge];
  [(CAMViewfinderViewController *)self _embedLivePhotoButtonWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _updateSharedLibraryButtonOnSubviewsForLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedSharedLibraryBadge];
  [(CAMViewfinderViewController *)self _embedLivePhotoBadge];
  [(CAMViewfinderViewController *)self _embedShallowDepthOfFieldBadge];
  [(CAMViewfinderViewController *)self _embedPortraitModeInstructionLabel];
  [(CAMViewfinderViewController *)self _embedCleanLensesInstructionLabel];
  [(CAMViewfinderViewController *)self _embedQRCodeInstructionLabel];
  [(CAMViewfinderViewController *)self _embedFlipButtonWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedTimerButtonWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedTimerIndicatorView];
  [(CAMViewfinderViewController *)self _embedShutterButton];
  [(CAMViewfinderViewController *)self _embedStillDuringVideoButton];
  [(CAMViewfinderViewController *)self _embedModeDial];
  [(CAMViewfinderViewController *)self _embedApertureButtonWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedBurstIndicatorView];
  [(CAMViewfinderViewController *)self _embedPanoramaView];
  [(CAMViewfinderViewController *)self _embedZoomSlider];
  [(CAMViewfinderViewController *)self _embedZoomControl];
  [(CAMViewfinderViewController *)self _embedGridView];
  [(CAMViewfinderViewController *)self _embedLevelView];
  [(CAMViewfinderViewController *)self _embedVideoConfigurationStatusIndicatorWithLayoutStyle:style];
  [(CAMViewfinderViewController *)self _embedUtilityBar];
  [(CAMViewfinderViewController *)self _embedFilterNameBadge];
  [(CAMViewfinderViewController *)self _embedLightingControl];

  [(CAMViewfinderViewController *)self _embedLightingNameBadge];
}

- (void)_embedFlashButtonWithLayoutStyle:(int64_t)style
{
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _flashButton = [(CAMViewfinderViewController *)self _flashButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  v8 = !v7;
  if (v7)
  {
    v9 = _topBar;
  }

  else
  {
    v9 = _bottomBar;
  }

  if (v8)
  {
    v10 = _topBar;
  }

  else
  {
    v10 = _bottomBar;
  }

  [v9 setFlashButton:0];
  [v10 setFlashButton:_flashButton];
}

- (void)_embedElapsedTimeViewWithLayoutStyle:(int64_t)style
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _elapsedTimeView = [(CAMViewfinderViewController *)self _elapsedTimeView];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  v8 = !v7;
  if (v7)
  {
    v9 = _topBar;
  }

  else
  {
    v9 = viewfinderView;
  }

  if (v8)
  {
    v10 = _topBar;
  }

  else
  {
    v10 = viewfinderView;
  }

  [v9 setElapsedTimeView:0];
  [v10 setElapsedTimeView:_elapsedTimeView];
}

- (void)_embedHDRButtonWithLayoutStyle:(int64_t)style
{
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_topBar setHDRButton:0];
    v8 = _bottomBar;
    v9 = 0;
LABEL_5:
    [v8 setHDRButton:v9];
    goto LABEL_7;
  }

  if (v7)
  {
    [_topBar setHDRButton:0];
    v8 = _bottomBar;
    v9 = _HDRButton;
    goto LABEL_5;
  }

  [_bottomBar setHDRButton:0];
  [_topBar setHDRButton:_HDRButton];
  [_topBar configureForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
LABEL_7:
}

- (void)_embedFocusAndExposureLockBadge
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  [viewfinderView setFocusAndExposureLockBadge:_focusAndExposureLockBadge];
}

- (void)_embedLivePhotoButtonWithLayoutStyle:(int64_t)style
{
  _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_topBar setLivePhotoButton:0];
    v8 = _bottomBar;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [_topBar setLivePhotoButton:0];
      v8 = _bottomBar;
    }

    else
    {
      [_bottomBar setLivePhotoButton:0];
      v8 = _topBar;
    }

    v9 = _livePhotoButton;
  }

  [v8 setLivePhotoButton:v9];
}

- (void)_updateSharedLibraryButtonOnSubviewsForLayoutStyle:(int64_t)style
{
  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_topBar setSharedLibraryButton:0];
    v8 = _bottomBar;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [_topBar setSharedLibraryButton:0];
      v8 = _bottomBar;
    }

    else
    {
      [_bottomBar setSharedLibraryButton:0];
      v8 = _topBar;
    }

    v9 = _sharedLibraryButton;
  }

  [v8 setSharedLibraryButton:v9];
}

- (void)_embedSharedLibraryBadge
{
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (isEmulatingImagePicker)
  {
    _sharedLibraryBadge = 0;
  }

  else
  {
    _sharedLibraryBadge = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
  }

  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setSharedLibraryBadge:_sharedLibraryBadge];

  if (!isEmulatingImagePicker)
  {
  }
}

- (void)_embedLivePhotoBadge
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _livePhotoBadge;
  }

  [viewfinderView setLivePhotoBadge:v4];
}

- (void)_embedShallowDepthOfFieldBadge
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _shallowDepthOfFieldBadge;
  }

  [viewfinderView setShallowDepthOfFieldBadge:v4];
}

- (void)_embedPortraitModeInstructionLabel
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _portraitModeInstructionLabel = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _portraitModeInstructionLabel;
  }

  [viewfinderView setPortraitModeInstructionLabel:v4];
}

- (void)_embedCleanLensesInstructionLabel
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _cleanLensesInstructionLabel = [(CAMViewfinderViewController *)self _cleanLensesInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _cleanLensesInstructionLabel;
  }

  [viewfinderView setCleanLensesInstructionLabel:v4];
}

- (void)_embedQRCodeInstructionLabel
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _qrCodeInstructionLabel = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _qrCodeInstructionLabel;
  }

  [viewfinderView setQrCodeInstructionLabel:v4];
}

- (void)_embedFlipButtonWithLayoutStyle:(int64_t)style
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  _flipButton = [(CAMViewfinderViewController *)self _flipButton];
  v8 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  v9 = dyld_program_sdk_at_least();
  if (v8)
  {
    v10 = _topBar;
  }

  else
  {
    v10 = _bottomBar;
  }

  if (v9)
  {
    v10 = viewfinderView;
  }

  if ((v9 | v8))
  {
    v11 = _bottomBar;
  }

  else
  {
    v11 = _topBar;
  }

  [v10 setFlipButton:0];
  [v11 setFlipButton:_flipButton];
}

- (void)_embedTimerButtonWithLayoutStyle:(int64_t)style
{
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _timerButton = [(CAMViewfinderViewController *)self _timerButton];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_topBar setTimerButton:0];
    v8 = _bottomBar;
    v9 = 0;
  }

  else
  {
    if (v7)
    {
      [_topBar setTimerButton:0];
      v8 = _bottomBar;
    }

    else
    {
      [_bottomBar setTimerButton:0];
      v8 = _topBar;
    }

    v9 = _timerButton;
  }

  [v8 setTimerButton:v9];
}

- (void)_embedTimerIndicatorView
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _timerIndicatorView;
  }

  [viewfinderView setTimerIndicatorView:v4];
}

- (void)_embedShutterButton
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  bottomBar = [viewfinderView bottomBar];
  _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
  [viewfinderView setShutterButton:0];
  [bottomBar setShutterButton:_shutterButton];
}

- (void)_embedStillDuringVideoButton
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  bottomBar = [viewfinderView bottomBar];
  _stillDuringVideoButton = [(CAMViewfinderViewController *)self _stillDuringVideoButton];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v5 = 0;
  }

  else
  {
    v5 = _stillDuringVideoButton;
  }

  [bottomBar setStillDuringVideoButton:v5];
}

- (void)_embedModeDial
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  bottomBar = [viewfinderView bottomBar];
  _modeDial = [(CAMViewfinderViewController *)self _modeDial];
  [bottomBar setModeDial:_modeDial];
}

- (void)_embedApertureButtonWithLayoutStyle:(int64_t)style
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  topBar = [viewfinderView topBar];

  viewfinderView2 = [(CAMViewfinderViewController *)self viewfinderView];
  bottomBar = [viewfinderView2 bottomBar];

  v8 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [topBar setApertureButton:0];
  }

  else
  {
    if (v8)
    {
      [topBar setApertureButton:0];
      _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
      [bottomBar setApertureButton:_apertureButton];

      goto LABEL_7;
    }

    _apertureButton2 = [(CAMViewfinderViewController *)self _apertureButton];
    [topBar setApertureButton:_apertureButton2];
  }

  [bottomBar setApertureButton:0];
LABEL_7:
}

- (void)_embedIntensityButtonWithLayoutStyle:(int64_t)style
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  topBar = [viewfinderView topBar];

  v6 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker]|| v6)
  {
    [topBar setIntensityButton:0];
  }

  else
  {
    _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
    [topBar setIntensityButton:_intensityButton];
  }
}

- (void)_embedBurstIndicatorView
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _burstIndicatorView = [(CAMViewfinderViewController *)self _burstIndicatorView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _burstIndicatorView;
  }

  [viewfinderView setBurstIndicatorView:v4];
}

- (void)_embedPanoramaView
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  view = [_panoramaViewController view];
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (viewfinderView)
  {
    if (isEmulatingImagePicker)
    {
      v6 = viewfinderView;
      v7 = 0;
    }

    else
    {
      v6 = viewfinderView;
      v7 = view;
    }

    [v6 setPanoramaView:v7];
  }

  else
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setPanoramaView:view];
  }
}

- (void)_embedZoomSlider
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
  {
    zoomSlider = 0;
  }

  else
  {
    zoomSlider = self->__zoomSlider;
  }

  [viewfinderView setZoomSlider:zoomSlider];
}

- (void)_embedZoomControl
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setZoomControl:self->__zoomControl];
}

- (void)_embedGridView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  _gridView = [(CAMViewfinderViewController *)self _gridView];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v5 = 0;
  }

  else
  {
    v5 = _gridView;
  }

  [previewView setGridView:v5];
}

- (void)_unembedGridView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  [previewView setGridView:0];
  _gridView = [(CAMViewfinderViewController *)self _gridView];
  [_gridView removeFromSuperview];
}

- (void)_embedLevelView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  _levelView = [(CAMViewfinderViewController *)self _levelView];
  [previewView setLevelView:_levelView];
}

- (void)_unembedLevelView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  [previewView setLevelView:0];
  _levelView = [(CAMViewfinderViewController *)self _levelView];
  [_levelView removeFromSuperview];
}

- (void)_embedHorizonLevelView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  _horizonLevelView = [(CAMViewfinderViewController *)self _horizonLevelView];
  [previewView setHorizonLevelView:_horizonLevelView];
}

- (void)_unembedHorizonLevelView
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  [previewView setHorizonLevelView:0];
  _horizonLevelView = [(CAMViewfinderViewController *)self _horizonLevelView];
  [_horizonLevelView removeFromSuperview];
}

- (void)_embedVideoConfigurationStatusIndicatorWithLayoutStyle:(int64_t)style
{
  _videoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  v7 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v7)
  {
    v9 = _videoConfigurationStatusIndicator;
  }

  else
  {
    v9 = 0;
  }

  if (isEmulatingImagePicker || v7)
  {
    v10 = 0;
  }

  else
  {
    v10 = _videoConfigurationStatusIndicator;
  }

  if (isEmulatingImagePicker)
  {
    v11 = 0;
  }

  else
  {
    v11 = v9;
  }

  [_topBar setVideoConfigurationStatusIndicator:v10];
  [viewfinderView setVideoConfigurationStatusIndicator:v11];
}

- (void)_embedUtilityBar
{
  _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
  _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _utilityBar;
  }

  [_bottomBar setUtilityBar:v4];
}

- (void)_embedFilterNameBadge
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _filterNameBadge = [(CAMViewfinderViewController *)self _filterNameBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _filterNameBadge;
  }

  [viewfinderView setFilterNameBadge:v4];
}

- (void)_embedPortraitApertureSlider
{
  _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_utilityBar setApertureSlider:0];
  }

  else
  {
    _portraitApertureSlider = [(CAMViewfinderViewController *)self _portraitApertureSlider];
    [_utilityBar setApertureSlider:_portraitApertureSlider];
  }
}

- (void)_embedPortraitIntensitySlider
{
  _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [_utilityBar setIntensitySlider:0];
  }

  else
  {
    _portraitIntensitySlider = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
    [_utilityBar setIntensitySlider:_portraitIntensitySlider];
  }
}

- (void)_embedLightingControl
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _lightingControl = [(CAMViewfinderViewController *)self _lightingControl];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _lightingControl;
  }

  [viewfinderView setLightingControl:v4];
}

- (void)_embedLightingNameBadge
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    v4 = 0;
  }

  else
  {
    v4 = _lightingNameBadge;
  }

  [viewfinderView setLightingNameBadge:v4];
}

- (BOOL)_shouldAllowControlDrawerForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingBurst = [_captureController isCapturingBurst];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v11 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", configurationCopy, [_callStatusMonitor isCallActive]);

  v12 = [(CAMViewfinderViewController *)self _controlTypesForGraphConfiguration:configurationCopy];

  v13 = [v12 count] != 0 && !v11;
  if (_isCapturingFromTimer)
  {
    v13 = 0;
  }

  if (isCapturingTimelapse)
  {
    v13 = 0;
  }

  if (isCapturingBurst)
  {
    v13 = 0;
  }

  v14 = (isCapturingVideo & 1) == 0 && v13;

  return v14;
}

- (BOOL)_shouldAllowControlDrawerToggleForGraphConfiguration:(id)configuration orientation:(int64_t)orientation
{
  configurationCopy = configuration;
  v7 = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerForGraphConfiguration:configurationCopy];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v9 = [(CAMViewfinderViewController *)self _shouldHideElapsedTimeViewForGraphConfiguration:configurationCopy orientation:orientation];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder smartStyleControlsVisible];

  v12 = (orientation - 3) < 2 || v9;
  v13 = v12 & (smartStyleControlsVisible ^ 1);
  if (_isNightModeCaptureUIVisible)
  {
    v13 = 0;
  }

  if (v7)
  {
    return v13;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldHideTopBarForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isPerformingTopBarOrientationChange = [(CAMViewfinderViewController *)self _isPerformingTopBarOrientationChange];
  isPerformingReviewUsingOverlay = [(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay];
  isCapturingPanorama = [_captureController isCapturingPanorama];
  mode = [configurationCopy mode];
  if (mode == 5 || mode == 3)
  {
    _useMessagesControls = [(CAMViewfinderViewController *)self _useMessagesControls];
    _topBar = [(CAMViewfinderViewController *)self _topBar];
    sharedLibraryButton = [_topBar sharedLibraryButton];
    if (sharedLibraryButton)
    {
      v14 = sharedLibraryButton;
      v15 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:configurationCopy];

      _useMessagesControls |= v15;
    }

    else
    {
    }

    if (isCapturingTimelapse & 1 | ((_useMessagesControls & 1) == 0) | isCapturingPanorama & 1)
    {
      goto LABEL_9;
    }
  }

  else if ((isCapturingTimelapse | isCapturingPanorama))
  {
LABEL_9:
    v16 = 1;
    goto LABEL_10;
  }

  v16 = _isPerformingTopBarOrientationChange || isPerformingReviewUsingOverlay;
LABEL_10:

  return v16 & 1;
}

- (BOOL)_shouldHideFlashButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v11 = [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:configurationCopy];
  if ((isCapturingVideo & 1) != 0 || (isCapturingTimelapse & 1) != 0 || _isCapturingFromTimer)
  {
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    v12 = _controlDrawer == 0;
  }

  else
  {
    v12 = 0;
  }

  v14 = shouldMakeUIForDefaultPNG | (!v11 || v12);
  _flashButton = [(CAMViewfinderViewController *)self _flashButton];
  flashButton = [_topBar flashButton];

  if (_flashButton == flashButton)
  {
    v14 |= [_topBar shouldHideFlashButtonForGraphConfiguration:configurationCopy];
  }

  return v14 & 1;
}

- (BOOL)_isMenuButtonConflictingWithView:(id)view
{
  viewCopy = view;
  if (viewCopy)
  {
    _topBar = [(CAMViewfinderViewController *)self _topBar];
    _shouldExpandButtonsHorizontally = [_topBar _shouldExpandButtonsHorizontally];
    _expandedMenuButton = [_topBar _expandedMenuButton];
    _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
    _expandedMenuButton2 = [_bottomBar _expandedMenuButton];

    if (_expandedMenuButton)
    {
      if (_expandedMenuButton2)
      {
        v10 = 0;
      }

      else
      {
        v10 = _shouldExpandButtonsHorizontally;
      }

      if (v10)
      {
        goto LABEL_7;
      }
    }

    else if (!_expandedMenuButton2)
    {
LABEL_7:
      v11 = 0;
LABEL_17:

      goto LABEL_18;
    }

    if (_expandedMenuButton2)
    {
      v12 = _expandedMenuButton2;
    }

    else
    {
      v12 = _expandedMenuButton;
    }

    v13 = v12;
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    v11 = 0;
    if (_layoutStyle <= 3 && _layoutStyle != 2)
    {
      view = [(CAMViewfinderViewController *)self view];
      [v13 bounds];
      [view convertRect:v13 fromView:?];
      v17 = v16;
      v19 = v18;
      v21 = v20;
      v23 = v22;

      view2 = [(CAMViewfinderViewController *)self view];
      [viewCopy bounds];
      [view2 convertRect:viewCopy fromView:?];
      v26 = v25;
      v28 = v27;
      v30 = v29;
      v32 = v31;

      v34.origin.x = v17;
      v34.origin.y = v19;
      v34.size.width = v21;
      v34.size.height = v23;
      v35.origin.x = v26;
      v35.origin.y = v28;
      v35.size.width = v30;
      v35.size.height = v32;
      v11 = CGRectIntersectsRect(v34, v35);
    }

    goto LABEL_17;
  }

  v11 = 0;
LABEL_18:

  return v11;
}

- (BOOL)_shouldShowTextBadgeForGraphConfiguration:(id)configuration
{
  if ([(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configuration])
  {
    v4 = 0;
  }

  else
  {
    _timerCache = [(CAMViewfinderViewController *)self _timerCache];
    v6 = [_timerCache isRunningTimerForKey:&unk_1F16C7790];

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    LOBYTE(_timerCache) = [_captureController isCapturingLivePhotoVideo];

    v4 = v6 | _timerCache;
  }

  return v4 & 1;
}

- (BOOL)_shouldHideHDRButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v8 = [(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:configurationCopy];
  v9 = shouldMakeUIForDefaultPNG | ![(CAMViewfinderViewController *)self _wantsHDRControlsVisible];
  if (_isCapturingFromTimer)
  {
    LOBYTE(v9) = 1;
  }

  if (v8)
  {
    v10 = v9;
  }

  else
  {
    v10 = 1;
  }

  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  hDRButton = [_topBar HDRButton];

  if (_HDRButton == hDRButton)
  {
    v10 |= [_topBar shouldHideHDRButtonForGraphConfiguration:configurationCopy];
  }

  return v10 & 1;
}

- (BOOL)_shouldHideElapsedTimeViewForGraphConfiguration:(id)configuration orientation:(int64_t)orientation
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  mode = [configurationCopy mode];
  _useMessagesControls = 1;
  if (mode <= 8)
  {
    if (((1 << mode) & 0x186) != 0)
    {
      _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      isCapturingVideo = [_captureController isCapturingVideo];
      _useMessagesControls = 0;
      if ((orientation - 3) >= 2 && (isCapturingVideo & 1) == 0 && _layoutStyle != 1)
      {
        _useMessagesControls = [(CAMViewfinderViewController *)self _useMessagesControls];
      }
    }

    else
    {
      if (mode)
      {
        goto LABEL_10;
      }

      _captureController = [(CAMViewfinderViewController *)self _captureController];
      _useMessagesControls = [_captureController isCapturingVideo] ^ 1;
    }
  }

LABEL_10:
  v32 = _useMessagesControls;
  v33 = _topBar;
  v13 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:13 forGraphConfiguration:configurationCopy];
  v31 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:7 forGraphConfiguration:configurationCopy];
  v30 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:8 forGraphConfiguration:configurationCopy];
  v14 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:5 forGraphConfiguration:configurationCopy];
  v15 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:14 forGraphConfiguration:configurationCopy];
  v16 = [(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:15 forGraphConfiguration:configurationCopy];
  v17 = [(CAMViewfinderViewController *)self _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:configurationCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  isControlExpanded = [controlStatusBar isControlExpanded];

  v21 = 1;
  if (v13 && v31)
  {
    v22 = v33;
    v23 = v32;
  }

  else
  {
    v22 = v33;
    v23 = v32;
    if ((!v30 || !v14) && (!v13 || !v15) && (!v13 || !v16))
    {
      v21 = (v16 && v15 && !v17) | isControlExpanded;
    }
  }

  v24 = v23 | v21;
  _elapsedTimeView = [(CAMViewfinderViewController *)self _elapsedTimeView];
  elapsedTimeView = [v22 elapsedTimeView];

  if (_elapsedTimeView == elapsedTimeView)
  {
    v24 |= [v22 shouldHideElapsedTimeViewForGraphConfiguration:configurationCopy];
  }

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo2 = [_captureController2 isCapturingVideo];

  return v24 & 1 | ((isCapturingVideo2 & 1) == 0);
}

- (BOOL)_shouldHideLivePhotoButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v7 = shouldMakeUIForDefaultPNG | ![(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:configurationCopy];
  _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
  livePhotoButton = [_topBar livePhotoButton];

  if (_livePhotoButton == livePhotoButton)
  {
    LOBYTE(v7) = v7 | [_topBar shouldHideLivePhotoButtonForGraphConfiguration:configurationCopy];
  }

  return v7 & 1;
}

- (BOOL)_shouldHideLivePhotoBadgeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingLivePhotoVideo = [_captureController isCapturingLivePhotoVideo];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v8 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:configurationCopy];
  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v10 = [_timerCache isRunningTimerForKey:&unk_1F16C77A8];

  _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
  v12 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_livePhotoBadge];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  return (v12 || ((shouldMakeUIForDefaultPNG ^ 1) & v8 & (isCapturingLivePhotoVideo | v10) & 1) == 0) | self & 1;
}

- (BOOL)_shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = [configurationCopy mode] != 6;
  v6 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  v8 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_shallowDepthOfFieldBadge];

  LOBYTE(_shallowDepthOfFieldBadge) = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v9 = +[CAMCaptureCapabilities capabilities];
  arePortraitEffectsSupported = [v9 arePortraitEffectsSupported];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  return ((v5 || v8) | _shallowDepthOfFieldBadge | arePortraitEffectsSupported | v6 | self) & 1;
}

- (BOOL)_shouldShowSpatialBadgeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = -[CAMViewfinderViewController _isSpatialMode:devicePosition:](self, "_isSpatialMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition"));
  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v7 = [_timerCache isRunningTimerForKey:&unk_1F16C77C0];

  LOBYTE(_timerCache) = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isOrientationInstructionVisible = [_fullscreenViewfinder isOrientationInstructionVisible];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  return v7 & (self ^ 1) & v5 & ((_timerCache | isOrientationInstructionVisible) ^ 1);
}

- (BOOL)_shouldHidePortraitModeInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  if ((mode - 6) < 2)
  {
    isRecording = 0;
    _depthEffectEnabledFromSuggestion = 1;
  }

  else if (mode)
  {
    isRecording = 0;
    _depthEffectEnabledFromSuggestion = mode == 1 && ([configurationCopy videoStabilizationStrength] & 0xFFFFFFFFFFFFFFFELL) == 2;
  }

  else
  {
    v8 = +[CAMCaptureCapabilities capabilities];
    mode2 = [configurationCopy mode];
    devicePosition = [configurationCopy devicePosition];
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    v13 = [v8 isDepthSuggestionSupportedForMode:mode2 devicePosition:devicePosition photoFormat:currentPhotoFormat, v12];
    v14 = +[CAMCaptureCapabilities capabilities];
    portraitInPhotoModeBehavior = [v14 portraitInPhotoModeBehavior];

    _depthEffectEnabledFromSuggestion = 0;
    if (v13 && (portraitInPhotoModeBehavior & 1) != 0)
    {
      _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    }

    isRecording = [(CAMViewfinderViewController *)self isRecording];
  }

  v16 = [CAMPortraitModeInstructionLabel shouldDisplayInstructionForShallowDepthOfFieldStatus:[(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]];
  v17 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  _portraitModeInstructionLabel = [(CAMViewfinderViewController *)self _portraitModeInstructionLabel];
  v20 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_portraitModeInstructionLabel];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  LOBYTE(_fullscreenViewfinder) = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  return ((!_depthEffectEnabledFromSuggestion || !v16) | shouldMakeUIForDefaultPNG | v20 | v17 | isRecording | isSemanticStyleControlVisible | _fullscreenViewfinder) & 1;
}

- (BOOL)_shouldHideQRCodeInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  devicePosition = [configurationCopy devicePosition];

  cachedMRCResults = [_previewViewController cachedMRCResults];
  v9 = [CAMQRCodeInstructionLabel shouldDisplayInstructionForMRCResults:cachedMRCResults devicePosition:devicePosition];
  _qrCodeInstructionLabel = [(CAMViewfinderViewController *)self _qrCodeInstructionLabel];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_qrCodeInstructionLabel];

  v11 = (self & 1) != 0 || (mode & 0xFFFFFFFFFFFFFFFBLL) != 0 || !v9;
  return v11 & 1;
}

- (BOOL)_shouldHideFlipButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v6 = +[CAMCaptureCapabilities capabilities];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v26 = v6;
  if ([v6 isBackCameraSupported])
  {
    v7 = [v6 isFrontCameraSupported] ^ 1;
  }

  else
  {
    LOBYTE(v7) = 1;
  }

  v24 = v7;
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v11 = -[CAMViewfinderViewController _isFlipButtonSupportedForMode:](self, "_isFlipButtonSupportedForMode:", [configurationCopy mode]);
  v27 = configurationCopy;
  isCapturingBurst = [_captureController isCapturingBurst];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v14 = (_dynamicShutterControl != 0) & isCapturingBurst;

  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder smartStyleControlsVisible];

  v18 = v24 | !v11 | isCapturingVideo | shouldMakeUIForDefaultPNG | v14 | isCapturingTimelapse | _isNightModeCaptureUIVisible | _isCapturingFromTimer | _trueVideoIsActive | smartStyleControlsVisible;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _flipButton = [(CAMViewfinderViewController *)self _flipButton];
  flipButton = [_topBar flipButton];

  if (_flipButton == flipButton)
  {
    v18 |= [_topBar shouldHideFlipButtonForGraphConfiguration:v27];
  }

  return v18 & 1;
}

- (BOOL)_isFlipButtonSupportedForMode:(int64_t)mode
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = v4;
  v6 = 0;
  if (mode <= 3)
  {
    if (mode >= 2)
    {
      if (mode == 2)
      {
        if ([v4 isFrontSlomoSupported])
        {
          isBackSlomoSupported = [v5 isBackSlomoSupported];
          goto LABEL_17;
        }

        goto LABEL_18;
      }

      if (mode == 3)
      {
        if ([v4 isFrontPanoramaSupported])
        {
          isBackSlomoSupported = [v5 isBackPanoramaSupported];
LABEL_17:
          v6 = isBackSlomoSupported;
          goto LABEL_19;
        }

        goto LABEL_18;
      }

      goto LABEL_19;
    }

LABEL_12:
    v6 = 1;
    goto LABEL_19;
  }

  if ((mode - 4) < 2)
  {
    goto LABEL_12;
  }

  if (mode == 6)
  {
    if ([v4 isFrontPortraitModeSupported])
    {
      isBackSlomoSupported = [v5 isBackPortraitModeSupported];
      goto LABEL_17;
    }

    goto LABEL_18;
  }

  if (mode == 7)
  {
    if ([v4 isFrontCinematicModeSupported])
    {
      isBackSlomoSupported = [v5 isBackCinematicModeSupported];
      goto LABEL_17;
    }

LABEL_18:
    v6 = 0;
  }

LABEL_19:

  return v6;
}

- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  LOBYTE(self) = -[CAMViewfinderViewController _shouldHideModeDialForGraphConfiguration:isCapturingBurst:](self, "_shouldHideModeDialForGraphConfiguration:isCapturingBurst:", configurationCopy, [_captureController isCapturingBurst]);

  return self;
}

- (BOOL)_shouldHideModeDialForGraphConfiguration:(id)configuration isCapturingBurst:(BOOL)burst
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingPanorama = [_captureController isCapturingPanorama];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v10 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:configurationCopy];

  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if (_fullscreenViewfinder2)
  {
    _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  }

  else
  {
    _isCapturingFromTimer = 0;
  }

  v15 = shouldMakeUIForDefaultPNG | isCapturingVideo | (_fullscreenViewfinder != 0 && burst) | isCapturingPanorama | isCapturingTimelapse | _isNightModeCaptureUIVisible | _isCapturingFromTimer | (_layoutStyle != 1) & ~v10 | [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture];
  return v15 & 1;
}

- (BOOL)_shouldHideImageWellForGraphConfiguration:(id)configuration
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingPanorama = [_captureController isCapturingPanorama];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  isCapturingBurst = [_captureController isCapturingBurst];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  if (_dynamicShutterControl)
  {
    v12 = ![(CAMViewfinderViewController *)self _capturingFromPhysicalButton]& isCapturingBurst;
  }

  else
  {
    LOBYTE(v12) = 0;
  }

  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder smartStyleControlsVisible];

  return (shouldMakeUIForDefaultPNG | isCapturingVideo | v12 | isCapturingPanorama | isCapturingTimelapse | _isNightModeCaptureUIVisible | (_isCapturingFromTimer || _trueVideoIsActive) | smartStyleControlsVisible) & 1;
}

- (BOOL)_shouldHideStillDuringVideoButtonForGraphConfiguration:(id)configuration
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  return isCapturingVideo ^ 1;
}

- (BOOL)_shouldHideShutterButtonForGraphConfiguration:(id)configuration
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder smartStyleControlsVisible];

  return smartStyleControlsVisible;
}

- (BOOL)_shouldHideFilterButtonForGraphConfiguration:(id)configuration
{
  v4 = MEMORY[0x1E69DC668];
  configurationCopy = configuration;
  LOBYTE(v4) = [v4 shouldMakeUIForDefaultPNG];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:configurationCopy];

  return (_isCapturingFromTimer || (self & 1) == 0) | v4 & 1;
}

- (BOOL)_shouldHideApertureButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isDepthEffectApertureSupportedForMode:objc_msgSend(configurationCopy devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(configurationCopy, "devicePosition"), objc_msgSend(configurationCopy, "enableDepthSuggestion")}];

  v8 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(mode) = [v8 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v12];

  LODWORD(v8) = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  v13 = +[CAMCaptureCapabilities capabilities];
  currentPhotoFormat2 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v16 = [v13 isDepthEffectApertureSupportedForPhotoFormat:currentPhotoFormat2, v15];

  v17 = v7 & ![(CAMViewfinderViewController *)self _isCapturingFromTimer]& v16 & (mode ^ 1 | v8) ^ 1;
  _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
  apertureButton = [_topBar apertureButton];

  if (_apertureButton == apertureButton)
  {
    LOBYTE(v17) = v17 | [_topBar shouldHideApertureButtonForGraphConfiguration:configurationCopy];
  }

  return v17 & 1;
}

- (BOOL)_shouldHideIntensityButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [configurationCopy mode], objc_msgSend(configurationCopy, "device"));
  v8 = [v6 isPortraitEffectIntensitySupportedForMode:{objc_msgSend(configurationCopy, "mode")}];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LODWORD(v7) = [v6 isPortraitEffectIntensitySupportedForLightingType:v7];
  v10 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(mode) = [v10 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v14];

  v15 = v7 ^ 1 | mode & ![(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  if (_isCapturingFromTimer)
  {
    LOBYTE(v15) = 1;
  }

  if (v8)
  {
    v16 = v15;
  }

  else
  {
    v16 = 1;
  }

  _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
  intensityButton = [_topBar intensityButton];

  if (_intensityButton == intensityButton)
  {
    v16 |= [_topBar shouldHideIntensityButtonForGraphConfiguration:configurationCopy];
  }

  return v16 & 1;
}

- (BOOL)_shouldShowExposureButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];

  LODWORD(configurationCopy) = [v5 isExposureSliderSupportedForMode:mode];
  if (configurationCopy)
  {
    return ![(CAMViewfinderViewController *)self _isCapturingFromTimer];
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldHideUtilityBarForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  wantsFullscreenViewfinder = [v5 wantsFullscreenViewfinder];

  if (wantsFullscreenViewfinder)
  {
    v7 = 1;
  }

  else
  {
    shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
    _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
    v10 = _isShowingFilterScrubber & [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:configurationCopy];
    _isShowingPortraitApertureSlider = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider];
    v12 = v10 | _isShowingPortraitApertureSlider | [(CAMViewfinderViewController *)self _isShowingPortraitIntensitySlider];
    _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
    v14 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_utilityBar];

    v7 = v12 ^ 1 | v14 | shouldMakeUIForDefaultPNG;
  }

  return v7 & 1;
}

- (BOOL)_shouldHideFilterNameBadgeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v6 = [(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:configurationCopy];
  _isShowingBurstIndicatorView = [(CAMViewfinderViewController *)self _isShowingBurstIndicatorView];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  _filterNameBadge = [(CAMViewfinderViewController *)self _filterNameBadge];
  v10 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_filterNameBadge];

  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  return (_isShowingBurstIndicatorView || !v6 || !_isShowingFilterScrubber || v10) | self & 1 | shouldMakeUIForDefaultPNG & 1;
}

- (BOOL)_shouldHidePanoramaViewForGraphConfiguration:(id)configuration
{
  v4 = MEMORY[0x1E69DC668];
  configurationCopy = configuration;
  LOBYTE(v4) = [v4 shouldMakeUIForDefaultPNG];
  v6 = [configurationCopy mode] != 3;
  v7 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  LOBYTE(v4) = v6 | [_closedViewfinderController isViewfinderClosed] | v7 | v4;

  return v4 & 1;
}

- (BOOL)_shouldHideZoomSliderForGraphConfiguration:(id)configuration ignoreExpiredVisibilityTimer:(BOOL)timer
{
  configurationCopy = configuration;
  v7 = [(CAMViewfinderViewController *)self _wantsZoomSliderForGraphConfiguration:configurationCopy];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v11 = !timer && [(CAMZoomSlider *)self->__zoomSlider shouldHideForExpiredVisibilityTimer];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v13 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:configurationCopy];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  v17 = v11 | ~v7 | isCapturingBurst | shouldMakeUIForDefaultPNG;
  chromeControlPanelIsExpanded = 1;
  if ((v17 & 1) == 0 && !_isCapturingFromTimer && v13 && (isSemanticStyleControlVisible & 1) == 0 && !_wantsVisualTextAnalysis)
  {
    chromeControlPanelIsExpanded = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return chromeControlPanelIsExpanded;
}

- (BOOL)_wantsZoomSliderForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _shouldUseZoomControlInsteadOfSlider = [(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider];
  v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:configurationCopy];
  devicePosition = [configurationCopy devicePosition];

  v8 = devicePosition != 1 && v6;
  return !_shouldUseZoomControlInsteadOfSlider && v8;
}

- (BOOL)_shouldHideZoomControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingTimelapse = [_captureController isCapturingTimelapse];
  isCapturingPanorama = [_captureController isCapturingPanorama];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v29 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy];
  v9 = [(CAMViewfinderViewController *)self _zoomControlReconfiguresGraphConfiguration:configurationCopy];
  if (isCapturingVideo & 1 | !v9)
  {
    v10 = v9;
  }

  else
  {
    v10 = isCapturingTimelapse | isCapturingPanorama;
  }

  v28 = v10;
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v27 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:configurationCopy];
  v26 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:configurationCopy];
  _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
  isExpanded = [_targetLightingControl isExpanded];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isFilterScrubberVisible = [_fullscreenViewfinder isFilterScrubberVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder2 isSemanticStyleControlVisible];

  _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder3 smartStyleControlsVisible];

  v19 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v21 = _textInteractionInsert != 0;
  }

  else
  {
    v21 = 0;
  }

  chromeControlPanelIsExpanded = 1;
  if (((!v29 | isCapturingBurst | _isNightModeCaptureUIVisible | v28 | shouldMakeUIForDefaultPNG | _isCapturingFromTimer) & 1) == 0 && v27 && ((!v26 & isExpanded | isFilterScrubberVisible | v19 | isSemanticStyleControlVisible | smartStyleControlsVisible | v21) & 1) == 0 && [(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    chromeControlPanelIsExpanded = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return chromeControlPanelIsExpanded;
}

- (BOOL)_wantsZoomControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _shouldUseZoomControlInsteadOfSlider = [(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider];
  v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:configurationCopy];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForGraphConfiguration:configurationCopy];

  return _shouldUseZoomControlInsteadOfSlider & (v6 | self);
}

- (BOOL)_shouldUseZoomButtonForCameraToggleForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];
  videoConfiguration = [configurationCopy videoConfiguration];
  videoStabilizationStrength = [configurationCopy videoStabilizationStrength];
  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];

  LOBYTE(configurationCopy) = [v4 shouldAllowCameraToggleForMode:mode devicePosition:devicePosition videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength frontRearSimultaneousVideoEnabled:frontRearSimultaneousVideoEnabled];
  return configurationCopy;
}

- (BOOL)_shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldUseZoomButtonForCameraToggleForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)_shouldHideLightingControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v24 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:configurationCopy];
  _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  v5 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  isShowingZoomDial = [_zoomControl isShowingZoomDial];

  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  v9 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v14 = [v9 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v13];

  _shouldUsePhotoModePortraitEffect = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStyleControlsVisible = [_fullscreenViewfinder smartStyleControlsVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSystemOverlayVisible = [_fullscreenViewfinder2 isSystemOverlayVisible];

  v20 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:configurationCopy];
  if (v20 == 2)
  {
    v21 = isSystemOverlayVisible;
  }

  else
  {
    v21 = 0;
  }

  if (!v24 || _isShowingFilterScrubber || v5 || (isShowingZoomDial & 1) != 0 || _isCapturingFromTimer || (v14 & !_shouldUsePhotoModePortraitEffect & 1) != 0 || (smartStyleControlsVisible & 1) != 0 || (v21 & 1) != 0)
  {
    return 1;
  }

  return [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
}

- (BOOL)_wantsLightingControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  return [(CAMViewfinderViewController *)self _wantsLightingControlForMode:mode devicePosition:devicePosition];
}

- (BOOL)_wantsLightingControlForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v7 = +[CAMCaptureCapabilities capabilities];
  if (![v7 isLightingControlSupportedForMode:mode])
  {
    goto LABEL_6;
  }

  if (!mode)
  {
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v7 isDepthSuggestionSupportedForMode:0 devicePosition:position photoFormat:currentPhotoFormat, v10])
    {
      _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
      goto LABEL_7;
    }

LABEL_6:
    _depthEffectEnabledFromSuggestion = 0;
    goto LABEL_7;
  }

  _depthEffectEnabledFromSuggestion = 1;
LABEL_7:

  return _depthEffectEnabledFromSuggestion;
}

- (BOOL)_shouldHideLightingControlBadgeForGraphConfiguration:(id)configuration orientation:(int64_t)orientation
{
  v5 = orientation - 3;
  configurationCopy = configuration;
  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  v8 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];

  v10 = v5 < 2 || _layoutStyle == 1;
  return v10 || v8;
}

- (BOOL)_shouldHideLightingNameBadgeForGraphConfiguration:(id)configuration orientation:(int64_t)orientation
{
  configurationCopy = configuration;
  v7 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:configurationCopy];
  _isShowingBurstIndicatorView = [(CAMViewfinderViewController *)self _isShowingBurstIndicatorView];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
  v11 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_lightingNameBadge];

  LOBYTE(orientation) = [(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:configurationCopy orientation:orientation];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];

  return ((v7 || _isShowingBurstIndicatorView || v11) | shouldMakeUIForDefaultPNG) & 1 | ((orientation & 1) == 0) | self & 1;
}

- (BOOL)_shouldHideGridViewForGraphConfiguration:(id)configuration
{
  v3 = +[CAMUserPreferences preferences];
  shouldShowGridView = [v3 shouldShowGridView];

  return shouldShowGridView ^ 1;
}

- (BOOL)_shouldShowChromeExternalStorageIconForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];

  LOBYTE(configurationCopy) = [(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabledForMode:mode videoEncodingBehavior:videoEncodingBehavior];
  return configurationCopy & [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
}

- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)mode videoEncodingBehavior:(int64_t)behavior
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(behavior) = [v7 isExternalStorageOutputSupportedForMode:mode videoEncodingBehavior:behavior];

  _connectedStorage = [(CAMViewfinderViewController *)self _connectedStorage];
  LOBYTE(mode) = _connectedStorage != 0;

  return mode & behavior;
}

- (BOOL)_wantsExternalStorageOutputEnabledForMode:(int64_t)mode videoConfiguration:(int64_t)configuration desiredProResVideoMode:(int64_t)videoMode
{
  v9 = +[CAMUserPreferences preferences];
  LOBYTE(videoMode) = -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](self, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", mode, [v9 videoEncodingBehaviorForConfiguration:configuration mode:mode desiredProResVideoMode:videoMode outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}]);

  return videoMode;
}

- (BOOL)_wantsExternalStorageOutputEnabled
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](selfCopy, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", -[CAMViewfinderViewController _currentMode](selfCopy, "_currentMode"), [_currentGraphConfiguration videoEncodingBehavior]);

  return selfCopy;
}

- (BOOL)_shouldShowUnsupportedExternalStorageFormat
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = -[CAMViewfinderViewController _shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:](selfCopy, "_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:", [_currentGraphConfiguration videoEncodingBehavior]);

  return selfCopy;
}

- (BOOL)_shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:(int64_t)behavior
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMCaptureCapabilities capabilities];
  LODWORD(behavior) = [v6 isExternalStorageOutputSupportedForMode:_currentMode videoEncodingBehavior:behavior];

  if (!behavior)
  {
    return 0;
  }

  _connectedStorage = [(CAMViewfinderViewController *)self _connectedStorage];
  if (_connectedStorage)
  {
    hasExternalStorageNotRecommendedForCapture = 0;
  }

  else
  {
    _storageMonitor = [(CAMViewfinderViewController *)self _storageMonitor];
    hasExternalStorageNotRecommendedForCapture = [_storageMonitor hasExternalStorageNotRecommendedForCapture];
  }

  return hasExternalStorageNotRecommendedForCapture;
}

- (BOOL)_shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v6 = +[CAMUserPreferences preferences];
  if ([v6 isVideoConfigurationControlEnabled])
  {

    v7 = 0;
  }

  else
  {
    v8 = +[CAMCaptureCapabilities capabilities];
    interactiveVideoFormatControlAlwaysEnabled = [v8 interactiveVideoFormatControlAlwaysEnabled];

    if (interactiveVideoFormatControlAlwaysEnabled)
    {
      v7 = 0;
    }

    else
    {
      v10 = +[CAMCaptureCapabilities capabilities];
      mode = [configurationCopy mode];
      device = [configurationCopy device];
      videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
      videoConfiguration = [configurationCopy videoConfiguration];
      _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
      prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
      LOBYTE(v36) = [configurationCopy frontRearSimultaneousVideoEnabled];
      v17 = [v10 resolvedVideoConfigurationForMode:mode device:device videoEncodingBehavior:videoEncodingBehavior videoConfiguration:videoConfiguration outputToExternalStorage:_externalStorageOutputEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v36];

      v18 = +[CAMCaptureCapabilities capabilities];
      mode2 = [configurationCopy mode];
      device2 = [configurationCopy device];
      videoEncodingBehavior2 = [configurationCopy videoEncodingBehavior];
      _externalStorageOutputEnabled2 = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
      prefersHDR10BitVideo2 = [configurationCopy prefersHDR10BitVideo];
      LOBYTE(v37) = [configurationCopy frontRearSimultaneousVideoEnabled];
      v24 = [v18 resolvedVideoConfigurationForMode:mode2 device:device2 videoEncodingBehavior:videoEncodingBehavior2 videoConfiguration:0 outputToExternalStorage:_externalStorageOutputEnabled2 prefersHDR10BitVideo:prefersHDR10BitVideo2 frontRearSimultaneousVideoEnabled:v37];

      v7 = v17 == v24;
    }
  }

  mode3 = [configurationCopy mode];
  v26 = (mode3 > 8) | (0x79u >> mode3);
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  _elapsedTimeView = [(CAMViewfinderViewController *)self _elapsedTimeView];
  elapsedTimeView = [_topBar elapsedTimeView];

  if (_elapsedTimeView == elapsedTimeView)
  {
    v32 = [_topBar shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:configurationCopy];
    v33 = [(CAMViewfinderViewController *)self _topBarStyleForGraphConfiguration:configurationCopy capturing:isCapturingVideo];
    if ([(CAMViewfinderViewController *)self _useMessagesControls])
    {
      v32 |= [CAMTopBar isFloatingStyle:v33];
    }
  }

  else
  {
    LOBYTE(v32) = 0;
  }

  if ((v7 | v26 | shouldMakeUIForDefaultPNG))
  {
    v34 = 1;
  }

  else
  {
    v34 = isCapturingVideo | v32;
  }

  return v34 & 1;
}

- (BOOL)_shouldHideFocusAndExposureLockBadgeForGraphConfiguration:(id)configuration
{
  previewViewController = self->__previewViewController;
  configurationCopy = configuration;
  if (-[CAMPreviewViewController isFocusLockedByUser](previewViewController, "isFocusLockedByUser") || -[CAMPreviewViewController isExposureLockedByUser](self->__previewViewController, "isExposureLockedByUser") || (-[CAMViewfinderViewController _previewViewController](self, "_previewViewController"), v6 = objc_claimAutoreleasedReturnValue(), v7 = [v6 isFocusLockedOnCinematicSubject], v6, (v7 & 1) != 0))
  {
    LOBYTE(v8) = 0;
  }

  else
  {
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    v8 = [_previewViewController isFocusLockedOnDockKitSubject] ^ 1;
  }

  v9 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:configurationCopy];
  v10 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryBadgeForGraphConfiguration:configurationCopy];
  v11 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationBadgeForGraphConfiguration:configurationCopy];
  _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
  v13 = [(CAMViewfinderViewController *)self _isMenuButtonConflictingWithView:_livePhotoBadge];

  v14 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  return (v8 | v13 | !v9 | (v14 || v10 || v11)) & 1;
}

- (BOOL)_shouldHideTimerButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  shouldMakeUIForDefaultPNG = [MEMORY[0x1E69DC668] shouldMakeUIForDefaultPNG];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isTimerSupportedForMode:{objc_msgSend(configurationCopy, "mode")}];

  v9 = v8 ^ 1 | shouldMakeUIForDefaultPNG;
  _timerButton = [(CAMViewfinderViewController *)self _timerButton];
  timerButton = [_topBar timerButton];

  if (_timerButton == timerButton)
  {
    v9 |= [_topBar shouldHideTimerButtonForGraphConfiguration:configurationCopy];
  }

  return v9 & 1;
}

- (BOOL)_shouldShowNightModeControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];

  v8 = [v5 isNightModeSupportedForMode:mode device:device];
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  visibleControlTypes = [_controlDrawer visibleControlTypes];
  v11 = [visibleControlTypes containsObject:&unk_1F16C76B8];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  nightModeStatus = [_captureController nightModeStatus];

  if (nightModeStatus == -1)
  {
    v14 = v11;
  }

  else
  {
    v14 = 0;
  }

  if ((nightModeStatus - 1) >= 2)
  {
    v15 = v14;
  }

  else
  {
    v15 = 1;
  }

  return v8 & v15;
}

- (BOOL)_shouldShowVideoConfigurationIndicatorForGraphConfiguration:(id)configuration
{
  mode = [configuration mode];
  if ((mode - 1) < 2 || mode == 8)
  {
    return 1;
  }

  if (mode != 7)
  {
    return 0;
  }

  v6 = +[CAMCaptureCapabilities capabilities];
  cinematic4KSupported = [v6 cinematic4KSupported];

  return cinematic4KSupported;
}

- (BOOL)_shouldHideAspectRatioControlForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LOBYTE(configurationCopy) = [v4 isAspectRatioCropSupportedForMode:mode devicePosition:devicePosition];
  return configurationCopy ^ 1;
}

- (BOOL)_shouldShowSemanticStyleControlForGraphConfiguration:(id)configuration
{
  v4 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v4 smartStylesSupported];

  if (smartStylesSupported)
  {
    LOBYTE(v6) = 0;
  }

  else
  {
    return ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]>> 3) & 1;
  }

  return v6;
}

- (BOOL)_shouldShowSmartStyleControlForGraphConfiguration:(id)configuration
{
  v4 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v4 smartStylesSupported];

  return smartStylesSupported && ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]& 9) != 0;
}

- (BOOL)_shouldShowSmartStyleIndicatorForGraphConfiguration:(id)configuration
{
  v4 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v4 smartStylesSupported];

  if (smartStylesSupported)
  {
    return ([(CAMViewfinderViewController *)self _currentSemanticStyleSupport]>> 3) & 1;
  }

  else
  {
    LOBYTE(v6) = 0;
  }

  return v6;
}

- (BOOL)_shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:(id)configuration
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([_fullscreenViewfinder isSmartStylePickerVisible])
  {
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    smartStylePicker = [_fullscreenViewfinder2 smartStylePicker];
    expanded = [smartStylePicker expanded];
  }

  else
  {
    expanded = 0;
  }

  return expanded;
}

- (BOOL)_shouldShowRAWButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = +[CAMUserPreferences preferences];
  rawControlEnabled = [v6 rawControlEnabled];

  LODWORD(v6) = [v5 isLinearDNGSupportedForMode:{objc_msgSend(configurationCopy, "mode")}];
  v8 = [(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:configurationCopy];

  if (v6)
  {
    v9 = rawControlEnabled & !v8;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_shouldShowPhotoFormatButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 shouldUsePhotoFormatControlForMode:{objc_msgSend(configurationCopy, "mode")}];

  if (v6)
  {
    v7 = -[CAMViewfinderViewController _enabledPhotoFormatsForMode:device:](self, "_enabledPhotoFormatsForMode:device:", [configurationCopy mode], objc_msgSend(configurationCopy, "device"));
    v8 = [v7 count] > 1;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)_shouldShowProResButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = +[CAMUserPreferences preferences];
  isProResControlEnabled = [v5 isProResControlEnabled];

  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];
  mode = [configurationCopy mode];

  LOBYTE(configurationCopy) = [v4 isProResVideoSupportedForMode:mode frontRearSimultaneousVideoEnabled:frontRearSimultaneousVideoEnabled];
  return isProResControlEnabled & configurationCopy;
}

- (BOOL)_shouldShowVideoStabilizationButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoConfiguration = [configurationCopy videoConfiguration];
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  trueVideoEnabled = [configurationCopy trueVideoEnabled];
  prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];

  LOBYTE(v13) = frontRearSimultaneousVideoEnabled;
  LOBYTE(configurationCopy) = [v4 isActionModeControlSupportedForMode:mode device:device videoConfiguration:videoConfiguration videoEncodingBehavior:videoEncodingBehavior trueVideoEnabled:trueVideoEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v13];

  return configurationCopy;
}

- (BOOL)_shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v10 = [v5 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v9];

  if ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 6)
  {
    return v10;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldShowFreeResourcesInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled])
  {
    v5 = 0;
  }

  else
  {
    v6 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:configurationCopy];
    videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];

    v10 = (isCapturingVideo | [(CAMViewfinderViewController *)self _hasSignificantAmountOfRecordingTimeForCurrentConfiguration]) ^ 1;
    if (videoEncodingBehavior != 2)
    {
      LOBYTE(v10) = 0;
    }

    if (v6)
    {
      v5 = v10;
    }

    else
    {
      v5 = 0;
    }
  }

  return v5 & 1;
}

- (BOOL)_shouldShowCleanLensesInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isSmudgeDetectionSupportedForMode:{objc_msgSend(configurationCopy, "mode")}];

  if (v6)
  {
    devicePosition = [configurationCopy devicePosition];
    if (!devicePosition)
    {
      _lensSmudgeDisplayBackState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
      goto LABEL_7;
    }

    if (devicePosition == 1)
    {
      _lensSmudgeDisplayBackState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
LABEL_7:
      v9 = _lensSmudgeDisplayBackState;
      LOBYTE(v5) = [_lensSmudgeDisplayBackState shouldDisplayLensIsSmudged];
    }
  }

  else
  {
    LOBYTE(v5) = 0;
  }

  return v5 & 1;
}

- (BOOL)_shouldShowSharedLibraryBadgeForGraphConfiguration:(id)configuration
{
  v4 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configuration];
  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v6 = [_timerCache isRunningTimerForKey:&unk_1F16C77D8];

  v7 = +[CAMUserPreferences preferences];
  if ([v7 sharedLibrarySwitchEnabled])
  {
    v8 = v6 & !v4;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)_shouldShowVideoStabilizationBadgeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v17 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoConfiguration = [configurationCopy videoConfiguration];
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  trueVideoEnabled = [configurationCopy trueVideoEnabled];
  prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];

  LOBYTE(v16) = frontRearSimultaneousVideoEnabled;
  v13 = [v5 isActionModeControlSupportedForMode:mode device:device videoConfiguration:videoConfiguration videoEncodingBehavior:videoEncodingBehavior trueVideoEnabled:trueVideoEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v16];

  _isFlashingVideoStabilizationBadge = [(CAMViewfinderViewController *)self _isFlashingVideoStabilizationBadge];
  return v13 && _isFlashingVideoStabilizationBadge && !v17;
}

- (BOOL)_shouldShowImageAnalysisButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  v6 = +[CAMCaptureCapabilities capabilities];
  v22 = [v6 isImageAnalysisSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];
  isContextMenuDisplayed = [_imageAnalysisButton isContextMenuDisplayed];
  _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  currentObjectType = [_prominentObjectManager currentObjectType];
  currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];

  isImageAnalysisButtonAlwaysVisible = 1;
  v24 = _imageAnalysisButton;
  if (!_wantsVisualTextAnalysis && currentObjectType != 1 && !currentMachineReadableCodeAction && (isContextMenuDisplayed & 1) == 0)
  {
    isImageAnalysisButtonAlwaysVisible = [v6 isImageAnalysisButtonAlwaysVisible];
  }

  v23 = v6;
  v13 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy];
  v14 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:configurationCopy];
  v15 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:configurationCopy];
  v16 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:configurationCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSystemOverlayVisible = [_fullscreenViewfinder isSystemOverlayVisible];

  if ((v22 & isImageAnalysisButtonAlwaysVisible) == 1 && !(isSystemOverlayVisible & 1 | ((([(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:configurationCopy]&& (!v13 || v15 != 2)) & ((v16 != 2) | ~v14) & 1) == 0)))
  {
    v19 = [(CAMViewfinderViewController *)self chromeControlPanelIsExpanded]^ 1;
  }

  else
  {
    v19 = 0;
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setShouldShowImageAnalysisButton:v19];

  return v19;
}

- (BOOL)_shouldShowImageAnalysisInstructionLabel
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextSelectionInstructions])
  {
    return 1;
  }

  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v5 = [_timerCache isRunningTimerForKey:&unk_1F16C7760];

  return v5;
}

- (BOOL)_shouldShowSharedLibraryIndicatorForGraphConfiguration:(id)configuration
{
  if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    return 0;
  }

  v4 = +[CAMUserPreferences preferences];
  sharedLibrarySwitchEnabled = [v4 sharedLibrarySwitchEnabled];

  return sharedLibrarySwitchEnabled;
}

- (BOOL)_shouldShowPreviewOverlayButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  isShowingZoomDial = [_zoomControl isShowingZoomDial];

  _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
  [_zoomSlider alpha];
  v9 = v8;

  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  if (v9 > 0.0)
  {
    v11 = 1;
  }

  else
  {
    v11 = isShowingZoomDial;
  }

  if (_layoutStyle == 1)
  {
    v12 = 0;
  }

  else
  {
    v12 = v11;
  }

  _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
  isExpanded = [_targetLightingControl isExpanded];

  v15 = [(CAMViewfinderViewController *)self _layoutStyle]!= 1;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];
  isCapturingBurst = [_captureController isCapturingBurst];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v20 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];

  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  LOBYTE(configurationCopy) = 0;
  if ((isCapturingVideo & 1) == 0 && !_isNightModeCaptureUIVisible && (isCapturingBurst & 1) == 0 && !v20 && (v12 & 1) == 0 && !_isCapturingFromTimer && (v15 & isExpanded & 1) == 0)
  {
    LODWORD(configurationCopy) = ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }

  return configurationCopy;
}

- (BOOL)_shouldShowFrontPIPButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  v7 = devicePosition == 0;
  LOBYTE(devicePosition) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:mode devicePosition:devicePosition];
  LOBYTE(v7) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:mode devicePosition:v7];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  LOBYTE(v7) = (devicePosition | v7) & ~[_captureController isCapturingVideo];

  return v7 & 1;
}

- (BOOL)_shouldShowAutoMacroButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isSuperWideAutoMacroSupportedForMode:mode device:objc_msgSend(configurationCopy videoConfiguration:"device") videoStabilizationStrength:objc_msgSend(configurationCopy frontRearSimultaneousVideoEnabled:{"videoConfiguration"), objc_msgSend(configurationCopy, "videoStabilizationStrength"), objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];

  devicePosition = [configurationCopy devicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [CAMConflictingControlConfiguration shouldDisableMacroForLockedPortraitForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat optionalDepthEffectEnabled:v10, [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]];
  v12 = +[CAMUserPreferences preferences];
  isSuperWideAutoMacroControlAllowed = [v12 isSuperWideAutoMacroControlAllowed];

  _autoMacroSuggested = [(CAMViewfinderViewController *)self _autoMacroSuggested];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v16 = _textInteractionInsert != 0;
  }

  else
  {
    v16 = 0;
  }

  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  v18 = 0;
  if ((v7 & isSuperWideAutoMacroControlAllowed & _autoMacroSuggested) == 1 && !v16)
  {
    v19 = isEmulatingImagePicker;
    if ([(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:configurationCopy])
    {
      v18 = !v11 && !v19;
    }

    else
    {
      v18 = 0;
    }
  }

  return v18;
}

- (BOOL)_shouldShowDepthSuggestionButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  v7 = [configurationCopy device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v5 isDepthSuggestionSupportedForMode:mode devicePosition:v8 photoFormat:currentPhotoFormat, v10];
  v12 = [(CAMViewfinderViewController *)self _isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:[(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]];
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis])
  {
    _textInteractionInsert = [(CAMViewfinderViewController *)self _textInteractionInsert];
    v14 = _textInteractionInsert != 0;
  }

  else
  {
    v14 = 0;
  }

  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  v20 = 0;
  if ((v11 & v12) == 1 && !v14 && _resolvedRAWMode != 1 && (isSemanticStyleControlVisible & 1) == 0 && (isSmartStylePickerVisible & 1) == 0)
  {
    v20 = [(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:configurationCopy];
  }

  return v20;
}

- (int64_t)_visibleSuggestionButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v7 = [(CAMViewfinderViewController *)self _shouldShowAutoMacroButtonForGraphConfiguration:configurationCopy];
  if (v7 && _isReconfiguring)
  {
    v7 = [_fullscreenViewfinder visibleSuggestionButtonType] == 1;
  }

  _resolvedMacroMode = [(CAMViewfinderViewController *)self _resolvedMacroMode];
  v9 = [(CAMViewfinderViewController *)self _shouldShowDepthSuggestionButtonForGraphConfiguration:configurationCopy];
  if (v9 && _isReconfiguring)
  {
    v9 = [_fullscreenViewfinder visibleSuggestionButtonType] == 2;
  }

  v10 = v7;
  if (v9)
  {
    v10 = 2;
  }

  if (v7 && _resolvedMacroMode == 1)
  {
    v11 = 1;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (BOOL)_shouldHideControlStatusIndicatorsForCommonStateForType:(unint64_t)type
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  _isNightModeCaptureUIVisible = [(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible];
  v9 = (-[CAMViewfinderViewController _isCapturingFromTimer](self, "_isCapturingFromTimer") || ([_captureController isCapturingBurst] & 1) != 0 || objc_msgSend(_captureController, "isCapturingVideo") && ((v8 = objc_msgSend(_captureController, "videoCapturePaused"), type) || !v8) || (objc_msgSend(_captureController, "isCapturingTimelapse") & 1) != 0 || ((objc_msgSend(_captureController, "isCapturingPanorama") | _isNightModeCaptureUIVisible) & 1) != 0) && !_trueVideoIsActive;

  return v9;
}

- (BOOL)_shouldHideBadgesForGraphConfiguration:(id)configuration
{
  if ([(CAMViewfinderViewController *)self _wantsVisualTextAnalysis]|| ([(CAMViewfinderViewController *)self chromeTopBarMenuState]== 3 || [(CAMViewfinderViewController *)self chromeTopBarMenuState]== 2) && ![(CAMViewfinderViewController *)self _currentHalfPressSpotlight])
  {
    return 1;
  }

  if (![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded])
  {
    return 0;
  }

  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v5 = ([_motionController captureOrientation] - 3) < 2;

  return v5;
}

- (BOOL)_shouldShowIndicatorOfType:(unint64_t)type forGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self _shouldHideControlStatusIndicatorsForCommonStateForType:type])
  {
    v7 = 0;
  }

  else
  {
    switch(type)
    {
      case 0uLL:
        if ([(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:configurationCopy])
        {
          goto LABEL_49;
        }

        goto LABEL_51;
      case 1uLL:
        if (![(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 2uLL:
        if (![(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:configurationCopy]|| ![(CAMViewfinderViewController *)self _wantsHDRControlsVisible]|| [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 3uLL:
        v12 = +[CAMCaptureCapabilities capabilities];
        if (([v12 isTimerSupportedForMode:{objc_msgSend(configurationCopy, "mode")}] & 1) == 0)
        {
          goto LABEL_50;
        }

        _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];

        if (!_resolvedTimerDuration)
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 4uLL:
        mode = [configurationCopy mode];
        v9 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:mode];
        v10 = [CAMUserPreferences defaultFilterTypeForMode:mode];
        v11 = 0;
        if (![(CAMViewfinderViewController *)self _shouldUseFiltersForGraphConfiguration:configurationCopy]|| v9 == v10)
        {
          goto LABEL_52;
        }

        goto LABEL_49;
      case 5uLL:
        v24 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:configurationCopy];
        [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
        v26 = v25;
        [(CAMViewfinderViewController *)self _portraitModeApertureValue];
        v28 = vabdd_f64(v26, v27) < 0.0001;
        v29 = +[CAMCaptureCapabilities capabilities];
        mode2 = [configurationCopy mode];
        devicePosition = [configurationCopy devicePosition];
        currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
        LODWORD(mode2) = [v29 isDepthSuggestionSupportedForMode:mode2 devicePosition:devicePosition photoFormat:currentPhotoFormat, v33];

        v11 = 0;
        if ((v28 & mode2 & 1) != 0 || v24)
        {
          goto LABEL_52;
        }

        goto LABEL_49;
      case 6uLL:
        if ([(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 7uLL:
        -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), [configurationCopy trueVideoEnabled]);
        v15 = v14;
        v16 = +[CAMUserPreferences preferences];
        preserveExposure = [v16 preserveExposure];

        _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        isExposureSliderVisible = [_fullscreenViewfinder isExposureSliderVisible];

        v20 = [(CAMViewfinderViewController *)self _isExposureBiasNonDefault:v15];
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 isExposureSliderSupportedForMode:{objc_msgSend(configurationCopy, "mode")}];

        if (preserveExposure & 1 | ((v22 & 1) == 0))
        {
          v23 = v22;
        }

        else
        {
          v23 = isExposureSliderVisible | v20;
        }

        if ((v23 & 1) == 0)
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 8uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowVideoConfigurationIndicatorForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 9uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowNightModeControlForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xAuLL:
        _semanticStyleForPreview = [(CAMViewfinderViewController *)self _semanticStyleForPreview];
        v12 = _semanticStyleForPreview;
        if (_semanticStyleForPreview)
        {
          v35 = [_semanticStyleForPreview isNeutral] ^ 1;
        }

        else
        {
          LOBYTE(v35) = 0;
        }

        _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        isSemanticStyleControlVisible = [_fullscreenViewfinder2 isSemanticStyleControlVisible];

        if ([(CAMViewfinderViewController *)self _shouldShowSemanticStyleControlForGraphConfiguration:configurationCopy])
        {

          if ((v35 | isSemanticStyleControlVisible))
          {
LABEL_49:
            v11 = [(CAMViewfinderViewController *)self _canShowIndicatorDuringTrueVideoRecordingForType:type withGraphConfiguration:configurationCopy];
            goto LABEL_52;
          }
        }

        else
        {
LABEL_50:
        }

LABEL_51:
        v11 = 0;
LABEL_52:
        _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        v39 = [_fullscreenViewfinder3 smartStyleControlsVisible] ^ 1;

        if (type == 11)
        {
          v40 = 1;
        }

        else
        {
          v40 = v39;
        }

        v7 = v40 & v11;
        break;
      case 0xBuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowSmartStyleIndicatorForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xCuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xDuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xEuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowSharedLibraryIndicatorForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0xFuLL:
        if (![(CAMViewfinderViewController *)self _shouldShowVideoStabilizationButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      case 0x10uLL:
        if (![(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:configurationCopy])
        {
          goto LABEL_51;
        }

        goto LABEL_49;
      default:
        goto LABEL_51;
    }
  }

  return v7;
}

- (BOOL)_canShowIndicatorDuringTrueVideoRecordingForType:(unint64_t)type withGraphConfiguration:(id)configuration
{
  v5 = [configuration trueVideoEnabled] ^ 1;
  if (type == 8)
  {
    return 1;
  }

  else
  {
    return v5;
  }
}

- (BOOL)_shouldShowDrawerControlOfType:(int64_t)type forGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  switch(type)
  {
    case 0:
      v7 = [(CAMViewfinderViewController *)self _shouldHideFlashButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 1:
      v7 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 2:
      v7 = [(CAMViewfinderViewController *)self _shouldHideAspectRatioControlForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 3:
      v7 = [(CAMViewfinderViewController *)self _shouldHideTimerButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 4:
      v7 = [(CAMViewfinderViewController *)self _shouldHideFilterButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 5:
      v7 = [(CAMViewfinderViewController *)self _shouldHideHDRButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 6:
      v7 = [(CAMViewfinderViewController *)self _shouldHideApertureButtonForGraphConfiguration:configurationCopy];
      goto LABEL_16;
    case 7:
      v7 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:configurationCopy];
LABEL_16:
      v9 = !v7;
      break;
    case 8:
      v8 = [(CAMViewfinderViewController *)self _shouldShowExposureButtonForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 9:
      v8 = [(CAMViewfinderViewController *)self _shouldShowNightModeControlForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 10:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSemanticStyleControlForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 11:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSmartStyleControlForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 12:
      v8 = [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 13:
      v8 = [(CAMViewfinderViewController *)self _shouldShowProResButtonForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 14:
      v8 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryButtonForGraphConfiguration:configurationCopy];
      goto LABEL_19;
    case 15:
      v8 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationButtonForGraphConfiguration:configurationCopy];
LABEL_19:
      v9 = v8;
      break;
    default:
      v9 = 0;
      break;
  }

  return v9;
}

- (void)_hideControlsForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  shouldLayoutLightingNameBadgeAtBottom = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v10 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:configurationCopy orientation:captureOrientation];
  if (animatedCopy)
  {
    v11 = 0.25;
  }

  else
  {
    v11 = 0.0;
  }

  v35[0] = MEMORY[0x1E69E9820];
  v35[1] = 3221225472;
  v35[2] = __75__CAMViewfinderViewController__hideControlsForGraphConfiguration_animated___block_invoke;
  v35[3] = &unk_1E76F97C8;
  v35[4] = self;
  v12 = configurationCopy;
  v36 = v12;
  v37 = captureOrientation;
  v33 = v10;
  v34 = shouldLayoutLightingNameBadgeAtBottom;
  v38 = v10;
  v39 = shouldLayoutLightingNameBadgeAtBottom;
  [CAMView animateIfNeededWithDuration:v35 animations:v11];
  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v12 mode], 0, 1, animatedCopy);
  if ([(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v12 orientation:captureOrientation])
  {
    [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:1 animated:animatedCopy];
  }

  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v14 = MEMORY[0x1E695DFD8];
  visibleTopBadges = [viewfinderView visibleTopBadges];
  v16 = [v14 setWithArray:visibleTopBadges];

  v17 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v12];
  v18 = [(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:v12];
  v19 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v12];
  v20 = [MEMORY[0x1E695DF70] arrayWithCapacity:{objc_msgSend(v16, "count")}];
  if (!v17)
  {
    _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
    v22 = [v16 containsObject:_livePhotoBadge];

    if (v22)
    {
      _livePhotoBadge2 = [(CAMViewfinderViewController *)self _livePhotoBadge];
      [v20 addObject:_livePhotoBadge2];
    }
  }

  if (!v18)
  {
    _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
    v25 = [v16 containsObject:_shallowDepthOfFieldBadge];

    if (v25)
    {
      _shallowDepthOfFieldBadge2 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
      [v20 addObject:_shallowDepthOfFieldBadge2];
    }
  }

  if (!v19)
  {
    _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    v28 = [v16 containsObject:_focusAndExposureLockBadge];

    if (v28)
    {
      _focusAndExposureLockBadge2 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
      [v20 addObject:_focusAndExposureLockBadge2];
    }
  }

  if (!v33 && !v34)
  {
    _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
    v31 = [v16 containsObject:_lightingNameBadge];

    if (v31)
    {
      _lightingNameBadge2 = [(CAMViewfinderViewController *)self _lightingNameBadge];
      [v20 addObject:_lightingNameBadge2];
    }
  }

  [viewfinderView setVisibleTopBadges:v20 animated:animatedCopy];
}

void __75__CAMViewfinderViewController__hideControlsForGraphConfiguration_animated___block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1640) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1632) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1648) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1656) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)])
  {
    [*(*(a1 + 32) + 1728) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1672) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1680) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHidePortraitModeInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1760) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowCleanLensesInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1768) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideQRCodeInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1792) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)])
  {
    v2 = [*(a1 + 32) viewfinderView];
    v3 = [v2 flipButton];
    [v3 setAlpha:0.0];

    v4 = [*(a1 + 32) _bottomBar];
    v5 = [v4 flipButton];
    [v5 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)])
  {
    v6 = [*(a1 + 32) _bottomBar];
    v7 = [v6 modeDial];
    [v7 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1816) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1832) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1856) setAlpha:0.0];
  }

  v8 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if (v8)
  {
    [*(*(a1 + 32) + 1864) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1936) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1712) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)])
  {
    v9 = [*(a1 + 32) _panoramaViewController];
    v10 = [v9 view];
    [v10 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1888) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)])
  {
    v11 = [*(a1 + 32) viewfinderView];
    v12 = [v11 zoomControl];
    [v12 setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1960) setAlpha:0.0];
  }

  if (*(a1 + 56) == 1 && *(a1 + 57) == 1)
  {
    [*(*(a1 + 32) + 1968) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1904) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1912) setAlpha:0.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if ([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1920) setAlpha:0.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if ([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1984) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1664) setAlpha:0.0];
  }

  if ([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1880) setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v13 = [*(a1 + 32) _bottomBar];
    v14 = [v13 imageAnalysisButton];
    [v14 setAlpha:0.0];
  }

  if (([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel] & 1) == 0)
  {
    v15 = [*(a1 + 32) _imageAnalysisInstructionLabel];
    [v15 setAlpha:0.0];
  }

  v16 = [*(a1 + 32) chromeConfigurator];
  [v16 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setIsPortraitEffectIntensitySliderSupported:v8 ^ 1u];
}

- (void)_showControlsForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  shouldLayoutLightingNameBadgeAtBottom = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v10 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:configurationCopy orientation:captureOrientation];
  if (animatedCopy)
  {
    v11 = 0.25;
  }

  else
  {
    v11 = 0.0;
  }

  v42[0] = MEMORY[0x1E69E9820];
  v42[1] = 3221225472;
  v42[2] = __75__CAMViewfinderViewController__showControlsForGraphConfiguration_animated___block_invoke;
  v42[3] = &unk_1E76F97C8;
  v42[4] = self;
  v12 = configurationCopy;
  v43 = v12;
  v44 = captureOrientation;
  v39 = v10;
  v40 = shouldLayoutLightingNameBadgeAtBottom;
  v45 = v10;
  v46 = shouldLayoutLightingNameBadgeAtBottom;
  [CAMView animateIfNeededWithDuration:v42 animations:v11];
  if (![(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v12 orientation:captureOrientation])
  {
    [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:0 animated:animatedCopy];
  }

  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v12 mode], 1, 0, animatedCopy);
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v14 = MEMORY[0x1E695DFD8];
  visibleTopBadges = [viewfinderView visibleTopBadges];
  v16 = [v14 setWithArray:visibleTopBadges];

  _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
  if (_livePhotoBadge)
  {
    v18 = ![(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:v12];
  }

  else
  {
    v18 = 0;
  }

  v41 = animatedCopy;

  _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  if (_shallowDepthOfFieldBadge)
  {
    v20 = ![(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:v12];
  }

  else
  {
    v20 = 0;
  }

  _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  if (_focusAndExposureLockBadge)
  {
    v22 = ![(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:v12];
  }

  else
  {
    v22 = 0;
  }

  _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
  v24 = _lightingNameBadge == 0;

  v25 = [MEMORY[0x1E695DF70] arrayWithCapacity:{objc_msgSend(v16, "count")}];
  if ((v18 & 1) != 0 || (-[CAMViewfinderViewController _livePhotoBadge](self, "_livePhotoBadge"), v26 = objc_claimAutoreleasedReturnValue(), v27 = [v16 containsObject:v26], v26, v27))
  {
    _livePhotoBadge2 = [(CAMViewfinderViewController *)self _livePhotoBadge];
    [v25 addObject:_livePhotoBadge2];
  }

  v29 = v24 || v39;
  if ((v20 & 1) != 0 || (-[CAMViewfinderViewController _shallowDepthOfFieldBadge](self, "_shallowDepthOfFieldBadge"), v30 = objc_claimAutoreleasedReturnValue(), v31 = [v16 containsObject:v30], v30, v31))
  {
    _shallowDepthOfFieldBadge2 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
    [v25 addObject:_shallowDepthOfFieldBadge2];
  }

  if ((v22 & 1) != 0 || (-[CAMViewfinderViewController _focusAndExposureLockBadge](self, "_focusAndExposureLockBadge"), v33 = objc_claimAutoreleasedReturnValue(), v34 = [v16 containsObject:v33], v33, v34))
  {
    _focusAndExposureLockBadge2 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    [v25 addObject:_focusAndExposureLockBadge2];
  }

  if (!v29 && !v40 || (-[CAMViewfinderViewController _lightingNameBadge](self, "_lightingNameBadge"), v36 = objc_claimAutoreleasedReturnValue(), v37 = [v16 containsObject:v36], v36, v37))
  {
    _lightingNameBadge2 = [(CAMViewfinderViewController *)self _lightingNameBadge];
    [v25 addObject:_lightingNameBadge2];
  }

  [viewfinderView setVisibleTopBadges:v25 animated:v41];
}

void __75__CAMViewfinderViewController__showControlsForGraphConfiguration_animated___block_invoke(uint64_t a1)
{
  if (([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1640) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1632) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1648) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1656) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1728) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1672) setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1680) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHidePortraitModeInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1760) setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowCleanLensesInstructionLabelForGraphConfiguration:*(a1 + 40)])
  {
    [*(*(a1 + 32) + 1768) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideQRCodeInstructionLabelForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1792) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v2 = [*(a1 + 32) viewfinderView];
    v3 = [v2 flipButton];
    [v3 setAlpha:1.0];

    v4 = [*(a1 + 32) _bottomBar];
    v5 = [v4 flipButton];
    [v5 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v6 = [*(a1 + 32) _bottomBar];
    v7 = [v6 modeDial];
    [v7 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1816) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1832) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1856) setAlpha:1.0];
  }

  v8 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if ((v8 & 1) == 0)
  {
    [*(*(a1 + 32) + 1864) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1936) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1712) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v9 = [*(a1 + 32) _panoramaViewController];
    v10 = [v9 view];
    [v10 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1888) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    v11 = [*(a1 + 32) viewfinderView];
    v12 = [v11 zoomControl];
    [v12 setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1960) setAlpha:1.0];
  }

  if ((*(a1 + 56) & 1) == 0 && *(a1 + 57) == 1)
  {
    [*(*(a1 + 32) + 1968) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1904) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1912) setAlpha:1.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if (([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1920) setAlpha:1.0];
    [*(a1 + 32) _updateLevelMotionTracking];
  }

  if (([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1984) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1664) setAlpha:1.0];
  }

  if (([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)] & 1) == 0)
  {
    [*(*(a1 + 32) + 1880) setAlpha:1.0];
  }

  v13 = [*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)];
  if (v13)
  {
    [*(a1 + 32) _createImageAnalysisButtonIfNeededForConfiguration:*(a1 + 40)];
    v14 = [*(a1 + 32) _bottomBar];
    v15 = [v14 imageAnalysisButton];
    [v15 setAlpha:1.0];
  }

  if ([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel])
  {
    v16 = [*(a1 + 32) _imageAnalysisInstructionLabel];
    [v16 setAlpha:1.0];
  }

  v17 = [*(a1 + 32) chromeConfigurator];
  [v17 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setShouldShowImageAnalysisButton:v13];

  v19 = [*(a1 + 32) chromeConfigurator];
  [v19 setIsPortraitEffectIntensitySliderSupported:v8 ^ 1u];
}

- (void)updateControlVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  if (animatedCopy)
  {
    v8 = 0.25;
  }

  else
  {
    v8 = 0.0;
  }

  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __63__CAMViewfinderViewController_updateControlVisibilityAnimated___block_invoke;
  v10[3] = &unk_1E76F97F0;
  v10[4] = self;
  v11 = _currentGraphConfiguration;
  v12 = captureOrientation;
  v9 = _currentGraphConfiguration;
  [CAMView animateIfNeededWithDuration:v10 animations:v8];
  [(CEKLightingControl *)self->__lightingControl setNameBadgeHidden:[(CAMViewfinderViewController *)self _shouldHideLightingControlBadgeForGraphConfiguration:v9 orientation:captureOrientation] animated:animatedCopy];
  -[CAMViewfinderViewController _updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:](self, "_updateDescriptionOverlayVisibilityForMode:allowShow:allowHide:animated:", [v9 mode], 1, 1, animatedCopy);
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v9 animated:animatedCopy];
}

void __63__CAMViewfinderViewController_updateControlVisibilityAnimated___block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) _shouldHideBottomBarForGraphConfiguration:*(a1 + 40)])
  {
    v2 = 0.0;
  }

  else
  {
    v2 = 1.0;
  }

  [*(*(a1 + 32) + 1640) setAlpha:v2];
  if ([*(a1 + 32) _shouldHideTopBarForGraphConfiguration:*(a1 + 40)])
  {
    v3 = 0.0;
  }

  else
  {
    v3 = 1.0;
  }

  [*(*(a1 + 32) + 1632) setAlpha:v3];
  if ([*(a1 + 32) _shouldHideFlashButtonForGraphConfiguration:*(a1 + 40)])
  {
    v4 = 0.0;
  }

  else
  {
    v4 = 1.0;
  }

  [*(*(a1 + 32) + 1648) setAlpha:v4];
  if ([*(a1 + 32) _shouldHideHDRButtonForGraphConfiguration:*(a1 + 40)])
  {
    v5 = 0.0;
  }

  else
  {
    v5 = 1.0;
  }

  [*(*(a1 + 32) + 1656) setAlpha:v5];
  if ([*(a1 + 32) _shouldHideElapsedTimeViewForGraphConfiguration:*(a1 + 40) orientation:*(a1 + 48)])
  {
    v6 = 0.0;
  }

  else
  {
    v6 = 1.0;
  }

  [*(*(a1 + 32) + 1728) setAlpha:v6];
  if ([*(a1 + 32) _shouldHideLivePhotoButtonForGraphConfiguration:*(a1 + 40)])
  {
    v7 = 0.0;
  }

  else
  {
    v7 = 1.0;
  }

  [*(*(a1 + 32) + 1672) setAlpha:v7];
  if ([*(a1 + 32) _shouldShowSharedLibraryButtonForGraphConfiguration:*(a1 + 40)])
  {
    v8 = 1.0;
  }

  else
  {
    v8 = 0.0;
  }

  [*(*(a1 + 32) + 1680) setAlpha:v8];
  if ([*(a1 + 32) _shouldHideFlipButtonForGraphConfiguration:*(a1 + 40)])
  {
    v9 = 0.0;
  }

  else
  {
    v9 = 1.0;
  }

  v10 = [*(a1 + 32) viewfinderView];
  v11 = [v10 flipButton];
  [v11 setAlpha:v9];

  v12 = [*(a1 + 32) _bottomBar];
  v13 = [v12 flipButton];
  [v13 setAlpha:v9];

  if ([*(a1 + 32) _shouldHideModeDialForGraphConfiguration:*(a1 + 40)])
  {
    v14 = 0.0;
  }

  else
  {
    v14 = 1.0;
  }

  v15 = [*(a1 + 32) _bottomBar];
  v16 = [v15 modeDial];
  [v16 setAlpha:v14];

  if ([*(a1 + 32) _shouldHideShutterButtonForGraphConfiguration:*(a1 + 40)])
  {
    v17 = 0.0;
  }

  else
  {
    v17 = 1.0;
  }

  [*(*(a1 + 32) + 1816) setAlpha:v17];
  if ([*(a1 + 32) _shouldHideStillDuringVideoButtonForGraphConfiguration:*(a1 + 40)])
  {
    v18 = 0.0;
  }

  else
  {
    v18 = 1.0;
  }

  [*(*(a1 + 32) + 1832) setAlpha:v18];
  if ([*(a1 + 32) _shouldHideApertureButtonForGraphConfiguration:*(a1 + 40)])
  {
    v19 = 0.0;
  }

  else
  {
    v19 = 1.0;
  }

  [*(*(a1 + 32) + 1856) setAlpha:v19];
  v20 = [*(a1 + 32) _shouldHideIntensityButtonForGraphConfiguration:*(a1 + 40)];
  if (v20)
  {
    v21 = 0.0;
  }

  else
  {
    v21 = 1.0;
  }

  [*(*(a1 + 32) + 1864) setAlpha:v21];
  if ([*(a1 + 32) _shouldHideUtilityBarForGraphConfiguration:*(a1 + 40)])
  {
    v22 = 0.0;
  }

  else
  {
    v22 = 1.0;
  }

  [*(*(a1 + 32) + 1936) setAlpha:v22];
  if ([*(a1 + 32) _shouldHideFilterNameBadgeForGraphConfiguration:*(a1 + 40)])
  {
    v23 = 0.0;
  }

  else
  {
    v23 = 1.0;
  }

  [*(*(a1 + 32) + 1712) setAlpha:v23];
  if ([*(a1 + 32) _shouldHidePanoramaViewForGraphConfiguration:*(a1 + 40)])
  {
    v24 = 0.0;
  }

  else
  {
    v24 = 1.0;
  }

  v25 = [*(a1 + 32) _panoramaViewController];
  v26 = [v25 view];
  [v26 setAlpha:v24];

  if ([*(a1 + 32) _shouldHideZoomSliderForGraphConfiguration:*(a1 + 40)])
  {
    v27 = 0.0;
  }

  else
  {
    v27 = 1.0;
  }

  [*(*(a1 + 32) + 1888) setAlpha:v27];
  if ([*(a1 + 32) _shouldHideZoomControlForGraphConfiguration:*(a1 + 40)])
  {
    v28 = 0.0;
  }

  else
  {
    v28 = 1.0;
  }

  v29 = [*(a1 + 32) viewfinderView];
  v30 = [v29 zoomControl];
  [v30 setAlpha:v28];

  if ([*(a1 + 32) _shouldHideLightingControlForGraphConfiguration:*(a1 + 40)])
  {
    v31 = 0.0;
  }

  else
  {
    v31 = 1.0;
  }

  [*(*(a1 + 32) + 1960) setAlpha:v31];
  if ([*(a1 + 32) _shouldHideGridViewForGraphConfiguration:*(a1 + 40)])
  {
    v32 = 0.0;
  }

  else
  {
    v32 = 1.0;
  }

  [*(*(a1 + 32) + 1904) setAlpha:v32];
  if ([*(a1 + 32) _shouldHideLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    v33 = 0.0;
  }

  else
  {
    v33 = 1.0;
  }

  [*(*(a1 + 32) + 1912) setAlpha:v33];
  if ([*(a1 + 32) _shouldHideHorizonLevelViewForGraphConfiguration:*(a1 + 40)])
  {
    v34 = 0.0;
  }

  else
  {
    v34 = 1.0;
  }

  [*(*(a1 + 32) + 1920) setAlpha:v34];
  [*(a1 + 32) _updateLevelMotionTracking];
  if ([*(a1 + 32) _shouldHideVideoConfigurationStatusIndicatorForGraphConfiguration:*(a1 + 40)])
  {
    v35 = 0.0;
  }

  else
  {
    v35 = 1.0;
  }

  [*(*(a1 + 32) + 1984) setAlpha:v35];
  if ([*(a1 + 32) _shouldHideTimerButtonForGraphConfiguration:*(a1 + 40)])
  {
    v36 = 0.0;
  }

  else
  {
    v36 = 1.0;
  }

  [*(*(a1 + 32) + 1664) setAlpha:v36];
  if ([*(a1 + 32) _shouldHideTimerIndicatorViewForGraphConfiguration:*(a1 + 40)])
  {
    v37 = 0.0;
  }

  else
  {
    v37 = 1.0;
  }

  [*(*(a1 + 32) + 1880) setAlpha:v37];
  v38 = [*(a1 + 32) _shouldShowImageAnalysisButtonForGraphConfiguration:*(a1 + 40)];
  if (v38)
  {
    v39 = 1.0;
  }

  else
  {
    v39 = 0.0;
  }

  v40 = [*(a1 + 32) _bottomBar];
  v41 = [v40 imageAnalysisButton];
  [v41 setAlpha:v39];

  if ([*(a1 + 32) _shouldShowImageAnalysisInstructionLabel])
  {
    v42 = 1.0;
  }

  else
  {
    v42 = 0.0;
  }

  v43 = [*(a1 + 32) _imageAnalysisInstructionLabel];
  [v43 setAlpha:v42];

  v44 = [*(a1 + 32) chromeConfigurator];
  [v44 setExternalStorageIconVisible:{objc_msgSend(*(a1 + 32), "_shouldShowChromeExternalStorageIconForGraphConfiguration:", *(a1 + 40))}];

  v45 = [*(a1 + 32) chromeConfigurator];
  [v45 setShouldShowImageAnalysisButton:v38];

  v46 = [*(a1 + 32) chromeConfigurator];
  [v46 setIsPortraitEffectIntensitySliderSupported:v20 ^ 1u];
}

- (void)handleExternalChromeShutterControlChanged:(id)changed
{
  objc_storeStrong(&self->__dynamicShutterControl, changed);
  changedCopy = changed;
  [changedCopy setDelegate:self];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:[(CAMViewfinderViewController *)self _isCapturing] animated:0];

  [(CAMViewfinderViewController *)self _updateShutterEffectsEnablementForSystemPressureState];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl convergeAllSprings];
}

- (void)handleExternalChromeFilterScrubberSelectedIndexChanged:(int64_t)changed
{
  v4 = [(CAMViewfinderViewController *)self _filterTypeForItemIndex:changed];

  [(CAMViewfinderViewController *)self _applySelectedEffectFilterType:v4];
}

- (void)_updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  isControlDrawerVisible = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerForGraphConfiguration:configurationCopy];
  v11 = !_isReconfiguring;
  if (isControlDrawerVisible && _isReconfiguring)
  {
    isControlDrawerVisible = [_fullscreenViewfinder isControlDrawerVisible];
  }

  v12 = [(CAMViewfinderViewController *)self _shouldHideModeDialForGraphConfiguration:configurationCopy];
  if ((v12 | v11))
  {
    isModeUIVisible = !v12;
  }

  else
  {
    isModeUIVisible = [_fullscreenViewfinder isModeUIVisible];
  }

  [_fullscreenViewfinder setControlDrawerVisible:isControlDrawerVisible modeUIVisible:isModeUIVisible animated:animatedCopy];
  v14 = [(CAMViewfinderViewController *)self _shouldHideShutterButtonForGraphConfiguration:configurationCopy];
  if ((v14 | v11))
  {
    isShutterButtonVisible = !v14;
  }

  else
  {
    isShutterButtonVisible = [_fullscreenViewfinder isShutterButtonVisible];
  }

  [_fullscreenViewfinder setShutterControlVisible:isShutterButtonVisible animated:animatedCopy];
  isDirectionIndicatorVisible = [(CAMViewfinderViewController *)self _shouldAllowControlDrawerToggleForGraphConfiguration:configurationCopy orientation:captureOrientation];
  if ((isDirectionIndicatorVisible & _isReconfiguring) == 1)
  {
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    isDirectionIndicatorVisible = [controlStatusBar isDirectionIndicatorVisible];
  }

  controlStatusBar2 = [_fullscreenViewfinder controlStatusBar];
  [controlStatusBar2 setDirectionIndicatorVisible:isDirectionIndicatorVisible animated:animatedCopy];

  v19 = [(CAMViewfinderViewController *)self _shouldHideElapsedTimeViewForGraphConfiguration:configurationCopy orientation:captureOrientation];
  if ((v19 | v11))
  {
    isElapsedTimeViewVisible = !v19;
  }

  else
  {
    isElapsedTimeViewVisible = [_fullscreenViewfinder isElapsedTimeViewVisible];
  }

  [_fullscreenViewfinder setElapsedTimeViewVisible:isElapsedTimeViewVisible animated:animatedCopy];
  v21 = [(CAMViewfinderViewController *)self _shouldHideTimerIndicatorViewForGraphConfiguration:configurationCopy];
  if ((v21 | v11))
  {
    isTimerIndicatorVisible = !v21;
  }

  else
  {
    isTimerIndicatorVisible = [_fullscreenViewfinder isTimerIndicatorVisible];
  }

  [_fullscreenViewfinder setTimerIndicatorVisible:isTimerIndicatorVisible animated:animatedCopy];
  v23 = [(CAMViewfinderViewController *)self _shouldHideLightingControlForGraphConfiguration:configurationCopy];
  if ((v23 | v11))
  {
    isPortraitControlsAllowed = !v23;
  }

  else
  {
    isPortraitControlsAllowed = [_fullscreenViewfinder isPortraitControlsAllowed];
  }

  [_fullscreenViewfinder setPortraitControlsAllowed:isPortraitControlsAllowed animated:animatedCopy];
  v25 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:configurationCopy];
  if ((v25 | v11))
  {
    isZoomControlVisible = !v25;
  }

  else
  {
    isZoomControlVisible = [_fullscreenViewfinder isZoomControlVisible];
  }

  [_fullscreenViewfinder setZoomControlVisible:isZoomControlVisible animated:animatedCopy];
  v27 = [(CAMViewfinderViewController *)self _shouldHideFlipButtonForGraphConfiguration:configurationCopy];
  if ((v27 | v11))
  {
    isFlipButtonVisible = !v27;
  }

  else
  {
    isFlipButtonVisible = [_fullscreenViewfinder isFlipButtonVisible];
  }

  [_fullscreenViewfinder setFlipButtonVisible:isFlipButtonVisible animated:animatedCopy];
  v29 = [(CAMViewfinderViewController *)self _shouldShowImageAnalysisButtonForGraphConfiguration:configurationCopy];
  if (v29 && _isReconfiguring)
  {
    if (([_fullscreenViewfinder isImageAnalysisButtonVisible] & 1) == 0)
    {
LABEL_29:
      v30 = 0;
      goto LABEL_32;
    }
  }

  else if (!v29)
  {
    goto LABEL_29;
  }

  [(CAMViewfinderViewController *)self _createImageAnalysisButtonIfNeededForConfiguration:configurationCopy];
  v30 = 1;
LABEL_32:
  [_fullscreenViewfinder setImageAnalysisButtonVisible:v30 animated:animatedCopy];
  isModeSwitchVisible = [(CAMViewfinderViewController *)self _shouldShowPhotoVideoModeSwitchForGraphConfiguration:configurationCopy];
  if ((isModeSwitchVisible & _isReconfiguring) == 1)
  {
    isModeSwitchVisible = [_fullscreenViewfinder isModeSwitchVisible];
  }

  [_fullscreenViewfinder setPhotoVideoModeSwitchVisible:isModeSwitchVisible animated:animatedCopy];
  isFlipAspectRatioButtonVisible = [(CAMViewfinderViewController *)self _shouldShowFlipAspectRatioButtonForGraphConfiguration:configurationCopy];
  if ((isFlipAspectRatioButtonVisible & _isReconfiguring) == 1)
  {
    isFlipAspectRatioButtonVisible = [_fullscreenViewfinder isFlipAspectRatioButtonVisible];
  }

  [_fullscreenViewfinder setFlipAspectRatioButtonVisible:isFlipAspectRatioButtonVisible animated:animatedCopy];
  v33 = +[CAMCaptureCapabilities capabilities];
  v34 = [v33 isSmartFramingSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];

  v35 = -[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition")));
  if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    v36 = +[CAMCaptureCapabilities capabilities];
    v37 = [v36 isSmartFramingSupportedForMode:-[CAMViewfinderViewController _trueVideoSourceCaptureMode](self devicePosition:{"_trueVideoSourceCaptureMode"), objc_msgSend(configurationCopy, "devicePosition")}];

    if (!v35)
    {
LABEL_38:
      v38 = 0;
      goto LABEL_41;
    }
  }

  else
  {
    v37 = 0;
    if (!v35)
    {
      goto LABEL_38;
    }
  }

  v38 = v34 | v37;
LABEL_41:
  [_fullscreenViewfinder setOffsetZoomButtonForFlipAspectRatioButton:v38 & 1 animated:animatedCopy];
  v39 = [(CAMViewfinderViewController *)self _visibleSuggestionButtonForGraphConfiguration:configurationCopy];
  [_fullscreenViewfinder setVisiblePreviewSuggestionButton:v39 animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateVisibleChromeSuggestionButton:v39];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  visibleInstructionLabel = [_fullscreenViewfinder visibleInstructionLabel];
  v41 = [(CAMViewfinderViewController *)self _primaryInstructionLabelForGraphConfiguration:configurationCopy];
  if (_isReconfiguring && v41 != visibleInstructionLabel)
  {
    v42 = 0;
  }

  else
  {
    v42 = v41;
  }

  visibleSecondaryInstructionLabel = [_fullscreenViewfinder visibleSecondaryInstructionLabel];
  v44 = [(CAMViewfinderViewController *)self _secondaryInstructionLabelForGraphConfiguration:configurationCopy];
  if (_isReconfiguring && v44 != visibleSecondaryInstructionLabel)
  {
    v45 = 0;
  }

  else
  {
    v45 = v44;
  }

  [_fullscreenViewfinder setVisibleInstructionLabel:v42 visibleSecondaryInstructionLabel:v45 animated:animatedCopy];
  [_fullscreenViewfinder setLightingNameBadgesHidden:-[CAMViewfinderViewController _shouldHideLightingNameBadgesForGraphConfiguration:](self animated:{"_shouldHideLightingNameBadgesForGraphConfiguration:", configurationCopy), animatedCopy}];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:configurationCopy animated:animatedCopy];
}

- (void)_updateControlsRelatedToDepthSuggestionAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = [(CAMViewfinderViewController *)self _visibleSuggestionButtonForGraphConfiguration:_currentGraphConfiguration];
  [_fullscreenViewfinder setVisiblePreviewSuggestionButton:v6 animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateVisibleChromeSuggestionButton:v6];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
}

- (void)_updateVisibleChromeSuggestionButton:(int64_t)button
{
  v4 = button != 2 && button == 1;
  v5 = button == 2;
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __68__CAMViewfinderViewController__updateVisibleChromeSuggestionButton___block_invoke;
  v7[3] = &unk_1E76F9818;
  v7[4] = self;
  v8 = v4;
  v9 = v5;
  [chromeConfigurator performChanges:v7];
}

void __68__CAMViewfinderViewController__updateVisibleChromeSuggestionButton___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) chromeConfigurator];
  [v2 setIsAutoMacroButtonVisible:*(a1 + 40)];

  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setIsDepthButtonVisible:*(a1 + 41)];
}

- (void)_updateControlDrawerContentsVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
}

- (void)_updateControlDrawerContentsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  v25 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  v7 = MEMORY[0x1E695DFD8];
  visibleControlTypes = [_controlDrawer visibleControlTypes];
  v9 = [v7 setWithArray:visibleControlTypes];

  array = [MEMORY[0x1E695DF70] array];
  _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v19 = configurationCopy;
  v12 = [(CAMViewfinderViewController *)self _controlTypesForGraphConfiguration:configurationCopy];
  v13 = [v12 countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v21;
    do
    {
      v16 = 0;
      do
      {
        if (*v21 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v20 + 1) + 8 * v16);
        if (!_isReconfiguring || [v9 containsObject:*(*(&v20 + 1) + 8 * v16)])
        {
          [array addObject:v17];
        }

        ++v16;
      }

      while (v14 != v16);
      v14 = [v12 countByEnumeratingWithState:&v20 objects:v24 count:16];
    }

    while (v14);
  }

  [_controlDrawer setVisibleControlTypes:array animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateChromeControlsForGraphConfiguration:v19];
}

- (id)_controlTypesForGraphConfiguration:(id)configuration
{
  v18 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  array = [MEMORY[0x1E695DF70] array];
  v13 = 0u;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  _allControlDrawerTypes = [(CAMViewfinderViewController *)self _allControlDrawerTypes];
  v7 = [_allControlDrawerTypes countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v14;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v14 != v9)
        {
          objc_enumerationMutation(_allControlDrawerTypes);
        }

        v11 = *(*(&v13 + 1) + 8 * i);
        if (-[CAMViewfinderViewController _shouldShowDrawerControlOfType:forGraphConfiguration:](self, "_shouldShowDrawerControlOfType:forGraphConfiguration:", [v11 integerValue], configurationCopy))
        {
          [array addObject:v11];
        }
      }

      v8 = [_allControlDrawerTypes countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v8);
  }

  return array;
}

- (BOOL)shouldShowInstructionLabel
{
  if ([(CAMViewfinderViewController *)self chromeTopBarMenuState]&& [(CAMViewfinderViewController *)self chromeTopBarMenuState]!= 1)
  {
    return 0;
  }

  else
  {
    return ![(CAMViewfinderViewController *)self chromeControlPanelIsExpanded];
  }
}

- (int64_t)_primaryInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self shouldShowInstructionLabel])
  {
    if ([(CAMViewfinderViewController *)self _shouldShowImageAnalysisInstructionLabel])
    {
      v5 = 5;
    }

    else if ([(CAMViewfinderViewController *)self _isNightModeCaptureUIVisible])
    {
      v5 = 3;
    }

    else if ([(CAMViewfinderViewController *)self _shouldHidePortraitModeInstructionLabelForGraphConfiguration:configurationCopy])
    {
      if ([(CAMViewfinderViewController *)self _shouldShowFlashCompromisedInstructionsForGraphConfiguration:configurationCopy])
      {
        v5 = 4;
      }

      else if ([(CAMViewfinderViewController *)self _shouldHideQRCodeInstructionLabelForGraphConfiguration:configurationCopy])
      {
        if ([(CAMViewfinderViewController *)self _shouldShowDeviceTooHotInstructionLabelForGraphConfiguration:configurationCopy])
        {
          v5 = 7;
        }

        else if ([(CAMViewfinderViewController *)self _shouldShowSpatialCaptureInstructionsForGraphConfiguration:configurationCopy])
        {
          v5 = 8;
        }

        else if ([(CAMViewfinderViewController *)self _shouldShowSmartStyleCategoryInstructionLabelForGraphConfiguration:configurationCopy])
        {
          v5 = 9;
        }

        else
        {
          v5 = 0;
        }
      }

      else
      {
        v5 = 2;
      }
    }

    else
    {
      v5 = 1;
    }
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (int64_t)_secondaryInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self shouldShowInstructionLabel])
  {
    if ([(CAMViewfinderViewController *)self _shouldShowFreeResourcesInstructionLabelForGraphConfiguration:configurationCopy])
    {
      v5 = 6;
    }

    else if ([(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:configurationCopy])
    {
      v5 = 10;
    }

    else
    {
      v5 = 0;
    }
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (BOOL)_isVideoStabilizationIndicatorPrimary
{
  v2 = +[CAMUserPreferences preferences];
  if ([v2 preserveExposure] & 1) != 0 || (objc_msgSend(v2, "isProResControlEnabled"))
  {
    LOBYTE(v3) = 0;
  }

  else
  {
    v3 = [v2 sharedLibraryEnabled] ^ 1;
  }

  return v3;
}

- (id)_primaryControlStatusIndicatorTypes
{
  v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithArray:&unk_1F16C92D8];
  if ([(CAMViewfinderViewController *)self _isVideoStabilizationIndicatorPrimary])
  {
    [v3 addObject:&unk_1F16C7850];
  }

  return v3;
}

- (id)_secondaryControlStatusIndicatorTypes
{
  v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithArray:&unk_1F16C92F0];
  if (![(CAMViewfinderViewController *)self _isVideoStabilizationIndicatorPrimary])
  {
    [v3 addObject:&unk_1F16C7850];
  }

  return v3;
}

- (void)_updateControlStatusBarContentsVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
}

- (void)_updateControlStatusBarContentsVisibilityForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  v38 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];

  array = [MEMORY[0x1E695DF70] array];
  array2 = [MEMORY[0x1E695DF70] array];
  v8 = ![(CAMViewfinderViewController *)self _isReconfiguring];
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  obj = [(CAMViewfinderViewController *)self _primaryControlStatusIndicatorTypes];
  v9 = [obj countByEnumeratingWithState:&v32 objects:v37 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v33;
    do
    {
      for (i = 0; i != v10; ++i)
      {
        if (*v33 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v32 + 1) + 8 * i);
        integerValue = [v13 integerValue];
        v15 = [controlStatusBar isIndicatorDesiredForType:integerValue];
        if ([(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:integerValue forGraphConfiguration:configurationCopy]&& ((v8 | v15) & 1) != 0)
        {
          [array addObject:v13];
        }
      }

      v10 = [obj countByEnumeratingWithState:&v32 objects:v37 count:16];
    }

    while (v10);
  }

  v30 = 0u;
  v31 = 0u;
  v28 = 0u;
  v29 = 0u;
  obja = [(CAMViewfinderViewController *)self _secondaryControlStatusIndicatorTypes];
  v16 = [obja countByEnumeratingWithState:&v28 objects:v36 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v29;
    do
    {
      for (j = 0; j != v17; ++j)
      {
        if (*v29 != v18)
        {
          objc_enumerationMutation(obja);
        }

        v20 = *(*(&v28 + 1) + 8 * j);
        integerValue2 = [v20 integerValue];
        v22 = [controlStatusBar isIndicatorDesiredForType:integerValue2];
        if ([(CAMViewfinderViewController *)self _shouldShowIndicatorOfType:integerValue2 forGraphConfiguration:configurationCopy]&& ((v8 | v22) & 1) != 0)
        {
          [array2 addObject:v20];
        }
      }

      v17 = [obja countByEnumeratingWithState:&v28 objects:v36 count:16];
    }

    while (v17);
  }

  [controlStatusBar setPrimaryDesiredIndicatorTypes:array secondaryDesiredIndicatorTypes:array2 animated:animatedCopy];
}

- (void)_updatePanoramaSizeIfNeededForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPanoramaSupportedForDevice:{objc_msgSend(configurationCopy, "device")}];

  if (v5 && [configurationCopy mode] == 3)
  {
    v6 = +[CAMPanoramaConfiguration sharedInstance];
    v7 = [v6 maxWidthForDevice:{objc_msgSend(configurationCopy, "device")}];
    sampleBufferWidth = [v6 sampleBufferWidth];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setPanoramaCaptureSize:{v7, sampleBufferWidth}];
  }
}

- (int64_t)_zoomControlLayoutPositionForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:configurationCopy]&& ![(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:configurationCopy])
  {
    mode = [configurationCopy mode];
    devicePosition = [configurationCopy devicePosition];
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v5 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v11])
    {
      v6 = 2;
    }

    else
    {
      v6 = 1;
    }
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (int64_t)_lightingControlLayoutPositionForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(self) = [v5 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat, v9];
  portraitInPhotoModeBehavior = [v5 portraitInPhotoModeBehavior];
  if (self)
  {
    v11 = ~portraitInPhotoModeBehavior & 2;
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (void)_updateZoomControlLayoutForGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v9 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:graphConfiguration];
  v10 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy];
  v11 = [(CAMViewfinderViewController *)self _zoomControlLayoutPositionForGraphConfiguration:configurationCopy];

  if (!v9 || v10)
  {
    v12 = v9 | ~v10;
    v13 = 0.0;
    if (v11 == 1)
    {
      v13 = 14.0;
    }

    if (v11 == 2)
    {
      v14 = -14.0;
    }

    else
    {
      v14 = v13;
    }

    _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl setEdgeMargin:v12 & animatedCopy animated:v14];

    _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl2 setPlatterLayoutCompact:v14 != 0.0 animated:v12 & animatedCopy];
  }
}

- (void)_snapshotAndFadeDisappearingOverlayViewsForChangeToGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self _shouldHidePanoramaViewForGraphConfiguration:?])
  {
    _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
    view = [_panoramaViewController view];
    v6 = view;
    if (view)
    {
      [view alpha];
      if (v7 > 0.0)
      {
        [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:v6];
        instructionView = [v6 instructionView];
        superview = [v6 superview];
        [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:instructionView parentViewOverride:superview shouldHideView:0];
      }
    }
  }

  if ([(CAMViewfinderViewController *)self _shouldHidePortraitModeInstructionLabelForGraphConfiguration:configurationCopy])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__portraitModeInstructionLabel];
  }

  if (![(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:configurationCopy])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__cleanLensesInstructionLabel];
  }

  if ([(CAMViewfinderViewController *)self _shouldHideQRCodeInstructionLabelForGraphConfiguration:configurationCopy])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__qrCodeInstructionLabel];
  }

  if ([(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:configurationCopy])
  {
    [(CAMViewfinderViewController *)self _snapshotAndFadeDisappearingView:self->__filterNameBadge];
  }
}

- (void)_snapshotAndFadeDisappearingView:(id)view parentViewOverride:(id)override shouldHideView:(BOOL)hideView
{
  viewCopy = view;
  overrideCopy = override;
  if (viewCopy)
  {
    if (([viewCopy isHidden] & 1) == 0)
    {
      [viewCopy alpha];
      if (v9 != 0.0)
      {
        if (overrideCopy)
        {
          superview = overrideCopy;
        }

        else
        {
          superview = [viewCopy superview];
        }

        v11 = superview;
        v12 = [viewCopy snapshotViewAfterScreenUpdates:0];
        v13 = MEMORY[0x1E69DD250];
        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke;
        v22[3] = &unk_1E76F9840;
        v23 = viewCopy;
        v24 = v11;
        v14 = v12;
        v25 = v14;
        hideViewCopy = hideView;
        v15 = v11;
        [v13 performWithoutAnimation:v22];
        v16 = MEMORY[0x1E69DD250];
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke_2;
        v20[3] = &unk_1E76F77B0;
        v21 = v14;
        v18[0] = MEMORY[0x1E69E9820];
        v18[1] = 3221225472;
        v18[2] = __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke_3;
        v18[3] = &unk_1E76F7988;
        v19 = v21;
        v17 = v21;
        [v16 animateWithDuration:v20 animations:v18 completion:0.25];
      }
    }
  }
}

void __98__CAMViewfinderViewController__snapshotAndFadeDisappearingView_parentViewOverride_shouldHideView___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) superview];
  [*(a1 + 32) center];
  [v2 convertPoint:*(a1 + 40) toView:?];
  v4 = v3;
  v6 = v5;
  v7 = *(a1 + 48);
  [*(a1 + 32) bounds];
  [v7 setBounds:?];
  [*(a1 + 48) setCenter:{v4, v6}];
  v8 = *(a1 + 48);
  v9 = *(a1 + 32);
  if (v9)
  {
    [v9 transform];
  }

  else
  {
    memset(v10, 0, sizeof(v10));
  }

  [v8 setTransform:v10];
  [*(a1 + 40) addSubview:*(a1 + 48)];
  if (*(a1 + 56) == 1)
  {
    [*(a1 + 32) setAlpha:0.0];
  }
}

- (void)_updateBadgeVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = [(CAMViewfinderViewController *)self _shouldHideLivePhotoBadgeForGraphConfiguration:_currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _shouldHideShallowDepthOfFieldBadgeForGraphConfiguration:_currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:_currentGraphConfiguration];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v10 = -[CAMViewfinderViewController _shouldHideLightingNameBadgeForGraphConfiguration:orientation:](self, "_shouldHideLightingNameBadgeForGraphConfiguration:orientation:", _currentGraphConfiguration, [_motionController captureOrientation]);

  shouldLayoutLightingNameBadgeAtBottom = [(CAMViewfinderViewController *)self shouldLayoutLightingNameBadgeAtBottom];
  v12 = [(CAMViewfinderViewController *)self _shouldShowSharedLibraryBadgeForGraphConfiguration:_currentGraphConfiguration];
  v34 = [(CAMViewfinderViewController *)self _shouldShowVideoStabilizationBadgeForGraphConfiguration:_currentGraphConfiguration];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  videoCapturePaused = [_captureController videoCapturePaused];

  v31 = [(CAMViewfinderViewController *)self _shouldShowTextBadgeForGraphConfiguration:_currentGraphConfiguration];
  v32 = [(CAMViewfinderViewController *)self _shouldShowSpatialBadgeForGraphConfiguration:_currentGraphConfiguration];
  array = [MEMORY[0x1E695DF70] array];
  if (!v6)
  {
    _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];

    if (_livePhotoBadge)
    {
      _livePhotoBadge2 = [(CAMViewfinderViewController *)self _livePhotoBadge];
      [array addObject:_livePhotoBadge2];
    }
  }

  if (!v7)
  {
    _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];

    if (_shallowDepthOfFieldBadge)
    {
      _shallowDepthOfFieldBadge2 = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
      [array addObject:_shallowDepthOfFieldBadge2];
    }
  }

  if (!v8)
  {
    _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];

    if (_focusAndExposureLockBadge)
    {
      _focusAndExposureLockBadge2 = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
      [array addObject:_focusAndExposureLockBadge2];
    }
  }

  if (!v10 && !shouldLayoutLightingNameBadgeAtBottom)
  {
    _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];

    if (_lightingNameBadge)
    {
      _lightingNameBadge2 = [(CAMViewfinderViewController *)self _lightingNameBadge];
      [array addObject:_lightingNameBadge2];
    }
  }

  if (v12)
  {
    _sharedLibraryBadge = [(CAMViewfinderViewController *)self _sharedLibraryBadge];

    if (_sharedLibraryBadge)
    {
      _sharedLibraryBadge2 = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
      [array addObject:_sharedLibraryBadge2];
    }
  }

  [viewfinderView setVisibleTopBadges:array animated:animatedCopy];
  if (animatedCopy)
  {
    v25 = 0.25;
  }

  else
  {
    v25 = 0.0;
  }

  v36[0] = MEMORY[0x1E69E9820];
  v36[1] = 3221225472;
  v36[2] = __62__CAMViewfinderViewController__updateBadgeVisibilityAnimated___block_invoke;
  v36[3] = &unk_1E76F9868;
  v36[4] = self;
  v37 = _currentGraphConfiguration;
  v38 = shouldLayoutLightingNameBadgeAtBottom;
  v39 = v10;
  v26 = _currentGraphConfiguration;
  [CAMView animateIfNeededWithDuration:v36 animations:v25];
  v27 = 128;
  if (!v31)
  {
    v27 = 0;
  }

  if (!v8)
  {
    v27 |= 2uLL;
  }

  if (v34)
  {
    v27 |= 8uLL;
  }

  if (videoCapturePaused)
  {
    v27 |= 0x10uLL;
  }

  if (v32)
  {
    v28 = v27 | 0x40;
  }

  else
  {
    v28 = v27;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder badgeTray];
  [badgeTray setVisibleBadges:v28 animated:animatedCopy];
}

uint64_t __62__CAMViewfinderViewController__updateBadgeVisibilityAnimated___block_invoke(uint64_t a1)
{
  [*(*(a1 + 32) + 1760) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHidePortraitModeInstructionLabelForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  [*(*(a1 + 32) + 1768) setAlpha:{objc_msgSend(*(a1 + 32), "_shouldShowCleanLensesInstructionLabelForGraphConfiguration:", *(a1 + 40))}];
  [*(*(a1 + 32) + 1792) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHideQRCodeInstructionLabelForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  result = [*(*(a1 + 32) + 1712) setAlpha:{(objc_msgSend(*(a1 + 32), "_shouldHideFilterNameBadgeForGraphConfiguration:", *(a1 + 40)) ^ 1)}];
  if (*(a1 + 48) == 1)
  {
    v3 = (*(a1 + 49) ^ 1u);
    v4 = *(*(a1 + 32) + 1968);

    return [v4 setAlpha:v3];
  }

  return result;
}

- (void)_forceHideBadgesAnimated:(BOOL)animated
{
  animatedCopy = animated;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setVisibleTopBadges:MEMORY[0x1E695E0F0] animated:animatedCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder badgeTray];
  [badgeTray setVisibleBadges:0 animated:animatedCopy];

  v8 = 0.25;
  if (!animatedCopy)
  {
    v8 = 0.0;
  }

  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __56__CAMViewfinderViewController__forceHideBadgesAnimated___block_invoke;
  v9[3] = &unk_1E76F77B0;
  v9[4] = self;
  [CAMView animateIfNeededWithDuration:v9 animations:v8];
}

uint64_t __56__CAMViewfinderViewController__forceHideBadgesAnimated___block_invoke(uint64_t a1)
{
  [*(*(a1 + 32) + 1760) setAlpha:0.0];
  [*(*(a1 + 32) + 1768) setAlpha:0.0];
  v2 = *(*(a1 + 32) + 1792);

  return [v2 setAlpha:0.0];
}

- (void)_updateUIForCapturing:(BOOL)capturing animated:(BOOL)animated updateProResControls:(BOOL)controls
{
  controlsCopy = controls;
  animatedCopy = animated;
  capturingCopy = capturing;
  [(CAMViewfinderViewController *)self setNeedsUpdateOfSupportedInterfaceOrientations];
  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  if (controlsCopy)
  {
    [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:animatedCopy];
  if (!-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v10 = objc_claimAutoreleasedReturnValue(), v11 = [v10 isSpatialModeTrueVideoSupported], v10, v11))
  {
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
  }

  [(CAMViewfinderViewController *)self _setSwipeToModeSwitchEnabled:[(CAMViewfinderViewController *)self _shouldEnableSwipeToModeSwitch]];
  [(CAMViewfinderViewController *)self _updateTopBarStyleForGraphConfiguration:_currentGraphConfiguration capturing:capturingCopy animated:animatedCopy];
  if (![(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
  {
    if (animatedCopy)
    {
      v12 = 3;
    }

    else
    {
      v12 = 0;
    }

    _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl setShouldShowZoomDial:0 animationDuration:v12];
  }

  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:capturingCopy animated:animatedCopy];
  if (mode <= 8)
  {
    if (((1 << mode) & 0x186) != 0)
    {
      if (capturingCopy)
      {
        _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
LABEL_24:
        [_previewViewController notifyWillStartCapturing];
        _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
        [_remoteShutterController willStartCapturing];
        goto LABEL_26;
      }

      goto LABEL_21;
    }

    if (mode)
    {
      if (mode != 3)
      {
        goto LABEL_23;
      }

      _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
      _targetElapsedTimeView = _panoramaViewController;
      if (capturingCopy)
      {
        [_panoramaViewController startPainting];
      }

      else
      {
        [_panoramaViewController stopPainting];
      }

      goto LABEL_22;
    }

    v17 = +[CAMCaptureCapabilities capabilities];
    isLongPressVideoCaptureFromPhotoModeSupported = [v17 isLongPressVideoCaptureFromPhotoModeSupported];

    if (isLongPressVideoCaptureFromPhotoModeSupported && !capturingCopy)
    {
LABEL_21:
      _targetElapsedTimeView = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
      [_targetElapsedTimeView endTimer];
      [_targetElapsedTimeView setBackgroundStyle:-[CAMViewfinderViewController _elapsedTimeViewIdleBackgroundStyle](self animated:{"_elapsedTimeViewIdleBackgroundStyle"), 1}];
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder setSpatialCaptureRecordingIndicatorVisible:0 animated:1];

LABEL_22:
    }
  }

LABEL_23:
  _previewViewController2 = [(CAMViewfinderViewController *)self _previewViewController];
  _previewViewController = _previewViewController2;
  if (capturingCopy)
  {
    goto LABEL_24;
  }

  [_previewViewController2 notifyDidStopCapture];
  _remoteShutterController2 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController2 didStopCapture];

  _remoteShutterController = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_remoteShutterController setPausedDuringVideo:0 animated:animatedCopy];
LABEL_26:

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
}

- (int64_t)_elapsedTimeViewIdleBackgroundStyle
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (_fullscreenViewfinder)
  {
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    v5 = ([_motionController captureOrientation] - 3) < 2;
  }

  else
  {
    v5 = [(CAMViewfinderViewController *)self _layoutStyle]== 1;
  }

  if (v5)
  {
    return 3;
  }

  else
  {
    return 0;
  }
}

- (void)_collapseExpandedButtonsAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlDrawer = [_fullscreenViewfinder controlDrawer];
  [controlDrawer collapseExpandableButtonsAnimated:animatedCopy updatePreferredDrawerControl:0];

  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  [controlStatusBar collapseExpandedIndicatorAnimated:animatedCopy];

  [(CAMExpandableMenuButton *)self->__flashButton collapseMenuAnimated:animatedCopy];
  [(CAMExpandableMenuButton *)self->__HDRButton collapseMenuAnimated:animatedCopy];
  [(CAMExpandableMenuButton *)self->__timerButton collapseMenuAnimated:animatedCopy];
  [(CAMExpandableMenuButton *)self->__livePhotoButton collapseMenuAnimated:animatedCopy];
  [(CAMExpandableMenuButton *)self->__sharedLibraryButton collapseMenuAnimated:animatedCopy];
}

- (void)_startTimer:(unint64_t)timer
{
  +[CAMLivePhotoButton enablingAnimationDuration];
  if (timer - 3 > 2)
  {
    v6 = v5;
  }

  else
  {
    v6 = dbl_1A3A683B0[timer - 3];
  }

  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  v8 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:timer];
  [_timerCache startTimerForKey:v8 duration:v6];

  [(CAMViewfinderViewController *)self _didStartTimer:timer];
}

- (void)_didStartTimer:(unint64_t)timer
{
  if (!timer)
  {
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  }
}

- (void)timerCache:(id)cache timerDidFireForKey:(id)key
{
  keyCopy = key;
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  unsignedIntegerValue = [keyCopy unsignedIntegerValue];
  switch(unsignedIntegerValue)
  {
    case 5:
      [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
      break;
    case 4:
      [(CAMViewfinderViewController *)self _dismissDocumentScanningButton];
      break;
    case 3:
      [(CAMViewfinderViewController *)self _updateImageAnalysisInstructions];
      break;
  }
}

- (BOOL)shouldHideFlashButton
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideFlashButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideHDRButton
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideHDRButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideTimerButton
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideTimerButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideFlipButton
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideFlipButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideLivePhotoButton
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideLivePhotoButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy;
}

- (BOOL)shouldHideCleanLensInstructionLabel
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldShowCleanLensesInstructionLabelForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (BOOL)shouldHideLightingNameBadgeForOrientation:(int64_t)orientation
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(orientation) = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgeForGraphConfiguration:_currentGraphConfiguration orientation:orientation];

  return orientation;
}

- (BOOL)_shouldEnableAspectRatioButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableIntensityButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableExposureControlButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableVideoConfigurationControl
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isConfigurationAvailable = [_captureController isConfigurationAvailable];

  v4 = +[CAMUserPreferences preferences];
  if ([v4 isVideoConfigurationControlEnabled])
  {
    interactiveVideoFormatControlAlwaysEnabled = 1;
  }

  else
  {
    v6 = +[CAMCaptureCapabilities capabilities];
    interactiveVideoFormatControlAlwaysEnabled = [v6 interactiveVideoFormatControlAlwaysEnabled];
  }

  return isConfigurationAvailable & interactiveVideoFormatControlAlwaysEnabled;
}

- (BOOL)_shouldEnableRAWButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnablePhotoFormatButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableProResButton
{
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return ((_isModeDisabled | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableVideoStabilizationButton
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isConfigurationAvailable = [_captureController isConfigurationAvailable];

  return isConfigurationAvailable;
}

- (BOOL)_shouldEnableApertureButton
{
  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return (((_isOutOfDiskSpace || _isModeDisabled) | isCapturingNightModeImage) & 1) == 0;
}

- (BOOL)_shouldEnableNightModeControl
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldEnableSemanticStyleControl
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldEnableSmartStyleControl
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldEnableSmartStylesSwipeGestures
{
  if ([(CAMViewfinderViewController *)self _currentHalfPressSpotlight])
  {
    return 0;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder isSmartStylePickerVisible];

  return isSmartStylePickerVisible;
}

- (BOOL)_shouldEnableControlDrawerToggle
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldEnableTextAnalysisButton
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldEnableSharedLibraryButton
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingNightModeImage = [_captureController isCapturingNightModeImage];

  return isCapturingNightModeImage ^ 1;
}

- (BOOL)_shouldShowSharedLibraryButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMUserPreferences preferences];
  sharedLibrarySwitchEnabled = [v5 sharedLibrarySwitchEnabled];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  sharedLibraryButton = [_topBar sharedLibraryButton];

  v11 = _sharedLibraryButton == sharedLibraryButton;
  LOBYTE(_sharedLibraryButton) = (_sharedLibraryButton != sharedLibraryButton) & sharedLibrarySwitchEnabled;
  if (v11 && (sharedLibrarySwitchEnabled & 1) != 0)
  {
    _topBar2 = [(CAMViewfinderViewController *)self _topBar];
    LODWORD(_sharedLibraryButton) = [_topBar2 shouldHideSharedLibraryButtonForGraphConfiguration:configurationCopy] ^ 1;
  }

  return _sharedLibraryButton & (isCapturingVideo ^ 1);
}

- (BOOL)_shouldEnableDrawerControl:(int64_t)control
{
  switch(control)
  {
    case 0:
      result = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
      break;
    case 1:
      result = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
      break;
    case 2:
      result = [(CAMViewfinderViewController *)self _shouldEnableAspectRatioButton];
      break;
    case 3:
      result = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
      break;
    case 4:
      result = [(CAMViewfinderViewController *)self _shouldEnableFilterButton];
      break;
    case 5:
      result = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
      break;
    case 6:
      result = [(CAMViewfinderViewController *)self _shouldEnableApertureButton];
      break;
    case 7:
      result = [(CAMViewfinderViewController *)self _shouldEnableIntensityButton];
      break;
    case 8:
      result = [(CAMViewfinderViewController *)self _shouldEnableExposureControlButton];
      break;
    case 9:
      result = [(CAMViewfinderViewController *)self _shouldEnableNightModeControl];
      break;
    case 10:
      result = [(CAMViewfinderViewController *)self _shouldEnableSemanticStyleControl];
      break;
    case 11:
      result = [(CAMViewfinderViewController *)self _shouldEnableSmartStyleControl];
      break;
    case 12:
      result = [(CAMViewfinderViewController *)self _shouldEnableRAWButton];
      break;
    case 13:
      result = [(CAMViewfinderViewController *)self _shouldEnableProResButton];
      break;
    case 14:
      result = [(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton];
      break;
    case 15:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoStabilizationButton];
      break;
    default:
      result = 0;
      break;
  }

  return result;
}

- (BOOL)_shouldEnableControlStatusIndicator:(unint64_t)indicator
{
  switch(indicator)
  {
    case 0uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
      break;
    case 1uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
      break;
    case 2uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
      break;
    case 3uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
      break;
    case 4uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableFilterButton];
      break;
    case 5uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableApertureButton];
      break;
    case 6uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableIntensityButton];
      break;
    case 7uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableExposureControlButton];
      break;
    case 8uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoConfigurationControl];
      break;
    case 9uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableNightModeControl];
      break;
    case 0xAuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSemanticStyleControl];
      break;
    case 0xBuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSmartStyleControl];
      break;
    case 0xCuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableRAWButton];
      break;
    case 0xDuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableProResButton];
      break;
    case 0xEuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton];
      break;
    case 0xFuLL:
      result = [(CAMViewfinderViewController *)self _shouldEnableVideoStabilizationButton];
      break;
    case 0x10uLL:
      result = [(CAMViewfinderViewController *)self _shouldEnablePhotoFormatButton];
      break;
    default:
      result = 0;
      break;
  }

  return result;
}

- (void)_updateEnabledControlsWithReason:(id)reason forceLog:(BOOL)log
{
  logCopy = log;
  v93 = *MEMORY[0x1E69E9840];
  reasonCopy = reason;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlDrawer = [_fullscreenViewfinder controlDrawer];
  v78 = _fullscreenViewfinder;
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  _shouldEnableControlDrawerToggle = [(CAMViewfinderViewController *)self _shouldEnableControlDrawerToggle];
  directionIndicator = [controlStatusBar directionIndicator];
  [directionIndicator setEnabled:_shouldEnableControlDrawerToggle];

  _primaryControlStatusIndicatorTypes = [(CAMViewfinderViewController *)self _primaryControlStatusIndicatorTypes];
  _secondaryControlStatusIndicatorTypes = [(CAMViewfinderViewController *)self _secondaryControlStatusIndicatorTypes];
  v12 = [_primaryControlStatusIndicatorTypes arrayByAddingObjectsFromArray:_secondaryControlStatusIndicatorTypes];

  v87 = 0u;
  v88 = 0u;
  v85 = 0u;
  v86 = 0u;
  v13 = v12;
  v14 = [v13 countByEnumeratingWithState:&v85 objects:v92 count:16];
  if (v14)
  {
    v15 = v14;
    v16 = *v86;
    do
    {
      for (i = 0; i != v15; ++i)
      {
        if (*v86 != v16)
        {
          objc_enumerationMutation(v13);
        }

        integerValue = [*(*(&v85 + 1) + 8 * i) integerValue];
        v19 = [(CAMViewfinderViewController *)self _shouldEnableControlStatusIndicator:integerValue];
        v20 = [controlStatusBar indicatorForType:integerValue];
        [v20 setEnabled:v19];
      }

      v15 = [v13 countByEnumeratingWithState:&v85 objects:v92 count:16];
    }

    while (v15);
  }

  v83 = 0u;
  v84 = 0u;
  v81 = 0u;
  v82 = 0u;
  _allControlDrawerTypes = [(CAMViewfinderViewController *)self _allControlDrawerTypes];
  v22 = [_allControlDrawerTypes countByEnumeratingWithState:&v81 objects:v91 count:16];
  if (v22)
  {
    v23 = v22;
    v24 = *v82;
    do
    {
      for (j = 0; j != v23; ++j)
      {
        if (*v82 != v24)
        {
          objc_enumerationMutation(_allControlDrawerTypes);
        }

        integerValue2 = [*(*(&v81 + 1) + 8 * j) integerValue];
        v27 = [(CAMViewfinderViewController *)self _shouldEnableDrawerControl:integerValue2];
        v28 = [controlDrawer buttonForType:integerValue2];
        [v28 setEnabled:v27];
      }

      v23 = [_allControlDrawerTypes countByEnumeratingWithState:&v81 objects:v91 count:16];
    }

    while (v23);
  }

  isEnabled = [(CAMFlashButton *)self->__flashButton isEnabled];
  _shouldEnableFlashButton = [(CAMViewfinderViewController *)self _shouldEnableFlashButton];
  isEnabled2 = [(CAMHDRButton *)self->__HDRButton isEnabled];
  _shouldEnableHDRButton = [(CAMViewfinderViewController *)self _shouldEnableHDRButton];
  isEnabled3 = [(CAMTimerButton *)self->__timerButton isEnabled];
  _shouldEnableTimerButton = [(CAMViewfinderViewController *)self _shouldEnableTimerButton];
  isEnabled4 = [(CAMLivePhotoButton *)self->__livePhotoButton isEnabled];
  _shouldEnableLivePhotoButton = [(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton];
  isEnabled5 = [(CAMFlipButton *)self->__flipButton isEnabled];
  _shouldEnableFlipButton = [(CAMViewfinderViewController *)self _shouldEnableFlipButton];
  isEnabled6 = [(CAMDynamicShutterControl *)self->__dynamicShutterControl isEnabled];
  v77 = isEnabled6 ^ [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  isEnabled7 = [(CUShutterButton *)self->__stillDuringVideoButton isEnabled];
  _shouldEnableShutterButton = [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  isEnabled8 = [(CAMModeDial *)self->__modeDial isEnabled];
  _shouldEnableModeDial = [(CAMViewfinderViewController *)self _shouldEnableModeDial];
  isEnabled9 = [(CAMZoomSlider *)self->__zoomSlider isEnabled];
  _shouldEnableZoomSlider = [(CAMViewfinderViewController *)self _shouldEnableZoomSlider];
  isEnabled10 = [(CAMZoomControl *)self->__zoomControl isEnabled];
  _shouldEnableZoomControl = [(CAMViewfinderViewController *)self _shouldEnableZoomControl];
  [(CAMFlashButton *)self->__flashButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableFlashButton]];
  [(CAMHDRButton *)self->__HDRButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableHDRButton]];
  [(CAMTimerButton *)self->__timerButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableTimerButton]];
  [(CAMLivePhotoButton *)self->__livePhotoButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableLivePhotoButton]];
  [(CAMSharedLibraryButton *)self->__sharedLibraryButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableSharedLibraryButton]];
  [(CAMFlipButton *)self->__flipButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableFlipButton]];
  [(CUShutterButton *)self->__shutterButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CUShutterButton *)self->__shutterButton setShowDisabled:[(CAMViewfinderViewController *)self _shouldShowShutterButtonDisabled]];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CAMDynamicShutterControl *)self->__dynamicShutterControl setShowDisabled:[(CAMViewfinderViewController *)self _shouldShowShutterButtonDisabled] animated:1];
  [(CUShutterButton *)self->__stillDuringVideoButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableShutterButton]];
  [(CEKApertureButton *)self->__apertureButton setEnabled:[(CAMViewfinderViewController *)self _shouldEnableApertureButton]];
  [(CAMModeDial *)self->__modeDial setEnabled:[(CAMViewfinderViewController *)self _shouldEnableModeDial]];
  [(CAMZoomSlider *)self->__zoomSlider setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomSlider]];
  [(CAMZoomControl *)self->__zoomControl setEnabled:[(CAMViewfinderViewController *)self _shouldEnableZoomControl]];
  [(CAMVideoConfigurationStatusIndicator *)self->__videoConfigurationStatusIndicator setEnabled:[(CAMViewfinderViewController *)self _shouldEnableVideoConfigurationControl]];
  _shouldEnableTextAnalysisButton = [(CAMViewfinderViewController *)self _shouldEnableTextAnalysisButton];
  _imageAnalysisButton = [(CAMViewfinderViewController *)self _imageAnalysisButton];
  [_imageAnalysisButton setEnabled:_shouldEnableTextAnalysisButton];

  [(CAMViewfinderViewController *)self _setSwipeToModeSwitchEnabled:[(CAMViewfinderViewController *)self _shouldEnableSwipeToModeSwitch]];
  _shouldEnableSmartStylesSwipeGestures = [(CAMViewfinderViewController *)self _shouldEnableSmartStylesSwipeGestures];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeLeftGestureRecognizer setEnabled:_shouldEnableSmartStylesSwipeGestures];
  [(UISwipeGestureRecognizer *)self->__smartStylesSwipeRightGestureRecognizer setEnabled:_shouldEnableSmartStylesSwipeGestures];
  v33 = reasonCopy;
  if (self->_userInteractionLoggingEnabled)
  {
    v34 = isEnabled4 ^ _shouldEnableLivePhotoButton;
    if (isEnabled != _shouldEnableFlashButton)
    {
      goto LABEL_17;
    }

    if (!logCopy)
    {
      if (((isEnabled2 ^ _shouldEnableHDRButton) & 1) == 0)
      {
LABEL_32:
        if ((isEnabled3 ^ _shouldEnableTimerButton))
        {
          goto LABEL_37;
        }

        if (!logCopy)
        {
          v33 = reasonCopy;
          v40 = isEnabled9 ^ _shouldEnableZoomSlider;
          v41 = isEnabled8 ^ _shouldEnableModeDial;
          if ((v34 & 1) == 0)
          {
            goto LABEL_48;
          }

          goto LABEL_45;
        }

LABEL_34:
        if (([(CAMTimerButton *)self->__timerButton isEnabled]& 1) != 0)
        {
          v33 = reasonCopy;
          v40 = isEnabled9 ^ _shouldEnableZoomSlider;
          v41 = isEnabled8 ^ _shouldEnableModeDial;
          if (v34)
          {
LABEL_45:
            v45 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
            {
              v46 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__livePhotoButton withReason:v33];
              *buf = 138543362;
              v90 = v46;
              _os_log_impl(&dword_1A3640000, v45, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

LABEL_48:
            if (((isEnabled5 ^ _shouldEnableFlipButton) & 1) == 0)
            {
              if (!logCopy)
              {
                if ((isEnabled7 ^ _shouldEnableShutterButton))
                {
LABEL_61:
                  v49 = os_log_create("com.apple.camera", "ControlEnablement");
                  if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
                  {
                    v50 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__stillDuringVideoButton withReason:v33];
                    *buf = 138543362;
                    v90 = v50;
                    _os_log_impl(&dword_1A3640000, v49, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                  }

                  goto LABEL_64;
                }

                goto LABEL_64;
              }

              goto LABEL_50;
            }

            goto LABEL_53;
          }

LABEL_41:
          if (([(CAMLivePhotoButton *)self->__livePhotoButton isEnabled]& 1) != 0)
          {
            if (((isEnabled5 ^ _shouldEnableFlipButton) & 1) == 0)
            {
LABEL_50:
              if (([(CAMFlipButton *)self->__flipButton isEnabled]& 1) != 0)
              {
                if ((isEnabled7 ^ _shouldEnableShutterButton))
                {
                  goto LABEL_61;
                }

LABEL_57:
                if (([(CUShutterButton *)self->__stillDuringVideoButton isEnabled]& 1) != 0)
                {
                  if (v41)
                  {
                    goto LABEL_69;
                  }

                  goto LABEL_66;
                }

                goto LABEL_61;
              }
            }

LABEL_53:
            v47 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
            {
              v48 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__flipButton withReason:v33];
              *buf = 138543362;
              v90 = v48;
              _os_log_impl(&dword_1A3640000, v47, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

            if ((isEnabled7 ^ _shouldEnableShutterButton))
            {
              goto LABEL_61;
            }

            if (logCopy)
            {
              goto LABEL_57;
            }

LABEL_64:
            if (v41)
            {
              goto LABEL_69;
            }

            if (!logCopy)
            {
              if ((v40 & 1) == 0)
              {
                goto LABEL_80;
              }

              goto LABEL_77;
            }

LABEL_66:
            if (([(CAMModeDial *)self->__modeDial isEnabled]& 1) != 0)
            {
              if (v40)
              {
LABEL_77:
                v53 = os_log_create("com.apple.camera", "ControlEnablement");
                if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                {
                  v54 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__zoomSlider withReason:v33];
                  *buf = 138543362;
                  v90 = v54;
                  _os_log_impl(&dword_1A3640000, v53, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                }

LABEL_80:
                if (((isEnabled10 ^ _shouldEnableZoomControl) & 1) == 0)
                {
                  if (!logCopy)
                  {
                    goto LABEL_86;
                  }

LABEL_82:
                  if (([(CAMZoomControl *)self->__zoomControl isEnabled]& 1) != 0)
                  {
                    goto LABEL_86;
                  }
                }

LABEL_83:
                v55 = os_log_create("com.apple.camera", "ControlEnablement");
                if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
                {
                  v56 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__zoomControl withReason:v33];
                  *buf = 138543362;
                  v90 = v56;
                  _os_log_impl(&dword_1A3640000, v55, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
                }

                goto LABEL_86;
              }

LABEL_73:
              if (([(CAMZoomSlider *)self->__zoomSlider isEnabled]& 1) != 0)
              {
                if (((isEnabled10 ^ _shouldEnableZoomControl) & 1) == 0)
                {
                  goto LABEL_82;
                }

                goto LABEL_83;
              }

              goto LABEL_77;
            }

LABEL_69:
            v51 = os_log_create("com.apple.camera", "ControlEnablement");
            if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
            {
              v52 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__modeDial withReason:v33];
              *buf = 138543362;
              v90 = v52;
              _os_log_impl(&dword_1A3640000, v51, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
            }

            if (v40)
            {
              goto LABEL_77;
            }

            if (!logCopy)
            {
              goto LABEL_80;
            }

            goto LABEL_73;
          }

          goto LABEL_45;
        }

LABEL_37:
        v42 = os_log_create("com.apple.camera", "ControlEnablement");
        v33 = reasonCopy;
        if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
        {
          [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__timerButton withReason:reasonCopy];
          v44 = v43 = v34;
          *buf = 138543362;
          v90 = v44;
          _os_log_impl(&dword_1A3640000, v42, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

          v34 = v43;
        }

        v40 = isEnabled9 ^ _shouldEnableZoomSlider;
        v41 = isEnabled8 ^ _shouldEnableModeDial;
        if (v34)
        {
          goto LABEL_45;
        }

        if (!logCopy)
        {
          goto LABEL_48;
        }

        goto LABEL_41;
      }

      goto LABEL_29;
    }

    if (([(CAMFlashButton *)self->__flashButton isEnabled]& 1) != 0)
    {
      if (((isEnabled2 ^ _shouldEnableHDRButton) & 1) == 0)
      {
LABEL_25:
        if (([(CAMHDRButton *)self->__HDRButton isEnabled]& 1) != 0)
        {
          if ((isEnabled3 ^ _shouldEnableTimerButton))
          {
            goto LABEL_37;
          }

          goto LABEL_34;
        }
      }
    }

    else
    {
LABEL_17:
      v35 = os_log_create("com.apple.camera", "ControlEnablement");
      if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
      {
        v36 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__flashButton withReason:reasonCopy];
        *buf = 138543362;
        v90 = v36;
        _os_log_impl(&dword_1A3640000, v35, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

        v34 = isEnabled4 ^ _shouldEnableLivePhotoButton;
      }

      if (((isEnabled2 ^ _shouldEnableHDRButton) & 1) == 0)
      {
        if (!logCopy)
        {
          goto LABEL_32;
        }

        goto LABEL_25;
      }
    }

LABEL_29:
    v37 = os_log_create("com.apple.camera", "ControlEnablement");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
      [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__HDRButton withReason:reasonCopy];
      v39 = v38 = v34;
      *buf = 138543362;
      v90 = v39;
      _os_log_impl(&dword_1A3640000, v37, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);

      v34 = v38;
    }

    goto LABEL_32;
  }

LABEL_86:
  if (v77)
  {
    v57 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
    {
      v58 = [(CAMViewfinderViewController *)self _debugEnabledDescriptionForControl:self->__dynamicShutterControl withReason:v33];
      *buf = 138543362;
      v90 = v58;
      _os_log_impl(&dword_1A3640000, v57, OS_LOG_TYPE_DEFAULT, "%{public}@", buf, 0xCu);
    }
  }
}

- (void)setUserInteractionLoggingEnabled:(BOOL)enabled
{
  if (self->_userInteractionLoggingEnabled != enabled)
  {
    self->_userInteractionLoggingEnabled = enabled;
    if (enabled)
    {
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"User Interaction Logging Enabled" forceLog:1];
    }
  }
}

- (id)_debugEnabledDescriptionForControl:(id)control withReason:(id)reason
{
  reasonCopy = reason;
  controlCopy = control;
  isEnabled = [controlCopy isEnabled];
  v9 = MEMORY[0x1E696AD60];
  v10 = objc_opt_class();
  if (isEnabled)
  {
    reasonCopy = [v9 stringWithFormat:@"<%@: %p> is enabled. (%@)", v10, controlCopy, reasonCopy];
  }

  else
  {
    reasonCopy = [v9 stringWithFormat:@"<%@: %p> is disabled. We're", v10, controlCopy];

    if ([(CAMViewfinderViewController *)self _isOutOfDiskSpace])
    {
      [reasonCopy appendString:{@" out of disk space, "}];
    }

    [reasonCopy replaceOccurrencesOfString:@" withString:" options:@"." range:{1, objc_msgSend(reasonCopy, "length") - 1, 1}];
    controlCopy = [MEMORY[0x1E696AEC0] stringWithFormat:@" (%@)", reasonCopy];

    [reasonCopy appendString:controlCopy];
  }

  return reasonCopy;
}

- (BOOL)pressShutterButtonWithTouchUpDelay:(double)delay shutterBehavior:(int64_t)behavior
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCaptureAvailable = [_captureController isCaptureAvailable];

  if (isCaptureAvailable)
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (_dynamicShutterControl)
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      isEnabled = [_dynamicShutterControl2 externalButtonPressedWithBehavior:behavior];

      if (isEnabled)
      {
        dispatch_time(0, (delay * 1000000000.0));
        v24 = MEMORY[0x1E69E9820];
        v25 = 3221225472;
        v26 = __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke;
        v27 = &unk_1E76F77B0;
        selfCopy = self;
        pl_dispatch_after();
        LOBYTE(isEnabled) = 1;
      }
    }

    else
    {
      _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
      isEnabled = [_shutterButton isEnabled];
      if (isEnabled)
      {
        [(CAMViewfinderViewController *)self _handleShutterButtonPressed:_shutterButton];
        v14 = +[CAMCaptureCapabilities capabilities];
        captureOnTouchDown = [v14 captureOnTouchDown];

        if (captureOnTouchDown)
        {
          dispatch_time(0, (delay * 1000000000.0));
          v18 = MEMORY[0x1E69E9820];
          v19 = 3221225472;
          v20 = __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke_2;
          v21 = &unk_1E76F7960;
          selfCopy2 = self;
          v23 = _shutterButton;
          pl_dispatch_after();
        }

        else
        {
          [(CAMViewfinderViewController *)self _handleShutterButtonReleased:_shutterButton];
        }
      }
    }
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *v17 = 0;
      _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Capture not available for pressShutterButtonWithTouchUpDelay:shutterBehavior:", v17, 2u);
    }

    LOBYTE(isEnabled) = 0;
  }

  return isEnabled;
}

void __82__CAMViewfinderViewController_pressShutterButtonWithTouchUpDelay_shutterBehavior___block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) _dynamicShutterControl];
  [v1 externalButtonReleased];
}

- (BOOL)takeStillDuringVideoWithTouchUpDelay:(double)delay
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCaptureAvailable = [_captureController isCaptureAvailable];

  v7 = +[CAMCaptureCapabilities capabilities];
  captureOnTouchDown = [v7 captureOnTouchDown];

  if (!isCaptureAvailable)
  {
    return 0;
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (_dynamicShutterControl)
  {
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    externalLockButtonPressed = [_dynamicShutterControl2 externalLockButtonPressed];

    dispatch_time(0, (delay * 1000000000.0));
    pl_dispatch_after();
    return externalLockButtonPressed;
  }

  v14 = [(CAMViewfinderViewController *)self _stillDuringVideoButtonPressed:self->__stillDuringVideoButton];
  if (captureOnTouchDown)
  {
    v13 = v14;
    dispatch_time(0, (delay * 1000000000.0));
    pl_dispatch_after();
    return v13;
  }

  stillDuringVideoButton = self->__stillDuringVideoButton;

  return [(CAMViewfinderViewController *)self _stillDuringVideoButtonReleased:stillDuringVideoButton];
}

void __68__CAMViewfinderViewController_takeStillDuringVideoWithTouchUpDelay___block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) _dynamicShutterControl];
  [v1 externalLockButtonReleased];
}

- (void)_updateAllControlsWithContentSize:(id)size
{
  topBar = self->__topBar;
  sizeCopy = size;
  [(CAMTopBar *)topBar invalidateIntrinsicContentSize];
  [(CAMTopBar *)self->__topBar setNeedsLayout];
  [(CAMBottomBar *)self->__bottomBar setNeedsLayout];
  _accessibilityHUDManagers = [(CAMViewfinderViewController *)self _accessibilityHUDManagers];
  LODWORD(topBar) = UIContentSizeCategoryIsAccessibilityCategory(sizeCopy);

  if (topBar && ![_accessibilityHUDManagers count])
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

    v7 = [CAMBarsAccessibilityHUDManager alloc];
    v8 = v7;
    if (_fullscreenViewfinder)
    {
      _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v10 = [(CAMBarsAccessibilityHUDManager *)v8 initWithView:_fullscreenViewfinder2 delegate:self cancelsTouchesInView:1];
      [_accessibilityHUDManagers addObject:v10];
    }

    else
    {
      v11 = [(CAMBarsAccessibilityHUDManager *)v7 initWithView:self->__topBar delegate:self cancelsTouchesInView:1];
      [_accessibilityHUDManagers addObject:v11];

      _fullscreenViewfinder2 = [[CAMBarsAccessibilityHUDManager alloc] initWithView:self->__bottomBar delegate:self cancelsTouchesInView:0];
      [_accessibilityHUDManagers addObject:_fullscreenViewfinder2];
    }
  }

  view = [(CAMViewfinderViewController *)self view];
  [view setNeedsLayout];
}

- (void)_handleContentSizeCategoryDidChange:(id)change
{
  currentContentSize = [(CAMViewfinderViewController *)self currentContentSize];
  [(CAMViewfinderViewController *)self _updateAllControlsWithContentSize:currentContentSize];
}

void __83__CAMViewfinderViewController__updatePanoramaViewVisibilityForViewfinderTransition__block_invoke(uint64_t a1)
{
  v1 = (*(a1 + 40) ^ 1u);
  v2 = [*(a1 + 32) view];
  [v2 setAlpha:v1];
}

- (BOOL)_shouldAnimateViewfinderCloseForReason:(int64_t)reason
{
  if ((reason - 10) < 2 || reason == 19)
  {
    return 0;
  }

  if (reason == 8)
  {
    return ![(CAMViewfinderViewController *)self _isShowingCameraRoll:v3];
  }

  return 1;
}

- (void)closedViewfinderController:(id)controller wantsViewfinderClosedForReason:(int64_t)reason
{
  controllerCopy = controller;
  _viewfinderTransitionable = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  if (_viewfinderTransitionable)
  {
    [(CAMViewfinderViewController *)self _setClosingViewfinder:1];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began closing viewfinder"];
    mEMORY[0x1E69DC668] = [MEMORY[0x1E69DC668] sharedApplication];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v9 = mEMORY[0x1E69DC668];
      [v9 willCloseViewfinderForReason:reason];
    }

    else
    {
      v9 = 0;
    }

    v10 = [(CAMViewfinderViewController *)self _shouldAnimateViewfinderCloseForReason:reason];
    objc_initWeak(&location, self);
    v18 = MEMORY[0x1E69E9820];
    v19 = 3221225472;
    v20 = __89__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderClosedForReason___block_invoke;
    v21 = &unk_1E76F9890;
    objc_copyWeak(v23, &location);
    v11 = v9;
    v22 = v11;
    v23[1] = reason;
    v12 = _Block_copy(&v18);
    if (reason <= 0x14)
    {
      if (((1 << reason) & 0x17F3FE) != 0)
      {
        _transitionController = [(CAMViewfinderViewController *)self _transitionController:v18];
        [_transitionController closeWithBlur:1 animated:v10 withCompletionHandler:v12];
      }

      else if (((1 << reason) & 0x80C00) != 0)
      {
        _transitionController = [(CAMViewfinderViewController *)self _transitionController:v18];
        [_transitionController closeWithBlur:0 animated:v10 withCompletionHandler:v12];
      }

      else
      {
        v15 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:v18];
        device = [v15 device];

        if ((device - 1) > 0xA)
        {
          v17 = 0;
        }

        else
        {
          v17 = qword_1A3A685B0[device - 1];
        }

        _transitionController = [(CAMViewfinderViewController *)self _transitionController];
        [_transitionController closeAndRotateWithDirection:v17 withCompletionHandler:v12];
      }
    }

    if ([(CAMViewfinderViewController *)self _isShowingFilterScrubber:v18])
    {
      chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
      [chromeConfigurator setIsFiltersSuspended:1];
    }

    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];

    objc_destroyWeak(v23);
    objc_destroyWeak(&location);
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began closing viewfinder"];
    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
  }
}

void __89__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderClosedForReason___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _setClosingViewfinder:0];
  [WeakRetained _updateEnabledControlsWithReason:@"Finished closing viewfinder"];
  [*(a1 + 32) didCloseViewfinderForReason:*(a1 + 48)];
}

- (void)closedViewfinderController:(id)controller wantsViewfinderOpenForReason:(int64_t)reason
{
  controllerCopy = controller;
  _viewfinderTransitionable = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  if (_viewfinderTransitionable)
  {
    [(CAMViewfinderViewController *)self _setOpeningViewfinder:1];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Began opening viewfinder"];
    mEMORY[0x1E69DC668] = [MEMORY[0x1E69DC668] sharedApplication];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v9 = mEMORY[0x1E69DC668];
      [v9 willOpenViewfinderForReason:reason];
    }

    else
    {
      v9 = 0;
    }

    if ([(CAMViewfinderViewController *)self _isSpatialMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]])
    {
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:_currentGraphConfiguration animated:0];
    }

    objc_initWeak(&location, self);
    _transitionController = [(CAMViewfinderViewController *)self _transitionController];
    v14 = MEMORY[0x1E69E9820];
    v15 = 3221225472;
    v16 = __87__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderOpenForReason___block_invoke;
    v17 = &unk_1E76F9890;
    objc_copyWeak(v19, &location);
    v12 = v9;
    v18 = v12;
    v19[1] = reason;
    [_transitionController openForReason:reason animated:1 withCompletionHandler:&v14];

    v13 = [(CAMViewfinderViewController *)self chromeConfigurator:v14];
    [v13 setIsFiltersSuspended:0];

    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
    [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:1];

    objc_destroyWeak(v19);
    objc_destroyWeak(&location);
  }

  else
  {
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Finished opening viewfinder"];
    [(CAMViewfinderViewController *)self _updatePanoramaViewVisibilityForViewfinderTransition];
  }
}

void __87__CAMViewfinderViewController_closedViewfinderController_wantsViewfinderOpenForReason___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 40));
  [WeakRetained _setOpeningViewfinder:0];
  [WeakRetained _updateEnabledControlsWithReason:@"Finished opening viewfinder"];
  [*(a1 + 32) didOpenViewfinderForReason:*(a1 + 48)];
  v2 = [WeakRetained queuedViewfinderAction];

  if (v2)
  {
    v3 = [WeakRetained queuedViewfinderAction];
    v3[2]();

    [WeakRetained setQueuedViewfinderAction:0];
  }
}

- (void)disabledPreviewController:(id)controller wantsPreviewDisabledForReason:(int64_t)reason
{
  v4 = [(CAMViewfinderViewController *)self _captureController:controller];
  [v4 changeToPreviewDisabled];
}

- (void)disabledPreviewController:(id)controller wantsPreviewEnabledForReason:(int64_t)reason
{
  v5 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:[(CAMViewfinderViewController *)self _currentMode:controller] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition] videoThumbnailOutputEnabled:[(CAMViewfinderViewController *)self _wantsFilterScrubberVisible]];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToPreviewEnabledWithConfiguration:v5];
}

- (void)captureController:(id)controller didOutputOverCapturePreviewStatus:(int64_t)status
{
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 spatialOverCaptureSupportForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  _overCapturePreviewStatus = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];
  [(CAMViewfinderViewController *)self _setOverCapturePreviewStatus:status & (v7 << 62 >> 63)];

  [(CAMViewfinderViewController *)self _updateViewfinderMaterialFromStatus:_overCapturePreviewStatus animated:1];
}

- (void)_updateViewfinderMaterialAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _overCapturePreviewStatus = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];

  [(CAMViewfinderViewController *)self _updateViewfinderMaterialFromStatus:_overCapturePreviewStatus animated:animatedCopy];
}

- (void)_updateViewfinderMaterialFromStatus:(int64_t)status animated:(BOOL)animated
{
  animatedCopy = animated;
  _overCapturePreviewStatus = [(CAMViewfinderViewController *)self _overCapturePreviewStatus];
  v8 = _overCapturePreviewStatus;
  if (_overCapturePreviewStatus > 2)
  {
    if ((_overCapturePreviewStatus - 4) >= 3)
    {
      v34 = animatedCopy;
      statusCopy6 = status;
      if (_overCapturePreviewStatus == 3)
      {
        v10 = 3;
      }

      else
      {
        v10 = 0;
      }

      goto LABEL_11;
    }

    goto LABEL_9;
  }

  if (!_overCapturePreviewStatus)
  {
    statusCopy6 = status;
    v34 = 0;
    goto LABEL_10;
  }

  if (_overCapturePreviewStatus != 1)
  {
    if (_overCapturePreviewStatus != 2)
    {
      v34 = animatedCopy;
      statusCopy6 = status;
      v10 = 0;
      goto LABEL_11;
    }

LABEL_9:
    v34 = animatedCopy;
    statusCopy6 = status;
LABEL_10:
    v10 = 4;
    goto LABEL_11;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  v10 = 2;
  v34 = animatedCopy;
  if (isSemanticStyleControlVisible & 1) != 0 || (isSmartStylePickerVisible)
  {
    statusCopy6 = status;
  }

  else
  {
    statusCopy6 = status;
    _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    v33 = 2;
    if (((1 << _shallowDepthOfFieldStatus) & 0x6202) == 0)
    {
      v33 = 0;
    }

    if (_shallowDepthOfFieldStatus <= 0xE)
    {
      v10 = v33;
    }

    else
    {
      v10 = 0;
    }
  }

LABEL_11:
  v11 = +[CAMCaptureCapabilities capabilities];
  if ([v11 isSpatialOverCaptureSupported])
  {
    v12 = +[CAMUserPreferences preferences];
    isOverCapturePreviewEnabled = [v12 isOverCapturePreviewEnabled];

    if ((isOverCapturePreviewEnabled & 1) == 0)
    {
      v10 = 4;
    }
  }

  else
  {

    v10 = 4;
  }

  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 spatialOverCaptureSupportForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  _isZooming = [(CAMViewfinderViewController *)self _isZooming];
  _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
  _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isReticleAnimating = [_fullscreenViewfinder3 isReticleAnimating];

  v20 = 3.0;
  if (v8 == 2)
  {
    v21 = +[CAMCaptureCapabilities capabilities];
    if ([v21 isBackQuadraSuperWideSupported])
    {
      v20 = 1.0;
    }

    else
    {
      v20 = 3.0;
    }
  }

  v23 = (statusCopy6 & 0xFFFFFFFFFFFFFFFDLL) == 4 && v8 == 1;
  v24 = v23 | (_isZooming || _isReconfiguring) | isReticleAnimating;
  if ((v15 & 2) == 0)
  {
    v10 = 4;
  }

  v25 = 0.35;
  if ((v24 & 1) == 0)
  {
    v25 = v20;
  }

  if (v34)
  {
    v26 = v25;
  }

  else
  {
    v26 = 0.0;
  }

  _fullscreenViewfinder4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder4 setMaterial:v10 withDuration:v26];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setOverscanOverlayAlpha:dbl_1A3A683C8[v10] duration:v26];
}

- (int64_t)_topBarBackgroundStyleForMode:(int64_t)mode capturing:(BOOL)capturing
{
  capturingCopy = capturing;
  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  if (mode > 9)
  {
    return 0;
  }

  if (((1 << mode) & 0x1A6) != 0)
  {
    return capturingCopy;
  }

  v9 = _layoutStyle;
  v10 = [CAMBottomBar wantsVerticalBarForLayoutStyle:_layoutStyle];
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  screen = [window screen];
  v14 = CAMIsTallScreen(screen);

  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (v9)
  {
    v16 = 2;
  }

  else
  {
    _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
    _isAnimatingFilterScrubberDismissal = [(CAMViewfinderViewController *)self _isAnimatingFilterScrubberDismissal];
    v16 = 2;
    if ((_isShowingFilterScrubber | _isAnimatingFilterScrubberDismissal))
    {
      v16 = 0;
    }
  }

  if (v10 || !v14)
  {
    return 0;
  }

  if (isEmulatingImagePicker)
  {
    return 0;
  }

  return v16;
}

- (int64_t)_bottomBarBackgroundStyleForMode:(int64_t)mode
{
  if (![CAMBottomBar wantsVerticalBarForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];
    isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    v5 = 0;
    if (mode <= 3)
    {
      if ((mode - 1) < 2)
      {
        goto LABEL_14;
      }

      if (mode)
      {
        if (mode == 3)
        {
          isCapturingPanorama = [_captureController isCapturingPanorama];
          goto LABEL_13;
        }

LABEL_18:

        return v5;
      }
    }

    else
    {
      if (mode > 9)
      {
        goto LABEL_18;
      }

      if (((1 << mode) & 0x250) == 0)
      {
        if (((1 << mode) & 0x180) == 0)
        {
          if (mode == 5)
          {
            isCapturingPanorama = [_captureController isCapturingTimelapse];
LABEL_13:
            v5 = isCapturingPanorama;
            goto LABEL_18;
          }

          goto LABEL_18;
        }

LABEL_14:
        v5 = isCapturingVideo;
        goto LABEL_18;
      }
    }

    view = [(CAMViewfinderViewController *)self view];
    window = [view window];
    screen = [window screen];
    v13 = CAMIsTallScreen(screen);

    if (isEmulatingImagePicker || !v13)
    {
      v5 = 0;
    }

    else
    {
      v5 = 2;
    }

    goto LABEL_18;
  }

  return 1;
}

- (int64_t)_preferredControlToOpenInDrawerForMode:(int64_t)mode
{
  _preferredControlToOpenInDrawerForMode = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
  v5 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  v6 = [_preferredControlToOpenInDrawerForMode objectForKeyedSubscript:v5];

  if (v6)
  {
    integerValue = [v6 integerValue];
  }

  else
  {
    integerValue = -1;
  }

  return integerValue;
}

- (void)_setPreferredControlToOpenInDrawer:(int64_t)drawer forMode:(int64_t)mode
{
  if (drawer == -1)
  {
    v8 = 0;
  }

  else
  {
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:?];
  }

  _preferredControlToOpenInDrawerForMode = [(CAMViewfinderViewController *)self _preferredControlToOpenInDrawerForMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  [_preferredControlToOpenInDrawerForMode setObject:v8 forKeyedSubscript:v7];
}

- (BOOL)_isControlDrawerShowingPersistentControl
{
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  v3 = _controlDrawer;
  if (_controlDrawer)
  {
    if ([_controlDrawer isControlExpandedForType:4] & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 6) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 7) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 9) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 8) & 1) != 0 || (objc_msgSend(v3, "isControlExpandedForType:", 10))
    {
      v4 = 1;
    }

    else
    {
      v4 = [v3 isControlExpandedForType:11];
    }
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (void)controlDrawer:(id)drawer didSelectMenuItemForControlType:(int64_t)type
{
  v4 = [(CAMViewfinderViewController *)self _fullscreenViewfinder:drawer];
  [v4 dismissModalControlDrawerIfNeededForReason:5];
}

- (void)controlDrawer:(id)drawer wantsFilterScrubberVisible:(BOOL)visible
{
  visibleCopy = visible;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:visible animated:1];
  if (visibleCopy)
  {
    v6 = 4;
  }

  else
  {
    v6 = -1;
  }

  _currentMode = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _setPreferredControlToOpenInDrawer:v6 forMode:_currentMode];
}

- (void)controlDrawer:(id)drawer didCreateControlForType:(int64_t)type
{
  drawerCopy = drawer;
  switch(type)
  {
    case 0:
      [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:0];
      [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
      break;
    case 1:
      [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:0];
      break;
    case 2:
      photoModeAspectRatioCrop = [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
      aspectRatioButton = [drawerCopy aspectRatioButton];
      [aspectRatioButton setAspectRatio:photoModeAspectRatioCrop];
      goto LABEL_16;
    case 3:
      _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
      aspectRatioButton = [drawerCopy timerButton];
      [aspectRatioButton setTimerDuration:_resolvedTimerDuration];
      goto LABEL_16;
    case 4:
      _currentMode = [(CAMViewfinderViewController *)self _currentMode];
      v14 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:_currentMode];
      v15 = v14 != [CAMUserPreferences defaultFilterTypeForMode:_currentMode];
      aspectRatioButton = [drawerCopy filterButton];
      [aspectRatioButton setOn:v15];
      goto LABEL_16;
    case 5:
      [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:0];
      break;
    case 6:
      aspectRatioButton = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:aspectRatioButton zoomFactor:0 animated:?];
LABEL_16:

      break;
    case 7:
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      break;
    case 8:
      [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
      break;
    case 9:
      [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:0];
      break;
    case 10:
      [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
      break;
    case 11:
      smartStyleButton = [drawerCopy smartStyleButton];
      resetButton = [smartStyleButton resetButton];
      [resetButton addTarget:self action:sel__handleSmartStyleResetButton forControlEvents:64];

      smartStyleButton2 = [drawerCopy smartStyleButton];
      shutterButton = [smartStyleButton2 shutterButton];
      [shutterButton addTarget:self action:sel__handleSmartStyleShutterButtonPressed_ forControlEvents:1];

      smartStyleButton3 = [drawerCopy smartStyleButton];
      shutterButton2 = [smartStyleButton3 shutterButton];
      [shutterButton2 addTarget:self action:sel__handleSmartStyleShutterButtonReleased_ forControlEvents:64];

      smartStyleButton4 = [drawerCopy smartStyleButton];
      [smartStyleButton4 setResetButtonVisibleWhenExpanded:0];

      [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
      break;
    case 12:
      [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:0];
      break;
    case 13:
      [(CAMViewfinderViewController *)self _updateProResButtonAnimated:0];
      break;
    case 14:
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      break;
    case 15:
      [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:0];
      break;
    default:
      break;
  }
}

- (void)controlDrawerDidCreateFilterScrubber:(id)scrubber
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:_currentGraphConfiguration];
}

- (void)controlDrawerDidCreateApertureSlider:(id)slider
{
  apertureSlider = [slider apertureSlider];
  [apertureSlider addTarget:self action:sel__apertureSliderDidChangeApertureValue_ forControlEvents:4096];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration zoomFactor:?];
}

- (void)controlDrawerDidCreateIntensitySlider:(id)slider
{
  sliderCopy = slider;
  v7 = +[CAMCaptureCapabilities capabilities];
  intensitySlider = [sliderCopy intensitySlider];

  [intensitySlider addTarget:self action:sel__handleIntensitySliderDidChangeValue_ forControlEvents:4096];
  [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
  if (([v7 isAspectRatioCropSupportedForMode:6 devicePosition:0] & 1) != 0 || objc_msgSend(v7, "isAspectRatioCropSupportedForMode:devicePosition:", 6, 1))
  {
    [intensitySlider setTransparentGradients];
    tickMarksConfiguration = [intensitySlider tickMarksConfiguration];
    [tickMarksConfiguration setUseTickMarkLegibilityShadows:1];
  }
}

- (void)controlDrawerDidCreateExposureSlider:(id)slider
{
  exposureSlider = [slider exposureSlider];
  [exposureSlider addTarget:self action:sel__handleExposureSliderDidChangeValue_ forControlEvents:4096];
  [exposureSlider setUseTickMarkLegibilityShadows:1];
  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
}

- (void)controlDrawerDidCreateNightModeSlider:(id)slider
{
  nightModeSlider = [slider nightModeSlider];
  [nightModeSlider addTarget:self action:sel__handleNightModeSliderDidChangeValue_ forControlEvents:4096];
  [nightModeSlider setUseTickMarkLegibilityShadows:1];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
}

- (void)controlDrawerDidCreateSemanticStyleControl:(id)control
{
  semanticStyleControl = [control semanticStyleControl];
  [semanticStyleControl addTarget:self action:sel__handleSemanticStyleControlDidChangeValue_ forControlEvents:4096];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
}

- (void)controlDrawer:(id)drawer didChangeSharedLibraryMode:(int64_t)mode
{
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  [_librarySelectionController userDidPickSharedLibraryMode:mode];
}

- (void)controlDrawer:(id)drawer didChangeValueForControlType:(int64_t)type
{
  _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [_analyticsControlDrawerEvent didChangeValueForControlType:type];
}

- (void)controlStatusBar:(id)bar didCreateIndicatorForType:(unint64_t)type
{
  barCopy = bar;
  switch(type)
  {
    case 0uLL:
      flashIndicator = [barCopy flashIndicator];
      [flashIndicator addTarget:self action:sel__handleFlashIndicatorChangedMode_ forControlEvents:4096];

      [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:0];
      flashIndicator2 = [barCopy flashIndicator];
      _currentGraphConfiguration = flashIndicator2;
      v9 = sel__handleFlashIndicatorLongPressed_;
      goto LABEL_14;
    case 1uLL:
      [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:0];
      break;
    case 2uLL:
      [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:0];
      break;
    case 3uLL:
      _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
      timerIndicator = [barCopy timerIndicator];
      [timerIndicator setTimerDuration:_resolvedTimerDuration];

      timerIndicator2 = [barCopy timerIndicator];
      [timerIndicator2 setShowingValue:1];

      break;
    case 4uLL:
      [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
      break;
    case 5uLL:
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration zoomFactor:0 animated:?];
      goto LABEL_15;
    case 7uLL:
      [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
      break;
    case 8uLL:
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:_currentGraphConfiguration2 animated:0];

      _currentGraphConfiguration = [barCopy videoConfigurationIndicator];
      [_currentGraphConfiguration setTouchDelegate:self];
      goto LABEL_15;
    case 9uLL:
      [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:0];
      break;
    case 0xAuLL:
      [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
      break;
    case 0xBuLL:
      [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
      break;
    case 0xCuLL:
      [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:0];
      break;
    case 0xDuLL:
      [(CAMViewfinderViewController *)self _updateProResButtonAnimated:0];
      break;
    case 0xEuLL:
      [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:0];
      break;
    case 0xFuLL:
      [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:0];
      break;
    case 0x10uLL:
      photoFormatStatusIndicator = [barCopy photoFormatStatusIndicator];
      [photoFormatStatusIndicator addTarget:self action:sel__handlePhotoFormatPickerChangedPhotoFormat_ forControlEvents:4096];

      [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:0];
      flashIndicator2 = [barCopy photoFormatStatusIndicator];
      _currentGraphConfiguration = flashIndicator2;
      v9 = sel__handlePhotoFormatPickerLongPressed_;
LABEL_14:
      [flashIndicator2 addTarget:self action:v9 forControlEvents:0x1000000];
LABEL_15:

      break;
    default:
      break;
  }
}

- (void)controlStatusBar:(id)bar didReceiveTapInIndicatorForType:(unint64_t)type
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v15 = MEMORY[0x1E69E9820];
  v16 = 3221225472;
  v17 = __80__CAMViewfinderViewController_controlStatusBar_didReceiveTapInIndicatorForType___block_invoke;
  v18 = &unk_1E76F98B8;
  v19 = _fullscreenViewfinder;
  selfCopy = self;
  v7 = _fullscreenViewfinder;
  v8 = _Block_copy(&v15);
  v13 = v8;
  switch(type)
  {
    case 0uLL:
      [(CAMViewfinderViewController *)self _handleFlashIndicator:v15];
      break;
    case 1uLL:
      [(CAMViewfinderViewController *)self _handleLivePhotoIndicator:v15];
      break;
    case 2uLL:
      [(CAMViewfinderViewController *)self _handleHDRIndicator:v15];
      break;
    case 3uLL:
      (*(v8 + 2))(v8, 3, v9, v10, v11, v12);
      break;
    case 4uLL:
      (*(v8 + 2))(v8, 4, v9, v10, v11, v12);
      break;
    case 5uLL:
      (*(v8 + 2))(v8, 6);
      v14 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:v15];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:v14 zoomFactor:1 animated:?];

      break;
    case 6uLL:
      (*(v8 + 2))(v8, 7, v9, v10, v11, v12);
      break;
    case 7uLL:
      (*(v8 + 2))(v8, 8, v9, v10, v11, v12);
      break;
    case 9uLL:
      [(CAMViewfinderViewController *)self _handleNightModeIndicator:v15];
      break;
    case 0xAuLL:
      (*(v8 + 2))(v8, 10, v9, v10, v11, v12);
      break;
    case 0xBuLL:
      (*(v8 + 2))(v8, 11, v9, v10, v11, v12);
      break;
    case 0xCuLL:
      [(CAMViewfinderViewController *)self _handleRAWIndicator:v15];
      break;
    case 0xDuLL:
      [(CAMViewfinderViewController *)self _handleProResIndicator:v15];
      break;
    case 0xEuLL:
      [(CAMViewfinderViewController *)self _handleSharedLibraryIndicator:v15];
      break;
    case 0xFuLL:
      [(CAMViewfinderViewController *)self _handleVideoStabilizationIndicator:v15];
      break;
    case 0x10uLL:
      [(CAMViewfinderViewController *)self _handlePhotoFormatPickerTapped:v15];
      break;
    default:
      break;
  }
}

void __80__CAMViewfinderViewController_controlStatusBar_didReceiveTapInIndicatorForType___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) controlDrawer];
  if ([*(a1 + 32) isControlDrawerPresentedModallyWithControlType:a2])
  {
    [*(a1 + 32) dismissModalControlDrawerIfNeededForReason:1];
  }

  else if ([v4 isControlExpandedForType:a2])
  {
    [v4 collapseExpandableButtonsAnimated:1 updatePreferredDrawerControl:1];
  }

  else
  {
    if (a2 == 4)
    {
      [*(a1 + 40) _setWantsFilterScrubberVisible:1 animated:1];
    }

    [*(a1 + 32) presentControlDrawerModally:1 forReason:1 controlType:a2];
  }
}

- (void)controlStatusBar:(id)bar willChangeExpandingControl:(id)control expanded:(BOOL)expanded
{
  if (expanded)
  {
    v5 = [(CAMViewfinderViewController *)self _fullscreenViewfinder:bar];
    [v5 setControlDrawerExpanded:0 forReason:9 animated:1];
  }
}

- (void)badgeTray:(id)tray didCreateBadgeForType:(unint64_t)type
{
  trayCopy = tray;
  switch(type)
  {
    case 0x40uLL:
      _spatialModeHasVideoSelected = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
      spatialBadge = [trayCopy spatialBadge];
      [spatialBadge setSpatialModeHasVideoSelected:_spatialModeHasVideoSelected];
      break;
    case 8uLL:
      _desiredVideoStabilizationMode = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
      spatialBadge = [trayCopy videoStabilizationBadge];
      [spatialBadge setVideoStabilizationMode:_desiredVideoStabilizationMode];
      break;
    case 2uLL:
      _focusAndExposureLockBadgeTypeForCurrentState = [(CAMViewfinderViewController *)self _focusAndExposureLockBadgeTypeForCurrentState];
      spatialBadge = [trayCopy focusLockBadge];
      [spatialBadge setFocusLockType:_focusAndExposureLockBadgeTypeForCurrentState];
      break;
    default:
      goto LABEL_8;
  }

LABEL_8:
}

- (void)_showControlChangeBadgeWithUpdateHandler:(id)handler
{
  handlerCopy = handler;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder badgeTray];
  [badgeTray createBadgesIfNecessary:128];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray2 = [_fullscreenViewfinder2 badgeTray];
  controlChangeBadge = [badgeTray2 controlChangeBadge];
  handlerCopy[2](handlerCopy, controlChangeBadge);

  [(CAMViewfinderViewController *)self _startTimer:0];
}

- (void)_handleFlashIndicator
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  flashIndicator = [controlStatusBar flashIndicator];

  if ([flashIndicator isExpanded])
  {
    _showFlashOrTorchUnavailableAlertView = [flashIndicator setExpanded:0 animated:1];
  }

  else if ([(CAMViewfinderViewController *)self _isFlashUnavailableForMode:_currentMode])
  {
    _showFlashOrTorchUnavailableAlertView = [(CAMViewfinderViewController *)self _showFlashOrTorchUnavailableAlertView];
  }

  else
  {
    _showFlashOrTorchUnavailableAlertView = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:_currentMode flashActive:0];
    if ((_showFlashOrTorchUnavailableAlertView - 1) >= 2)
    {
      v9 = flashIndicator;
      if (_showFlashOrTorchUnavailableAlertView)
      {
        goto LABEL_11;
      }

      selfCopy2 = self;
      v8 = 2;
    }

    else
    {
      selfCopy2 = self;
      v8 = 0;
    }

    _showFlashOrTorchUnavailableAlertView = [(CAMViewfinderViewController *)selfCopy2 handleUserChangedToFlashMode:v8];
  }

  v9 = flashIndicator;
LABEL_11:

  MEMORY[0x1EEE66BB8](_showFlashOrTorchUnavailableAlertView, v9);
}

- (void)_handleLivePhotoIndicator
{
  _resolvedLivePhotoMode = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings]|| !_resolvedLivePhotoMode)
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    isLivePhotoAutoModeSupported = [v5 isLivePhotoAutoModeSupported];

    if (isLivePhotoAutoModeSupported)
    {
      v4 = 2;
    }

    else
    {
      v4 = 1;
    }
  }

  else
  {
    v4 = 0;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToLivePhotoMode:v4];
}

- (void)_handleHDRIndicator
{
  _resolvedHDRMode = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings]|| ![(CAMViewfinderViewController *)self _resolvedHDRMode];

  [(CAMViewfinderViewController *)self handleUserChangedToHDRMode:_resolvedHDRMode];
}

- (void)_handleNightModeIndicator
{
  v3 = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedToNightMode:v3];
}

- (BOOL)_isFlashOrTorchSupportedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  devicePosition = [configurationCopy devicePosition];
  mode = [configurationCopy mode];

  LOBYTE(configurationCopy) = [v4 isFlashOrTorchSupportedForMode:mode devicePosition:devicePosition];
  return configurationCopy;
}

- (void)_handleFlashButtonChangedFlashMode
{
  _flashButton = [(CAMViewfinderViewController *)self _flashButton];
  flashMode = [_flashButton flashMode];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:flashMode];
}

- (void)handleChangedToFlashMode:(int64_t)mode allowFlashOrTorchUnavailableAlert:(BOOL)alert
{
  alertCopy = alert;
  if ([(CAMViewfinderViewController *)self _isFlashUnavailableForMode:[(CAMViewfinderViewController *)self _currentMode]]&& alertCopy)
  {

    [(CAMViewfinderViewController *)self _showFlashOrTorchUnavailableAlertView];
  }

  else
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    if (_currentMode <= 9)
    {
      if (((1 << _currentMode) & 0x186) != 0)
      {
        v8 = [CAMCaptureConversions torchModeForFlashMode:mode];
        if (v8 != [(CAMViewfinderViewController *)self _resolvedTorchMode])
        {
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __90__CAMViewfinderViewController_handleChangedToFlashMode_allowFlashOrTorchUnavailableAlert___block_invoke_2;
          v9[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
          v9[4] = v8;
          [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v9];
        }

        [(CAMViewfinderViewController *)self _setDesiredTorchMode:v8 animated:1];
      }

      else if (((1 << _currentMode) & 0x251) != 0)
      {
        [(CAMViewfinderViewController *)self _setDesiredFlashMode:mode];
        if ([(CAMViewfinderViewController *)self _resolvedFlashMode]!= mode)
        {
          v10[0] = MEMORY[0x1E69E9820];
          v10[1] = 3221225472;
          v10[2] = __90__CAMViewfinderViewController_handleChangedToFlashMode_allowFlashOrTorchUnavailableAlert___block_invoke;
          v10[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
          v10[4] = mode;
          [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v10];
        }

        if (mode && [(CAMViewfinderViewController *)self _shouldDisableCompromisedFlashForDevicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]])
        {
          [(CAMViewfinderViewController *)self _setDidAcceptCompromisedFlash:1];
        }

        [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
        [(CAMViewfinderViewController *)self _updateNightModeConflict:1 isConflicting:[(CAMViewfinderViewController *)self _resolvedFlashMode]!= 0];
      }
    }

    [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:1];
  }
}

- (void)handleUserChangedToMacroMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _setDesiredMacroMode:mode];

  [(CAMViewfinderViewController *)self _updateMacroButtonState];
}

- (int64_t)_resolvedVideoStabilizationMode
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = -[CAMViewfinderViewController _resolvedVideoStabilizationModeForVideoConfiguration:](self, "_resolvedVideoStabilizationModeForVideoConfiguration:", [_currentGraphConfiguration videoConfiguration]);

  return v4;
}

- (int64_t)_resolvedVideoStabilizationModeForVideoConfiguration:(int64_t)configuration
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = +[CAMCaptureCapabilities capabilities];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  videoEncodingBehavior = [_currentGraphConfiguration videoEncodingBehavior];
  trueVideoEnabled = [_currentGraphConfiguration trueVideoEnabled];
  prefersHDR10BitVideo = [_currentGraphConfiguration prefersHDR10BitVideo];
  LOBYTE(v14) = [_currentGraphConfiguration frontRearSimultaneousVideoEnabled];
  if ([v6 isActionModeControlSupportedForMode:mode device:device videoConfiguration:configuration videoEncodingBehavior:videoEncodingBehavior trueVideoEnabled:trueVideoEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v14])
  {
    _desiredVideoStabilizationMode = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  }

  else
  {
    _desiredVideoStabilizationMode = 0;
  }

  return _desiredVideoStabilizationMode;
}

- (void)_setDesiredTorchMode:(int64_t)mode animated:(BOOL)animated
{
  if (self->__desiredTorchMode != mode)
  {
    self->__desiredTorchMode = mode;
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:_currentGraphConfiguration animated:1];
  }
}

- (void)_updateTorchModeForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  v6 = [(CAMViewfinderViewController *)self _resolvedTorchModeForGraphConfiguration:configuration];

  [(CAMViewfinderViewController *)self _setResolvedTorchMode:v6 animated:animatedCopy];
}

- (int64_t)_resolvedTorchModeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _desiredTorchMode = [(CAMViewfinderViewController *)self _desiredTorchMode];
  if ([configurationCopy trueVideoEnabled])
  {
    _desiredTorchMode = [CAMCaptureConversions torchModeForFlashMode:[(CAMViewfinderViewController *)self _resolvedFlashMode]];
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isTorchAvailable = [_captureController isTorchAvailable];
  if ((isTorchAvailable & [(CAMViewfinderViewController *)self _isFlashOrTorchSupportedForGraphConfiguration:configurationCopy]) != 0)
  {
    v8 = _desiredTorchMode;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_setResolvedTorchMode:(int64_t)mode animated:(BOOL)animated
{
  if (self->__resolvedTorchMode != mode)
  {
    animatedCopy = animated;
    self->__resolvedTorchMode = mode;
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    [(CAMViewfinderViewController *)self _updateFlashButtonForMode:_currentMode animated:animatedCopy];

    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:_currentMode];
  }
}

- (void)_updateTorchModeOnControllerForMode:(int64_t)mode
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingVideo])
  {
    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    videoCapturePaused = [_captureController2 videoCapturePaused];

    if (!videoCapturePaused)
    {
      return;
    }
  }

  else
  {
  }

  _resolvedTorchMode = 0;
  if (mode <= 8 && ((1 << mode) & 0x186) != 0)
  {
    _resolvedTorchMode = [(CAMViewfinderViewController *)self _resolvedTorchMode];
  }

  if ([(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay])
  {
    v9 = 0;
  }

  else
  {
    v9 = _resolvedTorchMode;
  }

  _captureController3 = [(CAMViewfinderViewController *)self _captureController];
  [_captureController3 changeToTorchMode:v9];
}

- (void)_handleFlashIndicatorChangedMode:(id)mode
{
  flashMode = [mode flashMode];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:flashMode];
}

- (void)_handleFlashIndicatorLongPressed:(id)pressed
{
  pressedCopy = pressed;
  if (([pressedCopy isExpanded] & 1) == 0 && (objc_msgSend(pressedCopy, "isFlashUnavailable") & 1) == 0)
  {
    [pressedCopy setExpanded:1 animated:1];
  }
}

- (id)_flashOrTorchDisabledMessageForCurrentPowerPressure
{
  _powerController = [(CAMViewfinderViewController *)self _powerController];
  powerPressureLevel = [_powerController powerPressureLevel];

  if (powerPressureLevel)
  {
    v4 = @"FLASH_DISABLED_POWER_PRESSURE_MESSAGE_%@";
  }

  else
  {
    v4 = @"FLASH_DISABLED_MESSAGE_%@";
  }

  v5 = MEMORY[0x1E696AEC0];
  currentDevice = [MEMORY[0x1E69DC938] currentDevice];
  model = [currentDevice model];
  v8 = [v5 stringWithValidatedFormat:v4 validFormatSpecifiers:@"%@" error:0, model];

  v9 = CAMLocalizedFrameworkString(v8, 0);

  return v9;
}

- (void)_showFlashOrTorchUnavailableAlertView
{
  _flashOrTorchUnavailableAlertController = [(CAMViewfinderViewController *)self _flashOrTorchUnavailableAlertController];
  if (!_flashOrTorchUnavailableAlertController)
  {
    v4 = CAMLocalizedFrameworkString(@"FLASH_DISABLED_TITLE", 0);
    v5 = CAMLocalizedFrameworkString(@"OK_REPLY", 0);
    _flashOrTorchDisabledMessageForCurrentPowerPressure = [(CAMViewfinderViewController *)self _flashOrTorchDisabledMessageForCurrentPowerPressure];
    _flashOrTorchUnavailableAlertController = [MEMORY[0x1E69DC650] alertControllerWithTitle:v4 message:_flashOrTorchDisabledMessageForCurrentPowerPressure preferredStyle:1];
    objc_initWeak(&location, self);
    v7 = MEMORY[0x1E69DC648];
    v9 = MEMORY[0x1E69E9820];
    v10 = 3221225472;
    v11 = __68__CAMViewfinderViewController__showFlashOrTorchUnavailableAlertView__block_invoke;
    v12 = &unk_1E76F9900;
    objc_copyWeak(&v13, &location);
    v8 = [v7 actionWithTitle:v5 style:0 handler:&v9];
    [_flashOrTorchUnavailableAlertController addAction:{v8, v9, v10, v11, v12}];
    [_flashOrTorchUnavailableAlertController setPreferredAction:v8];
    [(CAMViewfinderViewController *)self _setFlashOrTorchUnavailableAlertController:_flashOrTorchUnavailableAlertController];
    [(CAMViewfinderViewController *)self presentViewController:_flashOrTorchUnavailableAlertController animated:1 completion:0];

    objc_destroyWeak(&v13);
    objc_destroyWeak(&location);
  }
}

void __68__CAMViewfinderViewController__showFlashOrTorchUnavailableAlertView__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _setFlashOrTorchUnavailableAlertController:0];
}

- (void)_dismissFlashOrTorchUnavailableAlertViewAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _flashOrTorchUnavailableAlertController = [(CAMViewfinderViewController *)self _flashOrTorchUnavailableAlertController];
  if (_flashOrTorchUnavailableAlertController)
  {
    v7 = _flashOrTorchUnavailableAlertController;
    presentedViewController = [(CAMViewfinderViewController *)self presentedViewController];

    if (presentedViewController == v7)
    {
      [(CAMViewfinderViewController *)self dismissViewControllerAnimated:animatedCopy completion:0];
    }

    [(CAMViewfinderViewController *)self _setFlashOrTorchUnavailableAlertController:0];
    _flashOrTorchUnavailableAlertController = v7;
  }
}

- (BOOL)_isHDRSupportedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LOBYTE(configurationCopy) = [v4 isHDRSupportedForMode:mode devicePosition:devicePosition];
  return configurationCopy;
}

- (void)_handleHDRButtonChangedHDRMode
{
  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  hDRMode = [_HDRButton HDRMode];

  [(CAMViewfinderViewController *)self handleUserChangedToHDRMode:hDRMode];
}

- (void)handleUserChangedToHDRMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _setDesiredHDRMode:mode];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
  _resolvedHDRMode = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  [(CAMViewfinderViewController *)self _updateNightModeConflict:2 isConflicting:_resolvedHDRMode != 0];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 shouldSuspendVideoHDRForHDRMode:_resolvedHDRMode captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToVideoHDRSuspended:v6];
}

- (BOOL)_wantsHDRControlsVisibleForGraphConfiguration:(id)configuration
{
  if ([(CAMViewfinderViewController *)self _isHDRSupportedForGraphConfiguration:configuration])
  {
    v3 = +[CAMUserPreferences preferences];
    v4 = [v3 shouldUseModernHDRBehavior] ^ 1;
  }

  else
  {
    LOBYTE(v4) = 0;
  }

  return v4;
}

- (void)_updateHDRButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _resolvedHDRMode = [(CAMViewfinderViewController *)self _resolvedHDRMode];
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings])
  {
    _resolvedHDRMode = 0;
  }

  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  [_HDRButton setHDRMode:_resolvedHDRMode];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  hdrIndicator = [controlStatusBar hdrIndicator];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  hdrButton = [_controlDrawer hdrButton];

  [hdrButton setHDRMode:_resolvedHDRMode animated:animatedCopy];
  [hdrIndicator setHDRMode:_resolvedHDRMode animated:animatedCopy];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v15[0] = MEMORY[0x1E69E9820];
  v15[1] = 3221225472;
  v15[2] = __56__CAMViewfinderViewController__updateHDRButtonAnimated___block_invoke;
  v15[3] = &unk_1E76F97F0;
  selfCopy = self;
  v18 = _resolvedHDRMode;
  v16 = chromeConfigurator;
  v13 = chromeConfigurator;
  [v13 performChanges:v15];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setHdrMode:_resolvedHDRMode];
}

uint64_t __56__CAMViewfinderViewController__updateHDRButtonAnimated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setHdrMode:*(a1 + 48)];
  v2 = [*(a1 + 40) _wantsHDRControlsVisible];
  v3 = *(a1 + 32);

  return [v3 setIsHDRSupported:v2];
}

- (void)_resolvePotentiallyConflictingControlsForMode:(int64_t)mode device:(int64_t)device resolvedFlashMode:(int64_t *)flashMode resolvedHDRMode:(int64_t *)rMode resolvedLivePhotoMode:(int64_t *)photoMode resolvedRAWMode:(int64_t *)wMode resolvedPhotoResolution:(int64_t *)resolution
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ((device - 1) > 0xA)
  {
    v12 = 0;
  }

  else
  {
    v12 = qword_1A3A685B0[device - 1];
  }

  v13 = +[CAMCaptureCapabilities capabilities];
  v33 = [v13 isHDROnSupportedForDevicePosition:v12];
  v14 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForMode:mode device:device];
  v15 = [v13 isHDRSupportedForMode:mode devicePosition:v12];
  v16 = [v13 isFlashOrTorchSupportedForMode:mode devicePosition:v12];
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  isFlashAvailable = [_captureController isFlashAvailable];
  v19 = [(CAMViewfinderViewController *)self _shouldDisableCompromisedFlashForDevicePosition:v12];
  if (v16)
  {
    v16 = isFlashAvailable & !v19;
  }

  v20 = +[CAMUserPreferences preferences];
  v39 = v20;
  if ([v13 isLinearDNGSupportedForMode:mode] && objc_msgSend(v20, "rawControlEnabled"))
  {
    _desiredRAWMode = [(CAMViewfinderViewController *)self _desiredRAWMode];
  }

  else
  {
    _desiredRAWMode = 0;
  }

  v44 = _desiredRAWMode;
  if ([(CAMViewfinderViewController *)self _arePhotoFormatConflictsSupportedForMode:mode device:device])
  {
    _photoFormatConflicts = [(CAMViewfinderViewController *)self _photoFormatConflicts];
  }

  else
  {
    _photoFormatConflicts = 0;
  }

  deviceCopy = device;
  if (v16)
  {
    _desiredFlashMode = [(CAMViewfinderViewController *)self _desiredFlashMode];
  }

  else
  {
    _desiredFlashMode = 0;
  }

  if (isEmulatingImagePicker || (v15 & 1) == 0)
  {
    _desiredHDRMode = 0;
  }

  else
  {
    _desiredHDRMode = [(CAMViewfinderViewController *)self _desiredHDRMode];
  }

  if (isEmulatingImagePicker || !v14)
  {
    _desiredLivePhotoMode = 0;
  }

  else
  {
    _desiredLivePhotoMode = [(CAMViewfinderViewController *)self _desiredLivePhotoMode];
  }

  _desiredPhotoResolution = [(CAMViewfinderViewController *)self _desiredPhotoResolution];
  if ([v13 isModernHDRSupported] && (objc_msgSend(v39, "shouldUseModernHDRBehavior") & 1) != 0)
  {
    _desiredHDRMode = 1;
  }

  else
  {
    if (_desiredHDRMode == 1)
    {
      v26 = v33;
    }

    else
    {
      v26 = 1;
    }

    if (!v26)
    {
      _desiredHDRMode = 0;
    }
  }

  v43 = _desiredFlashMode;
  v41 = _desiredPhotoResolution;
  v42 = _desiredLivePhotoMode;
  if ([_captureController isCapturingBurst])
  {
    _desiredHDRMode = 0;
    v43 = 0;
    v44 = 0;
    v41 = 0;
    v42 = 0;
    v27 = v39;
  }

  else
  {
    if ([(CAMViewfinderViewController *)self _isBurstEndSoundPlaying])
    {
      v28 = 0;
    }

    else
    {
      v28 = _desiredLivePhotoMode;
    }

    [CAMConflictingControlConfiguration resolveDesiredRAWMode:_desiredRAWMode photoFormatConflicts:_photoFormatConflicts desiredLivePhotoMode:v28 desiredFlashMode:_desiredFlashMode toRAWMode:&v44 toLivePhotoMode:&v42 toFlashMode:&v43];
    v29 = v44;
    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    v31 = [v39 photoEncodingBehaviorForMode:mode resolvedRAWMode:v29 isCapturingVideo:objc_msgSend(_captureController2 isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

    if (([v13 isPhotoResolutionSupported:_desiredPhotoResolution forMode:mode device:deviceCopy photoEncoding:v31] & 1) == 0)
    {
      _desiredPhotoResolution = [v13 defaultPhotoResolutionForMode:mode devicePosition:v12 encodingBehavior:v31];
    }

    v27 = v39;
    [v39 resolveDesiredPhotoResolution:_desiredPhotoResolution livePhotoMode:v42 rawMode:v44 conflicts:_photoFormatConflicts mode:mode device:deviceCopy resolvedPhotoResolution:&v41 resolvedLivePhotoMode:&v42];
  }

  if (flashMode)
  {
    *flashMode = v43;
  }

  if (rMode)
  {
    *rMode = _desiredHDRMode;
  }

  if (photoMode)
  {
    *photoMode = v42;
  }

  if (wMode)
  {
    *wMode = v44;
  }

  if (resolution)
  {
    *resolution = v41;
  }
}

- (void)_resolveAndUpdatePotentiallyConflictingControls:(BOOL)controls animated:(BOOL)animated
{
  animatedCopy = animated;
  controlsCopy = controls;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  v21 = 0;
  v22 = 0;
  v20 = 0;
  v18 = 0;
  v19 = 0;
  -[CAMViewfinderViewController _resolvePotentiallyConflictingControlsForMode:device:resolvedFlashMode:resolvedHDRMode:resolvedLivePhotoMode:resolvedRAWMode:resolvedPhotoResolution:](self, "_resolvePotentiallyConflictingControlsForMode:device:resolvedFlashMode:resolvedHDRMode:resolvedLivePhotoMode:resolvedRAWMode:resolvedPhotoResolution:", mode, [_currentGraphConfiguration device], &v22, &v21, &v20, &v19, &v18);
  [(CAMViewfinderViewController *)self _setResolvedFlashMode:v22];
  [(CAMViewfinderViewController *)self _setResolvedHDRMode:v21];
  [(CAMViewfinderViewController *)self _setResolvedLivePhotoMode:v20];
  [(CAMViewfinderViewController *)self _setResolvedRAWMode:v19];
  [(CAMViewfinderViewController *)self _setResolvedPhotoResolution:v18];
  [(CAMViewfinderViewController *)self _updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:animatedCopy];
  v9 = +[CAMCaptureCapabilities capabilities];
  if ([v9 isProResVideoSupportedForMode:mode frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}] && (objc_msgSend(v9, "isProResVideoSupportedForMode:videoConfiguration:outputToExternalStorage:frontRearSimultaneousVideoEnabled:", mode, objc_msgSend(_currentGraphConfiguration, "videoConfiguration"), -[CAMViewfinderViewController _wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:](self, "_wantsExternalStorageOutputEnabledForMode:videoEncodingBehavior:", mode, objc_msgSend(_currentGraphConfiguration, "videoEncodingBehavior")), objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")) & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setDesiredProResVideoMode:0];
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __88__CAMViewfinderViewController__resolveAndUpdatePotentiallyConflictingControls_animated___block_invoke;
  v12[3] = &unk_1E76F9928;
  v15 = v22;
  v16 = v20;
  v17 = v21;
  v13 = chromeConfigurator;
  selfCopy = self;
  v11 = chromeConfigurator;
  [v11 performChanges:v12];
  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:mode animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateRAWButtonAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateProResButtonAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:animatedCopy];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updateCleanLensesInstructionLabelForCurrentState];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
  if (controlsCopy)
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  }

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:mode];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
}

uint64_t __88__CAMViewfinderViewController__resolveAndUpdatePotentiallyConflictingControls_animated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) setFlashMode:*(a1 + 48)];
  [*(a1 + 32) setLivePhotoMode:*(a1 + 56)];
  [*(a1 + 32) setHdrMode:*(a1 + 64)];
  v2 = *(a1 + 40);

  return [v2 _updateChromePhotoFormatsAndResolutions];
}

- (void)_updateFlashModeOnControllerForMode:(int64_t)mode
{
  _resolvedFlashMode = 0;
  if (mode <= 6 && ((1 << mode) & 0x51) != 0)
  {
    _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToFlashMode:_resolvedFlashMode];
}

- (int64_t)_displayedFlashModeForMode:(int64_t)mode flashActive:(BOOL *)active
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isFlashActive = [_captureController isFlashActive];
  isTorchActive = [_captureController isTorchActive];
  _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  if (mode > 9)
  {
    goto LABEL_8;
  }

  if (((1 << mode) & 0x186) != 0)
  {
    _resolvedFlashMode = [CAMCaptureConversions flashModeForTorchMode:[(CAMViewfinderViewController *)self _resolvedTorchMode]];
    goto LABEL_10;
  }

  if (((1 << mode) & 0x51) == 0)
  {
    _resolvedFlashMode = 0;
LABEL_8:
    isTorchActive = 0;
    goto LABEL_10;
  }

  isCapturingVideo = [_captureController isCapturingVideo];
  if ((isCapturingVideo | isFlashActive))
  {
    isTorchActive |= isCapturingVideo ^ 1;
  }

  else
  {
    isTorchActive = [(CAMViewfinderViewController *)self _resolvedFlashMode]== 1;
  }

LABEL_10:
  _resolvedNightMode = [(CAMViewfinderViewController *)self _resolvedNightMode];
  v13 = 2;
  if (_resolvedFlashMode != 1)
  {
    v13 = _resolvedFlashMode;
  }

  if (_resolvedNightMode == 1)
  {
    v14 = 0;
  }

  else
  {
    v13 = _resolvedFlashMode;
    v14 = isTorchActive;
  }

  if (_resolvedNightMode == 2)
  {
    v15 = 0;
  }

  else
  {
    v15 = v13;
  }

  if (_resolvedNightMode == 2)
  {
    v16 = isTorchActive;
  }

  else
  {
    v16 = v14;
  }

  if (active)
  {
    *active = v16 & 1;
  }

  return v15;
}

- (void)_updateFlashButtonForMode:(int64_t)mode animated:(BOOL)animated
{
  animatedCopy = animated;
  v22 = 0;
  v7 = [(CAMViewfinderViewController *)self _displayedFlashModeForMode:mode flashActive:&v22];
  _flashButton = [(CAMViewfinderViewController *)self _flashButton];
  [_flashButton setFlashMode:v7];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  flashButton = [_controlDrawer flashButton];
  [flashButton setFlashMode:v7 animated:animatedCopy];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  flashIndicator = [controlStatusBar flashIndicator];

  [flashIndicator setFlashActive:v22];
  [flashIndicator setFlashMode:v7 animated:animatedCopy];
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setFlashMode:v7];

  v15 = +[CAMCaptureCapabilities capabilities];
  if ([v15 isFlashSupportedForMode:mode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setFlashMode:v7];

    v17 = v22;
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setIsFlashActive:v17];
LABEL_5:

    goto LABEL_6;
  }

  if ([v15 isTorchSupportedForMode:mode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
  {
    v19 = [CAMCaptureConversions torchModeForFlashMode:v7];
    chromeConfigurator3 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator3 setTorchMode:v19];

    v21 = v22;
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setIsTorchActive:v21];
    goto LABEL_5;
  }

LABEL_6:
}

- (void)_handleSharedLibraryIndicator
{
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  if (CAMSharedLibraryModeIsOn([_librarySelectionController sharedLibraryMode]))
  {
    v3 = 3;
  }

  else
  {
    v3 = 2;
  }

  [_librarySelectionController userDidPickSharedLibraryMode:v3];
  [(CAMViewfinderViewController *)self _startTimer:2];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (void)_updateSharedLibraryButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  sharedLibraryMode = [_librarySelectionController sharedLibraryMode];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  sharedLibraryIndicator = [controlStatusBar sharedLibraryIndicator];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  sharedLibraryButton = [_controlDrawer sharedLibraryButton];

  [sharedLibraryIndicator setSharedLibraryMode:sharedLibraryMode animated:animatedCopy];
  [sharedLibraryButton setSharedLibraryMode:sharedLibraryMode animated:animatedCopy];
  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [_sharedLibraryButton setSharedLibraryMode:sharedLibraryMode];

  _sharedLibraryButton2 = +[CAMCaptureCapabilities capabilities];
  if ([_sharedLibraryButton2 isInternalInstall])
  {
    sharedLibraryLongPressGestureRecognizer = self->__sharedLibraryLongPressGestureRecognizer;

    if (sharedLibraryLongPressGestureRecognizer)
    {
      goto LABEL_5;
    }

    v14 = [objc_alloc(MEMORY[0x1E69DCC48]) initWithTarget:self action:sel_sharedLibraryTapToRadarAction];
    v15 = self->__sharedLibraryLongPressGestureRecognizer;
    self->__sharedLibraryLongPressGestureRecognizer = v14;

    [(UILongPressGestureRecognizer *)self->__sharedLibraryLongPressGestureRecognizer setDelegate:self];
    [sharedLibraryIndicator addGestureRecognizer:self->__sharedLibraryLongPressGestureRecognizer];
    _sharedLibraryButton2 = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    [_sharedLibraryButton2 addGestureRecognizer:self->__sharedLibraryLongPressGestureRecognizer];
  }

LABEL_5:
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    sharedLibraryMode = [(CAMViewfinderViewController *)self _cachedSharedLibraryTimerState];
  }

  [_remoteShutterController setSharedLibraryMode:sharedLibraryMode];

  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
}

- (void)_updateChromeSharedLibraryState
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v3 = +[CAMUserPreferences preferences];
  sharedLibraryEnabled = [v3 sharedLibraryEnabled];
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  [chromeConfigurator setSharedLibraryEnabled:sharedLibraryEnabled mode:{objc_msgSend(_librarySelectionController, "sharedLibraryMode")}];
}

- (void)_updateChromeClassicModeSwitching
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v2 = +[CAMUserPreferences preferences];
  [chromeConfigurator setIsClassicModeSwitchingEnabled:{objc_msgSend(v2, "classicModeSwitchingEnabled")}];
}

- (void)_updateSharedLibraryBadgeForCurrentState
{
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  sharedLibraryMode = [_librarySelectionController sharedLibraryMode];

  _sharedLibraryBadge = [(CAMViewfinderViewController *)self _sharedLibraryBadge];
  [_sharedLibraryBadge setSharedLibraryMode:sharedLibraryMode];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (void)sharedLibraryTapToRadarAction
{
  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  touchingGestureRecognizer = [_sharedLibraryButton touchingGestureRecognizer];
  [touchingGestureRecognizer cancelGesture];

  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  tapToRadarAlertController = [_librarySelectionController tapToRadarAlertController];

  [(CAMViewfinderViewController *)self presentViewController:tapToRadarAlertController animated:1 completion:0];
}

- (void)librarySelectionDidChangeSharedLibraryMode:(int64_t)mode
{
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    v4 = os_log_create("com.apple.camera", "SharedLibrary");
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *v5 = 0;
      _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Library selection controller changed shared library mode when timer was active, not updating shared library state", v5, 2u);
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _startTimer:2];
    [(CAMViewfinderViewController *)self _updateSharedLibraryButtonAnimated:1];

    [(CAMViewfinderViewController *)self _updateSharedLibraryBadgeForCurrentState];
  }
}

- (void)_updateLivePhotoButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _isLivePhotoSupportedForGraphConfiguration:_currentGraphConfiguration];

  _resolvedLivePhotoMode = [(CAMViewfinderViewController *)self _resolvedLivePhotoMode];
  _isNightModeActiveForCurrentSettings = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
  if (v6)
  {
    if (_isNightModeActiveForCurrentSettings)
    {
      _resolvedLivePhotoMode = 0;
    }

    _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
    [_livePhotoButton setLivePhotoMode:_resolvedLivePhotoMode];

    _livePhotoBadge = [(CAMViewfinderViewController *)self _livePhotoBadge];
    [_livePhotoBadge setIrisMode:_resolvedLivePhotoMode];

    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    livePhotoButton = [_controlDrawer livePhotoButton];
    [livePhotoButton setLivePhotoMode:_resolvedLivePhotoMode animated:animatedCopy];

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    livePhotoIndicator = [controlStatusBar livePhotoIndicator];
    [livePhotoIndicator setLivePhotoMode:_resolvedLivePhotoMode animated:animatedCopy];

    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController setIrisMode:_resolvedLivePhotoMode];

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setLivePhotoMode:_resolvedLivePhotoMode];
  }
}

- (BOOL)_isLivePhotoSupportedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  device = [configurationCopy device];

  return [(CAMViewfinderViewController *)self _isLivePhotoSupportedForMode:mode device:device];
}

- (BOOL)_isLivePhotoSupportedForMode:(int64_t)mode device:(int64_t)device
{
  if ((device - 1) > 0xA)
  {
    v5 = 0;
  }

  else
  {
    v5 = qword_1A3A685B0[device - 1];
  }

  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isLivePhotoSupportedForMode:mode devicePosition:v5];

  return v7;
}

- (BOOL)_shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll
{
  v12 = 0;
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  device = [configurationCopy device];

  [(CAMViewfinderViewController *)self _resolvePotentiallyConflictingControlsForMode:mode device:device resolvedFlashMode:0 resolvedHDRMode:0 resolvedLivePhotoMode:&v12 resolvedRAWMode:0 resolvedPhotoResolution:0];
  _isBurstEndSoundPlaying = [(CAMViewfinderViewController *)self _isBurstEndSoundPlaying];
  if (v12)
  {
    rollCopy = roll;
  }

  else
  {
    rollCopy = 1;
  }

  return rollCopy || _isBurstEndSoundPlaying;
}

- (void)_updatePairedVideoCaptureOnControllerForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll
{
  rollCopy = roll;
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(rollCopy) = [(CAMViewfinderViewController *)self _shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:configurationCopy isShowingCameraRoll:rollCopy];

  if (rollCopy)
  {
    [_captureController pauseCapturingStillImagePairedVideo];
  }

  else
  {
    [_captureController resumeCapturingStillImagePairedVideo];
  }
}

- (void)_pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:(id)configuration isShowingCameraRoll:(BOOL)roll
{
  rollCopy = roll;
  configurationCopy = configuration;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(rollCopy) = [(CAMViewfinderViewController *)self _shouldPauseCapturingStillImagePairedVideoForGraphConfiguration:configurationCopy isShowingCameraRoll:rollCopy];

  if (rollCopy)
  {
    [_captureController pauseCapturingStillImagePairedVideo];
  }
}

- (int64_t)_aspectRatioCropForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(position) = [v7 isAspectRatioCropSupportedForMode:mode devicePosition:position];

  if (!position || mode != 6 && mode)
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self photoModeAspectRatioCrop];
}

- (void)handleUserChangedToAspectRatioCrop:(int64_t)crop
{
  [(CAMViewfinderViewController *)self setPhotoModeAspectRatioCrop:?];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", _currentMode, videoConfiguration, _currentDevicePosition, [_currentGraphConfiguration2 trueVideoEnabled]);

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setViewportAspectRatio:v10 animated:1];
  _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
  [_prominentObjectManager setViewportAspectRatio:v10];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToAspectRatioCrop:crop];

  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateShutterButtonLegibility];
  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration3 zoomFactor:?];

  controlDrawer = [_fullscreenViewfinder controlDrawer];
  aspectRatioButton = [controlDrawer aspectRatioButton];
  [aspectRatioButton setAspectRatio:crop];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setAspectRatioCrop:crop];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  v17 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration4 mode];
  _currentGraphConfiguration5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(mode) = [v17 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration5, "devicePosition")}];

  if (mode)
  {
    _currentGraphConfiguration6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration6 animated:1];

    _currentGraphConfiguration7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:_currentGraphConfiguration7 animated:1];

    _currentGraphConfiguration8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v24 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoZoomForGraphConfiguration:_currentGraphConfiguration8];
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setIsSmartFramingAutoZoomSupported:v24];

    _currentGraphConfiguration9 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v27 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoRotationForGraphConfiguration:_currentGraphConfiguration9];
    chromeConfigurator3 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator3 setIsSmartFramingAutoRotationSupported:v27];

    _currentGraphConfiguration10 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration10];
  }
}

- (int64_t)_videoConfigurationResolutionForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  videoConfiguration = [configurationCopy videoConfiguration];
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
  LOBYTE(v15) = [configurationCopy frontRearSimultaneousVideoEnabled];
  v12 = [v5 resolvedVideoConfigurationForMode:mode device:device videoEncodingBehavior:videoEncodingBehavior videoConfiguration:videoConfiguration outputToExternalStorage:_externalStorageOutputEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v15];

  videoStabilizationStrength = [configurationCopy videoStabilizationStrength];
  result = 0;
  if (v12 <= 0xE)
  {
    if (((1 << v12) & 0x7620) != 0)
    {
      if (videoStabilizationStrength > 3)
      {
        return 0;
      }

      else
      {
        return qword_1A3A683F0[videoStabilizationStrength];
      }
    }

    else if (((1 << v12) & 0x992) != 0)
    {
      return 2;
    }

    else
    {
      return ((1 << v12) & 0x4C) != 0;
    }
  }

  return result;
}

- (int64_t)_videoConfigurationFramerateForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  videoConfiguration = [configurationCopy videoConfiguration];
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  prefersHDR10BitVideo = [configurationCopy prefersHDR10BitVideo];
  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];

  LOBYTE(v15) = frontRearSimultaneousVideoEnabled;
  v13 = [v5 resolvedVideoConfigurationForMode:mode device:device videoEncodingBehavior:videoEncodingBehavior videoConfiguration:videoConfiguration outputToExternalStorage:_externalStorageOutputEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v15];

  if ((v13 - 1) > 0xD)
  {
    return 0;
  }

  else
  {
    return qword_1A3A68410[v13 - 1];
  }
}

- (void)_updateVideoConfigurationStatusIndicatorForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v7 = [(CAMViewfinderViewController *)self _videoConfigurationResolutionForGraphConfiguration:configurationCopy];
  v8 = [(CAMViewfinderViewController *)self _videoConfigurationFramerateForGraphConfiguration:configurationCopy];

  if (v7 && v8)
  {
    _targetVideoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _targetVideoConfigurationStatusIndicator];
    [_targetVideoConfigurationStatusIndicator setResolution:v7 framerate:v8 animated:animatedCopy];
  }
}

- (void)_handleRAWIndicator
{
  v3 = [(CAMViewfinderViewController *)self _resolvedRAWMode]== 0;

  [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:v3];
}

- (BOOL)_arePhotoFormatConflictsSupportedForMode:(int64_t)mode device:(int64_t)device
{
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = +[CAMUserPreferences preferences];
  if ([v6 isLinearDNGSupportedForMode:mode])
  {
    rawControlEnabled = [v7 rawControlEnabled];
  }

  else
  {
    rawControlEnabled = 0;
  }

  v9 = [v6 isPhotoResolutionSupported:3 forMode:mode device:device photoEncoding:1];
  if (v9)
  {
    LOBYTE(v9) = [v7 photoFormatControlEnabled];
  }

  v10 = rawControlEnabled | v9;

  return v10 & 1;
}

- (void)_setPhotoFormatConflict:(unint64_t)conflict isConflicting:(BOOL)conflicting
{
  conflictingCopy = conflicting;
  if ([(CAMViewfinderViewController *)self _arePhotoFormatConflictsSupportedForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]])
  {
    _photoFormatConflicts = [(CAMViewfinderViewController *)self _photoFormatConflicts];
    if (conflictingCopy)
    {
      v8 = _photoFormatConflicts | conflict;
    }

    else
    {
      v8 = _photoFormatConflicts & ~conflict;
    }

    [(CAMViewfinderViewController *)self _setPhotoFormatConflicts:v8];
  }
}

- (void)_handleUserChangedRAWMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _setDesiredRAWMode:?];
  if (mode == 1)
  {
    [(CAMViewfinderViewController *)self _setPhotoFormatConflicts:0];
  }

  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self _updatePhotoFormatPickerAnimated:1];
  [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_updateRAWButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  rawIndicator = [controlStatusBar rawIndicator];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  rawButton = [_controlDrawer rawButton];

  [rawButton setRAWMode:_resolvedRAWMode animated:animatedCopy];
  [rawIndicator setRAWMode:_resolvedRAWMode animated:animatedCopy];
}

- (void)setRawMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:mode];

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)setPhotoResolution:(int64_t)resolution
{
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];

  [(CAMViewfinderViewController *)self handleUserChangedToPhotoFormat:currentPhotoFormat, resolution];
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_essentialPhotoFormat
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 fallbackPhotoFormatForDesiredFormat:objc_msgSend(v3 mode:"photoEncodingBehavior") device:objc_msgSend(v3, "preferredHEICPhotoResolutionForDevicePosition:", -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")), -[CAMViewfinderViewController _currentMode](self, "_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")];
  v6 = v5;

  v7 = v4;
  v8 = v6;
  result.var1 = v8;
  result.var0 = v7;
  return result;
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_advancedPhotoFormat
{
  _desiredAdvancedPhotoFormat = [(CAMViewfinderViewController *)self _desiredAdvancedPhotoFormat];
  v5 = v4;
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  v8 = +[CAMUserPreferences preferences];
  v9 = [v8 isPhotoFormat:_desiredAdvancedPhotoFormat enabledForMode:v5 device:_currentMode, _currentDevice];

  if ((v9 & 1) == 0)
  {
    v10 = [(CAMViewfinderViewController *)self _enabledPhotoFormatsForMode:_currentMode device:_currentDevice];
    _essentialPhotoFormat = [(CAMViewfinderViewController *)self _essentialPhotoFormat];
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __51__CAMViewfinderViewController__advancedPhotoFormat__block_invoke;
    v18[3] = &__block_descriptor_48_e24_B32__0__NSValue_8Q16_B24l;
    v18[4] = _essentialPhotoFormat;
    v18[5] = v12;
    v13 = [v10 indexOfObjectWithOptions:2 passingTest:v18];
    if (v13 == 0x7FFFFFFFFFFFFFFFLL)
    {
      v14 = 0;
    }

    else
    {
      v14 = v13;
    }

    v15 = [v10 objectAtIndexedSubscript:v14];
    v19 = 0;
    v20 = 0;
    [v15 getValue:&v19 size:16];
    _desiredAdvancedPhotoFormat = v19;
    v5 = v20;
  }

  v16 = _desiredAdvancedPhotoFormat;
  v17 = v5;
  result.var1 = v17;
  result.var0 = v16;
  return result;
}

BOOL __51__CAMViewfinderViewController__advancedPhotoFormat__block_invoke(uint64_t a1, void *a2)
{
  v5 = 0;
  v6 = 0;
  [a2 getValue:&v5 size:16];
  return v5 != *(a1 + 32) || v6 != *(a1 + 40);
}

- (void)_handlePhotoFormatPickerTapped
{
  _currentGraphConfiguration = [self _currentGraphConfiguration];
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0(&dword_1A3640000, v2, v3, "Photo format picker tapped from unsupported configuration: %{public}@", v4, v5, v6, v7, v8);
}

- (void)_handlePhotoFormatPickerChangedPhotoFormat:(id)format
{
  photoFormat = [format photoFormat];
  v6 = v5;
  [(CAMViewfinderViewController *)self _setDesiredPhotoFormat:photoFormat, v5];

  [(CAMViewfinderViewController *)self handleUserChangedToPhotoFormat:photoFormat, v6];
}

- (void)handleUserChangedToPhotoFormat:(id)format
{
  var1 = format.var1;
  var0 = format.var0;
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v8 = v7;
  v9 = var0 == 2;
  [(CAMViewfinderViewController *)self _setDesiredPhotoResolution:var1];
  [(CAMViewfinderViewController *)self _setDesiredRAWMode:v9];
  if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== v9)
  {
    if (var1 == 3)
    {
      [(CAMViewfinderViewController *)self _setPhotoFormatConflict:2 isConflicting:0];
    }

    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
  }

  else
  {
    [(CAMViewfinderViewController *)self _handleUserChangedRAWMode:v9];
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:_currentGraphConfiguration fromGraphConfiguration:_currentGraphConfiguration2 animated:1];

  v20 = +[CAMCaptureCapabilities capabilities];
  v12 = [v20 isDepthSuggestionSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:"_currentMode") photoFormat:-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition"), currentPhotoFormat, v8];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  currentPhotoFormat2 = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(_currentDevicePosition) = [v20 isDepthSuggestionSupportedForMode:_currentMode devicePosition:_currentDevicePosition photoFormat:currentPhotoFormat2, v16];
  portraitInPhotoModeBehavior = [v20 portraitInPhotoModeBehavior];
  if (v12 != _currentDevicePosition)
  {
    v18 = portraitInPhotoModeBehavior;
    if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
    {
      if ((v18 & 4) != 0)
      {
        _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:_currentGraphConfiguration3 animated:1];
      }
    }
  }
}

- (void)_handlePhotoFormatPickerLongPressed:(id)pressed
{
  pressedCopy = pressed;
  if (([pressedCopy isExpanded] & 1) == 0)
  {
    [pressedCopy setExpanded:1 animated:1];
  }
}

- (void)_updatePhotoFormatPickerAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:_currentGraphConfiguration];

  if (v6)
  {
    v7 = [(CAMViewfinderViewController *)self _enabledPhotoFormatsForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    photoFormatStatusIndicator = [controlStatusBar photoFormatStatusIndicator];

    _essentialPhotoFormat = [(CAMViewfinderViewController *)self _essentialPhotoFormat];
    v20 = v11;
    v12 = [MEMORY[0x1E696B098] valueWithBytes:&_essentialPhotoFormat objCType:"{?=qq}"];
    v13 = [v7 indexOfObject:v12];

    _essentialPhotoFormat = [(CAMViewfinderViewController *)self _advancedPhotoFormat];
    v20 = v14;
    v15 = [MEMORY[0x1E696B098] valueWithBytes:&_essentialPhotoFormat objCType:"{?=qq}"];
    v16 = [v7 indexOfObject:v15];

    [photoFormatStatusIndicator setAllowedFormats:v7 essentialFormatIndex:v13 advancedFormatIndex:v16];
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    [photoFormatStatusIndicator setPhotoFormat:currentPhotoFormat animated:v18, animatedCopy];
    [photoFormatStatusIndicator setLongPressEnabled:{objc_msgSend(v7, "count") > 2}];
  }
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)currentPhotoFormat
{
  v3 = +[CAMUserPreferences preferences];
  v4 = [v3 resolvedPhotoFormatForResolvedResolution:-[CAMViewfinderViewController _resolvedPhotoResolution](self rawMode:{"_resolvedPhotoResolution"), -[CAMViewfinderViewController _resolvedRAWMode](self, "_resolvedRAWMode")}];
  v6 = v5;

  v7 = v4;
  v8 = v6;
  result.var1 = v8;
  result.var0 = v7;
  return result;
}

- (id)_enabledPhotoFormatsForMode:(int64_t)mode device:(int64_t)device
{
  v18 = *MEMORY[0x1E69E9840];
  v6 = +[CAMUserPreferences preferences];
  v14[0] = [v6 photoEncodingBehavior];
  v14[1] = 1;
  v14[2] = v14[0];
  v14[3] = 2;
  v14[4] = v14[0];
  v15 = xmmword_1A3A68310;
  v16 = xmmword_1A3A681C0;
  v17 = 3;
  array = [MEMORY[0x1E695DF70] array];
  for (i = 0; i != 10; i += 2)
  {
    v9 = v14[i];
    v10 = v14[i + 1];
    if ([v6 isPhotoFormat:v9 enabledForMode:v10 device:mode, device])
    {
      v13[0] = v9;
      v13[1] = v10;
      v11 = [MEMORY[0x1E696B098] valueWithBytes:v13 objCType:"{?=qq}"];
      [array addObject:v11];
    }
  }

  return array;
}

- (void)_handleProResIndicator
{
  v3 = [(CAMViewfinderViewController *)self _desiredProResVideoMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedProResMode:v3];
}

- (void)handleUserChangedProResMode:(int64_t)mode chromeSelectedProResColorSpace:(int64_t)space
{
  [(CAMViewfinderViewController *)self set_chromeSelectedProResColorSpace:space];
  v6 = +[CAMUserPreferences preferences];
  [v6 setExplicitProResColorSpace:{-[CAMViewfinderViewController _chromeSelectedProResColorSpace](self, "_chromeSelectedProResColorSpace")}];
  [(CAMViewfinderViewController *)self handleUserChangedProResMode:mode];
}

- (void)handleUserChangedProResMode:(int64_t)mode
{
  v27 = *MEMORY[0x1E69E9840];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v8 = _externalStorageOutputEnabled;
  if (mode || !_externalStorageOutputEnabled)
  {
    if (mode == 1)
    {
      _connectedStorage = [(CAMViewfinderViewController *)self _connectedStorage];
      v10 = _connectedStorage != 0;

      v8 |= v10;
    }
  }

  else
  {
    v8 = 0;
  }

  v11 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    if (mode == 1)
    {
      v12 = @"ON";
    }

    else
    {
      v12 = @"OFF";
    }

    _connectedStorage2 = [(CAMViewfinderViewController *)self _connectedStorage];
    if (_connectedStorage2)
    {
      _connectedStorage3 = [(CAMViewfinderViewController *)self _connectedStorage];
      displayName = [_connectedStorage3 displayName];
    }

    else
    {
      displayName = @"NONE";
    }

    v15 = @"NO";
    if (v8)
    {
      v15 = @"YES";
    }

    v16 = v15;
    v21 = 138543874;
    v22 = v12;
    v23 = 2114;
    v24 = displayName;
    v25 = 2114;
    v26 = v16;
    _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "External storage: userChangedProResMode proResMode=%{public}@, connectedStorage=%{public}@, resolvedExternalStorageOutput=%{public}@", &v21, 0x20u);
    if (_connectedStorage2)
    {
    }
  }

  v17 = +[CAMCaptureCapabilities capabilities];
  v18 = [v17 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:objc_msgSend(_currentGraphConfiguration frontRearSimultaneousVideoEnabled:{"videoConfiguration"), v8 & 1, objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}];

  if (mode == 1 && v18 && [(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormatForVideoEncodingBehavior:2])
  {
    [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
  }

  else if ((mode != 1) | v18 & 1)
  {
    [(CAMViewfinderViewController *)self _setDesiredProResVideoMode:mode];
    device = [_currentGraphConfiguration device];
    -[CAMViewfinderViewController set_videoConfigurationOverride:](self, "set_videoConfigurationOverride:", -[CAMViewfinderViewController _mappedVideoConfigurationForVideoConfiguration:proResVideoMode:outputToExternalStorage:](self, "_mappedVideoConfigurationForVideoConfiguration:proResVideoMode:outputToExternalStorage:", [_currentGraphConfiguration videoConfiguration], -[CAMViewfinderViewController _desiredProResVideoMode](self, "_desiredProResVideoMode"), v8 & 1));
    v20 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:device fromGraphConfiguration:_currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v20 zoomFactor:1 deferIfConfigurationInFlight:?];
    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:v8 & 1 animated:1];
  }

  else
  {
    -[CAMViewfinderViewController _showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:](self, "_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:", [_currentGraphConfiguration videoConfiguration]);
  }
}

- (void)_updateProResButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _desiredProResVideoMode = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  proResIndicator = [controlStatusBar proResIndicator];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  proResButton = [_controlDrawer proResButton];

  [proResButton setProResVideoMode:_desiredProResVideoMode animated:animatedCopy];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v13 = -[CAMViewfinderViewController _resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:](self, "_resolvedColorSpaceForMode:videoConfiguration:videoEncodingBehavior:device:", 1, videoConfiguration, 2, [_currentGraphConfiguration2 device]);

  [proResIndicator setProResVideoMode:_desiredProResVideoMode colorSpace:v13 animated:animatedCopy];
}

- (void)_showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:(int64_t)configuration
{
  v21 = CAMLocalizedFrameworkString(@"PRO_RES_UNSUPPORTED_ALERT_TITLE", 0);
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  v7 = +[CAMCaptureCapabilities capabilities];
  if ([v7 externalStorageSupported])
  {
    if (((configuration < 7) & (0x4Cu >> configuration)) != 0)
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_720P";
    }

    else
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_1080P_HFR";
    }

    if (((configuration < 7) & (0x4Cu >> configuration)) != 0 || ((configuration < 7) & (0x10u >> configuration)) != 0)
    {
      goto LABEL_23;
    }

    if (!v6)
    {
      isBack4k120VideoSupported = [v7 isBack4k120VideoSupported];
      v11 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_1080P30_MAX";
      v12 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_1080P30_MAX_4k120";
LABEL_17:
      if (isBack4k120VideoSupported)
      {
        v8 = v12;
      }

      else
      {
        v8 = v11;
      }

      goto LABEL_23;
    }

    _resolvedVideoStabilizationMode = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode];
    if (_resolvedVideoStabilizationMode != 1)
    {
      if (!_resolvedVideoStabilizationMode)
      {
        isBack4k120VideoSupported = [v7 isBack4k120VideoSupported];
        v11 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_4k30_MAX";
        v12 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_4k30_MAX_4k120";
        goto LABEL_17;
      }

LABEL_20:
      v14 = 0;
      goto LABEL_24;
    }

    v8 = @"PRO_RES_UNSUPPORTED_EXTERNAL_STORAGE_ALERT_DESCRIPTION_28K30_MAX";
  }

  else if (v6)
  {
    _resolvedVideoStabilizationMode2 = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode];
    if (_resolvedVideoStabilizationMode2)
    {
      if (_resolvedVideoStabilizationMode2 != 1)
      {
        goto LABEL_20;
      }

      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_28K30_MAX";
    }

    else
    {
      v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_4k30_MAX";
    }
  }

  else
  {
    v8 = @"PRO_RES_UNSUPPORTED_ALERT_DESCRIPTION_1080P30_MAX";
  }

LABEL_23:
  v14 = CAMLocalizedFrameworkString(v8, 0);
LABEL_24:
  v15 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v21 message:v14 preferredStyle:1];
  v16 = MEMORY[0x1E69DC648];
  v17 = CAMLocalizedFrameworkString(@"PRO_RES_UNSUPPORTED_ALERT_OK", 0);
  v18 = [v16 actionWithTitle:v17 style:0 handler:0];
  [v15 addAction:v18];

  [(CAMViewfinderViewController *)self presentViewController:v15 animated:1 completion:0];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [chromeConfigurator setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", _currentGraphConfiguration)}];
}

- (void)_startOrCancelPurgeIfNecessary
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isProResVideoSupportedForMode:objc_msgSend(_currentGraphConfiguration videoConfiguration:"mode") outputToExternalStorage:objc_msgSend(_currentGraphConfiguration frontRearSimultaneousVideoEnabled:{"videoConfiguration"), -[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}];

  videoEncodingBehavior = [_currentGraphConfiguration videoEncodingBehavior];
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  purgeableStorageContainer = [_storageController purgeableStorageContainer];
  v8 = purgeableStorageContainer;
  if (v4 && videoEncodingBehavior == 2)
  {
    [purgeableStorageContainer purgeFastPurgeableSpaceWithRequestType:0];
  }

  else
  {
    [purgeableStorageContainer cancelPurge];
  }
}

- (void)_updateMaxRecordingTimeInstructionLabelForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  videoConfiguration = [configurationCopy videoConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isProResVideoSupportedForMode:objc_msgSend(configurationCopy videoConfiguration:"mode") outputToExternalStorage:objc_msgSend(configurationCopy frontRearSimultaneousVideoEnabled:{"videoConfiguration"), -[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];

  videoEncodingBehavior = [configurationCopy videoEncodingBehavior];
  if (v6)
  {
    v8 = videoConfiguration == 0;
  }

  else
  {
    v8 = 1;
  }

  if (!v8 && videoEncodingBehavior == 2)
  {
    _storageController = [(CAMViewfinderViewController *)self _storageController];
    [_storageController availableRecordingTimeInSecondsForGraphConfiguration:configurationCopy];
    v12 = v11;

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setRemainingRecordingTime:v12];
  }
}

- (void)_updateFreeResourcesInstructionLabelForCurrentState
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  freeResourcesInstructionLabel = [_fullscreenViewfinder freeResourcesInstructionLabel];

  _storageController = [(CAMViewfinderViewController *)self _storageController];
  _urgentlyNeedsToPurgeDiskSpace = [(CAMViewfinderViewController *)self _urgentlyNeedsToPurgeDiskSpace];
  purgeableStorageContainer = [_storageController purgeableStorageContainer];
  isPurging = [purgeableStorageContainer isPurging];

  purgeableStorageContainer2 = [_storageController purgeableStorageContainer];
  isCancelingPurge = [purgeableStorageContainer2 isCancelingPurge];

  LOBYTE(purgeableStorageContainer2) = [(CAMViewfinderViewController *)self _hasSignificantAmountOfRecordingTimeForCurrentConfiguration];
  purgeableStorageContainer3 = [_storageController purgeableStorageContainer];
  hasPurgeableResources = [purgeableStorageContainer3 hasPurgeableResources];

  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v13 = 3;
  if (((purgeableStorageContainer2 | _externalStorageOutputEnabled) | hasPurgeableResources))
  {
    v13 = 0;
  }

  v14 = 1;
  if (_urgentlyNeedsToPurgeDiskSpace)
  {
    v14 = 2;
  }

  if (isCancelingPurge)
  {
    v14 = 4;
  }

  if (isPurging)
  {
    v15 = v14;
  }

  else
  {
    v15 = v13;
  }

  [freeResourcesInstructionLabel setFreeResourceInstructionState:v15];
}

- (void)_handleFreeResourcesLabelTapped:(id)tapped
{
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  freeResourcesInstructionLabel = [_fullscreenViewfinder freeResourcesInstructionLabel];

  freeResourceInstructionState = [freeResourcesInstructionLabel freeResourceInstructionState];
  if (freeResourceInstructionState == 3)
  {
    CAMShowStorageUsageInSettings();
  }

  else
  {
    if (freeResourceInstructionState == 1)
    {
      purgeableStorageContainer = [_storageController purgeableStorageContainer];
      [purgeableStorageContainer cancelPurge];
    }

    else
    {
      if (freeResourceInstructionState)
      {
        goto LABEL_8;
      }

      purgeableStorageContainer = [_storageController purgeableStorageContainer];
      [purgeableStorageContainer purgeFastPurgeableSpaceWithRequestType:1];
    }
  }

LABEL_8:
}

- (void)_handleCleanLensesInstructionLabelTapped:(id)tapped
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  devicePosition = [_currentGraphConfiguration devicePosition];

  if (devicePosition)
  {
    if (devicePosition != 1)
    {
      goto LABEL_6;
    }

    _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  }

  else
  {
    _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  }

  v7 = _lensSmudgeDisplayFrontState;
  [_lensSmudgeDisplayFrontState acknowledgeSmudgeDetection];

LABEL_6:
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration2 animated:1];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (BOOL)_urgentlyNeedsToPurgeDiskSpace
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];

  if (!videoConfiguration)
  {
    return 0;
  }

  _storageController = [(CAMViewfinderViewController *)self _storageController];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [_storageController availableRecordingTimeInSecondsForGraphConfiguration:_currentGraphConfiguration2];
  v8 = v7;

  v9 = v8 <= 10.0;
  return v9;
}

- (BOOL)_hasSignificantAmountOfRecordingTimeForCurrentConfiguration
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];

  if (!videoConfiguration)
  {
    return 1;
  }

  _storageController = [(CAMViewfinderViewController *)self _storageController];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [_storageController availableRecordingTimeInSecondsForGraphConfiguration:_currentGraphConfiguration2];
  v8 = v7;

  v9 = v8 > 900.0;
  return v9;
}

- (int64_t)_mappedVideoConfigurationForVideoConfiguration:(int64_t)configuration proResVideoMode:(int64_t)mode outputToExternalStorage:(BOOL)storage
{
  storageCopy = storage;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:configuration frontRearSimultaneousVideoEnabled:{storageCopy, -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

  if (!mode || (v10 & 1) != 0)
  {
    return configuration;
  }

  if (configuration <= 9)
  {
    if (configuration != 1 && configuration != 5)
    {
      if (configuration == 9)
      {
        v11 = +[CAMCaptureCapabilities capabilities];
        v12 = [v11 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

        if (v12)
        {
          return 1;
        }

        else
        {
          return 7;
        }
      }

      return configuration;
    }

    return 7;
  }

  if ((configuration - 13) < 2)
  {
    v13 = +[CAMCaptureCapabilities capabilities];
    v14 = [v13 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:9 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

    v15 = +[CAMCaptureCapabilities capabilities];
    v16 = [v15 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:1 frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];

    v17 = 7;
    if (v16)
    {
      v17 = 1;
    }

    if (v14)
    {
      return 9;
    }

    else
    {
      return v17;
    }
  }

  else
  {
    if (configuration == 12)
    {
      return 11;
    }

    if (configuration == 10)
    {
      return 7;
    }
  }

  return configuration;
}

- (void)_updateVideoStabilizationButtonAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _desiredVideoStabilizationMode = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  videoStabilizationButton = [_controlDrawer videoStabilizationButton];
  [videoStabilizationButton setVideoStabilizationMode:_desiredVideoStabilizationMode animated:animatedCopy];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  videoStabilizationIndicator = [controlStatusBar videoStabilizationIndicator];
  [videoStabilizationIndicator setVideoStabilizationMode:_desiredVideoStabilizationMode animated:animatedCopy];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder2 badgeTray];
  videoStabilizationBadge = [badgeTray videoStabilizationBadge];
  [videoStabilizationBadge setVideoStabilizationMode:_desiredVideoStabilizationMode];
}

- (void)_handleVideoStabilizationIndicator
{
  v3 = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode]== 0;

  [(CAMViewfinderViewController *)self handleUserChangedVideoStabilizationMode:v3];
}

- (void)handleUserChangedVideoStabilizationMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _setDesiredVideoStabilizationMode:?];
  [(CAMViewfinderViewController *)self _startFlashingVideoStabilizationBadge];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateVideoStabilizationButtonAnimated:1];
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  v7 = +[CAMCaptureCapabilities capabilities];
  _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __71__CAMViewfinderViewController_handleUserChangedVideoStabilizationMode___block_invoke;
  v12[3] = &unk_1E76F9970;
  selfCopy = self;
  modeCopy = mode;
  v13 = v5;
  v9 = v5;
  -[CAMViewfinderViewController set_videoConfigurationOverride:](self, "set_videoConfigurationOverride:", [v7 validatedVideoConfigurationForVideoConfiguration:_currentVideoConfiguration withBlock:v12]);

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:v6 fromGraphConfiguration:_currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v11];
  [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v11 zoomFactor:1 deferIfConfigurationInFlight:?];
}

uint64_t __71__CAMViewfinderViewController_handleUserChangedVideoStabilizationMode___block_invoke(uint64_t a1, uint64_t a2)
{
  v17 = [*(a1 + 32) videoStabilizationStrengthForVideoStabilizationMode:*(a1 + 48) captureMode:{objc_msgSend(*(a1 + 40), "_currentMode")}];
  v3 = +[CAMCaptureCapabilities capabilities];
  v16 = [*(a1 + 40) _currentMode];
  v4 = [*(a1 + 40) _currentDevice];
  v5 = [*(a1 + 40) _currentGraphConfiguration];
  v6 = [v5 videoEncodingBehavior];
  v7 = [*(a1 + 40) _externalStorageOutputEnabled];
  v8 = [*(a1 + 40) _currentGraphConfiguration];
  v9 = [v8 trueVideoEnabled];
  v10 = [*(a1 + 40) _currentGraphConfiguration];
  v11 = [v10 prefersHDR10BitVideo];
  v12 = [*(a1 + 40) _currentGraphConfiguration];
  BYTE2(v15) = [v12 frontRearSimultaneousVideoEnabled];
  BYTE1(v15) = v11;
  LOBYTE(v15) = v9;
  v13 = [v3 isVideoStabilizationStrength:v17 supportedForMode:v16 device:v4 videoConfiguration:a2 videoEncodingBehavior:v6 outputToExternalStorage:v7 trueVideoEnabled:v15 prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:?];

  return v13;
}

- (void)_startFlashingVideoStabilizationBadge
{
  [CAMViewfinderViewController cancelPreviousPerformRequestsWithTarget:self selector:sel__stopFlashingVideoStabilizationBadge object:0];
  [(CAMViewfinderViewController *)self _setFlashingVideoStabilizationBadge:1];
  +[CAMLivePhotoButton enablingAnimationDuration];

  [(CAMViewfinderViewController *)self performSelector:sel__stopFlashingVideoStabilizationBadge withObject:0 afterDelay:?];
}

- (void)_stopFlashingVideoStabilizationBadge
{
  [CAMViewfinderViewController cancelPreviousPerformRequestsWithTarget:self selector:sel__stopFlashingVideoStabilizationBadge object:0];
  [(CAMViewfinderViewController *)self _setFlashingVideoStabilizationBadge:0];

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1];
}

- (BOOL)videoConfigurationStatusIndicatorShouldRespondToTap:(id)tap
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  trueVideoEnabled = [_currentGraphConfiguration trueVideoEnabled];

  return trueVideoEnabled ^ 1;
}

- (void)handleUserChangedToVideoConfiguration:(int64_t)configuration
{
  v5 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self frontRearSimultaneousVideoEnabled:{"_currentMode"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
  v8 = [v5 isProResVideoSupportedForMode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") outputToExternalStorage:configuration frontRearSimultaneousVideoEnabled:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled"), -[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
  if (!v7 || (v8 & 1) != 0 || [(CAMViewfinderViewController *)self _desiredProResVideoMode]!= 1)
  {
    v9 = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoActiveForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
    v10 = +[CAMUserPreferences preferences];
    v11 = [v10 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    v12 = [(CAMViewfinderViewController *)self _resolvedVideoStabilizationModeForVideoConfiguration:configuration];
    v13 = +[CAMUserPreferences preferences];
    v14 = [v13 videoStabilizationStrengthForVideoStabilizationMode:v12 captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

    v15 = +[CAMCaptureCapabilities capabilities];
    v16 = [v15 resolvedDeviceForDesiredDevice:v11 mode:-[CAMViewfinderViewController _currentMode](self videoConfiguration:"_currentMode") videoStabilizationStrength:configuration frontRearSimultaneousVideoEnabled:{v14, v9}];

    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [CAMZoomControlUtilities equivalentZoomFactor:v16 forDevice:[(CAMViewfinderViewController *)self _currentDevice] fromDevice:v17];
    v19 = v18;
    v20 = [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v16 fromDevice:[(CAMViewfinderViewController *)self _currentMode] mode:[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 videoConfiguration:configuration videoStabilizationStrength:v14 frontRearSimultaneousVideoEnabled:v9 zoomFactors:0 displayZoomFactors:0] continuousZoomSupported:v18];
    v21 = +[CAMCaptureCapabilities capabilities];
    v22 = [v21 isSupportedVideoConfiguration:configuration forMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), v20}];

    if (v22)
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [CAMZoomControlUtilities equivalentZoomFactor:v20 forDevice:[(CAMViewfinderViewController *)self _currentDevice] fromDevice:v23];
      v25 = v24;
      v16 = v20;
    }

    else
    {
      v35 = 0;
      [CAMZoomControlUtilities shouldApplyContinuousZoomForMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 videoConfiguration:configuration videoStabilizationStrength:v14 frontRearSimultaneousVideoEnabled:v9 zoomFactors:&v35 displayZoomFactors:0];
      v26 = v35;
      lastObject = [v26 lastObject];
      [lastObject floatValue];
      v29 = v28;

      if (v19 >= v29)
      {
        [v26 lastObject];
      }

      else
      {
        [v26 firstObject];
      }
      v30 = ;

      [v30 floatValue];
      v32 = v31;

      v25 = v32;
    }

    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    if (_currentMode > 9)
    {
      goto LABEL_16;
    }

    if (((1 << _currentMode) & 0x378) != 0)
    {
      goto LABEL_21;
    }

    if (_currentMode == 2)
    {
      [(CAMViewfinderViewController *)self set_slomoConfigurationOverride:configuration];
      goto LABEL_20;
    }

    if (_currentMode == 7)
    {
      [(CAMViewfinderViewController *)self set_cinematicConfigurationOverride:configuration];
    }

    else
    {
LABEL_16:
      if (!_currentMode)
      {
        goto LABEL_21;
      }

      if (_currentMode == 1)
      {
        [(CAMViewfinderViewController *)self set_videoConfigurationOverride:configuration];
      }
    }

LABEL_20:
    v34 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:v16 fromGraphConfiguration:_currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:v34 animated:1];
    [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v34 zoomFactor:1 deferIfConfigurationInFlight:v25];

    goto LABEL_21;
  }

  [(CAMViewfinderViewController *)self _showProResUnsupportedAlertAndDisableRelevantControlsForVideoConfiguration:configuration];
LABEL_21:
}

- (void)_advanceVideoFrameRate
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoEncodingBehavior = [_currentGraphConfiguration2 videoEncodingBehavior];

  v7 = [(CAMViewfinderViewController *)self _nextFramerateVideoConfigurationForVideoConfiguration:videoConfiguration videoEncodingBehavior:videoEncodingBehavior];
  if (v7 != videoConfiguration)
  {

    [(CAMViewfinderViewController *)self handleUserChangedToVideoConfiguration:v7];
  }
}

- (BOOL)shouldSwitchToVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior
{
  v7 = +[CAMUserPreferences preferences];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (-[CAMViewfinderViewController _isFrontRearSimultaneousVideoActiveForMode:devicePosition:](self, "_isFrontRearSimultaneousVideoActiveForMode:devicePosition:", _currentMode, -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")) && (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v9 = objc_claimAutoreleasedReturnValue(), v10 = [v9 isFrontRearSimultaneousVideoSupportedForVideoConfiguration:configuration], v9, !v10))
  {
    v18 = 0;
  }

  else
  {
    v11 = [v7 defaultDeviceForModeChange:_currentMode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
    v12 = +[CAMCaptureCapabilities capabilities];
    v13 = [v12 isSupportedVideoConfiguration:configuration forMode:_currentMode device:v11];

    isPALVideoEnabled = [v7 isPALVideoEnabled];
    if ([v7 usingMostCompatibleEncoding])
    {
      v15 = 1;
    }

    else
    {
      +[CAMCaptureCapabilities capabilities];
      v17 = v16 = configuration;
      v15 = [v17 isHEVCEncodingSupported] ^ 1;

      configuration = v16;
    }

    behaviorCopy = behavior;
    switch(configuration)
    {
      case 1:
      case 5:
      case 7:
      case 10:
        goto LABEL_7;
      case 2:
        break;
      case 3:
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 is1080p240SupportedForDevice:v11];

        LOBYTE(v15) = v15 | v22 ^ 1;
        break;
      case 4:
        if (_currentMode != 2)
        {
          goto LABEL_21;
        }

        goto LABEL_7;
      case 6:
        v19 = +[CAMCaptureCapabilities capabilities];
        v20 = [v19 is4k30VideoSupportedForDevice:v11];

        if (v20)
        {
          LOBYTE(v15) = [v7 videoConfiguration] == 6;
        }

        else
        {
LABEL_7:
          LOBYTE(v15) = 1;
        }

        break;
      case 8:
        v15 = v15 ^ 1 | [v7 didConfirmSlomoMostCompatible];
        break;
      case 9:
      case 13:
LABEL_21:
        didConfirmVideoMostCompatible = [v7 didConfirmVideoMostCompatible];
        v15 = v15 ^ 1 | didConfirmVideoMostCompatible | (behavior == 2) | [v7 didConfirmSlomoMostCompatible];
        break;
      case 11:
      case 12:
        LOBYTE(v15) = isPALVideoEnabled;
        break;
      case 14:
        didConfirmVideoMostCompatible2 = [v7 didConfirmVideoMostCompatible];
        if (behavior == 2)
        {
          v24 = 1;
        }

        else
        {
          v24 = didConfirmVideoMostCompatible2;
        }

        if ((isPALVideoEnabled & v15) != 0)
        {
          LOBYTE(v15) = v24;
        }

        else
        {
          LOBYTE(v15) = isPALVideoEnabled;
        }

        break;
      default:
        LOBYTE(v15) = 0;
        break;
    }

    v26 = v13 & v15;
    if ([(CAMViewfinderViewController *)self _resolvedVideoStabilizationMode]== 1)
    {
      v27 = +[CAMCaptureCapabilities capabilities];
      _currentMode2 = [(CAMViewfinderViewController *)self _currentMode];
      _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      trueVideoEnabled = [_currentGraphConfiguration trueVideoEnabled];
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      prefersHDR10BitVideo = [_currentGraphConfiguration2 prefersHDR10BitVideo];
      LOBYTE(v35) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
      v33 = [v27 isActionModeControlSupportedForMode:_currentMode2 device:_currentDevice videoConfiguration:configuration videoEncodingBehavior:behaviorCopy trueVideoEnabled:trueVideoEnabled prefersHDR10BitVideo:prefersHDR10BitVideo frontRearSimultaneousVideoEnabled:v35];
    }

    else
    {
      v33 = 1;
    }

    v18 = v26 & v33;
  }

  return v18;
}

- (int64_t)_nextFramerateVideoConfigurationForVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior
{
  configurationCopy = configuration;
  v19 = *MEMORY[0x1E69E9840];
  if ((configuration - 1) > 0xD)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1E76F9E70[configuration - 1];
  }

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    while (2)
    {
      for (i = 0; i != v9; ++i)
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        intValue = [*(*(&v14 + 1) + 8 * i) intValue];
        if ([(CAMViewfinderViewController *)self shouldSwitchToVideoConfiguration:intValue videoEncodingBehavior:behavior])
        {
          return intValue;
        }
      }

      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v9)
      {
        continue;
      }

      break;
    }
  }

  return configurationCopy;
}

- (void)_advanceVideoResolution
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoEncodingBehavior = [_currentGraphConfiguration2 videoEncodingBehavior];

  v7 = [(CAMViewfinderViewController *)self _nextResolutionVideoConfigurationForVideoConfiguration:videoConfiguration videoEncodingBehavior:videoEncodingBehavior];
  if (v7 != videoConfiguration)
  {

    [(CAMViewfinderViewController *)self handleUserChangedToVideoConfiguration:v7];
  }
}

- (int64_t)_nextResolutionVideoConfigurationForVideoConfiguration:(int64_t)configuration videoEncodingBehavior:(int64_t)behavior
{
  configurationCopy = configuration;
  v19 = *MEMORY[0x1E69E9840];
  if ((configuration - 1) > 0xD)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1E76F9EE0[configuration - 1];
  }

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    while (2)
    {
      for (i = 0; i != v9; ++i)
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        intValue = [*(*(&v14 + 1) + 8 * i) intValue];
        if ([(CAMViewfinderViewController *)self shouldSwitchToVideoConfiguration:intValue videoEncodingBehavior:behavior])
        {
          return intValue;
        }
      }

      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v9)
      {
        continue;
      }

      break;
    }
  }

  return configurationCopy;
}

- (void)captureController:(id)controller didOutputFlashActive:(BOOL)active
{
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1, active];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:_currentMode animated:1];
}

- (void)captureController:(id)controller didOutputTorchActive:(BOOL)active
{
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:1, active];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];

  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:_currentMode animated:1];
}

- (void)captureController:(id)controller didOutputNightModeStatus:(int64_t)status
{
  v13 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "NightMode");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    if ((status + 1) > 3)
    {
      v7 = 0;
    }

    else
    {
      v7 = off_1E76F9F50[status + 1];
    }

    v11 = 138543362;
    v12 = v7;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "NightModeStatus: %{public}@", &v11, 0xCu);
  }

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  _isNightModeCaptureCanceling = [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling];
  if (status != -1)
  {
    v9 = _isNightModeCaptureCanceling;
    if (!status)
    {
      [(CAMViewfinderViewController *)self _resetNightModeDurationMappingAnimated:1];
    }

    if (v9)
    {
      _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
      [_closedViewfinderController removeClosedViewfinderReason:11];

      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture cancel ended"];
      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:0];
    }
  }

  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
}

- (void)captureController:(id)controller didOutputNightModeDurationMapping:(id)mapping
{
  [(CAMViewfinderViewController *)self _setNightModeDurationMapping:controller, mapping.var0, mapping.var1];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:1];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:0 animated:1];
}

- (void)captureController:(id)controller didOutputFlashAvailability:(BOOL)availability
{
  availabilityCopy = availability;
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode <= 9 && ((1 << _currentMode) & 0x279) != 0 && availabilityCopy)
  {

    [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  }
}

- (void)captureController:(id)controller didOutputTorchAvailability:(BOOL)availability
{
  availabilityCopy = availability;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self _updateFlashButtonAvailability];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode <= 8 && ((1 << _currentMode) & 0x186) != 0 && availabilityCopy)
  {

    [(CAMViewfinderViewController *)self _dismissFlashOrTorchUnavailableAlertViewAnimated:1];
  }
}

- (void)captureController:(id)controller didOutputFlashCompromise:(unint64_t)compromise
{
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  flashCompromisedInstructionLabel = [_fullscreenViewfinder flashCompromisedInstructionLabel];
  [flashCompromisedInstructionLabel setCompromise:compromise];
}

- (BOOL)_isFlashUnavailableForMode:(int64_t)mode
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode > 9)
  {
    v7 = 0;
  }

  else
  {
    if (((1 << _currentMode) & 0x279) != 0)
    {
      isFlashAvailable = [_captureController isFlashAvailable];
    }

    else
    {
      isFlashAvailable = [_captureController isTorchAvailable];
    }

    v7 = isFlashAvailable ^ 1;
  }

  return v7;
}

- (BOOL)_isFlashCompromisedForDevicePosition:(int64_t)position
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  flashCompromise = [_captureController flashCompromise];

  if (position)
  {
    v6 = 1;
  }

  else
  {
    v6 = (flashCompromise - 1) >= 2;
  }

  return !v6;
}

- (BOOL)_shouldShowFlashCompromisedInstructionsForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  devicePosition = [configurationCopy devicePosition];
  v6 = [(CAMViewfinderViewController *)self _isFlashCompromisedForDevicePosition:devicePosition];
  if ((-[CAMViewfinderViewController _displayedFlashModeForMode:flashActive:](self, "_displayedFlashModeForMode:flashActive:", [configurationCopy mode], 0) - 1) > 1)
  {
    v8 = 0;
  }

  else
  {
    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 isFlashSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), devicePosition}];
  }

  return v6 & v8;
}

- (void)_handleTimerButtonChangedTimerDuration
{
  _timerButton = [(CAMViewfinderViewController *)self _timerButton];
  -[CAMViewfinderViewController _setResolvedTimerDuration:](self, "_setResolvedTimerDuration:", [_timerButton duration]);
}

- (void)handleUserChangedToLivePhotoMode:(int64_t)mode
{
  [(CAMViewfinderViewController *)self _setDesiredLivePhotoMode:?];
  [(CAMViewfinderViewController *)self _startTimer:1];
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __64__CAMViewfinderViewController_handleUserChangedToLivePhotoMode___block_invoke;
  v9[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
  v9[4] = mode;
  [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v9];
  [(CAMViewfinderViewController *)self _setPhotoFormatConflict:2 isConflicting:mode != 0];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  [(CAMViewfinderViewController *)self _updateNightModeConflict:4 isConflicting:[(CAMViewfinderViewController *)self _resolvedLivePhotoMode]!= 0];
  if (([(CAMViewfinderViewController *)self _resolvedLivePhotoMode]- 1) <= 1)
  {
    _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
    [_livePhotoButton performEnablingAnimation];

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    livePhotoIndicator = [controlStatusBar livePhotoIndicator];
    [livePhotoIndicator startAnimating];
  }

  if ([CAMBottomBar wantsVerticalBarForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
  }

  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
}

- (void)_handleLivePhotoButtonChangedLivePhotoMode
{
  _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
  -[CAMViewfinderViewController handleUserChangedToLivePhotoMode:](self, "handleUserChangedToLivePhotoMode:", [_livePhotoButton livePhotoMode]);
}

- (void)_handleSharedLibraryButton
{
  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  if (CAMSharedLibraryModeIsOn([_sharedLibraryButton sharedLibraryMode]))
  {
    v3 = 3;
  }

  else
  {
    v3 = 2;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToSharedLibraryMode:v3];
}

- (void)handleUserChangedToSharedLibraryMode:(int64_t)mode
{
  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [_sharedLibraryButton setSharedLibraryMode:mode];
  _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
  [_librarySelectionController userDidPickSharedLibraryMode:mode];

  [(CAMViewfinderViewController *)self _startTimer:2];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __68__CAMViewfinderViewController_handleUserChangedToSharedLibraryMode___block_invoke;
  v7[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
  v7[4] = mode;
  [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v7];
  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
}

- (void)_setExternalStorageOutputEnabled:(BOOL)enabled animated:(BOOL)animated
{
  v14 = *MEMORY[0x1E69E9840];
  if (self->__externalStorageOutputEnabled != enabled)
  {
    enabledCopy = enabled;
    v6 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v7 = @"OFF";
      if (enabledCopy)
      {
        v7 = @"ON";
      }

      v12 = 138543362;
      v13 = v7;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "External storage: changing external storage output to %{public}@.", &v12, 0xCu);
    }

    if ([(CAMViewfinderViewController *)self _currentMode]== 1 && !enabledCopy)
    {
      [(CAMViewfinderViewController *)self _fallbackToValidProResVideoConfigurationIfNeeded];
    }

    self->__externalStorageOutputEnabled = enabledCopy;
    if (!enabledCopy)
    {
      if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
      {
        _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
        [_cameraRollController dismissCameraRollViewControllerForced:1 animated:0];
      }
    }

    [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
    [(CAMViewfinderViewController *)self _updateExternalStorageDataSources];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setExternalStorageOutputEnabled:enabledCopy];

    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [chromeConfigurator2 setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", _currentGraphConfiguration)}];
  }
}

- (void)_updateExternalStorageDataSources
{
  if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    _connectedStorage = [(CAMViewfinderViewController *)self _connectedStorage];
  }

  else
  {
    _connectedStorage = 0;
  }

  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController setExternalStorage:_connectedStorage];

  _storageController = [(CAMViewfinderViewController *)self _storageController];
  [_storageController setExternalStorage:_connectedStorage];
}

- (void)_fallbackToValidProResVideoConfigurationIfNeeded
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if ([(CAMViewfinderViewController *)self _desiredProResVideoMode])
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __79__CAMViewfinderViewController__fallbackToValidProResVideoConfigurationIfNeeded__block_invoke;
    aBlock[3] = &unk_1E76F9970;
    v5 = v4;
    selfCopy = self;
    v18 = _currentMode;
    v16 = v5;
    v6 = _Block_copy(aBlock);
    if ((v6[2](v6, [(CAMViewfinderViewController *)self _currentVideoConfiguration]) & 1) == 0)
    {
      v7 = +[CAMCaptureCapabilities capabilities];
      v8 = [v7 validatedVideoConfigurationForVideoConfiguration:-[CAMViewfinderViewController _currentVideoConfiguration](self withBlock:{"_currentVideoConfiguration"), v6}];

      [(CAMViewfinderViewController *)self set_videoConfigurationOverride:v8];
      _currentMode2 = [(CAMViewfinderViewController *)self _currentMode];
      _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
      v11 = +[CAMUserPreferences preferences];
      v12 = [v11 defaultDeviceForModeChange:_currentMode2 devicePosition:_currentDevicePosition];

      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v14 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:_currentMode2 device:v12 fromGraphConfiguration:_currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v14];
      [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v14 zoomFactor:1 deferIfConfigurationInFlight:?];
    }
  }
}

uint64_t __79__CAMViewfinderViewController__fallbackToValidProResVideoConfigurationIfNeeded__block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 32);
  v4 = *(a1 + 48);
  v5 = [*(a1 + 40) _isFrontRearSimultaneousVideoEnabled];

  return [v3 isProResVideoSupportedForMode:v4 videoConfiguration:a2 outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:v5];
}

- (void)_showExternalStorageRecordingFailedAlert
{
  v3 = MEMORY[0x1E69DC650];
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_RECORDING_FAILED_TITLE", 0);
  v5 = CAMLocalizedFrameworkString(@"EXTERNAL_RECORDING_FAILED_MESSAGE", 0);
  v11 = [v3 alertControllerWithTitle:v4 message:v5 preferredStyle:1];

  v6 = MEMORY[0x1E69DC648];
  v7 = CAMLocalizedFrameworkString(@"OK", 0);
  v8 = [v6 actionWithTitle:v7 style:1 handler:0];
  [v11 addAction:v8];

  view = [(CAMViewfinderViewController *)self view];
  window = [view window];

  [window pl_presentViewController:v11 animated:1];
}

- (unint64_t)_previousModeSwipeDirectionForLayoutStyle:(int64_t)style
{
  v3 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  v4 = +[CAMUserPreferences preferences];
  classicModeSwitchingEnabled = [v4 classicModeSwitchingEnabled];

  v6 = 4;
  if (classicModeSwitchingEnabled)
  {
    v6 = 8;
  }

  v7 = 1;
  if (!classicModeSwitchingEnabled)
  {
    v7 = 2;
  }

  if (v3)
  {
    return v6;
  }

  else
  {
    return v7;
  }
}

- (unint64_t)_nextModeSwitchDirectionForLayoutStyle:(int64_t)style
{
  v3 = [CAMBottomBar wantsVerticalBarForLayoutStyle:style];
  v4 = +[CAMUserPreferences preferences];
  classicModeSwitchingEnabled = [v4 classicModeSwitchingEnabled];

  v6 = 8;
  if (classicModeSwitchingEnabled)
  {
    v6 = 4;
  }

  v7 = 1;
  if (classicModeSwitchingEnabled)
  {
    v7 = 2;
  }

  if (v3)
  {
    return v6;
  }

  else
  {
    return v7;
  }
}

- (void)_updateSwipeToModeSwitchGestureRecognizersWithDirectionsForLayoutStyle:(int64_t)style
{
  _previousModeGestureRecognizer = [(CAMViewfinderViewController *)self _previousModeGestureRecognizer];
  [_previousModeGestureRecognizer setDirection:{-[CAMViewfinderViewController _previousModeSwipeDirectionForLayoutStyle:](self, "_previousModeSwipeDirectionForLayoutStyle:", style)}];
  _nextModeGestureRecognizer = [(CAMViewfinderViewController *)self _nextModeGestureRecognizer];
  [_nextModeGestureRecognizer setDirection:{-[CAMViewfinderViewController _nextModeSwitchDirectionForLayoutStyle:](self, "_nextModeSwitchDirectionForLayoutStyle:", style)}];
}

- (BOOL)_isSwipeToModeSwitchEnabled
{
  isEnabled = [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer isEnabled];
  if (isEnabled)
  {
    previousModeGestureRecognizer = self->__previousModeGestureRecognizer;

    LOBYTE(isEnabled) = [(UISwipeGestureRecognizer *)previousModeGestureRecognizer isEnabled];
  }

  return isEnabled;
}

- (void)_setSwipeToModeSwitchEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  [(UISwipeGestureRecognizer *)self->__nextModeGestureRecognizer setEnabled:?];
  previousModeGestureRecognizer = self->__previousModeGestureRecognizer;

  [(UISwipeGestureRecognizer *)previousModeGestureRecognizer setEnabled:enabledCopy];
}

- (void)_swipedToNextCameraMode:(id)mode
{
  modeCopy = mode;
  view = [(CAMViewfinderViewController *)self view];
  [modeCopy locationInView:view];
  v7 = v6;
  v9 = v8;

  if ([(CAMViewfinderViewController *)self _canPerformModeChangeForSwipeAtLocation:v7, v9])
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    v16 = [(CAMViewfinderViewController *)self modesForModeDial:0];
    v11 = [MEMORY[0x1E696AD98] numberWithInteger:_currentMode];
    v12 = [v16 indexOfObject:v11];

    v13 = [v16 count];
    if (v12 + 1 < (v13 - 1))
    {
      v14 = v12 + 1;
    }

    else
    {
      v14 = v13 - 1;
    }

    if (v12 != v14)
    {
      v15 = [v16 objectAtIndexedSubscript:?];
      -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [v15 integerValue]);
    }
  }
}

- (void)_swipedToPreviousCameraMode:(id)mode
{
  modeCopy = mode;
  view = [(CAMViewfinderViewController *)self view];
  [modeCopy locationInView:view];
  v7 = v6;
  v9 = v8;

  if ([(CAMViewfinderViewController *)self _canPerformModeChangeForSwipeAtLocation:v7, v9])
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    v15 = [(CAMViewfinderViewController *)self modesForModeDial:0];
    v11 = [MEMORY[0x1E696AD98] numberWithInteger:_currentMode];
    v12 = [v15 indexOfObject:v11];

    if (v12 <= 1)
    {
      v13 = 1;
    }

    else
    {
      v13 = v12;
    }

    if (v12 != v13 - 1)
    {
      v14 = [v15 objectAtIndexedSubscript:?];
      -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [v14 integerValue]);
    }
  }
}

- (CGRect)_rectForModeChangeSwipeAllowedZone
{
  if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
  {
    view = [(CAMViewfinderViewController *)self view];
    [view bounds];
    v5 = v4;
    v7 = v6;
    v9 = v8;
    v11 = v10;
  }

  else
  {
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator collapsedTopBarFrame];
    v14 = v13;
    v16 = v15;

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder externalChromeShutterButtonFrame];
    v19 = v18;

    v7 = v14 + v16;
    view = [(CAMViewfinderViewController *)self view];
    [view bounds];
    v9 = v20 + -40.0;
    v11 = v19 - v7;
    v5 = 20.0;
  }

  v21 = v5;
  v22 = v7;
  v23 = v9;
  v24 = v11;
  result.size.height = v24;
  result.size.width = v23;
  result.origin.y = v22;
  result.origin.x = v21;
  return result;
}

- (BOOL)_canPerformModeChangeForSwipeAtLocation:(CGPoint)location
{
  y = location.y;
  x = location.x;
  [(CAMViewfinderViewController *)self _rectForModeChangeSwipeAllowedZone];
  v9 = x;
  v10 = y;

  return CGRectContainsPoint(*&v5, *&v9);
}

- (void)_handleModeDialTouchDown:(id)down
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 allowHapticsOnConfigurationTaps])
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareDiscreteFeedback:0];
  }
}

- (void)_handleModeDialValueChanged:(id)changed
{
  changedCopy = changed;
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 allowHapticsOnConfigurationTaps])
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController performDiscreteFeedback:0];
  }

  -[CAMViewfinderViewController handleUserChangedToMode:](self, "handleUserChangedToMode:", [changedCopy selectedMode]);
}

- (void)_handleFlipButtonTouchDown:(id)down
{
  _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController prepareDiscreteFeedback:0];
}

- (void)handleFlipButtonReleased
{
  _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController performDiscreteFeedback:0];

  v4 = [(CAMViewfinderViewController *)self _currentDevicePosition]== 0;
  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), v4}];

  [(CAMViewfinderViewController *)self _handleUserChangedToDevice:v6];
}

- (void)_attemptShutterPressWithBlock:(id)block
{
  blockCopy = block;
  v4 = mach_absolute_time();
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:v4];
  CAMSignpostWithIDAndArgs(11, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  [MEMORY[0x1E69E58C0] cancelPreviousPerformRequestsWithTarget:self selector:sel_pressShutterForRemoteShutter object:0];
  _shutterButtonFeedbackForCurrentConfiguration = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
  _capturingFromPhysicalButton = [(CAMViewfinderViewController *)self _capturingFromPhysicalButton];
  v7 = +[CAMCaptureCapabilities capabilities];
  isCameraButtonSupported = [v7 isCameraButtonSupported];

  v9 = _capturingFromPhysicalButton & isCameraButtonSupported;
  if ((_capturingFromPhysicalButton & isCameraButtonSupported & 1) == 0)
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareButtonFeedback:_shutterButtonFeedbackForCurrentConfiguration];
  }

  if (![(CAMViewfinderViewController *)self _isControlDrawerShowingPersistentControl])
  {
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
  }

  [(CAMViewfinderViewController *)self _dismissOverlays];
  if ([(CAMViewfinderViewController *)self _redirectShutterEventIfNecessary:1])
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];
  }

  else
  {
    [(CAMPreviewViewController *)self->__previewViewController notifyShutterButtonPressed];
    if (blockCopy)
    {
      blockCopy[2](blockCopy, v4);
    }
  }

  if ((v9 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:_shutterButtonFeedbackForCurrentConfiguration];
    _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController2 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }
}

- (void)_attemptShutterReleaseWithBlock:(id)block
{
  blockCopy = block;
  CAMSignpostWithIDAndArgs(12, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  _capturingFromPhysicalButton = [(CAMViewfinderViewController *)self _capturingFromPhysicalButton];
  v5 = +[CAMCaptureCapabilities capabilities];
  isCameraButtonSupported = [v5 isCameraButtonSupported];

  v7 = _capturingFromPhysicalButton & isCameraButtonSupported;
  if ((_capturingFromPhysicalButton & isCameraButtonSupported & 1) == 0)
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }

  v9 = [(CAMViewfinderViewController *)self _redirectShutterEventIfNecessary:64];
  if (blockCopy && !v9)
  {
    blockCopy[2]();
  }

  if ((v7 & 1) == 0)
  {
    _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController2 performReleaseButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
  }
}

- (BOOL)dynamicShutterControlCanStartOnTouchDown:(id)down
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode > 9 || ((1 << _currentMode) & 0x211) == 0)
  {
    return 1;
  }

  return [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
}

- (BOOL)dynamicShutterControlShouldBeginGesture:(id)gesture
{
  _shouldEnableShutterButton = [(CAMViewfinderViewController *)self _shouldEnableShutterButton];
  _isActiveZooming = [(CAMViewfinderViewController *)self _isActiveZooming];
  if (!_shouldEnableShutterButton)
  {
    _reasonsToDisableShutterButton = [(CAMViewfinderViewController *)self _reasonsToDisableShutterButton];
    v7 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlShouldBeginGesture:_reasonsToDisableShutterButton];
    }
  }

  return _shouldEnableShutterButton && !_isActiveZooming;
}

- (void)dynamicShutterControlGesturesDidBegin:(id)begin
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidBegin", buf, 2u);
  }

  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __69__CAMViewfinderViewController_dynamicShutterControlGesturesDidBegin___block_invoke;
  v5[3] = &unk_1E76F9998;
  v5[4] = self;
  [(CAMViewfinderViewController *)self _attemptShutterPressWithBlock:v5];
}

uint64_t __69__CAMViewfinderViewController_dynamicShutterControlGesturesDidBegin___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isCTMVideoCaptureSupportedForMode:{objc_msgSend(*(a1 + 32), "_currentMode")}];

  v6 = [*(a1 + 32) _captureController];
  v7 = [v6 isCapturingVideo];

  v8 = [*(a1 + 32) _captureController];
  v9 = [v8 isCapturingNightModeImage];

  v10 = [*(a1 + 32) _isCapturingFromTimer];
  result = [*(a1 + 32) _resolvedTimerDuration];
  if (v5 && (v7 & 1) == 0 && (v10 & 1) == 0 && !result && (v9 & 1) == 0)
  {
    v12 = *(a1 + 32);

    return [v12 _initiateCTMCaptureWithCurrentSettingsAtSystemTime:a2];
  }

  return result;
}

- (void)dynamicShutterControlGesturesDidEnd:(id)end
{
  endCopy = end;
  v5 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    *v9 = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidEnd", v9, 2u);
  }

  [(CAMViewfinderViewController *)self _attemptShutterReleaseWithBlock:0];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsUserInteractingWithShutter:0];

  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  if ([(CAMViewfinderViewController *)self _trueVideoIsActive]&& ![(CAMViewfinderViewController *)self _lockedTrueVideoRecording])
  {
    -[CAMViewfinderViewController _setLockedTrueVideoRecording:](self, "_setLockedTrueVideoRecording:", [endCopy isLocked]);
  }

  if ([endCopy isShutterStateDefault] && -[CAMViewfinderViewController _trueVideoIsTransitioningToCapture](self, "_trueVideoIsTransitioningToCapture"))
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    if (_currentMode == [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
    }

    else
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder setTrueVideoState:0];

      [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"True video state changed to idle"];
      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }
  }
}

- (void)dynamicShutterControlGesturesDidCancel:(id)cancel
{
  v10 = *MEMORY[0x1E69E9840];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsUserInteractingWithShutter:0];

  if (([(CAMViewfinderViewController *)self _currentMode]| 4) == 4)
  {
    _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
    if (_currentStillImageCaptureMomentSettings)
    {
      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      v6 = @"cancel CTM capture";
    }

    else
    {
      v6 = @"no context";
    }
  }

  else
  {
    v6 = @"no context";
  }

  v7 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    v8 = 138543362;
    v9 = v6;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: GesturesDidCancel: %{public}@", &v8, 0xCu);
  }
}

- (void)dynamicShutterControlDidShortPress:(id)press
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v9 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidShortPress", v9, 2u);
  }

  currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (currentCaptureMode <= 9)
  {
    if (((1 << currentCaptureMode) & 0x1AE) != 0)
    {
      [(CAMViewfinderViewController *)self currentCaptureMode];
      v7 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidShortPress:];
      }
    }

    else if (((1 << currentCaptureMode) & 0x11) != 0 && ([(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings], v6 = objc_claimAutoreleasedReturnValue(), v6, v6))
    {
      [(CAMViewfinderViewController *)self _commitCTMCaptureWithType:1];
    }

    else
    {
      [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }
  }
}

- (void)dynamicShutterControlDidStart:(id)start withGesture:(int64_t)gesture
{
  v6 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidStart", buf, 2u);
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsUserInteractingWithShutter:1];

  currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (currentCaptureMode <= 3)
  {
    if ((currentCaptureMode - 1) < 2)
    {
      goto LABEL_17;
    }

    if (currentCaptureMode)
    {
      if (currentCaptureMode != 3)
      {
        return;
      }

      _captureController = [(CAMViewfinderViewController *)self _captureController];
      isCapturingPanorama = [_captureController isCapturingPanorama];

      if (isCapturingPanorama)
      {
        v9 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
        }

        goto LABEL_20;
      }

      _panoramaCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:_panoramaCaptureRequestWithCurrentSettings];
      goto LABEL_26;
    }

LABEL_21:
    if ([(CAMViewfinderViewController *)self _shouldCaptureWithTimer])
    {
      v14 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *v28 = 0;
        _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: Starting timer countdown", v28, 2u);
      }

      [(CAMViewfinderViewController *)self _cancelCTMCapture];
      [(CAMViewfinderViewController *)self _startCountdownForCaptureTimer];
      return;
    }

    if (gesture == 1)
    {
      [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:1];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:1 animated:1];

      _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

      selfCopy4 = self;
      if (!_currentStillImageCaptureMomentSettings)
      {
        [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
        return;
      }

      v19 = 1;
      goto LABEL_46;
    }

    if ([(CAMViewfinderViewController *)self currentCaptureMode]== 6)
    {
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
      }

      goto LABEL_20;
    }

    v20 = +[CAMCaptureCapabilities capabilities];
    if ([v20 isTrueVideoSupported])
    {
      currentCaptureMode2 = [(CAMViewfinderViewController *)self currentCaptureMode];

      if (!currentCaptureMode2)
      {
        _panoramaCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        viewportAspectRatio = [_panoramaCaptureRequestWithCurrentSettings viewportAspectRatio];
        selfCopy3 = self;
        v24 = 0;
        v25 = 1;
LABEL_43:
        [(CAMViewfinderViewController *)selfCopy3 _startTransitioningToTrueVideoCaptureFromSourceMode:v24 sourceAspectRatio:viewportAspectRatio toDestinationMode:v25];
LABEL_26:

        return;
      }
    }

    else
    {
    }

    v26 = +[CAMCaptureCapabilities capabilities];
    if ([v26 isSpatialModeTrueVideoSupported])
    {
      currentCaptureMode3 = [(CAMViewfinderViewController *)self currentCaptureMode];

      if (currentCaptureMode3 == 9)
      {
        _panoramaCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        viewportAspectRatio = [_panoramaCaptureRequestWithCurrentSettings viewportAspectRatio];
        selfCopy3 = self;
        v24 = 9;
        v25 = 8;
        goto LABEL_43;
      }
    }

    else
    {
    }

    selfCopy4 = self;
    v19 = 2;
LABEL_46:
    [(CAMViewfinderViewController *)selfCopy4 _commitCTMCaptureWithType:v19];
    return;
  }

  if (currentCaptureMode > 9)
  {
    return;
  }

  if (((1 << currentCaptureMode) & 0x250) != 0)
  {
    goto LABEL_21;
  }

  if (((1 << currentCaptureMode) & 0x180) != 0)
  {
LABEL_17:
    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController2 isCapturingVideo];

    if (isCapturingVideo)
    {
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
      }

      goto LABEL_20;
    }

    _panoramaCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
    [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:_panoramaCaptureRequestWithCurrentSettings];
    goto LABEL_26;
  }

  if (currentCaptureMode != 5)
  {
    return;
  }

  if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
  {
    v9 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStart:withGesture:];
    }

LABEL_20:

    return;
  }

  [(CAMViewfinderViewController *)self _startTimelapse];
}

- (void)dynamicShutterControlDidStartZoomGesture:(id)gesture
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didStartZoomGesture", v7, 2u);
  }

  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _setVideoZoomFactorAtDynamicShutterStart:?];
  _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
  [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
  [_zoomReporter zoomBeganWithFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{5, v6}];
}

- (void)dynamicShutterControlDidStopZoomGesture:(id)gesture
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v6 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didStopZoomGesture", v6, 2u);
  }

  _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
  [_zoomReporter zoomEndedFromSource:2];
}

- (void)dynamicShutterControl:(id)control didChangeRelativeZoomProgress:(double)progress
{
  v15 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 134217984;
    progressCopy = progress;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: didChangeRelativeZoomProgress: %f", buf, 0xCu);
  }

  v7 = +[CAMUserPreferences preferences];
  defaultCustomLens = [v7 defaultCustomLens];

  if (defaultCustomLens > 5)
  {
    v9 = NAN;
  }

  else
  {
    v9 = dbl_1A3A684B0[defaultCustomLens] / dbl_1A3A68480[defaultCustomLens];
  }

  v10 = pow(1.0 / (0.5 / v9), progress);
  [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __83__CAMViewfinderViewController_dynamicShutterControl_didChangeRelativeZoomProgress___block_invoke;
  v12[3] = &unk_1E76F99C0;
  v12[4] = self;
  [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:5 rampDuration:v12 interactionType:v11 * v10 didChangeDevice:0.5];
  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:5];
}

uint64_t __83__CAMViewfinderViewController_dynamicShutterControl_didChangeRelativeZoomProgress___block_invoke(uint64_t a1, double a2)
{
  v3 = *(a1 + 32);
  [v3 _videoZoomFactorAtDynamicShutterStart];
  v5 = v4 * a2;

  return [v3 _setVideoZoomFactorAtDynamicShutterStart:v5];
}

- (void)dynamicShutterControlDidStop:(id)stop
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidStop", buf, 2u);
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (currentCaptureMode <= 3)
  {
    if ((currentCaptureMode - 1) < 2)
    {
      goto LABEL_15;
    }

    if (currentCaptureMode)
    {
      if (currentCaptureMode != 3)
      {
        goto LABEL_33;
      }

      if ([_captureController isCapturingPanorama])
      {
        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        goto LABEL_33;
      }

      v11 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidStop:];
      }

      goto LABEL_32;
    }

LABEL_17:
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
      goto LABEL_33;
    }

    if ([_captureController isCapturingNightModeImage])
    {
      _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
      [_closedViewfinderController addClosedViewfinderReason:11];

      [(CAMViewfinderViewController *)self _cancelCaptureAnimation];
      v12[0] = MEMORY[0x1E69E9820];
      v12[1] = 3221225472;
      v12[2] = __60__CAMViewfinderViewController_dynamicShutterControlDidStop___block_invoke;
      v12[3] = &unk_1E76F77B0;
      v13 = _captureController;
      [v13 stopCaptureSessionWithCompletion:v12];
      [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
      [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture cancel began"];
      _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
      nightModeSlider = [_controlDrawer nightModeSlider];
      [nightModeSlider endCaptureAnimationAnimated:1];

      _nightModeInstructionLabel = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
      [_nightModeInstructionLabel cancelCountDown];

      [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:1];
      goto LABEL_33;
    }

    if ([(CAMViewfinderViewController *)self currentCaptureMode]!= 6)
    {
      [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

    goto LABEL_32;
  }

  if (currentCaptureMode > 9)
  {
    goto LABEL_33;
  }

  if (((1 << currentCaptureMode) & 0x250) != 0)
  {
    goto LABEL_17;
  }

  if (((1 << currentCaptureMode) & 0x180) != 0)
  {
LABEL_15:
    if ([(CAMViewfinderViewController *)self _trueVideoIsActive])
    {
      [(CAMViewfinderViewController *)self _trueVideoStopCapture];
      goto LABEL_33;
    }

    if ([_captureController isCapturingVideo])
    {
      [(CAMViewfinderViewController *)self _stopCapturingVideo];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

    goto LABEL_32;
  }

  if (currentCaptureMode == 5)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
    {
      [(CAMViewfinderViewController *)self _stopTimelapse];
      goto LABEL_33;
    }

    v11 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidStop:];
    }

LABEL_32:
  }

LABEL_33:
}

- (void)dynamicShutterControlDidPressLockButton:(id)button
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v14 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressLockButton", v14, 2u);
  }

  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  CAMSignpostWithIDAndArgs(13, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  CAMSignpostWithIDAndArgs(14, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (currentCaptureMode <= 9)
  {
    if (((1 << currentCaptureMode) & 0x3E8) != 0)
    {
      [(CAMViewfinderViewController *)self currentCaptureMode];
      v9 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
      }

      return;
    }

    if (((1 << currentCaptureMode) & 6) != 0)
    {
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      isCapturingVideo = [_captureController isCapturingVideo];

      if (!isCapturingVideo)
      {
        v8 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
        }

        return;
      }
    }

    else
    {
      _captureController2 = [(CAMViewfinderViewController *)self _captureController];
      isCapturingVideo2 = [_captureController2 isCapturingVideo];

      if ((isCapturingVideo2 & 1) == 0)
      {
        v13 = os_log_create("com.apple.camera", "DynamicShutter");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
          [CAMViewfinderViewController dynamicShutterControlDidPressLockButton:];
        }
      }
    }

    [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
  }
}

- (void)dynamicShutterControlDidPressPauseResumeButton:(id)button
{
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (v5)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];

    if (isCapturingVideo)
    {
      _captureController2 = [(CAMViewfinderViewController *)self _captureController];
      videoCapturePaused = [_captureController2 videoCapturePaused];

      v10 = os_log_create("com.apple.camera", "DynamicShutter");
      v11 = os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT);
      if (videoCapturePaused)
      {
        if (v11)
        {
          *buf = 0;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressResume", buf, 2u);
        }

        [(CAMViewfinderViewController *)self _resumeCaptureVideo];
      }

      else
      {
        if (v11)
        {
          *v14 = 0;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPressPause", v14, 2u);
        }

        [(CAMViewfinderViewController *)self _pauseCapturingVideo];
      }

      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }

    else
    {
      v13 = os_log_create("com.apple.camera", "DynamicShutter");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController dynamicShutterControlDidPressPauseResumeButton:];
      }
    }
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "DynamicShutter");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidPressPauseResumeButton:?];
    }
  }
}

- (void)dynamicShutterControlDidPresentCounter:(id)counter
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidPresentCounter", v7, 2u);
  }

  _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  if (_currentStillImageCaptureMomentSettings)
  {
    [(CAMViewfinderViewController *)self _cancelCTMCapture];
  }

  else
  {
    v6 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController dynamicShutterControlDidPresentCounter:];
    }
  }

  [(CAMViewfinderViewController *)self _beginCapturingBurst];
}

- (void)dynamicShutterControlDidDismissCounter:(id)counter
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: DidDismissCounter", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _stopCapturingBurst];
}

- (void)shutterControlTouchAttemptedWhileDisabled:(id)disabled
{
  v4 = os_log_create("com.apple.camera", "DynamicShutter");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Dynamic Shutter: TouchAttemptedWhileDisabled", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _handleDisabledShutterTap];
}

- (void)shutterControlDidUpdateLiquidShutter:(id)shutter
{
  shutterCopy = shutter;
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [shutterCopy updateChromeViewModel:chromeConfigurator];
}

- (BOOL)_redirectShutterEventIfNecessary:(unint64_t)necessary
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v7 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", _currentGraphConfiguration, [_callStatusMonitor isCallActive]);

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isInterrupted = [_captureController isInterrupted];

  v10 = +[CAMCaptureCapabilities capabilities];
  captureOnTouchDown = [v10 captureOnTouchDown];

  if (necessary != 1)
  {
    if (necessary != 128 && necessary != 64)
    {
      LOBYTE(isInterrupted) = 0;
      goto LABEL_14;
    }

    captureOnTouchDown ^= 1u;
  }

  if (v7)
  {
    _captureController2 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(_captureController2, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_1A3640000, _captureController2, OS_LOG_TYPE_DEFAULT, "Ignoring shutter button while current mode is disabled", buf, 2u);
    }

LABEL_12:

    LOBYTE(isInterrupted) = 1;
    goto LABEL_14;
  }

  if ((isInterrupted & captureOnTouchDown) == 1)
  {
    v13 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *v15 = 0;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Ignoring capture from shutter button: we're interrupted, attempting to end interruption", v15, 2u);
    }

    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    [_captureController2 attemptToEndInterruptions];
    goto LABEL_12;
  }

LABEL_14:

  return isInterrupted;
}

- (void)_handleDisabledShutterTap
{
  v17 = *MEMORY[0x1E69E9840];
  CAMSignpostWithIDAndArgs(65, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  _reasonsToDisableShutterButton = [(CAMViewfinderViewController *)self _reasonsToDisableShutterButton];
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    v5 = CAMDebugStringForControlDisableReasons(_reasonsToDisableShutterButton);
    *v16 = 138543362;
    *&v16[4] = v5;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Disabled shutter button was tapped, disabled for reasons: %{public}@", v16, 0xCu);
  }

  if (_reasonsToDisableShutterButton)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController logCaptureAvailabilityDescription];
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  v8 = _dynamicShutterControl != 0;

  v9 = +[CAMUserPreferences preferences];
  responsiveShutterEnabled = [v9 responsiveShutterEnabled];

  v11 = mach_absolute_time();
  v12 = v11 - [(CAMViewfinderViewController *)self _lastShutterButtonTouchDownTime];
  *v16 = 0;
  mach_timebase_info(v16);
  v13 = [[CAMAnalyticsIgnoredShutterEvent alloc] initWithReasons:_reasonsToDisableShutterButton timeSinceLastPress:v8 dynamicShutterEnabled:responsiveShutterEnabled responsiveShutterEnabled:(v12 * *v16 / *&v16[4]) / 1000000000.0];
  [(CAMAnalyticsEvent *)v13 publish];
  if ((_reasonsToDisableShutterButton & 0x80) != 0)
  {
    _storageController = [(CAMViewfinderViewController *)self _storageController];
    purgeableStorageContainer = [_storageController purgeableStorageContainer];
    [purgeableStorageContainer cancelPurge];
  }
}

- (void)_handleShutterButtonPressed:(id)pressed
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __59__CAMViewfinderViewController__handleShutterButtonPressed___block_invoke;
  v3[3] = &unk_1E76F9998;
  v3[4] = self;
  [(CAMViewfinderViewController *)self _attemptShutterPressWithBlock:v3];
}

void __59__CAMViewfinderViewController__handleShutterButtonPressed___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 captureOnTouchDown];

  v10 = [*(a1 + 32) _captureController];
  v6 = [*(a1 + 32) _currentGraphConfiguration];
  v7 = v6;
  if (v5)
  {
    [*(a1 + 32) _handleShutterButtonActionWithEventTriggerDescription:@"Shutter button pressed"];
  }

  else
  {
    v8 = [v6 mode];
    v9 = v8 > 9 || ((1 << v8) & 0x251) == 0;
    if (!v9 && [*(a1 + 32) _shouldReportUserInitiationTimeForCurrentSettings])
    {
      [v10 prepareToCaptureStillImageAtSystemTime:a2];
    }
  }

  if (([v7 mode] | 4) == 4 && (objc_msgSend(*(a1 + 32), "isDisablingMultipleCaptureFeatures") & 1) == 0)
  {
    [*(a1 + 32) _setupBurstTimerWithDelay:0.4];
  }
}

- (void)_handleShutterButtonDragEnter:(id)enter
{
  _shutterButtonFeedbackForCurrentConfiguration = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
  _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController prepareButtonFeedback:_shutterButtonFeedbackForCurrentConfiguration];

  [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:_shutterButtonFeedbackForCurrentConfiguration];
  _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController2 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];
}

- (void)_handleShutterButtonReleased:(id)released fromDragExit:(BOOL)exit
{
  v5 = @"Shutter button released";
  if (exit)
  {
    v5 = @"Shutter button drag exit";
  }

  v6 = v5;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __73__CAMViewfinderViewController__handleShutterButtonReleased_fromDragExit___block_invoke;
  v8[3] = &unk_1E76F7960;
  v8[4] = self;
  v9 = v6;
  v7 = v6;
  [(CAMViewfinderViewController *)self _attemptShutterReleaseWithBlock:v8];
}

void __73__CAMViewfinderViewController__handleShutterButtonReleased_fromDragExit___block_invoke(uint64_t a1)
{
  v13 = *MEMORY[0x1E69E9840];
  v2 = +[CAMCaptureCapabilities capabilities];
  v3 = [v2 captureOnTouchDown];

  v4 = [*(a1 + 32) _captureController];
  v5 = *(a1 + 32);
  if (v3)
  {
    [v5 _teardownBurstTimer];
    v6 = [v4 isCapturingBurst];
    v7 = os_log_create("com.apple.camera", "Camera");
    v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
    if (v6)
    {
      if (v8)
      {
        v9 = *(a1 + 40);
        v11 = 138543362;
        v12 = v9;
        _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "%{public}@: Stop capturing burst", &v11, 0xCu);
      }

      [*(a1 + 32) _stopCapturingBurst];
    }

    else
    {
      if (v8)
      {
        v10 = *(a1 + 40);
        v11 = 138543362;
        v12 = v10;
        _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "%{public}@", &v11, 0xCu);
      }
    }
  }

  else
  {
    [v5 _handleShutterButtonActionWithEventTriggerDescription:*(a1 + 40)];
  }
}

- (void)_handleShutterButtonActionWithEventTriggerDescription:(id)description
{
  v24 = *MEMORY[0x1E69E9840];
  descriptionCopy = description;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  v8 = @"no context";
  if (mode <= 3)
  {
    if ((mode - 1) < 2)
    {
      goto LABEL_13;
    }

    if (mode)
    {
      if (mode != 3)
      {
        goto LABEL_24;
      }

      if ([_captureController isCapturingPanorama])
      {
        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        v8 = @"stop capturing panorama";
        goto LABEL_24;
      }

      _panoramaCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      captureOrientation = [_panoramaCaptureRequestWithCurrentSettings captureOrientation];
      v17 = [CAMOrientationUtilities captureOrientationFromPanoramaCaptureOrientation:captureOrientation];
      if (captureOrientation >= 5)
      {
        v18 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Unexpected:%ld", captureOrientation];
      }

      else
      {
        v18 = off_1E76F9F70[captureOrientation];
      }

      if (v17 >= 5)
      {
        v19 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Unexpected:%ld", v17];
      }

      else
      {
        v19 = off_1E76F9F70[v17];
      }

      v8 = [MEMORY[0x1E696AEC0] stringWithFormat:@"start capturing panorama (device in %@, image in %@)", v19, v18];
      [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:_panoramaCaptureRequestWithCurrentSettings];

      goto LABEL_18;
    }

LABEL_15:
    [(CAMViewfinderViewController *)self _teardownBurstTimer];
    _shouldCaptureWithTimer = [(CAMViewfinderViewController *)self _shouldCaptureWithTimer];
    _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
    isCapturingBurst = [_captureController isCapturingBurst];
    if (_isCapturingFromTimer)
    {
      [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
      v8 = @"stop timer countdown";
      goto LABEL_24;
    }

    if (isCapturingBurst)
    {
      [(CAMViewfinderViewController *)self _stopCapturingBurst];
      v8 = @"stop capturing burst";
      goto LABEL_24;
    }

    if (_shouldCaptureWithTimer)
    {
      [(CAMViewfinderViewController *)self _startCountdownForCaptureTimer];
      v8 = @"start timer countdown";
      goto LABEL_24;
    }

    [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    v8 = @"capture still image";
    goto LABEL_18;
  }

  if (mode > 9)
  {
    goto LABEL_24;
  }

  if (((1 << mode) & 0x250) != 0)
  {
    goto LABEL_15;
  }

  if (((1 << mode) & 0x180) != 0)
  {
LABEL_13:
    if ([_captureController isCapturingVideo])
    {
      [(CAMViewfinderViewController *)self _stopCapturingVideo];
      v8 = @"stop capturing video";
      goto LABEL_24;
    }

    _videoCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
    [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:_videoCaptureRequestWithCurrentSettings];

    v8 = @"start capturing video";
    goto LABEL_18;
  }

  if (mode == 5)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingTimelapse])
    {
      [(CAMViewfinderViewController *)self _stopTimelapse];
      v8 = @"stop capturing timelapse";
      goto LABEL_24;
    }

    [(CAMViewfinderViewController *)self _startTimelapse];
    v8 = @"start capturing timelapse";
LABEL_18:
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    [_motionController debugValidateCaptureOrientationForMode:{objc_msgSend(_currentGraphConfiguration, "mode")}];

    if (!v8)
    {
      goto LABEL_27;
    }
  }

LABEL_24:
  v14 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v21 = descriptionCopy;
    v22 = 2114;
    v23 = v8;
    _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }

LABEL_27:
}

- (void)_handleShutterButtonCancelled:(id)cancelled
{
  v9 = *MEMORY[0x1E69E9840];
  if (([(CAMViewfinderViewController *)self _currentMode]| 4) == 4)
  {
    [(CAMViewfinderViewController *)self _teardownBurstTimer];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    if ([_captureController isCapturingBurst])
    {
      [(CAMViewfinderViewController *)self _stopCapturingBurst];
      v5 = @"stop capturing burst";
    }

    else
    {
      v5 = @"no context";
    }
  }

  else
  {
    v5 = @"no context";
  }

  v6 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v7 = 138543362;
    v8 = v5;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Shutter button cancelled: %{public}@", &v7, 0xCu);
  }
}

- (BOOL)_stillDuringVideoButtonPressed:(id)pressed
{
  [(CAMViewfinderViewController *)self _setLastShutterButtonTouchDownTime:mach_absolute_time()];
  CAMSignpostWithIDAndArgs(13, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  isCapturingVideo = [(CUCaptureController *)self->__captureController isCapturingVideo];
  if (isCapturingVideo)
  {
    _shutterButtonFeedbackForCurrentConfiguration = [(CAMViewfinderViewController *)self _shutterButtonFeedbackForCurrentConfiguration];
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareButtonFeedback:_shutterButtonFeedbackForCurrentConfiguration];

    [(CAMViewfinderViewController *)self _setLastPerformedShutterButtonFeedbackType:_shutterButtonFeedbackForCurrentConfiguration];
    _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController2 performPressButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    v8 = +[CAMCaptureCapabilities capabilities];
    LODWORD(_feedbackController) = [v8 captureOnTouchDown];

    if (_feedbackController)
    {

      LOBYTE(isCapturingVideo) = [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }

    else
    {
      LOBYTE(isCapturingVideo) = 1;
    }
  }

  return isCapturingVideo;
}

- (BOOL)_stillDuringVideoButtonReleased:(id)released
{
  CAMSignpostWithIDAndArgs(14, 0xEEEEB0B5B2B2EEEELL, 0, 0, 0, 0);
  isCapturingVideo = [(CUCaptureController *)self->__captureController isCapturingVideo];
  if (isCapturingVideo)
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    _feedbackController2 = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController2 performReleaseButtonFeedback:{-[CAMViewfinderViewController _lastPerformedShutterButtonFeedbackType](self, "_lastPerformedShutterButtonFeedbackType")}];

    v7 = +[CAMCaptureCapabilities capabilities];
    captureOnTouchDown = [v7 captureOnTouchDown];

    if (captureOnTouchDown)
    {
      LOBYTE(isCapturingVideo) = 1;
    }

    else
    {

      LOBYTE(isCapturingVideo) = [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
    }
  }

  return isCapturingVideo;
}

- (void)_createPhysicalCaptureInteractionIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  isHalfPressOverlayInProcess = [v3 isHalfPressOverlayInProcess];

  if ((isHalfPressOverlayInProcess & 1) == 0)
  {
    _physicalButtonInteraction = [(CAMViewfinderViewController *)self _physicalButtonInteraction];
    if (_physicalButtonInteraction)
    {
    }

    else if (([(CAMViewfinderViewController *)self isViewLoaded]& 1) != 0)
    {
      objc_initWeak(&location, self);
      v6 = objc_alloc(MEMORY[0x1E69585C0]);
      v11[0] = MEMORY[0x1E69E9820];
      v11[1] = 3221225472;
      v11[2] = __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke;
      v11[3] = &unk_1E76F99E8;
      objc_copyWeak(&v12, &location);
      v9[0] = MEMORY[0x1E69E9820];
      v9[1] = 3221225472;
      v9[2] = __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke_1105;
      v9[3] = &unk_1E76F99E8;
      objc_copyWeak(&v10, &location);
      v7 = [v6 initWithPrimaryEventHandler:v11 secondaryEventHandler:v9];
      view = [(CAMViewfinderViewController *)self view];
      [view addInteraction:v7];

      [MEMORY[0x1E69585C0] setDefaultCaptureSoundDisabled:1];
      [(CAMViewfinderViewController *)self set_physicalButtonInteraction:v7];

      objc_destroyWeak(&v10);
      objc_destroyWeak(&v12);
      objc_destroyWeak(&location);
    }
  }
}

void __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = +[CAMCaptureConversions buttonPhaseForCaptureButtonPhase:](CAMCaptureConversions, "buttonPhaseForCaptureButtonPhase:", [v3 phase]);
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    if (v4 > 3)
    {
      v6 = 0;
    }

    else
    {
      v6 = off_1E76F9F98[v4];
    }

    v10 = 138543362;
    v11 = v6;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Primary button press stage: %{public}@", &v10, 0xCu);
  }

  v7 = [v3 physicalButton] - 1;
  if (v7 > 6)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A684E0[v7];
  }

  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handlePhysicalCaptureInteractionDidChangePhase:v4 forButton:v8 event:v3];
}

void __72__CAMViewfinderViewController__createPhysicalCaptureInteractionIfNeeded__block_invoke_1105(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = +[CAMCaptureConversions buttonPhaseForCaptureButtonPhase:](CAMCaptureConversions, "buttonPhaseForCaptureButtonPhase:", [v3 phase]);
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    if (v4 > 3)
    {
      v6 = 0;
    }

    else
    {
      v6 = off_1E76F9F98[v4];
    }

    v10 = 138543362;
    v11 = v6;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Secondary button press stage: %{public}@", &v10, 0xCu);
  }

  v7 = [v3 physicalButton] - 1;
  if (v7 > 6)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A684E0[v7];
  }

  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handlePhysicalCaptureInteractionDidChangePhase:v4 forButton:v8 event:v3];
}

- (void)_playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable
{
  v8 = *MEMORY[0x1E69E9840];
  _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (_currentHeadphonesCaptureEvent)
  {
    _headphoneInteractionCaptureSoundForCurrentCaptureMode = [(CAMViewfinderViewController *)self _headphoneInteractionCaptureSoundForCurrentCaptureMode];
    v5 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      v7[0] = 67240192;
      v7[1] = [(CAMViewfinderViewController *)self currentCaptureMode];
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Playing headphone interaction capture sound for current capture mode %{public}d", v7, 8u);
    }

    _currentHeadphonesCaptureEvent2 = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    [_currentHeadphonesCaptureEvent2 playSound:_headphoneInteractionCaptureSoundForCurrentCaptureMode];

    if (![(CAMViewfinderViewController *)self _remainingCaptureTimerTicks])
    {
      [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Done playing capture sound for headphone event"];
    }
  }
}

- (void)_createHeadphonesTimerSoundsIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [v3 isTimerSupportedForMode:{objc_msgSend(_currentGraphConfiguration, "mode")}];

  if (v5)
  {
    _countdownTimerTickSound = [(CAMViewfinderViewController *)self _countdownTimerTickSound];

    if (!_countdownTimerTickSound)
    {
      v7 = CAMCameraUIFrameworkBundle();
      v8 = [v7 URLForResource:@"camera_timer_countdown" withExtension:@"caf"];

      v9 = [(CAMViewfinderViewController *)self _captureEventSoundWithURL:v8];
      [(CAMViewfinderViewController *)self set_countdownTimerTickSound:v9];
    }

    _countdownTimerFinalTickSound = [(CAMViewfinderViewController *)self _countdownTimerFinalTickSound];

    if (!_countdownTimerFinalTickSound)
    {
      v11 = CAMCameraUIFrameworkBundle();
      v13 = [v11 URLForResource:@"camera_timer_final_second" withExtension:@"caf"];

      v12 = [(CAMViewfinderViewController *)self _captureEventSoundWithURL:v13];
      [(CAMViewfinderViewController *)self set_countdownTimerFinalTickSound:v12];
    }
  }
}

- (id)_captureEventSoundWithURL:(id)l
{
  v3 = MEMORY[0x1E69585C8];
  lCopy = l;
  v9 = 0;
  v5 = [[v3 alloc] initWithURL:lCopy error:&v9];

  v6 = v9;
  if (v6)
  {
    v7 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _captureEventSoundWithURL:];
    }
  }

  return v5;
}

- (id)_headphoneInteractionCaptureSoundForCurrentCaptureMode
{
  currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
  if (currentCaptureMode > 9)
  {
    _countdownTimerTickSound = 0;
  }

  else
  {
    if (((1 << currentCaptureMode) & 0x1AE) != 0)
    {
      if ([(CAMViewfinderViewController *)self isRecording])
      {
        [MEMORY[0x1E69585C8] beginVideoRecordingSound];
      }

      else
      {
        [MEMORY[0x1E69585C8] endVideoRecordingSound];
      }

      _countdownTimerTickSound = LABEL_5:;
      goto LABEL_13;
    }

    if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]< 2)
    {
      if ([(CAMViewfinderViewController *)self _remainingCaptureTimerTicks]== 1)
      {
        [(CAMViewfinderViewController *)self _countdownTimerFinalTickSound];
      }

      else
      {
        [MEMORY[0x1E69585C8] cameraShutterSound];
      }

      goto LABEL_5;
    }

    _countdownTimerTickSound = [(CAMViewfinderViewController *)self _countdownTimerTickSound];
  }

LABEL_13:

  return _countdownTimerTickSound;
}

- (void)_clearCurrentHeadphonesEventWithReason:(id)reason
{
  v11 = *MEMORY[0x1E69E9840];
  reasonCopy = reason;
  v5 = os_log_create("com.apple.camera", "PhysicalButton");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    v7 = 138543618;
    v8 = _currentHeadphonesCaptureEvent;
    v9 = 2114;
    v10 = reasonCopy;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Clearing current headphone capture event: %{public}@ for reason: %{public}@", &v7, 0x16u);
  }

  [(CAMViewfinderViewController *)self set_currentHeadphonesCaptureEvent:0];
}

- (void)_handlePhysicalCaptureInteractionDidChangePhase:(unint64_t)phase forButton:(int64_t)button event:(id)event
{
  v13 = *MEMORY[0x1E69E9840];
  eventCopy = event;
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    if (eventCopy)
    {
      v9 = [(CAMViewfinderViewController *)self _isHeadphonesButton:button];
    }

    else
    {
      v9 = 0;
    }

    switch(phase)
    {
      case 3uLL:
        [(CAMViewfinderViewController *)self _handlePhysicalButtonCancelled:button];
        break;
      case 2uLL:
        [(CAMViewfinderViewController *)self _handlePhysicalButtonReleased:button];
        break;
      case 0uLL:
        if (v9)
        {
          [(CAMViewfinderViewController *)self set_currentHeadphonesCaptureEvent:eventCopy];
          [(CAMViewfinderViewController *)self _createHeadphonesTimerSoundsIfNeeded];
          v10 = os_log_create("com.apple.camera", "PhysicalButton");
          if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
          {
            v11 = 138543362;
            v12 = eventCopy;
            _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Storing current headphone capture event: %{public}@", &v11, 0xCu);
          }
        }

        [(CAMViewfinderViewController *)self _handlePhysicalButtonPressed:button];
        break;
    }
  }
}

- (void)_createCameraCaseShutterNotifierIfNeeded
{
  _cameraCaseShutterNotifier = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];

  if (!_cameraCaseShutterNotifier)
  {
    v4 = [CAMPhysicalCaptureNotifier alloc];
    view = [(CAMViewfinderViewController *)self view];
    v6 = [(CAMPhysicalCaptureNotifier *)v4 initWithView:view includeVolumeButtons:0];
    [(CAMViewfinderViewController *)self set_cameraCaseShutterNotifier:v6];

    _cameraCaseShutterNotifier2 = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];
    [_cameraCaseShutterNotifier2 setDelegate:self];
  }
}

- (void)_updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:(BOOL)disappearing
{
  _isShowingCameraRoll = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
  _wantsVisualTextAnalysis = [(CAMViewfinderViewController *)self _wantsVisualTextAnalysis];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v9 = -[CAMViewfinderViewController _shouldDisableEventInteractionForGraphConfiguration:callActive:](self, "_shouldDisableEventInteractionForGraphConfiguration:callActive:", _currentGraphConfiguration, [_callStatusMonitor isCallActive]);

  v10 = 0;
  if (!_isShowingCameraRoll && !disappearing)
  {
    v10 = ![(CAMViewfinderViewController *)self _shouldDisableUserInteractionForTransitioning]&& !_wantsVisualTextAnalysis && !v9;
  }

  _cameraCaseShutterNotifier = [(CAMViewfinderViewController *)self _cameraCaseShutterNotifier];
  [_cameraCaseShutterNotifier setEnabled:v10];

  _physicalButtonInteraction = [(CAMViewfinderViewController *)self _physicalButtonInteraction];
  [_physicalButtonInteraction setEnabled:v10];
}

- (void)physicalCaptureNotifierDidChangeState:(id)state forButton:(int64_t)button
{
  cameraCaseButtonState = [state cameraCaseButtonState];
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    if (cameraCaseButtonState)
    {
      if (cameraCaseButtonState == 1)
      {

        [(CAMViewfinderViewController *)self _handlePhysicalButtonPressed:button];
      }
    }

    else
    {

      [(CAMViewfinderViewController *)self _handlePhysicalButtonReleased:button];
    }
  }
}

- (BOOL)_allowsPhysicalCaptureInteraction
{
  standardUserDefaults = [MEMORY[0x1E695E000] standardUserDefaults];
  v3 = [standardUserDefaults BOOLForKey:@"PLIgnoreVolumeButtons"];

  return v3 ^ 1;
}

- (void)_handlePhysicalButtonPressed:(int64_t)pressed
{
  v24 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction])
  {
    _primaryShutterControl = [(CAMViewfinderViewController *)self _primaryShutterControl];
    isEnabled = [_primaryShutterControl isEnabled];
    isTracking = [_primaryShutterControl isTracking];
    if (!isEnabled || (isTracking & 1) != 0)
    {
      goto LABEL_27;
    }

    if (pressed > 8)
    {
      v8 = 0;
    }

    else
    {
      v8 = off_1E76F9FB8[pressed];
    }

    v9 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v22 = 138543362;
      v23 = v8;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Physical capture button pressed: %{public}@", &v22, 0xCu);
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:[CAMViewfinderViewController _pressTypeForCaptureButton:pressed]];
    [_primaryShutterControl setHighlighted:1];
    v10 = [@"Physical capture button pressed: " stringByAppendingString:v8];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v10];
    _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];
    if (_currentHeadphonesCaptureEvent)
    {
      v12 = _currentHeadphonesCaptureEvent;
      currentCaptureMode = [(CAMViewfinderViewController *)self currentCaptureMode];
      if (currentCaptureMode > 8 || ((1 << currentCaptureMode) & 0x1AE) == 0)
      {

        [(CAMViewfinderViewController *)self _takePhotoForExternalClientWithCountdown:3 internalTimerOverridesCountdown:1];
        goto LABEL_26;
      }
    }

    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (!_dynamicShutterControl)
    {
      _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonPressed:_shutterButton];

LABEL_26:
LABEL_27:

      return;
    }

    v15 = +[CAMCaptureCapabilities capabilities];
    if ([v15 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}])
    {
      v16 = ![(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
    }

    else
    {
      v16 = 0;
    }

    if (![v15 isLongPressVideoCaptureFromPhotoModeSupported])
    {
      if (v16)
      {
        v18 = 2;
      }

      else
      {
        v18 = 0;
      }

      goto LABEL_25;
    }

    v18 = 0;
    if (pressed <= 8)
    {
      if (((1 << pressed) & 0x1D4) == 0)
      {
        if (pressed == 1)
        {
          if (v16)
          {
            v20 = +[CAMUserPreferences preferences];
            shouldUseVolumeUpBurst = [v20 shouldUseVolumeUpBurst];

            if (shouldUseVolumeUpBurst)
            {
              v18 = 2;
            }

            else
            {
              v18 = 1;
            }

            goto LABEL_25;
          }
        }

        else if (pressed != 5)
        {
          goto LABEL_25;
        }
      }

      v18 = 1;
    }

LABEL_25:
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl2 externalButtonPressedWithBehavior:v18];

    goto LABEL_26;
  }
}

- (void)_handlePhysicalButtonReleased:(int64_t)released
{
  v13 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction]&& [(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
  {
    if (released > 8)
    {
      v5 = 0;
    }

    else
    {
      v5 = off_1E76F9FB8[released];
    }

    v6 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 138543362;
      v12 = v5;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Physical capture button released: %{public}@", &v11, 0xCu);
    }

    _primaryShutterControl = [(CAMViewfinderViewController *)self _primaryShutterControl];
    [_primaryShutterControl setHighlighted:0];
    v8 = [@"Physical capture button released: " stringByAppendingString:v5];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v8];
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (_dynamicShutterControl)
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl2 externalButtonReleased];
    }

    else
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonReleased:_dynamicShutterControl2];
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:-1];
  }
}

- (void)_handlePhysicalButtonCancelled:(int64_t)cancelled
{
  v13 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _allowsPhysicalCaptureInteraction]&& [(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
  {
    if (cancelled > 8)
    {
      v5 = 0;
    }

    else
    {
      v5 = off_1E76F9FB8[cancelled];
    }

    v6 = os_log_create("com.apple.camera", "PhysicalButton");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 138543362;
      v12 = v5;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Physical capture button cancelled: %{public}@", &v11, 0xCu);
    }

    _primaryShutterControl = [(CAMViewfinderViewController *)self _primaryShutterControl];
    [_primaryShutterControl setHighlighted:0];
    v8 = [@"Physical capture button cancelled: " stringByAppendingString:v5];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:v8];
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (_dynamicShutterControl)
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl2 externalButtonCancelled];
    }

    else
    {
      _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _shutterButton];
      [(CAMViewfinderViewController *)self _handleShutterButtonCancelled:_dynamicShutterControl2];
    }

    [(CAMViewfinderViewController *)self _setCurrentlyPressedButton:-1];
  }
}

- (void)_updateFocusAndExposureLockBadgeAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldHideFocusAndExposureLockBadgeForGraphConfiguration:_currentGraphConfiguration];

  if (!v6)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    badgeTray = [_fullscreenViewfinder badgeTray];
    focusLockBadge = [badgeTray focusLockBadge];
    v10 = focusLockBadge;
    if (focusLockBadge)
    {
      _focusAndExposureLockBadge = focusLockBadge;
    }

    else
    {
      _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
    }

    v12 = _focusAndExposureLockBadge;

    [v12 setFocusLockType:{-[CAMViewfinderViewController _focusAndExposureLockBadgeTypeForCurrentState](self, "_focusAndExposureLockBadgeTypeForCurrentState")}];
  }

  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:animatedCopy];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setNeedsLayout];
  if (animatedCopy)
  {
    v14 = MEMORY[0x1E69DD250];
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = __72__CAMViewfinderViewController__updateFocusAndExposureLockBadgeAnimated___block_invoke;
    v15[3] = &unk_1E76F77B0;
    v16 = viewfinderView;
    [v14 animateWithDuration:2 delay:v15 options:0 animations:0.25 completion:0.0];
  }
}

- (int64_t)_focusAndExposureLockBadgeTypeForCurrentState
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder badgeTray];
  focusLockBadge = [badgeTray focusLockBadge];
  v7 = focusLockBadge;
  if (focusLockBadge)
  {
    _focusAndExposureLockBadge = focusLockBadge;
  }

  else
  {
    _focusAndExposureLockBadge = [(CAMViewfinderViewController *)self _focusAndExposureLockBadge];
  }

  v9 = _focusAndExposureLockBadge;

  focusLockType = [v9 focusLockType];
  isFocusLockedByUser = [_previewViewController isFocusLockedByUser];
  isExposureLockedByUser = [_previewViewController isExposureLockedByUser];
  if ([_previewViewController isFocusLockedOnCinematicSubject])
  {
    v13 = 3;
  }

  else
  {
    v14 = 2;
    if ((isExposureLockedByUser & isFocusLockedByUser) == 0)
    {
      v14 = 0;
    }

    v15 = isFocusLockedByUser | isExposureLockedByUser;
    if (isFocusLockedByUser)
    {
      v13 = v14;
    }

    else
    {
      v13 = 1;
    }

    if ((v15 & 1) == 0)
    {
      if ([_previewViewController isFocusLockedOnDockKitSubject])
      {
        v13 = 4;
      }

      else
      {
        v13 = focusLockType;
      }
    }
  }

  return v13;
}

- (void)_setupBurstTimerWithDelay:(double)delay
{
  objc_initWeak(&location, self);
  v5 = [CAMPreciseTimer alloc];
  v7 = MEMORY[0x1E69E9820];
  v8 = 3221225472;
  v9 = __57__CAMViewfinderViewController__setupBurstTimerWithDelay___block_invoke;
  v10 = &unk_1E76F9A10;
  objc_copyWeak(&v11, &location);
  v6 = [(CAMPreciseTimer *)v5 initWithDelay:&v7 interval:delay handler:1.79769313e308];
  [(CAMPreciseTimer *)v6 start:v7];
  [(CAMViewfinderViewController *)self _setCurrentBurstTimer:v6];

  objc_destroyWeak(&v11);
  objc_destroyWeak(&location);
}

void __57__CAMViewfinderViewController__setupBurstTimerWithDelay___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _handleBurstTimerFired:v3];
  [v3 invalidate];
}

- (void)_handleBurstTimerFired:(id)fired
{
  firedCopy = fired;
  _currentBurstTimer = [(CAMViewfinderViewController *)self _currentBurstTimer];

  if (_currentBurstTimer == firedCopy)
  {
    v6 = +[CAMCaptureCapabilities capabilities];
    captureOnTouchDown = [v6 captureOnTouchDown];

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingStillImage = [_captureController isCapturingStillImage];

    if (!isCapturingStillImage || (captureOnTouchDown & 1) == 0)
    {
      v10 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        *v12 = 0;
        _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Starting burst because no still image was being captured when burst timer fired", v12, 2u);
      }

      [(CAMViewfinderViewController *)self _beginCapturingBurst];
    }

    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController prepareDiscreteFeedback:1];
  }
}

- (void)_beginCapturingBurst
{
  v13 = *MEMORY[0x1E69E9840];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v4)
  {
    if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
    {
      _maximumBurstLengthForTimer = [(CAMViewfinderViewController *)self _maximumBurstLengthForTimer];
      v6 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        v11 = 134217984;
        v12 = _maximumBurstLengthForTimer;
        _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Starting burst capture of %ld shots for timer", &v11, 0xCu);
      }
    }

    else
    {
      v6 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        LOWORD(v11) = 0;
        _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Starting burst capture", &v11, 2u);
      }

      _maximumBurstLengthForTimer = 0;
    }

    v7 = [(CAMViewfinderViewController *)self _stillImageCaptureRequestWithCurrentSettingsAsBurst:1 maximumLength:_maximumBurstLengthForTimer];
    v8 = [(CAMViewfinderViewController *)self _generateAnalyticsCaptureEventWithRequest:v7 burst:1];
    _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
    persistenceUUID = [v7 persistenceUUID];
    [_analyticsEventsByIdentifier setObject:v8 forKey:persistenceUUID];

    [(CAMViewfinderViewController *)self _startCapturingBurstWithRequest:v7];
  }
}

- (int64_t)_maximumBurstLengthForTimer
{
  v3 = +[CAMCaptureCapabilities capabilities];
  [v3 captureIntervalForDevice:{-[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];
  if (v4 * 10.0 <= 2.0)
  {
    v5 = 10;
  }

  else
  {
    v5 = 5;
  }

  return v5;
}

- (void)_startCapturingBurstWithRequest:(id)request
{
  requestCopy = request;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v14 = 0;
  v6 = [_captureController startCapturingBurstWithRequest:requestCopy error:&v14];
  v7 = v14;
  if (v6)
  {
    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:1];
    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    captureRequest = [requestCopy captureRequest];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [_analyticsSessionEvent didCaptureWithRequest:captureRequest currentConfiguration:_currentGraphConfiguration];

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setIsCapturingBurst:1];
  }

  else
  {
    v12 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _startCapturingBurstWithRequest:];
    }

    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];

    [(CAMViewfinderViewController *)self _clearCurrentHeadphonesEventWithReason:@"Failed to start capturing a burst"];
  }

  [(CAMViewfinderViewController *)self _updateUserPreferencesForFilterUsage];
  [(CAMViewfinderViewController *)self _updateFilterScrubberAfterCapture];
}

- (void)_stopCapturingBurst
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController stopCapturingBurst];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController processPendingBursts];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:1];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsCapturingBurst:0];
}

- (void)captureControllerWillStartCapturingBurst:(id)burst
{
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v5)
  {
    [(CAMViewfinderViewController *)self _showBurstIndicatorView];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController burstCaptureWillStart];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyWillStartCapturing];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];

  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
}

- (void)captureControllerDidReachMaximumBurstLength:(id)length
{
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }
}

- (void)captureControllerDidStopCapturingBurst:(id)burst
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isBurstSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v5)
  {
    [(CAMViewfinderViewController *)self _hideBurstIndicatorView];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController burstCaptureDidStop];
  }

  [(CAMPreviewViewController *)self->__previewViewController notifyDidStopCapture];
  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];

  [(CAMViewfinderViewController *)self setNeedsUpdateOfPrefersInterfaceOrientationLocked];
}

- (void)captureControllerWillStartPlayingBurstEndSound:(id)sound
{
  [(CAMViewfinderViewController *)self _setBurstEndSoundPlaying:1];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
}

- (void)captureControllerDidStopPlayingBurstEndSound:(id)sound
{
  [(CAMViewfinderViewController *)self _setBurstEndSoundPlaying:0];
  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:0 animated:1];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:[(CAMViewfinderViewController *)self _isShowingCameraRoll]];
}

- (void)determinedBurstLength:(int64_t)length forPersistenceUUID:(id)d
{
  dCopy = d;
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  v9 = [_analyticsEventsByIdentifier objectForKeyedSubscript:dCopy];

  [v9 populateBurstLength:length];
  [v9 publish];
  _analyticsEventsByIdentifier2 = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  [_analyticsEventsByIdentifier2 setObject:0 forKeyedSubscript:dCopy];
}

- (void)_showBurstIndicatorView
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (_dynamicShutterControl)
  {
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl2 resetCounter];
  }

  else
  {
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _burstIndicatorView];
    [_dynamicShutterControl2 reset];
    [_dynamicShutterControl2 setAlpha:1.0];
    [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:0];
  }
}

- (void)_hideBurstIndicatorView
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (!_dynamicShutterControl)
  {
    _burstIndicatorView = [(CAMViewfinderViewController *)self _burstIndicatorView];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke;
    v6[3] = &unk_1E76F9A38;
    v7 = _burstIndicatorView;
    selfCopy = self;
    v5 = _burstIndicatorView;
    [v5 finishIncrementingWithCompletionHandler:v6];
  }
}

void __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke(uint64_t a1)
{
  v2 = MEMORY[0x1E69DD250];
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke_2;
  v5[3] = &unk_1E76F77B0;
  v6 = *(a1 + 32);
  [v2 animateWithDuration:327682 delay:v5 options:0 animations:0.415 completion:0.395];
  v3 = dispatch_time(0, ((0.81 - 0.25) * 1000000000.0));
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __54__CAMViewfinderViewController__hideBurstIndicatorView__block_invoke_3;
  v4[3] = &unk_1E76F77B0;
  v4[4] = *(a1 + 40);
  dispatch_after(v3, MEMORY[0x1E69E96A0], v4);
}

- (void)_performCaptureAnimationWithDuration:(double)duration
{
  v6 = [MEMORY[0x1E69793D0] functionWithName:*MEMORY[0x1E6979EA0]];
  blackColor = [MEMORY[0x1E69DC888] blackColor];
  [(CAMViewfinderViewController *)self _performCaptureAnimationWithDuration:v6 curve:blackColor color:1 fadeOut:duration];
}

- (void)_performCaptureAnimationWithDuration:(double)duration curve:(id)curve color:(id)color fadeOut:(BOOL)out
{
  outCopy = out;
  colorCopy = color;
  curveCopy = curve;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  v14 = objc_alloc(MEMORY[0x1E69DD250]);
  [previewView bounds];
  v15 = [v14 initWithFrame:?];
  [v15 setBackgroundColor:colorCopy];

  [previewView addSubview:v15];
  if (outCopy)
  {
    v16 = 0.0;
  }

  else
  {
    v16 = 1.0;
  }

  layer = [v15 layer];
  v18 = [MEMORY[0x1E6979318] animationWithKeyPath:@"opacity"];
  [v18 setFromValue:&unk_1F16C8A58];
  v19 = [MEMORY[0x1E696AD98] numberWithDouble:v16];
  [v18 setToValue:v19];

  [layer convertTime:0 fromLayer:CACurrentMediaTime()];
  [v18 setBeginTime:v20 + 0.075];
  UIAnimationDragCoefficient();
  [v18 setDuration:v21 * duration];
  [v18 setTimingFunction:curveCopy];

  [v18 setFillMode:*MEMORY[0x1E69797E0]];
  v22 = objc_alloc_init(CAMAnimationDelegate);
  v25 = MEMORY[0x1E69E9820];
  v26 = 3221225472;
  v27 = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke;
  v28 = &unk_1E76F8AA0;
  v30 = outCopy;
  v29 = v15;
  v23 = v15;
  [(CAMAnimationDelegate *)v22 setCompletion:&v25];
  [v18 setDelegate:{v22, v25, v26, v27, v28}];
  [layer addAnimation:v18 forKey:@"opacityAnimation"];
  *&v24 = v16;
  [layer setOpacity:v24];
  [(CAMViewfinderViewController *)self _setCaptureAnimationPreviewOverlay:v23];
}

void __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke(uint64_t a1)
{
  if (*(a1 + 40) == 1)
  {
    v2 = *(a1 + 32);

    [v2 removeFromSuperview];
  }

  else
  {
    v3 = MEMORY[0x1E69DD250];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke_2;
    v6[3] = &unk_1E76F77B0;
    v7 = *(a1 + 32);
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __88__CAMViewfinderViewController__performCaptureAnimationWithDuration_curve_color_fadeOut___block_invoke_3;
    v4[3] = &unk_1E76F7988;
    v5 = *(a1 + 32);
    [v3 animateWithDuration:v6 animations:v4 completion:0.25];
  }
}

- (void)_cancelCaptureAnimation
{
  _captureAnimationPreviewOverlay = [(CAMViewfinderViewController *)self _captureAnimationPreviewOverlay];
  layer = [_captureAnimationPreviewOverlay layer];

  [layer removeAllAnimations];
}

- (void)_applyAutorotationCorrectingTransformForOrientation:(int64_t)orientation
{
  view = [(CAMViewfinderViewController *)self view];
  v36 = 0u;
  v37 = 0u;
  v35 = 0u;
  v6 = [(CAMViewfinderViewController *)self view:CAMTransformCorrectingForOrientation(orientation];
  window = [v6 window];
  screen = [window screen];

  [screen _referenceBounds];
  v10 = v9;
  v12 = v11;
  v14 = v13;
  v16 = v15;
  [view bounds];
  [(CAMViewfinderViewController *)self _portraitOrientedSizeForSize:v17, v18];
  superview = [view superview];
  layer = [superview layer];

  needsLayoutOnGeometryChange = [layer needsLayoutOnGeometryChange];
  [layer setNeedsLayoutOnGeometryChange:0];
  view2 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v24 = v23;

  view3 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v27 = v26;

  view4 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v30 = v29;

  view5 = [(CAMViewfinderViewController *)self view];
  UIRoundToViewScale();
  v33 = v32;

  if (v24 == v30 && v27 == v33)
  {
    [view setBounds:{v10, v12, v14, v16}];
  }

  v34[0] = v35;
  v34[1] = v36;
  v34[2] = v37;
  [view setTransform:v34];
  [layer setNeedsLayoutOnGeometryChange:needsLayoutOnGeometryChange];
}

- (int64_t)_autorotationStyleForLayoutStyle:(int64_t)style
{
  v4 = +[CAMCaptureCapabilities capabilities];
  isSplitScreenSupported = [v4 isSplitScreenSupported];
  if ((style - 1) < 2)
  {
    v6 = 2;
  }

  else if (style != 3 && style)
  {
    v6 = 0;
  }

  else if (isSplitScreenSupported)
  {
    v6 = 2;
  }

  else
  {
    v6 = 1;
  }

  return v6;
}

- (BOOL)_isScreenExternalDisplay
{
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  screen = [window screen];
  _isEmbeddedScreen = [screen _isEmbeddedScreen];

  return _isEmbeddedScreen ^ 1;
}

- (void)_applyTransformsForAutorotationStyle:(int64_t)style
{
  view = [(CAMViewfinderViewController *)self view];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  memset(&v23, 0, sizeof(v23));
  captureOrientation = 1;
  CAMTransformCorrectingForOrientation(1, &v23);
  memset(&v22, 0, sizeof(v22));
  [(CAMViewfinderViewController *)self customPreviewViewTransform];
  switch(style)
  {
    case 2:
      v21 = v23;
      [view setTransform:&v21];
      view2 = [(CAMViewfinderViewController *)self view];
      window = [view2 window];
      captureOrientation = CAMInterfaceOrientationForWindow(window);

      [viewfinderView setPreviewViewOrientation:captureOrientation];
      if ([(CAMViewfinderViewController *)self _isScreenExternalDisplay])
      {
        _motionController = [(CAMViewfinderViewController *)self _motionController];
        captureOrientation = [_motionController captureOrientation];
      }

      memset(&v21, 0, sizeof(v21));
      [viewfinderView setExternalDisplayPreviewOrientation:{captureOrientation, CAMTransformCorrectingForOrientation(captureOrientation, &v21)}];
      t2 = v22;
      memset(&t1, 0, sizeof(t1));
      v18 = v21;
      CGAffineTransformConcat(&t1, &t2, &v18);
      t2 = t1;
      [previewView setTransform:&t2];
      _textInteractionBackground = [(CAMViewfinderViewController *)self _textInteractionBackground];
      t2 = t1;
      [_textInteractionBackground setTransform:&t2];
      [viewfinderView prepareForAutorotation];

      break;
    case 1:
      captureOrientation = 1;
      [viewfinderView setPreviewViewOrientation:1];
      view3 = [(CAMViewfinderViewController *)self view];
      window2 = [view3 window];
      v12 = CAMInterfaceOrientationForWindow(window2);

      [(CAMViewfinderViewController *)self _applyAutorotationCorrectingTransformForOrientation:v12];
      goto LABEL_6;
    case 0:
      v21 = v23;
      [view setTransform:&v21];
      captureOrientation = 1;
      [viewfinderView setPreviewViewOrientation:1];
LABEL_6:
      t1 = v22;
      memset(&v21, 0, sizeof(v21));
      t2 = v23;
      CGAffineTransformConcat(&v21, &t1, &t2);
      t1 = v21;
      [previewView setTransform:&t1];
      break;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setPreviewViewOrientation:captureOrientation];
}

- (void)setAutorotationStyle:(int64_t)style
{
  [(CAMViewfinderViewController *)self _setInternalAutorotationStyle:style];

  [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
}

- (BOOL)_shouldUpdateCaptureOrientation
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  return isCapturingVideo ^ 1;
}

- (void)_captureOrientationChanged:(id)changed
{
  v4 = +[CAMApplication appOrPlugInState];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:v4 == 0];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:_currentGraphConfiguration];

    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 shouldAdjustZoomOnOrientationChangeForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    if (v6 && v8)
    {
      v9 = +[CAMCaptureCapabilities capabilities];
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      mode = [_currentGraphConfiguration2 mode];
      _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      LODWORD(mode) = [v9 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration3, "devicePosition")}];

      if (mode)
      {
        _motionController = [(CAMViewfinderViewController *)self _motionController];
        -[CAMViewfinderViewController _updateSmartFramingForCaptureOrientation:rampDuration:zoomRampTuning:animated:](self, "_updateSmartFramingForCaptureOrientation:rampDuration:zoomRampTuning:animated:", [_motionController captureOrientation], 0, v4 == 0, 0.5);
      }

      else
      {
        _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        _motionController2 = [(CAMViewfinderViewController *)self _motionController];
        -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", _currentGraphConfiguration4, [_motionController2 captureOrientation]);
        v19 = v18;

        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        if (v20 != v19)
        {
          [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:v4 == 0 zoomRampTuning:v19 shouldAnimate:0.5];
        }
      }

      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }

    [(CAMViewfinderViewController *)self _resetDynamicAspectRatio];
  }

  else
  {
    _motionController3 = [(CAMViewfinderViewController *)self _motionController];
    captureOrientation = [_motionController3 captureOrientation];
    if (captureOrientation)
    {
      [_captureController changeToVideoRecordingCaptureOrientation:captureOrientation];
    }
  }

  [(CAMViewfinderViewController *)self _updateHomeIndicatorBehaviorsForCaptureOrientation];
}

- (void)_deviceOrientationChanged:(id)changed
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  [_fullscreenViewfinder setDeviceOrientation:objc_msgSend(_motionController animated:{"deviceOrientation"), 1}];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)_updateUIForCaptureOrientationAnimated:(BOOL)animated
{
  animatedCopy = animated;
  autorotationStyle = [(CAMViewfinderViewController *)self autorotationStyle];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  if ([(CAMViewfinderViewController *)self _isScreenExternalDisplay])
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke;
    aBlock[3] = &unk_1E76F97F0;
    aBlock[4] = self;
    v37 = autorotationStyle;
    v9 = viewfinderView;
    v36 = v9;
    v10 = _Block_copy(aBlock);
    v11 = v10;
    if (animatedCopy)
    {
      v12 = MEMORY[0x1E69DD250];
      v32[0] = MEMORY[0x1E69E9820];
      v32[1] = 3221225472;
      v32[2] = __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke_2;
      v32[3] = &unk_1E76F83B0;
      v34 = v10;
      v33 = v9;
      [v12 animateWithDuration:v32 animations:0.3];
    }

    else
    {
      v10[2](v10);
    }
  }

  if (autorotationStyle == 1)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v14 = [(CAMViewfinderViewController *)self _shouldRotateTopBarForGraphConfiguration:_currentGraphConfiguration];

    [viewfinderView setAutomaticallyAdjustsTopBarOrientation:v14];
    v15 = captureOrientation;
  }

  else
  {
    v15 = 1;
  }

  [(CAMViewfinderViewController *)self _rotateTopBarAndControlsToOrientation:v15 shouldAnimate:animatedCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setOrientation:v15 animated:animatedCopy];

  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  [_imageWell setCameraOrientation:v15 animated:animatedCopy];

  _burstIndicatorView = [(CAMViewfinderViewController *)self _burstIndicatorView];
  [CAMView rotateView:_burstIndicatorView toInterfaceOrientation:v15 animated:animatedCopy];

  _timerIndicatorView = [(CAMViewfinderViewController *)self _timerIndicatorView];
  [_timerIndicatorView setOrientation:v15 animated:animatedCopy];

  [viewfinderView setOrientation:v15 animated:animatedCopy];
  _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
  [_zoomSlider setOrientation:v15 animated:animatedCopy];

  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  _zoomControl2 = _zoomControl;
  if (_layoutStyle == 1)
  {
    isTracking = [_zoomControl isTracking];

    if (isTracking)
    {
      goto LABEL_14;
    }

    _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl2 setShouldShowZoomDial:0 animationDuration:0];
  }

  else
  {
    [_zoomControl setOrientation:v15 animated:animatedCopy];
  }

LABEL_14:
  if (dyld_program_sdk_at_least())
  {
    _flipButton = [(CAMViewfinderViewController *)self _flipButton];
    [_flipButton setOrientation:v15 animated:animatedCopy];
  }

  _lightingControl = [(CAMViewfinderViewController *)self _lightingControl];
  [_lightingControl setOrientation:captureOrientation];

  _targetElapsedTimeView = [(CAMViewfinderViewController *)self _targetElapsedTimeView];
  [_targetElapsedTimeView setBackgroundStyle:-[CAMViewfinderViewController _elapsedTimeViewIdleBackgroundStyle](self animated:{"_elapsedTimeViewIdleBackgroundStyle"), animatedCopy}];
  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder2 setSpatialCaptureRecordingIndicatorVisible:0 animated:animatedCopy];

  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  [_panoramaViewController didChangeToCaptureOrientation:captureOrientation];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl setOrientation:v15 animated:animatedCopy];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setControlOrientation:v15];
}

uint64_t __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _applyTransformsForAutorotationStyle:*(a1 + 48)];
  v2 = *(a1 + 40);

  return [v2 setNeedsLayout];
}

uint64_t __70__CAMViewfinderViewController__updateUIForCaptureOrientationAnimated___block_invoke_2(uint64_t a1)
{
  (*(*(a1 + 40) + 16))();
  v2 = *(a1 + 32);

  return [v2 layoutIfNeeded];
}

- (void)_updateTopBarStyleForGraphConfiguration:(id)configuration capturing:(BOOL)capturing animated:(BOOL)animated
{
  animatedCopy = animated;
  v7 = [(CAMViewfinderViewController *)self _topBarStyleForGraphConfiguration:configuration capturing:capturing];
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  [_topBar setStyle:v7 animated:animatedCopy];
}

- (void)_rotateTopBarAndControlsToOrientation:(int64_t)orientation shouldAnimate:(BOOL)animate
{
  animateCopy = animate;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateTopBarStyleForGraphConfiguration:_currentGraphConfiguration capturing:isCapturingVideo animated:animateCopy];
  v9 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:_currentGraphConfiguration];
  _topBar = [(CAMViewfinderViewController *)self _topBar];

  if (_topBar)
  {
    _topBar2 = [(CAMViewfinderViewController *)self _topBar];
    [_topBar2 setOrientation:orientation];
  }

  else
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animateCopy];
  }

  if (v9)
  {
    orientation = 1;
  }

  _flashButton = [(CAMViewfinderViewController *)self _flashButton];
  [_flashButton setOrientation:orientation animated:animateCopy];

  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  [_HDRButton setOrientation:orientation animated:animateCopy];

  _livePhotoButton = [(CAMViewfinderViewController *)self _livePhotoButton];
  [_livePhotoButton setOrientation:orientation animated:animateCopy];

  _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
  [_sharedLibraryButton setOrientation:orientation animated:animateCopy];

  _timerButton = [(CAMViewfinderViewController *)self _timerButton];
  [_timerButton setOrientation:orientation animated:animateCopy];

  _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
  [_apertureButton setOrientation:orientation animated:animateCopy];

  _videoConfigurationStatusIndicator = [(CAMViewfinderViewController *)self _videoConfigurationStatusIndicator];
  [CAMView rotateView:_videoConfigurationStatusIndicator toInterfaceOrientation:orientation animated:animateCopy];

  _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
  [_intensityButton setOrientation:orientation animated:animateCopy];

  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    _flipButton = [(CAMViewfinderViewController *)self _flipButton];
    [_flipButton setOrientation:orientation animated:animateCopy];
  }
}

- (BOOL)_shouldRotateTopBarForGraphConfiguration:(id)configuration
{
  mode = [configuration mode];
  v5 = (mode < 9) & (0x186u >> mode);
  if ([(CAMViewfinderViewController *)self autorotationStyle]== 1)
  {
    return v5;
  }

  else
  {
    return 0;
  }
}

- (BOOL)_shouldApplyTopBarRotationForGraphConfiguration:(id)configuration
{
  v4 = [(CAMViewfinderViewController *)self _shouldRotateTopBarForGraphConfiguration:configuration];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  if (([_motionController captureOrientation] - 3) >= 2)
  {
    v4 = 0;
  }

  return v4;
}

- (void)_prepareTopBarForOrientationChangeDuringConfiguration
{
  _topBar = [(CAMViewfinderViewController *)self _topBar];
  v4 = [_topBar snapshotViewAfterScreenUpdates:0];
  [_topBar bounds];
  [v4 setBounds:?];
  [_topBar center];
  [v4 setCenter:?];
  if (_topBar)
  {
    [_topBar transform];
  }

  else
  {
    memset(v15, 0, sizeof(v15));
  }

  [v4 setTransform:v15];
  superview = [_topBar superview];
  [superview addSubview:v4];

  [_topBar setAlpha:0.0];
  v6 = MEMORY[0x1E69DD250];
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __84__CAMViewfinderViewController__prepareTopBarForOrientationChangeDuringConfiguration__block_invoke;
  v13[3] = &unk_1E76F77B0;
  v14 = v4;
  v8 = MEMORY[0x1E69E9820];
  v9 = 3221225472;
  v10 = __84__CAMViewfinderViewController__prepareTopBarForOrientationChangeDuringConfiguration__block_invoke_2;
  v11 = &unk_1E76F7988;
  v12 = v14;
  v7 = v14;
  [v6 animateWithDuration:327682 delay:v13 options:&v8 animations:0.3 completion:0.0];
  [(CAMViewfinderViewController *)self _setPerformingTopBarOrientationChange:1, v8, v9, v10, v11];
}

- (void)handleImageWellReleased
{
  [(CAMViewfinderViewController *)self _presentCameraRollViewControllerIfPossibleAnimated:1 interactive:0];

  [(CAMViewfinderViewController *)self stopMonitoringForAccidentalLaunchIfNeeded];
}

- (void)_presentCameraRollViewControllerIfPossibleAnimated:(BOOL)animated interactive:(BOOL)interactive
{
  interactiveCopy = interactive;
  animatedCopy = animated;
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  if ([_cameraRollController canPresentCameraRollViewController])
  {
    if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled]&& +[CAMFrameworkUtilities isPasscodeLocked])
    {
      objc_initWeak(&location, self);
      v8[0] = MEMORY[0x1E69E9820];
      v8[1] = 3221225472;
      v8[2] = __94__CAMViewfinderViewController__presentCameraRollViewControllerIfPossibleAnimated_interactive___block_invoke;
      v8[3] = &unk_1E76F9A60;
      objc_copyWeak(&v9, &location);
      v10 = animatedCopy;
      v11 = interactiveCopy;
      [(CAMViewfinderViewController *)self _requestPasscodeUnlockForCameraRollController:_cameraRollController forAction:0 completionBlock:v8];
      objc_destroyWeak(&v9);
      objc_destroyWeak(&location);
    }

    else
    {
      [(CAMViewfinderViewController *)self _presentCameraRollViewControllerAnimated:animatedCopy interactive:interactiveCopy];
    }
  }
}

void __94__CAMViewfinderViewController__presentCameraRollViewControllerIfPossibleAnimated_interactive___block_invoke(uint64_t a1, int a2)
{
  if (a2)
  {
    WeakRetained = objc_loadWeakRetained((a1 + 32));
    v4 = [WeakRetained _connectedStorage];

    if (v4)
    {
      v5 = objc_loadWeakRetained((a1 + 32));
      [v5 _presentCameraRollViewControllerAnimated:*(a1 + 40) interactive:*(a1 + 41)];
    }
  }
}

- (void)_presentCameraRollViewControllerAnimated:(BOOL)animated interactive:(BOOL)interactive
{
  animatedCopy = animated;
  interactiveCopy = interactive;
  v33 = *MEMORY[0x1E69E9840];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  [_motionController setForceLandscapeOrientation:0];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v7 = [(CAMViewfinderViewController *)self _shouldDeferMediaLoadingForGraphConfiguration:_currentGraphConfiguration];
  v29[0] = 0;
  v29[1] = v29;
  v29[2] = 0x2020000000;
  v30 = 0;
  v27[0] = 0;
  v27[1] = v27;
  v27[2] = 0x2020000000;
  v28 = 0;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __84__CAMViewfinderViewController__presentCameraRollViewControllerAnimated_interactive___block_invoke;
  aBlock[3] = &unk_1E76F9A88;
  aBlock[4] = v27;
  aBlock[5] = v29;
  v8 = _Block_copy(aBlock);
  supportedInterfaceOrientations = [(CAMViewfinderViewController *)self supportedInterfaceOrientations];
  _motionController2 = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController2 captureOrientation];

  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  _windowOwnsInterfaceOrientation = [window _windowOwnsInterfaceOrientation];

  v15 = (captureOrientation - 3) < 0xFFFFFFFFFFFFFFFELL && supportedInterfaceOrientations == 2;
  if ((v15 & _windowOwnsInterfaceOrientation) == 1)
  {
    v16 = v8[2](v8) ^ 1;
  }

  else
  {
    v16 = 0;
  }

  currentDevice = [MEMORY[0x1E69DC938] currentDevice];
  orientation = [currentDevice orientation];
  if (supportedInterfaceOrientations == 2 && orientation == 1 && captureOrientation != 1 && (v8[2](v8) & 1) == 0)
  {
    v19 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      if (captureOrientation == 3)
      {
        v20 = @"UIInterfaceOrientationLandscapeRight";
      }

      else if (captureOrientation == 4)
      {
        v20 = @"UIInterfaceOrientationLandscapeLeft";
      }

      else
      {
        v20 = @"UIInterfaceOrientationPortraitUpsideDown";
        if (captureOrientation != 2)
        {
          v20 = 0;
        }
      }

      *buf = 138543362;
      v32 = v20;
      _os_log_impl(&dword_1A3640000, v19, OS_LOG_TYPE_DEFAULT, "UIDevice has Portrait orientation, but capture orientation is %{public}@. Applying capture orientation to the device.", buf, 0xCu);
    }

    [currentDevice setOrientation:captureOrientation];
  }

  if (v16)
  {
    [*MEMORY[0x1E69DDA98] _setStatusBarOrientation:captureOrientation];
  }

  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController presentCameraRollViewControllerAnimated:animatedCopy interactive:interactiveCopy deferringStagedMediaLoading:v7];
  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  [(CAMViewfinderViewController *)self _pausePairedVideoCaptureOnControllerIfNecessaryForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:1];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didPresentCameraRoll];

  cameraRollControllerTestDelegate = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [cameraRollControllerTestDelegate viewfinderViewController:self didPresentCameraRoll:_cameraRollController];

  _Block_object_dispose(v27, 8);
  _Block_object_dispose(v29, 8);
}

uint64_t __84__CAMViewfinderViewController__presentCameraRollViewControllerAnimated_interactive___block_invoke(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 8);
  if (*(v2 + 24) == 1)
  {
    v3 = a1 + 40;
  }

  else
  {
    *(v2 + 24) = 1;
    v4 = CAMIsDeviceOrientationLocked();
    v5 = *(a1 + 40);
    v3 = a1 + 40;
    *(*(v5 + 8) + 24) = v4;
  }

  return *(*(*v3 + 8) + 24);
}

- (void)presentCameraRollViewControllerAnimated:(BOOL)animated withAction:(unint64_t)action selectedAssetIndexFromEnd:(unint64_t)end
{
  [(CAMViewfinderViewController *)self _presentCameraRollViewControllerAnimated:animated interactive:1];
  objc_initWeak(&location, self);
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __108__CAMViewfinderViewController_presentCameraRollViewControllerAnimated_withAction_selectedAssetIndexFromEnd___block_invoke;
  v8[3] = &unk_1E76F9AB0;
  objc_copyWeak(v9, &location);
  v9[1] = end;
  v9[2] = action;
  [(CAMViewfinderViewController *)self set_cameraRollControllerAction:v8];
  objc_destroyWeak(v9);
  objc_destroyWeak(&location);
}

void __108__CAMViewfinderViewController_presentCameraRollViewControllerAnimated_withAction_selectedAssetIndexFromEnd___block_invoke(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained((a1 + 32));

  if (WeakRetained)
  {
    v3 = objc_loadWeakRetained((a1 + 32));
    v4 = [v3 _cameraRollController];

    if (*(a1 + 40))
    {
      [v4 setCurrentAssetIndexFromEnd:?];
    }

    if (*(a1 + 48))
    {
      v5 = os_log_create("com.apple.camera", "CameraRoll");
      if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
      {
        v6 = *(a1 + 48);
        v10 = 134217984;
        v11 = v6;
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "CameraRoll: executing oneup action: %ld", &v10, 0xCu);
      }

      v7 = *(a1 + 48);
      v8 = [v4 oneUpViewController];
      [CAMViewfinderLockScreenExtensionHelper executeUnlockOneUpAction:v7 on:v8];
    }

    v9 = objc_loadWeakRetained((a1 + 32));
    [v9 set_cameraRollControllerAction:0];
  }
}

- (void)cameraRollController:(id)controller didChangeImageWellImage:(id)image withUUID:(id)d animated:(BOOL)animated
{
  animatedCopy = animated;
  imageCopy = image;
  dCopy = d;
  if (![(CAMViewfinderViewController *)self _externalStorageOutputEnabled]|| ![(CAMViewfinderViewController *)self isRecording])
  {
    [(CAMViewfinderViewController *)self _presentImageWellImage:imageCopy uuid:dCopy animated:animatedCopy];
  }
}

- (void)_presentInitialImageWellImageForSession
{
  v3 = objc_alloc(MEMORY[0x1E696AEC0]);
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  v5 = [v3 initWithFormat:@"CAMPersistedThumbnailImage-session(%d)", objc_msgSend(_cameraRollController, "sessionIdentifier")];

  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  thumbnailImageUUID = [_imageWell thumbnailImageUUID];
  v8 = [thumbnailImageUUID isEqualToString:v5];

  if ((v8 & 1) == 0)
  {
    [(CAMViewfinderViewController *)self _presentImageWellImage:0 uuid:0 animated:0];
    v9 = dispatch_get_global_queue(21, 0);
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke;
    block[3] = &unk_1E76F7960;
    block[4] = self;
    block[5] = v5;
    dispatch_async(v9, block);
  }
}

void __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _cameraRollController];
  v3 = [v2 persistedThumbnailImage];

  if (v3)
  {
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __70__CAMViewfinderViewController__presentInitialImageWellImageForSession__block_invoke_2;
    block[3] = &unk_1E76F7938;
    block[4] = *(a1 + 32);
    v4 = v3;
    v5 = *(a1 + 40);
    v7 = v4;
    v8 = v5;
    dispatch_async(MEMORY[0x1E69E96A0], block);
  }
}

- (void)changeToMode:(int64_t)mode
{
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];
  }

  v5 = +[CAMUserPreferences preferences];
  v6 = [v5 defaultDeviceForModeChange:mode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self changeToMode:mode device:v6 animated:1];
}

- (BOOL)_shouldResetZoomForChangeFromMode:(int64_t)mode toMode:(int64_t)toMode
{
  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  if (mode == 4 && !toMode)
  {
    return 0;
  }

  if (mode)
  {
    v8 = 0;
  }

  else
  {
    v8 = toMode == 4;
  }

  v9 = !v8;
  return v9 & !_trueVideoIsActive;
}

- (id)_graphConfigurationForChangeToMode:(int64_t)mode device:(int64_t)device fromGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 sanitizeDesiredDevice:device forMode:mode];
  emulationMode = [(CAMViewfinderViewController *)self emulationMode];
  if ((v9 - 1) > 0xA)
  {
    v10 = 0;
  }

  else
  {
    v10 = qword_1A3A685B0[v9 - 1];
  }

  v11 = +[CAMUserPreferences preferences];
  photoEncodingBehavior = [v11 photoEncodingBehavior];
  if ([(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:mode devicePosition:v10])
  {
    shouldEnableFrontRearSimultaneousVideo = [v11 shouldEnableFrontRearSimultaneousVideo];
  }

  else
  {
    shouldEnableFrontRearSimultaneousVideo = 0;
  }

  v89 = [(CAMViewfinderViewController *)self _sanitizedVideoConfigurationForMode:mode device:v9 allowOverrides:1];
  v85 = v8;
  if ([(CAMViewfinderViewController *)self _trueVideoIsCapturing])
  {
    [v8 isProResVideoSupportedForMode:mode frontRearSimultaneousVideoEnabled:shouldEnableFrontRearSimultaneousVideo];
    _desiredProResVideoMode = 0;
    _trueVideoIsTransitioningToCapture = 1;
  }

  else
  {
    _trueVideoIsTransitioningToCapture = [(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture];
    v15 = [v8 isProResVideoSupportedForMode:mode frontRearSimultaneousVideoEnabled:shouldEnableFrontRearSimultaneousVideo];
    _desiredProResVideoMode = 0;
    if (!_trueVideoIsTransitioningToCapture && v15)
    {
      _desiredProResVideoMode = [(CAMViewfinderViewController *)self _desiredProResVideoMode];
      _trueVideoIsTransitioningToCapture = 0;
    }
  }

  v86 = _trueVideoIsTransitioningToCapture;
  v16 = [(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabledForMode:mode videoConfiguration:v89 desiredProResVideoMode:_desiredProResVideoMode];
  v17 = [v11 videoEncodingBehaviorForConfiguration:v89 mode:mode desiredProResVideoMode:_desiredProResVideoMode outputToExternalStorage:v16 frontRearSimultaneousVideoEnabled:shouldEnableFrontRearSimultaneousVideo];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  isCallActive = [_callStatusMonitor isCallActive];

  v83 = [v11 audioConfigurationForMode:mode device:v9 emulationMode:emulationMode duringCall:isCallActive];
  if ([(CAMViewfinderViewController *)self _wantsFilterScrubberVisible])
  {
    v20 = [configurationCopy mode] == mode;
  }

  else
  {
    v20 = 0;
  }

  v78 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:mode devicePosition:v10 videoThumbnailOutputEnabled:v20];
  v21 = +[CAMCaptureCapabilities capabilities];
  portraitInPhotoModeBehavior = [v21 portraitInPhotoModeBehavior];

  v23 = (portraitInPhotoModeBehavior & 1) != 0 && [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v77 = [(CAMViewfinderViewController *)self _previewFiltersForMode:mode device:v9 wantsPhotoModePortraitEffect:v23];
  v76 = [v11 videoThumbnailOutputConfigurationForMode:mode devicePosition:v10];
  v90 = 0;
  v91 = 0;
  [(CAMViewfinderViewController *)self _resolvePotentiallyConflictingControlsForMode:mode device:v9 resolvedFlashMode:0 resolvedHDRMode:&v91 resolvedLivePhotoMode:0 resolvedRAWMode:&v90 resolvedPhotoResolution:0];
  v75 = [v11 isAutoFPSVideoEnabledForMode:mode device:v9 videoConfiguration:v89 encodingBehavior:v17 outputToExternalStorage:v16 frontRearSimultaneousVideoEnabled:shouldEnableFrontRearSimultaneousVideo];
  v24 = +[CAMCaptureCapabilities capabilities];
  v74 = [v24 shouldSuspendVideoHDRForHDRMode:v91 captureMode:mode];

  v73 = [(CAMViewfinderViewController *)self _aspectRatioCropForMode:mode devicePosition:v10];
  v72 = [v85 maxSupportedPhotoQualityPrioritizationForMode:mode devicePosition:v10];
  v71 = [v11 mirrorCameraCapturesForDevicePosition:v10 mode:mode];
  if ([v11 rawControlEnabled])
  {
    v69 = [v85 isLinearDNGSupportedForMode:mode];
  }

  else
  {
    v69 = 0;
  }

  v68 = [v85 semanticStyleSupportForMode:mode devicePosition:v10];
  v70 = [(CAMViewfinderViewController *)self _semanticStyleForPreviewWithSupport:?];
  if ([v11 shouldUseContentAwareDistortionCorrection])
  {
    v67 = [v85 isContentAwareDistortionCorrectionSupportedForMode:mode];
  }

  else
  {
    v67 = 0;
  }

  v88 = shouldEnableFrontRearSimultaneousVideo;
  if ([v11 responsiveShutterEnabled])
  {
    v65 = [v85 isResponsiveShutterSupportedForMode:mode];
  }

  else
  {
    v65 = 0;
  }

  v66 = v10;
  v25 = +[CAMUserPreferences preferences];
  v26 = +[CAMCaptureCapabilities capabilities];
  v27 = [v25 prefersHDR10BitVideoForCapabilities:v26];

  LOBYTE(v47) = shouldEnableFrontRearSimultaneousVideo;
  v82 = v27;
  v84 = v17;
  if ([v85 isEnhancedStabilizationSupportedForMode:mode device:v9 videoConfiguration:v89 videoEncodingBehavior:v17 trueVideoEnabled:v86 prefersHDR10BitVideo:v27 frontRearSimultaneousVideoEnabled:v47])
  {
    _desiredVideoStabilizationMode = [(CAMViewfinderViewController *)self _desiredVideoStabilizationMode];
  }

  else
  {
    _desiredVideoStabilizationMode = 0;
  }

  v29 = [v11 videoStabilizationStrengthForVideoStabilizationMode:_desiredVideoStabilizationMode captureMode:mode];
  BYTE2(v48) = shouldEnableFrontRearSimultaneousVideo;
  BYTE1(v48) = v27;
  LOBYTE(v48) = v86;
  if ([v85 isVideoStabilizationStrength:v29 supportedForMode:mode device:v9 videoConfiguration:v89 videoEncodingBehavior:v17 outputToExternalStorage:v16 trueVideoEnabled:v48 prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:?])
  {
    v30 = v29;
  }

  else
  {
    v30 = 0;
  }

  v81 = v30;
  v64 = [v11 maximumPhotoResolutionForMode:mode device:v9];
  v60 = v90;
  v63 = [(CAMViewfinderViewController *)self _resolvedColorSpaceForMode:mode videoConfiguration:v89 videoEncodingBehavior:v17 device:v9];
  v62 = [v85 useVideoBinnedForMode:mode videoConfiguration:v89 devicePosition:v66];
  shouldUseDepthSuggestionInPhotoMode = [v11 shouldUseDepthSuggestionInPhotoMode];
  v31 = +[CAMUserPreferences preferences];
  if ([v31 isZoomPIPEnabled])
  {
    v32 = +[CAMCaptureCapabilities capabilities];
    v58 = [v32 isZoomPIPSupportedForMode:mode devicePosition:v66 frontRearSimultaneousVideoEnabled:shouldEnableFrontRearSimultaneousVideo];
  }

  else
  {
    v58 = 0;
  }

  if ([v85 isCustomLensSupportedForMode:mode device:v9 isTrueVideo:v86])
  {
    customLensGroup = [v11 customLensGroup];
  }

  else
  {
    customLensGroup = 0;
  }

  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v35 = v34;
  _desiredMacroMode = [(CAMViewfinderViewController *)self _desiredMacroMode];
  BYTE1(v50) = shouldEnableFrontRearSimultaneousVideo;
  LOBYTE(v50) = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v57 = [CAMConflictingControlConfiguration resolveDesiredMacroMode:_desiredMacroMode forMode:mode device:v9 videoConfiguration:v89 videoStabilizationStrength:v81 photoFormat:currentPhotoFormat optionalDepthEffectEnabled:v35 frontRearSimultaneousVideoEnabled:v50];
  v56 = [v11 windRemovalEnabledForAudioConfiguration:v83];
  v37 = +[CAMCaptureCapabilities capabilities];
  LODWORD(_desiredMacroMode) = [v37 isDynamicAspectRatioSupportedForMode:mode videoConfiguration:v89 devicePosition:v66];

  if (_desiredMacroMode)
  {
    v38 = v86;
    if ([(CAMViewfinderViewController *)self _resolvedFlipAspectRatioForMode:mode videoConfiguration:v89 devicePosition:v66 trueVideoEnabled:v86])
    {
      v39 = 1;
    }

    else
    {
      v39 = 2;
    }
  }

  else
  {
    v39 = 0;
    v38 = v86;
  }

  if (v60 == 1)
  {
    v40 = v69;
  }

  else
  {
    v40 = 0;
  }

  v41 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:mode devicePosition:v66];
  v42 = [CAMCaptureGraphConfiguration alloc];
  shouldMixAudioWithOthers = [v11 shouldMixAudioWithOthers];
  _smartStyles = [(CAMViewfinderViewController *)self _smartStyles];
  BYTE2(v55) = v88;
  BYTE1(v55) = v82;
  LOBYTE(v55) = v38;
  BYTE2(v54) = v58;
  BYTE1(v54) = shouldUseDepthSuggestionInPhotoMode;
  LOBYTE(v54) = v62;
  BYTE2(v53) = v40;
  BYTE1(v53) = v65;
  LOBYTE(v53) = v67;
  BYTE1(v52) = v69;
  LOBYTE(v52) = v71;
  BYTE1(v51) = v74;
  LOBYTE(v51) = v75;
  LOBYTE(v49) = v56;
  v45 = [CAMCaptureGraphConfiguration initWithCaptureMode:v42 captureDevice:"initWithCaptureMode:captureDevice:macroMode:videoConfiguration:audioConfiguration:mixAudioWithOthers:windNoiseRemovalEnabled:previewConfiguration:previewSampleBufferVideoFormat:previewFilters:videoThumbnailOutputConfiguration:photoEncodingBehavior:videoEncodingBehavior:enableAutoFPSVideo:videoHDRSuspended:aspectRatioCrop:photoQualityPrioritization:captureMirrored:enableRAWCaptureIfSupported:semanticStyleSupport:previewSemanticStyle:smartStyles:enableContentAwareDistortionCorrection:enableResponsiveShutter:suspendLivePhotoCapture:videoStabilizationStrength:maximumPhotoResolution:colorSpace:videoBinned:enableDepthSuggestion:enableZoomPIP:customLensGroup:trueVideoEnabled:prefersHDR10BitVideo:frontRearSimultaneousVideoEnabled:videoDynamicAspectRatio:smartFramingFieldOfView:" macroMode:mode videoConfiguration:v9 audioConfiguration:v57 mixAudioWithOthers:v89 windNoiseRemovalEnabled:v83 previewConfiguration:shouldMixAudioWithOthers previewSampleBufferVideoFormat:v49 previewFilters:v78 videoThumbnailOutputConfiguration:0 photoEncodingBehavior:v77 videoEncodingBehavior:v76 enableAutoFPSVideo:photoEncodingBehavior videoHDRSuspended:v84 aspectRatioCrop:v51 photoQualityPrioritization:v73 captureMirrored:v72 enableRAWCaptureIfSupported:v52 semanticStyleSupport:v68 previewSemanticStyle:v70 smartStyles:_smartStyles enableContentAwareDistortionCorrection:v53 enableResponsiveShutter:v81 suspendLivePhotoCapture:v64 videoStabilizationStrength:v63 maximumPhotoResolution:v54 colorSpace:customLensGroup videoBinned:v55 enableDepthSuggestion:v39 enableZoomPIP:v41 customLensGroup:? trueVideoEnabled:? prefersHDR10BitVideo:? frontRearSimultaneousVideoEnabled:? videoDynamicAspectRatio:? smartFramingFieldOfView:?];

  return v45;
}

- (int64_t)_sanitizedVideoConfigurationForMode:(int64_t)mode device:(int64_t)device allowOverrides:(BOOL)overrides
{
  overridesCopy = overrides;
  if (![(CAMViewfinderViewController *)self emulationMode])
  {
    v10 = +[CAMUserPreferences preferences];
    _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
    _isFrontRearSimultaneousVideoEnabled = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
    v13 = 0;
    if (mode > 6)
    {
      if (mode == 7)
      {
        if (overridesCopy && [(CAMViewfinderViewController *)self _cinematicConfigurationOverride])
        {
          _cinematicConfigurationOverride = [(CAMViewfinderViewController *)self _cinematicConfigurationOverride];
        }

        else
        {
          _cinematicConfigurationOverride = [v10 cinematicConfiguration];
        }

        v15 = _cinematicConfigurationOverride;
        v16 = 7;
      }

      else
      {
        if (mode != 8)
        {
LABEL_30:

          return v13;
        }

        v15 = 7;
        v16 = 8;
      }
    }

    else
    {
      if (mode != 1)
      {
        if (mode == 2)
        {
          v14 = overridesCopy && -[CAMViewfinderViewController _slomoConfigurationOverride](self, "_slomoConfigurationOverride") ? -[CAMViewfinderViewController _slomoConfigurationOverride](self, "_slomoConfigurationOverride") : [v10 slomoConfiguration];
          v13 = [CAMCaptureConfiguration sanitizeVideoConfigurationForDesiredConfiguration:v14 mode:2 device:device trueVideoEnabled:_trueVideoIsActive frontRearSimultaneousVideoEnabled:_isFrontRearSimultaneousVideoEnabled];
          if (!v13)
          {
            v19 = +[CAMCaptureCapabilities capabilities];
            v20 = [v10 videoEncodingBehaviorForConfiguration:0 mode:2 desiredProResVideoMode:0 outputToExternalStorage:0 frontRearSimultaneousVideoEnabled:_isFrontRearSimultaneousVideoEnabled];
            hDR10BitVideoEnabled = [v10 HDR10BitVideoEnabled];
            v22 = 0;
            if (hDR10BitVideoEnabled)
            {
              v22 = [v19 isHDR10BitVideoSupportedForMode:2];
            }

            LOBYTE(v23) = _isFrontRearSimultaneousVideoEnabled;
            v13 = [v19 resolvedVideoConfigurationForMode:2 device:device videoEncodingBehavior:v20 videoConfiguration:0 outputToExternalStorage:0 prefersHDR10BitVideo:v22 frontRearSimultaneousVideoEnabled:v23];
          }
        }

        goto LABEL_30;
      }

      if (overridesCopy && [(CAMViewfinderViewController *)self _videoConfigurationOverride])
      {
        _videoConfigurationOverride = [(CAMViewfinderViewController *)self _videoConfigurationOverride];
      }

      else
      {
        _videoConfigurationOverride = [v10 videoConfiguration];
      }

      v15 = _videoConfigurationOverride;
      v16 = 1;
    }

    v13 = [CAMCaptureConfiguration sanitizeVideoConfigurationForDesiredConfiguration:v15 mode:v16 device:device trueVideoEnabled:_trueVideoIsActive frontRearSimultaneousVideoEnabled:_isFrontRearSimultaneousVideoEnabled];
    goto LABEL_30;
  }

  return [(CAMViewfinderViewController *)self imagePickerVideoConfiguration];
}

- (void)_changeToGraphConfiguration:(id)configuration zoomFactor:(double)factor fromGraphConfiguration:(id)graphConfiguration
{
  v30 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  graphConfigurationCopy = graphConfiguration;
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v13 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", graphConfigurationCopy, [_callStatusMonitor isCallActive]);

  _callStatusMonitor2 = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v15 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", configurationCopy, [_callStatusMonitor2 isCallActive]);

  if (v15)
  {
    [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
  }

  else
  {
    CAMSignpostWithIDAndArgs(9, 0xEEEEB0B5B2B2EEEELL, mode, device, 0, 0);
    [(CAMViewfinderViewController *)self _setNeedsDeferredGraphConfiguration:0];
    [(CAMViewfinderViewController *)self _minimumExecutionTimeForChangeToGraphConfiguration:configurationCopy fromGraphConfiguration:graphConfigurationCopy];
    v17 = v16;
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    v19 = [_captureController changeToGraphConfiguration:configurationCopy zoomFactor:-[CAMViewfinderViewController _externalStorageOutputEnabled](self minimumExecutionTime:"_externalStorageOutputEnabled") outputToExternalStorage:{factor, v17}];
    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:v19];
    v20 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v24 = 138543874;
      v25 = configurationCopy;
      v26 = 1024;
      v27 = v19;
      v28 = 2048;
      factorCopy = factor;
      _os_log_impl(&dword_1A3640000, v20, OS_LOG_TYPE_DEFAULT, "Requested change to %{public}@ (requestID=%d) (zoom=%.3f)", &v24, 0x1Cu);
    }

    if (v13)
    {
      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
    }

    [(CAMViewfinderViewController *)self _updateTorchModeForGraphConfiguration:configurationCopy animated:1];
    [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:mode];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:mode];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController setCaptureMode:mode];

    _remoteShutterController2 = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController2 setCaptureDevice:device];

    _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
    [_dockKitController captureModeDidChange:mode];
  }
}

- (double)_minimumExecutionTimeForChangeToGraphConfiguration:(id)configuration fromGraphConfiguration:(id)graphConfiguration
{
  graphConfigurationCopy = graphConfiguration;
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  mode2 = [graphConfigurationCopy mode];
  device = [configurationCopy device];

  if ((device - 1) > 0xA)
  {
    v10 = 0;
  }

  else
  {
    v10 = qword_1A3A685B0[device - 1];
  }

  device2 = [graphConfigurationCopy device];

  if ((device2 - 1) > 0xA)
  {
    v12 = 0;
    if (mode2)
    {
      goto LABEL_16;
    }
  }

  else
  {
    v12 = qword_1A3A685B0[device2 - 1];
    if (mode2)
    {
      goto LABEL_16;
    }
  }

  if (mode == 4)
  {
    v13 = 1;
    goto LABEL_10;
  }

LABEL_16:
  v13 = mode2 == 4 && mode == 0;
  if (mode2 == 5 && mode == 1)
  {
    v15 = 1;
    goto LABEL_25;
  }

LABEL_10:
  v15 = mode2 == 1 && mode == 5;
LABEL_25:
  result = 0.285;
  if (v12 != v10 || mode2 != mode && !v13 && !v15)
  {
    return 0.0;
  }

  return result;
}

- (int64_t)_aspectRatioForMode:(int64_t)mode videoConfiguration:(int64_t)configuration devicePosition:(int64_t)position trueVideoEnabled:(BOOL)enabled
{
  result = 0;
  if (mode > 4)
  {
    if (mode <= 6)
    {
      if (mode == 5)
      {
        return 1;
      }
    }

    else
    {
      if (mode == 7)
      {
LABEL_12:
        if ([(CAMViewfinderViewController *)self _resolvedFlipAspectRatioForMode:mode videoConfiguration:configuration devicePosition:position trueVideoEnabled:enabled])
        {
          return 6;
        }

        else
        {
          return 1;
        }
      }

      if (mode == 8)
      {
        return 1;
      }

      if (mode != 9)
      {
        return result;
      }
    }
  }

  else
  {
    if (mode > 1)
    {
      if ((mode - 2) >= 2)
      {
        v10 = mode == 4;
        goto LABEL_19;
      }

      return 1;
    }

    if (mode)
    {
      if (mode != 1)
      {
        return result;
      }

      goto LABEL_12;
    }
  }

  enabled = [(CAMViewfinderViewController *)self _aspectRatioCropForMode:mode devicePosition:position, position, enabled];
  v12 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:mode devicePosition:position]- 3;
  if (enabled > 1)
  {
    v13 = 6;
    if (v12 >= 2)
    {
      v13 = 1;
    }

    v14 = 2;
    if (enabled != 3)
    {
      v14 = 0;
    }

    if (enabled == 2)
    {
      return v13;
    }

    else
    {
      return v14;
    }
  }

  else
  {
    if (enabled)
    {
      v10 = enabled == 1;
LABEL_19:
      if (v10)
      {
        return 3;
      }

      else
      {
        return 0;
      }
    }

    emulationMode = [(CAMViewfinderViewController *)self emulationMode];
    v16 = 5;
    if (v12 >= 2)
    {
      v16 = 0;
    }

    if (emulationMode == 2)
    {
      return 4;
    }

    else
    {
      return v16;
    }
  }
}

- (int64_t)_shutterButtonModeForCameraMode:(int64_t)mode isCapturing:(BOOL)capturing
{
  capturingCopy = capturing;
  if (mode <= 2)
  {
    if (mode)
    {
      if (mode != 1)
      {
        v6 = 2;
        if (capturing)
        {
          v6 = 7;
        }

        v7 = mode == 2;
        goto LABEL_28;
      }

LABEL_22:
      if (capturing)
      {
        return 6;
      }

      else
      {
        return 1;
      }
    }
  }

  else
  {
    if (mode > 9)
    {
LABEL_25:
      v6 = 5;
      if (!capturing)
      {
        v6 = 0;
      }

      v7 = mode == 3;
LABEL_28:
      if (v7)
      {
        return v6;
      }

      else
      {
        return 0;
      }
    }

    if (((1 << mode) & 0x250) == 0)
    {
      if (((1 << mode) & 0x180) == 0)
      {
        if (mode == 5)
        {
          if (capturing)
          {
            return 8;
          }

          else
          {
            return 3;
          }
        }

        goto LABEL_25;
      }

      goto LABEL_22;
    }
  }

  v8 = +[CAMCaptureCapabilities capabilities];
  isLivePhotoSupported = [v8 isLivePhotoSupported];
  v10 = 4;
  if (capturingCopy)
  {
    v10 = 9;
  }

  v11 = 5;
  if (!capturingCopy)
  {
    v11 = 0;
  }

  if (isLivePhotoSupported)
  {
    v5 = v10;
  }

  else
  {
    v5 = v11;
  }

  return v5;
}

- ($76EADD4ED24426C67044446678BAA581)_dynamicShutterSettingsForGraphConfiguration:(SEL)configuration
{
  v30 = a4;
  *&retstr->var4 = xmmword_1A3A6AA58;
  *&retstr->var6 = unk_1A3A6AA68;
  retstr->var8 = 0;
  *&retstr->var0 = CAMDynamicShutterSettingsDefault;
  *&retstr->var2 = unk_1A3A6AA48;
  timerDuration = [(CAMViewfinderViewController *)self timerDuration];
  _useMessagesControls = [(CAMViewfinderViewController *)self _useMessagesControls];
  v8 = +[CAMCaptureCapabilities capabilities];
  if (_useMessagesControls || ![v8 isStillDuringVideoSupportedForVideoEncodingBehavior:{objc_msgSend(v30, "videoEncodingBehavior")}])
  {
    v9 = 0;
  }

  else
  {
    v9 = [v8 isStillDuringVideoSupportedForMode:{objc_msgSend(v30, "mode")}];
  }

  v10 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:v30];
  mode = [v30 mode];
  if (mode > 4)
  {
    if (mode <= 6)
    {
      if (mode == 5)
      {
        retstr->var0 = 1;
        retstr->var8 = 1;
        *&retstr->var6 = xmmword_1A3A681A0;
        goto LABEL_41;
      }

      if (timerDuration)
      {
        goto LABEL_30;
      }
    }

    else
    {
      if (mode == 7)
      {
        v18 = 1;
        v15 = vdupq_n_s64(1uLL);
        *&retstr->var0 = v15;
        retstr->var2 = 1;
        if (v9)
        {
          v18 = 2;
        }

        retstr->var5 = v18;
        goto LABEL_39;
      }

      if (mode == 8)
      {
LABEL_19:
        *&retstr->var0 = vdupq_n_s64(1uLL);
        retstr->var2 = 1;
        if ([(CAMViewfinderViewController *)self _layoutStyle]== 1)
        {
          retstr->var2 = 0;
        }

        if (v9)
        {
          v14 = 2;
        }

        else
        {
          v14 = 1;
        }

        retstr->var5 = v14;
        v15 = vdupq_n_s64(1uLL);
LABEL_39:
        *&retstr->var7 = v15;
        goto LABEL_40;
      }

      if (mode != 9)
      {
        goto LABEL_41;
      }

      if (timerDuration)
      {
        goto LABEL_30;
      }

      v12 = +[CAMCaptureCapabilities capabilities];
      isSpatialModeTrueVideoSupported = [v12 isSpatialModeTrueVideoSupported];

      if (isSpatialModeTrueVideoSupported)
      {
        *&retstr->var0 = xmmword_1A3A67B10;
        *&retstr->var2 = xmmword_1A3A68320;
        retstr->var5 = 1;
        retstr->var7 = 1;
LABEL_40:
        retstr->var4 = v10;
        goto LABEL_41;
      }
    }

    if (![(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable])
    {
      goto LABEL_41;
    }

LABEL_30:
    retstr->var0 = 1;
    goto LABEL_41;
  }

  if (mode <= 1)
  {
    if (!mode)
    {
LABEL_29:
      if (timerDuration)
      {
        goto LABEL_30;
      }

      if ([(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
      {
        isCapturingNightModeImage = 1;
      }

      else
      {
        _captureController = [(CAMViewfinderViewController *)self _captureController];
        isCapturingNightModeImage = [_captureController isCapturingNightModeImage];
      }

      isDisablingMultipleCaptureFeatures = [(CAMViewfinderViewController *)self isDisablingMultipleCaptureFeatures];
      if ([v8 isLongPressVideoCaptureFromPhotoModeSupported])
      {
        retstr->var0 = [(CAMViewfinderViewController *)self _isExpectedNightModeDurationCancelable];
        v23 = isCapturingNightModeImage ^ 1u;
        retstr->var2 = v23;
        retstr->var3 = ((isDisablingMultipleCaptureFeatures | isCapturingNightModeImage) & 1) == 0;
        v24 = 1;
        if (isDisablingMultipleCaptureFeatures)
        {
          v25 = 1;
        }

        else
        {
          v25 = 2;
        }

        if (isCapturingNightModeImage)
        {
          v25 = 0;
        }

        retstr->var5 = v25;
      }

      else
      {
        if (isDisablingMultipleCaptureFeatures)
        {
          v24 = 0;
        }

        else
        {
          v24 = 2;
        }

        v23 = isCapturingNightModeImage ^ 1u;
      }

      retstr->var1 = v24;
      retstr->var7 = v23;
      if ([v8 isTrueVideoSupported])
      {
        v26 = [v8 isTrueVideoSupportedForMode:{objc_msgSend(v30, "mode")}];
        v27 = v30;
        v28 = v26;
      }

      else
      {
        v28 = 0;
        v27 = v30;
      }

      v29 = [v8 isDynamicAspectRatioSupportedForMode:1 devicePosition:{objc_msgSend(v27, "devicePosition")}];
      if (v10 && v28 && v29)
      {
        LOBYTE(v10) = [v8 dynamicAspectRatioZoomSupported];
      }

      goto LABEL_40;
    }

    if (mode != 1)
    {
      goto LABEL_41;
    }

    goto LABEL_19;
  }

  if (mode == 2)
  {
    v16 = vdupq_n_s64(1uLL);
    *&retstr->var0 = v16;
    retstr->var2 = v9;
    if (v9)
    {
      v17 = 2;
    }

    else
    {
      v17 = 1;
    }

    retstr->var5 = v17;
    retstr->var8 = 1;
    *&retstr->var6 = v16;
    goto LABEL_40;
  }

  if (mode != 3)
  {
    goto LABEL_29;
  }

  *&retstr->var0 = vdupq_n_s64(1uLL);
LABEL_41:

  return result;
}

- ($E5C720D6BB068A42F0C2CD001350366C)_dynamicShutterPrivateSettingsForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];

  LOBYTE(configurationCopy) = [v4 isPauseVideoSupportedForMode:mode];
  return configurationCopy;
}

- (void)_updateShutterButtonForGraphConfiguration:(id)configuration isCapturing:(BOOL)capturing animated:(BOOL)animated
{
  animatedCopy = animated;
  capturingCopy = capturing;
  configurationCopy = configuration;
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (_dynamicShutterControl)
  {
    v22 = 0;
    v20 = 0u;
    v21 = 0u;
    v18 = 0u;
    v19 = 0u;
    [(CAMViewfinderViewController *)self _dynamicShutterSettingsForGraphConfiguration:configurationCopy];
    v10.var0 = [(CAMViewfinderViewController *)self _dynamicShutterPrivateSettingsForGraphConfiguration:configurationCopy];

    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    v16[2] = v20;
    v16[3] = v21;
    v17 = v22;
    v16[0] = v18;
    v16[1] = v19;
    [_dynamicShutterControl2 setSettings:v16 privateSettings:v10.var0 animated:animatedCopy];

    _dynamicShutterControl3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [_dynamicShutterControl3 updateChromeViewModel:chromeConfigurator];
  }

  else
  {
    _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
    mode = [configurationCopy mode];

    [_shutterButton setMode:-[CAMViewfinderViewController _shutterButtonModeForCameraMode:isCapturing:](self animated:{"_shutterButtonModeForCameraMode:isCapturing:", mode, capturingCopy), animatedCopy}];
  }
}

- (void)setShutterButtonSpinning:(BOOL)spinning
{
  if (spinning)
  {
    if (self->_shutterButtonSpinning)
    {
      return;
    }

    self->_shutterButtonSpinning = spinning;
  }

  else
  {
    if (![(CAMViewfinderViewController *)self isShutterButtonSpinning])
    {
      return;
    }

    self->_shutterButtonSpinning = spinning;
    self->__internalShutterButtonSpinning = 0;
  }

  [(CAMViewfinderViewController *)self _updateShutterButtonSpinning];
}

- (void)_setInternalShutterButtonSpinning:(BOOL)spinning
{
  if (self->__internalShutterButtonSpinning != spinning)
  {
    self->__internalShutterButtonSpinning = spinning;
    [(CAMViewfinderViewController *)self _updateShutterButtonSpinning];
  }
}

- (void)_updateShutterButtonSpinning
{
  isShutterButtonSpinning = [(CAMViewfinderViewController *)self isShutterButtonSpinning];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder isSmartStylePickerVisible];

  if (isSmartStylePickerVisible)
  {
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    smartStyleButton = [_controlDrawer smartStyleButton];
    shutterButton = [smartStyleButton shutterButton];
    [shutterButton setSpinning:isShutterButtonSpinning];
  }

  else
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

    if (_dynamicShutterControl)
    {
      [(CAMViewfinderViewController *)self _dynamicShutterControl];
    }

    else
    {
      [(CAMViewfinderViewController *)self _shutterButton];
    }
    _controlDrawer = ;
    [_controlDrawer setSpinning:isShutterButtonSpinning];
  }
}

- (void)_updateShutterButtonForEndOfNightModeCapture
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v4 = ([_captureController isCapturingNightModeImage] & 1) != 0 || -[CAMViewfinderViewController _isNightModeCaptureCanceling](self, "_isNightModeCaptureCanceling");
  [(CAMViewfinderViewController *)self _setInternalShutterButtonSpinning:v4];

  [_dynamicShutterControl resetAnimated:1];
  if ([(CAMViewfinderViewController *)self _isCurrentNightModeCaptureCancelable])
  {
    [(CAMViewfinderViewController *)self _setCurrentNightModeCaptureCancelable:0];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Night mode capture finished exposing"];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:0 animated:1];
  }
}

- (void)_updateShutterButtonLegibility
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  viewportAspectRatio = [_fullscreenViewfinder viewportAspectRatio];

  v6 = viewportAspectRatio == 4 || viewportAspectRatio == 1;
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl setShowContrastBorder:v6];
}

- (id)modesForModeDial:(id)dial
{
  v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
  availableCaptureModes = [(CAMViewfinderViewController *)self availableCaptureModes];
  if ([availableCaptureModes containsObject:&unk_1F16C7658])
  {
    [v4 addObject:&unk_1F16C7658];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7610])
  {
    [v4 addObject:&unk_1F16C7610];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7688])
  {
    [v4 addObject:&unk_1F16C7688];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C75F8])
  {
    [v4 addObject:&unk_1F16C75F8];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7748])
  {
    [v4 addObject:&unk_1F16C7748];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7670])
  {
    [v4 addObject:&unk_1F16C7670];
  }

  _spatialModeHasVideoSelected = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
  if ([availableCaptureModes containsObject:&unk_1F16C76A0] && _spatialModeHasVideoSelected)
  {
    [v4 addObject:&unk_1F16C76A0];
  }

  if (!(_spatialModeHasVideoSelected | (([availableCaptureModes containsObject:&unk_1F16C76B8] & 1) == 0)))
  {
    [v4 addObject:&unk_1F16C76B8];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7640])
  {
    [v4 addObject:&unk_1F16C7640];
  }

  if ([availableCaptureModes containsObject:&unk_1F16C7628])
  {
    [v4 addObject:&unk_1F16C7628];
  }

  return v4;
}

- (BOOL)_modeChangeSwipeMatchesExposureBiasPanDirection
{
  activeExposureBiasPanGestureRecognizer = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
  if (activeExposureBiasPanGestureRecognizer)
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = ([viewfinderView previewViewOrientation] - 3) < 2;
    direction = [(UISwipeGestureRecognizer *)self->__previousModeGestureRecognizer direction];
    v7 = v5 ^ [activeExposureBiasPanGestureRecognizer _canPanVertically];
    v9 = direction != 4 && direction != 8;
    v10 = v9 ^ v7;
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_smartStyleChangeSwipeMatchesExposureBiasPanDirection
{
  activeExposureBiasPanGestureRecognizer = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
  if (activeExposureBiasPanGestureRecognizer)
  {
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v5 = ([viewfinderView previewViewOrientation] - 5) < 0xFFFFFFFFFFFFFFFELL;

    v6 = [activeExposureBiasPanGestureRecognizer _canPanVertically] ^ v5;
  }

  else
  {
    LOBYTE(v6) = 0;
  }

  return v6;
}

- (BOOL)gestureRecognizer:(id)recognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(id)gestureRecognizer
{
  recognizerCopy = recognizer;
  gestureRecognizerCopy = gestureRecognizer;
  if ([(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection])
  {
    activeExposureBiasPanGestureRecognizer = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
    v9 = activeExposureBiasPanGestureRecognizer == gestureRecognizerCopy && (self->__previousModeGestureRecognizer == recognizerCopy || self->__nextModeGestureRecognizer == recognizerCopy);
  }

  else
  {
    v9 = 0;
  }

  if (self->__zoomPinchGestureRecognizer == recognizerCopy)
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    gestureRecognizers = [_dynamicShutterControl gestureRecognizers];
    v10 = [gestureRecognizers containsObject:gestureRecognizerCopy];
  }

  else
  {
    v10 = 0;
  }

  _sharedLibraryLongPressGestureRecognizer = [(CAMViewfinderViewController *)self _sharedLibraryLongPressGestureRecognizer];

  if (_sharedLibraryLongPressGestureRecognizer == recognizerCopy)
  {
    _sharedLibraryButton = [(CAMViewfinderViewController *)self _sharedLibraryButton];
    touchingGestureRecognizer = [_sharedLibraryButton touchingGestureRecognizer];
    v14 = touchingGestureRecognizer == gestureRecognizerCopy;
  }

  else
  {
    v14 = v9 | v10;
  }

  return v14;
}

- (BOOL)gestureRecognizerShouldBegin:(id)begin
{
  beginCopy = begin;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (([_captureController isCapturingNightModeImage] & 1) != 0 || -[CAMViewfinderViewController _wantsVisualTextAnalysis](self, "_wantsVisualTextAnalysis"))
  {
    v6 = 0;
  }

  else if (self->__zoomPinchGestureRecognizer == beginCopy)
  {
    _isPinchToZoomAllowed = [(CAMViewfinderViewController *)self _isPinchToZoomAllowed];
    _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
    isCapturingBurst = [_captureController isCapturingBurst];
    v11 = (isCapturingBurst | [(CAMViewfinderViewController *)self _isCapturingFromTimer]) ^ 1;
    if (_isModeDisabled)
    {
      LOBYTE(v11) = 0;
    }

    if (_isPinchToZoomAllowed)
    {
      v6 = v11;
    }

    else
    {
      v6 = 0;
    }
  }

  else if (self->__nextModeGestureRecognizer == beginCopy || self->__previousModeGestureRecognizer == beginCopy)
  {
    v6 = [_captureController isCapturingBurst] ^ 1;
  }

  else if (self->__smartStylesSwipeLeftGestureRecognizer == beginCopy || self->__smartStylesSwipeRightGestureRecognizer == beginCopy)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    smartStylePicker = [_fullscreenViewfinder smartStylePicker];

    [(UISwipeGestureRecognizer *)beginCopy locationInView:smartStylePicker];
    v15 = v14;
    v17 = v16;
    [smartStylePicker bounds];
    v18.x = v15;
    v18.y = v17;
    v6 = CGRectContainsPoint(v19, v18);
  }

  else
  {
    v6 = 1;
  }

  return v6 & 1;
}

- (BOOL)gestureRecognizer:(id)recognizer shouldReceiveTouch:(id)touch
{
  recognizerCopy = recognizer;
  touchCopy = touch;
  zoomPinchGestureRecognizer = self->__zoomPinchGestureRecognizer;
  _primaryShutterControl = [(CAMViewfinderViewController *)self _primaryShutterControl];
  isTracking = [_primaryShutterControl isTracking];

  if (!isTracking || zoomPinchGestureRecognizer == recognizerCopy)
  {
    if (self->__nextModeGestureRecognizer != recognizerCopy && self->__previousModeGestureRecognizer != recognizerCopy)
    {
      if (self->__zoomPinchGestureRecognizer != recognizerCopy)
      {
        v11 = 1;
        goto LABEL_45;
      }

      _topBar = [(CAMViewfinderViewController *)self _topBar];
      [touchCopy locationInView:_topBar];
      v34 = v33;
      if (_topBar)
      {
        v35 = v32;
        [_topBar bounds];
        v87.x = v35;
        v87.y = v34;
        v36 = CGRectContainsPoint(v90, v87);
      }

      else
      {
        v36 = 0;
      }

      _bottomBar = [(CAMViewfinderViewController *)self _bottomBar];
      [touchCopy locationInView:_bottomBar];
      if (_bottomBar)
      {
        v82 = v80;
        v83 = v81;
        [_bottomBar bounds];
        v88.x = v82;
        v88.y = v83;
        v84 = !CGRectContainsPoint(v93, v88);
      }

      else
      {
        LOBYTE(v84) = 1;
      }

      if (v34 < 0.0 && _topBar != 0)
      {
        LOBYTE(v84) = 0;
      }

      v11 = !v36 && v84;
LABEL_44:

      goto LABEL_45;
    }

    _topBar = [(CAMPreviewViewController *)self->__previewViewController activeExposureBiasPanGestureRecognizer];
    if (_topBar)
    {
      if ([(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection])
      {
        if (!self->__modeDial || ([touchCopy locationInView:?], v14 = v13, v16 = v15, -[CAMModeDial bounds](self->__modeDial, "bounds"), v89.origin.x = v17 + 0.0, v89.origin.y = v18 + -10.0, v89.size.height = v19 + 10.0, v86.x = v14, v86.y = v16, !CGRectContainsPoint(v89, v86)))
        {
          v11 = 0;
LABEL_43:
          _bottomBar = [(CAMViewfinderViewController *)self _feedbackController];
          [_bottomBar prepareDiscreteFeedback:0];
          goto LABEL_44;
        }
      }
    }

    view = [touchCopy view];
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    if (_layoutStyle != 3 && _layoutStyle)
    {
      v11 = 1;
LABEL_40:
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        _modeDial = [(CAMViewfinderViewController *)self _modeDial];
        v11 = view == _modeDial;
      }

      goto LABEL_43;
    }

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v24 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];

    if ([_fullscreenViewfinder isControlDrawerExpanded])
    {
      isControlDrawerVisible = [_fullscreenViewfinder isControlDrawerVisible];
    }

    else
    {
      isControlDrawerVisible = 0;
    }

    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v27 = [(CAMViewfinderViewController *)self _shouldApplyTopBarRotationForGraphConfiguration:_currentGraphConfiguration2];

    _topBar2 = [(CAMViewfinderViewController *)self _topBar];
    if (!_topBar2 || v27)
    {
      controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    }

    else
    {
      controlStatusBar = [(CAMViewfinderViewController *)self _topBar];
    }

    v30 = controlStatusBar;

    if (isControlDrawerVisible)
    {
      controlDrawer = [_fullscreenViewfinder controlDrawer];
    }

    else
    {
      if (v24)
      {
        [(CAMViewfinderViewController *)self _primaryShutterControl];
      }

      else
      {
        [(CAMViewfinderViewController *)self _utilityBar];
      }
      controlDrawer = ;
    }

    v37 = controlDrawer;
    [v30 bounds];
    v39 = v38;
    v41 = v40;
    v43 = v42;
    v45 = v44;
    view2 = [(CAMViewfinderViewController *)self view];
    [v30 convertRect:view2 toView:{v39, v41, v43, v45}];
    v48 = v47;
    v50 = v49;
    v52 = v51;
    v54 = v53;

    [v37 bounds];
    v56 = v55;
    v58 = v57;
    v60 = v59;
    v62 = v61;
    view3 = [(CAMViewfinderViewController *)self view];
    [v37 convertRect:view3 toView:{v56, v58, v60, v62}];
    v65 = v64;
    v67 = v66;
    v69 = v68;
    v71 = v70;

    if (v30)
    {
      v91.origin.x = v48;
      v91.origin.y = v50;
      v91.size.width = v52;
      v91.size.height = v54;
      MaxY = CGRectGetMaxY(v91);
      if (v37)
      {
LABEL_33:
        v92.origin.x = v65;
        v92.origin.y = v67;
        v92.size.width = v69;
        v92.size.height = v71;
        MinY = CGRectGetMinY(v92);
LABEL_36:
        view4 = [(CAMViewfinderViewController *)self view];
        [touchCopy locationInView:view4];
        v76 = v75;

        v11 = v76 > MaxY && v76 < MinY;
        goto LABEL_40;
      }
    }

    else
    {
      MaxY = 0.0;
      if (v37)
      {
        goto LABEL_33;
      }
    }

    MinY = 1.79769313e308;
    goto LABEL_36;
  }

  v11 = 0;
LABEL_45:

  return v11;
}

- (BOOL)gestureRecognizer:(id)recognizer shouldRequireFailureOfGestureRecognizer:(id)gestureRecognizer
{
  gestureRecognizerCopy = gestureRecognizer;
  previewViewController = self->__previewViewController;
  recognizerCopy = recognizer;
  activeExposureBiasPanGestureRecognizer = [(CAMPreviewViewController *)previewViewController activeExposureBiasPanGestureRecognizer];

  v10 = activeExposureBiasPanGestureRecognizer == recognizerCopy && ![(CAMViewfinderViewController *)self _modeChangeSwipeMatchesExposureBiasPanDirection]&& (self->__previousModeGestureRecognizer == gestureRecognizerCopy || self->__nextModeGestureRecognizer == gestureRecognizerCopy);
  return v10;
}

- (void)previewViewControllerDidChangeFocusOrExposureLocked:(id)locked shouldAnimate:(BOOL)animate
{
  animateCopy = animate;
  lockedCopy = locked;
  [(CAMViewfinderViewController *)self _updateFocusAndExposureLockBadgeAnimated:animateCopy];
  LODWORD(animateCopy) = [lockedCopy isFocusLockedByUser];

  if (animateCopy)
  {
    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [_analyticsSessionEvent didFocusLockInteraction];
  }
}

- (void)previewViewControllerDidChangeFocusOrExposure:(id)exposure
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "previewViewControllerDidChangeFocusOrExposure", v7, 2u);
  }

  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didFocusInteraction];

  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];
}

- (void)previewViewController:(id)controller willResetFocus:(BOOL)focus exposure:(BOOL)exposure
{
  focusCopy = focus;
  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle:controller];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  if (focusCopy)
  {
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setIsLensPositionLockedByUser:0];
  }
}

- (BOOL)previewViewControllerShouldRestrictExposureBiasPanToTouchesNearSlider:(id)slider
{
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  captureOrientation = [_motionController captureOrientation];

  v6 = captureOrientation - 1;
  v7 = +[CAMCaptureCapabilities capabilities];
  allowControlDrawer = [v7 allowControlDrawer];

  if (v6 < 2)
  {
    v9 = allowControlDrawer;
  }

  else
  {
    v9 = 0;
  }

  if ([(CAMViewfinderViewController *)self _shouldEnableSmartStylesSwipeGestures])
  {
    v9 |= [(CAMViewfinderViewController *)self _smartStyleChangeSwipeMatchesExposureBiasPanDirection];
  }

  return v9 & 1;
}

- (void)previewViewControllerDidChangeVideoFillAspectRatio:(id)ratio
{
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  [viewfinderView setNeedsLayout];
}

- (void)frontPIPFrameDidChange:(CGRect)change
{
  height = change.size.height;
  width = change.size.width;
  y = change.origin.y;
  x = change.origin.x;
  chromeViewController = [(CAMViewfinderViewController *)self chromeViewController];
  view = [chromeViewController view];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  view2 = [_previewViewController view];
  [view convertRect:view2 fromView:{x, y, width, height}];
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v19 = v18;

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setFrontPIPFrame:{v13, v15, v17, v19}];
}

- (void)frontPIPWillAnimateToAnchor:(int64_t)anchor withFrame:(CGRect)frame
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  anchorCopy = anchor;
  v10 = (anchor & 0xFFFFFFFFFFFFFFFELL) == 2;
  _analyticsEventsByIdentifier = [(CAMViewfinderViewController *)self _analyticsEventsByIdentifier];
  _frsvAnalyticsId = [(CAMViewfinderViewController *)self _frsvAnalyticsId];
  v13 = [_analyticsEventsByIdentifier objectForKey:_frsvAnalyticsId];

  [v13 trackFrontRearSimultaneousVideoPIPMoveToAnchor:anchorCopy];
  [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoPIPAnchor:anchorCopy];
  LODWORD(anchorCopy) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  view = [_previewViewController view];
  [(CAMViewfinderViewController *)self _calculateVerticalOffsetFromZoomPlatterToFrame:view fromView:x, y, width, height];
  v17 = v16;

  if ((v10 & anchorCopy) == 0)
  {
    v17 = 0.0;
  }

  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  [_zoomControl buttonPlatterVerticalOffset];
  v20 = v19;

  if ((BSFloatEqualToFloat() & 1) == 0)
  {
    v21 = objc_alloc_init(MEMORY[0x1E6993858]);
    [v21 setDefaultCriticallyDampedValues];
    _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v25 = MEMORY[0x1E6993860];
    v39[0] = MEMORY[0x1E69E9820];
    v39[1] = 3221225472;
    v39[2] = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke;
    v39[3] = &unk_1E76F9AD8;
    v40 = _zoomControl2;
    v41 = _fullscreenViewfinder;
    v42 = chromeConfigurator;
    v43 = v17;
    v26 = chromeConfigurator;
    v27 = _fullscreenViewfinder;
    v28 = _zoomControl2;
    v29 = [v25 floatAnimatablePropertyWithInitialValue:v39 cancelableFrameCallback:v20];
    v30 = MEMORY[0x1E69DD250];
    v33 = MEMORY[0x1E69E9820];
    v34 = 3221225472;
    v35 = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_3;
    v36 = &unk_1E76F7A38;
    v37 = v29;
    v38 = v17;
    v31 = v29;
    [v30 cek_animateWithSettings:v21 mode:3 animations:&v33 completion:0];
    v32 = [(CAMViewfinderViewController *)self _zoomButtonPlatterOffsetAnimator:v33];
    [v32 invalidate];

    [(CAMViewfinderViewController *)self set_zoomButtonPlatterOffsetAnimator:v31];
  }
}

BOOL __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  [v3 presentationValue];
  [*(a1 + 32) setButtonPlatterVerticalOffset:?];
  [*(a1 + 40) setNeedsLayout];
  v4 = *(a1 + 48);
  v8 = MEMORY[0x1E69E9820];
  v9 = 3221225472;
  v10 = __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_2;
  v11 = &unk_1E76F7960;
  v12 = v4;
  v5 = v3;
  v13 = v5;
  [v12 performChanges:&v8];
  [v5 velocity];
  v6 = 0;
  if (BSFloatIsZero())
  {
    [v5 presentationValue];
    if (BSFloatEqualToFloat())
    {
      v6 = 1;
    }
  }

  return v6;
}

uint64_t __69__CAMViewfinderViewController_frontPIPWillAnimateToAnchor_withFrame___block_invoke_2(uint64_t a1)
{
  [*(a1 + 40) presentationValue];
  v2 = *(a1 + 32);

  return [v2 setButtonPlatterVerticalOffset:?];
}

- (double)_calculateVerticalOffsetFromZoomPlatterToFrame:(CGRect)frame fromView:(id)view
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  viewCopy = view;
  view = [(CAMViewfinderViewController *)self view];
  [view convertRect:viewCopy fromView:{x, y, width, height}];
  v12 = v11;

  view2 = [(CAMViewfinderViewController *)self view];
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  [_zoomControl buttonPlatterDefaultFrame];
  v16 = v15;
  v18 = v17;
  v20 = v19;
  v22 = v21;
  _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
  [view2 convertRect:_zoomControl2 fromView:{v16, v18, v20, v22}];
  v25 = v24;
  v27 = v26;

  v28 = v25 + v27 - v12;
  v29 = v28 + 8.0;
  v30 = v28 <= 0.0;
  result = 0.0;
  if (!v30)
  {
    return v29;
  }

  return result;
}

- (void)captureController:(id)controller didOutputLensPosition:(double)position
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  isTrackingLensPositionSlider = [chromeConfigurator isTrackingLensPositionSlider];

  if ((isTrackingLensPositionSlider & 1) == 0)
  {
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setLensPosition:position];
  }
}

- (void)captureController:(id)controller didOutputLensSmudgeStatus:(int64_t)status
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  devicePosition = [_currentGraphConfiguration devicePosition];

  if (devicePosition)
  {
    if (devicePosition == 1)
    {
      _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
    }

    else
    {
      _lensSmudgeDisplayFrontState = 0;
    }
  }

  else
  {
    _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  }

  v10 = _lensSmudgeDisplayFrontState;
  status = [_lensSmudgeDisplayFrontState status];
  [v10 setStatus:status];
  if (status == 2 && status != 2)
  {
    [(CAMViewfinderViewController *)self _displayLensSmudgeDetected:devicePosition];
  }
}

- (void)_displayLensSmudgeDetected:(int64_t)detected
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self _createCleanLensesInstructionLabelIfNecessary];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _showControlsForGraphConfiguration:_currentGraphConfiguration2 animated:1];

  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldShowCleanLensesInstructionLabelForGraphConfiguration:_currentGraphConfiguration3];

  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didDetectSmudgedLensForDevicePosition:detected didNotifyUser:v8];
}

- (void)lensSmudgeDisplayShouldBeHiddenForDevicePosition:(int64_t)position
{
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== position)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _hideControlsForGraphConfiguration:_currentGraphConfiguration2 animated:1];
  }
}

- (CGRect)chromeSidebarFrame
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator chromeSidebarFrame];
  v4 = v3;
  v6 = v5;
  v8 = v7;
  v10 = v9;

  v11 = v4;
  v12 = v6;
  v13 = v8;
  v14 = v10;
  result.size.height = v14;
  result.size.width = v13;
  result.origin.y = v12;
  result.origin.x = v11;
  return result;
}

- (void)captureController:(id)controller didUpdateActivePrimaryConstituentDeviceType:(int64_t)type
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setActivePrimaryConstituentDeviceType:type];

  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
}

- (int64_t)_effectFilterTypeForMode:(int64_t)mode
{
  if ([(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    if (mode == 6)
    {

      return [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
    }

    else if (mode == 4)
    {

      return [(CAMViewfinderViewController *)self _squareModeEffectFilterType];
    }

    else if (mode)
    {
      return 0;
    }

    else
    {

      return [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
    }
  }

  else
  {

    return [CAMUserPreferences defaultFilterTypeForMode:mode];
  }
}

- (int64_t)_itemIndexForFilterType:(int64_t)type
{
  v13 = *MEMORY[0x1E69E9840];
  _filterTypes = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = [MEMORY[0x1E696AD98] numberWithInteger:type];
  v6 = [_filterTypes indexOfObject:v5];

  if (v6 == 0x7FFFFFFFFFFFFFFFLL)
  {
    v7 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v9 = 134218242;
      typeCopy = type;
      v11 = 2114;
      v12 = _filterTypes;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Tried to get index for filterType %ld; only filterTypes are %{public}@", &v9, 0x16u);
    }

    v6 = 0;
  }

  return v6;
}

- (int64_t)_filterTypeForItemIndex:(int64_t)index
{
  _filterTypes = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = _filterTypes;
  if (index < 0 || [_filterTypes count] <= index)
  {
    integerValue = 0;
  }

  else
  {
    v6 = [v5 objectAtIndexedSubscript:index];
    integerValue = [v6 integerValue];
  }

  return integerValue;
}

- (void)_setEffectFilterType:(int64_t)type forMode:(int64_t)mode
{
  v8 = *MEMORY[0x1E69E9840];
  if (mode > 9)
  {
LABEL_13:
    if (!mode)
    {

      [(CAMViewfinderViewController *)self _setPhotoModeEffectFilterType:type];
    }

    return;
  }

  if (((1 << mode) & 0x3AE) != 0)
  {
    if (type)
    {
      v5 = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
      {
        v6 = 134217984;
        modeCopy = mode;
        _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Trying to set filter type on unhandled mode %ld", &v6, 0xCu);
      }
    }

    return;
  }

  if (mode != 4)
  {
    if (mode == 6)
    {

      [(CAMViewfinderViewController *)self _setPortraitModeEffectFilterType:type];
      return;
    }

    goto LABEL_13;
  }

  [(CAMViewfinderViewController *)self _setSquareModeEffectFilterType:type];
}

- (int64_t)_lastCapturedFilterTypeForMode:(int64_t)mode
{
  v4 = +[CAMUserPreferences preferences];
  v5 = v4;
  if (mode == 6)
  {
    portraitModeLastCapturedEffectFilterType = [v4 portraitModeLastCapturedEffectFilterType];
  }

  else if (mode == 4)
  {
    portraitModeLastCapturedEffectFilterType = [v4 squareModeLastCapturedEffectFilterType];
  }

  else
  {
    if (mode)
    {
      v7 = 0;
      goto LABEL_9;
    }

    portraitModeLastCapturedEffectFilterType = [v4 photoModeLastCapturedEffectFilterType];
  }

  v7 = portraitModeLastCapturedEffectFilterType;
LABEL_9:

  return v7;
}

- (BOOL)_shouldUseFiltersForGraphConfiguration:(id)configuration
{
  mode = [configuration mode];
  if (mode > 6 || ((1 << mode) & 0x51) == 0)
  {
    return 0;
  }

  v4 = +[CAMCaptureCapabilities capabilities];
  isLiveFilteringSupported = [v4 isLiveFilteringSupported];

  return isLiveFilteringSupported;
}

- (unint64_t)_previewConfigurationForMode:(int64_t)mode devicePosition:(int64_t)position videoThumbnailOutputEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v7 = [(CAMViewfinderViewController *)self isPerformingReviewUsingOverlay:mode];
  v8 = v7 | [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  v9 = 5;
  if (!enabledCopy)
  {
    v9 = 1;
  }

  if (v8)
  {
    return 0;
  }

  else
  {
    return v9;
  }
}

- (id)_previewFiltersForMode:(int64_t)mode device:(int64_t)device wantsPhotoModePortraitEffect:(BOOL)effect
{
  effectCopy = effect;
  v9 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:?];
  v10 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:mode device:device];
  v11 = mode - 6;
  if (effectCopy)
  {
    v12 = v10;
  }

  else
  {
    v12 = 0;
  }

  if (mode)
  {
    v13 = 0;
  }

  else
  {
    v13 = effectCopy;
  }

  if (mode)
  {
    v12 = v10;
  }

  v14 = v11 < 2 || v13;
  if (v11 >= 2)
  {
    v15 = v12;
  }

  else
  {
    v15 = v10;
  }

  return [CAMEffectFilterManager filtersForFilterType:v9 lightingType:v15 applyDepthEffect:v14];
}

- (void)_updateCurrentPreviewFiltersOnCaptureController
{
  if (![(CAMViewfinderViewController *)self _isReconfiguring])
  {
    v4 = [(CAMViewfinderViewController *)self _previewFiltersForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice] wantsPhotoModePortraitEffect:[(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect]];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController changeToPreviewFilters:v4 captureMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];
  }
}

- (id)_currentCaptureFiltersForBurst:(BOOL)burst
{
  burstCopy = burst;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  v7 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", mode, [_currentGraphConfiguration device]);
  if (mode)
  {
    if (mode == 7)
    {
      v9 = 0;
LABEL_9:
      v10 = 1;
      goto LABEL_13;
    }

    if (mode == 6)
    {
      _portraitModeEffectFilterType = [(CAMViewfinderViewController *)self _portraitModeEffectFilterType];
LABEL_8:
      v9 = _portraitModeEffectFilterType;
      goto LABEL_9;
    }

    v10 = 0;
  }

  else
  {
    if ([(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffectIsBurst:burstCopy])
    {
      _portraitModeEffectFilterType = [(CAMViewfinderViewController *)self _photoModeEffectFilterType];
      goto LABEL_8;
    }

    v10 = 0;
    v7 = 0;
  }

  v9 = 0;
LABEL_13:
  v11 = [CAMEffectFilterManager filtersForFilterType:v9 lightingType:v7 applyDepthEffect:v10];

  return v11;
}

- (id)_originalCaptureFiltersForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v7 = +[CAMCaptureCapabilities capabilities];
  if ([v7 isNaturalLightingAppliedToOriginal] && -[CAMViewfinderViewController _wantsLightingControlForMode:devicePosition:](self, "_wantsLightingControlForMode:devicePosition:", mode, position))
  {
    portraitOriginalPhotoFilters = [MEMORY[0x1E6993870] portraitOriginalPhotoFilters];
  }

  else
  {
    portraitOriginalPhotoFilters = 0;
  }

  return portraitOriginalPhotoFilters;
}

- (void)_updateFilterScrubberForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  isLiveFilteringSupported = [v4 isLiveFilteringSupported];

  if (isLiveFilteringSupported)
  {
    mode = [configurationCopy mode];
    v7 = +[CAMUserPreferences preferences];
    v8 = [v7 filterTypesForMode:mode];
    [(CAMViewfinderViewController *)self set_filterTypes:v8];
    [(CAMViewfinderViewController *)self _updateChromeFilterScrubberForGraphConfiguration:configurationCopy];
  }
}

- (void)_updateChromeFilterScrubberForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _filterTypes = [(CAMViewfinderViewController *)self _filterTypes];
  v5 = [_filterTypes count];

  v6 = configurationCopy;
  if (v5 >= 1)
  {
    mode = [configurationCopy mode];
    v8 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:mode];
    v9 = [(CAMViewfinderViewController *)self _lastCapturedFilterTypeForMode:mode];
    v10 = [CAMUserPreferences defaultFilterTypeForMode:mode];
    v11 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v5];
    for (i = 0; i != v5; ++i)
    {
      v13 = [CAMEffectFilterManager displayNameForType:[(CAMViewfinderViewController *)self _filterTypeForItemIndex:i]];
      [v11 addObject:v13];
    }

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setFiltersItemCount:v5];

    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setFilterItemDisplayNames:v11];

    v16 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v10];
    chromeConfigurator3 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator3 setFiltersDefaultIndex:v16];

    v18 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v8];
    chromeConfigurator4 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator4 setFiltersSelectedIndex:v18];

    v20 = [(CAMViewfinderViewController *)self _itemIndexForFilterType:v9];
    chromeConfigurator5 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator5 setFiltersMarkedIndex:v20];

    v6 = configurationCopy;
  }
}

- (void)_setWantsFilterScrubberVisible:(BOOL)visible animated:(BOOL)animated
{
  if (self->__wantsFilterScrubberVisible != visible)
  {
    animatedCopy = animated;
    visibleCopy = visible;
    self->__wantsFilterScrubberVisible = visible;
    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:animated];
    [(CAMViewfinderViewController *)self _setShouldShowFilterScrubberAfterNextRender:visibleCopy & animatedCopy];
    if (![(CAMViewfinderViewController *)self _shouldShowFilterScrubberAfterNextRender])
    {
      [(CAMViewfinderViewController *)self _setShowingFilterScrubber:visibleCopy animated:animatedCopy];
    }

    v8 = [(CAMViewfinderViewController *)self _previewConfigurationForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition] videoThumbnailOutputEnabled:visibleCopy];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController changeToPreviewConfiguration:v8];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Filter scrubber desired visibility changed"];
  }
}

- (void)_setShowingFilterScrubber:(BOOL)scrubber animated:(BOOL)animated
{
  if (self->__showingFilterScrubber == scrubber)
  {
    return;
  }

  animatedCopy = animated;
  scrubberCopy = scrubber;
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];

  if (!_controlDrawer)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];
    if (scrubberCopy)
    {
      v11 = v10;
      [(CAMViewfinderViewController *)self _createFilterNameBadgeIfNecessary];
      [(CAMViewfinderViewController *)self _updateControlsForVisibleFilterScrubberAnimated:animatedCopy];
      _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
      v13 = _utilityBar;
      v14 = !v11 && [_utilityBar visibleContent] != 0;
      [v13 setVisibleContent:1 animated:animatedCopy & v14];
    }

    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v16 = viewfinderView;
    if (animatedCopy)
    {
      [viewfinderView layoutIfNeeded];
    }

    goto LABEL_14;
  }

  _controlDrawer2 = [(CAMViewfinderViewController *)self _controlDrawer];
  _currentGraphConfiguration = _controlDrawer2;
  if (!scrubberCopy)
  {
    [_controlDrawer2 collapseExpandableButtonsAnimated:animatedCopy updatePreferredDrawerControl:0];
LABEL_14:

    goto LABEL_15;
  }

  [_controlDrawer2 expandControlForType:4 animated:animatedCopy updatePreferredDrawerControl:0];

  [(CAMViewfinderViewController *)self _updateControlsForVisibleFilterScrubberAnimated:animatedCopy];
LABEL_15:
  self->__showingFilterScrubber = scrubberCopy;
  _controlDrawer3 = [(CAMViewfinderViewController *)self _controlDrawer];

  if (!_controlDrawer3)
  {
    [(CAMViewfinderViewController *)self _layoutViewfinderForShowingFilterScrubber:scrubberCopy animated:animatedCopy];
  }

  [(CAMViewfinderViewController *)self _dismissOverlays];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Filter scrubber actual visibility changed"];
  if (scrubberCopy)
  {
    [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0];
    [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0];
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsFilterThumbnailContentValid:scrubberCopy];
}

- (void)_layoutViewfinderForShowingFilterScrubber:(BOOL)scrubber animated:(BOOL)animated
{
  animatedCopy = animated;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [viewfinderView setNeedsLayout];
  if (animatedCopy)
  {
    if (!scrubber)
    {
      [(CAMViewfinderViewController *)self _setAnimatingFilterScrubberDismissal:1];
    }

    v10 = MEMORY[0x1E69DD250];
    v16[0] = MEMORY[0x1E69E9820];
    v16[1] = 3221225472;
    v16[2] = __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke;
    v16[3] = &unk_1E76F77B0;
    v17 = viewfinderView;
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke_2;
    v14[3] = &unk_1E76F9B00;
    scrubberCopy = scrubber;
    v14[4] = self;
    v14[5] = a2;
    [v10 animateWithDuration:6 delay:v16 options:v14 animations:0.25 completion:0.0];

    [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
    [(CAMViewfinderViewController *)self _setView:self->__filterNameBadge hidden:[(CAMViewfinderViewController *)self _shouldHideFilterNameBadgeForGraphConfiguration:_currentGraphConfiguration] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
    v11 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:_currentGraphConfiguration];
    viewfinderView2 = [(CAMViewfinderViewController *)self viewfinderView];
    zoomControl = [viewfinderView2 zoomControl];
    [(CAMViewfinderViewController *)self _setView:zoomControl hidden:v11 delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
  }
}

void __82__CAMViewfinderViewController__layoutViewfinderForShowingFilterScrubber_animated___block_invoke_2(uint64_t a1)
{
  if ((*(a1 + 48) & 1) == 0)
  {
    [*(a1 + 32) _setAnimatingFilterScrubberDismissal:0];
    v3 = *(a1 + 32);
    v4 = NSStringFromSelector(*(a1 + 40));
    [v3 _clearFilterScrubberLayerContentsIfNotNeededFromCallsite:v4];
  }
}

- (void)_updateControlsForVisibleFilterScrubberAnimated:(BOOL)animated
{
  animatedCopy = animated;
  v5 = +[CAMCaptureCapabilities capabilities];
  isLiveFilteringSupported = [v5 isLiveFilteringSupported];

  if (isLiveFilteringSupported)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:_currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:animatedCopy];
    _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
    [_zoomSlider makeInvisibleAnimated:animatedCopy];

    [(CAMViewfinderViewController *)self _resetPortraitLightingToDefaultAnimated:animatedCopy];
  }
}

- (void)_resetPortraitLightingToDefaultAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isLightingControlSupportedForMode:{objc_msgSend(_currentGraphConfiguration, "mode")}];

  if (v6)
  {
    _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
    [_targetLightingControl setSelectedLightingType:{objc_msgSend(_targetLightingControl, "defaultLightingType")}];
    defaultLightingType = [_targetLightingControl defaultLightingType];
    _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
    [_lightingNameBadge setLightingType:defaultLightingType];

    defaultLightingType2 = [_targetLightingControl defaultLightingType];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    lightingNameBadge = [_fullscreenViewfinder lightingNameBadge];
    [lightingNameBadge setLightingType:defaultLightingType2];

    defaultLightingType3 = [_targetLightingControl defaultLightingType];
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    [_previewViewController setLightingType:defaultLightingType3];

    mode = [_currentGraphConfiguration mode];
    v16 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", mode, [_currentGraphConfiguration device]);
    v17 = [CAMUserPreferences defaultLightingTypeForMode:mode];
    if (v16 != v17)
    {
      [(CAMViewfinderViewController *)self _setLightingType:v17 forMode:mode];
      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
      [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:animatedCopy];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
    }

    [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  }
}

- (void)_hideUtilityBarAnimated:(BOOL)animated
{
  animatedCopy = animated;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0 animated:animated];
  [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0 animated:animatedCopy];

  [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0 animated:animatedCopy];
}

- (void)_updateFilterNameBadgeAnimated:(BOOL)animated
{
  v4 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:[(CAMViewfinderViewController *)self _currentMode]];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

  if (_fullscreenViewfinder)
  {
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    filterNameBadge = [_fullscreenViewfinder2 filterNameBadge];
    [filterNameBadge setFilterType:v4];
  }

  else
  {
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _filterNameBadge];
    [_fullscreenViewfinder2 setFilterType:v4];
  }
}

- (void)_dismissOverlays
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:?])
  {
    v3 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:_currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _dismissDescriptionOverlayView:v3 withDuration:0 fromUserAction:0.5];
  }
}

- (BOOL)_isDepthEffectApertureSupportedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  v12 = 0;
  if ([v5 isDepthEffectApertureSupportedForMode:objc_msgSend(configurationCopy devicePosition:"mode") depthSuggestionEnabled:{objc_msgSend(configurationCopy, "devicePosition"), objc_msgSend(configurationCopy, "enableDepthSuggestion")}])
  {
    currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
    if ([v5 isDepthEffectApertureSupportedForPhotoFormat:currentPhotoFormat, v7])
    {
      mode = [configurationCopy mode];
      devicePosition = [configurationCopy devicePosition];
      currentPhotoFormat2 = [(CAMViewfinderViewController *)self currentPhotoFormat];
      if (![v5 isDepthSuggestionSupportedForMode:mode devicePosition:devicePosition photoFormat:currentPhotoFormat2, v11] || -[CAMViewfinderViewController _depthEffectEnabledFromSuggestion](self, "_depthEffectEnabledFromSuggestion"))
      {
        v12 = 1;
      }
    }
  }

  return v12;
}

- (void)_resetPortraitModeApertureValueIfNeededForGraphConfiguration:(id)configuration zoomFactor:(double)factor
{
  configurationCopy = configuration;
  v6 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  if ([v6 isDepthEffectApertureSupportedForMode:mode devicePosition:objc_msgSend(configurationCopy depthSuggestionEnabled:{"devicePosition"), objc_msgSend(configurationCopy, "enableDepthSuggestion")}])
  {
    device = [configurationCopy device];
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    if (v9 <= 0.0)
    {
      v10 = +[CAMCaptureCapabilities capabilities];
      [v10 defaultDepthEffectApertureForMode:mode device:device zoomFactor:factor];
      [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:?];
    }
  }
}

- (void)_setShowingPortraitApertureSlider:(BOOL)slider animated:(BOOL)animated
{
  if (self->__showingPortraitApertureSlider != slider)
  {
    animatedCopy = animated;
    sliderCopy = slider;
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];
    if (sliderCopy)
    {
      [(CAMViewfinderViewController *)self _createPortraitApertureSliderIfNecessary];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration zoomFactor:?];
      _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
      v10 = _utilityBar;
      v11 = !v8 && [_utilityBar visibleContent] != 0;
      [v10 setVisibleContent:2 animated:animatedCopy & v11];
    }

    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v13 = viewfinderView;
    if (animatedCopy)
    {
      [viewfinderView layoutIfNeeded];
      self->__showingPortraitApertureSlider = sliderCopy;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration zoomFactor:1 animated:?];
      [v13 setNeedsLayout];
      v14 = MEMORY[0x1E69DD250];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __74__CAMViewfinderViewController__setShowingPortraitApertureSlider_animated___block_invoke;
      v15[3] = &unk_1E76F77B0;
      v16 = v13;
      [v14 animateWithDuration:6 delay:v15 options:0 animations:0.25 completion:0.0];

      if (v8)
      {
        [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
      }
    }

    else
    {
      self->__showingPortraitApertureSlider = sliderCopy;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [(CAMViewfinderViewController *)self _updatePortraitApertureButtonForGraphConfiguration:_currentGraphConfiguration zoomFactor:0 animated:?];
      [v13 setNeedsLayout];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Portrait depth slider visibility changed"];
    if (sliderCopy)
    {
      [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0];
      [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0];
    }
  }
}

- (void)_updatePortraitApertureSliderForGraphConfiguration:(id)configuration zoomFactor:(double)factor
{
  configurationCopy = configuration;
  v6 = +[CAMCaptureCapabilities capabilities];
  _portraitApertureSlider = [(CAMViewfinderViewController *)self _portraitApertureSlider];
  if (_portraitApertureSlider)
  {
    apertureSlider = _portraitApertureSlider;
    goto LABEL_6;
  }

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  apertureSlider = [_controlDrawer apertureSlider];

  if (apertureSlider)
  {
LABEL_6:
    device = [configurationCopy device];
    mode = [configurationCopy mode];
    [v6 minimumDepthEffectApertureForMode:mode device:device];
    v14 = v13;
    [v6 maximumDepthEffectApertureForMode:mode device:device];
    v16 = v15;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v18 = v17;
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke;
    aBlock[3] = &unk_1E76F9B28;
    aBlock[5] = v14;
    aBlock[6] = v16;
    aBlock[4] = self;
    aBlock[7] = v17;
    v19 = _Block_copy(aBlock);
    v19[2](v19, apertureSlider);
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    spotlightControlPanel = [_fullscreenViewfinder spotlightControlPanel];
    apertureSlider2 = [spotlightControlPanel apertureSlider];
    v19[2](v19, apertureSlider2);

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    v38[0] = MEMORY[0x1E69E9820];
    v38[1] = 3221225472;
    v38[2] = __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke_2;
    v38[3] = &unk_1E76F9B50;
    v38[4] = self;
    v38[5] = v14;
    v38[6] = v16;
    v38[7] = v18;
    [chromeConfigurator performChanges:v38];

    [apertureSlider apertureValue];
    v25 = v24;
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    viewportAspectRatio = [_fullscreenViewfinder2 viewportAspectRatio];

    if ((viewportAspectRatio - 2) < 5)
    {
LABEL_7:
      v28 = +[CAMCaptureCapabilities capabilities];
      if ([v28 isCinematicModeSupported])
      {
        LODWORD(viewportAspectRatio) = 1;
      }

      else
      {
        v29 = +[CAMCaptureCapabilities capabilities];
        LODWORD(viewportAspectRatio) = [v29 photoModeDepthSuggestionSupported];
      }

      goto LABEL_14;
    }

    if (viewportAspectRatio != 1)
    {
      if (!viewportAspectRatio)
      {
        goto LABEL_7;
      }

      LODWORD(viewportAspectRatio) = 0;
    }

LABEL_14:
    _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
    if ((_layoutStyle - 2) < 2)
    {
      goto LABEL_17;
    }

    if (_layoutStyle == 1)
    {
      [apertureSlider removeGradients];
      v32 = 1;
      v31 = 1;
      goto LABEL_22;
    }

    if (!_layoutStyle)
    {
LABEL_17:
      if (viewportAspectRatio)
      {
        [apertureSlider setTransparentGradients];
        v31 = 0;
        v32 = 1;
LABEL_22:
        [apertureSlider setUseTickMarkLegibilityShadows:v32];
        [apertureSlider setUseTextLegibilityBackgrounds:v31];
        _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
        [_apertureButton setApertureValue:v25];
        _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        controlStatusBar = [_fullscreenViewfinder3 controlStatusBar];
        apertureIndicator = [controlStatusBar apertureIndicator];
        [apertureIndicator setApertureValue:v25];

        goto LABEL_23;
      }

      blackColor = [MEMORY[0x1E69DC888] blackColor];
      [apertureSlider setOpaqueGradientsWithColor:blackColor];
    }

    v32 = 0;
    v31 = 0;
    goto LABEL_22;
  }

  chromeViewController = [(CAMViewfinderViewController *)self chromeViewController];

  if (chromeViewController)
  {
    apertureSlider = 0;
    goto LABEL_6;
  }

LABEL_23:
}

void __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke(uint64_t a1, void *a2)
{
  v3 = *(a1 + 40);
  v4 = *(a1 + 48);
  v5 = a2;
  [v5 setMinimumApertureValueClosestTo:v3 maximumApertureValueClosestTo:v4];
  [*(a1 + 32) _portraitModeApertureValue];
  [v5 setApertureValueClosestTo:?];
  [v5 setMarkedApertureValueClosestTo:*(a1 + 56)];
}

void __93__CAMViewfinderViewController__updatePortraitApertureSliderForGraphConfiguration_zoomFactor___block_invoke_2(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setApertureValueMinimum:v2];

  v4 = *(a1 + 48);
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setApertureValueMaximum:v4];

  v6 = *(a1 + 56);
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setApertureValueMarked:v6];

  [*(a1 + 32) _portraitModeApertureValue];
  v9 = v8;
  v10 = [*(a1 + 32) chromeConfigurator];
  [v10 setApertureValue:v9];
}

- (void)_updatePortraitApertureButtonForGraphConfiguration:(id)configuration zoomFactor:(double)factor animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v34 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  devicePosition = [configurationCopy devicePosition];
  enableDepthSuggestion = [configurationCopy enableDepthSuggestion];

  v12 = [v34 isDepthEffectApertureSupportedForMode:mode devicePosition:devicePosition depthSuggestionEnabled:enableDepthSuggestion];
  v13 = v34;
  if (v12)
  {
    [v34 minimumDepthEffectApertureForMode:mode device:device];
    v15 = v14;
    [v34 maximumDepthEffectApertureForMode:mode device:device];
    v17 = v16;
    [(CAMViewfinderViewController *)self _portraitModeApertureValue];
    v19 = v18;
    [(CAMViewfinderViewController *)self _lastDefaultApertureValue];
    v21 = v20;
    if (v17 >= v19)
    {
      v22 = v19;
    }

    else
    {
      v22 = v17;
    }

    if (v15 < v22)
    {
      v15 = v22;
    }

    _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
    _isShowingPortraitApertureSlider = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlDrawer = [_fullscreenViewfinder controlDrawer];
    if (_isShowingPortraitApertureSlider)
    {
      isApertureSliderVisible = 1;
    }

    else
    {
      isApertureSliderVisible = [_fullscreenViewfinder isApertureSliderVisible];
    }

    if (vabdd_f64(v21, v15) >= 0.0001)
    {
      v28 = isApertureSliderVisible ^ 1;
    }

    else
    {
      v28 = 0;
    }

    [_apertureButton setActive:isApertureSliderVisible animated:animatedCopy];
    [_apertureButton setShouldShowApertureValue:v28 animated:animatedCopy];
    [_apertureButton setApertureValue:v15];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    apertureIndicator = [controlStatusBar apertureIndicator];

    [apertureIndicator setApertureValue:v15];
    [apertureIndicator setShowingValue:v28 animated:animatedCopy];
    apertureButton = [controlDrawer apertureButton];
    [apertureButton setOn:v28];

    controlStatusBar2 = [_fullscreenViewfinder controlStatusBar];
    apertureIndicator2 = [controlStatusBar2 apertureIndicator];
    [apertureIndicator2 setOn:isApertureSliderVisible];

    v13 = v34;
  }

  MEMORY[0x1EEE66BB8](v12, v13);
}

- (void)_apertureSliderDidChangeApertureValue:(id)value
{
  [value apertureValue];

  [(CAMViewfinderViewController *)self handleUserChangedToApertureValue:?];
}

- (void)handleUserChangedToApertureValue:(double)value enableDepthSuggestion:(BOOL)suggestion
{
  suggestionCopy = suggestion;
  [(CAMViewfinderViewController *)self _setPortraitModeApertureValue:?];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToPortraitAperture:value];

  _apertureButton = [(CAMViewfinderViewController *)self _apertureButton];
  [_apertureButton setApertureValue:value];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  apertureIndicator = [controlStatusBar apertureIndicator];
  [apertureIndicator setApertureValue:value];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  [(CAMViewfinderViewController *)self _updatePortraitApertureSliderForGraphConfiguration:_currentGraphConfiguration2 zoomFactor:?];

  v13 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  LODWORD(_currentMode) = [v13 isDepthSuggestionSupportedForMode:_currentMode devicePosition:_currentDevicePosition photoFormat:currentPhotoFormat, v17];

  if (_currentMode && suggestionCopy)
  {
    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:1];
  }
}

- (void)_handleApertureButtonTapped:(id)tapped
{
  v4 = [(CAMViewfinderViewController *)self _isShowingPortraitApertureSlider]^ 1;

  [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:v4 animated:1];
}

- (void)_handleIntensityButtonTapped:(id)tapped
{
  v4 = [(CAMViewfinderViewController *)self _isShowingPortraitIntensitySlider]^ 1;

  [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:v4 animated:1];
}

- (void)_setShowingPortraitIntensitySlider:(BOOL)slider animated:(BOOL)animated
{
  if (self->__showingPortraitIntensitySlider != slider)
  {
    animatedCopy = animated;
    sliderCopy = slider;
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v8 = [(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration];
    if (sliderCopy)
    {
      [(CAMViewfinderViewController *)self _createPortraitIntensitySliderIfNecessary];
      [(CAMViewfinderViewController *)self _updatePortraitIntensitySliderForCurrentState];
      _utilityBar = [(CAMViewfinderViewController *)self _utilityBar];
      v10 = _utilityBar;
      v11 = !v8 && [_utilityBar visibleContent] != 0;
      [v10 setVisibleContent:3 animated:animatedCopy & v11];
    }

    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    v13 = viewfinderView;
    if (animatedCopy)
    {
      [viewfinderView layoutIfNeeded];
      self->__showingPortraitIntensitySlider = sliderCopy;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:1];
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      [v13 setNeedsLayout];
      v14 = MEMORY[0x1E69DD250];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __75__CAMViewfinderViewController__setShowingPortraitIntensitySlider_animated___block_invoke;
      v15[3] = &unk_1E76F77B0;
      v16 = v13;
      [v14 animateWithDuration:6 delay:v15 options:0 animations:0.25 completion:0.0];

      if (v8)
      {
        [(CAMViewfinderViewController *)self _setView:self->__utilityBar hidden:[(CAMViewfinderViewController *)self _shouldHideUtilityBarForGraphConfiguration:_currentGraphConfiguration] delayedInTotalAnimationTime:0.25 normalizedFadeoutDuration:0.7];
      }
    }

    else
    {
      self->__showingPortraitIntensitySlider = sliderCopy;
      [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
      [(CAMViewfinderViewController *)self _updateIntensityButtonForCurrentState];
      [v13 setNeedsLayout];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Portrait intensity slider visibility changed"];
    if (sliderCopy)
    {
      [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:0];
      [(CAMViewfinderViewController *)self _setShowingPortraitApertureSlider:0 animated:animatedCopy];
    }
  }
}

- (void)_updatePortraitIntensitySliderForCurrentState
{
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  intensitySlider = [_controlDrawer intensitySlider];
  v5 = intensitySlider;
  if (intensitySlider)
  {
    _portraitIntensitySlider = intensitySlider;
  }

  else
  {
    _portraitIntensitySlider = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
  }

  v11 = _portraitIntensitySlider;

  v7 = +[CAMCaptureCapabilities capabilities];
  [v7 minimumPortraitEffectIntensity];
  [v11 setMinimumValue:?];
  [v7 defaultPortraitEffectIntensity];
  [v11 setDefaultValue:?];
  [v7 maximumPortraitEffectIntensity];
  [v11 setMaximumValue:?];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [v11 setValue:?];
  clearColor = [MEMORY[0x1E69DC888] clearColor];
  [v11 setBackgroundColor:clearColor];

  _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [_intensityButton setIntensityValue:?];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  [chromeConfigurator setPortraitEffectIntensity:?];
}

- (void)_handleIntensitySliderDidChangeValue:(id)value
{
  valueCopy = value;
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  intensitySlider = [_controlDrawer intensitySlider];
  v6 = intensitySlider;
  if (intensitySlider)
  {
    _portraitIntensitySlider = intensitySlider;
  }

  else
  {
    _portraitIntensitySlider = [(CAMViewfinderViewController *)self _portraitIntensitySlider];
  }

  v8 = _portraitIntensitySlider;

  if (v8 == valueCopy)
  {
    [valueCopy value];
    [(CAMViewfinderViewController *)self handleUserChangedPortraitIntensity:?];
  }
}

- (void)_updateIntensityButtonForCurrentState
{
  [(CAMViewfinderViewController *)self _updateTopBarForLightingType:[(CAMViewfinderViewController *)self portraitModeLightingEffectType]];
  [(CAMViewfinderViewController *)self _portraitModeIntensityValue];
  v4 = v3;
  _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
  [_intensityButton setIntensityValue:v4];

  _intensityButton2 = [(CAMViewfinderViewController *)self _intensityButton];
  [_intensityButton2 setActive:-[CAMViewfinderViewController _isShowingPortraitIntensitySlider](self animated:{"_isShowingPortraitIntensitySlider"), 1}];

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isIntensitySliderVisible = [_fullscreenViewfinder isIntensitySliderVisible];

  v9 = +[CAMCaptureCapabilities capabilities];
  [v9 defaultPortraitEffectIntensity];
  v11 = vabdd_f64(v4, v10) > 0.005;

  intensityButton = [_controlDrawer intensityButton];
  [intensityButton setOn:v11 & (isIntensitySliderVisible ^ 1)];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder2 controlStatusBar];
  intensityIndicator = [controlStatusBar intensityIndicator];
  [intensityIndicator setOn:isIntensitySliderVisible];
}

- (void)handleUserChangedPortraitIntensity:(double)intensity
{
  _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToPortraitLightingEffectStrength:intensity];

  [_intensityButton setIntensityValue:intensity];
  [(CAMViewfinderViewController *)self _setPortraitModeIntensityValue:intensity];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setPortraitEffectIntensity:intensity];
}

- (double)_exposureBiasForMode:(int64_t)mode trueVideoEnabled:(BOOL)enabled
{
  modeCopy = mode;
  if (enabled && [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode]== mode)
  {
    modeCopy = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
  }

  _exposureBiasesByMode = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:modeCopy];
  v8 = [_exposureBiasesByMode objectForKeyedSubscript:v7];
  [v8 floatValue];
  v10 = v9;

  return v10;
}

- (void)_setExposureBias:(double)bias forMode:(int64_t)mode
{
  v8 = [MEMORY[0x1E696AD98] numberWithDouble:bias];
  _exposureBiasesByMode = [(CAMViewfinderViewController *)self _exposureBiasesByMode];
  v7 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  [_exposureBiasesByMode setObject:v8 forKeyedSubscript:v7];
}

- (void)_updateExposureSliderForCurrentState
{
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  exposureSlider = [_controlDrawer exposureSlider];

  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", _currentMode, [_currentGraphConfiguration trueVideoEnabled]);
  v7 = v6;

  [exposureSlider setExposureValueClosestTo:v7];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  spotlightControlPanel = [_fullscreenViewfinder spotlightControlPanel];
  exposureSlider2 = [spotlightControlPanel exposureSlider];
  [exposureSlider2 setExposureValueClosestTo:v7];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setExposureBias:v7];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  viewportAspectRatio = [_fullscreenViewfinder2 viewportAspectRatio];

  v15 = viewportAspectRatio == 4 || viewportAspectRatio == 1;
  [exposureSlider setUseTextLegibilityShadows:v15];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  *&v17 = v7;
  [_previewViewController setBaselineExposureBias:v17];
}

- (void)_handleExposureSliderDidChangeValue:(id)value
{
  [value exposureValue];

  [(CAMViewfinderViewController *)self handleUserChangedExposureSliderBias:?];
}

- (void)handleUserChangedLensPosition:(double)position
{
  [(CAMViewfinderViewController *)self _updateLensPositionLockedByUser:1];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  *&v5 = position;
  [_captureController lockFocusAtLensPosition:0 completionBlock:v5];
}

- (void)handleUserChangedIsLensPositionLocked:(BOOL)locked
{
  lockedCopy = locked;
  [(CAMViewfinderViewController *)self _updateLensPositionLockedByUser:?];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (lockedCopy)
  {
    +[CUCaptureController focusLensPositionCurrentSentinel];
    [_captureController lockFocusAtLensPosition:0 completionBlock:?];
  }

  else
  {
    [_captureController resetFocusAndExposure];
  }
}

- (void)_updateLensPositionLockedByUser:(BOOL)user
{
  userCopy = user;
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  isLensPositionLockedByUser = [chromeConfigurator isLensPositionLockedByUser];

  if (isLensPositionLockedByUser != userCopy)
  {
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setIsLensPositionLockedByUser:userCopy];

    if (userCopy)
    {
      v8 = 2;
    }

    else
    {
      v8 = 0;
    }

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController setPrimaryConstituentDeviceSwitchingBehavior:v8];
  }
}

- (void)_handleUserChangedToExposureSliderBias:(double)bias updateSystemOverlayValues:(BOOL)values
{
  +[CAMExposureSlider minimumValue];
  v7 = v6;
  +[CAMExposureSlider maximumValue];
  v9 = fmin(fmax(v7, bias), v8);
  [(CAMViewfinderViewController *)self _setExposureBias:[(CAMViewfinderViewController *)self _currentMode] forMode:v9];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  *&v7 = v9;
  LODWORD(v12) = LODWORD(v7);
  [_previewViewController setBaselineExposureBias:v12];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder controlStatusBar];
  exposureBiasIndicator = [controlStatusBar exposureBiasIndicator];

  [exposureBiasIndicator setExposureBiasValue:v9];
  [(CAMViewfinderViewController *)self _updateExposureSliderForCurrentState];
  [(CAMViewfinderViewController *)self _updateExposureButtonForCurrentState];
}

- (void)_updateExposureButtonForCurrentState
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _exposureBiasForMode:trueVideoEnabled:](self, "_exposureBiasForMode:trueVideoEnabled:", _currentMode, [_currentGraphConfiguration trueVideoEnabled]);
  v6 = v5;

  v7 = +[CAMUserPreferences preferences];
  LOBYTE(_currentMode) = [v7 preserveExposure];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isExposureSliderVisible = [_fullscreenViewfinder isExposureSliderVisible];

  LODWORD(_fullscreenViewfinder) = [(CAMViewfinderViewController *)self _isExposureBiasNonDefault:v6];
  v10 = isExposureSliderVisible ^ 1;
  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  exposureButton = [_controlDrawer exposureButton];
  [exposureButton setOn:_fullscreenViewfinder & v10];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  controlStatusBar = [_fullscreenViewfinder2 controlStatusBar];
  exposureBiasIndicator = [controlStatusBar exposureBiasIndicator];

  [exposureBiasIndicator setExposureBiasValue:v6];
  [exposureBiasIndicator setExposureValueVisible:(_currentMode | _fullscreenViewfinder) & v10 & 1];
  [(CAMViewfinderViewController *)self _shadowClippingValue];
  [exposureBiasIndicator setShadowClipping:?];
  [(CAMViewfinderViewController *)self _highlightClippingValue];
  [exposureBiasIndicator setHighlightClipping:?];
}

- (unint64_t)_currentSemanticStyleSupport
{
  v3 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v3 smartStylesSupported];
  v5 = [v3 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
  if (smartStylesSupported)
  {
    if ([(CAMViewfinderViewController *)self _wantsLightingControlForMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]]&& [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]]!= 1)
    {
      v5 &= 0xFFFFFFFFFFFFFFF8;
    }

    v6 = -16;
  }

  else
  {
    v6 = -15;
  }

  if ([(CAMViewfinderViewController *)self _resolvedRAWMode]== 1)
  {
    v7 = v6;
  }

  else
  {
    v7 = -1;
  }

  v8 = v7 & v5;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];

  if (isCapturingBurst)
  {
    v11 = v8 & 0xFFFFFFFFFFFFFFF8;
  }

  else
  {
    v11 = v8;
  }

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  isCapturingCTMVideo = [_captureController2 isCapturingCTMVideo];

  if (isCapturingCTMVideo)
  {
    v14 = v11 & 0xFFFFFFFFFFFFFFFDLL;
  }

  else
  {
    v14 = v11;
  }

  return v14;
}

- (id)_semanticStyleForPreview
{
  _currentSemanticStyleSupport = [(CAMViewfinderViewController *)self _currentSemanticStyleSupport];

  return [(CAMViewfinderViewController *)self _semanticStyleForPreviewWithSupport:_currentSemanticStyleSupport];
}

- (id)_semanticStyleForPreviewWithSupport:(unint64_t)support
{
  v5 = +[CAMCaptureCapabilities capabilities];
  _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
  v7 = [v5 captureStyleForPreviewWithSupport:support styles:_semanticStyles selectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self smartStyleSystemStyleIndex:{"_selectedSemanticStyleIndex"), -[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];

  return v7;
}

- (id)_semanticStyleForCapture
{
  _currentSemanticStyleSupport = [(CAMViewfinderViewController *)self _currentSemanticStyleSupport];

  return [(CAMViewfinderViewController *)self _semanticStyleForCaptureWithSupport:_currentSemanticStyleSupport];
}

- (id)_semanticStyleForCaptureWithSupport:(unint64_t)support
{
  v5 = +[CAMCaptureCapabilities capabilities];
  _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
  v7 = [v5 captureStyleForCaptureWithSupport:support styles:_semanticStyles selectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self smartStyleSystemStyleIndex:{"_selectedSemanticStyleIndex"), -[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];

  return v7;
}

- (void)_updateSemanticStyleControlsForCurrentStateAnimated:(BOOL)animated
{
  animatedCopy = animated;
  v5 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v5 smartStylesSupported];

  if ((smartStylesSupported & 1) == 0)
  {
    _semanticStyleForCapture = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    semanticStyleControl = [_controlDrawer semanticStyleControl];
    [semanticStyleControl setSemanticStyle:_semanticStyleForCapture animated:animatedCopy];

    _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    semanticStylePicker = [_fullscreenViewfinder semanticStylePicker];
    [semanticStylePicker setSelectedStyleIndex:_selectedSemanticStyleIndex];

    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    isSemanticStyleControlVisible = [_fullscreenViewfinder2 isSemanticStyleControlVisible];

    if (_semanticStyleForCapture)
    {
      v14 = [_semanticStyleForCapture isNeutral] ^ 1;
    }

    else
    {
      v14 = 0;
    }

    _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder3 controlStatusBar];
    semanticStyleIndicator = [controlStatusBar semanticStyleIndicator];
    [semanticStyleIndicator setSemanticStyle:_semanticStyleForCapture animated:animatedCopy];

    semanticStyleButton = [_controlDrawer semanticStyleButton];
    [semanticStyleButton setSemanticStyle:_semanticStyleForCapture animated:animatedCopy];

    semanticStyleButton2 = [_controlDrawer semanticStyleButton];
    [semanticStyleButton2 setOn:v14 & (isSemanticStyleControlVisible ^ 1u)];

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setSemanticStylePreset:{objc_msgSend(_semanticStyleForCapture, "presetType")}];

    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [_semanticStyleForCapture sceneBias];
    [chromeConfigurator2 setSemanticStyleSceneBias:?];

    chromeConfigurator3 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [_semanticStyleForCapture warmthBias];
    [chromeConfigurator3 setSemanticStyleWarmthBias:?];
  }
}

- (NSArray)_smartStyles
{
  v3 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v3 smartStylesSupported];

  if (smartStylesSupported)
  {
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
  }

  else
  {
    _semanticStyles = 0;
  }

  return _semanticStyles;
}

- (id)_currentSmartStyle
{
  v3 = +[CAMCaptureCapabilities capabilities];
  smartStylesSupported = [v3 smartStylesSupported];

  if (smartStylesSupported)
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    v6 = [v5 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

    v7 = [(CAMViewfinderViewController *)self _semanticStyleForCaptureWithSupport:v6];
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)_updateSmartStyleControlsForCurrentStateAnimateSliders:(BOOL)sliders animateOtherControls:(BOOL)controls
{
  controlsCopy = controls;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 9) != 0)
  {
    HIDWORD(v38) = controlsCopy;
    _currentSmartStyle = [(CAMViewfinderViewController *)self _currentSmartStyle];
    v9 = [(CAMViewfinderViewController *)self _referenceStyleForSmartStyle:_currentSmartStyle];
    v41 = [_currentSmartStyle isEqualToSmartStyle:v9] ^ 1;
    v10 = [(CAMViewfinderViewController *)self _sanitizedLightingTypeForMode:[(CAMViewfinderViewController *)self _currentMode] device:[(CAMViewfinderViewController *)self _currentDevice]];
    v11 = +[CAMCaptureCapabilities capabilities];
    LODWORD(v38) = [v11 smartStylesSupportedForLightingType:v10] ^ 1;

    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    smartStyleNameBadge = [_fullscreenViewfinder smartStyleNameBadge];
    [smartStyleNameBadge setSmartStyle:_currentSmartStyle];

    [CAMSmartStyleUtilities slider2DValueForStyle:_currentSmartStyle limitRangeForSystemStyles:0];
    v15 = v14;
    v17 = v16;
    v42 = v9;
    [CAMSmartStyleUtilities slider2DValueForStyle:v9 limitRangeForSystemStyles:0];
    v19 = v18;
    v21 = v20;
    smartStylePicker = [_fullscreenViewfinder smartStylePicker];
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
    [smartStylePicker setNumberOfStyles:{objc_msgSend(_semanticStyles, "count")}];

    [smartStylePicker setSelectedStyleIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self animated:{"_selectedSemanticStyleIndex"), 0}];
    if ([smartStylePicker numberOfStyles])
    {
      v24 = 0;
      do
      {
        if (v24 == [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex])
        {
          v25 = [MEMORY[0x1E69DCAB8] systemImageNamed:@"dot.square.fill"];
        }

        else
        {
          v25 = 0;
        }

        pageControl = [smartStylePicker pageControl];
        [pageControl setIndicatorImage:v25 forPage:v24];

        ++v24;
      }

      while (v24 < [smartStylePicker numberOfStyles]);
    }

    v27 = HIDWORD(v38);
    [_fullscreenViewfinder setWantsSmartStylePicker:(v7 >> 3) & 1 animated:{HIDWORD(v38), v38}];
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    smartStyleControlsVisible = [_fullscreenViewfinder2 smartStyleControlsVisible];

    if (_currentSmartStyle)
    {
      v30 = [_currentSmartStyle isNeutral] ^ 1;
    }

    else
    {
      v30 = 0;
    }

    smartStyleButton = [_controlDrawer smartStyleButton];
    [smartStyleButton setSmartStyle:_currentSmartStyle animated:v27];

    smartStyleButton2 = [_controlDrawer smartStyleButton];
    [smartStyleButton2 setShowDisabled:v39 animated:v27];

    smartStyleButton3 = [_controlDrawer smartStyleButton];
    [smartStyleButton3 setOn:v30 & (smartStyleControlsVisible ^ 1u)];

    presetType = [_currentSmartStyle presetType];
    smartStyleCategoryInstructionLabel = [_fullscreenViewfinder smartStyleCategoryInstructionLabel];
    [smartStyleCategoryInstructionLabel setPresetType:presetType];

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    v43[0] = MEMORY[0x1E69E9820];
    v43[1] = 3221225472;
    v43[2] = __107__CAMViewfinderViewController__updateSmartStyleControlsForCurrentStateAnimateSliders_animateOtherControls___block_invoke;
    v43[3] = &unk_1E76F9B78;
    v45 = v15;
    v46 = v17;
    v47 = v19;
    v48 = v21;
    v43[4] = self;
    v44 = _currentSmartStyle;
    v49 = v41;
    v50 = v39;
    v37 = _currentSmartStyle;
    [chromeConfigurator performChanges:v43];
  }
}

void __107__CAMViewfinderViewController__updateSmartStyleControlsForCurrentStateAnimateSliders_animateOtherControls___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 48);
  v3 = *(a1 + 56);
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setSmartStyleDPadValue:{v2, v3}];

  v5 = *(a1 + 64);
  v6 = *(a1 + 72);
  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setSmartStyleDPadDefaultValue:{v5, v6}];

  v8 = [*(a1 + 40) castType];
  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setSmartStyleCastType:v8];

  v10 = [*(a1 + 40) presetType];
  v11 = [*(a1 + 32) chromeConfigurator];
  [v11 setSmartStylePresetType:v10];

  [*(a1 + 40) castIntensity];
  v13 = v12;
  v14 = [*(a1 + 32) chromeConfigurator];
  [v14 setSmartStyleCastIntensity:v13];

  v15 = *(a1 + 80);
  v16 = [*(a1 + 32) chromeConfigurator];
  [v16 setIsSmartStyleCustomized:v15];

  v17 = *(a1 + 81);
  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setIsSmartStyleDisabled:v17];

  v19 = [*(a1 + 40) castType];
  v23 = +[CAMUserPreferences preferences];
  v20 = [v23 lastReadSystemStyle];
  v21 = v19 == [v20 castType];
  v22 = [*(a1 + 32) chromeConfigurator];
  [v22 setSmartStyleIsUsersSystemStyle:v21];
}

- (id)_referenceStyleForSmartStyle:(id)style
{
  styleCopy = style;
  _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
  v6 = [_semanticStyles indexOfObject:styleCopy];

  if (v6 == 0x7FFFFFFFFFFFFFFFLL || v6 != [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex])
  {
    lastReadSystemStyle = [objc_alloc(MEMORY[0x1E6993890]) initWithPresetType:{objc_msgSend(styleCopy, "presetType")}];
  }

  else
  {
    v7 = +[CAMUserPreferences preferences];
    lastReadSystemStyle = [v7 lastReadSystemStyle];
  }

  return lastReadSystemStyle;
}

- (void)_handleSemanticStyleControlDidChangeValue:(id)value
{
  semanticStyle = [value semanticStyle];
  [(CAMViewfinderViewController *)self _handleUserChangedSemanticStyle:semanticStyle];
}

- (void)_handleUserChangedSemanticStyle:(id)style
{
  styleCopy = style;
  _semanticStyleForCapture = [(CAMViewfinderViewController *)self _semanticStyleForCapture];
  if (_semanticStyleForCapture)
  {
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
    [_semanticStyles replaceObjectAtIndex:-[CAMViewfinderViewController _selectedSemanticStyleIndex](self withObject:{"_selectedSemanticStyleIndex"), styleCopy}];
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder reloadSemanticStyleBadgesDelayIfNeeded:1];

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder2 requestPreviewUpdateForSemanticStyleAnimated:0];
}

- (void)_updatePreviewSemanticStyleAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder requestPreviewUpdateForSemanticStyleAnimated:animatedCopy];
}

- (void)_updateSmartStyleOnSession
{
  v5 = +[CAMCaptureCapabilities capabilities];
  if ([v5 smartStylesSupported] && !-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") && !-[CAMViewfinderViewController _hasInFlightConfiguration](self, "_hasInFlightConfiguration") && -[CAMViewfinderViewController _completedInitialConfiguration](self, "_completedInitialConfiguration"))
  {
    _semanticStyleForPreview = [(CAMViewfinderViewController *)self _semanticStyleForPreview];
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController changeToSmartStyle:_semanticStyleForPreview];
  }
}

- (void)_handleSmartStylePickerSwipe:(id)swipe
{
  swipeCopy = swipe;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  smartStylePicker = [_fullscreenViewfinder smartStylePicker];

  effectiveUserInterfaceLayoutDirection = [smartStylePicker effectiveUserInterfaceLayoutDirection];
  selectedStyleIndex = [smartStylePicker selectedStyleIndex];
  if ([swipeCopy direction] == 1)
  {
    if (effectiveUserInterfaceLayoutDirection == 1)
    {
      v8 = 1;
    }

    else
    {
      v8 = -1;
    }

    v9 = v8 + selectedStyleIndex;
    if (v8 + selectedStyleIndex < 0)
    {
      goto LABEL_15;
    }

    goto LABEL_13;
  }

  direction = [swipeCopy direction];
  v11 = selectedStyleIndex - 1;
  if (effectiveUserInterfaceLayoutDirection != 1)
  {
    v11 = selectedStyleIndex + 1;
  }

  if (direction == 2)
  {
    v9 = v11;
  }

  else
  {
    v9 = selectedStyleIndex;
  }

  if ((v9 & 0x8000000000000000) == 0)
  {
LABEL_13:
    if (v9 < [smartStylePicker numberOfStyles])
    {
      [smartStylePicker setSelectedStyleIndex:v9 animated:1];
      [(CAMViewfinderViewController *)self _updateSelectedSmartStyleFromPicker];
    }
  }

LABEL_15:
}

- (id)_targetLightingControl
{
  _lightingControl = [(CAMViewfinderViewController *)self _lightingControl];
  if (!_lightingControl)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    _lightingControl = [_fullscreenViewfinder lightingControl];
  }

  return _lightingControl;
}

- (void)_updateLightingUIForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [configurationCopy device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  v9 = -[CAMViewfinderViewController _sanitizedLightingTypeForMode:device:](self, "_sanitizedLightingTypeForMode:device:", [configurationCopy mode], objc_msgSend(configurationCopy, "device"));
  if ([v6 isLightingControlSupportedForMode:{objc_msgSend(configurationCopy, "mode")}])
  {
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    [_previewViewController setLightingType:v9];
  }

  if ([(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:configurationCopy])
  {
    _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
    _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v14 = _fullscreenViewfinder;
    if (!_lightingNameBadge)
    {
      _lightingNameBadge = [_fullscreenViewfinder lightingNameBadge];
    }

    if (v9)
    {
      [_lightingNameBadge setLightingType:v9];
    }

    [_targetLightingControl setLightingEffectSet:objc_msgSend(v6 animated:{"supportedEffectSetForDevicePosition:", v8), animatedCopy}];
    [_targetLightingControl setSelectedLightingType:v9 animated:animatedCopy];
    v15 = [(CAMViewfinderViewController *)self _lightingControlLayoutPositionForGraphConfiguration:configurationCopy];
    if (v15 == 2)
    {
      v16 = 2;
    }

    else
    {
      v16 = v15 == 1;
    }

    [_targetLightingControl setCollapsedSelectionCenterPointEdgeInset:44.0];
    [_targetLightingControl setCollapsedControlLocation:v16 animated:animatedCopy];
  }
}

- (int64_t)_sanitizedLightingTypeForMode:(int64_t)mode device:(int64_t)device
{
  if ((device - 1) > 0xA)
  {
    v6 = 0;
  }

  else
  {
    v6 = qword_1A3A685B0[device - 1];
  }

  v7 = +[CAMCaptureCapabilities capabilities];
  if ([(CAMViewfinderViewController *)self _canUseFilteringForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]]&& [(CAMViewfinderViewController *)self _wantsLightingControlForMode:mode devicePosition:v6])
  {
    portraitModeLightingEffectType = [(CAMViewfinderViewController *)self portraitModeLightingEffectType];
    v9 = [v7 supportedEffectSetForDevicePosition:v6];
    if (v9 > 3)
    {
      v10 = 0;
    }

    else
    {
      v10 = qword_1E76FA000[v9];
    }

    v12 = [MEMORY[0x1E696AD98] numberWithInteger:portraitModeLightingEffectType];
    v13 = [v10 containsObject:v12];

    if ((v13 & 1) == 0)
    {
      portraitModeLightingEffectType = [CAMUserPreferences defaultLightingTypeForMode:mode];
    }
  }

  else
  {
    portraitModeLightingEffectType = 0;
  }

  return portraitModeLightingEffectType;
}

- (void)_setLightingType:(int64_t)type forMode:(int64_t)mode
{
  v12 = *MEMORY[0x1E69E9840];
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isLightingControlSupportedForMode:mode];

  if (v8)
  {
    [(CAMViewfinderViewController *)self setPortraitModeLightingEffectType:type];
  }

  else if (type)
  {
    v9 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = 134217984;
      modeCopy = mode;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Trying to set filter type on unhandled mode %ld", &v10, 0xCu);
    }
  }

  [(CAMViewfinderViewController *)self _updateTopBarForLightingType:type];
}

- (void)_updateTopBarForLightingType:(int64_t)type
{
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isPortraitEffectIntensitySupportedForLightingType:type];

  _topBar = [(CAMViewfinderViewController *)self _topBar];
  v8 = _topBar;
  if (v6)
  {
    _intensityButton = [(CAMViewfinderViewController *)self _intensityButton];

    [(CAMViewfinderViewController *)self _createIntensityButtonIfNecessary];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v11 = [(CAMViewfinderViewController *)self _shouldHideIntensityButtonForGraphConfiguration:_currentGraphConfiguration];

    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __60__CAMViewfinderViewController__updateTopBarForLightingType___block_invoke;
    v18[3] = &unk_1E76F7850;
    v18[4] = self;
    v19 = v11;
    [MEMORY[0x1E69DD250] animateWithDuration:v18 animations:0.25];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setIsPortraitEffectIntensitySliderSupported:!v11];

    _intensityButton2 = [(CAMViewfinderViewController *)self _intensityButton];
    if (_intensityButton)
    {
      intensityButton = [v8 intensityButton];

      _intensityButton3 = [(CAMViewfinderViewController *)self _intensityButton];
      [v8 setIntensityButton:_intensityButton3];

      if (_intensityButton2 == intensityButton)
      {
        goto LABEL_9;
      }
    }

    else
    {
      [v8 setIntensityButton:_intensityButton2];
    }
  }

  else
  {
    intensityButton2 = [_topBar intensityButton];

    [v8 setIntensityButton:0];
    [(CAMViewfinderViewController *)self _setShowingPortraitIntensitySlider:0 animated:1];
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator2 setIsPortraitEffectIntensitySliderSupported:0];

    if (!intensityButton2)
    {
      goto LABEL_9;
    }
  }

  [v8 configureForMode:-[CAMViewfinderViewController _currentMode](self animated:{"_currentMode"), 1}];
LABEL_9:
}

void __60__CAMViewfinderViewController__updateTopBarForLightingType___block_invoke(uint64_t a1)
{
  v1 = (*(a1 + 40) ^ 1u);
  v2 = [*(a1 + 32) _intensityButton];
  [v2 setAlpha:v1];
}

- (void)_updateLightingControlFadesForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
  mode = [configurationCopy mode];
  if (mode == 6)
  {
    if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy])
    {
      _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
      isPlatterExpanded = [_zoomControl isPlatterExpanded];

      v8 = 0;
      if (isPlatterExpanded)
      {
        v9 = 2;
      }

      else
      {
        v9 = 1;
      }
    }

    else
    {
      v8 = 0;
      v9 = 0;
    }
  }

  else
  {
    if (mode)
    {
      v8 = 0;
    }

    else
    {
      v8 = 2;
    }

    if (mode)
    {
      v9 = 0;
    }

    else
    {
      v9 = 2;
    }
  }

  [_targetLightingControl setCollapsedItemFading:v9 animated:{v8, animatedCopy}];
}

- (void)_applySelectedEffectFilterType:(int64_t)type
{
  [(CAMViewfinderViewController *)self _setEffectFilterType:type forMode:[(CAMViewfinderViewController *)self _currentMode]];
  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateChromeFilterScrubberForGraphConfiguration:_currentGraphConfiguration];

  [(CAMViewfinderViewController *)self _updateFilterButtonOnState];

  [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:1];
}

- (BOOL)_isNightModeUpdatingDeferred
{
  _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];
  v4 = _currentStillImageCaptureMomentSettings != 0;

  return (v4 | [(CAMViewfinderViewController *)self _isNightModeCaptureCanceling]) & 1;
}

- (void)_updateNightModeSlider
{
  if (![(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    nightModeSlider = [_controlDrawer nightModeSlider];

    [nightModeSlider setNightMode:{-[CAMViewfinderViewController _resolvedNightModeControlMode](self, "_resolvedNightModeControlMode")}];
    [(CAMViewfinderViewController *)self _nightModeDurationMapping];
    [nightModeSlider setDurationMapping:?];
    [nightModeSlider setNightModeActive:{-[CAMViewfinderViewController _isNightModeActiveForCurrentSettings](self, "_isNightModeActiveForCurrentSettings")}];
  }
}

- (void)_updateNightModeControlsAnimated:(BOOL)animated
{
  animatedCopy = animated;
  if (![(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    _resolvedNightMode = [(CAMViewfinderViewController *)self _resolvedNightMode];
    v6 = [(CAMViewfinderViewController *)self _resolvedNightModeControlMode]== 0;
    _isNightModeActiveForCurrentSettings = [(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings];
    _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
    nightModeButton = [_controlDrawer nightModeButton];
    [nightModeButton setOn:_isNightModeActiveForCurrentSettings];
    [nightModeButton setDisabled:v6 animated:animatedCopy];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    controlStatusBar = [_fullscreenViewfinder controlStatusBar];
    nightModeIndicator = [controlStatusBar nightModeIndicator];

    [nightModeIndicator setShowingValue:_isNightModeActiveForCurrentSettings animated:animatedCopy];
    [nightModeIndicator setNightMode:_resolvedNightMode];
    [nightModeIndicator setNightModeDisabled:v6 animated:animatedCopy];
    if (_isNightModeActiveForCurrentSettings)
    {
      [(CAMViewfinderViewController *)self _nightModeDurationMapping];
      if (_resolvedNightMode != 1)
      {
        v13 = 0.0;
      }

      if (_resolvedNightMode == 2)
      {
        v13 = v14;
      }

      [nightModeIndicator setDuration:v13];
    }

    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    v16[0] = MEMORY[0x1E69E9820];
    v16[1] = 3221225472;
    v16[2] = __64__CAMViewfinderViewController__updateNightModeControlsAnimated___block_invoke;
    v16[3] = &unk_1E76F77B0;
    v16[4] = self;
    [chromeConfigurator performChanges:v16];
  }
}

void __64__CAMViewfinderViewController__updateNightModeControlsAnimated___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _resolvedNightModeControlMode];
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setNightModeControlMode:v2];

  v4 = [*(a1 + 32) _resolvedNightMode];
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setNightModeCaptureState:v4];

  v6 = [*(a1 + 32) _captureController];
  v7 = [v6 nightModeStatus];
  v8 = [*(a1 + 32) chromeConfigurator];
  [v8 setNightModeStatus:v7];

  [*(a1 + 32) _nightModeDurationMapping];
  v10 = v9;
  v12 = v11;
  v13 = [*(a1 + 32) chromeConfigurator];
  [v13 setNightModeDurationMapping:{v10, v12}];
}

- (void)_handleNightModeSliderDidChangeValue:(id)value
{
  nightMode = [value nightMode];

  [(CAMViewfinderViewController *)self handleUserChangedToNightMode:nightMode];
}

- (void)handleUserChangedToNightMode:(unint64_t)mode
{
  if ([(CAMViewfinderViewController *)self _resolvedNightModeControlMode]!= mode)
  {
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __60__CAMViewfinderViewController_handleUserChangedToNightMode___block_invoke;
    v6[3] = &__block_descriptor_40_e22_v16__0__CAMTextBadge_8l;
    v6[4] = mode;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }

  [(CAMViewfinderViewController *)self _setDesiredNightModeControlMode:mode];
  if (mode)
  {
    _nightModeConflicts = [(CAMViewfinderViewController *)self _nightModeConflicts];
    [(CAMViewfinderViewController *)self _setNightModeConflicts:0];
    [(CAMViewfinderViewController *)self _updateStateForClearedNightModeConflicts:_nightModeConflicts];
  }

  [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
}

- (void)_updateStateForClearedNightModeConflicts:(unint64_t)conflicts
{
  if ((conflicts & 8) != 0)
  {
    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:0];
  }
}

- (void)_updateNightModePhotoModeDepthConflictAndPerformResolution:(BOOL)resolution
{
  resolutionCopy = resolution;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  if ([CAMConflictingControlConfiguration isNightModePhotoModeDepthConflictRelevantForMode:mode device:device photoFormat:currentPhotoFormat, v8])
  {
    [(CAMViewfinderViewController *)self _updateNightModeConflict:8 isConflicting:[(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion] performResolution:resolutionCopy];
  }
}

- (void)_resetNightModeDurationMappingAnimated:(BOOL)animated
{
  animatedCopy = animated;
  [(CAMViewfinderViewController *)self _setNightModeDurationMapping:1.0, 5.0];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:animatedCopy];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration isCapturing:0 animated:animatedCopy];
}

- (BOOL)_isExpectedNightModeDurationCancelable
{
  _resolvedNightMode = [(CAMViewfinderViewController *)self _resolvedNightMode];
  [(CAMViewfinderViewController *)self _nightModeDurationMapping];
  if (_resolvedNightMode != 1)
  {
    v4 = 0.0;
  }

  if (_resolvedNightMode == 2)
  {
    v4 = v5;
  }

  return v4 > 3.5;
}

- (void)_updateResolvedNightModeAnimated:(BOOL)animated
{
  animatedCopy = animated;
  v31 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _isNightModeUpdatingDeferred])
  {
    return;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  nightModeStatus = [_captureController nightModeStatus];
  v28 = _captureController;
  if (nightModeStatus == 2)
  {
    v7 = 1;
LABEL_8:
    LODWORD(v27) = v7;
    goto LABEL_9;
  }

  if (nightModeStatus != 1)
  {
    if (nightModeStatus != -1)
    {
      v27 = 0;
      goto LABEL_11;
    }

    v7 = [(CAMViewfinderViewController *)self _resolvedNightMode]!= 0;
    goto LABEL_8;
  }

  LODWORD(v27) = 0;
  v7 = 1;
LABEL_9:
  HIDWORD(v27) = v7;
LABEL_11:
  [(CAMViewfinderViewController *)self _updateNightModePhotoModeDepthConflictAndPerformResolution:0];
  _desiredNightModeControlMode = [(CAMViewfinderViewController *)self _desiredNightModeControlMode];
  _nightModeConflicts = [(CAMViewfinderViewController *)self _nightModeConflicts];
  _resolvedFlashMode = [(CAMViewfinderViewController *)self _resolvedFlashMode];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v15 = v14;
  LOBYTE(v26) = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v16 = [CAMConflictingControlConfiguration resolveDesiredNightModeControlMode:_desiredNightModeControlMode nightModeConflicts:_nightModeConflicts resolvedFlashMode:_resolvedFlashMode captureMode:_currentMode captureDevice:_currentDevice photoFormat:currentPhotoFormat depthEffectEnabledFromSuggestion:v15, v26];
  v17 = +[CAMCaptureCapabilities capabilities];
  LODWORD(_desiredNightModeControlMode) = [v17 isNightModeSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  v18 = 0;
  if (_desiredNightModeControlMode)
  {
    v19 = v28;
    if (HIDWORD(v27) && v16)
    {
      v18 = [v28 isCapturingBurst] ^ 1;
    }
  }

  else
  {
    v19 = v28;
  }

  if (v16 == 2)
  {
    if (v18)
    {
      v20 = 2;
    }

    else
    {
      v20 = 0;
    }
  }

  else if (v16 == 1 && (v18 & v27) == 1)
  {
    v20 = [v19 isCapturingLivePhotoVideo] ^ 1;
  }

  else
  {
    v20 = 0;
  }

  if (v20 != [(CAMViewfinderViewController *)self _resolvedNightMode])
  {
    v21 = os_log_create("com.apple.camera", "NightMode");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v22 = off_1E76FA020[v20];
      *buf = 138543362;
      v30 = v22;
      _os_log_impl(&dword_1A3640000, v21, OS_LOG_TYPE_DEFAULT, "Resolved NightMode: %{public}@", buf, 0xCu);
    }

    _captureController2 = [(CAMViewfinderViewController *)self _captureController];
    [_captureController2 changeToNightMode:v20];
  }

  [(CAMViewfinderViewController *)self _setResolvedNightMode:v20];
  [(CAMViewfinderViewController *)self _setResolvedNightModeControlMode:v16];
  [(CAMViewfinderViewController *)self _updateNightModeSlider];
  [(CAMViewfinderViewController *)self _updateNightModeControlsAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateControlsDisabledByNightModeAnimated:animatedCopy];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateShutterButtonForGraphConfiguration:_currentGraphConfiguration2 isCapturing:0 animated:animatedCopy];
}

- (int64_t)_nightModeForMode:(int64_t)mode captureMode:(int64_t)captureMode device:(int64_t)device isBurst:(BOOL)burst
{
  v11 = +[CAMCaptureCapabilities capabilities];
  v12 = [v11 isNightModeSupportedForMode:captureMode device:device];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingVideo] & 1) != 0 || (objc_msgSend(_captureController, "isCapturingPanorama") & 1) != 0 || (objc_msgSend(_captureController, "isCapturingBurst"))
  {
    isCapturingTimelapse = 1;
  }

  else
  {
    isCapturingTimelapse = [_captureController isCapturingTimelapse];
  }

  if (isCapturingTimelapse & 1 | ((v12 & 1) == 0) | burst)
  {
    mode = 0;
  }

  return mode;
}

- (void)_updateNightModeConflict:(unint64_t)conflict isConflicting:(BOOL)conflicting performResolution:(BOOL)resolution
{
  resolutionCopy = resolution;
  conflictingCopy = conflicting;
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isNightModeSupportedForMode:-[CAMViewfinderViewController _currentMode](self device:{"_currentMode"), -[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];

  if (v10)
  {
    _nightModeConflicts = [(CAMViewfinderViewController *)self _nightModeConflicts];
    v12 = conflictingCopy ? _nightModeConflicts | conflict : _nightModeConflicts & ~conflict;
    [(CAMViewfinderViewController *)self _setNightModeConflicts:v12];
    if (resolutionCopy)
    {

      [(CAMViewfinderViewController *)self _updateResolvedNightModeAnimated:1];
    }
  }
}

- (BOOL)_isNightModeCaptureCanceling
{
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v3 = [_closedViewfinderController hasClosedViewfinderReason:11];

  return v3;
}

- (void)_updateControlsDisabledByNightModeAnimated:(BOOL)animated
{
  animatedCopy = animated;
  [(CAMViewfinderViewController *)self _updateFlashButtonForMode:[(CAMViewfinderViewController *)self _currentMode] animated:animated];
  [(CAMViewfinderViewController *)self _updateLivePhotoButtonAnimated:animatedCopy];

  [(CAMViewfinderViewController *)self _updateHDRButtonAnimated:animatedCopy];
}

- (void)_updateFlipAspectRatioButtonForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v7 = -[CAMViewfinderViewController _resolvedFlipAspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_resolvedFlipAspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", [configurationCopy mode], objc_msgSend(configurationCopy, "videoConfiguration"), objc_msgSend(configurationCopy, "devicePosition"), objc_msgSend(configurationCopy, "trueVideoEnabled"));
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  v10 = ([(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:mode devicePosition:devicePosition]- 3) < 2 || v7;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  flipAspectRatioButton = [_fullscreenViewfinder flipAspectRatioButton];
  [flipAspectRatioButton setActive:v10 animated:animatedCopy];
}

- (void)_handleFlipAspectRatioButtonTapped:(id)tapped
{
  v4 = [(CAMViewfinderViewController *)self _wantsFlipAspectRatio]^ 1;

  [(CAMViewfinderViewController *)self handleUserChangedFlippedAspectRatioEnabled:v4];
}

- (void)handleUserChangedFlippedAspectRatioEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v24 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _isReconfiguring])
  {
    goto LABEL_5;
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([_fullscreenViewfinder isReticleAnimating])
  {

    goto LABEL_5;
  }

  _isZooming = [(CAMViewfinderViewController *)self _isZooming];

  if (_isZooming)
  {
LABEL_5:
    _currentGraphConfiguration = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(_currentGraphConfiguration, OS_LOG_TYPE_DEFAULT))
    {
      _isReconfiguring = [(CAMViewfinderViewController *)self _isReconfiguring];
      _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      v19[0] = 67109632;
      v19[1] = _isReconfiguring;
      v20 = 1024;
      isReticleAnimating = [_fullscreenViewfinder2 isReticleAnimating];
      v22 = 1024;
      _isZooming2 = [(CAMViewfinderViewController *)self _isZooming];
      _os_log_impl(&dword_1A3640000, _currentGraphConfiguration, OS_LOG_TYPE_DEFAULT, "Ignoring request to flip aspect ratio - reconfiguring: %d reticleAnimating: %d zooming: %d", v19, 0x14u);
    }

LABEL_7:

    return;
  }

  _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

  if (!_currentStillImageCaptureMomentSettings && ![(CAMViewfinderViewController *)self _trueVideoIsActive])
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v11 = +[CAMCaptureCapabilities capabilities];
    v12 = [v11 isDynamicAspectRatioSupportedForMode:-[NSObject mode](_currentGraphConfiguration videoConfiguration:"mode") devicePosition:{-[NSObject videoConfiguration](_currentGraphConfiguration, "videoConfiguration"), -[NSObject devicePosition](_currentGraphConfiguration, "devicePosition")}];

    v13 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:[_currentGraphConfiguration mode] devicePosition:[_currentGraphConfiguration devicePosition]];
    if (v12)
    {
      [(CAMViewfinderViewController *)self set_wantsFlipAspectRatio:enabledCopy];
      _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      flipAspectRatioButton = [_fullscreenViewfinder3 flipAspectRatioButton];
      [flipAspectRatioButton setActive:-[CAMViewfinderViewController _wantsFlipAspectRatio](self animated:{"_wantsFlipAspectRatio"), 1}];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _currentMode]];
    }

    else
    {
      v16 = v13;
      if (v13)
      {
        if ([(CAMViewfinderViewController *)self _delaySmartFramingDynamicAspectRatioUpdate])
        {
          v17 = os_log_create("com.apple.camera", "SmartFraming");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
          {
            LOWORD(v19[0]) = 0;
            _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Ignoring request to flip aspect ratio - smart framing is in transition", v19, 2u);
          }
        }

        else
        {
          if (v16 <= 4)
          {
            [(CAMViewfinderViewController *)self set_desiredFieldOfView:qword_1A3A68518[v16 - 1]];
          }

          _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration2 animated:1];

          [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
        }
      }
    }

    goto LABEL_7;
  }
}

- (BOOL)_resolvedFlipAspectRatioForMode:(int64_t)mode videoConfiguration:(int64_t)configuration devicePosition:(int64_t)position trueVideoEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v11 = +[CAMCaptureCapabilities capabilities];
  LODWORD(configuration) = [v11 isDynamicAspectRatioSupportedForMode:mode videoConfiguration:configuration devicePosition:position];

  if (!configuration)
  {
    return 0;
  }

  if (enabledCopy)
  {
    return ([(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode] devicePosition:position]- 3) < 2;
  }

  return [(CAMViewfinderViewController *)self _wantsFlipAspectRatio];
}

- (BOOL)_shouldShowFlipAspectRatioButtonForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 isDynamicAspectRatioSupportedForMode:objc_msgSend(configurationCopy videoConfiguration:"mode") devicePosition:{objc_msgSend(configurationCopy, "videoConfiguration"), objc_msgSend(configurationCopy, "devicePosition")}];

  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = [v7 isSmartFramingSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];

  v9 = [(CAMViewfinderViewController *)self _shouldShowPreviewOverlayButtonForGraphConfiguration:configurationCopy];
  v10 = v9;
  if (!v8)
  {
    if ((v6 & v9) == 1)
    {
      v13 = ![(CAMViewfinderViewController *)self _trueVideoIsActive];
      goto LABEL_7;
    }

LABEL_6:
    v13 = 0;
    goto LABEL_7;
  }

  v11 = -[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition")));
  v12 = [(CAMViewfinderViewController *)self _shouldHideZoomControlForGraphConfiguration:configurationCopy];
  if (!v10 || !v11)
  {
    goto LABEL_6;
  }

  v13 = ![(CAMViewfinderViewController *)self _trueVideoIsActive]&& !v12;
LABEL_7:

  return v13 & 1;
}

- (void)_resetDynamicAspectRatio
{
  if ([(CAMViewfinderViewController *)self _wantsFlipAspectRatio])
  {
    [(CAMViewfinderViewController *)self set_wantsFlipAspectRatio:0];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    flipAspectRatioButton = [_fullscreenViewfinder flipAspectRatioButton];
    [flipAspectRatioButton setActive:0 animated:1];

    _currentMode = [(CAMViewfinderViewController *)self _currentMode];

    [(CAMViewfinderViewController *)self handleUserChangedToMode:_currentMode];
  }
}

- (void)_updateAutoMacroStatus
{
  v14 = +[CAMCaptureCapabilities capabilities];
  if ([v14 isSuperWideAutoMacroSupported])
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    preferredPrimaryConstituentDeviceType = [_captureController preferredPrimaryConstituentDeviceType];
    activePrimaryConstituentDeviceType = [_captureController activePrimaryConstituentDeviceType];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v7 = v6;
    [v14 superWideToWideZoomFactorForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];
    v9 = v7 < v8;
    v10 = v7 >= v8 && preferredPrimaryConstituentDeviceType == 1;
    v11 = v7 >= v8 && activePrimaryConstituentDeviceType == 1;
    [(CAMViewfinderViewController *)self _setAutoMacroActive:v11];
    _shouldIgnoreZoomFactorKVOForRamping = [(CAMViewfinderViewController *)self _shouldIgnoreZoomFactorKVOForRamping];
    if (v10 != [(CAMViewfinderViewController *)self _autoMacroSuggested]&& (v9 || !_shouldIgnoreZoomFactorKVOForRamping))
    {
      [(CAMViewfinderViewController *)self _setAutoMacroSuggested:v10];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

      [(CAMViewfinderViewController *)self _updateAutoMacroButton];
    }
  }
}

- (void)_updateAutoMacroButton
{
  [(CAMViewfinderViewController *)self _desiredMacroMode];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setMacroMode:{-[CAMViewfinderViewController _desiredMacroMode](self, "_desiredMacroMode")}];
}

- (void)_updateMacroButtonState
{
  if (![(CAMViewfinderViewController *)self _desiredMacroMode])
  {
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    isLensPositionLockedByUser = [chromeConfigurator isLensPositionLockedByUser];

    if (isLensPositionLockedByUser)
    {
      [(CAMViewfinderViewController *)self handleUserChangedIsLensPositionLocked:0];
    }
  }

  [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];

  [(CAMViewfinderViewController *)self _updateAutoMacroButton];
}

- (void)_updateResolvedMacroModeAndUpdateFallbackPrimaryConstituentDeviceSelection:(BOOL)selection
{
  HIDWORD(v14) = selection;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v6 = v5;
  _desiredMacroMode = [(CAMViewfinderViewController *)self _desiredMacroMode];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  videoStabilizationStrength = [_currentGraphConfiguration videoStabilizationStrength];
  _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  BYTE1(v14) = [_currentGraphConfiguration frontRearSimultaneousVideoEnabled];
  LOBYTE(v14) = _depthEffectEnabledFromSuggestion;
  v13 = [CAMConflictingControlConfiguration resolveDesiredMacroMode:_desiredMacroMode forMode:mode device:device videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength photoFormat:currentPhotoFormat optionalDepthEffectEnabled:v6 frontRearSimultaneousVideoEnabled:v14];
  if (v13 != [(CAMViewfinderViewController *)self _resolvedMacroMode])
  {
    [(CAMViewfinderViewController *)self _setResolvedMacroMode:v13];
    if (v15)
    {
      [(CAMViewfinderViewController *)self _updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController];
    }
  }
}

- (void)_updateFallbackPrimaryConstituentDeviceSelectionOnCaptureController
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = +[CAMCaptureCapabilities capabilities];
  v4 = [v3 fallbackPrimaryConstituentDeviceSelectionForMode:objc_msgSend(_currentGraphConfiguration device:"mode") videoConfiguration:objc_msgSend(_currentGraphConfiguration videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:objc_msgSend(_currentGraphConfiguration macroMode:{"videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength"), objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled"), -[CAMViewfinderViewController _resolvedMacroMode](self, "_resolvedMacroMode")}];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController setFallbackPrimaryConstituentDeviceSelection:v4];
}

- (BOOL)_depthEffectEnabledFromSuggestion
{
  if (self->__depthEffectEnabledFromSuggestion)
  {
    return 1;
  }

  v3 = +[CAMCaptureCapabilities capabilities];
  featureDevelopmentForceDepthEffectInPhotoMode = [v3 featureDevelopmentForceDepthEffectInPhotoMode];

  return featureDevelopmentForceDepthEffectInPhotoMode;
}

- (void)_updateDepthEffectSuggestionButton
{
  if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
  {
    _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
    if (_shallowDepthOfFieldStatus <= 0xE && ((1 << _shallowDepthOfFieldStatus) & 0x6202) != 0 || [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 11)
    {
      v4 = 1;
    }

    else if ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]== 12)
    {
      v4 = 1;
    }

    else
    {
      v4 = 2;
    }
  }

  else
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v6 = [(CAMViewfinderViewController *)self _shouldDisableDepthSuggestionForNightModeForConfiguration:_currentGraphConfiguration];

    if (v6)
    {
      v4 = 3;
    }

    else
    {
      v4 = 0;
    }
  }

  v7 = +[CAMCaptureCapabilities capabilities];
  if (([v7 isDepthSuggestionSupportedForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), 0}] & 1) != 0 || objc_msgSend(v7, "isDepthSuggestionSupportedForMode:devicePosition:", -[CAMViewfinderViewController _currentMode](self, "_currentMode"), 1))
  {
    v8 = +[CAMUserPreferences preferences];
    shouldUseDepthSuggestionInPhotoMode = [v8 shouldUseDepthSuggestionInPhotoMode];
  }

  else
  {
    shouldUseDepthSuggestionInPhotoMode = 0;
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __65__CAMViewfinderViewController__updateDepthEffectSuggestionButton__block_invoke;
  v11[3] = &unk_1E76F9BA0;
  v12 = shouldUseDepthSuggestionInPhotoMode;
  v11[4] = self;
  v11[5] = v4;
  [chromeConfigurator performChanges:v11];
}

void __65__CAMViewfinderViewController__updateDepthEffectSuggestionButton__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) chromeConfigurator];
  [v2 setIsDepthInPhotoSupported:*(a1 + 48)];

  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setIsDepthInPhotoEnabled:{objc_msgSend(*(a1 + 32), "_depthEffectEnabledFromSuggestion")}];

  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setDepthEffectSuggestionButtonMode:*(a1 + 40)];
}

- (void)updateDepthEffectSuggestionEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion]!= enabled)
  {
    [(CAMViewfinderViewController *)self set_depthEffectEnabledFromSuggestion:enabledCopy];
    [(CAMViewfinderViewController *)self _updateNightModePhotoModeDepthConflictAndPerformResolution:1];
    [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateZoomControlLayoutForGraphConfiguration:_currentGraphConfiguration fromGraphConfiguration:_currentGraphConfiguration2 animated:1];

    [(CAMViewfinderViewController *)self _resolveAndUpdatePotentiallyConflictingControls:1 animated:1];
    [(CAMViewfinderViewController *)self _processTextRegionResults];
    _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateLightingUIForGraphConfiguration:_currentGraphConfiguration3 animated:0];

    v8 = +[CAMCaptureCapabilities capabilities];
    LOBYTE(_currentGraphConfiguration2) = [v8 portraitInPhotoModeBehavior];

    if ((_currentGraphConfiguration2 & 4) != 0)
    {
      _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:_currentGraphConfiguration4 animated:1];
    }

    if ([(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion])
    {
      _currentGraphConfiguration5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:_currentGraphConfiguration5];
    }
  }
}

- (BOOL)_shouldUsePhotoModePortraitEffect
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];

  return [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffectIsBurst:isCapturingBurst];
}

- (BOOL)_shouldUsePhotoModePortraitEffectIsBurst:(BOOL)burst
{
  burstCopy = burst;
  _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
  v6 = [(CAMViewfinderViewController *)self _shouldUseDepthFromSuggestionForCurrentConfigurationIsBurst:burstCopy];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  if (_depthEffectEnabledFromSuggestion)
  {
    return v6 & (isSemanticStyleControlVisible ^ 1);
  }

  else
  {
    return 0;
  }
}

- (BOOL)_isDepthSuggestionAllowedForCurrentConfigurationIsBurst:(BOOL)burst
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [_currentGraphConfiguration mode];
  v7 = [_currentGraphConfiguration device] - 1;
  if (v7 > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[v7];
  }

  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v5 isDepthSuggestionSupportedForMode:mode devicePosition:v8 photoFormat:currentPhotoFormat, v10];

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSuperWideAutoMacroSupportedForMode:objc_msgSend(_currentGraphConfiguration device:"mode") videoConfiguration:objc_msgSend(_currentGraphConfiguration videoStabilizationStrength:"device") frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration, "videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength"), objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}];

  v16 = +[CAMUserPreferences preferences];
  isSuperWideAutoMacroControlAllowed = [v16 isSuperWideAutoMacroControlAllowed];

  _autoMacroSuggested = [(CAMViewfinderViewController *)self _resolvedMacroMode]== 1 && [(CAMViewfinderViewController *)self _autoMacroSuggested];
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  if ((v15 & isSuperWideAutoMacroControlAllowed) == 1 && _autoMacroSuggested)
  {
    v20 = 0;
  }

  else
  {
    v21 = [(CAMViewfinderViewController *)self _shouldDisableDepthSuggestionForNightModeForConfiguration:_currentGraphConfiguration];
    v20 = 0;
    if (!(isCapturingVideo & 1 | ((v11 & 1) == 0)) && !burst)
    {
      v20 = _resolvedRAWMode != 1 && !v21;
    }
  }

  return v20;
}

- (BOOL)_shouldDisableDepthSuggestionForNightModeForConfiguration:(id)configuration
{
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self _isNightModeActiveForCurrentSettings])
  {
    v5 = +[CAMCaptureCapabilities capabilities];
    v6 = [v5 isNightModeWithDepthSupportedForMode:objc_msgSend(configurationCopy device:{"mode"), objc_msgSend(configurationCopy, "device")}];

    if (!v6)
    {
      LOBYTE(v9) = 1;
      goto LABEL_7;
    }

    mode = [configurationCopy mode];
    device = [configurationCopy device];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    if (![(CAMViewfinderViewController *)self _isNightModePortraitAvailableForMode:mode device:device zoomFactor:?])
    {
      v9 = ![(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
      goto LABEL_7;
    }
  }

  LOBYTE(v9) = 0;
LABEL_7:

  return v9;
}

- (BOOL)_isNightModePortraitAvailableForMode:(int64_t)mode device:(int64_t)device zoomFactor:(double)factor
{
  v8 = +[CAMCaptureCapabilities capabilities];
  if ([v8 isNightModeWithDepthSupportedForMode:mode device:device])
  {
    [v8 superWideToWideZoomFactorForDevicePosition:0];
    v10 = v9 * 1.1 > factor && v9 <= factor;
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_isDepthSuggestedOrEnabledForShallowDepthOfFieldStatus:(int64_t)status
{
  v5 = (status < 0xF) & (0x7A02u >> status);
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  isShowingPointIndicator = [_previewViewController isShowingPointIndicator];

  v8 = +[CAMCaptureCapabilities capabilities];
  portraitInPhotoModeBehavior = [v8 portraitInPhotoModeBehavior];

  if (portraitInPhotoModeBehavior)
  {
    _depthEffectEnabledFromSuggestion = [(CAMViewfinderViewController *)self _depthEffectEnabledFromSuggestion];
    if (!v5)
    {
      goto LABEL_3;
    }

LABEL_5:
    v12 = +[CAMUserPreferences preferences];
    shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable = [v12 shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable];

    return (status < 0xF) & (0x6A02u >> status) | _depthEffectEnabledFromSuggestion | v5 & isShowingPointIndicator & 1 | shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable & 1;
  }

  _depthEffectEnabledFromSuggestion = 0;
  if (v5)
  {
    goto LABEL_5;
  }

LABEL_3:
  shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable = 0;
  return (status < 0xF) & (0x6A02u >> status) | _depthEffectEnabledFromSuggestion | v5 & isShowingPointIndicator & 1 | shouldAlwaysShowDepthSuggestionWhenDepthIsAvailable & 1;
}

- (void)_updatePreviewControllerIndicatorStyle
{
  _shouldUsePhotoModePortraitEffect = [(CAMViewfinderViewController *)self _shouldUsePhotoModePortraitEffect];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setShouldUsePortraitStyleIndicatorsInPhotoMode:_shouldUsePhotoModePortraitEffect];
}

- (BOOL)_shouldRequestDepthDeliveryForBurst:(BOOL)burst
{
  burstCopy = burst;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  if (mode == 9 || mode == 6)
  {
    featureDevelopmentForceDepthDataCaptureInPhotoMode = 1;
  }

  else if (mode)
  {
    featureDevelopmentForceDepthDataCaptureInPhotoMode = 0;
  }

  else
  {
    v9 = +[CAMCaptureCapabilities capabilities];
    featureDevelopmentForceDepthDataCaptureInPhotoMode = [v9 featureDevelopmentForceDepthDataCaptureInPhotoMode];
  }

  v10 = featureDevelopmentForceDepthDataCaptureInPhotoMode | [(CAMViewfinderViewController *)self _shouldUseDepthFromSuggestionForCurrentConfigurationIsBurst:burstCopy];

  return v10 & 1;
}

- (BOOL)_shouldUseTransientLightingBadgesForGraphConfiguration:(id)configuration
{
  _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
  v4 = [_targetLightingControl collapsedControlLocation] != 0;

  return v4;
}

- (BOOL)_shouldHideLightingNameBadgesForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = [(CAMViewfinderViewController *)self _shouldHideBadgesForGraphConfiguration:configurationCopy];
  _targetLightingControl = [(CAMViewfinderViewController *)self _targetLightingControl];
  isExpanded = [_targetLightingControl isExpanded];

  LOBYTE(_targetLightingControl) = [(CAMViewfinderViewController *)self _shouldUseTransientLightingBadgesForGraphConfiguration:configurationCopy];
  _timerCache = [(CAMViewfinderViewController *)self _timerCache];
  LOBYTE(configurationCopy) = [_timerCache isRunningTimerForKey:&unk_1F16C7898];

  v9 = _targetLightingControl & (configurationCopy ^ 1);
  if (isExpanded)
  {
    v9 = v5;
  }

  if (v5)
  {
    return v5;
  }

  else
  {
    return v9;
  }
}

- (void)_updateTransientLightingBadgeVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _shouldHideLightingNameBadgesForGraphConfiguration:_currentGraphConfiguration];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setLightingNameBadgesHidden:v6 animated:animatedCopy];
}

- (void)_startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:(id)configuration
{
  if ([(CAMViewfinderViewController *)self _shouldUseTransientLightingBadgesForGraphConfiguration:configuration])
  {
    [(CAMViewfinderViewController *)self _startTimer:5];

    [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
  }
}

- (void)handleUserDidToggleSpatialMode
{
  v3 = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected]^ 1;

  [(CAMViewfinderViewController *)self _spatialModeToggledTo:v3];
}

- (void)_handlePhotoVideoModeSwitchValueChanged:(id)changed
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  photoVideoModeSwitch = [_fullscreenViewfinder photoVideoModeSwitch];
  -[CAMViewfinderViewController _spatialModeToggledTo:](self, "_spatialModeToggledTo:", [photoVideoModeSwitch mode]);
}

- (void)_spatialModeToggledTo:(unint64_t)to
{
  v4 = 9;
  if (to)
  {
    v4 = 0;
  }

  if (to == 1)
  {
    v5 = 8;
  }

  else
  {
    v5 = v4;
  }

  v6 = to == 1;
  [(CAMViewfinderViewController *)self _setSpatialModeHasVideoSelected:v6];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  badgeTray = [_fullscreenViewfinder badgeTray];
  spatialBadge = [badgeTray spatialBadge];
  [spatialBadge setSpatialModeHasVideoSelected:v6];

  _modeDial = [(CAMViewfinderViewController *)self _modeDial];
  [_modeDial reloadData];
  [_modeDial setSelectedMode:v5 animated:0];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:v5];
}

- (void)_setSpatialModeHasVideoSelected:(BOOL)selected
{
  if (self->__spatialModeHasVideoSelected != selected)
  {
    selectedCopy = selected;
    self->__spatialModeHasVideoSelected = selected;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setSpatialModeHasVideoSelected:selectedCopy];
  }
}

- (void)_updateSpatialCaptureUIStateForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v8 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  _spatialModeHasVideoSelected = [(CAMViewfinderViewController *)self _spatialModeHasVideoSelected];
  photoVideoModeSwitch = [_fullscreenViewfinder photoVideoModeSwitch];
  [photoVideoModeSwitch setMode:_spatialModeHasVideoSelected animated:animatedCopy];

  v11 = !v8;
  photoVideoModeSwitch2 = [_fullscreenViewfinder photoVideoModeSwitch];
  [photoVideoModeSwitch2 setEnabled:v11];

  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  if ([(CAMViewfinderViewController *)self _isSpatialMode:mode devicePosition:devicePosition]&& v11)
  {
    _isShowingCameraRoll = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
    _motionController2 = [(CAMViewfinderViewController *)self _motionController];
    [_motionController2 setForceLandscapeOrientation:!_isShowingCameraRoll];

    deviceOrientation = [_motionController deviceOrientation];
    if (deviceOrientation > 6)
    {
      goto LABEL_9;
    }

    if (((1 << deviceOrientation) & 0x79) == 0)
    {
      [_fullscreenViewfinder setOrientationInstructionVisible:1 animated:animatedCopy];
      if ([(CAMViewfinderViewController *)self _trueVideoIsTransitioningToCapture])
      {
        v18 = 0;
      }

      else
      {
        v18 = ![(CAMViewfinderViewController *)self _trueVideoIsCapturing];
      }

      [_fullscreenViewfinder setOrientationInstructionBackgroundBlurred:(-[CAMViewfinderViewController isRecording](self animated:{"isRecording") ^ 1) & v18, animatedCopy}];
      goto LABEL_9;
    }
  }

  else
  {
    _motionController3 = [(CAMViewfinderViewController *)self _motionController];
    [_motionController3 setForceLandscapeOrientation:0];
  }

  [_fullscreenViewfinder setOrientationInstructionVisible:0 animated:animatedCopy];
LABEL_9:
}

- (BOOL)_shouldShowSpatialCaptureInstructionsForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = [configurationCopy mode] == 8;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  deviceOrientation = [_motionController deviceOrientation];

  _stereoCaptureStatus = [(CAMViewfinderViewController *)self _stereoCaptureStatus];
  v9 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  v12 = [(CAMViewfinderViewController *)self _isSpatialMode:mode devicePosition:devicePosition];
  result = 0;
  if ((v5 || v12) && (deviceOrientation - 1) >= 2 && (_stereoCaptureStatus & 6) != 0 && !v9)
  {
    return ![(CAMViewfinderViewController *)self _isReconfiguring];
  }

  return result;
}

- (BOOL)_shouldShowPhotoVideoModeSwitchForGraphConfiguration:(id)configuration
{
  mode = [configuration mode];
  _isCapturingFromTimer = [(CAMViewfinderViewController *)self _isCapturingFromTimer];
  _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
  v7 = 0;
  if (!_isCapturingFromTimer && (mode & 0xFFFFFFFFFFFFFFFELL) == 8)
  {
    v7 = ![(CAMViewfinderViewController *)self isRecording]&& !_trueVideoIsActive;
  }

  return v7 & 1;
}

- (void)captureController:(id)controller didOutputStereoCaptureStatus:(int64_t)status
{
  [(CAMViewfinderViewController *)self _setStereoCaptureStatus:status];
  v5 = +[CAMCaptureCapabilities capabilities];
  isSpatialModeSupported = [v5 isSpatialModeSupported];

  if (isSpatialModeSupported)
  {
    v7 = [(CAMViewfinderViewController *)self _currentMode]== 9;
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setStereoCaptureStatus:-[CAMViewfinderViewController _stereoCaptureStatus](self useHoldStillStereoLowLightInstruction:"_stereoCaptureStatus") animated:{v7, 1}];

    if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
    {
      [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    }
  }

  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setStereoCaptureStatus:{-[CAMViewfinderViewController _stereoCaptureStatus](self, "_stereoCaptureStatus")}];
}

- (BOOL)_isFrontRearSimultaneousVideoSupportedForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(position) = [v7 isFrontRearSimultaneousVideoSupportedForMode:mode devicePosition:position];

  return position & ![(CAMViewfinderViewController *)self _trueVideoIsActive];
}

- (BOOL)_isFrontRearSimultaneousVideoActiveForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v5 = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoSupportedForMode:mode devicePosition:position];
  if (v5)
  {

    LOBYTE(v5) = [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled];
  }

  return v5;
}

- (void)handleUserChangedFrontPIPEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v5 = +[CAMUserPreferences preferences];
  [v5 setDidRecentlyUseFrontPIP];

  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabled:enabledCopy performGraphConfiguration:1];
}

- (void)_updateFrontRearSimultaneousVideoEnabled:(BOOL)enabled performGraphConfiguration:(BOOL)configuration
{
  configurationCopy = configuration;
  enabledCopy = enabled;
  if ([(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled]!= enabled)
  {
    [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoEnabled:enabledCopy];
    if (!enabledCopy)
    {
      chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
      [chromeConfigurator setFrontPIPFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    }

    v8 = +[CAMUserPreferences preferences];
    [v8 setShouldEnableFrontRearSimultaneousVideo:{-[CAMViewfinderViewController _isFrontRearSimultaneousVideoEnabled](self, "_isFrontRearSimultaneousVideoEnabled")}];
    if (configurationCopy)
    {
      [(CAMViewfinderViewController *)self _performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange];
    }
  }
}

- (void)_performGraphConfigurationChangeForFrontRearSimultaneousVideoEnabledChange
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v3 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:[(CAMViewfinderViewController *)self _currentMode] device:0 fromGraphConfiguration:_currentGraphConfiguration];
  devicePosition = [_currentGraphConfiguration devicePosition];
  if (devicePosition == [v3 devicePosition])
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v6 = v5;
    v7 = [(CAMViewfinderViewController *)self _resolvedDeviceForZoomFactor:_currentGraphConfiguration fromGraphConfiguration:v3 toGraphConfiguration:?];
    v8 = -[CAMViewfinderViewController _graphConfigurationForChangeToMode:device:fromGraphConfiguration:](self, "_graphConfigurationForChangeToMode:device:fromGraphConfiguration:", [v3 mode], v7, _currentGraphConfiguration);

    +[CAMZoomControlUtilities equivalentZoomFactor:forDevice:fromDevice:](CAMZoomControlUtilities, "equivalentZoomFactor:forDevice:fromDevice:", v7, [_currentGraphConfiguration device], v6);
    v3 = v8;
  }

  else
  {
    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v3];
  }

  [(CAMViewfinderViewController *)self _performChangeFromGraphConfiguration:_currentGraphConfiguration toGraphConfiguration:v3 zoomFactor:1 deferIfConfigurationInFlight:?];
}

- (void)_updateFrontRearSimultaneousVideoEnabledForGraphConfiguration:(id)configuration
{
  frontRearSimultaneousVideoEnabled = [configuration frontRearSimultaneousVideoEnabled];
  if (frontRearSimultaneousVideoEnabled != [(CAMViewfinderViewController *)self _isFrontRearSimultaneousVideoEnabled])
  {

    [(CAMViewfinderViewController *)self _setFrontRearSimultaneousVideoEnabled:frontRearSimultaneousVideoEnabled];
  }
}

- (void)_setView:(id)view hidden:(BOOL)hidden delayedInTotalAnimationTime:(double)time normalizedFadeoutDuration:(double)duration
{
  hiddenCopy = hidden;
  viewCopy = view;
  v10 = viewCopy;
  v11 = !hiddenCopy;
  if (time <= 0.0)
  {
    [viewCopy setAlpha:!hiddenCopy];
  }

  else
  {
    v12 = time * duration;
    if (hiddenCopy)
    {
      v13 = 0.0;
    }

    else
    {
      v13 = time - v12;
    }

    v14 = MEMORY[0x1E69DD250];
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = __101__CAMViewfinderViewController__setView_hidden_delayedInTotalAnimationTime_normalizedFadeoutDuration___block_invoke;
    v15[3] = &unk_1E76F7A38;
    v16 = viewCopy;
    v17 = v11;
    [v14 animateWithDuration:0 delay:v15 options:0 animations:v12 completion:v13];
  }
}

- (void)videoThumbnailOutputWillBeginRenderingThumbnailsWithContents:(id)contents
{
  v9 = *MEMORY[0x1E69E9840];
  contentsCopy = contents;
  v5 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    v7 = 138543362;
    v8 = contentsCopy;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Setting thumbnail contents %{public}@", &v7, 0xCu);
  }

  [(CAMViewfinderViewController *)self set_filterScrubberLayerContents:contentsCopy];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setFilterThumbnailContents:contentsCopy];

  if ([(CAMViewfinderViewController *)self _shouldShowFilterScrubberAfterNextRender])
  {
    [(CAMViewfinderViewController *)self _setShouldShowFilterScrubberAfterNextRender:0];
    [(CAMViewfinderViewController *)self _setShowingFilterScrubber:1 animated:1];
  }
}

- (void)videoThumbnailOutputWillEndRenderingThumbnails
{
  v3 = NSStringFromSelector(a2);
  [(CAMViewfinderViewController *)self _clearFilterScrubberLayerContentsIfNotNeededFromCallsite:v3];
}

- (void)_clearFilterScrubberLayerContentsIfNotNeededFromCallsite:(id)callsite
{
  v26 = *MEMORY[0x1E69E9840];
  callsiteCopy = callsite;
  _isShowingFilterScrubber = [(CAMViewfinderViewController *)self _isShowingFilterScrubber];
  _wantsFilterScrubberVisible = [(CAMViewfinderViewController *)self _wantsFilterScrubberVisible];
  _isAnimatingFilterScrubberDismissal = [(CAMViewfinderViewController *)self _isAnimatingFilterScrubberDismissal];
  v8 = _isAnimatingFilterScrubberDismissal;
  if (_isShowingFilterScrubber || _wantsFilterScrubberVisible || _isAnimatingFilterScrubberDismissal)
  {
    chromeConfigurator = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(chromeConfigurator, OS_LOG_TYPE_DEFAULT))
    {
      if (_isShowingFilterScrubber)
      {
        v12 = @"YES";
      }

      else
      {
        v12 = @"NO";
      }

      v13 = v12;
      if (_wantsFilterScrubberVisible)
      {
        v14 = @"YES";
      }

      else
      {
        v14 = @"NO";
      }

      v15 = v14;
      if (v8)
      {
        v16 = @"YES";
      }

      else
      {
        v16 = @"NO";
      }

      v17 = v16;
      v18 = 138544130;
      v19 = callsiteCopy;
      v20 = 2114;
      v21 = v13;
      v22 = 2114;
      v23 = v15;
      v24 = 2114;
      v25 = v17;
      _os_log_impl(&dword_1A3640000, chromeConfigurator, OS_LOG_TYPE_DEFAULT, "Not clearing thumbnail contents from %{public}@ because showingFilterScrubber=%{public}@, wantsFilterScrubberVisible=%{public}@, and animatingFilterScrubberDismissal=%{public}@", &v18, 0x2Au);
    }

    goto LABEL_19;
  }

  _filterScrubberLayerContents = [(CAMViewfinderViewController *)self _filterScrubberLayerContents];

  if (_filterScrubberLayerContents)
  {
    v10 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v18 = 138543362;
      v19 = callsiteCopy;
      _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Clearing thumbnail contents from %{public}@", &v18, 0xCu);
    }

    [(CAMViewfinderViewController *)self set_filterScrubberLayerContents:0];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setFilterThumbnailContents:0];
LABEL_19:
  }
}

- (BOOL)_isZoomAllowedForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoConfiguration = [configurationCopy videoConfiguration];
  videoStabilizationStrength = [configurationCopy videoStabilizationStrength];

  LOBYTE(configurationCopy) = [v4 isZoomAllowedForMode:mode device:device videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength];
  return configurationCopy;
}

- (BOOL)_isZoomAllowedCurrently
{
  selfCopy = self;
  _isPinchToZoomAllowed = [(CAMViewfinderViewController *)self _isPinchToZoomAllowed];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)selfCopy _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _isZoomAllowedForGraphConfiguration:_currentGraphConfiguration];

  return _isPinchToZoomAllowed & selfCopy;
}

- (BOOL)_zoomControlReconfiguresGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:configurationCopy];
  v6 = [(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForGraphConfiguration:configurationCopy]&& !v5;
  if ([configurationCopy devicePosition] == 1)
  {
    v7 = +[CAMCaptureCapabilities capabilities];
    v8 = [v7 frontZoomBehaviorForCaptureMode:objc_msgSend(configurationCopy videoConfiguration:{"mode"), objc_msgSend(configurationCopy, "videoConfiguration")}];

    LOBYTE(v6) = ((v8 & 0xFFFFFFFFFFFFFFFELL) == 2) | v6;
  }

  return v6 & 1;
}

- (BOOL)_isPinchToZoomAllowed
{
  v3 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  videoStabilizationStrength = [_currentGraphConfiguration videoStabilizationStrength];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = [v3 shouldAllowCameraToggleForMode:_currentMode devicePosition:_currentDevicePosition videoConfiguration:_currentVideoConfiguration videoStabilizationStrength:videoStabilizationStrength frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration2, "frontRearSimultaneousVideoEnabled")}];

  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v12 = [(CAMViewfinderViewController *)self _isZoomAllowedForGraphConfiguration:_currentGraphConfiguration3];

  _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v14 = [(CAMViewfinderViewController *)self _zoomControlReconfiguresGraphConfiguration:_currentGraphConfiguration4];

  _isOutOfDiskSpace = [(CAMViewfinderViewController *)self _isOutOfDiskSpace];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController2 isCapturingBurst];

  _captureController3 = [(CAMViewfinderViewController *)self _captureController];
  isCapturingPanorama = [_captureController3 isCapturingPanorama];

  _captureController4 = [(CAMViewfinderViewController *)self _captureController];
  isCapturingTimelapse = [_captureController4 isCapturingTimelapse];

  if (_isOutOfDiskSpace || isCapturingBurst & 1 | (((v12 | v10) & 1) == 0) | (isCapturingPanorama | isCapturingTimelapse) & 1)
  {
    v24 = 0;
  }

  else
  {
    v24 = isCapturingVideo & v14 ^ 1;
  }

  return v24;
}

- (double)_defaultZoomFactorForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", configurationCopy, [_motionController captureOrientation]);
  v7 = v6;

  return v7;
}

- (BOOL)_shouldEmulateAggregateCameraZoomForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  device = [configurationCopy device];
  videoConfiguration = [configurationCopy videoConfiguration];
  v7 = +[CAMZoomControlUtilities shouldEmulateTripleCameraZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "shouldEmulateTripleCameraZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", mode, device, videoConfiguration, [configurationCopy videoStabilizationStrength], objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled"));
  videoStabilizationStrength = [configurationCopy videoStabilizationStrength];
  frontRearSimultaneousVideoEnabled = [configurationCopy frontRearSimultaneousVideoEnabled];

  return (v7 | [CAMZoomControlUtilities shouldEmulateWideDualCameraZoomForMode:mode device:device videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength frontRearSimultaneousVideoEnabled:frontRearSimultaneousVideoEnabled]) & 1;
}

- (void)_limitZoomRangeForRecordingIfNecessary
{
  v29 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:_currentGraphConfiguration];

  if (v4)
  {
    _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl minAvailableZoomFactor];
    if (v6 < 1.0)
    {
      [_zoomControl setMinAvailableZoomFactor:1.0];
    }
  }

  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  if (_currentDevice <= 0xB)
  {
    if (((1 << _currentDevice) & 0xF2B) != 0)
    {
      _currentMode = [(CAMViewfinderViewController *)self _currentMode];
      _currentDevice2 = [(CAMViewfinderViewController *)self _currentDevice];
      _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v29 maximumZoomFactorForMode:_currentMode device:_currentDevice2 videoConfiguration:_currentVideoConfiguration videoStabilizationStrength:{objc_msgSend(_currentGraphConfiguration2, "videoStabilizationStrength")}];
      v13 = v12;
    }

    else
    {
      if (((1 << _currentDevice) & 0xC0) != 0)
      {
        v16 = +[CAMUserPreferences preferences];
        v17 = [v16 shouldDisableCameraSwitchingDuringVideoRecordingForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

        if (!v17)
        {
          goto LABEL_12;
        }

        [v29 wideDualCameraSwitchOverZoomFactorForDevicePosition:0];
        v19 = v18;
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        v13 = 6.0;
        if (v20 >= v19)
        {
          goto LABEL_12;
        }

        goto LABEL_9;
      }

      if (_currentDevice != 2)
      {
        goto LABEL_12;
      }

      _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      if ([_currentGraphConfiguration3 trueVideoEnabled])
      {
        _trueVideoSourceCaptureMode = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      }

      else
      {
        _trueVideoSourceCaptureMode = [(CAMViewfinderViewController *)self _currentMode];
      }

      v23 = _trueVideoSourceCaptureMode;

      _currentDevice3 = [(CAMViewfinderViewController *)self _currentDevice];
      _currentVideoConfiguration2 = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
      _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [v29 maximumZoomFactorForMode:v23 device:_currentDevice3 videoConfiguration:_currentVideoConfiguration2 videoStabilizationStrength:{objc_msgSend(_currentGraphConfiguration4, "videoStabilizationStrength")}];
      v13 = v27;

      if ([v29 isBackTelephotoSupported])
      {
        [v29 wideToTelephotoZoomFactorForDevicePosition:0];
        if (v28 > v13)
        {
          v13 = v28;
        }
      }
    }

    if (v13 <= 0.0)
    {
      goto LABEL_12;
    }

LABEL_9:
    _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl2 maxAvailableZoomFactor];
    if (v15 > v13)
    {
      [_zoomControl2 setMaxAvailableZoomFactor:v13];
    }
  }

LABEL_12:
}

- (void)_restoreZoomRangeAfterRecordingIfNecessary
{
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v4 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:_currentGraphConfiguration];

  if (v4)
  {
    [_zoomControl minAvailableZoomFactor];
    v6 = v5;
    [_zoomControl minimumZoomFactor];
    if (v6 > v7)
    {
      [_zoomControl minimumZoomFactor];
      [_zoomControl setMinAvailableZoomFactor:?];
    }

    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    [CAMViewfinderViewController _changeToZoomFactor:"_changeToZoomFactor:rampDuration:zoomRampTuning:shouldAnimate:" rampDuration:0 zoomRampTuning:0 shouldAnimate:?];
  }

  [_zoomControl maxAvailableZoomFactor];
  v9 = v8;
  [_zoomControl maximumZoomFactor];
  if (v9 < v10)
  {
    [_zoomControl maximumZoomFactor];
    [_zoomControl setMaxAvailableZoomFactor:?];
  }
}

- (void)captureController:(id)controller didOutputVideoZoomFactor:(double)factor
{
  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration]&& ![(CAMViewfinderViewController *)self _shouldIgnoreZoomFactorKVOForRamping]&& ![(CAMViewfinderViewController *)self _isPinchingForZoom])
  {
    isTracking = [(CAMZoomSlider *)self->__zoomSlider isTracking];
    _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
    isAutozooming = [_zoomSlider isAutozooming];

    if ((!isTracking || isAutozooming != 0) && ([(CAMZoomControl *)self->__zoomControl isTracking]& 1) == 0)
    {
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      if (vabdd_f64(factor, v10) >= 0.0001)
      {
        _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
        _currentMode = [(CAMViewfinderViewController *)self _currentMode];
        _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
        _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
        _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        videoStabilizationStrength = [_currentGraphConfiguration videoStabilizationStrength];
        _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v17 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", _currentMode, _currentDevice, _currentVideoConfiguration, videoStabilizationStrength, [_currentGraphConfiguration2 frontRearSimultaneousVideoEnabled], 0, 0);

        if (_zoomControl)
        {
          if (v17 && ([_zoomControl zoomButtonContentType] | 2) == 2)
          {
            [_zoomControl maximumZoomFactor];
            if (v18 - factor < 0.0001)
            {
              factor = v18;
            }
          }
        }

        [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:factor];
        [(CAMViewfinderViewController *)self _updateZoomUIWithZoomFactor:0 animated:factor];
        [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
        [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:0];
      }
    }
  }
}

- (unint64_t)_fullscreenViewfinderZoomStyle
{
  if (![(CAMViewfinderViewController *)self isShowingStandardControls])
  {
    return 0;
  }

  if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
  {
    return 1;
  }

  return 2;
}

- (void)_updateFullscreenViewfinderZoomSliderIfNecessary
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  if ([_fullscreenViewfinder zoomStyle] == 2)
  {
    zoomSlider = [_fullscreenViewfinder zoomSlider];
    [zoomSlider setMinimumValue:0.0];

    zoomSlider2 = [_fullscreenViewfinder zoomSlider];
    LODWORD(v5) = 1.0;
    [zoomSlider2 setMaximumValue:v5];

    _shouldEnableZoomSlider = [(CAMViewfinderViewController *)self _shouldEnableZoomSlider];
    zoomSlider3 = [_fullscreenViewfinder zoomSlider];
    [zoomSlider3 setEnabled:_shouldEnableZoomSlider];

    zoomSlider4 = [_fullscreenViewfinder zoomSlider];
    [zoomSlider4 setAlpha:0.0];
  }
}

- (void)_updateZoomUIWithZoomFactor:(double)factor animated:(BOOL)animated
{
  animatedCopy = animated;
  [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:?];
  v8 = v7;
  *&v7 = v7;
  [(CAMZoomSlider *)self->__zoomSlider setValue:0 animated:v7];
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  allowsContinuousZoom = [_zoomControl allowsContinuousZoom];

  if (allowsContinuousZoom)
  {
    _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
    [_zoomControl2 setZoomFactor:factor];
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  -[CAMViewfinderViewController _updateZoomButtonSymbolForMode:device:videoConfiguration:zoomFactor:videoStabilizationStrength:animated:](self, "_updateZoomButtonSymbolForMode:device:videoConfiguration:zoomFactor:videoStabilizationStrength:animated:", [_currentGraphConfiguration mode], objc_msgSend(_currentGraphConfiguration, "device"), objc_msgSend(_currentGraphConfiguration, "videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength"), animatedCopy, factor);
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setZoomAmount:v8];

  _remoteShutterController2 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController2 setZoomFactor:factor];
}

- (void)_updateZoomButtonSymbolForMode:(int64_t)mode device:(int64_t)device videoConfiguration:(int64_t)configuration zoomFactor:(double)factor videoStabilizationStrength:(int64_t)strength animated:(BOOL)animated
{
  animatedCopy = animated;
  v15 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v17 = [v15 resolvedDeviceForDesiredDevice:device mode:mode videoConfiguration:configuration videoStabilizationStrength:strength frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}];

  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  if (v17 <= 0xB && ((0xFDu >> v17) & 1) == 0)
  {
    if (_zoomControl)
    {
      v25 = _zoomControl;
      v19 = [_zoomControl zoomButtonContentType] == 1;
      _zoomControl = v25;
      if (v19)
      {
        zoomButtonSymbol = [v25 zoomButtonSymbol];
        v21 = +[CAMCaptureCapabilities capabilities];
        v22 = [v21 frontZoomBehaviorForCaptureMode:mode videoConfiguration:configuration];

        if ((v22 - 1) >= 2)
        {
          if (v22 == 3)
          {
            zoomButtonSymbol = v17 != 10;
          }
        }

        else
        {
          zoomButtonSymbol = fabs(factor + -1.0) >= 0.001;
        }

        if ((device - 1) > 0xA)
        {
          v23 = 0;
        }

        else
        {
          v23 = qword_1A3A685B0[device - 1];
        }

        v24 = [(CAMViewfinderViewController *)self _resolvedSmartFramingFieldOfViewForMode:mode devicePosition:v23]- 1;
        if (v24 <= 3)
        {
          zoomButtonSymbol = qword_1A3A68538[v24];
        }

        [v25 setZoomButtonSymbol:zoomButtonSymbol animated:animatedCopy];
        _zoomControl = v25;
      }
    }
  }
}

- (void)captureController:(id)controller didOutputMinAvailableVideoZoomFactor:(double)factor
{
  v16 = *MEMORY[0x1E69E9840];
  if ([(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    v6 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 134217984;
      factorCopy = factor;
      _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Ignoring didOutputMinAvailableVideoZoomFactor:%f because we are waiting on an in-flight configuration", buf, 0xCu);
    }
  }

  else
  {
    _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
    allowsContinuousZoom = [_zoomControl allowsContinuousZoom];

    if (allowsContinuousZoom)
    {
      if (factor == 1.0)
      {
        _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v10 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:_currentGraphConfiguration];

        factor = 1.0;
        if (v10)
        {
          _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
          [_zoomControl2 minimumZoomFactor];
          factor = v12;
        }
      }

      _zoomControl3 = [(CAMViewfinderViewController *)self _zoomControl];
      [_zoomControl3 setMinAvailableZoomFactor:factor];
    }
  }
}

- (void)captureController:(id)controller didChangeRampingVideoZoom:(BOOL)zoom
{
  if (!zoom)
  {
    [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:0];

    [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  }
}

- (void)captureController:(id)controller didChangePreviewZoomPIPRect:(CGRect)rect
{
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setNormalizedZoomPIPRect:{x, y, width, height}];
}

- (void)_changeToZoomFactor:(double)factor rampDuration:(double)duration zoomRampTuning:(int64_t)tuning shouldAnimate:(BOOL)animate updateOverlay:(BOOL)overlay
{
  animateCopy = animate;
  v55 = *MEMORY[0x1E69E9840];
  v12 = [(CAMViewfinderViewController *)self _currentMode:tuning];
  v13 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  devicePosition = [_currentGraphConfiguration devicePosition];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v17 = [v13 isQuadraWideBinningReconfigurationSupportedForMode:v12 devicePosition:devicePosition videoConfiguration:{objc_msgSend(_currentGraphConfiguration2, "videoConfiguration")}];

  if (v12 != 6 || (+[CAMCaptureCapabilities capabilities](CAMCaptureCapabilities, "capabilities"), v18 = objc_claimAutoreleasedReturnValue(), v19 = [v18 continuousZoomSupportedForPortraitMode] | v17, v18, (v19 & 1) != 0))
  {
    v51 = animateCopy;
    tuningCopy = tuning;
    _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v52 = [(CAMViewfinderViewController *)self _shouldEmulateAggregateCameraZoomForGraphConfiguration:_currentGraphConfiguration3];

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];

    v23 = +[CAMCaptureCapabilities capabilities];
    _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
    _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
    _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    videoStabilizationStrength = [_currentGraphConfiguration4 videoStabilizationStrength];
    _currentGraphConfiguration5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v29 = [v23 resolvedDeviceForDesiredDevice:_currentDevice mode:v12 videoConfiguration:_currentVideoConfiguration videoStabilizationStrength:videoStabilizationStrength frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration5, "frontRearSimultaneousVideoEnabled")}];

    v30 = 0;
    if (v29 == 2)
    {
      v31 = v17;
    }

    else
    {
      v31 = 0;
    }

    if (v31 == 1 && v12 == 6)
    {
      v32 = +[CAMCaptureCapabilities capabilities];
      v30 = [v32 continuousZoomSupportedForPortraitMode] ^ 1;
    }

    if (((v52 & (isCapturingVideo ^ 1) & 1) != 0 || v30) && (v33 = -[CAMViewfinderViewController _currentVideoConfiguration](self, "_currentVideoConfiguration"), -[CAMViewfinderViewController _currentGraphConfiguration](self, "_currentGraphConfiguration"), v34 = objc_claimAutoreleasedReturnValue(), v35 = [v34 videoStabilizationStrength], -[CAMViewfinderViewController _currentGraphConfiguration](self, "_currentGraphConfiguration"), v36 = objc_claimAutoreleasedReturnValue(), v37 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", v12, v29, v33, v35, objc_msgSend(v36, "frontRearSimultaneousVideoEnabled"), 0, 0), v36, v34, v38 = +[CAMZoomControlUtilities deviceForEmulatingZoomFactor:fromDevice:mode:continuousZoomSupported:](CAMZoomControlUtilities, "deviceForEmulatingZoomFactor:fromDevice:mode:continuousZoomSupported:", v29, v12, v37, factor), +[CAMZoomControlUtilities zoomScaleFromDevice:toDevice:](CAMZoomControlUtilities, "zoomScaleFromDevice:toDevice:", v29, v38), (v38 != v29) | v30 & 1))
    {
      v40 = v39;
      [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
      [(CAMViewfinderViewController *)self _setVideoZoomFactorAtPinchStart:v40 * v41];
      [(CAMViewfinderViewController *)self _videoZoomFactorAtDynamicShutterStart];
      [(CAMViewfinderViewController *)self _setVideoZoomFactorAtDynamicShutterStart:v40 * v42];
      [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:v12 device:v38 zoomFactor:v40 * factor];
    }

    else
    {
      [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:factor];
      [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:v51];
      [(CAMViewfinderViewController *)self _updateZoomUIWithZoomFactor:v51 animated:factor];
      _currentGraphConfiguration6 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      _currentGraphConfiguration7 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateDepthEffectApertureForGraphConfiguration:_currentGraphConfiguration6 fromGraphConfiguration:_currentGraphConfiguration7 zoomFactor:factor];

      if ([(CAMViewfinderViewController *)self _isReconfiguringForZoomChange])
      {
        v45 = os_log_create("com.apple.camera", "Zoom");
        if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 134217984;
          factorCopy = factor;
          _os_log_impl(&dword_1A3640000, v45, OS_LOG_TYPE_DEFAULT, "Ignoring zoom change to %.3f during reconfiguration", buf, 0xCu);
        }
      }

      else
      {
        if (duration > 0.0 || tuningCopy)
        {
          [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:1];
          captureController = self->__captureController;
          _currentGraphConfiguration8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CUCaptureController *)captureController startRampToVideoZoomFactor:tuningCopy withDuration:_currentGraphConfiguration8 zoomRampTuning:factor graphConfiguration:duration];
        }

        else
        {
          v46 = self->__captureController;
          _currentGraphConfiguration8 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
          [(CUCaptureController *)v46 changeToVideoZoomFactor:_currentGraphConfiguration8 graphConfiguration:factor];
        }
      }

      [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
      if (v12 == 6 && ![(CAMViewfinderViewController *)self _currentDevicePosition])
      {
        v49 = +[CAMUserPreferences preferences];
        [v49 setPortraitModeRearDevice:{-[CAMViewfinderViewController _currentDevice](self, "_currentDevice")}];
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [v49 setPortraitModeRearZoomValue:?];
      }
    }
  }
}

- (void)_resetZoom
{
  v3 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(_currentMode) = [v3 isZoomAllowedForMode:_currentMode device:_currentDevice videoConfiguration:_currentVideoConfiguration videoStabilizationStrength:{objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength")}];

  if (_currentMode)
  {
    _currentMode2 = [(CAMViewfinderViewController *)self _currentMode];
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", _currentMode2, [_currentGraphConfiguration2 devicePosition]);

    if (v10)
    {

      [(CAMViewfinderViewController *)self _resetSmartFramingFieldOfViewAnimated:0];
    }

    else
    {
      _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      _motionController = [(CAMViewfinderViewController *)self _motionController];
      -[CAMViewfinderViewController _defaultZoomFactorForGraphConfiguration:captureOrientation:](self, "_defaultZoomFactorForGraphConfiguration:captureOrientation:", _currentGraphConfiguration3, [_motionController captureOrientation]);
      v13 = v12;

      [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:0 zoomRampTuning:v13 shouldAnimate:0.0];
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
    }
  }
}

- (double)_defaultZoomFactorForGraphConfiguration:(id)configuration captureOrientation:(int64_t)orientation
{
  configurationCopy = configuration;
  v7 = +[CAMUserPreferences preferences];
  [v7 defaultZoomFactorForGraphConfiguration:configurationCopy captureOrientation:orientation outputToExternalStorage:{-[CAMViewfinderViewController _externalStorageOutputEnabled](self, "_externalStorageOutputEnabled")}];
  v9 = v8;

  return v9;
}

- (double)_zoomSliderValueForZoomFactor:(double)factor
{
  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
  v5 = v4;
  v6 = log(factor);
  return v6 / log(v5);
}

- (double)_zoomFactorForZoomSliderValue:(double)value
{
  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];

  return pow(v4, value);
}

- (void)_handleTouchDownForZoomSlider:(id)slider
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl cancelZoom];

  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didZoomInteraction:2];
}

- (void)_zoomSliderValueDidChange:(id)change forEvent:(id)event
{
  v5 = [(CAMViewfinderViewController *)self _zoomSlider:change];
  isAutozooming = [v5 isAutozooming];

  if ((isAutozooming & 1) == 0)
  {
    [(CAMZoomSlider *)self->__zoomSlider value];
    [(CAMViewfinderViewController *)self _zoomFactorForZoomSliderValue:v7];
    [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:?];

    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:2];
  }
}

- (void)_zoomUIDidChangeToFactor:(double)factor
{
  [(CAMViewfinderViewController *)self _setCachedVideoZoomFactor:?];
  [(CAMViewfinderViewController *)self _updateControlsRelatedToDepthSuggestionAnimated:1];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingVideo])
  {
    v5 = 0.5;
  }

  else
  {
    v5 = 0.25;
  }

  [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:1];
  captureController = self->__captureController;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CUCaptureController *)captureController startRampToVideoZoomFactor:3 withDuration:_currentGraphConfiguration zoomRampTuning:factor graphConfiguration:v5];

  [(CAMViewfinderViewController *)self _updateAutoMacroStatus];
  if (![(CAMViewfinderViewController *)self _shouldUseZoomButtonForCameraToggleForCurrentModeAndDevice])
  {
    [(CAMZoomControl *)self->__zoomControl setZoomFactor:factor];
  }

  [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:factor];
  v9 = v8;
  _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController setZoomAmount:v9];

  _remoteShutterController2 = [(CAMViewfinderViewController *)self _remoteShutterController];
  [_remoteShutterController2 setZoomFactor:factor];
}

- (BOOL)_isActiveZooming
{
  if ([(CAMViewfinderViewController *)self _isPinchingForZoom])
  {
    return 1;
  }

  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  if ([_zoomControl isTracking])
  {
    isZooming = 1;
  }

  else
  {
    _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
    if ([_zoomSlider isTracking])
    {
      isZooming = 1;
    }

    else
    {
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      isZooming = [_dynamicShutterControl isZooming];
    }
  }

  return isZooming;
}

- (BOOL)_isZooming
{
  if ([(CAMViewfinderViewController *)self _isActiveZooming])
  {
    return 1;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isRampingVideoZoom = [_captureController isRampingVideoZoom];

  return isRampingVideoZoom;
}

- (void)_handleZoomPinchGestureRecognizer:(id)recognizer
{
  recognizerCopy = recognizer;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  state = [recognizerCopy state];
  if (state > 3)
  {
    if ((state - 4) < 2)
    {
      [(CAMZoomSlider *)self->__zoomSlider setVisibilityTimerSuspended:0];
      goto LABEL_8;
    }
  }

  else
  {
    switch(state)
    {
      case 1:
        [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        [(CAMViewfinderViewController *)self _setVideoZoomFactorAtPinchStart:?];
        _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [_dynamicShutterControl cancelZoom];

        if ([_currentGraphConfiguration devicePosition] != 1)
        {
          if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
          {
            [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
          }

          else
          {
            [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
          }

          if (![(CAMViewfinderViewController *)self _shouldHideZoomSliderForGraphConfiguration:_currentGraphConfiguration ignoreExpiredVisibilityTimer:1])
          {
            _zoomSlider = [(CAMViewfinderViewController *)self _zoomSlider];
            [_zoomSlider makeVisibleAnimated:0];

            _zoomSlider2 = [(CAMViewfinderViewController *)self _zoomSlider];
            [_zoomSlider2 setVisibilityTimerSuspended:1];
          }
        }

        _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
        [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
        [_zoomReporter zoomBeganWithFactor:objc_msgSend(_currentGraphConfiguration device:"device") interactionType:{1, v16}];

        break;
      case 2:
        [(CAMViewfinderViewController *)self _videoZoomFactorAtPinchStart];
        v11 = v10;
        [recognizerCopy zoomScale];
        v17[0] = MEMORY[0x1E69E9820];
        v17[1] = 3221225472;
        v17[2] = __65__CAMViewfinderViewController__handleZoomPinchGestureRecognizer___block_invoke;
        v17[3] = &unk_1E76F99C0;
        v17[4] = self;
        [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:1 rampDuration:v17 interactionType:v11 * v12 didChangeDevice:0.0];
        break;
      case 3:
        [(CAMViewfinderViewController *)self _updateFocusAfterZoomIfNecessary];
        [(CAMZoomSlider *)self->__zoomSlider setVisibilityTimerSuspended:0];
        _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
        [_analyticsSessionEvent didZoomInteraction:1];

LABEL_8:
        _zoomReporter2 = [(CAMViewfinderViewController *)self _zoomReporter];
        [_zoomReporter2 zoomEndedFromSource:1];

        break;
    }
  }
}

uint64_t __65__CAMViewfinderViewController__handleZoomPinchGestureRecognizer___block_invoke(uint64_t a1, double a2)
{
  v3 = *(a1 + 32);
  [v3 _videoZoomFactorAtPinchStart];
  v5 = v4 * a2;

  return [v3 _setVideoZoomFactorAtPinchStart:v5];
}

- (void)_updateZoomFactorForZoomFactor:(double)factor rampDuration:(double)duration interactionType:(int64_t)type didChangeDevice:(id)device
{
  deviceCopy = device;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  devicePosition = [_currentGraphConfiguration devicePosition];
  v14 = +[CAMCaptureCapabilities capabilities];
  v15 = [v14 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration, "devicePosition")}];

  if (devicePosition == 1)
  {
    v16 = +[CAMCaptureCapabilities capabilities];
    v17 = [v16 frontZoomBehaviorForCaptureMode:objc_msgSend(_currentGraphConfiguration videoConfiguration:{"mode"), objc_msgSend(_currentGraphConfiguration, "videoConfiguration")}];

    v18 = v17 > 3;
    v19 = 2u >> (v17 & 0xF);
    if (v17 <= 3)
    {
      v20 = 8u >> (v17 & 0xF);
    }

    else
    {
      v20 = 0;
    }

    if (v17 <= 3)
    {
      v21 = 4u >> (v17 & 0xF);
    }

    else
    {
      v21 = 0;
    }

    if (v18)
    {
      v22 = 0;
    }

    else
    {
      v22 = v19;
    }
  }

  else
  {
    v20 = 0;
    v21 = 0;
    v22 = 0;
  }

  if ((type - 1) > 6)
  {
    v23 = 0;
  }

  else
  {
    v23 = qword_1A3A68558[type - 1];
  }

  if ((v21 | v22))
  {
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v25 = v24;
    v26 = +[CAMCaptureCapabilities capabilities];
    [v26 maximumZoomFactorForMode:mode device:device videoConfiguration:objc_msgSend(_currentGraphConfiguration videoStabilizationStrength:{"videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength")}];
    v28 = v27;

    v29 = fabs(v25 + -1.0) < 0.001;
    if (v28 > factor)
    {
      v29 = 0;
    }

    if (v29 || vabdd_f64(v25, v28) >= 0.001)
    {
      if (v29)
      {
        v30 = v28;
      }

      else
      {
        v30 = -1.0;
      }

      if (v30 <= 0.0)
      {
        goto LABEL_76;
      }
    }

    else
    {
      v30 = 1.0;
      if (factor > 1.0)
      {
        goto LABEL_76;
      }
    }

    if (v22)
    {
      [(CAMViewfinderViewController *)self _changeToZoomFactor:1 rampDuration:1 zoomRampTuning:v30 shouldAnimate:0.25];
    }

    else if (v21)
    {
      [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];
      [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:device zoomFactor:v30];
      v40.n128_u64[0] = 1.0;
      deviceCopy[2](v40);
    }

LABEL_75:
    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:type];
    goto LABEL_76;
  }

  if ((v20 & 1) == 0)
  {
    if (!v15)
    {
      if ([(CAMViewfinderViewController *)self _isZoomAllowedCurrently])
      {
        _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
        if (_zoomControl)
        {
          _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
          [_zoomControl2 minAvailableZoomFactor];
          v44 = v43;
        }

        else
        {
          v44 = 1.0;
        }

        _zoomControl3 = [(CAMViewfinderViewController *)self _zoomControl];
        if (_zoomControl3)
        {
          _zoomControl4 = [(CAMViewfinderViewController *)self _zoomControl];
          [_zoomControl4 maxAvailableZoomFactor];
          v59 = v58;
        }

        else
        {
          [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
          v59 = v60;
        }

        if (v59 >= factor)
        {
          factorCopy = factor;
        }

        else
        {
          factorCopy = v59;
        }

        if (factorCopy >= v44)
        {
          v62 = factorCopy;
        }

        else
        {
          v62 = v44;
        }

        [(CAMViewfinderViewController *)self _changeToZoomFactor:v23 rampDuration:1 zoomRampTuning:v62 shouldAnimate:duration];
        _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
        [_zoomReporter zoomChangedToFactor:device device:type interactionType:v62];

        goto LABEL_75;
      }

      v46 = +[CAMCaptureCapabilities capabilities];
      v47 = [v46 resolvedDeviceForDesiredDevice:device mode:mode videoConfiguration:objc_msgSend(_currentGraphConfiguration videoStabilizationStrength:"videoConfiguration") frontRearSimultaneousVideoEnabled:{objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength"), objc_msgSend(_currentGraphConfiguration, "frontRearSimultaneousVideoEnabled")}];

      v48 = [CAMZoomControlUtilities deviceForEmulatingZoomFactor:v47 fromDevice:mode mode:0 continuousZoomSupported:factor];
      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      [CAMZoomControlUtilities appropriateSignificantZoomFactorForDevice:"appropriateSignificantZoomFactorForDevice:fromDevice:currentZoomFactor:targetZoomFactor:mode:" fromDevice:v48 currentZoomFactor:v47 targetZoomFactor:mode mode:?];
      v50 = v49;
      if (v48 != v47 || ([(CAMViewfinderViewController *)self _cachedVideoZoomFactor], v51 != v50))
      {
        [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:v48 zoomFactor:v50];
        [CAMZoomControlUtilities zoomScaleFromDevice:v47 toDevice:v48];
        (deviceCopy[2])();
        [(CAMViewfinderViewController *)self _setLastZoomInteractionType:type];
        v47 = v48;
      }

      _zoomReporter2 = [(CAMViewfinderViewController *)self _zoomReporter];
      [_zoomReporter2 zoomChangedToFactor:v47 device:type interactionType:v50];

      goto LABEL_76;
    }

    v35 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", mode, [_currentGraphConfiguration devicePosition]);
    v36 = +[CAMCaptureCapabilities capabilities];
    v37 = v36;
    if (v35 > 2)
    {
      if (v35 != 3)
      {
        if (v35 != 4)
        {
          goto LABEL_63;
        }

        [v36 smartFramingFieldOfViewZoomedOutLandscapeZoomFactor];
        if (v45 < factor)
        {
          goto LABEL_63;
        }

        v39 = 3;
        goto LABEL_62;
      }

      [v36 smartFramingFieldOfViewLandscapeZoomFactor];
      if (v54 <= factor)
      {
        v39 = 4;
        goto LABEL_62;
      }
    }

    else
    {
      if (v35 != 1)
      {
        if (v35 != 2)
        {
          goto LABEL_63;
        }

        [v36 smartFramingFieldOfViewPortraitZoomFactor];
        if (v38 > factor)
        {
          goto LABEL_63;
        }

        v39 = 1;
        goto LABEL_62;
      }

      [v36 smartFramingFieldOfViewZoomedOutPortraitZoomFactor];
      if (v53 >= factor)
      {
        v39 = 2;
LABEL_62:
        [(CAMViewfinderViewController *)self set_desiredFieldOfView:v39];
        [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
        _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration2 rampDuration:v23 zoomRampTuning:1 animated:duration];
      }
    }

LABEL_63:

    goto LABEL_76;
  }

  v31 = 10;
  if (factor > 0.5)
  {
    v31 = device;
  }

  if (device != 10 || factor < 2.0)
  {
    v33 = v31;
  }

  else
  {
    v33 = 8;
  }

  if (v33 != device)
  {
    [(CAMViewfinderViewController *)self _setReconfiguringForZoomChange:1];
    [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:v33];
    [CAMZoomControlUtilities zoomScaleFromDevice:device toDevice:v33];
    deviceCopy[2](v34);
    goto LABEL_75;
  }

LABEL_76:
}

- (void)zoomSliderDidBeginAutozooming:(id)autozooming
{
  captureController = self->__captureController;
  autozoomingCopy = autozooming;
  if ([(CUCaptureController *)captureController isCapturingVideo])
  {
    v6 = 0.75;
  }

  else
  {
    v6 = 1.5;
  }

  [(CAMViewfinderViewController *)self _currentMaximumZoomFactor];
  v8 = v7;
  isMinimumAutozooming = [autozoomingCopy isMinimumAutozooming];

  if (isMinimumAutozooming)
  {
    v8 = 1.0;
  }

  [(CAMViewfinderViewController *)self _setShouldIgnoreZoomFactorKVOForRamping:0];
  v10 = self->__captureController;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  *&v12 = v6;
  [(CUCaptureController *)v10 startRampToVideoZoomFactor:_currentGraphConfiguration withRate:v8 graphConfiguration:v12];

  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (void)willShowZoomSlider:(id)slider withAnimationDuration:(double)duration
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:slider];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];
}

- (void)willHideZoomSlider:(id)slider withAnimationDuration:(double)duration
{
  v5 = [(CAMViewfinderViewController *)self _currentGraphConfiguration:slider];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:v5 animated:1];
}

- (void)_updateFocusAfterZoomIfNecessary
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode <= 8 && ((1 << _currentMode) & 0x107) != 0)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    if ([_captureController isCapturingVideo])
    {
      [_captureController focusAtCenterForVideoRecording];
    }
  }
}

- (void)_configureZoomControlForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:configurationCopy])
  {
    v64 = animatedCopy;
    _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
    videoStabilizationStrength = [configurationCopy videoStabilizationStrength];
    if (videoStabilizationStrength <= 3)
    {
      [_zoomControl setHideFocalLengthLabels:(0xCu >> (videoStabilizationStrength & 0xF)) & 1];
    }

    mode = [configurationCopy mode];
    device = [configurationCopy device];
    if ((device - 1) > 0xA)
    {
      v11 = 0;
    }

    else
    {
      v11 = qword_1A3A685B0[device - 1];
    }

    videoConfiguration = [configurationCopy videoConfiguration];
    v13 = +[CAMCaptureCapabilities capabilities];
    v14 = [v13 resolvedDeviceForDesiredDevice:device mode:mode videoConfiguration:videoConfiguration videoStabilizationStrength:objc_msgSend(configurationCopy frontRearSimultaneousVideoEnabled:{"videoStabilizationStrength"), objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];
    v15 = [v13 isZoomAllowedForMode:mode device:v14 videoConfiguration:videoConfiguration videoStabilizationStrength:{objc_msgSend(configurationCopy, "videoStabilizationStrength")}];
    v16 = [v13 shouldAllowCameraToggleForMode:mode devicePosition:v11 videoConfiguration:videoConfiguration videoStabilizationStrength:objc_msgSend(configurationCopy frontRearSimultaneousVideoEnabled:{"videoStabilizationStrength"), objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled")}];
    [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
    v18 = v17;
    v19 = [v13 isQuadraWideBinningReconfigurationSupportedForMode:mode devicePosition:v11 videoConfiguration:videoConfiguration];
    if (v15)
    {
      currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
      if ([v13 isDepthSuggestionSupportedForMode:mode devicePosition:v11 photoFormat:currentPhotoFormat, v21] && -[CAMViewfinderViewController _depthEffectEnabledFromSuggestion](self, "_depthEffectEnabledFromSuggestion"))
      {
        if (([v13 portraitInPhotoModeBehavior] & 4) != 0)
        {
          _trueVideoSourceCaptureMode = 6;
        }

        else
        {
          _trueVideoSourceCaptureMode = mode;
        }

        v61 = ([v13 portraitInPhotoModeBehavior] >> 1) & 1;
      }

      else
      {
        v61 = 0;
        _trueVideoSourceCaptureMode = mode;
      }

      v29 = [(CAMViewfinderViewController *)self _useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:configurationCopy];
      v30 = _zoomControl;
      if ([configurationCopy trueVideoEnabled] && !v29)
      {
        _trueVideoSourceCaptureMode = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      }

      v66 = 0;
      v67 = 0;
      v31 = +[CAMZoomControlUtilities shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:](CAMZoomControlUtilities, "shouldApplyContinuousZoomForMode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:zoomFactors:displayZoomFactors:", _trueVideoSourceCaptureMode, v14, videoConfiguration, [configurationCopy videoStabilizationStrength], objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled"), &v67, &v66);
      v32 = v67;
      v33 = v66;
      if (v31)
      {
        v34 = +[CAMUserPreferences preferences];
        if (v61 & 1 | (([v13 isCustomLensSupportedForMode:mode device:v14 isTrueVideo:{objc_msgSend(configurationCopy, "trueVideoEnabled")}] & 1) == 0))
        {
          customLensGroup = 0;
        }

        else
        {
          customLensGroup = [v34 customLensGroup];
        }

        v57 = [CAMZoomPoint zoomPointsWithFactors:v32 displayZoomFactors:v33 customLensGroup:customLensGroup];
        _zoomControl = v30;
        if (mode == 6 && ([v13 continuousZoomSupportedForPortraitMode] & 1) != 0)
        {
          v61 = 1;
        }

        [v30 setPreferredCustomLens:{objc_msgSend(v34, "defaultCustomLens")}];
        [v30 configureForContinuousZoomWithZoomFactor:v57 zoomPoints:0 createButtonForMaxZoomFactor:v61 compactPlatterLayout:v64 animated:v18];
      }

      else
      {
        _zoomControl = v30;
        if (!((v14 > 0xB) | (0xFDu >> v14) & 1))
        {
          v54 = [v30 zoomButtonContentType] == 1 && v64;
          [v30 configureForZoomSymbolToggle];
          videoStabilizationStrength2 = [configurationCopy videoStabilizationStrength];
          v56 = v54;
          _zoomControl = v30;
          [(CAMViewfinderViewController *)self _updateZoomButtonSymbolForMode:mode device:v14 videoConfiguration:videoConfiguration zoomFactor:videoStabilizationStrength2 videoStabilizationStrength:v56 animated:v18];
        }
      }
    }

    else
    {
      if (v14 == 2)
      {
        v23 = v19;
      }

      else
      {
        v23 = 0;
      }

      if (v23 == 1 && mode == 6)
      {
        [v13 maximumZoomFactorForMode:6 device:2 videoConfiguration:videoConfiguration videoStabilizationStrength:{objc_msgSend(configurationCopy, "videoStabilizationStrength")}];
        v25 = v24;
        [v13 quadraWideRelativeZoomFactor];
        v27 = v25 * v26;
        [v13 wideDisplayZoomFactor];
        [_zoomControl configureForSingleCameraToggleOnlyWithZoomFactor:v18 minimumZoomFactor:1.0 displayMinimumZoomFactor:v28 maximumZoomFactor:v27 displayMaximumZoomFactor:v27];
      }

      else if (v16)
      {
        v63 = _zoomControl;
        v36 = [v13 isSuperWideSupportedForDevicePosition:v11];
        v62 = [v13 isTelephotoSupportedForDevicePosition:v11];
        v37 = [v13 isDualDeviceDisparitySupportedForMode:mode devicePosition:v11];
        v60 = [v13 isQuadraWideZoomButtonSupportedForMode:mode devicePosition:v11 videoConfiguration:videoConfiguration];
        v38 = [v13 isQuadraTeleZoomButtonSupportedForMode:mode devicePosition:v11 videoConfiguration:videoConfiguration];
        [v13 quadraWideDisplayZoomFactor];
        v40 = v39;
        if ([v13 isZoomPlatterSupportedForMode:mode devicePosition:v11 videoConfiguration:videoConfiguration])
        {
          v59 = v38;
          v41 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:4];
          if (!(v37 & 1 | ((v36 & 1) == 0)))
          {
            v42 = MEMORY[0x1E696AD98];
            [v13 superWideDisplayZoomFactor];
            v43 = [v42 numberWithDouble:?];
            [v41 addObject:v43];
          }

          v44 = MEMORY[0x1E696AD98];
          [v13 wideDisplayZoomFactor];
          v45 = [v44 numberWithDouble:?];
          [v41 addObject:v45];

          if (v60)
          {
            v46 = [MEMORY[0x1E696AD98] numberWithDouble:v40];
            [v41 addObject:v46];
          }

          if (v62)
          {
            v47 = MEMORY[0x1E696AD98];
            [v13 telephotoDisplayZoomFactor];
            v48 = [v47 numberWithDouble:?];
            [v41 addObject:v48];
          }

          if (v59)
          {
            v49 = MEMORY[0x1E696AD98];
            [v13 quadraTeleDisplayZoomFactor];
            v50 = [v49 numberWithDouble:?];
            [v41 addObject:v50];
          }

          +[CAMZoomControlUtilities zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", mode, v14, videoConfiguration, [configurationCopy videoStabilizationStrength], objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled"), v18);
          v65[0] = MEMORY[0x1E69E9820];
          v65[1] = 3221225472;
          v65[2] = __83__CAMViewfinderViewController__configureZoomControlForGraphConfiguration_animated___block_invoke;
          v65[3] = &__block_descriptor_40_e25_B32__0__NSNumber_8Q16_B24l;
          v65[4] = v51;
          v52 = [v41 indexOfObjectPassingTest:v65];
          v53 = [v41 count] >= 2 && -[CAMViewfinderViewController _wantsLightingControlForGraphConfiguration:](self, "_wantsLightingControlForGraphConfiguration:", configurationCopy);
          _zoomControl = v63;
          [v63 configureForSelectionOnlyWithDisplayZoomFactors:v41 selectedIndex:v52 compactPlatterLayout:v53 animated:v64];
        }

        else
        {
          +[CAMZoomControlUtilities zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:](CAMZoomControlUtilities, "zoomControlDisplayValueForZoomFactor:mode:device:videoConfiguration:videoStabilizationStrength:frontRearSimultaneousVideoEnabled:", mode, v14, videoConfiguration, [configurationCopy videoStabilizationStrength], objc_msgSend(configurationCopy, "frontRearSimultaneousVideoEnabled"), 1.0);
          _zoomControl = v63;
          [v63 configureForToggleOnlyWithZoomFactor:1.0 displayZoomFactor:v58];
        }
      }
    }
  }
}

- (void)_updateZoomControlAccessoryStateAnimated:(BOOL)animated
{
  animatedCopy = animated;
  v5 = ([(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus]- 9) < 2;
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  [_zoomControl setZoomButtonAccessoryState:v5 animated:animatedCopy];
}

- (void)_handleTouchDownForZoomControl:(id)control
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl cancelZoom];
}

- (void)zoomControl:(id)control didChangeZoomFactor:(double)factor interactionType:(int64_t)type
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = 3;
  if (type != 1)
  {
    v8 = 0;
  }

  if (type)
  {
    v9 = v8;
  }

  else
  {
    v9 = 2;
  }

  [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:type interactionType:factor];
  _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
  [_zoomReporter zoomChangedToFactor:objc_msgSend(_currentGraphConfiguration device:"device") interactionType:{v9, factor}];
}

- (void)_zoomControlDidChangeZoomFactor:(double)factor interactionType:(int64_t)type
{
  v23 = *MEMORY[0x1E69E9840];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:_currentGraphConfiguration])
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];

    if (type == 1)
    {
      if (isCapturingVideo)
      {
        v16 = 0.2;
      }

      else
      {
        v16 = 0.1;
      }

      [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
      v10 = v16 * fabs(log(factor / v17) / 0.693147181);
      v12 = 1;
      v11 = 3;
    }

    else
    {
      v10 = 0.25;
      if (isCapturingVideo)
      {
        v10 = 0.5;
      }

      if (type)
      {
        v10 = 0.0;
        v11 = 0;
      }

      else
      {
        v11 = 2;
      }

      if (type)
      {
        v12 = 0;
      }

      else
      {
        v12 = 3;
      }
    }

    [(CAMViewfinderViewController *)self _changeToZoomFactor:v12 rampDuration:0 zoomRampTuning:factor shouldAnimate:v10];
    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:v11];
    if (type == 1)
    {
      _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
      [_analyticsSessionEvent didZoomInteraction:3];
    }
  }

  else
  {
    v13 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = @"tap";
      if (type != 1)
      {
        v14 = 0;
      }

      if (!type)
      {
        v14 = @"drag";
      }

      v15 = v14;
      v19 = 138543618;
      v20 = v15;
      v21 = 2114;
      v22 = _currentGraphConfiguration;
      _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "Ignoring zoom control %{public}@ because zoom control should not be enabled for %{public}@", &v19, 0x16u);
    }
  }
}

- (BOOL)canToggleBetweenZoomFactorsForZoomControl:(id)control
{
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== 1)
  {
    LOBYTE(v4) = 1;
  }

  else
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    v4 = [_captureController isCapturingVideo] ^ 1;
  }

  return v4;
}

- (void)toggleBetweenZoomFactorsForZoomControl:(id)control
{
  v16 = *MEMORY[0x1E69E9840];
  controlCopy = control;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v6 = [(CAMViewfinderViewController *)self _wantsZoomControlForGraphConfiguration:_currentGraphConfiguration];

  if (v6)
  {
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    mode = [_currentGraphConfiguration2 mode];
    _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v10 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", mode, [_currentGraphConfiguration3 devicePosition]);

    if (v10)
    {
      [(CAMViewfinderViewController *)self _toggleZoomForSmartFramingFieldOfView:v10];
    }

    else
    {
      _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
      if (_currentDevicePosition == 1)
      {
        [(CAMViewfinderViewController *)self _toggleBetweenFrontFacingZoomFactorsForZoomControl:controlCopy];
      }

      else if (!_currentDevicePosition)
      {
        [(CAMViewfinderViewController *)self _toggleBetweenBackFacingZoomFactorsForZoomControl:controlCopy];
      }
    }
  }

  else
  {
    v11 = os_log_create("com.apple.camera", "Zoom");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v14 = 138543362;
      v15 = _currentGraphConfiguration4;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Ignoring zoom control tap because zoom control should not be enabled for %{public}@", &v14, 0xCu);
    }
  }
}

- (void)_toggleZoomForSmartFramingFieldOfView:(int64_t)view
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isReticleAnimating = [_fullscreenViewfinder isReticleAnimating];

  if (isReticleAnimating)
  {
    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v11 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Ignoring smart framing zoom toggle, reticle animating", v11, 2u);
    }
  }

  else
  {
    if ((view - 1) <= 3)
    {
      [(CAMViewfinderViewController *)self set_desiredFieldOfView:qword_1A3A68590[view - 1]];
    }

    v8 = +[CAMCaptureCapabilities capabilities];
    [v8 zoomFactorForSmartFramingFieldOfView:{-[CAMViewfinderViewController _desiredFieldOfView](self, "_desiredFieldOfView")}];
    v10 = v9;

    [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:1 interactionType:v10];

    [(CAMViewfinderViewController *)self _disableAutoSmartFramingIfSupported];
  }
}

- (void)_toggleBetweenBackFacingZoomFactorsForZoomControl:(id)control
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  devicePosition = [_currentGraphConfiguration devicePosition];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  videoStabilizationStrength = [_currentGraphConfiguration videoStabilizationStrength];
  v9 = +[CAMCaptureCapabilities capabilities];
  v10 = [v9 isTelephotoSupportedForDevicePosition:devicePosition];
  v11 = [v9 isDualSupportedForMode:mode devicePosition:devicePosition videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength];
  v12 = [v9 isSuperWideSupportedForDevicePosition:devicePosition];
  v13 = [v9 isWideDualSupportedForMode:mode devicePosition:devicePosition videoConfiguration:videoConfiguration videoStabilizationStrength:videoStabilizationStrength];
  if (device > 3)
  {
    v14 = 4;
    if (v13)
    {
      v14 = 6;
    }

    v15 = 2;
    v18 = 4;
    if (device != 6)
    {
      v18 = device;
    }

    if (device != 5)
    {
      v15 = v18;
    }

    v17 = device == 4;
  }

  else
  {
    v14 = 5;
    if (!v12)
    {
      v14 = 0;
    }

    if (v10)
    {
      v14 = 3;
    }

    if ((v13 & v11) != 0)
    {
      v14 = 6;
    }

    v15 = 2;
    if (v12)
    {
      v15 = 5;
    }

    if (v10)
    {
      v15 = 3;
    }

    v16 = 2;
    if (v12)
    {
      v16 = 5;
    }

    if (device != 3)
    {
      v16 = device;
    }

    if (device != 2)
    {
      v15 = v16;
    }

    v17 = device == 0;
  }

  if (v17)
  {
    v19 = v14;
  }

  else
  {
    v19 = v15;
  }

  [(CAMViewfinderViewController *)self handleUserChangedToMode:mode device:v19];
  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (void)_toggleBetweenFrontFacingZoomFactorsForZoomControl:(id)control
{
  controlCopy = control;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  device = [_currentGraphConfiguration device];
  devicePosition = [_currentGraphConfiguration devicePosition];
  videoConfiguration = [_currentGraphConfiguration videoConfiguration];
  zoomButtonSymbol = [controlCopy zoomButtonSymbol];

  v10 = +[CAMCaptureCapabilities capabilities];
  v11 = [v10 isSuperWideSupportedForDevicePosition:devicePosition];

  v12 = +[CAMCaptureCapabilities capabilities];
  v13 = v12;
  if (v11)
  {
    [v12 superWideToWideZoomFactorForDevicePosition:devicePosition];
  }

  else
  {
    [v12 maximumZoomFactorForMode:mode device:device videoConfiguration:videoConfiguration videoStabilizationStrength:{objc_msgSend(_currentGraphConfiguration, "videoStabilizationStrength")}];
  }

  v15 = v14;

  v16 = v15 + 0.01;
  [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
  if (zoomButtonSymbol == 1)
  {
    v17 = v17 / v16;
  }

  else if (!zoomButtonSymbol)
  {
    v17 = v17 * v16;
  }

  [(CAMViewfinderViewController *)self _updateZoomFactorForZoomFactor:3 rampDuration:&__block_literal_global_1195 interactionType:v17 didChangeDevice:0.25];
}

- (void)zoomControl:(id)control didChangeSelectedButtonIndex:(unint64_t)index displayZoomFactor:(double)factor
{
  controlCopy = control;
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v9 = [(CAMViewfinderViewController *)self _deviceForSelectButtonZoomDisplayZoomFactor:factor];
  [(CAMViewfinderViewController *)self _zoomFactorForSelectButtonDisplayZoomFactor:v9 device:factor];
  v11 = v10;
  [controlCopy setZoomButtonAccessoryState:0 animated:1];

  [(CAMViewfinderViewController *)self handleUserChangedToMode:_currentMode device:v9 zoomFactor:v11];

  [(CAMViewfinderViewController *)self _setLastZoomInteractionType:3];
}

- (int64_t)_deviceForSelectButtonZoomDisplayZoomFactor:(double)factor
{
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v8 = +[CAMCaptureCapabilities capabilities];
  v9 = [v8 isDualDeviceDisparitySupportedForMode:_currentMode devicePosition:_currentDevicePosition];
  if (!_currentDevicePosition)
  {
    v10 = v9;
    [v8 superWideDisplayZoomFactor];
    if (v11 == factor)
    {
      _currentDevice = 5;
      goto LABEL_12;
    }

    [v8 wideDisplayZoomFactor];
    if (v12 == factor)
    {
      goto LABEL_5;
    }

    [v8 telephotoDisplayZoomFactor];
    if (v13 == factor)
    {
      goto LABEL_9;
    }

    [v8 quadraWideDisplayZoomFactor];
    if (v15 == factor)
    {
LABEL_5:
      if (v10)
      {
        _currentDevice = 6;
      }

      else
      {
        _currentDevice = 2;
      }

      goto LABEL_12;
    }

    [v8 quadraTeleDisplayZoomFactor];
    if (v16 == factor)
    {
LABEL_9:
      if (v10)
      {
        _currentDevice = 4;
      }

      else
      {
        _currentDevice = 3;
      }
    }

    else
    {
      v17 = os_log_create("com.apple.camera", "Zoom");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _deviceForSelectButtonZoomDisplayZoomFactor:];
      }
    }
  }

LABEL_12:

  return _currentDevice;
}

- (double)_zoomFactorForSelectButtonDisplayZoomFactor:(double)factor device:(int64_t)device
{
  v7 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if ((device - 1) > 0xA)
  {
    v9 = 0;
  }

  else
  {
    v9 = qword_1A3A685B0[device - 1];
  }

  _currentVideoConfiguration = [(CAMViewfinderViewController *)self _currentVideoConfiguration];
  if (![v7 isDualDeviceDisparitySupportedForMode:_currentMode devicePosition:v9])
  {
    if ([v7 isQuadraWideZoomButtonSupportedForMode:_currentMode devicePosition:v9 videoConfiguration:_currentVideoConfiguration] && (objc_msgSend(v7, "quadraWideDisplayZoomFactor"), v13 == factor))
    {
      [v7 quadraWideRelativeZoomFactor];
    }

    else
    {
      factorCopy = 1.0;
      if (![v7 isQuadraTeleZoomButtonSupportedForMode:_currentMode devicePosition:v9 videoConfiguration:_currentVideoConfiguration])
      {
        goto LABEL_16;
      }

      [v7 quadraTeleDisplayZoomFactor];
      if (v15 != factor)
      {
        goto LABEL_16;
      }

      [v7 quadraTeleRelativeZoomFactor];
    }

    factorCopy = v14;
    goto LABEL_16;
  }

  if (device == 4)
  {
    factorCopy = factor;
  }

  else
  {
    factorCopy = 1.0;
    if (device == 6)
    {
      [v7 superWideToWideZoomFactorForDevicePosition:0];
      factorCopy = v12 * factor;
    }
  }

LABEL_16:

  return factorCopy;
}

- (BOOL)zoomControlShouldSnapDialToSwitchOverZoomFactors:(id)factors
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  LODWORD(_captureController) = [_captureController2 isCapturingLivePhotoVideo];

  return ((isCapturingVideo | _captureController) & 1) == 0;
}

- (BOOL)_shouldAllowHapticsForCurrentState
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  return isCapturingVideo ^ 1;
}

- (void)zoomControlDidChangeShowingZoomDial:(id)dial
{
  dialCopy = dial;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  LODWORD(_currentGraphConfiguration) = [dialCopy isShowingZoomDial];
  if (_currentGraphConfiguration)
  {
    _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    [_analyticsSessionEvent didZoomInteraction:2];
  }
}

- (void)zoomControlDidChangePlatterExpanded:(id)expanded
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateLightingControlFadesForGraphConfiguration:_currentGraphConfiguration animated:1];
}

- (unint64_t)zoomControl:(id)control accessoryButtonTapIndexInDisplayZoomFactors:(id)factors
{
  factorsCopy = factors;
  if ([control zoomButtonAccessoryState] == 1)
  {
    if ([factorsCopy count] < 2)
    {
      v6 = 0;
    }

    else
    {
      v6 = [factorsCopy indexOfObject:&unk_1F16C8A58];
    }
  }

  else
  {
    v6 = 0x7FFFFFFFFFFFFFFFLL;
  }

  return v6;
}

- (void)zoomControlDidTapZoomButtonAccessory:(id)accessory
{
  accessoryCopy = accessory;
  if ([accessoryCopy zoomButtonAccessoryState] == 1)
  {
    [accessoryCopy setZoomButtonAccessoryState:0 animated:1];
  }
}

- (void)lightingControlDidChangeSelectedLightingType:(id)type
{
  selectedLightingType = [type selectedLightingType];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentMaxPhotoResolution = [(CAMViewfinderViewController *)self _currentMaxPhotoResolution];
  [(CAMViewfinderViewController *)self _setLightingType:selectedLightingType forMode:_currentMode];
  v13 = +[CAMCaptureCapabilities capabilities];
  if ([v13 smartStylesSupported])
  {
    [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
    [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  }

  if ([(CAMViewfinderViewController *)self _currentMaxPhotoResolution]!= _currentMaxPhotoResolution)
  {
    [(CAMViewfinderViewController *)self _prepareDeferredProcessingIfNeeded];
    [(CAMViewfinderViewController *)self _preparePhotoOutputForExpectedPhotoResolution];
  }

  [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
  _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
  [_lightingNameBadge setLightingType:selectedLightingType];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  lightingNameBadge = [_fullscreenViewfinder lightingNameBadge];
  [lightingNameBadge setLightingType:selectedLightingType];

  [(CAMViewfinderViewController *)self _updateControlDrawerContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updateControlStatusBarContentsVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setLightingType:selectedLightingType animated:1];

  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didChangePortraitLighting];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _startFlashingTransientLightingBadgeIfNecessaryForGraphConfiguration:_currentGraphConfiguration];
}

- (void)lightingControl:(id)control willChangeExpanded:(BOOL)expanded
{
  expandedCopy = expanded;
  controlCopy = control;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  if (expandedCopy)
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    v9 = [CAMUserPreferences defaultFilterTypeForMode:_currentMode];
    v10 = [(CAMViewfinderViewController *)self _effectFilterTypeForMode:_currentMode];
    [(CAMViewfinderViewController *)self _setEffectFilterType:v9 forMode:_currentMode];
    -[CAMViewfinderViewController _setLightingType:forMode:](self, "_setLightingType:forMode:", [controlCopy selectedLightingType], _currentMode);
    if (v10 != v9)
    {
      [(CAMViewfinderViewController *)self _updateCurrentPreviewFiltersOnCaptureController];
    }

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateFilterScrubberForGraphConfiguration:_currentGraphConfiguration];

    [(CAMViewfinderViewController *)self _updateFilterButtonOnState];
    [(CAMViewfinderViewController *)self _updateFilterNameBadgeAnimated:1];
  }

  _layoutStyle = [(CAMViewfinderViewController *)self _layoutStyle];
  v13 = 0.0;
  if ((_layoutStyle == 3 || !_layoutStyle) && expandedCopy)
  {
    [controlCopy frame];
    [controlCopy alignmentRectForFrame:?];
    v13 = v14;
  }

  [previewView setBottomContentInset:v13];
}

- (void)lightingControlDidChangeExpanded:(id)expanded
{
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];

  [(CAMViewfinderViewController *)self _updateTransientLightingBadgeVisibilityAnimated:1];
}

- (void)captureController:(id)controller receivedOverlayChangeSmartStyle:(id)style
{
  v21 = *MEMORY[0x1E69E9840];
  styleCopy = style;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v7 & 9) != 0)
  {
    if ((v7 & 8) != 0)
    {
      _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __81__CAMViewfinderViewController_captureController_receivedOverlayChangeSmartStyle___block_invoke;
      v15[3] = &unk_1E76F91A8;
      v10 = styleCopy;
      v16 = v10;
      v11 = [_semanticStyles indexOfObjectPassingTest:v15];

      if (v11 == 0x7FFFFFFFFFFFFFFFLL)
      {
        _semanticStyles3 = os_log_create("com.apple.camera", "SmartStyle");
        if (os_log_type_enabled(_semanticStyles3, OS_LOG_TYPE_DEFAULT))
        {
          _semanticStyles2 = [(CAMViewfinderViewController *)self _semanticStyles];
          *buf = 138543618;
          v18 = v10;
          v19 = 2114;
          v20 = _semanticStyles2;
          _os_log_impl(&dword_1A3640000, _semanticStyles3, OS_LOG_TYPE_DEFAULT, "Received overlay update for style %{public}@ that is not in array of styles: %{public}@", buf, 0x16u);
        }
      }

      else
      {
        [(CAMViewfinderViewController *)self _setSelectedSemanticStyleIndex:v11];
        _semanticStyles3 = [(CAMViewfinderViewController *)self _semanticStyles];
        [_semanticStyles3 setObject:v10 atIndexedSubscript:[(CAMViewfinderViewController *)self _selectedSemanticStyleIndex]];
      }
    }

    else if (v7)
    {
      _semanticStyles4 = [(CAMViewfinderViewController *)self _semanticStyles];
      [_semanticStyles4 setObject:styleCopy atIndexedSubscript:{-[CAMViewfinderViewController _smartStyleSystemStyleIndex](self, "_smartStyleSystemStyleIndex")}];
    }

    [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
    _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
    [_analyticsControlDrawerEvent didChangeValueForControlType:11];
  }
}

- (void)captureController:(id)controller receivedOverlayUpdateSmartStyle:(id)style
{
  styleCopy = style;
  v5 = +[CAMCaptureCapabilities capabilities];
  v6 = [v5 semanticStyleSupportForMode:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), -[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  if ((v6 & 8) != 0)
  {
    _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
    _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _selectedSemanticStyleIndex];
    goto LABEL_6;
  }

  if (v6)
  {
    _smartStyleSystemStyleIndex = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
    _semanticStyles2 = [(CAMViewfinderViewController *)self _semanticStyles];
    v9 = [_semanticStyles2 count];

    if (_smartStyleSystemStyleIndex < v9)
    {
      _semanticStyles = [(CAMViewfinderViewController *)self _semanticStyles];
      _selectedSemanticStyleIndex = [(CAMViewfinderViewController *)self _smartStyleSystemStyleIndex];
LABEL_6:
      [_semanticStyles setObject:styleCopy atIndexedSubscript:_selectedSemanticStyleIndex];
    }
  }

  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:1];
  _analyticsControlDrawerEvent = [(CAMViewfinderViewController *)self _analyticsControlDrawerEvent];
  [_analyticsControlDrawerEvent didChangeValueForControlType:11];
}

- (void)captureController:(id)controller receivedOverlayApertureControlActive:(BOOL)active
{
  activeCopy = active;
  v6 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  currentPhotoFormat = [(CAMViewfinderViewController *)self currentPhotoFormat];
  v11 = [v6 isDepthSuggestionSupportedForMode:_currentMode devicePosition:_currentDevicePosition photoFormat:currentPhotoFormat, v10];

  v12 = +[CAMUserPreferences preferences];
  shouldUseDepthSuggestionInPhotoMode = [v12 shouldUseDepthSuggestionInPhotoMode];

  if (activeCopy && v11 && shouldUseDepthSuggestionInPhotoMode)
  {

    [(CAMViewfinderViewController *)self updateDepthEffectSuggestionEnabled:1];
  }
}

- (void)captureController:(id)controller receivedSystemOverlayUpdateExposureBias:(double)bias
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController cachedExposureTargetBias];
  v8 = v7;

  v9 = bias - v8;
  v10 = v9;

  [(CAMViewfinderViewController *)self _handleUserChangedToExposureSliderBias:0 updateSystemOverlayValues:v10];
}

- (void)captureController:(id)controller receivedSystemOverlayLensSelectorZoomFactor:(double)factor
{
  v6 = *MEMORY[0x1E69938E8];
  if ([(CAMViewfinderViewController *)self _currentDevicePosition]== (v6 == factor))
  {
    if ([(CAMViewfinderViewController *)self _isReconfiguring])
    {

      [(CAMViewfinderViewController *)self _changeToZoomFactor:0 rampDuration:0 zoomRampTuning:0 shouldAnimate:factor updateOverlay:0.0];
    }

    else
    {
      [(CAMViewfinderViewController *)self _zoomControlDidChangeZoomFactor:1 interactionType:factor];
      _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
      [_zoomReporter zoomChangedToFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{7, factor}];
    }
  }

  else
  {
    v7 = +[CAMUserPreferences preferences];
    v8 = [v7 defaultDeviceForModeChange:-[CAMViewfinderViewController _currentMode](self devicePosition:{"_currentMode"), v6 == factor}];

    if (v6 == factor)
    {

      [(CAMViewfinderViewController *)self _handleUserChangedToDevice:v8];
    }

    else
    {
      _currentMode = [(CAMViewfinderViewController *)self _currentMode];

      [(CAMViewfinderViewController *)self handleUserChangedToMode:_currentMode device:v8 zoomFactor:factor];
    }
  }
}

- (void)captureController:(id)controller receivedOverlayVisible:(BOOL)visible
{
  visibleCopy = visible;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setSystemOverlayVisible:visibleCopy animated:1];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)captureController:(id)controller receivedQuietUIActive:(BOOL)active
{
  activeCopy = active;
  activeCopy2 = active;
  [(CAMViewfinderViewController *)self _setCurrentHalfPressSpotlight:active];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setSpotlightControl:activeCopy2 animated:1];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsQuietUIActive:activeCopy];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];

  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Spotlight changed"];
}

- (void)captureController:(id)controller receivedFocusLocked:(BOOL)locked
{
  lockedCopy = locked;
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setFocusAndExposureExternallyLocked:lockedCopy];

  if (lockedCopy)
  {
    _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
    [_feedbackController performDiscreteFeedback:2];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)captureController:(id)controller willRecoverFromRuntimeError:(id)error
{
  v4 = [(CAMViewfinderViewController *)self _closedViewfinderController:controller];
  [v4 addClosedViewfinderReason:5];
}

- (void)captureControllerDidStartRunning:(id)running
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerDidStartRunning:", v11, 2u);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController removeClosedViewfinderReason:2];
  _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
  isPreviewDisabled = [_disabledPreviewController isPreviewDisabled];

  if ((isPreviewDisabled & 1) == 0)
  {
    [_closedViewfinderController removeClosedViewfinderReason:3 afterDelay:0.5];
  }

  v8 = +[CAMCaptureCapabilities capabilities];
  shouldPreventConnectionHandover = [v8 shouldPreventConnectionHandover];

  if (shouldPreventConnectionHandover)
  {
    _preventConnectionHandoverAssertionController = [(CAMViewfinderViewController *)self _preventConnectionHandoverAssertionController];
    [_preventConnectionHandoverAssertionController requestAssertionIfUnheld];
  }
}

- (void)captureControllerDidStopRunning:(id)running
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerDidStopRunning:", v8, 2u);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:2];
  [_closedViewfinderController cancelDelayedRemovalOfReason:3];
  [_closedViewfinderController addClosedViewfinderReason:3];
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController notifyCaptureSessionDidStopRunning];
  [(CAMViewfinderViewController *)self _handleGeneralCaptureControllerSuspension];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController resetNavigation];
  [_cameraRollController beginAllowingStagedMediaLoading];
}

- (void)_handleGeneralCaptureControllerSuspension
{
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  if (![(CAMViewfinderViewController *)self _isCapturingTimelapse])
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl resetAnimated:1];
  }

  _controlDrawer = [(CAMViewfinderViewController *)self _controlDrawer];
  nightModeSlider = [_controlDrawer nightModeSlider];
  [nightModeSlider endCaptureAnimationAnimated:1];

  _nightModeInstructionLabel = [(CAMViewfinderViewController *)self _nightModeInstructionLabel];
  [_nightModeInstructionLabel cancelCountDown];

  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(nightModeSlider) = [v7 shouldPreventConnectionHandover];

  if (nightModeSlider)
  {
    _preventConnectionHandoverAssertionController = [(CAMViewfinderViewController *)self _preventConnectionHandoverAssertionController];
    [_preventConnectionHandoverAssertionController releaseAssertionIfHeld];
  }
}

- (void)captureControllerWasInterrupted:(id)interrupted
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerWasInterrupted:", v8, 2u);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:4];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }

  [(CAMViewfinderViewController *)self _handleGeneralCaptureControllerSuspension];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capture Controller Interrupted"];
  v6 = +[CAMCaptureCapabilities capabilities];
  if ([v6 isLongPressVideoCaptureFromPhotoModeSupported])
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];

    if (!_currentMode)
    {
      [(CAMViewfinderViewController *)self _updateUIForCapturing:0 animated:0];
    }
  }

  else
  {
  }
}

- (void)captureControllerInterruptionEnded:(id)ended
{
  v4 = os_log_create("com.apple.camera", "CaptureSession");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "captureControllerInterruptionEnded:", v7, 2u);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController removeClosedViewfinderReason:4];
  if (!+[CAMApplication appOrPlugInState])
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:_currentMode];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:_currentMode];
  }

  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1];
  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Capture Controller Interruption Ended"];
}

- (void)prepareForDefaultImageSnapshotForScreen:(id)screen
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "prepareForDefaultImageSnapshotForScreen:", v5, 2u);
  }

  [(CAMViewfinderViewController *)self _ensureSensitiveContentHidden];
  [(CAMViewfinderViewController *)self _forceHideBadgesAnimated:0];
  [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:0];
}

- (id)_debugStringForApplicationDeactivationReason:(int)reason
{
  if (reason < 0x1F && ((0x4000FDFFu >> reason) & 1) != 0)
  {
    reason = off_1E76FA038[reason];
  }

  else
  {
    reason = [objc_alloc(MEMORY[0x1E696AEC0]) initWithFormat:@"Unknown deactivation reason %lu", reason];
  }

  return reason;
}

- (void)_handleApplicationWillAddDeactivationReason:(id)reason
{
  v15 = *MEMORY[0x1E69E9840];
  userInfo = [reason userInfo];
  v5 = [userInfo objectForKeyedSubscript:*MEMORY[0x1E69DE838]];
  integerValue = [v5 integerValue];

  v7 = [(CAMViewfinderViewController *)self _debugStringForApplicationDeactivationReason:integerValue];
  v8 = os_log_create("com.apple.camera", "DeactivationReasons");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v13 = 138543362;
    v14 = v7;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Will add deactivation reason %{public}@", &v13, 0xCu);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v10 = _closedViewfinderController;
  switch(integerValue)
  {
    case 0:
    case 4:
    case 5:
    case 12:
    case 15:
      break;
    case 1:
      v11 = 12;
      goto LABEL_13;
    case 2:
      [_closedViewfinderController addClosedViewfinderReason:13];
      if ([(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
      {
        goto LABEL_15;
      }

      break;
    case 3:
      [_closedViewfinderController addClosedViewfinderReason:14];
      if ([(CAMViewfinderViewController *)self _capturingFromPhysicalButton])
      {
        [(CAMViewfinderViewController *)self _stopRecordingForDeactivationReason:v7];
      }

      if ([(CAMViewfinderViewController *)self _currentMode]!= 6)
      {
        break;
      }

      _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [_disabledPreviewController addDisabledPreviewReason:2];
      goto LABEL_21;
    case 6:
      v11 = 16;
      goto LABEL_13;
    case 7:
      [_closedViewfinderController addClosedViewfinderReason:17];
LABEL_15:
      [(CAMViewfinderViewController *)self _stopRecordingForDeactivationReason:v7];
      break;
    case 8:
      v11 = 18;
      goto LABEL_13;
    case 10:
      _disabledPreviewController = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(_disabledPreviewController, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_20;
      }

      goto LABEL_21;
    case 11:
      [_closedViewfinderController addClosedViewfinderReason:19];
      _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [_disabledPreviewController removeDisabledPreviewReason:2];
      goto LABEL_21;
    case 13:
      v11 = 20;
LABEL_13:
      [_closedViewfinderController addClosedViewfinderReason:v11];
      break;
    default:
      _disabledPreviewController = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(_disabledPreviewController, OS_LOG_TYPE_ERROR))
      {
LABEL_20:
        [CAMViewfinderViewController _handleApplicationWillAddDeactivationReason:];
      }

LABEL_21:

      break;
  }
}

- (void)_stopRecordingForDeactivationReason:(id)reason
{
  v13 = *MEMORY[0x1E69E9840];
  reasonCopy = reason;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode <= 8)
  {
    if (((1 << _currentMode) & 0x186) != 0)
    {
      if ([_captureController isCapturingVideo])
      {
        v7 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = reasonCopy;
          _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Stopping video capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingVideo];
LABEL_7:
        _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        [_dynamicShutterControl resetAnimated:1];
      }
    }

    else
    {
      if (!_currentMode)
      {
        if (![_captureController isCapturingCTMVideo])
        {
          goto LABEL_8;
        }

        v10 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = reasonCopy;
          _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, "Stopping video capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
        goto LABEL_7;
      }

      if (_currentMode == 3 && [_captureController isCapturingPanorama])
      {
        v9 = os_log_create("com.apple.camera", "Capture");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          v11 = 138543362;
          v12 = reasonCopy;
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Stopping panorama capture for deactivation reason %{public}@", &v11, 0xCu);
        }

        [(CAMViewfinderViewController *)self _stopCapturingPanorama];
        goto LABEL_7;
      }
    }
  }

LABEL_8:
}

- (void)_handleApplicationDidRemoveDeactivationReason:(id)reason
{
  v15 = *MEMORY[0x1E69E9840];
  userInfo = [reason userInfo];
  v5 = [userInfo objectForKeyedSubscript:*MEMORY[0x1E69DE838]];
  integerValue = [v5 integerValue];

  v7 = [(CAMViewfinderViewController *)self _debugStringForApplicationDeactivationReason:integerValue];
  v8 = os_log_create("com.apple.camera", "DeactivationReasons");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v13 = 138543362;
    v14 = v7;
    _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Did remove deactivation reason %{public}@", &v13, 0xCu);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  v10 = _closedViewfinderController;
  switch(integerValue)
  {
    case 0:
    case 5:
    case 10:
    case 12:
    case 15:
      break;
    case 1:
      v11 = 12;
      goto LABEL_13;
    case 2:
      v11 = 13;
      goto LABEL_13;
    case 3:
      [_closedViewfinderController removeClosedViewfinderReason:14];
      _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
      [_disabledPreviewController removeDisabledPreviewReason:2];
      goto LABEL_17;
    case 4:
      v11 = 15;
      goto LABEL_13;
    case 6:
      v11 = 16;
      goto LABEL_13;
    case 7:
      v11 = 17;
      goto LABEL_13;
    case 8:
      v11 = 18;
      goto LABEL_13;
    case 11:
      v11 = 19;
      goto LABEL_13;
    case 13:
      v11 = 20;
LABEL_13:
      [_closedViewfinderController removeClosedViewfinderReason:v11];
      break;
    default:
      _disabledPreviewController = os_log_create("com.apple.camera", "DeactivationReasons");
      if (os_log_type_enabled(_disabledPreviewController, OS_LOG_TYPE_ERROR))
      {
        [CAMViewfinderViewController _handleApplicationWillAddDeactivationReason:];
      }

LABEL_17:

      break;
  }
}

- (void)_handleApplicationDidBecomeActive:(id)active
{
  activeCopy = active;
  v5 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    LOWORD(buf[0]) = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Received UIApplicationDidBecomeActiveNotification", buf, 2u);
  }

  v6 = +[CAMUserPreferences preferences];
  resetTimeoutDate = [v6 resetTimeoutDate];
  v8 = [resetTimeoutDate dateByAddingTimeInterval:-0.01];

  date = [MEMORY[0x1E695DF00] date];
  [date timeIntervalSinceDate:v8];
  v11 = v10;

  if (v11 > 0.0 && [(CAMViewfinderViewController *)self _isAutoResumeCancelingWithoutBackgrounding])
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController startCaptureSessionWithRetryCount:3 retryInterval:@"became active with no auto-resume" logReason:0 completion:0.05];
  }

  [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:0];
  objc_initWeak(buf, self);
  mEMORY[0x1E69C4598] = [MEMORY[0x1E69C4598] sharedScheduler];
  v15[0] = MEMORY[0x1E69E9820];
  v15[1] = 3221225472;
  v15[2] = __65__CAMViewfinderViewController__handleApplicationDidBecomeActive___block_invoke;
  v15[3] = &unk_1E76F8580;
  objc_copyWeak(&v16, buf);
  [mEMORY[0x1E69C4598] scheduleDeferredMainQueueTask:v15];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  [(CAMViewfinderViewController *)self _updateFlashModeOnControllerForMode:_currentMode];
  [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:_currentMode];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  [(CAMViewfinderViewController *)self _enableProactiveSuggestionsAnimated:0];
  objc_destroyWeak(&v16);
  objc_destroyWeak(buf);
}

void __65__CAMViewfinderViewController__handleApplicationDidBecomeActive___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _updateDiskSpaceAlertViewVisibilityAnimated:0];
}

- (void)_handleApplicationWillResignActive:(id)active
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v16 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationWillResignActiveNotification", v16, 2u);
  }

  [(CAMViewfinderViewController *)self _writeUserPreferences];
  v5 = +[CAMUserPreferences preferences];
  if ([v5 preserveCaptureMode])
  {
  }

  else
  {
    isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];

    if (!isEmulatingImagePicker)
    {
      _currentMode = [(CAMViewfinderViewController *)self _currentMode];
      v8 = +[CAMUserPreferences defaultMode];
      _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
      v10 = +[CAMUserPreferences defaultDevicePosition];
      if (_currentMode != v8 || _currentDevicePosition != v10)
      {
        _captureController = [(CAMViewfinderViewController *)self _captureController];
        v12 = +[CAMUserPreferences preferences];
        resetTimeoutDate = [v12 resetTimeoutDate];
        [_captureController cancelAutoResumeAfterDate:resetTimeoutDate];

        [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:1];
      }
    }
  }

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:1];
  v14 = +[CAMCaptureCapabilities capabilities];
  isImageAnalysisSupported = [v14 isImageAnalysisSupported];

  if (isImageAnalysisSupported)
  {
    [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  }
}

- (void)_handleApplicationWillEnterForeground:(id)foreground
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationWillEnterForegroundNotification", buf, 2u);
  }

  _updateDuetSystemConstraintsIfNecessary = [(CAMViewfinderViewController *)self _updateDuetSystemConstraintsIfNecessary];
  [(CAMViewfinderViewController *)self _updateBadgeVisibilityAnimated:0];
  if (![(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    [(CAMViewfinderViewController *)self readUserPreferencesAndHandleChangesWithOverrides:0];
  }

  if (!_updateDuetSystemConstraintsIfNecessary)
  {
    [(CAMViewfinderViewController *)self _updateDuetSystemConstraintsIfNecessary];
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v7 = _captureController;
  if (self->_performingReviewUsingOverlay)
  {
    v8 = os_log_create("com.apple.camera", "CaptureSession");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *v13 = 0;
      _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Skipping session start since we're showing the review overlay screen", v13, 2u);
    }
  }

  else
  {
    [_captureController startCaptureSessionWithRetryCount:3 retryInterval:@"application will enter foreground" logReason:0 completion:0.05];
  }

  [(CAMViewfinderViewController *)self _resetZoom];
  if ([(CAMViewfinderViewController *)self _shouldUpdateCaptureOrientation])
  {
    [(CAMViewfinderViewController *)self _updateUIForCaptureOrientationAnimated:0];
  }

  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:0];
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController removeClosedViewfinderReason:7];
  [_closedViewfinderController removeClosedViewfinderReason:19];
  [_closedViewfinderController removeClosedViewfinderReason:13];
  v10 = +[CAMUserPreferences preferences];
  sharedLibraryEnabled = [v10 sharedLibraryEnabled];

  if (sharedLibraryEnabled)
  {
    _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
    [_librarySelectionController startNewSession];
  }

  [(CAMViewfinderViewController *)self generateAnalyticsSessionEventIfNeeded];
}

- (void)_handleApplicationDidEnterBackground:(id)background
{
  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v31 = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received UIApplicationDidEnterBackgroundNotification", v31, 2u);
  }

  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:7];
  [(CAMViewfinderViewController *)self _setAutoResumeCancelingWithoutBackgrounding:0];
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  [(CAMViewfinderViewController *)self _setImageAnalyzer:0];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  _visionAnalyticsSession = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_analyticsSessionEvent countEventsFromAnalyticsVisionSession:_visionAnalyticsSession];

  _visionAnalyticsSession2 = [(CAMViewfinderViewController *)self _visionAnalyticsSession];
  [_visionAnalyticsSession2 publish];

  [(CAMViewfinderViewController *)self _setVisionAnalyticsSession:0];
  v9 = +[CAMUserPreferences preferences];
  sharedLibraryAutoBehaviorEnabled = [v9 sharedLibraryAutoBehaviorEnabled];

  if (sharedLibraryAutoBehaviorEnabled)
  {
    _analyticsSessionEvent2 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
    didCapture = [_analyticsSessionEvent2 didCapture];

    if (didCapture)
    {
      v13 = [CAMAnalyticsSharedLibraryModeEvent alloc];
      _librarySelectionController = [(CAMViewfinderViewController *)self _librarySelectionController];
      v15 = [(CAMAnalyticsSharedLibraryModeEvent *)v13 initWithLibrarySelectionController:_librarySelectionController];

      [(CAMAnalyticsSharedLibraryModeEvent *)v15 publish];
    }
  }

  _analyticsSessionEvent3 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  _locationController = [(CAMViewfinderViewController *)self _locationController];
  [_analyticsSessionEvent3 updateForLocationController:_locationController];

  _analyticsSessionEvent4 = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent4 publish];

  [(CAMViewfinderViewController *)self _setAnalyticsSessionEvent:0];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {
    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }

  [(CAMViewfinderViewController *)self _setResolvedNightMode:0];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToNightMode:0];

  [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setControlDrawerExpanded:0 forReason:6 animated:0];

  [(CAMViewfinderViewController *)self _hideUtilityBarAnimated:0];
  if ([CAMZoomSlider shouldFadeOutZoomSliderForLayoutStyle:[(CAMViewfinderViewController *)self _layoutStyle]])
  {
    [(CAMZoomSlider *)self->__zoomSlider makeInvisibleAnimated:0];
  }

  [(CAMZoomControl *)self->__zoomControl setShouldShowZoomDial:0 animationDuration:0];
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController dismissCameraRollViewControllerForced:1 animated:0];
  v22 = +[CAMCaptureCapabilities capabilities];
  if (([v22 hostProcess] | 4) == 4 && objc_msgSend(v22, "isImageAnalysisSupported"))
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:0 completion:0];
  }

  if (sharedLibraryAutoBehaviorEnabled)
  {
    _librarySelectionController2 = [(CAMViewfinderViewController *)self _librarySelectionController];
    [_librarySelectionController2 stopAndClearAcquiredSignals];
  }

  [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:0];
  [(CAMViewfinderViewController *)self _updateLevelMotionTracking];
  [(CAMViewfinderViewController *)self _ensureSensitiveContentHidden];
  _transitionController = [(CAMViewfinderViewController *)self _transitionController];
  [_transitionController handleApplicationDidEnterBackground];

  _viewfinderTransitionable = [(CAMViewfinderViewController *)self _viewfinderTransitionable];
  [_viewfinderTransitionable prepareForResumingUsingCrossfade];

  [(CAMViewfinderViewController *)self _updateExternalStorageMonitoringState:2];
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  purgeableStorageContainer = [_storageController purgeableStorageContainer];
  [purgeableStorageContainer cancelPurge];

  +[CAMLensSmudgeDisplayState logDidEnterBackground];
  _lensSmudgeDisplayFrontState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayFrontState];
  [_lensSmudgeDisplayFrontState didEnterBackground];

  _lensSmudgeDisplayBackState = [(CAMViewfinderViewController *)self _lensSmudgeDisplayBackState];
  [_lensSmudgeDisplayBackState didEnterBackground];

  queuedViewfinderAction = [(CAMViewfinderViewController *)self queuedViewfinderAction];

  if (queuedViewfinderAction)
  {
    [(CAMViewfinderViewController *)self setQueuedViewfinderAction:0];
  }
}

- (void)_handleSceneDidEnterBackground:(id)background
{
  v23 = *MEMORY[0x1E69E9840];
  backgroundCopy = background;
  if ([(CAMViewfinderViewController *)self isEmulatingImagePicker])
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingVideo = [_captureController isCapturingVideo];

    if (isCapturingVideo)
    {
      object = [backgroundCopy object];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v20 = 0u;
        v21 = 0u;
        v18 = 0u;
        v19 = 0u;
        windows = [object windows];
        v9 = [windows countByEnumeratingWithState:&v18 objects:v22 count:16];
        if (v9)
        {
          v10 = v9;
          v11 = *v19;
          while (2)
          {
            v12 = 0;
            do
            {
              if (*v19 != v11)
              {
                objc_enumerationMutation(windows);
              }

              v13 = *(*(&v18 + 1) + 8 * v12);
              view = [(CAMViewfinderViewController *)self view];
              window = [view window];

              if (v13 == window)
              {

                v16 = os_log_create("com.apple.camera", "Capture");
                if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
                {
                  *v17 = 0;
                  _os_log_impl(&dword_1A3640000, v16, OS_LOG_TYPE_DEFAULT, "Stop recording video for backgrounded scene", v17, 2u);
                }

                [(CAMViewfinderViewController *)self _stopCapturingVideo];
                goto LABEL_16;
              }

              ++v12;
            }

            while (v10 != v12);
            v10 = [windows countByEnumeratingWithState:&v18 objects:v22 count:16];
            if (v10)
            {
              continue;
            }

            break;
          }
        }
      }

LABEL_16:
    }
  }
}

- (void)_updateProResControlsForCurrentState
{
  [(CAMViewfinderViewController *)self _updateFreeResourcesInstructionLabelForCurrentState];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateMaxRecordingTimeInstructionLabelForGraphConfiguration:_currentGraphConfiguration];
}

- (void)availableDiskSpaceChanged:(id)changed
{
  [(CAMViewfinderViewController *)self _updateDiskSpaceAlertViewVisibilityAnimated:1];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];
}

- (void)storageControllerDidChangePurgingState:(id)state
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateFullscreenViewfinderControlsVisibilityForGraphConfiguration:_currentGraphConfiguration animated:1];

  [(CAMViewfinderViewController *)self _updateProResControlsForCurrentState];

  [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"did change purging state"];
}

- (void)_handleTimelapseLowDiskSpaceNotification:(id)notification
{
  notificationCopy = notification;
  v5 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    LOWORD(buf[0]) = 0;
    _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Received CAMTimelapseLowDiskSpaceNotification", buf, 2u);
  }

  _diskSpaceAlertController = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (!_diskSpaceAlertController)
  {
    userInfo = [notificationCopy userInfo];
    v8 = [userInfo objectForKeyedSubscript:@"CAMTimelapseLowDiskSpaceTitleInfo"];
    v9 = [userInfo objectForKeyedSubscript:@"CAMTimelapseLowDiskSpaceMessageInfo"];
    objc_initWeak(buf, self);
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke;
    aBlock[3] = &unk_1E76F9900;
    objc_copyWeak(&v22, buf);
    v10 = _Block_copy(aBlock);
    _diskSpaceAlertController = [MEMORY[0x1E69DC650] alertControllerWithTitle:v8 message:v9 preferredStyle:1];
    v11 = MEMORY[0x1E69DC648];
    v12 = CAMStorageAlertDismissTitle([(CAMViewfinderViewController *)self _diskSpaceAlertType]);
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke_2;
    v20[3] = &unk_1E76F89F0;
    v20[4] = self;
    v13 = [v11 actionWithTitle:v12 style:0 handler:v20];
    [_diskSpaceAlertController addAction:v13];

    v14 = CAMStorageAlertResolveTitle(1);
    if (v14)
    {
      v15 = MEMORY[0x1E69DC648];
      v16 = CAMStorageAlertResolveTitle(1);
      v17 = [v15 actionWithTitle:v16 style:0 handler:v10];
      [_diskSpaceAlertController addAction:v17];
    }

    [(CAMViewfinderViewController *)self presentViewController:_diskSpaceAlertController animated:1 completion:0];
    [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:_diskSpaceAlertController];
    _storageController = [(CAMViewfinderViewController *)self _storageController];
    purgeableStorageContainer = [_storageController purgeableStorageContainer];
    [purgeableStorageContainer reportLowDiskEventWithIdentifier:@"com.apple.camera.timelapse"];

    objc_destroyWeak(&v22);
    objc_destroyWeak(buf);
  }
}

void __72__CAMViewfinderViewController__handleTimelapseLowDiskSpaceNotification___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  CAMShowStorageUsageInSettings();
}

- (int64_t)_diskSpaceAlertType
{
  _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
  v4 = PLIsCPLDataclassEnabled();
  IsEnabled = PLCloudPhotoLibraryKeepOriginalsIsEnabled();
  _hasBeenPromptedForICPLToday = [(CAMViewfinderViewController *)self _hasBeenPromptedForICPLToday];
  if (_externalStorageOutputEnabled)
  {
    return 2;
  }

  else
  {
    return v4 & IsEnabled & !_hasBeenPromptedForICPLToday ^ 1u;
  }
}

- (BOOL)_hasBeenPromptedForICPLToday
{
  CFPreferencesAppSynchronize(@"com.apple.mobileslideshow");
  v2 = CFPreferencesCopyAppValue(@"CPLKeepOriginalsPromptShownDate", @"com.apple.mobileslideshow");
  if (v2 && ([MEMORY[0x1E695DF00] date], v3 = objc_claimAutoreleasedReturnValue(), v4 = objc_msgSend(v3, "compare:", v2), v3, v4 != 1))
  {
    v7 = 1;
  }

  else
  {
    date = [MEMORY[0x1E695DF00] date];
    v6 = [date dateByAddingTimeInterval:86400.0];

    CFPreferencesSetAppValue(@"CPLKeepOriginalsPromptShownDate", v6, @"com.apple.mobileslideshow");
    CFPreferencesAppSynchronize(@"com.apple.mobileslideshow");

    v7 = 0;
  }

  return v7;
}

- (void)_updateDiskSpaceAlertViewVisibilityAnimated:(BOOL)animated
{
  animatedCopy = animated;
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {

    [(CAMViewfinderViewController *)self _dismissDiskSpaceAlertViewAnimated:animatedCopy];
  }

  else
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingBurst = [_captureController isCapturingBurst];
    _storageController = [(CAMViewfinderViewController *)self _storageController];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __75__CAMViewfinderViewController__updateDiskSpaceAlertViewVisibilityAnimated___block_invoke;
    v9[3] = &unk_1E76F8AA0;
    v9[4] = self;
    v10 = animatedCopy;
    [_storageController hasDiskSpaceToAllowCaptureWithConfiguration:_currentGraphConfiguration allowPurging:isCapturingBurst ^ 1u completion:v9];
  }
}

uint64_t __75__CAMViewfinderViewController__updateDiskSpaceAlertViewVisibilityAnimated___block_invoke(uint64_t a1, int a2)
{
  v28 = *MEMORY[0x1E69E9840];
  v4 = [*(a1 + 32) _storageController];
  v5 = [v4 purgeableStorageContainer];
  v6 = [v5 isPurging];

  LODWORD(v4) = [*(a1 + 32) _hasInFlightConfiguration];
  v7 = [*(a1 + 32) _currentGraphConfiguration];
  v8 = [v7 videoEncodingBehavior] == 2;

  v9 = (a2 | v8 & (v6 | v4)) ^ 1;
  if ([*(a1 + 32) _externalStorageOutputEnabled])
  {
    v10 = [*(a1 + 32) _storageMonitor];
    v11 = [v10 monitoringState] != 2;

    v9 = v11 & v9;
  }

  if ([*(a1 + 32) _externalStorageOutputEnabled])
  {
    v12 = [*(a1 + 32) _connectedStorage];
    v13 = [v12 connected];

    v14 = [*(a1 + 32) _connectedStorage];
    v15 = [v14 totalFreeBytes];

    if (v15 >= 0)
    {
      v16 = v13;
    }

    else
    {
      v16 = 0;
    }

    if ((v16 & v9) == 1)
    {
      v17 = os_log_create("com.apple.camera", "ExternalStorage");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        v18 = [*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture];
        v19 = @"NO";
        if (v18)
        {
          v19 = @"YES";
        }

        v20 = v19;
        v22 = 138543874;
        v23 = @"YES";
        v24 = 2048;
        v25 = v15;
        v26 = 2114;
        v27 = v20;
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "External storage: setting out of disk space alert, connected=%{public}@, totalFreeBytes=%lld, receivedOutOfDiskSpaceErrorDuringCapture=%{public}@", &v22, 0x20u);
      }

      [*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture];
      v9 = 1;
      goto LABEL_17;
    }

    v9 = 0;
  }

  if (([*(a1 + 32) _receivedOutOfDiskSpaceErrorDuringCapture] & 1) != 0 || v9)
  {
LABEL_17:
    [*(a1 + 32) _showDiskSpaceAlertView];
    return [*(a1 + 32) _setOutOfDiskSpace:v9];
  }

  [*(a1 + 32) _dismissDiskSpaceAlertViewAnimated:*(a1 + 40)];
  return [*(a1 + 32) _setOutOfDiskSpace:v9];
}

- (void)_showDiskSpaceAlertView
{
  _diskSpaceAlertController = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (_diskSpaceAlertController)
  {
    goto LABEL_11;
  }

  _diskSpaceAlertType = [(CAMViewfinderViewController *)self _diskSpaceAlertType];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  objc_initWeak(&location, self);
  if ((_diskSpaceAlertType - 1) >= 2)
  {
    if (_diskSpaceAlertType)
    {
      v9 = 0;
      goto LABEL_8;
    }

    v6 = &v26;
    v7 = v25;
    v25[0] = MEMORY[0x1E69E9820];
    v25[1] = 3221225472;
    v8 = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke;
  }

  else
  {
    v6 = &v24;
    v7 = v23;
    v23[0] = MEMORY[0x1E69E9820];
    v23[1] = 3221225472;
    v8 = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_2;
  }

  v7[2] = v8;
  v7[3] = &unk_1E76F9900;
  objc_copyWeak(v6, &location);
  v9 = _Block_copy(v7);
  objc_destroyWeak(v6);
LABEL_8:
  v10 = MEMORY[0x1E69DC650];
  v11 = CAMStorageAlertTitle(_diskSpaceAlertType);
  v12 = CAMStorageAlertMessage(_diskSpaceAlertType, _currentMode);
  _diskSpaceAlertController = [v10 alertControllerWithTitle:v11 message:v12 preferredStyle:1];

  v13 = MEMORY[0x1E69DC648];
  v14 = CAMStorageAlertDismissTitle(_diskSpaceAlertType);
  v22[0] = MEMORY[0x1E69E9820];
  v22[1] = 3221225472;
  v22[2] = __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_3;
  v22[3] = &unk_1E76F89F0;
  v22[4] = self;
  v15 = [v13 actionWithTitle:v14 style:0 handler:v22];
  [_diskSpaceAlertController addAction:v15];

  v16 = CAMStorageAlertResolveTitle(_diskSpaceAlertType);
  if (v16)
  {
    v17 = [MEMORY[0x1E69DC648] actionWithTitle:v16 style:0 handler:v9];
    [_diskSpaceAlertController addAction:v17];
  }

  actions = [_diskSpaceAlertController actions];
  lastObject = [actions lastObject];
  [_diskSpaceAlertController setPreferredAction:lastObject];

  [(CAMViewfinderViewController *)self presentViewController:_diskSpaceAlertController animated:1 completion:0];
  [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:_diskSpaceAlertController];
  _storageController = [(CAMViewfinderViewController *)self _storageController];
  purgeableStorageContainer = [_storageController purgeableStorageContainer];
  [purgeableStorageContainer reportLowDiskEventWithIdentifier:@"com.apple.camera.generic"];

  objc_destroyWeak(&location);
LABEL_11:
}

uint64_t __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  return MEMORY[0x1EEE286D0](0);
}

void __54__CAMViewfinderViewController__showDiskSpaceAlertView__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _dismissDiskSpaceAlertViewAnimated:1];

  CAMShowStorageUsageInSettings();
}

- (void)_dismissDiskSpaceAlertViewAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _diskSpaceAlertController = [(CAMViewfinderViewController *)self _diskSpaceAlertController];
  if (_diskSpaceAlertController)
  {
    v7 = _diskSpaceAlertController;
    presentingViewController = [_diskSpaceAlertController presentingViewController];
    [presentingViewController dismissViewControllerAnimated:animatedCopy completion:0];

    [(CAMViewfinderViewController *)self _setDiskSpaceAlertController:0];
    [(CAMViewfinderViewController *)self _setReceivedOutOfDiskSpaceErrorDuringCapture:0];
    _diskSpaceAlertController = v7;
  }
}

- (void)_showUnsupportedFormatAlert
{
  v3 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "External storage: cannot enable external storage output due to unsupported format", buf, 2u);
  }

  v17 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_UNSUPPORTED_FORMAT_TITLE", 0);
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_UNSUPPORTED_FORMAT_MESSAGE", 0);
  v5 = CAMLocalizedFrameworkString(@"OK", 0);
  v6 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_TITLE", 0);
  v7 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_URL", 0);
  v8 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v17 message:v4 preferredStyle:1];
  v9 = MEMORY[0x1E69DC648];
  v20[0] = MEMORY[0x1E69E9820];
  v20[1] = 3221225472;
  v20[2] = __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke;
  v20[3] = &unk_1E76F89F0;
  v21 = v8;
  v10 = v8;
  v11 = [v9 actionWithTitle:v5 style:0 handler:v20];
  v12 = MEMORY[0x1E69DC648];
  v18[0] = MEMORY[0x1E69E9820];
  v18[1] = 3221225472;
  v18[2] = __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke_2;
  v18[3] = &unk_1E76F89F0;
  v19 = v7;
  v13 = v7;
  v14 = [v12 actionWithTitle:v6 style:0 handler:v18];
  [v10 addAction:v11];
  [v10 addAction:v14];
  [v10 setPreferredAction:v11];
  [(CAMViewfinderViewController *)self presentViewController:v10 animated:1 completion:0];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [chromeConfigurator setExternalStorageIconVisible:{-[CAMViewfinderViewController _shouldShowChromeExternalStorageIconForGraphConfiguration:](self, "_shouldShowChromeExternalStorageIconForGraphConfiguration:", _currentGraphConfiguration)}];
}

void __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) presentingViewController];
  [v1 dismissViewControllerAnimated:1 completion:0];
}

void __58__CAMViewfinderViewController__showUnsupportedFormatAlert__block_invoke_2(uint64_t a1)
{
  v1 = [MEMORY[0x1E695DFF8] URLWithString:*(a1 + 32)];
  CAMOpenURL(v1, MEMORY[0x1E695E0F8]);
}

- (void)_showFrameDropsAlert
{
  v3 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_FRAME_DROPS_ALERT_TITLE", 0);
  v4 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_FRAME_DROPS_ALERT_MESSAGE", 0);
  v5 = CAMLocalizedFrameworkString(@"OK", 0);
  v6 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_TITLE", 0);
  v7 = CAMLocalizedFrameworkString(@"EXTERNAL_STORAGE_LEARN_MORE_URL", 0);
  v8 = [MEMORY[0x1E69DC650] alertControllerWithTitle:v3 message:v4 preferredStyle:1];
  v9 = MEMORY[0x1E69DC648];
  v20[0] = MEMORY[0x1E69E9820];
  v20[1] = 3221225472;
  v20[2] = __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke;
  v20[3] = &unk_1E76F89F0;
  v21 = v8;
  v10 = v8;
  v11 = [v9 actionWithTitle:v5 style:0 handler:v20];
  v12 = MEMORY[0x1E69DC648];
  v15 = MEMORY[0x1E69E9820];
  v16 = 3221225472;
  v17 = __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke_2;
  v18 = &unk_1E76F89F0;
  v19 = v7;
  v13 = v7;
  v14 = [v12 actionWithTitle:v6 style:0 handler:&v15];
  [v10 addAction:{v11, v15, v16, v17, v18}];
  [v10 addAction:v14];
  [v10 setPreferredAction:v11];
  [(CAMViewfinderViewController *)self presentViewController:v10 animated:1 completion:0];
}

void __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke(uint64_t a1)
{
  v1 = [*(a1 + 32) presentingViewController];
  [v1 dismissViewControllerAnimated:1 completion:0];
}

void __51__CAMViewfinderViewController__showFrameDropsAlert__block_invoke_2(uint64_t a1)
{
  v1 = [MEMORY[0x1E695DFF8] URLWithString:*(a1 + 32)];
  CAMOpenURL(v1, MEMORY[0x1E695E0F8]);
}

- (void)pressShutterForRemoteShutter
{
  v3 = os_log_create("com.apple.camera", "RemoteShutter");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *v8 = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "Remote triggered shutter press and release", v8, 2u);
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (_dynamicShutterControl)
  {
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl2 externalButtonPressedWithBehavior:1];

    _dynamicShutterControl3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl3 externalButtonReleased];
  }

  else
  {
    _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
    [(CAMViewfinderViewController *)self _handleShutterButtonPressed:_shutterButton];

    _dynamicShutterControl3 = [(CAMViewfinderViewController *)self _shutterButton];
    [(CAMViewfinderViewController *)self _handleShutterButtonReleased:_dynamicShutterControl3];
  }
}

- (void)pressShutterForRemoteShutterWaitingForViewfinder:(BOOL)viewfinder timeout:(double)timeout
{
  viewfinderCopy = viewfinder;
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  isViewfinderClosed = [_closedViewfinderController isViewfinderClosed];

  if (viewfinderCopy && isViewfinderClosed)
  {
    objc_initWeak(&location, self);
    v12[0] = MEMORY[0x1E69E9820];
    v12[1] = 3221225472;
    v12[2] = __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke;
    v12[3] = &unk_1E76F8580;
    objc_copyWeak(&v13, &location);
    [(CAMViewfinderViewController *)self setQueuedViewfinderAction:v12];
    v9 = dispatch_time(0, (timeout * 1000000000.0));
    block[0] = MEMORY[0x1E69E9820];
    block[1] = 3221225472;
    block[2] = __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke_2;
    block[3] = &unk_1E76F8580;
    objc_copyWeak(&v11, &location);
    dispatch_after(v9, MEMORY[0x1E69E96A0], block);
    objc_destroyWeak(&v11);
    objc_destroyWeak(&v13);
    objc_destroyWeak(&location);
  }

  else
  {

    [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
  }
}

void __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained pressShutterForRemoteShutter];
}

void __88__CAMViewfinderViewController_pressShutterForRemoteShutterWaitingForViewfinder_timeout___block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v3 = [WeakRetained queuedViewfinderAction];

  if (v3)
  {
    v4 = objc_loadWeakRetained((a1 + 32));
    [v4 setQueuedViewfinderAction:0];
  }
}

- (void)pressStillDuringVideoForRemoteShutter
{
  v3 = os_log_create("com.apple.camera", "RemoteShutter");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    *v7 = 0;
    _os_log_impl(&dword_1A3640000, v3, OS_LOG_TYPE_DEFAULT, "Remote triggered still during video press and release", v7, 2u);
  }

  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

  if (_dynamicShutterControl)
  {
    _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl2 externalLockButtonPressed];

    _dynamicShutterControl3 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    [_dynamicShutterControl3 externalLockButtonReleased];
  }

  else
  {
    [(CAMViewfinderViewController *)self _handleStillDuringVideoButtonPressed:self->__stillDuringVideoButton];
    [(CAMViewfinderViewController *)self _handleStillDuringVideoButtonReleased:self->__stillDuringVideoButton];
  }
}

- (void)remoteShutter:(id)shutter takePhotoWithCountdown:(unint64_t)countdown
{
  shutterCopy = shutter;
  v6 = [(CAMViewfinderViewController *)self _takePhotoForExternalClientWithCountdown:countdown internalTimerOverridesCountdown:0];
  if (countdown && !v6)
  {
    [shutterCopy countdownCanceled];
  }
}

- (BOOL)_takePhotoForExternalClientWithCountdown:(unint64_t)countdown internalTimerOverridesCountdown:(BOOL)overridesCountdown
{
  _isShowingCameraRoll = [(CAMViewfinderViewController *)self _isShowingCameraRoll];
  if (!_isShowingCameraRoll)
  {
    if (countdown)
    {
      if (overridesCountdown)
      {
        if ([(CAMViewfinderViewController *)self isEmulatingImagePicker]|| [(CAMViewfinderViewController *)self _isCapturingFromTimer])
        {
          goto LABEL_18;
        }

        _resolvedTimerDuration = [(CAMViewfinderViewController *)self _resolvedTimerDuration];
        v9 = _resolvedTimerDuration == 0;
        if (_resolvedTimerDuration)
        {
          v10 = _resolvedTimerDuration;
        }

        else
        {
          v10 = 1;
        }

        [(CAMViewfinderViewController *)self set_isHeadphonesEventCaptureWithUserSpecifiedDuration:_resolvedTimerDuration != 0];
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:v9];
        selfCopy9 = self;
        v12 = v10;
        goto LABEL_17;
      }

      if (countdown <= 2)
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:0];
        [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:0 animated:1];
        countdownCopy = countdown;
        selfCopy7 = self;
        selfCopy8 = 0;
LABEL_23:
        [(CAMViewfinderViewController *)selfCopy7 performSelector:sel_pressShutterForRemoteShutter withObject:selfCopy8 afterDelay:countdownCopy];
        return !_isShowingCameraRoll;
      }

      v16 = countdown - 3;
      if (countdown == 3)
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        selfCopy9 = self;
        v12 = 1;
        goto LABEL_17;
      }

      if (countdown > 4)
      {
        v16 = countdown - 5;
        if (countdown == 5)
        {
          [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
          selfCopy9 = self;
          v12 = 2;
          goto LABEL_17;
        }

        if (countdown > 9)
        {
          [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
          [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:3 animated:1];
          if (countdown == 10)
          {
            goto LABEL_18;
          }

          countdownCopy = (countdown - 10);
          goto LABEL_22;
        }

        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        selfCopy6 = self;
        v18 = 2;
      }

      else
      {
        [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];
        selfCopy6 = self;
        v18 = 1;
      }

      [(CAMViewfinderViewController *)selfCopy6 _setTimerDurationAndUpdateUI:v18 animated:1];
      countdownCopy = v16;
LABEL_22:
      selfCopy7 = self;
      selfCopy8 = self;
      goto LABEL_23;
    }

    if (![(CAMViewfinderViewController *)self isRecording])
    {
      selfCopy9 = self;
      v12 = 0;
LABEL_17:
      [(CAMViewfinderViewController *)selfCopy9 _setTimerDurationAndUpdateUI:v12 animated:1];
LABEL_18:
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
      return !_isShowingCameraRoll;
    }

    [(CAMViewfinderViewController *)self pressStillDuringVideoForRemoteShutter];
  }

  return !_isShowingCameraRoll;
}

- (void)remoteShutterCancelCountdown:(id)countdown
{
  [MEMORY[0x1E69E58C0] cancelPreviousPerformRequestsWithTarget:self selector:sel_pressShutterForRemoteShutter object:0];
  if ([(CAMViewfinderViewController *)self _isCapturingFromTimer])
  {

    [(CAMViewfinderViewController *)self _stopCountdownForCaptureTimer];
  }
}

- (BOOL)remoteShutterBeginBurstCapture:(id)capture
{
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    if (_dynamicShutterControl)
    {
      _shutterButton = _dynamicShutterControl;
      if ([_dynamicShutterControl isEnabled] && (objc_msgSend(_shutterButton, "isTracking") & 1) == 0)
      {
        v4 = 1;
        [_shutterButton externalButtonPressedWithBehavior:1];
LABEL_10:

        return v4;
      }
    }

    else
    {
      _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
      if ([_shutterButton isEnabled] && (objc_msgSend(_shutterButton, "isHighlighted") & 1) == 0)
      {
        v4 = 1;
        [_shutterButton setHighlighted:1];
        [(CAMViewfinderViewController *)self _handleShutterButtonPressed:_shutterButton];
        goto LABEL_10;
      }
    }

    v4 = 0;
    goto LABEL_10;
  }

  return 0;
}

- (BOOL)remoteShutterEndBurstCapture:(id)capture
{
  if (![(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
    if (_dynamicShutterControl)
    {
      _shutterButton = _dynamicShutterControl;
      [_dynamicShutterControl externalButtonReleased];
    }

    else
    {
      _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
      if (![_shutterButton isHighlighted])
      {
        v4 = 0;
        goto LABEL_8;
      }

      [_shutterButton setHighlighted:0];
      [(CAMViewfinderViewController *)self _handleShutterButtonReleased:_shutterButton];
    }

    v4 = 1;
LABEL_8:

    return v4;
  }

  return 0;
}

- (void)remoteShutter:(id)shutter setMode:(int64_t)mode
{
  if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
  {
    [(CAMViewfinderViewController *)self dismissViewControllerAnimated:1 completion:0];
  }

  v6 = +[CAMUserPreferences preferences];
  v7 = [v6 defaultDeviceForModeChange:mode devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

  [(CAMViewfinderViewController *)self changeToMode:mode device:v7 animated:1];
}

- (BOOL)remoteShutterStartCapture:(id)capture
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  LOBYTE(_dynamicShutterControl) = 0;
  if (_currentMode <= 8)
  {
    if (((1 << _currentMode) & 0x1AE) != 0)
    {
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
      LOBYTE(_dynamicShutterControl) = 1;
    }

    else if (!_currentMode)
    {
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

      if (_dynamicShutterControl)
      {
        _dynamicShutterControl2 = [(CAMViewfinderViewController *)self _dynamicShutterControl];
        LOBYTE(_dynamicShutterControl) = 1;
        [_dynamicShutterControl2 externalButtonPressedWithBehavior:1];
      }
    }
  }

  return _dynamicShutterControl;
}

- (BOOL)remoteShutterPauseCapture:(id)capture
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (!v5)
  {
    return 0;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  if (!isCapturingVideo)
  {
    return 0;
  }

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  videoCapturePaused = [_captureController2 videoCapturePaused];

  if (videoCapturePaused)
  {
    return 0;
  }

  [(CAMViewfinderViewController *)self dynamicShutterControlDidPressPauseResumeButton:0];
  return 1;
}

- (BOOL)remoteShutterResumeCapture:(id)capture
{
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = [v4 isPauseVideoSupportedForMode:{-[CAMViewfinderViewController _currentMode](self, "_currentMode")}];

  if (!v5)
  {
    return 0;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  if (!isCapturingVideo)
  {
    return 0;
  }

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  videoCapturePaused = [_captureController2 videoCapturePaused];

  if (!videoCapturePaused)
  {
    return 0;
  }

  [(CAMViewfinderViewController *)self dynamicShutterControlDidPressPauseResumeButton:0];
  return 1;
}

- (BOOL)remoteShutterStopCapture:(id)capture
{
  isRecording = [(CAMViewfinderViewController *)self isRecording];
  if (isRecording)
  {
    if ([(CAMViewfinderViewController *)self _currentMode]|| ([(CAMViewfinderViewController *)self _dynamicShutterControl], v5 = objc_claimAutoreleasedReturnValue(), v5, !v5))
    {
      [(CAMViewfinderViewController *)self pressShutterForRemoteShutter];
    }

    else
    {
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl externalButtonReleased];
    }
  }

  return isRecording;
}

- (void)remoteShutter:(id)shutter setZoomAmount:(double)amount
{
  [(CAMViewfinderViewController *)self _zoomFactorForZoomSliderValue:shutter, amount];

  [(CAMViewfinderViewController *)self _remoteShutterSetZoomFactor:?];
}

- (void)_remoteShutterSetZoomFactor:(double)factor
{
  if ([(CAMViewfinderViewController *)self _isZoomAllowedCurrently])
  {
    if ([(CAMViewfinderViewController *)self _shouldUseZoomControlInsteadOfSlider])
    {
      [(CAMViewfinderViewController *)self _createZoomControlIfNecessary];
      [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:factor];
    }

    else
    {
      [(CAMViewfinderViewController *)self _createZoomSliderIfNecessary];
      zoomSlider = self->__zoomSlider;
      [(CAMViewfinderViewController *)self _zoomSliderValueForZoomFactor:factor];
      *&v7 = v7;
      [(CAMZoomSlider *)zoomSlider setValue:0 animated:v7];
      [(CAMViewfinderViewController *)self _zoomUIDidChangeToFactor:factor];
      [(CAMViewfinderViewController *)self zoomSliderDidEndZooming:self->__zoomSlider];
    }

    _zoomReporter = [(CAMViewfinderViewController *)self _zoomReporter];
    [_zoomReporter zoomChangedToFactor:-[CAMViewfinderViewController _currentDevice](self device:"_currentDevice") interactionType:{4, factor}];

    [(CAMViewfinderViewController *)self _setLastZoomInteractionType:4];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "RemoteShutter");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      *v9 = 0;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Ignoring zoom change from Watch because not allowed at this time", v9, 2u);
    }
  }
}

- (void)remoteShutter:(id)shutter setCaptureDevice:(int64_t)device
{
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  if ((_currentDevice - 1) > 0xA)
  {
    v7 = 0;
  }

  else
  {
    v7 = qword_1A3A685B0[_currentDevice - 1];
  }

  if ((device - 1) > 0xA)
  {
    v8 = 0;
  }

  else
  {
    v8 = qword_1A3A685B0[device - 1];
  }

  if (v7 != v8)
  {

    [(CAMViewfinderViewController *)self handleFlipButtonReleased];
  }
}

- (void)readUserPreferencesAndHandleChangesWithOverrides:(id)overrides bypassXPCWhenReadingSystemStyle:(BOOL)style
{
  styleCopy = style;
  v63 = *MEMORY[0x1E69E9840];
  overridesCopy = overrides;
  v6 = +[CAMUserPreferences preferences];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  isCallActive = [_callStatusMonitor isCallActive];
  resetTimeoutDate = [v6 resetTimeoutDate];
  isVideoConfigurationControlEnabled = [v6 isVideoConfigurationControlEnabled];
  v56 = 0;
  [v6 readPreferencesWithOverrides:overridesCopy emulationMode:-[CAMViewfinderViewController emulationMode](self callActive:"emulationMode") shouldResetCaptureConfiguration:isCallActive bypassXPCWhenReadingSystemStyle:{&v56, styleCopy}];
  captureConfiguration = [v6 captureConfiguration];
  semanticStyles = [captureConfiguration semanticStyles];
  v11 = [semanticStyles mutableCopy];
  [(CAMViewfinderViewController *)self _setSemanticStyles:v11];

  captureConfiguration2 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setSelectedSemanticStyleIndex:](self, "_setSelectedSemanticStyleIndex:", [captureConfiguration2 selectedSemanticStyleIndex]);

  captureConfiguration3 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setSmartStyleSystemStyleIndex:](self, "_setSmartStyleSystemStyleIndex:", [captureConfiguration3 smartStyleSystemStyleIndex]);

  [(CAMViewfinderViewController *)self _updateSemanticStyleControlsForCurrentStateAnimated:0];
  [(CAMViewfinderViewController *)self _updateSmartStyleControlsForCurrentStateAnimateSliders:0 animateOtherControls:0];
  [(CAMViewfinderViewController *)self _updateSmartStyleOnSession];
  objc_initWeak(&location, self);
  mEMORY[0x1E69C4598] = [MEMORY[0x1E69C4598] sharedScheduler];
  v53[0] = MEMORY[0x1E69E9820];
  v53[1] = 3221225472;
  v53[2] = __112__CAMViewfinderViewController_readUserPreferencesAndHandleChangesWithOverrides_bypassXPCWhenReadingSystemStyle___block_invoke;
  v53[3] = &unk_1E76F8580;
  objc_copyWeak(&v54, &location);
  [mEMORY[0x1E69C4598] scheduleDeferredMainQueueTask:v53];

  [(CAMViewfinderViewController *)self _updatePreviewSemanticStyleAnimated:0];
  [(CAMViewfinderViewController *)self _createOrDestroySharedLibraryControlsIfNecessary];
  resetTimeoutDate2 = [v6 resetTimeoutDate];
  v15 = [resetTimeoutDate isEqual:?];
  if (isVideoConfigurationControlEnabled)
  {
    v16 = [v6 isVideoConfigurationControlEnabled] ^ 1;
  }

  else
  {
    LOBYTE(v16) = 0;
  }

  if ((v56 & 1) == 0)
  {
    videoConfiguration = [overridesCopy videoConfiguration];
    if ((videoConfiguration != 0) | v16 & 1 || ([overridesCopy slomoConfiguration], (videoConfiguration = objc_claimAutoreleasedReturnValue()) != 0))
    {
    }

    else
    {
      cinematicConfiguration = [overridesCopy cinematicConfiguration];
      v44 = cinematicConfiguration == 0;

      if (v44)
      {
        goto LABEL_9;
      }
    }
  }

  [(CAMViewfinderViewController *)self set_videoConfigurationOverride:0];
  [(CAMViewfinderViewController *)self set_slomoConfigurationOverride:0];
  [(CAMViewfinderViewController *)self set_cinematicConfigurationOverride:0];
  [(CAMViewfinderViewController *)self _updateFrontRearSimultaneousVideoEnabled:0 performGraphConfiguration:0];
LABEL_9:
  captureConfiguration4 = [v6 captureConfiguration];
  -[CAMViewfinderViewController _setDesiredProResVideoMode:](self, "_setDesiredProResVideoMode:", [captureConfiguration4 proResVideoMode]);

  if ((v56 & 1) != 0 || ((v15 ^ 1) & 1) != 0 || [overridesCopy hasOverrides])
  {
    captureConfiguration5 = [v6 captureConfiguration];
    conflictingControlConfiguration = [v6 conflictingControlConfiguration];
    _externalStorageOutputEnabled = [(CAMViewfinderViewController *)self _externalStorageOutputEnabled];
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    v49 = +[CAMCaptureConfiguration captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:](CAMCaptureConfiguration, "captureGraphConfigurationUsingConfiguration:outputToExternalStorage:captureOrientation:", captureConfiguration5, _externalStorageOutputEnabled, [_motionController captureOrientation]);

    hasOverrides = [overridesCopy hasOverrides];
    v23 = @"Reset";
    if (hasOverrides)
    {
      v23 = @"Overrides";
    }

    v46 = v23;
    v24 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
    {
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      *buf = 138543874;
      v58 = v46;
      v59 = 2114;
      v60 = v49;
      v61 = 2114;
      v62 = _currentGraphConfiguration;
      _os_log_impl(&dword_1A3640000, v24, OS_LOG_TYPE_DEFAULT, "%{public}@: will change to: %{public}@ from: %{public}@", buf, 0x20u);
    }

    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
    _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
    mode = [captureConfiguration5 mode];
    device = [captureConfiguration5 device];
    v31 = device;
    v45 = _currentDevice;
    if ((device - 1) > 0xA)
    {
      v32 = 0;
    }

    else
    {
      v32 = qword_1A3A685B0[device - 1];
    }

    v33 = [MEMORY[0x1E695DF00] now];
    v34 = [resetTimeoutDate dateByAddingTimeInterval:0.01];
    v35 = [v33 compare:v34];
    v36 = _currentDevicePosition == v32 && _currentMode == mode;
    if (!v36 && v35 != 1)
    {
      [(CAMViewfinderViewController *)self _startCaptureSessionIfNecessaryIfVisibleAndInterrupted];
    }

    [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v49];
    v38 = v37;
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    v40 = [_captureController applyCaptureConfiguration:captureConfiguration5 zoomFactor:-[CAMViewfinderViewController _externalStorageOutputEnabled](self outputToExternalStorage:{"_externalStorageOutputEnabled"), v38}];

    [(CAMViewfinderViewController *)self _setLastConfigurationRequestID:v40];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController applyCaptureConfiguration:captureConfiguration5];
    [(CAMViewfinderViewController *)self applyCaptureConfiguration:captureConfiguration5 conflictingControlConfiguration:conflictingControlConfiguration];
    [(CAMViewfinderViewController *)self _closeViewfinderForChangeFromMode:_currentMode toMode:mode fromDevice:v45 toDevice:v31];

    [(CAMViewfinderViewController *)self _setWantsVisualTextAnalysis:0];
  }

  [(CAMViewfinderViewController *)self _createOrDestroyLevelViewModelIfNecessary];
  [(CAMViewfinderViewController *)self _createGridViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyLevelViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyHorizonLevelViewIfNecessary];
  [(CAMViewfinderViewController *)self _createOrDestroyHDRButtonIfNecessary];
  [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:0];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateVideoConfigurationStatusIndicatorForGraphConfiguration:_currentGraphConfiguration2 animated:0];
  [(CAMViewfinderViewController *)self _updateInterfaceModulationForGraphConfiguration:_currentGraphConfiguration2 animated:0];
  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  [(CAMViewfinderViewController *)self _configureSwipeToModeSwitchGestureRecognizersDirection];
  [(CAMViewfinderViewController *)self _updateChromePhotoFormatsAndResolutions];
  [(CAMViewfinderViewController *)self _updateChromeSharedLibraryState];
  [(CAMViewfinderViewController *)self _updateChromeClassicModeSwitching];

  objc_destroyWeak(&v54);
  objc_destroyWeak(&location);
}

void __112__CAMViewfinderViewController_readUserPreferencesAndHandleChangesWithOverrides_bypassXPCWhenReadingSystemStyle___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v1 = [WeakRetained _fullscreenViewfinder];
  [v1 reloadSemanticStyleBadgesDelayIfNeeded:0];
}

- (void)_startCaptureSessionIfNecessaryIfVisibleAndInterrupted
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isInterrupted = [_captureController isInterrupted];
  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {
    view = [(CAMViewfinderViewController *)self view];
    window = [view window];

    v6 = window ? isInterrupted : 0;
    if (v6 == 1)
    {
      [_captureController startCaptureSessionWithRetryCount:3 retryInterval:@"resetting graph configuration" logReason:0 completion:0.05];
    }
  }
}

- (void)_createGridViewIfNecessary
{
  v6 = +[CAMUserPreferences preferences];
  if ([v6 shouldShowGridView] && !self->__gridView)
  {
    v3 = [CAMGridView alloc];
    v4 = [(CAMGridView *)v3 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    gridView = self->__gridView;
    self->__gridView = v4;

    [(CAMViewfinderViewController *)self _embedGridView];
  }

  [(CAMGridView *)self->__gridView setLevelViewModel:self->__levelViewModel];
}

- (void)_createOrDestroyHorizonLevelViewIfNecessary
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v6 = +[CAMUserPreferences preferences];
  shouldShowHorizonLevelView = [v6 shouldShowHorizonLevelView];
  v5 = [(CAMViewfinderViewController *)self _shouldCreateHorizonLevelViewForMode:_currentMode];
  if ((shouldShowHorizonLevelView & 1) != 0 || _currentMode == 8)
  {
    if (v5)
    {
      [(CAMViewfinderViewController *)self _createHorizonLevelViewIfNecessary];
    }
  }

  else
  {
    [(CAMViewfinderViewController *)self _destroyHorizonLevelViewIfNecessary];
  }
}

- (BOOL)_shouldMonitorDeviceMotionForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v5 = +[CAMApplication appOrPlugInState];
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  isViewfinderClosed = [_closedViewfinderController isViewfinderClosed];
  _levelViewModel = [(CAMViewfinderViewController *)self _levelViewModel];
  v9 = [(CAMViewfinderViewController *)self _shouldHideLevelViewForGraphConfiguration:configurationCopy];
  LOBYTE(self) = [(CAMViewfinderViewController *)self _shouldHideHorizonLevelViewForGraphConfiguration:configurationCopy];

  if (v9 & self)
  {
    v10 = 0;
  }

  else
  {
    v10 = (_levelViewModel != 0) & ~isViewfinderClosed;
  }

  if (v5)
  {
    v11 = 0;
  }

  else
  {
    v11 = v10;
  }

  return v11;
}

- (void)suspendCameraSessionWithCompletion:(id)completion
{
  completionCopy = completion;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController stopCaptureSessionWithCompletion:completionCopy];

  _locationController = [(CAMViewfinderViewController *)self _locationController];
  [_locationController setEnabled:0];
  if ([(CAMViewfinderViewController *)self automaticallyAdjustsApplicationIdleTimer])
  {
    _idleController = [(CAMViewfinderViewController *)self _idleController];
    [_idleController stopUpdatingIdleTimer];
  }
}

- (void)resumeCameraSessionWithCompletion:(id)completion
{
  completionCopy = completion;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController startCaptureSessionWithRetryCount:0 retryInterval:@"resumeCameraSession" logReason:completionCopy completion:0.0];
}

- (void)cameraRollControllerDidFullyPresentCameraRoll:(id)roll
{
  rollCopy = roll;
  [(CAMViewfinderViewController *)self _resetMachineReadableMetadataAndProcessing];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController changeToTorchMode:0];
  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  [_imageWell setScaledForInteraction:0];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldDeferMediaLoadingForGraphConfiguration:_currentGraphConfiguration];

  if (v8)
  {
    [rollCopy sessionIdentifier];
    dispatch_time(0, 500000000);
    v11 = MEMORY[0x1E69E9820];
    v12 = 3221225472;
    v13 = __77__CAMViewfinderViewController_cameraRollControllerDidFullyPresentCameraRoll___block_invoke;
    v14 = &unk_1E76F9818;
    v15 = rollCopy;
    pl_dispatch_after();
  }

  v9 = [(CAMViewfinderViewController *)self _cameraRollControllerAction:v11];

  if (v9)
  {
    _cameraRollControllerAction = [(CAMViewfinderViewController *)self _cameraRollControllerAction];
    _cameraRollControllerAction[2]();
  }
}

uint64_t __77__CAMViewfinderViewController_cameraRollControllerDidFullyPresentCameraRoll___block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) sessionIdentifier];
  if (result == *(a1 + 40))
  {
    v3 = *(a1 + 32);

    return [v3 beginAllowingStagedMediaLoading];
  }

  return result;
}

- (void)cameraRollControllerDidDismissFullyPresentedCameraRoll:(id)roll
{
  rollCopy = roll;
  [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _currentMode]];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didDismissCameraRoll];

  cameraRollControllerTestDelegate = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [cameraRollControllerTestDelegate viewfinderViewController:self didDismissPresentedCameraRoll:rollCopy];

  if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled]&& ![(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
  {
    v7 = os_log_create("com.apple.camera", "ExternalStorage");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v10 = 0;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "External storage: enabling deferred SSD output on cameraRollControllerDidDismissFullyPresentedCameraRoll", v10, 2u);
    }

    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
  }

  v8 = [(CAMViewfinderViewController *)self _isSpatialMode:[(CAMViewfinderViewController *)self _currentMode] devicePosition:[(CAMViewfinderViewController *)self _currentDevicePosition]];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  [_motionController setForceLandscapeOrientation:v8];
}

- (void)cameraRollControllerRequestsCaptureSessionStopped:(id)stopped
{
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  [_closedViewfinderController addClosedViewfinderReason:8];

  [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
}

- (void)cameraRollController:(id)controller willShowPresentingViewControllerShouldStartCaptureSession:(BOOL)session
{
  if (session)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v7 = -[CAMViewfinderViewController _shouldSuspendCaptureSessionForGraphConfiguration:callActive:](self, "_shouldSuspendCaptureSessionForGraphConfiguration:callActive:", _currentGraphConfiguration, [_callStatusMonitor isCallActive]);

    if (!v7)
    {

      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
    }
  }
}

- (void)cameraRollController:(id)controller didDismissPreviewControllerShouldStartCaptureSession:(BOOL)session
{
  sessionCopy = session;
  controllerCopy = controller;
  if (sessionCopy)
  {
    [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updatePairedVideoCaptureOnControllerForGraphConfiguration:_currentGraphConfiguration isShowingCameraRoll:0];
  _analyticsSessionEvent = [(CAMViewfinderViewController *)self _analyticsSessionEvent];
  [_analyticsSessionEvent didDismissCameraRoll];

  cameraRollControllerTestDelegate = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [cameraRollControllerTestDelegate viewfinderViewController:self didDismissPresentedCameraRoll:controllerCopy];
}

- (BOOL)cameraRollControllerShouldRequestUnlock:(id)unlock
{
  unlockDelegate = [(CAMViewfinderViewController *)self unlockDelegate];

  if (unlockDelegate)
  {
    return 1;
  }

  return +[CAMFrameworkUtilities isPasscodeLocked];
}

- (id)cameraRollControllerSourceAssetRegionOfInterest:(id)interest
{
  chromeViewController = [(CAMViewfinderViewController *)self chromeViewController];

  if (chromeViewController)
  {
    chromeViewController2 = [(CAMViewfinderViewController *)self chromeViewController];
    imageWellSourceView = [chromeViewController2 imageWellSourceView];

    v7 = objc_alloc(MEMORY[0x1E69C45A0]);
    [imageWellSourceView bounds];
    v8 = [v7 initWithRect:imageWellSourceView inCoordinateSpace:?];
    v9 = objc_alloc_init(MEMORY[0x1E69C4520]);
    chromeViewController3 = [(CAMViewfinderViewController *)self chromeViewController];
    [chromeViewController3 imageWellCornerRadius];
    [v9 setCornerRadius:?];

    [v8 setImageViewSpec:v9];
  }

  else
  {
    _imageWell = [(CAMViewfinderViewController *)self _imageWell];
    _imageWell2 = [(CAMViewfinderViewController *)self _imageWell];
    [_imageWell2 bounds];
    v14 = v13;
    v16 = v15;
    v18 = v17;
    v20 = v19;
    _imageWell3 = [(CAMViewfinderViewController *)self _imageWell];
    [_imageWell alignmentRectForFrame:objc_msgSend(_imageWell3 scaledForInteraction:{"isScaledForInteraction"), v14, v16, v18, v20}];
    v23 = v22;
    v25 = v24;
    v27 = v26;
    v29 = v28;

    v30 = objc_alloc(MEMORY[0x1E69C45A0]);
    imageWellSourceView = [(CAMViewfinderViewController *)self _imageWell];
    v8 = [v30 initWithRect:imageWellSourceView inCoordinateSpace:{v23, v25, v27, v29}];
  }

  return v8;
}

- (void)_imageWellSetContentHidden:(BOOL)hidden
{
  hiddenCopy = hidden;
  _imageWell = [(CAMViewfinderViewController *)self _imageWell];
  [_imageWell setThumbnailImageHidden:hiddenCopy];
}

- (void)cameraRollControllerWillPresentCameraRoll:(id)roll withOneUpController:(id)controller
{
  controllerCopy = controller;
  rollCopy = roll;
  cameraRollControllerTestDelegate = [(CAMViewfinderViewController *)self cameraRollControllerTestDelegate];
  [cameraRollControllerTestDelegate viewfinderViewController:self willPresentCameraRoll:rollCopy withOneUpController:controllerCopy];
}

- (int64_t)cameraRollControllerPreferredPresentationOrientation:(id)orientation
{
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  v6 = CAMInterfaceOrientationForWindow(window);

  if ([(CAMViewfinderViewController *)self _layoutStyle]== 3)
  {
    homeIndicatorAutoHideOrientation = self->__homeIndicatorAutoHideOrientation;
    _motionController = [(CAMViewfinderViewController *)self _motionController];
    captureOrientation = [_motionController captureOrientation];
    v10 = CAMIsDeviceOrientationLocked();
    currentDevice = [MEMORY[0x1E69DC938] currentDevice];
    v12 = [currentDevice orientation] - 5;

    if (captureOrientation == 2)
    {
      v13 = 1;
    }

    else
    {
      v13 = v10;
    }

    if (v12 < 2)
    {
      v13 = 1;
    }

    if (v13)
    {
      v6 = 1;
    }

    else
    {
      v6 = homeIndicatorAutoHideOrientation;
    }
  }

  return v6;
}

- (void)_handleCallStatusMonitorDidChangeCallActive:(id)active
{
  v4 = os_log_create("com.apple.camera", "CallStatus");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_1A3640000, v4, OS_LOG_TYPE_DEFAULT, "Received CAMCallStatusMonitorDidChangeCallActiveNotification", buf, 2u);
  }

  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  isCallActive = [_callStatusMonitor isCallActive];

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v8 = [(CAMViewfinderViewController *)self _shouldSuspendCaptureSessionForGraphConfiguration:_currentGraphConfiguration callActive:isCallActive ^ 1];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v10 = [(CAMViewfinderViewController *)self _shouldSuspendCaptureSessionForGraphConfiguration:_currentGraphConfiguration2 callActive:isCallActive];

  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:0];
  if (_currentMode <= 9 && ((1 << _currentMode) & 0x251) != 0 || !v10 && v8)
  {
    _captureController = [(CAMViewfinderViewController *)self _captureController];
    isCapturingCTMVideo = [_captureController isCapturingCTMVideo];

    if (isCapturingCTMVideo)
    {
      v14 = os_log_create("com.apple.camera", "CallStatus");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *v16 = 0;
        _os_log_impl(&dword_1A3640000, v14, OS_LOG_TYPE_DEFAULT, "CAMCallStatusMonitorDidChangeCallActiveNotification: Ending quick take recording due to audio configuration update", v16, 2u);
      }

      [(CAMViewfinderViewController *)self _stopCapturingCTMVideo];
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
      [_dynamicShutterControl resetAnimated:1];
    }

    [(CAMViewfinderViewController *)self _reconfigureCaptureGraphWithCurrentMode];
  }
}

- (void)setTorchMode:(int64_t)mode
{
  v4 = [CAMCaptureConversions flashModeForTorchMode:mode];

  [(CAMViewfinderViewController *)self handleUserChangedToFlashMode:v4];
}

- (void)setHDRMode:(int64_t)mode
{
  _HDRButton = [(CAMViewfinderViewController *)self _HDRButton];
  [_HDRButton setHDRMode:mode];
  [(CAMViewfinderViewController *)self _handleHDRButtonChangedHDRMode];
}

- (void)changeToMode:(int64_t)mode device:(int64_t)device animated:(BOOL)animated
{
  animatedCopy = animated;
  v26 = *MEMORY[0x1E69E9840];
  availableCaptureModes = [(CAMViewfinderViewController *)self availableCaptureModes];
  v10 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  v11 = [availableCaptureModes containsObject:v10];

  if (v11)
  {
    modeCopy = mode;
  }

  else
  {
    modeCopy = [(CAMViewfinderViewController *)self _availableDefaultCaptureMode];
    _currentGraphConfiguration = os_log_create("com.apple.camera", "Camera");
    v14 = os_log_type_enabled(_currentGraphConfiguration, OS_LOG_TYPE_DEFAULT);
    if (modeCopy == -1)
    {
      if (v14)
      {
        if (mode > 9)
        {
          v15 = 0;
        }

        else
        {
          v15 = off_1E76FA1E8[mode];
        }

        v22 = 138543362;
        v23 = v15;
        _os_log_impl(&dword_1A3640000, _currentGraphConfiguration, OS_LOG_TYPE_DEFAULT, "Ignoring request to change to unavailable mode %{public}@ because no valid mode is available", &v22, 0xCu);
      }

      goto LABEL_28;
    }

    if (v14)
    {
      if (modeCopy > 9)
      {
        v16 = 0;
      }

      else
      {
        v16 = off_1E76FA1E8[modeCopy];
      }

      if (mode > 9)
      {
        v17 = 0;
      }

      else
      {
        v17 = off_1E76FA1E8[mode];
      }

      v22 = 138543618;
      v23 = v16;
      v24 = 2114;
      v25 = v17;
      _os_log_impl(&dword_1A3640000, _currentGraphConfiguration, OS_LOG_TYPE_DEFAULT, "Falling back to mode %{public}@ because requested mode %{public}@ is unavailable", &v22, 0x16u);
    }
  }

  if (modeCopy != -1)
  {
    if (modeCopy == 8)
    {
      v18 = 1;
    }

    else
    {
      if (modeCopy != 9)
      {
LABEL_24:
        _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
        v19 = [(CAMViewfinderViewController *)self _graphConfigurationForChangeToMode:modeCopy device:device fromGraphConfiguration:_currentGraphConfiguration];
        if (-[CAMViewfinderViewController _shouldResetZoomForChangeFromMode:toMode:](self, "_shouldResetZoomForChangeFromMode:toMode:", -[NSObject mode](_currentGraphConfiguration, "mode"), [v19 mode]))
        {
          [(CAMViewfinderViewController *)self _defaultZoomFactorForGraphConfiguration:v19];
        }

        else
        {
          [(CAMViewfinderViewController *)self _cachedVideoZoomFactor];
        }

        v21 = v20;
        [(CAMViewfinderViewController *)self _willChangeToGraphConfiguration:v19 zoomFactor:_currentGraphConfiguration fromGraphConfiguration:animatedCopy animated:?];
        [(CAMViewfinderViewController *)self _changeToGraphConfiguration:v19 zoomFactor:_currentGraphConfiguration fromGraphConfiguration:v21];

LABEL_28:
        goto LABEL_29;
      }

      v18 = 0;
    }

    [(CAMViewfinderViewController *)self _setSpatialModeHasVideoSelected:v18];
    goto LABEL_24;
  }

LABEL_29:
}

- (BOOL)_isCapturing
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v4 = ([_captureController isCapturingVideo] & 1) != 0 || (objc_msgSend(_captureController, "isCapturingPanorama") & 1) != 0 || (objc_msgSend(_captureController, "isCapturingTimelapse") & 1) != 0 || (objc_msgSend(_captureController, "isCapturingNightModeImage") & 1) != 0 || -[CAMViewfinderViewController _isCapturingFromTimer](self, "_isCapturingFromTimer");

  return v4;
}

- (BOOL)isRecording
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isCapturingVideo] & 1) != 0 || (objc_msgSend(_captureController, "isCapturingPanorama"))
  {
    isCapturingTimelapse = 1;
  }

  else
  {
    isCapturingTimelapse = [_captureController isCapturingTimelapse];
  }

  return isCapturingTimelapse;
}

- (BOOL)isCapturingPhoto
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingStillImage = [_captureController isCapturingStillImage];

  return isCapturingStillImage;
}

- (BOOL)isCapturingLivePhoto
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingLivePhotoVideo = [_captureController isCapturingLivePhotoVideo];

  return isCapturingLivePhotoVideo;
}

- (BOOL)capturePhoto
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode > 9 || ((1 << _currentMode) & 0x253) == 0)
  {
    return 0;
  }

  return [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
}

- (BOOL)startRecording
{
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  v5 = -[CAMViewfinderViewController _shouldDisableModeForGraphConfiguration:callActive:](self, "_shouldDisableModeForGraphConfiguration:callActive:", _currentGraphConfiguration, [_callStatusMonitor isCallActive]);

  if (!v5)
  {
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    v7 = 0;
    if (_currentMode > 8)
    {
      goto LABEL_16;
    }

    if (((1 << _currentMode) & 0x186) != 0)
    {
      _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];

      if (_dynamicShutterControl)
      {
        _startTimelapse = [(CAMViewfinderViewController *)self pressShutterButtonWithTouchUpDelay:0.1];
        goto LABEL_12;
      }

      _videoCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
      v12 = [(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:_videoCaptureRequestWithCurrentSettings];
    }

    else
    {
      if (_currentMode != 3)
      {
        if (_currentMode != 5)
        {
          goto LABEL_16;
        }

        _startTimelapse = [(CAMViewfinderViewController *)self _startTimelapse];
LABEL_12:
        v7 = _startTimelapse;
        goto LABEL_16;
      }

      _videoCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _panoramaCaptureRequestWithCurrentSettings];
      v12 = [(CAMViewfinderViewController *)self _startCapturingPanoramaWithRequest:_videoCaptureRequestWithCurrentSettings];
    }

    v7 = v12;

    goto LABEL_16;
  }

  v6 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *v14 = 0;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Ignoring startRecording while current mode is disabled", v14, 2u);
  }

  v7 = 0;
LABEL_16:

  return v7;
}

- (BOOL)stopRecording
{
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  if (_currentMode > 8)
  {
    return 0;
  }

  if (((1 << _currentMode) & 0x186) != 0)
  {

    return [(CAMViewfinderViewController *)self _stopCapturingVideo];
  }

  if (_currentMode != 3)
  {
    if (_currentMode == 5)
    {

      return [(CAMViewfinderViewController *)self _stopTimelapse];
    }

    return 0;
  }

  return [(CAMViewfinderViewController *)self _stopCapturingPanorama];
}

- (void)setAvailableCaptureModes:(id)modes
{
  if (self->_availableCaptureModes != modes)
  {
    modesCopy = modes;
    v5 = [modesCopy copy];
    availableCaptureModes = self->_availableCaptureModes;
    self->_availableCaptureModes = v5;

    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:_currentMode];
    v9 = [modesCopy containsObject:v8];

    if ([(CAMViewfinderViewController *)self isViewLoaded])
    {
      _modeDial = [(CAMViewfinderViewController *)self _modeDial];
      [_modeDial reloadData];
      _availableDefaultCaptureMode = [(CAMViewfinderViewController *)self _availableDefaultCaptureMode];
      if (_currentMode == _availableDefaultCaptureMode)
      {
        v12 = 1;
      }

      else
      {
        v12 = v9;
      }

      if ((v12 & 1) == 0)
      {
        v13 = _availableDefaultCaptureMode;
        if (_availableDefaultCaptureMode != -1)
        {
          v14 = +[CAMUserPreferences preferences];
          v15 = [v14 defaultDeviceForModeChange:v13 devicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}];

          [(CAMViewfinderViewController *)self changeToMode:v13 device:v15 animated:0];
        }
      }
    }

    else
    {
      if (v9)
      {
LABEL_13:
        [(CAMViewfinderViewController *)self _updateChromeAvailableCaptureModes];
        return;
      }

      _modeDial = os_log_create("com.apple.camera", "Camera");
      if (os_log_type_enabled(_modeDial, OS_LOG_TYPE_DEFAULT))
      {
        *v16 = 0;
        _os_log_impl(&dword_1A3640000, _modeDial, OS_LOG_TYPE_DEFAULT, "Unable to automatically change to a valid mode view isn't loaded yet", v16, 2u);
      }
    }

    goto LABEL_13;
  }
}

- (void)setDisablingAdditionalCaptures:(BOOL)captures
{
  if (self->_disablingAdditionalCaptures != captures)
  {
    self->_disablingAdditionalCaptures = captures;
    if (!captures)
    {
      [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    }
  }
}

- (void)setMessagesTransitionState:(int64_t)state animated:(BOOL)animated
{
  v24 = *MEMORY[0x1E69E9840];
  if (self->_messagesTransitionState == state)
  {
    return;
  }

  animatedCopy = animated;
  self->_messagesTransitionState = state;
  v7 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    if (state > 3)
    {
      v8 = 0;
    }

    else
    {
      v8 = off_1E76FA130[state];
    }

    v22 = 138543362;
    v23 = v8;
    _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "MessagesTransitionState set to %{public}@", &v22, 0xCu);
  }

  _shouldDisableUserInteractionForTransitioning = [(CAMViewfinderViewController *)self _shouldDisableUserInteractionForTransitioning];
  view = [(CAMViewfinderViewController *)self view];
  [view setUserInteractionEnabled:!_shouldDisableUserInteractionForTransitioning];

  [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
  _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
  messagesTransitionState = [(CAMViewfinderViewController *)self messagesTransitionState];
  if (messagesTransitionState <= 1)
  {
    if (messagesTransitionState)
    {
      if (messagesTransitionState == 1)
      {
        [_closedViewfinderController addClosedViewfinderReason:10];
      }

      goto LABEL_15;
    }

LABEL_13:
    [_closedViewfinderController removeClosedViewfinderReason:10];
    [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
    goto LABEL_15;
  }

  if (messagesTransitionState == 2)
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setControlDrawerExpanded:0 forReason:7 animated:0];

    [(CAMViewfinderViewController *)self _collapseExpandedButtonsAnimated:0];
    goto LABEL_15;
  }

  if (messagesTransitionState == 3)
  {
    goto LABEL_13;
  }

LABEL_15:
  if ([(CAMViewfinderViewController *)self messagesTransitionState]== 3)
  {
    _closedViewfinderController2 = [(CAMViewfinderViewController *)self _closedViewfinderController];
    isViewfinderClosed = [_closedViewfinderController2 isViewfinderClosed];

    if (isViewfinderClosed)
    {
      _transitionController = [(CAMViewfinderViewController *)self _transitionController];
      [_transitionController closeWithBlur:1 animated:0 withCompletionHandler:0];
    }
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v18 = [(CAMViewfinderViewController *)self _shouldHideShutterButtonForGraphConfiguration:_currentGraphConfiguration];

  v19 = !v18;
  _shutterButton = [(CAMViewfinderViewController *)self _shutterButton];
  [_shutterButton setAlpha:v19];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder2 setShutterControlVisible:v19];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
}

- (int64_t)_availableDefaultCaptureMode
{
  availableCaptureModes = [(CAMViewfinderViewController *)self availableCaptureModes];
  v3 = [availableCaptureModes count];
  if (v3 == 1)
  {
LABEL_8:
    anyObject = [availableCaptureModes anyObject];
    integerValue = [anyObject integerValue];

    goto LABEL_10;
  }

  if (v3)
  {
    v6 = [availableCaptureModes containsObject:&unk_1F16C7748];
    v7 = [availableCaptureModes containsObject:&unk_1F16C75F8];
    if ((v6 & 1) != 0 || v7)
    {
      integerValue = v6 ^ 1u;
      goto LABEL_10;
    }

    goto LABEL_8;
  }

  v4 = os_log_create("com.apple.camera", "Camera");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
  {
    [CAMViewfinderViewController _availableDefaultCaptureMode];
  }

  integerValue = -1;
LABEL_10:

  return integerValue;
}

- (id)_supportedCaptureModes
{
  v3 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v4 = +[CAMCaptureCapabilities capabilities];
  if ([v4 isBackTimelapseSupported])
  {
    v14 = 0;
  }

  else
  {
    v14 = [v4 isFrontTimelapseSupported] ^ 1;
  }

  if ([v4 isBackSlomoSupported])
  {
    v5 = 0;
  }

  else
  {
    v5 = [v4 isFrontSlomoSupported] ^ 1;
  }

  isVideoSupported = [v4 isVideoSupported];
  if ([v4 isSquareModeSupported])
  {
    wantsFullscreenViewfinder = [v4 wantsFullscreenViewfinder];
  }

  else
  {
    wantsFullscreenViewfinder = 1;
  }

  if ([v4 isBackPanoramaSupported])
  {
    v7 = 0;
  }

  else
  {
    v7 = [v4 isFrontPanoramaSupported] ^ 1;
  }

  isPortraitModeSupported = [v4 isPortraitModeSupported];
  isCinematicModeSupported = [v4 isCinematicModeSupported];
  isSpatialModeSupported = [v4 isSpatialModeSupported];
  v11 = ([v4 portraitInPhotoModeBehavior] & 8) == 0;
  isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
  if (((v14 | isEmulatingImagePicker) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7658];
  }

  if (((v5 | isEmulatingImagePicker) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7610];
  }

  if (isVideoSupported)
  {
    [v3 addObject:&unk_1F16C75F8];
  }

  [v3 addObject:&unk_1F16C7748];
  if ((v11 & isPortraitModeSupported) != 0)
  {
    [v3 addObject:&unk_1F16C7670];
  }

  if (((wantsFullscreenViewfinder | isEmulatingImagePicker) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7640];
  }

  if (((v7 | isEmulatingImagePicker) & 1) == 0)
  {
    [v3 addObject:&unk_1F16C7628];
  }

  if (!isEmulatingImagePicker && (isCinematicModeSupported & 1) != 0)
  {
    [v3 addObject:&unk_1F16C7688];
  }

  if (!isEmulatingImagePicker && (isSpatialModeSupported & 1) != 0)
  {
    [v3 addObject:&unk_1F16C76B8];
    [v3 addObject:&unk_1F16C76A0];
  }

  return v3;
}

- (void)_setPreventingAdditionalCaptures:(BOOL)captures
{
  v7 = *MEMORY[0x1E69E9840];
  if (self->_preventingAdditionalCaptures != captures)
  {
    capturesCopy = captures;
    v5 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      v6[0] = 67109120;
      v6[1] = capturesCopy;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "Preventing additional captures %d", v6, 8u);
    }

    self->_preventingAdditionalCaptures = capturesCopy;
    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"Preventing Multiple Captures for Single-Capture-Only Client"];
  }
}

- (void)setAutomaticallyAdjustsApplicationIdleTimer:(BOOL)timer
{
  if (self->_automaticallyAdjustsApplicationIdleTimer != timer)
  {
    timerCopy = timer;
    self->_automaticallyAdjustsApplicationIdleTimer = timer;
    _idleController = [(CAMViewfinderViewController *)self _idleController];
    v6 = _idleController;
    if (timerCopy)
    {
      [_idleController startUpdatingIdleTimer];
    }

    else
    {
      [_idleController stopUpdatingIdleTimer];
    }
  }
}

- (void)setPersistenceBehavior:(unint64_t)behavior
{
  if (self->_persistenceBehavior != behavior)
  {
    isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    behaviorCopy = 3;
    if (!isEmulatingImagePicker)
    {
      behaviorCopy = behavior;
    }

    self->_persistenceBehavior = behaviorCopy;
  }
}

- (void)setShowingStandardControls:(BOOL)controls
{
  if (self->_showingStandardControls != controls)
  {
    controlsCopy = controls;
    self->_showingStandardControls = controls;
    _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
    [_previewViewController setShowingStandardControls:controlsCopy];
    viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
    [viewfinderView setShowingStandardControls:controlsCopy];

    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setShowingStandardControls:controlsCopy];

    _fullscreenViewfinderZoomStyle = [(CAMViewfinderViewController *)self _fullscreenViewfinderZoomStyle];
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder2 setZoomStyle:_fullscreenViewfinderZoomStyle];

    [(CAMViewfinderViewController *)self _updateFullscreenViewfinderZoomSliderIfNecessary];
    if (controlsCopy)
    {
      [(CAMViewfinderViewController *)self _createCommonControlsIfNecessary];
      [(CAMViewfinderViewController *)self _createCommonGestureRecognizersIfNecessary];
      _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _createModeSpecificControlsForConfiguration:_currentGraphConfiguration];
    }

    else
    {
      [(CAMViewfinderViewController *)self _destroyGestureRecognizersRequiringStandardControls];
      [(CAMViewfinderViewController *)self _unembedAndDestroyAllControls];
    }
  }
}

- (void)setImagePickerVideoConfiguration:(int64_t)configuration
{
  if (self->_imagePickerVideoConfiguration != configuration)
  {
    self->_imagePickerVideoConfiguration = configuration;
    isEmulatingImagePicker = [(CAMViewfinderViewController *)self isEmulatingImagePicker];
    _currentMode = [(CAMViewfinderViewController *)self _currentMode];
    if (isEmulatingImagePicker && _currentMode == 1)
    {

      [(CAMViewfinderViewController *)self _reconfigureCaptureGraphWithCurrentMode];
    }
  }
}

- (void)setCustomPreviewViewTransform:(CGAffineTransform *)transform
{
  if ([(CAMViewfinderViewController *)self emulationMode])
  {
    v5 = *&self->_customPreviewViewTransform.c;
    *&t1.a = *&self->_customPreviewViewTransform.a;
    *&t1.c = v5;
    *&t1.tx = *&self->_customPreviewViewTransform.tx;
    v6 = *&transform->c;
    *&v9.a = *&transform->a;
    *&v9.c = v6;
    *&v9.tx = *&transform->tx;
    if (!CGAffineTransformEqualToTransform(&t1, &v9))
    {
      v7 = *&transform->a;
      v8 = *&transform->tx;
      *&self->_customPreviewViewTransform.c = *&transform->c;
      *&self->_customPreviewViewTransform.tx = v8;
      *&self->_customPreviewViewTransform.a = v7;
      [(CAMViewfinderViewController *)self _applyTransformsForAutorotationStyle:[(CAMViewfinderViewController *)self autorotationStyle]];
    }
  }
}

- (void)setPerformingReviewUsingOverlay:(BOOL)overlay
{
  if (self->_performingReviewUsingOverlay != overlay)
  {
    overlayCopy = overlay;
    self->_performingReviewUsingOverlay = overlay;
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    [(CAMViewfinderViewController *)self _updateTorchModeOnControllerForMode:[(CAMViewfinderViewController *)self _currentMode]];
    _closedViewfinderController = [(CAMViewfinderViewController *)self _closedViewfinderController];
    _disabledPreviewController = [(CAMViewfinderViewController *)self _disabledPreviewController];
    if (overlayCopy)
    {
      [_closedViewfinderController addClosedViewfinderReason:9];
      [_disabledPreviewController addDisabledPreviewReason:1];
      [(CAMViewfinderViewController *)self suspendCameraSessionWithCompletion:0];
    }

    else
    {
      [_closedViewfinderController removeClosedViewfinderReason:9];
      [_disabledPreviewController removeDisabledPreviewReason:1];
      [(CAMViewfinderViewController *)self resumeCameraSessionWithCompletion:0];
      if ([(CAMViewfinderViewController *)self isDisablingAdditionalCaptures])
      {
        [(CAMViewfinderViewController *)self _setPreventingAdditionalCaptures:0];
      }
    }
  }
}

- (CGRect)reviewUsingOverlayFrame
{
  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  previewView = [_previewViewController previewView];

  [previewView bounds];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  Width = v11;
  view = [(CAMViewfinderViewController *)self view];
  window = [view window];
  v15 = CAMInterfaceOrientationForWindow(window);

  if ((v15 - 3) <= 1)
  {
    v25.origin.x = v6;
    v25.origin.y = v8;
    v25.size.width = v10;
    v25.size.height = Width;
    MinX = CGRectGetMinX(v25);
    v26.origin.x = v6;
    v26.origin.y = v8;
    v26.size.width = v10;
    v26.size.height = Width;
    MinY = CGRectGetMinY(v26);
    v27.origin.x = v6;
    v27.origin.y = v8;
    v27.size.width = v10;
    v27.size.height = Width;
    Height = CGRectGetHeight(v27);
    v28.origin.x = v6;
    v28.origin.y = v8;
    v28.size.width = v10;
    v28.size.height = Width;
    Width = CGRectGetWidth(v28);
    v10 = Height;
    v8 = MinY;
    v6 = MinX;
  }

  v29.origin.x = v6;
  v29.origin.y = v8;
  v29.size.width = v10;
  v29.size.height = Width;
  v19 = CGRectGetWidth(v29);
  v30.origin.x = v6;
  v30.origin.y = v8;
  v30.size.width = v10;
  v30.size.height = Width;
  v20 = CGRectGetHeight(v30);

  v21 = 0.0;
  v22 = 0.0;
  v23 = v19;
  v24 = v20;
  result.size.height = v24;
  result.size.width = v23;
  result.origin.y = v22;
  result.origin.x = v21;
  return result;
}

- (int64_t)_videoConfigurationForImagePickerQualityType:(int64_t)type
{
  if (type >= 6)
  {
    return 0;
  }

  else
  {
    return type + 10000;
  }
}

- (void)_setUpTipManagerIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  if ([v3 smartStylesSupported])
  {
    if (!CFPreferencesGetAppBooleanValue(@"CAMSmartStylesTipWasPresented", @"com.apple.camera", 0))
    {
      v4 = AVSmartStyleSettingsGetSystemStyleFast();

      if (!v4)
      {
        _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
        controlStatusBar = [_fullscreenViewfinder controlStatusBar];

        smartStyleIndicator = [controlStatusBar smartStyleIndicator];

        if (smartStyleIndicator)
        {
          v8 = dispatch_get_global_queue(21, 0);
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke;
          v9[3] = &unk_1E76F9C08;
          v9[4] = self;
          v10 = controlStatusBar;
          v11 = @"CAMSmartStylesTipWasPresented";
          v12 = @"com.apple.camera";
          dispatch_async(v8, v9);
        }
      }
    }
  }
}

void __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke(uint64_t a1)
{
  if ([MEMORY[0x1E69C4320] sharedPhotoLibraryIsEligibleForStylesSetupTip])
  {
    v3[0] = MEMORY[0x1E69E9820];
    v3[1] = 3221225472;
    v3[2] = __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke_2;
    v3[3] = &unk_1E76F9C08;
    v2 = *(a1 + 40);
    v3[4] = *(a1 + 32);
    v4 = v2;
    v5 = *(a1 + 48);
    dispatch_async(MEMORY[0x1E69E96A0], v3);
  }
}

void __55__CAMViewfinderViewController__setUpTipManagerIfNeeded__block_invoke_2(uint64_t a1)
{
  if (!+[CAMApplication appOrPlugInState](CAMApplication, "appOrPlugInState") && ([*(a1 + 32) _isShowingCameraRoll] & 1) == 0 && (objc_msgSend(*(a1 + 32), "isPreventingAdditionalCaptures") & 1) == 0)
  {
    v2 = [*(a1 + 32) _primaryShutterControl];
    v3 = [v2 isTracking];

    if ((v3 & 1) == 0)
    {
      v4 = [*(a1 + 32) _motionController];
      v5 = [v4 captureOrientation];

      if (v5 == 1)
      {
        [*(a1 + 40) frame];
        MaxY = CGRectGetMaxY(v15);
        v7 = [*(a1 + 32) view];
        [v7 safeAreaInsets];
        v9 = MaxY - v8 + 55.0;

        v10 = [*(a1 + 40) directionIndicator];
        v13 = [CAMViewfinderTipManager stylesTipViewControllerWithSourceItem:v10];

        v11 = [v13 popoverPresentationController];
        [v11 setPermittedArrowDirections:0];

        v12 = [v13 popoverPresentationController];
        [v12 setPopoverLayoutMargins:{v9, 0.0, 0.0, 0.0}];

        [*(a1 + 32) presentViewController:v13 animated:1 completion:0];
        CFPreferencesSetAppValue(*(a1 + 48), MEMORY[0x1E695E118], *(a1 + 56));
      }
    }
  }
}

- (void)captureController:(id)controller didOutputShallowDepthOfFieldStatus:(int64_t)status stagePreviewStatus:(int64_t)previewStatus
{
  v25 = *MEMORY[0x1E69E9840];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  v9 = _currentMode;
  if (_currentMode > 9)
  {
LABEL_27:
    if (!_currentMode)
    {
      v16 = +[CAMCaptureCapabilities capabilities];
      if ([v16 isPhotoModeDepthSuggestionSupportedForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](self, "_currentDevicePosition")}])
      {
        v17 = +[CAMCaptureCapabilities capabilities];
        if ([v17 featureDevelopmentIgnoreDepthSuggestionInPhotoMode])
        {
          status = 0;
        }
      }

      else
      {
        status = 0;
      }
    }

    goto LABEL_4;
  }

  if (((1 << _currentMode) & 0x33C) != 0)
  {
    status = 0;
    goto LABEL_4;
  }

  if (_currentMode != 1)
  {
    if (_currentMode == 7)
    {
      if (status - 1) < 0xF && ((0x7DE7u >> (status - 1)))
      {
        status = 0;
      }

      goto LABEL_4;
    }

    goto LABEL_27;
  }

  if ((0x7DEFu >> (status - 1)))
  {
    statusCopy = 0;
  }

  else
  {
    statusCopy = status;
  }

  if ((status - 1) < 0xF)
  {
    status = statusCopy;
  }

LABEL_4:
  if (([(CAMViewfinderViewController *)self portraitModeLightingEffectType]- 7) < 0xFFFFFFFFFFFFFFFDLL || status == 0)
  {
    previewStatus = 0;
  }

  v11 = +[CAMApplication appOrPlugInState];
  v12 = os_log_create("com.apple.camera", "Portrait");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    if (v9 > 9)
    {
      v13 = 0;
    }

    else
    {
      v13 = off_1E76FA1E8[v9];
    }

    if (status > 0xF)
    {
      v14 = 0;
    }

    else
    {
      v14 = off_1E76FA150[status];
    }

    if (previewStatus > 2)
    {
      v15 = 0;
    }

    else
    {
      v15 = off_1E76FA1D0[previewStatus];
    }

    v19 = 138543874;
    v20 = v13;
    v21 = 2114;
    v22 = v14;
    v23 = 2114;
    v24 = v15;
    _os_log_impl(&dword_1A3640000, v12, OS_LOG_TYPE_DEFAULT, "Updating shallow depth of field status in %{public}@ Mode: %{public}@/%{public}@", &v19, 0x20u);
  }

  [(CAMViewfinderViewController *)self _setShallowDepthOfFieldStatus:status stagePreviewStatus:previewStatus animated:v11 != 2];
}

- (void)_setShallowDepthOfFieldStatus:(int64_t)status stagePreviewStatus:(int64_t)previewStatus animated:(BOOL)animated
{
  animatedCopy = animated;
  if (self->__shallowDepthOfFieldStatus != status || self->__stagePreviewStatus != previewStatus)
  {
    self->__stagePreviewStatus = previewStatus;
    self->__shallowDepthOfFieldStatus = status;
    [(CAMViewfinderViewController *)self _updateForShallowDepthOfFieldStatusChangedAnimated:animated];
    [(CAMViewfinderViewController *)self _updateViewfinderMaterialAnimated:animatedCopy];
    _remoteShutterController = [(CAMViewfinderViewController *)self _remoteShutterController];
    [_remoteShutterController setShallowDepthOfFieldStatus:self->__shallowDepthOfFieldStatus];
  }
}

- (void)_updateForShallowDepthOfFieldStatusChangedAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _shallowDepthOfFieldStatus = [(CAMViewfinderViewController *)self _shallowDepthOfFieldStatus];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setShallowDepthOfFieldStatus:_shallowDepthOfFieldStatus animated:animatedCopy];

  [(CAMViewfinderViewController *)self _updatePreviewControllerPortraitStatus];
  [(CAMViewfinderViewController *)self _updatePortraitModeInstructionLabelForCurrentState];
  _shallowDepthOfFieldBadge = [(CAMViewfinderViewController *)self _shallowDepthOfFieldBadge];
  [_shallowDepthOfFieldBadge setShallowDepthOfFieldStatus:_shallowDepthOfFieldStatus animated:animatedCopy];

  [(CAMViewfinderViewController *)self _updatePreviewControllerIndicatorStyle];
  [(CAMViewfinderViewController *)self _updateDepthEffectSuggestionButton];
  LODWORD(_shallowDepthOfFieldBadge) = _shallowDepthOfFieldStatus < 0xF;
  v8 = 0x6202u >> _shallowDepthOfFieldStatus;
  _lightingControl = [(CAMViewfinderViewController *)self _lightingControl];
  [_lightingControl setHighlighted:_shallowDepthOfFieldBadge & (0x6202u >> _shallowDepthOfFieldStatus) animated:animatedCopy];
  _lightingNameBadge = [(CAMViewfinderViewController *)self _lightingNameBadge];
  [_lightingNameBadge setHighlighted:_shallowDepthOfFieldBadge & v8 animated:animatedCopy];

  if (![(CAMViewfinderViewController *)self _hasInFlightConfiguration])
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:animatedCopy];
  }

  [(CAMViewfinderViewController *)self _updateZoomControlAccessoryStateAnimated:animatedCopy];
}

- (void)_updatePreviewControllerPortraitStatus
{
  _stagePreviewStatus = [(CAMViewfinderViewController *)self _stagePreviewStatus];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v5 = [(CAMViewfinderViewController *)self _wantsLightingControlForGraphConfiguration:_currentGraphConfiguration];

  if (v5)
  {
    v6 = _stagePreviewStatus;
  }

  else
  {
    v6 = 0;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingBurst = [_captureController isCapturingBurst];

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSemanticStyleControlVisible = [_fullscreenViewfinder isSemanticStyleControlVisible];

  _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isSmartStylePickerVisible = [_fullscreenViewfinder2 isSmartStylePickerVisible];

  if ((isSmartStylePickerVisible | isSemanticStyleControlVisible | isCapturingBurst))
  {
    v13 = 0;
  }

  else
  {
    v13 = v6;
  }

  _previewViewController = [(CAMViewfinderViewController *)self _previewViewController];
  [_previewViewController setShallowDepthOfFieldStatus:-[CAMViewfinderViewController _shallowDepthOfFieldStatus](self stagePreviewStatus:{"_shallowDepthOfFieldStatus"), v13}];
}

- (BOOL)_shouldShowDescriptionOverlayViewForGraphConfiguration:(id)configuration viewClass:(Class *)class
{
  configurationCopy = configuration;
  v7 = +[CAMCaptureCapabilities capabilities];
  v8 = +[CAMUserPreferences preferences];
  bypassWelcomeScreens = [v7 bypassWelcomeScreens];
  mode = [configurationCopy mode];

  if ([v7 hostProcess])
  {
    if (([v7 hostProcess] != 4) | bypassWelcomeScreens & 1)
    {
      goto LABEL_5;
    }
  }

  else if (bypassWelcomeScreens)
  {
    goto LABEL_5;
  }

  if (([v8 didAcknowledgeSolCamDescription] & 1) != 0 || -[CAMViewfinderViewController _layoutStyle](self, "_layoutStyle") == 1)
  {
    LOBYTE(v12) = 0;
    v11 = 0;
    if (mode <= 7)
    {
      if (mode)
      {
        if (mode == 6)
        {
          if ([v7 allowPortraitDescriptionOverlay])
          {
            v12 = [v8 didAcknowledgePortraitModeDescription] ^ 1;
          }

          else
          {
            LOBYTE(v12) = 0;
          }
        }

        else
        {
          if (mode != 7)
          {
            goto LABEL_35;
          }

          v12 = [v8 didAcknowledgeCinematicModeDescription] ^ 1;
        }

        goto LABEL_34;
      }

      semanticStylesSupport = [v7 semanticStylesSupport];
      if ([v7 isDepthEffectApertureSupportedForMode:0 devicePosition:0])
      {
        if ((semanticStylesSupport & 8) == 0 || ![v7 smartStylesOnboardingSupported])
        {
          goto LABEL_30;
        }

        goto LABEL_28;
      }

      v14 = [v7 isDepthEffectApertureSupportedForMode:0 devicePosition:1];
      v15 = v14;
      if ((semanticStylesSupport & 8) != 0)
      {
        if ([v7 smartStylesOnboardingSupported])
        {
LABEL_28:
          v12 = [v8 didAcknowledgeSmartStylesDescription] ^ 1;
          goto LABEL_34;
        }

        if ((v15 & 1) == 0)
        {
          v12 = [v8 didAcknowledgeSemanticStylesDescription] ^ 1;
          goto LABEL_34;
        }
      }

      else if (!v14)
      {
        if ([v7 isLongPressVideoCaptureFromPhotoModeSupported])
        {
          v12 = [v8 didAcknowledgeCTMDescription] ^ 1;
        }

        else
        {
          LOBYTE(v12) = 0;
        }

        goto LABEL_34;
      }

LABEL_30:
      if (([v7 smartStylesSupported] & 1) == 0)
      {
        v12 = [v8 didAcknowledgeDepthInPhotoModeDescription] ^ 1;
        goto LABEL_34;
      }

LABEL_5:
      v11 = 0;
      LOBYTE(v12) = 0;
      goto LABEL_35;
    }

    if ((mode - 8) >= 2)
    {
      goto LABEL_35;
    }

    v12 = [v8 didAcknowledgeSpatialModeOverlayDescription] ^ 1;
  }

  else
  {
    LOBYTE(v12) = 1;
  }

LABEL_34:
  v11 = objc_opt_class();
LABEL_35:
  if (class)
  {
    *class = v11;
  }

  return v12;
}

- (void)_acknowledgeDescriptionOverlayViewForMode:(int64_t)mode
{
  v5 = +[CAMUserPreferences preferences];
  if (mode > 7)
  {
    if ((mode - 8) >= 2)
    {
      goto LABEL_20;
    }

    v14 = v5;
    [v5 setDidAcknowledgeSpatialModeOverlayDescription:1];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSpatialCaptureUIStateForGraphConfiguration:_currentGraphConfiguration animated:1];
  }

  else
  {
    if (mode)
    {
      if (mode == 6)
      {
        v14 = v5;
        [v5 setDidAcknowledgePortraitModeDescription:1];
      }

      else
      {
        if (mode != 7)
        {
          goto LABEL_20;
        }

        v14 = v5;
        [v5 setDidAcknowledgeCinematicModeDescription:1];
      }

      goto LABEL_19;
    }

    v14 = v5;
    v7 = +[CAMCaptureCapabilities capabilities];
    semanticStylesSupport = [v7 semanticStylesSupport];

    v9 = +[CAMCaptureCapabilities capabilities];
    if ([v9 isDepthEffectApertureSupportedForMode:0 devicePosition:0])
    {

      if ((semanticStylesSupport & 8) == 0)
      {
        goto LABEL_18;
      }

      LOBYTE(v10) = 1;
LABEL_15:
      v12 = +[CAMCaptureCapabilities capabilities];
      smartStylesSupported = [v12 smartStylesSupported];

      if (smartStylesSupported)
      {
        [v14 setDidAcknowledgeSmartStylesDescription:1];
        goto LABEL_19;
      }

      if ((v10 & 1) == 0)
      {
        [v14 setDidAcknowledgeSemanticStylesDescription:1];
        goto LABEL_19;
      }

LABEL_18:
      [v14 setDidAcknowledgeDepthInPhotoModeDescription:1];
      goto LABEL_19;
    }

    v11 = +[CAMCaptureCapabilities capabilities];
    v10 = [v11 isDepthEffectApertureSupportedForMode:0 devicePosition:1];

    if ((semanticStylesSupport & 8) != 0)
    {
      goto LABEL_15;
    }

    if (v10)
    {
      goto LABEL_18;
    }

    [v14 setDidAcknowledgeCTMDescription:1];
  }

LABEL_19:
  v5 = v14;
LABEL_20:
}

- (id)_embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  v18 = 0;
  v6 = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:configurationCopy viewClass:&v18];

  v7 = 0;
  if (v6)
  {
    _descriptionOverlayViewByMode = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
    v10 = [_descriptionOverlayViewByMode objectForKeyedSubscript:v9];
    v11 = [v10 isMemberOfClass:objc_opt_class()];

    _descriptionOverlayViewByMode2 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v13 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
    if (v11)
    {
      [_descriptionOverlayViewByMode2 setObject:0 forKeyedSubscript:v13];
    }

    else
    {
      v7 = [_descriptionOverlayViewByMode2 objectForKeyedSubscript:v13];

      if (v7)
      {
        goto LABEL_7;
      }
    }

    v14 = [v18 alloc];
    v7 = [v14 initWithFrame:{*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)}];
    [v7 setVisible:0 animationDuration:0 completion:0.0];
    [v7 setDelegate:self];
  }

  [(CAMViewfinderViewController *)self _embedDescriptionOverlayView:v7 forMode:mode];
  _descriptionOverlayViewByMode3 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v16 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  [_descriptionOverlayViewByMode3 setObject:v7 forKeyedSubscript:v16];

LABEL_7:

  return v7;
}

- (void)_embedDescriptionOverlayView:(id)view forMode:(int64_t)mode
{
  viewCopy = view;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  if (viewfinderView)
  {
    _fullscreenViewfinder = [MEMORY[0x1E696AD98] numberWithInteger:mode];
    [viewfinderView setDescriptionOverlayView:viewCopy forKey:_fullscreenViewfinder];
  }

  else
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
    [_fullscreenViewfinder setDescriptionOverlayView:viewCopy forKey:v8];

    viewCopy = v8;
  }
}

- (void)_dismissDescriptionOverlayView:(id)view withDuration:(double)duration fromUserAction:(BOOL)action
{
  viewCopy = view;
  if (viewCopy)
  {
    if (!action && [viewCopy isMemberOfClass:objc_opt_class()])
    {
      [CAMPreferencesUtilities setBool:1 inCameraDomainForKey:@"CAMSmartStylesOnboardingCameraAppDidDismissForAction"];
    }

    v24 = 0;
    v25 = &v24;
    v26 = 0x2020000000;
    v27 = 0;
    _descriptionOverlayViewByMode = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v21[0] = MEMORY[0x1E69E9820];
    v21[1] = 3221225472;
    v21[2] = __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke;
    v21[3] = &unk_1E76F9C30;
    v10 = viewCopy;
    v22 = v10;
    v23 = &v24;
    [_descriptionOverlayViewByMode enumerateKeysAndObjectsUsingBlock:v21];

    v11 = +[CAMUserPreferences preferences];
    if (([v10 isMemberOfClass:objc_opt_class()] & 1) == 0 || (objc_msgSend(v11, "setDidAcknowledgeSolCamDescription:", 1), !action))
    {
      [(CAMViewfinderViewController *)self _acknowledgeDescriptionOverlayViewForMode:v25[3]];
    }

    _descriptionOverlayViewByMode2 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
    v13 = [MEMORY[0x1E696AD98] numberWithInteger:v25[3]];
    [_descriptionOverlayViewByMode2 setObject:0 forKeyedSubscript:v13];

    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    LODWORD(_descriptionOverlayViewByMode2) = [(CAMViewfinderViewController *)self _shouldShowDescriptionOverlayViewForGraphConfiguration:_currentGraphConfiguration];

    v19[0] = MEMORY[0x1E69E9820];
    v19[1] = 3221225472;
    v19[2] = __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke_2;
    v19[3] = &unk_1E76F9C58;
    v20 = _descriptionOverlayViewByMode2;
    v19[4] = self;
    v19[5] = &v24;
    [v10 setVisible:0 animationDuration:v19 completion:duration];
    [v10 setDelegate:0];
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setIsShowingOverlayDescription:0];

    if (([v10 isMemberOfClass:objc_opt_class()] & _descriptionOverlayViewByMode2) == 1)
    {
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v17 = [(CAMViewfinderViewController *)self _embedDescriptionOverlayViewIfNecessaryForGraphConfiguration:_currentGraphConfiguration2];
      [v17 setVisible:1 animationDuration:0 completion:duration];

      chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
      [chromeConfigurator2 setIsShowingOverlayDescription:1];
    }

    _Block_object_dispose(&v24, 8);
  }
}

uint64_t __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke(uint64_t result, void *a2, uint64_t a3, _BYTE *a4)
{
  if (*(result + 32) == a3)
  {
    v5 = result;
    result = [a2 integerValue];
    *(*(*(v5 + 40) + 8) + 24) = result;
    *a4 = 1;
  }

  return result;
}

uint64_t __90__CAMViewfinderViewController__dismissDescriptionOverlayView_withDuration_fromUserAction___block_invoke_2(uint64_t result)
{
  if ((*(result + 48) & 1) == 0)
  {
    return [*(result + 32) _embedDescriptionOverlayView:0 forMode:*(*(*(result + 40) + 8) + 24)];
  }

  return result;
}

- (void)_updateDescriptionOverlayVisibilityForMode:(int64_t)mode allowShow:(BOOL)show allowHide:(BOOL)hide animated:(BOOL)animated
{
  _descriptionOverlayViewByMode = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v16[0] = MEMORY[0x1E69E9820];
  v16[1] = 3221225472;
  v16[2] = __103__CAMViewfinderViewController__updateDescriptionOverlayVisibilityForMode_allowShow_allowHide_animated___block_invoke;
  v16[3] = &__block_descriptor_43_e52_v32__0__NSNumber_8__CAMDescriptionOverlayView_16_B24l;
  v16[4] = mode;
  showCopy = show;
  hideCopy = hide;
  animatedCopy = animated;
  [_descriptionOverlayViewByMode enumerateKeysAndObjectsUsingBlock:v16];

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  _descriptionOverlayViewByMode2 = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v14 = [MEMORY[0x1E696AD98] numberWithInteger:mode];
  v15 = [_descriptionOverlayViewByMode2 objectForKeyedSubscript:v14];
  [chromeConfigurator setIsShowingOverlayDescription:{objc_msgSend(v15, "isVisible")}];
}

void __103__CAMViewfinderViewController__updateDescriptionOverlayVisibilityForMode_allowShow_allowHide_animated___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v10 = a3;
  v5 = [a2 integerValue];
  v6 = *(a1 + 32);
  v7 = *(a1 + 40) == 1 && v5 == v6;
  if (v7 || (*(a1 + 41) == 1 ? (v8 = v5 == v6) : (v8 = 1), !v8))
  {
    v9 = 0.25;
    if (!*(a1 + 42))
    {
      v9 = 0.0;
    }

    [v10 setVisible:v5 == v6 animationDuration:0 completion:v9];
  }
}

- (void)descriptionOverlayView:(id)view willBecomeVisible:(BOOL)visible
{
  visibleCopy = visible;
  viewCopy = view;
  if ([viewCopy isMemberOfClass:objc_opt_class()])
  {
    if (visibleCopy)
    {
      v6 = objc_alloc_init(CAMSmartStyleSettingsController);
      prewarmedSmartStylesController = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = v6;

      view = [(CAMSmartStyleSettingsController *)self->__prewarmedSmartStylesController view];
      [view setAlpha:0.0];
      [viewCopy bounds];
      [view setFrame:?];
      [view setAutoresizingMask:18];
      [viewCopy addSubview:view];
    }

    else
    {
      view = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = 0;
    }
  }
}

- (void)descriptionOverlayViewDidSelectDetail:(id)detail
{
  detailCopy = detail;
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  _descriptionOverlayViewByMode = [(CAMViewfinderViewController *)self _descriptionOverlayViewByMode];
  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __69__CAMViewfinderViewController_descriptionOverlayViewDidSelectDetail___block_invoke;
  v13[3] = &unk_1E76F9C30;
  v6 = detailCopy;
  v14 = v6;
  v15 = &v16;
  [_descriptionOverlayViewByMode enumerateKeysAndObjectsUsingBlock:v13];

  if (!v17[3])
  {
    if ([v6 isMemberOfClass:objc_opt_class()])
    {
      v7 = objc_alloc_init(CAMSemanticStyleSettingsController);
      [(CAMSemanticStyleSettingsController *)v7 setControllerDelegate:self];
      if (![(CAMViewfinderViewController *)self _layoutStyle])
      {
        [(CAMSemanticStyleSettingsController *)v7 setModalPresentationStyle:0];
      }

      if (!v7)
      {
        goto LABEL_13;
      }
    }

    else
    {
      if (![v6 isMemberOfClass:objc_opt_class()])
      {
        v7 = 0;
        goto LABEL_13;
      }

      v8 = os_log_create("com.apple.camera", "SmartStyleSettings");
      if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
      {
        *v12 = 0;
        _os_log_impl(&dword_1A3640000, v8, OS_LOG_TYPE_DEFAULT, "Onboarding: presenting smart style settings", v12, 2u);
      }

      v9 = self->__prewarmedSmartStylesController;
      [(CAMSmartStyleSettingsController *)v9 setControllerDelegate:self];
      [(CAMSmartStyleSettingsController *)v9 setModalPresentationStyle:0];
      view = [(CAMSmartStyleSettingsController *)v9 view];
      [view setAlpha:1.0];
      [view removeFromSuperview];
      [(CAMSmartStyleSettingsController *)v9 speedUpFadeInAnimations];
      v7 = v9;
      prewarmedSmartStylesController = self->__prewarmedSmartStylesController;
      self->__prewarmedSmartStylesController = 0;

      [CAMPreferencesUtilities setBool:1 inCameraDomainForKey:@"CAMSmartStylesOnboardingCameraAppDidTapChooseStyle"];
      if (!v7)
      {
        goto LABEL_13;
      }
    }

    [(CAMViewfinderViewController *)self presentViewController:v7 animated:1 completion:0];
    [(CAMViewfinderViewController *)self _dismissDescriptionOverlayView:v6 withDuration:1 fromUserAction:0.5];
LABEL_13:
  }

  _Block_object_dispose(&v16, 8);
}

uint64_t __69__CAMViewfinderViewController_descriptionOverlayViewDidSelectDetail___block_invoke(uint64_t result, void *a2, uint64_t a3, _BYTE *a4)
{
  if (*(result + 32) == a3)
  {
    v5 = result;
    result = [a2 integerValue];
    *(*(*(v5 + 40) + 8) + 24) = result;
    *a4 = 1;
  }

  return result;
}

- (void)descriptionOverlayViewSetTextViewFrame:(id)frame textViewFrame:(CGRect)viewFrame
{
  [frame textViewFrame];
  v6 = v5;
  v8 = v7;
  v10 = v9;
  v12 = v11;
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setDescriptionOverlayTextViewFrame:{v6, v8, v10, v12}];
}

- (BOOL)_shouldDisableModeForGraphConfiguration:(id)configuration callActive:(BOOL)active
{
  v4 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:configuration callActive:active];
  v5 = [v4 count] != 0;

  return v5;
}

- (id)_disabledModeReasonsForGraphConfiguration:(id)configuration callActive:(BOOL)active
{
  activeCopy = active;
  configurationCopy = configuration;
  mode = [configurationCopy mode];
  v9 = mode <= 8 && ((1 << mode) & 0x186) != 0 && activeCopy;
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if ([_captureController isInterrupted])
  {
    currentCameraSystemPressureState = [_captureController currentCameraSystemPressureState];
    isCameraTooHot = [currentCameraSystemPressureState isCameraTooHot];
  }

  else
  {
    isCameraTooHot = 0;
  }

  v18 = 0;
  v19 = &v18;
  v20 = 0x3032000000;
  v21 = __Block_byref_object_copy__5;
  v22 = __Block_byref_object_dispose__5;
  v23 = 0;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __84__CAMViewfinderViewController__disabledModeReasonsForGraphConfiguration_callActive___block_invoke;
  aBlock[3] = &unk_1E76F9CA0;
  aBlock[4] = &v18;
  v13 = _Block_copy(aBlock);
  v14 = v13;
  if (v9)
  {
    (*(v13 + 2))(v13, 0);
  }

  if (isCameraTooHot)
  {
    v14[2](v14, 1);
  }

  v15 = v19[5];

  _Block_object_dispose(&v18, 8);

  return v15;
}

void __84__CAMViewfinderViewController__disabledModeReasonsForGraphConfiguration_callActive___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(*(*(a1 + 32) + 8) + 40);
  if (!v3)
  {
    v5 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    v6 = *(*(a1 + 32) + 8);
    v7 = *(v6 + 40);
    *(v6 + 40) = v5;

    v3 = *(*(*(a1 + 32) + 8) + 40);
  }

  v8 = [MEMORY[0x1E696AD98] numberWithInteger:a2];
  [v3 addObject:v8];
}

- (BOOL)_shouldSuspendCaptureSessionForGraphConfiguration:(id)configuration callActive:(BOOL)active
{
  selfCopy = self;
  v5 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:configuration callActive:active];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldSuspendCaptureSessionForModeDisabledReasons:v5];

  return selfCopy;
}

- (BOOL)_shouldSuspendCaptureSessionForModeDisabledReasons:(id)reasons
{
  v16 = *MEMORY[0x1E69E9840];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  reasonsCopy = reasons;
  v5 = [reasonsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v12;
    while (2)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v12 != v7)
        {
          objc_enumerationMutation(reasonsCopy);
        }

        if (-[CAMViewfinderViewController _shouldSuspendCaptureSessionForModeDisabledReason:](self, "_shouldSuspendCaptureSessionForModeDisabledReason:", [*(*(&v11 + 1) + 8 * i) integerValue]))
        {
          v9 = 1;
          goto LABEL_11;
        }
      }

      v6 = [reasonsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v6)
      {
        continue;
      }

      break;
    }
  }

  v9 = 0;
LABEL_11:

  return v9;
}

- (BOOL)_shouldDisableEventInteractionForGraphConfiguration:(id)configuration callActive:(BOOL)active
{
  selfCopy = self;
  v5 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:configuration callActive:active];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldDisableEventInteractionForModeDisabledReasons:v5];

  return selfCopy;
}

- (BOOL)_shouldDisableEventInteractionForModeDisabledReasons:(id)reasons
{
  v16 = *MEMORY[0x1E69E9840];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  reasonsCopy = reasons;
  v5 = [reasonsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v12;
    while (2)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v12 != v7)
        {
          objc_enumerationMutation(reasonsCopy);
        }

        if (-[CAMViewfinderViewController _shouldDisableEventInteractionForModeDisabledReason:](self, "_shouldDisableEventInteractionForModeDisabledReason:", [*(*(&v11 + 1) + 8 * i) integerValue]))
        {
          v9 = 1;
          goto LABEL_11;
        }
      }

      v6 = [reasonsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v6)
      {
        continue;
      }

      break;
    }
  }

  v9 = 0;
LABEL_11:

  return v9;
}

- (id)_debugStringForDisabledModeReasons:(id)reasons
{
  v20 = *MEMORY[0x1E69E9840];
  reasonsCopy = reasons;
  if ([reasonsCopy count])
  {
    v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(reasonsCopy, "count")}];
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v5 = reasonsCopy;
    v6 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v16;
      do
      {
        for (i = 0; i != v7; ++i)
        {
          if (*v16 != v8)
          {
            objc_enumerationMutation(v5);
          }

          integerValue = [*(*(&v15 + 1) + 8 * i) integerValue];
          if (integerValue == 1)
          {
            v11 = @"CameraTooHot";
          }

          else
          {
            v11 = 0;
          }

          if (integerValue)
          {
            v12 = v11;
          }

          else
          {
            v12 = @"ActiveCall";
          }

          [v4 addObject:v12];
        }

        v7 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
      }

      while (v7);
    }

    v13 = [v4 componentsJoinedByString:{@", "}];
  }

  else
  {
    v13 = @"<none>";
  }

  return v13;
}

- (void)_embedDisabledModeOverlayView:(id)view
{
  viewCopy = view;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = viewfinderView;
  if (!viewfinderView)
  {
    v6 = _fullscreenViewfinder;
  }

  [v6 setDisabledModeOverlayView:viewCopy];
}

- (void)_unembedDisabledModeOverlayView:(id)view
{
  viewCopy = view;
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v6 = _fullscreenViewfinder;
  if (viewfinderView)
  {
    disabledModeOverlayView = [viewfinderView disabledModeOverlayView];

    if (disabledModeOverlayView != viewCopy)
    {
      goto LABEL_7;
    }

    v8 = viewfinderView;
  }

  else
  {
    disabledModeOverlayView2 = [_fullscreenViewfinder disabledModeOverlayView];

    if (disabledModeOverlayView2 != viewCopy)
    {
      goto LABEL_7;
    }

    v8 = v6;
  }

  [v8 setDisabledModeOverlayView:viewCopy];
LABEL_7:
}

- (void)_updateDisabledModeUIAnimated:(BOOL)animated
{
  animatedCopy = animated;
  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {
    _isModeDisabled = [(CAMViewfinderViewController *)self _isModeDisabled];
    _disabledModeOverlayView = [(CAMViewfinderViewController *)self _disabledModeOverlayView];
    v7 = _disabledModeOverlayView;
    if ((_isModeDisabled ^ (_disabledModeOverlayView != 0)))
    {
      if (_disabledModeOverlayView)
      {
        if (animatedCopy)
        {
          v8 = _disabledModeOverlayView;
          [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:0];
          v9 = MEMORY[0x1E69DD250];
          v14[0] = MEMORY[0x1E69E9820];
          v14[1] = 3221225472;
          v14[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke_3;
          v14[3] = &unk_1E76F77B0;
          v15 = v8;
          v12[0] = MEMORY[0x1E69E9820];
          v12[1] = 3221225472;
          v12[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke_4;
          v12[3] = &unk_1E76F9A38;
          v12[4] = self;
          v13 = v15;
          v7 = v15;
          [v9 animateWithDuration:2 delay:v14 options:v12 animations:0.25 completion:0.0];
        }

        else
        {
          [(CAMViewfinderViewController *)self _embedDisabledModeOverlayView:0];
          [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:0];
        }
      }

      else
      {
        v10 = [CAMDisabledModeOverlayView alloc];
        v7 = [(CAMDisabledModeOverlayView *)v10 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
        [(CAMViewfinderViewController *)self _setDisabledModeOverlayView:v7];
        [(CAMViewfinderViewController *)self _embedDisabledModeOverlayView:v7];
        [(CAMViewfinderViewController *)self _updateDisabledModeOverlayViewForCurrentState];
        if (animatedCopy)
        {
          [(CAMDisabledModeOverlayView *)v7 setAlpha:0.0];
          v11 = MEMORY[0x1E69DD250];
          v16[0] = MEMORY[0x1E69E9820];
          v16[1] = 3221225472;
          v16[2] = __61__CAMViewfinderViewController__updateDisabledModeUIAnimated___block_invoke;
          v16[3] = &unk_1E76F77B0;
          v7 = v7;
          v17 = v7;
          [v11 animateWithDuration:2 delay:v16 options:&__block_literal_global_1352 animations:0.1 completion:0.0];
        }
      }
    }

    else
    {
      [(CAMViewfinderViewController *)self _updateDisabledModeOverlayViewForCurrentState];
    }
  }
}

- (void)_updateModeDisabledForCurrentStateAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
  -[CAMViewfinderViewController _updateModeDisabledForGraphConfiguration:callActive:animated:](self, "_updateModeDisabledForGraphConfiguration:callActive:animated:", _currentGraphConfiguration, [_callStatusMonitor isCallActive], animatedCopy);
}

- (void)_updateModeDisabledForGraphConfiguration:(id)configuration callActive:(BOOL)active animated:(BOOL)animated
{
  animatedCopy = animated;
  activeCopy = active;
  v20 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  v9 = [(CAMViewfinderViewController *)self _disabledModeReasonsForGraphConfiguration:configurationCopy callActive:activeCopy];
  v10 = [v9 count];
  if ([(CAMViewfinderViewController *)self _isModeDisabled]!= (v10 != 0))
  {
    [(CAMViewfinderViewController *)self _setModeDisabled:v10 != 0];
    v11 = os_log_create("com.apple.camera", "Camera");
    v12 = os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT);
    if (v10)
    {
      if (v12)
      {
        mode = [configurationCopy mode];
        if (mode > 9)
        {
          v14 = 0;
        }

        else
        {
          v14 = off_1E76FA1E8[mode];
        }

        v15 = [(CAMViewfinderViewController *)self _debugStringForDisabledModeReasons:v9];
        v16 = 138543618;
        v17 = v14;
        v18 = 2114;
        v19 = v15;
        _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Disabling %{public}@ mode for reasons: %{public}@", &v16, 0x16u);
      }
    }

    else if (v12)
    {
      LOWORD(v16) = 0;
      _os_log_impl(&dword_1A3640000, v11, OS_LOG_TYPE_DEFAULT, "Re-enabling mode", &v16, 2u);
    }

    [(CAMViewfinderViewController *)self _updateEnabledControlsWithReason:@"ModeDisabled"];
    [(CAMViewfinderViewController *)self _updatePhysicalButtonCapturedEnabledResigningActiveOrDisappearing:0];
    [(CAMViewfinderViewController *)self _updateDisabledModeUIAnimated:animatedCopy];
  }
}

- (void)_updateDisabledModeOverlayViewForCurrentState
{
  _disabledModeOverlayView = [(CAMViewfinderViewController *)self _disabledModeOverlayView];
  if (_disabledModeOverlayView)
  {
    v8 = _disabledModeOverlayView;
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    _callStatusMonitor = [(CAMViewfinderViewController *)self _callStatusMonitor];
    v6 = -[CAMViewfinderViewController _disabledModeReasonsForGraphConfiguration:callActive:](self, "_disabledModeReasonsForGraphConfiguration:callActive:", _currentGraphConfiguration, [_callStatusMonitor isCallActive]);

    if ([v6 containsObject:&unk_1F16C75F8])
    {
      v7 = 1;
    }

    else
    {
      [v6 containsObject:&unk_1F16C7748];
      v7 = 0;
    }

    [v8 setDisabledModeReason:v7];

    _disabledModeOverlayView = v8;
  }
}

- (void)prepareDiscreteFeedback:(unint64_t)feedback
{
  _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController prepareDiscreteFeedback:feedback];
}

- (void)performDiscreteFeedback:(unint64_t)feedback
{
  _feedbackController = [(CAMViewfinderViewController *)self _feedbackController];
  [_feedbackController performDiscreteFeedback:feedback];
}

- (void)handleDoneButtonReleased
{
  presentationDelegate = [(CAMViewfinderViewController *)self presentationDelegate];
  [presentationDelegate viewfinderViewControllerRequestedDismissal:self];
}

- (BOOL)_trueVideoIsCapturing
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  trueVideoState = [_fullscreenViewfinder trueVideoState];

  return trueVideoState == 2;
}

- (BOOL)_trueVideoIsTransitioningToCapture
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  trueVideoState = [_fullscreenViewfinder trueVideoState];

  return trueVideoState == 1;
}

- (BOOL)_trueVideoIsTransitioningToCapturingOrCapturing
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  trueVideoState = [_fullscreenViewfinder trueVideoState];

  return (trueVideoState - 1) < 2;
}

- (BOOL)_trueVideoIsTransitioningFromCapture
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  trueVideoState = [_fullscreenViewfinder trueVideoState];

  return trueVideoState == 3;
}

- (BOOL)_trueVideoIsActive
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  trueVideoState = [_fullscreenViewfinder trueVideoState];

  return (trueVideoState - 1) < 3;
}

- (void)_trueVideoStopCapture
{
  if ([(CAMViewfinderViewController *)self _lockedTrueVideoRecording])
  {
    v3 = 1;
  }

  else
  {
    v4 = +[CAMCaptureCapabilities capabilities];
    isTrueVideoCaptureStillOnCancelEnabled = [v4 isTrueVideoCaptureStillOnCancelEnabled];

    v3 = isTrueVideoCaptureStillOnCancelEnabled ^ 1;
  }

  _captureController = [(CAMViewfinderViewController *)self _captureController];
  isCapturingVideo = [_captureController isCapturingVideo];

  if ((v3 & 1) == 0 && isCapturingVideo && (-[CAMViewfinderViewController _captureController](self, "_captureController"), v8 = objc_claimAutoreleasedReturnValue(), v9 = [v8 waitingForRecordingToStart], v8, v9))
  {
    v10 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v15 = 0;
      v11 = "True video aborted while waiting for recording to start, capture photo instead";
      v12 = &v15;
LABEL_12:
      _os_log_impl(&dword_1A3640000, v10, OS_LOG_TYPE_DEFAULT, v11, v12, 2u);
    }
  }

  else
  {
    if ((v3 | isCapturingVideo))
    {
      goto LABEL_14;
    }

    v10 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      LOWORD(v14) = 0;
      v11 = "True video aborted before video capture started, capture photo instead";
      v12 = &v14;
      goto LABEL_12;
    }
  }

  [(CAMViewfinderViewController *)self _captureStillImageWithCurrentSettings];
LABEL_14:
  if (isCapturingVideo)
  {
    [(CAMViewfinderViewController *)self _stopCapturingVideo];
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setTrueVideoState:3];

  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]];
}

- (void)_startTransitioningToTrueVideoCaptureFromSourceMode:(int64_t)mode sourceAspectRatio:(int64_t)ratio toDestinationMode:(int64_t)destinationMode
{
  v17 = *MEMORY[0x1E69E9840];
  v9 = os_log_create("com.apple.camera", "Capture");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    if (mode > 9)
    {
      v10 = 0;
    }

    else
    {
      v10 = off_1E76FA1E8[mode];
    }

    if (destinationMode > 9)
    {
      v11 = 0;
    }

    else
    {
      v11 = off_1E76FA1E8[destinationMode];
    }

    v13 = 138543618;
    v14 = v10;
    v15 = 2114;
    v16 = v11;
    _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "True Video starting transition to capture. Source: %{public}@ destination: %{public}@", &v13, 0x16u);
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [(CAMViewfinderViewController *)self _setLockedTrueVideoRecording:0];
  [(CAMViewfinderViewController *)self _setTrueVideoSourceCaptureMode:mode];
  [(CAMViewfinderViewController *)self _setTrueVideoDestinationCaptureMode:destinationMode];
  [_fullscreenViewfinder setUseSlowerTrueVideoTransitionAnimationDuration:ratio == 3];
  [_fullscreenViewfinder setTrueVideoState:1];
  [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  [(CAMViewfinderViewController *)self _cancelCTMCapture];
  [(CAMViewfinderViewController *)self handleUserChangedToMode:destinationMode];
}

- (void)_trueVideoStartCapture
{
  v15 = *MEMORY[0x1E69E9840];
  _videoCaptureRequestWithCurrentSettings = [(CAMViewfinderViewController *)self _videoCaptureRequestWithCurrentSettings];
  if ([(CAMViewfinderViewController *)self _startCapturingVideoWithRequest:_videoCaptureRequestWithCurrentSettings])
  {
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder setTrueVideoState:2];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
  }

  else
  {
    v5 = os_log_create("com.apple.camera", "Capture");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      _trueVideoSourceCaptureMode = [(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode];
      if (_trueVideoSourceCaptureMode > 9)
      {
        v7 = 0;
      }

      else
      {
        v7 = off_1E76FA1E8[_trueVideoSourceCaptureMode];
      }

      _trueVideoDestinationCaptureMode = [(CAMViewfinderViewController *)self _trueVideoDestinationCaptureMode];
      if (_trueVideoDestinationCaptureMode > 9)
      {
        v9 = 0;
      }

      else
      {
        v9 = off_1E76FA1E8[_trueVideoDestinationCaptureMode];
      }

      v11 = 138543618;
      v12 = v7;
      v13 = 2114;
      v14 = v9;
      _os_log_impl(&dword_1A3640000, v5, OS_LOG_TYPE_DEFAULT, "True Video failed to start capture. Source: %{public}@ destination: %{public}@", &v11, 0x16u);
    }

    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder2 setTrueVideoState:3];

    [(CAMViewfinderViewController *)self _updateChromeViewControllerVideoRecordingState];
    [(CAMViewfinderViewController *)self handleUserChangedToMode:[(CAMViewfinderViewController *)self _trueVideoSourceCaptureMode]];
  }
}

- (BOOL)_useZoomFactorsOfTrueVideoDestinationModeForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = [configurationCopy trueVideoEnabled] && objc_msgSend(configurationCopy, "mode") == 1 && objc_msgSend(configurationCopy, "devicePosition") == 1;

  return v4;
}

- (BOOL)_updateDuetSystemConstraintsIfNecessary
{
  v11[1] = *MEMORY[0x1E69E9840];
  v2 = +[CAMUserPreferences preferences];
  if ([v2 isProResControlEnabled])
  {
    v3 = +[CAMCaptureCapabilities capabilities];
    if (![v3 hostProcess])
    {

LABEL_8:
      mEMORY[0x1E699A4C0] = [MEMORY[0x1E699A4C0] sharedInstance];
      v10 = *MEMORY[0x1E699A608];
      v11[0] = &unk_1F16C7910;
      v6 = 1;
      v8 = [MEMORY[0x1E695DF20] dictionaryWithObjects:v11 forKeys:&v10 count:1];
      [mEMORY[0x1E699A4C0] updateSystemConstraintsWithParameters:v8];

      return v6;
    }

    v4 = +[CAMCaptureCapabilities capabilities];
    hostProcess = [v4 hostProcess];

    if (hostProcess == 4)
    {
      goto LABEL_8;
    }
  }

  else
  {
  }

  return 0;
}

- (void)externalStorageMonitor:(id)monitor didChangeConnectedStorageDevices:(id)devices
{
  v27 = *MEMORY[0x1E69E9840];
  devicesCopy = devices;
  _connectedStorage = [(CAMViewfinderViewController *)self _connectedStorage];
  v7 = [devicesCopy count];
  if (v7)
  {
    if (([devicesCopy containsObject:_connectedStorage] & 1) == 0)
    {
      firstObject = [devicesCopy firstObject];
      [(CAMViewfinderViewController *)self _setConnectedStorage:firstObject];
    }

    if ([(CAMViewfinderViewController *)self _wantsExternalStorageOutputEnabled])
    {
      if ([(CAMViewfinderViewController *)self _isShowingCameraRoll])
      {
        v9 = os_log_create("com.apple.camera", "ExternalStorage");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *v20 = 0;
          v10 = "External storage: device connected when Camera Roll is visible, deferring SSD enablement";
LABEL_13:
          _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, v10, v20, 2u);
          goto LABEL_14;
        }

        goto LABEL_14;
      }

      _captureController = [(CAMViewfinderViewController *)self _captureController];
      isCapturingVideo = [_captureController isCapturingVideo];

      if (isCapturingVideo)
      {
        v9 = os_log_create("com.apple.camera", "ExternalStorage");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          *v20 = 0;
          v10 = "External storage: device connected during recording for internal storage, deferring SSD enablement";
          goto LABEL_13;
        }

LABEL_14:

        goto LABEL_15;
      }

      if ([(CAMViewfinderViewController *)self _externalStorageOutputEnabled])
      {
        [(CAMViewfinderViewController *)self _updateExternalStorageDataSources];
      }

      else
      {
        [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:1 animated:1];
      }
    }
  }

  else if (_connectedStorage)
  {
    [(CAMViewfinderViewController *)self _setExternalStorageOutputEnabled:0 animated:1];
    [(CAMViewfinderViewController *)self _setConnectedStorage:0];
  }

LABEL_15:
  if ((_connectedStorage != 0) != (v7 != 0))
  {
    [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
  }

  if ([(CAMViewfinderViewController *)self _shouldShowUnsupportedExternalStorageFormat])
  {
    [(CAMViewfinderViewController *)self _showUnsupportedFormatAlert];
  }

  v13 = os_log_create("com.apple.camera", "ExternalStorage");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    v14 = [_connectedStorage description];
    uniqueIdentifier = [_connectedStorage uniqueIdentifier];
    _connectedStorage2 = [(CAMViewfinderViewController *)self _connectedStorage];
    v17 = [_connectedStorage2 description];
    _connectedStorage3 = [(CAMViewfinderViewController *)self _connectedStorage];
    uniqueIdentifier2 = [_connectedStorage3 uniqueIdentifier];
    *v20 = 138544130;
    *&v20[4] = v14;
    v21 = 2114;
    v22 = uniqueIdentifier;
    v23 = 2114;
    v24 = v17;
    v25 = 2114;
    v26 = uniqueIdentifier2;
    _os_log_impl(&dword_1A3640000, v13, OS_LOG_TYPE_DEFAULT, "External storage: available storage devices changed. Connected device (%{public}@/%{public}@) updated to  (%{public}@/%{public}@).", v20, 0x2Au);
  }
}

- (void)_updateExternalStorageMonitoringState:(unint64_t)state
{
  _storageMonitor = [(CAMViewfinderViewController *)self _storageMonitor];

  if (_storageMonitor)
  {
    v6 = +[CAMUserPreferences preferences];
    isProResControlEnabled = [v6 isProResControlEnabled];

    if (isProResControlEnabled)
    {
      _storageMonitor2 = [(CAMViewfinderViewController *)self _storageMonitor];
      [_storageMonitor2 setMonitoringState:state];
    }
  }
}

- (void)captureController:(id)controller didChangeCameraSystemPressureState:(id)state
{
  [(CAMViewfinderViewController *)self _updateModeDisabledForCurrentStateAnimated:1, state];

  [(CAMViewfinderViewController *)self _updateShutterEffectsEnablementForSystemPressureState];
}

- (BOOL)captureControllerShouldPlayAudioCue:(id)cue
{
  _currentHeadphonesCaptureEvent = [(CAMViewfinderViewController *)self _currentHeadphonesCaptureEvent];

  if (!_currentHeadphonesCaptureEvent)
  {
    return 1;
  }

  [(CAMViewfinderViewController *)self _playCaptureSoundUsingCurrentHeadphonesCaptureEventIfAvailable];
  v5 = +[CAMCaptureCapabilities capabilities];
  isRegionalShutterSoundEnabled = [v5 isRegionalShutterSoundEnabled];

  return isRegionalShutterSoundEnabled;
}

- (BOOL)isInCameraRollView
{
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  isCameraRollViewControllerPresented = [_cameraRollController isCameraRollViewControllerPresented];

  return isCameraRollViewControllerPresented;
}

- (BOOL)navigateToViewfinderView
{
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  if ([_cameraRollController isCameraRollViewControllerPresented])
  {
    v3 = [_cameraRollController dismissCameraRollViewControllerForced:0 animated:1];
  }

  else
  {
    v3 = 1;
  }

  return v3;
}

- (void)setSingleUseTimerWithDuration:(int64_t)duration
{
  [(CAMViewfinderViewController *)self _setResetTimerDurationAfterDelayedCapture:1];

  [(CAMViewfinderViewController *)self _setTimerDurationAndUpdateUI:duration animated:1];
}

- (void)_requestPasscodeUnlockForCameraRollController:(id)controller forAction:(unint64_t)action completionBlock:(id)block
{
  controllerCopy = controller;
  blockCopy = block;
  unlockDelegate = [(CAMViewfinderViewController *)self unlockDelegate];

  if (unlockDelegate)
  {
    blockCopy[2](blockCopy, 0);
    unlockDelegate2 = [(CAMViewfinderViewController *)self unlockDelegate];
    [unlockDelegate2 viewfinderViewController:self didRequestUnlockForCameraRollController:controllerCopy withCameraRollActionType:action completionHandler:&__block_literal_global_1362];
  }

  else
  {
    v12 = blockCopy;
    SBSRequestPasscodeUnlockUI();
  }
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1();
    }
  }
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_1363(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_requestPasscodeUnlockForDocumentScanningWithCompletionBlock:(id)block
{
  blockCopy = block;
  unlockDelegate = [(CAMViewfinderViewController *)self unlockDelegate];

  if (unlockDelegate)
  {
    blockCopy[2](blockCopy, 0);
    unlockDelegate2 = [(CAMViewfinderViewController *)self unlockDelegate];
    [unlockDelegate2 viewfinderViewControllerDidRequestUnlockForDocumentScanning:self completionHandler:&__block_literal_global_1366];
  }

  else
  {
    v7 = blockCopy;
    SBSRequestPasscodeUnlockUI();
  }
}

void __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (v2)
  {
    v3 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_ERROR))
    {
      __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1();
    }
  }
}

void __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke_1367(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __92__CAMViewfinderViewController__requestPasscodeUnlockForDocumentScanningWithCompletionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_requestPasscodeUnlockWithCompletionBlock:(id)block
{
  blockCopy = block;
  v3 = blockCopy;
  SBSRequestPasscodeUnlockUI();
}

void __73__CAMViewfinderViewController__requestPasscodeUnlockWithCompletionBlock___block_invoke(uint64_t a1, char a2)
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __73__CAMViewfinderViewController__requestPasscodeUnlockWithCompletionBlock___block_invoke_2;
  v3[3] = &unk_1E76F9CE8;
  v4 = *(a1 + 32);
  v5 = a2;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

- (void)_preparePhotoOutputForExpectedPhotoResolution
{
  _currentMaxPhotoResolution = [(CAMViewfinderViewController *)self _currentMaxPhotoResolution];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController preparePhotoOutputForExpectedPhotoResolution:_currentMaxPhotoResolution];
}

- (void)_updatePanoramaViewForCurrentState
{
  _currentDevicePosition = [(CAMViewfinderViewController *)self _currentDevicePosition];
  _panoramaViewController = [(CAMViewfinderViewController *)self _panoramaViewController];
  [_panoramaViewController setDevicePosition:_currentDevicePosition];
}

- (void)_updateChromeViewfinderGeometryWithViewportFrame:(CGRect)frame
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __80__CAMViewfinderViewController__updateChromeViewfinderGeometryWithViewportFrame___block_invoke;
  v11[3] = &unk_1E76F8428;
  v11[4] = self;
  v12 = _fullscreenViewfinder;
  v13 = x;
  v14 = y;
  v15 = width;
  v16 = height;
  v10 = _fullscreenViewfinder;
  [chromeConfigurator performChanges:v11];
}

void __80__CAMViewfinderViewController__updateChromeViewfinderGeometryWithViewportFrame___block_invoke(uint64_t a1)
{
  [*(a1 + 40) previewAspectRatio];
  v3 = v2;
  v4 = [*(a1 + 32) chromeConfigurator];
  [v4 setViewfinderAspectRatio:v3];

  v5 = *(a1 + 48);
  v6 = *(a1 + 56);
  v7 = *(a1 + 64);
  v8 = *(a1 + 72);
  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setCurrentViewportFrame:{v5, v6, v7, v8}];

  [*(a1 + 40) currentFourThreeViewportFrame];
  v11 = v10;
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v18 = [*(a1 + 32) chromeConfigurator];
  [v18 setCurrentFourThreeViewportFrame:{v11, v13, v15, v17}];
}

- (void)_updateChromeViewControllerVideoRecordingState
{
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  if (([_captureController isCapturingVideo] & 1) != 0 || -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing"))
  {
    if ([_captureController videoCapturePaused])
    {
      v3 = 2;
    }

    else
    {
      v3 = 1;
    }
  }

  else
  {
    v3 = -[CAMViewfinderViewController _isCapturingTimelapse](self, "_isCapturingTimelapse") || [_captureController isCapturingPanorama];
  }

  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setVideoRecordingState:v3];
}

- (void)handleChromeControlPanelIsExpanded:(BOOL)expanded
{
  expandedCopy = expanded;
  [(CAMViewfinderViewController *)self setChromeControlPanelIsExpanded:?];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __66__CAMViewfinderViewController_handleChromeControlPanelIsExpanded___block_invoke;
  v10[3] = &unk_1E76F7850;
  v10[4] = self;
  v11 = expandedCopy;
  [CAMView animateIfNeededWithDuration:v10 animations:0.25];
  viewfinderView = [(CAMViewfinderViewController *)self viewfinderView];
  v6 = viewfinderView;
  if (expandedCopy)
  {
    if (viewfinderView)
    {
      [viewfinderView dismissMachineReadableCodeButtonAnimated:0];
    }

    else
    {
      _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder dismissMachineReadableCodeButtonAnimated:0];
    }

    [(CAMViewfinderViewController *)self _dismissOverlays];
  }

  else
  {
    _prominentObjectManager = [(CAMViewfinderViewController *)self _prominentObjectManager];
    currentMachineReadableCodeAction = [_prominentObjectManager currentMachineReadableCodeAction];
    [(CAMViewfinderViewController *)self _updateMachineReadableCodeButtonFromAction:currentMachineReadableCodeAction];
  }

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
}

void __66__CAMViewfinderViewController_handleChromeControlPanelIsExpanded___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v3 = [*(a1 + 32) _previewViewController];
  v2 = [v3 previewView];
  [v2 setHideAllIndicators:v1];
}

- (void)handleChromeTopBarMenuState:(int64_t)state
{
  [(CAMViewfinderViewController *)self setChromeTopBarMenuState:state];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:0];
}

- (void)handleChromeTopInset:(double)inset
{
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setExternalChromeTopInset:1 animated:inset];
}

- (void)handleUserChangedFiltersUIVisible:(BOOL)visible
{
  visibleCopy = visible;
  [(CAMViewfinderViewController *)self _setWantsFilterScrubberVisible:visible animated:1];
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setExternalChromeFilterScrubberVisible:visibleCopy];

  [(CAMViewfinderViewController *)self updateControlVisibilityAnimated:1];
}

- (void)handleUserChangedSemanticStylesUIVisible:(BOOL)visible
{
  visibleCopy = visible;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setExternalChromeSemanticStyleControlsVisible:visibleCopy];
}

- (void)handleUserChangedSemanticStylePreset:(int64_t)preset sceneBias:(double)bias warmthBias:(double)warmthBias
{
  v6 = [[CAMSemanticStyle alloc] initWithPresetType:preset sceneBias:bias warmthBias:warmthBias];
  [(CAMViewfinderViewController *)self _handleUserChangedSemanticStyle:v6];
}

- (void)handleUserChangedSmartStylesUIVisible:(BOOL)visible
{
  visibleCopy = visible;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setExternalChromeSmartStyleControlsVisible:visibleCopy];
}

- (void)setDockKitController:(id)controller
{
  objc_storeStrong(&self->__dockKitController, controller);
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  [_dockKitController setDelegate:self];
}

- (void)accessoryPanoramaMotionCompleted
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __63__CAMViewfinderViewController_accessoryPanoramaMotionCompleted__block_invoke;
  block[3] = &unk_1E76F77B0;
  block[4] = self;
  dispatch_async(MEMORY[0x1E69E96A0], block);
}

void __63__CAMViewfinderViewController_accessoryPanoramaMotionCompleted__block_invoke(uint64_t a1)
{
  if ([*(a1 + 32) isRecording])
  {
    v2 = [*(a1 + 32) _dynamicShutterControl];

    v3 = *(a1 + 32);
    if (v2)
    {
      v4 = [*(a1 + 32) _dynamicShutterControl];
      [v4 externalButtonPressedWithBehavior:1];

      v7 = [*(a1 + 32) _dynamicShutterControl];
      [v7 externalButtonReleased];
    }

    else
    {
      v5 = [*(a1 + 32) _shutterButton];
      [v3 _handleShutterButtonPressed:v5];

      v6 = *(a1 + 32);
      v7 = [v6 _shutterButton];
      [v6 _handleShutterButtonReleased:?];
    }
  }
}

- (void)accessoryZoomInByDisplayZoomValue:(double)value
{
  _zoomControl = [(CAMViewfinderViewController *)self _zoomControl];
  [_zoomControl displayZoomValue];
  v7 = v6 + value;

  _zoomControl2 = [(CAMViewfinderViewController *)self _zoomControl];
  [_zoomControl2 zoomFactorForDisplayZoomValue:v7];
  v10 = v9;

  [(CAMViewfinderViewController *)self _remoteShutterSetZoomFactor:v10];
}

- (void)accessoryConnectedAndTracking:(BOOL)tracking
{
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __61__CAMViewfinderViewController_accessoryConnectedAndTracking___block_invoke;
  v3[3] = &unk_1E76F7850;
  v3[4] = self;
  trackingCopy = tracking;
  dispatch_async(MEMORY[0x1E69E96A0], v3);
}

void __61__CAMViewfinderViewController_accessoryConnectedAndTracking___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _previewViewController];
  [v2 accessoryConnectedAndTracking:*(a1 + 40)];
}

- (void)tapToFocusTriggeredAtPoint:(CGPoint)point
{
  y = point.y;
  x = point.x;
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  [_dockKitController tapToTrackTriggeredAtPoint:-[CAMViewfinderViewController _currentDevicePosition](self devicePosition:{"_currentDevicePosition"), x, y}];
}

- (BOOL)isDockAccessoryConnectedAndTracking
{
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  shouldShowTrackingSummaryViews = [_dockKitController shouldShowTrackingSummaryViews];

  return shouldShowTrackingSummaryViews;
}

- (id)matchingDockKitTrackedSubjectForAnstID:(int64_t)d
{
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  v5 = [_dockKitController matchingTrackedSubjectForAnstID:d];

  return v5;
}

- (BOOL)isDockKitTrackingLocked
{
  _dockKitController = [(CAMViewfinderViewController *)self _dockKitController];
  isTrackingLocked = [_dockKitController isTrackingLocked];

  return isTrackingLocked;
}

- (void)captureController:(id)controller didOutputRecommendedSmartFramingFieldOfView:(int64_t)view
{
  v35 = *MEMORY[0x1E69E9840];
  v6 = os_log_create("com.apple.camera", "SmartFraming");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    v25 = 134217984;
    *v26 = view;
    _os_log_impl(&dword_1A3640000, v6, OS_LOG_TYPE_DEFAULT, "Received new smart framing recommendation: %ld", &v25, 0xCu);
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  isReticleAnimating = [_fullscreenViewfinder isReticleAnimating];

  if (isReticleAnimating)
  {
    v9 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      LOWORD(v25) = 0;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: reticle is animating", &v25, 2u);
    }
  }

  else
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9 = [(CAMViewfinderViewController *)self _autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:_currentGraphConfiguration];

    v11 = [MEMORY[0x1E696AD98] numberWithInteger:view];
    v12 = [v9 containsObject:v11];

    _currentStillImageCaptureMomentSettings = [(CAMViewfinderViewController *)self _currentStillImageCaptureMomentSettings];

    _trueVideoIsActive = [(CAMViewfinderViewController *)self _trueVideoIsActive];
    isRecording = [(CAMViewfinderViewController *)self isRecording];
    v16 = isRecording;
    if (!view || !v12 || _currentStillImageCaptureMomentSettings || _trueVideoIsActive || isRecording)
    {
      v18 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        v25 = 67110400;
        *v26 = v12;
        *&v26[4] = 1024;
        *&v26[6] = view == 0;
        v27 = 1024;
        v28 = _currentStillImageCaptureMomentSettings != 0;
        v29 = 1024;
        v30 = _trueVideoIsActive;
        v31 = 1024;
        v32 = v16;
        v33 = 2048;
        viewCopy = view;
        _os_log_impl(&dword_1A3640000, v18, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: isSupported: %d, isNoneRecommended: %d, hasCurrentStillImageCaptureMomentSettings %d, isTrueVideoActive %d, isRecording: %d, suggested FOV: %ld", &v25, 0x2Au);
      }
    }

    else if ([(CAMViewfinderViewController *)self _desiredFieldOfView]== view)
    {
      v17 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        LOWORD(v25) = 0;
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Ignoring auto smart framing recommendation: already equal to desired FOV", &v25, 2u);
      }
    }

    else
    {
      _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      mode = [_currentGraphConfiguration2 mode];
      _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      v22 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", mode, [_currentGraphConfiguration3 devicePosition]);

      [(CAMViewfinderViewController *)self set_desiredFieldOfView:view];
      _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
      [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration4 rampDuration:1 zoomRampTuning:1 animated:0.5];

      v24 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        v25 = 134217984;
        *v26 = view;
        _os_log_impl(&dword_1A3640000, v24, OS_LOG_TYPE_DEFAULT, "Using auto smart framing recommendation, updating to: %ld", &v25, 0xCu);
      }

      [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:1];
      [(CAMViewfinderViewController *)self _setLastZoomInteractionType:0];
      [(CAMViewfinderViewController *)self _showSmartFramingAutoBadgeForSmartFramingFieldOfView:view previousSmartFramingFieldOfView:v22];
    }
  }
}

- (void)_showSmartFramingAutoBadgeForSmartFramingFieldOfView:(int64_t)view previousSmartFramingFieldOfView:(int64_t)ofView
{
  if (view && ofView && (((view & 0xFFFFFFFFFFFFFFFELL) == 2) != ((ofView & 0xFFFFFFFFFFFFFFFELL) == 2) || (view - 3) < 2 != (ofView - 3) < 2))
  {
    v9 = v4;
    v10 = v5;
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __116__CAMViewfinderViewController__showSmartFramingAutoBadgeForSmartFramingFieldOfView_previousSmartFramingFieldOfView___block_invoke;
    v6[3] = &__block_descriptor_34_e22_v16__0__CAMTextBadge_8l;
    v7 = ((view & 0xFFFFFFFFFFFFFFFELL) == 2) ^ ((ofView & 0xFFFFFFFFFFFFFFFELL) == 2);
    v8 = ((view - 3) < 2) ^ ((ofView - 3) < 2);
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (BOOL)_resolvedSmartFramingAutoZoomEnabled
{
  v3 = +[CAMCaptureCapabilities capabilities];
  isAutoSmartFramingSupported = [v3 isAutoSmartFramingSupported];

  v5 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v5 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration2, "devicePosition")}];

  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v11 = [_motionController captureOrientation] - 3;

  if (v11 > 1)
  {
    LOBYTE(v12) = 1;
  }

  else
  {
    v12 = ![(CAMViewfinderViewController *)self _overrideSmartFramingAutoZoomInLandscapeEnabled];
  }

  if ((isAutoSmartFramingSupported & v9) == 1)
  {
    _wantsSmartFramingAutoZoomDefault = [(CAMViewfinderViewController *)self _wantsSmartFramingAutoZoomDefault];
    if (_wantsSmartFramingAutoZoomDefault)
    {
      LOBYTE(_wantsSmartFramingAutoZoomDefault) = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]& v12;
    }
  }

  else
  {
    LOBYTE(_wantsSmartFramingAutoZoomDefault) = 0;
  }

  return _wantsSmartFramingAutoZoomDefault;
}

- (BOOL)_resolvedSmartFramingAutoRotationEnabled
{
  v3 = +[CAMCaptureCapabilities capabilities];
  isAutoSmartFramingSupported = [v3 isAutoSmartFramingSupported];

  v5 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = [v5 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration2, "devicePosition")}];

  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v11 = [_motionController captureOrientation] - 3;

  if (v11 > 1)
  {
    LOBYTE(v12) = 1;
  }

  else
  {
    v12 = ![(CAMViewfinderViewController *)self _overrideSmartFramingAutoRotateInLandscapeEnabled];
  }

  if ((isAutoSmartFramingSupported & v9) == 1)
  {
    _wantsSmartFramingAutoRotationDefault = [(CAMViewfinderViewController *)self _wantsSmartFramingAutoRotationDefault];
    if (_wantsSmartFramingAutoRotationDefault)
    {
      LOBYTE(_wantsSmartFramingAutoRotationDefault) = [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled]& v12;
    }
  }

  else
  {
    LOBYTE(_wantsSmartFramingAutoRotationDefault) = 0;
  }

  return _wantsSmartFramingAutoRotationDefault;
}

- (void)_setOverrideSmartFramingAutoZoomInLandscapeEnabled:(BOOL)enabled
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__overrideSmartFramingAutoZoomInLandscapeEnabled != enabled)
  {
    enabledCopy = enabled;
    self->__overrideSmartFramingAutoZoomInLandscapeEnabled = enabled;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setOverrideSmartFramingAutoZoomInLandscapeEnabled:enabledCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = enabledCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating overrideSmartFramingAutoZoomInLandscapeEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_setOverrideSmartFramingAutoRotateInLandscapeEnabled:(BOOL)enabled
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__overrideSmartFramingAutoRotateInLandscapeEnabled != enabled)
  {
    enabledCopy = enabled;
    self->__overrideSmartFramingAutoRotateInLandscapeEnabled = enabled;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setOverrideSmartFramingAutoRotateInLandscapeEnabled:enabledCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = enabledCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating overrideSmartFramingAutoRotateInLandscapeEnabled to: %d", v8, 8u);
    }
  }
}

- (int64_t)_resolvedSmartFramingFieldOfViewForMode:(int64_t)mode devicePosition:(int64_t)position
{
  v7 = +[CAMCaptureCapabilities capabilities];
  LODWORD(position) = [v7 isSmartFramingSupportedForMode:mode devicePosition:position];

  if (!position)
  {
    return 0;
  }

  result = [(CAMViewfinderViewController *)self _desiredFieldOfView];
  if (!result)
  {
    v9 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      [CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:];
    }

    return 1;
  }

  return result;
}

- (void)_updateSmartFramingMonitorForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v13 = [(CAMViewfinderViewController *)self _autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:configurationCopy];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [_captureController setAutoSmartFramingEnabledFieldOfViews:v13];

  v6 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LODWORD(configurationCopy) = [v6 isSmartFramingSupportedForMode:mode devicePosition:devicePosition];
  v9 = +[CAMCaptureCapabilities capabilities];
  LODWORD(mode) = [v9 isAutoSmartFramingSupported];

  LODWORD(v9) = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
  v10 = mode & (v9 | [(CAMViewfinderViewController *)self _smartFramingAutoRotationMonitoringEnabled]);
  if (configurationCopy)
  {
    v11 = v10;
  }

  else
  {
    v11 = 0;
  }

  _captureController2 = [(CAMViewfinderViewController *)self _captureController];
  [_captureController2 setSmartFramingMonitorEnabled:v11];
}

- (id)_autoSmartFramingSupportedSmartFramingFieldOfViewsForGraphConfiguration:(id)configuration
{
  v24 = *MEMORY[0x1E69E9840];
  configurationCopy = configuration;
  v5 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  v8 = [v5 isSmartFramingSupportedForMode:mode devicePosition:devicePosition];
  v9 = +[CAMCaptureCapabilities capabilities];
  isAutoSmartFramingSupported = [v9 isAutoSmartFramingSupported];

  _smartFramingAutoRotationEnabled = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]|| [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled];
  if ((v8 & isAutoSmartFramingSupported) == 1 && _smartFramingAutoRotationEnabled)
  {
    v12 = objc_alloc_init(MEMORY[0x1E695DF70]);
    _resolvedSmartFramingAutoZoomEnabled = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
    _smartFramingAutoRotationMonitoringEnabled = [(CAMViewfinderViewController *)self _smartFramingAutoRotationMonitoringEnabled];
    if (_resolvedSmartFramingAutoZoomEnabled && _smartFramingAutoRotationMonitoringEnabled)
    {
      [v12 addObject:&unk_1F16C75F8];
      v15 = &unk_1F16C7628;
      v16 = &unk_1F16C7610;
    }

    else
    {
      if (_resolvedSmartFramingAutoZoomEnabled)
      {
        v15 = &unk_1F16C7610;
      }

      else
      {
        v15 = &unk_1F16C7628;
      }

      if (!_resolvedSmartFramingAutoZoomEnabled && !_smartFramingAutoRotationMonitoringEnabled)
      {
        goto LABEL_20;
      }

      v16 = &unk_1F16C75F8;
    }

    [v12 addObject:v16];
    [v12 addObject:v15];
  }

  else
  {
    if (v8)
    {
      v17 = os_log_create("com.apple.camera", "SmartFraming");
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        v19[0] = 67109632;
        v19[1] = isAutoSmartFramingSupported;
        v20 = 1024;
        _smartFramingAutoZoomEnabled = [(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled];
        v22 = 1024;
        _smartFramingAutoRotationEnabled2 = [(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled];
        _os_log_impl(&dword_1A3640000, v17, OS_LOG_TYPE_DEFAULT, "Smart framing supported but has no enabled auto framings - isAutoFramingSupported: %d, smartFramingAutoZoomEnabled: %d, smartFramingAutoRotationEnabled: %d", v19, 0x14u);
      }
    }

    v12 = MEMORY[0x1E695E0F0];
  }

LABEL_20:

  return v12;
}

- (BOOL)_smartFramingAutoRotationMonitoringEnabled
{
  _resolvedSmartFramingAutoRotationEnabled = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled];
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  v5 = [_motionController captureOrientation] - 5;

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v9 = -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", mode, [_currentGraphConfiguration2 devicePosition]);

  v10 = [(CAMViewfinderViewController *)self _smartFramingSupportsAspectRatioCrop:v9];
  v11 = v5 < 0xFFFFFFFFFFFFFFFELL && _resolvedSmartFramingAutoRotationEnabled;
  return v11 && v10;
}

- (void)_updateSmartFramingFieldOfViewForGraphConfiguration:(id)configuration rampDuration:(double)duration zoomRampTuning:(int64_t)tuning animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  v11 = +[CAMCaptureCapabilities capabilities];
  v12 = [v11 isSmartFramingSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];

  v13 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition"));
  if ((v12 & 1) == 0)
  {
    v17 = +[CAMCaptureCapabilities capabilities];
    isSmartFramingSupported = [v17 isSmartFramingSupported];

    if (!isSmartFramingSupported)
    {
      goto LABEL_23;
    }

    goto LABEL_7;
  }

  v14 = v13;
  if (!-[CAMViewfinderViewController _smartFramingSupportsAspectRatioCrop:](self, "_smartFramingSupportsAspectRatioCrop:", -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition"))))
  {
    [_fullscreenViewfinder setSmartFramingFieldOfView:0 useTransition:0 animated:animatedCopy];
    v19 = +[CAMCaptureCapabilities capabilities];
    [v19 zoomFactorForSmartFramingFieldOfView:v14];
    v21 = v20;

    [(CAMViewfinderViewController *)self _changeToZoomFactor:tuning rampDuration:animatedCopy zoomRampTuning:v21 shouldAnimate:duration];
    goto LABEL_23;
  }

  if (!v14)
  {
LABEL_7:
    [_fullscreenViewfinder setSmartFramingFieldOfView:0 useTransition:0 animated:animatedCopy];
    goto LABEL_23;
  }

  v15 = -[CAMViewfinderViewController _aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:](self, "_aspectRatioForMode:videoConfiguration:devicePosition:trueVideoEnabled:", [configurationCopy mode], objc_msgSend(configurationCopy, "videoConfiguration"), objc_msgSend(configurationCopy, "devicePosition"), objc_msgSend(configurationCopy, "trueVideoEnabled"));
  smartFramingFieldOfView = [_fullscreenViewfinder smartFramingFieldOfView];
  if (smartFramingFieldOfView != v14)
  {
    if ((smartFramingFieldOfView - 3) < 2)
    {
      v22 = v14 >= 3;
    }

    else
    {
      if ((smartFramingFieldOfView - 1) > 1)
      {
        v23 = 0;
        goto LABEL_20;
      }

      v22 = v14 - 3 >= 2;
    }

    v23 = !v22;
    if (v23 && animatedCopy)
    {
      v23 = 1;
      [(CAMViewfinderViewController *)self set_delaySmartFramingDynamicAspectRatioUpdate:1];
LABEL_21:
      [_fullscreenViewfinder setViewportAspectRatio:v15 animated:animatedCopy];
      [_fullscreenViewfinder setSmartFramingFieldOfView:v14 useTransition:v23 animated:animatedCopy];
      goto LABEL_22;
    }

LABEL_20:
    [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:tuning zoomRampTuning:duration];
    goto LABEL_21;
  }

  [(CAMViewfinderViewController *)self _updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:tuning zoomRampTuning:duration];
LABEL_22:
  [(CAMViewfinderViewController *)self _configureZoomControlForGraphConfiguration:configurationCopy animated:animatedCopy];
  [(CAMViewfinderViewController *)self _updateFlipAspectRatioButtonForGraphConfiguration:configurationCopy animated:animatedCopy];
LABEL_23:
}

- (void)_resetSmartFramingFieldOfViewAnimated:(BOOL)animated
{
  animatedCopy = animated;
  _motionController = [(CAMViewfinderViewController *)self _motionController];
  -[CAMViewfinderViewController set_desiredFieldOfView:](self, "set_desiredFieldOfView:", -[CAMViewfinderViewController _defaultSmartFramingFieldOfViewForOrientation:](self, "_defaultSmartFramingFieldOfViewForOrientation:", [_motionController captureOrientation]));

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration animated:animatedCopy];
}

- (int64_t)_defaultSmartFramingFieldOfViewForOrientation:(int64_t)orientation
{
  if ((orientation - 3) >= 2)
  {
    return 1;
  }

  else
  {
    return 2;
  }
}

- (void)_updateSmartFramingDynamicAspectRatioAndZoomWithRampDuration:(double)duration zoomRampTuning:(int64_t)tuning
{
  v7 = +[CAMCaptureCapabilities capabilities];
  isSmartFramingUsingDynamicAspectRatioSupported = [v7 isSmartFramingUsingDynamicAspectRatioSupported];

  if (isSmartFramingUsingDynamicAspectRatioSupported)
  {
    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v9 = -[CAMViewfinderViewController _resolvedSmartFramingFieldOfViewForMode:devicePosition:](self, "_resolvedSmartFramingFieldOfViewForMode:devicePosition:", [_currentGraphConfiguration mode], objc_msgSend(_currentGraphConfiguration, "devicePosition"));
    if (v9)
    {
      v10 = v9;
      _captureController = [(CAMViewfinderViewController *)self _captureController];
      [_captureController changeToSmartFramingFieldOfView:v10 mode:objc_msgSend(_currentGraphConfiguration videoConfiguration:"mode") devicePosition:{objc_msgSend(_currentGraphConfiguration, "videoConfiguration"), objc_msgSend(_currentGraphConfiguration, "devicePosition")}];

      v12 = +[CAMCaptureCapabilities capabilities];
      [v12 zoomFactorForSmartFramingFieldOfView:v10];
      v14 = v13;

      [(CAMViewfinderViewController *)self _changeToZoomFactor:tuning rampDuration:0 zoomRampTuning:v14 shouldAnimate:duration];
    }
  }
}

- (void)handleUserChangedSmartFramingAutoZoomEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v5 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled]^ enabled;
  [(CAMViewfinderViewController *)self _setWantsSmartFramingAutoZoomDefault:enabledCopy];
  if (enabledCopy)
  {
    [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:1];
  }

  if (v5)
  {
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:0];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __76__CAMViewfinderViewController_handleUserChangedSmartFramingAutoZoomEnabled___block_invoke;
    v6[3] = &__block_descriptor_33_e22_v16__0__CAMTextBadge_8l;
    v7 = enabledCopy;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (void)handleUserChangedSmartFramingAutoRotationEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  v5 = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled]^ enabled;
  [(CAMViewfinderViewController *)self _setWantsSmartFramingAutoRotationDefault:enabledCopy];
  if (enabledCopy)
  {
    [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:1];
  }

  if (v5)
  {
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:0];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __80__CAMViewfinderViewController_handleUserChangedSmartFramingAutoRotationEnabled___block_invoke;
    v6[3] = &__block_descriptor_33_e22_v16__0__CAMTextBadge_8l;
    v7 = enabledCopy;
    [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:v6];
  }
}

- (void)_setWantsSmartFramingAutoZoomDefault:(BOOL)default
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__wantsSmartFramingAutoZoomDefault != default)
  {
    defaultCopy = default;
    self->__wantsSmartFramingAutoZoomDefault = default;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setWantsSmartFramingAutoZoomDefault:defaultCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = defaultCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating wantsSmartFramingAutoZoomDefault to: %d", v8, 8u);
    }
  }
}

- (void)_setWantsSmartFramingAutoRotationDefault:(BOOL)default
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__wantsSmartFramingAutoRotationDefault != default)
  {
    defaultCopy = default;
    self->__wantsSmartFramingAutoRotationDefault = default;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setWantsSmartFramingAutoRotationDefault:defaultCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = defaultCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating wantsSmartFramingAutoRotationDefault to: %d", v8, 8u);
    }
  }
}

- (void)_setSmartFramingAutoZoomEnabled:(BOOL)enabled
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__smartFramingAutoZoomEnabled != enabled)
  {
    enabledCopy = enabled;
    self->__smartFramingAutoZoomEnabled = enabled;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setSmartFramingAutoZoomEnabled:enabledCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = enabledCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating smartFramingAutoZoomEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_setSmartFramingAutoRotationEnabled:(BOOL)enabled
{
  v9 = *MEMORY[0x1E69E9840];
  if (self->__smartFramingAutoRotationEnabled != enabled)
  {
    enabledCopy = enabled;
    self->__smartFramingAutoRotationEnabled = enabled;
    chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
    [chromeConfigurator setSmartFramingAutoRotationEnabled:enabledCopy];

    _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration];

    v7 = os_log_create("com.apple.camera", "SmartFraming");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8[0] = 67109120;
      v8[1] = enabledCopy;
      _os_log_impl(&dword_1A3640000, v7, OS_LOG_TYPE_DEFAULT, "Updating smartFramingAutoRotationEnabled to: %d", v8, 8u);
    }
  }
}

- (void)_disableAutoSmartFramingIfSupported
{
  v3 = +[CAMCaptureCapabilities capabilities];
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  mode = [_currentGraphConfiguration mode];
  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LODWORD(mode) = [v3 isSmartFramingSupportedForMode:mode devicePosition:{objc_msgSend(_currentGraphConfiguration2, "devicePosition")}];

  if (mode)
  {
    _resolvedSmartFramingAutoZoomEnabled = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoZoomEnabled];
    _resolvedSmartFramingAutoRotationEnabled = [(CAMViewfinderViewController *)self _resolvedSmartFramingAutoRotationEnabled];
    if (_resolvedSmartFramingAutoZoomEnabled || _resolvedSmartFramingAutoRotationEnabled)
    {
      [(CAMViewfinderViewController *)self _showControlChangeBadgeWithUpdateHandler:&__block_literal_global_1372];
    }

    [(CAMViewfinderViewController *)self _setSmartFramingAutoZoomEnabled:0];
    [(CAMViewfinderViewController *)self _setSmartFramingAutoRotationEnabled:0];
    if ([(CAMViewfinderViewController *)self _smartFramingFieldOfViewSource]== 1)
    {

      [(CAMViewfinderViewController *)self set_smartFramingFieldOfViewSource:2];
    }
  }
}

- (BOOL)_shouldShowSmartFramingAutoZoomForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LOBYTE(configurationCopy) = [v4 isSmartFramingSupportedForMode:mode devicePosition:devicePosition];
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(mode) = [v7 isAutoSmartFramingSupported];

  return configurationCopy & mode;
}

- (BOOL)_shouldShowSmartFramingAutoRotationForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  mode = [configurationCopy mode];
  devicePosition = [configurationCopy devicePosition];

  LOBYTE(configurationCopy) = [v4 isSmartFramingSupportedForMode:mode devicePosition:devicePosition];
  v7 = +[CAMCaptureCapabilities capabilities];
  LOBYTE(mode) = [v7 isAutoSmartFramingSupported];

  return configurationCopy & mode;
}

- (void)_updateSmartFramingForCaptureOrientation:(int64_t)orientation rampDuration:(double)duration zoomRampTuning:(int64_t)tuning animated:(BOOL)animated
{
  animatedCopy = animated;
  if ((orientation - 3) < 2)
  {
    [(CAMViewfinderViewController *)self set_desiredFieldOfView:2];
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoRotateInLandscapeEnabled:1];
    [(CAMViewfinderViewController *)self _setOverrideSmartFramingAutoZoomInLandscapeEnabled:1];
  }

  else if ((orientation - 1) <= 1)
  {
    [(CAMViewfinderViewController *)self set_desiredFieldOfView:1];
  }

  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v11 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoZoomForGraphConfiguration:_currentGraphConfiguration];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setIsSmartFramingAutoZoomSupported:v11];

  _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  v14 = [(CAMViewfinderViewController *)self _shouldShowSmartFramingAutoRotationForGraphConfiguration:_currentGraphConfiguration2];
  chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator2 setIsSmartFramingAutoRotationSupported:v14];

  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingFieldOfViewForGraphConfiguration:_currentGraphConfiguration3 rampDuration:tuning zoomRampTuning:animatedCopy animated:duration];

  _currentGraphConfiguration4 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  [(CAMViewfinderViewController *)self _updateSmartFramingMonitorForGraphConfiguration:_currentGraphConfiguration4];
}

- (void)_updateSmartFramingOverCaptureGradientHeightForGraphConfiguration:(id)configuration animated:(BOOL)animated
{
  animatedCopy = animated;
  configurationCopy = configuration;
  v6 = +[CAMCaptureCapabilities capabilities];
  v7 = [v6 isSmartFramingSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];

  v8 = 0.0;
  if (v7)
  {
    v9 = -[CAMViewfinderViewController _aspectRatioCropForMode:devicePosition:](self, "_aspectRatioCropForMode:devicePosition:", [configurationCopy mode], objc_msgSend(configurationCopy, "devicePosition"));
    v10 = 60.0;
    if (v9 != 1)
    {
      v10 = 0.0;
    }

    if (v9)
    {
      v8 = v10;
    }

    else
    {
      v8 = 50.0;
    }
  }

  _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
  [_fullscreenViewfinder setOverCaptureGradientHeight:animatedCopy animated:v8];
}

- (void)handleReviewButtonReleased
{
  reviewButtonSource = [(CAMViewfinderViewController *)self reviewButtonSource];
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl resetAnimated:1];

  [reviewButtonSource handleReviewButtonReleased:0];
}

- (void)simulateShutterButtonPressForCaptureMenuItem
{
  _dynamicShutterControl = [(CAMViewfinderViewController *)self _dynamicShutterControl];
  [_dynamicShutterControl captureMenuItemTapped];
}

- (BOOL)shouldEnableFlashMenuCommand
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideFlashButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (BOOL)shouldEnableLivePhotoMenuCommand
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideLivePhotoButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (BOOL)shouldEnableTimerMenuCommand
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideTimerButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (BOOL)shouldEnableFlipCameraMenuCommand
{
  selfCopy = self;
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  LOBYTE(selfCopy) = [(CAMViewfinderViewController *)selfCopy _shouldHideFlipButtonForGraphConfiguration:_currentGraphConfiguration];

  return selfCopy ^ 1;
}

- (void)dismissCameraRoll
{
  _cameraRollController = [(CAMViewfinderViewController *)self _cameraRollController];
  [_cameraRollController dismissCameraRollViewControllerForced:0 animated:1];
}

+ (int64_t)_pressTypeForCaptureButton:(int64_t)button
{
  if ((button - 1) > 7)
  {
    return -1;
  }

  else
  {
    return qword_1A3A68608[button - 1];
  }
}

- (void)stopMonitoringForAccidentalLaunchIfNeeded
{
  v3 = +[CAMCaptureCapabilities capabilities];
  hostProcess = [v3 hostProcess];

  v5 = hostProcess & 0xFFFFFFFFFFFFFFFBLL;
  v6 = +[CAMCaptureCapabilities capabilities];
  shouldEnableUserNotifications = [v6 shouldEnableUserNotifications];

  if (v5)
  {
    v8 = 1;
  }

  else
  {
    v8 = shouldEnableUserNotifications == 0;
  }

  if (!v8)
  {
    v9 = os_log_create("com.apple.camera", "Camera");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *v11 = 0;
      _os_log_impl(&dword_1A3640000, v9, OS_LOG_TYPE_DEFAULT, "stopMonitoringForAccidentalLaunchIfNeeded: Interaction with Camera disable TTR", v11, 2u);
    }

    _captureController = [(CAMViewfinderViewController *)self _captureController];
    [_captureController stopMonitoringForAccidentalLaunch];
  }
}

- (void)_createChromeConfiguratorWithGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v7 = [[CAMCameraChromeEventHandler alloc] initWithViewfinderViewController:self];
  v5 = [[CAMChromeConfigurator alloc] initWithEventHandler:v7 captureGraphConfiguration:configurationCopy];
  [(CAMViewfinderViewController *)self setChromeConfigurator:v5];
  [(CAMViewfinderViewController *)self _updateChromeConfiguratorForCurrentGraphConfiguration:configurationCopy];

  [(CAMChromeConfigurator *)v5 setUseMessagesUI:[(CAMViewfinderViewController *)self _useMessagesControls]];
  v6 = +[CAMCaptureCapabilities capabilities];
  -[CAMChromeConfigurator setDeviceHasDynamicIsland:](v5, "setDeviceHasDynamicIsland:", [v6 hasDynamicIsland]);
  -[CAMChromeConfigurator setDeviceHasNotch:](v5, "setDeviceHasNotch:", [v6 hasNotch]);
  -[CAMChromeConfigurator setFrontCameraOnRightEdge:](v5, "setFrontCameraOnRightEdge:", [v6 isFrontCameraOnRightEdge]);
  [(CAMChromeConfigurator *)v5 setWantsSmartFramingAutoZoomDefault:[(CAMViewfinderViewController *)self _wantsSmartFramingAutoZoomDefault]];
  [(CAMChromeConfigurator *)v5 setWantsSmartFramingAutoRotationDefault:[(CAMViewfinderViewController *)self _wantsSmartFramingAutoRotationDefault]];
  [(CAMChromeConfigurator *)v5 setSmartFramingAutoZoomEnabled:[(CAMViewfinderViewController *)self _smartFramingAutoZoomEnabled]];
  [(CAMChromeConfigurator *)v5 setSmartFramingAutoRotationEnabled:[(CAMViewfinderViewController *)self _smartFramingAutoRotationEnabled]];
  [(CAMChromeConfigurator *)v5 setIsImagePickerController:[(CAMViewfinderViewController *)self emulationMode]!= 0];
}

- (void)_createChromeViewControllerIfNeeded
{
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];

  if (chromeConfigurator)
  {
    v4 = [CAMChromeViewController alloc];
    chromeConfigurator2 = [(CAMViewfinderViewController *)self chromeConfigurator];
    v6 = [(CAMChromeViewController *)v4 initWithConfigurator:chromeConfigurator2];

    [(CAMViewfinderViewController *)self setChromeViewController:v6];
    _fullscreenViewfinder = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
    [_fullscreenViewfinder frameForReticleViewport];
    [(CAMViewfinderViewController *)self _updateChromeViewfinderGeometryWithViewportFrame:?];

    objc_initWeak(&location, self);
    v12 = MEMORY[0x1E69E9820];
    v13 = 3221225472;
    v14 = __66__CAMViewfinderViewController__createChromeViewControllerIfNeeded__block_invoke;
    v15 = &unk_1E76F9D98;
    objc_copyWeak(&v16, &location);
    [(CAMChromeViewController *)v6 observeShutterButtonFrameWithHandler:&v12];
    v8 = [(CAMViewfinderViewController *)self viewfinderView:v12];
    _fullscreenViewfinder2 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];

    if (_fullscreenViewfinder2)
    {
      view = [(CAMChromeViewController *)v6 view];
      _fullscreenViewfinder3 = [(CAMViewfinderViewController *)self _fullscreenViewfinder];
      [_fullscreenViewfinder3 setChromeView:view];
    }

    else
    {
      if (!v8)
      {
LABEL_7:

        objc_destroyWeak(&v16);
        objc_destroyWeak(&location);

        return;
      }

      view = [(CAMChromeViewController *)v6 view];
      [v8 setChromeView:view];
    }

    goto LABEL_7;
  }
}

void __66__CAMViewfinderViewController__createChromeViewControllerIfNeeded__block_invoke(uint64_t a1, double a2, double a3, double a4, double a5)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v11 = [WeakRetained _fullscreenViewfinder];
  [v11 setExternalChromeShutterButtonFrame:1 animated:{a2, a3, a4, a5}];

  v13 = objc_loadWeakRetained((a1 + 32));
  v12 = [v13 viewfinderView];
  [v12 setExternalChromeShutterButtonFrame:{a2, a3, a4, a5}];
}

- (void)_updateViewfinderForExternalChromeState:(id)state
{
  controlStatusBar = [state controlStatusBar];
  [controlStatusBar setDelegate:self];

  if ([(CAMViewfinderViewController *)self isViewLoaded])
  {

    [(CAMViewfinderViewController *)self _updateForCurrentConfiguration];
  }
}

- (void)_updateChromeAvailableCaptureModes
{
  v16 = *MEMORY[0x1E69E9840];
  availableCaptureModes = [(CAMViewfinderViewController *)self availableCaptureModes];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  v5 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v6 = availableCaptureModes;
  v7 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v12;
    do
    {
      v10 = 0;
      do
      {
        if (*v12 != v9)
        {
          objc_enumerationMutation(v6);
        }

        [v5 addIndex:{objc_msgSend(*(*(&v11 + 1) + 8 * v10++), "integerValue", v11)}];
      }

      while (v8 != v10);
      v8 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
    }

    while (v8);
  }

  [chromeConfigurator setAvailableCaptureModeRawValues:v5];
}

- (void)_updateChromeControlsForGraphConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = +[CAMCaptureCapabilities capabilities];
  v5 = +[CAMUserPreferences preferences];
  chromeConfigurator = [(CAMViewfinderViewController *)self chromeConfigurator];
  [chromeConfigurator setCaptureGraphConfiguration:configurationCopy];
  [chromeConfigurator setSpatialModeHasVideoSelected:{-[CAMViewfinderViewController _spatialModeHasVideoSelected](self, "_spatialModeHasVideoSelected")}];
  [chromeConfigurator setIsDepthEffectApertureSupported:{-[CAMViewfinderViewController _isDepthEffectApertureSupportedForGraphConfiguration:](self, "_isDepthEffectApertureSupportedForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsSmartStylesSupported:{-[CAMViewfinderViewController _shouldShowSmartStyleControlForGraphConfiguration:](self, "_shouldShowSmartStyleControlForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsVideoStabilizationSupported:{-[CAMViewfinderViewController _shouldShowVideoStabilizationButtonForGraphConfiguration:](self, "_shouldShowVideoStabilizationButtonForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsFrontPIPSupported:{-[CAMViewfinderViewController _shouldShowFrontPIPButtonForGraphConfiguration:](self, "_shouldShowFrontPIPButtonForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsSemanticStylesSupported:{-[CAMViewfinderViewController _shouldShowSemanticStyleControlForGraphConfiguration:](self, "_shouldShowSemanticStyleControlForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsFiltersSupported:{-[CAMViewfinderViewController _shouldUseFiltersForGraphConfiguration:](self, "_shouldUseFiltersForGraphConfiguration:", configurationCopy)}];
  [chromeConfigurator setIsHDRSupported:{-[CAMViewfinderViewController _wantsHDRControlsVisibleForGraphConfiguration:](self, "_wantsHDRControlsVisibleForGraphConfiguration:", configurationCopy)}];
  if (-[CAMViewfinderViewController _isReconfiguring](self, "_isReconfiguring") && ([chromeConfigurator isFlashSupported] & 1) == 0)
  {
    isTorchSupported = [chromeConfigurator isTorchSupported];
  }

  else
  {
    isTorchSupported = 1;
  }

  v8 = [v4 isFlashSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];
  [chromeConfigurator setIsFlashSupported:v8 & isTorchSupported];
  if (v8)
  {
    alwaysShowFlashIndicator = [v5 alwaysShowFlashIndicator];
  }

  else
  {
    alwaysShowFlashIndicator = 0;
  }

  [chromeConfigurator setShowFlashInTopBarForAllStates:alwaysShowFlashIndicator];
  v10 = [v4 isTorchSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}] & isTorchSupported;
  [chromeConfigurator setIsTorchSupported:v10];
  if (v10 == 1)
  {
    alwaysShowFlashIndicator2 = [v5 alwaysShowFlashIndicator];
  }

  else
  {
    alwaysShowFlashIndicator2 = 0;
  }

  [chromeConfigurator setShowTorchInTopBarForAllStates:alwaysShowFlashIndicator2];
  v12 = [v4 isLivePhotoSupportedForMode:objc_msgSend(configurationCopy devicePosition:{"mode"), objc_msgSend(configurationCopy, "devicePosition")}];
  v13 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v14 = v13;
  if (v12)
  {
    [v13 addIndex:1];
    [v14 addIndex:0];
    if ([v4 isLivePhotoAutoModeSupported])
    {
      [v14 addIndex:2];
    }

    [chromeConfigurator setSupportedLivePhotoModeRawValues:v14];
    alwaysShowLivePhotoIndicator = [v5 alwaysShowLivePhotoIndicator];
  }

  else
  {
    [chromeConfigurator setSupportedLivePhotoModeRawValues:v13];
    alwaysShowLivePhotoIndicator = 0;
  }

  [chromeConfigurator setShowLivePhotoInTopBar:alwaysShowLivePhotoIndicator];
  [chromeConfigurator setIsAspectRatioCropSupported:{objc_msgSend(v4, "isAspectRatioCropSupportedForMode:devicePosition:", objc_msgSend(configurationCopy, "mode"), objc_msgSend(configurationCopy, "devicePosition"))}];
  [chromeConfigurator setIsExposureSliderSupported:{objc_msgSend(v4, "isExposureSliderSupportedForMode:", objc_msgSend(configurationCopy, "mode"))}];
  [chromeConfigurator setIsTimerSupported:{objc_msgSend(v4, "isTimerSupportedForMode:", objc_msgSend(configurationCopy, "mode"))}];
  [chromeConfigurator setIsFlipSupported:{-[CAMViewfinderViewController _isFlipButtonSupportedForMode:](self, "_isFlipButtonSupportedForMode:", objc_msgSend(configurationCopy, "mode"))}];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  [chromeConfigurator setActivePrimaryConstituentDeviceType:{objc_msgSend(_captureController, "activePrimaryConstituentDeviceType")}];

  [chromeConfigurator setExpandedModeWheelOnboardingSupported:{objc_msgSend(v4, "isExpandedModeWheelOnboardingSupported")}];
}

- (void)_updateChromePhotoFormatsAndResolutions
{
  v48 = *MEMORY[0x1E69E9840];
  v3 = +[CAMUserPreferences preferences];
  v4 = +[CAMCaptureCapabilities capabilities];
  _currentMode = [(CAMViewfinderViewController *)self _currentMode];
  _currentDevice = [(CAMViewfinderViewController *)self _currentDevice];
  _resolvedPhotoResolution = [(CAMViewfinderViewController *)self _resolvedPhotoResolution];
  _resolvedRAWMode = [(CAMViewfinderViewController *)self _resolvedRAWMode];
  _captureController = [(CAMViewfinderViewController *)self _captureController];
  v9 = [v3 photoEncodingBehaviorForMode:_currentMode resolvedRAWMode:_resolvedRAWMode isCapturingVideo:objc_msgSend(_captureController isTrueVideo:{"isCapturingVideo"), -[CAMViewfinderViewController _trueVideoIsTransitioningToCapturingOrCapturing](self, "_trueVideoIsTransitioningToCapturingOrCapturing")}];

  selfCopy = self;
  v33 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v32 = objc_alloc_init(MEMORY[0x1E696AD50]);
  _currentGraphConfiguration = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
  if ([(CAMViewfinderViewController *)self _shouldShowPhotoFormatButtonForGraphConfiguration:_currentGraphConfiguration])
  {
  }

  else
  {
    _currentGraphConfiguration2 = [(CAMViewfinderViewController *)self _currentGraphConfiguration];
    v13 = [(CAMViewfinderViewController *)self _shouldShowRAWButtonForGraphConfiguration:_currentGraphConfiguration2];

    if (!v13)
    {
      goto LABEL_18;
    }
  }

  selfCopy2 = self;
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v14 = [&unk_1F16C9560 countByEnumeratingWithState:&v43 objects:v47 count:16];
  if (v14)
  {
    v15 = v14;
    v16 = *v44;
    do
    {
      for (i = 0; i != v15; ++i)
      {
        if (*v44 != v16)
        {
          objc_enumerationMutation(&unk_1F16C9560);
        }

        v18 = *(*(&v43 + 1) + 8 * i);
        v19 = [v4 isPhotoResolutionSupported:objc_msgSend(v18 forMode:"intValue") device:_currentMode photoEncoding:{_currentDevice, v9}];
        v20 = [v3 isPhotoFormat:v9 enabledForMode:objc_msgSend(v18 device:"intValue"), _currentMode, _currentDevice];
        if (v19)
        {
          v21 = v20 == 0;
        }

        else
        {
          v21 = 1;
        }

        if (!v21)
        {
          [v33 addIndex:{objc_msgSend(v18, "integerValue")}];
        }
      }

      v15 = [&unk_1F16C9560 countByEnumeratingWithState:&v43 objects:v47 count:16];
    }

    while (v15);
  }

  [v32 addIndex:{objc_msgSend(v3, "photoEncodingBehavior") != 0}];
  selfCopy = selfCopy2;
  if ([v3 rawControlEnabled])
  {
    [v32 addIndex:2];
  }

LABEL_18:
  _storageController = [(CAMViewfinderViewController *)selfCopy _storageController];
  _currentGraphConfiguration3 = [(CAMViewfinderViewController *)selfCopy _currentGraphConfiguration];
  [_storageController availableRecordingTimeInSecondsForGraphConfiguration:_currentGraphConfiguration3];
  v25 = v24;

  photoEncodingBehavior = [v3 photoEncodingBehavior];
  v42 = [v3 preferredHEICPhotoResolutionForDevicePosition:{-[CAMViewfinderViewController _currentDevicePosition](selfCopy, "_currentDevicePosition")}];
  [v3 resolveDesiredPhotoResolution:v42 livePhotoMode:-[CAMViewfinderViewController _desiredLivePhotoMode](selfCopy rawMode:"_desiredLivePhotoMode") conflicts:-[CAMViewfinderViewController _desiredRAWMode](selfCopy mode:"_desiredRAWMode") device:-[CAMViewfinderViewController _photoFormatConflicts](selfCopy resolvedPhotoResolution:"_photoFormatConflicts") resolvedLivePhotoMode:{-[CAMViewfinderViewController _currentMode](selfCopy, "_currentMode"), -[CAMViewfinderViewController _currentDevice](selfCopy, "_currentDevice"), &v42, 0}];
  chromeConfigurator = [(CAMViewfinderViewController *)selfCopy chromeConfigurator];
  v34[0] = MEMORY[0x1E69E9820];
  v34[1] = 3221225472;
  v34[2] = __70__CAMViewfinderViewController__updateChromePhotoFormatsAndResolutions__block_invoke;
  v34[3] = &unk_1E76F9DC0;
  v34[4] = selfCopy;
  v35 = v33;
  v36 = v32;
  v37 = _resolvedPhotoResolution;
  v38 = v42;
  v39 = v9;
  v40 = photoEncodingBehavior;
  v41 = v25;
  v28 = v32;
  v29 = v33;
  [chromeConfigurator performChanges:v34];
}

void __70__CAMViewfinderViewController__updateChromePhotoFormatsAndResolutions__block_invoke(uint64_t a1)
{
  v2 = *(a1 + 40);
  v3 = [*(a1 + 32) chromeConfigurator];
  [v3 setSupportedPhotoResolutionRawValues:v2];

  v4 = *(a1 + 48);
  v5 = [*(a1 + 32) chromeConfigurator];
  [v5 setSupportedPhotoEncodingBehaviorRawValues:v4];

  v6 = [*(a1 + 32) chromeConfigurator];
  [v6 setPhotoResolution:*(a1 + 56)];

  v7 = [*(a1 + 32) chromeConfigurator];
  [v7 setDefaultPhotoResolution:*(a1 + 64)];

  v8 = [*(a1 + 32) chromeConfigurator];
  [v8 setPhotoEncodingBehavior:*(a1 + 72)];

  v9 = [*(a1 + 32) chromeConfigurator];
  [v9 setDefaultPhotoEncodingBehavior:*(a1 + 80)];

  v10 = [*(a1 + 32) chromeConfigurator];
  [v10 setRemainingRecordingTime:*(a1 + 88)];
}

- (CAMViewfinderPresentationDelegate)presentationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_presentationDelegate);

  return WeakRetained;
}

- ($F24F406B2B787EFB06265DBA3D28CBD5)_nightModeDurationMapping
{
  minimumDuration = self->minimumDuration;
  maximumDuration = self->maximumDuration;
  result.var1 = maximumDuration;
  result.var0 = minimumDuration;
  return result;
}

- ($0AC6E346AE4835514AAA8AC86D8F4844)_desiredAdvancedPhotoFormat
{
  v2 = &self->2728;
  encoding = self->encoding;
  resolution = v2->resolution;
  result.var1 = resolution;
  result.var0 = encoding;
  return result;
}

- (UIView)_captureAnimationPreviewOverlay
{
  WeakRetained = objc_loadWeakRetained(&self->__captureAnimationPreviewOverlay);

  return WeakRetained;
}

- (CAMViewfinderViewControllerStillImageCaptureRequestTestingDelegate)stillImageCaptureTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_stillImageCaptureTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerVideoCaptureRequestTestingDelegate)videoCaptureTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_videoCaptureTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerCameraRollTestingDelegate)cameraRollControllerTestDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_cameraRollControllerTestDelegate);

  return WeakRetained;
}

- (CAMViewfinderViewControllerUnlockDelegate)unlockDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_unlockDelegate);

  return WeakRetained;
}

- (CAMCameraConfigurationDelegate)configurationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_configurationDelegate);

  return WeakRetained;
}

- (CAMCaptureDelegate)captureDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_captureDelegate);

  return WeakRetained;
}

- (void)_commitCTMCaptureWithType:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_commitCTMCaptureWithType:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_initiateCTMCaptureWithCurrentSettingsAtSystemTime:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)stillImageRequestDidCompleteStillImageLocalPersistence:withResponse:error:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_startCapturingVideoWithRequest:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)panoramaRequestDidStartCapturing:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

void __64__CAMViewfinderViewController__handleImageAnalysisButtonTapped___block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_setWantsVisualTextAnalysis:animated:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_handleTextAnalysisStillImageResponse:error:forRequest:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_stillImageCaptureRequestForTextAnalysis
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)request:didFailWithError:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

void __66__CAMViewfinderViewController__handlePillPressForCurrentMRCAction__block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)actionDidUpdateTitle:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_handleSmartStyleIntensitySliderChangedValue:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlShouldBeginGesture:(unint64_t)a1 .cold.1(unint64_t a1)
{
  v1 = CAMDebugStringForControlDisableReasons(a1);
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0(&dword_1A3640000, v2, v3, "Shutter control should already be disabled for reasons: %{public}@", v4, v5, v6, v7, v8);
}

- (void)dynamicShutterControlDidShortPress:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStart:withGesture:.cold.4()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidStop:.cold.4()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressLockButton:.cold.3()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPressPauseResumeButton:.cold.2()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)dynamicShutterControlDidPresentCounter:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_captureEventSoundWithURL:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_deviceForSelectButtonZoomDisplayZoomFactor:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

- (void)_handleApplicationWillAddDeactivationReason:.cold.1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_availableDefaultCaptureMode
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

void __103__CAMViewfinderViewController__requestPasscodeUnlockForCameraRollController_forAction_completionBlock___block_invoke_cold_1()
{
  OUTLINED_FUNCTION_1();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
}

- (void)_resolvedSmartFramingFieldOfViewForMode:devicePosition:.cold.1()
{
  OUTLINED_FUNCTION_1_0();
  OUTLINED_FUNCTION_0_1();
  _os_log_error_impl(v0, v1, v2, v3, v4, 2u);
}

@end