void sub_24A0ADE90(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t __Block_byref_object_copy_(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

void sub_24A0ADFD4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE0DC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE1E4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE2EC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE3F4(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE4FC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE604(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AE70C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AEA04(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AECA0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AEF3C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AF61C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Block_object_dispose((v9 - 64), 8);
  _Unwind_Resume(a1);
}

void sub_24A0AF820(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Block_object_dispose((v9 - 64), 8);
  _Unwind_Resume(a1);
}

void sub_24A0AFA04(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AFB68(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0AFD7C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, ...)
{
  va_start(va, a11);
  _Block_object_dispose(va, 8);
  _Block_object_dispose((v11 - 96), 8);
  _Unwind_Resume(a1);
}

void sub_24A0B078C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, ...)
{
  va_start(va, a13);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B09C0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, ...)
{
  va_start(va, a13);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B0CBC(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B0E4C(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B1024(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B11B8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, ...)
{
  va_start(va, a9);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B1884(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B19D0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B1B40(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B1CB0(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

void sub_24A0B1E20(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t strstrcnt(const char *a1, size_t a2, char *__s)
{
  v3 = 0;
  if (a2)
  {
    v4 = a1;
    if (a1)
    {
      if (__s)
      {
        v6 = a2;
        v7 = strlen(__s);
        if (v7)
        {
          v8 = v7;
          v3 = 0;
          do
          {
            v9 = strnstr(v4, __s, v6);
            if (!v9)
            {
              break;
            }

            v10 = &v4[v6];
            v3 = (v3 + 1);
            v4 = &v9[v8];
            v6 = v10 - &v9[v8];
          }

          while (v10 != &v9[v8]);
        }

        else
        {
          return 0;
        }
      }
    }
  }

  return v3;
}

void logWBXMLDataToExchangeTrafficLog(void *a1)
{
  v1 = a1;
  if (v1)
  {
    v2 = objc_opt_new();
    [v2 setIsOutgoingTraffic:1];
    [v2 logWBXMLData:v1];
    [v2 flushLogs];
  }

  else
  {
    v2 = DALoggingwithCategory();
    v3 = *(MEMORY[0x277D03988] + 6);
    if (os_log_type_enabled(v2, v3))
    {
      *v4 = 0;
      _os_log_impl(&dword_24A0AC000, v2, v3, "Nil Data", v4, 2u);
    }
  }
}

void logPlainTextDataToExchangeTrafficLog(void *a1)
{
  v1 = a1;
  if (v1)
  {
    v2 = objc_opt_new();
    [v2 setIsOutgoingTraffic:1];
    [v2 logPlainTextData:v1];
    [v2 flushLogs];
  }

  else
  {
    v2 = DALoggingwithCategory();
    v3 = *(MEMORY[0x277D03988] + 6);
    if (os_log_type_enabled(v2, v3))
    {
      *v4 = 0;
      _os_log_impl(&dword_24A0AC000, v2, v3, "Nil Data", v4, 2u);
    }
  }
}

void logEmptyRequestToExchangeTrafficLog()
{
  v0 = objc_opt_new();
  [v0 setIsOutgoingTraffic:1];
  [v0 flushLogs];
}

uint64_t handleCodePageSwitch(void *a1, int a2, _BYTE *a3)
{
  v13 = *MEMORY[0x277D85DE8];
  v5 = a1;
  v6 = v5;
  if (!a2)
  {
    if (![v5 hasNumberOfTokensRemaining:2])
    {
      v9 = 0;
      goto LABEL_9;
    }

    [v6 advanceOffsetByAmount:1];
    [v6 setCodePage:{objc_msgSend(v6, "currentByte")}];
    [v6 advanceOffsetByAmount:1];
    if ([MEMORY[0x277D03910] isEASParsingLogEnabled])
    {
      v7 = DALoggingwithCategory();
      v8 = *(MEMORY[0x277D03988] + 7);
      if (os_log_type_enabled(v7, v8))
      {
        v12[0] = 67109120;
        v12[1] = [v6 codePage];
        _os_log_impl(&dword_24A0AC000, v7, v8, "switched to code page 0x%x", v12, 8u);
      }
    }

    LOBYTE(a2) = [v6 currentByte];
  }

  *a3 = a2;
  v9 = 1;
LABEL_9:

  v10 = *MEMORY[0x277D85DE8];
  return v9;
}

uint64_t _getParmForTag(uint64_t a1, void *a2, void *a3)
{
  if (*(a1 + 8) != 1)
  {
    return 0;
  }

  if (xmlStrcmp(*(a1 + 16), "parm"))
  {
    return 0;
  }

  *a2 = getAttributeAsNSString(a1, "name");
  *a3 = getAttributeAsNSString(a1, "value");
  return 1;
}

void TranslatePolicyWBXMLDCCPT(void *a1, void *a2, int a3, void *a4)
{
  v11 = a2;
  v7 = a4;
  v8 = [a1 objectForKeyedSubscript:&unk_285D57AE0];
  v9 = [MEMORY[0x277CCABB0] numberWithInt:a3 | 0xE00u];
  v10 = [v8 objectForKeyedSubscript:v9];

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    [v11 setValue:v10 forKey:v7];
  }
}

id _getNodeContentAsNSStringForFirstMatchingElement(xmlChar *str2, uint64_t a2)
{
  FirstElementMatching = 0;
  if (str2 && a2)
  {
    FirstElementMatching = _getFirstElementMatching(str2, a2);
    if (FirstElementMatching)
    {
      FirstElementMatching = _getNodeContentAsNSString(FirstElementMatching);
    }

    v2 = vars8;
  }

  return FirstElementMatching;
}

uint64_t _getFirstElementMatching(xmlChar *str2, uint64_t a2)
{
  result = 0;
  if (str2)
  {
    v4 = a2;
    if (a2)
    {
      while (1)
      {
        v5 = *(v4 + 16);
        if (v5)
        {
          if (!xmlStrcmp(v5, str2))
          {
            break;
          }
        }

        v4 = *(v4 + 48);
        if (!v4)
        {
          return 0;
        }
      }

      return v4;
    }
  }

  return result;
}

id _getNodeContentAsNSString(uint64_t a1)
{
  v2 = *(a1 + 24);
  if (v2)
  {
    v3 = xmlCharToNSString(*(v2 + 80));
  }

  else
  {
    v3 = 0;
  }

  return v3;
}

void sub_24A0BE4A8(_Unwind_Exception *a1)
{
  _Block_object_dispose(&STACK[0x390], 8);
  _Block_object_dispose(&STACK[0x3B0], 8);
  _Block_object_dispose(&STACK[0x3D0], 8);
  _Block_object_dispose(&STACK[0x400], 8);
  _Unwind_Resume(a1);
}

uint64_t __Block_byref_object_copy__0(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

uint64_t ASCommandStringForCode(uint64_t a1)
{
  if ((a1 + 1) < 0x19)
  {
    return qword_278FC7BD0[(a1 + 1)];
  }

  [MEMORY[0x277CBEAD8] raise:@"Invalid ASCommandCode" format:{@"%s asked for code %d", "ASCommandStringForCode", a1, v1, v2}];
  return 0;
}

__CFString *ASParameterStringForTag(uint64_t a1)
{
  if (a1 < 9)
  {
    return off_278FC7C98[a1];
  }

  [MEMORY[0x277CBEAD8] raise:@"Invalid ASParameterTag" format:{@"%s asked for tag %d", "ASParameterStringForTag", a1, v1, v2}];
  return 0;
}

void OUTLINED_FUNCTION_0(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_fault_impl(a1, a2, OS_LOG_TYPE_FAULT, a4, &a9, 2u);
}

BOOL areEqualStrings(void *a1, void *a2)
{
  v3 = a1;
  v4 = a2;
  if ([v3 length] || objc_msgSend(v4, "length"))
  {
    v5 = 0;
    if (v3 && v4)
    {
      v5 = [v3 caseInsensitiveCompare:v4] == 0;
    }
  }

  else
  {
    v5 = 1;
  }

  return v5;
}

void sub_24A0EAA98(_Unwind_Exception *a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, __int128 buf)
{
  if (a2 == 1)
  {
    v11 = objc_begin_catch(a1);
    v12 = DALoggingwithCategory();
    v13 = *(MEMORY[0x277D03988] + 3);
    if (os_log_type_enabled(v12, v13))
    {
      LODWORD(buf) = 138412290;
      *(&buf + 4) = v11;
      _os_log_impl(&dword_24A0AC000, v12, v13, "Caught the following exception trying to grab a contact's external representation %@", &buf, 0xCu);
    }

    objc_end_catch();
    JUMPOUT(0x24A0EA864);
  }

  _Unwind_Resume(a1);
}

void addIMUserNameToMultiValue(const void *a1, const __CFString *a2, void *a3)
{
  v12[2] = *MEMORY[0x277D85DE8];
  if (a3)
  {
    v5 = *MEMORY[0x277CE9920];
    v11[0] = *MEMORY[0x277CE9948];
    v11[1] = v5;
    v6 = *MEMORY[0x277CE98F0];
    v12[0] = a3;
    v12[1] = v6;
    v7 = MEMORY[0x277CBEAC0];
    v8 = a3;
    v9 = [v7 dictionaryWithObjects:v12 forKeys:v11 count:2];

    ABMultiValueAddValueAndLabel(a1, v9, a2, 0);
  }

  v10 = *MEMORY[0x277D85DE8];
}

void sub_24A0EE028(_Unwind_Exception *a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, __int128 buf)
{
  if (a2 == 1)
  {
    v11 = objc_begin_catch(a1);
    v12 = DALoggingwithCategory();
    v13 = *(MEMORY[0x277D03988] + 3);
    if (os_log_type_enabled(v12, v13))
    {
      LODWORD(buf) = 138412290;
      *(&buf + 4) = v11;
      _os_log_impl(&dword_24A0AC000, v12, v13, "Caught the following exception trying to grab a contact's external representation %@", &buf, 0xCu);
    }

    objc_end_catch();
    JUMPOUT(0x24A0EDE14);
  }

  _Unwind_Resume(a1);
}

uint64_t setAttributeOnPerson(const void *a1, ABPropertyID a2, void *a3, char a4)
{
  v7 = a3;
  if (v7)
  {
    ABRecordSetValue(a1, a2, v7, 0);
    goto LABEL_7;
  }

  if ((a4 & 1) == 0)
  {
    ABRecordRemoveValue(a1, a2, 0);
    goto LABEL_7;
  }

  v8 = ABRecordCopyValue(a1, a2);
  if (!v8)
  {
LABEL_7:
    v9 = 0;
    goto LABEL_8;
  }

  CFRelease(v8);
  v9 = 1;
LABEL_8:

  return v9;
}

uint64_t translateWBXMLToXMLStream(void *a1, void *a2, uint64_t a3)
{
  v5 = a2;
  v6 = a1;
  v7 = [[ASStreamWBXMLToXMLConverter alloc] initWithWBXMLInput:v6 forOutput:v5 usingMetadata:a3];

  v8 = [(ASStreamWBXMLToXMLConverter *)v7 runSynchronously];
  return v8;
}

uint64_t translateWBXMLToXMLFileDescriptor(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  v5 = [[ASFileDescriptorWBXMLToXMLConverter alloc] initWithInputFD:a1 outputFD:a2 usingMetadata:a3];
  [(ASWBXMLToXMLConverter *)v5 setMaxInlineStringLength:a4];
  v6 = [(ASFileDescriptorWBXMLToXMLConverter *)v5 runSynchronously];

  return v6;
}

uint64_t translateWBXMLToXMLData(void *a1, void *a2, uint64_t a3)
{
  v5 = a2;
  v6 = a1;
  v7 = [[ASDataWBXMLToXMLConverter alloc] initWithWBXMLData:v6 forOutput:v5 usingMetadata:a3];

  v8 = [(ASDataWBXMLToXMLConverter *)v7 runSynchronously];
  return v8;
}

void sub_24A1113A0(_Unwind_Exception *a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, __int128 buf)
{
  if (a2 == 2)
  {
    v11 = objc_begin_catch(a1);
    v12 = DALoggingwithCategory();
    v13 = *(MEMORY[0x277D03988] + 3);
    if (os_log_type_enabled(v12, v13))
    {
      LODWORD(buf) = 138412290;
      *(&buf + 4) = v11;
      _os_log_impl(&dword_24A0AC000, v12, v13, "Swallowing decoder exception of %@, treating as null data", &buf, 0xCu);
    }

    objc_end_catch();
    JUMPOUT(0x24A11133CLL);
  }

  _Unwind_Resume(a1);
}

void sub_24A111A9C(_Unwind_Exception *a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, __int128 buf)
{
  if (a2 == 2)
  {
    v20 = objc_begin_catch(a1);
    v21 = DALoggingwithCategory();
    v22 = *(MEMORY[0x277D03988] + 3);
    if (os_log_type_enabled(v21, v22))
    {
      LODWORD(buf) = 138412290;
      *(&buf + 4) = v20;
      _os_log_impl(&dword_24A0AC000, v21, v22, "Got exception when reading folder cache from disk.  Starting over from scratch.  Exception %@", &buf, 0xCu);
    }

    [v19 _blowAwayFolderCacheWithoutSavingOldFolderPaths];
    objc_end_catch();
    JUMPOUT(0x24A111A38);
  }

  _Unwind_Resume(a1);
}

id managedConfigurationPoliciesFromEASWBXMLPolicies(void *a1)
{
  v64 = *MEMORY[0x277D85DE8];
  v1 = a1;
  v2 = [MEMORY[0x277CBEB38] dictionary];
  v3 = [MEMORY[0x277CBEB38] dictionary];
  v4 = *MEMORY[0x277D26158];
  v49 = v3;
  [v2 setObject:? forKeyedSubscript:?];
  v5 = [MEMORY[0x277CBEB38] dictionary];
  v6 = *MEMORY[0x277D26168];
  v48 = v5;
  [v2 setObject:? forKeyedSubscript:?];
  p_inst_props = &OBJC_PROTOCOL___ASPolicyManagerDelegate.inst_props;
  if (!managedConfigurationPoliciesFromEASWBXMLPolicies_unmappableKeys)
  {
    v8 = [objc_alloc(MEMORY[0x277CBEB98]) initWithObjects:{@"AllowRemoteDesktop", @"AllowSMIMEEncryptionAlgorithmNegotiation", @"AllowSMIMESoftCerts", @"AllowStorageCard", @"AllowUnsignedApplications", @"AllowUnsignedInstallationPackages", @"ApprovedApplicationList", @"UnapprovedInROMAppliationList", @"PasswordRecoveryEnabled", @"UNCAccessEnabled", @"AllowIrDA", @"DeviceEncryptionEnabled", @"RequireStorageCardEncryption", 0}];
    v9 = managedConfigurationPoliciesFromEASWBXMLPolicies_unmappableKeys;
    managedConfigurationPoliciesFromEASWBXMLPolicies_unmappableKeys = v8;

    v10 = [objc_alloc(MEMORY[0x277CBEB98]) initWithObjects:{@"AllowBluetooth", @"AllowConsumerEmail", @"AllowDesktopSync", @"AllowHTMLEmail", @"AllowInternetSharing", @"AllowPOPIMAPEmail", @"AllowTextMessaging", @"AllowWiFi", @"AttachmentsEnabled", @"MaxAttachmentSize", @"MaxCalendarAgeFilter", @"MaxEmailAgeFilter", @"MaxEmailBodyTruncationSize", @"MaxEmailHTMLBodyTruncationSize", @"RequireEncryptedSMIMEMessages", @"RequireEncryptionSMIMEAlgorithm", @"RequireSignedSMIMEAlgorithm", @"RequireSingedSMIMEMessages", @"RequireManualSyncWhenRoaming", @"ASPolicyType", 0}];
    v11 = managedConfigurationPoliciesFromEASWBXMLPolicies_ignoredKeys;
    managedConfigurationPoliciesFromEASWBXMLPolicies_ignoredKeys = v10;
  }

  v55 = 0u;
  v56 = 0u;
  v53 = 0u;
  v54 = 0u;
  v12 = [v1 allKeys];
  v13 = [v12 countByEnumeratingWithState:&v53 objects:v63 count:16];
  if (!v13)
  {

    v29 = 0;
    goto LABEL_56;
  }

  v14 = v13;
  v40 = v2;
  v43 = 0;
  v50 = 0;
  v52 = 0;
  v15 = *v54;
  v33 = *MEMORY[0x277D26028];
  v35 = *MEMORY[0x277D25FE8];
  v36 = *MEMORY[0x277D25D98];
  v37 = *MEMORY[0x277D25DB8];
  v38 = *MEMORY[0x277D25FD8];
  v39 = *MEMORY[0x277D25F88];
  v41 = *MEMORY[0x277D26060];
  v42 = *MEMORY[0x277D25F78];
  v47 = *MEMORY[0x277D25FE0];
  v44 = *MEMORY[0x277D25F98];
  v45 = *MEMORY[0x277D25CF8];
  v16 = 1;
  v46 = *MEMORY[0x277D25FF8];
  type = *(MEMORY[0x277D03988] + 3);
  v51 = v1;
  do
  {
    v17 = 0;
    do
    {
      if (*v54 != v15)
      {
        objc_enumerationMutation(v12);
      }

      v18 = *(*(&v53 + 1) + 8 * v17);
      if (([managedConfigurationPoliciesFromEASWBXMLPolicies_unmappableKeys containsObject:v18] & 1) == 0 && (-[__objc2_prop_list containsObject:](p_inst_props[102], "containsObject:", v18) & 1) == 0)
      {
        v16 |= v52 ^ 1;
        v19 = [v1 objectForKeyedSubscript:v18];
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) == 0)
        {
          objc_opt_class();
          if (objc_opt_isKindOfClass())
          {
            if ([v19 length])
            {
              v20 = [MEMORY[0x277CCABB0] numberWithInt:{objc_msgSend(v19, "intValue")}];
              v1 = v51;
              if (v20)
              {
                goto LABEL_16;
              }
            }

LABEL_18:
            v21 = 7;
          }

          else
          {
            v21 = 3;
          }

          v22 = DALoggingwithCategory();
          v23 = *(MEMORY[0x277D03988] + v21);
          if (os_log_type_enabled(v22, v23))
          {
            v24 = objc_opt_class();
            *buf = 138412802;
            v58 = v19;
            v59 = 2112;
            v60 = v24;
            v61 = 2112;
            v62 = v18;
            v25 = v24;
            _os_log_impl(&dword_24A0AC000, v22, v23, "Couldn't convert policy value %@ (class %@) for policy key %@, to a NSNumber.  Skipping it!", buf, 0x20u);
          }

          v20 = 0;
          v1 = v51;
          goto LABEL_28;
        }

        v20 = v19;
        if (!v20)
        {
          goto LABEL_18;
        }

LABEL_16:
        if ([v18 isEqualToString:@"DevicePasswordEnabled"])
        {
          v50 |= [v20 BOOLValue];
          goto LABEL_24;
        }

        if ([v18 isEqualToString:@"AlphanumericPasswordEnabled"])
        {
LABEL_24:
          MCFeatureInsertRestrictedBool();
          goto LABEL_25;
        }

        if (![v18 isEqualToString:@"MinDevicePasswordLength"])
        {
          if ([v18 isEqualToString:@"MaxInactivityTimeDeviceLock"])
          {
            if ([v20 intValue])
            {
              v20 = v20;

              v52 = 1;
              MCFeatureInsertRestrictedValue();
              v43 = v20;
              goto LABEL_28;
            }

LABEL_25:
            if (!(v52 & 1 | ((v16 & 1) == 0)))
            {
              v52 = 1;
              MCFeatureInsertRestrictedValue();
              goto LABEL_27;
            }

            goto LABEL_28;
          }

          if (![v18 isEqualToString:@"MaxDevicePasswordFailedAttempts"])
          {
            if ([v18 isEqualToString:@"AllowSimpleDevicePassword"])
            {
              goto LABEL_24;
            }

            if ([v18 isEqualToString:@"DevicePasswordExpiration"])
            {
              if (![v20 intValue])
              {
                goto LABEL_25;
              }
            }

            else if ([v18 isEqualToString:@"DevicePasswordHistory"])
            {
              if (![v20 intValue])
              {
                goto LABEL_25;
              }
            }

            else
            {
              if ([v18 isEqualToString:@"AllowCamera"] || objc_msgSend(v18, "isEqualToString:", @"RequireDeviceEncryption"))
              {
                goto LABEL_24;
              }

              if (![v18 isEqualToString:@"MinDevicePasswordComplexCharacters"])
              {
                if ([v18 isEqualToString:@"AllowBrowser"])
                {
                  goto LABEL_24;
                }

                v26 = DALoggingwithCategory();
                if (os_log_type_enabled(v26, type))
                {
                  v27 = [v1 objectForKeyedSubscript:v18];
                  *buf = 138412546;
                  v58 = v18;
                  v59 = 2112;
                  v60 = v27;
                  _os_log_impl(&dword_24A0AC000, v26, type, "Ignoring unknown EAS 2007 policy %@ (%@)", buf, 0x16u);

                  v1 = v51;
                }

LABEL_27:
                v16 = 0;
LABEL_28:

                p_inst_props = (&OBJC_PROTOCOL___ASPolicyManagerDelegate + 56);
                goto LABEL_29;
              }
            }
          }
        }

        MCFeatureInsertRestrictedValue();
        goto LABEL_25;
      }

LABEL_29:
      ++v17;
    }

    while (v14 != v17);
    v28 = [v12 countByEnumeratingWithState:&v53 objects:v63 count:16];
    v14 = v28;
  }

  while (v28);

  v29 = v43;
  if ((v50 & (v43 != 0)) == 1)
  {
    v30 = *MEMORY[0x277D25D78];
    MCFeatureInsertRestrictedValue();
  }

  v2 = v40;
LABEL_56:

  v31 = *MEMORY[0x277D85DE8];

  return v2;
}

id perAccountEASPoliciesFromEASWBXMLPolicies(void *a1)
{
  v19 = *MEMORY[0x277D85DE8];
  v1 = a1;
  if (!perAccountEASPoliciesFromEASWBXMLPolicies_whitelistedKeys)
  {
    v2 = [objc_alloc(MEMORY[0x277CBEB98]) initWithObjects:{@"AttachmentsEnabled", @"MaxAttachmentSize", @"RequireManualSyncWhenRoaming", @"MaxCalendarAgeFilter", @"MaxEmailAgeFilter", @"AllowHTMLEmail", @"MaxEmailBodyTruncationSize", @"MaxEmailHTMLBodyTruncationSize", @"RequireSingedSMIMEMessages", @"RequireEncryptedSMIMEMessages", @"RequireSignedSMIMEAlgorithm", @"RequireEncryptionSMIMEAlgorithm", @"AllowSMIMEEncryptionAlgorithmNegotiation", @"AllowSMIMESoftCerts", 0}];
    v3 = perAccountEASPoliciesFromEASWBXMLPolicies_whitelistedKeys;
    perAccountEASPoliciesFromEASWBXMLPolicies_whitelistedKeys = v2;
  }

  v4 = [MEMORY[0x277CBEB38] dictionary];
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  v5 = [v1 allKeys];
  v6 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v15;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v15 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v14 + 1) + 8 * i);
        if ([perAccountEASPoliciesFromEASWBXMLPolicies_whitelistedKeys containsObject:v10])
        {
          v11 = [v1 objectForKeyedSubscript:v10];
          [v4 setObject:v11 forKeyedSubscript:v10];
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v7);
  }

  v12 = *MEMORY[0x277D85DE8];

  return v4;
}

__CFArray *_DACreateByDayDaysArrayFromASDayOfWeek(char a1, int a2)
{
  Mutable = CFArrayCreateMutable(*MEMORY[0x277CBECE8], 7, MEMORY[0x277CF78F8]);
  v5 = Mutable;
  if (a1)
  {
    value = a2;
    v8 = 0;
    CFArrayAppendValue(Mutable, &value);
    if ((a1 & 2) == 0)
    {
LABEL_3:
      if ((a1 & 4) == 0)
      {
        goto LABEL_4;
      }

      goto LABEL_12;
    }
  }

  else if ((a1 & 2) == 0)
  {
    goto LABEL_3;
  }

  value = a2;
  v8 = 1;
  CFArrayAppendValue(v5, &value);
  if ((a1 & 4) == 0)
  {
LABEL_4:
    if ((a1 & 8) == 0)
    {
      goto LABEL_5;
    }

    goto LABEL_13;
  }

LABEL_12:
  value = a2;
  v8 = 2;
  CFArrayAppendValue(v5, &value);
  if ((a1 & 8) == 0)
  {
LABEL_5:
    if ((a1 & 0x10) == 0)
    {
      goto LABEL_6;
    }

    goto LABEL_14;
  }

LABEL_13:
  value = a2;
  v8 = 3;
  CFArrayAppendValue(v5, &value);
  if ((a1 & 0x10) == 0)
  {
LABEL_6:
    if ((a1 & 0x20) == 0)
    {
      goto LABEL_7;
    }

LABEL_15:
    value = a2;
    v8 = 5;
    CFArrayAppendValue(v5, &value);
    if ((a1 & 0x40) == 0)
    {
      return v5;
    }

    goto LABEL_8;
  }

LABEL_14:
  value = a2;
  v8 = 4;
  CFArrayAppendValue(v5, &value);
  if ((a1 & 0x20) != 0)
  {
    goto LABEL_15;
  }

LABEL_7:
  if ((a1 & 0x40) != 0)
  {
LABEL_8:
    value = a2;
    v8 = 6;
    CFArrayAppendValue(v5, &value);
  }

  return v5;
}

uint64_t _dayOfWeekFromByDayDaysArray(CFArrayRef theArray, _DWORD *a2)
{
  if (a2)
  {
    *a2 = -2;
  }

  Count = CFArrayGetCount(theArray);
  if (Count < 1)
  {
    v6 = 0;
    if (a2)
    {
      goto LABEL_34;
    }

    return v6;
  }

  v5 = Count;
  LODWORD(v6) = 0;
  for (i = 0; i != v5; ++i)
  {
    ValueAtIndex = CFArrayGetValueAtIndex(theArray, i);
    v9 = ValueAtIndex[1];
    v10 = v6 | 0x20;
    v11 = v6 | 0x40;
    if (v9 != 6)
    {
      v11 = v6;
    }

    if (v9 != 5)
    {
      v10 = v11;
    }

    v12 = v6 | 8;
    v13 = v6 | 0x10;
    if (v9 != 4)
    {
      v13 = v6;
    }

    if (v9 != 3)
    {
      v12 = v13;
    }

    if (v9 <= 4)
    {
      v10 = v12;
    }

    v14 = v6 | 1;
    v15 = v6 | 2;
    v16 = v6 | 4;
    if (v9 != 2)
    {
      v16 = v6;
    }

    if (v9 != 1)
    {
      v15 = v16;
    }

    if (v9)
    {
      v14 = v15;
    }

    if (v9 <= 2)
    {
      v6 = v14;
    }

    else
    {
      v6 = v10;
    }

    if (a2)
    {
      if (!i)
      {
        v17 = *ValueAtIndex;
LABEL_29:
        *a2 = v17;
        continue;
      }

      v17 = *ValueAtIndex;
      if (*a2 != *ValueAtIndex)
      {
        goto LABEL_29;
      }
    }
  }

  if (!a2)
  {
    return v6;
  }

LABEL_34:
  if (*a2 == -1)
  {
    *a2 = 5;
  }

  return v6;
}

uint64_t _asMonthOfYearFromCalMonthOfYear(uint64_t result)
{
  if (result > 63)
  {
    if (result > 511)
    {
      switch(result)
      {
        case 0x200:
          return 10;
        case 0x400:
          return 11;
        case 0x800:
          return 12;
      }
    }

    else
    {
      switch(result)
      {
        case 0x40:
          return 7;
        case 0x80:
          return 8;
        case 0x100:
          return 9;
      }
    }

    return 0xFFFFFFFFLL;
  }

  if (result > 7)
  {
    switch(result)
    {
      case 8:
        return 4;
      case 0x10:
        return 5;
      case 0x20:
        return 6;
    }

    return 0xFFFFFFFFLL;
  }

  if ((result - 1) >= 2)
  {
    if (result == 4)
    {
      return 3;
    }

    return 0xFFFFFFFFLL;
  }

  return result;
}

void _EASTaskLogPublic(uint64_t a1, uint64_t a2, uint64_t a3, int a4, void *a5, void *a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  v30 = *MEMORY[0x277D85DE8];
  v11 = a5;
  v12 = MEMORY[0x277CCACA8];
  v13 = a6;
  v14 = [[v12 alloc] initWithFormat:v13 arguments:&a9];

  v15 = DALoggingwithCategory();
  v16 = *(MEMORY[0x277D03988] + a4);
  if (os_log_type_enabled(v15, v16))
  {
    v17 = [v11 taskManager];
    v18 = [v17 accountID];
    v19 = objc_opt_class();
    v20 = NSStringFromClass(v19);
    *buf = 138544130;
    v23 = v18;
    v24 = 2114;
    v25 = v20;
    v26 = 2048;
    v27 = v11;
    v28 = 2114;
    v29 = v14;
    _os_log_impl(&dword_24A0AC000, v15, v16, "#EASTraffic #AccountID: %{public}@ [%{public}@ %p] %{public}@", buf, 0x2Au);
  }

  v21 = *MEMORY[0x277D85DE8];
}

void OUTLINED_FUNCTION_2(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_fault_impl(a1, v9, OS_LOG_TYPE_FAULT, a4, &a9, 0xCu);
}

__CFString *NSStringForDASingleDataclass(uint64_t a1)
{
  v1 = @"Calendar";
  v2 = @"Tasks";
  v3 = @"Notes";
  if (a1 != 32)
  {
    v3 = 0;
  }

  if (a1 != 16)
  {
    v2 = v3;
  }

  if (a1 != 4)
  {
    v1 = v2;
  }

  v4 = @"Email";
  v5 = @"Contacts";
  if (a1 != 2)
  {
    v5 = 0;
  }

  if (a1 != 1)
  {
    v4 = v5;
  }

  if (a1 <= 3)
  {
    return v4;
  }

  else
  {
    return v1;
  }
}

_WORD *uint16len(_WORD *result)
{
  if (result)
  {
    v1 = result;
    if (*result)
    {
      result = 0;
      v2 = v1 + 1;
      do
      {
        v3 = v2[result];
        result = (result + 1);
      }

      while (v3);
    }

    else
    {
      return 0;
    }
  }

  return result;
}

uint64_t uint16strncpy(_WORD *a1, int a2, __int16 *a3, unsigned int a4)
{
  v4 = *a3;
  if (*a3)
  {
    if (a4 >= (a2 & ~(a2 >> 31)))
    {
      v5 = a2 & ~(a2 >> 31);
    }

    else
    {
      v5 = a4;
    }

    v6 = 1;
    do
    {
      v7 = v6;
      if (!v5)
      {
        break;
      }

      *a1++ = v4;
      v4 = a3[v6];
      --v5;
      ++v6;
    }

    while (a3[v7]);
  }

  else
  {
    v7 = 0;
  }

  *a1 = 0;
  return v7;
}

id xmlCharToNSString(void *a1)
{
  if (a1)
  {
    a1 = [objc_alloc(MEMORY[0x277CCACA8]) initWithUTF8String:a1];
    v1 = vars8;
  }

  return a1;
}

id getAttributeAsNSString(const xmlNode *a1, const xmlChar *a2)
{
  v2 = xmlHasProp(a1, a2);
  if (v2)
  {
    Content = xmlNodeGetContent(v2);
  }

  else
  {
    Content = 0;
  }

  v4 = xmlCharToNSString(Content);
  free(Content);

  return v4;
}

uint64_t DADataclassForASFolderType(int a1)
{
  if ((a1 - 1) > 0x10)
  {
    return 0;
  }

  else
  {
    return qword_24A14E118[a1 - 1];
  }
}

id CreateDAFolderForASFolder(void *a1)
{
  if (a1)
  {
    v1 = a1;
    v2 = [v1 serverID];
    v3 = [v1 parentID];
    v4 = [v1 displayName];
    v5 = [v1 folderType];

    v6 = DADataclassForASFolderType(v5);
    v7 = objc_opt_new();
    [v7 setFolderName:v4];
    [v7 setFolderID:v2];
    [v7 setParentFolderID:v3];
    [v7 setDataclass:v6];
    [v7 setIsDefault:(v5 - 2) < 0xA];
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

id DAFolderArrayForASFolderArray(void *a1)
{
  v16 = *MEMORY[0x277D85DE8];
  v1 = a1;
  v2 = [objc_alloc(MEMORY[0x277CBEB18]) initWithCapacity:{objc_msgSend(v1, "count")}];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v3 = v1;
  v4 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v12;
    do
    {
      for (i = 0; i != v5; ++i)
      {
        if (*v12 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v8 = CreateDAFolderForASFolder(*(*(&v11 + 1) + 8 * i));
        [v2 addObject:{v8, v11}];
      }

      v5 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
    }

    while (v5);
  }

  v9 = *MEMORY[0x277D85DE8];

  return v2;
}

uint64_t _UserASFolderTypeForDataclass(uint64_t a1, int a2)
{
  if (a1 <= 3)
  {
    if (a1 == 1)
    {
      return 12;
    }

    if (a1 != 2)
    {
      return 1;
    }

    v2 = a2 == 0;
    v3 = 14;
    v4 = 9;
  }

  else
  {
    switch(a1)
    {
      case 32:
        v2 = a2 == 0;
        v3 = 17;
        v4 = 10;
        break;
      case 16:
        v2 = a2 == 0;
        v3 = 15;
        v4 = 7;
        break;
      case 4:
        v2 = a2 == 0;
        v3 = 13;
        v4 = 8;
        break;
      default:
        return 1;
    }
  }

  if (v2)
  {
    return v3;
  }

  else
  {
    return v4;
  }
}

ASFolder *CreateASFolderForDAFolder(void *a1)
{
  if (!a1)
  {
    v10 = 0;
    goto LABEL_17;
  }

  v1 = a1;
  v2 = [v1 folderID];
  v3 = [v1 parentFolderID];
  v4 = [v1 folderName];
  v5 = [v1 dataclass];
  v6 = [v1 isDefault];

  if (v5 > 3)
  {
    switch(v5)
    {
      case 32:
        v7 = v6 == 0;
        v8 = 17;
        v9 = 10;
        break;
      case 16:
        v7 = v6 == 0;
        v8 = 15;
        v9 = 7;
        break;
      case 4:
        v7 = v6 == 0;
        v8 = 13;
        v9 = 8;
        goto LABEL_13;
      default:
        goto LABEL_21;
    }

    goto LABEL_13;
  }

  if (v5 != 1)
  {
    if (v5 != 2)
    {
LABEL_21:
      v11 = 1;
      goto LABEL_16;
    }

    v7 = v6 == 0;
    v8 = 14;
    v9 = 9;
LABEL_13:
    if (v7)
    {
      v11 = v8;
    }

    else
    {
      v11 = v9;
    }

    goto LABEL_16;
  }

  v11 = 12;
LABEL_16:
  v10 = [[ASFolder alloc] initWithFolderType:v11 serverID:v2 parentID:v3 displayName:v4 localID:0];

LABEL_17:

  return v10;
}

id ASFolderArrayForDAFolderArray(void *a1)
{
  v16 = *MEMORY[0x277D85DE8];
  v1 = a1;
  v2 = [objc_alloc(MEMORY[0x277CBEB18]) initWithCapacity:{objc_msgSend(v1, "count")}];
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v3 = v1;
  v4 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v12;
    do
    {
      for (i = 0; i != v5; ++i)
      {
        if (*v12 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v8 = CreateASFolderForDAFolder(*(*(&v11 + 1) + 8 * i));
        [v2 addObject:{v8, v11}];
      }

      v5 = [v3 countByEnumeratingWithState:&v11 objects:v15 count:16];
    }

    while (v5);
  }

  v9 = *MEMORY[0x277D85DE8];

  return v2;
}

uint64_t statusAndErrorIndicateWeShouldTryAgain(uint64_t a1, void *a2)
{
  v2 = a2;
  walkUpDAErrorChain();
  v3 = a2;

  if (a1 == 5)
  {
    goto LABEL_2;
  }

  v5 = [v3 domain];
  if (![v5 isEqualToString:@"ASHTTPConnectionErrorDomain"])
  {

LABEL_7:
    v4 = 0;
    goto LABEL_8;
  }

  v6 = [v3 code];

  if (v6 != 500)
  {
    goto LABEL_7;
  }

LABEL_2:
  v4 = 1;
LABEL_8:

  return v4;
}

uint64_t overSimplifiedStatusForError(void *a1)
{
  v1 = a1;
  v2 = v1;
  if (v1)
  {
    v10 = [v1 code];
    walkUpDAErrorChain();
    v3 = v2;

    v4 = [v3 domain];
    if ([v4 isEqualToString:@"ASHTTPConnectionErrorDomain"])
    {
    }

    else
    {
      v5 = [v3 domain];
      v6 = [v5 isEqualToString:*MEMORY[0x277CCA738]];

      if (!v6)
      {
        v8 = [v3 domain];
        v9 = [v8 isEqualToString:*MEMORY[0x277D038E0]];

        if (v9)
        {
          if ((v10 + 1) > 3)
          {
            v2 = 2;
          }

          else
          {
            v2 = dword_24A14E1A0[v10 + 1];
          }
        }

        else
        {
          v2 = 1;
        }

        goto LABEL_8;
      }
    }

    if (v10 == 500)
    {
      v2 = 2;
    }

    else
    {
      v2 = 1;
    }

LABEL_8:
  }

  return v2;
}

id Base64EncodedAuth(uint64_t a1, uint64_t a2)
{
  v2 = [MEMORY[0x277CCACA8] stringWithFormat:@"%@:%@", a1, a2];
  v3 = [v2 dataUsingEncoding:5];
  v4 = [v3 base64EncodedStringWithOptions:0];

  return v4;
}

uint64_t ASNumPastDaysToSyncForFilterCode(int a1)
{
  if (a1 <= 7)
  {
    return FilterDaysSteps[a1];
  }

  else
  {
    return 0;
  }
}

uint64_t ASFilterCodeForNumPastDays(uint64_t result, uint64_t a2)
{
  if (result)
  {
    v2 = result;
    result = 0;
    while (1)
    {
      if (a2 == 4)
      {
        if ((result - 1) >= 3)
        {
          goto LABEL_8;
        }
      }

      else if (a2 != 1 || (~result & 6) != 0)
      {
LABEL_8:
        if (FilterDaysSteps[result] >= v2)
        {
          return result;
        }
      }

      if (++result == 8)
      {
        return 0;
      }
    }
  }

  return result;
}

id ASDeviceInfo()
{
  if (ASDeviceInfo_onceToken != -1)
  {
    ASDeviceInfo_cold_1();
  }

  v1 = ASDeviceInfo__sDeviceInfo;

  return v1;
}

void __ASDeviceInfo_block_invoke()
{
  v0 = objc_opt_new();
  v1 = ASDeviceInfo__sDeviceInfo;
  ASDeviceInfo__sDeviceInfo = v0;

  v18 = DAModelString();
  if (v18)
  {
    [ASDeviceInfo__sDeviceInfo setObject:v18 forKeyedSubscript:&unk_285D580E0];
  }

  v2 = MGCopyAnswer();
  if ([v2 isEqualToString:@"white"])
  {
    v3 = @"WHITE";
LABEL_7:
    v4 = [MEMORY[0x277CCA8D8] bundleForClass:objc_opt_class()];
    v5 = [v4 localizedStringForKey:v3 value:&stru_285D39BD0 table:@"DataAccess"];

    goto LABEL_9;
  }

  if ([v2 isEqualToString:@"black"])
  {
    v3 = @"BLACK";
    goto LABEL_7;
  }

  v5 = 0;
LABEL_9:
  v6 = MGCopyAnswer();
  if ([v6 length])
  {
    v7 = &stru_285D39BD0;
    if (v5)
    {
      v8 = v5;
    }

    else
    {
      v8 = &stru_285D39BD0;
    }

    if (v5)
    {
      v7 = @" ";
    }

    v9 = [MEMORY[0x277CCACA8] stringWithFormat:@"%@%@%@", v8, v7, v6];
    [ASDeviceInfo__sDeviceInfo setObject:v9 forKeyedSubscript:&unk_285D580F8];
  }

  v10 = _CFCopyServerVersionDictionary();
  if (!v10)
  {
    v10 = _CFCopySystemVersionDictionary();
  }

  v11 = [v10 objectForKeyedSubscript:*MEMORY[0x277CBEC88]];
  v12 = [v10 objectForKeyedSubscript:*MEMORY[0x277CBEC70]];
  v13 = [MEMORY[0x277CCACA8] stringWithFormat:@"iOS %@ %@", v11, v12];
  [ASDeviceInfo__sDeviceInfo setObject:v13 forKeyedSubscript:&unk_285D58110];
  v14 = [MEMORY[0x277CBEBD0] standardUserDefaults];
  v15 = [v14 objectForKey:@"AppleLanguages"];

  if ([v15 count])
  {
    v16 = [v15 objectAtIndexedSubscript:0];
    if (v16)
    {
      [ASDeviceInfo__sDeviceInfo setObject:v16 forKeyedSubscript:&unk_285D58128];
    }
  }

  v17 = DAUserAgent();
  [ASDeviceInfo__sDeviceInfo setObject:v17 forKeyedSubscript:&unk_285D58140];
}

__CFString *bestProtocolVersionFromVersions(void *a1)
{
  v20 = *MEMORY[0x277D85DE8];
  v1 = a1;
  v2 = @"Unknown";
  v3 = [MEMORY[0x277D03910] whitelistedEASProtocols];
  if (v3)
  {
    v4 = objc_opt_new();
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v5 = v1;
    v6 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v16;
      do
      {
        for (i = 0; i != v7; ++i)
        {
          if (*v16 != v8)
          {
            objc_enumerationMutation(v5);
          }

          v10 = *(*(&v15 + 1) + 8 * i);
          if ([v3 containsObject:{v10, v15}])
          {
            [v4 addObject:v10];
          }
        }

        v7 = [v5 countByEnumeratingWithState:&v15 objects:v19 count:16];
      }

      while (v7);
    }
  }

  else
  {
    v4 = [v1 mutableCopy];
  }

  v11 = @"16.1";
  if ([v4 containsObject:{@"16.1", v15}] & 1) != 0 || (v11 = @"16.0", (objc_msgSend(v4, "containsObject:", @"16.0")) || (v11 = @"14.1", (objc_msgSend(v4, "containsObject:", @"14.1")) || (v11 = @"14.0", (objc_msgSend(v4, "containsObject:", @"14.0")) || (v11 = @"12.1", (objc_msgSend(v4, "containsObject:", @"12.1")) || (v11 = @"2.5", objc_msgSend(v4, "containsObject:", @"2.5")))
  {
    v12 = v11;

    v2 = v12;
  }

  v13 = *MEMORY[0x277D85DE8];

  return v2;
}

NSObject *ASUnarchiveDate(void *a1, void *a2)
{
  v21 = *MEMORY[0x277D85DE8];
  v3 = a1;
  v4 = a2;
  v5 = MEMORY[0x277CCAAC8];
  v6 = MEMORY[0x277CBEB98];
  v7 = objc_opt_class();
  v8 = objc_opt_class();
  v9 = [v6 setWithObjects:{v7, v8, objc_opt_class(), 0}];
  v18 = 0;
  v10 = [v5 unarchivedObjectOfClasses:v9 fromData:v4 error:&v18];
  v11 = v18;

  if (!v10)
  {
    v12 = DALoggingwithCategory();
    v14 = *(MEMORY[0x277D03988] + 4);
    if (os_log_type_enabled(v12, *(MEMORY[0x277D03988] + 4)))
    {
      *buf = 138412290;
      v20 = v11;
      _os_log_impl(&dword_24A0AC000, v12, v14, "Unable to decode properties: %@", buf, 0xCu);
    }

    v10 = 0;
    goto LABEL_7;
  }

  v12 = [v10 objectForKey:v3];
  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
LABEL_7:
    v13 = 0;
    goto LABEL_8;
  }

  v12 = v12;
  v13 = v12;
LABEL_8:

  v15 = v13;
  v16 = *MEMORY[0x277D85DE8];
  return v13;
}

id asDeviceIDWithHintedID(void *a1)
{
  v1 = a1;
  if (asDeviceIDWithHintedID_onceToken != -1)
  {
    asDeviceIDWithHintedID_cold_1();
  }

  v9 = 0;
  v10 = &v9;
  v11 = 0x3032000000;
  v12 = __Block_byref_object_copy__1;
  v13 = __Block_byref_object_dispose__1;
  v14 = 0;
  v2 = sDeviceIDQueue();
  v6[0] = MEMORY[0x277D85DD0];
  v6[1] = 3221225472;
  v6[2] = __asDeviceIDWithHintedID_block_invoke_131;
  v6[3] = &unk_278FC7898;
  v7 = v1;
  v8 = &v9;
  v3 = v1;
  dispatch_sync(v2, v6);

  v4 = v10[5];
  _Block_object_dispose(&v9, 8);

  return v4;
}

void __asDeviceIDWithHintedID_block_invoke()
{
  v0 = sDeviceIDQueue();
  notify_register_dispatch("com.apple.dataacess.deviceIdentiferChanged", &asDeviceIDWithHintedID_notificationToken, v0, &__block_literal_global_130);
}

void __asDeviceIDWithHintedID_block_invoke_2()
{
  v0 = sASDeviceID;
  sASDeviceID = 0;
}

uint64_t __Block_byref_object_copy__1(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

void __asDeviceIDWithHintedID_block_invoke_131(uint64_t a1)
{
  v35 = *MEMORY[0x277D85DE8];
  v2 = sASDeviceID;
  if (!sASDeviceID)
  {
    v3 = [CPSharedResourcesDirectory() stringByAppendingPathComponent:@"Library/DataAccess/DeviceSpecificInfo.plist"];
    v4 = open([v3 fileSystemRepresentation], 514, 384);
    if (v4 < 0)
    {
      v6 = 0;
    }

    else
    {
      flockWithProcessAssertion();
      v5 = [MEMORY[0x277CBEAC0] dictionaryWithContentsOfFile:v3];
      v6 = v5;
      if (v5 && !*(a1 + 32))
      {
        v7 = [v5 objectForKey:@"DeviceSpecificIdentifier"];
        v8 = sASDeviceID;
        sASDeviceID = v7;
      }
    }

    if (!sASDeviceID)
    {
      objc_storeStrong(&sASDeviceID, *(a1 + 32));
      if (!sASDeviceID)
      {
        v9 = CFUUIDCreate(0);
        uuid = v9;
        if (v9)
        {
          v34 = CFUUIDGetUUIDBytes(v9);
          v31 = [objc_alloc(MEMORY[0x277CBEA90]) initWithBytesNoCopy:&v34 length:16 freeWhenDone:0];
          v10 = [v31 length];
          v33 = [v31 mutableCopy];
          [v33 appendBytes:&_asFormattedStringFromData_pad length:4];
          v11 = v33;
          v12 = [v33 bytes];
          v13 = ((8 * v10) | 4) / 5;
          v14 = malloc_type_calloc(v13 + 1, v13, 0x100004077774924uLL);
          v15 = v14;
          if (v10 >= 1)
          {
            v16 = 0;
            if (v13 <= 1)
            {
              v17 = 1;
            }

            else
            {
              v17 = v13;
            }

            v18 = v17 + 4 * v17;
            v19 = v14;
            do
            {
              v20 = (16 * ((*(v12 + (v16 >> 3)) >> (~v16 & 7)) & 1)) | (8 * ((*(v12 + ((v16 + 1) >> 3)) >> (~(v16 + 1) & 7)) & 1)) | (4 * ((*(v12 + ((v16 + 2) >> 3)) >> (~(v16 + 2) & 7)) & 1)) | (2 * ((*(v12 + ((v16 + 3) >> 3)) >> (~(v16 + 3) & 7)) & 1)) | (*(v12 + ((v16 + 4) >> 3)) >> (~(v16 + 4) & 7)) & 1;
              v21 = v20 | 0x30;
              v22 = v20 + 55;
              if (((16 * ((*(v12 + (v16 >> 3)) >> (~v16 & 7)) & 1)) | (8 * ((*(v12 + ((v16 + 1) >> 3)) >> (~(v16 + 1) & 7)) & 1)) | (4 * ((*(v12 + ((v16 + 2) >> 3)) >> (~(v16 + 2) & 7)) & 1)) | (2 * ((*(v12 + ((v16 + 3) >> 3)) >> (~(v16 + 3) & 7)) & 1))) < 0xA)
              {
                v22 = v21;
              }

              *v19++ = v22;
              v16 += 5;
            }

            while (v18 != v16);
          }

          v23 = [MEMORY[0x277CCACA8] stringWithUTF8String:v14];
          free(v15);

          v24 = sASDeviceID;
          sASDeviceID = v23;

          CFRelease(uuid);
        }
      }

      v25 = [v6 mutableCopy];
      if (!v25)
      {
        v25 = objc_opt_new();
      }

      [v25 setObject:sASDeviceID forKey:@"DeviceSpecificIdentifier"];
      [v25 writeToFile:v3 atomically:1];
      notify_post("com.apple.dataacess.deviceIdentiferChanged");
    }

    if ((v4 & 0x80000000) == 0)
    {
      flockWithProcessAssertion();
      close(v4);
    }

    v2 = sASDeviceID;
  }

  if ([v2 length] >= 0x19)
  {
    v26 = @"%@";
  }

  else
  {
    v26 = @"Appl%@";
  }

  v27 = [MEMORY[0x277CCACA8] stringWithFormat:v26, sASDeviceID];
  v28 = *(*(a1 + 40) + 8);
  v29 = *(v28 + 40);
  *(v28 + 40) = v27;

  v30 = *MEMORY[0x277D85DE8];
}

id sDeviceIDQueue()
{
  if (sDeviceIDQueue_onceToken != -1)
  {
    sDeviceIDQueue_cold_1();
  }

  v1 = sDeviceIDQueue_queue;

  return v1;
}

void __sDeviceIDQueue_block_invoke()
{
  v2 = dispatch_queue_attr_make_with_qos_class(0, QOS_CLASS_USER_INTERACTIVE, 0);
  v0 = dispatch_queue_create("DataAccess Device ID queue", v2);
  v1 = sDeviceIDQueue_queue;
  sDeviceIDQueue_queue = v0;
}

id _serialNumber()
{
  v0 = *MEMORY[0x277CD28A0];
  v1 = IOServiceMatching("IOPlatformExpertDevice");
  MatchingService = IOServiceGetMatchingService(v0, v1);
  if (!MatchingService || (v3 = MatchingService, IORegistryEntryCreateCFProperty(MatchingService, @"IOPlatformSerialNumber", *MEMORY[0x277CBECE8], 0), v4 = objc_claimAutoreleasedReturnValue(), IOObjectRelease(v3), !v4))
  {
    v4 = CFPreferencesCopyAppValue(@"DeviceID", @"com.apple.dataaccess.dataaccessd");
  }

  return v4;
}

Boolean CFCalendarDecomposeAbsoluteTime(CFCalendarRef calendar, CFAbsoluteTime at, const char *componentDesc, ...)
{
  va_start(va, componentDesc);
  v3 = va_arg(va, void);
  return MEMORY[0x28210F308](calendar, v3, at);
}

CFUUIDBytes CFUUIDGetUUIDBytes(CFUUIDRef uuid)
{
  v1 = MEMORY[0x2821100F0](uuid);
  result.byte8 = v2;
  result.byte9 = BYTE1(v2);
  result.byte10 = BYTE2(v2);
  result.byte11 = BYTE3(v2);
  result.byte12 = BYTE4(v2);
  result.byte13 = BYTE5(v2);
  result.byte14 = BYTE6(v2);
  result.byte15 = HIBYTE(v2);
  result.byte0 = v1;
  result.byte1 = BYTE1(v1);
  result.byte2 = BYTE2(v1);
  result.byte3 = BYTE3(v1);
  result.byte4 = BYTE4(v1);
  result.byte5 = BYTE5(v1);
  result.byte6 = BYTE6(v1);
  result.byte7 = HIBYTE(v1);
  return result;
}