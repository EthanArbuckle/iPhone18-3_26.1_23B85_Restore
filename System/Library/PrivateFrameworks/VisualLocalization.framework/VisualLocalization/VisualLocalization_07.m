float angle_combine(float *a1, int32x2_t a2, float32_t a3)
{
  v3 = a1[1];
  v4 = (*a2.i32 - *a1) - ((__PAIR64__(((*a2.i32 - *a1) * 0.159154943), *a2.i32 - *a1) - COERCE_UNSIGNED_INT(0.0)) >> 32) * 6.28318531;
  v5 = (a3 - *a1) - ((__PAIR64__(((a3 - *a1) * 0.159154943), a3 - *a1) - COERCE_UNSIGNED_INT(0.0)) >> 32) * 6.28318531;
  if (v4 <= 0.0 || v3 <= v4)
  {
    if (v5 <= 0.0 || v3 <= v5)
    {
      v8.f32[0] = *a1 + (v3 * 0.5);
      v8.f32[1] = a3;
      v9 = vsub_f32(v8, vdup_lane_s32(a2, 0));
      v10 = vcvtq_f64_f32(v9);
      a2 = vadd_s32(vmovn_s64(vcvtq_s64_f64(vmulq_f64(v10, vdupq_n_s64(0x3FC45F306DC9C883uLL)))), vcltz_f32(v9));
      v11.i64[0] = a2.i32[0];
      v11.i64[1] = a2.i32[1];
      v12 = vmlaq_f64(v10, vdupq_n_s64(0xC01921FB54442D18), vcvtq_f64_s64(v11));
      a2.i32[0] = vmovn_s64(vcgtq_f64(v12, vdupq_laneq_s64(v12, 1))).u32[0];
      if (a2.i8[0])
      {
        *a1 = 0;
      }
    }

    else
    {
      a1[1] = v5;
    }
  }

  else
  {
    v13 = *a2.i32 + ((__PAIR64__((*a2.i32 * 0.159154943), a2.u32[0]) - COERCE_UNSIGNED_INT(0.0)) >> 32) * -6.28318531;
    *a1 = v13;
    if (v3 <= v5)
    {
      *a2.i32 = v3 - v4;
      a1[1] = v3 - v4;
    }

    else
    {
      *a2.i32 = (a3 - *a2.i32) + ((__PAIR64__(((a3 - *a2.i32) * 0.159154943), a3 - *a2.i32) - COERCE_UNSIGNED_INT(0.0)) >> 32) * -6.28318531;
      a1[1] = *a2.i32;
    }
  }

  return *a2.i32;
}

float vl_pose_refine_multi(double *a1, double *a2, uint64_t a3, uint64_t a4, int a5, int a6, double *a7, uint64_t a8, float a9, float a10, float a11, float a12)
{
  v14 = 2 * a5;
  v15 = (6 * a5);
  v16 = (v15 * v15);
  v17 = malloc_type_malloc(4 * (v16 + 24 * a5 + ((((6 * a5) | 1) * v15) >> 1)), 0x100004052888210uLL);
  v210 = malloc_type_malloc(48 * v14, 0x1000040EED21634uLL);
  v211 = 0;
  gettimeofday(&v211, 0);
  v192 = v211;
  v18 = a5;
  if (a5 >= 1)
  {
    v19 = a1;
    v20 = v210;
    v21 = a5;
    do
    {
      v215 = 0u;
      v216 = 0u;
      v213 = 0u;
      v214 = 0u;
      v211 = 0;
      v212 = 0u;
      g_coords_diff(v19, a1, &v211);
      *v20 = vcvt_hight_f32_f64(vcvt_f32_f64(v211), v212);
      v20[1] = vcvt_hight_f32_f64(vcvt_f32_f64(v213), v214);
      v22 = *v20;
      v23 = v20[1];
      v20[2] = vcvt_hight_f32_f64(vcvt_f32_f64(v215), v216);
      v20[3] = v22;
      v24 = v20[2];
      v20[4] = v23;
      v20[5] = v24;
      v20 += 6;
      v19 += 12;
      --v21;
    }

    while (v21);
  }

  v25 = v17;
  v26 = &v17[v16];
  v27 = v15;
  v28 = &v26[v27];
  v29 = &v26[v27 + v27];
  v195 = &v29[v27];
  v191 = (v15 * v15);
  if (a6 < 1)
  {
    v95 = NAN;
    v34 = a8;
LABEL_65:
    if (a5 >= 1)
    {
      goto LABEL_66;
    }

    v130 = v95;
    goto LABEL_74;
  }

  v30 = 0;
  if (v15 <= 1)
  {
    v31 = 1;
  }

  else
  {
    v31 = v15;
  }

  v202 = v31;
  v32 = v31 & 0x7FFFFFF8;
  v33 = 4 * v15 + 4 * v16;
  v193 = &v17[v15] + v33;
  v201 = v32;
  v200 = v17 + v33;
  v199 = v17 + v33 + 16;
  v34 = a8;
  v197 = v17;
  while (1)
  {
    v198 = v30;
    v35 = refine_multi_lin(a1, a2, a3, a4, a5, v210, v25, v26, a9, a10, a11, a12);
    if (a5 >= 1)
    {
      v36 = 0;
      v37 = 2;
      v38 = v15 - 1;
      v39 = 1;
      v40 = v195;
      v41 = v197;
      do
      {
        v42 = *v41;
        *v40 = *v41;
        v43 = &v40[v36];
        if (v36)
        {
          v44 = -v36;
          v45 = -v36;
          do
          {
            v42 = v42 - (v40[v45] * v40[v45]);
            *v40 = v42;
            v97 = __CFADD__(v45++, 1);
          }

          while (!v97);
          *v40 = sqrtf(v42);
          ++v36;
          v46 = v41 + 1;
          if (v36 < v15)
          {
            v47 = v43 + 1;
            v48 = v39;
            do
            {
              v49 = *v46;
              *v47 = *v46;
              v50 = &v47[v44];
              v51 = v44;
              do
              {
                v52 = *v50++;
                v49 = v49 - (v52 * v40[v51]);
                *v47 = v49;
                v97 = __CFADD__(v51++, 1);
              }

              while (!v97);
              *v47 = v49 / *v40;
              v47 += ++v48;
              ++v46;
            }

            while (v48 != v15);
          }
        }

        else
        {
          *v40 = sqrtf(v42);
          v53 = v40 + 1;
          v46 = v41 + 1;
          v54 = v37;
          v55 = v38;
          do
          {
            v56 = *v46++;
            *v53 = v56;
            *v53 = v56 / *v40;
            v53 += v54++;
            --v55;
          }

          while (v55);
          v36 = 1;
        }

        v41 = &v46[v36];
        v40 = v43 + 2;
        ++v39;
        --v38;
        ++v37;
      }

      while (v36 != v15);
      v57 = 0;
      v58 = v195;
      do
      {
        v60 = v26[v57];
        v29[v57] = v60;
        if (v57)
        {
          v61 = v29;
          v62 = v57;
          v59 = v58;
          do
          {
            v63 = *v59++;
            v64 = v63;
            v65 = *v61++;
            v60 = v60 - (v64 * v65);
            v29[v57] = v60;
            --v62;
          }

          while (v62);
        }

        else
        {
          v59 = v58;
        }

        v58 = v59 + 1;
        v29[v57++] = v60 / *v59;
      }

      while (v57 != v15);
      v66 = v193;
      v67 = v15;
      do
      {
        v69 = v67 - 1;
        v70 = v29[v67 - 1];
        v28[v67 - 1] = v70;
        if (v67 < v15)
        {
          v71 = 0;
          v72 = &v59[v67];
          do
          {
            v70 = v70 - (*v72 * *&v66[4 * v71]);
            v28[v69] = v70;
            v72 += v67 + v71++ + 1;
          }

          while (v15 > v67 + v71);
        }

        v28[v69] = v70 / *v59;
        v59 -= v67;
        v66 -= 4;
        v68 = v67-- <= 1;
      }

      while (!v68);
      v73 = &v210[1].i8[8];
      v74 = a5;
      v75 = v28;
      do
      {
        *(v73 + 24) = *(v73 - 24);
        *(v73 + 40) = *(v73 - 8);
        *(v73 + 56) = *(v73 + 8);
        v76 = *(v73 + 4);
        *(v73 + 3) = *v75 + *(v73 + 3);
        *(v73 + 4) = v75[1] + v76;
        *(v73 + 5) = v75[2] + *(v73 + 5);
        v77 = v75[4];
        v78 = v75[5];
        v79 = __sincosf_stret(v75[3]);
        v80 = __sincosf_stret(v77);
        v81 = __sincosf_stret(v78);
        v82 = ((v79.__cosval * v80.__sinval) * v81.__sinval) - (v79.__sinval * v81.__cosval);
        v83 = (v79.__sinval * v81.__sinval) + ((v79.__cosval * v80.__sinval) * v81.__cosval);
        v84 = (v79.__cosval * v81.__cosval) + ((v79.__sinval * v80.__sinval) * v81.__sinval);
        v85 = ((v79.__sinval * v80.__sinval) * v81.__cosval) - (v79.__cosval * v81.__sinval);
        v86 = *(v73 - 6);
        v87 = *(v73 - 5);
        v88 = *(v73 - 4);
        v89 = *(v73 - 3);
        v90 = *(v73 - 2);
        v91 = *(v73 - 1);
        v92 = *v73;
        v93 = *(v73 + 1);
        v94 = *(v73 + 2);
        *(v73 - 6) = (((v86 * (v79.__cosval * v80.__cosval)) + 0.0) + (v87 * (v79.__sinval * v80.__cosval))) - (v88 * v80.__sinval);
        *(v73 - 5) = (((v86 * v82) + 0.0) + (v87 * v84)) + (v88 * (v80.__cosval * v81.__sinval));
        *(v73 - 4) = (((v86 * v83) + 0.0) + (v87 * v85)) + (v88 * (v80.__cosval * v81.__cosval));
        *(v73 - 3) = (((v89 * (v79.__cosval * v80.__cosval)) + 0.0) + (v90 * (v79.__sinval * v80.__cosval))) - (v91 * v80.__sinval);
        *(v73 - 2) = (((v89 * v82) + 0.0) + (v90 * v84)) + (v91 * (v80.__cosval * v81.__sinval));
        *(v73 - 1) = (((v89 * v83) + 0.0) + (v90 * v85)) + (v91 * (v80.__cosval * v81.__cosval));
        *v73 = (((v92 * (v79.__cosval * v80.__cosval)) + 0.0) + (v93 * (v79.__sinval * v80.__cosval))) - (v94 * v80.__sinval);
        *(v73 + 1) = (((v92 * v82) + 0.0) + (v93 * v84)) + (v94 * (v80.__cosval * v81.__sinval));
        *(v73 + 2) = (((v92 * v83) + 0.0) + (v93 * v85)) + (v94 * (v80.__cosval * v81.__cosval));
        v75 += 6;
        v73 += 96;
        --v74;
      }

      while (v74);
    }

    v95 = refine_multi_lin(a1, a2, a3, a4, a5, v210, 0, 0, a9, a10, a11, a12);
    if (v95 >= v35)
    {
      break;
    }

LABEL_62:
    v25 = v197;
    v18 = a5;
    v30 = v198 + 1;
    if (v198 + 1 == a6)
    {
      goto LABEL_65;
    }
  }

  v96 = 0;
  do
  {
    if (a5 >= 1)
    {
      if (a5 == 1)
      {
        v98 = 0;
      }

      else
      {
        v99 = v201;
        v100 = v199;
        v101.i64[0] = 0x3F0000003F000000;
        v101.i64[1] = 0x3F0000003F000000;
        do
        {
          v102 = vmulq_f32(*v100, v101);
          v100[-1] = vmulq_f32(v100[-1], v101);
          *v100 = v102;
          v100 += 2;
          v99 -= 8;
        }

        while (v99);
        v98 = v201;
        if (v201 == v202)
        {
          goto LABEL_55;
        }
      }

      v103 = v202 - v98;
      v104 = &v200[4 * v98];
      do
      {
        *v104 = *v104 * 0.5;
        ++v104;
        --v103;
      }

      while (v103);
LABEL_55:
      v105 = v210;
      v106 = a5;
      do
      {
        v107 = v105[4];
        *v105 = v105[3];
        v105[1] = v107;
        v105[2] = v105[5];
        v105 += 6;
        --v106;
      }

      while (v106);
      v108 = &v210[1].i8[8];
      v109 = a5;
      v110 = v28;
      do
      {
        *(v108 + 24) = *(v108 - 24);
        *(v108 + 40) = *(v108 - 8);
        *(v108 + 56) = *(v108 + 8);
        v111 = *(v108 + 4);
        *(v108 + 3) = *v110 + *(v108 + 3);
        *(v108 + 4) = v110[1] + v111;
        *(v108 + 5) = v110[2] + *(v108 + 5);
        v112 = v110[4];
        v113 = v110[5];
        v114 = __sincosf_stret(v110[3]);
        v115 = __sincosf_stret(v112);
        v116 = __sincosf_stret(v113);
        v117 = ((v114.__cosval * v115.__sinval) * v116.__sinval) - (v114.__sinval * v116.__cosval);
        v118 = (v114.__sinval * v116.__sinval) + ((v114.__cosval * v115.__sinval) * v116.__cosval);
        v119 = (v114.__cosval * v116.__cosval) + ((v114.__sinval * v115.__sinval) * v116.__sinval);
        v120 = ((v114.__sinval * v115.__sinval) * v116.__cosval) - (v114.__cosval * v116.__sinval);
        v121 = *(v108 - 6);
        v122 = *(v108 - 5);
        v123 = *(v108 - 4);
        v124 = *(v108 - 3);
        v125 = *(v108 - 2);
        v126 = *(v108 - 1);
        v127 = *v108;
        v128 = *(v108 + 1);
        v129 = *(v108 + 2);
        *(v108 - 6) = (((v121 * (v114.__cosval * v115.__cosval)) + 0.0) + (v122 * (v114.__sinval * v115.__cosval))) - (v123 * v115.__sinval);
        *(v108 - 5) = (((v121 * v117) + 0.0) + (v122 * v119)) + (v123 * (v115.__cosval * v116.__sinval));
        *(v108 - 4) = (((v121 * v118) + 0.0) + (v122 * v120)) + (v123 * (v115.__cosval * v116.__cosval));
        *(v108 - 3) = (((v124 * (v114.__cosval * v115.__cosval)) + 0.0) + (v125 * (v114.__sinval * v115.__cosval))) - (v126 * v115.__sinval);
        *(v108 - 2) = (((v124 * v117) + 0.0) + (v125 * v119)) + (v126 * (v115.__cosval * v116.__sinval));
        *(v108 - 1) = (((v124 * v118) + 0.0) + (v125 * v120)) + (v126 * (v115.__cosval * v116.__cosval));
        *v108 = (((v127 * (v114.__cosval * v115.__cosval)) + 0.0) + (v128 * (v114.__sinval * v115.__cosval))) - (v129 * v115.__sinval);
        *(v108 + 1) = (((v127 * v117) + 0.0) + (v128 * v119)) + (v129 * (v115.__cosval * v116.__sinval));
        *(v108 + 2) = (((v127 * v118) + 0.0) + (v128 * v120)) + (v129 * (v115.__cosval * v116.__cosval));
        v110 += 6;
        v108 += 96;
        --v109;
      }

      while (v109);
    }

    v95 = refine_multi_lin(a1, a2, a3, a4, a5, v210, 0, 0, a9, a10, a11, a12);
    v97 = v95 < v35 || v96++ >= 2;
  }

  while (!v97);
  v130 = v35;
  if (v95 < v35)
  {
    v34 = a8;
    goto LABEL_62;
  }

  v34 = a8;
  v25 = v197;
  v18 = a5;
  if (a5 >= 1)
  {
    v134 = v210;
    v135 = a5;
    do
    {
      v136 = v134[4];
      *v134 = v134[3];
      v134[1] = v136;
      v134[2] = v134[5];
      v134 += 6;
      --v135;
    }

    while (v135);
    v95 = v35;
LABEL_66:
    v131 = v25;
    v130 = v95;
    v132 = &v210[1].u32[2];
    v133 = a7;
    do
    {
      v216 = vcvtq_f64_f32(v132[2]);
      v211 = vcvtq_f64_f32(v132[-3]);
      v214 = vcvtq_f64_f32(*v132);
      v212 = vcvtq_f64_f32(v132[-2]);
      v213 = vcvtq_f64_f32(v132[-1]);
      v215 = vcvtq_f64_f32(v132[1]);
      g_coords_conv(&v211.tv_sec, a1, v133);
      v133 += 12;
      v132 += 12;
      --v18;
    }

    while (v18);
    v34 = a8;
    v25 = v131;
  }

LABEL_74:
  if (v34)
  {
    v137 = v25;
    refine_multi_lin(a1, a2, a3, a4, a5, v210, v25, v26, a9, a10, a11, a12);
    v25 = v137;
    if (a5 >= 1)
    {
      v138 = 0;
      v139 = v15 - 1;
      v140 = 1;
      v141 = 2;
      v142 = v195;
      v143 = v137;
      do
      {
        v144 = *v143;
        *v142 = *v143;
        v145 = &v142[v138];
        if (v138)
        {
          v146 = -v138;
          v147 = -v138;
          do
          {
            v144 = v144 - (v142[v147] * v142[v147]);
            *v142 = v144;
            v97 = __CFADD__(v147++, 1);
          }

          while (!v97);
          *v142 = sqrtf(v144);
          ++v138;
          v148 = v143 + 1;
          if (v138 < v15)
          {
            v149 = v145 + 1;
            v150 = v140;
            do
            {
              v151 = *v148;
              *v149 = *v148;
              v152 = &v149[v146];
              v153 = v146;
              do
              {
                v154 = *v152++;
                v151 = v151 - (v154 * v142[v153]);
                *v149 = v151;
                v97 = __CFADD__(v153++, 1);
              }

              while (!v97);
              *v149 = v151 / *v142;
              v149 += ++v150;
              ++v148;
            }

            while (v150 != v15);
          }
        }

        else
        {
          *v142 = sqrtf(v144);
          v155 = v142 + 1;
          v148 = v143 + 1;
          v156 = v141;
          v157 = v139;
          do
          {
            v158 = *v148++;
            *v155 = v158;
            *v155 = v158 / *v142;
            v155 += v156++;
            --v157;
          }

          while (v157);
          v138 = 1;
        }

        v143 = &v148[v138];
        v142 = v145 + 2;
        ++v140;
        --v139;
        ++v141;
      }

      while (v138 != v15);
    }

    v159 = 0;
    if (v15 <= 1)
    {
      v160 = 1;
    }

    else
    {
      v160 = v15;
    }

    v161 = vdupq_n_s64(4uLL);
    v162 = vdupq_n_s64(8uLL);
    while (a5 < 1)
    {
LABEL_96:
      v163 = 24 * v159;
      v164 = (v34 + 24 * v159);
      *v164 = *v28;
      v164[1] = *(v28 + 1);
      *(v34 + 8 + v163) = v28[2];
      *(v34 + 12 + v163) = v28[3];
      *(v34 + 16 + v163) = v28[4];
      *(v34 + 20 + v163) = v28[5];
      if (++v159 == 6)
      {
        goto LABEL_120;
      }
    }

    if (a5 != 1)
    {
      v166 = vdupq_n_s64(v159);
      v167 = v160 & 0x7FFFFFF8;
      v168 = &v137[v191 + 4];
      v169 = xmmword_2711038E0;
      v170 = xmmword_271103910;
      do
      {
        v168[-1] = vcvtq_f32_u32(vmovl_u16(vand_s8(vmovn_s32(vuzp1q_s32(vceqq_s64(v169, v166), vceqq_s64(v170, v166))), 0x1000100010001)));
        *v168 = vcvtq_f32_u32(vmovl_u16(vand_s8(vmovn_s32(vuzp1q_s32(vceqq_s64(vaddq_s64(v169, v161), v166), vceqq_s64(vaddq_s64(v170, v161), v166))), 0x1000100010001)));
        v170 = vaddq_s64(v170, v162);
        v169 = vaddq_s64(v169, v162);
        v168 += 2;
        v167 -= 8;
      }

      while (v167);
      for (i = v160 & 0x7FFFFFF8; v160 != i; ++i)
      {
LABEL_103:
        if (v159 == i)
        {
          v171 = 1.0;
        }

        else
        {
          v171 = 0.0;
        }

        v26[i] = v171;
      }

      v172 = 0;
      v173 = v195;
      do
      {
        v175 = v26[v172];
        v29[v172] = v175;
        if (v172)
        {
          v176 = v29;
          v177 = v172;
          v174 = v173;
          do
          {
            v178 = *v174++;
            v179 = v178;
            v180 = *v176++;
            v175 = v175 - (v179 * v180);
            v29[v172] = v175;
            --v177;
          }

          while (v177);
        }

        else
        {
          v174 = v173;
        }

        v173 = v174 + 1;
        v29[v172++] = v175 / *v174;
      }

      while (v172 != v15);
      v181 = &v137[v191 + v15 + v15];
      v182 = v15;
      do
      {
        v183 = v182 - 1;
        v184 = v29[v182 - 1];
        v28[v182 - 1] = v184;
        if (v182 < v15)
        {
          v185 = 0;
          v186 = &v174[v182];
          do
          {
            v184 = v184 - (*v186 * *&v181[4 * v185]);
            v28[v183] = v184;
            v186 += v182 + v185++ + 1;
          }

          while (v15 > v182 + v185);
        }

        v28[v183] = v184 / *v174;
        v174 -= v182;
        v181 -= 4;
        v68 = v182-- <= 1;
      }

      while (!v68);
      goto LABEL_96;
    }

    i = 0;
    goto LABEL_103;
  }

LABEL_120:
  free(v25);
  free(v210);
  v211.tv_sec = 0;
  *&v211.tv_usec = 0;
  gettimeofday(&v211, 0);
  tv_sec = v211.tv_sec;
  tv_usec = v211.tv_usec;
  printf("Verbose (toc) : ");
  printf("%s (%d poses, final rmse = %f)", "vl_pose_refine_multi", a5, v130);
  printf(": %f ms", ((1000000 * (tv_sec - v192.tv_sec) - *&v192.tv_usec + tv_usec) / 1000.0));
  putchar(10);
  return v130;
}

float refine_multi_lin(double *a1, double *a2, uint64_t a3, uint64_t a4, int a5, float32x4_t *a6, uint64_t a7, float *a8, float a9, float a10, float a11, float a12)
{
  v15 = a5;
  v295 = *MEMORY[0x277D85DE8];
  v17 = (6 * a5);
  if (a8)
  {
    if (a5 < 1)
    {
      v253 = 0;
      v26 = 0.0;
      return sqrtf(v26 / v253);
    }

    v18 = 0;
    if (v17 <= 1)
    {
      v19 = 1;
    }

    else
    {
      v19 = v17;
    }

    v20 = 4 * v19;
    do
    {
      bzero((a7 + 4 * v18), v20);
      v18 += v17;
      --v19;
    }

    while (v19);
    bzero(a8, v20);
  }

  if (v15 <= 1)
  {
    v253 = 0;
    v26 = 0.0;
    if (v15 < 1)
    {
      return sqrtf(v26 / v253);
    }
  }

  else
  {
    v253 = v15 - 1;
    v21 = 1.0 / a9;
    v245 = v15;
    v258 = v15;
    v22 = 4 * v17;
    v249 = a7 + v22;
    v23 = (1.0 / a9) * 0.0;
    v264 = 2 * v17 + v17;
    v247 = a7 + 4 * v264;
    v248 = a7 + 8 * v17;
    v263 = v22 + v17;
    v24 = a7 + 4 * (v22 + v17);
    v246 = a7 + 16 * v17;
    v25 = 1;
    v26 = 0.0;
    v260 = v21;
    do
    {
      v272 = 0u;
      v273 = 0u;
      v270 = 0u;
      v271 = 0u;
      v268 = 0u;
      v269 = 0u;
      if (a8)
      {
        v27 = &a8[6 * v25];
      }

      else
      {
        v27 = 0;
      }

      g_coords_diff(&a2[12 * v25], a2, &v268);
      v28 = *(&v272 + 1);
      v29 = *&v273;
      v30 = a6[2].f32[0];
      _S2 = a6[6 * v25 + 2].f32[1] - a6[2].f32[1];
      _S5 = a6[6 * v25 + 2].f32[3] - a6[2].f32[3];
      _Q7 = *a6;
      _Q16 = a6[1];
      __asm
      {
        FMLA            S6, S2, V7.S[1]
        FMLA            S17, S2, V7.S[2]
      }

      v41 = *(&v273 + 1);
      __asm
      {
        FMLA            S4, S5, V16.S[2]
        FMLA            S6, S5, V16.S[3]
      }

      v44 = _S17 + (v30 * _S5);
      v45 = v260 * (v28 - _S4);
      v46 = v260 * (v29 - _S6);
      v47 = v260 * (v41 - v44);
      if (a8)
      {
        v48 = vmulq_n_f32(vnegq_f32(_Q7), v260);
        v49 = vmulq_n_f32(vnegq_f32(_Q16), v260);
        v274 = v48;
        v275 = v49;
        v50 = a7 + 4 * (2 * 3 * v25 * (v17 | 1));
        v51 = a7 + 24 * v25;
        v52 = -(v30 * v260);
        v53 = v260 * _S6;
        *v276.f64 = v52;
        *(v276.f64 + 1) = v260 * _S6;
        v54 = -(_S4 * v260);
        *&v276.f64[1] = v54;
        *(&v276.f64[1] + 1) = v23;
        v55 = -(v44 * v260);
        *v277.f64 = v55;
        *(v277.f64 + 1) = v23;
        v56 = v260 * _S4;
        v57 = v260 * v44;
        v58 = -(_S6 * v260);
        *&v277.f64[1] = __PAIR64__(LODWORD(v23), LODWORD(v56));
        *v278 = v57;
        *&v278[4] = v58;
        v59 = -72;
        v60 = &v284 + 1;
        do
        {
          *(v60 - 5) = 0.0;
          v61 = (v48.f32[0] * *&v278[v59 + 8]) + 0.0;
          *(v60 - 5) = v61;
          v62 = v61 + (v48.f32[1] * *&v278[v59 + 12]);
          *(v60 - 5) = v62;
          *(v60 - 5) = v62 + (v48.f32[2] * *&v278[v59 + 16]);
          *(v60 - 4) = 0.0;
          v63 = (v48.f32[3] * *&v278[v59 + 8]) + 0.0;
          *(v60 - 4) = v63;
          v64 = v63 + (v49.f32[0] * *&v278[v59 + 12]);
          *(v60 - 4) = v64;
          *(v60 - 4) = v64 + (v49.f32[1] * *&v278[v59 + 16]);
          *(v60 - 3) = 0.0;
          v65 = (v49.f32[2] * *&v278[v59 + 8]) + 0.0;
          *(v60 - 3) = v65;
          v66 = v65 + (v49.f32[3] * *&v278[v59 + 12]);
          *(v60 - 3) = v66;
          *(v60 - 3) = v66 + (v52 * *&v278[v59 + 16]);
          *(v60 - 2) = 0.0;
          v67 = (v53 * *&v278[v59 + 8]) + 0.0;
          *(v60 - 2) = v67;
          v68 = v67 + (v54 * *&v278[v59 + 12]);
          *(v60 - 2) = v68;
          *(v60 - 2) = v68 + (v23 * *&v278[v59 + 16]);
          *(v60 - 1) = 0.0;
          v69 = (v55 * *&v278[v59 + 8]) + 0.0;
          *(v60 - 1) = v69;
          v70 = v69 + (v23 * *&v278[v59 + 12]);
          *(v60 - 1) = v70;
          *(v60 - 1) = v70 + (v56 * *&v278[v59 + 16]);
          *v60 = 0.0;
          v71 = (v23 * *&v278[v59 + 8]) + 0.0;
          *v60 = v71;
          v72 = v71 + (v57 * *&v278[v59 + 12]);
          *v60 = v72;
          *v60 = v72 + (v58 * *&v278[v59 + 16]);
          v60 += 6;
          v59 += 12;
        }

        while (v59);
        *a7 = vaddq_f32(*a7, v283);
        v73 = v286;
        *(a7 + 16) = vadd_f32(*(a7 + 16), v284);
        *v249 = vaddq_f32(*v249, v285);
        *(v249 + 16) = vadd_f32(*(v249 + 16), v73);
        *v248 = vaddq_f32(*v248, v287);
        v74 = v290;
        *(v248 + 16) = vadd_f32(*(v248 + 16), v288);
        *v247 = vaddq_f32(*v247, v289);
        *(v247 + 16) = vadd_f32(*(v247 + 16), v74);
        *v246 = vaddq_f32(*v246, v291);
        v75 = v294;
        *(v246 + 16) = vadd_f32(*(v246 + 16), v292);
        *v24 = vaddq_f32(*v24, v293);
        *(v24 + 16) = vadd_f32(*(v24 + 16), v75);
        v76 = a8[1] + (v48.f32[3] * v45);
        *a8 = ((*a8 + (*v274.f64 * v45)) + (*(v274.f64 + 1) * v46)) + (v48.f32[2] * v47);
        a8[1] = (v76 + (v49.f32[0] * v46)) + (v49.f32[1] * v47);
        v77 = a8[3];
        a8[2] = ((a8[2] + (v49.f32[2] * v45)) + (v49.f32[3] * v46)) + (v52 * v47);
        a8[3] = ((v77 + (v53 * v45)) + (v54 * v46)) + (v23 * v47);
        v78 = ((a8[4] + (v55 * v45)) + (v23 * v46)) + (v56 * v47);
        v79 = ((a8[5] + (v23 * v45)) + (v57 * v46)) + (v58 * v47);
        a8[4] = v78;
        a8[5] = v79;
        v80 = a6[1];
        v81 = vmulq_n_f32(*a6, v260);
        *&v278[8] = v81;
        v82 = vmulq_n_f32(v80, v260);
        *&v278[24] = v82;
        v83 = v260 * a6[2].f32[0];
        v279 = v83;
        v282 = 0.0;
        v281 = 0u;
        v280 = 0u;
        v84 = &v278[16];
        v85 = &v284 + 1;
        v86 = 6;
        do
        {
          *(v85 - 5) = 0.0;
          v87 = (v81.f32[0] * *(v84 - 2)) + 0.0;
          *(v85 - 5) = v87;
          v88 = v87 + (v81.f32[1] * *(v84 - 1));
          *(v85 - 5) = v88;
          *(v85 - 5) = v88 + (v81.f32[2] * *v84);
          *(v85 - 4) = 0.0;
          v89 = (v81.f32[3] * *(v84 - 2)) + 0.0;
          *(v85 - 4) = v89;
          v90 = v89 + (v82.f32[0] * *(v84 - 1));
          *(v85 - 4) = v90;
          *(v85 - 4) = v90 + (v82.f32[1] * *v84);
          *(v85 - 3) = 0.0;
          v91 = (v82.f32[2] * *(v84 - 2)) + 0.0;
          *(v85 - 3) = v91;
          v92 = v91 + (v82.f32[3] * *(v84 - 1));
          *(v85 - 3) = v92;
          *(v85 - 3) = v92 + (v83 * *v84);
          *(v85 - 2) = 0.0;
          v93 = (*(v84 - 2) * 0.0) + 0.0;
          *(v85 - 2) = v93;
          v94 = v93 + (*(v84 - 1) * 0.0);
          *(v85 - 2) = v94;
          *(v85 - 2) = v94 + (*v84 * 0.0);
          *(v85 - 1) = 0.0;
          v95 = (*(v84 - 2) * 0.0) + 0.0;
          *(v85 - 1) = v95;
          v96 = v95 + (*(v84 - 1) * 0.0);
          *(v85 - 1) = v96;
          *(v85 - 1) = v96 + (*v84 * 0.0);
          *v85 = 0.0;
          v97 = (*(v84 - 2) * 0.0) + 0.0;
          *v85 = v97;
          v98 = v97 + (*(v84 - 1) * 0.0);
          *v85 = v98;
          v99 = *v84;
          v84 += 3;
          *v85 = v98 + (v99 * 0.0);
          v85 += 6;
          --v86;
        }

        while (v86);
        *v50 = vaddq_f32(*v50, v283);
        v100 = v286;
        *(v50 + 16) = vadd_f32(*(v50 + 16), v284);
        v101 = v50 + 4 * v17;
        *v101 = vaddq_f32(*v101, v285);
        *(v101 + 16) = vadd_f32(*(v101 + 16), v100);
        v102 = v50 + 8 * v17;
        *v102 = vaddq_f32(*v102, v287);
        v103 = v290;
        *(v102 + 16) = vadd_f32(*(v102 + 16), v288);
        v104 = v50 + 4 * v264;
        *v104 = vaddq_f32(*v104, v289);
        *(v104 + 16) = vadd_f32(*(v104 + 16), v103);
        v105 = v50 + 16 * v17;
        *v105 = vaddq_f32(*v105, v291);
        v106 = v294;
        *(v105 + 16) = vadd_f32(*(v105 + 16), v292);
        v107 = v50 + 4 * v263;
        *v107 = vaddq_f32(*v107, v293);
        *(v107 + 16) = vadd_f32(*(v107 + 16), v106);
        v108 = v280;
        v109 = v281;
        v110 = v282;
        v111 = ((v27[1] + (v81.f32[3] * v45)) + (v82.f32[0] * v46)) + (v82.f32[1] * v47);
        *v27 = ((*v27 + (v81.f32[0] * v45)) + (v81.f32[1] * v46)) + (v81.f32[2] * v47);
        v27[1] = v111;
        v112 = ((v27[3] + (*&v108 * v45)) + (*(&v108 + 1) * v46)) + (*(&v108 + 2) * v47);
        v27[2] = ((v27[2] + (v82.f32[2] * v45)) + (v82.f32[3] * v46)) + (v83 * v47);
        v27[3] = v112;
        v113 = ((v27[5] + (*(&v109 + 2) * v45)) + (*(&v109 + 3) * v46)) + (v110 * v47);
        v27[4] = ((v27[4] + (*(&v108 + 3) * v45)) + (*&v109 * v46)) + (*(&v109 + 1) * v47);
        v27[5] = v113;
        v114 = v274.f64 + 1;
        v115 = &v284 + 1;
        v116 = 6;
        do
        {
          *(v115 - 5) = 0.0;
          v117 = (v81.f32[0] * *(v114 - 1)) + 0.0;
          *(v115 - 5) = v117;
          v118 = v117 + (v81.f32[1] * *v114);
          *(v115 - 5) = v118;
          *(v115 - 5) = v118 + (v81.f32[2] * v114[1]);
          *(v115 - 4) = 0.0;
          v119 = (v81.f32[3] * *(v114 - 1)) + 0.0;
          *(v115 - 4) = v119;
          v120 = v119 + (v82.f32[0] * *v114);
          *(v115 - 4) = v120;
          *(v115 - 4) = v120 + (v82.f32[1] * v114[1]);
          *(v115 - 3) = 0.0;
          v121 = (v82.f32[2] * *(v114 - 1)) + 0.0;
          *(v115 - 3) = v121;
          v122 = v121 + (v82.f32[3] * *v114);
          *(v115 - 3) = v122;
          *(v115 - 3) = v122 + (v83 * v114[1]);
          *(v115 - 2) = 0.0;
          v123 = (*&v108 * *(v114 - 1)) + 0.0;
          *(v115 - 2) = v123;
          v124 = v123 + (*(&v108 + 1) * *v114);
          *(v115 - 2) = v124;
          *(v115 - 2) = v124 + (*(&v108 + 2) * v114[1]);
          *(v115 - 1) = 0.0;
          v125 = (*(&v108 + 3) * *(v114 - 1)) + 0.0;
          *(v115 - 1) = v125;
          v126 = v125 + (*&v109 * *v114);
          *(v115 - 1) = v126;
          *(v115 - 1) = v126 + (*(&v109 + 1) * v114[1]);
          *v115 = 0.0;
          v127 = (*(&v109 + 2) * *(v114 - 1)) + 0.0;
          *v115 = v127;
          v128 = v127 + (*(&v109 + 3) * *v114);
          *v115 = v128;
          *v115 = v128 + (v110 * v114[1]);
          v115 += 6;
          v114 += 3;
          --v116;
        }

        while (v116);
        *v51 = vaddq_f32(*v51, v283);
        v129 = v286;
        *(v51 + 16) = vadd_f32(*(v51 + 16), v284);
        v130 = v51 + 4 * v17;
        *v130 = vaddq_f32(*v130, v285);
        *(v130 + 16) = vadd_f32(*(v130 + 16), v129);
        v131 = v51 + 8 * v17;
        *v131 = vaddq_f32(*v131, v287);
        v132 = v290;
        *(v131 + 16) = vadd_f32(*(v131 + 16), v288);
        v133 = v51 + 4 * v264;
        *v133 = vaddq_f32(*v133, v289);
        *(v133 + 16) = vadd_f32(*(v133 + 16), v132);
        v134 = v51 + 16 * v17;
        *v134 = vaddq_f32(*v134, v291);
        v135 = v294;
        *(v134 + 16) = vadd_f32(*(v134 + 16), v292);
        v136 = v51 + 4 * v263;
        *v136 = vaddq_f32(*v136, v293);
        *(v136 + 16) = vadd_f32(*(v136 + 16), v135);
      }

      v26 = v26 + (((v46 * v46) + (v45 * v45)) + (v47 * v47));
      ++v25;
    }

    while (v25 != v258);
    v15 = v245;
  }

  v137 = 0;
  v138 = 1.0;
  v139 = v15;
  do
  {
    memset(v278, 0, 32);
    v276 = 0u;
    v277 = 0u;
    v274 = 0u;
    v275 = 0u;
    v269 = 0u;
    v270 = 0u;
    v267 = 0u;
    v268 = 0u;
    v265 = 0u;
    v266 = 0u;
    g_coords_diff(&a1[12 * v137], a1, &v274);
    v268 = vcvt_hight_f32_f64(vcvt_f32_f64(v274), v275);
    v269 = vcvt_hight_f32_f64(vcvt_f32_f64(v276), v277);
    v270 = vcvt_hight_f32_f64(vcvt_f32_f64(*v278), *&v278[16]);
    f32 = a6[6 * v137].f32;
    g_coordsf_diff(&v268, f32, &v265, *&v278[16], *v270.i64, *v269.i64, v141, v142, v143, v144, v145);
    v146 = (a3 + 24 * v137);
    v147 = *v146;
    if (*v146 >= 1)
    {
      v148 = 0;
      v149 = v265;
      v150 = (a7 + 4 * (2 * 3 * v137 * (v17 | 1)));
      v151 = *(&v265 + 1);
      v152 = v266;
      v153 = *(&v267 + 1);
      v261 = *&v267;
      v154 = &a8[6 * v137];
      if (!a8)
      {
        v154 = 0;
      }

      v155 = &v150[v17];
      v156 = &v150[2 * v17];
      v157 = &v150[2 * v17 + v17];
      v257 = *(&v267 + 3);
      v259 = *(&v267 + 2);
      v158 = &v150[4 * v17];
      v159 = &v150[4 * v17 + v17];
      v160 = (*(a4 + 24 * v137 + 8) + 8);
      v161 = *v146;
      do
      {
        v162 = *(v160 - 2);
        v163 = *(v160 - 1);
        v164 = *v160;
        v165 = v153 + (((*(&v149 + 1) * v163) + (*&v149 * v162)) + (*&v151 * *v160));
        v166 = 0.0;
        if (v165 > 0.1)
        {
          v167 = (((v138 / v162) * a11) * ((v138 / v162) * a11)) + (a10 * a10);
          v168 = sqrtf(v167 + ((v163 * a12) * (v163 * a12)));
          v169 = sqrtf(v167 + ((v164 * a12) * (v164 * a12)));
          v170 = v259 + (((*&v152 * v163) + (*(&v151 + 1) * v162)) + (*(&v152 + 1) * v164));
          v171 = v257 + (((*(&v152 + 3) * v163) + (*(&v152 + 2) * v162)) + (v261 * v164));
          v172 = v138 / v168;
          v173 = v138 / v169;
          v174 = (v146[1] + v148);
          v175 = (v138 / v168) * (*v174 - (v170 / v165));
          v176 = (v138 / v169) * (v174[1] - (v171 / v165));
          v166 = (v176 * v176) + (v175 * v175);
          if (v154)
          {
            v177 = f32[1];
            v178 = f32[2];
            v179 = f32[3];
            v180 = f32[4];
            v181 = f32[5];
            v182 = f32[6];
            v183 = f32[7];
            v184 = f32[8];
            v185 = v172 * (-v170 / (v165 * v165));
            v186 = (v138 / v165) * v172;
            v187 = v173 * (-v171 / (v165 * v165));
            v188 = (v138 / v165) * v173;
            v189 = ((0.0 - (v185 * *f32)) - (v186 * v177)) - (v178 * 0.0);
            v190 = ((0.0 - (v187 * *f32)) - (v177 * 0.0)) - (v188 * v178);
            v191 = ((0.0 - (v185 * v179)) - (v186 * v180)) - (v181 * 0.0);
            v192 = ((0.0 - (v187 * v179)) - (v180 * 0.0)) - (v188 * v181);
            v193 = (0.0 - (v187 * v182)) - (v183 * 0.0);
            v194 = ((0.0 - (v185 * v182)) - (v186 * v183)) - (v184 * 0.0);
            v195 = v193 - (v188 * v184);
            v196 = (((v185 * v170) + 0.0) - (v186 * v165)) + 0.0;
            v197 = (((v187 * v170) + 0.0) - (v165 * 0.0)) + (v188 * 0.0);
            v198 = ((0.0 - (v185 * v171)) + (v186 * 0.0)) + (v165 * 0.0);
            v199 = ((0.0 - (v187 * v171)) + 0.0) + (v188 * v165);
            v200 = ((v185 * 0.0) + 0.0) + (v186 * v171);
            v201 = ((v187 * 0.0) + 0.0) + (v171 * 0.0);
            v202 = v200 - (v170 * 0.0);
            v203 = v201 - (v188 * v170);
            v204 = ((v191 * v189) + 0.0) + (v192 * v190);
            v205 = ((v194 * v189) + 0.0) + (v195 * v190);
            v206 = ((v196 * v189) + 0.0) + (v197 * v190);
            v207 = ((v198 * v189) + 0.0) + (v199 * v190);
            v208 = ((v202 * v189) + 0.0) + (v203 * v190);
            v209 = ((v194 * v191) + 0.0) + (v195 * v192);
            v210 = ((v196 * v191) + 0.0) + (v197 * v192);
            v211 = ((v198 * v191) + 0.0) + (v199 * v192);
            v212 = v204 + v150[1];
            *v150 = (((v189 * v189) + 0.0) + (v190 * v190)) + *v150;
            v150[1] = v212;
            v213 = v206 + v150[3];
            v150[2] = v205 + v150[2];
            v150[3] = v213;
            v214 = v208 + v150[5];
            v150[4] = v207 + v150[4];
            v150[5] = v214;
            v215 = v204 + *v155;
            v216 = ((v202 * v191) + 0.0) + (v203 * v192);
            v217 = (((v191 * v191) + 0.0) + (v192 * v192)) + v155[1];
            *v155 = v215;
            v155[1] = v217;
            v218 = v210 + v155[3];
            v155[2] = v209 + v155[2];
            v155[3] = v218;
            v219 = v216 + v155[5];
            v155[4] = v211 + v155[4];
            v155[5] = v219;
            v220 = ((v196 * v194) + 0.0) + (v197 * v195);
            v221 = v209 + v156[1];
            v222 = ((v198 * v194) + 0.0) + (v199 * v195);
            *v156 = v205 + *v156;
            v156[1] = v221;
            v223 = ((v202 * v194) + 0.0) + (v203 * v195);
            v224 = v220 + v156[3];
            v156[2] = (((v194 * v194) + 0.0) + (v195 * v195)) + v156[2];
            v156[3] = v224;
            v225 = v223 + v156[5];
            v156[4] = v222 + v156[4];
            v156[5] = v225;
            v226 = v210 + v157[1];
            v138 = 1.0;
            *v157 = v206 + *v157;
            v157[1] = v226;
            v227 = v220 + v157[2];
            v228 = ((v198 * v196) + 0.0) + (v199 * v197);
            v229 = (((v196 * v196) + 0.0) + (v197 * v197)) + v157[3];
            v230 = ((v202 * v196) + 0.0) + (v203 * v197);
            v157[2] = v227;
            v157[3] = v229;
            v231 = v230 + v157[5];
            v157[4] = v228 + v157[4];
            v157[5] = v231;
            v232 = v211 + v158[1];
            *v158 = v207 + *v158;
            v158[1] = v232;
            v233 = v228 + v158[3];
            v158[2] = v222 + v158[2];
            v158[3] = v233;
            v234 = ((v202 * v198) + 0.0) + (v203 * v199);
            v235 = v234 + v158[5];
            v158[4] = (((v198 * v198) + 0.0) + (v199 * v199)) + v158[4];
            v158[5] = v235;
            v236 = v216 + v159[1];
            *v159 = v208 + *v159;
            v159[1] = v236;
            v237 = v230 + v159[3];
            v159[2] = v223 + v159[2];
            v159[3] = v237;
            v238 = (((v202 * v202) + 0.0) + (v203 * v203)) + v159[5];
            v159[4] = v234 + v159[4];
            v159[5] = v238;
            v239 = (v154[1] + (v191 * v175)) + (v192 * v176);
            v240 = (v154[2] + (v194 * v175)) + (v195 * v176);
            v241 = (v154[3] + (v196 * v175)) + (v197 * v176);
            v242 = (v154[4] + (v198 * v175)) + (v199 * v176);
            v243 = (v154[5] + (v202 * v175)) + (v203 * v176);
            *v154 = (*v154 + (v189 * v175)) + (v190 * v176);
            v154[1] = v239;
            v154[2] = v240;
            v154[3] = v241;
            v154[4] = v242;
            v154[5] = v243;
          }
        }

        v26 = v26 + v166;
        v148 += 8;
        v160 += 3;
        --v161;
      }

      while (v161);
      v253 += v147;
    }

    ++v137;
  }

  while (v137 != v139);
  return sqrtf(v26 / v253);
}

float vl_pose_refine(float32x2_t *a1, uint64_t a2, unint64_t *a3, int a4, float32x2_t *a5, uint64_t a6, float a7, float a8, float a9)
{
  v70 = 0;
  v71 = 0;
  v72 = 0;
  v17 = *a3;
  if (*a3 <= 0)
  {
    v70 = *a3;
  }

  else
  {
    if (v17 <= 0x15)
    {
      v19 = 21;
    }

    else
    {
      v19 = *a3;
    }

    v20 = malloc_type_realloc(0, 12 * v19, 0x10000403E1C8BA9uLL);
    v71 = v20;
    v72 = v19;
    bzero(v20, 12 * v17);
    v70 = *a3;
    if (v70 >= 1)
    {
      v21 = a3[1];
      if (v70 >= 5)
      {
        v22 = 0;
        v23 = v20 + 12 * v70;
        v25 = v20 < v21 + 12 * v70 && v21 < v23;
        v26 = v23 <= a1 || v20 >= &a1[6];
        if (v26 && !v25)
        {
          v27 = v70 & 3;
          if ((v70 & 3) == 0)
          {
            v27 = 4;
          }

          v22 = v70 - v27;
          v28 = v22;
          v29 = a3[1];
          v30 = v20;
          do
          {
            v73 = vld3q_f32(v29);
            v29 += 12;
            v31 = &a1[4] + 1;
            v32 = vld1q_dup_f32(v31);
            v33 = &a1[5];
            v34 = vld1q_dup_f32(v33);
            v35 = vsubq_f32(v73.val[0], v32);
            v36 = vsubq_f32(v73.val[1], v34);
            v37 = &a1[5] + 1;
            v38 = vld1q_dup_f32(v37);
            v39 = vsubq_f32(v73.val[2], v38);
            v74.val[0] = vmlaq_n_f32(vmlaq_n_f32(vmulq_n_f32(v36, a1[1].f32[1]), v35, a1->f32[0]), v39, a1[3].f32[0]);
            v74.val[1] = vmlaq_n_f32(vmlaq_n_f32(vmulq_n_f32(v36, a1[2].f32[0]), v35, a1->f32[1]), v39, a1[3].f32[1]);
            v74.val[2] = vmlaq_n_f32(vmlaq_n_f32(vmulq_n_f32(v36, a1[2].f32[1]), v35, a1[1].f32[0]), v39, a1[4].f32[0]);
            vst3q_f32(v30, v74);
            v30 += 12;
            v28 -= 4;
          }

          while (v28);
        }
      }

      else
      {
        v22 = 0;
      }

      v40 = v70 - v22;
      v41 = 12 * v22;
      v42 = (v41 + v21 + 4);
      v43 = (&v20[1] + v41);
      do
      {
        v44 = *v42;
        v45 = v42[1];
        *(v43 - 2) = ((a1[1].f32[1] * (*v42 - a1[5].f32[0])) + (a1->f32[0] * (*(v42 - 1) - a1[4].f32[1]))) + (a1[3].f32[0] * (v45 - a1[5].f32[1]));
        v46 = *(v42 - 1);
        *(v43 - 1) = ((a1[2].f32[0] * (v44 - a1[5].f32[0])) + (a1->f32[1] * (v46 - a1[4].f32[1]))) + (a1[3].f32[1] * (v45 - a1[5].f32[1]));
        v47 = *v42;
        v42 += 3;
        *v43 = ((a1[2].f32[1] * (v47 - a1[5].f32[0])) + (a1[1].f32[0] * (v46 - a1[4].f32[1]))) + (a1[4].f32[0] * (v45 - a1[5].f32[1]));
        v43 += 3;
        --v40;
      }

      while (v40);
    }
  }

  v48 = vcvtq_f64_f32(a1[1]);
  v64 = vcvtq_f64_f32(*a1);
  v65 = v48;
  v49 = vcvtq_f64_f32(a1[3]);
  v66 = vcvtq_f64_f32(a1[2]);
  v67 = v49;
  v50 = vcvtq_f64_f32(a1[5]);
  v68 = vcvtq_f64_f32(a1[4]);
  v69 = v50;
  v51 = vcvtq_f64_f32(a5[1]);
  v58 = vcvtq_f64_f32(*a5);
  v59 = v51;
  v52 = vcvtq_f64_f32(a5[3]);
  v60 = vcvtq_f64_f32(a5[2]);
  v61 = v52;
  v53 = vcvtq_f64_f32(a5[5]);
  v62 = vcvtq_f64_f32(a5[4]);
  v63 = v53;
  v54 = vl_pose_refine_multi(v64.f64, 0, a2, &v70, 1, a4, v58.f64, a6, NAN, a7, a8, a9);
  v55 = vcvt_hight_f32_f64(vcvt_f32_f64(v66), v67);
  *a1->f32 = vcvt_hight_f32_f64(vcvt_f32_f64(v64), v65);
  *a1[2].f32 = v55;
  *a1[4].f32 = vcvt_hight_f32_f64(vcvt_f32_f64(v68), v69);
  v56 = vcvt_hight_f32_f64(vcvt_f32_f64(v60), v61);
  *a5->f32 = vcvt_hight_f32_f64(vcvt_f32_f64(v58), v59);
  *a5[2].f32 = v56;
  *a5[4].f32 = vcvt_hight_f32_f64(vcvt_f32_f64(v62), v63);
  free(v71);
  return v54;
}

float vl_pose_irefine(__int128 *a1, void *a2, uint64_t a3, uint64_t a4, uint64_t a5, float32x2_t *a6, uint64_t a7, uint64_t a8, float a9)
{
  v14 = malloc_type_malloc(8 * *a2, 0x100004000313F17uLL);
  v15 = v14;
  v193 = a2;
  v16 = *a2;
  if (*a2 >= 1)
  {
    v17 = a2[1];
    if (v16 == 1)
    {
      v18 = 0;
LABEL_7:
      v23 = v16 - v18;
      v24 = &v14[8 * v18];
      v25 = (v17 + 288 * v18);
      do
      {
        *v24 = *v25;
        v24 += 8;
        v25 += 36;
        --v23;
      }

      while (v23);
      goto LABEL_9;
    }

    v18 = v16 & 0x7FFFFFFFFFFFFFFELL;
    v19 = v16 & 0x7FFFFFFFFFFFFFFELL;
    v20 = v14;
    v21 = a2[1];
    do
    {
      *&v22 = *v21;
      *(&v22 + 1) = v21[36];
      *v20++ = v22;
      v21 += 72;
      v19 -= 2;
    }

    while (v19);
    if (v16 != v18)
    {
      goto LABEL_7;
    }
  }

LABEL_9:
  v199[0] = 0x3D4CCCCD00000010;
  LODWORD(v199[1]) = 0;
  v26 = malloc_type_malloc(4 * v16, 0x100004052888210uLL);
  if (v16 < 1)
  {
    goto LABEL_16;
  }

  v27 = v16 & 0x7FFFFFFF;
  if (v27 < 8)
  {
    v28 = 0;
    do
    {
LABEL_15:
      v26->i32[v28] = v28;
      ++v28;
    }

    while (v27 != v28);
    goto LABEL_16;
  }

  v28 = v27 - (v16 & 7);
  v29 = xmmword_271103920;
  v30 = v26 + 1;
  v31.i64[0] = 0x400000004;
  v31.i64[1] = 0x400000004;
  v32.i64[0] = 0x800000008;
  v32.i64[1] = 0x800000008;
  v33 = v28;
  do
  {
    v30[-1] = v29;
    *v30 = vaddq_s32(v29, v31);
    v29 = vaddq_s32(v29, v32);
    v30 += 2;
    v33 -= 8;
  }

  while (v33);
  if ((v16 & 7) != 0)
  {
    goto LABEL_15;
  }

LABEL_16:
  v186 = rkd_create_ex(v15, v26, 2, v16, 0, v199);
  __b = malloc_type_malloc(4 * *a2, 0x100004052888210uLL);
  v34 = malloc_type_malloc(4 * *a2, 0x100004052888210uLL);
  v35 = *(a5 + 328);
  if (a8)
  {
    *a8 = 0;
    *(a8 + 24) = 0;
    *(a8 + 48) = 0;
    v36 = *(a8 + 16);
    if (v36 <= 31)
    {
      v37 = 2 * v36;
      if (v37 <= 32)
      {
        v38 = 32;
      }

      else
      {
        v38 = v37;
      }

      *(a8 + 8) = malloc_type_realloc(*(a8 + 8), 8 * v38, 0x100004000313F17uLL);
      *(a8 + 16) = v38;
    }

    v39 = *(a8 + 40);
    if (v39 <= 31)
    {
      v40 = 2 * v39;
      if (v40 <= 32)
      {
        v41 = 32;
      }

      else
      {
        v41 = v40;
      }

      *(a8 + 32) = malloc_type_realloc(*(a8 + 32), 12 * v41, 0x10000403E1C8BA9uLL);
      *(a8 + 40) = v41;
    }

    *v199 = *a8;
    v200 = *(a8 + 16);
    *v197 = *(a8 + 24);
    v198 = *(a8 + 40);
  }

  else
  {
    v42 = malloc_type_malloc(0x100uLL, 0x100004000313F17uLL);
    v199[0] = 0;
    v199[1] = v42;
    v200 = 32;
    v197[0] = 0;
    v197[1] = malloc_type_malloc(0x180uLL, 0x10000403E1C8BA9uLL);
    v198 = 32;
  }

  v43 = *a1;
  v44 = a1[2];
  *a6[2].f32 = a1[1];
  *a6[4].f32 = v44;
  *a6->f32 = v43;
  if (*(a5 + 372) >= 1)
  {
    v45 = 0;
    v175 = v34 + 1;
    v176 = a5;
    v46 = -0.5;
    v185 = v35 / a9;
    v177 = a6;
    v178 = a8;
    while (1)
    {
      v184 = v45;
      v48 = *(a3 + 8);
      v194 = *a3;
      v49 = *(a3 + 200);
      v50 = *(a3 + 216);
      v51 = *(a5 + 368);
      v205[0] = 8;
      v204 = malloc_type_malloc(0x20uLL, 0x100004052888210uLL);
      v54 = a6[5].f32[0];
      v53 = a6[5].f32[1];
      v55 = a6->f32[0];
      v56 = a6[3].f32[0];
      v189 = a6[3].f32[1];
      v190 = a6->f32[1];
      v57 = a6[1].f32[1];
      v58 = a6[2].f32[1];
      v187 = a6[2].f32[0];
      v188 = a6[1].f32[0];
      v59 = a6[4].f32[0];
      v60 = a6[4].f32[1];
      if (*v193 >= 1)
      {
        v181 = v51;
        v182 = a6[1].f32[1];
        v61 = a6[4].f32[0];
        v62 = a6[2].f32[1];
        v63 = a6[5].f32[0];
        v64 = a6[3].f32[0];
        v65 = a6->f32[0];
        v66 = a6[4].f32[1];
        memset(__b, 255, 4 * *v193);
        v60 = v66;
        v55 = v65;
        v56 = v64;
        v54 = v63;
        v58 = v62;
        v59 = v61;
        v51 = v181;
        v57 = v182;
      }

      v67 = *(a4 + 24);
      v68 = 0.5;
      if (v67 >= 1)
      {
        v69 = *(a4 + 32);
        *v52.i32 = v51 * v51;
        if (v67 > 8)
        {
          v71 = *(a4 + 24) & 7;
          if ((v67 & 7) == 0)
          {
            v71 = 8;
          }

          v70 = v67 - v71;
          v72 = vdupq_lane_s32(v52, 0);
          v73 = (v69 + 32);
          v74 = v70;
          v75 = v175;
          v76.i64[0] = 0xBF000000BF000000;
          v76.i64[1] = 0xBF000000BF000000;
          v77.i64[0] = 0x3F0000003F000000;
          v77.i64[1] = 0x3F0000003F000000;
          do
          {
            v78 = v73 - 8;
            v79 = vld2q_f32(v78);
            v80 = vld2q_f32(v73);
            v75[-1] = vcvtq_s32_f32(vmlaq_f32(vbslq_s8(vcgtzq_f32(vmulq_n_f32(v79, *v52.i32)), v77, v76), v72, v79));
            *v75 = vcvtq_s32_f32(vmlaq_f32(vbslq_s8(vcgtzq_f32(vmulq_n_f32(v80, *v52.i32)), v77, v76), v72, v80));
            v73 += 16;
            v75 += 2;
            v74 -= 8;
          }

          while (v74);
          v68 = 0.5;
        }

        else
        {
          v70 = 0;
        }

        v81 = v67 - v70;
        v82 = &v34->i32[v70];
        v83 = (v69 + 8 * v70);
        do
        {
          v84 = *v83;
          v83 += 2;
          v85 = v84;
          if ((*v52.i32 * v84) <= 0.0)
          {
            v86 = v46;
          }

          else
          {
            v86 = v68;
          }

          *v82++ = (v86 + (v85 * *v52.i32));
          --v81;
        }

        while (v81);
      }

      if (v194 >= 1)
      {
        v87 = ((v57 * v54) + (v55 * v60)) + (v56 * v53);
        v88 = ((v54 * v187) + (v190 * v60)) + (v189 * v53);
        v89 = ((v54 * v58) + (v188 * v60)) + (v59 * v53);
        if (v50 > 0)
        {
          v90 = 0;
          v91 = v50 & 0x7FFFFFE0;
          v92 = v50 & 0x7FFFFFFC;
          v93 = v49 + 2;
          while (1)
          {
            v94 = *v48;
            v95 = v48[1];
            v96 = v48[2];
            v97 = (((v57 * v95) + (v55 * *v48)) + (v56 * v96)) - v87;
            v201 = v97;
            if (v97 > 0.0)
            {
              v202 = ((((v187 * v95) + (v190 * v94)) + (v189 * v96)) - v88) * (1.0 / v97);
              v203 = ((((v58 * v95) + (v188 * v94)) + (v59 * v96)) - v89) * (1.0 / v97);
              v98 = v48;
              v99 = v34;
              v100 = v91;
              v101 = rkd_inside(v186, &v202, 0, &v204, v205, v185);
              v91 = v100;
              v34 = v99;
              v48 = v98;
              if (v101 > 0)
              {
                break;
              }
            }

LABEL_51:
            v49 = (v49 + v50);
            v48 += 3;
            ++v90;
            v93 = (v93 + v50);
            if (v90 == v194)
            {
              goto LABEL_78;
            }
          }

          v104 = 0;
          v105 = v204;
          v106 = v193[1];
          while (2)
          {
            v107 = v105[v104];
            v108 = v106 + 288 * v107 + 32;
            if (v50 < 4)
            {
              v109 = 0;
              v110 = 0;
              goto LABEL_67;
            }

            if (v50 >= 0x20)
            {
              v112 = 0uLL;
              v113 = 0uLL;
              v114 = (v106 + 48 + 288 * v107);
              v115 = v93;
              v116 = v91;
              v117 = 0uLL;
              v118 = 0uLL;
              v119 = 0uLL;
              v120 = 0uLL;
              v121 = 0uLL;
              v122 = 0uLL;
              do
              {
                v123 = *v115[-2].i8;
                v124 = *v114[-2].i8;
                v125 = vsubl_u8(*v123.i8, *v124.i8);
                v126 = vsubl_high_u8(v123, v124);
                v127 = vsubl_u8(*v115, *v114);
                v128 = vsubl_high_u8(*v115->i8, *v114->i8);
                v118 = vmlal_high_s16(v118, v126, v126);
                v117 = vmlal_s16(v117, *v126.i8, *v126.i8);
                v113 = vmlal_high_s16(v113, v125, v125);
                v112 = vmlal_s16(v112, *v125.i8, *v125.i8);
                v122 = vmlal_high_s16(v122, v128, v128);
                v121 = vmlal_s16(v121, *v128.i8, *v128.i8);
                v120 = vmlal_high_s16(v120, v127, v127);
                v119 = vmlal_s16(v119, *v127.i8, *v127.i8);
                v115 += 4;
                v114 += 4;
                v116 -= 32;
              }

              while (v116);
              v103 = vaddq_s32(v121, v117);
              v102 = vaddq_s32(vaddq_s32(v120, v113), vaddq_s32(v122, v118));
              v110 = vaddvq_s32(vaddq_s32(vaddq_s32(vaddq_s32(v119, v112), v103), v102));
              if (v91 != v50)
              {
                v111 = v91;
                v109 = v91;
                if ((v50 & 0x1C) == 0)
                {
                  goto LABEL_67;
                }

                goto LABEL_64;
              }
            }

            else
            {
              v110 = 0;
              v111 = 0;
LABEL_64:
              v129 = v110;
              do
              {
                v102.i32[0] = *(v49->i32 + v111);
                v103.i32[0] = *(v108 + v111);
                v103.i64[0] = vmovl_u8(*v103.i8).u64[0];
                v102 = vsubl_u16(*&vmovl_u8(*v102.i8), *v103.i8);
                v129 = vmlaq_s32(v129, v102, v102);
                v111 += 4;
              }

              while (v92 != v111);
              v110 = vaddvq_s32(v129);
              v109 = v50 & 0x7FFFFFFC;
              if (v92 != v50)
              {
                do
                {
LABEL_67:
                  v130 = v49->u8[v109] - *(v108 + v109);
                  v110 += v130 * v130;
                  ++v109;
                }

                while (v50 != v109);
              }
            }

            if (v110 <= v34->i32[v107])
            {
              v34->i32[v107] = v110;
              __b[v107] = v90;
            }

            if (++v104 == v101)
            {
              goto LABEL_51;
            }

            continue;
          }
        }

        for (i = 0; i != v194; ++i)
        {
          v132 = *v48;
          v133 = v48[1];
          v134 = v48[2];
          v135 = (((v57 * v133) + (v55 * *v48)) + (v56 * v134)) - v87;
          v201 = v135;
          if (v135 > 0.0)
          {
            v202 = ((((v187 * v133) + (v190 * v132)) + (v189 * v134)) - v88) * (1.0 / v135);
            v203 = ((((v58 * v133) + (v188 * v132)) + (v59 * v134)) - v89) * (1.0 / v135);
            v136 = rkd_inside(v186, &v202, 0, &v204, v205, v185);
            if (v136 >= 1)
            {
              v137 = v204;
              v138 = v136;
              do
              {
                v140 = *v137++;
                v139 = v140;
                if ((v34->i32[v140] & 0x80000000) == 0)
                {
                  v34->i32[v139] = 0;
                  __b[v139] = i;
                }

                --v138;
              }

              while (v138);
            }
          }

          v48 += 3;
        }
      }

LABEL_78:
      free(v204);
      v199[0] = 0;
      v197[0] = 0;
      a8 = v178;
      if (v178)
      {
        *(v178 + 48) = 0;
      }

      v141 = v193;
      v142 = __b;
      v46 = -0.5;
      if (*v193 < 1)
      {
        v146 = 0;
        v145 = 0;
      }

      else
      {
        v143 = 0;
        v144 = 0;
        v145 = 0;
        v146 = 0;
        v147 = v199[1];
        v148 = v200;
        v149 = v197[1];
        v150 = v198;
        do
        {
          if (v142[v144] != -1)
          {
            v152 = *(v141[1] + v143);
            v153 = v145 + 1;
            if (v145 >= v148)
            {
              v154 = 2 * v148;
              if (!v148)
              {
                v154 = 32;
              }

              if (v154 <= v145)
              {
                v148 = (v145 + 1);
              }

              else
              {
                v148 = v154;
              }

              if (v148)
              {
                v155 = v149;
                v147 = malloc_type_realloc(v147, 8 * v148, 0x100004000313F17uLL);
                v149 = v155;
                v142 = __b;
                v141 = v193;
              }
            }

            *(v147 + v145) = v152;
            v156 = (v146 + 1);
            if (v146 >= v150)
            {
              v157 = 2 * v150;
              if (!v150)
              {
                v157 = 21;
              }

              if (v157 <= v146)
              {
                v150 = v146 + 1;
              }

              else
              {
                v150 = v157;
              }

              if (v150)
              {
                v158 = v147;
                v159 = malloc_type_realloc(v149, 12 * v150, 0x10000403E1C8BA9uLL);
                v142 = __b;
                v141 = v193;
                v149 = v159;
                v147 = v158;
              }
            }

            v160 = *(a3 + 8) + 12 * v142[v144];
            v161 = *v160;
            v162 = &v149[12 * v146];
            *(v162 + 2) = *(v160 + 8);
            *v162 = v161;
            if (v178)
            {
              v163 = v142[v144];
              v164 = *(v178 + 48);
              v165 = *(v178 + 64);
              if (v164 >= v165)
              {
                v166 = 2 * v165;
                v167 = v165 == 0;
                v168 = 32;
                if (!v167)
                {
                  v168 = v166;
                }

                if (v168 <= v164)
                {
                  v169 = v164 + 1;
                }

                else
                {
                  v169 = v168;
                }

                if (v169)
                {
                  v195 = v147;
                  v191 = v153;
                  v170 = v149;
                  v171 = malloc_type_realloc(*(v178 + 56), 8 * v169, 0x100004000313F17uLL);
                  v149 = v170;
                  v153 = v191;
                  v141 = v193;
                  *(v178 + 56) = v171;
                  v147 = v195;
                  v142 = __b;
                  v164 = *(v178 + 48);
                }

                *(v178 + 64) = v169;
              }

              *(v178 + 48) = v164 + 1;
              v151 = (*(v178 + 56) + 8 * v164);
              *v151 = v163;
              v151[1] = v144;
            }

            v146 = v156;
            v145 = v153;
          }

          ++v144;
          v143 += 288;
        }

        while (*v141 > v144);
        v199[1] = v147;
        v200 = v148;
        v197[1] = v149;
        v198 = v150;
      }

      v199[0] = v145;
      v197[0] = v146;
      a5 = v176;
      a6 = v177;
      v47 = vl_pose_refine(v177, v199, v197, *(v176 + 364), v177, a7, *(v176 + 348) / a9, *(v176 + 356), *(v176 + 360));
      v45 = v184 + 1;
      if (v184 + 1 >= *(v176 + 372))
      {
        goto LABEL_114;
      }
    }
  }

  v47 = 0.0;
LABEL_114:
  v172 = v47;
  v173 = __b;
  if (!a8)
  {
    free(v199[1]);
    free(v197[1]);
    v173 = __b;
    if (!v186)
    {
      goto LABEL_117;
    }

    goto LABEL_116;
  }

  *a8 = *v199;
  *(a8 + 16) = v200;
  *(a8 + 24) = *v197;
  *(a8 + 40) = v198;
  if (v186)
  {
LABEL_116:
    free(*v186);
    free(v186[1]);
    free(v186[2]);
    free(v186);
    v173 = __b;
  }

LABEL_117:
  free(v173);
  free(v34);
  return v172;
}

uint64_t pqueue_push(void *a1, uint64_t a2, double a3)
{
  v3 = *(a1 + 10);
  v4 = *(a1 + 9);
  v5 = v4 + 1;
  if (*(a1 + 11))
  {
    v6 = v4 == v3 - 1;
  }

  else
  {
    v6 = 0;
  }

  if (v6)
  {
    v26 = v5 / 2;
    v24 = *a1;
    if (v5 / 2 <= v4)
    {
      v27 = &v24[3 * v26 + 1];
      v23 = -1;
      v28 = 1.79769313e308;
      do
      {
        v29 = *v27;
        v27 += 3;
        v30 = v29;
        if (v29 < v28)
        {
          v28 = v30;
          v23 = v26;
        }

        ++v26;
      }

      while (v5 != v26);
    }

    else
    {
      v23 = -1;
    }

    if (v24[3 * v23 + 1] >= a3)
    {
      return 0xFFFFFFFFLL;
    }

    v25 = v23;
  }

  else
  {
    *(a1 + 9) = v5;
    if (v5 >= v3)
    {
      *(a1 + 10) = 2 * v3;
      v7 = a1;
      v8 = a2;
      v9 = a3;
      v10 = malloc_type_realloc(*a1, 48 * v3, 0x1080040A085CBA5uLL);
      a2 = v8;
      a3 = v9;
      v11 = v10;
      a1 = v7;
      *v7 = v11;
    }

    if (*(a1 + 8))
    {
      v12 = a1[1];
      if (v12 >= 0x7FFFFFFF)
      {
        __assert_rtn("pqueue_push", "pqueue.c", 391, "da_size(&pq->supp_ind) < INT_MAX && pqueue has grown larger than can be indexed with a 32-bit integer");
      }

      v13 = *(a1 + 9);
      *(*a1 + 24 * v13 + 16) = v12;
      v14 = a1[3];
      if (v12 >= v14)
      {
        v15 = 2 * v14;
        v6 = v14 == 0;
        v16 = 64;
        if (!v6)
        {
          v16 = v15;
        }

        if (v16 <= v12)
        {
          v17 = v12 + 1;
        }

        else
        {
          v17 = v16;
        }

        if (v17)
        {
          v18 = a1;
          v19 = a2;
          v20 = a3;
          v21 = malloc_type_realloc(a1[2], 4 * v17, 0x100004052888210uLL);
          a2 = v19;
          a3 = v20;
          v22 = v21;
          a1 = v18;
          v18[2] = v22;
          v12 = v18[1];
          v13 = *(v18 + 9);
        }

        a1[3] = v17;
      }

      a1[1] = v12 + 1;
      *(a1[2] + 4 * v12) = v13;
    }

    v23 = *(a1 + 9);
    v24 = *a1;
    v25 = v23;
  }

  v31 = 3 * v25;
  *&v24[v31] = a2;
  v24[v31 + 1] = -1.79769313e308;
  if (a3 >= -1.79769313e308)
  {
    v32 = a1[2];
    v24[v31 + 1] = a3;
    if (v23 >= 2)
    {
      do
      {
        v35 = &v24[3 * (v23 >> 1)];
        v36 = &v24[3 * v23];
        if (v35[1] >= v36[1])
        {
          break;
        }

        v41 = *v36;
        v42 = *(v36 + 2);
        if (*(a1 + 8))
        {
          v37 = *(v36 + 4);
          v38 = *(v35 + 4);
          v39 = *(v32 + 4 * v37);
          *(v32 + 4 * v37) = *(v32 + 4 * v38);
          *(v32 + 4 * v38) = v39;
        }

        v33 = *v35;
        v36[2] = v35[2];
        *v36 = v33;
        *v35 = v41;
        *(v35 + 2) = v42;
        v34 = v23 > 3;
        v23 >>= 1;
      }

      while (v34);
    }
  }

  if (*(a1 + 8))
  {
    return (*(a1 + 2) - 1);
  }

  return 0xFFFFFFFFLL;
}

uint64_t pqueue_delete(void **a1, uint64_t a2, double *a3)
{
  v3 = *a1;
  v4 = *a1 + 24 * a2;
  v5 = *v4;
  v6 = *(v4 + 8);
  if (a3)
  {
    *a3 = v6;
  }

  v7 = &v3[24 * *(a1 + 9)];
  v8 = *v7;
  *(v4 + 16) = *(v7 + 2);
  *v4 = v8;
  if (*(a1 + 8))
  {
    *(a1[2] + *(v4 + 16)) = a2;
  }

  v9 = *(a1 + 9) - 1;
  *(a1 + 9) = v9;
  v10 = *(v4 + 8);
  if (v6 >= v10)
  {
    while (1)
    {
      v27 = a2;
      v28 = 2 * a2;
      v29 = *a1;
      v30 = a1[2];
      if (2 * a2 > v9 || (v31 = 2 * a2, *&v29[48 * a2 + 8] <= *&v29[24 * a2 + 8]))
      {
        v31 = a2;
      }

      if (v28 < v9 && *&v29[24 * (v28 | 1) + 8] > *&v29[24 * v31 + 8])
      {
        v31 = v28 | 1;
      }

      if (v31 == a2)
      {
        break;
      }

      v32 = &v29[24 * v31];
      v39 = *v32;
      v41 = *(v32 + 2);
      if (*(a1 + 8))
      {
        v22 = *(v32 + 4);
        v23 = *&v29[24 * a2 + 16];
        v24 = *&v30[4 * v22];
        *&v30[4 * v22] = *&v30[4 * v23];
        *&v30[4 * v23] = v24;
      }

      else
      {
        v27 = a2;
      }

      v25 = &v29[24 * v27];
      v26 = *v25;
      *(v32 + 2) = *(v25 + 2);
      *v32 = v26;
      *v25 = v39;
      *(v25 + 2) = v41;
      v9 = *(a1 + 9);
      a2 = v31;
    }
  }

  else
  {
    v11 = *a1;
    v12 = *a1 + 24 * a2;
    v14 = *(v12 + 8);
    v13 = (v12 + 8);
    if (v14 <= v10)
    {
      v15 = a1[2];
      *v13 = v10;
      if (a2 >= 2)
      {
        do
        {
          v17 = &v11[24 * (a2 >> 1)];
          v18 = &v11[24 * a2];
          if (*(v17 + 1) >= *(v18 + 1))
          {
            break;
          }

          v38 = *v18;
          v40 = *(v18 + 2);
          if (*(a1 + 8))
          {
            v19 = *(v18 + 4);
            v20 = *(v17 + 4);
            v21 = *&v15[4 * v19];
            *&v15[4 * v19] = *&v15[4 * v20];
            *&v15[4 * v20] = v21;
          }

          v16 = *v17;
          *(v18 + 2) = *(v17 + 2);
          *v18 = v16;
          *v17 = v38;
          *(v17 + 2) = v40;
          v36 = a2 > 3;
          LODWORD(a2) = a2 >> 1;
        }

        while (v36);
      }
    }
  }

  if (*(a1 + 11))
  {
    return v5;
  }

  v35 = *(a1 + 9);
  v34 = *(a1 + 10);
  v36 = v35 >= 17 && v35 < v34 / 4;
  if (!v36)
  {
    return v5;
  }

  *(a1 + 10) = v34 / 2;
  v37 = v5;
  *a1 = malloc_type_realloc(*a1, 24 * (v34 / 2), 0x1080040A085CBA5uLL);
  return v37;
}

void vl_match(uint64_t a1, uint64_t *a2, uint64_t *a3, uint64_t a4, uint64_t *a5, uint64_t a6, _DWORD *a7, uint64_t a8, uint64_t a9)
{
  v261 = 0;
  v262 = 0;
  v263 = 0;
  v16 = a7[3];
  if (v16)
  {
    v17 = v16 * *a2;
    v18 = malloc_type_malloc(8 * v17, 0x100004052888210uLL);
    if (*a7 != 2)
    {
      __assert_rtn("vl_match", "vl_match.c", 244, "par->method == VL_MATCH_METHOD_SSS && only SSS supports this");
    }

    v19 = &v18[4 * v17];
    v248 = v18;
    v256 = a9;
    v257 = v16;
    v252 = a7;
    if (*(a1 + 212))
    {
      goto LABEL_4;
    }
  }

  else
  {
    v19 = 0;
    v248 = 0;
    v256 = a9;
    v257 = a7[3];
    v252 = a7;
    if (*(a1 + 212))
    {
LABEL_4:
      *(a1 + 120) -= mach_absolute_time();
      goto LABEL_7;
    }
  }

  clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (a1 + 32));
  clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (a1 + 16));
  clock_gettime(_CLOCK_MONOTONIC, a1);
LABEL_7:
  LODWORD(v20) = vl_dump_detail_add_hash(v256, "vl_match input", a2, 0, a4).n128_u32[0];
  v21 = *(a4 + 216);
  v245 = *a3;
  v22 = *a2 * v21;
  v254 = a1;
  v255 = a8;
  v249 = *a2;
  if (v22 < 1)
  {
    __dst = 0;
    v243 = 0;
    if (*a2 < 1)
    {
      goto LABEL_16;
    }

    goto LABEL_14;
  }

  if (v22 <= 0x100)
  {
    v23 = 256;
  }

  else
  {
    v23 = *a2 * v21;
  }

  v24 = malloc_type_realloc(0, v23, 0x100004077774924uLL);
  v25 = *a2;
  v22 = *a2 * v21;
  __dst = v24;
  v262 = v24;
  v263 = v23;
  v243 = v23;
  if (v25 >= 1)
  {
LABEL_14:
    v26 = 0;
    v27 = 32;
    v28 = __dst;
    do
    {
      memcpy(v28, (a2[1] + v27), v21);
      ++v26;
      v27 += 288;
      v28 += v21;
    }

    while (v26 < *a2);
  }

LABEL_16:
  v29 = *a3;
  v30 = v22 + *a3 * v21;
  if (v30 > v243)
  {
    v31 = 2 * v243;
    if (!v243)
    {
      v31 = 256;
    }

    if (v31 <= v30)
    {
      v32 = v22 + *a3 * v21;
    }

    else
    {
      v32 = v31;
    }

    v33 = malloc_type_realloc(__dst, v32, 0x100004077774924uLL);
    v29 = *a3;
    v30 = v22 + *a3 * v21;
    __dst = v33;
    v262 = v33;
    v263 = v32;
  }

  v250 = v245 + v249;
  v246 = v30;
  v261 = v30;
  if (v29 >= 1)
  {
    v34 = 0;
    v35 = &__dst[v22];
    v36 = 12;
    do
    {
      memcpy(v35, (a3[1] + v36), v21);
      ++v34;
      v36 += 268;
      v35 += v21;
    }

    while (v34 < *a3);
  }

  v37 = v255;
  v38 = *v255;
  v39 = *(v255 + 16);
  v40 = v257;
  if (v250 > v39)
  {
    v53 = 2 * v39;
    v198 = v39 == 0;
    v54 = 32;
    if (!v198)
    {
      v54 = v53;
    }

    if (v54 <= v250)
    {
      v55 = v250;
    }

    else
    {
      v55 = v54;
    }

    if (v55)
    {
      *(v255 + 8) = malloc_type_realloc(*(v255 + 8), 8 * v55, 0x100004000313F17uLL);
    }

    *(v255 + 16) = v55;
    v41 = v250 - v38;
    if (v250 <= v38)
    {
LABEL_28:
      *v255 = v250;
      v42 = *(v255 + 24);
      v43 = *(v255 + 40);
      if (v250 <= v43)
      {
        goto LABEL_29;
      }

      goto LABEL_44;
    }
  }

  else
  {
    v41 = v250 - v38;
    if (v250 <= v38)
    {
      goto LABEL_28;
    }
  }

  bzero((*(v255 + 8) + 8 * *v255), 8 * v41);
  *v255 = v250;
  v42 = *(v255 + 24);
  v43 = *(v255 + 40);
  if (v250 <= v43)
  {
LABEL_29:
    v44 = v257;
    v45 = v250 - v42;
    v46 = v252;
    if (v250 <= v42)
    {
      goto LABEL_31;
    }

    goto LABEL_30;
  }

LABEL_44:
  v56 = 2 * v43;
  v198 = v43 == 0;
  v57 = 32;
  if (!v198)
  {
    v57 = v56;
  }

  if (v57 <= v250)
  {
    v58 = v250;
  }

  else
  {
    v58 = v57;
  }

  if (v58)
  {
    *(v255 + 32) = malloc_type_realloc(*(v255 + 32), 8 * v58, 0x100004000313F17uLL);
  }

  *(v255 + 40) = v58;
  v44 = v257;
  v45 = v250 - v42;
  v46 = v252;
  if (v250 > v42)
  {
LABEL_30:
    bzero((*(v255 + 32) + 8 * *(v255 + 24)), 8 * v45);
  }

LABEL_31:
  *(v255 + 24) = v250;
  v47 = *v46;
  v48 = v254;
  if (*v46 <= 1)
  {
    if (!v47)
    {
      v49 = *(a4 + 216);
      v50 = v254;
      v51 = a4;
      v52 = 0;
      goto LABEL_58;
    }

    if (v47 == 1)
    {
      v49 = *(a4 + 216);
      v50 = v254;
      v51 = a4;
      v52 = 1;
LABEL_58:
      vl_match_exhaustive(v20, v50, &v261, v51, v49, v52, v255);
      goto LABEL_74;
    }

    goto LABEL_56;
  }

  if (v47 == 2)
  {
    if (*(v254 + 428))
    {
      *(v254 + 336) -= mach_absolute_time();
      v59 = *a5;
      v60 = *(a4 + 216);
      if (v44)
      {
        goto LABEL_61;
      }
    }

    else
    {
      clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v254 + 248));
      clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v254 + 232));
      clock_gettime(_CLOCK_MONOTONIC, (v254 + 216));
      v59 = *a5;
      v60 = *(a4 + 216);
      if (v44)
      {
LABEL_61:
        v265 = 0u;
        memset(v266, 0, 28);
        v264 = 0u;
        sss_par_version(v46[1], &v264);
        if ((v246 / v60) >= 1)
        {
          v61 = v262;
          v62 = (255 * v60);
          v251 = (v246 / v60) & 0x7FFFFFFF;
          v63 = 0;
          if (v19)
          {
            v64 = 4 * v257;
            v65 = v248;
            v66 = v19;
            do
            {
              sss_knn(v59, &v264, v62, v61 + v63 * *(v59 + 260), v65, v66, v44);
              v61 = v262;
              ++v63;
              v66 += v64;
              v65 += v64;
            }

            while (v251 != v63);
          }

          else
          {
            v74 = v248;
            do
            {
              sss_knn(v59, &v264, v62, v61 + v63 * *(v59 + 260), v74, 0, v257);
              v61 = v262;
              ++v63;
              v74 += 4 * v257;
            }

            while (v251 != v63);
          }
        }

        v48 = v254;
        v37 = v255;
        v46 = v252;
        vl_timer_stop(v254 + 216);
        v40 = v257;
        if (*(v254 + 428))
        {
          goto LABEL_72;
        }

        goto LABEL_68;
      }
    }

    vl_match_sss(v254, &v261, a4, v59, v60, v46 + 1, v255);
    vl_timer_stop(v254 + 216);
    v40 = v257;
    if (*(v254 + 428))
    {
LABEL_72:
      printf("Verbose : ");
      printf("Total time for %40s : %7.3f ms");
      goto LABEL_73;
    }

LABEL_68:
    log_col_app("%s%s%s:%s%7.1fms%s", v67, v68, v69, v70, v71, v72, v73, &str_4_1);
    goto LABEL_74;
  }

  if (v47 != 3)
  {
LABEL_56:
    printf("%sError : ", "");
    printf("Unsupported match method %d");
    goto LABEL_73;
  }

  printf("Info : ");
  printf("Skipping feature matching (VL_MATCH_METHOD_NONE)");
LABEL_73:
  putchar(10);
LABEL_74:
  if (v44)
  {
    v75 = *(a6 + 252) * 3.14159265 / 180.0;
    v76 = tanf(v75);
    if (v40 <= 1)
    {
      __assert_rtn("vl_match_filter_prior", "vl_match.c", 149, "knn >= VL_MATCH_MAX_NN");
    }

    __dsta = v76;
    v267 = 0u;
    v268 = 0u;
    memset(v266, 0, sizeof(v266));
    v264 = 0u;
    v265 = 0u;
    g_coords_diff((a6 + 304), (a4 + 240), &v264);
    v77 = v268;
    v78 = v264;
    v79 = v266[1];
    v80 = *(&v265 + 1);
    v81 = *&v265;
    v83 = *(v266 + 1);
    v82 = *v266;
    v84 = *(&v267 + 1);
    v85 = *&v267;
    v86 = *a2;
    v87 = a2[1];
    if (*a2 >= 1)
    {
      v244 = *(&v267 + 1);
      v247 = *(&v265 + 1);
      v88 = v266[0];
      v89 = *a2 & 0x7FFFFFFF;
      do
      {
        v271[0] = vcvtq_f64_f32(*v87);
        v269 = 0;
        v270 = 0uLL;
        g_improj2_to_xyz(a6 + 24, v271, &v269);
        *v87 = vcvt_f32_f64(v270);
        v87 += 36;
        --v89;
      }

      while (v89);
      v86 = *a2;
      v87 = a2[1];
      v83 = *(&v88 + 1);
      v82 = *&v88;
      v84 = v244;
      v80 = v247;
    }

    if (v86 >= 1)
    {
      v90 = 0;
      v91 = v84;
      v95 = v80;
      v98 = v82;
      v101 = v83;
      v102 = v37[1];
      v103 = v37[4];
      v104 = 4 * v44;
      v106 = v248;
      v107 = v103;
      v108 = v102;
      do
      {
        v109 = 0;
        v110 = 0;
        v111 = &v87[36 * v90];
        do
        {
          v112 = *&v106[4 * v109];
          if (v109 <= 1)
          {
            *(v108 + 4 * v109) = v112;
            *(v107 + 4 * v109) = (255 * *(a4 + 216));
          }

          if (v112 != -1)
          {
            v113 = (*(a4 + 8) + 12 * v112);
            v114 = *v113 - v91;
            v92 = *&v77;
            v115 = v113[1] - v92;
            v93 = *(&v77 + 1);
            v116 = v113[2] - v93;
            v94 = *&v78;
            v96 = *&v79;
            v117 = ((v115 * v95) + (v94 * v114)) + (v96 * v116);
            v97 = *(&v78 + 1);
            v99 = *(&v79 + 1);
            v118 = ((v115 * v98) + (v97 * v114)) + (v99 * v116);
            v100 = v81;
            v105 = v85;
            v119 = ((v115 * v101) + (v100 * v114)) + (v105 * v116);
            v120 = *(a6 + 228);
            v122 = *v111;
            v121 = v111[1];
            v123 = 0.0;
            if (((((v117 * v121) - v119) * ((v117 * v121) - v119)) + (((*v111 * v117) - v118) * ((*v111 * v117) - v118))) > (v120 * v120))
            {
              if (v120 <= 1.0)
              {
                v124 = *(a6 + 228);
              }

              else
              {
                v124 = 1.0;
              }

              if (v117 >= 1.0)
              {
                v125 = v117;
              }

              else
              {
                v125 = v124;
              }

              v126 = sqrtf(((v122 * v122) + 1.0) + (v121 * v121));
              v123 = 0.0;
              v127 = 0.0;
              v128 = 0.0;
              v129 = 0.0;
              if (v126 > 0.0)
              {
                v127 = 1.0 / v126;
                v128 = v122 / v126;
                v129 = v121 / v126;
              }

              v130 = ((v118 * v128) + (v125 * v127)) + (v119 * v129);
              v131 = v128 * v130;
              v132 = v129 * v130;
              v133 = (v127 * v130) - v117;
              v134 = v131 - v118;
              v135 = v132 - v119;
              v136 = ((v134 * v134) + (v133 * v133)) + (v135 * v135);
              if (v136 > (v120 * v120))
              {
                v137 = v120 / sqrtf(v136);
                v123 = ((v121 - ((v119 + (v135 * v137)) / (v117 + (v133 * v137)))) * (v121 - ((v119 + (v135 * v137)) / (v117 + (v133 * v137))))) + ((v122 - ((v118 + (v134 * v137)) / (v117 + (v133 * v137)))) * (v122 - ((v118 + (v134 * v137)) / (v117 + (v133 * v137)))));
              }
            }

            if (v123 <= (__dsta * __dsta))
            {
              *(v102 + 8 * v90 + 4 * v110) = v112;
              *(v103 + 8 * v90 + 4 * v110++) = *&v19[4 * v109];
            }
          }

          ++v109;
        }

        while (v109 < v44 && v110 < 2);
        ++v90;
        v108 += 8;
        v107 += 8;
        v19 += v104;
        v106 += v104;
      }

      while (v90 != v86);
    }

    if (v86 >= 1)
    {
      v138 = v86 & 0x7FFFFFFF;
      do
      {
        v271[0] = 0uLL;
        v269 = 0x3FF0000000000000;
        v270 = vcvtq_f64_f32(*v87);
        g_xyz_to_improj2(a6 + 24, &v269, v271[0].f64, 0);
        *v87 = vcvt_f32_f64(v271[0]);
        v87 += 36;
        --v138;
      }

      while (v138);
    }

    v46 = v252;
    v48 = v254;
  }

  vl_dump_detail_match(v256, v37);
  if (*(v46 + 2) > 0.0)
  {
    if (*(v48 + 644))
    {
      *(v48 + 552) -= mach_absolute_time();
    }

    else
    {
      clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v48 + 464));
      clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v48 + 448));
      clock_gettime(_CLOCK_MONOTONIC, (v48 + 432));
    }

    v139 = *(v46 + 2);
    if (v139 <= 0.0)
    {
      goto LABEL_227;
    }

    v140 = *a4;
    v141 = *a2;
    v142 = malloc_type_calloc(*a2, 1uLL, 0x100004077774924uLL);
    v253 = v140;
    __dstb = malloc_type_calloc(v140, 0x18uLL, 0x1010040A500212DuLL);
    if (v141 >= 1)
    {
      v143 = 0;
      v144 = 0;
      v145 = v141 & 0x7FFFFFFF;
      do
      {
        v146 = *(v37[1] + v143);
        if (v146 != -1)
        {
          v147 = &__dstb[3 * v146];
          v148 = *v147;
          v149 = v147[2];
          if (*v147 >= v149)
          {
            if (v149)
            {
              v150 = 2 * v149;
            }

            else
            {
              v150 = 64;
            }

            if (v150 <= v148)
            {
              v151 = v148 + 1;
            }

            else
            {
              v151 = v150;
            }

            if (v151)
            {
              v147[1] = malloc_type_realloc(v147[1], 4 * v151, 0x100004052888210uLL);
              v148 = *v147;
            }

            v147[2] = v151;
            v37 = v255;
          }

          *v147 = (v148 + 1);
          *(v147[1] + v148) = v144;
        }

        ++v144;
        v143 += 8;
      }

      while (v145 != v144);
    }

    if (v253 >= 1)
    {
      v152 = 0;
      v153 = v139 * v139;
      while (1)
      {
        v154 = &__dstb[3 * v152];
        v155 = *v154;
        if (*v154 >= 2)
        {
          break;
        }

LABEL_129:
        if (++v152 == (v253 & 0x7FFFFFFF))
        {
          goto LABEL_164;
        }
      }

      while (1)
      {
        v156 = a2[1];
        v157 = v154[1];
        v158 = (v156 + 288 * *v157);
        v159 = 1;
        v160 = 1;
        v161 = v158[1];
        v162 = *v158;
        do
        {
          v163 = (v156 + 288 * v157[v159]);
          v164 = v163[1];
          v165 = ((v158[1] - v164) * (v158[1] - v164)) + ((*v158 - *v163) * (*v158 - *v163));
          v166 = v161 + v164;
          if (v165 <= v153)
          {
            v162 = v162 + *v163;
            v161 = v166;
            ++v160;
          }

          ++v159;
        }

        while (v155 != v159);
        v167 = v162 / v160;
        v168 = v161 / v160;
        *v158 = v167;
        v158[1] = v168;
        v169 = 1;
        v170 = 1;
        v171 = v168;
        v172 = v167;
        do
        {
          v173 = (v156 + 288 * v157[v169]);
          v174 = v173[1];
          v175 = ((v168 - v174) * (v168 - v174)) + ((v167 - *v173) * (v167 - *v173));
          v176 = v171 + v174;
          if (v175 <= v153)
          {
            v172 = v172 + *v173;
            v171 = v176;
            ++v170;
          }

          ++v169;
        }

        while (v155 != v169);
        v177 = v172 / v170;
        v178 = v171 / v170;
        *v158 = v177;
        v158[1] = v178;
        v179 = v155;
        v180 = 1;
        do
        {
          v181 = *(v154[1] + v180);
          v182 = (a2[1] + 288 * v181);
          if ((((v158[1] - v182[1]) * (v158[1] - v182[1])) + ((*v158 - *v182) * (*v158 - *v182))) <= v153)
          {
            v142[v181] = 1;
            v179 = *v154;
          }

          ++v180;
        }

        while (v179 > v180);
        *v158 = v177;
        v158[1] = v178;
        if (v179 >= 1)
        {
          v155 = 0;
          v188 = v179 - 1;
          if (v179 != 1)
          {
            v189 = v154[1];
            v190 = v189 + 1;
            do
            {
              v192 = *v190++;
              v191 = v192;
              if (!v142[v192])
              {
                v189[v155++] = v191;
              }

              --v188;
            }

            while (v188);
          }
        }

        else
        {
          v155 = 0;
        }

        v183 = v154[2];
        if (v155 > v183)
        {
          break;
        }

        v184 = v155 - v179;
        if (v155 > v179)
        {
          goto LABEL_158;
        }

LABEL_132:
        *v154 = v155;
        if (v155 <= 1)
        {
          goto LABEL_129;
        }
      }

      v185 = 2 * v183;
      v198 = v183 == 0;
      v186 = 64;
      if (!v198)
      {
        v186 = v185;
      }

      if (v186 <= v155)
      {
        v187 = v155;
      }

      else
      {
        v187 = v186;
      }

      if (v187)
      {
        v154[1] = malloc_type_realloc(v154[1], 4 * v187, 0x100004052888210uLL);
      }

      v154[2] = v187;
      v184 = v155 - v179;
      if (v155 <= v179)
      {
        goto LABEL_132;
      }

LABEL_158:
      bzero(v154[1] + 4 * *v154, 4 * v184);
      goto LABEL_132;
    }

LABEL_164:
    v193 = *a2;
    if (*a2 < 1)
    {
      v196 = 0;
      v37 = v255;
    }

    else
    {
      v194 = 0;
      v195 = 0;
      v196 = 0;
      v37 = v255;
      do
      {
        v197 = a2[1];
        if (v142[v195])
        {
          v198 = 1;
        }

        else
        {
          v198 = v197 == 0;
        }

        if (!v198)
        {
          memcpy((v197 + 288 * v196++), (v197 + v194), 0x120uLL);
          v193 = *a2;
        }

        ++v195;
        v194 += 288;
      }

      while (v195 < v193);
    }

    v199 = a2[2];
    if (v196 > v199)
    {
      v202 = 2 * v199;
      if (v202 <= v196)
      {
        v203 = v196;
      }

      else
      {
        v203 = v202;
      }

      if (v203)
      {
        a2[1] = malloc_type_realloc(a2[1], 288 * v203, 0x1000040A8CFB95EuLL);
      }

      a2[2] = v203;
      v200 = v196 - v193;
      if (v196 <= v193)
      {
LABEL_175:
        *a2 = v196;
        v201 = v37[3];
        if (v201 < 1)
        {
          goto LABEL_191;
        }

        goto LABEL_184;
      }
    }

    else
    {
      v200 = v196 - v193;
      if (v196 <= v193)
      {
        goto LABEL_175;
      }
    }

    bzero((a2[1] + 288 * *a2), 288 * v200);
    *a2 = v196;
    v201 = v37[3];
    if (v201 < 1)
    {
      goto LABEL_191;
    }

LABEL_184:
    v204 = v37[4];
    if (v204)
    {
      v205 = 0;
      v206 = 0;
      v207 = 2 * v201;
      if (2 * v201 <= 1)
      {
        v207 = 1;
      }

      do
      {
        if (!v142[v205 >> 1])
        {
          *(v204 + 4 * v206++) = *(v204 + 4 * v205);
        }

        ++v205;
      }

      while (v207 != v205);
    }

LABEL_191:
    v208 = v37[5];
    if (v196 > v208)
    {
      v212 = 2 * v208;
      v198 = v208 == 0;
      v213 = 32;
      if (!v198)
      {
        v213 = v212;
      }

      if (v213 <= v196)
      {
        v214 = v196;
      }

      else
      {
        v214 = v213;
      }

      if (v214)
      {
        v37[4] = malloc_type_realloc(v37[4], 8 * v214, 0x100004000313F17uLL);
      }

      v37[5] = v214;
      v209 = v196 - v201;
      if (v196 <= v201)
      {
LABEL_193:
        v210 = *a2;
        v37[3] = *a2;
        v211 = *v37;
        if (*v37 < 1)
        {
          goto LABEL_211;
        }

        goto LABEL_204;
      }
    }

    else
    {
      v209 = v196 - v201;
      if (v196 <= v201)
      {
        goto LABEL_193;
      }
    }

    bzero((v37[4] + 8 * v37[3]), 8 * v209);
    v210 = *a2;
    v37[3] = *a2;
    v211 = *v37;
    if (*v37 < 1)
    {
      goto LABEL_211;
    }

LABEL_204:
    v215 = v37[1];
    if (v215)
    {
      v216 = 0;
      v217 = 0;
      v218 = 2 * v211;
      if (2 * v211 <= 1)
      {
        v218 = 1;
      }

      do
      {
        if (!v142[v217 >> 1])
        {
          *(v215 + 4 * v216++) = *(v215 + 4 * v217);
        }

        ++v217;
      }

      while (v218 != v217);
    }

LABEL_211:
    v219 = v37[2];
    if (v210 > v219)
    {
      v222 = 2 * v219;
      v198 = v219 == 0;
      v223 = 32;
      if (!v198)
      {
        v223 = v222;
      }

      if (v223 <= v210)
      {
        v224 = v210;
      }

      else
      {
        v224 = v223;
      }

      if (v224)
      {
        v37[1] = malloc_type_realloc(v37[1], 8 * v224, 0x100004000313F17uLL);
      }

      v37[2] = v224;
      v220 = v210 - v211;
      if (v210 <= v211)
      {
LABEL_213:
        *v37 = *a2;
        v221 = v253;
        if (v253 < 1)
        {
          goto LABEL_226;
        }

        goto LABEL_224;
      }
    }

    else
    {
      v220 = v210 - v211;
      if (v210 <= v211)
      {
        goto LABEL_213;
      }
    }

    bzero((v37[1] + 8 * *v37), 8 * v220);
    *v37 = *a2;
    v221 = v253;
    if (v253 < 1)
    {
LABEL_226:
      free(__dstb);
      free(v142);
      v48 = v254;
LABEL_227:
      vl_timer_stop(v48 + 432);
      if (*(v48 + 644))
      {
        printf("Verbose : ");
        printf("Total time for %40s : %7.3f ms", (v48 + 580), *(v48 + 552) * 0.000001);
        putchar(10);
      }

      else
      {
        log_col_app("%s%s%s:%s%7.1fms%s", v228, v229, v230, v231, v232, v233, v234, &str_4_1);
      }

      goto LABEL_230;
    }

LABEL_224:
    v225 = v221 & 0x7FFFFFFF;
    v226 = __dstb + 1;
    do
    {
      v227 = *v226;
      v226 += 3;
      free(v227);
      --v225;
    }

    while (v225);
    goto LABEL_226;
  }

LABEL_230:
  vl_dump_detail_add_hash(v256, "vl_match output", a2, v37, a4);
  printf("Verbose : ");
  printf("MATCH: Found %s%llu%s matches", "", *v37, "");
  putchar(10);
  vl_timer_stop(v48);
  if (*(v48 + 212))
  {
    printf("Verbose : ");
    printf("Total time for %40s : %7.3f ms", (v48 + 148), *(v48 + 120) * 0.000001);
    putchar(10);
  }

  else
  {
    log_col_app("%s%s%s:%s%7.1fms%s", v235, v236, v237, v238, v239, v240, v241, &str_4_1);
  }

  free(v262);
  free(v248);
}

uint64_t vl_desc_cluster_similar(uint8x8_t *a1, int a2, int a3, int *a4, int a5, int a6)
{
  v120 = 0;
  v121 = 0x3DCCCCCD3F800000;
  v119[0] = xmmword_271105740;
  v119[1] = xmmword_271105750;
  v122 = xmmword_271105760;
  ids = sss_create_ids(a1, 0, a2, a3, v119);
  v10 = malloc_type_malloc(32 * a3, 0x100004052888210uLL);
  v107 = v10;
  v118 = a3;
  v101 = a3;
  if (a3 < 1)
  {
    v18 = 0;
  }

  else
  {
    v11 = 0;
    v12 = v10;
    do
    {
      sss_knn(ids, v119, a5, a1 + v11 * ids[65], v12, 0, 8);
      ++v11;
      v12 += 32;
    }

    while (a3 != v11);
    memset(a4, 255, 4 * a3);
    v15 = a6;
    if (a6 > 0)
    {
      v16 = 0;
      v17 = 0;
      v18 = 0;
      v19 = a2;
      v20 = a2 & 0xF;
      v21 = a2 >> 4;
      v22 = a5 * a5;
      v23 = a2 & 0x7FFFFFE0;
      v25 = a1;
      v24 = v107;
      v102 = a2 & 0x7FFFFFFC;
      v26 = 0uLL;
      v27 = a1;
      v28 = a1 + 2;
      v103 = a5 * a5;
      while ((a4[v16] & 0x80000000) == 0)
      {
LABEL_6:
        ++v16;
        v28 = (v28 + a2);
        v27 = (v27 + a2);
        if (v16 == v118)
        {
          goto LABEL_139;
        }
      }

      v116 = v28;
      v117 = v16;
      if (v17 <= 0)
      {
        if (v17)
        {
          v29 = 1;
        }

        else
        {
          v29 = 64;
        }

        v18 = malloc_type_realloc(v18, 4 * v29, 0x100004052888210uLL);
        v17 = v29;
        v28 = v116;
        v16 = v117;
        v26 = 0uLL;
        v23 = a2 & 0x7FFFFFE0;
        v22 = v103;
        v20 = a2 & 0xF;
        v25 = a1;
        v24 = v107;
        v19 = a2;
        v15 = a6;
      }

      v30 = 0;
      *v18 = v16;
      v31 = -2 - v16;
      v32 = 1;
      v108 = -2 - v16;
      while (1)
      {
        v33 = v32 - 1;
        v34 = v18[v32 - 1];
        if ((v34 & 0x80000000) != 0 || (v35 = a4[v34], (v35 & 0x80000000) == 0))
        {
LABEL_16:
          --v32;
          goto LABEL_17;
        }

        if (v35 == v31)
        {
          goto LABEL_6;
        }

        a4[v34] = v31;
        v36 = v34 * v19;
        v37 = v25 + v36;
        if (v20)
        {
          if (v19 < 1)
          {
            goto LABEL_42;
          }

          if (v19 < 4)
          {
            v38 = 0;
            v39 = 0;
            do
            {
LABEL_40:
              v70 = v27->u8[v38] - v37[v38];
              v39 += v70 * v70;
              ++v38;
            }

            while (a2 != v38);
            goto LABEL_41;
          }

          if (v19 >= 0x20)
          {
            v47 = 0uLL;
            v48 = (a1 + v36 + 16);
            v49 = 0uLL;
            v50 = v23;
            v51 = v28;
            v52 = 0uLL;
            v53 = 0uLL;
            v54 = 0uLL;
            v55 = 0uLL;
            v56 = 0uLL;
            v57 = 0uLL;
            do
            {
              v58 = *v51[-2].i8;
              v59 = *v48[-2].i8;
              v60 = vsubl_u8(*v58.i8, *v59.i8);
              v61 = vsubl_high_u8(v58, v59);
              v62 = vsubl_u8(*v51, *v48);
              v63 = vsubl_high_u8(*v51->i8, *v48->i8);
              v53 = vmlal_high_s16(v53, v61, v61);
              v52 = vmlal_s16(v52, *v61.i8, *v61.i8);
              v49 = vmlal_high_s16(v49, v60, v60);
              v47 = vmlal_s16(v47, *v60.i8, *v60.i8);
              v57 = vmlal_high_s16(v57, v63, v63);
              v56 = vmlal_s16(v56, *v63.i8, *v63.i8);
              v55 = vmlal_high_s16(v55, v62, v62);
              v54 = vmlal_s16(v54, *v62.i8, *v62.i8);
              v51 += 4;
              v48 += 4;
              v50 -= 32;
            }

            while (v50);
            v14 = vaddq_s32(v56, v52);
            v13 = vaddq_s32(vaddq_s32(v55, v49), vaddq_s32(v57, v53));
            v39 = vaddvq_s32(vaddq_s32(vaddq_s32(vaddq_s32(v54, v47), v14), v13));
            if (v23 == a2)
            {
              goto LABEL_41;
            }

            v46 = v23;
            v38 = v23;
            if ((a2 & 0x1C) == 0)
            {
              goto LABEL_40;
            }
          }

          else
          {
            v39 = 0;
            v46 = 0;
          }

          v64 = v39;
          v65 = (v27 + v46);
          v66 = (v25 + v46 + v36);
          v67 = v46 - v102;
          do
          {
            v68 = *v65++;
            v13.i32[0] = v68;
            v69 = *v66++;
            v14.i32[0] = v69;
            v14.i64[0] = vmovl_u8(*v14.i8).u64[0];
            v13 = vsubl_u16(*&vmovl_u8(*v13.i8), *v14.i8);
            v64 = vmlaq_s32(v64, v13, v13);
            v67 += 4;
          }

          while (v67);
          v39 = vaddvq_s32(v64);
          v38 = a2 & 0x7FFFFFFC;
          if (v102 != a2)
          {
            goto LABEL_40;
          }
        }

        else
        {
          if (v21 < 1)
          {
            v41 = 0uLL;
          }

          else
          {
            v40 = 0;
            v41 = 0uLL;
            do
            {
              v42 = *v27[2 * v40].i8;
              v43 = *&v37[16 * v40];
              v44 = vabdq_u16(vzip1q_s8(v42, v26), vzip1q_s8(v43, v26));
              v45 = vabdq_u16(vzip2q_s8(v42, v26), vzip2q_s8(v43, v26));
              v14 = vmulq_s16(v44, v44);
              v13 = vmulq_s16(v45, v45);
              v41 = vpadalq_u16(vpadalq_u16(v41, v14), v13);
              ++v40;
            }

            while (v21 != v40);
          }

          v39 = vaddvq_s32(v41);
        }

LABEL_41:
        if (v39 > v22)
        {
          goto LABEL_16;
        }

LABEL_42:
        a4[v34] = v16;
        ++v30;
        v71 = (8 * v34);
        v72 = v24[v71];
        if (v72 == v34)
        {
          --v32;
          v73 = &v24[v71];
          v74 = v73[1];
          if (v74 == v34)
          {
            goto LABEL_44;
          }

          goto LABEL_60;
        }

        if (v72 < 0)
        {
          goto LABEL_16;
        }

        if (v32 <= v17)
        {
          goto LABEL_59;
        }

        v81 = 2 * v17;
        if (!v17)
        {
          v81 = 64;
        }

        if (v81 <= v32)
        {
          v81 = v32;
        }

        if (v81)
        {
          v109 = v81;
          v18 = malloc_type_realloc(v18, 4 * v81, 0x100004052888210uLL);
          v31 = v108;
          v17 = v109;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_59:
          v18[v33] = v72;
          v73 = &v24[v71];
          v74 = v73[1];
          if (v74 == v34)
          {
            goto LABEL_44;
          }

          goto LABEL_60;
        }

        v17 = 0;
        v18[v33] = v72;
        v73 = &v24[v71];
        v74 = v73[1];
        if (v74 == v34)
        {
LABEL_44:
          v75 = v73[2];
          if (v75 == v34)
          {
            goto LABEL_45;
          }

          goto LABEL_69;
        }

LABEL_60:
        if (v74 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_68;
        }

        v82 = 2 * v17;
        if (!v17)
        {
          v82 = 64;
        }

        if (v82 <= v32)
        {
          v82 = v32 + 1;
        }

        if (v82)
        {
          v110 = v82;
          v18 = malloc_type_realloc(v18, 4 * v82, 0x100004052888210uLL);
          v31 = v108;
          v17 = v110;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_68:
          v18[v32++] = v74;
          v75 = v73[2];
          if (v75 == v34)
          {
            goto LABEL_45;
          }

          goto LABEL_69;
        }

        v17 = 0;
        v18[v32++] = v74;
        v75 = v73[2];
        if (v75 == v34)
        {
LABEL_45:
          v76 = v73[3];
          if (v76 == v34)
          {
            goto LABEL_46;
          }

          goto LABEL_78;
        }

LABEL_69:
        if (v75 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_77;
        }

        v83 = 2 * v17;
        if (!v17)
        {
          v83 = 64;
        }

        if (v83 <= v32)
        {
          v83 = v32 + 1;
        }

        if (v83)
        {
          v111 = v83;
          v18 = malloc_type_realloc(v18, 4 * v83, 0x100004052888210uLL);
          v31 = v108;
          v17 = v111;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_77:
          v18[v32++] = v75;
          v76 = v73[3];
          if (v76 == v34)
          {
            goto LABEL_46;
          }

          goto LABEL_78;
        }

        v17 = 0;
        v18[v32++] = v75;
        v76 = v73[3];
        if (v76 == v34)
        {
LABEL_46:
          v77 = v73[4];
          if (v77 == v34)
          {
            goto LABEL_47;
          }

          goto LABEL_87;
        }

LABEL_78:
        if (v76 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_86;
        }

        v84 = 2 * v17;
        if (!v17)
        {
          v84 = 64;
        }

        if (v84 <= v32)
        {
          v84 = v32 + 1;
        }

        if (v84)
        {
          v112 = v84;
          v18 = malloc_type_realloc(v18, 4 * v84, 0x100004052888210uLL);
          v31 = v108;
          v17 = v112;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_86:
          v18[v32++] = v76;
          v77 = v73[4];
          if (v77 == v34)
          {
            goto LABEL_47;
          }

          goto LABEL_87;
        }

        v17 = 0;
        v18[v32++] = v76;
        v77 = v73[4];
        if (v77 == v34)
        {
LABEL_47:
          v78 = v73[5];
          if (v78 == v34)
          {
            goto LABEL_48;
          }

          goto LABEL_96;
        }

LABEL_87:
        if (v77 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_95;
        }

        v85 = 2 * v17;
        if (!v17)
        {
          v85 = 64;
        }

        if (v85 <= v32)
        {
          v85 = v32 + 1;
        }

        if (v85)
        {
          v113 = v85;
          v18 = malloc_type_realloc(v18, 4 * v85, 0x100004052888210uLL);
          v31 = v108;
          v17 = v113;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_95:
          v18[v32++] = v77;
          v78 = v73[5];
          if (v78 == v34)
          {
            goto LABEL_48;
          }

          goto LABEL_96;
        }

        v17 = 0;
        v18[v32++] = v77;
        v78 = v73[5];
        if (v78 == v34)
        {
LABEL_48:
          v79 = v73[6];
          if (v79 == v34)
          {
            goto LABEL_49;
          }

          goto LABEL_105;
        }

LABEL_96:
        if (v78 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_104;
        }

        v86 = 2 * v17;
        if (!v17)
        {
          v86 = 64;
        }

        if (v86 <= v32)
        {
          v86 = v32 + 1;
        }

        if (v86)
        {
          v114 = v86;
          v18 = malloc_type_realloc(v18, 4 * v86, 0x100004052888210uLL);
          v31 = v108;
          v17 = v114;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_104:
          v18[v32++] = v78;
          v79 = v73[6];
          if (v79 == v34)
          {
            goto LABEL_49;
          }

          goto LABEL_105;
        }

        v17 = 0;
        v18[v32++] = v78;
        v79 = v73[6];
        if (v79 == v34)
        {
LABEL_49:
          v80 = v73[7];
          if (v80 != v34)
          {
            goto LABEL_114;
          }

          goto LABEL_17;
        }

LABEL_105:
        if (v79 < 0)
        {
          goto LABEL_17;
        }

        if (v32 < v17)
        {
          goto LABEL_113;
        }

        v87 = 2 * v17;
        if (!v17)
        {
          v87 = 64;
        }

        if (v87 <= v32)
        {
          v87 = v32 + 1;
        }

        if (v87)
        {
          v115 = v87;
          v18 = malloc_type_realloc(v18, 4 * v87, 0x100004052888210uLL);
          v31 = v108;
          v17 = v115;
          v28 = v116;
          v26 = 0uLL;
          v23 = a2 & 0x7FFFFFE0;
          v22 = v103;
          v20 = a2 & 0xF;
          v16 = v117;
          v25 = a1;
          v24 = v107;
          v19 = a2;
          v15 = a6;
LABEL_113:
          v18[v32++] = v79;
          v80 = v73[7];
          if (v80 != v34)
          {
            goto LABEL_114;
          }

          goto LABEL_17;
        }

        v17 = 0;
        v18[v32++] = v79;
        v80 = v73[7];
        if (v80 != v34)
        {
LABEL_114:
          if ((v80 & 0x80000000) == 0)
          {
            if (v32 >= v17)
            {
              v88 = 2 * v17;
              if (!v17)
              {
                v88 = 64;
              }

              if (v88 <= v32)
              {
                v88 = v32 + 1;
              }

              if (v88)
              {
                v89 = v88;
                v18 = malloc_type_realloc(v18, 4 * v88, 0x100004052888210uLL);
                v31 = v108;
                v17 = v89;
                v28 = v116;
                v16 = v117;
                v26 = 0uLL;
                v23 = a2 & 0x7FFFFFE0;
                v22 = v103;
                v20 = a2 & 0xF;
                v25 = a1;
                v24 = v107;
                v19 = a2;
                v15 = a6;
              }

              else
              {
                v17 = 0;
              }
            }

            v18[v32++] = v80;
          }
        }

LABEL_17:
        if (!v32 || v30 >= v15)
        {
          goto LABEL_6;
        }
      }
    }

    v99 = 0;
    v100 = 0;
    v18 = 0;
    do
    {
      while (1)
      {
        while ((a4[v99] & 0x80000000) == 0)
        {
          if (a3 == ++v99)
          {
            goto LABEL_139;
          }
        }

        if (v100 <= 0)
        {
          break;
        }

        *v18 = v99++;
        if (a3 == v99)
        {
          goto LABEL_139;
        }
      }

      v18 = malloc_type_realloc(v18, 0x100uLL, 0x100004052888210uLL);
      v100 = 64;
      *v18 = v99++;
    }

    while (a3 != v99);
  }

LABEL_139:
  free(v18);
  v90 = malloc_type_malloc(4 * v101, 0x100004052888210uLL);
  if (v101 < 1)
  {
    v92 = 0;
  }

  else
  {
    v91 = 0;
    LODWORD(v92) = 0;
    v93 = v118;
    do
    {
      v94 = a4[v91];
      v95 = v91 == v94;
      if (v91 == v94)
      {
        v96 = v92;
      }

      else
      {
        v96 = -1;
      }

      if (v95)
      {
        v92 = (v92 + 1);
      }

      else
      {
        v92 = v92;
      }

      v90[v91++] = v96;
    }

    while (v118 != v91);
    do
    {
      *a4 = v90[*a4];
      ++a4;
      --v93;
    }

    while (v93);
  }

  free(v90);
  printf("Verbose : ");
  printf("Clustered descriptors: %d => %d (%.1f%%)\n", v101, v92, v92 * 100.0 / v101);
  putchar(10);
  if (ids)
  {
    if (ids[64] >= 1)
    {
      v97 = 0;
      do
      {
        sss_node_free(*&ids[2 * v97]);
        free(*(*&ids[2 * v97] + 32));
        free(*(*&ids[2 * v97] + 40));
        free(*&ids[2 * v97++]);
      }

      while (v97 < ids[64]);
    }

    free(ids);
  }

  free(v107);
  return v92;
}

void vl_desc_cluster_centroids(unint64_t a1, unsigned int a2, int a3, char *a4, int *a5, int a6)
{
  LODWORD(v6) = a6;
  v12 = malloc_type_calloc(a3, 4uLL, 0x100004052888210uLL);
  v13 = malloc_type_calloc((v6 * a2), 4uLL, 0x100004052888210uLL);
  if (a3 >= 1)
  {
    if (a2 > 0)
    {
      v15 = 0;
      v16 = a2 & 0x7FFFFFFC;
      v17 = a1;
      while (1)
      {
        v18 = a5[v15];
        ++v12[v18];
        v19 = v18 * a2;
        v20 = &v13[4 * (v18 * a2)];
        if (a2 >= 4)
        {
          if (v20 < a1 + a3 * a2 && &v13[4 * a2 + 4 * v19] > a1)
          {
            v21 = 0;
          }

          else
          {
            if (a2 < 0x10)
            {
              v23 = 0;
LABEL_18:
              v33 = &v13[4 * v23 + 4 * v19];
              do
              {
                v14.i32[0] = *(v17->i32 + v23);
                v14 = vaddw_u16(*v33, *&vmovl_u8(*v14.i8));
                *v33++ = v14;
                v23 += 4;
              }

              while (v16 != v23);
              v21 = a2 & 0x7FFFFFFC;
              if (v16 == a2)
              {
                goto LABEL_4;
              }

              goto LABEL_21;
            }

            v24 = a2 & 0x7FFFFFF0;
            v25 = &v13[4 * v19];
            v26 = v17;
            do
            {
              v27 = *v26++;
              v28 = vmovl_high_u8(v27);
              v29 = vmovl_u8(*v27.i8);
              v30 = vaddw_u16(*v25, *v29.i8);
              v14 = vaddw_high_u16(v25[1], v29);
              v31 = vaddw_u16(v25[2], *v28.i8);
              v32 = vaddw_high_u16(v25[3], v28);
              v25[2] = v31;
              v25[3] = v32;
              *v25 = v30;
              v25[1] = v14;
              v25 += 4;
              v24 -= 16;
            }

            while (v24);
            if ((a2 & 0x7FFFFFF0) == a2)
            {
              goto LABEL_4;
            }

            v23 = a2 & 0x7FFFFFF0;
            v21 = v23;
            if ((a2 & 0xC) != 0)
            {
              goto LABEL_18;
            }
          }
        }

        else
        {
          v21 = 0;
        }

        do
        {
LABEL_21:
          *&v20[4 * v21] += v17->u8[v21];
          ++v21;
        }

        while (a2 != v21);
LABEL_4:
        ++v15;
        v17 = (v17 + a2);
        if (v15 == a3)
        {
          goto LABEL_25;
        }
      }
    }

    v34 = a3;
    do
    {
      v35 = *a5++;
      ++v12[v35];
      --v34;
    }

    while (v34);
  }

LABEL_25:
  if (v6 >= 1)
  {
    v36 = a2;
    if (a2 <= 0)
    {
      v6 = v6;
      v46 = v12;
      do
      {
        if (!*v46++)
        {
          bzero(a4, v36);
        }

        a4 += v36;
        --v6;
      }

      while (v6);
    }

    else
    {
      v37 = 0;
      v38 = a2;
      v39 = 4 * a2;
      v40 = v13;
      v41 = a4;
      do
      {
        if (v12[v37])
        {
          v42 = v40;
          v43 = v41;
          v44 = v38;
          do
          {
            v45 = *v42++;
            *v43++ = (v45 + v12[v37] / 2) / v12[v37];
            --v44;
          }

          while (v44);
        }

        else
        {
          bzero(&a4[v37 * v38], v36);
        }

        ++v37;
        v41 += v38;
        v40 = (v40 + v39);
      }

      while (v37 != v6);
    }
  }

  free(v12);

  free(v13);
}

void vl_geo_calc_tile(float64x2_t *a1, uint64_t a2, int a3, _DWORD *a4, _DWORD *a5)
{
  v9 = *a2;
  v10 = *(a2 + 8);
  v11 = *(a2 + 16);
  v12 = sqrt(v10 * v10 + v9 * v9);
  if (v12 >= 0.001)
  {
    v13 = atan2(*(a2 + 16), v12 * 0.996647189);
  }

  else
  {
    v13 = dbl_2711036C0[v11 < 0.0];
    v12 = 0.001;
  }

  v14 = __sincos_stret(v13);
  v15 = atan2(v11 + v14.__sinval * (v14.__sinval * v14.__sinval) * 42841.3115, v12 + v14.__cosval * (v14.__cosval * v14.__cosval) * -42697.6727);
  v16 = sin(v15);
  if (fabs(v16) <= 0.9999)
  {
    v17 = log((v16 + 1.0) / (1.0 - v16)) * 3189068.5;
  }

  else
  {
    v17 = dbl_271105790[v16 > 0.0];
  }

  v31 = v17;
  v18 = atan2(v10, v9) + 3.14159265;
  v30 = (v18 + ((v18 * 0.159154943) - (v18 < 0.0)) * -6.28318531 + -3.14159265) * 6378137.0;
  v19 = (ldexp(1.0, a3) + -1.0);
  v20.f64[0] = v31;
  v20.f64[1] = v30;
  __asm { FMOV            V3.2D, #0.5 }

  v26 = vrndmq_f64(vmulq_n_f64(vaddq_f64(vdivq_f64(vsubq_f64(v20, *a1), a1[1]), _Q3), (1 << a3)));
  v27 = vmovn_s64(vcltzq_f64(v26));
  if (v27.i8[0])
  {
    v28 = 0.0;
  }

  else
  {
    v28 = v26.f64[0];
  }

  if (v28 >= v19)
  {
    v28 = v19;
  }

  *a4 = v28;
  v29 = v26.f64[1];
  if (v27.i8[4])
  {
    v29 = 0.0;
  }

  if (v29 >= v19)
  {
    v29 = v19;
  }

  *a5 = v29;
}

void vl_geo_calc_gnd(float64x2_t *a1, char a2, int a3, int a4, uint64_t a5)
{
  v118 = *MEMORY[0x277D85DE8];
  *&v6 = (1 << a2);
  *(a5 + 72) = a1->f64[0] + ((a3 + 0.5) / *&v6 + -0.5) * a1[1].f64[0];
  *(a5 + 80) = a1->f64[1] + ((a4 + 0.5) / *&v6 + -0.5) * a1[1].f64[1];
  *(a5 + 88) = 0;
  *a5 = 0x3FF0000000000000;
  *(a5 + 8) = 0;
  v7 = (a5 + 8);
  *(a5 + 16) = 0;
  *(a5 + 24) = 0;
  *(a5 + 32) = 0x3FF0000000000000;
  *(a5 + 40) = 0;
  *(a5 + 48) = 0;
  *(a5 + 56) = 0;
  *(a5 + 64) = 0x3FF0000000000000;
  *(a5 + 96) = vdivq_f64(a1[1], vdupq_lane_s64(v6, 0));
  vl_mat_imgnd_to_xyz(&v106, a5, 1, 1, 0.0, 0.0, 1.0);
  v89 = v109;
  v8 = v109 * -0.5;
  v83 = v106;
  v82 = v112;
  v98 = v108;
  v99 = v113;
  v101 = v107;
  v103 = v115;
  v87 = v111;
  v88 = v110;
  v80 = v110 * -0.5;
  v92 = v116;
  v94 = v117;
  v96 = v114;
  v9 = v111 * -0.5;
  v10 = v117 + v111 * -0.5 + v108 * -0.5 + v114 * 0.0;
  v11 = (v116 + v110 * -0.5 + v107 * -0.5 + v113 * 0.0) / 6378137.0;
  v12 = sinh((v115 + v109 * -0.5 + v106 * -0.5 + v112 * 0.0) / 6378137.0);
  v13 = atan(v12);
  v14 = __sincos_stret(v13);
  v15 = __sincos_stret(v11);
  v16 = 6378137.0 / sqrt(v14.__sinval * -0.00669437999 * v14.__sinval + 1.0);
  v17 = v14.__cosval * (v16 - v10);
  v85 = v15.__sinval * v17;
  v86 = v15.__cosval * v17;
  v84 = v14.__sinval * -(v10 - v16 * 0.99330562);
  v18 = v94 + v9 + v98 * 0.5 + v96 * 0.0;
  v19 = sinh((v103 + v8 + v83 * 0.5 + v82 * 0.0) / 6378137.0);
  v20 = atan(v19);
  v21 = __sincos_stret(v20);
  v22 = __sincos_stret((v92 + v80 + v101 * 0.5 + v99 * 0.0) / 6378137.0);
  v23 = 6378137.0 / sqrt(v21.__sinval * -0.00669437999 * v21.__sinval + 1.0);
  v24 = v21.__cosval * (v23 - v18);
  v79 = v22.__sinval * v24;
  v81 = v22.__cosval * v24;
  v25 = v21.__sinval * -(v18 - v23 * 0.99330562);
  v26 = v94 + v87 * 0.5 + v98 * -0.5 + v96 * 0.0;
  v27 = sinh((v103 + v89 * 0.5 + v83 * -0.5 + v82 * 0.0) / 6378137.0);
  v28 = atan(v27);
  v29 = __sincos_stret(v28);
  v30 = __sincos_stret((v92 + v88 * 0.5 + v101 * -0.5 + v99 * 0.0) / 6378137.0);
  v31 = 6378137.0 / sqrt(v29.__sinval * -0.00669437999 * v29.__sinval + 1.0);
  v32 = v29.__cosval * (v31 - v26);
  *(a5 + 96) = sqrt((v85 - v79) * (v85 - v79) + (v86 - v81) * (v86 - v81) + (v84 - v25) * (v84 - v25));
  *(a5 + 104) = sqrt((v85 - v30.__sinval * v32) * (v85 - v30.__sinval * v32) + (v86 - v30.__cosval * v32) * (v86 - v30.__cosval * v32) + (v84 - v29.__sinval * -(v26 - v31 * 0.99330562)) * (v84 - v29.__sinval * -(v26 - v31 * 0.99330562)));
  v33 = *(a5 + 72);
  v104 = *(a5 + 80);
  v34 = *(a5 + 88);
  v35 = *(a5 + 48);
  if (fabs(v35) >= 1.0)
  {
    v40 = *v7;
    if (v35 <= -1.0)
    {
      v37 = 0.0;
      v38 = atan2(v40, *(a5 + 16)) + 0.0;
      v39 = 1.57079633;
    }

    else
    {
      v38 = atan2(-v40, -*(a5 + 16));
      v37 = 0.0;
      v39 = -1.57079633;
    }
  }

  else
  {
    v36 = asin(-v35);
    v37 = atan2(*(a5 + 24), *a5);
    v38 = atan2(*(a5 + 56), *(a5 + 64));
    v39 = v36;
  }

  v41 = __sincos_stret(v39);
  v42 = __sincos_stret(v37);
  v43 = __sincos_stret(v38);
  v44 = v33 + v41.__cosval * v42.__cosval;
  v45 = v33;
  v46 = v104 + v41.__cosval * v42.__sinval;
  v90 = v44;
  v93 = v104 + v42.__cosval * v43.__cosval + v41.__sinval * v42.__sinval * v43.__sinval;
  v95 = v45 + v41.__sinval * v42.__cosval * v43.__sinval - v42.__sinval * v43.__cosval;
  v97 = v34 + v41.__cosval * v43.__sinval;
  v47 = sinh(v45 / 6378137.0);
  v48 = atan(v47);
  v49 = __sincos_stret(v48);
  v50 = __sincos_stret(v104 / 6378137.0);
  v51 = 6378137.0 / sqrt(v49.__sinval * -0.00669437999 * v49.__sinval + 1.0);
  v52 = v49.__cosval * (v51 - v34);
  v102 = v50.__sinval * v52;
  v105 = v50.__cosval * v52;
  v100 = v49.__sinval * -(v34 - v51 * 0.99330562);
  v53 = sinh(v90 / 6378137.0);
  v54 = atan(v53);
  v55 = __sincos_stret(v54);
  v56 = __sincos_stret(v46 / 6378137.0);
  v57 = 6378137.0 / sqrt(v55.__sinval * -0.00669437999 * v55.__sinval + 1.0);
  v58 = v55.__cosval * (v57 - (v34 - v41.__sinval));
  v91 = v56.__cosval * v58;
  v59 = v56.__sinval * v58;
  v60 = v55.__sinval * -(v34 - v41.__sinval - v57 * 0.99330562);
  v61 = sinh(v95 / 6378137.0);
  v62 = atan(v61);
  v63 = __sincos_stret(v62);
  v64 = __sincos_stret(v93 / 6378137.0);
  v65 = 6378137.0 / sqrt(v63.__sinval * -0.00669437999 * v63.__sinval + 1.0);
  v66 = v63.__cosval * (v65 - v97);
  v67 = v91 - v105;
  v68 = v59 - v102;
  v69 = v60 - v100;
  v70 = v64.__cosval * v66 - v105;
  v71 = v64.__sinval * v66 - v102;
  v72 = v63.__sinval * -(v97 - v65 * 0.99330562) - v100;
  v73 = atan2(v68, v91 - v105);
  v74 = atan2(-(v60 - v100), sqrt(v68 * v68 + v67 * v67));
  v75 = atan2((v68 * v72 - v69 * v71) * v68 - v67 * (v69 * v70 - v67 * v72), -(v68 * v69) * (v69 * v70 - v67 * v72) + (v68 * v72 - v69 * v71) * -(v67 * v69) + (v67 * v71 - v68 * v70) * (v67 * v67 + v68 * v68));
  *(a5 + 72) = v105;
  *(a5 + 80) = v102;
  *(a5 + 88) = v100;
  v76 = __sincos_stret(v73);
  v77 = __sincos_stret(v74);
  v78 = __sincos_stret(v75);
  *a5 = v76.__cosval * v77.__cosval;
  *(a5 + 8) = v76.__cosval * v77.__sinval * v78.__sinval - v76.__sinval * v78.__cosval;
  *(a5 + 16) = v76.__sinval * v78.__sinval + v76.__cosval * v77.__sinval * v78.__cosval;
  *(a5 + 24) = v76.__sinval * v77.__cosval;
  *(a5 + 32) = v76.__cosval * v78.__cosval + v76.__sinval * v77.__sinval * v78.__sinval;
  *(a5 + 40) = v76.__sinval * v77.__sinval * v78.__cosval - v76.__cosval * v78.__sinval;
  *(a5 + 48) = -v77.__sinval;
  *(a5 + 56) = v77.__cosval * v78.__sinval;
  *(a5 + 64) = v77.__cosval * v78.__cosval;
}

_DWORD *vl_create(uint64_t a1, uint64_t a2, const char *a3, uint64_t (*a4)(void, void, void), uint64_t a5, _BYTE *a6, uint64_t a7)
{
  v14 = malloc_type_calloc(1uLL, 0x3980uLL, 0x10B0040EEBE1437uLL);
  if (vl_os_log_once_token != -1)
  {
    dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
  }

  v15 = vl_os_log_log;
  v16 = os_signpost_id_make_with_pointer(vl_os_log_log, v14);
  if (v16 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v17 = v16;
    if (os_signpost_enabled(v15))
    {
      *v19 = 0;
      _os_signpost_emit_with_name_impl(&dword_27103D000, v15, OS_SIGNPOST_INTERVAL_BEGIN, v17, "vl instance", "vl_create", v19, 2u);
    }
  }

  vl_par_default(v19);
  memcpy(v14, v19, 0x3F0uLL);
  v14[252] = -1;
  vl_context_init((v14 + 534), a6);
  vl_map_init((v14 + 1194), (v14 + 30), (v14 + 38), a1, a2, a3);
  if (a7)
  {
    __strcpy_chk();
  }

  vl_log_callback = a4;
  vl_log_callback_context = a5;
  return v14;
}

void vl_free(uint64_t a1)
{
  vl_dump_stop(a1 + 12080);
  free(*(a1 + 1944));
  free(*(a1 + 1968));
  free(*(a1 + 2040));
  free(*(a1 + 2016));
  free(*(a1 + 2064));
  free(*(a1 + 2088));
  free(*(a1 + 2112));
  v2 = *(a1 + 14424);
  if (v2)
  {
    slam_tracker_vo_free(v2);
  }

  v3 = *(a1 + 14680);
  if (v3)
  {
    vl_hs_free(v3);
  }

  while (!*(a1 + 4824))
  {
    usleep(0x186A0u);
  }

  *(a1 + 4824) = 0;
  pthread_join(*(a1 + 5504), 0);
  vl_context_free(a1 + 2136);
  vl_map_free(*(a1 + 1016));
  vl_dump_clear(a1 + 12080);
  if (vl_os_log_once_token != -1)
  {
    dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
  }

  v4 = vl_os_log_log;
  v5 = os_signpost_id_make_with_pointer(vl_os_log_log, a1);
  if (v5 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v6 = v5;
    if (os_signpost_enabled(v4))
    {
      *v7 = 0;
      _os_signpost_emit_with_name_impl(&dword_27103D000, v4, OS_SIGNPOST_INTERVAL_END, v6, "vl instance", "vl_free", v7, 2u);
    }
  }

  free(a1);
}

uint64_t vl_update(uint64_t a1, uint64_t a2)
{
  v22 = *MEMORY[0x277D85DE8];
  if (!a1)
  {
    return 4294967293;
  }

  if ((vminv_u16(vmovn_s32(vmvnq_s8(vceqq_s32(vl_argo_support_location_type, vdupq_n_s32(*(a2 + 32)))))) & 1) != 0 || (v3 = *(a2 + 24), v3 < 0.0) || *&vl_gps_max_horz_accuracy < v3)
  {
    printf("%sError : ", &str_2_2);
    printf("VL update got bad location : type (%d) uncertainty(%f)", *(a2 + 32), *(a2 + 24));
    putchar(10);
    return 4294967292;
  }

  else
  {
    v6 = vl_map_update((a1 + 4776), v3, a1 + 120, a2, 0);
    vl_dump_update(a1 + 12080, a2, v6, *(a2 + 24));
    if (vl_os_log_once_token != -1)
    {
      dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
    }

    v7 = vl_os_log_log;
    v8 = os_signpost_id_generate(vl_os_log_log);
    if (v8 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
    {
      v9 = v8;
      if (os_signpost_enabled(v7))
      {
        v10 = *a2;
        v11 = *(a2 + 8);
        v12 = *(a2 + 16);
        v13 = *(a2 + 24);
        *buf = 134218752;
        v15 = v10;
        v16 = 2048;
        v17 = v11;
        v18 = 2048;
        v19 = v12;
        v20 = 2048;
        v21 = v13;
        _os_signpost_emit_with_name_impl(&dword_27103D000, v7, OS_SIGNPOST_EVENT, v9, "vl_update", "vl_update position %f %f %f uncertainty %f", buf, 0x2Au);
      }
    }

    return v6;
  }
}

uint64_t vl_get_altitudes(uint64_t a1, _DWORD *a2, void *a3, float a4, float a5)
{
  if (a1)
  {
    v5 = *(a1 + 5360);
    if (v5)
    {
      v23 = 0;
      v24 = 0;
      v25 = 0;
      vl_height_get_for_latlon((v5 + 608), &v23, a4, a5);
      v8 = v23;
      if (v23)
      {
        *a2 = v23;
        v9 = malloc_type_malloc(4 * v8, 0x100004052888210uLL);
        *a3 = v9;
        v11 = v23;
        v10 = v24;
        if (v23 >= 1)
        {
          v12 = 0;
          if (v23 < 8)
          {
            goto LABEL_10;
          }

          if ((v9 - v24) < 0x20)
          {
            goto LABEL_10;
          }

          v12 = v23 & 0x7FFFFFFFFFFFFFF8;
          v13 = v24 + 1;
          v14 = v9 + 16;
          v15 = v23 & 0x7FFFFFFFFFFFFFF8;
          do
          {
            v16 = *v13;
            *(v14 - 1) = *(v13 - 1);
            *v14 = v16;
            v13 += 2;
            v14 += 2;
            v15 -= 8;
          }

          while (v15);
          if (v11 != v12)
          {
LABEL_10:
            v17 = v11 - v12;
            v18 = 4 * v12;
            v19 = &v9[v18];
            v20 = &v10[v18];
            do
            {
              v21 = *v20;
              v20 += 4;
              *v19 = v21;
              v19 += 4;
              --v17;
            }

            while (v17);
          }
        }

        free(v10);
        return 0;
      }

      else
      {
        return 1;
      }
    }

    else
    {
      printf("%sError : ", &str_2_2);
      printf("Map tile not loaded");
      putchar(10);
      return 3;
    }
  }

  else
  {
    printf("%sError : ", &str_2_2);
    printf("VL not initialized");
    putchar(10);
    return 2;
  }
}

uint64_t vl_locate(uint64_t a1, void *ptr, __int128 *a3, uint64_t a4)
{
  v352 = *MEMORY[0x277D85DE8];
  v348 = 0u;
  v349 = 0u;
  v347 = 0u;
  v8 = &unk_280877000;
  if (vl_os_log_once_token != -1)
  {
    dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
  }

  v345 = 0u;
  v346 = 0u;
  v343 = 0u;
  v344 = 0u;
  v341 = 0u;
  v342 = 0u;
  v9 = vl_os_log_log;
  v10 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
  if (v10 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v11 = v10;
    if (os_signpost_enabled(v9))
    {
      LOWORD(buf[0].tv_sec) = 0;
      _os_signpost_emit_with_name_impl(&dword_27103D000, v9, OS_SIGNPOST_INTERVAL_BEGIN, v11, "vl_locate", "", buf, 2u);
    }
  }

  printf("Verbose : ");
  printf("------------------------------------------------------------");
  putchar(10);
  printf("Verbose : ");
  printf("Processing image of size:          %d x %d", *(ptr + 2), *(ptr + 3));
  putchar(10);
  printf("Verbose : ");
  v12 = atan(((*(ptr + 2) / 2) / *a3));
  v13 = (v12 + v12) * 180.0 / 3.14159265;
  v14 = atan(((*(ptr + 3) / 2) / *(a3 + 4)));
  printf("FOV:                               %.2f x %.2f degrees", v13, ((v14 + v14) * 180.0 / 3.14159265));
  putchar(10);
  printf("Verbose : ");
  printf("GPS Uncertainty:                   %.2f m", *(a3 + 18));
  putchar(10);
  printf("Verbose : ");
  printf("Core Motion heading & uncertainty: %.2f +- %.2f degrees", *(a3 + 24), *(a3 + 25));
  putchar(10);
  log_col_app("VL ver:                            %d", v15, v16, v17, v18, v19, v20, v21, *(a1 + 1008));
  printf("Verbose : ");
  printf("------------------------------------------------------------");
  putchar(10);
  if (!*(a1 + 14696))
  {
    buf[0].tv_sec = 0;
    buf[0].tv_nsec = 0;
    clock_gettime(_CLOCK_MONOTONIC, buf);
    *(a1 + 14688) = buf[0].tv_sec + buf[0].tv_nsec * 0.000000001;
    if (*(a1 + 12076))
    {
      goto LABEL_8;
    }

LABEL_10:
    clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (a1 + 11896));
    clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (a1 + 11880));
    clock_gettime(_CLOCK_MONOTONIC, (a1 + 11864));
    goto LABEL_11;
  }

  if (!*(a1 + 12076))
  {
    goto LABEL_10;
  }

LABEL_8:
  *(a1 + 11984) -= mach_absolute_time();
LABEL_11:
  v340 = a1 + 12080;
  vl_dump_locate(a1 + 12080, ptr, a3, a1 + 1424);
  memset(buf, 0, 32);
  if (*(a1 + 12080) && (*(a1 + 12084) & 8) != 0)
  {
    v22 = 0;
    v23 = 0;
    do
    {
      v23 = (1025 * (v23 + *(a1 + v22))) ^ ((1025 * (v23 + *(a1 + v22))) >> 6);
      ++v22;
    }

    while (v22 != 1008);
    v24 = 32769 * ((9 * v23) ^ ((9 * v23) >> 11));
    strcpy(buf, "vl");
    v25 = *(a1 + 13744);
    v26 = *(a1 + 13760);
    if (v25 >= v26)
    {
      v27 = 2 * v26;
      _ZF = v26 == 0;
      v29 = 4;
      if (!_ZF)
      {
        v29 = v27;
      }

      if (v29 <= v25)
      {
        v30 = v25 + 1;
      }

      else
      {
        v30 = v29;
      }

      if (v30)
      {
        *(a1 + 13752) = realloc(*(a1 + 13752), 56 * v30);
        v25 = *(a1 + 13744);
      }

      *(a1 + 13760) = v30;
    }

    *(a1 + 13744) = v25 + 1;
    v31 = (*(a1 + 13752) + 56 * v25);
    *v31 = buf[0];
    v31[1] = buf[1];
    v31[2].tv_sec = 0x20202020726150;
    v31[2].tv_nsec = 0x100000000;
    v31[3].tv_sec = v24;
  }

  v32 = *(a1 + 11840);
  *(a1 + 11648) = v32;
  v37 = *(a1 + 11824);
  *(a1 + 11632) = v37;
  v33 = *(a1 + 11808);
  *(a1 + 11616) = v33;
  v34 = *(a1 + 11792);
  *(a1 + 11600) = v34;
  v35 = *(a1 + 11760);
  *(a1 + 11568) = v35;
  v36 = *(a1 + 11776);
  *(a1 + 11584) = v36;
  *(a1 + 9448) = v37;
  *(a1 + 9464) = v32;
  *(a1 + 9416) = v34;
  *(a1 + 9432) = v33;
  *(a1 + 9384) = v35;
  *(a1 + 9400) = v36;
  v347 = xmmword_271105070;
  v348 = xmmword_271105070;
  LODWORD(v349) = 1065353216;
  LODWORD(v37) = *(a3 + 28);
  *&v32 = sqrtf(((*(a3 + 27) * *(a3 + 27)) + (*(a3 + 26) * *(a3 + 26))) + (*&v37 * *&v37));
  LODWORD(buf[0].tv_nsec) = 0;
  buf[0].tv_sec = 0;
  v38 = *&v32;
  if (*&v32 < 0.95 || v38 > 1.05)
  {
    printf("%sWarning : ", &str_2_2);
    printf("Gravity does not seem to be correct (len: %f)", v38);
    putchar(10);
    goto LABEL_37;
  }

  if (vl_img_get_gv(a3, *(a1 + 500), buf, 1.05, *&v37, *&v33, v34, v35, v36))
  {
LABEL_37:
    v42 = 16385;
    goto LABEL_38;
  }

  if (*(a1 + 14704) || *a3 > 0.0 && *a3 <= 10000.0)
  {
    v39 = *&vl_camera_min_gravity_angle * 3.14159265 / 180.0;
    v40 = acos((((*&buf[0].tv_sec + (*(&buf[0].tv_sec + 1) * 0.0)) + (*&buf[0].tv_nsec * 0.0)) / (sqrtf(((*(&buf[0].tv_sec + 1) * *(&buf[0].tv_sec + 1)) + (*&buf[0].tv_sec * *&buf[0].tv_sec)) + (*&buf[0].tv_nsec * *&buf[0].tv_nsec)) + 1.0e-20)));
    if (v40 < v39)
    {
      v42 = 0x4000;
    }

    else if (vminv_u16(vmovn_s32(vmvnq_s8(vceqq_s32(vl_argo_support_location_type, vdupq_n_s32(*(a3 + 20)))))))
    {
      v42 = 16387;
    }

    else
    {
      v41 = *(a3 + 18);
      if (v41 >= 0.0 && *&vl_gps_max_horz_accuracy >= v41)
      {
        v42 = 1;
      }

      else
      {
        v42 = 16388;
      }
    }
  }

  else
  {
    printf("%sError : ", &str_2_2);
    printf("Calibration does not seem to be correct (K[0] = %f)", *a3);
    putchar(10);
    v42 = 16386;
  }

LABEL_38:
  v43 = a1 + 1016;
  vl_map_free(*(a1 + 1016));
  *(a1 + 1016) = 0;
  v44 = vl_map_get(a1 + 4776, *(a3 + 18), a1 + 120, a3 + 6, a1 + 1016);
  if (v44 <= 1)
  {
    if (v44)
    {
      v42 = 4;
      if (!*(a1 + 560))
      {
        goto LABEL_48;
      }

LABEL_45:
      if (!*(a1 + 14680))
      {
        v51 = *(a1 + 564);
        v52 = malloc_type_calloc(1uLL, 8uLL, 0x2004093837F09uLL);
        v53 = malloc_type_calloc(1uLL, 0x200uLL, 0x1080040DA4BCE92uLL);
        *v52 = v53;
        vl_hs_model_load_version(v53, v51, (a1 + 9920));
        *(a1 + 14680) = v52;
      }

      goto LABEL_48;
    }

    goto LABEL_44;
  }

  if (v44 == 2)
  {
    v42 = 8;
LABEL_44:
    if (*(a1 + 560))
    {
      goto LABEL_45;
    }

    goto LABEL_48;
  }

  v42 = 16;
  if (*(a1 + 560))
  {
    goto LABEL_45;
  }

LABEL_48:
  if (v42 == 1 || *(a1 + 4748) < 1 || *(a1 + 656) || *(a1 + 976))
  {
    v339 = a4;
    if (!vl_img_init(ptr, a3, a1 + 176, *(a1 + 14704), *(a1 + 14708), a1 + 1024, v45, v46, v47, v48, v49, v50))
    {
      if (*(a1 + 572))
      {
        v65 = vl_locability_score(a1 + 2136, a1 + 1024, (a1 + 1256), *(a1 + 576));
        printf("Info : ");
        printf("Locability: Score %f, status %d", *&v65, HIDWORD(v65) == 0);
        putchar(10);
        if (HIDWORD(v65))
        {
          v42 = 0x8000;
          goto LABEL_53;
        }
      }

      if (vl_os_log_once_token != -1)
      {
        dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
      }

      v66 = vl_os_log_log;
      v67 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
      if (v67 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
      {
        v68 = v67;
        if (os_signpost_enabled(v66))
        {
          LOWORD(buf[0].tv_sec) = 0;
          _os_signpost_emit_with_name_impl(&dword_27103D000, v66, OS_SIGNPOST_INTERVAL_BEGIN, v68, "vl_kpts_extract", "", buf, 2u);
        }
      }

      v338 = (a1 + 1936);
      vl_kpts_extract(a1 + 2864);
      if (vl_os_log_once_token != -1)
      {
        dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
      }

      v69 = vl_os_log_log;
      v70 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
      if (v70 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
      {
        v71 = v70;
        if (os_signpost_enabled(v69))
        {
          v72 = *v338;
          LODWORD(buf[0].tv_sec) = 134217984;
          *(&buf[0].tv_sec + 4) = v72;
          _os_signpost_emit_with_name_impl(&dword_27103D000, v69, OS_SIGNPOST_INTERVAL_END, v71, "vl_kpts_extract", "%lld", buf, 0xCu);
        }
      }

      vl_dump_kpts(v340, v338);
      if (v42 != 1 && !*(a1 + 656) && !*(a1 + 976))
      {
        v8 = &unk_280877000;
        goto LABEL_53;
      }

      if (*(a1 + 168) && *v43)
      {
        vl_retrieval(a1 + 7368, v338, (*v43 + 48), a1 + 168);
      }

      v73 = *(a1 + 14416);
      v8 = &unk_280877000;
      if (v73 && *(v73 + 576) == 1)
      {
        v74 = *(a1 + 1936);
        v75 = **(v73 + 560);
        v76 = *(a1 + 1952);
        if (v75 > v76)
        {
          v77 = 2 * v76;
          if (v77 <= v75)
          {
            v78 = v75;
          }

          else
          {
            v78 = v77;
          }

          if (v78)
          {
            *(a1 + 1944) = malloc_type_realloc(*(a1 + 1944), 288 * v78, 0x1000040A8CFB95EuLL);
          }

          *(a1 + 1952) = v78;
        }

        if (v75 > v74)
        {
          bzero((*(a1 + 1944) + 288 * *(a1 + 1936)), 288 * (v75 - v74));
        }

        v79 = *(*(a1 + 14416) + 560);
        v80 = *v79;
        *(a1 + 1936) = *v79;
        if (v80 >= 1)
        {
          memcpy(*(a1 + 1944), *(v79 + 8), 288 * v80);
        }
      }

      if (v42 != 1 && *(a1 + 648))
      {
        update_tracker(a1 + 6992, a1 + 1024, v338, a1, (a1 + 14424));
        update_tracker_meta((a1 + 6992), a3, 0, 0, 0, 0, a1);
      }

      if (v42 != 1 && *(a1 + 976))
      {
        update_history(a1 + 11664, v42, a4, a1 + 1024, a3, 0, 0, v338, *(a1 + 1016), a1);
        goto LABEL_53;
      }

      if (v42 == 1)
      {
        if (vl_os_log_once_token != -1)
        {
          dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
        }

        v81 = vl_os_log_log;
        v82 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
        if (v82 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
        {
          v83 = v82;
          if (os_signpost_enabled(v81))
          {
            LOWORD(buf[0].tv_sec) = 0;
            _os_signpost_emit_with_name_impl(&dword_27103D000, v81, OS_SIGNPOST_INTERVAL_BEGIN, v83, "vl_match", "", buf, 2u);
          }
        }

        vl_match(a1 + 6344, v338, (a1 + 1984), *(a1 + 1016) + 48, (*(a1 + 1016) + 752), a1 + 1024, (a1 + 152), a1 + 2008, v340);
        if (vl_os_log_once_token != -1)
        {
          dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
        }

        v84 = vl_os_log_log;
        v85 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
        if (v85 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
        {
          v86 = v85;
          if (os_signpost_enabled(v84))
          {
            v87 = *(a1 + 2008);
            LODWORD(buf[0].tv_sec) = 134217984;
            *(&buf[0].tv_sec + 4) = v87;
            _os_signpost_emit_with_name_impl(&dword_27103D000, v84, OS_SIGNPOST_INTERVAL_END, v86, "vl_match", "Matches: %lld", buf, 0xCu);
          }
        }

        if (*(a1 + 648))
        {
          update_tracker(a1 + 6992, a1 + 1024, v338, a1, (a1 + 14424));
        }

        if (*(a1 + 1936) >= 1)
        {
          v88 = *(a1 + 1944);
          v89 = *(a1 + 1936) & 0x7FFFFFFFLL;
          do
          {
            v350 = vcvtq_f64_f32(*v88);
            memset(buf, 0, 24);
            g_improj2_to_xyz(a1 + 1048, &v350, &buf[0].tv_sec);
            *v88 = vcvt_f32_f64(*&buf[0].tv_nsec);
            v88 += 36;
            --v89;
          }

          while (v89);
        }

        v90 = *(a1 + 14416);
        if (!v90 || *(v90 + 576) != 2)
        {
          goto LABEL_128;
        }

        v91 = *(a1 + 1936);
        v92 = *(*(v90 + 568) + 80);
        v93 = *(a1 + 1952);
        if (v92 > v93)
        {
          v224 = 2 * v93;
          if (v224 <= v92)
          {
            v225 = v92;
          }

          else
          {
            v225 = v224;
          }

          if (v225)
          {
            *(a1 + 1944) = malloc_type_realloc(*(a1 + 1944), 288 * v225, 0x1000040A8CFB95EuLL);
          }

          *(a1 + 1952) = v225;
          v94 = v92 - v91;
          if (v92 <= v91)
          {
LABEL_118:
            v95 = *(*(a1 + 14416) + 568);
            v96 = *(v95 + 80);
            *(a1 + 1936) = v96;
            if (v96 < 1)
            {
              goto LABEL_120;
            }

            goto LABEL_119;
          }
        }

        else
        {
          v94 = v92 - v91;
          if (v92 <= v91)
          {
            goto LABEL_118;
          }
        }

        bzero((*(a1 + 1944) + 288 * *(a1 + 1936)), 288 * v94);
        v95 = *(*(a1 + 14416) + 568);
        v96 = *(v95 + 80);
        *(a1 + 1936) = v96;
        if (v96 < 1)
        {
LABEL_120:
          v97 = *(a1 + 2032);
          v98 = *(v95 + 152);
          v99 = *(a1 + 2048);
          if (v98 > v99)
          {
            v226 = 2 * v99;
            _ZF = v99 == 0;
            v227 = 32;
            if (!_ZF)
            {
              v227 = v226;
            }

            if (v227 <= v98)
            {
              v228 = v98;
            }

            else
            {
              v228 = v227;
            }

            if (v228)
            {
              *(a1 + 2040) = malloc_type_realloc(*(a1 + 2040), 8 * v228, 0x100004000313F17uLL);
            }

            *(a1 + 2048) = v228;
            v100 = v98 - v97;
            if (v98 <= v97)
            {
LABEL_122:
              v101 = *(*(a1 + 14416) + 568);
              v102 = *(v101 + 152);
              *(a1 + 2032) = v102;
              if (v102 < 1)
              {
LABEL_124:
                v103 = *(a1 + 2008);
                v104 = *(v101 + 128);
                v105 = *(a1 + 2024);
                if (v104 > v105)
                {
                  v229 = 2 * v105;
                  _ZF = v105 == 0;
                  v230 = 32;
                  if (!_ZF)
                  {
                    v230 = v229;
                  }

                  if (v230 <= v104)
                  {
                    v231 = v104;
                  }

                  else
                  {
                    v231 = v230;
                  }

                  if (v231)
                  {
                    *(a1 + 2016) = malloc_type_realloc(*(a1 + 2016), 8 * v231, 0x100004000313F17uLL);
                  }

                  *(a1 + 2024) = v231;
                  v106 = v104 - v103;
                  if (v104 <= v103)
                  {
LABEL_126:
                    v107 = *(*(a1 + 14416) + 568);
                    v108 = *(v107 + 128);
                    *(a1 + 2008) = v108;
                    if (v108 < 1)
                    {
                      goto LABEL_128;
                    }

                    goto LABEL_127;
                  }
                }

                else
                {
                  v106 = v104 - v103;
                  if (v104 <= v103)
                  {
                    goto LABEL_126;
                  }
                }

                bzero((*(a1 + 2016) + 8 * *(a1 + 2008)), 8 * v106);
                v107 = *(*(a1 + 14416) + 568);
                v108 = *(v107 + 128);
                *(a1 + 2008) = v108;
                if (v108 >= 1)
                {
LABEL_127:
                  memcpy(*(a1 + 2016), *(v107 + 136), 8 * v108);
                }

LABEL_128:
                if (vl_os_log_once_token != -1)
                {
                  dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
                }

                v109 = vl_os_log_log;
                v110 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
                if (v110 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
                {
                  v111 = v110;
                  if (os_signpost_enabled(v109))
                  {
                    LOWORD(buf[0].tv_sec) = 0;
                    _os_signpost_emit_with_name_impl(&dword_27103D000, v109, OS_SIGNPOST_INTERVAL_BEGIN, v111, "vl_pose", "", buf, 2u);
                  }
                }

                v112 = *(a1 + 14680);
                if (!*(a1 + 560))
                {
                  goto LABEL_138;
                }

                if (v112)
                {
                  if (**v112 == *(a1 + 564))
                  {
LABEL_138:
                    v337 = (a1 + 2056);
                    vl_pose(a1 + 7584, a1 + 1024, v338, a1 + 1984, *(a1 + 1016) + 48, *(a1 + 1016) + 608, (a1 + 2008), 0, v112, a1 + 176, v340, &v347, a1 + 2056, (a4 + 100), (a4 + 96));
                    if (*(a1 + 1936) >= 1)
                    {
                      v115 = *(a1 + 1944);
                      v116 = *(a1 + 1936) & 0x7FFFFFFFLL;
                      do
                      {
                        v350 = 0uLL;
                        buf[0].tv_sec = 0x3FF0000000000000;
                        *&buf[0].tv_nsec = vcvtq_f64_f32(*v115);
                        g_xyz_to_improj2(a1 + 1048, buf, v350.f64, 0);
                        *v115 = vcvt_f32_f64(v350);
                        v115 += 36;
                        --v116;
                      }

                      while (v116);
                    }

                    if (*(a1 + 2056) >= 1)
                    {
                      v117 = *(a1 + 2064);
                      v118 = *(a1 + 2056) & 0x7FFFFFFFLL;
                      do
                      {
                        v350 = 0uLL;
                        buf[0].tv_sec = 0x3FF0000000000000;
                        *&buf[0].tv_nsec = vcvtq_f64_f32(*v117);
                        g_xyz_to_improj2(a1 + 1048, buf, v350.f64, 0);
                        *v117++ = vcvt_f32_f64(v350);
                        --v118;
                      }

                      while (v118);
                    }

                    v119 = a1 + 2056;
                    if (vl_os_log_once_token != -1)
                    {
                      dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
                    }

                    v120 = vl_os_log_log;
                    v121 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
                    if (v121 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
                    {
                      v122 = v121;
                      if (os_signpost_enabled(v120))
                      {
                        v123 = *v337;
                        LODWORD(buf[0].tv_sec) = 134217984;
                        *(&buf[0].tv_sec + 4) = v123;
                        _os_signpost_emit_with_name_impl(&dword_27103D000, v120, OS_SIGNPOST_INTERVAL_END, v122, "vl_pose", "Inliers: %lld", buf, 0xCu);
                      }
                    }

                    v124 = *(a1 + 1016);
                    buf[0] = vcvtq_f64_f32(*&v347);
                    buf[1] = vcvtq_f64_f32(*(&v347 + 8));
                    buf[2] = vcvtq_f64_f32(*&v348);
                    buf[3] = vcvtq_f64_f32(*(&v348 + 8));
                    buf[4] = vcvtq_f64_f32(*&v349);
                    buf[5] = vcvtq_f64_f32(*(&v349 + 8));
                    g_camera_local_to_global((v124 + 288), &buf[0].tv_sec, &v341);
                    v42 = vl_verify_post(a1 + 1024, *(a1 + 1016), &v341, v337, *(a1 + 14680), *(a1 + 8056), a4, a1);
                    if (v42 == 1)
                    {
                      _D26 = vdup_n_s32(0x404F5C28u);
                      v126 = *(a4 + 144) * 3.24;
                      v127 = (a4 + 208);
                      v333 = *(a4 + 208) * 3.24;
                      __b = *(a4 + 216) * 3.24;
                      v328 = *(a4 + 204) * 3.24;
                      v128 = vadd_f32(vmul_f32(*(a4 + 100), _D26), 1008981771);
                      v129 = vadd_f32(vmul_f32(*(a4 + 124), _D26), 0x3C23D70B00000000);
                      _S9 = HIDWORD(v347);
                      v131 = vmla_n_f32(vmla_n_f32(0, v128, *&v347), v129, *(&v347 + 3));
                      v132 = v129;
                      v133 = vadd_f32(vmul_f32(*(a4 + 148), _D26), 0);
                      v134 = vmla_n_f32(v131, v133, *(&v348 + 2));
                      _D30 = v133;
                      v136 = vmul_f32(*(a4 + 172), _D26);
                      v137 = vmla_f32(v134, 0, v136);
                      v138 = v136;
                      v139 = vmul_f32(*(a4 + 196), _D26);
                      v140 = vmla_f32(v137, 0, v139);
                      v141 = v139;
                      _D1 = vmul_f32(*(a4 + 220), _D26);
                      _D11 = vmla_f32(v140, 0, _D1);
                      _D22 = _D1;
                      _S3 = 0;
                      __asm { FMLA            S1, S9, V11.S[1] }

                      _S28 = DWORD1(v348);
                      _S29 = v348;
                      __asm
                      {
                        FMLA            S1, S29, V11.S[1]
                        FMLA            S1, S28, V11.S[1]
                      }

                      v151 = (*(a4 + 156) * 3.24) + 0.01;
                      v324 = vmul_f32(*(a4 + 188), _D26);
                      v152 = vmul_f32(*(a4 + 112), _D26);
                      v153 = vmul_f32(*(a4 + 136), _D26);
                      v154 = vmul_f32(*(a4 + 160), _D26);
                      v155 = (a4 + 232);
                      v326 = vmul_f32(*(a4 + 232), _D26);
                      v323 = (*(a4 + 184) * 3.24) + 0.00000304617429;
                      v325 = (*(a4 + 212) * 3.24) + 0.00000304617429;
                      v327 = (*(a4 + 240) * 3.24) + 0.00000304617429;
                      v318 = _D30;
                      v156 = v132;
                      v319 = v132;
                      v157 = _D30;
                      v158 = vmla_n_f32(vmla_n_f32(vmla_n_f32(0, v128, *(&v347 + 1)), v132, *&v348), _D30, *(&v348 + 3));
                      v159 = v138;
                      v320 = v138;
                      v321 = v141;
                      v160 = _D22;
                      v322 = _D22;
                      _D0 = vmla_f32(vmla_f32(vmla_f32(v158, 0, v138), 0, v141), 0, _D22);
                      __asm
                      {
                        FMLA            S11, S9, V0.S[1]
                        FMLA            S30, S29, V0.S[1]
                        FMLA            S22, S28, V0.S[1]
                      }

                      v162 = (*(a4 + 108) * 3.24) + 0.0;
                      v163 = (*(a4 + 132) * 3.24) + 0.0;
                      v138.f32[0] = *(a4 + 120) * 3.24;
                      _D0 = vmla_f32(vmla_f32(vmla_f32(vmla_n_f32(vmla_n_f32(vmla_n_f32(0, v128, *(&v347 + 2)), v156, *(&v348 + 1)), v157, *&v349), 0, v159), 0, v141), 0, v160);
                      __asm
                      {
                        FMLA            S17, S9, V0.S[1]
                        FMLA            S5, S29, V0.S[1]
                        FMLA            S4, S28, V0.S[1]
                      }

                      v168 = *(a4 + 228) * 3.24;
                      v169 = vmla_n_f32(vmla_n_f32(vmla_n_f32(0, v152, *&v347), v153, *(&v347 + 3)), v154, *(&v348 + 2));
                      v141.f32[0] = *(a4 + 180) * 3.24;
                      v170 = vmla_n_f32(vmla_n_f32(vmla_n_f32(0, v152, *(&v347 + 1)), v153, *&v348), v154, *(&v348 + 3));
                      v171 = *(a4 + 168) * 3.24;
                      v172 = vmla_n_f32(vmla_n_f32(vmla_n_f32(0, v152, *(&v347 + 2)), v153, *(&v348 + 1)), v154, *&v349);
                      *(a4 + 108) = v162;
                      *(a4 + 132) = v163;
                      *(a4 + 120) = v138.i32[0];
                      *(a4 + 144) = v126;
                      *(a4 + 156) = v151;
                      v156.f32[0] = (((v162 * 0.0) + 0.0) + (v163 * 0.0)) + (v151 * 0.0);
                      *(a4 + 168) = v171;
                      _D0.f32[0] = (((v138.f32[0] * 0.0) + 0.0) + (v126 * 0.0)) + (v171 * 0.0);
                      *(a4 + 100) = v128;
                      *(a4 + 124) = v319;
                      *(a4 + 148) = v318;
                      v173 = vmla_f32(vmla_f32(vmla_f32(0, 0, v128), 0, v319), 0, v318);
                      *(a4 + 112) = v152;
                      *(a4 + 136) = v153;
                      *(a4 + 160) = v154;
                      v174 = vmla_f32(vmla_f32(vmla_f32(0, 0, v152), 0, v153), 0, v154);
                      *(a4 + 180) = v141.i32[0];
                      v128.f32[0] = v141.f32[0] + v156.f32[0];
                      v156.f32[0] = v156.f32[0] + (v141.f32[0] * 0.0);
                      _D1.i32[1] = HIDWORD(v323);
                      _D1.f32[0] = v323;
                      *(a4 + 184) = _D1.i32[0];
                      _D4 = vadd_f32(v324, 0);
                      *(a4 + 188) = _D4;
                      v176 = vzip1_s32(_D1, _D4);
                      __asm
                      {
                        FMLA            S11, S3, V4.S[1]
                        FMLA            S26, S3, V4.S[1]
                        FMLA            S22, S3, V4.S[1]
                      }

                      v154.f32[0] = *&_D4.i32[1] + _D0.f32[0];
                      __asm { FMLA            S0, S3, V4.S[1] }

                      *(a4 + 172) = v320;
                      v177 = vadd_f32(v320, v173);
                      _D5 = vmla_f32(v173, 0, v320);
                      v179 = vmla_f32(v169, 0, v176);
                      v180 = vmla_f32(v170, 0, v176);
                      v181 = vmla_f32(v172, 0, v176);
                      v182 = vadd_f32(v176, v174);
                      v183 = vmla_f32(v174, 0, v176);
                      *(a4 + 196) = v321;
                      v176.f32[0] = v333 + 0.0;
                      *(a4 + 208) = v333 + 0.0;
                      v159.f32[0] = v325;
                      v176.i32[1] = v159.i32[0];
                      v184 = vmla_f32(v179, 0, v176);
                      v185 = vmla_f32(v180, 0, v176);
                      v186 = vmla_f32(v181, 0, v176);
                      v187 = vmla_f32(v182, 0, v176);
                      v188 = vadd_f32(v176, v183);
                      _D7 = vmla_f32(v183, 0, v176);
                      _D18 = vadd_f32(v326, 0);
                      _D20 = vmla_f32(v184, 0, _D18);
                      _D21 = vmla_f32(v185, 0, _D18);
                      _D29 = vmla_f32(v186, 0, _D18);
                      _D1 = vmla_f32(vmla_f32(v177, 0, v321), 0, v322);
                      _D24 = vmla_f32(v187, 0, _D18);
                      _D23 = vmla_f32(vadd_f32(v321, _D5), 0, v322);
                      _D4 = vmla_f32(v188, 0, _D18);
                      *(a4 + 204) = v328;
                      *(a4 + 220) = v322;
                      _D17 = vadd_f32(v322, vmla_f32(_D5, 0, v321));
                      *(a4 + 228) = v168;
                      v153.f32[0] = (v128.f32[0] + (v328 * 0.0)) + (v168 * 0.0);
                      _D5.f32[0] = (v328 + v156.f32[0]) + (v168 * 0.0);
                      v128.f32[0] = v168 + (v156.f32[0] + (v328 * 0.0));
                      *(a4 + 232) = _D18;
                      _D2 = vadd_f32(_D18, _D7);
                      v200 = v327;
                      _D7.f32[0] = (_D11.f32[0] + ((__b + 0.0) * 0.0)) + (v200 * 0.0);
                      __asm { FMLA            S18, S3, V20.S[1] }

                      *(a4 + 100) = _D18.f32[0] + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S18, S3, V20.S[1] }

                      *(a4 + 104) = _D18.f32[0] + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S18, S3, V20.S[1] }

                      *(a4 + 108) = _D18.f32[0] + (_D7.f32[0] * 0.0);
                      _D7.f32[0] = (_D26.f32[0] + ((__b + 0.0) * 0.0)) + (v200 * 0.0);
                      __asm { FMLA            S16, S3, V21.S[1] }

                      *(a4 + 124) = _S16 + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S16, S3, V21.S[1] }

                      *(a4 + 128) = _S16 + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S16, S3, V21.S[1] }

                      *(a4 + 132) = _S16 + (_D7.f32[0] * 0.0);
                      _D7.f32[0] = (_D22.f32[0] + ((__b + 0.0) * 0.0)) + (v200 * 0.0);
                      __asm { FMLA            S16, S3, V29.S[1] }

                      *(a4 + 148) = _S16 + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S16, S3, V29.S[1] }

                      *(a4 + 152) = _S16 + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S16, S3, V29.S[1] }

                      *(a4 + 156) = _S16 + (_D7.f32[0] * 0.0);
                      __asm { FMLA            S7, S3, V1.S[1] }

                      _D1.f32[0] = (v154.f32[0] + ((__b + 0.0) * 0.0)) + (v200 * 0.0);
                      __asm { FMLA            S16, S3, V24.S[1] }

                      *(a4 + 184) = _S16 + (_D1.f32[0] * 0.0);
                      *(a4 + 188) = (_D24.f32[1] + ((_D7.f32[0] + (v153.f32[0] * 0.0)) + (_D24.f32[0] * 0.0))) + (_D1.f32[0] * 0.0);
                      __asm { FMLA            S7, S3, V24.S[1] }

                      *(a4 + 212) = v159.i32[0];
                      *(a4 + 216) = __b + 0.0;
                      *(a4 + 192) = _D1.f32[0] + _D7.f32[0];
                      _D1.f32[0] = (__b + 0.0) + _D0.f32[0];
                      *(a4 + 240) = v200;
                      _D0.f32[0] = (_D0.f32[0] + ((__b + 0.0) * 0.0)) + v200;
                      _D1.f32[0] = _D1.f32[0] + (v200 * 0.0);
                      __asm { FMLA            S7, S3, V23.S[1] }

                      _D5.f32[0] = _D7.f32[0] + (_D5.f32[0] * 0.0);
                      __asm { FMLA            S7, S3, V4.S[1] }

                      *(a4 + 208) = _D7.f32[0] + (_D1.f32[0] * 0.0);
                      _D7.f32[0] = _D4.f32[1] + (_D5.f32[0] + (_D4.f32[0] * 0.0));
                      __asm { FMLA            S5, S3, V4.S[1] }

                      *(a4 + 212) = _D7.f32[0] + (_D1.f32[0] * 0.0);
                      *(a4 + 216) = _D1.f32[0] + _D5.f32[0];
                      __asm { FMLA            S1, S3, V17.S[1] }

                      _D4.f32[0] = _D2.f32[1] + ((_D1.f32[0] + (v128.f32[0] * 0.0)) + (_D2.f32[0] * 0.0));
                      __asm
                      {
                        FMLA            S5, S3, V2.S[1]
                        FMLA            S1, S3, V2.S[1]
                      }

                      *(a4 + 232) = _D5.f32[0] + (_D0.f32[0] * 0.0);
                      *(a4 + 236) = _D4.f32[0] + (_D0.f32[0] * 0.0);
                      *(a4 + 240) = _D0.f32[0] + _D1.f32[0];
                      *(a4 + 204) = 0;
                      *(a4 + 196) = 0;
                      *(a4 + 228) = 0;
                      *(a4 + 220) = 0;
                      *(a4 + 120) = 0;
                      *(a4 + 112) = 0;
                      *(a4 + 144) = 0;
                      *(a4 + 136) = 0;
                      *(a4 + 160) = 0;
                      *(a4 + 168) = 0;
                      *(a4 + 176) = 0;
                      v208 = malloc_type_malloc(0x24uLL, 0x100004052888210uLL);
                      v209 = malloc_type_malloc(0x24uLL, 0x100004052888210uLL);
                      if (fabs(*(&v348 + 2)) >= 1.0)
                      {
                        v221 = *(&v347 + 1);
                        v222 = *(&v347 + 2);
                        if (*(&v348 + 2) <= -1.0)
                        {
                          v216 = atan2(v221, v222) + 0.0;
                          v219 = 0.0;
                          *&v223 = 0.7854;
                        }

                        else
                        {
                          v216 = atan2(-v221, -v222);
                          v219 = 0.0;
                          *&v223 = -0.7854;
                        }

                        v220 = *&v223;
                      }

                      else
                      {
                        v210 = *&v349;
                        v211 = *(&v348 + 3);
                        v212 = *(&v347 + 3);
                        v213 = *&v347;
                        v214 = asin(-*(&v348 + 2));
                        v215 = atan2(v212, v213);
                        v216 = atan2(v211, v210);
                        v217 = v215;
                        v218 = v214;
                        v219 = v217 * 0.5;
                        v220 = v218 * 0.5;
                      }

                      v232 = v216;
                      v233 = __sincosf_stret(v219);
                      v234 = __sincosf_stret(v220);
                      v235 = __sincosf_stret(v232 * 0.5);
                      v236 = (v234.__cosval * v233.__cosval) * v235.__cosval;
                      v237 = (v234.__sinval * v233.__sinval) * v235.__sinval;
                      v238 = (v234.__cosval * v233.__cosval) * v235.__sinval;
                      v239 = (v234.__sinval * v233.__sinval) * v235.__cosval;
                      v240 = (v234.__cosval * v233.__sinval) * v235.__sinval;
                      v241 = (v234.__sinval * v233.__cosval) * v235.__cosval;
                      v242 = (v234.__cosval * v233.__sinval) * v235.__cosval;
                      v243 = (v234.__sinval * v233.__cosval) * v235.__sinval;
                      v244 = v243 - v242;
                      v245 = v241 + v240;
                      v246 = v238 - v239;
                      v247 = -v237 - v236;
                      v330 = v240 - v241;
                      v331 = v243 + v242;
                      v332 = v236 - v237;
                      v334 = v239 + v238;
                      __ba = v239 - v238;
                      v329 = v242 - v243;
                      v248 = v236 + v237;
                      v249 = 1.0 - (v248 * v248);
                      v250 = acosf(v236 + v237);
                      v251 = (v250 + v250) / sqrtf(v249);
                      v252 = -(powf(v249, 1.5) - ((v248 * v249) * v250));
                      v253 = v252 / powf(v249, 2.5);
                      v254 = (v246 + v246) * v253;
                      v255 = (v245 + v245) * v253;
                      v256 = (v329 + v329) * v253;
                      v257 = ((((v256 * __ba) + 0.0) + (v247 * 0.0)) + (v329 * 0.0)) + (v251 * v245);
                      v258 = (((((v254 * v244) + 0.0) + (v251 * v245)) + (v246 * 0.0)) + (v247 * 0.0)) * 0.5;
                      v259 = (((((v255 * v244) + 0.0) + (v245 * 0.0)) + (v251 * v246)) + (v247 * 0.0)) * 0.5;
                      v260 = (((((v256 * v244) + 0.0) + (v245 * 0.0)) + (v246 * 0.0)) + (v251 * v247)) * 0.5;
                      v261 = (((((v254 * v330) + 0.0) + (v251 * v331)) + (v332 * 0.0)) + (v334 * 0.0)) * 0.5;
                      v262 = (((((v255 * v330) + 0.0) + (v331 * 0.0)) + (v251 * v332)) + (v334 * 0.0)) * 0.5;
                      v263 = (((((v256 * v330) + 0.0) + (v331 * 0.0)) + (v332 * 0.0)) + (v251 * v334)) * 0.5;
                      v264 = (((((v254 * __ba) + 0.0) + (v251 * v247)) + (v329 * 0.0)) + (v245 * 0.0)) * 0.5;
                      v265 = (((((v255 * __ba) + 0.0) + (v247 * 0.0)) + (v251 * v329)) + (v245 * 0.0)) * 0.5;
                      *v208 = v339[46];
                      v208[1] = v339[47];
                      v208[2] = v339[48];
                      v208[3] = v339[52];
                      v208[4] = v339[53];
                      v208[5] = v339[54];
                      v208[6] = v339[58];
                      v208[7] = v339[59];
                      v208[8] = v339[60];
                      *(v209 + 2) = 0;
                      *v209 = 0;
                      v266 = (*v208 * v258) + 0.0;
                      *v209 = v266;
                      v267 = (v208[1] * v258) + 0.0;
                      *(v209 + 1) = v267;
                      v268 = (v208[2] * v258) + 0.0;
                      *(v209 + 2) = v268;
                      v269 = v266 + (v208[3] * v261);
                      *v209 = v269;
                      v270 = v267 + (v208[4] * v261);
                      *(v209 + 1) = v270;
                      v271 = v268 + (v208[5] * v261);
                      *(v209 + 2) = v271;
                      *v209 = v269 + (v208[6] * v264);
                      *(v209 + 1) = v270 + (v208[7] * v264);
                      *(v209 + 2) = v271 + (v208[8] * v264);
                      *(v209 + 12) = 0;
                      *(v209 + 5) = 0;
                      v272 = (*v208 * v259) + 0.0;
                      *(v209 + 3) = v272;
                      v273 = (v208[1] * v259) + 0.0;
                      *(v209 + 4) = v273;
                      v274 = (v208[2] * v259) + 0.0;
                      *(v209 + 5) = v274;
                      v275 = v272 + (v208[3] * v262);
                      *(v209 + 3) = v275;
                      v276 = v273 + (v208[4] * v262);
                      *(v209 + 4) = v276;
                      v277 = v274 + (v208[5] * v262);
                      *(v209 + 5) = v277;
                      *(v209 + 3) = v275 + (v208[6] * v265);
                      *(v209 + 4) = v276 + (v208[7] * v265);
                      *(v209 + 5) = v277 + (v208[8] * v265);
                      *(v209 + 3) = 0;
                      *(v209 + 8) = 0;
                      v278 = (*v208 * v260) + 0.0;
                      *(v209 + 6) = v278;
                      v279 = (v208[1] * v260) + 0.0;
                      *(v209 + 7) = v279;
                      v280 = (v208[2] * v260) + 0.0;
                      *(v209 + 8) = v280;
                      v281 = v278 + (v208[3] * v263);
                      *(v209 + 6) = v281;
                      v282 = v279 + (v208[4] * v263);
                      *(v209 + 7) = v282;
                      v283 = v280 + (v208[5] * v263);
                      *(v209 + 8) = v283;
                      *(v209 + 6) = v281 + (v208[6] * (v257 * 0.5));
                      *(v209 + 7) = v282 + (v208[7] * (v257 * 0.5));
                      *(v209 + 8) = v283 + (v208[8] * (v257 * 0.5));
                      v339[48] = 0.0;
                      *(v339 + 23) = 0;
                      v284 = (v258 * *v209) + 0.0;
                      v339[46] = v284;
                      v285 = (v259 * *v209) + 0.0;
                      v339[47] = v285;
                      v286 = (v260 * *v209) + 0.0;
                      v339[48] = v286;
                      v287 = v284 + (v261 * *(v209 + 1));
                      v339[46] = v287;
                      v288 = v285 + (v262 * *(v209 + 1));
                      v339[47] = v288;
                      v289 = v286 + (v263 * *(v209 + 1));
                      v339[48] = v289;
                      v339[46] = v287 + (v264 * *(v209 + 2));
                      v339[47] = v288 + (v265 * *(v209 + 2));
                      v339[48] = v289 + ((v257 * 0.5) * *(v209 + 2));
                      *v127 = 0;
                      v339[54] = 0.0;
                      v290 = (v258 * *(v209 + 3)) + 0.0;
                      v339[52] = v290;
                      v291 = (v259 * *(v209 + 3)) + 0.0;
                      v339[53] = v291;
                      v292 = (v260 * *(v209 + 3)) + 0.0;
                      v339[54] = v292;
                      v293 = v290 + (v261 * *(v209 + 4));
                      v339[52] = v293;
                      v294 = v291 + (v262 * *(v209 + 4));
                      v339[53] = v294;
                      v295 = v292 + (v263 * *(v209 + 4));
                      v339[54] = v295;
                      v339[52] = v293 + (v264 * *(v209 + 5));
                      v339[53] = v294 + (v265 * *(v209 + 5));
                      v339[54] = v295 + ((v257 * 0.5) * *(v209 + 5));
                      *v155 = 0;
                      v339[60] = 0.0;
                      v296 = (v258 * *(v209 + 6)) + 0.0;
                      v339[58] = v296;
                      v297 = (v259 * *(v209 + 6)) + 0.0;
                      v339[59] = v297;
                      v298 = (v260 * *(v209 + 6)) + 0.0;
                      v339[60] = v298;
                      v299 = v296 + (v261 * *(v209 + 7));
                      v339[58] = v299;
                      v300 = v297 + (v262 * *(v209 + 7));
                      v339[59] = v300;
                      v301 = v298 + (v263 * *(v209 + 7));
                      v339[60] = v301;
                      v339[58] = v299 + (v264 * *(v209 + 8));
                      v339[59] = v300 + (v265 * *(v209 + 8));
                      v339[60] = v301 + ((v257 * 0.5) * *(v209 + 8));
                      v302 = v208;
                      a4 = v339;
                      free(v302);
                      free(v209);
                      v119 = a1 + 2056;
                    }

                    else
                    {
                      *(a4 + 96) = 0;
                      memset_pattern16((a4 + 100), &unk_271103980, 0x90uLL);
                    }

                    vl_dump_detail(v340, a1, (*(a1 + 1016) + 288));
                    v303 = v342;
                    *a4 = v341;
                    *(a4 + 16) = v303;
                    v304 = v344;
                    *(a4 + 32) = v343;
                    *(a4 + 48) = v304;
                    v305 = v346;
                    *(a4 + 64) = v345;
                    *(a4 + 80) = v305;
                    v306 = *(a4 + 192);
                    v307 = *(a4 + 208);
                    v308 = *(a4 + 224);
                    *(a1 + 14672) = *(a4 + 240);
                    *(a1 + 14656) = v308;
                    *(a1 + 14640) = v307;
                    *(a1 + 14624) = v306;
                    v309 = *(a4 + 128);
                    v310 = *(a4 + 144);
                    v311 = *(a4 + 160);
                    *(a1 + 14608) = *(a4 + 176);
                    *(a1 + 14592) = v311;
                    *(a1 + 14576) = v310;
                    *(a1 + 14560) = v309;
                    v312 = *(a4 + 96);
                    v313 = *(a4 + 112);
                    v314 = *(a4 + 80);
                    *(a1 + 14496) = *(a4 + 64);
                    *(a1 + 14544) = v313;
                    *(a1 + 14528) = v312;
                    *(a1 + 14512) = v314;
                    v316 = *(a4 + 32);
                    v315 = *(a4 + 48);
                    v317 = *(a4 + 16);
                    *(a1 + 14432) = *a4;
                    *(a1 + 14448) = v317;
                    *(a1 + 14464) = v316;
                    *(a1 + 14480) = v315;
                    v8 = &unk_280877000;
                    if (*(a1 + 976))
                    {
                      update_history(a1 + 11664, v42, a4, a1 + 1024, a3, (*(a1 + 1016) + 288), v119, v338, *(a1 + 1016), a1);
                    }

                    update_tracker_meta((a1 + 6992), a3, v119, *(a1 + 1016), a4, v42, a1);
                    vl_dump_result(v340, a4, (*(a1 + 1016) + 4), v42);
                    vl_dump_stats(v340, a1);
                    if (*(a1 + 12080) && (*(a1 + 12084) & 8) != 0 && *(a1 + 12112) && *(a1 + 12628))
                    {
                      vl_t_print(a1, v340, 0);
                    }

                    goto LABEL_53;
                  }

                  vl_hs_free(*(a1 + 14680));
                }

                v113 = *(a1 + 564);
                v112 = malloc_type_calloc(1uLL, 8uLL, 0x2004093837F09uLL);
                v114 = malloc_type_calloc(1uLL, 0x200uLL, 0x1080040DA4BCE92uLL);
                *v112 = v114;
                vl_hs_model_load_version(v114, v113, (a1 + 9920));
                *(a1 + 14680) = v112;
                goto LABEL_138;
              }

LABEL_123:
              memcpy(*(a1 + 2040), *(v101 + 160), 8 * v102);
              v101 = *(*(a1 + 14416) + 568);
              goto LABEL_124;
            }
          }

          else
          {
            v100 = v98 - v97;
            if (v98 <= v97)
            {
              goto LABEL_122;
            }
          }

          bzero((*(a1 + 2040) + 8 * *(a1 + 2032)), 8 * v100);
          v101 = *(*(a1 + 14416) + 568);
          v102 = *(v101 + 152);
          *(a1 + 2032) = v102;
          if (v102 < 1)
          {
            goto LABEL_124;
          }

          goto LABEL_123;
        }

LABEL_119:
        memcpy(*(a1 + 1944), *(v95 + 88), 288 * v96);
        v95 = *(*(a1 + 14416) + 568);
        goto LABEL_120;
      }
    }
  }

LABEL_53:
  vl_timer_stop(a1 + 11864);
  if (!*(a1 + 12076))
  {
    log_col_app("%s%s%s:%s%7.1fms%s", v54, v55, v56, v57, v58, v59, v60, &str_4_1);
    if (v8[140] == -1)
    {
      goto LABEL_55;
    }

LABEL_60:
    dispatch_once(&vl_os_log_once_token, &__block_literal_global_4);
    goto LABEL_55;
  }

  printf("Verbose : ");
  printf("Total time for %40s : %7.3f ms", (a1 + 12012), *(a1 + 11984) * 0.000001);
  putchar(10);
  if (v8[140] != -1)
  {
    goto LABEL_60;
  }

LABEL_55:
  v61 = vl_os_log_log;
  v62 = os_signpost_id_make_with_pointer(vl_os_log_log, ptr);
  if (v62 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v63 = v62;
    if (os_signpost_enabled(v61))
    {
      LOWORD(buf[0].tv_sec) = 0;
      _os_signpost_emit_with_name_impl(&dword_27103D000, v61, OS_SIGNPOST_INTERVAL_END, v63, "vl_locate", "", buf, 2u);
    }
  }

  return v42;
}

uint64_t update_tracker(uint64_t a1, uint64_t a2, uint64_t *a3, uint64_t a4, uint64_t *a5)
{
  v45 = 0;
  memset(v44, 0, sizeof(v44));
  v9 = *(a4 + 4);
  if (v9 == 1)
  {
    v10 = 64;
  }

  else
  {
    v10 = 256;
  }

  v38 = 0uLL;
  v39 = 0uLL;
  v37 = 0uLL;
  if (*(a1 + 212))
  {
    *(a1 + 120) -= mach_absolute_time();
  }

  else
  {
    clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (a1 + 32));
    clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (a1 + 16));
    clock_gettime(_CLOCK_MONOTONIC, a1);
  }

  v11 = *a3;
  v12 = malloc_type_malloc(8 * *a3, 0x100004000313F17uLL);
  if (v9 == 1)
  {
    v13 = 6;
  }

  else
  {
    v13 = 8;
  }

  v14 = malloc_type_malloc(*a3 << v13, 0xF1981077uLL);
  v40[0] = v11;
  v40[1] = v10;
  v41 = v12;
  v42 = v14;
  v43 = 0;
  if (*a3 >= 1)
  {
    v15 = v14;
    v16 = 0;
    v17 = 0;
    do
    {
      v18 = (a3[1] + v16);
      *(v12 + v17) = *v18;
      memcpy(&v15[v17++ << v13], v18 + 4, v10);
      v16 += 288;
    }

    while (*a3 > v17);
  }

  if (!*a5)
  {
    v19 = malloc_type_calloc(1uLL, 0x3E8uLL, 0x10B004018FDDA7FuLL);
    *(v19 + 38) = malloc_type_calloc(*(a4 + 672), 0x370uLL, 0x10B0040F0DEE453uLL);
    *(v19 + 148) = -1;
    memcpy(v19, (a4 + 672), 0x130uLL);
    *(v19 + 712) = xmmword_271105070;
    *(v19 + 728) = xmmword_271105070;
    *(v19 + 744) = xmmword_271105070;
    v20 = *(v19 + 728);
    *(v19 + 760) = *(v19 + 712);
    *(v19 + 776) = v20;
    *(v19 + 792) = *(v19 + 744);
    *a5 = v19;
  }

  g_proj2_to_g_proj(a2 + 24, v44, 0, 0);
  v37 = vcvtq_f64_f32(*(a2 + 292));
  *&v38 = *(a2 + 300);
  v21 = *(a2 + 280);
  if (fabsf(v21) >= 1.0)
  {
    v27 = *(a2 + 260);
    if (v21 <= -1.0)
    {
      v24 = atan2f(v27, *(a2 + 264)) + 0.0;
      v25 = 0.0;
      v26 = 1.57079637;
    }

    else
    {
      v24 = atan2f(-v27, -*(a2 + 264));
      v25 = 0.0;
      v26 = -1.57079637;
    }
  }

  else
  {
    v22 = asinf(-v21);
    v23 = atan2f(*(a2 + 268), *(a2 + 256));
    v24 = atan2f(*(a2 + 284), *(a2 + 288));
    v25 = v23;
    v26 = v22;
  }

  *(&v38 + 1) = v25;
  *&v39 = v26;
  *(&v39 + 1) = v24;
  slam_tracker_vo_add(*a5, v37.f64, 0, v44, *(a2 + 192), *(a2 + 196), v40, 0, 0.0, 0, 0, 0, 0, 0, 0);
  free(v41);
  free(v42);
  printf("Verbose : ");
  printf("Update slam vio tracker: %d track points", *(*a5 + 368));
  putchar(10);
  vl_timer_stop(a1);
  if (!*(a1 + 212))
  {
    return log_col_app("%s%s%s:%s%7.1fms%s", v28, v29, v30, v31, v32, v33, v34, &str_4_1);
  }

  printf("Verbose : ");
  printf("Total time for %40s : %7.3f ms", (a1 + 148), *(a1 + 120) * 0.000001);
  return putchar(10);
}

void update_tracker_meta(int32x2_t *a1, __int128 *a2, uint64_t a3, _OWORD *a4, __int128 *a5, int a6, uint64_t a7)
{
  v11 = 0uLL;
  v111 = 0u;
  v112 = 0u;
  v109 = 0u;
  v110 = 0u;
  v107 = 0u;
  v108 = 0u;
  v105 = 0u;
  v106 = 0u;
  v103 = 0u;
  v104 = 0u;
  v101 = 0u;
  v102 = 0u;
  v100 = 0;
  v98 = 0u;
  v99 = 0u;
  v96 = 0u;
  v97 = 0u;
  v94 = 0u;
  v95 = 0u;
  v92 = 0u;
  v93 = 0u;
  v90 = 0u;
  v91 = 0u;
  v88 = 0u;
  v89 = 0u;
  v86 = 0u;
  v87 = 0u;
  v85 = 0u;
  if (a4)
  {
    vl_inliers_clone(&v108, a3);
    v11 = *(a4 + 4);
    v105 = a4[22];
    v106 = a4[23];
    v107 = a4[24];
    v101 = a4[18];
    v102 = a4[19];
    v103 = a4[20];
    v104 = a4[21];
    v87 = a5[2];
    v88 = a5[3];
    v85 = *a5;
    v86 = a5[1];
    v91 = a5[6];
    v92 = a5[7];
    v89 = a5[4];
    v90 = a5[5];
    v95 = a5[10];
    v96 = a5[11];
    v93 = a5[8];
    v94 = a5[9];
    v100 = *(a5 + 30);
    v98 = a5[13];
    v99 = a5[14];
    v97 = a5[12];
  }

  if (a6 == 1)
  {
    a1[46].i32[1] = 1;
  }

  v14 = a1[27];
  v15 = a1[29];
  v84 = v11;
  if (v14 >= *&v15)
  {
    if (v15)
    {
      v16 = 2 * *&v15;
    }

    else
    {
      v16 = 1;
    }

    if (v16 <= v14)
    {
      v17 = v14 + 1;
    }

    else
    {
      v17 = v16;
    }

    if (v17)
    {
      v18 = malloc_type_realloc(*&a1[28], 168 * v17, 0x10000407AD11DA0uLL);
      v11 = v84;
      a1[28] = v18;
      v14 = a1[27];
    }

    a1[29] = v17;
  }

  a1[27] = (v14 + 1);
  v19 = *&a1[28] + 168 * v14;
  v20 = a2[2];
  v21 = *a2;
  *(v19 + 16) = a2[1];
  *(v19 + 32) = v20;
  v22 = a2[3];
  v23 = a2[4];
  v24 = a2[6];
  *(v19 + 80) = a2[5];
  *(v19 + 96) = v24;
  *(v19 + 48) = v22;
  *(v19 + 64) = v23;
  v25 = a2[7];
  v26 = a2[8];
  v27 = a2[9];
  *(v19 + 160) = *(a2 + 20);
  *(v19 + 128) = v26;
  *(v19 + 144) = v27;
  *(v19 + 112) = v25;
  *v19 = v21;
  v28 = a1[30];
  v29 = a1[32];
  if (v28 >= *&v29)
  {
    v30 = 2 * *&v29;
    v31 = *&v29 == 0;
    v32 = 3;
    if (!v31)
    {
      v32 = v30;
    }

    if (v32 <= v28)
    {
      v33 = v28 + 1;
    }

    else
    {
      v33 = v32;
    }

    if (v33)
    {
      v34 = malloc_type_realloc(*&a1[31], 80 * v33, 0x1020040CF177B16uLL);
      v11 = v84;
      a1[31] = v34;
      v28 = a1[30];
    }

    a1[32] = v33;
  }

  a1[30] = (v28 + 1);
  v35 = (*&a1[31] + 80 * v28);
  v36 = v112;
  v35[3] = v111;
  v35[4] = v36;
  v37 = v110;
  v35[1] = v109;
  v35[2] = v37;
  *v35 = v108;
  v38 = a1[33];
  v39 = a1[35];
  if (v38 >= *&v39)
  {
    v40 = 2 * *&v39;
    v31 = *&v39 == 0;
    v41 = 16;
    if (!v31)
    {
      v41 = v40;
    }

    if (v41 <= v38)
    {
      v42 = v38 + 1;
    }

    else
    {
      v42 = v41;
    }

    if (v42)
    {
      v43 = malloc_type_realloc(*&a1[34], 16 * v42, 0x1000040451B5BE8uLL);
      v11 = v84;
      a1[34] = v43;
      v38 = a1[33];
    }

    a1[35] = v42;
  }

  a1[33] = (v38 + 1);
  *(*&a1[34] + 16 * v38) = v11;
  v44 = a1[36];
  v45 = a1[38];
  if (v44 >= *&v45)
  {
    v46 = 2 * *&v45;
    v31 = *&v45 == 0;
    v47 = 2;
    if (!v31)
    {
      v47 = v46;
    }

    if (v47 <= v44)
    {
      v48 = v44 + 1;
    }

    else
    {
      v48 = v47;
    }

    if (v48)
    {
      a1[37] = malloc_type_realloc(*&a1[37], 112 * v48, 0x1000040AC4F46D1uLL);
      v44 = a1[36];
    }

    a1[38] = v48;
  }

  a1[36] = (v44 + 1);
  v49 = (*&a1[37] + 112 * v44);
  *v49 = v101;
  v49[1] = v102;
  v49[5] = v106;
  v49[6] = v107;
  v49[3] = v104;
  v49[4] = v105;
  v49[2] = v103;
  v50 = a1[39];
  v51 = a1[41];
  if (v50 >= *&v51)
  {
    if (v51)
    {
      v52 = 2 * *&v51;
    }

    else
    {
      v52 = 1;
    }

    if (v52 <= v50)
    {
      v53 = v50 + 1;
    }

    else
    {
      v53 = v52;
    }

    if (v53)
    {
      a1[40] = malloc_type_realloc(*&a1[40], 248 * v53, 0x10000409B83B951uLL);
      v50 = a1[39];
    }

    a1[41] = v53;
  }

  a1[39] = (v50 + 1);
  v54 = *&a1[40] + 248 * v50;
  *(v54 + 192) = v97;
  *(v54 + 208) = v98;
  *(v54 + 224) = v99;
  *(v54 + 240) = v100;
  *(v54 + 128) = v93;
  *(v54 + 144) = v94;
  *(v54 + 160) = v95;
  *(v54 + 176) = v96;
  *(v54 + 64) = v89;
  *(v54 + 80) = v90;
  *(v54 + 96) = v91;
  *(v54 + 112) = v92;
  *v54 = v85;
  *(v54 + 16) = v86;
  *(v54 + 32) = v87;
  *(v54 + 48) = v88;
  v55 = a1[42];
  v56 = a1[44];
  if (v55 >= *&v56)
  {
    v57 = 2 * *&v56;
    v31 = *&v56 == 0;
    v58 = 64;
    if (!v31)
    {
      v58 = v57;
    }

    if (v58 <= v55)
    {
      v59 = v55 + 1;
    }

    else
    {
      v59 = v58;
    }

    if (v59)
    {
      a1[43] = malloc_type_realloc(*&a1[43], 4 * v59, 0x100004052888210uLL);
      v55 = a1[42];
    }

    a1[44] = v59;
  }

  a1[42] = (v55 + 1);
  *(*&a1[43] + 4 * v55) = a6;
  v60 = vadd_s32(a1[45], 0x100000001);
  a1[45] = v60;
  v61 = *(a7 + 652);
  if (v60.i32[1] >= v61 && a1[46].i32[1])
  {
    a1[45].i32[1] = 0;
    a1[46] = 1;
    v62 = a1[27];
    if (*&v62 <= v61)
    {
      return;
    }
  }

  else
  {
    a1[46].i32[0] = 0;
    v62 = a1[27];
    if (*&v62 <= v61)
    {
      return;
    }
  }

  v63 = *&v62 - 1;
  if (*&v62 != 1)
  {
    memmove(*&a1[28], (*&a1[28] + 168), 168 * v63);
    v63 = *&a1[27] - 1;
  }

  a1[27] = v63;
  v64 = a1[30];
  if (v64 < 1)
  {
    v67 = 0;
    goto LABEL_76;
  }

  v65 = a1[31];
  free(v65[1]);
  free(v65[4]);
  free(v65[7]);
  v64 = a1[30];
  if (v64 >= 2)
  {
    v66 = 0;
    v67 = 0;
    for (i = 1; i < v64; ++i)
    {
      while (1)
      {
        v69 = a1[31];
        v70 = *&v69 + v66;
        if (v69)
        {
          break;
        }

        free(*(v70 + 88));
        free(*(v70 + 112));
        free(*(v70 + 136));
        ++i;
        v64 = a1[30];
        v66 += 80;
        if (i >= v64)
        {
          goto LABEL_76;
        }
      }

      v71 = (*&v69 + 80 * *&v67);
      *v71 = *(v70 + 80);
      v72 = *(v70 + 96);
      v73 = *(v70 + 112);
      v74 = *(v70 + 144);
      v71[3] = *(v70 + 128);
      v71[4] = v74;
      v71[1] = v72;
      v71[2] = v73;
      ++*&v67;
      v64 = a1[30];
      v66 += 80;
    }

LABEL_76:
    v75 = a1[32];
    if (*&v67 <= v75)
    {
      goto LABEL_77;
    }

    goto LABEL_89;
  }

  v67 = 0;
  v75 = a1[32];
  if (v75 >= 0)
  {
LABEL_77:
    v76 = *&v67 - v64;
    if (*&v67 <= v64)
    {
      goto LABEL_78;
    }

LABEL_97:
    bzero((*&a1[31] + 80 * *&a1[30]), 80 * v76);
    a1[30] = v67;
    v77 = *&a1[33] - 1;
    if (*&a1[33] == 1)
    {
      goto LABEL_80;
    }

    goto LABEL_79;
  }

LABEL_89:
  v81 = 2 * v75;
  v31 = v75 == 0;
  v82 = 3;
  if (!v31)
  {
    v82 = v81;
  }

  if (v82 <= *&v67)
  {
    v83 = v67;
  }

  else
  {
    v83 = v82;
  }

  if (v83)
  {
    a1[31] = malloc_type_realloc(*&a1[31], 80 * v83, 0x1020040CF177B16uLL);
  }

  a1[32] = v83;
  v76 = *&v67 - v64;
  if (*&v67 > v64)
  {
    goto LABEL_97;
  }

LABEL_78:
  a1[30] = v67;
  v77 = *&a1[33] - 1;
  if (*&a1[33] != 1)
  {
LABEL_79:
    memmove(*&a1[34], (*&a1[34] + 16), 16 * v77);
    v77 = *&a1[33] - 1;
  }

LABEL_80:
  a1[33] = v77;
  v78 = *&a1[36] - 1;
  if (*&a1[36] != 1)
  {
    memmove(*&a1[37], (*&a1[37] + 112), 112 * v78);
    v78 = *&a1[36] - 1;
  }

  a1[36] = v78;
  v79 = *&a1[39] - 1;
  if (*&a1[39] != 1)
  {
    memmove(*&a1[40], (*&a1[40] + 248), 248 * v79);
    v79 = *&a1[39] - 1;
  }

  a1[39] = v79;
  v80 = *&a1[42] - 1;
  if (*&a1[42] != 1)
  {
    memmove(*&a1[43], (*&a1[43] + 4), 4 * v80);
    v80 = *&a1[42] - 1;
  }

  a1[42] = v80;
}

uint64_t update_history(uint64_t a1, int a2, __int128 *a3, uint64_t a4, __int128 *a5, __int128 *a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10)
{
  bzero(v47, 0x360uLL);
  v18 = a3[13];
  v61 = a3[12];
  v62 = v18;
  v63 = a3[14];
  v19 = *(a3 + 30);
  v20 = a3[9];
  v57 = a3[8];
  v58 = v20;
  v21 = a3[11];
  v59 = a3[10];
  v60 = v21;
  v22 = a3[5];
  v53 = a3[4];
  v54 = v22;
  v23 = a3[7];
  v55 = a3[6];
  v56 = v23;
  v24 = a3[1];
  v49 = *a3;
  v50 = v24;
  v25 = a3[3];
  v51 = a3[2];
  v52 = v25;
  v26 = *(a4 + 136);
  v27 = *(a4 + 168);
  v73 = *(a4 + 152);
  v74 = v27;
  v75 = *(a4 + 184);
  v28 = *(a4 + 72);
  v29 = *(a4 + 104);
  v69 = *(a4 + 88);
  v70 = v29;
  v71 = *(a4 + 120);
  v72 = v26;
  v30 = *(a4 + 40);
  v65 = *(a4 + 24);
  v66 = v30;
  v67 = *(a4 + 56);
  v68 = v28;
  v48 = a2;
  v31 = a5[9];
  v85 = a5[8];
  v86 = v31;
  v32 = a5[5];
  v81 = a5[4];
  v82 = v32;
  v33 = a5[7];
  v83 = a5[6];
  v84 = v33;
  v34 = a5[1];
  v77 = *a5;
  v78 = v34;
  v35 = a5[3];
  v79 = a5[2];
  v80 = v35;
  v36 = *(a5 + 20);
  v64 = v19;
  v87 = v36;
  if (a9)
  {
    v76 = *(a9 + 4);
  }

  v37 = *a8;
  if (*a8 <= 0)
  {
    v88 = 0u;
    v89 = v37;
    *&v88 = v37;
    goto LABEL_9;
  }

  v38 = malloc_type_malloc(288 * v37, 0x1000040A8CFB95EuLL);
  *(&v88 + 1) = v38;
  v39 = *a8;
  v89 = v39;
  if (v39 > 0)
  {
    v40 = v38;
    bzero(v38, 288 * v39);
    v41 = *a8;
    *&v88 = v41;
    if (v41 >= 1)
    {
      memcpy(v40, *(a8 + 8), 288 * v41);
      if (!a7)
      {
        goto LABEL_11;
      }

LABEL_10:
      v42 = a6[5];
      v94 = a6[4];
      v95 = v42;
      v96 = a6[6];
      v43 = a6[1];
      v90 = *a6;
      v91 = v43;
      v44 = a6[2];
      v93 = a6[3];
      v92 = v44;
      vl_inliers_clone(&v97, a7);
      goto LABEL_11;
    }

LABEL_9:
    if (!a7)
    {
      goto LABEL_11;
    }

    goto LABEL_10;
  }

  *&v88 = v39;
  if (a7)
  {
    goto LABEL_10;
  }

LABEL_11:
  vl_context_history_add_frame(a1, v47);
  v45 = *(a10 + 980);

  return vl_context_history_trim(a1, v45);
}

void vl_get_tile_from_gps(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v3 = *(a1 + 144);
  *a3 = v3;
  v4 = (a3 + 4);
  *(a3 + 8) = 0;
  v5 = (a3 + 8);
  *(a3 + 12) = 0;
  if (!v3)
  {
    printf("%sError : ", &str_2_2);
    printf("Map level not set");
    goto LABEL_5;
  }

  if (fabs(sqrt(*(a2 + 8) * *(a2 + 8) + *a2 * *a2 + *(a2 + 16) * *(a2 + 16)) + -6356752.0) < 10000.0)
  {
    printf("%sError : ", &str_2_2);
    printf("Does not seems to be a geoc position");
LABEL_5:

    putchar(10);
    return;
  }

  v7 = *(a2 + 24);
  v10[0] = 0uLL;
  v10[1] = vdupq_n_s64(0x41831BF8457C1095uLL);
  vl_geo_calc_tile(v10, a2, v3, v4, v5);
  v8 = *v5;
  *v5 = ~(-1 << v3) - *v4;
  *v4 = v8;
  v9 = uncertainty_limits;
  if (*&uncertainty_limits < v7)
  {
    v9 = dword_28087552C;
    if (*&dword_28087552C < v7)
    {
      v9 = dword_280875530;
    }
  }

  *(a3 + 12) = *&v9;
}

void vl_inliers_clone(uint64_t a1, uint64_t a2)
{
  if (*a2 >= 1)
  {
    v4 = malloc_type_malloc(8 * *a2, 0x100004000313F17uLL);
    *a1 = 0;
    *(a1 + 8) = v4;
    v5 = *a2;
    *(a1 + 16) = *a2;
    if (v5 < 1)
    {
      goto LABEL_4;
    }

    goto LABEL_3;
  }

  v4 = 0;
  *a1 = 0;
  *(a1 + 8) = 0;
  v5 = *a2;
  *(a1 + 16) = *a2;
  if (v5 >= 1)
  {
LABEL_3:
    bzero(v4, 8 * v5);
    v5 = *a2;
  }

LABEL_4:
  *a1 = v5;
  if (*a2 >= 1)
  {
    memcpy(*(a1 + 8), *(a2 + 8), 8 * *a2);
  }

  v6 = *(a2 + 24);
  if (v6 >= 1)
  {
    v7 = malloc_type_malloc(12 * v6, 0x10000403E1C8BA9uLL);
    *(a1 + 24) = 0;
    *(a1 + 32) = v7;
    v8 = *(a2 + 24);
    *(a1 + 40) = v8;
    if (v8 < 1)
    {
      goto LABEL_9;
    }

    goto LABEL_8;
  }

  v7 = 0;
  *(a1 + 24) = 0;
  *(a1 + 32) = 0;
  v8 = *(a2 + 24);
  *(a1 + 40) = v8;
  if (v8 >= 1)
  {
LABEL_8:
    bzero(v7, 12 * v8);
    v8 = *(a2 + 24);
  }

LABEL_9:
  *(a1 + 24) = v8;
  v9 = *(a2 + 24);
  if (v9 >= 1)
  {
    memcpy(*(a1 + 32), *(a2 + 32), 12 * v9);
  }

  v10 = *(a2 + 48);
  if (v10 >= 1)
  {
    v11 = malloc_type_malloc(8 * v10, 0x100004000313F17uLL);
    *(a1 + 48) = 0;
    *(a1 + 56) = v11;
    v12 = *(a2 + 48);
    *(a1 + 64) = v12;
    if (v12 < 1)
    {
      goto LABEL_14;
    }

    goto LABEL_13;
  }

  v11 = 0;
  *(a1 + 48) = 0;
  *(a1 + 56) = 0;
  v12 = *(a2 + 48);
  *(a1 + 64) = v12;
  if (v12 >= 1)
  {
LABEL_13:
    bzero(v11, 8 * v12);
    v12 = *(a2 + 48);
  }

LABEL_14:
  *(a1 + 48) = v12;
  v13 = *(a2 + 48);
  if (v13 >= 1)
  {
    v14 = *(a1 + 56);
    v15 = *(a2 + 56);

    memcpy(v14, v15, 8 * v13);
  }
}

void vl_ps_get_hyps(void *a1, uint64_t a2, uint64_t *a3, uint64_t a4)
{
  v6 = a1[6];
  v7 = *(a4 + 80);
  v8 = malloc_type_calloc(1uLL, 0x30uLL, 0x1030040F6295BD8uLL);
  *v8 = malloc_type_malloc(0x5B8uLL, 0x1080040A085CBA5uLL);
  v64 = v8;
  *(v8 + 2) = xmmword_2711057E0;
  if (*a3 >= 1)
  {
    v10 = a3[1];
    if (v10)
    {
      v11 = 0;
      v12 = 1;
LABEL_4:
      v13 = v10 + v11;
      free(*(v10 + v11 + 144));
      free(*(v13 + 120));
      free(*(v13 + 96));
      while (v12 < *a3)
      {
        v10 = a3[1];
        ++v12;
        v11 += 160;
        if (v10)
        {
          goto LABEL_4;
        }
      }
    }
  }

  *a3 = 0;
  v14 = v7 + 1;
  v15 = a3[2];
  if (v15 < v7 + 1)
  {
    if (v15)
    {
      v16 = 2 * v15;
    }

    else
    {
      v16 = 1;
    }

    if (v16 <= v14)
    {
      v17 = v7 + 1;
    }

    else
    {
      v17 = v16;
    }

    if (v17)
    {
      a3[1] = malloc_type_realloc(a3[1], 160 * v17, 0x10A004031866557uLL);
    }

    a3[2] = v17;
  }

  if ((v7 & 0x80000000) == 0)
  {
    bzero((a3[1] + 160 * *a3), 160 * v14);
  }

  v73 = v7;
  *a3 = v14;
  if (v6 < 1)
  {
    v19 = 0;
  }

  else
  {
    v18 = 0;
    v19 = 0;
    v75 = a3[1];
    v20 = v6 & 0x7FFFFFFF;
    do
    {
      v24 = *(a1[4] + 8 * (v18 / a1[7])) + 52 * (v18 % a1[7]);
      if (*(v24 + 44))
      {
        if (*(v64 + 9) != v19)
        {
          __assert_rtn("vl_ps_get_hyps", "vl_pose_ps.c", 228, "pq->n == hyp_added");
        }

        if (v19 == v14)
        {
          v21 = pqueue_delete(v64, 1, 0);
          free(*(v21 + 144));
          free(*(v21 + 120));
          free(*(v21 + 96));
          v19 = v14;
        }

        else
        {
          v21 = v75 + 160 * v19++;
        }

        *(v21 + 128) = 0u;
        *(v21 + 144) = 0u;
        *(v21 + 96) = 0u;
        *(v21 + 112) = 0u;
        *(v21 + 64) = 0u;
        *(v21 + 80) = 0u;
        *(v21 + 32) = 0u;
        *(v21 + 48) = 0u;
        *v21 = 0u;
        *(v21 + 16) = 0u;
        v22 = *(v24 + 44);
        *v21 = v22;
        LOWORD(v9) = *(v24 + 48);
        *(v21 + 20) = (v9 + 0.5) * 0.012272;
        v23 = *v24;
        *(v21 + 16) = *(v24 + 8);
        *(v21 + 8) = v23;
        *(v21 + 24) = *(v24 + 16);
        *(v21 + 32) = *(v24 + 24);
        *(v21 + 36) = 1011421147;
        pqueue_push(v64, v21, -v22 + *(v24 + 12) * 0.001);
      }

      ++v18;
    }

    while (v20 != v18);
  }

  if (v19 > v14)
  {
    __assert_rtn("vl_ps_get_hyps", "vl_pose_ps.c", 240, "hyp_added <= max_hyp+1");
  }

  v25 = *a3;
  v26 = a3[2];
  if (v26 >= v19)
  {
    v27 = a3[1];
    v28 = v19 - v25;
    if (v19 <= v25)
    {
      goto LABEL_33;
    }

LABEL_44:
    bzero(&v27[160 * *a3], 160 * v28);
    v27 = a3[1];
    *a3 = v19;
    if (v19)
    {
      goto LABEL_34;
    }

    goto LABEL_45;
  }

  if (v26)
  {
    v30 = 2 * v26;
  }

  else
  {
    v30 = 1;
  }

  if (v30 <= v19)
  {
    v31 = v19;
  }

  else
  {
    v31 = v30;
  }

  if (v31)
  {
    a3[1] = malloc_type_realloc(a3[1], 160 * v31, 0x10A004031866557uLL);
  }

  a3[2] = v31;
  v27 = a3[1];
  v28 = v19 - v25;
  if (v19 > v25)
  {
    goto LABEL_44;
  }

LABEL_33:
  *a3 = v19;
  if (v19)
  {
LABEL_34:
    qsort(v27, v19, 0xA0uLL, vl_ps_hyp_cmp);
    v29 = *a3;
    goto LABEL_46;
  }

LABEL_45:
  v29 = 0;
LABEL_46:
  if (v73 >= v19)
  {
    v32 = v19;
  }

  else
  {
    v32 = v73;
  }

  v33 = v32;
  v34 = a3[2];
  if (v34 < v33)
  {
    if (v34)
    {
      v36 = 2 * v34;
    }

    else
    {
      v36 = 1;
    }

    if (v36 <= v33)
    {
      v37 = v33;
    }

    else
    {
      v37 = v36;
    }

    if (v37)
    {
      a3[1] = malloc_type_realloc(a3[1], 160 * v37, 0x10A004031866557uLL);
    }

    a3[2] = v37;
    v35 = v33 - v29;
    if (v33 <= v29)
    {
LABEL_51:
      *a3 = v33;
      if (v33 < 1)
      {
        goto LABEL_67;
      }

      goto LABEL_63;
    }
  }

  else
  {
    v35 = v33 - v29;
    if (v33 <= v29)
    {
      goto LABEL_51;
    }
  }

  bzero((a3[1] + 160 * *a3), 160 * v35);
  *a3 = v33;
  if (v33 < 1)
  {
    goto LABEL_67;
  }

LABEL_63:
  v38 = *(a2 + 144);
  v39 = a3[1] + 44;
  do
  {
    *(v39 - 4) = xmmword_271105070;
    *(v39 + 12) = xmmword_271105070;
    *(v39 + 28) = 1065353216;
    *(v39 + 32) = *(v39 - 36);
    v76 = *(v39 - 24);
    *(v39 + 40) = *(v39 - 28);
    v54 = v38[59];
    v55 = v38[60];
    v56 = v38[58];
    v57 = (v54 * v54) - (v55 * v56);
    v58 = (v55 * v55) - (v56 * v54);
    v59 = (v56 * v56) - (v54 * v55);
    v60 = sqrt((((v58 * v58) + (v57 * v57)) + (v59 * v59)));
    v61 = 0.0;
    v62 = 0.0;
    v63 = 0.0;
    if (v60 > 0.0)
    {
      v61 = v57 / v60;
      v62 = v58 / v60;
      v63 = v59 / v60;
    }

    v40 = (v62 * v55) - (v63 * v54);
    v41 = (v63 * v56) - (v61 * v55);
    v69 = (v61 * v54) - (v62 * v56);
    *(v39 - 4) = v40;
    *v39 = v61;
    *(v39 + 8) = v41;
    *(v39 + 12) = v62;
    *(v39 + 20) = v69;
    *(v39 + 24) = v63;
    v42 = v38[58];
    *(v39 + 4) = v42;
    v43 = v38[59];
    *(v39 + 16) = v43;
    v68 = v38[60];
    v44 = atan2(v61, v40);
    v45 = __sincos_stret(-v44);
    cosval = v45.__cosval;
    sinval = v45.__sinval;
    v74 = (((cosval * v40) + 0.0) - (sinval * v61)) + (v42 * 0.0);
    v70 = (((cosval * v69) + 0.0) - (sinval * v63)) + (v68 * 0.0);
    v72 = (((cosval * v41) + 0.0) - (sinval * v62)) + (v43 * 0.0);
    v66 = (((sinval * v41) + 0.0) + (cosval * v62)) + (v43 * 0.0);
    v67 = (((sinval * v40) + 0.0) + (cosval * v61)) + (v42 * 0.0);
    v65 = (((sinval * v69) + 0.0) + (cosval * v63)) + (v68 * 0.0);
    v48 = (((v40 * 0.0) + 0.0) + (v61 * 0.0)) + v42;
    v49 = (((v41 * 0.0) + 0.0) + (v62 * 0.0)) + v43;
    v50 = (((v69 * 0.0) + 0.0) + (v63 * 0.0)) + v68;
    v51 = __sincos_stret(v76);
    v52 = v51.__cosval;
    v53 = v51.__sinval;
    *(v39 - 4) = (((v52 * v74) + 0.0) - (v53 * v67)) + (v48 * 0.0);
    *v39 = (((v52 * v72) + 0.0) - (v53 * v66)) + (v49 * 0.0);
    *(v39 + 4) = (((v52 * v70) + 0.0) - (v53 * v65)) + (v50 * 0.0);
    *(v39 + 8) = (((v53 * v74) + 0.0) + (v52 * v67)) + (v48 * 0.0);
    *(v39 + 12) = (((v53 * v72) + 0.0) + (v52 * v66)) + (v49 * 0.0);
    *(v39 + 16) = (((v53 * v70) + 0.0) + (v52 * v65)) + (v50 * 0.0);
    *(v39 + 20) = v48 + (((v74 * 0.0) + 0.0) + (v67 * 0.0));
    *(v39 + 24) = v49 + (((v72 * 0.0) + 0.0) + (v66 * 0.0));
    *(v39 + 28) = v50 + (((v70 * 0.0) + 0.0) + (v65 * 0.0));
    v39 += 160;
    --v33;
  }

  while (v33);
LABEL_67:
  if (*v64)
  {
    free(*v64);
  }

  if (*(v64 + 8))
  {
    free(v64[2]);
  }

  free(v64);
}

uint64_t vl_ps_hyp_cmp(float *a1, float *a2)
{
  if (*a1 > *a2)
  {
    return 0xFFFFFFFFLL;
  }

  if (*a1 < *a2)
  {
    return 1;
  }

  v3 = a1[2];
  v4 = a2[2];
  if (v3 < v4)
  {
    return 0xFFFFFFFFLL;
  }

  if (v3 > v4)
  {
    return 1;
  }

  v5 = a1[3];
  v6 = a2[3];
  if (v5 < v6)
  {
    return 0xFFFFFFFFLL;
  }

  if (v5 > v6)
  {
    return 1;
  }

  v7 = a1[4];
  v8 = a2[4];
  if (v7 < v8)
  {
    return 1;
  }

  if (v7 <= v8)
  {
    return 0;
  }

  return 0xFFFFFFFFLL;
}

void vl_ps_precomp_create(uint64_t a1, void *a2, uint64_t a3, uint64_t a4)
{
  v7 = a2[9];
  v8 = a2[18];
  v9 = *(v8 + 252);
  v10 = v9 != 0.0 && *(a4 + 64) != 0;
  v11 = *(v8 + 244);
  *a3 = v11;
  *(a3 + 8) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 40) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 48) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 56) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 64) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 16) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 24) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 32) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 72) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  *(a3 + 80) = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  if (v7 >= 1)
  {
    v12 = 0;
    v13 = 0;
    v14 = v7 & 0x7FFFFFFF;
    v15 = v9 + 0.785398163;
    while (1)
    {
      v22 = a2[10];
      v23 = *(v22 + v12 + 2);
      v24 = *(a2[1] + 4 * v23);
      v25 = *(a2[4] + 4 * v23);
      if (v10)
      {
        v16 = v11 + v24;
        *&v26 = (((v11 + v24) - *(*(a1 + 104) + 8 * *(v22 + v12) + 4)) + 3.1416) + 3.1416;
        if (v15 < fabsf((*&v26 + (((__PAIR64__((*&v26 * 0.15915), v26) - COERCE_UNSIGNED_INT(0.0)) >> 32) * -6.2832)) + -3.1416))
        {
          goto LABEL_8;
        }
      }

      else
      {
        v16 = v11 + v24;
      }

      v17 = (*(a1 + 8) + 12 * *(v22 + v12));
      *(*(a3 + 8) + 4 * v13) = *(v22 + v12);
      v18 = __sincosf_stret(v16);
      v19 = *(a3 + 32);
      *(*(a3 + 40) + 4 * v13) = v18.__cosval;
      v20 = *(a3 + 56);
      *(*(a3 + 48) + 4 * v13) = v18.__sinval;
      *(v20 + 4 * v13) = v25;
      *(*(a3 + 64) + 4 * v13) = v24;
      v21 = *(a3 + 24);
      *(*(a3 + 16) + 4 * v13) = *v17;
      *(v21 + 4 * v13) = v17[1];
      *(v19 + 4 * v13++) = v17[2];
LABEL_8:
      v12 += 4;
      if (!--v14)
      {
        goto LABEL_13;
      }
    }
  }

  v13 = 0;
LABEL_13:
  *(a3 + 4) = v13;
}

BOOL vl_ps_cam_init(uint64_t a1)
{
  v1 = MEMORY[0x28223BE20](a1);
  v5 = v4;
  v6 = v3;
  v8 = v7;
  v9 = v1;
  v163[2185] = *MEMORY[0x277D85DE8];
  v154 = v2;
  v10 = *v2;
  v149 = v11;
  if (v11)
  {
    v12 = *v2;
  }

  else
  {
    LODWORD(v12) = 0;
  }

  v158 = v12;
  v13 = v3[3];
  v14 = malloc_type_malloc(4 * v13, 0x100004052888210uLL);
  if (*(v5 + 28) > 1)
  {
    printf("%sError : ", "");
    printf("Can not run with more than %d nn", 1);
    putchar(10);
  }

  if (v13 < 1)
  {
    goto LABEL_13;
  }

  v15 = v13 & 0x7FFFFFFF;
  if (v15 >= 8)
  {
    v16 = v15 - (v13 & 7);
    v17 = xmmword_271103920;
    v18 = v14 + 1;
    v19.i64[0] = 0x400000004;
    v19.i64[1] = 0x400000004;
    v20.i64[0] = 0x800000008;
    v20.i64[1] = 0x800000008;
    v21 = v16;
    do
    {
      v18[-1] = v17;
      *v18 = vaddq_s32(v17, v19);
      v17 = vaddq_s32(v17, v20);
      v18 += 2;
      v21 -= 8;
    }

    while (v21);
    if ((v13 & 7) == 0)
    {
      goto LABEL_13;
    }
  }

  else
  {
    v16 = 0;
  }

  do
  {
    v14->i32[v16] = v16;
    ++v16;
  }

  while (v15 != v16);
LABEL_13:
  v150 = v8;
  v22 = malloc_type_malloc(0x200uLL, 0x100004000313F17uLL);
  if (!(v13 << 32))
  {
    goto LABEL_82;
  }

  v23 = 0;
  v24 = v13;
  v25 = v163;
  v26 = 1;
  v27 = 32;
  v28 = v14;
  v147 = v10;
  do
  {
    v29 = v23;
    while (1)
    {
      if (!v26)
      {
        --v29;
        v30 = &v22[16 * v29];
        v24 = *(v30 + 1);
        v28 = &v14->i8[4 * *v30];
      }

      if (v24 > 15)
      {
        break;
      }

      if (v24 > 1)
      {
        v31 = 0;
        v32 = v6[4];
        v33 = (v28 + 4);
        for (i = 1; i != v24; ++i)
        {
          v35 = v31;
          do
          {
            v36 = v33[v35];
            v37 = *&v28[4 * v35];
            if (*(v32 + 8 * v36) >= *(v32 + 8 * v37))
            {
              break;
            }

            v33[v35] = v37;
            *&v28[4 * v35] = v36;
            v38 = v35-- + 1;
          }

          while (v38 > 1);
          ++v31;
        }
      }

      v26 = 0;
      v24 = 0;
      if (v29 < 1)
      {
        goto LABEL_82;
      }
    }

    if (v24 <= 0x27)
    {
      v39 = v24 >> 1;
      v40 = v6[4];
      v41 = *v28;
      v42 = *(v40 + 8 * v41);
      v43 = *(v40 + 8 * *&v28[4 * (v24 >> 1)]);
      v44 = *(v40 + 8 * *&v28[4 * v24 - 4]);
      if (v42 >= v43)
      {
        if (v42 >= v44)
        {
          if (v43 < v44)
          {
            v39 = v24 - 1;
          }
        }

        else
        {
          v39 = 0;
        }
      }

      else if (v43 >= v44)
      {
        if (v42 >= v44)
        {
          v39 = 0;
        }

        else
        {
          v39 = v24 - 1;
        }
      }

      goto LABEL_64;
    }

    v45 = 0;
    v46 = 0;
    if (v24 <= 0x7D0)
    {
      v47 = 8;
    }

    else
    {
      v47 = 26;
    }

    if (v24 <= 0x7D0)
    {
      v48 = 3;
    }

    else
    {
      v48 = 9;
    }

    v40 = v6[4];
    do
    {
      v49 = (v24 - 1 + v45) / v47;
      v50 = *(v40 + 8 * *&v28[4 * (v45 / v47)]);
      v51 = *(v40 + 8 * *&v28[4 * v49]);
      v52 = (2 * v24 - 2 + v45) / v47;
      v53 = *(v40 + 8 * *&v28[4 * v52]);
      if (v50 >= v51)
      {
        if (v50 < v53)
        {
          goto LABEL_47;
        }

        if (v51 >= v53)
        {
LABEL_40:
          v162[v46] = v49;
          goto LABEL_41;
        }
      }

      else
      {
        if (v51 < v53)
        {
          goto LABEL_40;
        }

        if (v50 >= v53)
        {
LABEL_47:
          v162[v46] = v45 / v47;
          goto LABEL_41;
        }
      }

      v162[v46] = v52;
LABEL_41:
      ++v46;
      v45 += 3 * v24 - 3;
    }

    while (v48 != v46);
    while (2)
    {
      v54 = v48;
      v48 /= 3uLL;
      v55 = v162;
      v56 = v25;
      v57 = v48;
      do
      {
        v58 = *(v56 - 2);
        v59 = *(v56 - 1);
        v60 = *(v40 + 8 * *&v28[4 * v58]);
        v61 = *(v40 + 8 * *&v28[4 * v59]);
        v62 = *(v40 + 8 * *&v28[4 * *v56]);
        if (v60 >= v61)
        {
          if (v60 < v62)
          {
            goto LABEL_60;
          }

          if (v61 >= v62)
          {
LABEL_53:
            *v55 = v59;
            goto LABEL_54;
          }
        }

        else
        {
          if (v61 < v62)
          {
            goto LABEL_53;
          }

          if (v60 >= v62)
          {
LABEL_60:
            *v55 = v58;
            goto LABEL_54;
          }
        }

        *v55 = *v56;
LABEL_54:
        v56 += 3;
        ++v55;
        --v57;
      }

      while (v57);
      if (v54 >= 9)
      {
        continue;
      }

      break;
    }

    v39 = v162[0];
    LODWORD(v41) = *v28;
LABEL_64:
    v63 = 0;
    v64 = 0;
    *v28 = *&v28[4 * v39];
    *&v28[4 * v39] = v41;
    for (j = 1; j != v24; ++j)
    {
      v66 = *&v28[4 * j];
      if ((*(v40 + 8 * v66) - *(v40 + 8 * *v28)) <= 0.0)
      {
        ++v63;
        *&v28[4 * j] = *&v28[4 * v63];
        *&v28[4 * v63] = v66;
        if ((*(v40 + 8 * *&v28[4 * j]) - *(v40 + 8 * *v28)) == 0.0)
        {
          ++v64;
          *&v28[4 * v63] = *&v28[4 * v64];
          *&v28[4 * v64] = v66;
        }
      }
    }

    v67 = 4 * v63 - 4 * v64;
    v68 = v64;
    do
    {
      v69 = *&v28[v67];
      *&v28[v67] = *&v28[4 * v68];
      *&v28[4 * v68] = v69;
      v67 += 4;
    }

    while (v68-- > 0);
    v23 = v29 + 1;
    if (v29 + 1 >= v27)
    {
      v156 = 2 * v27;
      v71 = v25;
      v22 = malloc_type_realloc(v22, 32 * v27, 0x100004000313F17uLL);
      v23 = v29 + 1;
      v25 = v71;
      v27 = v156;
    }

    v72 = &v22[16 * v29];
    *v72 = v63 + ((v28 - v14) >> 2) + 1;
    *(v72 + 1) = v24 + ~v63;
    v24 = v63 - v64;
    v26 = v63 != v64;
    v10 = v147;
  }

  while ((v29 & 0x8000000000000000) == 0 || v24);
LABEL_82:
  free(v22);
  v73 = *v6;
  v74 = *(v5 + 132) * v73;
  if (v74 <= v73)
  {
    v73 = *(v5 + 132) * v73;
  }

  v75 = v74 < 0.0;
  v76 = 0.0;
  if (!v75)
  {
    v76 = v73;
  }

  v77 = v76;
  *(v9 + 72) = 0;
  if (v77 >= 1)
  {
    v78 = 0;
    v79 = 0;
    LODWORD(v80) = *(v5 + 28);
    v160 = v76;
    do
    {
      v81 = (v6[1] + 8 * v14->i32[v79]);
      if ((*v81 & 0x80000000) != 0)
      {
        if (v80 != 1)
        {
          __assert_rtn("vl_ps_cam_init", "vl_pose_ps.c", 463, "par->nn == 1 && does not work for nn > 1, fix or remove");
        }

        LODWORD(v80) = 1;
      }

      else if (v80 >= 1)
      {
        v82 = v6;
        v83 = v10;
        v84 = 0;
        do
        {
          v86 = *(v9 + 88);
          if (v78 >= v86)
          {
            if (v86)
            {
              v87 = 2 * v86;
            }

            else
            {
              v87 = 64;
            }

            if (v87 <= v78)
            {
              v88 = v78 + 1;
            }

            else
            {
              v88 = v87;
            }

            if (v88)
            {
              *(v9 + 80) = malloc_type_realloc(*(v9 + 80), 4 * v88, 0x100004052888210uLL);
              v78 = *(v9 + 72);
            }

            *(v9 + 88) = v88;
          }

          *(v9 + 72) = v78 + 1;
          *(*(v9 + 80) + 4 * v78) = 0;
          v78 = *(v9 + 72);
          v85 = *(v9 + 80) + 4 * v78;
          *(v85 - 2) = v14->i32[v79];
          *(v85 - 4) = v81[v84++];
          v80 = *(v5 + 28);
        }

        while (v84 < v80);
        v10 = v83;
        v6 = v82;
        v77 = v160;
      }

      ++v79;
    }

    while (v79 != v77);
  }

  printf("Spam : ");
  printf("# correspondences used in scoring : %llu", *(v9 + 72));
  putchar(10);
  free(v14);
  v89 = *(v9 + 72);
  v90 = *v9;
  v91 = v158 + v10;
  v92 = *(v9 + 16);
  if (v91 <= v92)
  {
    v97 = v91 - v90;
    if (v91 <= v90)
    {
      goto LABEL_115;
    }
  }

  else
  {
    v93 = 2 * v92;
    v94 = v92 == 0;
    v95 = 64;
    if (!v94)
    {
      v95 = v93;
    }

    if (v95 <= v91)
    {
      v96 = v158 + v10;
    }

    else
    {
      v96 = v95;
    }

    if (v96)
    {
      *(v9 + 8) = malloc_type_realloc(*(v9 + 8), 4 * v96, 0x100004052888210uLL);
    }

    *(v9 + 16) = v96;
    v97 = v91 - v90;
    if (v91 <= v90)
    {
LABEL_115:
      *v9 = v91;
      v98 = *(v9 + 24);
      v99 = *(v9 + 40);
      if (v91 > v99)
      {
        goto LABEL_116;
      }

LABEL_136:
      v103 = v91 - v98;
      if (v91 > v98)
      {
        goto LABEL_137;
      }

LABEL_124:
      *(v9 + 24) = v91;
      v104 = *(v9 + 48);
      v105 = *(v9 + 64);
      if (v91 > v105)
      {
        goto LABEL_125;
      }

LABEL_138:
      v109 = v91 - v104;
      if (v91 > v104)
      {
        goto LABEL_139;
      }

      goto LABEL_140;
    }
  }

  bzero((*(v9 + 8) + 4 * *v9), 4 * v97);
  *v9 = v91;
  v98 = *(v9 + 24);
  v99 = *(v9 + 40);
  if (v91 <= v99)
  {
    goto LABEL_136;
  }

LABEL_116:
  v100 = 2 * v99;
  v94 = v99 == 0;
  v101 = 64;
  if (!v94)
  {
    v101 = v100;
  }

  if (v101 <= v91)
  {
    v102 = v158 + v10;
  }

  else
  {
    v102 = v101;
  }

  if (v102)
  {
    *(v9 + 32) = malloc_type_realloc(*(v9 + 32), 4 * v102, 0x100004052888210uLL);
  }

  *(v9 + 40) = v102;
  v103 = v91 - v98;
  if (v91 <= v98)
  {
    goto LABEL_124;
  }

LABEL_137:
  bzero((*(v9 + 32) + 4 * *(v9 + 24)), 4 * v103);
  *(v9 + 24) = v91;
  v104 = *(v9 + 48);
  v105 = *(v9 + 64);
  if (v91 <= v105)
  {
    goto LABEL_138;
  }

LABEL_125:
  v106 = 2 * v105;
  v94 = v105 == 0;
  v107 = 32;
  if (!v94)
  {
    v107 = v106;
  }

  if (v107 <= v91)
  {
    v108 = v158 + v10;
  }

  else
  {
    v108 = v107;
  }

  if (v108)
  {
    *(v9 + 56) = malloc_type_realloc(*(v9 + 56), 8 * v108, 0x100004000313F17uLL);
  }

  *(v9 + 64) = v108;
  v109 = v91 - v104;
  if (v91 > v104)
  {
LABEL_139:
    bzero((*(v9 + 56) + 8 * *(v9 + 48)), 8 * v109);
  }

LABEL_140:
  *(v9 + 48) = v91;
  v110 = v150[58];
  v111 = v150[59];
  v112 = v150[60];
  v113 = sqrtf(((v111 * v111) + (v110 * v110)) + (v112 * v112));
  v114 = 0.0;
  v115 = 0.0;
  v116 = 0.0;
  if (v113 > 0.0)
  {
    v114 = v110 / v113;
    v115 = v111 / v113;
    v116 = v112 / v113;
  }

  v117 = (v116 * -0.0) + (v115 * 0.0);
  v118 = v116 + (v114 * -0.0);
  v119 = -(v115 - (v114 * 0.0));
  v120 = ((v118 * v118) + (v117 * v117)) + (v119 * v119);
  v148 = sqrt(v120);
  v161 = v115;
  v159 = v116;
  if (v148 <= 0.00001)
  {
    printf("%sError : ", "");
    printf("fix this case if needed");
    putchar(10);
    v116 = v159;
    v115 = v161;
  }

  v121 = sqrtf(v120);
  v155 = v114;
  v157 = 0.0;
  v122 = 0.0;
  v123 = 0.0;
  if (v121 > 0.0)
  {
    v157 = v117 / v121;
    v122 = v118 / v121;
    v123 = v119 / v121;
  }

  if (v89 >= 1)
  {
    v124 = (v123 * v114) - (v157 * v116);
    v125 = (v157 * v115) - (v122 * v114);
    v152 = ((v122 * v116) - (v123 * v115)) + 0.0;
    v153 = (v122 * v116) - (v123 * v115);
    v151 = v114 + 0.0;
    v126 = v89 & 0x7FFFFFFF;
    v127 = 2;
    do
    {
      v140 = *(*(v9 + 80) + v127);
      if (v140 >= v10)
      {
        v128 = (*(v149 + 8) + 268 * (v140 - v10));
        v130 = *v128;
        v129 = v128[1];
        v131 = v128[2];
        v132 = (((v153 * *v128) + 0.0) + (v124 * v129)) + (v125 * v131);
        v133 = (((v157 * *v128) + 0.0) + (v122 * v129)) + (v123 * v131);
        v134 = 1.0 / sqrtf((v133 * v133) + (v132 * v132));
        v135 = ((((v155 * *v128) + 0.0) + (v115 * v129)) + (v116 * v131)) * v134;
        v136 = atan2f(v133 * v134, v132 * v134);
        v137 = 1065353216;
        v138 = v131 / v130;
      }

      else
      {
        v141 = v154[1] + 288 * *(*(v9 + 80) + v127);
        v142 = *v141;
        v138 = *(v141 + 4);
        v143 = (v152 + (v124 * *v141)) + (v125 * v138);
        v144 = ((v157 + 0.0) + (v122 * *v141)) + (v123 * v138);
        v145 = 1.0 / sqrtf((v144 * v144) + (v143 * v143));
        v135 = ((v151 + (v115 * *v141)) + (v116 * v138)) * v145;
        v136 = atan2((v144 * v145), (v143 * v145));
        v137 = LODWORD(v142);
      }

      *(*(v9 + 8) + 4 * v140) = v136;
      *(*(v9 + 32) + 4 * v140) = v135;
      v139 = *(v9 + 56) + 8 * v140;
      *v139 = v137;
      *(v139 + 4) = v138;
      v127 += 4;
      --v126;
      v115 = v161;
      v116 = v159;
    }

    while (v126);
  }

  result = v148 <= 0.00001;
  *(v9 + 144) = v150;
  return result;
}

uint64_t vl_ps_grid_cell_add(uint64_t a1)
{
  v1 = *(a1 + 76);
  if (v1 == -1)
  {
    v4 = *(a1 + 48);
    v5 = *(a1 + 56);
    if (v4 == *(a1 + 24) * v5)
    {
      v6 = a1;
      if ((52 * v5) >> 31 >= 5)
      {
        __assert_rtn("vl_ps_grid_cell_add", "vl_pose_ps.c", 535, "n_bytes < 10*GB && Page size too large, try allocating smaller pages");
      }

      v7 = malloc_type_malloc(52 * v5, 0x1000040B62306B4uLL);
      a1 = v6;
      v8 = *(v6 + 24);
      v9 = *(v6 + 40);
      if (v8 >= v9)
      {
        v10 = 2 * v9;
        v11 = v9 == 0;
        v12 = 32;
        if (!v11)
        {
          v12 = v10;
        }

        if (v12 <= v8)
        {
          v13 = v8 + 1;
        }

        else
        {
          v13 = v12;
        }

        if (v13)
        {
          v14 = malloc_type_realloc(*(v6 + 32), 8 * v13, 0x2004093837F09uLL);
          a1 = v6;
          *(v6 + 32) = v14;
          v8 = *(v6 + 24);
        }

        *(a1 + 40) = v13;
      }

      *(a1 + 24) = v8 + 1;
      *(*(a1 + 32) + 8 * v8) = 0;
      *(*(a1 + 32) + 8 * *(a1 + 24) - 8) = v7;
      v4 = *(a1 + 48);
      v5 = *(a1 + 56);
    }

    if (v4 % v5)
    {
      v15 = *(a1 + 64) + 52;
    }

    else
    {
      v15 = *(*(a1 + 32) + 8 * (v4 / v5)) + 52 * (v4 % v5);
    }

    *(a1 + 64) = v15;
    *(a1 + 48) = v4 + 1;
    *(v15 + 48) = 0;
    *(v15 + 16) = 0u;
    *(v15 + 32) = 0u;
    *v15 = 0u;
    v2 = *(a1 + 64);
    v3 = *(a1 + 48) - 1;
  }

  else
  {
    v2 = *(*(a1 + 32) + 8 * (v1 / *(a1 + 56))) + 52 * (v1 % *(a1 + 56));
    if (*(v2 + 28) != -1)
    {
      __assert_rtn("vl_ps_grid_cell_add", "vl_pose_ps.c", 528, "c->sub_region_flag == -1");
    }

    v3 = *(v2 + 36);
    *(a1 + 76) = *(v2 + 40);
    *(v2 + 16) = 0u;
    *(v2 + 32) = 0u;
    *(v2 + 48) = 0;
    *v2 = 0u;
  }

  *(v2 + 36) = v3;
  *(v2 + 40) = -1;
  return v2;
}

float vl_ps_grid_setup(uint64_t a1, double *a2, __int128 *a3, int *a4, uint64_t a5, float a6)
{
  v12 = *(a5 + 16);
  v13 = ceilf((a6 + a6) / v12);
  if (v13 < 1.0)
  {
    v14 = 1;
    if (*(a5 + 48) < 1)
    {
      goto LABEL_9;
    }

    goto LABEL_8;
  }

  if (v13 <= 512.0)
  {
    v14 = v13;
    if (*(a5 + 48) < 1)
    {
      goto LABEL_9;
    }

    goto LABEL_8;
  }

  v14 = 512;
  if (*(a5 + 48) >= 1)
  {
LABEL_8:
    printf("Verbose : ");
    printf("vl_ps_grid_setup: Testing %d cells (Search radius: %.1f m)\n", v14 * v14, a6);
    putchar(10);
  }

LABEL_9:
  v15 = *a3;
  *(a1 + 16) = *(a3 + 2);
  *a1 = v15;
  if (v14 >= 1)
  {
    v16 = 0;
    v17 = (v14 - 1);
    v18 = 0.0;
    v19 = -0.5;
    while (1)
    {
      v20 = 0;
      v21 = v12 * (v16 + (v17 * v19));
      v22 = v21 * v21;
      v44 = v21;
      do
      {
        while (1)
        {
          while (1)
          {
            __nel = 0;
            __base = 0;
            v47 = 0;
            v23 = v12 * (v20 + (v17 * v19));
            v24 = v22 + (v23 * v23);
            if (v24 < (((v12 * 0.5) * v14) * ((v12 * 0.5) * v14)))
            {
              break;
            }

            free(0);
            if (++v20 == v14)
            {
              goto LABEL_11;
            }
          }

          v25 = *(a1 + 8);
          v26 = *a1 + v23;
          v27 = v25 + v44;
          if (v18 <= v24)
          {
            v18 = v22 + (v23 * v23);
          }

          v28 = v25 + v44;
          vl_height_get_for_cs(a4, a2, &__nel, v26, v28);
          if (__nel)
          {
            v29 = __base;
            qsort(__base, __nel, 4uLL, cmp_float_asc_0);
            v30 = __nel;
            if (__nel < 2)
            {
              __nel = 1;
              break;
            }

            v31 = v29;
            v32 = 1;
            v33 = 1;
            do
            {
              v35 = v29;
              v36 = v29[1];
              ++v29;
              if (*v31 == v36)
              {
                v34 = v31;
              }

              else
              {
                v34 = v31 + 1;
                ++v32;
                if (v35 != v31)
                {
                  *v34 = *v29;
                  v30 = __nel;
                }
              }

              ++v33;
              v31 = v34;
            }

            while (v33 < v30);
            __nel = v32;
            if (v32 > 0)
            {
              break;
            }
          }

          v19 = -0.5;
          free(__base);
          if (++v20 == v14)
          {
            goto LABEL_11;
          }
        }

        v37 = 0;
        v38 = sqrtf(v24);
        do
        {
          v39 = vl_ps_grid_cell_add(a1);
          *v39 = v26;
          *(v39 + 4) = v27;
          *(v39 + 12) = v38;
          *(v39 + 16) = v12;
          v40 = *(a5 + 20);
          *(v39 + 20) = v12;
          *(v39 + 24) = v40;
          v42 = __nel;
          v41 = __base;
          *(v39 + 8) = *(__base + v37++) - *(a5 + 60);
        }

        while (v42 > v37);
        v19 = -0.5;
        free(v41);
        ++v20;
      }

      while (v20 != v14);
LABEL_11:
      if (++v16 == v14)
      {
        goto LABEL_34;
      }
    }
  }

  v18 = 0.0;
LABEL_34:
  if (*(a5 + 48) >= 1)
  {
    printf("Verbose : ");
    printf("vl_ps_grid_setup: Added %d cells of size %f from a %d x %d = grid.", *(a1 + 48), v12, v14, v14);
    putchar(10);
  }

  result = sqrtf(v18);
  *(a1 + 72) = result;
  return result;
}

uint64_t cmp_float_asc_0(float *a1, float *a2)
{
  if (*a1 >= *a2)
  {
    v2 = 1;
  }

  else
  {
    v2 = -1;
  }

  if (*a1 == *a2)
  {
    return 0;
  }

  else
  {
    return v2;
  }
}

void vl_ps_get_inliers(uint64_t a1, uint64_t a2, uint64_t a3, char *a4)
{
  v7 = *(a2 + 4);
  v8 = a4;
  if (!a4)
  {
    v8 = malloc_type_calloc(v7, 4uLL, 0x100004052888210uLL);
  }

  v9 = __sincos_stret((*(a1 + 20) - *a2));
  v10 = *(a1 + 36) * 0.5;
  v11 = malloc_type_malloc(4 * v7, 0x100004052888210uLL);
  v12 = malloc_type_malloc(4 * v7, 0x100004052888210uLL);
  v52 = 0u;
  v53 = 0u;
  v54 = 0;
  v50 = *(a1 + 8);
  v51 = *(a1 + 16);
  *(&v52 + 4) = *(a1 + 24);
  HIDWORD(v52) = *(a1 + 32);
  v14 = *(a2 + 40);
  v15 = *(a2 + 48);
  if (v7 >= 1)
  {
    v16 = -v9.__sinval;
    if (v7 < 8)
    {
      v17 = 0;
LABEL_6:
      v18 = v7 - v17;
      v19 = 4 * v17;
      v20 = v12 + v17;
      v21 = (v11 + v19);
      v22 = (v15 + v19);
      v23 = (v14 + v19);
      do
      {
        v24 = *v23++;
        v25 = v24;
        v26 = *v22++;
        v27 = v16 * v26 + v9.__cosval * v25;
        v13.f64[0] = v9.__cosval * v26 + v9.__sinval * v25;
        *v13.f64 = v13.f64[0];
        *v21++ = v27;
        *v20++ = LODWORD(v13.f64[0]);
        --v18;
      }

      while (v18);
      goto LABEL_8;
    }

    v17 = 0;
    if ((v12 - v11) < 8)
    {
      goto LABEL_6;
    }

    if (v11 - v14 < 8)
    {
      goto LABEL_6;
    }

    if (v11 - v15 < 8)
    {
      goto LABEL_6;
    }

    if (v12 - v14 < 8)
    {
      goto LABEL_6;
    }

    if (v12 - v15 < 8)
    {
      goto LABEL_6;
    }

    v17 = v7 & 0x7FFFFFFE;
    v13 = vdupq_lane_s64(*&v9.__cosval, 0);
    v37 = v17;
    v38 = vdupq_lane_s64(*&v9.__sinval, 0);
    v39 = v12;
    v40 = v11;
    v41 = *(a2 + 48);
    v42 = *(a2 + 40);
    do
    {
      v43 = *v42++;
      v44 = vcvtq_f64_f32(v43);
      v45 = *v41++;
      v46 = vcvtq_f64_f32(v45);
      *v40++ = vcvt_f32_f64(vmlaq_f64(vmulq_n_f64(v46, v16), v44, v13));
      *v39++ = vcvt_f32_f64(vmlaq_f64(vmulq_n_f64(v46, v9.__cosval), v44, v38));
      v37 -= 2;
    }

    while (v37);
    if (v17 != v7)
    {
      goto LABEL_6;
    }
  }

LABEL_8:
  *(a2 + 40) = v11;
  *(a2 + 48) = v12;
  LODWORD(v13.f64[0]) = *(a3 + 136);
  vl_ps_filter_corr(&v50, a2, a2, v8, v10, v13.f64[0]);
  v47 = *(a2 + 40);
  v48 = *(a2 + 48);
  *(a2 + 40) = v14;
  *(a2 + 48) = v15;
  *(a1 + 88) = 0;
  if (v7 >= 1)
  {
    v28 = 0;
    v29 = 0;
    do
    {
      if (*&v8[v28])
      {
        v31 = (*(a2 + 8) + v28);
        v32 = *v31;
        v33 = v31[1];
        v34 = *(a1 + 104);
        if (v29 >= v34)
        {
          if (v34)
          {
            v35 = 2 * v34;
          }

          else
          {
            v35 = 32;
          }

          if (v35 <= v29)
          {
            v36 = v29 + 1;
          }

          else
          {
            v36 = v35;
          }

          if (v36)
          {
            *(a1 + 96) = malloc_type_realloc(*(a1 + 96), 8 * v36, 0x100004000313F17uLL);
            v29 = *(a1 + 88);
          }

          *(a1 + 104) = v36;
        }

        v30 = (*(a1 + 96) + 8 * v29++);
        *(a1 + 88) = v29;
        *v30 = v32;
        v30[1] = v33;
      }

      v28 += 4;
    }

    while (4 * v7 != v28);
  }

  free(v47);
  free(v48);
  if (!a4)
  {

    free(v8);
  }
}

uint64_t vl_ps_filter_corr(float *a1, uint64_t a2, uint64_t a3, uint64_t a4, float a5, double a6)
{
  v6.f32[0] = a5;
  v11 = *(a2 + 4);
  v13 = __sincosf_stret(a5);
  *v12.i32 = v13.__cosval;
  v14 = a1[4] * 0.5;
  v15 = a1[6] * 0.5;
  v16 = a1;
  v18 = vld1q_dup_f32(v16);
  v17 = v16 + 1;
  if (v11 <= 0)
  {
    v19 = -(-v11 & 3);
  }

  else
  {
    v19 = v11 & 3;
  }

  v20 = (v11 - v19);
  if (v20 < 1)
  {
    result = 0;
    LODWORD(v23) = 0;
    v28 = *&a6;
  }

  else
  {
    v21 = 0;
    result = 0;
    v23 = 0;
    v24 = vld1q_dup_f32(v17);
    v25 = a1 + 2;
    v26 = vld1q_dup_f32(v25);
    v27 = vdupq_lane_s32(v12, 0);
    v28 = *&a6;
    v29 = vdupq_lane_s32(*&a6, 0);
    v30 = vdup_lane_s32(vcgt_f32(v6, 0), 0);
    __asm { FMOV            V19.4S, #1.0 }

    v35.i64[0] = 0x3F0000003F000000;
    v35.i64[1] = 0x3F0000003F000000;
    v36.i64[0] = 0x8000000080000000;
    v36.i64[1] = 0x8000000080000000;
    do
    {
      v37 = *(*(a2 + 40) + v21);
      v38 = *(*(a2 + 48) + v21);
      v39 = vsubq_f32(*(*(a2 + 16) + v21), v18);
      v40 = vsubq_f32(*(*(a2 + 24) + v21), v24);
      v41 = vaddq_f32(vmulq_f32(v39, v39), vmulq_f32(v40, v40));
      v42 = vdivq_f32(_Q19, vsqrtq_f32(v41));
      v43 = vmulq_n_f32(v42, v14);
      v44 = vsubq_f32(_Q19, vmulq_f32(vmulq_f32(v43, v43), v35));
      v45 = vmulq_f32(v42, vaddq_f32(vmulq_f32(v39, v37), vmulq_f32(v40, v38)));
      v46 = vmovl_s16(vand_s8(vmovn_s32(vandq_s8(vcgtq_f32(v29, vsubq_f32(vabdq_f32(vmulq_f32(vsubq_f32(*(*(a2 + 32) + v21), v26), v42), *(*(a2 + 56) + v21)), vmulq_n_f32(v42, v15))), vcgtq_f32(v41, v35))), vorn_s8(vand_s8(vmovn_s32(vorrq_s8(vcltzq_f32(vminnmq_f32(vaddq_f32(v27, v44), v44)), vcgtq_f32(v45, vsubq_f32(vmulq_n_f32(v44, v13.__cosval), vmulq_n_f32(v43, v13.__sinval))))), v30), v30)));
      *(a4 + v21) = v46;
      v47 = vqtbl1q_s8(v46, xmmword_2711057F0).u32[0];
      if (v47)
      {
        v48 = vmulq_f32(vaddq_f32(v45, _Q19), vorrq_s8(vandq_s8(vsubq_f32(vmulq_f32(v40, v37), vmulq_f32(v39, v38)), v36), _Q19));
        v49 = *(a3 + 72);
        v50 = *(a3 + 80);
        *(v49 + 4 * result) = v43.i32[0];
        *(v50 + 4 * result) = v48.i32[0];
        if (v47)
        {
          v51 = result + 1;
        }

        else
        {
          v51 = result;
        }

        v52 = 4 * v51;
        *(v49 + v52) = v43.i32[1];
        *(v50 + v52) = v48.i32[1];
        if ((v47 & 0xFF00) != 0)
        {
          ++v51;
        }

        v53 = 4 * v51;
        *(v49 + v53) = v43.i32[2];
        *(v50 + v53) = v48.i32[2];
        if ((v47 & 0xFF0000) != 0)
        {
          ++v51;
        }

        v54 = 4 * v51;
        *(v49 + v54) = v43.i32[3];
        *(v50 + v54) = v48.i32[3];
        if ((v47 & 0xFF000000) != 0)
        {
          result = v51 + 1;
        }

        else
        {
          result = v51;
        }
      }

      v23 += 4;
      v21 += 16;
    }

    while (v23 < v20);
  }

  if (v23 < v11)
  {
    v55 = *(a2 + 16);
    v56 = *(a2 + 24);
    v57 = *(a2 + 32);
    v58 = *(a2 + 40);
    v59 = -v15;
    v23 = v23;
    v60 = *(a2 + 48);
    v61 = *(a2 + 56);
    do
    {
      v62 = *(v55 + 4 * v23) - *a1;
      v63 = *(v56 + 4 * v23) - a1[1];
      v64 = (v63 * v63) + (v62 * v62);
      v65 = *(v58 + 4 * v23);
      v66 = 1.0 / sqrtf(v64);
      v67 = *(v60 + 4 * v23);
      v68 = v66 * ((v63 * v67) + (v62 * v65));
      v69 = v14 * v66;
      v70 = ((v69 * v69) * -0.5) + 1.0;
      v71 = (fabsf(-(*(v61 + 4 * v23) - ((*(v57 + 4 * v23) - a1[2]) * v66))) + (v59 * v66)) < v28;
      v74 = ((v70 * v13.__cosval) - ((v14 * v66) * v13.__sinval)) >= v68 && (v13.__cosval + v70) >= 0.0 && v70 >= 0.0;
      v75 = v71 & ((v6.f32[0] <= 0.0) | ~v74);
      if (v64 <= 0.5)
      {
        v75 = 0;
      }

      *(a4 + 4 * v23) = v75;
      if (v75 == 1)
      {
        if (((v63 * v65) - (v62 * v67)) <= 0.0)
        {
          v76 = -(v68 + 1.0);
        }

        else
        {
          v76 = v68 + 1.0;
        }

        v77 = *(a3 + 80);
        *(*(a3 + 72) + 4 * result) = v69;
        *(v77 + 4 * result) = v76;
        result = (result + 1);
      }

      ++v23;
    }

    while (v11 != v23);
  }

  if (result > v11)
  {
    __assert_rtn("vl_ps_filter_corr", "vl_pose_ps.c", 730, "n_matches <= n_corr");
  }

  return result;
}

uint64_t vl_ps_vote_prio(uint64_t a1)
{
  v1 = MEMORY[0x28223BE20](a1);
  v3 = v2;
  v269 = v4;
  v6 = v5;
  v8 = v7;
  v263 = v1;
  v329 = *MEMORY[0x277D85DE8];
  v270 = v9;
  v10 = *(v9 + 4);
  v11 = *(*(v7 + 144) + 252);
  v12 = malloc_type_malloc(0x402uLL, 0x100004040BEE09CuLL);
  v267 = malloc_type_malloc(4 * v10, 0x100004052888210uLL);
  if (4 * *(v8 + 200) <= 4)
  {
    v13 = 4;
  }

  else
  {
    v13 = 4 * *(v8 + 200);
  }

  v14 = malloc_type_calloc(1uLL, 0x30uLL, 0x1030040F6295BD8uLL);
  v15 = v13 | 1;
  *v14 = malloc_type_malloc(24 * v15, 0x1080040A085CBA5uLL);
  v14[4] = 0;
  *(v14 + 10) = v15;
  *(v14 + 11) = 0;
  v315 = 0u;
  v316 = 0u;
  v317 = 0u;
  v318 = 0u;
  v319 = 0u;
  v320 = 0u;
  v321 = 0u;
  v322 = 0u;
  v323 = 0u;
  v325 = *&algn_271105846[10];
  v326 = xmmword_271105860;
  v327 = unk_271105870;
  v16 = *(v3 + 12);
  v324[0] = 0;
  *&v324[1] = *"timer";
  v328 = 1;
  *(&v322 + 1) = -mach_absolute_time();
  if (*(v3 + 124) * *(v3 + 124) * *(v3 + 128) > 64)
  {
    __assert_rtn("vl_ps_vote_prio", "vl_pose_ps.c", 946, "SQR(par->cell_split_factor_xy) * par->cell_split_factor_z <= 64 && Too many children in cell split");
  }

  if (*(v8 + 200) >= 1)
  {
    v17 = 0;
    do
    {
      pqueue_push(v14, *(*(v8 + 184) + 8 * (v17 / *(v8 + 208))) + 52 * (v17 % *(v8 + 208)), 3.40282347e38);
      ++v17;
    }

    while (*(v8 + 200) > v17);
  }

  v265 = v6;
  v268 = v14;
  v18 = v269;
  v261 = v12;
  if (*(v14 + 9) >= 1)
  {
    v266 = v16;
    v19 = 0.0;
    v262 = v11;
    v264 = v16;
    while (1)
    {
      v280 = 0.0;
      if (v16 <= 0.0)
      {
        goto LABEL_19;
      }

      vl_timer_stop(&v315);
      if (v328)
      {
        v20 = *(&v322 + 1);
        info[0] = 0;
        mach_timebase_info(info);
        v21 = v20 * info[0].numer;
        v18 = v269;
        LODWORD(v22) = info[0].denom;
        v23 = v21 / (v22 * 1000000.0);
        v24 = 0.001;
      }

      else
      {
        v23 = v322;
        v24 = 0.000000001;
      }

      if (v23 * v24 * 1000.0 > v266)
      {
        goto LABEL_100;
      }

      if (v328)
      {
        break;
      }

      clock_gettime(_CLOCK_THREAD_CPUTIME_ID, &v317);
      clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, &v316);
      clock_gettime(_CLOCK_MONOTONIC, &v315);
      if (*(v14 + 9))
      {
LABEL_20:
        v25 = pqueue_delete(v14, 1, &v280);
        if (v280 <= v19)
        {
          goto LABEL_100;
        }

        goto LABEL_24;
      }

LABEL_23:
      v25 = 0;
      if (v280 <= v19)
      {
        goto LABEL_100;
      }

LABEL_24:
      v26 = v25[4].i32[0];
      v27 = *(v3 + 120);
      if (v26 == v27 && v25[5].i16[2])
      {
        v313 = 0uLL;
        v314 = 0;
        if (*(v18 + 860))
        {
          *(v18 + 768) -= mach_absolute_time();
        }

        else
        {
          clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v18 + 680));
          clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v18 + 664));
          clock_gettime(_CLOCK_MONOTONIC, (v18 + 648));
        }

        LOWORD(v11) = v25[5].i16[2];
        LOWORD(v16) = v25[6].i16[0];
        v276 = *v25;
        v278 = v25[1].i32[0];
        v82 = v25[2];
        v83 = v25[3].i32[0];
        v84 = v313.i64[0];
        if (v313.i64[0] >= v314)
        {
          if (v314)
          {
            v85 = 2 * v314;
          }

          else
          {
            v85 = 1;
          }

          if (v85 <= v313.i64[0])
          {
            v86 = v313.i64[0] + 1;
          }

          else
          {
            v86 = v85;
          }

          if (v86)
          {
            v313.i64[1] = malloc_type_realloc(v313.i64[1], 160 * v86, 0x10A004031866557uLL);
            v84 = v313.i64[0];
          }

          v314 = v86;
          v18 = v269;
        }

        v313.i64[0] = v84 + 1;
        v87 = v313.i64[1] + 160 * v84;
        *v87 = LODWORD(v11);
        *(v87 + 4) = 0;
        *(v87 + 8) = v276;
        *(v87 + 16) = v278;
        *(v87 + 20) = (LODWORD(v16) + 0.5) * 0.012272;
        *(v87 + 24) = v82;
        *(v87 + 32) = v83;
        *(v87 + 36) = 1011421147;
        *(v87 + 40) = 0u;
        *(v87 + 56) = 0u;
        *(v87 + 72) = 0u;
        *(v87 + 88) = 0u;
        *(v87 + 104) = 0u;
        *(v87 + 120) = 0u;
        *(v87 + 136) = 0u;
        *(v87 + 152) = 0;
        vl_ps_refine(v263);
        v88 = *v313.i64[1];
        v89 = *(v313.i64[1] + 4);
        v277 = *(v313.i64[1] + 8);
        v279 = *(v313.i64[1] + 16);
        v90 = *(v313.i64[1] + 20);
        v91 = *(v313.i64[1] + 36);
        v92 = *(v313.i64[1] + 120);
        v285 = *(v313.i64[1] + 104);
        v286 = v92;
        v287 = *(v313.i64[1] + 136);
        *&v288 = *(v313.i64[1] + 152);
        v93 = *(v313.i64[1] + 56);
        *&info[0].numer = *(v313.i64[1] + 40);
        v282 = v93;
        v94 = *(v313.i64[1] + 88);
        v283 = *(v313.i64[1] + 72);
        v284 = v94;
        if (v19 <= (v89 * 0.03125))
        {
          v19 = (v89 * 0.03125);
        }

        v95 = *v6;
        v96 = *(v6 + 16);
        if (*v6 >= v96)
        {
          if (v96)
          {
            v97 = 2 * v96;
          }

          else
          {
            v97 = 1;
          }

          if (v97 <= v95)
          {
            v98 = v95 + 1;
          }

          else
          {
            v98 = v97;
          }

          v11 = v262;
          if (v98)
          {
            v275 = v90;
            v99 = malloc_type_realloc(*(v6 + 8), 160 * v98, 0x10A004031866557uLL);
            v90 = v275;
            *(v6 + 8) = v99;
            v95 = *v6;
          }

          *(v6 + 16) = v98;
          v18 = v269;
        }

        else
        {
          v11 = v262;
        }

        *v6 = v95 + 1;
        v100 = *(v6 + 8) + 160 * v95;
        *v100 = v88;
        *(v100 + 4) = v89;
        *(v100 + 8) = v277;
        *(v100 + 16) = v279;
        *(v100 + 20) = v90;
        *(v100 + 36) = v91;
        *(v100 + 104) = v285;
        *(v100 + 120) = v286;
        *(v100 + 136) = v287;
        *(v100 + 152) = v288;
        *(v100 + 40) = *&info[0].numer;
        *(v100 + 56) = v282;
        *(v100 + 72) = v283;
        *(v100 + 88) = v284;
        free(v313.i64[1]);
        v25[5].i32[0] = *(v8 + 228);
        v25[3].i32[1] = -1;
        *(v8 + 228) = v25[4].i32[1];
        vl_timer_stop(v18 + 648);
        v16 = v264;
        goto LABEL_11;
      }

      if (v26 > v27)
      {
        __assert_rtn("vl_ps_vote_prio", "vl_pose_ps.c", 998, "cell->n_splits <= par->n_split_steps");
      }

      if (*(v18 + 212))
      {
        *(v18 + 120) -= mach_absolute_time();
      }

      else
      {
        clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v18 + 32));
        clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v18 + 16));
        clock_gettime(_CLOCK_MONOTONIC, v18);
      }

      LODWORD(v28) = *(v3 + 136);
      v29 = vl_ps_filter_corr(v25, v270, v270, v267, v11, v28);
      vl_timer_stop(v18);
      if (*(v18 + 428))
      {
        *(v18 + 336) -= mach_absolute_time();
      }

      else
      {
        clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v18 + 248));
        clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v18 + 232));
        clock_gettime(_CLOCK_MONOTONIC, (v18 + 216));
      }

      bzero(v12, 0x402uLL);
      vl_ps_cell_vote(v29, v270, v12, v30);
      vl_timer_stop(v18 + 216);
      if (*(v18 + 644))
      {
        *(v18 + 552) -= mach_absolute_time();
      }

      else
      {
        clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v18 + 464));
        clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v18 + 448));
        clock_gettime(_CLOCK_MONOTONIC, (v18 + 432));
      }

      v14 = v268;
      v12->i16[0] = v12[64].i16[0];
      v31 = 0uLL;
      v32 = -8;
      v33 = v12;
      v34 = 0uLL;
      v35 = xmmword_271105800;
      v36 = 0uLL;
      v37.i64[0] = 0x8000800080008;
      v37.i64[1] = 0x8000800080008;
      v38.i64[0] = 0xFFFF0000FFFF0000;
      v38.i64[1] = 0xFFFF0000FFFF0000;
      v39.i64[0] = 0xFFFFFFFF00000000;
      v39.i64[1] = 0xFFFFFFFF00000000;
      v40.i64[0] = 0xFFFF0000FFFFLL;
      v40.i64[1] = 0xFFFF0000FFFFLL;
      do
      {
        v41 = *v33;
        if (vorrq_s8(vdupq_laneq_s64(*v33, 1), *v33).u64[0])
        {
          v42 = vaddq_s16(v41, vqtbl1q_s8(v41, xmmword_271105810));
          *v43.i8 = vrev64_s32(*v42.i8);
          v43.u64[1] = vrev64_s32(*&vextq_s8(v42, v42, 8uLL));
          v44 = vaddq_s16(v42, v43);
          v45 = vextq_s8(v44, v44, 8uLL);
          v46 = vaddq_s16(vaddq_s16(vaddq_s16(vaddq_s16(vandq_s8(v41, v40), v36), vandq_s8(v42, v38)), vandq_s8(v43, v39)), vandq_s8(v45, xmmword_271105820));
          v36 = vaddq_s16(vaddq_s16(v44, v36), v45);
          v47 = vcgtq_s16(v46, v31);
          v31 = vmaxq_s16(v46, v31);
          v34 = vbslq_s8(v47, v35, v34);
        }

        v35 = vaddq_s16(v35, v37);
        ++v33;
        v32 += 8;
      }

      while (v32 < 0x1F8);
      *&info[0].numer = v34;
      v313 = v31;
      v48 = v31.u16[1] > v31.u16[0];
      if (*(&v313 | (2 * v48)) < v31.u16[2])
      {
        v48 = 2;
      }

      if (*(&v313 | (2 * v48)) < v31.u16[3])
      {
        v48 = 3;
      }

      if (*(&v313 | (2 * v48)) < v31.u16[4])
      {
        v48 = 4;
      }

      if (*(&v313 | (2 * v48)) < v31.u16[5])
      {
        v48 = 5;
      }

      if (*(&v313 | (2 * v48)) < v31.u16[6])
      {
        v48 = 6;
      }

      if (v313.u16[v48] < v31.u16[7])
      {
        v48 = 7;
      }

      v25[6].i16[0] = *(&info[0].numer + v48);
      v25[5].i16[2] = v313.i16[v48];
      vl_timer_stop(v18 + 432);
      LOWORD(v49) = v25[5].i16[2];
      if (pow(*(v3 + 4), (*(v3 + 120) - v25[4].i32[0])) * v49 * *(v3 + 8) > v19)
      {
        if (*(v18 + 1076))
        {
          *(v18 + 984) -= mach_absolute_time();
          v51 = v25[4].i32[0];
          v52 = *(v3 + 120);
          v53 = __OFSUB__(v52, v51);
          v54 = v52 - v51;
          if (!((v54 < 0) ^ v53 | (v54 == 0)))
          {
            goto LABEL_57;
          }

LABEL_73:
          LOWORD(v50) = v25[5].i16[2];
          v80 = v50;
          v81 = pow(*(v3 + 4), v54);
          pqueue_push(v268, v25, v81 * v80 * *(v3 + 8));
        }

        else
        {
          clock_gettime(_CLOCK_THREAD_CPUTIME_ID, (v18 + 896));
          clock_gettime(_CLOCK_PROCESS_CPUTIME_ID, (v18 + 880));
          clock_gettime(_CLOCK_MONOTONIC, (v18 + 864));
          v78 = v25[4].i32[0];
          v79 = *(v3 + 120);
          v53 = __OFSUB__(v79, v78);
          v54 = v79 - v78;
          if ((v54 < 0) ^ v53 | (v54 == 0))
          {
            goto LABEL_73;
          }

LABEL_57:
          v311 = 0u;
          v312 = 0u;
          v309 = 0u;
          v310 = 0u;
          v307 = 0u;
          v308 = 0u;
          v305 = 0u;
          v306 = 0u;
          v303 = 0u;
          v304 = 0u;
          v301 = 0u;
          v302 = 0u;
          v299 = 0u;
          v300 = 0u;
          v297 = 0u;
          v298 = 0u;
          v295 = 0u;
          v296 = 0u;
          v293 = 0u;
          v294 = 0u;
          v291 = 0u;
          v292 = 0u;
          v289 = 0u;
          v290 = 0u;
          v288 = 0u;
          v286 = 0u;
          v287 = 0u;
          v284 = 0u;
          v285 = 0u;
          v282 = 0u;
          v283 = 0u;
          *&info[0].numer = 0u;
          v55 = *(v3 + 124);
          v57 = *(v3 + 128);
          v56 = v57;
          *&v57 = v55;
          v58 = ceilf((v25[3].f32[0] / v25[2].f32[0]) * v55);
          if (v56 >= v58)
          {
            v56 = v58;
          }

          v273 = *(v3 + 124);
          v59 = v268;
          if (v55 >= 1)
          {
            v60 = v56;
            if (v56 >= 1)
            {
              v260 = v3;
              LODWORD(v61) = 0;
              v62 = 0;
              v63 = vdup_lane_s32(v57, 0);
              do
              {
                v64 = 0;
                v271 = v62;
                v272 = v62 + 0.5;
                do
                {
                  v65 = 0;
                  v61 = v61;
                  v66.f32[0] = v272;
                  v66.f32[1] = v64 + 0.5;
                  v274 = v66;
                  v67 = v61 + 1;
                  do
                  {
                    v68 = v61;
                    v69 = v67;
                    v70 = vl_ps_grid_cell_add(v8 + 152);
                    v72 = vdiv_f32(v25[2], v63);
                    v70[2] = v72;
                    v71 = v25[3].f32[0] / v60;
                    v70[3].f32[0] = v71;
                    *v70 = vmla_f32(vmla_f32(*v25, 0xBF000000BF000000, v25[2]), v72, v274);
                    *&v72 = (v25[1].f32[0] + (v25[3].f32[0] * -0.5)) + ((v65 + 0.5) * v71);
                    v70[1].i32[0] = v72;
                    v70[1].i32[1] = -1082130432;
                    v70[4].i32[0] = v25[4].i32[0] + 1;
                    v70[5].i16[3] = v25[5].i16[2];
                    v61 = v68 + 1;
                    info[v68] = v70;
                    ++v65;
                    v67 = v69 + 1;
                  }

                  while (v60 != v65);
                  ++v64;
                }

                while (v64 != v273);
                v62 = v271 + 1;
              }

              while (v271 + 1 != v273);
              v59 = v268;
              v3 = v260;
              v16 = v264;
              if (v68 >= 0)
              {
                v73 = v69;
                v74 = info;
                do
                {
                  v75 = *v74++;
                  LOWORD(v72) = v25[5].i16[2];
                  v76 = v72;
                  v77 = pow(*(v260 + 4), (*(v260 + 120) - v25[4].i32[0]));
                  pqueue_push(v268, v75, v77 * v76 * *(v260 + 8));
                  --v73;
                }

                while (v73);
              }
            }
          }

          v25[5].i32[0] = *(v8 + 228);
          v25[3].i32[1] = -1;
          *(v8 + 228) = v25[4].i32[1];
          v6 = v265;
          v14 = v59;
          v12 = v261;
          v18 = v269;
        }

        vl_timer_stop(v18 + 864);
        goto LABEL_11;
      }

      v25[5].i32[0] = *(v8 + 228);
      v25[3].i32[1] = -1;
      *(v8 + 228) = v25[4].i32[1];
LABEL_11:
      if (*(v14 + 9) <= 0)
      {
        goto LABEL_100;
      }
    }

    *(&v322 + 1) -= mach_absolute_time();
LABEL_19:
    if (*(v14 + 9))
    {
      goto LABEL_20;
    }

    goto LABEL_23;
  }

LABEL_100:
  v101 = malloc_type_malloc(0x200uLL, 0x100004000313F17uLL);
  v102 = *v6;
  if (*v6)
  {
    v103 = v6;
    v104 = 0;
    v105 = *(v103 + 8);
    v106 = 1;
    v107 = 32;
    v108 = 0uLL;
    while (1)
    {
      v109 = v104;
      while (1)
      {
        if (!v106)
        {
          --v109;
          v110 = &v101[16 * v109];
          v102 = *(v110 + 1);
          v105 = *(v265 + 8) + 160 * *v110;
        }

        if (v102 > 15)
        {
          break;
        }

        if (v102 > 1)
        {
          v111 = v105 + 160;
          v112 = 2;
          for (i = 1; i != v102; ++i)
          {
            v114 = v111;
            v115 = v112;
            do
            {
              v116 = v105 + 160 * (v115 - 2);
              if (*(v116 + 4) >= *(v114 + 4))
              {
                break;
              }

              v289 = v108;
              v290 = v108;
              v288 = v108;
              v286 = v108;
              v287 = v108;
              v284 = v108;
              v285 = v108;
              v282 = v108;
              v283 = v108;
              *&info[0].numer = v108;
              v117 = *(v114 + 16);
              *&info[0].numer = *v114;
              v282 = v117;
              v118 = *(v114 + 32);
              v119 = *(v114 + 48);
              v120 = *(v114 + 80);
              v285 = *(v114 + 64);
              v286 = v120;
              v283 = v118;
              v284 = v119;
              v121 = *(v114 + 96);
              v122 = *(v114 + 112);
              v123 = *(v114 + 144);
              v289 = *(v114 + 128);
              v290 = v123;
              v288 = v122;
              v287 = v121;
              v124 = *(v116 + 16);
              *v114 = *v116;
              *(v114 + 16) = v124;
              v125 = *(v116 + 32);
              v126 = *(v116 + 48);
              v127 = *(v116 + 80);
              *(v114 + 64) = *(v116 + 64);
              *(v114 + 80) = v127;
              *(v114 + 32) = v125;
              *(v114 + 48) = v126;
              v128 = *(v116 + 96);
              v129 = *(v116 + 112);
              v130 = *(v116 + 144);
              *(v114 + 128) = *(v116 + 128);
              *(v114 + 144) = v130;
              *(v114 + 96) = v128;
              *(v114 + 112) = v129;
              v131 = v282;
              *v116 = *&info[0].numer;
              *(v116 + 16) = v131;
              v132 = v283;
              v133 = v284;
              v134 = v286;
              *(v116 + 64) = v285;
              *(v116 + 80) = v134;
              *(v116 + 32) = v132;
              *(v116 + 48) = v133;
              v135 = v287;
              v136 = v288;
              v137 = v290;
              *(v116 + 128) = v289;
              *(v116 + 144) = v137;
              *(v116 + 96) = v135;
              *(v116 + 112) = v136;
              --v115;
              v114 -= 160;
            }

            while (v115 > 1);
            ++v112;
            v111 += 160;
          }
        }

        v106 = 0;
        v102 = 0;
        if (v109 < 1)
        {
          goto LABEL_166;
        }
      }

      if (v102 > 0x27)
      {
        break;
      }

      v138 = (v102 >> 1);
      v139 = *(v105 + 160 * (v102 >> 1) + 4);
      v140 = *(v105 + 4);
      v141 = *(v105 + 160 * v102 - 156);
      if (v139 >= v140)
      {
        if (v141 >= v140)
        {
          if (v141 < v139)
          {
            v138 = (v102 - 1);
          }
        }

        else
        {
          v138 = 0;
        }
      }

      else if (v141 >= v139)
      {
        if (v141 >= v140)
        {
          v138 = 0;
        }

        else
        {
          v138 = (v102 - 1);
        }
      }

LABEL_149:
      v160 = 0;
      v161 = 0;
      v289 = v108;
      v290 = v108;
      v288 = v108;
      v286 = v108;
      v287 = v108;
      v284 = v108;
      v285 = v108;
      v282 = v108;
      v283 = v108;
      *&info[0].numer = v108;
      v162 = *(v105 + 16);
      *&info[0].numer = *v105;
      v282 = v162;
      v163 = *(v105 + 32);
      v164 = *(v105 + 48);
      v165 = *(v105 + 80);
      v285 = *(v105 + 64);
      v286 = v165;
      v283 = v163;
      v284 = v164;
      v166 = *(v105 + 96);
      v167 = *(v105 + 112);
      v168 = *(v105 + 144);
      v289 = *(v105 + 128);
      v290 = v168;
      v288 = v167;
      v287 = v166;
      v169 = (v105 + 160 * *&v138);
      v170 = v169[1];
      *v105 = *v169;
      *(v105 + 16) = v170;
      v171 = v169[2];
      v172 = v169[3];
      v173 = v169[5];
      *(v105 + 64) = v169[4];
      *(v105 + 80) = v173;
      *(v105 + 32) = v171;
      *(v105 + 48) = v172;
      v174 = v169[6];
      v175 = v169[7];
      v176 = v169[9];
      *(v105 + 128) = v169[8];
      *(v105 + 144) = v176;
      *(v105 + 96) = v174;
      *(v105 + 112) = v175;
      v177 = v282;
      *v169 = *&info[0].numer;
      v169[1] = v177;
      v178 = v283;
      v179 = v284;
      v180 = v286;
      v169[4] = v285;
      v169[5] = v180;
      v169[2] = v178;
      v169[3] = v179;
      v181 = v287;
      v182 = v288;
      v183 = v290;
      v169[8] = v289;
      v169[9] = v183;
      v169[6] = v181;
      v169[7] = v182;
      v184 = v102 - 1;
      v185 = v105 + 164;
      do
      {
        v186 = (v185 - 4);
        if ((*(v105 + 4) - *v185) <= 0.0)
        {
          ++v161;
          v289 = v108;
          v290 = v108;
          v288 = v108;
          v286 = v108;
          v287 = v108;
          v284 = v108;
          v285 = v108;
          v282 = v108;
          v283 = v108;
          *&info[0].numer = v108;
          v187 = *(v185 + 12);
          *&info[0].numer = *v186;
          v282 = v187;
          v188 = *(v185 + 28);
          v189 = *(v185 + 44);
          v190 = *(v185 + 76);
          v285 = *(v185 + 60);
          v286 = v190;
          v283 = v188;
          v284 = v189;
          v191 = *(v185 + 92);
          v192 = *(v185 + 108);
          v193 = *(v185 + 140);
          v289 = *(v185 + 124);
          v290 = v193;
          v288 = v192;
          v287 = v191;
          v194 = (v105 + 160 * v161);
          v195 = v194[1];
          *v186 = *v194;
          *(v185 + 12) = v195;
          v196 = v194[2];
          v197 = v194[3];
          v198 = v194[5];
          *(v185 + 60) = v194[4];
          *(v185 + 76) = v198;
          *(v185 + 28) = v196;
          *(v185 + 44) = v197;
          v199 = v194[6];
          v200 = v194[7];
          v201 = v194[9];
          *(v185 + 124) = v194[8];
          *(v185 + 140) = v201;
          *(v185 + 92) = v199;
          *(v185 + 108) = v200;
          v202 = v282;
          *v194 = *&info[0].numer;
          v194[1] = v202;
          v203 = v283;
          v204 = v284;
          v205 = v286;
          v194[4] = v285;
          v194[5] = v205;
          v194[2] = v203;
          v194[3] = v204;
          v206 = v287;
          v207 = v288;
          v208 = v290;
          v194[8] = v289;
          v194[9] = v208;
          v194[6] = v206;
          v194[7] = v207;
          if ((*(v105 + 4) - *v185) == 0.0)
          {
            ++v160;
            v289 = v108;
            v290 = v108;
            v288 = v108;
            v286 = v108;
            v287 = v108;
            v284 = v108;
            v285 = v108;
            v282 = v108;
            v283 = v108;
            *&info[0].numer = v108;
            v209 = v194[1];
            *&info[0].numer = *v194;
            v282 = v209;
            v210 = v194[2];
            v211 = v194[3];
            v212 = v194[5];
            v285 = v194[4];
            v286 = v212;
            v283 = v210;
            v284 = v211;
            v213 = v194[6];
            v214 = v194[7];
            v215 = v194[9];
            v289 = v194[8];
            v290 = v215;
            v288 = v214;
            v287 = v213;
            v216 = (v105 + 160 * v160);
            v217 = v216[1];
            *v194 = *v216;
            v194[1] = v217;
            v218 = v216[2];
            v219 = v216[3];
            v220 = v216[5];
            v194[4] = v216[4];
            v194[5] = v220;
            v194[2] = v218;
            v194[3] = v219;
            v221 = v216[6];
            v222 = v216[7];
            v223 = v216[9];
            v194[8] = v216[8];
            v194[9] = v223;
            v194[6] = v221;
            v194[7] = v222;
            v224 = v282;
            *v216 = *&info[0].numer;
            v216[1] = v224;
            v225 = v283;
            v226 = v284;
            v227 = v286;
            v216[4] = v285;
            v216[5] = v227;
            v216[2] = v225;
            v216[3] = v226;
            v228 = v287;
            v229 = v288;
            v230 = v290;
            v216[8] = v289;
            v216[9] = v230;
            v216[6] = v228;
            v216[7] = v229;
          }
        }

        v185 += 160;
        --v184;
      }

      while (v184);
      v231 = v160 + 1;
      v232 = 160 * v160;
      v233 = -160 * v160 + 160 * v161;
      do
      {
        v289 = v108;
        v290 = v108;
        v288 = v108;
        v286 = v108;
        v287 = v108;
        v284 = v108;
        v285 = v108;
        v282 = v108;
        v283 = v108;
        *&info[0].numer = v108;
        v234 = (v105 + v233);
        v235 = *(v105 + v233 + 16);
        *&info[0].numer = *(v105 + v233);
        v282 = v235;
        v236 = *(v105 + v233 + 32);
        v237 = *(v105 + v233 + 48);
        v238 = *(v105 + v233 + 80);
        v285 = *(v105 + v233 + 64);
        v286 = v238;
        v283 = v236;
        v284 = v237;
        v239 = *(v105 + v233 + 96);
        v240 = *(v105 + v233 + 112);
        v241 = *(v105 + v233 + 144);
        v289 = *(v105 + v233 + 128);
        v290 = v241;
        v288 = v240;
        v287 = v239;
        v242 = (v105 + v232);
        v243 = *(v105 + v232 + 16);
        *v234 = *(v105 + v232);
        v234[1] = v243;
        v244 = *(v105 + v232 + 32);
        v245 = *(v105 + v232 + 48);
        v246 = *(v105 + v232 + 80);
        v234[4] = *(v105 + v232 + 64);
        v234[5] = v246;
        v234[2] = v244;
        v234[3] = v245;
        v247 = *(v105 + v232 + 96);
        v248 = *(v105 + v232 + 112);
        v249 = *(v105 + v232 + 144);
        v234[8] = *(v105 + v232 + 128);
        v234[9] = v249;
        v234[6] = v247;
        v234[7] = v248;
        v250 = v282;
        *v242 = *&info[0].numer;
        v242[1] = v250;
        v251 = v283;
        v252 = v284;
        v253 = v286;
        v242[4] = v285;
        v242[5] = v253;
        v242[2] = v251;
        v242[3] = v252;
        v254 = v287;
        v255 = v288;
        v256 = v290;
        v242[8] = v289;
        v242[9] = v256;
        v242[6] = v254;
        v242[7] = v255;
        --v231;
        v232 -= 160;
        v233 += 160;
      }

      while (v231 > 0);
      v104 = v109 + 1;
      if (v109 + 1 >= v107)
      {
        v257 = 2 * v107;
        v101 = malloc_type_realloc(v101, 32 * v107, 0x100004000313F17uLL);
        v108 = 0uLL;
        v107 = v257;
      }

      v258 = &v101[16 * v109];
      *v258 = v161 - 0x3333333333333333 * ((v105 - *(v265 + 8)) >> 5) + 1;
      *(v258 + 1) = v102 + ~v161;
      v102 = v161 - v160;
      v106 = v161 != v160;
      v12 = v261;
      if (v109 < 0 && !v102)
      {
        goto LABEL_166;
      }
    }

    v142 = 0;
    v143 = 0;
    if (v102 <= 0x7D0)
    {
      v144 = 8;
    }

    else
    {
      v144 = 26;
    }

    if (v102 <= 0x7D0)
    {
      v145 = 3;
    }

    else
    {
      v145 = 9;
    }

    while (1)
    {
      v146 = (v102 - 1 + v142) / v144;
      v147 = *(v105 + 160 * v146 + 4);
      v148 = *(v105 + 160 * (v142 / v144) + 4);
      v149 = (2 * v102 - 2 + v142) / v144;
      v150 = *(v105 + 160 * v149 + 4);
      if (v147 >= v148)
      {
        if (v150 < v148)
        {
          goto LABEL_133;
        }

        if (v150 < v147)
        {
LABEL_135:
          info[v143] = v149;
          goto LABEL_127;
        }
      }

      else if (v150 >= v147)
      {
        if (v150 < v148)
        {
          goto LABEL_135;
        }

LABEL_133:
        info[v143] = (v142 / v144);
        goto LABEL_127;
      }

      info[v143] = v146;
LABEL_127:
      ++v143;
      v142 += 3 * v102 - 3;
      if (v145 == v143)
      {
        while (1)
        {
          v151 = v145;
          v145 /= 3uLL;
          v152 = info;
          v153 = &v282;
          v154 = v145;
          do
          {
            v155 = v153[-2];
            v156 = v153[-1];
            v157 = *(v105 + 160 * *&v156 + 4);
            v158 = *(v105 + 160 * *&v155 + 4);
            v159 = *(v105 + 160 * *v153 + 4);
            if (v157 >= v158)
            {
              if (v159 < v158)
              {
                goto LABEL_145;
              }

              if (v159 >= v157)
              {
LABEL_138:
                *v152 = v156;
                goto LABEL_139;
              }
            }

            else
            {
              if (v159 < v157)
              {
                goto LABEL_138;
              }

              if (v159 >= v158)
              {
LABEL_145:
                *v152 = v155;
                goto LABEL_139;
              }
            }

            *v152 = *v153;
LABEL_139:
            v153 += 3;
            ++v152;
            --v154;
          }

          while (v154);
          if (v151 < 9)
          {
            v138 = info[0];
            goto LABEL_149;
          }
        }
      }
    }
  }

LABEL_166:
  free(v101);
  if (*v268)
  {
    free(*v268);
  }

  if (*(v268 + 8))
  {
    free(v268[2]);
  }

  free(v268);
  free(v12);
  free(v267);
  return 0;
}