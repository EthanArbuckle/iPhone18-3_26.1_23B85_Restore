@interface UICollectionView
+ (id)_reuseKeyForSupplementaryViewOfKind:(id)kind withReuseIdentifier:(id)identifier;
- (BOOL)_addGlassGroupView:(id)view material:(id)material;
- (BOOL)_addUpdateToShadowControllerIfNeeded:(id)needed;
- (BOOL)_allowsEffectiveFocus;
- (BOOL)_allowsEffectiveMultipleSelection;
- (BOOL)_allowsEffectiveSelection;
- (BOOL)_allowsEffectiveSelectionOrCustomActionAtIndexPath:(id)path;
- (BOOL)_beginReorderingItemAtIndexPath:(id)path isLegacyMovement:(BOOL)movement;
- (BOOL)_canBeginReorderingItem;
- (BOOL)_canEditItemAtIndexPath:(id)path;
- (BOOL)_canPerformAction:(SEL)action forCell:(id)cell sender:(id)sender;
- (BOOL)_canPerformPrimaryActionForItemAtIndexPath:(id)path;
- (BOOL)_canReorderItemAtIndexPath:(id)path;
- (BOOL)_canReusePreviouslyFocusedManagedSubview:(id)subview;
- (BOOL)_cellAtIndexPath:(id)path containsInteractiveControlAtPoint:(CGPoint)point;
- (BOOL)_cellCanBecomeFocused:(id)focused;
- (BOOL)_checkForPreferredAttributesInView:(id)view originalAttributes:(id)attributes;
- (BOOL)_containsFocusedItem;
- (BOOL)_dataSourceImplementsReorderingHandlers;
- (BOOL)_defaultAllowsFocus;
- (BOOL)_defaultAllowsFocusDuringEditing;
- (BOOL)_delegateAllowsHighlightingItemAtIndexPath:(id)path;
- (BOOL)_delegateAllowsSelectingItemAtIndexPath:(id)path;
- (BOOL)_dragAndDropNeededForReordering;
- (BOOL)_effectiveDefaultAllowsFocus;
- (BOOL)_hasContentForBarInteractions;
- (BOOL)_hasCustomBackground;
- (BOOL)_hasFocusedCellForIndexPath:(id)path shouldUsePreUpdateData:(BOOL)data;
- (BOOL)_highlightItemAtIndexPath:(id)path animated:(BOOL)animated scrollPosition:(unint64_t)position notifyDelegate:(BOOL)delegate playFeedback:(BOOL)feedback;
- (BOOL)_indexPathIsSectionAppendingIndexPath:(id)path;
- (BOOL)_indexPathIsValid:(id)valid allowSectionItemSentinel:(BOOL)sentinel;
- (BOOL)_inferFocusabilityForCell:(id)cell atIndexPath:(id)path;
- (BOOL)_isCellInvolvedInDragOrDropAnimationAtIndexPath:(id)path;
- (BOOL)_isFirstResponderInDeletedSectionOrItem;
- (BOOL)_isFocusedViewInDeletedSectionOrItem;
- (BOOL)_isIndexPathSelectedItem:(id)item;
- (BOOL)_isMovingFocusFromHorizontalIndexBarToCellContent:(id)content;
- (BOOL)_isReordering;
- (BOOL)_isReorderingItemAtIndexPath:(id)path includingDragAndDrop:(BOOL)drop;
- (BOOL)_isSectionValidInIndexPath:(id)path;
- (BOOL)_prefetchingAllowed;
- (BOOL)_recomputePreferredAttributesForInvalidatedView:(id)view originalAttributes:(id)attributes;
- (BOOL)_reuseCell:(id)cell notifyDidEndDisplaying:(BOOL)displaying;
- (BOOL)_reuseSupplementaryView:(id)view;
- (BOOL)_reviseNewContentOffsetForUpdate:(id)update;
- (BOOL)_selectionInteractionShouldBegin:(id)begin;
- (BOOL)_shouldBecomeFocusedOnSelection;
- (BOOL)_shouldFadeCellsForBoundChangeWhileRotating;
- (BOOL)_shouldSelectionFollowFocusForIndexPath:(id)path initiatedBySelection:(BOOL)selection focusItemStateCandidate:(id)candidate;
- (BOOL)_shouldShowMenuForCell:(id)cell;
- (BOOL)_shouldSpringLoadItemAtIndexPath:(id)path withContext:(id)context;
- (BOOL)_shouldUpdateFocusInContext:(id)context;
- (BOOL)_supportsAutomaticCatalystDragAndDropReordering;
- (BOOL)_typeSelectShouldAvoidBecomingFirstResponder;
- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdate:(id)update rect:(CGRect)rect;
- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdateWithRect:(CGRect)rect newlyVisible:(id)visible includeInserts:(BOOL)inserts;
- (BOOL)_updatePreferredAttributesForReusableViewInCurrentUpdate:(id)update withOriginalAttributes:(id)attributes isExistingView:(BOOL)view;
- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdate:(id)update;
- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:(CGRect)rect newlyVisible:(id)visible includeInserts:(BOOL)inserts;
- (BOOL)_updatePrefetchItemIfNeeded:(id)needed forIndexPath:(id)path withLayoutAttributes:(id)attributes willDisplay:(BOOL)display;
- (BOOL)_updatePrefetchedCells:(BOOL)cells;
- (BOOL)_updateWithItems:(id)items tentativelyForReordering:(BOOL)reordering propertyAnimator:(id)animator collectionViewAnimator:(id)viewAnimator;
- (BOOL)_useIdleObserverForCellPrefetching;
- (BOOL)_validateScrollingTargetIndexPath:(id)path raisingExceptionIfNecessary:(BOOL)necessary;
- (BOOL)_validateSelectionOrHighlightIndexPath:(id)path isSelection:(BOOL)selection allowMassIndexPath:(BOOL)indexPath assertIfInvalid:(BOOL)invalid;
- (BOOL)_viewIsReorderedCell:(id)cell;
- (BOOL)_wantsIndexOverlays;
- (BOOL)allowsFocus;
- (BOOL)allowsFocusDuringEditing;
- (BOOL)canBeEdited;
- (BOOL)canBecomeFirstResponder;
- (BOOL)canBecomeFocused;
- (BOOL)dragInteractionEnabled;
- (BOOL)hasActiveDrop;
- (BOOL)indexBarView:(id)view didSelectEntry:(id)entry atIndex:(int64_t)index;
- (BOOL)isDragSessionActive;
- (BOOL)selectionFollowsFocus;
- (CGPoint)_adjustFocusContentOffset:(CGPoint)offset toShowFocusItemWithInfo:(id)info;
- (CGPoint)_contentOffsetForLowFidelityScrollInDirection:(CGPoint)direction duration:(double *)duration;
- (CGPoint)_contentOffsetForNewFrame:(CGRect)frame oldFrame:(CGRect)oldFrame newContentSize:(CGSize)size andOldContentSize:(CGSize)contentSize;
- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets;
- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets itemFrame:(CGRect)frame containingScrollView:(id)view clampToScrollableArea:(BOOL)area;
- (CGPoint)_delegateTargetOffsetForProposedContentOffset:(CGPoint)offset;
- (CGPoint)_horizontalIndexTitleBarOffset;
- (CGPoint)_reorderingTargetPosition;
- (CGPoint)indexBarAccessoryView:(id)view contentOffsetForEntry:(id)entry atIndex:(int64_t)index;
- (CGRect)_computeFutureVisibleBoundsForPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds;
- (CGRect)_computePrefetchCacheValidationBoundsForPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds;
- (CGRect)_effectiveVisibleBoundsForBounds:(CGRect)bounds;
- (CGRect)_visibleBounds;
- (CGSize)intrinsicContentSize;
- (CGVector)_unitVectorForVector:(CGVector)vector;
- (Class)_intelligenceBaseClass;
- (NSArray)indexPathsForSelectedItems;
- (NSArray)indexPathsForVisibleItems;
- (NSArray)visibleCells;
- (NSIndexPath)indexPathForCell:(UICollectionViewCell *)cell;
- (NSIndexPath)indexPathForItemAtPoint:(CGPoint)point;
- (NSInteger)numberOfItemsInSection:(NSInteger)section;
- (NSInteger)numberOfSections;
- (NSString)description;
- (UICollectionReusableView)dequeueConfiguredReusableSupplementaryViewWithRegistration:(UICollectionViewSupplementaryRegistration *)registration forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionReusableView)dequeueReusableSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionView)initWithCoder:(NSCoder *)coder;
- (UICollectionView)initWithFrame:(CGRect)frame collectionViewLayout:(UICollectionViewLayout *)layout;
- (UICollectionViewCell)cellForItemAtIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewCell)dequeueConfiguredReusableCellWithRegistration:(UICollectionViewCellRegistration *)registration forIndexPath:(NSIndexPath *)indexPath item:(id)item;
- (UICollectionViewCell)dequeueReusableCellWithReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewLayoutAttributes)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewLayoutAttributes)layoutAttributesForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewTransitionLayout)startInteractiveTransitionToCollectionViewLayout:(UICollectionViewLayout *)layout completion:(UICollectionViewLayoutInteractiveTransitionCompletion)completion;
- (UICollectionViewUpdateItem)_expectedDiffableUpdateItem;
- (UIEdgeInsets)_defaultLayoutMargins;
- (UIEdgeInsets)_visibleRectEdgeInsets;
- (_BYTE)_isContentOffset:(CGFloat)offset atStartOfAxis:(CGFloat)axis;
- (_NSRange)_globalIndexRangeOfVisibleItems;
- (_UICollectionViewVisibleCellsUpdateResult)_createVisibleViewsForSingleCategoryAttributes:(SEL)attributes limitCreation:(id)creation fadeForBoundsChange:(BOOL)change;
- (double)_alignedContentMarginGivenMargin:(double)margin;
- (double)_clampedContentOffset:(double)offset forScrollableAreaGivenContentSize:(double)size inScrollView:(double)view;
- (double)_contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:(double)insets shouldApply:(double)apply;
- (double)_frameOfElementAtScrollingTargetIndexPath:(uint64_t)path;
- (double)_layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:(uint64_t)offset;
- (double)_trackedLayoutValueForKey:(id)key;
- (id)_arrayForUpdateAction:(int)action;
- (id)_attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:(id)views attributesForNewModel:(id)model;
- (id)_autoScrollAssistantForIndexPath:(id)path;
- (id)_cellForItemAtIndexPath:(id)path;
- (id)_computeMainPrefetchCandidatesForVisibleBounds:(CGRect)bounds futureVisibleBounds:(CGRect)visibleBounds prefetchVector:(CGVector)vector;
- (id)_contextMenuInteraction:(id)interaction accessoriesForMenuWithConfiguration:(id)configuration;
- (id)_contextMenuInteraction:(id)interaction styleForMenuWithConfiguration:(id)configuration;
- (id)_createPreparedCellForItemAtIndexPath:(id)path withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes isFocused:(BOOL)focused notify:(BOOL)notify;
- (id)_createPreparedSupplementaryViewForElementOfKind:(id)kind atIndexPath:(id)path layout:(id)layout withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes;
- (id)_createStaticScrollBar;
- (id)_dataSourceActual;
- (id)_dataSourceProxy;
- (id)_dataSourceSectionIndexTitles;
- (id)_defaultTargetedPreviewForIdentifier:(id)identifier;
- (id)_delegateActual;
- (id)_delegatePreferredIndexPath;
- (id)_delegateProxy;
- (id)_dequeueReusableCellWithRegistration:(id)registration forIndexPath:(id)path;
- (id)_dequeueReusableViewOfKind:(id)kind withIdentifier:(id)identifier forIndexPath:(id)path viewCategory:(unint64_t)category;
- (id)_diffableDataSourceImpl;
- (id)_diffableIdentifierForIndexPath:(id)path;
- (id)_dragDelegateActual;
- (id)_dragDelegateProxy;
- (id)_dragDestinationDelegateActual;
- (id)_dragDestinationDelegateProxy;
- (id)_dragSourceDelegateActual;
- (id)_dragSourceDelegateProxy;
- (id)_dropDelegateActual;
- (id)_dropDelegateProxy;
- (id)_dynamicAnimationsForTrackValues;
- (id)_existingFocusItemsInRect:(CGRect)rect;
- (id)_existingIndexPathForIdentityTrackerIdentifier:(id)identifier;
- (id)_existingVisibleCells;
- (id)_focusFastScrollingIndexBarEntries;
- (id)_focusPromiseItemsInRect:(CGRect)rect inCoordinateSpace:(id)space inSection:(int64_t)section;
- (id)_focusScrollBoundaryMetricsForItem:(id)item;
- (id)_fulfillPromisedFocusRegionForLayoutAttributes:(id)attributes;
- (id)_identityTracker:(BOOL)tracker;
- (id)_indexBarEntries;
- (id)_indexPathAfterShadowUpdatesForIndexPath:(id)path;
- (id)_indexPathBeforeShadowUpdatesForIndexPath:(id)path;
- (id)_indexPathForEntryWithTitle:(id)title atIndex:(int64_t)index validateTitles:(BOOL)titles;
- (id)_indexPathForGlobalIndex:(int64_t)index;
- (id)_indexPathForInsertionAtPoint:(CGPoint)point dropIntent:(int64_t)intent sourceIndexPath:(id)path indicatorLayoutAttributes:(id *)attributes;
- (id)_indexPathForItemAtPoint:(CGPoint)point;
- (id)_indexPathForSupplementaryView:(id)view;
- (id)_indexPathForView:(id)view ofType:(unint64_t)type;
- (id)_indexPathOfItemNearestToPoint:(CGPoint)point intersectingRect:(CGRect)rect;
- (id)_indexPathsAfterShadowUpdatesForIndexPaths:(id)paths allowingAppendingInserts:(BOOL)inserts;
- (id)_indexPathsBeforeShadowUpdatesForIndexPaths:(id)paths;
- (id)_indexPathsForPreparedItems;
- (id)_indexPathsForSelectedItems;
- (id)_indexPathsForVisibleItems;
- (id)_indexPathsForVisibleSupplementaryViewsOfKind:(id)kind isDecorationView:(BOOL)view;
- (id)_keysForObject:(id)object inDictionary:(id)dictionary;
- (id)_layoutAttributes:(id)attributes filteredForCategory:(unint64_t)category;
- (id)_layoutAttributesClosestToReferencePoint:(uint64_t)point amongCandidates:(void *)candidates onAxis:(double)axis shouldConsiderBlock:(double)block;
- (id)_layoutAttributesForFailedMovementWithHeading:(unint64_t)heading;
- (id)_managedSubviewForView:(id)view;
- (id)_objectInDictionary:(id)dictionary forKind:(id)kind indexPath:(id)path;
- (id)_performShadowUpdates:(id)updates;
- (id)_pivotForTransitionFromLayout:(id)layout toLayout:(id)toLayout;
- (id)_prefetchDataSourceActual;
- (id)_prefetchDataSourceProxy;
- (id)_prefetchingContextForOrthogonalScrollingSection:(int64_t)section;
- (id)_prefetchingContextForVisibleBounds:(CGRect)bounds prefetchVector:(CGVector)vector prefetchRect:(CGRect)rect attributes:(id)attributes;
- (id)_preparedCellForItemAtIndexPath:(id)path withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes isFocused:(BOOL)focused notify:(BOOL)notify;
- (id)_primaryFocusItemForFocusGroup:(id)group;
- (id)_reorderedItemForView:(id)view;
- (id)_reusableViewWithoutAttributesForElementCategory:(unint64_t)category kind:(id)kind indexPath:(id)path;
- (id)_sceneActivationConfigurationForLocation:(CGPoint)location;
- (id)_sectionContainerViewForSectionIndex:(int64_t)index createIfNecessary:(BOOL)necessary;
- (id)_sectionIndexesAfterShadowUpdatesForSectionIndexes:(id)indexes allowingAppendingInserts:(BOOL)inserts;
- (id)_sectionsWithSectionOperationsInUpdateItems:(void *)items;
- (id)_selectableIndexPathForItemContainingHitView:(id)view;
- (id)_setupAnimationsForResizedViewsWithOldModel:(id)model;
- (id)_sortedDeduplicatedReloadItems;
- (id)_storeScrollingTargetInfoForIndexPath:(void *)path frame:(double)frame scrollPosition:(double)position additionalInsets:(double)insets;
- (id)_subviewManager;
- (id)_subviewRouterForOrthogonalScrollViewAtSection:(int64_t)section;
- (id)_subviewRouterForView:(id)view attributes:(id)attributes createIfNecessary:(BOOL)necessary;
- (id)_systemDefaultFocusGroupIdentifier;
- (id)_targetIndexPathForMoveOfItemFromOriginalIndexPath:(id)path atCurrentIndexPath:(id)indexPath toProposedIndexPath:(id)proposedIndexPath;
- (id)_targetedPreviewForBackgroundMenuAtPoint:(CGPoint)point;
- (id)_translateDataSourceIndexPathToPresentationIndexPathAsNeeded:(id)needed;
- (id)_translateDataSourceIndexPathsToPresentationIndexPathsAsNeeded:(id)needed;
- (id)_translatePresentationIndexPathToDataSourceIndexPathAsNeeded:(id)needed;
- (id)_translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:(id)needed;
- (id)_updateIndexOverlayToShowTitleAtIndex:(int64_t)index;
- (id)_updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:(BOOL)bounds;
- (id)_viewAnimationsForCurrentUpdateWithCollectionViewAnimator:(id)animator updatingContentOffsetForRestorationAnchor:(BOOL)anchor;
- (id)_viewAnimationsForView:(id)view startingLayoutAttributes:(id)attributes endingLayoutAttributes:(id)layoutAttributes startingLayout:(id)layout endingLayout:(id)endingLayout animationSetup:(id)setup animationCompletion:(id)completion enableCustomAnimations:(BOOL)self0 customAnimationsType:(unint64_t)self1;
- (id)_viewControllerToNotifyOnLayoutSubviews;
- (id)_visibleCellForIndexPath:(id)path;
- (id)_visibleSupplementaryViewOfKind:(id)kind atIndexPath:(id)path isDecorationView:(BOOL)view;
- (id)_visibleSupplementaryViewsOfKind:(id)kind isDecorationView:(BOOL)view;
- (id)_visibleViewForLayoutAttributes:(id)attributes;
- (id)contextMenuInteraction:(id)interaction configuration:(id)configuration dismissalPreviewForItemWithIdentifier:(id)identifier;
- (id)contextMenuInteraction:(id)interaction configuration:(id)configuration highlightPreviewForItemWithIdentifier:(id)identifier;
- (id)contextMenuInteraction:(id)interaction configurationForMenuAtLocation:(CGPoint)location;
- (id)dataSource;
- (id)dragDelegate;
- (id)dragDestinationDelegate;
- (id)dragSourceDelegate;
- (id)dropDelegate;
- (id)focusItemsInRect:(CGRect)rect;
- (id)indexPathForSupplementaryView:(id)view;
- (id)preferredFocusedView;
- (id)prefetchDataSource;
- (id)preparedCells;
- (id)subviewRouter;
- (id)targetForAction:(SEL)action withSender:(id)sender;
- (id)valueForUndefinedKey:(id)key;
- (int64_t)_cellFocusItemDeferral:(id)deferral;
- (int64_t)_currentSectionIndexTitleIndex;
- (int64_t)_dataSourceNumberOfItemsInSection:(int64_t)section;
- (int64_t)_dataSourceNumberOfSections;
- (int64_t)_preferredDragDestinationVisualStyle;
- (int64_t)_sectionIndexChangedToIndex:(int64_t)index title:(id)title;
- (int64_t)_totalItemCount;
- (int64_t)highlightedGlobalItem;
- (int64_t)maximumGlobalItemIndex;
- (uint64_t)_applyLayoutAttributes:(void *)attributes toView:(int)view addingControlledSubview:(uint64_t)subview forced:;
- (uint64_t)_restoreOrAdjustContentOffsetIfNecessaryWithInsets:(char)insets hasUpdatedVisibleCells:(double)cells isRecursive:(double)recursive;
- (unint64_t)_createVisibleViewsForAttributes:(id)attributes fadeForBoundsChange:(BOOL)change notifyLayoutForVisibleCellsPass:(BOOL)pass;
- (unint64_t)_edgesPropagatingSafeAreaInsetsToSubviews;
- (unint64_t)_focusPrimaryScrollableAxis;
- (unint64_t)_prefetchItemsForPrefetchingContext:(id)context;
- (unint64_t)_updateVisibleCellsNow:(BOOL)now;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:(id)updates;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:(id)section;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:(id)sections;
- (void)_accessibilitySetInterfaceStyleIntent:(unint64_t)intent;
- (void)_addControlledSubview:(id)subview;
- (void)_addControlledSubview:(id)subview atZIndex:(int64_t)index forced:(BOOL)forced initialAttributes:(id)attributes;
- (void)_addEntriesFromDictionary:(id)dictionary inDictionary:(id)inDictionary andSet:(id)set;
- (void)_addIndexPathsRequiringPreferredAttributes:(uint64_t)attributes;
- (void)_addReloadDataCompletionBlock:(id)block;
- (void)_addScrollPocketAsSubview:(id)subview;
- (void)_addSubview:(id)subview positioned:(int64_t)positioned relativeTo:(id)to;
- (void)_adjustForAutomaticKeyboardInfo:(id)info animated:(BOOL)animated lastAdjustment:(double *)adjustment;
- (void)_animateVisibleView:(id)view withLayoutAttributes:(id)attributes completionHandler:(id)handler;
- (void)_applyAutomaticAdjustedContentOffset:(CGPoint)offset;
- (void)_applyBlockToAllReusableViews:(id)views;
- (void)_autoScrollAssistantUpdateContentOffset:(CGPoint)offset;
- (void)_beginTypeSelectWithInput:(id)input;
- (void)_beginUpdates;
- (void)_cacheOrReuseCell:(id)cell forIndexPath:(id)path invalidatePreferredAttributes:(BOOL)attributes notifyDidEndDisplaying:(BOOL)displaying;
- (void)_cancelTouches;
- (void)_cellBackgroundChangedForSelectionOrHighlight:(id)highlight;
- (void)_cellBecameFocused:(id)focused;
- (void)_cellDidBecomeFocused:(id)focused;
- (void)_cellDidBecomeUnfocused:(id)unfocused;
- (void)_cellPreferredSeparatorInsetsChanged:(id)changed;
- (void)_cleanUpAfterInteractiveTransitionDidFinish:(BOOL)finish;
- (void)_clearContentOffsetRestorationAnchor;
- (void)_clearNeedsRecomputePreferredAttributesForInvalidatedElements;
- (void)_clearSpecificInvalidationLists;
- (void)_clearTargetIndexPathForScrolling;
- (void)_completeInteractiveMovementWithDisposition:(int64_t)disposition;
- (void)_computeMainPrefetchCandidatesForVelocity:(CGVector)velocity;
- (void)_computeVisibleContentOffsetForUpdate:(id)update usingData:(id)data;
- (void)_configureCachedCellForDisplay:(id)display withIndexPath:(id)path layoutAttributesToUpdate:(id)update;
- (void)_configureCellForDisplay:(id)display indexPath:(id)path cached:(BOOL)cached;
- (void)_configureContextMenuInteractionIfNeeded;
- (void)_configureSceneActivationInteractionIfNeeded;
- (void)_configureSupplementaryViewForDisplay:(id)display withElementKind:(id)kind indexPath:(id)path elementCategory:(unint64_t)category;
- (void)_configureTypeSelectInteractionIfNeeded;
- (void)_contentOffsetFromProposedOffset:(double)offset forScrollingToItemWithFrame:(CGFloat)frame atScrollPosition:(CGFloat)position additionalInsets:(CGFloat)insets containingScrollViewBounds:(CGFloat)bounds;
- (void)_createAndAppendViewAnimationsForDeletesInCurrentUpdate:(id)update disappearingAnimations:(id)animations;
- (void)_createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:(id)update disappearingAnimations:(id)animations animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection oldVisibleViews:(id)visibleViews;
- (void)_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:(id)update animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection oldVisibleViews:(id)visibleViews attributesForNewModel:(id)model;
- (void)_createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:(id)update appearingAnimations:(id)animations newSubviewCollection:(id)collection;
- (void)_createAndAppendViewAnimationsForInsertsInCurrentUpdate:(id)update appearingAnimations:(id)animations newSubviewCollection:(id)collection;
- (void)_createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:(id)update appearingAnimations:(id)animations animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection attributesForNewModel:(id)model;
- (void)_decrementRotationAnimationCount;
- (void)_decrementUpdateAnimationCountWithContext:(id)context;
- (void)_deselectAllAnimated:(BOOL)animated notifyDelegate:(BOOL)delegate;
- (void)_deselectItemAtIndexPath:(id)path animated:(BOOL)animated notifyDelegate:(BOOL)delegate isUserInitiated:(BOOL)initiated;
- (void)_deselectItemsAtIndexPaths:(id)paths animated:(BOOL)animated transitionCoordinator:(id)coordinator isUserInitiated:(BOOL)initiated;
- (void)_didMoveFromSuperview:(id)superview;
- (void)_didMoveFromWindow:(id)window toWindow:(id)toWindow;
- (void)_didUpdateFocusInContext:(id)context;
- (void)_endItemAnimationsWithInvalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator collectionViewAnimator:(id)viewAnimator;
- (void)_endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate;
- (void)_endUpdatesWithInvalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator collectionViewAnimator:(id)viewAnimator;
- (void)_enqueueViewForReuse:(id)reuse;
- (void)_ensureFocusedViewIsNotHidden;
- (void)_ensureViewsAreLoadedInRect:(CGRect)rect;
- (void)_enumerateVisibleViews:(id)views;
- (void)_finishInteractiveTransitionShouldFinish:(BOOL)finish finalAnimation:(BOOL)animation;
- (void)_focusMovementDidFailNotification:(id)notification;
- (void)_geometryChanged:(id *)changed forAncestor:(id)ancestor;
- (void)_getOriginalReorderingIndexPaths:(id *)paths targetIndexPaths:(id *)indexPaths;
- (void)_handlePresses:(id)presses keyHandler:(id)handler defaultHandler:(id)defaultHandler;
- (void)_hideIndexOverlay;
- (void)_highlightFirstVisibleItemIfAppropriate;
- (void)_highlightSpringLoadedItemAtIndexPath:(id)path;
- (void)_immediatelyBeginDruidBasedReorderIfPossibleWithTouch:(id)touch;
- (void)_incrementUpdateAnimationCountWithContext:(id)context;
- (void)_intelligenceCollectSubelementsIn:(CGRect)in using:(id)using transformToRoot:(id)root;
- (void)_invalidateLayoutForReload;
- (void)_invalidateLayoutForUpdatedLayoutMarginsIfNeeded;
- (void)_invalidateLayoutWithContext:(id)context;
- (void)_invalidateWithBlock:(id)block;
- (void)_layoutAdjustmentsDidChange;
- (void)_layoutDirectionTraitDidChange;
- (void)_layoutMarginsDidChangeFromOldMargins:(UIEdgeInsets)margins;
- (void)_layoutMarginsWillChange;
- (void)_layoutSectionContainerViews;
- (void)_managedSubviewAdded:(id)added;
- (void)_moveItemAtIndexPath:(id)path toIndexPath:(id)indexPath;
- (void)_moveSection:(int64_t)section toSection:(int64_t)toSection;
- (void)_moveSectionIndexTitleIndexToIndex:(int64_t)index highlight:(BOOL)highlight;
- (void)_moveWithEvent:(id)event;
- (void)_notifyDataSourceForMoveOfItemFromIndexPath:(id)path toIndexPath:(id)indexPath;
- (void)_notifyDidEndDisplayingCellIfNeeded:(id)needed forIndexPath:(id)path;
- (void)_notifyDidEndDisplayingSupplementaryView:(id)view;
- (void)_notifyDidScroll;
- (void)_notifyWillDisplayCellIfNeeded:(id)needed forIndexPath:(id)path;
- (void)_notifyWillDisplaySupplementaryView:(id)view forElementKind:(id)kind atIndexPath:(id)path;
- (void)_orthogonalScrollView:(id)view didScrollToOffset:(CGPoint)offset inSection:(int64_t)section;
- (void)_performAction:(SEL)action forCell:(id)cell sender:(id)sender;
- (void)_performBatchUpdates:(id)updates completion:(id)completion invalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator animationHandler:(id)handler;
- (void)_performDiffableUpdate:(id)update;
- (void)_performInternalBatchUpdates:(id)updates;
- (void)_performReloadPrefetchIfNeeded;
- (void)_performUpdate:(id)update;
- (void)_performWhileSuppressingPromiseRegionGeneration:(id)generation;
- (void)_populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:(id)update addingDeletedViewsToSet:(id)set updateLayoutAttributesIndexPaths:(BOOL)paths;
- (void)_prepareClonedViewsForTransitionLayout;
- (void)_prepareLayoutForUpdates:(BOOL)updates;
- (void)_prepareViewForReuse:(uint64_t)reuse;
- (void)_prepareViewForUse:(id)use withElementCategory:(unint64_t)category elementKind:(id)kind reuseIdentifier:(id)identifier indexPath:(id)path;
- (void)_prepareViewForUse:(id)use withElementCategory:(unint64_t)category elementKind:(id)kind reuseIdentifier:(id)identifier indexPath:(id)path applyDefaultAttributes:(BOOL)attributes;
- (void)_processQueuedSectionContainerRemovals;
- (void)_processViewSpecificInvalidationsForVisibleViews;
- (void)_pruneCachedPrefetchViewsForVelocity:(CGVector)velocity;
- (void)_prunePrefetchedViewsAtIndexPaths:(id)paths;
- (void)_purgeReuseQueues;
- (void)_rebaseContentOffsetAnchorOrScrollTargetForUpdate:(id)update;
- (void)_rebasePrefetchedCellIndexPathsWithMapping:(id)mapping;
- (void)_recomputePreferredAttributesForInvalidatedElementsIfNeeded;
- (void)_recomputeSectionIndexTitleIndex;
- (void)_reconfigureCell:(id)cell forItemAtIndexPath:(id)path;
- (void)_reconfigureItemAtIndexPath:(id)path;
- (void)_reconfigureSectionContainersForUpdate:(id)update;
- (void)_registeredSupplementaryViewKind:(id)kind;
- (void)_reloadDataIfNeeded;
- (void)_reloadSectionIndexTitles;
- (void)_removeReorderDestinationView;
- (void)_removeStandaloneIndexBarIfNecessary;
- (void)_removeUntrackedAuxillaryViewsForBeforeVisibleViews:(id)views afterVisibleViews:(id)visibleViews withTrackingViewAnimations:(id)animations;
- (void)_removeVisibleViews:(id)views fadeForBoundsChange:(BOOL)change;
- (void)_reorderPrefetchCandidates:(id)candidates forPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds;
- (void)_reparentViewIntoCorrectContainer:(id)container;
- (void)_reparentViewIntoSelf:(id)self;
- (void)_requestFocusOnItemAtIndexPath:(id)path;
- (void)_resetAllPrefetchContexts;
- (void)_resetDropTargetAppearance;
- (void)_resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:(id)mapping;
- (void)_resetPrefetchState;
- (void)_resetPrefetchedCachedCells;
- (void)_resetPrefetchingContext:(id)context;
- (void)_resetUpdateItemArrays;
- (void)_resignOrRebaseFirstResponderViewWithIndexPathMapping:(id)mapping;
- (void)_resumeDidScrollNotifications;
- (void)_resumeReloads;
- (void)_reusableViewDidInvalidateIntrinsicContentSize:(id)size;
- (void)_reusePrefetchedCell:(id)cell;
- (void)_reusePreviouslyFocusedManagedSubviewIfNeeded:(id)needed;
- (void)_safeAreaInsetsDidChangeFromOldInsets:(UIEdgeInsets)insets;
- (void)_safeAreaInsetsWillChange;
- (void)_saveContentOffsetRestorationAnchorIfNecessaryUsingModel:(uint64_t)model;
- (void)_scrollFirstResponderCellToVisible:(BOOL)visible;
- (void)_scrollToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets animated:(BOOL)animated;
- (void)_scrollToItemAtPresentationIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets animated:(BOOL)animated;
- (void)_scrollViewAnimationEnded:(id)ended finished:(BOOL)finished;
- (void)_scrollViewDidEndDraggingWithDeceleration:(BOOL)deceleration;
- (void)_scrollViewWillEndDraggingWithVelocity:(CGPoint)velocity targetContentOffset:(CGPoint *)offset;
- (void)_selectAllSelectedItems;
- (void)_selectItemAtIndexPath:(id)path animated:(BOOL)animated scrollPosition:(unint64_t)position notifyDelegate:(BOOL)delegate deselectPrevious:(BOOL)previous performPrimaryAction:(BOOL)action performCustomSelectionAction:(BOOL)selectionAction isUserInitiated:(BOOL)self0;
- (void)_selectionInteractionDidBeginHinting:(id)hinting;
- (void)_selectionInteractionDidCancelHinting:(id)hinting;
- (void)_selectionInteractionDidSelect:(id)select;
- (void)_setAllowsBandSelectionForMultipleSelection:(BOOL)selection;
- (void)_setAllowsMultipleSelectionDuringEditing:(BOOL)editing;
- (void)_setAllowsSelectionDuringEditing:(BOOL)editing;
- (void)_setAllowsVisibleCellUpdatesDuringUpdateAnimations:(BOOL)animations;
- (void)_setAllowsVisibleViewUpdatesDuringLayoutTransitions:(BOOL)transitions;
- (void)_setCollectionViewLayout:(id)layout animated:(BOOL)animated isInteractive:(BOOL)interactive completion:(id)completion animator:(id)animator;
- (void)_setContentSize:(CGSize)size skipContentOffsetAdjustment:(BOOL)adjustment;
- (void)_setContentSizeFromLayout:(CGSize)layout isRecursivelyUpdatingVisibleCells:(BOOL)cells;
- (void)_setDefaultAlwaysBounceVertical:(BOOL)vertical horizontal:(BOOL)horizontal;
- (void)_setDefaultLayoutMargins:(UIEdgeInsets)margins fromViewController:(BOOL)controller;
- (void)_setDelaysUserInitiatedItemSelection:(BOOL)selection;
- (void)_setDisplaysHorizontalIndexTitleBar:(BOOL)bar;
- (void)_setExternalObjectTable:(id)table forNibLoadingOfCellWithReuseIdentifier:(id)identifier;
- (void)_setExternalObjectTable:(id)table forNibLoadingOfSupplementaryViewOfKind:(id)kind withReuseIdentifier:(id)identifier;
- (void)_setFocusedItemState:(id)state;
- (void)_setForcePreserveSemanticContentOffsetDuringUpdates:(BOOL)updates;
- (void)_setHorizontalIndexTitleBarOffset:(CGPoint)offset;
- (void)_setIsAncestorOfFirstResponder:(BOOL)responder;
- (void)_setKeepsFirstResponderVisibleOnBoundsChange:(BOOL)change;
- (void)_setNeedsRecomputePreferredAttributesForInvalidatedElements;
- (void)_setNeedsVisibleCellsUpdate:(BOOL)update withLayoutAttributes:(BOOL)attributes;
- (void)_setObject:(id)object inDictionary:(id)dictionary forKind:(id)kind indexPath:(id)path;
- (void)_setPocketRelativeSubview:(id)subview isOver:(BOOL)over forKey:(id)key;
- (void)_setPreferredDragDestinationVisualStyle:(int64_t)style;
- (void)_setPrefetchingContext:(id)context forOrthogonalScrollingSection:(int64_t)section;
- (void)_setReorderFeedbackGenerator:(id)generator;
- (void)_setShouldBecomeFocusedOnSelection:(BOOL)selection;
- (void)_setShouldDeriveVisibleBoundsFromContainingScrollView:(BOOL)view;
- (void)_setShouldPersistSelectionOnReloadDataWhenPossible:(BOOL)possible;
- (void)_setShouldPrefetchCellsWhenPerformingReloadData:(BOOL)data;
- (void)_setShouldPreventFocusScrollPastContentSize:(BOOL)size;
- (void)_setShouldResetInitialLayoutOnDataSourceChange:(BOOL)change;
- (void)_setShouldSkipForcedLayoutBeforeBatchUpdates:(BOOL)updates;
- (void)_setTypeSelectShouldAvoidBecomingFirstResponder:(BOOL)responder;
- (void)_setUpCompletionHandlerForAnimationInterruptionIfNecessary;
- (void)_setUsesStaticScrollBar:(BOOL)bar;
- (void)_setVisibleView:(id)view forLayoutAttributes:(id)attributes;
- (void)_setupCellAnimations;
- (void)_setupExpandCollapseAnimationsIfNeededWithContext:(id)context;
- (void)_setupIndexOverlayManagerIfNecessary;
- (void)_shiftSectionIndexTitleIndexByAmount:(int64_t)amount;
- (void)_sortAttributesByDistanceToVisibleBoundsOrigin:(id)origin;
- (void)_springLoadedInteractionSelectItemAtIndexPath:(id)path;
- (void)_startViewAnimationsWithContext:(id)context oldVisibleViews:(id)views viewAnimator:(id)animator viewAnimationsCompletedDispatchGroup:(id)group;
- (void)_stopScrollingNotify:(BOOL)notify pin:(BOOL)pin;
- (void)_trackLayoutValue:(double)value forKey:(id)key;
- (void)_traitsConsumedByLayoutInvalidated;
- (void)_transitionIndexOverlaySelectionViewToVisible:(BOOL)visible;
- (void)_unhighlightAllItems;
- (void)_unhighlightAllItemsAndHighlightGlobalItem:(int64_t)item;
- (void)_unhighlightItemAtIndexPath:(id)path animated:(BOOL)animated notifyDelegate:(BOOL)delegate;
- (void)_unhighlightSpringLoadedItem;
- (void)_updateAnimationDidStop:(id)stop finished:(BOOL)finished;
- (void)_updateBackgroundColorIfNeeded;
- (void)_updateBackgroundView;
- (void)_updateContentFocusContainerGuides;
- (void)_updateContextMenuStateForVisibleCells:(id)cells;
- (void)_updateCycleIdleUntil:(unint64_t)until;
- (void)_updateDefaultLayoutMargins;
- (void)_updateDerivesVisibleBoundsFromContainingScrollView;
- (void)_updateDropTargetAppearanceWithTargetIndexPath:(id)path intent:(int64_t)intent indicatorLayoutAttributes:(id)attributes;
- (void)_updateEditing:(BOOL)editing forView:(id)view atIndexPath:(id)path elementCategory:(unint64_t)category;
- (void)_updateFocusAfterLoadingVisibleCellsIfNeeded:(id)needed;
- (void)_updateFocusScrollBoundaryMetrics:(id)metrics forItem:(id)item inSection:(int64_t)section;
- (void)_updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:(CGRect)rect;
- (void)_updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:(id)path;
- (void)_updateIndex;
- (void)_updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(BOOL)change;
- (void)_updateOrderingOfViewsInDisappearingViewAnimations:(id)animations onScreenViewAnimations:(id)viewAnimations;
- (void)_updatePreferredAttributesForCurrentUpdate;
- (void)_updatePreferredAttributesForCurrentUpdate:(unint64_t)update;
- (void)_updatePrefetchVelocityIntegratorForVisibleBounds:(CGRect)bounds;
- (void)_updatePrefetchedCellsForOrthogonalScrollingSection:(int64_t)section withOriginalPrefetchingVector:(CGVector)vector canCompute:(BOOL)compute canPrefetch:(BOOL)prefetch;
- (void)_updateReorderDestinationViewWithLayoutAttributes:(id)attributes;
- (void)_updateReorderingTargetPosition:(CGPoint)position;
- (void)_updateRowsAtIndexPaths:(id)paths updateAction:(int)action updates:(id)updates;
- (void)_updateSectionIndex;
- (void)_updateSections:(id)sections updateAction:(int)action;
- (void)_updateSelectionIsKey;
- (void)_updateTrackedLayoutValuesWith:(id)with;
- (void)_updateTransitionWithProgress:(double)progress;
- (void)_updateVerticalScrollIndicatorVisibility;
- (void)_updateWithUpdates:(id)updates updateAction:(int64_t)action;
- (void)_userSelectItemAtIndexPath:(id)path;
- (void)_userSelectItemAtIndexPath:(id)path animatedSelection:(BOOL)selection;
- (void)_wheelChangedWithEvent:(id)event;
- (void)_willRemoveSubview:(id)subview;
- (void)_willUpdateFocusInContext:(id)context;
- (void)accessoryInsetsDidChange:(UIEdgeInsets)change;
- (void)bringSubviewToFront:(id)front;
- (void)contextMenuInteraction:(id)interaction willDisplayMenuForConfiguration:(id)configuration animator:(id)animator;
- (void)contextMenuInteraction:(id)interaction willEndForConfiguration:(id)configuration animator:(id)animator;
- (void)contextMenuInteraction:(id)interaction willPerformPreviewActionForMenuWithConfiguration:(id)configuration animator:(id)animator;
- (void)dealloc;
- (void)decodeRestorableStateWithCoder:(id)coder;
- (void)deleteItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)deleteSections:(NSIndexSet *)sections;
- (void)deselectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated;
- (void)didMoveToWindow;
- (void)encodeRestorableStateWithCoder:(id)coder;
- (void)encodeWithCoder:(id)coder;
- (void)exchangeSubviewAtIndex:(int64_t)index withSubviewAtIndex:(int64_t)atIndex;
- (void)horizontalIndexBar:(id)bar selectedEntry:(id)entry;
- (void)insertItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)insertSections:(NSIndexSet *)sections;
- (void)layoutHorizontalIndexTitleBar;
- (void)layoutSubviews;
- (void)moveItemAtIndexPath:(NSIndexPath *)indexPath toIndexPath:(NSIndexPath *)newIndexPath;
- (void)moveSection:(NSInteger)section toSection:(NSInteger)newSection;
- (void)performUsingPresentationValues:(id)values;
- (void)pressesBegan:(id)began withEvent:(id)event;
- (void)pressesCancelled:(id)cancelled withEvent:(id)event;
- (void)pressesChanged:(id)changed withEvent:(id)event;
- (void)pressesEnded:(id)ended withEvent:(id)event;
- (void)reconfigureItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)registerClass:(Class)cellClass forCellWithReuseIdentifier:(NSString *)identifier;
- (void)registerClass:(Class)viewClass forSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier;
- (void)registerNib:(UINib *)nib forCellWithReuseIdentifier:(NSString *)identifier;
- (void)registerNib:(UINib *)nib forSupplementaryViewOfKind:(NSString *)kind withReuseIdentifier:(NSString *)identifier;
- (void)reloadData;
- (void)reloadItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)reloadSections:(NSIndexSet *)sections;
- (void)scrollToItemAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UICollectionViewScrollPosition)scrollPosition animated:(BOOL)animated;
- (void)selectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated scrollPosition:(UICollectionViewScrollPosition)scrollPosition;
- (void)sendSubviewToBack:(id)back;
- (void)setAllowsFocus:(BOOL)allowsFocus;
- (void)setAllowsFocusDuringEditing:(BOOL)allowsFocusDuringEditing;
- (void)setAllowsMultipleSelection:(BOOL)allowsMultipleSelection;
- (void)setAllowsSelection:(BOOL)allowsSelection;
- (void)setAllowsUserInitiatedMultipleSelection:(BOOL)selection;
- (void)setAlwaysBounceHorizontal:(BOOL)horizontal;
- (void)setAlwaysBounceVertical:(BOOL)vertical;
- (void)setBackgroundColor:(id)color;
- (void)setBackgroundView:(UIView *)backgroundView;
- (void)setBounds:(CGRect)bounds;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)collectionViewLayout;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated completion:(void *)completion;
- (void)setContentInset:(UIEdgeInsets)inset;
- (void)setContentOffset:(CGPoint)offset;
- (void)setContentOffset:(CGPoint)offset animated:(BOOL)animated;
- (void)setContentSize:(CGSize)size;
- (void)setDataSource:(id)dataSource;
- (void)setDelegate:(id)delegate;
- (void)setDirectionalLayoutMargins:(NSDirectionalEdgeInsets)margins;
- (void)setDragDelegate:(id)dragDelegate;
- (void)setDragDestinationDelegate:(id)delegate;
- (void)setDragSourceDelegate:(id)delegate;
- (void)setDropDelegate:(id)dropDelegate;
- (void)setEditing:(BOOL)editing;
- (void)setFrame:(CGRect)frame;
- (void)setLayoutMargins:(UIEdgeInsets)margins;
- (void)setPrefetchDataSource:(id)prefetchDataSource;
- (void)setPrefetchingEnabled:(BOOL)prefetchingEnabled;
- (void)setRemembersLastFocusedIndexPath:(BOOL)remembersLastFocusedIndexPath;
- (void)setScrollEnabled:(BOOL)enabled;
- (void)setSelectionFollowsFocus:(BOOL)selectionFollowsFocus;
- (void)setSelfSizingInvalidation:(UICollectionViewSelfSizingInvalidation)selfSizingInvalidation;
- (void)setSemanticContentAttribute:(int64_t)attribute;
- (void)touchesBegan:(id)began withEvent:(id)event;
- (void)touchesCancelled:(id)cancelled withEvent:(id)event;
- (void)touchesEnded:(id)ended withEvent:(id)event;
- (void)touchesMoved:(id)moved withEvent:(id)event;
- (void)updateInteractiveMovementTargetPosition:(CGPoint)targetPosition;
- (void)userInteractionStoppedWithIndexBarView:(id)view;
@end

@implementation UICollectionView

- (unint64_t)_edgesPropagatingSafeAreaInsetsToSubviews
{
  if ([(UICollectionViewLayout *)self->_layout _overridesSafeAreaPropagationToDescendants])
  {
    layout = self->_layout;

    return [(UICollectionViewLayout *)layout _edgesForSafeAreaPropagationToDescendants];
  }

  else
  {
    v5.receiver = self;
    v5.super_class = UICollectionView;
    return [(UIScrollView *)&v5 _edgesPropagatingSafeAreaInsetsToSubviews];
  }
}

- (void)layoutHorizontalIndexTitleBar
{
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (_horizontalIndexTitleBar)
  {
    [(UIScrollView *)self contentOffset];
    y = self->_horizontalIndexTitleBarOffset.y;
    v6 = v5 + self->_horizontalIndexTitleBarOffset.x;
    [(UIView *)self bounds];
    v8 = v7;
    _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
    [_horizontalIndexTitleBar2 setFrame:{v6, y, v8, 66.0}];
  }
}

- (void)_updateContentFocusContainerGuides
{
  _focusSystem = [(UIView *)self _focusSystem];

  if (_focusSystem)
  {
    if (!self->_contentFocusContainerGuide)
    {
      v4 = objc_alloc_init(UIFocusContainerGuide);
      contentFocusContainerGuide = self->_contentFocusContainerGuide;
      self->_contentFocusContainerGuide = v4;

      [(UIView *)self addLayoutGuide:self->_contentFocusContainerGuide];
      [(UILayoutGuide *)self->_contentFocusContainerGuide _setLockedToOwningView:1];
      [(UILayoutGuide *)self->_contentFocusContainerGuide setIdentifier:@"UICollectionViewContentFocusContainerGuide"];
    }

    collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
    _layoutAxis = [collectionViewLayout _layoutAxis];

    endOfContentFocusContainerGuide = self->_endOfContentFocusContainerGuide;
    if (endOfContentFocusContainerGuide || _layoutAxis == 0)
    {
      if (endOfContentFocusContainerGuide)
      {
        v10 = _layoutAxis == 0;
      }

      else
      {
        v10 = 0;
      }

      if (v10)
      {
        [(UILayoutGuide *)endOfContentFocusContainerGuide _setLockedToOwningView:0];
        [(UIView *)self removeLayoutGuide:self->_endOfContentFocusContainerGuide];
        v11 = self->_endOfContentFocusContainerGuide;
        self->_endOfContentFocusContainerGuide = 0;
      }
    }

    else
    {
      v12 = objc_alloc_init(UIFocusContainerGuide);
      v13 = self->_endOfContentFocusContainerGuide;
      self->_endOfContentFocusContainerGuide = v12;

      [(UIView *)self addLayoutGuide:self->_endOfContentFocusContainerGuide];
      [(UILayoutGuide *)self->_endOfContentFocusContainerGuide _setLockedToOwningView:1];
      [(UILayoutGuide *)self->_endOfContentFocusContainerGuide setIdentifier:@"UICollectionViewEndOfContentFocusContainerGuide"];
    }

    v14 = self->_contentFocusContainerGuide;
    [(UIView *)self bounds];
    [(UILayoutGuide *)v14 _setManualLayoutFrame:?];
    if (self->_endOfContentFocusContainerGuide)
    {
      if (_layoutAxis)
      {
        if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]>= 1)
        {
          collectionViewData = self->_collectionViewData;
          if (collectionViewData)
          {
            if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
            {
              [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
            }

            if (collectionViewData->_totalItemCount >= 1)
            {
              v16 = self->_collectionViewData;
              if (v16)
              {
                if ((*&v16->_collectionViewDataFlags & 2) == 0)
                {
                  [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
                }

                v17 = v16->_totalItemCount - 1;
              }

              else
              {
                v17 = -1;
              }

              v18 = [(UICollectionViewData *)v16 indexPathForItemAtGlobalIndex:v17];
              v19 = [(UICollectionView *)self layoutAttributesForItemAtIndexPath:v18];
              if (v19)
              {
                v20 = v19;
                if (_layoutAxis == 2)
                {
                  [v19 frame];
                  MinY = CGRectGetMinY(v33);
                  [(UIView *)self bounds];
                  Width = CGRectGetWidth(v34);
                  [v20 size];
                  Height = v23;
                  MinX = 0.0;
                }

                else if (_layoutAxis == 1)
                {
                  [v19 frame];
                  MinX = CGRectGetMinX(v35);
                  [v20 size];
                  Width = v27;
                  [(UIView *)self bounds];
                  Height = CGRectGetHeight(v36);
                  MinY = 0.0;
                }

                else
                {
                  Width = *(MEMORY[0x1E695F058] + 16);
                  Height = *(MEMORY[0x1E695F058] + 24);
                  MinX = *MEMORY[0x1E695F058];
                  MinY = *(MEMORY[0x1E695F058] + 8);
                }

                [(UILayoutGuide *)self->_endOfContentFocusContainerGuide _setManualLayoutFrame:MinX, MinY, Width, Height];

                _focusedItemState = [(UICollectionView *)self _focusedItemState];
                v31 = _focusedItemState;
                if (_focusedItemState)
                {
                  v29 = *(_focusedItemState + 8);
                }

                else
                {
                  v29 = 0;
                }

                v30 = v29;
                [(UIFocusGuide *)self->_endOfContentFocusContainerGuide setEnabled:v30 != 0];

                return;
              }
            }
          }
        }

        [(UIFocusGuide *)self->_endOfContentFocusContainerGuide setEnabled:0];
        v26 = self->_endOfContentFocusContainerGuide;
        [(UIView *)self bounds];

        [(UILayoutGuide *)v26 _setManualLayoutFrame:?];
      }
    }
  }
}

- (void)_updateBackgroundColorIfNeeded
{
  if ((*(&self->_collectionViewFlags + 12) & 0x80) == 0)
  {
    backgroundView = [(UICollectionView *)self backgroundView];

    if (!backgroundView)
    {
      if (dyld_program_sdk_at_least())
      {
        _preferredBackgroundColor = [(UICollectionViewLayout *)self->_layout _preferredBackgroundColor];
      }

      else
      {
        _preferredBackgroundColor = 0;
      }

      traitCollection = [(UIView *)self traitCollection];
      if (traitCollection)
      {
        v6 = traitCollection;
        _UIRecordTraitUsage(traitCollection, 0x13uLL);
        v7 = v6[16];

        if (_preferredBackgroundColor)
        {
LABEL_15:
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __50__UICollectionView__updateBackgroundColorIfNeeded__block_invoke;
          v9[3] = &unk_1E70F35B8;
          v9[4] = self;
          v10 = _preferredBackgroundColor;
          v8 = _preferredBackgroundColor;
          [UIView _performSystemAppearanceModifications:v9];

          return;
        }

        if (v7 == 2)
        {
          _preferredBackgroundColor = 0;
          goto LABEL_15;
        }
      }

      else if (_preferredBackgroundColor)
      {
        goto LABEL_15;
      }

      if (dyld_program_sdk_at_least())
      {
        +[UIColor systemBackgroundColor];
      }

      else
      {
        +[UIColor blackColor];
      }
      _preferredBackgroundColor = ;
      goto LABEL_15;
    }
  }
}

uint64_t __50__UICollectionView__updateBackgroundColorIfNeeded__block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) setBackgroundColor:*(a1 + 40)];
  *(*(a1 + 32) + 2728) &= ~0x8000000000uLL;
  return result;
}

- (void)_updateSelectionIsKey
{
  v3 = (*(&self->_collectionViewFlags + 1) >> 26) & 1;
  selectionFollowsFocus = [(UICollectionView *)self selectionFollowsFocus];

  _UITableUpdateSelectionIsKeyTraitOverride(self, v3, selectionFollowsFocus);
}

- (BOOL)selectionFollowsFocus
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 18) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __41__UICollectionView_selectionFollowsFocus__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

uint64_t __41__UICollectionView_selectionFollowsFocus__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusBehavior];
  v3 = [v2 defaultValueForSelectionFollowsFocusInCollectionView:*(a1 + 32)];

  return v3;
}

- (void)_updateVerticalScrollIndicatorVisibility
{
  traitCollection = [(UIView *)self traitCollection];
  userInterfaceIdiom = [traitCollection userInterfaceIdiom];

  if (userInterfaceIdiom == 6)
  {
    traitCollection2 = [(UIView *)self traitCollection];
    _hasSplitViewControllerContextPrimaryColumn = [traitCollection2 _hasSplitViewControllerContextPrimaryColumn];

    [(UIScrollView *)self _setDefaultShowsVerticalScrollIndicator:_hasSplitViewControllerContextPrimaryColumn ^ 1u];
  }
}

- (id)dragDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  return WeakRetained;
}

- (id)dropDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  return WeakRetained;
}

- (BOOL)_wantsIndexOverlays
{
  traitCollection = [(UIView *)self traitCollection];
  if ([traitCollection userInterfaceIdiom] == 3 && (v4 = *(&self->_collectionViewFlags + 1), (v4 & 2) != 0))
  {
    v5 = (v4 >> 2) & 1;
  }

  else
  {
    LOBYTE(v5) = 0;
  }

  return v5;
}

- (id)dataSource
{
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  return WeakRetained;
}

- (void)_configureContextMenuInteractionIfNeeded
{
  _delegateSupportsMenuInteraction = [(UICollectionView *)self _delegateSupportsMenuInteraction];
  contextMenuInteraction = self->_contextMenuInteraction;
  if (_delegateSupportsMenuInteraction)
  {
    if (!contextMenuInteraction)
    {
      v5 = [[UIContextMenuInteraction alloc] initWithDelegate:self];
      v6 = self->_contextMenuInteraction;
      self->_contextMenuInteraction = v5;

      v7 = self->_contextMenuInteraction;

      [(UIView *)self addInteraction:v7];
    }
  }

  else if (contextMenuInteraction)
  {
    [(UIView *)self removeInteraction:?];
    v8 = self->_contextMenuInteraction;
    self->_contextMenuInteraction = 0;
  }
}

- (void)_updateDerivesVisibleBoundsFromContainingScrollView
{
  WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
  v6 = WeakRetained;
  if ((*(&self->_collectionViewFlags + 14) & 2) != 0)
  {
    if ([(UIScrollView *)self isScrollEnabled])
    {
      _containingScrollView = 0;
    }

    else
    {
      _containingScrollView = [(UIView *)self _containingScrollView];
    }

    WeakRetained = v6;
  }

  else
  {
    _containingScrollView = 0;
  }

  if (WeakRetained != _containingScrollView)
  {
    if (WeakRetained)
    {
      objc_storeWeak(&self->_containerScrollView, 0);
      [(UIView *)self _removeGeometryChangeObserver:v6];
    }

    if (_containingScrollView)
    {
      objc_storeWeak(&self->_containerScrollView, _containingScrollView);
      [(UIView *)self _addGeometryChangeObserver:_containingScrollView];
    }
  }

  v5 = *(&self->_collectionViewFlags + 1);
  if ((_containingScrollView != 0) == ((v5 & 0x4000000000000) == 0))
  {
    *(&self->_collectionViewFlags + 1) = v5 & 0xFFFBFFFFFFFFFFFFLL | ((_containingScrollView != 0) << 50);
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
  }
}

- (id)dragSourceDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  return WeakRetained;
}

- (BOOL)_dragAndDropNeededForReordering
{
  v3 = dyld_program_sdk_at_least();
  if (v3)
  {
    LOBYTE(v3) = (*(&self->_collectionViewFlags + 8) & 0x11) != 0 && (dragAndDropController = self->_dragAndDropController) != 0 && dragAndDropController->_preferredDragDestinationVisualStyle == 2;
  }

  return v3;
}

- (void)_configureSceneActivationInteractionIfNeeded
{
  v3 = *&self->_collectionViewFlags & 0x1800000000000;
  supportsMultipleScenes = [UIApp supportsMultipleScenes];
  sceneActivationInteraction = self->_sceneActivationInteraction;
  if (supportsMultipleScenes)
  {
    v6 = v3 == 0;
  }

  else
  {
    v6 = 1;
  }

  if (v6)
  {
    if (sceneActivationInteraction)
    {
      [(UIView *)self removeInteraction:?];
      v7 = self->_sceneActivationInteraction;
      self->_sceneActivationInteraction = 0;
    }
  }

  else if (!sceneActivationInteraction)
  {
    objc_initWeak(&location, self);
    v8 = [UIWindowSceneActivationInteraction alloc];
    v11 = MEMORY[0x1E69E9820];
    v12 = 3221225472;
    v13 = __64__UICollectionView__configureSceneActivationInteractionIfNeeded__block_invoke;
    v14 = &unk_1E70FFAB0;
    objc_copyWeak(&v15, &location);
    v9 = [(UIWindowSceneActivationInteraction *)v8 initWithConfigurationProvider:&v11 errorHandler:&__block_literal_global_1119];
    v10 = self->_sceneActivationInteraction;
    self->_sceneActivationInteraction = v9;

    [(UIView *)self addInteraction:self->_sceneActivationInteraction, v11, v12, v13, v14];
    objc_destroyWeak(&v15);
    objc_destroyWeak(&location);
  }
}

- (void)_configureTypeSelectInteractionIfNeeded
{
  v3 = (~*&self->_collectionViewFlags & 0xC0000000000000) == 0 && (_os_feature_enabled_impl() & 1) != 0;
  typeSelectController = self->_typeSelectController;

  [(_UICollectionViewTypeSelectController *)typeSelectController setEnabled:v3];
}

- (void)reloadData
{
  v105 = *MEMORY[0x1E69E9840];
  if (self->_reloadingSuspendedCount >= 1)
  {
    *(&self->_collectionViewFlags + 1) |= 0x200uLL;
    return;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492320);
  v4 = *(CategoryCachedImpl + 8);
  v5 = os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self);
  if (v5 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v6 = v5;
    if (os_signpost_enabled(v4))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v4, OS_SIGNPOST_EVENT, v6, "ReloadData", "", buf, 2u);
    }
  }

  _focusedItemState = [(UICollectionView *)self _focusedItemState];

  if (_focusedItemState)
  {
    *(&self->_collectionViewFlags + 1) |= 0x80000000000uLL;
    _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
    v9 = _focusedItemState2;
    if (_focusedItemState2)
    {
      v10 = *(_focusedItemState2 + 8);
    }

    else
    {
      v10 = 0;
    }

    v11 = v10;

    if (v11)
    {
      [v11 frame];
      v13 = v12;
      v15 = v14;
      v17 = v16;
      v19 = v18;
      [(UIScrollView *)self visibleBounds];
      v107.origin.x = v20;
      v107.origin.y = v21;
      v107.size.width = v22;
      v107.size.height = v23;
      v106.origin.x = v13;
      v106.origin.y = v15;
      v106.size.width = v17;
      v106.size.height = v19;
      v24 = CGRectIntersectsRect(v106, v107);
      v25 = 0x100000000000;
      if (!v24)
      {
        v25 = 0;
      }
    }

    else
    {
      v25 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFEFFFFFFFFFFFLL | v25;
  }

  [(UIView *)self setNeedsFocusUpdate];
  [(UICollectionView *)self _suspendReloads];
  p_collectionViewFlags = &self->_collectionViewFlags;
  *(&self->_collectionViewFlags + 1) |= 0x80000000uLL;
  [(UICollectionView *)self _completeInteractiveMovementWithDisposition:2];
  [(UICollectionView *)self _clearControlledSubviewParentOverridesForReloadData];
  if (self->_firstResponderView)
  {
    *(&self->_collectionViewFlags + 4) |= 0x20000u;
    window = [(UIView *)self window];
    firstResponder = [window firstResponder];
    [firstResponder resignFirstResponder];

    *(&self->_collectionViewFlags + 4) &= ~0x20000u;
    if (self->_firstResponderView)
    {
      [(UICollectionView *)self _resumeReloads];
      *(&self->_collectionViewFlags + 1) &= ~0x80000000uLL;
      return;
    }
  }

  v29 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492328);
  if (*v29)
  {
    v86 = *(v29 + 8);
    if (os_log_type_enabled(v86, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy2 = self;
      _os_log_impl(&dword_188A29000, v86, OS_LOG_TYPE_ERROR, "[UICV %p] reloadData", buf, 0xCu);
    }
  }

  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  }

  _isConnectedToDiffableDataSource = [(UICollectionView *)self _isConnectedToDiffableDataSource];
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __30__UICollectionView_reloadData__block_invoke;
  aBlock[3] = &unk_1E70FED18;
  v101 = _isConnectedToDiffableDataSource;
  aBlock[4] = self;
  v31 = _Block_copy(aBlock);
  if (_isConnectedToDiffableDataSource && dyld_program_sdk_at_least())
  {
    self->_updateAnimationCount = 0;
  }

  subviewManager = self->_subviewManager;
  v33 = _Block_copy(v31);
  [(_UICollectionViewSubviewManager *)subviewManager updateVisibleCellsUsingFilter:v33];

  v34 = self->_subviewManager;
  v98[0] = MEMORY[0x1E69E9820];
  v98[1] = 3221225472;
  v98[2] = __30__UICollectionView_reloadData__block_invoke_302;
  v98[3] = &unk_1E70FED40;
  v35 = v31;
  v99 = v35;
  if (v34)
  {
    [(_UICollectionViewSubviewCollection *)v34->_visibleViews updateSupplementariesUsingFilter:v98];
  }

  v36 = self->_subviewManager;
  v96[0] = MEMORY[0x1E69E9820];
  v96[1] = 3221225472;
  v96[2] = __30__UICollectionView_reloadData__block_invoke_2;
  v96[3] = &unk_1E70FED40;
  v37 = v35;
  v97 = v37;
  if (v36)
  {
    [(_UICollectionViewSubviewCollection *)v36->_visibleViews updateDecorationsUsingFilter:v96];
  }

  v38 = self->_selectionController;
  p_isa = &v38->super.isa;
  if (v38)
  {
    v40 = [(NSMutableSet *)v38->_selectedIndexPaths copy];
  }

  else
  {
    v40 = 0;
  }

  v89 = v37;
  if (!dyld_program_sdk_at_least() || (_isConnectedToDiffableDataSource & ((*(&self->_collectionViewFlags + 17) & 0x20) >> 5)) != 1)
  {
    goto LABEL_51;
  }

  pendingDeselectionIndexPaths = [(UICollectionView *)self _diffableDataSourceImpl];
  currentTransaction = [pendingDeselectionIndexPaths currentTransaction];
  v43 = currentTransaction;
  if (!pendingDeselectionIndexPaths || !currentTransaction)
  {

LABEL_51:
    [(_UICollectionViewSelectionController *)p_isa reset];
    pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = 0;

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
    goto LABEL_52;
  }

  [(_UICollectionViewSelectionController *)p_isa rebaseItemsWithDiffableTransaction:currentTransaction];
  v44 = self->_pendingSelectionIndexPath;
  if (v44)
  {
    v45 = [(_UICollectionViewSelectionController *)p_isa rebaseIndexPath:v44 withDiffableTransaction:v43];
    v46 = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = v45;
  }

  if (self->_pendingDeselectionIndexPaths)
  {
    v88 = v40;
    v47 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v92 = 0u;
    v93 = 0u;
    v94 = 0u;
    v95 = 0u;
    v48 = self->_pendingDeselectionIndexPaths;
    v49 = [(NSMutableSet *)v48 countByEnumeratingWithState:&v92 objects:v102 count:16];
    if (v49)
    {
      v50 = v49;
      v51 = *v93;
      do
      {
        for (i = 0; i != v50; ++i)
        {
          if (*v93 != v51)
          {
            objc_enumerationMutation(v48);
          }

          v53 = [(_UICollectionViewSelectionController *)p_isa rebaseIndexPath:v43 withDiffableTransaction:?];
          if (v53)
          {
            [v47 addObject:v53];
          }
        }

        v50 = [(NSMutableSet *)v48 countByEnumeratingWithState:&v92 objects:v102 count:16];
      }

      while (v50);
    }

    v54 = [v47 count];
    if (v54)
    {
      v54 = [MEMORY[0x1E695DFA8] setWithArray:v47];
    }

    v40 = v88;
    p_collectionViewFlags = &self->_collectionViewFlags;
    v55 = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = v54;
  }

LABEL_52:
  if (!p_isa || ([p_isa[1] isEqualToSet:v40] & 1) == 0)
  {
    [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
  }

  [(_UICollectionViewTypeSelectController *)self->_typeSelectController reloadData];
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v91[0] = MEMORY[0x1E69E9820];
  v91[1] = 3221225472;
  v91[2] = __30__UICollectionView_reloadData__block_invoke_3;
  v91[3] = &unk_1E70F3590;
  v91[4] = self;
  [(UICollectionView *)self _invalidateWithBlock:v91];
  [(UICollectionView *)self _invalidateLayoutForReload];
  [(UICollectionView *)self _resetUpdateItemArrays];
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
  self->_indexPathsRequiringPreferredAttributes = 0;

  *(p_collectionViewFlags + 1) &= 0xFFFFFFFF3FFFFFFFLL;
  *(p_collectionViewFlags + 4) &= ~0x400000u;
  [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
  _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
  if (_focusedItemState3)
  {
    v59 = _focusedItemState3;
    _focusedItemState4 = [(UICollectionView *)self _focusedItemState];
    v61 = _focusedItemState4;
    v62 = _focusedItemState4 ? *(_focusedItemState4 + 16) : 0;
    v63 = v62;
    v64 = [(UICollectionView *)self _indexPathIsValid:v63 allowSectionItemSentinel:1];

    if (!v64)
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }
  }

  [(UICollectionView *)self _resetPrefetchState];
  [(UICollectionView *)self _resumeReloads];
  v65 = *(p_collectionViewFlags + 1);
  if ((v65 & 0x80000000000000) != 0)
  {
    [(UIScrollView *)self setNeedsLayout];
    *(p_collectionViewFlags + 1) |= 0x100000000000000uLL;
  }

  else if ((v65 & 0x8000000000000040) == 0x40)
  {
    window2 = [(UIView *)self window];
    if (window2)
    {
      v67 = window2;
      _prefetchingAllowed = [(UICollectionView *)self _prefetchingAllowed];

      if (_prefetchingAllowed)
      {
        block[0] = MEMORY[0x1E69E9820];
        block[1] = 3221225472;
        block[2] = __30__UICollectionView_reloadData__block_invoke_4;
        block[3] = &unk_1E70F3590;
        block[4] = self;
        dispatch_async(MEMORY[0x1E69E96A0], block);
      }
    }
  }

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController cleanupSectionFocusGuides];
  sectionFocusGuideController = self->_sectionFocusGuideController;
  _focusedItemState5 = [(UICollectionView *)self _focusedItemState];
  v71 = _focusedItemState5;
  if (_focusedItemState5)
  {
    v72 = *(_focusedItemState5 + 16);
  }

  else
  {
    v72 = 0;
  }

  v73 = v72;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v73 immediatelyReevaluatePivotIndex:0];

  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController processQueuedScrollViewRemovals];
  [(UICollectionView *)self _reconfigureSectionContainersForUpdate:0];
  [(UICollectionView *)self _processQueuedSectionContainerRemovals];
  [(UICollectionView *)self _updateSectionIndex];
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (_horizontalIndexTitleBar)
  {
    _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
    _focusFastScrollingIndexBarEntries = [(UICollectionView *)self _focusFastScrollingIndexBarEntries];
    [_horizontalIndexTitleBar2 _updateWithEntries:_focusFastScrollingIndexBarEntries];
  }

  v77 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492330);
  if (*v77)
  {
    v87 = *(v77 + 8);
    if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy2 = self;
      _os_log_impl(&dword_188A29000, v87, OS_LOG_TYPE_ERROR, "[UICV %p] End reloadData", buf, 0xCu);
    }
  }

  v78 = self->_layout;
  selfCopy3 = self;
  v80 = &selfCopy3->super.super.super.super.isa;
  if (!v78)
  {
    goto LABEL_77;
  }

  effectiveUserInterfaceLayoutDirection = [(UIView *)selfCopy3 effectiveUserInterfaceLayoutDirection];
  if (effectiveUserInterfaceLayoutDirection != [(UICollectionViewLayout *)v78 developmentLayoutDirection])
  {
    _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v78 _wantsRightToLeftHorizontalMirroringIfNeeded];
    goto LABEL_76;
  }

  if ([v80 _flipsHorizontalAxis])
  {
    _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
LABEL_76:
    [v80 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
  }

LABEL_77:

  v83 = _Block_copy(v80[401]);
  if (v83)
  {
    v84 = v80[401];
    v80[401] = 0;

    v83[2](v83);
  }

  if ((*(p_collectionViewFlags + 8) & 0x10) != 0)
  {
    if (!dyld_program_sdk_at_least() || ([v80 window], v85 = objc_claimAutoreleasedReturnValue(), v85, v85))
    {
      [v80 layoutIfNeeded];
    }
  }
}

- (void)_invalidateLayoutForReload
{
  v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
  [v3 _setInvalidateDataSourceCounts:1];
  [v3 _setInvalidateEverything:1];
  [v3 _setIntent:3];
  [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v3];
}

- (void)_resetUpdateItemArrays
{
  insertItems = self->_insertItems;
  self->_insertItems = 0;

  deleteItems = self->_deleteItems;
  self->_deleteItems = 0;

  reloadItems = self->_reloadItems;
  self->_reloadItems = 0;

  moveItems = self->_moveItems;
  self->_moveItems = 0;

  originalDeleteItems = self->_originalDeleteItems;
  self->_originalDeleteItems = 0;

  originalInsertItems = self->_originalInsertItems;
  self->_originalInsertItems = 0;
}

- (void)_clearSpecificInvalidationLists
{
  if (self)
  {
    v2 = self[332];
    self[332] = 0;

    v3 = self[333];
    self[333] = 0;

    v4 = self[334];
    self[334] = 0;
  }
}

- (void)_clearNeedsRecomputePreferredAttributesForInvalidatedElements
{
  intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
  self->_intrinsicContentSizeInvalidationContext = 0;

  *(&self->_collectionViewFlags + 4) &= 0xFFFFFE7F;
}

- (void)_resumeReloads
{
  v2 = self->_reloadingSuspendedCount - 1;
  self->_reloadingSuspendedCount = v2;
  if (!v2)
  {
    v3 = *(&self->_collectionViewFlags + 1);
    if ((v3 & 0x200) != 0)
    {
      *(&self->_collectionViewFlags + 1) = v3 & 0xFFFFFFFFFFFFFDFFLL;
      [(UICollectionView *)self reloadData];
    }

    else if ((v3 & 0x400) != 0)
    {
      [(UIScrollView *)self setNeedsLayout];
    }
  }
}

- (void)_processQueuedSectionContainerRemovals
{
  v26 = *MEMORY[0x1E69E9840];
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  obj = self->_sectionContainersQueuedForRemoval;
  v3 = [(NSMutableArray *)obj countByEnumeratingWithState:&v20 objects:v25 count:16];
  if (v3)
  {
    v4 = v3;
    v15 = *v21;
    do
    {
      for (i = 0; i != v4; ++i)
      {
        if (*v21 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v6 = *(*(&v20 + 1) + 8 * i);
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        subviews = [v6 subviews];
        v8 = [subviews countByEnumeratingWithState:&v16 objects:v24 count:16];
        if (v8)
        {
          v9 = v8;
          v10 = *v17;
          do
          {
            for (j = 0; j != v9; ++j)
            {
              if (*v17 != v10)
              {
                objc_enumerationMutation(subviews);
              }

              v12 = *(*(&v16 + 1) + 8 * j);
              objc_opt_class();
              if (objc_opt_isKindOfClass())
              {
                [(UICollectionView *)self _addControlledSubview:v12];
              }
            }

            v9 = [subviews countByEnumeratingWithState:&v16 objects:v24 count:16];
          }

          while (v9);
        }

        [v6 removeFromSuperview];
      }

      v4 = [(NSMutableArray *)obj countByEnumeratingWithState:&v20 objects:v25 count:16];
    }

    while (v4);
  }

  sectionContainersQueuedForRemoval = self->_sectionContainersQueuedForRemoval;
  self->_sectionContainersQueuedForRemoval = 0;
}

- (void)_updateSectionIndex
{
  if ((*(&self->_collectionViewFlags + 8) & 2) != 0)
  {
    [(UICollectionView *)self _reloadSectionIndexTitles];
  }
}

- (void)_resetPrefetchState
{
  [(UICollectionView *)self _resetPrefetchedCachedCells];

  [(UICollectionView *)self _resetAllPrefetchContexts];
}

- (void)_resetPrefetchedCachedCells
{
  v22 = *MEMORY[0x1E69E9840];
  if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_resetPrefetchedCachedCells___s_category);
    if (*CategoryCachedImpl)
    {
      v12 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        *buf = 134217984;
        selfCopy = self;
        _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "[UICV %p] Resetting prefetched cells", buf, 0xCu);
      }
    }

    v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableDictionary count](self->_prefetchCacheItems, "count")}];
    prefetchCacheItems = self->_prefetchCacheItems;
    v17[0] = MEMORY[0x1E69E9820];
    v17[1] = 3221225472;
    v17[2] = __47__UICollectionView__resetPrefetchedCachedCells__block_invoke;
    v17[3] = &unk_1E70FEF90;
    v6 = v4;
    v18 = v6;
    [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v17];
    [(NSMutableDictionary *)self->_prefetchCacheItems removeAllObjects];
    v15 = 0u;
    v16 = 0u;
    v13 = 0u;
    v14 = 0u;
    v7 = v6;
    v8 = [v7 countByEnumeratingWithState:&v13 objects:v19 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v14;
      do
      {
        for (i = 0; i != v9; ++i)
        {
          if (*v14 != v10)
          {
            objc_enumerationMutation(v7);
          }

          [(UICollectionView *)self _reusePrefetchedCell:*(*(&v13 + 1) + 8 * i), v13];
        }

        v9 = [v7 countByEnumeratingWithState:&v13 objects:v19 count:16];
      }

      while (v9);
    }
  }
}

- (void)_resetAllPrefetchContexts
{
  [(UICollectionView *)self _resetPrefetchingContext:self->_mainPrefetchingContext];
  orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __45__UICollectionView__resetAllPrefetchContexts__block_invoke;
  v6[3] = &unk_1E70FEFB8;
  v6[4] = self;
  [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts enumerateKeysAndObjectsUsingBlock:v6];
  mainPrefetchingContext = self->_mainPrefetchingContext;
  self->_mainPrefetchingContext = 0;

  [(NSMutableDictionary *)self->_orthogonalSectionPrefetchingContexts removeAllObjects];
  activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
  self->_activeOrthogonalPrefetchingContext = 0;
}

- (id)_dataSourceActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  return WeakRetained;
}

- (id)dragDestinationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  return WeakRetained;
}

- (id)_dataSourceProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  }

  return WeakRetained;
}

- (void)_reloadDataIfNeeded
{
  if ((*(&self->_collectionViewFlags + 1) & 0x40000000) != 0 && !(self->_reloadingSuspendedCount | *(&self->_collectionViewFlags + 1) & 0x80000000))
  {
    [(UICollectionView *)self reloadData];
  }
}

- (BOOL)dragInteractionEnabled
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    LOBYTE(dragAndDropController) = dragAndDropController->_dragInteractionEnabled;
  }

  return dragAndDropController & 1;
}

- (void)_layoutMarginsWillChange
{
  v8 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_layoutMarginsWillChange___s_category);
  if (*CategoryCachedImpl)
  {
    v4 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy = self;
      _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "_layoutMarginsWillChange: cv == %p; Attempting to save anchor for change to layout margins", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _layoutMarginsWillChange];
}

- (void)_invalidateLayoutForUpdatedLayoutMarginsIfNeeded
{
  v16 = *MEMORY[0x1E69E9840];
  layout = self->_layout;
  [(UIView *)self layoutMargins];
  v4 = [(UICollectionViewLayout *)layout _invalidationContextForUpdatedLayoutMargins:?];
  if (v4)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_invalidateLayoutForUpdatedLayoutMarginsIfNeeded___s_category);
    if (*CategoryCachedImpl)
    {
      v6 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        v7 = v6;
        [(UIView *)self safeAreaInsets];
        v8 = NSStringFromUIEdgeInsets(v17);
        [(UIView *)self layoutMargins];
        v9 = NSStringFromUIEdgeInsets(v18);
        v10 = 134218498;
        selfCopy = self;
        v12 = 2112;
        v13 = v8;
        v14 = 2112;
        v15 = v9;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "_invalidateLayoutForUpdatedLayoutMarginsIfNeeded: cv == %p; Invalidating layout for safeAreaInsets: %@, layoutMargins: %@", &v10, 0x20u);
      }
    }

    [(UICollectionViewLayout *)self->_layout invalidateLayoutWithContext:v4];
    [(UIScrollView *)self setNeedsLayout];
  }
}

- (NSArray)indexPathsForSelectedItems
{
  _indexPathsForSelectedItems = [(UICollectionView *)self _indexPathsForSelectedItems];
  v4 = [(UICollectionView *)self _translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:_indexPathsForSelectedItems];

  return v4;
}

- (id)_indexPathsForSelectedItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  allObjects = [v4 allObjects];

  return allObjects;
}

- (id)prefetchDataSource
{
  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);

  return WeakRetained;
}

- (id)subviewRouter
{
  if (self)
  {
    v2 = self[374];
    if (!v2)
    {
      v2 = [[_UICollectionViewSubviewRouter alloc] initWithContainer:self];
      objc_storeStrong(self + 374, v2);
    }
  }

  else
  {
    v2 = 0;
  }

  return v2;
}

- (UICollectionViewUpdateItem)_expectedDiffableUpdateItem
{
  if (dyld_program_sdk_at_least())
  {
    expectedDiffableUpdateItem = self->_expectedDiffableUpdateItem;
  }

  else
  {
    expectedDiffableUpdateItem = 0;
  }

  return expectedDiffableUpdateItem;
}

- (BOOL)_hasContentForBarInteractions
{
  collectionViewData = self->_collectionViewData;
  if (collectionViewData && collectionViewData->_totalItemCount > 0)
  {
    return 1;
  }

  v7 = v2;
  v8 = v3;
  v6.receiver = self;
  v6.super_class = UICollectionView;
  return [(UIScrollView *)&v6 _hasContentForBarInteractions];
}

- (NSInteger)numberOfSections
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  collectionViewData = self->_collectionViewData;

  return [(UICollectionViewData *)collectionViewData numberOfSections];
}

- (NSArray)indexPathsForVisibleItems
{
  v19 = *MEMORY[0x1E69E9840];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    [(UICollectionView *)self _reloadDataIfNeeded];
    visibleCells = [(UICollectionView *)self visibleCells];
    _indexPathsForVisibleItems = objc_alloc_init(MEMORY[0x1E695DF70]);
    v14 = 0u;
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v5 = visibleCells;
    v6 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v15;
      do
      {
        for (i = 0; i != v7; ++i)
        {
          if (*v15 != v8)
          {
            objc_enumerationMutation(v5);
          }

          _layoutAttributes = [*(*(&v14 + 1) + 8 * i) _layoutAttributes];
          indexPath = [_layoutAttributes indexPath];

          v12 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:indexPath];
          if (v12)
          {
            [_indexPathsForVisibleItems addObject:v12];
          }
        }

        v7 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
      }

      while (v7);
    }
  }

  else
  {
    _indexPathsForVisibleItems = [(UICollectionView *)self _indexPathsForVisibleItems];
  }

  return _indexPathsForVisibleItems;
}

- (id)_indexPathsForVisibleItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;

  return [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleCells];
}

- (void)didMoveToWindow
{
  window = [(UIView *)self window];
  if (!window)
  {
    _currentTouch = [(UICollectionView *)self _currentTouch];

    if (_currentTouch)
    {
      [(UICollectionView *)self _cancelTouches];
    }

    if ((*(&self->_collectionViewFlags + 1) & 0x8000000000000000) != 0)
    {
      _UIUpdateCycleUnregisterIdleObserver(self);
      *(&self->_collectionViewFlags + 1) &= ~0x8000000000000000;
    }

    _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
    v10 = _indexOverlayManager;
    v11 = 0;
    goto LABEL_17;
  }

  collectionViewData = self->_collectionViewData;
  if (collectionViewData && (*&collectionViewData->_collectionViewDataFlags & 8) != 0)
  {
    [(UICollectionView *)self _updateDefaultLayoutMargins];
  }

  if ([(UICollectionView *)self _useIdleObserverForCellPrefetching]&& (*(&self->_collectionViewFlags + 1) & 0x8000000000000000) == 0)
  {
    _UIUpdateCycleRegisterIdleObserver(self);
    *(&self->_collectionViewFlags + 1) |= 0x8000000000000000;
  }

  sectionFocusGuideController = self->_sectionFocusGuideController;
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v6 = _focusedItemState;
  if (_focusedItemState)
  {
    v7 = *(_focusedItemState + 16);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v8];

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController reloadSectionFocusGuides];
  if ([(UICollectionView *)self _wantsIndexOverlays])
  {
    [(UICollectionView *)self _setupIndexOverlayManagerIfNecessary];
    _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
    v10 = _indexOverlayManager;
    v11 = window;
LABEL_17:
    [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager hostDidMoveToWindow:v11];
  }
}

- (CGRect)_visibleBounds
{
  [(UIScrollView *)self visibleBounds];
  v4 = v3;
  v6 = v5;
  v8 = v7;
  v10 = v9;
  if ([(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
    [(UIView *)self frame];
    v13 = v12;
    v15 = v14;
    v17 = v16;
    v19 = v18;
    superview = [(UIView *)self superview];
    [WeakRetained convertRect:superview fromView:{v13, v15, v17, v19}];
    v22 = v21;
    v24 = v23;
    v26 = v25;
    v28 = v27;

    [WeakRetained visibleBounds];
    v55.origin.x = v22;
    v55.origin.y = v24;
    v55.size.width = v26;
    v55.size.height = v28;
    v50 = CGRectIntersection(v49, v55);
    x = v50.origin.x;
    y = v50.origin.y;
    width = v50.size.width;
    height = v50.size.height;
    if (CGRectIsEmpty(v50))
    {
      v8 = 44.0;
      v10 = 44.0;
    }

    else
    {
      [WeakRetained convertRect:self toView:{x, y, width, height}];
      v4 = v33;
      v6 = v34;
      v8 = v35;
      v10 = v36;
    }
  }

  window = [(UIView *)self window];
  v38 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:window];
  scrollManager = [v38 scrollManager];
  v40 = [scrollManager isScrollingScrollableContainer:self];

  if (*(&self->_collectionViewFlags + 12) & 8) != 0 || +[UIView _isInAnimationBlock](UIView, "_isInAnimationBlock") || (([window isRotating] | v40))
  {
    v51.origin.x = v4;
    v51.origin.y = v6;
    v51.size.width = v8;
    v51.size.height = v10;
    if (CGRectIntersectsRect(v51, self->_visibleBounds))
    {
      v52.origin.x = v4;
      v52.origin.y = v6;
      v52.size.width = v8;
      v52.size.height = v10;
      v53 = CGRectUnion(v52, self->_visibleBounds);
      v4 = v53.origin.x;
      v6 = v53.origin.y;
      v8 = v53.size.width;
      v10 = v53.size.height;
    }
  }

  if (vmaxv_u16(vmovn_s32(vmvnq_s8(vuzp1q_s32(vceqzq_f64(*&self->_visibleRectInsets.top), vceqzq_f64(*&self->_visibleRectInsets.bottom))))))
  {
    [(UICollectionView *)self _effectiveVisibleBoundsForBounds:v4, v6, v8, v10];
    v4 = v41;
    v6 = v42;
    v8 = v43;
    v10 = v44;
  }

  v45 = v4;
  v46 = v6;
  v47 = v8;
  v48 = v10;
  result.size.height = v48;
  result.size.width = v47;
  result.origin.y = v46;
  result.origin.x = v45;
  return result;
}

- (id)_viewControllerToNotifyOnLayoutSubviews
{
  _viewControllerForAncestor = [(UIView *)self _viewControllerForAncestor];
  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) != 0 && ([_viewControllerForAncestor collectionView], v4 = objc_claimAutoreleasedReturnValue(), v4, v4 == self))
  {
    _viewControllerToNotifyOnLayoutSubviews = _viewControllerForAncestor;
  }

  else
  {
    v8.receiver = self;
    v8.super_class = UICollectionView;
    _viewControllerToNotifyOnLayoutSubviews = [(UIView *)&v8 _viewControllerToNotifyOnLayoutSubviews];
  }

  v6 = _viewControllerToNotifyOnLayoutSubviews;

  return v6;
}

- (void)layoutSubviews
{
  v23.receiver = self;
  v23.super_class = UICollectionView;
  [(UIScrollView *)&v23 layoutSubviews];
  v3 = *(&self->_collectionViewFlags + 1);
  v4 = v3 & 0x1000000020000000;
  v5 = v3 & 0x400100000000;
  if (v4 != 0x20000000 && v5 == 0)
  {
    WeakRetained = objc_loadWeakRetained(&self->_dataSource);

    if (WeakRetained)
    {
      *(&self->_collectionViewFlags + 1) |= 0x400000000000uLL;
      collectionViewData = self->_collectionViewData;
      if (collectionViewData)
      {
        v9 = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
      }

      else
      {
        LOBYTE(v9) = 0;
      }

      [(UICollectionView *)self _reloadDataIfNeeded];
      [(UICollectionView *)self _visibleBounds];
      v11 = v10;
      v13 = v12;
      v15 = v14;
      v17 = v16;
      [(UICollectionViewData *)self->_collectionViewData validateLayoutInRect:v10, v12, v14, v16];
      if ((v9 & 1) == 0)
      {
        [(UICollectionView *)self _updateDefaultLayoutMargins];
      }

      [(UICollectionView *)self _recomputePreferredAttributesForInvalidatedElementsIfNeeded];
      if ((*(&self->_collectionViewFlags + 9) & 4) != 0 && !self->_reloadingSuspendedCount)
      {
        v18 = objc_autoreleasePoolPush();
        v19 = [(UICollectionView *)self _updateVisibleCellsNow:1];
        if ([(UICollectionView *)self _prefetchingAllowed])
        {
          [(UICollectionView *)self _updatePrefetchVelocityIntegratorForVisibleBounds:v11, v13, v15, v17];
          v20 = !v19 && (*(&self->_collectionViewFlags + 1) >= 0);
          if (![(UICollectionView *)self _updatePrefetchedCells:v20]&& (*(&self->_collectionViewFlags + 15) & 1) != 0)
          {
            [(UICollectionView *)self _performReloadPrefetchIfNeeded];
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      [(UICollectionView *)self _updateBackgroundView];
      [(UICollectionView *)self _updateIndex];
      _focusSystem = [(UIView *)self _focusSystem];
      if (_focusSystem)
      {
        v22 = *(&self->_collectionViewFlags + 1);

        if ((v22 & 0x400000000) == 0)
        {
          [(UICollectionView *)self _highlightFirstVisibleItemIfAppropriate];
        }
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFEFFBFFBFFFFFFFFLL | 0x400000000;
      [(UICollectionView *)self _updateContentFocusContainerGuides];
    }
  }
}

- (void)_updateBackgroundView
{
  [(UIView *)self bounds];
  [(UIView *)self->_backgroundView setFrame:?];
  backgroundView = self->_backgroundView;
  v4 = self->_layout;
  v5 = backgroundView;
  v6 = v5;
  if (v4)
  {
    v7 = v5 == 0;
  }

  else
  {
    v7 = 1;
  }

  if (!v7)
  {
    effectiveUserInterfaceLayoutDirection = [(UIView *)v5 effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v4 developmentLayoutDirection])
    {
      if (![(UIView *)v6 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
    }

    else
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v4 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v6 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
  }

LABEL_10:

  v10 = self->_backgroundView;

  [(UIScrollView *)self _moveContentSubview:v10 toBack:1];
}

- (void)_recomputePreferredAttributesForInvalidatedElementsIfNeeded
{
  v3 = self->_intrinsicContentSizeInvalidationContext;
  if (v3)
  {
    if ((*(&self->_collectionViewFlags + 16) & 0x80) != 0 && ([(UIView *)self window], v4 = objc_claimAutoreleasedReturnValue(), v4, v4))
    {
      v5 = *(&self->_collectionViewFlags + 4);
      if ((v5 & 0x100) == 0)
      {
        *(&self->_collectionViewFlags + 4) = v5 | 0x100;
        [(UIScrollView *)self setNeedsLayout];
        goto LABEL_21;
      }

      v6 = 1;
    }

    else
    {
      v6 = 0;
    }

    invalidatedItemIndexPaths = [(UICollectionViewLayoutInvalidationContext *)v3 invalidatedItemIndexPaths];
    invalidatedSupplementaryIndexPaths = [(UICollectionViewLayoutInvalidationContext *)v3 invalidatedSupplementaryIndexPaths];
    if ([invalidatedItemIndexPaths count] || objc_msgSend(invalidatedSupplementaryIndexPaths, "count"))
    {
      v28[0] = MEMORY[0x1E69E9820];
      v28[1] = 3221225472;
      v28[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke;
      v28[3] = &unk_1E70F6228;
      v28[4] = self;
      v29 = invalidatedItemIndexPaths;
      v30 = invalidatedSupplementaryIndexPaths;
      if (v6)
      {
        v9 = self->_collectionViewData;
        [(UICollectionView *)self _visibleBounds];
        [(UICollectionViewData *)v9 validateLayoutInRect:v10, v11, v12, v13];
        if (v9)
        {
          *&v9->_collectionViewDataFlags |= 0x10u;
        }

        v14 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
        collectionViewData = self->_collectionViewData;
        self->_collectionViewData = v14;

        v26[0] = 0;
        v26[1] = v26;
        v26[2] = 0x3032000000;
        v26[3] = __Block_byref_object_copy__39;
        v26[4] = __Block_byref_object_dispose__39;
        v27 = 0;
        v16 = dyld_program_sdk_at_least();
        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_3;
        v22[3] = &unk_1E70FF868;
        v24 = v26;
        v25 = v28;
        if (v16)
        {
          v17 = 6;
        }

        else
        {
          v17 = 4;
        }

        v22[4] = self;
        v18 = v9;
        v23 = v18;
        v21[0] = MEMORY[0x1E69E9820];
        v21[1] = 3221225472;
        v21[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_4;
        v21[3] = &unk_1E70FF890;
        v21[4] = self;
        v21[5] = v26;
        [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v17 options:v22 animations:v21 completion:?];

        _Block_object_dispose(v26, 8);
      }

      else
      {
        __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke(v28);
      }

      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
      v19 = *(&self->_collectionViewFlags + 4);
      *(&self->_collectionViewFlags + 4) = v19 & 0xFFFFF9FF | ((((v19 + 512) >> 9) & 3) << 9);
      if ((v19 & 0x600) == 0)
      {
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_5;
        v20[3] = &unk_1E70F3590;
        v20[4] = self;
        [UIApp _performBlockAfterCATransactionCommits:v20];
      }
    }

    else
    {
      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
    }
  }

LABEL_21:
}

- (void)_safeAreaInsetsWillChange
{
  v8 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_safeAreaInsetsWillChange___s_category);
  if (*CategoryCachedImpl)
  {
    v4 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy = self;
      _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "_safeAreaInsetsWillChange: cv == %p; Attempting to save anchor for change to safe area", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _safeAreaInsetsWillChange];
}

- (void)_notifyDidScroll
{
  if (self->_didScrollNotificationSuspensionCount <= 0)
  {
    v5 = v2;
    v6 = v3;
    v4.receiver = self;
    v4.super_class = UICollectionView;
    [(UIScrollView *)&v4 _notifyDidScroll];
  }
}

- (void)_clearTargetIndexPathForScrolling
{
  scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
  self->_scrollingTargetIndexPath = 0;

  self->_offsetToScrollingTarget = *MEMORY[0x1E695EFF8];
  v4 = *(MEMORY[0x1E695F058] + 16);
  self->_scrollingTargetFrame.origin = *MEMORY[0x1E695F058];
  self->_scrollingTargetFrame.size = v4;
  self->_requestedPositionOfScrollingTarget = 0;
  *(&self->_collectionViewFlags + 4) &= ~0x10000u;
}

- (void)_layoutSectionContainerViews
{
  sectionToContainerViewMap = self->_sectionToContainerViewMap;
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __48__UICollectionView__layoutSectionContainerViews__block_invoke;
  v3[3] = &unk_1E70FEDB8;
  v3[4] = self;
  [(NSMutableDictionary *)sectionToContainerViewMap enumerateKeysAndObjectsUsingBlock:v3];
}

- (BOOL)_useIdleObserverForCellPrefetching
{
  v2 = _UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewCellPrefetchingMode, @"CollectionViewCellPrefetchingMode", _UIInternalPreferenceUpdateInteger);
  v3 = qword_1ED48AAD0;
  if (v2)
  {
    v3 = 0;
  }

  if (v3 >= 0xFFFFFFFFFFFFFFFELL)
  {
    return 0;
  }

  if (v3 == 1)
  {
    return 1;
  }

  return dyld_program_sdk_at_least();
}

- (void)_processViewSpecificInvalidationsForVisibleViews
{
  v44 = *MEMORY[0x1E69E9840];
  v3 = self->_invalidatedItemIndexPaths;
  invalidatedItemIndexPaths = self->_invalidatedItemIndexPaths;
  self->_invalidatedItemIndexPaths = 0;

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  obj = v3;
  v5 = [(NSMutableSet *)obj countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (v5)
  {
    v6 = v5;
    v31 = *v39;
    do
    {
      v7 = 0;
      do
      {
        if (*v39 != v31)
        {
          objc_enumerationMutation(obj);
        }

        v8 = *(*(&v38 + 1) + 8 * v7);
        v34 = 0u;
        v35 = 0u;
        v36 = 0u;
        v37 = 0u;
        _reorderedItems = [(UICollectionView *)self _reorderedItems];
        v10 = [_reorderedItems countByEnumeratingWithState:&v34 objects:v42 count:16];
        if (v10)
        {
          v11 = v10;
          v12 = *v35;
          while (2)
          {
            for (i = 0; i != v11; ++i)
            {
              if (*v35 != v12)
              {
                objc_enumerationMutation(_reorderedItems);
              }

              targetIndexPath = [*(*(&v34 + 1) + 8 * i) targetIndexPath];
              v15 = [targetIndexPath isEqual:v8];

              if (v15)
              {
                v16 = 1;
                goto LABEL_16;
              }
            }

            v11 = [_reorderedItems countByEnumeratingWithState:&v34 objects:v42 count:16];
            if (v11)
            {
              continue;
            }

            break;
          }
        }

        v16 = 0;
LABEL_16:

        v17 = [(UICollectionView *)self _visibleCellForIndexPath:v8];
        if (v17)
        {
          v18 = v17;
          [v17 _invalidatePreferredAttributes];
          v19 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v8];
          if (v19)
          {
            v20 = v19;
            [(UICollectionView *)self _checkForPreferredAttributesInView:v18 originalAttributes:v19];
            if ((v16 & 1) == 0)
            {
              [(UICollectionView *)self _applyLayoutAttributes:v20 toView:v18];
            }
          }

          else
          {
            if (([v18 _isInUpdateAnimation] & 1) == 0)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              _ui_shortDescription = [v8 _ui_shortDescription];
              v24 = [(UICollectionViewLayout *)self->_layout layoutAttributesForItemAtIndexPath:v8];
              _layoutAttributes = [v18 _layoutAttributes];
              dataSourceCountsDescription = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
              [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6380 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated item. Index path: %@; cell: %@; attributes from layout: %@; attributes from cell: %@; collection view: %@; data source counts: %@.", _ui_shortDescription, v18, v24, _layoutAttributes, self, dataSourceCountsDescription}];
            }

            v20 = 0;
          }
        }

        else
        {
          v21 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v8];
          v20 = v21;
          if (v21)
          {
            *(v21 + 8) |= 3u;
          }
        }

        ++v7;
      }

      while (v7 != v6);
      v6 = [(NSMutableSet *)obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    }

    while (v6);
  }

  invalidatedSupplementaryIndexPaths = self->_invalidatedSupplementaryIndexPaths;
  v33[0] = MEMORY[0x1E69E9820];
  v33[1] = 3221225472;
  v33[2] = __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke;
  v33[3] = &unk_1E70FF190;
  v33[4] = self;
  v33[5] = a2;
  [(NSMutableDictionary *)invalidatedSupplementaryIndexPaths enumerateKeysAndObjectsUsingBlock:v33];
  invalidatedDecorationIndexPaths = self->_invalidatedDecorationIndexPaths;
  v32[0] = MEMORY[0x1E69E9820];
  v32[1] = 3221225472;
  v32[2] = __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke_2;
  v32[3] = &unk_1E70FF190;
  v32[4] = self;
  v32[5] = a2;
  [(NSMutableDictionary *)invalidatedDecorationIndexPaths enumerateKeysAndObjectsUsingBlock:v32];
}

- (void)_clearContentOffsetRestorationAnchor
{
  contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
  self->_contentOffsetRestorationAnchor = 0;

  self->_offsetToContentOffsetRestorationAnchor = *MEMORY[0x1E695EFF8];
}

- (void)_setUpCompletionHandlerForAnimationInterruptionIfNecessary
{
  if (+[UIView _isInAnimationBlockWithAnimationsEnabled])
  {
    v3[0] = MEMORY[0x1E69E9820];
    v3[1] = 3221225472;
    v3[2] = __78__UICollectionView__setUpCompletionHandlerForAnimationInterruptionIfNecessary__block_invoke;
    v3[3] = &unk_1E70F5AC0;
    v3[4] = self;
    [UIView _addCompletion:v3];
  }
}

- (BOOL)_prefetchingAllowed
{
  if (_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewCellPrefetchingMode, @"CollectionViewCellPrefetchingMode", _UIInternalPreferenceUpdateInteger))
  {
    v3 = 0;
  }

  else
  {
    v3 = qword_1ED48AAD0;
  }

  if (v3 == -2)
  {
    return 0;
  }

  if (v3 != 1 && (*(&self->_collectionViewFlags + 4) & 1) == 0)
  {
    return 0;
  }

  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    if ([(NSMutableArray *)dragAndDropController->__reorderedItems count])
    {
      return 0;
    }
  }

  if ([(UICollectionView *)self hasActiveDrop])
  {
    return 0;
  }

  if (v3 == 1)
  {
    return 1;
  }

  _estimatesSizes = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  v8 = dyld_program_sdk_at_least();
  if (v8 && _estimatesSizes)
  {
    LOBYTE(v8) = [(UICollectionViewLayout *)self->_layout _supportsPrefetchingWithEstimatedSizes];
  }

  if (v3 != -1 && (v8 & 1) != 0)
  {
    return 1;
  }

  return dyld_program_sdk_at_least() & !_estimatesSizes;
}

- (void)_resumeDidScrollNotifications
{
  v24 = *MEMORY[0x1E69E9840];
  if (self)
  {
    v2 = *(self + 363);
    if (v2 <= 0)
    {
      if (os_variant_has_internal_diagnostics())
      {
        v11 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
        {
          v18 = 138412290;
          selfCopy3 = self;
          _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "Unbalanced calls to suspend/resumeDidScrollNotifications for collection view %@.", &v18, 0xCu);
        }
      }

      else
      {
        v10 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924C0) + 8);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
        {
          v18 = 138412290;
          selfCopy3 = self;
          _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "Unbalanced calls to suspend/resumeDidScrollNotifications for collection view %@.", &v18, 0xCu);
        }
      }
    }

    else
    {
      v3 = v2 - 1;
      *(self + 363) = v3;
      if (!v3)
      {
        [(CGFloat *)self contentOffset];
        v6 = v5;
        v7 = v4;
        if (self[361] != v5 || self[362] != v4)
        {
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4924C8);
          if (*CategoryCachedImpl)
          {
            v12 = *(CategoryCachedImpl + 8);
            if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
            {
              v13 = self[361];
              v14 = self[362];
              v15 = v12;
              v25.x = v13;
              v25.y = v14;
              v16 = NSStringFromCGPoint(v25);
              v26.x = v6;
              v26.y = v7;
              v17 = NSStringFromCGPoint(v26);
              v18 = 134218498;
              selfCopy3 = self;
              v20 = 2112;
              v21 = v16;
              v22 = 2112;
              v23 = v17;
              _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "cv == %p notifying didScroll for change in content offset from %@ to %@", &v18, 0x20u);
            }
          }

          [(CGFloat *)self _notifyDidScroll];
        }
      }
    }
  }
}

- (void)_ensureFocusedViewIsNotHidden
{
  v43 = *MEMORY[0x1E69E9840];
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v4 = _focusedItemState;
  if (_focusedItemState)
  {
    v5 = *(_focusedItemState + 8);
  }

  else
  {
    v5 = 0;
  }

  v6 = v5;

  if (v6)
  {
    layout = self->_layout;
    _layoutAttributes = [v6 _layoutAttributes];
    [v6 frame];
    [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:_layoutAttributes frame:?];
    v10 = v9;
    v12 = v11;
    v14 = v13;
    v16 = v15;

    if ([v6 _isHiddenForReuse])
    {
      [(UICollectionView *)self _visibleBounds];
      x = v44.origin.x;
      y = v44.origin.y;
      width = v44.size.width;
      height = v44.size.height;
      if (!CGRectIsNull(v44))
      {
        v45.origin.x = v10;
        v45.origin.y = v12;
        v45.size.width = v14;
        v45.size.height = v16;
        if (!CGRectIsNull(v45))
        {
          v46.origin.x = x;
          v46.origin.y = y;
          v46.size.width = width;
          v46.size.height = height;
          v47 = CGRectStandardize(v46);
          v21 = v47.origin.x;
          v22 = v47.origin.y;
          v23 = v47.size.width;
          v24 = v47.size.height;
          v47.origin.x = v10;
          v47.origin.y = v12;
          v47.size.width = v14;
          v47.size.height = v16;
          v48 = CGRectStandardize(v47);
          v25 = v48.origin.x;
          v26 = v48.origin.y;
          v27 = v48.size.width;
          v28 = v48.size.height;
          v39 = v22;
          v40 = v21;
          v48.origin.x = v21;
          v48.origin.y = v22;
          v48.size.width = v23;
          v48.size.height = v24;
          v29 = CGRectGetMinX(v48) + 0.0001;
          v49.origin.x = v25;
          v49.origin.y = v26;
          v49.size.width = v27;
          v49.size.height = v28;
          if (v29 <= CGRectGetMaxX(v49))
          {
            v50.origin.y = v39;
            v50.origin.x = v21;
            v50.size.width = v23;
            v50.size.height = v24;
            v31 = CGRectGetMaxX(v50) + -0.0001;
            v51.origin.x = v25;
            v51.origin.y = v26;
            v51.size.width = v27;
            v51.size.height = v28;
            v30 = v31 >= CGRectGetMinX(v51);
          }

          else
          {
            v30 = 0;
          }

          v52.origin.x = v21;
          v52.origin.y = v39;
          v52.size.width = v23;
          v52.size.height = v24;
          v32 = CGRectGetMinY(v52) + 0.0001;
          v53.origin.x = v25;
          v53.origin.y = v26;
          v53.size.width = v27;
          v53.size.height = v28;
          if (v32 <= CGRectGetMaxY(v53))
          {
            v54.origin.x = v40;
            v54.origin.y = v39;
            v54.size.width = v23;
            v54.size.height = v24;
            v33 = CGRectGetMaxY(v54) + -0.0001;
            v55.origin.x = v25;
            v55.origin.y = v26;
            v55.size.width = v27;
            v55.size.height = v28;
            if (v33 >= CGRectGetMinY(v55) && v30)
            {
              has_internal_diagnostics = os_variant_has_internal_diagnostics();
              v36 = [(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:v6];
              if (has_internal_diagnostics)
              {
                if (v36)
                {
                  v37 = __UIFaultDebugAssertLog();
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_FAULT))
                  {
                    *buf = 138412290;
                    v42 = v6;
                    _os_log_fault_impl(&dword_188A29000, v37, OS_LOG_TYPE_FAULT, "Making focused cell visible that is still in the reuse queue: %@", buf, 0xCu);
                  }
                }
              }

              else if (v36)
              {
                v38 = *(__UILogGetCategoryCachedImpl("Assert", &_ensureFocusedViewIsNotHidden___s_category) + 8);
                if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138412290;
                  v42 = v6;
                  _os_log_impl(&dword_188A29000, v38, OS_LOG_TYPE_ERROR, "Making focused cell visible that is still in the reuse queue: %@", buf, 0xCu);
                }
              }

              [v6 _setHiddenForReuse:0];
            }
          }
        }
      }
    }
  }
}

- (BOOL)hasActiveDrop
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    return [(_UICollectionViewDragDestinationController *)&dragAndDropController->_destinationController->super.isa isActive];
  }

  else
  {
    return 0;
  }
}

- (BOOL)canBeEdited
{
  if (dyld_program_sdk_at_least())
  {
    return 1;
  }

  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  canBeEdited = [collectionViewLayout canBeEdited];

  return canBeEdited;
}

- (BOOL)_allowsEffectiveSelection
{
  if ([(UICollectionView *)self _isEditing])
  {

    return [(UICollectionView *)self allowsSelectionDuringEditing];
  }

  else
  {

    return [(UICollectionView *)self allowsSelection];
  }
}

- (void)_layoutAdjustmentsDidChange
{
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 _layoutAdjustmentsDidChange];
  [(UICollectionViewLayout *)self->_layout _scrollViewLayoutAdjustmentsChanged];
}

- (void)_updateDefaultLayoutMargins
{
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  [collectionViewLayout _preferredLayoutMargins];
  v5 = v4;
  v7 = v6;
  v9 = v8;
  v11 = v10;

  if (v5 == 1.79769313e308)
  {
    v12 = 8.0;
  }

  else
  {
    v12 = v5;
  }

  if (v7 == 1.79769313e308)
  {
    v13 = 8.0;
  }

  else
  {
    v13 = v7;
  }

  if (v9 == 1.79769313e308)
  {
    v14 = 8.0;
  }

  else
  {
    v14 = v9;
  }

  if (v11 == 1.79769313e308)
  {
    v15 = 8.0;
  }

  else
  {
    v15 = v11;
  }

  [(UICollectionView *)self _setDefaultLayoutMargins:0 fromViewController:v12, v13, v14, v15];
}

- (NSArray)visibleCells
{
  [(UICollectionView *)self _reloadDataIfNeeded];

  return [(UICollectionView *)self _existingVisibleCells];
}

- (id)_dataSourceSectionIndexTitles
{
  indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
  if (!indexBarSectionIndexTitles)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x2000000000000000) != 0)
    {
      _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
      v6 = [_dataSourceProxy _collectionView:self sectionIndexTitlesTrimmedToCount:0x7FFFFFFFFFFFFFFFLL];
    }

    else if ((collectionViewFlags & 0x1000000000000000) != 0)
    {
      _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
      v6 = [_dataSourceProxy _sectionIndexTitlesForCollectionView:self];
    }

    else
    {
      if ((*(&self->_collectionViewFlags + 8) & 2) == 0)
      {
        _dataSourceProxy = 0;
        self->_indexBarSectionIndexTitles = MEMORY[0x1E695E0F0];
LABEL_10:

        indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
        goto LABEL_11;
      }

      _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
      v6 = [_dataSourceProxy indexTitlesForCollectionView:self];
    }

    v7 = self->_indexBarSectionIndexTitles;
    self->_indexBarSectionIndexTitles = v6;

    goto LABEL_10;
  }

LABEL_11:
  v8 = indexBarSectionIndexTitles;

  return v8;
}

- (CGSize)intrinsicContentSize
{
  if ([(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    layout = self->_layout;

    [(UICollectionViewLayout *)layout collectionViewContentSize];
  }

  else
  {
    v6.receiver = self;
    v6.super_class = UICollectionView;
    [(UIView *)&v6 intrinsicContentSize];
  }

  result.height = v5;
  result.width = v4;
  return result;
}

- (void)_updateIndex
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v3 = *(&self->_collectionViewFlags + 1);
  if ((v3 & 0x200000000000000) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v3 | 0x200000000000000;
    _indexBarEntries = [(UICollectionView *)self _indexBarEntries];
    if ([_indexBarEntries count])
    {
      _staticScrollBar = [(UIScrollView *)self _staticScrollBar];
    }

    else
    {
      v7 = *p_collectionViewFlags;
      _staticScrollBar2 = [(UIScrollView *)self _staticScrollBar];
      _staticScrollBar = _staticScrollBar2;
      if ((v7 & 0x1000000000000000) == 0)
      {
        if (_staticScrollBar2)
        {
          [_staticScrollBar2 setShowIndexBar:0];
        }

        [(UICollectionView *)self _removeStandaloneIndexBarIfNecessary];
        goto LABEL_16;
      }
    }

    if (_staticScrollBar)
    {
      [_staticScrollBar setShowIndexBar:1];
      indexBarView = [_staticScrollBar indexBarView];
      [(UICollectionView *)self _removeStandaloneIndexBarIfNecessary];
    }

    else
    {
      indexBar = self->_indexBar;
      if (indexBar)
      {
        indexBarView = indexBar;
      }

      else
      {
        v16 = 0;
        v17 = 0;
        traitCollection = [(UIView *)self traitCollection];
        [UIIndexBarAccessoryView makeIndexBarView:&v17 scrollAccessoryContainerView:&v16 forTraits:traitCollection];
        v12 = v17;
        indexBarView = v17;
        v13 = v16;

        [(UIScrollView *)self setAccessoryView:v13 atEdge:1];
        objc_storeStrong(&self->_indexBar, v12);
      }
    }

    [(UIIndexBarView *)indexBarView setDelegate:self];
    [(UIIndexBarAccessoryView *)indexBarView setEntries:_indexBarEntries];
    [(UIIndexBarView *)indexBarView setDrawingInsets:0.0, 0.0, 0.0, 0.0];
    _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
    v15 = _indexOverlayManager;
    if (_indexOverlayManager)
    {
      [*(_indexOverlayManager + 24) reloadData];
    }

LABEL_16:
  }
}

- (id)_indexBarEntries
{
  if ((*(&self->_collectionViewFlags + 7) & 0x10) != 0 || (*(&self->_collectionViewFlags + 8) & 2) != 0)
  {
    _dataSourceSectionIndexTitles = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    if ([_dataSourceSectionIndexTitles count])
    {
      v5 = objc_alloc_init(MEMORY[0x1E695DF70]);
      v10[0] = MEMORY[0x1E69E9820];
      v10[1] = 3221225472;
      v10[2] = __36__UICollectionView__indexBarEntries__block_invoke;
      v10[3] = &unk_1E70FF4D0;
      v10[4] = self;
      v6 = v5;
      v11 = v6;
      [_dataSourceSectionIndexTitles enumerateObjectsUsingBlock:v10];
      v7 = v11;
      _indexBarEntries = v6;
    }

    else
    {
      v12.receiver = self;
      v12.super_class = UICollectionView;
      _indexBarEntries = [(UIScrollView *)&v12 _indexBarEntries];
    }
  }

  else
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    _indexBarEntries = [(UIScrollView *)&v9 _indexBarEntries];
  }

  return _indexBarEntries;
}

- (void)_removeStandaloneIndexBarIfNecessary
{
  v3 = self->_indexBar;
  if (v3)
  {
    v7 = v3;
    v4 = [(UIScrollView *)self accessoryViewAtEdge:1];
    v5 = [(UIView *)v7 isDescendantOfView:v4];

    if (v5)
    {
      [(UIScrollView *)self setAccessoryView:0 atEdge:1];
    }

    indexBar = self->_indexBar;
    self->_indexBar = 0;

    v3 = v7;
  }
}

- (void)_reloadSectionIndexTitles
{
  *(&self->_collectionViewFlags + 1) &= ~0x200000000000000uLL;
  indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
  self->_indexBarSectionIndexTitles = 0;

  [(UICollectionView *)self _updateIndex];
}

- (id)preparedCells
{
  visibleCells = [(UICollectionView *)self visibleCells];
  v4 = [visibleCells mutableCopy];

  prefetchCacheItems = self->_prefetchCacheItems;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __33__UICollectionView_preparedCells__block_invoke;
  v8[3] = &unk_1E70FEF90;
  v6 = v4;
  v9 = v6;
  [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v8];

  return v6;
}

- (id)_existingVisibleCells
{
  v32 = *MEMORY[0x1E69E9840];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    [(UICollectionView *)self _visibleBounds];
    v4 = v3;
    v6 = v5;
    v8 = v7;
    v10 = v9;
    visibleCells = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCells];
    v12 = [visibleCells mutableCopy];

    v13 = objc_alloc_init(MEMORY[0x1E696AD50]);
    v27 = 0u;
    v28 = 0u;
    v29 = 0u;
    v30 = 0u;
    obj = v12;
    v14 = [obj countByEnumeratingWithState:&v27 objects:v31 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = 0;
      v17 = *v28;
      do
      {
        for (i = 0; i != v15; ++i)
        {
          if (*v28 != v17)
          {
            objc_enumerationMutation(obj);
          }

          v19 = *(*(&v27 + 1) + 8 * i);
          _layoutAttributes = [v19 _layoutAttributes];
          indexPath = [_layoutAttributes indexPath];
          v22 = [(UICollectionView *)self _indexPathBeforeShadowUpdatesForIndexPath:indexPath];

          if (!v22)
          {
            [v13 addIndex:v16];
          }

          _layoutAttributes2 = [v19 _layoutAttributes];
          layout = self->_layout;
          [_layoutAttributes2 frame];
          [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:_layoutAttributes2 frame:?];
          v35.origin.x = v4;
          v35.origin.y = v6;
          v35.size.width = v8;
          v35.size.height = v10;
          if (!CGRectIntersectsRect(v34, v35))
          {
            [v13 addIndex:v16];
          }

          ++v16;
        }

        v15 = [obj countByEnumeratingWithState:&v27 objects:v31 count:16];
      }

      while (v15);
    }

    [obj removeObjectsAtIndexes:v13];
  }

  else
  {
    obj = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCells];
  }

  return obj;
}

- (BOOL)_dataSourceImplementsReorderingHandlers
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    _diffableDataSourceImpl = [(UICollectionView *)self _diffableDataSourceImpl];
    reorderingHandlers = [_diffableDataSourceImpl reorderingHandlers];
    canReorderItemHandler = [reorderingHandlers canReorderItemHandler];

    canReorderItemHandler2 = [_diffableDataSourceImpl canReorderItemHandler];
    if (canReorderItemHandler2)
    {
      didApplySnapshotHandler = [_diffableDataSourceImpl didApplySnapshotHandler];
      v8 = didApplySnapshotHandler != 0;
    }

    else
    {
      v8 = 0;
    }

    v2 = canReorderItemHandler != 0 || v8;
  }

  else
  {
    return 0;
  }

  return v2;
}

- (void)_setupCellAnimations
{
  v8 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  if ((*(&self->_collectionViewFlags + 12) & 0x40) != 0)
  {
    if (os_variant_has_internal_diagnostics())
    {
      v5 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v5, OS_LOG_TYPE_FAULT))
      {
        v6 = 138412290;
        selfCopy2 = self;
        _os_log_fault_impl(&dword_188A29000, v5, OS_LOG_TYPE_FAULT, "UICollectionView client error: attempting to perform update while UICollectionView is updating its visible views. This will result in undefined behavior. Collection view: %@", &v6, 0xCu);
      }
    }

    else
    {
      v4 = *(__UILogGetCategoryCachedImpl("Assert", &_setupCellAnimations___s_category) + 8);
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        v6 = 138412290;
        selfCopy2 = self;
        _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "UICollectionView client error: attempting to perform update while UICollectionView is updating its visible views. This will result in undefined behavior. Collection view: %@", &v6, 0xCu);
      }
    }
  }

  [(UICollectionViewLayout *)self->_layout _collectionViewWillPerformPendingLayoutBeforeUpdate];
  [(UICollectionView *)self _updateVisibleCellsNow:0];
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  *(p_collectionViewFlags + 1) |= 0x1000000000uLL;
  [(UICollectionView *)self _suspendReloads];
}

- (void)_beginUpdates
{
  updateCount = self->_updateCount;
  if (!updateCount)
  {
    [(UICollectionView *)self _setupCellAnimations];
    updateCount = self->_updateCount;
  }

  self->_updateCount = updateCount + 1;
}

- (id)_sortedDeduplicatedReloadItems
{
  v19 = *MEMORY[0x1E69E9840];
  v2 = self->_reloadItems;
  v3 = v2;
  if (v2)
  {
    if ([(NSMutableArray *)v2 count]> 1)
    {
      v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableArray count](v3, "count")}];
      v5 = [objc_alloc(MEMORY[0x1E695DFA8]) initWithCapacity:{-[NSMutableArray count](v3, "count")}];
      v14 = 0u;
      v15 = 0u;
      v16 = 0u;
      v17 = 0u;
      v6 = v3;
      v7 = [(NSMutableArray *)v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v7)
      {
        v8 = v7;
        v9 = *v15;
        do
        {
          for (i = 0; i != v8; ++i)
          {
            if (*v15 != v9)
            {
              objc_enumerationMutation(v6);
            }

            v11 = *(*(&v14 + 1) + 8 * i);
            _indexPath = [(UICollectionViewUpdateItem *)v11 _indexPath];
            if (([v5 containsObject:{_indexPath, v14}] & 1) == 0)
            {
              [v5 addObject:_indexPath];
              [v4 insertObject:v11 atIndex:{objc_msgSend(v4, "indexOfObject:inSortedRange:options:usingComparator:", v11, 0, objc_msgSend(v4, "count"), 1024, &__block_literal_global_763)}];
            }
          }

          v8 = [(NSMutableArray *)v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
        }

        while (v8);
      }
    }

    else
    {
      v4 = [(NSMutableArray *)v3 mutableCopy];
    }
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (BOOL)_isFirstResponderInDeletedSectionOrItem
{
  if (self->_firstResponderView)
  {
    firstResponderIndexPath = self->_firstResponderIndexPath;
    if (firstResponderIndexPath)
    {
      currentUpdate = self->_currentUpdate;
      if (currentUpdate)
      {
        if (self->_firstResponderViewType == 1)
        {
          v5 = [(UICollectionViewUpdate *)currentUpdate finalIndexPathForInitialIndexPath:?];
        }

        else
        {
          v7 = [(NSIndexPath *)firstResponderIndexPath length];
          v8 = self->_currentUpdate;
          if (v7 == 1)
          {
            v9 = [(NSMutableDictionary *)v8->_deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:self->_firstResponderViewKind];
            v6 = [v9 containsIndex:{-[NSIndexPath indexAtPosition:](self->_firstResponderIndexPath, "indexAtPosition:", 0)}];
LABEL_11:

            return v6;
          }

          v5 = [(UICollectionViewUpdate *)v8 validatedNewIndexPathForSupplementaryElementOfKind:self->_firstResponderIndexPath oldIndexPath:?];
        }

        v9 = v5;
        v6 = v5 == 0;
        goto LABEL_11;
      }
    }
  }

  return 0;
}

- (BOOL)_isReordering
{
  if (self)
  {
    dragAndDropController = self->_dragAndDropController;
    if (dragAndDropController)
    {
      LOBYTE(self) = [(NSMutableArray *)dragAndDropController->__reorderedItems count]!= 0;
    }

    else
    {
      LOBYTE(self) = 0;
    }
  }

  return self;
}

- (id)_subviewManager
{
  if (self)
  {
    self = self[373];
    v1 = vars8;
  }

  return self;
}

- (BOOL)_hasCustomBackground
{
  if ((*(&self->_collectionViewFlags + 12) & 0x80) != 0)
  {
    return 1;
  }

  backgroundView = [(UICollectionView *)self backgroundView];
  v3 = backgroundView != 0;

  return v3;
}

- (id)_diffableDataSourceImpl
{
  _dataSourceActual = [(UICollectionView *)self _dataSourceActual];
  _diffableDataSourceImpl = 0;
  if ((objc_opt_respondsToSelector() & 1) != 0 && _dataSourceActual != self)
  {
    _diffableDataSourceImpl = [(UICollectionView *)_dataSourceActual _diffableDataSourceImpl];
  }

  return _diffableDataSourceImpl;
}

- (void)_updatePreferredAttributesForCurrentUpdate
{
  v8 = *MEMORY[0x1E69E9840];
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    if (self->_currentUpdate)
    {
      if ([(UICollectionViewLayout *)self->_layout _needsRecomputeOfPreferredAttributesForVisibleEstimatedItemsDuringUpdate])
      {
        if (![(UICollectionView *)self _isReordering])
        {
          indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
          self->_indexPathsRequiringPreferredAttributes = 0;

          [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate:0];
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_updatePreferredAttributesForCurrentUpdate___s_category);
          if (*CategoryCachedImpl)
          {
            v5 = *(CategoryCachedImpl + 8);
            if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
            {
              v6 = 134217984;
              selfCopy = self;
              _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePreferredAttributesForCurrentUpdate finished", &v6, 0xCu);
            }
          }
        }
      }
    }
  }
}

- (BOOL)canBecomeFirstResponder
{
  window = [(UIView *)self window];
  if (window)
  {
    v4 = window;
    window2 = [(UIView *)self window];
    screen = [window2 screen];
    _userInterfaceIdiom = [screen _userInterfaceIdiom];

    if (_userInterfaceIdiom == 3)
    {
      return 1;
    }
  }

  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    if (typeSelectController->_enabled && [(_UITypeSelectInteraction *)typeSelectController->_typeSelectInteraction canBecomeFirstResponder])
    {
      return 1;
    }
  }

  v10.receiver = self;
  v10.super_class = UICollectionView;
  return [(UIResponder *)&v10 canBecomeFirstResponder];
}

uint64_t __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v27 = *MEMORY[0x1E69E9840];
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v25 = 0u;
  v5 = [a3 copy];
  v6 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v23;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v23 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v22 + 1) + 8 * i);
        v11 = [*(a1 + 32) _visibleSupplementaryViewOfKind:a2 atIndexPath:v10];
        v12 = v11;
        if (v11)
        {
          [v11 _invalidatePreferredAttributes];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForSupplementaryElementOfKind:a2 atIndexPath:v10];
          if (v13)
          {
            [*(a1 + 32) _checkForPreferredAttributesInView:v12 originalAttributes:v13];
            [*(a1 + 32) _applyLayoutAttributes:v13 toView:v12];
          }

          else if (([v12 _isInUpdateAnimation] & 1) == 0)
          {
            v20 = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = *(a1 + 32);
            v18 = *(a1 + 40);
            v19 = [v10 _ui_shortDescription];
            v14 = [*(*(a1 + 32) + 2152) layoutAttributesForSupplementaryViewOfKind:a2 atIndexPath:v10];
            v16 = [v12 _layoutAttributes];
            [v20 handleFailureInMethod:v18 object:v17 file:@"UICollectionView.m" lineNumber:6407 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated supplementary view. Element kind: %@; index path: %@; supplementary view: %@; attributes from layout: %@; attributes from view: %@; collection view: %@", a2, v19, v12, v14, v16, *(a1 + 32)}];
          }
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v7);
  }

  return [a3 removeAllObjects];
}

- (id)_delegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->super._delegate);
  }

  return WeakRetained;
}

- (void)_setNeedsRecomputePreferredAttributesForInvalidatedElements
{
  if (!self->_intrinsicContentSizeInvalidationContext)
  {
    v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
    self->_intrinsicContentSizeInvalidationContext = v3;

    [(UIScrollView *)self setNeedsLayout];
  }

  if (+[UIView areAnimationsEnabled]| ((*(&self->_collectionViewFlags + 4) & 0x80u) >> 7))
  {
    v5 = 128;
  }

  else
  {
    v5 = 0;
  }

  *(&self->_collectionViewFlags + 4) = v5 | *(&self->_collectionViewFlags + 4) & 0xFFFFFF7F;
}

uint64_t __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke(uint64_t a1)
{
  v18 = *MEMORY[0x1E69E9840];
  [*(a1 + 32) _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  v15 = 0u;
  v16 = 0u;
  v13 = 0u;
  v14 = 0u;
  v2 = *(a1 + 40);
  v3 = [v2 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v3)
  {
    v4 = v3;
    v5 = *v14;
    do
    {
      for (i = 0; i != v4; ++i)
      {
        if (*v14 != v5)
        {
          objc_enumerationMutation(v2);
        }

        v7 = *(*(&v13 + 1) + 8 * i);
        if ([*(a1 + 32) _indexPathIsValid:v7])
        {
          v8 = [*(a1 + 32) _cellForItemAtIndexPath:v7];
          v9 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v7];
          [*(a1 + 32) _recomputePreferredAttributesForInvalidatedView:v8 originalAttributes:v9];
        }
      }

      v4 = [v2 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v4);
  }

  v10 = *(a1 + 48);
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_2;
  v12[3] = &unk_1E70FA680;
  v12[4] = *(a1 + 32);
  [v10 enumerateKeysAndObjectsUsingBlock:v12];
  return [*(a1 + 32) _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
}

void __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_3(void *a1)
{
  (*(a1[7] + 16))();
  v2 = a1[4];
  if ((v2[2729] & 4) != 0)
  {
    v3 = [v2 _setupAnimationsForResizedViewsWithOldModel:a1[5]];
    v4 = *(a1[6] + 8);
    v5 = *(v4 + 40);
    *(v4 + 40) = v3;
  }
}

uint64_t __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v27 = *MEMORY[0x1E69E9840];
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v25 = 0u;
  v5 = [a3 copy];
  v6 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v23;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v23 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v22 + 1) + 8 * i);
        v11 = [*(a1 + 32) _visibleDecorationViewOfKind:a2 atIndexPath:v10];
        v12 = v11;
        if (v11)
        {
          [v11 _invalidatePreferredAttributes];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForDecorationViewOfKind:a2 atIndexPath:v10];
          if (v13)
          {
            [*(a1 + 32) _checkForPreferredAttributesInView:v12 originalAttributes:v13];
            [*(a1 + 32) _applyLayoutAttributes:v13 toView:v12];
          }

          else if (([v12 _isInUpdateAnimation] & 1) == 0)
          {
            v20 = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = *(a1 + 32);
            v18 = *(a1 + 40);
            v19 = [v10 _ui_shortDescription];
            v14 = [*(*(a1 + 32) + 2152) layoutAttributesForDecorationViewOfKind:a2 atIndexPath:v10];
            v16 = [v12 _layoutAttributes];
            [v20 handleFailureInMethod:v18 object:v17 file:@"UICollectionView.m" lineNumber:6426 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated decoration view. Element kind: %@; index path: %@; decoration view: %@; attributes from layout: %@; attributes from view: %@; collection view: %@", a2, v19, v12, v14, v16, *(a1 + 32)}];
          }
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v7);
  }

  return [a3 removeAllObjects];
}

- (void)_endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate
{
  v4 = *MEMORY[0x1E695EFF8];
  v3 = *(MEMORY[0x1E695EFF8] + 8);
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    _layoutAxis = [(UICollectionViewLayout *)self->_layout _layoutAxis];
    if ((_layoutAxis - 1) <= 1)
    {
      v4 = _UISetPointValueForAxis(_layoutAxis, v4, v3, -1.0);
      v3 = v6;
    }
  }

  _isAutomaticContentOffsetAdjustmentEnabled = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
  [(UIScrollView *)self contentOffset];
  v9 = v8;
  [(UIScrollView *)self _effectiveContentInset];
  if (v9 < -v10 || ([(UIScrollView *)self contentOffset], v12 = v11, [(UIScrollView *)self _effectiveContentInset], v12 < -v13))
  {
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:0];
  }

  [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v4, v3];

  [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:_isAutomaticContentOffsetAdjustmentEnabled];
}

void __36__UICollectionView__indexBarEntries__block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  v5 = *(a1 + 32);
  v6 = a2;
  v8 = [v5 _indexPathForEntryWithTitle:v6 atIndex:a3 validateTitles:0];
  v7 = [UIIndexBarEntry entryWithTitle:v6];

  if (v8)
  {
    [v7 setIndexPath:v8];
  }

  [*(a1 + 40) addObject:v7];
}

- (id)_delegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->super._delegate);

  return WeakRetained;
}

uint64_t __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_4(uint64_t result, uint64_t a2)
{
  v2 = *(*(*(result + 40) + 8) + 40);
  if (v2)
  {
    return [*(result + 32) _updateAnimationDidStop:v2 finished:a2];
  }

  return result;
}

- (BOOL)_allowsEffectiveMultipleSelection
{
  if ([(UICollectionView *)self _isEditing])
  {

    return [(UICollectionView *)self allowsMultipleSelectionDuringEditing];
  }

  else
  {

    return [(UICollectionView *)self allowsMultipleSelection];
  }
}

uint64_t __30__UICollectionView_reloadData__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v21 = *MEMORY[0x1E69E9840];
  if ([a3 _isInUpdateAnimation])
  {
    if (*(a1 + 40) != 1 || !dyld_program_sdk_at_least())
    {
      return 1;
    }

    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", _UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_4___s_category);
    if (*CategoryCachedImpl)
    {
      v11 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        v12 = *(a1 + 32);
        v13 = v11;
        v14 = [a2 _ui_shortDescription];
        v15 = 134218498;
        v16 = v12;
        v17 = 2112;
        v18 = v14;
        v19 = 2112;
        v20 = a3;
        _os_log_impl(&dword_188A29000, v13, OS_LOG_TYPE_ERROR, "[UICV %p] reloadData hiding cell in update animation index path: %@; cell: %@.", &v15, 0x20u);
      }
    }

    [a3 _setHiddenForReuse:1];
  }

  else
  {
    v7 = [a3 _layoutAttributes];
    if (v7)
    {
      v8 = v7[72];

      v9 = *(a1 + 32);
      if (v8)
      {
        [v9 _reuseCell:a3 notifyDidEndDisplaying:1];
        return 0;
      }
    }

    else
    {
      v9 = *(a1 + 32);
    }

    [v9 _reuseSupplementaryView:a3];
  }

  return 0;
}

void __33__UICollectionView_preparedCells__block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v10 = v4;
  if (v4)
  {
    v5 = v4[3];
  }

  else
  {
    v5 = 0;
  }

  v6 = v5;

  if (v6)
  {
    v7 = *(a1 + 32);
    if (v10)
    {
      v8 = v10[3];
    }

    else
    {
      v8 = 0;
    }

    v9 = v8;
    [v7 addObject:v9];
  }
}

- (void)_purgeReuseQueues
{
  [(UICollectionView *)self _resetPrefetchState];
  [(_UICollectionViewSubviewManager *)self->_subviewManager enumerateAllViewsInReuseQueueWithEnumerator:?];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    reuseQueues = subviewManager->_reuseQueues;

    [(NSMutableDictionary *)reuseQueues removeAllObjects];
  }
}

- (BOOL)_shouldFadeCellsForBoundChangeWhileRotating
{
  if (dyld_program_sdk_at_least() && ([(UICollectionViewLayout *)self->_layout _estimatesSizes]|| [(UICollectionViewLayout *)self->_layout _disallowsFadeCellsForBoundsChange]))
  {
    return 0;
  }

  window = [(UIView *)self window];
  _viewControllerForAncestor = [(UIView *)self _viewControllerForAncestor];
  v6 = _viewControllerForAncestor;
  v3 = 1;
  if (window)
  {
    if (_viewControllerForAncestor)
    {
      if ([window isRotating])
      {
        memset(v8, 0, sizeof(v8));
        [v6 _getRotationContentSettings:v8];
        if (LOBYTE(v8[0]) == 1)
        {
          v3 = BYTE3(v8[0]) == 1;
        }
      }
    }
  }

  return v3;
}

- (id)preferredFocusedView
{
  v91 = *MEMORY[0x1E69E9840];
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];
  _currentlyFocusedCell = [_horizontalIndexTitleBar _currentlyFocusedCell];

  if (_currentlyFocusedCell && ![(UICollectionView *)self isMovingFocusFromHorizontalIndexTitleBarToContent])
  {
    preferredFocusedView = _currentlyFocusedCell;
    goto LABEL_7;
  }

  if ((*(&self->_collectionViewFlags + 10) & 0x20408000) != 0)
  {
    goto LABEL_4;
  }

  if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]< 1)
  {
    goto LABEL_4;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    goto LABEL_4;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  if (collectionViewData->_totalItemCount < 1)
  {
LABEL_4:
    if ((*(&self->_collectionViewFlags + 13) & 0x20) == 0)
    {
LABEL_5:
      v86.receiver = self;
      v86.super_class = UICollectionView;
      preferredFocusedView = [(UIView *)&v86 preferredFocusedView];
LABEL_7:
      preferredFocusedView2 = preferredFocusedView;
      goto LABEL_8;
    }

    if (os_variant_has_internal_diagnostics())
    {
      v27 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_FAULT))
      {
        goto LABEL_36;
      }

      v28 = NSStringFromSelector(a2);
      *buf = 138412290;
      v90 = v28;
      _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, "Recursively calling out to %@ while already in the process of creating a reusable view or cell. This might lead to unexpected behavior.", buf, 0xCu);
    }

    else
    {
      v26 = *(__UILogGetCategoryCachedImpl("Assert", &preferredFocusedView___s_category) + 8);
      if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_5;
      }

      v27 = v26;
      v28 = NSStringFromSelector(a2);
      *buf = 138412290;
      v90 = v28;
      _os_log_impl(&dword_188A29000, v27, OS_LOG_TYPE_ERROR, "Recursively calling out to %@ while already in the process of creating a reusable view or cell. This might lead to unexpected behavior.", buf, 0xCu);
    }

LABEL_36:
    goto LABEL_5;
  }

  if ([(UICollectionView *)self isMovingFocusFromHorizontalIndexTitleBarToContent])
  {
    selectedIndexTitleEntry = [(UICollectionView *)self selectedIndexTitleEntry];

    if (selectedIndexTitleEntry)
    {
      selectedIndexTitleEntry2 = [(UICollectionView *)self selectedIndexTitleEntry];
      targetFocusedIndexPath = [selectedIndexTitleEntry2 targetFocusedIndexPath];
      preferredFocusedView2 = [(UICollectionView *)self cellForItemAtIndexPath:targetFocusedIndexPath];
    }

    else
    {
      selectedIndexTitleEntry2 = [(UICollectionView *)self indexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar];
      preferredFocusedView2 = [(UICollectionView *)self cellForItemAtIndexPath:selectedIndexTitleEntry2];
    }

    if (preferredFocusedView2)
    {
      goto LABEL_8;
    }
  }

  _focusedItemState = [(UICollectionView *)self _focusedItemState];

  if (!_focusedItemState)
  {
    goto LABEL_48;
  }

  _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
  v15 = _focusedItemState2;
  if (!_focusedItemState2 || _focusedItemState2[4] != 1)
  {
    _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
    if (_focusedItemState3)
    {
      v17 = _focusedItemState3[4];

      if (v17 == 2)
      {
        goto LABEL_27;
      }
    }

    else
    {
    }

    _focusedItemState4 = [(UICollectionView *)self _focusedItemState];
    v19 = _focusedItemState4;
    if (!_focusedItemState4 || (v20 = *(_focusedItemState4 + 8)) == 0)
    {
      _focusedItemState5 = [(UICollectionView *)self _focusedItemState];
      v22 = _focusedItemState5;
      if (_focusedItemState5)
      {
        v31 = *(_focusedItemState5 + 16);
      }

      else
      {
        v31 = 0;
      }

      v24 = v31;
      v25 = [(UICollectionView *)self _indexPathIsValid:v24];
      goto LABEL_46;
    }

LABEL_42:

LABEL_47:
    _focusedItemState = [(UICollectionView *)self _focusedItemState];
    goto LABEL_48;
  }

LABEL_27:
  _focusedItemState6 = [(UICollectionView *)self _focusedItemState];
  v19 = _focusedItemState6;
  if (_focusedItemState6)
  {
    v20 = *(_focusedItemState6 + 8);
    if (v20)
    {
      goto LABEL_42;
    }
  }

  _focusedItemState7 = [(UICollectionView *)self _focusedItemState];
  v22 = _focusedItemState7;
  if (_focusedItemState7)
  {
    v23 = *(_focusedItemState7 + 16);
  }

  else
  {
    v23 = 0;
  }

  v24 = v23;
  v25 = [(UICollectionView *)self _isSectionValidInIndexPath:v24];
LABEL_46:
  v32 = v25;

  if (v32)
  {
    goto LABEL_47;
  }

  _focusedItemState = 0;
LABEL_48:
  targetFocusedItemState = self->_targetFocusedItemState;
  if (targetFocusedItemState)
  {
    v34 = targetFocusedItemState;
LABEL_50:
    v35 = v34;
    goto LABEL_81;
  }

  if (dyld_program_sdk_at_least() && [(UICollectionView *)self remembersLastFocusedIndexPath])
  {
    if (_focusedItemState)
    {
      _rememberedFocusedItemState = _focusedItemState;
    }

    else
    {
      _rememberedFocusedItemState = [(UICollectionView *)self _rememberedFocusedItemState];
    }

    v35 = _rememberedFocusedItemState;
  }

  else
  {
    v35 = 0;
  }

  _indexPathsForSelectedItems = [(UICollectionView *)self _indexPathsForSelectedItems];
  firstObject = [_indexPathsForSelectedItems firstObject];

  if (firstObject)
  {
    if (v35 && ![(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:firstObject initiatedBySelection:1 focusItemStateCandidate:v35])
    {

      goto LABEL_81;
    }

    v39 = [_UICollectionViewFocusedItemState stateWithIndexPath:firstObject elementKind:@"UICollectionElementKindCell" viewType:0];

    v35 = v39;
  }

  if (!v35)
  {
    _delegatePreferredIndexPath = [(UICollectionView *)self _delegatePreferredIndexPath];
    if (_delegatePreferredIndexPath)
    {
      v35 = [_UICollectionViewFocusedItemState stateWithIndexPath:_delegatePreferredIndexPath elementKind:@"UICollectionElementKindCell" viewType:0];
    }

    else
    {
      v35 = 0;
    }

    if (!v35 && _focusedItemState)
    {
      v34 = _focusedItemState;
      goto LABEL_50;
    }

    if (!v35)
    {
      v41 = *(&self->_collectionViewFlags + 1);
      *(&self->_collectionViewFlags + 1) = v41 & 0xFFFFFBFFFFFFFFFFLL;
      if ([(UIView *)self _shouldReverseLayoutDirection])
      {
        v42 = [(UIView *)self _flipsHorizontalAxis]? 3 : 9;
      }

      else
      {
        v42 = 3;
      }

      [(UIScrollView *)self visibleBounds];
      v47 = _UIRectAnchorPointForEdges(v42, v43, v44, v45, v46);
      v49 = v48;
      v50 = _UIUnitAnchorPointForEdges(v42);
      v52 = v51;
      _focusSystem = [(UIView *)self _focusSystem];
      [(UIScrollView *)self visibleBounds];
      v88[0] = MEMORY[0x1E69E9820];
      v88[1] = 3221225472;
      v88[2] = __40__UICollectionView_preferredFocusedView__block_invoke;
      v88[3] = &unk_1E70FF900;
      v88[4] = self;
      v58 = [_focusSystem _closestFocusableItemToPoint:self inEnvironment:v88 constrainedToRect:v47 distanceMeasuringUnitPoint:v49 itemFilter:{v54, v55, v56, v57, v50, v52}];

      if (v58)
      {
        v59 = _UICollectionViewCellForFocusItem(self, v58);
        v35 = [_UICollectionViewFocusedItemState stateWithReusableView:v59];
      }

      else
      {
        v35 = 0;
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFBFFFFFFFFFFLL | (((v41 >> 42) & 1) << 42);

      if (!v35)
      {
        v84 = self->_collectionViewData;
        if (!v84)
        {
          goto LABEL_117;
        }

        if ((*&v84->_collectionViewDataFlags & 2) == 0)
        {
          [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
        }

        if (v84->_totalItemCount < 1)
        {
          goto LABEL_117;
        }

        v85 = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:?];
        v35 = [_UICollectionViewFocusedItemState stateWithIndexPath:v85 elementKind:@"UICollectionElementKindCell" viewType:0];

        if (!v35)
        {
          goto LABEL_117;
        }
      }
    }
  }

LABEL_81:
  v60 = *(v35 + 8);

  if (v60)
  {
    v61 = v35;
    goto LABEL_110;
  }

  [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  v62 = dyld_program_sdk_at_least();
  if (*(v35 + 32))
  {
    v63 = *(v35 + 24);
    v64 = *(v35 + 16);
    v65 = [(UICollectionView *)self supplementaryViewForElementKind:v63 atIndexPath:v64];

    if (v65)
    {
      goto LABEL_96;
    }

    v66 = *(v35 + 24);
    v67 = *(v35 + 16);
    v68 = [(UICollectionView *)self layoutAttributesForSupplementaryElementOfKind:v66 atIndexPath:v67];

    if (!v68 || ([v68 isHidden] & 1) != 0)
    {
      v65 = 0;
LABEL_95:

      goto LABEL_96;
    }

    *(&self->_collectionViewFlags + 1) |= 0x200000000000uLL;
    v71 = *(v35 + 24);
    v65 = *(v35 + 16);
    v72 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v71 atIndexPath:v65 layout:self->_layout withLayoutAttributes:v68 applyAttributes:1];
LABEL_94:
    v73 = v72;

    *(&self->_collectionViewFlags + 1) &= ~0x200000000000uLL;
    v65 = v73;
    goto LABEL_95;
  }

  v69 = *(v35 + 16);
  v65 = [(UICollectionView *)self _cellForItemAtIndexPath:v69];

  if (!v65 || [v65 _isHiddenForReuse])
  {
    v70 = *(v35 + 16);
    v68 = [(UICollectionView *)self layoutAttributesForItemAtIndexPath:v70];

    if (!v68 || ([v68 isHidden] & 1) != 0)
    {
      goto LABEL_95;
    }

    *(&self->_collectionViewFlags + 1) |= 0x200000000000uLL;
    v71 = *(v35 + 16);
    v72 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:v71 withLayoutAttributes:v68 applyAttributes:1 isFocused:v62 ^ 1u notify:1];
    goto LABEL_94;
  }

LABEL_96:
  v61 = [(_UICollectionViewFocusedItemState *)v35 copyWithReusableView:v65];

  if ((v62 & 1) == 0)
  {
    [(UICollectionView *)self _setFocusedItemState:v61];
    goto LABEL_109;
  }

  if (v61)
  {
    v74 = v61[1];
  }

  else
  {
    v74 = 0;
  }

  v75 = v74;

  if (v75)
  {
    if (v61)
    {
      subviewManager = self->_subviewManager;
      if (v61[4])
      {
        cell = v61[1];
        v78 = v61[3];
        v79 = v61[4];
        v80 = v61[2];
        if (subviewManager)
        {
          [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews setView:cell ofKind:v78 inCategory:v79 atIndexPath:v80];
        }

        goto LABEL_108;
      }

      cell = [(_UICollectionViewFocusedItemState *)v61 cell];
      v81 = v61[2];
    }

    else
    {
      subviewManager = self->_subviewManager;
      cell = [(_UICollectionViewFocusedItemState *)0 cell];
      v81 = 0;
    }

    v78 = v81;
    [(_UICollectionViewSubviewManager *)subviewManager setVisibleCell:cell atIndexPath:v78];
LABEL_108:
  }

LABEL_109:
  [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];

  if (!v61)
  {
LABEL_117:
    v61 = 0;
    goto LABEL_118;
  }

LABEL_110:
  v82 = v61[1];
  if (!v82)
  {
LABEL_118:
    v87.receiver = self;
    v87.super_class = UICollectionView;
    preferredFocusedView2 = [(UIView *)&v87 preferredFocusedView];
    v83 = 0;
    goto LABEL_119;
  }

  v83 = v82;
  preferredFocusedView2 = v83;
LABEL_119:

LABEL_8:

  return preferredFocusedView2;
}

- (id)_delegatePreferredIndexPath
{
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x4000000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v7 = [_delegateProxy indexPathForPreferredFocusedViewInCollectionView:self];
  }

  else
  {
    if ((collectionViewFlags & 0x1000000) == 0)
    {
      v5 = 0;
      goto LABEL_9;
    }

    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v7 = [_delegateProxy indexPathForPreferredFocusedItemForCollectionView:self];
  }

  v5 = v7;

  if (v5 && ![(UICollectionView *)self _indexPathIsValid:v5])
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:15187 description:{@"no cell for index path (%@) - the collection view's delegate must return an index path for a valid UICollectionViewCell from -indexPathForPreferredFocusedViewInCollectionView:", v5}];
  }

LABEL_9:

  return v5;
}

- (BOOL)_allowsEffectiveFocus
{
  if ([(UICollectionView *)self _isEditing]|| ![(UICollectionView *)self allowsFocus])
  {
    _isEditing = [(UICollectionView *)self _isEditing];
    if (_isEditing)
    {

      LOBYTE(_isEditing) = [(UICollectionView *)self allowsFocusDuringEditing];
    }
  }

  else
  {
    LOBYTE(_isEditing) = 1;
  }

  return _isEditing;
}

- (BOOL)allowsFocus
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 22) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __31__UICollectionView_allowsFocus__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

BOOL __40__UICollectionView_preferredFocusedView__block_invoke(uint64_t a1, void *a2)
{
  v2 = _UICollectionViewCellForFocusItem(*(a1 + 32), a2);
  v3 = v2 != 0;

  return v3;
}

- (BOOL)_defaultAllowsFocus
{
  _focusBehavior = [(UIView *)self _focusBehavior];
  cellFocusability = [_focusBehavior cellFocusability];

  allowsSelection = [(UICollectionView *)self allowsSelection];
  result = 0;
  if (allowsSelection && cellFocusability != 3)
  {
    if (cellFocusability == 2)
    {
      traitCollection = [(UIView *)self traitCollection];
      _hasSplitViewControllerContextSidebarColumn = [traitCollection _hasSplitViewControllerContextSidebarColumn];

      return _hasSplitViewControllerContextSidebarColumn;
    }

    else
    {
      return 1;
    }
  }

  return result;
}

- (BOOL)canBecomeFocused
{
  if (![(UICollectionView *)self remembersLastFocusedIndexPath])
  {
    goto LABEL_11;
  }

  if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]< 1)
  {
    goto LABEL_11;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    goto LABEL_11;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)collectionViewData _updateItemCounts];
  }

  if (collectionViewData->_totalItemCount >= 1)
  {
    _focusSystem = [(UIView *)self _focusSystem];
    focusedItem = [_focusSystem focusedItem];

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v6 = focusedItem;
    }

    else
    {
      v6 = 0;
    }

    v7 = ![(UIView *)self containsView:v6];
  }

  else
  {
LABEL_11:
    LOBYTE(v7) = 0;
  }

  return v7;
}

- (void)_highlightFirstVisibleItemIfAppropriate
{
  window = [(UIView *)self window];
  _screen = [window _screen];
  firstObject = [_screen _capabilityForKey:@"UIScreenCapabilityTouchLevelsKey"];
  if ([firstObject integerValue] != 2)
  {
    goto LABEL_5;
  }

  visibleCells = [(UICollectionView *)self visibleCells];
  v6 = [visibleCells count];

  if (!v6)
  {
    return;
  }

  _indexPathsForVisibleItems = [(UICollectionView *)self _indexPathsForVisibleItems];
  window = [_indexPathsForVisibleItems sortedArrayUsingSelector:sel_compare_];

  _screen = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:?];
  if (([window containsObject:_screen] & 1) == 0)
  {
    firstObject = [window firstObject];
    [(UICollectionView *)self _unhighlightAllItemsAndHighlightGlobalItem:[(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:firstObject]];
LABEL_5:
  }
}

- (void)_setupIndexOverlayManagerIfNecessary
{
  _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];

  if (!_indexOverlayManager)
  {
    v4 = [[_UICollectionTableIndexOverlayManager alloc] initWithHost:?];
    [(UICollectionView *)self _setIndexOverlayManager:v4];
  }
}

- (void)dealloc
{
  v27 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v4 = WeakRetained;
  if (WeakRetained)
  {
    objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
  }

  v5 = objc_loadWeakRetained(&self->_containerScrollView);
  if (v5)
  {
    [(UIView *)self _removeGeometryChangeObserver:v5];
  }

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  subviews = [(UIView *)self subviews];
  v7 = [subviews countByEnumeratingWithState:&v20 objects:v26 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v21;
    do
    {
      v10 = 0;
      do
      {
        if (*v21 != v9)
        {
          objc_enumerationMutation(subviews);
        }

        v11 = *(*(&v20 + 1) + 8 * v10);
        objc_opt_class();
        if (objc_opt_isKindOfClass())
        {
          [v11 _setCollectionView:0];
        }

        ++v10;
      }

      while (v8 != v10);
      v8 = [subviews countByEnumeratingWithState:&v20 objects:v26 count:16];
    }

    while (v8);
  }

  collectionView = [(UICollectionViewLayout *)self->_layout collectionView];

  if (collectionView == self)
  {
    [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
  }

  [(_UICollectionViewSubviewRouter *)self->_subviewRouter setContainer:?];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    subviewManager->_collectionView = 0;
  }

  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectController->_collectionView = 0;
  }

  updateCompletionHandler = self->_updateCompletionHandler;
  if (updateCompletionHandler)
  {
    self->_updateCompletionHandler = 0;

    v16 = *(__UILogGetCategoryCachedImpl("UICollectionView", &dealloc___s_category_2) + 8);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      selfCopy = self;
      _os_log_impl(&dword_188A29000, v16, OS_LOG_TYPE_ERROR, "UICollectionView (%@) is being deallocated while an update is in flight (animations have not completed) and an unexpected result may occur.", buf, 0xCu);
    }
  }

  defaultCenter = [MEMORY[0x1E696AD88] defaultCenter];
  [defaultCenter removeObserver:self name:@"UIApplicationDidReceiveMemoryWarningNotification" object:0];

  v18 = +[_UIHDRUsageCoordinator sharedInstance];
  [(_UIHDRUsageCoordinator *)v18 unregisterForDefaultDynamicRangeChanges:?];

  v19.receiver = self;
  v19.super_class = UICollectionView;
  [(UIScrollView *)&v19 dealloc];
}

- (Class)_intelligenceBaseClass
{
  sub_1890B4E34();

  return swift_getObjCClassFromMetadata();
}

- (void)_intelligenceCollectSubelementsIn:(CGRect)in using:(id)using transformToRoot:(id)root
{
  height = in.size.height;
  width = in.size.width;
  y = in.origin.y;
  x = in.origin.x;
  v11 = _Block_copy(root);
  _Block_copy(v11);
  usingCopy = using;
  selfCopy = self;
  sub_1890C4598(usingCopy, selfCopy, v11, x, y, width, height);
  _Block_release(v11);
  _Block_release(v11);
}

- (UICollectionView)initWithFrame:(CGRect)frame collectionViewLayout:(UICollectionViewLayout *)layout
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  v10 = layout;
  if (!v10)
  {
    [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"UICollectionView must be initialized with a non-nil layout parameter"];
  }

  v14.receiver = self;
  v14.super_class = UICollectionView;
  height = [(UIScrollView *)&v14 initWithFrame:x, y, width, height];
  v12 = height;
  if (height)
  {
    objc_storeStrong(&height->_layout, layout);
    *(&v12->_collectionViewFlags + 1) |= 0x9000uLL;
    UICollectionViewCommonSetup(v12);
  }

  return v12;
}

- (UICollectionView)initWithCoder:(NSCoder *)coder
{
  v4 = coder;
  v31.receiver = self;
  v31.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v31 initWithCoder:v4];
  if (v5)
  {
    v6 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionLayout"];
    layout = v5->_layout;
    v5->_layout = v6;

    v8 = [(NSCoder *)v4 decodeObjectForKey:@"UIBackgroundView"];
    backgroundView = v5->_backgroundView;
    v5->_backgroundView = v8;

    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsSelection"])
    {
      v10 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsSelection"];
      v11 = 4096;
      if (!v10)
      {
        v11 = 0;
      }
    }

    else
    {
      v11 = 4096;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFEFFFLL | v11;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsMultipleSelection"])
    {
      v12 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsMultipleSelection"];
      v13 = 0x2000;
      if (!v12)
      {
        v13 = 0;
      }
    }

    else
    {
      v13 = 0;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFDFFFLL | v13;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsSelectionDuringEditing"])
    {
      v14 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsSelectionDuringEditing"];
      v15 = 0x4000;
      if (!v14)
      {
        v15 = 0;
      }
    }

    else
    {
      v15 = 0x4000;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFBFFFLL | v15;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsMultipleSelectionDuringEditing"])
    {
      v16 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsMultipleSelectionDuringEditing"];
      v17 = 0x10000;
      if (!v16)
      {
        v17 = 0;
      }
    }

    else
    {
      v17 = 0;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFEFFFFLL | v17;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsUserInitiatedMultipleSelection"])
    {
      v18 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsUserInitiatedMultipleSelection"];
      v19 = 0x8000;
      if (!v18)
      {
        v19 = 0;
      }
    }

    else
    {
      v19 = 0x8000;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFF7FFFLL | v19;
    v20 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewCellPrototypeNibExternalObjects"];
    v21 = mutableDictionaryByTransformingLeafDictionariesToWeakValued(v20);
    cellNibExternalObjectsTables = v5->_cellNibExternalObjectsTables;
    v5->_cellNibExternalObjectsTables = v21;

    v23 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewSupplementaryViewPrototypeNibExternalObjects"];
    v24 = mutableDictionaryByTransformingLeafDictionariesToWeakValued(v23);
    supplementaryViewNibExternalObjectsTables = v5->_supplementaryViewNibExternalObjectsTables;
    v5->_supplementaryViewNibExternalObjectsTables = v24;

    v26 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewCellNibDict"];
    cellNibDict = v5->_cellNibDict;
    v5->_cellNibDict = v26;

    v28 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewSupplementaryViewNibDict"];
    supplementaryViewNibDict = v5->_supplementaryViewNibDict;
    v5->_supplementaryViewNibDict = v28;

    UICollectionViewCommonSetup(v5);
    if ([(NSCoder *)v4 containsValueForKey:@"UICollectionViewPrefetchingEnabled"])
    {
      *(&v5->_collectionViewFlags + 4) = *(&v5->_collectionViewFlags + 4) & 0xFFFFFFFE | [(NSCoder *)v4 decodeBoolForKey:@"UICollectionViewPrefetchingEnabled"];
    }

    if ([(NSCoder *)v4 containsValueForKey:@"UISpringLoaded"])
    {
      [(UICollectionView *)v5 setSpringLoaded:[(NSCoder *)v4 decodeBoolForKey:@"UISpringLoaded"]];
    }
  }

  return v5;
}

- (void)encodeWithCoder:(id)coder
{
  coderCopy = coder;
  v8.receiver = self;
  v8.super_class = UICollectionView;
  [(UIScrollView *)&v8 encodeWithCoder:coderCopy];
  layout = self->_layout;
  if (layout)
  {
    [coderCopy encodeObject:layout forKey:@"UICollectionLayout"];
  }

  backgroundView = self->_backgroundView;
  if (backgroundView)
  {
    [coderCopy encodeObject:backgroundView forKey:@"UIBackgroundView"];
  }

  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x1000) != 0)
  {
    if ((v7 & 0x2000) == 0)
    {
      goto LABEL_7;
    }
  }

  else
  {
    [coderCopy encodeBool:0 forKey:@"UIAllowsSelection"];
    v7 = *(&self->_collectionViewFlags + 1);
    if ((v7 & 0x2000) == 0)
    {
LABEL_7:
      if ((v7 & 0x4000) == 0)
      {
        goto LABEL_8;
      }

      goto LABEL_24;
    }
  }

  [coderCopy encodeBool:1 forKey:@"UIAllowsMultipleSelection"];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x4000) == 0)
  {
LABEL_8:
    if ((v7 & 0x10000) == 0)
    {
      goto LABEL_9;
    }

    goto LABEL_25;
  }

LABEL_24:
  [coderCopy encodeBool:1 forKey:@"UIAllowsSelectionDuringEditing"];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x10000) == 0)
  {
LABEL_9:
    if ((v7 & 0x8000) == 0)
    {
      goto LABEL_11;
    }

    goto LABEL_10;
  }

LABEL_25:
  [coderCopy encodeBool:1 forKey:@"UIAllowsMultipleSelectionDuringEditing"];
  if ((*(&self->_collectionViewFlags + 1) & 0x8000) != 0)
  {
LABEL_10:
    [coderCopy encodeBool:1 forKey:@"UIAllowsUserInitiatedMultipleSelection"];
  }

LABEL_11:
  if ([(NSMutableDictionary *)self->_cellNibExternalObjectsTables count])
  {
    [coderCopy encodeObject:self->_cellNibExternalObjectsTables forKey:@"UICollectionViewCellPrototypeNibExternalObjects"];
  }

  if ([(NSMutableDictionary *)self->_supplementaryViewNibExternalObjectsTables count])
  {
    [coderCopy encodeObject:self->_supplementaryViewNibExternalObjectsTables forKey:@"UICollectionViewSupplementaryViewPrototypeNibExternalObjects"];
  }

  if ([(NSMutableDictionary *)self->_cellNibDict count])
  {
    [coderCopy encodeObject:self->_cellNibDict forKey:@"UICollectionViewCellNibDict"];
  }

  if ([(NSMutableDictionary *)self->_supplementaryViewNibDict count])
  {
    [coderCopy encodeObject:self->_supplementaryViewNibDict forKey:@"UICollectionViewSupplementaryViewNibDict"];
  }

  [coderCopy encodeBool:-[UICollectionView isPrefetchingEnabled](self forKey:{"isPrefetchingEnabled"), @"UICollectionViewPrefetchingEnabled"}];
  if ([(UICollectionView *)self isSpringLoaded])
  {
    [coderCopy encodeBool:1 forKey:@"UISpringLoaded"];
  }
}

- (NSString)description
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 | 2;
  v14.receiver = self;
  v14.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v14 description];
  v6 = [v5 mutableCopy];

  [v6 deleteCharactersInRange:{objc_msgSend(v6, "length") - 1, 1}];
  layout = self->_layout;
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v9 = WeakRetained;
  if ((v4 & 2) != 0)
  {
    v10 = objc_opt_class();
    v11 = NSStringFromClass(v10);
    v12 = objc_loadWeakRetained(&self->_dataSource);
    [v6 appendFormat:@"; layout: %@; dataSource: <%@: %p>>", layout, v11, v12];
  }

  else
  {
    [v6 appendFormat:@"; layout: %@; dataSource: %@>", layout, WeakRetained];
  }

  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFFFFFD | v4 & 2;

  return v6;
}

- (void)_layoutDirectionTraitDidChange
{
  v6 = self->_layout;
  selfCopy = self;
  if (selfCopy && v6)
  {
    effectiveUserInterfaceLayoutDirection = [(UIView *)selfCopy effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v6 developmentLayoutDirection])
    {
      if (![(UIView *)selfCopy _flipsHorizontalAxis])
      {
        goto LABEL_8;
      }

      _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
    }

    else
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v6 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIScrollView *)selfCopy _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
  }

LABEL_8:
}

- (void)_traitsConsumedByLayoutInvalidated
{
  if (dyld_program_sdk_at_least() && ((_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges, @"CollectionViewAutomaticallyInvalidatesForTraitChanges", _UIInternalPreferenceUpdateBool) & 1) != 0 || byte_1EA95E234))
  {
    v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    [v3 _setIntent:14];
    [(UICollectionViewLayout *)self->_layout invalidateLayoutWithContext:v3];
  }
}

- (void)setEditing:(BOOL)editing
{
  v3 = editing;
  if ([(UICollectionView *)self _isEditing]!= editing)
  {
    v5 = 0x1000000000000;
    if (!v3)
    {
      v5 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFEFFFFFFFFFFFFLL | v5;
    if (!dyld_program_sdk_at_least() || !v3 || (~*(&self->_collectionViewFlags + 2) & 0x12000) != 0 || (-[UICollectionView _indexPathsForSelectedItems](self, "_indexPathsForSelectedItems"), v6 = objc_claimAutoreleasedReturnValue(), v7 = [v6 count], v6, v7 <= 1))
    {
      [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
    }

    if (!v3)
    {
      [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
    }

    v8 = dyld_program_sdk_at_least() == 0;
    v10[0] = MEMORY[0x1E69E9820];
    v10[1] = 3221225472;
    v10[2] = __31__UICollectionView_setEditing___block_invoke;
    v10[3] = &unk_1E70F35E0;
    if (v8)
    {
      v9 = 4;
    }

    else
    {
      v9 = 6;
    }

    v10[4] = self;
    v11 = v3;
    [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v9 options:v10 animations:0 completion:?];
  }
}

void __31__UICollectionView_setEditing___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) collectionViewLayout];
  v3 = [v2 canBeEdited];

  if (v3)
  {
    v4 = [*(a1 + 32) collectionViewLayout];
    [v4 setEditing:*(a1 + 40)];
  }

  v5 = *(a1 + 32);
  v6 = *(v5 + 2984);
  v12 = MEMORY[0x1E69E9820];
  v13 = 3221225472;
  v14 = __31__UICollectionView_setEditing___block_invoke_2;
  v15 = &unk_1E70FEBD8;
  v16 = v5;
  LOBYTE(v17) = *(a1 + 40);
  if (v6)
  {
    [(_UICollectionViewSubviewCollection *)*(v6 + 8) enumerateAllViewsWithEnumerator:?];
    v5 = *(a1 + 32);
  }

  v7 = [*(v5 + 2152) _invalidationContextForRefreshingVisibleElementAttributes];
  v8 = [*(a1 + 32) collectionViewLayout];
  [v8 invalidateLayoutWithContext:v7];

  v9 = [*(a1 + 32) window];
  if (v9)
  {
    v10 = v9;
    v11 = +[UIView areAnimationsEnabled];

    if (v11)
    {
      [*(a1 + 32) layoutIfNeeded];
    }
  }
}

uint64_t __31__UICollectionView_setEditing___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (a2)
  {
    a3 = 0;
  }

  return [*(a1 + 32) _updateEditing:*(a1 + 40) forView:a5 atIndexPath:a3 elementCategory:a2];
}

- (BOOL)_canEditItemAtIndexPath:(id)path
{
  pathCopy = path;
  if (!pathCopy)
  {
    v5 = 0;
    goto LABEL_9;
  }

  if ((*(&self->_collectionViewFlags + 3) & 0x40) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v7 = [_delegateProxy collectionView:self canEditItemAtIndexPath:pathCopy];
LABEL_8:
    v5 = v7;

    goto LABEL_9;
  }

  if ((*(&self->_collectionViewFlags + 8) & 0x20) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _dataSourceProxy];
    v7 = [_delegateProxy _collectionView:self canEditItemAtIndexPath:pathCopy];
    goto LABEL_8;
  }

  v5 = 1;
LABEL_9:

  return v5;
}

- (void)_updateEditing:(BOOL)editing forView:(id)view atIndexPath:(id)path elementCategory:(unint64_t)category
{
  editingCopy = editing;
  viewCopy = view;
  pathCopy = path;
  if ([viewCopy canBeEdited])
  {
    v10 = editingCopy && (!pathCopy || [(UICollectionView *)self _canEditItemAtIndexPath:pathCopy]);
    [viewCopy setEditing:v10];
  }
}

- (id)_objectInDictionary:(id)dictionary forKind:(id)kind indexPath:(id)path
{
  v6 = [dictionary objectForKeyedSubscript:kind];
  v7 = [v6 objectForKeyedSubscript:path];

  return v7;
}

- (void)_setObject:(id)object inDictionary:(id)dictionary forKind:(id)kind indexPath:(id)path
{
  objectCopy = object;
  dictionaryCopy = dictionary;
  kindCopy = kind;
  v11 = [dictionaryCopy objectForKeyedSubscript:kindCopy];
  if (v11)
  {
    dictionary = v11;
    v13 = objectCopy;
    if (!objectCopy)
    {
      goto LABEL_7;
    }

LABEL_6:
    [dictionary setObject:v13 forKeyedSubscript:path];
    goto LABEL_8;
  }

  dictionary = [MEMORY[0x1E695DF90] dictionary];
  if (objectCopy)
  {
    [dictionaryCopy setObject:dictionary forKeyedSubscript:kindCopy];
    v13 = objectCopy;
    goto LABEL_6;
  }

LABEL_7:
  [dictionary removeObjectForKey:path];
LABEL_8:
}

- (void)_addEntriesFromDictionary:(id)dictionary inDictionary:(id)inDictionary andSet:(id)set
{
  inDictionaryCopy = inDictionary;
  setCopy = set;
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke;
  v12[3] = &unk_1E70FEC28;
  v12[4] = self;
  v13 = inDictionaryCopy;
  v14 = setCopy;
  v10 = setCopy;
  v11 = inDictionaryCopy;
  [dictionary enumerateKeysAndObjectsUsingBlock:v12];
}

void __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke_2;
  v7[3] = &unk_1E70FEC00;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  [a3 enumerateKeysAndObjectsUsingBlock:v7];
}

uint64_t __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3)
{
  [*(a1 + 32) _setObject:a3 inDictionary:*(a1 + 40) forKind:*(a1 + 56) indexPath:a2];
  v5 = *(a1 + 48);

  return [v5 addObject:a3];
}

- (id)_keysForObject:(id)object inDictionary:(id)dictionary
{
  objectCopy = object;
  dictionaryCopy = dictionary;
  v13 = 0;
  v14 = &v13;
  v15 = 0x3032000000;
  v16 = __Block_byref_object_copy__39;
  v17 = __Block_byref_object_dispose__39;
  v18 = 0;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __48__UICollectionView__keysForObject_inDictionary___block_invoke;
  v10[3] = &unk_1E70FEC78;
  v7 = objectCopy;
  v11 = v7;
  v12 = &v13;
  [dictionaryCopy enumerateKeysAndObjectsUsingBlock:v10];
  v8 = v14[5];

  _Block_object_dispose(&v13, 8);

  return v8;
}

void __48__UICollectionView__keysForObject_inDictionary___block_invoke(uint64_t a1, uint64_t a2, void *a3, uint64_t a4)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __48__UICollectionView__keysForObject_inDictionary___block_invoke_2;
  v10[3] = &unk_1E70FEC50;
  v8 = *(a1 + 32);
  v9 = *(a1 + 40);
  v11 = v8;
  v12 = v9;
  v13 = a2;
  v14 = a4;
  [a3 enumerateKeysAndObjectsUsingBlock:v10];
}

void __48__UICollectionView__keysForObject_inDictionary___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (*(a1 + 32) == a3)
  {
    v6 = [objc_alloc(MEMORY[0x1E695DEC8]) initWithObjects:{*(a1 + 48), a2, 0}];
    v7 = *(*(a1 + 40) + 8);
    v8 = *(v7 + 40);
    *(v7 + 40) = v6;

    **(a1 + 56) = 1;
    *a4 = 1;
  }
}

- (id)_visibleSupplementaryViewOfKind:(id)kind atIndexPath:(id)path isDecorationView:(BOOL)view
{
  if (view)
  {
    [(UICollectionView *)self _visibleDecorationViewOfKind:kind atIndexPath:path];
  }

  else
  {
    [(UICollectionView *)self _visibleSupplementaryViewOfKind:kind atIndexPath:path];
  }
  v5 = ;

  return v5;
}

- (void)setDelegate:(id)delegate
{
  v4 = delegate;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    allowsWeakReference = [v4 allowsWeakReference];
    v6 = v4;
    if ((allowsWeakReference & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __32__UICollectionView_setDelegate___block_invoke;
      block[3] = &unk_1E70F35B8;
      v125 = v4;
      selfCopy = self;
      if (setDelegate__once != -1)
      {
        dispatch_once(&setDelegate__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  delegate = [(UIScrollView *)self delegate];
  if (v8 == delegate)
  {
    if (v8)
    {
      delegate2 = v8;
      goto LABEL_130;
    }

    if ((*(&self->_collectionViewFlags + 3) & 0x80) == 0)
    {
      delegate2 = 0;
      goto LABEL_130;
    }
  }

  v123.receiver = self;
  v123.super_class = UICollectionView;
  [(UIScrollView *)&v123 setDelegate:v8];
  delegate2 = [(UIScrollView *)self delegate];

  p_collectionViewFlags = &self->_collectionViewFlags;
  *&self->_collectionViewFlags = *&self->_collectionViewFlags & 0xFFFFFFFF7FFFFFFFLL | ((delegate2 != 0) << 31);
  *&self->_collectionViewFlags = *&self->_collectionViewFlags & 0xFFFFFFFFFFFFFFFELL | objc_opt_respondsToSelector() & 1;
  v12 = objc_opt_respondsToSelector();
  v13 = 2;
  if ((v12 & 1) == 0)
  {
    v13 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFFDLL | v13;
  v14 = objc_opt_respondsToSelector();
  v15 = 4;
  if ((v14 & 1) == 0)
  {
    v15 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFFBLL | v15;
  v16 = objc_opt_respondsToSelector();
  v17 = 8;
  if ((v16 & 1) == 0)
  {
    v17 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFF7 | v17;
  v18 = objc_opt_respondsToSelector();
  v19 = 16;
  if ((v18 & 1) == 0)
  {
    v19 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFEFLL | v19;
  v20 = objc_opt_respondsToSelector();
  v21 = 32;
  if ((v20 & 1) == 0)
  {
    v21 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFDFLL | v21;
  v22 = objc_opt_respondsToSelector();
  v23 = 64;
  if ((v22 & 1) == 0)
  {
    v23 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFBFLL | v23;
  v24 = objc_opt_respondsToSelector();
  v25 = 256;
  if ((v24 & 1) == 0)
  {
    v25 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFEFFLL | v25;
  v26 = objc_opt_respondsToSelector();
  v27 = 512;
  if ((v26 & 1) == 0)
  {
    v27 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFDFFLL | v27;
  v28 = objc_opt_respondsToSelector();
  v29 = 1024;
  if ((v28 & 1) == 0)
  {
    v29 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFBFFLL | v29;
  v30 = objc_opt_respondsToSelector();
  v31 = 2048;
  if ((v30 & 1) == 0)
  {
    v31 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFF7FFLL | v31;
  if (objc_opt_respondsToSelector() & 1) != 0 && (objc_opt_respondsToSelector())
  {
    v32 = objc_opt_respondsToSelector();
    v33 = 128;
    if ((v32 & 1) == 0)
    {
      v33 = 0;
    }
  }

  else
  {
    v33 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFF7FLL | v33;
  v34 = objc_opt_respondsToSelector();
  v35 = 4096;
  if ((v34 & 1) == 0)
  {
    v35 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFEFFFLL | v35;
  v36 = objc_opt_respondsToSelector();
  v37 = 0x2000;
  if ((v36 & 1) == 0)
  {
    v37 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFDFFFLL | v37;
  v38 = objc_opt_respondsToSelector();
  v39 = 0x4000;
  if ((v38 & 1) == 0)
  {
    v39 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFBFFFLL | v39;
  v40 = objc_opt_respondsToSelector();
  v41 = 0x8000;
  if ((v40 & 1) == 0)
  {
    v41 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFF7FFFLL | v41;
  v42 = objc_opt_respondsToSelector();
  v43 = 0x40000000;
  if ((v42 & 1) == 0)
  {
    v43 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFBFFFFFFFLL | v43;
  v44 = objc_opt_respondsToSelector();
  v45 = 0x10000;
  if ((v44 & 1) == 0)
  {
    v45 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFEFFFFLL | v45;
  v46 = objc_opt_respondsToSelector();
  v47 = 0x20000;
  if ((v46 & 1) == 0)
  {
    v47 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFDFFFFLL | v47;
  v48 = objc_opt_respondsToSelector();
  v49 = 0x40000;
  if ((v48 & 1) == 0)
  {
    v49 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFBFFFFLL | v49;
  v50 = objc_opt_respondsToSelector();
  v51 = 0x80000;
  if ((v50 & 1) == 0)
  {
    v51 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFF7FFFFLL | v51;
  v52 = objc_opt_respondsToSelector();
  v53 = 0x100000;
  if ((v52 & 1) == 0)
  {
    v53 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFEFFFFFLL | v53;
  v54 = objc_opt_respondsToSelector();
  v55 = 0x200000;
  if ((v54 & 1) == 0)
  {
    v55 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFDFFFFFLL | v55;
  v56 = objc_opt_respondsToSelector();
  v57 = 0x400000;
  if ((v56 & 1) == 0)
  {
    v57 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFBFFFFFLL | v57;
  v58 = objc_opt_respondsToSelector();
  v59 = 0x800000;
  if ((v58 & 1) == 0)
  {
    v59 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFF7FFFFFLL | v59;
  v60 = objc_opt_respondsToSelector();
  v61 = 0x1000000;
  if ((v60 & 1) == 0)
  {
    v61 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFEFFFFFFLL | v61;
  v62 = objc_opt_respondsToSelector();
  v63 = 0x2000000;
  if ((v62 & 1) == 0)
  {
    v63 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFDFFFFFFLL | v63;
  v64 = objc_opt_respondsToSelector();
  v65 = 0x4000000;
  if ((v64 & 1) == 0)
  {
    v65 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFBFFFFFFLL | v65;
  v66 = objc_opt_respondsToSelector();
  v67 = 0x8000000;
  if ((v66 & 1) == 0)
  {
    v67 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFF7FFFFFFLL | v67;
  v68 = objc_opt_respondsToSelector();
  v69 = 0x10000000;
  if ((v68 & 1) == 0)
  {
    v69 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFEFFFFFFFLL | v69;
  v70 = objc_opt_respondsToSelector();
  v71 = 0x20000000;
  if ((v70 & 1) == 0)
  {
    v71 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFDFFFFFFFLL | v71;
  v72 = objc_opt_respondsToSelector();
  v73 = 0x8000000000000;
  if ((v72 & 1) == 0)
  {
    v73 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFF7FFFFFFFFFFFFLL | v73;
  v74 = objc_opt_respondsToSelector();
  v75 = 0x10000000000000;
  if ((v74 & 1) == 0)
  {
    v75 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFEFFFFFFFFFFFFFLL | v75;
  v76 = objc_opt_respondsToSelector();
  v77 = 0x100000000;
  if ((v76 & 1) == 0)
  {
    v77 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFEFFFFFFFFLL | v77;
  v78 = objc_opt_respondsToSelector();
  v79 = 0x200000000;
  if ((v78 & 1) == 0)
  {
    v79 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFDFFFFFFFFLL | v79;
  v80 = objc_opt_respondsToSelector();
  v81 = 0x400000000;
  if ((v80 & 1) == 0)
  {
    v81 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFBFFFFFFFFLL | v81;
  v82 = objc_opt_respondsToSelector();
  v83 = 0x4000000000;
  if ((v82 & 1) == 0)
  {
    v83 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFBFFFFFFFFFLL | v83;
  v84 = objc_opt_respondsToSelector();
  v85 = 0x8000000000;
  if ((v84 & 1) == 0)
  {
    v85 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFF7FFFFFFFFFLL | v85;
  v86 = objc_opt_respondsToSelector();
  v87 = 0x10000000000;
  if ((v86 & 1) == 0)
  {
    v87 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFEFFFFFFFFFFLL | v87;
  v88 = objc_opt_respondsToSelector();
  v89 = 0x20000000000;
  if ((v88 & 1) == 0)
  {
    v89 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFDFFFFFFFFFFLL | v89;
  v90 = objc_opt_respondsToSelector();
  v91 = *p_collectionViewFlags;
  v92 = 0x40000000000;
  if ((v90 & 1) == 0)
  {
    v92 = 0;
  }

  v93 = v91 & 0xFFFFFBFFFFFFFFFFLL | v92;
  *p_collectionViewFlags = v93;
  if ((v91 & 0x700000000) != 0)
  {
    v94 = v93 & 0xFFFF87C7FFFFFFFFLL;
  }

  else
  {
    v95 = objc_opt_respondsToSelector();
    v96 = 0x800000000;
    if ((v95 & 1) == 0)
    {
      v96 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFF7FFFFFFFFLL | v96;
    v97 = objc_opt_respondsToSelector();
    v98 = 0x1000000000;
    if ((v97 & 1) == 0)
    {
      v98 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFEFFFFFFFFFLL | v98;
    v99 = objc_opt_respondsToSelector();
    v100 = 0x2000000000;
    if ((v99 & 1) == 0)
    {
      v100 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFDFFFFFFFFFLL | v100;
    if (!_os_feature_enabled_impl() || !_UIIsPrivateMainBundle())
    {
      goto LABEL_115;
    }

    v101 = objc_opt_respondsToSelector();
    v102 = 0x80000000000;
    if ((v101 & 1) == 0)
    {
      v102 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFF7FFFFFFFFFFLL | v102;
    v103 = objc_opt_respondsToSelector();
    v104 = 0x100000000000;
    if ((v103 & 1) == 0)
    {
      v104 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFEFFFFFFFFFFFLL | v104;
    v105 = objc_opt_respondsToSelector();
    v106 = 0x200000000000;
    if ((v105 & 1) == 0)
    {
      v106 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFDFFFFFFFFFFFLL | v106;
    v107 = objc_opt_respondsToSelector();
    v108 = 0x400000000000;
    if ((v107 & 1) == 0)
    {
      v108 = 0;
    }

    v94 = *p_collectionViewFlags & 0xFFFFBFFFFFFFFFFFLL | v108;
  }

  *p_collectionViewFlags = v94;
LABEL_115:
  v109 = objc_opt_respondsToSelector();
  v110 = 0x40000000000000;
  if ((v109 & 1) == 0)
  {
    v110 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFBFFFFFFFFFFFFFLL | v110;
  v111 = objc_opt_respondsToSelector();
  v112 = 0x80000000000000;
  if ((v111 & 1) == 0)
  {
    v112 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFF7FFFFFFFFFFFFFLL | v112;
  v113 = objc_opt_respondsToSelector();
  v114 = 0x800000000000;
  if ((v113 & 1) == 0)
  {
    v114 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFF7FFFFFFFFFFFLL | v114;
  v115 = objc_opt_respondsToSelector();
  v116 = 0x1000000000000;
  if ((v115 & 1) == 0)
  {
    v116 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFEFFFFFFFFFFFFLL | v116;
  v117 = objc_opt_respondsToSelector();
  v118 = 0x4000000000000;
  if ((v117 & 1) == 0)
  {
    v118 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFBFFFFFFFFFFFFLL | v118;
  v119 = objc_opt_respondsToSelector();
  v120 = 0x2000000000000;
  if ((v119 & 1) == 0)
  {
    v120 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFDFFFFFFFFFFFFLL | v120;
  v121 = objc_opt_respondsToSelector();
  v122 = 0x20000000000000;
  if ((v121 & 1) == 0)
  {
    v122 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFDFFFFFFFFFFFFFLL | v122;
  [(UICollectionView *)self _configureContextMenuInteractionIfNeeded];
  [(UICollectionView *)self _configureSceneActivationInteractionIfNeeded];
  [(UICollectionView *)self _configureTypeSelectInteractionIfNeeded];
LABEL_130:
}

void __32__UICollectionView_setDelegate___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as a delegate. This will be a hard crash in the future. Offending object: %@ hostObject: %@", &v5, 0x16u);
  }
}

- (void)setDataSource:(id)dataSource
{
  v4 = dataSource;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    allowsWeakReference = [v4 allowsWeakReference];
    v6 = v4;
    if ((allowsWeakReference & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __34__UICollectionView_setDataSource___block_invoke;
      block[3] = &unk_1E70F35B8;
      v66 = v4;
      selfCopy = self;
      if (setDataSource__once != -1)
      {
        dispatch_once(&setDataSource__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v10 = WeakRetained;
  if (WeakRetained != v8 || !v8 && (*(&self->_collectionViewFlags + 8) & 8) != 0)
  {
    if (WeakRetained)
    {
      objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
    }

    objc_storeWeak(&self->_dataSource, v8);
    v11 = v8;
    dataSource = [(UICollectionView *)self dataSource];
    v13 = dataSource;
    if (v11 == dataSource)
    {
      allowsWeakReference2 = [(UICollectionView *)self allowsWeakReference];

      v14 = v11 == 0;
      v15 = 8 * (v11 != 0);
      if (v11 && allowsWeakReference2)
      {
        objc_initWeak(&location, self);
        v17 = [_UIWeakHelper alloc];
        v59 = MEMORY[0x1E69E9820];
        v60 = 3221225472;
        v61 = __34__UICollectionView_setDataSource___block_invoke_243;
        v62 = &unk_1E70F5A28;
        objc_copyWeak(&v63, &location);
        v18 = [(_UIWeakHelper *)v17 initWithDeallocationBlock:&v59];
        objc_setAssociatedObject(v11, &self->super.super.super.super.isa + 2, v18, 1);

        objc_destroyWeak(&v63);
        objc_destroyWeak(&location);
        v14 = 0;
        v15 = 8;
      }
    }

    else
    {

      v14 = v11 == 0;
      v15 = 8 * (v11 != 0);
    }

    p_collectionViewFlags = &self->_collectionViewFlags;
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFF7 | v15;
    v20 = objc_opt_respondsToSelector();
    v21 = 0x100000000000000;
    if ((v20 & 1) == 0)
    {
      v21 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFEFFFFFFFFFFFFFFLL | v21;
    v22 = objc_opt_respondsToSelector();
    v23 = 0x200000000000000;
    if ((v22 & 1) == 0)
    {
      v23 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFDFFFFFFFFFFFFFFLL | v23;
    v24 = objc_opt_respondsToSelector();
    v25 = 0x400000000000000;
    if ((v24 & 1) == 0)
    {
      v25 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFBFFFFFFFFFFFFFFLL | v25;
    v26 = objc_opt_respondsToSelector();
    v27 = 0x800000000000000;
    if ((v26 & 1) == 0)
    {
      v27 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xF7FFFFFFFFFFFFFFLL | v27;
    v28 = objc_opt_respondsToSelector();
    v29 = 0x8000000000000000;
    if ((v28 & 1) == 0)
    {
      v29 = 0;
    }

    *p_collectionViewFlags = v29 & 0x8000000000000000 | *p_collectionViewFlags & 0x7FFFFFFFFFFFFFFFLL;
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFELL | objc_opt_respondsToSelector() & 1;
    v30 = objc_opt_respondsToSelector();
    v31 = 0x1000000000000000;
    if ((v30 & 1) == 0)
    {
      v31 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xEFFFFFFFFFFFFFFFLL | v31;
    v32 = objc_opt_respondsToSelector();
    v33 = 0x2000000000000000;
    if ((v32 & 1) == 0)
    {
      v33 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xDFFFFFFFFFFFFFFFLL | v33;
    v34 = objc_opt_respondsToSelector();
    v35 = 0x4000000000000000;
    if ((v34 & 1) == 0)
    {
      v35 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xBFFFFFFFFFFFFFFFLL | v35;
    if (dyld_program_sdk_at_least())
    {
      v36 = objc_opt_respondsToSelector();
      v37 = 2;
      if ((v36 & 1) == 0)
      {
        v37 = 0;
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFDLL | v37;
      v38 = objc_opt_respondsToSelector();
      v39 = 4;
      if ((v38 & 1) == 0)
      {
        v39 = 0;
      }

      v40 = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFBLL | v39;
    }

    else
    {
      v40 = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFF9;
    }

    *(&self->_collectionViewFlags + 1) = v40;
    v41 = objc_opt_respondsToSelector();
    v42 = 16;
    if ((v41 & 1) == 0)
    {
      v42 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFEFLL | v42;
    v43 = objc_opt_respondsToSelector();
    v44 = 32;
    if ((v43 & 1) == 0)
    {
      v44 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFDFLL | v44;
    v45 = dyld_program_sdk_at_least();
    v46 = *(&self->_collectionViewFlags + 1);
    if (v45 && (v46 & 0x10) != 0)
    {
      if (objc_opt_respondsToSelector())
      {
        v47 = v11;
        *(&self->_collectionViewFlags + 1) = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_moveItemAtIndexPath_toIndexPath_] & *(&self->_collectionViewFlags + 1) | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFELL;
        v48 = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_canMoveItemAtIndexPath_];
        v49 = *p_collectionViewFlags & 0x8000000000000000;
        if (!v48)
        {
          v49 = 0;
        }

        *p_collectionViewFlags = v49 & 0x8000000000000000 | *p_collectionViewFlags & 0x7FFFFFFFFFFFFFFFLL;
        v50 = [v47 _subclassOverridesMethodWithSelector:{sel_indexTitlesForCollectionView_, v59, v60, v61, v62}];
        v51 = *(&self->_collectionViewFlags + 1) & 2;
        if (!v50)
        {
          v51 = 0;
        }

        *(&self->_collectionViewFlags + 1) = v51 | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFDLL;
        v52 = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_indexPathForIndexTitle_atIndex_];

        v53 = *(&self->_collectionViewFlags + 1) & 4;
        if (!v52)
        {
          v53 = 0;
        }

        v46 = v53 | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFBLL;
        *(&self->_collectionViewFlags + 1) = v46;
      }

      else
      {
        v46 = *(&self->_collectionViewFlags + 1);
      }
    }

    *(&self->_collectionViewFlags + 1) = v46 | 0x40000000;
    [(_UICollectionViewDragAndDropController *)self->_dragAndDropController didUpdateDataSource];
    if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 17) & 0x10) != 0)
    {
      *(&self->_collectionViewFlags + 1) &= ~0x400000000uLL;
    }

    if (!v14 || (dyld_program_sdk_at_least() & 1) == 0)
    {
      if ([(UICollectionViewLayout *)self->_layout _shouldInvalidateLayoutForDataSourceChange:v59])
      {
        [(UICollectionView *)self _invalidateLayoutForReload];
      }

      else
      {
        [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
      }
    }

    if (dyld_program_sdk_at_least())
    {
      [(_UICollectionViewSelectionController *)self->_selectionController reset];
      [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
    }

    [(_UICollectionViewTypeSelectController *)self->_typeSelectController reloadData];
    if ([(UICollectionView *)self _wantsIndexOverlays])
    {
      window = [(UIView *)self window];
      if (window)
      {
        v55 = window;
        _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];

        if (!_indexOverlayManager)
        {
          [(UICollectionView *)self _setupIndexOverlayManagerIfNecessary];
          _indexOverlayManager2 = [(UICollectionView *)self _indexOverlayManager];
          window2 = [(UIView *)self window];
          [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager2 hostDidMoveToWindow:window2];
        }
      }
    }
  }
}

void __34__UICollectionView_setDataSource___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_2___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as dataSource. This will be a hard crash in the future. Offending object: %@ hosting object: %@", &v5, 0x16u);
  }
}

void __34__UICollectionView_setDataSource___block_invoke_243(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    v3 = WeakRetained;
    v2 = [WeakRetained dataSource];
    if (!v2)
    {
      [v3 setDataSource:0];
    }

    WeakRetained = v3;
  }
}

- (void)setPrefetchDataSource:(id)prefetchDataSource
{
  v4 = prefetchDataSource;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    allowsWeakReference = [v4 allowsWeakReference];
    v6 = v4;
    if ((allowsWeakReference & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __42__UICollectionView_setPrefetchDataSource___block_invoke;
      block[3] = &unk_1E70F35B8;
      v27 = v4;
      selfCopy = self;
      if (setPrefetchDataSource__once != -1)
      {
        dispatch_once(&setPrefetchDataSource__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);
  v10 = WeakRetained;
  if (WeakRetained != v8 || !v8 && (*(&self->_collectionViewFlags + 9) & 1) != 0)
  {
    if (WeakRetained)
    {
      objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
    }

    objc_storeWeak(&self->_prefetchDataSource, v8);
    v11 = v8;
    prefetchDataSource = [(UICollectionView *)self prefetchDataSource];
    v13 = prefetchDataSource;
    if (v11 == prefetchDataSource)
    {
      allowsWeakReference2 = [(UICollectionView *)self allowsWeakReference];

      v14 = (v11 != 0) << 8;
      if (v11 && allowsWeakReference2)
      {
        objc_initWeak(&location, self);
        v16 = [_UIWeakHelper alloc];
        v23[0] = MEMORY[0x1E69E9820];
        v23[1] = 3221225472;
        v23[2] = __42__UICollectionView_setPrefetchDataSource___block_invoke_272;
        v23[3] = &unk_1E70F5A28;
        objc_copyWeak(&v24, &location);
        v17 = [(_UIWeakHelper *)v16 initWithDeallocationBlock:v23];
        objc_setAssociatedObject(v11, &self->super.super.super.super.isa + 2, v17, 1);

        objc_destroyWeak(&v24);
        objc_destroyWeak(&location);
        v14 = 256;
      }
    }

    else
    {

      v14 = (v11 != 0) << 8;
    }

    p_collectionViewFlags = &self->_collectionViewFlags;
    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFEFFLL | v14;
    v19 = objc_opt_respondsToSelector();
    v20 = 64;
    if ((v19 & 1) == 0)
    {
      v20 = 0;
    }

    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFBFLL | v20;
    v21 = objc_opt_respondsToSelector();
    v22 = 128;
    if ((v21 & 1) == 0)
    {
      v22 = 0;
    }

    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFF7FLL | v22;
  }
}

void __42__UICollectionView_setPrefetchDataSource___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_3___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as prefetchDataSource. This will be a hard crash in the future. Offending object: %@ hosting object: %@", &v5, 0x16u);
  }
}

void __42__UICollectionView_setPrefetchDataSource___block_invoke_272(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    v3 = WeakRetained;
    v2 = [WeakRetained prefetchDataSource];
    if (!v2)
    {
      [v3 setPrefetchDataSource:0];
    }

    WeakRetained = v3;
  }
}

- (int64_t)_dataSourceNumberOfSections
{
  _dataSourceActual = [(UICollectionView *)self _dataSourceActual];
  v4 = objc_opt_respondsToSelector();

  if ((v4 & 1) == 0)
  {
    return 1;
  }

  _dataSourceActual2 = [(UICollectionView *)self _dataSourceActual];
  v6 = [_dataSourceActual2 numberOfSectionsInCollectionView:self];

  return v6 & ~(v6 >> 63);
}

- (int64_t)_dataSourceNumberOfItemsInSection:(int64_t)section
{
  _dataSourceActual = [(UICollectionView *)self _dataSourceActual];
  v6 = [_dataSourceActual collectionView:self numberOfItemsInSection:section];

  return v6;
}

- (void)_incrementUpdateAnimationCountWithContext:(id)context
{
  contextCopy = context;
  if (contextCopy)
  {
    ++contextCopy[2];
  }

  ++self->_updateAnimationCount;
}

- (void)_decrementUpdateAnimationCountWithContext:(id)context
{
  contextCopy = context;
  if (contextCopy)
  {
    --contextCopy[2];
  }

  updateAnimationCount = self->_updateAnimationCount;
  v6 = updateAnimationCount < 1;
  v7 = updateAnimationCount - 1;
  if (!v6)
  {
    self->_updateAnimationCount = v7;
  }
}

- (BOOL)_isIndexPathSelectedItem:(id)item
{
  itemCopy = item;
  [(UICollectionView *)self _reloadDataIfNeeded];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v6 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v6 = 0;
  }

  v7 = [v6 containsObject:itemCopy];

  return v7;
}

- (void)_enumerateVisibleViews:(id)views
{
  viewsCopy = views;
  if (!viewsCopy)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:1507 description:{@"Invalid parameter not satisfying: %@", @"block != NULL"}];
  }

  subviewManager = self->_subviewManager;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView__enumerateVisibleViews___block_invoke;
  v10[3] = &unk_1E70FECA0;
  v11 = viewsCopy;
  v7 = viewsCopy;
  v8 = v7;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v10];
    v8 = v11;
  }
}

- (void)_deselectAllAnimated:(BOOL)animated notifyDelegate:(BOOL)delegate
{
  delegateCopy = delegate;
  animatedCopy = animated;
  v27 = *MEMORY[0x1E69E9840];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v8 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v8 = 0;
  }

  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v9 = [v8 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v23;
    do
    {
      v12 = 0;
      do
      {
        if (*v23 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v22 + 1) + 8 * v12);
        v14 = self->_selectionController;
        if (v14)
        {
          [(NSMutableSet *)v14->_selectedIndexPaths removeObject:*(*(&v22 + 1) + 8 * v12)];
        }

        v15 = [(UICollectionView *)self _cellForItemAtIndexPath:v13];
        [v15 _setSelected:0 animated:animatedCopy];

        if (delegateCopy && (*&self->_collectionViewFlags & 0x40) != 0)
        {
          _delegateProxy = [(UICollectionView *)self _delegateProxy];
          [_delegateProxy collectionView:self didDeselectItemAtIndexPath:v13];
        }

        ++v12;
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v10);
  }

  if (delegateCopy)
  {
    multiSelectController = self->_multiSelectController;
    v18 = self->_selectionController;
    if (v18)
    {
      v19 = [(NSMutableSet *)v18->_selectedIndexPaths copy];
    }

    else
    {
      v19 = 0;
    }

    allObjects = [v19 allObjects];
    [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:allObjects];
  }

  if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:0 initiatedBySelection:1])
  {
    _focusSystem = [(UIView *)self _focusSystem];
    if ([_focusSystem _focusedItemIsContainedInEnvironment:self includeSelf:1])
    {
      [_focusSystem _startDeferringFocusIfSupported];
    }
  }
}

- (BOOL)_delegateAllowsHighlightingItemAtIndexPath:(id)path
{
  if ((*&self->_collectionViewFlags & 1) == 0)
  {
    return 1;
  }

  selfCopy = self;
  pathCopy = path;
  _delegateProxy = [(UICollectionView *)selfCopy _delegateProxy];
  LOBYTE(selfCopy) = [_delegateProxy collectionView:selfCopy shouldHighlightItemAtIndexPath:pathCopy];

  return selfCopy;
}

- (BOOL)_delegateAllowsSelectingItemAtIndexPath:(id)path
{
  if ((*&self->_collectionViewFlags & 8) == 0)
  {
    return 1;
  }

  selfCopy = self;
  pathCopy = path;
  _delegateProxy = [(UICollectionView *)selfCopy _delegateProxy];
  LOBYTE(selfCopy) = [_delegateProxy collectionView:selfCopy shouldSelectItemAtIndexPath:pathCopy];

  return selfCopy;
}

- (BOOL)_inferFocusabilityForCell:(id)cell atIndexPath:(id)path
{
  cellCopy = cell;
  pathCopy = path;
  if ([(UICollectionView *)self _isIndexPathSelectedItem:pathCopy])
  {
    v8 = 1;
  }

  else
  {
    _existingContentView = [cellCopy _existingContentView];
    v8 = (!_existingContentView || !dyld_program_sdk_at_least() || (_UIViewContainsFocusableSubviews(_existingContentView) & 1) == 0) && (dyld_program_sdk_at_least() && ([cellCopy _hasCustomSelectionAction] & 1) != 0 || -[UICollectionView _allowsEffectiveSelection](self, "_allowsEffectiveSelection") && (!dyld_program_sdk_at_least() || -[UICollectionView _delegateAllowsHighlightingItemAtIndexPath:](self, "_delegateAllowsHighlightingItemAtIndexPath:", pathCopy)));
  }

  return v8;
}

- (void)_selectItemAtIndexPath:(id)path animated:(BOOL)animated scrollPosition:(unint64_t)position notifyDelegate:(BOOL)delegate deselectPrevious:(BOOL)previous performPrimaryAction:(BOOL)action performCustomSelectionAction:(BOOL)selectionAction isUserInitiated:(BOOL)self0
{
  actionCopy = action;
  delegateCopy = delegate;
  animatedCopy = animated;
  v17 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:path isSelection:1 allowMassIndexPath:1 assertIfInvalid:1];
  v18 = [(UICollectionView *)self _cellForItemAtIndexPath:path];
  v50 = v18;
  if (selectionAction)
  {
    [v18 _performCustomSelectionAction];
    goto LABEL_54;
  }

  v49 = actionCopy;
  _allowsEffectiveSelection = [(UICollectionView *)self _allowsEffectiveSelection];
  if (path && [path section] != 0x7FFFFFFFFFFFFFFFLL)
  {
    v20 = [path item] != 0x7FFFFFFFFFFFFFFFLL;
    if (!_allowsEffectiveSelection)
    {
      goto LABEL_10;
    }
  }

  else
  {
    v20 = 0;
    if (!_allowsEffectiveSelection)
    {
      goto LABEL_10;
    }
  }

  if (!v20)
  {
    [(UICollectionView *)self _deselectAllAnimated:animatedCopy notifyDelegate:delegateCopy];
    goto LABEL_54;
  }

LABEL_10:
  if (delegateCopy)
  {
    if (![(UICollectionView *)self _delegateAllowsSelectingItemAtIndexPath:path]|| !_allowsEffectiveSelection)
    {
      goto LABEL_51;
    }

LABEL_14:
    v48 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v48 | 0x100000;
    v21 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    if (previous || (v22 = 2976, !-[UICollectionView _allowsEffectiveMultipleSelection](self, "_allowsEffectiveMultipleSelection")) && ((selectionController = self->_selectionController) == 0 ? (v24 = 0) : (v24 = -[NSMutableSet copy](selectionController->_selectedIndexPaths, "copy")), [v24 anyObject], v25 = objc_claimAutoreleasedReturnValue(), LODWORD(v45) = objc_msgSend(v25, "isEqual:", path), v25, v24, v21 = &OBJC_IVAR____UISystemBackgroundView__strokeView, (v45 & 1) == 0))
    {
      [(UICollectionView *)self _deselectAllAnimated:animatedCopy notifyDelegate:delegateCopy, v45];
      v22 = v21[181];
    }

    v46 = v22;
    v26 = *(&self->super.super.super.super.isa + v22);
    if (v26)
    {
      if (([*(v26 + 8) containsObject:path] & 1) == 0)
      {
        v27 = *(&self->super.super.super.super.isa + v22);
        if (v27)
        {
          [*(v27 + 8) addObject:path];
          if ((*(v27 + 40) & 1) == 0)
          {
            [*(v27 + 32) removeAllObjects];
          }
        }
      }
    }

    if (v50)
    {
      [v50 _setSelected:1 animated:animatedCopy isUserInitiated:initiated];
      p_collectionViewFlags = &self->_collectionViewFlags;
    }

    else
    {
      p_collectionViewFlags = &self->_collectionViewFlags;
      if (v17)
      {
        collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
        [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:path separatorOnly:0];
      }
    }

    if (position)
    {
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:path atScrollPosition:position additionalInsets:animatedCopy animated:0.0, 0.0, 0.0, 0.0];
    }

    _focusSystem = [(UIView *)self _focusSystem];
    focusedItem = [_focusSystem focusedItem];
    v32 = v50;
    v33 = [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:path initiatedBySelection:1];
    if (!v50 || focusedItem == v32 || !dyld_program_sdk_at_least())
    {
      if (!v33)
      {
        goto LABEL_44;
      }

      goto LABEL_42;
    }

    if (!v33)
    {
      goto LABEL_44;
    }

    _focusSystem2 = [(UIView *)self _focusSystem];
    v35 = [_focusSystem2 _focusedItemIsContainedInEnvironment:self includeSelf:1];

    if (!delegateCopy || (v35 & 1) != 0)
    {
      if (!focusedItem)
      {
LABEL_42:
        if (([_focusSystem _focusedItemIsContainedInEnvironment:self includeSelf:1] & 1) == 0)
        {
          [(UIView *)self setNeedsFocusUpdate];
        }

LABEL_44:
        if (!delegateCopy)
        {
LABEL_50:
          *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFEFFFFF | (((v48 >> 20) & 1) << 20);

          goto LABEL_51;
        }

LABEL_45:
        _selectionSegueTemplate = [v32 _selectionSegueTemplate];
        v38 = [_selectionSegueTemplate perform:v32];

        if ((*p_collectionViewFlags & 0x20) != 0)
        {
          [UIViewController _sendPrepareForTapGesture:v32];
          _delegateProxy = [(UICollectionView *)self _delegateProxy];
          [_delegateProxy collectionView:self didSelectItemAtIndexPath:path];
        }

        multiSelectController = self->_multiSelectController;
        v41 = *(&self->super.super.super.super.isa + v47);
        if (v41)
        {
          v42 = [*(v41 + 8) copy];
        }

        else
        {
          v42 = 0;
        }

        allObjects = [v42 allObjects];
        [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:allObjects];

        goto LABEL_50;
      }
    }

    else
    {
      _shouldBecomeFocusedOnSelection = [(UICollectionView *)self _shouldBecomeFocusedOnSelection];
      if (_shouldBecomeFocusedOnSelection || !focusedItem)
      {
        if (_shouldBecomeFocusedOnSelection)
        {
LABEL_59:
          [_focusSystem _updateFocusImmediatelyToEnvironment:v32];
          if (!delegateCopy)
          {
            goto LABEL_50;
          }

          goto LABEL_45;
        }

        goto LABEL_42;
      }
    }

    if ([_focusSystem _focusedItemIsContainedInEnvironment:self includeSelf:1])
    {
      goto LABEL_59;
    }

    goto LABEL_42;
  }

  if (_allowsEffectiveSelection)
  {
    goto LABEL_14;
  }

LABEL_51:
  if (v49 && (*(&self->_collectionViewFlags + 6) & 0x10) != 0)
  {
    _delegateProxy2 = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy2 collectionView:self performPrimaryActionForItemAtIndexPath:path];
  }

LABEL_54:
}

- (BOOL)_canPerformPrimaryActionForItemAtIndexPath:(id)path
{
  pathCopy = path;
  if (pathCopy && [(UICollectionView *)self _delegateSupportsPrimaryAction])
  {
    if ((*(&self->_collectionViewFlags + 6) & 8) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      LOBYTE(self) = [_delegateProxy collectionView:self canPerformPrimaryActionForItemAtIndexPath:pathCopy];
    }

    else
    {
      LODWORD(self) = ![(UICollectionView *)self _isEditing];
    }
  }

  else
  {
    LOBYTE(self) = 0;
  }

  return self;
}

- (void)selectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated scrollPosition:(UICollectionViewScrollPosition)scrollPosition
{
  v6 = animated;
  v8 = *(&self->_collectionViewFlags + 1);
  if ((~v8 & 0x180000000000) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v8 & 0xFFFFEFFFFFFFFFFFLL;
  }

  v9 = indexPath;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v11 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:v9];

  LOWORD(v10) = 0;
  [(UICollectionView *)self _selectItemAtIndexPath:v11 animated:v6 scrollPosition:scrollPosition notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v10 isUserInitiated:?];
}

- (void)_deselectItemAtIndexPath:(id)path animated:(BOOL)animated notifyDelegate:(BOOL)delegate isUserInitiated:(BOOL)initiated
{
  initiatedCopy = initiated;
  delegateCopy = delegate;
  animatedCopy = animated;
  v44 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  selectionController = self->_selectionController;
  if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths containsObject:pathCopy])
  {
    v12 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:pathCopy isSelection:1 allowMassIndexPath:0 assertIfInvalid:0];
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v14 = _delegateProxy;
    if (!delegateCopy || (*&self->_collectionViewFlags & 0x10) == 0 || [_delegateProxy collectionView:self shouldDeselectItemAtIndexPath:pathCopy])
    {
      v15 = self->_selectionController;
      if (v15)
      {
        [(NSMutableSet *)v15->_selectedIndexPaths removeObject:pathCopy];
      }

      v16 = [(UICollectionView *)self _cellForItemAtIndexPath:pathCopy];
      v17 = v16;
      if (v16)
      {
        [v16 _setSelected:0 animated:animatedCopy isUserInitiated:initiatedCopy];
      }

      else if (v12)
      {
        collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
        [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:pathCopy separatorOnly:0];
      }

      if (delegateCopy)
      {
        multiSelectController = self->_multiSelectController;
        v20 = self->_selectionController;
        v21 = v20 ? [(NSMutableSet *)v20->_selectedIndexPaths copy]: 0;
        allObjects = [v21 allObjects];
        [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:allObjects];

        if ((*&self->_collectionViewFlags & 0x40) != 0)
        {
          [v14 collectionView:self didDeselectItemAtIndexPath:pathCopy];
        }
      }

      if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:0 initiatedBySelection:1])
      {
        _focusSystem = [(UIView *)self _focusSystem];
        v24 = _focusSystem;
        if (v17 && [_focusSystem _focusedItemIsContainedInEnvironment:v17 includeSelf:1])
        {
          v37 = v24;
          v25 = [(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:pathCopy];
          indexPathsForSelectedItems = [(UICollectionView *)self indexPathsForSelectedItems];
          v42[0] = MEMORY[0x1E69E9820];
          v42[1] = 3221225472;
          v42[2] = __85__UICollectionView__deselectItemAtIndexPath_animated_notifyDelegate_isUserInitiated___block_invoke;
          v42[3] = &unk_1E70FECC8;
          v42[4] = self;
          v42[5] = v25;
          v27 = [indexPathsForSelectedItems sortedArrayUsingComparator:v42];

          v40 = 0u;
          v41 = 0u;
          v38 = 0u;
          v39 = 0u;
          v28 = v27;
          v29 = [v28 countByEnumeratingWithState:&v38 objects:v43 count:16];
          if (v29)
          {
            v30 = v29;
            v31 = *v39;
            while (2)
            {
              for (i = 0; i != v30; ++i)
              {
                if (*v39 != v31)
                {
                  objc_enumerationMutation(v28);
                }

                v33 = *(*(&v38 + 1) + 8 * i);
                v34 = [(UICollectionView *)self _cellForItemAtIndexPath:v33];
                if (v34 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:v33 initiatedBySelection:1])
                {

                  v24 = v37;
                  [v37 _updateFocusImmediatelyToEnvironment:v34];

                  goto LABEL_33;
                }
              }

              v30 = [v28 countByEnumeratingWithState:&v38 objects:v43 count:16];
              if (v30)
              {
                continue;
              }

              break;
            }
          }

          v24 = v37;
          [v37 _startDeferringFocusIfSupported];
LABEL_33:
        }
      }

      traitCollection = [(UIView *)self traitCollection];
      userInterfaceIdiom = [traitCollection userInterfaceIdiom];

      if (userInterfaceIdiom == 3)
      {
        [(UIView *)self setNeedsFocusUpdate];
      }
    }
  }
}

uint64_t __85__UICollectionView__deselectItemAtIndexPath_animated_notifyDelegate_isUserInitiated___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v5 = *(*(a1 + 32) + 2272);
  v6 = a3;
  v7 = [(UICollectionViewData *)v5 globalIndexForItemAtIndexPath:a2];
  v8 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) globalIndexForItemAtIndexPath:v6];

  v9 = *(a1 + 40);
  v10 = v7 - v9;
  if (v7 - v9 < 0)
  {
    v10 = v9 - v7;
  }

  v11 = v8 - v9;
  if (v11 < 0)
  {
    v11 = -v11;
  }

  if (v10 < v11)
  {
    v12 = -1;
  }

  else
  {
    v12 = v11 < v10;
  }

  v13 = v8 < v7;
  if (v7 < v8)
  {
    v13 = -1;
  }

  if (v12)
  {
    return v12;
  }

  else
  {
    return v13;
  }
}

- (void)_deselectItemsAtIndexPaths:(id)paths animated:(BOOL)animated transitionCoordinator:(id)coordinator isUserInitiated:(BOOL)initiated
{
  initiatedCopy = initiated;
  animatedCopy = animated;
  v45 = *MEMORY[0x1E69E9840];
  pathsCopy = paths;
  coordinatorCopy = coordinator;
  if ([pathsCopy count])
  {
    v25 = coordinatorCopy;
    [(UICollectionView *)self _reloadDataIfNeeded];
    v12 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(pathsCopy, "count")}];
    v13 = self->_selectionController;
    v39 = 0u;
    v40 = 0u;
    v41 = 0u;
    v42 = 0u;
    v26 = pathsCopy;
    v14 = pathsCopy;
    v15 = [v14 countByEnumeratingWithState:&v39 objects:v44 count:16];
    if (v15)
    {
      v16 = v15;
      v17 = *v40;
      do
      {
        for (i = 0; i != v16; ++i)
        {
          if (*v40 != v17)
          {
            objc_enumerationMutation(v14);
          }

          v19 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:*(*(&v39 + 1) + 8 * i)];
          if (v13 && [(NSMutableSet *)v13->_selectedIndexPaths containsObject:v19])
          {
            [v12 addObject:v19];
          }
        }

        v16 = [v14 countByEnumeratingWithState:&v39 objects:v44 count:16];
      }

      while (v16);
    }

    coordinatorCopy = v25;
    if (v25)
    {
      [(_UICollectionViewSelectionController *)v13 addDeselectionTransitionIndexPaths:v12];
      v30[0] = MEMORY[0x1E69E9820];
      v30[1] = 3221225472;
      v30[2] = __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke;
      v30[3] = &unk_1E70FECF0;
      v31 = v13;
      selfCopy = self;
      v33 = animatedCopy;
      v34 = initiatedCopy;
      v27[0] = MEMORY[0x1E69E9820];
      v27[1] = 3221225472;
      v27[2] = __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke_2;
      v27[3] = &unk_1E70F4990;
      v28 = v31;
      selfCopy2 = self;
      [v25 animateAlongsideTransition:v30 completion:v27];

      v20 = v31;
    }

    else
    {
      v37 = 0u;
      v38 = 0u;
      v35 = 0u;
      v36 = 0u;
      v20 = v12;
      v21 = [(_UICollectionViewSelectionController *)v20 countByEnumeratingWithState:&v35 objects:v43 count:16];
      if (v21)
      {
        v22 = v21;
        v23 = *v36;
        do
        {
          for (j = 0; j != v22; ++j)
          {
            if (*v36 != v23)
            {
              objc_enumerationMutation(v20);
            }

            [(UICollectionView *)self _deselectItemAtIndexPath:*(*(&v35 + 1) + 8 * j) animated:animatedCopy notifyDelegate:0 isUserInitiated:initiatedCopy];
          }

          v22 = [(_UICollectionViewSelectionController *)v20 countByEnumeratingWithState:&v35 objects:v43 count:16];
        }

        while (v22);
      }
    }

    pathsCopy = v26;
  }
}

void __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke(uint64_t a1)
{
  v13 = *MEMORY[0x1E69E9840];
  v8 = 0u;
  v9 = 0u;
  v10 = 0u;
  v11 = 0u;
  v2 = *(a1 + 32);
  if (v2)
  {
    v2 = v2[3];
  }

  v3 = v2;
  v4 = [v3 countByEnumeratingWithState:&v8 objects:v12 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v9;
    do
    {
      v7 = 0;
      do
      {
        if (*v9 != v6)
        {
          objc_enumerationMutation(v3);
        }

        [*(a1 + 40) _deselectItemAtIndexPath:*(*(&v8 + 1) + 8 * v7++) animated:*(a1 + 48) notifyDelegate:0 isUserInitiated:{*(a1 + 49), v8}];
      }

      while (v5 != v7);
      v5 = [v3 countByEnumeratingWithState:&v8 objects:v12 count:16];
    }

    while (v5);
  }
}

void __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke_2(uint64_t a1, void *a2)
{
  v17 = *MEMORY[0x1E69E9840];
  if ([a2 isCancelled])
  {
    v14 = 0u;
    v15 = 0u;
    v12 = 0u;
    v13 = 0u;
    v3 = *(a1 + 32);
    if (v3)
    {
      v3 = v3[3];
    }

    v4 = v3;
    v5 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
    if (v5)
    {
      v6 = v5;
      v7 = *v13;
      do
      {
        v8 = 0;
        do
        {
          if (*v13 != v7)
          {
            objc_enumerationMutation(v4);
          }

          LOWORD(v11) = 0;
          [*(a1 + 40) _selectItemAtIndexPath:*(*(&v12 + 1) + 8 * v8++) animated:0 scrollPosition:0 notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v11 isUserInitiated:?];
        }

        while (v6 != v8);
        v6 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
      }

      while (v6);
    }
  }

  v9 = *(a1 + 32);
  if (v9)
  {
    v10 = *(v9 + 24);
    *(v9 + 24) = 0;
  }
}

- (void)deselectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated
{
  v4 = animated;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
  [(UICollectionView *)self _deselectItemAtIndexPath:v7 animated:v4 notifyDelegate:0 isUserInitiated:0];
}

- (void)setAllowsSelection:(BOOL)allowsSelection
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 1) & 0x1000) == 0) ^ allowsSelection) & 1) == 0)
  {
    if (allowsSelection)
    {
      *(&self->_collectionViewFlags + 1) |= 0x1000uLL;
    }

    else
    {
      if (![(UICollectionView *)self _isEditing])
      {
        [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
      }

      *(p_collectionViewFlags + 1) &= ~0x1000uLL;

      [(UICollectionView *)self setAllowsMultipleSelection:0];
    }
  }
}

- (void)setAllowsMultipleSelection:(BOOL)allowsMultipleSelection
{
  v21 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 9) & 0x20) == 0) ^ allowsMultipleSelection) & 1) == 0)
  {
    [(_UICollectionViewSelectionController *)self->_selectionController setAllowsMultipleSelection:?];
    if (allowsMultipleSelection)
    {
      *(p_collectionViewFlags + 1) |= 0x2000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];

      [(UICollectionView *)self setAllowsSelection:1];
    }

    else
    {
      selectionController = self->_selectionController;
      if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths count]>= 2 && ![(UICollectionView *)self _isEditing])
      {
        v7 = self->_selectionController;
        if (v7)
        {
          v8 = [(NSMutableSet *)v7->_selectedIndexPaths copy];
        }

        else
        {
          v8 = 0;
        }

        anyObject = [v8 anyObject];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = v8;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            for (i = 0; i != v12; ++i)
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = *(*(&v16 + 1) + 8 * i);
              if (v15 != anyObject)
              {
                [(UICollectionView *)self _deselectItemAtIndexPath:v15 animated:0 notifyDelegate:0 isUserInitiated:0, v16];
              }
            }

            v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
          }

          while (v12);
        }
      }

      *(p_collectionViewFlags + 1) &= ~0x2000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];
    }
  }
}

- (void)_setAllowsBandSelectionForMultipleSelection:(BOOL)selection
{
  v3 = 0x20000;
  if (!selection)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFDFFFFLL | v3;
}

- (void)setAllowsUserInitiatedMultipleSelection:(BOOL)selection
{
  if (((((*(&self->_collectionViewFlags + 1) & 0x8000) == 0) ^ selection) & 1) == 0)
  {
    v3 = 0x8000;
    if (!selection)
    {
      v3 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFF7FFFLL | v3;
  }
}

- (void)_setAllowsSelectionDuringEditing:(BOOL)editing
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 1) & 0x4000) == 0) ^ editing) & 1) == 0)
  {
    if (editing)
    {
      *(&self->_collectionViewFlags + 1) |= 0x4000uLL;
    }

    else
    {
      if ([(UICollectionView *)self _isEditing])
      {
        [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
      }

      *(p_collectionViewFlags + 1) &= ~0x4000uLL;

      [(UICollectionView *)self setAllowsMultipleSelectionDuringEditing:0];
    }
  }
}

- (void)_setAllowsMultipleSelectionDuringEditing:(BOOL)editing
{
  v21 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 1);
  if (((((v4 & 0x10000) == 0) ^ editing) & 1) == 0)
  {
    if (editing)
    {
      *(&self->_collectionViewFlags + 1) = v4 | 0x10000;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];

      [(UICollectionView *)self setAllowsSelectionDuringEditing:1];
    }

    else
    {
      selectionController = self->_selectionController;
      if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths count]>= 2 && [(UICollectionView *)self _isEditing])
      {
        v7 = self->_selectionController;
        if (v7)
        {
          v8 = [(NSMutableSet *)v7->_selectedIndexPaths copy];
        }

        else
        {
          v8 = 0;
        }

        anyObject = [v8 anyObject];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = v8;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            for (i = 0; i != v12; ++i)
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = *(*(&v16 + 1) + 8 * i);
              if (v15 != anyObject)
              {
                [(UICollectionView *)self _deselectItemAtIndexPath:v15 animated:0 notifyDelegate:0 isUserInitiated:0, v16];
              }
            }

            v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
          }

          while (v12);
        }
      }

      *(p_collectionViewFlags + 1) &= ~0x10000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];
    }
  }
}

- (BOOL)_allowsEffectiveSelectionOrCustomActionAtIndexPath:(id)path
{
  v5 = -[UICollectionView _allowsEffectiveSelection](self, "_allowsEffectiveSelection") || dyld_program_sdk_at_least() && (-[UICollectionView _cellForItemAtIndexPath:](self, "_cellForItemAtIndexPath:", v4), (v6 = v4 = path;

  return v5;
}

- (void)_setDelaysUserInitiatedItemSelection:(BOOL)selection
{
  if (selection)
  {
    v3 = 2048;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFF7FF | v3;
}

- (void)setSelectionFollowsFocus:(BOOL)selectionFollowsFocus
{
  v3 = 1;
  if (selectionFollowsFocus)
  {
    v3 = 2;
  }

  v4 = *(&self->_collectionViewFlags + 1);
  if (((v4 >> 18) & 3) != v3)
  {
    *(&self->_collectionViewFlags + 1) = v4 & 0xFFFFFFFFFFF3FFFFLL | (v3 << 18);
    [(UICollectionView *)self _updateSelectionIsKey];
  }
}

- (void)_setShouldBecomeFocusedOnSelection:(BOOL)selection
{
  v3 = 0x100000;
  if (selection)
  {
    v3 = 0x200000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFCFFFFFLL | v3;
}

- (BOOL)_shouldBecomeFocusedOnSelection
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 20) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __51__UICollectionView__shouldBecomeFocusedOnSelection__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

uint64_t __51__UICollectionView__shouldBecomeFocusedOnSelection__block_invoke(uint64_t a1)
{
  if (dyld_program_sdk_at_least())
  {
    return 1;
  }

  v3 = [*(a1 + 32) traitCollection];
  v2 = [v3 _splitViewControllerContext] == 3;

  return v2;
}

- (void)setAllowsFocus:(BOOL)allowsFocus
{
  v3 = 0x400000;
  if (allowsFocus)
  {
    v3 = 0x800000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFF3FFFFFLL | v3;
}

- (void)setAllowsFocusDuringEditing:(BOOL)allowsFocusDuringEditing
{
  v3 = 0x1000000;
  if (allowsFocusDuringEditing)
  {
    v3 = 0x2000000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFCFFFFFFLL | v3;
}

- (BOOL)_defaultAllowsFocusDuringEditing
{
  if (![(UICollectionView *)self allowsSelectionDuringEditing])
  {
    return 0;
  }

  _focusBehavior = [(UIView *)self _focusBehavior];
  if ([_focusBehavior cellFocusability] == 2)
  {
    traitCollection = [(UIView *)self traitCollection];
    _hasSplitViewControllerContextSidebarColumn = [traitCollection _hasSplitViewControllerContextSidebarColumn];
  }

  else
  {
    _hasSplitViewControllerContextSidebarColumn = 1;
  }

  return _hasSplitViewControllerContextSidebarColumn;
}

- (BOOL)allowsFocusDuringEditing
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 24) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __44__UICollectionView_allowsFocusDuringEditing__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

- (BOOL)_effectiveDefaultAllowsFocus
{
  if ([(UICollectionView *)self _isEditing]|| ![(UICollectionView *)self _defaultAllowsFocus])
  {
    _isEditing = [(UICollectionView *)self _isEditing];
    if (_isEditing)
    {

      LOBYTE(_isEditing) = [(UICollectionView *)self _defaultAllowsFocusDuringEditing];
    }
  }

  else
  {
    LOBYTE(_isEditing) = 1;
  }

  return _isEditing;
}

- (void)_setReorderFeedbackGenerator:(id)generator
{
  generatorCopy = generator;
  if ([(UIFeedbackGenerator *)self->_reorderFeedbackGenerator isActive])
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2184 description:@"Reorder feedback behavior should not be changed while active."];
  }

  reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
  self->_reorderFeedbackGenerator = generatorCopy;
}

- (void)_unhighlightItemAtIndexPath:(id)path animated:(BOOL)animated notifyDelegate:(BOOL)delegate
{
  delegateCopy = delegate;
  animatedCopy = animated;
  pathCopy = path;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v17 = pathCopy;
    v10 = [(NSMutableSet *)selectionController->_highlightedIndexPaths containsObject:pathCopy];
    pathCopy = v17;
    if (v10)
    {
      v11 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:v17 isSelection:0 allowMassIndexPath:0 assertIfInvalid:0];
      v12 = self->_selectionController;
      if (v12)
      {
        [(NSMutableSet *)v12->_highlightedIndexPaths removeObject:v17];
      }

      v13 = [(UICollectionView *)self _cellForItemAtIndexPath:v17];
      v14 = v13;
      if (v13)
      {
        [v13 _setHighlighted:0 animated:animatedCopy];
      }

      else if (v11)
      {
        collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
        [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v17 separatorOnly:0];
      }

      if (delegateCopy && (*&self->_collectionViewFlags & 4) != 0)
      {
        _delegateProxy = [(UICollectionView *)self _delegateProxy];
        [_delegateProxy collectionView:self didUnhighlightItemAtIndexPath:v17];
      }

      pathCopy = v17;
    }
  }
}

- (BOOL)_highlightItemAtIndexPath:(id)path animated:(BOOL)animated scrollPosition:(unint64_t)position notifyDelegate:(BOOL)delegate playFeedback:(BOOL)feedback
{
  delegateCopy = delegate;
  animatedCopy = animated;
  v39 = *MEMORY[0x1E69E9840];
  feedback = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:path isSelection:0 allowMassIndexPath:1 assertIfInvalid:1, feedback];
  if (![(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:path])
  {
    return 0;
  }

  selectionController = self->_selectionController;
  if (selectionController)
  {
    if (([(NSMutableSet *)selectionController->_highlightedIndexPaths containsObject:path]& 1) != 0)
    {
      return 0;
    }
  }

  _delegateProxy = [(UICollectionView *)self _delegateProxy];
  if (!path || [path section] == 0x7FFFFFFFFFFFFFFFLL || objc_msgSend(path, "item") == 0x7FFFFFFFFFFFFFFFLL)
  {
    v14 = self->_selectionController;
    if (v14)
    {
      v15 = [(NSMutableSet *)v14->_highlightedIndexPaths copy];
    }

    else
    {
      v15 = 0;
    }

    v36 = 0u;
    v37 = 0u;
    v34 = 0u;
    v35 = 0u;
    v16 = [v15 countByEnumeratingWithState:&v34 objects:v38 count:16];
    if (!v16)
    {
      goto LABEL_23;
    }

    v17 = v16;
    v18 = *v35;
    while (1)
    {
      for (i = 0; i != v17; ++i)
      {
        if (*v35 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v34 + 1) + 8 * i);
        v21 = [(UICollectionView *)self _cellForItemAtIndexPath:v20];
        v22 = v21;
        if (v21)
        {
          [v21 _setHighlighted:0 animated:animatedCopy];
          if (!delegateCopy)
          {
            goto LABEL_21;
          }
        }

        else
        {
          collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
          [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v20 separatorOnly:0];

          if (!delegateCopy)
          {
            goto LABEL_21;
          }
        }

        if ((*&self->_collectionViewFlags & 4) != 0)
        {
          [_delegateProxy collectionView:self didUnhighlightItemAtIndexPath:v20];
        }

LABEL_21:
      }

      v17 = [v15 countByEnumeratingWithState:&v34 objects:v38 count:16];
      if (!v17)
      {
LABEL_23:
        v24 = self->_selectionController;
        if (v24)
        {
          [(NSMutableSet *)v24->_highlightedIndexPaths removeAllObjects];
        }

LABEL_26:
        _hasCustomSelectionAction = 0;
        goto LABEL_27;
      }
    }
  }

  if (delegateCopy && (*&self->_collectionViewFlags & 1) != 0 && !-[_UISelectionInteraction isHinting](self->_selectionInteraction, "isHinting") && ![_delegateProxy collectionView:self shouldHighlightItemAtIndexPath:path])
  {
    if (!feedback)
    {
      goto LABEL_26;
    }

    v30 = [(UICollectionView *)self _cellForItemAtIndexPath:path];
    v31 = v30;
    if (v30)
    {
      _hasCustomSelectionAction = [v30 _hasCustomSelectionAction];
    }

    else
    {
      _hasCustomSelectionAction = 0;
    }
  }

  else
  {
    v26 = self->_selectionController;
    if (v26)
    {
      [(NSMutableSet *)v26->_highlightedIndexPaths addObject:path];
    }

    v27 = [(UICollectionView *)self _cellForItemAtIndexPath:path];
    v28 = v27;
    if (v27)
    {
      [v27 _setHighlighted:1 animated:animatedCopy];
    }

    else if (feedback)
    {
      collectionViewLayout2 = [(UICollectionView *)self collectionViewLayout];
      [collectionViewLayout2 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:path separatorOnly:0];
    }

    if (position)
    {
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:path atScrollPosition:position additionalInsets:animatedCopy animated:0.0, 0.0, 0.0, 0.0];
    }

    if (delegateCopy && (*&self->_collectionViewFlags & 2) != 0)
    {
      [_delegateProxy collectionView:self didHighlightItemAtIndexPath:path];
    }

    _hasCustomSelectionAction = 1;
  }

LABEL_27:

  return _hasCustomSelectionAction;
}

- (void)_setNeedsVisibleCellsUpdate:(BOOL)update withLayoutAttributes:(BOOL)attributes
{
  attributesCopy = attributes;
  updateCopy = update;
  v28 = *MEMORY[0x1E69E9840];
  if (update && (*(&self->_collectionViewFlags + 9) & 4) == 0)
  {
    if (self->_debugger)
    {
      callStackSymbols = [MEMORY[0x1E696AF00] callStackSymbols];
      [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger recordUpdateVisibleCellsScheduledWithCallStack:callStackSymbols];
    }

    updateVisibleCellsRecursionCount = self->_updateVisibleCellsRecursionCount;
    if (updateVisibleCellsRecursionCount == 95)
    {
      if (self->_contentOffsetRestorationAnchor || self->_scrollingTargetIndexPath)
      {
        if (os_variant_has_internal_diagnostics())
        {
          v19 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v19, OS_LOG_TYPE_FAULT))
          {
            contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
            scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
            v22 = 138412802;
            selfCopy2 = self;
            v24 = 2112;
            v25 = contentOffsetRestorationAnchor;
            v26 = 2112;
            v27 = scrollingTargetIndexPath;
            _os_log_fault_impl(&dword_188A29000, v19, OS_LOG_TYPE_FAULT, "Attempting to recover UICollectionView stuck in an update/layout feedback loop. UICollectionView: %@. Scroll position restoration item: %@. Scrolling target: %@", &v22, 0x20u);
          }
        }

        else
        {
          v9 = *(__UILogGetCategoryCachedImpl("Assert", &_setNeedsVisibleCellsUpdate_withLayoutAttributes____s_category) + 8);
          if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
          {
            v10 = self->_contentOffsetRestorationAnchor;
            v11 = self->_scrollingTargetIndexPath;
            v22 = 138412802;
            selfCopy2 = self;
            v24 = 2112;
            v25 = v10;
            v26 = 2112;
            v27 = v11;
            _os_log_impl(&dword_188A29000, v9, OS_LOG_TYPE_ERROR, "Attempting to recover UICollectionView stuck in an update/layout feedback loop. UICollectionView: %@. Scroll position restoration item: %@. Scrolling target: %@", &v22, 0x20u);
          }
        }

        [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger printCollectedRecordsForCollectionView:self raiseException:0];
        [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
        [(UICollectionView *)self _clearTargetIndexPathForScrolling];
      }
    }

    else if (updateVisibleCellsRecursionCount >= 100)
    {
      debugger = self->_debugger;
      if (debugger)
      {
        [(_UICollectionViewFeedbackLoopDebugger *)debugger printCollectedRecordsForCollectionView:self raiseException:1];
      }
    }
  }

  v13 = *(&self->_collectionViewFlags + 1);
  v14 = (v13 >> 10) & 1 | updateCopy;
  v15 = 1024;
  if (!v14)
  {
    v15 = 0;
  }

  v16 = v13 & 0xFFFFFFFFFFFFF3FFLL;
  v17 = (v13 >> 11) & 1 | attributesCopy;
  v18 = 2048;
  if (!v17)
  {
    v18 = 0;
  }

  *(&self->_collectionViewFlags + 1) = v15 | v16 | v18;
  if ((v14 & 1) != 0 || v17)
  {
    [(UIScrollView *)self setNeedsLayout];
  }
}

- (void)_saveContentOffsetRestorationAnchorIfNecessaryUsingModel:(uint64_t)model
{
  v81 = *MEMORY[0x1E69E9840];
  v3 = a2;
  if (!model)
  {
    goto LABEL_21;
  }

  if (*(model + 3024))
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923D0);
    if (*CategoryCachedImpl)
    {
      v5 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
      {
        *buf = 134217984;
        modelCopy8 = model;
        v6 = "_saveContentOffset: cv == %p; not saving -- a scrolling target index path exists";
LABEL_57:
        _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, v6, buf, 0xCu);
        goto LABEL_21;
      }
    }

    goto LABEL_21;
  }

  if (!*(model + 3000))
  {
    if ((*(model + 2738) & 0x40) != 0)
    {
      v12 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923E0);
      if (*v12)
      {
        v5 = *(v12 + 8);
        if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          modelCopy8 = model;
          v6 = "_saveContentOffset: cv == %p; not saving -- saving disabled";
          goto LABEL_57;
        }
      }

      goto LABEL_21;
    }

    _layoutAxis = [*(model + 2152) _layoutAxis];
    if ((_layoutAxis - 1) > 1)
    {
      goto LABEL_21;
    }

    v9 = _layoutAxis;
    *(model + 2736) |= 0x400000u;
    v10 = dyld_program_sdk_at_least();
    if (!v3 || !v10 || !v3[21] || !-[_UICollectionViewSubviewManager hasVisibleCells](*(model + 2984)) || [model _isReordering])
    {
      v11 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923E8);
      if (*v11)
      {
        v5 = *(v11 + 8);
        if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          modelCopy8 = model;
          v6 = "_saveContentOffset: cv == %p; not saving -- restoration preconditions not met";
          goto LABEL_57;
        }
      }

      goto LABEL_21;
    }

    [model contentOffset];
    if ([(UICollectionView *)model _isContentOffset:v9 atStartOfAxis:v13, v14])
    {
      v15 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923F0);
      if ((*v15 & 1) == 0)
      {
        goto LABEL_21;
      }

      v16 = *(v15 + 8);
      if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_21;
      }

      v17 = v16;
      v18 = _UIAxisDescription(v9);
      *buf = 134218242;
      modelCopy8 = model;
      v71 = 2112;
      v72 = v18;
      v19 = "_saveContentOffset: cv == %p; not saving -- scrolled to the start of layout axis (%@)";
      v20 = v17;
LABEL_26:
      _os_log_impl(&dword_188A29000, v20, OS_LOG_TYPE_ERROR, v19, buf, 0x16u);
LABEL_53:

LABEL_54:
      goto LABEL_21;
    }

    if ([model _isInSetContentOffset])
    {
      v21 = *(model + 2744);
      v22 = *(model + 2752);
    }

    else
    {
      [model contentOffset];
      v21 = v23;
      v22 = v24;
    }

    [model _visibleBounds];
    v26 = v25;
    v28 = v27;
    v30 = v29;
    v32 = v31;
    MaxX = v25;
    if ((*(model + 106) & 0x40) != 0)
    {
      MaxX = v25;
      if (([model _flipsHorizontalAxis] & 1) == 0)
      {
        v83.origin.x = v26;
        v83.origin.y = v28;
        v83.size.width = v30;
        v83.size.height = v32;
        MaxX = CGRectGetMaxX(v83);
      }
    }

    v17 = [(UICollectionViewData *)v3 layoutAttributesForCellsInRect:v26 validateLayout:v28, v30, v32];
    if ([v17 count])
    {
      v68[0] = MEMORY[0x1E69E9820];
      v68[1] = 3221225472;
      v68[2] = __77__UICollectionView__saveContentOffsetRestorationAnchorIfNecessaryUsingModel___block_invoke;
      v68[3] = &unk_1E70FF030;
      v68[4] = model;
      v34 = [(UICollectionView *)model _layoutAttributesClosestToReferencePoint:v17 amongCandidates:v9 onAxis:v68 shouldConsiderBlock:MaxX, v28];
      v18 = v34;
      if (v34)
      {
        v35 = *(model + 2984);
        indexPath = [v34 indexPath];
        v37 = [(_UICollectionViewSubviewManager *)v35 visibleCellAtIndexPath:indexPath];

        if (!v37)
        {

          v18 = 0;
        }
      }

      if ((*(model + 2726) & 0x20) != 0)
      {
        indexPath2 = [v18 indexPath];
        _delegateProxy = [model _delegateProxy];
        v40 = [_delegateProxy _collectionView:model indexPathOfReferenceItemToPreserveContentOffsetWithProposedReference:indexPath2];

        if ((_deferringTokenEqualToToken(v40, indexPath2) & 1) == 0)
        {
          if (v40)
          {
            v41 = [(UICollectionViewData *)v3 layoutAttributesForItemAtIndexPath:v40];
          }

          else
          {
            v41 = 0;
          }

          v18 = v41;
        }
      }

      if (!v18)
      {
        v65 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492400);
        if ((*v65 & 1) == 0)
        {
          goto LABEL_53;
        }

        v66 = *(v65 + 8);
        if (!os_log_type_enabled(v66, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_53;
        }

        v67 = *(model + 2280);
        *buf = 134218242;
        modelCopy8 = model;
        v71 = 2112;
        v72 = v67;
        v19 = "_saveContentOffset: cv == %p; not saving -- no attributes available to reference. Current update: %@";
        v20 = v66;
        goto LABEL_26;
      }

      *(model + 2736) &= ~0x400000u;
      indexPath3 = [v18 indexPath];
      v46 = *(model + 3000);
      *(model + 3000) = indexPath3;

      [v18 frame];
      v48 = v47;
      v50 = v49;
      v52 = v51;
      v54 = v53;
      *(model + 3008) = v21 - v47;
      *(model + 3016) = v22 - v49;
      [model _contentInsetIncludingDecorations];
      v56.f64[1] = v55;
      *(model + 3008) = vaddq_f64(v56, *(model + 3008));
      v57 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492408);
      if ((*v57 & 1) == 0)
      {
        goto LABEL_53;
      }

      v58 = *(v57 + 8);
      if (!os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_53;
      }

      v59 = *(model + 3000);
      v44 = v58;
      section = [v59 section];
      item = [*(model + 3000) item];
      v85.origin.x = v48;
      v85.origin.y = v50;
      v85.size.width = v52;
      v85.size.height = v54;
      v62 = NSStringFromCGRect(v85);
      v63 = NSStringFromCGPoint(*(model + 3008));
      v82.x = v21;
      v82.y = v22;
      v64 = NSStringFromCGPoint(v82);
      *buf = 134219266;
      modelCopy8 = model;
      v71 = 2048;
      v72 = section;
      v73 = 2048;
      v74 = item;
      v75 = 2112;
      v76 = v62;
      v77 = 2112;
      v78 = v63;
      v79 = 2112;
      v80 = v64;
      _os_log_impl(&dword_188A29000, v44, OS_LOG_TYPE_ERROR, "_saveContentOffset: cv == %p; saved (%zd - %zd). Item Frame: %@, offsetIntoAnchor: %@, contentOffset: %@", buf, 0x3Eu);
    }

    else
    {
      v42 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923F8);
      if ((*v42 & 1) == 0)
      {
        goto LABEL_54;
      }

      v43 = *(v42 + 8);
      if (!os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_54;
      }

      v18 = v43;
      v84.origin.x = v26;
      v84.origin.y = v28;
      v84.size.width = v30;
      v84.size.height = v32;
      v44 = NSStringFromCGRect(v84);
      *buf = 134218242;
      modelCopy8 = model;
      v71 = 2112;
      v72 = v44;
      _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_saveContentOffset: cv == %p; not saving -- no layout attributes in visible bounds (%@)", buf, 0x16u);
    }

    goto LABEL_53;
  }

  v7 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923D8);
  if (*v7)
  {
    v5 = *(v7 + 8);
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      modelCopy8 = model;
      v6 = "_saveContentOffset: cv == %p; not saving -- already have an anchor";
      goto LABEL_57;
    }
  }

LABEL_21:
}

void __30__UICollectionView_reloadData__block_invoke_4(uint64_t a1)
{
  v1 = *(a1 + 32);
  if ((*(v1 + 2731) & 0x40) == 0)
  {
    v3 = (v1 + 2288);
    v4 = *v3;
    v5 = v3[1];
    v6 = v3[2];
    v7 = v3[3];
    v11.origin.x = *v3;
    v11.origin.y = v5;
    v11.size.width = v6;
    v11.size.height = v7;
    if (CGRectGetWidth(v11) > 0.0)
    {
      v12.origin.x = v4;
      v12.origin.y = v5;
      v12.size.width = v6;
      v12.size.height = v7;
      if (CGRectGetHeight(v12) > 0.0)
      {
        v13.origin.x = v4;
        v13.origin.y = v5;
        v13.size.width = v6;
        v13.size.height = v7;
        v8 = CGRectGetWidth(v13) * -0.75;
        v14.origin.x = v4;
        v14.origin.y = v5;
        v14.size.width = v6;
        v14.size.height = v7;
        v9 = CGRectGetHeight(v14) * -0.75;
        v15.origin.x = v4;
        v15.origin.y = v5;
        v15.size.width = v6;
        v15.size.height = v7;
        v16 = CGRectInset(v15, v8, v9);
        v10 = [*(a1 + 32) _computeMainPrefetchCandidatesForVisibleBounds:v4 futureVisibleBounds:v5 prefetchVector:{v6, v7, v16.origin.x, v16.origin.y, v16.size.width, v16.size.height, 0, 0}];
      }
    }
  }
}

- (void)_addReloadDataCompletionBlock:(id)block
{
  blockCopy = block;
  if ((*(&self->_collectionViewFlags + 11) & 0x80) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2599 description:{@"Attempting to add a reload data completion block but a reload is not in progress. Collection view: %@", self}];
  }

  v6 = _Block_copy(self->_reloadDataCompletionBlock);
  v7 = v6;
  if (v6)
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __50__UICollectionView__addReloadDataCompletionBlock___block_invoke;
    aBlock[3] = &unk_1E70F77D0;
    v14 = v6;
    v15 = blockCopy;
    v8 = _Block_copy(aBlock);
    reloadDataCompletionBlock = self->_reloadDataCompletionBlock;
    self->_reloadDataCompletionBlock = v8;

    v10 = v14;
  }

  else
  {
    v11 = _Block_copy(blockCopy);
    v10 = self->_reloadDataCompletionBlock;
    self->_reloadDataCompletionBlock = v11;
  }
}

uint64_t __50__UICollectionView__addReloadDataCompletionBlock___block_invoke(uint64_t a1)
{
  (*(*(a1 + 32) + 16))();
  v2 = *(*(a1 + 40) + 16);

  return v2();
}

- (void)_setShouldPersistSelectionOnReloadDataWhenPossible:(BOOL)possible
{
  if (possible)
  {
    v3 = 0x2000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFDFFF | v3;
}

- (void)_setForcePreserveSemanticContentOffsetDuringUpdates:(BOOL)updates
{
  if (updates)
  {
    v3 = 0x4000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFBFFF | v3;
}

- (void)_setShouldSkipForcedLayoutBeforeBatchUpdates:(BOOL)updates
{
  if (updates)
  {
    v3 = 0x8000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFF7FFF | v3;
}

- (void)setDragDelegate:(id)dragDelegate
{
  obj = dragDelegate;
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragDelegate, obj);
    _UIValidateAccountBasedDelegateRespondsToSelector(obj, sel__collectionView_dataOwnerForDragSession_atIndexPath_);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDragDelegate];
  }
}

- (void)setDropDelegate:(id)dropDelegate
{
  obj = dropDelegate;
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dropDelegate, obj);
    _UIValidateAccountBasedDelegateRespondsToSelector(obj, sel__collectionView_dataOwnerForDropSession_withDestinationIndexPath_);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDropDelegate];
  }
}

- (void)setDragDestinationDelegate:(id)delegate
{
  obj = delegate;
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  v5 = obj;
  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragDestinationDelegate, obj);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDropDelegate];
    v5 = obj;
  }
}

- (void)setDragSourceDelegate:(id)delegate
{
  obj = delegate;
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  v5 = obj;
  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragSourceDelegate, obj);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDragDelegate];
    v5 = obj;
  }
}

- (BOOL)_isCellInvolvedInDragOrDropAnimationAtIndexPath:(id)path
{
  pathCopy = path;
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:pathCopy];
  LOBYTE(self) = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:v5 atIndexPath:pathCopy];

  return self;
}

- (void)_setPreferredDragDestinationVisualStyle:(int64_t)style
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    dragAndDropController->_preferredDragDestinationVisualStyle = style;
  }
}

- (int64_t)_preferredDragDestinationVisualStyle
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    return dragAndDropController->_preferredDragDestinationVisualStyle;
  }

  else
  {
    return 0;
  }
}

- (void)_immediatelyBeginDruidBasedReorderIfPossibleWithTouch:(id)touch
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    [(_UICollectionViewDragSourceController *)dragAndDropController->_sourceController attemptToBeginDragImmediatelyWithTouch:touch];
  }
}

- (void)_setIsAncestorOfFirstResponder:(BOOL)responder
{
  responderCopy = responder;
  v26.receiver = self;
  v26.super_class = UICollectionView;
  [(UIView *)&v26 _setIsAncestorOfFirstResponder:?];
  window = [(UIView *)self window];
  firstResponder = [window firstResponder];

  if (firstResponder)
  {
    while (1)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        break;
      }

      nextResponder = [firstResponder nextResponder];

      firstResponder = nextResponder;
      if (!nextResponder)
      {
        goto LABEL_9;
      }
    }

    firstResponder = firstResponder;
    nextResponder = firstResponder;
    do
    {
      superview = [nextResponder superview];

      if (superview == self)
      {
        break;
      }

      superview2 = [nextResponder superview];

      nextResponder = superview2;
    }

    while (superview2);
  }

  else
  {
    nextResponder = 0;
  }

LABEL_9:
  if (responderCopy)
  {
    if ((*(&self->_collectionViewFlags + 11) & 0x80) == 0)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        objc_storeStrong(&self->_firstResponderView, nextResponder);
        _layoutAttributes = [nextResponder _layoutAttributes];
        firstResponderView = _layoutAttributes;
        if (_layoutAttributes)
        {
          p_firstResponderViewType = &self->_firstResponderViewType;
          if (*(_layoutAttributes + 288))
          {
            *p_firstResponderViewType = 1;
            v23 = [(UICollectionView *)self _indexPathForCell:nextResponder];
            indexPath = v23;
            if (!v23)
            {
              indexPath = [(UICollectionReusableView *)firstResponderView indexPath];
            }

            objc_storeStrong(&self->_firstResponderIndexPath, indexPath);
            if (!v23)
            {
            }

            firstResponderViewKind = self->_firstResponderViewKind;
            self->_firstResponderViewKind = 0;
            goto LABEL_35;
          }
        }

        else
        {
          p_firstResponderViewType = &self->_firstResponderViewType;
        }

        *p_firstResponderViewType = 2;
        v13 = [(UICollectionView *)self _indexPathForSupplementaryView:nextResponder];
        indexPath2 = v13;
        if (!v13)
        {
          indexPath2 = [(UICollectionReusableView *)firstResponderView indexPath];
        }

        objc_storeStrong(&self->_firstResponderIndexPath, indexPath2);
        if (!v13)
        {
        }

        firstResponderViewKind = [nextResponder _layoutAttributes];
        _content = [(_UILabelConfiguration *)firstResponderViewKind _content];
        v17 = self->_firstResponderViewKind;
        self->_firstResponderViewKind = _content;

LABEL_35:
        goto LABEL_38;
      }
    }

    self->_firstResponderViewType = 0;
    firstResponderIndexPath = self->_firstResponderIndexPath;
    self->_firstResponderIndexPath = 0;

    v22 = self->_firstResponderViewKind;
    self->_firstResponderViewKind = 0;

    firstResponderView = self->_firstResponderView;
    self->_firstResponderView = 0;
  }

  else
  {
    firstResponderView = self->_firstResponderView;
    if (self->_firstResponderViewType)
    {
      firstResponderView = firstResponderView;
      v18 = self->_firstResponderView;
      self->_firstResponderView = 0;

      subviewManager = self->_subviewManager;
      if ((!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:?]& 1) == 0) && firstResponderView != self->_newContentView)
      {
        objc_opt_self();
        if ((__addingResponderToTree & 1) == 0 && ![(UICollectionReusableView *)firstResponderView _isInUpdateAnimation])
        {
          firstResponderViewType = self->_firstResponderViewType;
          if (firstResponderViewType == 2)
          {
            [(UICollectionView *)self _reuseSupplementaryView:firstResponderView];
          }

          else if (firstResponderViewType == 1)
          {
            [(UICollectionView *)self _reuseCell:firstResponderView notifyDidEndDisplaying:1];
          }
        }
      }

      v25 = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = 0;

      self->_firstResponderViewType = 0;
    }

    else
    {
      self->_firstResponderView = 0;
    }
  }

LABEL_38:
}

- (void)_addControlledSubview:(id)subview
{
  _layoutAttributes = [subview _layoutAttributes];
  -[UICollectionView _addControlledSubview:atZIndex:forced:](self, "_addControlledSubview:atZIndex:forced:", subview, [_layoutAttributes zIndex], 1);
}

- (void)_reparentViewIntoSelf:(id)self
{
  viewsOptedOutOfBeingParentedIntoContainers = self->_viewsOptedOutOfBeingParentedIntoContainers;
  if (viewsOptedOutOfBeingParentedIntoContainers)
  {
    [(NSMutableSet *)viewsOptedOutOfBeingParentedIntoContainers addObject:self];
  }

  else
  {
    v6 = [MEMORY[0x1E695DFA8] setWithObject:self];
    v7 = self->_viewsOptedOutOfBeingParentedIntoContainers;
    self->_viewsOptedOutOfBeingParentedIntoContainers = v6;
  }

  [(UICollectionView *)self _addControlledSubview:self];
}

- (void)_reparentViewIntoCorrectContainer:(id)container
{
  [(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers removeObject:?];
  if (![(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers count])
  {
    viewsOptedOutOfBeingParentedIntoContainers = self->_viewsOptedOutOfBeingParentedIntoContainers;
    self->_viewsOptedOutOfBeingParentedIntoContainers = 0;
  }

  [(UICollectionView *)self _addControlledSubview:container];
}

- (void)_addControlledSubview:(id)subview atZIndex:(int64_t)index forced:(BOOL)forced initialAttributes:(id)attributes
{
  v41 = *MEMORY[0x1E69E9840];
  attributesCopy = attributes;
  v12 = attributesCopy;
  if (attributesCopy)
  {
    _layoutAttributes = attributesCopy;
  }

  else
  {
    _layoutAttributes = [subview _layoutAttributes];
  }

  v14 = _layoutAttributes;
  if (os_variant_has_internal_diagnostics())
  {
    if (!v14)
    {
      v34 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v34, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412546;
        selfCopy2 = self;
        v39 = 2112;
        subviewCopy2 = subview;
        _os_log_fault_impl(&dword_188A29000, v34, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempted to add controlled subview with nil layout attributes. Collection view %@; view: %@", buf, 0x16u);
      }
    }
  }

  else if (!v14)
  {
    v36 = *(__UILogGetCategoryCachedImpl("Assert", &_addControlledSubview_atZIndex_forced_initialAttributes____s_category) + 8);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412546;
      selfCopy2 = self;
      v39 = 2112;
      subviewCopy2 = subview;
      _os_log_impl(&dword_188A29000, v36, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempted to add controlled subview with nil layout attributes. Collection view %@; view: %@", buf, 0x16u);
    }
  }

  v15 = [(UICollectionView *)self _subviewRouterForView:subview attributes:v14 createIfNecessary:1];
  if (!v15)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2874 description:{@"UICollectionView internal inconsistency: attempted to add controlled subview without a subview router. Collection view %@; view: %@", self, subview}];
  }

  objc_storeStrong(&self->_newContentView, subview);
  if (!forced)
  {
    superview = [subview superview];
    if (v15)
    {
      v17 = *(v15 + 40);
    }

    else
    {
      v17 = 0;
    }

    v18 = v17;
    v19 = v18;
    if (superview == v18)
    {
      _layoutAttributes2 = [subview _layoutAttributes];
      zIndex = [_layoutAttributes2 zIndex];

      if (zIndex == index)
      {
        goto LABEL_18;
      }
    }

    else
    {
    }
  }

  if ([(UICollectionViewLayout *)self->_layout _orthogonalScrollingElementShouldAppearBelowForAttributes:v14])
  {
    v22 = -1;
  }

  else
  {
    v22 = 1;
  }

  [(_UICollectionViewSubviewRouter *)v15 addControlledSubview:subview zIndex:index orderMode:v22];
LABEL_18:
  v23 = self->_layout;
  subviewCopy3 = subview;
  v25 = subviewCopy3;
  if (subviewCopy3 && v23)
  {
    effectiveUserInterfaceLayoutDirection = [subviewCopy3 effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection != [(UICollectionViewLayout *)v23 developmentLayoutDirection])
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v23 _wantsRightToLeftHorizontalMirroringIfNeeded];
      goto LABEL_24;
    }

    if ([v25 _flipsHorizontalAxis])
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
LABEL_24:
      [v25 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
    }
  }

  if (dyld_program_sdk_at_least())
  {
    _layoutAttributes3 = [v25 _layoutAttributes];
    _zPosition = [_layoutAttributes3 _zPosition];

    if (_zPosition >= 1)
    {
      if ([(UICollectionView *)self hasActiveDrag]|| (v30 = 0.0, [(UICollectionView *)self hasActiveDrop]))
      {
        v30 = _zPosition;
      }

      layer = [v25 layer];
      [layer setZPosition:v30];
    }
  }

  if (v15)
  {
    orthogonalScrollerController = self->_orthogonalScrollerController;
    if (orthogonalScrollerController)
    {
      if (*(v15 + 32) == 1)
      {
        [(_UICollectionViewOrthogonalScrollerSectionController *)&orthogonalScrollerController->super.isa adjustElementHierarchyOrderingForOrthogonalElementIfNeeded:v25 layoutAttributes:v14];
      }
    }
  }

  newContentView = self->_newContentView;
  self->_newContentView = 0;
}

- (id)_subviewRouterForView:(id)view attributes:(id)attributes createIfNecessary:(BOOL)necessary
{
  necessaryCopy = necessary;
  attributesCopy = attributes;
  if (([(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers containsObject:view]& 1) != 0)
  {
    v9 = 0;
    v10 = 0;
  }

  else
  {
    v9 = [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:attributesCopy];
    v10 = [(UICollectionViewLayout *)self->_layout _shouldAddElementToSectionContainer:attributesCopy];
  }

  indexPath = [attributesCopy indexPath];
  section = [indexPath section];

  if (v9)
  {
    subviewRouter = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa subviewRouterForSection:section];
  }

  else
  {
    if (v10)
    {
      v14 = [(UICollectionView *)self _sectionContainerViewForSectionIndex:section createIfNecessary:necessaryCopy];
      v15 = v14;
      if (v14)
      {
        v16 = *(v14 + 408);
      }

      else
      {
        v16 = 0;
      }

      v17 = v16;

      goto LABEL_12;
    }

    subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  }

  v17 = subviewRouter;
LABEL_12:

  return v17;
}

- (id)_subviewRouterForOrthogonalScrollViewAtSection:(int64_t)section
{
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v6 = [(UICollectionView *)self _sectionContainerViewForSectionIndex:section createIfNecessary:1];
  v7 = v6;
  if (v6)
  {
    v8 = *(v6 + 408);

    subviewRouter = v8;
  }

  return subviewRouter;
}

- (void)_addScrollPocketAsSubview:(id)subview
{
  subviewCopy = subview;
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  [(_UICollectionViewSubviewRouter *)subviewRouter addControlledSubview:subviewCopy zIndex:999999999 orderMode:1];
}

- (BOOL)_addGlassGroupView:(id)view material:(id)material
{
  viewCopy = view;
  _glassGroupZIndex = [(UICollectionViewLayout *)self->_layout _glassGroupZIndex];
  if (_glassGroupZIndex != 0x7FFFFFFFFFFFFFFFLL)
  {
    subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
    [(_UICollectionViewSubviewRouter *)subviewRouter addControlledSubview:viewCopy zIndex:_glassGroupZIndex orderMode:1];
  }

  return _glassGroupZIndex != 0x7FFFFFFFFFFFFFFFLL;
}

- (void)_setPocketRelativeSubview:(id)subview isOver:(BOOL)over forKey:(id)key
{
  overCopy = over;
  subviewCopy = subview;
  keyCopy = key;
  if (!subviewCopy || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    [(UIScrollView *)&v10 _setPocketRelativeSubview:subviewCopy isOver:overCopy forKey:keyCopy];
  }
}

- (void)_addSubview:(id)subview positioned:(int64_t)positioned relativeTo:(id)to
{
  subviewCopy = subview;
  positionedCopy = positioned;
  toCopy = to;
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  if (subviewRouter)
  {
    v11 = subviewRouter;
    v12 = [(_UICollectionViewSubviewRouter *)subviewRouter shouldAddSubview:subviewCopy atPosition:&positionedCopy relativeTo:toCopy creatingBookmarkIfNecessary:1];

    if (v12)
    {
      v13.receiver = self;
      v13.super_class = UICollectionView;
      [(UIView *)&v13 _addSubview:subviewCopy positioned:positionedCopy relativeTo:toCopy];
    }
  }
}

- (void)bringSubviewToFront:(id)front
{
  frontCopy = front;
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v6 = [(_UICollectionViewSubviewRouter *)subviewRouter shouldBringSubviewToFront:frontCopy];

  if (v6)
  {
    v7.receiver = self;
    v7.super_class = UICollectionView;
    [(UIView *)&v7 bringSubviewToFront:frontCopy];
  }
}

- (void)sendSubviewToBack:(id)back
{
  backCopy = back;
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  if (subviewRouter)
  {
    v6 = subviewRouter;
    v9 = 0;
    v7 = [(_UICollectionViewSubviewRouter *)subviewRouter shouldAddSubview:backCopy atPosition:&v9 relativeTo:0 creatingBookmarkIfNecessary:0];

    if (v7)
    {
      v8.receiver = self;
      v8.super_class = UICollectionView;
      [(UIView *)&v8 sendSubviewToBack:backCopy];
    }
  }
}

- (void)exchangeSubviewAtIndex:(int64_t)index withSubviewAtIndex:(int64_t)atIndex
{
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v8 = [(_UICollectionViewSubviewRouter *)subviewRouter shouldExchangeSubviewAtIndex:index withSubviewAtIndex:atIndex];

  if (v8)
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIView *)&v9 exchangeSubviewAtIndex:index withSubviewAtIndex:atIndex];
  }
}

- (void)_willRemoveSubview:(id)subview
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  subviewCopy = subview;
  [(UIView *)&v6 _willRemoveSubview:subviewCopy];
  subviewRouter = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  [(_UICollectionViewSubviewRouter *)subviewRouter willRemoveSubview:subviewCopy];
}

- (id)_sectionContainerViewForSectionIndex:(int64_t)index createIfNecessary:(BOOL)necessary
{
  necessaryCopy = necessary;
  v7 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:?];
  v8 = v7;
  if (v7 && *(v7 + 8) == 1)
  {
    v20 = 0;
    v21 = &v20;
    v22 = 0x3032000000;
    v23 = __Block_byref_object_copy__39;
    v24 = __Block_byref_object_dispose__39;
    sectionToContainerViewMap = self->_sectionToContainerViewMap;
    v10 = [MEMORY[0x1E696AD98] numberWithInteger:index];
    v25 = [(NSMutableDictionary *)sectionToContainerViewMap objectForKeyedSubscript:v10];

    v11 = v21[5];
    if (v11)
    {
      v12 = 1;
    }

    else
    {
      v12 = !necessaryCopy;
    }

    if (!v12)
    {
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __75__UICollectionView__sectionContainerViewForSectionIndex_createIfNecessary___block_invoke;
      v15[3] = &unk_1E70FED68;
      v18 = &v20;
      v16 = v8;
      selfCopy = self;
      indexCopy = index;
      [UIView performWithoutAnimation:v15];

      v11 = v21[5];
    }

    v13 = v11;
    _Block_object_dispose(&v20, 8);
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

void __75__UICollectionView__sectionContainerViewForSectionIndex_createIfNecessary___block_invoke(uint64_t a1)
{
  v2 = [_UICollectionSectionContainerView alloc];
  v3 = *(a1 + 32);
  v4 = 0.0;
  v5 = 0.0;
  v6 = 0.0;
  v7 = 0.0;
  v8 = 0.0;
  if (v3)
  {
    v8 = v3[30];
    v5 = v3[31];
    v6 = v3[32];
    v7 = v3[33];
  }

  v9 = [(_UICollectionSectionContainerView *)v2 initWithFrame:v8, v5, v6, v7];
  v10 = *(*(a1 + 48) + 8);
  v11 = *(v10 + 40);
  *(v10 + 40) = v9;

  [*(*(*(a1 + 48) + 8) + 40) frame];
  [*(*(*(a1 + 48) + 8) + 40) setBounds:?];
  v12 = *(a1 + 32);
  if (v12)
  {
    v4 = *(v12 + 48);
  }

  v13 = [*(*(*(a1 + 48) + 8) + 40) layer];
  [v13 setCornerRadius:v4];

  v14 = *(*(*(a1 + 48) + 8) + 40);
  v15 = *(*(a1 + 40) + 3120);
  v16 = [MEMORY[0x1E696AD98] numberWithInteger:*(a1 + 56)];
  [v15 setObject:v14 forKeyedSubscript:v16];

  v17 = [(UICollectionView *)*(a1 + 40) subviewRouter];
  [(_UICollectionViewSubviewRouter *)v17 addContainerView:?];
}

- (void)_reconfigureSectionContainersForUpdate:(id)update
{
  updateCopy = update;
  v5 = self->_sectionToContainerViewMap;
  _customContainerSectionIndexes = [(UICollectionViewLayout *)self->_layout _customContainerSectionIndexes];
  if ([_customContainerSectionIndexes count] || -[NSMutableDictionary count](v5, "count"))
  {
    v7 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:{objc_msgSend(_customContainerSectionIndexes, "count")}];
    v11[0] = MEMORY[0x1E69E9820];
    v11[1] = 3221225472;
    v11[2] = __59__UICollectionView__reconfigureSectionContainersForUpdate___block_invoke;
    v11[3] = &unk_1E70FED90;
    v12 = updateCopy;
    v13 = _customContainerSectionIndexes;
    v8 = v7;
    v14 = v8;
    selfCopy = self;
    [(NSMutableDictionary *)v5 enumerateKeysAndObjectsUsingBlock:v11];
    sectionToContainerViewMap = self->_sectionToContainerViewMap;
    self->_sectionToContainerViewMap = v8;
    v10 = v8;
  }
}

void __59__UICollectionView__reconfigureSectionContainersForUpdate___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v14 = a2;
  v5 = a3;
  v6 = *(a1 + 32);
  v7 = [v14 integerValue];
  if (v6)
  {
    v7 = [v6 finalSectionIndexForInitialSectionIndex:v7];
  }

  if (v7 == 0x7FFFFFFFFFFFFFFFLL || ![*(a1 + 40) containsIndex:v7])
  {
    v10 = *(*(a1 + 56) + 3128);
    if (v10)
    {
      [v10 addObject:v5];
    }

    else
    {
      v11 = [MEMORY[0x1E695DF70] arrayWithObject:v5];
      v12 = *(a1 + 56);
      v13 = *(v12 + 3128);
      *(v12 + 3128) = v11;
    }
  }

  else
  {
    v8 = *(a1 + 48);
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:v7];
    [v8 setObject:v5 forKeyedSubscript:v9];
  }
}

void __48__UICollectionView__layoutSectionContainerViews__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v11 = a3;
  v5 = [*(*(a1 + 32) + 2152) _sectionDescriptorForSectionIndex:{objc_msgSend(a2, "integerValue")}];
  v6 = v5;
  if (v5)
  {
    [v11 setFrame:{v5[30], v5[31], v5[32], v5[33]}];
    [v11 frame];
    [v11 setBounds:?];
    v7 = v6[6];
    v8 = [v11 layer];
    [v8 setCornerRadius:v7];

    v9 = *MEMORY[0x1E69796E8];
    v10 = [v11 layer];
    [v10 setCornerCurve:v9];

    [v11 setClipsToBounds:*(v6 + 8)];
  }
}

- (void)setSemanticContentAttribute:(int64_t)attribute
{
  semanticContentAttribute = [(UIView *)self semanticContentAttribute];
  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIView *)&v20 setSemanticContentAttribute:attribute];
  if (semanticContentAttribute != attribute)
  {
    subviewManager = self->_subviewManager;
    v19[0] = MEMORY[0x1E69E9820];
    v19[1] = 3221225472;
    v19[2] = __48__UICollectionView_setSemanticContentAttribute___block_invoke;
    v19[3] = &__block_descriptor_40_e70_v48__0Q8__NSIndexPath_16__NSString_24__UICollectionReusableView_32_B40l;
    v19[4] = attribute;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v19];
    }

    v7 = self->_layout;
    selfCopy = self;
    v9 = selfCopy;
    if (v7)
    {
      effectiveUserInterfaceLayoutDirection = [(UIView *)selfCopy effectiveUserInterfaceLayoutDirection];
      if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v7 developmentLayoutDirection])
      {
        if (![(UIView *)v9 _flipsHorizontalAxis])
        {
          goto LABEL_10;
        }

        _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
      }

      else
      {
        _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v7 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [(UIScrollView *)v9 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
    }

LABEL_10:

    backgroundView = v9->_backgroundView;
    v13 = self->_layout;
    v14 = backgroundView;
    v15 = v14;
    if (v13)
    {
      v16 = v14 == 0;
    }

    else
    {
      v16 = 1;
    }

    if (v16)
    {
      goto LABEL_19;
    }

    effectiveUserInterfaceLayoutDirection2 = [(UIView *)v14 effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection2 == [(UICollectionViewLayout *)v13 developmentLayoutDirection])
    {
      if (![(UIView *)v15 _flipsHorizontalAxis])
      {
LABEL_19:

        [(UICollectionView *)v9 reloadData];
        return;
      }

      _wantsRightToLeftHorizontalMirroringIfNeeded2 = 0;
    }

    else
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded2 = [(UICollectionViewLayout *)v13 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v15 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded2];
    goto LABEL_19;
  }
}

- (void)setBounds:(CGRect)bounds
{
  height = bounds.size.height;
  width = bounds.size.width;
  y = bounds.origin.y;
  x = bounds.origin.x;
  v41 = *MEMORY[0x1E69E9840];
  [(UIView *)self bounds];
  v8 = v42.origin.x;
  v9 = v42.origin.y;
  v10 = v42.size.width;
  v11 = v42.size.height;
  v47.origin.x = x;
  v47.origin.y = y;
  v47.size.width = width;
  v47.size.height = height;
  if (CGRectEqualToRect(v42, v47))
  {
    return;
  }

  if ((*(&self->_collectionViewFlags + 11) & 0x20) != 0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492338);
    if (*CategoryCachedImpl)
    {
      v24 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        v25 = v24;
        v43.origin.x = v8;
        v43.origin.y = v9;
        v43.size.width = v10;
        v43.size.height = v11;
        v26 = NSStringFromCGRect(v43);
        v44.origin.x = x;
        v44.origin.y = y;
        v44.size.width = width;
        v44.size.height = height;
        v27 = NSStringFromCGRect(v44);
        *buf = 134218498;
        selfCopy2 = self;
        v37 = 2112;
        v38 = v26;
        v39 = 2112;
        v40 = v27;
        _os_log_impl(&dword_188A29000, v25, OS_LOG_TYPE_ERROR, "setBounds: cv == %p; oldBounds == %@; newBounds == %@", buf, 0x20u);
      }
    }

    v34.receiver = self;
    v34.super_class = UICollectionView;
    [(UIScrollView *)&v34 setBounds:x, y, width, height];
    goto LABEL_34;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    v14 = 0;
    if (!dyld_program_sdk_at_least())
    {
      v16 = 0;
      v17 = 0;
      goto LABEL_16;
    }

LABEL_6:
    if ([(UICollectionViewLayout *)self->_layout _preparedForBoundsChanges]|| (v14 & 1) != 0)
    {
      goto LABEL_12;
    }

LABEL_14:
    v16 = 0;
    v14 = 0;
    v17 = 0;
    goto LABEL_16;
  }

  collectionViewDataFlags = collectionViewData->_collectionViewDataFlags;
  if (dyld_program_sdk_at_least())
  {
    v14 = (*&collectionViewDataFlags >> 3) & 1;
    goto LABEL_6;
  }

  if ((*&collectionViewDataFlags & 8) == 0)
  {
    goto LABEL_14;
  }

LABEL_12:
  if ([(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:x, y, width, height])
  {
    v16 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:x fromOldBounds:y, width, height, v8, v9, v10, v11];
    v14 = 1;
    v17 = 1;
  }

  else
  {
    v16 = 0;
    v17 = 0;
    v14 = 1;
  }

LABEL_16:
  if ((*(&self->_collectionViewFlags + 13) & 1) == 0)
  {
    self->_preRotationBounds.origin.x = v8;
    self->_preRotationBounds.origin.y = v9;
    self->_preRotationBounds.size.width = v10;
    self->_preRotationBounds.size.height = v11;
    *(&self->_collectionViewFlags + 1) |= 0x10000000000uLL;
  }

  if ((*(&self->_collectionViewFlags + 18) & 8) == 0)
  {
    if (![(UIScrollView *)self isScrollAnimating])
    {
      [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    }

    [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  }

  debugger = self->_debugger;
  if (debugger)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewRectPropertyChange:@"bounds" fromRect:v8 toRect:v9, v10, v11, x, y, width, height];
  }

  v33.receiver = self;
  v33.super_class = UICollectionView;
  [(UIScrollView *)&v33 setBounds:x, y, width, height];
  if (v17)
  {
    v19 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492340);
    if (*v19)
    {
      v28 = *(v19 + 8);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
      {
        v29 = v28;
        v45.origin.x = v8;
        v45.origin.y = v9;
        v45.size.width = v10;
        v45.size.height = v11;
        NSStringFromCGRect(v45);
        v30 = v32 = v14;
        v46.origin.x = x;
        v46.origin.y = y;
        v46.size.width = width;
        v46.size.height = height;
        v31 = NSStringFromCGRect(v46);
        *buf = 134218498;
        selfCopy2 = self;
        v37 = 2112;
        v38 = v30;
        v39 = 2112;
        v40 = v31;
        _os_log_impl(&dword_188A29000, v29, OS_LOG_TYPE_ERROR, "setBounds: cv == %p; invalidating for oldBounds == %@; newBounds == %@", buf, 0x20u);

        v14 = v32;
      }
    }

    [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v16];
    if (v14)
    {
      _invalidatedSupplementaryViews = [v16 _invalidatedSupplementaryViews];
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:_invalidatedSupplementaryViews == 0];

      activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
      self->_activeOrthogonalPrefetchingContext = 0;

LABEL_29:
      if (v10 != width || v11 != height)
      {
        [(UICollectionView *)self _updateDefaultLayoutMargins];
      }

      goto LABEL_33;
    }

    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    v23 = self->_activeOrthogonalPrefetchingContext;
    self->_activeOrthogonalPrefetchingContext = 0;
  }

  else
  {
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v14 ^ 1u];
    v22 = self->_activeOrthogonalPrefetchingContext;
    self->_activeOrthogonalPrefetchingContext = 0;

    if (((v14 ^ 1) & 1) == 0)
    {
      goto LABEL_29;
    }
  }

LABEL_33:

LABEL_34:
  if (v10 != width || v11 != height)
  {
    [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  }
}

- (void)setFrame:(CGRect)frame
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  v62 = *MEMORY[0x1E69E9840];
  [(UIView *)self frame];
  v71.origin.x = v8;
  v71.origin.y = v9;
  v71.size.width = v10;
  v71.size.height = v11;
  v63.origin.x = x;
  v63.origin.y = y;
  v63.size.width = width;
  v63.size.height = height;
  if (CGRectEqualToRect(v63, v71))
  {
    return;
  }

  [(UIView *)self frame];
  v49 = v13;
  v50 = v12;
  v51 = v14;
  v52 = v15;
  [(UIView *)self bounds];
  v16 = v64.origin.x;
  v17 = v64.origin.y;
  v19 = v18;
  v21 = v20;
  v64.size.width = width;
  v64.size.height = height;
  v72.origin.x = v64.origin.x;
  v72.origin.y = v64.origin.y;
  v72.size.width = v19;
  v72.size.height = v21;
  v22 = CGRectEqualToRect(v64, v72);
  collectionViewData = self->_collectionViewData;
  if (collectionViewData)
  {
    LODWORD(v24) = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
  }

  else
  {
    LODWORD(v24) = 0;
  }

  if (dyld_program_sdk_at_least())
  {
    LODWORD(v24) = [(UICollectionViewLayout *)self->_layout _preparedForBoundsChanges]| v24;
  }

  v25 = v24 ^ 1;
  if (((v24 ^ 1 | v22) & 1) != 0 || ![(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:v16, v17, width, height])
  {
    v26 = 0;
    v27 = 0;
  }

  else
  {
    v26 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:v16 fromOldBounds:v17, width, height, v16, v17, v19, v21];
    v27 = 1;
  }

  if ((*(&self->_collectionViewFlags + 13) & 1) == 0)
  {
    self->_preRotationBounds.origin.x = v16;
    self->_preRotationBounds.origin.y = v17;
    self->_preRotationBounds.size.width = v19;
    self->_preRotationBounds.size.height = v21;
    *(&self->_collectionViewFlags + 1) |= 0x10000000000uLL;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &setFrame____s_category);
  if (*CategoryCachedImpl)
  {
    v42 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
      v43 = v42;
      [(UIView *)self frame];
      NSStringFromCGRect(v69);
      v47 = v24 ^ 1;
      v24 = v48 = v24;
      v70.origin.x = x;
      v70.origin.y = y;
      v70.size.width = width;
      v70.size.height = height;
      v44 = NSStringFromCGRect(v70);
      v45 = v44;
      v46 = @"NO";
      *buf = 134218754;
      selfCopy = self;
      if (v27)
      {
        v46 = @"YES";
      }

      v56 = 2112;
      v57 = v24;
      v58 = 2112;
      v59 = v44;
      v60 = 2112;
      v61 = v46;
      _os_log_impl(&dword_188A29000, v43, OS_LOG_TYPE_ERROR, "setFrame: cv == %p; oldFrame == %@; newFrame == %@ invalidateLayout == %@", buf, 0x2Au);

      v25 = v47;
      LOBYTE(v24) = v48;
    }
  }

  debugger = self->_debugger;
  v30 = v51;
  if (debugger)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewRectPropertyChange:@"frame" fromRect:v50 toRect:v49, v51, v52, x, y, width, height];
  }

  v53.receiver = self;
  v53.super_class = UICollectionView;
  [(UIScrollView *)&v53 setFrame:x, y, width, height];
  if (!v22)
  {
    if (v27)
    {
      v31 = self->_collectionViewData;
      if (v31)
      {
        v32 = v31->_contentSize.width;
        v33 = v31->_contentSize.height;
      }

      else
      {
        v32 = 0.0;
        v33 = 0.0;
      }

      [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v26];
      if ((dyld_program_sdk_at_least() & 1) == 0)
      {
        collectionViewContentRect = [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
      }

      if ((*(&self->_collectionViewFlags + 11) & 0x40) == 0 && ![(UIScrollView *)self isTracking]&& ![(UICollectionViewLayout *)self->_layout _estimatesSizes])
      {
        v65.origin.x = x;
        v65.origin.y = y;
        v65.size.width = width;
        v65.size.height = height;
        if (!CGRectIsEmpty(v65))
        {
          v66.origin.y = v49;
          v66.origin.x = v50;
          v66.size.width = v51;
          v66.size.height = v52;
          if (!CGRectIsEmpty(v66))
          {
            [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
            [(UICollectionView *)self _contentOffsetForNewFrame:x oldFrame:y newContentSize:width andOldContentSize:height, v50, v49, v51, v52, v35, v36, *&v32, *&v33];
            [(UICollectionView *)self setContentOffset:?];
          }
        }
      }

      [(UIView *)self bounds];
      MinX = CGRectGetMinX(v67);
      v38 = MinX - CGRectGetMinX(self->_preRotationBounds);
      [(UIView *)self bounds];
      MinY = CGRectGetMinY(v68);
      v40 = MinY - CGRectGetMinY(self->_preRotationBounds);
      self->_rotationBoundsOffset.x = v38;
      self->_rotationBoundsOffset.y = v40;
      if ((v24 & 1) == 0)
      {
        [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v25 & 1];
        v30 = v51;
        goto LABEL_16;
      }

      _invalidatedSupplementaryViews = [v26 _invalidatedSupplementaryViews];
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:_invalidatedSupplementaryViews == 0];

      v30 = v51;
    }

    else
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v25 & 1];
      if ((v24 & 1) == 0)
      {
        goto LABEL_16;
      }
    }

    if (v19 != width || v21 != height)
    {
      [(UICollectionView *)self _updateDefaultLayoutMargins];
    }
  }

LABEL_16:
  if ((v30 != width || v52 != height) && (*(&self->_collectionViewFlags + 13) & 0x80) != 0)
  {
    [(UICollectionView *)self _scrollFirstResponderCellToVisible:+[UIView _isInAnimationBlock]^ 1];
  }
}

- (double)_alignedContentMarginGivenMargin:(double)margin
{
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  [collectionViewLayout _alignedContentMarginGivenMargin:margin];
  v6 = v5;

  return v6;
}

- (void)_setDefaultLayoutMargins:(UIEdgeInsets)margins fromViewController:(BOOL)controller
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v5 = *(&self->_collectionViewFlags + 1);
  if ((v5 & 0x40000000000000) == 0 || controller)
  {
    v6.f64[0] = margins.top;
    v6.f64[1] = margins.left;
    v7.f64[0] = margins.bottom;
    v7.f64[1] = margins.right;
    if ((vminv_u16(vmovn_s32(vuzp1q_s32(vceqq_f64(v6, *&self->_defaultLayoutMargins.top), vceqq_f64(v7, *&self->_defaultLayoutMargins.bottom)))) & 1) == 0)
    {
      v8 = 0x40000000000000;
      if (!controller)
      {
        v8 = 0;
      }

      *(&self->_collectionViewFlags + 1) = v5 & 0xFFBFFFFFFFFFFFFFLL | v8;
      self->_defaultLayoutMargins = margins;
      v9 = *(&self->_collectionViewFlags + 1);
      if ((v9 & 0x10000000000000) == 0)
      {
        *(&self->_collectionViewFlags + 1) = v9 | 0x20000000000000;
        [(UICollectionView *)self setLayoutMargins:?];
        *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFDFFFFFFFFFFFFFLL | (((v9 >> 53) & 1) << 53);
      }
    }
  }
}

- (void)setLayoutMargins:(UIEdgeInsets)margins
{
  right = margins.right;
  bottom = margins.bottom;
  left = margins.left;
  top = margins.top;
  [(UIView *)self layoutMargins];
  [(UIView *)self _rawLayoutMargins];
  if (left != v11 || top != v8 || right != v10 || bottom != v9)
  {
    *(&self->_collectionViewFlags + 1) |= ~(*(&self->_collectionViewFlags + 1) >> 1) & 0x10000000000000;
    v15.receiver = self;
    v15.super_class = UICollectionView;
    [(UIView *)&v15 setLayoutMargins:top, left, bottom, right];
  }
}

- (void)_layoutMarginsDidChangeFromOldMargins:(UIEdgeInsets)margins
{
  right = margins.right;
  bottom = margins.bottom;
  left = margins.left;
  top = margins.top;
  v17.receiver = self;
  v17.super_class = UICollectionView;
  [(UIView *)&v17 _layoutMarginsDidChangeFromOldMargins:?];
  [(UIView *)self layoutMargins];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  if ([UICollectionViewLayout _shouldInvalidateLayoutForUpdatedLayoutMargins:"_shouldInvalidateLayoutForUpdatedLayoutMargins:fromOldMargins:" fromOldMargins:?])
  {
    debugger = self->_debugger;
    if (debugger)
    {
      [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewInsetsPropertyChange:@"layoutMargins" fromInsets:top toInsets:left, bottom, right, v9, v11, v13, v15];
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (void)_safeAreaInsetsDidChangeFromOldInsets:(UIEdgeInsets)insets
{
  right = insets.right;
  bottom = insets.bottom;
  left = insets.left;
  top = insets.top;
  v17.receiver = self;
  v17.super_class = UICollectionView;
  [(UIView *)&v17 _safeAreaInsetsDidChangeFromOldInsets:?];
  [(UIView *)self safeAreaInsets];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  if ([UICollectionViewLayout _shouldInvalidateLayoutForUpdatedSafeAreaInsets:"_shouldInvalidateLayoutForUpdatedSafeAreaInsets:fromOldInsets:" fromOldInsets:?])
  {
    debugger = self->_debugger;
    if (debugger)
    {
      [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewInsetsPropertyChange:@"safeAreaInsets" fromInsets:top toInsets:left, bottom, right, v9, v11, v13, v15];
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (void)setDirectionalLayoutMargins:(NSDirectionalEdgeInsets)margins
{
  trailing = margins.trailing;
  bottom = margins.bottom;
  leading = margins.leading;
  top = margins.top;
  [(UIView *)self _rawLayoutMargins];
  v12 = *(&self->super.super._viewFlags + 2);
  if ((v12 & 0x400000) != 0)
  {
    v13 = v11;
  }

  else
  {
    v13 = v9;
  }

  if ((v12 & 0x400000) == 0)
  {
    v9 = v11;
  }

  if (leading != v13 || top != v8 || trailing != v9 || bottom != v10)
  {
    *(&self->_collectionViewFlags + 1) |= ~(*(&self->_collectionViewFlags + 1) >> 1) & 0x10000000000000;
    v17.receiver = self;
    v17.super_class = UICollectionView;
    [(UIView *)&v17 setDirectionalLayoutMargins:top, leading, bottom, trailing];
  }
}

- (void)setAlwaysBounceVertical:(BOOL)vertical
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setAlwaysBounceVertical:vertical];
}

- (void)setAlwaysBounceHorizontal:(BOOL)horizontal
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setAlwaysBounceHorizontal:horizontal];
}

- (void)_setDefaultAlwaysBounceVertical:(BOOL)vertical horizontal:(BOOL)horizontal
{
  if ((*(&self->_collectionViewFlags + 14) & 8) == 0)
  {
    horizontalCopy = horizontal;
    v7.receiver = self;
    v7.super_class = UICollectionView;
    [(UIScrollView *)&v7 setAlwaysBounceVertical:vertical];
    v6.receiver = self;
    v6.super_class = UICollectionView;
    [(UIScrollView *)&v6 setAlwaysBounceHorizontal:horizontalCopy];
  }
}

- (void)setScrollEnabled:(BOOL)enabled
{
  enabledCopy = enabled;
  isScrollEnabled = [(UIScrollView *)self isScrollEnabled];
  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 setScrollEnabled:enabledCopy];
  if (isScrollEnabled != enabledCopy)
  {
    [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
  }
}

- (void)_didMoveFromWindow:(id)window toWindow:(id)toWindow
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 _didMoveFromWindow:window toWindow:toWindow];
  v5 = +[_UIHDRUsageCoordinator sharedInstance];
  [(_UIHDRUsageCoordinator *)v5 applyConstrainedHDROverrideToView:?];

  [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
}

- (void)_didMoveFromSuperview:(id)superview
{
  v4.receiver = self;
  v4.super_class = UICollectionView;
  [(UIView *)&v4 _didMoveFromSuperview:superview];
  [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
}

- (void)_geometryChanged:(id *)changed forAncestor:(id)ancestor
{
  ancestorCopy = ancestor;
  if (ancestorCopy && [(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
    v8 = _UITreeFirstCommonAncestor(ancestorCopy, WeakRetained, sel_superview);

    if (v8)
    {
      var0 = changed->var0;
      if (WeakRetained == ancestorCopy)
      {
        if ((var0 & 0xC) != 0)
        {
          [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
        }
      }

      else
      {
        if ((var0 & 6) != 0)
        {
          [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
          var0 = changed->var0;
        }

        if ((var0 & 0x10) != 0)
        {
          [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
        }
      }
    }
  }

  v10.receiver = self;
  v10.super_class = UICollectionView;
  [(UIScrollView *)&v10 _geometryChanged:changed forAncestor:ancestorCopy];
}

- (void)_setShouldDeriveVisibleBoundsFromContainingScrollView:(BOOL)view
{
  v3 = *(&self->_collectionViewFlags + 1);
  if (((((v3 & 0x2000000000000) == 0) ^ view) & 1) == 0)
  {
    v4 = 0x2000000000000;
    if (!view)
    {
      v4 = 0;
    }

    *(&self->_collectionViewFlags + 1) = v3 & 0xFFFDFFFFFFFFFFFFLL | v4;
    [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
  }
}

- (CGRect)_effectiveVisibleBoundsForBounds:(CGRect)bounds
{
  top = self->_visibleRectInsets.top;
  left = self->_visibleRectInsets.left;
  v5 = bounds.origin.x + left;
  v6 = bounds.origin.y + top;
  v7 = bounds.size.width - (left + self->_visibleRectInsets.right);
  v8 = bounds.size.height - (top + self->_visibleRectInsets.bottom);
  result.size.height = v8;
  result.size.width = v7;
  result.origin.y = v6;
  result.origin.x = v5;
  return result;
}

- (BOOL)_checkForPreferredAttributesInView:(id)view originalAttributes:(id)attributes
{
  if (!-[UICollectionView __hasTransitionLayoutAttributes](self, "__hasTransitionLayoutAttributes") && ([view _arePreferredAttributesValid] & 1) == 0)
  {
    v8 = _UISetCurrentFallbackEnvironment(self);
    v9 = [attributes copy];
    if (v9)
    {
      p_layout = &self->_layout;
      _estimatesSizes = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
      v12 = v9[288] & 1;
      if (_estimatesSizes)
      {
LABEL_5:
        [(UICollectionViewLayout *)*p_layout _prepareForPreferredAttributesQueryForView:view withLayoutAttributes:v9];
        v13 = 1;
        goto LABEL_7;
      }

      v13 = 0;
    }

    else
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      _layoutAttributes = [view _layoutAttributes];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3563 description:{@"UICollectionView internal inconsistency: missing original layout attributes necessary to update preferred attributes for view: %@. Attributes from view: %@; collection view: %@", view, _layoutAttributes, self}];

      p_layout = &self->_layout;
      v12 = 0;
      v13 = 0;
      if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
      {
        goto LABEL_5;
      }
    }

LABEL_7:
    currentUpdate = self->_currentUpdate;
    if (currentUpdate && (*&currentUpdate->_flags & 2) != 0 || +[UIView _isInAnimationBlockWithAnimationsEnabled])
    {
      v15 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleViewWithLayoutAttributes:attributes];
      v16 = v15 == view;
    }

    else
    {
      v16 = 0;
    }

    v17 = [view _preferredLayoutAttributesFittingAttributes:v9 isAnimatingExistingView:v16];
    if (v13)
    {
      [(UICollectionViewLayout *)*p_layout _postProcessPreferredAttributes:v17 forView:view];
    }

    intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
    if (intrinsicContentSizeInvalidationContext)
    {
      if (!v12)
      {
        if (!v17 || (*(v17 + 288) & 3) != 0)
        {
          goto LABEL_24;
        }

        _content = [(_UILabelConfiguration *)v17 _content];
        indexPath = [v17 indexPath];
        [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext _removeInvalidatedSupplementaryOfKind:_content indexPath:indexPath];
        goto LABEL_21;
      }

      indexPath2 = [v17 indexPath];
      [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext _removeInvalidatedItemIndexPath:indexPath2];
    }

    else if (!v12)
    {
      goto LABEL_24;
    }

    indexPath = [v17 indexPath];
    if ([(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes count])
    {
      [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes removeObject:indexPath];
    }

    _content = indexPath;
LABEL_21:

LABEL_24:
    if (!-[UICollectionViewLayout _wantsInvalidateLayoutForPreferredLayoutAttributes](*p_layout, "_wantsInvalidateLayoutForPreferredLayoutAttributes") && ([v17 isSizeEqualForPreferredFittingAttributes:attributes] & 1) != 0 || !-[UICollectionViewLayout shouldInvalidateLayoutForPreferredLayoutAttributes:withOriginalAttributes:](*p_layout, "shouldInvalidateLayoutForPreferredLayoutAttributes:withOriginalAttributes:", v17, attributes))
    {
      goto LABEL_36;
    }

    v22 = [(UICollectionViewLayout *)*p_layout invalidationContextForPreferredLayoutAttributes:v17 withOriginalAttributes:attributes];
    v23 = v22;
    if (!v13)
    {
      goto LABEL_32;
    }

    invalidatedItemIndexPaths = [v22 invalidatedItemIndexPaths];
    if (![invalidatedItemIndexPaths count])
    {
      invalidatedSupplementaryIndexPaths = [v23 invalidatedSupplementaryIndexPaths];
      if (![invalidatedSupplementaryIndexPaths count])
      {
        invalidatedDecorationIndexPaths = [v23 invalidatedDecorationIndexPaths];
        v28 = [invalidatedDecorationIndexPaths count];

        if (!v28 && (*(&self->_collectionViewFlags + 9) & 4) == 0)
        {
LABEL_35:

LABEL_36:
          _UIRestorePreviousFallbackEnvironment(v8);

          return 0;
        }

LABEL_32:
        if (![v23 _intent])
        {
          [v23 _setIntent:5];
        }

        [(UICollectionViewLayout *)*p_layout invalidateLayoutWithContext:v23];
        goto LABEL_35;
      }
    }

    goto LABEL_32;
  }

  return 0;
}

- (BOOL)_hasFocusedCellForIndexPath:(id)path shouldUsePreUpdateData:(BOOL)data
{
  dataCopy = data;
  pathCopy = path;
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  if (dataCopy)
  {
    currentUpdate = self->_currentUpdate;
    if (currentUpdate)
    {
      v9 = currentUpdate->_oldFocusedItemState;

      _focusedItemState = v9;
    }
  }

  if (_focusedItemState)
  {
    v10 = *(_focusedItemState + 8);
    if (v10 && !*(_focusedItemState + 32))
    {
      v12 = *(_focusedItemState + 16);
      v11 = [pathCopy isEqual:v12];
    }

    else
    {
      v11 = 0;
    }
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (void)setPrefetchingEnabled:(BOOL)prefetchingEnabled
{
  if ((*(&self->_collectionViewFlags + 4) & 1) != prefetchingEnabled)
  {
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFE | prefetchingEnabled;
    if (!prefetchingEnabled)
    {
      [(UICollectionView *)self _resetPrefetchState];
    }
  }
}

- (void)_setShouldPrefetchCellsWhenPerformingReloadData:(BOOL)data
{
  v3 = 0x80000000000000;
  if (!data)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFF7FFFFFFFFFFFFFLL | v3;
}

- (id)_prefetchingContextForOrthogonalScrollingSection:(int64_t)section
{
  _orthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _orthogonalScrollingSections];
  v6 = [_orthogonalScrollingSections containsIndex:section];

  if (v6)
  {
    orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:section];
    v9 = [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts objectForKeyedSubscript:v8];
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (void)_setPrefetchingContext:(id)context forOrthogonalScrollingSection:(int64_t)section
{
  contextCopy = context;
  _orthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _orthogonalScrollingSections];
  v7 = [_orthogonalScrollingSections containsIndex:section];

  if (v7)
  {
    orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:section];
    [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts setObject:contextCopy forKeyedSubscript:v9];
  }
}

- (void)_notifyWillDisplayCellIfNeeded:(id)needed forIndexPath:(id)path
{
  neededCopy = needed;
  pathCopy = path;
  if (([neededCopy _hasNotifiedIsDisplaying] & 1) == 0)
  {
    if (*(&self->_collectionViewFlags + 1))
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      [_delegateProxy collectionView:self willDisplayCell:neededCopy forItemAtIndexPath:pathCopy];
    }

    [neededCopy _notifyIsDisplaying:1];
  }
}

- (void)_notifyDidEndDisplayingCellIfNeeded:(id)needed forIndexPath:(id)path
{
  v13 = *MEMORY[0x1E69E9840];
  neededCopy = needed;
  pathCopy = path;
  if ([neededCopy _hasNotifiedIsDisplaying])
  {
    if (os_variant_has_internal_diagnostics())
    {
      if (!pathCopy)
      {
        v9 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v9, OS_LOG_TYPE_FAULT))
        {
          v11 = 138412290;
          v12 = neededCopy;
          _os_log_fault_impl(&dword_188A29000, v9, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", &v11, 0xCu);
        }
      }
    }

    else if (!pathCopy)
    {
      v10 = *(__UILogGetCategoryCachedImpl("Assert", &_notifyDidEndDisplayingCellIfNeeded_forIndexPath____s_category) + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        v11 = 138412290;
        v12 = neededCopy;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", &v11, 0xCu);
      }
    }

    [neededCopy _notifyIsDisplaying:0];
    if ((*(&self->_collectionViewFlags + 1) & 4) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      [_delegateProxy collectionView:self didEndDisplayingCell:neededCopy forItemAtIndexPath:pathCopy];
    }
  }
}

- (void)_notifyWillDisplaySupplementaryView:(id)view forElementKind:(id)kind atIndexPath:(id)path
{
  viewCopy = view;
  kindCopy = kind;
  pathCopy = path;
  if (([viewCopy _hasNotifiedIsDisplaying] & 1) == 0)
  {
    if ((*(&self->_collectionViewFlags + 1) & 2) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      [_delegateProxy collectionView:self willDisplaySupplementaryView:viewCopy forElementKind:kindCopy atIndexPath:pathCopy];
    }

    [viewCopy _notifyIsDisplaying:1];
  }
}

- (void)_notifyDidEndDisplayingSupplementaryView:(id)view
{
  v19 = *MEMORY[0x1E69E9840];
  viewCopy = view;
  if ([viewCopy _hasNotifiedIsDisplaying])
  {
    [viewCopy _notifyIsDisplaying:0];
    if ((*(&self->_collectionViewFlags + 1) & 8) != 0)
    {
      _layoutAttributes = [viewCopy _layoutAttributes];
      _content = [(_UILabelConfiguration *)_layoutAttributes _content];
      indexPath = [_layoutAttributes indexPath];
      has_internal_diagnostics = os_variant_has_internal_diagnostics();
      if (_layoutAttributes)
      {
        v9 = _content == 0;
      }

      else
      {
        v9 = 1;
      }

      v11 = v9 || indexPath == 0;
      if (has_internal_diagnostics)
      {
        if (v11)
        {
          v13 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v13, OS_LOG_TYPE_FAULT))
          {
            v15 = 138412546;
            v16 = viewCopy;
            v17 = 2112;
            v18 = _layoutAttributes;
            _os_log_fault_impl(&dword_188A29000, v13, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: layout attributes are invalid for view %@: %@", &v15, 0x16u);
          }
        }
      }

      else if (v11)
      {
        v14 = *(__UILogGetCategoryCachedImpl("Assert", &_notifyDidEndDisplayingSupplementaryView____s_category) + 8);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          v15 = 138412546;
          v16 = viewCopy;
          v17 = 2112;
          v18 = _layoutAttributes;
          _os_log_impl(&dword_188A29000, v14, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: layout attributes are invalid for view %@: %@", &v15, 0x16u);
        }
      }

      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      [_delegateProxy collectionView:self didEndDisplayingSupplementaryView:viewCopy forElementOfKind:_content atIndexPath:indexPath];
    }
  }
}

- (id)_preparedCellForItemAtIndexPath:(id)path withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes isFocused:(BOOL)focused notify:(BOOL)notify
{
  notifyCopy = notify;
  focusedCopy = focused;
  applyAttributesCopy = applyAttributes;
  if (![(UICollectionView *)self _prefetchingAllowed])
  {
    goto LABEL_19;
  }

  v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:path];
  v14 = v13;
  if (v13)
  {
    v15 = *(v13 + 16);
    if (!v15)
    {
      v17 = 0;
      goto LABEL_17;
    }

    v16 = v15;
    if ((*(v15 + 288) & 1) == 0)
    {
      v17 = v15;
LABEL_17:

      goto LABEL_18;
    }

    v17 = v14[3];

    if (v17)
    {
      v18 = [(UICollectionView *)self _updatePrefetchItemIfNeeded:v14 forIndexPath:path withLayoutAttributes:attributes willDisplay:1];
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:path];
      if (!v18)
      {
        [(UICollectionView *)self _reusePrefetchedCell:v17];
        goto LABEL_17;
      }

      CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &_preparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify____s_category);
      v20 = *(CategoryCachedImpl + 8);
      if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v20))
      {
        *v23 = 134218240;
        *&v23[4] = [path section];
        *&v23[12] = 2048;
        *&v23[14] = [path item];
        _os_signpost_emit_unreliably_with_name_impl();
      }

      if ([v17 _isHiddenForReuse])
      {
        [v17 _setHiddenForReuse:0];
        if (!focusedCopy)
        {
LABEL_13:
          if (!notifyCopy)
          {
LABEL_15:

            goto LABEL_20;
          }

LABEL_14:
          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v17 forIndexPath:path, *v23, *&v23[16]];
          goto LABEL_15;
        }
      }

      else if (!focusedCopy)
      {
        goto LABEL_13;
      }

      v22 = [_UICollectionViewFocusedItemState stateWithReusableView:v17];
      [(UICollectionView *)self _setFocusedItemState:v22];

      if (!notifyCopy)
      {
        goto LABEL_15;
      }

      goto LABEL_14;
    }
  }

LABEL_18:

LABEL_19:
  v17 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:path withLayoutAttributes:attributes applyAttributes:applyAttributesCopy isFocused:focusedCopy notify:notifyCopy];
LABEL_20:

  return v17;
}

- (id)_createPreparedCellForItemAtIndexPath:(id)path withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes isFocused:(BOOL)focused notify:(BOOL)notify
{
  notifyCopy = notify;
  focusedCopy = focused;
  applyAttributesCopy = applyAttributes;
  v96 = *MEMORY[0x1E69E9840];
  context = objc_autoreleasePoolPush();
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained)
  {
    if (!attributes)
    {
LABEL_67:
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3875 description:{@"UICollectionView internal bug: Attempting to create a cell with invalid attributes. Collection View: %@, Attributes: %@, Index Path: %@", self, attributes, path}];

      goto LABEL_4;
    }
  }

  else
  {
    currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3874 description:@"UICollectionView dataSource is not set"];

    if (!attributes)
    {
      goto LABEL_67;
    }
  }

  if ((*(attributes + 288) & 1) == 0)
  {
    goto LABEL_67;
  }

LABEL_4:
  firstResponderIndexPath = self->_firstResponderIndexPath;
  if (firstResponderIndexPath && self->_firstResponderViewType == 1 && [(NSIndexPath *)firstResponderIndexPath isEqual:path])
  {
    [(UICollectionView *)self _configureCachedCellForDisplay:self->_firstResponderView withIndexPath:path layoutAttributesToUpdate:attributes];
    cell = self->_firstResponderView;
    goto LABEL_65;
  }

  if ([(UICollectionView *)self _hasFocusedCellForIndexPath:path shouldUsePreUpdateData:0])
  {
    _focusedItemState = [(UICollectionView *)self _focusedItemState];
    cell = [(_UICollectionViewFocusedItemState *)_focusedItemState cell];

    _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
    v18 = _focusedItemState2;
    if (_focusedItemState2)
    {
      v19 = *(_focusedItemState2 + 16);
    }

    else
    {
      v19 = 0;
    }

    v20 = v19;
    v21 = [path isEqual:v20];

    if ((v21 & 1) == 0)
    {
      currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
      _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
      v60 = _focusedItemState3;
      if (_focusedItemState3)
      {
        v61 = *(_focusedItemState3 + 16);
      }

      else
      {
        v61 = 0;
      }

      v62 = v61;
      [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3891 description:{@"Collection view focus state inconsistency. Focused index path %@ is not equal to index path of focused cell %@.", v62, path}];
    }

    [(UICollectionView *)self _configureCachedCellForDisplay:cell withIndexPath:path layoutAttributesToUpdate:attributes];
    if (notifyCopy)
    {
      [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:cell forIndexPath:path];
    }

    goto LABEL_65;
  }

  if (self->_cellBeingReconfigured)
  {
    currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3903 description:{@"Performing side effects on UICollectionView that cause a new cell to be requested while an existing item is being reconfigured is not allowed. Check the backtrace to see what's causing this. Collection view: %@", self}];
  }

  v22 = _UISetCurrentFallbackEnvironment(self);
  v23 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v23 | 4;
  v84 = 0;
  v85 = &v84;
  v86 = 0x3032000000;
  v87 = __Block_byref_object_copy__39;
  v88 = __Block_byref_object_dispose__39;
  v89 = 0;
  v73 = v22;
  v74 = v23;
  if (_isNotifyingIdleObservers == 1)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492348);
    v25 = *(CategoryCachedImpl + 8);
    if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v25))
    {
      section = [path section];
      item = [path item];
      *buf = 134218240;
      selfCopy2 = section;
      v92 = 2048;
      v93 = item;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v83[0] = MEMORY[0x1E69E9820];
    v83[1] = 3221225472;
    v83[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke;
    v83[3] = &unk_1E70FEE00;
    v83[4] = self;
    v83[5] = &v84;
    v83[6] = path;
    [UIView performWithoutAnimation:v83];
    v28 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492350);
    v29 = *(v28 + 8);
    if (os_signpost_id_make_with_pointer(*(v28 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v29))
    {
      _hasBeenReused = [v85[5] _hasBeenReused];
      *buf = 67109120;
      LODWORD(selfCopy2) = _hasBeenReused;
LABEL_29:
      _os_signpost_emit_unreliably_with_name_impl();
    }
  }

  else
  {
    v31 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492358);
    v32 = *(v31 + 8);
    if (os_signpost_id_make_with_pointer(*(v31 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v32))
    {
      section2 = [path section];
      item2 = [path item];
      *buf = 134218240;
      selfCopy2 = section2;
      v92 = 2048;
      v93 = item2;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v82[0] = MEMORY[0x1E69E9820];
    v82[1] = 3221225472;
    v82[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_400;
    v82[3] = &unk_1E70FEE00;
    v82[4] = self;
    v82[5] = &v84;
    v82[6] = path;
    [UIView performWithoutAnimation:v82];
    v35 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492360);
    v29 = *(v35 + 8);
    if (os_signpost_id_make_with_pointer(*(v35 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v29))
    {
      _hasBeenReused2 = [v85[5] _hasBeenReused];
      *buf = 67109120;
      LODWORD(selfCopy2) = _hasBeenReused2;
      goto LABEL_29;
    }
  }

  v37 = v85[5];
  if (!v37)
  {
    currentHandler5 = [MEMORY[0x1E696AAA8] currentHandler];
    _ui_shortDescription = [path _ui_shortDescription];
    [currentHandler5 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3923 description:{@"The collection view's data source returned nil when asked to provide a cell for an item. Collection view: %@; index path: %@", self, _ui_shortDescription}];

    v37 = v85[5];
  }

  reuseIdentifier = [v37 reuseIdentifier];
  v39 = reuseIdentifier == 0;

  if (v39)
  {
    currentHandler6 = [MEMORY[0x1E696AAA8] currentHandler];
    _ui_shortDescription2 = [path _ui_shortDescription];
    [currentHandler6 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3924 description:{@"The collection view's data source returned a cell without a reuseIdentifier. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, _ui_shortDescription2, v85[5]}];
  }

  if (([v85[5] _wasDequeued] & 1) == 0)
  {
    currentHandler7 = [MEMORY[0x1E696AAA8] currentHandler];
    _ui_shortDescription3 = [path _ui_shortDescription];
    [currentHandler7 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3925 description:{@"The collection view's data source returned a cell that was not dequeued from the collection view using a cell registration or reuse identifier. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, _ui_shortDescription3, v85[5]}];
  }

  superview = [v85[5] superview];
  if (!superview)
  {
    if (!dyld_program_sdk_at_least())
    {
      goto LABEL_39;
    }

    superview = [MEMORY[0x1E696AAA8] currentHandler];
    _ui_shortDescription4 = [path _ui_shortDescription];
    [superview handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3926 description:{@"The collection view's data source returned a cell that is not in the view hierarchy. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, _ui_shortDescription4, v85[5]}];
  }

LABEL_39:
  v41 = self->_subviewManager;
  if ([(_UICollectionViewSubviewManager *)v41 isViewInReuseQueue:?])
  {
    if (dyld_program_sdk_at_least())
    {
      currentHandler8 = [MEMORY[0x1E696AAA8] currentHandler];
      _ui_shortDescription5 = [path _ui_shortDescription];
      [currentHandler8 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3931 description:@"The collection view's data source returned a cell that is in the reuse queue. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, _ui_shortDescription5, v85[5]];
    }

    else
    {
      currentHandler8 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492368) + 8);
      if (os_log_type_enabled(currentHandler8, OS_LOG_TYPE_ERROR))
      {
        _ui_shortDescription6 = [path _ui_shortDescription];
        v45 = v85[5];
        *buf = 138412802;
        selfCopy2 = self;
        v92 = 2112;
        v93 = _ui_shortDescription6;
        v94 = 2112;
        v95 = v45;
        _os_log_impl(&dword_188A29000, currentHandler8, OS_LOG_TYPE_ERROR, "The collection view's data source returned a cell that is in the reuse queue. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", buf, 0x20u);
      }
    }

    [(_UICollectionViewSubviewManager *)v41 ensureViewIsRemovedFromReuseQueue:?];
    [(UICollectionView *)self _prepareViewForReuse:?];
  }

  else if ([v85[5] _isHiddenForReuse])
  {
    [v85[5] _setHiddenForReuse:0];
  }

  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v85[5], [attributes zIndex], 0, attributes);
  }

  v46 = dyld_program_sdk_at_least();
  v47 = v46;
  if (v46)
  {
    [(UICollectionView *)self _configureCellForDisplay:v85[5] indexPath:path cached:0];
  }

  v81[0] = MEMORY[0x1E69E9820];
  v81[1] = 3221225472;
  v81[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_418;
  v81[3] = &unk_1E70FEE28;
  v81[4] = self;
  v81[5] = &v84;
  v81[6] = attributes;
  [UIView performWithoutAnimation:v81];
  if (applyAttributesCopy)
  {
    v80[0] = MEMORY[0x1E69E9820];
    v80[1] = 3221225472;
    v80[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_2;
    v80[3] = &unk_1E70FEE50;
    v80[4] = self;
    v80[5] = &v84;
    v80[6] = attributes;
    [UIView performWithoutAnimation:v80];
  }

  else
  {
    _layoutAttributes = [v85[5] _layoutAttributes];
    __indexPath = [(UICollectionViewLayoutAttributes *)_layoutAttributes __indexPath];
    LOBYTE(__indexPath) = [__indexPath isEqual:-[UICollectionViewLayoutAttributes __indexPath](attributes)];

    if ((__indexPath & 1) == 0)
    {
      v50 = [attributes copy];
      [v50 setIndexPath:-[UICollectionViewLayoutAttributes __indexPath](attributes)];
      v77[0] = MEMORY[0x1E69E9820];
      v77[1] = 3221225472;
      v77[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_3;
      v77[3] = &unk_1E70FEE78;
      v77[4] = self;
      v51 = v50;
      v78 = v51;
      v79 = &v84;
      [UIView performWithoutAnimation:v77];
    }
  }

  if ((v47 & 1) == 0)
  {
    [(UICollectionView *)self _configureCellForDisplay:v85[5] indexPath:path cached:0];
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFB | (4 * ((v74 >> 2) & 1));
  if (focusedCopy)
  {
    v52 = [_UICollectionViewFocusedItemState stateWithReusableView:?];
    [(UICollectionView *)self _setFocusedItemState:v52];
  }

  if (v41)
  {
    [(NSHashTable *)v41->_dequeuedViews removeObject:v85[5]];
  }

  if (notifyCopy)
  {
    [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v85[5] forIndexPath:path];
  }

  _UIRestorePreviousFallbackEnvironment(v73);
  v53 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492370);
  if (*v53)
  {
    v69 = *(v53 + 8);
    if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR))
    {
      v70 = v85[5];
      _ui_shortDescription7 = [path _ui_shortDescription];
      *buf = 134218498;
      selfCopy2 = self;
      v92 = 2112;
      v93 = v70;
      v94 = 2112;
      v95 = _ui_shortDescription7;
      _os_log_impl(&dword_188A29000, v69, OS_LOG_TYPE_ERROR, "[UICV %p] _createPreparedCell: %@ indexPath:%@", buf, 0x20u);
    }
  }

  cell = v85[5];

  _Block_object_dispose(&v84, 8);
LABEL_65:
  objc_autoreleasePoolPop(context);
  return cell;
}

void __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) cellForItemAtIndexPath:*(a1 + 48)];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_400(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) cellForItemAtIndexPath:*(a1 + 48)];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

- (void)_prepareViewForReuse:(uint64_t)reuse
{
  v17 = *MEMORY[0x1E69E9840];
  v4 = a2;
  if (reuse)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_prepareViewForReuse____s_category);
    if (*CategoryCachedImpl)
    {
      v10 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *buf = 134218242;
        reuseCopy = reuse;
        v15 = 2112;
        v16 = v4;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "[CV %p] _prepareViewForReuse: %@", buf, 0x16u);
      }
    }

    v6 = *(reuse + 3232);
    objc_storeStrong((reuse + 3232), a2);
    v11[0] = MEMORY[0x1E69E9820];
    v11[1] = 3221225472;
    v11[2] = __41__UICollectionView__prepareViewForReuse___block_invoke;
    v11[3] = &unk_1E70F3590;
    v7 = v4;
    v12 = v7;
    [UIView performWithoutAnimation:v11];
    [v7 _setHiddenForReuse:0];
    v8 = *(reuse + 3232);
    *(reuse + 3232) = v6;
    v9 = v6;
  }
}

- (id)_createPreparedSupplementaryViewForElementOfKind:(id)kind atIndexPath:(id)path layout:(id)layout withLayoutAttributes:(id)attributes applyAttributes:(BOOL)applyAttributes
{
  applyAttributesCopy = applyAttributes;
  v94 = *MEMORY[0x1E69E9840];
  kindCopy = kind;
  layoutCopy = layout;
  attributesCopy = attributes;
  context = objc_autoreleasePoolPush();
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (!WeakRetained)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3995 description:@"UICollectionView dataSource is not set"];
  }

  if ((*(&self->_collectionViewFlags + 7) & 2) == 0 && (!attributesCopy || (attributesCopy[36] & 2) == 0))
  {
    v14 = 0;
    goto LABEL_51;
  }

  firstResponderIndexPath = self->_firstResponderIndexPath;
  if (firstResponderIndexPath && self->_firstResponderViewType == 2 && [(NSIndexPath *)firstResponderIndexPath isEqual:path]&& [(NSString *)self->_firstResponderViewKind isEqual:kindCopy])
  {
    v14 = self->_firstResponderView;
    goto LABEL_51;
  }

  v63 = _UISetCurrentFallbackEnvironment(self);
  v16 = self->_subviewManager;
  v64 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v64 | 4;
  v78 = 0;
  v79 = &v78;
  v80 = 0x3032000000;
  v81 = __Block_byref_object_copy__39;
  v82 = __Block_byref_object_dispose__39;
  v83 = 0;
  if (!attributesCopy || (attributesCopy[36] & 2) == 0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492378);
    v18 = *(CategoryCachedImpl + 8);
    if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v18))
    {
      *buf = 0;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v74[0] = MEMORY[0x1E69E9820];
    v74[1] = 3221225472;
    v74[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke;
    v74[3] = &unk_1E70FEEA0;
    v76 = &v78;
    v74[4] = self;
    v19 = kindCopy;
    v75 = v19;
    pathCopy = path;
    [UIView performWithoutAnimation:v74];
    v20 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492380);
    v21 = *(v20 + 8);
    if (os_signpost_id_make_with_pointer(*(v20 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v21))
    {
      *buf = 0;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v22 = v79[5];
    if (!v22)
    {
      currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
      _ui_shortDescription = [path _ui_shortDescription];
      [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4026 description:{@"The collection view's data source returned nil when asked to provide a supplementary view. Collection view: %@; element kind: %@; index path: %@", self, v19, _ui_shortDescription}];

      v22 = v79[5];
    }

    if (([v22 _wasDequeued] & 1) == 0)
    {
      currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
      _ui_shortDescription2 = [path _ui_shortDescription];
      [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4027 description:{@"The collection view's data source returned a supplementary view that was not dequeued from the collection view using a supplementary registration or reuse identifier. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", self, v19, _ui_shortDescription2, v79[5]}];
    }

    superview = [v79[5] superview];
    if (!superview)
    {
      if (!dyld_program_sdk_at_least())
      {
        goto LABEL_30;
      }

      superview = [MEMORY[0x1E696AAA8] currentHandler];
      _ui_shortDescription3 = [path _ui_shortDescription];
      [superview handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4028 description:{@"The collection view's data source returned a supplementary view that is not in the view hierarchy. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; supplementary view: %@", self, _ui_shortDescription3, v79[5]}];
    }

LABEL_30:
    _elementKind = [v79[5] _elementKind];
    v32 = [_elementKind isEqualToString:v19];

    if ((v32 & 1) == 0)
    {
      if (dyld_program_sdk_at_least() && (_UIIsPrivateMainBundle() & 1) == 0)
      {
        log = [MEMORY[0x1E696AAA8] currentHandler];
        _elementKind2 = [v79[5] _elementKind];
        _ui_shortDescription4 = [path _ui_shortDescription];
        [log handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4029 description:@"The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@", self, v19, _elementKind2, _ui_shortDescription4, v79[5]];
      }

      else if (dyld_program_sdk_at_least() && _UIIsPrivateMainBundle())
      {
        if (os_variant_has_internal_diagnostics())
        {
          log = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(log, OS_LOG_TYPE_FAULT))
          {
            _elementKind3 = [v79[5] _elementKind];
            _ui_shortDescription5 = [path _ui_shortDescription];
            v60 = v79[5];
            *buf = 138413314;
            selfCopy5 = self;
            v86 = 2112;
            v87 = v19;
            v88 = 2112;
            v89 = _elementKind3;
            v90 = 2112;
            v91 = _ui_shortDescription5;
            v92 = 2112;
            v93 = v60;
            _os_log_fault_impl(&dword_188A29000, log, OS_LOG_TYPE_FAULT, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This is a hard assert for other clients and requires immediate attention.", buf, 0x34u);
          }
        }

        else
        {
          log = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492388) + 8);
          if (os_log_type_enabled(log, OS_LOG_TYPE_ERROR))
          {
            _elementKind4 = [v79[5] _elementKind];
            _ui_shortDescription6 = [path _ui_shortDescription];
            v48 = v79[5];
            *buf = 138413314;
            selfCopy5 = self;
            v86 = 2112;
            v87 = v19;
            v88 = 2112;
            v89 = _elementKind4;
            v90 = 2112;
            v91 = _ui_shortDescription6;
            v92 = 2112;
            v93 = v48;
            _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This is a hard assert for other clients and requires immediate attention.", buf, 0x34u);
          }
        }
      }

      else if (os_variant_has_internal_diagnostics())
      {
        log = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(log, OS_LOG_TYPE_FAULT))
        {
          _elementKind5 = [v79[5] _elementKind];
          _ui_shortDescription7 = [path _ui_shortDescription];
          v57 = v79[5];
          *buf = 138413314;
          selfCopy5 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = _elementKind5;
          v90 = 2112;
          v91 = _ui_shortDescription7;
          v92 = 2112;
          v93 = v57;
          _os_log_fault_impl(&dword_188A29000, log, OS_LOG_TYPE_FAULT, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This will become an assert in a future version.", buf, 0x34u);
        }
      }

      else
      {
        log = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492390) + 8);
        if (os_log_type_enabled(log, OS_LOG_TYPE_ERROR))
        {
          _elementKind6 = [v79[5] _elementKind];
          _ui_shortDescription8 = [path _ui_shortDescription];
          v51 = v79[5];
          *buf = 138413314;
          selfCopy5 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = _elementKind6;
          v90 = 2112;
          v91 = _ui_shortDescription8;
          v92 = 2112;
          v93 = v51;
          _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This will become an assert in a future version.", buf, 0x34u);
        }
      }
    }

    if ([(_UICollectionViewSubviewManager *)v16 isViewInReuseQueue:?])
    {
      if (dyld_program_sdk_at_least())
      {
        currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
        _ui_shortDescription9 = [path _ui_shortDescription];
        [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4033 description:@"The collection view's data source returned a supplementary view that is in the reuse queue. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", self, v19, _ui_shortDescription9, v79[5]];
      }

      else
      {
        currentHandler4 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492398) + 8);
        if (os_log_type_enabled(currentHandler4, OS_LOG_TYPE_ERROR))
        {
          _ui_shortDescription10 = [path _ui_shortDescription];
          v36 = v79[5];
          *buf = 138413058;
          selfCopy5 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = _ui_shortDescription10;
          v90 = 2112;
          v91 = v36;
          _os_log_impl(&dword_188A29000, currentHandler4, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view that is in the reuse queue. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", buf, 0x2Au);
        }
      }

      [(_UICollectionViewSubviewManager *)v16 ensureViewIsRemovedFromReuseQueue:?];
      [(UICollectionView *)self _prepareViewForReuse:?];
    }

    else if ([v79[5] _isHiddenForReuse])
    {
      [v79[5] _setHiddenForReuse:0];
    }

    v28 = 1;
    goto LABEL_40;
  }

  _content = [(_UILabelConfiguration *)attributesCopy _content];
  _content2 = [(_UILabelConfiguration *)attributesCopy _content];
  v26 = [(UICollectionView *)self _dequeueReusableViewOfKind:_content withIdentifier:_content2 forIndexPath:path viewCategory:2];
  v27 = v79[5];
  v79[5] = v26;

  if (!v79[5])
  {
    v29 = [layoutCopy _decorationViewForLayoutAttributes:attributesCopy];
    v30 = v79[5];
    v79[5] = v29;

    [v79[5] _willRevealWithLayoutAttributes:attributesCopy];
    v28 = 2;
LABEL_41:
    -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v79[5], [attributesCopy zIndex], 0, attributesCopy);
    goto LABEL_42;
  }

  v28 = 2;
LABEL_40:
  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    goto LABEL_41;
  }

LABEL_42:
  v37 = dyld_program_sdk_at_least();
  v38 = v37;
  if (v37)
  {
    [(UICollectionView *)self _configureSupplementaryViewForDisplay:v79[5] withElementKind:kindCopy indexPath:path elementCategory:v28];
  }

  v71[0] = MEMORY[0x1E69E9820];
  v71[1] = 3221225472;
  v71[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke_442;
  v71[3] = &unk_1E70FFB90;
  v71[4] = self;
  v73 = &v78;
  v39 = attributesCopy;
  v72 = v39;
  [UIView performWithoutAnimation:v71];
  if (applyAttributesCopy)
  {
    v68[0] = MEMORY[0x1E69E9820];
    v68[1] = 3221225472;
    v68[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke_2;
    v68[3] = &unk_1E70FEE78;
    v68[4] = self;
    v69 = v39;
    v70 = &v78;
    [UIView performWithoutAnimation:v68];
  }

  if ((v38 & 1) == 0)
  {
    [(UICollectionView *)self _configureSupplementaryViewForDisplay:v79[5] withElementKind:kindCopy indexPath:path elementCategory:v28];
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFB | (4 * ((v64 >> 2) & 1));
  if (v16)
  {
    [(NSHashTable *)v16->_dequeuedViews removeObject:v79[5]];
  }

  [(UICollectionView *)self _notifyWillDisplaySupplementaryView:v79[5] forElementKind:kindCopy atIndexPath:path];
  _UIRestorePreviousFallbackEnvironment(v63);
  v14 = v79[5];

  _Block_object_dispose(&v78, 8);
LABEL_51:
  objc_autoreleasePoolPop(context);

  return v14;
}

void __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) viewForSupplementaryElementOfKind:*(a1 + 40) atIndexPath:*(a1 + 56)];
  v3 = *(*(a1 + 48) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

- (void)_configureCachedCellForDisplay:(id)display withIndexPath:(id)path layoutAttributesToUpdate:(id)update
{
  v25 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_configureCachedCellForDisplay_withIndexPath_layoutAttributesToUpdate____s_category);
  if (*CategoryCachedImpl)
  {
    v10 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = v10;
      _ui_shortDescription = [path _ui_shortDescription];
      _layoutAttributes = [display _layoutAttributes];
      *buf = 134219010;
      selfCopy = self;
      v17 = 2112;
      displayCopy = display;
      v19 = 2112;
      v20 = _ui_shortDescription;
      v21 = 2112;
      v22 = _layoutAttributes;
      v23 = 2112;
      updateCopy = update;
      _os_log_impl(&dword_188A29000, v11, OS_LOG_TYPE_ERROR, "[UICV %p] Configuring cached cell %@ with indexPath:%@ cellAttrs: %@ layoutAttrsToUpdate: %@", buf, 0x34u);
    }
  }

  if (update)
  {
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = __90__UICollectionView__configureCachedCellForDisplay_withIndexPath_layoutAttributesToUpdate___block_invoke;
    v14[3] = &unk_1E70FEEC8;
    v14[4] = self;
    v14[5] = update;
    v14[6] = display;
    [UIView performWithoutAnimation:v14];
  }

  [(UICollectionView *)self _configureCellForDisplay:display indexPath:path cached:1];
}

- (void)_configureCellForDisplay:(id)display indexPath:(id)path cached:(BOOL)cached
{
  v9 = self->_typeSelectController;
  v10 = v9;
  if (v9 && v9->_enabled)
  {
    [(_UICollectionViewTypeSelectController *)v9 configureTypeSelectDisplayForCell:display indexPath:path];
  }

  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __62__UICollectionView__configureCellForDisplay_indexPath_cached___block_invoke;
  v11[3] = &unk_1E70FEEF0;
  cachedCopy = cached;
  v11[4] = self;
  v11[5] = path;
  v11[6] = display;
  [UIView performWithoutAnimation:v11];
}

void __62__UICollectionView__configureCellForDisplay_indexPath_cached___block_invoke(uint64_t a1)
{
  if ((*(a1 + 56) & 1) == 0 && !dyld_program_sdk_at_least())
  {
    goto LABEL_10;
  }

  v2 = *(*(a1 + 32) + 2976);
  if (v2)
  {
    v3 = [*(v2 + 8) containsObject:*(a1 + 40)];
    v4 = *(*(a1 + 32) + 2976);
    if (v4)
    {
      v5 = [*(v4 + 16) containsObject:*(a1 + 40)];
    }

    else
    {
      v5 = 0;
    }

    v6 = (a1 + 48);
    if (v3 == [*(a1 + 48) isSelected])
    {
LABEL_8:
      if (v5 == [*v6 isHighlighted])
      {
        goto LABEL_10;
      }

      goto LABEL_9;
    }

LABEL_7:
    [*v6 _setSelected:v3 animated:0];
    goto LABEL_8;
  }

  v6 = (a1 + 48);
  if ([*(a1 + 48) isSelected])
  {
    v5 = 0;
    v3 = 0;
    goto LABEL_7;
  }

  if ([*v6 isHighlighted])
  {
    v5 = 0;
LABEL_9:
    [*v6 _setHighlighted:v5 animated:0];
  }

LABEL_10:
  [*(a1 + 32) _updateEditing:objc_msgSend(*(a1 + 32) forView:"_isEditing") atIndexPath:*(a1 + 48) elementCategory:{*(a1 + 40), 0}];
  [*(a1 + 48) setSemanticContentAttribute:{objc_msgSend(*(a1 + 32), "semanticContentAttribute")}];
  v7 = *(a1 + 48);
  v8 = *(*(a1 + 32) + 2152);
  v9 = v7;
  v10 = v9;
  if (v8)
  {
    v11 = v9 == 0;
  }

  else
  {
    v11 = 1;
  }

  if (v11)
  {
    goto LABEL_19;
  }

  v12 = [v9 effectiveUserInterfaceLayoutDirection];
  if (v12 == [v8 developmentLayoutDirection])
  {
    if (![v10 _flipsHorizontalAxis])
    {
      goto LABEL_19;
    }

    v13 = 0;
  }

  else
  {
    v13 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
  }

  [v10 _setFlipsHorizontalAxis:v13];
LABEL_19:

  v14 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:*(a1 + 40)];
  [(_UICollectionViewDragAndDropController *)*(*(a1 + 32) + 2856) updateAppearanceForCell:v14 atIndexPath:?];
}

- (void)_configureSupplementaryViewForDisplay:(id)display withElementKind:(id)kind indexPath:(id)path elementCategory:(unint64_t)category
{
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __100__UICollectionView__configureSupplementaryViewForDisplay_withElementKind_indexPath_elementCategory___block_invoke;
  v6[3] = &unk_1E70FEF18;
  v6[4] = self;
  v6[5] = display;
  v6[6] = category;
  [UIView performWithoutAnimation:v6, kind, path];
}

void __100__UICollectionView__configureSupplementaryViewForDisplay_withElementKind_indexPath_elementCategory___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _updateEditing:objc_msgSend(*(a1 + 32) forView:"_isEditing") atIndexPath:*(a1 + 40) elementCategory:{0, *(a1 + 48)}];
  [*(a1 + 40) setSemanticContentAttribute:{objc_msgSend(*(a1 + 32), "semanticContentAttribute")}];
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v8 = *(v2 + 2152);
  v4 = v3;
  if (v8)
  {
    v5 = v4 == 0;
  }

  else
  {
    v5 = 1;
  }

  if (!v5)
  {
    v6 = [v4 effectiveUserInterfaceLayoutDirection];
    if (v6 == [v8 developmentLayoutDirection])
    {
      if (![v4 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      v7 = 0;
    }

    else
    {
      v7 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [v4 _setFlipsHorizontalAxis:v7];
  }

LABEL_10:
}

- (void)setContentSize:(CGSize)size
{
  height = size.height;
  width = size.width;
  _adjustsTargetsOnContentOffsetChanges = [(UIScrollView *)self _adjustsTargetsOnContentOffsetChanges];
  [(UIScrollView *)self _setAdjustsTargetsOnContentOffsetChanges:0];
  v7.receiver = self;
  v7.super_class = UICollectionView;
  [(UIScrollView *)&v7 setContentSize:width, height];
  [(UIScrollView *)self _setAdjustsTargetsOnContentOffsetChanges:_adjustsTargetsOnContentOffsetChanges];
}

- (void)_setContentSize:(CGSize)size skipContentOffsetAdjustment:(BOOL)adjustment
{
  adjustmentCopy = adjustment;
  height = size.height;
  width = size.width;
  [(UIScrollView *)self contentSize];
  v10 = v9 != height || v8 != width;
  _isAutomaticContentOffsetAdjustmentEnabled = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
  [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:!adjustmentCopy];
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v15 = v14;
  if (adjustmentCopy || !+[UIView areAnimationsEnabled](UIView, "areAnimationsEnabled") || +[UIView _isInAnimationBlock])
  {
    [(UICollectionView *)self setContentSize:width, height];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:_isAutomaticContentOffsetAdjustmentEnabled];
    if (v10 && adjustmentCopy)
    {
      [(UIScrollView *)self contentOffset];
      if (vabdd_f64(v13, v17) < 0.0001 && vabdd_f64(v15, v16) < 0.0001)
      {
        *(&self->_collectionViewFlags + 4) |= 0x200000u;
      }
    }
  }

  else
  {
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __64__UICollectionView__setContentSize_skipContentOffsetAdjustment___block_invoke;
    v18[3] = &unk_1E70F6848;
    v18[4] = self;
    *&v18[5] = width;
    *&v18[6] = height;
    [(UIScrollView *)self performWhileAnimatingAutomaticContentOffsetAdjustments:v18];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:_isAutomaticContentOffsetAdjustmentEnabled];
  }
}

- (void)_setContentSizeFromLayout:(CGSize)layout isRecursivelyUpdatingVisibleCells:(BOOL)cells
{
  cellsCopy = cells;
  height = layout.height;
  width = layout.width;
  if ([(UIScrollView *)self isScrollAnimating]|| [(UIScrollView *)self isDecelerating]|| [(UIScrollView *)self isDragging])
  {
    selfCopy2 = self;
    v9 = width;
    v10 = height;
    v11 = 1;
  }

  else
  {
    if (cellsCopy)
    {
      [(UIView *)self safeAreaInsets];
      if (v15 != 0.0 || v12 != 0.0 || v14 != 0.0 || v13 != 0.0)
      {
        _edgesApplyingSafeAreaInsetsToContentInset = [(UIScrollView *)self _edgesApplyingSafeAreaInsetsToContentInset];
        if (_edgesApplyingSafeAreaInsetsToContentInset != [(UIScrollView *)self _edgesApplyingSafeAreaInsetsToContentInsetForContentSize:width, height])
        {
          [(UICollectionView *)self _setContentSize:1 skipContentOffsetAdjustment:width, height];
          *(&self->_collectionViewFlags + 4) &= ~0x200000u;
          return;
        }
      }
    }

    v11 = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled]^ 1;
    selfCopy2 = self;
    v9 = width;
    v10 = height;
  }

  [(UICollectionView *)selfCopy2 _setContentSize:v11 skipContentOffsetAdjustment:v9, v10];
}

- (uint64_t)_applyLayoutAttributes:(void *)attributes toView:(int)view addingControlledSubview:(uint64_t)subview forced:
{
  v21 = *MEMORY[0x1E69E9840];
  if (!result)
  {
    return result;
  }

  v9 = result;
  if (os_variant_has_internal_diagnostics())
  {
    if (!attributes)
    {
      v10 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v10, OS_LOG_TYPE_FAULT))
      {
        v15 = 138412546;
        attributesCopy2 = v9;
        v17 = 2112;
        v18 = a2;
        _os_log_fault_impl(&dword_188A29000, v10, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempted to apply layout attributes to a nil view. Collection View: %@, Attributes: %@", &v15, 0x16u);
      }
    }
  }

  else if (!attributes)
  {
    v13 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923A0) + 8);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      v15 = 138412546;
      attributesCopy2 = v9;
      v17 = 2112;
      v18 = a2;
      _os_log_impl(&dword_188A29000, v13, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempted to apply layout attributes to a nil view. Collection View: %@, Attributes: %@", &v15, 0x16u);
    }
  }

  if (os_variant_has_internal_diagnostics())
  {
    if (!a2)
    {
      v11 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
      {
LABEL_22:

        goto LABEL_6;
      }

      _layoutAttributes = [attributes _layoutAttributes];
      v15 = 138412802;
      attributesCopy2 = attributes;
      v17 = 2112;
      v18 = _layoutAttributes;
      v19 = 2112;
      v20 = v9;
      _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempting to apply nil layout attributes to view. View: %@; current attributes from view: %@; collection view: %@", &v15, 0x20u);
LABEL_21:

      goto LABEL_22;
    }
  }

  else if (!a2)
  {
    v14 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923A8) + 8);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      v11 = v14;
      _layoutAttributes = [attributes _layoutAttributes];
      v15 = 138412802;
      attributesCopy2 = attributes;
      v17 = 2112;
      v18 = _layoutAttributes;
      v19 = 2112;
      v20 = v9;
      _os_log_impl(&dword_188A29000, v11, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempting to apply nil layout attributes to view. View: %@; current attributes from view: %@; collection view: %@", &v15, 0x20u);
      goto LABEL_21;
    }
  }

LABEL_6:
  if (view)
  {
    [v9 _addControlledSubview:attributes atZIndex:objc_msgSend(a2 forced:"zIndex") initialAttributes:{subview, a2}];
  }

  return [attributes _setLayoutAttributes:a2];
}

- (BOOL)_isReorderingItemAtIndexPath:(id)path includingDragAndDrop:(BOOL)drop
{
  v19 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  if (pathCopy && (drop || ![(UICollectionView *)self _hasActiveDrag]&& ![(UICollectionView *)self _hasActiveDrop]))
  {
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    _reorderedItems = [(UICollectionView *)self _reorderedItems];
    v8 = [_reorderedItems countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v8)
    {
      v9 = *v15;
      while (2)
      {
        for (i = 0; i != v8; ++i)
        {
          if (*v15 != v9)
          {
            objc_enumerationMutation(_reorderedItems);
          }

          expectedCellIndexPath = [*(*(&v14 + 1) + 8 * i) expectedCellIndexPath];
          v12 = [expectedCellIndexPath isEqual:pathCopy];

          if (v12)
          {
            LOBYTE(v8) = 1;
            goto LABEL_16;
          }
        }

        v8 = [_reorderedItems countByEnumeratingWithState:&v14 objects:v18 count:16];
        if (v8)
        {
          continue;
        }

        break;
      }
    }

LABEL_16:
  }

  else
  {
    LOBYTE(v8) = 0;
  }

  return v8;
}

- (BOOL)_viewIsReorderedCell:(id)cell
{
  v3 = [(UICollectionView *)self _reorderedItemForView:cell];
  v4 = v3 != 0;

  return v4;
}

- (id)_reorderedItemForView:(id)view
{
  v17 = *MEMORY[0x1E69E9840];
  viewCopy = view;
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v14 = 0u;
    v15 = 0u;
    v12 = 0u;
    v13 = 0u;
    _reorderedItems = [(UICollectionView *)self _reorderedItems];
    v6 = [_reorderedItems countByEnumeratingWithState:&v12 objects:v16 count:16];
    if (v6)
    {
      v7 = *v13;
      while (2)
      {
        for (i = 0; i != v6; i = i + 1)
        {
          if (*v13 != v7)
          {
            objc_enumerationMutation(_reorderedItems);
          }

          v9 = *(*(&v12 + 1) + 8 * i);
          cell = [v9 cell];

          if (cell == viewCopy)
          {
            v6 = v9;
            goto LABEL_13;
          }
        }

        v6 = [_reorderedItems countByEnumeratingWithState:&v12 objects:v16 count:16];
        if (v6)
        {
          continue;
        }

        break;
      }
    }

LABEL_13:
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (CGPoint)_reorderingTargetPosition
{
  x = self->_reorderingTargetPosition.x;
  y = self->_reorderingTargetPosition.y;
  result.y = y;
  result.x = x;
  return result;
}

- (CGPoint)_delegateTargetOffsetForProposedContentOffset:(CGPoint)offset
{
  y = offset.y;
  x = offset.x;
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x8000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self targetContentOffsetForProposedContentOffset:{x, y}];
    goto LABEL_5;
  }

  if ((collectionViewFlags & 0x4000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy _collectionView:self targetContentOffsetForProposedContentOffset:{x, y}];
LABEL_5:
    x = v8;
    y = v9;
  }

  v10 = x;
  v11 = y;
  result.y = v11;
  result.x = v10;
  return result;
}

- (BOOL)_updatePrefetchItemIfNeeded:(id)needed forIndexPath:(id)path withLayoutAttributes:(id)attributes willDisplay:(BOOL)display
{
  v40 = *MEMORY[0x1E69E9840];
  neededCopy = needed;
  pathCopy = path;
  attributesCopy = attributes;
  if (!neededCopy)
  {
    v13 = 0;
    LOBYTE(v17) = 1;
    goto LABEL_29;
  }

  v13 = neededCopy[3];
  if (!v13)
  {
    LOBYTE(v17) = 1;
    goto LABEL_28;
  }

  v14 = *(neededCopy + 8);
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923B0);
  if (*CategoryCachedImpl)
  {
    v21 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
    {
      log = v21;
      _ui_shortDescription = [(UICollectionView *)pathCopy _ui_shortDescription];
      _layoutAttributes = [v13 _layoutAttributes];
      v23 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:pathCopy];
      *buf = 134219010;
      selfCopy = self;
      v32 = 2112;
      v33 = neededCopy;
      v34 = 2112;
      v35 = _ui_shortDescription;
      v36 = 2112;
      v37 = _layoutAttributes;
      v38 = 2112;
      v39 = v23;
      _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePrefetchItemIfNeeded:%@ indexPath:%@ cellAttrs: %@ attrsFromLayout: %@", buf, 0x34u);
    }
  }

  if ((v14 & 7) != 0)
  {
    [v13 _setHiddenForReuse:0];
    if ((v14 & 4) != 0)
    {
      [(UICollectionView *)self _reconfigureCell:v13 forItemAtIndexPath:pathCopy];
    }
  }

  if (display || (v14 & 2) != 0)
  {
    [(UICollectionView *)self _configureCachedCellForDisplay:v13 withIndexPath:pathCopy layoutAttributesToUpdate:0];
    if ((v14 & 1) == 0)
    {
LABEL_10:
      if ((v14 & 2) != 0)
      {
        goto LABEL_11;
      }

      goto LABEL_19;
    }
  }

  else if ((v14 & 1) == 0)
  {
    goto LABEL_10;
  }

  if (attributesCopy)
  {
    v17 = attributesCopy;
  }

  else
  {
    v17 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:pathCopy];
    if (!v17)
    {
      goto LABEL_20;
    }
  }

  [(UIBackgroundConfiguration *)neededCopy _setCustomView:v17];
  v27[0] = MEMORY[0x1E69E9820];
  v27[1] = 3221225472;
  v27[2] = __94__UICollectionView__updatePrefetchItemIfNeeded_forIndexPath_withLayoutAttributes_willDisplay___block_invoke;
  v27[3] = &unk_1E70F6228;
  v27[4] = self;
  v28 = v17;
  v29 = v13;
  v18 = v17;
  [UIView performWithoutAnimation:v27];

  if ((v14 & 2) != 0)
  {
LABEL_11:
    v16 = neededCopy[2];
    LOBYTE(v17) = v16 != 0;
    if (v16)
    {
      [v13 _invalidatePreferredAttributes];
      [(UICollectionView *)self _checkForPreferredAttributesInView:v13 originalAttributes:v16];
    }

    else if (os_variant_has_internal_diagnostics())
    {
      v24 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v24, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412546;
        selfCopy = pathCopy;
        v32 = 2112;
        v33 = v13;
        _os_log_fault_impl(&dword_188A29000, v24, OS_LOG_TYPE_FAULT, "UIKit internal inconsistency: prefetch items should never have nil attributes. Index path: %@; View: %@", buf, 0x16u);
      }
    }

    else
    {
      v19 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923B8) + 8);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        selfCopy = pathCopy;
        v32 = 2112;
        v33 = v13;
        _os_log_impl(&dword_188A29000, v19, OS_LOG_TYPE_ERROR, "UIKit internal inconsistency: prefetch items should never have nil attributes. Index path: %@; View: %@", buf, 0x16u);
      }
    }

    if (display)
    {
      goto LABEL_28;
    }

    goto LABEL_26;
  }

LABEL_19:
  LOBYTE(v17) = 1;
LABEL_20:
  if (!display)
  {
LABEL_26:
    if (([v13 _isHiddenForReuse] & 1) == 0)
    {
      [v13 _setHiddenForReuse:1];
    }
  }

LABEL_28:
  *(neededCopy + 8) &= 0xF8u;
LABEL_29:

  return v17;
}

- (unint64_t)_prefetchItemsForPrefetchingContext:(id)context
{
  v46 = *MEMORY[0x1E69E9840];
  contextCopy = context;
  _useIdleObserverForCellPrefetching = [(UICollectionView *)self _useIdleObserverForCellPrefetching];
  if (_useIdleObserverForCellPrefetching)
  {
    [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  }

  if (contextCopy && [contextCopy[2] count])
  {
    v6 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    while (1)
    {
      popNextItem = [(_UICollectionViewPrefetchingContext *)contextCopy popNextItem];
      v8 = popNextItem;
      v9 = popNextItem ? *(popNextItem + 16) : 0;
      v10 = v9;
      indexPath = [v10 indexPath];

      v12 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:indexPath];

      if (!v12)
      {
        v13 = v6[218];
        v14 = [*(&self->super.super.super.super.isa + v13) objectForKeyedSubscript:indexPath];

        if (!v14)
        {
          _focusedItemState = [(UICollectionView *)self _focusedItemState];
          if (!_focusedItemState || ((v16 = _focusedItemState, -[UICollectionView _focusedItemState](self, "_focusedItemState"), v17 = objc_claimAutoreleasedReturnValue(), (v18 = v17) == 0) ? (v19 = 0) : (v19 = *(v17 + 16)), v20 = v19, v21 = [v20 isEqual:indexPath], v20, v18, v16, v6 = &OBJC_IVAR____UISystemBackgroundView__strokeView, (v21 & 1) == 0))
          {
            firstResponderIndexPath = self->_firstResponderIndexPath;
            if (!firstResponderIndexPath || ([(NSIndexPath *)firstResponderIndexPath isEqual:indexPath]& 1) == 0)
            {
              v23 = v8 ? v8[2] : 0;
              v24 = v23;
              v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:indexPath withLayoutAttributes:v24 applyAttributes:0 isFocused:0 notify:0];

              if (v25)
              {
                break;
              }
            }
          }
        }
      }

      if (![contextCopy[2] count])
      {
        v26 = 0;
        if (_useIdleObserverForCellPrefetching)
        {
          goto LABEL_27;
        }

        goto LABEL_28;
      }
    }

    if (_useIdleObserverForCellPrefetching)
    {
      [v25 _setHiddenForReuse:1];
    }

    [(_UIHomeAffordanceObservationRecord *)v8 setLegacyViewServiceSessionIdentifier:v25];
    v28 = *(&self->super.super.super.super.isa + v13);
    if (v8)
    {
      v29 = v8[2];
    }

    else
    {
      v29 = 0;
    }

    v30 = v29;
    indexPath2 = [v30 indexPath];
    [v28 setObject:v8 forKeyedSubscript:indexPath2];

    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_prefetchItemsForPrefetchingContext____s_category);
    if (*CategoryCachedImpl)
    {
      v33 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
      {
        v34 = v33;
        _ui_shortDescription = [indexPath _ui_shortDescription];
        if (v8)
        {
          v36 = v8[2];
        }

        else
        {
          v36 = 0;
        }

        v37 = v36;
        *buf = 134218754;
        selfCopy = self;
        v40 = 2112;
        v41 = _ui_shortDescription;
        v42 = 2112;
        v43 = v25;
        v44 = 2112;
        v45 = v37;
        _os_log_impl(&dword_188A29000, v34, OS_LOG_TYPE_ERROR, "[UICV %p] Prefetched cell for index path:%@ Cell: %@. Attributes: %@", buf, 0x2Au);
      }
    }

    v26 = 1;
    if (_useIdleObserverForCellPrefetching)
    {
      goto LABEL_27;
    }
  }

  else
  {
    v26 = 0;
    if (_useIdleObserverForCellPrefetching)
    {
LABEL_27:
      [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
    }
  }

LABEL_28:

  return v26;
}

- (void)_computeMainPrefetchCandidatesForVelocity:(CGVector)velocity
{
  dy = velocity.dy;
  dx = velocity.dx;
  [(UICollectionView *)self _visibleBounds];
  v7 = v6;
  v9 = v8;
  v11 = v10;
  v13 = v12;
  [(UICollectionView *)self _computeFutureVisibleBoundsForPrefetchVelocity:dx visibleBounds:dy, v6, v8, v10, v12];
  v18 = [(UICollectionView *)self _computeMainPrefetchCandidatesForVisibleBounds:v7 futureVisibleBounds:v9 prefetchVector:v11, v13, v14, v15, v16, v17, *&dx, *&dy];
  mainPrefetchingContext = self->_mainPrefetchingContext;
  self->_mainPrefetchingContext = v18;
}

- (id)_computeMainPrefetchCandidatesForVisibleBounds:(CGRect)bounds futureVisibleBounds:(CGRect)visibleBounds prefetchVector:(CGVector)vector
{
  height = visibleBounds.size.height;
  width = visibleBounds.size.width;
  y = visibleBounds.origin.y;
  x = visibleBounds.origin.x;
  v16 = bounds.size.width;
  v17 = bounds.size.height;
  v9 = bounds.origin.y;
  v10 = bounds.origin.x;
  mainPrefetchingContext = self->_mainPrefetchingContext;
  if (mainPrefetchingContext && CGRectEqualToRect(mainPrefetchingContext->_prefetchRect, visibleBounds))
  {
    v13 = self->_mainPrefetchingContext;
  }

  else
  {
    height = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:x validateLayout:y, width, height];
    v13 = [(UICollectionView *)self _prefetchingContextForVisibleBounds:height prefetchVector:v10 prefetchRect:v9 attributes:v16, v17, v19, v20, *&x, *&y, *&width, *&height];
  }

  return v13;
}

- (id)_prefetchingContextForVisibleBounds:(CGRect)bounds prefetchVector:(CGVector)vector prefetchRect:(CGRect)rect attributes:(id)attributes
{
  dy = vector.dy;
  dx = vector.dx;
  height = bounds.size.height;
  width = bounds.size.width;
  y = bounds.origin.y;
  x = bounds.origin.x;
  v37 = *MEMORY[0x1E69E9840];
  attributesCopy = attributes;
  v31 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(attributesCopy, "count")}];
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  v14 = attributesCopy;
  v15 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v33;
    do
    {
      for (i = 0; i != v16; ++i)
      {
        if (*v33 != v17)
        {
          objc_enumerationMutation(v14);
        }

        v19 = *(*(&v32 + 1) + 8 * i);
        layout = self->_layout;
        [v19 frame];
        [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v19 frame:?];
        v40.origin.x = x;
        v40.origin.y = y;
        v40.size.width = width;
        v40.size.height = height;
        v21 = CGRectIntersectsRect(v39, v40);
        if (v19 && !v21 && (v19[288] & 1) != 0)
        {
          indexPath = [v19 indexPath];
          v23 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:indexPath];

          if (!v23)
          {
            v24 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:indexPath];

            if (!v24)
            {
              v25 = [[_UICollectionViewPrefetchItem alloc] initWithAttributes:v19];
              [v31 addObject:v25];
            }
          }
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v16);
  }

  [(UICollectionView *)self _reorderPrefetchCandidates:v31 forPrefetchVelocity:dx visibleBounds:dy, x, y, width, height];
  v26 = [[_UICollectionViewPrefetchingContext alloc] initWithPrefetchItems:v31 prefetchRect:rect.origin.x, rect.origin.y, rect.size.width, rect.size.height];
  v27 = v26;
  if ((*(&self->_collectionViewFlags + 8) & 0x40) != 0 && v26 && [v26[2] count])
  {
    _prefetchDataSourceProxy = [(UICollectionView *)self _prefetchDataSourceProxy];
    remainingIndexPaths = [(_UICollectionViewPrefetchingContext *)v27 remainingIndexPaths];
    [_prefetchDataSourceProxy collectionView:self prefetchItemsAtIndexPaths:remainingIndexPaths];
  }

  return v27;
}

- (CGRect)_computeFutureVisibleBoundsForPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds
{
  height = bounds.size.height;
  width = bounds.size.width;
  y = bounds.origin.y;
  x = bounds.origin.x;
  dy = velocity.dy;
  dx = velocity.dx;
  v26 = CGRectGetHeight(bounds);
  v27.origin.x = x;
  v27.origin.y = y;
  v27.size.width = width;
  v27.size.height = height;
  v11 = CGRectGetWidth(v27);
  v12 = fabs(dx);
  v13 = fabs(dy);
  if (v12 < 2.22044605e-16 || v13 < 2.22044605e-16)
  {
    if (dx <= 0.0)
    {
      if (dx >= 0.0)
      {
        v20 = height;
        v17 = width;
        MinY = y;
        MaxX = x;
        goto LABEL_14;
      }

      v30.origin.x = x;
      v30.origin.y = y;
      v30.size.width = width;
      v30.size.height = height;
      v17 = v11 * 0.75;
      MaxX = CGRectGetMinX(v30) - v11 * 0.75;
      v31.origin.x = x;
      v31.origin.y = y;
      v31.size.width = width;
      v31.size.height = height;
      MinY = CGRectGetMinY(v31);
    }

    else
    {
      v28.origin.x = x;
      v28.origin.y = y;
      v28.size.width = width;
      v28.size.height = height;
      MaxX = CGRectGetMaxX(v28);
      v29.origin.x = x;
      v29.origin.y = y;
      v29.size.width = width;
      v29.size.height = height;
      MinY = CGRectGetMinY(v29);
      v17 = v11 * 0.75;
    }

    v20 = v26;
LABEL_14:
    if (dy <= 0.0)
    {
      if (dy >= 0.0)
      {
        goto LABEL_22;
      }

      v34.origin.x = x;
      v34.origin.y = y;
      v34.size.width = width;
      v34.size.height = height;
      MaxX = CGRectGetMinX(v34);
      v35.origin.x = x;
      v35.origin.y = y;
      v35.size.width = width;
      v35.size.height = height;
      v21 = CGRectGetMinY(v35);
      v20 = v26 * 0.75;
      MinY = v21 - v26 * 0.75;
    }

    else
    {
      v32.origin.x = x;
      v32.origin.y = y;
      v32.size.width = width;
      v32.size.height = height;
      MaxX = CGRectGetMinX(v32);
      v33.origin.x = x;
      v33.origin.y = y;
      v33.size.width = width;
      v33.size.height = height;
      MinY = CGRectGetMaxY(v33);
      v20 = v26 * 0.75;
    }

    v17 = v11;
    goto LABEL_22;
  }

  v18 = v12 / (v12 + v13);
  v19 = v13 / (v12 + v13);
  if (v18 <= v19 * 5.0)
  {
    if (v19 > v18 * 5.0)
    {
      v18 = 0.0;
    }
  }

  else
  {
    v19 = 0.0;
  }

  [(UICollectionView *)self _unitVectorForVector:dx, dy];
  MaxX = x + v11 * 0.5 * v18 * v22;
  MinY = y + v26 * 0.5 * v19 * v23;
  v17 = v11 * 1.25;
  v20 = v26 * 1.25;
LABEL_22:
  v24 = MaxX;
  v25 = v17;
  result.size.height = v20;
  result.size.width = v25;
  result.origin.y = MinY;
  result.origin.x = v24;
  return result;
}

- (CGRect)_computePrefetchCacheValidationBoundsForPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds
{
  height = bounds.size.height;
  width = bounds.size.width;
  y = bounds.origin.y;
  x = bounds.origin.x;
  [(UICollectionView *)self _computeFutureVisibleBoundsForPrefetchVelocity:velocity.dx visibleBounds:velocity.dy];
  v27.origin.x = v8;
  v27.origin.y = v9;
  v27.size.width = v10;
  v27.size.height = v11;
  v23.origin.x = x;
  v23.origin.y = y;
  v23.size.width = width;
  v23.size.height = height;
  v24 = CGRectUnion(v23, v27);
  v20 = v24.origin.y;
  v21 = v24.origin.x;
  v12 = v24.size.width;
  v13 = v24.size.height;
  v24.origin.x = x;
  v24.origin.y = y;
  v24.size.width = width;
  v24.size.height = height;
  v14 = CGRectGetWidth(v24) * -0.25;
  v25.origin.x = x;
  v25.origin.y = y;
  v25.size.width = width;
  v25.size.height = height;
  v15 = CGRectGetHeight(v25) * -0.25;
  v17 = v20;
  v16 = v21;
  v18 = v12;
  v19 = v13;

  return CGRectInset(*&v16, v14, v15);
}

- (void)_pruneCachedPrefetchViewsForVelocity:(CGVector)velocity
{
  dy = velocity.dy;
  dx = velocity.dx;
  v45 = *MEMORY[0x1E69E9840];
  if (velocity.dx == 0.0 && velocity.dy == 0.0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923C0);
    if (*CategoryCachedImpl)
    {
      v7 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        LODWORD(buf) = 134217984;
        *(&buf + 4) = self;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "[UICV %p] Skipping pruning of prefetched cells due to zero velocity", &buf, 0xCu);
      }
    }
  }

  else if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    [(UICollectionView *)self _visibleBounds];
    [(UICollectionView *)self _computePrefetchCacheValidationBoundsForPrefetchVelocity:dx visibleBounds:dy, v8, v9, v10, v11];
    *&buf = 0;
    *(&buf + 1) = &buf;
    v41 = 0x3032000000;
    v42 = __Block_byref_object_copy__39;
    v43 = __Block_byref_object_dispose__39;
    v44 = 0;
    v29 = 0;
    v30 = &v29;
    v31 = 0x3032000000;
    v32 = __Block_byref_object_copy__39;
    v33 = __Block_byref_object_dispose__39;
    v34 = 0;
    prefetchCacheItems = self->_prefetchCacheItems;
    v28[0] = MEMORY[0x1E69E9820];
    v28[1] = 3221225472;
    v28[2] = __57__UICollectionView__pruneCachedPrefetchViewsForVelocity___block_invoke;
    v28[3] = &unk_1E70FEF40;
    v28[7] = v13;
    v28[8] = v14;
    v28[9] = v15;
    v28[10] = v16;
    v28[4] = self;
    v28[5] = &buf;
    v28[6] = &v29;
    [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v28];
    v17 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923C8);
    if (*v17)
    {
      v22 = *(v17 + 8);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        v23 = *(*(&buf + 1) + 40);
        *v36 = 134218242;
        selfCopy = self;
        v38 = 2112;
        v39 = v23;
        _os_log_impl(&dword_188A29000, v22, OS_LOG_TYPE_ERROR, "[UICV %p] Pruning prefetched cells: %@", v36, 0x16u);
      }
    }

    if ([*(*(&buf + 1) + 40) count])
    {
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectsForKeys:*(*(&buf + 1) + 40)];
    }

    v26 = 0u;
    v27 = 0u;
    v24 = 0u;
    v25 = 0u;
    v18 = v30[5];
    v19 = [v18 countByEnumeratingWithState:&v24 objects:v35 count:16];
    if (v19)
    {
      v20 = *v25;
      do
      {
        for (i = 0; i != v19; ++i)
        {
          if (*v25 != v20)
          {
            objc_enumerationMutation(v18);
          }

          [(UICollectionView *)self _reusePrefetchedCell:*(*(&v24 + 1) + 8 * i), v24];
        }

        v19 = [v18 countByEnumeratingWithState:&v24 objects:v35 count:16];
      }

      while (v19);
    }

    _Block_object_dispose(&v29, 8);
    _Block_object_dispose(&buf, 8);
  }
}

void __57__UICollectionView__pruneCachedPrefetchViewsForVelocity___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v6 = *(a3 + 24);
  }

  else
  {
    v6 = 0;
  }

  v7 = v6;

  if (v7)
  {
    v8 = *(*(a1 + 32) + 2152);
    if (a3)
    {
      v9 = *(a3 + 16);
      v10 = *(a3 + 16);
    }

    else
    {
      v9 = 0;
      v10 = 0;
    }

    v11 = v10;
    [v11 frame];
    [v8 _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v9 frame:?];
    v13 = v12;
    v15 = v14;
    v17 = v16;
    v19 = v18;

    v33.origin.x = v13;
    v33.origin.y = v15;
    v33.size.width = v17;
    v33.size.height = v19;
    if (!CGRectIntersectsRect(*(a1 + 56), v33))
    {
      v20 = *(*(*(a1 + 40) + 8) + 40);
      if (v20)
      {
        [v20 addObject:a2];
      }

      else
      {
        v21 = [objc_alloc(MEMORY[0x1E695DF70]) initWithObjects:{a2, 0}];
        v22 = *(*(a1 + 40) + 8);
        v23 = *(v22 + 40);
        *(v22 + 40) = v21;
      }

      v24 = *(*(*(a1 + 48) + 8) + 40);
      if (v24)
      {
        if (a3)
        {
          v25 = *(a3 + 24);
        }

        else
        {
          v25 = 0;
        }

        v31 = v25;
        [v24 addObject:?];
      }

      else
      {
        v26 = objc_alloc(MEMORY[0x1E695DF70]);
        if (a3)
        {
          v27 = *(a3 + 24);
        }

        else
        {
          v27 = 0;
        }

        v31 = v27;
        v28 = [v26 initWithObjects:{v31, 0}];
        v29 = *(*(a1 + 48) + 8);
        v30 = *(v29 + 40);
        *(v29 + 40) = v28;
      }
    }
  }
}

- (void)_reusePrefetchedCell:(id)cell
{
  v17 = *MEMORY[0x1E69E9840];
  cellCopy = cell;
  v5 = [(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:cellCopy];
  if (v5 & 1) != 0 || ([cellCopy _isInUpdateAnimation])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_reusePrefetchedCell____s_category);
    if (*CategoryCachedImpl)
    {
      v7 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        v8 = v7;
        v9 = 134218754;
        selfCopy = self;
        v11 = 1024;
        v12 = v5;
        v13 = 1024;
        _isInUpdateAnimation = [cellCopy _isInUpdateAnimation];
        v15 = 2112;
        v16 = cellCopy;
        _os_log_impl(&dword_188A29000, v8, OS_LOG_TYPE_ERROR, "[UICV %p] Skipping reuse of prefetched cell for reason isViewInReuseQueue(%d) inUpdateAnimation(%d): %@", &v9, 0x22u);
      }
    }
  }

  else
  {
    [(UICollectionView *)self _reuseCell:cellCopy notifyDidEndDisplaying:0];
  }
}

- (void)_prunePrefetchedViewsAtIndexPaths:(id)paths
{
  v31 = *MEMORY[0x1E69E9840];
  pathsCopy = paths;
  v5 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(pathsCopy, "count")}];
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v6 = pathsCopy;
  v7 = [v6 countByEnumeratingWithState:&v25 objects:v30 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v26;
    do
    {
      v10 = 0;
      do
      {
        if (*v26 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:*(*(&v25 + 1) + 8 * v10)];
        v12 = v11;
        if (v11)
        {
          v13 = *(v11 + 24);
        }

        else
        {
          v13 = 0;
        }

        v14 = v13;

        if (v14)
        {
          [v5 addObject:v14];
        }

        ++v10;
      }

      while (v8 != v10);
      v15 = [v6 countByEnumeratingWithState:&v25 objects:v30 count:16];
      v8 = v15;
    }

    while (v15);
  }

  [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectsForKeys:v6];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v16 = v5;
  v17 = [v16 countByEnumeratingWithState:&v21 objects:v29 count:16];
  if (v17)
  {
    v18 = v17;
    v19 = *v22;
    do
    {
      for (i = 0; i != v18; ++i)
      {
        if (*v22 != v19)
        {
          objc_enumerationMutation(v16);
        }

        [(UICollectionView *)self _reusePrefetchedCell:*(*(&v21 + 1) + 8 * i), v21];
      }

      v18 = [v16 countByEnumeratingWithState:&v21 objects:v29 count:16];
    }

    while (v18);
  }
}

- (void)_reorderPrefetchCandidates:(id)candidates forPrefetchVelocity:(CGVector)velocity visibleBounds:(CGRect)bounds
{
  height = bounds.size.height;
  width = bounds.size.width;
  y = bounds.origin.y;
  x = bounds.origin.x;
  dy = velocity.dy;
  dx = velocity.dx;
  candidatesCopy = candidates;
  if (fabs(dx) >= 2.22044605e-16)
  {
    v13 = *MEMORY[0x1E695EFF8];
    v14 = *(MEMORY[0x1E695EFF8] + 8);
    if (fabs(dy) < 2.22044605e-16)
    {
      goto LABEL_4;
    }

    if (dx <= 0.0)
    {
      if (dx >= 0.0)
      {
        goto LABEL_10;
      }

      v23.origin.x = x;
      v23.origin.y = y;
      v23.size.width = width;
      v23.size.height = height;
      MinX = CGRectGetMinX(v23);
    }

    else
    {
      v22.origin.x = x;
      v22.origin.y = y;
      v22.size.width = width;
      v22.size.height = height;
      MinX = CGRectGetMaxX(v22);
    }

    v13 = MinX;
LABEL_10:
    if (dy <= 0.0)
    {
      if (dy >= 0.0)
      {
LABEL_15:
        v15 = 0;
        goto LABEL_16;
      }

      v25.origin.x = x;
      v25.origin.y = y;
      v25.size.width = width;
      v25.size.height = height;
      MinY = CGRectGetMinY(v25);
    }

    else
    {
      v24.origin.x = x;
      v24.origin.y = y;
      v24.size.width = width;
      v24.size.height = height;
      MinY = CGRectGetMaxY(v24);
    }

    v14 = MinY;
    goto LABEL_15;
  }

  v13 = *MEMORY[0x1E695EFF8];
  v14 = *(MEMORY[0x1E695EFF8] + 8);
LABEL_4:
  v15 = 1;
LABEL_16:
  _hasOrthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __81__UICollectionView__reorderPrefetchCandidates_forPrefetchVelocity_visibleBounds___block_invoke;
  v19[3] = &unk_1E70FEF68;
  v20 = _hasOrthogonalScrollingSections;
  v19[4] = self;
  v21 = v15;
  *&v19[5] = dx;
  *&v19[6] = dy;
  *&v19[7] = v13;
  *&v19[8] = v14;
  [candidatesCopy sortUsingComparator:v19];
}

uint64_t __81__UICollectionView__reorderPrefetchCandidates_forPrefetchVelocity_visibleBounds___block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  if (a2)
  {
    a2 = a2[2];
  }

  if (a3)
  {
    v4 = *(a3 + 16);
  }

  else
  {
    v4 = 0;
  }

  if (*(a1 + 72) == 1)
  {
    v5 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a2];
  }

  else
  {
    [a2 frame];
  }

  v9 = v5;
  v10 = v6;
  v11 = v7;
  v12 = v8;
  if (*(a1 + 72) == 1)
  {
    v13 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:v4];
  }

  else
  {
    [v4 frame];
  }

  v17 = v13;
  v18 = v14;
  v19 = v15;
  v20 = v16;
  if (*(a1 + 73) == 1)
  {
    v21 = *(a1 + 40);
    rect = v12;
    if (v21 > 0.0)
    {
      v36.origin.x = v9;
      v36.origin.y = v10;
      v36.size.width = v11;
      v36.size.height = v12;
      MinX = CGRectGetMinX(v36);
      v37.origin.x = v17;
      v37.origin.y = v18;
      v37.size.width = v19;
      v37.size.height = v20;
      if (MinX <= CGRectGetMinX(v37))
      {
        v38.origin.x = v9;
        v38.origin.y = v10;
        v38.size.width = v11;
        v38.size.height = rect;
        v23 = CGRectGetMinX(v38);
        v39.origin.x = v17;
        v39.origin.y = v18;
        v39.size.width = v19;
        v39.size.height = v20;
        v24 = CGRectGetMinX(v39);
        goto LABEL_15;
      }

      return 1;
    }

    if (v21 < 0.0)
    {
      v40.origin.x = v9;
      v40.origin.y = v10;
      v40.size.width = v11;
      v40.size.height = v12;
      v29 = CGRectGetMinX(v40);
      v41.origin.x = v17;
      v41.origin.y = v18;
      v41.size.width = v19;
      v41.size.height = v20;
      if (v29 >= CGRectGetMinX(v41))
      {
        v42.origin.x = v9;
        v42.origin.y = v10;
        v42.size.width = v11;
        v42.size.height = rect;
        v30 = CGRectGetMinX(v42);
        v43.origin.x = v17;
        v43.origin.y = v18;
        v43.size.width = v19;
        v43.size.height = v20;
        if (v30 <= CGRectGetMinX(v43))
        {
          return 0;
        }

        return -1;
      }

      return 1;
    }

    v31 = *(a1 + 48);
    if (v31 > 0.0)
    {
      v44.origin.x = v9;
      v44.origin.y = v10;
      v44.size.width = v11;
      v44.size.height = v12;
      MinY = CGRectGetMinY(v44);
      v45.origin.x = v17;
      v45.origin.y = v18;
      v45.size.width = v19;
      v45.size.height = v20;
      if (MinY <= CGRectGetMinY(v45))
      {
        v46.origin.x = v9;
        v46.origin.y = v10;
        v46.size.width = v11;
        v46.size.height = rect;
        v23 = CGRectGetMinY(v46);
        v47.origin.x = v17;
        v47.origin.y = v18;
        v47.size.width = v19;
        v47.size.height = v20;
        v24 = CGRectGetMinY(v47);
LABEL_15:
        if (v23 >= v24)
        {
          return 0;
        }

        return -1;
      }

      return 1;
    }

    if (v31 < 0.0)
    {
      v48.origin.x = v9;
      v48.origin.y = v10;
      v48.size.width = v11;
      v48.size.height = v12;
      MaxY = CGRectGetMaxY(v48);
      v49.origin.x = v17;
      v49.origin.y = v18;
      v49.size.width = v19;
      v49.size.height = v20;
      if (MaxY > CGRectGetMaxY(v49))
      {
        return -1;
      }

      v50.origin.x = v9;
      v50.origin.y = v10;
      v50.size.width = v11;
      v50.size.height = rect;
      v34 = CGRectGetMaxY(v50);
      v51.origin.x = v17;
      v51.origin.y = v18;
      v51.size.width = v19;
      v51.size.height = v20;
      if (v34 < CGRectGetMaxY(v51))
      {
        return 1;
      }
    }
  }

  else
  {
    UIDistanceBetweenPointAndRect(*(a1 + 56), *(a1 + 64), v9, v10, v11, v12);
    v26 = v25;
    UIDistanceBetweenPointAndRect(*(a1 + 56), *(a1 + 64), v17, v18, v19, v20);
    if (v26 > v27)
    {
      return 1;
    }

    if (v26 < v27)
    {
      return -1;
    }
  }

  return 0;
}

- (double)_layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:(uint64_t)offset
{
  if (!offset)
  {
    return 0.0;
  }

  [a2 frame];
  v5 = v4;
  v7 = v6;
  v9 = v8;
  v11 = v10;
  if ([*(offset + 2152) _hasOrthogonalScrollingSections])
  {
    indexPath = [a2 indexPath];
    section = [indexPath section];

    _orthogonalScrollingSections = [*(offset + 2152) _orthogonalScrollingSections];
    v15 = [_orthogonalScrollingSections containsIndex:section];

    if (v15)
    {
      [*(offset + 2152) _offsetForOrthogonalScrollingSection:section];
      v17 = v16;
      v20.origin.x = v5;
      v20.origin.y = v7;
      v20.size.width = v9;
      v20.size.height = v11;
      v18 = CGRectGetMinX(v20) - v17;
      v21.origin.x = v5;
      v21.origin.y = v7;
      v21.size.width = v9;
      v21.size.height = v11;
      CGRectGetMinY(v21);
      v22.origin.x = v5;
      v22.origin.y = v7;
      v22.size.width = v9;
      v22.size.height = v11;
      CGRectGetWidth(v22);
      v23.origin.x = v5;
      v23.origin.y = v7;
      v23.size.width = v9;
      v23.size.height = v11;
      CGRectGetHeight(v23);
      return v18;
    }
  }

  return v5;
}

- (CGVector)_unitVectorForVector:(CGVector)vector
{
  v3 = vector.dx < 0.0;
  if (vector.dx > 0.0)
  {
    v4 = 1.0;
  }

  else
  {
    v4 = 0.0;
  }

  if (v3)
  {
    v4 = -1.0;
  }

  v5 = vector.dy < 0.0;
  if (vector.dy > 0.0)
  {
    v6 = 1.0;
  }

  else
  {
    v6 = 0.0;
  }

  if (v5)
  {
    v6 = -1.0;
  }

  result.dy = v6;
  result.dx = v4;
  return result;
}

- (void)_performReloadPrefetchIfNeeded
{
  v33 = *MEMORY[0x1E69E9840];
  if ((*(&self->_collectionViewFlags + 14) & 0x80) != 0 && [(UICollectionView *)self _prefetchingAllowed])
  {
    [(UICollectionView *)self _visibleBounds];
    x = v34.origin.x;
    y = v34.origin.y;
    width = v34.size.width;
    height = v34.size.height;
    v7 = CGRectGetWidth(v34) * -0.5;
    v35.origin.x = x;
    v35.origin.y = y;
    v35.size.width = width;
    v35.size.height = height;
    v8 = CGRectGetHeight(v35) * -0.5;
    v36.origin.x = x;
    v36.origin.y = y;
    v36.size.width = width;
    v36.size.height = height;
    v37 = CGRectInset(v36, v7, v8);
    v9 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v37.origin.x validateLayout:v37.origin.y, v37.size.width, v37.size.height];
    [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
    v30 = 0u;
    v31 = 0u;
    v28 = 0u;
    v29 = 0u;
    v10 = v9;
    v11 = [v10 countByEnumeratingWithState:&v28 objects:v32 count:16];
    if (v11)
    {
      v12 = v11;
      v13 = *v29;
      v27 = v10;
      do
      {
        v14 = 0;
        do
        {
          if (*v29 != v13)
          {
            objc_enumerationMutation(v10);
          }

          v15 = *(*(&v28 + 1) + 8 * v14);
          indexPath = [v15 indexPath];
          v17 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:indexPath];

          if (!v17)
          {
            v18 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:indexPath];

            if (!v18)
            {
              v19 = [[_UICollectionViewPrefetchItem alloc] initWithAttributes:v15];
              v20 = v19;
              if (v19)
              {
                v21 = v19[2];
                v22 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:indexPath withLayoutAttributes:v21 applyAttributes:0 isFocused:0 notify:0];
                [(_UIHomeAffordanceObservationRecord *)v20 setLegacyViewServiceSessionIdentifier:v22];

                v23 = v20[3];
              }

              else
              {
                v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:indexPath withLayoutAttributes:0 applyAttributes:0 isFocused:0 notify:0];
                [(_UIHomeAffordanceObservationRecord *)0 setLegacyViewServiceSessionIdentifier:v25];

                v23 = 0;
              }

              v24 = v23;
              [v24 _setHiddenForReuse:1];

              [(NSMutableDictionary *)self->_prefetchCacheItems setObject:v20 forKeyedSubscript:indexPath];
              v10 = v27;
            }
          }

          ++v14;
        }

        while (v12 != v14);
        v26 = [v10 countByEnumeratingWithState:&v28 objects:v32 count:16];
        v12 = v26;
      }

      while (v26);
    }

    [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  }
}

void __47__UICollectionView__resetPrefetchedCachedCells__block_invoke(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v4 = *(a3 + 24);
    if (v4)
    {
      v5 = v4;
      if (([v4 _isInUpdateAnimation] & 1) == 0)
      {
        [*(a1 + 32) addObject:v5];
      }

      v4 = v5;
    }
  }

  else
  {
    v4 = 0;
  }
}

- (void)_resetPrefetchingContext:(id)context
{
  contextCopy = context;
  v5 = contextCopy;
  if (contextCopy)
  {
    if ((*(&self->_collectionViewFlags + 8) & 0x80) != 0)
    {
      v9 = contextCopy;
      v6 = [contextCopy[2] count];
      v5 = v9;
      if (v6)
      {
        _prefetchDataSourceProxy = [(UICollectionView *)self _prefetchDataSourceProxy];
        remainingIndexPaths = [(_UICollectionViewPrefetchingContext *)v9 remainingIndexPaths];
        [_prefetchDataSourceProxy collectionView:self cancelPrefetchingForItemsAtIndexPaths:remainingIndexPaths];

        v5 = v9;
      }
    }
  }
}

- (void)_updatePrefetchVelocityIntegratorForVisibleBounds:(CGRect)bounds
{
  y = bounds.origin.y;
  x = bounds.origin.x;
  prefetchVelocityIntegrator = self->_prefetchVelocityIntegrator;
  if (!prefetchVelocityIntegrator)
  {
    v7 = objc_alloc_init(_UIVelocityIntegrator);
    v8 = self->_prefetchVelocityIntegrator;
    self->_prefetchVelocityIntegrator = v7;

    [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator setHysteresisTimeInterval:0.3];
    v9 = self->_prefetchVelocityIntegrator;
    if (v9)
    {
      v9->_resetHysteresisOnSampleThetaDiff = 1.04719755;
    }

    objc_initWeak(&location, self);
    v12 = MEMORY[0x1E69E9820];
    v13 = 3221225472;
    v14 = __70__UICollectionView__updatePrefetchVelocityIntegratorForVisibleBounds___block_invoke;
    v15 = &unk_1E70F5A28;
    objc_copyWeak(&v16, &location);
    v11 = self->_prefetchVelocityIntegrator;
    if (v11)
    {
      objc_setProperty_nonatomic_copy(v11, v10, &v12, 120);
    }

    objc_destroyWeak(&v16);
    objc_destroyWeak(&location);
    prefetchVelocityIntegrator = self->_prefetchVelocityIntegrator;
  }

  [(_UIVelocityIntegrator *)prefetchVelocityIntegrator addSample:x, y, bounds.size.width, bounds.size.height, v12, v13, v14, v15];
}

void __70__UICollectionView__updatePrefetchVelocityIntegratorForVisibleBounds___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _resetAllPrefetchContexts];
}

- (void)_rebasePrefetchedCellIndexPathsWithMapping:(id)mapping
{
  mappingCopy = mapping;
  if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    v5 = [(NSMutableDictionary *)self->_prefetchCacheItems copy];
    [(NSMutableDictionary *)self->_prefetchCacheItems removeAllObjects];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __63__UICollectionView__rebasePrefetchedCellIndexPathsWithMapping___block_invoke;
    v6[3] = &unk_1E70FEFE0;
    v6[4] = self;
    v7 = mappingCopy;
    [v5 enumerateKeysAndObjectsUsingBlock:v6];
  }
}

void __63__UICollectionView__rebasePrefetchedCellIndexPathsWithMapping___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v29 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v7 = (*(*(a1 + 40) + 16))();
  if (v7)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", _UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_5___s_category);
    if (*CategoryCachedImpl)
    {
      v12 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        v13 = *(a1 + 32);
        v14 = v12;
        if (v6)
        {
          v15 = v6[3];
        }

        else
        {
          v15 = 0;
        }

        v16 = v15;
        v17 = [v5 _ui_shortDescription];
        v18 = [v7 _ui_shortDescription];
        v19 = 134219010;
        v20 = v13;
        v21 = 2048;
        v22 = v6;
        v23 = 2048;
        v24 = v16;
        v25 = 2112;
        v26 = v17;
        v27 = 2112;
        v28 = v18;
        _os_log_impl(&dword_188A29000, v14, OS_LOG_TYPE_ERROR, "[UICV %p] Rebasing prefetch item (%p) with view %p from %@ to %@", &v19, 0x34u);
      }
    }

    if (v6)
    {
      *(v6 + 8) |= 1u;
    }

    [*(*(a1 + 32) + 2824) setObject:v6 forKey:v7];
  }

  else
  {
    v9 = *(a1 + 32);
    if (v6)
    {
      v10 = v6[3];
    }

    else
    {
      v10 = 0;
    }

    v11 = v10;
    [v9 _reusePrefetchedCell:v11];
  }
}

- (BOOL)_updatePrefetchedCells:(BOOL)cells
{
  cellsCopy = cells;
  if (![(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator hasVelocity])
  {
    _hasOrthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
    if (!_hasOrthogonalScrollingSections)
    {
      return _hasOrthogonalScrollingSections;
    }
  }

  [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator velocity];
  v8 = v6;
  v9 = v7;
  if (self->_activeOrthogonalPrefetchingContext)
  {
    if (cellsCopy)
    {
      goto LABEL_5;
    }

LABEL_9:
    LOBYTE(_hasOrthogonalScrollingSections) = 0;
    return _hasOrthogonalScrollingSections;
  }

  [(UICollectionView *)self _pruneCachedPrefetchViewsForVelocity:v6, v7];
  if (!cellsCopy)
  {
    goto LABEL_9;
  }

LABEL_5:
  mainPrefetchingContext = self->_mainPrefetchingContext;
  if (mainPrefetchingContext && [(NSMutableArray *)mainPrefetchingContext->_items count])
  {
    [(UICollectionView *)self _prefetchItemsForPrefetchingContext:self->_mainPrefetchingContext];
  }

  else
  {
    [(UICollectionView *)self _computeMainPrefetchCandidatesForVelocity:v8, v9];
  }

  LOBYTE(_hasOrthogonalScrollingSections) = 1;
  return _hasOrthogonalScrollingSections;
}

- (void)_updateCycleIdleUntil:(unint64_t)until
{
  v28 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained && [(UICollectionView *)self _prefetchingAllowed])
  {
    v6 = mach_absolute_time();
    v7 = v6;
    if (until >= v6)
    {
      v8 = until - v6;
    }

    else
    {
      v8 = 0;
    }

    v9 = _UISetCurrentFallbackEnvironment(self);
    if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
    {
      v18 = 0;
      v19 = &v18;
      v20 = 0x3032000000;
      v21 = __Block_byref_object_copy__39;
      v22 = __Block_byref_object_dispose__39;
      v23 = 0;
      [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
      prefetchCacheItems = self->_prefetchCacheItems;
      v17[0] = MEMORY[0x1E69E9820];
      v17[1] = 3221225472;
      v17[2] = __42__UICollectionView__updateCycleIdleUntil___block_invoke;
      v17[3] = &unk_1E70FF008;
      v17[4] = self;
      v17[5] = &v18;
      v17[6] = until;
      [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v17];
      [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
      if (v19[5])
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_updateCycleIdleUntil____s_category);
        if (*CategoryCachedImpl)
        {
          v15 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
          {
            v16 = v19[5];
            *buf = 134218242;
            selfCopy = self;
            v26 = 2112;
            v27 = v16;
            _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "[UICV %p] Pruning invalid prefetch items at index paths: %@", buf, 0x16u);
          }
        }

        [(UICollectionView *)self _prunePrefetchedViewsAtIndexPaths:v19[5]];
      }

      _Block_object_dispose(&v18, 8);
    }

    v12 = mach_absolute_time();
    if (v7 < until && ((v12 - v7) / v8) <= 0.1)
    {
      v13 = self->_activeOrthogonalPrefetchingContext;
      v14 = v13;
      if (v13 && [(NSMutableArray *)v13->_items count])
      {
        [(UICollectionView *)self _prefetchItemsForPrefetchingContext:v14];
      }

      else
      {
        [(UICollectionView *)self _updatePrefetchedCells:1];
      }
    }

    _UIRestorePreviousFallbackEnvironment(v9);
  }
}

uint64_t __42__UICollectionView__updateCycleIdleUntil___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (([*(a1 + 32) _updatePrefetchItemIfNeeded:a3 forIndexPath:a2 withLayoutAttributes:0 willDisplay:0] & 1) == 0)
  {
    v7 = *(*(*(a1 + 40) + 8) + 40);
    if (v7)
    {
      [v7 addObject:a2];
    }

    else
    {
      v8 = [objc_alloc(MEMORY[0x1E695DF70]) initWithObjects:{a2, 0}];
      v9 = *(*(a1 + 40) + 8);
      v10 = *(v9 + 40);
      *(v9 + 40) = v8;
    }
  }

  result = mach_absolute_time();
  if (result >= *(a1 + 48))
  {
    *a4 = 1;
  }

  return result;
}

- (_BYTE)_isContentOffset:(CGFloat)offset atStartOfAxis:(CGFloat)axis
{
  if (result)
  {
    v7 = result;
    [result _contentInsetIncludingDecorations];
    if (a2 == 1)
    {
      v12 = v9;
      if (v7[106] & 0x40) == 0 || (v13 = v10, ([v7 _flipsHorizontalAxis]))
      {
        v11 = offset + v12;
        return (v11 <= 0.001);
      }

      [v7 contentSize];
      v15 = v14;
      [v7 bounds];
      v16.origin.x = offset;
      v16.origin.y = axis;
      return (CGRectGetMaxX(v16) - (v13 + v15) + 0.001 >= 0.0);
    }

    else
    {
      if (a2 == 2)
      {
        v11 = axis + v8;
        return (v11 <= 0.001);
      }

      return 0;
    }
  }

  return result;
}

BOOL __77__UICollectionView__saveContentOffsetRestorationAnchorIfNecessaryUsingModel___block_invoke(uint64_t a1, void *a2)
{
  v3 = [a2 indexPath];
  if (*(*(a1 + 32) + 2280) && +[UIView areAnimationsEnabled])
  {
    if (([(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) hasMovedItemWithSourceIndexPath:v3]& 1) != 0)
    {
      v4 = 0;
    }

    else
    {
      v6 = [*(*(a1 + 32) + 2280) finalIndexPathForInitialIndexPath:v3];
      v4 = v6 != 0;
    }
  }

  else
  {
    v4 = 1;
  }

  return v4;
}

- (id)_layoutAttributesClosestToReferencePoint:(uint64_t)point amongCandidates:(void *)candidates onAxis:(double)axis shouldConsiderBlock:(double)block
{
  v40 = *MEMORY[0x1E69E9840];
  candidatesCopy = candidates;
  if (self)
  {
    v37 = 0u;
    v38 = 0u;
    v35 = 0u;
    v36 = 0u;
    obj = a2;
    v11 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
    if (v11)
    {
      v12 = v11;
      v13 = 0;
      v14 = *v36;
      v15 = (candidatesCopy + 2);
      v16 = 1.79769313e308;
      do
      {
        v17 = 0;
        v32 = v12;
        do
        {
          if (*v36 != v14)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v35 + 1) + 8 * v17);
          if (candidatesCopy[2](candidatesCopy, v18))
          {
            indexPath = [v18 indexPath];
            [v18 frame];
            v22 = _UICollectionLayoutDistanceBetweenPointsOnAxis(point, axis, block, v20, v21);
            v23 = v22;
            if (v22 < v16 || vabdd_f64(v22, v16) <= 0.001 && ((v25 = [v13 indexPath], v26 = v15, v27 = objc_msgSend(indexPath, "section"), v28 = v27 < objc_msgSend(v25, "section"), v15 = v26, v12 = v32, v28) || (v29 = objc_msgSend(indexPath, "item"), v29 < objc_msgSend(v25, "item"))))
            {
              v24 = v18;

              v16 = v23;
              v13 = v24;
            }
          }

          ++v17;
        }

        while (v12 != v17);
        v30 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
        v12 = v30;
      }

      while (v30);
    }

    else
    {
      v13 = 0;
    }
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

- (void)_rebaseContentOffsetAnchorOrScrollTargetForUpdate:(id)update
{
  v29 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  if (dyld_program_sdk_at_least())
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __70__UICollectionView__rebaseContentOffsetAnchorOrScrollTargetForUpdate___block_invoke;
    aBlock[3] = &unk_1E70FF058;
    v5 = updateCopy;
    v22 = v5;
    v6 = _Block_copy(aBlock);
    v7 = self->_scrollingTargetIndexPath;
    v8 = self->_contentOffsetRestorationAnchor;
    v9 = v8;
    if (v7)
    {
      if (v6[2](v6, v7))
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492410);
        if (*CategoryCachedImpl)
        {
          v17 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            *buf = 134217984;
            selfCopy3 = self;
            _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; clearing scrolling target index path", buf, 0xCu);
          }
        }

        [(UICollectionView *)self _clearTargetIndexPathForScrolling];
      }

      else
      {
        v12 = [v5 finalIndexPathForInitialIndexPath:v7];
        scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
        self->_scrollingTargetIndexPath = v12;
      }
    }

    else if (v8)
    {
      if (v6[2](v6, v8))
      {
        v11 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492418);
        if (*v11)
        {
          v18 = *(v11 + 8);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
          {
            *buf = 134217984;
            selfCopy3 = self;
            _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; clearing restoration anchor that was moved or deleted", buf, 0xCu);
          }
        }

        [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
      }

      else
      {
        v14 = [v5 finalIndexPathForInitialIndexPath:v9];
        contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
        self->_contentOffsetRestorationAnchor = v14;

        v16 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492420);
        if (*v16)
        {
          v19 = *(v16 + 8);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v20 = self->_contentOffsetRestorationAnchor;
            *buf = 134218498;
            selfCopy3 = self;
            v25 = 2112;
            v26 = v9;
            v27 = 2112;
            v28 = v20;
            _os_log_impl(&dword_188A29000, v19, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; rebased restoration anchor from %@ to %@", buf, 0x20u);
          }
        }
      }
    }
  }
}

BOOL __70__UICollectionView__rebaseContentOffsetAnchorOrScrollTargetForUpdate___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if (([(UICollectionViewUpdate *)*(a1 + 32) hasMovedItemWithSourceIndexPath:v3]& 1) != 0)
  {
    v4 = 1;
  }

  else
  {
    v5 = [*(a1 + 32) finalIndexPathForInitialIndexPath:v3];
    v4 = v5 == 0;
  }

  return v4;
}

- (uint64_t)_restoreOrAdjustContentOffsetIfNecessaryWithInsets:(char)insets hasUpdatedVisibleCells:(double)cells isRecursive:(double)recursive
{
  v103 = *MEMORY[0x1E69E9840];
  if (!result)
  {
    return result;
  }

  v9 = result;
  result = [*(result + 2152) _estimatesSizes];
  if ((result & 1) == 0)
  {
    [v9 _clearContentOffsetRestorationAnchor];
    result = [v9 _clearTargetIndexPathForScrolling];
  }

  *(v9 + 2736) &= ~0x400000u;
  v10 = *(v9 + 3024);
  if (v10)
  {
    if ([v9 _validateScrollingTargetIndexPath:v10 raisingExceptionIfNecessary:0])
    {
      v11 = *(v9 + 3024);
      if (!v11)
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler handleFailureInMethod:sel__contentOffsetForCurrentScrollingTargetWithContentInsets_ object:v9 file:@"UICollectionView.m" lineNumber:5378 description:{@"Invalid parameter not satisfying: %@", @"targetIndexPathForScrolling != nil"}];
      }

      v111.origin.x = [(UICollectionView *)v9 _frameOfElementAtScrollingTargetIndexPath:v11];
      width = v111.size.width;
      height = v111.size.height;
      x = v111.origin.x;
      y = v111.origin.y;
      if (CGRectIsNull(v111))
      {
        currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
        v70 = objc_opt_class();
        _ui_shortDescription = [v11 _ui_shortDescription];
        [currentHandler2 handleFailureInMethod:sel__contentOffsetForCurrentScrollingTargetWithContentInsets_ object:v9 file:@"UICollectionView.m" lineNumber:5381 description:{@"<%@ %p> received null frame for scrolling target at index path %@.\nCollection View: %@.\nLayout: %@", v70, v9, _ui_shortDescription, v9, *(v9 + 2152)}];
      }

      _layoutAxis = [*(v9 + 2152) _layoutAxis];
      v15 = *(v9 + 3048);
      v16 = *(v9 + 3056);
      v17 = *(v9 + 3064);
      v18 = *(v9 + 3072);
      v19 = *(v9 + 3080);
      if (_UISizeEqualToSizeWithPrecision(v18, v19, width, height, 0.0001))
      {
        [v9 contentOffset];
        v21 = v20;
        v23 = v22;
        v24 = _UIPointValueForAxis(_layoutAxis, x, y);
        v25 = v24 + _UIPointValueForAxis(_layoutAxis, *(v9 + 3032), *(v9 + 3040));
        if (_layoutAxis == 2)
        {
          recursiveCopy = cells;
        }

        else
        {
          recursiveCopy = recursive;
        }

        v27 = _UISetPointValueForAxis(_layoutAxis, v21, v23, v25 - recursiveCopy);
        v29 = *(v9 + 2272);
        if (v29)
        {
          v30 = *(v29 + 80);
          v31 = *(v29 + 88);
        }

        else
        {
          v31 = 0.0;
          v30 = 0.0;
        }

        v32 = [(UICollectionView *)v9 _clampedContentOffset:v9 forScrollableAreaGivenContentSize:v27 inScrollView:v28, v30, v31];
        v34 = v33;
      }

      else
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492448);
        if (*CategoryCachedImpl)
        {
          v74 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v74, OS_LOG_TYPE_ERROR))
          {
            v75 = v74;
            v118.origin.x = v16;
            v118.origin.y = v17;
            v118.size.width = v18;
            v118.size.height = v19;
            v76 = NSStringFromCGRect(v118);
            v119.origin.x = x;
            v119.origin.y = y;
            v119.size.width = width;
            v119.size.height = height;
            v77 = NSStringFromCGRect(v119);
            _ui_shortDescription2 = [v11 _ui_shortDescription];
            *buf = 134218754;
            v96 = v9;
            v97 = 2112;
            v98 = v76;
            v99 = 2112;
            v100 = v77;
            v101 = 2112;
            v102 = _ui_shortDescription2;
            _os_log_impl(&dword_188A29000, v75, OS_LOG_TYPE_ERROR, "_contentOffsetForCurrentScrollingTarget: cv == %p; updating scrolling target info for change in size of target %@ from %@ to %@", buf, 0x2Au);
          }
        }

        [v9 _contentOffsetForScrollingToItemAtIndexPath:v11 atScrollPosition:v15 additionalInsets:{*(v9 + 3088), *(v9 + 3096), *(v9 + 3104), *(v9 + 3112)}];
        v32 = v47;
        v34 = v48;
        [(UICollectionView *)v9 _storeScrollingTargetInfoForIndexPath:v11 frame:v15 scrollPosition:x additionalInsets:y, width, height, *(v9 + 3088), *(v9 + 3096), *(v9 + 3104), *(v9 + 3112)];
      }

      if ([v9 isScrollAnimating])
      {
        v49 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492428);
        if (*v49)
        {
          v79 = *(v49 + 8);
          if (os_log_type_enabled(v79, OS_LOG_TYPE_ERROR))
          {
            v80 = v79;
            v109.x = v32;
            v109.y = v34;
            v81 = NSStringFromCGPoint(v109);
            _ui_shortDescription3 = [*(v9 + 3024) _ui_shortDescription];
            *buf = 134218498;
            v96 = v9;
            v97 = 2112;
            v98 = v81;
            v99 = 2112;
            v100 = _ui_shortDescription3;
            _os_log_impl(&dword_188A29000, v80, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Updating scroll animation to target offset %@ for %@", buf, 0x20u);
          }
        }

        return [v9 _updateScrollAnimationForChangedTargetOffset:{v32, v34}];
      }

      v50 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492430);
      if (*v50)
      {
        v83 = *(v50 + 8);
        if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
        {
          v84 = v83;
          v110.x = v32;
          v110.y = v34;
          v85 = NSStringFromCGPoint(v110);
          _ui_shortDescription4 = [*(v9 + 3024) _ui_shortDescription];
          *buf = 134218498;
          v96 = v9;
          v97 = 2112;
          v98 = v85;
          v99 = 2112;
          v100 = _ui_shortDescription4;
          _os_log_impl(&dword_188A29000, v84, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Setting content offset to %@ for scrolling to %@", buf, 0x20u);
        }
      }

      v51 = *(v9 + 3352);
      if (!v51)
      {
LABEL_35:
        v59 = *(v9 + 2736);
        *(v9 + 2736) = v59 | 0x80000;
        result = [v9 setContentOffset:{v32, v34}];
        *(v9 + 2736) = *(v9 + 2736) & 0xFFF7FFFF | (((v59 >> 19) & 1) << 19);
        return result;
      }

      v52 = MEMORY[0x1E696AEC0];
      [v9 contentOffset];
      v44 = NSStringFromCGPoint(v105);
      v106.x = v32;
      v106.y = v34;
      v53 = NSStringFromCGPoint(v106);
      _ui_shortDescription5 = [*(v9 + 3024) _ui_shortDescription];
      v55 = NSStringFromCGPoint(*(v9 + 3032));
      [v9 _effectiveContentInset];
      v56 = NSStringFromUIEdgeInsets(v114);
      [v9 safeAreaInsets];
      v57 = NSStringFromUIEdgeInsets(v115);
      v58 = [v52 stringWithFormat:@"content offset changing from %@ to %@ for scrolling to %@ with offset %@ effectiveInsets: %@; safeAreaInsets: %@", v44, v53, _ui_shortDescription5, v55, v56, v57];;
      [v51 recordGenericChangeWithMessage:v58];

LABEL_34:
      goto LABEL_35;
    }

    v45 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492438);
    if (*v45)
    {
      v72 = *(v45 + 8);
      if (os_log_type_enabled(v72, OS_LOG_TYPE_ERROR))
      {
        v73 = *(v9 + 3024);
        *buf = 134218242;
        v96 = v9;
        v97 = 2112;
        v98 = v73;
        _os_log_impl(&dword_188A29000, v72, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Clearing invalid scrolling target %@", buf, 0x16u);
      }
    }

    return [v9 _clearTargetIndexPathForScrolling];
  }

  else if (*(v9 + 3000))
  {
    v94 = 0;
    v35 = [(UICollectionView *)v9 _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:cells shouldApply:recursive];
    if (v94 == 1)
    {
      v32 = v35;
      v34 = v36;
      v37 = *(v9 + 3352);
      if (v37)
      {
        v93 = MEMORY[0x1E696AEC0];
        _ui_shortDescription6 = [*(v9 + 3000) _ui_shortDescription];
        v39 = NSStringFromCGPoint(*(v9 + 3008));
        v40 = [(UICollectionViewData *)*(v9 + 2272) layoutAttributesForItemAtIndexPath:?];
        [v9 _effectiveContentInset];
        v41 = NSStringFromUIEdgeInsets(v112);
        [v9 safeAreaInsets];
        v42 = NSStringFromUIEdgeInsets(v113);
        v43 = [v93 stringWithFormat:@"Setting content offset for restoring relative scroll position to %@ with offset %@ attributes: %@; effectiveInsets: %@; safeAreaInsets: %@", _ui_shortDescription6, v39, v40, v41, v42];;
        [v37 recordGenericChangeWithMessage:v43];
      }

      if (a2 & 1) != 0 || (insets)
      {
        goto LABEL_35;
      }

      v44 = [MEMORY[0x1E695DFB8] orderedSetWithObject:*(v9 + 3000)];
      [(UICollectionView *)v9 _addIndexPathsRequiringPreferredAttributes:v44];
      goto LABEL_34;
    }

    v60 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492440);
    if (*v60)
    {
      v87 = *(v60 + 8);
      if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
      {
        v88 = *(v9 + 3000);
        v89 = v87;
        _ui_shortDescription7 = [v88 _ui_shortDescription];
        *buf = 134218242;
        v96 = v9;
        v97 = 2112;
        v98 = _ui_shortDescription7;
        _os_log_impl(&dword_188A29000, v89, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Clearing invalid restoration anchor %@", buf, 0x16u);
      }
    }

    return [v9 _clearContentOffsetRestorationAnchor];
  }

  else if ((*(v9 + 2738) & 0x20) != 0)
  {
    result = [v9 isDragging];
    if ((result & 1) == 0)
    {
      if ([v9 isDecelerating])
      {
        [v9 contentOffset];
        [v9 contentOffset];

        return [v9 _updateDecelerationLastOffset:?];
      }

      else
      {
        v61 = *(v9 + 3352);
        if (v61)
        {
          v62 = MEMORY[0x1E696AEC0];
          [v9 contentOffset];
          v63 = NSStringFromCGPoint(v107);
          [v9 contentSize];
          v64 = NSStringFromCGSize(v108);
          [v9 _effectiveContentInset];
          v65 = NSStringFromUIEdgeInsets(v116);
          [v9 safeAreaInsets];
          v66 = NSStringFromUIEdgeInsets(v117);
          v67 = [v62 stringWithFormat:@"Adjusting content offset after layout. Current contentOffset: %@ contentSize: %@; effectiveInsets: %@; safeAreaInsets: %@.", v63, v64, v65, v66];;
          [v61 recordGenericChangeWithMessage:v67];
        }

        return [v9 _adjustContentOffsetIfNecessary];
      }
    }
  }

  return result;
}

- (double)_contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:(double)insets shouldApply:(double)apply
{
  v40 = *MEMORY[0x1E69E9840];
  if (!self)
  {
    return 0.0;
  }

  if (!a2)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:sel__contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets_shouldApply_ object:self file:@"UICollectionView.m" lineNumber:5418 description:{@"Invalid parameter not satisfying: %@", @"shouldApply != NULL"}];
  }

  [self contentOffset];
  v9 = v8;
  v11 = v10;
  *a2 = 0;
  _layoutAxis = [*(self + 2152) _layoutAxis];
  if ((_layoutAxis - 1) <= 1)
  {
    v13 = _layoutAxis;
    if (([self isScrollAnimating] & 1) == 0 && ((dyld_program_sdk_at_least() & 1) != 0 || (objc_msgSend(self, "isDecelerating") & 1) == 0 && (objc_msgSend(self, "isTracking") & 1) == 0))
    {
      if (*(self + 2280) && (dyld_program_sdk_at_least() & 1) == 0 && [*(*(self + 2280) + 8) count])
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492450);
        if ((*CategoryCachedImpl & 1) == 0)
        {
          return v9;
        }

        v15 = *(CategoryCachedImpl + 8);
        if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          return v9;
        }

        *buf = 134217984;
        selfCopy2 = self;
        v16 = "_contentOffsetForRestoringPosition: cv == %p; Not restoring -- have in-flight update";
        v17 = v15;
        v18 = 12;
      }

      else
      {
        v19 = *(self + 2272);
        if (v19 && ([(UICollectionViewData *)v19 _isIndexPathValid:1 validateItemCounts:?]& 1) != 0)
        {
          v20 = [(UICollectionViewData *)*(self + 2272) layoutAttributesForItemAtIndexPath:?];
          [v20 frame];
          v23 = _UIPointValueForAxis(v13, v21, v22);
          v24 = v23 + _UIPointValueForAxis(v13, *(self + 3008), *(self + 3016));
          if (v13 == 2)
          {
            applyCopy = insets;
          }

          else
          {
            applyCopy = apply;
          }

          v26 = _UISetPointValueForAxis(v13, v9, v11, v24 - applyCopy);
          v28 = v27;
          _isAutomaticContentOffsetAdjustmentEnabled = [self _isAutomaticContentOffsetAdjustmentEnabled];
          [self _setAutomaticContentOffsetAdjustmentEnabled:1];
          [(UICollectionViewData *)*(self + 2272) collectionViewContentRect];
          [self _adjustedContentOffsetForContentOffset:0 contentSize:v26 skipsAdjustmentIfScrolling:v28];
          v9 = v30;
          [self _setAutomaticContentOffsetAdjustmentEnabled:_isAutomaticContentOffsetAdjustmentEnabled];
          *a2 = 1;

          return v9;
        }

        v31 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492458);
        if ((*v31 & 1) == 0)
        {
          return v9;
        }

        v34 = *(v31 + 8);
        if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
        {
          return v9;
        }

        v35 = *(self + 3000);
        *buf = 134218242;
        selfCopy2 = self;
        v38 = 2112;
        v39 = v35;
        v16 = "_contentOffsetForRestoringPosition: cv == %p; the anchor %@ is no longer valid";
        v17 = v34;
        v18 = 22;
      }

      _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, v16, buf, v18);
    }
  }

  return v9;
}

- (void)_addIndexPathsRequiringPreferredAttributes:(uint64_t)attributes
{
  v3 = a2;
  if (attributes)
  {
    v4 = *(attributes + 2680);
    v7 = v3;
    if (v4)
    {
      [v4 unionOrderedSet:v3];
    }

    else
    {
      v5 = [v3 mutableCopy];
      v6 = *(attributes + 2680);
      *(attributes + 2680) = v5;
    }

    v3 = v7;
  }
}

- (void)_applyAutomaticAdjustedContentOffset:(CGPoint)offset
{
  y = offset.y;
  x = offset.x;
  p_collectionViewFlags = &self->_collectionViewFlags;
  v7 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v7 | 0x80000;
  v10.receiver = self;
  v10.super_class = UICollectionView;
  [(UIScrollView *)&v10 _applyAutomaticAdjustedContentOffset:?];
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFF7FFFF | (((v7 >> 19) & 1) << 19);
  [(UIScrollView *)self contentOffset];
  if (vabdd_f64(v9, x) >= 0.0001 || vabdd_f64(v8, y) >= 0.0001)
  {
    *(p_collectionViewFlags + 4) &= ~0x200000u;
  }
}

- (double)_frameOfElementAtScrollingTargetIndexPath:(uint64_t)path
{
  if (!path)
  {
    return 0.0;
  }

  section = [a2 section];
  if ([a2 item] == 0x7FFFFFFFFFFFFFFFLL)
  {
    [*(path + 2152) _frameForScrollingToFirstElementInSectionAtIndex:section];
    v6 = v5;
    v8 = v7;
    v10 = v9;
    v12 = v11;
  }

  else
  {
    v6 = *MEMORY[0x1E695F050];
    v8 = *(MEMORY[0x1E695F050] + 8);
    v10 = *(MEMORY[0x1E695F050] + 16);
    v12 = *(MEMORY[0x1E695F050] + 24);
  }

  v17.origin.x = v6;
  v17.origin.y = v8;
  v17.size.width = v10;
  v17.size.height = v12;
  if (CGRectIsNull(v17))
  {
    item = [a2 item];
    if (item < [(UICollectionViewData *)*(path + 2272) numberOfItemsInSection:section])
    {
      v14 = [(UICollectionViewData *)*(path + 2272) layoutAttributesForItemAtIndexPath:a2];
      [v14 frame];
      v6 = v15;
    }
  }

  return v6;
}

- (double)_clampedContentOffset:(double)offset forScrollableAreaGivenContentSize:(double)size inScrollView:(double)view
{
  v10 = a2;
  v11 = v10;
  if (self)
  {
    if (fabs(view * a6) >= 2.22044605e-16)
    {
      [v10 _maximumContentOffsetForContentSize:{view, a6}];
      v13 = v12;
      [v11 _minimumContentOffset];
      if (offset <= v13)
      {
        offsetCopy = offset;
      }

      else
      {
        offsetCopy = v13;
      }

      if (offsetCopy >= v14)
      {
        offset = offsetCopy;
      }

      else
      {
        offset = v14;
      }
    }
  }

  else
  {
    offset = 0.0;
  }

  return offset;
}

- (id)_storeScrollingTargetInfoForIndexPath:(void *)path frame:(double)frame scrollPosition:(double)position additionalInsets:(double)insets
{
  if (result)
  {
    if (a2)
    {
      v21 = result;
      [result _contentOffsetForScrollingToItemAtIndexPath:a2 atScrollPosition:path additionalInsets:result itemFrame:0 containingScrollView:a8 clampToScrollableArea:{a9, a10, a11, frame, position, insets, a7}];
      v26 = v23;
      v27 = v22;
      objc_storeStrong(v21 + 378, a2);
      v21[381] = path;
      *(v21 + 386) = a8;
      *(v21 + 387) = a9;
      *(v21 + 388) = a10;
      *(v21 + 389) = a11;
      *(v21 + 382) = frame;
      *(v21 + 383) = position;
      *(v21 + 384) = insets;
      *(v21 + 385) = a7;
      result = [v21 _contentInsetIncludingDecorations];
      *(v21 + 379) = v27 - frame + v24;
      *(v21 + 380) = v26 - position + v25;
    }
  }

  return result;
}

- (unint64_t)_updateVisibleCellsNow:(BOOL)now
{
  v153 = *MEMORY[0x1E69E9840];
  if (self->_reloadingSuspendedCount > 0)
  {
    return 0;
  }

  nowCopy = now;
  if (self->_updateAnimationCount >= 1 && (*(&self->_collectionViewFlags + 15) & 8) == 0)
  {
    return 0;
  }

  updateVisibleCellsRecursionCount = self->_updateVisibleCellsRecursionCount;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492460);
  if (*CategoryCachedImpl)
  {
    v112 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v112, OS_LOG_TYPE_ERROR))
    {
      v113 = self->_updateVisibleCellsRecursionCount;
      [(UICollectionView *)self _visibleBounds];
      v114 = NSStringFromCGRect(v154);
      *v147 = 134218498;
      selfCopy8 = self;
      v149 = 2048;
      v150 = v113;
      v151 = 2112;
      v152 = v114;
      _os_log_impl(&dword_188A29000, v112, OS_LOG_TYPE_ERROR, "_updateVisibleCellsNow: %p; recursionCount=%ld, _visibleBounds=%@", v147, 0x20u);
    }
  }

  _wantsUpdateVisibleCellsPassNotifications = [(UICollectionViewLayout *)self->_layout _wantsUpdateVisibleCellsPassNotifications];
  if (_wantsUpdateVisibleCellsPassNotifications)
  {
    [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
  }

  _focusSystem = [(UIView *)self _focusSystem];
  [_focusSystem _lockEnvironment:self];
  [(UIScrollView *)self _contentInsetIncludingDecorations];
  v9 = v8;
  v11 = v10;
  if (+[UIView _isInAnimationBlockWithAnimationsEnabled]&& (*(&self->_collectionViewFlags + 12) & 2) != 0)
  {
    _shouldFadeCellsForBoundChangeWhileRotating = [(UICollectionView *)self _shouldFadeCellsForBoundChangeWhileRotating];
    v12 = 0x10000000;
    if (!_shouldFadeCellsForBoundChangeWhileRotating)
    {
      v12 = 0;
    }
  }

  else
  {
    v12 = 0;
  }

  *(&self->_collectionViewFlags + 1) |= v12;
  [(UICollectionView *)self _suspendReloads];
  v14 = *(&self->_collectionViewFlags + 1);
  if (updateVisibleCellsRecursionCount <= 0)
  {
    didScrollNotificationSuspensionCount = self->_didScrollNotificationSuspensionCount;
    if (!didScrollNotificationSuspensionCount)
    {
      [(UIScrollView *)self contentOffset];
      self->_contentOffsetWhenScrollNotificationsSuspended.x = v17;
      self->_contentOffsetWhenScrollNotificationsSuspended.y = v18;
    }

    self->_didScrollNotificationSuspensionCount = didScrollNotificationSuspensionCount + 1;
    if ((v14 & 0x10000000) != 0)
    {
      goto LABEL_15;
    }

LABEL_19:
    [(UICollectionView *)self _restoreOrAdjustContentOffsetIfNecessaryWithInsets:updateVisibleCellsRecursionCount > 0 hasUpdatedVisibleCells:v9 isRecursive:v11];
    goto LABEL_20;
  }

  if ((v14 & 0x10000000) == 0)
  {
    goto LABEL_19;
  }

LABEL_15:
  [(UICollectionView *)self _resetPrefetchState];
  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  [(UICollectionViewLayout *)self->_layout prepareForAnimatedBoundsChange:self->_preRotationBounds.origin.x, self->_preRotationBounds.origin.y, self->_preRotationBounds.size.width, self->_preRotationBounds.size.height];
  layout = self->_layout;
  [(UIScrollView *)self contentOffset];
  [(UICollectionViewLayout *)layout targetContentOffsetForProposedContentOffset:?];
  [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
  [(UICollectionView *)self setContentOffset:?];
LABEL_20:
  v119 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v119 & 0xFFFFFEBFFFFFFFFFLL | 0x4000000000;
  v19 = self->_subviewManager;
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v123 = [(UICollectionViewData *)collectionViewData layoutAttributesForElementsInRect:v21, v22, v23, v24];
  if (nowCopy)
  {
    *(&self->_collectionViewFlags + 1) &= 0xFFFFFFFFEFFFFBFFLL;
  }

  [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
  [(UICollectionView *)self _setContentSizeFromLayout:updateVisibleCellsRecursionCount > 0 isRecursivelyUpdatingVisibleCells:v25, v26];
  if ((v14 & 0x10000000) != 0)
  {
    v27 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v134[0] = MEMORY[0x1E69E9820];
    v134[1] = 3221225472;
    v134[2] = __43__UICollectionView__updateVisibleCellsNow___block_invoke;
    v134[3] = &unk_1E70FFC98;
    v28 = v27;
    v135 = v28;
    if (v19)
    {
      [(_UICollectionViewSubviewCollection *)v19->_visibleViews enumerateAllViewsWithEnumerator:v134];
    }

    [v28 sortUsingComparator:&__block_literal_global_116];
    v29 = [objc_alloc(MEMORY[0x1E695DEC8]) initWithArray:v123 copyItems:1];
    v30 = self->_layout;
    [(UIScrollView *)self contentOffset];
    [(UICollectionViewLayout *)v30 _prepareToAnimateFromCollectionViewItems:v28 atContentOffset:v29 toItems:self->_lastLayoutOffset.x atContentOffset:self->_lastLayoutOffset.y, v31, v32];
  }

  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController layoutScrollViews];
  [(UICollectionView *)self _layoutSectionContainerViews];
  v128 = v14;
  v126 = updateVisibleCellsRecursionCount;
  v125 = nowCopy;
  p_isa = &v19->super.isa;
  if (nowCopy)
  {
    v33 = [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes copy];
    indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
    self->_indexPathsRequiringPreferredAttributes = 0;

    v118 = v33;
    if ((*(&self->_collectionViewFlags + 11) & 0x40) != 0)
    {
      v66 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492470);
      if (*v66)
      {
        v116 = *(v66 + 8);
        if (os_log_type_enabled(v116, OS_LOG_TYPE_ERROR))
        {
          *v147 = 134217984;
          selfCopy8 = self;
          _os_log_impl(&dword_188A29000, v116, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; skipping because we need a reload", v147, 0xCu);
        }
      }
    }

    else
    {
      v138 = 0u;
      v139 = 0u;
      v136 = 0u;
      v137 = 0u;
      v35 = v33;
      v36 = [v35 countByEnumeratingWithState:&v136 objects:v147 count:16];
      if (v36)
      {
        v37 = v36;
        v38 = *v137;
        v127 = v35;
        do
        {
          v39 = 0;
          do
          {
            if (*v137 != v38)
            {
              objc_enumerationMutation(v35);
            }

            v40 = *(*(&v136 + 1) + 8 * v39);
            if ([(UICollectionView *)self _indexPathIsValid:v40])
            {
              v41 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v40];
              if (v41)
              {
                v42 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v40];
                if (v42)
                {
                  v43 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492478);
                  if (*v43)
                  {
                    v52 = *(v43 + 8);
                    if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
                    {
                      v53 = v52;
                      _ui_shortDescription = [v40 _ui_shortDescription];
                      *buf = 134218498;
                      selfCopy7 = self;
                      v143 = 2112;
                      v144 = v42;
                      v145 = 2112;
                      v146 = _ui_shortDescription;
                      _os_log_impl(&dword_188A29000, v53, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for existing cell: %@; index path: %@", buf, 0x20u);
                    }
                  }

                  [(UICollectionView *)self _recomputePreferredAttributesForInvalidatedView:v42 originalAttributes:v41];
                }

                else
                {
                  v44 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v40];
                  if (v44)
                  {
                    v45 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492480);
                    if (*v45)
                    {
                      v55 = *(v45 + 8);
                      if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
                      {
                        *buf = 134218242;
                        selfCopy7 = self;
                        v143 = 2112;
                        v144 = v44;
                        _os_log_impl(&dword_188A29000, v55, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for cell in prefetch cache: %@", buf, 0x16u);
                      }
                    }

                    *&v44->super.super._responderFlags |= 3u;
                  }

                  else if ([(UICollectionView *)self _hasFocusedCellForIndexPath:v40 shouldUsePreUpdateData:0])
                  {
                    v46 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492488);
                    if (*v46)
                    {
                      v56 = *(v46 + 8);
                      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
                      {
                        v57 = v56;
                        _focusedItemState = [(UICollectionView *)self _focusedItemState];
                        *buf = 134218242;
                        selfCopy7 = self;
                        v143 = 2112;
                        v144 = _focusedItemState;
                        _os_log_impl(&dword_188A29000, v57, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for focused cell: %@", buf, 0x16u);
                      }
                    }

                    _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
                    cell = [(_UICollectionViewFocusedItemState *)_focusedItemState2 cell];

                    [cell _invalidatePreferredAttributes];
                  }

                  else if (self->_firstResponderViewType == 1 && [(NSIndexPath *)self->_firstResponderIndexPath isEqual:v40])
                  {
                    v49 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492490);
                    if (*v49)
                    {
                      v62 = *(v49 + 8);
                      if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
                      {
                        firstResponderView = self->_firstResponderView;
                        v63 = v62;
                        _ui_shortDescription2 = [v40 _ui_shortDescription];
                        *buf = 134218498;
                        selfCopy7 = self;
                        v143 = 2112;
                        v144 = firstResponderView;
                        v145 = 2112;
                        v146 = _ui_shortDescription2;
                        _os_log_impl(&dword_188A29000, v63, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for first responder cell: %@; index path: %@", buf, 0x20u);
                      }
                    }

                    [(UICollectionReusableView *)self->_firstResponderView _invalidatePreferredAttributes];
                  }

                  else
                  {
                    v50 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492498);
                    if (*v50)
                    {
                      v59 = *(v50 + 8);
                      if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR))
                      {
                        v60 = v59;
                        _ui_shortDescription3 = [v40 _ui_shortDescription];
                        *buf = 134218242;
                        selfCopy7 = self;
                        v143 = 2112;
                        v144 = _ui_shortDescription3;
                        _os_log_impl(&dword_188A29000, v60, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; creating cell for item at index path: %@", buf, 0x16u);
                      }
                    }
                  }

                  v51 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:v40 withLayoutAttributes:v41 applyAttributes:1 isFocused:0 notify:1];
                  [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:v51 atIndexPath:v40];

                  v35 = v127;
                }
              }
            }

            ++v39;
          }

          while (v37 != v39);
          v65 = [v35 countByEnumeratingWithState:&v136 objects:v147 count:16];
          v37 = v65;
        }

        while (v65);
      }

      v19 = p_isa;
      v14 = v128;
    }
  }

  allVisibleViewsSubviewCollection = [(_UICollectionViewSubviewManager *)v19 allVisibleViewsSubviewCollection];
  _currentPromiseFulfillmentCell = [(UICollectionView *)self _currentPromiseFulfillmentCell];

  if (_currentPromiseFulfillmentCell)
  {
    _currentPromiseFulfillmentCell2 = [(UICollectionView *)self _currentPromiseFulfillmentCell];
    v70 = [(UICollectionView *)self _indexPathForCell:_currentPromiseFulfillmentCell2];

    if (v70 && allVisibleViewsSubviewCollection)
    {
      [allVisibleViewsSubviewCollection[1] removeObjectForKey:v70];
    }
  }

  v71 = [v123 count];
  v72 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v71];
  v130 = 0u;
  v131 = 0u;
  v132 = 0u;
  v133 = 0u;
  v73 = v123;
  v74 = [v73 countByEnumeratingWithState:&v130 objects:v140 count:16];
  if (v74)
  {
    v75 = v74;
    v76 = *v131;
    do
    {
      v77 = 0;
      do
      {
        if (*v131 != v76)
        {
          objc_enumerationMutation(v73);
        }

        v78 = *(*(&v130 + 1) + 8 * v77);
        v79 = [(UICollectionView *)self _visibleViewForLayoutAttributes:v78];
        if (v79)
        {
          if (!v78)
          {
            v80 = 0;
            goto LABEL_82;
          }

          if ((*(v78 + 288) & 1) == 0)
          {
            v80 = (*(v78 + 288) & 2) == 0;
LABEL_82:
            _content = [(_UILabelConfiguration *)v78 _content];
            __indexPath = [(UICollectionViewLayoutAttributes *)v78 __indexPath];
            if (v80)
            {
              [(_UICollectionViewSubviewCollection *)allVisibleViewsSubviewCollection removeViewForSupplementaryOfKind:_content atIndexPath:__indexPath];
            }

            else
            {
              [(_UICollectionViewSubviewCollection *)allVisibleViewsSubviewCollection removeViewForDecorationOfKind:_content atIndexPath:__indexPath];
            }

            v14 = v128;
            goto LABEL_92;
          }

          v83 = v79;
          __indexPath2 = [(UICollectionViewLayoutAttributes *)v78 __indexPath];
          if (allVisibleViewsSubviewCollection)
          {
            [allVisibleViewsSubviewCollection[1] removeObjectForKey:__indexPath2];
          }

          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v83 forIndexPath:[(UICollectionViewLayoutAttributes *)v78 __indexPath]];
        }

        else if ((v14 & 0x10000000) != 0 || ([v78 isHidden] & 1) == 0)
        {
          [v72 addObject:v78];
        }

LABEL_92:
        ++v77;
      }

      while (v75 != v77);
      v85 = [v73 countByEnumeratingWithState:&v130 objects:v140 count:16];
      v75 = v85;
    }

    while (v85);
  }

  [(UICollectionView *)self _removeVisibleViews:allVisibleViewsSubviewCollection fadeForBoundsChange:(v14 >> 28) & 1];
  v86 = *(&self->_collectionViewFlags + 1);
  if ((v86 & 0x200) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v86 & 0xFFFFFFFFFFFFF5FFLL;
  }

  if ((v86 & 0x800) != 0 && [(UICollectionView *)self _useIdleObserverForCellPrefetching])
  {
    [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:&__block_literal_global_500];
  }

  if ((*(&self->_collectionViewFlags + 13) & 8) != 0)
  {
    _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
    [(UICollectionView *)self _setFocusedItemState:0];
    v88 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492468);
    if (*v88)
    {
      v115 = *(v88 + 8);
      if (os_log_type_enabled(v115, OS_LOG_TYPE_ERROR))
      {
        *v147 = 134218242;
        selfCopy8 = self;
        v149 = 2112;
        v150 = _focusedItemState3;
        _os_log_impl(&dword_188A29000, v115, OS_LOG_TYPE_ERROR, "[UICV %p] Handling updateFocusAfterLoadingCells. Item focused before reload: %@", v147, 0x16u);
      }
    }
  }

  else
  {
    _focusedItemState3 = 0;
  }

  if (v125)
  {
    v3 = [(UICollectionView *)self _createVisibleViewsForAttributes:v72 fadeForBoundsChange:(v14 >> 28) & 1 notifyLayoutForVisibleCellsPass:_wantsUpdateVisibleCellsPassNotifications];
  }

  else
  {
    v3 = 0;
  }

  v89 = *(&self->_collectionViewFlags + 1);
  if ((v89 & 0x200) != 0)
  {
    [(UICollectionView *)self performSelector:sel__resumeReloads withObject:0 afterDelay:0.0];
  }

  else
  {
    [(UICollectionView *)self _visibleBounds];
    self->_visibleBounds.origin.x = v90;
    self->_visibleBounds.origin.y = v91;
    self->_visibleBounds.size.width = v92;
    self->_visibleBounds.size.height = v93;
    if ((v86 & 0x800) == 0 || ([(UICollectionView *)self _updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(v14 >> 28) & 1], dyld_program_sdk_at_least()))
    {
      [(UICollectionView *)self _processViewSpecificInvalidationsForVisibleViews];
    }

    if ((v128 & 0x10000000) != 0)
    {
      [(UICollectionViewLayout *)self->_layout _finalizeCollectionViewItemAnimations];
      [(UICollectionViewLayout *)self->_layout finalizeAnimatedBoundsChange];
    }
  }

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    [(UICollectionView *)self _prepareClonedViewsForTransitionLayout];
  }

  *(&self->_collectionViewFlags + 1) &= ~0x200000000uLL;
  [(UIScrollView *)self contentOffset];
  v95 = v94;
  v97 = v96;
  x = self->_lastLayoutOffset.x;
  y = self->_lastLayoutOffset.y;
  window = [(UIView *)self window];
  isRotating = [window isRotating];

  if ((isRotating & 1) == 0)
  {
    [(UIScrollView *)self contentOffset];
    self->_lastLayoutOffset.x = v102;
    self->_lastLayoutOffset.y = v103;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFBFFFFFFFFFLL | (((v119 >> 38) & 1) << 38);
  if ((v89 & 0x200) == 0)
  {
    [(UICollectionView *)self _resumeReloads];
  }

  invalidationBlock = self->_invalidationBlock;
  if (invalidationBlock)
  {
    invalidationBlock[2]();
    v105 = self->_invalidationBlock;
    self->_invalidationBlock = 0;
  }

  [_focusSystem _unlockEnvironment:self];
  [(UICollectionView *)self _updateFocusAfterLoadingVisibleCellsIfNeeded:_focusedItemState3];
  if (_wantsUpdateVisibleCellsPassNotifications)
  {
    [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v95 - x, v97 - y];
  }

  [(UICollectionView *)self _restoreOrAdjustContentOffsetIfNecessaryWithInsets:v126 > 0 hasUpdatedVisibleCells:v9 isRecursive:v11];
  if (v125 && (*(&self->_collectionViewFlags + 9) & 4) != 0)
  {
    [(UICollectionViewData *)self->_collectionViewData invalidate:?];
    v106 = self->_updateVisibleCellsRecursionCount;
    self->_updateVisibleCellsRecursionCount = v106 + 1;
    if (v106 >= 15 && !self->_debugger)
    {
      v107 = objc_alloc_init(_UICollectionViewFeedbackLoopDebugger);
      debugger = self->_debugger;
      self->_debugger = v107;
    }

    v3 += [(UICollectionView *)self _updateVisibleCellsNow:1];
    --self->_updateVisibleCellsRecursionCount;
    v109 = self->_debugger;
    if (v109)
    {
      self->_debugger = 0;
    }
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  v110 = *(&self->_collectionViewFlags + 4);
  if ((v110 & 0x10000) != 0)
  {
    [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    v110 = *(&self->_collectionViewFlags + 4);
  }

  *(&self->_collectionViewFlags + 4) = v110 & 0xFFDFFFFF;
  [(UICollectionView *)self _ensureFocusedViewIsNotHidden];
  if (v126 <= 0)
  {
    [(UICollectionView *)self _setUpCompletionHandlerForAnimationInterruptionIfNecessary];
    [(UICollectionView *)self _resumeDidScrollNotifications];
    if (p_isa)
    {
      [p_isa[4] removeAllObjects];
    }
  }

  v129[0] = MEMORY[0x1E69E9820];
  v129[1] = 3221225472;
  v129[2] = __43__UICollectionView__updateVisibleCellsNow___block_invoke_505;
  v129[3] = &unk_1E70FF0A0;
  v129[4] = self;
  v129[5] = a2;
  [(_UICollectionViewSubviewManager *)p_isa removeAllDequeuedViewsWithEnumerator:v129];

  return v3;
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  v5 = *(a1 + 32);
  v6 = [a5 _layoutAttributes];
  [v5 addObject:v6];
}

uint64_t __43__UICollectionView__updateVisibleCellsNow___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v4 = [(UICollectionViewLayoutAttributes *)a2 __indexPath];
  v5 = [(UICollectionViewLayoutAttributes *)a3 __indexPath];

  return [v4 compare:v5];
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    *(a3 + 8) |= 1u;
  }
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke_505(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  _UIIsPrivateMainBundle();
  if (dyld_program_sdk_at_least())
  {
    v4 = [MEMORY[0x1E696AAA8] currentHandler];
    [NSObject handleFailureInMethod:v4 object:"handleFailureInMethod:object:file:lineNumber:description:" file:*(a1 + 40) lineNumber:v3 description:*(a1 + 32)];
LABEL_3:

    goto LABEL_7;
  }

  if (os_variant_has_internal_diagnostics())
  {
    v4 = __UIFaultDebugAssertLog();
    if (os_log_type_enabled(v4, OS_LOG_TYPE_FAULT))
    {
      v7 = *(a1 + 32);
      *buf = 138412546;
      v9 = v3;
      v10 = 2112;
      v11 = v7;
      _os_log_fault_impl(&dword_188A29000, v4, OS_LOG_TYPE_FAULT, "Expected dequeued view to be returned to the collection view in preparation for display. When the collection view's data source is asked to provide a view for a given index path, ensure that a single view is dequeued and returned to the collection view. Avoid flushing layout before returning the view to the collection view. Avoid dequeuing views without a request from the collection view. For retrieving an existing view in the collection view, use [UICollectionView cellForItemAtIndexPath:] or [UICollectionView supplementaryViewForElementKind:atIndexPath:]. Dequeued view: %@; Collection view: %@ This will become an assert in a future version.", buf, 0x16u);
    }

    goto LABEL_3;
  }

  v5 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_6___s_category) + 8);
  if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
  {
    v6 = *(a1 + 32);
    *buf = 138412546;
    v9 = v3;
    v10 = 2112;
    v11 = v6;
    _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, "Expected dequeued view to be returned to the collection view in preparation for display. When the collection view's data source is asked to provide a view for a given index path, ensure that a single view is dequeued and returned to the collection view. Avoid flushing layout before returning the view to the collection view. Avoid dequeuing views without a request from the collection view. For retrieving an existing view in the collection view, use [UICollectionView cellForItemAtIndexPath:] or [UICollectionView supplementaryViewForElementKind:atIndexPath:]. Dequeued view: %@; Collection view: %@ This will become an assert in a future version.", buf, 0x16u);
  }

LABEL_7:
  [v3 _setHiddenForReuse:1];
}

- (void)_decrementRotationAnimationCount
{
  v2 = self->_rotationAnimationCount - 1;
  self->_rotationAnimationCount = v2;
  if (!v2)
  {
    self->_rotationBoundsOffset = *MEMORY[0x1E695EFF8];
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    [(UIScrollView *)self contentOffset];
    self->_lastLayoutOffset.x = v4;
    self->_lastLayoutOffset.y = v5;
  }
}

- (void)_animateVisibleView:(id)view withLayoutAttributes:(id)attributes completionHandler:(id)handler
{
  viewCopy = view;
  attributesCopy = attributes;
  handlerCopy = handler;
  [(UICollectionView *)self _incrementRotationAnimationCount];
  v24[0] = 0;
  v24[1] = v24;
  v24[2] = 0x2020000000;
  v25 = 0;
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke;
  v19[3] = &unk_1E70FF0C8;
  v20 = viewCopy;
  v11 = attributesCopy;
  selfCopy = self;
  v23 = v24;
  v21 = v11;
  v14[0] = MEMORY[0x1E69E9820];
  v14[1] = 3221225472;
  v14[2] = __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke_2;
  v14[3] = &unk_1E70FF0F0;
  v18 = v24;
  v12 = v20;
  v15 = v12;
  v13 = handlerCopy;
  selfCopy2 = self;
  v17 = v13;
  [UIView animateWithDuration:v19 animations:v14 completion:0.0];

  _Block_object_dispose(v24, 8);
}

void __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke(uint64_t a1)
{
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v2 = *(a1 + 32);
    [*(a1 + 40) center];
    [v2 setPosition:?];
    [v2 bounds];
    v4 = v3;
    v6 = v5;
    [*(a1 + 40) size];
    [v2 setBounds:{v4, v6, v7, v8}];
    [*(a1 + 40) alpha];
    *&v9 = v9;
    [v2 setOpacity:v9];
    v10 = *(a1 + 40);
    if (v10)
    {
      [v10 transform3D];
    }

    else
    {
      memset(v17, 0, sizeof(v17));
    }

    [v2 setTransform:v17];
  }

  else
  {
    [*(a1 + 40) alpha];
    if (v11 == 0.0)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v12 = [*(a1 + 32) _disableRasterizeInAnimations];
        *(*(*(a1 + 56) + 8) + 24) = 0;
      }

      else
      {
        v12 = 0;
      }

      if ((dyld_program_sdk_at_least() & 1) == 0 && (v12 & 1) == 0)
      {
        v13 = [*(a1 + 32) layer];
        if (([v13 shouldRasterize] & 1) == 0)
        {
          *(*(*(a1 + 56) + 8) + 24) = 1;
        }

        [v13 setShouldRasterize:1];
        [*(a1 + 48) _currentScreenScale];
        [v13 setRasterizationScale:?];
      }
    }

    v15 = *(a1 + 40);
    v14 = *(a1 + 48);
    v16 = *(a1 + 32);

    [v14 _applyLayoutAttributes:v15 toView:v16];
  }
}

uint64_t __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke_2(uint64_t a1)
{
  if (*(*(*(a1 + 56) + 8) + 24) == 1)
  {
    v2 = [*(a1 + 32) layer];
    [v2 setShouldRasterize:0];
  }

  v3 = *(a1 + 48);
  if (v3)
  {
    (*(v3 + 16))();
  }

  v4 = *(a1 + 40);

  return [v4 _decrementRotationAnimationCount];
}

- (void)_removeVisibleViews:(id)views fadeForBoundsChange:(BOOL)change
{
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke;
  v4[3] = &unk_1E70FEBD8;
  v4[4] = self;
  changeCopy = change;
  [(_UICollectionViewSubviewCollection *)views enumerateAllViewsWithEnumerator:v4];
}

void __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v9 = a3;
  v10 = a4;
  v11 = a5;
  switch(a2)
  {
    case 2:
      v12 = *(a1 + 32);
      v13 = 2672;
      goto LABEL_7;
    case 1:
      v12 = *(a1 + 32);
      v13 = 2664;
LABEL_7:
      v14 = [*(v12 + v13) objectForKeyedSubscript:v10];
      [v14 removeObject:v9];

      break;
    case 0:
      [*(*(a1 + 32) + 2656) removeObject:v9];
      break;
  }

  if (([v11 _isInUpdateAnimation] & 1) == 0)
  {
    v15 = *(a1 + 32);
    v16 = *(v15 + 2984);
    if (v16)
    {
      [(_UICollectionViewSubviewCollection *)*(v16 + 8) removeViewOfKind:v10 inCategory:a2 atIndexPath:v9];
      v15 = *(a1 + 32);
    }

    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_2;
    aBlock[3] = &unk_1E70FF118;
    aBlock[4] = v15;
    v17 = v9;
    v33 = v17;
    v18 = _Block_copy(aBlock);
    v19 = v18;
    if (*(a1 + 40) != 1)
    {
      (*(v18 + 2))(v18, a2, v11);
LABEL_23:

      goto LABEL_24;
    }

    if (a2 == 2)
    {
      v25 = *(*(a1 + 32) + 2152);
      v22 = [v11 _layoutAttributes];
      v23 = [(_UILabelConfiguration *)v22 _content];
      v24 = [v25 finalLayoutAttributesForDisappearingDecorationElementOfKind:v23 atIndexPath:v17];
    }

    else
    {
      if (a2 != 1)
      {
        if (!a2)
        {
          v20 = [*(*(a1 + 32) + 2152) finalLayoutAttributesForDisappearingItemAtIndexPath:v17];
          if (v20)
          {
            goto LABEL_22;
          }
        }

        goto LABEL_21;
      }

      v21 = *(*(a1 + 32) + 2152);
      v22 = [v11 _layoutAttributes];
      v23 = [(_UILabelConfiguration *)v22 _content];
      v24 = [v21 finalLayoutAttributesForDisappearingSupplementaryElementOfKind:v23 atIndexPath:v17];
    }

    v20 = v24;

    if (v20)
    {
LABEL_22:
      v27 = *(a1 + 32);
      v28[0] = MEMORY[0x1E69E9820];
      v28[1] = 3221225472;
      v28[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_513;
      v28[3] = &unk_1E70FF140;
      v30 = v19;
      v31 = a2;
      v29 = v11;
      [v27 _animateVisibleView:v29 withLayoutAttributes:v20 completionHandler:v28];

      goto LABEL_23;
    }

LABEL_21:
    v26 = [v11 _layoutAttributes];
    v20 = [v26 copy];

    [v20 setAlpha:0.0];
    goto LABEL_22;
  }

LABEL_24:
}

void __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v15 = *MEMORY[0x1E69E9840];
  v5 = a3;
  if ([v5 _isInUpdateAnimation])
  {
    if (os_variant_has_internal_diagnostics())
    {
      v9 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v9, OS_LOG_TYPE_FAULT))
      {
        v10 = *(a1 + 32);
        v11 = 138412546;
        v12 = v10;
        v13 = 2112;
        v14 = v5;
        _os_log_fault_impl(&dword_188A29000, v9, OS_LOG_TYPE_FAULT, "Warning: view should never be in update animation (ignoring - rotation + disappearing item?) for cv == %@; view == %@", &v11, 0x16u);
      }
    }

    else
    {
      v6 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_7___s_category) + 8);
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        v7 = *(a1 + 32);
        v11 = 138412546;
        v12 = v7;
        v13 = 2112;
        v14 = v5;
        _os_log_impl(&dword_188A29000, v6, OS_LOG_TYPE_ERROR, "Warning: view should never be in update animation (ignoring - rotation + disappearing item?) for cv == %@; view == %@", &v11, 0x16u);
      }
    }
  }

  else
  {
    v8 = *(a1 + 32);
    if (a2)
    {
      [v8 _reuseSupplementaryView:v5];
    }

    else
    {
      [v8 _cacheOrReuseCell:v5 forIndexPath:*(a1 + 40) invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];
    }
  }
}

- (id)_updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:(BOOL)bounds
{
  v24 = *MEMORY[0x1E69E9840];
  [(UICollectionViewData *)self->_collectionViewData invalidate:?];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v10 = [(UICollectionViewData *)collectionViewData layoutAttributesForElementsInRect:v6, v7, v8, v9];
  v11 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v10, "count")}];
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v12 = v10;
  v13 = [v12 countByEnumeratingWithState:&v19 objects:v23 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v20;
    do
    {
      for (i = 0; i != v14; ++i)
      {
        if (*v20 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v19 + 1) + 8 * i);
        if (!-[UICollectionView _visibleViewForLayoutAttributes:](self, "_visibleViewForLayoutAttributes:", v17, v19) && (bounds || ([v17 isHidden] & 1) == 0))
        {
          [v11 addObject:v17];
        }
      }

      v14 = [v12 countByEnumeratingWithState:&v19 objects:v23 count:16];
    }

    while (v14);
  }

  [(UICollectionView *)self _sortAttributesByDistanceToVisibleBoundsOrigin:v11];

  return v11;
}

- (void)_sortAttributesByDistanceToVisibleBoundsOrigin:(id)origin
{
  originCopy = origin;
  [(UICollectionView *)self _visibleBounds];
  v6 = v5;
  v8 = v7;
  _hasOrthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __67__UICollectionView__sortAttributesByDistanceToVisibleBoundsOrigin___block_invoke;
  v10[3] = &unk_1E70FF168;
  v11 = _hasOrthogonalScrollingSections;
  v10[4] = self;
  v10[5] = v6;
  v10[6] = v8;
  [originCopy sortUsingComparator:v10];
}

uint64_t __67__UICollectionView__sortAttributesByDistanceToVisibleBoundsOrigin___block_invoke(uint64_t a1, void *a2, void *a3)
{
  if (*(a1 + 56) == 1)
  {
    v5 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a2];
  }

  else
  {
    [a2 frame];
  }

  v9 = v5;
  v10 = v6;
  v11 = v7;
  v12 = v8;
  if (*(a1 + 56) == 1)
  {
    v13 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a3];
  }

  else
  {
    [a3 frame];
  }

  v17 = v13;
  v18 = v14;
  v19 = v15;
  v20 = v16;
  UIDistanceBetweenPointAndRect(*(a1 + 40), *(a1 + 48), v9, v10, v11, v12);
  v22 = v21;
  UIDistanceBetweenPointAndRect(*(a1 + 40), *(a1 + 48), v17, v18, v19, v20);
  if (v22 >= v23)
  {
    v24 = 0;
  }

  else
  {
    v24 = -1;
  }

  if (v22 > v23)
  {
    return 1;
  }

  else
  {
    return v24;
  }
}

- (id)_layoutAttributes:(id)attributes filteredForCategory:(unint64_t)category
{
  v23 = *MEMORY[0x1E69E9840];
  attributesCopy = attributes;
  v6 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(attributesCopy, "count")}];
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v7 = attributesCopy;
  v8 = [v7 countByEnumeratingWithState:&v18 objects:v22 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v19;
    do
    {
      v11 = 0;
      do
      {
        if (*v19 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v18 + 1) + 8 * v11);
        if (v12)
        {
          v13 = *(v12 + 288);
          if ((v13 & 2) != 0)
          {
            v14 = 2;
          }

          else
          {
            v14 = 1;
          }

          if (v13)
          {
            v15 = 0;
          }

          else
          {
            v15 = v14;
          }
        }

        else
        {
          v15 = 0;
        }

        if (v15 == category)
        {
          [v6 addObject:v18];
        }

        ++v11;
      }

      while (v9 != v11);
      v16 = [v7 countByEnumeratingWithState:&v18 objects:v22 count:16];
      v9 = v16;
    }

    while (v16);
  }

  return v6;
}

- (_UICollectionViewVisibleCellsUpdateResult)_createVisibleViewsForSingleCategoryAttributes:(SEL)attributes limitCreation:(id)creation fadeForBoundsChange:(BOOL)change
{
  v6 = a6;
  changeCopy = change;
  creationCopy = creation;
  *&retstr->var0 = 0u;
  *&retstr->var2 = 0u;
  v11 = [creationCopy count] >> 1;
  if (v11 >= 5)
  {
    v11 = 5;
  }

  if (v11 <= 1)
  {
    v11 = 1;
  }

  v45 = v11;
  v12 = self->_subviewManager;
  if ([creationCopy count])
  {
    v43 = retstr;
    v46 = v12;
    v44 = changeCopy;
    do
    {
      if (changeCopy && retstr->var0 >= v45)
      {
        retstr->var3 = 1;
        break;
      }

      v13 = [creationCopy objectAtIndexedSubscript:0];
      [creationCopy removeObjectAtIndex:0];
      __indexPath = [(UICollectionViewLayoutAttributes *)v13 __indexPath];
      if (v13)
      {
        v15 = *(v13 + 288) & 1;
        if (!v6)
        {
          goto LABEL_13;
        }
      }

      else
      {
        v15 = 0;
        if (!v6)
        {
LABEL_13:
          v16 = [v13 isHidden] ^ 1;
          goto LABEL_14;
        }
      }

      v16 = 1;
LABEL_14:
      v50 = __indexPath;
      v49 = v15;
      if ((v16 & v15) != 1 || ![(UICollectionView *)self _prefetchingAllowed])
      {
        v19 = 0;
        v20 = 0;
        if (v13)
        {
          goto LABEL_20;
        }

        goto LABEL_61;
      }

      v17 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:__indexPath];
      if (!v17)
      {
        v19 = 0;
        v20 = 0;
        goto LABEL_60;
      }

      _useIdleObserverForCellPrefetching = [(UICollectionView *)self _useIdleObserverForCellPrefetching];
      if (_useIdleObserverForCellPrefetching)
      {
        v18 = [(UICollectionView *)self _updatePrefetchItemIfNeeded:v17 forIndexPath:__indexPath withLayoutAttributes:0 willDisplay:1];
      }

      else
      {
        v28 = v17[2];
        v18 = [v28 isEqual:v13];
      }

      v29 = v17[3];
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:__indexPath];
      if (v18)
      {
        v19 = v29;
        if (v19)
        {
          v42 = creationCopy;
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &_createVisibleViewsForSingleCategoryAttributes_limitCreation_fadeForBoundsChange____s_category);
          v31 = *(CategoryCachedImpl + 8);
          v32 = *(CategoryCachedImpl + 8);
          v33 = v31;
          changeCopy = v44;
          if (os_signpost_id_make_with_pointer(v32, self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v33))
          {
            changeCopy = v44;
            [v50 section];
            [v50 item];
            _os_signpost_emit_unreliably_with_name_impl();
          }

          if ([v19 _isHiddenForReuse])
          {
            [v19 _setHiddenForReuse:0];
          }

          creationCopy = v42;
          if (!_useIdleObserverForCellPrefetching)
          {
            [(UICollectionView *)self _configureCachedCellForDisplay:v19 withIndexPath:v50 layoutAttributesToUpdate:0];
          }

          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v19 forIndexPath:v50];
          v20 = 1;
          goto LABEL_59;
        }
      }

      else
      {
        if (v29)
        {
          [(UICollectionView *)self _reusePrefetchedCell:v29];
        }

        v19 = 0;
      }

      v20 = 0;
      changeCopy = v44;
LABEL_59:

      v12 = v46;
LABEL_60:

      retstr = v43;
      if (v13)
      {
LABEL_20:
        v21 = *(v13 + 8);
        goto LABEL_21;
      }

LABEL_61:
      v21 = 0;
LABEL_21:
      v48 = v21;
      if (v6)
      {
        if (v49)
        {
          v22 = [(UICollectionViewLayout *)self->_layout initialLayoutAttributesForAppearingItemAtIndexPath:v50];
          if (!v22)
          {
LABEL_38:
            v22 = [v13 copy];
            [v22 setAlpha:0.0];
          }

LABEL_39:
          if (![v22 isHidden] || (objc_msgSend(v13, "isHidden") & 1) == 0)
          {
            if (!v19)
            {
              if (v49)
              {
                v27 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v50 withLayoutAttributes:v22 applyAttributes:1];
              }

              else
              {
                v27 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v48 atIndexPath:v50 layout:self->_layout withLayoutAttributes:v22 applyAttributes:1];
              }

              v19 = v27;
            }

            [(UICollectionView *)self _animateVisibleView:v19 withLayoutAttributes:v13 completionHandler:0];
          }

          v12 = v46;
          goto LABEL_66;
        }

        if (v13)
        {
          layout = self->_layout;
          if ((*(v13 + 288) & 3) != 0)
          {
            goto LABEL_34;
          }

          v26 = [UICollectionViewLayout initialLayoutAttributesForAppearingSupplementaryElementOfKind:"initialLayoutAttributesForAppearingSupplementaryElementOfKind:atIndexPath:" atIndexPath:?];
        }

        else
        {
          layout = self->_layout;
LABEL_34:
          v26 = [UICollectionViewLayout initialLayoutAttributesForAppearingDecorationElementOfKind:"initialLayoutAttributesForAppearingDecorationElementOfKind:atIndexPath:" atIndexPath:?];
        }

        v22 = v26;
        if (!v26)
        {
          goto LABEL_38;
        }

        goto LABEL_39;
      }

      if (v19)
      {
        v23 = 0;
      }

      else
      {
        v23 = v16;
      }

      if (v23 == 1)
      {
        if ([(UICollectionView *)self _isReorderingItemAtIndexPath:v50 includingDragAndDrop:0])
        {
          goto LABEL_84;
        }

        v24 = (v49 & 1) != 0 ? [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v50 withLayoutAttributes:v13 applyAttributes:1]: [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v48 atIndexPath:v50 layout:self->_layout withLayoutAttributes:v13 applyAttributes:1];
        v19 = v24;
        if (!v24)
        {
          goto LABEL_84;
        }

LABEL_67:
        if (v20)
        {
          ++retstr->var2;
          if ((v49 & 1) == 0)
          {
            goto LABEL_69;
          }

LABEL_78:
          [(_UICollectionViewSubviewManager *)v12 setVisibleCell:v19 atIndexPath:v50];
          if (!v12)
          {
LABEL_83:

            goto LABEL_84;
          }
        }

        else
        {
          peekNextItem = [(_UICollectionViewPrefetchingContext *)&self->_mainPrefetchingContext->super.isa peekNextItem];
          v35 = peekNextItem;
          if (peekNextItem && (v36 = creationCopy, v37 = *(peekNextItem + 16), [v37 indexPath], v38 = objc_claimAutoreleasedReturnValue(), v39 = objc_msgSend(v38, "isEqual:", v50), v38, v37, creationCopy = v36, retstr = v43, v39))
          {
            popNextItem = [(_UICollectionViewPrefetchingContext *)self->_mainPrefetchingContext popNextItem];
          }

          else
          {
            ++retstr->var1;
          }

          ++retstr->var0;

          changeCopy = v44;
          v12 = v46;
          if (v49)
          {
            goto LABEL_78;
          }

LABEL_69:
          if (v13 && (*(v13 + 288) & 3) == 0)
          {
            if (!v12)
            {
              goto LABEL_83;
            }

            [(_UICollectionViewSubviewCollection *)v12->_visibleViews setView:v19 forSupplementaryOfKind:v48 atIndexPath:v50];
          }

          else
          {
            if (!v12)
            {
              goto LABEL_83;
            }

            [(_UICollectionViewSubviewCollection *)v12->_visibleViews setView:v19 forDecorationOfKind:v48 atIndexPath:v50];
          }
        }

        [(NSHashTable *)v12->_viewsPreparingForDisplay addObject:v19];
        goto LABEL_83;
      }

LABEL_66:
      if (v19)
      {
        goto LABEL_67;
      }

LABEL_84:
    }

    while ([creationCopy count]);
  }

  return result;
}

- (unint64_t)_createVisibleViewsForAttributes:(id)attributes fadeForBoundsChange:(BOOL)change notifyLayoutForVisibleCellsPass:(BOOL)pass
{
  passCopy = pass;
  changeCopy = change;
  attributesCopy = attributes;
  if ([attributesCopy count])
  {
    if (([(UICollectionViewLayout *)self->_layout _estimatesSizes]|| [(UICollectionViewLayout *)self->_layout _estimatesSupplementaryItems]) && dyld_program_sdk_at_least() && ((_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewLimitsCellsCreatedPerPass, @"CollectionViewLimitsCellsCreatedPerPass", _UIInternalPreferenceUpdateBool) & 1) != 0 || byte_1ED48AADC))
    {
      [(UICollectionView *)self _sortAttributesByDistanceToVisibleBoundsOrigin:attributesCopy];
      v24 = 1;
    }

    else
    {
      v24 = 0;
    }

    v8 = 0;
    v9 = 0;
    p_responderFlags = &self->super.super.super._responderFlags;
    v11 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    do
    {
      v25 = v9;
      if (v9 == 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = v24;
      }

      v26 = _createVisibleViewsForAttributes_fadeForBoundsChange_notifyLayoutForVisibleCellsPass__categories[v9];
      v13 = [(UICollectionView *)self _layoutAttributes:attributesCopy filteredForCategory:?];
      if ([v13 count])
      {
        v27 = v12;
        do
        {
          [(UICollectionView *)self _createVisibleViewsForSingleCategoryAttributes:v13 limitCreation:v12 fadeForBoundsChange:changeCopy];
          v8 += v29;
          if ((v30 & 1) == 0)
          {
            break;
          }

          v14 = v11[168];
          v15 = *(p_responderFlags + v14);
          if ((v15 & 0x200) == 0)
          {
            v16 = v15 & 0xFFFFFFFFFFFFF9FFLL;
            *(p_responderFlags + v14) = v15 & 0xFFFFFFFFFFFFF9FFLL;
            if (passCopy)
            {
              [(UIScrollView *)self contentOffset];
              [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v17 - self->_lastLayoutOffset.x, v18 - self->_lastLayoutOffset.y];
              v12 = v27;
              [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
              v16 = *(p_responderFlags + v14);
            }

            v15 = v16 | v15 & 0x400;
            *(p_responderFlags + v14) = v15;
            if ((v16 & 0x400) != 0)
            {
              [(UICollectionView *)self _updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:changeCopy];
              v19 = changeCopy;
              v21 = v20 = passCopy;

              v22 = [(UICollectionView *)self _layoutAttributes:v21 filteredForCategory:v26];

              v15 = *(p_responderFlags + v14);
              v13 = v22;
              attributesCopy = v21;
              passCopy = v20;
              changeCopy = v19;
              v12 = v27;
            }

            v11 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
          }
        }

        while ((v15 & 0x200) == 0);
      }

      v9 = v25 + 1;
    }

    while (v25 != 2);
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(BOOL)change
{
  changeCopy = change;
  selfCopy = self;
  v67 = *MEMORY[0x1E69E9840];
  _hasOrthogonalScrollingSections = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v46 = selfCopy->_subviewManager;
  [(_UICollectionViewSubviewManager *)v46 allVisibleViews];
  v61 = 0u;
  v62 = 0u;
  v63 = 0u;
  obj = v64 = 0u;
  v48 = [obj countByEnumeratingWithState:&v61 objects:v66 count:16];
  if (v48)
  {
    v47 = *v62;
    v44 = selfCopy;
    do
    {
      v5 = 0;
      do
      {
        if (*v62 != v47)
        {
          objc_enumerationMutation(obj);
        }

        v6 = *(*(&v61 + 1) + 8 * v5);
        _layoutAttributes = [v6 _layoutAttributes];
        __indexPath = [(UICollectionViewLayoutAttributes *)_layoutAttributes __indexPath];
        _content = [(_UILabelConfiguration *)_layoutAttributes _content];
        if (_layoutAttributes)
        {
          v10 = *(_layoutAttributes + 288);
          v11 = 1;
          if ((v10 & 2) != 0)
          {
            v11 = 2;
          }

          if (v10)
          {
            v12 = 0;
          }

          else
          {
            v12 = v11;
          }
        }

        else
        {
          v12 = 0;
        }

        section = [__indexPath section];
        v14 = section < -[UICollectionViewData numberOfSections](selfCopy->_collectionViewData) || [__indexPath item] == 0x7FFFFFFFFFFFFFFFLL;
        v51 = _content;
        if (v12 == 2)
        {
          if (!v14)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              [currentHandler handleFailureInMethod:a2 object:selfCopy file:@"UICollectionView.m" lineNumber:6213 description:{@"UICollectionView internal inconsistency: attempting to update attributes for a decoration view with an invalid section index. View: %@; view attributes: %@; collection view: %@; number of sections: %ld", v6, _layoutAttributes, selfCopy, -[UICollectionViewData numberOfSections](selfCopy->_collectionViewData)}];
              goto LABEL_66;
            }

            goto LABEL_33;
          }

          v15 = [(UICollectionViewData *)selfCopy->_collectionViewData layoutAttributesForDecorationViewOfKind:_content atIndexPath:__indexPath];
          if (!v15)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              v17 = [(UICollectionViewLayout *)selfCopy->_layout layoutAttributesForDecorationViewOfKind:_content atIndexPath:__indexPath];
              [(UICollectionViewData *)selfCopy->_collectionViewData dataSourceCountsDescription];
              v19 = v18 = changeCopy;
              [currentHandler handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6209 description:{@"UICollectionView internal inconsistency: missing final attributes for decoration %@; initial attributes: %@; layout query: %@; collection view: %@; data source counts: %@", v6, _layoutAttributes, v17, v44, v19}];
              goto LABEL_65;
            }

            goto LABEL_33;
          }
        }

        else if (v12 == 1)
        {
          if (!v14)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              [currentHandler handleFailureInMethod:a2 object:selfCopy file:@"UICollectionView.m" lineNumber:6202 description:{@"UICollectionView internal inconsistency: attempting to update attributes for a supplementary view with an invalid section index. View: %@; view attributes: %@; collection view: %@; number of sections: %ld", v6, _layoutAttributes, selfCopy, -[UICollectionViewData numberOfSections](selfCopy->_collectionViewData)}];
              goto LABEL_66;
            }

LABEL_33:
            v20 = _layoutAttributes;
            v50 = 1;
            goto LABEL_34;
          }

          v15 = [(UICollectionViewData *)selfCopy->_collectionViewData layoutAttributesForSupplementaryElementOfKind:_content atIndexPath:__indexPath];
          if (!v15)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              v17 = [(UICollectionViewLayout *)selfCopy->_layout layoutAttributesForSupplementaryViewOfKind:_content atIndexPath:__indexPath];
              [(UICollectionViewData *)selfCopy->_collectionViewData dataSourceCountsDescription];
              v19 = v18 = changeCopy;
              [currentHandler handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6198 description:{@"UICollectionView internal inconsistency: missing final attributes for supplementary %@; initial attributes: %@; layout query: %@; collection view: %@;  data source counts: %@", v6, _layoutAttributes, v17, v44, v19}];
              goto LABEL_65;
            }

            goto LABEL_33;
          }
        }

        else
        {
          v15 = [(UICollectionViewData *)selfCopy->_collectionViewData layoutAttributesForItemAtIndexPath:__indexPath];
          if (!v15)
          {
            if ([v6 _isInUpdateAnimation])
            {
              goto LABEL_33;
            }

            currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = [(UICollectionViewLayout *)selfCopy->_layout layoutAttributesForItemAtIndexPath:__indexPath];
            [(UICollectionViewData *)selfCopy->_collectionViewData dataSourceCountsDescription];
            v19 = v18 = changeCopy;
            [currentHandler handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6192 description:{@"UICollectionView internal inconsistency: missing final attributes for cell %@; initial attributes: %@; layout query: %@; collection view: %@; data source counts: %@", v6, _layoutAttributes, v17, v44, v19}];
LABEL_65:

            changeCopy = v18;
            selfCopy = v44;

LABEL_66:
            goto LABEL_33;
          }
        }

        v20 = v15;
        v50 = 0;
LABEL_34:
        if ([__indexPath length] >= 2)
        {
          v21 = selfCopy;
          v22 = changeCopy;
          superview = [v6 superview];
          v24 = [(UICollectionView *)v21 _subviewRouterForView:v6 attributes:v20 createIfNecessary:0];
          v25 = v24;
          v26 = v24 ? *(v24 + 40) : 0;
          v27 = v26;

          v28 = superview == v27;
          changeCopy = v22;
          selfCopy = v44;
          if (!v28)
          {
            v29 = 1;
            v30 = v51;
LABEL_41:
            -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](selfCopy, "_addControlledSubview:atZIndex:forced:initialAttributes:", v6, [v20 zIndex], _hasOrthogonalScrollingSections | v29, 0);
            goto LABEL_42;
          }
        }

        zIndex = [v20 zIndex];
        _layoutAttributes2 = [v6 _layoutAttributes];
        LOBYTE(zIndex) = zIndex != [_layoutAttributes2 zIndex] || _hasOrthogonalScrollingSections;

        v30 = v51;
        if (zIndex)
        {
          v29 = 0;
          goto LABEL_41;
        }

LABEL_42:
        if (changeCopy && ![(UICollectionView *)selfCopy _viewIsReorderedCell:v6])
        {
          layout = selfCopy->_layout;
          v59[4] = selfCopy;
          v60[0] = MEMORY[0x1E69E9820];
          v60[1] = 3221225472;
          v60[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke;
          v60[3] = &unk_1E70F3590;
          v60[4] = selfCopy;
          v59[0] = MEMORY[0x1E69E9820];
          v59[1] = 3221225472;
          v59[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke_2;
          v59[3] = &unk_1E70F5AC0;
          LOBYTE(v42) = 0;
          v36 = [(UICollectionView *)selfCopy _viewAnimationsForView:v6 startingLayoutAttributes:_layoutAttributes endingLayoutAttributes:v20 startingLayout:layout endingLayout:layout animationSetup:v60 animationCompletion:v59 enableCustomAnimations:v42 customAnimationsType:0];
          v55 = 0u;
          v56 = 0u;
          v57 = 0u;
          v58 = 0u;
          v37 = [v36 countByEnumeratingWithState:&v55 objects:v65 count:16];
          if (v37)
          {
            v38 = v37;
            v39 = *v56;
            do
            {
              for (i = 0; i != v38; ++i)
              {
                if (*v56 != v39)
                {
                  objc_enumerationMutation(v36);
                }

                [*(*(&v55 + 1) + 8 * i) start];
              }

              v38 = [v36 countByEnumeratingWithState:&v55 objects:v65 count:16];
            }

            while (v38);
          }

          v30 = v51;
          goto LABEL_59;
        }

        if (![v20 isHidden])
        {
          if (v46)
          {
            v34 = [(NSHashTable *)v46->_viewsPreparingForDisplay containsObject:v6];
          }

          else
          {
            v34 = 0;
          }

          v52[0] = MEMORY[0x1E69E9820];
          v52[1] = 3221225472;
          v52[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke_3;
          v52[3] = &unk_1E70F6228;
          v52[4] = selfCopy;
          v53 = v20;
          v54 = v6;
          [UIView _conditionallyPerformWithoutAnimation:v34 layout:v52];

LABEL_59:
          v33 = v50;
          goto LABEL_60;
        }

        v33 = v50;
        if (v46)
        {
          [(_UICollectionViewSubviewCollection *)&v46->_visibleViews->super.isa removeViewOfKind:v30 inCategory:v12 atIndexPath:__indexPath];
          if ([v6 _isInUpdateAnimation])
          {
            [(_UICollectionViewSubviewCollection *)v46->_visibleViews setView:v6 ofKind:v30 inCategory:v12 atIndexPath:__indexPath];
            goto LABEL_60;
          }
        }

        else if ([v6 _isInUpdateAnimation])
        {
          goto LABEL_60;
        }

        if (v12)
        {
          [(UICollectionView *)selfCopy _reuseSupplementaryView:v6];
        }

        else if (dyld_program_sdk_at_least())
        {
          [(UICollectionView *)selfCopy _cacheOrReuseCell:v6 forIndexPath:__indexPath invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];
        }

        else
        {
          [(UICollectionView *)selfCopy _reuseCell:v6 notifyDidEndDisplaying:1];
        }

LABEL_60:
        if ((v33 & 1) == 0)
        {
          [(UICollectionView *)selfCopy _checkForPreferredAttributesInView:v6 originalAttributes:v20];
        }

        ++v5;
      }

      while (v5 != v48);
      v41 = [obj countByEnumeratingWithState:&v61 objects:v66 count:16];
      v48 = v41;
    }

    while (v41);
  }

  [(_UICollectionViewOrthogonalScrollerSectionController *)selfCopy->_orthogonalScrollerController processQueuedScrollViewRemovals];
  [(UICollectionView *)selfCopy _processQueuedSectionContainerRemovals];
}

- (void)_prepareClonedViewsForTransitionLayout
{
  selfCopy = self;
  v51 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  if (collectionViewData)
  {
    collectionViewData = collectionViewData->_clonedCellAttributes;
  }

  v4 = collectionViewData;
  v5 = v4;
  v6 = MEMORY[0x1E695E0F0];
  if (v4)
  {
    v7 = v4;
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  v8 = v7;

  v9 = selfCopy->_collectionViewData;
  if (v9)
  {
    v9 = v9->_clonedSupplementaryAttributes;
  }

  v10 = v9;
  v11 = v10;
  if (v10)
  {
    v12 = v10;
  }

  else
  {
    v12 = v6;
  }

  v13 = v12;

  v14 = selfCopy->_collectionViewData;
  if (v14)
  {
    v14 = v14->_clonedDecorationAttributes;
  }

  v15 = v14;
  v16 = v15;
  if (v15)
  {
    v17 = v15;
  }

  else
  {
    v17 = v6;
  }

  v18 = v17;

  if (!selfCopy->_clonedCellsDict)
  {
    v19 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:{-[UICollectionViewData count](v8, "count")}];
    clonedCellsDict = selfCopy->_clonedCellsDict;
    selfCopy->_clonedCellsDict = v19;

    v21 = objc_alloc_init(MEMORY[0x1E695DF90]);
    clonedSupplementaryViewsDict = selfCopy->_clonedSupplementaryViewsDict;
    selfCopy->_clonedSupplementaryViewsDict = v21;

    v23 = objc_alloc_init(MEMORY[0x1E695DF90]);
    clonedDecorationViewsDict = selfCopy->_clonedDecorationViewsDict;
    selfCopy->_clonedDecorationViewsDict = v23;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke;
  aBlock[3] = &unk_1E70FF1B8;
  aBlock[4] = selfCopy;
  v25 = _Block_copy(aBlock);
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v42 = v13;
  v43 = v8;
  v26 = [(UICollectionViewData *)v8 arrayByAddingObjectsFromArray:v13];
  v41 = v18;
  v27 = [v26 arrayByAddingObjectsFromArray:v18];

  obj = v27;
  v28 = [v27 countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v46;
    do
    {
      v31 = 0;
      do
      {
        if (*v46 != v30)
        {
          objc_enumerationMutation(obj);
        }

        v32 = *(*(&v45 + 1) + 8 * v31);
        if (v32)
        {
          v33 = *(v32 + 288);
          if (v33)
          {
            v25[2](v25, selfCopy->_clonedCellsDict, *(*(&v45 + 1) + 8 * v31));
            goto LABEL_32;
          }

          if ((v33 & 2) != 0)
          {
            v34 = &OBJC_IVAR___UICollectionView__clonedDecorationViewsDict;
          }

          else
          {
            v34 = &OBJC_IVAR___UICollectionView__clonedSupplementaryViewsDict;
          }
        }

        else
        {
          v34 = &OBJC_IVAR___UICollectionView__clonedDecorationViewsDict;
        }

        v35 = selfCopy;
        v36 = *(&selfCopy->super.super.super.super.isa + *v34);
        _content = [(_UILabelConfiguration *)v32 _content];
        dictionary = [v36 objectForKeyedSubscript:_content];

        if (!dictionary)
        {
          dictionary = [MEMORY[0x1E695DF90] dictionary];
          _content2 = [(_UILabelConfiguration *)v32 _content];
          [v36 setObject:dictionary forKeyedSubscript:_content2];
        }

        v25[2](v25, dictionary, v32);

        selfCopy = v35;
LABEL_32:
        ++v31;
      }

      while (v29 != v31);
      v40 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
      v29 = v40;
    }

    while (v40);
  }
}

void __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v5 = a2;
  v6 = a3;
  v7 = [(UICollectionViewLayoutAttributes *)v6 __indexPath];
  v8 = [v5 objectForKeyedSubscript:v7];
  if (!v8)
  {
    v10 = [UICollectionReusableView alloc];
    v11 = *MEMORY[0x1E695EFF8];
    v12 = *(MEMORY[0x1E695EFF8] + 8);
    [v6 size];
    v15 = [(UICollectionReusableView *)v10 initWithFrame:v11, v12, v13, v14];
    [(UIView *)v15 setAutoresizingMask:0];
    [(UICollectionReusableView *)v15 setTranslatesAutoresizingMaskIntoConstraints:1];
    [(UIView *)v15 _setHostsLayoutEngine:1];
    [(UICollectionReusableView *)v15 _markAsDequeued];
    [v5 setObject:v15 forKeyedSubscript:v7];
    [*(a1 + 32) _applyLayoutAttributes:v6 toView:v15];
    v16 = [v5 objectForKeyedSubscript:v7];
    *(*(a1 + 32) + 2728) |= 0x100000000uLL;
    v17 = [v16 snapshotViewAfterScreenUpdates:0];
    [v16 bounds];
    [v17 setBounds:?];
    [v17 setAutoresizingMask:18];
    [(UIView *)v15 addSubview:v17];
    *(*(a1 + 32) + 2728) &= ~0x100000000uLL;
    v18 = *(*(a1 + 32) + 2152);
    v19 = v15;
    v20 = v19;
    if (!v19 || !v18)
    {
      goto LABEL_10;
    }

    v21 = [(UIView *)v19 effectiveUserInterfaceLayoutDirection];
    if (v21 == [v18 developmentLayoutDirection])
    {
      if (![(UIView *)v20 _flipsHorizontalAxis])
      {
LABEL_10:

        v25[0] = MEMORY[0x1E69E9820];
        v25[1] = 3221225472;
        v25[2] = __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke_2;
        v25[3] = &unk_1E70F6B40;
        v23 = *(a1 + 32);
        v26 = v16;
        v27 = v23;
        v9 = v20;
        v28 = v9;
        v29 = v6;
        v24 = v16;
        [UIView performWithoutAnimation:v25];

        goto LABEL_11;
      }

      v22 = 0;
    }

    else
    {
      v22 = [v18 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v20 _setFlipsHorizontalAxis:v22];
    goto LABEL_10;
  }

  v9 = v8;
  [*(a1 + 32) _applyLayoutAttributes:v6 toView:v8];
LABEL_11:
}

uint64_t __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke_2(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 48);
  if (*(a1 + 32))
  {
    v3 = *(a1 + 40);

    return [v3 insertSubview:v2 belowSubview:?];
  }

  else
  {
    v5 = [*(a1 + 56) zIndex];

    return [v1 _addControlledSubview:v2 atZIndex:v5 forced:0 initialAttributes:0];
  }
}

- (void)_updateFocusAfterLoadingVisibleCellsIfNeeded:(id)needed
{
  neededCopy = needed;
  v5 = neededCopy;
  v6 = *(&self->_collectionViewFlags + 1);
  if ((v6 & 0x80000000000) != 0)
  {
    *(&self->_collectionViewFlags + 1) = v6 & 0xFFFFF7FFFFFFFFFFLL;
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = __65__UICollectionView__updateFocusAfterLoadingVisibleCellsIfNeeded___block_invoke;
    v7[3] = &unk_1E70F35B8;
    v7[4] = self;
    v8 = neededCopy;
    [UIView performWithoutAnimation:v7];
  }
}

void __65__UICollectionView__updateFocusAfterLoadingVisibleCellsIfNeeded___block_invoke(uint64_t a1)
{
  v2 = [(_UICollectionViewFocusedItemState *)*(a1 + 40) copyWithReusableView:?];
  [*(a1 + 32) _setFocusedItemState:v2];

  v4 = [[_UIFocusUpdateRequest alloc] initWithEnvironment:*(a1 + 32)];
  [(_UIFocusUpdateRequest *)v4 setAllowsFocusingCurrentItem:1];
  [(_UIFocusUpdateRequest *)v4 setScrollIfNecessary:(*(*(a1 + 32) + 2728) >> 44) & 1];
  v3 = [*(a1 + 32) _focusSystem];
  [v3 _requestFocusUpdate:v4];
  [v3 updateFocusIfNeeded];
}

uint64_t __78__UICollectionView__setUpCompletionHandlerForAnimationInterruptionIfNecessary__block_invoke(uint64_t result, char a2)
{
  if ((a2 & 1) == 0)
  {
    return [*(result + 32) _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  }

  return result;
}

- (void)_ensureViewsAreLoadedInRect:(CGRect)rect
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  *(&self->_collectionViewFlags + 1) |= 0x800000000uLL;
  self->_visibleBounds = rect;
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
  [(UIView *)self layoutBelowIfNeeded];
  *(p_collectionViewFlags + 1) &= ~0x800000000uLL;
}

- (UIEdgeInsets)_visibleRectEdgeInsets
{
  top = self->_visibleRectInsets.top;
  left = self->_visibleRectInsets.left;
  bottom = self->_visibleRectInsets.bottom;
  right = self->_visibleRectInsets.right;
  result.right = right;
  result.bottom = bottom;
  result.left = left;
  result.top = top;
  return result;
}

- (void)_setAllowsVisibleCellUpdatesDuringUpdateAnimations:(BOOL)animations
{
  v3 = 0x800000000000000;
  if (!animations)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xF7FFFFFFFFFFFFFFLL | v3;
}

- (void)_setAllowsVisibleViewUpdatesDuringLayoutTransitions:(BOOL)transitions
{
  v3 = 0x1000000000000000;
  if (!transitions)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xEFFFFFFFFFFFFFFFLL | v3;
}

- (id)_viewAnimationsForView:(id)view startingLayoutAttributes:(id)attributes endingLayoutAttributes:(id)layoutAttributes startingLayout:(id)layout endingLayout:(id)endingLayout animationSetup:(id)setup animationCompletion:(id)completion enableCustomAnimations:(BOOL)self0 customAnimationsType:(unint64_t)self1
{
  viewCopy = view;
  attributesCopy = attributes;
  layoutAttributesCopy = layoutAttributes;
  layoutCopy = layout;
  endingLayoutCopy = endingLayout;
  setupCopy = setup;
  completionCopy = completion;
  _isReordering = [(UICollectionView *)self _isReordering];
  if (layoutAttributesCopy)
  {
    if (layoutAttributesCopy[72])
    {
      v22 = 1;
    }

    else
    {
      v22 = 2;
    }
  }

  else
  {
    v22 = 2;
  }

  v66[0] = MEMORY[0x1E69E9820];
  v66[1] = 3221225472;
  v67 = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke;
  v68 = &unk_1E70FF208;
  selfCopy = self;
  v23 = attributesCopy;
  animationsCopy = animations;
  v70 = v23;
  typeCopy = type;
  v24 = setupCopy;
  v71 = v24;
  v25 = completionCopy;
  v72 = v25;
  v74 = v22;
  _isInLayoutTransition = [layoutCopy _isInLayoutTransition];
  _disablesDoubleSidedAnimations = [layoutCopy _disablesDoubleSidedAnimations];
  if (!_isInLayoutTransition || (_disablesDoubleSidedAnimations & 1) != 0 || [(UICollectionViewLayoutAttributes *)v23 _isEquivalentTo:layoutAttributesCopy])
  {
    v29 = viewCopy;
    v28 = endingLayoutCopy;
    v30 = v67(v66, viewCopy, endingLayoutCopy, layoutAttributesCopy, 0, 1);
    v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v30];
    goto LABEL_42;
  }

  if (v23)
  {
    v32 = v23[72];
    if (v32)
    {
      indexPath = [v23 indexPath];
      v30 = [layoutCopy finalLayoutAttributesForDisappearingItemAtIndexPath:indexPath];

      indexPath2 = [layoutAttributesCopy indexPath];
      v37 = endingLayoutCopy;
      v57 = [endingLayoutCopy initialLayoutAttributesForAppearingItemAtIndexPath:indexPath2];
      goto LABEL_17;
    }

    v33 = (v32 >> 1) & 1;
  }

  else
  {
    v33 = 0;
  }

  v54 = v24;
  indexPath2 = [(_UILabelConfiguration *)v23 _content];
  indexPath3 = [v23 indexPath];
  if (v33)
  {
    v30 = [layoutCopy finalLayoutAttributesForDisappearingDecorationElementOfKind:indexPath2 atIndexPath:indexPath3];

    indexPath4 = [layoutAttributesCopy indexPath];
    v37 = endingLayoutCopy;
    v57 = [endingLayoutCopy initialLayoutAttributesForAppearingDecorationElementOfKind:indexPath2 atIndexPath:indexPath4];
  }

  else
  {
    v30 = [layoutCopy finalLayoutAttributesForDisappearingSupplementaryElementOfKind:indexPath2 atIndexPath:indexPath3];

    indexPath5 = [layoutAttributesCopy indexPath];
    v57 = [endingLayoutCopy initialLayoutAttributesForAppearingSupplementaryElementOfKind:indexPath2 atIndexPath:indexPath5];

    v37 = endingLayoutCopy;
  }

  v24 = v54;
LABEL_17:

  v29 = viewCopy;
  if (!v30)
  {
    if (layoutAttributesCopy && [(UICollectionViewLayoutAttributes *)v57 _isEquivalentTo:v23])
    {
      v30 = layoutAttributesCopy;
    }

    else
    {
      v30 = [v23 copy];
      [v30 setAlpha:0.0];
    }
  }

  if (!v57)
  {
    if (v23 && [(UICollectionViewLayoutAttributes *)v30 _isEquivalentTo:layoutAttributesCopy])
    {
      v57 = v23;
    }

    else
    {
      v57 = [layoutAttributesCopy copy];
      [v57 setAlpha:0.0];
    }
  }

  if ([(UICollectionViewLayoutAttributes *)v30 _isEquivalentTo:layoutAttributesCopy]&& [(UICollectionViewLayoutAttributes *)v57 _isEquivalentTo:v23])
  {
    v40 = v67;
    v41 = viewCopy;
    v42 = v37;
    goto LABEL_38;
  }

  v43 = [(UICollectionViewLayoutAttributes *)v23 _isTransitionVisibleTo:v30];
  v44 = [(UICollectionViewLayoutAttributes *)v57 _isTransitionVisibleTo:layoutAttributesCopy];
  if (!v43 || !v44)
  {
    if (v43)
    {
      indexPath6 = [layoutAttributesCopy indexPath];
      [v30 setIndexPath:indexPath6];

      v67(v66, viewCopy, layoutCopy, v30, 0, 1);
      v52 = LABEL_39:;
      v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v52];

      goto LABEL_40;
    }

    if (v44)
    {
      v60[0] = MEMORY[0x1E69E9820];
      v60[1] = 3221225472;
      v60[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_8;
      v60[3] = &unk_1E70F6228;
      v60[4] = self;
      v61 = v57;
      v50 = viewCopy;
      v62 = v50;
      [UIView performWithoutAnimation:v60];
      v51 = v67(v66, v50, endingLayoutCopy, layoutAttributesCopy, 0, 1);
      v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v51];

LABEL_40:
      v48 = v57;
      goto LABEL_41;
    }

    v40 = v67;
    v41 = viewCopy;
    v42 = endingLayoutCopy;
LABEL_38:
    v40(v66, v41, v42, layoutAttributesCopy, 0, 1);
    goto LABEL_39;
  }

  indexPath7 = [layoutAttributesCopy indexPath];
  [v30 setIndexPath:indexPath7];

  v56 = v67(v66, viewCopy, layoutCopy, v30, !_isReordering, 0);
  v63[0] = MEMORY[0x1E69E9820];
  v63[1] = 3221225472;
  v63[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_7;
  v63[3] = &unk_1E70F6228;
  v63[4] = self;
  v64 = v57;
  v46 = viewCopy;
  v65 = v46;
  [UIView performWithoutAnimation:v63];
  v47 = v67(v66, v46, endingLayoutCopy, layoutAttributesCopy, 0, 0);
  v31 = [MEMORY[0x1E695DEC8] arrayWithObjects:{v56, v47, 0}];

  v48 = v57;
  v29 = viewCopy;
LABEL_41:

  v28 = endingLayoutCopy;
LABEL_42:

  return v31;
}

UICollectionViewAnimation *__198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke(uint64_t a1, void *a2, void *a3, void *a4, int a5, uint64_t a6)
{
  v11 = a2;
  v12 = a3;
  v13 = a4;
  if (a5)
  {
    *(*(a1 + 32) + 2728) |= 0x100000000uLL;
    v14 = [_UICollectionSnapshotView alloc];
    [*(a1 + 40) frame];
    v15 = [(UICollectionReusableView *)v14 initWithFrame:?];
    v15->_snapshottedViewDisablesRasterizationInAnimations = [v11 _disableRasterizeInAnimations];
    [(UIView *)v15 setAutoresizingMask:0];
    [(UICollectionReusableView *)v15 setTranslatesAutoresizingMaskIntoConstraints:1];
    [(UIView *)v15 _setHostsLayoutEngine:1];
    [(UICollectionReusableView *)v15 _markAsDequeued];
    v16 = [v11 snapshotViewAfterScreenUpdates:0];
    [(UIView *)v15 bounds];
    [v16 setBounds:?];
    [v16 setAutoresizingMask:18];
    [(UIView *)v15 addSubview:v16];
    *(*(a1 + 32) + 2728) &= ~0x100000000uLL;
    if ([v11 isHidden])
    {
      [(UIView *)v15 setHidden:1];
    }

    v44[0] = MEMORY[0x1E69E9820];
    v44[1] = 3221225472;
    v44[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_2;
    v44[3] = &unk_1E70F6228;
    v44[4] = *(a1 + 32);
    v17 = v15;
    v45 = v17;
    v46 = v11;
    [UIView performWithoutAnimation:v44];
    v40[0] = MEMORY[0x1E69E9820];
    v40[1] = 3221225472;
    v40[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_3;
    v40[3] = &unk_1E70F6228;
    v18 = v17;
    v41 = v18;
    v19 = *(a1 + 40);
    v20 = *(a1 + 32);
    v42 = v19;
    v43 = v20;
    [UIView performWithoutAnimation:v40];
    if (*(a1 + 80) == 1)
    {
      v21 = [v12 _animationForReusableView:v18 toLayoutAttributes:v13 type:*(a1 + 64)];
    }

    else
    {
      v21 = 0;
    }

    v22 = [[UICollectionViewAnimation alloc] initWithView:v18 viewType:0 finalLayoutAttributes:v13 startFraction:0 endFraction:0 animateFromCurrentPostion:v21 deleteAfterAnimation:0.0 customAnimations:1.0];
    [(UICollectionViewAnimation *)v22 addStartupHandler:*(a1 + 48)];
    v37[0] = MEMORY[0x1E69E9820];
    v37[1] = 3221225472;
    v37[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_4;
    v37[3] = &unk_1E70FE248;
    v38 = v18;
    v39 = *(a1 + 56);
    v23 = v18;
    [(UICollectionViewAnimation *)v22 addCompletionHandler:v37];
  }

  else
  {
    if (*(a1 + 80) == 1)
    {
      v16 = [v12 _animationForReusableView:v11 toLayoutAttributes:v13 type:*(a1 + 64)];
    }

    else
    {
      v16 = 0;
    }

    if ([*(a1 + 32) _viewIsReorderedCell:v11])
    {
      [v11 bounds];
      v25 = v24;
      v27 = v26;
      [v13 size];
      v29 = v25 != v28;
      if (v27 != v30)
      {
        v29 = 1;
      }

      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_5;
      aBlock[3] = &unk_1E70FF1E0;
      v36 = v29;
      v34 = v11;
      v35 = v13;
      v31 = _Block_copy(aBlock);

      v16 = v31;
    }

    v22 = [[UICollectionViewAnimation alloc] initWithView:v11 viewType:*(a1 + 72) finalLayoutAttributes:v13 startFraction:a6 endFraction:0 animateFromCurrentPostion:v16 deleteAfterAnimation:0.0 customAnimations:1.0];
    [(UICollectionViewAnimation *)v22 addStartupHandler:*(a1 + 48)];
    [(UICollectionViewAnimation *)v22 addCompletionHandler:*(a1 + 56)];
  }

  return v22;
}

void __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_3(uint64_t a1)
{
  [*(a1 + 32) _setLayoutAttributes:*(a1 + 40)];
  v2 = *(*(a1 + 48) + 2152);
  v3 = *(a1 + 32);
  v8 = v2;
  v4 = v3;
  if (v8)
  {
    v5 = v4 == 0;
  }

  else
  {
    v5 = 1;
  }

  if (!v5)
  {
    v6 = [v4 effectiveUserInterfaceLayoutDirection];
    if (v6 == [v8 developmentLayoutDirection])
    {
      if (![v4 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      v7 = 0;
    }

    else
    {
      v7 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [v4 _setFlipsHorizontalAxis:v7];
  }

LABEL_10:
}

uint64_t __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_4(uint64_t a1)
{
  [*(a1 + 32) removeFromSuperview];
  result = *(a1 + 40);
  if (result)
  {
    v3 = *(result + 16);

    return v3();
  }

  return result;
}

void __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_5(uint64_t a1, void *a2)
{
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_6;
  v5[3] = &unk_1E70F5AF0;
  v8 = *(a1 + 48);
  v6 = *(a1 + 32);
  v7 = *(a1 + 40);
  v4 = a2;
  [UIView performWithoutAnimation:v5];
  v4[2](v4, 1);
}

uint64_t __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_6(uint64_t a1)
{
  v2 = *(a1 + 48);
  v3 = *(a1 + 40);
  if (v2 == 1)
  {
    [v3 frame];
    v4 = *(a1 + 32);

    return [v4 setFrame:?];
  }

  else
  {
    [v3 center];
    v6 = *(a1 + 32);

    return [v6 setCenter:?];
  }
}

- (void)_setVisibleView:(id)view forLayoutAttributes:(id)attributes
{
  attributesCopy = attributes;
  viewCopy = view;
  if (attributesCopy)
  {
    v7 = *(attributesCopy + 72);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }

    v10 = attributesCopy[1];
  }

  else
  {
    v9 = 0;
    v10 = 0;
  }

  subviewManager = self->_subviewManager;
  __indexPath = [(UICollectionViewLayoutAttributes *)attributesCopy __indexPath];

  v13 = viewCopy;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews setView:viewCopy ofKind:v10 inCategory:v9 atIndexPath:__indexPath];
    v13 = viewCopy;
  }
}

- (void)_applyBlockToAllReusableViews:(id)views
{
  v32 = *MEMORY[0x1E69E9840];
  viewsCopy = views;
  v5 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:10];
  subviewManager = self->_subviewManager;
  v29[0] = MEMORY[0x1E69E9820];
  v29[1] = 3221225472;
  v29[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke;
  v29[3] = &unk_1E70FFC98;
  v7 = v5;
  v30 = v7;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v29];
  }

  prefetchCacheItems = self->_prefetchCacheItems;
  v27[0] = MEMORY[0x1E69E9820];
  v27[1] = 3221225472;
  v27[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_2;
  v27[3] = &unk_1E70FEF90;
  v9 = v7;
  v28 = v9;
  [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v27];
  if (self->_firstResponderView)
  {
    [v9 addObject:?];
  }

  focusedItemState = self->_focusedItemState;
  if (focusedItemState)
  {
    focusedItemState = focusedItemState->_reusableView;
  }

  v11 = focusedItemState;

  if (v11)
  {
    v12 = self->_focusedItemState;
    if (v12)
    {
      v12 = v12->_reusableView;
    }

    v13 = v12;
    [v9 addObject:v13];
  }

  v14 = self->_subviewManager;
  v25[0] = MEMORY[0x1E69E9820];
  v25[1] = 3221225472;
  v25[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_3;
  v25[3] = &unk_1E70FF230;
  v15 = v9;
  v26 = v15;
  [(_UICollectionViewSubviewManager *)v14 enumerateAllViewsInReuseQueueWithEnumerator:v25];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v16 = v15;
  v17 = [v16 countByEnumeratingWithState:&v21 objects:v31 count:16];
  if (v17)
  {
    v18 = v17;
    v19 = *v22;
    do
    {
      for (i = 0; i != v18; ++i)
      {
        if (*v22 != v19)
        {
          objc_enumerationMutation(v16);
        }

        viewsCopy[2](viewsCopy, *(*(&v21 + 1) + 8 * i));
      }

      v18 = [v16 countByEnumeratingWithState:&v21 objects:v31 count:16];
    }

    while (v18);
  }
}

void __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v4 = *(a3 + 24);
    if (v4)
    {
      v5 = v4;
      [*(a1 + 32) addObject:v4];
      v4 = v5;
    }
  }

  else
  {
    v4 = 0;
  }
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)collectionViewLayout
{
  v5 = collectionViewLayout;
  v7 = v5;
  if (!v5)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6941 description:@"layout cannot be nil in setCollectionViewLayout:"];

    v5 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v5 animated:0 isInteractive:0 completion:0];
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated
{
  v4 = animated;
  v7 = layout;
  v9 = v7;
  if (!v7)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6947 description:@"layout cannot be nil in setCollectionViewLayout:animated:"];

    v7 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v7 animated:v4 isInteractive:0 completion:0];
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated completion:(void *)completion
{
  v6 = animated;
  v13 = layout;
  v9 = completion;
  v10 = v13;
  v11 = v9;
  if (!v13)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6953 description:@"layout cannot be nil in setCollectionViewLayout:animated:completion:"];

    v10 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v10 animated:v6 isInteractive:0 completion:v11];
}

- (void)_setCollectionViewLayout:(id)layout animated:(BOOL)animated isInteractive:(BOOL)interactive completion:(id)completion animator:(id)animator
{
  interactiveCopy = interactive;
  animatedCopy = animated;
  v246 = *MEMORY[0x1E69E9840];
  layoutCopy = layout;
  completionCopy = completion;
  animatorCopy = animator;
  v177 = layoutCopy;
  if (self->_layout != layoutCopy)
  {
    v161 = animatorCopy;
    v14 = dyld_program_sdk_at_least();
    p_collectionViewFlags = &self->_collectionViewFlags;
    v15 = *(&self->_collectionViewFlags + 1);
    selfCopy = self;
    if (v14)
    {
      if ((v15 & 0x1000000000) != 0)
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6974 description:{@"Cannot set the layout [%@] for [%@] during an update.", layoutCopy, self}];
      }
    }

    else if ((v15 & 0x1000000000) != 0)
    {
      v150 = *(__UILogGetCategoryCachedImpl("Assert", &_setCollectionViewLayout_animated_isInteractive_completion_animator____s_category) + 8);
      if (os_log_type_enabled(v150, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        *&buf[4] = layoutCopy;
        *&buf[12] = 2112;
        *&buf[14] = self;
        _os_log_impl(&dword_188A29000, v150, OS_LOG_TYPE_ERROR, "Cannot set the layout [%@] for [%@] during an update.", buf, 0x16u);
      }
    }

    [(UICollectionView *)self _resetPrefetchState];
    _focusedItemState = [(UICollectionView *)self _focusedItemState];
    [(UICollectionView *)self _setFocusedItemState:0];
    v17 = _focusedItemState;
    if (_focusedItemState)
    {
      v17 = _focusedItemState[1];
    }

    v18 = v17;
    [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v18];

    [(UIScrollView *)self _resetContentScrollableAxes];
    [(UICollectionViewLayout *)layoutCopy _setCollectionView:self];
    if ([(UICollectionViewLayout *)layoutCopy canBeEdited]&& [(UICollectionViewLayout *)layoutCopy isEditing]!= (HIWORD(*(&self->_collectionViewFlags + 1)) & 1))
    {
      [(UICollectionViewLayout *)layoutCopy setEditing:?];
    }

    v170 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    [v170 _setInvalidateEverything:1];
    [v170 _setInvalidateDataSourceCounts:1];
    [(UICollectionViewLayout *)layoutCopy _invalidateLayoutUsingContext:v170];
    [(UICollectionView *)self _reloadDataIfNeeded];
    if ((*(&self->_collectionViewFlags + 11) & 0x40) != 0)
    {
      currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler2 handleFailureInMethod:a2 object:self file:? lineNumber:? description:?];
    }

    if (animatedCopy || interactiveCopy)
    {
      [(UIScrollView *)self stopScrollingAndZooming];
    }

    if ((*(&self->_collectionViewFlags + 12) & 4) == 0)
    {
      [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
      [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController cleanupSectionFocusGuides];
      [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
      [(UICollectionView *)self _reconfigureSectionContainersForUpdate:0];
      objc_storeStrong(&self->_layout, layout);
      [(UICollectionViewLayout *)self->_layout _setCollectionView:?];
      v19 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
      collectionViewData = self->_collectionViewData;
      self->_collectionViewData = v19;

      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
      v21 = self->_layout;
      selfCopy2 = self;
      if (!v21)
      {
LABEL_138:

        animatorCopy = v161;
        goto LABEL_139;
      }

      v23 = selfCopy2;
      effectiveUserInterfaceLayoutDirection = [(UIView *)selfCopy2 effectiveUserInterfaceLayoutDirection];
      if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v21 developmentLayoutDirection])
      {
        if (![(UIView *)v23 _flipsHorizontalAxis])
        {
LABEL_47:
          selfCopy2 = v23;
          goto LABEL_138;
        }

        _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
      }

      else
      {
        _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v21 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [(UIScrollView *)v23 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
      goto LABEL_47;
    }

    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) == 0)
    {
      [(UICollectionViewLayout *)self->_layout _prepareForTransitionToLayout:layoutCopy];
      [(UICollectionViewLayout *)layoutCopy _prepareForTransitionFromLayout:self->_layout];
    }

    v167 = [[UICollectionViewData alloc] initWithCollectionView:layoutCopy layout:?];
    [(UICollectionViewData *)v167 _prepareToLoadData];
    [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      [(UICollectionViewLayout *)layoutCopy setTransitionProgress:0.0];
    }

    *(&self->_collectionViewFlags + 1) |= 0x20000000uLL;
    selectionController = self->_selectionController;
    if (selectionController)
    {
      v27 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
    }

    else
    {
      v27 = 0;
    }

    v156 = [v27 mutableCopy];

    v28 = MEMORY[0x1E695DFA8];
    _indexPathsForVisibleItems = [(UICollectionView *)self _indexPathsForVisibleItems];
    v164 = [v28 setWithArray:_indexPathsForVisibleItems];

    if ([v164 intersectsSet:v156])
    {
      [v164 intersectSet:v156];
    }

    [(UICollectionView *)self _visibleBounds];
    x = v247.origin.x;
    y = v247.origin.y;
    width = v247.size.width;
    height = v247.size.height;
    MidX = CGRectGetMidX(v247);
    v248.origin.x = x;
    v248.origin.y = y;
    v248.size.width = width;
    v248.size.height = height;
    MidY = CGRectGetMidY(v248);
    v36 = [v164 count];
    if ((*(&self->_collectionViewFlags + 1) & 0x10) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      anyObject = [_delegateProxy _indexPathOfReferenceItemForLayoutTransitionInCollectionView:self];

      v37 = anyObject != 0;
      if (anyObject)
      {
        v39 = [(UICollectionViewData *)v167 layoutAttributesForItemAtIndexPath:anyObject];
        goto LABEL_52;
      }
    }

    else
    {
      v37 = 0;
    }

    if ([v164 count] == 1)
    {
      anyObject = [v164 anyObject];
    }

    else
    {
      v236 = 0u;
      v237 = 0u;
      v234 = 0u;
      v235 = 0u;
      v40 = v164;
      v41 = [v40 countByEnumeratingWithState:&v234 objects:v245 count:16];
      if (v41)
      {
        anyObject = 0;
        v42 = *v235;
        v43 = 3.40282347e38;
        do
        {
          for (i = 0; i != v41; ++i)
          {
            if (*v235 != v42)
            {
              objc_enumerationMutation(v40);
            }

            v45 = *(*(&v234 + 1) + 8 * i);
            v46 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v45];
            [v46 center];
            *&v47 = (v47 - MidX) * (v47 - MidX) + (v48 - MidY) * (v48 - MidY);
            v49 = sqrtf(*&v47);
            if (v43 > v49)
            {
              v50 = v45;

              v43 = v49;
              anyObject = v50;
            }
          }

          v41 = [v40 countByEnumeratingWithState:&v234 objects:v245 count:16];
        }

        while (v41);
      }

      else
      {
        anyObject = 0;
      }
    }

    if (!anyObject)
    {
      anyObject = 0;
      goto LABEL_56;
    }

    v51 = [(UICollectionViewData *)v167 layoutAttributesForItemAtIndexPath:anyObject];
    v39 = v51;
    if (!v37)
    {
      [v51 center];
      x = v61 - width * 0.5;
      y = v62 - height * 0.5;
      goto LABEL_55;
    }

LABEL_52:
    [v39 frame];
    v53 = v52;
    v55 = v54;
    v56 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:anyObject];
    [v56 frame];
    v58 = v57;
    [v56 frame];
    v60 = v59;

    x = v53 - (v58 - x);
    y = v55 - (v60 - y);
LABEL_55:

LABEL_56:
    [(UICollectionViewData *)v167 collectionViewContentRect];
    v157 = v249.size.height;
    v159 = v249.size.width;
    v249.origin.x = 0.0;
    v249.origin.y = 0.0;
    v253.origin.x = x;
    v253.origin.y = y;
    v253.size.width = width;
    v253.size.height = height;
    if (CGRectContainsRect(v249, v253))
    {
      v63 = x;
      selfCopy4 = self;
    }

    else
    {
      v250.origin.x = 0.0;
      v250.origin.y = 0.0;
      v250.size.height = v157;
      v250.size.width = v159;
      v254.origin.x = x;
      v254.origin.y = y;
      v254.size.width = width;
      v254.size.height = height;
      v251 = CGRectIntersection(v250, v254);
      v63 = 0.0;
      selfCopy4 = self;
      if (v159 > width)
      {
        if (v251.size.width >= width)
        {
          v63 = x;
        }

        else
        {
          v65 = width - v251.size.width;
          if (v251.origin.x <= x)
          {
            v66 = -v65;
          }

          else
          {
            v66 = v65;
          }

          v63 = x + v66;
        }
      }

      if (v157 <= height)
      {
        y = 0.0;
      }

      else if (v251.size.height < height)
      {
        v67 = height - v251.size.height;
        if (v251.origin.y <= y)
        {
          v67 = -(height - v251.size.height);
        }

        y = y + v67;
      }
    }

    [(UIScrollView *)selfCopy4 _effectiveContentInset];
    v69 = -v68;
    v71 = -v70;
    v72 = v63 - v68;
    v73 = y - v70;
    if (v36)
    {
      v74 = v72;
    }

    else
    {
      v74 = v69;
    }

    if (v36)
    {
      v75 = v73;
    }

    else
    {
      v75 = v71;
    }

    [(UICollectionViewLayout *)v177 transitionContentOffsetForProposedContentOffset:anyObject keyItemIndexPath:v74, v75];
    [(UICollectionViewLayout *)v177 targetContentOffsetForProposedContentOffset:?];
    [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
    v77 = v76;
    v79 = v78;
    height = [(UICollectionViewData *)v167 layoutAttributesForElementsInRect:v76, v78, width, height];
    v81 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v82 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v83 = objc_alloc_init(MEMORY[0x1E695DF90]);
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke;
    aBlock[3] = &unk_1E70FF258;
    v154 = v81;
    v231 = v154;
    v153 = v82;
    v232 = v153;
    v152 = v83;
    v233 = v152;
    v174 = _Block_copy(aBlock);
    v228 = 0u;
    v229 = 0u;
    v226 = 0u;
    v227 = 0u;
    obj = height;
    v84 = [obj countByEnumeratingWithState:&v226 objects:v244 count:16];
    if (v84)
    {
      v85 = *v227;
      do
      {
        for (j = 0; j != v84; ++j)
        {
          if (*v227 != v85)
          {
            objc_enumerationMutation(obj);
          }

          v87 = *(*(&v226 + 1) + 8 * j);
          __indexPath = [(UICollectionViewLayoutAttributes *)v87 __indexPath];
          if (!v87)
          {
            v90 = 0;
            v91 = selfCopy;
LABEL_88:
            v93 = [(UICollectionViewLayout *)v91->_layout layoutAttributesForItemAtIndexPath:__indexPath];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForItemAtIndexPath:__indexPath];
            v95 = 0;
            goto LABEL_89;
          }

          v89 = *(v87 + 288);
          v90 = *(v87 + 8);
          v91 = selfCopy;
          if (v89)
          {
            goto LABEL_88;
          }

          layout = selfCopy->_layout;
          if ((v89 & 2) != 0)
          {
            v93 = [(UICollectionViewLayout *)layout layoutAttributesForDecorationViewOfKind:*(v87 + 8) atIndexPath:__indexPath];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForDecorationViewOfKind:v90 atIndexPath:__indexPath];
            v95 = 2;
          }

          else
          {
            v93 = [(UICollectionViewLayout *)layout layoutAttributesForSupplementaryViewOfKind:*(v87 + 8) atIndexPath:__indexPath];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForSupplementaryViewOfKind:v90 atIndexPath:__indexPath];
            v95 = 1;
          }

LABEL_89:
          if (v93 | v94)
          {
            dictionary = [MEMORY[0x1E695DF90] dictionary];
            v97 = dictionary;
            if (v94)
            {
              [dictionary setObject:v94 forKey:@"newLayoutInfos"];
            }

            if (v93)
            {
              [v97 setObject:v93 forKey:@"previousLayoutInfos"];
            }

            v174[2](v174, v97, __indexPath, v90, v95);
          }
        }

        v84 = [obj countByEnumeratingWithState:&v226 objects:v244 count:16];
      }

      while (v84);
    }

    subviewManager = selfCopy->_subviewManager;
    v223[0] = MEMORY[0x1E69E9820];
    v223[1] = 3221225472;
    v223[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_2;
    v223[3] = &unk_1E70FF280;
    v223[4] = selfCopy;
    v99 = v177;
    v224 = v99;
    v173 = v174;
    v225 = v173;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v223];
    }

    [(UICollectionView *)selfCopy _updateBackgroundView];
    v221[0] = MEMORY[0x1E69E9820];
    v221[1] = 3221225472;
    v221[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_3;
    v221[3] = &unk_1E70FF2D0;
    v221[4] = selfCopy;
    v100 = v99;
    v222 = v100;
    v101 = _Block_copy(v221);
    v101[2](v101, v154);
    v219[0] = MEMORY[0x1E69E9820];
    v219[1] = 3221225472;
    v219[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_6;
    v219[3] = &unk_1E70FFCC0;
    v102 = v101;
    v220 = v102;
    [v153 enumerateKeysAndObjectsUsingBlock:v219];
    v217[0] = MEMORY[0x1E69E9820];
    v217[1] = 3221225472;
    v217[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_7;
    v217[3] = &unk_1E70FFCC0;
    v151 = v102;
    v218 = v151;
    [v152 enumerateKeysAndObjectsUsingBlock:v217];
    v215[0] = MEMORY[0x1E69E9820];
    v215[1] = 3221225472;
    v215[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_8;
    v215[3] = &unk_1E70FF2F8;
    v215[4] = selfCopy;
    v103 = v100;
    v216 = v103;
    [(UICollectionView *)selfCopy _applyBlockToAllReusableViews:v215];
    *buf = 0;
    *&buf[8] = buf;
    *&buf[16] = 0x3032000000;
    v241 = __Block_byref_object_copy__39;
    v242 = __Block_byref_object_dispose__39;
    v243 = 0;
    [(UIView *)selfCopy bounds];
    v105 = v104;
    v107 = v106;
    v109 = v108;
    v111 = v110;
    v112 = [UIView alloc];
    v113 = [(UIView *)v112 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    [(UIView *)selfCopy addSubview:v113];
    v114 = selfCopy->_layout;
    if (v167 && (v167[96] & 8) != 0)
    {
      if ([(UICollectionViewLayout *)v103 shouldInvalidateLayoutForBoundsChange:v77, v79, width, height]&& (v252.origin.x = v77, v252.origin.y = v79, v252.size.width = width, v252.size.height = height, v255.origin.x = v105, v255.origin.y = v107, v255.size.width = v109, v255.size.height = v111, !CGRectEqualToRect(v252, v255)))
      {
        v111 = [(UICollectionViewLayout *)v103 _invalidationContextForBoundsChange:v77 fromOldBounds:v79, width, height, v105, v107, v109, v111];
        v115 = 1;
        v117 = 1;
      }

      else
      {
        v111 = 0;
        v117 = 0;
        v115 = 1;
      }
    }

    else
    {
      v115 = 0;
      v111 = 0;
      v117 = 0;
    }

    v199[0] = MEMORY[0x1E69E9820];
    v199[1] = 3221225472;
    v199[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_9;
    v199[3] = &unk_1E70FF3C0;
    v199[4] = selfCopy;
    v208 = v77;
    v209 = v79;
    v210 = v159;
    v211 = v157;
    v212 = v115;
    v200 = v103;
    v213 = animatedCopy;
    v118 = v154;
    v201 = v118;
    v119 = v153;
    v202 = v119;
    v120 = v152;
    v203 = v120;
    v121 = v113;
    v214 = interactiveCopy;
    v204 = v121;
    v207 = buf;
    v21 = v167;
    v205 = v21;
    v122 = v114;
    v206 = v122;
    v175 = _Block_copy(v199);
    v189[0] = MEMORY[0x1E69E9820];
    v189[1] = 3221225472;
    v189[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_18;
    v189[3] = &unk_1E70FF3E8;
    v189[4] = selfCopy;
    v168 = v122;
    v190 = v168;
    v155 = v118;
    v191 = v155;
    v158 = v119;
    v192 = v158;
    v160 = v120;
    v193 = v160;
    v197 = buf;
    v196 = completionCopy;
    v198 = v117;
    v123 = v111;
    v194 = v123;
    v163 = v121;
    v195 = v163;
    v124 = _Block_copy(v189);
    if (v161)
    {
      v125 = v161;
      v126 = [v125 copy];
      v187 = 0u;
      v188 = 0u;
      v185 = 0u;
      v186 = 0u;
      _animations = [v125 _animations];
      v128 = [_animations countByEnumeratingWithState:&v185 objects:v239 count:16];
      if (v128)
      {
        v129 = *v186;
        do
        {
          for (k = 0; k != v128; ++k)
          {
            if (*v186 != v129)
            {
              objc_enumerationMutation(_animations);
            }

            v131 = [*(*(&v185 + 1) + 8 * k) copy];
            [v126 addAnimations:v131];
          }

          v128 = [_animations countByEnumeratingWithState:&v185 objects:v239 count:16];
        }

        while (v128);
      }

      v183 = 0u;
      v184 = 0u;
      v181 = 0u;
      v182 = 0u;
      _completions = [v125 _completions];
      v133 = [_completions countByEnumeratingWithState:&v181 objects:v238 count:16];
      if (v133)
      {
        v134 = *v182;
        do
        {
          for (m = 0; m != v133; ++m)
          {
            if (*v182 != v134)
            {
              objc_enumerationMutation(_completions);
            }

            v136 = [*(*(&v181 + 1) + 8 * m) copy];
            [v126 addCompletion:v136];
          }

          v133 = [_completions countByEnumeratingWithState:&v181 objects:v238 count:16];
        }

        while (v133);
      }

      [v126 addAnimations:v175];
      v179[0] = MEMORY[0x1E69E9820];
      v179[1] = 3221225472;
      v179[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_20;
      v179[3] = &unk_1E70FFB68;
      v180 = v124;
      [v126 addCompletion:v179];
      [v126 startAnimation];

      p_isa = &selfCopy->super.super.super.super.isa;
    }

    else
    {
      p_isa = &selfCopy->super.super.super.super.isa;
      if (animatedCopy)
      {
        if (dyld_program_sdk_at_least())
        {
          v138 = 7;
        }

        else
        {
          v138 = 5;
        }

        [UIView animateWithDuration:v138 delay:v175 options:v124 animations:0.3 completion:0.0];
      }

      else
      {
        v175[2]();
        (*(v124 + 2))(v124, 1);
      }
    }

    v139 = p_isa[269];
    v140 = p_isa;
    v141 = v140;
    if (v140 && v139)
    {
      effectiveUserInterfaceLayoutDirection2 = [v140 effectiveUserInterfaceLayoutDirection];
      if (effectiveUserInterfaceLayoutDirection2 != [v139 developmentLayoutDirection])
      {
        _wantsRightToLeftHorizontalMirroringIfNeeded2 = [v139 _wantsRightToLeftHorizontalMirroringIfNeeded];
        goto LABEL_134;
      }

      if ([v141 _flipsHorizontalAxis])
      {
        _wantsRightToLeftHorizontalMirroringIfNeeded2 = 0;
LABEL_134:
        [v141 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded2];
      }
    }

    *(p_collectionViewFlags + 1) &= ~0x10000000uLL;
    [v141 setNeedsFocusUpdate];
    v144 = v141[370];
    _focusedItemState2 = [v141 _focusedItemState];
    v146 = _focusedItemState2;
    if (_focusedItemState2)
    {
      v147 = *(_focusedItemState2 + 16);
    }

    else
    {
      v147 = 0;
    }

    v148 = v147;
    [v144 updateFocusedIndexPath:v148];

    [v141[370] reloadSectionFocusGuides];
    _Block_object_dispose(buf, 8);

    selfCopy2 = anyObject;
    goto LABEL_138;
  }

LABEL_139:
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke(id *a1, uint64_t a2, uint64_t a3, void *a4, uint64_t a5)
{
  v9 = a4;
  v12 = v9;
  if (a5 == 1)
  {
    v10 = [a1[5] objectForKeyedSubscript:v9];
    if (!v10)
    {
      v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v11 = a1[5];
LABEL_8:
      [v11 setObject:v10 forKeyedSubscript:v12];
    }
  }

  else
  {
    if (!a5)
    {
      [a1[4] setObject:a2 forKeyedSubscript:a3];
      goto LABEL_10;
    }

    v10 = [a1[6] objectForKeyedSubscript:v9];
    if (!v10)
    {
      v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v11 = a1[6];
      goto LABEL_8;
    }
  }

  [v10 setObject:a2 forKeyedSubscript:a3];

LABEL_10:
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_2(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v16 = a3;
  v8 = a4;
  v9 = [a5 _layoutAttributes];
  if (!v9 || (v10 = v9[72], (v10 & 1) != 0))
  {

    v12 = [*(*(a1 + 32) + 2152) layoutAttributesForItemAtIndexPath:v16];
    v13 = [*(a1 + 40) layoutAttributesForItemAtIndexPath:v16];
  }

  else
  {

    v11 = *(*(a1 + 32) + 2152);
    if ((v10 & 2) != 0)
    {
      v12 = [v11 layoutAttributesForDecorationViewOfKind:v8 atIndexPath:v16];
      [*(a1 + 40) layoutAttributesForDecorationViewOfKind:v8 atIndexPath:v16];
    }

    else
    {
      v12 = [v11 layoutAttributesForSupplementaryViewOfKind:v8 atIndexPath:v16];
      [*(a1 + 40) layoutAttributesForSupplementaryViewOfKind:v8 atIndexPath:v16];
    }
    v13 = ;
  }

  if (v12 | v13)
  {
    v14 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v15 = v14;
    if (v13)
    {
      [v14 setObject:v13 forKeyedSubscript:@"newLayoutInfos"];
    }

    if (v12)
    {
      [v15 setObject:v12 forKeyedSubscript:@"previousLayoutInfos"];
    }

    (*(*(a1 + 48) + 16))();
  }
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_3(uint64_t a1, void *a2)
{
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_4;
  v4[3] = &unk_1E70FF2A8;
  v3 = *(a1 + 40);
  v4[4] = *(a1 + 32);
  v5 = v3;
  [a2 enumerateKeysAndObjectsUsingBlock:v4];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_4(uint64_t a1, uint64_t a2, void *a3)
{
  v6 = [a3 objectForKey:@"previousLayoutInfos"];
  v7 = [a3 objectForKey:@"newLayoutInfos"];
  v8 = v7;
  if (v6)
  {
    v9 = v6[1];
    v10 = v6;
  }

  else
  {
    v9 = [(_UILabelConfiguration *)v7 _content];
    v10 = v8;
    objc_storeStrong((*(a1 + 32) + 2552), v8);
    if (!v10)
    {
      if ([0 isHidden])
      {
        [0 isHidden];
      }

      v10 = 0;
      goto LABEL_32;
    }
  }

  v11 = *(v10 + 72);
  if (v11)
  {
    v13 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
  }

  else
  {
    if (!v9)
    {
      goto LABEL_13;
    }

    v12 = *(*(a1 + 32) + 2984);
    if ((v11 & 2) != 0)
    {
      [(_UICollectionViewSubviewManager *)v12 visibleDecorationOfKind:v9 atIndexPath:a2];
    }

    else
    {
      [(_UICollectionViewSubviewManager *)v12 visibleSupplementaryOfKind:v9 atIndexPath:a2];
    }
    v13 = ;
  }

  v14 = v13;
  if (v13)
  {
    v22[0] = MEMORY[0x1E69E9820];
    v22[1] = 3221225472;
    v22[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_5;
    v22[3] = &unk_1E70F6228;
    v22[4] = *(a1 + 32);
    v10 = v10;
    v23 = v10;
    v15 = v14;
    v24 = v15;
    [UIView performWithoutAnimation:v22];

    goto LABEL_28;
  }

LABEL_13:
  if ([v8 isHidden])
  {
    v15 = 0;
    if (([v6 isHidden] & 1) != 0 || !v8)
    {
      goto LABEL_28;
    }

    goto LABEL_18;
  }

  if (!v8)
  {
LABEL_32:
    v15 = 0;
    goto LABEL_28;
  }

LABEL_18:
  v16 = *(v8 + 72);
  if (v16)
  {
    v15 = [*(a1 + 32) _createPreparedCellForItemAtIndexPath:a2 withLayoutAttributes:v10 applyAttributes:1];
    if (v15)
    {
      [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) setVisibleCell:v15 atIndexPath:a2];
    }
  }

  else
  {
    v17 = [*(a1 + 32) _createPreparedSupplementaryViewForElementOfKind:v9 atIndexPath:a2 layout:*(a1 + 40) withLayoutAttributes:v10 applyAttributes:1];
    v15 = v17;
    if ((v16 & 2) != 0)
    {
      if (v17)
      {
        v19 = *(*(a1 + 32) + 2984);
        if (v19)
        {
          [(_UICollectionViewSubviewCollection *)*(v19 + 8) setView:v17 forDecorationOfKind:v9 atIndexPath:a2];
        }
      }
    }

    else if (v17)
    {
      v18 = *(*(a1 + 32) + 2984);
      if (v18)
      {
        [(_UICollectionViewSubviewCollection *)*(v18 + 8) setView:v17 forSupplementaryOfKind:v9 atIndexPath:a2];
      }
    }
  }

LABEL_28:
  v20 = *(a1 + 32);
  v21 = *(v20 + 2552);
  *(v20 + 2552) = 0;
}

uint64_t __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_9(uint64_t a1)
{
  v2 = *(a1 + 32);
  if ((v2[2721] & 0x20) != 0)
  {
    v3 = [v2 _delegateProxy];
    v4 = [v3 _collectionView:*(a1 + 32) shouldApplyTransitionContentOffset:*(a1 + 104) contentSize:{*(a1 + 112), *(a1 + 120), *(a1 + 128)}];

    if (!v4)
    {
      goto LABEL_5;
    }

    v2 = *(a1 + 32);
  }

  [v2 setContentOffset:{*(a1 + 104), *(a1 + 112)}];
  [*(a1 + 32) setContentSize:{*(a1 + 120), *(a1 + 128)}];
LABEL_5:
  if (*(a1 + 136) == 1)
  {
    [*(a1 + 32) _updateDefaultLayoutMargins];
  }

  if ([*(*(a1 + 32) + 2152) _supportsAdvancedTransitionAnimations] && objc_msgSend(*(a1 + 40), "_supportsAdvancedTransitionAnimations"))
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_10;
    aBlock[3] = &unk_1E70FF348;
    v5 = *(a1 + 40);
    aBlock[4] = *(a1 + 32);
    v32 = *(a1 + 137);
    v6 = &v31;
    v31 = v5;
    v7 = _Block_copy(aBlock);
    (*(v7 + 2))(v7, *(a1 + 48), 0, 0);
    v8 = *(a1 + 56);
    v28[0] = MEMORY[0x1E69E9820];
    v28[1] = 3221225472;
    v28[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_12;
    v28[3] = &unk_1E70FFCC0;
    v9 = &v29;
    v10 = v7;
    v29 = v10;
    [v8 enumerateKeysAndObjectsUsingBlock:v28];
    v11 = *(a1 + 64);
    v26[0] = MEMORY[0x1E69E9820];
    v26[1] = 3221225472;
    v26[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_13;
    v26[3] = &unk_1E70FFCC0;
    v12 = &v27;
    v27 = v10;
    v13 = v10;
    v14 = v26;
  }

  else
  {
    v24[0] = MEMORY[0x1E69E9820];
    v24[1] = 3221225472;
    v24[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_14;
    v24[3] = &unk_1E70FF398;
    v15 = *(a1 + 40);
    v24[4] = *(a1 + 32);
    v6 = &v25;
    v25 = v15;
    v16 = _Block_copy(v24);
    (*(v16 + 2))(v16, *(a1 + 48), 0, 0);
    v17 = *(a1 + 56);
    v22[0] = MEMORY[0x1E69E9820];
    v22[1] = 3221225472;
    v22[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_16;
    v22[3] = &unk_1E70FFCC0;
    v9 = &v23;
    v18 = v16;
    v23 = v18;
    [v17 enumerateKeysAndObjectsUsingBlock:v22];
    v11 = *(a1 + 64);
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_17;
    v20[3] = &unk_1E70FFCC0;
    v12 = &v21;
    v21 = v18;
    v13 = v18;
    v14 = v20;
  }

  [v11 enumerateKeysAndObjectsUsingBlock:v14];

  [*(a1 + 72) setAlpha:0.0];
  objc_storeStrong((*(a1 + 32) + 2152), *(a1 + 40));
  [*(*(a1 + 32) + 2960) cleanupSectionFocusGuides];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(*(a1 + 32) + 2952) reconfigureScrollViewsForUpdate:?];
  [*(a1 + 32) _reconfigureSectionContainersForUpdate:0];
  if (*(a1 + 138))
  {
    objc_storeStrong((*(*(a1 + 96) + 8) + 40), *(*(a1 + 32) + 2272));
  }

  objc_storeStrong((*(a1 + 32) + 2272), *(a1 + 80));
  objc_opt_class();
  result = objc_opt_isKindOfClass();
  if ((result & 1) == 0)
  {
    [*(a1 + 40) _finalizeLayoutTransition];
    return [*(a1 + 88) _finalizeLayoutTransition];
  }

  return result;
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_10(uint64_t a1, void *a2, uint64_t a3, void *a4)
{
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_11;
  v10[3] = &unk_1E70FF320;
  v13 = a3;
  v8 = *(a1 + 40);
  v10[4] = *(a1 + 32);
  v11 = v7;
  v14 = *(a1 + 48);
  v12 = v8;
  v9 = v7;
  [a2 enumerateKeysAndObjectsUsingBlock:v10];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_11(uint64_t a1, uint64_t a2, void *a3)
{
  v21 = *MEMORY[0x1E69E9840];
  v5 = *(a1 + 56);
  if (v5 == 2)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleDecorationOfKind:a2 atIndexPath:?];
  }

  else if (v5 == 1)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:a2 atIndexPath:?];
  }

  else
  {
    if (v5)
    {
      return;
    }

    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
  }

  v7 = v6;
  if (v6)
  {
    [v6 _addUpdateAnimation];
    [a3 setObject:v7 forKey:@"view"];
    v8 = [a3 objectForKeyedSubscript:@"previousLayoutInfos"];
    v9 = [a3 objectForKeyedSubscript:@"newLayoutInfos"];
    if (!v9)
    {
      v9 = [v8 copy];
      [v9 setAlpha:0.0];
    }

    if (*(a1 + 64) == 1)
    {
      LOBYTE(v15) = 1;
      v10 = [*(a1 + 32) _viewAnimationsForView:v7 startingLayoutAttributes:v8 endingLayoutAttributes:v9 startingLayout:*(*(a1 + 32) + 2152) endingLayout:*(a1 + 48) animationSetup:0 animationCompletion:0 enableCustomAnimations:v15 customAnimationsType:1];
      v16 = 0u;
      v17 = 0u;
      v18 = 0u;
      v19 = 0u;
      v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
      if (v11)
      {
        v12 = v11;
        v13 = *v17;
        do
        {
          for (i = 0; i != v12; ++i)
          {
            if (*v17 != v13)
            {
              objc_enumerationMutation(v10);
            }

            [*(*(&v16 + 1) + 8 * i) start];
          }

          v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        }

        while (v12);
      }
    }

    else if (v9)
    {
      [*(a1 + 32) _applyLayoutAttributes:v9 toView:v7];
    }
  }
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_14(uint64_t a1, void *a2, uint64_t a3, void *a4)
{
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_15;
  v10[3] = &unk_1E70FF370;
  v13 = a3;
  v8 = *(a1 + 40);
  v10[4] = *(a1 + 32);
  v11 = v7;
  v12 = v8;
  v9 = v7;
  [a2 enumerateKeysAndObjectsUsingBlock:v10];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_15(uint64_t a1, uint64_t a2, void *a3)
{
  v5 = *(a1 + 56);
  if (v5 == 2)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleDecorationOfKind:a2 atIndexPath:?];
    if (!v6)
    {
      return;
    }
  }

  else if (v5 == 1)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:a2 atIndexPath:?];
    if (!v6)
    {
      return;
    }
  }

  else
  {
    if (v5)
    {
      return;
    }

    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
    if (!v6)
    {
      return;
    }
  }

  v11 = v6;
  v7 = [a3 objectForKeyedSubscript:@"previousLayoutInfos"];
  v8 = [a3 objectForKeyedSubscript:@"newLayoutInfos"];
  if (!v8)
  {
    v8 = [v7 copy];
    [v8 setAlpha:0.0];
  }

  v9 = [*(a1 + 48) _animationForReusableView:v11 toLayoutAttributes:v8 type:1];
  v10 = [v9 copy];

  if (v10)
  {
    [v11 _setBaseLayoutAttributes:v8];
    v10[2](v10, 0);
    [v11 applyLayoutAttributes:v8];
  }

  else
  {
    [*(a1 + 32) _applyLayoutAttributes:v8 toView:v11];
  }

  [v11 _addUpdateAnimation];
  [a3 setObject:v11 forKey:@"view"];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_18(id *a1)
{
  v70 = *MEMORY[0x1E69E9840];
  v62[0] = MEMORY[0x1E69E9820];
  v62[1] = 3221225472;
  v62[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_19;
  v62[3] = &unk_1E70FF2F8;
  v2 = a1[4];
  v3 = a1[5];
  v4 = a1[4];
  v63 = v3;
  v64 = v4;
  [v2 _applyBlockToAllReusableViews:v62];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(a1[4] + 369) processQueuedScrollViewRemovals];
  [a1[4] _processQueuedSectionContainerRemovals];
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v5 = [a1[6] objectEnumerator];
  v6 = [v5 countByEnumeratingWithState:&v58 objects:v69 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v59;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v59 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = [*(*(&v58 + 1) + 8 * i) objectForKeyedSubscript:@"view"];
        [v10 _clearUpdateAnimation];
      }

      v7 = [v5 countByEnumeratingWithState:&v58 objects:v69 count:16];
    }

    while (v7);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v41 = a1;
  v11 = [a1[7] objectEnumerator];
  v12 = [v11 countByEnumeratingWithState:&v54 objects:v68 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v55;
    do
    {
      for (j = 0; j != v13; ++j)
      {
        if (*v55 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v54 + 1) + 8 * j);
        v50 = 0u;
        v51 = 0u;
        v52 = 0u;
        v53 = 0u;
        v17 = [v16 objectEnumerator];
        v18 = [v17 countByEnumeratingWithState:&v50 objects:v67 count:16];
        if (v18)
        {
          v19 = v18;
          v20 = *v51;
          do
          {
            for (k = 0; k != v19; ++k)
            {
              if (*v51 != v20)
              {
                objc_enumerationMutation(v17);
              }

              v22 = [*(*(&v50 + 1) + 8 * k) objectForKeyedSubscript:@"view"];
              [v22 _clearUpdateAnimation];
            }

            v19 = [v17 countByEnumeratingWithState:&v50 objects:v67 count:16];
          }

          while (v19);
        }
      }

      v13 = [v11 countByEnumeratingWithState:&v54 objects:v68 count:16];
    }

    while (v13);
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v23 = [v41[8] objectEnumerator];
  v24 = [v23 countByEnumeratingWithState:&v46 objects:v66 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v47;
    do
    {
      for (m = 0; m != v25; ++m)
      {
        if (*v47 != v26)
        {
          objc_enumerationMutation(v23);
        }

        v28 = *(*(&v46 + 1) + 8 * m);
        v42 = 0u;
        v43 = 0u;
        v44 = 0u;
        v45 = 0u;
        v29 = [v28 objectEnumerator];
        v30 = [v29 countByEnumeratingWithState:&v42 objects:v65 count:16];
        if (v30)
        {
          v31 = v30;
          v32 = *v43;
          do
          {
            for (n = 0; n != v31; ++n)
            {
              if (*v43 != v32)
              {
                objc_enumerationMutation(v29);
              }

              v34 = [*(*(&v42 + 1) + 8 * n) objectForKeyedSubscript:@"view"];
              [v34 _clearUpdateAnimation];
            }

            v31 = [v29 countByEnumeratingWithState:&v42 objects:v65 count:16];
          }

          while (v31);
        }
      }

      v25 = [v23 countByEnumeratingWithState:&v46 objects:v66 count:16];
    }

    while (v25);
  }

  *(v41[4] + 341) &= ~0x20000000uLL;
  [v41[4] _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v35 = v41[4];
  v36 = v35[415];
  if (v36)
  {
    v37 = (*(v36 + 16))(v35[415]);
    [v41[4] _setNavigationCompletion:0];
    if ((v37 & 1) == 0)
    {
      objc_storeStrong(v41[4] + 269, v41[5]);
      objc_storeStrong(v41[4] + 284, *(*(v41[12] + 1) + 40));
      [*(v41[4] + 269) _didFinishLayoutTransitionAnimations:0];
      v38 = v41[11];
      if (v38)
      {
        v38[2](v38, 0);
      }

      [v41[4] layoutIfNeeded];
      goto LABEL_48;
    }
  }

  else
  {
    [v35 _setNavigationCompletion:0];
  }

  v39 = *(v41[4] + 269);
  if (v41[5] != v39)
  {
    [v41[5] _setCollectionView:0];
    v39 = *(v41[4] + 269);
  }

  [v39 _didFinishLayoutTransitionAnimations:1];
  v40 = v41[11];
  if (v40)
  {
    v40[2](v40, 1);
  }

  if (*(v41 + 104) == 1)
  {
    [*(v41[4] + 269) _invalidateLayoutUsingContext:v41[9]];
  }

LABEL_48:
  [v41[10] removeFromSuperview];
}

- (UICollectionViewTransitionLayout)startInteractiveTransitionToCollectionViewLayout:(UICollectionViewLayout *)layout completion:(UICollectionViewLayoutInteractiveTransitionCompletion)completion
{
  v8 = layout;
  v9 = completion;
  if (!v8)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7586 description:@"layout cannot be nil in startInteractiveTransitionToCollectionViewLayout:"];
  }

  if (self->_isInInteractiveTransition)
  {
    currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7589 description:@"the collection is already in the middle of an interactive transition"];
  }

  v11 = [v9 copy];
  interactiveCompletionHandler = self->_interactiveCompletionHandler;
  self->_interactiveCompletionHandler = v11;

  if ((*(&self->_collectionViewFlags + 12) & 4) != 0)
  {
    _delegateActual = [(UICollectionView *)self _delegateActual];
    if (objc_opt_respondsToSelector())
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
      v15 = [_delegateProxy collectionView:self transitionLayoutForOldLayout:collectionViewLayout newLayout:v8];
    }

    else
    {
      v19 = [UICollectionViewTransitionLayout alloc];
      _delegateProxy = [(UICollectionView *)self collectionViewLayout];
      v15 = [(UICollectionViewTransitionLayout *)v19 initWithCurrentLayout:_delegateProxy nextLayout:v8];
    }

    [(UICollectionView *)self setCollectionViewLayout:v15];
    self->_isInInteractiveTransition = 1;
    self->_shouldAccumulateTrackedLayoutValues = 1;
  }

  else
  {
    [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
    objc_storeStrong(&self->_layout, layout);
    [(UICollectionViewLayout *)self->_layout _setCollectionView:self];
    v13 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
    collectionViewData = self->_collectionViewData;
    self->_collectionViewData = v13;

    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    v15 = 0;
  }

  return v15;
}

- (void)_updateTransitionWithProgress:(double)progress
{
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  [(UICollectionViewData *)self->_collectionViewData invalidate:?];
  [collectionViewLayout setTransitionProgress:progress];
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
}

- (void)_cleanUpAfterInteractiveTransitionDidFinish:(BOOL)finish
{
  finishCopy = finish;
  v49 = *MEMORY[0x1E69E9840];
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  currentLayout = [collectionViewLayout currentLayout];
  nextLayout = [collectionViewLayout nextLayout];
  [collectionViewLayout _oldVisibleBounds];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  [collectionViewLayout _newVisibleBounds];
  if (finishCopy)
  {
    v9 = v16;
    v11 = v17;
    v13 = v18;
    v15 = v19;
  }

  v38 = currentLayout;
  if (finishCopy)
  {
    v20 = nextLayout;
  }

  else
  {
    v20 = currentLayout;
  }

  [(UICollectionView *)self setCollectionViewLayout:v20];
  [(UICollectionView *)self setBounds:v9, v11, v13, v15];
  *(&self->_collectionViewFlags + 1) &= ~0x20000000uLL;
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  interactiveCompletionHandler = self->_interactiveCompletionHandler;
  if (interactiveCompletionHandler)
  {
    interactiveCompletionHandler[2](interactiveCompletionHandler, 1, finishCopy);
    v22 = self->_interactiveCompletionHandler;
    self->_interactiveCompletionHandler = 0;
  }

  trackedValuesKeys = self->_trackedValuesKeys;
  self->_trackedValuesKeys = 0;

  interactiveTransitionValueTrackingDict = self->_interactiveTransitionValueTrackingDict;
  self->_interactiveTransitionValueTrackingDict = 0;

  self->_shouldAccumulateTrackedLayoutValues = 1;
  __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(self->_clonedCellsDict);
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  objectEnumerator = [(NSMutableDictionary *)self->_clonedSupplementaryViewsDict objectEnumerator];
  v26 = [objectEnumerator countByEnumeratingWithState:&v43 objects:v48 count:16];
  if (v26)
  {
    v27 = v26;
    v28 = *v44;
    do
    {
      for (i = 0; i != v27; ++i)
      {
        if (*v44 != v28)
        {
          objc_enumerationMutation(objectEnumerator);
        }

        __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(*(*(&v43 + 1) + 8 * i));
      }

      v27 = [objectEnumerator countByEnumeratingWithState:&v43 objects:v48 count:16];
    }

    while (v27);
  }

  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  objectEnumerator2 = [(NSMutableDictionary *)self->_clonedDecorationViewsDict objectEnumerator];
  v31 = [objectEnumerator2 countByEnumeratingWithState:&v39 objects:v47 count:16];
  if (v31)
  {
    v32 = v31;
    v33 = *v40;
    do
    {
      for (j = 0; j != v32; ++j)
      {
        if (*v40 != v33)
        {
          objc_enumerationMutation(objectEnumerator2);
        }

        __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(*(*(&v39 + 1) + 8 * j));
      }

      v32 = [objectEnumerator2 countByEnumeratingWithState:&v39 objects:v47 count:16];
    }

    while (v32);
  }

  clonedCellsDict = self->_clonedCellsDict;
  self->_clonedCellsDict = 0;

  clonedSupplementaryViewsDict = self->_clonedSupplementaryViewsDict;
  self->_clonedSupplementaryViewsDict = 0;

  clonedDecorationViewsDict = self->_clonedDecorationViewsDict;
  self->_clonedDecorationViewsDict = 0;
}

void __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(void *a1)
{
  v11 = *MEMORY[0x1E69E9840];
  v6 = 0u;
  v7 = 0u;
  v8 = 0u;
  v9 = 0u;
  v1 = [a1 objectEnumerator];
  v2 = [v1 countByEnumeratingWithState:&v6 objects:v10 count:16];
  if (v2)
  {
    v3 = v2;
    v4 = *v7;
    do
    {
      v5 = 0;
      do
      {
        if (*v7 != v4)
        {
          objc_enumerationMutation(v1);
        }

        [*(*(&v6 + 1) + 8 * v5++) removeFromSuperview];
      }

      while (v3 != v5);
      v3 = [v1 countByEnumeratingWithState:&v6 objects:v10 count:16];
    }

    while (v3);
  }
}

- (void)_finishInteractiveTransitionShouldFinish:(BOOL)finish finalAnimation:(BOOL)animation
{
  finishCopy = finish;
  v34 = *MEMORY[0x1E69E9840];
  if (!self->_isInInteractiveTransition)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7682 description:@"the collection was not prepared for an interactive transition. see startInteractiveTransitionToCollectionViewLayout:completion:"];
  }

  self->_shouldAccumulateTrackedLayoutValues = 0;
  currentInteractiveTransitionTimeStamp = self->_currentInteractiveTransitionTimeStamp;
  previousInteractiveTransitionTimeStamp = self->_previousInteractiveTransitionTimeStamp;
  if (currentInteractiveTransitionTimeStamp == previousInteractiveTransitionTimeStamp)
  {
    v9 = 0.0;
    if (animation)
    {
      goto LABEL_5;
    }
  }

  else
  {
    v9 = (self->_currentInteractiveTransitionProgress - self->_previousInteractiveTransitionProgress) / (currentInteractiveTransitionTimeStamp - previousInteractiveTransitionTimeStamp);
    if (animation)
    {
LABEL_5:
      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke;
      aBlock[3] = &unk_1E70FFAF8;
      aBlock[4] = self;
      v25 = _Block_copy(aBlock);
      v30[0] = MEMORY[0x1E69E9820];
      v30[1] = 3221225472;
      v30[2] = __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke_2;
      v30[3] = &unk_1E70FA0F0;
      v30[4] = self;
      v31 = finishCopy;
      v24 = _Block_copy(v30);
      if (finishCopy)
      {
        v10 = 1.0;
      }

      else
      {
        v10 = 0.0;
      }

      v11 = [[_UIDynamicValueAnimation alloc] initWithValue:self->_currentInteractiveTransitionProgress velocity:v9 unitSize:0.004];
      v12 = [_UIDynamicAnimationActiveValue upperBoundary:1 ofType:v10];
      v13 = [_UIDynamicAnimationActiveValue lowerBoundary:1 ofType:v10];
      [(_UIDynamicValueAnimation *)v11 addActiveValue:v12];
      [(_UIDynamicValueAnimation *)v11 addActiveValue:v13];
      v14 = objc_alloc_init(_UIDynamicAnimationGroup);
      endInteractiveTransitionAnimationGroup = self->_endInteractiveTransitionAnimationGroup;
      self->_endInteractiveTransitionAnimationGroup = v14;

      [(_UIDynamicAnimation *)self->_endInteractiveTransitionAnimationGroup _setUsesNSTimer:1];
      [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup addAnimation:v11];
      _dynamicAnimationsForTrackValues = [(UICollectionView *)self _dynamicAnimationsForTrackValues];
      v26 = 0u;
      v27 = 0u;
      v28 = 0u;
      v29 = 0u;
      v17 = [_dynamicAnimationsForTrackValues countByEnumeratingWithState:&v26 objects:v33 count:16];
      if (v17)
      {
        v18 = v17;
        v19 = *v27;
        do
        {
          for (i = 0; i != v18; ++i)
          {
            if (*v27 != v19)
            {
              objc_enumerationMutation(_dynamicAnimationsForTrackValues);
            }

            [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup addAnimation:*(*(&v26 + 1) + 8 * i), v24];
          }

          v18 = [_dynamicAnimationsForTrackValues countByEnumeratingWithState:&v26 objects:v33 count:16];
        }

        while (v18);
      }

      v21 = v24;
      [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup runWithGroupApplier:v25 completion:v24, v24];
      self->_isInInteractiveTransition = 0;

      return;
    }
  }

  self->_isInInteractiveTransition = 0;

  [(UICollectionView *)self _cleanUpAfterInteractiveTransitionDidFinish:finishCopy];
}

void __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke(uint64_t a1, int a2)
{
  if ((a2 - 1) <= 1)
  {
    v3 = [*(*(a1 + 32) + 2616) animations];
    v4 = [v3 objectAtIndex:0];
    [v4 value];
    v6 = v5;

    [*(a1 + 32) _updateTransitionWithProgress:v6];
    v7 = [*(*(a1 + 32) + 2616) animations];
    v8 = [v7 count];

    if (v8 >= 2)
    {
      v9 = [*(*(a1 + 32) + 2616) animations];
      v10 = [v9 mutableCopy];

      [v10 removeObjectAtIndex:0];
      [*(a1 + 32) _updateTrackedLayoutValuesWith:v10];
    }
  }
}

void __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) _cleanUpAfterInteractiveTransitionDidFinish:*(a1 + 40)];
  v2 = *(a1 + 32);
  v3 = *(v2 + 2616);
  *(v2 + 2616) = 0;
}

- (id)_pivotForTransitionFromLayout:(id)layout toLayout:(id)toLayout
{
  if ((*(&self->_collectionViewFlags + 1) & 0x10) != 0)
  {
    v6 = [(UICollectionView *)self _delegateProxy:layout];
    v4 = [v6 _indexPathOfReferenceItemForLayoutTransitionInCollectionView:self];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (NSInteger)numberOfItemsInSection:(NSInteger)section
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  collectionViewData = self->_collectionViewData;

  return [(UICollectionViewData *)collectionViewData numberOfItemsInSection:?];
}

- (UICollectionViewLayoutAttributes)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
    if (v5)
    {
      v8 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v5];
      v6 = [v8 copy];

      if (v6)
      {
        [v6 setIndexPath:indexPath];
      }
    }

    else
    {
      v6 = 0;
    }
  }

  else
  {
    v5 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:?];
    v6 = [v5 copy];
  }

  return v6;
}

- (UICollectionViewLayoutAttributes)layoutAttributesForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath
{
  v6 = kind;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForSupplementaryElementOfKind:v6 atIndexPath:indexPath];

  v8 = [v7 copy];

  return v8;
}

- (NSIndexPath)indexPathForItemAtPoint:(CGPoint)point
{
  v4 = [(UICollectionView *)self _indexPathForItemAtPoint:point.x, point.y];
  if (dyld_program_sdk_at_least())
  {
    dragAndDropController = self->_dragAndDropController;
    if (!dragAndDropController || dragAndDropController->_sessionKind != 1)
    {
      v6 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v4];

      v4 = v6;
    }
  }

  return v4;
}

- (id)_indexPathForItemAtPoint:(CGPoint)point
{
  y = point.y;
  x = point.x;
  v22 = *MEMORY[0x1E69E9840];
  [(UICollectionView *)self _reloadDataIfNeeded];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v6 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:x validateLayout:y, 1.0, 1.0];
  v7 = [v6 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = 0;
    v10 = *v18;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v18 != v10)
        {
          objc_enumerationMutation(v6);
        }

        v12 = *(*(&v17 + 1) + 8 * i);
        if (v9)
        {
          zIndex = [*(*(&v17 + 1) + 8 * i) zIndex];
          if (zIndex <= [v9 zIndex])
          {
            continue;
          }
        }

        v14 = v12;

        v9 = v14;
      }

      v8 = [v6 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v8);
  }

  else
  {
    v9 = 0;
  }

  indexPath = [v9 indexPath];

  return indexPath;
}

- (id)_indexPathForView:(id)view ofType:(unint64_t)type
{
  viewCopy = view;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v30 = 0;
  v31 = &v30;
  v32 = 0x3032000000;
  v33 = __Block_byref_object_copy__39;
  v34 = __Block_byref_object_dispose__39;
  v35 = 0;
  subviewManager = self->_subviewManager;
  if (type == 1)
  {
    _layoutAttributes = [viewCopy _layoutAttributes];
    _content = [(_UILabelConfiguration *)_layoutAttributes _content];
    v15 = v24;
    v24[0] = MEMORY[0x1E69E9820];
    v24[1] = 3221225472;
    v24[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_3;
    v24[3] = &unk_1E70FF438;
    v24[4] = viewCopy;
    v24[5] = &v30;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateSupplementariesOfElementKind:_content enumerator:v24];
    }

    goto LABEL_15;
  }

  if (type)
  {
    _layoutAttributes = [viewCopy _layoutAttributes];
    _content = [(_UILabelConfiguration *)_layoutAttributes _content];
    v15 = v23;
    v23[0] = MEMORY[0x1E69E9820];
    v23[1] = 3221225472;
    v23[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_4;
    v23[3] = &unk_1E70FF438;
    v23[4] = viewCopy;
    v23[5] = &v30;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateDecorationsOfElementKind:_content enumerator:v23];
    }

LABEL_15:
    v10 = (v15 + 4);

    goto LABEL_16;
  }

  v28[0] = MEMORY[0x1E69E9820];
  v28[1] = 3221225472;
  v28[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke;
  v28[3] = &unk_1E70FFC20;
  v8 = viewCopy;
  v29[0] = v8;
  v29[1] = &v30;
  if (!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v28], !v31[5]))
  {
    if (dyld_program_sdk_at_least())
    {
      prefetchCacheItems = self->_prefetchCacheItems;
      v25[0] = MEMORY[0x1E69E9820];
      v25[1] = 3221225472;
      v25[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_2;
      v25[3] = &unk_1E70FF410;
      v26 = v8;
      v27 = &v30;
      [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v25];
    }
  }

  v10 = v29;
  v11 = v31;
  if (!v31[5] && self->_firstResponderViewType == 1 && self->_firstResponderView == v8)
  {
    v12 = self->_firstResponderIndexPath;
    _layoutAttributes = v11[5];
    v11[5] = v12;
LABEL_16:
  }

  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v17 = _focusedItemState;
  if (!v31[5])
  {
    v18 = _focusedItemState ? *(_focusedItemState + 8) : 0;
    v19 = v18;

    if (v19 == viewCopy)
    {
      if (v17)
      {
        v20 = v17[2];
      }

      else
      {
        v20 = 0;
      }

      objc_storeStrong(v31 + 5, v20);
    }
  }

  v21 = v31[5];

  _Block_object_dispose(&v30, 8);

  return v21;
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_2(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v11 = a2;
  if (a3)
  {
    v8 = *(a3 + 24);
  }

  else
  {
    v8 = 0;
  }

  v9 = v8;
  v10 = *(a1 + 32);

  if (v9 == v10)
  {
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_3(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_4(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

- (NSIndexPath)indexPathForCell:(UICollectionViewCell *)cell
{
  v4 = [(UICollectionView *)self _indexPathForView:cell ofType:0];
  v5 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v4];

  return v5;
}

- (id)indexPathForSupplementaryView:(id)view
{
  viewCopy = view;
  _layoutAttributes = [viewCopy _layoutAttributes];
  v6 = _layoutAttributes;
  if (_layoutAttributes)
  {
    v7 = *(_layoutAttributes + 288);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }
  }

  else
  {
    v9 = 0;
  }

  v10 = [(UICollectionView *)self _indexPathForView:viewCopy ofType:v9];

  if (v10)
  {
    v11 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v10];
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (id)_indexPathForSupplementaryView:(id)view
{
  viewCopy = view;
  _layoutAttributes = [viewCopy _layoutAttributes];
  v6 = _layoutAttributes;
  if (_layoutAttributes)
  {
    v7 = *(_layoutAttributes + 288);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }
  }

  else
  {
    v9 = 0;
  }

  v10 = [(UICollectionView *)self _indexPathForView:viewCopy ofType:v9];

  return v10;
}

- (UICollectionViewCell)cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
  v4 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:v4];

  return v5;
}

- (id)_cellForItemAtIndexPath:(id)path
{
  pathCopy = path;
  if (!pathCopy)
  {
    v8 = 0;
    goto LABEL_19;
  }

  [(UICollectionView *)self _reloadDataIfNeeded];
  v5 = &OBJC_IVAR___UICollectionView__collectionViewData;
  currentUpdate = self->_currentUpdate;
  if (currentUpdate)
  {
    v5 = &OBJC_IVAR___UICollectionViewUpdate__oldModel;
  }

  else
  {
    currentUpdate = self;
  }

  v7 = *&currentUpdate[*v5];
  if ([(UICollectionViewData *)v7 validatedGlobalIndexForItemAtIndexPath:pathCopy]!= 0x7FFFFFFFFFFFFFFFLL)
  {
    if ([(UICollectionView *)self _hasFocusedCellForIndexPath:pathCopy shouldUsePreUpdateData:1])
    {
      _focusedItemState = [(UICollectionView *)self _focusedItemState];
      cell = [(_UICollectionViewFocusedItemState *)_focusedItemState cell];
    }

    else
    {
      firstResponderIndexPath = self->_firstResponderIndexPath;
      if (firstResponderIndexPath && self->_firstResponderViewType == 1 && [(NSIndexPath *)firstResponderIndexPath isEqual:pathCopy]&& dyld_program_sdk_at_least())
      {
        v8 = self->_firstResponderView;
        goto LABEL_18;
      }

      v8 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:pathCopy];
      if (v8)
      {
        goto LABEL_18;
      }

      if (!dyld_program_sdk_at_least())
      {
        goto LABEL_6;
      }

      v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:pathCopy];
      _focusedItemState = v13;
      if (!v13 || (v14 = *(v13 + 16)) == 0 || (v15 = v14[72], v14, (v15 & 1) == 0))
      {
        v8 = 0;
        goto LABEL_11;
      }

      cell = *(_focusedItemState + 24);
    }

    v8 = cell;
LABEL_11:

    goto LABEL_18;
  }

LABEL_6:
  v8 = 0;
LABEL_18:

LABEL_19:

  return v8;
}

- (id)_indexPathsForPreparedItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  v3 = objc_opt_new();
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v4 = ![(UICollectionView *)self _isOperatingWithPresentationValues];
  }

  else
  {
    v4 = 0;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __47__UICollectionView__indexPathsForPreparedItems__block_invoke;
  aBlock[3] = &unk_1E70FF460;
  v19 = v4;
  aBlock[4] = self;
  v5 = v3;
  v18 = v5;
  v6 = _Block_copy(aBlock);
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v6];
  }

  [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v6];
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v9 = _focusedItemState;
  if (_focusedItemState)
  {
    v10 = *(_focusedItemState + 8);
    if (v10)
    {
      v11 = *(v9 + 32);

      if (!v11)
      {
        v16 = 0;
        v12 = *(v9 + 16);
        v6[2](v6, v12, 0, &v16);
      }
    }
  }

  v13 = self->_firstResponderIndexPath;
  if (v13 && self->_firstResponderView && self->_firstResponderViewType == 1)
  {
    v16 = 0;
    v6[2](v6, v13, 0, &v16);
  }

  array = [v5 array];

  return array;
}

void __47__UICollectionView__indexPathsForPreparedItems__block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if ((*(a1 + 48) & 1) == 0)
  {
    v5 = v3;
    v4 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:v3];

    v3 = v4;
  }

  if (v3)
  {
    v6 = v3;
    [*(a1 + 40) addObject:v3];
    v3 = v6;
  }
}

- (id)_visibleSupplementaryViewsOfKind:(id)kind isDecorationView:(BOOL)view
{
  kindCopy = kind;
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;
  if (view)
  {
    [(_UICollectionViewSubviewManager *)subviewManager visibleDecorationsOfKind:kindCopy];
  }

  else
  {
    [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementariesOfKind:kindCopy];
  }
  v8 = ;

  return v8;
}

- (id)_indexPathsForVisibleSupplementaryViewsOfKind:(id)kind isDecorationView:(BOOL)view
{
  kindCopy = kind;
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;
  if (view)
  {
    [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleDecorationsOfKind:kindCopy];
  }

  else
  {
    [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleSupplementariesOfKind:kindCopy];
  }
  v8 = ;

  return v8;
}

- (BOOL)_validateScrollingTargetIndexPath:(id)path raisingExceptionIfNecessary:(BOOL)necessary
{
  necessaryCopy = necessary;
  v40 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  section = [pathCopy section];
  if (section >= [(UICollectionViewData *)self->_collectionViewData numberOfSections])
  {
    if (!necessaryCopy)
    {
LABEL_22:
      v9 = 0;
      goto LABEL_23;
    }

    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8188 description:{@"Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@.", objc_msgSend(pathCopy, "section"), -[UICollectionViewData numberOfSections](self->_collectionViewData), self, v31}];
LABEL_13:

      goto LABEL_22;
    }

    if (!os_variant_has_internal_diagnostics())
    {
      v13 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924A0) + 8);
      if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_22;
      }

      v14 = v13;
      section2 = [pathCopy section];
      numberOfSections = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
      *buf = 134218498;
      v33 = section2;
      v34 = 2048;
      v35 = numberOfSections;
      v36 = 2112;
      selfCopy2 = self;
      v17 = "Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
      v18 = v14;
      v19 = 32;
      goto LABEL_20;
    }

    v14 = __UIFaultDebugAssertLog();
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_FAULT))
    {
      goto LABEL_21;
    }

    section3 = [pathCopy section];
    numberOfSections2 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
    *buf = 134218498;
    v33 = section3;
    v34 = 2048;
    v35 = numberOfSections2;
    v36 = 2112;
    selfCopy2 = self;
    v26 = "Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
    v27 = v14;
    v28 = 32;
LABEL_28:
    _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, v26, buf, v28);
    goto LABEL_21;
  }

  if ([pathCopy item] == 0x7FFFFFFFFFFFFFFFLL)
  {
    v9 = 1;
    goto LABEL_23;
  }

  item = [pathCopy item];
  v9 = item < -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
  if (!v9 && necessaryCopy)
  {
    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8201 description:{@"Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@.", objc_msgSend(pathCopy, "item"), -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, objc_msgSend(pathCopy, "section")), objc_msgSend(pathCopy, "section"), self}];
      goto LABEL_13;
    }

    if (!os_variant_has_internal_diagnostics())
    {
      v20 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924A8) + 8);
      if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_22;
      }

      v14 = v20;
      item2 = [pathCopy item];
      v22 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
      *buf = 134218754;
      v33 = item2;
      v34 = 2048;
      v35 = v22;
      v36 = 2048;
      selfCopy2 = [pathCopy section];
      v38 = 2112;
      selfCopy4 = self;
      v17 = "Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
      v18 = v14;
      v19 = 42;
LABEL_20:
      _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, v17, buf, v19);
LABEL_21:

      goto LABEL_22;
    }

    v14 = __UIFaultDebugAssertLog();
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_FAULT))
    {
      goto LABEL_21;
    }

    item3 = [pathCopy item];
    v30 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
    *buf = 134218754;
    v33 = item3;
    v34 = 2048;
    v35 = v30;
    v36 = 2048;
    selfCopy2 = [pathCopy section];
    v38 = 2112;
    selfCopy4 = self;
    v26 = "Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
    v27 = v14;
    v28 = 42;
    goto LABEL_28;
  }

LABEL_23:

  return v9;
}

- (BOOL)_validateSelectionOrHighlightIndexPath:(id)path isSelection:(BOOL)selection allowMassIndexPath:(BOOL)indexPath assertIfInvalid:(BOOL)invalid
{
  invalidCopy = invalid;
  selectionCopy = selection;
  v52 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  if (dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _reloadDataIfNeeded];
  }

  if (pathCopy && [pathCopy section] != 0x7FFFFFFFFFFFFFFFLL && objc_msgSend(pathCopy, "item") != 0x7FFFFFFFFFFFFFFFLL)
  {
    section = [pathCopy section];
    if (section >= [(UICollectionViewData *)self->_collectionViewData numberOfSections])
    {
      if (!invalidCopy)
      {
LABEL_17:
        indexPath = 0;
        goto LABEL_18;
      }

      _UIIsPrivateMainBundle();
      if (dyld_program_sdk_at_least())
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        if (selectionCopy)
        {
          v18 = @"selection";
        }

        else
        {
          v18 = @"highlight";
        }

        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8228 description:{@"Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@.", v18, objc_msgSend(pathCopy, "section"), -[UICollectionViewData numberOfSections](self->_collectionViewData), self, v41}];
        goto LABEL_24;
      }

      if (!os_variant_has_internal_diagnostics())
      {
        v19 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924B0) + 8);
        if (!os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_17;
        }

        if (selectionCopy)
        {
          v20 = @"selection";
        }

        else
        {
          v20 = @"highlight";
        }

        v21 = v19;
        section2 = [pathCopy section];
        numberOfSections = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
        *buf = 138413058;
        v43 = v20;
        v44 = 2048;
        v45 = section2;
        v46 = 2048;
        v47 = numberOfSections;
        v48 = 2112;
        selfCopy2 = self;
        v24 = "Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
        v25 = v21;
        v26 = 42;
LABEL_37:
        _os_log_impl(&dword_188A29000, v25, OS_LOG_TYPE_ERROR, v24, buf, v26);

        goto LABEL_17;
      }

      v31 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v31, OS_LOG_TYPE_FAULT))
      {
LABEL_44:

        goto LABEL_17;
      }

      if (selectionCopy)
      {
        v32 = @"selection";
      }

      else
      {
        v32 = @"highlight";
      }

      section3 = [pathCopy section];
      numberOfSections2 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
      *buf = 138413058;
      v43 = v32;
      v44 = 2048;
      v45 = section3;
      v46 = 2048;
      v47 = numberOfSections2;
      v48 = 2112;
      selfCopy2 = self;
      v35 = "Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
      v36 = v31;
      v37 = 42;
LABEL_49:
      _os_log_fault_impl(&dword_188A29000, v36, OS_LOG_TYPE_FAULT, v35, buf, v37);
      goto LABEL_44;
    }

    item = [pathCopy item];
    indexPath = item < -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
    if (!indexPath && invalidCopy)
    {
      _UIIsPrivateMainBundle();
      if (dyld_program_sdk_at_least())
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        if (selectionCopy)
        {
          v16 = @"selection";
        }

        else
        {
          v16 = @"highlight";
        }

        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8236 description:{@"Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@.", v16, objc_msgSend(pathCopy, "item"), -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, objc_msgSend(pathCopy, "section")), objc_msgSend(pathCopy, "section"), self}];
LABEL_24:

        goto LABEL_17;
      }

      if (!os_variant_has_internal_diagnostics())
      {
        v27 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924B8) + 8);
        if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_17;
        }

        if (selectionCopy)
        {
          v28 = @"selection";
        }

        else
        {
          v28 = @"highlight";
        }

        v21 = v27;
        item2 = [pathCopy item];
        v30 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
        *buf = 138413314;
        v43 = v28;
        v44 = 2048;
        v45 = item2;
        v46 = 2048;
        v47 = v30;
        v48 = 2048;
        selfCopy2 = [pathCopy section];
        v50 = 2112;
        selfCopy4 = self;
        v24 = "Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
        v25 = v21;
        v26 = 52;
        goto LABEL_37;
      }

      v31 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v31, OS_LOG_TYPE_FAULT))
      {
        goto LABEL_44;
      }

      if (selectionCopy)
      {
        v38 = @"selection";
      }

      else
      {
        v38 = @"highlight";
      }

      item3 = [pathCopy item];
      v40 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [pathCopy section]);
      *buf = 138413314;
      v43 = v38;
      v44 = 2048;
      v45 = item3;
      v46 = 2048;
      v47 = v40;
      v48 = 2048;
      selfCopy2 = [pathCopy section];
      v50 = 2112;
      selfCopy4 = self;
      v35 = "Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
      v36 = v31;
      v37 = 52;
      goto LABEL_49;
    }
  }

LABEL_18:

  return indexPath;
}

- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets
{
  trailing = insets.trailing;
  bottom = insets.bottom;
  leading = insets.leading;
  top = insets.top;
  v29 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  if ([(UICollectionView *)self _validateScrollingTargetIndexPath:pathCopy raisingExceptionIfNecessary:1])
  {
    v31.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:pathCopy];
    x = v31.origin.x;
    y = v31.origin.y;
    width = v31.size.width;
    height = v31.size.height;
    if (!CGRectIsNull(v31))
    {
      [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:pathCopy atScrollPosition:position additionalInsets:self itemFrame:1 containingScrollView:top clampToScrollableArea:leading, bottom, trailing, x, y, width, height];
      goto LABEL_7;
    }

    v16 = *(__UILogGetCategoryCachedImpl("UICollectionView", &_contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets____s_category) + 8);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v17 = v16;
      _ui_shortDescription = [pathCopy _ui_shortDescription];
      v25 = 138412546;
      v26 = _ui_shortDescription;
      v27 = 2112;
      selfCopy = self;
      _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, "UICollectionView asked to scroll to invalid index path: %@ for which it cannot calculate a target content offset. Ensure your index path is valid. If this is a section index path, your section must have at least one item. Collection view: %@", &v25, 0x16u);
    }
  }

  [(UIScrollView *)self contentOffset];
LABEL_7:
  v21 = v19;
  v22 = v20;

  v23 = v21;
  v24 = v22;
  result.y = v24;
  result.x = v23;
  return result;
}

- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets itemFrame:(CGRect)frame containingScrollView:(id)view clampToScrollableArea:(BOOL)area
{
  areaCopy = area;
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  trailing = insets.trailing;
  bottom = insets.bottom;
  leading = insets.leading;
  top = insets.top;
  pathCopy = path;
  viewCopy = view;
  if (dyld_program_sdk_at_least() && [(UIScrollView *)viewCopy isPagingEnabled])
  {
    [(UIScrollView *)viewCopy _interpageSpacing];
    if (v22 == *MEMORY[0x1E695F060] && v21 == *(MEMORY[0x1E695F060] + 8))
    {
      [(UIScrollView *)viewCopy _pagingOrigin];
      if (v25 == *MEMORY[0x1E695EFF8] && v24 == *(MEMORY[0x1E695EFF8] + 8))
      {
        [(UIScrollView *)viewCopy _firstPageOffset];
        if (v76 == 0.0 && v75 == 0.0)
        {
          [(UIScrollView *)viewCopy _rectForPageContainingRect:x, y, width, height];
LABEL_76:
          v61 = v77;
          v63 = v78;
          goto LABEL_77;
        }
      }
    }
  }

  [(UIView *)viewCopy bounds];
  v97 = v27;
  v98 = v28;
  v94 = v29;
  v99 = v30;
  [(UIScrollView *)viewCopy _effectiveContentInset];
  v35 = 0.0;
  if (v31 >= 0.0)
  {
    v36 = v31;
  }

  else
  {
    v36 = 0.0;
  }

  if (v32 >= 0.0)
  {
    v37 = v32;
  }

  else
  {
    v37 = 0.0;
  }

  if (v33 >= 0.0)
  {
    v38 = v33;
  }

  else
  {
    v38 = 0.0;
  }

  v95 = v38;
  v96 = v36;
  if (v34 >= 0.0)
  {
    v39 = v34;
  }

  else
  {
    v39 = 0.0;
  }

  v93 = v39;
  [(UICollectionViewLayout *)self->_layout _supplementaryViewInsetsForScrollingToItemAtIndexPath:pathCopy];
  v40 = bottom;
  v42 = top + v41;
  v44 = leading + v43;
  v46 = v40 + v45;
  v48 = trailing + v47;
  _contentScrollableAxes = [(UIScrollView *)viewCopy _contentScrollableAxes];
  if (_contentScrollableAxes == 2)
  {
    v50 = 0.0;
  }

  else
  {
    v50 = v48;
  }

  if (_contentScrollableAxes == 2)
  {
    v51 = 0.0;
  }

  else
  {
    v51 = v44;
  }

  if (_contentScrollableAxes == 1)
  {
    v50 = v48;
    v52 = 0.0;
  }

  else
  {
    v52 = v46;
  }

  if (_contentScrollableAxes == 1)
  {
    v51 = v44;
    v53 = 0.0;
  }

  else
  {
    v53 = v42;
  }

  if (_contentScrollableAxes)
  {
    v54 = v50;
  }

  else
  {
    v54 = 0.0;
  }

  if (_contentScrollableAxes)
  {
    v55 = v52;
  }

  else
  {
    v55 = 0.0;
  }

  if (_contentScrollableAxes)
  {
    v56 = v51;
  }

  else
  {
    v56 = 0.0;
  }

  if (_contentScrollableAxes)
  {
    v35 = v53;
  }

  v57 = [(UIScrollView *)viewCopy _contentInsetAdjustmentBehavior:v50];
  [(UICollectionView *)self _contentOffsetFromProposedOffset:position forScrollingToItemWithFrame:*&v35 atScrollPosition:*&v56 additionalInsets:*&v55 containingScrollViewBounds:*&v54, v97 + v37, v94 + v96, v98 - (v37 + v93), v99 - (v96 + v95)];
  [(UICollectionViewLayout *)self->_layout _contentOffsetFromProposedContentOffset:pathCopy forScrollingToItemAtIndexPath:position atScrollPosition:v58 - v37, v59 - v96];
  v61 = v60;
  v63 = v62;
  if (v57 != 2)
  {
    _scrollDetentOffsets = [(UIScrollView *)viewCopy _scrollDetentOffsets];
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke;
    aBlock[3] = &unk_1E70FF4A8;
    v65 = _scrollDetentOffsets;
    v102 = v65;
    v66 = _Block_copy(aBlock);
    if (!(v66[2])(v63))
    {
      lastObject = [v65 lastObject];
      [lastObject doubleValue];
      v69 = v68;

      firstObject = [v65 firstObject];
      [firstObject doubleValue];
      v72 = v71;

      if (v94 <= v72 && v94 >= v69 && v63 > v69 && !v66[2](v66, v94))
      {
        v73 = fmax(v72 - v94, 0.0);
        if (position)
        {
          v63 = v63 + v73;
        }

        else
        {
          v74 = v63 + v73 * 0.5;
          if ((position & 2) != 0)
          {
            v63 = v74;
          }
        }
      }

      if (v63 < v72 && v63 > v69)
      {
        v80 = 0;
        while ([v65 count] - 1 > v80)
        {
          v81 = [v65 objectAtIndexedSubscript:v80];
          [v81 doubleValue];
          v83 = v82;

          v84 = [v65 objectAtIndexedSubscript:++v80];
          [v84 doubleValue];
          v86 = v85;

          if (v63 < v83 && v63 > v86)
          {
            v63 = v83;
            break;
          }
        }
      }
    }
  }

  if (areaCopy)
  {
    if (viewCopy == self)
    {
      [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
    }

    else
    {
      [(UIScrollView *)viewCopy contentSize];
      v88 = v87;
      v90 = v89;
    }

    v77 = [(UICollectionView *)self _clampedContentOffset:viewCopy forScrollableAreaGivenContentSize:v61 inScrollView:v63, v88, v90];
    goto LABEL_76;
  }

LABEL_77:

  v91 = v61;
  v92 = v63;
  result.y = v92;
  result.x = v91;
  return result;
}

BOOL __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke(uint64_t a1, double a2)
{
  v2 = *(a1 + 32);
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke_2;
  v4[3] = &__block_descriptor_40_e25_B32__0__NSNumber_8Q16_B24l;
  *&v4[4] = a2;
  return [v2 indexOfObjectPassingTest:v4] != 0x7FFFFFFFFFFFFFFFLL;
}

- (void)_contentOffsetFromProposedOffset:(double)offset forScrollingToItemWithFrame:(CGFloat)frame atScrollPosition:(CGFloat)position additionalInsets:(CGFloat)insets containingScrollViewBounds:(CGFloat)bounds
{
  v28 = a13;
  if ([self _shouldReverseLayoutDirection])
  {
    if ([self _flipsHorizontalAxis])
    {
      v29 = a13;
    }

    else
    {
      v29 = a15;
    }

    v28 = v29;
  }

  if (a9)
  {
    if ((a9 & 6) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple vertical positioning styles"];
    }

    v38.origin.x = frame;
    v38.origin.y = position;
    v38.size.width = insets;
    v38.size.height = bounds;
    CGRectGetMinY(v38);
  }

  else
  {
    if ((a9 & 2) != 0)
    {
      if ((a9 & 4) != 0)
      {
        [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple vertical positioning styles"];
      }

      v40.origin.x = frame;
      v40.origin.y = position;
      v40.size.width = insets;
      v40.size.height = bounds;
      CGRectGetMidY(v40);
      v41.origin.x = a16;
      v41.origin.y = a17;
      v41.size.width = a18;
      v41.size.height = a19;
      CGRectGetHeight(v41);
      if ((a9 & 8) != 0)
      {
        goto LABEL_23;
      }

      goto LABEL_15;
    }

    if ((a9 & 4) != 0)
    {
      v36.origin.x = frame;
      v36.origin.y = position;
      v36.size.width = insets;
      v36.size.height = bounds;
      CGRectGetMaxY(v36);
      v37.origin.x = a16;
      v37.origin.y = a17;
      v37.size.width = a18;
      v37.size.height = a19;
      CGRectGetHeight(v37);
      if ((a9 & 8) != 0)
      {
        goto LABEL_23;
      }

      goto LABEL_15;
    }
  }

  if ((a9 & 8) != 0)
  {
LABEL_23:
    if ((a9 & 0x30) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple horizontal positioning styles"];
    }

    v42.origin.x = frame;
    v42.origin.y = position;
    v42.size.width = insets;
    v42.size.height = bounds;
    CGRectGetMinX(v42);
    return;
  }

LABEL_15:
  if ((a9 & 0x10) != 0)
  {
    if ((a9 & 0x20) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple horizontal positioning styles"];
    }

    v43.origin.x = frame;
    v43.origin.y = position;
    v43.size.width = insets;
    v43.size.height = bounds;
    CGRectGetMidX(v43);
    v44.origin.x = a16;
    v44.origin.y = a17;
    v44.size.width = a18;
    v44.size.height = a19;
    CGRectGetWidth(v44);
  }

  else if ((a9 & 0x20) != 0)
  {
    v45.origin.x = frame;
    v45.origin.y = position;
    v45.size.width = insets;
    v45.size.height = bounds;
    CGRectGetMaxX(v45);
    v46.origin.x = a16;
    v46.origin.y = a17;
    v46.size.width = a18;
    v46.size.height = a19;
    CGRectGetWidth(v46);
  }

  else if (!a9)
  {
    v39.origin.x = a16;
    v39.origin.y = a17;
    v39.size.width = a18;
    v39.size.height = a19;
    v59.origin.x = frame;
    v59.origin.y = position;
    v59.size.width = insets;
    v59.size.height = bounds;
    if (!CGRectContainsRect(v39, v59))
    {
      v47.origin.x = frame;
      v47.origin.y = position;
      v47.size.width = insets;
      v47.size.height = bounds;
      frameCopy = frame;
      v30 = CGRectGetMinY(v47) - a12;
      v48.origin.x = a16;
      v48.origin.y = a17;
      v48.size.width = a18;
      v48.size.height = a19;
      if (v30 >= CGRectGetMinY(v48))
      {
        v31 = frameCopy;
        v49.origin.x = frameCopy;
        v49.origin.y = position;
        v49.size.width = insets;
        v49.size.height = bounds;
        MaxY = CGRectGetMaxY(v49);
        v50.origin.x = a16;
        v50.origin.y = a17;
        v50.size.width = a18;
        v50.size.height = a19;
        if (MaxY > CGRectGetMaxY(v50))
        {
          v51.origin.x = frameCopy;
          v51.origin.y = position;
          v51.size.width = insets;
          v51.size.height = bounds;
          CGRectGetMaxY(v51);
          v52.origin.x = a16;
          v52.origin.y = a17;
          v52.size.width = a18;
          v52.size.height = a19;
          CGRectGetHeight(v52);
          dyld_program_sdk_at_least();
        }
      }

      else
      {
        v31 = frameCopy;
      }

      v53.origin.x = v31;
      v53.origin.y = position;
      v53.size.width = insets;
      v53.size.height = bounds;
      v32 = CGRectGetMinX(v53) - v28;
      v54.origin.x = a16;
      v54.origin.y = a17;
      v54.size.width = a18;
      v54.size.height = a19;
      if (v32 >= CGRectGetMinX(v54))
      {
        v55.origin.x = v31;
        v55.origin.y = position;
        v55.size.width = insets;
        v55.size.height = bounds;
        MaxX = CGRectGetMaxX(v55);
        v56.origin.x = a16;
        v56.origin.y = a17;
        v56.size.width = a18;
        v56.size.height = a19;
        if (MaxX > CGRectGetMaxX(v56))
        {
          v57.origin.x = v31;
          v57.origin.y = position;
          v57.size.width = insets;
          v57.size.height = bounds;
          CGRectGetMaxX(v57);
          v58.origin.x = a16;
          v58.origin.y = a17;
          v58.size.width = a18;
          v58.size.height = a19;
          CGRectGetWidth(v58);
          dyld_program_sdk_at_least();
        }
      }
    }
  }
}

- (void)scrollToItemAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UICollectionViewScrollPosition)scrollPosition animated:(BOOL)animated
{
  v5 = animated;
  v8 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];

  [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v8 atScrollPosition:scrollPosition additionalInsets:v5 animated:0.0, 0.0, 0.0, 0.0];
}

- (void)_scrollToItemAtIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets animated:(BOOL)animated
{
  animatedCopy = animated;
  trailing = insets.trailing;
  bottom = insets.bottom;
  leading = insets.leading;
  top = insets.top;
  v13 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:path];
  [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v13 atScrollPosition:position additionalInsets:animatedCopy animated:top, leading, bottom, trailing];
}

- (void)_scrollToItemAtPresentationIndexPath:(id)path atScrollPosition:(unint64_t)position additionalInsets:(NSDirectionalEdgeInsets)insets animated:(BOOL)animated
{
  animatedCopy = animated;
  trailing = insets.trailing;
  bottom = insets.bottom;
  leading = insets.leading;
  top = insets.top;
  v49 = *MEMORY[0x1E69E9840];
  pathCopy = path;
  [(UICollectionView *)self _reloadDataIfNeeded];
  if (!pathCopy)
  {
    goto LABEL_25;
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  orthogonalScrollerController = self->_orthogonalScrollerController;
  if (orthogonalScrollerController && [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:pathCopy])
  {
    [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa scrollToItemAtIndexPath:pathCopy atScrollPosition:position additionalInsets:animatedCopy animated:top, leading, bottom, trailing];
    if (!dyld_program_sdk_at_least())
    {
      goto LABEL_25;
    }

    v15 = 0;
  }

  else
  {
    v15 = 1;
  }

  [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:pathCopy atScrollPosition:position additionalInsets:top, leading, bottom, trailing];
  v17 = v16;
  v19 = v18;
  if (animatedCopy || [(UIScrollView *)self contentInsetAdjustmentBehavior]== UIScrollViewContentInsetAdjustmentNever)
  {
    goto LABEL_14;
  }

  [(UIScrollView *)self _effectiveContentInset];
  v21 = v20;
  v23 = v22;
  v39 = v24;
  v40 = v25;
  [(UICollectionView *)self setContentOffset:0 animated:v17, v19];
  [(UIScrollView *)self _effectiveContentInset];
  if (v23 != v29 || v21 != v26 || v40 != v28 || v39 != v27)
  {
    [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:pathCopy atScrollPosition:position additionalInsets:top, leading, bottom, trailing];
    v17 = v30;
    v19 = v31;
LABEL_14:
    [(UICollectionView *)self setContentOffset:animatedCopy animated:v17, v19];
  }

  if (dyld_program_sdk_at_least() && (v15 & [(UICollectionViewLayout *)self->_layout _estimatesSizes]) == 1)
  {
    v50.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:pathCopy];
    x = v50.origin.x;
    y = v50.origin.y;
    width = v50.size.width;
    height = v50.size.height;
    if (CGRectIsNull(v50))
    {
      v36 = *(__UILogGetCategoryCachedImpl("UICollectionView", &_scrollToItemAtPresentationIndexPath_atScrollPosition_additionalInsets_animated____s_category) + 8);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        v37 = v36;
        *buf = 138413058;
        v42 = objc_opt_class();
        v43 = 2048;
        selfCopy = self;
        v45 = 2112;
        v46 = pathCopy;
        v47 = 2112;
        selfCopy2 = self;
        _os_log_impl(&dword_188A29000, v37, OS_LOG_TYPE_ERROR, "<%@ %p> received null target element frame for scrolling target at index path %@. Scrolling may not function correctly. \nCollection View: %@", buf, 0x2Au);
      }
    }

    else
    {
      [(UICollectionView *)&self->super.super.super.super.isa _storeScrollingTargetInfoForIndexPath:pathCopy frame:position scrollPosition:x additionalInsets:y, width, height, top, leading, bottom, trailing];
      v38 = 0x10000;
      if (animatedCopy)
      {
        if ([(UIScrollView *)self isScrollAnimating])
        {
          v38 = 0;
        }

        else
        {
          v38 = 0x10000;
        }
      }

      *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFEFFFF | v38;
    }
  }

LABEL_25:
}

- (void)_scrollViewAnimationEnded:(id)ended finished:(BOOL)finished
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _scrollViewAnimationEnded:ended finished:finished];
  if (self->_scrollingTargetIndexPath)
  {
    if ((*(&self->_collectionViewFlags + 9) & 4) != 0)
    {
      *(&self->_collectionViewFlags + 4) |= 0x10000u;
    }

    else
    {
      [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    }
  }
}

- (void)_stopScrollingNotify:(BOOL)notify pin:(BOOL)pin
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _stopScrollingNotify:notify pin:pin];
  [(UICollectionView *)self _clearTargetIndexPathForScrolling];
}

- (void)setContentInset:(UIEdgeInsets)inset
{
  right = inset.right;
  bottom = inset.bottom;
  left = inset.left;
  top = inset.top;
  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIScrollView *)&v20 setContentInset:?];
  if (!dyld_program_sdk_at_least() || (([(UIScrollView *)self contentInset], left == v11) ? (v12 = top == v8) : (v12 = 0), v12 ? (v13 = right == v10) : (v13 = 0), v13 ? (v14 = bottom == v9) : (v14 = 0), !v14))
  {
    _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];

    if (_horizontalIndexTitleBar)
    {
      _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
      [_horizontalIndexTitleBar2 _setParentContentInset:{top, left, bottom, right}];
    }

    collectionViewData = self->_collectionViewData;
    if (collectionViewData)
    {
      v18 = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
    }

    else
    {
      v18 = 0;
    }

    viewFlags = self->super.super._viewFlags;
    if (dyld_program_sdk_at_least() && v18 && (viewFlags & 0x4000000000000000) == 0)
    {
      [(UICollectionViewLayout *)self->_layout invalidateLayout];
    }

    if (+[UIView _isInAnimationBlock])
    {
      [(UIView *)self layoutBelowIfNeeded];
    }
  }
}

- (void)setContentOffset:(CGPoint)offset animated:(BOOL)animated
{
  animatedCopy = animated;
  y = offset.y;
  x = offset.x;
  [(UIScrollView *)self contentOffset];
  if (x != v9 || y != v8)
  {
    [(UIView *)self bounds];
    v12 = v11;
    v14 = v13;
    v16 = v15;
    v18 = v17;
    debugger = self->_debugger;
    if (debugger)
    {
      [(UIScrollView *)self contentOffset];
      [_UICollectionViewFeedbackLoopDebugger recordCollectionViewPointPropertyChange:"recordCollectionViewPointPropertyChange:fromPoint:toPoint:" fromPoint:@"contentOffset" toPoint:?];
    }

    collectionViewData = self->_collectionViewData;
    if (collectionViewData && (*&collectionViewData->_collectionViewDataFlags & 8) != 0 && [(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:x, y, v16, v18])
    {
      v21 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:x fromOldBounds:y, v16, v18, v12, v14, v16, v18];
      [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v21];
    }
  }

  if (animatedCopy && ([(UICollectionView *)self _customScrollAnimation], (v22 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v23 = v22;
    [(UIScrollView *)self _setContentOffset:v22 animation:x, y];
  }

  else
  {
    v24.receiver = self;
    v24.super_class = UICollectionView;
    [(UIScrollView *)&v24 setContentOffset:animatedCopy animated:x, y];
  }
}

- (void)_setShouldResetInitialLayoutOnDataSourceChange:(BOOL)change
{
  if (change)
  {
    v3 = 4096;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFEFFF | v3;
}

- (void)setContentOffset:(CGPoint)offset
{
  v4.receiver = self;
  v4.super_class = UICollectionView;
  [(UIScrollView *)&v4 setContentOffset:offset.x, offset.y];
  [(UICollectionView *)self layoutHorizontalIndexTitleBar];
}

+ (id)_reuseKeyForSupplementaryViewOfKind:(id)kind withReuseIdentifier:(id)identifier
{
  if (qword_1ED4924D0 != kind || qword_1ED4924D8 != identifier)
  {
    identifierCopy = identifier;
    kindCopy = kind;
    v8 = [kindCopy length];
    v9 = v8 + [identifierCopy length] + 1;
    v10 = malloc_type_malloc(2 * v9, 0x1000040BDFB0063uLL);
    [kindCopy getCharacters:v10];
    v11 = &v10[2 * v8];
    *v11 = 47;
    [identifierCopy getCharacters:v11 + 2];
    v12 = [objc_alloc(MEMORY[0x1E696AEC0]) initWithCharactersNoCopy:v10 length:v9 freeWhenDone:1];
    v13 = qword_1ED4924E0;
    qword_1ED4924E0 = v12;

    v14 = [kindCopy copy];
    v15 = qword_1ED4924D0;
    qword_1ED4924D0 = v14;

    v16 = [identifierCopy copy];
    v17 = qword_1ED4924D8;
    qword_1ED4924D8 = v16;
  }

  v18 = qword_1ED4924E0;

  return v18;
}

- (void)_scrollViewWillEndDraggingWithVelocity:(CGPoint)velocity targetContentOffset:(CGPoint *)offset
{
  [(UICollectionViewLayout *)self->_layout targetContentOffsetForProposedContentOffset:offset->x withScrollingVelocity:offset->y, velocity.x, velocity.y];
  offset->x = v5;
  offset->y = v6;
}

- (CGPoint)_adjustFocusContentOffset:(CGPoint)offset toShowFocusItemWithInfo:(id)info
{
  y = offset.y;
  x = offset.x;
  infoCopy = info;
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (_horizontalIndexTitleBar && (v9 = _horizontalIndexTitleBar, -[UICollectionView _horizontalIndexTitleBar](self, "_horizontalIndexTitleBar"), v10 = objc_claimAutoreleasedReturnValue(), [infoCopy item], v11 = objc_claimAutoreleasedReturnValue(), _UIFocusEnvironmentContainingView(v11), v12 = objc_claimAutoreleasedReturnValue(), v13 = objc_msgSend(v10, "_isViewEntryCell:", v12), v12, v11, v10, v9, v13))
  {
    [(UIScrollView *)self contentOffset];
  }

  else
  {
    v20.receiver = self;
    v20.super_class = UICollectionView;
    [(UIScrollView *)&v20 _adjustFocusContentOffset:infoCopy toShowFocusItemWithInfo:x, y];
  }

  v16 = v14;
  v17 = v15;

  v18 = v16;
  v19 = v17;
  result.y = v19;
  result.x = v18;
  return result;
}

- (unint64_t)_focusPrimaryScrollableAxis
{
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  _layoutAxis = [collectionViewLayout _layoutAxis];

  if (_layoutAxis - 1 >= 2)
  {
    v6.receiver = self;
    v6.super_class = UICollectionView;
    return [(UIScrollView *)&v6 _focusPrimaryScrollableAxis];
  }

  return _layoutAxis;
}

- (void)_setShouldPreventFocusScrollPastContentSize:(BOOL)size
{
  sizeCopy = size;
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _setShouldPreventFocusScrollPastContentSize:?];
  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController setShouldPreventFocusScrollPastContentSize:sizeCopy];
}

- (id)_createStaticScrollBar
{
  v2 = [_UIIndexBarStaticScrollAccessory alloc];
  v3 = [(_UIStaticScrollBar *)v2 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];

  return v3;
}

- (void)_setUsesStaticScrollBar:(BOOL)bar
{
  barCopy = bar;
  _staticScrollBar = [(UIScrollView *)self _staticScrollBar];

  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 _setUsesStaticScrollBar:barCopy];
  if ((_staticScrollBar == 0) == barCopy)
  {
    [(UICollectionView *)self _reloadSectionIndexTitles];
  }
}

- (id)_indexPathForEntryWithTitle:(id)title atIndex:(int64_t)index validateTitles:(BOOL)titles
{
  titlesCopy = titles;
  titleCopy = title;
  if (titlesCopy)
  {
    _dataSourceSectionIndexTitles = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v11 = [_dataSourceSectionIndexTitles count];

    if (!v11)
    {
LABEL_14:
      v13 = 0;
      goto LABEL_15;
    }
  }

  if ((*(&self->_collectionViewFlags + 7) & 0x40) == 0 || (v12 = objc_loadWeakRetained(&self->_dataSource), [v12 _collectionView:self indexPathForSectionIndexTitle:titleCopy atIndex:index], v13 = objc_claimAutoreleasedReturnValue(), v12, !v13))
  {
    if ((*(&self->_collectionViewFlags + 8) & 4) == 0 || (WeakRetained = objc_loadWeakRetained(&self->_dataSource), [WeakRetained collectionView:self indexPathForIndexTitle:titleCopy atIndex:index], v13 = objc_claimAutoreleasedReturnValue(), WeakRetained, !v13))
    {
      if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]> index && [(UICollectionViewData *)self->_collectionViewData numberOfItemsInSection:index]>= 1)
      {
        v13 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:index];
        goto LABEL_15;
      }

      goto LABEL_14;
    }
  }

  section = [v13 section];
  if (-[UICollectionView numberOfSections](self, "numberOfSections") <= section || [v13 item] != 0x7FFFFFFFFFFFFFFFLL && (v16 = -[UICollectionView numberOfItemsInSection:](self, "numberOfItemsInSection:", section), v16 <= objc_msgSend(v13, "item")))
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8951 description:{@"no cell for index path (%@) - the collection view's data source must return an index path for a valid UICollectionViewCell from -collectionView:indexPathForIndexTitle:atIndex:", v13}];
  }

LABEL_15:

  return v13;
}

- (void)accessoryInsetsDidChange:(UIEdgeInsets)change
{
  right = change.right;
  bottom = change.bottom;
  left = change.left;
  top = change.top;
  v29 = *MEMORY[0x1E69E9840];
  v24.receiver = self;
  v24.super_class = UICollectionView;
  [(UIScrollView *)&v24 accessoryInsetsDidChange:?];
  [(UIScrollView *)self accessoryInsets];
  if (v9 != left || v8 != top || v11 != right || v10 != bottom)
  {
    v15 = v8;
    v16 = v9;
    v17 = v10;
    v18 = v11;
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &accessoryInsetsDidChange____s_category);
    if (*CategoryCachedImpl)
    {
      v20 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        v21 = v20;
        v30.top = top;
        v30.left = left;
        v30.bottom = bottom;
        v30.right = right;
        v22 = NSStringFromUIEdgeInsets(v30);
        v31.top = v15;
        v31.left = v16;
        v31.bottom = v17;
        v31.right = v18;
        v23 = NSStringFromUIEdgeInsets(v31);
        *buf = 138412546;
        v26 = v22;
        v27 = 2112;
        v28 = v23;
        _os_log_impl(&dword_188A29000, v21, OS_LOG_TYPE_ERROR, "Invalidating layout due to [UICollectionView accessoryInsetsDidChange:] previousInsets: %@, newInsets: %@", buf, 0x16u);
      }
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (BOOL)indexBarView:(id)view didSelectEntry:(id)entry atIndex:(int64_t)index
{
  v49 = *MEMORY[0x1E69E9840];
  entryCopy = entry;
  title = [entryCopy title];
  indexPath = [entryCopy indexPath];

  if (!indexPath)
  {
    v10 = [(UICollectionView *)self _indexPathForEntryWithTitle:title atIndex:index validateTitles:1];
    if (!v10)
    {
      v25 = 0;
      goto LABEL_20;
    }

    indexPath = v10;
  }

  [(UIScrollView *)self contentOffset];
  v12 = v11;
  v14 = v13;
  _focusBehavior = [(UIView *)self _focusBehavior];
  if ([_focusBehavior refinesIndexBarTargetContentOffset])
  {
    v16 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
    scrollManager = [v16 scrollManager];
    if (scrollManager)
    {
      v50.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:indexPath];
      x = v50.origin.x;
      y = v50.origin.y;
      width = v50.size.width;
      height = v50.size.height;
      if (CGRectIsNull(v50))
      {
        v22 = *(__UILogGetCategoryCachedImpl("UICollectionView", &indexBarView_didSelectEntry_atIndex____s_category) + 8);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
        {
          v23 = v22;
          v39 = 138413314;
          v40 = objc_opt_class();
          v41 = 2048;
          selfCopy = self;
          v43 = 2048;
          indexCopy = index;
          v45 = 2112;
          v46 = indexPath;
          v47 = 2112;
          selfCopy2 = self;
          _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "<%@ %p> received null target element frame for scrolling to index bar entry index (%ld) at index path %@. Scrolling may not function correctly. \nCollection View: %@", &v39, 0x34u);
        }
      }

      else
      {
        [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:indexPath atScrollPosition:1 additionalInsets:0.0, 0.0, 0.0, 0.0];
        v27 = v26;
        v29 = v28;
        _focusTuple = [(UIScrollView *)self _focusTuple];
        [scrollManager contentOffsetForEnvironmentScrollableContainer:_focusTuple toShowRect:x targetOffset:{y, width, height, v27, v29}];
        v32 = v31;
        v34 = v33;

        [(UICollectionView *)self setContentOffset:0 animated:v32, v34];
      }
    }
  }

  else
  {
    if ((*(&self->super.super._viewFlags + 2) & 0x400000) != 0)
    {
      v24 = 33;
    }

    else
    {
      v24 = 9;
    }

    [(UICollectionView *)self _scrollToItemAtIndexPath:indexPath atScrollPosition:v24 additionalInsets:0 animated:0.0, 0.0, 0.0, 0.0];
  }

  [(UIScrollView *)self contentOffset];
  v37 = vabdd_f64(v35, v12) >= 0.00000011920929;
  v25 = vabdd_f64(v36, v14) >= 0.00000011920929 || v37;

LABEL_20:
  return v25;
}

- (CGPoint)indexBarAccessoryView:(id)view contentOffsetForEntry:(id)entry atIndex:(int64_t)index
{
  viewCopy = view;
  entryCopy = entry;
  title = [entryCopy title];
  indexPath = [entryCopy indexPath];
  if (indexPath || ([(UICollectionView *)self _indexPathForEntryWithTitle:title atIndex:index validateTitles:1], (indexPath = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v12 = indexPath;
    [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:indexPath atScrollPosition:1 additionalInsets:0.0, 0.0, 0.0, 0.0];
    v14 = v13;
    v16 = v15;
    _focusBehavior = [(UIView *)self _focusBehavior];
    if ([_focusBehavior refinesIndexBarTargetContentOffset])
    {
      v18 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
      scrollManager = [v18 scrollManager];
      if (scrollManager)
      {
        v20 = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:v12];
        v22 = v21;
        v24 = v23;
        v26 = v25;
        _focusTuple = [(UIScrollView *)self _focusTuple];
        [scrollManager contentOffsetForEnvironmentScrollableContainer:_focusTuple toShowRect:v20 targetOffset:{v22, v24, v26, v14, v16}];
        v14 = v28;
        v16 = v29;
      }
    }
  }

  else
  {
    v34.receiver = self;
    v34.super_class = UICollectionView;
    [(UIScrollView *)&v34 indexBarAccessoryView:viewCopy contentOffsetForEntry:entryCopy atIndex:index];
    v14 = v32;
    v16 = v33;
  }

  v30 = v14;
  v31 = v16;
  result.y = v31;
  result.x = v30;
  return result;
}

- (CGPoint)_contentOffsetForLowFidelityScrollInDirection:(CGPoint)direction duration:(double *)duration
{
  y = direction.y;
  x = direction.x;
  v79.receiver = self;
  v79.super_class = UICollectionView;
  [(UIScrollView *)&v79 _contentOffsetForLowFidelityScrollInDirection:duration duration:?];
  v8 = v7;
  v10 = v9;
  if (y == 0.0 || ([(UIScrollView *)self contentSize], v12 = v11, [(UIView *)self bounds], v12 > v13))
  {
    if (x == 0.0 || ([(UIScrollView *)self contentSize], v15 = v14, [(UIView *)self bounds], v15 > v16))
    {
      if (!self || y >= 0.0 || ([(UIScrollView *)self _contentInsetIncludingDecorations], v10 + v17 > 0.001))
      {
        if (x >= 0.0 && (x <= 0.0 || ![(UIView *)self _shouldReverseLayoutDirection]|| [(UIView *)self _flipsHorizontalAxis]) || ([(UICollectionView *)self _isContentOffset:v8 atStartOfAxis:v10]& 1) == 0)
        {
          if ([(UIScrollView *)self isScrollAnimating])
          {
            [(UIScrollView *)self _animatedTargetOffset];
          }

          else
          {
            [(UIScrollView *)self contentOffset];
          }

          v20 = v18;
          v21 = v19;
          [(UIView *)self bounds];
          v23 = v22;
          v25 = v24;
          v26 = v20 + x * v22;
          v27 = v21 + y * v24;
          v76 = v29;
          v77 = v28;
          v30 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v28 validateLayout:v29, v22, v24];
          _layoutAxis = [(UICollectionViewLayout *)self->_layout _layoutAxis];
          v78[0] = MEMORY[0x1E69E9820];
          v78[1] = 3221225472;
          v78[2] = __75__UICollectionView__contentOffsetForLowFidelityScrollInDirection_duration___block_invoke;
          v78[3] = &unk_1E70FF030;
          v78[4] = self;
          v32 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:v30 amongCandidates:_layoutAxis onAxis:v78 shouldConsiderBlock:v26, v27];
          v33 = v32;
          if (v32)
          {
            v68 = v27;
            v69 = v26;
            [v32 frame];
            v74 = v35;
            v75 = v34;
            v72 = v37;
            v73 = v36;
            layout = self->_layout;
            indexPath = [v33 indexPath];
            [(UICollectionViewLayout *)layout _supplementaryViewInsetsForScrollingToItemAtIndexPath:indexPath];
            v70 = v41;
            v71 = v40;
            v43 = v42;
            v45 = v44;

            if ([(UIView *)self _shouldReverseLayoutDirection])
            {
              _flipsHorizontalAxis = [(UIView *)self _flipsHorizontalAxis];
              if (_flipsHorizontalAxis)
              {
                v47 = v43;
              }

              else
              {
                v47 = v45;
              }

              if (!_flipsHorizontalAxis)
              {
                v45 = v43;
              }

              v43 = v47;
            }

            if (y < 0.0)
            {
              v48 = 4;
            }

            else
            {
              if (y > 0.0)
              {
                v48 = 1;
              }

              else
              {
                v48 = 32;
              }

              if (y <= 0.0 && x >= 0.0)
              {
                if (x <= 0.0)
                {
                  v48 = 0;
                }

                else
                {
                  v48 = 8;
                }
              }
            }

            [(UIScrollView *)self _effectiveContentInset];
            v50 = v76 + v49;
            v53 = v23 - (v51 + v52);
            v55 = v25 - (v49 + v54);
            v81.origin.x = v43 + v77 + v51;
            v81.origin.y = v71 + v50;
            v81.size.width = v53 - (v43 + v45);
            v81.size.height = v55 - (v71 + v70);
            v82 = CGRectInset(v81, -0.1, -0.1);
            v83.origin.y = v74;
            v83.origin.x = v75;
            v83.size.height = v72;
            v83.size.width = v73;
            if (CGRectContainsRect(v82, v83))
            {
              if (y < 0.0)
              {
                v56 = v25 + v68;
              }

              else
              {
                v56 = v68;
              }

              if (x >= 0.0)
              {
                v57 = v69;
              }

              else
              {
                v57 = v23 + v69;
              }

              indexPath3 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v69 validateLayout:v68, v23, v25];
              v59 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:indexPath3 amongCandidates:[(UICollectionViewLayout *)self->_layout _layoutAxis] onAxis:&__block_literal_global_686_0 shouldConsiderBlock:v57, v56];
              v60 = v59;
              if (v59)
              {
                indexPath2 = [v59 indexPath];
                [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:indexPath2 atScrollPosition:v48 additionalInsets:0.0, 0.0, 0.0, 0.0];
                v8 = v62;
                v10 = v63;
              }
            }

            else
            {
              indexPath3 = [v33 indexPath];
              [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:indexPath3 atScrollPosition:v48 additionalInsets:0.0, 0.0, 0.0, 0.0];
              v8 = v64;
              v10 = v65;
            }
          }
        }
      }
    }
  }

  v66 = v8;
  v67 = v10;
  result.y = v67;
  result.x = v66;
  return result;
}

BOOL __75__UICollectionView__contentOffsetForLowFidelityScrollInDirection_duration___block_invoke(uint64_t a1, void *a2)
{
  v2 = *(*(a1 + 32) + 2984);
  v3 = [a2 indexPath];
  v4 = [(_UICollectionViewSubviewManager *)v2 visibleCellAtIndexPath:v3];
  v5 = v4 != 0;

  return v5;
}

- (id)_focusFastScrollingIndexBarEntries
{
  _dataSourceSectionIndexTitles = [(UICollectionView *)self _dataSourceSectionIndexTitles];
  if ([_dataSourceSectionIndexTitles count])
  {
    v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke;
    v9[3] = &unk_1E70FF4D0;
    v9[4] = self;
    v5 = v4;
    v10 = v5;
    [_dataSourceSectionIndexTitles enumerateObjectsUsingBlock:v9];
    v6 = v10;
    _focusFastScrollingIndexBarEntries = v5;
  }

  else
  {
    v11.receiver = self;
    v11.super_class = UICollectionView;
    _focusFastScrollingIndexBarEntries = [(UIScrollView *)&v11 _focusFastScrollingIndexBarEntries];
  }

  return _focusFastScrollingIndexBarEntries;
}

void __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  v5 = a2;
  v6 = [*(a1 + 32) _indexPathForEntryWithTitle:v5 atIndex:a3 validateTitles:0];
  if ([v6 length] == 1)
  {
    v7 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:{objc_msgSend(v6, "indexAtPosition:", 0)}];
  }

  else
  {
    v7 = v6;
  }

  v8 = v7;
  objc_initWeak(&location, *(a1 + 32));
  v12 = MEMORY[0x1E69E9820];
  v13 = 3221225472;
  v14 = __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke_2;
  v15 = &unk_1E70FF518;
  objc_copyWeak(&v18, &location);
  v9 = v6;
  v16 = v9;
  v10 = v8;
  v17 = v10;
  v11 = [_UIFocusFastScrollingIndexBarEntry entryWithTitle:v5 generator:&v12];
  [v11 setTargetFocusedIndexPath:{v10, v12, v13, v14, v15}];
  [*(a1 + 40) addObject:v11];

  objc_destroyWeak(&v18);
  objc_destroyWeak(&location);
}

double __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 48));
  if (os_variant_has_internal_diagnostics())
  {
    if (!WeakRetained)
    {
      v22 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
      {
        *buf = 0;
        _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "Index entry's weak reference to UICollectionView could not be resolved to strong reference.", buf, 2u);
      }

      goto LABEL_12;
    }
  }

  else if (!WeakRetained)
  {
    v23 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewLimitsCellsCreatedPerPass_block_invoke_8___s_category) + 8);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      *v25 = 0;
      _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "Index entry's weak reference to UICollectionView could not be resolved to strong reference.", v25, 2u);
    }

    goto LABEL_12;
  }

  [WeakRetained contentSize];
  if (v3 == 0.0 || ([WeakRetained contentSize], v4 == 0.0))
  {
LABEL_12:
    v21 = INFINITY;
    goto LABEL_13;
  }

  [WeakRetained _contentOffsetForScrollingToItemAtIndexPath:*(a1 + 32) atScrollPosition:1 additionalInsets:{0.0, 0.0, 0.0, 0.0}];
  v6 = v5;
  v8 = v7;
  v9 = [WeakRetained _collectionViewData];
  v10 = [(UICollectionViewData *)v9 rectForItemAtIndexPath:?];
  v12 = v11;
  v14 = v13;
  v16 = v15;

  v17 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:WeakRetained];
  v18 = [v17 scrollManager];
  v19 = [WeakRetained _focusTuple];
  [v18 contentOffsetForEnvironmentScrollableContainer:v19 toShowRect:v10 targetOffset:{v12, v14, v16, v6, v8}];
  v21 = v20;

LABEL_13:
  return v21;
}

- (void)_wheelChangedWithEvent:(id)event
{
  eventCopy = event;
  _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
  _screen = [(UIView *)self _screen];
  if ([_screen _userInterfaceIdiom] != 3 || !_indexOverlayManager || !-[UICollectionView _wantsIndexOverlays](self, "_wantsIndexOverlays"))
  {

    goto LABEL_8;
  }

  _isFocusedOrAncestorOfFocusedView = [(UIView *)self _isFocusedOrAncestorOfFocusedView];

  if (!_isFocusedOrAncestorOfFocusedView)
  {
LABEL_8:
    v10.receiver = self;
    v8 = &v10;
    goto LABEL_9;
  }

  if (([(_UICollectionTableIndexOverlayManager *)_indexOverlayManager handleWheelChangedEvent:eventCopy]& 1) == 0)
  {
    selfCopy = self;
    v8 = &selfCopy;
LABEL_9:
    v8->super_class = UICollectionView;
    [(objc_super *)v8 _wheelChangedWithEvent:eventCopy, selfCopy];
  }
}

- (void)_moveWithEvent:(id)event
{
  eventCopy = event;
  _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
  v6 = _indexOverlayManager;
  collectionViewData = self->_collectionViewData;
  if (collectionViewData && (collectionViewData->_totalItemCount >= 1 ? (v8 = _indexOverlayManager == 0) : (v8 = 1), !v8 && (*(_indexOverlayManager + 48) & 1) != 0))
  {
    [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager handleMoveEvent:eventCopy];
  }

  else
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIResponder *)&v9 _moveWithEvent:eventCopy];
  }
}

- (int64_t)_currentSectionIndexTitleIndex
{
  currentIndexTitleIndex = self->_currentIndexTitleIndex;
  if (currentIndexTitleIndex != -1)
  {
    _dataSourceSectionIndexTitles = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v5 = [_dataSourceSectionIndexTitles count];

    if (currentIndexTitleIndex < v5)
    {
      return self->_currentIndexTitleIndex;
    }
  }

  [(UIView *)self bounds];
  v8 = v7;
  v10 = v9;
  v13 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v7 validateLayout:v9, v11, v12];
  v14 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:v13 amongCandidates:[(UICollectionViewLayout *)self->_layout _layoutAxis] onAxis:&__block_literal_global_697 shouldConsiderBlock:v8, v10];
  v15 = v14;
  v6 = 0x7FFFFFFFFFFFFFFFLL;
  if (v14)
  {
    indexPath = [v14 indexPath];
    section = [indexPath section];

    _dataSourceSectionIndexTitles2 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v21 = 0;
    v22 = &v21;
    v23 = 0x2020000000;
    v24 = 0x7FFFFFFFFFFFFFFFLL;
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __50__UICollectionView__currentSectionIndexTitleIndex__block_invoke_2;
    v20[3] = &unk_1E70FF540;
    v20[5] = &v21;
    v20[6] = section;
    v20[4] = self;
    [_dataSourceSectionIndexTitles2 enumerateObjectsUsingBlock:v20];
    v6 = v22[3];
    if (v6 == 0x7FFFFFFFFFFFFFFFLL)
    {
      if ([_dataSourceSectionIndexTitles2 count])
      {
        v6 = 0;
        v22[3] = 0;
      }

      else
      {
        v6 = v22[3];
      }
    }

    _Block_object_dispose(&v21, 8);
  }

  return v6;
}

void __50__UICollectionView__currentSectionIndexTitleIndex__block_invoke_2(void *a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v7 = a2;
  v8 = a1[4];
  v9 = a3;
  if ((v8[2728] & 4) != 0)
  {
    v12 = v7;
    v10 = [v8 _dataSourceProxy];
    v11 = [v10 collectionView:a1[4] indexPathForIndexTitle:v12 atIndex:a3];

    v9 = [v11 section];
    v7 = v12;
  }

  if (v9 == a1[6])
  {
    *(*(a1[5] + 8) + 24) = a3;
    *a4 = 1;
  }
}

- (void)_recomputeSectionIndexTitleIndex
{
  self->_currentIndexTitleIndex = -1;
  _currentSectionIndexTitleIndex = [(UICollectionView *)self _currentSectionIndexTitleIndex];
  self->_currentIndexTitleIndex = _currentSectionIndexTitleIndex;
  v4 = [(UICollectionView *)self _updateIndexOverlayToShowTitleAtIndex:_currentSectionIndexTitleIndex];
}

- (id)_updateIndexOverlayToShowTitleAtIndex:(int64_t)index
{
  _dataSourceSectionIndexTitles = [(UICollectionView *)self _dataSourceSectionIndexTitles];
  v6 = _dataSourceSectionIndexTitles;
  if (index < 0 || [_dataSourceSectionIndexTitles count] <= index)
  {
    v7 = 0;
  }

  else
  {
    v7 = [v6 objectAtIndex:index];
    [(_UICollectionTableIndexOverlayManager *)self->_indexOverlayManager setIndexOverlayIndicatorViewText:v7];
  }

  return v7;
}

- (void)_moveSectionIndexTitleIndexToIndex:(int64_t)index highlight:(BOOL)highlight
{
  if ((index & 0x8000000000000000) == 0)
  {
    highlightCopy = highlight;
    v7 = [(UICollectionView *)self _updateIndexOverlayToShowTitleAtIndex:?];
    if (v7)
    {
      v11 = v7;
      v8 = [(UICollectionView *)self _sectionIndexChangedToIndex:index title:v7];
      v9 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:v8];
      if (highlightCopy)
      {
        v10 = [(UICollectionView *)self _globalIndexPathForItemAtIndexPath:v9];
        if (v10 != 0x7FFFFFFFFFFFFFFFLL)
        {
          [(UICollectionView *)self _unhighlightAllItemsAndHighlightGlobalItem:v10];
        }
      }

      v7 = v11;
    }
  }
}

- (void)_shiftSectionIndexTitleIndexByAmount:(int64_t)amount
{
  v4 = [(UICollectionView *)self _currentSectionIndexTitleIndex]+ amount;

  [(UICollectionView *)self _moveSectionIndexTitleIndexToIndex:v4 highlight:1];
}

- (void)userInteractionStoppedWithIndexBarView:(id)view
{
  traitCollection = [(UIView *)self traitCollection];
  userInterfaceIdiom = [traitCollection userInterfaceIdiom];

  if (userInterfaceIdiom == 3)
  {
    _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
    [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager transitionIndexOverlaySelectionViewToVisible:?];
  }
}

- (int64_t)_sectionIndexChangedToIndex:(int64_t)index title:(id)title
{
  titleCopy = title;
  if ((*(&self->_collectionViewFlags + 8) & 4) != 0)
  {
    _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
    v7 = [_dataSourceProxy collectionView:self indexPathForIndexTitle:titleCopy atIndex:index];

    section = [v7 section];
    if (v7)
    {
      self->_currentIndexTitleIndex = index;
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v7 atScrollPosition:1 additionalInsets:0 animated:0.0, 0.0, 0.0, 0.0];
      traitCollection = [(UIView *)self traitCollection];
      interactionModel = [traitCollection interactionModel];

      if ((interactionModel & 2) != 0)
      {
        [(UICollectionView *)self _requestFocusOnItemAtIndexPath:v7];
      }
    }

    index = section;
  }

  else
  {
    v7 = 0;
  }

  return index;
}

- (void)_transitionIndexOverlaySelectionViewToVisible:(BOOL)visible
{
  visibleCopy = visible;
  _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
  [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager transitionIndexOverlaySelectionViewToVisible:visibleCopy];
}

- (void)_hideIndexOverlay
{
  _indexOverlayManager = [(UICollectionView *)self _indexOverlayManager];
  [(_UICollectionTableIndexOverlayManager *)_indexOverlayManager transitionIndexOverlayIndicatorViewToVisible:0 shouldFadeBackToInvisible:?];
}

- (void)_registeredSupplementaryViewKind:(id)kind
{
  kindCopy = kind;
  supplementaryViewRegisteredKinds = self->_supplementaryViewRegisteredKinds;
  v8 = kindCopy;
  if (!supplementaryViewRegisteredKinds)
  {
    v6 = [MEMORY[0x1E695DFA8] set];
    v7 = self->_supplementaryViewRegisteredKinds;
    self->_supplementaryViewRegisteredKinds = v6;

    kindCopy = v8;
    supplementaryViewRegisteredKinds = self->_supplementaryViewRegisteredKinds;
  }

  [(NSMutableSet *)supplementaryViewRegisteredKinds addObject:kindCopy];
}

- (void)registerClass:(Class)cellClass forCellWithReuseIdentifier:(NSString *)identifier
{
  v15 = identifier;
  if ([(NSString *)v15 length])
  {
    if (!cellClass)
    {
      goto LABEL_5;
    }
  }

  else
  {
    v10 = MEMORY[0x1E695DF30];
    v11 = *MEMORY[0x1E695D940];
    v12 = NSStringFromSelector(a2);
    [v10 raise:v11 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v12}];

    if (!cellClass)
    {
      goto LABEL_5;
    }
  }

  if (([(objc_class *)cellClass isSubclassOfClass:objc_opt_class()]& 1) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    v14 = NSStringFromClass(cellClass);
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9525 description:{@"attempt to register a cell class '%@' which is not a subclass of UICollectionViewCell", v14}];
  }

LABEL_5:
  if (!self->_cellClassDict)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DF90]);
    cellClassDict = self->_cellClassDict;
    self->_cellClassDict = v7;
  }

  [(NSMutableDictionary *)self->_cellNibDict removeObjectForKey:v15];
  v9 = self->_cellClassDict;
  if (cellClass)
  {
    [(NSMutableDictionary *)v9 setValue:cellClass forKey:v15];
  }

  else
  {
    [(NSMutableDictionary *)v9 removeObjectForKey:v15];
  }
}

- (void)registerClass:(Class)viewClass forSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier
{
  v20 = elementKind;
  v9 = identifier;
  if (![(NSString *)v20 length])
  {
    v14 = MEMORY[0x1E695DF30];
    v15 = *MEMORY[0x1E695D940];
    v16 = NSStringFromSelector(a2);
    [v14 raise:v15 format:{@"must pass a valid element kind to -[UICollectionView %@]", v16}];
  }

  if (![(NSString *)v9 length])
  {
    v17 = MEMORY[0x1E695DF30];
    v18 = *MEMORY[0x1E695D940];
    v19 = NSStringFromSelector(a2);
    [v17 raise:v18 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v19}];
  }

  if (!self->_supplementaryViewClassDict)
  {
    v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
    supplementaryViewClassDict = self->_supplementaryViewClassDict;
    self->_supplementaryViewClassDict = v10;
  }

  v12 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v20 withReuseIdentifier:v9];
  [(NSMutableDictionary *)self->_supplementaryViewNibDict removeObjectForKey:v12];
  v13 = self->_supplementaryViewClassDict;
  if (viewClass)
  {
    [(NSMutableDictionary *)v13 setValue:viewClass forKey:v12];
  }

  else
  {
    [(NSMutableDictionary *)v13 removeObjectForKey:v12];
  }

  [(UICollectionView *)self _registeredSupplementaryViewKind:v20];
}

- (void)registerNib:(UINib *)nib forCellWithReuseIdentifier:(NSString *)identifier
{
  v14 = nib;
  v7 = identifier;
  if (![(NSString *)v7 length])
  {
    v11 = MEMORY[0x1E695DF30];
    v12 = *MEMORY[0x1E695D940];
    v13 = NSStringFromSelector(a2);
    [v11 raise:v12 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v13}];
  }

  if (!self->_cellNibDict)
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
    cellNibDict = self->_cellNibDict;
    self->_cellNibDict = v8;
  }

  [(NSMutableDictionary *)self->_cellClassDict removeObjectForKey:v7];
  v10 = self->_cellNibDict;
  if (v14)
  {
    [(NSMutableDictionary *)v10 setValue:v14 forKey:v7];
  }

  else
  {
    [(NSMutableDictionary *)v10 removeObjectForKey:v7];
  }
}

- (void)registerNib:(UINib *)nib forSupplementaryViewOfKind:(NSString *)kind withReuseIdentifier:(NSString *)identifier
{
  v21 = nib;
  v9 = kind;
  v10 = identifier;
  if (![(NSString *)v9 length])
  {
    v15 = MEMORY[0x1E695DF30];
    v16 = *MEMORY[0x1E695D940];
    v17 = NSStringFromSelector(a2);
    [v15 raise:v16 format:{@"must pass a valid element kind to -[UICollectionView %@]", v17}];
  }

  if (![(NSString *)v10 length])
  {
    v18 = MEMORY[0x1E695DF30];
    v19 = *MEMORY[0x1E695D940];
    v20 = NSStringFromSelector(a2);
    [v18 raise:v19 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v20}];
  }

  if (!self->_supplementaryViewNibDict)
  {
    v11 = objc_alloc_init(MEMORY[0x1E695DF90]);
    supplementaryViewNibDict = self->_supplementaryViewNibDict;
    self->_supplementaryViewNibDict = v11;
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v9 withReuseIdentifier:v10];
  [(NSMutableDictionary *)self->_supplementaryViewClassDict removeObjectForKey:v13];
  v14 = self->_supplementaryViewNibDict;
  if (v21)
  {
    [(NSMutableDictionary *)v14 setValue:v21 forKey:v13];
  }

  else
  {
    [(NSMutableDictionary *)v14 removeObjectForKey:v13];
  }

  [(UICollectionView *)self _registeredSupplementaryViewKind:v9];
}

- (void)_setExternalObjectTable:(id)table forNibLoadingOfCellWithReuseIdentifier:(id)identifier
{
  tableCopy = table;
  identifierCopy = identifier;
  cellNibExternalObjectsTables = self->_cellNibExternalObjectsTables;
  if (!cellNibExternalObjectsTables)
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v9 = self->_cellNibExternalObjectsTables;
    self->_cellNibExternalObjectsTables = v8;

    cellNibExternalObjectsTables = self->_cellNibExternalObjectsTables;
  }

  [(NSMutableDictionary *)cellNibExternalObjectsTables setObject:tableCopy forKey:identifierCopy];
}

- (void)_setExternalObjectTable:(id)table forNibLoadingOfSupplementaryViewOfKind:(id)kind withReuseIdentifier:(id)identifier
{
  tableCopy = table;
  kindCopy = kind;
  identifierCopy = identifier;
  supplementaryViewNibExternalObjectsTables = self->_supplementaryViewNibExternalObjectsTables;
  if (!supplementaryViewNibExternalObjectsTables)
  {
    v11 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v12 = self->_supplementaryViewNibExternalObjectsTables;
    self->_supplementaryViewNibExternalObjectsTables = v11;

    supplementaryViewNibExternalObjectsTables = self->_supplementaryViewNibExternalObjectsTables;
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:kindCopy withReuseIdentifier:identifierCopy];
  [(NSMutableDictionary *)supplementaryViewNibExternalObjectsTables setObject:tableCopy forKey:v13];
}

- (void)_prepareViewForUse:(id)use withElementCategory:(unint64_t)category elementKind:(id)kind reuseIdentifier:(id)identifier indexPath:(id)path
{
  useCopy = use;
  [(UICollectionView *)self _prepareViewForUse:useCopy withElementCategory:category elementKind:kind reuseIdentifier:identifier indexPath:path applyDefaultAttributes:1];
  [(_UICollectionViewSubviewManager *)self->_subviewManager ensureViewIsRemovedFromReuseQueue:useCopy];
}

- (void)_prepareViewForUse:(id)use withElementCategory:(unint64_t)category elementKind:(id)kind reuseIdentifier:(id)identifier indexPath:(id)path applyDefaultAttributes:(BOOL)attributes
{
  attributesCopy = attributes;
  useCopy = use;
  kindCopy = kind;
  [useCopy _setReuseIdentifier:identifier];
  [useCopy _setElementKind:kindCopy];
  [useCopy setAutoresizingMask:0];
  [useCopy setTranslatesAutoresizingMaskIntoConstraints:1];
  [useCopy _setCollectionView:self];
  [useCopy _setAutomaticIntrinsicContentSizeInvalidationEnabled:(*(&self->_collectionViewFlags + 4) & 0x60) == 64];
  if (attributesCopy)
  {
    if (self->_layout)
    {
      layoutAttributesClass = [objc_opt_class() layoutAttributesClass];
    }

    else
    {
      layoutAttributesClass = objc_opt_class();
    }

    if (category == 1)
    {
      v17 = [layoutAttributesClass layoutAttributesForSupplementaryViewOfKind:kindCopy withIndexPath:path];
    }

    else
    {
      if (category)
      {
        [layoutAttributesClass layoutAttributesForDecorationViewOfKind:kindCopy withIndexPath:path];
      }

      else
      {
        [layoutAttributesClass layoutAttributesForCellWithIndexPath:path];
      }
      v17 = ;
    }

    v18 = v17;
    [useCopy center];
    [v18 setCenter:?];
    [useCopy bounds];
    [v18 setSize:{v19, v20}];
    layer = [useCopy layer];
    v22 = layer;
    if (layer)
    {
      [layer transform];
    }

    else
    {
      v30 = 0u;
      v31 = 0u;
      v28 = 0u;
      v29 = 0u;
      v26 = 0u;
      v27 = 0u;
      v24 = 0u;
      v25 = 0u;
    }

    v23[4] = v28;
    v23[5] = v29;
    v23[6] = v30;
    v23[7] = v31;
    v23[0] = v24;
    v23[1] = v25;
    v23[2] = v26;
    v23[3] = v27;
    [v18 setTransform3D:v23];

    [useCopy alpha];
    [v18 setAlpha:?];
    [(UICollectionView *)self _applyLayoutAttributes:v18 toView:useCopy];
  }

  [useCopy _setHostsLayoutEngine:1];
  [useCopy _markAsDequeued];
}

- (id)_dequeueReusableViewOfKind:(id)kind withIdentifier:(id)identifier forIndexPath:(id)path viewCategory:(unint64_t)category
{
  kindCopy = kind;
  identifierCopy = identifier;
  _UIQOSExpectComplexCommit("UICVDQ");
  v73 = 0;
  v74 = &v73;
  v75 = 0x3032000000;
  v76 = __Block_byref_object_copy__39;
  v77 = __Block_byref_object_dispose__39;
  v78 = 0;
  pathCopy = path;
  v13 = 0;
  if ((*(&self->_collectionViewFlags + 16) & 8) != 0)
  {
LABEL_4:
    v65 = pathCopy;
    if (category)
    {
      goto LABEL_17;
    }

    goto LABEL_5;
  }

  transitionLayoutAttributes = self->_transitionLayoutAttributes;
  if (transitionLayoutAttributes)
  {
    v13 = transitionLayoutAttributes;
    goto LABEL_4;
  }

  if (category)
  {
    collectionViewData = self->_collectionViewData;
    if (category == 2)
    {
      [(UICollectionViewData *)collectionViewData layoutAttributesForDecorationViewOfKind:identifierCopy atIndexPath:pathCopy];
    }

    else
    {
      [(UICollectionViewData *)collectionViewData layoutAttributesForSupplementaryElementOfKind:kindCopy atIndexPath:pathCopy];
    }
    v13 = ;
    v65 = pathCopy;
LABEL_17:
    v20 = self->_subviewManager;
    v21 = [(_UICollectionViewSubviewManager *)v20 dequeueReusableViewWithReuseIdentifier:identifierCopy elementKind:kindCopy elementCategory:category];
    v22 = v74[5];
    v74[5] = v21;

    v23 = v74[5];
    if (v23)
    {
      if (v13)
      {
        [v74[5] _willRevealWithLayoutAttributes:v13];
        v23 = v74[5];
      }

      [(UICollectionView *)self _prepareViewForReuse:v23];
LABEL_49:
      if ((*(&self->_collectionViewFlags + 16) & 8) == 0)
      {
        v42 = v74[5];
        v66[0] = MEMORY[0x1E69E9820];
        v66[1] = 3221225472;
        v66[2] = __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke_2;
        v66[3] = &unk_1E70FF590;
        v70 = v42;
        v67 = v13;
        selfCopy = self;
        v71 = category == 0;
        v69 = v65;
        [UIView performWithoutAnimation:v66];
      }

      if (v20)
      {
        [(NSHashTable *)v20->_dequeuedViews addObject:v74[5]];
      }

      v43 = v74[5];
      v44 = self->_layout;
      v45 = v43;
      v46 = v45;
      if (!v44 || !v45)
      {
        goto LABEL_60;
      }

      effectiveUserInterfaceLayoutDirection = [v45 effectiveUserInterfaceLayoutDirection];
      if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v44 developmentLayoutDirection])
      {
        if (![v46 _flipsHorizontalAxis])
        {
LABEL_60:

          v18 = v74[5];
          goto LABEL_61;
        }

        _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
      }

      else
      {
        _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v44 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [v46 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
      goto LABEL_60;
    }

    if (category == 2)
    {
      v18 = 0;
LABEL_61:

      goto LABEL_62;
    }

    v24 = 8;
    if (!category)
    {
      v24 = 7;
    }

    v62 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v24]);
    if (category)
    {
      v25 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:kindCopy withReuseIdentifier:identifierCopy];
    }

    else
    {
      v25 = identifierCopy;
    }

    v61 = v25;
    v63 = [v62 objectForKey:v25];
    v59 = _UISetCurrentFallbackEnvironment(self);
    if (v63)
    {
      v26 = 6;
      if (!category)
      {
        v26 = 5;
      }

      v27 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v26]);
      v28 = [v27 objectForKey:v61];
      v58 = v28;
      if (v28)
      {
        v29 = [MEMORY[0x1E695DF20] dictionaryWithObject:v28 forKey:@"UINibExternalObjects"];
      }

      else
      {
        v29 = 0;
      }

      v57 = v29;
      v60 = [v63 instantiateWithOwner:0 options:v29];
      if ([v60 count] == 1)
      {
        v38 = [v60 objectAtIndex:0];
        v39 = v74[5];
        v74[5] = v38;
      }

      if (!v74[5] || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9731 description:{@"invalid nib registered for identifier (%@) - nib must contain exactly one top level object which must be a UICollectionReusableView instance", identifierCopy}];
      }

      reuseIdentifier = [v74[5] reuseIdentifier];
      if ([reuseIdentifier length] && (objc_msgSend(reuseIdentifier, "isEqualToString:", identifierCopy) & 1) == 0)
      {
        currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9733 description:{@"view reuse identifier in nib (%@) does not match the identifier used to register the nib (%@)", reuseIdentifier, identifierCopy}];
      }
    }

    else
    {
      v30 = 92;
      if (!category)
      {
        v30 = 91;
      }

      v27 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v30]);
      v31 = [v27 objectForKey:v61];
      [(UICollectionViewLayoutAttributes *)v13 frame];
      v33 = v32;
      v35 = v34;
      [(UICollectionViewLayoutAttributes *)v13 size];
      v72[0] = MEMORY[0x1E69E9820];
      v72[1] = 3221225472;
      v72[2] = __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke;
      v72[3] = &unk_1E70FF568;
      v72[4] = &v73;
      v72[5] = v31;
      v72[6] = v33;
      v72[7] = v35;
      v72[8] = v36;
      v72[9] = v37;
      [UIView performWithoutAnimation:v72];
    }

    _UIRestorePreviousFallbackEnvironment(v59);
    v41 = v74;
    if (v74[5])
    {
      if (!v13)
      {
LABEL_48:
        [(UICollectionView *)self _prepareViewForUse:v41[5] withElementCategory:category elementKind:kindCopy reuseIdentifier:identifierCopy indexPath:pathCopy applyDefaultAttributes:0];

        goto LABEL_49;
      }
    }

    else
    {
      currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9746 description:{@"could not dequeue a view of kind: %@ with identifier %@ - must register a nib or a class for the identifier or connect a prototype cell in a storyboard", kindCopy, identifierCopy}];

      v41 = v74;
      if (!v13)
      {
        goto LABEL_48;
      }
    }

    [v41[5] _willRevealWithLayoutAttributes:v13];
    v41 = v74;
    goto LABEL_48;
  }

  v65 = [(UICollectionView *)self presentationIndexPathForDataSourceIndexPath:pathCopy];

  v13 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v65];
LABEL_5:
  cellBeingReconfigured = self->_cellBeingReconfigured;
  if (!cellBeingReconfigured)
  {
    goto LABEL_17;
  }

  reuseIdentifier2 = [(UICollectionReusableView *)cellBeingReconfigured reuseIdentifier];
  v17 = [reuseIdentifier2 isEqualToString:identifierCopy];

  if ((v17 & 1) == 0)
  {
    currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
    reuseIdentifier3 = [(UICollectionReusableView *)self->_cellBeingReconfigured reuseIdentifier];
    [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9698 description:{@"Attempted to dequeue a cell for a different registration or reuse identifier than the existing cell when reconfiguring an item, which is not allowed. You must dequeue a cell using the same registration or reuse identifier that was used to dequeue the cell originally to obtain the existing cell. Dequeued reuse identifier: %@; Original reuse identifier: %@; Existing cell: %@", identifierCopy, reuseIdentifier3, self->_cellBeingReconfigured}];
  }

  if (([(NSIndexPath *)self->_indexPathBeingReconfigured isEqual:v65]& 1) == 0)
  {
    currentHandler5 = [MEMORY[0x1E696AAA8] currentHandler];
    v53 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:self->_indexPathBeingReconfigured];
    [currentHandler5 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9699 description:{@"Attempted to dequeue a cell for a different index path than the index path being reconfigured, which is not allowed. You must dequeue a cell for the same index path that is being reconfigured to obtain the existing cell. Dequeued index path: %@; Reconfigured index path: %@; Existing cell: %@", pathCopy, v53, self->_cellBeingReconfigured}];
  }

  v18 = self->_cellBeingReconfigured;
LABEL_62:

  _Block_object_dispose(&v73, 8);

  return v18;
}

void __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke(uint64_t a1)
{
  v2 = [objc_alloc(*(a1 + 40)) initWithFrame:{*(a1 + 48), *(a1 + 56), *(a1 + 64), *(a1 + 72)}];
  v3 = *(*(a1 + 32) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

uint64_t __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke_2(uint64_t a1)
{
  if (dyld_program_sdk_at_least())
  {
    v2 = 1;
  }

  else
  {
    v3 = [*(a1 + 56) _layoutAttributes];
    v4 = [v3 zIndex];
    v2 = v4 != [*(a1 + 32) zIndex];
  }

  result = [(UICollectionView *)*(a1 + 40) _applyLayoutAttributes:*(a1 + 56) toView:v2 addingControlledSubview:v2 forced:?];
  if (*(a1 + 64) == 1)
  {
    v6 = *(*(a1 + 40) + 2976);
    if (v6)
    {
      result = [*(v6 + 8) containsObject:*(a1 + 48)];
      if (result)
      {
        result = [*(a1 + 56) _setSelected:1 animated:0];
      }
    }

    v7 = *(*(a1 + 40) + 2976);
    if (v7)
    {
      result = [*(v7 + 16) containsObject:*(a1 + 48)];
      if (result)
      {
        v8 = *(a1 + 56);

        return [v8 _setHighlighted:1 animated:0];
      }
    }
  }

  return result;
}

- (UICollectionViewCell)dequeueReusableCellWithReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath
{
  v7 = identifier;
  if (![(NSString *)v7 length])
  {
    v10 = MEMORY[0x1E695DF30];
    v11 = *MEMORY[0x1E695D940];
    v12 = NSStringFromSelector(a2);
    [v10 raise:v11 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v12}];
  }

  v8 = [(UICollectionView *)self _dequeueReusableViewOfKind:@"UICollectionElementKindCell" withIdentifier:v7 forIndexPath:indexPath viewCategory:0];

  return v8;
}

- (id)_dequeueReusableCellWithRegistration:(id)registration forIndexPath:(id)path
{
  registrationCopy = registration;
  v7 = [(UICollectionView *)self _diffableIdentifierForIndexPath:path];
  v8 = [(UICollectionView *)self dequeueConfiguredReusableCellWithRegistration:registrationCopy forIndexPath:path item:v7];

  return v8;
}

- (UICollectionViewCell)dequeueConfiguredReusableCellWithRegistration:(UICollectionViewCellRegistration *)registration forIndexPath:(NSIndexPath *)indexPath item:(id)item
{
  v25 = *MEMORY[0x1E69E9840];
  v9 = registration;
  v10 = item;
  v11 = indexPath;
  if (dyld_program_sdk_at_least())
  {
    _collectionViewRequestingViewWhenCreated = [(UICollectionViewCellRegistration *)v9 _collectionViewRequestingViewWhenCreated];

    if (_collectionViewRequestingViewWhenCreated == self)
    {
      if (_UIIsPrivateMainBundle())
      {
        currentHandler = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(currentHandler, OS_LOG_TYPE_FAULT))
        {
          *buf = 138412290;
          v24 = v9;
          _os_log_fault_impl(&dword_188A29000, currentHandler, OS_LOG_TYPE_FAULT, "Attempted to dequeue a cell using a registration that was created inside -collectionView:cellForItemAtIndexPath: or inside a UICollectionViewDiffableDataSource cell provider. Creating a new registration each time a cell is requested will prevent reuse and cause created cells to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", buf, 0xCu);
        }
      }

      else
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9794 description:@"Attempted to dequeue a cell using a registration that was created inside -collectionView:cellForItemAtIndexPath: or inside a UICollectionViewDiffableDataSource cell provider. Creating a new registration each time a cell is requested will prevent reuse and cause created cells to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", v9];
      }
    }
  }

  reuseIdentifier = [(UICollectionViewCellRegistration *)v9 reuseIdentifier];
  if (![reuseIdentifier length])
  {
    currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9796 description:{@"UIKit internal inconsistency: registration missing reuse identifier %@", v9}];
  }

  if ([(UICollectionViewCellRegistration *)v9 hasCellClass])
  {
    v15 = [(NSMutableDictionary *)self->_cellClassDict objectForKeyedSubscript:reuseIdentifier];

    if (!v15)
    {
      [(UICollectionView *)self registerClass:[(UICollectionViewCellRegistration *)v9 cellClass] forCellWithReuseIdentifier:reuseIdentifier];
    }
  }

  else if ([(UICollectionViewCellRegistration *)v9 hasCellNib])
  {
    v16 = [(NSMutableDictionary *)self->_cellNibDict objectForKeyedSubscript:reuseIdentifier];

    if (!v16)
    {
      cellNib = [(UICollectionViewCellRegistration *)v9 cellNib];
      [(UICollectionView *)self registerNib:cellNib forCellWithReuseIdentifier:reuseIdentifier];
    }
  }

  else
  {
    currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9807 description:{@"Cell registration is invalid (no cell class or nib) %@", v9}];
  }

  v19 = [(UICollectionView *)self _dequeueReusableViewOfKind:@"UICollectionElementKindCell" withIdentifier:reuseIdentifier forIndexPath:v11 viewCategory:0];
  configurationHandler = [(UICollectionViewCellRegistration *)v9 configurationHandler];
  (configurationHandler)[2](configurationHandler, v19, v11, v10);

  return v19;
}

- (UICollectionReusableView)dequeueConfiguredReusableSupplementaryViewWithRegistration:(UICollectionViewSupplementaryRegistration *)registration forIndexPath:(NSIndexPath *)indexPath
{
  v29 = *MEMORY[0x1E69E9840];
  v7 = registration;
  v8 = indexPath;
  if (dyld_program_sdk_at_least())
  {
    _collectionViewRequestingViewWhenCreated = [(UICollectionViewSupplementaryRegistration *)v7 _collectionViewRequestingViewWhenCreated];

    if (_collectionViewRequestingViewWhenCreated == self)
    {
      if (_UIIsPrivateMainBundle())
      {
        currentHandler = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(currentHandler, OS_LOG_TYPE_FAULT))
        {
          *buf = 138412290;
          v28 = v7;
          _os_log_fault_impl(&dword_188A29000, currentHandler, OS_LOG_TYPE_FAULT, "Attempted to dequeue a supplementary view using a registration that was created inside -collectionView:viewForSupplementaryElementOfKind:atIndexPath: or inside a UICollectionViewDiffableDataSource supplementary view provider. Creating a new registration each time a supplementary view is requested will prevent reuse and cause created supplementary views to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", buf, 0xCu);
        }
      }

      else
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9822 description:@"Attempted to dequeue a supplementary view using a registration that was created inside -collectionView:viewForSupplementaryElementOfKind:atIndexPath: or inside a UICollectionViewDiffableDataSource supplementary view provider. Creating a new registration each time a supplementary view is requested will prevent reuse and cause created supplementary views to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", v7];
      }
    }
  }

  elementKind = [(UICollectionViewSupplementaryRegistration *)v7 elementKind];
  reuseIdentifier = [(UICollectionViewSupplementaryRegistration *)v7 reuseIdentifier];
  if (![elementKind length])
  {
    currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9825 description:{@"UIKit internal inconsistency: registration missing element kind %@", v7}];
  }

  if (![reuseIdentifier length])
  {
    currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9826 description:{@"UIKit internal inconsistency: registration missing reuse identifier %@", v7}];
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:elementKind withReuseIdentifier:reuseIdentifier];
  hasSupplementaryClass = [(UICollectionViewSupplementaryRegistration *)v7 hasSupplementaryClass];
  hasSupplementaryNib = [(UICollectionViewSupplementaryRegistration *)v7 hasSupplementaryNib];
  v16 = hasSupplementaryNib;
  if (hasSupplementaryClass || hasSupplementaryNib)
  {
    if (hasSupplementaryClass)
    {
      goto LABEL_15;
    }
  }

  else
  {
    currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9831 description:{@"Supplementary registration is invalid (no view class or nib) %@", v7}];

    if (hasSupplementaryClass)
    {
LABEL_15:
      v17 = [(NSMutableDictionary *)self->_supplementaryViewClassDict objectForKeyedSubscript:v13];

      if (!v17)
      {
        [(UICollectionView *)self registerClass:[(UICollectionViewSupplementaryRegistration *)v7 supplementaryClass] forSupplementaryViewOfKind:elementKind withReuseIdentifier:reuseIdentifier];
      }

      goto LABEL_20;
    }
  }

  v19 = [(NSMutableDictionary *)self->_supplementaryViewNibDict objectForKeyedSubscript:v13];
  v20 = v19 == 0;

  if (v20 && v16)
  {
    supplementaryNib = [(UICollectionViewSupplementaryRegistration *)v7 supplementaryNib];
    [(UICollectionView *)self registerNib:supplementaryNib forSupplementaryViewOfKind:elementKind withReuseIdentifier:reuseIdentifier];
  }

LABEL_20:
  v22 = [(UICollectionView *)self _dequeueReusableViewOfKind:elementKind withIdentifier:reuseIdentifier forIndexPath:v8 viewCategory:1];
  configurationHandler = [(UICollectionViewSupplementaryRegistration *)v7 configurationHandler];
  (configurationHandler)[2](configurationHandler, v22, elementKind, v8);

  return v22;
}

- (UICollectionReusableView)dequeueReusableSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath
{
  v9 = elementKind;
  v10 = identifier;
  if (![(NSString *)v9 length])
  {
    v13 = MEMORY[0x1E695DF30];
    v14 = *MEMORY[0x1E695D940];
    v15 = NSStringFromSelector(a2);
    [v13 raise:v14 format:{@"must pass a valid element kind to -[UICollectionView %@]", v15}];
  }

  if (![(NSString *)v10 length])
  {
    v16 = MEMORY[0x1E695DF30];
    v17 = *MEMORY[0x1E695D940];
    v18 = NSStringFromSelector(a2);
    [v16 raise:v17 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v18}];
  }

  v11 = [(UICollectionView *)self _dequeueReusableViewOfKind:v9 withIdentifier:v10 forIndexPath:indexPath viewCategory:1];

  return v11;
}

- (void)_cacheOrReuseCell:(id)cell forIndexPath:(id)path invalidatePreferredAttributes:(BOOL)attributes notifyDidEndDisplaying:(BOOL)displaying
{
  displayingCopy = displaying;
  attributesCopy = attributes;
  v44 = *MEMORY[0x1E69E9840];
  cellCopy = cell;
  pathCopy = path;
  if (!cellCopy)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9863 description:{@"Invalid parameter not satisfying: %@", @"cell != nil"}];
  }

  if (os_variant_has_internal_diagnostics())
  {
    if (!pathCopy)
    {
      v27 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v27, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        selfCopy = cellCopy;
        _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", buf, 0xCu);
      }
    }
  }

  else if (!pathCopy)
  {
    v28 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924E8) + 8);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      selfCopy = cellCopy;
      _os_log_impl(&dword_188A29000, v28, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", buf, 0xCu);
    }
  }

  if (([(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:cellCopy]& 1) == 0)
  {
    subviewManager = self->_subviewManager;
    if (!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:cellCopy]& 1) == 0)
    {
      if (pathCopy && [(UICollectionView *)self _prefetchingAllowed]&& [(UICollectionView *)self _indexPathIsValid:pathCopy])
      {
        _focusedItemState = [(UICollectionView *)self _focusedItemState];
        v15 = _focusedItemState;
        if (_focusedItemState)
        {
          v16 = *(_focusedItemState + 8);
        }

        else
        {
          v16 = 0;
        }

        v17 = v16;
        v18 = v17;
        if (v17 == cellCopy || self->_firstResponderView == cellCopy || (*(&self->_collectionViewFlags + 11) & 0x40) != 0)
        {
        }

        else
        {
          v19 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:cellCopy atIndexPath:pathCopy];

          if (!v19)
          {
            v20 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:pathCopy];

            if (!v20)
            {
              v21 = [_UICollectionViewPrefetchItem alloc];
              _layoutAttributes = [(UICollectionReusableView *)cellCopy _layoutAttributes];
              v23 = [(_UICollectionViewPrefetchItem *)&v21->super.isa initWithAttributes:_layoutAttributes];

              [(_UIHomeAffordanceObservationRecord *)v23 setLegacyViewServiceSessionIdentifier:cellCopy];
              if (attributesCopy && v23)
              {
                *(v23 + 8) |= 3u;
              }

              [(UICollectionReusableView *)cellCopy _setHiddenForReuse:1];
              [(NSMutableDictionary *)self->_prefetchCacheItems setObject:v23 forKeyedSubscript:pathCopy];
              CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4924F0);
              if (*CategoryCachedImpl)
              {
                v29 = *(CategoryCachedImpl + 8);
                if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
                {
                  v30 = v29;
                  _ui_shortDescription = [pathCopy _ui_shortDescription];
                  v32 = [MEMORY[0x1E696AD98] numberWithBool:attributesCopy];
                  _layoutAttributes2 = [(UICollectionReusableView *)cellCopy _layoutAttributes];
                  *buf = 134219010;
                  selfCopy = self;
                  v36 = 2112;
                  v37 = cellCopy;
                  v38 = 2112;
                  v39 = _ui_shortDescription;
                  v40 = 2112;
                  v41 = v32;
                  v42 = 2112;
                  v43 = _layoutAttributes2;
                  _os_log_impl(&dword_188A29000, v30, OS_LOG_TYPE_ERROR, "[UICV %p] _cacheOrReuseCell:%@ indexPath:%@ invalidatePreferredAttrs:%@ cellAttrs: %@", buf, 0x34u);
                }
              }

              if (displayingCopy)
              {
                [(UICollectionView *)self _notifyDidEndDisplayingCellIfNeeded:cellCopy forIndexPath:pathCopy];
              }

              goto LABEL_30;
            }
          }
        }
      }

      if (![(UICollectionView *)self _reuseCell:cellCopy notifyDidEndDisplaying:displayingCopy])
      {
        if (dyld_program_sdk_at_least())
        {
          superview = [(UIView *)cellCopy superview];

          if (superview)
          {
            [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:cellCopy atIndexPath:pathCopy];
          }
        }
      }
    }
  }

LABEL_30:
}

- (BOOL)_reuseCell:(id)cell notifyDidEndDisplaying:(BOOL)displaying
{
  displayingCopy = displaying;
  v60 = *MEMORY[0x1E69E9840];
  cellCopy = cell;
  if (![(UICollectionReusableView *)cellCopy _isBeingReused])
  {
    if ([(UICollectionReusableView *)cellCopy _isInUpdateAnimation])
    {
      v10 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4924F8) + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        selfCopy3 = cellCopy;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "Cell (%@) is currently in an update animation and cannot be reused, ignoring.", buf, 0xCu);
      }

      goto LABEL_2;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      NSLog(&cfstr_ReusecellShoul.isa, cellCopy);
      v8 = 0;
      goto LABEL_3;
    }

    if ([(UICollectionReusableView *)cellCopy _isInUpdateAnimation])
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9948 description:{@"attempting to reuse a cell that's still in an update animation: %@", cellCopy}];
    }

    v49 = 0u;
    v50 = 0u;
    v47 = 0u;
    v48 = 0u;
    _reorderedItems = [(UICollectionView *)self _reorderedItems];
    v12 = [_reorderedItems countByEnumeratingWithState:&v47 objects:v59 count:16];
    if (v12)
    {
      v13 = v12;
      v14 = *v48;
      while (2)
      {
        for (i = 0; i != v13; ++i)
        {
          if (*v48 != v14)
          {
            objc_enumerationMutation(_reorderedItems);
          }

          cell = [*(*(&v47 + 1) + 8 * i) cell];

          if (cell == cellCopy)
          {
            v17 = 1;
            goto LABEL_21;
          }
        }

        v13 = [_reorderedItems countByEnumeratingWithState:&v47 objects:v59 count:16];
        if (v13)
        {
          continue;
        }

        break;
      }
    }

    v17 = 0;
LABEL_21:

    _layoutAttributes = [(UICollectionReusableView *)cellCopy _layoutAttributes];
    indexPath = [_layoutAttributes indexPath];

    if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:cellCopy atIndexPath:indexPath])
    {
      if (cellCopy)
      {
        dragAndDropController = self->_dragAndDropController;
        if (dragAndDropController)
        {
          [(NSMutableSet *)dragAndDropController->_cellsDeferredForReuse addObject:cellCopy];
        }
      }

      CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492500);
      if ((*CategoryCachedImpl & 1) == 0)
      {
        goto LABEL_26;
      }

      v36 = *(CategoryCachedImpl + 8);
      if (!os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_26;
      }

      v31 = v36;
      _ui_shortDescription = [indexPath _ui_shortDescription];
      *buf = 134218498;
      selfCopy3 = self;
      v53 = 2112;
      v54 = _ui_shortDescription;
      v55 = 2112;
      *v56 = cellCopy;
      _os_log_impl(&dword_188A29000, v31, OS_LOG_TYPE_ERROR, "[UICV %p] _reuseCell transfering ownership of cell at %@ to drag and drop controller: %@ ", buf, 0x20u);

LABEL_46:
LABEL_26:
      v8 = 1;
LABEL_43:

      goto LABEL_3;
    }

    if ((v17 & 1) != 0 || self->_firstResponderView == cellCopy || (([(UICollectionView *)self _focusedItemState], v22 = objc_claimAutoreleasedReturnValue(), (v23 = v22) == 0) ? (v24 = 0) : (v24 = *(v22 + 8)), v25 = v24, v25, v23, v25 == cellCopy))
    {
      v34 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492508);
      if (*v34)
      {
        v38 = v17;
        v39 = *(v34 + 8);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
        {
          v40 = v39;
          _ui_shortDescription2 = [indexPath _ui_shortDescription];
          v42 = self->_firstResponderView == cellCopy;
          _focusedItemState = [(UICollectionView *)self _focusedItemState];
          v44 = _focusedItemState;
          if (_focusedItemState)
          {
            v45 = *(_focusedItemState + 8);
          }

          else
          {
            v45 = 0;
          }

          v46 = v45;
          *buf = 134219266;
          selfCopy3 = self;
          v53 = 2112;
          v54 = _ui_shortDescription2;
          v55 = 1024;
          *v56 = v38;
          *&v56[4] = 1024;
          *&v56[6] = v42;
          LOWORD(v57) = 1024;
          *(&v57 + 2) = v46 == cellCopy;
          HIWORD(v57) = 2112;
          v58 = cellCopy;
          _os_log_impl(&dword_188A29000, v40, OS_LOG_TYPE_ERROR, "[UICV %p] Denying reuse on cell at %@ for reason reordered(%d) isFirstReponder(%d) isFocused(%d): %@", buf, 0x32u);
        }
      }
    }

    else if ((dyld_program_sdk_at_least() & 1) != 0 || ![(UIView *)cellCopy _isFocusedOrAncestorOfFocusedView])
    {
      [(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers removeObject:cellCopy];
      [(UICollectionReusableView *)cellCopy _setIsBeingReused:1];
      if (dyld_program_sdk_at_least())
      {
        _focusSystem = [(UIView *)cellCopy _focusSystem];
        [_focusSystem _focusEnvironmentWillDisappear:cellCopy];
      }

      [(UICollectionView *)self _enqueueViewForReuse:cellCopy];
      if (displayingCopy)
      {
        _layoutAttributes2 = [(UICollectionReusableView *)cellCopy _layoutAttributes];
        indexPath2 = [_layoutAttributes2 indexPath];
        [(UICollectionView *)self _notifyDidEndDisplayingCellIfNeeded:cellCopy forIndexPath:indexPath2];
      }

      [(UICollectionReusableView *)cellCopy _setIsBeingReused:0];
      v29 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492510);
      if ((*v29 & 1) == 0)
      {
        goto LABEL_26;
      }

      v30 = *(v29 + 8);
      if (!os_log_type_enabled(v30, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_26;
      }

      v31 = v30;
      reuseIdentifier = [(UICollectionReusableView *)cellCopy reuseIdentifier];
      _ui_shortDescription3 = [indexPath _ui_shortDescription];
      *buf = 134218754;
      selfCopy3 = self;
      v53 = 2112;
      v54 = cellCopy;
      v55 = 2112;
      *v56 = reuseIdentifier;
      *&v56[8] = 2112;
      v57 = _ui_shortDescription3;
      _os_log_impl(&dword_188A29000, v31, OS_LOG_TYPE_ERROR, "[UICV %p] _reuseCell: %@ reuseIdentifier: %@ indexPath:%@", buf, 0x2Au);

      goto LABEL_46;
    }

    v8 = 0;
    goto LABEL_43;
  }

LABEL_2:
  v8 = 1;
LABEL_3:

  return v8;
}

- (BOOL)_reuseSupplementaryView:(id)view
{
  viewCopy = view;
  if ([(UICollectionReusableView *)viewCopy _isInUpdateAnimation])
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10006 description:{@"attempting to reuse a view that's still in an update animation: %@", viewCopy}];
  }

  if (self->_firstResponderView != viewCopy)
  {
    _focusedItemState = [(UICollectionView *)self _focusedItemState];
    v7 = _focusedItemState;
    v8 = _focusedItemState ? *(_focusedItemState + 8) : 0;
    v9 = v8;

    if (v9 != viewCopy)
    {
      if (dyld_program_sdk_at_least())
      {
        _focusSystem = [(UIView *)viewCopy _focusSystem];
        [_focusSystem _focusEnvironmentWillDisappear:viewCopy];

LABEL_11:
        [(UICollectionView *)self _enqueueViewForReuse:viewCopy];
        [(UICollectionView *)self _notifyDidEndDisplayingSupplementaryView:viewCopy];
        v11 = 1;
        goto LABEL_12;
      }

      if (![(UIView *)viewCopy _isFocusedOrAncestorOfFocusedView])
      {
        goto LABEL_11;
      }
    }
  }

  v11 = 0;
LABEL_12:

  return v11;
}

- (void)_enqueueViewForReuse:(id)reuse
{
  subviewManager = self->_subviewManager;
  reuseCopy = reuse;
  if ([(_UICollectionViewSubviewManager *)subviewManager enqueueViewForReuse:reuseCopy])
  {
    [reuseCopy _setHiddenForReuse:1];
  }

  else
  {
    [reuseCopy removeFromSuperview];
  }
}

- (id)_reusableViewWithoutAttributesForElementCategory:(unint64_t)category kind:(id)kind indexPath:(id)path
{
  kindCopy = kind;
  pathCopy = path;
  v10 = *(&self->_collectionViewFlags + 4) | 8;
  *(&self->_collectionViewFlags + 4) = v10;
  if (category == 1)
  {
    _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
    v12 = [_dataSourceProxy collectionView:self viewForSupplementaryElementOfKind:kindCopy atIndexPath:pathCopy];
    goto LABEL_5;
  }

  if (!category)
  {
    _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
    v12 = [_dataSourceProxy collectionView:self cellForItemAtIndexPath:pathCopy];
LABEL_5:
    v13 = v12;

    v10 = *(&self->_collectionViewFlags + 4);
    goto LABEL_7;
  }

  v13 = 0;
LABEL_7:
  *(&self->_collectionViewFlags + 4) = v10 & 0xFFFFFFF7;
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(NSHashTable *)subviewManager->_dequeuedViews removeObject:v13];
  }

  return v13;
}

- (id)_arrayForUpdateAction:(int)action
{
  v3 = 0;
  if (action > 1)
  {
    if (action == 2)
    {
      v4 = 2440;
    }

    else
    {
      if (action != 3)
      {
        goto LABEL_13;
      }

      v4 = 2448;
    }
  }

  else if (action)
  {
    if (action != 1)
    {
      goto LABEL_13;
    }

    v4 = 2432;
  }

  else
  {
    v4 = 2424;
  }

  v5 = (&self->super.super.super.super.isa + v4);
  v6 = *(&self->super.super.super.super.isa + v4);
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v8 = *v5;
    *v5 = v7;

    v6 = *v5;
  }

  v3 = v6;
LABEL_13:

  return v3;
}

- (void)_updateSections:(id)sections updateAction:(int)action
{
  v4 = *&action;
  sectionsCopy = sections;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10153 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  [(UICollectionView *)self _reloadDataIfNeeded];
  v8 = *(&self->_collectionViewFlags + 1);
  if ((v8 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
  }

  v9 = [(UICollectionView *)self _arrayForUpdateAction:v4];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __49__UICollectionView__updateSections_updateAction___block_invoke;
  v12[3] = &unk_1E70FF5D8;
  v14 = v4;
  v10 = v9;
  v13 = v10;
  [sectionsCopy enumerateIndexesUsingBlock:v12];
  if ((v8 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
  }
}

void __49__UICollectionView__updateSections_updateAction___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = [UICollectionViewUpdateItem alloc];
  v5 = *(a1 + 40);
  v6 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:a2];
  v7 = [(UICollectionViewUpdateItem *)v4 initWithAction:v5 forIndexPath:v6];

  [*(a1 + 32) addObject:v7];
}

- (void)insertSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections allowingAppendingInserts:1];
  [(UICollectionView *)self _updateSections:v4 updateAction:0];
}

- (void)deleteSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections];
  [(UICollectionView *)self _updateSections:v4 updateAction:1];
}

- (void)reloadSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections];
  [(UICollectionView *)self _updateSections:v4 updateAction:2];
}

- (void)moveSection:(NSInteger)section toSection:(NSInteger)newSection
{
  if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10192 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v8 = [(UICollectionView *)self presentationSectionIndexForDataSourceSectionIndex:section];
  v9 = [(UICollectionView *)self presentationSectionIndexForDataSourceSectionIndex:newSection];

  [(UICollectionView *)self _moveSection:v8 toSection:v9];
}

- (void)_moveSection:(int64_t)section toSection:(int64_t)toSection
{
  v11 = [(UICollectionView *)self _arrayForUpdateAction:3];
  v7 = [UICollectionViewUpdateItem alloc];
  v8 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:section];
  v9 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:toSection];
  v10 = [(UICollectionViewUpdateItem *)v7 initWithInitialIndexPath:v8 finalIndexPath:v9 updateAction:3];

  [v11 addObject:v10];
  if ((*(&self->_collectionViewFlags + 12) & 0x10) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
  }
}

- (void)_updateWithUpdates:(id)updates updateAction:(int64_t)action
{
  updatesCopy = updates;
  v6 = [updatesCopy count];
  if (action != 4 && v6)
  {
    [(UICollectionView *)self _updateRowsAtIndexPaths:0 updateAction:action updates:updatesCopy];
  }
}

- (void)_updateRowsAtIndexPaths:(id)paths updateAction:(int)action updates:(id)updates
{
  v6 = *&action;
  pathsCopy = paths;
  updatesCopy = updates;
  v10 = *(&self->_collectionViewFlags + 1);
  if ((v10 & 0x2000000000) == 0)
  {
    if ((v10 & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10230 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
    }

    v11 = [(UICollectionView *)self _arrayForUpdateAction:v6];
    v20 = 0;
    v21 = &v20;
    v22 = 0x2020000000;
    v23 = 0;
    if ([updatesCopy count])
    {
      [v11 addObjectsFromArray:updatesCopy];
      v19[0] = MEMORY[0x1E69E9820];
      v19[1] = 3221225472;
      v19[2] = __65__UICollectionView__updateRowsAtIndexPaths_updateAction_updates___block_invoke;
      v19[3] = &unk_1E70FD008;
      v19[4] = self;
      v19[5] = &v20;
      [updatesCopy enumerateObjectsUsingBlock:v19];
    }

    else
    {
      v13 = [pathsCopy count];
      if (v13)
      {
        v14 = 0;
        while (1)
        {
          v15 = [pathsCopy objectAtIndex:v14];
          v16 = [[UICollectionViewUpdateItem alloc] initWithAction:v6 forIndexPath:v15];
          if (![(UICollectionView *)self _addUpdateToShadowControllerIfNeeded:v16])
          {
            break;
          }

          [v11 addObject:v16];

          if (v13 == ++v14)
          {
            goto LABEL_7;
          }
        }

        *(v21 + 24) = 1;
      }
    }

LABEL_7:
    if (*(v21 + 24) == 1)
    {
      v12 = *(&self->_collectionViewFlags + 1);
      if ((v12 & 0x1000000000) != 0)
      {
        *(&self->_collectionViewFlags + 1) = v12 | 0x2000000000;
      }

      else
      {
        [(UICollectionView *)self reloadData];
      }
    }

    else
    {
      [(UICollectionView *)self _reloadDataIfNeeded];
      if ((*(&self->_collectionViewFlags + 12) & 0x10) == 0)
      {
        [(UICollectionView *)self _setupCellAnimations];
        [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
      }
    }

    _Block_object_dispose(&v20, 8);
  }
}

uint64_t __65__UICollectionView__updateRowsAtIndexPaths_updateAction_updates___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  result = [*(a1 + 32) _addUpdateToShadowControllerIfNeeded:a2];
  if ((result & 1) == 0)
  {
    *(*(*(a1 + 40) + 8) + 24) = 1;
    *a4 = 1;
  }

  return result;
}

- (void)insertItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths allowingAppendingInserts:1];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:0];
}

- (void)deleteItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:1];
}

- (void)reloadItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:2];
}

- (void)moveItemAtIndexPath:(NSIndexPath *)indexPath toIndexPath:(NSIndexPath *)newIndexPath
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10298 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v10 = [(UICollectionView *)self _indexPathAfterShadowUpdatesForIndexPath:indexPath];
  v7 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:newIndexPath allowingAppendingInserts:[(NSIndexPath *)indexPath section]!= [(NSIndexPath *)newIndexPath section]];
  [(UICollectionView *)self _moveItemAtIndexPath:v10 toIndexPath:v7];
}

- (void)_moveItemAtIndexPath:(id)path toIndexPath:(id)indexPath
{
  v10 = [(UICollectionView *)self _arrayForUpdateAction:3];
  v7 = [[UICollectionViewUpdateItem alloc] initWithInitialIndexPath:path finalIndexPath:indexPath updateAction:3];
  [v10 addObject:v7];
  v8 = [(UICollectionView *)self _addUpdateToShadowControllerIfNeeded:v7];
  v9 = *(&self->_collectionViewFlags + 1);
  if (v8)
  {
    if ((v9 & 0x1000000000) == 0)
    {
      [(UICollectionView *)self _setupCellAnimations];
      [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
    }
  }

  else if ((v9 & 0x1000000000) != 0)
  {
    *(&self->_collectionViewFlags + 1) = v9 | 0x2000000000;
  }

  else
  {
    [(UICollectionView *)self reloadData];
  }
}

- (void)reconfigureItemsAtIndexPaths:(NSArray *)indexPaths
{
  v5 = indexPaths;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10330 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v6 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:v5];
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __49__UICollectionView_reconfigureItemsAtIndexPaths___block_invoke;
  aBlock[3] = &unk_1E70F35B8;
  v8 = v6;
  v14 = v8;
  selfCopy = self;
  v9 = _Block_copy(aBlock);
  if (!+[UIView areAnimationsEnabled])
  {
    v9[2](v9);
    if ((v7 & 0x1000000000) != 0)
    {
      goto LABEL_12;
    }

LABEL_11:
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
    goto LABEL_12;
  }

  reconfigureAnimator = self->_reconfigureAnimator;
  if (reconfigureAnimator)
  {
    [(UIViewPropertyAnimator *)reconfigureAnimator addAnimations:v9];
    if ((v7 & 0x1000000000) != 0)
    {
      goto LABEL_12;
    }

    goto LABEL_11;
  }

  if (dyld_program_sdk_at_least())
  {
    v11 = 6;
  }

  else
  {
    v11 = 4;
  }

  [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v11 options:v9 animations:0 completion:?];
  if ((v7 & 0x1000000000) == 0)
  {
    goto LABEL_11;
  }

LABEL_12:
}

void __49__UICollectionView_reconfigureItemsAtIndexPaths___block_invoke(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  v7 = 0u;
  v8 = 0u;
  v9 = 0u;
  v10 = 0u;
  v2 = *(a1 + 32);
  v3 = [v2 countByEnumeratingWithState:&v7 objects:v11 count:16];
  if (v3)
  {
    v4 = v3;
    v5 = *v8;
    do
    {
      v6 = 0;
      do
      {
        if (*v8 != v5)
        {
          objc_enumerationMutation(v2);
        }

        [*(a1 + 40) _reconfigureItemAtIndexPath:{*(*(&v7 + 1) + 8 * v6++), v7}];
      }

      while (v4 != v6);
      v4 = [v2 countByEnumeratingWithState:&v7 objects:v11 count:16];
    }

    while (v4);
  }
}

- (void)_reconfigureItemAtIndexPath:(id)path
{
  pathCopy = path;
  v14 = pathCopy;
  if (!pathCopy)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10363 description:{@"Invalid parameter not satisfying: %@", @"indexPath != nil"}];

    pathCopy = 0;
  }

  v6 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:pathCopy];
  v7 = v6;
  if (v6)
  {
    v8 = *(v6 + 24);
    if (v8)
    {
      v9 = v8;
      v10 = *(v7 + 16);
      if (v10)
      {
        v11 = v10[72];

        if (v11)
        {
          *(v7 + 8) |= 4u;
          goto LABEL_10;
        }
      }

      else
      {
      }
    }
  }

  v12 = [(UICollectionView *)self _cellForItemAtIndexPath:v14];
  if (v12)
  {
    [(UICollectionView *)self _reconfigureCell:v12 forItemAtIndexPath:v14];
  }

LABEL_10:
}

- (void)_reconfigureCell:(id)cell forItemAtIndexPath:(id)path
{
  cellCopy = cell;
  pathCopy = path;
  v10 = pathCopy;
  if (cellCopy)
  {
    if (pathCopy)
    {
      goto LABEL_3;
    }
  }

  else
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10384 description:{@"Invalid parameter not satisfying: %@", @"cell != nil"}];

    if (v10)
    {
      goto LABEL_3;
    }
  }

  currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
  [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10385 description:{@"Invalid parameter not satisfying: %@", @"indexPath != nil"}];

LABEL_3:
  if (self->_cellBeingReconfigured)
  {
    currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
    v23 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:v10];
    cellBeingReconfigured = self->_cellBeingReconfigured;
    v24 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:self->_indexPathBeingReconfigured];
    [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10388 description:{@"Attempted to reconfigure a cell while already in the process of reconfiguring a cell. Check the backtrace to see what's causing this. (Attempted to reconfigure cell %@ for index path %@ while already reconfiguring cell %@ for index path %@)", cellCopy, v23, cellBeingReconfigured, v24}];
  }

  objc_storeStrong(&self->_cellBeingReconfigured, cell);
  objc_storeStrong(&self->_indexPathBeingReconfigured, path);
  v11 = _UISetCurrentFallbackEnvironment(self);
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492518);
  v13 = *(CategoryCachedImpl + 8);
  if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v13))
  {
    [v10 section];
    [v10 item];
    _os_signpost_emit_unreliably_with_name_impl();
  }

  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  if (!WeakRetained)
  {
    currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10394 description:{@"UICollectionView dataSource is not set: %@", self}];
  }

  _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
  v16 = [_dataSourceProxy collectionView:self cellForItemAtIndexPath:v10];

  if (v16 != cellCopy)
  {
    currentHandler5 = [MEMORY[0x1E696AAA8] currentHandler];
    v27 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:v10];
    [currentHandler5 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10396 description:{@"UICollectionView dataSource returned a different cell from -collectionView:cellForItemAtIndexPath: than the cell being reconfigured, which is not allowed. When reconfiguring an item, you must obtain the existing cell by dequeuing a cell for the index path specified, using the same registration or reuse identifier that was used to dequeue the cell originally, and return the same cell. Index path: %@; Existing cell: %@; Returned cell: %@", v27, cellCopy, v16}];
  }

  v17 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492520);
  v18 = *(v17 + 8);
  if (os_signpost_id_make_with_pointer(*(v17 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v18))
  {
    _os_signpost_emit_unreliably_with_name_impl();
  }

  _UIRestorePreviousFallbackEnvironment(v11);
  v19 = self->_cellBeingReconfigured;
  self->_cellBeingReconfigured = 0;

  indexPathBeingReconfigured = self->_indexPathBeingReconfigured;
  self->_indexPathBeingReconfigured = 0;
}

- (void)_endItemAnimationsWithInvalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator collectionViewAnimator:(id)viewAnimator
{
  reorderingCopy = reordering;
  v365 = *MEMORY[0x1E69E9840];
  contextCopy = context;
  animatorCopy = animator;
  viewAnimatorCopy = viewAnimator;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492528);
  v11 = *(CategoryCachedImpl + 8);
  v12 = os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self);
  if (v12 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v13 = v12;
    if (os_signpost_enabled(v11))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v11, OS_SIGNPOST_INTERVAL_BEGIN, v13, "BatchUpdates", "", buf, 2u);
    }
  }

  v278 = _UISetCurrentFallbackEnvironment(self);
  if (dyld_program_sdk_at_least())
  {
    if (!contextCopy)
    {
      contextCopy = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    }

    [contextCopy _setIntent:8];
  }

  if (dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _resetAllPrefetchContexts];
  }

  else
  {
    [(UICollectionView *)self _resetPrefetchState];
  }

  ++self->_updateCount;
  v14 = *MEMORY[0x1E695F050];
  v15 = *(MEMORY[0x1E695F050] + 8);
  v16 = *(MEMORY[0x1E695F050] + 16);
  v17 = *(MEMORY[0x1E695F050] + 24);
  v18 = *(&self->_collectionViewFlags + 1);
  v281 = contextCopy;
  p_collectionViewFlags = &self->_collectionViewFlags;
  if ((~*(&self->_collectionViewFlags + 2) & 0x40000010) == 0)
  {
    if (dyld_program_sdk_at_least())
    {
      goto LABEL_118;
    }

    v18 = *(&self->_collectionViewFlags + 1);
  }

  if ((v18 & 0x2000000000) != 0)
  {
LABEL_118:
    v101 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492530);
    if (*v101)
    {
      v262 = *(v101 + 8);
      if (os_log_type_enabled(v262, OS_LOG_TYPE_ERROR))
      {
        v263 = *(&self->_collectionViewFlags + 1);
        *buf = 134218496;
        selfCopy2 = self;
        v359 = 1024;
        *v360 = (v263 >> 30) & 1;
        *&v360[4] = 1024;
        *&v360[6] = (v263 >> 37) & 1;
        _os_log_impl(&dword_188A29000, v262, OS_LOG_TYPE_ERROR, "_endItemAnimations: cv == %p; ignoring batch updates. needsReload: %d; ignoreBatchUpdatesAndFallBackToReloadData: %d", buf, 0x18u);
      }
    }

    *(&self->_collectionViewFlags + 1) &= ~0x2000000000uLL;
    [(UICollectionView *)self _resetUpdateItemArrays];
    v102 = 0;
    goto LABEL_373;
  }

  v19 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492538);
  if (*v19)
  {
    v264 = *(v19 + 8);
    if (os_log_type_enabled(v264, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy2 = self;
      _os_log_impl(&dword_188A29000, v264, OS_LOG_TYPE_ERROR, "_endItemAnimations: cv == %p; processing batch update", buf, 0xCu);
    }
  }

  if (self->_deleteItems)
  {
    v20 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492540);
    if (*v20)
    {
      v265 = *(v20 + 8);
      if (os_log_type_enabled(v265, OS_LOG_TYPE_ERROR))
      {
        deleteItems = self->_deleteItems;
        *buf = 138412290;
        selfCopy2 = deleteItems;
        _os_log_impl(&dword_188A29000, v265, OS_LOG_TYPE_ERROR, "Deleting: %@", buf, 0xCu);
      }
    }
  }

  if (self->_insertItems)
  {
    v21 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492548);
    if (*v21)
    {
      v267 = *(v21 + 8);
      if (os_log_type_enabled(v267, OS_LOG_TYPE_ERROR))
      {
        insertItems = self->_insertItems;
        *buf = 138412290;
        selfCopy2 = insertItems;
        _os_log_impl(&dword_188A29000, v267, OS_LOG_TYPE_ERROR, "Inserting: %@", buf, 0xCu);
      }
    }
  }

  if (self->_reloadItems)
  {
    v22 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492550);
    if (*v22)
    {
      v269 = *(v22 + 8);
      if (os_log_type_enabled(v269, OS_LOG_TYPE_ERROR))
      {
        reloadItems = self->_reloadItems;
        *buf = 138412290;
        selfCopy2 = reloadItems;
        _os_log_impl(&dword_188A29000, v269, OS_LOG_TYPE_ERROR, "Reloading: %@", buf, 0xCu);
      }
    }
  }

  if (self->_moveItems)
  {
    v23 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492558);
    if (*v23)
    {
      v271 = *(v23 + 8);
      if (os_log_type_enabled(v271, OS_LOG_TYPE_ERROR))
      {
        moveItems = self->_moveItems;
        *buf = 138412290;
        selfCopy2 = moveItems;
        _os_log_impl(&dword_188A29000, v271, OS_LOG_TYPE_ERROR, "Moving: %@", buf, 0xCu);
      }
    }
  }

  _focusSystem = [(UIView *)self _focusSystem];
  focusedItem = [_focusSystem focusedItem];

  v275 = focusedItem;
  v26 = _UIFocusEnvironmentContainingView(focusedItem);
  if ([v26 isDescendantOfView:self])
  {
    [v26 bounds];
    [v26 convertRect:self toView:?];
    v14 = v27;
    v15 = v28;
    v16 = v29;
    v17 = v30;
  }

  v274 = v26;
  v31 = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  [(UICollectionViewData *)v31 validateLayoutInRectImmediatelyValidatingContentSizeIgnoringSpecificInvalidations:v32, v33, v34, v35];
  if (v31)
  {
    *&v31->_collectionViewDataFlags |= 0x10u;
  }

  v277 = v31;
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  v36 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
  collectionViewData = self->_collectionViewData;
  self->_collectionViewData = v36;

  v38 = [(UICollectionView *)self _arrayForUpdateAction:1];
  v39 = [v38 sortedArrayUsingSelector:?];

  v40 = [(UICollectionView *)self _arrayForUpdateAction:0];
  v41 = [v40 sortedArrayUsingSelector:?];

  _sortedDeduplicatedReloadItems = [(UICollectionView *)self _sortedDeduplicatedReloadItems];
  v43 = [(NSMutableArray *)self->_moveItems sortedArrayUsingSelector:sel_compareIndexPathsForMoves_];
  v285 = [v43 mutableCopy];

  v289 = v39;
  v44 = [v39 copy];
  originalDeleteItems = self->_originalDeleteItems;
  self->_originalDeleteItems = v44;

  v287 = v41;
  v46 = [v41 copy];
  originalInsertItems = self->_originalInsertItems;
  self->_originalInsertItems = v46;

  v313 = [(UICollectionView *)self _sectionsWithSectionOperationsInUpdateItems:?];
  v314 = [(UICollectionView *)self _sectionsWithSectionOperationsInUpdateItems:?];
  v297 = dyld_program_sdk_at_least();
  v349 = 0u;
  v350 = 0u;
  v351 = 0u;
  v352 = 0u;
  obj = _sortedDeduplicatedReloadItems;
  selfCopy3 = self;
  v299 = [obj countByEnumeratingWithState:&v349 objects:v364 count:16];
  if (v299)
  {
    v294 = *v350;
    do
    {
      v48 = 0;
      do
      {
        if (*v350 != v294)
        {
          objc_enumerationMutation(obj);
        }

        v49 = *(*(&v349 + 1) + 8 * v48);
        _indexPath = [(UICollectionViewUpdateItem *)v49 _indexPath];
        if (v49)
        {
          v307 = v49[2];
          v309 = v49[1];
          if (((v49[6] != 0x7FFFFFFFFFFFFFFFLL) & v297) != 0)
          {
            goto LABEL_35;
          }
        }

        else
        {
          v307 = 0;
          v309 = 0;
          if (v297)
          {
LABEL_35:
            v51 = [(UICollectionView *)self _cellForItemAtIndexPath:_indexPath];

            if (!v51)
            {
              goto LABEL_100;
            }
          }
        }

        v303 = v48;
        v347 = 0u;
        v348 = 0u;
        v345 = 0u;
        v346 = 0u;
        v318 = v289;
        v52 = [v318 countByEnumeratingWithState:&v345 objects:v363 count:16];
        v53 = v309;
        v315 = v307;
        if (!v52)
        {
          goto LABEL_70;
        }

        v54 = v52;
        v55 = *v346;
        v53 = v309;
        v315 = v307;
        do
        {
          v56 = 0;
          do
          {
            if (*v346 != v55)
            {
              objc_enumerationMutation(v318);
            }

            v57 = *(*(&v345 + 1) + 8 * v56);
            _indexPath2 = [(UICollectionViewUpdateItem *)v57 _indexPath];
            v59 = [_indexPath2 isEqual:_indexPath];

            if (v59)
            {
              currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
              _indexPath3 = [(UICollectionViewUpdateItem *)v57 _indexPath];
              [currentHandler handleFailureInMethod:a2 object:selfCopy3 file:@"UICollectionView.m" lineNumber:10552 description:{@"attempt to delete and reload the same index path (%@)", _indexPath3}];

              if (!v57)
              {
LABEL_49:
                v60 = 0;
LABEL_50:
                LODWORD(v62) = 0;
                goto LABEL_51;
              }
            }

            else if (!v57)
            {
              goto LABEL_49;
            }

            v60 = v57[1];
            if (v57[6] != 0x7FFFFFFFFFFFFFFFLL)
            {
              goto LABEL_50;
            }

            if (v49)
            {
              v61 = v49[1];
            }

            else
            {
              v61 = 0;
            }

            if (v60 == v61)
            {
              goto LABEL_64;
            }

            LODWORD(v62) = 1;
LABEL_51:
            if (v60 <= v53)
            {
              v62 = v62;
            }

            else
            {
              v62 = 0;
            }

            v53 -= v62;
            if ((!v49 || v49[6] != 0x7FFFFFFFFFFFFFFFLL) && (!v57 || v57[6] != 0x7FFFFFFFFFFFFFFFLL) && v60 == v53)
            {
              if (([v313 containsIndex:v60] & 1) == 0)
              {
                if (v57)
                {
                  v65 = v57[2];
                }

                else
                {
                  v65 = 0;
                }

                v315 -= v65 <= v315;
              }

              v53 = v60;
            }

LABEL_64:
            ++v56;
          }

          while (v54 != v56);
          v66 = [v318 countByEnumeratingWithState:&v345 objects:v363 count:16];
          v54 = v66;
        }

        while (v66);
LABEL_70:

        v343 = 0u;
        v344 = 0u;
        v341 = 0u;
        v342 = 0u;
        v67 = v287;
        v68 = [v67 countByEnumeratingWithState:&v341 objects:v362 count:16];
        if (v68)
        {
          v69 = v68;
          v70 = *v342;
          self = selfCopy3;
          do
          {
            v71 = 0;
            do
            {
              if (*v342 != v70)
              {
                objc_enumerationMutation(v67);
              }

              v72 = *(*(&v341 + 1) + 8 * v71);
              if (v72)
              {
                v73 = v72[3];
                LODWORD(v74) = v72[6] == 0x7FFFFFFFFFFFFFFFLL;
              }

              else
              {
                v73 = 0;
                LODWORD(v74) = 0;
              }

              if (v73 <= v53)
              {
                v74 = v74;
              }

              else
              {
                v74 = 0;
              }

              v53 += v74;
              if ((!v49 || v49[6] != 0x7FFFFFFFFFFFFFFFLL) && (!v72 || v72[6] != 0x7FFFFFFFFFFFFFFFLL) && v73 == v53 && ([v314 containsIndex:?] & 1) == 0)
              {
                if (v72)
                {
                  v75 = v72[4];
                }

                else
                {
                  v75 = 0;
                }

                v76 = v315;
                if (v75 <= v315)
                {
                  v76 = v315 + 1;
                }

                v315 = v76;
              }

              ++v71;
            }

            while (v69 != v71);
            v77 = [v67 countByEnumeratingWithState:&v341 objects:v362 count:16];
            v69 = v77;
          }

          while (v77);
        }

        else
        {
          self = selfCopy3;
        }

        v78 = [UICollectionViewUpdateItem alloc];
        v79 = [MEMORY[0x1E696AC88] indexPathForRow:v307 inSection:v309];
        v80 = [(UICollectionViewUpdateItem *)v78 initWithAction:1 forIndexPath:v79];

        [(NSMutableArray *)self->_deleteItems addObject:v80];
        v81 = [UICollectionViewUpdateItem alloc];
        v82 = [MEMORY[0x1E696AC88] indexPathForRow:v315 inSection:v53];
        v83 = [(UICollectionViewUpdateItem *)v81 initWithAction:0 forIndexPath:v82];

        _indexPath4 = [(UICollectionViewUpdateItem *)v83 _indexPath];
        [(UICollectionViewUpdateItem *)v49 _setNewIndexPath:_indexPath4];

        [(NSMutableArray *)self->_insertItems addObject:v83];
        v48 = v303;
LABEL_100:
        ++v48;
      }

      while (v48 != v299);
      v85 = [obj countByEnumeratingWithState:&v349 objects:v364 count:16];
      v299 = v85;
    }

    while (v85);
  }

  v86 = [(NSMutableArray *)self->_deleteItems sortedArrayUsingSelector:sel_inverseCompareIndexPaths_];
  v284 = [v86 mutableCopy];

  v87 = [(NSMutableArray *)self->_insertItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  v291 = [v87 mutableCopy];

  v88 = v277;
  v89 = v285;
  if ([(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shouldRebaseForUpdates]&& ![(UICollectionView *)self _isPerformingShadowUpdates])
  {
    selfCopy3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v285, "count") + objc_msgSend(v284, "count") + objc_msgSend(v291, "count")}];
    [(UICollectionView *)selfCopy3 addObjectsFromArray:v284];
    [(UICollectionView *)selfCopy3 addObjectsFromArray:v285];
    [(UICollectionView *)selfCopy3 addObjectsFromArray:v291];
    if (![(_UICollectionViewDragAndDropController *)self->_dragAndDropController rebaseForUpdates:selfCopy3])
    {
      v200 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492560) + 8);
      if (os_log_type_enabled(v200, OS_LOG_TYPE_ERROR))
      {
        dataSourceCountsDescription = [(UICollectionViewData *)v277 dataSourceCountsDescription];
        dragAndDropController = self->_dragAndDropController;
        *buf = 138412802;
        selfCopy2 = dataSourceCountsDescription;
        v359 = 2112;
        *v360 = selfCopy3;
        *&v360[8] = 2112;
        v361 = dragAndDropController;
        _os_log_impl(&dword_188A29000, v200, OS_LOG_TYPE_ERROR, "UICollectionView failed to rebase drag and drop or reordering items for incoming update, falling back to reload data. Pre-update data source counts: %@; update items: %@; drag and drop controller: %@", buf, 0x20u);
      }

      v308 = 0;
      v298 = 0;
      v181 = 0;
      goto LABEL_287;
    }
  }

  if ([v285 count])
  {
    v91 = [objc_alloc(MEMORY[0x1E696AB50]) initWithCapacity:{objc_msgSend(v285, "count")}];
    v92 = [objc_alloc(MEMORY[0x1E696AB50]) initWithCapacity:{objc_msgSend(v285, "count")}];
    v337 = 0u;
    v338 = 0u;
    v339 = 0u;
    v340 = 0u;
    v93 = v285;
    v94 = [v93 countByEnumeratingWithState:&v337 objects:v356 count:16];
    if (v94)
    {
      v95 = v94;
      v96 = *v338;
      do
      {
        for (i = 0; i != v95; ++i)
        {
          if (*v338 != v96)
          {
            objc_enumerationMutation(v93);
          }

          v98 = *(*(&v337 + 1) + 8 * i);
          _indexPath5 = [(UICollectionViewUpdateItem *)v98 _indexPath];
          [v91 addObject:_indexPath5];

          _newIndexPath = [(UICollectionViewUpdateItem *)v98 _newIndexPath];
          [v92 addObject:_newIndexPath];
        }

        v95 = [v93 countByEnumeratingWithState:&v337 objects:v356 count:16];
      }

      while (v95);
    }

    v88 = v277;
    v89 = v285;
  }

  else
  {
    v92 = 0;
    v91 = 0;
  }

  selfCopy3 = v284;
  v103 = v89;
  v308 = v91;
  v298 = v92;
  v104 = v291;
  v295 = v88;
  if (!self)
  {

    v181 = 0;
    v198 = 1;
    self = selfCopy3;
    v88 = v277;
    goto LABEL_288;
  }

  v292 = selfCopy3;
  if ([(UICollectionView *)selfCopy3 count])
  {
    v105 = 0;
    v106 = 0;
    do
    {
      v107 = [(UICollectionView *)selfCopy3 objectAtIndexedSubscript:v105];
      v108 = v107;
      if (v107)
      {
        v109 = v107[1];
        v110 = v107[6] == 0x7FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v109 = 0;
        v110 = 0;
      }

      v319 = v110;
      if (!v308 || v110)
      {
        if (!v308)
        {
LABEL_129:
          v113 = [v103 count];
          goto LABEL_132;
        }
      }

      else
      {
        _indexPath6 = [(UICollectionViewUpdateItem *)v107 _indexPath];
        v112 = [v308 containsObject:_indexPath6];

        if ((v112 & 1) == 0)
        {
          goto LABEL_129;
        }
      }

      v113 = 0;
LABEL_132:
      while ([v103 count] > v113)
      {
        v114 = [v103 objectAtIndexedSubscript:v113];
        if ([(UICollectionViewUpdateItem *)v114 _initialIndexPathEqualToUpdateItem:v108])
        {
          if (v114)
          {
            v115 = v114[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v115 = 0;
          }

          currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
          v117 = currentHandler2;
          if (v115)
          {
            [currentHandler2 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10896 description:{@"attempt to perform a delete and a move from the same section (%ld)", v109}];
          }

          else
          {
            _indexPath7 = [(UICollectionViewUpdateItem *)v108 _indexPath];
            [v117 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10899 description:{@"attempt to perform a delete and a move from the same index path (%@)", _indexPath7}];
          }
        }

        ++v113;
      }

      if (v319)
      {
        selfCopy3 = v292;
        if (v109 >= [(UICollectionViewData *)v295 numberOfSections])
        {
          currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler3 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10906 description:{@"attempt to delete section %ld, but there are only %ld sections before the update", v109, -[UICollectionViewData numberOfSections](v295)}];
        }

        if ([(UICollectionView *)v292 count])
        {
          v119 = 0;
          v120 = 0;
          do
          {
            v121 = [(UICollectionView *)v292 objectAtIndexedSubscript:v119];
            if (v121)
            {
              if (v121[6] == 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_152;
              }

              v122 = v121[1];
            }

            else
            {
              v122 = 0;
            }

            if (v122 != v109)
            {
LABEL_152:
              ++v120;
              goto LABEL_153;
            }

            [(UICollectionView *)v292 removeObjectAtIndex:v119];
            v106 -= v120 < v106;
LABEL_153:
            v119 = v120;
          }

          while ([(UICollectionView *)v292 count]> v120);
        }
      }

      else
      {
        selfCopy3 = v292;
        if (v108)
        {
          v123 = v108[2];
        }

        else
        {
          v123 = 0;
        }

        if (v109 >= [(UICollectionViewData *)v295 numberOfSections])
        {
          currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler4 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10924 description:{@"attempt to delete item %ld from section %ld, but there are only %ld sections before the update", v123, v109, -[UICollectionViewData numberOfSections](v295)}];
        }

        if (v123 >= [(UICollectionViewData *)v295 numberOfItemsInSection:v109])
        {
          currentHandler5 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler5 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10925 description:{@"attempt to delete item %ld from section %ld which only contains %ld items before the update", v123, v109, -[UICollectionViewData numberOfItemsInSection:](v295, v109)}];
        }
      }

      v105 = ++v106;
    }

    while ([(UICollectionView *)selfCopy3 count]> v106);
  }

  if ([v104 count])
  {
    v127 = 0;
    v128 = 0;
    do
    {
      v129 = [v104 objectAtIndexedSubscript:v127];
      v130 = v129;
      if (v129)
      {
        v131 = v129[3];
        v132 = v129[6] == 0x7FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v131 = 0;
        v132 = 0;
      }

      v320 = v132;
      if (!v298 || v132)
      {
        if (!v298)
        {
LABEL_173:
          v135 = [v103 count];
          goto LABEL_176;
        }
      }

      else
      {
        _indexPath8 = [(UICollectionViewUpdateItem *)v129 _indexPath];
        v134 = [v298 containsObject:_indexPath8];

        if ((v134 & 1) == 0)
        {
          goto LABEL_173;
        }
      }

      v135 = 0;
LABEL_176:
      while ([v103 count] > v135)
      {
        v136 = [v103 objectAtIndexedSubscript:v135];
        if ([(UICollectionViewUpdateItem *)v136 _finalIndexPathEqualToUpdateItem:v130])
        {
          if (v136)
          {
            v137 = v136[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v137 = 0;
          }

          currentHandler6 = [MEMORY[0x1E696AAA8] currentHandler];
          v139 = currentHandler6;
          if (v137)
          {
            [currentHandler6 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10944 description:{@"attempt to perform an insert and a move to the same section (%ld)", v131}];
          }

          else
          {
            _indexPath9 = [(UICollectionViewUpdateItem *)v130 _indexPath];
            [v139 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10947 description:{@"attempt to perform an insert and a move to the same index path (%@)", _indexPath9}];
          }
        }

        ++v135;
      }

      if (v320)
      {
        if (v131 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfSections])
        {
          currentHandler7 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler7 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10954 description:{@"attempt to insert section %ld but there are only %ld sections after the update", v131, -[UICollectionViewData numberOfSections](selfCopy3->_collectionViewData)}];
        }

        if ([v104 count])
        {
          v141 = 0;
          v142 = 0;
          do
          {
            v143 = [v104 objectAtIndexedSubscript:v141];
            if (v143)
            {
              if (v143[6] == 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_196;
              }

              v144 = v143[3];
            }

            else
            {
              v144 = 0;
            }

            if (v144 != v131)
            {
LABEL_196:
              ++v142;
              goto LABEL_197;
            }

            [v104 removeObjectAtIndex:v141];
            v128 -= v142 < v128;
LABEL_197:
            v141 = v142;
          }

          while ([v104 count] > v142);
        }
      }

      else
      {
        if (v130)
        {
          v145 = v130[4];
        }

        else
        {
          v145 = 0;
        }

        if (v131 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfSections])
        {
          currentHandler8 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler8 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10972 description:{@"attempt to insert item %ld into section %ld, but there are only %ld sections after the update", v145, v131, -[UICollectionViewData numberOfSections](selfCopy3->_collectionViewData)}];
        }

        if (v145 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfItemsInSection:v131])
        {
          currentHandler9 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler9 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10973 description:{@"attempt to insert item %ld into section %ld, but there are only %ld items in section %ld after the update", v145, v131, -[UICollectionViewData numberOfItemsInSection:](selfCopy3->_collectionViewData, v131), v131}];
        }
      }

      v127 = ++v128;
    }

    while ([v104 count] > v128);
  }

  if ([v103 count])
  {
    v149 = 0;
    do
    {
      v150 = [v103 objectAtIndexedSubscript:v149];
      _indexPath10 = [(UICollectionViewUpdateItem *)v150 _indexPath];
      _newIndexPath2 = [(UICollectionViewUpdateItem *)v150 _newIndexPath];
      if (v150)
      {
        v152 = v150[1];
        v151 = v150[2];
        v153 = v150[4];
        v310 = v150[3];
        v154 = v150[6];
        numberOfSections = [(UICollectionViewData *)v295 numberOfSections];
        if (v154 == 0x7FFFFFFFFFFFFFFFLL)
        {
          v304 = v152;
          if (v152 >= numberOfSections)
          {
            currentHandler10 = [MEMORY[0x1E696AAA8] currentHandler];
            [currentHandler10 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10990 description:{@"attempt to move section %ld, but there are only %ld sections before the update", v152, -[UICollectionViewData numberOfSections](v295)}];
          }

          v156 = v310;
          if (v310 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfSections])
          {
            currentHandler11 = [MEMORY[0x1E696AAA8] currentHandler];
            [currentHandler11 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10991 description:{@"attempt to to move section %ld to section %ld, but there are only %ld sections after the update", v152, v310, -[UICollectionViewData numberOfSections](selfCopy3->_collectionViewData)}];
LABEL_256:

            goto LABEL_225;
          }

          goto LABEL_225;
        }

        v300 = v149;
        v158 = v153;
        v159 = v151;
        v160 = v152;
        if (v152 >= numberOfSections)
        {
LABEL_258:
          v179 = v160;
          currentHandler12 = [MEMORY[0x1E696AAA8] currentHandler];
          [currentHandler12 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10994 description:{@"attempt to move index path (%@) from a section that does not exist - there are only %ld sections before the update", _indexPath10, -[UICollectionViewData numberOfSections](v295)}];

          v160 = v179;
          v158 = v153;
          v159 = v151;
        }
      }

      else
      {
        v300 = v149;
        numberOfSections2 = [(UICollectionViewData *)v295 numberOfSections];
        v153 = 0;
        v151 = 0;
        v160 = 0;
        v310 = 0;
        v158 = 0;
        v159 = 0;
        if (numberOfSections2 <= 0)
        {
          goto LABEL_258;
        }
      }

      v304 = v160;
      if (v159 >= [(UICollectionViewData *)v295 numberOfItemsInSection:v160])
      {
        currentHandler13 = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler13 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10995 description:{@"attempt to move index path (%@) that does not exist - there are only %ld items in section %ld before the update", _indexPath10, -[UICollectionViewData numberOfItemsInSection:](v295, v304), v304}];
      }

      v156 = v310;
      if (v310 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfSections])
      {
        currentHandler14 = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler14 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10996 description:{@"attempt to move index path (%@) to index path (%@) in section that does not exist - there are only %ld sections after the update", _indexPath10, _newIndexPath2, -[UICollectionViewData numberOfSections](selfCopy3->_collectionViewData)}];
      }

      if (v158 >= [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfItemsInSection:v310])
      {
        currentHandler11 = [MEMORY[0x1E696AAA8] currentHandler];
        [currentHandler11 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:10997 description:{@"attempt to move index path (%@) to index path (%@) that does not exist - there are only %ld items in section %ld after the update", _indexPath10, _newIndexPath2, -[UICollectionViewData numberOfItemsInSection:](selfCopy3->_collectionViewData, v310), v310}];
        v149 = v300;
        goto LABEL_256;
      }

      v149 = v300;
LABEL_225:
      v311 = v156;
      v161 = v149 + 1;
      v162 = v161;
      if ([v308 countForObject:_indexPath10] == 1)
      {
        v162 = v161;
        if ([v298 countForObject:_newIndexPath2] == 1)
        {
          v162 = [v103 count];
        }
      }

      v301 = v161;
      if ([v103 count] > v162)
      {
        v163 = v162;
        while (1)
        {
          v164 = [v103 objectAtIndexedSubscript:v163];
          _indexPath11 = [(UICollectionViewUpdateItem *)v164 _indexPath];
          _newIndexPath3 = [(UICollectionViewUpdateItem *)v164 _newIndexPath];
          v167 = [(UICollectionViewUpdateItem *)v150 _initialIndexPathEqualToUpdateItem:v164];
          v168 = [(UICollectionViewUpdateItem *)v150 _finalIndexPathEqualToUpdateItem:v164];
          if (!v167)
          {
            break;
          }

          if (!v168)
          {
            if (v150)
            {
              v172 = v150[6] == 0x7FFFFFFFFFFFFFFFLL;
            }

            else
            {
              v172 = 0;
            }

            currentHandler15 = [MEMORY[0x1E696AAA8] currentHandler];
            v171 = currentHandler15;
            if (v172)
            {
              if (v164)
              {
                v174 = v164[3];
              }

              else
              {
                v174 = 0;
              }

              [currentHandler15 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:11016 description:{@"attempt to move section %ld to both section %ld and section %ld", v304, v311, v174}];
            }

            else
            {
              [currentHandler15 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:11019 description:{@"attempt to move item at index path %@ to both %@ and %@", _indexPath10, _newIndexPath2, _newIndexPath3}];
            }

            goto LABEL_246;
          }

          [v103 removeObjectAtIndex:v163];
LABEL_248:
          v163 = v162;
          if ([v103 count] <= v162)
          {
            goto LABEL_253;
          }
        }

        if (v168)
        {
          if (v150)
          {
            v169 = v150[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v169 = 0;
          }

          currentHandler16 = [MEMORY[0x1E696AAA8] currentHandler];
          v171 = currentHandler16;
          if (v169)
          {
            [currentHandler16 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:11025 description:{@"attempt to move both section %ld and section %ld to section %ld", objc_msgSend(_indexPath10, "section"), objc_msgSend(_indexPath11, "section"), objc_msgSend(_newIndexPath2, "section")}];
          }

          else
          {
            [currentHandler16 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:selfCopy3 file:@"UICollectionView.m" lineNumber:11028 description:{@"attempt to move both item at index path %@ and %@ to %@", _indexPath10, _indexPath11, _newIndexPath2}];
          }

LABEL_246:
        }

        ++v162;
        goto LABEL_248;
      }

LABEL_253:
      v149 = v301;
    }

    while ([v103 count] > v301);
  }

  v181 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v103, "count") + -[UICollectionView count](v292, "count") + objc_msgSend(v104, "count")}];
  [v181 addObjectsFromArray:v292];
  [v181 addObjectsFromArray:v103];
  [v181 addObjectsFromArray:v104];
  v182 = [UICollectionViewUpdate alloc];
  self = selfCopy3;
  v183 = [(UICollectionViewUpdate *)&v182->super.isa initWithCollectionView:selfCopy3 updateItems:v181 moveItemSourceIndexPaths:v308 moveItemDestinationIndexPaths:v298 oldModel:v295 newModel:selfCopy3->_collectionViewData oldContentOffset:*MEMORY[0x1E695EFF8] newContentOffset:*(MEMORY[0x1E695EFF8] + 8), *MEMORY[0x1E695EFF8], *(MEMORY[0x1E695EFF8] + 8)];
  currentUpdate = selfCopy3->_currentUpdate;
  selfCopy3->_currentUpdate = v183;

  v185 = selfCopy3->_currentUpdate;
  if (!v185 || !v185->_updateMaps.updatesAreInvalid)
  {
    [(_UICollectionViewDragAndDropController *)selfCopy3->_dragAndDropController commitReorderedItems];
    v88 = v277;
    if (dyld_program_sdk_at_least())
    {
      v189 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492570);
      if (*v189)
      {
        v273 = *(v189 + 8);
        if (os_log_type_enabled(v273, OS_LOG_TYPE_ERROR))
        {
          *buf = 134218242;
          selfCopy2 = selfCopy3;
          v359 = 2112;
          *v360 = v295;
          _os_log_impl(&dword_188A29000, v273, OS_LOG_TYPE_ERROR, "_endItemAnims: cv == %p; Attempting to save anchor for data %@", buf, 0x16u);
        }

        v88 = v277;
      }

      [(UICollectionView *)selfCopy3 _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:v295];
    }

    [(UICollectionViewLayout *)selfCopy3->_layout _prepareForCollectionViewUpdates:v181 withDataSourceTranslator:selfCopy3->_currentUpdate];
    v190 = selfCopy3->_collectionViewData;
    if (v190)
    {
      v190->_preUpdateCachedItemCount = v190->_globalItemMap.__table_.__size_;
    }

    if (!v281)
    {
      v281 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    }

    if (!reorderingCopy && [v181 count])
    {
      [v281 _setInvalidateDataSourceCounts:1];
    }

    [v281 _setUpdateItems:v181];
    if ([(UICollectionViewLayout *)selfCopy3->_layout _estimatesSizes])
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v191 = v281;
        [v191 _setRetainExistingSizingInfoForEstimates:1];
      }
    }

    [(UICollectionViewLayout *)selfCopy3->_layout _invalidateLayoutUsingContext:v281];
    _dataSourceActual = [(UICollectionView *)selfCopy3 _dataSourceActual];
    v193 = objc_opt_respondsToSelector();

    if (v193)
    {
      _dataSourceActual2 = [(UICollectionView *)selfCopy3 _dataSourceActual];
      [_dataSourceActual2 _collectionView:selfCopy3 willPerformUpdates:v181];
    }

    _focusedItemState = [(UICollectionView *)selfCopy3 _focusedItemState];
    v196 = selfCopy3->_currentUpdate;
    newFocusedItemState = v196->_newFocusedItemState;
    v196->_newFocusedItemState = _focusedItemState;

    objc_storeStrong(&selfCopy3->_currentUpdate->_oldFocusedItemState, _focusedItemState);
    v198 = 0;
    v199 = 1;
    goto LABEL_289;
  }

  v186 = MEMORY[0x1E696AEC0];
  v187 = v185->_invalidUpdatesErrorMessage;
  selfCopy3 = [v186 stringWithFormat:@"%@\nCollection view: %@", v187, selfCopy3];

  v88 = v277;
  if (dyld_program_sdk_at_least() && ![(UICollectionView *)selfCopy3 _isConnectedToDiffableDataSource]&& !_UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(selfCopy3))
  {
    [(UICollectionView *)selfCopy3 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:selfCopy3];
    v198 = 0;
    goto LABEL_288;
  }

  if (os_variant_has_internal_diagnostics())
  {
    v188 = __UIFaultDebugAssertLog();
    if (os_log_type_enabled(v188, OS_LOG_TYPE_FAULT))
    {
      *buf = 138412290;
      selfCopy2 = selfCopy3;
      _os_log_fault_impl(&dword_188A29000, v188, OS_LOG_TYPE_FAULT, "Performing reloadData as a fallback  %@", buf, 0xCu);
    }
  }

  else
  {
    v188 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492568) + 8);
    if (os_log_type_enabled(v188, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      selfCopy2 = selfCopy3;
      _os_log_impl(&dword_188A29000, v188, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
    }
  }

LABEL_287:
  v198 = 1;
LABEL_288:

  [(_UICollectionViewDragAndDropController *)self->_dragAndDropController commitReorderedItems];
  v199 = 0;
LABEL_289:
  numberOfSections3 = [(UICollectionViewData *)v88 numberOfSections];
  v204 = malloc_type_malloc(8 * numberOfSections3, 0x100004000313F17uLL);
  if (numberOfSections3 >= 1)
  {
    for (j = 0; j != numberOfSections3; ++j)
    {
      v204[j] = [(UICollectionViewData *)v88 numberOfItemsInSection:?];
    }
  }

  numberOfSections4 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
  v207 = malloc_type_calloc(8uLL, numberOfSections4, 0x100004000313F17uLL);
  v312 = malloc_type_calloc(8uLL, numberOfSections3, 0x100004000313F17uLL);
  v322 = malloc_type_calloc(8uLL, numberOfSections4, 0x100004000313F17uLL);
  v296 = numberOfSections3;
  v317 = malloc_type_calloc(8uLL, numberOfSections3, 0x100004000313F17uLL);
  if ((v199 & 1) == 0)
  {
    v216 = 0;
    v217 = p_collectionViewFlags;
    v218 = v285;
    goto LABEL_368;
  }

  v305 = numberOfSections4;
  v290 = v204;
  v288 = v198;
  v293 = v181;
  v335 = 0u;
  v336 = 0u;
  v333 = 0u;
  v334 = 0u;
  v208 = v284;
  v209 = [v208 countByEnumeratingWithState:&v333 objects:v355 count:16];
  if (!v209)
  {
    v211 = 0;
    v213 = numberOfSections3;
    goto LABEL_308;
  }

  v210 = v209;
  v211 = 0;
  v212 = *v334;
  v213 = numberOfSections3;
  do
  {
    for (k = 0; k != v210; ++k)
    {
      if (*v334 != v212)
      {
        objc_enumerationMutation(v208);
      }

      v215 = *(*(&v333 + 1) + 8 * k);
      if (v215)
      {
        if (*(v215 + 48) == 0x7FFFFFFFFFFFFFFFLL)
        {
          v211 = (v211 + 1);
          --v213;
          continue;
        }

        v215 = *(v215 + 40);
      }

      ++v312[v215];
    }

    v210 = [v208 countByEnumeratingWithState:&v333 objects:v355 count:16];
  }

  while (v210);
LABEL_308:

  v331 = 0u;
  v332 = 0u;
  v329 = 0u;
  v330 = 0u;
  v219 = v291;
  v220 = [v219 countByEnumeratingWithState:&v329 objects:v354 count:16];
  if (!v220)
  {
    v222 = 0;
    goto LABEL_322;
  }

  v221 = v220;
  v222 = 0;
  v223 = *v330;
  while (2)
  {
    v224 = 0;
    while (2)
    {
      if (*v330 != v223)
      {
        objc_enumerationMutation(v219);
      }

      v225 = *(*(&v329 + 1) + 8 * v224);
      if (v225)
      {
        if (*(v225 + 48) == 0x7FFFFFFFFFFFFFFFLL)
        {
          v222 = (v222 + 1);
          ++v213;
          goto LABEL_318;
        }

        v225 = *(v225 + 40);
      }

      ++v207[v225];
LABEL_318:
      if (v221 != ++v224)
      {
        continue;
      }

      break;
    }

    v221 = [v219 countByEnumeratingWithState:&v329 objects:v354 count:16];
    if (v221)
    {
      continue;
    }

    break;
  }

LABEL_322:
  v302 = v207;

  v327 = 0u;
  v328 = 0u;
  v325 = 0u;
  v326 = 0u;
  v218 = v285;
  v226 = v285;
  v227 = [v226 countByEnumeratingWithState:&v325 objects:v353 count:16];
  if (!v227)
  {
    goto LABEL_336;
  }

  v228 = v227;
  v229 = *v326;
  while (2)
  {
    v230 = 0;
    while (2)
    {
      if (*v326 != v229)
      {
        objc_enumerationMutation(v226);
      }

      v231 = *(*(&v325 + 1) + 8 * v230);
      if (!v231)
      {
        v232 = 0;
        v233 = 0;
        goto LABEL_330;
      }

      if (v231[6] != 0x7FFFFFFFFFFFFFFFLL)
      {
        v232 = v231[1];
        v233 = v231[3];
LABEL_330:
        if ([(UICollectionViewUpdate *)selfCopy3->_currentUpdate finalSectionIndexForInitialSectionIndex:v232]!= v233)
        {
          ++v317[v232];
          ++v322[v233];
        }
      }

      ++v230;
      v218 = v285;
      if (v228 != v230)
      {
        continue;
      }

      break;
    }

    v234 = [v226 countByEnumeratingWithState:&v325 objects:v353 count:16];
    v228 = v234;
    if (v234)
    {
      continue;
    }

    break;
  }

LABEL_336:

  if (v213 != v305)
  {
    self = selfCopy3;
    selfCopy32 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of sections. The number of sections contained in the collection view after the update (%d) must be equal to the number of sections contained in the collection view before the update (%d), plus or minus the number of sections inserted or deleted (%d inserted, %d deleted). Collection view: %@", v305, v296, v222, v211, selfCopy3];
    v207 = v302;
    if ([(UICollectionView *)selfCopy3 _isConnectedToDiffableDataSource])
    {
      _diffableDataSourceImpl = [(UICollectionView *)selfCopy3 _diffableDataSourceImpl];
      currentTransaction = [_diffableDataSourceImpl currentTransaction];
      v246 = currentTransaction;
      v217 = p_collectionViewFlags;
      v88 = v277;
      v204 = v290;
      if (_diffableDataSourceImpl && currentTransaction)
      {
        v245 = [(UICollectionView *)selfCopy32 stringByAppendingFormat:@" Diffable transaction: %@", currentTransaction];;

        selfCopy32 = v245;
      }

      v248 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492578) + 8);
      if (os_log_type_enabled(v248, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        selfCopy2 = selfCopy32;
        _os_log_impl(&dword_188A29000, v248, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
      }

      v198 = 1;
      v181 = v293;
    }

    else
    {
      [(UICollectionView *)selfCopy3 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:selfCopy32];
      v217 = p_collectionViewFlags;
      v88 = v277;
      v181 = v293;
      v198 = v288;
      v204 = v290;
    }

    goto LABEL_367;
  }

  self = selfCopy3;
  v181 = v293;
  if (v305 < 1)
  {
    v216 = 1;
    v217 = p_collectionViewFlags;
    v88 = v277;
    v198 = v288;
    v204 = v290;
LABEL_353:
    v207 = v302;
    goto LABEL_368;
  }

  v235 = 0;
  v88 = v277;
  v204 = v290;
  while (2)
  {
    v236 = [(UICollectionViewUpdate *)selfCopy3->_currentUpdate initialSectionIndexForFinalSectionIndex:v235];
    if (v236 == 0x7FFFFFFFFFFFFFFFLL)
    {
LABEL_342:
      if (v305 == ++v235)
      {
        v216 = 1;
        v217 = p_collectionViewFlags;
        v218 = v285;
        v198 = v288;
        goto LABEL_353;
      }

      continue;
    }

    break;
  }

  v237 = v236;
  v238 = v290[v236];
  v239 = [(UICollectionViewData *)selfCopy3->_collectionViewData numberOfItemsInSection:v235];
  if ((v239 & 0x8000000000000000) == 0)
  {
    v240 = v322[v235];
    v241 = v312[v237];
    v242 = v302[v235];
    if (v239 != v238 + v240 - (v317[v237] + v241) + v242)
    {
      selfCopy32 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of items in section %d. The number of items contained in an existing section after the update (%d) must be equal to the number of items contained in that section before the update (%d), plus or minus the number of items inserted or deleted from that section (%d inserted, %d deleted) and plus or minus the number of items moved into or out of that section (%d moved in, %d moved out). Collection view: %@", v235, v239, v238, v242, v241, v240, v317[v237], selfCopy3];
      if (!dyld_program_sdk_at_least() || [(UICollectionView *)selfCopy3 _isConnectedToDiffableDataSource]|| _UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(selfCopy32))
      {
        v249 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492588) + 8);
        v217 = p_collectionViewFlags;
        v218 = v285;
        v207 = v302;
        if (os_log_type_enabled(v249, OS_LOG_TYPE_ERROR))
        {
          *buf = 138412290;
          selfCopy2 = selfCopy32;
LABEL_365:
          _os_log_impl(&dword_188A29000, v249, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
        }

        goto LABEL_366;
      }

      goto LABEL_389;
    }

    goto LABEL_342;
  }

  selfCopy32 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of items in section %d. Attempt to delete more items than exist in section. Collection view: %@", v237, selfCopy3];
  if (!dyld_program_sdk_at_least() || [(UICollectionView *)selfCopy3 _isConnectedToDiffableDataSource]|| _UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(selfCopy32))
  {
    v249 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492580) + 8);
    v217 = p_collectionViewFlags;
    v218 = v285;
    v207 = v302;
    if (os_log_type_enabled(v249, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      selfCopy2 = selfCopy32;
      goto LABEL_365;
    }

LABEL_366:

    v198 = 1;
    goto LABEL_367;
  }

LABEL_389:
  [(UICollectionView *)selfCopy3 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:selfCopy32];
  v217 = p_collectionViewFlags;
  v218 = v285;
  v198 = v288;
  v207 = v302;
LABEL_367:

  v216 = 0;
LABEL_368:
  free(v204);
  free(v207);
  free(v312);
  free(v322);
  free(v317);
  if (v216)
  {
    v102 = [(UICollectionView *)self _updateWithItems:v181 tentativelyForReordering:reorderingCopy propertyAnimator:animatorCopy collectionViewAnimator:viewAnimatorCopy];
    if (![(UICollectionViewLayout *)self->_layout _estimatesSizes])
    {
      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }
  }

  else
  {
    v102 = 0;
  }

  if (v198)
  {
LABEL_373:
    v250 = self->_currentUpdate;
    self->_currentUpdate = 0;

    v251 = _Block_copy(self->_updateCompletionHandler);
    updateCompletionHandler = self->_updateCompletionHandler;
    self->_updateCompletionHandler = 0;

    if (![(UICollectionViewLayout *)self->_layout _estimatesSizes])
    {
      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }

    [(UICollectionView *)self reloadData];
    if (v251)
    {
      v253 = MEMORY[0x1E69E96A0];
      v254 = MEMORY[0x1E69E96A0];
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __119__UICollectionView__endItemAnimationsWithInvalidationContext_tentativelyForReordering_animator_collectionViewAnimator___block_invoke;
      block[3] = &unk_1E70F0F78;
      v324 = v251;
      dispatch_async(v253, block);
    }

    v217 = p_collectionViewFlags;
  }

  --self->_updateCount;
  [(UICollectionView *)self _resetUpdateItemArrays];
  *(v217 + 1) &= ~0x1000000000uLL;
  [(UICollectionView *)self _resumeReloads];
  if ((*(v217 + 13) & 2) != 0)
  {
    [(UICollectionView *)self _updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:v14, v15, v16, v17];
    [(UIView *)self setNeedsFocusUpdate];
    *(v217 + 1) &= ~0x20000000000uLL;
  }

  postUpdateBlock = self->_postUpdateBlock;
  if (postUpdateBlock)
  {
    v256 = _Block_copy(postUpdateBlock);
    v257 = self->_postUpdateBlock;
    self->_postUpdateBlock = 0;

    v256[2](v256);
    v217 = p_collectionViewFlags;
  }

  if (v102 && (*(v217 + 9) & 4) != 0)
  {
    [(UICollectionView *)self _updateVisibleCellsNow:1];
  }

  _UIRestorePreviousFallbackEnvironment(v278);
  v258 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492590);
  v259 = *(v258 + 8);
  v260 = os_signpost_id_make_with_pointer(*(v258 + 8), self);
  if (v260 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v261 = v260;
    if (os_signpost_enabled(v259))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v259, OS_SIGNPOST_INTERVAL_END, v261, "BatchUpdates", "", buf, 2u);
    }
  }
}

- (id)_sectionsWithSectionOperationsInUpdateItems:(void *)items
{
  v18 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = v3;
  if (items)
  {
    v15 = 0u;
    v16 = 0u;
    v13 = 0u;
    v14 = 0u;
    v5 = [v3 countByEnumeratingWithState:&v13 objects:v17 count:16];
    if (v5)
    {
      v6 = v5;
      items = 0;
      v7 = *v14;
      do
      {
        for (i = 0; i != v6; ++i)
        {
          if (*v14 != v7)
          {
            objc_enumerationMutation(v4);
          }

          v9 = *(*(&v13 + 1) + 8 * i);
          if (v9 && v9[6] == 0x7FFFFFFFFFFFFFFFLL)
          {
            _indexPath = [(UICollectionViewUpdateItem *)v9 _indexPath];
            section = [_indexPath section];

            if (items)
            {
              [items addIndex:section];
            }

            else
            {
              items = [MEMORY[0x1E696AD50] indexSetWithIndex:section];
            }
          }
        }

        v6 = [v4 countByEnumeratingWithState:&v13 objects:v17 count:16];
      }

      while (v6);
    }

    else
    {
      items = 0;
    }
  }

  return items;
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:(id)updates
{
  v5 = MEMORY[0x1E696AAA8];
  updatesCopy = updates;
  currentHandler = [v5 currentHandler];
  [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10867 description:{@"%@", updatesCopy}];
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:(id)sections
{
  v5 = MEMORY[0x1E696AAA8];
  sectionsCopy = sections;
  currentHandler = [v5 currentHandler];
  [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10872 description:{@"%@", sectionsCopy}];
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:(id)section
{
  v5 = MEMORY[0x1E696AAA8];
  sectionCopy = section;
  currentHandler = [v5 currentHandler];
  [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10877 description:{@"%@", sectionCopy}];
}

- (void)_updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:(CGRect)rect
{
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v9 = _focusedItemState;
  if (_focusedItemState)
  {
    v10 = *(_focusedItemState + 16);
  }

  else
  {
    v10 = 0;
  }

  v25 = v10;

  if (v25)
  {
    item = [v25 item];
    section = [v25 section];
    numberOfSections = [(UICollectionView *)self numberOfSections];
    if (section < numberOfSections)
    {
      v14 = -[UICollectionView numberOfItemsInSection:](self, "numberOfItemsInSection:", [v25 section]);
    }

    else
    {
      v14 = 0;
    }

    v15 = item == 0x7FFFFFFFFFFFFFFFLL || [v25 item] < v14;
    if (section < numberOfSections && v15)
    {
      goto LABEL_19;
    }

    if (section < numberOfSections && !v15 && v14)
    {
      v16 = [MEMORY[0x1E696AC88] indexPathForItem:v14 - 1 inSection:{objc_msgSend(v25, "section")}];
      _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
      v18 = [(_UICollectionViewFocusedItemState *)_focusedItemState2 copyWithIndexPath:v16 preservingReusableView:0];
      [(UICollectionView *)self _setFocusedItemState:v18];
    }
  }

  _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
  v20 = _focusedItemState3;
  if (_focusedItemState3)
  {
    v21 = *(_focusedItemState3 + 16);
    if (v21)
    {
      v22 = v21;
LABEL_18:

      goto LABEL_19;
    }
  }

  v27.origin.x = x;
  v27.origin.y = y;
  v27.size.width = width;
  v27.size.height = height;
  IsNull = CGRectIsNull(v27);

  if (!IsNull)
  {
    v20 = _UIFocusClosestFocusableViewToRectInView(self, x, y, width, height);
    v22 = [(UICollectionView *)self _managedSubviewForView:v20];
    if (v22)
    {
      v24 = [_UICollectionViewFocusedItemState stateWithReusableView:v22];
      [(UICollectionView *)self _setFocusedItemState:v24];
    }

    else
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }

    goto LABEL_18;
  }

LABEL_19:
}

- (void)_prepareLayoutForUpdates:(BOOL)updates
{
  updatesCopy = updates;
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  v9 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v5 = [(NSArray *)self->_originalDeleteItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v5];

  v6 = [(NSArray *)self->_originalInsertItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v6];

  v7 = [(NSMutableArray *)self->_reloadItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v7];

  v8 = [(NSMutableArray *)self->_moveItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v8];

  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:v9 animated:updatesCopy];
}

- (id)_viewAnimationsForCurrentUpdateWithCollectionViewAnimator:(id)animator updatingContentOffsetForRestorationAnchor:(BOOL)anchor
{
  anchorCopy = anchor;
  v48 = *MEMORY[0x1E69E9840];
  animatorCopy = animator;
  currentUpdate = self->_currentUpdate;
  if (!currentUpdate || (*&currentUpdate->_flags & 2) == 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:11140 description:{@"UICollectionView internal inconsistency: attempted to generate view animations for an update which is not animated. Collection view: %@", self, animatorCopy}];
  }

  allVisibleViewsHashTable = [(_UICollectionViewSubviewManager *)self->_subviewManager allVisibleViewsHashTable];
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes]&& dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate];
  }

  if (anchorCopy)
  {
    if (self->_contentOffsetRestorationAnchor)
    {
      v41 = 0;
      [(UIScrollView *)self _contentInsetIncludingDecorations];
      v10 = [(UICollectionView *)self _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:v8 shouldApply:v9];
      if (v41 == 1)
      {
        v12 = v10;
        v13 = v11;
        v14 = self->_currentUpdate;
        v14->_newContentOffset.x = v10;
        v14->_newContentOffset.y = v11;
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_viewAnimationsForCurrentUpdateWithCollectionViewAnimator_updatingContentOffsetForRestorationAnchor____s_category);
        if (*CategoryCachedImpl)
        {
          v34 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
          {
            contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
            v36 = v34;
            _ui_shortDescription = [(NSIndexPath *)contentOffsetRestorationAnchor _ui_shortDescription];
            v50.x = v12;
            v50.y = v13;
            v38 = NSStringFromCGPoint(v50);
            *buf = 134218498;
            selfCopy = self;
            v44 = 2112;
            v45 = _ui_shortDescription;
            v46 = 2112;
            v47 = v38;
            _os_log_impl(&dword_188A29000, v36, OS_LOG_TYPE_ERROR, "_viewAnimationsForCurrentUpdate: cv == %p; readjusting content offset for anchor %@. New content offset: %@", buf, 0x20u);
          }
        }

        v16 = *(&self->_collectionViewFlags + 4);
        *(&self->_collectionViewFlags + 4) = v16 | 0x80000;
        [(UICollectionView *)self setContentOffset:v12, v13];
        *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v16 >> 19) & 1) << 19);
      }
    }
  }

  v17 = objc_alloc_init(_UICollectionViewSubviewCollection);
  [(UICollectionView *)self _populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:v17 addingDeletedViewsToSet:0 updateLayoutAttributesIndexPaths:0];
  v18 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v19 = objc_opt_new();
  v20 = objc_opt_new();
  v21 = objc_opt_new();
  [(UICollectionView *)self _createAndAppendViewAnimationsForDeletesInCurrentUpdate:v18 disappearingAnimations:v20];
  [(UICollectionView *)self _createAndAppendViewAnimationsForInsertsInCurrentUpdate:v18 appearingAnimations:v19 newSubviewCollection:v17];
  newModel = self->_currentUpdate->_newModel;
  [(UICollectionView *)self _visibleBounds];
  v27 = [(UICollectionViewData *)newModel layoutAttributesForElementsInRect:v23, v24, v25, v26];
  [(UICollectionView *)self _createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:v18 animationsForOnScreenViews:v21 newSubviewCollection:v17 oldVisibleViews:allVisibleViewsHashTable attributesForNewModel:v27];
  [(UICollectionView *)self _createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:v18 disappearingAnimations:v20 animationsForOnScreenViews:v21 newSubviewCollection:v17 oldVisibleViews:allVisibleViewsHashTable];
  [(UICollectionView *)self _createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:v18 appearingAnimations:v19 newSubviewCollection:v17];
  [(UICollectionView *)self _createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:v18 appearingAnimations:v19 animationsForOnScreenViews:v21 newSubviewCollection:v17 attributesForNewModel:v27];
  if (dyld_program_sdk_at_least() && [(UICollectionViewLayout *)self->_layout _wantsUntrackedAnimationCleanupForAuxillaryItems])
  {
    [(UICollectionView *)self _removeUntrackedAuxillaryViewsForBeforeVisibleViews:self->_subviewManager afterVisibleViews:v17 withTrackingViewAnimations:v18];
  }

  indexPathsForVisibleItems = [(UICollectionView *)self indexPathsForVisibleItems];
  [(_UICollectionViewSubviewManager *)self->_subviewManager replaceVisibleViewsWithoutCopyingWithContentsOfSubviewCollection:?];
  indexPathsForVisibleItems2 = [(UICollectionView *)self indexPathsForVisibleItems];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:?];
  }

  [(UICollectionView *)self _updateOrderingOfViewsInDisappearingViewAnimations:v20 onScreenViewAnimations:v21];
  if (dyld_program_sdk_at_least())
  {
    _content = [(_UILabelConfiguration *)animatorCopy _content];
    [(_UICollectionLayoutItemSolver *)_content setSolveResult:v19];
    [(_UICollectionLayoutListAttributes *)_content setSeparatorVisualEffect:v20];
    [(UIBackgroundConfiguration *)_content _setImage:indexPathsForVisibleItems];
    [(_UICollectionViewAnimationContext *)_content setCurrentlyVisibleItemIndexPaths:indexPathsForVisibleItems2];
    [(_UIDocumentUnavailableConfiguration *)_content set_tintColor:v21];
    [(UICollectionView *)self _setupExpandCollapseAnimationsIfNeededWithContext:_content];
  }

  return v18;
}

void __120__UICollectionView__viewAnimationsForCurrentUpdateWithCollectionViewAnimator_updatingContentOffsetForRestorationAnchor___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v4 = a2;
  v5 = [a3 _layoutAttributes];
  [v5 setIndexPath:v4];
}

- (void)_populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:(id)update addingDeletedViewsToSet:(id)set updateLayoutAttributesIndexPaths:(BOOL)paths
{
  updateCopy = update;
  setCopy = set;
  v11 = self->_currentUpdate;
  if (!v11)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:11259 description:{@"Invalid parameter not satisfying: %@", @"currentUpdate != nil"}];
  }

  subviewManager = self->_subviewManager;
  v17[0] = MEMORY[0x1E69E9820];
  v17[1] = 3221225472;
  v17[2] = __144__UICollectionView__populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate_addingDeletedViewsToSet_updateLayoutAttributesIndexPaths___block_invoke;
  v17[3] = &unk_1E70FF600;
  v18 = v11;
  v19 = updateCopy;
  pathsCopy = paths;
  v20 = setCopy;
  selfCopy = self;
  v13 = setCopy;
  v14 = updateCopy;
  v15 = v11;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v17];
  }
}

void __144__UICollectionView__populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate_addingDeletedViewsToSet_updateLayoutAttributesIndexPaths___block_invoke(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v15 = a3;
  v9 = a4;
  v10 = a5;
  if (a2)
  {
    if ([v15 length] == 1)
    {
      [(_UICollectionViewSubviewCollection *)*(a1 + 40) setView:v10 ofKind:v9 inCategory:a2 atIndexPath:v15];
    }

    else
    {
      v13 = [(UICollectionViewUpdate *)*(*(a1 + 56) + 2280) validatedNewIndexPathForSupplementaryElementOfKind:v9 oldIndexPath:v15];
      if (v13)
      {
        [(_UICollectionViewSubviewCollection *)*(a1 + 40) setView:v10 ofKind:v9 inCategory:a2 atIndexPath:v13];
        if (*(a1 + 64) == 1)
        {
          v14 = [v10 _layoutAttributes];
          [v14 setIndexPath:v13];
        }
      }

      else
      {
        [*(a1 + 48) addObject:v10];
      }
    }
  }

  else
  {
    v11 = [*(a1 + 32) finalIndexPathForInitialIndexPath:v15];
    if (v11)
    {
      [(_UICollectionViewSubviewCollection *)*(a1 + 40) setCell:v10 atIndexPath:v11];
      if (*(a1 + 64) == 1)
      {
        v12 = [v10 _layoutAttributes];
        [v12 setIndexPath:v11];
      }
    }

    else
    {
      [*(a1 + 48) addObject:v10];
    }
  }
}

- (void)_createAndAppendViewAnimationsForDeletesInCurrentUpdate:(id)update disappearingAnimations:(id)animations
{
  v70 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  animationsCopy = animations;
  v64[0] = MEMORY[0x1E69E9820];
  v64[1] = 3221225472;
  v65[0] = __99__UICollectionView__createAndAppendViewAnimationsForDeletesInCurrentUpdate_disappearingAnimations___block_invoke;
  v65[1] = &unk_1E70FF628;
  v65[2] = self;
  v52 = updateCopy;
  v66 = v52;
  v51 = animationsCopy;
  v67 = v51;
  v60 = 0u;
  v61 = 0u;
  v62 = 0u;
  v63 = 0u;
  obj = self->_deleteItems;
  v8 = [(NSMutableArray *)obj countByEnumeratingWithState:&v60 objects:v69 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    v11 = *v61;
    selfCopy = self;
    v44 = *v61;
    v45 = v65;
    do
    {
      v12 = 0;
      v46 = v9;
      do
      {
        if (*v61 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v60 + 1) + 8 * v12);
        if (v13 && v13[6] == 0x7FFFFFFFFFFFFFFFLL)
        {
          v48 = v12;
          _indexPath = [(UICollectionViewUpdateItem *)v13 _indexPath];
          section = [_indexPath section];

          v16 = v10[215];
          v17 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v16))[2] numberOfItemsInSection:section];
          v18 = (*(&self->super.super.super.super.isa + v16))[2];
          v19 = [MEMORY[0x1E696AC88] indexPathForRow:0 inSection:section];
          v20 = [(UICollectionViewData *)v18 globalIndexForItemAtIndexPath:v19];

          if (v17 >= 1)
          {
            do
            {
              (v65[0])(v64, v20++);
              --v17;
            }

            while (v17);
          }

          v58 = 0u;
          v59 = 0u;
          v56 = 0u;
          v57 = 0u;
          self = selfCopy;
          v54 = [(UICollectionViewData *)(*(&selfCopy->super.super.super.super.isa + v16))[2] existingSupplementaryLayoutAttributesInSection:section];
          v21 = [v54 countByEnumeratingWithState:&v56 objects:v68 count:16];
          if (v21)
          {
            v22 = v21;
            v55 = *v57;
            v23 = v54;
            v53 = v16;
            while (1)
            {
              v24 = 0;
              do
              {
                if (*v57 != v55)
                {
                  objc_enumerationMutation(v23);
                }

                v25 = *(*(&v56 + 1) + 8 * v24);
                v26 = [(UICollectionView *)self _visibleViewForLayoutAttributes:v25, v44, v45];
                if (v26)
                {
                  v27 = v26;
                  _content = [(_UILabelConfiguration *)v25 _content];
                  indexPath = [v25 indexPath];
                  v30 = [*(&self->super.super.super.super.isa + v16) finalIndexPathForSupplementaryElementOfKind:_content forInitialIndexPath:indexPath];

                  if (!v30)
                  {
                    if (v25)
                    {
                      p_layout = &self->_layout;
                      layout = self->_layout;
                      if ((*(v25 + 288) & 2) == 0)
                      {
                        goto LABEL_19;
                      }

                      v33 = [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingDecorationElementOfKind:_content atIndexPath:indexPath];
                    }

                    else
                    {
                      p_layout = &self->_layout;
                      layout = self->_layout;
LABEL_19:
                      v33 = [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingSupplementaryElementOfKind:_content atIndexPath:indexPath];
                    }

                    v34 = v33;
                    if (v33)
                    {
                      if (dyld_program_sdk_at_least())
                      {
                        zIndex = [v34 zIndex];
                        _layoutAttributes = [v27 _layoutAttributes];
                        zIndex2 = [_layoutAttributes zIndex];

                        if (zIndex == zIndex2)
                        {
                          self = selfCopy;
                        }

                        else
                        {
                          self = selfCopy;
                          -[UICollectionView _addControlledSubview:atZIndex:forced:](selfCopy, "_addControlledSubview:atZIndex:forced:", v27, [v34 zIndex], 1);
                        }
                      }
                    }

                    else
                    {
                      v34 = [v25 copy];
                      [v34 setAlpha:0.0];
                    }

                    v37 = [(UICollectionViewLayout *)*p_layout _animationForReusableView:v27 toLayoutAttributes:v34 type:2];
                    v38 = [[UICollectionViewAnimation alloc] initWithView:v27 viewType:2 finalLayoutAttributes:v34 startFraction:1 endFraction:1 animateFromCurrentPostion:v37 deleteAfterAnimation:0.0 customAnimations:1.0];
                    [v52 addObject:v38];
                    v39 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v25];
                    [v51 setObject:v38 forKey:v39];

                    v16 = v53;
                    v23 = v54;
                  }
                }

                ++v24;
              }

              while (v22 != v24);
              v40 = [v23 countByEnumeratingWithState:&v56 objects:v68 count:16];
              v22 = v40;
              if (!v40)
              {
                v9 = v46;
                _indexPath2 = v23;
                v10 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
                v11 = v44;
                v12 = v48;
                goto LABEL_36;
              }
            }
          }

          v12 = v48;
          _indexPath2 = v54;
        }

        else
        {
          v42 = (*(&self->super.super.super.super.isa + v10[215]))[2];
          _indexPath2 = [(UICollectionViewUpdateItem *)v13 _indexPath];
          v43 = [(UICollectionViewData *)v42 globalIndexForItemAtIndexPath:_indexPath2];
          (v65[0])(v64, v43);
        }

LABEL_36:

        ++v12;
      }

      while (v12 != v9);
      v9 = [(NSMutableArray *)obj countByEnumeratingWithState:&v60 objects:v69 count:16];
    }

    while (v9);
  }
}

void __99__UICollectionView__createAndAppendViewAnimationsForDeletesInCurrentUpdate_disappearingAnimations___block_invoke(id *a1, uint64_t a2)
{
  v13 = [(UICollectionViewData *)*(*(a1[4] + 285) + 16) indexPathForItemAtGlobalIndex:a2];
  v3 = [(_UICollectionViewSubviewManager *)*(a1[4] + 373) visibleCellAtIndexPath:v13];
  if (v3 && ([(UICollectionViewUpdate *)*(a1[4] + 285) hasMovedItemWithSourceIndexPath:v13]& 1) == 0)
  {
    v4 = [*(a1[4] + 269) finalLayoutAttributesForDisappearingItemAtIndexPath:v13];
    if (v4)
    {
      v5 = v4;
      if (dyld_program_sdk_at_least())
      {
        v6 = [v5 zIndex];
        v7 = [v3 _layoutAttributes];
        v8 = [v7 zIndex];

        if (v6 != v8)
        {
          [a1[4] _addControlledSubview:v3 atZIndex:objc_msgSend(v5 forced:{"zIndex"), 1}];
        }
      }
    }

    else
    {
      v9 = [v3 _layoutAttributes];
      v5 = [v9 copy];

      [v5 setAlpha:0.0];
    }

    v10 = [*(a1[4] + 269) _animationForReusableView:v3 toLayoutAttributes:v5 type:2];
    v11 = [[UICollectionViewAnimation alloc] initWithView:v3 viewType:1 finalLayoutAttributes:v5 startFraction:1 endFraction:1 animateFromCurrentPostion:v10 deleteAfterAnimation:0.0 customAnimations:1.0];
    [a1[5] addObject:v11];
    v12 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v13];
    [a1[6] setObject:v11 forKey:v12];
  }
}

- (void)_createAndAppendViewAnimationsForInsertsInCurrentUpdate:(id)update appearingAnimations:(id)animations newSubviewCollection:(id)collection
{
  v106 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  animationsCopy = animations;
  collectionCopy = collection;
  _estimatesSizes = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  [(UICollectionView *)self _visibleBounds];
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v19 = v18;
  v92[0] = MEMORY[0x1E69E9820];
  v92[1] = 3221225472;
  v93 = __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke;
  v94 = &unk_1E70FF650;
  selfCopy = self;
  v99 = v12;
  v100 = v14;
  v101 = v16;
  v102 = v18;
  v103 = _estimatesSizes;
  v80 = updateCopy;
  v96 = v80;
  v79 = animationsCopy;
  v97 = v79;
  v78 = collectionCopy;
  v98 = v78;
  v88 = 0u;
  v89 = 0u;
  v90 = 0u;
  v91 = 0u;
  obj = self->_insertItems;
  v20 = [(NSMutableArray *)obj countByEnumeratingWithState:&v88 objects:v105 count:16];
  if (v20)
  {
    v21 = v20;
    v22 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    v23 = *v89;
    selfCopy2 = self;
    v74 = *v89;
    do
    {
      v24 = 0;
      v73 = v21;
      do
      {
        if (*v89 != v23)
        {
          objc_enumerationMutation(obj);
        }

        v25 = *(*(&v88 + 1) + 8 * v24);
        if (v25 && v25[6] == 0x7FFFFFFFFFFFFFFFLL)
        {
          v76 = v24;
          _indexPath = [(UICollectionViewUpdateItem *)v25 _indexPath];
          section = [_indexPath section];

          v28 = v22[215];
          v29 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v28))[3] numberOfItemsInSection:section];
          v81 = v28;
          v30 = (*(&self->super.super.super.super.isa + v28))[3];
          v31 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:section];
          v32 = [(UICollectionViewData *)v30 globalIndexForItemAtIndexPath:v31];

          if (v29 >= 1)
          {
            do
            {
              v93(v92, v32++);
              --v29;
            }

            while (v29);
          }

          v86 = 0u;
          v87 = 0u;
          v84 = 0u;
          v85 = 0u;
          v33 = v81;
          v82 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v81))[3] existingSupplementaryLayoutAttributesInSection:section];
          v34 = [v82 countByEnumeratingWithState:&v84 objects:v104 count:16];
          if (v34)
          {
            v35 = v34;
            v83 = *v85;
            v36 = v82;
            while (1)
            {
              v37 = 0;
              do
              {
                if (*v85 != v83)
                {
                  objc_enumerationMutation(v36);
                }

                v38 = *(*(&v84 + 1) + 8 * v37);
                indexPath = [v38 indexPath];
                _content = [(_UILabelConfiguration *)v38 _content];
                v41 = [*(&self->super.super.super.super.isa + v33) initialIndexPathForSupplementaryElementOfKind:_content forFinalIndexPath:indexPath];

                if (!v41)
                {
                  if (v38)
                  {
                    layout = self->_layout;
                    if ((v38[288] & 2) == 0)
                    {
                      goto LABEL_18;
                    }

                    v43 = [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingDecorationElementOfKind:_content atIndexPath:indexPath];
                  }

                  else
                  {
                    layout = self->_layout;
LABEL_18:
                    v43 = [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingSupplementaryElementOfKind:_content atIndexPath:indexPath];
                  }

                  v44 = v43;
                  if (!v43)
                  {
                    v44 = [v38 copy];
                    [v44 setAlpha:0.0];
                  }

                  [v38 frame];
                  v46 = v45;
                  v48 = v47;
                  v50 = v49;
                  v52 = v51;
                  [v44 frame];
                  v110.origin.x = v53;
                  v110.origin.y = v54;
                  v110.size.width = v55;
                  v110.size.height = v56;
                  v107.origin.x = v46;
                  v107.origin.y = v48;
                  v107.size.width = v50;
                  v107.size.height = v52;
                  v108 = CGRectUnion(v107, v110);
                  [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v38 frame:v108.origin.x, v108.origin.y, v108.size.width, v108.size.height];
                  v111.origin.x = v57;
                  v111.origin.y = v58;
                  v111.size.width = v59;
                  v111.size.height = v60;
                  v109.origin.x = v13;
                  v109.origin.y = v15;
                  v109.size.width = v17;
                  v109.size.height = v19;
                  if (CGRectIntersectsRect(v109, v111) && (![v44 isHidden] || (objc_msgSend(v38, "isHidden") & 1) == 0))
                  {
                    _content2 = [(_UILabelConfiguration *)v38 _content];
                    v62 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:_content2 atIndexPath:indexPath layout:self->_layout withLayoutAttributes:v44 applyAttributes:1];

                    if (v62)
                    {
                      v63 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v62 toLayoutAttributes:v38 type:2];
                      v64 = [[UICollectionViewAnimation alloc] initWithView:v62 viewType:2 finalLayoutAttributes:v38 startFraction:0 endFraction:0 animateFromCurrentPostion:v63 deleteAfterAnimation:0.0 customAnimations:1.0];
                      [v80 addObject:v64];
                      v65 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v38];
                      [v79 setObject:v64 forKey:v65];
                      if (v38)
                      {
                        v66 = *(v38 + 72);
                        v67 = 1;
                        if ((v66 & 2) != 0)
                        {
                          v67 = 2;
                        }

                        if (v66)
                        {
                          v68 = 0;
                        }

                        else
                        {
                          v68 = v67;
                        }
                      }

                      else
                      {
                        v68 = 0;
                      }

                      [(_UICollectionViewSubviewCollection *)v78 setView:v62 ofKind:_content inCategory:v68 atIndexPath:indexPath];

                      self = selfCopy2;
                    }

                    v33 = v81;
                  }

                  v36 = v82;
                }

                ++v37;
              }

              while (v35 != v37);
              v69 = [v36 countByEnumeratingWithState:&v84 objects:v104 count:16];
              v35 = v69;
              if (!v69)
              {
                v21 = v73;
                _indexPath2 = v36;
                v22 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
                v23 = v74;
                v24 = v76;
                goto LABEL_43;
              }
            }
          }

          v23 = v74;
          v24 = v76;
          _indexPath2 = v82;
        }

        else
        {
          v71 = (*(&self->super.super.super.super.isa + v22[215]))[3];
          _indexPath2 = [(UICollectionViewUpdateItem *)v25 _indexPath];
          v72 = [(UICollectionViewData *)v71 globalIndexForItemAtIndexPath:_indexPath2];
          v93(v92, v72);
        }

LABEL_43:

        ++v24;
      }

      while (v24 != v21);
      v21 = [(NSMutableArray *)obj countByEnumeratingWithState:&v88 objects:v105 count:16];
    }

    while (v21);
  }
}

void __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) indexPathForItemAtGlobalIndex:a2];
  if (([(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) hasMovedItemWithDestinationIndexPath:v3]& 1) == 0)
  {
    v4 = [*(*(a1 + 32) + 2152) initialLayoutAttributesForAppearingItemAtIndexPath:v3];
    v5 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) layoutAttributesForItemAtIndexPath:v3];
    if (v5)
    {
      v6 = v5;
      if (!v4)
      {
        v4 = [v5 copy];
        [v4 setAlpha:0.0];
      }

      [v4 frame];
      v8 = v7;
      v10 = v9;
      v12 = v11;
      v14 = v13;
      [v6 frame];
      v45.origin.x = v15;
      v45.origin.y = v16;
      v45.size.width = v17;
      v45.size.height = v18;
      v43.origin.x = v8;
      v43.origin.y = v10;
      v43.size.width = v12;
      v43.size.height = v14;
      v44 = CGRectUnion(v43, v45);
      [*(*(a1 + 32) + 2152) _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v4 frame:{v44.origin.x, v44.origin.y, v44.size.width, v44.size.height}];
      v46.origin.x = v19;
      v46.origin.y = v20;
      v46.size.width = v21;
      v46.size.height = v22;
      if (!CGRectIntersectsRect(*(a1 + 64), v46) || ([v4 isHidden] & 1) != 0 || (objc_msgSend(v6, "isHidden") & 1) != 0)
      {
        v23 = v6;
      }

      else
      {
        v24 = [*(a1 + 32) _preparedCellForItemAtIndexPath:v3 withLayoutAttributes:v4 applyAttributes:1 isFocused:0 notify:1];
        if (dyld_program_sdk_at_least() && *(a1 + 96) == 1)
        {
          v25 = *(a1 + 32);
          v26 = *(v25[285] + 24);
          [v25 _visibleBounds];
          [(UICollectionViewData *)v26 validateLayoutInRect:v27, v28, v29, v30];
        }

        v23 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) layoutAttributesForItemAtIndexPath:v3];

        v31 = [*(*(a1 + 32) + 2152) _initialAppearingLayoutAttributesCanBeOverriddenForEstimatedSizing];
        if (dyld_program_sdk_at_least() && (*(a1 + 96) & v31 & 1) != 0)
        {
          v35 = MEMORY[0x1E69E9820];
          v36 = 3221225472;
          v37 = __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2;
          v38 = &unk_1E70F6B40;
          v39 = v4;
          v40 = v3;
          v41 = v23;
          v42 = v24;
          [UIView performWithoutAnimation:&v35];
        }

        v32 = [*(*(a1 + 32) + 2152) _animationForReusableView:v24 toLayoutAttributes:v23 type:{2, v35, v36, v37, v38}];
        v33 = [[UICollectionViewAnimation alloc] initWithView:v24 viewType:1 finalLayoutAttributes:v23 startFraction:0 endFraction:0 animateFromCurrentPostion:v32 deleteAfterAnimation:0.0 customAnimations:1.0];
        [*(a1 + 40) addObject:v33];
        v34 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v3];
        [*(a1 + 48) setObject:v33 forKey:v34];
        [(_UICollectionViewSubviewCollection *)*(a1 + 56) setCell:v24 atIndexPath:v3];
      }
    }

    else
    {
      v23 = 0;
    }
  }
}

void __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2(uint64_t a1)
{
  v2 = [*(a1 + 32) copy];
  [v2 setIndexPath:*(a1 + 40)];
  [*(a1 + 48) center];
  [v2 setCenter:?];
  [*(a1 + 48) size];
  [v2 setSize:?];
  [*(a1 + 56) _setLayoutAttributes:v2];
}

- (id)_attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:(id)views attributesForNewModel:(id)model
{
  v33 = *MEMORY[0x1E69E9840];
  viewsCopy = views;
  modelCopy = model;
  v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
  subviewManager = self->_subviewManager;
  v28[0] = MEMORY[0x1E69E9820];
  v28[1] = 3221225472;
  v28[2] = __107__UICollectionView__attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews_attributesForNewModel___block_invoke;
  v28[3] = &unk_1E70FF678;
  v22 = viewsCopy;
  v29 = v22;
  selfCopy = self;
  v23 = v8;
  v31 = v23;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v28];
  }

  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v10 = modelCopy;
  v11 = [v10 countByEnumeratingWithState:&v24 objects:v32 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v25;
    do
    {
      for (i = 0; i != v12; ++i)
      {
        if (*v25 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v24 + 1) + 8 * i);
        indexPath = [v15 indexPath];
        if (v15)
        {
          if (v15[288])
          {
            v17 = indexPath;
            v18 = [(UICollectionViewData *)self->_currentUpdate->_newModel validatedGlobalIndexForItemAtIndexPath:indexPath];
            if (v18 != 0x7FFFFFFFFFFFFFFFLL && [(UICollectionViewUpdate *)self->_currentUpdate initialGlobalIndexForFinalGlobalIndex:v18]!= 0x7FFFFFFFFFFFFFFFLL)
            {
              [v23 setObject:v15 forKeyedSubscript:v17];
            }
          }
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v24 objects:v32 count:16];
    }

    while (v12);
  }

  v19 = v31;
  v20 = v23;

  return v23;
}

void __107__UICollectionView__attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews_attributesForNewModel___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v18 = a3;
  v4 = [*(a1 + 32) containsObject:v18];
  v5 = v18;
  if (v4)
  {
    v6 = [v18 _layoutAttributes];
    v7 = *(*(*(a1 + 40) + 2280) + 16);
    v8 = [v6 indexPath];
    v9 = [(UICollectionViewData *)v7 validatedGlobalIndexForItemAtIndexPath:v8];

    if (v9 != 0x7FFFFFFFFFFFFFFFLL)
    {
      v10 = [*(*(a1 + 40) + 2280) finalGlobalIndexForInitialGlobalIndex:v9];
      if (v10 != 0x7FFFFFFFFFFFFFFFLL)
      {
        v11 = [(UICollectionViewData *)*(*(*(a1 + 40) + 2280) + 24) layoutAttributesForGlobalItemIndex:v10];
        v12 = v11;
        if (v11)
        {
          v13 = *(a1 + 48);
          v14 = [v11 indexPath];
          v15 = [v13 objectForKeyedSubscript:v14];

          if (!v15)
          {
            v16 = *(a1 + 48);
            v17 = [v12 indexPath];
            [v16 setObject:v12 forKeyedSubscript:v17];
          }
        }
      }
    }

    v5 = v18;
  }
}

- (void)_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:(id)update animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection oldVisibleViews:(id)visibleViews attributesForNewModel:(id)model
{
  v115 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  viewsCopy = views;
  selfCopy = self;
  v92 = viewsCopy;
  collectionCopy = collection;
  v15 = [(UICollectionView *)self _attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:visibleViews attributesForNewModel:model];
  [(UICollectionView *)self _visibleBounds];
  v17 = v16;
  v19 = v18;
  v21 = v20;
  v23 = v22;
  _estimatesSizes = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  v24 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v107 = 0u;
  v108 = 0u;
  v109 = 0u;
  v110 = 0u;
  v86 = v15;
  obj = [v15 objectEnumerator];
  v25 = [obj countByEnumeratingWithState:&v107 objects:v114 count:16];
  if (v25)
  {
    v26 = v25;
    p_responderFlags = &self->super.super.super._responderFlags;
    v97 = *v108;
    v90 = updateCopy;
    v91 = v24;
    do
    {
      v27 = 0;
      v94 = v26;
      do
      {
        if (*v108 != v97)
        {
          objc_enumerationMutation(obj);
        }

        v99 = v27;
        v28 = *(*(&v107 + 1) + 8 * v27);
        indexPath = [v28 indexPath];
        v98 = [(UICollectionViewData *)selfCopy->_currentUpdate->_newModel globalIndexForItemAtIndexPath:indexPath];
        v29 = [(UICollectionViewUpdate *)selfCopy->_currentUpdate initialGlobalIndexForFinalGlobalIndex:?];
        v30 = [(UICollectionViewData *)selfCopy->_currentUpdate->_oldModel layoutAttributesForGlobalItemIndex:v29];
        v31 = [(UICollectionViewData *)selfCopy->_currentUpdate->_oldModel indexPathForItemAtGlobalIndex:v29];
        v32 = [(_UICollectionViewSubviewManager *)selfCopy->_subviewManager visibleCellAtIndexPath:v31];
        v33 = v32;
        v101 = v30;
        if (v30 || ([v32 _layoutAttributes], (v101 = objc_claimAutoreleasedReturnValue()) != 0))
        {
          v34 = indexPath;
        }

        else
        {
          v34 = indexPath;
          v101 = [(UICollectionViewLayout *)selfCopy->_layout initialLayoutAttributesForAppearingItemAtIndexPath:indexPath];
          if (!v101)
          {
            v101 = [v28 copy];
            [v101 setAlpha:0.0];
          }
        }

        [v101 frame];
        v36 = v35;
        v38 = v37;
        v40 = v39;
        v42 = v41;
        [v28 frame];
        v119.origin.x = v43;
        v119.origin.y = v44;
        v119.size.width = v45;
        v119.size.height = v46;
        v116.origin.x = v36;
        v116.origin.y = v38;
        v116.size.width = v40;
        v116.size.height = v42;
        v117 = CGRectUnion(v116, v119);
        [(UICollectionViewLayout *)selfCopy->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v28 frame:v117.origin.x, v117.origin.y, v117.size.width, v117.size.height];
        v120.origin.x = v47;
        v120.origin.y = v48;
        v120.size.width = v49;
        v120.size.height = v50;
        v118.origin.x = v17;
        v118.origin.y = v19;
        v118.size.width = v21;
        v118.size.height = v23;
        if (CGRectIntersectsRect(v118, v120))
        {
          v102 = v28;
          if (v33)
          {
            goto LABEL_11;
          }

          if ([v101 isHidden] && (objc_msgSend(v102, "isHidden") & 1) != 0 || (-[_UICollectionViewDragAndDropController isCellPerformingLegacyReorderingAtIndexPath:](selfCopy->_dragAndDropController, v34) & 1) != 0 || (-[NSIndexPath isEqual:](selfCopy->_cancellingToIndexPath, "isEqual:", v34) & 1) != 0)
          {
            v33 = 0;
          }

          else
          {
            v71 = [v101 copy];
            if (dyld_program_sdk_at_least())
            {
              [v71 indexPath];
              v73 = v72 = v31;
              v74 = [v73 isEqual:v34];

              v31 = v72;
              if ((v74 & 1) == 0)
              {
                [v71 setIndexPath:v34];
              }
            }

            v33 = [(UICollectionView *)selfCopy _preparedCellForItemAtIndexPath:v34 withLayoutAttributes:v71 applyAttributes:1 isFocused:0 notify:1];
            if (_estimatesSizes && (*(&p_responderFlags[680] + 1) & 4) != 0)
            {
              v75 = v31;
              [(UICollectionViewData *)selfCopy->_collectionViewData invalidate:?];
              v76 = [(UICollectionViewData *)selfCopy->_collectionViewData layoutAttributesForItemAtIndexPath:v34];
              v77 = [v76 copy];

              v31 = v75;
              [v101 frame];
              v79 = v78;
              v81 = v80;
              [v77 frame];
              [v101 setFrame:{v79, v81}];
              [(UICollectionView *)selfCopy _applyLayoutAttributes:v101 toView:v33];
              v102 = v77;
            }

            v26 = v94;
            [(_UICollectionViewSubviewCollection *)collectionCopy setCell:v33 atIndexPath:v34];

            if (v33)
            {
LABEL_11:
              v96 = v31;
              LOBYTE(v85) = 1;
              v51 = [(UICollectionView *)selfCopy _viewAnimationsForView:v33 startingLayoutAttributes:v101 endingLayoutAttributes:v102 startingLayout:selfCopy->_layout endingLayout:selfCopy->_layout animationSetup:0 animationCompletion:0 enableCustomAnimations:v85 customAnimationsType:2];
              orthogonalScrollerController = selfCopy->_orthogonalScrollerController;
              _layoutAttributes = [v33 _layoutAttributes];
              LOBYTE(orthogonalScrollerController) = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:_layoutAttributes];

              if ((orthogonalScrollerController & 1) == 0)
              {
                v105 = 0u;
                v106 = 0u;
                v103 = 0u;
                v104 = 0u;
                v93 = v51;
                v54 = v51;
                v55 = [v54 countByEnumeratingWithState:&v103 objects:v113 count:16];
                if (v55)
                {
                  v56 = v55;
                  v57 = *v104;
                  do
                  {
                    v58 = 0;
                    do
                    {
                      if (*v104 != v57)
                      {
                        objc_enumerationMutation(v54);
                      }

                      v59 = *(*(&v103 + 1) + 8 * v58);
                      superview = [v33 superview];
                      v61 = selfCopy;
                      v62 = [(UICollectionView *)selfCopy _subviewRouterForView:v33 attributes:v102 createIfNecessary:0];
                      v63 = v62;
                      if (v62)
                      {
                        v64 = *(v62 + 40);
                      }

                      else
                      {
                        v64 = 0;
                      }

                      v65 = v64;

                      if (superview != v65)
                      {
                        [v59 setParentInCollectionViewDuringAnimation:1];
                      }

                      ++v58;
                      selfCopy = v61;
                    }

                    while (v56 != v58);
                    v66 = [v54 countByEnumeratingWithState:&v103 objects:v113 count:16];
                    v56 = v66;
                  }

                  while (v66);
                }

                updateCopy = v90;
                v24 = v91;
                v34 = indexPath;
                v51 = v93;
              }

              [updateCopy addObjectsFromArray:v51];
              if ([v51 count] == 1)
              {
                v67 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v34];
                v68 = [v51 objectAtIndexedSubscript:0];
                [v92 setObject:v68 forKeyedSubscript:v67];
              }

              has_internal_diagnostics = os_variant_has_internal_diagnostics();
              v70 = [v24 containsIndex:v98];
              v26 = v94;
              if (has_internal_diagnostics)
              {
                if (v70)
                {
                  v82 = __UIFaultDebugAssertLog();
                  if (os_log_type_enabled(v82, OS_LOG_TYPE_FAULT))
                  {
                    *buf = 134217984;
                    v112 = v98;
                    _os_log_fault_impl(&dword_188A29000, v82, OS_LOG_TYPE_FAULT, "attempt to create two animations for new global item index %ld", buf, 0xCu);
                  }

                  v24 = v91;
                  v26 = v94;
                  v34 = indexPath;
                }
              }

              else if (v70)
              {
                v83 = *(__UILogGetCategoryCachedImpl("Assert", &_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews_attributesForNewModel____s_category) + 8);
                if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
                {
                  *buf = 134217984;
                  v112 = v98;
                  _os_log_impl(&dword_188A29000, v83, OS_LOG_TYPE_ERROR, "attempt to create two animations for new global item index %ld", buf, 0xCu);
                }
              }

              [v24 addIndex:v98];

              v31 = v96;
            }
          }
        }

        v27 = v99 + 1;
      }

      while (v99 + 1 != v26);
      v84 = [obj countByEnumeratingWithState:&v107 objects:v114 count:16];
      v26 = v84;
    }

    while (v84);
  }
}

- (void)_createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:(id)update disappearingAnimations:(id)animations animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection oldVisibleViews:(id)visibleViews
{
  v133 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  animationsCopy = animations;
  viewsCopy = views;
  collectionCopy = collection;
  visibleViewsCopy = visibleViews;
  v13 = objc_opt_new();
  subviewManager = self->_subviewManager;
  v128[0] = MEMORY[0x1E69E9820];
  v128[1] = 3221225472;
  v128[2] = __185__UICollectionView__createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate_disappearingAnimations_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews___block_invoke;
  v128[3] = &unk_1E70FF6A0;
  v107 = visibleViewsCopy;
  v129 = v107;
  v15 = v13;
  v130 = v15;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAuxillariesWithEnumerator:v128];
  }

  existingSupplementaryLayoutAttributes = [(UICollectionViewData *)self->_currentUpdate->_oldModel existingSupplementaryLayoutAttributes];
  if (existingSupplementaryLayoutAttributes)
  {
    [v15 addObjectsFromArray:existingSupplementaryLayoutAttributes];
  }

  v106 = existingSupplementaryLayoutAttributes;
  [(UICollectionView *)self _visibleBounds];
  v18 = v17;
  v20 = v19;
  v22 = v21;
  v24 = v23;
  v124 = 0u;
  v125 = 0u;
  v126 = 0u;
  v127 = 0u;
  v25 = v15;
  v116 = [v25 countByEnumeratingWithState:&v124 objects:v132 count:16];
  if (v116)
  {
    v115 = *v125;
    v109 = v25;
    do
    {
      v26 = 0;
      do
      {
        if (*v125 != v115)
        {
          objc_enumerationMutation(v25);
        }

        v27 = *(*(&v124 + 1) + 8 * v26);
        indexPath = [v27 indexPath];
        if ([indexPath length] < 2)
        {
          section = 0x7FFFFFFFFFFFFFFFLL;
        }

        else
        {
          section = [indexPath section];
        }

        [indexPath item];
        _content = [(_UILabelConfiguration *)v27 _content];
        if (v27)
        {
          v30 = (v27[288] >> 1) & 1;
        }

        else
        {
          v30 = 0;
        }

        v117 = v26;
        currentUpdate = self->_currentUpdate;
        if (section == 0x7FFFFFFFFFFFFFFFLL)
        {
          v32 = _content;
          v33 = [(NSMutableDictionary *)currentUpdate->_deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:_content];
          v34 = [v33 containsIndex:{objc_msgSend(indexPath, "indexAtPosition:", 0)}];

          if ((v34 & 1) == 0)
          {
            goto LABEL_21;
          }
        }

        else
        {
          v32 = _content;
          v45 = [(UICollectionViewUpdate *)currentUpdate validatedNewIndexPathForSupplementaryElementOfKind:_content oldIndexPath:indexPath];

          if (v45)
          {
LABEL_21:
            v46 = [(UICollectionViewUpdate *)self->_currentUpdate newIndexPathForSupplementaryElementOfKind:v32 oldIndexPath:indexPath];
            [v27 frame];
            v48 = v47;
            v50 = v49;
            v52 = v51;
            v54 = v53;
            v55 = v32;
            if (v27)
            {
              newModel = self->_currentUpdate->_newModel;
              if ((v27[288] & 2) == 0)
              {
                goto LABEL_23;
              }

              v57 = [(UICollectionViewData *)newModel layoutAttributesForDecorationViewOfKind:v32 atIndexPath:v46];
              v58 = 1;
            }

            else
            {
              newModel = self->_currentUpdate->_newModel;
LABEL_23:
              v57 = [(UICollectionViewData *)newModel layoutAttributesForSupplementaryElementOfKind:v32 atIndexPath:v46];
              v58 = 0;
            }

            v59 = [(UICollectionView *)self _visibleSupplementaryViewOfKind:v55 atIndexPath:indexPath isDecorationView:v58];
            v60 = v59;
            if (v57)
            {
              [v57 frame];
              v140.origin.x = v61;
              v140.origin.y = v62;
              v140.size.width = v63;
              v140.size.height = v64;
              v134.origin.x = v48;
              v134.origin.y = v50;
              v134.size.width = v52;
              v134.size.height = v54;
              v135 = CGRectUnion(v134, v140);
              [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v27 frame:v135.origin.x, v135.origin.y, v135.size.width, v135.size.height];
              v141.origin.x = v65;
              v141.origin.y = v66;
              v141.size.width = v67;
              v141.size.height = v68;
              v136.origin.x = v18;
              v136.origin.y = v20;
              v136.size.width = v22;
              v136.size.height = v24;
              if (CGRectIntersectsRect(v136, v141) && v27 && !v60)
              {
                if (![v27 isHidden] || (objc_msgSend(v57, "isHidden") & 1) == 0)
                {
                  v69 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v55 atIndexPath:v46 layout:self->_layout withLayoutAttributes:v27 applyAttributes:1];
                  if (v69)
                  {
                    v60 = v69;
                    v70 = *(v27 + 72);
                    v71 = 1;
                    if ((v70 & 2) != 0)
                    {
                      v71 = 2;
                    }

                    if (v70)
                    {
                      v72 = 0;
                    }

                    else
                    {
                      v72 = v71;
                    }

                    [(_UICollectionViewSubviewCollection *)collectionCopy setView:v69 ofKind:v55 inCategory:v72 atIndexPath:v46];
LABEL_39:
                    LOBYTE(v105) = 1;
                    v73 = [(UICollectionView *)self _viewAnimationsForView:v60 startingLayoutAttributes:v27 endingLayoutAttributes:v57 startingLayout:self->_layout endingLayout:self->_layout animationSetup:0 animationCompletion:0 enableCustomAnimations:v105 customAnimationsType:2];
                    orthogonalScrollerController = self->_orthogonalScrollerController;
                    _layoutAttributes = [v60 _layoutAttributes];
                    LOBYTE(orthogonalScrollerController) = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:_layoutAttributes];

                    if ((orthogonalScrollerController & 1) == 0)
                    {
                      v76 = v57;
                      v112 = v73;
                      v113 = v46;
                      selfCopy = self;
                      v122 = 0u;
                      v123 = 0u;
                      v120 = 0u;
                      v121 = 0u;
                      obj = v73;
                      v78 = [(UICollectionViewAnimation *)obj countByEnumeratingWithState:&v120 objects:v131 count:16];
                      if (v78)
                      {
                        v79 = v78;
                        v80 = *v121;
                        do
                        {
                          v81 = 0;
                          do
                          {
                            if (*v121 != v80)
                            {
                              objc_enumerationMutation(obj);
                            }

                            v82 = *(*(&v120 + 1) + 8 * v81);
                            superview = [v60 superview];
                            v84 = [(UICollectionView *)selfCopy _subviewRouterForView:v60 attributes:v76 createIfNecessary:0];
                            v85 = v84;
                            if (v84)
                            {
                              v86 = *(v84 + 40);
                            }

                            else
                            {
                              v86 = 0;
                            }

                            v87 = v86;

                            if (superview != v87)
                            {
                              [v82 setParentInCollectionViewDuringAnimation:1];
                            }

                            ++v81;
                          }

                          while (v79 != v81);
                          v88 = [(UICollectionViewAnimation *)obj countByEnumeratingWithState:&v120 objects:v131 count:16];
                          v79 = v88;
                        }

                        while (v88);
                      }

                      self = selfCopy;
                      v25 = v109;
                      v73 = v112;
                      v46 = v113;
                      v57 = v76;
                    }

                    if ([(UICollectionViewAnimation *)v73 count]== 1)
                    {
                      v89 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v57];
                      v90 = [(UICollectionViewAnimation *)v73 objectAtIndexedSubscript:0];
                      [viewsCopy setObject:v90 forKey:v89];
                    }

                    [updateCopy addObjectsFromArray:v73];
LABEL_59:
                    v35 = v117;
                    goto LABEL_60;
                  }
                }
              }

              else if (v60)
              {
                goto LABEL_39;
              }
            }

            else
            {
              if (v59)
              {
                _layoutAttributes2 = [v59 _layoutAttributes];
                v57 = [_layoutAttributes2 copy];

                [v57 setAlpha:0.0];
                v73 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v60 toLayoutAttributes:v57 type:2];
                v92 = [[UICollectionViewAnimation alloc] initWithView:v60 viewType:2 finalLayoutAttributes:v57 startFraction:0 endFraction:1 animateFromCurrentPostion:v73 deleteAfterAnimation:0.0 customAnimations:1.0];
                v93 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v57];
                [updateCopy addObject:v92];
                [animationsCopy setObject:v92 forKey:v93];

                goto LABEL_59;
              }

              v57 = 0;
            }

            v35 = v117;
            goto LABEL_67;
          }
        }

        v35 = v117;
        if ([(NSIndexSet *)self->_currentUpdate->_deletedSections containsIndex:section])
        {
          goto LABEL_69;
        }

        [v27 frame];
        v37 = v36;
        v39 = v38;
        v41 = v40;
        v43 = v42;
        layout = self->_layout;
        if (v30)
        {
          [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingDecorationElementOfKind:_content atIndexPath:indexPath];
        }

        else
        {
          [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingSupplementaryElementOfKind:_content atIndexPath:indexPath];
        }
        v94 = ;
        [v94 frame];
        v142.origin.x = v95;
        v142.origin.y = v96;
        v142.size.width = v97;
        v142.size.height = v98;
        v137.origin.x = v37;
        v137.origin.y = v39;
        v137.size.width = v41;
        v137.size.height = v43;
        v138 = CGRectUnion(v137, v142);
        v46 = v94;
        [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v94 frame:v138.origin.x, v138.origin.y, v138.size.width, v138.size.height];
        v143.origin.x = v99;
        v143.origin.y = v100;
        v143.size.width = v101;
        v143.size.height = v102;
        v139.origin.x = v18;
        v139.origin.y = v20;
        v139.size.width = v22;
        v139.size.height = v24;
        if (CGRectIntersectsRect(v139, v143))
        {
          v57 = [(UICollectionView *)self _visibleSupplementaryViewOfKind:_content atIndexPath:indexPath isDecorationView:v30];
          if (v57)
          {
            v60 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v57 toLayoutAttributes:v94 type:2];
            v73 = [[UICollectionViewAnimation alloc] initWithView:v57 viewType:2 finalLayoutAttributes:v94 startFraction:1 endFraction:1 animateFromCurrentPostion:v60 deleteAfterAnimation:0.0 customAnimations:1.0];
            [updateCopy addObject:v73];
            v103 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v46];
            [animationsCopy setObject:v73 forKey:v103];

LABEL_60:
          }

LABEL_67:
        }

LABEL_69:
        v26 = v35 + 1;
      }

      while (v26 != v116);
      v104 = [v25 countByEnumeratingWithState:&v124 objects:v132 count:16];
      v116 = v104;
    }

    while (v104);
  }
}

void __185__UICollectionView__createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate_disappearingAnimations_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  v7 = a5;
  if (([v7 _isInUpdateAnimation] & 1) == 0 && objc_msgSend(*(a1 + 32), "containsObject:", v7))
  {
    v6 = [v7 _layoutAttributes];
    [*(a1 + 40) addObject:v6];
  }
}

- (void)_createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:(id)update appearingAnimations:(id)animations newSubviewCollection:(id)collection
{
  v56 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  animationsCopy = animations;
  collectionCopy = collection;
  [(UICollectionView *)self _visibleBounds];
  v46[0] = MEMORY[0x1E69E9820];
  v46[1] = 3221225472;
  v47 = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke;
  v48 = &unk_1E70FF6C8;
  selfCopy = self;
  v51 = v9;
  v52 = v10;
  v53 = v11;
  v54 = v12;
  v32 = collectionCopy;
  v50 = v32;
  selfCopy2 = self;
  numberOfSections = [(UICollectionViewData *)self->_currentUpdate->_newModel numberOfSections];
  if (numberOfSections >= 1)
  {
    v14 = numberOfSections;
    v15 = 0;
    v33 = numberOfSections;
    do
    {
      if (![(NSIndexSet *)selfCopy2->_currentUpdate->_insertedSections containsIndex:v15, v32])
      {
        v16 = [(UICollectionViewData *)selfCopy2->_currentUpdate->_newModel existingSupplementaryLayoutAttributesInSection:v15];
        v42 = 0u;
        v43 = 0u;
        v44 = 0u;
        v45 = 0u;
        obj = v16;
        v17 = [v16 countByEnumeratingWithState:&v42 objects:v55 count:16];
        if (v17)
        {
          v18 = v17;
          v19 = *v43;
          do
          {
            for (i = 0; i != v18; ++i)
            {
              if (*v43 != v19)
              {
                objc_enumerationMutation(obj);
              }

              v21 = *(*(&v42 + 1) + 8 * i);
              indexPath = [v21 indexPath];
              _content = [(_UILabelConfiguration *)v21 _content];
              v24 = [(NSMutableArray *)selfCopy2->_currentUpdate->_insertedSupplementaryIndexesSectionArray objectAtIndexedSubscript:v15];
              v25 = [v24 objectForKey:_content];
              v26 = [v25 containsIndex:{objc_msgSend(indexPath, "item")}];

              if (v26)
              {
                v27 = v47(v46, v21);
                if (v27)
                {
                  [updateCopy addObject:v27];
                  v28 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v21];
                  [animationsCopy setObject:v27 forKey:v28];
                }
              }
            }

            v18 = [obj countByEnumeratingWithState:&v42 objects:v55 count:16];
          }

          while (v18);
        }

        v14 = v33;
      }

      ++v15;
    }

    while (v15 != v14);
  }

  insertedSupplementaryTopLevelIndexesDict = selfCopy2->_currentUpdate->_insertedSupplementaryTopLevelIndexesDict;
  v38[0] = MEMORY[0x1E69E9820];
  v38[1] = 3221225472;
  v38[2] = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2;
  v38[3] = &unk_1E70FF718;
  v38[4] = selfCopy2;
  v39 = updateCopy;
  v41 = v46;
  v40 = animationsCopy;
  v30 = animationsCopy;
  v31 = updateCopy;
  [(NSMutableDictionary *)insertedSupplementaryTopLevelIndexesDict enumerateKeysAndObjectsUsingBlock:v38];
}

UICollectionViewAnimation *__129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = v3;
  if (v3)
  {
    v5 = (v3[288] >> 1) & 1;
  }

  else
  {
    v5 = 0;
  }

  v6 = [(_UILabelConfiguration *)v3 _content];
  v7 = [v4 indexPath];
  v8 = *(*(a1 + 32) + 2152);
  if (v5)
  {
    [v8 initialLayoutAttributesForAppearingDecorationElementOfKind:v6 atIndexPath:v7];
  }

  else
  {
    [v8 initialLayoutAttributesForAppearingSupplementaryElementOfKind:v6 atIndexPath:v7];
  }
  v9 = ;
  if (!v9)
  {
    v9 = [v4 copy];
    [v9 setAlpha:0.0];
  }

  [v9 frame];
  v11 = v10;
  v13 = v12;
  v15 = v14;
  v17 = v16;
  [v4 frame];
  v40.origin.x = v18;
  v40.origin.y = v19;
  v40.size.width = v20;
  v40.size.height = v21;
  v38.origin.x = v11;
  v38.origin.y = v13;
  v38.size.width = v15;
  v38.size.height = v17;
  v39 = CGRectUnion(v38, v40);
  [*(*(a1 + 32) + 2152) _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v4 frame:{v39.origin.x, v39.origin.y, v39.size.width, v39.size.height}];
  v23 = v22;
  v25 = v24;
  v27 = v26;
  v29 = v28;
  if ([v9 isHidden] && objc_msgSend(v4, "isHidden"))
  {
    v30 = dyld_program_sdk_at_least();
  }

  else
  {
    v30 = 0;
  }

  v41.origin.x = v23;
  v41.origin.y = v25;
  v41.size.width = v27;
  v41.size.height = v29;
  v31 = 0;
  if (CGRectIntersectsRect(*(a1 + 48), v41) && (v30 & 1) == 0)
  {
    v32 = [*(a1 + 32) _createPreparedSupplementaryViewForElementOfKind:v6 atIndexPath:v7 layout:*(*(a1 + 32) + 2152) withLayoutAttributes:v9 applyAttributes:1];
    if (v32)
    {
      v33 = v32;
      v34 = *(a1 + 40);
      if (v5)
      {
        [(_UICollectionViewSubviewCollection *)v34 setView:v33 forDecorationOfKind:v6 atIndexPath:v7];
      }

      else
      {
        [(_UICollectionViewSubviewCollection *)v34 setView:v33 forSupplementaryOfKind:v6 atIndexPath:v7];
      }

      [*(a1 + 32) _addControlledSubview:v33 atZIndex:objc_msgSend(v4 forced:"zIndex") initialAttributes:{0, 0}];
      v35 = [*(*(a1 + 32) + 2152) _animationForReusableView:v33 toLayoutAttributes:v4 type:2];
      v31 = [[UICollectionViewAnimation alloc] initWithView:v33 viewType:2 finalLayoutAttributes:v4 startFraction:0 endFraction:0 animateFromCurrentPostion:v35 deleteAfterAnimation:0.0 customAnimations:1.0];
    }

    else
    {
      v31 = 0;
    }
  }

  return v31;
}

void __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_3;
  v7[3] = &unk_1E70FF6F0;
  v5 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v6 = *(a1 + 56);
  v10 = a2;
  v11 = v6;
  v8 = v5;
  v9 = *(a1 + 48);
  [a3 enumerateIndexesUsingBlock:v7];
}

void __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_3(uint64_t a1, uint64_t a2)
{
  v11 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) knownDecorationElementKinds];
  v4 = [v11 containsObject:*(a1 + 56)];
  v5 = [MEMORY[0x1E696AC88] indexPathWithIndex:a2];
  v6 = *(*(*(a1 + 32) + 2280) + 24);
  v7 = *(a1 + 56);
  if (v4)
  {
    [(UICollectionViewData *)v6 layoutAttributesForDecorationViewOfKind:v7 atIndexPath:v5];
  }

  else
  {
    [(UICollectionViewData *)v6 layoutAttributesForSupplementaryElementOfKind:v7 atIndexPath:v5];
  }
  v8 = ;
  v9 = (*(*(a1 + 64) + 16))();
  if (v9)
  {
    [*(a1 + 40) addObject:v9];
    v10 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v8];
    [*(a1 + 48) setObject:v9 forKey:v10];
  }
}

- (void)_createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:(id)update appearingAnimations:(id)animations animationsForOnScreenViews:(id)views newSubviewCollection:(id)collection attributesForNewModel:(id)model
{
  v53 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  animationsCopy = animations;
  viewsCopy = views;
  collectionCopy = collection;
  v15 = animationsCopy;
  v39 = collectionCopy;
  modelCopy = model;
  if (dyld_program_sdk_at_least() && [(UICollectionViewLayout *)self->_layout _wantsAnimationsForOffscreenAuxillaries])
  {
    selfCopy = self;
    v50 = 0u;
    v51 = 0u;
    v48 = 0u;
    v49 = 0u;
    v38 = modelCopy;
    obj = modelCopy;
    v17 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
    if (!v17)
    {
      goto LABEL_40;
    }

    v18 = v17;
    v19 = *v49;
    v42 = v15;
    v43 = viewsCopy;
    while (1)
    {
      v20 = 0;
      do
      {
        if (*v49 != v19)
        {
          objc_enumerationMutation(obj);
        }

        v21 = *(*(&v48 + 1) + 8 * v20);
        if (v21)
        {
          v22 = *(v21 + 288);
          if ((v22 & 3) != 1)
          {
            v23 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:?];
            _content = [viewsCopy objectForKey:v23];
            if (_content)
            {
              goto LABEL_11;
            }

            v25 = [v15 objectForKey:v23];

            if (!v25)
            {
              _content = [(_UILabelConfiguration *)v21 _content];
              indexPath = [v21 indexPath];
              v26 = [(UICollectionViewUpdate *)selfCopy->_currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:_content newIndexPath:indexPath];
              v46 = [UICollectionView _visibleSupplementaryViewOfKind:selfCopy atIndexPath:"_visibleSupplementaryViewOfKind:atIndexPath:isDecorationView:" isDecorationView:_content];
              if (!v26)
              {
                goto LABEL_44;
              }

              v27 = v26;
              section = [v26 section];
              v29 = section < [(UICollectionViewData *)selfCopy->_currentUpdate->_oldModel numberOfSections];
              v26 = v27;
              if (!v29 && [v27 item] != 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_44;
              }

              oldModel = selfCopy->_currentUpdate->_oldModel;
              if ((v22 & 2) != 0)
              {
                [(UICollectionViewData *)oldModel layoutAttributesForDecorationViewOfKind:_content atIndexPath:v27];
              }

              else
              {
                [(UICollectionViewData *)oldModel layoutAttributesForSupplementaryElementOfKind:_content atIndexPath:v27];
              }
              _layoutAttributes = ;
              if (!_layoutAttributes)
              {
LABEL_44:
                _layoutAttributes = [v46 _layoutAttributes];
                if (!_layoutAttributes)
                {
                  layout = selfCopy->_layout;
                  if ((v22 & 2) != 0)
                  {
                    [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingDecorationElementOfKind:_content atIndexPath:indexPath];
                  }

                  else
                  {
                    [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingSupplementaryElementOfKind:_content atIndexPath:indexPath];
                  }
                  _layoutAttributes = ;
                  if (!_layoutAttributes)
                  {
                    _layoutAttributes = [v21 copy];
                    [_layoutAttributes setAlpha:0.0];
                  }
                }
              }

              isHidden = [v21 isHidden];
              if (v26 && (isHidden & 1) == 0 && !v46)
              {
                v41 = v26;
                v34 = [(UICollectionView *)selfCopy _createPreparedSupplementaryViewForElementOfKind:_content atIndexPath:indexPath layout:selfCopy->_layout withLayoutAttributes:_layoutAttributes applyAttributes:1];
                if (v34)
                {
                  if ((v22 & 2) != 0)
                  {
                    [(_UICollectionViewSubviewCollection *)v39 setView:v34 forDecorationOfKind:_content atIndexPath:indexPath];
                  }

                  else
                  {
                    [(_UICollectionViewSubviewCollection *)v39 setView:v34 forSupplementaryOfKind:_content atIndexPath:indexPath];
                  }

                  v35 = [(UICollectionViewLayout *)selfCopy->_layout _animationForReusableView:v34 toLayoutAttributes:v21 type:2];
                  v36 = [[UICollectionViewAnimation alloc] initWithView:v34 viewType:2 finalLayoutAttributes:v21 startFraction:0 endFraction:0 animateFromCurrentPostion:v35 deleteAfterAnimation:0.0 customAnimations:1.0];
                  [v43 setObject:v36 forKey:v23];
                  [updateCopy addObject:v36];
                }

                v26 = v41;
              }

              v15 = v42;
              viewsCopy = v43;
LABEL_11:
            }
          }
        }

        ++v20;
      }

      while (v18 != v20);
      v37 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
      v18 = v37;
      if (!v37)
      {
LABEL_40:

        modelCopy = v38;
        break;
      }
    }
  }
}

- (void)_updateOrderingOfViewsInDisappearingViewAnimations:(id)animations onScreenViewAnimations:(id)viewAnimations
{
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke;
  v9[3] = &unk_1E70FF740;
  v9[4] = self;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_2;
  v8[3] = &unk_1E70FF768;
  v8[4] = self;
  v8[5] = v9;
  viewAnimationsCopy = viewAnimations;
  [animations enumerateKeysAndObjectsUsingBlock:v8];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_908;
  v7[3] = &unk_1E70FF768;
  v7[4] = self;
  v7[5] = v9;
  [viewAnimationsCopy enumerateKeysAndObjectsUsingBlock:v7];
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke(uint64_t a1, void *a2, void *a3, void *a4)
{
  v11 = a2;
  v7 = a4;
  if (v11)
  {
    if (a3)
    {
      v8 = a3;
      v9 = [v11 zIndex];
      v10 = [v8 zIndex];

      if (v9 == v10)
      {
        [*(a1 + 32) _addControlledSubview:v7 atZIndex:objc_msgSend(v11 forced:{"zIndex"), 1}];
      }
    }
  }
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v19 = *MEMORY[0x1E69E9840];
  v4 = a3;
  has_internal_diagnostics = os_variant_has_internal_diagnostics();
  v6 = [v4 deleteAfterAnimation];
  if (has_internal_diagnostics)
  {
    if ((v6 & 1) == 0)
    {
      v11 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
      {
        v14 = *(a1 + 32);
        v15 = 138412546;
        v16 = v14;
        v17 = 2112;
        v18 = v4;
        _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: expected disappearing view to be deleted after its animation completes. Collection view: %@; Animation: %@", &v15, 0x16u);
      }
    }
  }

  else if ((v6 & 1) == 0)
  {
    v12 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_9___s_category) + 8);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      v13 = *(a1 + 32);
      v15 = 138412546;
      v16 = v13;
      v17 = 2112;
      v18 = v4;
      _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: expected disappearing view to be deleted after its animation completes. Collection view: %@; Animation: %@", &v15, 0x16u);
    }
  }

  v7 = [v4 view];
  v8 = *(a1 + 40);
  v9 = [v7 _layoutAttributes];
  v10 = [v4 finalLayoutAttributes];
  (*(v8 + 16))(v8, v9, v10, v7);
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_908(uint64_t a1, uint64_t a2, void *a3)
{
  v30 = *MEMORY[0x1E69E9840];
  v4 = a3;
  has_internal_diagnostics = os_variant_has_internal_diagnostics();
  v6 = [v4 deleteAfterAnimation];
  if (has_internal_diagnostics)
  {
    if (v6)
    {
      v22 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
      {
        v25 = *(a1 + 32);
        v26 = 138412546;
        v27 = v25;
        v28 = 2112;
        v29 = v4;
        _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: on-screen view is unexpectedly scheduled to delete after its animation completes. Collection view: %@; Animation: %@", &v26, 0x16u);
      }
    }
  }

  else if (v6)
  {
    v23 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_10___s_category) + 8);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      v24 = *(a1 + 32);
      v26 = 138412546;
      v27 = v24;
      v28 = 2112;
      v29 = v4;
      _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: on-screen view is unexpectedly scheduled to delete after its animation completes. Collection view: %@; Animation: %@", &v26, 0x16u);
    }
  }

  v7 = [v4 view];
  v8 = [v7 _layoutAttributes];
  [v8 frame];
  v10 = v9;
  v12 = v11;
  v13 = [v4 finalLayoutAttributes];
  [v13 frame];
  v15 = vabdd_f64(v10, v14);
  v17 = vabdd_f64(v12, v16);

  if (v15 >= 0.00000011920929 || v17 >= 0.00000011920929)
  {
    v19 = *(a1 + 40);
    v20 = [v7 _layoutAttributes];
    v21 = [v4 finalLayoutAttributes];
    (*(v19 + 16))(v19, v20, v21, v7);
  }
}

- (void)_removeUntrackedAuxillaryViewsForBeforeVisibleViews:(id)views afterVisibleViews:(id)visibleViews withTrackingViewAnimations:(id)animations
{
  v36 = *MEMORY[0x1E69E9840];
  viewsCopy = views;
  visibleViewsCopy = visibleViews;
  animationsCopy = animations;
  v10 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:{objc_msgSend(animationsCopy, "count")}];
  v33[0] = MEMORY[0x1E69E9820];
  v33[1] = 3221225472;
  v33[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke;
  v33[3] = &unk_1E70FFC70;
  v11 = v10;
  v34 = v11;
  [(_UICollectionViewSubviewCollection *)visibleViewsCopy enumerateSupplementariesWithEnumerator:v33];
  v31[0] = MEMORY[0x1E69E9820];
  v31[1] = 3221225472;
  v31[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_2;
  v31[3] = &unk_1E70FFC70;
  v12 = v11;
  v32 = v12;
  [(_UICollectionViewSubviewCollection *)visibleViewsCopy enumerateDecorationsWithEnumerator:v31];
  v13 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:{objc_msgSend(animationsCopy, "count")}];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v14 = animationsCopy;
  v15 = [v14 countByEnumeratingWithState:&v27 objects:v35 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v28;
    do
    {
      v18 = 0;
      do
      {
        if (*v28 != v17)
        {
          objc_enumerationMutation(v14);
        }

        view = [*(*(&v27 + 1) + 8 * v18) view];
        [v13 addObject:view];

        ++v18;
      }

      while (v16 != v18);
      v16 = [v14 countByEnumeratingWithState:&v27 objects:v35 count:16];
    }

    while (v16);
  }

  v23[4] = v24;
  v24[0] = MEMORY[0x1E69E9820];
  v24[1] = 3221225472;
  v24[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_3;
  v24[3] = &unk_1E70FF2F8;
  v25 = v12;
  v26 = v13;
  v23[0] = MEMORY[0x1E69E9820];
  v23[1] = 3221225472;
  v23[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_4;
  v23[3] = &__block_descriptor_40_e67_v40__0__NSIndexPath_8__NSString_16__UICollectionReusableView_24_B32lu32l8;
  v20 = v13;
  v21 = v12;
  if (viewsCopy)
  {
    [(_UICollectionViewSubviewCollection *)viewsCopy[1] enumerateSupplementariesWithEnumerator:v23];
  }

  v22[0] = MEMORY[0x1E69E9820];
  v22[1] = 3221225472;
  v22[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_5;
  v22[3] = &__block_descriptor_40_e67_v40__0__NSIndexPath_8__NSString_16__UICollectionReusableView_24_B32lu32l8;
  v22[4] = v24;
  if (viewsCopy)
  {
    [(_UICollectionViewSubviewCollection *)viewsCopy[1] enumerateDecorationsWithEnumerator:v22];
  }
}

void __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_3(uint64_t a1, void *a2)
{
  v3 = a2;
  if (([*(a1 + 32) containsObject:?] & 1) == 0 && (objc_msgSend(*(a1 + 40), "containsObject:", v3) & 1) == 0)
  {
    [v3 removeFromSuperview];
  }
}

- (void)_setupExpandCollapseAnimationsIfNeededWithContext:(id)context
{
  contextCopy = context;
  dataSource = [(UICollectionView *)self dataSource];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
    v7 = [_dataSourceProxy _expandCollapseAnimationContextForCollectionView:self];
    if (v7)
    {
      _UICollectionViewSetupExpandCollapseAnimations(self, contextCopy, v7);
    }
  }
}

- (void)_updatePreferredAttributesForCurrentUpdate:(unint64_t)update
{
  v64 = *MEMORY[0x1E69E9840];
  if (update >= 0x65)
  {
    if (os_variant_has_internal_diagnostics())
    {
      v45 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v45, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        selfCopy2 = self;
        _os_log_fault_impl(&dword_188A29000, v45, OS_LOG_TYPE_FAULT, "UICollectionView exceeded the maximum allowed number of preferred attribute update passes while preparing update animations. This likely indicates a bug in the sizing implementation of self-sizing views, which prevents the layout from converging on a stable solution. Views may animate incorrectly as a result. %@", buf, 0xCu);
      }
    }

    else
    {
      v4 = *(__UILogGetCategoryCachedImpl("Assert", &_updatePreferredAttributesForCurrentUpdate____s_category) + 8);
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        selfCopy2 = self;
        _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "UICollectionView exceeded the maximum allowed number of preferred attribute update passes while preparing update animations. This likely indicates a bug in the sizing implementation of self-sizing views, which prevents the layout from converging on a stable solution. Views may animate incorrectly as a result. %@", buf, 0xCu);
      }
    }

    return;
  }

  updateCopy = update;
  v6 = dyld_program_sdk_at_least();
  p_collectionViewFlags = &self->_collectionViewFlags;
  v8 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v8 & 0xFFFFFFFFFFFFFBFFLL;
  [(UICollectionView *)self _visibleBounds];
  x = v9;
  y = v10;
  width = v11;
  height = v12;
  if ((v6 & 1) == 0)
  {
    v17 = CGRectGetWidth(*&v9) * -0.5;
    v65.origin.x = x;
    v65.origin.y = y;
    v65.size.width = width;
    v65.size.height = height;
    v18 = CGRectGetHeight(v65) * -0.5;
    v66.origin.x = x;
    v66.origin.y = y;
    v66.size.width = width;
    v66.size.height = height;
    v67 = CGRectInset(v66, v17, v18);
    x = v67.origin.x;
    y = v67.origin.y;
    width = v67.size.width;
    height = v67.size.height;
  }

  _estimatesSupplementaryItems = [(UICollectionViewLayout *)self->_layout _estimatesSupplementaryItems];
  [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
  v20 = _UISetCurrentFallbackEnvironment(self);
  v53 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v21 = _estimatesSupplementaryItems;
  v52 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v22 = dyld_program_sdk_at_least();
  if (_estimatesSupplementaryItems)
  {
    v23 = dyld_program_sdk_at_least();
  }

  else
  {
    v23 = 0;
  }

  v55 = v23;
  if ((v22 | v23))
  {
    v46 = _estimatesSupplementaryItems;
    v47 = v20;
    v48 = v8;
    v49 = &self->_collectionViewFlags;
    v50 = v6;
    v51 = updateCopy;
    [(UICollectionViewLayout *)self->_layout _extendedAttributesQueryIncludingOrthogonalScrollingRegions:x, y, width, height];
    v57 = 0u;
    v58 = 0u;
    v59 = 0u;
    obj = v60 = 0u;
    v24 = [obj countByEnumeratingWithState:&v57 objects:v61 count:16];
    v25 = v55;
    if (!v24)
    {
      goto LABEL_41;
    }

    v26 = v24;
    v27 = *v58;
    selfCopy3 = self;
    while (1)
    {
      v28 = 0;
      do
      {
        if (*v58 != v27)
        {
          objc_enumerationMutation(obj);
        }

        v29 = *(*(&v57 + 1) + 8 * v28);
        if (v29)
        {
          v30 = *(v29 + 288) & 1;
          v31 = (*(v29 + 288) & 3) == 0;
        }

        else
        {
          v30 = 0;
          v31 = 0;
        }

        if (v22 & 1 | ((v30 & 1) == 0) && ((!v31 | v25) & 1) != 0)
        {
          indexPath = [*(*(&v57 + 1) + 8 * v28) indexPath];
          if (!indexPath)
          {
LABEL_36:

            goto LABEL_37;
          }

          if (v30)
          {
            v33 = [(UICollectionViewUpdate *)self->_currentUpdate initialIndexPathForFinalIndexPath:indexPath];
            if (!v33)
            {
              goto LABEL_35;
            }

            v34 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v33];

            if (v34)
            {
              self = selfCopy3;
              if (!v31)
              {
LABEL_35:

                v25 = v55;
                goto LABEL_36;
              }

LABEL_29:
              subviewManager = self->_subviewManager;
              _content = [(_UILabelConfiguration *)v29 _content];
              v39 = [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementaryOfKind:_content atIndexPath:v33];

              if (!v39)
              {
                v40 = v52;
                v41 = v29;
                goto LABEL_33;
              }
            }

            else
            {
              v40 = v53;
              v41 = indexPath;
LABEL_33:
              [v40 addObject:v41];
            }
          }

          else
          {
            if (!v31)
            {
              v33 = 0;
              goto LABEL_35;
            }

            currentUpdate = self->_currentUpdate;
            _content2 = [(_UILabelConfiguration *)v29 _content];
            v33 = [(UICollectionViewUpdate *)currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:_content2 newIndexPath:indexPath];

            if (v33)
            {
              self = selfCopy3;
              goto LABEL_29;
            }
          }

          self = selfCopy3;
          goto LABEL_35;
        }

LABEL_37:
        ++v28;
      }

      while (v26 != v28);
      v42 = [obj countByEnumeratingWithState:&v57 objects:v61 count:16];
      v26 = v42;
      if (!v42)
      {
LABEL_41:

        updateCopy = v51;
        v6 = v50;
        LOWORD(v8) = v48;
        p_collectionViewFlags = v49;
        v20 = v47;
        v21 = v46;
        break;
      }
    }
  }

  height = [(UICollectionView *)self _updatePreferredAttributesForItemsInCurrentUpdateWithRect:v53 newlyVisible:updateCopy == 0 includeInserts:x, y, width, height];
  if (v21)
  {
    height |= [(UICollectionView *)self _updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:v52 newlyVisible:updateCopy == 0 includeInserts:x, y, width, height];
  }

  _UIRestorePreviousFallbackEnvironment(v20);
  [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:*MEMORY[0x1E695EFF8], *(MEMORY[0x1E695EFF8] + 8)];
  v44 = *(p_collectionViewFlags + 1);
  *(p_collectionViewFlags + 1) = v44 | v8 & 0x400;
  if ((v6 & height) == 1 && (v44 & 0x400) != 0)
  {
    [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate:updateCopy + 1];
  }
}

- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdateWithRect:(CGRect)rect newlyVisible:(id)visible includeInserts:(BOOL)inserts
{
  insertsCopy = inserts;
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  v56 = *MEMORY[0x1E69E9840];
  visibleCopy = visible;
  v11 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  if (insertsCopy)
  {
    v47 = 0u;
    v48 = 0u;
    v45 = 0u;
    v46 = 0u;
    v12 = self->_insertItems;
    v13 = [(NSMutableArray *)v12 countByEnumeratingWithState:&v45 objects:v55 count:16];
    if (v13)
    {
      v14 = v13;
      v15 = *v46;
      v41 = v12;
      selfCopy = self;
      do
      {
        for (i = 0; i != v14; ++i)
        {
          if (*v46 != v15)
          {
            objc_enumerationMutation(v12);
          }

          v17 = *(*(&v45 + 1) + 8 * i);
          if (v17 && v17[6] == 0x7FFFFFFFFFFFFFFFLL)
          {
            v18 = v17[3];
            indexPathAfterUpdate = self->_currentUpdate->_newModel;
            if (v18 < [(UICollectionViewData *)indexPathAfterUpdate numberOfSections])
            {
              v20 = [(UICollectionViewData *)indexPathAfterUpdate numberOfItemsInSection:v18];
              if (v20 >= 1)
              {
                v21 = v20;
                for (j = 0; j != v21; ++j)
                {
                  v23 = [MEMORY[0x1E696AC88] indexPathForItem:j inSection:v18];
                  [v11 addObject:v23];
                }

                v12 = v41;
                self = selfCopy;
              }
            }
          }

          else
          {
            indexPathAfterUpdate = [v17 indexPathAfterUpdate];
            [v11 addObject:indexPathAfterUpdate];
          }
        }

        v14 = [(NSMutableArray *)v12 countByEnumeratingWithState:&v45 objects:v55 count:16];
      }

      while (v14);
    }
  }

  subviewManager = self->_subviewManager;
  v43[0] = MEMORY[0x1E69E9820];
  v43[1] = 3221225472;
  v43[2] = __106__UICollectionView__updatePreferredAttributesForItemsInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke;
  v43[3] = &unk_1E70FF7B0;
  v43[4] = self;
  v25 = v11;
  v44 = v25;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v43];
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492598);
  if (*CategoryCachedImpl)
  {
    v32 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      v33 = v32;
      v34 = [visibleCopy valueForKey:@"_ui_shortDescription"];
      v35 = [v25 valueForKey:@"_ui_shortDescription"];
      *buf = 134218498;
      selfCopy3 = self;
      v51 = 2112;
      v52 = v34;
      v53 = 2112;
      v54 = v35;
      _os_log_impl(&dword_188A29000, v33, OS_LOG_TYPE_ERROR, "_updatePreferredAttributesForCurrentUpdate: cv == %p; indexPathsBecomingVisible == %@; indexPathsToRecompute == %@", buf, 0x20u);
    }
  }

  v27 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925A0);
  if (*v27)
  {
    v36 = *(v27 + 8);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
    {
      v37 = v36;
      v38 = [visibleCopy valueForKey:@"_ui_shortDescription"];
      v39 = [v25 valueForKey:@"_ui_shortDescription"];
      *buf = 134218498;
      selfCopy3 = self;
      v51 = 2112;
      v52 = v38;
      v53 = 2112;
      v54 = v39;
      _os_log_impl(&dword_188A29000, v37, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePreferredAttributesForCurrentUpdate indexPathsBecomingVisible = %@; indexPathsToRecompute = %@", buf, 0x20u);
    }
  }

  if ([visibleCopy count])
  {
    [v25 unionSet:visibleCopy];
  }

  if ([(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes count])
  {
    v28 = [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes set];
    [v25 unionSet:v28];

    indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
    self->_indexPathsRequiringPreferredAttributes = 0;
  }

  height = [(UICollectionView *)self _updatePreferredAttributesForItemsInCurrentUpdate:v25 rect:x, y, width, height];

  return height;
}

void __106__UICollectionView__updatePreferredAttributesForItemsInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v8 = a2;
  v5 = [a3 _arePreferredAttributesValid];
  v6 = v8;
  if ((v5 & 1) == 0)
  {
    v7 = [*(*(a1 + 32) + 2280) finalIndexPathForInitialIndexPath:v8];
    if (v7)
    {
      [*(a1 + 40) addObject:v7];
    }

    v6 = v8;
  }
}

- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdate:(id)update rect:(CGRect)rect
{
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  v42 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  v10 = [updateCopy countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (!v10)
  {
    LOBYTE(v12) = 0;
    goto LABEL_34;
  }

  v11 = v10;
  v12 = 0;
  v13 = *v38;
  v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
  v36 = updateCopy;
  do
  {
    v15 = 0;
    do
    {
      if (*v38 != v13)
      {
        objc_enumerationMutation(updateCopy);
      }

      v16 = *(*(&v37 + 1) + 8 * v15);
      v17 = v14[167];
      v18 = [*(&self->super.super.super.super.isa + v17) layoutAttributesForItemAtIndexPath:{v16, v36}];
      v19 = v18;
      if (v18)
      {
        v20 = *(&self->super.super.super.super.isa + v17);
        [v18 frame];
        [v20 _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v19 frame:?];
        v44.origin.x = v21;
        v44.origin.y = v22;
        v44.size.width = v23;
        v44.size.height = v24;
        v43.origin.x = x;
        v43.origin.y = y;
        v43.size.width = width;
        v43.size.height = height;
        if (CGRectIntersectsRect(v43, v44))
        {
          if (dyld_program_sdk_at_least())
          {
            v25 = [(UICollectionViewUpdate *)self->_currentUpdate initialIndexPathForFinalIndexPath:v16];
            if (v25)
            {
              v26 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v25];
              if (v26)
              {
                v27 = v26;
                v12 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v26 withOriginalAttributes:v19 isExistingView:1];

                goto LABEL_17;
              }
            }

            v28 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v16];
            v29 = v28;
            if (v28)
            {
              v30 = *(v28 + 24);
            }

            else
            {
              v30 = 0;
            }

            v31 = v30;

            if (v31)
            {
              if ([(UICollectionView *)self _updatePrefetchItemIfNeeded:v29 forIndexPath:v16 withLayoutAttributes:0 willDisplay:0])
              {

                updateCopy = v36;
LABEL_17:
                v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
LABEL_26:

                goto LABEL_27;
              }

              [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:v16];
              if (v29)
              {
                v32 = v29[3];
              }

              else
              {
                v32 = 0;
              }

              v33 = v32;
              [(UICollectionView *)self _reusePrefetchedCell:v33];
            }

            updateCopy = v36;
            v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
          }

          v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v16 withLayoutAttributes:v19 applyAttributes:1 isFocused:0 notify:0];
          v12 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v25 withOriginalAttributes:v19 isExistingView:0];
          if (([v25 _isInUpdateAnimation] & 1) == 0)
          {
            if (dyld_program_sdk_at_least())
            {
              [(UICollectionView *)self _cacheOrReuseCell:v25 forIndexPath:v16 invalidatePreferredAttributes:0 notifyDidEndDisplaying:0];
            }

            else
            {
              [(UICollectionView *)self _reuseCell:v25 notifyDidEndDisplaying:0];
            }
          }

          goto LABEL_26;
        }
      }

LABEL_27:

      ++v15;
    }

    while (v11 != v15);
    v34 = [updateCopy countByEnumeratingWithState:&v37 objects:v41 count:16];
    v11 = v34;
  }

  while (v34);
LABEL_34:

  return v12 & 1;
}

- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:(CGRect)rect newlyVisible:(id)visible includeInserts:(BOOL)inserts
{
  insertsCopy = inserts;
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  v50 = *MEMORY[0x1E69E9840];
  visibleCopy = visible;
  v12 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  if (insertsCopy)
  {
    v33 = visibleCopy;
    v13 = self->_currentUpdate->_newModel;
    [(UICollectionViewData *)v13 validateLayoutInRect:y, width, height];
    v32 = v13;
    [(UICollectionViewData *)&v13->super.isa knownSupplementaryElementKinds];
    v44 = 0u;
    v45 = 0u;
    v46 = 0u;
    obj = v47 = 0u;
    v36 = [obj countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v36)
    {
      v35 = *v45;
      do
      {
        v14 = 0;
        do
        {
          if (*v45 != v35)
          {
            objc_enumerationMutation(obj);
          }

          v37 = v14;
          v15 = *(*(&v44 + 1) + 8 * v14);
          v16 = [(UICollectionViewLayout *)self->_layout indexPathsToInsertForSupplementaryViewOfKind:v15, v32];
          v40 = 0u;
          v41 = 0u;
          v42 = 0u;
          v43 = 0u;
          v17 = [v16 countByEnumeratingWithState:&v40 objects:v48 count:16];
          if (v17)
          {
            v18 = v17;
            v19 = *v41;
            do
            {
              for (i = 0; i != v18; ++i)
              {
                if (*v41 != v19)
                {
                  objc_enumerationMutation(v16);
                }

                v21 = [(UICollectionViewLayout *)self->_layout layoutAttributesForSupplementaryViewOfKind:v15 atIndexPath:*(*(&v40 + 1) + 8 * i)];
                v22 = v21;
                if (v21)
                {
                  layout = self->_layout;
                  [v21 frame];
                  [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v22 frame:?];
                  v52.origin.x = v24;
                  v52.origin.y = v25;
                  v52.size.width = v26;
                  v52.size.height = v27;
                  v51.origin.x = x;
                  v51.origin.y = y;
                  v51.size.width = width;
                  v51.size.height = height;
                  if (CGRectIntersectsRect(v51, v52))
                  {
                    [v12 addObject:v22];
                  }
                }
              }

              v18 = [v16 countByEnumeratingWithState:&v40 objects:v48 count:16];
            }

            while (v18);
          }

          ++v14;
        }

        while (v37 + 1 != v36);
        v36 = [obj countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v36);
    }

    visibleCopy = v33;
  }

  if (dyld_program_sdk_at_least())
  {
    subviewManager = self->_subviewManager;
    v38[0] = MEMORY[0x1E69E9820];
    v38[1] = 3221225472;
    v38[2] = __116__UICollectionView__updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke;
    v38[3] = &unk_1E70FF7D8;
    v38[4] = self;
    v29 = v12;
    v39 = v29;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateSupplementariesWithEnumerator:v38];
      v29 = v39;
    }
  }

  if ([visibleCopy count])
  {
    [v12 unionSet:visibleCopy];
  }

  v30 = [(UICollectionView *)self _updatePreferredAttributesForSupplementariesInCurrentUpdate:v12];

  return v30;
}

void __116__UICollectionView__updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke(uint64_t a1, void *a2, void *a3, void *a4)
{
  v10 = a2;
  v7 = a3;
  if (([a4 _arePreferredAttributesValid] & 1) == 0)
  {
    v8 = [(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) validatedNewIndexPathForSupplementaryElementOfKind:v7 oldIndexPath:v10];
    if (v8)
    {
      v9 = [*(*(a1 + 32) + 2152) layoutAttributesForSupplementaryViewOfKind:v7 atIndexPath:v8];
      if (v9)
      {
        [*(a1 + 40) addObject:v9];
      }
    }
  }
}

- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdate:(id)update
{
  v26 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v5 = [updateCopy countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = 0;
    v8 = *v22;
    while (1)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v22 != v8)
        {
          objc_enumerationMutation(updateCopy);
        }

        v10 = *(*(&v21 + 1) + 8 * i);
        if (dyld_program_sdk_at_least())
        {
          currentUpdate = self->_currentUpdate;
          _content = [(_UILabelConfiguration *)v10 _content];
          indexPath = [v10 indexPath];
          v14 = [(UICollectionViewUpdate *)currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:_content newIndexPath:indexPath];

          if (v14)
          {
            subviewManager = self->_subviewManager;
            _content2 = [(_UILabelConfiguration *)v10 _content];
            v17 = [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementaryOfKind:_content2 atIndexPath:v14];

            if (v17)
            {
              v7 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v17 withOriginalAttributes:v10 isExistingView:1];

              goto LABEL_14;
            }
          }
        }

        _content3 = [(_UILabelConfiguration *)v10 _content];
        indexPath2 = [v10 indexPath];
        v14 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:_content3 atIndexPath:indexPath2 layout:self->_layout withLayoutAttributes:v10 applyAttributes:1];

        if (v14)
        {
          v7 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v14 withOriginalAttributes:v10 isExistingView:0];
          if (([v14 _isInUpdateAnimation] & 1) == 0)
          {
            [(UICollectionView *)self _reuseSupplementaryView:v14];
          }
        }

LABEL_14:
      }

      v6 = [updateCopy countByEnumeratingWithState:&v21 objects:v25 count:16];
      if (!v6)
      {
        goto LABEL_18;
      }
    }
  }

  LOBYTE(v7) = 0;
LABEL_18:

  return v7 & 1;
}

- (BOOL)_updatePreferredAttributesForReusableViewInCurrentUpdate:(id)update withOriginalAttributes:(id)attributes isExistingView:(BOOL)view
{
  viewCopy = view;
  updateCopy = update;
  attributesCopy = attributes;
  if (dyld_program_sdk_at_least() && ([updateCopy _arePreferredAttributesValid] & 1) != 0)
  {
    v11 = 0;
  }

  else
  {
    if (!updateCopy)
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12388 description:{@"UICollectionView internal inconsistency. Attempting to update preferred attributes for nil view. Collection view: %@; Original attributes: %@", self, attributesCopy}];
    }

    v12 = [attributesCopy copy];
    if (!v12)
    {
      currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12391 description:{@"UICollectionView internal inconsistency: missing original layout attributes necessary to update preferred attributes for view: %@", updateCopy}];
    }

    [(UICollectionViewLayout *)self->_layout _prepareForPreferredAttributesQueryForView:updateCopy withLayoutAttributes:v12];
    currentUpdate = self->_currentUpdate;
    if ((!currentUpdate || (*&currentUpdate->_flags & 2) == 0) && !+[UIView _isInAnimationBlockWithAnimationsEnabled])
    {
      viewCopy = 0;
    }

    v14 = [updateCopy _preferredLayoutAttributesFittingAttributes:v12 isAnimatingExistingView:viewCopy];
    if (!v14)
    {
      currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12400 description:{@"UICollectionView internal inconsistency: reusable view %@ returning nil preferred layout attributes for fitting attributes: %@", updateCopy, 0}];
    }

    [(UICollectionViewLayout *)self->_layout _postProcessPreferredAttributes:v14 forView:updateCopy];
    [(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForPreferredLayoutAttributes:v14 withOriginalAttributes:attributesCopy];

    v11 = 1;
  }

  return v11;
}

- (void)_computeVisibleContentOffsetForUpdate:(id)update usingData:(id)data
{
  updateCopy = update;
  dataCopy = data;
  [(UIView *)self bounds];
  v8 = v7;
  v10 = v9;
  v12 = v11;
  v14 = v13;
  collectionViewContentRect = [(UICollectionViewData *)dataCopy collectionViewContentRect];
  v17 = v16;
  v19 = v18;
  v21 = v20;

  [(UIScrollView *)self _effectiveContentInset];
  v24 = collectionViewContentRect - v23;
  v26 = v19 - (-v23 - v25);
  v28 = v17 - v27;
  v29 = v21 - (-v22 - v27);
  v43.origin.x = v24;
  v43.origin.y = v28;
  v43.size.width = v26;
  v43.size.height = v29;
  v56.origin.x = v8;
  v56.origin.y = v10;
  v40 = v14;
  v41 = v12;
  v56.size.width = v12;
  v56.size.height = v14;
  v30 = CGRectContainsRect(v43, v56);
  v31 = v8;
  v32 = v10;
  if (!v30)
  {
    v44.origin.x = v8;
    v44.origin.y = v10;
    v44.size.height = v40;
    v44.size.width = v12;
    MaxY = CGRectGetMaxY(v44);
    v45.origin.x = v24;
    v45.origin.y = v28;
    v45.size.width = v26;
    v45.size.height = v29;
    v32 = v10;
    if (MaxY > CGRectGetMaxY(v45))
    {
      v46.origin.x = v24;
      v46.origin.y = v28;
      v46.size.width = v26;
      v46.size.height = v29;
      Height = CGRectGetHeight(v46);
      v47.origin.x = v8;
      v47.origin.y = v10;
      v47.size.height = v40;
      v47.size.width = v41;
      v32 = v10;
      if (Height > CGRectGetHeight(v47))
      {
        v48.origin.x = v8;
        v48.origin.y = v10;
        v48.size.height = v40;
        v48.size.width = v41;
        v35 = CGRectGetMaxY(v48);
        v49.origin.x = v24;
        v49.origin.y = v28;
        v49.size.width = v26;
        v49.size.height = v29;
        v32 = v10 - (v35 - CGRectGetMaxY(v49));
      }
    }

    v50.origin.x = v8;
    v50.origin.y = v10;
    v50.size.height = v40;
    v50.size.width = v41;
    MaxX = CGRectGetMaxX(v50);
    v51.origin.x = v24;
    v51.origin.y = v28;
    v51.size.width = v26;
    v51.size.height = v29;
    if (MaxX <= CGRectGetMaxX(v51) || (v52.origin.x = v24, v52.origin.y = v28, v52.size.width = v26, v52.size.height = v29, Width = CGRectGetWidth(v52), v53.origin.x = v8, v53.origin.y = v10, v53.size.height = v40, v53.size.width = v41, Width <= CGRectGetWidth(v53)))
    {
      v31 = v8;
    }

    else
    {
      v54.origin.x = v8;
      v54.origin.y = v10;
      v54.size.height = v40;
      v54.size.width = v41;
      v38 = CGRectGetMaxX(v54);
      v55.origin.x = v24;
      v55.origin.y = v28;
      v55.size.width = v26;
      v55.size.height = v29;
      v31 = v8 - (v38 - CGRectGetMaxX(v55));
    }
  }

  updateCopy[4] = v8;
  updateCopy[5] = v10;
  updateCopy[6] = v31;
  updateCopy[7] = v32;
}

- (BOOL)_updateWithItems:(id)items tentativelyForReordering:(BOOL)reordering propertyAnimator:(id)animator collectionViewAnimator:(id)viewAnimator
{
  v223 = *MEMORY[0x1E69E9840];
  itemsCopy = items;
  animatorCopy = animator;
  viewAnimatorCopy = viewAnimator;
  v8 = +[UIView areAnimationsEnabled];
  v9 = dyld_program_sdk_at_least() ^ 1;
  v10 = v9 & v8;
  if (v9)
  {
    selfCopy3 = self;
  }

  else
  {
    selfCopy3 = self;
    if (v8)
    {
      window = [(UIView *)self window];
      v10 = window != 0;
    }
  }

  [(UICollectionView *)selfCopy3 _prepareLayoutForUpdates:v10];
  currentUpdate = selfCopy3->_currentUpdate;
  if (currentUpdate)
  {
    *&currentUpdate->_flags |= 1u;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke;
  aBlock[3] = &unk_1E70FFBD8;
  aBlock[4] = selfCopy3;
  v14 = _Block_copy(aBlock);
  subviewManager = selfCopy3->_subviewManager;
  if (subviewManager)
  {
    visibleViews = subviewManager->_visibleViews;
    if (visibleViews)
    {
      visibleViews->_indexPathValidationEnabled = 0;
    }
  }

  v161 = v10;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925A8);
  if (*CategoryCachedImpl)
  {
    v142 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v142, OS_LOG_TYPE_ERROR))
    {
      v143 = selfCopy3->_currentUpdate;
      *v219 = 134218242;
      selfCopy17 = selfCopy3;
      v221 = 2112;
      v222 = v143;
      _os_log_impl(&dword_188A29000, v142, OS_LOG_TYPE_ERROR, "[UICV %p] _updateWithItems: Processing update %@", v219, 0x16u);
    }
  }

  [(UICollectionView *)selfCopy3 _rebasePrefetchedCellIndexPathsWithMapping:v14];
  [(UICollectionView *)selfCopy3 _resignOrRebaseFirstResponderViewWithIndexPathMapping:v14];
  [(UICollectionView *)selfCopy3 _resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:v14];
  v18 = [(UICollectionView *)selfCopy3 _identityTracker:0];
  if (v18)
  {
    contextMenuInteraction = [(UICollectionView *)selfCopy3 contextMenuInteraction];
    _internalIdentifiersForDismissingMenu = [contextMenuInteraction _internalIdentifiersForDismissingMenu];

    v199 = 0u;
    v200 = 0u;
    v197 = 0u;
    v198 = 0u;
    v21 = _internalIdentifiersForDismissingMenu;
    v22 = [v21 countByEnumeratingWithState:&v197 objects:v210 count:16];
    if (v22)
    {
      v23 = v22;
      v24 = *v198;
      while (2)
      {
        for (i = 0; i != v23; ++i)
        {
          if (*v198 != v24)
          {
            objc_enumerationMutation(v21);
          }

          v26 = *(*(&v197 + 1) + 8 * i);
          v27 = [(_UIIndexPathIdentityTracker *)v18 currentIndexPathForIdentifier:v26];
          if (v27)
          {
            v28 = [(UICollectionViewUpdate *)self->_currentUpdate finalIndexPathForInitialIndexPath:v27];

            if (!v28)
            {
              contextMenuInteraction2 = [(UICollectionView *)self contextMenuInteraction];
              [contextMenuInteraction2 _retargetDismissingMenuWithInternalIdentifier:v26 toPreview:0 force:0];

              goto LABEL_23;
            }
          }
        }

        v23 = [v21 countByEnumeratingWithState:&v197 objects:v210 count:16];
        if (v23)
        {
          continue;
        }

        break;
      }
    }

LABEL_23:

    [(_UIIndexPathIdentityTracker *)v18 updateWithUpdateItems:itemsCopy];
    selfCopy3 = self;
  }

  v30 = (v14)[2](v14, selfCopy3->_pendingSelectionIndexPath);
  pendingSelectionIndexPath = selfCopy3->_pendingSelectionIndexPath;
  selfCopy3->_pendingSelectionIndexPath = v30;

  v32 = selfCopy3->_selectionController;
  selfCopy6 = selfCopy3;
  v34 = v32;
  if (v32)
  {
    v159 = [(NSMutableSet *)v32->_selectedIndexPaths copy];
  }

  else
  {
    v159 = 0;
  }

  if ([(UICollectionView *)selfCopy6 _isConnectedToDiffableDataSource])
  {
    _diffableDataSourceImpl = [(UICollectionView *)selfCopy6 _diffableDataSourceImpl];
    currentTransaction = [_diffableDataSourceImpl currentTransaction];
    v37 = currentTransaction;
    if (_diffableDataSourceImpl && currentTransaction)
    {
      v38 = [(_UICollectionViewSelectionController *)v34 rebaseItemsWithDiffableTransaction:currentTransaction];

      selfCopy6 = self;
      if (v38)
      {
        goto LABEL_33;
      }
    }

    else
    {

      selfCopy6 = self;
    }
  }

  [(_UICollectionViewSelectionController *)v34 rebaseItemsWithTranslator:?];
LABEL_33:
  if (!v34 || ([*(v34 + 8) isEqualToSet:v159] & 1) == 0)
  {
    [(_UICollectionViewMultiSelectController *)selfCopy6->_multiSelectController clearSelectionState];
  }

  v155 = v34;
  v156 = v18;
  if (selfCopy6->_pendingDeselectionIndexPaths)
  {
    v39 = [objc_alloc(MEMORY[0x1E695DFA8]) initWithCapacity:{-[NSMutableSet count](selfCopy6->_pendingDeselectionIndexPaths, "count")}];
    v193 = 0u;
    v194 = 0u;
    v195 = 0u;
    v196 = 0u;
    v40 = selfCopy6->_pendingDeselectionIndexPaths;
    v41 = [(NSMutableSet *)v40 countByEnumeratingWithState:&v193 objects:v209 count:16];
    if (v41)
    {
      v42 = v41;
      v43 = *v194;
      do
      {
        for (j = 0; j != v42; ++j)
        {
          if (*v194 != v43)
          {
            objc_enumerationMutation(v40);
          }

          v45 = v14[2](v14, *(*(&v193 + 1) + 8 * j));
          if (v45)
          {
            [(NSMutableSet *)v39 addObject:v45];
          }
        }

        v42 = [(NSMutableSet *)v40 countByEnumeratingWithState:&v193 objects:v209 count:16];
      }

      while (v42);
    }

    selfCopy6 = self;
    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = v39;
  }

  [(UICollectionView *)selfCopy6 _reloadSectionIndexTitles];
  [(UICollectionView *)selfCopy6 _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
  collectionViewData = self->_collectionViewData;
  [(UIScrollView *)self visibleBounds];
  [(UICollectionViewData *)collectionViewData validateLayoutInRect:v48, v49, v50, v51];
  [(UICollectionView *)self _computeVisibleContentOffsetForUpdate:self->_currentUpdate usingData:self->_collectionViewData];
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  selfCopy9 = self;
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectResult = typeSelectController->_typeSelectResult;
    typeSelectController->_typeSelectResult = 0;
  }

  if ((*(&self->_collectionViewFlags + 17) & 0x40) != 0 || +[UIView areAnimationsEnabled])
  {
    v55 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925B0);
    if (*v55)
    {
      v144 = *(v55 + 8);
      if (os_log_type_enabled(v144, OS_LOG_TYPE_ERROR))
      {
        contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
        *v219 = 134218242;
        selfCopy17 = self;
        v221 = 2112;
        v222 = contentOffsetRestorationAnchor;
        _os_log_impl(&dword_188A29000, v144, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p; Attempting to rebase anchor for %@", v219, 0x16u);
      }
    }

    [(UICollectionView *)self _rebaseContentOffsetAnchorOrScrollTargetForUpdate:self->_currentUpdate];
  }

  v154 = [(UICollectionView *)self _reviseNewContentOffsetForUpdate:self->_currentUpdate];
  didScrollNotificationSuspensionCount = self->_didScrollNotificationSuspensionCount;
  if (!didScrollNotificationSuspensionCount)
  {
    [(UIScrollView *)self contentOffset];
    self->_contentOffsetWhenScrollNotificationsSuspended.x = v57;
    self->_contentOffsetWhenScrollNotificationsSuspended.y = v58;
    selfCopy9 = self;
  }

  selfCopy9->_didScrollNotificationSuspensionCount = didScrollNotificationSuspensionCount + 1;
  if (v161)
  {
    v59 = [[UIViewAnimationContext alloc] initWithCompletionHandler:?];
    updateCompletionHandler = self->_updateCompletionHandler;
    self->_updateCompletionHandler = 0;

    v61 = self->_currentUpdate;
    if (v61)
    {
      *&v61->_flags |= 2u;
    }

    v189[0] = MEMORY[0x1E69E9820];
    v189[1] = 3221225472;
    v189[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_929;
    v189[3] = &unk_1E70F6B40;
    v189[4] = self;
    v190 = viewAnimatorCopy;
    v62 = itemsCopy;
    v191 = v62;
    v63 = v59;
    v192 = v63;
    [UIView performWithoutAnimation:v189];
    v64 = [(UICollectionViewLayout *)self->_layout _propertyAnimatorForCollectionViewUpdates:v62 withCustomAnimator:animatorCopy];

    if (v64)
    {
      v65 = dispatch_group_create();
    }

    else
    {
      v65 = 0;
    }

    v115 = [v64 copy];
    v116 = [v64 copy];
    v185 = 0u;
    v186 = 0u;
    v187 = 0u;
    v188 = 0u;
    v162 = v64;
    _animations = [v64 _animations];
    v118 = [_animations countByEnumeratingWithState:&v185 objects:v208 count:16];
    if (v118)
    {
      v119 = v118;
      v120 = *v186;
      do
      {
        for (k = 0; k != v119; ++k)
        {
          if (*v186 != v120)
          {
            objc_enumerationMutation(_animations);
          }

          v122 = [*(*(&v185 + 1) + 8 * k) copy];
          [v116 addAnimations:v122];
        }

        v119 = [_animations countByEnumeratingWithState:&v185 objects:v208 count:16];
      }

      while (v119);
    }

    v183 = 0u;
    v184 = 0u;
    v181 = 0u;
    v182 = 0u;
    _completions = [v162 _completions];
    v124 = [_completions countByEnumeratingWithState:&v181 objects:v207 count:16];
    if (v124)
    {
      v125 = v124;
      v126 = *v182;
      do
      {
        for (m = 0; m != v125; ++m)
        {
          if (*v182 != v126)
          {
            objc_enumerationMutation(_completions);
          }

          v128 = [*(*(&v181 + 1) + 8 * m) copy];
          [v116 addCompletion:v128];
        }

        v125 = [_completions countByEnumeratingWithState:&v181 objects:v207 count:16];
      }

      while (v125);
    }

    v176[0] = MEMORY[0x1E69E9820];
    v176[1] = 3221225472;
    v176[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2;
    v176[3] = &unk_1E70FF800;
    v176[4] = self;
    v129 = v63;
    v177 = v129;
    v130 = v115;
    v178 = v130;
    v131 = v65;
    v179 = v131;
    v180 = v154;
    v132 = _Block_copy(v176);
    v174[0] = MEMORY[0x1E69E9820];
    v174[1] = 3221225472;
    v174[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_931;
    v174[3] = &unk_1E70F3C60;
    v174[4] = self;
    v109 = v129;
    v175 = v109;
    v133 = _Block_copy(v174);
    v97 = v116;
    if (v116)
    {
      [v116 addAnimations:v132];
      [v116 startAnimation];
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2_932;
      block[3] = &unk_1E70F0F78;
      v173 = v133;
      dispatch_group_notify(v131, MEMORY[0x1E69E96A0], block);
    }

    else
    {
      if (dyld_program_sdk_at_least())
      {
        v134 = 6;
      }

      else
      {
        v134 = 4;
      }

      [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v134 options:v132 animations:v133 completion:?];
    }

    v103 = v155;

    LOBYTE(v111) = 0;
    p_collectionViewFlags = &self->_collectionViewFlags;
    goto LABEL_140;
  }

  v66 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925B8);
  if (*v66)
  {
    v146 = *(v66 + 8);
    if (os_log_type_enabled(v146, OS_LOG_TYPE_ERROR))
    {
      v147 = selfCopy9->_currentUpdate;
      *v219 = 134218242;
      selfCopy17 = selfCopy9;
      v221 = 2112;
      v222 = v147;
      _os_log_impl(&dword_188A29000, v146, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p; performing update without animations. Update: %@", v219, 0x16u);
    }
  }

  indexPathsRequiringPreferredAttributes = selfCopy9->_indexPathsRequiringPreferredAttributes;
  selfCopy9->_indexPathsRequiringPreferredAttributes = 0;

  v68 = selfCopy9->_currentUpdate;
  v153 = v68;
  if (!v68)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:selfCopy9 file:@"UICollectionView.m" lineNumber:12742 description:{@"Invalid parameter not satisfying: %@", @"currentUpdate != nil"}];
LABEL_156:

    goto LABEL_63;
  }

  if ((*&v68->_flags & 2) != 0)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:selfCopy9 file:@"UICollectionView.m" lineNumber:12743 description:{@"UICollectionView internal inconsistency: attempted to reuse deleted views for an update which is not animated. Collection view: %@", selfCopy9}];
    goto LABEL_156;
  }

LABEL_63:
  v69 = objc_alloc_init(_UICollectionViewSubviewCollection);
  v70 = objc_opt_new();
  p_isa = &v69->super.isa;
  [(UICollectionView *)selfCopy9 _populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:v69 addingDeletedViewsToSet:v70 updateLayoutAttributesIndexPaths:1];
  v71 = self->_focusedItemState;
  selfCopy15 = self;
  v73 = self->_firstResponderView;
  v202 = 0u;
  v203 = 0u;
  v204 = 0u;
  v205 = 0u;
  v74 = v70;
  v75 = [v74 countByEnumeratingWithState:&v202 objects:v219 count:16];
  if (!v75)
  {
    goto LABEL_98;
  }

  v76 = v75;
  v77 = *v203;
  do
  {
    v78 = 0;
    do
    {
      if (*v203 != v77)
      {
        objc_enumerationMutation(v74);
      }

      v79 = *(*(&v202 + 1) + 8 * v78);
      if (![(UICollectionView *)selfCopy15 _viewIsReorderedCell:v79])
      {
        if ([(UICollectionReusableView *)v79 _isInUpdateAnimation])
        {
          [(UICollectionReusableView *)v79 _setHiddenForReuse:1];
          goto LABEL_88;
        }

        if (v71 && (v80 = v71->_reusableView, v80, v79 == v80))
        {
          currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
          _layoutAttributes = [(UICollectionReusableView *)v79 _layoutAttributes];
          [currentHandler2 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:self file:v79 lineNumber:_layoutAttributes description:v71];

          if (v73)
          {
            goto LABEL_74;
          }
        }

        else if (v73)
        {
LABEL_74:
          if (v79 == v73)
          {
            currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
            _layoutAttributes2 = [(UICollectionReusableView *)v79 _layoutAttributes];
            [currentHandler3 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:self file:v79 lineNumber:_layoutAttributes2 description:?];
          }
        }

        _layoutAttributes3 = [(UICollectionReusableView *)v79 _layoutAttributes];
        v82 = _layoutAttributes3;
        if (_layoutAttributes3)
        {
          selfCopy15 = self;
          if ((*(_layoutAttributes3 + 288) & 1) == 0)
          {
            if ([(UICollectionView *)self _reuseSupplementaryView:v79])
            {
              goto LABEL_87;
            }

LABEL_85:
            v87 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925D0);
            if (*v87)
            {
              v93 = *(v87 + 8);
              if (os_log_type_enabled(v93, OS_LOG_TYPE_ERROR))
              {
                *buf = 134218754;
                selfCopy14 = self;
                v213 = 2112;
                v214 = v79;
                v215 = 2112;
                v216 = v82;
                v217 = 2112;
                v218 = v153;
                v84 = v93;
                v85 = "_createNewSubviewManagerForUpdateWithoutAnimations: cv == %p; forcibly removing view: %@; with attributes: %@; for update: %@";
                v86 = 42;
LABEL_83:
                _os_log_impl(&dword_188A29000, v84, OS_LOG_TYPE_ERROR, v85, buf, v86);
              }
            }

            goto LABEL_86;
          }

          if (![(UICollectionView *)self _reuseCell:v79 notifyDidEndDisplaying:1])
          {
            goto LABEL_85;
          }
        }

        else
        {
          if (os_variant_has_internal_diagnostics())
          {
            v92 = __UIFaultDebugAssertLog();
            if (os_log_type_enabled(v92, OS_LOG_TYPE_FAULT))
            {
              *buf = 138412546;
              selfCopy14 = self;
              v213 = 2112;
              v214 = v79;
              _os_log_fault_impl(&dword_188A29000, v92, OS_LOG_TYPE_FAULT, "UICollectionView internal bug: non-animated batch update forcibly removing deleted view without layout attributes. Collection view:  %@; view: %@", buf, 0x16u);
            }
          }

          else
          {
            v83 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4925C8) + 8);
            if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
            {
              *buf = 138412546;
              selfCopy14 = self;
              v213 = 2112;
              v214 = v79;
              v84 = v83;
              v85 = "UICollectionView internal bug: non-animated batch update forcibly removing deleted view without layout attributes. Collection view:  %@; view: %@";
              v86 = 22;
              goto LABEL_83;
            }
          }

LABEL_86:
          [(UIView *)v79 removeFromSuperview];
          selfCopy15 = self;
        }

LABEL_87:
      }

LABEL_88:
      ++v78;
    }

    while (v76 != v78);
    v94 = [v74 countByEnumeratingWithState:&v202 objects:v219 count:16];
    v76 = v94;
  }

  while (v94);
LABEL_98:

  [(_UICollectionViewSubviewManager *)selfCopy15->_subviewManager replaceVisibleViewsWithoutCopyingWithContentsOfSubviewCollection:?];
  v168 = 0u;
  v169 = 0u;
  v170 = 0u;
  v171 = 0u;
  v95 = selfCopy15->_skippedBatchUpdatePropertyAnimators;
  v96 = [(NSMutableArray *)v95 countByEnumeratingWithState:&v168 objects:v206 count:16];
  v97 = animatorCopy;
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (v96)
  {
    v99 = v96;
    v100 = *v169;
    do
    {
      for (n = 0; n != v99; ++n)
      {
        if (*v169 != v100)
        {
          objc_enumerationMutation(v95);
        }

        [*(*(&v168 + 1) + 8 * n) startAnimation];
      }

      v99 = [(NSMutableArray *)v95 countByEnumeratingWithState:&v168 objects:v206 count:16];
    }

    while (v99);
  }

  selfCopy18 = self;
  v103 = v155;
  if (v154)
  {
    v104 = self->_currentUpdate;
    x = v104->_newContentOffset.x;
    y = v104->_newContentOffset.y;
    v107 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v107 | 0x80000;
    [(UICollectionView *)self setContentOffset:x, y];
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v107 >> 19) & 1) << 19);
    if ([(UIScrollView *)self isDecelerating])
    {
      v108 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925C0);
      if (*v108)
      {
        v149 = *(v108 + 8);
        if (os_log_type_enabled(v149, OS_LOG_TYPE_ERROR))
        {
          v150 = v149;
          [(UIScrollView *)self contentOffset];
          v151 = NSStringFromCGPoint(v224);
          *v219 = 134218242;
          selfCopy17 = self;
          v221 = 2112;
          v222 = v151;
          _os_log_impl(&dword_188A29000, v150, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p updating decel last offset to %@", v219, 0x16u);

          selfCopy18 = self;
        }
      }

      [(UIScrollView *)selfCopy18 contentOffset];
      [(UIScrollView *)selfCopy18 _updateDecelerationLastOffset:?];
    }
  }

  [(UICollectionView *)selfCopy18 _resumeDidScrollNotifications];
  [(UICollectionViewData *)selfCopy18->_collectionViewData finalizeCollectionViewUpdates];
  [(UICollectionViewLayout *)selfCopy18->_layout _finalizeCollectionViewUpdate:selfCopy18->_currentUpdate];
  [(UICollectionView *)selfCopy18 _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v109 = _Block_copy(selfCopy18->_updateCompletionHandler);
  v110 = selfCopy18->_updateCompletionHandler;
  selfCopy18->_updateCompletionHandler = 0;

  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    window2 = [(UIView *)selfCopy18 window];
    if (window2)
    {
      LOBYTE(v111) = 1;
    }

    else
    {
      v111 = dyld_program_sdk_at_least() ^ 1;
    }

    if (!animatorCopy)
    {
      goto LABEL_138;
    }

LABEL_111:
    v164[0] = MEMORY[0x1E69E9820];
    v164[1] = 3221225472;
    v164[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2_936;
    v164[3] = &unk_1E70FFB68;
    v112 = &v165;
    v165 = v109;
    v113 = v109;
    [animatorCopy addCompletion:v164];
    [animatorCopy startAnimation];
  }

  else
  {
    v111 = dyld_program_sdk_at_least() ^ 1;
    if (animatorCopy)
    {
      goto LABEL_111;
    }

LABEL_138:
    v166[0] = MEMORY[0x1E69E9820];
    v166[1] = 3221225472;
    v166[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_935;
    v166[3] = &unk_1E70F0F78;
    v112 = &v167;
    v167 = v109;
    v135 = v109;
    dispatch_async(MEMORY[0x1E69E96A0], v166);
  }

LABEL_140:
  *(p_collectionViewFlags + 1) &= ~0x10000000uLL;
  v136 = self->_currentUpdate;
  self->_currentUpdate = 0;

  [(UICollectionViewLayout *)self->_layout _setCollectionViewAnimationContext:0];
  v137 = self->_subviewManager;
  if (v137)
  {
    v138 = v137->_visibleViews;
    if (v138)
    {
      v138->_indexPathValidationEnabled = 1;
    }
  }

  v139 = self->_typeSelectController;
  if (v139)
  {
    typeSelectInteraction = v139->_typeSelectInteraction;
    if (!typeSelectInteraction || (*(typeSelectInteraction + 101) & 1) == 0)
    {
      [(_UITypeSelectInteraction *)typeSelectInteraction _updateResultsAnimated:?];
    }
  }

  return v111;
}

id __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke(uint64_t a1, void *a2)
{
  if (a2)
  {
    v4 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 16) validatedGlobalIndexForItemAtIndexPath:a2];
    if (v4 == 0x7FFFFFFFFFFFFFFFLL || (v5 = [*(*(a1 + 32) + 2280) finalGlobalIndexForInitialGlobalIndex:v4], v5 == 0x7FFFFFFFFFFFFFFFLL))
    {
      v6 = 0;
    }

    else
    {
      v6 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:v5];
    }
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

uint64_t __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_929(uint64_t a1)
{
  [*(a1 + 32) contentOffset];
  v3 = v2;
  v5 = v4;
  v6 = *(a1 + 32);
  v7 = *(v6 + 2280);
  v8 = *(v7 + 48);
  v9 = *(v7 + 56);
  v10 = *(v6 + 2736);
  *(v6 + 2736) = v10 | 0x80000;
  [v6 setContentOffset:{v8, v9}];
  *(v6 + 2736) = *(v6 + 2736) & 0xFFF7FFFF | (((v10 >> 19) & 1) << 19);
  v11 = _UISetCurrentFallbackEnvironment(*(a1 + 32));
  v12 = [[_UICollectionViewAnimationContext alloc] initWithDataSourceTranslator:*(a1 + 48) updates:*(*(a1 + 32) + 2152) layout:?];
  [(_UICollectionViewAnimator *)*(a1 + 40) setAnimationContext:v12];

  v13 = *(a1 + 32);
  v14 = *(a1 + 40);
  if (v14)
  {
    [v13 _viewAnimationsForCurrentUpdateWithCollectionViewAnimator:v14 updatingContentOffsetForRestorationAnchor:1];
  }

  else
  {
    [v13 _viewAnimationsForCurrentUpdate];
  }
  v15 = ;
  [(UIViewAnimationContext *)*(a1 + 56) setViewAnimations:v15];

  v16 = [(_UILabelConfiguration *)*(a1 + 40) _content];
  [*(*(a1 + 32) + 2152) _setCollectionViewAnimationContext:v16];

  result = _UIRestorePreviousFallbackEnvironment(v11);
  v18 = *(a1 + 32);
  if (v18)
  {
    v19 = v18[684];
    v18[684] = v19 | 0x80000;
    result = [v18 setContentOffset:{v3, v5}];
    v18[684] = v18[684] & 0xFFF7FFFF | (((v19 >> 19) & 1) << 19);
  }

  return result;
}

void __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2(uint64_t a1)
{
  v29 = *MEMORY[0x1E69E9840];
  [*(a1 + 32) _incrementUpdateAnimationCountWithContext:*(a1 + 40)];
  v2 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) allVisibleViewsHashTable];
  [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) removeAllVisibleViews];
  [*(a1 + 32) _startViewAnimationsWithContext:*(a1 + 40) oldVisibleViews:v2 viewAnimator:*(a1 + 48) viewAnimationsCompletedDispatchGroup:*(a1 + 56)];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(*(a1 + 32) + 2952) layoutScrollViews];
  [*(a1 + 32) _layoutSectionContainerViews];
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v3 = *(*(a1 + 32) + 3216);
  v4 = [v3 countByEnumeratingWithState:&v20 objects:v28 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v21;
    do
    {
      for (i = 0; i != v5; ++i)
      {
        if (*v21 != v6)
        {
          objc_enumerationMutation(v3);
        }

        [*(*(&v20 + 1) + 8 * i) startAnimation];
      }

      v5 = [v3 countByEnumeratingWithState:&v20 objects:v28 count:16];
    }

    while (v5);
  }

  if ((*(a1 + 64) & 1) != 0 || ([*(a1 + 32) isScrollAnimating] & 1) == 0 && (objc_msgSend(*(a1 + 32), "isDragging") & 1) == 0)
  {
    v8 = *(a1 + 32);
    v9 = *(v8 + 2280);
    v10 = *(v9 + 48);
    v11 = *(v9 + 56);
    v12 = *(v8 + 2736);
    *(v8 + 2736) = v12 | 0x80000;
    [v8 setContentOffset:{v10, v11, v20}];
    *(v8 + 2736) = *(v8 + 2736) & 0xFFF7FFFF | (((v12 >> 19) & 1) << 19);
    if ([*(a1 + 32) isDecelerating])
    {
      CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_11___s_category);
      if (*CategoryCachedImpl)
      {
        v16 = *(CategoryCachedImpl + 8);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          v17 = *(a1 + 32);
          v18 = v16;
          [v17 contentOffset];
          v19 = NSStringFromCGPoint(v30);
          *buf = 134218242;
          v25 = v17;
          v26 = 2112;
          v27 = v19;
          _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p updating decel last offset to %@", buf, 0x16u);
        }
      }

      v14 = *(a1 + 32);
      [v14 contentOffset];
      [v14 _updateDecelerationLastOffset:?];
    }
  }

  [(UICollectionView *)*(a1 + 32) _resumeDidScrollNotifications];
  [(UICollectionViewData *)*(*(a1 + 32) + 2272) finalizeCollectionViewUpdates];
  [*(*(a1 + 32) + 2152) _finalizeCollectionViewUpdate:*(*(a1 + 32) + 2280)];
  if (_UIBarsApplyChromelessEverywhere())
  {
    v15 = *(a1 + 32);
    [v15[269] collectionViewContentSize];
    [v15 _setContentSizeFromLayout:0 isRecursivelyUpdatingVisibleCells:?];
  }
}

uint64_t __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_935(uint64_t a1)
{
  result = *(a1 + 32);
  if (result)
  {
    return (*(result + 16))(result, 1);
  }

  return result;
}

- (void)_resignOrRebaseFirstResponderViewWithIndexPathMapping:(id)mapping
{
  mappingCopy = mapping;
  if ([(UICollectionView *)self _isFirstResponderInDeletedSectionOrItem])
  {
    v5 = 0;
    do
    {
      window = [(UIView *)self window];
      firstResponder = [window firstResponder];

      v8 = self->_firstResponderView;
      v9 = self->_firstResponderIndexPath;
      resignFirstResponder = [firstResponder resignFirstResponder];
      window2 = [(UIView *)self window];
      firstResponder2 = [window2 firstResponder];

      if (!resignFirstResponder || firstResponder == firstResponder2)
      {
        currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
        v17 = currentHandler;
        v18 = @"NO";
        if (resignFirstResponder)
        {
          v18 = @"YES";
        }

        [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12827 description:{@"The first responder contained inside of a deleted section or item refused to resign.\nFirst responder that was asked to resign (returned %@ from -resignFirstResponder): %@ inside containing view: %@ at index path: %@\nCurrent first responder: %@ inside containing view: %@ at index path: %@", v18, firstResponder, v8, v9, firstResponder2, self->_firstResponderView, self->_firstResponderIndexPath}];
      }

      if (v5 >= 0x64)
      {
        currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
        v14 = currentHandler2;
        v15 = @"NO";
        if (resignFirstResponder)
        {
          v15 = @"YES";
        }

        [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12828 description:{@"Attempted to delete a section or item containing the first responder, but after repeatedly telling the first responder to resign, the first responder remained inside a deleted section or item. This may be caused by a cycle where the first responder is moving back and forth between the same views.\nFirst responder that was asked to resign (returned %@ from -resignFirstResponder): %@ inside containing view: %@ at index path: %@\nCurrent first responder: %@ inside containing view: %@ at index path: %@", v15, firstResponder, v8, v9, firstResponder2, self->_firstResponderView, self->_firstResponderIndexPath}];
      }

      ++v5;
    }

    while ([(UICollectionView *)self _isFirstResponderInDeletedSectionOrItem]);
  }

  if (self->_firstResponderView)
  {
    firstResponderViewType = self->_firstResponderViewType;
    if (firstResponderViewType == 2)
    {
      v22 = [(UICollectionViewUpdate *)self->_currentUpdate finalSectionIndexForInitialSectionIndex:[(NSIndexPath *)self->_firstResponderIndexPath section]];
      v23 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:v22];
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = v23;
    }

    else if (firstResponderViewType == 1)
    {
      v20 = mappingCopy[2](mappingCopy, self->_firstResponderIndexPath);
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = v20;
    }

    else
    {
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = 0;
    }
  }
}

- (BOOL)_isFocusedViewInDeletedSectionOrItem
{
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v4 = _focusedItemState;
  if (_focusedItemState)
  {
    currentUpdate = self->_currentUpdate;
    if (currentUpdate)
    {
      v6 = *(_focusedItemState + 32);
      v7 = *(_focusedItemState + 16);
      v8 = v7;
      if (v6)
      {
        v9 = [v7 length];

        v10 = self->_currentUpdate;
        if (v9 == 1)
        {
          deletedSupplementaryTopLevelIndexesDict = v10->_deletedSupplementaryTopLevelIndexesDict;
          v12 = v4[3];
          v13 = [(NSMutableDictionary *)deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:v12];

          v14 = v4[2];
          v15 = [v13 containsIndex:{objc_msgSend(v14, "indexAtPosition:", 0)}];

LABEL_10:
          goto LABEL_11;
        }

        v8 = v4[3];
        v16 = v4[2];
        v13 = [(UICollectionViewUpdate *)v10 validatedNewIndexPathForSupplementaryElementOfKind:v8 oldIndexPath:v16];
      }

      else
      {
        v13 = [(UICollectionViewUpdate *)currentUpdate finalIndexPathForInitialIndexPath:v7];
      }

      v15 = v13 == 0;
      goto LABEL_10;
    }
  }

  v15 = 0;
LABEL_11:

  return v15;
}

- (void)_resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:(id)mapping
{
  mappingCopy = mapping;
  if (!self->_currentUpdate)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12871 description:{@"UICollectionView internal inconsistency: attempted to rebase the focused item state outside of an update. Collection view: %@", self}];
  }

  *(&self->_collectionViewFlags + 1) &= ~0x20000000000uLL;
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v6 = _focusedItemState;
  if (_focusedItemState)
  {
    v7 = *(_focusedItemState + 16);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;

  if (v8)
  {
    _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
    v10 = _focusedItemState2;
    if (_focusedItemState2)
    {
      v11 = *(_focusedItemState2 + 8);
      v12 = v10[2];
    }

    else
    {
      v11 = 0;
      v12 = 0;
    }

    v13 = v12;
    if (-[UICollectionView _isFocusedViewInDeletedSectionOrItem](self, "_isFocusedViewInDeletedSectionOrItem") || [v11 _isHiddenForReordering])
    {
      *(&self->_collectionViewFlags + 1) |= 0x20000000000uLL;
      [(UICollectionView *)self _setFocusedItemState:0];
    }

    if (v11)
    {
      _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
      v15 = _focusedItemState3;
      v16 = _focusedItemState3 ? *(_focusedItemState3 + 8) : 0;
      v17 = v16;

      if (!v17)
      {
        [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v11];
      }
    }

    if ((*(&self->_collectionViewFlags + 13) & 2) == 0)
    {
      if (v10 && v10[4])
      {
        v18 = -[UICollectionViewUpdate finalSectionIndexForInitialSectionIndex:](self->_currentUpdate, "finalSectionIndexForInitialSectionIndex:", [v13 section]);
        _focusedItemState4 = [(UICollectionView *)self _focusedItemState];
        v20 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:v18];
        v21 = [(_UICollectionViewFocusedItemState *)_focusedItemState4 copyWithIndexPath:v20 preservingReusableView:1];
        [(UICollectionView *)self _setFocusedItemState:v21];

        objc_storeStrong(&self->_currentUpdate->_oldFocusedItemState, v10);
        _focusedItemState5 = [(UICollectionView *)self _focusedItemState];
        currentUpdate = self->_currentUpdate;
        newFocusedItemState = currentUpdate->_newFocusedItemState;
        currentUpdate->_newFocusedItemState = _focusedItemState5;
      }

      else
      {
        newFocusedItemState = mappingCopy[2](mappingCopy, v13);
        _focusedItemState6 = [(UICollectionView *)self _focusedItemState];
        v26 = [(_UICollectionViewFocusedItemState *)_focusedItemState6 copyWithIndexPath:1 preservingReusableView:?];
        [(UICollectionView *)self _setFocusedItemState:v26];

        objc_storeStrong(&self->_currentUpdate->_oldFocusedItemState, v10);
        _focusedItemState7 = [(UICollectionView *)self _focusedItemState];
        v28 = self->_currentUpdate;
        v29 = v28->_newFocusedItemState;
        v28->_newFocusedItemState = _focusedItemState7;
      }
    }

    _focusedItemState8 = [(UICollectionView *)self _focusedItemState];
    v31 = _focusedItemState8;
    if (_focusedItemState8)
    {
      v32 = *(_focusedItemState8 + 16);
    }

    else
    {
      v32 = 0;
    }

    v33 = v32;
    v34 = [(UICollectionView *)self _indexPathIsValid:v33 allowSectionItemSentinel:1];

    if (!v34)
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }
  }
}

- (void)_startViewAnimationsWithContext:(id)context oldVisibleViews:(id)views viewAnimator:(id)animator viewAnimationsCompletedDispatchGroup:(id)group
{
  v51 = *MEMORY[0x1E69E9840];
  contextCopy = context;
  viewsCopy = views;
  animatorCopy = animator;
  groupCopy = group;
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  if (contextCopy)
  {
    v12 = contextCopy[1];
  }

  else
  {
    v12 = 0;
  }

  obj = v12;
  v13 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v46;
    do
    {
      for (i = 0; i != v14; ++i)
      {
        if (*v46 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v45 + 1) + 8 * i);
        view = [v17 view];
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) == 0)
        {
          [view _addUpdateAnimation];
          [viewsCopy removeObject:view];
          if (([v17 deleteAfterAnimation] & 1) == 0)
          {
            finalLayoutAttributes = [v17 finalLayoutAttributes];

            if (finalLayoutAttributes)
            {
              finalLayoutAttributes2 = [v17 finalLayoutAttributes];
              [(UICollectionView *)self _setVisibleView:view forLayoutAttributes:finalLayoutAttributes2];
            }
          }
        }

        [(UICollectionView *)self _incrementUpdateAnimationCountWithContext:contextCopy];
        if (groupCopy)
        {
          dispatch_group_enter(groupCopy);
        }

        v42[0] = MEMORY[0x1E69E9820];
        v42[1] = 3221225472;
        v42[2] = __118__UICollectionView__startViewAnimationsWithContext_oldVisibleViews_viewAnimator_viewAnimationsCompletedDispatchGroup___block_invoke;
        v42[3] = &unk_1E70F4638;
        v42[4] = self;
        v43 = contextCopy;
        v44 = groupCopy;
        [v17 addCompletionHandler:v42];
        v21 = [animatorCopy copy];
        [v17 startWithAnimator:v21];
      }

      v14 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
    }

    while (v14);
  }

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  v22 = viewsCopy;
  v23 = [v22 countByEnumeratingWithState:&v38 objects:v49 count:16];
  if (v23)
  {
    v24 = v23;
    v25 = *v39;
    do
    {
      v26 = 0;
      do
      {
        if (*v39 != v25)
        {
          objc_enumerationMutation(v22);
        }

        v27 = *(*(&v38 + 1) + 8 * v26);
        _isInUpdateAnimation = [v27 _isInUpdateAnimation];
        _layoutAttributes = [v27 _layoutAttributes];
        v30 = _layoutAttributes;
        if (_isInUpdateAnimation)
        {

          if (!v30)
          {
            goto LABEL_31;
          }

          _layoutAttributes2 = [v27 _layoutAttributes];
          [(UICollectionView *)self _setVisibleView:v27 forLayoutAttributes:_layoutAttributes2];
          goto LABEL_29;
        }

        if (!_layoutAttributes || (v32 = _layoutAttributes[72], _layoutAttributes, (v32 & 1) == 0))
        {
          [(UICollectionView *)self _reuseSupplementaryView:v27];
          goto LABEL_31;
        }

        if (dyld_program_sdk_at_least())
        {
          _layoutAttributes2 = [v27 _layoutAttributes];
          indexPath = [_layoutAttributes2 indexPath];
          [(UICollectionView *)self _cacheOrReuseCell:v27 forIndexPath:indexPath invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];

LABEL_29:
          goto LABEL_31;
        }

        [(UICollectionView *)self _reuseCell:v27];
LABEL_31:
        ++v26;
      }

      while (v24 != v26);
      v34 = [v22 countByEnumeratingWithState:&v38 objects:v49 count:16];
      v24 = v34;
    }

    while (v34);
  }
}

void __118__UICollectionView__startViewAnimationsWithContext_oldVisibleViews_viewAnimator_viewAnimationsCompletedDispatchGroup___block_invoke(uint64_t a1, uint64_t a2)
{
  [*(a1 + 32) _updateAnimationDidStop:*(a1 + 40) finished:a2];
  v3 = *(a1 + 48);
  if (v3)
  {

    dispatch_group_leave(v3);
  }
}

- (BOOL)_reviseNewContentOffsetForUpdate:(id)update
{
  v68 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  v6 = *(updateCopy + 6);
  v5 = *(updateCopy + 7);
  v7 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
  scrollManager = [v7 scrollManager];
  v9 = [scrollManager isScrollingScrollableContainer:self];
  v10 = v5;
  v11 = v6;
  if (v9)
  {
    [scrollManager targetContentOffsetForScrollableContainer:self];
    v11 = v12;
    v10 = v13;
  }

  [(UICollectionViewLayout *)self->_layout targetContentOffsetForProposedContentOffset:v11, v10];
  [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
  v15 = v14;
  v17 = v16;
  v18 = vabdd_f64(v6, v14) >= 0.0001;
  v19 = vabdd_f64(v5, v16) >= 0.0001 || v18;
  if (dyld_program_sdk_at_least() && v19 && ![(UIScrollView *)self isScrollAnimating])
  {
    collectionViewContentRect = [(UICollectionViewData *)updateCopy[3] collectionViewContentRect];
    v57 = v5;
    v21 = v6;
    v23 = v22;
    v25 = v24;
    _isAutomaticContentOffsetAdjustmentEnabled = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:1];
    v27 = v23;
    v6 = v21;
    v5 = v57;
    [(UIScrollView *)self _adjustedContentOffsetForContentOffset:0 contentSize:v15 skipsAdjustmentIfScrolling:v17, v27, v25];
    v15 = v28;
    v17 = v29;
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:_isAutomaticContentOffsetAdjustmentEnabled];
  }

  if (!v9)
  {
    goto LABEL_16;
  }

  if (vabdd_f64(v11, v15) >= 0.0001 || vabdd_f64(v10, v17) >= 0.0001)
  {
    [scrollManager cancelScrollingForScrollableContainer:self];
LABEL_16:
    v31 = 1;
    goto LABEL_17;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925D8);
  if (*CategoryCachedImpl)
  {
    v51 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      selfCopy4 = self;
      _os_log_impl(&dword_188A29000, v51, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; clearing restoration anchor", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  v31 = 0;
  v15 = v6;
  v17 = v5;
LABEL_17:
  v32 = vabdd_f64(v15, v6);
  v33 = vabdd_f64(v17, v5);
  v34 = v33 >= 0.0001 || v32 >= 0.0001;
  if (v34)
  {
    v35 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925E0);
    if (*v35)
    {
      v46 = *(v35 + 8);
      if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
      {
        v47 = v46;
        [(UIScrollView *)self contentOffset];
        NSStringFromCGPoint(v69);
        v48 = v58 = v31;
        v70.x = v6;
        v70.y = v5;
        v49 = NSStringFromCGPoint(v70);
        v71.x = v15;
        v71.y = v17;
        v50 = NSStringFromCGPoint(v71);
        *buf = 134218754;
        selfCopy4 = self;
        v62 = 2112;
        v63 = v48;
        v64 = 2112;
        v65 = v49;
        v66 = 2112;
        v67 = v50;
        _os_log_impl(&dword_188A29000, v47, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; proposed origin modified by layout, delegate, or focus. Current: %@; original: %@; new: %@", buf, 0x2Au);

        v34 = 1;
        v31 = v58;
      }
    }
  }

  if ((v31 & dyld_program_sdk_at_least()) == 1 && ((v34 | [(UICollectionView *)self _isReordering]) & 1) == 0 && self->_contentOffsetRestorationAnchor)
  {
    v59 = 0;
    [(UIScrollView *)self _contentInsetIncludingDecorations];
    v38 = [(UICollectionView *)self _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:v36 shouldApply:v37];
    if (v59 == 1)
    {
      v40 = v38;
      v41 = v39;
      v42 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925E8);
      if (*v42)
      {
        v52 = *(v42 + 8);
        if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
        {
          v53 = v52;
          v72.x = v6;
          v72.y = v5;
          v54 = NSStringFromCGPoint(v72);
          v73.x = v40;
          v73.y = v41;
          v55 = NSStringFromCGPoint(v73);
          *buf = 134218498;
          selfCopy4 = self;
          v62 = 2112;
          v63 = v54;
          v64 = 2112;
          v65 = v55;
          _os_log_impl(&dword_188A29000, v53, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; changing new visible origin from %@ to %@", buf, 0x20u);
        }
      }

      v17 = v41;
      v15 = v40;
    }

    else
    {
      v43 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925F0);
      if (*v43)
      {
        v56 = *(v43 + 8);
        if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          selfCopy4 = self;
          _os_log_impl(&dword_188A29000, v56, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; clearing restoration anchor", buf, 0xCu);
        }
      }

      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }

    v32 = vabdd_f64(v15, v6);
    v33 = vabdd_f64(v17, v5);
  }

  v44 = v33 >= 0.0001 || v32 >= 0.0001;
  *(updateCopy + 6) = v15;
  *(updateCopy + 7) = v17;

  return v44;
}

- (void)_updateAnimationDidStop:(id)stop finished:(BOOL)finished
{
  finishedCopy = finished;
  v82 = *MEMORY[0x1E69E9840];
  stopCopy = stop;
  [(UICollectionView *)self _decrementUpdateAnimationCountWithContext:stopCopy];
  if (stopCopy)
  {
    if (stopCopy[2])
    {
      goto LABEL_63;
    }

    v70 = finishedCopy;
    v79 = 0u;
    v80 = 0u;
    v77 = 0u;
    v78 = 0u;
    v71 = stopCopy;
    v7 = stopCopy[1];
  }

  else
  {
    v70 = finishedCopy;
    v71 = 0;
    v7 = 0;
    v79 = 0u;
    v80 = 0u;
    v77 = 0u;
    v78 = 0u;
  }

  obj = v7;
  v8 = [obj countByEnumeratingWithState:&v77 objects:v81 count:16];
  if (!v8)
  {
    goto LABEL_52;
  }

  v9 = v8;
  p_responderFlags = &self->super.super.super._responderFlags;
  v10 = *v78;
  do
  {
    v11 = 0;
    v75 = v9;
    do
    {
      if (*v78 != v10)
      {
        objc_enumerationMutation(obj);
      }

      v12 = *(*(&v77 + 1) + 8 * v11);
      view = [v12 view];
      objc_opt_class();
      if ((objc_opt_isKindOfClass() & 1) == 0)
      {
        [view _clearUpdateAnimation];
        if ([v12 resetRasterizationAfterAnimation])
        {
          rasterizeAfterAnimation = [v12 rasterizeAfterAnimation];
          layer = [view layer];
          [layer setShouldRasterize:rasterizeAfterAnimation];
        }

        [(UICollectionView *)self _visibleBounds];
        v17 = v16;
        v19 = v18;
        v21 = v20;
        v23 = v22;
        selfCopy = self;
        layout = self->_layout;
        _layoutAttributes = [view _layoutAttributes];
        [view frame];
        [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:_layoutAttributes frame:?];
        v28 = v27;
        v30 = v29;
        v32 = v31;
        v34 = v33;

        _layoutAttributes2 = [view _layoutAttributes];
        v36 = _layoutAttributes2;
        if (_layoutAttributes2)
        {
          v37 = 1;
          if ((_layoutAttributes2[36] & 2) != 0)
          {
            v37 = 2;
          }

          v38 = _layoutAttributes2[36] & 1;
          if (v38)
          {
            v39 = 0;
          }

          else
          {
            v39 = v37;
          }

          v40 = *&p_responderFlags[680];
          v41 = (v40 >> 30) & 1;
          if ((v40 & 0x40000000) == 0 && v38)
          {
LABEL_20:
            indexPath = [_layoutAttributes2 indexPath];
            LOBYTE(v41) = ![(UICollectionView *)selfCopy _indexPathIsValid:indexPath];

            v39 = 0;
          }
        }

        else
        {
          if ((*(&p_responderFlags[680] + 3) & 0x40) == 0)
          {
            goto LABEL_20;
          }

          v39 = 0;
          LOBYTE(v41) = 1;
        }

        if (([view _isInUpdateAnimation] & 1) == 0 && (objc_msgSend(v12, "deleteAfterAnimation") & 1) == 0)
        {
          if ((v41 & 1) != 0 || (v83.origin.x = v28, v83.origin.y = v30, v83.size.width = v32, v83.size.height = v34, v84.origin.x = v17, v84.origin.y = v19, v84.size.width = v21, v84.size.height = v23, !CGRectIntersectsRect(v83, v84)))
          {
            _content = [(_UILabelConfiguration *)v36 _content];
            subviewManager = selfCopy->_subviewManager;
            indexPath2 = [v36 indexPath];
            v73 = _content;
            v46 = [(_UICollectionViewSubviewManager *)subviewManager visibleViewOfKind:_content inCategory:v39 atIndexPath:indexPath2];

            v47 = 0;
            if (dyld_program_sdk_at_least() && !v39)
            {
              indexPath3 = [v36 indexPath];
              v47 = [(UICollectionView *)selfCopy _isReorderingItemAtIndexPath:indexPath3];
            }

            if (v46 == view && !v47)
            {
              v49 = selfCopy->_subviewManager;
              indexPath4 = [v36 indexPath];
              if (v49)
              {
                [(_UICollectionViewSubviewCollection *)&v49->_visibleViews->super.isa removeViewOfKind:v73 inCategory:v39 atIndexPath:indexPath4];
              }
            }
          }
        }

        self = selfCopy;
        v51 = selfCopy->_subviewManager;
        if (v51 && [(_UICollectionViewSubviewCollection *)v51->_visibleViews containsView:view])
        {
          if (dyld_program_sdk_at_least() && [v12 updateZIndexAfterAnimation])
          {
            _layoutAttributes3 = [view _layoutAttributes];
            -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](selfCopy, "_addControlledSubview:atZIndex:forced:initialAttributes:", view, [_layoutAttributes3 zIndex], 1, 0);
            goto LABEL_45;
          }
        }

        else if (([view _isInUpdateAnimation] & 1) == 0)
        {
          if ([v12 viewType] == 1)
          {
            [(UICollectionView *)selfCopy _reuseCell:view];
          }

          else if ([v12 viewType] == 2)
          {
            [(UICollectionView *)selfCopy _reuseSupplementaryView:view];
          }

          else
          {
            _layoutAttributes3 = [MEMORY[0x1E696AAA8] currentHandler];
            [_layoutAttributes3 handleFailureInMethod:a2 object:selfCopy file:@"UICollectionView.m" lineNumber:13099 description:{@"UICollectionView finished animating a view of unknown type: %@", view}];
LABEL_45:
          }
        }

        v9 = v75;
      }

      ++v11;
    }

    while (v9 != v11);
    v53 = [obj countByEnumeratingWithState:&v77 objects:v81 count:16];
    v9 = v53;
  }

  while (v53);
LABEL_52:

  [(UICollectionViewLayout *)self->_layout collectionViewContentSize];
  [(UICollectionView *)self setContentSize:?];
  stopCopy = v71;
  if (v71)
  {
    v54 = v71[3];
    v55 = v54;
    if (v54)
    {
      (*(v54 + 2))(v54, v70);
    }
  }

  else
  {
    v55 = 0;
  }

  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v57 = _focusedItemState;
  if (_focusedItemState && (v58 = *(_focusedItemState + 8)) != 0)
  {
    v59 = v58;
    traitCollection = [(UIView *)self traitCollection];
    userInterfaceIdiom = [traitCollection userInterfaceIdiom];

    if (userInterfaceIdiom == 3)
    {
      v57 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
      scrollManager = [v57 scrollManager];
      _focusTuple = [(UIScrollView *)self _focusTuple];
      _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
      v65 = _focusedItemState2;
      selfCopy2 = self;
      if (_focusedItemState2)
      {
        v67 = *(_focusedItemState2 + 8);
      }

      else
      {
        v67 = 0;
      }

      v68 = v67;
      [scrollManager animateOffsetOfScrollableContainersInParentEnvironmentContainer:_focusTuple toShowFocusItem:v68];

      self = selfCopy2;
      goto LABEL_61;
    }
  }

  else
  {
LABEL_61:
  }

LABEL_63:
  _focusSystem = [(UIView *)self _focusSystem];

  if (_focusSystem)
  {
    [(UICollectionView *)self _highlightFirstVisibleItemIfAppropriate];
  }
}

- (void)_endUpdatesWithInvalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator collectionViewAnimator:(id)viewAnimator
{
  reorderingCopy = reordering;
  contextCopy = context;
  animatorCopy = animator;
  viewAnimatorCopy = viewAnimator;
  v12 = self->_updateCount - 1;
  self->_updateCount = v12;
  if (v12)
  {
    if (animatorCopy)
    {
      skippedBatchUpdatePropertyAnimators = self->_skippedBatchUpdatePropertyAnimators;
      if (skippedBatchUpdatePropertyAnimators)
      {
        [(NSMutableArray *)skippedBatchUpdatePropertyAnimators addObject:animatorCopy];
      }

      else
      {
        v15 = [MEMORY[0x1E695DF70] arrayWithObject:animatorCopy];
        v16 = self->_skippedBatchUpdatePropertyAnimators;
        self->_skippedBatchUpdatePropertyAnimators = v15;
      }
    }
  }

  else
  {
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:contextCopy tentativelyForReordering:reorderingCopy animator:animatorCopy collectionViewAnimator:viewAnimatorCopy];
    v14 = self->_skippedBatchUpdatePropertyAnimators;
    self->_skippedBatchUpdatePropertyAnimators = 0;
  }
}

- (void)_performBatchUpdates:(id)updates completion:(id)completion invalidationContext:(id)context tentativelyForReordering:(BOOL)reordering animator:(id)animator animationHandler:(id)handler
{
  reorderingCopy = reordering;
  updatesCopy = updates;
  completionCopy = completion;
  animatorCopy = animator;
  updateCompletionHandler = self->_updateCompletionHandler;
  handlerCopy = handler;
  contextCopy = context;
  v18 = _Block_copy(updateCompletionHandler);
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __123__UICollectionView__performBatchUpdates_completion_invalidationContext_tentativelyForReordering_animator_animationHandler___block_invoke;
  aBlock[3] = &unk_1E70FE248;
  v19 = v18;
  v29 = v19;
  v20 = completionCopy;
  v30 = v20;
  v21 = _Block_copy(aBlock);
  v22 = self->_updateCompletionHandler;
  self->_updateCompletionHandler = v21;

  if (((*(&self->_collectionViewFlags + 8) & 0x10) == 0 || (dyld_program_sdk_at_least() & 1) == 0) && ![(UICollectionView *)self _shouldSkipForcedLayoutBeforeBatchUpdates])
  {
    [(UIView *)self layoutBelowIfNeeded];
  }

  [(UICollectionView *)self _beginUpdates];
  if (updatesCopy)
  {
    v23 = self->_reconfigureAnimator;
    objc_storeStrong(&self->_reconfigureAnimator, animator);
    updatesCopy[2](updatesCopy);
    reconfigureAnimator = self->_reconfigureAnimator;
    self->_reconfigureAnimator = v23;
  }

  v25 = [[_UICollectionViewAnimator alloc] initWithHandler:handlerCopy];

  [(UICollectionView *)self _endUpdatesWithInvalidationContext:contextCopy tentativelyForReordering:reorderingCopy animator:animatorCopy collectionViewAnimator:v25];
}

uint64_t __123__UICollectionView__performBatchUpdates_completion_invalidationContext_tentativelyForReordering_animator_animationHandler___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 32);
  if (v3)
  {
    (*(v3 + 16))(v3, a2);
  }

  result = *(a1 + 40);
  if (result)
  {
    v5 = *(result + 16);

    return v5();
  }

  return result;
}

- (void)setBackgroundView:(UIView *)backgroundView
{
  v5 = backgroundView;
  v6 = self->_backgroundView;
  if (v6 != v5)
  {
    v14 = v5;
    [(UIView *)v6 removeFromSuperview];
    objc_storeStrong(&self->_backgroundView, backgroundView);
    [(UIView *)self bounds];
    [(UIView *)self->_backgroundView setFrame:?];
    v7 = self->_backgroundView;
    v8 = self->_layout;
    v9 = v7;
    v10 = v9;
    if (v8)
    {
      v11 = v9 == 0;
    }

    else
    {
      v11 = 1;
    }

    if (v11)
    {
      goto LABEL_11;
    }

    effectiveUserInterfaceLayoutDirection = [(UIView *)v9 effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v8 developmentLayoutDirection])
    {
      if (![(UIView *)v10 _flipsHorizontalAxis])
      {
LABEL_11:

        [(UIScrollView *)self _addContentSubview:self->_backgroundView atBack:1];
        v5 = v14;
        goto LABEL_12;
      }

      _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
    }

    else
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v10 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
    goto LABEL_11;
  }

LABEL_12:
}

- (void)setBackgroundColor:(id)color
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setBackgroundColor:color];
}

- (void)_invalidateWithBlock:(id)block
{
  blockCopy = block;
  v5 = blockCopy;
  if (blockCopy)
  {
    if ((*(&self->_collectionViewFlags + 12) & 0x40) != 0)
    {
      v6 = _Block_copy(self->_invalidationBlock);
      v10[0] = MEMORY[0x1E69E9820];
      v10[1] = 3221225472;
      v10[2] = __41__UICollectionView__invalidateWithBlock___block_invoke;
      v10[3] = &unk_1E70F77D0;
      v11 = v6;
      v12 = v5;
      v7 = v6;
      v8 = _Block_copy(v10);
      invalidationBlock = self->_invalidationBlock;
      self->_invalidationBlock = v8;
    }

    else
    {
      (*(blockCopy + 2))(blockCopy);
    }
  }
}

uint64_t __41__UICollectionView__invalidateWithBlock___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  if (v2)
  {
    (*(v2 + 16))();
  }

  v3 = *(*(a1 + 40) + 16);

  return v3();
}

- (void)_invalidateLayoutWithContext:(id)context
{
  v81 = *MEMORY[0x1E69E9840];
  contextCopy = context;
  _intent = [contextCopy _intent];
  if (_intent > 0xF || ((1 << _intent) & 0x9762) == 0)
  {
    [(UICollectionView *)self _resetPrefetchState];
  }

  v7 = contextCopy;
  if (self && -[UICollectionViewLayout _estimatesSizes](self->_layout, "_estimatesSizes") && (v8 = [v7 _intent], v8 <= 0xD) && ((1 << v8) & 0x2005) != 0)
  {

    [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  }

  else
  {
  }

  v9 = self->_collectionViewData;
  currentUpdate = self->_currentUpdate;
  if (currentUpdate && (*&currentUpdate->_flags & 1) == 0)
  {
    v11 = currentUpdate->_oldModel;

    v9 = v11;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_invalidateLayoutWithContext____s_category);
  if (*CategoryCachedImpl)
  {
    v53 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
    {
      v54 = v53;
      v55 = _UICollectionViewLayoutInvalidationContextIntentDescription([v7 _intent]);
      *buf = 134218242;
      selfCopy = self;
      v79 = 2112;
      v80 = v55;
      _os_log_impl(&dword_188A29000, v54, OS_LOG_TYPE_ERROR, "_invalidateLayoutWithContext: cv == %p; intent: %@", buf, 0x16u);
    }
  }

  if (v7)
  {
    v60 = (v7[112] >> 3) & 1;
  }

  else
  {
    LOBYTE(v60) = 0;
  }

  _intent2 = [v7 _intent];
  v14 = self->_debugger;
  if (v14 && _intent2 != 15)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger recordInvalidationWithContext:v7];
  }

  v61 = _intent2;
  if (self->_isInInteractiveTransition)
  {
    layout = self->_layout;
    self->_previousInteractiveTransitionProgress = self->_currentInteractiveTransitionProgress;
    invalidatedItemIndexPaths = layout;
    [(UICollectionViewLayout *)invalidatedItemIndexPaths transitionProgress];
    self->_currentInteractiveTransitionProgress = v17;
    self->_previousInteractiveTransitionTimeStamp = self->_currentInteractiveTransitionTimeStamp;
    date = [MEMORY[0x1E695DF00] date];
    [date timeIntervalSince1970];
    self->_currentInteractiveTransitionTimeStamp = v19;

    v75[0] = MEMORY[0x1E69E9820];
    v75[1] = 3221225472;
    v75[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke;
    v75[3] = &unk_1E70F3590;
    v76 = v9;
    [(UICollectionView *)self _invalidateWithBlock:v75];
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    invalidatedSupplementaryIndexPaths = v76;
  }

  else
  {
    v59 = v14;
    if (+[UIView _isInAnimationBlockWithAnimationsEnabled]&& [(UICollectionView *)self _shouldFadeCellsForBoundChangeWhileRotating])
    {
      *(&self->_collectionViewFlags + 1) |= 0x10000000uLL;
    }

    shouldInvalidatePreferred = [(UICollectionViewLayoutInvalidationContext *)v7 _shouldInvalidatePreferredAttributes];
    _requiresFullCacheInvalidation = [(UICollectionViewLayoutInvalidationContext *)v7 _requiresFullCacheInvalidation];
    invalidatedItemIndexPaths = [v7 invalidatedItemIndexPaths];
    invalidatedSupplementaryIndexPaths = [v7 invalidatedSupplementaryIndexPaths];
    invalidatedDecorationIndexPaths = [v7 invalidatedDecorationIndexPaths];
    v24 = [(UICollectionViewLayout *)invalidatedItemIndexPaths count];
    v58 = [invalidatedSupplementaryIndexPaths count];
    v57 = [invalidatedDecorationIndexPaths count];
    v56 = !_requiresFullCacheInvalidation;
    if (_requiresFullCacheInvalidation && shouldInvalidatePreferred)
    {
      subviewManager = self->_subviewManager;
      if (subviewManager)
      {
        [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:?];
      }

      [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:&__block_literal_global_971];
    }

    if (_requiresFullCacheInvalidation)
    {
      v72[0] = MEMORY[0x1E69E9820];
      v72[1] = 3221225472;
      v72[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_4;
      v72[3] = &unk_1E70F35B8;
      v26 = &v73;
      v73 = v9;
      v27 = &v74;
      v74 = v7;
      [(UICollectionView *)self _invalidateWithBlock:v72];
    }

    else
    {
      v67[0] = MEMORY[0x1E69E9820];
      v67[1] = 3221225472;
      v67[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_5;
      v67[3] = &unk_1E70F6B40;
      v26 = &v68;
      v68 = v9;
      v27 = &v69;
      v69 = invalidatedItemIndexPaths;
      v70 = invalidatedSupplementaryIndexPaths;
      v71 = invalidatedDecorationIndexPaths;
      [(UICollectionView *)self _invalidateWithBlock:v67];
    }

    if (v24 || v58 || v57)
    {
      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_6;
      aBlock[3] = &unk_1E70F6B40;
      v63 = invalidatedItemIndexPaths;
      selfCopy2 = self;
      v65 = invalidatedSupplementaryIndexPaths;
      v66 = invalidatedDecorationIndexPaths;
      v28 = _Block_copy(aBlock);
      if (dyld_program_sdk_at_least())
      {
        [(UICollectionView *)self _invalidateWithBlock:v28];
      }

      else
      {
        v28[2](v28);
      }
    }

    if (v61 != 15)
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v56];
      *(&self->_collectionViewFlags + 1) |= 0x200000000uLL;
    }

    v14 = v59;
  }

  if (v7)
  {
    v29 = *(v7 + 16);
  }

  else
  {
    v29 = 0;
  }

  v30 = v29;
  if ([v30 count])
  {
    [(UICollectionView *)self _addIndexPathsRequiringPreferredAttributes:v30];
  }

  [v7 contentOffsetAdjustment];
  v33 = v32;
  v34 = v31;
  if (v32 != *MEMORY[0x1E695EFF8] || v31 != *(MEMORY[0x1E695EFF8] + 8))
  {
    [(UIScrollView *)self contentOffset];
    v37 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v37 | 0x80000;
    [(UICollectionView *)self setContentOffset:v33 + v35, v34 + v36];
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v37 >> 19) & 1) << 19);
  }

  [v7 contentSizeAdjustment];
  if (v38 != *MEMORY[0x1E695F060] || v39 != *(MEMORY[0x1E695F060] + 8))
  {
    if (v9)
    {
      width = v9->_contentSize.width;
      height = v9->_contentSize.height;
    }

    else
    {
      height = 0.0;
      width = 0.0;
    }

    v42 = v38 + width;
    v43 = v39 + height;
    [(UICollectionView *)self setContentSize:v38 + width, v39 + height];
    collectionViewData = self->_collectionViewData;
    if (collectionViewData)
    {
      collectionViewData->_contentSize.width = v42;
      collectionViewData->_contentSize.height = v43;
    }
  }

  if ([v7 _shouldInvalidateCollectionViewContentSize])
  {
    [(UICollectionViewLayout *)self->_layout collectionViewContentSize];
    v46 = v45;
    v48 = v47;
    [(UICollectionView *)self _setContentSizeFromLayout:self->_updateVisibleCellsRecursionCount > 0 isRecursivelyUpdatingVisibleCells:?];
    v49 = self->_collectionViewData;
    if (v49)
    {
      v49->_contentSize.width = v46;
      v49->_contentSize.height = v48;
    }
  }

  if (([v7 invalidateEverything] & 1) != 0 || objc_msgSend(v7, "_intent") == 3)
  {
    v50 = [(UICollectionView *)self _identityTracker:0];
    [(_UIIndexPathIdentityTracker *)v50 reset];

    contextMenuInteraction = [(UICollectionView *)self contextMenuInteraction];
    [contextMenuInteraction _retargetDismissingMenuWithInternalIdentifier:0 toPreview:0 force:1];
  }

  _dataSourceActual = [(UICollectionView *)self _dataSourceActual];

  if (_dataSourceActual)
  {
    if (v61 != 6 && v61 != 15)
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    }

    if ((v60 & 1) == 0)
    {
      [(UICollectionView *)self _reconfigureSectionContainersForUpdate:self->_currentUpdate];
      [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
      if ([v7 _intent] != 6)
      {
        [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
      }

      [(UIScrollView *)self _notifyAlignedContentMarginChanged];
    }
  }
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    *(a3 + 8) |= 3u;
  }
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_4(uint64_t a1)
{
  v1 = *(a1 + 32);
  v2 = [*(a1 + 40) invalidateEverything] ^ 1;

  [(UICollectionViewData *)v1 invalidate:v2];
}

uint64_t __49__UICollectionView__invalidateLayoutWithContext___block_invoke_5(uint64_t a1)
{
  [(UICollectionViewData *)*(a1 + 32) invalidateItemsAtIndexPaths:?];
  [(UICollectionViewData *)*(a1 + 32) invalidateSupplementaryIndexPaths:?];
  v2 = *(a1 + 32);
  v3 = *(a1 + 56);

  return [(UICollectionViewData *)v2 invalidateDecorationIndexPaths:v3];
}

uint64_t __49__UICollectionView__invalidateLayoutWithContext___block_invoke_6(uint64_t a1)
{
  if ([*(a1 + 32) count])
  {
    v2 = *(*(a1 + 40) + 2656);
    if (!v2)
    {
      v3 = objc_alloc_init(MEMORY[0x1E695DFA8]);
      v4 = *(a1 + 40);
      v5 = *(v4 + 2656);
      *(v4 + 2656) = v3;

      v2 = *(*(a1 + 40) + 2656);
    }

    [v2 addObjectsFromArray:*(a1 + 32)];
  }

  if ([*(a1 + 48) count])
  {
    v6 = *(a1 + 40);
    if (!*(v6 + 2664))
    {
      v7 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v8 = *(a1 + 40);
      v9 = *(v8 + 2664);
      *(v8 + 2664) = v7;

      v6 = *(a1 + 40);
    }

    v10 = *(a1 + 48);
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_7;
    v18[3] = &unk_1E70FA680;
    v18[4] = v6;
    [v10 enumerateKeysAndObjectsUsingBlock:v18];
  }

  result = [*(a1 + 56) count];
  if (result)
  {
    v12 = *(a1 + 40);
    if (!*(v12 + 2672))
    {
      v13 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v14 = *(a1 + 40);
      v15 = *(v14 + 2672);
      *(v14 + 2672) = v13;

      v12 = *(a1 + 40);
    }

    v16 = *(a1 + 56);
    v17[0] = MEMORY[0x1E69E9820];
    v17[1] = 3221225472;
    v17[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_8;
    v17[3] = &unk_1E70FA680;
    v17[4] = v12;
    return [v16 enumerateKeysAndObjectsUsingBlock:v17];
  }

  return result;
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_7(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(*(a1 + 32) + 2664) objectForKeyedSubscript:a2];
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    [*(*(a1 + 32) + 2664) setObject:v7 forKeyedSubscript:a2];
    v6 = v7;
  }

  v8 = v6;
  [v6 addObjectsFromArray:a3];
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(*(a1 + 32) + 2672) objectForKeyedSubscript:a2];
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    [*(*(a1 + 32) + 2672) setObject:v7 forKeyedSubscript:a2];
    v6 = v7;
  }

  v8 = v6;
  [v6 addObjectsFromArray:a3];
}

- (void)setSelfSizingInvalidation:(UICollectionViewSelfSizingInvalidation)selfSizingInvalidation
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 & 0xFFFFFF9F | (32 * (selfSizingInvalidation & 3));
  if (((v4 >> 5) & 3) != selfSizingInvalidation)
  {
    if ((selfSizingInvalidation & 3) != 0)
    {
      v6 = 32 * (selfSizingInvalidation & 3);
    }

    else
    {
      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
      v6 = *(p_collectionViewFlags + 4) & 0x60;
    }

    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = __46__UICollectionView_setSelfSizingInvalidation___block_invoke;
    v7[3] = &__block_descriptor_33_e34_v16__0__UICollectionReusableView_8l;
    v8 = v6 == 64;
    [(UICollectionView *)self _applyBlockToAllReusableViews:v7];
  }
}

- (void)_reusableViewDidInvalidateIntrinsicContentSize:(id)size
{
  v17[1] = *MEMORY[0x1E69E9840];
  sizeCopy = size;
  if (self)
  {
    if (_UISupportsIntrinsicContentSizeInvalidation())
    {
      v5 = *(&self->_collectionViewFlags + 4);
      if ((v5 & 0x60) != 0 && _UIMaximumIntrinsicContentSizeInvalidationUpdatesPerCommit() > ((v5 >> 9) & 3) && (*(&self->_collectionViewFlags + 11) & 0x40) == 0 && (*(&self->_collectionViewFlags + 16) & 4) == 0 && !self->_cellBeingReconfigured)
      {
        _layoutAttributes = [sizeCopy _layoutAttributes];
        v7 = _layoutAttributes;
        if (!_layoutAttributes)
        {
          [sizeCopy _isHiddenForReuse];
          goto LABEL_23;
        }

        if (_layoutAttributes[288])
        {
          indexPath = [_layoutAttributes indexPath];
          if (!indexPath)
          {
LABEL_22:

LABEL_23:
            goto LABEL_24;
          }

          v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:indexPath];
          if (v13)
          {
            v10 = v13;
            *(v13 + 8) |= 3u;
          }

          else
          {
            if (([sizeCopy _isHiddenForReuse] & 1) == 0)
            {
              [(UICollectionView *)self _setNeedsRecomputePreferredAttributesForInvalidatedElements];
              intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
              v17[0] = indexPath;
              v15 = [MEMORY[0x1E695DEC8] arrayWithObjects:v17 count:1];
              [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext invalidateItemsAtIndexPaths:v15];
            }

            v10 = 0;
          }
        }

        else
        {
          if (([sizeCopy _isHiddenForReuse] & 1) != 0 || (v7[288] & 3) != 0)
          {
            goto LABEL_23;
          }

          indexPath = [v7 indexPath];
          _content = [(_UILabelConfiguration *)v7 _content];
          v10 = _content;
          if (indexPath && _content)
          {
            [(UICollectionView *)self _setNeedsRecomputePreferredAttributesForInvalidatedElements];
            v11 = self->_intrinsicContentSizeInvalidationContext;
            v16 = indexPath;
            v12 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v16 count:1];
            [(UICollectionViewLayoutInvalidationContext *)v11 invalidateSupplementaryElementsOfKind:v10 atIndexPaths:v12];
          }
        }

        goto LABEL_22;
      }
    }
  }

LABEL_24:
}

void __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v19 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  v7 = [v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v15;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v15 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = *(*(&v14 + 1) + 8 * i);
        if ([*(a1 + 32) _isSectionValidInIndexPath:v11])
        {
          v12 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:v5 atIndexPath:v11];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForSupplementaryElementOfKind:v5 atIndexPath:v11];
          [*(a1 + 32) _recomputePreferredAttributesForInvalidatedView:v12 originalAttributes:v13];
        }
      }

      v8 = [v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v8);
  }
}

- (id)_setupAnimationsForResizedViewsWithOldModel:(id)model
{
  collectionViewData = self->_collectionViewData;
  modelCopy = model;
  [(UICollectionView *)self _visibleBounds];
  [(UICollectionViewData *)collectionViewData validateLayoutInRect:v6, v7, v8, v9];
  v10 = [UICollectionViewUpdate alloc];
  v11 = self->_collectionViewData;
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v15 = v14;
  [(UIScrollView *)self contentOffset];
  v18 = [(UICollectionViewUpdate *)&v10->super.isa initWithCollectionView:MEMORY[0x1E695E0F0] updateItems:0 moveItemSourceIndexPaths:0 moveItemDestinationIndexPaths:modelCopy oldModel:v11 newModel:v13 oldContentOffset:v15 newContentOffset:v16, v17];

  currentUpdate = self->_currentUpdate;
  self->_currentUpdate = v18;

  v20 = self->_currentUpdate;
  if (v20)
  {
    *&v20->_flags |= 2u;
    v21 = self->_currentUpdate;
  }

  else
  {
    v21 = 0;
  }

  v22 = MEMORY[0x1E695E0F0];
  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:MEMORY[0x1E695E0F0] withDataSourceTranslator:v21];
  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:v22 animated:1];
  v23 = self->_currentUpdate;
  if (v23)
  {
    *&v23->_flags |= 1u;
  }

  v24 = [[UIViewAnimationContext alloc] initWithCompletionHandler:?];
  v30 = MEMORY[0x1E69E9820];
  v31 = 3221225472;
  v32 = __64__UICollectionView__setupAnimationsForResizedViewsWithOldModel___block_invoke;
  v33 = &unk_1E70F35B8;
  v25 = v24;
  v34 = v25;
  selfCopy = self;
  [UIView performWithoutAnimation:&v30];
  [(UICollectionView *)self _incrementUpdateAnimationCountWithContext:v25, v30, v31, v32, v33];
  allVisibleViewsHashTable = [(_UICollectionViewSubviewManager *)self->_subviewManager allVisibleViewsHashTable];
  [(_UICollectionViewSubviewManager *)self->_subviewManager removeAllVisibleViews];
  [(UICollectionView *)self _startViewAnimationsWithContext:v25 oldVisibleViews:allVisibleViewsHashTable viewAnimator:0 viewAnimationsCompletedDispatchGroup:0];
  [(UICollectionViewData *)self->_collectionViewData finalizeCollectionViewUpdates];
  [(UICollectionViewLayout *)self->_layout _finalizeCollectionViewUpdate:self->_currentUpdate];
  v27 = self->_currentUpdate;
  self->_currentUpdate = 0;

  v28 = v25;
  return v25;
}

void __64__UICollectionView__setupAnimationsForResizedViewsWithOldModel___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 40) _viewAnimationsForCurrentUpdateWithCollectionViewAnimator:0 updatingContentOffsetForRestorationAnchor:0];
  [(UIViewAnimationContext *)*(a1 + 32) setViewAnimations:v2];
}

- (BOOL)_recomputePreferredAttributesForInvalidatedView:(id)view originalAttributes:(id)attributes
{
  if (!view)
  {
    return 0;
  }

  _isHiddenForReuse = [view _isHiddenForReuse];
  if (!attributes || (_isHiddenForReuse & 1) != 0)
  {
    return 0;
  }

  [view _invalidatePreferredAttributes];

  return [(UICollectionView *)self _checkForPreferredAttributesInView:view originalAttributes:attributes];
}

- (void)_accessibilitySetInterfaceStyleIntent:(unint64_t)intent
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _accessibilitySetInterfaceStyleIntent:intent];
  collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
  [collectionViewLayout invalidateLayout];
}

- (void)_unhighlightAllItems
{
  v14 = *MEMORY[0x1E69E9840];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_highlightedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  v11 = 0u;
  v12 = 0u;
  v9 = 0u;
  v10 = 0u;
  v5 = [v4 countByEnumeratingWithState:&v9 objects:v13 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v10;
    do
    {
      v8 = 0;
      do
      {
        if (*v10 != v7)
        {
          objc_enumerationMutation(v4);
        }

        [(UICollectionView *)self _unhighlightItemAtIndexPath:*(*(&v9 + 1) + 8 * v8++) animated:0 notifyDelegate:1];
      }

      while (v6 != v8);
      v6 = [v4 countByEnumeratingWithState:&v9 objects:v13 count:16];
    }

    while (v6);
  }
}

- (id)_selectableIndexPathForItemContainingHitView:(id)view
{
  viewCopy = view;
  if (!viewCopy)
  {
    goto LABEL_9;
  }

  do
  {
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      break;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      break;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass() & 1) != 0 && ([viewCopy isTracking])
    {
      goto LABEL_9;
    }

    superview = [viewCopy superview];

    viewCopy = superview;
  }

  while (superview);
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v6 = [(UICollectionView *)self _indexPathForCell:viewCopy];
  }

  else
  {
LABEL_9:
    v6 = 0;
  }

  return v6;
}

- (void)touchesBegan:(id)began withEvent:(id)event
{
  v43 = *MEMORY[0x1E69E9840];
  beganCopy = began;
  eventCopy = event;
  _currentTouch = [(UICollectionView *)self _currentTouch];
  if (_currentTouch)
  {
    anyObject = _currentTouch;
    if ([_currentTouch phase] != 4 && objc_msgSend(anyObject, "phase") != 3)
    {
      goto LABEL_9;
    }

    [(UICollectionView *)self _cancelTouches];
  }

  if (_UITouchesContainsTouchFromExternalTouchpad(beganCopy))
  {
LABEL_8:
    anyObject = 0;
LABEL_9:
    selfCopy = self;
    v12 = &selfCopy;
    goto LABEL_25;
  }

  v10 = eventCopy;
  if ([v10 _buttonMask])
  {
    _buttonMask = [v10 _buttonMask];

    if ((_buttonMask & 1) == 0)
    {
      goto LABEL_8;
    }
  }

  else
  {
  }

  anyObject = [beganCopy anyObject];
  [(UICollectionView *)self _setCurrentTouch:anyObject];
  if (anyObject)
  {
    v13 = 2256;
    if (!self->_pendingSelectionIndexPath)
    {
      view = [anyObject view];
      v15 = [(UICollectionView *)self _selectableIndexPathForItemContainingHitView:view];
      if (v15)
      {
        if ([(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:v15])
        {
          objc_storeStrong(&self->_pendingSelectionIndexPath, v15);
          traitCollection = [(UIView *)self traitCollection];
          v17 = _UIShouldAnimateDefaultCellHighlightAndSelection(traitCollection);

          if ([(UIScrollView *)self isDragging]|| ![(UICollectionView *)self _highlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v17 scrollPosition:0 notifyDelegate:1 playFeedback:1])
          {
            pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
            self->_pendingSelectionIndexPath = 0;
          }

          else if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
          {
            pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
            if (pendingDeselectionIndexPaths)
            {
              [(NSMutableSet *)pendingDeselectionIndexPaths removeAllObjects];
            }

            else
            {
              v20 = objc_alloc_init(MEMORY[0x1E695DFA8]);
              v21 = self->_pendingDeselectionIndexPaths;
              self->_pendingDeselectionIndexPaths = v20;
            }

            if (![(UICollectionView *)self _allowsEffectiveMultipleSelection])
            {
              v39 = 0u;
              v40 = 0u;
              v37 = 0u;
              v38 = 0u;
              selectionController = self->_selectionController;
              v33 = v15;
              v34 = view;
              v35 = v17;
              v32 = eventCopy;
              if (selectionController)
              {
                v23 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
              }

              else
              {
                v23 = 0;
              }

              v24 = [v23 countByEnumeratingWithState:&v37 objects:v42 count:16];
              if (v24)
              {
                v25 = v24;
                v26 = *v38;
                do
                {
                  for (i = 0; i != v25; ++i)
                  {
                    if (*v38 != v26)
                    {
                      objc_enumerationMutation(v23);
                    }

                    v28 = *(*(&v37 + 1) + 8 * i);
                    if (([v28 isEqual:*(&self->super.super.super.super.isa + v13)] & 1) == 0)
                    {
                      [(UICollectionView *)self _cellForItemAtIndexPath:v28];
                      v29 = v13;
                      v31 = v30 = v23;
                      [v31 _setSelected:0 animated:v35];

                      v23 = v30;
                      v13 = v29;
                      [(NSMutableSet *)self->_pendingDeselectionIndexPaths addObject:v28];
                    }
                  }

                  v25 = [v23 countByEnumeratingWithState:&v37 objects:v42 count:16];
                }

                while (v25);
              }

              v15 = v33;
              view = v34;
              eventCopy = v32;
            }
          }
        }
      }

      else if (![(UICollectionView *)self _allowsEffectiveMultipleSelection])
      {
        [(UICollectionView *)self _unhighlightAllItems];
      }
    }
  }

  v36.receiver = self;
  v12 = &v36;
LABEL_25:
  v12->super_class = UICollectionView;
  [(objc_super *)v12 touchesBegan:beganCopy withEvent:eventCopy];
}

- (void)touchesMoved:(id)moved withEvent:(id)event
{
  movedCopy = moved;
  _currentTouch = [(UICollectionView *)self _currentTouch];
  v6 = [movedCopy containsObject:?];

  if (v6)
  {
    traitCollection = [(UIView *)self traitCollection];
    v8 = _UIShouldAnimateDefaultCellHighlightAndSelection(traitCollection);

    if (self->_pendingSelectionIndexPath)
    {
      v9 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
      v10 = v9;
      if (v9)
      {
        [v9 bounds];
        v12 = v11;
        v14 = v13;
        v16 = v15;
        v18 = v17;
        [_currentTouch locationInView:v10];
        v25.x = v19;
        v25.y = v20;
        v26.origin.x = v12;
        v26.origin.y = v14;
        v26.size.width = v16;
        v26.size.height = v18;
        v21 = CGRectContainsPoint(v26, v25);
        isHighlighted = [v10 isHighlighted];
        if (v21)
        {
          if ((isHighlighted & 1) == 0)
          {
            [(UICollectionView *)self _highlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v8 scrollPosition:0 notifyDelegate:1 playFeedback:1];
          }
        }

        else if (isHighlighted)
        {
          [(UICollectionView *)self _unhighlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v8 notifyDelegate:1];
        }
      }
    }

    else
    {
      v10 = 0;
    }
  }
}

- (void)_userSelectItemAtIndexPath:(id)path
{
  traitCollection = [(UIView *)self traitCollection];
  v6 = _UIShouldAnimateDefaultCellHighlightAndSelection(traitCollection);

  if (v6)
  {
    v7 = [(UICollectionView *)self _cellForItemAtIndexPath:path];
    v8 = v7;
    if (v7)
    {
      v9[0] = MEMORY[0x1E69E9820];
      v9[1] = 3221225472;
      v9[2] = __47__UICollectionView__userSelectItemAtIndexPath___block_invoke;
      v9[3] = &unk_1E70FF8B8;
      v9[4] = self;
      v9[5] = path;
      [v7 _performConfigurationStateModifications:v9];
    }

    else
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:path animatedSelection:0];
    }
  }

  else
  {

    [(UICollectionView *)self _userSelectItemAtIndexPath:path animatedSelection:0];
  }
}

- (void)_userSelectItemAtIndexPath:(id)path animatedSelection:(BOOL)selection
{
  selectionCopy = selection;
  v12 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
  isSelected = [v12 isSelected];
  if (v12 && [v12 _hasCustomSelectionAction])
  {
    v8 = 1;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:path animated:0 notifyDelegate:1];
  }

  else
  {
    v9 = [(UICollectionView *)self _canPerformPrimaryActionForItemAtIndexPath:path];
    v10 = 1;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:path animated:v9 notifyDelegate:1];
    v8 = 0;
    if (v9)
    {
      goto LABEL_8;
    }
  }

  if (([(UICollectionView *)self _allowsEffectiveMultipleSelection]& isSelected) == 1)
  {
    [(UICollectionView *)self _deselectItemAtIndexPath:path animated:selectionCopy notifyDelegate:1 isUserInitiated:1];
    goto LABEL_9;
  }

  v10 = 0;
LABEL_8:
  BYTE1(v11) = 1;
  LOBYTE(v11) = v8;
  [(UICollectionView *)self _selectItemAtIndexPath:path animated:selectionCopy scrollPosition:0 notifyDelegate:1 deselectPrevious:v10 performPrimaryAction:v10 performCustomSelectionAction:v11 isUserInitiated:?];
LABEL_9:
}

- (void)_springLoadedInteractionSelectItemAtIndexPath:(id)path
{
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
  v9 = v5;
  if (v5 && ([v5 _hasCustomSelectionAction] & 1) != 0)
  {
    v6 = 0;
    v7 = 1;
  }

  else
  {
    v6 = [(UICollectionView *)self _canPerformPrimaryActionForItemAtIndexPath:path];
    v7 = 0;
  }

  BYTE1(v8) = 1;
  LOBYTE(v8) = v7;
  [(UICollectionView *)self _selectItemAtIndexPath:path animated:0 scrollPosition:0 notifyDelegate:1 deselectPrevious:0 performPrimaryAction:v6 performCustomSelectionAction:v8 isUserInitiated:?];
}

- (void)touchesEnded:(id)ended withEvent:(id)event
{
  v63 = *MEMORY[0x1E69E9840];
  endedCopy = ended;
  eventCopy = event;
  _currentTouch = [(UICollectionView *)self _currentTouch];
  if (![endedCopy containsObject:_currentTouch])
  {
    goto LABEL_48;
  }

  [(UICollectionView *)self _setCurrentTouch:0];
  v60.receiver = self;
  v60.super_class = UICollectionView;
  [(UIScrollView *)&v60 touchesEnded:endedCopy withEvent:eventCopy];
  isDragging = [(UIScrollView *)self isDragging];
  if (_currentTouch && !isDragging)
  {
    view = [_currentTouch view];
    if (self->_pendingSelectionIndexPath)
    {
      v11 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
      v12 = v11;
      if (v11)
      {
        [v11 bounds];
        v14 = v13;
        v16 = v15;
        v18 = v17;
        v20 = v19;
        [_currentTouch locationInView:v12];
        v64.x = v21;
        v64.y = v22;
        v65.origin.x = v14;
        v65.origin.y = v16;
        v65.size.width = v18;
        v65.size.height = v20;
        if (!CGRectContainsPoint(v65, v64))
        {
          [(NSMutableSet *)self->_pendingDeselectionIndexPaths removeAllObjects];
LABEL_23:

          goto LABEL_24;
        }
      }
    }

    else
    {
      v12 = 0;
    }

    if (view)
    {
      v23 = [(UICollectionView *)self _selectableIndexPathForItemContainingHitView:view];
      if (!v23)
      {
        goto LABEL_23;
      }

      v24 = v23;
      v25 = [(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:self->_pendingSelectionIndexPath];

      if (!v25)
      {
        goto LABEL_23;
      }
    }

    else if (![(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:self->_pendingSelectionIndexPath])
    {
      goto LABEL_23;
    }

    pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    if (!pendingSelectionIndexPath)
    {
      if ((dyld_program_sdk_at_least() & 1) != 0 || [(UICollectionView *)self _allowsEffectiveMultipleSelection])
      {
LABEL_22:
        v30 = self->_pendingSelectionIndexPath;
        self->_pendingSelectionIndexPath = 0;

        goto LABEL_23;
      }

      pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    }

    v27 = pendingSelectionIndexPath;
    v28 = v27;
    if ((*(&self->_collectionViewFlags + 17) & 8) != 0)
    {
      v29 = UIApp;
      v58[0] = MEMORY[0x1E69E9820];
      v58[1] = 3221225472;
      v58[2] = __43__UICollectionView_touchesEnded_withEvent___block_invoke;
      v58[3] = &unk_1E70F35B8;
      v58[4] = self;
      v59 = v27;
      [v29 _performBlockAfterCATransactionCommits:v58];
    }

    else
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:v27];
    }

    goto LABEL_22;
  }

LABEL_24:
  traitCollection = [(UIView *)self traitCollection];
  v32 = _UIShouldAnimateDefaultCellHighlightAndSelection(traitCollection);

  v33 = self->_pendingSelectionIndexPath;
  if (v33)
  {
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v33 animated:0 notifyDelegate:1];
    v34 = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = 0;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v36 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v36 = 0;
  }

  v37 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v37)
  {
    v38 = v37;
    v39 = *v55;
    do
    {
      for (i = 0; i != v38; ++i)
      {
        if (*v55 != v39)
        {
          objc_enumerationMutation(v36);
        }

        v41 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v54 + 1) + 8 * i)];
        if (([v41 isSelected] & 1) == 0)
        {
          [v41 _setSelected:1 animated:v32];
        }
      }

      v38 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v38);
  }

  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    v49 = eventCopy;
    v52 = 0u;
    v53 = 0u;
    v50 = 0u;
    v51 = 0u;
    v42 = self->_pendingDeselectionIndexPaths;
    v43 = [(NSMutableSet *)v42 countByEnumeratingWithState:&v50 objects:v61 count:16];
    if (v43)
    {
      v44 = v43;
      v45 = *v51;
      do
      {
        for (j = 0; j != v44; ++j)
        {
          if (*v51 != v45)
          {
            objc_enumerationMutation(v42);
          }

          v47 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v50 + 1) + 8 * j)];
          if ([v47 isSelected])
          {
            [v47 _setSelected:0 animated:v32];
          }
        }

        v44 = [(NSMutableSet *)v42 countByEnumeratingWithState:&v50 objects:v61 count:16];
      }

      while (v44);
    }

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;

    eventCopy = v49;
  }

LABEL_48:
}

- (void)_selectAllSelectedItems
{
  v15 = *MEMORY[0x1E69E9840];
  v10 = 0u;
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  v5 = [v4 countByEnumeratingWithState:&v10 objects:v14 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v11;
    do
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v11 != v7)
        {
          objc_enumerationMutation(v4);
        }

        v9 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v10 + 1) + 8 * i), v10];
        [v9 _setSelected:1 animated:0];
      }

      v6 = [v4 countByEnumeratingWithState:&v10 objects:v14 count:16];
    }

    while (v6);
  }
}

- (void)_cancelTouches
{
  [(UICollectionView *)self _setCurrentTouch:0];
  traitCollection = [(UIView *)self traitCollection];
  v4 = _UIShouldAnimateDefaultCellHighlightAndSelection(traitCollection);

  [(UICollectionView *)self _unhighlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v4 notifyDelegate:1];
  pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
  self->_pendingSelectionIndexPath = 0;

  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    if (![(UIScrollView *)self isTracking])
    {
      [(UICollectionView *)self _selectAllSelectedItems];
    }

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
  }
}

- (void)touchesCancelled:(id)cancelled withEvent:(id)event
{
  cancelledCopy = cancelled;
  eventCopy = event;
  _currentTouch = [(UICollectionView *)self _currentTouch];
  v9 = [cancelledCopy containsObject:_currentTouch];

  if (v9)
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    [(UIScrollView *)&v10 touchesCancelled:cancelledCopy withEvent:eventCopy];
    [(UICollectionView *)self _cancelTouches];
  }
}

- (void)_scrollViewDidEndDraggingWithDeceleration:(BOOL)deceleration
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _scrollViewDidEndDraggingWithDeceleration:deceleration];
  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    [(UICollectionView *)self _selectAllSelectedItems];
    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
  }
}

- (CGPoint)_contentOffsetForNewFrame:(CGRect)frame oldFrame:(CGRect)oldFrame newContentSize:(CGSize)size andOldContentSize:(CGSize)contentSize
{
  rect = oldFrame.size.height;
  width = oldFrame.size.width;
  height = frame.size.height;
  v8 = frame.size.width;
  [(UIScrollView *)self _effectiveContentInset:*&size.width];
  v33 = v10;
  v12 = v11;
  v29 = v14;
  v30 = v13;
  [(UIView *)self bounds];
  v17 = v15;
  v34 = v16;
  v32 = 0.0;
  v18 = 0.0;
  if (v37 > 0.0)
  {
    v19 = width;
    v20 = rect;
    v18 = CGRectGetMidX(*&v15) / v37;
  }

  if (v38 > 0.0)
  {
    v40.origin.x = v17;
    v40.origin.y = v34;
    v40.size.width = width;
    v40.size.height = rect;
    v32 = CGRectGetMidY(v40) / v38;
  }

  v21 = -v12;
  if (v8 < v35 && v17 > v21)
  {
    v41.origin.x = 0.0;
    v41.origin.y = 0.0;
    v41.size.width = v8;
    v41.size.height = height;
    v23 = round(v35 * v18 + CGRectGetWidth(v41) * -0.5);
    v42.origin.y = 0.0;
    v42.origin.x = v23;
    v42.size.width = v8;
    v42.size.height = height;
    if (CGRectGetMinX(v42) >= v21)
    {
      v21 = v23;
    }

    if (v8 + v21 > v35 + v29)
    {
      v21 = v35 + v29 - v8;
    }
  }

  v24 = -v33;
  if (height < v36 && v34 > v24)
  {
    v43.origin.y = 0.0;
    v43.origin.x = v21;
    v43.size.width = v8;
    v43.size.height = height;
    v26 = round(v36 * v32 + CGRectGetHeight(v43) * -0.5);
    v44.origin.x = v21;
    v44.origin.y = v26;
    v44.size.width = v8;
    v44.size.height = height;
    if (CGRectGetMinY(v44) >= v24)
    {
      v24 = v26;
    }

    if (height + v24 > v36 + v30)
    {
      v24 = v36 + v30 - height;
    }
  }

  v27 = v21;
  v28 = v24;
  result.y = v28;
  result.x = v27;
  return result;
}

- (BOOL)_shouldShowMenuForCell:(id)cell
{
  cellCopy = cell;
  if ([(UICollectionView *)self _delegateSupportsMenuInteraction])
  {
    v5 = 0;
  }

  else
  {
    v6 = [(UICollectionView *)self _indexPathForCell:cellCopy];
    if (v6 && (*&self->_collectionViewFlags & 0x80) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v5 = [_delegateProxy collectionView:self shouldShowMenuForItemAtIndexPath:v6];
    }

    else
    {
      v5 = 0;
    }
  }

  return v5;
}

- (BOOL)_canPerformAction:(SEL)action forCell:(id)cell sender:(id)sender
{
  cellCopy = cell;
  senderCopy = sender;
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]&& (*&self->_collectionViewFlags & 0x80) != 0 && ([(UICollectionView *)self _indexPathForCell:cellCopy], (v10 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v11 = v10;
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v13 = [_delegateProxy collectionView:self canPerformAction:action forItemAtIndexPath:v11 withSender:senderCopy];
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

- (void)_performAction:(SEL)action forCell:(id)cell sender:(id)sender
{
  cellCopy = cell;
  senderCopy = sender;
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]&& (*&self->_collectionViewFlags & 0x80) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v10 = [(UICollectionView *)self _indexPathForCell:cellCopy];
    [_delegateProxy collectionView:self performAction:action forItemAtIndexPath:v10 withSender:senderCopy];
  }
}

- (void)_cellPreferredSeparatorInsetsChanged:(id)changed
{
  v4 = [(UICollectionView *)self _indexPathForCell:changed];
  if (v4)
  {
    v6 = v4;
    collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
    [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v6 separatorOnly:1];

    v4 = v6;
  }
}

- (void)_cellBackgroundChangedForSelectionOrHighlight:(id)highlight
{
  v4 = [(UICollectionView *)self _indexPathForCell:highlight];
  if (v4)
  {
    v6 = v4;
    collectionViewLayout = [(UICollectionView *)self collectionViewLayout];
    [collectionViewLayout _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v6 separatorOnly:0];

    v4 = v6;
  }
}

- (void)_unhighlightAllItemsAndHighlightGlobalItem:(int64_t)item
{
  v5 = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:item];
  v4 = [MEMORY[0x1E696AC88] indexPathForItem:0x7FFFFFFFFFFFFFFFLL inSection:0x7FFFFFFFFFFFFFFFLL];
  [(UICollectionView *)self _highlightItemAtIndexPath:v4 animated:0 scrollPosition:0 notifyDelegate:1];

  [(UICollectionView *)self _highlightItemAtIndexPath:v5 animated:0 scrollPosition:0 notifyDelegate:1];
}

- (void)_handlePresses:(id)presses keyHandler:(id)handler defaultHandler:(id)defaultHandler
{
  v32 = *MEMORY[0x1E69E9840];
  pressesCopy = presses;
  handlerCopy = handler;
  defaultHandlerCopy = defaultHandler;
  _focusSystem = [(UIView *)self _focusSystem];
  focusedItem = [_focusSystem focusedItem];
  v13 = _UIFocusEnvironmentContainingView(focusedItem);
  if (!focusedItem || (-[UICollectionView visibleCells](self, "visibleCells"), v14 = objc_claimAutoreleasedReturnValue(), v15 = [v14 containsObject:v13], v14, !v15))
  {
    v16 = 0;
    v23 = 0;
    if (!defaultHandlerCopy)
    {
      goto LABEL_16;
    }

LABEL_15:
    defaultHandlerCopy[2](defaultHandlerCopy);
    goto LABEL_16;
  }

  v25 = handlerCopy;
  v16 = v13;
  v24 = [(UICollectionView *)self _indexPathForCell:v16];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v26 = pressesCopy;
  v17 = pressesCopy;
  v18 = [v17 countByEnumeratingWithState:&v27 objects:v31 count:16];
  if (v18)
  {
    v19 = v18;
    v20 = *v28;
    while (2)
    {
      v21 = 0;
      do
      {
        if (*v28 != v20)
        {
          objc_enumerationMutation(v17);
        }

        v22 = [*(*(&v27 + 1) + 8 * v21) key];
        if (v22 && ([v16 _canPerformActionForKey:v22] & 1) != 0)
        {

          handlerCopy = v25;
          if (v25)
          {
            v25[2](v25, v16, v22);
          }

          pressesCopy = v26;
          v23 = v24;
          goto LABEL_17;
        }

        ++v21;
      }

      while (v19 != v21);
      v19 = [v17 countByEnumeratingWithState:&v27 objects:v31 count:16];
      if (v19)
      {
        continue;
      }

      break;
    }
  }

  handlerCopy = v25;
  pressesCopy = v26;
  v23 = v24;
  if (defaultHandlerCopy)
  {
    goto LABEL_15;
  }

LABEL_16:
  v22 = 0;
LABEL_17:
}

- (void)pressesBegan:(id)began withEvent:(id)event
{
  beganCopy = began;
  eventCopy = event;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView_pressesBegan_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = beganCopy;
  v12 = eventCopy;
  selfCopy = self;
  v8 = eventCopy;
  v9 = beganCopy;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __43__UICollectionView_pressesBegan_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesBegan_withEvent_, v2, v1);
}

- (void)pressesChanged:(id)changed withEvent:(id)event
{
  changedCopy = changed;
  eventCopy = event;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __45__UICollectionView_pressesChanged_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = changedCopy;
  v12 = eventCopy;
  selfCopy = self;
  v8 = eventCopy;
  v9 = changedCopy;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __45__UICollectionView_pressesChanged_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesChanged_withEvent_, v2, v1);
}

- (void)pressesEnded:(id)ended withEvent:(id)event
{
  endedCopy = ended;
  eventCopy = event;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView_pressesEnded_withEvent___block_invoke_2;
  v10[3] = &unk_1E70F6228;
  v11 = endedCopy;
  v12 = eventCopy;
  selfCopy = self;
  v8 = eventCopy;
  v9 = endedCopy;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:&__block_literal_global_998 defaultHandler:v10];
}

id __43__UICollectionView_pressesEnded_withEvent___block_invoke_2(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesEnded_withEvent_, v2, v1);
}

- (void)pressesCancelled:(id)cancelled withEvent:(id)event
{
  cancelledCopy = cancelled;
  eventCopy = event;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __47__UICollectionView_pressesCancelled_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = cancelledCopy;
  v12 = eventCopy;
  selfCopy = self;
  v8 = eventCopy;
  v9 = cancelledCopy;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __47__UICollectionView_pressesCancelled_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesCancelled_withEvent_, v2, v1);
}

- (BOOL)_selectionInteractionShouldBegin:(id)begin
{
  v4 = _indexPathForSelectionInteraction(self);
  v5 = v4 && [(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:v4]&& [(UICollectionView *)self _delegateAllowsHighlightingItemAtIndexPath:v4];

  return v5;
}

- (void)_selectionInteractionDidBeginHinting:(id)hinting
{
  v4 = _indexPathForSelectionInteraction(self);
  if (v4)
  {
    v5 = v4;
    [(UICollectionView *)self _highlightItemAtIndexPath:v4 animated:0 scrollPosition:0 notifyDelegate:1];
    v4 = v5;
  }
}

- (void)_selectionInteractionDidCancelHinting:(id)hinting
{
  v4 = _indexPathForSelectionInteraction(self);
  if (v4)
  {
    v5 = v4;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v4 animated:0 notifyDelegate:1];
    v4 = v5;
  }
}

- (void)_selectionInteractionDidSelect:(id)select
{
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v5 = [(NSMutableSet *)selectionController->_highlightedIndexPaths copy];
  }

  else
  {
    v5 = 0;
  }

  anyObject = [v5 anyObject];

  if ([(UICollectionView *)self _indexPathIsValid:anyObject])
  {
    [(UICollectionView *)self _userSelectItemAtIndexPath:anyObject];
  }

  else
  {
    v6 = _indexPathForSelectionInteraction(self);
    if (v6)
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:v6];
    }
  }
}

- (int64_t)highlightedGlobalItem
{
  selectionController = self->_selectionController;
  if (!selectionController || [(NSMutableSet *)selectionController->_highlightedIndexPaths count]< 1)
  {
    return -1;
  }

  v4 = self->_selectionController;
  if (v4)
  {
    v5 = [(NSMutableSet *)v4->_highlightedIndexPaths copy];
  }

  else
  {
    v5 = 0;
  }

  anyObject = [v5 anyObject];

  v7 = [(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:anyObject];
  return v7;
}

- (int64_t)maximumGlobalItemIndex
{
  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    return 0;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  return collectionViewData->_totalItemCount;
}

- (void)_trackLayoutValue:(double)value forKey:(id)key
{
  keyCopy = key;
  v7 = keyCopy;
  if (self->_shouldAccumulateTrackedLayoutValues)
  {
    v13 = keyCopy;
    if (!self->_interactiveTransitionValueTrackingDict)
    {
      v8 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:2];
      interactiveTransitionValueTrackingDict = self->_interactiveTransitionValueTrackingDict;
      self->_interactiveTransitionValueTrackingDict = v8;

      v7 = v13;
    }

    if (!self->_trackedValuesKeys)
    {
      v10 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:2];
      trackedValuesKeys = self->_trackedValuesKeys;
      self->_trackedValuesKeys = v10;

      v7 = v13;
    }

    v12 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:v7];
    if (!v12)
    {
      v12 = objc_alloc_init(_UICollectionViewTrackedValue);
      [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict setValue:v12 forKey:v13];
      [(NSMutableArray *)self->_trackedValuesKeys addObject:v13];
    }

    [(_UICollectionViewTrackedValue *)v12 addValue:value];

    v7 = v13;
  }
}

- (double)_trackedLayoutValueForKey:(id)key
{
  v3 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:key];
  v4 = v3;
  if (v3)
  {
    [v3 trackedValue];
    v6 = v5;
  }

  else
  {
    v6 = 0.0;
  }

  return v6;
}

- (void)_updateTrackedLayoutValuesWith:(id)with
{
  withCopy = with;
  v4 = [withCopy count];
  if (v4 >= 1)
  {
    v5 = v4;
    for (i = 0; i != v5; ++i)
    {
      v7 = [withCopy objectAtIndex:i];
      [v7 value];
      v9 = v8;

      v10 = [(NSMutableArray *)self->_trackedValuesKeys objectAtIndex:i];
      v11 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:v10];
      [v11 setTrackedValue:v9];
    }
  }
}

- (id)_dynamicAnimationsForTrackValues
{
  v22 = *MEMORY[0x1E69E9840];
  if ([(NSMutableArray *)self->_trackedValuesKeys count])
  {
    v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableArray count](self->_trackedValuesKeys, "count")}];
    v17 = 0u;
    v18 = 0u;
    v19 = 0u;
    v20 = 0u;
    obj = self->_trackedValuesKeys;
    v4 = [(NSMutableArray *)obj countByEnumeratingWithState:&v17 objects:v21 count:16];
    if (v4)
    {
      v5 = v4;
      v6 = *v18;
      do
      {
        for (i = 0; i != v5; ++i)
        {
          if (*v18 != v6)
          {
            objc_enumerationMutation(obj);
          }

          v8 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:*(*(&v17 + 1) + 8 * i)];
          [v8 speed];
          v10 = v9;
          [v8 trackedValue];
          v12 = [[_UIDynamicValueAnimation alloc] initWithValue:v11 velocity:v10 unitSize:0.05];
          v13 = [_UIDynamicAnimationActiveValue upperBoundary:1 ofType:0.0];
          v14 = [_UIDynamicAnimationActiveValue lowerBoundary:1 ofType:0.0];
          [(_UIDynamicValueAnimation *)v12 addActiveValue:v13];
          [(_UIDynamicValueAnimation *)v12 addActiveValue:v14];
          [v3 addObject:v12];
        }

        v5 = [(NSMutableArray *)obj countByEnumeratingWithState:&v17 objects:v21 count:16];
      }

      while (v5);
    }
  }

  else
  {
    v3 = 0;
  }

  return v3;
}

- (void)encodeRestorableStateWithCoder:(id)coder
{
  v22 = *MEMORY[0x1E69E9840];
  coderCopy = coder;
  dataSource = [(UICollectionView *)self dataSource];
  v6 = [objc_opt_class() conformsToProtocol:&unk_1F00BCFA8];

  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIScrollView *)&v20 encodeRestorableStateWithCoder:coderCopy];
  _indexPathsForSelectedItems = [(UICollectionView *)self _indexPathsForSelectedItems];
  if ([_indexPathsForSelectedItems count])
  {
    [coderCopy encodeObject:_indexPathsForSelectedItems forKey:@"CollectionViewSelectedCellIndexPaths"];
    if (v6)
    {
      dataSource2 = [(UICollectionView *)self dataSource];
      if ([_indexPathsForSelectedItems count])
      {
        array = [MEMORY[0x1E695DF70] array];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = _indexPathsForSelectedItems;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v21 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            v14 = 0;
            do
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = [dataSource2 modelIdentifierForElementAtIndexPath:*(*(&v16 + 1) + 8 * v14) inView:{self, v16}];
              if (v15)
              {
                [array addObject:v15];
              }

              ++v14;
            }

            while (v12 != v14);
            v12 = [v10 countByEnumeratingWithState:&v16 objects:v21 count:16];
          }

          while (v12);
        }

        if ([array count])
        {
          [coderCopy encodeObject:array forKey:@"CollectionViewSelectedCellModelIdentifiers"];
        }
      }
    }
  }
}

- (BOOL)_indexPathIsValid:(id)valid allowSectionItemSentinel:(BOOL)sentinel
{
  if (!valid)
  {
    return 0;
  }

  section = [valid section];
  item = [valid item];
  if ([(UICollectionView *)self numberOfSections]<= section)
  {
    return 0;
  }

  v9 = [(UICollectionView *)self numberOfItemsInSection:section];
  v10 = item == 0x7FFFFFFFFFFFFFFFLL && sentinel;
  return v9 > item || v10;
}

- (BOOL)_isSectionValidInIndexPath:(id)path
{
  if (!path)
  {
    return 0;
  }

  section = [path section];
  return [(UICollectionView *)self numberOfSections]> section;
}

- (void)_orthogonalScrollView:(id)view didScrollToOffset:(CGPoint)offset inSection:(int64_t)section
{
  y = offset.y;
  x = offset.x;
  viewCopy = view;
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained)
  {
    v10 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:section];
    scrollingUnitVector = [(_UICollectionLayoutSectionDescriptor *)v10 scrollingUnitVector];
    v13 = v12;
    [(UICollectionViewLayout *)self->_layout _setOffset:section forOrthogonalScrollingSection:x, y];
    collectionViewData = self->_collectionViewData;
    [(UICollectionView *)self _visibleBounds];
    [(UICollectionViewData *)collectionViewData validateLayoutInRect:v15, v16, v17, v18];
    v19 = [(UICollectionView *)self _updateVisibleCellsNow:1];
    if ([(UICollectionView *)self _prefetchingAllowed])
    {
      if (v19)
      {
        v20 = 0;
      }

      else
      {
        v20 = *(&self->_collectionViewFlags + 1) >= 0;
      }

      [(UICollectionView *)self _updatePrefetchedCellsForOrthogonalScrollingSection:section withOriginalPrefetchingVector:v19 == 0 canCompute:v20 canPrefetch:scrollingUnitVector, v13];
    }

    if ((*(&self->_collectionViewFlags + 6) & 2) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      [_delegateProxy _collectionView:self orthogonalScrollViewDidScroll:viewCopy section:section];
    }
  }
}

- (void)_updatePrefetchedCellsForOrthogonalScrollingSection:(int64_t)section withOriginalPrefetchingVector:(CGVector)vector canCompute:(BOOL)compute canPrefetch:(BOOL)prefetch
{
  prefetchCopy = prefetch;
  computeCopy = compute;
  dy = vector.dy;
  dx = vector.dx;
  v57 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:?];
  scrollingUnitVector = [(_UICollectionLayoutSectionDescriptor *)v57 scrollingUnitVector];
  v14 = v12;
  if (scrollingUnitVector == 0.0 && v12 == 0.0)
  {
    [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator velocity];
  }

  [(UICollectionView *)self _pruneCachedPrefetchViewsForVelocity:?];
  v15 = [(UICollectionView *)self _prefetchingContextForOrthogonalScrollingSection:section];
  v16 = v15;
  if (!v15)
  {
    if (!computeCopy)
    {
      goto LABEL_23;
    }

    v56 = v14;
LABEL_16:
    v17 = 1;
    goto LABEL_17;
  }

  if (vabdd_f64(scrollingUnitVector, dx) > 0.1 || vabdd_f64(v14, dy) > 0.1)
  {
    [(UICollectionView *)self _resetPrefetchingContext:v15];

    if (!computeCopy)
    {
      [(UICollectionView *)self _setPrefetchingContext:0 forOrthogonalScrollingSection:section];
      v16 = 0;
      goto LABEL_23;
    }

    v56 = v14;
    v16 = 0;
    goto LABEL_16;
  }

  if (!computeCopy || [*(v15 + 16) count])
  {
    if (prefetchCopy && [*(v16 + 16) count])
    {
      [(UICollectionView *)self _prefetchItemsForPrefetchingContext:v16];
    }

    goto LABEL_23;
  }

  v56 = v14;
  v17 = 0;
LABEL_17:
  [(UICollectionView *)self _visibleBounds];
  v19 = v18;
  v21 = v20;
  v23 = v22;
  v25 = v24;
  [(UICollectionViewLayout *)self->_layout _contentFrameForSection:section];
  v54 = v27;
  v55 = v26;
  v52 = v29;
  v53 = v28;
  [(UICollectionViewLayout *)self->_layout _offsetForOrthogonalScrollingSection:section];
  v31 = v19 + v30;
  v33 = v21 + v32;
  v59.origin.x = v19;
  v59.origin.y = v21;
  v59.size.width = v23;
  v59.size.height = v25;
  Width = CGRectGetWidth(v59);
  v50 = v21;
  v51 = v19;
  v60.origin.x = v19;
  v60.origin.y = v21;
  v49 = v23;
  v60.size.width = v23;
  v60.size.height = v25;
  v61.size.height = CGRectGetHeight(v60);
  v61.origin.x = v31;
  v61.origin.y = v33;
  v61.size.width = Width;
  v63.origin.y = v54;
  v63.origin.x = v55;
  v63.size.height = v52;
  v63.size.width = v53;
  v62 = CGRectIntersection(v61, v63);
  v35 = _UIRectExpandByFactorAndUnitVector(v62.origin.x, v62.origin.y, v62.size.width, v62.size.height, 0.75, scrollingUnitVector, v56);
  v37 = v36;
  v39 = v38;
  v41 = v40;
  if (v17 || (!v16 ? (v43 = 0, v44 = 0, v45 = 0, v42 = 0) : (v42 = *(v16 + 32), v43 = *(v16 + 40), v44 = *(v16 + 48), v45 = *(v16 + 56)), v64.origin.x = v35, v64.origin.y = v37, v64.size.width = v39, v64.size.height = v41, !CGRectEqualToRect(*&v42, v64)))
  {
    v46 = [(UICollectionViewLayout *)self->_layout layoutAttributesForElementsInRect:v35, v37, v39, v41];
    v47 = [(UICollectionView *)self _prefetchingContextForVisibleBounds:v46 prefetchVector:v51 prefetchRect:v50 attributes:v49, v25, scrollingUnitVector, v56, *&v35, *&v37, *&v39, *&v41];

    [(UICollectionView *)self _setPrefetchingContext:v47 forOrthogonalScrollingSection:section];
    v16 = v47;
  }

LABEL_23:
  activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
  self->_activeOrthogonalPrefetchingContext = v16;
}

- (void)decodeRestorableStateWithCoder:(id)coder
{
  v51 = *MEMORY[0x1E69E9840];
  coderCopy = coder;
  [(UIView *)self layoutIfNeeded];
  [(UIScrollView *)self contentOffset];
  v6 = v5;
  v8 = v7;
  dataSource = [(UICollectionView *)self dataSource];
  v10 = [objc_opt_class() conformsToProtocol:&unk_1F00BCFA8];

  v48.receiver = self;
  v48.super_class = UICollectionView;
  [(UIScrollView *)&v48 decodeRestorableStateWithCoder:coderCopy];
  [(UICollectionView *)self _reloadDataIfNeeded];
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v14 = v11;
  if (v6 == v12 && v8 == v11)
  {
LABEL_6:
    if (v10)
    {
      goto LABEL_7;
    }

    goto LABEL_20;
  }

  [(UIScrollView *)self contentSize];
  v16 = v15;
  [(UIView *)self frame];
  if (v13 > v16 - v17 || ([(UIScrollView *)self contentSize], v19 = v18, [(UIView *)self frame], v14 > v19 - v20))
  {
    [(UICollectionView *)self setContentOffset:v6, v8];
    goto LABEL_6;
  }

  [(UICollectionView *)self _updateVisibleCellsNow:1];
  if (v10)
  {
LABEL_7:
    dataSource2 = [(UICollectionView *)self dataSource];
    v22 = MEMORY[0x1E695DFD8];
    v23 = objc_opt_class();
    v24 = [v22 setWithObjects:{v23, objc_opt_class(), 0}];
    v25 = [coderCopy decodeObjectOfClasses:v24 forKey:@"CollectionViewSelectedCellModelIdentifiers"];

    if (v25)
    {
      v46 = 0u;
      v47 = 0u;
      v44 = 0u;
      v45 = 0u;
      v25 = v25;
      v26 = [v25 countByEnumeratingWithState:&v44 objects:v50 count:16];
      if (v26)
      {
        v27 = v26;
        v28 = *v45;
        do
        {
          for (i = 0; i != v27; ++i)
          {
            if (*v45 != v28)
            {
              objc_enumerationMutation(v25);
            }

            v30 = [dataSource2 indexPathForElementWithModelIdentifier:*(*(&v44 + 1) + 8 * i) inView:self];
            if (v30 && [(UICollectionView *)self _indexPathIsValid:v30])
            {
              LOWORD(v39) = 0;
              [(UICollectionView *)self _selectItemAtIndexPath:v30 animated:0 scrollPosition:0 notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v39 isUserInitiated:?];
            }
          }

          v27 = [v25 countByEnumeratingWithState:&v44 objects:v50 count:16];
        }

        while (v27);
      }
    }

LABEL_31:

    goto LABEL_32;
  }

LABEL_20:
  v31 = MEMORY[0x1E695DFD8];
  v32 = objc_opt_class();
  v33 = [v31 setWithObjects:{v32, objc_opt_class(), 0}];
  dataSource2 = [coderCopy decodeObjectOfClasses:v33 forKey:@"CollectionViewSelectedCellIndexPaths"];

  if ([dataSource2 count])
  {
    v42 = 0u;
    v43 = 0u;
    v40 = 0u;
    v41 = 0u;
    v25 = dataSource2;
    v34 = [v25 countByEnumeratingWithState:&v40 objects:v49 count:16];
    if (v34)
    {
      v35 = v34;
      v36 = *v41;
      do
      {
        for (j = 0; j != v35; ++j)
        {
          if (*v41 != v36)
          {
            objc_enumerationMutation(v25);
          }

          v38 = *(*(&v40 + 1) + 8 * j);
          if ([(UICollectionView *)self _indexPathIsValid:v38])
          {
            [(UICollectionView *)self selectItemAtIndexPath:v38 animated:0 scrollPosition:0];
          }
        }

        v35 = [v25 countByEnumeratingWithState:&v40 objects:v49 count:16];
      }

      while (v35);
    }

    dataSource2 = v25;
    goto LABEL_31;
  }

LABEL_32:
}

- (void)setRemembersLastFocusedIndexPath:(BOOL)remembersLastFocusedIndexPath
{
  v3 = 0x40000000000;
  if (!remembersLastFocusedIndexPath)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFBFFFFFFFFFFLL | v3;
}

- (void)_setFocusedItemState:(id)state
{
  v39 = *MEMORY[0x1E69E9840];
  stateCopy = state;
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  objc_storeStrong(&self->_focusedItemState, state);
  if (_focusedItemState)
  {
    v7 = *(_focusedItemState + 8);
    if (v7)
    {
      v8 = v7;
      v9 = *(_focusedItemState + 8);
      v10 = stateCopy ? stateCopy[1] : 0;
      v11 = v10;

      if (v9 != v11)
      {
        v12 = *(_focusedItemState + 8);
        [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v12];
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925F8);
        if (*CategoryCachedImpl)
        {
          v23 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
          {
            v24 = v23;
            if (stateCopy)
            {
              v25 = stateCopy[2];
              v26 = stateCopy[1];
              v27 = v25;
            }

            else
            {
              v25 = 0;
              v27 = 0;
              v26 = 0;
            }

            v28 = v26;
            v29 = *(_focusedItemState + 8);
            v31 = 134218754;
            selfCopy = self;
            v33 = 2112;
            v34 = v25;
            v35 = 2112;
            v36 = v28;
            v37 = 2112;
            v38 = v29;
            _os_log_impl(&dword_188A29000, v24, OS_LOG_TYPE_ERROR, "[UICV %p] _setFocusedItemState: Asked to update focus at %@ to cell %@ while cell %@ is already focused", &v31, 0x2Au);
          }
        }
      }
    }
  }

  if (stateCopy)
  {
    v14 = stateCopy[1];
    if (os_variant_has_internal_diagnostics())
    {
      if (v14)
      {
        if ([(UIView *)v14 isHidden]|| ([(UIView *)v14 alpha], v30 <= 0.0))
        {
          v22 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
          {
            v31 = 138412290;
            selfCopy = v14;
            _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "Attempting store a hidden view as focused: %@", &v31, 0xCu);
          }
        }
      }
    }

    else if (v14)
    {
      if ([(UIView *)v14 isHidden]|| ([(UIView *)v14 alpha], v17 <= 0.0))
      {
        v15 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492600) + 8);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          v31 = 138412290;
          selfCopy = v14;
          _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "Attempting store a hidden view as focused: %@", &v31, 0xCu);
        }
      }
    }

    v16 = 0;
  }

  else
  {
    v16 = [(_UICollectionViewFocusedItemState *)_focusedItemState copyWithReusableView:?];
    v14 = v16;
  }

  [(UICollectionView *)self _setRememberedFocusedItemState:v16];

  currentUpdate = self->_currentUpdate;
  if (currentUpdate)
  {
    oldFocusedItemState = currentUpdate->_oldFocusedItemState;
    currentUpdate->_oldFocusedItemState = 0;

    v20 = self->_currentUpdate;
    newFocusedItemState = v20->_newFocusedItemState;
    v20->_newFocusedItemState = 0;
  }
}

- (void)_setDisplaysHorizontalIndexTitleBar:(BOOL)bar
{
  if (((((*(&self->_collectionViewFlags + 1) & 0x8000000) == 0) ^ bar) & 1) == 0)
  {
    v4 = 0x8000000;
    if (!bar)
    {
      v4 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFF7FFFFFFLL | v4;
    if (bar && ![(UIScrollView *)self _canScrollY])
    {

      [(UICollectionView *)self setupHorizontalIndexTitleBar];
    }

    else
    {

      [(UICollectionView *)self teardownHorizontalIndexTitleBar];
    }
  }
}

- (CGPoint)_horizontalIndexTitleBarOffset
{
  x = self->_horizontalIndexTitleBarOffset.x;
  y = self->_horizontalIndexTitleBarOffset.y;
  result.y = y;
  result.x = x;
  return result;
}

- (void)_setHorizontalIndexTitleBarOffset:(CGPoint)offset
{
  if (self->_horizontalIndexTitleBarOffset.x != offset.x || self->_horizontalIndexTitleBarOffset.y != offset.y)
  {
    self->_horizontalIndexTitleBarOffset = offset;
    [(UICollectionView *)self layoutHorizontalIndexTitleBar];
  }
}

- (id)_primaryFocusItemForFocusGroup:(id)group
{
  indexPathsForSelectedItems = [(UICollectionView *)self indexPathsForSelectedItems];
  if ([indexPathsForSelectedItems count] == 1)
  {
    firstObject = [indexPathsForSelectedItems firstObject];
    v6 = [(UICollectionView *)self cellForItemAtIndexPath:firstObject];
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (void)_requestFocusOnItemAtIndexPath:(id)path
{
  v4 = [_UICollectionViewFocusedItemState stateWithIndexPath:path elementKind:@"UICollectionElementKindCell" viewType:0];
  targetFocusedItemState = self->_targetFocusedItemState;
  self->_targetFocusedItemState = v4;

  [(UIView *)self _setNeedsNonDeferredFocusUpdate];
}

- (id)_layoutAttributesForFailedMovementWithHeading:(unint64_t)heading
{
  if ((heading & 0x300) != 0)
  {
    v4 = MEMORY[0x1E695E0F0];
  }

  else
  {
    headingCopy = heading;
    [(UIScrollView *)self visibleBounds];
    v9 = v8;
    v11 = v10;
    v13 = v12;
    v15 = v14;
    v16 = _UIVectorForFocusHeading(headingCopy);
    v18 = v17;
    v19 = fabs(v17);
    if (fabs(v16) > 2.22044605e-16 || v19 > 2.22044605e-16)
    {
      v23.origin.x = v9;
      v23.origin.y = v11;
      v23.size.width = v13;
      v23.size.height = v15;
      v21 = v9 + v16 * CGRectGetWidth(v23);
      v24.origin.x = v9;
      v24.origin.y = v11;
      v24.size.width = v13;
      v24.size.height = v15;
      Height = CGRectGetHeight(v24);
      v4 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForElementsInRect:v21, v11 + v18 * Height, v13, v15];
    }

    else
    {
      v4 = MEMORY[0x1E695E0F0];
    }
  }

  return v4;
}

- (void)_focusMovementDidFailNotification:(id)notification
{
  v48 = *MEMORY[0x1E69E9840];
  notificationCopy = notification;
  if (self->_searchFullPageOnFocusUpdate)
  {
    _focusSystem = [(UIView *)self _focusSystem];
    object = [notificationCopy object];

    if (_focusSystem == object)
    {
      userInfo = [notificationCopy userInfo];
      v8 = [userInfo objectForKeyedSubscript:@"UIFocusUpdateContextKey"];

      previouslyFocusedItem = [v8 previouslyFocusedItem];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v10 = previouslyFocusedItem;
        _collectionView = [v10 _collectionView];

        if (_collectionView == self)
        {
          _focusedItemState = [(UICollectionView *)self _focusedItemState];
          v13 = _focusedItemState;
          v14 = _focusedItemState ? *(_focusedItemState + 16) : 0;
          v15 = v14;
          v16 = [(UICollectionView *)self indexPathForCell:v10];
          v17 = [v15 isEqual:v16];

          if (v17)
          {
            [v10 frame];
            v19 = v18;
            v21 = v20;
            v23 = v22;
            v25 = v24;
            v26 = -[UICollectionView _layoutAttributesForFailedMovementWithHeading:](self, "_layoutAttributesForFailedMovementWithHeading:", [v8 focusHeading]);
            v43 = 0u;
            v44 = 0u;
            v45 = 0u;
            v46 = 0u;
            v27 = [v26 countByEnumeratingWithState:&v43 objects:v47 count:16];
            if (v27)
            {
              v28 = v27;
              v42 = v10;
              v29 = 0;
              v30 = *v44;
              v31 = 1.79769313e308;
              do
              {
                for (i = 0; i != v28; ++i)
                {
                  if (*v44 != v30)
                  {
                    objc_enumerationMutation(v26);
                  }

                  v33 = *(*(&v43 + 1) + 8 * i);
                  if (v33)
                  {
                    if (v33[288])
                    {
                      [*(*(&v43 + 1) + 8 * i) frame];
                      v38 = UIDistanceBetweenRects(v34, v35, v36, v37, v19, v21, v23, v25);
                      if (v38 < v31)
                      {
                        v39 = v38;
                        v40 = v33;

                        v31 = v39;
                        v29 = v40;
                      }
                    }
                  }
                }

                v28 = [v26 countByEnumeratingWithState:&v43 objects:v47 count:16];
              }

              while (v28);
              v10 = v42;
              if (v29)
              {
                v41 = [_UICollectionViewFocusedItemState stateWithLayoutAttributes:v29];
                [(UICollectionView *)self _setFocusedItemState:v41];

                [(UIView *)self setNeedsFocusUpdate];
              }
            }
          }
        }
      }
    }
  }
}

- (BOOL)_cellCanBecomeFocused:(id)focused
{
  focusedCopy = focused;
  v5 = [(UICollectionView *)self _indexPathForCell:focusedCopy];
  v6 = v5;
  if (!v5 || [v5 length] != 2 || objc_msgSend(v6, "row") == 0x7FFFFFFFFFFFFFFFLL || objc_msgSend(v6, "section") == 0x7FFFFFFFFFFFFFFFLL || (p_collectionViewFlags = &self->_collectionViewFlags, (*(&self->_collectionViewFlags + 18) & 2) != 0) || objc_msgSend(focusedCopy, "_typeSelectState") == 1)
  {
    v8 = 0;
  }

  else
  {
    _allowsEffectiveFocus = [(UICollectionView *)self _allowsEffectiveFocus];
    v8 = _allowsEffectiveFocus;
    v11 = *p_collectionViewFlags;
    if ((*p_collectionViewFlags & 0x280000) != 0)
    {
      if ((v11 & 0x80000) != 0)
      {
        _delegateProxy = [(UICollectionView *)self _delegateProxy];
        v8 = [_delegateProxy _collectionView:self canFocusItemAtIndexPath:v6];

        v11 = *p_collectionViewFlags;
      }

      if ((v11 & 0x200000) != 0)
      {
        _delegateProxy2 = [(UICollectionView *)self _delegateProxy];
        v8 = [_delegateProxy2 collectionView:self canFocusItemAtIndexPath:v6];
      }
    }

    else if (_allowsEffectiveFocus)
    {
      _focusBehavior = [(UIView *)self _focusBehavior];
      cellFocusability = [_focusBehavior cellFocusability];

      if (cellFocusability == 1)
      {
        v8 = [(UICollectionView *)self _inferFocusabilityForCell:focusedCopy atIndexPath:v6];
      }

      else
      {
        v8 = 1;
      }
    }
  }

  return v8;
}

- (void)_cellBecameFocused:(id)focused
{
  v4 = [(UICollectionView *)self _indexPathForCell:focused];
  if ((*(&self->_collectionViewFlags + 2) & 0x40) != 0)
  {
    v6 = v4;
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy _collectionView:self didFocusItemAtIndexPath:v6];

    v4 = v6;
  }
}

- (int64_t)_cellFocusItemDeferral:(id)deferral
{
  deferralCopy = deferral;
  if (-[UICollectionView _shouldBecomeFocusedOnSelection](self, "_shouldBecomeFocusedOnSelection") && -[UICollectionView selectionFollowsFocus](self, "selectionFollowsFocus") && (-[UICollectionView _indexPathForCell:](self, "_indexPathForCell:", deferralCopy), (v5 = objc_claimAutoreleasedReturnValue()) != 0) && (v6 = v5, -[UICollectionView indexPathsForSelectedItems](self, "indexPathsForSelectedItems"), v7 = objc_claimAutoreleasedReturnValue(), v8 = [v7 containsObject:v6], v7, v6, (v8 & 1) != 0))
  {
    v9 = 2;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_containsFocusedItem
{
  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v3 = _focusedItemState;
  if (_focusedItemState)
  {
    v4 = *(_focusedItemState + 8);
  }

  else
  {
    v4 = 0;
  }

  v5 = v4;
  v6 = v5 != 0;

  return v6;
}

- (BOOL)_isMovingFocusFromHorizontalIndexBarToCellContent:(id)content
{
  contentCopy = content;
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (_horizontalIndexTitleBar)
  {
    _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
    previouslyFocusedView = [contentCopy previouslyFocusedView];
    if ([_horizontalIndexTitleBar2 _isViewEntryCell:previouslyFocusedView])
    {
      nextFocusedView = [contentCopy nextFocusedView];
      superview = [nextFocusedView superview];
      v10 = superview == self;
    }

    else
    {
      v10 = 0;
    }
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (void)_performWhileSuppressingPromiseRegionGeneration:(id)generation
{
  generationCopy = generation;
  v9 = generationCopy;
  if (!generationCopy)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:15356 description:{@"Invalid parameter not satisfying: %@", @"block"}];

    generationCopy = 0;
  }

  p_collectionViewFlags = &self->_collectionViewFlags;
  v7 = *(p_collectionViewFlags + 4);
  *(p_collectionViewFlags + 4) = v7 | 0x40000;
  (*(generationCopy + 2))();
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFBFFFF | (((v7 >> 18) & 1) << 18);
}

- (id)_existingFocusItemsInRect:(CGRect)rect
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  v3 = [(UIView *)&v6 focusItemsInRect:rect.origin.x, rect.origin.y, rect.size.width, rect.size.height];
  v4 = [v3 bs_filter:&__block_literal_global_1041];

  return v4;
}

uint64_t __46__UICollectionView__existingFocusItemsInRect___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (_IsKindOfUIView(v2))
  {
    v3 = [v2 _isHiddenForReuse] ^ 1;
  }

  else
  {
    v3 = 1;
  }

  return v3;
}

- (id)focusItemsInRect:(CGRect)rect
{
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  v8 = [(UICollectionView *)self _existingFocusItemsInRect:?];
  coordinateSpace = [(UIView *)self coordinateSpace];
  height = [(UICollectionView *)self _focusPromiseItemsInRect:coordinateSpace inCoordinateSpace:0x7FFFFFFFFFFFFFFFLL inSection:x, y, width, height];

  v11 = [v8 arrayByAddingObjectsFromArray:height];

  return v11;
}

- (id)_focusPromiseItemsInRect:(CGRect)rect inCoordinateSpace:(id)space inSection:(int64_t)section
{
  v53 = *MEMORY[0x1E69E9840];
  if ((*(&self->_collectionViewFlags + 18) & 4) != 0)
  {
    v43 = MEMORY[0x1E695E0F0];
  }

  else
  {
    [(UIView *)self convertRect:space fromCoordinateSpace:rect.origin.x, rect.origin.y, rect.size.width, rect.size.height];
    v8 = v7;
    v10 = v9;
    v12 = v11;
    v14 = v13;
    v43 = objc_opt_new();
    [(UICollectionViewData *)self->_collectionViewData layoutAttributesForElementsInRect:v8, v10, v12, v14];
    v48 = 0u;
    v49 = 0u;
    v50 = 0u;
    obj = v51 = 0u;
    v15 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
    if (v15)
    {
      v16 = v15;
      v45 = *v49;
      v42 = v47;
      do
      {
        for (i = 0; i != v16; ++i)
        {
          if (*v49 != v45)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v48 + 1) + 8 * i);
          orthogonalScrollerController = self->_orthogonalScrollerController;
          indexPath = [v18 indexPath];
          v21 = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:indexPath];

          if (section == 0x7FFFFFFFFFFFFFFFLL)
          {
            v22 = self->_orthogonalScrollerController;
            indexPath2 = [v18 indexPath];
            LOBYTE(v22) = [(_UICollectionViewOrthogonalScrollerSectionController *)v22 isIndexPathInExtantOrthogonalScroller:indexPath2];

            v24 = v21 & v22;
          }

          else
          {
            indexPath3 = [v18 indexPath];
            if ([indexPath3 section] == section)
            {
              indexPath4 = [v18 indexPath];
              v24 = [indexPath4 item] == 0x7FFFFFFFFFFFFFFFLL;
            }

            else
            {
              v24 = 1;
            }
          }

          isHidden = [v18 isHidden];
          if (v18 && (isHidden & 1) == 0 && (v24 & 1) == 0 && (v18[288] & 1) != 0)
          {
            subviewManager = self->_subviewManager;
            indexPath5 = [v18 indexPath];
            v30 = [(_UICollectionViewSubviewManager *)subviewManager visibleCellAtIndexPath:indexPath5];

            if (!v30)
            {
              newContentView = self->_newContentView;
              if (!newContentView || (-[UICollectionReusableView _layoutAttributes](newContentView, "_layoutAttributes"), v32 = objc_claimAutoreleasedReturnValue(), v33 = [v32 isEqual:v18], v32, (v33 & 1) == 0))
              {
                selfCopy = self;
                v35 = selfCopy;
                if (v21)
                {
                  v36 = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa promiseItemParentScrollViewForLayoutAttributes:v18];
                  v37 = v36;
                  if (v36)
                  {
                    v38 = v36;
                  }

                  else
                  {
                    v38 = selfCopy;
                  }

                  v35 = v38;
                }

                v39 = [_UIFocusPromiseItem alloc];
                [v18 frame];
                v46[0] = MEMORY[0x1E69E9820];
                v46[1] = 3221225472;
                v47[0] = __73__UICollectionView__focusPromiseItemsInRect_inCoordinateSpace_inSection___block_invoke;
                v47[1] = &unk_1E70FF928;
                v47[2] = selfCopy;
                v47[3] = v18;
                v40 = [(_UIFocusPromiseItem *)v39 initWithParentEnvironment:v35 frame:v46 fullfillmentHandler:?];
                [v43 addObject:v40];
              }
            }
          }
        }

        v16 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
      }

      while (v16);
    }
  }

  return v43;
}

- (id)_fulfillPromisedFocusRegionForLayoutAttributes:(id)attributes
{
  v22 = *MEMORY[0x1E69E9840];
  attributesCopy = attributes;
  indexPath = [attributesCopy indexPath];
  v6 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:indexPath];
  if (v6)
  {
    v7 = v6;
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492610);
    if (*CategoryCachedImpl)
    {
      v9 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        v10 = v9;
        _ui_shortDescription = [indexPath _ui_shortDescription];
        v16 = 134218498;
        selfCopy2 = self;
        v18 = 2112;
        v19 = _ui_shortDescription;
        v20 = 2112;
        v21 = v7;
        v12 = "[UICV %p] Returning existing cell to fulfill focus promise at %@: %@";
LABEL_11:
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, v12, &v16, 0x20u);
      }
    }
  }

  else
  {
    v7 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:indexPath withLayoutAttributes:attributesCopy applyAttributes:1 isFocused:0 notify:0];
    [(UICollectionView *)self _setCurrentPromiseFulfillmentCell:v7];
    [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:v7 atIndexPath:indexPath];
    [v7 layoutIfNeeded];
    v13 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492608);
    if (*v13)
    {
      v15 = *(v13 + 8);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        v10 = v15;
        _ui_shortDescription = [indexPath _ui_shortDescription];
        v16 = 134218498;
        selfCopy2 = self;
        v18 = 2112;
        v19 = _ui_shortDescription;
        v20 = 2112;
        v21 = v7;
        v12 = "[UICV %p] Creating (or unhiding prefetched) cell to fulfill focus promise at %@: %@";
        goto LABEL_11;
      }
    }
  }

  return v7;
}

- (id)_focusScrollBoundaryMetricsForItem:(id)item
{
  itemCopy = item;
  v5 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:itemCopy scrollView:self];
  [(UICollectionView *)self _updateFocusScrollBoundaryMetrics:v5 forItem:itemCopy inSection:0x7FFFFFFFFFFFFFFFLL];

  return v5;
}

- (void)_updateFocusScrollBoundaryMetrics:(id)metrics forItem:(id)item inSection:(int64_t)section
{
  metricsCopy = metrics;
  itemCopy = item;
  if ([metricsCopy hasDisprovedAllRelevantAssumptions])
  {
    goto LABEL_55;
  }

  if (section != 0x7FFFFFFFFFFFFFFFLL)
  {
    _collectionViewData = [(UICollectionView *)self _collectionViewData];
    numberOfSections = [(UICollectionViewData *)_collectionViewData numberOfSections];

    if (section < 0 || numberOfSections <= section)
    {
      goto LABEL_55;
    }
  }

  _collectionViewData2 = [(UICollectionView *)self _collectionViewData];
  if (!_collectionViewData2)
  {
    v14 = 0;
    if (section != 0x7FFFFFFFFFFFFFFFLL)
    {
      goto LABEL_9;
    }

LABEL_54:
    v54.receiver = self;
    v54.super_class = UICollectionView;
    v47 = [(UIScrollView *)&v54 _focusScrollBoundaryMetricsForItem:itemCopy, v48];
    [metricsCopy consumeOtherMetrics:v47];

    goto LABEL_55;
  }

  v13 = _collectionViewData2;
  if ((*(_collectionViewData2 + 96) & 2) == 0)
  {
    [(UICollectionViewData *)_collectionViewData2 _updateItemCounts];
  }

  v14 = v13[21];

  if (section == 0x7FFFFFFFFFFFFFFFLL)
  {
    if (v14 > 0)
    {
      v16 = 0;
      goto LABEL_13;
    }

    goto LABEL_54;
  }

LABEL_9:
  _collectionViewData3 = [(UICollectionView *)self _collectionViewData];
  v16 = [(UICollectionViewData *)_collectionViewData3 numberOfItemsInSection:section];

  if (v16 < 1)
  {
    goto LABEL_55;
  }

LABEL_13:
  v48 = v16;
  sectionCopy = section;
  objc_opt_class();
  v52 = itemCopy;
  v17 = _UIFocusEnvironmentContainingView(itemCopy);
  v18 = metricsCopy;
  v19 = v18;
  v20 = 0;
  v49 = v14;
  v51 = metricsCopy;
  if (v17 && v17 != self)
  {
    v20 = 0;
    while (1)
    {
      if (objc_opt_isKindOfClass())
      {
        _collectionView = [(UICollectionView *)v17 _collectionView];
        v22 = _collectionView;
        if (_collectionView == self)
        {
          v25 = v17;

          v26 = [(UICollectionView *)self _indexPathForCell:v25];
          if (v26)
          {
            _collectionViewData4 = [(UICollectionView *)self _collectionViewData];
            v28 = [(UICollectionViewData *)_collectionViewData4 validatedGlobalIndexForItemAtIndexPath:v26];

            if (v28 != 0x7FFFFFFFFFFFFFFFLL)
            {
              v30 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:v25 scrollView:self];

              v17 = v25;
              v20 = v25;
              goto LABEL_32;
            }
          }
        }

        else if (sectionCopy == 0x7FFFFFFFFFFFFFFFLL && _collectionView && [(UICollectionView *)_collectionView _canDeriveVisibleBoundsFromContainingScrollView])
        {
          v23 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:v52 scrollView:v22];
          [(_UIFocusScrollBoundaryMetrics *)v23 consumeOtherMetrics:v19];
          [(UICollectionView *)v22 _updateFocusScrollBoundaryMetrics:v23 forItem:v52 inSection:0x7FFFFFFFFFFFFFFFLL];
          v24 = [(_UIFocusScrollBoundaryMetrics *)v19 consumeOtherMetrics:v23];

          if (v24)
          {

            LOBYTE(v22) = 1;
            v30 = v19;
            goto LABEL_52;
          }

          v25 = v20;
        }

        else
        {
          v25 = v20;
        }

        v20 = v25;
      }

      superview = [(UIView *)v17 superview];

      v28 = 0x7FFFFFFFFFFFFFFFLL;
      if (superview)
      {
        v17 = superview;
        if (superview != self)
        {
          continue;
        }
      }

      v17 = superview;
      v30 = v19;
      goto LABEL_32;
    }
  }

  v30 = v18;
  v28 = 0x7FFFFFFFFFFFFFFFLL;
LABEL_32:
  if (sectionCopy == 0x7FFFFFFFFFFFFFFFLL)
  {
    v33 = 0;
    v34 = v49;
  }

  else
  {
    _collectionViewData5 = [(UICollectionView *)self _collectionViewData];
    v32 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:sectionCopy];
    v33 = [(UICollectionViewData *)_collectionViewData5 globalIndexForItemAtIndexPath:v32];

    v34 = v33 + v48;
  }

  v35 = objc_opt_new();
  v36 = v35;
  v37 = v33 + 5;
  if (v33 + 5 >= v34 - 1)
  {
    v37 = v34 - 1;
  }

  [v35 addIndexesInRange:{v33, v37 - v33 + 1, v48}];
  if (v34 - 6 <= v33)
  {
    v38 = v33;
  }

  else
  {
    v38 = v34 - 6;
  }

  [v36 addIndexesInRange:{v38, v34 - v38}];
  if (v28 != 0x7FFFFFFFFFFFFFFFLL)
  {
    [v36 addIndexesInRange:?];
    [v36 removeIndex:v28];
  }

  v39 = objc_opt_new();
  v55[0] = MEMORY[0x1E69E9820];
  v55[1] = 3221225472;
  v55[2] = __72__UICollectionView__updateFocusScrollBoundaryMetrics_forItem_inSection___block_invoke;
  v55[3] = &unk_1E70F3B48;
  v40 = v39;
  v56 = v40;
  v50 = v36;
  [v36 enumerateIndexesUsingBlock:v55];
  if ([v40 count])
  {
    v41 = 0;
    do
    {
      if (v41)
      {
        v42 = [v40 count] + ~(v41 >> 1);
      }

      else
      {
        v42 = v41 >> 1;
      }

      v43 = [v40 objectAtIndexedSubscript:v42];
      integerValue = [v43 integerValue];

      _collectionViewData6 = [(UICollectionView *)self _collectionViewData];
      v46 = [(UICollectionViewData *)_collectionViewData6 layoutAttributesForGlobalItemIndex:integerValue];

      [v46 frame];
      [(_UIFocusScrollBoundaryMetrics *)v30 checkOtherRect:?];
      LODWORD(v22) = [(_UIFocusScrollBoundaryMetrics *)v19 consumeOtherMetrics:v30];

      if (v22)
      {
        break;
      }

      ++v41;
    }

    while (v41 < [v40 count]);
  }

  else
  {
    LOBYTE(v22) = 0;
  }

LABEL_52:
  itemCopy = v52;
  metricsCopy = v51;
  if (sectionCopy == 0x7FFFFFFFFFFFFFFFLL && (v22 & 1) == 0)
  {
    goto LABEL_54;
  }

LABEL_55:
}

void __72__UICollectionView__updateFocusScrollBoundaryMetrics_forItem_inSection___block_invoke(uint64_t a1, uint64_t a2)
{
  v2 = *(a1 + 32);
  v3 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:a2];
  [v2 addObject:v3];
}

- (id)targetForAction:(SEL)action withSender:(id)sender
{
  senderCopy = sender;
  targetForKeyCommands = [(_UICollectionViewMultiSelectController *)self->_multiSelectController targetForKeyCommands];
  v8 = objc_opt_respondsToSelector();

  if (v8)
  {
    targetForKeyCommands2 = [(_UICollectionViewMultiSelectController *)self->_multiSelectController targetForKeyCommands];
  }

  else
  {
    v12.receiver = self;
    v12.super_class = UICollectionView;
    targetForKeyCommands2 = [(UIResponder *)&v12 targetForAction:action withSender:senderCopy];
  }

  v10 = targetForKeyCommands2;

  return v10;
}

- (id)_targetIndexPathForMoveOfItemFromOriginalIndexPath:(id)path atCurrentIndexPath:(id)indexPath toProposedIndexPath:(id)proposedIndexPath
{
  pathCopy = path;
  indexPathCopy = indexPath;
  proposedIndexPathCopy = proposedIndexPath;
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x40000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v13 = [_delegateProxy collectionView:self targetIndexPathForMoveOfItemFromOriginalIndexPath:pathCopy atCurrentIndexPath:indexPathCopy toProposedIndexPath:proposedIndexPathCopy];
  }

  else if ((collectionViewFlags & 0x20000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v13 = [_delegateProxy collectionView:self targetIndexPathForMoveFromItemAtIndexPath:indexPathCopy toProposedIndexPath:proposedIndexPathCopy];
  }

  else
  {
    if ((collectionViewFlags & 0x10000) == 0)
    {
      goto LABEL_8;
    }

    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v13 = [_delegateProxy _collectionView:self targetIndexPathForMoveFromItemAtIndexPath:indexPathCopy toProposedIndexPath:proposedIndexPathCopy];
  }

  v14 = v13;

  proposedIndexPathCopy = v14;
LABEL_8:

  return proposedIndexPathCopy;
}

- (BOOL)_canReorderItemAtIndexPath:(id)path
{
  pathCopy = path;
  if (!pathCopy || ![(UICollectionView *)self _dataSourceSupportsReordering])
  {
    goto LABEL_13;
  }

  if (![(UICollectionView *)self _dataSourceImplementsReorderingHandlers])
  {
    collectionViewFlags = self->_collectionViewFlags;
    v5 = *(&self->_collectionViewFlags + 1);
    if ((v5 & 1) == 0 || (collectionViewFlags & 0x8000000000000000) == 0)
    {
      if ((~collectionViewFlags & 0xC00000000000000) == 0)
      {
        _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
        v8 = [_dataSourceProxy _collectionView:self canMoveItemAtIndexPath:pathCopy];
        goto LABEL_7;
      }

      if ((v5 & 0x10) == 0 || dyld_program_sdk_at_least())
      {
        v9 = (collectionViewFlags & 0x800000000000000 | v5 & 1) != 0;
        goto LABEL_14;
      }

LABEL_13:
      v9 = 0;
      goto LABEL_14;
    }
  }

  _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
  v8 = [_dataSourceProxy collectionView:self canMoveItemAtIndexPath:pathCopy];
LABEL_7:
  v9 = v8;

LABEL_14:
  return v9;
}

- (BOOL)_canBeginReorderingItem
{
  _allowsItemInteractionsToBegin = [(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin];
  if (_allowsItemInteractionsToBegin)
  {
    dragAndDropController = self->_dragAndDropController;

    LOBYTE(_allowsItemInteractionsToBegin) = [(_UICollectionViewDragAndDropController *)dragAndDropController canBeginReorderingSession];
  }

  return _allowsItemInteractionsToBegin;
}

- (BOOL)_beginReorderingItemAtIndexPath:(id)path isLegacyMovement:(BOOL)movement
{
  movementCopy = movement;
  pathCopy = path;
  if ((!movementCopy || [(UICollectionView *)self _canBeginReorderingItem]) && ((dragAndDropController = self->_dragAndDropController) == 0 ? (sessionKind = 0) : (sessionKind = dragAndDropController->_sessionKind), [(UICollectionView *)self _canReorderItemAtIndexPath:pathCopy]|| (sessionKind & 0xFFFFFFFFFFFFFFFELL) == 2))
  {
    [(UICollectionView *)self _resetPrefetchState];
    v10 = [(UICollectionView *)self _cellForItemAtIndexPath:pathCopy];
    _layoutAttributes = [v10 _layoutAttributes];
    [_layoutAttributes center];
    v13 = v12;
    v15 = v14;

    [(_UIDragFeedbackGenerator *)self->_reorderFeedbackGenerator userInteractionStartedAtLocation:v13, v15];
    if (sessionKind == 1)
    {
      [(_UIDragSnappingFeedbackGenerator *)self->_reorderFeedbackGenerator draggedObjectLiftedAtLocation:v13, v15];
    }

    [(_UICollectionViewDragAndDropController *)self->_dragAndDropController beginReorderingForItemAtIndexPath:pathCopy cell:v10];
    v16 = [(UICollectionView *)self _cellForItemAtIndexPath:pathCopy];

    self->_reorderingTargetPosition.x = v13;
    self->_reorderingTargetPosition.y = v15;
    [(UICollectionView *)self _reparentViewIntoSelf:v16];
    v17 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:pathCopy];
    if (dyld_program_sdk_at_least())
    {
      traitCollection = [(UIView *)self traitCollection];
      userInterfaceIdiom = [traitCollection userInterfaceIdiom];

      if (userInterfaceIdiom == 6)
      {
        if (dyld_program_sdk_at_least())
        {
          v20 = 6;
        }

        else
        {
          v20 = 4;
        }

        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __69__UICollectionView__beginReorderingItemAtIndexPath_isLegacyMovement___block_invoke;
        v22[3] = &unk_1E70F6228;
        v22[4] = self;
        v23 = v17;
        v24 = v16;
        [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v20 options:v22 animations:0 completion:?];
      }

      else
      {
        [(UICollectionView *)self _applyLayoutAttributes:v17 toView:v16];
      }
    }

    else
    {
      -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v16, [v17 zIndex], 1, 0);
    }

    v9 = 1;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (void)updateInteractiveMovementTargetPosition:(CGPoint)targetPosition
{
  y = targetPosition.y;
  x = targetPosition.x;
  [(UICollectionView *)self _updateReorderingTargetPosition:?];
  reorderFeedbackGenerator = self->_reorderFeedbackGenerator;

  [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator positionUpdatedAtLocation:x, y];
}

- (void)_updateReorderingTargetPosition:(CGPoint)position
{
  y = position.y;
  x = position.x;
  if ([(UICollectionView *)self _isReordering])
  {
    v6 = self->_reorderingTargetPosition.x;
    v7 = self->_reorderingTargetPosition.y;
    if (v6 != x || v7 != y)
    {
      self->_reorderingTargetPosition.x = x;
      self->_reorderingTargetPosition.y = y;
      v9 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController updateReorderingForTargetPosition:y];
      v10 = [v9 count];
      layout = self->_layout;
      allValues = [v9 allValues];
      allKeys = [v9 allKeys];
      v14 = [(UICollectionViewLayout *)layout _invalidationContextForReorderingTargetPosition:allValues targetIndexPaths:allKeys withPreviousPosition:x previousIndexPaths:y, v6, v7];

      v22[0] = MEMORY[0x1E69E9820];
      v22[1] = 3221225472;
      v22[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke;
      v22[3] = &unk_1E70F5B18;
      v22[4] = self;
      v25 = v10 != 0;
      v15 = v9;
      v23 = v15;
      v16 = v14;
      v24 = v16;
      v17 = [(UICollectionView *)self _performShadowUpdates:v22];
      if (v10)
      {
        reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
        v21[0] = MEMORY[0x1E69E9820];
        v21[1] = 3221225472;
        v21[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_4;
        v21[3] = &unk_1E70F6848;
        v21[4] = self;
        *&v21[5] = x;
        *&v21[6] = y;
        [(UIFeedbackGenerator *)reorderFeedbackGenerator performFeedbackWithDelay:v21 insideBlock:0.05];
      }

      dragAndDropController = self->_dragAndDropController;
      if (!dragAndDropController || dragAndDropController->_sessionKind != 2)
      {
        _autoScrollAssistant = [(UIScrollView *)self _autoScrollAssistant];
        [_autoScrollAssistant autoScrollFromPoint:{x, y}];
      }
    }
  }
}

void __52__UICollectionView__updateReorderingTargetPosition___block_invoke(uint64_t a1)
{
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_2;
  v5[3] = &unk_1E70F5AF0;
  v8 = *(a1 + 56);
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v4 = *(a1 + 32);
  v6 = v3;
  v7 = v4;
  [v2 _performBatchUpdates:v5 completion:0 invalidationContext:*(a1 + 48) tentativelyForReordering:1];
}

uint64_t __52__UICollectionView__updateReorderingTargetPosition___block_invoke_2(uint64_t result)
{
  if (*(result + 48) == 1)
  {
    v4[5] = v1;
    v4[6] = v2;
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_3;
    v4[3] = &unk_1E70FF950;
    v3 = *(result + 32);
    v4[4] = *(result + 40);
    return [v3 enumerateKeysAndObjectsUsingBlock:v4];
  }

  return result;
}

void __52__UICollectionView__updateReorderingTargetPosition___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:?];
  [*(a1 + 32) _accessibilityPostReorderingAnnouncementForCurrentIndexPath:v6 targetIndexPath:a3 previousIndexPath:a2];
  [*(a1 + 32) _moveItemAtIndexPath:a2 toIndexPath:a3];
}

- (id)_autoScrollAssistantForIndexPath:(id)path
{
  pathCopy = path;
  if (pathCopy && [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:pathCopy])
  {
    _autoScrollAssistant = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa autoScrollAssistantForOrthogonalScrollingSectionAtIndexPath:pathCopy];
  }

  else
  {
    _autoScrollAssistant = [(UIScrollView *)self _autoScrollAssistant];
  }

  v6 = _autoScrollAssistant;

  return v6;
}

- (void)_autoScrollAssistantUpdateContentOffset:(CGPoint)offset
{
  y = offset.y;
  x = offset.x;
  [(UIScrollView *)self contentOffset];
  v7 = v6;
  v9 = v8;
  _layoutAxis = [(UICollectionViewLayout *)self->_layout _layoutAxis];
  if (_layoutAxis - 1 > 1 || ((v11 = _layoutAxis, [(UIView *)self bounds], v33 = v13, v34 = v12, [(UIScrollView *)self contentSize], v32 = v14, v16 = v15, [(UIScrollView *)self adjustedContentInset], v35 = v7, v18 = v17, v20 = v19, v22 = v21, v24 = v23, v25 = [(UIView *)self effectiveUserInterfaceLayoutDirection], v25 != UIUserInterfaceLayoutDirectionRightToLeft) ? (v26 = v24) : (v26 = v20), v25 != UIUserInterfaceLayoutDirectionRightToLeft ? (v27 = v20) : (v27 = v24), v28 = _UITotalEdgeDimensionsForLayoutAxis(v11, v18, v27, v22, v26), v29 = v28 + _UISizeValueForAxis(v11, v32, v16), v30 = v29 - _UISizeValueForAxis(v11, v34, v33), v31 = _UIPointValueForAxis(v11, x, y) > v30, v7 = v35, !v31))
  {
    v36.receiver = self;
    v36.super_class = UICollectionView;
    [(UIScrollView *)&v36 _autoScrollAssistantUpdateContentOffset:x, y];
    if (![(UIScrollView *)self isPagingEnabled])
    {
      [(UICollectionView *)self _updateReorderingTargetPosition:x - v7 + self->_reorderingTargetPosition.x, y - v9 + self->_reorderingTargetPosition.y];
    }
  }
}

- (void)_completeInteractiveMovementWithDisposition:(int64_t)disposition
{
  v82 = *MEMORY[0x1E69E9840];
  if (self)
  {
    dragAndDropController = self->_dragAndDropController;
    if (dragAndDropController)
    {
      if ([(NSMutableArray *)dragAndDropController->__reorderedItems count])
      {
        p_collectionViewFlags = &self->_collectionViewFlags;
        v7 = *(&self->_collectionViewFlags + 1);
        if ((v7 & 0x2000000000000000) == 0)
        {
          *(&self->_collectionViewFlags + 1) = v7 | 0x2000000000000000;
          [(UICollectionView *)self _removeReorderDestinationView];
          v8 = disposition - 1;
          x = self->_reorderingTargetPosition.x;
          y = self->_reorderingTargetPosition.y;
          if ((disposition - 1) > 1)
          {
            v77 = 0;
            [(UICollectionView *)self _getOriginalReorderingIndexPaths:0 targetIndexPaths:&v77];
            v11 = v77;
            v12 = v11;
          }

          else if (disposition == 2)
          {
            v11 = 0;
            v12 = 0;
          }

          else
          {
            v79 = 0;
            v78 = 0;
            [(UICollectionView *)self _getOriginalReorderingIndexPaths:&v79 targetIndexPaths:&v78];
            v12 = v79;
            v11 = v78;
          }

          _autoScrollAssistant = [(UIScrollView *)self _autoScrollAssistant];
          [_autoScrollAssistant stop];

          reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
          if (v8 >= 2)
          {
            [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator userInteractionEndedAtLocation:x, y];
          }

          else
          {
            [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator userInteractionCancelledAtLocation:x, y];
            if (disposition == 2)
            {
LABEL_15:
              _reorderedItems = [(UICollectionView *)self _reorderedItems];
              v16 = self->_dragAndDropController;
              if (v16)
              {
                sessionKind = v16->_sessionKind;
              }

              else
              {
                sessionKind = 0;
              }

              _dataSourceImplementsReorderingHandlers = [(UICollectionView *)self _dataSourceImplementsReorderingHandlers];
              v76 = 1;
              v18 = self->_dragAndDropController;
              if (v8 >= 2)
              {
                v49 = (disposition - 1) < 2;
                v50 = v11;
                v51 = v12;
                endReordering = [(_UICollectionViewDragAndDropController *)v18 endReordering];
              }

              else
              {
                v19 = [(_UICollectionViewDragAndDropController *)v18 cancelReorderingForced:&v76 shouldCancelUsingBatchUpdate:?];
                v20 = v19;
                if (disposition == 2 && (v76 & 1) == 0)
                {
                  if (!v19)
                  {
                    goto LABEL_75;
                  }

                  [(UICollectionView *)self _addReloadDataCompletionBlock:v19];
LABEL_74:

LABEL_75:
                  *(p_collectionViewFlags + 1) &= ~0x2000000000000000uLL;

                  return;
                }

                endReordering = v19;
                v49 = (disposition - 1) < 2;
                v50 = v11;
                v51 = v12;
              }

              v74 = 0u;
              v75 = 0u;
              v72 = 0u;
              v73 = 0u;
              v52 = _reorderedItems;
              v21 = _reorderedItems;
              v22 = [v21 countByEnumeratingWithState:&v72 objects:v81 count:16];
              if (v22)
              {
                v23 = v22;
                v24 = *v73;
                do
                {
                  v25 = 0;
                  do
                  {
                    if (*v73 != v24)
                    {
                      objc_enumerationMutation(v21);
                    }

                    v26 = *(*(&v72 + 1) + 8 * v25);
                    originalIndexPath = [v26 originalIndexPath];
                    targetIndexPath = [v26 targetIndexPath];
                    if (([originalIndexPath isEqual:targetIndexPath] & 1) == 0)
                    {
                      if (sessionKind == 1)
                      {
                        if ((*(p_collectionViewFlags + 8) & 1) != 0 || [(UICollectionView *)self _dataSourceImplementsReorderingHandlers])
                        {
                          if (v8 > 1)
                          {
                            [(UICollectionView *)self _notifyDataSourceForMoveOfItemFromIndexPath:originalIndexPath toIndexPath:targetIndexPath];
                          }

                          else if (!dyld_program_sdk_at_least() || (v29 = self->_dragAndDropController) != 0 && v29->_sessionKind != 3)
                          {
                            objc_storeStrong(&self->_cancellingToIndexPath, originalIndexPath);
                            v71[0] = MEMORY[0x1E69E9820];
                            v71[1] = 3221225472;
                            v71[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke;
                            v71[3] = &unk_1E70FEEC8;
                            v71[4] = self;
                            v71[5] = targetIndexPath;
                            v71[6] = originalIndexPath;
                            [(UICollectionView *)self _performInternalBatchUpdates:v71];
                            cancellingToIndexPath = self->_cancellingToIndexPath;
                            self->_cancellingToIndexPath = 0;
                            p_collectionViewFlags = &self->_collectionViewFlags;
                          }
                        }

                        else if (v8 >= 2 && (*p_collectionViewFlags & 0x800000000000000) != 0)
                        {
                          _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
                          [_dataSourceProxy _collectionView:self moveItemAtIndexPath:originalIndexPath toIndexPath:targetIndexPath];

                          p_collectionViewFlags = &self->_collectionViewFlags;
                        }
                      }

                      else if (v8 > 1)
                      {
                        if ((sessionKind & 0xFFFFFFFFFFFFFFFELL) != 2 || !_dataSourceImplementsReorderingHandlers && [(UICollectionView *)self _supportsAutomaticCatalystDragAndDropReordering])
                        {
                          v69[0] = MEMORY[0x1E69E9820];
                          v69[1] = 3221225472;
                          v69[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_3;
                          v69[3] = &unk_1E70FEEC8;
                          v69[4] = self;
                          v69[5] = originalIndexPath;
                          v69[6] = targetIndexPath;
                          [(UICollectionView *)self _performInternalBatchUpdates:v69];
                        }
                      }

                      else
                      {
                        v31 = self->_dragAndDropController;
                        if (v31 && v31->_sessionKind != 3)
                        {
                          v70[0] = MEMORY[0x1E69E9820];
                          v70[1] = 3221225472;
                          v70[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_2;
                          v70[3] = &unk_1E70FEEC8;
                          v70[4] = self;
                          v70[5] = targetIndexPath;
                          v70[6] = originalIndexPath;
                          v32 = [(UICollectionView *)self _performShadowUpdates:v70];
                        }
                      }
                    }

                    ++v25;
                  }

                  while (v23 != v25);
                  v34 = [v21 countByEnumeratingWithState:&v72 objects:v81 count:16];
                  v23 = v34;
                }

                while (v34);
              }

              v67 = 0u;
              v68 = 0u;
              v65 = 0u;
              v66 = 0u;
              v35 = v21;
              v36 = [v35 countByEnumeratingWithState:&v65 objects:v80 count:16];
              if (v36)
              {
                v37 = v36;
                v38 = *v66;
                v39 = 1;
                do
                {
                  for (i = 0; i != v37; ++i)
                  {
                    if (*v66 != v38)
                    {
                      objc_enumerationMutation(v35);
                    }

                    cell = [*(*(&v65 + 1) + 8 * i) cell];
                    subviewManager = self->_subviewManager;
                    if (subviewManager && [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:cell])
                    {
                      if ((dyld_program_sdk_at_least() & 1) == 0)
                      {
                        [cell _invalidatePreferredAttributes];
                      }
                    }

                    else
                    {
                      v39 = 0;
                    }
                  }

                  v37 = [v35 countByEnumeratingWithState:&v65 objects:v80 count:16];
                }

                while (v37);
              }

              else
              {
                v39 = 1;
              }

              aBlock[0] = MEMORY[0x1E69E9820];
              aBlock[1] = 3221225472;
              aBlock[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_5;
              aBlock[3] = &unk_1E70FF978;
              v63 = sessionKind == 1;
              aBlock[4] = self;
              v12 = v51;
              v60 = v51;
              v11 = v50;
              v61 = v50;
              v64 = v49;
              v43 = v35;
              v62 = v43;
              v44 = _Block_copy(aBlock);
              v55[0] = MEMORY[0x1E69E9820];
              v55[1] = 3221225472;
              v55[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_6;
              v55[3] = &unk_1E70F8A38;
              v57 = v39 & 1;
              v58 = sessionKind == 1;
              v55[4] = self;
              v56 = v43;
              v45 = _Block_copy(v55);
              if (dyld_program_sdk_at_least())
              {
                v46 = 6;
              }

              else
              {
                v46 = 4;
              }

              [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v46 options:v44 animations:v45 completion:?];
              v20 = endReordering;
              if (endReordering)
              {
                (*(endReordering + 16))(endReordering);
              }

              p_collectionViewFlags = &self->_collectionViewFlags;
              _reorderedItems = v52;
              if (v8 >= 2 && sessionKind == 1)
              {
                v47 = self->_reorderFeedbackGenerator;
                v54[0] = MEMORY[0x1E69E9820];
                v54[1] = 3221225472;
                v54[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_8;
                v54[3] = &unk_1E70F6848;
                v54[4] = self;
                *&v54[5] = x;
                *&v54[6] = y;
                [(UIFeedbackGenerator *)v47 performFeedbackWithDelay:v54 insideBlock:0.3];
              }

              goto LABEL_74;
            }
          }

          [(UIView *)self layoutBelowIfNeeded];
          goto LABEL_15;
        }
      }
    }
  }
}

uint64_t __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_3(uint64_t a1)
{
  v2[0] = MEMORY[0x1E69E9820];
  v2[1] = 3221225472;
  v2[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_4;
  v2[3] = &unk_1E70FEEC8;
  v3 = *(a1 + 32);
  v4 = *(a1 + 48);
  return [v3 performBatchUpdates:v2 completion:0];
}

void __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_5(uint64_t a1)
{
  v35 = *MEMORY[0x1E69E9840];
  if (*(a1 + 64) == 1)
  {
    v2 = *(*(a1 + 32) + 2152);
    v3 = [v2 _invalidationContextForEndingReorderingItemToFinalIndexPaths:*(a1 + 40) previousIndexPaths:*(a1 + 48) reorderingCancelled:*(a1 + 65)];
    [v2 invalidateLayoutWithContext:v3];

    v4 = *(a1 + 32);
    v5 = v4[284];
    [v4 visibleBounds];
    [(UICollectionViewData *)v5 validateLayoutInRect:v6, v7, v8, v9];
  }

  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  obj = *(a1 + 56);
  v10 = [obj countByEnumeratingWithState:&v30 objects:v34 count:16];
  if (v10)
  {
    v11 = v10;
    v29 = *v31;
    do
    {
      for (i = 0; i != v11; ++i)
      {
        if (*v31 != v29)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v30 + 1) + 8 * i);
        v14 = [v13 cell];
        if (*(a1 + 65))
        {
          [v13 originalIndexPath];
        }

        else
        {
          [v13 targetIndexPath];
        }
        v15 = ;
        v16 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:v15];
        if (v16)
        {
          v17 = v16 == v14;
        }

        else
        {
          v17 = 1;
        }

        v18 = !v17;

        if ((dyld_program_sdk_at_least() & 1) == 0)
        {
          v19 = *(*(a1 + 32) + 2984);
          v20 = [v13 cell];
          if (v19)
          {
            v18 |= [(_UICollectionViewSubviewCollection *)*(v19 + 8) containsView:v20];
          }
        }

        if ((v18 & 1) == 0)
        {
          v21 = *(*(a1 + 32) + 2272);
          if (v21)
          {
            if ([(UICollectionViewData *)v21 _isIndexPathValid:v15 validateItemCounts:1])
            {
              v22 = [v14 _layoutAttributes];
              v23 = [v22 indexPath];
              v24 = v15;
              v25 = v24;
              if (v23 == v24)
              {

LABEL_30:
                v22 = [*(*(a1 + 32) + 2152) layoutAttributesForItemAtIndexPath:v25];
                v27 = *(a1 + 32);
                v23 = [v13 cell];
                [v27 _applyLayoutAttributes:v22 toView:v23];
LABEL_32:

                goto LABEL_33;
              }

              if (!v24 || !v23)
              {

                goto LABEL_32;
              }

              v26 = [v23 isEqual:v24];

              if (v26)
              {
                goto LABEL_30;
              }
            }
          }
        }

LABEL_33:
      }

      v11 = [obj countByEnumeratingWithState:&v30 objects:v34 count:16];
    }

    while (v11);
  }
}

void __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_6(uint64_t a1)
{
  v38 = *MEMORY[0x1E69E9840];
  if ((*(a1 + 48) & 1) == 0)
  {
    if (*(a1 + 49) == 1)
    {
      if (*(*(a1 + 32) + 2184) <= 0)
      {
        v2 = 0;
      }

      else
      {
        v2 = 300000000;
      }

      v3 = dispatch_time(0, v2);
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_7;
      block[3] = &unk_1E70F3590;
      block[4] = *(a1 + 32);
      dispatch_after(v3, MEMORY[0x1E69E96A0], block);
    }

    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    v4 = *(a1 + 40);
    v5 = [v4 countByEnumeratingWithState:&v31 objects:v37 count:16];
    if (v5)
    {
      v6 = v5;
      v7 = *v32;
      do
      {
        v8 = 0;
        do
        {
          if (*v32 != v7)
          {
            objc_enumerationMutation(v4);
          }

          v9 = [*(*(&v31 + 1) + 8 * v8) cell];
          v10 = [v9 superview];
          if (v10)
          {
            v11 = v10;
            v12 = *(*(a1 + 32) + 2984);
            if (v12)
            {
              v13 = [(_UICollectionViewSubviewCollection *)*(v12 + 8) containsView:v9];

              if (v13)
              {
                goto LABEL_16;
              }
            }

            else
            {
            }

            [v9 removeFromSuperview];
          }

LABEL_16:

          ++v8;
        }

        while (v6 != v8);
        v14 = [v4 countByEnumeratingWithState:&v31 objects:v37 count:16];
        v6 = v14;
      }

      while (v14);
    }
  }

  v29 = 0u;
  v30 = 0u;
  v27 = 0u;
  v28 = 0u;
  v15 = *(a1 + 40);
  v16 = [v15 countByEnumeratingWithState:&v27 objects:v36 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v28;
    do
    {
      for (i = 0; i != v17; ++i)
      {
        if (*v28 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v27 + 1) + 8 * i);
        v21 = [v20 cell];
        v22 = [v21 superview];
        if (v22)
        {
          v23 = v22;
          v24 = [v20 cell];
          v25 = [v24 _isHiddenForReuse];

          if (v25)
          {
            continue;
          }

          v26 = *(a1 + 32);
          v21 = [v20 cell];
          [v26 _reparentViewIntoCorrectContainer:v21];
        }
      }

      v17 = [v15 countByEnumeratingWithState:&v27 objects:v36 count:16];
    }

    while (v17);
  }
}

uint64_t __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_7(uint64_t a1)
{
  result = [*(*(a1 + 32) + 2152) _estimatesSizes];
  if (result)
  {
    v3 = *(a1 + 32);

    return [v3 _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  }

  return result;
}

- (void)_notifyDataSourceForMoveOfItemFromIndexPath:(id)path toIndexPath:(id)indexPath
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    indexPathCopy = indexPath;
    pathCopy = path;
    v11 = [[UICollectionViewUpdateItem alloc] initWithInitialIndexPath:pathCopy finalIndexPath:indexPathCopy updateAction:3];
    expectedDiffableUpdateItem = self->_expectedDiffableUpdateItem;
    self->_expectedDiffableUpdateItem = v11;

    _dataSourceProxy = [(UICollectionView *)self _dataSourceProxy];
    [_dataSourceProxy collectionView:self moveItemAtIndexPath:pathCopy toIndexPath:indexPathCopy];

    v8 = self->_expectedDiffableUpdateItem;
    self->_expectedDiffableUpdateItem = 0;
  }

  else
  {
    indexPathCopy2 = indexPath;
    pathCopy2 = path;
    _dataSourceProxy2 = [(UICollectionView *)self _dataSourceProxy];
    [(UICollectionViewUpdateItem *)_dataSourceProxy2 collectionView:self moveItemAtIndexPath:pathCopy2 toIndexPath:indexPathCopy2];

    v8 = _dataSourceProxy2;
  }
}

- (void)_getOriginalReorderingIndexPaths:(id *)paths targetIndexPaths:(id *)indexPaths
{
  v26 = *MEMORY[0x1E69E9840];
  if (self && (dragAndDropController = self->_dragAndDropController) != 0)
  {
    v8 = [(NSMutableArray *)dragAndDropController->__reorderedItems count];
  }

  else
  {
    v8 = 0;
  }

  if (paths)
  {
    v9 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v8];
    if (indexPaths)
    {
LABEL_6:
      v10 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v8];
      goto LABEL_9;
    }
  }

  else
  {
    v9 = 0;
    if (indexPaths)
    {
      goto LABEL_6;
    }
  }

  v10 = 0;
LABEL_9:
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  _reorderedItems = [(UICollectionView *)self _reorderedItems];
  v12 = [_reorderedItems countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v22;
    do
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v22 != v14)
        {
          objc_enumerationMutation(_reorderedItems);
        }

        v16 = *(*(&v21 + 1) + 8 * i);
        originalIndexPath = [v16 originalIndexPath];
        [v9 addObject:originalIndexPath];

        targetIndexPath = [v16 targetIndexPath];
        [v10 addObject:targetIndexPath];
      }

      v13 = [_reorderedItems countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v13);
  }

  if (paths)
  {
    v19 = v9;
    *paths = v9;
  }

  if (indexPaths)
  {
    v20 = v10;
    *indexPaths = v10;
  }
}

- (void)_removeReorderDestinationView
{
  reorderDestinationView = self->_reorderDestinationView;
  if (reorderDestinationView)
  {
    [(UIView *)reorderDestinationView removeFromSuperview];
    v4 = self->_reorderDestinationView;
    self->_reorderDestinationView = 0;
  }
}

- (void)_updateReorderDestinationViewWithLayoutAttributes:(id)attributes
{
  attributesCopy = attributes;
  v16 = attributesCopy;
  if (!self->_reorderDestinationView)
  {
    traitCollection = [(UIView *)self traitCollection];
    v6 = traitCollection;
    if (traitCollection)
    {
      _UIRecordTraitUsage(traitCollection, 0x13uLL);
      v7 = v6[16] == 2;
    }

    else
    {
      v7 = 0;
    }

    v8 = [[_UIDragDestinationIndicatorView alloc] initWithSourceListStyle:v7];
    reorderDestinationView = self->_reorderDestinationView;
    self->_reorderDestinationView = v8;

    [(UIView *)self addSubview:self->_reorderDestinationView];
    attributesCopy = v16;
  }

  [attributesCopy size];
  v11 = v10;
  v13 = v12;
  v14 = self->_reorderDestinationView;
  [v16 frame];
  if (v11 <= v13)
  {
    [(_UIDragDestinationIndicatorView *)v14 positionHorizontallyCenteredInFrame:?];
  }

  else
  {
    [(_UIDragDestinationIndicatorView *)v14 positionVerticallyCenteredInFrame:?];
  }

  indexPath = [v16 indexPath];
  [(_UIDragDestinationIndicatorView *)self->_reorderDestinationView setCurrentIndexPath:indexPath];
}

- (void)_cellDidBecomeFocused:(id)focused
{
  v7 = [(UICollectionView *)self _indexPathForCell:focused];
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x100000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy _collectionView:self didFocusItemAtIndexPath:v7];

    collectionViewFlags = self->_collectionViewFlags;
  }

  if ((collectionViewFlags & 0x400000) != 0)
  {
    _delegateProxy2 = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy2 collectionView:self didFocusItemAtIndexPath:v7];
  }
}

- (void)_cellDidBecomeUnfocused:(id)unfocused
{
  v4 = [(UICollectionView *)self _indexPathForCell:unfocused];
  if ((*(&self->_collectionViewFlags + 2) & 0x80) != 0)
  {
    v6 = v4;
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self didUnfocusItemAtIndexPath:v6];

    v4 = v6;
  }
}

- (BOOL)_shouldUpdateFocusInContext:(id)context
{
  contextCopy = context;
  v12.receiver = self;
  v12.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v12 _shouldUpdateFocusInContext:contextCopy];
  if (![(UICollectionView *)self _isMovingFocusFromHorizontalIndexBarToCellContent:contextCopy])
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x8000000) != 0)
    {
      v7 = [UICollectionViewFocusUpdateContext _contextWithContext:contextCopy collectionView:self];
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v5 = [_delegateProxy collectionView:self shouldUpdateFocusInContext:v7];
    }

    else
    {
      if ((collectionViewFlags & 0x2000000) == 0)
      {
        goto LABEL_10;
      }

      v7 = [UICollectionViewFocusUpdateContext _contextWithContext:contextCopy collectionView:self];
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      previouslyFocusedIndexPath = [v7 previouslyFocusedIndexPath];
      nextFocusedView = [v7 nextFocusedView];
      v5 = [_delegateProxy collectionView:self shouldUpdateFocusFromItemAtIndexPath:previouslyFocusedIndexPath toView:nextFocusedView heading:{objc_msgSend(v7, "focusHeading")}];
    }

    goto LABEL_10;
  }

  if (![(UIScrollView *)self isScrollAnimating])
  {
    [(UICollectionView *)self setIsMovingFocusFromHorizontalIndexTitleBarToContent:1];
    [(UIView *)self setNeedsFocusUpdate];
  }

  v5 = 0;
LABEL_10:

  return v5;
}

- (id)_managedSubviewForView:(id)view
{
  viewCopy = view;
  v5 = viewCopy;
  v6 = 0;
  superview = viewCopy;
  if (viewCopy && viewCopy != self)
  {
    v8 = viewCopy;
    while (1)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v9 = v8;
        _layoutAttributes = [(UICollectionView *)v9 _layoutAttributes];

        if (_layoutAttributes)
        {
          _layoutAttributes = [(UICollectionView *)v9 _collectionView];
        }
      }

      else
      {
        _layoutAttributes = 0;
      }

      if (_layoutAttributes == self)
      {
        break;
      }

      superview = [(UIView *)v8 superview];

      v6 = 0;
      if (superview)
      {
        v8 = superview;
        if (superview != self)
        {
          continue;
        }
      }

      goto LABEL_14;
    }

    superview = v8;

    v6 = superview;
  }

LABEL_14:

  return v6;
}

- (BOOL)_canReusePreviouslyFocusedManagedSubview:(id)subview
{
  v25 = *MEMORY[0x1E69E9840];
  subviewCopy = subview;
  if (!subviewCopy)
  {
    goto LABEL_22;
  }

  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  v6 = _focusedItemState;
  if (_focusedItemState)
  {
    v7 = *(_focusedItemState + 8);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;
  if (v8 == subviewCopy)
  {

LABEL_22:
    v18 = 0;
    goto LABEL_23;
  }

  firstResponderView = self->_firstResponderView;

  if (firstResponderView == subviewCopy)
  {
    goto LABEL_22;
  }

  if ([(UICollectionReusableView *)subviewCopy _isInUpdateAnimation])
  {
    goto LABEL_22;
  }

  if (([(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:subviewCopy]& 1) != 0)
  {
    goto LABEL_22;
  }

  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    if (([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:subviewCopy]& 1) != 0)
    {
      goto LABEL_22;
    }
  }

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  objectEnumerator = [(NSMutableDictionary *)self->_prefetchCacheItems objectEnumerator];
  v12 = [objectEnumerator countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v21;
    while (2)
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v21 != v14)
        {
          objc_enumerationMutation(objectEnumerator);
        }

        v16 = *(*(&v20 + 1) + 8 * i);
        if (v16)
        {
          v16 = v16[3];
        }

        v17 = v16;

        if (v17 == subviewCopy)
        {
          v18 = 0;
          goto LABEL_25;
        }
      }

      v13 = [objectEnumerator countByEnumeratingWithState:&v20 objects:v24 count:16];
      if (v13)
      {
        continue;
      }

      break;
    }
  }

  v18 = 1;
LABEL_25:

LABEL_23:
  return v18;
}

- (void)_reusePreviouslyFocusedManagedSubviewIfNeeded:(id)needed
{
  v13 = *MEMORY[0x1E69E9840];
  neededCopy = needed;
  if ([(UICollectionView *)self _canReusePreviouslyFocusedManagedSubview:neededCopy])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_reusePreviouslyFocusedManagedSubviewIfNeeded____s_category);
    if (*CategoryCachedImpl)
    {
      v8 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
      {
        v9 = 134218242;
        selfCopy = self;
        v11 = 2112;
        v12 = neededCopy;
        _os_log_impl(&dword_188A29000, v8, OS_LOG_TYPE_ERROR, "[UICV %p] Reusing previously focused managed subview %@", &v9, 0x16u);
      }
    }

    _layoutAttributes = [neededCopy _layoutAttributes];
    if (_layoutAttributes && (v7 = _layoutAttributes[72], _layoutAttributes, (v7 & 1) != 0))
    {
      [(UICollectionView *)self _reuseCell:neededCopy];
    }

    else
    {
      [(UICollectionView *)self _reuseSupplementaryView:neededCopy];
    }
  }
}

- (BOOL)_shouldSelectionFollowFocusForIndexPath:(id)path initiatedBySelection:(BOOL)selection focusItemStateCandidate:(id)candidate
{
  selectionCopy = selection;
  pathCopy = path;
  candidateCopy = candidate;
  if (_AXSFullKeyboardAccessEnabled())
  {
    goto LABEL_2;
  }

  if (!dyld_program_sdk_at_least() || !selectionCopy || ![(_UICollectionViewMultiSelectController *)self->_multiSelectController isInMultiselectInteraction])
  {
    goto LABEL_11;
  }

  if (candidateCopy)
  {
    _focusedItemState = candidateCopy;
  }

  else
  {
    _focusedItemState = [(UICollectionView *)self _focusedItemState];
    if (!_focusedItemState)
    {
      goto LABEL_11;
    }
  }

  _indexPathsForSelectedItems = [(UICollectionView *)self _indexPathsForSelectedItems];
  v14 = _focusedItemState[2];
  v15 = [_indexPathsForSelectedItems containsObject:v14];

  if ((v15 & 1) == 0)
  {
LABEL_11:
    if (!selectionCopy)
    {
      v16 = [(UICollectionView *)self _cellForItemAtIndexPath:pathCopy];
      _delegateProxy = v16;
      if (v16 && ([v16 _hasCustomSelectionAction] & 1) != 0)
      {
        v10 = 0;
        goto LABEL_20;
      }
    }

    v18 = !selectionCopy;
    selectionFollowsFocus = [(UICollectionView *)self selectionFollowsFocus];
    v10 = selectionFollowsFocus;
    if ((v18 & selectionFollowsFocus & (pathCopy != 0)) != 1)
    {
      goto LABEL_3;
    }

    if ((*(&self->_collectionViewFlags + 6) & 4) == 0)
    {
      v10 = 1;
      goto LABEL_3;
    }

    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v10 = [_delegateProxy collectionView:self selectionFollowsFocusForItemAtIndexPath:pathCopy];
LABEL_20:

    goto LABEL_3;
  }

LABEL_2:
  v10 = 0;
LABEL_3:

  return v10 & 1;
}

- (void)_willUpdateFocusInContext:(id)context
{
  nextFocusedItem = [context nextFocusedItem];
  v5 = _UIFocusEnvironmentFirstCommonAncestor(nextFocusedItem, self);

  if ((v5 == self) == ((*(&self->_collectionViewFlags + 1) & 0x4000000) == 0))
  {
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFBFFFFFFLL | ((v5 == self) << 26);

    [(UICollectionView *)self _updateSelectionIsKey];
  }
}

- (void)_didUpdateFocusInContext:(id)context
{
  v106 = *MEMORY[0x1E69E9840];
  contextCopy = context;
  if ([(UICollectionView *)self _isMovingFocusFromHorizontalIndexBarToCellContent:contextCopy])
  {
    [(UICollectionView *)self setSelectedIndexTitleEntry:0];
    [(UICollectionView *)self setIsMovingFocusFromHorizontalIndexTitleBarToContent:0];
    [(UICollectionView *)self setIndexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar:0];
  }

  _focusedItemState = [(UICollectionView *)self _focusedItemState];
  previouslyFocusedView = [contextCopy previouslyFocusedView];
  v8 = [(UICollectionView *)self _managedSubviewForView:previouslyFocusedView];

  if (_focusedItemState)
  {
    v9 = *(_focusedItemState + 16);
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v9 animated:0 notifyDelegate:1];
  }

  targetFocusedItemState = self->_targetFocusedItemState;
  self->_targetFocusedItemState = 0;

  nextFocusedView = [contextCopy nextFocusedView];
  v12 = nextFocusedView;
  if (nextFocusedView == self)
  {

    goto LABEL_16;
  }

  nextFocusedView2 = [contextCopy nextFocusedView];
  v14 = [nextFocusedView2 isDescendantOfView:self];

  if (!v14)
  {
LABEL_16:
    [(UICollectionView *)self _setFocusedItemState:0];
    goto LABEL_30;
  }

  nextFocusedView3 = [contextCopy nextFocusedView];
  v16 = [(UICollectionView *)self _managedSubviewForView:nextFocusedView3];

  if (v16 && v16 != self->_viewBeingPreparedForReuse)
  {
    has_internal_diagnostics = os_variant_has_internal_diagnostics();
    isHidden = [(UIView *)v16 isHidden];
    if (has_internal_diagnostics)
    {
      if (!isHidden)
      {
        [(UIView *)v16 alpha];
        if (v90 > 0.0)
        {
LABEL_12:
          _layoutAttributes = [(UICollectionReusableView *)v16 _layoutAttributes];
          v21 = _layoutAttributes;
          if (_layoutAttributes && (*(_layoutAttributes + 288) & 1) != 0)
          {
            v22 = [(UICollectionView *)self _indexPathForCell:v16];
          }

          else
          {
            v22 = [(UICollectionView *)self indexPathForSupplementaryView:v16];
          }

          indexPath = v22;
          if (!v22)
          {
            indexPath = [v21 indexPath];
          }

          v94 = a2;
          if ([(UICollectionView *)self _indexPathIsValid:indexPath allowSectionItemSentinel:1])
          {
            v24 = [_UICollectionViewFocusedItemState stateWithReusableView:v16 overrideIndexPath:indexPath];
            [(UICollectionView *)self _setFocusedItemState:v24];

            [(UICollectionView *)self _updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:indexPath];
LABEL_28:

            a2 = v94;
            goto LABEL_29;
          }

          if (os_variant_has_internal_diagnostics())
          {
            v26 = __UIFaultDebugAssertLog();
            if (os_log_type_enabled(v26, OS_LOG_TYPE_FAULT))
            {
              nextFocusedView4 = [contextCopy nextFocusedView];
              dataSourceCountsDescription = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
              *buf = 138413314;
              v97 = v16;
              v98 = 2112;
              v99 = v21;
              v100 = 2112;
              v101 = nextFocusedView4;
              v102 = 2112;
              selfCopy2 = self;
              v104 = 2112;
              v105 = dataSourceCountsDescription;
              _os_log_fault_impl(&dword_188A29000, v26, OS_LOG_TYPE_FAULT, "Attempted to move focus into a view with an invalid index path: %@; Layout attributes: %@; Focused view: %@; Collection view: %@; Data source counts: %@", buf, 0x34u);
            }
          }

          else
          {
            v25 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492620) + 8);
            if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
LABEL_27:
              [(UICollectionView *)self _setFocusedItemState:0];
              goto LABEL_28;
            }

            v26 = v25;
            nextFocusedView5 = [contextCopy nextFocusedView];
            dataSourceCountsDescription2 = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
            *buf = 138413314;
            v97 = v16;
            v98 = 2112;
            v99 = v21;
            v100 = 2112;
            v101 = nextFocusedView5;
            v102 = 2112;
            selfCopy2 = self;
            v104 = 2112;
            v105 = dataSourceCountsDescription2;
            _os_log_impl(&dword_188A29000, v26, OS_LOG_TYPE_ERROR, "Attempted to move focus into a view with an invalid index path: %@; Layout attributes: %@; Focused view: %@; Collection view: %@; Data source counts: %@", buf, 0x34u);
          }

          goto LABEL_27;
        }
      }

      v88 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v88, OS_LOG_TYPE_FAULT))
      {
LABEL_85:

        goto LABEL_12;
      }

      nextFocusedView6 = [contextCopy nextFocusedView];
      *buf = 138412546;
      v97 = v16;
      v98 = 2112;
      v99 = nextFocusedView6;
      _os_log_fault_impl(&dword_188A29000, v88, OS_LOG_TYPE_FAULT, "Attempting to move focus into a hidden view: %@; Focused view: %@", buf, 0x16u);
    }

    else
    {
      if (!isHidden)
      {
        [(UIView *)v16 alpha];
        if (v19 > 0.0)
        {
          goto LABEL_12;
        }
      }

      v87 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492618) + 8);
      if (!os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_12;
      }

      v88 = v87;
      nextFocusedView6 = [contextCopy nextFocusedView];
      *buf = 138412546;
      v97 = v16;
      v98 = 2112;
      v99 = nextFocusedView6;
      _os_log_impl(&dword_188A29000, v88, OS_LOG_TYPE_ERROR, "Attempting to move focus into a hidden view: %@; Focused view: %@", buf, 0x16u);
    }

    goto LABEL_85;
  }

  [(UICollectionView *)self _setFocusedItemState:0];
LABEL_29:

LABEL_30:
  _focusedItemState2 = [(UICollectionView *)self _focusedItemState];
  [(_UISelectionInteraction *)self->_selectionInteraction setEnabled:_focusedItemState2 != 0];

  [(UICollectionView *)self _setCurrentPromiseFulfillmentCell:0];
  v95.receiver = self;
  v95.super_class = UICollectionView;
  [(UIScrollView *)&v95 _didUpdateFocusInContext:contextCopy];
  if (_focusedItemState)
  {
    v30 = *(_focusedItemState + 8);
  }

  else
  {
    v30 = 0;
  }

  v31 = v30;
  [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v31];

  if ((dyld_program_sdk_at_least() & 1) == 0 && v8)
  {
    v32 = _focusedItemState ? *(_focusedItemState + 8) : 0;
    v33 = v32;

    if (v8 != v33)
    {
      [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v8];
    }
  }

  _endOfContentFocusContainerGuide = [(UICollectionView *)self _endOfContentFocusContainerGuide];

  if (_endOfContentFocusContainerGuide)
  {
    _focusedItemState3 = [(UICollectionView *)self _focusedItemState];
    v36 = _focusedItemState3;
    if (_focusedItemState3)
    {
      v37 = *(_focusedItemState3 + 8);
    }

    else
    {
      v37 = 0;
    }

    v38 = v37;
    _endOfContentFocusContainerGuide2 = [(UICollectionView *)self _endOfContentFocusContainerGuide];
    [_endOfContentFocusContainerGuide2 setEnabled:v38 != 0];
  }

  sectionFocusGuideController = self->_sectionFocusGuideController;
  _focusedItemState4 = [(UICollectionView *)self _focusedItemState];
  v42 = _focusedItemState4;
  if (_focusedItemState4)
  {
    v43 = *(_focusedItemState4 + 16);
  }

  else
  {
    v43 = 0;
  }

  v44 = v43;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v44];

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (_horizontalIndexTitleBar)
  {
    v46 = _horizontalIndexTitleBar;
    _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
    nextFocusedView7 = [contextCopy nextFocusedView];
    v49 = [_horizontalIndexTitleBar2 _isViewEntryCell:nextFocusedView7];

    if (v49)
    {
      if (_focusedItemState)
      {
        v50 = *(_focusedItemState + 16);
      }

      else
      {
        v50 = 0;
      }

      v51 = v50;
      [(UICollectionView *)self setIndexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar:v51];
    }
  }

  if ((*(&self->_collectionViewFlags + 3) & 0x10) != 0)
  {
    if (_focusedItemState)
    {
      v52 = *(_focusedItemState + 8);
    }

    else
    {
      v52 = 0;
    }

    v53 = v52;
    previouslyFocusedView2 = [contextCopy previouslyFocusedView];
    v55 = [(UICollectionView *)self _managedSubviewForView:previouslyFocusedView2];

    if (v53 == v55)
    {
      if (_focusedItemState)
      {
        v57 = *(_focusedItemState + 16);
      }

      else
      {
        v57 = 0;
      }

      v56 = v57;
    }

    else
    {
      v56 = 0;
    }

    v58 = [_UIFocusAnimationCoordinatorManager animationCoordinatorForContext:contextCopy];
    if (!v58)
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:16546 description:@"Received call to _didUpdateFocusInContext: outside of a focus update."];
    }

    v59 = [UICollectionViewFocusUpdateContext _contextWithContext:contextCopy collectionView:self cachedPreviouslyFocusedIndexPath:v56];
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self didUpdateFocusInContext:v59 withAnimationCoordinator:v58];
  }

  if ((*(&self->_collectionViewFlags + 18) & 0x10) == 0)
  {
    _focusedItemState5 = [(UICollectionView *)self _focusedItemState];
    if (_focusedItemState5)
    {
      v62 = _focusedItemState5;
      _focusedItemState6 = [(UICollectionView *)self _focusedItemState];
      v64 = _focusedItemState6;
      if (_focusedItemState6 && *(_focusedItemState6 + 32))
      {
LABEL_64:

        goto LABEL_81;
      }

      _focusedItemState7 = [(UICollectionView *)self _focusedItemState];
      v66 = _focusedItemState7;
      if (_focusedItemState7)
      {
        v67 = *(_focusedItemState7 + 8);
      }

      else
      {
        v67 = 0;
      }

      v68 = v67;
      nextFocusedItem = [contextCopy nextFocusedItem];

      if (v68 == nextFocusedItem)
      {
        if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && ([contextCopy _focusMovement], (v70 = objc_claimAutoreleasedReturnValue()) != 0) && (v71 = v70, v72 = -[UICollectionView _delegateSupportsPrimaryAction](self, "_delegateSupportsPrimaryAction"), v71, v72) || ((-[UICollectionView indexPathsForSelectedItems](self, "indexPathsForSelectedItems"), v73 = objc_claimAutoreleasedReturnValue(), -[UICollectionView _focusedItemState](self, "_focusedItemState"), v74 = objc_claimAutoreleasedReturnValue(), (v75 = v74) == 0) ? (v76 = 0) : (v76 = *(v74 + 16)), v77 = v76, v78 = objc_msgSend(v73, "containsObject:", v77), v77, v75, v73, (v78 & 1) == 0))
        {
          _focusedItemState8 = [(UICollectionView *)self _focusedItemState];
          v80 = _focusedItemState8;
          v81 = _focusedItemState8 ? *(_focusedItemState8 + 16) : 0;
          v82 = v81;
          v83 = [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:v82 initiatedBySelection:0];

          if (v83)
          {
            _focusedItemState9 = [(UICollectionView *)self _focusedItemState];
            v62 = _focusedItemState9;
            if (_focusedItemState9)
            {
              v85 = *(_focusedItemState9 + 16);
            }

            else
            {
              v85 = 0;
            }

            v64 = v85;
            LOWORD(v93) = 0;
            [(UICollectionView *)self _selectItemAtIndexPath:v64 animated:0 scrollPosition:0 notifyDelegate:1 deselectPrevious:1 performPrimaryAction:0 performCustomSelectionAction:v93 isUserInitiated:?];
            goto LABEL_64;
          }
        }
      }
    }
  }

LABEL_81:
}

- (id)_systemDefaultFocusGroupIdentifier
{
  _focusBehavior = [(UIView *)self _focusBehavior];
  focusGroupContainmentBehavior = [_focusBehavior focusGroupContainmentBehavior];

  if ((focusGroupContainmentBehavior & 0x40) != 0)
  {
    v6 = _UIFocusGroupIdentifierOfAssociatedSearchTextFieldForView(self);
    v7 = v6;
    if (v6)
    {
      _systemDefaultFocusGroupIdentifier = v6;
    }

    else
    {
      v11.receiver = self;
      v11.super_class = UICollectionView;
      _systemDefaultFocusGroupIdentifier = [(UIView *)&v11 _systemDefaultFocusGroupIdentifier];
    }

    _systemDefaultFocusGroupIdentifier2 = _systemDefaultFocusGroupIdentifier;
  }

  else
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    _systemDefaultFocusGroupIdentifier2 = [(UIView *)&v10 _systemDefaultFocusGroupIdentifier];
  }

  return _systemDefaultFocusGroupIdentifier2;
}

- (void)_updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:(id)path
{
  pathCopy = path;
  _horizontalIndexTitleBar = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (pathCopy && _horizontalIndexTitleBar)
  {
    v5 = *(&self->_collectionViewFlags + 1);
    _horizontalIndexTitleBar2 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v7 = _horizontalIndexTitleBar2;
    if ((v5 & 4) == 0)
    {
      [_horizontalIndexTitleBar2 _selectEntryForTitleIndex:{objc_msgSend(pathCopy, "section")}];
      entries = v7;
LABEL_35:

      goto LABEL_36;
    }

    entries = [_horizontalIndexTitleBar2 entries];

    _horizontalIndexTitleBar3 = [(UICollectionView *)self _horizontalIndexTitleBar];
    selectedEntry = [_horizontalIndexTitleBar3 selectedEntry];

    if (selectedEntry)
    {
      if ([entries count] == 1)
      {
LABEL_34:

        goto LABEL_35;
      }

      targetFocusedIndexPath = [selectedEntry targetFocusedIndexPath];
      v12 = [pathCopy compare:targetFocusedIndexPath];
      switch(v12)
      {
        case 1:
          v13 = [entries indexOfObject:selectedEntry];
          if (v13 < [entries count])
          {
            while (1)
            {
              v14 = [entries objectAtIndexedSubscript:v13];
              if (v13 == [entries count] - 1)
              {
                goto LABEL_31;
              }

              v17 = v13 + 1;
              _horizontalIndexTitleBar5 = [entries objectAtIndexedSubscript:v13 + 1];
              targetFocusedIndexPath2 = [_horizontalIndexTitleBar5 targetFocusedIndexPath];
              v20 = [pathCopy compare:targetFocusedIndexPath2];

              if (v20 == -1)
              {
                _horizontalIndexTitleBar4 = [(UICollectionView *)self _horizontalIndexTitleBar];
                [_horizontalIndexTitleBar4 _selectEntryForTitleIndex:v13];

                goto LABEL_32;
              }

              ++v13;
              if (v17 >= [entries count])
              {
                goto LABEL_18;
              }
            }
          }

          break;
        case 0:
LABEL_33:

          goto LABEL_34;
        case -1:
          v13 = [entries indexOfObject:selectedEntry] - 1;
          if (v13 >= 0)
          {
            while (1)
            {
              v14 = [entries objectAtIndexedSubscript:v13];
              targetFocusedIndexPath3 = [v14 targetFocusedIndexPath];
              v16 = [pathCopy compare:targetFocusedIndexPath3];

              if (!v13 || v16 == 1)
              {
                break;
              }

              --v13;
            }

LABEL_31:
            _horizontalIndexTitleBar5 = [(UICollectionView *)self _horizontalIndexTitleBar];
            [_horizontalIndexTitleBar5 _selectEntryForTitleIndex:v13];
LABEL_32:

            goto LABEL_33;
          }

          break;
      }

LABEL_18:
    }

    if ([entries count])
    {
      v21 = 0;
      while (1)
      {
        v22 = [entries objectAtIndexedSubscript:v21];
        targetFocusedIndexPath4 = [v22 targetFocusedIndexPath];
        v24 = [pathCopy compare:targetFocusedIndexPath4];

        if (!v24 || v21 == [entries count] - 1 && v24 == 1)
        {
          _horizontalIndexTitleBar6 = [(UICollectionView *)self _horizontalIndexTitleBar];
          v26 = _horizontalIndexTitleBar6;
          v27 = v21;
          goto LABEL_30;
        }

        if (v21 && v24 == -1)
        {
          break;
        }

        if (++v21 >= [entries count])
        {
          goto LABEL_34;
        }
      }

      _horizontalIndexTitleBar6 = [(UICollectionView *)self _horizontalIndexTitleBar];
      v26 = _horizontalIndexTitleBar6;
      v27 = v21 - 1;
LABEL_30:
      [_horizontalIndexTitleBar6 _selectEntryForTitleIndex:v27];
    }

    goto LABEL_34;
  }

LABEL_36:
}

- (void)_setKeepsFirstResponderVisibleOnBoundsChange:(BOOL)change
{
  v3 = 0x800000000000;
  if (!change)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFF7FFFFFFFFFFFLL | v3;
}

- (void)_adjustForAutomaticKeyboardInfo:(id)info animated:(BOOL)animated lastAdjustment:(double *)adjustment
{
  animatedCopy = animated;
  infoCopy = info;
  if ([(UIScrollView *)self _isFirstResponderKeyboardAvoidanceEnabled])
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIScrollView *)&v9 _adjustForAutomaticKeyboardInfo:infoCopy animated:animatedCopy lastAdjustment:adjustment];
    if (*adjustment != 0.0)
    {
      [(UICollectionView *)self _scrollFirstResponderCellToVisible:1, *adjustment];
    }
  }
}

- (void)_scrollFirstResponderCellToVisible:(BOOL)visible
{
  subviewManager = self->_subviewManager;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __55__UICollectionView__scrollFirstResponderCellToVisible___block_invoke;
  v4[3] = &unk_1E70FF9A0;
  v4[4] = self;
  visibleCopy = visible;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v4];
  }
}

void __55__UICollectionView__scrollFirstResponderCellToVisible___block_invoke(uint64_t a1, void *a2, void *a3, _BYTE *a4)
{
  v7 = a2;
  if ([a3 _isAncestorOfFirstResponder] && objc_msgSend(*(a1 + 32), "_indexPathIsValid:", v7))
  {
    [*(a1 + 32) _scrollToItemAtPresentationIndexPath:v7 atScrollPosition:0 additionalInsets:*(a1 + 40) animated:{0.0, 0.0, 0.0, 0.0}];
    *a4 = 1;
  }
}

- (BOOL)_supportsAutomaticCatalystDragAndDropReordering
{
  if (![(UICollectionView *)self _dragAndDropNeededForReordering])
  {
    return 0;
  }

  _dragDelegateActual = [(UICollectionView *)self _dragDelegateActual];
  if (_dragDelegateActual)
  {
    v4 = 0;
  }

  else
  {
    _dropDelegateActual = [(UICollectionView *)self _dropDelegateActual];
    v4 = _dropDelegateActual == 0;
  }

  return v4;
}

- (id)_indexPathOfItemNearestToPoint:(CGPoint)point intersectingRect:(CGRect)rect
{
  height = rect.size.height;
  width = rect.size.width;
  y = rect.origin.y;
  x = rect.origin.x;
  v7 = point.y;
  v8 = point.x;
  v50 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v15 = [(UICollectionViewData *)collectionViewData layoutAttributesForCellsInRect:v11 validateLayout:v12, v13, v14];
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v16 = [v15 countByEnumeratingWithState:&v45 objects:v49 count:16];
  if (!v16)
  {
    goto LABEL_14;
  }

  v17 = v16;
  v40 = y;
  v41 = width;
  v42 = height;
  v18 = 0;
  v19 = 1.79769313e308;
  v20 = *v46;
  v36 = *(MEMORY[0x1E695F058] + 24);
  v37 = *(MEMORY[0x1E695F058] + 16);
  v44.size.width = v37;
  v44.size.height = v36;
  v38 = *(MEMORY[0x1E695F058] + 8);
  v39 = *MEMORY[0x1E695F058];
  v44.origin.x = *MEMORY[0x1E695F058];
  v44.origin.y = v38;
  do
  {
    for (i = 0; i != v17; ++i)
    {
      if (*v46 != v20)
      {
        objc_enumerationMutation(v15);
      }

      v22 = *(*(&v45 + 1) + 8 * i);
      layout = self->_layout;
      [v22 frame];
      [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v22 frame:?];
      v25 = v24;
      v27 = v26;
      v29 = v28;
      v31 = v30;
      UIDistanceBetweenPointAndRect(v8, v7, v24, v26, v28, v30);
      v33 = fabs(v32);
      if (v33 < v19)
      {
        indexPath = [v22 indexPath];

        v44.size.width = v29;
        v44.size.height = v31;
        v44.origin.x = v25;
        v44.origin.y = v27;
        v19 = v33;
        v18 = indexPath;
      }
    }

    v17 = [v15 countByEnumeratingWithState:&v45 objects:v49 count:16];
  }

  while (v17);
  if (v18)
  {
    v52.origin.y = v38;
    v52.origin.x = v39;
    v52.size.height = v36;
    v52.size.width = v37;
    v54.origin.x = x;
    v54.origin.y = v40;
    v54.size.width = v41;
    v54.size.height = v42;
    if (!CGRectEqualToRect(v52, v54))
    {
      v53.origin.x = x;
      v53.origin.y = v40;
      v53.size.width = v41;
      v53.size.height = v42;
      if (!CGRectIntersectsRect(v53, v44))
      {

LABEL_14:
        v18 = 0;
      }
    }
  }

  return v18;
}

- (id)_sectionIndexesAfterShadowUpdatesForSectionIndexes:(id)indexes allowingAppendingInserts:(BOOL)inserts
{
  indexesCopy = indexes;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v11 = 0;
    v12 = &v11;
    v13 = 0x3032000000;
    v14 = __Block_byref_object_copy__39;
    v15 = __Block_byref_object_dispose__39;
    v16 = objc_alloc_init(MEMORY[0x1E696AD50]);
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __96__UICollectionView__sectionIndexesAfterShadowUpdatesForSectionIndexes_allowingAppendingInserts___block_invoke;
    v9[3] = &unk_1E70FF9C8;
    insertsCopy = inserts;
    v9[4] = self;
    v9[5] = &v11;
    [indexesCopy enumerateIndexesUsingBlock:v9];
    v7 = v12[5];
    _Block_object_dispose(&v11, 8);
  }

  else
  {
    v7 = indexesCopy;
  }

  return v7;
}

uint64_t __96__UICollectionView__sectionIndexesAfterShadowUpdatesForSectionIndexes_allowingAppendingInserts___block_invoke(uint64_t a1, uint64_t a2)
{
  result = [*(*(a1 + 32) + 2856) sectionIndexAfterShadowUpdates:a2 allowingAppendingInserts:*(a1 + 48)];
  if (result != 0x7FFFFFFFFFFFFFFFLL)
  {
    v4 = result;
    v5 = *(*(*(a1 + 40) + 8) + 40);

    return [v5 addIndex:v4];
  }

  return result;
}

- (id)_indexPathsBeforeShadowUpdatesForIndexPaths:(id)paths
{
  v18 = *MEMORY[0x1E69E9840];
  pathsCopy = paths;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(pathsCopy, "count")}];
    v13 = 0u;
    v14 = 0u;
    v15 = 0u;
    v16 = 0u;
    v6 = pathsCopy;
    v7 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
    if (v7)
    {
      v8 = v7;
      v9 = *v14;
      do
      {
        for (i = 0; i != v8; ++i)
        {
          if (*v14 != v9)
          {
            objc_enumerationMutation(v6);
          }

          v11 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:*(*(&v13 + 1) + 8 * i), v13];
          if (v11)
          {
            [v5 addObject:v11];
          }
        }

        v8 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
      }

      while (v8);
    }
  }

  else
  {
    v5 = pathsCopy;
  }

  return v5;
}

- (id)_indexPathsAfterShadowUpdatesForIndexPaths:(id)paths allowingAppendingInserts:(BOOL)inserts
{
  insertsCopy = inserts;
  v20 = *MEMORY[0x1E69E9840];
  pathsCopy = paths;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v7 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(pathsCopy, "count")}];
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v8 = pathsCopy;
    v9 = [v8 countByEnumeratingWithState:&v15 objects:v19 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v16;
      do
      {
        for (i = 0; i != v10; ++i)
        {
          if (*v16 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v13 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:*(*(&v15 + 1) + 8 * i) allowingAppendingInserts:insertsCopy, v15];
          if (v13)
          {
            [v7 addObject:v13];
          }
        }

        v10 = [v8 countByEnumeratingWithState:&v15 objects:v19 count:16];
      }

      while (v10);
    }
  }

  else
  {
    v7 = pathsCopy;
  }

  return v7;
}

- (id)_indexPathAfterShadowUpdatesForIndexPath:(id)path
{
  pathCopy = path;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:pathCopy];
  }

  else
  {
    v5 = pathCopy;
  }

  v6 = v5;

  return v6;
}

- (id)_indexPathBeforeShadowUpdatesForIndexPath:(id)path
{
  pathCopy = path;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:pathCopy];
  }

  else
  {
    v5 = pathCopy;
  }

  v6 = v5;

  return v6;
}

- (BOOL)isDragSessionActive
{
  dragAndDropController = self->_dragAndDropController;
  if (!dragAndDropController)
  {
    return 0;
  }

  if ([(_UICollectionViewDragSourceController *)&dragAndDropController->_sourceController->super.isa isActive])
  {
    return 1;
  }

  v5 = self->_dragAndDropController;
  if (!v5)
  {
    return 0;
  }

  destinationController = v5->_destinationController;

  return [(_UICollectionViewDragDestinationController *)destinationController isActive];
}

- (id)_indexPathForInsertionAtPoint:(CGPoint)point dropIntent:(int64_t)intent sourceIndexPath:(id)path indicatorLayoutAttributes:(id *)attributes
{
  y = point.y;
  x = point.x;
  pathCopy = path;
  effectiveDragDestinationVisualStyle = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController effectiveDragDestinationVisualStyle];
  v13 = effectiveDragDestinationVisualStyle;
  v14 = intent == 1 && effectiveDragDestinationVisualStyle == 2;
  v15 = v14;
  if (v14)
  {
    v16 = [(UICollectionViewLayout *)self->_layout _layoutAttributesForInsertionIndicatorAtTargetPosition:pathCopy sourceIndexPath:x, y];
    indexPath = [v16 indexPath];
    if (!pathCopy)
    {
      goto LABEL_19;
    }
  }

  else
  {
    indexPath = [(UICollectionView *)self _indexPathForItemAtPoint:x, y];
    v16 = 0;
    if (!pathCopy)
    {
      goto LABEL_19;
    }
  }

  if (v13 != 2)
  {
LABEL_19:
    v22 = indexPath;
    goto LABEL_20;
  }

  currentIndexPath = [(_UIDragDestinationIndicatorView *)self->_reorderDestinationView currentIndexPath];
  v19 = currentIndexPath;
  if (currentIndexPath)
  {
    v20 = currentIndexPath;
  }

  else
  {
    v20 = pathCopy;
  }

  v21 = v20;

  v22 = [(UICollectionView *)self _targetIndexPathForMoveOfItemFromOriginalIndexPath:pathCopy atCurrentIndexPath:v21 toProposedIndexPath:indexPath];

  if (v15 && ([v22 isEqual:indexPath] & 1) == 0)
  {
    v23 = [(UICollectionViewLayout *)self->_layout _layoutAttributesForInsertionIndicatorAtTargetIndexPath:v22];

    v16 = v23;
  }

LABEL_20:
  if (attributes && v16)
  {
    v24 = v16;
    *attributes = v16;
  }

  return v22;
}

- (void)_updateDropTargetAppearanceWithTargetIndexPath:(id)path intent:(int64_t)intent indicatorLayoutAttributes:(id)attributes
{
  pathCopy = path;
  attributesCopy = attributes;
  if (dyld_program_sdk_at_least())
  {
    v10 = 6;
  }

  else
  {
    v10 = 4;
  }

  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke;
  v13[3] = &unk_1E70F36D0;
  v13[4] = self;
  v11 = pathCopy;
  v14 = v11;
  intentCopy = intent;
  [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v10 options:v13 animations:0 completion:?];
  indexPathForOriginalReorderedItem = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController indexPathForOriginalReorderedItem];
  if (v11 && intent == 1 && attributesCopy && ([v11 isEqual:indexPathForOriginalReorderedItem] & 1) == 0)
  {
    [(UICollectionView *)self _updateReorderDestinationViewWithLayoutAttributes:attributesCopy];
  }

  else
  {
    [(UICollectionView *)self _removeReorderDestinationView];
  }
}

void __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 2984);
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke_2;
  v5[3] = &unk_1E70FF9F0;
  v3 = *(a1 + 40);
  v4 = *(a1 + 48);
  v6 = v3;
  v7 = v4;
  if (v2)
  {
    [(_UICollectionViewSubviewCollection *)*(v2 + 8) enumerateCellsWithEnumerator:v5];
    v3 = v6;
  }
}

void __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v7 = a2;
  v5 = a3;
  if (*(a1 + 32) && *(a1 + 40) == 2 && ([v7 isEqual:?] & 1) != 0)
  {
    v6 = 2;
  }

  else
  {
    v6 = 1;
  }

  [v5 _setDropState:v6];
}

- (void)_resetDropTargetAppearance
{
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:?];
  }
}

- (void)horizontalIndexBar:(id)bar selectedEntry:(id)entry
{
  barCopy = bar;
  entryCopy = entry;
  [(UICollectionView *)self setSelectedIndexTitleEntry:entryCopy];
  if ((*(&self->_collectionViewFlags + 3) & 0x20) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy _collectionView:self horizontalIndexTitleBar:barCopy selectedEntry:entryCopy];
  }

  else
  {
    traitCollection = [(UIView *)self traitCollection];
    if ([traitCollection layoutDirection] == 1)
    {
      v8 = 32;
    }

    else
    {
      v8 = 8;
    }

    _delegateProxy = [entryCopy targetFocusedIndexPath];

    [(UICollectionView *)self scrollToItemAtIndexPath:_delegateProxy atScrollPosition:v8 animated:1];
  }
}

- (id)_performShadowUpdates:(id)updates
{
  updatesCopy = updates;
  if (!updatesCopy)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17022 description:{@"Invalid parameter not satisfying: %@", @"updates != NULL"}];
  }

  shadowUpdates = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
  v7 = [shadowUpdates count];

  v8 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v8 | 0x400000000000000;
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __42__UICollectionView__performShadowUpdates___block_invoke;
  v19[3] = &unk_1E70F0F78;
  v9 = updatesCopy;
  v20 = v9;
  [(UICollectionView *)self _performInternalBatchUpdates:v19];
  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFBFFFFFFFFFFFFFFLL | (((v8 >> 58) & 1) << 58);
  v10 = MEMORY[0x1E696AD50];
  shadowUpdates2 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
  v12 = [v10 indexSetWithIndexesInRange:{0, objc_msgSend(shadowUpdates2, "count")}];

  [v12 removeIndexesInRange:{0, v7}];
  if ([v12 firstIndex] == 0x7FFFFFFFFFFFFFFFLL)
  {
    v13 = MEMORY[0x1E695E0F0];
  }

  else
  {
    firstIndex = [v12 firstIndex];
    v15 = [v12 count];
    shadowUpdates3 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
    v13 = [shadowUpdates3 subarrayWithRange:{firstIndex, v15}];
  }

  return v13;
}

- (id)_diffableIdentifierForIndexPath:(id)path
{
  pathCopy = path;
  if (pathCopy && [(UICollectionView *)self _isConnectedToDiffableDataSource])
  {
    _diffableDataSourceImpl = [(UICollectionView *)self _diffableDataSourceImpl];
    v6 = _diffableDataSourceImpl;
    if (_diffableDataSourceImpl)
    {
      v7 = [_diffableDataSourceImpl itemIdentifierForIndexPath:pathCopy];
    }

    else
    {
      v7 = 0;
    }
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)performUsingPresentationValues:(id)values
{
  ++self->_performUsingPresentationValuesRefCount;
  (*(values + 2))(values, a2);
  --self->_performUsingPresentationValuesRefCount;
}

- (id)_identityTracker:(BOOL)tracker
{
  identityTracker = self->_identityTracker;
  if (identityTracker)
  {
    v5 = 1;
  }

  else
  {
    v5 = !tracker;
  }

  if (!v5)
  {
    v6 = [[_UIIndexPathIdentityTracker alloc] initWithCollectionView:?];
    v7 = self->_identityTracker;
    self->_identityTracker = v6;

    identityTracker = self->_identityTracker;
  }

  return identityTracker;
}

- (id)_translateDataSourceIndexPathsToPresentationIndexPathsAsNeeded:(id)needed
{
  neededCopy = needed;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:neededCopy];
  }

  else
  {
    v5 = neededCopy;
  }

  v6 = v5;

  return v6;
}

- (id)_translateDataSourceIndexPathToPresentationIndexPathAsNeeded:(id)needed
{
  neededCopy = needed;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:neededCopy];
  }

  else
  {
    v5 = neededCopy;
  }

  v6 = v5;

  return v6;
}

- (id)_translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:(id)needed
{
  neededCopy = needed;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _indexPathsBeforeShadowUpdatesForIndexPaths:neededCopy];
  }

  else
  {
    v5 = neededCopy;
  }

  v6 = v5;

  return v6;
}

- (id)_translatePresentationIndexPathToDataSourceIndexPathAsNeeded:(id)needed
{
  neededCopy = needed;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:neededCopy];
  }

  else
  {
    v5 = neededCopy;
  }

  v6 = v5;

  return v6;
}

- (id)_dragDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);
  }

  return WeakRetained;
}

- (id)_dropDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);
  }

  return WeakRetained;
}

- (id)_dragDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  return WeakRetained;
}

- (id)_dropDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  return WeakRetained;
}

- (id)_dragSourceDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);
  }

  return WeakRetained;
}

- (id)_dragDestinationDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);
  }

  return WeakRetained;
}

- (id)_dragSourceDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  return WeakRetained;
}

- (id)_dragDestinationDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  return WeakRetained;
}

- (BOOL)_shouldSpringLoadItemAtIndexPath:(id)path withContext:(id)context
{
  pathCopy = path;
  contextCopy = context;
  _delegateActual = [(UICollectionView *)self _delegateActual];
  v9 = objc_opt_respondsToSelector();

  if (v9)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v11 = [_delegateProxy collectionView:self shouldSpringLoadItemAtIndexPath:pathCopy withContext:contextCopy];
  }

  else
  {
    _delegateActual2 = [(UICollectionView *)self _delegateActual];
    v13 = objc_opt_respondsToSelector();

    if ((v13 & 1) == 0)
    {
      v14 = 1;
      goto LABEL_7;
    }

    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v11 = [_delegateProxy _collectionView:self shouldSpringLoadItemAtIndexPath:pathCopy withContext:contextCopy];
  }

  v14 = v11;

LABEL_7:
  return v14;
}

- (void)_unhighlightSpringLoadedItem
{
  highlightedSpringLoadedItem = self->_highlightedSpringLoadedItem;
  if (highlightedSpringLoadedItem)
  {
    [(UICollectionView *)self _unhighlightItemAtIndexPath:highlightedSpringLoadedItem animated:0];
    v4 = self->_highlightedSpringLoadedItem;
    self->_highlightedSpringLoadedItem = 0;
  }
}

- (void)_highlightSpringLoadedItemAtIndexPath:(id)path
{
  pathCopy = path;
  if (pathCopy)
  {
    v6 = pathCopy;
    [(UICollectionView *)self _highlightItemAtIndexPath:pathCopy animated:0 scrollPosition:0];
    objc_storeStrong(&self->_highlightedSpringLoadedItem, path);
    pathCopy = v6;
  }
}

- (BOOL)_addUpdateToShadowControllerIfNeeded:(id)needed
{
  v18 = *MEMORY[0x1E69E9840];
  neededCopy = needed;
  _isPerformingShadowUpdates = [(UICollectionView *)self _isPerformingShadowUpdates];
  dragAndDropController = self->_dragAndDropController;
  if (_isPerformingShadowUpdates)
  {
    [(_UICollectionViewShadowUpdatesController *)dragAndDropController appendShadowUpdate:neededCopy];
LABEL_6:
    v8 = 1;
    goto LABEL_7;
  }

  if (![(_UICollectionViewDragAndDropController *)dragAndDropController updateWillCauseInternalInconsistency:neededCopy])
  {
    goto LABEL_6;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_addUpdateToShadowControllerIfNeeded____s_category);
  if (*CategoryCachedImpl)
  {
    v10 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = self->_dragAndDropController;
      *buf = 134218498;
      selfCopy = self;
      v14 = 2112;
      v15 = neededCopy;
      v16 = 2112;
      v17 = v11;
      _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "_addUpdateToShadowControllerIfNeeded: cv == %p; unable to add update to shadow updates controller. Update item: %@; drag and drop controller: %@", buf, 0x20u);
    }
  }

  v8 = 0;
LABEL_7:

  return v8;
}

- (void)_performUpdate:(id)update
{
  v22[1] = *MEMORY[0x1E69E9840];
  updateCopy = update;
  v6 = updateCopy;
  if (updateCopy && updateCopy[6] == 0x7FFFFFFFFFFFFFFFLL)
  {
    currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17265 description:@"Section operations are not supported for this IPI"];
  }

  _indexPath = [(UICollectionViewUpdateItem *)v6 _indexPath];
  indexPathBeforeUpdate = [v6 indexPathBeforeUpdate];
  indexPathAfterUpdate = [v6 indexPathAfterUpdate];
  if (![v6 updateAction])
  {
    if (!_indexPath)
    {
      currentHandler2 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler2 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17272 description:@"Original indexPath is nil. This is bad."];
    }

    _indexPath2 = [(UICollectionViewUpdateItem *)v6 _indexPath];
    v22[0] = _indexPath2;
    v11 = [MEMORY[0x1E695DEC8] arrayWithObjects:v22 count:1];
    selfCopy2 = self;
    v13 = v11;
    v14 = 0;
    goto LABEL_12;
  }

  if ([v6 updateAction] != 1)
  {
    if ([v6 updateAction] != 3)
    {
      currentHandler3 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler3 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17285 description:{@"%s: Unhandled update item action for update: %@", "-[UICollectionView _performUpdate:]", v6}];

      goto LABEL_13;
    }

    if (indexPathBeforeUpdate)
    {
      if (indexPathAfterUpdate)
      {
LABEL_17:
        [(UICollectionView *)self _moveItemAtIndexPath:indexPathBeforeUpdate toIndexPath:indexPathAfterUpdate];
        goto LABEL_13;
      }
    }

    else
    {
      currentHandler4 = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler4 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17280 description:@"indexPathBeforeUpdate is nil. This is bad."];

      if (indexPathAfterUpdate)
      {
        goto LABEL_17;
      }
    }

    currentHandler5 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler5 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17281 description:@"indexPathAfterUpdate is nil. This is bad."];

    goto LABEL_17;
  }

  if (!_indexPath)
  {
    currentHandler6 = [MEMORY[0x1E696AAA8] currentHandler];
    [currentHandler6 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17276 description:@"Original indexPath is nil. This is bad."];
  }

  _indexPath2 = [(UICollectionViewUpdateItem *)v6 _indexPath];
  v21 = _indexPath2;
  v11 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v21 count:1];
  selfCopy2 = self;
  v13 = v11;
  v14 = 1;
LABEL_12:
  [(UICollectionView *)selfCopy2 _updateRowsAtIndexPaths:v13 updateAction:v14];

LABEL_13:
}

- (id)_prefetchDataSourceProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);
  }

  return WeakRetained;
}

- (id)_prefetchDataSourceActual
{
  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);

  return WeakRetained;
}

- (void)_managedSubviewAdded:(id)added
{
  addedCopy = added;
  v5 = self->_layout;
  v6 = addedCopy;
  v11 = v6;
  if (v6 && v5)
  {
    effectiveUserInterfaceLayoutDirection = [v6 effectiveUserInterfaceLayoutDirection];
    if (effectiveUserInterfaceLayoutDirection == [(UICollectionViewLayout *)v5 developmentLayoutDirection])
    {
      _flipsHorizontalAxis = [v11 _flipsHorizontalAxis];
      v9 = v11;
      if (!_flipsHorizontalAxis)
      {
        goto LABEL_8;
      }

      _wantsRightToLeftHorizontalMirroringIfNeeded = 0;
    }

    else
    {
      _wantsRightToLeftHorizontalMirroringIfNeeded = [(UICollectionViewLayout *)v5 _wantsRightToLeftHorizontalMirroringIfNeeded];
      v9 = v11;
    }

    [v9 _setFlipsHorizontalAxis:_wantsRightToLeftHorizontalMirroringIfNeeded];
  }

LABEL_8:
}

- (void)_performDiffableUpdate:(id)update
{
  v11 = *MEMORY[0x1E69E9840];
  updateCopy = update;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) == 0)
  {
    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      currentHandler = [MEMORY[0x1E696AAA8] currentHandler];
      [currentHandler handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17339 description:{@"Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@", self}];
    }

    else if (os_variant_has_internal_diagnostics())
    {
      v8 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v8, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        selfCopy2 = self;
        _os_log_fault_impl(&dword_188A29000, v8, OS_LOG_TYPE_FAULT, "Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@ This will become an assert in a future version.", buf, 0xCu);
      }
    }

    else
    {
      v7 = *(__UILogGetCategoryCachedImpl("Assert", &_performDiffableUpdate____s_category) + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        selfCopy2 = self;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@ This will become an assert in a future version.", buf, 0xCu);
      }
    }
  }

  [(UICollectionView *)self _performInternalBatchUpdates:updateCopy];
}

- (void)_performInternalBatchUpdates:(id)updates
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 | 0x10;
  (*(updates + 2))(updates, a2);
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFFFFEF | (16 * ((v4 >> 4) & 1));
}

- (id)_indexPathForGlobalIndex:(int64_t)index
{
  if (index == 0x7FFFFFFFFFFFFFFFLL)
  {
    v4 = 0;
  }

  else
  {
    v4 = [(UICollectionViewData *)self->_collectionViewData validatedIndexPathForItemAtGlobalIndex:index];
  }

  return v4;
}

- (int64_t)_totalItemCount
{
  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    return 0;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  return collectionViewData->_totalItemCount;
}

- (BOOL)_indexPathIsSectionAppendingIndexPath:(id)path
{
  pathCopy = path;
  v5 = pathCopy;
  if (!pathCopy || [pathCopy length] < 2 || (v6 = objc_msgSend(v5, "section"), v6 == 0x7FFFFFFFFFFFFFFFLL) || (v7 = v6, v6 >= -[UICollectionViewData numberOfSections](self->_collectionViewData)))
  {
    v9 = 0;
  }

  else
  {
    item = [v5 item];
    v9 = item == [(UICollectionViewData *)self->_collectionViewData numberOfItemsInSection:v7];
  }

  return v9;
}

- (id)contextMenuInteraction:(id)interaction configurationForMenuAtLocation:(CGPoint)location
{
  y = location.y;
  x = location.x;
  v38[1] = *MEMORY[0x1E69E9840];
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]|| ![(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin])
  {
    v13 = 0;
    goto LABEL_38;
  }

  v7 = *&self->_collectionViewFlags & 0x80100000000;
  v8 = [(UICollectionView *)self indexPathForItemAtPoint:x, y];
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __74__UICollectionView_contextMenuInteraction_configurationForMenuAtLocation___block_invoke;
  aBlock[3] = &unk_1E70FFA38;
  aBlock[4] = self;
  *&aBlock[5] = x;
  *&aBlock[6] = y;
  v9 = _Block_copy(aBlock);
  v10 = v9;
  if (v8)
  {
    if (![(UICollectionView *)self _cellAtIndexPath:v8 containsInteractiveControlAtPoint:x, y])
    {
      if (v7)
      {
        indexPathsForSelectedItems = [(UICollectionView *)self indexPathsForSelectedItems];
        if ([indexPathsForSelectedItems containsObject:v8])
        {
          v12 = indexPathsForSelectedItems;
        }

        else
        {
          v38[0] = v8;
          v12 = [MEMORY[0x1E695DEC8] arrayWithObjects:v38 count:1];
        }

        v15 = v12;
        v17 = (v10)[2](v10, v12);
        goto LABEL_23;
      }

      if ((*(&self->_collectionViewFlags + 5) & 0x10) != 0)
      {
        indexPathsForSelectedItems2 = [(UICollectionView *)self indexPathsForSelectedItems];
        if ([indexPathsForSelectedItems2 containsObject:v8])
        {
          v15 = indexPathsForSelectedItems2;
          _delegateProxy = [(UICollectionView *)self _delegateProxy];
          v13 = [_delegateProxy _dci_collectionView:self contextMenuConfigurationForSelectedItemsAtIndexPaths:v15 point:{x, y}];

          if (v13)
          {
LABEL_24:
            if ([v15 count])
            {
              v31 = v10;
              v18 = [MEMORY[0x1E695DFA8] set];
              v32 = 0u;
              v33 = 0u;
              v34 = 0u;
              v35 = 0u;
              v30 = v15;
              v19 = v15;
              v20 = [v19 countByEnumeratingWithState:&v32 objects:v37 count:16];
              if (v20)
              {
                v21 = v20;
                v22 = *v33;
                do
                {
                  for (i = 0; i != v21; ++i)
                  {
                    if (*v33 != v22)
                    {
                      objc_enumerationMutation(v19);
                    }

                    v24 = *(*(&v32 + 1) + 8 * i);
                    if (([v24 isEqual:{v8, v30}] & 1) == 0)
                    {
                      v25 = [(UICollectionView *)self _identityTracker:1];
                      v26 = [(_UIIndexPathIdentityTracker *)v25 identifierForIndexPath:v24];
                      [v18 addObject:v26];
                    }
                  }

                  v21 = [v19 countByEnumeratingWithState:&v32 objects:v37 count:16];
                }

                while (v21);
              }

              [v13 set_internalSecondaryItemIdentifiers:v18];
              v15 = v30;
              v10 = v31;
            }

            v27 = [(UICollectionView *)self _identityTracker:1, v30];
            v28 = [(_UIIndexPathIdentityTracker *)v27 identifierForIndexPath:v8];
            [v13 set_internalIdentifier:v28];

            goto LABEL_36;
          }

          goto LABEL_20;
        }
      }

      v15 = 0;
LABEL_20:
      if ((*(&self->_collectionViewFlags + 4) & 8) == 0)
      {
        v13 = 0;
        goto LABEL_36;
      }

      indexPathsForSelectedItems = [(UICollectionView *)self _delegateProxy];
      v17 = [indexPathsForSelectedItems collectionView:self contextMenuConfigurationForItemAtIndexPath:v8 point:{x, y}];
LABEL_23:
      v13 = v17;

      if (v13)
      {
        goto LABEL_24;
      }

LABEL_36:

      goto LABEL_37;
    }

    goto LABEL_11;
  }

  if (!v7)
  {
LABEL_11:
    v13 = 0;
    goto LABEL_37;
  }

  v13 = (*(v9 + 2))(v9, MEMORY[0x1E695E0F0]);
  [v13 set_internalIdentifier:@"com.apple.UIKit.UICollectionView.backgroundMenu"];
LABEL_37:

LABEL_38:

  return v13;
}

id __74__UICollectionView_contextMenuInteraction_configurationForMenuAtLocation___block_invoke(double *a1, void *a2)
{
  v3 = *(a1 + 4);
  v4 = v3[340];
  v5 = a2;
  v6 = [v3 _delegateProxy];
  v7 = v6;
  v8 = *(a1 + 4);
  v9 = a1[5];
  v10 = a1[6];
  if ((v4 & 0x100000000) != 0)
  {
    [v6 collectionView:v8 contextMenuConfigurationForItemsAtIndexPaths:v5 point:{v9, v10}];
  }

  else
  {
    [v6 _dci_collectionView:v8 contextMenuConfigurationForItemsAtIndexPaths:v5 point:{v9, v10}];
  }
  v11 = ;

  return v11;
}

- (BOOL)_cellAtIndexPath:(id)path containsInteractiveControlAtPoint:(CGPoint)point
{
  y = point.y;
  x = point.x;
  v7 = [(UICollectionView *)self cellForItemAtIndexPath:path];
  [(UIView *)self convertPoint:v7 toView:x, y];
  v8 = [v7 hitTest:0 withEvent:?];
  objc_opt_class();
  v9 = 0;
  if (v8 && v8 != v7)
  {
    while (![v8 isUserInteractionEnabled] || (objc_opt_isKindOfClass() & 1) == 0)
    {
      superview = [v8 superview];

      v9 = 0;
      if (superview)
      {
        v8 = superview;
        if (superview != v7)
        {
          continue;
        }
      }

      goto LABEL_10;
    }

    v9 = 1;
  }

  superview = v8;
LABEL_10:

  return v9;
}

- (id)_defaultTargetedPreviewForIdentifier:(id)identifier
{
  v23 = *MEMORY[0x1E69E9840];
  identifierCopy = identifier;
  if (!identifierCopy)
  {
    v11 = 0;
    goto LABEL_15;
  }

  v5 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:identifierCopy];
  if (v5)
  {
    indexPathsForVisibleItems = [(UICollectionView *)self indexPathsForVisibleItems];
    v7 = [indexPathsForVisibleItems containsObject:v5];

    if (v7)
    {
      v8 = [(UICollectionView *)self cellForItemAtIndexPath:v5];
      v9 = v8;
      if (v8)
      {
        window = [v8 window];

        if (window)
        {
          v11 = _UITargetedPreviewForContextMenuFromCell(v9);
LABEL_13:

          goto LABEL_14;
        }

        if (os_variant_has_internal_diagnostics())
        {
          v16 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v16, OS_LOG_TYPE_FAULT))
          {
            v17 = 138412802;
            v18 = v9;
            v19 = 2112;
            v20 = v5;
            v21 = 2112;
            v22 = identifierCopy;
            _os_log_fault_impl(&dword_188A29000, v16, OS_LOG_TYPE_FAULT, "Cell (%@) at indexPath (%@) with identifier (%@) is not in a window. Was the collection view removed from its window?", &v17, 0x20u);
          }
        }

        else
        {
          v12 = *(__UILogGetCategoryCachedImpl("Assert", &_defaultTargetedPreviewForIdentifier____s_category) + 8);
          if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
          {
            v17 = 138412802;
            v18 = v9;
            v19 = 2112;
            v20 = v5;
            v21 = 2112;
            v22 = identifierCopy;
            _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "Cell (%@) at indexPath (%@) with identifier (%@) is not in a window. Was the collection view removed from its window?", &v17, 0x20u);
          }
        }
      }

      v11 = 0;
      goto LABEL_13;
    }
  }

  v11 = 0;
LABEL_14:

LABEL_15:
  v13 = +[UIColor clearColor];
  parameters = [v11 parameters];
  [parameters setBackgroundColor:v13];

  [v11 set_captureHierarchyBelowSourceView:1];

  return v11;
}

- (id)_targetedPreviewForBackgroundMenuAtPoint:(CGPoint)point
{
  v3 = [[UIPreviewTarget alloc] initWithContainer:self center:point.x, point.y];
  v4 = [UITargetedPreview alloc];
  v5 = objc_opt_new();
  v6 = objc_opt_new();
  v7 = [(UITargetedPreview *)v4 initWithView:v5 parameters:v6 target:v3];

  return v7;
}

- (id)contextMenuInteraction:(id)interaction configuration:(id)configuration highlightPreviewForItemWithIdentifier:(id)identifier
{
  interactionCopy = interaction;
  configurationCopy = configuration;
  identifierCopy = identifier;
  if ([configurationCopy _isCollectionViewBackgroundMenu])
  {
    [interactionCopy locationInView:self];
    v11 = [(UICollectionView *)self _targetedPreviewForBackgroundMenuAtPoint:?];
    goto LABEL_14;
  }

  v12 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:identifierCopy];
  if (v12)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x200000000) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v15 = [_delegateProxy collectionView:self contextMenuConfiguration:configurationCopy highlightPreviewForItemAtIndexPath:v12];
    }

    else if ((collectionViewFlags & 0x200000000000) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v15 = [_delegateProxy _dci_collectionView:self contextMenuConfiguration:configurationCopy previewForHighlightingItemAtIndexPath:v12];
    }

    else
    {
      if ((collectionViewFlags & 0x1000000000) == 0)
      {
LABEL_12:
        v11 = [(UICollectionView *)self _defaultTargetedPreviewForIdentifier:identifierCopy];
        goto LABEL_13;
      }

      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v15 = [_delegateProxy collectionView:self previewForHighlightingContextMenuWithConfiguration:configurationCopy];
    }

    v11 = v15;

    if (!v11)
    {
      goto LABEL_12;
    }
  }

  else
  {
    v11 = 0;
  }

LABEL_13:

LABEL_14:

  return v11;
}

- (id)contextMenuInteraction:(id)interaction configuration:(id)configuration dismissalPreviewForItemWithIdentifier:(id)identifier
{
  interactionCopy = interaction;
  configurationCopy = configuration;
  identifierCopy = identifier;
  if ([configurationCopy _isCollectionViewBackgroundMenu])
  {
    [interactionCopy locationInView:self];
    v11 = [(UICollectionView *)self _targetedPreviewForBackgroundMenuAtPoint:?];
    goto LABEL_15;
  }

  v12 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:identifierCopy];
  if (!v12 || (-[UICollectionView indexPathsForVisibleItems](self, "indexPathsForVisibleItems"), v13 = objc_claimAutoreleasedReturnValue(), v14 = [v13 containsObject:v12], v13, !v14))
  {
LABEL_13:
    v11 = 0;
    goto LABEL_14;
  }

  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x400000000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v17 = [_delegateProxy collectionView:self contextMenuConfiguration:configurationCopy dismissalPreviewForItemAtIndexPath:v12];
  }

  else if ((collectionViewFlags & 0x400000000000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v17 = [_delegateProxy _dci_collectionView:self contextMenuConfiguration:configurationCopy previewForDismissingToItemAtIndexPath:v12];
  }

  else
  {
    if ((collectionViewFlags & 0x2000000000) == 0)
    {
      goto LABEL_12;
    }

    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v17 = [_delegateProxy collectionView:self previewForDismissingContextMenuWithConfiguration:configurationCopy];
  }

  v11 = v17;

  if (!v11)
  {
LABEL_12:
    if (![(UICollectionView *)self _isReordering])
    {
      v11 = [(UICollectionView *)self _defaultTargetedPreviewForIdentifier:identifierCopy];
      goto LABEL_14;
    }

    goto LABEL_13;
  }

LABEL_14:

LABEL_15:

  return v11;
}

- (void)contextMenuInteraction:(id)interaction willPerformPreviewActionForMenuWithConfiguration:(id)configuration animator:(id)animator
{
  if ((*(&self->_collectionViewFlags + 4) & 0x40) != 0)
  {
    animatorCopy = animator;
    configurationCopy = configuration;
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self willPerformPreviewActionForMenuWithConfiguration:configurationCopy animator:animatorCopy];
  }
}

- (void)contextMenuInteraction:(id)interaction willDisplayMenuForConfiguration:(id)configuration animator:(id)animator
{
  v34 = *MEMORY[0x1E69E9840];
  interactionCopy = interaction;
  configurationCopy = configuration;
  animatorCopy = animator;
  if ((*(&self->_collectionViewFlags + 4) & 0x80) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self willDisplayContextMenuWithConfiguration:configurationCopy animator:animatorCopy];
  }

  _internalSecondaryItemIdentifiers = [configurationCopy _internalSecondaryItemIdentifiers];
  v13 = [_internalSecondaryItemIdentifiers count];

  if (v13)
  {
    v26 = interactionCopy;
    v14 = objc_opt_new();
    _internalIdentifier = [configurationCopy _internalIdentifier];
    v16 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:_internalIdentifier];

    if (v16)
    {
      [v14 addObject:v16];
    }

    v31 = 0u;
    v32 = 0u;
    v29 = 0u;
    v30 = 0u;
    _internalSecondaryItemIdentifiers2 = [configurationCopy _internalSecondaryItemIdentifiers];
    v18 = [_internalSecondaryItemIdentifiers2 countByEnumeratingWithState:&v29 objects:v33 count:16];
    if (v18)
    {
      v19 = v18;
      v20 = *v30;
      do
      {
        for (i = 0; i != v19; ++i)
        {
          if (*v30 != v20)
          {
            objc_enumerationMutation(_internalSecondaryItemIdentifiers2);
          }

          v22 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:*(*(&v29 + 1) + 8 * i)];
          if (v22)
          {
            [v14 addObject:v22];
          }
        }

        v19 = [_internalSecondaryItemIdentifiers2 countByEnumeratingWithState:&v29 objects:v33 count:16];
      }

      while (v19);
    }

    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __84__UICollectionView_contextMenuInteraction_willDisplayMenuForConfiguration_animator___block_invoke;
    aBlock[3] = &unk_1E70F35B8;
    aBlock[4] = self;
    v28 = v14;
    v23 = v14;
    v24 = _Block_copy(aBlock);
    v25 = v24;
    if (animatorCopy)
    {
      [animatorCopy addAnimations:v24];
    }

    else
    {
      (*(v24 + 2))(v24);
    }

    interactionCopy = v26;
  }
}

void __84__UICollectionView_contextMenuInteraction_willDisplayMenuForConfiguration_animator___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusSystem];
  [v2 setNeedsFocusUpdate];
  [v2 updateFocusIfNeeded];
  [*(a1 + 32) _updateContextMenuStateForVisibleCells:*(a1 + 40)];
}

- (void)contextMenuInteraction:(id)interaction willEndForConfiguration:(id)configuration animator:(id)animator
{
  configurationCopy = configuration;
  animatorCopy = animator;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __76__UICollectionView_contextMenuInteraction_willEndForConfiguration_animator___block_invoke;
  aBlock[3] = &unk_1E70F3590;
  aBlock[4] = self;
  v9 = _Block_copy(aBlock);
  v10 = v9;
  if (animatorCopy)
  {
    [animatorCopy addAnimations:v9];
  }

  else
  {
    (*(v9 + 2))(v9);
  }

  if (*(&self->_collectionViewFlags + 5))
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    [_delegateProxy collectionView:self willEndContextMenuInteractionWithConfiguration:configurationCopy animator:animatorCopy];
  }
}

void __76__UICollectionView_contextMenuInteraction_willEndForConfiguration_animator___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusSystem];
  [v2 setNeedsFocusUpdate];
  [v2 updateFocusIfNeeded];
  [*(a1 + 32) _updateContextMenuStateForVisibleCells:0];
}

- (void)_updateContextMenuStateForVisibleCells:(id)cells
{
  v29 = *MEMORY[0x1E69E9840];
  cellsCopy = cells;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke;
  aBlock[3] = &unk_1E70FFA60;
  aBlock[4] = self;
  v5 = _Block_copy(aBlock);
  if ([cellsCopy count])
  {
    v6 = objc_opt_new();
    v21 = 0u;
    v22 = 0u;
    v23 = 0u;
    v24 = 0u;
    v7 = cellsCopy;
    v8 = [v7 countByEnumeratingWithState:&v21 objects:v28 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v22;
      do
      {
        v11 = 0;
        do
        {
          if (*v22 != v10)
          {
            objc_enumerationMutation(v7);
          }

          [v6 addIndex:{-[UICollectionViewData globalIndexForItemAtIndexPath:](self->_collectionViewData, *(*(&v21 + 1) + 8 * v11++))}];
        }

        while (v9 != v11);
        v9 = [v7 countByEnumeratingWithState:&v21 objects:v28 count:16];
      }

      while (v9);
    }

    subviewManager = self->_subviewManager;
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_3;
    v18[3] = &unk_1E70FFA88;
    v18[4] = self;
    v19 = v6;
    v20 = v5;
    v13 = v5;
    v14 = v6;
    v15 = v13;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v18];
      v15 = v20;
    }
  }

  else
  {
    v16 = self->_subviewManager;
    v25[0] = MEMORY[0x1E69E9820];
    v25[1] = 3221225472;
    v25[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_2;
    v25[3] = &unk_1E70FFC48;
    v26 = v5;
    v17 = v5;
    v14 = v17;
    if (v16)
    {
      [(_UICollectionViewSubviewCollection *)v16->_visibleViews enumerateCellsWithEnumerator:v25];
      v13 = v26;
    }

    else
    {
      v13 = v17;
    }
  }
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v8 = a2;
  v5 = a3;
  if (_UICollectionViewCellContextMenuSuppressesSelectionState())
  {
    v6 = *(*(a1 + 32) + 2976);
    if (v6)
    {
      v7 = [*(v6 + 8) containsObject:v8];
    }

    else
    {
      v7 = 0;
    }

    [v5 _setSelected:v7 animated:0];
  }
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v5 = a3;
  v6 = a2;
  [v5 _setContextMenuGroupLocation:0];
  (*(*(a1 + 32) + 16))();
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_3(uint64_t a1, void *a2, void *a3)
{
  v23 = a3;
  v5 = *(*(a1 + 32) + 2272);
  v6 = a2;
  v7 = [(UICollectionViewData *)v5 globalIndexForItemAtIndexPath:v6];
  if ([*(a1 + 40) containsIndex:v7])
  {
    v8 = [v23 _layoutAttributes];
    v9 = [(UICollectionViewLayoutAttributes *)v8 _existingListAttributes];

    if (v9)
    {
      if (v7 >= 1 && [*(a1 + 40) containsIndex:v7 - 1])
      {
        v10 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:?];
        v11 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v10];
        v12 = [(UICollectionViewLayoutAttributes *)v11 _existingListAttributes];
        if (v12)
        {
          [v11 frame];
          MaxY = CGRectGetMaxY(v25);
          [v8 frame];
          v14 = MaxY - CGRectGetMinY(v26) + 0.0001 >= 0.0;
        }

        else
        {
          v14 = 0;
        }
      }

      else
      {
        v14 = 0;
      }

      if ([*(a1 + 40) containsIndex:v7 + 1])
      {
        v16 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:?];
        v17 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v16];
        v18 = [(UICollectionViewLayoutAttributes *)v17 _existingListAttributes];
        if (v18)
        {
          [v8 frame];
          v19 = CGRectGetMaxY(v27);
          [v17 frame];
          v20 = v19 - CGRectGetMinY(v28) + 0.0001 >= 0.0;
        }

        else
        {
          v20 = 0;
        }

        v22 = 3;
        if (v20 && v14)
        {
          v22 = 1;
        }

        v21 = 4;
        if (v20)
        {
          v21 = 2;
        }
      }

      else
      {
        v21 = 4;
        v22 = 3;
      }

      if (v14)
      {
        v15 = v22;
      }

      else
      {
        v15 = v21;
      }
    }

    else
    {
      v15 = 4;
    }

    [v23 _setContextMenuGroupLocation:v15];
  }

  else
  {
    [v23 _setContextMenuGroupLocation:0];
  }

  (*(*(a1 + 48) + 16))();
}

- (id)_contextMenuInteraction:(id)interaction styleForMenuWithConfiguration:(id)configuration
{
  collectionViewFlags = self->_collectionViewFlags;
  configurationCopy = configuration;
  v7 = configurationCopy;
  if ((collectionViewFlags & 0x20000000000) != 0)
  {
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v9 = [_delegateProxy _collectionView:self styleForContextMenuWithConfiguration:v7];
  }

  else
  {
    _isCollectionViewBackgroundMenu = [configurationCopy _isCollectionViewBackgroundMenu];

    if (_isCollectionViewBackgroundMenu)
    {
      v9 = +[_UIContextMenuStyle defaultStyle];
      [v9 setPreferredLayout:3];
    }

    else
    {
      v9 = 0;
    }
  }

  return v9;
}

- (id)_contextMenuInteraction:(id)interaction accessoriesForMenuWithConfiguration:(id)configuration
{
  if ((*(&self->_collectionViewFlags + 5) & 4) != 0)
  {
    configurationCopy = configuration;
    _delegateProxy = [(UICollectionView *)self _delegateProxy];
    v10 = 0;
    memset(v9, 0, sizeof(v9));
    v4 = [_delegateProxy _collectionView:self accessoriesForContextMenuWithConfiguration:configurationCopy layoutAnchor:v9];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (id)_existingIndexPathForIdentityTrackerIdentifier:(id)identifier
{
  identifierCopy = identifier;
  v5 = [(UICollectionView *)self _identityTracker:0];
  v6 = [(_UIIndexPathIdentityTracker *)v5 currentIndexPathForIdentifier:identifierCopy];

  return v6;
}

- (_NSRange)_globalIndexRangeOfVisibleItems
{
  v32 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v9 = [(UICollectionViewData *)collectionViewData layoutAttributesForCellsInRect:v5 validateLayout:v6, v7, v8];
  _collectionViewData = [(UICollectionView *)self _collectionViewData];
  v11 = _collectionViewData;
  if (_collectionViewData)
  {
    if ((*(_collectionViewData + 96) & 2) == 0)
    {
      [(UICollectionViewData *)_collectionViewData _updateItemCounts];
    }

    v12 = v11[21];
  }

  else
  {
    v12 = 0;
  }

  v29 = 0u;
  v30 = 0u;
  v27 = 0u;
  v28 = 0u;
  v13 = v9;
  v14 = [v13 countByEnumeratingWithState:&v27 objects:v31 count:16];
  if (v14)
  {
    v15 = v14;
    v26 = a2;
    v16 = 0;
    v17 = *v28;
    v18 = 0x1E696A000uLL;
    do
    {
      v19 = 0;
      do
      {
        if (*v28 != v17)
        {
          objc_enumerationMutation(v13);
        }

        indexPath = [*(*(&v27 + 1) + 8 * v19) indexPath];
        v21 = [(UICollectionView *)self _globalIndexPathForItemAtIndexPath:indexPath];
        if (v21 == 0x7FFFFFFFFFFFFFFFLL)
        {
          currentHandler = [*(v18 + 2728) currentHandler];
          [currentHandler handleFailureInMethod:v26 object:self file:@"UICollectionView.m" lineNumber:17944 description:@"Should always have a global index for an index path retrieved from layout attributes that came from _collectionViewData"];

          v18 = 0x1E696A000;
        }

        else
        {
          if (v12 >= v21)
          {
            v12 = v21;
          }

          ++v16;
        }

        ++v19;
      }

      while (v15 != v19);
      v23 = [v13 countByEnumeratingWithState:&v27 objects:v31 count:16];
      v15 = v23;
    }

    while (v23);
  }

  else
  {
    v16 = 0;
  }

  v24 = v12;
  v25 = v16;
  result.length = v25;
  result.location = v24;
  return result;
}

- (void)_beginTypeSelectWithInput:(id)input
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    if (typeSelectController->_enabled)
    {
      [(_UITypeSelectInteraction *)&typeSelectController->_typeSelectInteraction->super.isa _beginTypeSelectWithInput:input];
    }
  }
}

- (BOOL)_typeSelectShouldAvoidBecomingFirstResponder
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectController = typeSelectController->_typeSelectInteraction;
    if (typeSelectController)
    {
      LOBYTE(typeSelectController) = BYTE6(typeSelectController[1]._typeSelectInteraction);
    }
  }

  return typeSelectController & 1;
}

- (void)_setTypeSelectShouldAvoidBecomingFirstResponder:(BOOL)responder
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectInteraction = typeSelectController->_typeSelectInteraction;
    if (typeSelectInteraction)
    {
      typeSelectInteraction->_shouldAvoidBecomingFirstResponder = responder;
    }
  }
}

id __64__UICollectionView__configureSceneActivationInteractionIfNeeded__block_invoke(uint64_t a1, double a2, double a3)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v6 = [WeakRetained _sceneActivationConfigurationForLocation:{a2, a3}];

  return v6;
}

- (id)_sceneActivationConfigurationForLocation:(CGPoint)location
{
  y = location.y;
  x = location.x;
  if (![(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin])
  {
    v9 = 0;
    goto LABEL_17;
  }

  v6 = [(UICollectionView *)self indexPathForItemAtPoint:x, y];
  if (v6)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x800000000000) != 0)
    {
      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v11 = [_delegateProxy collectionView:self sceneActivationConfigurationForItemAtIndexPath:v6 point:{x, y}];
    }

    else
    {
      if ((collectionViewFlags & 0x1000000000000) == 0)
      {
        v8 = 0;
        goto LABEL_14;
      }

      _delegateProxy = [(UICollectionView *)self _delegateProxy];
      v11 = [_delegateProxy _collectionView:self sceneActivationConfigurationForItemAtIndexPath:v6 point:{x, y}];
    }

    v8 = v11;

    if (v8)
    {
      preview = [v8 preview];

      if (!preview)
      {
        v13 = [(UICollectionView *)self cellForItemAtIndexPath:v6];
        window = [v13 window];

        if (!window)
        {

          v9 = 0;
          goto LABEL_15;
        }

        v15 = _UITargetedPreviewForContextMenuFromCell(v13);
        [v8 setPreview:v15];
      }
    }

LABEL_14:
    v8 = v8;
    v9 = v8;
LABEL_15:

    goto LABEL_16;
  }

  v9 = 0;
LABEL_16:

LABEL_17:

  return v9;
}

- (id)valueForUndefinedKey:(id)key
{
  keyCopy = key;
  if ([keyCopy isEqualToString:@"_cellReuseQueues"])
  {
    UIKVCAccessProhibited(keyCopy, @"UICollectionView");

    v5 = MEMORY[0x1E695E0F8];
  }

  else
  {
    v7.receiver = self;
    v7.super_class = UICollectionView;
    v5 = [(UICollectionView *)&v7 valueForUndefinedKey:keyCopy];
  }

  return v5;
}

- (UIEdgeInsets)_defaultLayoutMargins
{
  top = self->_defaultLayoutMargins.top;
  left = self->_defaultLayoutMargins.left;
  bottom = self->_defaultLayoutMargins.bottom;
  right = self->_defaultLayoutMargins.right;
  result.right = right;
  result.bottom = bottom;
  result.left = left;
  result.top = top;
  return result;
}

- (id)_visibleCellForIndexPath:(id)path
{
  _subviewManager = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];

  return [(_UICollectionViewSubviewManager *)_subviewManager visibleCellAtIndexPath:path];
}

- (id)_visibleViewForLayoutAttributes:(id)attributes
{
  if (attributes)
  {
    v4 = *(attributes + 72);
    v5 = 1;
    if ((v4 & 2) != 0)
    {
      v5 = 2;
    }

    if (v4)
    {
      v6 = 0;
    }

    else
    {
      v6 = v5;
    }

    _subviewManager = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];
    v8 = *(attributes + 1);
  }

  else
  {
    _subviewManager = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];
    v6 = 0;
    v8 = 0;
  }

  __indexPath = [(UICollectionViewLayoutAttributes *)attributes __indexPath];

  return [(_UICollectionViewSubviewManager *)_subviewManager visibleViewOfKind:v8 inCategory:v6 atIndexPath:__indexPath];
}

@end