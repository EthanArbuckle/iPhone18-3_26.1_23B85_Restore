@interface UICollectionView
+ (id)_reuseKeyForSupplementaryViewOfKind:(id)a3 withReuseIdentifier:(id)a4;
- (BOOL)_addGlassGroupView:(id)a3 material:(id)a4;
- (BOOL)_addUpdateToShadowControllerIfNeeded:(id)a3;
- (BOOL)_allowsEffectiveFocus;
- (BOOL)_allowsEffectiveMultipleSelection;
- (BOOL)_allowsEffectiveSelection;
- (BOOL)_allowsEffectiveSelectionOrCustomActionAtIndexPath:(id)a3;
- (BOOL)_beginReorderingItemAtIndexPath:(id)a3 isLegacyMovement:(BOOL)a4;
- (BOOL)_canBeginReorderingItem;
- (BOOL)_canEditItemAtIndexPath:(id)a3;
- (BOOL)_canPerformAction:(SEL)a3 forCell:(id)a4 sender:(id)a5;
- (BOOL)_canPerformPrimaryActionForItemAtIndexPath:(id)a3;
- (BOOL)_canReorderItemAtIndexPath:(id)a3;
- (BOOL)_canReusePreviouslyFocusedManagedSubview:(id)a3;
- (BOOL)_cellAtIndexPath:(id)a3 containsInteractiveControlAtPoint:(CGPoint)a4;
- (BOOL)_cellCanBecomeFocused:(id)a3;
- (BOOL)_checkForPreferredAttributesInView:(id)a3 originalAttributes:(id)a4;
- (BOOL)_containsFocusedItem;
- (BOOL)_dataSourceImplementsReorderingHandlers;
- (BOOL)_defaultAllowsFocus;
- (BOOL)_defaultAllowsFocusDuringEditing;
- (BOOL)_delegateAllowsHighlightingItemAtIndexPath:(id)a3;
- (BOOL)_delegateAllowsSelectingItemAtIndexPath:(id)a3;
- (BOOL)_dragAndDropNeededForReordering;
- (BOOL)_effectiveDefaultAllowsFocus;
- (BOOL)_hasContentForBarInteractions;
- (BOOL)_hasCustomBackground;
- (BOOL)_hasFocusedCellForIndexPath:(id)a3 shouldUsePreUpdateData:(BOOL)a4;
- (BOOL)_highlightItemAtIndexPath:(id)a3 animated:(BOOL)a4 scrollPosition:(unint64_t)a5 notifyDelegate:(BOOL)a6 playFeedback:(BOOL)a7;
- (BOOL)_indexPathIsSectionAppendingIndexPath:(id)a3;
- (BOOL)_indexPathIsValid:(id)a3 allowSectionItemSentinel:(BOOL)a4;
- (BOOL)_inferFocusabilityForCell:(id)a3 atIndexPath:(id)a4;
- (BOOL)_isCellInvolvedInDragOrDropAnimationAtIndexPath:(id)a3;
- (BOOL)_isFirstResponderInDeletedSectionOrItem;
- (BOOL)_isFocusedViewInDeletedSectionOrItem;
- (BOOL)_isIndexPathSelectedItem:(id)a3;
- (BOOL)_isMovingFocusFromHorizontalIndexBarToCellContent:(id)a3;
- (BOOL)_isReordering;
- (BOOL)_isReorderingItemAtIndexPath:(id)a3 includingDragAndDrop:(BOOL)a4;
- (BOOL)_isSectionValidInIndexPath:(id)a3;
- (BOOL)_prefetchingAllowed;
- (BOOL)_recomputePreferredAttributesForInvalidatedView:(id)a3 originalAttributes:(id)a4;
- (BOOL)_reuseCell:(id)a3 notifyDidEndDisplaying:(BOOL)a4;
- (BOOL)_reuseSupplementaryView:(id)a3;
- (BOOL)_reviseNewContentOffsetForUpdate:(id)a3;
- (BOOL)_selectionInteractionShouldBegin:(id)a3;
- (BOOL)_shouldBecomeFocusedOnSelection;
- (BOOL)_shouldFadeCellsForBoundChangeWhileRotating;
- (BOOL)_shouldSelectionFollowFocusForIndexPath:(id)a3 initiatedBySelection:(BOOL)a4 focusItemStateCandidate:(id)a5;
- (BOOL)_shouldShowMenuForCell:(id)a3;
- (BOOL)_shouldSpringLoadItemAtIndexPath:(id)a3 withContext:(id)a4;
- (BOOL)_shouldUpdateFocusInContext:(id)a3;
- (BOOL)_supportsAutomaticCatalystDragAndDropReordering;
- (BOOL)_typeSelectShouldAvoidBecomingFirstResponder;
- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdate:(id)a3 rect:(CGRect)a4;
- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdateWithRect:(CGRect)a3 newlyVisible:(id)a4 includeInserts:(BOOL)a5;
- (BOOL)_updatePreferredAttributesForReusableViewInCurrentUpdate:(id)a3 withOriginalAttributes:(id)a4 isExistingView:(BOOL)a5;
- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdate:(id)a3;
- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:(CGRect)a3 newlyVisible:(id)a4 includeInserts:(BOOL)a5;
- (BOOL)_updatePrefetchItemIfNeeded:(id)a3 forIndexPath:(id)a4 withLayoutAttributes:(id)a5 willDisplay:(BOOL)a6;
- (BOOL)_updatePrefetchedCells:(BOOL)a3;
- (BOOL)_updateWithItems:(id)a3 tentativelyForReordering:(BOOL)a4 propertyAnimator:(id)a5 collectionViewAnimator:(id)a6;
- (BOOL)_useIdleObserverForCellPrefetching;
- (BOOL)_validateScrollingTargetIndexPath:(id)a3 raisingExceptionIfNecessary:(BOOL)a4;
- (BOOL)_validateSelectionOrHighlightIndexPath:(id)a3 isSelection:(BOOL)a4 allowMassIndexPath:(BOOL)a5 assertIfInvalid:(BOOL)a6;
- (BOOL)_viewIsReorderedCell:(id)a3;
- (BOOL)_wantsIndexOverlays;
- (BOOL)allowsFocus;
- (BOOL)allowsFocusDuringEditing;
- (BOOL)canBeEdited;
- (BOOL)canBecomeFirstResponder;
- (BOOL)canBecomeFocused;
- (BOOL)dragInteractionEnabled;
- (BOOL)hasActiveDrop;
- (BOOL)indexBarView:(id)a3 didSelectEntry:(id)a4 atIndex:(int64_t)a5;
- (BOOL)isDragSessionActive;
- (BOOL)selectionFollowsFocus;
- (CGPoint)_adjustFocusContentOffset:(CGPoint)a3 toShowFocusItemWithInfo:(id)a4;
- (CGPoint)_contentOffsetForLowFidelityScrollInDirection:(CGPoint)a3 duration:(double *)a4;
- (CGPoint)_contentOffsetForNewFrame:(CGRect)a3 oldFrame:(CGRect)a4 newContentSize:(CGSize)a5 andOldContentSize:(CGSize)a6;
- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5;
- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 itemFrame:(CGRect)a6 containingScrollView:(id)a7 clampToScrollableArea:(BOOL)a8;
- (CGPoint)_delegateTargetOffsetForProposedContentOffset:(CGPoint)a3;
- (CGPoint)_horizontalIndexTitleBarOffset;
- (CGPoint)_reorderingTargetPosition;
- (CGPoint)indexBarAccessoryView:(id)a3 contentOffsetForEntry:(id)a4 atIndex:(int64_t)a5;
- (CGRect)_computeFutureVisibleBoundsForPrefetchVelocity:(CGVector)a3 visibleBounds:(CGRect)a4;
- (CGRect)_computePrefetchCacheValidationBoundsForPrefetchVelocity:(CGVector)a3 visibleBounds:(CGRect)a4;
- (CGRect)_effectiveVisibleBoundsForBounds:(CGRect)a3;
- (CGRect)_visibleBounds;
- (CGSize)intrinsicContentSize;
- (CGVector)_unitVectorForVector:(CGVector)a3;
- (Class)_intelligenceBaseClass;
- (NSArray)indexPathsForSelectedItems;
- (NSArray)indexPathsForVisibleItems;
- (NSArray)visibleCells;
- (NSIndexPath)indexPathForCell:(UICollectionViewCell *)cell;
- (NSIndexPath)indexPathForItemAtPoint:(CGPoint)point;
- (NSInteger)numberOfItemsInSection:(NSInteger)section;
- (NSInteger)numberOfSections;
- (NSString)description;
- (UICollectionReusableView)dequeueConfiguredReusableSupplementaryViewWithRegistration:(UICollectionViewSupplementaryRegistration *)registration forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionReusableView)dequeueReusableSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionView)initWithCoder:(NSCoder *)coder;
- (UICollectionView)initWithFrame:(CGRect)frame collectionViewLayout:(UICollectionViewLayout *)layout;
- (UICollectionViewCell)cellForItemAtIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewCell)dequeueConfiguredReusableCellWithRegistration:(UICollectionViewCellRegistration *)registration forIndexPath:(NSIndexPath *)indexPath item:(id)item;
- (UICollectionViewCell)dequeueReusableCellWithReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewLayoutAttributes)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewLayoutAttributes)layoutAttributesForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath;
- (UICollectionViewTransitionLayout)startInteractiveTransitionToCollectionViewLayout:(UICollectionViewLayout *)layout completion:(UICollectionViewLayoutInteractiveTransitionCompletion)completion;
- (UICollectionViewUpdateItem)_expectedDiffableUpdateItem;
- (UIEdgeInsets)_defaultLayoutMargins;
- (UIEdgeInsets)_visibleRectEdgeInsets;
- (_BYTE)_isContentOffset:(CGFloat)a3 atStartOfAxis:(CGFloat)a4;
- (_NSRange)_globalIndexRangeOfVisibleItems;
- (_UICollectionViewVisibleCellsUpdateResult)_createVisibleViewsForSingleCategoryAttributes:(SEL)a3 limitCreation:(id)a4 fadeForBoundsChange:(BOOL)a5;
- (double)_alignedContentMarginGivenMargin:(double)a3;
- (double)_clampedContentOffset:(double)a3 forScrollableAreaGivenContentSize:(double)a4 inScrollView:(double)a5;
- (double)_contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:(double)a3 shouldApply:(double)a4;
- (double)_frameOfElementAtScrollingTargetIndexPath:(uint64_t)a1;
- (double)_layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:(uint64_t)a1;
- (double)_trackedLayoutValueForKey:(id)a3;
- (id)_arrayForUpdateAction:(int)a3;
- (id)_attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:(id)a3 attributesForNewModel:(id)a4;
- (id)_autoScrollAssistantForIndexPath:(id)a3;
- (id)_cellForItemAtIndexPath:(id)a3;
- (id)_computeMainPrefetchCandidatesForVisibleBounds:(CGRect)a3 futureVisibleBounds:(CGRect)a4 prefetchVector:(CGVector)a5;
- (id)_contextMenuInteraction:(id)a3 accessoriesForMenuWithConfiguration:(id)a4;
- (id)_contextMenuInteraction:(id)a3 styleForMenuWithConfiguration:(id)a4;
- (id)_createPreparedCellForItemAtIndexPath:(id)a3 withLayoutAttributes:(id)a4 applyAttributes:(BOOL)a5 isFocused:(BOOL)a6 notify:(BOOL)a7;
- (id)_createPreparedSupplementaryViewForElementOfKind:(id)a3 atIndexPath:(id)a4 layout:(id)a5 withLayoutAttributes:(id)a6 applyAttributes:(BOOL)a7;
- (id)_createStaticScrollBar;
- (id)_dataSourceActual;
- (id)_dataSourceProxy;
- (id)_dataSourceSectionIndexTitles;
- (id)_defaultTargetedPreviewForIdentifier:(id)a3;
- (id)_delegateActual;
- (id)_delegatePreferredIndexPath;
- (id)_delegateProxy;
- (id)_dequeueReusableCellWithRegistration:(id)a3 forIndexPath:(id)a4;
- (id)_dequeueReusableViewOfKind:(id)a3 withIdentifier:(id)a4 forIndexPath:(id)a5 viewCategory:(unint64_t)a6;
- (id)_diffableDataSourceImpl;
- (id)_diffableIdentifierForIndexPath:(id)a3;
- (id)_dragDelegateActual;
- (id)_dragDelegateProxy;
- (id)_dragDestinationDelegateActual;
- (id)_dragDestinationDelegateProxy;
- (id)_dragSourceDelegateActual;
- (id)_dragSourceDelegateProxy;
- (id)_dropDelegateActual;
- (id)_dropDelegateProxy;
- (id)_dynamicAnimationsForTrackValues;
- (id)_existingFocusItemsInRect:(CGRect)a3;
- (id)_existingIndexPathForIdentityTrackerIdentifier:(id)a3;
- (id)_existingVisibleCells;
- (id)_focusFastScrollingIndexBarEntries;
- (id)_focusPromiseItemsInRect:(CGRect)a3 inCoordinateSpace:(id)a4 inSection:(int64_t)a5;
- (id)_focusScrollBoundaryMetricsForItem:(id)a3;
- (id)_fulfillPromisedFocusRegionForLayoutAttributes:(id)a3;
- (id)_identityTracker:(BOOL)a3;
- (id)_indexBarEntries;
- (id)_indexPathAfterShadowUpdatesForIndexPath:(id)a3;
- (id)_indexPathBeforeShadowUpdatesForIndexPath:(id)a3;
- (id)_indexPathForEntryWithTitle:(id)a3 atIndex:(int64_t)a4 validateTitles:(BOOL)a5;
- (id)_indexPathForGlobalIndex:(int64_t)a3;
- (id)_indexPathForInsertionAtPoint:(CGPoint)a3 dropIntent:(int64_t)a4 sourceIndexPath:(id)a5 indicatorLayoutAttributes:(id *)a6;
- (id)_indexPathForItemAtPoint:(CGPoint)a3;
- (id)_indexPathForSupplementaryView:(id)a3;
- (id)_indexPathForView:(id)a3 ofType:(unint64_t)a4;
- (id)_indexPathOfItemNearestToPoint:(CGPoint)a3 intersectingRect:(CGRect)a4;
- (id)_indexPathsAfterShadowUpdatesForIndexPaths:(id)a3 allowingAppendingInserts:(BOOL)a4;
- (id)_indexPathsBeforeShadowUpdatesForIndexPaths:(id)a3;
- (id)_indexPathsForPreparedItems;
- (id)_indexPathsForSelectedItems;
- (id)_indexPathsForVisibleItems;
- (id)_indexPathsForVisibleSupplementaryViewsOfKind:(id)a3 isDecorationView:(BOOL)a4;
- (id)_keysForObject:(id)a3 inDictionary:(id)a4;
- (id)_layoutAttributes:(id)a3 filteredForCategory:(unint64_t)a4;
- (id)_layoutAttributesClosestToReferencePoint:(uint64_t)a3 amongCandidates:(void *)a4 onAxis:(double)a5 shouldConsiderBlock:(double)a6;
- (id)_layoutAttributesForFailedMovementWithHeading:(unint64_t)a3;
- (id)_managedSubviewForView:(id)a3;
- (id)_objectInDictionary:(id)a3 forKind:(id)a4 indexPath:(id)a5;
- (id)_performShadowUpdates:(id)a3;
- (id)_pivotForTransitionFromLayout:(id)a3 toLayout:(id)a4;
- (id)_prefetchDataSourceActual;
- (id)_prefetchDataSourceProxy;
- (id)_prefetchingContextForOrthogonalScrollingSection:(int64_t)a3;
- (id)_prefetchingContextForVisibleBounds:(CGRect)a3 prefetchVector:(CGVector)a4 prefetchRect:(CGRect)a5 attributes:(id)a6;
- (id)_preparedCellForItemAtIndexPath:(id)a3 withLayoutAttributes:(id)a4 applyAttributes:(BOOL)a5 isFocused:(BOOL)a6 notify:(BOOL)a7;
- (id)_primaryFocusItemForFocusGroup:(id)a3;
- (id)_reorderedItemForView:(id)a3;
- (id)_reusableViewWithoutAttributesForElementCategory:(unint64_t)a3 kind:(id)a4 indexPath:(id)a5;
- (id)_sceneActivationConfigurationForLocation:(CGPoint)a3;
- (id)_sectionContainerViewForSectionIndex:(int64_t)a3 createIfNecessary:(BOOL)a4;
- (id)_sectionIndexesAfterShadowUpdatesForSectionIndexes:(id)a3 allowingAppendingInserts:(BOOL)a4;
- (id)_sectionsWithSectionOperationsInUpdateItems:(void *)a1;
- (id)_selectableIndexPathForItemContainingHitView:(id)a3;
- (id)_setupAnimationsForResizedViewsWithOldModel:(id)a3;
- (id)_sortedDeduplicatedReloadItems;
- (id)_storeScrollingTargetInfoForIndexPath:(void *)a3 frame:(double)a4 scrollPosition:(double)a5 additionalInsets:(double)a6;
- (id)_subviewManager;
- (id)_subviewRouterForOrthogonalScrollViewAtSection:(int64_t)a3;
- (id)_subviewRouterForView:(id)a3 attributes:(id)a4 createIfNecessary:(BOOL)a5;
- (id)_systemDefaultFocusGroupIdentifier;
- (id)_targetIndexPathForMoveOfItemFromOriginalIndexPath:(id)a3 atCurrentIndexPath:(id)a4 toProposedIndexPath:(id)a5;
- (id)_targetedPreviewForBackgroundMenuAtPoint:(CGPoint)a3;
- (id)_translateDataSourceIndexPathToPresentationIndexPathAsNeeded:(id)a3;
- (id)_translateDataSourceIndexPathsToPresentationIndexPathsAsNeeded:(id)a3;
- (id)_translatePresentationIndexPathToDataSourceIndexPathAsNeeded:(id)a3;
- (id)_translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:(id)a3;
- (id)_updateIndexOverlayToShowTitleAtIndex:(int64_t)a3;
- (id)_updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:(BOOL)a3;
- (id)_viewAnimationsForCurrentUpdateWithCollectionViewAnimator:(id)a3 updatingContentOffsetForRestorationAnchor:(BOOL)a4;
- (id)_viewAnimationsForView:(id)a3 startingLayoutAttributes:(id)a4 endingLayoutAttributes:(id)a5 startingLayout:(id)a6 endingLayout:(id)a7 animationSetup:(id)a8 animationCompletion:(id)a9 enableCustomAnimations:(BOOL)a10 customAnimationsType:(unint64_t)a11;
- (id)_viewControllerToNotifyOnLayoutSubviews;
- (id)_visibleCellForIndexPath:(id)a3;
- (id)_visibleSupplementaryViewOfKind:(id)a3 atIndexPath:(id)a4 isDecorationView:(BOOL)a5;
- (id)_visibleSupplementaryViewsOfKind:(id)a3 isDecorationView:(BOOL)a4;
- (id)_visibleViewForLayoutAttributes:(id)a3;
- (id)contextMenuInteraction:(id)a3 configuration:(id)a4 dismissalPreviewForItemWithIdentifier:(id)a5;
- (id)contextMenuInteraction:(id)a3 configuration:(id)a4 highlightPreviewForItemWithIdentifier:(id)a5;
- (id)contextMenuInteraction:(id)a3 configurationForMenuAtLocation:(CGPoint)a4;
- (id)dataSource;
- (id)dragDelegate;
- (id)dragDestinationDelegate;
- (id)dragSourceDelegate;
- (id)dropDelegate;
- (id)focusItemsInRect:(CGRect)a3;
- (id)indexPathForSupplementaryView:(id)a3;
- (id)preferredFocusedView;
- (id)prefetchDataSource;
- (id)preparedCells;
- (id)subviewRouter;
- (id)targetForAction:(SEL)a3 withSender:(id)a4;
- (id)valueForUndefinedKey:(id)a3;
- (int64_t)_cellFocusItemDeferral:(id)a3;
- (int64_t)_currentSectionIndexTitleIndex;
- (int64_t)_dataSourceNumberOfItemsInSection:(int64_t)a3;
- (int64_t)_dataSourceNumberOfSections;
- (int64_t)_preferredDragDestinationVisualStyle;
- (int64_t)_sectionIndexChangedToIndex:(int64_t)a3 title:(id)a4;
- (int64_t)_totalItemCount;
- (int64_t)highlightedGlobalItem;
- (int64_t)maximumGlobalItemIndex;
- (uint64_t)_applyLayoutAttributes:(void *)a3 toView:(int)a4 addingControlledSubview:(uint64_t)a5 forced:;
- (uint64_t)_restoreOrAdjustContentOffsetIfNecessaryWithInsets:(char)a3 hasUpdatedVisibleCells:(double)a4 isRecursive:(double)a5;
- (unint64_t)_createVisibleViewsForAttributes:(id)a3 fadeForBoundsChange:(BOOL)a4 notifyLayoutForVisibleCellsPass:(BOOL)a5;
- (unint64_t)_edgesPropagatingSafeAreaInsetsToSubviews;
- (unint64_t)_focusPrimaryScrollableAxis;
- (unint64_t)_prefetchItemsForPrefetchingContext:(id)a3;
- (unint64_t)_updateVisibleCellsNow:(BOOL)a3;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:(id)a3;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:(id)a3;
- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:(id)a3;
- (void)_accessibilitySetInterfaceStyleIntent:(unint64_t)a3;
- (void)_addControlledSubview:(id)a3;
- (void)_addControlledSubview:(id)a3 atZIndex:(int64_t)a4 forced:(BOOL)a5 initialAttributes:(id)a6;
- (void)_addEntriesFromDictionary:(id)a3 inDictionary:(id)a4 andSet:(id)a5;
- (void)_addIndexPathsRequiringPreferredAttributes:(uint64_t)a1;
- (void)_addReloadDataCompletionBlock:(id)a3;
- (void)_addScrollPocketAsSubview:(id)a3;
- (void)_addSubview:(id)a3 positioned:(int64_t)a4 relativeTo:(id)a5;
- (void)_adjustForAutomaticKeyboardInfo:(id)a3 animated:(BOOL)a4 lastAdjustment:(double *)a5;
- (void)_animateVisibleView:(id)a3 withLayoutAttributes:(id)a4 completionHandler:(id)a5;
- (void)_applyAutomaticAdjustedContentOffset:(CGPoint)a3;
- (void)_applyBlockToAllReusableViews:(id)a3;
- (void)_autoScrollAssistantUpdateContentOffset:(CGPoint)a3;
- (void)_beginTypeSelectWithInput:(id)a3;
- (void)_beginUpdates;
- (void)_cacheOrReuseCell:(id)a3 forIndexPath:(id)a4 invalidatePreferredAttributes:(BOOL)a5 notifyDidEndDisplaying:(BOOL)a6;
- (void)_cancelTouches;
- (void)_cellBackgroundChangedForSelectionOrHighlight:(id)a3;
- (void)_cellBecameFocused:(id)a3;
- (void)_cellDidBecomeFocused:(id)a3;
- (void)_cellDidBecomeUnfocused:(id)a3;
- (void)_cellPreferredSeparatorInsetsChanged:(id)a3;
- (void)_cleanUpAfterInteractiveTransitionDidFinish:(BOOL)a3;
- (void)_clearContentOffsetRestorationAnchor;
- (void)_clearNeedsRecomputePreferredAttributesForInvalidatedElements;
- (void)_clearSpecificInvalidationLists;
- (void)_clearTargetIndexPathForScrolling;
- (void)_completeInteractiveMovementWithDisposition:(int64_t)a3;
- (void)_computeMainPrefetchCandidatesForVelocity:(CGVector)a3;
- (void)_computeVisibleContentOffsetForUpdate:(id)a3 usingData:(id)a4;
- (void)_configureCachedCellForDisplay:(id)a3 withIndexPath:(id)a4 layoutAttributesToUpdate:(id)a5;
- (void)_configureCellForDisplay:(id)a3 indexPath:(id)a4 cached:(BOOL)a5;
- (void)_configureContextMenuInteractionIfNeeded;
- (void)_configureSceneActivationInteractionIfNeeded;
- (void)_configureSupplementaryViewForDisplay:(id)a3 withElementKind:(id)a4 indexPath:(id)a5 elementCategory:(unint64_t)a6;
- (void)_configureTypeSelectInteractionIfNeeded;
- (void)_contentOffsetFromProposedOffset:(double)a3 forScrollingToItemWithFrame:(CGFloat)a4 atScrollPosition:(CGFloat)a5 additionalInsets:(CGFloat)a6 containingScrollViewBounds:(CGFloat)a7;
- (void)_createAndAppendViewAnimationsForDeletesInCurrentUpdate:(id)a3 disappearingAnimations:(id)a4;
- (void)_createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:(id)a3 disappearingAnimations:(id)a4 animationsForOnScreenViews:(id)a5 newSubviewCollection:(id)a6 oldVisibleViews:(id)a7;
- (void)_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:(id)a3 animationsForOnScreenViews:(id)a4 newSubviewCollection:(id)a5 oldVisibleViews:(id)a6 attributesForNewModel:(id)a7;
- (void)_createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 newSubviewCollection:(id)a5;
- (void)_createAndAppendViewAnimationsForInsertsInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 newSubviewCollection:(id)a5;
- (void)_createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 animationsForOnScreenViews:(id)a5 newSubviewCollection:(id)a6 attributesForNewModel:(id)a7;
- (void)_decrementRotationAnimationCount;
- (void)_decrementUpdateAnimationCountWithContext:(id)a3;
- (void)_deselectAllAnimated:(BOOL)a3 notifyDelegate:(BOOL)a4;
- (void)_deselectItemAtIndexPath:(id)a3 animated:(BOOL)a4 notifyDelegate:(BOOL)a5 isUserInitiated:(BOOL)a6;
- (void)_deselectItemsAtIndexPaths:(id)a3 animated:(BOOL)a4 transitionCoordinator:(id)a5 isUserInitiated:(BOOL)a6;
- (void)_didMoveFromSuperview:(id)a3;
- (void)_didMoveFromWindow:(id)a3 toWindow:(id)a4;
- (void)_didUpdateFocusInContext:(id)a3;
- (void)_endItemAnimationsWithInvalidationContext:(id)a3 tentativelyForReordering:(BOOL)a4 animator:(id)a5 collectionViewAnimator:(id)a6;
- (void)_endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate;
- (void)_endUpdatesWithInvalidationContext:(id)a3 tentativelyForReordering:(BOOL)a4 animator:(id)a5 collectionViewAnimator:(id)a6;
- (void)_enqueueViewForReuse:(id)a3;
- (void)_ensureFocusedViewIsNotHidden;
- (void)_ensureViewsAreLoadedInRect:(CGRect)a3;
- (void)_enumerateVisibleViews:(id)a3;
- (void)_finishInteractiveTransitionShouldFinish:(BOOL)a3 finalAnimation:(BOOL)a4;
- (void)_focusMovementDidFailNotification:(id)a3;
- (void)_geometryChanged:(id *)a3 forAncestor:(id)a4;
- (void)_getOriginalReorderingIndexPaths:(id *)a3 targetIndexPaths:(id *)a4;
- (void)_handlePresses:(id)a3 keyHandler:(id)a4 defaultHandler:(id)a5;
- (void)_hideIndexOverlay;
- (void)_highlightFirstVisibleItemIfAppropriate;
- (void)_highlightSpringLoadedItemAtIndexPath:(id)a3;
- (void)_immediatelyBeginDruidBasedReorderIfPossibleWithTouch:(id)a3;
- (void)_incrementUpdateAnimationCountWithContext:(id)a3;
- (void)_intelligenceCollectSubelementsIn:(CGRect)a3 using:(id)a4 transformToRoot:(id)a5;
- (void)_invalidateLayoutForReload;
- (void)_invalidateLayoutForUpdatedLayoutMarginsIfNeeded;
- (void)_invalidateLayoutWithContext:(id)a3;
- (void)_invalidateWithBlock:(id)a3;
- (void)_layoutAdjustmentsDidChange;
- (void)_layoutDirectionTraitDidChange;
- (void)_layoutMarginsDidChangeFromOldMargins:(UIEdgeInsets)a3;
- (void)_layoutMarginsWillChange;
- (void)_layoutSectionContainerViews;
- (void)_managedSubviewAdded:(id)a3;
- (void)_moveItemAtIndexPath:(id)a3 toIndexPath:(id)a4;
- (void)_moveSection:(int64_t)a3 toSection:(int64_t)a4;
- (void)_moveSectionIndexTitleIndexToIndex:(int64_t)a3 highlight:(BOOL)a4;
- (void)_moveWithEvent:(id)a3;
- (void)_notifyDataSourceForMoveOfItemFromIndexPath:(id)a3 toIndexPath:(id)a4;
- (void)_notifyDidEndDisplayingCellIfNeeded:(id)a3 forIndexPath:(id)a4;
- (void)_notifyDidEndDisplayingSupplementaryView:(id)a3;
- (void)_notifyDidScroll;
- (void)_notifyWillDisplayCellIfNeeded:(id)a3 forIndexPath:(id)a4;
- (void)_notifyWillDisplaySupplementaryView:(id)a3 forElementKind:(id)a4 atIndexPath:(id)a5;
- (void)_orthogonalScrollView:(id)a3 didScrollToOffset:(CGPoint)a4 inSection:(int64_t)a5;
- (void)_performAction:(SEL)a3 forCell:(id)a4 sender:(id)a5;
- (void)_performBatchUpdates:(id)a3 completion:(id)a4 invalidationContext:(id)a5 tentativelyForReordering:(BOOL)a6 animator:(id)a7 animationHandler:(id)a8;
- (void)_performDiffableUpdate:(id)a3;
- (void)_performInternalBatchUpdates:(id)a3;
- (void)_performReloadPrefetchIfNeeded;
- (void)_performUpdate:(id)a3;
- (void)_performWhileSuppressingPromiseRegionGeneration:(id)a3;
- (void)_populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:(id)a3 addingDeletedViewsToSet:(id)a4 updateLayoutAttributesIndexPaths:(BOOL)a5;
- (void)_prepareClonedViewsForTransitionLayout;
- (void)_prepareLayoutForUpdates:(BOOL)a3;
- (void)_prepareViewForReuse:(uint64_t)a1;
- (void)_prepareViewForUse:(id)a3 withElementCategory:(unint64_t)a4 elementKind:(id)a5 reuseIdentifier:(id)a6 indexPath:(id)a7;
- (void)_prepareViewForUse:(id)a3 withElementCategory:(unint64_t)a4 elementKind:(id)a5 reuseIdentifier:(id)a6 indexPath:(id)a7 applyDefaultAttributes:(BOOL)a8;
- (void)_processQueuedSectionContainerRemovals;
- (void)_processViewSpecificInvalidationsForVisibleViews;
- (void)_pruneCachedPrefetchViewsForVelocity:(CGVector)a3;
- (void)_prunePrefetchedViewsAtIndexPaths:(id)a3;
- (void)_purgeReuseQueues;
- (void)_rebaseContentOffsetAnchorOrScrollTargetForUpdate:(id)a3;
- (void)_rebasePrefetchedCellIndexPathsWithMapping:(id)a3;
- (void)_recomputePreferredAttributesForInvalidatedElementsIfNeeded;
- (void)_recomputeSectionIndexTitleIndex;
- (void)_reconfigureCell:(id)a3 forItemAtIndexPath:(id)a4;
- (void)_reconfigureItemAtIndexPath:(id)a3;
- (void)_reconfigureSectionContainersForUpdate:(id)a3;
- (void)_registeredSupplementaryViewKind:(id)a3;
- (void)_reloadDataIfNeeded;
- (void)_reloadSectionIndexTitles;
- (void)_removeReorderDestinationView;
- (void)_removeStandaloneIndexBarIfNecessary;
- (void)_removeUntrackedAuxillaryViewsForBeforeVisibleViews:(id)a3 afterVisibleViews:(id)a4 withTrackingViewAnimations:(id)a5;
- (void)_removeVisibleViews:(id)a3 fadeForBoundsChange:(BOOL)a4;
- (void)_reorderPrefetchCandidates:(id)a3 forPrefetchVelocity:(CGVector)a4 visibleBounds:(CGRect)a5;
- (void)_reparentViewIntoCorrectContainer:(id)a3;
- (void)_reparentViewIntoSelf:(id)a3;
- (void)_requestFocusOnItemAtIndexPath:(id)a3;
- (void)_resetAllPrefetchContexts;
- (void)_resetDropTargetAppearance;
- (void)_resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:(id)a3;
- (void)_resetPrefetchState;
- (void)_resetPrefetchedCachedCells;
- (void)_resetPrefetchingContext:(id)a3;
- (void)_resetUpdateItemArrays;
- (void)_resignOrRebaseFirstResponderViewWithIndexPathMapping:(id)a3;
- (void)_resumeDidScrollNotifications;
- (void)_resumeReloads;
- (void)_reusableViewDidInvalidateIntrinsicContentSize:(id)a3;
- (void)_reusePrefetchedCell:(id)a3;
- (void)_reusePreviouslyFocusedManagedSubviewIfNeeded:(id)a3;
- (void)_safeAreaInsetsDidChangeFromOldInsets:(UIEdgeInsets)a3;
- (void)_safeAreaInsetsWillChange;
- (void)_saveContentOffsetRestorationAnchorIfNecessaryUsingModel:(uint64_t)a1;
- (void)_scrollFirstResponderCellToVisible:(BOOL)a3;
- (void)_scrollToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 animated:(BOOL)a6;
- (void)_scrollToItemAtPresentationIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 animated:(BOOL)a6;
- (void)_scrollViewAnimationEnded:(id)a3 finished:(BOOL)a4;
- (void)_scrollViewDidEndDraggingWithDeceleration:(BOOL)a3;
- (void)_scrollViewWillEndDraggingWithVelocity:(CGPoint)a3 targetContentOffset:(CGPoint *)a4;
- (void)_selectAllSelectedItems;
- (void)_selectItemAtIndexPath:(id)a3 animated:(BOOL)a4 scrollPosition:(unint64_t)a5 notifyDelegate:(BOOL)a6 deselectPrevious:(BOOL)a7 performPrimaryAction:(BOOL)a8 performCustomSelectionAction:(BOOL)a9 isUserInitiated:(BOOL)a10;
- (void)_selectionInteractionDidBeginHinting:(id)a3;
- (void)_selectionInteractionDidCancelHinting:(id)a3;
- (void)_selectionInteractionDidSelect:(id)a3;
- (void)_setAllowsBandSelectionForMultipleSelection:(BOOL)a3;
- (void)_setAllowsMultipleSelectionDuringEditing:(BOOL)a3;
- (void)_setAllowsSelectionDuringEditing:(BOOL)a3;
- (void)_setAllowsVisibleCellUpdatesDuringUpdateAnimations:(BOOL)a3;
- (void)_setAllowsVisibleViewUpdatesDuringLayoutTransitions:(BOOL)a3;
- (void)_setCollectionViewLayout:(id)a3 animated:(BOOL)a4 isInteractive:(BOOL)a5 completion:(id)a6 animator:(id)a7;
- (void)_setContentSize:(CGSize)a3 skipContentOffsetAdjustment:(BOOL)a4;
- (void)_setContentSizeFromLayout:(CGSize)a3 isRecursivelyUpdatingVisibleCells:(BOOL)a4;
- (void)_setDefaultAlwaysBounceVertical:(BOOL)a3 horizontal:(BOOL)a4;
- (void)_setDefaultLayoutMargins:(UIEdgeInsets)a3 fromViewController:(BOOL)a4;
- (void)_setDelaysUserInitiatedItemSelection:(BOOL)a3;
- (void)_setDisplaysHorizontalIndexTitleBar:(BOOL)a3;
- (void)_setExternalObjectTable:(id)a3 forNibLoadingOfCellWithReuseIdentifier:(id)a4;
- (void)_setExternalObjectTable:(id)a3 forNibLoadingOfSupplementaryViewOfKind:(id)a4 withReuseIdentifier:(id)a5;
- (void)_setFocusedItemState:(id)a3;
- (void)_setForcePreserveSemanticContentOffsetDuringUpdates:(BOOL)a3;
- (void)_setHorizontalIndexTitleBarOffset:(CGPoint)a3;
- (void)_setIsAncestorOfFirstResponder:(BOOL)a3;
- (void)_setKeepsFirstResponderVisibleOnBoundsChange:(BOOL)a3;
- (void)_setNeedsRecomputePreferredAttributesForInvalidatedElements;
- (void)_setNeedsVisibleCellsUpdate:(BOOL)a3 withLayoutAttributes:(BOOL)a4;
- (void)_setObject:(id)a3 inDictionary:(id)a4 forKind:(id)a5 indexPath:(id)a6;
- (void)_setPocketRelativeSubview:(id)a3 isOver:(BOOL)a4 forKey:(id)a5;
- (void)_setPreferredDragDestinationVisualStyle:(int64_t)a3;
- (void)_setPrefetchingContext:(id)a3 forOrthogonalScrollingSection:(int64_t)a4;
- (void)_setReorderFeedbackGenerator:(id)a3;
- (void)_setShouldBecomeFocusedOnSelection:(BOOL)a3;
- (void)_setShouldDeriveVisibleBoundsFromContainingScrollView:(BOOL)a3;
- (void)_setShouldPersistSelectionOnReloadDataWhenPossible:(BOOL)a3;
- (void)_setShouldPrefetchCellsWhenPerformingReloadData:(BOOL)a3;
- (void)_setShouldPreventFocusScrollPastContentSize:(BOOL)a3;
- (void)_setShouldResetInitialLayoutOnDataSourceChange:(BOOL)a3;
- (void)_setShouldSkipForcedLayoutBeforeBatchUpdates:(BOOL)a3;
- (void)_setTypeSelectShouldAvoidBecomingFirstResponder:(BOOL)a3;
- (void)_setUpCompletionHandlerForAnimationInterruptionIfNecessary;
- (void)_setUsesStaticScrollBar:(BOOL)a3;
- (void)_setVisibleView:(id)a3 forLayoutAttributes:(id)a4;
- (void)_setupCellAnimations;
- (void)_setupExpandCollapseAnimationsIfNeededWithContext:(id)a3;
- (void)_setupIndexOverlayManagerIfNecessary;
- (void)_shiftSectionIndexTitleIndexByAmount:(int64_t)a3;
- (void)_sortAttributesByDistanceToVisibleBoundsOrigin:(id)a3;
- (void)_springLoadedInteractionSelectItemAtIndexPath:(id)a3;
- (void)_startViewAnimationsWithContext:(id)a3 oldVisibleViews:(id)a4 viewAnimator:(id)a5 viewAnimationsCompletedDispatchGroup:(id)a6;
- (void)_stopScrollingNotify:(BOOL)a3 pin:(BOOL)a4;
- (void)_trackLayoutValue:(double)a3 forKey:(id)a4;
- (void)_traitsConsumedByLayoutInvalidated;
- (void)_transitionIndexOverlaySelectionViewToVisible:(BOOL)a3;
- (void)_unhighlightAllItems;
- (void)_unhighlightAllItemsAndHighlightGlobalItem:(int64_t)a3;
- (void)_unhighlightItemAtIndexPath:(id)a3 animated:(BOOL)a4 notifyDelegate:(BOOL)a5;
- (void)_unhighlightSpringLoadedItem;
- (void)_updateAnimationDidStop:(id)a3 finished:(BOOL)a4;
- (void)_updateBackgroundColorIfNeeded;
- (void)_updateBackgroundView;
- (void)_updateContentFocusContainerGuides;
- (void)_updateContextMenuStateForVisibleCells:(id)a3;
- (void)_updateCycleIdleUntil:(unint64_t)a3;
- (void)_updateDefaultLayoutMargins;
- (void)_updateDerivesVisibleBoundsFromContainingScrollView;
- (void)_updateDropTargetAppearanceWithTargetIndexPath:(id)a3 intent:(int64_t)a4 indicatorLayoutAttributes:(id)a5;
- (void)_updateEditing:(BOOL)a3 forView:(id)a4 atIndexPath:(id)a5 elementCategory:(unint64_t)a6;
- (void)_updateFocusAfterLoadingVisibleCellsIfNeeded:(id)a3;
- (void)_updateFocusScrollBoundaryMetrics:(id)a3 forItem:(id)a4 inSection:(int64_t)a5;
- (void)_updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:(CGRect)a3;
- (void)_updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:(id)a3;
- (void)_updateIndex;
- (void)_updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(BOOL)a3;
- (void)_updateOrderingOfViewsInDisappearingViewAnimations:(id)a3 onScreenViewAnimations:(id)a4;
- (void)_updatePreferredAttributesForCurrentUpdate;
- (void)_updatePreferredAttributesForCurrentUpdate:(unint64_t)a3;
- (void)_updatePrefetchVelocityIntegratorForVisibleBounds:(CGRect)a3;
- (void)_updatePrefetchedCellsForOrthogonalScrollingSection:(int64_t)a3 withOriginalPrefetchingVector:(CGVector)a4 canCompute:(BOOL)a5 canPrefetch:(BOOL)a6;
- (void)_updateReorderDestinationViewWithLayoutAttributes:(id)a3;
- (void)_updateReorderingTargetPosition:(CGPoint)a3;
- (void)_updateRowsAtIndexPaths:(id)a3 updateAction:(int)a4 updates:(id)a5;
- (void)_updateSectionIndex;
- (void)_updateSections:(id)a3 updateAction:(int)a4;
- (void)_updateSelectionIsKey;
- (void)_updateTrackedLayoutValuesWith:(id)a3;
- (void)_updateTransitionWithProgress:(double)a3;
- (void)_updateVerticalScrollIndicatorVisibility;
- (void)_updateWithUpdates:(id)a3 updateAction:(int64_t)a4;
- (void)_userSelectItemAtIndexPath:(id)a3;
- (void)_userSelectItemAtIndexPath:(id)a3 animatedSelection:(BOOL)a4;
- (void)_wheelChangedWithEvent:(id)a3;
- (void)_willRemoveSubview:(id)a3;
- (void)_willUpdateFocusInContext:(id)a3;
- (void)accessoryInsetsDidChange:(UIEdgeInsets)a3;
- (void)bringSubviewToFront:(id)a3;
- (void)contextMenuInteraction:(id)a3 willDisplayMenuForConfiguration:(id)a4 animator:(id)a5;
- (void)contextMenuInteraction:(id)a3 willEndForConfiguration:(id)a4 animator:(id)a5;
- (void)contextMenuInteraction:(id)a3 willPerformPreviewActionForMenuWithConfiguration:(id)a4 animator:(id)a5;
- (void)dealloc;
- (void)decodeRestorableStateWithCoder:(id)a3;
- (void)deleteItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)deleteSections:(NSIndexSet *)sections;
- (void)deselectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated;
- (void)didMoveToWindow;
- (void)encodeRestorableStateWithCoder:(id)a3;
- (void)encodeWithCoder:(id)a3;
- (void)exchangeSubviewAtIndex:(int64_t)a3 withSubviewAtIndex:(int64_t)a4;
- (void)horizontalIndexBar:(id)a3 selectedEntry:(id)a4;
- (void)insertItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)insertSections:(NSIndexSet *)sections;
- (void)layoutHorizontalIndexTitleBar;
- (void)layoutSubviews;
- (void)moveItemAtIndexPath:(NSIndexPath *)indexPath toIndexPath:(NSIndexPath *)newIndexPath;
- (void)moveSection:(NSInteger)section toSection:(NSInteger)newSection;
- (void)performUsingPresentationValues:(id)a3;
- (void)pressesBegan:(id)a3 withEvent:(id)a4;
- (void)pressesCancelled:(id)a3 withEvent:(id)a4;
- (void)pressesChanged:(id)a3 withEvent:(id)a4;
- (void)pressesEnded:(id)a3 withEvent:(id)a4;
- (void)reconfigureItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)registerClass:(Class)cellClass forCellWithReuseIdentifier:(NSString *)identifier;
- (void)registerClass:(Class)viewClass forSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier;
- (void)registerNib:(UINib *)nib forCellWithReuseIdentifier:(NSString *)identifier;
- (void)registerNib:(UINib *)nib forSupplementaryViewOfKind:(NSString *)kind withReuseIdentifier:(NSString *)identifier;
- (void)reloadData;
- (void)reloadItemsAtIndexPaths:(NSArray *)indexPaths;
- (void)reloadSections:(NSIndexSet *)sections;
- (void)scrollToItemAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UICollectionViewScrollPosition)scrollPosition animated:(BOOL)animated;
- (void)selectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated scrollPosition:(UICollectionViewScrollPosition)scrollPosition;
- (void)sendSubviewToBack:(id)a3;
- (void)setAllowsFocus:(BOOL)allowsFocus;
- (void)setAllowsFocusDuringEditing:(BOOL)allowsFocusDuringEditing;
- (void)setAllowsMultipleSelection:(BOOL)allowsMultipleSelection;
- (void)setAllowsSelection:(BOOL)allowsSelection;
- (void)setAllowsUserInitiatedMultipleSelection:(BOOL)a3;
- (void)setAlwaysBounceHorizontal:(BOOL)a3;
- (void)setAlwaysBounceVertical:(BOOL)a3;
- (void)setBackgroundColor:(id)a3;
- (void)setBackgroundView:(UIView *)backgroundView;
- (void)setBounds:(CGRect)a3;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)collectionViewLayout;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated;
- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated completion:(void *)completion;
- (void)setContentInset:(UIEdgeInsets)a3;
- (void)setContentOffset:(CGPoint)a3;
- (void)setContentOffset:(CGPoint)a3 animated:(BOOL)a4;
- (void)setContentSize:(CGSize)a3;
- (void)setDataSource:(id)dataSource;
- (void)setDelegate:(id)delegate;
- (void)setDirectionalLayoutMargins:(NSDirectionalEdgeInsets)a3;
- (void)setDragDelegate:(id)dragDelegate;
- (void)setDragDestinationDelegate:(id)a3;
- (void)setDragSourceDelegate:(id)a3;
- (void)setDropDelegate:(id)dropDelegate;
- (void)setEditing:(BOOL)editing;
- (void)setFrame:(CGRect)a3;
- (void)setLayoutMargins:(UIEdgeInsets)a3;
- (void)setPrefetchDataSource:(id)prefetchDataSource;
- (void)setPrefetchingEnabled:(BOOL)prefetchingEnabled;
- (void)setRemembersLastFocusedIndexPath:(BOOL)remembersLastFocusedIndexPath;
- (void)setScrollEnabled:(BOOL)a3;
- (void)setSelectionFollowsFocus:(BOOL)selectionFollowsFocus;
- (void)setSelfSizingInvalidation:(UICollectionViewSelfSizingInvalidation)selfSizingInvalidation;
- (void)setSemanticContentAttribute:(int64_t)a3;
- (void)touchesBegan:(id)a3 withEvent:(id)a4;
- (void)touchesCancelled:(id)a3 withEvent:(id)a4;
- (void)touchesEnded:(id)a3 withEvent:(id)a4;
- (void)touchesMoved:(id)a3 withEvent:(id)a4;
- (void)updateInteractiveMovementTargetPosition:(CGPoint)targetPosition;
- (void)userInteractionStoppedWithIndexBarView:(id)a3;
@end

@implementation UICollectionView

- (unint64_t)_edgesPropagatingSafeAreaInsetsToSubviews
{
  if ([(UICollectionViewLayout *)self->_layout _overridesSafeAreaPropagationToDescendants])
  {
    layout = self->_layout;

    return [(UICollectionViewLayout *)layout _edgesForSafeAreaPropagationToDescendants];
  }

  else
  {
    v5.receiver = self;
    v5.super_class = UICollectionView;
    return [(UIScrollView *)&v5 _edgesPropagatingSafeAreaInsetsToSubviews];
  }
}

- (void)layoutHorizontalIndexTitleBar
{
  v3 = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (v3)
  {
    [(UIScrollView *)self contentOffset];
    y = self->_horizontalIndexTitleBarOffset.y;
    v6 = v5 + self->_horizontalIndexTitleBarOffset.x;
    [(UIView *)self bounds];
    v8 = v7;
    v9 = [(UICollectionView *)self _horizontalIndexTitleBar];
    [v9 setFrame:{v6, y, v8, 66.0}];
  }
}

- (void)_updateContentFocusContainerGuides
{
  v3 = [(UIView *)self _focusSystem];

  if (v3)
  {
    if (!self->_contentFocusContainerGuide)
    {
      v4 = objc_alloc_init(UIFocusContainerGuide);
      contentFocusContainerGuide = self->_contentFocusContainerGuide;
      self->_contentFocusContainerGuide = v4;

      [(UIView *)self addLayoutGuide:self->_contentFocusContainerGuide];
      [(UILayoutGuide *)self->_contentFocusContainerGuide _setLockedToOwningView:1];
      [(UILayoutGuide *)self->_contentFocusContainerGuide setIdentifier:@"UICollectionViewContentFocusContainerGuide"];
    }

    v6 = [(UICollectionView *)self collectionViewLayout];
    v7 = [v6 _layoutAxis];

    endOfContentFocusContainerGuide = self->_endOfContentFocusContainerGuide;
    if (endOfContentFocusContainerGuide || v7 == 0)
    {
      if (endOfContentFocusContainerGuide)
      {
        v10 = v7 == 0;
      }

      else
      {
        v10 = 0;
      }

      if (v10)
      {
        [(UILayoutGuide *)endOfContentFocusContainerGuide _setLockedToOwningView:0];
        [(UIView *)self removeLayoutGuide:self->_endOfContentFocusContainerGuide];
        v11 = self->_endOfContentFocusContainerGuide;
        self->_endOfContentFocusContainerGuide = 0;
      }
    }

    else
    {
      v12 = objc_alloc_init(UIFocusContainerGuide);
      v13 = self->_endOfContentFocusContainerGuide;
      self->_endOfContentFocusContainerGuide = v12;

      [(UIView *)self addLayoutGuide:self->_endOfContentFocusContainerGuide];
      [(UILayoutGuide *)self->_endOfContentFocusContainerGuide _setLockedToOwningView:1];
      [(UILayoutGuide *)self->_endOfContentFocusContainerGuide setIdentifier:@"UICollectionViewEndOfContentFocusContainerGuide"];
    }

    v14 = self->_contentFocusContainerGuide;
    [(UIView *)self bounds];
    [(UILayoutGuide *)v14 _setManualLayoutFrame:?];
    if (self->_endOfContentFocusContainerGuide)
    {
      if (v7)
      {
        if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]>= 1)
        {
          collectionViewData = self->_collectionViewData;
          if (collectionViewData)
          {
            if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
            {
              [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
            }

            if (collectionViewData->_totalItemCount >= 1)
            {
              v16 = self->_collectionViewData;
              if (v16)
              {
                if ((*&v16->_collectionViewDataFlags & 2) == 0)
                {
                  [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
                }

                v17 = v16->_totalItemCount - 1;
              }

              else
              {
                v17 = -1;
              }

              v18 = [(UICollectionViewData *)v16 indexPathForItemAtGlobalIndex:v17];
              v19 = [(UICollectionView *)self layoutAttributesForItemAtIndexPath:v18];
              if (v19)
              {
                v20 = v19;
                if (v7 == 2)
                {
                  [v19 frame];
                  MinY = CGRectGetMinY(v33);
                  [(UIView *)self bounds];
                  Width = CGRectGetWidth(v34);
                  [v20 size];
                  Height = v23;
                  MinX = 0.0;
                }

                else if (v7 == 1)
                {
                  [v19 frame];
                  MinX = CGRectGetMinX(v35);
                  [v20 size];
                  Width = v27;
                  [(UIView *)self bounds];
                  Height = CGRectGetHeight(v36);
                  MinY = 0.0;
                }

                else
                {
                  Width = *(MEMORY[0x1E695F058] + 16);
                  Height = *(MEMORY[0x1E695F058] + 24);
                  MinX = *MEMORY[0x1E695F058];
                  MinY = *(MEMORY[0x1E695F058] + 8);
                }

                [(UILayoutGuide *)self->_endOfContentFocusContainerGuide _setManualLayoutFrame:MinX, MinY, Width, Height];

                v28 = [(UICollectionView *)self _focusedItemState];
                v31 = v28;
                if (v28)
                {
                  v29 = *(v28 + 8);
                }

                else
                {
                  v29 = 0;
                }

                v30 = v29;
                [(UIFocusGuide *)self->_endOfContentFocusContainerGuide setEnabled:v30 != 0];

                return;
              }
            }
          }
        }

        [(UIFocusGuide *)self->_endOfContentFocusContainerGuide setEnabled:0];
        v26 = self->_endOfContentFocusContainerGuide;
        [(UIView *)self bounds];

        [(UILayoutGuide *)v26 _setManualLayoutFrame:?];
      }
    }
  }
}

- (void)_updateBackgroundColorIfNeeded
{
  if ((*(&self->_collectionViewFlags + 12) & 0x80) == 0)
  {
    v3 = [(UICollectionView *)self backgroundView];

    if (!v3)
    {
      if (dyld_program_sdk_at_least())
      {
        v4 = [(UICollectionViewLayout *)self->_layout _preferredBackgroundColor];
      }

      else
      {
        v4 = 0;
      }

      v5 = [(UIView *)self traitCollection];
      if (v5)
      {
        v6 = v5;
        _UIRecordTraitUsage(v5, 0x13uLL);
        v7 = v6[16];

        if (v4)
        {
LABEL_15:
          v9[0] = MEMORY[0x1E69E9820];
          v9[1] = 3221225472;
          v9[2] = __50__UICollectionView__updateBackgroundColorIfNeeded__block_invoke;
          v9[3] = &unk_1E70F35B8;
          v9[4] = self;
          v10 = v4;
          v8 = v4;
          [UIView _performSystemAppearanceModifications:v9];

          return;
        }

        if (v7 == 2)
        {
          v4 = 0;
          goto LABEL_15;
        }
      }

      else if (v4)
      {
        goto LABEL_15;
      }

      if (dyld_program_sdk_at_least())
      {
        +[UIColor systemBackgroundColor];
      }

      else
      {
        +[UIColor blackColor];
      }
      v4 = ;
      goto LABEL_15;
    }
  }
}

uint64_t __50__UICollectionView__updateBackgroundColorIfNeeded__block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) setBackgroundColor:*(a1 + 40)];
  *(*(a1 + 32) + 2728) &= ~0x8000000000uLL;
  return result;
}

- (void)_updateSelectionIsKey
{
  v3 = (*(&self->_collectionViewFlags + 1) >> 26) & 1;
  v4 = [(UICollectionView *)self selectionFollowsFocus];

  _UITableUpdateSelectionIsKeyTraitOverride(self, v3, v4);
}

- (BOOL)selectionFollowsFocus
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 18) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __41__UICollectionView_selectionFollowsFocus__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

uint64_t __41__UICollectionView_selectionFollowsFocus__block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusBehavior];
  v3 = [v2 defaultValueForSelectionFollowsFocusInCollectionView:*(a1 + 32)];

  return v3;
}

- (void)_updateVerticalScrollIndicatorVisibility
{
  v3 = [(UIView *)self traitCollection];
  v4 = [v3 userInterfaceIdiom];

  if (v4 == 6)
  {
    v5 = [(UIView *)self traitCollection];
    v6 = [v5 _hasSplitViewControllerContextPrimaryColumn];

    [(UIScrollView *)self _setDefaultShowsVerticalScrollIndicator:v6 ^ 1u];
  }
}

- (id)dragDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  return WeakRetained;
}

- (id)dropDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  return WeakRetained;
}

- (BOOL)_wantsIndexOverlays
{
  v3 = [(UIView *)self traitCollection];
  if ([v3 userInterfaceIdiom] == 3 && (v4 = *(&self->_collectionViewFlags + 1), (v4 & 2) != 0))
  {
    v5 = (v4 >> 2) & 1;
  }

  else
  {
    LOBYTE(v5) = 0;
  }

  return v5;
}

- (id)dataSource
{
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  return WeakRetained;
}

- (void)_configureContextMenuInteractionIfNeeded
{
  v3 = [(UICollectionView *)self _delegateSupportsMenuInteraction];
  contextMenuInteraction = self->_contextMenuInteraction;
  if (v3)
  {
    if (!contextMenuInteraction)
    {
      v5 = [[UIContextMenuInteraction alloc] initWithDelegate:self];
      v6 = self->_contextMenuInteraction;
      self->_contextMenuInteraction = v5;

      v7 = self->_contextMenuInteraction;

      [(UIView *)self addInteraction:v7];
    }
  }

  else if (contextMenuInteraction)
  {
    [(UIView *)self removeInteraction:?];
    v8 = self->_contextMenuInteraction;
    self->_contextMenuInteraction = 0;
  }
}

- (void)_updateDerivesVisibleBoundsFromContainingScrollView
{
  WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
  v6 = WeakRetained;
  if ((*(&self->_collectionViewFlags + 14) & 2) != 0)
  {
    if ([(UIScrollView *)self isScrollEnabled])
    {
      v4 = 0;
    }

    else
    {
      v4 = [(UIView *)self _containingScrollView];
    }

    WeakRetained = v6;
  }

  else
  {
    v4 = 0;
  }

  if (WeakRetained != v4)
  {
    if (WeakRetained)
    {
      objc_storeWeak(&self->_containerScrollView, 0);
      [(UIView *)self _removeGeometryChangeObserver:v6];
    }

    if (v4)
    {
      objc_storeWeak(&self->_containerScrollView, v4);
      [(UIView *)self _addGeometryChangeObserver:v4];
    }
  }

  v5 = *(&self->_collectionViewFlags + 1);
  if ((v4 != 0) == ((v5 & 0x4000000000000) == 0))
  {
    *(&self->_collectionViewFlags + 1) = v5 & 0xFFFBFFFFFFFFFFFFLL | ((v4 != 0) << 50);
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
  }
}

- (id)dragSourceDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  return WeakRetained;
}

- (BOOL)_dragAndDropNeededForReordering
{
  v3 = dyld_program_sdk_at_least();
  if (v3)
  {
    LOBYTE(v3) = (*(&self->_collectionViewFlags + 8) & 0x11) != 0 && (dragAndDropController = self->_dragAndDropController) != 0 && dragAndDropController->_preferredDragDestinationVisualStyle == 2;
  }

  return v3;
}

- (void)_configureSceneActivationInteractionIfNeeded
{
  v3 = *&self->_collectionViewFlags & 0x1800000000000;
  v4 = [UIApp supportsMultipleScenes];
  sceneActivationInteraction = self->_sceneActivationInteraction;
  if (v4)
  {
    v6 = v3 == 0;
  }

  else
  {
    v6 = 1;
  }

  if (v6)
  {
    if (sceneActivationInteraction)
    {
      [(UIView *)self removeInteraction:?];
      v7 = self->_sceneActivationInteraction;
      self->_sceneActivationInteraction = 0;
    }
  }

  else if (!sceneActivationInteraction)
  {
    objc_initWeak(&location, self);
    v8 = [UIWindowSceneActivationInteraction alloc];
    v11 = MEMORY[0x1E69E9820];
    v12 = 3221225472;
    v13 = __64__UICollectionView__configureSceneActivationInteractionIfNeeded__block_invoke;
    v14 = &unk_1E70FFAB0;
    objc_copyWeak(&v15, &location);
    v9 = [(UIWindowSceneActivationInteraction *)v8 initWithConfigurationProvider:&v11 errorHandler:&__block_literal_global_1119];
    v10 = self->_sceneActivationInteraction;
    self->_sceneActivationInteraction = v9;

    [(UIView *)self addInteraction:self->_sceneActivationInteraction, v11, v12, v13, v14];
    objc_destroyWeak(&v15);
    objc_destroyWeak(&location);
  }
}

- (void)_configureTypeSelectInteractionIfNeeded
{
  v3 = (~*&self->_collectionViewFlags & 0xC0000000000000) == 0 && (_os_feature_enabled_impl() & 1) != 0;
  typeSelectController = self->_typeSelectController;

  [(_UICollectionViewTypeSelectController *)typeSelectController setEnabled:v3];
}

- (void)reloadData
{
  v105 = *MEMORY[0x1E69E9840];
  if (self->_reloadingSuspendedCount >= 1)
  {
    *(&self->_collectionViewFlags + 1) |= 0x200uLL;
    return;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492320);
  v4 = *(CategoryCachedImpl + 8);
  v5 = os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self);
  if (v5 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v6 = v5;
    if (os_signpost_enabled(v4))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v4, OS_SIGNPOST_EVENT, v6, "ReloadData", "", buf, 2u);
    }
  }

  v7 = [(UICollectionView *)self _focusedItemState];

  if (v7)
  {
    *(&self->_collectionViewFlags + 1) |= 0x80000000000uLL;
    v8 = [(UICollectionView *)self _focusedItemState];
    v9 = v8;
    if (v8)
    {
      v10 = *(v8 + 8);
    }

    else
    {
      v10 = 0;
    }

    v11 = v10;

    if (v11)
    {
      [v11 frame];
      v13 = v12;
      v15 = v14;
      v17 = v16;
      v19 = v18;
      [(UIScrollView *)self visibleBounds];
      v107.origin.x = v20;
      v107.origin.y = v21;
      v107.size.width = v22;
      v107.size.height = v23;
      v106.origin.x = v13;
      v106.origin.y = v15;
      v106.size.width = v17;
      v106.size.height = v19;
      v24 = CGRectIntersectsRect(v106, v107);
      v25 = 0x100000000000;
      if (!v24)
      {
        v25 = 0;
      }
    }

    else
    {
      v25 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFEFFFFFFFFFFFLL | v25;
  }

  [(UIView *)self setNeedsFocusUpdate];
  [(UICollectionView *)self _suspendReloads];
  p_collectionViewFlags = &self->_collectionViewFlags;
  *(&self->_collectionViewFlags + 1) |= 0x80000000uLL;
  [(UICollectionView *)self _completeInteractiveMovementWithDisposition:2];
  [(UICollectionView *)self _clearControlledSubviewParentOverridesForReloadData];
  if (self->_firstResponderView)
  {
    *(&self->_collectionViewFlags + 4) |= 0x20000u;
    v27 = [(UIView *)self window];
    v28 = [v27 firstResponder];
    [v28 resignFirstResponder];

    *(&self->_collectionViewFlags + 4) &= ~0x20000u;
    if (self->_firstResponderView)
    {
      [(UICollectionView *)self _resumeReloads];
      *(&self->_collectionViewFlags + 1) &= ~0x80000000uLL;
      return;
    }
  }

  v29 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492328);
  if (*v29)
  {
    v86 = *(v29 + 8);
    if (os_log_type_enabled(v86, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v104 = self;
      _os_log_impl(&dword_188A29000, v86, OS_LOG_TYPE_ERROR, "[UICV %p] reloadData", buf, 0xCu);
    }
  }

  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  }

  v30 = [(UICollectionView *)self _isConnectedToDiffableDataSource];
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __30__UICollectionView_reloadData__block_invoke;
  aBlock[3] = &unk_1E70FED18;
  v101 = v30;
  aBlock[4] = self;
  v31 = _Block_copy(aBlock);
  if (v30 && dyld_program_sdk_at_least())
  {
    self->_updateAnimationCount = 0;
  }

  subviewManager = self->_subviewManager;
  v33 = _Block_copy(v31);
  [(_UICollectionViewSubviewManager *)subviewManager updateVisibleCellsUsingFilter:v33];

  v34 = self->_subviewManager;
  v98[0] = MEMORY[0x1E69E9820];
  v98[1] = 3221225472;
  v98[2] = __30__UICollectionView_reloadData__block_invoke_302;
  v98[3] = &unk_1E70FED40;
  v35 = v31;
  v99 = v35;
  if (v34)
  {
    [(_UICollectionViewSubviewCollection *)v34->_visibleViews updateSupplementariesUsingFilter:v98];
  }

  v36 = self->_subviewManager;
  v96[0] = MEMORY[0x1E69E9820];
  v96[1] = 3221225472;
  v96[2] = __30__UICollectionView_reloadData__block_invoke_2;
  v96[3] = &unk_1E70FED40;
  v37 = v35;
  v97 = v37;
  if (v36)
  {
    [(_UICollectionViewSubviewCollection *)v36->_visibleViews updateDecorationsUsingFilter:v96];
  }

  v38 = self->_selectionController;
  p_isa = &v38->super.isa;
  if (v38)
  {
    v40 = [(NSMutableSet *)v38->_selectedIndexPaths copy];
  }

  else
  {
    v40 = 0;
  }

  v89 = v37;
  if (!dyld_program_sdk_at_least() || (v30 & ((*(&self->_collectionViewFlags + 17) & 0x20) >> 5)) != 1)
  {
    goto LABEL_51;
  }

  pendingDeselectionIndexPaths = [(UICollectionView *)self _diffableDataSourceImpl];
  v42 = [pendingDeselectionIndexPaths currentTransaction];
  v43 = v42;
  if (!pendingDeselectionIndexPaths || !v42)
  {

LABEL_51:
    [(_UICollectionViewSelectionController *)p_isa reset];
    pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = 0;

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
    goto LABEL_52;
  }

  [(_UICollectionViewSelectionController *)p_isa rebaseItemsWithDiffableTransaction:v42];
  v44 = self->_pendingSelectionIndexPath;
  if (v44)
  {
    v45 = [(_UICollectionViewSelectionController *)p_isa rebaseIndexPath:v44 withDiffableTransaction:v43];
    v46 = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = v45;
  }

  if (self->_pendingDeselectionIndexPaths)
  {
    v88 = v40;
    v47 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v92 = 0u;
    v93 = 0u;
    v94 = 0u;
    v95 = 0u;
    v48 = self->_pendingDeselectionIndexPaths;
    v49 = [(NSMutableSet *)v48 countByEnumeratingWithState:&v92 objects:v102 count:16];
    if (v49)
    {
      v50 = v49;
      v51 = *v93;
      do
      {
        for (i = 0; i != v50; ++i)
        {
          if (*v93 != v51)
          {
            objc_enumerationMutation(v48);
          }

          v53 = [(_UICollectionViewSelectionController *)p_isa rebaseIndexPath:v43 withDiffableTransaction:?];
          if (v53)
          {
            [v47 addObject:v53];
          }
        }

        v50 = [(NSMutableSet *)v48 countByEnumeratingWithState:&v92 objects:v102 count:16];
      }

      while (v50);
    }

    v54 = [v47 count];
    if (v54)
    {
      v54 = [MEMORY[0x1E695DFA8] setWithArray:v47];
    }

    v40 = v88;
    p_collectionViewFlags = &self->_collectionViewFlags;
    v55 = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = v54;
  }

LABEL_52:
  if (!p_isa || ([p_isa[1] isEqualToSet:v40] & 1) == 0)
  {
    [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
  }

  [(_UICollectionViewTypeSelectController *)self->_typeSelectController reloadData];
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v91[0] = MEMORY[0x1E69E9820];
  v91[1] = 3221225472;
  v91[2] = __30__UICollectionView_reloadData__block_invoke_3;
  v91[3] = &unk_1E70F3590;
  v91[4] = self;
  [(UICollectionView *)self _invalidateWithBlock:v91];
  [(UICollectionView *)self _invalidateLayoutForReload];
  [(UICollectionView *)self _resetUpdateItemArrays];
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
  self->_indexPathsRequiringPreferredAttributes = 0;

  *(p_collectionViewFlags + 1) &= 0xFFFFFFFF3FFFFFFFLL;
  *(p_collectionViewFlags + 4) &= ~0x400000u;
  [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
  v58 = [(UICollectionView *)self _focusedItemState];
  if (v58)
  {
    v59 = v58;
    v60 = [(UICollectionView *)self _focusedItemState];
    v61 = v60;
    v62 = v60 ? *(v60 + 16) : 0;
    v63 = v62;
    v64 = [(UICollectionView *)self _indexPathIsValid:v63 allowSectionItemSentinel:1];

    if (!v64)
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }
  }

  [(UICollectionView *)self _resetPrefetchState];
  [(UICollectionView *)self _resumeReloads];
  v65 = *(p_collectionViewFlags + 1);
  if ((v65 & 0x80000000000000) != 0)
  {
    [(UIScrollView *)self setNeedsLayout];
    *(p_collectionViewFlags + 1) |= 0x100000000000000uLL;
  }

  else if ((v65 & 0x8000000000000040) == 0x40)
  {
    v66 = [(UIView *)self window];
    if (v66)
    {
      v67 = v66;
      v68 = [(UICollectionView *)self _prefetchingAllowed];

      if (v68)
      {
        block[0] = MEMORY[0x1E69E9820];
        block[1] = 3221225472;
        block[2] = __30__UICollectionView_reloadData__block_invoke_4;
        block[3] = &unk_1E70F3590;
        block[4] = self;
        dispatch_async(MEMORY[0x1E69E96A0], block);
      }
    }
  }

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController cleanupSectionFocusGuides];
  sectionFocusGuideController = self->_sectionFocusGuideController;
  v70 = [(UICollectionView *)self _focusedItemState];
  v71 = v70;
  if (v70)
  {
    v72 = *(v70 + 16);
  }

  else
  {
    v72 = 0;
  }

  v73 = v72;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v73 immediatelyReevaluatePivotIndex:0];

  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController processQueuedScrollViewRemovals];
  [(UICollectionView *)self _reconfigureSectionContainersForUpdate:0];
  [(UICollectionView *)self _processQueuedSectionContainerRemovals];
  [(UICollectionView *)self _updateSectionIndex];
  v74 = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (v74)
  {
    v75 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v76 = [(UICollectionView *)self _focusFastScrollingIndexBarEntries];
    [v75 _updateWithEntries:v76];
  }

  v77 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492330);
  if (*v77)
  {
    v87 = *(v77 + 8);
    if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v104 = self;
      _os_log_impl(&dword_188A29000, v87, OS_LOG_TYPE_ERROR, "[UICV %p] End reloadData", buf, 0xCu);
    }
  }

  v78 = self->_layout;
  v79 = self;
  v80 = &v79->super.super.super.super.isa;
  if (!v78)
  {
    goto LABEL_77;
  }

  v81 = [(UIView *)v79 effectiveUserInterfaceLayoutDirection];
  if (v81 != [(UICollectionViewLayout *)v78 developmentLayoutDirection])
  {
    v82 = [(UICollectionViewLayout *)v78 _wantsRightToLeftHorizontalMirroringIfNeeded];
    goto LABEL_76;
  }

  if ([v80 _flipsHorizontalAxis])
  {
    v82 = 0;
LABEL_76:
    [v80 _setFlipsHorizontalAxis:v82];
  }

LABEL_77:

  v83 = _Block_copy(v80[401]);
  if (v83)
  {
    v84 = v80[401];
    v80[401] = 0;

    v83[2](v83);
  }

  if ((*(p_collectionViewFlags + 8) & 0x10) != 0)
  {
    if (!dyld_program_sdk_at_least() || ([v80 window], v85 = objc_claimAutoreleasedReturnValue(), v85, v85))
    {
      [v80 layoutIfNeeded];
    }
  }
}

- (void)_invalidateLayoutForReload
{
  v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
  [v3 _setInvalidateDataSourceCounts:1];
  [v3 _setInvalidateEverything:1];
  [v3 _setIntent:3];
  [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v3];
}

- (void)_resetUpdateItemArrays
{
  insertItems = self->_insertItems;
  self->_insertItems = 0;

  deleteItems = self->_deleteItems;
  self->_deleteItems = 0;

  reloadItems = self->_reloadItems;
  self->_reloadItems = 0;

  moveItems = self->_moveItems;
  self->_moveItems = 0;

  originalDeleteItems = self->_originalDeleteItems;
  self->_originalDeleteItems = 0;

  originalInsertItems = self->_originalInsertItems;
  self->_originalInsertItems = 0;
}

- (void)_clearSpecificInvalidationLists
{
  if (a1)
  {
    v2 = a1[332];
    a1[332] = 0;

    v3 = a1[333];
    a1[333] = 0;

    v4 = a1[334];
    a1[334] = 0;
  }
}

- (void)_clearNeedsRecomputePreferredAttributesForInvalidatedElements
{
  intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
  self->_intrinsicContentSizeInvalidationContext = 0;

  *(&self->_collectionViewFlags + 4) &= 0xFFFFFE7F;
}

- (void)_resumeReloads
{
  v2 = self->_reloadingSuspendedCount - 1;
  self->_reloadingSuspendedCount = v2;
  if (!v2)
  {
    v3 = *(&self->_collectionViewFlags + 1);
    if ((v3 & 0x200) != 0)
    {
      *(&self->_collectionViewFlags + 1) = v3 & 0xFFFFFFFFFFFFFDFFLL;
      [(UICollectionView *)self reloadData];
    }

    else if ((v3 & 0x400) != 0)
    {
      [(UIScrollView *)self setNeedsLayout];
    }
  }
}

- (void)_processQueuedSectionContainerRemovals
{
  v26 = *MEMORY[0x1E69E9840];
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  obj = self->_sectionContainersQueuedForRemoval;
  v3 = [(NSMutableArray *)obj countByEnumeratingWithState:&v20 objects:v25 count:16];
  if (v3)
  {
    v4 = v3;
    v15 = *v21;
    do
    {
      for (i = 0; i != v4; ++i)
      {
        if (*v21 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v6 = *(*(&v20 + 1) + 8 * i);
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v7 = [v6 subviews];
        v8 = [v7 countByEnumeratingWithState:&v16 objects:v24 count:16];
        if (v8)
        {
          v9 = v8;
          v10 = *v17;
          do
          {
            for (j = 0; j != v9; ++j)
            {
              if (*v17 != v10)
              {
                objc_enumerationMutation(v7);
              }

              v12 = *(*(&v16 + 1) + 8 * j);
              objc_opt_class();
              if (objc_opt_isKindOfClass())
              {
                [(UICollectionView *)self _addControlledSubview:v12];
              }
            }

            v9 = [v7 countByEnumeratingWithState:&v16 objects:v24 count:16];
          }

          while (v9);
        }

        [v6 removeFromSuperview];
      }

      v4 = [(NSMutableArray *)obj countByEnumeratingWithState:&v20 objects:v25 count:16];
    }

    while (v4);
  }

  sectionContainersQueuedForRemoval = self->_sectionContainersQueuedForRemoval;
  self->_sectionContainersQueuedForRemoval = 0;
}

- (void)_updateSectionIndex
{
  if ((*(&self->_collectionViewFlags + 8) & 2) != 0)
  {
    [(UICollectionView *)self _reloadSectionIndexTitles];
  }
}

- (void)_resetPrefetchState
{
  [(UICollectionView *)self _resetPrefetchedCachedCells];

  [(UICollectionView *)self _resetAllPrefetchContexts];
}

- (void)_resetPrefetchedCachedCells
{
  v22 = *MEMORY[0x1E69E9840];
  if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_resetPrefetchedCachedCells___s_category);
    if (*CategoryCachedImpl)
    {
      v12 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        *buf = 134217984;
        v21 = self;
        _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "[UICV %p] Resetting prefetched cells", buf, 0xCu);
      }
    }

    v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableDictionary count](self->_prefetchCacheItems, "count")}];
    prefetchCacheItems = self->_prefetchCacheItems;
    v17[0] = MEMORY[0x1E69E9820];
    v17[1] = 3221225472;
    v17[2] = __47__UICollectionView__resetPrefetchedCachedCells__block_invoke;
    v17[3] = &unk_1E70FEF90;
    v6 = v4;
    v18 = v6;
    [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v17];
    [(NSMutableDictionary *)self->_prefetchCacheItems removeAllObjects];
    v15 = 0u;
    v16 = 0u;
    v13 = 0u;
    v14 = 0u;
    v7 = v6;
    v8 = [v7 countByEnumeratingWithState:&v13 objects:v19 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v14;
      do
      {
        for (i = 0; i != v9; ++i)
        {
          if (*v14 != v10)
          {
            objc_enumerationMutation(v7);
          }

          [(UICollectionView *)self _reusePrefetchedCell:*(*(&v13 + 1) + 8 * i), v13];
        }

        v9 = [v7 countByEnumeratingWithState:&v13 objects:v19 count:16];
      }

      while (v9);
    }
  }
}

- (void)_resetAllPrefetchContexts
{
  [(UICollectionView *)self _resetPrefetchingContext:self->_mainPrefetchingContext];
  orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __45__UICollectionView__resetAllPrefetchContexts__block_invoke;
  v6[3] = &unk_1E70FEFB8;
  v6[4] = self;
  [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts enumerateKeysAndObjectsUsingBlock:v6];
  mainPrefetchingContext = self->_mainPrefetchingContext;
  self->_mainPrefetchingContext = 0;

  [(NSMutableDictionary *)self->_orthogonalSectionPrefetchingContexts removeAllObjects];
  activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
  self->_activeOrthogonalPrefetchingContext = 0;
}

- (id)_dataSourceActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  return WeakRetained;
}

- (id)dragDestinationDelegate
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  return WeakRetained;
}

- (id)_dataSourceProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  }

  return WeakRetained;
}

- (void)_reloadDataIfNeeded
{
  if ((*(&self->_collectionViewFlags + 1) & 0x40000000) != 0 && !(self->_reloadingSuspendedCount | *(&self->_collectionViewFlags + 1) & 0x80000000))
  {
    [(UICollectionView *)self reloadData];
  }
}

- (BOOL)dragInteractionEnabled
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    LOBYTE(dragAndDropController) = dragAndDropController->_dragInteractionEnabled;
  }

  return dragAndDropController & 1;
}

- (void)_layoutMarginsWillChange
{
  v8 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_layoutMarginsWillChange___s_category);
  if (*CategoryCachedImpl)
  {
    v4 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v7 = self;
      _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "_layoutMarginsWillChange: cv == %p; Attempting to save anchor for change to layout margins", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _layoutMarginsWillChange];
}

- (void)_invalidateLayoutForUpdatedLayoutMarginsIfNeeded
{
  v16 = *MEMORY[0x1E69E9840];
  layout = self->_layout;
  [(UIView *)self layoutMargins];
  v4 = [(UICollectionViewLayout *)layout _invalidationContextForUpdatedLayoutMargins:?];
  if (v4)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_invalidateLayoutForUpdatedLayoutMarginsIfNeeded___s_category);
    if (*CategoryCachedImpl)
    {
      v6 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        v7 = v6;
        [(UIView *)self safeAreaInsets];
        v8 = NSStringFromUIEdgeInsets(v17);
        [(UIView *)self layoutMargins];
        v9 = NSStringFromUIEdgeInsets(v18);
        v10 = 134218498;
        v11 = self;
        v12 = 2112;
        v13 = v8;
        v14 = 2112;
        v15 = v9;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "_invalidateLayoutForUpdatedLayoutMarginsIfNeeded: cv == %p; Invalidating layout for safeAreaInsets: %@, layoutMargins: %@", &v10, 0x20u);
      }
    }

    [(UICollectionViewLayout *)self->_layout invalidateLayoutWithContext:v4];
    [(UIScrollView *)self setNeedsLayout];
  }
}

- (NSArray)indexPathsForSelectedItems
{
  v3 = [(UICollectionView *)self _indexPathsForSelectedItems];
  v4 = [(UICollectionView *)self _translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:v3];

  return v4;
}

- (id)_indexPathsForSelectedItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  v5 = [v4 allObjects];

  return v5;
}

- (id)prefetchDataSource
{
  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);

  return WeakRetained;
}

- (id)subviewRouter
{
  if (a1)
  {
    v2 = a1[374];
    if (!v2)
    {
      v2 = [[_UICollectionViewSubviewRouter alloc] initWithContainer:a1];
      objc_storeStrong(a1 + 374, v2);
    }
  }

  else
  {
    v2 = 0;
  }

  return v2;
}

- (UICollectionViewUpdateItem)_expectedDiffableUpdateItem
{
  if (dyld_program_sdk_at_least())
  {
    expectedDiffableUpdateItem = self->_expectedDiffableUpdateItem;
  }

  else
  {
    expectedDiffableUpdateItem = 0;
  }

  return expectedDiffableUpdateItem;
}

- (BOOL)_hasContentForBarInteractions
{
  collectionViewData = self->_collectionViewData;
  if (collectionViewData && collectionViewData->_totalItemCount > 0)
  {
    return 1;
  }

  v7 = v2;
  v8 = v3;
  v6.receiver = self;
  v6.super_class = UICollectionView;
  return [(UIScrollView *)&v6 _hasContentForBarInteractions];
}

- (NSInteger)numberOfSections
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  collectionViewData = self->_collectionViewData;

  return [(UICollectionViewData *)collectionViewData numberOfSections];
}

- (NSArray)indexPathsForVisibleItems
{
  v19 = *MEMORY[0x1E69E9840];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    [(UICollectionView *)self _reloadDataIfNeeded];
    v3 = [(UICollectionView *)self visibleCells];
    v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v14 = 0u;
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v5 = v3;
    v6 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v15;
      do
      {
        for (i = 0; i != v7; ++i)
        {
          if (*v15 != v8)
          {
            objc_enumerationMutation(v5);
          }

          v10 = [*(*(&v14 + 1) + 8 * i) _layoutAttributes];
          v11 = [v10 indexPath];

          v12 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v11];
          if (v12)
          {
            [v4 addObject:v12];
          }
        }

        v7 = [v5 countByEnumeratingWithState:&v14 objects:v18 count:16];
      }

      while (v7);
    }
  }

  else
  {
    v4 = [(UICollectionView *)self _indexPathsForVisibleItems];
  }

  return v4;
}

- (id)_indexPathsForVisibleItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;

  return [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleCells];
}

- (void)didMoveToWindow
{
  v13 = [(UIView *)self window];
  if (!v13)
  {
    v12 = [(UICollectionView *)self _currentTouch];

    if (v12)
    {
      [(UICollectionView *)self _cancelTouches];
    }

    if ((*(&self->_collectionViewFlags + 1) & 0x8000000000000000) != 0)
    {
      _UIUpdateCycleUnregisterIdleObserver(self);
      *(&self->_collectionViewFlags + 1) &= ~0x8000000000000000;
    }

    v9 = [(UICollectionView *)self _indexOverlayManager];
    v10 = v9;
    v11 = 0;
    goto LABEL_17;
  }

  collectionViewData = self->_collectionViewData;
  if (collectionViewData && (*&collectionViewData->_collectionViewDataFlags & 8) != 0)
  {
    [(UICollectionView *)self _updateDefaultLayoutMargins];
  }

  if ([(UICollectionView *)self _useIdleObserverForCellPrefetching]&& (*(&self->_collectionViewFlags + 1) & 0x8000000000000000) == 0)
  {
    _UIUpdateCycleRegisterIdleObserver(self);
    *(&self->_collectionViewFlags + 1) |= 0x8000000000000000;
  }

  sectionFocusGuideController = self->_sectionFocusGuideController;
  v5 = [(UICollectionView *)self _focusedItemState];
  v6 = v5;
  if (v5)
  {
    v7 = *(v5 + 16);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v8];

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController reloadSectionFocusGuides];
  if ([(UICollectionView *)self _wantsIndexOverlays])
  {
    [(UICollectionView *)self _setupIndexOverlayManagerIfNecessary];
    v9 = [(UICollectionView *)self _indexOverlayManager];
    v10 = v9;
    v11 = v13;
LABEL_17:
    [(_UICollectionTableIndexOverlayManager *)v9 hostDidMoveToWindow:v11];
  }
}

- (CGRect)_visibleBounds
{
  [(UIScrollView *)self visibleBounds];
  v4 = v3;
  v6 = v5;
  v8 = v7;
  v10 = v9;
  if ([(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
    [(UIView *)self frame];
    v13 = v12;
    v15 = v14;
    v17 = v16;
    v19 = v18;
    v20 = [(UIView *)self superview];
    [WeakRetained convertRect:v20 fromView:{v13, v15, v17, v19}];
    v22 = v21;
    v24 = v23;
    v26 = v25;
    v28 = v27;

    [WeakRetained visibleBounds];
    v55.origin.x = v22;
    v55.origin.y = v24;
    v55.size.width = v26;
    v55.size.height = v28;
    v50 = CGRectIntersection(v49, v55);
    x = v50.origin.x;
    y = v50.origin.y;
    width = v50.size.width;
    height = v50.size.height;
    if (CGRectIsEmpty(v50))
    {
      v8 = 44.0;
      v10 = 44.0;
    }

    else
    {
      [WeakRetained convertRect:self toView:{x, y, width, height}];
      v4 = v33;
      v6 = v34;
      v8 = v35;
      v10 = v36;
    }
  }

  v37 = [(UIView *)self window];
  v38 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:v37];
  v39 = [v38 scrollManager];
  v40 = [v39 isScrollingScrollableContainer:self];

  if (*(&self->_collectionViewFlags + 12) & 8) != 0 || +[UIView _isInAnimationBlock](UIView, "_isInAnimationBlock") || (([v37 isRotating] | v40))
  {
    v51.origin.x = v4;
    v51.origin.y = v6;
    v51.size.width = v8;
    v51.size.height = v10;
    if (CGRectIntersectsRect(v51, self->_visibleBounds))
    {
      v52.origin.x = v4;
      v52.origin.y = v6;
      v52.size.width = v8;
      v52.size.height = v10;
      v53 = CGRectUnion(v52, self->_visibleBounds);
      v4 = v53.origin.x;
      v6 = v53.origin.y;
      v8 = v53.size.width;
      v10 = v53.size.height;
    }
  }

  if (vmaxv_u16(vmovn_s32(vmvnq_s8(vuzp1q_s32(vceqzq_f64(*&self->_visibleRectInsets.top), vceqzq_f64(*&self->_visibleRectInsets.bottom))))))
  {
    [(UICollectionView *)self _effectiveVisibleBoundsForBounds:v4, v6, v8, v10];
    v4 = v41;
    v6 = v42;
    v8 = v43;
    v10 = v44;
  }

  v45 = v4;
  v46 = v6;
  v47 = v8;
  v48 = v10;
  result.size.height = v48;
  result.size.width = v47;
  result.origin.y = v46;
  result.origin.x = v45;
  return result;
}

- (id)_viewControllerToNotifyOnLayoutSubviews
{
  v3 = [(UIView *)self _viewControllerForAncestor];
  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) != 0 && ([v3 collectionView], v4 = objc_claimAutoreleasedReturnValue(), v4, v4 == self))
  {
    v5 = v3;
  }

  else
  {
    v8.receiver = self;
    v8.super_class = UICollectionView;
    v5 = [(UIView *)&v8 _viewControllerToNotifyOnLayoutSubviews];
  }

  v6 = v5;

  return v6;
}

- (void)layoutSubviews
{
  v23.receiver = self;
  v23.super_class = UICollectionView;
  [(UIScrollView *)&v23 layoutSubviews];
  v3 = *(&self->_collectionViewFlags + 1);
  v4 = v3 & 0x1000000020000000;
  v5 = v3 & 0x400100000000;
  if (v4 != 0x20000000 && v5 == 0)
  {
    WeakRetained = objc_loadWeakRetained(&self->_dataSource);

    if (WeakRetained)
    {
      *(&self->_collectionViewFlags + 1) |= 0x400000000000uLL;
      collectionViewData = self->_collectionViewData;
      if (collectionViewData)
      {
        v9 = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
      }

      else
      {
        LOBYTE(v9) = 0;
      }

      [(UICollectionView *)self _reloadDataIfNeeded];
      [(UICollectionView *)self _visibleBounds];
      v11 = v10;
      v13 = v12;
      v15 = v14;
      v17 = v16;
      [(UICollectionViewData *)self->_collectionViewData validateLayoutInRect:v10, v12, v14, v16];
      if ((v9 & 1) == 0)
      {
        [(UICollectionView *)self _updateDefaultLayoutMargins];
      }

      [(UICollectionView *)self _recomputePreferredAttributesForInvalidatedElementsIfNeeded];
      if ((*(&self->_collectionViewFlags + 9) & 4) != 0 && !self->_reloadingSuspendedCount)
      {
        v18 = objc_autoreleasePoolPush();
        v19 = [(UICollectionView *)self _updateVisibleCellsNow:1];
        if ([(UICollectionView *)self _prefetchingAllowed])
        {
          [(UICollectionView *)self _updatePrefetchVelocityIntegratorForVisibleBounds:v11, v13, v15, v17];
          v20 = !v19 && (*(&self->_collectionViewFlags + 1) >= 0);
          if (![(UICollectionView *)self _updatePrefetchedCells:v20]&& (*(&self->_collectionViewFlags + 15) & 1) != 0)
          {
            [(UICollectionView *)self _performReloadPrefetchIfNeeded];
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      [(UICollectionView *)self _updateBackgroundView];
      [(UICollectionView *)self _updateIndex];
      v21 = [(UIView *)self _focusSystem];
      if (v21)
      {
        v22 = *(&self->_collectionViewFlags + 1);

        if ((v22 & 0x400000000) == 0)
        {
          [(UICollectionView *)self _highlightFirstVisibleItemIfAppropriate];
        }
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFEFFBFFBFFFFFFFFLL | 0x400000000;
      [(UICollectionView *)self _updateContentFocusContainerGuides];
    }
  }
}

- (void)_updateBackgroundView
{
  [(UIView *)self bounds];
  [(UIView *)self->_backgroundView setFrame:?];
  backgroundView = self->_backgroundView;
  v4 = self->_layout;
  v5 = backgroundView;
  v6 = v5;
  if (v4)
  {
    v7 = v5 == 0;
  }

  else
  {
    v7 = 1;
  }

  if (!v7)
  {
    v8 = [(UIView *)v5 effectiveUserInterfaceLayoutDirection];
    if (v8 == [(UICollectionViewLayout *)v4 developmentLayoutDirection])
    {
      if (![(UIView *)v6 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      v9 = 0;
    }

    else
    {
      v9 = [(UICollectionViewLayout *)v4 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v6 _setFlipsHorizontalAxis:v9];
  }

LABEL_10:

  v10 = self->_backgroundView;

  [(UIScrollView *)self _moveContentSubview:v10 toBack:1];
}

- (void)_recomputePreferredAttributesForInvalidatedElementsIfNeeded
{
  v3 = self->_intrinsicContentSizeInvalidationContext;
  if (v3)
  {
    if ((*(&self->_collectionViewFlags + 16) & 0x80) != 0 && ([(UIView *)self window], v4 = objc_claimAutoreleasedReturnValue(), v4, v4))
    {
      v5 = *(&self->_collectionViewFlags + 4);
      if ((v5 & 0x100) == 0)
      {
        *(&self->_collectionViewFlags + 4) = v5 | 0x100;
        [(UIScrollView *)self setNeedsLayout];
        goto LABEL_21;
      }

      v6 = 1;
    }

    else
    {
      v6 = 0;
    }

    v7 = [(UICollectionViewLayoutInvalidationContext *)v3 invalidatedItemIndexPaths];
    v8 = [(UICollectionViewLayoutInvalidationContext *)v3 invalidatedSupplementaryIndexPaths];
    if ([v7 count] || objc_msgSend(v8, "count"))
    {
      v28[0] = MEMORY[0x1E69E9820];
      v28[1] = 3221225472;
      v28[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke;
      v28[3] = &unk_1E70F6228;
      v28[4] = self;
      v29 = v7;
      v30 = v8;
      if (v6)
      {
        v9 = self->_collectionViewData;
        [(UICollectionView *)self _visibleBounds];
        [(UICollectionViewData *)v9 validateLayoutInRect:v10, v11, v12, v13];
        if (v9)
        {
          *&v9->_collectionViewDataFlags |= 0x10u;
        }

        v14 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
        collectionViewData = self->_collectionViewData;
        self->_collectionViewData = v14;

        v26[0] = 0;
        v26[1] = v26;
        v26[2] = 0x3032000000;
        v26[3] = __Block_byref_object_copy__39;
        v26[4] = __Block_byref_object_dispose__39;
        v27 = 0;
        v16 = dyld_program_sdk_at_least();
        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_3;
        v22[3] = &unk_1E70FF868;
        v24 = v26;
        v25 = v28;
        if (v16)
        {
          v17 = 6;
        }

        else
        {
          v17 = 4;
        }

        v22[4] = self;
        v18 = v9;
        v23 = v18;
        v21[0] = MEMORY[0x1E69E9820];
        v21[1] = 3221225472;
        v21[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_4;
        v21[3] = &unk_1E70FF890;
        v21[4] = self;
        v21[5] = v26;
        [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v17 options:v22 animations:v21 completion:?];

        _Block_object_dispose(v26, 8);
      }

      else
      {
        __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke(v28);
      }

      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
      v19 = *(&self->_collectionViewFlags + 4);
      *(&self->_collectionViewFlags + 4) = v19 & 0xFFFFF9FF | ((((v19 + 512) >> 9) & 3) << 9);
      if ((v19 & 0x600) == 0)
      {
        v20[0] = MEMORY[0x1E69E9820];
        v20[1] = 3221225472;
        v20[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_5;
        v20[3] = &unk_1E70F3590;
        v20[4] = self;
        [UIApp _performBlockAfterCATransactionCommits:v20];
      }
    }

    else
    {
      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
    }
  }

LABEL_21:
}

- (void)_safeAreaInsetsWillChange
{
  v8 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_safeAreaInsetsWillChange___s_category);
  if (*CategoryCachedImpl)
  {
    v4 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v7 = self;
      _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "_safeAreaInsetsWillChange: cv == %p; Attempting to save anchor for change to safe area", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _safeAreaInsetsWillChange];
}

- (void)_notifyDidScroll
{
  if (self->_didScrollNotificationSuspensionCount <= 0)
  {
    v5 = v2;
    v6 = v3;
    v4.receiver = self;
    v4.super_class = UICollectionView;
    [(UIScrollView *)&v4 _notifyDidScroll];
  }
}

- (void)_clearTargetIndexPathForScrolling
{
  scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
  self->_scrollingTargetIndexPath = 0;

  self->_offsetToScrollingTarget = *MEMORY[0x1E695EFF8];
  v4 = *(MEMORY[0x1E695F058] + 16);
  self->_scrollingTargetFrame.origin = *MEMORY[0x1E695F058];
  self->_scrollingTargetFrame.size = v4;
  self->_requestedPositionOfScrollingTarget = 0;
  *(&self->_collectionViewFlags + 4) &= ~0x10000u;
}

- (void)_layoutSectionContainerViews
{
  sectionToContainerViewMap = self->_sectionToContainerViewMap;
  v3[0] = MEMORY[0x1E69E9820];
  v3[1] = 3221225472;
  v3[2] = __48__UICollectionView__layoutSectionContainerViews__block_invoke;
  v3[3] = &unk_1E70FEDB8;
  v3[4] = self;
  [(NSMutableDictionary *)sectionToContainerViewMap enumerateKeysAndObjectsUsingBlock:v3];
}

- (BOOL)_useIdleObserverForCellPrefetching
{
  v2 = _UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewCellPrefetchingMode, @"CollectionViewCellPrefetchingMode", _UIInternalPreferenceUpdateInteger);
  v3 = qword_1ED48AAD0;
  if (v2)
  {
    v3 = 0;
  }

  if (v3 >= 0xFFFFFFFFFFFFFFFELL)
  {
    return 0;
  }

  if (v3 == 1)
  {
    return 1;
  }

  return dyld_program_sdk_at_least();
}

- (void)_processViewSpecificInvalidationsForVisibleViews
{
  v44 = *MEMORY[0x1E69E9840];
  v3 = self->_invalidatedItemIndexPaths;
  invalidatedItemIndexPaths = self->_invalidatedItemIndexPaths;
  self->_invalidatedItemIndexPaths = 0;

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  obj = v3;
  v5 = [(NSMutableSet *)obj countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (v5)
  {
    v6 = v5;
    v31 = *v39;
    do
    {
      v7 = 0;
      do
      {
        if (*v39 != v31)
        {
          objc_enumerationMutation(obj);
        }

        v8 = *(*(&v38 + 1) + 8 * v7);
        v34 = 0u;
        v35 = 0u;
        v36 = 0u;
        v37 = 0u;
        v9 = [(UICollectionView *)self _reorderedItems];
        v10 = [v9 countByEnumeratingWithState:&v34 objects:v42 count:16];
        if (v10)
        {
          v11 = v10;
          v12 = *v35;
          while (2)
          {
            for (i = 0; i != v11; ++i)
            {
              if (*v35 != v12)
              {
                objc_enumerationMutation(v9);
              }

              v14 = [*(*(&v34 + 1) + 8 * i) targetIndexPath];
              v15 = [v14 isEqual:v8];

              if (v15)
              {
                v16 = 1;
                goto LABEL_16;
              }
            }

            v11 = [v9 countByEnumeratingWithState:&v34 objects:v42 count:16];
            if (v11)
            {
              continue;
            }

            break;
          }
        }

        v16 = 0;
LABEL_16:

        v17 = [(UICollectionView *)self _visibleCellForIndexPath:v8];
        if (v17)
        {
          v18 = v17;
          [v17 _invalidatePreferredAttributes];
          v19 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v8];
          if (v19)
          {
            v20 = v19;
            [(UICollectionView *)self _checkForPreferredAttributesInView:v18 originalAttributes:v19];
            if ((v16 & 1) == 0)
            {
              [(UICollectionView *)self _applyLayoutAttributes:v20 toView:v18];
            }
          }

          else
          {
            if (([v18 _isInUpdateAnimation] & 1) == 0)
            {
              v22 = [MEMORY[0x1E696AAA8] currentHandler];
              v23 = [v8 _ui_shortDescription];
              v24 = [(UICollectionViewLayout *)self->_layout layoutAttributesForItemAtIndexPath:v8];
              v25 = [v18 _layoutAttributes];
              v26 = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
              [v22 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6380 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated item. Index path: %@; cell: %@; attributes from layout: %@; attributes from cell: %@; collection view: %@; data source counts: %@.", v23, v18, v24, v25, self, v26}];
            }

            v20 = 0;
          }
        }

        else
        {
          v21 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v8];
          v20 = v21;
          if (v21)
          {
            *(v21 + 8) |= 3u;
          }
        }

        ++v7;
      }

      while (v7 != v6);
      v6 = [(NSMutableSet *)obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    }

    while (v6);
  }

  invalidatedSupplementaryIndexPaths = self->_invalidatedSupplementaryIndexPaths;
  v33[0] = MEMORY[0x1E69E9820];
  v33[1] = 3221225472;
  v33[2] = __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke;
  v33[3] = &unk_1E70FF190;
  v33[4] = self;
  v33[5] = a2;
  [(NSMutableDictionary *)invalidatedSupplementaryIndexPaths enumerateKeysAndObjectsUsingBlock:v33];
  invalidatedDecorationIndexPaths = self->_invalidatedDecorationIndexPaths;
  v32[0] = MEMORY[0x1E69E9820];
  v32[1] = 3221225472;
  v32[2] = __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke_2;
  v32[3] = &unk_1E70FF190;
  v32[4] = self;
  v32[5] = a2;
  [(NSMutableDictionary *)invalidatedDecorationIndexPaths enumerateKeysAndObjectsUsingBlock:v32];
}

- (void)_clearContentOffsetRestorationAnchor
{
  contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
  self->_contentOffsetRestorationAnchor = 0;

  self->_offsetToContentOffsetRestorationAnchor = *MEMORY[0x1E695EFF8];
}

- (void)_setUpCompletionHandlerForAnimationInterruptionIfNecessary
{
  if (+[UIView _isInAnimationBlockWithAnimationsEnabled])
  {
    v3[0] = MEMORY[0x1E69E9820];
    v3[1] = 3221225472;
    v3[2] = __78__UICollectionView__setUpCompletionHandlerForAnimationInterruptionIfNecessary__block_invoke;
    v3[3] = &unk_1E70F5AC0;
    v3[4] = self;
    [UIView _addCompletion:v3];
  }
}

- (BOOL)_prefetchingAllowed
{
  if (_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewCellPrefetchingMode, @"CollectionViewCellPrefetchingMode", _UIInternalPreferenceUpdateInteger))
  {
    v3 = 0;
  }

  else
  {
    v3 = qword_1ED48AAD0;
  }

  if (v3 == -2)
  {
    return 0;
  }

  if (v3 != 1 && (*(&self->_collectionViewFlags + 4) & 1) == 0)
  {
    return 0;
  }

  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    if ([(NSMutableArray *)dragAndDropController->__reorderedItems count])
    {
      return 0;
    }
  }

  if ([(UICollectionView *)self hasActiveDrop])
  {
    return 0;
  }

  if (v3 == 1)
  {
    return 1;
  }

  v7 = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  v8 = dyld_program_sdk_at_least();
  if (v8 && v7)
  {
    LOBYTE(v8) = [(UICollectionViewLayout *)self->_layout _supportsPrefetchingWithEstimatedSizes];
  }

  if (v3 != -1 && (v8 & 1) != 0)
  {
    return 1;
  }

  return dyld_program_sdk_at_least() & !v7;
}

- (void)_resumeDidScrollNotifications
{
  v24 = *MEMORY[0x1E69E9840];
  if (a1)
  {
    v2 = *(a1 + 363);
    if (v2 <= 0)
    {
      if (os_variant_has_internal_diagnostics())
      {
        v11 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
        {
          v18 = 138412290;
          v19 = a1;
          _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "Unbalanced calls to suspend/resumeDidScrollNotifications for collection view %@.", &v18, 0xCu);
        }
      }

      else
      {
        v10 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924C0) + 8);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
        {
          v18 = 138412290;
          v19 = a1;
          _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "Unbalanced calls to suspend/resumeDidScrollNotifications for collection view %@.", &v18, 0xCu);
        }
      }
    }

    else
    {
      v3 = v2 - 1;
      *(a1 + 363) = v3;
      if (!v3)
      {
        [(CGFloat *)a1 contentOffset];
        v6 = v5;
        v7 = v4;
        if (a1[361] != v5 || a1[362] != v4)
        {
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4924C8);
          if (*CategoryCachedImpl)
          {
            v12 = *(CategoryCachedImpl + 8);
            if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
            {
              v13 = a1[361];
              v14 = a1[362];
              v15 = v12;
              v25.x = v13;
              v25.y = v14;
              v16 = NSStringFromCGPoint(v25);
              v26.x = v6;
              v26.y = v7;
              v17 = NSStringFromCGPoint(v26);
              v18 = 134218498;
              v19 = a1;
              v20 = 2112;
              v21 = v16;
              v22 = 2112;
              v23 = v17;
              _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "cv == %p notifying didScroll for change in content offset from %@ to %@", &v18, 0x20u);
            }
          }

          [(CGFloat *)a1 _notifyDidScroll];
        }
      }
    }
  }
}

- (void)_ensureFocusedViewIsNotHidden
{
  v43 = *MEMORY[0x1E69E9840];
  v3 = [(UICollectionView *)self _focusedItemState];
  v4 = v3;
  if (v3)
  {
    v5 = *(v3 + 8);
  }

  else
  {
    v5 = 0;
  }

  v6 = v5;

  if (v6)
  {
    layout = self->_layout;
    v8 = [v6 _layoutAttributes];
    [v6 frame];
    [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v8 frame:?];
    v10 = v9;
    v12 = v11;
    v14 = v13;
    v16 = v15;

    if ([v6 _isHiddenForReuse])
    {
      [(UICollectionView *)self _visibleBounds];
      x = v44.origin.x;
      y = v44.origin.y;
      width = v44.size.width;
      height = v44.size.height;
      if (!CGRectIsNull(v44))
      {
        v45.origin.x = v10;
        v45.origin.y = v12;
        v45.size.width = v14;
        v45.size.height = v16;
        if (!CGRectIsNull(v45))
        {
          v46.origin.x = x;
          v46.origin.y = y;
          v46.size.width = width;
          v46.size.height = height;
          v47 = CGRectStandardize(v46);
          v21 = v47.origin.x;
          v22 = v47.origin.y;
          v23 = v47.size.width;
          v24 = v47.size.height;
          v47.origin.x = v10;
          v47.origin.y = v12;
          v47.size.width = v14;
          v47.size.height = v16;
          v48 = CGRectStandardize(v47);
          v25 = v48.origin.x;
          v26 = v48.origin.y;
          v27 = v48.size.width;
          v28 = v48.size.height;
          v39 = v22;
          v40 = v21;
          v48.origin.x = v21;
          v48.origin.y = v22;
          v48.size.width = v23;
          v48.size.height = v24;
          v29 = CGRectGetMinX(v48) + 0.0001;
          v49.origin.x = v25;
          v49.origin.y = v26;
          v49.size.width = v27;
          v49.size.height = v28;
          if (v29 <= CGRectGetMaxX(v49))
          {
            v50.origin.y = v39;
            v50.origin.x = v21;
            v50.size.width = v23;
            v50.size.height = v24;
            v31 = CGRectGetMaxX(v50) + -0.0001;
            v51.origin.x = v25;
            v51.origin.y = v26;
            v51.size.width = v27;
            v51.size.height = v28;
            v30 = v31 >= CGRectGetMinX(v51);
          }

          else
          {
            v30 = 0;
          }

          v52.origin.x = v21;
          v52.origin.y = v39;
          v52.size.width = v23;
          v52.size.height = v24;
          v32 = CGRectGetMinY(v52) + 0.0001;
          v53.origin.x = v25;
          v53.origin.y = v26;
          v53.size.width = v27;
          v53.size.height = v28;
          if (v32 <= CGRectGetMaxY(v53))
          {
            v54.origin.x = v40;
            v54.origin.y = v39;
            v54.size.width = v23;
            v54.size.height = v24;
            v33 = CGRectGetMaxY(v54) + -0.0001;
            v55.origin.x = v25;
            v55.origin.y = v26;
            v55.size.width = v27;
            v55.size.height = v28;
            if (v33 >= CGRectGetMinY(v55) && v30)
            {
              has_internal_diagnostics = os_variant_has_internal_diagnostics();
              v36 = [(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:v6];
              if (has_internal_diagnostics)
              {
                if (v36)
                {
                  v37 = __UIFaultDebugAssertLog();
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_FAULT))
                  {
                    *buf = 138412290;
                    v42 = v6;
                    _os_log_fault_impl(&dword_188A29000, v37, OS_LOG_TYPE_FAULT, "Making focused cell visible that is still in the reuse queue: %@", buf, 0xCu);
                  }
                }
              }

              else if (v36)
              {
                v38 = *(__UILogGetCategoryCachedImpl("Assert", &_ensureFocusedViewIsNotHidden___s_category) + 8);
                if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138412290;
                  v42 = v6;
                  _os_log_impl(&dword_188A29000, v38, OS_LOG_TYPE_ERROR, "Making focused cell visible that is still in the reuse queue: %@", buf, 0xCu);
                }
              }

              [v6 _setHiddenForReuse:0];
            }
          }
        }
      }
    }
  }
}

- (BOOL)hasActiveDrop
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    return [(_UICollectionViewDragDestinationController *)&dragAndDropController->_destinationController->super.isa isActive];
  }

  else
  {
    return 0;
  }
}

- (BOOL)canBeEdited
{
  if (dyld_program_sdk_at_least())
  {
    return 1;
  }

  v4 = [(UICollectionView *)self collectionViewLayout];
  v5 = [v4 canBeEdited];

  return v5;
}

- (BOOL)_allowsEffectiveSelection
{
  if ([(UICollectionView *)self _isEditing])
  {

    return [(UICollectionView *)self allowsSelectionDuringEditing];
  }

  else
  {

    return [(UICollectionView *)self allowsSelection];
  }
}

- (void)_layoutAdjustmentsDidChange
{
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 _layoutAdjustmentsDidChange];
  [(UICollectionViewLayout *)self->_layout _scrollViewLayoutAdjustmentsChanged];
}

- (void)_updateDefaultLayoutMargins
{
  v3 = [(UICollectionView *)self collectionViewLayout];
  [v3 _preferredLayoutMargins];
  v5 = v4;
  v7 = v6;
  v9 = v8;
  v11 = v10;

  if (v5 == 1.79769313e308)
  {
    v12 = 8.0;
  }

  else
  {
    v12 = v5;
  }

  if (v7 == 1.79769313e308)
  {
    v13 = 8.0;
  }

  else
  {
    v13 = v7;
  }

  if (v9 == 1.79769313e308)
  {
    v14 = 8.0;
  }

  else
  {
    v14 = v9;
  }

  if (v11 == 1.79769313e308)
  {
    v15 = 8.0;
  }

  else
  {
    v15 = v11;
  }

  [(UICollectionView *)self _setDefaultLayoutMargins:0 fromViewController:v12, v13, v14, v15];
}

- (NSArray)visibleCells
{
  [(UICollectionView *)self _reloadDataIfNeeded];

  return [(UICollectionView *)self _existingVisibleCells];
}

- (id)_dataSourceSectionIndexTitles
{
  indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
  if (!indexBarSectionIndexTitles)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x2000000000000000) != 0)
    {
      v5 = [(UICollectionView *)self _dataSourceProxy];
      v6 = [v5 _collectionView:self sectionIndexTitlesTrimmedToCount:0x7FFFFFFFFFFFFFFFLL];
    }

    else if ((collectionViewFlags & 0x1000000000000000) != 0)
    {
      v5 = [(UICollectionView *)self _dataSourceProxy];
      v6 = [v5 _sectionIndexTitlesForCollectionView:self];
    }

    else
    {
      if ((*(&self->_collectionViewFlags + 8) & 2) == 0)
      {
        v5 = 0;
        self->_indexBarSectionIndexTitles = MEMORY[0x1E695E0F0];
LABEL_10:

        indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
        goto LABEL_11;
      }

      v5 = [(UICollectionView *)self _dataSourceProxy];
      v6 = [v5 indexTitlesForCollectionView:self];
    }

    v7 = self->_indexBarSectionIndexTitles;
    self->_indexBarSectionIndexTitles = v6;

    goto LABEL_10;
  }

LABEL_11:
  v8 = indexBarSectionIndexTitles;

  return v8;
}

- (CGSize)intrinsicContentSize
{
  if ([(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    layout = self->_layout;

    [(UICollectionViewLayout *)layout collectionViewContentSize];
  }

  else
  {
    v6.receiver = self;
    v6.super_class = UICollectionView;
    [(UIView *)&v6 intrinsicContentSize];
  }

  result.height = v5;
  result.width = v4;
  return result;
}

- (void)_updateIndex
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v3 = *(&self->_collectionViewFlags + 1);
  if ((v3 & 0x200000000000000) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v3 | 0x200000000000000;
    v5 = [(UICollectionView *)self _indexBarEntries];
    if ([v5 count])
    {
      v6 = [(UIScrollView *)self _staticScrollBar];
    }

    else
    {
      v7 = *p_collectionViewFlags;
      v8 = [(UIScrollView *)self _staticScrollBar];
      v6 = v8;
      if ((v7 & 0x1000000000000000) == 0)
      {
        if (v8)
        {
          [v8 setShowIndexBar:0];
        }

        [(UICollectionView *)self _removeStandaloneIndexBarIfNecessary];
        goto LABEL_16;
      }
    }

    if (v6)
    {
      [v6 setShowIndexBar:1];
      v9 = [v6 indexBarView];
      [(UICollectionView *)self _removeStandaloneIndexBarIfNecessary];
    }

    else
    {
      indexBar = self->_indexBar;
      if (indexBar)
      {
        v9 = indexBar;
      }

      else
      {
        v16 = 0;
        v17 = 0;
        v11 = [(UIView *)self traitCollection];
        [UIIndexBarAccessoryView makeIndexBarView:&v17 scrollAccessoryContainerView:&v16 forTraits:v11];
        v12 = v17;
        v9 = v17;
        v13 = v16;

        [(UIScrollView *)self setAccessoryView:v13 atEdge:1];
        objc_storeStrong(&self->_indexBar, v12);
      }
    }

    [(UIIndexBarView *)v9 setDelegate:self];
    [(UIIndexBarAccessoryView *)v9 setEntries:v5];
    [(UIIndexBarView *)v9 setDrawingInsets:0.0, 0.0, 0.0, 0.0];
    v14 = [(UICollectionView *)self _indexOverlayManager];
    v15 = v14;
    if (v14)
    {
      [*(v14 + 24) reloadData];
    }

LABEL_16:
  }
}

- (id)_indexBarEntries
{
  if ((*(&self->_collectionViewFlags + 7) & 0x10) != 0 || (*(&self->_collectionViewFlags + 8) & 2) != 0)
  {
    v4 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    if ([v4 count])
    {
      v5 = objc_alloc_init(MEMORY[0x1E695DF70]);
      v10[0] = MEMORY[0x1E69E9820];
      v10[1] = 3221225472;
      v10[2] = __36__UICollectionView__indexBarEntries__block_invoke;
      v10[3] = &unk_1E70FF4D0;
      v10[4] = self;
      v6 = v5;
      v11 = v6;
      [v4 enumerateObjectsUsingBlock:v10];
      v7 = v11;
      v3 = v6;
    }

    else
    {
      v12.receiver = self;
      v12.super_class = UICollectionView;
      v3 = [(UIScrollView *)&v12 _indexBarEntries];
    }
  }

  else
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    v3 = [(UIScrollView *)&v9 _indexBarEntries];
  }

  return v3;
}

- (void)_removeStandaloneIndexBarIfNecessary
{
  v3 = self->_indexBar;
  if (v3)
  {
    v7 = v3;
    v4 = [(UIScrollView *)self accessoryViewAtEdge:1];
    v5 = [(UIView *)v7 isDescendantOfView:v4];

    if (v5)
    {
      [(UIScrollView *)self setAccessoryView:0 atEdge:1];
    }

    indexBar = self->_indexBar;
    self->_indexBar = 0;

    v3 = v7;
  }
}

- (void)_reloadSectionIndexTitles
{
  *(&self->_collectionViewFlags + 1) &= ~0x200000000000000uLL;
  indexBarSectionIndexTitles = self->_indexBarSectionIndexTitles;
  self->_indexBarSectionIndexTitles = 0;

  [(UICollectionView *)self _updateIndex];
}

- (id)preparedCells
{
  v3 = [(UICollectionView *)self visibleCells];
  v4 = [v3 mutableCopy];

  prefetchCacheItems = self->_prefetchCacheItems;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __33__UICollectionView_preparedCells__block_invoke;
  v8[3] = &unk_1E70FEF90;
  v6 = v4;
  v9 = v6;
  [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v8];

  return v6;
}

- (id)_existingVisibleCells
{
  v32 = *MEMORY[0x1E69E9840];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    [(UICollectionView *)self _visibleBounds];
    v4 = v3;
    v6 = v5;
    v8 = v7;
    v10 = v9;
    v11 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCells];
    v12 = [v11 mutableCopy];

    v13 = objc_alloc_init(MEMORY[0x1E696AD50]);
    v27 = 0u;
    v28 = 0u;
    v29 = 0u;
    v30 = 0u;
    obj = v12;
    v14 = [obj countByEnumeratingWithState:&v27 objects:v31 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = 0;
      v17 = *v28;
      do
      {
        for (i = 0; i != v15; ++i)
        {
          if (*v28 != v17)
          {
            objc_enumerationMutation(obj);
          }

          v19 = *(*(&v27 + 1) + 8 * i);
          v20 = [v19 _layoutAttributes];
          v21 = [v20 indexPath];
          v22 = [(UICollectionView *)self _indexPathBeforeShadowUpdatesForIndexPath:v21];

          if (!v22)
          {
            [v13 addIndex:v16];
          }

          v23 = [v19 _layoutAttributes];
          layout = self->_layout;
          [v23 frame];
          [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v23 frame:?];
          v35.origin.x = v4;
          v35.origin.y = v6;
          v35.size.width = v8;
          v35.size.height = v10;
          if (!CGRectIntersectsRect(v34, v35))
          {
            [v13 addIndex:v16];
          }

          ++v16;
        }

        v15 = [obj countByEnumeratingWithState:&v27 objects:v31 count:16];
      }

      while (v15);
    }

    [obj removeObjectsAtIndexes:v13];
  }

  else
  {
    obj = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCells];
  }

  return obj;
}

- (BOOL)_dataSourceImplementsReorderingHandlers
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    v3 = [(UICollectionView *)self _diffableDataSourceImpl];
    v4 = [v3 reorderingHandlers];
    v5 = [v4 canReorderItemHandler];

    v6 = [v3 canReorderItemHandler];
    if (v6)
    {
      v7 = [v3 didApplySnapshotHandler];
      v8 = v7 != 0;
    }

    else
    {
      v8 = 0;
    }

    v2 = v5 != 0 || v8;
  }

  else
  {
    return 0;
  }

  return v2;
}

- (void)_setupCellAnimations
{
  v8 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  if ((*(&self->_collectionViewFlags + 12) & 0x40) != 0)
  {
    if (os_variant_has_internal_diagnostics())
    {
      v5 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v5, OS_LOG_TYPE_FAULT))
      {
        v6 = 138412290;
        v7 = self;
        _os_log_fault_impl(&dword_188A29000, v5, OS_LOG_TYPE_FAULT, "UICollectionView client error: attempting to perform update while UICollectionView is updating its visible views. This will result in undefined behavior. Collection view: %@", &v6, 0xCu);
      }
    }

    else
    {
      v4 = *(__UILogGetCategoryCachedImpl("Assert", &_setupCellAnimations___s_category) + 8);
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        v6 = 138412290;
        v7 = self;
        _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "UICollectionView client error: attempting to perform update while UICollectionView is updating its visible views. This will result in undefined behavior. Collection view: %@", &v6, 0xCu);
      }
    }
  }

  [(UICollectionViewLayout *)self->_layout _collectionViewWillPerformPendingLayoutBeforeUpdate];
  [(UICollectionView *)self _updateVisibleCellsNow:0];
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  *(p_collectionViewFlags + 1) |= 0x1000000000uLL;
  [(UICollectionView *)self _suspendReloads];
}

- (void)_beginUpdates
{
  updateCount = self->_updateCount;
  if (!updateCount)
  {
    [(UICollectionView *)self _setupCellAnimations];
    updateCount = self->_updateCount;
  }

  self->_updateCount = updateCount + 1;
}

- (id)_sortedDeduplicatedReloadItems
{
  v19 = *MEMORY[0x1E69E9840];
  v2 = self->_reloadItems;
  v3 = v2;
  if (v2)
  {
    if ([(NSMutableArray *)v2 count]> 1)
    {
      v4 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableArray count](v3, "count")}];
      v5 = [objc_alloc(MEMORY[0x1E695DFA8]) initWithCapacity:{-[NSMutableArray count](v3, "count")}];
      v14 = 0u;
      v15 = 0u;
      v16 = 0u;
      v17 = 0u;
      v6 = v3;
      v7 = [(NSMutableArray *)v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
      if (v7)
      {
        v8 = v7;
        v9 = *v15;
        do
        {
          for (i = 0; i != v8; ++i)
          {
            if (*v15 != v9)
            {
              objc_enumerationMutation(v6);
            }

            v11 = *(*(&v14 + 1) + 8 * i);
            v12 = [(UICollectionViewUpdateItem *)v11 _indexPath];
            if (([v5 containsObject:{v12, v14}] & 1) == 0)
            {
              [v5 addObject:v12];
              [v4 insertObject:v11 atIndex:{objc_msgSend(v4, "indexOfObject:inSortedRange:options:usingComparator:", v11, 0, objc_msgSend(v4, "count"), 1024, &__block_literal_global_763)}];
            }
          }

          v8 = [(NSMutableArray *)v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
        }

        while (v8);
      }
    }

    else
    {
      v4 = [(NSMutableArray *)v3 mutableCopy];
    }
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (BOOL)_isFirstResponderInDeletedSectionOrItem
{
  if (self->_firstResponderView)
  {
    firstResponderIndexPath = self->_firstResponderIndexPath;
    if (firstResponderIndexPath)
    {
      currentUpdate = self->_currentUpdate;
      if (currentUpdate)
      {
        if (self->_firstResponderViewType == 1)
        {
          v5 = [(UICollectionViewUpdate *)currentUpdate finalIndexPathForInitialIndexPath:?];
        }

        else
        {
          v7 = [(NSIndexPath *)firstResponderIndexPath length];
          v8 = self->_currentUpdate;
          if (v7 == 1)
          {
            v9 = [(NSMutableDictionary *)v8->_deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:self->_firstResponderViewKind];
            v6 = [v9 containsIndex:{-[NSIndexPath indexAtPosition:](self->_firstResponderIndexPath, "indexAtPosition:", 0)}];
LABEL_11:

            return v6;
          }

          v5 = [(UICollectionViewUpdate *)v8 validatedNewIndexPathForSupplementaryElementOfKind:self->_firstResponderIndexPath oldIndexPath:?];
        }

        v9 = v5;
        v6 = v5 == 0;
        goto LABEL_11;
      }
    }
  }

  return 0;
}

- (BOOL)_isReordering
{
  if (self)
  {
    dragAndDropController = self->_dragAndDropController;
    if (dragAndDropController)
    {
      LOBYTE(self) = [(NSMutableArray *)dragAndDropController->__reorderedItems count]!= 0;
    }

    else
    {
      LOBYTE(self) = 0;
    }
  }

  return self;
}

- (id)_subviewManager
{
  if (a1)
  {
    a1 = a1[373];
    v1 = vars8;
  }

  return a1;
}

- (BOOL)_hasCustomBackground
{
  if ((*(&self->_collectionViewFlags + 12) & 0x80) != 0)
  {
    return 1;
  }

  v2 = [(UICollectionView *)self backgroundView];
  v3 = v2 != 0;

  return v3;
}

- (id)_diffableDataSourceImpl
{
  v3 = [(UICollectionView *)self _dataSourceActual];
  v4 = 0;
  if ((objc_opt_respondsToSelector() & 1) != 0 && v3 != self)
  {
    v4 = [(UICollectionView *)v3 _diffableDataSourceImpl];
  }

  return v4;
}

- (void)_updatePreferredAttributesForCurrentUpdate
{
  v8 = *MEMORY[0x1E69E9840];
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    if (self->_currentUpdate)
    {
      if ([(UICollectionViewLayout *)self->_layout _needsRecomputeOfPreferredAttributesForVisibleEstimatedItemsDuringUpdate])
      {
        if (![(UICollectionView *)self _isReordering])
        {
          indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
          self->_indexPathsRequiringPreferredAttributes = 0;

          [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate:0];
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_updatePreferredAttributesForCurrentUpdate___s_category);
          if (*CategoryCachedImpl)
          {
            v5 = *(CategoryCachedImpl + 8);
            if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
            {
              v6 = 134217984;
              v7 = self;
              _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePreferredAttributesForCurrentUpdate finished", &v6, 0xCu);
            }
          }
        }
      }
    }
  }
}

- (BOOL)canBecomeFirstResponder
{
  v3 = [(UIView *)self window];
  if (v3)
  {
    v4 = v3;
    v5 = [(UIView *)self window];
    v6 = [v5 screen];
    v7 = [v6 _userInterfaceIdiom];

    if (v7 == 3)
    {
      return 1;
    }
  }

  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    if (typeSelectController->_enabled && [(_UITypeSelectInteraction *)typeSelectController->_typeSelectInteraction canBecomeFirstResponder])
    {
      return 1;
    }
  }

  v10.receiver = self;
  v10.super_class = UICollectionView;
  return [(UIResponder *)&v10 canBecomeFirstResponder];
}

uint64_t __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v27 = *MEMORY[0x1E69E9840];
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v25 = 0u;
  v5 = [a3 copy];
  v6 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v23;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v23 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v22 + 1) + 8 * i);
        v11 = [*(a1 + 32) _visibleSupplementaryViewOfKind:a2 atIndexPath:v10];
        v12 = v11;
        if (v11)
        {
          [v11 _invalidatePreferredAttributes];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForSupplementaryElementOfKind:a2 atIndexPath:v10];
          if (v13)
          {
            [*(a1 + 32) _checkForPreferredAttributesInView:v12 originalAttributes:v13];
            [*(a1 + 32) _applyLayoutAttributes:v13 toView:v12];
          }

          else if (([v12 _isInUpdateAnimation] & 1) == 0)
          {
            v20 = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = *(a1 + 32);
            v18 = *(a1 + 40);
            v19 = [v10 _ui_shortDescription];
            v14 = [*(*(a1 + 32) + 2152) layoutAttributesForSupplementaryViewOfKind:a2 atIndexPath:v10];
            v16 = [v12 _layoutAttributes];
            [v20 handleFailureInMethod:v18 object:v17 file:@"UICollectionView.m" lineNumber:6407 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated supplementary view. Element kind: %@; index path: %@; supplementary view: %@; attributes from layout: %@; attributes from view: %@; collection view: %@", a2, v19, v12, v14, v16, *(a1 + 32)}];
          }
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v7);
  }

  return [a3 removeAllObjects];
}

- (id)_delegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->super._delegate);
  }

  return WeakRetained;
}

- (void)_setNeedsRecomputePreferredAttributesForInvalidatedElements
{
  if (!self->_intrinsicContentSizeInvalidationContext)
  {
    v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
    self->_intrinsicContentSizeInvalidationContext = v3;

    [(UIScrollView *)self setNeedsLayout];
  }

  if (+[UIView areAnimationsEnabled]| ((*(&self->_collectionViewFlags + 4) & 0x80u) >> 7))
  {
    v5 = 128;
  }

  else
  {
    v5 = 0;
  }

  *(&self->_collectionViewFlags + 4) = v5 | *(&self->_collectionViewFlags + 4) & 0xFFFFFF7F;
}

uint64_t __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke(uint64_t a1)
{
  v18 = *MEMORY[0x1E69E9840];
  [*(a1 + 32) _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  v15 = 0u;
  v16 = 0u;
  v13 = 0u;
  v14 = 0u;
  v2 = *(a1 + 40);
  v3 = [v2 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v3)
  {
    v4 = v3;
    v5 = *v14;
    do
    {
      for (i = 0; i != v4; ++i)
      {
        if (*v14 != v5)
        {
          objc_enumerationMutation(v2);
        }

        v7 = *(*(&v13 + 1) + 8 * i);
        if ([*(a1 + 32) _indexPathIsValid:v7])
        {
          v8 = [*(a1 + 32) _cellForItemAtIndexPath:v7];
          v9 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v7];
          [*(a1 + 32) _recomputePreferredAttributesForInvalidatedView:v8 originalAttributes:v9];
        }
      }

      v4 = [v2 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v4);
  }

  v10 = *(a1 + 48);
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_2;
  v12[3] = &unk_1E70FA680;
  v12[4] = *(a1 + 32);
  [v10 enumerateKeysAndObjectsUsingBlock:v12];
  return [*(a1 + 32) _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
}

void __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_3(void *a1)
{
  (*(a1[7] + 16))();
  v2 = a1[4];
  if ((v2[2729] & 4) != 0)
  {
    v3 = [v2 _setupAnimationsForResizedViewsWithOldModel:a1[5]];
    v4 = *(a1[6] + 8);
    v5 = *(v4 + 40);
    *(v4 + 40) = v3;
  }
}

uint64_t __68__UICollectionView__processViewSpecificInvalidationsForVisibleViews__block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v27 = *MEMORY[0x1E69E9840];
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v25 = 0u;
  v5 = [a3 copy];
  v6 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v23;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v23 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v22 + 1) + 8 * i);
        v11 = [*(a1 + 32) _visibleDecorationViewOfKind:a2 atIndexPath:v10];
        v12 = v11;
        if (v11)
        {
          [v11 _invalidatePreferredAttributes];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForDecorationViewOfKind:a2 atIndexPath:v10];
          if (v13)
          {
            [*(a1 + 32) _checkForPreferredAttributesInView:v12 originalAttributes:v13];
            [*(a1 + 32) _applyLayoutAttributes:v13 toView:v12];
          }

          else if (([v12 _isInUpdateAnimation] & 1) == 0)
          {
            v20 = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = *(a1 + 32);
            v18 = *(a1 + 40);
            v19 = [v10 _ui_shortDescription];
            v14 = [*(*(a1 + 32) + 2152) layoutAttributesForDecorationViewOfKind:a2 atIndexPath:v10];
            v16 = [v12 _layoutAttributes];
            [v20 handleFailureInMethod:v18 object:v17 file:@"UICollectionView.m" lineNumber:6426 description:{@"UICollectionView internal inconsistency: No attributes returned for invalidated decoration view. Element kind: %@; index path: %@; decoration view: %@; attributes from layout: %@; attributes from view: %@; collection view: %@", a2, v19, v12, v14, v16, *(a1 + 32)}];
          }
        }
      }

      v7 = [v5 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v7);
  }

  return [a3 removeAllObjects];
}

- (void)_endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate
{
  v4 = *MEMORY[0x1E695EFF8];
  v3 = *(MEMORY[0x1E695EFF8] + 8);
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
  {
    v5 = [(UICollectionViewLayout *)self->_layout _layoutAxis];
    if ((v5 - 1) <= 1)
    {
      v4 = _UISetPointValueForAxis(v5, v4, v3, -1.0);
      v3 = v6;
    }
  }

  v7 = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
  [(UIScrollView *)self contentOffset];
  v9 = v8;
  [(UIScrollView *)self _effectiveContentInset];
  if (v9 < -v10 || ([(UIScrollView *)self contentOffset], v12 = v11, [(UIScrollView *)self _effectiveContentInset], v12 < -v13))
  {
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:0];
  }

  [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v4, v3];

  [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:v7];
}

void __36__UICollectionView__indexBarEntries__block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  v5 = *(a1 + 32);
  v6 = a2;
  v8 = [v5 _indexPathForEntryWithTitle:v6 atIndex:a3 validateTitles:0];
  v7 = [UIIndexBarEntry entryWithTitle:v6];

  if (v8)
  {
    [v7 setIndexPath:v8];
  }

  [*(a1 + 40) addObject:v7];
}

- (id)_delegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->super._delegate);

  return WeakRetained;
}

uint64_t __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_4(uint64_t result, uint64_t a2)
{
  v2 = *(*(*(result + 40) + 8) + 40);
  if (v2)
  {
    return [*(result + 32) _updateAnimationDidStop:v2 finished:a2];
  }

  return result;
}

- (BOOL)_allowsEffectiveMultipleSelection
{
  if ([(UICollectionView *)self _isEditing])
  {

    return [(UICollectionView *)self allowsMultipleSelectionDuringEditing];
  }

  else
  {

    return [(UICollectionView *)self allowsMultipleSelection];
  }
}

uint64_t __30__UICollectionView_reloadData__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v21 = *MEMORY[0x1E69E9840];
  if ([a3 _isInUpdateAnimation])
  {
    if (*(a1 + 40) != 1 || !dyld_program_sdk_at_least())
    {
      return 1;
    }

    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", _UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_4___s_category);
    if (*CategoryCachedImpl)
    {
      v11 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        v12 = *(a1 + 32);
        v13 = v11;
        v14 = [a2 _ui_shortDescription];
        v15 = 134218498;
        v16 = v12;
        v17 = 2112;
        v18 = v14;
        v19 = 2112;
        v20 = a3;
        _os_log_impl(&dword_188A29000, v13, OS_LOG_TYPE_ERROR, "[UICV %p] reloadData hiding cell in update animation index path: %@; cell: %@.", &v15, 0x20u);
      }
    }

    [a3 _setHiddenForReuse:1];
  }

  else
  {
    v7 = [a3 _layoutAttributes];
    if (v7)
    {
      v8 = v7[72];

      v9 = *(a1 + 32);
      if (v8)
      {
        [v9 _reuseCell:a3 notifyDidEndDisplaying:1];
        return 0;
      }
    }

    else
    {
      v9 = *(a1 + 32);
    }

    [v9 _reuseSupplementaryView:a3];
  }

  return 0;
}

void __33__UICollectionView_preparedCells__block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v10 = v4;
  if (v4)
  {
    v5 = v4[3];
  }

  else
  {
    v5 = 0;
  }

  v6 = v5;

  if (v6)
  {
    v7 = *(a1 + 32);
    if (v10)
    {
      v8 = v10[3];
    }

    else
    {
      v8 = 0;
    }

    v9 = v8;
    [v7 addObject:v9];
  }
}

- (void)_purgeReuseQueues
{
  [(UICollectionView *)self _resetPrefetchState];
  [(_UICollectionViewSubviewManager *)self->_subviewManager enumerateAllViewsInReuseQueueWithEnumerator:?];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    reuseQueues = subviewManager->_reuseQueues;

    [(NSMutableDictionary *)reuseQueues removeAllObjects];
  }
}

- (BOOL)_shouldFadeCellsForBoundChangeWhileRotating
{
  if (dyld_program_sdk_at_least() && ([(UICollectionViewLayout *)self->_layout _estimatesSizes]|| [(UICollectionViewLayout *)self->_layout _disallowsFadeCellsForBoundsChange]))
  {
    return 0;
  }

  v4 = [(UIView *)self window];
  v5 = [(UIView *)self _viewControllerForAncestor];
  v6 = v5;
  v3 = 1;
  if (v4)
  {
    if (v5)
    {
      if ([v4 isRotating])
      {
        memset(v8, 0, sizeof(v8));
        [v6 _getRotationContentSettings:v8];
        if (LOBYTE(v8[0]) == 1)
        {
          v3 = BYTE3(v8[0]) == 1;
        }
      }
    }
  }

  return v3;
}

- (id)preferredFocusedView
{
  v91 = *MEMORY[0x1E69E9840];
  v4 = [(UICollectionView *)self _horizontalIndexTitleBar];
  v5 = [v4 _currentlyFocusedCell];

  if (v5 && ![(UICollectionView *)self isMovingFocusFromHorizontalIndexTitleBarToContent])
  {
    v6 = v5;
    goto LABEL_7;
  }

  if ((*(&self->_collectionViewFlags + 10) & 0x20408000) != 0)
  {
    goto LABEL_4;
  }

  if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]< 1)
  {
    goto LABEL_4;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    goto LABEL_4;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  if (collectionViewData->_totalItemCount < 1)
  {
LABEL_4:
    if ((*(&self->_collectionViewFlags + 13) & 0x20) == 0)
    {
LABEL_5:
      v86.receiver = self;
      v86.super_class = UICollectionView;
      v6 = [(UIView *)&v86 preferredFocusedView];
LABEL_7:
      v7 = v6;
      goto LABEL_8;
    }

    if (os_variant_has_internal_diagnostics())
    {
      v27 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_FAULT))
      {
        goto LABEL_36;
      }

      v28 = NSStringFromSelector(a2);
      *buf = 138412290;
      v90 = v28;
      _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, "Recursively calling out to %@ while already in the process of creating a reusable view or cell. This might lead to unexpected behavior.", buf, 0xCu);
    }

    else
    {
      v26 = *(__UILogGetCategoryCachedImpl("Assert", &preferredFocusedView___s_category) + 8);
      if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_5;
      }

      v27 = v26;
      v28 = NSStringFromSelector(a2);
      *buf = 138412290;
      v90 = v28;
      _os_log_impl(&dword_188A29000, v27, OS_LOG_TYPE_ERROR, "Recursively calling out to %@ while already in the process of creating a reusable view or cell. This might lead to unexpected behavior.", buf, 0xCu);
    }

LABEL_36:
    goto LABEL_5;
  }

  if ([(UICollectionView *)self isMovingFocusFromHorizontalIndexTitleBarToContent])
  {
    v10 = [(UICollectionView *)self selectedIndexTitleEntry];

    if (v10)
    {
      v11 = [(UICollectionView *)self selectedIndexTitleEntry];
      v12 = [v11 targetFocusedIndexPath];
      v7 = [(UICollectionView *)self cellForItemAtIndexPath:v12];
    }

    else
    {
      v11 = [(UICollectionView *)self indexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar];
      v7 = [(UICollectionView *)self cellForItemAtIndexPath:v11];
    }

    if (v7)
    {
      goto LABEL_8;
    }
  }

  v13 = [(UICollectionView *)self _focusedItemState];

  if (!v13)
  {
    goto LABEL_48;
  }

  v14 = [(UICollectionView *)self _focusedItemState];
  v15 = v14;
  if (!v14 || v14[4] != 1)
  {
    v16 = [(UICollectionView *)self _focusedItemState];
    if (v16)
    {
      v17 = v16[4];

      if (v17 == 2)
      {
        goto LABEL_27;
      }
    }

    else
    {
    }

    v29 = [(UICollectionView *)self _focusedItemState];
    v19 = v29;
    if (!v29 || (v20 = *(v29 + 8)) == 0)
    {
      v30 = [(UICollectionView *)self _focusedItemState];
      v22 = v30;
      if (v30)
      {
        v31 = *(v30 + 16);
      }

      else
      {
        v31 = 0;
      }

      v24 = v31;
      v25 = [(UICollectionView *)self _indexPathIsValid:v24];
      goto LABEL_46;
    }

LABEL_42:

LABEL_47:
    v13 = [(UICollectionView *)self _focusedItemState];
    goto LABEL_48;
  }

LABEL_27:
  v18 = [(UICollectionView *)self _focusedItemState];
  v19 = v18;
  if (v18)
  {
    v20 = *(v18 + 8);
    if (v20)
    {
      goto LABEL_42;
    }
  }

  v21 = [(UICollectionView *)self _focusedItemState];
  v22 = v21;
  if (v21)
  {
    v23 = *(v21 + 16);
  }

  else
  {
    v23 = 0;
  }

  v24 = v23;
  v25 = [(UICollectionView *)self _isSectionValidInIndexPath:v24];
LABEL_46:
  v32 = v25;

  if (v32)
  {
    goto LABEL_47;
  }

  v13 = 0;
LABEL_48:
  targetFocusedItemState = self->_targetFocusedItemState;
  if (targetFocusedItemState)
  {
    v34 = targetFocusedItemState;
LABEL_50:
    v35 = v34;
    goto LABEL_81;
  }

  if (dyld_program_sdk_at_least() && [(UICollectionView *)self remembersLastFocusedIndexPath])
  {
    if (v13)
    {
      v36 = v13;
    }

    else
    {
      v36 = [(UICollectionView *)self _rememberedFocusedItemState];
    }

    v35 = v36;
  }

  else
  {
    v35 = 0;
  }

  v37 = [(UICollectionView *)self _indexPathsForSelectedItems];
  v38 = [v37 firstObject];

  if (v38)
  {
    if (v35 && ![(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:v38 initiatedBySelection:1 focusItemStateCandidate:v35])
    {

      goto LABEL_81;
    }

    v39 = [_UICollectionViewFocusedItemState stateWithIndexPath:v38 elementKind:@"UICollectionElementKindCell" viewType:0];

    v35 = v39;
  }

  if (!v35)
  {
    v40 = [(UICollectionView *)self _delegatePreferredIndexPath];
    if (v40)
    {
      v35 = [_UICollectionViewFocusedItemState stateWithIndexPath:v40 elementKind:@"UICollectionElementKindCell" viewType:0];
    }

    else
    {
      v35 = 0;
    }

    if (!v35 && v13)
    {
      v34 = v13;
      goto LABEL_50;
    }

    if (!v35)
    {
      v41 = *(&self->_collectionViewFlags + 1);
      *(&self->_collectionViewFlags + 1) = v41 & 0xFFFFFBFFFFFFFFFFLL;
      if ([(UIView *)self _shouldReverseLayoutDirection])
      {
        v42 = [(UIView *)self _flipsHorizontalAxis]? 3 : 9;
      }

      else
      {
        v42 = 3;
      }

      [(UIScrollView *)self visibleBounds];
      v47 = _UIRectAnchorPointForEdges(v42, v43, v44, v45, v46);
      v49 = v48;
      v50 = _UIUnitAnchorPointForEdges(v42);
      v52 = v51;
      v53 = [(UIView *)self _focusSystem];
      [(UIScrollView *)self visibleBounds];
      v88[0] = MEMORY[0x1E69E9820];
      v88[1] = 3221225472;
      v88[2] = __40__UICollectionView_preferredFocusedView__block_invoke;
      v88[3] = &unk_1E70FF900;
      v88[4] = self;
      v58 = [v53 _closestFocusableItemToPoint:self inEnvironment:v88 constrainedToRect:v47 distanceMeasuringUnitPoint:v49 itemFilter:{v54, v55, v56, v57, v50, v52}];

      if (v58)
      {
        v59 = _UICollectionViewCellForFocusItem(self, v58);
        v35 = [_UICollectionViewFocusedItemState stateWithReusableView:v59];
      }

      else
      {
        v35 = 0;
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFBFFFFFFFFFFLL | (((v41 >> 42) & 1) << 42);

      if (!v35)
      {
        v84 = self->_collectionViewData;
        if (!v84)
        {
          goto LABEL_117;
        }

        if ((*&v84->_collectionViewDataFlags & 2) == 0)
        {
          [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
        }

        if (v84->_totalItemCount < 1)
        {
          goto LABEL_117;
        }

        v85 = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:?];
        v35 = [_UICollectionViewFocusedItemState stateWithIndexPath:v85 elementKind:@"UICollectionElementKindCell" viewType:0];

        if (!v35)
        {
          goto LABEL_117;
        }
      }
    }
  }

LABEL_81:
  v60 = *(v35 + 8);

  if (v60)
  {
    v61 = v35;
    goto LABEL_110;
  }

  [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  v62 = dyld_program_sdk_at_least();
  if (*(v35 + 32))
  {
    v63 = *(v35 + 24);
    v64 = *(v35 + 16);
    v65 = [(UICollectionView *)self supplementaryViewForElementKind:v63 atIndexPath:v64];

    if (v65)
    {
      goto LABEL_96;
    }

    v66 = *(v35 + 24);
    v67 = *(v35 + 16);
    v68 = [(UICollectionView *)self layoutAttributesForSupplementaryElementOfKind:v66 atIndexPath:v67];

    if (!v68 || ([v68 isHidden] & 1) != 0)
    {
      v65 = 0;
LABEL_95:

      goto LABEL_96;
    }

    *(&self->_collectionViewFlags + 1) |= 0x200000000000uLL;
    v71 = *(v35 + 24);
    v65 = *(v35 + 16);
    v72 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v71 atIndexPath:v65 layout:self->_layout withLayoutAttributes:v68 applyAttributes:1];
LABEL_94:
    v73 = v72;

    *(&self->_collectionViewFlags + 1) &= ~0x200000000000uLL;
    v65 = v73;
    goto LABEL_95;
  }

  v69 = *(v35 + 16);
  v65 = [(UICollectionView *)self _cellForItemAtIndexPath:v69];

  if (!v65 || [v65 _isHiddenForReuse])
  {
    v70 = *(v35 + 16);
    v68 = [(UICollectionView *)self layoutAttributesForItemAtIndexPath:v70];

    if (!v68 || ([v68 isHidden] & 1) != 0)
    {
      goto LABEL_95;
    }

    *(&self->_collectionViewFlags + 1) |= 0x200000000000uLL;
    v71 = *(v35 + 16);
    v72 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:v71 withLayoutAttributes:v68 applyAttributes:1 isFocused:v62 ^ 1u notify:1];
    goto LABEL_94;
  }

LABEL_96:
  v61 = [(_UICollectionViewFocusedItemState *)v35 copyWithReusableView:v65];

  if ((v62 & 1) == 0)
  {
    [(UICollectionView *)self _setFocusedItemState:v61];
    goto LABEL_109;
  }

  if (v61)
  {
    v74 = v61[1];
  }

  else
  {
    v74 = 0;
  }

  v75 = v74;

  if (v75)
  {
    if (v61)
    {
      subviewManager = self->_subviewManager;
      if (v61[4])
      {
        v77 = v61[1];
        v78 = v61[3];
        v79 = v61[4];
        v80 = v61[2];
        if (subviewManager)
        {
          [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews setView:v77 ofKind:v78 inCategory:v79 atIndexPath:v80];
        }

        goto LABEL_108;
      }

      v77 = [(_UICollectionViewFocusedItemState *)v61 cell];
      v81 = v61[2];
    }

    else
    {
      subviewManager = self->_subviewManager;
      v77 = [(_UICollectionViewFocusedItemState *)0 cell];
      v81 = 0;
    }

    v78 = v81;
    [(_UICollectionViewSubviewManager *)subviewManager setVisibleCell:v77 atIndexPath:v78];
LABEL_108:
  }

LABEL_109:
  [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];

  if (!v61)
  {
LABEL_117:
    v61 = 0;
    goto LABEL_118;
  }

LABEL_110:
  v82 = v61[1];
  if (!v82)
  {
LABEL_118:
    v87.receiver = self;
    v87.super_class = UICollectionView;
    v7 = [(UIView *)&v87 preferredFocusedView];
    v83 = 0;
    goto LABEL_119;
  }

  v83 = v82;
  v7 = v83;
LABEL_119:

LABEL_8:

  return v7;
}

- (id)_delegatePreferredIndexPath
{
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x4000000) != 0)
  {
    v6 = [(UICollectionView *)self _delegateProxy];
    v7 = [v6 indexPathForPreferredFocusedViewInCollectionView:self];
  }

  else
  {
    if ((collectionViewFlags & 0x1000000) == 0)
    {
      v5 = 0;
      goto LABEL_9;
    }

    v6 = [(UICollectionView *)self _delegateProxy];
    v7 = [v6 indexPathForPreferredFocusedItemForCollectionView:self];
  }

  v5 = v7;

  if (v5 && ![(UICollectionView *)self _indexPathIsValid:v5])
  {
    v8 = [MEMORY[0x1E696AAA8] currentHandler];
    [v8 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:15187 description:{@"no cell for index path (%@) - the collection view's delegate must return an index path for a valid UICollectionViewCell from -indexPathForPreferredFocusedViewInCollectionView:", v5}];
  }

LABEL_9:

  return v5;
}

- (BOOL)_allowsEffectiveFocus
{
  if ([(UICollectionView *)self _isEditing]|| ![(UICollectionView *)self allowsFocus])
  {
    v3 = [(UICollectionView *)self _isEditing];
    if (v3)
    {

      LOBYTE(v3) = [(UICollectionView *)self allowsFocusDuringEditing];
    }
  }

  else
  {
    LOBYTE(v3) = 1;
  }

  return v3;
}

- (BOOL)allowsFocus
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 22) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __31__UICollectionView_allowsFocus__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

BOOL __40__UICollectionView_preferredFocusedView__block_invoke(uint64_t a1, void *a2)
{
  v2 = _UICollectionViewCellForFocusItem(*(a1 + 32), a2);
  v3 = v2 != 0;

  return v3;
}

- (BOOL)_defaultAllowsFocus
{
  v3 = [(UIView *)self _focusBehavior];
  v4 = [v3 cellFocusability];

  v5 = [(UICollectionView *)self allowsSelection];
  result = 0;
  if (v5 && v4 != 3)
  {
    if (v4 == 2)
    {
      v7 = [(UIView *)self traitCollection];
      v8 = [v7 _hasSplitViewControllerContextSidebarColumn];

      return v8;
    }

    else
    {
      return 1;
    }
  }

  return result;
}

- (BOOL)canBecomeFocused
{
  if (![(UICollectionView *)self remembersLastFocusedIndexPath])
  {
    goto LABEL_11;
  }

  if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]< 1)
  {
    goto LABEL_11;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    goto LABEL_11;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)collectionViewData _updateItemCounts];
  }

  if (collectionViewData->_totalItemCount >= 1)
  {
    v4 = [(UIView *)self _focusSystem];
    v5 = [v4 focusedItem];

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v6 = v5;
    }

    else
    {
      v6 = 0;
    }

    v7 = ![(UIView *)self containsView:v6];
  }

  else
  {
LABEL_11:
    LOBYTE(v7) = 0;
  }

  return v7;
}

- (void)_highlightFirstVisibleItemIfAppropriate
{
  v8 = [(UIView *)self window];
  v3 = [v8 _screen];
  v4 = [v3 _capabilityForKey:@"UIScreenCapabilityTouchLevelsKey"];
  if ([v4 integerValue] != 2)
  {
    goto LABEL_5;
  }

  v5 = [(UICollectionView *)self visibleCells];
  v6 = [v5 count];

  if (!v6)
  {
    return;
  }

  v7 = [(UICollectionView *)self _indexPathsForVisibleItems];
  v8 = [v7 sortedArrayUsingSelector:sel_compare_];

  v3 = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:?];
  if (([v8 containsObject:v3] & 1) == 0)
  {
    v4 = [v8 firstObject];
    [(UICollectionView *)self _unhighlightAllItemsAndHighlightGlobalItem:[(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:v4]];
LABEL_5:
  }
}

- (void)_setupIndexOverlayManagerIfNecessary
{
  v3 = [(UICollectionView *)self _indexOverlayManager];

  if (!v3)
  {
    v4 = [[_UICollectionTableIndexOverlayManager alloc] initWithHost:?];
    [(UICollectionView *)self _setIndexOverlayManager:v4];
  }
}

- (void)dealloc
{
  v27 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v4 = WeakRetained;
  if (WeakRetained)
  {
    objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
  }

  v5 = objc_loadWeakRetained(&self->_containerScrollView);
  if (v5)
  {
    [(UIView *)self _removeGeometryChangeObserver:v5];
  }

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v6 = [(UIView *)self subviews];
  v7 = [v6 countByEnumeratingWithState:&v20 objects:v26 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v21;
    do
    {
      v10 = 0;
      do
      {
        if (*v21 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = *(*(&v20 + 1) + 8 * v10);
        objc_opt_class();
        if (objc_opt_isKindOfClass())
        {
          [v11 _setCollectionView:0];
        }

        ++v10;
      }

      while (v8 != v10);
      v8 = [v6 countByEnumeratingWithState:&v20 objects:v26 count:16];
    }

    while (v8);
  }

  v12 = [(UICollectionViewLayout *)self->_layout collectionView];

  if (v12 == self)
  {
    [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
  }

  [(_UICollectionViewSubviewRouter *)self->_subviewRouter setContainer:?];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    subviewManager->_collectionView = 0;
  }

  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectController->_collectionView = 0;
  }

  updateCompletionHandler = self->_updateCompletionHandler;
  if (updateCompletionHandler)
  {
    self->_updateCompletionHandler = 0;

    v16 = *(__UILogGetCategoryCachedImpl("UICollectionView", &dealloc___s_category_2) + 8);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      v25 = self;
      _os_log_impl(&dword_188A29000, v16, OS_LOG_TYPE_ERROR, "UICollectionView (%@) is being deallocated while an update is in flight (animations have not completed) and an unexpected result may occur.", buf, 0xCu);
    }
  }

  v17 = [MEMORY[0x1E696AD88] defaultCenter];
  [v17 removeObserver:self name:@"UIApplicationDidReceiveMemoryWarningNotification" object:0];

  v18 = +[_UIHDRUsageCoordinator sharedInstance];
  [(_UIHDRUsageCoordinator *)v18 unregisterForDefaultDynamicRangeChanges:?];

  v19.receiver = self;
  v19.super_class = UICollectionView;
  [(UIScrollView *)&v19 dealloc];
}

- (Class)_intelligenceBaseClass
{
  sub_1890B4E34();

  return swift_getObjCClassFromMetadata();
}

- (void)_intelligenceCollectSubelementsIn:(CGRect)a3 using:(id)a4 transformToRoot:(id)a5
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v11 = _Block_copy(a5);
  _Block_copy(v11);
  v12 = a4;
  v13 = self;
  sub_1890C4598(v12, v13, v11, x, y, width, height);
  _Block_release(v11);
  _Block_release(v11);
}

- (UICollectionView)initWithFrame:(CGRect)frame collectionViewLayout:(UICollectionViewLayout *)layout
{
  height = frame.size.height;
  width = frame.size.width;
  y = frame.origin.y;
  x = frame.origin.x;
  v10 = layout;
  if (!v10)
  {
    [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"UICollectionView must be initialized with a non-nil layout parameter"];
  }

  v14.receiver = self;
  v14.super_class = UICollectionView;
  v11 = [(UIScrollView *)&v14 initWithFrame:x, y, width, height];
  v12 = v11;
  if (v11)
  {
    objc_storeStrong(&v11->_layout, layout);
    *(&v12->_collectionViewFlags + 1) |= 0x9000uLL;
    UICollectionViewCommonSetup(v12);
  }

  return v12;
}

- (UICollectionView)initWithCoder:(NSCoder *)coder
{
  v4 = coder;
  v31.receiver = self;
  v31.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v31 initWithCoder:v4];
  if (v5)
  {
    v6 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionLayout"];
    layout = v5->_layout;
    v5->_layout = v6;

    v8 = [(NSCoder *)v4 decodeObjectForKey:@"UIBackgroundView"];
    backgroundView = v5->_backgroundView;
    v5->_backgroundView = v8;

    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsSelection"])
    {
      v10 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsSelection"];
      v11 = 4096;
      if (!v10)
      {
        v11 = 0;
      }
    }

    else
    {
      v11 = 4096;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFEFFFLL | v11;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsMultipleSelection"])
    {
      v12 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsMultipleSelection"];
      v13 = 0x2000;
      if (!v12)
      {
        v13 = 0;
      }
    }

    else
    {
      v13 = 0;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFDFFFLL | v13;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsSelectionDuringEditing"])
    {
      v14 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsSelectionDuringEditing"];
      v15 = 0x4000;
      if (!v14)
      {
        v15 = 0;
      }
    }

    else
    {
      v15 = 0x4000;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFBFFFLL | v15;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsMultipleSelectionDuringEditing"])
    {
      v16 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsMultipleSelectionDuringEditing"];
      v17 = 0x10000;
      if (!v16)
      {
        v17 = 0;
      }
    }

    else
    {
      v17 = 0;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFEFFFFLL | v17;
    if ([(NSCoder *)v4 containsValueForKey:@"UIAllowsUserInitiatedMultipleSelection"])
    {
      v18 = [(NSCoder *)v4 decodeBoolForKey:@"UIAllowsUserInitiatedMultipleSelection"];
      v19 = 0x8000;
      if (!v18)
      {
        v19 = 0;
      }
    }

    else
    {
      v19 = 0x8000;
    }

    *(&v5->_collectionViewFlags + 1) = *(&v5->_collectionViewFlags + 1) & 0xFFFFFFFFFFFF7FFFLL | v19;
    v20 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewCellPrototypeNibExternalObjects"];
    v21 = mutableDictionaryByTransformingLeafDictionariesToWeakValued(v20);
    cellNibExternalObjectsTables = v5->_cellNibExternalObjectsTables;
    v5->_cellNibExternalObjectsTables = v21;

    v23 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewSupplementaryViewPrototypeNibExternalObjects"];
    v24 = mutableDictionaryByTransformingLeafDictionariesToWeakValued(v23);
    supplementaryViewNibExternalObjectsTables = v5->_supplementaryViewNibExternalObjectsTables;
    v5->_supplementaryViewNibExternalObjectsTables = v24;

    v26 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewCellNibDict"];
    cellNibDict = v5->_cellNibDict;
    v5->_cellNibDict = v26;

    v28 = [(NSCoder *)v4 decodeObjectForKey:@"UICollectionViewSupplementaryViewNibDict"];
    supplementaryViewNibDict = v5->_supplementaryViewNibDict;
    v5->_supplementaryViewNibDict = v28;

    UICollectionViewCommonSetup(v5);
    if ([(NSCoder *)v4 containsValueForKey:@"UICollectionViewPrefetchingEnabled"])
    {
      *(&v5->_collectionViewFlags + 4) = *(&v5->_collectionViewFlags + 4) & 0xFFFFFFFE | [(NSCoder *)v4 decodeBoolForKey:@"UICollectionViewPrefetchingEnabled"];
    }

    if ([(NSCoder *)v4 containsValueForKey:@"UISpringLoaded"])
    {
      [(UICollectionView *)v5 setSpringLoaded:[(NSCoder *)v4 decodeBoolForKey:@"UISpringLoaded"]];
    }
  }

  return v5;
}

- (void)encodeWithCoder:(id)a3
{
  v4 = a3;
  v8.receiver = self;
  v8.super_class = UICollectionView;
  [(UIScrollView *)&v8 encodeWithCoder:v4];
  layout = self->_layout;
  if (layout)
  {
    [v4 encodeObject:layout forKey:@"UICollectionLayout"];
  }

  backgroundView = self->_backgroundView;
  if (backgroundView)
  {
    [v4 encodeObject:backgroundView forKey:@"UIBackgroundView"];
  }

  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x1000) != 0)
  {
    if ((v7 & 0x2000) == 0)
    {
      goto LABEL_7;
    }
  }

  else
  {
    [v4 encodeBool:0 forKey:@"UIAllowsSelection"];
    v7 = *(&self->_collectionViewFlags + 1);
    if ((v7 & 0x2000) == 0)
    {
LABEL_7:
      if ((v7 & 0x4000) == 0)
      {
        goto LABEL_8;
      }

      goto LABEL_24;
    }
  }

  [v4 encodeBool:1 forKey:@"UIAllowsMultipleSelection"];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x4000) == 0)
  {
LABEL_8:
    if ((v7 & 0x10000) == 0)
    {
      goto LABEL_9;
    }

    goto LABEL_25;
  }

LABEL_24:
  [v4 encodeBool:1 forKey:@"UIAllowsSelectionDuringEditing"];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x10000) == 0)
  {
LABEL_9:
    if ((v7 & 0x8000) == 0)
    {
      goto LABEL_11;
    }

    goto LABEL_10;
  }

LABEL_25:
  [v4 encodeBool:1 forKey:@"UIAllowsMultipleSelectionDuringEditing"];
  if ((*(&self->_collectionViewFlags + 1) & 0x8000) != 0)
  {
LABEL_10:
    [v4 encodeBool:1 forKey:@"UIAllowsUserInitiatedMultipleSelection"];
  }

LABEL_11:
  if ([(NSMutableDictionary *)self->_cellNibExternalObjectsTables count])
  {
    [v4 encodeObject:self->_cellNibExternalObjectsTables forKey:@"UICollectionViewCellPrototypeNibExternalObjects"];
  }

  if ([(NSMutableDictionary *)self->_supplementaryViewNibExternalObjectsTables count])
  {
    [v4 encodeObject:self->_supplementaryViewNibExternalObjectsTables forKey:@"UICollectionViewSupplementaryViewPrototypeNibExternalObjects"];
  }

  if ([(NSMutableDictionary *)self->_cellNibDict count])
  {
    [v4 encodeObject:self->_cellNibDict forKey:@"UICollectionViewCellNibDict"];
  }

  if ([(NSMutableDictionary *)self->_supplementaryViewNibDict count])
  {
    [v4 encodeObject:self->_supplementaryViewNibDict forKey:@"UICollectionViewSupplementaryViewNibDict"];
  }

  [v4 encodeBool:-[UICollectionView isPrefetchingEnabled](self forKey:{"isPrefetchingEnabled"), @"UICollectionViewPrefetchingEnabled"}];
  if ([(UICollectionView *)self isSpringLoaded])
  {
    [v4 encodeBool:1 forKey:@"UISpringLoaded"];
  }
}

- (NSString)description
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 | 2;
  v14.receiver = self;
  v14.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v14 description];
  v6 = [v5 mutableCopy];

  [v6 deleteCharactersInRange:{objc_msgSend(v6, "length") - 1, 1}];
  layout = self->_layout;
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v9 = WeakRetained;
  if ((v4 & 2) != 0)
  {
    v10 = objc_opt_class();
    v11 = NSStringFromClass(v10);
    v12 = objc_loadWeakRetained(&self->_dataSource);
    [v6 appendFormat:@"; layout: %@; dataSource: <%@: %p>>", layout, v11, v12];
  }

  else
  {
    [v6 appendFormat:@"; layout: %@; dataSource: %@>", layout, WeakRetained];
  }

  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFFFFFD | v4 & 2;

  return v6;
}

- (void)_layoutDirectionTraitDidChange
{
  v6 = self->_layout;
  v3 = self;
  if (v3 && v6)
  {
    v4 = [(UIView *)v3 effectiveUserInterfaceLayoutDirection];
    if (v4 == [(UICollectionViewLayout *)v6 developmentLayoutDirection])
    {
      if (![(UIView *)v3 _flipsHorizontalAxis])
      {
        goto LABEL_8;
      }

      v5 = 0;
    }

    else
    {
      v5 = [(UICollectionViewLayout *)v6 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIScrollView *)v3 _setFlipsHorizontalAxis:v5];
  }

LABEL_8:
}

- (void)_traitsConsumedByLayoutInvalidated
{
  if (dyld_program_sdk_at_least() && ((_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges, @"CollectionViewAutomaticallyInvalidatesForTraitChanges", _UIInternalPreferenceUpdateBool) & 1) != 0 || byte_1EA95E234))
  {
    v3 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    [v3 _setIntent:14];
    [(UICollectionViewLayout *)self->_layout invalidateLayoutWithContext:v3];
  }
}

- (void)setEditing:(BOOL)editing
{
  v3 = editing;
  if ([(UICollectionView *)self _isEditing]!= editing)
  {
    v5 = 0x1000000000000;
    if (!v3)
    {
      v5 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFEFFFFFFFFFFFFLL | v5;
    if (!dyld_program_sdk_at_least() || !v3 || (~*(&self->_collectionViewFlags + 2) & 0x12000) != 0 || (-[UICollectionView _indexPathsForSelectedItems](self, "_indexPathsForSelectedItems"), v6 = objc_claimAutoreleasedReturnValue(), v7 = [v6 count], v6, v7 <= 1))
    {
      [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
    }

    if (!v3)
    {
      [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
    }

    v8 = dyld_program_sdk_at_least() == 0;
    v10[0] = MEMORY[0x1E69E9820];
    v10[1] = 3221225472;
    v10[2] = __31__UICollectionView_setEditing___block_invoke;
    v10[3] = &unk_1E70F35E0;
    if (v8)
    {
      v9 = 4;
    }

    else
    {
      v9 = 6;
    }

    v10[4] = self;
    v11 = v3;
    [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v9 options:v10 animations:0 completion:?];
  }
}

void __31__UICollectionView_setEditing___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) collectionViewLayout];
  v3 = [v2 canBeEdited];

  if (v3)
  {
    v4 = [*(a1 + 32) collectionViewLayout];
    [v4 setEditing:*(a1 + 40)];
  }

  v5 = *(a1 + 32);
  v6 = *(v5 + 2984);
  v12 = MEMORY[0x1E69E9820];
  v13 = 3221225472;
  v14 = __31__UICollectionView_setEditing___block_invoke_2;
  v15 = &unk_1E70FEBD8;
  v16 = v5;
  LOBYTE(v17) = *(a1 + 40);
  if (v6)
  {
    [(_UICollectionViewSubviewCollection *)*(v6 + 8) enumerateAllViewsWithEnumerator:?];
    v5 = *(a1 + 32);
  }

  v7 = [*(v5 + 2152) _invalidationContextForRefreshingVisibleElementAttributes];
  v8 = [*(a1 + 32) collectionViewLayout];
  [v8 invalidateLayoutWithContext:v7];

  v9 = [*(a1 + 32) window];
  if (v9)
  {
    v10 = v9;
    v11 = +[UIView areAnimationsEnabled];

    if (v11)
    {
      [*(a1 + 32) layoutIfNeeded];
    }
  }
}

uint64_t __31__UICollectionView_setEditing___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (a2)
  {
    a3 = 0;
  }

  return [*(a1 + 32) _updateEditing:*(a1 + 40) forView:a5 atIndexPath:a3 elementCategory:a2];
}

- (BOOL)_canEditItemAtIndexPath:(id)a3
{
  v4 = a3;
  if (!v4)
  {
    v5 = 0;
    goto LABEL_9;
  }

  if ((*(&self->_collectionViewFlags + 3) & 0x40) != 0)
  {
    v6 = [(UICollectionView *)self _delegateProxy];
    v7 = [v6 collectionView:self canEditItemAtIndexPath:v4];
LABEL_8:
    v5 = v7;

    goto LABEL_9;
  }

  if ((*(&self->_collectionViewFlags + 8) & 0x20) != 0)
  {
    v6 = [(UICollectionView *)self _dataSourceProxy];
    v7 = [v6 _collectionView:self canEditItemAtIndexPath:v4];
    goto LABEL_8;
  }

  v5 = 1;
LABEL_9:

  return v5;
}

- (void)_updateEditing:(BOOL)a3 forView:(id)a4 atIndexPath:(id)a5 elementCategory:(unint64_t)a6
{
  v7 = a3;
  v11 = a4;
  v9 = a5;
  if ([v11 canBeEdited])
  {
    v10 = v7 && (!v9 || [(UICollectionView *)self _canEditItemAtIndexPath:v9]);
    [v11 setEditing:v10];
  }
}

- (id)_objectInDictionary:(id)a3 forKind:(id)a4 indexPath:(id)a5
{
  v6 = [a3 objectForKeyedSubscript:a4];
  v7 = [v6 objectForKeyedSubscript:a5];

  return v7;
}

- (void)_setObject:(id)a3 inDictionary:(id)a4 forKind:(id)a5 indexPath:(id)a6
{
  v14 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [v9 objectForKeyedSubscript:v10];
  if (v11)
  {
    v12 = v11;
    v13 = v14;
    if (!v14)
    {
      goto LABEL_7;
    }

LABEL_6:
    [v12 setObject:v13 forKeyedSubscript:a6];
    goto LABEL_8;
  }

  v12 = [MEMORY[0x1E695DF90] dictionary];
  if (v14)
  {
    [v9 setObject:v12 forKeyedSubscript:v10];
    v13 = v14;
    goto LABEL_6;
  }

LABEL_7:
  [v12 removeObjectForKey:a6];
LABEL_8:
}

- (void)_addEntriesFromDictionary:(id)a3 inDictionary:(id)a4 andSet:(id)a5
{
  v8 = a4;
  v9 = a5;
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke;
  v12[3] = &unk_1E70FEC28;
  v12[4] = self;
  v13 = v8;
  v14 = v9;
  v10 = v9;
  v11 = v8;
  [a3 enumerateKeysAndObjectsUsingBlock:v12];
}

void __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke_2;
  v7[3] = &unk_1E70FEC00;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  [a3 enumerateKeysAndObjectsUsingBlock:v7];
}

uint64_t __66__UICollectionView__addEntriesFromDictionary_inDictionary_andSet___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3)
{
  [*(a1 + 32) _setObject:a3 inDictionary:*(a1 + 40) forKind:*(a1 + 56) indexPath:a2];
  v5 = *(a1 + 48);

  return [v5 addObject:a3];
}

- (id)_keysForObject:(id)a3 inDictionary:(id)a4
{
  v5 = a3;
  v6 = a4;
  v13 = 0;
  v14 = &v13;
  v15 = 0x3032000000;
  v16 = __Block_byref_object_copy__39;
  v17 = __Block_byref_object_dispose__39;
  v18 = 0;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __48__UICollectionView__keysForObject_inDictionary___block_invoke;
  v10[3] = &unk_1E70FEC78;
  v7 = v5;
  v11 = v7;
  v12 = &v13;
  [v6 enumerateKeysAndObjectsUsingBlock:v10];
  v8 = v14[5];

  _Block_object_dispose(&v13, 8);

  return v8;
}

void __48__UICollectionView__keysForObject_inDictionary___block_invoke(uint64_t a1, uint64_t a2, void *a3, uint64_t a4)
{
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __48__UICollectionView__keysForObject_inDictionary___block_invoke_2;
  v10[3] = &unk_1E70FEC50;
  v8 = *(a1 + 32);
  v9 = *(a1 + 40);
  v11 = v8;
  v12 = v9;
  v13 = a2;
  v14 = a4;
  [a3 enumerateKeysAndObjectsUsingBlock:v10];
}

void __48__UICollectionView__keysForObject_inDictionary___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (*(a1 + 32) == a3)
  {
    v6 = [objc_alloc(MEMORY[0x1E695DEC8]) initWithObjects:{*(a1 + 48), a2, 0}];
    v7 = *(*(a1 + 40) + 8);
    v8 = *(v7 + 40);
    *(v7 + 40) = v6;

    **(a1 + 56) = 1;
    *a4 = 1;
  }
}

- (id)_visibleSupplementaryViewOfKind:(id)a3 atIndexPath:(id)a4 isDecorationView:(BOOL)a5
{
  if (a5)
  {
    [(UICollectionView *)self _visibleDecorationViewOfKind:a3 atIndexPath:a4];
  }

  else
  {
    [(UICollectionView *)self _visibleSupplementaryViewOfKind:a3 atIndexPath:a4];
  }
  v5 = ;

  return v5;
}

- (void)setDelegate:(id)delegate
{
  v4 = delegate;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    v7 = [v4 allowsWeakReference];
    v6 = v4;
    if ((v7 & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __32__UICollectionView_setDelegate___block_invoke;
      block[3] = &unk_1E70F35B8;
      v125 = v4;
      v126 = self;
      if (setDelegate__once != -1)
      {
        dispatch_once(&setDelegate__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  v9 = [(UIScrollView *)self delegate];
  if (v8 == v9)
  {
    if (v8)
    {
      v10 = v8;
      goto LABEL_130;
    }

    if ((*(&self->_collectionViewFlags + 3) & 0x80) == 0)
    {
      v10 = 0;
      goto LABEL_130;
    }
  }

  v123.receiver = self;
  v123.super_class = UICollectionView;
  [(UIScrollView *)&v123 setDelegate:v8];
  v10 = [(UIScrollView *)self delegate];

  p_collectionViewFlags = &self->_collectionViewFlags;
  *&self->_collectionViewFlags = *&self->_collectionViewFlags & 0xFFFFFFFF7FFFFFFFLL | ((v10 != 0) << 31);
  *&self->_collectionViewFlags = *&self->_collectionViewFlags & 0xFFFFFFFFFFFFFFFELL | objc_opt_respondsToSelector() & 1;
  v12 = objc_opt_respondsToSelector();
  v13 = 2;
  if ((v12 & 1) == 0)
  {
    v13 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFFDLL | v13;
  v14 = objc_opt_respondsToSelector();
  v15 = 4;
  if ((v14 & 1) == 0)
  {
    v15 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFFBLL | v15;
  v16 = objc_opt_respondsToSelector();
  v17 = 8;
  if ((v16 & 1) == 0)
  {
    v17 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFF7 | v17;
  v18 = objc_opt_respondsToSelector();
  v19 = 16;
  if ((v18 & 1) == 0)
  {
    v19 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFEFLL | v19;
  v20 = objc_opt_respondsToSelector();
  v21 = 32;
  if ((v20 & 1) == 0)
  {
    v21 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFDFLL | v21;
  v22 = objc_opt_respondsToSelector();
  v23 = 64;
  if ((v22 & 1) == 0)
  {
    v23 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFFBFLL | v23;
  v24 = objc_opt_respondsToSelector();
  v25 = 256;
  if ((v24 & 1) == 0)
  {
    v25 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFEFFLL | v25;
  v26 = objc_opt_respondsToSelector();
  v27 = 512;
  if ((v26 & 1) == 0)
  {
    v27 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFDFFLL | v27;
  v28 = objc_opt_respondsToSelector();
  v29 = 1024;
  if ((v28 & 1) == 0)
  {
    v29 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFBFFLL | v29;
  v30 = objc_opt_respondsToSelector();
  v31 = 2048;
  if ((v30 & 1) == 0)
  {
    v31 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFF7FFLL | v31;
  if (objc_opt_respondsToSelector() & 1) != 0 && (objc_opt_respondsToSelector())
  {
    v32 = objc_opt_respondsToSelector();
    v33 = 128;
    if ((v32 & 1) == 0)
    {
      v33 = 0;
    }
  }

  else
  {
    v33 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFFF7FLL | v33;
  v34 = objc_opt_respondsToSelector();
  v35 = 4096;
  if ((v34 & 1) == 0)
  {
    v35 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFEFFFLL | v35;
  v36 = objc_opt_respondsToSelector();
  v37 = 0x2000;
  if ((v36 & 1) == 0)
  {
    v37 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFDFFFLL | v37;
  v38 = objc_opt_respondsToSelector();
  v39 = 0x4000;
  if ((v38 & 1) == 0)
  {
    v39 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFFBFFFLL | v39;
  v40 = objc_opt_respondsToSelector();
  v41 = 0x8000;
  if ((v40 & 1) == 0)
  {
    v41 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFF7FFFLL | v41;
  v42 = objc_opt_respondsToSelector();
  v43 = 0x40000000;
  if ((v42 & 1) == 0)
  {
    v43 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFBFFFFFFFLL | v43;
  v44 = objc_opt_respondsToSelector();
  v45 = 0x10000;
  if ((v44 & 1) == 0)
  {
    v45 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFEFFFFLL | v45;
  v46 = objc_opt_respondsToSelector();
  v47 = 0x20000;
  if ((v46 & 1) == 0)
  {
    v47 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFDFFFFLL | v47;
  v48 = objc_opt_respondsToSelector();
  v49 = 0x40000;
  if ((v48 & 1) == 0)
  {
    v49 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFFBFFFFLL | v49;
  v50 = objc_opt_respondsToSelector();
  v51 = 0x80000;
  if ((v50 & 1) == 0)
  {
    v51 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFF7FFFFLL | v51;
  v52 = objc_opt_respondsToSelector();
  v53 = 0x100000;
  if ((v52 & 1) == 0)
  {
    v53 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFEFFFFFLL | v53;
  v54 = objc_opt_respondsToSelector();
  v55 = 0x200000;
  if ((v54 & 1) == 0)
  {
    v55 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFDFFFFFLL | v55;
  v56 = objc_opt_respondsToSelector();
  v57 = 0x400000;
  if ((v56 & 1) == 0)
  {
    v57 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFFBFFFFFLL | v57;
  v58 = objc_opt_respondsToSelector();
  v59 = 0x800000;
  if ((v58 & 1) == 0)
  {
    v59 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFF7FFFFFLL | v59;
  v60 = objc_opt_respondsToSelector();
  v61 = 0x1000000;
  if ((v60 & 1) == 0)
  {
    v61 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFEFFFFFFLL | v61;
  v62 = objc_opt_respondsToSelector();
  v63 = 0x2000000;
  if ((v62 & 1) == 0)
  {
    v63 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFDFFFFFFLL | v63;
  v64 = objc_opt_respondsToSelector();
  v65 = 0x4000000;
  if ((v64 & 1) == 0)
  {
    v65 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFFBFFFFFFLL | v65;
  v66 = objc_opt_respondsToSelector();
  v67 = 0x8000000;
  if ((v66 & 1) == 0)
  {
    v67 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFF7FFFFFFLL | v67;
  v68 = objc_opt_respondsToSelector();
  v69 = 0x10000000;
  if ((v68 & 1) == 0)
  {
    v69 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFEFFFFFFFLL | v69;
  v70 = objc_opt_respondsToSelector();
  v71 = 0x20000000;
  if ((v70 & 1) == 0)
  {
    v71 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFFDFFFFFFFLL | v71;
  v72 = objc_opt_respondsToSelector();
  v73 = 0x8000000000000;
  if ((v72 & 1) == 0)
  {
    v73 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFF7FFFFFFFFFFFFLL | v73;
  v74 = objc_opt_respondsToSelector();
  v75 = 0x10000000000000;
  if ((v74 & 1) == 0)
  {
    v75 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFEFFFFFFFFFFFFFLL | v75;
  v76 = objc_opt_respondsToSelector();
  v77 = 0x100000000;
  if ((v76 & 1) == 0)
  {
    v77 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFEFFFFFFFFLL | v77;
  v78 = objc_opt_respondsToSelector();
  v79 = 0x200000000;
  if ((v78 & 1) == 0)
  {
    v79 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFDFFFFFFFFLL | v79;
  v80 = objc_opt_respondsToSelector();
  v81 = 0x400000000;
  if ((v80 & 1) == 0)
  {
    v81 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFFBFFFFFFFFLL | v81;
  v82 = objc_opt_respondsToSelector();
  v83 = 0x4000000000;
  if ((v82 & 1) == 0)
  {
    v83 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFBFFFFFFFFFLL | v83;
  v84 = objc_opt_respondsToSelector();
  v85 = 0x8000000000;
  if ((v84 & 1) == 0)
  {
    v85 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFF7FFFFFFFFFLL | v85;
  v86 = objc_opt_respondsToSelector();
  v87 = 0x10000000000;
  if ((v86 & 1) == 0)
  {
    v87 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFEFFFFFFFFFFLL | v87;
  v88 = objc_opt_respondsToSelector();
  v89 = 0x20000000000;
  if ((v88 & 1) == 0)
  {
    v89 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFDFFFFFFFFFFLL | v89;
  v90 = objc_opt_respondsToSelector();
  v91 = *p_collectionViewFlags;
  v92 = 0x40000000000;
  if ((v90 & 1) == 0)
  {
    v92 = 0;
  }

  v93 = v91 & 0xFFFFFBFFFFFFFFFFLL | v92;
  *p_collectionViewFlags = v93;
  if ((v91 & 0x700000000) != 0)
  {
    v94 = v93 & 0xFFFF87C7FFFFFFFFLL;
  }

  else
  {
    v95 = objc_opt_respondsToSelector();
    v96 = 0x800000000;
    if ((v95 & 1) == 0)
    {
      v96 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFF7FFFFFFFFLL | v96;
    v97 = objc_opt_respondsToSelector();
    v98 = 0x1000000000;
    if ((v97 & 1) == 0)
    {
      v98 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFEFFFFFFFFFLL | v98;
    v99 = objc_opt_respondsToSelector();
    v100 = 0x2000000000;
    if ((v99 & 1) == 0)
    {
      v100 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFFFDFFFFFFFFFLL | v100;
    if (!_os_feature_enabled_impl() || !_UIIsPrivateMainBundle())
    {
      goto LABEL_115;
    }

    v101 = objc_opt_respondsToSelector();
    v102 = 0x80000000000;
    if ((v101 & 1) == 0)
    {
      v102 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFF7FFFFFFFFFFLL | v102;
    v103 = objc_opt_respondsToSelector();
    v104 = 0x100000000000;
    if ((v103 & 1) == 0)
    {
      v104 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFEFFFFFFFFFFFLL | v104;
    v105 = objc_opt_respondsToSelector();
    v106 = 0x200000000000;
    if ((v105 & 1) == 0)
    {
      v106 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFFDFFFFFFFFFFFLL | v106;
    v107 = objc_opt_respondsToSelector();
    v108 = 0x400000000000;
    if ((v107 & 1) == 0)
    {
      v108 = 0;
    }

    v94 = *p_collectionViewFlags & 0xFFFFBFFFFFFFFFFFLL | v108;
  }

  *p_collectionViewFlags = v94;
LABEL_115:
  v109 = objc_opt_respondsToSelector();
  v110 = 0x40000000000000;
  if ((v109 & 1) == 0)
  {
    v110 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFBFFFFFFFFFFFFFLL | v110;
  v111 = objc_opt_respondsToSelector();
  v112 = 0x80000000000000;
  if ((v111 & 1) == 0)
  {
    v112 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFF7FFFFFFFFFFFFFLL | v112;
  v113 = objc_opt_respondsToSelector();
  v114 = 0x800000000000;
  if ((v113 & 1) == 0)
  {
    v114 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFF7FFFFFFFFFFFLL | v114;
  v115 = objc_opt_respondsToSelector();
  v116 = 0x1000000000000;
  if ((v115 & 1) == 0)
  {
    v116 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFEFFFFFFFFFFFFLL | v116;
  v117 = objc_opt_respondsToSelector();
  v118 = 0x4000000000000;
  if ((v117 & 1) == 0)
  {
    v118 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFBFFFFFFFFFFFFLL | v118;
  v119 = objc_opt_respondsToSelector();
  v120 = 0x2000000000000;
  if ((v119 & 1) == 0)
  {
    v120 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFFDFFFFFFFFFFFFLL | v120;
  v121 = objc_opt_respondsToSelector();
  v122 = 0x20000000000000;
  if ((v121 & 1) == 0)
  {
    v122 = 0;
  }

  *p_collectionViewFlags = *p_collectionViewFlags & 0xFFDFFFFFFFFFFFFFLL | v122;
  [(UICollectionView *)self _configureContextMenuInteractionIfNeeded];
  [(UICollectionView *)self _configureSceneActivationInteractionIfNeeded];
  [(UICollectionView *)self _configureTypeSelectInteractionIfNeeded];
LABEL_130:
}

void __32__UICollectionView_setDelegate___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as a delegate. This will be a hard crash in the future. Offending object: %@ hostObject: %@", &v5, 0x16u);
  }
}

- (void)setDataSource:(id)dataSource
{
  v4 = dataSource;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    v7 = [v4 allowsWeakReference];
    v6 = v4;
    if ((v7 & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __34__UICollectionView_setDataSource___block_invoke;
      block[3] = &unk_1E70F35B8;
      v66 = v4;
      v67 = self;
      if (setDataSource__once != -1)
      {
        dispatch_once(&setDataSource__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  v10 = WeakRetained;
  if (WeakRetained != v8 || !v8 && (*(&self->_collectionViewFlags + 8) & 8) != 0)
  {
    if (WeakRetained)
    {
      objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
    }

    objc_storeWeak(&self->_dataSource, v8);
    v11 = v8;
    v12 = [(UICollectionView *)self dataSource];
    v13 = v12;
    if (v11 == v12)
    {
      v16 = [(UICollectionView *)self allowsWeakReference];

      v14 = v11 == 0;
      v15 = 8 * (v11 != 0);
      if (v11 && v16)
      {
        objc_initWeak(&location, self);
        v17 = [_UIWeakHelper alloc];
        v59 = MEMORY[0x1E69E9820];
        v60 = 3221225472;
        v61 = __34__UICollectionView_setDataSource___block_invoke_243;
        v62 = &unk_1E70F5A28;
        objc_copyWeak(&v63, &location);
        v18 = [(_UIWeakHelper *)v17 initWithDeallocationBlock:&v59];
        objc_setAssociatedObject(v11, &self->super.super.super.super.isa + 2, v18, 1);

        objc_destroyWeak(&v63);
        objc_destroyWeak(&location);
        v14 = 0;
        v15 = 8;
      }
    }

    else
    {

      v14 = v11 == 0;
      v15 = 8 * (v11 != 0);
    }

    p_collectionViewFlags = &self->_collectionViewFlags;
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFF7 | v15;
    v20 = objc_opt_respondsToSelector();
    v21 = 0x100000000000000;
    if ((v20 & 1) == 0)
    {
      v21 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFEFFFFFFFFFFFFFFLL | v21;
    v22 = objc_opt_respondsToSelector();
    v23 = 0x200000000000000;
    if ((v22 & 1) == 0)
    {
      v23 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFDFFFFFFFFFFFFFFLL | v23;
    v24 = objc_opt_respondsToSelector();
    v25 = 0x400000000000000;
    if ((v24 & 1) == 0)
    {
      v25 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xFBFFFFFFFFFFFFFFLL | v25;
    v26 = objc_opt_respondsToSelector();
    v27 = 0x800000000000000;
    if ((v26 & 1) == 0)
    {
      v27 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xF7FFFFFFFFFFFFFFLL | v27;
    v28 = objc_opt_respondsToSelector();
    v29 = 0x8000000000000000;
    if ((v28 & 1) == 0)
    {
      v29 = 0;
    }

    *p_collectionViewFlags = v29 & 0x8000000000000000 | *p_collectionViewFlags & 0x7FFFFFFFFFFFFFFFLL;
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFELL | objc_opt_respondsToSelector() & 1;
    v30 = objc_opt_respondsToSelector();
    v31 = 0x1000000000000000;
    if ((v30 & 1) == 0)
    {
      v31 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xEFFFFFFFFFFFFFFFLL | v31;
    v32 = objc_opt_respondsToSelector();
    v33 = 0x2000000000000000;
    if ((v32 & 1) == 0)
    {
      v33 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xDFFFFFFFFFFFFFFFLL | v33;
    v34 = objc_opt_respondsToSelector();
    v35 = 0x4000000000000000;
    if ((v34 & 1) == 0)
    {
      v35 = 0;
    }

    *p_collectionViewFlags = *p_collectionViewFlags & 0xBFFFFFFFFFFFFFFFLL | v35;
    if (dyld_program_sdk_at_least())
    {
      v36 = objc_opt_respondsToSelector();
      v37 = 2;
      if ((v36 & 1) == 0)
      {
        v37 = 0;
      }

      *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFDLL | v37;
      v38 = objc_opt_respondsToSelector();
      v39 = 4;
      if ((v38 & 1) == 0)
      {
        v39 = 0;
      }

      v40 = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFBLL | v39;
    }

    else
    {
      v40 = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFF9;
    }

    *(&self->_collectionViewFlags + 1) = v40;
    v41 = objc_opt_respondsToSelector();
    v42 = 16;
    if ((v41 & 1) == 0)
    {
      v42 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFEFLL | v42;
    v43 = objc_opt_respondsToSelector();
    v44 = 32;
    if ((v43 & 1) == 0)
    {
      v44 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFDFLL | v44;
    v45 = dyld_program_sdk_at_least();
    v46 = *(&self->_collectionViewFlags + 1);
    if (v45 && (v46 & 0x10) != 0)
    {
      if (objc_opt_respondsToSelector())
      {
        v47 = v11;
        *(&self->_collectionViewFlags + 1) = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_moveItemAtIndexPath_toIndexPath_] & *(&self->_collectionViewFlags + 1) | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFELL;
        v48 = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_canMoveItemAtIndexPath_];
        v49 = *p_collectionViewFlags & 0x8000000000000000;
        if (!v48)
        {
          v49 = 0;
        }

        *p_collectionViewFlags = v49 & 0x8000000000000000 | *p_collectionViewFlags & 0x7FFFFFFFFFFFFFFFLL;
        v50 = [v47 _subclassOverridesMethodWithSelector:{sel_indexTitlesForCollectionView_, v59, v60, v61, v62}];
        v51 = *(&self->_collectionViewFlags + 1) & 2;
        if (!v50)
        {
          v51 = 0;
        }

        *(&self->_collectionViewFlags + 1) = v51 | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFDLL;
        v52 = [v47 _subclassOverridesMethodWithSelector:sel_collectionView_indexPathForIndexTitle_atIndex_];

        v53 = *(&self->_collectionViewFlags + 1) & 4;
        if (!v52)
        {
          v53 = 0;
        }

        v46 = v53 | *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFFBLL;
        *(&self->_collectionViewFlags + 1) = v46;
      }

      else
      {
        v46 = *(&self->_collectionViewFlags + 1);
      }
    }

    *(&self->_collectionViewFlags + 1) = v46 | 0x40000000;
    [(_UICollectionViewDragAndDropController *)self->_dragAndDropController didUpdateDataSource];
    if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 17) & 0x10) != 0)
    {
      *(&self->_collectionViewFlags + 1) &= ~0x400000000uLL;
    }

    if (!v14 || (dyld_program_sdk_at_least() & 1) == 0)
    {
      if ([(UICollectionViewLayout *)self->_layout _shouldInvalidateLayoutForDataSourceChange:v59])
      {
        [(UICollectionView *)self _invalidateLayoutForReload];
      }

      else
      {
        [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
      }
    }

    if (dyld_program_sdk_at_least())
    {
      [(_UICollectionViewSelectionController *)self->_selectionController reset];
      [(_UICollectionViewMultiSelectController *)self->_multiSelectController clearSelectionState];
    }

    [(_UICollectionViewTypeSelectController *)self->_typeSelectController reloadData];
    if ([(UICollectionView *)self _wantsIndexOverlays])
    {
      v54 = [(UIView *)self window];
      if (v54)
      {
        v55 = v54;
        v56 = [(UICollectionView *)self _indexOverlayManager];

        if (!v56)
        {
          [(UICollectionView *)self _setupIndexOverlayManagerIfNecessary];
          v57 = [(UICollectionView *)self _indexOverlayManager];
          v58 = [(UIView *)self window];
          [(_UICollectionTableIndexOverlayManager *)v57 hostDidMoveToWindow:v58];
        }
      }
    }
  }
}

void __34__UICollectionView_setDataSource___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_2___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as dataSource. This will be a hard crash in the future. Offending object: %@ hosting object: %@", &v5, 0x16u);
  }
}

void __34__UICollectionView_setDataSource___block_invoke_243(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    v3 = WeakRetained;
    v2 = [WeakRetained dataSource];
    if (!v2)
    {
      [v3 setDataSource:0];
    }

    WeakRetained = v3;
  }
}

- (void)setPrefetchDataSource:(id)prefetchDataSource
{
  v4 = prefetchDataSource;
  if (!v4)
  {
LABEL_7:
    v6 = 0;
    goto LABEL_8;
  }

  v5 = dyld_program_sdk_at_least();
  v6 = v4;
  if ((v5 & 1) == 0)
  {
    v7 = [v4 allowsWeakReference];
    v6 = v4;
    if ((v7 & 1) == 0)
    {
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __42__UICollectionView_setPrefetchDataSource___block_invoke;
      block[3] = &unk_1E70F35B8;
      v27 = v4;
      v28 = self;
      if (setPrefetchDataSource__once != -1)
      {
        dispatch_once(&setPrefetchDataSource__once, block);
      }

      goto LABEL_7;
    }
  }

LABEL_8:
  v8 = v6;

  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);
  v10 = WeakRetained;
  if (WeakRetained != v8 || !v8 && (*(&self->_collectionViewFlags + 9) & 1) != 0)
  {
    if (WeakRetained)
    {
      objc_setAssociatedObject(WeakRetained, &self->super.super.super.super.isa + 2, 0, 1);
    }

    objc_storeWeak(&self->_prefetchDataSource, v8);
    v11 = v8;
    v12 = [(UICollectionView *)self prefetchDataSource];
    v13 = v12;
    if (v11 == v12)
    {
      v15 = [(UICollectionView *)self allowsWeakReference];

      v14 = (v11 != 0) << 8;
      if (v11 && v15)
      {
        objc_initWeak(&location, self);
        v16 = [_UIWeakHelper alloc];
        v23[0] = MEMORY[0x1E69E9820];
        v23[1] = 3221225472;
        v23[2] = __42__UICollectionView_setPrefetchDataSource___block_invoke_272;
        v23[3] = &unk_1E70F5A28;
        objc_copyWeak(&v24, &location);
        v17 = [(_UIWeakHelper *)v16 initWithDeallocationBlock:v23];
        objc_setAssociatedObject(v11, &self->super.super.super.super.isa + 2, v17, 1);

        objc_destroyWeak(&v24);
        objc_destroyWeak(&location);
        v14 = 256;
      }
    }

    else
    {

      v14 = (v11 != 0) << 8;
    }

    p_collectionViewFlags = &self->_collectionViewFlags;
    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFEFFLL | v14;
    v19 = objc_opt_respondsToSelector();
    v20 = 64;
    if ((v19 & 1) == 0)
    {
      v20 = 0;
    }

    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFFBFLL | v20;
    v21 = objc_opt_respondsToSelector();
    v22 = 128;
    if ((v21 & 1) == 0)
    {
      v22 = 0;
    }

    *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFFFFFFFFFFFFF7FLL | v22;
  }
}

void __42__UICollectionView_setPrefetchDataSource___block_invoke(uint64_t a1)
{
  v9 = *MEMORY[0x1E69E9840];
  v2 = *(__UILogGetCategoryCachedImpl("Warning", &_UIInternalPreference_CollectionViewAutomaticallyInvalidatesForTraitChanges_block_invoke_3___s_category) + 8);
  if (os_log_type_enabled(v2, OS_LOG_TYPE_ERROR))
  {
    v3 = *(a1 + 32);
    v4 = *(a1 + 40);
    v5 = 138412546;
    v6 = v3;
    v7 = 2112;
    v8 = v4;
    _os_log_impl(&dword_188A29000, v2, OS_LOG_TYPE_ERROR, "You are trying to set a deallocating object as prefetchDataSource. This will be a hard crash in the future. Offending object: %@ hosting object: %@", &v5, 0x16u);
  }
}

void __42__UICollectionView_setPrefetchDataSource___block_invoke_272(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  if (WeakRetained)
  {
    v3 = WeakRetained;
    v2 = [WeakRetained prefetchDataSource];
    if (!v2)
    {
      [v3 setPrefetchDataSource:0];
    }

    WeakRetained = v3;
  }
}

- (int64_t)_dataSourceNumberOfSections
{
  v3 = [(UICollectionView *)self _dataSourceActual];
  v4 = objc_opt_respondsToSelector();

  if ((v4 & 1) == 0)
  {
    return 1;
  }

  v5 = [(UICollectionView *)self _dataSourceActual];
  v6 = [v5 numberOfSectionsInCollectionView:self];

  return v6 & ~(v6 >> 63);
}

- (int64_t)_dataSourceNumberOfItemsInSection:(int64_t)a3
{
  v5 = [(UICollectionView *)self _dataSourceActual];
  v6 = [v5 collectionView:self numberOfItemsInSection:a3];

  return v6;
}

- (void)_incrementUpdateAnimationCountWithContext:(id)a3
{
  v4 = a3;
  if (v4)
  {
    ++v4[2];
  }

  ++self->_updateAnimationCount;
}

- (void)_decrementUpdateAnimationCountWithContext:(id)a3
{
  v4 = a3;
  if (v4)
  {
    --v4[2];
  }

  updateAnimationCount = self->_updateAnimationCount;
  v6 = updateAnimationCount < 1;
  v7 = updateAnimationCount - 1;
  if (!v6)
  {
    self->_updateAnimationCount = v7;
  }
}

- (BOOL)_isIndexPathSelectedItem:(id)a3
{
  v4 = a3;
  [(UICollectionView *)self _reloadDataIfNeeded];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v6 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v6 = 0;
  }

  v7 = [v6 containsObject:v4];

  return v7;
}

- (void)_enumerateVisibleViews:(id)a3
{
  v5 = a3;
  if (!v5)
  {
    v9 = [MEMORY[0x1E696AAA8] currentHandler];
    [v9 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:1507 description:{@"Invalid parameter not satisfying: %@", @"block != NULL"}];
  }

  subviewManager = self->_subviewManager;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView__enumerateVisibleViews___block_invoke;
  v10[3] = &unk_1E70FECA0;
  v11 = v5;
  v7 = v5;
  v8 = v7;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v10];
    v8 = v11;
  }
}

- (void)_deselectAllAnimated:(BOOL)a3 notifyDelegate:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v27 = *MEMORY[0x1E69E9840];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v8 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v8 = 0;
  }

  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v9 = [v8 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v23;
    do
    {
      v12 = 0;
      do
      {
        if (*v23 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v22 + 1) + 8 * v12);
        v14 = self->_selectionController;
        if (v14)
        {
          [(NSMutableSet *)v14->_selectedIndexPaths removeObject:*(*(&v22 + 1) + 8 * v12)];
        }

        v15 = [(UICollectionView *)self _cellForItemAtIndexPath:v13];
        [v15 _setSelected:0 animated:v5];

        if (v4 && (*&self->_collectionViewFlags & 0x40) != 0)
        {
          v16 = [(UICollectionView *)self _delegateProxy];
          [v16 collectionView:self didDeselectItemAtIndexPath:v13];
        }

        ++v12;
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v22 objects:v26 count:16];
    }

    while (v10);
  }

  if (v4)
  {
    multiSelectController = self->_multiSelectController;
    v18 = self->_selectionController;
    if (v18)
    {
      v19 = [(NSMutableSet *)v18->_selectedIndexPaths copy];
    }

    else
    {
      v19 = 0;
    }

    v20 = [v19 allObjects];
    [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:v20];
  }

  if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:0 initiatedBySelection:1])
  {
    v21 = [(UIView *)self _focusSystem];
    if ([v21 _focusedItemIsContainedInEnvironment:self includeSelf:1])
    {
      [v21 _startDeferringFocusIfSupported];
    }
  }
}

- (BOOL)_delegateAllowsHighlightingItemAtIndexPath:(id)a3
{
  if ((*&self->_collectionViewFlags & 1) == 0)
  {
    return 1;
  }

  v4 = self;
  v5 = a3;
  v6 = [(UICollectionView *)v4 _delegateProxy];
  LOBYTE(v4) = [v6 collectionView:v4 shouldHighlightItemAtIndexPath:v5];

  return v4;
}

- (BOOL)_delegateAllowsSelectingItemAtIndexPath:(id)a3
{
  if ((*&self->_collectionViewFlags & 8) == 0)
  {
    return 1;
  }

  v4 = self;
  v5 = a3;
  v6 = [(UICollectionView *)v4 _delegateProxy];
  LOBYTE(v4) = [v6 collectionView:v4 shouldSelectItemAtIndexPath:v5];

  return v4;
}

- (BOOL)_inferFocusabilityForCell:(id)a3 atIndexPath:(id)a4
{
  v6 = a3;
  v7 = a4;
  if ([(UICollectionView *)self _isIndexPathSelectedItem:v7])
  {
    v8 = 1;
  }

  else
  {
    v9 = [v6 _existingContentView];
    v8 = (!v9 || !dyld_program_sdk_at_least() || (_UIViewContainsFocusableSubviews(v9) & 1) == 0) && (dyld_program_sdk_at_least() && ([v6 _hasCustomSelectionAction] & 1) != 0 || -[UICollectionView _allowsEffectiveSelection](self, "_allowsEffectiveSelection") && (!dyld_program_sdk_at_least() || -[UICollectionView _delegateAllowsHighlightingItemAtIndexPath:](self, "_delegateAllowsHighlightingItemAtIndexPath:", v7)));
  }

  return v8;
}

- (void)_selectItemAtIndexPath:(id)a3 animated:(BOOL)a4 scrollPosition:(unint64_t)a5 notifyDelegate:(BOOL)a6 deselectPrevious:(BOOL)a7 performPrimaryAction:(BOOL)a8 performCustomSelectionAction:(BOOL)a9 isUserInitiated:(BOOL)a10
{
  v10 = a8;
  v12 = a6;
  v14 = a4;
  v17 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:a3 isSelection:1 allowMassIndexPath:1 assertIfInvalid:1];
  v18 = [(UICollectionView *)self _cellForItemAtIndexPath:a3];
  v50 = v18;
  if (a9)
  {
    [v18 _performCustomSelectionAction];
    goto LABEL_54;
  }

  v49 = v10;
  v19 = [(UICollectionView *)self _allowsEffectiveSelection];
  if (a3 && [a3 section] != 0x7FFFFFFFFFFFFFFFLL)
  {
    v20 = [a3 item] != 0x7FFFFFFFFFFFFFFFLL;
    if (!v19)
    {
      goto LABEL_10;
    }
  }

  else
  {
    v20 = 0;
    if (!v19)
    {
      goto LABEL_10;
    }
  }

  if (!v20)
  {
    [(UICollectionView *)self _deselectAllAnimated:v14 notifyDelegate:v12];
    goto LABEL_54;
  }

LABEL_10:
  if (v12)
  {
    if (![(UICollectionView *)self _delegateAllowsSelectingItemAtIndexPath:a3]|| !v19)
    {
      goto LABEL_51;
    }

LABEL_14:
    v48 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v48 | 0x100000;
    v21 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    if (a7 || (v22 = 2976, !-[UICollectionView _allowsEffectiveMultipleSelection](self, "_allowsEffectiveMultipleSelection")) && ((selectionController = self->_selectionController) == 0 ? (v24 = 0) : (v24 = -[NSMutableSet copy](selectionController->_selectedIndexPaths, "copy")), [v24 anyObject], v25 = objc_claimAutoreleasedReturnValue(), LODWORD(v45) = objc_msgSend(v25, "isEqual:", a3), v25, v24, v21 = &OBJC_IVAR____UISystemBackgroundView__strokeView, (v45 & 1) == 0))
    {
      [(UICollectionView *)self _deselectAllAnimated:v14 notifyDelegate:v12, v45];
      v22 = v21[181];
    }

    v46 = v22;
    v26 = *(&self->super.super.super.super.isa + v22);
    if (v26)
    {
      if (([*(v26 + 8) containsObject:a3] & 1) == 0)
      {
        v27 = *(&self->super.super.super.super.isa + v22);
        if (v27)
        {
          [*(v27 + 8) addObject:a3];
          if ((*(v27 + 40) & 1) == 0)
          {
            [*(v27 + 32) removeAllObjects];
          }
        }
      }
    }

    if (v50)
    {
      [v50 _setSelected:1 animated:v14 isUserInitiated:a10];
      p_collectionViewFlags = &self->_collectionViewFlags;
    }

    else
    {
      p_collectionViewFlags = &self->_collectionViewFlags;
      if (v17)
      {
        v29 = [(UICollectionView *)self collectionViewLayout];
        [v29 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:a3 separatorOnly:0];
      }
    }

    if (a5)
    {
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:a3 atScrollPosition:a5 additionalInsets:v14 animated:0.0, 0.0, 0.0, 0.0];
    }

    v30 = [(UIView *)self _focusSystem];
    v31 = [v30 focusedItem];
    v32 = v50;
    v33 = [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:a3 initiatedBySelection:1];
    if (!v50 || v31 == v32 || !dyld_program_sdk_at_least())
    {
      if (!v33)
      {
        goto LABEL_44;
      }

      goto LABEL_42;
    }

    if (!v33)
    {
      goto LABEL_44;
    }

    v34 = [(UIView *)self _focusSystem];
    v35 = [v34 _focusedItemIsContainedInEnvironment:self includeSelf:1];

    if (!v12 || (v35 & 1) != 0)
    {
      if (!v31)
      {
LABEL_42:
        if (([v30 _focusedItemIsContainedInEnvironment:self includeSelf:1] & 1) == 0)
        {
          [(UIView *)self setNeedsFocusUpdate];
        }

LABEL_44:
        if (!v12)
        {
LABEL_50:
          *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFEFFFFF | (((v48 >> 20) & 1) << 20);

          goto LABEL_51;
        }

LABEL_45:
        v37 = [v32 _selectionSegueTemplate];
        v38 = [v37 perform:v32];

        if ((*p_collectionViewFlags & 0x20) != 0)
        {
          [UIViewController _sendPrepareForTapGesture:v32];
          v39 = [(UICollectionView *)self _delegateProxy];
          [v39 collectionView:self didSelectItemAtIndexPath:a3];
        }

        multiSelectController = self->_multiSelectController;
        v41 = *(&self->super.super.super.super.isa + v47);
        if (v41)
        {
          v42 = [*(v41 + 8) copy];
        }

        else
        {
          v42 = 0;
        }

        v43 = [v42 allObjects];
        [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:v43];

        goto LABEL_50;
      }
    }

    else
    {
      v36 = [(UICollectionView *)self _shouldBecomeFocusedOnSelection];
      if (v36 || !v31)
      {
        if (v36)
        {
LABEL_59:
          [v30 _updateFocusImmediatelyToEnvironment:v32];
          if (!v12)
          {
            goto LABEL_50;
          }

          goto LABEL_45;
        }

        goto LABEL_42;
      }
    }

    if ([v30 _focusedItemIsContainedInEnvironment:self includeSelf:1])
    {
      goto LABEL_59;
    }

    goto LABEL_42;
  }

  if (v19)
  {
    goto LABEL_14;
  }

LABEL_51:
  if (v49 && (*(&self->_collectionViewFlags + 6) & 0x10) != 0)
  {
    v44 = [(UICollectionView *)self _delegateProxy];
    [v44 collectionView:self performPrimaryActionForItemAtIndexPath:a3];
  }

LABEL_54:
}

- (BOOL)_canPerformPrimaryActionForItemAtIndexPath:(id)a3
{
  v4 = a3;
  if (v4 && [(UICollectionView *)self _delegateSupportsPrimaryAction])
  {
    if ((*(&self->_collectionViewFlags + 6) & 8) != 0)
    {
      v6 = [(UICollectionView *)self _delegateProxy];
      LOBYTE(self) = [v6 collectionView:self canPerformPrimaryActionForItemAtIndexPath:v4];
    }

    else
    {
      LODWORD(self) = ![(UICollectionView *)self _isEditing];
    }
  }

  else
  {
    LOBYTE(self) = 0;
  }

  return self;
}

- (void)selectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated scrollPosition:(UICollectionViewScrollPosition)scrollPosition
{
  v6 = animated;
  v8 = *(&self->_collectionViewFlags + 1);
  if ((~v8 & 0x180000000000) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v8 & 0xFFFFEFFFFFFFFFFFLL;
  }

  v9 = indexPath;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v11 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:v9];

  LOWORD(v10) = 0;
  [(UICollectionView *)self _selectItemAtIndexPath:v11 animated:v6 scrollPosition:scrollPosition notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v10 isUserInitiated:?];
}

- (void)_deselectItemAtIndexPath:(id)a3 animated:(BOOL)a4 notifyDelegate:(BOOL)a5 isUserInitiated:(BOOL)a6
{
  v6 = a6;
  v7 = a5;
  v8 = a4;
  v44 = *MEMORY[0x1E69E9840];
  v10 = a3;
  selectionController = self->_selectionController;
  if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths containsObject:v10])
  {
    v12 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:v10 isSelection:1 allowMassIndexPath:0 assertIfInvalid:0];
    v13 = [(UICollectionView *)self _delegateProxy];
    v14 = v13;
    if (!v7 || (*&self->_collectionViewFlags & 0x10) == 0 || [v13 collectionView:self shouldDeselectItemAtIndexPath:v10])
    {
      v15 = self->_selectionController;
      if (v15)
      {
        [(NSMutableSet *)v15->_selectedIndexPaths removeObject:v10];
      }

      v16 = [(UICollectionView *)self _cellForItemAtIndexPath:v10];
      v17 = v16;
      if (v16)
      {
        [v16 _setSelected:0 animated:v8 isUserInitiated:v6];
      }

      else if (v12)
      {
        v18 = [(UICollectionView *)self collectionViewLayout];
        [v18 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v10 separatorOnly:0];
      }

      if (v7)
      {
        multiSelectController = self->_multiSelectController;
        v20 = self->_selectionController;
        v21 = v20 ? [(NSMutableSet *)v20->_selectedIndexPaths copy]: 0;
        v22 = [v21 allObjects];
        [(_UICollectionViewMultiSelectController *)multiSelectController selectedIndexPathsChanged:v22];

        if ((*&self->_collectionViewFlags & 0x40) != 0)
        {
          [v14 collectionView:self didDeselectItemAtIndexPath:v10];
        }
      }

      if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:0 initiatedBySelection:1])
      {
        v23 = [(UIView *)self _focusSystem];
        v24 = v23;
        if (v17 && [v23 _focusedItemIsContainedInEnvironment:v17 includeSelf:1])
        {
          v37 = v24;
          v25 = [(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:v10];
          v26 = [(UICollectionView *)self indexPathsForSelectedItems];
          v42[0] = MEMORY[0x1E69E9820];
          v42[1] = 3221225472;
          v42[2] = __85__UICollectionView__deselectItemAtIndexPath_animated_notifyDelegate_isUserInitiated___block_invoke;
          v42[3] = &unk_1E70FECC8;
          v42[4] = self;
          v42[5] = v25;
          v27 = [v26 sortedArrayUsingComparator:v42];

          v40 = 0u;
          v41 = 0u;
          v38 = 0u;
          v39 = 0u;
          v28 = v27;
          v29 = [v28 countByEnumeratingWithState:&v38 objects:v43 count:16];
          if (v29)
          {
            v30 = v29;
            v31 = *v39;
            while (2)
            {
              for (i = 0; i != v30; ++i)
              {
                if (*v39 != v31)
                {
                  objc_enumerationMutation(v28);
                }

                v33 = *(*(&v38 + 1) + 8 * i);
                v34 = [(UICollectionView *)self _cellForItemAtIndexPath:v33];
                if (v34 && [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:v33 initiatedBySelection:1])
                {

                  v24 = v37;
                  [v37 _updateFocusImmediatelyToEnvironment:v34];

                  goto LABEL_33;
                }
              }

              v30 = [v28 countByEnumeratingWithState:&v38 objects:v43 count:16];
              if (v30)
              {
                continue;
              }

              break;
            }
          }

          v24 = v37;
          [v37 _startDeferringFocusIfSupported];
LABEL_33:
        }
      }

      v35 = [(UIView *)self traitCollection];
      v36 = [v35 userInterfaceIdiom];

      if (v36 == 3)
      {
        [(UIView *)self setNeedsFocusUpdate];
      }
    }
  }
}

uint64_t __85__UICollectionView__deselectItemAtIndexPath_animated_notifyDelegate_isUserInitiated___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v5 = *(*(a1 + 32) + 2272);
  v6 = a3;
  v7 = [(UICollectionViewData *)v5 globalIndexForItemAtIndexPath:a2];
  v8 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) globalIndexForItemAtIndexPath:v6];

  v9 = *(a1 + 40);
  v10 = v7 - v9;
  if (v7 - v9 < 0)
  {
    v10 = v9 - v7;
  }

  v11 = v8 - v9;
  if (v11 < 0)
  {
    v11 = -v11;
  }

  if (v10 < v11)
  {
    v12 = -1;
  }

  else
  {
    v12 = v11 < v10;
  }

  v13 = v8 < v7;
  if (v7 < v8)
  {
    v13 = -1;
  }

  if (v12)
  {
    return v12;
  }

  else
  {
    return v13;
  }
}

- (void)_deselectItemsAtIndexPaths:(id)a3 animated:(BOOL)a4 transitionCoordinator:(id)a5 isUserInitiated:(BOOL)a6
{
  v6 = a6;
  v8 = a4;
  v45 = *MEMORY[0x1E69E9840];
  v10 = a3;
  v11 = a5;
  if ([v10 count])
  {
    v25 = v11;
    [(UICollectionView *)self _reloadDataIfNeeded];
    v12 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v10, "count")}];
    v13 = self->_selectionController;
    v39 = 0u;
    v40 = 0u;
    v41 = 0u;
    v42 = 0u;
    v26 = v10;
    v14 = v10;
    v15 = [v14 countByEnumeratingWithState:&v39 objects:v44 count:16];
    if (v15)
    {
      v16 = v15;
      v17 = *v40;
      do
      {
        for (i = 0; i != v16; ++i)
        {
          if (*v40 != v17)
          {
            objc_enumerationMutation(v14);
          }

          v19 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:*(*(&v39 + 1) + 8 * i)];
          if (v13 && [(NSMutableSet *)v13->_selectedIndexPaths containsObject:v19])
          {
            [v12 addObject:v19];
          }
        }

        v16 = [v14 countByEnumeratingWithState:&v39 objects:v44 count:16];
      }

      while (v16);
    }

    v11 = v25;
    if (v25)
    {
      [(_UICollectionViewSelectionController *)v13 addDeselectionTransitionIndexPaths:v12];
      v30[0] = MEMORY[0x1E69E9820];
      v30[1] = 3221225472;
      v30[2] = __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke;
      v30[3] = &unk_1E70FECF0;
      v31 = v13;
      v32 = self;
      v33 = v8;
      v34 = v6;
      v27[0] = MEMORY[0x1E69E9820];
      v27[1] = 3221225472;
      v27[2] = __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke_2;
      v27[3] = &unk_1E70F4990;
      v28 = v31;
      v29 = self;
      [v25 animateAlongsideTransition:v30 completion:v27];

      v20 = v31;
    }

    else
    {
      v37 = 0u;
      v38 = 0u;
      v35 = 0u;
      v36 = 0u;
      v20 = v12;
      v21 = [(_UICollectionViewSelectionController *)v20 countByEnumeratingWithState:&v35 objects:v43 count:16];
      if (v21)
      {
        v22 = v21;
        v23 = *v36;
        do
        {
          for (j = 0; j != v22; ++j)
          {
            if (*v36 != v23)
            {
              objc_enumerationMutation(v20);
            }

            [(UICollectionView *)self _deselectItemAtIndexPath:*(*(&v35 + 1) + 8 * j) animated:v8 notifyDelegate:0 isUserInitiated:v6];
          }

          v22 = [(_UICollectionViewSelectionController *)v20 countByEnumeratingWithState:&v35 objects:v43 count:16];
        }

        while (v22);
      }
    }

    v10 = v26;
  }
}

void __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke(uint64_t a1)
{
  v13 = *MEMORY[0x1E69E9840];
  v8 = 0u;
  v9 = 0u;
  v10 = 0u;
  v11 = 0u;
  v2 = *(a1 + 32);
  if (v2)
  {
    v2 = v2[3];
  }

  v3 = v2;
  v4 = [v3 countByEnumeratingWithState:&v8 objects:v12 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v9;
    do
    {
      v7 = 0;
      do
      {
        if (*v9 != v6)
        {
          objc_enumerationMutation(v3);
        }

        [*(a1 + 40) _deselectItemAtIndexPath:*(*(&v8 + 1) + 8 * v7++) animated:*(a1 + 48) notifyDelegate:0 isUserInitiated:{*(a1 + 49), v8}];
      }

      while (v5 != v7);
      v5 = [v3 countByEnumeratingWithState:&v8 objects:v12 count:16];
    }

    while (v5);
  }
}

void __94__UICollectionView__deselectItemsAtIndexPaths_animated_transitionCoordinator_isUserInitiated___block_invoke_2(uint64_t a1, void *a2)
{
  v17 = *MEMORY[0x1E69E9840];
  if ([a2 isCancelled])
  {
    v14 = 0u;
    v15 = 0u;
    v12 = 0u;
    v13 = 0u;
    v3 = *(a1 + 32);
    if (v3)
    {
      v3 = v3[3];
    }

    v4 = v3;
    v5 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
    if (v5)
    {
      v6 = v5;
      v7 = *v13;
      do
      {
        v8 = 0;
        do
        {
          if (*v13 != v7)
          {
            objc_enumerationMutation(v4);
          }

          LOWORD(v11) = 0;
          [*(a1 + 40) _selectItemAtIndexPath:*(*(&v12 + 1) + 8 * v8++) animated:0 scrollPosition:0 notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v11 isUserInitiated:?];
        }

        while (v6 != v8);
        v6 = [v4 countByEnumeratingWithState:&v12 objects:v16 count:16];
      }

      while (v6);
    }
  }

  v9 = *(a1 + 32);
  if (v9)
  {
    v10 = *(v9 + 24);
    *(v9 + 24) = 0;
  }
}

- (void)deselectItemAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated
{
  v4 = animated;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
  [(UICollectionView *)self _deselectItemAtIndexPath:v7 animated:v4 notifyDelegate:0 isUserInitiated:0];
}

- (void)setAllowsSelection:(BOOL)allowsSelection
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 1) & 0x1000) == 0) ^ allowsSelection) & 1) == 0)
  {
    if (allowsSelection)
    {
      *(&self->_collectionViewFlags + 1) |= 0x1000uLL;
    }

    else
    {
      if (![(UICollectionView *)self _isEditing])
      {
        [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
      }

      *(p_collectionViewFlags + 1) &= ~0x1000uLL;

      [(UICollectionView *)self setAllowsMultipleSelection:0];
    }
  }
}

- (void)setAllowsMultipleSelection:(BOOL)allowsMultipleSelection
{
  v21 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 9) & 0x20) == 0) ^ allowsMultipleSelection) & 1) == 0)
  {
    [(_UICollectionViewSelectionController *)self->_selectionController setAllowsMultipleSelection:?];
    if (allowsMultipleSelection)
    {
      *(p_collectionViewFlags + 1) |= 0x2000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];

      [(UICollectionView *)self setAllowsSelection:1];
    }

    else
    {
      selectionController = self->_selectionController;
      if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths count]>= 2 && ![(UICollectionView *)self _isEditing])
      {
        v7 = self->_selectionController;
        if (v7)
        {
          v8 = [(NSMutableSet *)v7->_selectedIndexPaths copy];
        }

        else
        {
          v8 = 0;
        }

        v9 = [v8 anyObject];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = v8;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            for (i = 0; i != v12; ++i)
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = *(*(&v16 + 1) + 8 * i);
              if (v15 != v9)
              {
                [(UICollectionView *)self _deselectItemAtIndexPath:v15 animated:0 notifyDelegate:0 isUserInitiated:0, v16];
              }
            }

            v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
          }

          while (v12);
        }
      }

      *(p_collectionViewFlags + 1) &= ~0x2000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];
    }
  }
}

- (void)_setAllowsBandSelectionForMultipleSelection:(BOOL)a3
{
  v3 = 0x20000;
  if (!a3)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFDFFFFLL | v3;
}

- (void)setAllowsUserInitiatedMultipleSelection:(BOOL)a3
{
  if (((((*(&self->_collectionViewFlags + 1) & 0x8000) == 0) ^ a3) & 1) == 0)
  {
    v3 = 0x8000;
    if (!a3)
    {
      v3 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFFF7FFFLL | v3;
  }
}

- (void)_setAllowsSelectionDuringEditing:(BOOL)a3
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (((((*(&self->_collectionViewFlags + 1) & 0x4000) == 0) ^ a3) & 1) == 0)
  {
    if (a3)
    {
      *(&self->_collectionViewFlags + 1) |= 0x4000uLL;
    }

    else
    {
      if ([(UICollectionView *)self _isEditing])
      {
        [(UICollectionView *)self _deselectAllAnimated:0 notifyDelegate:0];
      }

      *(p_collectionViewFlags + 1) &= ~0x4000uLL;

      [(UICollectionView *)self setAllowsMultipleSelectionDuringEditing:0];
    }
  }
}

- (void)_setAllowsMultipleSelectionDuringEditing:(BOOL)a3
{
  v21 = *MEMORY[0x1E69E9840];
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 1);
  if (((((v4 & 0x10000) == 0) ^ a3) & 1) == 0)
  {
    if (a3)
    {
      *(&self->_collectionViewFlags + 1) = v4 | 0x10000;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];

      [(UICollectionView *)self setAllowsSelectionDuringEditing:1];
    }

    else
    {
      selectionController = self->_selectionController;
      if (selectionController && [(NSMutableSet *)selectionController->_selectedIndexPaths count]>= 2 && [(UICollectionView *)self _isEditing])
      {
        v7 = self->_selectionController;
        if (v7)
        {
          v8 = [(NSMutableSet *)v7->_selectedIndexPaths copy];
        }

        else
        {
          v8 = 0;
        }

        v9 = [v8 anyObject];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = v8;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            for (i = 0; i != v12; ++i)
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = *(*(&v16 + 1) + 8 * i);
              if (v15 != v9)
              {
                [(UICollectionView *)self _deselectItemAtIndexPath:v15 animated:0 notifyDelegate:0 isUserInitiated:0, v16];
              }
            }

            v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
          }

          while (v12);
        }
      }

      *(p_collectionViewFlags + 1) &= ~0x10000uLL;
      [(UICollectionView *)self _updateMultiSelectControllerIfNeeded];
    }
  }
}

- (BOOL)_allowsEffectiveSelectionOrCustomActionAtIndexPath:(id)a3
{
  v5 = -[UICollectionView _allowsEffectiveSelection](self, "_allowsEffectiveSelection") || dyld_program_sdk_at_least() && (-[UICollectionView _cellForItemAtIndexPath:](self, "_cellForItemAtIndexPath:", v4), (v6 = v4 = a3;

  return v5;
}

- (void)_setDelaysUserInitiatedItemSelection:(BOOL)a3
{
  if (a3)
  {
    v3 = 2048;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFF7FF | v3;
}

- (void)setSelectionFollowsFocus:(BOOL)selectionFollowsFocus
{
  v3 = 1;
  if (selectionFollowsFocus)
  {
    v3 = 2;
  }

  v4 = *(&self->_collectionViewFlags + 1);
  if (((v4 >> 18) & 3) != v3)
  {
    *(&self->_collectionViewFlags + 1) = v4 & 0xFFFFFFFFFFF3FFFFLL | (v3 << 18);
    [(UICollectionView *)self _updateSelectionIsKey];
  }
}

- (void)_setShouldBecomeFocusedOnSelection:(BOOL)a3
{
  v3 = 0x100000;
  if (a3)
  {
    v3 = 0x200000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFFCFFFFFLL | v3;
}

- (BOOL)_shouldBecomeFocusedOnSelection
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 20) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __51__UICollectionView__shouldBecomeFocusedOnSelection__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

uint64_t __51__UICollectionView__shouldBecomeFocusedOnSelection__block_invoke(uint64_t a1)
{
  if (dyld_program_sdk_at_least())
  {
    return 1;
  }

  v3 = [*(a1 + 32) traitCollection];
  v2 = [v3 _splitViewControllerContext] == 3;

  return v2;
}

- (void)setAllowsFocus:(BOOL)allowsFocus
{
  v3 = 0x400000;
  if (allowsFocus)
  {
    v3 = 0x800000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFF3FFFFFLL | v3;
}

- (void)setAllowsFocusDuringEditing:(BOOL)allowsFocusDuringEditing
{
  v3 = 0x1000000;
  if (allowsFocusDuringEditing)
  {
    v3 = 0x2000000;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFCFFFFFFLL | v3;
}

- (BOOL)_defaultAllowsFocusDuringEditing
{
  if (![(UICollectionView *)self allowsSelectionDuringEditing])
  {
    return 0;
  }

  v3 = [(UIView *)self _focusBehavior];
  if ([v3 cellFocusability] == 2)
  {
    v4 = [(UIView *)self traitCollection];
    v5 = [v4 _hasSplitViewControllerContextSidebarColumn];
  }

  else
  {
    v5 = 1;
  }

  return v5;
}

- (BOOL)allowsFocusDuringEditing
{
  v2 = (*(&self->_collectionViewFlags + 1) >> 24) & 3;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __44__UICollectionView_allowsFocusDuringEditing__block_invoke;
  v4[3] = &unk_1E70F3CB0;
  v4[4] = self;
  return _UITriStateToBool(v2, v4);
}

- (BOOL)_effectiveDefaultAllowsFocus
{
  if ([(UICollectionView *)self _isEditing]|| ![(UICollectionView *)self _defaultAllowsFocus])
  {
    v3 = [(UICollectionView *)self _isEditing];
    if (v3)
    {

      LOBYTE(v3) = [(UICollectionView *)self _defaultAllowsFocusDuringEditing];
    }
  }

  else
  {
    LOBYTE(v3) = 1;
  }

  return v3;
}

- (void)_setReorderFeedbackGenerator:(id)a3
{
  v5 = a3;
  if ([(UIFeedbackGenerator *)self->_reorderFeedbackGenerator isActive])
  {
    v7 = [MEMORY[0x1E696AAA8] currentHandler];
    [v7 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2184 description:@"Reorder feedback behavior should not be changed while active."];
  }

  reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
  self->_reorderFeedbackGenerator = v5;
}

- (void)_unhighlightItemAtIndexPath:(id)a3 animated:(BOOL)a4 notifyDelegate:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v8 = a3;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v17 = v8;
    v10 = [(NSMutableSet *)selectionController->_highlightedIndexPaths containsObject:v8];
    v8 = v17;
    if (v10)
    {
      v11 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:v17 isSelection:0 allowMassIndexPath:0 assertIfInvalid:0];
      v12 = self->_selectionController;
      if (v12)
      {
        [(NSMutableSet *)v12->_highlightedIndexPaths removeObject:v17];
      }

      v13 = [(UICollectionView *)self _cellForItemAtIndexPath:v17];
      v14 = v13;
      if (v13)
      {
        [v13 _setHighlighted:0 animated:v6];
      }

      else if (v11)
      {
        v15 = [(UICollectionView *)self collectionViewLayout];
        [v15 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v17 separatorOnly:0];
      }

      if (v5 && (*&self->_collectionViewFlags & 4) != 0)
      {
        v16 = [(UICollectionView *)self _delegateProxy];
        [v16 collectionView:self didUnhighlightItemAtIndexPath:v17];
      }

      v8 = v17;
    }
  }
}

- (BOOL)_highlightItemAtIndexPath:(id)a3 animated:(BOOL)a4 scrollPosition:(unint64_t)a5 notifyDelegate:(BOOL)a6 playFeedback:(BOOL)a7
{
  v7 = a6;
  v33 = a4;
  v39 = *MEMORY[0x1E69E9840];
  v11 = [(UICollectionView *)self _validateSelectionOrHighlightIndexPath:a3 isSelection:0 allowMassIndexPath:1 assertIfInvalid:1, a7];
  if (![(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:a3])
  {
    return 0;
  }

  selectionController = self->_selectionController;
  if (selectionController)
  {
    if (([(NSMutableSet *)selectionController->_highlightedIndexPaths containsObject:a3]& 1) != 0)
    {
      return 0;
    }
  }

  v32 = [(UICollectionView *)self _delegateProxy];
  if (!a3 || [a3 section] == 0x7FFFFFFFFFFFFFFFLL || objc_msgSend(a3, "item") == 0x7FFFFFFFFFFFFFFFLL)
  {
    v14 = self->_selectionController;
    if (v14)
    {
      v15 = [(NSMutableSet *)v14->_highlightedIndexPaths copy];
    }

    else
    {
      v15 = 0;
    }

    v36 = 0u;
    v37 = 0u;
    v34 = 0u;
    v35 = 0u;
    v16 = [v15 countByEnumeratingWithState:&v34 objects:v38 count:16];
    if (!v16)
    {
      goto LABEL_23;
    }

    v17 = v16;
    v18 = *v35;
    while (1)
    {
      for (i = 0; i != v17; ++i)
      {
        if (*v35 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v34 + 1) + 8 * i);
        v21 = [(UICollectionView *)self _cellForItemAtIndexPath:v20];
        v22 = v21;
        if (v21)
        {
          [v21 _setHighlighted:0 animated:v33];
          if (!v7)
          {
            goto LABEL_21;
          }
        }

        else
        {
          v23 = [(UICollectionView *)self collectionViewLayout];
          [v23 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v20 separatorOnly:0];

          if (!v7)
          {
            goto LABEL_21;
          }
        }

        if ((*&self->_collectionViewFlags & 4) != 0)
        {
          [v32 collectionView:self didUnhighlightItemAtIndexPath:v20];
        }

LABEL_21:
      }

      v17 = [v15 countByEnumeratingWithState:&v34 objects:v38 count:16];
      if (!v17)
      {
LABEL_23:
        v24 = self->_selectionController;
        if (v24)
        {
          [(NSMutableSet *)v24->_highlightedIndexPaths removeAllObjects];
        }

LABEL_26:
        v13 = 0;
        goto LABEL_27;
      }
    }
  }

  if (v7 && (*&self->_collectionViewFlags & 1) != 0 && !-[_UISelectionInteraction isHinting](self->_selectionInteraction, "isHinting") && ![v32 collectionView:self shouldHighlightItemAtIndexPath:a3])
  {
    if (!v11)
    {
      goto LABEL_26;
    }

    v30 = [(UICollectionView *)self _cellForItemAtIndexPath:a3];
    v31 = v30;
    if (v30)
    {
      v13 = [v30 _hasCustomSelectionAction];
    }

    else
    {
      v13 = 0;
    }
  }

  else
  {
    v26 = self->_selectionController;
    if (v26)
    {
      [(NSMutableSet *)v26->_highlightedIndexPaths addObject:a3];
    }

    v27 = [(UICollectionView *)self _cellForItemAtIndexPath:a3];
    v28 = v27;
    if (v27)
    {
      [v27 _setHighlighted:1 animated:v33];
    }

    else if (v11)
    {
      v29 = [(UICollectionView *)self collectionViewLayout];
      [v29 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:a3 separatorOnly:0];
    }

    if (a5)
    {
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:a3 atScrollPosition:a5 additionalInsets:v33 animated:0.0, 0.0, 0.0, 0.0];
    }

    if (v7 && (*&self->_collectionViewFlags & 2) != 0)
    {
      [v32 collectionView:self didHighlightItemAtIndexPath:a3];
    }

    v13 = 1;
  }

LABEL_27:

  return v13;
}

- (void)_setNeedsVisibleCellsUpdate:(BOOL)a3 withLayoutAttributes:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v28 = *MEMORY[0x1E69E9840];
  if (a3 && (*(&self->_collectionViewFlags + 9) & 4) == 0)
  {
    if (self->_debugger)
    {
      v7 = [MEMORY[0x1E696AF00] callStackSymbols];
      [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger recordUpdateVisibleCellsScheduledWithCallStack:v7];
    }

    updateVisibleCellsRecursionCount = self->_updateVisibleCellsRecursionCount;
    if (updateVisibleCellsRecursionCount == 95)
    {
      if (self->_contentOffsetRestorationAnchor || self->_scrollingTargetIndexPath)
      {
        if (os_variant_has_internal_diagnostics())
        {
          v19 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v19, OS_LOG_TYPE_FAULT))
          {
            contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
            scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
            v22 = 138412802;
            v23 = self;
            v24 = 2112;
            v25 = contentOffsetRestorationAnchor;
            v26 = 2112;
            v27 = scrollingTargetIndexPath;
            _os_log_fault_impl(&dword_188A29000, v19, OS_LOG_TYPE_FAULT, "Attempting to recover UICollectionView stuck in an update/layout feedback loop. UICollectionView: %@. Scroll position restoration item: %@. Scrolling target: %@", &v22, 0x20u);
          }
        }

        else
        {
          v9 = *(__UILogGetCategoryCachedImpl("Assert", &_setNeedsVisibleCellsUpdate_withLayoutAttributes____s_category) + 8);
          if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
          {
            v10 = self->_contentOffsetRestorationAnchor;
            v11 = self->_scrollingTargetIndexPath;
            v22 = 138412802;
            v23 = self;
            v24 = 2112;
            v25 = v10;
            v26 = 2112;
            v27 = v11;
            _os_log_impl(&dword_188A29000, v9, OS_LOG_TYPE_ERROR, "Attempting to recover UICollectionView stuck in an update/layout feedback loop. UICollectionView: %@. Scroll position restoration item: %@. Scrolling target: %@", &v22, 0x20u);
          }
        }

        [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger printCollectedRecordsForCollectionView:self raiseException:0];
        [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
        [(UICollectionView *)self _clearTargetIndexPathForScrolling];
      }
    }

    else if (updateVisibleCellsRecursionCount >= 100)
    {
      debugger = self->_debugger;
      if (debugger)
      {
        [(_UICollectionViewFeedbackLoopDebugger *)debugger printCollectedRecordsForCollectionView:self raiseException:1];
      }
    }
  }

  v13 = *(&self->_collectionViewFlags + 1);
  v14 = (v13 >> 10) & 1 | v5;
  v15 = 1024;
  if (!v14)
  {
    v15 = 0;
  }

  v16 = v13 & 0xFFFFFFFFFFFFF3FFLL;
  v17 = (v13 >> 11) & 1 | v4;
  v18 = 2048;
  if (!v17)
  {
    v18 = 0;
  }

  *(&self->_collectionViewFlags + 1) = v15 | v16 | v18;
  if ((v14 & 1) != 0 || v17)
  {
    [(UIScrollView *)self setNeedsLayout];
  }
}

- (void)_saveContentOffsetRestorationAnchorIfNecessaryUsingModel:(uint64_t)a1
{
  v81 = *MEMORY[0x1E69E9840];
  v3 = a2;
  if (!a1)
  {
    goto LABEL_21;
  }

  if (*(a1 + 3024))
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923D0);
    if (*CategoryCachedImpl)
    {
      v5 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
      {
        *buf = 134217984;
        v70 = a1;
        v6 = "_saveContentOffset: cv == %p; not saving -- a scrolling target index path exists";
LABEL_57:
        _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, v6, buf, 0xCu);
        goto LABEL_21;
      }
    }

    goto LABEL_21;
  }

  if (!*(a1 + 3000))
  {
    if ((*(a1 + 2738) & 0x40) != 0)
    {
      v12 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923E0);
      if (*v12)
      {
        v5 = *(v12 + 8);
        if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          v70 = a1;
          v6 = "_saveContentOffset: cv == %p; not saving -- saving disabled";
          goto LABEL_57;
        }
      }

      goto LABEL_21;
    }

    v8 = [*(a1 + 2152) _layoutAxis];
    if ((v8 - 1) > 1)
    {
      goto LABEL_21;
    }

    v9 = v8;
    *(a1 + 2736) |= 0x400000u;
    v10 = dyld_program_sdk_at_least();
    if (!v3 || !v10 || !v3[21] || !-[_UICollectionViewSubviewManager hasVisibleCells](*(a1 + 2984)) || [a1 _isReordering])
    {
      v11 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923E8);
      if (*v11)
      {
        v5 = *(v11 + 8);
        if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          v70 = a1;
          v6 = "_saveContentOffset: cv == %p; not saving -- restoration preconditions not met";
          goto LABEL_57;
        }
      }

      goto LABEL_21;
    }

    [a1 contentOffset];
    if ([(UICollectionView *)a1 _isContentOffset:v9 atStartOfAxis:v13, v14])
    {
      v15 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923F0);
      if ((*v15 & 1) == 0)
      {
        goto LABEL_21;
      }

      v16 = *(v15 + 8);
      if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_21;
      }

      v17 = v16;
      v18 = _UIAxisDescription(v9);
      *buf = 134218242;
      v70 = a1;
      v71 = 2112;
      v72 = v18;
      v19 = "_saveContentOffset: cv == %p; not saving -- scrolled to the start of layout axis (%@)";
      v20 = v17;
LABEL_26:
      _os_log_impl(&dword_188A29000, v20, OS_LOG_TYPE_ERROR, v19, buf, 0x16u);
LABEL_53:

LABEL_54:
      goto LABEL_21;
    }

    if ([a1 _isInSetContentOffset])
    {
      v21 = *(a1 + 2744);
      v22 = *(a1 + 2752);
    }

    else
    {
      [a1 contentOffset];
      v21 = v23;
      v22 = v24;
    }

    [a1 _visibleBounds];
    v26 = v25;
    v28 = v27;
    v30 = v29;
    v32 = v31;
    MaxX = v25;
    if ((*(a1 + 106) & 0x40) != 0)
    {
      MaxX = v25;
      if (([a1 _flipsHorizontalAxis] & 1) == 0)
      {
        v83.origin.x = v26;
        v83.origin.y = v28;
        v83.size.width = v30;
        v83.size.height = v32;
        MaxX = CGRectGetMaxX(v83);
      }
    }

    v17 = [(UICollectionViewData *)v3 layoutAttributesForCellsInRect:v26 validateLayout:v28, v30, v32];
    if ([v17 count])
    {
      v68[0] = MEMORY[0x1E69E9820];
      v68[1] = 3221225472;
      v68[2] = __77__UICollectionView__saveContentOffsetRestorationAnchorIfNecessaryUsingModel___block_invoke;
      v68[3] = &unk_1E70FF030;
      v68[4] = a1;
      v34 = [(UICollectionView *)a1 _layoutAttributesClosestToReferencePoint:v17 amongCandidates:v9 onAxis:v68 shouldConsiderBlock:MaxX, v28];
      v18 = v34;
      if (v34)
      {
        v35 = *(a1 + 2984);
        v36 = [v34 indexPath];
        v37 = [(_UICollectionViewSubviewManager *)v35 visibleCellAtIndexPath:v36];

        if (!v37)
        {

          v18 = 0;
        }
      }

      if ((*(a1 + 2726) & 0x20) != 0)
      {
        v38 = [v18 indexPath];
        v39 = [a1 _delegateProxy];
        v40 = [v39 _collectionView:a1 indexPathOfReferenceItemToPreserveContentOffsetWithProposedReference:v38];

        if ((_deferringTokenEqualToToken(v40, v38) & 1) == 0)
        {
          if (v40)
          {
            v41 = [(UICollectionViewData *)v3 layoutAttributesForItemAtIndexPath:v40];
          }

          else
          {
            v41 = 0;
          }

          v18 = v41;
        }
      }

      if (!v18)
      {
        v65 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492400);
        if ((*v65 & 1) == 0)
        {
          goto LABEL_53;
        }

        v66 = *(v65 + 8);
        if (!os_log_type_enabled(v66, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_53;
        }

        v67 = *(a1 + 2280);
        *buf = 134218242;
        v70 = a1;
        v71 = 2112;
        v72 = v67;
        v19 = "_saveContentOffset: cv == %p; not saving -- no attributes available to reference. Current update: %@";
        v20 = v66;
        goto LABEL_26;
      }

      *(a1 + 2736) &= ~0x400000u;
      v45 = [v18 indexPath];
      v46 = *(a1 + 3000);
      *(a1 + 3000) = v45;

      [v18 frame];
      v48 = v47;
      v50 = v49;
      v52 = v51;
      v54 = v53;
      *(a1 + 3008) = v21 - v47;
      *(a1 + 3016) = v22 - v49;
      [a1 _contentInsetIncludingDecorations];
      v56.f64[1] = v55;
      *(a1 + 3008) = vaddq_f64(v56, *(a1 + 3008));
      v57 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492408);
      if ((*v57 & 1) == 0)
      {
        goto LABEL_53;
      }

      v58 = *(v57 + 8);
      if (!os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_53;
      }

      v59 = *(a1 + 3000);
      v44 = v58;
      v60 = [v59 section];
      v61 = [*(a1 + 3000) item];
      v85.origin.x = v48;
      v85.origin.y = v50;
      v85.size.width = v52;
      v85.size.height = v54;
      v62 = NSStringFromCGRect(v85);
      v63 = NSStringFromCGPoint(*(a1 + 3008));
      v82.x = v21;
      v82.y = v22;
      v64 = NSStringFromCGPoint(v82);
      *buf = 134219266;
      v70 = a1;
      v71 = 2048;
      v72 = v60;
      v73 = 2048;
      v74 = v61;
      v75 = 2112;
      v76 = v62;
      v77 = 2112;
      v78 = v63;
      v79 = 2112;
      v80 = v64;
      _os_log_impl(&dword_188A29000, v44, OS_LOG_TYPE_ERROR, "_saveContentOffset: cv == %p; saved (%zd - %zd). Item Frame: %@, offsetIntoAnchor: %@, contentOffset: %@", buf, 0x3Eu);
    }

    else
    {
      v42 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923F8);
      if ((*v42 & 1) == 0)
      {
        goto LABEL_54;
      }

      v43 = *(v42 + 8);
      if (!os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_54;
      }

      v18 = v43;
      v84.origin.x = v26;
      v84.origin.y = v28;
      v84.size.width = v30;
      v84.size.height = v32;
      v44 = NSStringFromCGRect(v84);
      *buf = 134218242;
      v70 = a1;
      v71 = 2112;
      v72 = v44;
      _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_saveContentOffset: cv == %p; not saving -- no layout attributes in visible bounds (%@)", buf, 0x16u);
    }

    goto LABEL_53;
  }

  v7 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4923D8);
  if (*v7)
  {
    v5 = *(v7 + 8);
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v70 = a1;
      v6 = "_saveContentOffset: cv == %p; not saving -- already have an anchor";
      goto LABEL_57;
    }
  }

LABEL_21:
}

void __30__UICollectionView_reloadData__block_invoke_4(uint64_t a1)
{
  v1 = *(a1 + 32);
  if ((*(v1 + 2731) & 0x40) == 0)
  {
    v3 = (v1 + 2288);
    v4 = *v3;
    v5 = v3[1];
    v6 = v3[2];
    v7 = v3[3];
    v11.origin.x = *v3;
    v11.origin.y = v5;
    v11.size.width = v6;
    v11.size.height = v7;
    if (CGRectGetWidth(v11) > 0.0)
    {
      v12.origin.x = v4;
      v12.origin.y = v5;
      v12.size.width = v6;
      v12.size.height = v7;
      if (CGRectGetHeight(v12) > 0.0)
      {
        v13.origin.x = v4;
        v13.origin.y = v5;
        v13.size.width = v6;
        v13.size.height = v7;
        v8 = CGRectGetWidth(v13) * -0.75;
        v14.origin.x = v4;
        v14.origin.y = v5;
        v14.size.width = v6;
        v14.size.height = v7;
        v9 = CGRectGetHeight(v14) * -0.75;
        v15.origin.x = v4;
        v15.origin.y = v5;
        v15.size.width = v6;
        v15.size.height = v7;
        v16 = CGRectInset(v15, v8, v9);
        v10 = [*(a1 + 32) _computeMainPrefetchCandidatesForVisibleBounds:v4 futureVisibleBounds:v5 prefetchVector:{v6, v7, v16.origin.x, v16.origin.y, v16.size.width, v16.size.height, 0, 0}];
      }
    }
  }
}

- (void)_addReloadDataCompletionBlock:(id)a3
{
  v5 = a3;
  if ((*(&self->_collectionViewFlags + 11) & 0x80) == 0)
  {
    v12 = [MEMORY[0x1E696AAA8] currentHandler];
    [v12 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2599 description:{@"Attempting to add a reload data completion block but a reload is not in progress. Collection view: %@", self}];
  }

  v6 = _Block_copy(self->_reloadDataCompletionBlock);
  v7 = v6;
  if (v6)
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __50__UICollectionView__addReloadDataCompletionBlock___block_invoke;
    aBlock[3] = &unk_1E70F77D0;
    v14 = v6;
    v15 = v5;
    v8 = _Block_copy(aBlock);
    reloadDataCompletionBlock = self->_reloadDataCompletionBlock;
    self->_reloadDataCompletionBlock = v8;

    v10 = v14;
  }

  else
  {
    v11 = _Block_copy(v5);
    v10 = self->_reloadDataCompletionBlock;
    self->_reloadDataCompletionBlock = v11;
  }
}

uint64_t __50__UICollectionView__addReloadDataCompletionBlock___block_invoke(uint64_t a1)
{
  (*(*(a1 + 32) + 16))();
  v2 = *(*(a1 + 40) + 16);

  return v2();
}

- (void)_setShouldPersistSelectionOnReloadDataWhenPossible:(BOOL)a3
{
  if (a3)
  {
    v3 = 0x2000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFDFFF | v3;
}

- (void)_setForcePreserveSemanticContentOffsetDuringUpdates:(BOOL)a3
{
  if (a3)
  {
    v3 = 0x4000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFBFFF | v3;
}

- (void)_setShouldSkipForcedLayoutBeforeBatchUpdates:(BOOL)a3
{
  if (a3)
  {
    v3 = 0x8000;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFF7FFF | v3;
}

- (void)setDragDelegate:(id)dragDelegate
{
  obj = dragDelegate;
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragDelegate, obj);
    _UIValidateAccountBasedDelegateRespondsToSelector(obj, sel__collectionView_dataOwnerForDragSession_atIndexPath_);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDragDelegate];
  }
}

- (void)setDropDelegate:(id)dropDelegate
{
  obj = dropDelegate;
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dropDelegate, obj);
    _UIValidateAccountBasedDelegateRespondsToSelector(obj, sel__collectionView_dataOwnerForDropSession_withDestinationIndexPath_);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDropDelegate];
  }
}

- (void)setDragDestinationDelegate:(id)a3
{
  obj = a3;
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  v5 = obj;
  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragDestinationDelegate, obj);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDropDelegate];
    v5 = obj;
  }
}

- (void)setDragSourceDelegate:(id)a3
{
  obj = a3;
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  v5 = obj;
  if (WeakRetained != obj)
  {
    objc_storeWeak(&self->_dragSourceDelegate, obj);
    [(_UICollectionViewDragAndDropController *)&self->_dragAndDropController->super.super.isa didUpdateDragDelegate];
    v5 = obj;
  }
}

- (BOOL)_isCellInvolvedInDragOrDropAnimationAtIndexPath:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:v4];
  LOBYTE(self) = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:v5 atIndexPath:v4];

  return self;
}

- (void)_setPreferredDragDestinationVisualStyle:(int64_t)a3
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    dragAndDropController->_preferredDragDestinationVisualStyle = a3;
  }
}

- (int64_t)_preferredDragDestinationVisualStyle
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    return dragAndDropController->_preferredDragDestinationVisualStyle;
  }

  else
  {
    return 0;
  }
}

- (void)_immediatelyBeginDruidBasedReorderIfPossibleWithTouch:(id)a3
{
  dragAndDropController = self->_dragAndDropController;
  if (dragAndDropController)
  {
    [(_UICollectionViewDragSourceController *)dragAndDropController->_sourceController attemptToBeginDragImmediatelyWithTouch:a3];
  }
}

- (void)_setIsAncestorOfFirstResponder:(BOOL)a3
{
  v3 = a3;
  v26.receiver = self;
  v26.super_class = UICollectionView;
  [(UIView *)&v26 _setIsAncestorOfFirstResponder:?];
  v5 = [(UIView *)self window];
  v6 = [v5 firstResponder];

  if (v6)
  {
    while (1)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        break;
      }

      v7 = [v6 nextResponder];

      v6 = v7;
      if (!v7)
      {
        goto LABEL_9;
      }
    }

    v6 = v6;
    v7 = v6;
    do
    {
      v8 = [v7 superview];

      if (v8 == self)
      {
        break;
      }

      v9 = [v7 superview];

      v7 = v9;
    }

    while (v9);
  }

  else
  {
    v7 = 0;
  }

LABEL_9:
  if (v3)
  {
    if ((*(&self->_collectionViewFlags + 11) & 0x80) == 0)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        objc_storeStrong(&self->_firstResponderView, v7);
        v10 = [v7 _layoutAttributes];
        firstResponderView = v10;
        if (v10)
        {
          p_firstResponderViewType = &self->_firstResponderViewType;
          if (*(v10 + 288))
          {
            *p_firstResponderViewType = 1;
            v23 = [(UICollectionView *)self _indexPathForCell:v7];
            v24 = v23;
            if (!v23)
            {
              v24 = [(UICollectionReusableView *)firstResponderView indexPath];
            }

            objc_storeStrong(&self->_firstResponderIndexPath, v24);
            if (!v23)
            {
            }

            firstResponderViewKind = self->_firstResponderViewKind;
            self->_firstResponderViewKind = 0;
            goto LABEL_35;
          }
        }

        else
        {
          p_firstResponderViewType = &self->_firstResponderViewType;
        }

        *p_firstResponderViewType = 2;
        v13 = [(UICollectionView *)self _indexPathForSupplementaryView:v7];
        v14 = v13;
        if (!v13)
        {
          v14 = [(UICollectionReusableView *)firstResponderView indexPath];
        }

        objc_storeStrong(&self->_firstResponderIndexPath, v14);
        if (!v13)
        {
        }

        firstResponderViewKind = [v7 _layoutAttributes];
        v16 = [(_UILabelConfiguration *)firstResponderViewKind _content];
        v17 = self->_firstResponderViewKind;
        self->_firstResponderViewKind = v16;

LABEL_35:
        goto LABEL_38;
      }
    }

    self->_firstResponderViewType = 0;
    firstResponderIndexPath = self->_firstResponderIndexPath;
    self->_firstResponderIndexPath = 0;

    v22 = self->_firstResponderViewKind;
    self->_firstResponderViewKind = 0;

    firstResponderView = self->_firstResponderView;
    self->_firstResponderView = 0;
  }

  else
  {
    firstResponderView = self->_firstResponderView;
    if (self->_firstResponderViewType)
    {
      firstResponderView = firstResponderView;
      v18 = self->_firstResponderView;
      self->_firstResponderView = 0;

      subviewManager = self->_subviewManager;
      if ((!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:?]& 1) == 0) && firstResponderView != self->_newContentView)
      {
        objc_opt_self();
        if ((__addingResponderToTree & 1) == 0 && ![(UICollectionReusableView *)firstResponderView _isInUpdateAnimation])
        {
          firstResponderViewType = self->_firstResponderViewType;
          if (firstResponderViewType == 2)
          {
            [(UICollectionView *)self _reuseSupplementaryView:firstResponderView];
          }

          else if (firstResponderViewType == 1)
          {
            [(UICollectionView *)self _reuseCell:firstResponderView notifyDidEndDisplaying:1];
          }
        }
      }

      v25 = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = 0;

      self->_firstResponderViewType = 0;
    }

    else
    {
      self->_firstResponderView = 0;
    }
  }

LABEL_38:
}

- (void)_addControlledSubview:(id)a3
{
  v5 = [a3 _layoutAttributes];
  -[UICollectionView _addControlledSubview:atZIndex:forced:](self, "_addControlledSubview:atZIndex:forced:", a3, [v5 zIndex], 1);
}

- (void)_reparentViewIntoSelf:(id)a3
{
  viewsOptedOutOfBeingParentedIntoContainers = self->_viewsOptedOutOfBeingParentedIntoContainers;
  if (viewsOptedOutOfBeingParentedIntoContainers)
  {
    [(NSMutableSet *)viewsOptedOutOfBeingParentedIntoContainers addObject:a3];
  }

  else
  {
    v6 = [MEMORY[0x1E695DFA8] setWithObject:a3];
    v7 = self->_viewsOptedOutOfBeingParentedIntoContainers;
    self->_viewsOptedOutOfBeingParentedIntoContainers = v6;
  }

  [(UICollectionView *)self _addControlledSubview:a3];
}

- (void)_reparentViewIntoCorrectContainer:(id)a3
{
  [(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers removeObject:?];
  if (![(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers count])
  {
    viewsOptedOutOfBeingParentedIntoContainers = self->_viewsOptedOutOfBeingParentedIntoContainers;
    self->_viewsOptedOutOfBeingParentedIntoContainers = 0;
  }

  [(UICollectionView *)self _addControlledSubview:a3];
}

- (void)_addControlledSubview:(id)a3 atZIndex:(int64_t)a4 forced:(BOOL)a5 initialAttributes:(id)a6
{
  v41 = *MEMORY[0x1E69E9840];
  v11 = a6;
  v12 = v11;
  if (v11)
  {
    v13 = v11;
  }

  else
  {
    v13 = [a3 _layoutAttributes];
  }

  v14 = v13;
  if (os_variant_has_internal_diagnostics())
  {
    if (!v14)
    {
      v34 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v34, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412546;
        v38 = self;
        v39 = 2112;
        v40 = a3;
        _os_log_fault_impl(&dword_188A29000, v34, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempted to add controlled subview with nil layout attributes. Collection view %@; view: %@", buf, 0x16u);
      }
    }
  }

  else if (!v14)
  {
    v36 = *(__UILogGetCategoryCachedImpl("Assert", &_addControlledSubview_atZIndex_forced_initialAttributes____s_category) + 8);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412546;
      v38 = self;
      v39 = 2112;
      v40 = a3;
      _os_log_impl(&dword_188A29000, v36, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempted to add controlled subview with nil layout attributes. Collection view %@; view: %@", buf, 0x16u);
    }
  }

  v15 = [(UICollectionView *)self _subviewRouterForView:a3 attributes:v14 createIfNecessary:1];
  if (!v15)
  {
    v35 = [MEMORY[0x1E696AAA8] currentHandler];
    [v35 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:2874 description:{@"UICollectionView internal inconsistency: attempted to add controlled subview without a subview router. Collection view %@; view: %@", self, a3}];
  }

  objc_storeStrong(&self->_newContentView, a3);
  if (!a5)
  {
    v16 = [a3 superview];
    if (v15)
    {
      v17 = *(v15 + 40);
    }

    else
    {
      v17 = 0;
    }

    v18 = v17;
    v19 = v18;
    if (v16 == v18)
    {
      v20 = [a3 _layoutAttributes];
      v21 = [v20 zIndex];

      if (v21 == a4)
      {
        goto LABEL_18;
      }
    }

    else
    {
    }
  }

  if ([(UICollectionViewLayout *)self->_layout _orthogonalScrollingElementShouldAppearBelowForAttributes:v14])
  {
    v22 = -1;
  }

  else
  {
    v22 = 1;
  }

  [(_UICollectionViewSubviewRouter *)v15 addControlledSubview:a3 zIndex:a4 orderMode:v22];
LABEL_18:
  v23 = self->_layout;
  v24 = a3;
  v25 = v24;
  if (v24 && v23)
  {
    v26 = [v24 effectiveUserInterfaceLayoutDirection];
    if (v26 != [(UICollectionViewLayout *)v23 developmentLayoutDirection])
    {
      v27 = [(UICollectionViewLayout *)v23 _wantsRightToLeftHorizontalMirroringIfNeeded];
      goto LABEL_24;
    }

    if ([v25 _flipsHorizontalAxis])
    {
      v27 = 0;
LABEL_24:
      [v25 _setFlipsHorizontalAxis:v27];
    }
  }

  if (dyld_program_sdk_at_least())
  {
    v28 = [v25 _layoutAttributes];
    v29 = [v28 _zPosition];

    if (v29 >= 1)
    {
      if ([(UICollectionView *)self hasActiveDrag]|| (v30 = 0.0, [(UICollectionView *)self hasActiveDrop]))
      {
        v30 = v29;
      }

      v31 = [v25 layer];
      [v31 setZPosition:v30];
    }
  }

  if (v15)
  {
    orthogonalScrollerController = self->_orthogonalScrollerController;
    if (orthogonalScrollerController)
    {
      if (*(v15 + 32) == 1)
      {
        [(_UICollectionViewOrthogonalScrollerSectionController *)&orthogonalScrollerController->super.isa adjustElementHierarchyOrderingForOrthogonalElementIfNeeded:v25 layoutAttributes:v14];
      }
    }
  }

  newContentView = self->_newContentView;
  self->_newContentView = 0;
}

- (id)_subviewRouterForView:(id)a3 attributes:(id)a4 createIfNecessary:(BOOL)a5
{
  v5 = a5;
  v8 = a4;
  if (([(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers containsObject:a3]& 1) != 0)
  {
    v9 = 0;
    v10 = 0;
  }

  else
  {
    v9 = [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:v8];
    v10 = [(UICollectionViewLayout *)self->_layout _shouldAddElementToSectionContainer:v8];
  }

  v11 = [v8 indexPath];
  v12 = [v11 section];

  if (v9)
  {
    v13 = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa subviewRouterForSection:v12];
  }

  else
  {
    if (v10)
    {
      v14 = [(UICollectionView *)self _sectionContainerViewForSectionIndex:v12 createIfNecessary:v5];
      v15 = v14;
      if (v14)
      {
        v16 = *(v14 + 408);
      }

      else
      {
        v16 = 0;
      }

      v17 = v16;

      goto LABEL_12;
    }

    v13 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  }

  v17 = v13;
LABEL_12:

  return v17;
}

- (id)_subviewRouterForOrthogonalScrollViewAtSection:(int64_t)a3
{
  v5 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v6 = [(UICollectionView *)self _sectionContainerViewForSectionIndex:a3 createIfNecessary:1];
  v7 = v6;
  if (v6)
  {
    v8 = *(v6 + 408);

    v5 = v8;
  }

  return v5;
}

- (void)_addScrollPocketAsSubview:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  [(_UICollectionViewSubviewRouter *)v5 addControlledSubview:v4 zIndex:999999999 orderMode:1];
}

- (BOOL)_addGlassGroupView:(id)a3 material:(id)a4
{
  v5 = a3;
  v6 = [(UICollectionViewLayout *)self->_layout _glassGroupZIndex];
  if (v6 != 0x7FFFFFFFFFFFFFFFLL)
  {
    v7 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
    [(_UICollectionViewSubviewRouter *)v7 addControlledSubview:v5 zIndex:v6 orderMode:1];
  }

  return v6 != 0x7FFFFFFFFFFFFFFFLL;
}

- (void)_setPocketRelativeSubview:(id)a3 isOver:(BOOL)a4 forKey:(id)a5
{
  v6 = a4;
  v8 = a3;
  v9 = a5;
  if (!v8 || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    [(UIScrollView *)&v10 _setPocketRelativeSubview:v8 isOver:v6 forKey:v9];
  }
}

- (void)_addSubview:(id)a3 positioned:(int64_t)a4 relativeTo:(id)a5
{
  v8 = a3;
  v14 = a4;
  v9 = a5;
  v10 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  if (v10)
  {
    v11 = v10;
    v12 = [(_UICollectionViewSubviewRouter *)v10 shouldAddSubview:v8 atPosition:&v14 relativeTo:v9 creatingBookmarkIfNecessary:1];

    if (v12)
    {
      v13.receiver = self;
      v13.super_class = UICollectionView;
      [(UIView *)&v13 _addSubview:v8 positioned:v14 relativeTo:v9];
    }
  }
}

- (void)bringSubviewToFront:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v6 = [(_UICollectionViewSubviewRouter *)v5 shouldBringSubviewToFront:v4];

  if (v6)
  {
    v7.receiver = self;
    v7.super_class = UICollectionView;
    [(UIView *)&v7 bringSubviewToFront:v4];
  }
}

- (void)sendSubviewToBack:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  if (v5)
  {
    v6 = v5;
    v9 = 0;
    v7 = [(_UICollectionViewSubviewRouter *)v5 shouldAddSubview:v4 atPosition:&v9 relativeTo:0 creatingBookmarkIfNecessary:0];

    if (v7)
    {
      v8.receiver = self;
      v8.super_class = UICollectionView;
      [(UIView *)&v8 sendSubviewToBack:v4];
    }
  }
}

- (void)exchangeSubviewAtIndex:(int64_t)a3 withSubviewAtIndex:(int64_t)a4
{
  v7 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  v8 = [(_UICollectionViewSubviewRouter *)v7 shouldExchangeSubviewAtIndex:a3 withSubviewAtIndex:a4];

  if (v8)
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIView *)&v9 exchangeSubviewAtIndex:a3 withSubviewAtIndex:a4];
  }
}

- (void)_willRemoveSubview:(id)a3
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  v4 = a3;
  [(UIView *)&v6 _willRemoveSubview:v4];
  v5 = [(UICollectionView *)&self->super.super.super.super.isa subviewRouter];
  [(_UICollectionViewSubviewRouter *)v5 willRemoveSubview:v4];
}

- (id)_sectionContainerViewForSectionIndex:(int64_t)a3 createIfNecessary:(BOOL)a4
{
  v4 = a4;
  v7 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:?];
  v8 = v7;
  if (v7 && *(v7 + 8) == 1)
  {
    v20 = 0;
    v21 = &v20;
    v22 = 0x3032000000;
    v23 = __Block_byref_object_copy__39;
    v24 = __Block_byref_object_dispose__39;
    sectionToContainerViewMap = self->_sectionToContainerViewMap;
    v10 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
    v25 = [(NSMutableDictionary *)sectionToContainerViewMap objectForKeyedSubscript:v10];

    v11 = v21[5];
    if (v11)
    {
      v12 = 1;
    }

    else
    {
      v12 = !v4;
    }

    if (!v12)
    {
      v15[0] = MEMORY[0x1E69E9820];
      v15[1] = 3221225472;
      v15[2] = __75__UICollectionView__sectionContainerViewForSectionIndex_createIfNecessary___block_invoke;
      v15[3] = &unk_1E70FED68;
      v18 = &v20;
      v16 = v8;
      v17 = self;
      v19 = a3;
      [UIView performWithoutAnimation:v15];

      v11 = v21[5];
    }

    v13 = v11;
    _Block_object_dispose(&v20, 8);
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

void __75__UICollectionView__sectionContainerViewForSectionIndex_createIfNecessary___block_invoke(uint64_t a1)
{
  v2 = [_UICollectionSectionContainerView alloc];
  v3 = *(a1 + 32);
  v4 = 0.0;
  v5 = 0.0;
  v6 = 0.0;
  v7 = 0.0;
  v8 = 0.0;
  if (v3)
  {
    v8 = v3[30];
    v5 = v3[31];
    v6 = v3[32];
    v7 = v3[33];
  }

  v9 = [(_UICollectionSectionContainerView *)v2 initWithFrame:v8, v5, v6, v7];
  v10 = *(*(a1 + 48) + 8);
  v11 = *(v10 + 40);
  *(v10 + 40) = v9;

  [*(*(*(a1 + 48) + 8) + 40) frame];
  [*(*(*(a1 + 48) + 8) + 40) setBounds:?];
  v12 = *(a1 + 32);
  if (v12)
  {
    v4 = *(v12 + 48);
  }

  v13 = [*(*(*(a1 + 48) + 8) + 40) layer];
  [v13 setCornerRadius:v4];

  v14 = *(*(*(a1 + 48) + 8) + 40);
  v15 = *(*(a1 + 40) + 3120);
  v16 = [MEMORY[0x1E696AD98] numberWithInteger:*(a1 + 56)];
  [v15 setObject:v14 forKeyedSubscript:v16];

  v17 = [(UICollectionView *)*(a1 + 40) subviewRouter];
  [(_UICollectionViewSubviewRouter *)v17 addContainerView:?];
}

- (void)_reconfigureSectionContainersForUpdate:(id)a3
{
  v4 = a3;
  v5 = self->_sectionToContainerViewMap;
  v6 = [(UICollectionViewLayout *)self->_layout _customContainerSectionIndexes];
  if ([v6 count] || -[NSMutableDictionary count](v5, "count"))
  {
    v7 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:{objc_msgSend(v6, "count")}];
    v11[0] = MEMORY[0x1E69E9820];
    v11[1] = 3221225472;
    v11[2] = __59__UICollectionView__reconfigureSectionContainersForUpdate___block_invoke;
    v11[3] = &unk_1E70FED90;
    v12 = v4;
    v13 = v6;
    v8 = v7;
    v14 = v8;
    v15 = self;
    [(NSMutableDictionary *)v5 enumerateKeysAndObjectsUsingBlock:v11];
    sectionToContainerViewMap = self->_sectionToContainerViewMap;
    self->_sectionToContainerViewMap = v8;
    v10 = v8;
  }
}

void __59__UICollectionView__reconfigureSectionContainersForUpdate___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v14 = a2;
  v5 = a3;
  v6 = *(a1 + 32);
  v7 = [v14 integerValue];
  if (v6)
  {
    v7 = [v6 finalSectionIndexForInitialSectionIndex:v7];
  }

  if (v7 == 0x7FFFFFFFFFFFFFFFLL || ![*(a1 + 40) containsIndex:v7])
  {
    v10 = *(*(a1 + 56) + 3128);
    if (v10)
    {
      [v10 addObject:v5];
    }

    else
    {
      v11 = [MEMORY[0x1E695DF70] arrayWithObject:v5];
      v12 = *(a1 + 56);
      v13 = *(v12 + 3128);
      *(v12 + 3128) = v11;
    }
  }

  else
  {
    v8 = *(a1 + 48);
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:v7];
    [v8 setObject:v5 forKeyedSubscript:v9];
  }
}

void __48__UICollectionView__layoutSectionContainerViews__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v11 = a3;
  v5 = [*(*(a1 + 32) + 2152) _sectionDescriptorForSectionIndex:{objc_msgSend(a2, "integerValue")}];
  v6 = v5;
  if (v5)
  {
    [v11 setFrame:{v5[30], v5[31], v5[32], v5[33]}];
    [v11 frame];
    [v11 setBounds:?];
    v7 = v6[6];
    v8 = [v11 layer];
    [v8 setCornerRadius:v7];

    v9 = *MEMORY[0x1E69796E8];
    v10 = [v11 layer];
    [v10 setCornerCurve:v9];

    [v11 setClipsToBounds:*(v6 + 8)];
  }
}

- (void)setSemanticContentAttribute:(int64_t)a3
{
  v5 = [(UIView *)self semanticContentAttribute];
  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIView *)&v20 setSemanticContentAttribute:a3];
  if (v5 != a3)
  {
    subviewManager = self->_subviewManager;
    v19[0] = MEMORY[0x1E69E9820];
    v19[1] = 3221225472;
    v19[2] = __48__UICollectionView_setSemanticContentAttribute___block_invoke;
    v19[3] = &__block_descriptor_40_e70_v48__0Q8__NSIndexPath_16__NSString_24__UICollectionReusableView_32_B40l;
    v19[4] = a3;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v19];
    }

    v7 = self->_layout;
    v8 = self;
    v9 = v8;
    if (v7)
    {
      v10 = [(UIView *)v8 effectiveUserInterfaceLayoutDirection];
      if (v10 == [(UICollectionViewLayout *)v7 developmentLayoutDirection])
      {
        if (![(UIView *)v9 _flipsHorizontalAxis])
        {
          goto LABEL_10;
        }

        v11 = 0;
      }

      else
      {
        v11 = [(UICollectionViewLayout *)v7 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [(UIScrollView *)v9 _setFlipsHorizontalAxis:v11];
    }

LABEL_10:

    backgroundView = v9->_backgroundView;
    v13 = self->_layout;
    v14 = backgroundView;
    v15 = v14;
    if (v13)
    {
      v16 = v14 == 0;
    }

    else
    {
      v16 = 1;
    }

    if (v16)
    {
      goto LABEL_19;
    }

    v17 = [(UIView *)v14 effectiveUserInterfaceLayoutDirection];
    if (v17 == [(UICollectionViewLayout *)v13 developmentLayoutDirection])
    {
      if (![(UIView *)v15 _flipsHorizontalAxis])
      {
LABEL_19:

        [(UICollectionView *)v9 reloadData];
        return;
      }

      v18 = 0;
    }

    else
    {
      v18 = [(UICollectionViewLayout *)v13 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v15 _setFlipsHorizontalAxis:v18];
    goto LABEL_19;
  }
}

- (void)setBounds:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v41 = *MEMORY[0x1E69E9840];
  [(UIView *)self bounds];
  v8 = v42.origin.x;
  v9 = v42.origin.y;
  v10 = v42.size.width;
  v11 = v42.size.height;
  v47.origin.x = x;
  v47.origin.y = y;
  v47.size.width = width;
  v47.size.height = height;
  if (CGRectEqualToRect(v42, v47))
  {
    return;
  }

  if ((*(&self->_collectionViewFlags + 11) & 0x20) != 0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492338);
    if (*CategoryCachedImpl)
    {
      v24 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        v25 = v24;
        v43.origin.x = v8;
        v43.origin.y = v9;
        v43.size.width = v10;
        v43.size.height = v11;
        v26 = NSStringFromCGRect(v43);
        v44.origin.x = x;
        v44.origin.y = y;
        v44.size.width = width;
        v44.size.height = height;
        v27 = NSStringFromCGRect(v44);
        *buf = 134218498;
        v36 = self;
        v37 = 2112;
        v38 = v26;
        v39 = 2112;
        v40 = v27;
        _os_log_impl(&dword_188A29000, v25, OS_LOG_TYPE_ERROR, "setBounds: cv == %p; oldBounds == %@; newBounds == %@", buf, 0x20u);
      }
    }

    v34.receiver = self;
    v34.super_class = UICollectionView;
    [(UIScrollView *)&v34 setBounds:x, y, width, height];
    goto LABEL_34;
  }

  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    v14 = 0;
    if (!dyld_program_sdk_at_least())
    {
      v16 = 0;
      v17 = 0;
      goto LABEL_16;
    }

LABEL_6:
    if ([(UICollectionViewLayout *)self->_layout _preparedForBoundsChanges]|| (v14 & 1) != 0)
    {
      goto LABEL_12;
    }

LABEL_14:
    v16 = 0;
    v14 = 0;
    v17 = 0;
    goto LABEL_16;
  }

  collectionViewDataFlags = collectionViewData->_collectionViewDataFlags;
  if (dyld_program_sdk_at_least())
  {
    v14 = (*&collectionViewDataFlags >> 3) & 1;
    goto LABEL_6;
  }

  if ((*&collectionViewDataFlags & 8) == 0)
  {
    goto LABEL_14;
  }

LABEL_12:
  if ([(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:x, y, width, height])
  {
    v16 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:x fromOldBounds:y, width, height, v8, v9, v10, v11];
    v14 = 1;
    v17 = 1;
  }

  else
  {
    v16 = 0;
    v17 = 0;
    v14 = 1;
  }

LABEL_16:
  if ((*(&self->_collectionViewFlags + 13) & 1) == 0)
  {
    self->_preRotationBounds.origin.x = v8;
    self->_preRotationBounds.origin.y = v9;
    self->_preRotationBounds.size.width = v10;
    self->_preRotationBounds.size.height = v11;
    *(&self->_collectionViewFlags + 1) |= 0x10000000000uLL;
  }

  if ((*(&self->_collectionViewFlags + 18) & 8) == 0)
  {
    if (![(UIScrollView *)self isScrollAnimating])
    {
      [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    }

    [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  }

  debugger = self->_debugger;
  if (debugger)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewRectPropertyChange:@"bounds" fromRect:v8 toRect:v9, v10, v11, x, y, width, height];
  }

  v33.receiver = self;
  v33.super_class = UICollectionView;
  [(UIScrollView *)&v33 setBounds:x, y, width, height];
  if (v17)
  {
    v19 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492340);
    if (*v19)
    {
      v28 = *(v19 + 8);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
      {
        v29 = v28;
        v45.origin.x = v8;
        v45.origin.y = v9;
        v45.size.width = v10;
        v45.size.height = v11;
        NSStringFromCGRect(v45);
        v30 = v32 = v14;
        v46.origin.x = x;
        v46.origin.y = y;
        v46.size.width = width;
        v46.size.height = height;
        v31 = NSStringFromCGRect(v46);
        *buf = 134218498;
        v36 = self;
        v37 = 2112;
        v38 = v30;
        v39 = 2112;
        v40 = v31;
        _os_log_impl(&dword_188A29000, v29, OS_LOG_TYPE_ERROR, "setBounds: cv == %p; invalidating for oldBounds == %@; newBounds == %@", buf, 0x20u);

        v14 = v32;
      }
    }

    [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v16];
    if (v14)
    {
      v20 = [v16 _invalidatedSupplementaryViews];
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v20 == 0];

      activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
      self->_activeOrthogonalPrefetchingContext = 0;

LABEL_29:
      if (v10 != width || v11 != height)
      {
        [(UICollectionView *)self _updateDefaultLayoutMargins];
      }

      goto LABEL_33;
    }

    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    v23 = self->_activeOrthogonalPrefetchingContext;
    self->_activeOrthogonalPrefetchingContext = 0;
  }

  else
  {
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v14 ^ 1u];
    v22 = self->_activeOrthogonalPrefetchingContext;
    self->_activeOrthogonalPrefetchingContext = 0;

    if (((v14 ^ 1) & 1) == 0)
    {
      goto LABEL_29;
    }
  }

LABEL_33:

LABEL_34:
  if (v10 != width || v11 != height)
  {
    [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  }
}

- (void)setFrame:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v62 = *MEMORY[0x1E69E9840];
  [(UIView *)self frame];
  v71.origin.x = v8;
  v71.origin.y = v9;
  v71.size.width = v10;
  v71.size.height = v11;
  v63.origin.x = x;
  v63.origin.y = y;
  v63.size.width = width;
  v63.size.height = height;
  if (CGRectEqualToRect(v63, v71))
  {
    return;
  }

  [(UIView *)self frame];
  v49 = v13;
  v50 = v12;
  v51 = v14;
  v52 = v15;
  [(UIView *)self bounds];
  v16 = v64.origin.x;
  v17 = v64.origin.y;
  v19 = v18;
  v21 = v20;
  v64.size.width = width;
  v64.size.height = height;
  v72.origin.x = v64.origin.x;
  v72.origin.y = v64.origin.y;
  v72.size.width = v19;
  v72.size.height = v21;
  v22 = CGRectEqualToRect(v64, v72);
  collectionViewData = self->_collectionViewData;
  if (collectionViewData)
  {
    LODWORD(v24) = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
  }

  else
  {
    LODWORD(v24) = 0;
  }

  if (dyld_program_sdk_at_least())
  {
    LODWORD(v24) = [(UICollectionViewLayout *)self->_layout _preparedForBoundsChanges]| v24;
  }

  v25 = v24 ^ 1;
  if (((v24 ^ 1 | v22) & 1) != 0 || ![(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:v16, v17, width, height])
  {
    v26 = 0;
    v27 = 0;
  }

  else
  {
    v26 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:v16 fromOldBounds:v17, width, height, v16, v17, v19, v21];
    v27 = 1;
  }

  if ((*(&self->_collectionViewFlags + 13) & 1) == 0)
  {
    self->_preRotationBounds.origin.x = v16;
    self->_preRotationBounds.origin.y = v17;
    self->_preRotationBounds.size.width = v19;
    self->_preRotationBounds.size.height = v21;
    *(&self->_collectionViewFlags + 1) |= 0x10000000000uLL;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &setFrame____s_category);
  if (*CategoryCachedImpl)
  {
    v42 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
      v43 = v42;
      [(UIView *)self frame];
      NSStringFromCGRect(v69);
      v47 = v24 ^ 1;
      v24 = v48 = v24;
      v70.origin.x = x;
      v70.origin.y = y;
      v70.size.width = width;
      v70.size.height = height;
      v44 = NSStringFromCGRect(v70);
      v45 = v44;
      v46 = @"NO";
      *buf = 134218754;
      v55 = self;
      if (v27)
      {
        v46 = @"YES";
      }

      v56 = 2112;
      v57 = v24;
      v58 = 2112;
      v59 = v44;
      v60 = 2112;
      v61 = v46;
      _os_log_impl(&dword_188A29000, v43, OS_LOG_TYPE_ERROR, "setFrame: cv == %p; oldFrame == %@; newFrame == %@ invalidateLayout == %@", buf, 0x2Au);

      v25 = v47;
      LOBYTE(v24) = v48;
    }
  }

  debugger = self->_debugger;
  v30 = v51;
  if (debugger)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewRectPropertyChange:@"frame" fromRect:v50 toRect:v49, v51, v52, x, y, width, height];
  }

  v53.receiver = self;
  v53.super_class = UICollectionView;
  [(UIScrollView *)&v53 setFrame:x, y, width, height];
  if (!v22)
  {
    if (v27)
    {
      v31 = self->_collectionViewData;
      if (v31)
      {
        v32 = v31->_contentSize.width;
        v33 = v31->_contentSize.height;
      }

      else
      {
        v32 = 0.0;
        v33 = 0.0;
      }

      [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v26];
      if ((dyld_program_sdk_at_least() & 1) == 0)
      {
        v34 = [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
      }

      if ((*(&self->_collectionViewFlags + 11) & 0x40) == 0 && ![(UIScrollView *)self isTracking]&& ![(UICollectionViewLayout *)self->_layout _estimatesSizes])
      {
        v65.origin.x = x;
        v65.origin.y = y;
        v65.size.width = width;
        v65.size.height = height;
        if (!CGRectIsEmpty(v65))
        {
          v66.origin.y = v49;
          v66.origin.x = v50;
          v66.size.width = v51;
          v66.size.height = v52;
          if (!CGRectIsEmpty(v66))
          {
            [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
            [(UICollectionView *)self _contentOffsetForNewFrame:x oldFrame:y newContentSize:width andOldContentSize:height, v50, v49, v51, v52, v35, v36, *&v32, *&v33];
            [(UICollectionView *)self setContentOffset:?];
          }
        }
      }

      [(UIView *)self bounds];
      MinX = CGRectGetMinX(v67);
      v38 = MinX - CGRectGetMinX(self->_preRotationBounds);
      [(UIView *)self bounds];
      MinY = CGRectGetMinY(v68);
      v40 = MinY - CGRectGetMinY(self->_preRotationBounds);
      self->_rotationBoundsOffset.x = v38;
      self->_rotationBoundsOffset.y = v40;
      if ((v24 & 1) == 0)
      {
        [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v25 & 1];
        v30 = v51;
        goto LABEL_16;
      }

      v41 = [v26 _invalidatedSupplementaryViews];
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v41 == 0];

      v30 = v51;
    }

    else
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v25 & 1];
      if ((v24 & 1) == 0)
      {
        goto LABEL_16;
      }
    }

    if (v19 != width || v21 != height)
    {
      [(UICollectionView *)self _updateDefaultLayoutMargins];
    }
  }

LABEL_16:
  if ((v30 != width || v52 != height) && (*(&self->_collectionViewFlags + 13) & 0x80) != 0)
  {
    [(UICollectionView *)self _scrollFirstResponderCellToVisible:+[UIView _isInAnimationBlock]^ 1];
  }
}

- (double)_alignedContentMarginGivenMargin:(double)a3
{
  v4 = [(UICollectionView *)self collectionViewLayout];
  [v4 _alignedContentMarginGivenMargin:a3];
  v6 = v5;

  return v6;
}

- (void)_setDefaultLayoutMargins:(UIEdgeInsets)a3 fromViewController:(BOOL)a4
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v5 = *(&self->_collectionViewFlags + 1);
  if ((v5 & 0x40000000000000) == 0 || a4)
  {
    v6.f64[0] = a3.top;
    v6.f64[1] = a3.left;
    v7.f64[0] = a3.bottom;
    v7.f64[1] = a3.right;
    if ((vminv_u16(vmovn_s32(vuzp1q_s32(vceqq_f64(v6, *&self->_defaultLayoutMargins.top), vceqq_f64(v7, *&self->_defaultLayoutMargins.bottom)))) & 1) == 0)
    {
      v8 = 0x40000000000000;
      if (!a4)
      {
        v8 = 0;
      }

      *(&self->_collectionViewFlags + 1) = v5 & 0xFFBFFFFFFFFFFFFFLL | v8;
      self->_defaultLayoutMargins = a3;
      v9 = *(&self->_collectionViewFlags + 1);
      if ((v9 & 0x10000000000000) == 0)
      {
        *(&self->_collectionViewFlags + 1) = v9 | 0x20000000000000;
        [(UICollectionView *)self setLayoutMargins:?];
        *(p_collectionViewFlags + 1) = *(p_collectionViewFlags + 1) & 0xFFDFFFFFFFFFFFFFLL | (((v9 >> 53) & 1) << 53);
      }
    }
  }
}

- (void)setLayoutMargins:(UIEdgeInsets)a3
{
  right = a3.right;
  bottom = a3.bottom;
  left = a3.left;
  top = a3.top;
  [(UIView *)self layoutMargins];
  [(UIView *)self _rawLayoutMargins];
  if (left != v11 || top != v8 || right != v10 || bottom != v9)
  {
    *(&self->_collectionViewFlags + 1) |= ~(*(&self->_collectionViewFlags + 1) >> 1) & 0x10000000000000;
    v15.receiver = self;
    v15.super_class = UICollectionView;
    [(UIView *)&v15 setLayoutMargins:top, left, bottom, right];
  }
}

- (void)_layoutMarginsDidChangeFromOldMargins:(UIEdgeInsets)a3
{
  right = a3.right;
  bottom = a3.bottom;
  left = a3.left;
  top = a3.top;
  v17.receiver = self;
  v17.super_class = UICollectionView;
  [(UIView *)&v17 _layoutMarginsDidChangeFromOldMargins:?];
  [(UIView *)self layoutMargins];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  if ([UICollectionViewLayout _shouldInvalidateLayoutForUpdatedLayoutMargins:"_shouldInvalidateLayoutForUpdatedLayoutMargins:fromOldMargins:" fromOldMargins:?])
  {
    debugger = self->_debugger;
    if (debugger)
    {
      [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewInsetsPropertyChange:@"layoutMargins" fromInsets:top toInsets:left, bottom, right, v9, v11, v13, v15];
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (void)_safeAreaInsetsDidChangeFromOldInsets:(UIEdgeInsets)a3
{
  right = a3.right;
  bottom = a3.bottom;
  left = a3.left;
  top = a3.top;
  v17.receiver = self;
  v17.super_class = UICollectionView;
  [(UIView *)&v17 _safeAreaInsetsDidChangeFromOldInsets:?];
  [(UIView *)self safeAreaInsets];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  if ([UICollectionViewLayout _shouldInvalidateLayoutForUpdatedSafeAreaInsets:"_shouldInvalidateLayoutForUpdatedSafeAreaInsets:fromOldInsets:" fromOldInsets:?])
  {
    debugger = self->_debugger;
    if (debugger)
    {
      [(_UICollectionViewFeedbackLoopDebugger *)debugger recordCollectionViewInsetsPropertyChange:@"safeAreaInsets" fromInsets:top toInsets:left, bottom, right, v9, v11, v13, v15];
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (void)setDirectionalLayoutMargins:(NSDirectionalEdgeInsets)a3
{
  trailing = a3.trailing;
  bottom = a3.bottom;
  leading = a3.leading;
  top = a3.top;
  [(UIView *)self _rawLayoutMargins];
  v12 = *(&self->super.super._viewFlags + 2);
  if ((v12 & 0x400000) != 0)
  {
    v13 = v11;
  }

  else
  {
    v13 = v9;
  }

  if ((v12 & 0x400000) == 0)
  {
    v9 = v11;
  }

  if (leading != v13 || top != v8 || trailing != v9 || bottom != v10)
  {
    *(&self->_collectionViewFlags + 1) |= ~(*(&self->_collectionViewFlags + 1) >> 1) & 0x10000000000000;
    v17.receiver = self;
    v17.super_class = UICollectionView;
    [(UIView *)&v17 setDirectionalLayoutMargins:top, leading, bottom, trailing];
  }
}

- (void)setAlwaysBounceVertical:(BOOL)a3
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setAlwaysBounceVertical:a3];
}

- (void)setAlwaysBounceHorizontal:(BOOL)a3
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setAlwaysBounceHorizontal:a3];
}

- (void)_setDefaultAlwaysBounceVertical:(BOOL)a3 horizontal:(BOOL)a4
{
  if ((*(&self->_collectionViewFlags + 14) & 8) == 0)
  {
    v4 = a4;
    v7.receiver = self;
    v7.super_class = UICollectionView;
    [(UIScrollView *)&v7 setAlwaysBounceVertical:a3];
    v6.receiver = self;
    v6.super_class = UICollectionView;
    [(UIScrollView *)&v6 setAlwaysBounceHorizontal:v4];
  }
}

- (void)setScrollEnabled:(BOOL)a3
{
  v3 = a3;
  v5 = [(UIScrollView *)self isScrollEnabled];
  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 setScrollEnabled:v3];
  if (v5 != v3)
  {
    [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
  }
}

- (void)_didMoveFromWindow:(id)a3 toWindow:(id)a4
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 _didMoveFromWindow:a3 toWindow:a4];
  v5 = +[_UIHDRUsageCoordinator sharedInstance];
  [(_UIHDRUsageCoordinator *)v5 applyConstrainedHDROverrideToView:?];

  [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
}

- (void)_didMoveFromSuperview:(id)a3
{
  v4.receiver = self;
  v4.super_class = UICollectionView;
  [(UIView *)&v4 _didMoveFromSuperview:a3];
  [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
}

- (void)_geometryChanged:(id *)a3 forAncestor:(id)a4
{
  v6 = a4;
  if (v6 && [(UICollectionView *)self _canDeriveVisibleBoundsFromContainingScrollView])
  {
    WeakRetained = objc_loadWeakRetained(&self->_containerScrollView);
    v8 = _UITreeFirstCommonAncestor(v6, WeakRetained, sel_superview);

    if (v8)
    {
      var0 = a3->var0;
      if (WeakRetained == v6)
      {
        if ((var0 & 0xC) != 0)
        {
          [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
        }
      }

      else
      {
        if ((var0 & 6) != 0)
        {
          [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
          var0 = a3->var0;
        }

        if ((var0 & 0x10) != 0)
        {
          [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
        }
      }
    }
  }

  v10.receiver = self;
  v10.super_class = UICollectionView;
  [(UIScrollView *)&v10 _geometryChanged:a3 forAncestor:v6];
}

- (void)_setShouldDeriveVisibleBoundsFromContainingScrollView:(BOOL)a3
{
  v3 = *(&self->_collectionViewFlags + 1);
  if (((((v3 & 0x2000000000000) == 0) ^ a3) & 1) == 0)
  {
    v4 = 0x2000000000000;
    if (!a3)
    {
      v4 = 0;
    }

    *(&self->_collectionViewFlags + 1) = v3 & 0xFFFDFFFFFFFFFFFFLL | v4;
    [(UICollectionView *)self _updateDerivesVisibleBoundsFromContainingScrollView];
  }
}

- (CGRect)_effectiveVisibleBoundsForBounds:(CGRect)a3
{
  top = self->_visibleRectInsets.top;
  left = self->_visibleRectInsets.left;
  v5 = a3.origin.x + left;
  v6 = a3.origin.y + top;
  v7 = a3.size.width - (left + self->_visibleRectInsets.right);
  v8 = a3.size.height - (top + self->_visibleRectInsets.bottom);
  result.size.height = v8;
  result.size.width = v7;
  result.origin.y = v6;
  result.origin.x = v5;
  return result;
}

- (BOOL)_checkForPreferredAttributesInView:(id)a3 originalAttributes:(id)a4
{
  if (!-[UICollectionView __hasTransitionLayoutAttributes](self, "__hasTransitionLayoutAttributes") && ([a3 _arePreferredAttributesValid] & 1) == 0)
  {
    v8 = _UISetCurrentFallbackEnvironment(self);
    v9 = [a4 copy];
    if (v9)
    {
      p_layout = &self->_layout;
      v11 = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
      v12 = v9[288] & 1;
      if (v11)
      {
LABEL_5:
        [(UICollectionViewLayout *)*p_layout _prepareForPreferredAttributesQueryForView:a3 withLayoutAttributes:v9];
        v13 = 1;
        goto LABEL_7;
      }

      v13 = 0;
    }

    else
    {
      v29 = [MEMORY[0x1E696AAA8] currentHandler];
      v30 = [a3 _layoutAttributes];
      [v29 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3563 description:{@"UICollectionView internal inconsistency: missing original layout attributes necessary to update preferred attributes for view: %@. Attributes from view: %@; collection view: %@", a3, v30, self}];

      p_layout = &self->_layout;
      v12 = 0;
      v13 = 0;
      if ([(UICollectionViewLayout *)self->_layout _estimatesSizes])
      {
        goto LABEL_5;
      }
    }

LABEL_7:
    currentUpdate = self->_currentUpdate;
    if (currentUpdate && (*&currentUpdate->_flags & 2) != 0 || +[UIView _isInAnimationBlockWithAnimationsEnabled])
    {
      v15 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleViewWithLayoutAttributes:a4];
      v16 = v15 == a3;
    }

    else
    {
      v16 = 0;
    }

    v17 = [a3 _preferredLayoutAttributesFittingAttributes:v9 isAnimatingExistingView:v16];
    if (v13)
    {
      [(UICollectionViewLayout *)*p_layout _postProcessPreferredAttributes:v17 forView:a3];
    }

    intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
    if (intrinsicContentSizeInvalidationContext)
    {
      if (!v12)
      {
        if (!v17 || (*(v17 + 288) & 3) != 0)
        {
          goto LABEL_24;
        }

        v21 = [(_UILabelConfiguration *)v17 _content];
        v20 = [v17 indexPath];
        [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext _removeInvalidatedSupplementaryOfKind:v21 indexPath:v20];
        goto LABEL_21;
      }

      v19 = [v17 indexPath];
      [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext _removeInvalidatedItemIndexPath:v19];
    }

    else if (!v12)
    {
      goto LABEL_24;
    }

    v20 = [v17 indexPath];
    if ([(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes count])
    {
      [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes removeObject:v20];
    }

    v21 = v20;
LABEL_21:

LABEL_24:
    if (!-[UICollectionViewLayout _wantsInvalidateLayoutForPreferredLayoutAttributes](*p_layout, "_wantsInvalidateLayoutForPreferredLayoutAttributes") && ([v17 isSizeEqualForPreferredFittingAttributes:a4] & 1) != 0 || !-[UICollectionViewLayout shouldInvalidateLayoutForPreferredLayoutAttributes:withOriginalAttributes:](*p_layout, "shouldInvalidateLayoutForPreferredLayoutAttributes:withOriginalAttributes:", v17, a4))
    {
      goto LABEL_36;
    }

    v22 = [(UICollectionViewLayout *)*p_layout invalidationContextForPreferredLayoutAttributes:v17 withOriginalAttributes:a4];
    v23 = v22;
    if (!v13)
    {
      goto LABEL_32;
    }

    v24 = [v22 invalidatedItemIndexPaths];
    if (![v24 count])
    {
      v25 = [v23 invalidatedSupplementaryIndexPaths];
      if (![v25 count])
      {
        v27 = [v23 invalidatedDecorationIndexPaths];
        v28 = [v27 count];

        if (!v28 && (*(&self->_collectionViewFlags + 9) & 4) == 0)
        {
LABEL_35:

LABEL_36:
          _UIRestorePreviousFallbackEnvironment(v8);

          return 0;
        }

LABEL_32:
        if (![v23 _intent])
        {
          [v23 _setIntent:5];
        }

        [(UICollectionViewLayout *)*p_layout invalidateLayoutWithContext:v23];
        goto LABEL_35;
      }
    }

    goto LABEL_32;
  }

  return 0;
}

- (BOOL)_hasFocusedCellForIndexPath:(id)a3 shouldUsePreUpdateData:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(UICollectionView *)self _focusedItemState];
  if (v4)
  {
    currentUpdate = self->_currentUpdate;
    if (currentUpdate)
    {
      v9 = currentUpdate->_oldFocusedItemState;

      v7 = v9;
    }
  }

  if (v7)
  {
    v10 = *(v7 + 8);
    if (v10 && !*(v7 + 32))
    {
      v12 = *(v7 + 16);
      v11 = [v6 isEqual:v12];
    }

    else
    {
      v11 = 0;
    }
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (void)setPrefetchingEnabled:(BOOL)prefetchingEnabled
{
  if ((*(&self->_collectionViewFlags + 4) & 1) != prefetchingEnabled)
  {
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFE | prefetchingEnabled;
    if (!prefetchingEnabled)
    {
      [(UICollectionView *)self _resetPrefetchState];
    }
  }
}

- (void)_setShouldPrefetchCellsWhenPerformingReloadData:(BOOL)a3
{
  v3 = 0x80000000000000;
  if (!a3)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFF7FFFFFFFFFFFFFLL | v3;
}

- (id)_prefetchingContextForOrthogonalScrollingSection:(int64_t)a3
{
  v5 = [(UICollectionViewLayout *)self->_layout _orthogonalScrollingSections];
  v6 = [v5 containsIndex:a3];

  if (v6)
  {
    orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
    v8 = [MEMORY[0x1E696AD98] numberWithInteger:a3];
    v9 = [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts objectForKeyedSubscript:v8];
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (void)_setPrefetchingContext:(id)a3 forOrthogonalScrollingSection:(int64_t)a4
{
  v10 = a3;
  v6 = [(UICollectionViewLayout *)self->_layout _orthogonalScrollingSections];
  v7 = [v6 containsIndex:a4];

  if (v7)
  {
    orthogonalSectionPrefetchingContexts = self->_orthogonalSectionPrefetchingContexts;
    v9 = [MEMORY[0x1E696AD98] numberWithInteger:a4];
    [(NSMutableDictionary *)orthogonalSectionPrefetchingContexts setObject:v10 forKeyedSubscript:v9];
  }
}

- (void)_notifyWillDisplayCellIfNeeded:(id)a3 forIndexPath:(id)a4
{
  v8 = a3;
  v6 = a4;
  if (([v8 _hasNotifiedIsDisplaying] & 1) == 0)
  {
    if (*(&self->_collectionViewFlags + 1))
    {
      v7 = [(UICollectionView *)self _delegateProxy];
      [v7 collectionView:self willDisplayCell:v8 forItemAtIndexPath:v6];
    }

    [v8 _notifyIsDisplaying:1];
  }
}

- (void)_notifyDidEndDisplayingCellIfNeeded:(id)a3 forIndexPath:(id)a4
{
  v13 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  if ([v6 _hasNotifiedIsDisplaying])
  {
    if (os_variant_has_internal_diagnostics())
    {
      if (!v7)
      {
        v9 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v9, OS_LOG_TYPE_FAULT))
        {
          v11 = 138412290;
          v12 = v6;
          _os_log_fault_impl(&dword_188A29000, v9, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", &v11, 0xCu);
        }
      }
    }

    else if (!v7)
    {
      v10 = *(__UILogGetCategoryCachedImpl("Assert", &_notifyDidEndDisplayingCellIfNeeded_forIndexPath____s_category) + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        v11 = 138412290;
        v12 = v6;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", &v11, 0xCu);
      }
    }

    [v6 _notifyIsDisplaying:0];
    if ((*(&self->_collectionViewFlags + 1) & 4) != 0)
    {
      v8 = [(UICollectionView *)self _delegateProxy];
      [v8 collectionView:self didEndDisplayingCell:v6 forItemAtIndexPath:v7];
    }
  }
}

- (void)_notifyWillDisplaySupplementaryView:(id)a3 forElementKind:(id)a4 atIndexPath:(id)a5
{
  v11 = a3;
  v8 = a4;
  v9 = a5;
  if (([v11 _hasNotifiedIsDisplaying] & 1) == 0)
  {
    if ((*(&self->_collectionViewFlags + 1) & 2) != 0)
    {
      v10 = [(UICollectionView *)self _delegateProxy];
      [v10 collectionView:self willDisplaySupplementaryView:v11 forElementKind:v8 atIndexPath:v9];
    }

    [v11 _notifyIsDisplaying:1];
  }
}

- (void)_notifyDidEndDisplayingSupplementaryView:(id)a3
{
  v19 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if ([v4 _hasNotifiedIsDisplaying])
  {
    [v4 _notifyIsDisplaying:0];
    if ((*(&self->_collectionViewFlags + 1) & 8) != 0)
    {
      v5 = [v4 _layoutAttributes];
      v6 = [(_UILabelConfiguration *)v5 _content];
      v7 = [v5 indexPath];
      has_internal_diagnostics = os_variant_has_internal_diagnostics();
      if (v5)
      {
        v9 = v6 == 0;
      }

      else
      {
        v9 = 1;
      }

      v11 = v9 || v7 == 0;
      if (has_internal_diagnostics)
      {
        if (v11)
        {
          v13 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v13, OS_LOG_TYPE_FAULT))
          {
            v15 = 138412546;
            v16 = v4;
            v17 = 2112;
            v18 = v5;
            _os_log_fault_impl(&dword_188A29000, v13, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: layout attributes are invalid for view %@: %@", &v15, 0x16u);
          }
        }
      }

      else if (v11)
      {
        v14 = *(__UILogGetCategoryCachedImpl("Assert", &_notifyDidEndDisplayingSupplementaryView____s_category) + 8);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          v15 = 138412546;
          v16 = v4;
          v17 = 2112;
          v18 = v5;
          _os_log_impl(&dword_188A29000, v14, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: layout attributes are invalid for view %@: %@", &v15, 0x16u);
        }
      }

      v12 = [(UICollectionView *)self _delegateProxy];
      [v12 collectionView:self didEndDisplayingSupplementaryView:v4 forElementOfKind:v6 atIndexPath:v7];
    }
  }
}

- (id)_preparedCellForItemAtIndexPath:(id)a3 withLayoutAttributes:(id)a4 applyAttributes:(BOOL)a5 isFocused:(BOOL)a6 notify:(BOOL)a7
{
  v7 = a7;
  v8 = a6;
  v9 = a5;
  if (![(UICollectionView *)self _prefetchingAllowed])
  {
    goto LABEL_19;
  }

  v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:a3];
  v14 = v13;
  if (v13)
  {
    v15 = *(v13 + 16);
    if (!v15)
    {
      v17 = 0;
      goto LABEL_17;
    }

    v16 = v15;
    if ((*(v15 + 288) & 1) == 0)
    {
      v17 = v15;
LABEL_17:

      goto LABEL_18;
    }

    v17 = v14[3];

    if (v17)
    {
      v18 = [(UICollectionView *)self _updatePrefetchItemIfNeeded:v14 forIndexPath:a3 withLayoutAttributes:a4 willDisplay:1];
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:a3];
      if (!v18)
      {
        [(UICollectionView *)self _reusePrefetchedCell:v17];
        goto LABEL_17;
      }

      CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &_preparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify____s_category);
      v20 = *(CategoryCachedImpl + 8);
      if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v20))
      {
        *v23 = 134218240;
        *&v23[4] = [a3 section];
        *&v23[12] = 2048;
        *&v23[14] = [a3 item];
        _os_signpost_emit_unreliably_with_name_impl();
      }

      if ([v17 _isHiddenForReuse])
      {
        [v17 _setHiddenForReuse:0];
        if (!v8)
        {
LABEL_13:
          if (!v7)
          {
LABEL_15:

            goto LABEL_20;
          }

LABEL_14:
          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v17 forIndexPath:a3, *v23, *&v23[16]];
          goto LABEL_15;
        }
      }

      else if (!v8)
      {
        goto LABEL_13;
      }

      v22 = [_UICollectionViewFocusedItemState stateWithReusableView:v17];
      [(UICollectionView *)self _setFocusedItemState:v22];

      if (!v7)
      {
        goto LABEL_15;
      }

      goto LABEL_14;
    }
  }

LABEL_18:

LABEL_19:
  v17 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:a3 withLayoutAttributes:a4 applyAttributes:v9 isFocused:v8 notify:v7];
LABEL_20:

  return v17;
}

- (id)_createPreparedCellForItemAtIndexPath:(id)a3 withLayoutAttributes:(id)a4 applyAttributes:(BOOL)a5 isFocused:(BOOL)a6 notify:(BOOL)a7
{
  v7 = a7;
  v75 = a6;
  v8 = a5;
  v96 = *MEMORY[0x1E69E9840];
  context = objc_autoreleasePoolPush();
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained)
  {
    if (!a4)
    {
LABEL_67:
      v56 = [MEMORY[0x1E696AAA8] currentHandler];
      [v56 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3875 description:{@"UICollectionView internal bug: Attempting to create a cell with invalid attributes. Collection View: %@, Attributes: %@, Index Path: %@", self, a4, a3}];

      goto LABEL_4;
    }
  }

  else
  {
    v55 = [MEMORY[0x1E696AAA8] currentHandler];
    [v55 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3874 description:@"UICollectionView dataSource is not set"];

    if (!a4)
    {
      goto LABEL_67;
    }
  }

  if ((*(a4 + 288) & 1) == 0)
  {
    goto LABEL_67;
  }

LABEL_4:
  firstResponderIndexPath = self->_firstResponderIndexPath;
  if (firstResponderIndexPath && self->_firstResponderViewType == 1 && [(NSIndexPath *)firstResponderIndexPath isEqual:a3])
  {
    [(UICollectionView *)self _configureCachedCellForDisplay:self->_firstResponderView withIndexPath:a3 layoutAttributesToUpdate:a4];
    v15 = self->_firstResponderView;
    goto LABEL_65;
  }

  if ([(UICollectionView *)self _hasFocusedCellForIndexPath:a3 shouldUsePreUpdateData:0])
  {
    v16 = [(UICollectionView *)self _focusedItemState];
    v15 = [(_UICollectionViewFocusedItemState *)v16 cell];

    v17 = [(UICollectionView *)self _focusedItemState];
    v18 = v17;
    if (v17)
    {
      v19 = *(v17 + 16);
    }

    else
    {
      v19 = 0;
    }

    v20 = v19;
    v21 = [a3 isEqual:v20];

    if ((v21 & 1) == 0)
    {
      v58 = [MEMORY[0x1E696AAA8] currentHandler];
      v59 = [(UICollectionView *)self _focusedItemState];
      v60 = v59;
      if (v59)
      {
        v61 = *(v59 + 16);
      }

      else
      {
        v61 = 0;
      }

      v62 = v61;
      [v58 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3891 description:{@"Collection view focus state inconsistency. Focused index path %@ is not equal to index path of focused cell %@.", v62, a3}];
    }

    [(UICollectionView *)self _configureCachedCellForDisplay:v15 withIndexPath:a3 layoutAttributesToUpdate:a4];
    if (v7)
    {
      [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v15 forIndexPath:a3];
    }

    goto LABEL_65;
  }

  if (self->_cellBeingReconfigured)
  {
    v57 = [MEMORY[0x1E696AAA8] currentHandler];
    [v57 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3903 description:{@"Performing side effects on UICollectionView that cause a new cell to be requested while an existing item is being reconfigured is not allowed. Check the backtrace to see what's causing this. Collection view: %@", self}];
  }

  v22 = _UISetCurrentFallbackEnvironment(self);
  v23 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v23 | 4;
  v84 = 0;
  v85 = &v84;
  v86 = 0x3032000000;
  v87 = __Block_byref_object_copy__39;
  v88 = __Block_byref_object_dispose__39;
  v89 = 0;
  v73 = v22;
  v74 = v23;
  if (_isNotifyingIdleObservers == 1)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492348);
    v25 = *(CategoryCachedImpl + 8);
    if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v25))
    {
      v26 = [a3 section];
      v27 = [a3 item];
      *buf = 134218240;
      v91 = v26;
      v92 = 2048;
      v93 = v27;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v83[0] = MEMORY[0x1E69E9820];
    v83[1] = 3221225472;
    v83[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke;
    v83[3] = &unk_1E70FEE00;
    v83[4] = self;
    v83[5] = &v84;
    v83[6] = a3;
    [UIView performWithoutAnimation:v83];
    v28 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492350);
    v29 = *(v28 + 8);
    if (os_signpost_id_make_with_pointer(*(v28 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v29))
    {
      v30 = [v85[5] _hasBeenReused];
      *buf = 67109120;
      LODWORD(v91) = v30;
LABEL_29:
      _os_signpost_emit_unreliably_with_name_impl();
    }
  }

  else
  {
    v31 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492358);
    v32 = *(v31 + 8);
    if (os_signpost_id_make_with_pointer(*(v31 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v32))
    {
      v33 = [a3 section];
      v34 = [a3 item];
      *buf = 134218240;
      v91 = v33;
      v92 = 2048;
      v93 = v34;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v82[0] = MEMORY[0x1E69E9820];
    v82[1] = 3221225472;
    v82[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_400;
    v82[3] = &unk_1E70FEE00;
    v82[4] = self;
    v82[5] = &v84;
    v82[6] = a3;
    [UIView performWithoutAnimation:v82];
    v35 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492360);
    v29 = *(v35 + 8);
    if (os_signpost_id_make_with_pointer(*(v35 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v29))
    {
      v36 = [v85[5] _hasBeenReused];
      *buf = 67109120;
      LODWORD(v91) = v36;
      goto LABEL_29;
    }
  }

  v37 = v85[5];
  if (!v37)
  {
    v63 = [MEMORY[0x1E696AAA8] currentHandler];
    v64 = [a3 _ui_shortDescription];
    [v63 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3923 description:{@"The collection view's data source returned nil when asked to provide a cell for an item. Collection view: %@; index path: %@", self, v64}];

    v37 = v85[5];
  }

  v38 = [v37 reuseIdentifier];
  v39 = v38 == 0;

  if (v39)
  {
    v65 = [MEMORY[0x1E696AAA8] currentHandler];
    v66 = [a3 _ui_shortDescription];
    [v65 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3924 description:{@"The collection view's data source returned a cell without a reuseIdentifier. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, v66, v85[5]}];
  }

  if (([v85[5] _wasDequeued] & 1) == 0)
  {
    v67 = [MEMORY[0x1E696AAA8] currentHandler];
    v68 = [a3 _ui_shortDescription];
    [v67 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3925 description:{@"The collection view's data source returned a cell that was not dequeued from the collection view using a cell registration or reuse identifier. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, v68, v85[5]}];
  }

  v40 = [v85[5] superview];
  if (!v40)
  {
    if (!dyld_program_sdk_at_least())
    {
      goto LABEL_39;
    }

    v40 = [MEMORY[0x1E696AAA8] currentHandler];
    v72 = [a3 _ui_shortDescription];
    [v40 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3926 description:{@"The collection view's data source returned a cell that is not in the view hierarchy. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, v72, v85[5]}];
  }

LABEL_39:
  v41 = self->_subviewManager;
  if ([(_UICollectionViewSubviewManager *)v41 isViewInReuseQueue:?])
  {
    if (dyld_program_sdk_at_least())
    {
      v42 = [MEMORY[0x1E696AAA8] currentHandler];
      v43 = [a3 _ui_shortDescription];
      [v42 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3931 description:@"The collection view's data source returned a cell that is in the reuse queue. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", self, v43, v85[5]];
    }

    else
    {
      v42 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492368) + 8);
      if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
      {
        v44 = [a3 _ui_shortDescription];
        v45 = v85[5];
        *buf = 138412802;
        v91 = self;
        v92 = 2112;
        v93 = v44;
        v94 = 2112;
        v95 = v45;
        _os_log_impl(&dword_188A29000, v42, OS_LOG_TYPE_ERROR, "The collection view's data source returned a cell that is in the reuse queue. Cells must be retrieved by calling -dequeueConfiguredReusableCellWithRegistration:forIndexPath:item: or -dequeueReusableCellWithReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; cell: %@", buf, 0x20u);
      }
    }

    [(_UICollectionViewSubviewManager *)v41 ensureViewIsRemovedFromReuseQueue:?];
    [(UICollectionView *)self _prepareViewForReuse:?];
  }

  else if ([v85[5] _isHiddenForReuse])
  {
    [v85[5] _setHiddenForReuse:0];
  }

  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v85[5], [a4 zIndex], 0, a4);
  }

  v46 = dyld_program_sdk_at_least();
  v47 = v46;
  if (v46)
  {
    [(UICollectionView *)self _configureCellForDisplay:v85[5] indexPath:a3 cached:0];
  }

  v81[0] = MEMORY[0x1E69E9820];
  v81[1] = 3221225472;
  v81[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_418;
  v81[3] = &unk_1E70FEE28;
  v81[4] = self;
  v81[5] = &v84;
  v81[6] = a4;
  [UIView performWithoutAnimation:v81];
  if (v8)
  {
    v80[0] = MEMORY[0x1E69E9820];
    v80[1] = 3221225472;
    v80[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_2;
    v80[3] = &unk_1E70FEE50;
    v80[4] = self;
    v80[5] = &v84;
    v80[6] = a4;
    [UIView performWithoutAnimation:v80];
  }

  else
  {
    v48 = [v85[5] _layoutAttributes];
    v49 = [(UICollectionViewLayoutAttributes *)v48 __indexPath];
    LOBYTE(v49) = [v49 isEqual:-[UICollectionViewLayoutAttributes __indexPath](a4)];

    if ((v49 & 1) == 0)
    {
      v50 = [a4 copy];
      [v50 setIndexPath:-[UICollectionViewLayoutAttributes __indexPath](a4)];
      v77[0] = MEMORY[0x1E69E9820];
      v77[1] = 3221225472;
      v77[2] = __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_3;
      v77[3] = &unk_1E70FEE78;
      v77[4] = self;
      v51 = v50;
      v78 = v51;
      v79 = &v84;
      [UIView performWithoutAnimation:v77];
    }
  }

  if ((v47 & 1) == 0)
  {
    [(UICollectionView *)self _configureCellForDisplay:v85[5] indexPath:a3 cached:0];
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFB | (4 * ((v74 >> 2) & 1));
  if (v75)
  {
    v52 = [_UICollectionViewFocusedItemState stateWithReusableView:?];
    [(UICollectionView *)self _setFocusedItemState:v52];
  }

  if (v41)
  {
    [(NSHashTable *)v41->_dequeuedViews removeObject:v85[5]];
  }

  if (v7)
  {
    [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v85[5] forIndexPath:a3];
  }

  _UIRestorePreviousFallbackEnvironment(v73);
  v53 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492370);
  if (*v53)
  {
    v69 = *(v53 + 8);
    if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR))
    {
      v70 = v85[5];
      v71 = [a3 _ui_shortDescription];
      *buf = 134218498;
      v91 = self;
      v92 = 2112;
      v93 = v70;
      v94 = 2112;
      v95 = v71;
      _os_log_impl(&dword_188A29000, v69, OS_LOG_TYPE_ERROR, "[UICV %p] _createPreparedCell: %@ indexPath:%@", buf, 0x20u);
    }
  }

  v15 = v85[5];

  _Block_object_dispose(&v84, 8);
LABEL_65:
  objc_autoreleasePoolPop(context);
  return v15;
}

void __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) cellForItemAtIndexPath:*(a1 + 48)];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

void __112__UICollectionView__createPreparedCellForItemAtIndexPath_withLayoutAttributes_applyAttributes_isFocused_notify___block_invoke_400(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) cellForItemAtIndexPath:*(a1 + 48)];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

- (void)_prepareViewForReuse:(uint64_t)a1
{
  v17 = *MEMORY[0x1E69E9840];
  v4 = a2;
  if (a1)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_prepareViewForReuse____s_category);
    if (*CategoryCachedImpl)
    {
      v10 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *buf = 134218242;
        v14 = a1;
        v15 = 2112;
        v16 = v4;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "[CV %p] _prepareViewForReuse: %@", buf, 0x16u);
      }
    }

    v6 = *(a1 + 3232);
    objc_storeStrong((a1 + 3232), a2);
    v11[0] = MEMORY[0x1E69E9820];
    v11[1] = 3221225472;
    v11[2] = __41__UICollectionView__prepareViewForReuse___block_invoke;
    v11[3] = &unk_1E70F3590;
    v7 = v4;
    v12 = v7;
    [UIView performWithoutAnimation:v11];
    [v7 _setHiddenForReuse:0];
    v8 = *(a1 + 3232);
    *(a1 + 3232) = v6;
    v9 = v6;
  }
}

- (id)_createPreparedSupplementaryViewForElementOfKind:(id)a3 atIndexPath:(id)a4 layout:(id)a5 withLayoutAttributes:(id)a6 applyAttributes:(BOOL)a7
{
  v65 = a7;
  v94 = *MEMORY[0x1E69E9840];
  v11 = a3;
  v67 = a5;
  v12 = a6;
  context = objc_autoreleasePoolPush();
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (!WeakRetained)
  {
    v41 = [MEMORY[0x1E696AAA8] currentHandler];
    [v41 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:3995 description:@"UICollectionView dataSource is not set"];
  }

  if ((*(&self->_collectionViewFlags + 7) & 2) == 0 && (!v12 || (v12[36] & 2) == 0))
  {
    v14 = 0;
    goto LABEL_51;
  }

  firstResponderIndexPath = self->_firstResponderIndexPath;
  if (firstResponderIndexPath && self->_firstResponderViewType == 2 && [(NSIndexPath *)firstResponderIndexPath isEqual:a4]&& [(NSString *)self->_firstResponderViewKind isEqual:v11])
  {
    v14 = self->_firstResponderView;
    goto LABEL_51;
  }

  v63 = _UISetCurrentFallbackEnvironment(self);
  v16 = self->_subviewManager;
  v64 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v64 | 4;
  v78 = 0;
  v79 = &v78;
  v80 = 0x3032000000;
  v81 = __Block_byref_object_copy__39;
  v82 = __Block_byref_object_dispose__39;
  v83 = 0;
  if (!v12 || (v12[36] & 2) == 0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492378);
    v18 = *(CategoryCachedImpl + 8);
    if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v18))
    {
      *buf = 0;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v74[0] = MEMORY[0x1E69E9820];
    v74[1] = 3221225472;
    v74[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke;
    v74[3] = &unk_1E70FEEA0;
    v76 = &v78;
    v74[4] = self;
    v19 = v11;
    v75 = v19;
    v77 = a4;
    [UIView performWithoutAnimation:v74];
    v20 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492380);
    v21 = *(v20 + 8);
    if (os_signpost_id_make_with_pointer(*(v20 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v21))
    {
      *buf = 0;
      _os_signpost_emit_unreliably_with_name_impl();
    }

    v22 = v79[5];
    if (!v22)
    {
      v42 = [MEMORY[0x1E696AAA8] currentHandler];
      v43 = [a4 _ui_shortDescription];
      [v42 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4026 description:{@"The collection view's data source returned nil when asked to provide a supplementary view. Collection view: %@; element kind: %@; index path: %@", self, v19, v43}];

      v22 = v79[5];
    }

    if (([v22 _wasDequeued] & 1) == 0)
    {
      v44 = [MEMORY[0x1E696AAA8] currentHandler];
      v45 = [a4 _ui_shortDescription];
      [v44 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4027 description:{@"The collection view's data source returned a supplementary view that was not dequeued from the collection view using a supplementary registration or reuse identifier. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", self, v19, v45, v79[5]}];
    }

    v23 = [v79[5] superview];
    if (!v23)
    {
      if (!dyld_program_sdk_at_least())
      {
        goto LABEL_30;
      }

      v23 = [MEMORY[0x1E696AAA8] currentHandler];
      v52 = [a4 _ui_shortDescription];
      [v23 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4028 description:{@"The collection view's data source returned a supplementary view that is not in the view hierarchy. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; index path: %@; supplementary view: %@", self, v52, v79[5]}];
    }

LABEL_30:
    v31 = [v79[5] _elementKind];
    v32 = [v31 isEqualToString:v19];

    if ((v32 & 1) == 0)
    {
      if (dyld_program_sdk_at_least() && (_UIIsPrivateMainBundle() & 1) == 0)
      {
        log = [MEMORY[0x1E696AAA8] currentHandler];
        v53 = [v79[5] _elementKind];
        v54 = [a4 _ui_shortDescription];
        [log handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4029 description:@"The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@", self, v19, v53, v54, v79[5]];
      }

      else if (dyld_program_sdk_at_least() && _UIIsPrivateMainBundle())
      {
        if (os_variant_has_internal_diagnostics())
        {
          log = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(log, OS_LOG_TYPE_FAULT))
          {
            v58 = [v79[5] _elementKind];
            v59 = [a4 _ui_shortDescription];
            v60 = v79[5];
            *buf = 138413314;
            v85 = self;
            v86 = 2112;
            v87 = v19;
            v88 = 2112;
            v89 = v58;
            v90 = 2112;
            v91 = v59;
            v92 = 2112;
            v93 = v60;
            _os_log_fault_impl(&dword_188A29000, log, OS_LOG_TYPE_FAULT, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This is a hard assert for other clients and requires immediate attention.", buf, 0x34u);
          }
        }

        else
        {
          log = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492388) + 8);
          if (os_log_type_enabled(log, OS_LOG_TYPE_ERROR))
          {
            v46 = [v79[5] _elementKind];
            v47 = [a4 _ui_shortDescription];
            v48 = v79[5];
            *buf = 138413314;
            v85 = self;
            v86 = 2112;
            v87 = v19;
            v88 = 2112;
            v89 = v46;
            v90 = 2112;
            v91 = v47;
            v92 = 2112;
            v93 = v48;
            _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This is a hard assert for other clients and requires immediate attention.", buf, 0x34u);
          }
        }
      }

      else if (os_variant_has_internal_diagnostics())
      {
        log = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(log, OS_LOG_TYPE_FAULT))
        {
          v55 = [v79[5] _elementKind];
          v56 = [a4 _ui_shortDescription];
          v57 = v79[5];
          *buf = 138413314;
          v85 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = v55;
          v90 = 2112;
          v91 = v56;
          v92 = 2112;
          v93 = v57;
          _os_log_fault_impl(&dword_188A29000, log, OS_LOG_TYPE_FAULT, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This will become an assert in a future version.", buf, 0x34u);
        }
      }

      else
      {
        log = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492390) + 8);
        if (os_log_type_enabled(log, OS_LOG_TYPE_ERROR))
        {
          v49 = [v79[5] _elementKind];
          v50 = [a4 _ui_shortDescription];
          v51 = v79[5];
          *buf = 138413314;
          v85 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = v49;
          v90 = 2112;
          v91 = v50;
          v92 = 2112;
          v93 = v51;
          _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view with an unexpected element kind. Collection view: %@; requested element kind: %@; supplementary view element kind: %@; index path: %@; supplementary view: %@ This will become an assert in a future version.", buf, 0x34u);
        }
      }
    }

    if ([(_UICollectionViewSubviewManager *)v16 isViewInReuseQueue:?])
    {
      if (dyld_program_sdk_at_least())
      {
        v33 = [MEMORY[0x1E696AAA8] currentHandler];
        v34 = [a4 _ui_shortDescription];
        [v33 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:4033 description:@"The collection view's data source returned a supplementary view that is in the reuse queue. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", self, v19, v34, v79[5]];
      }

      else
      {
        v33 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492398) + 8);
        if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
        {
          v35 = [a4 _ui_shortDescription];
          v36 = v79[5];
          *buf = 138413058;
          v85 = self;
          v86 = 2112;
          v87 = v19;
          v88 = 2112;
          v89 = v35;
          v90 = 2112;
          v91 = v36;
          _os_log_impl(&dword_188A29000, v33, OS_LOG_TYPE_ERROR, "The collection view's data source returned a supplementary view that is in the reuse queue. Supplementary views must be retrieved by calling dequeueConfiguredReusableSupplementaryViewWithRegistration:forIndexPath: or -dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:. Collection view: %@; element kind: %@; index path: %@; supplementary view: %@", buf, 0x2Au);
        }
      }

      [(_UICollectionViewSubviewManager *)v16 ensureViewIsRemovedFromReuseQueue:?];
      [(UICollectionView *)self _prepareViewForReuse:?];
    }

    else if ([v79[5] _isHiddenForReuse])
    {
      [v79[5] _setHiddenForReuse:0];
    }

    v28 = 1;
    goto LABEL_40;
  }

  v24 = [(_UILabelConfiguration *)v12 _content];
  v25 = [(_UILabelConfiguration *)v12 _content];
  v26 = [(UICollectionView *)self _dequeueReusableViewOfKind:v24 withIdentifier:v25 forIndexPath:a4 viewCategory:2];
  v27 = v79[5];
  v79[5] = v26;

  if (!v79[5])
  {
    v29 = [v67 _decorationViewForLayoutAttributes:v12];
    v30 = v79[5];
    v79[5] = v29;

    [v79[5] _willRevealWithLayoutAttributes:v12];
    v28 = 2;
LABEL_41:
    -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v79[5], [v12 zIndex], 0, v12);
    goto LABEL_42;
  }

  v28 = 2;
LABEL_40:
  if ((dyld_program_sdk_at_least() & 1) == 0)
  {
    goto LABEL_41;
  }

LABEL_42:
  v37 = dyld_program_sdk_at_least();
  v38 = v37;
  if (v37)
  {
    [(UICollectionView *)self _configureSupplementaryViewForDisplay:v79[5] withElementKind:v11 indexPath:a4 elementCategory:v28];
  }

  v71[0] = MEMORY[0x1E69E9820];
  v71[1] = 3221225472;
  v71[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke_442;
  v71[3] = &unk_1E70FFB90;
  v71[4] = self;
  v73 = &v78;
  v39 = v12;
  v72 = v39;
  [UIView performWithoutAnimation:v71];
  if (v65)
  {
    v68[0] = MEMORY[0x1E69E9820];
    v68[1] = 3221225472;
    v68[2] = __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke_2;
    v68[3] = &unk_1E70FEE78;
    v68[4] = self;
    v69 = v39;
    v70 = &v78;
    [UIView performWithoutAnimation:v68];
  }

  if ((v38 & 1) == 0)
  {
    [(UICollectionView *)self _configureSupplementaryViewForDisplay:v79[5] withElementKind:v11 indexPath:a4 elementCategory:v28];
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFFFFB | (4 * ((v64 >> 2) & 1));
  if (v16)
  {
    [(NSHashTable *)v16->_dequeuedViews removeObject:v79[5]];
  }

  [(UICollectionView *)self _notifyWillDisplaySupplementaryView:v79[5] forElementKind:v11 atIndexPath:a4];
  _UIRestorePreviousFallbackEnvironment(v63);
  v14 = v79[5];

  _Block_object_dispose(&v78, 8);
LABEL_51:
  objc_autoreleasePoolPop(context);

  return v14;
}

void __125__UICollectionView__createPreparedSupplementaryViewForElementOfKind_atIndexPath_layout_withLayoutAttributes_applyAttributes___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) _dataSourceProxy];
  v2 = [v5 collectionView:*(a1 + 32) viewForSupplementaryElementOfKind:*(a1 + 40) atIndexPath:*(a1 + 56)];
  v3 = *(*(a1 + 48) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

- (void)_configureCachedCellForDisplay:(id)a3 withIndexPath:(id)a4 layoutAttributesToUpdate:(id)a5
{
  v25 = *MEMORY[0x1E69E9840];
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_configureCachedCellForDisplay_withIndexPath_layoutAttributesToUpdate____s_category);
  if (*CategoryCachedImpl)
  {
    v10 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = v10;
      v12 = [a4 _ui_shortDescription];
      v13 = [a3 _layoutAttributes];
      *buf = 134219010;
      v16 = self;
      v17 = 2112;
      v18 = a3;
      v19 = 2112;
      v20 = v12;
      v21 = 2112;
      v22 = v13;
      v23 = 2112;
      v24 = a5;
      _os_log_impl(&dword_188A29000, v11, OS_LOG_TYPE_ERROR, "[UICV %p] Configuring cached cell %@ with indexPath:%@ cellAttrs: %@ layoutAttrsToUpdate: %@", buf, 0x34u);
    }
  }

  if (a5)
  {
    v14[0] = MEMORY[0x1E69E9820];
    v14[1] = 3221225472;
    v14[2] = __90__UICollectionView__configureCachedCellForDisplay_withIndexPath_layoutAttributesToUpdate___block_invoke;
    v14[3] = &unk_1E70FEEC8;
    v14[4] = self;
    v14[5] = a5;
    v14[6] = a3;
    [UIView performWithoutAnimation:v14];
  }

  [(UICollectionView *)self _configureCellForDisplay:a3 indexPath:a4 cached:1];
}

- (void)_configureCellForDisplay:(id)a3 indexPath:(id)a4 cached:(BOOL)a5
{
  v9 = self->_typeSelectController;
  v10 = v9;
  if (v9 && v9->_enabled)
  {
    [(_UICollectionViewTypeSelectController *)v9 configureTypeSelectDisplayForCell:a3 indexPath:a4];
  }

  v11[0] = MEMORY[0x1E69E9820];
  v11[1] = 3221225472;
  v11[2] = __62__UICollectionView__configureCellForDisplay_indexPath_cached___block_invoke;
  v11[3] = &unk_1E70FEEF0;
  v12 = a5;
  v11[4] = self;
  v11[5] = a4;
  v11[6] = a3;
  [UIView performWithoutAnimation:v11];
}

void __62__UICollectionView__configureCellForDisplay_indexPath_cached___block_invoke(uint64_t a1)
{
  if ((*(a1 + 56) & 1) == 0 && !dyld_program_sdk_at_least())
  {
    goto LABEL_10;
  }

  v2 = *(*(a1 + 32) + 2976);
  if (v2)
  {
    v3 = [*(v2 + 8) containsObject:*(a1 + 40)];
    v4 = *(*(a1 + 32) + 2976);
    if (v4)
    {
      v5 = [*(v4 + 16) containsObject:*(a1 + 40)];
    }

    else
    {
      v5 = 0;
    }

    v6 = (a1 + 48);
    if (v3 == [*(a1 + 48) isSelected])
    {
LABEL_8:
      if (v5 == [*v6 isHighlighted])
      {
        goto LABEL_10;
      }

      goto LABEL_9;
    }

LABEL_7:
    [*v6 _setSelected:v3 animated:0];
    goto LABEL_8;
  }

  v6 = (a1 + 48);
  if ([*(a1 + 48) isSelected])
  {
    v5 = 0;
    v3 = 0;
    goto LABEL_7;
  }

  if ([*v6 isHighlighted])
  {
    v5 = 0;
LABEL_9:
    [*v6 _setHighlighted:v5 animated:0];
  }

LABEL_10:
  [*(a1 + 32) _updateEditing:objc_msgSend(*(a1 + 32) forView:"_isEditing") atIndexPath:*(a1 + 48) elementCategory:{*(a1 + 40), 0}];
  [*(a1 + 48) setSemanticContentAttribute:{objc_msgSend(*(a1 + 32), "semanticContentAttribute")}];
  v7 = *(a1 + 48);
  v8 = *(*(a1 + 32) + 2152);
  v9 = v7;
  v10 = v9;
  if (v8)
  {
    v11 = v9 == 0;
  }

  else
  {
    v11 = 1;
  }

  if (v11)
  {
    goto LABEL_19;
  }

  v12 = [v9 effectiveUserInterfaceLayoutDirection];
  if (v12 == [v8 developmentLayoutDirection])
  {
    if (![v10 _flipsHorizontalAxis])
    {
      goto LABEL_19;
    }

    v13 = 0;
  }

  else
  {
    v13 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
  }

  [v10 _setFlipsHorizontalAxis:v13];
LABEL_19:

  v14 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:*(a1 + 40)];
  [(_UICollectionViewDragAndDropController *)*(*(a1 + 32) + 2856) updateAppearanceForCell:v14 atIndexPath:?];
}

- (void)_configureSupplementaryViewForDisplay:(id)a3 withElementKind:(id)a4 indexPath:(id)a5 elementCategory:(unint64_t)a6
{
  v6[0] = MEMORY[0x1E69E9820];
  v6[1] = 3221225472;
  v6[2] = __100__UICollectionView__configureSupplementaryViewForDisplay_withElementKind_indexPath_elementCategory___block_invoke;
  v6[3] = &unk_1E70FEF18;
  v6[4] = self;
  v6[5] = a3;
  v6[6] = a6;
  [UIView performWithoutAnimation:v6, a4, a5];
}

void __100__UICollectionView__configureSupplementaryViewForDisplay_withElementKind_indexPath_elementCategory___block_invoke(uint64_t a1)
{
  [*(a1 + 32) _updateEditing:objc_msgSend(*(a1 + 32) forView:"_isEditing") atIndexPath:*(a1 + 40) elementCategory:{0, *(a1 + 48)}];
  [*(a1 + 40) setSemanticContentAttribute:{objc_msgSend(*(a1 + 32), "semanticContentAttribute")}];
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v8 = *(v2 + 2152);
  v4 = v3;
  if (v8)
  {
    v5 = v4 == 0;
  }

  else
  {
    v5 = 1;
  }

  if (!v5)
  {
    v6 = [v4 effectiveUserInterfaceLayoutDirection];
    if (v6 == [v8 developmentLayoutDirection])
    {
      if (![v4 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      v7 = 0;
    }

    else
    {
      v7 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [v4 _setFlipsHorizontalAxis:v7];
  }

LABEL_10:
}

- (void)setContentSize:(CGSize)a3
{
  height = a3.height;
  width = a3.width;
  v6 = [(UIScrollView *)self _adjustsTargetsOnContentOffsetChanges];
  [(UIScrollView *)self _setAdjustsTargetsOnContentOffsetChanges:0];
  v7.receiver = self;
  v7.super_class = UICollectionView;
  [(UIScrollView *)&v7 setContentSize:width, height];
  [(UIScrollView *)self _setAdjustsTargetsOnContentOffsetChanges:v6];
}

- (void)_setContentSize:(CGSize)a3 skipContentOffsetAdjustment:(BOOL)a4
{
  v4 = a4;
  height = a3.height;
  width = a3.width;
  [(UIScrollView *)self contentSize];
  v10 = v9 != height || v8 != width;
  v11 = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
  [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:!v4];
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v15 = v14;
  if (v4 || !+[UIView areAnimationsEnabled](UIView, "areAnimationsEnabled") || +[UIView _isInAnimationBlock])
  {
    [(UICollectionView *)self setContentSize:width, height];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:v11];
    if (v10 && v4)
    {
      [(UIScrollView *)self contentOffset];
      if (vabdd_f64(v13, v17) < 0.0001 && vabdd_f64(v15, v16) < 0.0001)
      {
        *(&self->_collectionViewFlags + 4) |= 0x200000u;
      }
    }
  }

  else
  {
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __64__UICollectionView__setContentSize_skipContentOffsetAdjustment___block_invoke;
    v18[3] = &unk_1E70F6848;
    v18[4] = self;
    *&v18[5] = width;
    *&v18[6] = height;
    [(UIScrollView *)self performWhileAnimatingAutomaticContentOffsetAdjustments:v18];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:v11];
  }
}

- (void)_setContentSizeFromLayout:(CGSize)a3 isRecursivelyUpdatingVisibleCells:(BOOL)a4
{
  v4 = a4;
  height = a3.height;
  width = a3.width;
  if ([(UIScrollView *)self isScrollAnimating]|| [(UIScrollView *)self isDecelerating]|| [(UIScrollView *)self isDragging])
  {
    v8 = self;
    v9 = width;
    v10 = height;
    v11 = 1;
  }

  else
  {
    if (v4)
    {
      [(UIView *)self safeAreaInsets];
      if (v15 != 0.0 || v12 != 0.0 || v14 != 0.0 || v13 != 0.0)
      {
        v16 = [(UIScrollView *)self _edgesApplyingSafeAreaInsetsToContentInset];
        if (v16 != [(UIScrollView *)self _edgesApplyingSafeAreaInsetsToContentInsetForContentSize:width, height])
        {
          [(UICollectionView *)self _setContentSize:1 skipContentOffsetAdjustment:width, height];
          *(&self->_collectionViewFlags + 4) &= ~0x200000u;
          return;
        }
      }
    }

    v11 = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled]^ 1;
    v8 = self;
    v9 = width;
    v10 = height;
  }

  [(UICollectionView *)v8 _setContentSize:v11 skipContentOffsetAdjustment:v9, v10];
}

- (uint64_t)_applyLayoutAttributes:(void *)a3 toView:(int)a4 addingControlledSubview:(uint64_t)a5 forced:
{
  v21 = *MEMORY[0x1E69E9840];
  if (!result)
  {
    return result;
  }

  v9 = result;
  if (os_variant_has_internal_diagnostics())
  {
    if (!a3)
    {
      v10 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v10, OS_LOG_TYPE_FAULT))
      {
        v15 = 138412546;
        v16 = v9;
        v17 = 2112;
        v18 = a2;
        _os_log_fault_impl(&dword_188A29000, v10, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempted to apply layout attributes to a nil view. Collection View: %@, Attributes: %@", &v15, 0x16u);
      }
    }
  }

  else if (!a3)
  {
    v13 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923A0) + 8);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      v15 = 138412546;
      v16 = v9;
      v17 = 2112;
      v18 = a2;
      _os_log_impl(&dword_188A29000, v13, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempted to apply layout attributes to a nil view. Collection View: %@, Attributes: %@", &v15, 0x16u);
    }
  }

  if (os_variant_has_internal_diagnostics())
  {
    if (!a2)
    {
      v11 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
      {
LABEL_22:

        goto LABEL_6;
      }

      v12 = [a3 _layoutAttributes];
      v15 = 138412802;
      v16 = a3;
      v17 = 2112;
      v18 = v12;
      v19 = 2112;
      v20 = v9;
      _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: attempting to apply nil layout attributes to view. View: %@; current attributes from view: %@; collection view: %@", &v15, 0x20u);
LABEL_21:

      goto LABEL_22;
    }
  }

  else if (!a2)
  {
    v14 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923A8) + 8);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      v11 = v14;
      v12 = [a3 _layoutAttributes];
      v15 = 138412802;
      v16 = a3;
      v17 = 2112;
      v18 = v12;
      v19 = 2112;
      v20 = v9;
      _os_log_impl(&dword_188A29000, v11, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: attempting to apply nil layout attributes to view. View: %@; current attributes from view: %@; collection view: %@", &v15, 0x20u);
      goto LABEL_21;
    }
  }

LABEL_6:
  if (a4)
  {
    [v9 _addControlledSubview:a3 atZIndex:objc_msgSend(a2 forced:"zIndex") initialAttributes:{a5, a2}];
  }

  return [a3 _setLayoutAttributes:a2];
}

- (BOOL)_isReorderingItemAtIndexPath:(id)a3 includingDragAndDrop:(BOOL)a4
{
  v19 = *MEMORY[0x1E69E9840];
  v6 = a3;
  if (v6 && (a4 || ![(UICollectionView *)self _hasActiveDrag]&& ![(UICollectionView *)self _hasActiveDrop]))
  {
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v7 = [(UICollectionView *)self _reorderedItems];
    v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v8)
    {
      v9 = *v15;
      while (2)
      {
        for (i = 0; i != v8; ++i)
        {
          if (*v15 != v9)
          {
            objc_enumerationMutation(v7);
          }

          v11 = [*(*(&v14 + 1) + 8 * i) expectedCellIndexPath];
          v12 = [v11 isEqual:v6];

          if (v12)
          {
            LOBYTE(v8) = 1;
            goto LABEL_16;
          }
        }

        v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
        if (v8)
        {
          continue;
        }

        break;
      }
    }

LABEL_16:
  }

  else
  {
    LOBYTE(v8) = 0;
  }

  return v8;
}

- (BOOL)_viewIsReorderedCell:(id)a3
{
  v3 = [(UICollectionView *)self _reorderedItemForView:a3];
  v4 = v3 != 0;

  return v4;
}

- (id)_reorderedItemForView:(id)a3
{
  v17 = *MEMORY[0x1E69E9840];
  v4 = a3;
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v14 = 0u;
    v15 = 0u;
    v12 = 0u;
    v13 = 0u;
    v5 = [(UICollectionView *)self _reorderedItems];
    v6 = [v5 countByEnumeratingWithState:&v12 objects:v16 count:16];
    if (v6)
    {
      v7 = *v13;
      while (2)
      {
        for (i = 0; i != v6; i = i + 1)
        {
          if (*v13 != v7)
          {
            objc_enumerationMutation(v5);
          }

          v9 = *(*(&v12 + 1) + 8 * i);
          v10 = [v9 cell];

          if (v10 == v4)
          {
            v6 = v9;
            goto LABEL_13;
          }
        }

        v6 = [v5 countByEnumeratingWithState:&v12 objects:v16 count:16];
        if (v6)
        {
          continue;
        }

        break;
      }
    }

LABEL_13:
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (CGPoint)_reorderingTargetPosition
{
  x = self->_reorderingTargetPosition.x;
  y = self->_reorderingTargetPosition.y;
  result.y = y;
  result.x = x;
  return result;
}

- (CGPoint)_delegateTargetOffsetForProposedContentOffset:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x8000) != 0)
  {
    v7 = [(UICollectionView *)self _delegateProxy];
    [v7 collectionView:self targetContentOffsetForProposedContentOffset:{x, y}];
    goto LABEL_5;
  }

  if ((collectionViewFlags & 0x4000) != 0)
  {
    v7 = [(UICollectionView *)self _delegateProxy];
    [v7 _collectionView:self targetContentOffsetForProposedContentOffset:{x, y}];
LABEL_5:
    x = v8;
    y = v9;
  }

  v10 = x;
  v11 = y;
  result.y = v11;
  result.x = v10;
  return result;
}

- (BOOL)_updatePrefetchItemIfNeeded:(id)a3 forIndexPath:(id)a4 withLayoutAttributes:(id)a5 willDisplay:(BOOL)a6
{
  v40 = *MEMORY[0x1E69E9840];
  v10 = a3;
  v11 = a4;
  v12 = a5;
  if (!v10)
  {
    v13 = 0;
    LOBYTE(v17) = 1;
    goto LABEL_29;
  }

  v13 = v10[3];
  if (!v13)
  {
    LOBYTE(v17) = 1;
    goto LABEL_28;
  }

  v14 = *(v10 + 8);
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923B0);
  if (*CategoryCachedImpl)
  {
    v21 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
    {
      log = v21;
      v25 = [(UICollectionView *)v11 _ui_shortDescription];
      v22 = [v13 _layoutAttributes];
      v23 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v11];
      *buf = 134219010;
      v31 = self;
      v32 = 2112;
      v33 = v10;
      v34 = 2112;
      v35 = v25;
      v36 = 2112;
      v37 = v22;
      v38 = 2112;
      v39 = v23;
      _os_log_impl(&dword_188A29000, log, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePrefetchItemIfNeeded:%@ indexPath:%@ cellAttrs: %@ attrsFromLayout: %@", buf, 0x34u);
    }
  }

  if ((v14 & 7) != 0)
  {
    [v13 _setHiddenForReuse:0];
    if ((v14 & 4) != 0)
    {
      [(UICollectionView *)self _reconfigureCell:v13 forItemAtIndexPath:v11];
    }
  }

  if (a6 || (v14 & 2) != 0)
  {
    [(UICollectionView *)self _configureCachedCellForDisplay:v13 withIndexPath:v11 layoutAttributesToUpdate:0];
    if ((v14 & 1) == 0)
    {
LABEL_10:
      if ((v14 & 2) != 0)
      {
        goto LABEL_11;
      }

      goto LABEL_19;
    }
  }

  else if ((v14 & 1) == 0)
  {
    goto LABEL_10;
  }

  if (v12)
  {
    v17 = v12;
  }

  else
  {
    v17 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v11];
    if (!v17)
    {
      goto LABEL_20;
    }
  }

  [(UIBackgroundConfiguration *)v10 _setCustomView:v17];
  v27[0] = MEMORY[0x1E69E9820];
  v27[1] = 3221225472;
  v27[2] = __94__UICollectionView__updatePrefetchItemIfNeeded_forIndexPath_withLayoutAttributes_willDisplay___block_invoke;
  v27[3] = &unk_1E70F6228;
  v27[4] = self;
  v28 = v17;
  v29 = v13;
  v18 = v17;
  [UIView performWithoutAnimation:v27];

  if ((v14 & 2) != 0)
  {
LABEL_11:
    v16 = v10[2];
    LOBYTE(v17) = v16 != 0;
    if (v16)
    {
      [v13 _invalidatePreferredAttributes];
      [(UICollectionView *)self _checkForPreferredAttributesInView:v13 originalAttributes:v16];
    }

    else if (os_variant_has_internal_diagnostics())
    {
      v24 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v24, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412546;
        v31 = v11;
        v32 = 2112;
        v33 = v13;
        _os_log_fault_impl(&dword_188A29000, v24, OS_LOG_TYPE_FAULT, "UIKit internal inconsistency: prefetch items should never have nil attributes. Index path: %@; View: %@", buf, 0x16u);
      }
    }

    else
    {
      v19 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4923B8) + 8);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        v31 = v11;
        v32 = 2112;
        v33 = v13;
        _os_log_impl(&dword_188A29000, v19, OS_LOG_TYPE_ERROR, "UIKit internal inconsistency: prefetch items should never have nil attributes. Index path: %@; View: %@", buf, 0x16u);
      }
    }

    if (a6)
    {
      goto LABEL_28;
    }

    goto LABEL_26;
  }

LABEL_19:
  LOBYTE(v17) = 1;
LABEL_20:
  if (!a6)
  {
LABEL_26:
    if (([v13 _isHiddenForReuse] & 1) == 0)
    {
      [v13 _setHiddenForReuse:1];
    }
  }

LABEL_28:
  *(v10 + 8) &= 0xF8u;
LABEL_29:

  return v17;
}

- (unint64_t)_prefetchItemsForPrefetchingContext:(id)a3
{
  v46 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(UICollectionView *)self _useIdleObserverForCellPrefetching];
  if (v5)
  {
    [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  }

  if (v4 && [v4[2] count])
  {
    v6 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    while (1)
    {
      v7 = [(_UICollectionViewPrefetchingContext *)v4 popNextItem];
      v8 = v7;
      v9 = v7 ? *(v7 + 16) : 0;
      v10 = v9;
      v11 = [v10 indexPath];

      v12 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v11];

      if (!v12)
      {
        v13 = v6[218];
        v14 = [*(&self->super.super.super.super.isa + v13) objectForKeyedSubscript:v11];

        if (!v14)
        {
          v15 = [(UICollectionView *)self _focusedItemState];
          if (!v15 || ((v16 = v15, -[UICollectionView _focusedItemState](self, "_focusedItemState"), v17 = objc_claimAutoreleasedReturnValue(), (v18 = v17) == 0) ? (v19 = 0) : (v19 = *(v17 + 16)), v20 = v19, v21 = [v20 isEqual:v11], v20, v18, v16, v6 = &OBJC_IVAR____UISystemBackgroundView__strokeView, (v21 & 1) == 0))
          {
            firstResponderIndexPath = self->_firstResponderIndexPath;
            if (!firstResponderIndexPath || ([(NSIndexPath *)firstResponderIndexPath isEqual:v11]& 1) == 0)
            {
              v23 = v8 ? v8[2] : 0;
              v24 = v23;
              v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v11 withLayoutAttributes:v24 applyAttributes:0 isFocused:0 notify:0];

              if (v25)
              {
                break;
              }
            }
          }
        }
      }

      if (![v4[2] count])
      {
        v26 = 0;
        if (v5)
        {
          goto LABEL_27;
        }

        goto LABEL_28;
      }
    }

    if (v5)
    {
      [v25 _setHiddenForReuse:1];
    }

    [(_UIHomeAffordanceObservationRecord *)v8 setLegacyViewServiceSessionIdentifier:v25];
    v28 = *(&self->super.super.super.super.isa + v13);
    if (v8)
    {
      v29 = v8[2];
    }

    else
    {
      v29 = 0;
    }

    v30 = v29;
    v31 = [v30 indexPath];
    [v28 setObject:v8 forKeyedSubscript:v31];

    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_prefetchItemsForPrefetchingContext____s_category);
    if (*CategoryCachedImpl)
    {
      v33 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
      {
        v34 = v33;
        v35 = [v11 _ui_shortDescription];
        if (v8)
        {
          v36 = v8[2];
        }

        else
        {
          v36 = 0;
        }

        v37 = v36;
        *buf = 134218754;
        v39 = self;
        v40 = 2112;
        v41 = v35;
        v42 = 2112;
        v43 = v25;
        v44 = 2112;
        v45 = v37;
        _os_log_impl(&dword_188A29000, v34, OS_LOG_TYPE_ERROR, "[UICV %p] Prefetched cell for index path:%@ Cell: %@. Attributes: %@", buf, 0x2Au);
      }
    }

    v26 = 1;
    if (v5)
    {
      goto LABEL_27;
    }
  }

  else
  {
    v26 = 0;
    if (v5)
    {
LABEL_27:
      [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
    }
  }

LABEL_28:

  return v26;
}

- (void)_computeMainPrefetchCandidatesForVelocity:(CGVector)a3
{
  dy = a3.dy;
  dx = a3.dx;
  [(UICollectionView *)self _visibleBounds];
  v7 = v6;
  v9 = v8;
  v11 = v10;
  v13 = v12;
  [(UICollectionView *)self _computeFutureVisibleBoundsForPrefetchVelocity:dx visibleBounds:dy, v6, v8, v10, v12];
  v18 = [(UICollectionView *)self _computeMainPrefetchCandidatesForVisibleBounds:v7 futureVisibleBounds:v9 prefetchVector:v11, v13, v14, v15, v16, v17, *&dx, *&dy];
  mainPrefetchingContext = self->_mainPrefetchingContext;
  self->_mainPrefetchingContext = v18;
}

- (id)_computeMainPrefetchCandidatesForVisibleBounds:(CGRect)a3 futureVisibleBounds:(CGRect)a4 prefetchVector:(CGVector)a5
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  v16 = a3.size.width;
  v17 = a3.size.height;
  v9 = a3.origin.y;
  v10 = a3.origin.x;
  mainPrefetchingContext = self->_mainPrefetchingContext;
  if (mainPrefetchingContext && CGRectEqualToRect(mainPrefetchingContext->_prefetchRect, a4))
  {
    v13 = self->_mainPrefetchingContext;
  }

  else
  {
    v14 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:x validateLayout:y, width, height];
    v13 = [(UICollectionView *)self _prefetchingContextForVisibleBounds:v14 prefetchVector:v10 prefetchRect:v9 attributes:v16, v17, v19, v20, *&x, *&y, *&width, *&height];
  }

  return v13;
}

- (id)_prefetchingContextForVisibleBounds:(CGRect)a3 prefetchVector:(CGVector)a4 prefetchRect:(CGRect)a5 attributes:(id)a6
{
  dy = a4.dy;
  dx = a4.dx;
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v37 = *MEMORY[0x1E69E9840];
  v13 = a6;
  v31 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v13, "count")}];
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  v14 = v13;
  v15 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v33;
    do
    {
      for (i = 0; i != v16; ++i)
      {
        if (*v33 != v17)
        {
          objc_enumerationMutation(v14);
        }

        v19 = *(*(&v32 + 1) + 8 * i);
        layout = self->_layout;
        [v19 frame];
        [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v19 frame:?];
        v40.origin.x = x;
        v40.origin.y = y;
        v40.size.width = width;
        v40.size.height = height;
        v21 = CGRectIntersectsRect(v39, v40);
        if (v19 && !v21 && (v19[288] & 1) != 0)
        {
          v22 = [v19 indexPath];
          v23 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v22];

          if (!v23)
          {
            v24 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v22];

            if (!v24)
            {
              v25 = [[_UICollectionViewPrefetchItem alloc] initWithAttributes:v19];
              [v31 addObject:v25];
            }
          }
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v16);
  }

  [(UICollectionView *)self _reorderPrefetchCandidates:v31 forPrefetchVelocity:dx visibleBounds:dy, x, y, width, height];
  v26 = [[_UICollectionViewPrefetchingContext alloc] initWithPrefetchItems:v31 prefetchRect:a5.origin.x, a5.origin.y, a5.size.width, a5.size.height];
  v27 = v26;
  if ((*(&self->_collectionViewFlags + 8) & 0x40) != 0 && v26 && [v26[2] count])
  {
    v28 = [(UICollectionView *)self _prefetchDataSourceProxy];
    v29 = [(_UICollectionViewPrefetchingContext *)v27 remainingIndexPaths];
    [v28 collectionView:self prefetchItemsAtIndexPaths:v29];
  }

  return v27;
}

- (CGRect)_computeFutureVisibleBoundsForPrefetchVelocity:(CGVector)a3 visibleBounds:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  dy = a3.dy;
  dx = a3.dx;
  v26 = CGRectGetHeight(a4);
  v27.origin.x = x;
  v27.origin.y = y;
  v27.size.width = width;
  v27.size.height = height;
  v11 = CGRectGetWidth(v27);
  v12 = fabs(dx);
  v13 = fabs(dy);
  if (v12 < 2.22044605e-16 || v13 < 2.22044605e-16)
  {
    if (dx <= 0.0)
    {
      if (dx >= 0.0)
      {
        v20 = height;
        v17 = width;
        MinY = y;
        MaxX = x;
        goto LABEL_14;
      }

      v30.origin.x = x;
      v30.origin.y = y;
      v30.size.width = width;
      v30.size.height = height;
      v17 = v11 * 0.75;
      MaxX = CGRectGetMinX(v30) - v11 * 0.75;
      v31.origin.x = x;
      v31.origin.y = y;
      v31.size.width = width;
      v31.size.height = height;
      MinY = CGRectGetMinY(v31);
    }

    else
    {
      v28.origin.x = x;
      v28.origin.y = y;
      v28.size.width = width;
      v28.size.height = height;
      MaxX = CGRectGetMaxX(v28);
      v29.origin.x = x;
      v29.origin.y = y;
      v29.size.width = width;
      v29.size.height = height;
      MinY = CGRectGetMinY(v29);
      v17 = v11 * 0.75;
    }

    v20 = v26;
LABEL_14:
    if (dy <= 0.0)
    {
      if (dy >= 0.0)
      {
        goto LABEL_22;
      }

      v34.origin.x = x;
      v34.origin.y = y;
      v34.size.width = width;
      v34.size.height = height;
      MaxX = CGRectGetMinX(v34);
      v35.origin.x = x;
      v35.origin.y = y;
      v35.size.width = width;
      v35.size.height = height;
      v21 = CGRectGetMinY(v35);
      v20 = v26 * 0.75;
      MinY = v21 - v26 * 0.75;
    }

    else
    {
      v32.origin.x = x;
      v32.origin.y = y;
      v32.size.width = width;
      v32.size.height = height;
      MaxX = CGRectGetMinX(v32);
      v33.origin.x = x;
      v33.origin.y = y;
      v33.size.width = width;
      v33.size.height = height;
      MinY = CGRectGetMaxY(v33);
      v20 = v26 * 0.75;
    }

    v17 = v11;
    goto LABEL_22;
  }

  v18 = v12 / (v12 + v13);
  v19 = v13 / (v12 + v13);
  if (v18 <= v19 * 5.0)
  {
    if (v19 > v18 * 5.0)
    {
      v18 = 0.0;
    }
  }

  else
  {
    v19 = 0.0;
  }

  [(UICollectionView *)self _unitVectorForVector:dx, dy];
  MaxX = x + v11 * 0.5 * v18 * v22;
  MinY = y + v26 * 0.5 * v19 * v23;
  v17 = v11 * 1.25;
  v20 = v26 * 1.25;
LABEL_22:
  v24 = MaxX;
  v25 = v17;
  result.size.height = v20;
  result.size.width = v25;
  result.origin.y = MinY;
  result.origin.x = v24;
  return result;
}

- (CGRect)_computePrefetchCacheValidationBoundsForPrefetchVelocity:(CGVector)a3 visibleBounds:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  [(UICollectionView *)self _computeFutureVisibleBoundsForPrefetchVelocity:a3.dx visibleBounds:a3.dy];
  v27.origin.x = v8;
  v27.origin.y = v9;
  v27.size.width = v10;
  v27.size.height = v11;
  v23.origin.x = x;
  v23.origin.y = y;
  v23.size.width = width;
  v23.size.height = height;
  v24 = CGRectUnion(v23, v27);
  v20 = v24.origin.y;
  v21 = v24.origin.x;
  v12 = v24.size.width;
  v13 = v24.size.height;
  v24.origin.x = x;
  v24.origin.y = y;
  v24.size.width = width;
  v24.size.height = height;
  v14 = CGRectGetWidth(v24) * -0.25;
  v25.origin.x = x;
  v25.origin.y = y;
  v25.size.width = width;
  v25.size.height = height;
  v15 = CGRectGetHeight(v25) * -0.25;
  v17 = v20;
  v16 = v21;
  v18 = v12;
  v19 = v13;

  return CGRectInset(*&v16, v14, v15);
}

- (void)_pruneCachedPrefetchViewsForVelocity:(CGVector)a3
{
  dy = a3.dy;
  dx = a3.dx;
  v45 = *MEMORY[0x1E69E9840];
  if (a3.dx == 0.0 && a3.dy == 0.0)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923C0);
    if (*CategoryCachedImpl)
    {
      v7 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        LODWORD(buf) = 134217984;
        *(&buf + 4) = self;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "[UICV %p] Skipping pruning of prefetched cells due to zero velocity", &buf, 0xCu);
      }
    }
  }

  else if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    [(UICollectionView *)self _visibleBounds];
    [(UICollectionView *)self _computePrefetchCacheValidationBoundsForPrefetchVelocity:dx visibleBounds:dy, v8, v9, v10, v11];
    *&buf = 0;
    *(&buf + 1) = &buf;
    v41 = 0x3032000000;
    v42 = __Block_byref_object_copy__39;
    v43 = __Block_byref_object_dispose__39;
    v44 = 0;
    v29 = 0;
    v30 = &v29;
    v31 = 0x3032000000;
    v32 = __Block_byref_object_copy__39;
    v33 = __Block_byref_object_dispose__39;
    v34 = 0;
    prefetchCacheItems = self->_prefetchCacheItems;
    v28[0] = MEMORY[0x1E69E9820];
    v28[1] = 3221225472;
    v28[2] = __57__UICollectionView__pruneCachedPrefetchViewsForVelocity___block_invoke;
    v28[3] = &unk_1E70FEF40;
    v28[7] = v13;
    v28[8] = v14;
    v28[9] = v15;
    v28[10] = v16;
    v28[4] = self;
    v28[5] = &buf;
    v28[6] = &v29;
    [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v28];
    v17 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4923C8);
    if (*v17)
    {
      v22 = *(v17 + 8);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        v23 = *(*(&buf + 1) + 40);
        *v36 = 134218242;
        v37 = self;
        v38 = 2112;
        v39 = v23;
        _os_log_impl(&dword_188A29000, v22, OS_LOG_TYPE_ERROR, "[UICV %p] Pruning prefetched cells: %@", v36, 0x16u);
      }
    }

    if ([*(*(&buf + 1) + 40) count])
    {
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectsForKeys:*(*(&buf + 1) + 40)];
    }

    v26 = 0u;
    v27 = 0u;
    v24 = 0u;
    v25 = 0u;
    v18 = v30[5];
    v19 = [v18 countByEnumeratingWithState:&v24 objects:v35 count:16];
    if (v19)
    {
      v20 = *v25;
      do
      {
        for (i = 0; i != v19; ++i)
        {
          if (*v25 != v20)
          {
            objc_enumerationMutation(v18);
          }

          [(UICollectionView *)self _reusePrefetchedCell:*(*(&v24 + 1) + 8 * i), v24];
        }

        v19 = [v18 countByEnumeratingWithState:&v24 objects:v35 count:16];
      }

      while (v19);
    }

    _Block_object_dispose(&v29, 8);
    _Block_object_dispose(&buf, 8);
  }
}

void __57__UICollectionView__pruneCachedPrefetchViewsForVelocity___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v6 = *(a3 + 24);
  }

  else
  {
    v6 = 0;
  }

  v7 = v6;

  if (v7)
  {
    v8 = *(*(a1 + 32) + 2152);
    if (a3)
    {
      v9 = *(a3 + 16);
      v10 = *(a3 + 16);
    }

    else
    {
      v9 = 0;
      v10 = 0;
    }

    v11 = v10;
    [v11 frame];
    [v8 _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v9 frame:?];
    v13 = v12;
    v15 = v14;
    v17 = v16;
    v19 = v18;

    v33.origin.x = v13;
    v33.origin.y = v15;
    v33.size.width = v17;
    v33.size.height = v19;
    if (!CGRectIntersectsRect(*(a1 + 56), v33))
    {
      v20 = *(*(*(a1 + 40) + 8) + 40);
      if (v20)
      {
        [v20 addObject:a2];
      }

      else
      {
        v21 = [objc_alloc(MEMORY[0x1E695DF70]) initWithObjects:{a2, 0}];
        v22 = *(*(a1 + 40) + 8);
        v23 = *(v22 + 40);
        *(v22 + 40) = v21;
      }

      v24 = *(*(*(a1 + 48) + 8) + 40);
      if (v24)
      {
        if (a3)
        {
          v25 = *(a3 + 24);
        }

        else
        {
          v25 = 0;
        }

        v31 = v25;
        [v24 addObject:?];
      }

      else
      {
        v26 = objc_alloc(MEMORY[0x1E695DF70]);
        if (a3)
        {
          v27 = *(a3 + 24);
        }

        else
        {
          v27 = 0;
        }

        v31 = v27;
        v28 = [v26 initWithObjects:{v31, 0}];
        v29 = *(*(a1 + 48) + 8);
        v30 = *(v29 + 40);
        *(v29 + 40) = v28;
      }
    }
  }
}

- (void)_reusePrefetchedCell:(id)a3
{
  v17 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:v4];
  if (v5 & 1) != 0 || ([v4 _isInUpdateAnimation])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_reusePrefetchedCell____s_category);
    if (*CategoryCachedImpl)
    {
      v7 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        v8 = v7;
        v9 = 134218754;
        v10 = self;
        v11 = 1024;
        v12 = v5;
        v13 = 1024;
        v14 = [v4 _isInUpdateAnimation];
        v15 = 2112;
        v16 = v4;
        _os_log_impl(&dword_188A29000, v8, OS_LOG_TYPE_ERROR, "[UICV %p] Skipping reuse of prefetched cell for reason isViewInReuseQueue(%d) inUpdateAnimation(%d): %@", &v9, 0x22u);
      }
    }
  }

  else
  {
    [(UICollectionView *)self _reuseCell:v4 notifyDidEndDisplaying:0];
  }
}

- (void)_prunePrefetchedViewsAtIndexPaths:(id)a3
{
  v31 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v4, "count")}];
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v6 = v4;
  v7 = [v6 countByEnumeratingWithState:&v25 objects:v30 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v26;
    do
    {
      v10 = 0;
      do
      {
        if (*v26 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:*(*(&v25 + 1) + 8 * v10)];
        v12 = v11;
        if (v11)
        {
          v13 = *(v11 + 24);
        }

        else
        {
          v13 = 0;
        }

        v14 = v13;

        if (v14)
        {
          [v5 addObject:v14];
        }

        ++v10;
      }

      while (v8 != v10);
      v15 = [v6 countByEnumeratingWithState:&v25 objects:v30 count:16];
      v8 = v15;
    }

    while (v15);
  }

  [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectsForKeys:v6];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v16 = v5;
  v17 = [v16 countByEnumeratingWithState:&v21 objects:v29 count:16];
  if (v17)
  {
    v18 = v17;
    v19 = *v22;
    do
    {
      for (i = 0; i != v18; ++i)
      {
        if (*v22 != v19)
        {
          objc_enumerationMutation(v16);
        }

        [(UICollectionView *)self _reusePrefetchedCell:*(*(&v21 + 1) + 8 * i), v21];
      }

      v18 = [v16 countByEnumeratingWithState:&v21 objects:v29 count:16];
    }

    while (v18);
  }
}

- (void)_reorderPrefetchCandidates:(id)a3 forPrefetchVelocity:(CGVector)a4 visibleBounds:(CGRect)a5
{
  height = a5.size.height;
  width = a5.size.width;
  y = a5.origin.y;
  x = a5.origin.x;
  dy = a4.dy;
  dx = a4.dx;
  v12 = a3;
  if (fabs(dx) >= 2.22044605e-16)
  {
    v13 = *MEMORY[0x1E695EFF8];
    v14 = *(MEMORY[0x1E695EFF8] + 8);
    if (fabs(dy) < 2.22044605e-16)
    {
      goto LABEL_4;
    }

    if (dx <= 0.0)
    {
      if (dx >= 0.0)
      {
        goto LABEL_10;
      }

      v23.origin.x = x;
      v23.origin.y = y;
      v23.size.width = width;
      v23.size.height = height;
      MinX = CGRectGetMinX(v23);
    }

    else
    {
      v22.origin.x = x;
      v22.origin.y = y;
      v22.size.width = width;
      v22.size.height = height;
      MinX = CGRectGetMaxX(v22);
    }

    v13 = MinX;
LABEL_10:
    if (dy <= 0.0)
    {
      if (dy >= 0.0)
      {
LABEL_15:
        v15 = 0;
        goto LABEL_16;
      }

      v25.origin.x = x;
      v25.origin.y = y;
      v25.size.width = width;
      v25.size.height = height;
      MinY = CGRectGetMinY(v25);
    }

    else
    {
      v24.origin.x = x;
      v24.origin.y = y;
      v24.size.width = width;
      v24.size.height = height;
      MinY = CGRectGetMaxY(v24);
    }

    v14 = MinY;
    goto LABEL_15;
  }

  v13 = *MEMORY[0x1E695EFF8];
  v14 = *(MEMORY[0x1E695EFF8] + 8);
LABEL_4:
  v15 = 1;
LABEL_16:
  v18 = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __81__UICollectionView__reorderPrefetchCandidates_forPrefetchVelocity_visibleBounds___block_invoke;
  v19[3] = &unk_1E70FEF68;
  v20 = v18;
  v19[4] = self;
  v21 = v15;
  *&v19[5] = dx;
  *&v19[6] = dy;
  *&v19[7] = v13;
  *&v19[8] = v14;
  [v12 sortUsingComparator:v19];
}

uint64_t __81__UICollectionView__reorderPrefetchCandidates_forPrefetchVelocity_visibleBounds___block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  if (a2)
  {
    a2 = a2[2];
  }

  if (a3)
  {
    v4 = *(a3 + 16);
  }

  else
  {
    v4 = 0;
  }

  if (*(a1 + 72) == 1)
  {
    v5 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a2];
  }

  else
  {
    [a2 frame];
  }

  v9 = v5;
  v10 = v6;
  v11 = v7;
  v12 = v8;
  if (*(a1 + 72) == 1)
  {
    v13 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:v4];
  }

  else
  {
    [v4 frame];
  }

  v17 = v13;
  v18 = v14;
  v19 = v15;
  v20 = v16;
  if (*(a1 + 73) == 1)
  {
    v21 = *(a1 + 40);
    rect = v12;
    if (v21 > 0.0)
    {
      v36.origin.x = v9;
      v36.origin.y = v10;
      v36.size.width = v11;
      v36.size.height = v12;
      MinX = CGRectGetMinX(v36);
      v37.origin.x = v17;
      v37.origin.y = v18;
      v37.size.width = v19;
      v37.size.height = v20;
      if (MinX <= CGRectGetMinX(v37))
      {
        v38.origin.x = v9;
        v38.origin.y = v10;
        v38.size.width = v11;
        v38.size.height = rect;
        v23 = CGRectGetMinX(v38);
        v39.origin.x = v17;
        v39.origin.y = v18;
        v39.size.width = v19;
        v39.size.height = v20;
        v24 = CGRectGetMinX(v39);
        goto LABEL_15;
      }

      return 1;
    }

    if (v21 < 0.0)
    {
      v40.origin.x = v9;
      v40.origin.y = v10;
      v40.size.width = v11;
      v40.size.height = v12;
      v29 = CGRectGetMinX(v40);
      v41.origin.x = v17;
      v41.origin.y = v18;
      v41.size.width = v19;
      v41.size.height = v20;
      if (v29 >= CGRectGetMinX(v41))
      {
        v42.origin.x = v9;
        v42.origin.y = v10;
        v42.size.width = v11;
        v42.size.height = rect;
        v30 = CGRectGetMinX(v42);
        v43.origin.x = v17;
        v43.origin.y = v18;
        v43.size.width = v19;
        v43.size.height = v20;
        if (v30 <= CGRectGetMinX(v43))
        {
          return 0;
        }

        return -1;
      }

      return 1;
    }

    v31 = *(a1 + 48);
    if (v31 > 0.0)
    {
      v44.origin.x = v9;
      v44.origin.y = v10;
      v44.size.width = v11;
      v44.size.height = v12;
      MinY = CGRectGetMinY(v44);
      v45.origin.x = v17;
      v45.origin.y = v18;
      v45.size.width = v19;
      v45.size.height = v20;
      if (MinY <= CGRectGetMinY(v45))
      {
        v46.origin.x = v9;
        v46.origin.y = v10;
        v46.size.width = v11;
        v46.size.height = rect;
        v23 = CGRectGetMinY(v46);
        v47.origin.x = v17;
        v47.origin.y = v18;
        v47.size.width = v19;
        v47.size.height = v20;
        v24 = CGRectGetMinY(v47);
LABEL_15:
        if (v23 >= v24)
        {
          return 0;
        }

        return -1;
      }

      return 1;
    }

    if (v31 < 0.0)
    {
      v48.origin.x = v9;
      v48.origin.y = v10;
      v48.size.width = v11;
      v48.size.height = v12;
      MaxY = CGRectGetMaxY(v48);
      v49.origin.x = v17;
      v49.origin.y = v18;
      v49.size.width = v19;
      v49.size.height = v20;
      if (MaxY > CGRectGetMaxY(v49))
      {
        return -1;
      }

      v50.origin.x = v9;
      v50.origin.y = v10;
      v50.size.width = v11;
      v50.size.height = rect;
      v34 = CGRectGetMaxY(v50);
      v51.origin.x = v17;
      v51.origin.y = v18;
      v51.size.width = v19;
      v51.size.height = v20;
      if (v34 < CGRectGetMaxY(v51))
      {
        return 1;
      }
    }
  }

  else
  {
    UIDistanceBetweenPointAndRect(*(a1 + 56), *(a1 + 64), v9, v10, v11, v12);
    v26 = v25;
    UIDistanceBetweenPointAndRect(*(a1 + 56), *(a1 + 64), v17, v18, v19, v20);
    if (v26 > v27)
    {
      return 1;
    }

    if (v26 < v27)
    {
      return -1;
    }
  }

  return 0;
}

- (double)_layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:(uint64_t)a1
{
  if (!a1)
  {
    return 0.0;
  }

  [a2 frame];
  v5 = v4;
  v7 = v6;
  v9 = v8;
  v11 = v10;
  if ([*(a1 + 2152) _hasOrthogonalScrollingSections])
  {
    v12 = [a2 indexPath];
    v13 = [v12 section];

    v14 = [*(a1 + 2152) _orthogonalScrollingSections];
    v15 = [v14 containsIndex:v13];

    if (v15)
    {
      [*(a1 + 2152) _offsetForOrthogonalScrollingSection:v13];
      v17 = v16;
      v20.origin.x = v5;
      v20.origin.y = v7;
      v20.size.width = v9;
      v20.size.height = v11;
      v18 = CGRectGetMinX(v20) - v17;
      v21.origin.x = v5;
      v21.origin.y = v7;
      v21.size.width = v9;
      v21.size.height = v11;
      CGRectGetMinY(v21);
      v22.origin.x = v5;
      v22.origin.y = v7;
      v22.size.width = v9;
      v22.size.height = v11;
      CGRectGetWidth(v22);
      v23.origin.x = v5;
      v23.origin.y = v7;
      v23.size.width = v9;
      v23.size.height = v11;
      CGRectGetHeight(v23);
      return v18;
    }
  }

  return v5;
}

- (CGVector)_unitVectorForVector:(CGVector)a3
{
  v3 = a3.dx < 0.0;
  if (a3.dx > 0.0)
  {
    v4 = 1.0;
  }

  else
  {
    v4 = 0.0;
  }

  if (v3)
  {
    v4 = -1.0;
  }

  v5 = a3.dy < 0.0;
  if (a3.dy > 0.0)
  {
    v6 = 1.0;
  }

  else
  {
    v6 = 0.0;
  }

  if (v5)
  {
    v6 = -1.0;
  }

  result.dy = v6;
  result.dx = v4;
  return result;
}

- (void)_performReloadPrefetchIfNeeded
{
  v33 = *MEMORY[0x1E69E9840];
  if ((*(&self->_collectionViewFlags + 14) & 0x80) != 0 && [(UICollectionView *)self _prefetchingAllowed])
  {
    [(UICollectionView *)self _visibleBounds];
    x = v34.origin.x;
    y = v34.origin.y;
    width = v34.size.width;
    height = v34.size.height;
    v7 = CGRectGetWidth(v34) * -0.5;
    v35.origin.x = x;
    v35.origin.y = y;
    v35.size.width = width;
    v35.size.height = height;
    v8 = CGRectGetHeight(v35) * -0.5;
    v36.origin.x = x;
    v36.origin.y = y;
    v36.size.width = width;
    v36.size.height = height;
    v37 = CGRectInset(v36, v7, v8);
    v9 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v37.origin.x validateLayout:v37.origin.y, v37.size.width, v37.size.height];
    [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
    v30 = 0u;
    v31 = 0u;
    v28 = 0u;
    v29 = 0u;
    v10 = v9;
    v11 = [v10 countByEnumeratingWithState:&v28 objects:v32 count:16];
    if (v11)
    {
      v12 = v11;
      v13 = *v29;
      v27 = v10;
      do
      {
        v14 = 0;
        do
        {
          if (*v29 != v13)
          {
            objc_enumerationMutation(v10);
          }

          v15 = *(*(&v28 + 1) + 8 * v14);
          v16 = [v15 indexPath];
          v17 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v16];

          if (!v17)
          {
            v18 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v16];

            if (!v18)
            {
              v19 = [[_UICollectionViewPrefetchItem alloc] initWithAttributes:v15];
              v20 = v19;
              if (v19)
              {
                v21 = v19[2];
                v22 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v16 withLayoutAttributes:v21 applyAttributes:0 isFocused:0 notify:0];
                [(_UIHomeAffordanceObservationRecord *)v20 setLegacyViewServiceSessionIdentifier:v22];

                v23 = v20[3];
              }

              else
              {
                v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v16 withLayoutAttributes:0 applyAttributes:0 isFocused:0 notify:0];
                [(_UIHomeAffordanceObservationRecord *)0 setLegacyViewServiceSessionIdentifier:v25];

                v23 = 0;
              }

              v24 = v23;
              [v24 _setHiddenForReuse:1];

              [(NSMutableDictionary *)self->_prefetchCacheItems setObject:v20 forKeyedSubscript:v16];
              v10 = v27;
            }
          }

          ++v14;
        }

        while (v12 != v14);
        v26 = [v10 countByEnumeratingWithState:&v28 objects:v32 count:16];
        v12 = v26;
      }

      while (v26);
    }

    [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
  }
}

void __47__UICollectionView__resetPrefetchedCachedCells__block_invoke(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v4 = *(a3 + 24);
    if (v4)
    {
      v5 = v4;
      if (([v4 _isInUpdateAnimation] & 1) == 0)
      {
        [*(a1 + 32) addObject:v5];
      }

      v4 = v5;
    }
  }

  else
  {
    v4 = 0;
  }
}

- (void)_resetPrefetchingContext:(id)a3
{
  v4 = a3;
  v5 = v4;
  if (v4)
  {
    if ((*(&self->_collectionViewFlags + 8) & 0x80) != 0)
    {
      v9 = v4;
      v6 = [v4[2] count];
      v5 = v9;
      if (v6)
      {
        v7 = [(UICollectionView *)self _prefetchDataSourceProxy];
        v8 = [(_UICollectionViewPrefetchingContext *)v9 remainingIndexPaths];
        [v7 collectionView:self cancelPrefetchingForItemsAtIndexPaths:v8];

        v5 = v9;
      }
    }
  }
}

- (void)_updatePrefetchVelocityIntegratorForVisibleBounds:(CGRect)a3
{
  y = a3.origin.y;
  x = a3.origin.x;
  prefetchVelocityIntegrator = self->_prefetchVelocityIntegrator;
  if (!prefetchVelocityIntegrator)
  {
    v7 = objc_alloc_init(_UIVelocityIntegrator);
    v8 = self->_prefetchVelocityIntegrator;
    self->_prefetchVelocityIntegrator = v7;

    [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator setHysteresisTimeInterval:0.3];
    v9 = self->_prefetchVelocityIntegrator;
    if (v9)
    {
      v9->_resetHysteresisOnSampleThetaDiff = 1.04719755;
    }

    objc_initWeak(&location, self);
    v12 = MEMORY[0x1E69E9820];
    v13 = 3221225472;
    v14 = __70__UICollectionView__updatePrefetchVelocityIntegratorForVisibleBounds___block_invoke;
    v15 = &unk_1E70F5A28;
    objc_copyWeak(&v16, &location);
    v11 = self->_prefetchVelocityIntegrator;
    if (v11)
    {
      objc_setProperty_nonatomic_copy(v11, v10, &v12, 120);
    }

    objc_destroyWeak(&v16);
    objc_destroyWeak(&location);
    prefetchVelocityIntegrator = self->_prefetchVelocityIntegrator;
  }

  [(_UIVelocityIntegrator *)prefetchVelocityIntegrator addSample:x, y, a3.size.width, a3.size.height, v12, v13, v14, v15];
}

void __70__UICollectionView__updatePrefetchVelocityIntegratorForVisibleBounds___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  [WeakRetained _resetAllPrefetchContexts];
}

- (void)_rebasePrefetchedCellIndexPathsWithMapping:(id)a3
{
  v4 = a3;
  if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
  {
    v5 = [(NSMutableDictionary *)self->_prefetchCacheItems copy];
    [(NSMutableDictionary *)self->_prefetchCacheItems removeAllObjects];
    v6[0] = MEMORY[0x1E69E9820];
    v6[1] = 3221225472;
    v6[2] = __63__UICollectionView__rebasePrefetchedCellIndexPathsWithMapping___block_invoke;
    v6[3] = &unk_1E70FEFE0;
    v6[4] = self;
    v7 = v4;
    [v5 enumerateKeysAndObjectsUsingBlock:v6];
  }
}

void __63__UICollectionView__rebasePrefetchedCellIndexPathsWithMapping___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v29 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v7 = (*(*(a1 + 40) + 16))();
  if (v7)
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", _UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_5___s_category);
    if (*CategoryCachedImpl)
    {
      v12 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        v13 = *(a1 + 32);
        v14 = v12;
        if (v6)
        {
          v15 = v6[3];
        }

        else
        {
          v15 = 0;
        }

        v16 = v15;
        v17 = [v5 _ui_shortDescription];
        v18 = [v7 _ui_shortDescription];
        v19 = 134219010;
        v20 = v13;
        v21 = 2048;
        v22 = v6;
        v23 = 2048;
        v24 = v16;
        v25 = 2112;
        v26 = v17;
        v27 = 2112;
        v28 = v18;
        _os_log_impl(&dword_188A29000, v14, OS_LOG_TYPE_ERROR, "[UICV %p] Rebasing prefetch item (%p) with view %p from %@ to %@", &v19, 0x34u);
      }
    }

    if (v6)
    {
      *(v6 + 8) |= 1u;
    }

    [*(*(a1 + 32) + 2824) setObject:v6 forKey:v7];
  }

  else
  {
    v9 = *(a1 + 32);
    if (v6)
    {
      v10 = v6[3];
    }

    else
    {
      v10 = 0;
    }

    v11 = v10;
    [v9 _reusePrefetchedCell:v11];
  }
}

- (BOOL)_updatePrefetchedCells:(BOOL)a3
{
  v3 = a3;
  if (![(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator hasVelocity])
  {
    v5 = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
    if (!v5)
    {
      return v5;
    }
  }

  [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator velocity];
  v8 = v6;
  v9 = v7;
  if (self->_activeOrthogonalPrefetchingContext)
  {
    if (v3)
    {
      goto LABEL_5;
    }

LABEL_9:
    LOBYTE(v5) = 0;
    return v5;
  }

  [(UICollectionView *)self _pruneCachedPrefetchViewsForVelocity:v6, v7];
  if (!v3)
  {
    goto LABEL_9;
  }

LABEL_5:
  mainPrefetchingContext = self->_mainPrefetchingContext;
  if (mainPrefetchingContext && [(NSMutableArray *)mainPrefetchingContext->_items count])
  {
    [(UICollectionView *)self _prefetchItemsForPrefetchingContext:self->_mainPrefetchingContext];
  }

  else
  {
    [(UICollectionView *)self _computeMainPrefetchCandidatesForVelocity:v8, v9];
  }

  LOBYTE(v5) = 1;
  return v5;
}

- (void)_updateCycleIdleUntil:(unint64_t)a3
{
  v28 = *MEMORY[0x1E69E9840];
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained && [(UICollectionView *)self _prefetchingAllowed])
  {
    v6 = mach_absolute_time();
    v7 = v6;
    if (a3 >= v6)
    {
      v8 = a3 - v6;
    }

    else
    {
      v8 = 0;
    }

    v9 = _UISetCurrentFallbackEnvironment(self);
    if ([(NSMutableDictionary *)self->_prefetchCacheItems count])
    {
      v18 = 0;
      v19 = &v18;
      v20 = 0x3032000000;
      v21 = __Block_byref_object_copy__39;
      v22 = __Block_byref_object_dispose__39;
      v23 = 0;
      [(UICollectionView *)self _beginReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
      prefetchCacheItems = self->_prefetchCacheItems;
      v17[0] = MEMORY[0x1E69E9820];
      v17[1] = 3221225472;
      v17[2] = __42__UICollectionView__updateCycleIdleUntil___block_invoke;
      v17[3] = &unk_1E70FF008;
      v17[4] = self;
      v17[5] = &v18;
      v17[6] = a3;
      [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v17];
      [(UICollectionView *)self _endReusableViewCreationAndSelfSizingOutsideVisibleCellsUpdate];
      if (v19[5])
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_updateCycleIdleUntil____s_category);
        if (*CategoryCachedImpl)
        {
          v15 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
          {
            v16 = v19[5];
            *buf = 134218242;
            v25 = self;
            v26 = 2112;
            v27 = v16;
            _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "[UICV %p] Pruning invalid prefetch items at index paths: %@", buf, 0x16u);
          }
        }

        [(UICollectionView *)self _prunePrefetchedViewsAtIndexPaths:v19[5]];
      }

      _Block_object_dispose(&v18, 8);
    }

    v12 = mach_absolute_time();
    if (v7 < a3 && ((v12 - v7) / v8) <= 0.1)
    {
      v13 = self->_activeOrthogonalPrefetchingContext;
      v14 = v13;
      if (v13 && [(NSMutableArray *)v13->_items count])
      {
        [(UICollectionView *)self _prefetchItemsForPrefetchingContext:v14];
      }

      else
      {
        [(UICollectionView *)self _updatePrefetchedCells:1];
      }
    }

    _UIRestorePreviousFallbackEnvironment(v9);
  }
}

uint64_t __42__UICollectionView__updateCycleIdleUntil___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (([*(a1 + 32) _updatePrefetchItemIfNeeded:a3 forIndexPath:a2 withLayoutAttributes:0 willDisplay:0] & 1) == 0)
  {
    v7 = *(*(*(a1 + 40) + 8) + 40);
    if (v7)
    {
      [v7 addObject:a2];
    }

    else
    {
      v8 = [objc_alloc(MEMORY[0x1E695DF70]) initWithObjects:{a2, 0}];
      v9 = *(*(a1 + 40) + 8);
      v10 = *(v9 + 40);
      *(v9 + 40) = v8;
    }
  }

  result = mach_absolute_time();
  if (result >= *(a1 + 48))
  {
    *a4 = 1;
  }

  return result;
}

- (_BYTE)_isContentOffset:(CGFloat)a3 atStartOfAxis:(CGFloat)a4
{
  if (result)
  {
    v7 = result;
    [result _contentInsetIncludingDecorations];
    if (a2 == 1)
    {
      v12 = v9;
      if (v7[106] & 0x40) == 0 || (v13 = v10, ([v7 _flipsHorizontalAxis]))
      {
        v11 = a3 + v12;
        return (v11 <= 0.001);
      }

      [v7 contentSize];
      v15 = v14;
      [v7 bounds];
      v16.origin.x = a3;
      v16.origin.y = a4;
      return (CGRectGetMaxX(v16) - (v13 + v15) + 0.001 >= 0.0);
    }

    else
    {
      if (a2 == 2)
      {
        v11 = a4 + v8;
        return (v11 <= 0.001);
      }

      return 0;
    }
  }

  return result;
}

BOOL __77__UICollectionView__saveContentOffsetRestorationAnchorIfNecessaryUsingModel___block_invoke(uint64_t a1, void *a2)
{
  v3 = [a2 indexPath];
  if (*(*(a1 + 32) + 2280) && +[UIView areAnimationsEnabled])
  {
    if (([(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) hasMovedItemWithSourceIndexPath:v3]& 1) != 0)
    {
      v4 = 0;
    }

    else
    {
      v6 = [*(*(a1 + 32) + 2280) finalIndexPathForInitialIndexPath:v3];
      v4 = v6 != 0;
    }
  }

  else
  {
    v4 = 1;
  }

  return v4;
}

- (id)_layoutAttributesClosestToReferencePoint:(uint64_t)a3 amongCandidates:(void *)a4 onAxis:(double)a5 shouldConsiderBlock:(double)a6
{
  v40 = *MEMORY[0x1E69E9840];
  v10 = a4;
  if (a1)
  {
    v37 = 0u;
    v38 = 0u;
    v35 = 0u;
    v36 = 0u;
    obj = a2;
    v11 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
    if (v11)
    {
      v12 = v11;
      v13 = 0;
      v14 = *v36;
      v15 = (v10 + 2);
      v16 = 1.79769313e308;
      do
      {
        v17 = 0;
        v32 = v12;
        do
        {
          if (*v36 != v14)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v35 + 1) + 8 * v17);
          if (v10[2](v10, v18))
          {
            v19 = [v18 indexPath];
            [v18 frame];
            v22 = _UICollectionLayoutDistanceBetweenPointsOnAxis(a3, a5, a6, v20, v21);
            v23 = v22;
            if (v22 < v16 || vabdd_f64(v22, v16) <= 0.001 && ((v25 = [v13 indexPath], v26 = v15, v27 = objc_msgSend(v19, "section"), v28 = v27 < objc_msgSend(v25, "section"), v15 = v26, v12 = v32, v28) || (v29 = objc_msgSend(v19, "item"), v29 < objc_msgSend(v25, "item"))))
            {
              v24 = v18;

              v16 = v23;
              v13 = v24;
            }
          }

          ++v17;
        }

        while (v12 != v17);
        v30 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
        v12 = v30;
      }

      while (v30);
    }

    else
    {
      v13 = 0;
    }
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

- (void)_rebaseContentOffsetAnchorOrScrollTargetForUpdate:(id)a3
{
  v29 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if (dyld_program_sdk_at_least())
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __70__UICollectionView__rebaseContentOffsetAnchorOrScrollTargetForUpdate___block_invoke;
    aBlock[3] = &unk_1E70FF058;
    v5 = v4;
    v22 = v5;
    v6 = _Block_copy(aBlock);
    v7 = self->_scrollingTargetIndexPath;
    v8 = self->_contentOffsetRestorationAnchor;
    v9 = v8;
    if (v7)
    {
      if (v6[2](v6, v7))
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492410);
        if (*CategoryCachedImpl)
        {
          v17 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            *buf = 134217984;
            v24 = self;
            _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; clearing scrolling target index path", buf, 0xCu);
          }
        }

        [(UICollectionView *)self _clearTargetIndexPathForScrolling];
      }

      else
      {
        v12 = [v5 finalIndexPathForInitialIndexPath:v7];
        scrollingTargetIndexPath = self->_scrollingTargetIndexPath;
        self->_scrollingTargetIndexPath = v12;
      }
    }

    else if (v8)
    {
      if (v6[2](v6, v8))
      {
        v11 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492418);
        if (*v11)
        {
          v18 = *(v11 + 8);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
          {
            *buf = 134217984;
            v24 = self;
            _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; clearing restoration anchor that was moved or deleted", buf, 0xCu);
          }
        }

        [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
      }

      else
      {
        v14 = [v5 finalIndexPathForInitialIndexPath:v9];
        contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
        self->_contentOffsetRestorationAnchor = v14;

        v16 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492420);
        if (*v16)
        {
          v19 = *(v16 + 8);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v20 = self->_contentOffsetRestorationAnchor;
            *buf = 134218498;
            v24 = self;
            v25 = 2112;
            v26 = v9;
            v27 = 2112;
            v28 = v20;
            _os_log_impl(&dword_188A29000, v19, OS_LOG_TYPE_ERROR, "_rebaseContentOffsetAnchorOrScrollTarget: cv == %p; rebased restoration anchor from %@ to %@", buf, 0x20u);
          }
        }
      }
    }
  }
}

BOOL __70__UICollectionView__rebaseContentOffsetAnchorOrScrollTargetForUpdate___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if (([(UICollectionViewUpdate *)*(a1 + 32) hasMovedItemWithSourceIndexPath:v3]& 1) != 0)
  {
    v4 = 1;
  }

  else
  {
    v5 = [*(a1 + 32) finalIndexPathForInitialIndexPath:v3];
    v4 = v5 == 0;
  }

  return v4;
}

- (uint64_t)_restoreOrAdjustContentOffsetIfNecessaryWithInsets:(char)a3 hasUpdatedVisibleCells:(double)a4 isRecursive:(double)a5
{
  v103 = *MEMORY[0x1E69E9840];
  if (!result)
  {
    return result;
  }

  v9 = result;
  result = [*(result + 2152) _estimatesSizes];
  if ((result & 1) == 0)
  {
    [v9 _clearContentOffsetRestorationAnchor];
    result = [v9 _clearTargetIndexPathForScrolling];
  }

  *(v9 + 2736) &= ~0x400000u;
  v10 = *(v9 + 3024);
  if (v10)
  {
    if ([v9 _validateScrollingTargetIndexPath:v10 raisingExceptionIfNecessary:0])
    {
      v11 = *(v9 + 3024);
      if (!v11)
      {
        v68 = [MEMORY[0x1E696AAA8] currentHandler];
        [v68 handleFailureInMethod:sel__contentOffsetForCurrentScrollingTargetWithContentInsets_ object:v9 file:@"UICollectionView.m" lineNumber:5378 description:{@"Invalid parameter not satisfying: %@", @"targetIndexPathForScrolling != nil"}];
      }

      v111.origin.x = [(UICollectionView *)v9 _frameOfElementAtScrollingTargetIndexPath:v11];
      width = v111.size.width;
      height = v111.size.height;
      x = v111.origin.x;
      y = v111.origin.y;
      if (CGRectIsNull(v111))
      {
        v69 = [MEMORY[0x1E696AAA8] currentHandler];
        v70 = objc_opt_class();
        v71 = [v11 _ui_shortDescription];
        [v69 handleFailureInMethod:sel__contentOffsetForCurrentScrollingTargetWithContentInsets_ object:v9 file:@"UICollectionView.m" lineNumber:5381 description:{@"<%@ %p> received null frame for scrolling target at index path %@.\nCollection View: %@.\nLayout: %@", v70, v9, v71, v9, *(v9 + 2152)}];
      }

      v14 = [*(v9 + 2152) _layoutAxis];
      v15 = *(v9 + 3048);
      v16 = *(v9 + 3056);
      v17 = *(v9 + 3064);
      v18 = *(v9 + 3072);
      v19 = *(v9 + 3080);
      if (_UISizeEqualToSizeWithPrecision(v18, v19, width, height, 0.0001))
      {
        [v9 contentOffset];
        v21 = v20;
        v23 = v22;
        v24 = _UIPointValueForAxis(v14, x, y);
        v25 = v24 + _UIPointValueForAxis(v14, *(v9 + 3032), *(v9 + 3040));
        if (v14 == 2)
        {
          v26 = a4;
        }

        else
        {
          v26 = a5;
        }

        v27 = _UISetPointValueForAxis(v14, v21, v23, v25 - v26);
        v29 = *(v9 + 2272);
        if (v29)
        {
          v30 = *(v29 + 80);
          v31 = *(v29 + 88);
        }

        else
        {
          v31 = 0.0;
          v30 = 0.0;
        }

        v32 = [(UICollectionView *)v9 _clampedContentOffset:v9 forScrollableAreaGivenContentSize:v27 inScrollView:v28, v30, v31];
        v34 = v33;
      }

      else
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492448);
        if (*CategoryCachedImpl)
        {
          v74 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v74, OS_LOG_TYPE_ERROR))
          {
            v75 = v74;
            v118.origin.x = v16;
            v118.origin.y = v17;
            v118.size.width = v18;
            v118.size.height = v19;
            v76 = NSStringFromCGRect(v118);
            v119.origin.x = x;
            v119.origin.y = y;
            v119.size.width = width;
            v119.size.height = height;
            v77 = NSStringFromCGRect(v119);
            v78 = [v11 _ui_shortDescription];
            *buf = 134218754;
            v96 = v9;
            v97 = 2112;
            v98 = v76;
            v99 = 2112;
            v100 = v77;
            v101 = 2112;
            v102 = v78;
            _os_log_impl(&dword_188A29000, v75, OS_LOG_TYPE_ERROR, "_contentOffsetForCurrentScrollingTarget: cv == %p; updating scrolling target info for change in size of target %@ from %@ to %@", buf, 0x2Au);
          }
        }

        [v9 _contentOffsetForScrollingToItemAtIndexPath:v11 atScrollPosition:v15 additionalInsets:{*(v9 + 3088), *(v9 + 3096), *(v9 + 3104), *(v9 + 3112)}];
        v32 = v47;
        v34 = v48;
        [(UICollectionView *)v9 _storeScrollingTargetInfoForIndexPath:v11 frame:v15 scrollPosition:x additionalInsets:y, width, height, *(v9 + 3088), *(v9 + 3096), *(v9 + 3104), *(v9 + 3112)];
      }

      if ([v9 isScrollAnimating])
      {
        v49 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492428);
        if (*v49)
        {
          v79 = *(v49 + 8);
          if (os_log_type_enabled(v79, OS_LOG_TYPE_ERROR))
          {
            v80 = v79;
            v109.x = v32;
            v109.y = v34;
            v81 = NSStringFromCGPoint(v109);
            v82 = [*(v9 + 3024) _ui_shortDescription];
            *buf = 134218498;
            v96 = v9;
            v97 = 2112;
            v98 = v81;
            v99 = 2112;
            v100 = v82;
            _os_log_impl(&dword_188A29000, v80, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Updating scroll animation to target offset %@ for %@", buf, 0x20u);
          }
        }

        return [v9 _updateScrollAnimationForChangedTargetOffset:{v32, v34}];
      }

      v50 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492430);
      if (*v50)
      {
        v83 = *(v50 + 8);
        if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
        {
          v84 = v83;
          v110.x = v32;
          v110.y = v34;
          v85 = NSStringFromCGPoint(v110);
          v86 = [*(v9 + 3024) _ui_shortDescription];
          *buf = 134218498;
          v96 = v9;
          v97 = 2112;
          v98 = v85;
          v99 = 2112;
          v100 = v86;
          _os_log_impl(&dword_188A29000, v84, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Setting content offset to %@ for scrolling to %@", buf, 0x20u);
        }
      }

      v51 = *(v9 + 3352);
      if (!v51)
      {
LABEL_35:
        v59 = *(v9 + 2736);
        *(v9 + 2736) = v59 | 0x80000;
        result = [v9 setContentOffset:{v32, v34}];
        *(v9 + 2736) = *(v9 + 2736) & 0xFFF7FFFF | (((v59 >> 19) & 1) << 19);
        return result;
      }

      v52 = MEMORY[0x1E696AEC0];
      [v9 contentOffset];
      v44 = NSStringFromCGPoint(v105);
      v106.x = v32;
      v106.y = v34;
      v53 = NSStringFromCGPoint(v106);
      v54 = [*(v9 + 3024) _ui_shortDescription];
      v55 = NSStringFromCGPoint(*(v9 + 3032));
      [v9 _effectiveContentInset];
      v56 = NSStringFromUIEdgeInsets(v114);
      [v9 safeAreaInsets];
      v57 = NSStringFromUIEdgeInsets(v115);
      v58 = [v52 stringWithFormat:@"content offset changing from %@ to %@ for scrolling to %@ with offset %@ effectiveInsets: %@; safeAreaInsets: %@", v44, v53, v54, v55, v56, v57];;
      [v51 recordGenericChangeWithMessage:v58];

LABEL_34:
      goto LABEL_35;
    }

    v45 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492438);
    if (*v45)
    {
      v72 = *(v45 + 8);
      if (os_log_type_enabled(v72, OS_LOG_TYPE_ERROR))
      {
        v73 = *(v9 + 3024);
        *buf = 134218242;
        v96 = v9;
        v97 = 2112;
        v98 = v73;
        _os_log_impl(&dword_188A29000, v72, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Clearing invalid scrolling target %@", buf, 0x16u);
      }
    }

    return [v9 _clearTargetIndexPathForScrolling];
  }

  else if (*(v9 + 3000))
  {
    v94 = 0;
    v35 = [(UICollectionView *)v9 _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:a4 shouldApply:a5];
    if (v94 == 1)
    {
      v32 = v35;
      v34 = v36;
      v37 = *(v9 + 3352);
      if (v37)
      {
        v93 = MEMORY[0x1E696AEC0];
        v38 = [*(v9 + 3000) _ui_shortDescription];
        v39 = NSStringFromCGPoint(*(v9 + 3008));
        v40 = [(UICollectionViewData *)*(v9 + 2272) layoutAttributesForItemAtIndexPath:?];
        [v9 _effectiveContentInset];
        v41 = NSStringFromUIEdgeInsets(v112);
        [v9 safeAreaInsets];
        v42 = NSStringFromUIEdgeInsets(v113);
        v43 = [v93 stringWithFormat:@"Setting content offset for restoring relative scroll position to %@ with offset %@ attributes: %@; effectiveInsets: %@; safeAreaInsets: %@", v38, v39, v40, v41, v42];;
        [v37 recordGenericChangeWithMessage:v43];
      }

      if (a2 & 1) != 0 || (a3)
      {
        goto LABEL_35;
      }

      v44 = [MEMORY[0x1E695DFB8] orderedSetWithObject:*(v9 + 3000)];
      [(UICollectionView *)v9 _addIndexPathsRequiringPreferredAttributes:v44];
      goto LABEL_34;
    }

    v60 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492440);
    if (*v60)
    {
      v87 = *(v60 + 8);
      if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
      {
        v88 = *(v9 + 3000);
        v89 = v87;
        v90 = [v88 _ui_shortDescription];
        *buf = 134218242;
        v96 = v9;
        v97 = 2112;
        v98 = v90;
        _os_log_impl(&dword_188A29000, v89, OS_LOG_TYPE_ERROR, "_adjustContentOffset: cv == %p; Clearing invalid restoration anchor %@", buf, 0x16u);
      }
    }

    return [v9 _clearContentOffsetRestorationAnchor];
  }

  else if ((*(v9 + 2738) & 0x20) != 0)
  {
    result = [v9 isDragging];
    if ((result & 1) == 0)
    {
      if ([v9 isDecelerating])
      {
        [v9 contentOffset];
        [v9 contentOffset];

        return [v9 _updateDecelerationLastOffset:?];
      }

      else
      {
        v61 = *(v9 + 3352);
        if (v61)
        {
          v62 = MEMORY[0x1E696AEC0];
          [v9 contentOffset];
          v63 = NSStringFromCGPoint(v107);
          [v9 contentSize];
          v64 = NSStringFromCGSize(v108);
          [v9 _effectiveContentInset];
          v65 = NSStringFromUIEdgeInsets(v116);
          [v9 safeAreaInsets];
          v66 = NSStringFromUIEdgeInsets(v117);
          v67 = [v62 stringWithFormat:@"Adjusting content offset after layout. Current contentOffset: %@ contentSize: %@; effectiveInsets: %@; safeAreaInsets: %@.", v63, v64, v65, v66];;
          [v61 recordGenericChangeWithMessage:v67];
        }

        return [v9 _adjustContentOffsetIfNecessary];
      }
    }
  }

  return result;
}

- (double)_contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:(double)a3 shouldApply:(double)a4
{
  v40 = *MEMORY[0x1E69E9840];
  if (!a1)
  {
    return 0.0;
  }

  if (!a2)
  {
    v33 = [MEMORY[0x1E696AAA8] currentHandler];
    [v33 handleFailureInMethod:sel__contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets_shouldApply_ object:a1 file:@"UICollectionView.m" lineNumber:5418 description:{@"Invalid parameter not satisfying: %@", @"shouldApply != NULL"}];
  }

  [a1 contentOffset];
  v9 = v8;
  v11 = v10;
  *a2 = 0;
  v12 = [*(a1 + 2152) _layoutAxis];
  if ((v12 - 1) <= 1)
  {
    v13 = v12;
    if (([a1 isScrollAnimating] & 1) == 0 && ((dyld_program_sdk_at_least() & 1) != 0 || (objc_msgSend(a1, "isDecelerating") & 1) == 0 && (objc_msgSend(a1, "isTracking") & 1) == 0))
    {
      if (*(a1 + 2280) && (dyld_program_sdk_at_least() & 1) == 0 && [*(*(a1 + 2280) + 8) count])
      {
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492450);
        if ((*CategoryCachedImpl & 1) == 0)
        {
          return v9;
        }

        v15 = *(CategoryCachedImpl + 8);
        if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          return v9;
        }

        *buf = 134217984;
        v37 = a1;
        v16 = "_contentOffsetForRestoringPosition: cv == %p; Not restoring -- have in-flight update";
        v17 = v15;
        v18 = 12;
      }

      else
      {
        v19 = *(a1 + 2272);
        if (v19 && ([(UICollectionViewData *)v19 _isIndexPathValid:1 validateItemCounts:?]& 1) != 0)
        {
          v20 = [(UICollectionViewData *)*(a1 + 2272) layoutAttributesForItemAtIndexPath:?];
          [v20 frame];
          v23 = _UIPointValueForAxis(v13, v21, v22);
          v24 = v23 + _UIPointValueForAxis(v13, *(a1 + 3008), *(a1 + 3016));
          if (v13 == 2)
          {
            v25 = a3;
          }

          else
          {
            v25 = a4;
          }

          v26 = _UISetPointValueForAxis(v13, v9, v11, v24 - v25);
          v28 = v27;
          v29 = [a1 _isAutomaticContentOffsetAdjustmentEnabled];
          [a1 _setAutomaticContentOffsetAdjustmentEnabled:1];
          [(UICollectionViewData *)*(a1 + 2272) collectionViewContentRect];
          [a1 _adjustedContentOffsetForContentOffset:0 contentSize:v26 skipsAdjustmentIfScrolling:v28];
          v9 = v30;
          [a1 _setAutomaticContentOffsetAdjustmentEnabled:v29];
          *a2 = 1;

          return v9;
        }

        v31 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492458);
        if ((*v31 & 1) == 0)
        {
          return v9;
        }

        v34 = *(v31 + 8);
        if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
        {
          return v9;
        }

        v35 = *(a1 + 3000);
        *buf = 134218242;
        v37 = a1;
        v38 = 2112;
        v39 = v35;
        v16 = "_contentOffsetForRestoringPosition: cv == %p; the anchor %@ is no longer valid";
        v17 = v34;
        v18 = 22;
      }

      _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, v16, buf, v18);
    }
  }

  return v9;
}

- (void)_addIndexPathsRequiringPreferredAttributes:(uint64_t)a1
{
  v3 = a2;
  if (a1)
  {
    v4 = *(a1 + 2680);
    v7 = v3;
    if (v4)
    {
      [v4 unionOrderedSet:v3];
    }

    else
    {
      v5 = [v3 mutableCopy];
      v6 = *(a1 + 2680);
      *(a1 + 2680) = v5;
    }

    v3 = v7;
  }
}

- (void)_applyAutomaticAdjustedContentOffset:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  p_collectionViewFlags = &self->_collectionViewFlags;
  v7 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v7 | 0x80000;
  v10.receiver = self;
  v10.super_class = UICollectionView;
  [(UIScrollView *)&v10 _applyAutomaticAdjustedContentOffset:?];
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFF7FFFF | (((v7 >> 19) & 1) << 19);
  [(UIScrollView *)self contentOffset];
  if (vabdd_f64(v9, x) >= 0.0001 || vabdd_f64(v8, y) >= 0.0001)
  {
    *(p_collectionViewFlags + 4) &= ~0x200000u;
  }
}

- (double)_frameOfElementAtScrollingTargetIndexPath:(uint64_t)a1
{
  if (!a1)
  {
    return 0.0;
  }

  v4 = [a2 section];
  if ([a2 item] == 0x7FFFFFFFFFFFFFFFLL)
  {
    [*(a1 + 2152) _frameForScrollingToFirstElementInSectionAtIndex:v4];
    v6 = v5;
    v8 = v7;
    v10 = v9;
    v12 = v11;
  }

  else
  {
    v6 = *MEMORY[0x1E695F050];
    v8 = *(MEMORY[0x1E695F050] + 8);
    v10 = *(MEMORY[0x1E695F050] + 16);
    v12 = *(MEMORY[0x1E695F050] + 24);
  }

  v17.origin.x = v6;
  v17.origin.y = v8;
  v17.size.width = v10;
  v17.size.height = v12;
  if (CGRectIsNull(v17))
  {
    v13 = [a2 item];
    if (v13 < [(UICollectionViewData *)*(a1 + 2272) numberOfItemsInSection:v4])
    {
      v14 = [(UICollectionViewData *)*(a1 + 2272) layoutAttributesForItemAtIndexPath:a2];
      [v14 frame];
      v6 = v15;
    }
  }

  return v6;
}

- (double)_clampedContentOffset:(double)a3 forScrollableAreaGivenContentSize:(double)a4 inScrollView:(double)a5
{
  v10 = a2;
  v11 = v10;
  if (a1)
  {
    if (fabs(a5 * a6) >= 2.22044605e-16)
    {
      [v10 _maximumContentOffsetForContentSize:{a5, a6}];
      v13 = v12;
      [v11 _minimumContentOffset];
      if (a3 <= v13)
      {
        v15 = a3;
      }

      else
      {
        v15 = v13;
      }

      if (v15 >= v14)
      {
        a3 = v15;
      }

      else
      {
        a3 = v14;
      }
    }
  }

  else
  {
    a3 = 0.0;
  }

  return a3;
}

- (id)_storeScrollingTargetInfoForIndexPath:(void *)a3 frame:(double)a4 scrollPosition:(double)a5 additionalInsets:(double)a6
{
  if (result)
  {
    if (a2)
    {
      v21 = result;
      [result _contentOffsetForScrollingToItemAtIndexPath:a2 atScrollPosition:a3 additionalInsets:result itemFrame:0 containingScrollView:a8 clampToScrollableArea:{a9, a10, a11, a4, a5, a6, a7}];
      v26 = v23;
      v27 = v22;
      objc_storeStrong(v21 + 378, a2);
      v21[381] = a3;
      *(v21 + 386) = a8;
      *(v21 + 387) = a9;
      *(v21 + 388) = a10;
      *(v21 + 389) = a11;
      *(v21 + 382) = a4;
      *(v21 + 383) = a5;
      *(v21 + 384) = a6;
      *(v21 + 385) = a7;
      result = [v21 _contentInsetIncludingDecorations];
      *(v21 + 379) = v27 - a4 + v24;
      *(v21 + 380) = v26 - a5 + v25;
    }
  }

  return result;
}

- (unint64_t)_updateVisibleCellsNow:(BOOL)a3
{
  v153 = *MEMORY[0x1E69E9840];
  if (self->_reloadingSuspendedCount > 0)
  {
    return 0;
  }

  v4 = a3;
  if (self->_updateAnimationCount >= 1 && (*(&self->_collectionViewFlags + 15) & 8) == 0)
  {
    return 0;
  }

  updateVisibleCellsRecursionCount = self->_updateVisibleCellsRecursionCount;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492460);
  if (*CategoryCachedImpl)
  {
    v112 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v112, OS_LOG_TYPE_ERROR))
    {
      v113 = self->_updateVisibleCellsRecursionCount;
      [(UICollectionView *)self _visibleBounds];
      v114 = NSStringFromCGRect(v154);
      *v147 = 134218498;
      v148 = self;
      v149 = 2048;
      v150 = v113;
      v151 = 2112;
      v152 = v114;
      _os_log_impl(&dword_188A29000, v112, OS_LOG_TYPE_ERROR, "_updateVisibleCellsNow: %p; recursionCount=%ld, _visibleBounds=%@", v147, 0x20u);
    }
  }

  v124 = [(UICollectionViewLayout *)self->_layout _wantsUpdateVisibleCellsPassNotifications];
  if (v124)
  {
    [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
  }

  v120 = [(UIView *)self _focusSystem];
  [v120 _lockEnvironment:self];
  [(UIScrollView *)self _contentInsetIncludingDecorations];
  v9 = v8;
  v11 = v10;
  if (+[UIView _isInAnimationBlockWithAnimationsEnabled]&& (*(&self->_collectionViewFlags + 12) & 2) != 0)
  {
    v13 = [(UICollectionView *)self _shouldFadeCellsForBoundChangeWhileRotating];
    v12 = 0x10000000;
    if (!v13)
    {
      v12 = 0;
    }
  }

  else
  {
    v12 = 0;
  }

  *(&self->_collectionViewFlags + 1) |= v12;
  [(UICollectionView *)self _suspendReloads];
  v14 = *(&self->_collectionViewFlags + 1);
  if (updateVisibleCellsRecursionCount <= 0)
  {
    didScrollNotificationSuspensionCount = self->_didScrollNotificationSuspensionCount;
    if (!didScrollNotificationSuspensionCount)
    {
      [(UIScrollView *)self contentOffset];
      self->_contentOffsetWhenScrollNotificationsSuspended.x = v17;
      self->_contentOffsetWhenScrollNotificationsSuspended.y = v18;
    }

    self->_didScrollNotificationSuspensionCount = didScrollNotificationSuspensionCount + 1;
    if ((v14 & 0x10000000) != 0)
    {
      goto LABEL_15;
    }

LABEL_19:
    [(UICollectionView *)self _restoreOrAdjustContentOffsetIfNecessaryWithInsets:updateVisibleCellsRecursionCount > 0 hasUpdatedVisibleCells:v9 isRecursive:v11];
    goto LABEL_20;
  }

  if ((v14 & 0x10000000) == 0)
  {
    goto LABEL_19;
  }

LABEL_15:
  [(UICollectionView *)self _resetPrefetchState];
  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  [(UICollectionViewLayout *)self->_layout prepareForAnimatedBoundsChange:self->_preRotationBounds.origin.x, self->_preRotationBounds.origin.y, self->_preRotationBounds.size.width, self->_preRotationBounds.size.height];
  layout = self->_layout;
  [(UIScrollView *)self contentOffset];
  [(UICollectionViewLayout *)layout targetContentOffsetForProposedContentOffset:?];
  [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
  [(UICollectionView *)self setContentOffset:?];
LABEL_20:
  v119 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v119 & 0xFFFFFEBFFFFFFFFFLL | 0x4000000000;
  v19 = self->_subviewManager;
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v123 = [(UICollectionViewData *)collectionViewData layoutAttributesForElementsInRect:v21, v22, v23, v24];
  if (v4)
  {
    *(&self->_collectionViewFlags + 1) &= 0xFFFFFFFFEFFFFBFFLL;
  }

  [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
  [(UICollectionView *)self _setContentSizeFromLayout:updateVisibleCellsRecursionCount > 0 isRecursivelyUpdatingVisibleCells:v25, v26];
  if ((v14 & 0x10000000) != 0)
  {
    v27 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v134[0] = MEMORY[0x1E69E9820];
    v134[1] = 3221225472;
    v134[2] = __43__UICollectionView__updateVisibleCellsNow___block_invoke;
    v134[3] = &unk_1E70FFC98;
    v28 = v27;
    v135 = v28;
    if (v19)
    {
      [(_UICollectionViewSubviewCollection *)v19->_visibleViews enumerateAllViewsWithEnumerator:v134];
    }

    [v28 sortUsingComparator:&__block_literal_global_116];
    v29 = [objc_alloc(MEMORY[0x1E695DEC8]) initWithArray:v123 copyItems:1];
    v30 = self->_layout;
    [(UIScrollView *)self contentOffset];
    [(UICollectionViewLayout *)v30 _prepareToAnimateFromCollectionViewItems:v28 atContentOffset:v29 toItems:self->_lastLayoutOffset.x atContentOffset:self->_lastLayoutOffset.y, v31, v32];
  }

  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController layoutScrollViews];
  [(UICollectionView *)self _layoutSectionContainerViews];
  v128 = v14;
  v126 = updateVisibleCellsRecursionCount;
  v125 = v4;
  p_isa = &v19->super.isa;
  if (v4)
  {
    v33 = [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes copy];
    indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
    self->_indexPathsRequiringPreferredAttributes = 0;

    v118 = v33;
    if ((*(&self->_collectionViewFlags + 11) & 0x40) != 0)
    {
      v66 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492470);
      if (*v66)
      {
        v116 = *(v66 + 8);
        if (os_log_type_enabled(v116, OS_LOG_TYPE_ERROR))
        {
          *v147 = 134217984;
          v148 = self;
          _os_log_impl(&dword_188A29000, v116, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; skipping because we need a reload", v147, 0xCu);
        }
      }
    }

    else
    {
      v138 = 0u;
      v139 = 0u;
      v136 = 0u;
      v137 = 0u;
      v35 = v33;
      v36 = [v35 countByEnumeratingWithState:&v136 objects:v147 count:16];
      if (v36)
      {
        v37 = v36;
        v38 = *v137;
        v127 = v35;
        do
        {
          v39 = 0;
          do
          {
            if (*v137 != v38)
            {
              objc_enumerationMutation(v35);
            }

            v40 = *(*(&v136 + 1) + 8 * v39);
            if ([(UICollectionView *)self _indexPathIsValid:v40])
            {
              v41 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v40];
              if (v41)
              {
                v42 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v40];
                if (v42)
                {
                  v43 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492478);
                  if (*v43)
                  {
                    v52 = *(v43 + 8);
                    if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
                    {
                      v53 = v52;
                      v54 = [v40 _ui_shortDescription];
                      *buf = 134218498;
                      v142 = self;
                      v143 = 2112;
                      v144 = v42;
                      v145 = 2112;
                      v146 = v54;
                      _os_log_impl(&dword_188A29000, v53, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for existing cell: %@; index path: %@", buf, 0x20u);
                    }
                  }

                  [(UICollectionView *)self _recomputePreferredAttributesForInvalidatedView:v42 originalAttributes:v41];
                }

                else
                {
                  v44 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v40];
                  if (v44)
                  {
                    v45 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492480);
                    if (*v45)
                    {
                      v55 = *(v45 + 8);
                      if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
                      {
                        *buf = 134218242;
                        v142 = self;
                        v143 = 2112;
                        v144 = v44;
                        _os_log_impl(&dword_188A29000, v55, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for cell in prefetch cache: %@", buf, 0x16u);
                      }
                    }

                    *&v44->super.super._responderFlags |= 3u;
                  }

                  else if ([(UICollectionView *)self _hasFocusedCellForIndexPath:v40 shouldUsePreUpdateData:0])
                  {
                    v46 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492488);
                    if (*v46)
                    {
                      v56 = *(v46 + 8);
                      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
                      {
                        v57 = v56;
                        v58 = [(UICollectionView *)self _focusedItemState];
                        *buf = 134218242;
                        v142 = self;
                        v143 = 2112;
                        v144 = v58;
                        _os_log_impl(&dword_188A29000, v57, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for focused cell: %@", buf, 0x16u);
                      }
                    }

                    v47 = [(UICollectionView *)self _focusedItemState];
                    v48 = [(_UICollectionViewFocusedItemState *)v47 cell];

                    [v48 _invalidatePreferredAttributes];
                  }

                  else if (self->_firstResponderViewType == 1 && [(NSIndexPath *)self->_firstResponderIndexPath isEqual:v40])
                  {
                    v49 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492490);
                    if (*v49)
                    {
                      v62 = *(v49 + 8);
                      if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
                      {
                        firstResponderView = self->_firstResponderView;
                        v63 = v62;
                        v64 = [v40 _ui_shortDescription];
                        *buf = 134218498;
                        v142 = self;
                        v143 = 2112;
                        v144 = firstResponderView;
                        v145 = 2112;
                        v146 = v64;
                        _os_log_impl(&dword_188A29000, v63, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; recomputing preferred attributes for first responder cell: %@; index path: %@", buf, 0x20u);
                      }
                    }

                    [(UICollectionReusableView *)self->_firstResponderView _invalidatePreferredAttributes];
                  }

                  else
                  {
                    v50 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492498);
                    if (*v50)
                    {
                      v59 = *(v50 + 8);
                      if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR))
                      {
                        v60 = v59;
                        v61 = [v40 _ui_shortDescription];
                        *buf = 134218242;
                        v142 = self;
                        v143 = 2112;
                        v144 = v61;
                        _os_log_impl(&dword_188A29000, v60, OS_LOG_TYPE_ERROR, "_processIndexPathsRequiringPreferredAttributes: cv == %p; creating cell for item at index path: %@", buf, 0x16u);
                      }
                    }
                  }

                  v51 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:v40 withLayoutAttributes:v41 applyAttributes:1 isFocused:0 notify:1];
                  [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:v51 atIndexPath:v40];

                  v35 = v127;
                }
              }
            }

            ++v39;
          }

          while (v37 != v39);
          v65 = [v35 countByEnumeratingWithState:&v136 objects:v147 count:16];
          v37 = v65;
        }

        while (v65);
      }

      v19 = p_isa;
      v14 = v128;
    }
  }

  v67 = [(_UICollectionViewSubviewManager *)v19 allVisibleViewsSubviewCollection];
  v68 = [(UICollectionView *)self _currentPromiseFulfillmentCell];

  if (v68)
  {
    v69 = [(UICollectionView *)self _currentPromiseFulfillmentCell];
    v70 = [(UICollectionView *)self _indexPathForCell:v69];

    if (v70 && v67)
    {
      [v67[1] removeObjectForKey:v70];
    }
  }

  v71 = [v123 count];
  v72 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v71];
  v130 = 0u;
  v131 = 0u;
  v132 = 0u;
  v133 = 0u;
  v73 = v123;
  v74 = [v73 countByEnumeratingWithState:&v130 objects:v140 count:16];
  if (v74)
  {
    v75 = v74;
    v76 = *v131;
    do
    {
      v77 = 0;
      do
      {
        if (*v131 != v76)
        {
          objc_enumerationMutation(v73);
        }

        v78 = *(*(&v130 + 1) + 8 * v77);
        v79 = [(UICollectionView *)self _visibleViewForLayoutAttributes:v78];
        if (v79)
        {
          if (!v78)
          {
            v80 = 0;
            goto LABEL_82;
          }

          if ((*(v78 + 288) & 1) == 0)
          {
            v80 = (*(v78 + 288) & 2) == 0;
LABEL_82:
            v81 = [(_UILabelConfiguration *)v78 _content];
            v82 = [(UICollectionViewLayoutAttributes *)v78 __indexPath];
            if (v80)
            {
              [(_UICollectionViewSubviewCollection *)v67 removeViewForSupplementaryOfKind:v81 atIndexPath:v82];
            }

            else
            {
              [(_UICollectionViewSubviewCollection *)v67 removeViewForDecorationOfKind:v81 atIndexPath:v82];
            }

            v14 = v128;
            goto LABEL_92;
          }

          v83 = v79;
          v84 = [(UICollectionViewLayoutAttributes *)v78 __indexPath];
          if (v67)
          {
            [v67[1] removeObjectForKey:v84];
          }

          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v83 forIndexPath:[(UICollectionViewLayoutAttributes *)v78 __indexPath]];
        }

        else if ((v14 & 0x10000000) != 0 || ([v78 isHidden] & 1) == 0)
        {
          [v72 addObject:v78];
        }

LABEL_92:
        ++v77;
      }

      while (v75 != v77);
      v85 = [v73 countByEnumeratingWithState:&v130 objects:v140 count:16];
      v75 = v85;
    }

    while (v85);
  }

  [(UICollectionView *)self _removeVisibleViews:v67 fadeForBoundsChange:(v14 >> 28) & 1];
  v86 = *(&self->_collectionViewFlags + 1);
  if ((v86 & 0x200) == 0)
  {
    *(&self->_collectionViewFlags + 1) = v86 & 0xFFFFFFFFFFFFF5FFLL;
  }

  if ((v86 & 0x800) != 0 && [(UICollectionView *)self _useIdleObserverForCellPrefetching])
  {
    [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:&__block_literal_global_500];
  }

  if ((*(&self->_collectionViewFlags + 13) & 8) != 0)
  {
    v87 = [(UICollectionView *)self _focusedItemState];
    [(UICollectionView *)self _setFocusedItemState:0];
    v88 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492468);
    if (*v88)
    {
      v115 = *(v88 + 8);
      if (os_log_type_enabled(v115, OS_LOG_TYPE_ERROR))
      {
        *v147 = 134218242;
        v148 = self;
        v149 = 2112;
        v150 = v87;
        _os_log_impl(&dword_188A29000, v115, OS_LOG_TYPE_ERROR, "[UICV %p] Handling updateFocusAfterLoadingCells. Item focused before reload: %@", v147, 0x16u);
      }
    }
  }

  else
  {
    v87 = 0;
  }

  if (v125)
  {
    v3 = [(UICollectionView *)self _createVisibleViewsForAttributes:v72 fadeForBoundsChange:(v14 >> 28) & 1 notifyLayoutForVisibleCellsPass:v124];
  }

  else
  {
    v3 = 0;
  }

  v89 = *(&self->_collectionViewFlags + 1);
  if ((v89 & 0x200) != 0)
  {
    [(UICollectionView *)self performSelector:sel__resumeReloads withObject:0 afterDelay:0.0];
  }

  else
  {
    [(UICollectionView *)self _visibleBounds];
    self->_visibleBounds.origin.x = v90;
    self->_visibleBounds.origin.y = v91;
    self->_visibleBounds.size.width = v92;
    self->_visibleBounds.size.height = v93;
    if ((v86 & 0x800) == 0 || ([(UICollectionView *)self _updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(v14 >> 28) & 1], dyld_program_sdk_at_least()))
    {
      [(UICollectionView *)self _processViewSpecificInvalidationsForVisibleViews];
    }

    if ((v128 & 0x10000000) != 0)
    {
      [(UICollectionViewLayout *)self->_layout _finalizeCollectionViewItemAnimations];
      [(UICollectionViewLayout *)self->_layout finalizeAnimatedBoundsChange];
    }
  }

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    [(UICollectionView *)self _prepareClonedViewsForTransitionLayout];
  }

  *(&self->_collectionViewFlags + 1) &= ~0x200000000uLL;
  [(UIScrollView *)self contentOffset];
  v95 = v94;
  v97 = v96;
  x = self->_lastLayoutOffset.x;
  y = self->_lastLayoutOffset.y;
  v100 = [(UIView *)self window];
  v101 = [v100 isRotating];

  if ((v101 & 1) == 0)
  {
    [(UIScrollView *)self contentOffset];
    self->_lastLayoutOffset.x = v102;
    self->_lastLayoutOffset.y = v103;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFBFFFFFFFFFLL | (((v119 >> 38) & 1) << 38);
  if ((v89 & 0x200) == 0)
  {
    [(UICollectionView *)self _resumeReloads];
  }

  invalidationBlock = self->_invalidationBlock;
  if (invalidationBlock)
  {
    invalidationBlock[2]();
    v105 = self->_invalidationBlock;
    self->_invalidationBlock = 0;
  }

  [v120 _unlockEnvironment:self];
  [(UICollectionView *)self _updateFocusAfterLoadingVisibleCellsIfNeeded:v87];
  if (v124)
  {
    [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v95 - x, v97 - y];
  }

  [(UICollectionView *)self _restoreOrAdjustContentOffsetIfNecessaryWithInsets:v126 > 0 hasUpdatedVisibleCells:v9 isRecursive:v11];
  if (v125 && (*(&self->_collectionViewFlags + 9) & 4) != 0)
  {
    [(UICollectionViewData *)self->_collectionViewData invalidate:?];
    v106 = self->_updateVisibleCellsRecursionCount;
    self->_updateVisibleCellsRecursionCount = v106 + 1;
    if (v106 >= 15 && !self->_debugger)
    {
      v107 = objc_alloc_init(_UICollectionViewFeedbackLoopDebugger);
      debugger = self->_debugger;
      self->_debugger = v107;
    }

    v3 += [(UICollectionView *)self _updateVisibleCellsNow:1];
    --self->_updateVisibleCellsRecursionCount;
    v109 = self->_debugger;
    if (v109)
    {
      self->_debugger = 0;
    }
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  v110 = *(&self->_collectionViewFlags + 4);
  if ((v110 & 0x10000) != 0)
  {
    [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    v110 = *(&self->_collectionViewFlags + 4);
  }

  *(&self->_collectionViewFlags + 4) = v110 & 0xFFDFFFFF;
  [(UICollectionView *)self _ensureFocusedViewIsNotHidden];
  if (v126 <= 0)
  {
    [(UICollectionView *)self _setUpCompletionHandlerForAnimationInterruptionIfNecessary];
    [(UICollectionView *)self _resumeDidScrollNotifications];
    if (p_isa)
    {
      [p_isa[4] removeAllObjects];
    }
  }

  v129[0] = MEMORY[0x1E69E9820];
  v129[1] = 3221225472;
  v129[2] = __43__UICollectionView__updateVisibleCellsNow___block_invoke_505;
  v129[3] = &unk_1E70FF0A0;
  v129[4] = self;
  v129[5] = a2;
  [(_UICollectionViewSubviewManager *)p_isa removeAllDequeuedViewsWithEnumerator:v129];

  return v3;
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  v5 = *(a1 + 32);
  v6 = [a5 _layoutAttributes];
  [v5 addObject:v6];
}

uint64_t __43__UICollectionView__updateVisibleCellsNow___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v4 = [(UICollectionViewLayoutAttributes *)a2 __indexPath];
  v5 = [(UICollectionViewLayoutAttributes *)a3 __indexPath];

  return [v4 compare:v5];
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    *(a3 + 8) |= 1u;
  }
}

void __43__UICollectionView__updateVisibleCellsNow___block_invoke_505(uint64_t a1, void *a2)
{
  v12 = *MEMORY[0x1E69E9840];
  v3 = a2;
  _UIIsPrivateMainBundle();
  if (dyld_program_sdk_at_least())
  {
    v4 = [MEMORY[0x1E696AAA8] currentHandler];
    [NSObject handleFailureInMethod:v4 object:"handleFailureInMethod:object:file:lineNumber:description:" file:*(a1 + 40) lineNumber:v3 description:*(a1 + 32)];
LABEL_3:

    goto LABEL_7;
  }

  if (os_variant_has_internal_diagnostics())
  {
    v4 = __UIFaultDebugAssertLog();
    if (os_log_type_enabled(v4, OS_LOG_TYPE_FAULT))
    {
      v7 = *(a1 + 32);
      *buf = 138412546;
      v9 = v3;
      v10 = 2112;
      v11 = v7;
      _os_log_fault_impl(&dword_188A29000, v4, OS_LOG_TYPE_FAULT, "Expected dequeued view to be returned to the collection view in preparation for display. When the collection view's data source is asked to provide a view for a given index path, ensure that a single view is dequeued and returned to the collection view. Avoid flushing layout before returning the view to the collection view. Avoid dequeuing views without a request from the collection view. For retrieving an existing view in the collection view, use [UICollectionView cellForItemAtIndexPath:] or [UICollectionView supplementaryViewForElementKind:atIndexPath:]. Dequeued view: %@; Collection view: %@ This will become an assert in a future version.", buf, 0x16u);
    }

    goto LABEL_3;
  }

  v5 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_6___s_category) + 8);
  if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
  {
    v6 = *(a1 + 32);
    *buf = 138412546;
    v9 = v3;
    v10 = 2112;
    v11 = v6;
    _os_log_impl(&dword_188A29000, v5, OS_LOG_TYPE_ERROR, "Expected dequeued view to be returned to the collection view in preparation for display. When the collection view's data source is asked to provide a view for a given index path, ensure that a single view is dequeued and returned to the collection view. Avoid flushing layout before returning the view to the collection view. Avoid dequeuing views without a request from the collection view. For retrieving an existing view in the collection view, use [UICollectionView cellForItemAtIndexPath:] or [UICollectionView supplementaryViewForElementKind:atIndexPath:]. Dequeued view: %@; Collection view: %@ This will become an assert in a future version.", buf, 0x16u);
  }

LABEL_7:
  [v3 _setHiddenForReuse:1];
}

- (void)_decrementRotationAnimationCount
{
  v2 = self->_rotationAnimationCount - 1;
  self->_rotationAnimationCount = v2;
  if (!v2)
  {
    self->_rotationBoundsOffset = *MEMORY[0x1E695EFF8];
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    [(UIScrollView *)self contentOffset];
    self->_lastLayoutOffset.x = v4;
    self->_lastLayoutOffset.y = v5;
  }
}

- (void)_animateVisibleView:(id)a3 withLayoutAttributes:(id)a4 completionHandler:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  [(UICollectionView *)self _incrementRotationAnimationCount];
  v24[0] = 0;
  v24[1] = v24;
  v24[2] = 0x2020000000;
  v25 = 0;
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke;
  v19[3] = &unk_1E70FF0C8;
  v20 = v8;
  v11 = v9;
  v22 = self;
  v23 = v24;
  v21 = v11;
  v14[0] = MEMORY[0x1E69E9820];
  v14[1] = 3221225472;
  v14[2] = __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke_2;
  v14[3] = &unk_1E70FF0F0;
  v18 = v24;
  v12 = v20;
  v15 = v12;
  v13 = v10;
  v16 = self;
  v17 = v13;
  [UIView animateWithDuration:v19 animations:v14 completion:0.0];

  _Block_object_dispose(v24, 8);
}

void __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke(uint64_t a1)
{
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v2 = *(a1 + 32);
    [*(a1 + 40) center];
    [v2 setPosition:?];
    [v2 bounds];
    v4 = v3;
    v6 = v5;
    [*(a1 + 40) size];
    [v2 setBounds:{v4, v6, v7, v8}];
    [*(a1 + 40) alpha];
    *&v9 = v9;
    [v2 setOpacity:v9];
    v10 = *(a1 + 40);
    if (v10)
    {
      [v10 transform3D];
    }

    else
    {
      memset(v17, 0, sizeof(v17));
    }

    [v2 setTransform:v17];
  }

  else
  {
    [*(a1 + 40) alpha];
    if (v11 == 0.0)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v12 = [*(a1 + 32) _disableRasterizeInAnimations];
        *(*(*(a1 + 56) + 8) + 24) = 0;
      }

      else
      {
        v12 = 0;
      }

      if ((dyld_program_sdk_at_least() & 1) == 0 && (v12 & 1) == 0)
      {
        v13 = [*(a1 + 32) layer];
        if (([v13 shouldRasterize] & 1) == 0)
        {
          *(*(*(a1 + 56) + 8) + 24) = 1;
        }

        [v13 setShouldRasterize:1];
        [*(a1 + 48) _currentScreenScale];
        [v13 setRasterizationScale:?];
      }
    }

    v15 = *(a1 + 40);
    v14 = *(a1 + 48);
    v16 = *(a1 + 32);

    [v14 _applyLayoutAttributes:v15 toView:v16];
  }
}

uint64_t __79__UICollectionView__animateVisibleView_withLayoutAttributes_completionHandler___block_invoke_2(uint64_t a1)
{
  if (*(*(*(a1 + 56) + 8) + 24) == 1)
  {
    v2 = [*(a1 + 32) layer];
    [v2 setShouldRasterize:0];
  }

  v3 = *(a1 + 48);
  if (v3)
  {
    (*(v3 + 16))();
  }

  v4 = *(a1 + 40);

  return [v4 _decrementRotationAnimationCount];
}

- (void)_removeVisibleViews:(id)a3 fadeForBoundsChange:(BOOL)a4
{
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke;
  v4[3] = &unk_1E70FEBD8;
  v4[4] = self;
  v5 = a4;
  [(_UICollectionViewSubviewCollection *)a3 enumerateAllViewsWithEnumerator:v4];
}

void __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v9 = a3;
  v10 = a4;
  v11 = a5;
  switch(a2)
  {
    case 2:
      v12 = *(a1 + 32);
      v13 = 2672;
      goto LABEL_7;
    case 1:
      v12 = *(a1 + 32);
      v13 = 2664;
LABEL_7:
      v14 = [*(v12 + v13) objectForKeyedSubscript:v10];
      [v14 removeObject:v9];

      break;
    case 0:
      [*(*(a1 + 32) + 2656) removeObject:v9];
      break;
  }

  if (([v11 _isInUpdateAnimation] & 1) == 0)
  {
    v15 = *(a1 + 32);
    v16 = *(v15 + 2984);
    if (v16)
    {
      [(_UICollectionViewSubviewCollection *)*(v16 + 8) removeViewOfKind:v10 inCategory:a2 atIndexPath:v9];
      v15 = *(a1 + 32);
    }

    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_2;
    aBlock[3] = &unk_1E70FF118;
    aBlock[4] = v15;
    v17 = v9;
    v33 = v17;
    v18 = _Block_copy(aBlock);
    v19 = v18;
    if (*(a1 + 40) != 1)
    {
      (*(v18 + 2))(v18, a2, v11);
LABEL_23:

      goto LABEL_24;
    }

    if (a2 == 2)
    {
      v25 = *(*(a1 + 32) + 2152);
      v22 = [v11 _layoutAttributes];
      v23 = [(_UILabelConfiguration *)v22 _content];
      v24 = [v25 finalLayoutAttributesForDisappearingDecorationElementOfKind:v23 atIndexPath:v17];
    }

    else
    {
      if (a2 != 1)
      {
        if (!a2)
        {
          v20 = [*(*(a1 + 32) + 2152) finalLayoutAttributesForDisappearingItemAtIndexPath:v17];
          if (v20)
          {
            goto LABEL_22;
          }
        }

        goto LABEL_21;
      }

      v21 = *(*(a1 + 32) + 2152);
      v22 = [v11 _layoutAttributes];
      v23 = [(_UILabelConfiguration *)v22 _content];
      v24 = [v21 finalLayoutAttributesForDisappearingSupplementaryElementOfKind:v23 atIndexPath:v17];
    }

    v20 = v24;

    if (v20)
    {
LABEL_22:
      v27 = *(a1 + 32);
      v28[0] = MEMORY[0x1E69E9820];
      v28[1] = 3221225472;
      v28[2] = __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_513;
      v28[3] = &unk_1E70FF140;
      v30 = v19;
      v31 = a2;
      v29 = v11;
      [v27 _animateVisibleView:v29 withLayoutAttributes:v20 completionHandler:v28];

      goto LABEL_23;
    }

LABEL_21:
    v26 = [v11 _layoutAttributes];
    v20 = [v26 copy];

    [v20 setAlpha:0.0];
    goto LABEL_22;
  }

LABEL_24:
}

void __60__UICollectionView__removeVisibleViews_fadeForBoundsChange___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v15 = *MEMORY[0x1E69E9840];
  v5 = a3;
  if ([v5 _isInUpdateAnimation])
  {
    if (os_variant_has_internal_diagnostics())
    {
      v9 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v9, OS_LOG_TYPE_FAULT))
      {
        v10 = *(a1 + 32);
        v11 = 138412546;
        v12 = v10;
        v13 = 2112;
        v14 = v5;
        _os_log_fault_impl(&dword_188A29000, v9, OS_LOG_TYPE_FAULT, "Warning: view should never be in update animation (ignoring - rotation + disappearing item?) for cv == %@; view == %@", &v11, 0x16u);
      }
    }

    else
    {
      v6 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewCellPrefetchingMode_block_invoke_7___s_category) + 8);
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        v7 = *(a1 + 32);
        v11 = 138412546;
        v12 = v7;
        v13 = 2112;
        v14 = v5;
        _os_log_impl(&dword_188A29000, v6, OS_LOG_TYPE_ERROR, "Warning: view should never be in update animation (ignoring - rotation + disappearing item?) for cv == %@; view == %@", &v11, 0x16u);
      }
    }
  }

  else
  {
    v8 = *(a1 + 32);
    if (a2)
    {
      [v8 _reuseSupplementaryView:v5];
    }

    else
    {
      [v8 _cacheOrReuseCell:v5 forIndexPath:*(a1 + 40) invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];
    }
  }
}

- (id)_updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:(BOOL)a3
{
  v24 = *MEMORY[0x1E69E9840];
  [(UICollectionViewData *)self->_collectionViewData invalidate:?];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v10 = [(UICollectionViewData *)collectionViewData layoutAttributesForElementsInRect:v6, v7, v8, v9];
  v11 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v10, "count")}];
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v22 = 0u;
  v12 = v10;
  v13 = [v12 countByEnumeratingWithState:&v19 objects:v23 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v20;
    do
    {
      for (i = 0; i != v14; ++i)
      {
        if (*v20 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v19 + 1) + 8 * i);
        if (!-[UICollectionView _visibleViewForLayoutAttributes:](self, "_visibleViewForLayoutAttributes:", v17, v19) && (a3 || ([v17 isHidden] & 1) == 0))
        {
          [v11 addObject:v17];
        }
      }

      v14 = [v12 countByEnumeratingWithState:&v19 objects:v23 count:16];
    }

    while (v14);
  }

  [(UICollectionView *)self _sortAttributesByDistanceToVisibleBoundsOrigin:v11];

  return v11;
}

- (void)_sortAttributesByDistanceToVisibleBoundsOrigin:(id)a3
{
  v4 = a3;
  [(UICollectionView *)self _visibleBounds];
  v6 = v5;
  v8 = v7;
  v9 = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __67__UICollectionView__sortAttributesByDistanceToVisibleBoundsOrigin___block_invoke;
  v10[3] = &unk_1E70FF168;
  v11 = v9;
  v10[4] = self;
  v10[5] = v6;
  v10[6] = v8;
  [v4 sortUsingComparator:v10];
}

uint64_t __67__UICollectionView__sortAttributesByDistanceToVisibleBoundsOrigin___block_invoke(uint64_t a1, void *a2, void *a3)
{
  if (*(a1 + 56) == 1)
  {
    v5 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a2];
  }

  else
  {
    [a2 frame];
  }

  v9 = v5;
  v10 = v6;
  v11 = v7;
  v12 = v8;
  if (*(a1 + 56) == 1)
  {
    v13 = [(UICollectionView *)*(a1 + 32) _layoutAttributesFrameAdjustedForOrthogonalScrollingOffset:a3];
  }

  else
  {
    [a3 frame];
  }

  v17 = v13;
  v18 = v14;
  v19 = v15;
  v20 = v16;
  UIDistanceBetweenPointAndRect(*(a1 + 40), *(a1 + 48), v9, v10, v11, v12);
  v22 = v21;
  UIDistanceBetweenPointAndRect(*(a1 + 40), *(a1 + 48), v17, v18, v19, v20);
  if (v22 >= v23)
  {
    v24 = 0;
  }

  else
  {
    v24 = -1;
  }

  if (v22 > v23)
  {
    return 1;
  }

  else
  {
    return v24;
  }
}

- (id)_layoutAttributes:(id)a3 filteredForCategory:(unint64_t)a4
{
  v23 = *MEMORY[0x1E69E9840];
  v5 = a3;
  v6 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v5, "count")}];
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v21 = 0u;
  v7 = v5;
  v8 = [v7 countByEnumeratingWithState:&v18 objects:v22 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v19;
    do
    {
      v11 = 0;
      do
      {
        if (*v19 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v18 + 1) + 8 * v11);
        if (v12)
        {
          v13 = *(v12 + 288);
          if ((v13 & 2) != 0)
          {
            v14 = 2;
          }

          else
          {
            v14 = 1;
          }

          if (v13)
          {
            v15 = 0;
          }

          else
          {
            v15 = v14;
          }
        }

        else
        {
          v15 = 0;
        }

        if (v15 == a4)
        {
          [v6 addObject:v18];
        }

        ++v11;
      }

      while (v9 != v11);
      v16 = [v7 countByEnumeratingWithState:&v18 objects:v22 count:16];
      v9 = v16;
    }

    while (v16);
  }

  return v6;
}

- (_UICollectionViewVisibleCellsUpdateResult)_createVisibleViewsForSingleCategoryAttributes:(SEL)a3 limitCreation:(id)a4 fadeForBoundsChange:(BOOL)a5
{
  v6 = a6;
  v7 = a5;
  v10 = a4;
  *&retstr->var0 = 0u;
  *&retstr->var2 = 0u;
  v11 = [v10 count] >> 1;
  if (v11 >= 5)
  {
    v11 = 5;
  }

  if (v11 <= 1)
  {
    v11 = 1;
  }

  v45 = v11;
  v12 = self->_subviewManager;
  if ([v10 count])
  {
    v43 = retstr;
    v46 = v12;
    v44 = v7;
    do
    {
      if (v7 && retstr->var0 >= v45)
      {
        retstr->var3 = 1;
        break;
      }

      v13 = [v10 objectAtIndexedSubscript:0];
      [v10 removeObjectAtIndex:0];
      v14 = [(UICollectionViewLayoutAttributes *)v13 __indexPath];
      if (v13)
      {
        v15 = *(v13 + 288) & 1;
        if (!v6)
        {
          goto LABEL_13;
        }
      }

      else
      {
        v15 = 0;
        if (!v6)
        {
LABEL_13:
          v16 = [v13 isHidden] ^ 1;
          goto LABEL_14;
        }
      }

      v16 = 1;
LABEL_14:
      v50 = v14;
      v49 = v15;
      if ((v16 & v15) != 1 || ![(UICollectionView *)self _prefetchingAllowed])
      {
        v19 = 0;
        v20 = 0;
        if (v13)
        {
          goto LABEL_20;
        }

        goto LABEL_61;
      }

      v17 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v14];
      if (!v17)
      {
        v19 = 0;
        v20 = 0;
        goto LABEL_60;
      }

      v47 = [(UICollectionView *)self _useIdleObserverForCellPrefetching];
      if (v47)
      {
        v18 = [(UICollectionView *)self _updatePrefetchItemIfNeeded:v17 forIndexPath:v14 withLayoutAttributes:0 willDisplay:1];
      }

      else
      {
        v28 = v17[2];
        v18 = [v28 isEqual:v13];
      }

      v29 = v17[3];
      [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:v14];
      if (v18)
      {
        v19 = v29;
        if (v19)
        {
          v42 = v10;
          CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &_createVisibleViewsForSingleCategoryAttributes_limitCreation_fadeForBoundsChange____s_category);
          v31 = *(CategoryCachedImpl + 8);
          v32 = *(CategoryCachedImpl + 8);
          v33 = v31;
          v7 = v44;
          if (os_signpost_id_make_with_pointer(v32, self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v33))
          {
            v7 = v44;
            [v50 section];
            [v50 item];
            _os_signpost_emit_unreliably_with_name_impl();
          }

          if ([v19 _isHiddenForReuse])
          {
            [v19 _setHiddenForReuse:0];
          }

          v10 = v42;
          if (!v47)
          {
            [(UICollectionView *)self _configureCachedCellForDisplay:v19 withIndexPath:v50 layoutAttributesToUpdate:0];
          }

          [(UICollectionView *)self _notifyWillDisplayCellIfNeeded:v19 forIndexPath:v50];
          v20 = 1;
          goto LABEL_59;
        }
      }

      else
      {
        if (v29)
        {
          [(UICollectionView *)self _reusePrefetchedCell:v29];
        }

        v19 = 0;
      }

      v20 = 0;
      v7 = v44;
LABEL_59:

      v12 = v46;
LABEL_60:

      retstr = v43;
      if (v13)
      {
LABEL_20:
        v21 = *(v13 + 8);
        goto LABEL_21;
      }

LABEL_61:
      v21 = 0;
LABEL_21:
      v48 = v21;
      if (v6)
      {
        if (v49)
        {
          v22 = [(UICollectionViewLayout *)self->_layout initialLayoutAttributesForAppearingItemAtIndexPath:v50];
          if (!v22)
          {
LABEL_38:
            v22 = [v13 copy];
            [v22 setAlpha:0.0];
          }

LABEL_39:
          if (![v22 isHidden] || (objc_msgSend(v13, "isHidden") & 1) == 0)
          {
            if (!v19)
            {
              if (v49)
              {
                v27 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v50 withLayoutAttributes:v22 applyAttributes:1];
              }

              else
              {
                v27 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v48 atIndexPath:v50 layout:self->_layout withLayoutAttributes:v22 applyAttributes:1];
              }

              v19 = v27;
            }

            [(UICollectionView *)self _animateVisibleView:v19 withLayoutAttributes:v13 completionHandler:0];
          }

          v12 = v46;
          goto LABEL_66;
        }

        if (v13)
        {
          layout = self->_layout;
          if ((*(v13 + 288) & 3) != 0)
          {
            goto LABEL_34;
          }

          v26 = [UICollectionViewLayout initialLayoutAttributesForAppearingSupplementaryElementOfKind:"initialLayoutAttributesForAppearingSupplementaryElementOfKind:atIndexPath:" atIndexPath:?];
        }

        else
        {
          layout = self->_layout;
LABEL_34:
          v26 = [UICollectionViewLayout initialLayoutAttributesForAppearingDecorationElementOfKind:"initialLayoutAttributesForAppearingDecorationElementOfKind:atIndexPath:" atIndexPath:?];
        }

        v22 = v26;
        if (!v26)
        {
          goto LABEL_38;
        }

        goto LABEL_39;
      }

      if (v19)
      {
        v23 = 0;
      }

      else
      {
        v23 = v16;
      }

      if (v23 == 1)
      {
        if ([(UICollectionView *)self _isReorderingItemAtIndexPath:v50 includingDragAndDrop:0])
        {
          goto LABEL_84;
        }

        v24 = (v49 & 1) != 0 ? [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v50 withLayoutAttributes:v13 applyAttributes:1]: [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v48 atIndexPath:v50 layout:self->_layout withLayoutAttributes:v13 applyAttributes:1];
        v19 = v24;
        if (!v24)
        {
          goto LABEL_84;
        }

LABEL_67:
        if (v20)
        {
          ++retstr->var2;
          if ((v49 & 1) == 0)
          {
            goto LABEL_69;
          }

LABEL_78:
          [(_UICollectionViewSubviewManager *)v12 setVisibleCell:v19 atIndexPath:v50];
          if (!v12)
          {
LABEL_83:

            goto LABEL_84;
          }
        }

        else
        {
          v34 = [(_UICollectionViewPrefetchingContext *)&self->_mainPrefetchingContext->super.isa peekNextItem];
          v35 = v34;
          if (v34 && (v36 = v10, v37 = *(v34 + 16), [v37 indexPath], v38 = objc_claimAutoreleasedReturnValue(), v39 = objc_msgSend(v38, "isEqual:", v50), v38, v37, v10 = v36, retstr = v43, v39))
          {
            v40 = [(_UICollectionViewPrefetchingContext *)self->_mainPrefetchingContext popNextItem];
          }

          else
          {
            ++retstr->var1;
          }

          ++retstr->var0;

          v7 = v44;
          v12 = v46;
          if (v49)
          {
            goto LABEL_78;
          }

LABEL_69:
          if (v13 && (*(v13 + 288) & 3) == 0)
          {
            if (!v12)
            {
              goto LABEL_83;
            }

            [(_UICollectionViewSubviewCollection *)v12->_visibleViews setView:v19 forSupplementaryOfKind:v48 atIndexPath:v50];
          }

          else
          {
            if (!v12)
            {
              goto LABEL_83;
            }

            [(_UICollectionViewSubviewCollection *)v12->_visibleViews setView:v19 forDecorationOfKind:v48 atIndexPath:v50];
          }
        }

        [(NSHashTable *)v12->_viewsPreparingForDisplay addObject:v19];
        goto LABEL_83;
      }

LABEL_66:
      if (v19)
      {
        goto LABEL_67;
      }

LABEL_84:
    }

    while ([v10 count]);
  }

  return result;
}

- (unint64_t)_createVisibleViewsForAttributes:(id)a3 fadeForBoundsChange:(BOOL)a4 notifyLayoutForVisibleCellsPass:(BOOL)a5
{
  v5 = a5;
  v6 = a4;
  v28 = a3;
  if ([v28 count])
  {
    if (([(UICollectionViewLayout *)self->_layout _estimatesSizes]|| [(UICollectionViewLayout *)self->_layout _estimatesSupplementaryItems]) && dyld_program_sdk_at_least() && ((_UIInternalPreferenceUsesDefault(&_UIInternalPreference_CollectionViewLimitsCellsCreatedPerPass, @"CollectionViewLimitsCellsCreatedPerPass", _UIInternalPreferenceUpdateBool) & 1) != 0 || byte_1ED48AADC))
    {
      [(UICollectionView *)self _sortAttributesByDistanceToVisibleBoundsOrigin:v28];
      v24 = 1;
    }

    else
    {
      v24 = 0;
    }

    v8 = 0;
    v9 = 0;
    p_responderFlags = &self->super.super.super._responderFlags;
    v11 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    do
    {
      v25 = v9;
      if (v9 == 2)
      {
        v12 = 0;
      }

      else
      {
        v12 = v24;
      }

      v26 = _createVisibleViewsForAttributes_fadeForBoundsChange_notifyLayoutForVisibleCellsPass__categories[v9];
      v13 = [(UICollectionView *)self _layoutAttributes:v28 filteredForCategory:?];
      if ([v13 count])
      {
        v27 = v12;
        do
        {
          [(UICollectionView *)self _createVisibleViewsForSingleCategoryAttributes:v13 limitCreation:v12 fadeForBoundsChange:v6];
          v8 += v29;
          if ((v30 & 1) == 0)
          {
            break;
          }

          v14 = v11[168];
          v15 = *(p_responderFlags + v14);
          if ((v15 & 0x200) == 0)
          {
            v16 = v15 & 0xFFFFFFFFFFFFF9FFLL;
            *(p_responderFlags + v14) = v15 & 0xFFFFFFFFFFFFF9FFLL;
            if (v5)
            {
              [(UIScrollView *)self contentOffset];
              [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:v17 - self->_lastLayoutOffset.x, v18 - self->_lastLayoutOffset.y];
              v12 = v27;
              [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
              v16 = *(p_responderFlags + v14);
            }

            v15 = v16 | v15 & 0x400;
            *(p_responderFlags + v14) = v15;
            if ((v16 & 0x400) != 0)
            {
              [(UICollectionView *)self _updatedNewlyAppearingLayoutAttributesForCurrentVisibleBounds:v6];
              v19 = v6;
              v21 = v20 = v5;

              v22 = [(UICollectionView *)self _layoutAttributes:v21 filteredForCategory:v26];

              v15 = *(p_responderFlags + v14);
              v13 = v22;
              v28 = v21;
              v5 = v20;
              v6 = v19;
              v12 = v27;
            }

            v11 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
          }
        }

        while ((v15 & 0x200) == 0);
      }

      v9 = v25 + 1;
    }

    while (v25 != 2);
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (void)_updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange:(BOOL)a3
{
  v3 = a3;
  v4 = self;
  v67 = *MEMORY[0x1E69E9840];
  v49 = [(UICollectionViewLayout *)self->_layout _hasOrthogonalScrollingSections];
  v46 = v4->_subviewManager;
  [(_UICollectionViewSubviewManager *)v46 allVisibleViews];
  v61 = 0u;
  v62 = 0u;
  v63 = 0u;
  obj = v64 = 0u;
  v48 = [obj countByEnumeratingWithState:&v61 objects:v66 count:16];
  if (v48)
  {
    v47 = *v62;
    v44 = v4;
    do
    {
      v5 = 0;
      do
      {
        if (*v62 != v47)
        {
          objc_enumerationMutation(obj);
        }

        v6 = *(*(&v61 + 1) + 8 * v5);
        v7 = [v6 _layoutAttributes];
        v8 = [(UICollectionViewLayoutAttributes *)v7 __indexPath];
        v9 = [(_UILabelConfiguration *)v7 _content];
        if (v7)
        {
          v10 = *(v7 + 288);
          v11 = 1;
          if ((v10 & 2) != 0)
          {
            v11 = 2;
          }

          if (v10)
          {
            v12 = 0;
          }

          else
          {
            v12 = v11;
          }
        }

        else
        {
          v12 = 0;
        }

        v13 = [v8 section];
        v14 = v13 < -[UICollectionViewData numberOfSections](v4->_collectionViewData) || [v8 item] == 0x7FFFFFFFFFFFFFFFLL;
        v51 = v9;
        if (v12 == 2)
        {
          if (!v14)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              v16 = [MEMORY[0x1E696AAA8] currentHandler];
              [v16 handleFailureInMethod:a2 object:v4 file:@"UICollectionView.m" lineNumber:6213 description:{@"UICollectionView internal inconsistency: attempting to update attributes for a decoration view with an invalid section index. View: %@; view attributes: %@; collection view: %@; number of sections: %ld", v6, v7, v4, -[UICollectionViewData numberOfSections](v4->_collectionViewData)}];
              goto LABEL_66;
            }

            goto LABEL_33;
          }

          v15 = [(UICollectionViewData *)v4->_collectionViewData layoutAttributesForDecorationViewOfKind:v9 atIndexPath:v8];
          if (!v15)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              v16 = [MEMORY[0x1E696AAA8] currentHandler];
              v17 = [(UICollectionViewLayout *)v4->_layout layoutAttributesForDecorationViewOfKind:v9 atIndexPath:v8];
              [(UICollectionViewData *)v4->_collectionViewData dataSourceCountsDescription];
              v19 = v18 = v3;
              [v16 handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6209 description:{@"UICollectionView internal inconsistency: missing final attributes for decoration %@; initial attributes: %@; layout query: %@; collection view: %@; data source counts: %@", v6, v7, v17, v44, v19}];
              goto LABEL_65;
            }

            goto LABEL_33;
          }
        }

        else if (v12 == 1)
        {
          if (!v14)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              v16 = [MEMORY[0x1E696AAA8] currentHandler];
              [v16 handleFailureInMethod:a2 object:v4 file:@"UICollectionView.m" lineNumber:6202 description:{@"UICollectionView internal inconsistency: attempting to update attributes for a supplementary view with an invalid section index. View: %@; view attributes: %@; collection view: %@; number of sections: %ld", v6, v7, v4, -[UICollectionViewData numberOfSections](v4->_collectionViewData)}];
              goto LABEL_66;
            }

LABEL_33:
            v20 = v7;
            v50 = 1;
            goto LABEL_34;
          }

          v15 = [(UICollectionViewData *)v4->_collectionViewData layoutAttributesForSupplementaryElementOfKind:v9 atIndexPath:v8];
          if (!v15)
          {
            if (([v6 _isInUpdateAnimation] & 1) == 0)
            {
              v16 = [MEMORY[0x1E696AAA8] currentHandler];
              v17 = [(UICollectionViewLayout *)v4->_layout layoutAttributesForSupplementaryViewOfKind:v9 atIndexPath:v8];
              [(UICollectionViewData *)v4->_collectionViewData dataSourceCountsDescription];
              v19 = v18 = v3;
              [v16 handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6198 description:{@"UICollectionView internal inconsistency: missing final attributes for supplementary %@; initial attributes: %@; layout query: %@; collection view: %@;  data source counts: %@", v6, v7, v17, v44, v19}];
              goto LABEL_65;
            }

            goto LABEL_33;
          }
        }

        else
        {
          v15 = [(UICollectionViewData *)v4->_collectionViewData layoutAttributesForItemAtIndexPath:v8];
          if (!v15)
          {
            if ([v6 _isInUpdateAnimation])
            {
              goto LABEL_33;
            }

            v16 = [MEMORY[0x1E696AAA8] currentHandler];
            v17 = [(UICollectionViewLayout *)v4->_layout layoutAttributesForItemAtIndexPath:v8];
            [(UICollectionViewData *)v4->_collectionViewData dataSourceCountsDescription];
            v19 = v18 = v3;
            [v16 handleFailureInMethod:a2 object:v44 file:@"UICollectionView.m" lineNumber:6192 description:{@"UICollectionView internal inconsistency: missing final attributes for cell %@; initial attributes: %@; layout query: %@; collection view: %@; data source counts: %@", v6, v7, v17, v44, v19}];
LABEL_65:

            v3 = v18;
            v4 = v44;

LABEL_66:
            goto LABEL_33;
          }
        }

        v20 = v15;
        v50 = 0;
LABEL_34:
        if ([v8 length] >= 2)
        {
          v21 = v4;
          v22 = v3;
          v23 = [v6 superview];
          v24 = [(UICollectionView *)v21 _subviewRouterForView:v6 attributes:v20 createIfNecessary:0];
          v25 = v24;
          v26 = v24 ? *(v24 + 40) : 0;
          v27 = v26;

          v28 = v23 == v27;
          v3 = v22;
          v4 = v44;
          if (!v28)
          {
            v29 = 1;
            v30 = v51;
LABEL_41:
            -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](v4, "_addControlledSubview:atZIndex:forced:initialAttributes:", v6, [v20 zIndex], v49 | v29, 0);
            goto LABEL_42;
          }
        }

        v31 = [v20 zIndex];
        v32 = [v6 _layoutAttributes];
        LOBYTE(v31) = v31 != [v32 zIndex] || v49;

        v30 = v51;
        if (v31)
        {
          v29 = 0;
          goto LABEL_41;
        }

LABEL_42:
        if (v3 && ![(UICollectionView *)v4 _viewIsReorderedCell:v6])
        {
          layout = v4->_layout;
          v59[4] = v4;
          v60[0] = MEMORY[0x1E69E9820];
          v60[1] = 3221225472;
          v60[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke;
          v60[3] = &unk_1E70F3590;
          v60[4] = v4;
          v59[0] = MEMORY[0x1E69E9820];
          v59[1] = 3221225472;
          v59[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke_2;
          v59[3] = &unk_1E70F5AC0;
          LOBYTE(v42) = 0;
          v36 = [(UICollectionView *)v4 _viewAnimationsForView:v6 startingLayoutAttributes:v7 endingLayoutAttributes:v20 startingLayout:layout endingLayout:layout animationSetup:v60 animationCompletion:v59 enableCustomAnimations:v42 customAnimationsType:0];
          v55 = 0u;
          v56 = 0u;
          v57 = 0u;
          v58 = 0u;
          v37 = [v36 countByEnumeratingWithState:&v55 objects:v65 count:16];
          if (v37)
          {
            v38 = v37;
            v39 = *v56;
            do
            {
              for (i = 0; i != v38; ++i)
              {
                if (*v56 != v39)
                {
                  objc_enumerationMutation(v36);
                }

                [*(*(&v55 + 1) + 8 * i) start];
              }

              v38 = [v36 countByEnumeratingWithState:&v55 objects:v65 count:16];
            }

            while (v38);
          }

          v30 = v51;
          goto LABEL_59;
        }

        if (![v20 isHidden])
        {
          if (v46)
          {
            v34 = [(NSHashTable *)v46->_viewsPreparingForDisplay containsObject:v6];
          }

          else
          {
            v34 = 0;
          }

          v52[0] = MEMORY[0x1E69E9820];
          v52[1] = 3221225472;
          v52[2] = __88__UICollectionView__updateLayoutAttributesForExistingVisibleViewsFadingForBoundsChange___block_invoke_3;
          v52[3] = &unk_1E70F6228;
          v52[4] = v4;
          v53 = v20;
          v54 = v6;
          [UIView _conditionallyPerformWithoutAnimation:v34 layout:v52];

LABEL_59:
          v33 = v50;
          goto LABEL_60;
        }

        v33 = v50;
        if (v46)
        {
          [(_UICollectionViewSubviewCollection *)&v46->_visibleViews->super.isa removeViewOfKind:v30 inCategory:v12 atIndexPath:v8];
          if ([v6 _isInUpdateAnimation])
          {
            [(_UICollectionViewSubviewCollection *)v46->_visibleViews setView:v6 ofKind:v30 inCategory:v12 atIndexPath:v8];
            goto LABEL_60;
          }
        }

        else if ([v6 _isInUpdateAnimation])
        {
          goto LABEL_60;
        }

        if (v12)
        {
          [(UICollectionView *)v4 _reuseSupplementaryView:v6];
        }

        else if (dyld_program_sdk_at_least())
        {
          [(UICollectionView *)v4 _cacheOrReuseCell:v6 forIndexPath:v8 invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];
        }

        else
        {
          [(UICollectionView *)v4 _reuseCell:v6 notifyDidEndDisplaying:1];
        }

LABEL_60:
        if ((v33 & 1) == 0)
        {
          [(UICollectionView *)v4 _checkForPreferredAttributesInView:v6 originalAttributes:v20];
        }

        ++v5;
      }

      while (v5 != v48);
      v41 = [obj countByEnumeratingWithState:&v61 objects:v66 count:16];
      v48 = v41;
    }

    while (v41);
  }

  [(_UICollectionViewOrthogonalScrollerSectionController *)v4->_orthogonalScrollerController processQueuedScrollViewRemovals];
  [(UICollectionView *)v4 _processQueuedSectionContainerRemovals];
}

- (void)_prepareClonedViewsForTransitionLayout
{
  v2 = self;
  v51 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  if (collectionViewData)
  {
    collectionViewData = collectionViewData->_clonedCellAttributes;
  }

  v4 = collectionViewData;
  v5 = v4;
  v6 = MEMORY[0x1E695E0F0];
  if (v4)
  {
    v7 = v4;
  }

  else
  {
    v7 = MEMORY[0x1E695E0F0];
  }

  v8 = v7;

  v9 = v2->_collectionViewData;
  if (v9)
  {
    v9 = v9->_clonedSupplementaryAttributes;
  }

  v10 = v9;
  v11 = v10;
  if (v10)
  {
    v12 = v10;
  }

  else
  {
    v12 = v6;
  }

  v13 = v12;

  v14 = v2->_collectionViewData;
  if (v14)
  {
    v14 = v14->_clonedDecorationAttributes;
  }

  v15 = v14;
  v16 = v15;
  if (v15)
  {
    v17 = v15;
  }

  else
  {
    v17 = v6;
  }

  v18 = v17;

  if (!v2->_clonedCellsDict)
  {
    v19 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:{-[UICollectionViewData count](v8, "count")}];
    clonedCellsDict = v2->_clonedCellsDict;
    v2->_clonedCellsDict = v19;

    v21 = objc_alloc_init(MEMORY[0x1E695DF90]);
    clonedSupplementaryViewsDict = v2->_clonedSupplementaryViewsDict;
    v2->_clonedSupplementaryViewsDict = v21;

    v23 = objc_alloc_init(MEMORY[0x1E695DF90]);
    clonedDecorationViewsDict = v2->_clonedDecorationViewsDict;
    v2->_clonedDecorationViewsDict = v23;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke;
  aBlock[3] = &unk_1E70FF1B8;
  aBlock[4] = v2;
  v25 = _Block_copy(aBlock);
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v42 = v13;
  v43 = v8;
  v26 = [(UICollectionViewData *)v8 arrayByAddingObjectsFromArray:v13];
  v41 = v18;
  v27 = [v26 arrayByAddingObjectsFromArray:v18];

  obj = v27;
  v28 = [v27 countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v46;
    do
    {
      v31 = 0;
      do
      {
        if (*v46 != v30)
        {
          objc_enumerationMutation(obj);
        }

        v32 = *(*(&v45 + 1) + 8 * v31);
        if (v32)
        {
          v33 = *(v32 + 288);
          if (v33)
          {
            v25[2](v25, v2->_clonedCellsDict, *(*(&v45 + 1) + 8 * v31));
            goto LABEL_32;
          }

          if ((v33 & 2) != 0)
          {
            v34 = &OBJC_IVAR___UICollectionView__clonedDecorationViewsDict;
          }

          else
          {
            v34 = &OBJC_IVAR___UICollectionView__clonedSupplementaryViewsDict;
          }
        }

        else
        {
          v34 = &OBJC_IVAR___UICollectionView__clonedDecorationViewsDict;
        }

        v35 = v2;
        v36 = *(&v2->super.super.super.super.isa + *v34);
        v37 = [(_UILabelConfiguration *)v32 _content];
        v38 = [v36 objectForKeyedSubscript:v37];

        if (!v38)
        {
          v38 = [MEMORY[0x1E695DF90] dictionary];
          v39 = [(_UILabelConfiguration *)v32 _content];
          [v36 setObject:v38 forKeyedSubscript:v39];
        }

        v25[2](v25, v38, v32);

        v2 = v35;
LABEL_32:
        ++v31;
      }

      while (v29 != v31);
      v40 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
      v29 = v40;
    }

    while (v40);
  }
}

void __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke(uint64_t a1, void *a2, void *a3)
{
  v5 = a2;
  v6 = a3;
  v7 = [(UICollectionViewLayoutAttributes *)v6 __indexPath];
  v8 = [v5 objectForKeyedSubscript:v7];
  if (!v8)
  {
    v10 = [UICollectionReusableView alloc];
    v11 = *MEMORY[0x1E695EFF8];
    v12 = *(MEMORY[0x1E695EFF8] + 8);
    [v6 size];
    v15 = [(UICollectionReusableView *)v10 initWithFrame:v11, v12, v13, v14];
    [(UIView *)v15 setAutoresizingMask:0];
    [(UICollectionReusableView *)v15 setTranslatesAutoresizingMaskIntoConstraints:1];
    [(UIView *)v15 _setHostsLayoutEngine:1];
    [(UICollectionReusableView *)v15 _markAsDequeued];
    [v5 setObject:v15 forKeyedSubscript:v7];
    [*(a1 + 32) _applyLayoutAttributes:v6 toView:v15];
    v16 = [v5 objectForKeyedSubscript:v7];
    *(*(a1 + 32) + 2728) |= 0x100000000uLL;
    v17 = [v16 snapshotViewAfterScreenUpdates:0];
    [v16 bounds];
    [v17 setBounds:?];
    [v17 setAutoresizingMask:18];
    [(UIView *)v15 addSubview:v17];
    *(*(a1 + 32) + 2728) &= ~0x100000000uLL;
    v18 = *(*(a1 + 32) + 2152);
    v19 = v15;
    v20 = v19;
    if (!v19 || !v18)
    {
      goto LABEL_10;
    }

    v21 = [(UIView *)v19 effectiveUserInterfaceLayoutDirection];
    if (v21 == [v18 developmentLayoutDirection])
    {
      if (![(UIView *)v20 _flipsHorizontalAxis])
      {
LABEL_10:

        v25[0] = MEMORY[0x1E69E9820];
        v25[1] = 3221225472;
        v25[2] = __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke_2;
        v25[3] = &unk_1E70F6B40;
        v23 = *(a1 + 32);
        v26 = v16;
        v27 = v23;
        v9 = v20;
        v28 = v9;
        v29 = v6;
        v24 = v16;
        [UIView performWithoutAnimation:v25];

        goto LABEL_11;
      }

      v22 = 0;
    }

    else
    {
      v22 = [v18 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v20 _setFlipsHorizontalAxis:v22];
    goto LABEL_10;
  }

  v9 = v8;
  [*(a1 + 32) _applyLayoutAttributes:v6 toView:v8];
LABEL_11:
}

uint64_t __58__UICollectionView__prepareClonedViewsForTransitionLayout__block_invoke_2(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 48);
  if (*(a1 + 32))
  {
    v3 = *(a1 + 40);

    return [v3 insertSubview:v2 belowSubview:?];
  }

  else
  {
    v5 = [*(a1 + 56) zIndex];

    return [v1 _addControlledSubview:v2 atZIndex:v5 forced:0 initialAttributes:0];
  }
}

- (void)_updateFocusAfterLoadingVisibleCellsIfNeeded:(id)a3
{
  v4 = a3;
  v5 = v4;
  v6 = *(&self->_collectionViewFlags + 1);
  if ((v6 & 0x80000000000) != 0)
  {
    *(&self->_collectionViewFlags + 1) = v6 & 0xFFFFF7FFFFFFFFFFLL;
    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = __65__UICollectionView__updateFocusAfterLoadingVisibleCellsIfNeeded___block_invoke;
    v7[3] = &unk_1E70F35B8;
    v7[4] = self;
    v8 = v4;
    [UIView performWithoutAnimation:v7];
  }
}

void __65__UICollectionView__updateFocusAfterLoadingVisibleCellsIfNeeded___block_invoke(uint64_t a1)
{
  v2 = [(_UICollectionViewFocusedItemState *)*(a1 + 40) copyWithReusableView:?];
  [*(a1 + 32) _setFocusedItemState:v2];

  v4 = [[_UIFocusUpdateRequest alloc] initWithEnvironment:*(a1 + 32)];
  [(_UIFocusUpdateRequest *)v4 setAllowsFocusingCurrentItem:1];
  [(_UIFocusUpdateRequest *)v4 setScrollIfNecessary:(*(*(a1 + 32) + 2728) >> 44) & 1];
  v3 = [*(a1 + 32) _focusSystem];
  [v3 _requestFocusUpdate:v4];
  [v3 updateFocusIfNeeded];
}

uint64_t __78__UICollectionView__setUpCompletionHandlerForAnimationInterruptionIfNecessary__block_invoke(uint64_t result, char a2)
{
  if ((a2 & 1) == 0)
  {
    return [*(result + 32) _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  }

  return result;
}

- (void)_ensureViewsAreLoadedInRect:(CGRect)a3
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  *(&self->_collectionViewFlags + 1) |= 0x800000000uLL;
  self->_visibleBounds = a3;
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:0];
  [(UIView *)self layoutBelowIfNeeded];
  *(p_collectionViewFlags + 1) &= ~0x800000000uLL;
}

- (UIEdgeInsets)_visibleRectEdgeInsets
{
  top = self->_visibleRectInsets.top;
  left = self->_visibleRectInsets.left;
  bottom = self->_visibleRectInsets.bottom;
  right = self->_visibleRectInsets.right;
  result.right = right;
  result.bottom = bottom;
  result.left = left;
  result.top = top;
  return result;
}

- (void)_setAllowsVisibleCellUpdatesDuringUpdateAnimations:(BOOL)a3
{
  v3 = 0x800000000000000;
  if (!a3)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xF7FFFFFFFFFFFFFFLL | v3;
}

- (void)_setAllowsVisibleViewUpdatesDuringLayoutTransitions:(BOOL)a3
{
  v3 = 0x1000000000000000;
  if (!a3)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xEFFFFFFFFFFFFFFFLL | v3;
}

- (id)_viewAnimationsForView:(id)a3 startingLayoutAttributes:(id)a4 endingLayoutAttributes:(id)a5 startingLayout:(id)a6 endingLayout:(id)a7 animationSetup:(id)a8 animationCompletion:(id)a9 enableCustomAnimations:(BOOL)a10 customAnimationsType:(unint64_t)a11
{
  v58 = a3;
  v17 = a4;
  v18 = a5;
  v19 = a6;
  v59 = a7;
  v20 = a8;
  v21 = a9;
  v55 = [(UICollectionView *)self _isReordering];
  if (v18)
  {
    if (v18[72])
    {
      v22 = 1;
    }

    else
    {
      v22 = 2;
    }
  }

  else
  {
    v22 = 2;
  }

  v66[0] = MEMORY[0x1E69E9820];
  v66[1] = 3221225472;
  v67 = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke;
  v68 = &unk_1E70FF208;
  v69 = self;
  v23 = v17;
  v75 = a10;
  v70 = v23;
  v73 = a11;
  v24 = v20;
  v71 = v24;
  v25 = v21;
  v72 = v25;
  v74 = v22;
  v26 = [v19 _isInLayoutTransition];
  v27 = [v19 _disablesDoubleSidedAnimations];
  if (!v26 || (v27 & 1) != 0 || [(UICollectionViewLayoutAttributes *)v23 _isEquivalentTo:v18])
  {
    v29 = v58;
    v28 = v59;
    v30 = v67(v66, v58, v59, v18, 0, 1);
    v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v30];
    goto LABEL_42;
  }

  if (v23)
  {
    v32 = v23[72];
    if (v32)
    {
      v38 = [v23 indexPath];
      v30 = [v19 finalLayoutAttributesForDisappearingItemAtIndexPath:v38];

      v34 = [v18 indexPath];
      v37 = v59;
      v57 = [v59 initialLayoutAttributesForAppearingItemAtIndexPath:v34];
      goto LABEL_17;
    }

    v33 = (v32 >> 1) & 1;
  }

  else
  {
    v33 = 0;
  }

  v54 = v24;
  v34 = [(_UILabelConfiguration *)v23 _content];
  v35 = [v23 indexPath];
  if (v33)
  {
    v30 = [v19 finalLayoutAttributesForDisappearingDecorationElementOfKind:v34 atIndexPath:v35];

    v36 = [v18 indexPath];
    v37 = v59;
    v57 = [v59 initialLayoutAttributesForAppearingDecorationElementOfKind:v34 atIndexPath:v36];
  }

  else
  {
    v30 = [v19 finalLayoutAttributesForDisappearingSupplementaryElementOfKind:v34 atIndexPath:v35];

    v39 = [v18 indexPath];
    v57 = [v59 initialLayoutAttributesForAppearingSupplementaryElementOfKind:v34 atIndexPath:v39];

    v37 = v59;
  }

  v24 = v54;
LABEL_17:

  v29 = v58;
  if (!v30)
  {
    if (v18 && [(UICollectionViewLayoutAttributes *)v57 _isEquivalentTo:v23])
    {
      v30 = v18;
    }

    else
    {
      v30 = [v23 copy];
      [v30 setAlpha:0.0];
    }
  }

  if (!v57)
  {
    if (v23 && [(UICollectionViewLayoutAttributes *)v30 _isEquivalentTo:v18])
    {
      v57 = v23;
    }

    else
    {
      v57 = [v18 copy];
      [v57 setAlpha:0.0];
    }
  }

  if ([(UICollectionViewLayoutAttributes *)v30 _isEquivalentTo:v18]&& [(UICollectionViewLayoutAttributes *)v57 _isEquivalentTo:v23])
  {
    v40 = v67;
    v41 = v58;
    v42 = v37;
    goto LABEL_38;
  }

  v43 = [(UICollectionViewLayoutAttributes *)v23 _isTransitionVisibleTo:v30];
  v44 = [(UICollectionViewLayoutAttributes *)v57 _isTransitionVisibleTo:v18];
  if (!v43 || !v44)
  {
    if (v43)
    {
      v49 = [v18 indexPath];
      [v30 setIndexPath:v49];

      v67(v66, v58, v19, v30, 0, 1);
      v52 = LABEL_39:;
      v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v52];

      goto LABEL_40;
    }

    if (v44)
    {
      v60[0] = MEMORY[0x1E69E9820];
      v60[1] = 3221225472;
      v60[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_8;
      v60[3] = &unk_1E70F6228;
      v60[4] = self;
      v61 = v57;
      v50 = v58;
      v62 = v50;
      [UIView performWithoutAnimation:v60];
      v51 = v67(v66, v50, v59, v18, 0, 1);
      v31 = [MEMORY[0x1E695DEC8] arrayWithObject:v51];

LABEL_40:
      v48 = v57;
      goto LABEL_41;
    }

    v40 = v67;
    v41 = v58;
    v42 = v59;
LABEL_38:
    v40(v66, v41, v42, v18, 0, 1);
    goto LABEL_39;
  }

  v45 = [v18 indexPath];
  [v30 setIndexPath:v45];

  v56 = v67(v66, v58, v19, v30, !v55, 0);
  v63[0] = MEMORY[0x1E69E9820];
  v63[1] = 3221225472;
  v63[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_7;
  v63[3] = &unk_1E70F6228;
  v63[4] = self;
  v64 = v57;
  v46 = v58;
  v65 = v46;
  [UIView performWithoutAnimation:v63];
  v47 = v67(v66, v46, v59, v18, 0, 0);
  v31 = [MEMORY[0x1E695DEC8] arrayWithObjects:{v56, v47, 0}];

  v48 = v57;
  v29 = v58;
LABEL_41:

  v28 = v59;
LABEL_42:

  return v31;
}

UICollectionViewAnimation *__198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke(uint64_t a1, void *a2, void *a3, void *a4, int a5, uint64_t a6)
{
  v11 = a2;
  v12 = a3;
  v13 = a4;
  if (a5)
  {
    *(*(a1 + 32) + 2728) |= 0x100000000uLL;
    v14 = [_UICollectionSnapshotView alloc];
    [*(a1 + 40) frame];
    v15 = [(UICollectionReusableView *)v14 initWithFrame:?];
    v15->_snapshottedViewDisablesRasterizationInAnimations = [v11 _disableRasterizeInAnimations];
    [(UIView *)v15 setAutoresizingMask:0];
    [(UICollectionReusableView *)v15 setTranslatesAutoresizingMaskIntoConstraints:1];
    [(UIView *)v15 _setHostsLayoutEngine:1];
    [(UICollectionReusableView *)v15 _markAsDequeued];
    v16 = [v11 snapshotViewAfterScreenUpdates:0];
    [(UIView *)v15 bounds];
    [v16 setBounds:?];
    [v16 setAutoresizingMask:18];
    [(UIView *)v15 addSubview:v16];
    *(*(a1 + 32) + 2728) &= ~0x100000000uLL;
    if ([v11 isHidden])
    {
      [(UIView *)v15 setHidden:1];
    }

    v44[0] = MEMORY[0x1E69E9820];
    v44[1] = 3221225472;
    v44[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_2;
    v44[3] = &unk_1E70F6228;
    v44[4] = *(a1 + 32);
    v17 = v15;
    v45 = v17;
    v46 = v11;
    [UIView performWithoutAnimation:v44];
    v40[0] = MEMORY[0x1E69E9820];
    v40[1] = 3221225472;
    v40[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_3;
    v40[3] = &unk_1E70F6228;
    v18 = v17;
    v41 = v18;
    v19 = *(a1 + 40);
    v20 = *(a1 + 32);
    v42 = v19;
    v43 = v20;
    [UIView performWithoutAnimation:v40];
    if (*(a1 + 80) == 1)
    {
      v21 = [v12 _animationForReusableView:v18 toLayoutAttributes:v13 type:*(a1 + 64)];
    }

    else
    {
      v21 = 0;
    }

    v22 = [[UICollectionViewAnimation alloc] initWithView:v18 viewType:0 finalLayoutAttributes:v13 startFraction:0 endFraction:0 animateFromCurrentPostion:v21 deleteAfterAnimation:0.0 customAnimations:1.0];
    [(UICollectionViewAnimation *)v22 addStartupHandler:*(a1 + 48)];
    v37[0] = MEMORY[0x1E69E9820];
    v37[1] = 3221225472;
    v37[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_4;
    v37[3] = &unk_1E70FE248;
    v38 = v18;
    v39 = *(a1 + 56);
    v23 = v18;
    [(UICollectionViewAnimation *)v22 addCompletionHandler:v37];
  }

  else
  {
    if (*(a1 + 80) == 1)
    {
      v16 = [v12 _animationForReusableView:v11 toLayoutAttributes:v13 type:*(a1 + 64)];
    }

    else
    {
      v16 = 0;
    }

    if ([*(a1 + 32) _viewIsReorderedCell:v11])
    {
      [v11 bounds];
      v25 = v24;
      v27 = v26;
      [v13 size];
      v29 = v25 != v28;
      if (v27 != v30)
      {
        v29 = 1;
      }

      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_5;
      aBlock[3] = &unk_1E70FF1E0;
      v36 = v29;
      v34 = v11;
      v35 = v13;
      v31 = _Block_copy(aBlock);

      v16 = v31;
    }

    v22 = [[UICollectionViewAnimation alloc] initWithView:v11 viewType:*(a1 + 72) finalLayoutAttributes:v13 startFraction:a6 endFraction:0 animateFromCurrentPostion:v16 deleteAfterAnimation:0.0 customAnimations:1.0];
    [(UICollectionViewAnimation *)v22 addStartupHandler:*(a1 + 48)];
    [(UICollectionViewAnimation *)v22 addCompletionHandler:*(a1 + 56)];
  }

  return v22;
}

void __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_3(uint64_t a1)
{
  [*(a1 + 32) _setLayoutAttributes:*(a1 + 40)];
  v2 = *(*(a1 + 48) + 2152);
  v3 = *(a1 + 32);
  v8 = v2;
  v4 = v3;
  if (v8)
  {
    v5 = v4 == 0;
  }

  else
  {
    v5 = 1;
  }

  if (!v5)
  {
    v6 = [v4 effectiveUserInterfaceLayoutDirection];
    if (v6 == [v8 developmentLayoutDirection])
    {
      if (![v4 _flipsHorizontalAxis])
      {
        goto LABEL_10;
      }

      v7 = 0;
    }

    else
    {
      v7 = [v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [v4 _setFlipsHorizontalAxis:v7];
  }

LABEL_10:
}

uint64_t __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_4(uint64_t a1)
{
  [*(a1 + 32) removeFromSuperview];
  result = *(a1 + 40);
  if (result)
  {
    v3 = *(result + 16);

    return v3();
  }

  return result;
}

void __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_5(uint64_t a1, void *a2)
{
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_6;
  v5[3] = &unk_1E70F5AF0;
  v8 = *(a1 + 48);
  v6 = *(a1 + 32);
  v7 = *(a1 + 40);
  v4 = a2;
  [UIView performWithoutAnimation:v5];
  v4[2](v4, 1);
}

uint64_t __198__UICollectionView__viewAnimationsForView_startingLayoutAttributes_endingLayoutAttributes_startingLayout_endingLayout_animationSetup_animationCompletion_enableCustomAnimations_customAnimationsType___block_invoke_6(uint64_t a1)
{
  v2 = *(a1 + 48);
  v3 = *(a1 + 40);
  if (v2 == 1)
  {
    [v3 frame];
    v4 = *(a1 + 32);

    return [v4 setFrame:?];
  }

  else
  {
    [v3 center];
    v6 = *(a1 + 32);

    return [v6 setCenter:?];
  }
}

- (void)_setVisibleView:(id)a3 forLayoutAttributes:(id)a4
{
  v6 = a4;
  v14 = a3;
  if (v6)
  {
    v7 = *(v6 + 72);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }

    v10 = v6[1];
  }

  else
  {
    v9 = 0;
    v10 = 0;
  }

  subviewManager = self->_subviewManager;
  v12 = [(UICollectionViewLayoutAttributes *)v6 __indexPath];

  v13 = v14;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews setView:v14 ofKind:v10 inCategory:v9 atIndexPath:v12];
    v13 = v14;
  }
}

- (void)_applyBlockToAllReusableViews:(id)a3
{
  v32 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:10];
  subviewManager = self->_subviewManager;
  v29[0] = MEMORY[0x1E69E9820];
  v29[1] = 3221225472;
  v29[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke;
  v29[3] = &unk_1E70FFC98;
  v7 = v5;
  v30 = v7;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v29];
  }

  prefetchCacheItems = self->_prefetchCacheItems;
  v27[0] = MEMORY[0x1E69E9820];
  v27[1] = 3221225472;
  v27[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_2;
  v27[3] = &unk_1E70FEF90;
  v9 = v7;
  v28 = v9;
  [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v27];
  if (self->_firstResponderView)
  {
    [v9 addObject:?];
  }

  focusedItemState = self->_focusedItemState;
  if (focusedItemState)
  {
    focusedItemState = focusedItemState->_reusableView;
  }

  v11 = focusedItemState;

  if (v11)
  {
    v12 = self->_focusedItemState;
    if (v12)
    {
      v12 = v12->_reusableView;
    }

    v13 = v12;
    [v9 addObject:v13];
  }

  v14 = self->_subviewManager;
  v25[0] = MEMORY[0x1E69E9820];
  v25[1] = 3221225472;
  v25[2] = __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_3;
  v25[3] = &unk_1E70FF230;
  v15 = v9;
  v26 = v15;
  [(_UICollectionViewSubviewManager *)v14 enumerateAllViewsInReuseQueueWithEnumerator:v25];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v16 = v15;
  v17 = [v16 countByEnumeratingWithState:&v21 objects:v31 count:16];
  if (v17)
  {
    v18 = v17;
    v19 = *v22;
    do
    {
      for (i = 0; i != v18; ++i)
      {
        if (*v22 != v19)
        {
          objc_enumerationMutation(v16);
        }

        v4[2](v4, *(*(&v21 + 1) + 8 * i));
      }

      v18 = [v16 countByEnumeratingWithState:&v21 objects:v31 count:16];
    }

    while (v18);
  }
}

void __50__UICollectionView__applyBlockToAllReusableViews___block_invoke_2(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    v4 = *(a3 + 24);
    if (v4)
    {
      v5 = v4;
      [*(a1 + 32) addObject:v4];
      v4 = v5;
    }
  }

  else
  {
    v4 = 0;
  }
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)collectionViewLayout
{
  v5 = collectionViewLayout;
  v7 = v5;
  if (!v5)
  {
    v6 = [MEMORY[0x1E696AAA8] currentHandler];
    [v6 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6941 description:@"layout cannot be nil in setCollectionViewLayout:"];

    v5 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v5 animated:0 isInteractive:0 completion:0];
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated
{
  v4 = animated;
  v7 = layout;
  v9 = v7;
  if (!v7)
  {
    v8 = [MEMORY[0x1E696AAA8] currentHandler];
    [v8 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6947 description:@"layout cannot be nil in setCollectionViewLayout:animated:"];

    v7 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v7 animated:v4 isInteractive:0 completion:0];
}

- (void)setCollectionViewLayout:(UICollectionViewLayout *)layout animated:(BOOL)animated completion:(void *)completion
{
  v6 = animated;
  v13 = layout;
  v9 = completion;
  v10 = v13;
  v11 = v9;
  if (!v13)
  {
    v12 = [MEMORY[0x1E696AAA8] currentHandler];
    [v12 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6953 description:@"layout cannot be nil in setCollectionViewLayout:animated:completion:"];

    v10 = 0;
  }

  [(UICollectionView *)self _setCollectionViewLayout:v10 animated:v6 isInteractive:0 completion:v11];
}

- (void)_setCollectionViewLayout:(id)a3 animated:(BOOL)a4 isInteractive:(BOOL)a5 completion:(id)a6 animator:(id)a7
{
  v162 = a5;
  v166 = a4;
  v246 = *MEMORY[0x1E69E9840];
  v12 = a3;
  v169 = a6;
  v13 = a7;
  v177 = v12;
  if (self->_layout != v12)
  {
    v161 = v13;
    v14 = dyld_program_sdk_at_least();
    p_collectionViewFlags = &self->_collectionViewFlags;
    v15 = *(&self->_collectionViewFlags + 1);
    v178 = self;
    if (v14)
    {
      if ((v15 & 0x1000000000) != 0)
      {
        v16 = [MEMORY[0x1E696AAA8] currentHandler];
        [v16 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:6974 description:{@"Cannot set the layout [%@] for [%@] during an update.", v12, self}];
      }
    }

    else if ((v15 & 0x1000000000) != 0)
    {
      v150 = *(__UILogGetCategoryCachedImpl("Assert", &_setCollectionViewLayout_animated_isInteractive_completion_animator____s_category) + 8);
      if (os_log_type_enabled(v150, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        *&buf[4] = v12;
        *&buf[12] = 2112;
        *&buf[14] = self;
        _os_log_impl(&dword_188A29000, v150, OS_LOG_TYPE_ERROR, "Cannot set the layout [%@] for [%@] during an update.", buf, 0x16u);
      }
    }

    [(UICollectionView *)self _resetPrefetchState];
    v165 = [(UICollectionView *)self _focusedItemState];
    [(UICollectionView *)self _setFocusedItemState:0];
    v17 = v165;
    if (v165)
    {
      v17 = v165[1];
    }

    v18 = v17;
    [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v18];

    [(UIScrollView *)self _resetContentScrollableAxes];
    [(UICollectionViewLayout *)v12 _setCollectionView:self];
    if ([(UICollectionViewLayout *)v12 canBeEdited]&& [(UICollectionViewLayout *)v12 isEditing]!= (HIWORD(*(&self->_collectionViewFlags + 1)) & 1))
    {
      [(UICollectionViewLayout *)v12 setEditing:?];
    }

    v170 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    [v170 _setInvalidateEverything:1];
    [v170 _setInvalidateDataSourceCounts:1];
    [(UICollectionViewLayout *)v12 _invalidateLayoutUsingContext:v170];
    [(UICollectionView *)self _reloadDataIfNeeded];
    if ((*(&self->_collectionViewFlags + 11) & 0x40) != 0)
    {
      v149 = [MEMORY[0x1E696AAA8] currentHandler];
      [v149 handleFailureInMethod:a2 object:self file:? lineNumber:? description:?];
    }

    if (v166 || v162)
    {
      [(UIScrollView *)self stopScrollingAndZooming];
    }

    if ((*(&self->_collectionViewFlags + 12) & 4) == 0)
    {
      [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
      [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController cleanupSectionFocusGuides];
      [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
      [(UICollectionView *)self _reconfigureSectionContainersForUpdate:0];
      objc_storeStrong(&self->_layout, a3);
      [(UICollectionViewLayout *)self->_layout _setCollectionView:?];
      v19 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
      collectionViewData = self->_collectionViewData;
      self->_collectionViewData = v19;

      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
      v21 = self->_layout;
      v22 = self;
      if (!v21)
      {
LABEL_138:

        v13 = v161;
        goto LABEL_139;
      }

      v23 = v22;
      v24 = [(UIView *)v22 effectiveUserInterfaceLayoutDirection];
      if (v24 == [(UICollectionViewLayout *)v21 developmentLayoutDirection])
      {
        if (![(UIView *)v23 _flipsHorizontalAxis])
        {
LABEL_47:
          v22 = v23;
          goto LABEL_138;
        }

        v25 = 0;
      }

      else
      {
        v25 = [(UICollectionViewLayout *)v21 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [(UIScrollView *)v23 _setFlipsHorizontalAxis:v25];
      goto LABEL_47;
    }

    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) == 0)
    {
      [(UICollectionViewLayout *)self->_layout _prepareForTransitionToLayout:v12];
      [(UICollectionViewLayout *)v12 _prepareForTransitionFromLayout:self->_layout];
    }

    v167 = [[UICollectionViewData alloc] initWithCollectionView:v12 layout:?];
    [(UICollectionViewData *)v167 _prepareToLoadData];
    [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      [(UICollectionViewLayout *)v12 setTransitionProgress:0.0];
    }

    *(&self->_collectionViewFlags + 1) |= 0x20000000uLL;
    selectionController = self->_selectionController;
    if (selectionController)
    {
      v27 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
    }

    else
    {
      v27 = 0;
    }

    v156 = [v27 mutableCopy];

    v28 = MEMORY[0x1E695DFA8];
    v29 = [(UICollectionView *)self _indexPathsForVisibleItems];
    v164 = [v28 setWithArray:v29];

    if ([v164 intersectsSet:v156])
    {
      [v164 intersectSet:v156];
    }

    [(UICollectionView *)self _visibleBounds];
    x = v247.origin.x;
    y = v247.origin.y;
    width = v247.size.width;
    height = v247.size.height;
    MidX = CGRectGetMidX(v247);
    v248.origin.x = x;
    v248.origin.y = y;
    v248.size.width = width;
    v248.size.height = height;
    MidY = CGRectGetMidY(v248);
    v36 = [v164 count];
    if ((*(&self->_collectionViewFlags + 1) & 0x10) != 0)
    {
      v38 = [(UICollectionView *)self _delegateProxy];
      v172 = [v38 _indexPathOfReferenceItemForLayoutTransitionInCollectionView:self];

      v37 = v172 != 0;
      if (v172)
      {
        v39 = [(UICollectionViewData *)v167 layoutAttributesForItemAtIndexPath:v172];
        goto LABEL_52;
      }
    }

    else
    {
      v37 = 0;
    }

    if ([v164 count] == 1)
    {
      v172 = [v164 anyObject];
    }

    else
    {
      v236 = 0u;
      v237 = 0u;
      v234 = 0u;
      v235 = 0u;
      v40 = v164;
      v41 = [v40 countByEnumeratingWithState:&v234 objects:v245 count:16];
      if (v41)
      {
        v172 = 0;
        v42 = *v235;
        v43 = 3.40282347e38;
        do
        {
          for (i = 0; i != v41; ++i)
          {
            if (*v235 != v42)
            {
              objc_enumerationMutation(v40);
            }

            v45 = *(*(&v234 + 1) + 8 * i);
            v46 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v45];
            [v46 center];
            *&v47 = (v47 - MidX) * (v47 - MidX) + (v48 - MidY) * (v48 - MidY);
            v49 = sqrtf(*&v47);
            if (v43 > v49)
            {
              v50 = v45;

              v43 = v49;
              v172 = v50;
            }
          }

          v41 = [v40 countByEnumeratingWithState:&v234 objects:v245 count:16];
        }

        while (v41);
      }

      else
      {
        v172 = 0;
      }
    }

    if (!v172)
    {
      v172 = 0;
      goto LABEL_56;
    }

    v51 = [(UICollectionViewData *)v167 layoutAttributesForItemAtIndexPath:v172];
    v39 = v51;
    if (!v37)
    {
      [v51 center];
      x = v61 - width * 0.5;
      y = v62 - height * 0.5;
      goto LABEL_55;
    }

LABEL_52:
    [v39 frame];
    v53 = v52;
    v55 = v54;
    v56 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v172];
    [v56 frame];
    v58 = v57;
    [v56 frame];
    v60 = v59;

    x = v53 - (v58 - x);
    y = v55 - (v60 - y);
LABEL_55:

LABEL_56:
    [(UICollectionViewData *)v167 collectionViewContentRect];
    v157 = v249.size.height;
    v159 = v249.size.width;
    v249.origin.x = 0.0;
    v249.origin.y = 0.0;
    v253.origin.x = x;
    v253.origin.y = y;
    v253.size.width = width;
    v253.size.height = height;
    if (CGRectContainsRect(v249, v253))
    {
      v63 = x;
      v64 = self;
    }

    else
    {
      v250.origin.x = 0.0;
      v250.origin.y = 0.0;
      v250.size.height = v157;
      v250.size.width = v159;
      v254.origin.x = x;
      v254.origin.y = y;
      v254.size.width = width;
      v254.size.height = height;
      v251 = CGRectIntersection(v250, v254);
      v63 = 0.0;
      v64 = self;
      if (v159 > width)
      {
        if (v251.size.width >= width)
        {
          v63 = x;
        }

        else
        {
          v65 = width - v251.size.width;
          if (v251.origin.x <= x)
          {
            v66 = -v65;
          }

          else
          {
            v66 = v65;
          }

          v63 = x + v66;
        }
      }

      if (v157 <= height)
      {
        y = 0.0;
      }

      else if (v251.size.height < height)
      {
        v67 = height - v251.size.height;
        if (v251.origin.y <= y)
        {
          v67 = -(height - v251.size.height);
        }

        y = y + v67;
      }
    }

    [(UIScrollView *)v64 _effectiveContentInset];
    v69 = -v68;
    v71 = -v70;
    v72 = v63 - v68;
    v73 = y - v70;
    if (v36)
    {
      v74 = v72;
    }

    else
    {
      v74 = v69;
    }

    if (v36)
    {
      v75 = v73;
    }

    else
    {
      v75 = v71;
    }

    [(UICollectionViewLayout *)v177 transitionContentOffsetForProposedContentOffset:v172 keyItemIndexPath:v74, v75];
    [(UICollectionViewLayout *)v177 targetContentOffsetForProposedContentOffset:?];
    [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
    v77 = v76;
    v79 = v78;
    v80 = [(UICollectionViewData *)v167 layoutAttributesForElementsInRect:v76, v78, width, height];
    v81 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v82 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v83 = objc_alloc_init(MEMORY[0x1E695DF90]);
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke;
    aBlock[3] = &unk_1E70FF258;
    v154 = v81;
    v231 = v154;
    v153 = v82;
    v232 = v153;
    v152 = v83;
    v233 = v152;
    v174 = _Block_copy(aBlock);
    v228 = 0u;
    v229 = 0u;
    v226 = 0u;
    v227 = 0u;
    obj = v80;
    v84 = [obj countByEnumeratingWithState:&v226 objects:v244 count:16];
    if (v84)
    {
      v85 = *v227;
      do
      {
        for (j = 0; j != v84; ++j)
        {
          if (*v227 != v85)
          {
            objc_enumerationMutation(obj);
          }

          v87 = *(*(&v226 + 1) + 8 * j);
          v88 = [(UICollectionViewLayoutAttributes *)v87 __indexPath];
          if (!v87)
          {
            v90 = 0;
            v91 = v178;
LABEL_88:
            v93 = [(UICollectionViewLayout *)v91->_layout layoutAttributesForItemAtIndexPath:v88];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForItemAtIndexPath:v88];
            v95 = 0;
            goto LABEL_89;
          }

          v89 = *(v87 + 288);
          v90 = *(v87 + 8);
          v91 = v178;
          if (v89)
          {
            goto LABEL_88;
          }

          layout = v178->_layout;
          if ((v89 & 2) != 0)
          {
            v93 = [(UICollectionViewLayout *)layout layoutAttributesForDecorationViewOfKind:*(v87 + 8) atIndexPath:v88];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForDecorationViewOfKind:v90 atIndexPath:v88];
            v95 = 2;
          }

          else
          {
            v93 = [(UICollectionViewLayout *)layout layoutAttributesForSupplementaryViewOfKind:*(v87 + 8) atIndexPath:v88];
            v94 = [(UICollectionViewLayout *)v177 layoutAttributesForSupplementaryViewOfKind:v90 atIndexPath:v88];
            v95 = 1;
          }

LABEL_89:
          if (v93 | v94)
          {
            v96 = [MEMORY[0x1E695DF90] dictionary];
            v97 = v96;
            if (v94)
            {
              [v96 setObject:v94 forKey:@"newLayoutInfos"];
            }

            if (v93)
            {
              [v97 setObject:v93 forKey:@"previousLayoutInfos"];
            }

            v174[2](v174, v97, v88, v90, v95);
          }
        }

        v84 = [obj countByEnumeratingWithState:&v226 objects:v244 count:16];
      }

      while (v84);
    }

    subviewManager = v178->_subviewManager;
    v223[0] = MEMORY[0x1E69E9820];
    v223[1] = 3221225472;
    v223[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_2;
    v223[3] = &unk_1E70FF280;
    v223[4] = v178;
    v99 = v177;
    v224 = v99;
    v173 = v174;
    v225 = v173;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v223];
    }

    [(UICollectionView *)v178 _updateBackgroundView];
    v221[0] = MEMORY[0x1E69E9820];
    v221[1] = 3221225472;
    v221[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_3;
    v221[3] = &unk_1E70FF2D0;
    v221[4] = v178;
    v100 = v99;
    v222 = v100;
    v101 = _Block_copy(v221);
    v101[2](v101, v154);
    v219[0] = MEMORY[0x1E69E9820];
    v219[1] = 3221225472;
    v219[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_6;
    v219[3] = &unk_1E70FFCC0;
    v102 = v101;
    v220 = v102;
    [v153 enumerateKeysAndObjectsUsingBlock:v219];
    v217[0] = MEMORY[0x1E69E9820];
    v217[1] = 3221225472;
    v217[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_7;
    v217[3] = &unk_1E70FFCC0;
    v151 = v102;
    v218 = v151;
    [v152 enumerateKeysAndObjectsUsingBlock:v217];
    v215[0] = MEMORY[0x1E69E9820];
    v215[1] = 3221225472;
    v215[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_8;
    v215[3] = &unk_1E70FF2F8;
    v215[4] = v178;
    v103 = v100;
    v216 = v103;
    [(UICollectionView *)v178 _applyBlockToAllReusableViews:v215];
    *buf = 0;
    *&buf[8] = buf;
    *&buf[16] = 0x3032000000;
    v241 = __Block_byref_object_copy__39;
    v242 = __Block_byref_object_dispose__39;
    v243 = 0;
    [(UIView *)v178 bounds];
    v105 = v104;
    v107 = v106;
    v109 = v108;
    v111 = v110;
    v112 = [UIView alloc];
    v113 = [(UIView *)v112 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];
    [(UIView *)v178 addSubview:v113];
    v114 = v178->_layout;
    if (v167 && (v167[96] & 8) != 0)
    {
      if ([(UICollectionViewLayout *)v103 shouldInvalidateLayoutForBoundsChange:v77, v79, width, height]&& (v252.origin.x = v77, v252.origin.y = v79, v252.size.width = width, v252.size.height = height, v255.origin.x = v105, v255.origin.y = v107, v255.size.width = v109, v255.size.height = v111, !CGRectEqualToRect(v252, v255)))
      {
        v116 = [(UICollectionViewLayout *)v103 _invalidationContextForBoundsChange:v77 fromOldBounds:v79, width, height, v105, v107, v109, v111];
        v115 = 1;
        v117 = 1;
      }

      else
      {
        v116 = 0;
        v117 = 0;
        v115 = 1;
      }
    }

    else
    {
      v115 = 0;
      v116 = 0;
      v117 = 0;
    }

    v199[0] = MEMORY[0x1E69E9820];
    v199[1] = 3221225472;
    v199[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_9;
    v199[3] = &unk_1E70FF3C0;
    v199[4] = v178;
    v208 = v77;
    v209 = v79;
    v210 = v159;
    v211 = v157;
    v212 = v115;
    v200 = v103;
    v213 = v166;
    v118 = v154;
    v201 = v118;
    v119 = v153;
    v202 = v119;
    v120 = v152;
    v203 = v120;
    v121 = v113;
    v214 = v162;
    v204 = v121;
    v207 = buf;
    v21 = v167;
    v205 = v21;
    v122 = v114;
    v206 = v122;
    v175 = _Block_copy(v199);
    v189[0] = MEMORY[0x1E69E9820];
    v189[1] = 3221225472;
    v189[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_18;
    v189[3] = &unk_1E70FF3E8;
    v189[4] = v178;
    v168 = v122;
    v190 = v168;
    v155 = v118;
    v191 = v155;
    v158 = v119;
    v192 = v158;
    v160 = v120;
    v193 = v160;
    v197 = buf;
    v196 = v169;
    v198 = v117;
    v123 = v116;
    v194 = v123;
    v163 = v121;
    v195 = v163;
    v124 = _Block_copy(v189);
    if (v161)
    {
      v125 = v161;
      v126 = [v125 copy];
      v187 = 0u;
      v188 = 0u;
      v185 = 0u;
      v186 = 0u;
      v127 = [v125 _animations];
      v128 = [v127 countByEnumeratingWithState:&v185 objects:v239 count:16];
      if (v128)
      {
        v129 = *v186;
        do
        {
          for (k = 0; k != v128; ++k)
          {
            if (*v186 != v129)
            {
              objc_enumerationMutation(v127);
            }

            v131 = [*(*(&v185 + 1) + 8 * k) copy];
            [v126 addAnimations:v131];
          }

          v128 = [v127 countByEnumeratingWithState:&v185 objects:v239 count:16];
        }

        while (v128);
      }

      v183 = 0u;
      v184 = 0u;
      v181 = 0u;
      v182 = 0u;
      v132 = [v125 _completions];
      v133 = [v132 countByEnumeratingWithState:&v181 objects:v238 count:16];
      if (v133)
      {
        v134 = *v182;
        do
        {
          for (m = 0; m != v133; ++m)
          {
            if (*v182 != v134)
            {
              objc_enumerationMutation(v132);
            }

            v136 = [*(*(&v181 + 1) + 8 * m) copy];
            [v126 addCompletion:v136];
          }

          v133 = [v132 countByEnumeratingWithState:&v181 objects:v238 count:16];
        }

        while (v133);
      }

      [v126 addAnimations:v175];
      v179[0] = MEMORY[0x1E69E9820];
      v179[1] = 3221225472;
      v179[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_20;
      v179[3] = &unk_1E70FFB68;
      v180 = v124;
      [v126 addCompletion:v179];
      [v126 startAnimation];

      p_isa = &v178->super.super.super.super.isa;
    }

    else
    {
      p_isa = &v178->super.super.super.super.isa;
      if (v166)
      {
        if (dyld_program_sdk_at_least())
        {
          v138 = 7;
        }

        else
        {
          v138 = 5;
        }

        [UIView animateWithDuration:v138 delay:v175 options:v124 animations:0.3 completion:0.0];
      }

      else
      {
        v175[2]();
        (*(v124 + 2))(v124, 1);
      }
    }

    v139 = p_isa[269];
    v140 = p_isa;
    v141 = v140;
    if (v140 && v139)
    {
      v142 = [v140 effectiveUserInterfaceLayoutDirection];
      if (v142 != [v139 developmentLayoutDirection])
      {
        v143 = [v139 _wantsRightToLeftHorizontalMirroringIfNeeded];
        goto LABEL_134;
      }

      if ([v141 _flipsHorizontalAxis])
      {
        v143 = 0;
LABEL_134:
        [v141 _setFlipsHorizontalAxis:v143];
      }
    }

    *(p_collectionViewFlags + 1) &= ~0x10000000uLL;
    [v141 setNeedsFocusUpdate];
    v144 = v141[370];
    v145 = [v141 _focusedItemState];
    v146 = v145;
    if (v145)
    {
      v147 = *(v145 + 16);
    }

    else
    {
      v147 = 0;
    }

    v148 = v147;
    [v144 updateFocusedIndexPath:v148];

    [v141[370] reloadSectionFocusGuides];
    _Block_object_dispose(buf, 8);

    v22 = v172;
    goto LABEL_138;
  }

LABEL_139:
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke(id *a1, uint64_t a2, uint64_t a3, void *a4, uint64_t a5)
{
  v9 = a4;
  v12 = v9;
  if (a5 == 1)
  {
    v10 = [a1[5] objectForKeyedSubscript:v9];
    if (!v10)
    {
      v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v11 = a1[5];
LABEL_8:
      [v11 setObject:v10 forKeyedSubscript:v12];
    }
  }

  else
  {
    if (!a5)
    {
      [a1[4] setObject:a2 forKeyedSubscript:a3];
      goto LABEL_10;
    }

    v10 = [a1[6] objectForKeyedSubscript:v9];
    if (!v10)
    {
      v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v11 = a1[6];
      goto LABEL_8;
    }
  }

  [v10 setObject:a2 forKeyedSubscript:a3];

LABEL_10:
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_2(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v16 = a3;
  v8 = a4;
  v9 = [a5 _layoutAttributes];
  if (!v9 || (v10 = v9[72], (v10 & 1) != 0))
  {

    v12 = [*(*(a1 + 32) + 2152) layoutAttributesForItemAtIndexPath:v16];
    v13 = [*(a1 + 40) layoutAttributesForItemAtIndexPath:v16];
  }

  else
  {

    v11 = *(*(a1 + 32) + 2152);
    if ((v10 & 2) != 0)
    {
      v12 = [v11 layoutAttributesForDecorationViewOfKind:v8 atIndexPath:v16];
      [*(a1 + 40) layoutAttributesForDecorationViewOfKind:v8 atIndexPath:v16];
    }

    else
    {
      v12 = [v11 layoutAttributesForSupplementaryViewOfKind:v8 atIndexPath:v16];
      [*(a1 + 40) layoutAttributesForSupplementaryViewOfKind:v8 atIndexPath:v16];
    }
    v13 = ;
  }

  if (v12 | v13)
  {
    v14 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v15 = v14;
    if (v13)
    {
      [v14 setObject:v13 forKeyedSubscript:@"newLayoutInfos"];
    }

    if (v12)
    {
      [v15 setObject:v12 forKeyedSubscript:@"previousLayoutInfos"];
    }

    (*(*(a1 + 48) + 16))();
  }
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_3(uint64_t a1, void *a2)
{
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_4;
  v4[3] = &unk_1E70FF2A8;
  v3 = *(a1 + 40);
  v4[4] = *(a1 + 32);
  v5 = v3;
  [a2 enumerateKeysAndObjectsUsingBlock:v4];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_4(uint64_t a1, uint64_t a2, void *a3)
{
  v6 = [a3 objectForKey:@"previousLayoutInfos"];
  v7 = [a3 objectForKey:@"newLayoutInfos"];
  v8 = v7;
  if (v6)
  {
    v9 = v6[1];
    v10 = v6;
  }

  else
  {
    v9 = [(_UILabelConfiguration *)v7 _content];
    v10 = v8;
    objc_storeStrong((*(a1 + 32) + 2552), v8);
    if (!v10)
    {
      if ([0 isHidden])
      {
        [0 isHidden];
      }

      v10 = 0;
      goto LABEL_32;
    }
  }

  v11 = *(v10 + 72);
  if (v11)
  {
    v13 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
  }

  else
  {
    if (!v9)
    {
      goto LABEL_13;
    }

    v12 = *(*(a1 + 32) + 2984);
    if ((v11 & 2) != 0)
    {
      [(_UICollectionViewSubviewManager *)v12 visibleDecorationOfKind:v9 atIndexPath:a2];
    }

    else
    {
      [(_UICollectionViewSubviewManager *)v12 visibleSupplementaryOfKind:v9 atIndexPath:a2];
    }
    v13 = ;
  }

  v14 = v13;
  if (v13)
  {
    v22[0] = MEMORY[0x1E69E9820];
    v22[1] = 3221225472;
    v22[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_5;
    v22[3] = &unk_1E70F6228;
    v22[4] = *(a1 + 32);
    v10 = v10;
    v23 = v10;
    v15 = v14;
    v24 = v15;
    [UIView performWithoutAnimation:v22];

    goto LABEL_28;
  }

LABEL_13:
  if ([v8 isHidden])
  {
    v15 = 0;
    if (([v6 isHidden] & 1) != 0 || !v8)
    {
      goto LABEL_28;
    }

    goto LABEL_18;
  }

  if (!v8)
  {
LABEL_32:
    v15 = 0;
    goto LABEL_28;
  }

LABEL_18:
  v16 = *(v8 + 72);
  if (v16)
  {
    v15 = [*(a1 + 32) _createPreparedCellForItemAtIndexPath:a2 withLayoutAttributes:v10 applyAttributes:1];
    if (v15)
    {
      [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) setVisibleCell:v15 atIndexPath:a2];
    }
  }

  else
  {
    v17 = [*(a1 + 32) _createPreparedSupplementaryViewForElementOfKind:v9 atIndexPath:a2 layout:*(a1 + 40) withLayoutAttributes:v10 applyAttributes:1];
    v15 = v17;
    if ((v16 & 2) != 0)
    {
      if (v17)
      {
        v19 = *(*(a1 + 32) + 2984);
        if (v19)
        {
          [(_UICollectionViewSubviewCollection *)*(v19 + 8) setView:v17 forDecorationOfKind:v9 atIndexPath:a2];
        }
      }
    }

    else if (v17)
    {
      v18 = *(*(a1 + 32) + 2984);
      if (v18)
      {
        [(_UICollectionViewSubviewCollection *)*(v18 + 8) setView:v17 forSupplementaryOfKind:v9 atIndexPath:a2];
      }
    }
  }

LABEL_28:
  v20 = *(a1 + 32);
  v21 = *(v20 + 2552);
  *(v20 + 2552) = 0;
}

uint64_t __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_9(uint64_t a1)
{
  v2 = *(a1 + 32);
  if ((v2[2721] & 0x20) != 0)
  {
    v3 = [v2 _delegateProxy];
    v4 = [v3 _collectionView:*(a1 + 32) shouldApplyTransitionContentOffset:*(a1 + 104) contentSize:{*(a1 + 112), *(a1 + 120), *(a1 + 128)}];

    if (!v4)
    {
      goto LABEL_5;
    }

    v2 = *(a1 + 32);
  }

  [v2 setContentOffset:{*(a1 + 104), *(a1 + 112)}];
  [*(a1 + 32) setContentSize:{*(a1 + 120), *(a1 + 128)}];
LABEL_5:
  if (*(a1 + 136) == 1)
  {
    [*(a1 + 32) _updateDefaultLayoutMargins];
  }

  if ([*(*(a1 + 32) + 2152) _supportsAdvancedTransitionAnimations] && objc_msgSend(*(a1 + 40), "_supportsAdvancedTransitionAnimations"))
  {
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_10;
    aBlock[3] = &unk_1E70FF348;
    v5 = *(a1 + 40);
    aBlock[4] = *(a1 + 32);
    v32 = *(a1 + 137);
    v6 = &v31;
    v31 = v5;
    v7 = _Block_copy(aBlock);
    (*(v7 + 2))(v7, *(a1 + 48), 0, 0);
    v8 = *(a1 + 56);
    v28[0] = MEMORY[0x1E69E9820];
    v28[1] = 3221225472;
    v28[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_12;
    v28[3] = &unk_1E70FFCC0;
    v9 = &v29;
    v10 = v7;
    v29 = v10;
    [v8 enumerateKeysAndObjectsUsingBlock:v28];
    v11 = *(a1 + 64);
    v26[0] = MEMORY[0x1E69E9820];
    v26[1] = 3221225472;
    v26[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_13;
    v26[3] = &unk_1E70FFCC0;
    v12 = &v27;
    v27 = v10;
    v13 = v10;
    v14 = v26;
  }

  else
  {
    v24[0] = MEMORY[0x1E69E9820];
    v24[1] = 3221225472;
    v24[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_14;
    v24[3] = &unk_1E70FF398;
    v15 = *(a1 + 40);
    v24[4] = *(a1 + 32);
    v6 = &v25;
    v25 = v15;
    v16 = _Block_copy(v24);
    (*(v16 + 2))(v16, *(a1 + 48), 0, 0);
    v17 = *(a1 + 56);
    v22[0] = MEMORY[0x1E69E9820];
    v22[1] = 3221225472;
    v22[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_16;
    v22[3] = &unk_1E70FFCC0;
    v9 = &v23;
    v18 = v16;
    v23 = v18;
    [v17 enumerateKeysAndObjectsUsingBlock:v22];
    v11 = *(a1 + 64);
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_17;
    v20[3] = &unk_1E70FFCC0;
    v12 = &v21;
    v21 = v18;
    v13 = v18;
    v14 = v20;
  }

  [v11 enumerateKeysAndObjectsUsingBlock:v14];

  [*(a1 + 72) setAlpha:0.0];
  objc_storeStrong((*(a1 + 32) + 2152), *(a1 + 40));
  [*(*(a1 + 32) + 2960) cleanupSectionFocusGuides];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(*(a1 + 32) + 2952) reconfigureScrollViewsForUpdate:?];
  [*(a1 + 32) _reconfigureSectionContainersForUpdate:0];
  if (*(a1 + 138))
  {
    objc_storeStrong((*(*(a1 + 96) + 8) + 40), *(*(a1 + 32) + 2272));
  }

  objc_storeStrong((*(a1 + 32) + 2272), *(a1 + 80));
  objc_opt_class();
  result = objc_opt_isKindOfClass();
  if ((result & 1) == 0)
  {
    [*(a1 + 40) _finalizeLayoutTransition];
    return [*(a1 + 88) _finalizeLayoutTransition];
  }

  return result;
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_10(uint64_t a1, void *a2, uint64_t a3, void *a4)
{
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_11;
  v10[3] = &unk_1E70FF320;
  v13 = a3;
  v8 = *(a1 + 40);
  v10[4] = *(a1 + 32);
  v11 = v7;
  v14 = *(a1 + 48);
  v12 = v8;
  v9 = v7;
  [a2 enumerateKeysAndObjectsUsingBlock:v10];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_11(uint64_t a1, uint64_t a2, void *a3)
{
  v21 = *MEMORY[0x1E69E9840];
  v5 = *(a1 + 56);
  if (v5 == 2)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleDecorationOfKind:a2 atIndexPath:?];
  }

  else if (v5 == 1)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:a2 atIndexPath:?];
  }

  else
  {
    if (v5)
    {
      return;
    }

    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
  }

  v7 = v6;
  if (v6)
  {
    [v6 _addUpdateAnimation];
    [a3 setObject:v7 forKey:@"view"];
    v8 = [a3 objectForKeyedSubscript:@"previousLayoutInfos"];
    v9 = [a3 objectForKeyedSubscript:@"newLayoutInfos"];
    if (!v9)
    {
      v9 = [v8 copy];
      [v9 setAlpha:0.0];
    }

    if (*(a1 + 64) == 1)
    {
      LOBYTE(v15) = 1;
      v10 = [*(a1 + 32) _viewAnimationsForView:v7 startingLayoutAttributes:v8 endingLayoutAttributes:v9 startingLayout:*(*(a1 + 32) + 2152) endingLayout:*(a1 + 48) animationSetup:0 animationCompletion:0 enableCustomAnimations:v15 customAnimationsType:1];
      v16 = 0u;
      v17 = 0u;
      v18 = 0u;
      v19 = 0u;
      v11 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
      if (v11)
      {
        v12 = v11;
        v13 = *v17;
        do
        {
          for (i = 0; i != v12; ++i)
          {
            if (*v17 != v13)
            {
              objc_enumerationMutation(v10);
            }

            [*(*(&v16 + 1) + 8 * i) start];
          }

          v12 = [v10 countByEnumeratingWithState:&v16 objects:v20 count:16];
        }

        while (v12);
      }
    }

    else if (v9)
    {
      [*(a1 + 32) _applyLayoutAttributes:v9 toView:v7];
    }
  }
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_14(uint64_t a1, void *a2, uint64_t a3, void *a4)
{
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_15;
  v10[3] = &unk_1E70FF370;
  v13 = a3;
  v8 = *(a1 + 40);
  v10[4] = *(a1 + 32);
  v11 = v7;
  v12 = v8;
  v9 = v7;
  [a2 enumerateKeysAndObjectsUsingBlock:v10];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_15(uint64_t a1, uint64_t a2, void *a3)
{
  v5 = *(a1 + 56);
  if (v5 == 2)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleDecorationOfKind:a2 atIndexPath:?];
    if (!v6)
    {
      return;
    }
  }

  else if (v5 == 1)
  {
    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:a2 atIndexPath:?];
    if (!v6)
    {
      return;
    }
  }

  else
  {
    if (v5)
    {
      return;
    }

    v6 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:a2];
    if (!v6)
    {
      return;
    }
  }

  v11 = v6;
  v7 = [a3 objectForKeyedSubscript:@"previousLayoutInfos"];
  v8 = [a3 objectForKeyedSubscript:@"newLayoutInfos"];
  if (!v8)
  {
    v8 = [v7 copy];
    [v8 setAlpha:0.0];
  }

  v9 = [*(a1 + 48) _animationForReusableView:v11 toLayoutAttributes:v8 type:1];
  v10 = [v9 copy];

  if (v10)
  {
    [v11 _setBaseLayoutAttributes:v8];
    v10[2](v10, 0);
    [v11 applyLayoutAttributes:v8];
  }

  else
  {
    [*(a1 + 32) _applyLayoutAttributes:v8 toView:v11];
  }

  [v11 _addUpdateAnimation];
  [a3 setObject:v11 forKey:@"view"];
}

void __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_18(id *a1)
{
  v70 = *MEMORY[0x1E69E9840];
  v62[0] = MEMORY[0x1E69E9820];
  v62[1] = 3221225472;
  v62[2] = __88__UICollectionView__setCollectionViewLayout_animated_isInteractive_completion_animator___block_invoke_19;
  v62[3] = &unk_1E70FF2F8;
  v2 = a1[4];
  v3 = a1[5];
  v4 = a1[4];
  v63 = v3;
  v64 = v4;
  [v2 _applyBlockToAllReusableViews:v62];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(a1[4] + 369) processQueuedScrollViewRemovals];
  [a1[4] _processQueuedSectionContainerRemovals];
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v5 = [a1[6] objectEnumerator];
  v6 = [v5 countByEnumeratingWithState:&v58 objects:v69 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v59;
    do
    {
      for (i = 0; i != v7; ++i)
      {
        if (*v59 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = [*(*(&v58 + 1) + 8 * i) objectForKeyedSubscript:@"view"];
        [v10 _clearUpdateAnimation];
      }

      v7 = [v5 countByEnumeratingWithState:&v58 objects:v69 count:16];
    }

    while (v7);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v41 = a1;
  v11 = [a1[7] objectEnumerator];
  v12 = [v11 countByEnumeratingWithState:&v54 objects:v68 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v55;
    do
    {
      for (j = 0; j != v13; ++j)
      {
        if (*v55 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v54 + 1) + 8 * j);
        v50 = 0u;
        v51 = 0u;
        v52 = 0u;
        v53 = 0u;
        v17 = [v16 objectEnumerator];
        v18 = [v17 countByEnumeratingWithState:&v50 objects:v67 count:16];
        if (v18)
        {
          v19 = v18;
          v20 = *v51;
          do
          {
            for (k = 0; k != v19; ++k)
            {
              if (*v51 != v20)
              {
                objc_enumerationMutation(v17);
              }

              v22 = [*(*(&v50 + 1) + 8 * k) objectForKeyedSubscript:@"view"];
              [v22 _clearUpdateAnimation];
            }

            v19 = [v17 countByEnumeratingWithState:&v50 objects:v67 count:16];
          }

          while (v19);
        }
      }

      v13 = [v11 countByEnumeratingWithState:&v54 objects:v68 count:16];
    }

    while (v13);
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v23 = [v41[8] objectEnumerator];
  v24 = [v23 countByEnumeratingWithState:&v46 objects:v66 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v47;
    do
    {
      for (m = 0; m != v25; ++m)
      {
        if (*v47 != v26)
        {
          objc_enumerationMutation(v23);
        }

        v28 = *(*(&v46 + 1) + 8 * m);
        v42 = 0u;
        v43 = 0u;
        v44 = 0u;
        v45 = 0u;
        v29 = [v28 objectEnumerator];
        v30 = [v29 countByEnumeratingWithState:&v42 objects:v65 count:16];
        if (v30)
        {
          v31 = v30;
          v32 = *v43;
          do
          {
            for (n = 0; n != v31; ++n)
            {
              if (*v43 != v32)
              {
                objc_enumerationMutation(v29);
              }

              v34 = [*(*(&v42 + 1) + 8 * n) objectForKeyedSubscript:@"view"];
              [v34 _clearUpdateAnimation];
            }

            v31 = [v29 countByEnumeratingWithState:&v42 objects:v65 count:16];
          }

          while (v31);
        }
      }

      v25 = [v23 countByEnumeratingWithState:&v46 objects:v66 count:16];
    }

    while (v25);
  }

  *(v41[4] + 341) &= ~0x20000000uLL;
  [v41[4] _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v35 = v41[4];
  v36 = v35[415];
  if (v36)
  {
    v37 = (*(v36 + 16))(v35[415]);
    [v41[4] _setNavigationCompletion:0];
    if ((v37 & 1) == 0)
    {
      objc_storeStrong(v41[4] + 269, v41[5]);
      objc_storeStrong(v41[4] + 284, *(*(v41[12] + 1) + 40));
      [*(v41[4] + 269) _didFinishLayoutTransitionAnimations:0];
      v38 = v41[11];
      if (v38)
      {
        v38[2](v38, 0);
      }

      [v41[4] layoutIfNeeded];
      goto LABEL_48;
    }
  }

  else
  {
    [v35 _setNavigationCompletion:0];
  }

  v39 = *(v41[4] + 269);
  if (v41[5] != v39)
  {
    [v41[5] _setCollectionView:0];
    v39 = *(v41[4] + 269);
  }

  [v39 _didFinishLayoutTransitionAnimations:1];
  v40 = v41[11];
  if (v40)
  {
    v40[2](v40, 1);
  }

  if (*(v41 + 104) == 1)
  {
    [*(v41[4] + 269) _invalidateLayoutUsingContext:v41[9]];
  }

LABEL_48:
  [v41[10] removeFromSuperview];
}

- (UICollectionViewTransitionLayout)startInteractiveTransitionToCollectionViewLayout:(UICollectionViewLayout *)layout completion:(UICollectionViewLayoutInteractiveTransitionCompletion)completion
{
  v8 = layout;
  v9 = completion;
  if (!v8)
  {
    v21 = [MEMORY[0x1E696AAA8] currentHandler];
    [v21 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7586 description:@"layout cannot be nil in startInteractiveTransitionToCollectionViewLayout:"];
  }

  if (self->_isInInteractiveTransition)
  {
    v10 = [MEMORY[0x1E696AAA8] currentHandler];
    [v10 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7589 description:@"the collection is already in the middle of an interactive transition"];
  }

  v11 = [v9 copy];
  interactiveCompletionHandler = self->_interactiveCompletionHandler;
  self->_interactiveCompletionHandler = v11;

  if ((*(&self->_collectionViewFlags + 12) & 4) != 0)
  {
    v16 = [(UICollectionView *)self _delegateActual];
    if (objc_opt_respondsToSelector())
    {
      v17 = [(UICollectionView *)self _delegateProxy];
      v18 = [(UICollectionView *)self collectionViewLayout];
      v15 = [v17 collectionView:self transitionLayoutForOldLayout:v18 newLayout:v8];
    }

    else
    {
      v19 = [UICollectionViewTransitionLayout alloc];
      v17 = [(UICollectionView *)self collectionViewLayout];
      v15 = [(UICollectionViewTransitionLayout *)v19 initWithCurrentLayout:v17 nextLayout:v8];
    }

    [(UICollectionView *)self setCollectionViewLayout:v15];
    self->_isInInteractiveTransition = 1;
    self->_shouldAccumulateTrackedLayoutValues = 1;
  }

  else
  {
    [(UICollectionViewLayout *)self->_layout _setCollectionView:0];
    objc_storeStrong(&self->_layout, layout);
    [(UICollectionViewLayout *)self->_layout _setCollectionView:self];
    v13 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
    collectionViewData = self->_collectionViewData;
    self->_collectionViewData = v13;

    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    v15 = 0;
  }

  return v15;
}

- (void)_updateTransitionWithProgress:(double)a3
{
  v5 = [(UICollectionView *)self collectionViewLayout];
  [(UICollectionViewData *)self->_collectionViewData invalidate:?];
  [v5 setTransitionProgress:a3];
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
}

- (void)_cleanUpAfterInteractiveTransitionDidFinish:(BOOL)a3
{
  v3 = a3;
  v49 = *MEMORY[0x1E69E9840];
  v5 = [(UICollectionView *)self collectionViewLayout];
  v6 = [v5 currentLayout];
  v7 = [v5 nextLayout];
  [v5 _oldVisibleBounds];
  v9 = v8;
  v11 = v10;
  v13 = v12;
  v15 = v14;
  [v5 _newVisibleBounds];
  if (v3)
  {
    v9 = v16;
    v11 = v17;
    v13 = v18;
    v15 = v19;
  }

  v38 = v6;
  if (v3)
  {
    v20 = v7;
  }

  else
  {
    v20 = v6;
  }

  [(UICollectionView *)self setCollectionViewLayout:v20];
  [(UICollectionView *)self setBounds:v9, v11, v13, v15];
  *(&self->_collectionViewFlags + 1) &= ~0x20000000uLL;
  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  interactiveCompletionHandler = self->_interactiveCompletionHandler;
  if (interactiveCompletionHandler)
  {
    interactiveCompletionHandler[2](interactiveCompletionHandler, 1, v3);
    v22 = self->_interactiveCompletionHandler;
    self->_interactiveCompletionHandler = 0;
  }

  trackedValuesKeys = self->_trackedValuesKeys;
  self->_trackedValuesKeys = 0;

  interactiveTransitionValueTrackingDict = self->_interactiveTransitionValueTrackingDict;
  self->_interactiveTransitionValueTrackingDict = 0;

  self->_shouldAccumulateTrackedLayoutValues = 1;
  __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(self->_clonedCellsDict);
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v25 = [(NSMutableDictionary *)self->_clonedSupplementaryViewsDict objectEnumerator];
  v26 = [v25 countByEnumeratingWithState:&v43 objects:v48 count:16];
  if (v26)
  {
    v27 = v26;
    v28 = *v44;
    do
    {
      for (i = 0; i != v27; ++i)
      {
        if (*v44 != v28)
        {
          objc_enumerationMutation(v25);
        }

        __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(*(*(&v43 + 1) + 8 * i));
      }

      v27 = [v25 countByEnumeratingWithState:&v43 objects:v48 count:16];
    }

    while (v27);
  }

  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  v30 = [(NSMutableDictionary *)self->_clonedDecorationViewsDict objectEnumerator];
  v31 = [v30 countByEnumeratingWithState:&v39 objects:v47 count:16];
  if (v31)
  {
    v32 = v31;
    v33 = *v40;
    do
    {
      for (j = 0; j != v32; ++j)
      {
        if (*v40 != v33)
        {
          objc_enumerationMutation(v30);
        }

        __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(*(*(&v39 + 1) + 8 * j));
      }

      v32 = [v30 countByEnumeratingWithState:&v39 objects:v47 count:16];
    }

    while (v32);
  }

  clonedCellsDict = self->_clonedCellsDict;
  self->_clonedCellsDict = 0;

  clonedSupplementaryViewsDict = self->_clonedSupplementaryViewsDict;
  self->_clonedSupplementaryViewsDict = 0;

  clonedDecorationViewsDict = self->_clonedDecorationViewsDict;
  self->_clonedDecorationViewsDict = 0;
}

void __64__UICollectionView__cleanUpAfterInteractiveTransitionDidFinish___block_invoke(void *a1)
{
  v11 = *MEMORY[0x1E69E9840];
  v6 = 0u;
  v7 = 0u;
  v8 = 0u;
  v9 = 0u;
  v1 = [a1 objectEnumerator];
  v2 = [v1 countByEnumeratingWithState:&v6 objects:v10 count:16];
  if (v2)
  {
    v3 = v2;
    v4 = *v7;
    do
    {
      v5 = 0;
      do
      {
        if (*v7 != v4)
        {
          objc_enumerationMutation(v1);
        }

        [*(*(&v6 + 1) + 8 * v5++) removeFromSuperview];
      }

      while (v3 != v5);
      v3 = [v1 countByEnumeratingWithState:&v6 objects:v10 count:16];
    }

    while (v3);
  }
}

- (void)_finishInteractiveTransitionShouldFinish:(BOOL)a3 finalAnimation:(BOOL)a4
{
  v5 = a3;
  v34 = *MEMORY[0x1E69E9840];
  if (!self->_isInInteractiveTransition)
  {
    v23 = [MEMORY[0x1E696AAA8] currentHandler];
    [v23 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:7682 description:@"the collection was not prepared for an interactive transition. see startInteractiveTransitionToCollectionViewLayout:completion:"];
  }

  self->_shouldAccumulateTrackedLayoutValues = 0;
  currentInteractiveTransitionTimeStamp = self->_currentInteractiveTransitionTimeStamp;
  previousInteractiveTransitionTimeStamp = self->_previousInteractiveTransitionTimeStamp;
  if (currentInteractiveTransitionTimeStamp == previousInteractiveTransitionTimeStamp)
  {
    v9 = 0.0;
    if (a4)
    {
      goto LABEL_5;
    }
  }

  else
  {
    v9 = (self->_currentInteractiveTransitionProgress - self->_previousInteractiveTransitionProgress) / (currentInteractiveTransitionTimeStamp - previousInteractiveTransitionTimeStamp);
    if (a4)
    {
LABEL_5:
      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke;
      aBlock[3] = &unk_1E70FFAF8;
      aBlock[4] = self;
      v25 = _Block_copy(aBlock);
      v30[0] = MEMORY[0x1E69E9820];
      v30[1] = 3221225472;
      v30[2] = __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke_2;
      v30[3] = &unk_1E70FA0F0;
      v30[4] = self;
      v31 = v5;
      v24 = _Block_copy(v30);
      if (v5)
      {
        v10 = 1.0;
      }

      else
      {
        v10 = 0.0;
      }

      v11 = [[_UIDynamicValueAnimation alloc] initWithValue:self->_currentInteractiveTransitionProgress velocity:v9 unitSize:0.004];
      v12 = [_UIDynamicAnimationActiveValue upperBoundary:1 ofType:v10];
      v13 = [_UIDynamicAnimationActiveValue lowerBoundary:1 ofType:v10];
      [(_UIDynamicValueAnimation *)v11 addActiveValue:v12];
      [(_UIDynamicValueAnimation *)v11 addActiveValue:v13];
      v14 = objc_alloc_init(_UIDynamicAnimationGroup);
      endInteractiveTransitionAnimationGroup = self->_endInteractiveTransitionAnimationGroup;
      self->_endInteractiveTransitionAnimationGroup = v14;

      [(_UIDynamicAnimation *)self->_endInteractiveTransitionAnimationGroup _setUsesNSTimer:1];
      [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup addAnimation:v11];
      v16 = [(UICollectionView *)self _dynamicAnimationsForTrackValues];
      v26 = 0u;
      v27 = 0u;
      v28 = 0u;
      v29 = 0u;
      v17 = [v16 countByEnumeratingWithState:&v26 objects:v33 count:16];
      if (v17)
      {
        v18 = v17;
        v19 = *v27;
        do
        {
          for (i = 0; i != v18; ++i)
          {
            if (*v27 != v19)
            {
              objc_enumerationMutation(v16);
            }

            [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup addAnimation:*(*(&v26 + 1) + 8 * i), v24];
          }

          v18 = [v16 countByEnumeratingWithState:&v26 objects:v33 count:16];
        }

        while (v18);
      }

      v21 = v24;
      [(_UIDynamicAnimationGroup *)self->_endInteractiveTransitionAnimationGroup runWithGroupApplier:v25 completion:v24, v24];
      self->_isInInteractiveTransition = 0;

      return;
    }
  }

  self->_isInInteractiveTransition = 0;

  [(UICollectionView *)self _cleanUpAfterInteractiveTransitionDidFinish:v5];
}

void __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke(uint64_t a1, int a2)
{
  if ((a2 - 1) <= 1)
  {
    v3 = [*(*(a1 + 32) + 2616) animations];
    v4 = [v3 objectAtIndex:0];
    [v4 value];
    v6 = v5;

    [*(a1 + 32) _updateTransitionWithProgress:v6];
    v7 = [*(*(a1 + 32) + 2616) animations];
    v8 = [v7 count];

    if (v8 >= 2)
    {
      v9 = [*(*(a1 + 32) + 2616) animations];
      v10 = [v9 mutableCopy];

      [v10 removeObjectAtIndex:0];
      [*(a1 + 32) _updateTrackedLayoutValuesWith:v10];
    }
  }
}

void __76__UICollectionView__finishInteractiveTransitionShouldFinish_finalAnimation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) _cleanUpAfterInteractiveTransitionDidFinish:*(a1 + 40)];
  v2 = *(a1 + 32);
  v3 = *(v2 + 2616);
  *(v2 + 2616) = 0;
}

- (id)_pivotForTransitionFromLayout:(id)a3 toLayout:(id)a4
{
  if ((*(&self->_collectionViewFlags + 1) & 0x10) != 0)
  {
    v6 = [(UICollectionView *)self _delegateProxy:a3];
    v4 = [v6 _indexPathOfReferenceItemForLayoutTransitionInCollectionView:self];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (NSInteger)numberOfItemsInSection:(NSInteger)section
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  collectionViewData = self->_collectionViewData;

  return [(UICollectionViewData *)collectionViewData numberOfItemsInSection:?];
}

- (UICollectionViewLayoutAttributes)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
    if (v5)
    {
      v8 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v5];
      v6 = [v8 copy];

      if (v6)
      {
        [v6 setIndexPath:indexPath];
      }
    }

    else
    {
      v6 = 0;
    }
  }

  else
  {
    v5 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:?];
    v6 = [v5 copy];
  }

  return v6;
}

- (UICollectionViewLayoutAttributes)layoutAttributesForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath
{
  v6 = kind;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForSupplementaryElementOfKind:v6 atIndexPath:indexPath];

  v8 = [v7 copy];

  return v8;
}

- (NSIndexPath)indexPathForItemAtPoint:(CGPoint)point
{
  v4 = [(UICollectionView *)self _indexPathForItemAtPoint:point.x, point.y];
  if (dyld_program_sdk_at_least())
  {
    dragAndDropController = self->_dragAndDropController;
    if (!dragAndDropController || dragAndDropController->_sessionKind != 1)
    {
      v6 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v4];

      v4 = v6;
    }
  }

  return v4;
}

- (id)_indexPathForItemAtPoint:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  v22 = *MEMORY[0x1E69E9840];
  [(UICollectionView *)self _reloadDataIfNeeded];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v6 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:x validateLayout:y, 1.0, 1.0];
  v7 = [v6 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = 0;
    v10 = *v18;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v18 != v10)
        {
          objc_enumerationMutation(v6);
        }

        v12 = *(*(&v17 + 1) + 8 * i);
        if (v9)
        {
          v13 = [*(*(&v17 + 1) + 8 * i) zIndex];
          if (v13 <= [v9 zIndex])
          {
            continue;
          }
        }

        v14 = v12;

        v9 = v14;
      }

      v8 = [v6 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v8);
  }

  else
  {
    v9 = 0;
  }

  v15 = [v9 indexPath];

  return v15;
}

- (id)_indexPathForView:(id)a3 ofType:(unint64_t)a4
{
  v6 = a3;
  [(UICollectionView *)self _reloadDataIfNeeded];
  v30 = 0;
  v31 = &v30;
  v32 = 0x3032000000;
  v33 = __Block_byref_object_copy__39;
  v34 = __Block_byref_object_dispose__39;
  v35 = 0;
  subviewManager = self->_subviewManager;
  if (a4 == 1)
  {
    v13 = [v6 _layoutAttributes];
    v14 = [(_UILabelConfiguration *)v13 _content];
    v15 = v24;
    v24[0] = MEMORY[0x1E69E9820];
    v24[1] = 3221225472;
    v24[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_3;
    v24[3] = &unk_1E70FF438;
    v24[4] = v6;
    v24[5] = &v30;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateSupplementariesOfElementKind:v14 enumerator:v24];
    }

    goto LABEL_15;
  }

  if (a4)
  {
    v13 = [v6 _layoutAttributes];
    v14 = [(_UILabelConfiguration *)v13 _content];
    v15 = v23;
    v23[0] = MEMORY[0x1E69E9820];
    v23[1] = 3221225472;
    v23[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_4;
    v23[3] = &unk_1E70FF438;
    v23[4] = v6;
    v23[5] = &v30;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateDecorationsOfElementKind:v14 enumerator:v23];
    }

LABEL_15:
    v10 = (v15 + 4);

    goto LABEL_16;
  }

  v28[0] = MEMORY[0x1E69E9820];
  v28[1] = 3221225472;
  v28[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke;
  v28[3] = &unk_1E70FFC20;
  v8 = v6;
  v29[0] = v8;
  v29[1] = &v30;
  if (!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v28], !v31[5]))
  {
    if (dyld_program_sdk_at_least())
    {
      prefetchCacheItems = self->_prefetchCacheItems;
      v25[0] = MEMORY[0x1E69E9820];
      v25[1] = 3221225472;
      v25[2] = __45__UICollectionView__indexPathForView_ofType___block_invoke_2;
      v25[3] = &unk_1E70FF410;
      v26 = v8;
      v27 = &v30;
      [(NSMutableDictionary *)prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v25];
    }
  }

  v10 = v29;
  v11 = v31;
  if (!v31[5] && self->_firstResponderViewType == 1 && self->_firstResponderView == v8)
  {
    v12 = self->_firstResponderIndexPath;
    v13 = v11[5];
    v11[5] = v12;
LABEL_16:
  }

  v16 = [(UICollectionView *)self _focusedItemState];
  v17 = v16;
  if (!v31[5])
  {
    v18 = v16 ? *(v16 + 8) : 0;
    v19 = v18;

    if (v19 == v6)
    {
      if (v17)
      {
        v20 = v17[2];
      }

      else
      {
        v20 = 0;
      }

      objc_storeStrong(v31 + 5, v20);
    }
  }

  v21 = v31[5];

  _Block_object_dispose(&v30, 8);

  return v21;
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_2(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v11 = a2;
  if (a3)
  {
    v8 = *(a3 + 24);
  }

  else
  {
    v8 = 0;
  }

  v9 = v8;
  v10 = *(a1 + 32);

  if (v9 == v10)
  {
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_3(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

void __45__UICollectionView__indexPathForView_ofType___block_invoke_4(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

- (NSIndexPath)indexPathForCell:(UICollectionViewCell *)cell
{
  v4 = [(UICollectionView *)self _indexPathForView:cell ofType:0];
  v5 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v4];

  return v5;
}

- (id)indexPathForSupplementaryView:(id)a3
{
  v4 = a3;
  v5 = [v4 _layoutAttributes];
  v6 = v5;
  if (v5)
  {
    v7 = *(v5 + 288);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }
  }

  else
  {
    v9 = 0;
  }

  v10 = [(UICollectionView *)self _indexPathForView:v4 ofType:v9];

  if (v10)
  {
    v11 = [(UICollectionView *)self _translatePresentationIndexPathToDataSourceIndexPathAsNeeded:v10];
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (id)_indexPathForSupplementaryView:(id)a3
{
  v4 = a3;
  v5 = [v4 _layoutAttributes];
  v6 = v5;
  if (v5)
  {
    v7 = *(v5 + 288);
    v8 = 1;
    if ((v7 & 2) != 0)
    {
      v8 = 2;
    }

    if (v7)
    {
      v9 = 0;
    }

    else
    {
      v9 = v8;
    }
  }

  else
  {
    v9 = 0;
  }

  v10 = [(UICollectionView *)self _indexPathForView:v4 ofType:v9];

  return v10;
}

- (UICollectionViewCell)cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
  v4 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:v4];

  return v5;
}

- (id)_cellForItemAtIndexPath:(id)a3
{
  v4 = a3;
  if (!v4)
  {
    v8 = 0;
    goto LABEL_19;
  }

  [(UICollectionView *)self _reloadDataIfNeeded];
  v5 = &OBJC_IVAR___UICollectionView__collectionViewData;
  currentUpdate = self->_currentUpdate;
  if (currentUpdate)
  {
    v5 = &OBJC_IVAR___UICollectionViewUpdate__oldModel;
  }

  else
  {
    currentUpdate = self;
  }

  v7 = *&currentUpdate[*v5];
  if ([(UICollectionViewData *)v7 validatedGlobalIndexForItemAtIndexPath:v4]!= 0x7FFFFFFFFFFFFFFFLL)
  {
    if ([(UICollectionView *)self _hasFocusedCellForIndexPath:v4 shouldUsePreUpdateData:1])
    {
      v9 = [(UICollectionView *)self _focusedItemState];
      v10 = [(_UICollectionViewFocusedItemState *)v9 cell];
    }

    else
    {
      firstResponderIndexPath = self->_firstResponderIndexPath;
      if (firstResponderIndexPath && self->_firstResponderViewType == 1 && [(NSIndexPath *)firstResponderIndexPath isEqual:v4]&& dyld_program_sdk_at_least())
      {
        v8 = self->_firstResponderView;
        goto LABEL_18;
      }

      v8 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v4];
      if (v8)
      {
        goto LABEL_18;
      }

      if (!dyld_program_sdk_at_least())
      {
        goto LABEL_6;
      }

      v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v4];
      v9 = v13;
      if (!v13 || (v14 = *(v13 + 16)) == 0 || (v15 = v14[72], v14, (v15 & 1) == 0))
      {
        v8 = 0;
        goto LABEL_11;
      }

      v10 = *(v9 + 24);
    }

    v8 = v10;
LABEL_11:

    goto LABEL_18;
  }

LABEL_6:
  v8 = 0;
LABEL_18:

LABEL_19:

  return v8;
}

- (id)_indexPathsForPreparedItems
{
  [(UICollectionView *)self _reloadDataIfNeeded];
  v3 = objc_opt_new();
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v4 = ![(UICollectionView *)self _isOperatingWithPresentationValues];
  }

  else
  {
    v4 = 0;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __47__UICollectionView__indexPathsForPreparedItems__block_invoke;
  aBlock[3] = &unk_1E70FF460;
  v19 = v4;
  aBlock[4] = self;
  v5 = v3;
  v18 = v5;
  v6 = _Block_copy(aBlock);
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v6];
  }

  [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:v6];
  v8 = [(UICollectionView *)self _focusedItemState];
  v9 = v8;
  if (v8)
  {
    v10 = *(v8 + 8);
    if (v10)
    {
      v11 = *(v9 + 32);

      if (!v11)
      {
        v16 = 0;
        v12 = *(v9 + 16);
        v6[2](v6, v12, 0, &v16);
      }
    }
  }

  v13 = self->_firstResponderIndexPath;
  if (v13 && self->_firstResponderView && self->_firstResponderViewType == 1)
  {
    v16 = 0;
    v6[2](v6, v13, 0, &v16);
  }

  v14 = [v5 array];

  return v14;
}

void __47__UICollectionView__indexPathsForPreparedItems__block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  if ((*(a1 + 48) & 1) == 0)
  {
    v5 = v3;
    v4 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:v3];

    v3 = v4;
  }

  if (v3)
  {
    v6 = v3;
    [*(a1 + 40) addObject:v3];
    v3 = v6;
  }
}

- (id)_visibleSupplementaryViewsOfKind:(id)a3 isDecorationView:(BOOL)a4
{
  v6 = a3;
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;
  if (a4)
  {
    [(_UICollectionViewSubviewManager *)subviewManager visibleDecorationsOfKind:v6];
  }

  else
  {
    [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementariesOfKind:v6];
  }
  v8 = ;

  return v8;
}

- (id)_indexPathsForVisibleSupplementaryViewsOfKind:(id)a3 isDecorationView:(BOOL)a4
{
  v6 = a3;
  [(UICollectionView *)self _reloadDataIfNeeded];
  subviewManager = self->_subviewManager;
  if (a4)
  {
    [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleDecorationsOfKind:v6];
  }

  else
  {
    [(_UICollectionViewSubviewManager *)subviewManager indexPathsForVisibleSupplementariesOfKind:v6];
  }
  v8 = ;

  return v8;
}

- (BOOL)_validateScrollingTargetIndexPath:(id)a3 raisingExceptionIfNecessary:(BOOL)a4
{
  v4 = a4;
  v40 = *MEMORY[0x1E69E9840];
  v7 = a3;
  v8 = [v7 section];
  if (v8 >= [(UICollectionViewData *)self->_collectionViewData numberOfSections])
  {
    if (!v4)
    {
LABEL_22:
      v9 = 0;
      goto LABEL_23;
    }

    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      v10 = [MEMORY[0x1E696AAA8] currentHandler];
      [v10 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8188 description:{@"Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@.", objc_msgSend(v7, "section"), -[UICollectionViewData numberOfSections](self->_collectionViewData), self, v31}];
LABEL_13:

      goto LABEL_22;
    }

    if (!os_variant_has_internal_diagnostics())
    {
      v13 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924A0) + 8);
      if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_22;
      }

      v14 = v13;
      v15 = [v7 section];
      v16 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
      *buf = 134218498;
      v33 = v15;
      v34 = 2048;
      v35 = v16;
      v36 = 2112;
      v37 = self;
      v17 = "Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
      v18 = v14;
      v19 = 32;
      goto LABEL_20;
    }

    v14 = __UIFaultDebugAssertLog();
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_FAULT))
    {
      goto LABEL_21;
    }

    v24 = [v7 section];
    v25 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
    *buf = 134218498;
    v33 = v24;
    v34 = 2048;
    v35 = v25;
    v36 = 2112;
    v37 = self;
    v26 = "Attempted to scroll the collection view to an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
    v27 = v14;
    v28 = 32;
LABEL_28:
    _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, v26, buf, v28);
    goto LABEL_21;
  }

  if ([v7 item] == 0x7FFFFFFFFFFFFFFFLL)
  {
    v9 = 1;
    goto LABEL_23;
  }

  v11 = [v7 item];
  v9 = v11 < -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v7 section]);
  if (!v9 && v4)
  {
    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      v10 = [MEMORY[0x1E696AAA8] currentHandler];
      [v10 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8201 description:{@"Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@.", objc_msgSend(v7, "item"), -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, objc_msgSend(v7, "section")), objc_msgSend(v7, "section"), self}];
      goto LABEL_13;
    }

    if (!os_variant_has_internal_diagnostics())
    {
      v20 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924A8) + 8);
      if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_22;
      }

      v14 = v20;
      v21 = [v7 item];
      v22 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v7 section]);
      *buf = 134218754;
      v33 = v21;
      v34 = 2048;
      v35 = v22;
      v36 = 2048;
      v37 = [v7 section];
      v38 = 2112;
      v39 = self;
      v17 = "Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
      v18 = v14;
      v19 = 42;
LABEL_20:
      _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, v17, buf, v19);
LABEL_21:

      goto LABEL_22;
    }

    v14 = __UIFaultDebugAssertLog();
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_FAULT))
    {
      goto LABEL_21;
    }

    v29 = [v7 item];
    v30 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v7 section]);
    *buf = 134218754;
    v33 = v29;
    v34 = 2048;
    v35 = v30;
    v36 = 2048;
    v37 = [v7 section];
    v38 = 2112;
    v39 = self;
    v26 = "Attempted to scroll the collection view to an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
    v27 = v14;
    v28 = 42;
    goto LABEL_28;
  }

LABEL_23:

  return v9;
}

- (BOOL)_validateSelectionOrHighlightIndexPath:(id)a3 isSelection:(BOOL)a4 allowMassIndexPath:(BOOL)a5 assertIfInvalid:(BOOL)a6
{
  v6 = a6;
  v8 = a4;
  v52 = *MEMORY[0x1E69E9840];
  v11 = a3;
  if (dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _reloadDataIfNeeded];
  }

  if (v11 && [v11 section] != 0x7FFFFFFFFFFFFFFFLL && objc_msgSend(v11, "item") != 0x7FFFFFFFFFFFFFFFLL)
  {
    v12 = [v11 section];
    if (v12 >= [(UICollectionViewData *)self->_collectionViewData numberOfSections])
    {
      if (!v6)
      {
LABEL_17:
        a5 = 0;
        goto LABEL_18;
      }

      _UIIsPrivateMainBundle();
      if (dyld_program_sdk_at_least())
      {
        v15 = [MEMORY[0x1E696AAA8] currentHandler];
        if (v8)
        {
          v18 = @"selection";
        }

        else
        {
          v18 = @"highlight";
        }

        [v15 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8228 description:{@"Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@.", v18, objc_msgSend(v11, "section"), -[UICollectionViewData numberOfSections](self->_collectionViewData), self, v41}];
        goto LABEL_24;
      }

      if (!os_variant_has_internal_diagnostics())
      {
        v19 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924B0) + 8);
        if (!os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_17;
        }

        if (v8)
        {
          v20 = @"selection";
        }

        else
        {
          v20 = @"highlight";
        }

        v21 = v19;
        v22 = [v11 section];
        v23 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
        *buf = 138413058;
        v43 = v20;
        v44 = 2048;
        v45 = v22;
        v46 = 2048;
        v47 = v23;
        v48 = 2112;
        v49 = self;
        v24 = "Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
        v25 = v21;
        v26 = 42;
LABEL_37:
        _os_log_impl(&dword_188A29000, v25, OS_LOG_TYPE_ERROR, v24, buf, v26);

        goto LABEL_17;
      }

      v31 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v31, OS_LOG_TYPE_FAULT))
      {
LABEL_44:

        goto LABEL_17;
      }

      if (v8)
      {
        v32 = @"selection";
      }

      else
      {
        v32 = @"highlight";
      }

      v33 = [v11 section];
      v34 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
      *buf = 138413058;
      v43 = v32;
      v44 = 2048;
      v45 = v33;
      v46 = 2048;
      v47 = v34;
      v48 = 2112;
      v49 = self;
      v35 = "Attempted to modify the %@ of an item in an out-of-bounds section (%ld) when there are only %ld sections. Collection view: %@. This will become an assert in a future version.";
      v36 = v31;
      v37 = 42;
LABEL_49:
      _os_log_fault_impl(&dword_188A29000, v36, OS_LOG_TYPE_FAULT, v35, buf, v37);
      goto LABEL_44;
    }

    v13 = [v11 item];
    a5 = v13 < -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v11 section]);
    if (!a5 && v6)
    {
      _UIIsPrivateMainBundle();
      if (dyld_program_sdk_at_least())
      {
        v15 = [MEMORY[0x1E696AAA8] currentHandler];
        if (v8)
        {
          v16 = @"selection";
        }

        else
        {
          v16 = @"highlight";
        }

        [v15 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8236 description:{@"Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@.", v16, objc_msgSend(v11, "item"), -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, objc_msgSend(v11, "section")), objc_msgSend(v11, "section"), self}];
LABEL_24:

        goto LABEL_17;
      }

      if (!os_variant_has_internal_diagnostics())
      {
        v27 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924B8) + 8);
        if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_17;
        }

        if (v8)
        {
          v28 = @"selection";
        }

        else
        {
          v28 = @"highlight";
        }

        v21 = v27;
        v29 = [v11 item];
        v30 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v11 section]);
        *buf = 138413314;
        v43 = v28;
        v44 = 2048;
        v45 = v29;
        v46 = 2048;
        v47 = v30;
        v48 = 2048;
        v49 = [v11 section];
        v50 = 2112;
        v51 = self;
        v24 = "Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
        v25 = v21;
        v26 = 52;
        goto LABEL_37;
      }

      v31 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v31, OS_LOG_TYPE_FAULT))
      {
        goto LABEL_44;
      }

      if (v8)
      {
        v38 = @"selection";
      }

      else
      {
        v38 = @"highlight";
      }

      v39 = [v11 item];
      v40 = -[UICollectionViewData numberOfItemsInSection:](self->_collectionViewData, [v11 section]);
      *buf = 138413314;
      v43 = v38;
      v44 = 2048;
      v45 = v39;
      v46 = 2048;
      v47 = v40;
      v48 = 2048;
      v49 = [v11 section];
      v50 = 2112;
      v51 = self;
      v35 = "Attempted to modify the %@ of an out-of-bounds item (%ld) when there are only %ld items in section %ld. Collection view: %@. This will become an assert in a future version.";
      v36 = v31;
      v37 = 52;
      goto LABEL_49;
    }
  }

LABEL_18:

  return a5;
}

- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5
{
  trailing = a5.trailing;
  bottom = a5.bottom;
  leading = a5.leading;
  top = a5.top;
  v29 = *MEMORY[0x1E69E9840];
  v11 = a3;
  if ([(UICollectionView *)self _validateScrollingTargetIndexPath:v11 raisingExceptionIfNecessary:1])
  {
    v31.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:v11];
    x = v31.origin.x;
    y = v31.origin.y;
    width = v31.size.width;
    height = v31.size.height;
    if (!CGRectIsNull(v31))
    {
      [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v11 atScrollPosition:a4 additionalInsets:self itemFrame:1 containingScrollView:top clampToScrollableArea:leading, bottom, trailing, x, y, width, height];
      goto LABEL_7;
    }

    v16 = *(__UILogGetCategoryCachedImpl("UICollectionView", &_contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets____s_category) + 8);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v17 = v16;
      v18 = [v11 _ui_shortDescription];
      v25 = 138412546;
      v26 = v18;
      v27 = 2112;
      v28 = self;
      _os_log_impl(&dword_188A29000, v17, OS_LOG_TYPE_ERROR, "UICollectionView asked to scroll to invalid index path: %@ for which it cannot calculate a target content offset. Ensure your index path is valid. If this is a section index path, your section must have at least one item. Collection view: %@", &v25, 0x16u);
    }
  }

  [(UIScrollView *)self contentOffset];
LABEL_7:
  v21 = v19;
  v22 = v20;

  v23 = v21;
  v24 = v22;
  result.y = v24;
  result.x = v23;
  return result;
}

- (CGPoint)_contentOffsetForScrollingToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 itemFrame:(CGRect)a6 containingScrollView:(id)a7 clampToScrollableArea:(BOOL)a8
{
  v8 = a8;
  height = a6.size.height;
  width = a6.size.width;
  y = a6.origin.y;
  x = a6.origin.x;
  trailing = a5.trailing;
  bottom = a5.bottom;
  leading = a5.leading;
  top = a5.top;
  v19 = a3;
  v20 = a7;
  if (dyld_program_sdk_at_least() && [(UIScrollView *)v20 isPagingEnabled])
  {
    [(UIScrollView *)v20 _interpageSpacing];
    if (v22 == *MEMORY[0x1E695F060] && v21 == *(MEMORY[0x1E695F060] + 8))
    {
      [(UIScrollView *)v20 _pagingOrigin];
      if (v25 == *MEMORY[0x1E695EFF8] && v24 == *(MEMORY[0x1E695EFF8] + 8))
      {
        [(UIScrollView *)v20 _firstPageOffset];
        if (v76 == 0.0 && v75 == 0.0)
        {
          [(UIScrollView *)v20 _rectForPageContainingRect:x, y, width, height];
LABEL_76:
          v61 = v77;
          v63 = v78;
          goto LABEL_77;
        }
      }
    }
  }

  [(UIView *)v20 bounds];
  v97 = v27;
  v98 = v28;
  v94 = v29;
  v99 = v30;
  [(UIScrollView *)v20 _effectiveContentInset];
  v35 = 0.0;
  if (v31 >= 0.0)
  {
    v36 = v31;
  }

  else
  {
    v36 = 0.0;
  }

  if (v32 >= 0.0)
  {
    v37 = v32;
  }

  else
  {
    v37 = 0.0;
  }

  if (v33 >= 0.0)
  {
    v38 = v33;
  }

  else
  {
    v38 = 0.0;
  }

  v95 = v38;
  v96 = v36;
  if (v34 >= 0.0)
  {
    v39 = v34;
  }

  else
  {
    v39 = 0.0;
  }

  v93 = v39;
  [(UICollectionViewLayout *)self->_layout _supplementaryViewInsetsForScrollingToItemAtIndexPath:v19];
  v40 = bottom;
  v42 = top + v41;
  v44 = leading + v43;
  v46 = v40 + v45;
  v48 = trailing + v47;
  v49 = [(UIScrollView *)v20 _contentScrollableAxes];
  if (v49 == 2)
  {
    v50 = 0.0;
  }

  else
  {
    v50 = v48;
  }

  if (v49 == 2)
  {
    v51 = 0.0;
  }

  else
  {
    v51 = v44;
  }

  if (v49 == 1)
  {
    v50 = v48;
    v52 = 0.0;
  }

  else
  {
    v52 = v46;
  }

  if (v49 == 1)
  {
    v51 = v44;
    v53 = 0.0;
  }

  else
  {
    v53 = v42;
  }

  if (v49)
  {
    v54 = v50;
  }

  else
  {
    v54 = 0.0;
  }

  if (v49)
  {
    v55 = v52;
  }

  else
  {
    v55 = 0.0;
  }

  if (v49)
  {
    v56 = v51;
  }

  else
  {
    v56 = 0.0;
  }

  if (v49)
  {
    v35 = v53;
  }

  v57 = [(UIScrollView *)v20 _contentInsetAdjustmentBehavior:v50];
  [(UICollectionView *)self _contentOffsetFromProposedOffset:a4 forScrollingToItemWithFrame:*&v35 atScrollPosition:*&v56 additionalInsets:*&v55 containingScrollViewBounds:*&v54, v97 + v37, v94 + v96, v98 - (v37 + v93), v99 - (v96 + v95)];
  [(UICollectionViewLayout *)self->_layout _contentOffsetFromProposedContentOffset:v19 forScrollingToItemAtIndexPath:a4 atScrollPosition:v58 - v37, v59 - v96];
  v61 = v60;
  v63 = v62;
  if (v57 != 2)
  {
    v64 = [(UIScrollView *)v20 _scrollDetentOffsets];
    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke;
    aBlock[3] = &unk_1E70FF4A8;
    v65 = v64;
    v102 = v65;
    v66 = _Block_copy(aBlock);
    if (!(v66[2])(v63))
    {
      v67 = [v65 lastObject];
      [v67 doubleValue];
      v69 = v68;

      v70 = [v65 firstObject];
      [v70 doubleValue];
      v72 = v71;

      if (v94 <= v72 && v94 >= v69 && v63 > v69 && !v66[2](v66, v94))
      {
        v73 = fmax(v72 - v94, 0.0);
        if (a4)
        {
          v63 = v63 + v73;
        }

        else
        {
          v74 = v63 + v73 * 0.5;
          if ((a4 & 2) != 0)
          {
            v63 = v74;
          }
        }
      }

      if (v63 < v72 && v63 > v69)
      {
        v80 = 0;
        while ([v65 count] - 1 > v80)
        {
          v81 = [v65 objectAtIndexedSubscript:v80];
          [v81 doubleValue];
          v83 = v82;

          v84 = [v65 objectAtIndexedSubscript:++v80];
          [v84 doubleValue];
          v86 = v85;

          if (v63 < v83 && v63 > v86)
          {
            v63 = v83;
            break;
          }
        }
      }
    }
  }

  if (v8)
  {
    if (v20 == self)
    {
      [(UICollectionViewData *)self->_collectionViewData collectionViewContentRect];
    }

    else
    {
      [(UIScrollView *)v20 contentSize];
      v88 = v87;
      v90 = v89;
    }

    v77 = [(UICollectionView *)self _clampedContentOffset:v20 forScrollableAreaGivenContentSize:v61 inScrollView:v63, v88, v90];
    goto LABEL_76;
  }

LABEL_77:

  v91 = v61;
  v92 = v63;
  result.y = v92;
  result.x = v91;
  return result;
}

BOOL __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke(uint64_t a1, double a2)
{
  v2 = *(a1 + 32);
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __151__UICollectionView__contentOffsetForScrollingToItemAtIndexPath_atScrollPosition_additionalInsets_itemFrame_containingScrollView_clampToScrollableArea___block_invoke_2;
  v4[3] = &__block_descriptor_40_e25_B32__0__NSNumber_8Q16_B24l;
  *&v4[4] = a2;
  return [v2 indexOfObjectPassingTest:v4] != 0x7FFFFFFFFFFFFFFFLL;
}

- (void)_contentOffsetFromProposedOffset:(double)a3 forScrollingToItemWithFrame:(CGFloat)a4 atScrollPosition:(CGFloat)a5 additionalInsets:(CGFloat)a6 containingScrollViewBounds:(CGFloat)a7
{
  v28 = a13;
  if ([a1 _shouldReverseLayoutDirection])
  {
    if ([a1 _flipsHorizontalAxis])
    {
      v29 = a13;
    }

    else
    {
      v29 = a15;
    }

    v28 = v29;
  }

  if (a9)
  {
    if ((a9 & 6) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple vertical positioning styles"];
    }

    v38.origin.x = a4;
    v38.origin.y = a5;
    v38.size.width = a6;
    v38.size.height = a7;
    CGRectGetMinY(v38);
  }

  else
  {
    if ((a9 & 2) != 0)
    {
      if ((a9 & 4) != 0)
      {
        [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple vertical positioning styles"];
      }

      v40.origin.x = a4;
      v40.origin.y = a5;
      v40.size.width = a6;
      v40.size.height = a7;
      CGRectGetMidY(v40);
      v41.origin.x = a16;
      v41.origin.y = a17;
      v41.size.width = a18;
      v41.size.height = a19;
      CGRectGetHeight(v41);
      if ((a9 & 8) != 0)
      {
        goto LABEL_23;
      }

      goto LABEL_15;
    }

    if ((a9 & 4) != 0)
    {
      v36.origin.x = a4;
      v36.origin.y = a5;
      v36.size.width = a6;
      v36.size.height = a7;
      CGRectGetMaxY(v36);
      v37.origin.x = a16;
      v37.origin.y = a17;
      v37.size.width = a18;
      v37.size.height = a19;
      CGRectGetHeight(v37);
      if ((a9 & 8) != 0)
      {
        goto LABEL_23;
      }

      goto LABEL_15;
    }
  }

  if ((a9 & 8) != 0)
  {
LABEL_23:
    if ((a9 & 0x30) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple horizontal positioning styles"];
    }

    v42.origin.x = a4;
    v42.origin.y = a5;
    v42.size.width = a6;
    v42.size.height = a7;
    CGRectGetMinX(v42);
    return;
  }

LABEL_15:
  if ((a9 & 0x10) != 0)
  {
    if ((a9 & 0x20) != 0)
    {
      [MEMORY[0x1E695DF30] raise:*MEMORY[0x1E695D940] format:@"attempt to use a scroll position with multiple horizontal positioning styles"];
    }

    v43.origin.x = a4;
    v43.origin.y = a5;
    v43.size.width = a6;
    v43.size.height = a7;
    CGRectGetMidX(v43);
    v44.origin.x = a16;
    v44.origin.y = a17;
    v44.size.width = a18;
    v44.size.height = a19;
    CGRectGetWidth(v44);
  }

  else if ((a9 & 0x20) != 0)
  {
    v45.origin.x = a4;
    v45.origin.y = a5;
    v45.size.width = a6;
    v45.size.height = a7;
    CGRectGetMaxX(v45);
    v46.origin.x = a16;
    v46.origin.y = a17;
    v46.size.width = a18;
    v46.size.height = a19;
    CGRectGetWidth(v46);
  }

  else if (!a9)
  {
    v39.origin.x = a16;
    v39.origin.y = a17;
    v39.size.width = a18;
    v39.size.height = a19;
    v59.origin.x = a4;
    v59.origin.y = a5;
    v59.size.width = a6;
    v59.size.height = a7;
    if (!CGRectContainsRect(v39, v59))
    {
      v47.origin.x = a4;
      v47.origin.y = a5;
      v47.size.width = a6;
      v47.size.height = a7;
      v33 = a4;
      v30 = CGRectGetMinY(v47) - a12;
      v48.origin.x = a16;
      v48.origin.y = a17;
      v48.size.width = a18;
      v48.size.height = a19;
      if (v30 >= CGRectGetMinY(v48))
      {
        v31 = v33;
        v49.origin.x = v33;
        v49.origin.y = a5;
        v49.size.width = a6;
        v49.size.height = a7;
        MaxY = CGRectGetMaxY(v49);
        v50.origin.x = a16;
        v50.origin.y = a17;
        v50.size.width = a18;
        v50.size.height = a19;
        if (MaxY > CGRectGetMaxY(v50))
        {
          v51.origin.x = v33;
          v51.origin.y = a5;
          v51.size.width = a6;
          v51.size.height = a7;
          CGRectGetMaxY(v51);
          v52.origin.x = a16;
          v52.origin.y = a17;
          v52.size.width = a18;
          v52.size.height = a19;
          CGRectGetHeight(v52);
          dyld_program_sdk_at_least();
        }
      }

      else
      {
        v31 = v33;
      }

      v53.origin.x = v31;
      v53.origin.y = a5;
      v53.size.width = a6;
      v53.size.height = a7;
      v32 = CGRectGetMinX(v53) - v28;
      v54.origin.x = a16;
      v54.origin.y = a17;
      v54.size.width = a18;
      v54.size.height = a19;
      if (v32 >= CGRectGetMinX(v54))
      {
        v55.origin.x = v31;
        v55.origin.y = a5;
        v55.size.width = a6;
        v55.size.height = a7;
        MaxX = CGRectGetMaxX(v55);
        v56.origin.x = a16;
        v56.origin.y = a17;
        v56.size.width = a18;
        v56.size.height = a19;
        if (MaxX > CGRectGetMaxX(v56))
        {
          v57.origin.x = v31;
          v57.origin.y = a5;
          v57.size.width = a6;
          v57.size.height = a7;
          CGRectGetMaxX(v57);
          v58.origin.x = a16;
          v58.origin.y = a17;
          v58.size.width = a18;
          v58.size.height = a19;
          CGRectGetWidth(v58);
          dyld_program_sdk_at_least();
        }
      }
    }
  }
}

- (void)scrollToItemAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UICollectionViewScrollPosition)scrollPosition animated:(BOOL)animated
{
  v5 = animated;
  v8 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:indexPath];

  [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v8 atScrollPosition:scrollPosition additionalInsets:v5 animated:0.0, 0.0, 0.0, 0.0];
}

- (void)_scrollToItemAtIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 animated:(BOOL)a6
{
  v6 = a6;
  trailing = a5.trailing;
  bottom = a5.bottom;
  leading = a5.leading;
  top = a5.top;
  v13 = [(UICollectionView *)self _translateDataSourceIndexPathToPresentationIndexPathAsNeeded:a3];
  [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v13 atScrollPosition:a4 additionalInsets:v6 animated:top, leading, bottom, trailing];
}

- (void)_scrollToItemAtPresentationIndexPath:(id)a3 atScrollPosition:(unint64_t)a4 additionalInsets:(NSDirectionalEdgeInsets)a5 animated:(BOOL)a6
{
  v6 = a6;
  trailing = a5.trailing;
  bottom = a5.bottom;
  leading = a5.leading;
  top = a5.top;
  v49 = *MEMORY[0x1E69E9840];
  v13 = a3;
  [(UICollectionView *)self _reloadDataIfNeeded];
  if (!v13)
  {
    goto LABEL_25;
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  orthogonalScrollerController = self->_orthogonalScrollerController;
  if (orthogonalScrollerController && [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:v13])
  {
    [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa scrollToItemAtIndexPath:v13 atScrollPosition:a4 additionalInsets:v6 animated:top, leading, bottom, trailing];
    if (!dyld_program_sdk_at_least())
    {
      goto LABEL_25;
    }

    v15 = 0;
  }

  else
  {
    v15 = 1;
  }

  [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v13 atScrollPosition:a4 additionalInsets:top, leading, bottom, trailing];
  v17 = v16;
  v19 = v18;
  if (v6 || [(UIScrollView *)self contentInsetAdjustmentBehavior]== UIScrollViewContentInsetAdjustmentNever)
  {
    goto LABEL_14;
  }

  [(UIScrollView *)self _effectiveContentInset];
  v21 = v20;
  v23 = v22;
  v39 = v24;
  v40 = v25;
  [(UICollectionView *)self setContentOffset:0 animated:v17, v19];
  [(UIScrollView *)self _effectiveContentInset];
  if (v23 != v29 || v21 != v26 || v40 != v28 || v39 != v27)
  {
    [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v13 atScrollPosition:a4 additionalInsets:top, leading, bottom, trailing];
    v17 = v30;
    v19 = v31;
LABEL_14:
    [(UICollectionView *)self setContentOffset:v6 animated:v17, v19];
  }

  if (dyld_program_sdk_at_least() && (v15 & [(UICollectionViewLayout *)self->_layout _estimatesSizes]) == 1)
  {
    v50.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:v13];
    x = v50.origin.x;
    y = v50.origin.y;
    width = v50.size.width;
    height = v50.size.height;
    if (CGRectIsNull(v50))
    {
      v36 = *(__UILogGetCategoryCachedImpl("UICollectionView", &_scrollToItemAtPresentationIndexPath_atScrollPosition_additionalInsets_animated____s_category) + 8);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        v37 = v36;
        *buf = 138413058;
        v42 = objc_opt_class();
        v43 = 2048;
        v44 = self;
        v45 = 2112;
        v46 = v13;
        v47 = 2112;
        v48 = self;
        _os_log_impl(&dword_188A29000, v37, OS_LOG_TYPE_ERROR, "<%@ %p> received null target element frame for scrolling target at index path %@. Scrolling may not function correctly. \nCollection View: %@", buf, 0x2Au);
      }
    }

    else
    {
      [(UICollectionView *)&self->super.super.super.super.isa _storeScrollingTargetInfoForIndexPath:v13 frame:a4 scrollPosition:x additionalInsets:y, width, height, top, leading, bottom, trailing];
      v38 = 0x10000;
      if (v6)
      {
        if ([(UIScrollView *)self isScrollAnimating])
        {
          v38 = 0;
        }

        else
        {
          v38 = 0x10000;
        }
      }

      *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFEFFFF | v38;
    }
  }

LABEL_25:
}

- (void)_scrollViewAnimationEnded:(id)a3 finished:(BOOL)a4
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _scrollViewAnimationEnded:a3 finished:a4];
  if (self->_scrollingTargetIndexPath)
  {
    if ((*(&self->_collectionViewFlags + 9) & 4) != 0)
    {
      *(&self->_collectionViewFlags + 4) |= 0x10000u;
    }

    else
    {
      [(UICollectionView *)self _clearTargetIndexPathForScrolling];
    }
  }
}

- (void)_stopScrollingNotify:(BOOL)a3 pin:(BOOL)a4
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _stopScrollingNotify:a3 pin:a4];
  [(UICollectionView *)self _clearTargetIndexPathForScrolling];
}

- (void)setContentInset:(UIEdgeInsets)a3
{
  right = a3.right;
  bottom = a3.bottom;
  left = a3.left;
  top = a3.top;
  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIScrollView *)&v20 setContentInset:?];
  if (!dyld_program_sdk_at_least() || (([(UIScrollView *)self contentInset], left == v11) ? (v12 = top == v8) : (v12 = 0), v12 ? (v13 = right == v10) : (v13 = 0), v13 ? (v14 = bottom == v9) : (v14 = 0), !v14))
  {
    v15 = [(UICollectionView *)self _horizontalIndexTitleBar];

    if (v15)
    {
      v16 = [(UICollectionView *)self _horizontalIndexTitleBar];
      [v16 _setParentContentInset:{top, left, bottom, right}];
    }

    collectionViewData = self->_collectionViewData;
    if (collectionViewData)
    {
      v18 = (*&collectionViewData->_collectionViewDataFlags >> 3) & 1;
    }

    else
    {
      v18 = 0;
    }

    viewFlags = self->super.super._viewFlags;
    if (dyld_program_sdk_at_least() && v18 && (viewFlags & 0x4000000000000000) == 0)
    {
      [(UICollectionViewLayout *)self->_layout invalidateLayout];
    }

    if (+[UIView _isInAnimationBlock])
    {
      [(UIView *)self layoutBelowIfNeeded];
    }
  }
}

- (void)setContentOffset:(CGPoint)a3 animated:(BOOL)a4
{
  v4 = a4;
  y = a3.y;
  x = a3.x;
  [(UIScrollView *)self contentOffset];
  if (x != v9 || y != v8)
  {
    [(UIView *)self bounds];
    v12 = v11;
    v14 = v13;
    v16 = v15;
    v18 = v17;
    debugger = self->_debugger;
    if (debugger)
    {
      [(UIScrollView *)self contentOffset];
      [_UICollectionViewFeedbackLoopDebugger recordCollectionViewPointPropertyChange:"recordCollectionViewPointPropertyChange:fromPoint:toPoint:" fromPoint:@"contentOffset" toPoint:?];
    }

    collectionViewData = self->_collectionViewData;
    if (collectionViewData && (*&collectionViewData->_collectionViewDataFlags & 8) != 0 && [(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForBoundsChange:x, y, v16, v18])
    {
      v21 = [(UICollectionViewLayout *)self->_layout _invalidationContextForBoundsChange:x fromOldBounds:y, v16, v18, v12, v14, v16, v18];
      [(UICollectionViewLayout *)self->_layout _invalidateLayoutUsingContext:v21];
    }
  }

  if (v4 && ([(UICollectionView *)self _customScrollAnimation], (v22 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v23 = v22;
    [(UIScrollView *)self _setContentOffset:v22 animation:x, y];
  }

  else
  {
    v24.receiver = self;
    v24.super_class = UICollectionView;
    [(UIScrollView *)&v24 setContentOffset:v4 animated:x, y];
  }
}

- (void)_setShouldResetInitialLayoutOnDataSourceChange:(BOOL)a3
{
  if (a3)
  {
    v3 = 4096;
  }

  else
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFFFEFFF | v3;
}

- (void)setContentOffset:(CGPoint)a3
{
  v4.receiver = self;
  v4.super_class = UICollectionView;
  [(UIScrollView *)&v4 setContentOffset:a3.x, a3.y];
  [(UICollectionView *)self layoutHorizontalIndexTitleBar];
}

+ (id)_reuseKeyForSupplementaryViewOfKind:(id)a3 withReuseIdentifier:(id)a4
{
  if (qword_1ED4924D0 != a3 || qword_1ED4924D8 != a4)
  {
    v6 = a4;
    v7 = a3;
    v8 = [v7 length];
    v9 = v8 + [v6 length] + 1;
    v10 = malloc_type_malloc(2 * v9, 0x1000040BDFB0063uLL);
    [v7 getCharacters:v10];
    v11 = &v10[2 * v8];
    *v11 = 47;
    [v6 getCharacters:v11 + 2];
    v12 = [objc_alloc(MEMORY[0x1E696AEC0]) initWithCharactersNoCopy:v10 length:v9 freeWhenDone:1];
    v13 = qword_1ED4924E0;
    qword_1ED4924E0 = v12;

    v14 = [v7 copy];
    v15 = qword_1ED4924D0;
    qword_1ED4924D0 = v14;

    v16 = [v6 copy];
    v17 = qword_1ED4924D8;
    qword_1ED4924D8 = v16;
  }

  v18 = qword_1ED4924E0;

  return v18;
}

- (void)_scrollViewWillEndDraggingWithVelocity:(CGPoint)a3 targetContentOffset:(CGPoint *)a4
{
  [(UICollectionViewLayout *)self->_layout targetContentOffsetForProposedContentOffset:a4->x withScrollingVelocity:a4->y, a3.x, a3.y];
  a4->x = v5;
  a4->y = v6;
}

- (CGPoint)_adjustFocusContentOffset:(CGPoint)a3 toShowFocusItemWithInfo:(id)a4
{
  y = a3.y;
  x = a3.x;
  v7 = a4;
  v8 = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (v8 && (v9 = v8, -[UICollectionView _horizontalIndexTitleBar](self, "_horizontalIndexTitleBar"), v10 = objc_claimAutoreleasedReturnValue(), [v7 item], v11 = objc_claimAutoreleasedReturnValue(), _UIFocusEnvironmentContainingView(v11), v12 = objc_claimAutoreleasedReturnValue(), v13 = objc_msgSend(v10, "_isViewEntryCell:", v12), v12, v11, v10, v9, v13))
  {
    [(UIScrollView *)self contentOffset];
  }

  else
  {
    v20.receiver = self;
    v20.super_class = UICollectionView;
    [(UIScrollView *)&v20 _adjustFocusContentOffset:v7 toShowFocusItemWithInfo:x, y];
  }

  v16 = v14;
  v17 = v15;

  v18 = v16;
  v19 = v17;
  result.y = v19;
  result.x = v18;
  return result;
}

- (unint64_t)_focusPrimaryScrollableAxis
{
  v3 = [(UICollectionView *)self collectionViewLayout];
  v4 = [v3 _layoutAxis];

  if (v4 - 1 >= 2)
  {
    v6.receiver = self;
    v6.super_class = UICollectionView;
    return [(UIScrollView *)&v6 _focusPrimaryScrollableAxis];
  }

  return v4;
}

- (void)_setShouldPreventFocusScrollPastContentSize:(BOOL)a3
{
  v3 = a3;
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _setShouldPreventFocusScrollPastContentSize:?];
  [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController setShouldPreventFocusScrollPastContentSize:v3];
}

- (id)_createStaticScrollBar
{
  v2 = [_UIIndexBarStaticScrollAccessory alloc];
  v3 = [(_UIStaticScrollBar *)v2 initWithFrame:*MEMORY[0x1E695F058], *(MEMORY[0x1E695F058] + 8), *(MEMORY[0x1E695F058] + 16), *(MEMORY[0x1E695F058] + 24)];

  return v3;
}

- (void)_setUsesStaticScrollBar:(BOOL)a3
{
  v3 = a3;
  v5 = [(UIScrollView *)self _staticScrollBar];

  v6.receiver = self;
  v6.super_class = UICollectionView;
  [(UIScrollView *)&v6 _setUsesStaticScrollBar:v3];
  if ((v5 == 0) == v3)
  {
    [(UICollectionView *)self _reloadSectionIndexTitles];
  }
}

- (id)_indexPathForEntryWithTitle:(id)a3 atIndex:(int64_t)a4 validateTitles:(BOOL)a5
{
  v5 = a5;
  v9 = a3;
  if (v5)
  {
    v10 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v11 = [v10 count];

    if (!v11)
    {
LABEL_14:
      v13 = 0;
      goto LABEL_15;
    }
  }

  if ((*(&self->_collectionViewFlags + 7) & 0x40) == 0 || (v12 = objc_loadWeakRetained(&self->_dataSource), [v12 _collectionView:self indexPathForSectionIndexTitle:v9 atIndex:a4], v13 = objc_claimAutoreleasedReturnValue(), v12, !v13))
  {
    if ((*(&self->_collectionViewFlags + 8) & 4) == 0 || (WeakRetained = objc_loadWeakRetained(&self->_dataSource), [WeakRetained collectionView:self indexPathForIndexTitle:v9 atIndex:a4], v13 = objc_claimAutoreleasedReturnValue(), WeakRetained, !v13))
    {
      if ([(UICollectionViewData *)self->_collectionViewData numberOfSections]> a4 && [(UICollectionViewData *)self->_collectionViewData numberOfItemsInSection:a4]>= 1)
      {
        v13 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:a4];
        goto LABEL_15;
      }

      goto LABEL_14;
    }
  }

  v15 = [v13 section];
  if (-[UICollectionView numberOfSections](self, "numberOfSections") <= v15 || [v13 item] != 0x7FFFFFFFFFFFFFFFLL && (v16 = -[UICollectionView numberOfItemsInSection:](self, "numberOfItemsInSection:", v15), v16 <= objc_msgSend(v13, "item")))
  {
    v17 = [MEMORY[0x1E696AAA8] currentHandler];
    [v17 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:8951 description:{@"no cell for index path (%@) - the collection view's data source must return an index path for a valid UICollectionViewCell from -collectionView:indexPathForIndexTitle:atIndex:", v13}];
  }

LABEL_15:

  return v13;
}

- (void)accessoryInsetsDidChange:(UIEdgeInsets)a3
{
  right = a3.right;
  bottom = a3.bottom;
  left = a3.left;
  top = a3.top;
  v29 = *MEMORY[0x1E69E9840];
  v24.receiver = self;
  v24.super_class = UICollectionView;
  [(UIScrollView *)&v24 accessoryInsetsDidChange:?];
  [(UIScrollView *)self accessoryInsets];
  if (v9 != left || v8 != top || v11 != right || v10 != bottom)
  {
    v15 = v8;
    v16 = v9;
    v17 = v10;
    v18 = v11;
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &accessoryInsetsDidChange____s_category);
    if (*CategoryCachedImpl)
    {
      v20 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        v21 = v20;
        v30.top = top;
        v30.left = left;
        v30.bottom = bottom;
        v30.right = right;
        v22 = NSStringFromUIEdgeInsets(v30);
        v31.top = v15;
        v31.left = v16;
        v31.bottom = v17;
        v31.right = v18;
        v23 = NSStringFromUIEdgeInsets(v31);
        *buf = 138412546;
        v26 = v22;
        v27 = 2112;
        v28 = v23;
        _os_log_impl(&dword_188A29000, v21, OS_LOG_TYPE_ERROR, "Invalidating layout due to [UICollectionView accessoryInsetsDidChange:] previousInsets: %@, newInsets: %@", buf, 0x16u);
      }
    }

    [(UICollectionView *)self _invalidateLayoutForUpdatedLayoutMarginsIfNeeded];
  }
}

- (BOOL)indexBarView:(id)a3 didSelectEntry:(id)a4 atIndex:(int64_t)a5
{
  v49 = *MEMORY[0x1E69E9840];
  v7 = a4;
  v8 = [v7 title];
  v9 = [v7 indexPath];

  if (!v9)
  {
    v10 = [(UICollectionView *)self _indexPathForEntryWithTitle:v8 atIndex:a5 validateTitles:1];
    if (!v10)
    {
      v25 = 0;
      goto LABEL_20;
    }

    v9 = v10;
  }

  [(UIScrollView *)self contentOffset];
  v12 = v11;
  v14 = v13;
  v15 = [(UIView *)self _focusBehavior];
  if ([v15 refinesIndexBarTargetContentOffset])
  {
    v16 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
    v17 = [v16 scrollManager];
    if (v17)
    {
      v50.origin.x = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:v9];
      x = v50.origin.x;
      y = v50.origin.y;
      width = v50.size.width;
      height = v50.size.height;
      if (CGRectIsNull(v50))
      {
        v22 = *(__UILogGetCategoryCachedImpl("UICollectionView", &indexBarView_didSelectEntry_atIndex____s_category) + 8);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
        {
          v23 = v22;
          v39 = 138413314;
          v40 = objc_opt_class();
          v41 = 2048;
          v42 = self;
          v43 = 2048;
          v44 = a5;
          v45 = 2112;
          v46 = v9;
          v47 = 2112;
          v48 = self;
          _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "<%@ %p> received null target element frame for scrolling to index bar entry index (%ld) at index path %@. Scrolling may not function correctly. \nCollection View: %@", &v39, 0x34u);
        }
      }

      else
      {
        [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v9 atScrollPosition:1 additionalInsets:0.0, 0.0, 0.0, 0.0];
        v27 = v26;
        v29 = v28;
        v30 = [(UIScrollView *)self _focusTuple];
        [v17 contentOffsetForEnvironmentScrollableContainer:v30 toShowRect:x targetOffset:{y, width, height, v27, v29}];
        v32 = v31;
        v34 = v33;

        [(UICollectionView *)self setContentOffset:0 animated:v32, v34];
      }
    }
  }

  else
  {
    if ((*(&self->super.super._viewFlags + 2) & 0x400000) != 0)
    {
      v24 = 33;
    }

    else
    {
      v24 = 9;
    }

    [(UICollectionView *)self _scrollToItemAtIndexPath:v9 atScrollPosition:v24 additionalInsets:0 animated:0.0, 0.0, 0.0, 0.0];
  }

  [(UIScrollView *)self contentOffset];
  v37 = vabdd_f64(v35, v12) >= 0.00000011920929;
  v25 = vabdd_f64(v36, v14) >= 0.00000011920929 || v37;

LABEL_20:
  return v25;
}

- (CGPoint)indexBarAccessoryView:(id)a3 contentOffsetForEntry:(id)a4 atIndex:(int64_t)a5
{
  v8 = a3;
  v9 = a4;
  v10 = [v9 title];
  v11 = [v9 indexPath];
  if (v11 || ([(UICollectionView *)self _indexPathForEntryWithTitle:v10 atIndex:a5 validateTitles:1], (v11 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v12 = v11;
    [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v11 atScrollPosition:1 additionalInsets:0.0, 0.0, 0.0, 0.0];
    v14 = v13;
    v16 = v15;
    v17 = [(UIView *)self _focusBehavior];
    if ([v17 refinesIndexBarTargetContentOffset])
    {
      v18 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
      v19 = [v18 scrollManager];
      if (v19)
      {
        v20 = [(UICollectionView *)self _frameOfElementAtScrollingTargetIndexPath:v12];
        v22 = v21;
        v24 = v23;
        v26 = v25;
        v27 = [(UIScrollView *)self _focusTuple];
        [v19 contentOffsetForEnvironmentScrollableContainer:v27 toShowRect:v20 targetOffset:{v22, v24, v26, v14, v16}];
        v14 = v28;
        v16 = v29;
      }
    }
  }

  else
  {
    v34.receiver = self;
    v34.super_class = UICollectionView;
    [(UIScrollView *)&v34 indexBarAccessoryView:v8 contentOffsetForEntry:v9 atIndex:a5];
    v14 = v32;
    v16 = v33;
  }

  v30 = v14;
  v31 = v16;
  result.y = v31;
  result.x = v30;
  return result;
}

- (CGPoint)_contentOffsetForLowFidelityScrollInDirection:(CGPoint)a3 duration:(double *)a4
{
  y = a3.y;
  x = a3.x;
  v79.receiver = self;
  v79.super_class = UICollectionView;
  [(UIScrollView *)&v79 _contentOffsetForLowFidelityScrollInDirection:a4 duration:?];
  v8 = v7;
  v10 = v9;
  if (y == 0.0 || ([(UIScrollView *)self contentSize], v12 = v11, [(UIView *)self bounds], v12 > v13))
  {
    if (x == 0.0 || ([(UIScrollView *)self contentSize], v15 = v14, [(UIView *)self bounds], v15 > v16))
    {
      if (!self || y >= 0.0 || ([(UIScrollView *)self _contentInsetIncludingDecorations], v10 + v17 > 0.001))
      {
        if (x >= 0.0 && (x <= 0.0 || ![(UIView *)self _shouldReverseLayoutDirection]|| [(UIView *)self _flipsHorizontalAxis]) || ([(UICollectionView *)self _isContentOffset:v8 atStartOfAxis:v10]& 1) == 0)
        {
          if ([(UIScrollView *)self isScrollAnimating])
          {
            [(UIScrollView *)self _animatedTargetOffset];
          }

          else
          {
            [(UIScrollView *)self contentOffset];
          }

          v20 = v18;
          v21 = v19;
          [(UIView *)self bounds];
          v23 = v22;
          v25 = v24;
          v26 = v20 + x * v22;
          v27 = v21 + y * v24;
          v76 = v29;
          v77 = v28;
          v30 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v28 validateLayout:v29, v22, v24];
          v31 = [(UICollectionViewLayout *)self->_layout _layoutAxis];
          v78[0] = MEMORY[0x1E69E9820];
          v78[1] = 3221225472;
          v78[2] = __75__UICollectionView__contentOffsetForLowFidelityScrollInDirection_duration___block_invoke;
          v78[3] = &unk_1E70FF030;
          v78[4] = self;
          v32 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:v30 amongCandidates:v31 onAxis:v78 shouldConsiderBlock:v26, v27];
          v33 = v32;
          if (v32)
          {
            v68 = v27;
            v69 = v26;
            [v32 frame];
            v74 = v35;
            v75 = v34;
            v72 = v37;
            v73 = v36;
            layout = self->_layout;
            v39 = [v33 indexPath];
            [(UICollectionViewLayout *)layout _supplementaryViewInsetsForScrollingToItemAtIndexPath:v39];
            v70 = v41;
            v71 = v40;
            v43 = v42;
            v45 = v44;

            if ([(UIView *)self _shouldReverseLayoutDirection])
            {
              v46 = [(UIView *)self _flipsHorizontalAxis];
              if (v46)
              {
                v47 = v43;
              }

              else
              {
                v47 = v45;
              }

              if (!v46)
              {
                v45 = v43;
              }

              v43 = v47;
            }

            if (y < 0.0)
            {
              v48 = 4;
            }

            else
            {
              if (y > 0.0)
              {
                v48 = 1;
              }

              else
              {
                v48 = 32;
              }

              if (y <= 0.0 && x >= 0.0)
              {
                if (x <= 0.0)
                {
                  v48 = 0;
                }

                else
                {
                  v48 = 8;
                }
              }
            }

            [(UIScrollView *)self _effectiveContentInset];
            v50 = v76 + v49;
            v53 = v23 - (v51 + v52);
            v55 = v25 - (v49 + v54);
            v81.origin.x = v43 + v77 + v51;
            v81.origin.y = v71 + v50;
            v81.size.width = v53 - (v43 + v45);
            v81.size.height = v55 - (v71 + v70);
            v82 = CGRectInset(v81, -0.1, -0.1);
            v83.origin.y = v74;
            v83.origin.x = v75;
            v83.size.height = v72;
            v83.size.width = v73;
            if (CGRectContainsRect(v82, v83))
            {
              if (y < 0.0)
              {
                v56 = v25 + v68;
              }

              else
              {
                v56 = v68;
              }

              if (x >= 0.0)
              {
                v57 = v69;
              }

              else
              {
                v57 = v23 + v69;
              }

              v58 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v69 validateLayout:v68, v23, v25];
              v59 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:v58 amongCandidates:[(UICollectionViewLayout *)self->_layout _layoutAxis] onAxis:&__block_literal_global_686_0 shouldConsiderBlock:v57, v56];
              v60 = v59;
              if (v59)
              {
                v61 = [v59 indexPath];
                [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v61 atScrollPosition:v48 additionalInsets:0.0, 0.0, 0.0, 0.0];
                v8 = v62;
                v10 = v63;
              }
            }

            else
            {
              v58 = [v33 indexPath];
              [(UICollectionView *)self _contentOffsetForScrollingToItemAtIndexPath:v58 atScrollPosition:v48 additionalInsets:0.0, 0.0, 0.0, 0.0];
              v8 = v64;
              v10 = v65;
            }
          }
        }
      }
    }
  }

  v66 = v8;
  v67 = v10;
  result.y = v67;
  result.x = v66;
  return result;
}

BOOL __75__UICollectionView__contentOffsetForLowFidelityScrollInDirection_duration___block_invoke(uint64_t a1, void *a2)
{
  v2 = *(*(a1 + 32) + 2984);
  v3 = [a2 indexPath];
  v4 = [(_UICollectionViewSubviewManager *)v2 visibleCellAtIndexPath:v3];
  v5 = v4 != 0;

  return v5;
}

- (id)_focusFastScrollingIndexBarEntries
{
  v3 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
  if ([v3 count])
  {
    v4 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke;
    v9[3] = &unk_1E70FF4D0;
    v9[4] = self;
    v5 = v4;
    v10 = v5;
    [v3 enumerateObjectsUsingBlock:v9];
    v6 = v10;
    v7 = v5;
  }

  else
  {
    v11.receiver = self;
    v11.super_class = UICollectionView;
    v7 = [(UIScrollView *)&v11 _focusFastScrollingIndexBarEntries];
  }

  return v7;
}

void __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke(uint64_t a1, void *a2, uint64_t a3)
{
  v5 = a2;
  v6 = [*(a1 + 32) _indexPathForEntryWithTitle:v5 atIndex:a3 validateTitles:0];
  if ([v6 length] == 1)
  {
    v7 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:{objc_msgSend(v6, "indexAtPosition:", 0)}];
  }

  else
  {
    v7 = v6;
  }

  v8 = v7;
  objc_initWeak(&location, *(a1 + 32));
  v12 = MEMORY[0x1E69E9820];
  v13 = 3221225472;
  v14 = __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke_2;
  v15 = &unk_1E70FF518;
  objc_copyWeak(&v18, &location);
  v9 = v6;
  v16 = v9;
  v10 = v8;
  v17 = v10;
  v11 = [_UIFocusFastScrollingIndexBarEntry entryWithTitle:v5 generator:&v12];
  [v11 setTargetFocusedIndexPath:{v10, v12, v13, v14, v15}];
  [*(a1 + 40) addObject:v11];

  objc_destroyWeak(&v18);
  objc_destroyWeak(&location);
}

double __54__UICollectionView__focusFastScrollingIndexBarEntries__block_invoke_2(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 48));
  if (os_variant_has_internal_diagnostics())
  {
    if (!WeakRetained)
    {
      v22 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
      {
        *buf = 0;
        _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "Index entry's weak reference to UICollectionView could not be resolved to strong reference.", buf, 2u);
      }

      goto LABEL_12;
    }
  }

  else if (!WeakRetained)
  {
    v23 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewLimitsCellsCreatedPerPass_block_invoke_8___s_category) + 8);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      *v25 = 0;
      _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "Index entry's weak reference to UICollectionView could not be resolved to strong reference.", v25, 2u);
    }

    goto LABEL_12;
  }

  [WeakRetained contentSize];
  if (v3 == 0.0 || ([WeakRetained contentSize], v4 == 0.0))
  {
LABEL_12:
    v21 = INFINITY;
    goto LABEL_13;
  }

  [WeakRetained _contentOffsetForScrollingToItemAtIndexPath:*(a1 + 32) atScrollPosition:1 additionalInsets:{0.0, 0.0, 0.0, 0.0}];
  v6 = v5;
  v8 = v7;
  v9 = [WeakRetained _collectionViewData];
  v10 = [(UICollectionViewData *)v9 rectForItemAtIndexPath:?];
  v12 = v11;
  v14 = v13;
  v16 = v15;

  v17 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:WeakRetained];
  v18 = [v17 scrollManager];
  v19 = [WeakRetained _focusTuple];
  [v18 contentOffsetForEnvironmentScrollableContainer:v19 toShowRect:v10 targetOffset:{v12, v14, v16, v6, v8}];
  v21 = v20;

LABEL_13:
  return v21;
}

- (void)_wheelChangedWithEvent:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _indexOverlayManager];
  v6 = [(UIView *)self _screen];
  if ([v6 _userInterfaceIdiom] != 3 || !v5 || !-[UICollectionView _wantsIndexOverlays](self, "_wantsIndexOverlays"))
  {

    goto LABEL_8;
  }

  v7 = [(UIView *)self _isFocusedOrAncestorOfFocusedView];

  if (!v7)
  {
LABEL_8:
    v10.receiver = self;
    v8 = &v10;
    goto LABEL_9;
  }

  if (([(_UICollectionTableIndexOverlayManager *)v5 handleWheelChangedEvent:v4]& 1) == 0)
  {
    v9 = self;
    v8 = &v9;
LABEL_9:
    v8->super_class = UICollectionView;
    [(objc_super *)v8 _wheelChangedWithEvent:v4, v9];
  }
}

- (void)_moveWithEvent:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _indexOverlayManager];
  v6 = v5;
  collectionViewData = self->_collectionViewData;
  if (collectionViewData && (collectionViewData->_totalItemCount >= 1 ? (v8 = v5 == 0) : (v8 = 1), !v8 && (*(v5 + 48) & 1) != 0))
  {
    [(_UICollectionTableIndexOverlayManager *)v5 handleMoveEvent:v4];
  }

  else
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIResponder *)&v9 _moveWithEvent:v4];
  }
}

- (int64_t)_currentSectionIndexTitleIndex
{
  currentIndexTitleIndex = self->_currentIndexTitleIndex;
  if (currentIndexTitleIndex != -1)
  {
    v4 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v5 = [v4 count];

    if (currentIndexTitleIndex < v5)
    {
      return self->_currentIndexTitleIndex;
    }
  }

  [(UIView *)self bounds];
  v8 = v7;
  v10 = v9;
  v13 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForCellsInRect:v7 validateLayout:v9, v11, v12];
  v14 = [(UICollectionView *)self _layoutAttributesClosestToReferencePoint:v13 amongCandidates:[(UICollectionViewLayout *)self->_layout _layoutAxis] onAxis:&__block_literal_global_697 shouldConsiderBlock:v8, v10];
  v15 = v14;
  v6 = 0x7FFFFFFFFFFFFFFFLL;
  if (v14)
  {
    v16 = [v14 indexPath];
    v17 = [v16 section];

    v18 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
    v21 = 0;
    v22 = &v21;
    v23 = 0x2020000000;
    v24 = 0x7FFFFFFFFFFFFFFFLL;
    v20[0] = MEMORY[0x1E69E9820];
    v20[1] = 3221225472;
    v20[2] = __50__UICollectionView__currentSectionIndexTitleIndex__block_invoke_2;
    v20[3] = &unk_1E70FF540;
    v20[5] = &v21;
    v20[6] = v17;
    v20[4] = self;
    [v18 enumerateObjectsUsingBlock:v20];
    v6 = v22[3];
    if (v6 == 0x7FFFFFFFFFFFFFFFLL)
    {
      if ([v18 count])
      {
        v6 = 0;
        v22[3] = 0;
      }

      else
      {
        v6 = v22[3];
      }
    }

    _Block_object_dispose(&v21, 8);
  }

  return v6;
}

void __50__UICollectionView__currentSectionIndexTitleIndex__block_invoke_2(void *a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v7 = a2;
  v8 = a1[4];
  v9 = a3;
  if ((v8[2728] & 4) != 0)
  {
    v12 = v7;
    v10 = [v8 _dataSourceProxy];
    v11 = [v10 collectionView:a1[4] indexPathForIndexTitle:v12 atIndex:a3];

    v9 = [v11 section];
    v7 = v12;
  }

  if (v9 == a1[6])
  {
    *(*(a1[5] + 8) + 24) = a3;
    *a4 = 1;
  }
}

- (void)_recomputeSectionIndexTitleIndex
{
  self->_currentIndexTitleIndex = -1;
  v3 = [(UICollectionView *)self _currentSectionIndexTitleIndex];
  self->_currentIndexTitleIndex = v3;
  v4 = [(UICollectionView *)self _updateIndexOverlayToShowTitleAtIndex:v3];
}

- (id)_updateIndexOverlayToShowTitleAtIndex:(int64_t)a3
{
  v5 = [(UICollectionView *)self _dataSourceSectionIndexTitles];
  v6 = v5;
  if (a3 < 0 || [v5 count] <= a3)
  {
    v7 = 0;
  }

  else
  {
    v7 = [v6 objectAtIndex:a3];
    [(_UICollectionTableIndexOverlayManager *)self->_indexOverlayManager setIndexOverlayIndicatorViewText:v7];
  }

  return v7;
}

- (void)_moveSectionIndexTitleIndexToIndex:(int64_t)a3 highlight:(BOOL)a4
{
  if ((a3 & 0x8000000000000000) == 0)
  {
    v4 = a4;
    v7 = [(UICollectionView *)self _updateIndexOverlayToShowTitleAtIndex:?];
    if (v7)
    {
      v11 = v7;
      v8 = [(UICollectionView *)self _sectionIndexChangedToIndex:a3 title:v7];
      v9 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:v8];
      if (v4)
      {
        v10 = [(UICollectionView *)self _globalIndexPathForItemAtIndexPath:v9];
        if (v10 != 0x7FFFFFFFFFFFFFFFLL)
        {
          [(UICollectionView *)self _unhighlightAllItemsAndHighlightGlobalItem:v10];
        }
      }

      v7 = v11;
    }
  }
}

- (void)_shiftSectionIndexTitleIndexByAmount:(int64_t)a3
{
  v4 = [(UICollectionView *)self _currentSectionIndexTitleIndex]+ a3;

  [(UICollectionView *)self _moveSectionIndexTitleIndexToIndex:v4 highlight:1];
}

- (void)userInteractionStoppedWithIndexBarView:(id)a3
{
  v4 = [(UIView *)self traitCollection];
  v5 = [v4 userInterfaceIdiom];

  if (v5 == 3)
  {
    v6 = [(UICollectionView *)self _indexOverlayManager];
    [(_UICollectionTableIndexOverlayManager *)v6 transitionIndexOverlaySelectionViewToVisible:?];
  }
}

- (int64_t)_sectionIndexChangedToIndex:(int64_t)a3 title:(id)a4
{
  v6 = a4;
  if ((*(&self->_collectionViewFlags + 8) & 4) != 0)
  {
    v8 = [(UICollectionView *)self _dataSourceProxy];
    v7 = [v8 collectionView:self indexPathForIndexTitle:v6 atIndex:a3];

    v9 = [v7 section];
    if (v7)
    {
      self->_currentIndexTitleIndex = a3;
      [(UICollectionView *)self _scrollToItemAtPresentationIndexPath:v7 atScrollPosition:1 additionalInsets:0 animated:0.0, 0.0, 0.0, 0.0];
      v10 = [(UIView *)self traitCollection];
      v11 = [v10 interactionModel];

      if ((v11 & 2) != 0)
      {
        [(UICollectionView *)self _requestFocusOnItemAtIndexPath:v7];
      }
    }

    a3 = v9;
  }

  else
  {
    v7 = 0;
  }

  return a3;
}

- (void)_transitionIndexOverlaySelectionViewToVisible:(BOOL)a3
{
  v3 = a3;
  v4 = [(UICollectionView *)self _indexOverlayManager];
  [(_UICollectionTableIndexOverlayManager *)v4 transitionIndexOverlaySelectionViewToVisible:v3];
}

- (void)_hideIndexOverlay
{
  v2 = [(UICollectionView *)self _indexOverlayManager];
  [(_UICollectionTableIndexOverlayManager *)v2 transitionIndexOverlayIndicatorViewToVisible:0 shouldFadeBackToInvisible:?];
}

- (void)_registeredSupplementaryViewKind:(id)a3
{
  v4 = a3;
  supplementaryViewRegisteredKinds = self->_supplementaryViewRegisteredKinds;
  v8 = v4;
  if (!supplementaryViewRegisteredKinds)
  {
    v6 = [MEMORY[0x1E695DFA8] set];
    v7 = self->_supplementaryViewRegisteredKinds;
    self->_supplementaryViewRegisteredKinds = v6;

    v4 = v8;
    supplementaryViewRegisteredKinds = self->_supplementaryViewRegisteredKinds;
  }

  [(NSMutableSet *)supplementaryViewRegisteredKinds addObject:v4];
}

- (void)registerClass:(Class)cellClass forCellWithReuseIdentifier:(NSString *)identifier
{
  v15 = identifier;
  if ([(NSString *)v15 length])
  {
    if (!cellClass)
    {
      goto LABEL_5;
    }
  }

  else
  {
    v10 = MEMORY[0x1E695DF30];
    v11 = *MEMORY[0x1E695D940];
    v12 = NSStringFromSelector(a2);
    [v10 raise:v11 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v12}];

    if (!cellClass)
    {
      goto LABEL_5;
    }
  }

  if (([(objc_class *)cellClass isSubclassOfClass:objc_opt_class()]& 1) == 0)
  {
    v13 = [MEMORY[0x1E696AAA8] currentHandler];
    v14 = NSStringFromClass(cellClass);
    [v13 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9525 description:{@"attempt to register a cell class '%@' which is not a subclass of UICollectionViewCell", v14}];
  }

LABEL_5:
  if (!self->_cellClassDict)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DF90]);
    cellClassDict = self->_cellClassDict;
    self->_cellClassDict = v7;
  }

  [(NSMutableDictionary *)self->_cellNibDict removeObjectForKey:v15];
  v9 = self->_cellClassDict;
  if (cellClass)
  {
    [(NSMutableDictionary *)v9 setValue:cellClass forKey:v15];
  }

  else
  {
    [(NSMutableDictionary *)v9 removeObjectForKey:v15];
  }
}

- (void)registerClass:(Class)viewClass forSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier
{
  v20 = elementKind;
  v9 = identifier;
  if (![(NSString *)v20 length])
  {
    v14 = MEMORY[0x1E695DF30];
    v15 = *MEMORY[0x1E695D940];
    v16 = NSStringFromSelector(a2);
    [v14 raise:v15 format:{@"must pass a valid element kind to -[UICollectionView %@]", v16}];
  }

  if (![(NSString *)v9 length])
  {
    v17 = MEMORY[0x1E695DF30];
    v18 = *MEMORY[0x1E695D940];
    v19 = NSStringFromSelector(a2);
    [v17 raise:v18 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v19}];
  }

  if (!self->_supplementaryViewClassDict)
  {
    v10 = objc_alloc_init(MEMORY[0x1E695DF90]);
    supplementaryViewClassDict = self->_supplementaryViewClassDict;
    self->_supplementaryViewClassDict = v10;
  }

  v12 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v20 withReuseIdentifier:v9];
  [(NSMutableDictionary *)self->_supplementaryViewNibDict removeObjectForKey:v12];
  v13 = self->_supplementaryViewClassDict;
  if (viewClass)
  {
    [(NSMutableDictionary *)v13 setValue:viewClass forKey:v12];
  }

  else
  {
    [(NSMutableDictionary *)v13 removeObjectForKey:v12];
  }

  [(UICollectionView *)self _registeredSupplementaryViewKind:v20];
}

- (void)registerNib:(UINib *)nib forCellWithReuseIdentifier:(NSString *)identifier
{
  v14 = nib;
  v7 = identifier;
  if (![(NSString *)v7 length])
  {
    v11 = MEMORY[0x1E695DF30];
    v12 = *MEMORY[0x1E695D940];
    v13 = NSStringFromSelector(a2);
    [v11 raise:v12 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v13}];
  }

  if (!self->_cellNibDict)
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
    cellNibDict = self->_cellNibDict;
    self->_cellNibDict = v8;
  }

  [(NSMutableDictionary *)self->_cellClassDict removeObjectForKey:v7];
  v10 = self->_cellNibDict;
  if (v14)
  {
    [(NSMutableDictionary *)v10 setValue:v14 forKey:v7];
  }

  else
  {
    [(NSMutableDictionary *)v10 removeObjectForKey:v7];
  }
}

- (void)registerNib:(UINib *)nib forSupplementaryViewOfKind:(NSString *)kind withReuseIdentifier:(NSString *)identifier
{
  v21 = nib;
  v9 = kind;
  v10 = identifier;
  if (![(NSString *)v9 length])
  {
    v15 = MEMORY[0x1E695DF30];
    v16 = *MEMORY[0x1E695D940];
    v17 = NSStringFromSelector(a2);
    [v15 raise:v16 format:{@"must pass a valid element kind to -[UICollectionView %@]", v17}];
  }

  if (![(NSString *)v10 length])
  {
    v18 = MEMORY[0x1E695DF30];
    v19 = *MEMORY[0x1E695D940];
    v20 = NSStringFromSelector(a2);
    [v18 raise:v19 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v20}];
  }

  if (!self->_supplementaryViewNibDict)
  {
    v11 = objc_alloc_init(MEMORY[0x1E695DF90]);
    supplementaryViewNibDict = self->_supplementaryViewNibDict;
    self->_supplementaryViewNibDict = v11;
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v9 withReuseIdentifier:v10];
  [(NSMutableDictionary *)self->_supplementaryViewClassDict removeObjectForKey:v13];
  v14 = self->_supplementaryViewNibDict;
  if (v21)
  {
    [(NSMutableDictionary *)v14 setValue:v21 forKey:v13];
  }

  else
  {
    [(NSMutableDictionary *)v14 removeObjectForKey:v13];
  }

  [(UICollectionView *)self _registeredSupplementaryViewKind:v9];
}

- (void)_setExternalObjectTable:(id)a3 forNibLoadingOfCellWithReuseIdentifier:(id)a4
{
  v10 = a3;
  v6 = a4;
  cellNibExternalObjectsTables = self->_cellNibExternalObjectsTables;
  if (!cellNibExternalObjectsTables)
  {
    v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v9 = self->_cellNibExternalObjectsTables;
    self->_cellNibExternalObjectsTables = v8;

    cellNibExternalObjectsTables = self->_cellNibExternalObjectsTables;
  }

  [(NSMutableDictionary *)cellNibExternalObjectsTables setObject:v10 forKey:v6];
}

- (void)_setExternalObjectTable:(id)a3 forNibLoadingOfSupplementaryViewOfKind:(id)a4 withReuseIdentifier:(id)a5
{
  v14 = a3;
  v8 = a4;
  v9 = a5;
  supplementaryViewNibExternalObjectsTables = self->_supplementaryViewNibExternalObjectsTables;
  if (!supplementaryViewNibExternalObjectsTables)
  {
    v11 = objc_alloc_init(MEMORY[0x1E695DF90]);
    v12 = self->_supplementaryViewNibExternalObjectsTables;
    self->_supplementaryViewNibExternalObjectsTables = v11;

    supplementaryViewNibExternalObjectsTables = self->_supplementaryViewNibExternalObjectsTables;
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v8 withReuseIdentifier:v9];
  [(NSMutableDictionary *)supplementaryViewNibExternalObjectsTables setObject:v14 forKey:v13];
}

- (void)_prepareViewForUse:(id)a3 withElementCategory:(unint64_t)a4 elementKind:(id)a5 reuseIdentifier:(id)a6 indexPath:(id)a7
{
  v12 = a3;
  [(UICollectionView *)self _prepareViewForUse:v12 withElementCategory:a4 elementKind:a5 reuseIdentifier:a6 indexPath:a7 applyDefaultAttributes:1];
  [(_UICollectionViewSubviewManager *)self->_subviewManager ensureViewIsRemovedFromReuseQueue:v12];
}

- (void)_prepareViewForUse:(id)a3 withElementCategory:(unint64_t)a4 elementKind:(id)a5 reuseIdentifier:(id)a6 indexPath:(id)a7 applyDefaultAttributes:(BOOL)a8
{
  v8 = a8;
  v14 = a3;
  v15 = a5;
  [v14 _setReuseIdentifier:a6];
  [v14 _setElementKind:v15];
  [v14 setAutoresizingMask:0];
  [v14 setTranslatesAutoresizingMaskIntoConstraints:1];
  [v14 _setCollectionView:self];
  [v14 _setAutomaticIntrinsicContentSizeInvalidationEnabled:(*(&self->_collectionViewFlags + 4) & 0x60) == 64];
  if (v8)
  {
    if (self->_layout)
    {
      v16 = [objc_opt_class() layoutAttributesClass];
    }

    else
    {
      v16 = objc_opt_class();
    }

    if (a4 == 1)
    {
      v17 = [v16 layoutAttributesForSupplementaryViewOfKind:v15 withIndexPath:a7];
    }

    else
    {
      if (a4)
      {
        [v16 layoutAttributesForDecorationViewOfKind:v15 withIndexPath:a7];
      }

      else
      {
        [v16 layoutAttributesForCellWithIndexPath:a7];
      }
      v17 = ;
    }

    v18 = v17;
    [v14 center];
    [v18 setCenter:?];
    [v14 bounds];
    [v18 setSize:{v19, v20}];
    v21 = [v14 layer];
    v22 = v21;
    if (v21)
    {
      [v21 transform];
    }

    else
    {
      v30 = 0u;
      v31 = 0u;
      v28 = 0u;
      v29 = 0u;
      v26 = 0u;
      v27 = 0u;
      v24 = 0u;
      v25 = 0u;
    }

    v23[4] = v28;
    v23[5] = v29;
    v23[6] = v30;
    v23[7] = v31;
    v23[0] = v24;
    v23[1] = v25;
    v23[2] = v26;
    v23[3] = v27;
    [v18 setTransform3D:v23];

    [v14 alpha];
    [v18 setAlpha:?];
    [(UICollectionView *)self _applyLayoutAttributes:v18 toView:v14];
  }

  [v14 _setHostsLayoutEngine:1];
  [v14 _markAsDequeued];
}

- (id)_dequeueReusableViewOfKind:(id)a3 withIdentifier:(id)a4 forIndexPath:(id)a5 viewCategory:(unint64_t)a6
{
  v10 = a3;
  v11 = a4;
  _UIQOSExpectComplexCommit("UICVDQ");
  v73 = 0;
  v74 = &v73;
  v75 = 0x3032000000;
  v76 = __Block_byref_object_copy__39;
  v77 = __Block_byref_object_dispose__39;
  v78 = 0;
  v12 = a5;
  v13 = 0;
  if ((*(&self->_collectionViewFlags + 16) & 8) != 0)
  {
LABEL_4:
    v65 = v12;
    if (a6)
    {
      goto LABEL_17;
    }

    goto LABEL_5;
  }

  transitionLayoutAttributes = self->_transitionLayoutAttributes;
  if (transitionLayoutAttributes)
  {
    v13 = transitionLayoutAttributes;
    goto LABEL_4;
  }

  if (a6)
  {
    collectionViewData = self->_collectionViewData;
    if (a6 == 2)
    {
      [(UICollectionViewData *)collectionViewData layoutAttributesForDecorationViewOfKind:v11 atIndexPath:v12];
    }

    else
    {
      [(UICollectionViewData *)collectionViewData layoutAttributesForSupplementaryElementOfKind:v10 atIndexPath:v12];
    }
    v13 = ;
    v65 = v12;
LABEL_17:
    v20 = self->_subviewManager;
    v21 = [(_UICollectionViewSubviewManager *)v20 dequeueReusableViewWithReuseIdentifier:v11 elementKind:v10 elementCategory:a6];
    v22 = v74[5];
    v74[5] = v21;

    v23 = v74[5];
    if (v23)
    {
      if (v13)
      {
        [v74[5] _willRevealWithLayoutAttributes:v13];
        v23 = v74[5];
      }

      [(UICollectionView *)self _prepareViewForReuse:v23];
LABEL_49:
      if ((*(&self->_collectionViewFlags + 16) & 8) == 0)
      {
        v42 = v74[5];
        v66[0] = MEMORY[0x1E69E9820];
        v66[1] = 3221225472;
        v66[2] = __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke_2;
        v66[3] = &unk_1E70FF590;
        v70 = v42;
        v67 = v13;
        v68 = self;
        v71 = a6 == 0;
        v69 = v65;
        [UIView performWithoutAnimation:v66];
      }

      if (v20)
      {
        [(NSHashTable *)v20->_dequeuedViews addObject:v74[5]];
      }

      v43 = v74[5];
      v44 = self->_layout;
      v45 = v43;
      v46 = v45;
      if (!v44 || !v45)
      {
        goto LABEL_60;
      }

      v47 = [v45 effectiveUserInterfaceLayoutDirection];
      if (v47 == [(UICollectionViewLayout *)v44 developmentLayoutDirection])
      {
        if (![v46 _flipsHorizontalAxis])
        {
LABEL_60:

          v18 = v74[5];
          goto LABEL_61;
        }

        v48 = 0;
      }

      else
      {
        v48 = [(UICollectionViewLayout *)v44 _wantsRightToLeftHorizontalMirroringIfNeeded];
      }

      [v46 _setFlipsHorizontalAxis:v48];
      goto LABEL_60;
    }

    if (a6 == 2)
    {
      v18 = 0;
LABEL_61:

      goto LABEL_62;
    }

    v24 = 8;
    if (!a6)
    {
      v24 = 7;
    }

    v62 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v24]);
    if (a6)
    {
      v25 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v10 withReuseIdentifier:v11];
    }

    else
    {
      v25 = v11;
    }

    v61 = v25;
    v63 = [v62 objectForKey:v25];
    v59 = _UISetCurrentFallbackEnvironment(self);
    if (v63)
    {
      v26 = 6;
      if (!a6)
      {
        v26 = 5;
      }

      v27 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v26]);
      v28 = [v27 objectForKey:v61];
      v58 = v28;
      if (v28)
      {
        v29 = [MEMORY[0x1E695DF20] dictionaryWithObject:v28 forKey:@"UINibExternalObjects"];
      }

      else
      {
        v29 = 0;
      }

      v57 = v29;
      v60 = [v63 instantiateWithOwner:0 options:v29];
      if ([v60 count] == 1)
      {
        v38 = [v60 objectAtIndex:0];
        v39 = v74[5];
        v74[5] = v38;
      }

      if (!v74[5] || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
      {
        v54 = [MEMORY[0x1E696AAA8] currentHandler];
        [v54 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9731 description:{@"invalid nib registered for identifier (%@) - nib must contain exactly one top level object which must be a UICollectionReusableView instance", v11}];
      }

      v40 = [v74[5] reuseIdentifier];
      if ([v40 length] && (objc_msgSend(v40, "isEqualToString:", v11) & 1) == 0)
      {
        v56 = [MEMORY[0x1E696AAA8] currentHandler];
        [v56 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9733 description:{@"view reuse identifier in nib (%@) does not match the identifier used to register the nib (%@)", v40, v11}];
      }
    }

    else
    {
      v30 = 92;
      if (!a6)
      {
        v30 = 91;
      }

      v27 = *(&self->super.super.super.super.isa + OBJC_IVAR____UICollectionSnapshotView__snapshottedViewDisablesRasterizationInAnimations[v30]);
      v31 = [v27 objectForKey:v61];
      [(UICollectionViewLayoutAttributes *)v13 frame];
      v33 = v32;
      v35 = v34;
      [(UICollectionViewLayoutAttributes *)v13 size];
      v72[0] = MEMORY[0x1E69E9820];
      v72[1] = 3221225472;
      v72[2] = __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke;
      v72[3] = &unk_1E70FF568;
      v72[4] = &v73;
      v72[5] = v31;
      v72[6] = v33;
      v72[7] = v35;
      v72[8] = v36;
      v72[9] = v37;
      [UIView performWithoutAnimation:v72];
    }

    _UIRestorePreviousFallbackEnvironment(v59);
    v41 = v74;
    if (v74[5])
    {
      if (!v13)
      {
LABEL_48:
        [(UICollectionView *)self _prepareViewForUse:v41[5] withElementCategory:a6 elementKind:v10 reuseIdentifier:v11 indexPath:v12 applyDefaultAttributes:0];

        goto LABEL_49;
      }
    }

    else
    {
      v55 = [MEMORY[0x1E696AAA8] currentHandler];
      [v55 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9746 description:{@"could not dequeue a view of kind: %@ with identifier %@ - must register a nib or a class for the identifier or connect a prototype cell in a storyboard", v10, v11}];

      v41 = v74;
      if (!v13)
      {
        goto LABEL_48;
      }
    }

    [v41[5] _willRevealWithLayoutAttributes:v13];
    v41 = v74;
    goto LABEL_48;
  }

  v65 = [(UICollectionView *)self presentationIndexPathForDataSourceIndexPath:v12];

  v13 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v65];
LABEL_5:
  cellBeingReconfigured = self->_cellBeingReconfigured;
  if (!cellBeingReconfigured)
  {
    goto LABEL_17;
  }

  v16 = [(UICollectionReusableView *)cellBeingReconfigured reuseIdentifier];
  v17 = [v16 isEqualToString:v11];

  if ((v17 & 1) == 0)
  {
    v50 = [MEMORY[0x1E696AAA8] currentHandler];
    v51 = [(UICollectionReusableView *)self->_cellBeingReconfigured reuseIdentifier];
    [v50 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9698 description:{@"Attempted to dequeue a cell for a different registration or reuse identifier than the existing cell when reconfiguring an item, which is not allowed. You must dequeue a cell using the same registration or reuse identifier that was used to dequeue the cell originally to obtain the existing cell. Dequeued reuse identifier: %@; Original reuse identifier: %@; Existing cell: %@", v11, v51, self->_cellBeingReconfigured}];
  }

  if (([(NSIndexPath *)self->_indexPathBeingReconfigured isEqual:v65]& 1) == 0)
  {
    v52 = [MEMORY[0x1E696AAA8] currentHandler];
    v53 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:self->_indexPathBeingReconfigured];
    [v52 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9699 description:{@"Attempted to dequeue a cell for a different index path than the index path being reconfigured, which is not allowed. You must dequeue a cell for the same index path that is being reconfigured to obtain the existing cell. Dequeued index path: %@; Reconfigured index path: %@; Existing cell: %@", v12, v53, self->_cellBeingReconfigured}];
  }

  v18 = self->_cellBeingReconfigured;
LABEL_62:

  _Block_object_dispose(&v73, 8);

  return v18;
}

void __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke(uint64_t a1)
{
  v2 = [objc_alloc(*(a1 + 40)) initWithFrame:{*(a1 + 48), *(a1 + 56), *(a1 + 64), *(a1 + 72)}];
  v3 = *(*(a1 + 32) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

uint64_t __88__UICollectionView__dequeueReusableViewOfKind_withIdentifier_forIndexPath_viewCategory___block_invoke_2(uint64_t a1)
{
  if (dyld_program_sdk_at_least())
  {
    v2 = 1;
  }

  else
  {
    v3 = [*(a1 + 56) _layoutAttributes];
    v4 = [v3 zIndex];
    v2 = v4 != [*(a1 + 32) zIndex];
  }

  result = [(UICollectionView *)*(a1 + 40) _applyLayoutAttributes:*(a1 + 56) toView:v2 addingControlledSubview:v2 forced:?];
  if (*(a1 + 64) == 1)
  {
    v6 = *(*(a1 + 40) + 2976);
    if (v6)
    {
      result = [*(v6 + 8) containsObject:*(a1 + 48)];
      if (result)
      {
        result = [*(a1 + 56) _setSelected:1 animated:0];
      }
    }

    v7 = *(*(a1 + 40) + 2976);
    if (v7)
    {
      result = [*(v7 + 16) containsObject:*(a1 + 48)];
      if (result)
      {
        v8 = *(a1 + 56);

        return [v8 _setHighlighted:1 animated:0];
      }
    }
  }

  return result;
}

- (UICollectionViewCell)dequeueReusableCellWithReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath
{
  v7 = identifier;
  if (![(NSString *)v7 length])
  {
    v10 = MEMORY[0x1E695DF30];
    v11 = *MEMORY[0x1E695D940];
    v12 = NSStringFromSelector(a2);
    [v10 raise:v11 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v12}];
  }

  v8 = [(UICollectionView *)self _dequeueReusableViewOfKind:@"UICollectionElementKindCell" withIdentifier:v7 forIndexPath:indexPath viewCategory:0];

  return v8;
}

- (id)_dequeueReusableCellWithRegistration:(id)a3 forIndexPath:(id)a4
{
  v6 = a3;
  v7 = [(UICollectionView *)self _diffableIdentifierForIndexPath:a4];
  v8 = [(UICollectionView *)self dequeueConfiguredReusableCellWithRegistration:v6 forIndexPath:a4 item:v7];

  return v8;
}

- (UICollectionViewCell)dequeueConfiguredReusableCellWithRegistration:(UICollectionViewCellRegistration *)registration forIndexPath:(NSIndexPath *)indexPath item:(id)item
{
  v25 = *MEMORY[0x1E69E9840];
  v9 = registration;
  v10 = item;
  v11 = indexPath;
  if (dyld_program_sdk_at_least())
  {
    v12 = [(UICollectionViewCellRegistration *)v9 _collectionViewRequestingViewWhenCreated];

    if (v12 == self)
    {
      if (_UIIsPrivateMainBundle())
      {
        v13 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v13, OS_LOG_TYPE_FAULT))
        {
          *buf = 138412290;
          v24 = v9;
          _os_log_fault_impl(&dword_188A29000, v13, OS_LOG_TYPE_FAULT, "Attempted to dequeue a cell using a registration that was created inside -collectionView:cellForItemAtIndexPath: or inside a UICollectionViewDiffableDataSource cell provider. Creating a new registration each time a cell is requested will prevent reuse and cause created cells to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", buf, 0xCu);
        }
      }

      else
      {
        v13 = [MEMORY[0x1E696AAA8] currentHandler];
        [v13 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9794 description:@"Attempted to dequeue a cell using a registration that was created inside -collectionView:cellForItemAtIndexPath: or inside a UICollectionViewDiffableDataSource cell provider. Creating a new registration each time a cell is requested will prevent reuse and cause created cells to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", v9];
      }
    }
  }

  v14 = [(UICollectionViewCellRegistration *)v9 reuseIdentifier];
  if (![v14 length])
  {
    v22 = [MEMORY[0x1E696AAA8] currentHandler];
    [v22 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9796 description:{@"UIKit internal inconsistency: registration missing reuse identifier %@", v9}];
  }

  if ([(UICollectionViewCellRegistration *)v9 hasCellClass])
  {
    v15 = [(NSMutableDictionary *)self->_cellClassDict objectForKeyedSubscript:v14];

    if (!v15)
    {
      [(UICollectionView *)self registerClass:[(UICollectionViewCellRegistration *)v9 cellClass] forCellWithReuseIdentifier:v14];
    }
  }

  else if ([(UICollectionViewCellRegistration *)v9 hasCellNib])
  {
    v16 = [(NSMutableDictionary *)self->_cellNibDict objectForKeyedSubscript:v14];

    if (!v16)
    {
      v17 = [(UICollectionViewCellRegistration *)v9 cellNib];
      [(UICollectionView *)self registerNib:v17 forCellWithReuseIdentifier:v14];
    }
  }

  else
  {
    v18 = [MEMORY[0x1E696AAA8] currentHandler];
    [v18 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9807 description:{@"Cell registration is invalid (no cell class or nib) %@", v9}];
  }

  v19 = [(UICollectionView *)self _dequeueReusableViewOfKind:@"UICollectionElementKindCell" withIdentifier:v14 forIndexPath:v11 viewCategory:0];
  v20 = [(UICollectionViewCellRegistration *)v9 configurationHandler];
  (v20)[2](v20, v19, v11, v10);

  return v19;
}

- (UICollectionReusableView)dequeueConfiguredReusableSupplementaryViewWithRegistration:(UICollectionViewSupplementaryRegistration *)registration forIndexPath:(NSIndexPath *)indexPath
{
  v29 = *MEMORY[0x1E69E9840];
  v7 = registration;
  v8 = indexPath;
  if (dyld_program_sdk_at_least())
  {
    v9 = [(UICollectionViewSupplementaryRegistration *)v7 _collectionViewRequestingViewWhenCreated];

    if (v9 == self)
    {
      if (_UIIsPrivateMainBundle())
      {
        v10 = __UIFaultDebugAssertLog();
        if (os_log_type_enabled(v10, OS_LOG_TYPE_FAULT))
        {
          *buf = 138412290;
          v28 = v7;
          _os_log_fault_impl(&dword_188A29000, v10, OS_LOG_TYPE_FAULT, "Attempted to dequeue a supplementary view using a registration that was created inside -collectionView:viewForSupplementaryElementOfKind:atIndexPath: or inside a UICollectionViewDiffableDataSource supplementary view provider. Creating a new registration each time a supplementary view is requested will prevent reuse and cause created supplementary views to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", buf, 0xCu);
        }
      }

      else
      {
        v10 = [MEMORY[0x1E696AAA8] currentHandler];
        [v10 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9822 description:@"Attempted to dequeue a supplementary view using a registration that was created inside -collectionView:viewForSupplementaryElementOfKind:atIndexPath: or inside a UICollectionViewDiffableDataSource supplementary view provider. Creating a new registration each time a supplementary view is requested will prevent reuse and cause created supplementary views to remain inaccessible in memory for the lifetime of the collection view. Registrations should be created up front and reused. Registration: %@", v7];
      }
    }
  }

  v11 = [(UICollectionViewSupplementaryRegistration *)v7 elementKind];
  v12 = [(UICollectionViewSupplementaryRegistration *)v7 reuseIdentifier];
  if (![v11 length])
  {
    v25 = [MEMORY[0x1E696AAA8] currentHandler];
    [v25 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9825 description:{@"UIKit internal inconsistency: registration missing element kind %@", v7}];
  }

  if (![v12 length])
  {
    v26 = [MEMORY[0x1E696AAA8] currentHandler];
    [v26 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9826 description:{@"UIKit internal inconsistency: registration missing reuse identifier %@", v7}];
  }

  v13 = [objc_opt_class() _reuseKeyForSupplementaryViewOfKind:v11 withReuseIdentifier:v12];
  v14 = [(UICollectionViewSupplementaryRegistration *)v7 hasSupplementaryClass];
  v15 = [(UICollectionViewSupplementaryRegistration *)v7 hasSupplementaryNib];
  v16 = v15;
  if (v14 || v15)
  {
    if (v14)
    {
      goto LABEL_15;
    }
  }

  else
  {
    v18 = [MEMORY[0x1E696AAA8] currentHandler];
    [v18 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9831 description:{@"Supplementary registration is invalid (no view class or nib) %@", v7}];

    if (v14)
    {
LABEL_15:
      v17 = [(NSMutableDictionary *)self->_supplementaryViewClassDict objectForKeyedSubscript:v13];

      if (!v17)
      {
        [(UICollectionView *)self registerClass:[(UICollectionViewSupplementaryRegistration *)v7 supplementaryClass] forSupplementaryViewOfKind:v11 withReuseIdentifier:v12];
      }

      goto LABEL_20;
    }
  }

  v19 = [(NSMutableDictionary *)self->_supplementaryViewNibDict objectForKeyedSubscript:v13];
  v20 = v19 == 0;

  if (v20 && v16)
  {
    v21 = [(UICollectionViewSupplementaryRegistration *)v7 supplementaryNib];
    [(UICollectionView *)self registerNib:v21 forSupplementaryViewOfKind:v11 withReuseIdentifier:v12];
  }

LABEL_20:
  v22 = [(UICollectionView *)self _dequeueReusableViewOfKind:v11 withIdentifier:v12 forIndexPath:v8 viewCategory:1];
  v23 = [(UICollectionViewSupplementaryRegistration *)v7 configurationHandler];
  (v23)[2](v23, v22, v11, v8);

  return v22;
}

- (UICollectionReusableView)dequeueReusableSupplementaryViewOfKind:(NSString *)elementKind withReuseIdentifier:(NSString *)identifier forIndexPath:(NSIndexPath *)indexPath
{
  v9 = elementKind;
  v10 = identifier;
  if (![(NSString *)v9 length])
  {
    v13 = MEMORY[0x1E695DF30];
    v14 = *MEMORY[0x1E695D940];
    v15 = NSStringFromSelector(a2);
    [v13 raise:v14 format:{@"must pass a valid element kind to -[UICollectionView %@]", v15}];
  }

  if (![(NSString *)v10 length])
  {
    v16 = MEMORY[0x1E695DF30];
    v17 = *MEMORY[0x1E695D940];
    v18 = NSStringFromSelector(a2);
    [v16 raise:v17 format:{@"must pass a valid reuse identifier to -[UICollectionView %@]", v18}];
  }

  v11 = [(UICollectionView *)self _dequeueReusableViewOfKind:v9 withIdentifier:v10 forIndexPath:indexPath viewCategory:1];

  return v11;
}

- (void)_cacheOrReuseCell:(id)a3 forIndexPath:(id)a4 invalidatePreferredAttributes:(BOOL)a5 notifyDidEndDisplaying:(BOOL)a6
{
  v6 = a6;
  v7 = a5;
  v44 = *MEMORY[0x1E69E9840];
  v11 = a3;
  v12 = a4;
  if (!v11)
  {
    v26 = [MEMORY[0x1E696AAA8] currentHandler];
    [v26 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9863 description:{@"Invalid parameter not satisfying: %@", @"cell != nil"}];
  }

  if (os_variant_has_internal_diagnostics())
  {
    if (!v12)
    {
      v27 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v27, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        v35 = v11;
        _os_log_fault_impl(&dword_188A29000, v27, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", buf, 0xCu);
      }
    }
  }

  else if (!v12)
  {
    v28 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4924E8) + 8);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      v35 = v11;
      _os_log_impl(&dword_188A29000, v28, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: index path cannot be nil. Cell: %@", buf, 0xCu);
    }
  }

  if (([(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:v11]& 1) == 0)
  {
    subviewManager = self->_subviewManager;
    if (!subviewManager || ([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:v11]& 1) == 0)
    {
      if (v12 && [(UICollectionView *)self _prefetchingAllowed]&& [(UICollectionView *)self _indexPathIsValid:v12])
      {
        v14 = [(UICollectionView *)self _focusedItemState];
        v15 = v14;
        if (v14)
        {
          v16 = *(v14 + 8);
        }

        else
        {
          v16 = 0;
        }

        v17 = v16;
        v18 = v17;
        if (v17 == v11 || self->_firstResponderView == v11 || (*(&self->_collectionViewFlags + 11) & 0x40) != 0)
        {
        }

        else
        {
          v19 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:v11 atIndexPath:v12];

          if (!v19)
          {
            v20 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v12];

            if (!v20)
            {
              v21 = [_UICollectionViewPrefetchItem alloc];
              v22 = [(UICollectionReusableView *)v11 _layoutAttributes];
              v23 = [(_UICollectionViewPrefetchItem *)&v21->super.isa initWithAttributes:v22];

              [(_UIHomeAffordanceObservationRecord *)v23 setLegacyViewServiceSessionIdentifier:v11];
              if (v7 && v23)
              {
                *(v23 + 8) |= 3u;
              }

              [(UICollectionReusableView *)v11 _setHiddenForReuse:1];
              [(NSMutableDictionary *)self->_prefetchCacheItems setObject:v23 forKeyedSubscript:v12];
              CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4924F0);
              if (*CategoryCachedImpl)
              {
                v29 = *(CategoryCachedImpl + 8);
                if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
                {
                  v30 = v29;
                  v31 = [v12 _ui_shortDescription];
                  v32 = [MEMORY[0x1E696AD98] numberWithBool:v7];
                  v33 = [(UICollectionReusableView *)v11 _layoutAttributes];
                  *buf = 134219010;
                  v35 = self;
                  v36 = 2112;
                  v37 = v11;
                  v38 = 2112;
                  v39 = v31;
                  v40 = 2112;
                  v41 = v32;
                  v42 = 2112;
                  v43 = v33;
                  _os_log_impl(&dword_188A29000, v30, OS_LOG_TYPE_ERROR, "[UICV %p] _cacheOrReuseCell:%@ indexPath:%@ invalidatePreferredAttrs:%@ cellAttrs: %@", buf, 0x34u);
                }
              }

              if (v6)
              {
                [(UICollectionView *)self _notifyDidEndDisplayingCellIfNeeded:v11 forIndexPath:v12];
              }

              goto LABEL_30;
            }
          }
        }
      }

      if (![(UICollectionView *)self _reuseCell:v11 notifyDidEndDisplaying:v6])
      {
        if (dyld_program_sdk_at_least())
        {
          v25 = [(UIView *)v11 superview];

          if (v25)
          {
            [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:v11 atIndexPath:v12];
          }
        }
      }
    }
  }

LABEL_30:
}

- (BOOL)_reuseCell:(id)a3 notifyDidEndDisplaying:(BOOL)a4
{
  v4 = a4;
  v60 = *MEMORY[0x1E69E9840];
  v7 = a3;
  if (![(UICollectionReusableView *)v7 _isBeingReused])
  {
    if ([(UICollectionReusableView *)v7 _isInUpdateAnimation])
    {
      v10 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4924F8) + 8);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v52 = v7;
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "Cell (%@) is currently in an update animation and cannot be reused, ignoring.", buf, 0xCu);
      }

      goto LABEL_2;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      NSLog(&cfstr_ReusecellShoul.isa, v7);
      v8 = 0;
      goto LABEL_3;
    }

    if ([(UICollectionReusableView *)v7 _isInUpdateAnimation])
    {
      v35 = [MEMORY[0x1E696AAA8] currentHandler];
      [v35 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:9948 description:{@"attempting to reuse a cell that's still in an update animation: %@", v7}];
    }

    v49 = 0u;
    v50 = 0u;
    v47 = 0u;
    v48 = 0u;
    v11 = [(UICollectionView *)self _reorderedItems];
    v12 = [v11 countByEnumeratingWithState:&v47 objects:v59 count:16];
    if (v12)
    {
      v13 = v12;
      v14 = *v48;
      while (2)
      {
        for (i = 0; i != v13; ++i)
        {
          if (*v48 != v14)
          {
            objc_enumerationMutation(v11);
          }

          v16 = [*(*(&v47 + 1) + 8 * i) cell];

          if (v16 == v7)
          {
            v17 = 1;
            goto LABEL_21;
          }
        }

        v13 = [v11 countByEnumeratingWithState:&v47 objects:v59 count:16];
        if (v13)
        {
          continue;
        }

        break;
      }
    }

    v17 = 0;
LABEL_21:

    v18 = [(UICollectionReusableView *)v7 _layoutAttributes];
    v19 = [v18 indexPath];

    if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController isCellInvolvedInDragOrDropAnimation:v7 atIndexPath:v19])
    {
      if (v7)
      {
        dragAndDropController = self->_dragAndDropController;
        if (dragAndDropController)
        {
          [(NSMutableSet *)dragAndDropController->_cellsDeferredForReuse addObject:v7];
        }
      }

      CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492500);
      if ((*CategoryCachedImpl & 1) == 0)
      {
        goto LABEL_26;
      }

      v36 = *(CategoryCachedImpl + 8);
      if (!os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_26;
      }

      v31 = v36;
      v37 = [v19 _ui_shortDescription];
      *buf = 134218498;
      v52 = self;
      v53 = 2112;
      v54 = v37;
      v55 = 2112;
      *v56 = v7;
      _os_log_impl(&dword_188A29000, v31, OS_LOG_TYPE_ERROR, "[UICV %p] _reuseCell transfering ownership of cell at %@ to drag and drop controller: %@ ", buf, 0x20u);

LABEL_46:
LABEL_26:
      v8 = 1;
LABEL_43:

      goto LABEL_3;
    }

    if ((v17 & 1) != 0 || self->_firstResponderView == v7 || (([(UICollectionView *)self _focusedItemState], v22 = objc_claimAutoreleasedReturnValue(), (v23 = v22) == 0) ? (v24 = 0) : (v24 = *(v22 + 8)), v25 = v24, v25, v23, v25 == v7))
    {
      v34 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492508);
      if (*v34)
      {
        v38 = v17;
        v39 = *(v34 + 8);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
        {
          v40 = v39;
          v41 = [v19 _ui_shortDescription];
          v42 = self->_firstResponderView == v7;
          v43 = [(UICollectionView *)self _focusedItemState];
          v44 = v43;
          if (v43)
          {
            v45 = *(v43 + 8);
          }

          else
          {
            v45 = 0;
          }

          v46 = v45;
          *buf = 134219266;
          v52 = self;
          v53 = 2112;
          v54 = v41;
          v55 = 1024;
          *v56 = v38;
          *&v56[4] = 1024;
          *&v56[6] = v42;
          LOWORD(v57) = 1024;
          *(&v57 + 2) = v46 == v7;
          HIWORD(v57) = 2112;
          v58 = v7;
          _os_log_impl(&dword_188A29000, v40, OS_LOG_TYPE_ERROR, "[UICV %p] Denying reuse on cell at %@ for reason reordered(%d) isFirstReponder(%d) isFocused(%d): %@", buf, 0x32u);
        }
      }
    }

    else if ((dyld_program_sdk_at_least() & 1) != 0 || ![(UIView *)v7 _isFocusedOrAncestorOfFocusedView])
    {
      [(NSMutableSet *)self->_viewsOptedOutOfBeingParentedIntoContainers removeObject:v7];
      [(UICollectionReusableView *)v7 _setIsBeingReused:1];
      if (dyld_program_sdk_at_least())
      {
        v26 = [(UIView *)v7 _focusSystem];
        [v26 _focusEnvironmentWillDisappear:v7];
      }

      [(UICollectionView *)self _enqueueViewForReuse:v7];
      if (v4)
      {
        v27 = [(UICollectionReusableView *)v7 _layoutAttributes];
        v28 = [v27 indexPath];
        [(UICollectionView *)self _notifyDidEndDisplayingCellIfNeeded:v7 forIndexPath:v28];
      }

      [(UICollectionReusableView *)v7 _setIsBeingReused:0];
      v29 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492510);
      if ((*v29 & 1) == 0)
      {
        goto LABEL_26;
      }

      v30 = *(v29 + 8);
      if (!os_log_type_enabled(v30, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_26;
      }

      v31 = v30;
      v32 = [(UICollectionReusableView *)v7 reuseIdentifier];
      v33 = [v19 _ui_shortDescription];
      *buf = 134218754;
      v52 = self;
      v53 = 2112;
      v54 = v7;
      v55 = 2112;
      *v56 = v32;
      *&v56[8] = 2112;
      v57 = v33;
      _os_log_impl(&dword_188A29000, v31, OS_LOG_TYPE_ERROR, "[UICV %p] _reuseCell: %@ reuseIdentifier: %@ indexPath:%@", buf, 0x2Au);

      goto LABEL_46;
    }

    v8 = 0;
    goto LABEL_43;
  }

LABEL_2:
  v8 = 1;
LABEL_3:

  return v8;
}

- (BOOL)_reuseSupplementaryView:(id)a3
{
  v5 = a3;
  if ([(UICollectionReusableView *)v5 _isInUpdateAnimation])
  {
    v13 = [MEMORY[0x1E696AAA8] currentHandler];
    [v13 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10006 description:{@"attempting to reuse a view that's still in an update animation: %@", v5}];
  }

  if (self->_firstResponderView != v5)
  {
    v6 = [(UICollectionView *)self _focusedItemState];
    v7 = v6;
    v8 = v6 ? *(v6 + 8) : 0;
    v9 = v8;

    if (v9 != v5)
    {
      if (dyld_program_sdk_at_least())
      {
        v10 = [(UIView *)v5 _focusSystem];
        [v10 _focusEnvironmentWillDisappear:v5];

LABEL_11:
        [(UICollectionView *)self _enqueueViewForReuse:v5];
        [(UICollectionView *)self _notifyDidEndDisplayingSupplementaryView:v5];
        v11 = 1;
        goto LABEL_12;
      }

      if (![(UIView *)v5 _isFocusedOrAncestorOfFocusedView])
      {
        goto LABEL_11;
      }
    }
  }

  v11 = 0;
LABEL_12:

  return v11;
}

- (void)_enqueueViewForReuse:(id)a3
{
  subviewManager = self->_subviewManager;
  v4 = a3;
  if ([(_UICollectionViewSubviewManager *)subviewManager enqueueViewForReuse:v4])
  {
    [v4 _setHiddenForReuse:1];
  }

  else
  {
    [v4 removeFromSuperview];
  }
}

- (id)_reusableViewWithoutAttributesForElementCategory:(unint64_t)a3 kind:(id)a4 indexPath:(id)a5
{
  v8 = a4;
  v9 = a5;
  v10 = *(&self->_collectionViewFlags + 4) | 8;
  *(&self->_collectionViewFlags + 4) = v10;
  if (a3 == 1)
  {
    v11 = [(UICollectionView *)self _dataSourceProxy];
    v12 = [v11 collectionView:self viewForSupplementaryElementOfKind:v8 atIndexPath:v9];
    goto LABEL_5;
  }

  if (!a3)
  {
    v11 = [(UICollectionView *)self _dataSourceProxy];
    v12 = [v11 collectionView:self cellForItemAtIndexPath:v9];
LABEL_5:
    v13 = v12;

    v10 = *(&self->_collectionViewFlags + 4);
    goto LABEL_7;
  }

  v13 = 0;
LABEL_7:
  *(&self->_collectionViewFlags + 4) = v10 & 0xFFFFFFF7;
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(NSHashTable *)subviewManager->_dequeuedViews removeObject:v13];
  }

  return v13;
}

- (id)_arrayForUpdateAction:(int)a3
{
  v3 = 0;
  if (a3 > 1)
  {
    if (a3 == 2)
    {
      v4 = 2440;
    }

    else
    {
      if (a3 != 3)
      {
        goto LABEL_13;
      }

      v4 = 2448;
    }
  }

  else if (a3)
  {
    if (a3 != 1)
    {
      goto LABEL_13;
    }

    v4 = 2432;
  }

  else
  {
    v4 = 2424;
  }

  v5 = (&self->super.super.super.super.isa + v4);
  v6 = *(&self->super.super.super.super.isa + v4);
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DF70]);
    v8 = *v5;
    *v5 = v7;

    v6 = *v5;
  }

  v3 = v6;
LABEL_13:

  return v3;
}

- (void)_updateSections:(id)a3 updateAction:(int)a4
{
  v4 = *&a4;
  v7 = a3;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    v11 = [MEMORY[0x1E696AAA8] currentHandler];
    [v11 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10153 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  [(UICollectionView *)self _reloadDataIfNeeded];
  v8 = *(&self->_collectionViewFlags + 1);
  if ((v8 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
  }

  v9 = [(UICollectionView *)self _arrayForUpdateAction:v4];
  v12[0] = MEMORY[0x1E69E9820];
  v12[1] = 3221225472;
  v12[2] = __49__UICollectionView__updateSections_updateAction___block_invoke;
  v12[3] = &unk_1E70FF5D8;
  v14 = v4;
  v10 = v9;
  v13 = v10;
  [v7 enumerateIndexesUsingBlock:v12];
  if ((v8 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
  }
}

void __49__UICollectionView__updateSections_updateAction___block_invoke(uint64_t a1, uint64_t a2)
{
  v4 = [UICollectionViewUpdateItem alloc];
  v5 = *(a1 + 40);
  v6 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:a2];
  v7 = [(UICollectionViewUpdateItem *)v4 initWithAction:v5 forIndexPath:v6];

  [*(a1 + 32) addObject:v7];
}

- (void)insertSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections allowingAppendingInserts:1];
  [(UICollectionView *)self _updateSections:v4 updateAction:0];
}

- (void)deleteSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections];
  [(UICollectionView *)self _updateSections:v4 updateAction:1];
}

- (void)reloadSections:(NSIndexSet *)sections
{
  v4 = [(UICollectionView *)self _sectionIndexesAfterShadowUpdatesForSectionIndexes:sections];
  [(UICollectionView *)self _updateSections:v4 updateAction:2];
}

- (void)moveSection:(NSInteger)section toSection:(NSInteger)newSection
{
  if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    v10 = [MEMORY[0x1E696AAA8] currentHandler];
    [v10 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10192 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v8 = [(UICollectionView *)self presentationSectionIndexForDataSourceSectionIndex:section];
  v9 = [(UICollectionView *)self presentationSectionIndexForDataSourceSectionIndex:newSection];

  [(UICollectionView *)self _moveSection:v8 toSection:v9];
}

- (void)_moveSection:(int64_t)a3 toSection:(int64_t)a4
{
  v11 = [(UICollectionView *)self _arrayForUpdateAction:3];
  v7 = [UICollectionViewUpdateItem alloc];
  v8 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:a3];
  v9 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:a4];
  v10 = [(UICollectionViewUpdateItem *)v7 initWithInitialIndexPath:v8 finalIndexPath:v9 updateAction:3];

  [v11 addObject:v10];
  if ((*(&self->_collectionViewFlags + 12) & 0x10) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
  }
}

- (void)_updateWithUpdates:(id)a3 updateAction:(int64_t)a4
{
  v7 = a3;
  v6 = [v7 count];
  if (a4 != 4 && v6)
  {
    [(UICollectionView *)self _updateRowsAtIndexPaths:0 updateAction:a4 updates:v7];
  }
}

- (void)_updateRowsAtIndexPaths:(id)a3 updateAction:(int)a4 updates:(id)a5
{
  v6 = *&a4;
  v9 = a3;
  v18 = a5;
  v10 = *(&self->_collectionViewFlags + 1);
  if ((v10 & 0x2000000000) == 0)
  {
    if ((v10 & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
    {
      v17 = [MEMORY[0x1E696AAA8] currentHandler];
      [v17 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10230 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
    }

    v11 = [(UICollectionView *)self _arrayForUpdateAction:v6];
    v20 = 0;
    v21 = &v20;
    v22 = 0x2020000000;
    v23 = 0;
    if ([v18 count])
    {
      [v11 addObjectsFromArray:v18];
      v19[0] = MEMORY[0x1E69E9820];
      v19[1] = 3221225472;
      v19[2] = __65__UICollectionView__updateRowsAtIndexPaths_updateAction_updates___block_invoke;
      v19[3] = &unk_1E70FD008;
      v19[4] = self;
      v19[5] = &v20;
      [v18 enumerateObjectsUsingBlock:v19];
    }

    else
    {
      v13 = [v9 count];
      if (v13)
      {
        v14 = 0;
        while (1)
        {
          v15 = [v9 objectAtIndex:v14];
          v16 = [[UICollectionViewUpdateItem alloc] initWithAction:v6 forIndexPath:v15];
          if (![(UICollectionView *)self _addUpdateToShadowControllerIfNeeded:v16])
          {
            break;
          }

          [v11 addObject:v16];

          if (v13 == ++v14)
          {
            goto LABEL_7;
          }
        }

        *(v21 + 24) = 1;
      }
    }

LABEL_7:
    if (*(v21 + 24) == 1)
    {
      v12 = *(&self->_collectionViewFlags + 1);
      if ((v12 & 0x1000000000) != 0)
      {
        *(&self->_collectionViewFlags + 1) = v12 | 0x2000000000;
      }

      else
      {
        [(UICollectionView *)self reloadData];
      }
    }

    else
    {
      [(UICollectionView *)self _reloadDataIfNeeded];
      if ((*(&self->_collectionViewFlags + 12) & 0x10) == 0)
      {
        [(UICollectionView *)self _setupCellAnimations];
        [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
      }
    }

    _Block_object_dispose(&v20, 8);
  }
}

uint64_t __65__UICollectionView__updateRowsAtIndexPaths_updateAction_updates___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  result = [*(a1 + 32) _addUpdateToShadowControllerIfNeeded:a2];
  if ((result & 1) == 0)
  {
    *(*(*(a1 + 40) + 8) + 24) = 1;
    *a4 = 1;
  }

  return result;
}

- (void)insertItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths allowingAppendingInserts:1];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:0];
}

- (void)deleteItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:1];
}

- (void)reloadItemsAtIndexPaths:(NSArray *)indexPaths
{
  v4 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:indexPaths];
  [(UICollectionView *)self _updateRowsAtIndexPaths:v4 updateAction:2];
}

- (void)moveItemAtIndexPath:(NSIndexPath *)indexPath toIndexPath:(NSIndexPath *)newIndexPath
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    v9 = [MEMORY[0x1E696AAA8] currentHandler];
    [v9 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10298 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v10 = [(UICollectionView *)self _indexPathAfterShadowUpdatesForIndexPath:indexPath];
  v7 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:newIndexPath allowingAppendingInserts:[(NSIndexPath *)indexPath section]!= [(NSIndexPath *)newIndexPath section]];
  [(UICollectionView *)self _moveItemAtIndexPath:v10 toIndexPath:v7];
}

- (void)_moveItemAtIndexPath:(id)a3 toIndexPath:(id)a4
{
  v10 = [(UICollectionView *)self _arrayForUpdateAction:3];
  v7 = [[UICollectionViewUpdateItem alloc] initWithInitialIndexPath:a3 finalIndexPath:a4 updateAction:3];
  [v10 addObject:v7];
  v8 = [(UICollectionView *)self _addUpdateToShadowControllerIfNeeded:v7];
  v9 = *(&self->_collectionViewFlags + 1);
  if (v8)
  {
    if ((v9 & 0x1000000000) == 0)
    {
      [(UICollectionView *)self _setupCellAnimations];
      [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
    }
  }

  else if ((v9 & 0x1000000000) != 0)
  {
    *(&self->_collectionViewFlags + 1) = v9 | 0x2000000000;
  }

  else
  {
    [(UICollectionView *)self reloadData];
  }
}

- (void)reconfigureItemsAtIndexPaths:(NSArray *)indexPaths
{
  v5 = indexPaths;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0 && (*(&self->_collectionViewFlags + 16) & 0x10) == 0)
  {
    v12 = [MEMORY[0x1E696AAA8] currentHandler];
    [v12 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10330 description:{@"UICollectionView must be updated via the UICollectionViewDiffableDataSource APIs when acting as the UICollectionView's dataSource: please do not call mutation APIs directly on UICollectionView. %@", self}];
  }

  v6 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:v5];
  [(UICollectionView *)self _reloadDataIfNeeded];
  v7 = *(&self->_collectionViewFlags + 1);
  if ((v7 & 0x1000000000) == 0)
  {
    [(UICollectionView *)self _setupCellAnimations];
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __49__UICollectionView_reconfigureItemsAtIndexPaths___block_invoke;
  aBlock[3] = &unk_1E70F35B8;
  v8 = v6;
  v14 = v8;
  v15 = self;
  v9 = _Block_copy(aBlock);
  if (!+[UIView areAnimationsEnabled])
  {
    v9[2](v9);
    if ((v7 & 0x1000000000) != 0)
    {
      goto LABEL_12;
    }

LABEL_11:
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:0];
    goto LABEL_12;
  }

  reconfigureAnimator = self->_reconfigureAnimator;
  if (reconfigureAnimator)
  {
    [(UIViewPropertyAnimator *)reconfigureAnimator addAnimations:v9];
    if ((v7 & 0x1000000000) != 0)
    {
      goto LABEL_12;
    }

    goto LABEL_11;
  }

  if (dyld_program_sdk_at_least())
  {
    v11 = 6;
  }

  else
  {
    v11 = 4;
  }

  [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v11 options:v9 animations:0 completion:?];
  if ((v7 & 0x1000000000) == 0)
  {
    goto LABEL_11;
  }

LABEL_12:
}

void __49__UICollectionView_reconfigureItemsAtIndexPaths___block_invoke(uint64_t a1)
{
  v12 = *MEMORY[0x1E69E9840];
  v7 = 0u;
  v8 = 0u;
  v9 = 0u;
  v10 = 0u;
  v2 = *(a1 + 32);
  v3 = [v2 countByEnumeratingWithState:&v7 objects:v11 count:16];
  if (v3)
  {
    v4 = v3;
    v5 = *v8;
    do
    {
      v6 = 0;
      do
      {
        if (*v8 != v5)
        {
          objc_enumerationMutation(v2);
        }

        [*(a1 + 40) _reconfigureItemAtIndexPath:{*(*(&v7 + 1) + 8 * v6++), v7}];
      }

      while (v4 != v6);
      v4 = [v2 countByEnumeratingWithState:&v7 objects:v11 count:16];
    }

    while (v4);
  }
}

- (void)_reconfigureItemAtIndexPath:(id)a3
{
  v5 = a3;
  v14 = v5;
  if (!v5)
  {
    v13 = [MEMORY[0x1E696AAA8] currentHandler];
    [v13 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10363 description:{@"Invalid parameter not satisfying: %@", @"indexPath != nil"}];

    v5 = 0;
  }

  v6 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v5];
  v7 = v6;
  if (v6)
  {
    v8 = *(v6 + 24);
    if (v8)
    {
      v9 = v8;
      v10 = *(v7 + 16);
      if (v10)
      {
        v11 = v10[72];

        if (v11)
        {
          *(v7 + 8) |= 4u;
          goto LABEL_10;
        }
      }

      else
      {
      }
    }
  }

  v12 = [(UICollectionView *)self _cellForItemAtIndexPath:v14];
  if (v12)
  {
    [(UICollectionView *)self _reconfigureCell:v12 forItemAtIndexPath:v14];
  }

LABEL_10:
}

- (void)_reconfigureCell:(id)a3 forItemAtIndexPath:(id)a4
{
  v8 = a3;
  v9 = a4;
  v10 = v9;
  if (v8)
  {
    if (v9)
    {
      goto LABEL_3;
    }
  }

  else
  {
    v21 = [MEMORY[0x1E696AAA8] currentHandler];
    [v21 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10384 description:{@"Invalid parameter not satisfying: %@", @"cell != nil"}];

    if (v10)
    {
      goto LABEL_3;
    }
  }

  v22 = [MEMORY[0x1E696AAA8] currentHandler];
  [v22 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10385 description:{@"Invalid parameter not satisfying: %@", @"indexPath != nil"}];

LABEL_3:
  if (self->_cellBeingReconfigured)
  {
    v29 = [MEMORY[0x1E696AAA8] currentHandler];
    v23 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:v10];
    cellBeingReconfigured = self->_cellBeingReconfigured;
    v24 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:self->_indexPathBeingReconfigured];
    [v29 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10388 description:{@"Attempted to reconfigure a cell while already in the process of reconfiguring a cell. Check the backtrace to see what's causing this. (Attempted to reconfigure cell %@ for index path %@ while already reconfiguring cell %@ for index path %@)", v8, v23, cellBeingReconfigured, v24}];
  }

  objc_storeStrong(&self->_cellBeingReconfigured, a3);
  objc_storeStrong(&self->_indexPathBeingReconfigured, a4);
  v11 = _UISetCurrentFallbackEnvironment(self);
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492518);
  v13 = *(CategoryCachedImpl + 8);
  if (os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v13))
  {
    [v10 section];
    [v10 item];
    _os_signpost_emit_unreliably_with_name_impl();
  }

  WeakRetained = objc_loadWeakRetained(&self->_dataSource);
  if (!WeakRetained)
  {
    v25 = [MEMORY[0x1E696AAA8] currentHandler];
    [v25 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10394 description:{@"UICollectionView dataSource is not set: %@", self}];
  }

  v15 = [(UICollectionView *)self _dataSourceProxy];
  v16 = [v15 collectionView:self cellForItemAtIndexPath:v10];

  if (v16 != v8)
  {
    v26 = [MEMORY[0x1E696AAA8] currentHandler];
    v27 = [(UICollectionView *)self dataSourceIndexPathForPresentationIndexPath:v10];
    [v26 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10396 description:{@"UICollectionView dataSource returned a different cell from -collectionView:cellForItemAtIndexPath: than the cell being reconfigured, which is not allowed. When reconfiguring an item, you must obtain the existing cell by dequeuing a cell for the index path specified, using the same registration or reuse identifier that was used to dequeue the cell originally, and return the same cell. Index path: %@; Existing cell: %@; Returned cell: %@", v27, v8, v16}];
  }

  v17 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492520);
  v18 = *(v17 + 8);
  if (os_signpost_id_make_with_pointer(*(v17 + 8), self) - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v18))
  {
    _os_signpost_emit_unreliably_with_name_impl();
  }

  _UIRestorePreviousFallbackEnvironment(v11);
  v19 = self->_cellBeingReconfigured;
  self->_cellBeingReconfigured = 0;

  indexPathBeingReconfigured = self->_indexPathBeingReconfigured;
  self->_indexPathBeingReconfigured = 0;
}

- (void)_endItemAnimationsWithInvalidationContext:(id)a3 tentativelyForReordering:(BOOL)a4 animator:(id)a5 collectionViewAnimator:(id)a6
{
  v276 = a4;
  v365 = *MEMORY[0x1E69E9840];
  v9 = a3;
  v280 = a5;
  v279 = a6;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492528);
  v11 = *(CategoryCachedImpl + 8);
  v12 = os_signpost_id_make_with_pointer(*(CategoryCachedImpl + 8), self);
  if (v12 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v13 = v12;
    if (os_signpost_enabled(v11))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v11, OS_SIGNPOST_INTERVAL_BEGIN, v13, "BatchUpdates", "", buf, 2u);
    }
  }

  v278 = _UISetCurrentFallbackEnvironment(self);
  if (dyld_program_sdk_at_least())
  {
    if (!v9)
    {
      v9 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    }

    [v9 _setIntent:8];
  }

  if (dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _resetAllPrefetchContexts];
  }

  else
  {
    [(UICollectionView *)self _resetPrefetchState];
  }

  ++self->_updateCount;
  v14 = *MEMORY[0x1E695F050];
  v15 = *(MEMORY[0x1E695F050] + 8);
  v16 = *(MEMORY[0x1E695F050] + 16);
  v17 = *(MEMORY[0x1E695F050] + 24);
  v18 = *(&self->_collectionViewFlags + 1);
  v281 = v9;
  p_collectionViewFlags = &self->_collectionViewFlags;
  if ((~*(&self->_collectionViewFlags + 2) & 0x40000010) == 0)
  {
    if (dyld_program_sdk_at_least())
    {
      goto LABEL_118;
    }

    v18 = *(&self->_collectionViewFlags + 1);
  }

  if ((v18 & 0x2000000000) != 0)
  {
LABEL_118:
    v101 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492530);
    if (*v101)
    {
      v262 = *(v101 + 8);
      if (os_log_type_enabled(v262, OS_LOG_TYPE_ERROR))
      {
        v263 = *(&self->_collectionViewFlags + 1);
        *buf = 134218496;
        v358 = self;
        v359 = 1024;
        *v360 = (v263 >> 30) & 1;
        *&v360[4] = 1024;
        *&v360[6] = (v263 >> 37) & 1;
        _os_log_impl(&dword_188A29000, v262, OS_LOG_TYPE_ERROR, "_endItemAnimations: cv == %p; ignoring batch updates. needsReload: %d; ignoreBatchUpdatesAndFallBackToReloadData: %d", buf, 0x18u);
      }
    }

    *(&self->_collectionViewFlags + 1) &= ~0x2000000000uLL;
    [(UICollectionView *)self _resetUpdateItemArrays];
    v102 = 0;
    goto LABEL_373;
  }

  v19 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492538);
  if (*v19)
  {
    v264 = *(v19 + 8);
    if (os_log_type_enabled(v264, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v358 = self;
      _os_log_impl(&dword_188A29000, v264, OS_LOG_TYPE_ERROR, "_endItemAnimations: cv == %p; processing batch update", buf, 0xCu);
    }
  }

  if (self->_deleteItems)
  {
    v20 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492540);
    if (*v20)
    {
      v265 = *(v20 + 8);
      if (os_log_type_enabled(v265, OS_LOG_TYPE_ERROR))
      {
        deleteItems = self->_deleteItems;
        *buf = 138412290;
        v358 = deleteItems;
        _os_log_impl(&dword_188A29000, v265, OS_LOG_TYPE_ERROR, "Deleting: %@", buf, 0xCu);
      }
    }
  }

  if (self->_insertItems)
  {
    v21 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492548);
    if (*v21)
    {
      v267 = *(v21 + 8);
      if (os_log_type_enabled(v267, OS_LOG_TYPE_ERROR))
      {
        insertItems = self->_insertItems;
        *buf = 138412290;
        v358 = insertItems;
        _os_log_impl(&dword_188A29000, v267, OS_LOG_TYPE_ERROR, "Inserting: %@", buf, 0xCu);
      }
    }
  }

  if (self->_reloadItems)
  {
    v22 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492550);
    if (*v22)
    {
      v269 = *(v22 + 8);
      if (os_log_type_enabled(v269, OS_LOG_TYPE_ERROR))
      {
        reloadItems = self->_reloadItems;
        *buf = 138412290;
        v358 = reloadItems;
        _os_log_impl(&dword_188A29000, v269, OS_LOG_TYPE_ERROR, "Reloading: %@", buf, 0xCu);
      }
    }
  }

  if (self->_moveItems)
  {
    v23 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492558);
    if (*v23)
    {
      v271 = *(v23 + 8);
      if (os_log_type_enabled(v271, OS_LOG_TYPE_ERROR))
      {
        moveItems = self->_moveItems;
        *buf = 138412290;
        v358 = moveItems;
        _os_log_impl(&dword_188A29000, v271, OS_LOG_TYPE_ERROR, "Moving: %@", buf, 0xCu);
      }
    }
  }

  v24 = [(UIView *)self _focusSystem];
  v25 = [v24 focusedItem];

  v275 = v25;
  v26 = _UIFocusEnvironmentContainingView(v25);
  if ([v26 isDescendantOfView:self])
  {
    [v26 bounds];
    [v26 convertRect:self toView:?];
    v14 = v27;
    v15 = v28;
    v16 = v29;
    v17 = v30;
  }

  v274 = v26;
  v31 = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  [(UICollectionViewData *)v31 validateLayoutInRectImmediatelyValidatingContentSizeIgnoringSpecificInvalidations:v32, v33, v34, v35];
  if (v31)
  {
    *&v31->_collectionViewDataFlags |= 0x10u;
  }

  v277 = v31;
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  v36 = [[UICollectionViewData alloc] initWithCollectionView:self->_layout layout:?];
  collectionViewData = self->_collectionViewData;
  self->_collectionViewData = v36;

  v38 = [(UICollectionView *)self _arrayForUpdateAction:1];
  v39 = [v38 sortedArrayUsingSelector:?];

  v40 = [(UICollectionView *)self _arrayForUpdateAction:0];
  v41 = [v40 sortedArrayUsingSelector:?];

  v42 = [(UICollectionView *)self _sortedDeduplicatedReloadItems];
  v43 = [(NSMutableArray *)self->_moveItems sortedArrayUsingSelector:sel_compareIndexPathsForMoves_];
  v285 = [v43 mutableCopy];

  v289 = v39;
  v44 = [v39 copy];
  originalDeleteItems = self->_originalDeleteItems;
  self->_originalDeleteItems = v44;

  v287 = v41;
  v46 = [v41 copy];
  originalInsertItems = self->_originalInsertItems;
  self->_originalInsertItems = v46;

  v313 = [(UICollectionView *)self _sectionsWithSectionOperationsInUpdateItems:?];
  v314 = [(UICollectionView *)self _sectionsWithSectionOperationsInUpdateItems:?];
  v297 = dyld_program_sdk_at_least();
  v349 = 0u;
  v350 = 0u;
  v351 = 0u;
  v352 = 0u;
  obj = v42;
  v306 = self;
  v299 = [obj countByEnumeratingWithState:&v349 objects:v364 count:16];
  if (v299)
  {
    v294 = *v350;
    do
    {
      v48 = 0;
      do
      {
        if (*v350 != v294)
        {
          objc_enumerationMutation(obj);
        }

        v49 = *(*(&v349 + 1) + 8 * v48);
        v50 = [(UICollectionViewUpdateItem *)v49 _indexPath];
        if (v49)
        {
          v307 = v49[2];
          v309 = v49[1];
          if (((v49[6] != 0x7FFFFFFFFFFFFFFFLL) & v297) != 0)
          {
            goto LABEL_35;
          }
        }

        else
        {
          v307 = 0;
          v309 = 0;
          if (v297)
          {
LABEL_35:
            v51 = [(UICollectionView *)self _cellForItemAtIndexPath:v50];

            if (!v51)
            {
              goto LABEL_100;
            }
          }
        }

        v303 = v48;
        v347 = 0u;
        v348 = 0u;
        v345 = 0u;
        v346 = 0u;
        v318 = v289;
        v52 = [v318 countByEnumeratingWithState:&v345 objects:v363 count:16];
        v53 = v309;
        v315 = v307;
        if (!v52)
        {
          goto LABEL_70;
        }

        v54 = v52;
        v55 = *v346;
        v53 = v309;
        v315 = v307;
        do
        {
          v56 = 0;
          do
          {
            if (*v346 != v55)
            {
              objc_enumerationMutation(v318);
            }

            v57 = *(*(&v345 + 1) + 8 * v56);
            v58 = [(UICollectionViewUpdateItem *)v57 _indexPath];
            v59 = [v58 isEqual:v50];

            if (v59)
            {
              v63 = [MEMORY[0x1E696AAA8] currentHandler];
              v64 = [(UICollectionViewUpdateItem *)v57 _indexPath];
              [v63 handleFailureInMethod:a2 object:v306 file:@"UICollectionView.m" lineNumber:10552 description:{@"attempt to delete and reload the same index path (%@)", v64}];

              if (!v57)
              {
LABEL_49:
                v60 = 0;
LABEL_50:
                LODWORD(v62) = 0;
                goto LABEL_51;
              }
            }

            else if (!v57)
            {
              goto LABEL_49;
            }

            v60 = v57[1];
            if (v57[6] != 0x7FFFFFFFFFFFFFFFLL)
            {
              goto LABEL_50;
            }

            if (v49)
            {
              v61 = v49[1];
            }

            else
            {
              v61 = 0;
            }

            if (v60 == v61)
            {
              goto LABEL_64;
            }

            LODWORD(v62) = 1;
LABEL_51:
            if (v60 <= v53)
            {
              v62 = v62;
            }

            else
            {
              v62 = 0;
            }

            v53 -= v62;
            if ((!v49 || v49[6] != 0x7FFFFFFFFFFFFFFFLL) && (!v57 || v57[6] != 0x7FFFFFFFFFFFFFFFLL) && v60 == v53)
            {
              if (([v313 containsIndex:v60] & 1) == 0)
              {
                if (v57)
                {
                  v65 = v57[2];
                }

                else
                {
                  v65 = 0;
                }

                v315 -= v65 <= v315;
              }

              v53 = v60;
            }

LABEL_64:
            ++v56;
          }

          while (v54 != v56);
          v66 = [v318 countByEnumeratingWithState:&v345 objects:v363 count:16];
          v54 = v66;
        }

        while (v66);
LABEL_70:

        v343 = 0u;
        v344 = 0u;
        v341 = 0u;
        v342 = 0u;
        v67 = v287;
        v68 = [v67 countByEnumeratingWithState:&v341 objects:v362 count:16];
        if (v68)
        {
          v69 = v68;
          v70 = *v342;
          self = v306;
          do
          {
            v71 = 0;
            do
            {
              if (*v342 != v70)
              {
                objc_enumerationMutation(v67);
              }

              v72 = *(*(&v341 + 1) + 8 * v71);
              if (v72)
              {
                v73 = v72[3];
                LODWORD(v74) = v72[6] == 0x7FFFFFFFFFFFFFFFLL;
              }

              else
              {
                v73 = 0;
                LODWORD(v74) = 0;
              }

              if (v73 <= v53)
              {
                v74 = v74;
              }

              else
              {
                v74 = 0;
              }

              v53 += v74;
              if ((!v49 || v49[6] != 0x7FFFFFFFFFFFFFFFLL) && (!v72 || v72[6] != 0x7FFFFFFFFFFFFFFFLL) && v73 == v53 && ([v314 containsIndex:?] & 1) == 0)
              {
                if (v72)
                {
                  v75 = v72[4];
                }

                else
                {
                  v75 = 0;
                }

                v76 = v315;
                if (v75 <= v315)
                {
                  v76 = v315 + 1;
                }

                v315 = v76;
              }

              ++v71;
            }

            while (v69 != v71);
            v77 = [v67 countByEnumeratingWithState:&v341 objects:v362 count:16];
            v69 = v77;
          }

          while (v77);
        }

        else
        {
          self = v306;
        }

        v78 = [UICollectionViewUpdateItem alloc];
        v79 = [MEMORY[0x1E696AC88] indexPathForRow:v307 inSection:v309];
        v80 = [(UICollectionViewUpdateItem *)v78 initWithAction:1 forIndexPath:v79];

        [(NSMutableArray *)self->_deleteItems addObject:v80];
        v81 = [UICollectionViewUpdateItem alloc];
        v82 = [MEMORY[0x1E696AC88] indexPathForRow:v315 inSection:v53];
        v83 = [(UICollectionViewUpdateItem *)v81 initWithAction:0 forIndexPath:v82];

        v84 = [(UICollectionViewUpdateItem *)v83 _indexPath];
        [(UICollectionViewUpdateItem *)v49 _setNewIndexPath:v84];

        [(NSMutableArray *)self->_insertItems addObject:v83];
        v48 = v303;
LABEL_100:
        ++v48;
      }

      while (v48 != v299);
      v85 = [obj countByEnumeratingWithState:&v349 objects:v364 count:16];
      v299 = v85;
    }

    while (v85);
  }

  v86 = [(NSMutableArray *)self->_deleteItems sortedArrayUsingSelector:sel_inverseCompareIndexPaths_];
  v284 = [v86 mutableCopy];

  v87 = [(NSMutableArray *)self->_insertItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  v291 = [v87 mutableCopy];

  v88 = v277;
  v89 = v285;
  if ([(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shouldRebaseForUpdates]&& ![(UICollectionView *)self _isPerformingShadowUpdates])
  {
    v90 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v285, "count") + objc_msgSend(v284, "count") + objc_msgSend(v291, "count")}];
    [(UICollectionView *)v90 addObjectsFromArray:v284];
    [(UICollectionView *)v90 addObjectsFromArray:v285];
    [(UICollectionView *)v90 addObjectsFromArray:v291];
    if (![(_UICollectionViewDragAndDropController *)self->_dragAndDropController rebaseForUpdates:v90])
    {
      v200 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492560) + 8);
      if (os_log_type_enabled(v200, OS_LOG_TYPE_ERROR))
      {
        v201 = [(UICollectionViewData *)v277 dataSourceCountsDescription];
        dragAndDropController = self->_dragAndDropController;
        *buf = 138412802;
        v358 = v201;
        v359 = 2112;
        *v360 = v90;
        *&v360[8] = 2112;
        v361 = dragAndDropController;
        _os_log_impl(&dword_188A29000, v200, OS_LOG_TYPE_ERROR, "UICollectionView failed to rebase drag and drop or reordering items for incoming update, falling back to reload data. Pre-update data source counts: %@; update items: %@; drag and drop controller: %@", buf, 0x20u);
      }

      v308 = 0;
      v298 = 0;
      v181 = 0;
      goto LABEL_287;
    }
  }

  if ([v285 count])
  {
    v91 = [objc_alloc(MEMORY[0x1E696AB50]) initWithCapacity:{objc_msgSend(v285, "count")}];
    v92 = [objc_alloc(MEMORY[0x1E696AB50]) initWithCapacity:{objc_msgSend(v285, "count")}];
    v337 = 0u;
    v338 = 0u;
    v339 = 0u;
    v340 = 0u;
    v93 = v285;
    v94 = [v93 countByEnumeratingWithState:&v337 objects:v356 count:16];
    if (v94)
    {
      v95 = v94;
      v96 = *v338;
      do
      {
        for (i = 0; i != v95; ++i)
        {
          if (*v338 != v96)
          {
            objc_enumerationMutation(v93);
          }

          v98 = *(*(&v337 + 1) + 8 * i);
          v99 = [(UICollectionViewUpdateItem *)v98 _indexPath];
          [v91 addObject:v99];

          v100 = [(UICollectionViewUpdateItem *)v98 _newIndexPath];
          [v92 addObject:v100];
        }

        v95 = [v93 countByEnumeratingWithState:&v337 objects:v356 count:16];
      }

      while (v95);
    }

    v88 = v277;
    v89 = v285;
  }

  else
  {
    v92 = 0;
    v91 = 0;
  }

  v90 = v284;
  v103 = v89;
  v308 = v91;
  v298 = v92;
  v104 = v291;
  v295 = v88;
  if (!self)
  {

    v181 = 0;
    v198 = 1;
    self = v306;
    v88 = v277;
    goto LABEL_288;
  }

  v292 = v90;
  if ([(UICollectionView *)v90 count])
  {
    v105 = 0;
    v106 = 0;
    do
    {
      v107 = [(UICollectionView *)v90 objectAtIndexedSubscript:v105];
      v108 = v107;
      if (v107)
      {
        v109 = v107[1];
        v110 = v107[6] == 0x7FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v109 = 0;
        v110 = 0;
      }

      v319 = v110;
      if (!v308 || v110)
      {
        if (!v308)
        {
LABEL_129:
          v113 = [v103 count];
          goto LABEL_132;
        }
      }

      else
      {
        v111 = [(UICollectionViewUpdateItem *)v107 _indexPath];
        v112 = [v308 containsObject:v111];

        if ((v112 & 1) == 0)
        {
          goto LABEL_129;
        }
      }

      v113 = 0;
LABEL_132:
      while ([v103 count] > v113)
      {
        v114 = [v103 objectAtIndexedSubscript:v113];
        if ([(UICollectionViewUpdateItem *)v114 _initialIndexPathEqualToUpdateItem:v108])
        {
          if (v114)
          {
            v115 = v114[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v115 = 0;
          }

          v116 = [MEMORY[0x1E696AAA8] currentHandler];
          v117 = v116;
          if (v115)
          {
            [v116 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10896 description:{@"attempt to perform a delete and a move from the same section (%ld)", v109}];
          }

          else
          {
            v118 = [(UICollectionViewUpdateItem *)v108 _indexPath];
            [v117 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10899 description:{@"attempt to perform a delete and a move from the same index path (%@)", v118}];
          }
        }

        ++v113;
      }

      if (v319)
      {
        v90 = v292;
        if (v109 >= [(UICollectionViewData *)v295 numberOfSections])
        {
          v124 = [MEMORY[0x1E696AAA8] currentHandler];
          [v124 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10906 description:{@"attempt to delete section %ld, but there are only %ld sections before the update", v109, -[UICollectionViewData numberOfSections](v295)}];
        }

        if ([(UICollectionView *)v292 count])
        {
          v119 = 0;
          v120 = 0;
          do
          {
            v121 = [(UICollectionView *)v292 objectAtIndexedSubscript:v119];
            if (v121)
            {
              if (v121[6] == 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_152;
              }

              v122 = v121[1];
            }

            else
            {
              v122 = 0;
            }

            if (v122 != v109)
            {
LABEL_152:
              ++v120;
              goto LABEL_153;
            }

            [(UICollectionView *)v292 removeObjectAtIndex:v119];
            v106 -= v120 < v106;
LABEL_153:
            v119 = v120;
          }

          while ([(UICollectionView *)v292 count]> v120);
        }
      }

      else
      {
        v90 = v292;
        if (v108)
        {
          v123 = v108[2];
        }

        else
        {
          v123 = 0;
        }

        if (v109 >= [(UICollectionViewData *)v295 numberOfSections])
        {
          v125 = [MEMORY[0x1E696AAA8] currentHandler];
          [v125 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10924 description:{@"attempt to delete item %ld from section %ld, but there are only %ld sections before the update", v123, v109, -[UICollectionViewData numberOfSections](v295)}];
        }

        if (v123 >= [(UICollectionViewData *)v295 numberOfItemsInSection:v109])
        {
          v126 = [MEMORY[0x1E696AAA8] currentHandler];
          [v126 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10925 description:{@"attempt to delete item %ld from section %ld which only contains %ld items before the update", v123, v109, -[UICollectionViewData numberOfItemsInSection:](v295, v109)}];
        }
      }

      v105 = ++v106;
    }

    while ([(UICollectionView *)v90 count]> v106);
  }

  if ([v104 count])
  {
    v127 = 0;
    v128 = 0;
    do
    {
      v129 = [v104 objectAtIndexedSubscript:v127];
      v130 = v129;
      if (v129)
      {
        v131 = v129[3];
        v132 = v129[6] == 0x7FFFFFFFFFFFFFFFLL;
      }

      else
      {
        v131 = 0;
        v132 = 0;
      }

      v320 = v132;
      if (!v298 || v132)
      {
        if (!v298)
        {
LABEL_173:
          v135 = [v103 count];
          goto LABEL_176;
        }
      }

      else
      {
        v133 = [(UICollectionViewUpdateItem *)v129 _indexPath];
        v134 = [v298 containsObject:v133];

        if ((v134 & 1) == 0)
        {
          goto LABEL_173;
        }
      }

      v135 = 0;
LABEL_176:
      while ([v103 count] > v135)
      {
        v136 = [v103 objectAtIndexedSubscript:v135];
        if ([(UICollectionViewUpdateItem *)v136 _finalIndexPathEqualToUpdateItem:v130])
        {
          if (v136)
          {
            v137 = v136[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v137 = 0;
          }

          v138 = [MEMORY[0x1E696AAA8] currentHandler];
          v139 = v138;
          if (v137)
          {
            [v138 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10944 description:{@"attempt to perform an insert and a move to the same section (%ld)", v131}];
          }

          else
          {
            v140 = [(UICollectionViewUpdateItem *)v130 _indexPath];
            [v139 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10947 description:{@"attempt to perform an insert and a move to the same index path (%@)", v140}];
          }
        }

        ++v135;
      }

      if (v320)
      {
        if (v131 >= [(UICollectionViewData *)v306->_collectionViewData numberOfSections])
        {
          v146 = [MEMORY[0x1E696AAA8] currentHandler];
          [v146 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10954 description:{@"attempt to insert section %ld but there are only %ld sections after the update", v131, -[UICollectionViewData numberOfSections](v306->_collectionViewData)}];
        }

        if ([v104 count])
        {
          v141 = 0;
          v142 = 0;
          do
          {
            v143 = [v104 objectAtIndexedSubscript:v141];
            if (v143)
            {
              if (v143[6] == 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_196;
              }

              v144 = v143[3];
            }

            else
            {
              v144 = 0;
            }

            if (v144 != v131)
            {
LABEL_196:
              ++v142;
              goto LABEL_197;
            }

            [v104 removeObjectAtIndex:v141];
            v128 -= v142 < v128;
LABEL_197:
            v141 = v142;
          }

          while ([v104 count] > v142);
        }
      }

      else
      {
        if (v130)
        {
          v145 = v130[4];
        }

        else
        {
          v145 = 0;
        }

        if (v131 >= [(UICollectionViewData *)v306->_collectionViewData numberOfSections])
        {
          v147 = [MEMORY[0x1E696AAA8] currentHandler];
          [v147 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10972 description:{@"attempt to insert item %ld into section %ld, but there are only %ld sections after the update", v145, v131, -[UICollectionViewData numberOfSections](v306->_collectionViewData)}];
        }

        if (v145 >= [(UICollectionViewData *)v306->_collectionViewData numberOfItemsInSection:v131])
        {
          v148 = [MEMORY[0x1E696AAA8] currentHandler];
          [v148 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10973 description:{@"attempt to insert item %ld into section %ld, but there are only %ld items in section %ld after the update", v145, v131, -[UICollectionViewData numberOfItemsInSection:](v306->_collectionViewData, v131), v131}];
        }
      }

      v127 = ++v128;
    }

    while ([v104 count] > v128);
  }

  if ([v103 count])
  {
    v149 = 0;
    do
    {
      v150 = [v103 objectAtIndexedSubscript:v149];
      v321 = [(UICollectionViewUpdateItem *)v150 _indexPath];
      v316 = [(UICollectionViewUpdateItem *)v150 _newIndexPath];
      if (v150)
      {
        v152 = v150[1];
        v151 = v150[2];
        v153 = v150[4];
        v310 = v150[3];
        v154 = v150[6];
        v155 = [(UICollectionViewData *)v295 numberOfSections];
        if (v154 == 0x7FFFFFFFFFFFFFFFLL)
        {
          v304 = v152;
          if (v152 >= v155)
          {
            v177 = [MEMORY[0x1E696AAA8] currentHandler];
            [v177 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10990 description:{@"attempt to move section %ld, but there are only %ld sections before the update", v152, -[UICollectionViewData numberOfSections](v295)}];
          }

          v156 = v310;
          if (v310 >= [(UICollectionViewData *)v306->_collectionViewData numberOfSections])
          {
            v157 = [MEMORY[0x1E696AAA8] currentHandler];
            [v157 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10991 description:{@"attempt to to move section %ld to section %ld, but there are only %ld sections after the update", v152, v310, -[UICollectionViewData numberOfSections](v306->_collectionViewData)}];
LABEL_256:

            goto LABEL_225;
          }

          goto LABEL_225;
        }

        v300 = v149;
        v158 = v153;
        v159 = v151;
        v160 = v152;
        if (v152 >= v155)
        {
LABEL_258:
          v179 = v160;
          v180 = [MEMORY[0x1E696AAA8] currentHandler];
          [v180 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10994 description:{@"attempt to move index path (%@) from a section that does not exist - there are only %ld sections before the update", v321, -[UICollectionViewData numberOfSections](v295)}];

          v160 = v179;
          v158 = v153;
          v159 = v151;
        }
      }

      else
      {
        v300 = v149;
        v178 = [(UICollectionViewData *)v295 numberOfSections];
        v153 = 0;
        v151 = 0;
        v160 = 0;
        v310 = 0;
        v158 = 0;
        v159 = 0;
        if (v178 <= 0)
        {
          goto LABEL_258;
        }
      }

      v304 = v160;
      if (v159 >= [(UICollectionViewData *)v295 numberOfItemsInSection:v160])
      {
        v175 = [MEMORY[0x1E696AAA8] currentHandler];
        [v175 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10995 description:{@"attempt to move index path (%@) that does not exist - there are only %ld items in section %ld before the update", v321, -[UICollectionViewData numberOfItemsInSection:](v295, v304), v304}];
      }

      v156 = v310;
      if (v310 >= [(UICollectionViewData *)v306->_collectionViewData numberOfSections])
      {
        v176 = [MEMORY[0x1E696AAA8] currentHandler];
        [v176 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10996 description:{@"attempt to move index path (%@) to index path (%@) in section that does not exist - there are only %ld sections after the update", v321, v316, -[UICollectionViewData numberOfSections](v306->_collectionViewData)}];
      }

      if (v158 >= [(UICollectionViewData *)v306->_collectionViewData numberOfItemsInSection:v310])
      {
        v157 = [MEMORY[0x1E696AAA8] currentHandler];
        [v157 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:10997 description:{@"attempt to move index path (%@) to index path (%@) that does not exist - there are only %ld items in section %ld after the update", v321, v316, -[UICollectionViewData numberOfItemsInSection:](v306->_collectionViewData, v310), v310}];
        v149 = v300;
        goto LABEL_256;
      }

      v149 = v300;
LABEL_225:
      v311 = v156;
      v161 = v149 + 1;
      v162 = v161;
      if ([v308 countForObject:v321] == 1)
      {
        v162 = v161;
        if ([v298 countForObject:v316] == 1)
        {
          v162 = [v103 count];
        }
      }

      v301 = v161;
      if ([v103 count] > v162)
      {
        v163 = v162;
        while (1)
        {
          v164 = [v103 objectAtIndexedSubscript:v163];
          v165 = [(UICollectionViewUpdateItem *)v164 _indexPath];
          v166 = [(UICollectionViewUpdateItem *)v164 _newIndexPath];
          v167 = [(UICollectionViewUpdateItem *)v150 _initialIndexPathEqualToUpdateItem:v164];
          v168 = [(UICollectionViewUpdateItem *)v150 _finalIndexPathEqualToUpdateItem:v164];
          if (!v167)
          {
            break;
          }

          if (!v168)
          {
            if (v150)
            {
              v172 = v150[6] == 0x7FFFFFFFFFFFFFFFLL;
            }

            else
            {
              v172 = 0;
            }

            v173 = [MEMORY[0x1E696AAA8] currentHandler];
            v171 = v173;
            if (v172)
            {
              if (v164)
              {
                v174 = v164[3];
              }

              else
              {
                v174 = 0;
              }

              [v173 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:11016 description:{@"attempt to move section %ld to both section %ld and section %ld", v304, v311, v174}];
            }

            else
            {
              [v173 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:11019 description:{@"attempt to move item at index path %@ to both %@ and %@", v321, v316, v166}];
            }

            goto LABEL_246;
          }

          [v103 removeObjectAtIndex:v163];
LABEL_248:
          v163 = v162;
          if ([v103 count] <= v162)
          {
            goto LABEL_253;
          }
        }

        if (v168)
        {
          if (v150)
          {
            v169 = v150[6] == 0x7FFFFFFFFFFFFFFFLL;
          }

          else
          {
            v169 = 0;
          }

          v170 = [MEMORY[0x1E696AAA8] currentHandler];
          v171 = v170;
          if (v169)
          {
            [v170 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:11025 description:{@"attempt to move both section %ld and section %ld to section %ld", objc_msgSend(v321, "section"), objc_msgSend(v165, "section"), objc_msgSend(v316, "section")}];
          }

          else
          {
            [v170 handleFailureInMethod:sel__validateSortedDeleteItems_moveItems_movedSourceIndexPaths_movedDestinationIndexPaths_insertItems_oldCollectionViewData_ object:v306 file:@"UICollectionView.m" lineNumber:11028 description:{@"attempt to move both item at index path %@ and %@ to %@", v321, v165, v316}];
          }

LABEL_246:
        }

        ++v162;
        goto LABEL_248;
      }

LABEL_253:
      v149 = v301;
    }

    while ([v103 count] > v301);
  }

  v181 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v103, "count") + -[UICollectionView count](v292, "count") + objc_msgSend(v104, "count")}];
  [v181 addObjectsFromArray:v292];
  [v181 addObjectsFromArray:v103];
  [v181 addObjectsFromArray:v104];
  v182 = [UICollectionViewUpdate alloc];
  self = v306;
  v183 = [(UICollectionViewUpdate *)&v182->super.isa initWithCollectionView:v306 updateItems:v181 moveItemSourceIndexPaths:v308 moveItemDestinationIndexPaths:v298 oldModel:v295 newModel:v306->_collectionViewData oldContentOffset:*MEMORY[0x1E695EFF8] newContentOffset:*(MEMORY[0x1E695EFF8] + 8), *MEMORY[0x1E695EFF8], *(MEMORY[0x1E695EFF8] + 8)];
  currentUpdate = v306->_currentUpdate;
  v306->_currentUpdate = v183;

  v185 = v306->_currentUpdate;
  if (!v185 || !v185->_updateMaps.updatesAreInvalid)
  {
    [(_UICollectionViewDragAndDropController *)v306->_dragAndDropController commitReorderedItems];
    v88 = v277;
    if (dyld_program_sdk_at_least())
    {
      v189 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492570);
      if (*v189)
      {
        v273 = *(v189 + 8);
        if (os_log_type_enabled(v273, OS_LOG_TYPE_ERROR))
        {
          *buf = 134218242;
          v358 = v306;
          v359 = 2112;
          *v360 = v295;
          _os_log_impl(&dword_188A29000, v273, OS_LOG_TYPE_ERROR, "_endItemAnims: cv == %p; Attempting to save anchor for data %@", buf, 0x16u);
        }

        v88 = v277;
      }

      [(UICollectionView *)v306 _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:v295];
    }

    [(UICollectionViewLayout *)v306->_layout _prepareForCollectionViewUpdates:v181 withDataSourceTranslator:v306->_currentUpdate];
    v190 = v306->_collectionViewData;
    if (v190)
    {
      v190->_preUpdateCachedItemCount = v190->_globalItemMap.__table_.__size_;
    }

    if (!v281)
    {
      v281 = objc_alloc_init([objc_opt_class() invalidationContextClass]);
    }

    if (!v276 && [v181 count])
    {
      [v281 _setInvalidateDataSourceCounts:1];
    }

    [v281 _setUpdateItems:v181];
    if ([(UICollectionViewLayout *)v306->_layout _estimatesSizes])
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v191 = v281;
        [v191 _setRetainExistingSizingInfoForEstimates:1];
      }
    }

    [(UICollectionViewLayout *)v306->_layout _invalidateLayoutUsingContext:v281];
    v192 = [(UICollectionView *)v306 _dataSourceActual];
    v193 = objc_opt_respondsToSelector();

    if (v193)
    {
      v194 = [(UICollectionView *)v306 _dataSourceActual];
      [v194 _collectionView:v306 willPerformUpdates:v181];
    }

    v195 = [(UICollectionView *)v306 _focusedItemState];
    v196 = v306->_currentUpdate;
    newFocusedItemState = v196->_newFocusedItemState;
    v196->_newFocusedItemState = v195;

    objc_storeStrong(&v306->_currentUpdate->_oldFocusedItemState, v195);
    v198 = 0;
    v199 = 1;
    goto LABEL_289;
  }

  v186 = MEMORY[0x1E696AEC0];
  v187 = v185->_invalidUpdatesErrorMessage;
  v90 = [v186 stringWithFormat:@"%@\nCollection view: %@", v187, v306];

  v88 = v277;
  if (dyld_program_sdk_at_least() && ![(UICollectionView *)v306 _isConnectedToDiffableDataSource]&& !_UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(v90))
  {
    [(UICollectionView *)v306 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:v90];
    v198 = 0;
    goto LABEL_288;
  }

  if (os_variant_has_internal_diagnostics())
  {
    v188 = __UIFaultDebugAssertLog();
    if (os_log_type_enabled(v188, OS_LOG_TYPE_FAULT))
    {
      *buf = 138412290;
      v358 = v90;
      _os_log_fault_impl(&dword_188A29000, v188, OS_LOG_TYPE_FAULT, "Performing reloadData as a fallback  %@", buf, 0xCu);
    }
  }

  else
  {
    v188 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492568) + 8);
    if (os_log_type_enabled(v188, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      v358 = v90;
      _os_log_impl(&dword_188A29000, v188, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
    }
  }

LABEL_287:
  v198 = 1;
LABEL_288:

  [(_UICollectionViewDragAndDropController *)self->_dragAndDropController commitReorderedItems];
  v199 = 0;
LABEL_289:
  v203 = [(UICollectionViewData *)v88 numberOfSections];
  v204 = malloc_type_malloc(8 * v203, 0x100004000313F17uLL);
  if (v203 >= 1)
  {
    for (j = 0; j != v203; ++j)
    {
      v204[j] = [(UICollectionViewData *)v88 numberOfItemsInSection:?];
    }
  }

  v206 = [(UICollectionViewData *)self->_collectionViewData numberOfSections];
  v207 = malloc_type_calloc(8uLL, v206, 0x100004000313F17uLL);
  v312 = malloc_type_calloc(8uLL, v203, 0x100004000313F17uLL);
  v322 = malloc_type_calloc(8uLL, v206, 0x100004000313F17uLL);
  v296 = v203;
  v317 = malloc_type_calloc(8uLL, v203, 0x100004000313F17uLL);
  if ((v199 & 1) == 0)
  {
    v216 = 0;
    v217 = p_collectionViewFlags;
    v218 = v285;
    goto LABEL_368;
  }

  v305 = v206;
  v290 = v204;
  v288 = v198;
  v293 = v181;
  v335 = 0u;
  v336 = 0u;
  v333 = 0u;
  v334 = 0u;
  v208 = v284;
  v209 = [v208 countByEnumeratingWithState:&v333 objects:v355 count:16];
  if (!v209)
  {
    v211 = 0;
    v213 = v203;
    goto LABEL_308;
  }

  v210 = v209;
  v211 = 0;
  v212 = *v334;
  v213 = v203;
  do
  {
    for (k = 0; k != v210; ++k)
    {
      if (*v334 != v212)
      {
        objc_enumerationMutation(v208);
      }

      v215 = *(*(&v333 + 1) + 8 * k);
      if (v215)
      {
        if (*(v215 + 48) == 0x7FFFFFFFFFFFFFFFLL)
        {
          v211 = (v211 + 1);
          --v213;
          continue;
        }

        v215 = *(v215 + 40);
      }

      ++v312[v215];
    }

    v210 = [v208 countByEnumeratingWithState:&v333 objects:v355 count:16];
  }

  while (v210);
LABEL_308:

  v331 = 0u;
  v332 = 0u;
  v329 = 0u;
  v330 = 0u;
  v219 = v291;
  v220 = [v219 countByEnumeratingWithState:&v329 objects:v354 count:16];
  if (!v220)
  {
    v222 = 0;
    goto LABEL_322;
  }

  v221 = v220;
  v222 = 0;
  v223 = *v330;
  while (2)
  {
    v224 = 0;
    while (2)
    {
      if (*v330 != v223)
      {
        objc_enumerationMutation(v219);
      }

      v225 = *(*(&v329 + 1) + 8 * v224);
      if (v225)
      {
        if (*(v225 + 48) == 0x7FFFFFFFFFFFFFFFLL)
        {
          v222 = (v222 + 1);
          ++v213;
          goto LABEL_318;
        }

        v225 = *(v225 + 40);
      }

      ++v207[v225];
LABEL_318:
      if (v221 != ++v224)
      {
        continue;
      }

      break;
    }

    v221 = [v219 countByEnumeratingWithState:&v329 objects:v354 count:16];
    if (v221)
    {
      continue;
    }

    break;
  }

LABEL_322:
  v302 = v207;

  v327 = 0u;
  v328 = 0u;
  v325 = 0u;
  v326 = 0u;
  v218 = v285;
  v226 = v285;
  v227 = [v226 countByEnumeratingWithState:&v325 objects:v353 count:16];
  if (!v227)
  {
    goto LABEL_336;
  }

  v228 = v227;
  v229 = *v326;
  while (2)
  {
    v230 = 0;
    while (2)
    {
      if (*v326 != v229)
      {
        objc_enumerationMutation(v226);
      }

      v231 = *(*(&v325 + 1) + 8 * v230);
      if (!v231)
      {
        v232 = 0;
        v233 = 0;
        goto LABEL_330;
      }

      if (v231[6] != 0x7FFFFFFFFFFFFFFFLL)
      {
        v232 = v231[1];
        v233 = v231[3];
LABEL_330:
        if ([(UICollectionViewUpdate *)v306->_currentUpdate finalSectionIndexForInitialSectionIndex:v232]!= v233)
        {
          ++v317[v232];
          ++v322[v233];
        }
      }

      ++v230;
      v218 = v285;
      if (v228 != v230)
      {
        continue;
      }

      break;
    }

    v234 = [v226 countByEnumeratingWithState:&v325 objects:v353 count:16];
    v228 = v234;
    if (v234)
    {
      continue;
    }

    break;
  }

LABEL_336:

  if (v213 != v305)
  {
    self = v306;
    v243 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of sections. The number of sections contained in the collection view after the update (%d) must be equal to the number of sections contained in the collection view before the update (%d), plus or minus the number of sections inserted or deleted (%d inserted, %d deleted). Collection view: %@", v305, v296, v222, v211, v306];
    v207 = v302;
    if ([(UICollectionView *)v306 _isConnectedToDiffableDataSource])
    {
      v244 = [(UICollectionView *)v306 _diffableDataSourceImpl];
      v245 = [v244 currentTransaction];
      v246 = v245;
      v217 = p_collectionViewFlags;
      v88 = v277;
      v204 = v290;
      if (v244 && v245)
      {
        v247 = [(UICollectionView *)v243 stringByAppendingFormat:@" Diffable transaction: %@", v245];;

        v243 = v247;
      }

      v248 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492578) + 8);
      if (os_log_type_enabled(v248, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v358 = v243;
        _os_log_impl(&dword_188A29000, v248, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
      }

      v198 = 1;
      v181 = v293;
    }

    else
    {
      [(UICollectionView *)v306 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:v243];
      v217 = p_collectionViewFlags;
      v88 = v277;
      v181 = v293;
      v198 = v288;
      v204 = v290;
    }

    goto LABEL_367;
  }

  self = v306;
  v181 = v293;
  if (v305 < 1)
  {
    v216 = 1;
    v217 = p_collectionViewFlags;
    v88 = v277;
    v198 = v288;
    v204 = v290;
LABEL_353:
    v207 = v302;
    goto LABEL_368;
  }

  v235 = 0;
  v88 = v277;
  v204 = v290;
  while (2)
  {
    v236 = [(UICollectionViewUpdate *)v306->_currentUpdate initialSectionIndexForFinalSectionIndex:v235];
    if (v236 == 0x7FFFFFFFFFFFFFFFLL)
    {
LABEL_342:
      if (v305 == ++v235)
      {
        v216 = 1;
        v217 = p_collectionViewFlags;
        v218 = v285;
        v198 = v288;
        goto LABEL_353;
      }

      continue;
    }

    break;
  }

  v237 = v236;
  v238 = v290[v236];
  v239 = [(UICollectionViewData *)v306->_collectionViewData numberOfItemsInSection:v235];
  if ((v239 & 0x8000000000000000) == 0)
  {
    v240 = v322[v235];
    v241 = v312[v237];
    v242 = v302[v235];
    if (v239 != v238 + v240 - (v317[v237] + v241) + v242)
    {
      v243 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of items in section %d. The number of items contained in an existing section after the update (%d) must be equal to the number of items contained in that section before the update (%d), plus or minus the number of items inserted or deleted from that section (%d inserted, %d deleted) and plus or minus the number of items moved into or out of that section (%d moved in, %d moved out). Collection view: %@", v235, v239, v238, v242, v241, v240, v317[v237], v306];
      if (!dyld_program_sdk_at_least() || [(UICollectionView *)v306 _isConnectedToDiffableDataSource]|| _UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(v243))
      {
        v249 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492588) + 8);
        v217 = p_collectionViewFlags;
        v218 = v285;
        v207 = v302;
        if (os_log_type_enabled(v249, OS_LOG_TYPE_ERROR))
        {
          *buf = 138412290;
          v358 = v243;
LABEL_365:
          _os_log_impl(&dword_188A29000, v249, OS_LOG_TYPE_ERROR, "Performing reloadData as a fallback  %@", buf, 0xCu);
        }

        goto LABEL_366;
      }

      goto LABEL_389;
    }

    goto LABEL_342;
  }

  v243 = [MEMORY[0x1E696AEC0] stringWithFormat:@"Invalid update: invalid number of items in section %d. Attempt to delete more items than exist in section. Collection view: %@", v237, v306];
  if (!dyld_program_sdk_at_least() || [(UICollectionView *)v306 _isConnectedToDiffableDataSource]|| _UICollectionViewShouldRescueClientWithReloadDataFallbackForInvalidBatchUpdates(v243))
  {
    v249 = *(__UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492580) + 8);
    v217 = p_collectionViewFlags;
    v218 = v285;
    v207 = v302;
    if (os_log_type_enabled(v249, OS_LOG_TYPE_ERROR))
    {
      *buf = 138412290;
      v358 = v243;
      goto LABEL_365;
    }

LABEL_366:

    v198 = 1;
    goto LABEL_367;
  }

LABEL_389:
  [(UICollectionView *)v306 _Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:v243];
  v217 = p_collectionViewFlags;
  v218 = v285;
  v198 = v288;
  v207 = v302;
LABEL_367:

  v216 = 0;
LABEL_368:
  free(v204);
  free(v207);
  free(v312);
  free(v322);
  free(v317);
  if (v216)
  {
    v102 = [(UICollectionView *)self _updateWithItems:v181 tentativelyForReordering:v276 propertyAnimator:v280 collectionViewAnimator:v279];
    if (![(UICollectionViewLayout *)self->_layout _estimatesSizes])
    {
      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }
  }

  else
  {
    v102 = 0;
  }

  if (v198)
  {
LABEL_373:
    v250 = self->_currentUpdate;
    self->_currentUpdate = 0;

    v251 = _Block_copy(self->_updateCompletionHandler);
    updateCompletionHandler = self->_updateCompletionHandler;
    self->_updateCompletionHandler = 0;

    if (![(UICollectionViewLayout *)self->_layout _estimatesSizes])
    {
      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }

    [(UICollectionView *)self reloadData];
    if (v251)
    {
      v253 = MEMORY[0x1E69E96A0];
      v254 = MEMORY[0x1E69E96A0];
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __119__UICollectionView__endItemAnimationsWithInvalidationContext_tentativelyForReordering_animator_collectionViewAnimator___block_invoke;
      block[3] = &unk_1E70F0F78;
      v324 = v251;
      dispatch_async(v253, block);
    }

    v217 = p_collectionViewFlags;
  }

  --self->_updateCount;
  [(UICollectionView *)self _resetUpdateItemArrays];
  *(v217 + 1) &= ~0x1000000000uLL;
  [(UICollectionView *)self _resumeReloads];
  if ((*(v217 + 13) & 2) != 0)
  {
    [(UICollectionView *)self _updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:v14, v15, v16, v17];
    [(UIView *)self setNeedsFocusUpdate];
    *(v217 + 1) &= ~0x20000000000uLL;
  }

  postUpdateBlock = self->_postUpdateBlock;
  if (postUpdateBlock)
  {
    v256 = _Block_copy(postUpdateBlock);
    v257 = self->_postUpdateBlock;
    self->_postUpdateBlock = 0;

    v256[2](v256);
    v217 = p_collectionViewFlags;
  }

  if (v102 && (*(v217 + 9) & 4) != 0)
  {
    [(UICollectionView *)self _updateVisibleCellsNow:1];
  }

  _UIRestorePreviousFallbackEnvironment(v278);
  v258 = __UILogGetCategoryCachedImpl("CollectionView", &qword_1ED492590);
  v259 = *(v258 + 8);
  v260 = os_signpost_id_make_with_pointer(*(v258 + 8), self);
  if (v260 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
  {
    v261 = v260;
    if (os_signpost_enabled(v259))
    {
      *buf = 0;
      _os_signpost_emit_with_name_impl(&dword_188A29000, v259, OS_SIGNPOST_INTERVAL_END, v261, "BatchUpdates", "", buf, 2u);
    }
  }
}

- (id)_sectionsWithSectionOperationsInUpdateItems:(void *)a1
{
  v18 = *MEMORY[0x1E69E9840];
  v3 = a2;
  v4 = v3;
  if (a1)
  {
    v15 = 0u;
    v16 = 0u;
    v13 = 0u;
    v14 = 0u;
    v5 = [v3 countByEnumeratingWithState:&v13 objects:v17 count:16];
    if (v5)
    {
      v6 = v5;
      a1 = 0;
      v7 = *v14;
      do
      {
        for (i = 0; i != v6; ++i)
        {
          if (*v14 != v7)
          {
            objc_enumerationMutation(v4);
          }

          v9 = *(*(&v13 + 1) + 8 * i);
          if (v9 && v9[6] == 0x7FFFFFFFFFFFFFFFLL)
          {
            v10 = [(UICollectionViewUpdateItem *)v9 _indexPath];
            v11 = [v10 section];

            if (a1)
            {
              [a1 addIndex:v11];
            }

            else
            {
              a1 = [MEMORY[0x1E696AD50] indexSetWithIndex:v11];
            }
          }
        }

        v6 = [v4 countByEnumeratingWithState:&v13 objects:v17 count:16];
      }

      while (v6);
    }

    else
    {
      a1 = 0;
    }
  }

  return a1;
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Batch_Updates:(id)a3
{
  v5 = MEMORY[0x1E696AAA8];
  v6 = a3;
  v7 = [v5 currentHandler];
  [v7 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10867 description:{@"%@", v6}];
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Sections:(id)a3
{
  v5 = MEMORY[0x1E696AAA8];
  v6 = a3;
  v7 = [v5 currentHandler];
  [v7 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10872 description:{@"%@", v6}];
}

- (void)_Bug_Detected_In_Client_Of_UICollectionView_Invalid_Number_Of_Items_In_Section:(id)a3
{
  v5 = MEMORY[0x1E696AAA8];
  v6 = a3;
  v7 = [v5 currentHandler];
  [v7 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:10877 description:{@"%@", v6}];
}

- (void)_updateFocusedCellIndexPathIfNecessaryWithLastFocusedRect:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v8 = [(UICollectionView *)self _focusedItemState];
  v9 = v8;
  if (v8)
  {
    v10 = *(v8 + 16);
  }

  else
  {
    v10 = 0;
  }

  v25 = v10;

  if (v25)
  {
    v11 = [v25 item];
    v12 = [v25 section];
    v13 = [(UICollectionView *)self numberOfSections];
    if (v12 < v13)
    {
      v14 = -[UICollectionView numberOfItemsInSection:](self, "numberOfItemsInSection:", [v25 section]);
    }

    else
    {
      v14 = 0;
    }

    v15 = v11 == 0x7FFFFFFFFFFFFFFFLL || [v25 item] < v14;
    if (v12 < v13 && v15)
    {
      goto LABEL_19;
    }

    if (v12 < v13 && !v15 && v14)
    {
      v16 = [MEMORY[0x1E696AC88] indexPathForItem:v14 - 1 inSection:{objc_msgSend(v25, "section")}];
      v17 = [(UICollectionView *)self _focusedItemState];
      v18 = [(_UICollectionViewFocusedItemState *)v17 copyWithIndexPath:v16 preservingReusableView:0];
      [(UICollectionView *)self _setFocusedItemState:v18];
    }
  }

  v19 = [(UICollectionView *)self _focusedItemState];
  v20 = v19;
  if (v19)
  {
    v21 = *(v19 + 16);
    if (v21)
    {
      v22 = v21;
LABEL_18:

      goto LABEL_19;
    }
  }

  v27.origin.x = x;
  v27.origin.y = y;
  v27.size.width = width;
  v27.size.height = height;
  IsNull = CGRectIsNull(v27);

  if (!IsNull)
  {
    v20 = _UIFocusClosestFocusableViewToRectInView(self, x, y, width, height);
    v22 = [(UICollectionView *)self _managedSubviewForView:v20];
    if (v22)
    {
      v24 = [_UICollectionViewFocusedItemState stateWithReusableView:v22];
      [(UICollectionView *)self _setFocusedItemState:v24];
    }

    else
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }

    goto LABEL_18;
  }

LABEL_19:
}

- (void)_prepareLayoutForUpdates:(BOOL)a3
{
  v3 = a3;
  [(UICollectionViewData *)self->_collectionViewData _prepareToLoadData];
  v9 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v5 = [(NSArray *)self->_originalDeleteItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v5];

  v6 = [(NSArray *)self->_originalInsertItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v6];

  v7 = [(NSMutableArray *)self->_reloadItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v7];

  v8 = [(NSMutableArray *)self->_moveItems sortedArrayUsingSelector:sel_compareIndexPaths_];
  [v9 addObjectsFromArray:v8];

  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:v9 animated:v3];
}

- (id)_viewAnimationsForCurrentUpdateWithCollectionViewAnimator:(id)a3 updatingContentOffsetForRestorationAnchor:(BOOL)a4
{
  v4 = a4;
  v48 = *MEMORY[0x1E69E9840];
  v39 = a3;
  currentUpdate = self->_currentUpdate;
  if (!currentUpdate || (*&currentUpdate->_flags & 2) == 0)
  {
    v33 = [MEMORY[0x1E696AAA8] currentHandler];
    [v33 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:11140 description:{@"UICollectionView internal inconsistency: attempted to generate view animations for an update which is not animated. Collection view: %@", self, v39}];
  }

  v40 = [(_UICollectionViewSubviewManager *)self->_subviewManager allVisibleViewsHashTable];
  if ([(UICollectionViewLayout *)self->_layout _estimatesSizes]&& dyld_program_sdk_at_least())
  {
    [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate];
  }

  if (v4)
  {
    if (self->_contentOffsetRestorationAnchor)
    {
      v41 = 0;
      [(UIScrollView *)self _contentInsetIncludingDecorations];
      v10 = [(UICollectionView *)self _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:v8 shouldApply:v9];
      if (v41 == 1)
      {
        v12 = v10;
        v13 = v11;
        v14 = self->_currentUpdate;
        v14->_newContentOffset.x = v10;
        v14->_newContentOffset.y = v11;
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_viewAnimationsForCurrentUpdateWithCollectionViewAnimator_updatingContentOffsetForRestorationAnchor____s_category);
        if (*CategoryCachedImpl)
        {
          v34 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
          {
            contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
            v36 = v34;
            v37 = [(NSIndexPath *)contentOffsetRestorationAnchor _ui_shortDescription];
            v50.x = v12;
            v50.y = v13;
            v38 = NSStringFromCGPoint(v50);
            *buf = 134218498;
            v43 = self;
            v44 = 2112;
            v45 = v37;
            v46 = 2112;
            v47 = v38;
            _os_log_impl(&dword_188A29000, v36, OS_LOG_TYPE_ERROR, "_viewAnimationsForCurrentUpdate: cv == %p; readjusting content offset for anchor %@. New content offset: %@", buf, 0x20u);
          }
        }

        v16 = *(&self->_collectionViewFlags + 4);
        *(&self->_collectionViewFlags + 4) = v16 | 0x80000;
        [(UICollectionView *)self setContentOffset:v12, v13];
        *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v16 >> 19) & 1) << 19);
      }
    }
  }

  v17 = objc_alloc_init(_UICollectionViewSubviewCollection);
  [(UICollectionView *)self _populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:v17 addingDeletedViewsToSet:0 updateLayoutAttributesIndexPaths:0];
  v18 = objc_alloc_init(MEMORY[0x1E695DF70]);
  v19 = objc_opt_new();
  v20 = objc_opt_new();
  v21 = objc_opt_new();
  [(UICollectionView *)self _createAndAppendViewAnimationsForDeletesInCurrentUpdate:v18 disappearingAnimations:v20];
  [(UICollectionView *)self _createAndAppendViewAnimationsForInsertsInCurrentUpdate:v18 appearingAnimations:v19 newSubviewCollection:v17];
  newModel = self->_currentUpdate->_newModel;
  [(UICollectionView *)self _visibleBounds];
  v27 = [(UICollectionViewData *)newModel layoutAttributesForElementsInRect:v23, v24, v25, v26];
  [(UICollectionView *)self _createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:v18 animationsForOnScreenViews:v21 newSubviewCollection:v17 oldVisibleViews:v40 attributesForNewModel:v27];
  [(UICollectionView *)self _createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:v18 disappearingAnimations:v20 animationsForOnScreenViews:v21 newSubviewCollection:v17 oldVisibleViews:v40];
  [(UICollectionView *)self _createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:v18 appearingAnimations:v19 newSubviewCollection:v17];
  [(UICollectionView *)self _createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:v18 appearingAnimations:v19 animationsForOnScreenViews:v21 newSubviewCollection:v17 attributesForNewModel:v27];
  if (dyld_program_sdk_at_least() && [(UICollectionViewLayout *)self->_layout _wantsUntrackedAnimationCleanupForAuxillaryItems])
  {
    [(UICollectionView *)self _removeUntrackedAuxillaryViewsForBeforeVisibleViews:self->_subviewManager afterVisibleViews:v17 withTrackingViewAnimations:v18];
  }

  v28 = [(UICollectionView *)self indexPathsForVisibleItems];
  [(_UICollectionViewSubviewManager *)self->_subviewManager replaceVisibleViewsWithoutCopyingWithContentsOfSubviewCollection:?];
  v29 = [(UICollectionView *)self indexPathsForVisibleItems];
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:?];
  }

  [(UICollectionView *)self _updateOrderingOfViewsInDisappearingViewAnimations:v20 onScreenViewAnimations:v21];
  if (dyld_program_sdk_at_least())
  {
    v31 = [(_UILabelConfiguration *)v39 _content];
    [(_UICollectionLayoutItemSolver *)v31 setSolveResult:v19];
    [(_UICollectionLayoutListAttributes *)v31 setSeparatorVisualEffect:v20];
    [(UIBackgroundConfiguration *)v31 _setImage:v28];
    [(_UICollectionViewAnimationContext *)v31 setCurrentlyVisibleItemIndexPaths:v29];
    [(_UIDocumentUnavailableConfiguration *)v31 set_tintColor:v21];
    [(UICollectionView *)self _setupExpandCollapseAnimationsIfNeededWithContext:v31];
  }

  return v18;
}

void __120__UICollectionView__viewAnimationsForCurrentUpdateWithCollectionViewAnimator_updatingContentOffsetForRestorationAnchor___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v4 = a2;
  v5 = [a3 _layoutAttributes];
  [v5 setIndexPath:v4];
}

- (void)_populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:(id)a3 addingDeletedViewsToSet:(id)a4 updateLayoutAttributesIndexPaths:(BOOL)a5
{
  v9 = a3;
  v10 = a4;
  v11 = self->_currentUpdate;
  if (!v11)
  {
    v16 = [MEMORY[0x1E696AAA8] currentHandler];
    [v16 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:11259 description:{@"Invalid parameter not satisfying: %@", @"currentUpdate != nil"}];
  }

  subviewManager = self->_subviewManager;
  v17[0] = MEMORY[0x1E69E9820];
  v17[1] = 3221225472;
  v17[2] = __144__UICollectionView__populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate_addingDeletedViewsToSet_updateLayoutAttributesIndexPaths___block_invoke;
  v17[3] = &unk_1E70FF600;
  v18 = v11;
  v19 = v9;
  v22 = a5;
  v20 = v10;
  v21 = self;
  v13 = v10;
  v14 = v9;
  v15 = v11;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:v17];
  }
}

void __144__UICollectionView__populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate_addingDeletedViewsToSet_updateLayoutAttributesIndexPaths___block_invoke(uint64_t a1, uint64_t a2, void *a3, void *a4, void *a5)
{
  v15 = a3;
  v9 = a4;
  v10 = a5;
  if (a2)
  {
    if ([v15 length] == 1)
    {
      [(_UICollectionViewSubviewCollection *)*(a1 + 40) setView:v10 ofKind:v9 inCategory:a2 atIndexPath:v15];
    }

    else
    {
      v13 = [(UICollectionViewUpdate *)*(*(a1 + 56) + 2280) validatedNewIndexPathForSupplementaryElementOfKind:v9 oldIndexPath:v15];
      if (v13)
      {
        [(_UICollectionViewSubviewCollection *)*(a1 + 40) setView:v10 ofKind:v9 inCategory:a2 atIndexPath:v13];
        if (*(a1 + 64) == 1)
        {
          v14 = [v10 _layoutAttributes];
          [v14 setIndexPath:v13];
        }
      }

      else
      {
        [*(a1 + 48) addObject:v10];
      }
    }
  }

  else
  {
    v11 = [*(a1 + 32) finalIndexPathForInitialIndexPath:v15];
    if (v11)
    {
      [(_UICollectionViewSubviewCollection *)*(a1 + 40) setCell:v10 atIndexPath:v11];
      if (*(a1 + 64) == 1)
      {
        v12 = [v10 _layoutAttributes];
        [v12 setIndexPath:v11];
      }
    }

    else
    {
      [*(a1 + 48) addObject:v10];
    }
  }
}

- (void)_createAndAppendViewAnimationsForDeletesInCurrentUpdate:(id)a3 disappearingAnimations:(id)a4
{
  v70 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  v64[0] = MEMORY[0x1E69E9820];
  v64[1] = 3221225472;
  v65[0] = __99__UICollectionView__createAndAppendViewAnimationsForDeletesInCurrentUpdate_disappearingAnimations___block_invoke;
  v65[1] = &unk_1E70FF628;
  v65[2] = self;
  v52 = v6;
  v66 = v52;
  v51 = v7;
  v67 = v51;
  v60 = 0u;
  v61 = 0u;
  v62 = 0u;
  v63 = 0u;
  obj = self->_deleteItems;
  v8 = [(NSMutableArray *)obj countByEnumeratingWithState:&v60 objects:v69 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    v11 = *v61;
    v49 = self;
    v44 = *v61;
    v45 = v65;
    do
    {
      v12 = 0;
      v46 = v9;
      do
      {
        if (*v61 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v60 + 1) + 8 * v12);
        if (v13 && v13[6] == 0x7FFFFFFFFFFFFFFFLL)
        {
          v48 = v12;
          v14 = [(UICollectionViewUpdateItem *)v13 _indexPath];
          v15 = [v14 section];

          v16 = v10[215];
          v17 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v16))[2] numberOfItemsInSection:v15];
          v18 = (*(&self->super.super.super.super.isa + v16))[2];
          v19 = [MEMORY[0x1E696AC88] indexPathForRow:0 inSection:v15];
          v20 = [(UICollectionViewData *)v18 globalIndexForItemAtIndexPath:v19];

          if (v17 >= 1)
          {
            do
            {
              (v65[0])(v64, v20++);
              --v17;
            }

            while (v17);
          }

          v58 = 0u;
          v59 = 0u;
          v56 = 0u;
          v57 = 0u;
          self = v49;
          v54 = [(UICollectionViewData *)(*(&v49->super.super.super.super.isa + v16))[2] existingSupplementaryLayoutAttributesInSection:v15];
          v21 = [v54 countByEnumeratingWithState:&v56 objects:v68 count:16];
          if (v21)
          {
            v22 = v21;
            v55 = *v57;
            v23 = v54;
            v53 = v16;
            while (1)
            {
              v24 = 0;
              do
              {
                if (*v57 != v55)
                {
                  objc_enumerationMutation(v23);
                }

                v25 = *(*(&v56 + 1) + 8 * v24);
                v26 = [(UICollectionView *)self _visibleViewForLayoutAttributes:v25, v44, v45];
                if (v26)
                {
                  v27 = v26;
                  v28 = [(_UILabelConfiguration *)v25 _content];
                  v29 = [v25 indexPath];
                  v30 = [*(&self->super.super.super.super.isa + v16) finalIndexPathForSupplementaryElementOfKind:v28 forInitialIndexPath:v29];

                  if (!v30)
                  {
                    if (v25)
                    {
                      p_layout = &self->_layout;
                      layout = self->_layout;
                      if ((*(v25 + 288) & 2) == 0)
                      {
                        goto LABEL_19;
                      }

                      v33 = [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingDecorationElementOfKind:v28 atIndexPath:v29];
                    }

                    else
                    {
                      p_layout = &self->_layout;
                      layout = self->_layout;
LABEL_19:
                      v33 = [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingSupplementaryElementOfKind:v28 atIndexPath:v29];
                    }

                    v34 = v33;
                    if (v33)
                    {
                      if (dyld_program_sdk_at_least())
                      {
                        v50 = [v34 zIndex];
                        v35 = [v27 _layoutAttributes];
                        v36 = [v35 zIndex];

                        if (v50 == v36)
                        {
                          self = v49;
                        }

                        else
                        {
                          self = v49;
                          -[UICollectionView _addControlledSubview:atZIndex:forced:](v49, "_addControlledSubview:atZIndex:forced:", v27, [v34 zIndex], 1);
                        }
                      }
                    }

                    else
                    {
                      v34 = [v25 copy];
                      [v34 setAlpha:0.0];
                    }

                    v37 = [(UICollectionViewLayout *)*p_layout _animationForReusableView:v27 toLayoutAttributes:v34 type:2];
                    v38 = [[UICollectionViewAnimation alloc] initWithView:v27 viewType:2 finalLayoutAttributes:v34 startFraction:1 endFraction:1 animateFromCurrentPostion:v37 deleteAfterAnimation:0.0 customAnimations:1.0];
                    [v52 addObject:v38];
                    v39 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v25];
                    [v51 setObject:v38 forKey:v39];

                    v16 = v53;
                    v23 = v54;
                  }
                }

                ++v24;
              }

              while (v22 != v24);
              v40 = [v23 countByEnumeratingWithState:&v56 objects:v68 count:16];
              v22 = v40;
              if (!v40)
              {
                v9 = v46;
                v41 = v23;
                v10 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
                v11 = v44;
                v12 = v48;
                goto LABEL_36;
              }
            }
          }

          v12 = v48;
          v41 = v54;
        }

        else
        {
          v42 = (*(&self->super.super.super.super.isa + v10[215]))[2];
          v41 = [(UICollectionViewUpdateItem *)v13 _indexPath];
          v43 = [(UICollectionViewData *)v42 globalIndexForItemAtIndexPath:v41];
          (v65[0])(v64, v43);
        }

LABEL_36:

        ++v12;
      }

      while (v12 != v9);
      v9 = [(NSMutableArray *)obj countByEnumeratingWithState:&v60 objects:v69 count:16];
    }

    while (v9);
  }
}

void __99__UICollectionView__createAndAppendViewAnimationsForDeletesInCurrentUpdate_disappearingAnimations___block_invoke(id *a1, uint64_t a2)
{
  v13 = [(UICollectionViewData *)*(*(a1[4] + 285) + 16) indexPathForItemAtGlobalIndex:a2];
  v3 = [(_UICollectionViewSubviewManager *)*(a1[4] + 373) visibleCellAtIndexPath:v13];
  if (v3 && ([(UICollectionViewUpdate *)*(a1[4] + 285) hasMovedItemWithSourceIndexPath:v13]& 1) == 0)
  {
    v4 = [*(a1[4] + 269) finalLayoutAttributesForDisappearingItemAtIndexPath:v13];
    if (v4)
    {
      v5 = v4;
      if (dyld_program_sdk_at_least())
      {
        v6 = [v5 zIndex];
        v7 = [v3 _layoutAttributes];
        v8 = [v7 zIndex];

        if (v6 != v8)
        {
          [a1[4] _addControlledSubview:v3 atZIndex:objc_msgSend(v5 forced:{"zIndex"), 1}];
        }
      }
    }

    else
    {
      v9 = [v3 _layoutAttributes];
      v5 = [v9 copy];

      [v5 setAlpha:0.0];
    }

    v10 = [*(a1[4] + 269) _animationForReusableView:v3 toLayoutAttributes:v5 type:2];
    v11 = [[UICollectionViewAnimation alloc] initWithView:v3 viewType:1 finalLayoutAttributes:v5 startFraction:1 endFraction:1 animateFromCurrentPostion:v10 deleteAfterAnimation:0.0 customAnimations:1.0];
    [a1[5] addObject:v11];
    v12 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v13];
    [a1[6] setObject:v11 forKey:v12];
  }
}

- (void)_createAndAppendViewAnimationsForInsertsInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 newSubviewCollection:(id)a5
{
  v106 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  [(UICollectionView *)self _visibleBounds];
  v13 = v12;
  v15 = v14;
  v17 = v16;
  v19 = v18;
  v92[0] = MEMORY[0x1E69E9820];
  v92[1] = 3221225472;
  v93 = __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke;
  v94 = &unk_1E70FF650;
  v95 = self;
  v99 = v12;
  v100 = v14;
  v101 = v16;
  v102 = v18;
  v103 = v11;
  v80 = v8;
  v96 = v80;
  v79 = v9;
  v97 = v79;
  v78 = v10;
  v98 = v78;
  v88 = 0u;
  v89 = 0u;
  v90 = 0u;
  v91 = 0u;
  obj = self->_insertItems;
  v20 = [(NSMutableArray *)obj countByEnumeratingWithState:&v88 objects:v105 count:16];
  if (v20)
  {
    v21 = v20;
    v22 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
    v23 = *v89;
    v77 = self;
    v74 = *v89;
    do
    {
      v24 = 0;
      v73 = v21;
      do
      {
        if (*v89 != v23)
        {
          objc_enumerationMutation(obj);
        }

        v25 = *(*(&v88 + 1) + 8 * v24);
        if (v25 && v25[6] == 0x7FFFFFFFFFFFFFFFLL)
        {
          v76 = v24;
          v26 = [(UICollectionViewUpdateItem *)v25 _indexPath];
          v27 = [v26 section];

          v28 = v22[215];
          v29 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v28))[3] numberOfItemsInSection:v27];
          v81 = v28;
          v30 = (*(&self->super.super.super.super.isa + v28))[3];
          v31 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:v27];
          v32 = [(UICollectionViewData *)v30 globalIndexForItemAtIndexPath:v31];

          if (v29 >= 1)
          {
            do
            {
              v93(v92, v32++);
              --v29;
            }

            while (v29);
          }

          v86 = 0u;
          v87 = 0u;
          v84 = 0u;
          v85 = 0u;
          v33 = v81;
          v82 = [(UICollectionViewData *)(*(&self->super.super.super.super.isa + v81))[3] existingSupplementaryLayoutAttributesInSection:v27];
          v34 = [v82 countByEnumeratingWithState:&v84 objects:v104 count:16];
          if (v34)
          {
            v35 = v34;
            v83 = *v85;
            v36 = v82;
            while (1)
            {
              v37 = 0;
              do
              {
                if (*v85 != v83)
                {
                  objc_enumerationMutation(v36);
                }

                v38 = *(*(&v84 + 1) + 8 * v37);
                v39 = [v38 indexPath];
                v40 = [(_UILabelConfiguration *)v38 _content];
                v41 = [*(&self->super.super.super.super.isa + v33) initialIndexPathForSupplementaryElementOfKind:v40 forFinalIndexPath:v39];

                if (!v41)
                {
                  if (v38)
                  {
                    layout = self->_layout;
                    if ((v38[288] & 2) == 0)
                    {
                      goto LABEL_18;
                    }

                    v43 = [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingDecorationElementOfKind:v40 atIndexPath:v39];
                  }

                  else
                  {
                    layout = self->_layout;
LABEL_18:
                    v43 = [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingSupplementaryElementOfKind:v40 atIndexPath:v39];
                  }

                  v44 = v43;
                  if (!v43)
                  {
                    v44 = [v38 copy];
                    [v44 setAlpha:0.0];
                  }

                  [v38 frame];
                  v46 = v45;
                  v48 = v47;
                  v50 = v49;
                  v52 = v51;
                  [v44 frame];
                  v110.origin.x = v53;
                  v110.origin.y = v54;
                  v110.size.width = v55;
                  v110.size.height = v56;
                  v107.origin.x = v46;
                  v107.origin.y = v48;
                  v107.size.width = v50;
                  v107.size.height = v52;
                  v108 = CGRectUnion(v107, v110);
                  [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v38 frame:v108.origin.x, v108.origin.y, v108.size.width, v108.size.height];
                  v111.origin.x = v57;
                  v111.origin.y = v58;
                  v111.size.width = v59;
                  v111.size.height = v60;
                  v109.origin.x = v13;
                  v109.origin.y = v15;
                  v109.size.width = v17;
                  v109.size.height = v19;
                  if (CGRectIntersectsRect(v109, v111) && (![v44 isHidden] || (objc_msgSend(v38, "isHidden") & 1) == 0))
                  {
                    v61 = [(_UILabelConfiguration *)v38 _content];
                    v62 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v61 atIndexPath:v39 layout:self->_layout withLayoutAttributes:v44 applyAttributes:1];

                    if (v62)
                    {
                      v63 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v62 toLayoutAttributes:v38 type:2];
                      v64 = [[UICollectionViewAnimation alloc] initWithView:v62 viewType:2 finalLayoutAttributes:v38 startFraction:0 endFraction:0 animateFromCurrentPostion:v63 deleteAfterAnimation:0.0 customAnimations:1.0];
                      [v80 addObject:v64];
                      v65 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v38];
                      [v79 setObject:v64 forKey:v65];
                      if (v38)
                      {
                        v66 = *(v38 + 72);
                        v67 = 1;
                        if ((v66 & 2) != 0)
                        {
                          v67 = 2;
                        }

                        if (v66)
                        {
                          v68 = 0;
                        }

                        else
                        {
                          v68 = v67;
                        }
                      }

                      else
                      {
                        v68 = 0;
                      }

                      [(_UICollectionViewSubviewCollection *)v78 setView:v62 ofKind:v40 inCategory:v68 atIndexPath:v39];

                      self = v77;
                    }

                    v33 = v81;
                  }

                  v36 = v82;
                }

                ++v37;
              }

              while (v35 != v37);
              v69 = [v36 countByEnumeratingWithState:&v84 objects:v104 count:16];
              v35 = v69;
              if (!v69)
              {
                v21 = v73;
                v70 = v36;
                v22 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
                v23 = v74;
                v24 = v76;
                goto LABEL_43;
              }
            }
          }

          v23 = v74;
          v24 = v76;
          v70 = v82;
        }

        else
        {
          v71 = (*(&self->super.super.super.super.isa + v22[215]))[3];
          v70 = [(UICollectionViewUpdateItem *)v25 _indexPath];
          v72 = [(UICollectionViewData *)v71 globalIndexForItemAtIndexPath:v70];
          v93(v92, v72);
        }

LABEL_43:

        ++v24;
      }

      while (v24 != v21);
      v21 = [(NSMutableArray *)obj countByEnumeratingWithState:&v88 objects:v105 count:16];
    }

    while (v21);
  }
}

void __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) indexPathForItemAtGlobalIndex:a2];
  if (([(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) hasMovedItemWithDestinationIndexPath:v3]& 1) == 0)
  {
    v4 = [*(*(a1 + 32) + 2152) initialLayoutAttributesForAppearingItemAtIndexPath:v3];
    v5 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) layoutAttributesForItemAtIndexPath:v3];
    if (v5)
    {
      v6 = v5;
      if (!v4)
      {
        v4 = [v5 copy];
        [v4 setAlpha:0.0];
      }

      [v4 frame];
      v8 = v7;
      v10 = v9;
      v12 = v11;
      v14 = v13;
      [v6 frame];
      v45.origin.x = v15;
      v45.origin.y = v16;
      v45.size.width = v17;
      v45.size.height = v18;
      v43.origin.x = v8;
      v43.origin.y = v10;
      v43.size.width = v12;
      v43.size.height = v14;
      v44 = CGRectUnion(v43, v45);
      [*(*(a1 + 32) + 2152) _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v4 frame:{v44.origin.x, v44.origin.y, v44.size.width, v44.size.height}];
      v46.origin.x = v19;
      v46.origin.y = v20;
      v46.size.width = v21;
      v46.size.height = v22;
      if (!CGRectIntersectsRect(*(a1 + 64), v46) || ([v4 isHidden] & 1) != 0 || (objc_msgSend(v6, "isHidden") & 1) != 0)
      {
        v23 = v6;
      }

      else
      {
        v24 = [*(a1 + 32) _preparedCellForItemAtIndexPath:v3 withLayoutAttributes:v4 applyAttributes:1 isFocused:0 notify:1];
        if (dyld_program_sdk_at_least() && *(a1 + 96) == 1)
        {
          v25 = *(a1 + 32);
          v26 = *(v25[285] + 24);
          [v25 _visibleBounds];
          [(UICollectionViewData *)v26 validateLayoutInRect:v27, v28, v29, v30];
        }

        v23 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) layoutAttributesForItemAtIndexPath:v3];

        v31 = [*(*(a1 + 32) + 2152) _initialAppearingLayoutAttributesCanBeOverriddenForEstimatedSizing];
        if (dyld_program_sdk_at_least() && (*(a1 + 96) & v31 & 1) != 0)
        {
          v35 = MEMORY[0x1E69E9820];
          v36 = 3221225472;
          v37 = __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2;
          v38 = &unk_1E70F6B40;
          v39 = v4;
          v40 = v3;
          v41 = v23;
          v42 = v24;
          [UIView performWithoutAnimation:&v35];
        }

        v32 = [*(*(a1 + 32) + 2152) _animationForReusableView:v24 toLayoutAttributes:v23 type:{2, v35, v36, v37, v38}];
        v33 = [[UICollectionViewAnimation alloc] initWithView:v24 viewType:1 finalLayoutAttributes:v23 startFraction:0 endFraction:0 animateFromCurrentPostion:v32 deleteAfterAnimation:0.0 customAnimations:1.0];
        [*(a1 + 40) addObject:v33];
        v34 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v3];
        [*(a1 + 48) setObject:v33 forKey:v34];
        [(_UICollectionViewSubviewCollection *)*(a1 + 56) setCell:v24 atIndexPath:v3];
      }
    }

    else
    {
      v23 = 0;
    }
  }
}

void __117__UICollectionView__createAndAppendViewAnimationsForInsertsInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2(uint64_t a1)
{
  v2 = [*(a1 + 32) copy];
  [v2 setIndexPath:*(a1 + 40)];
  [*(a1 + 48) center];
  [v2 setCenter:?];
  [*(a1 + 48) size];
  [v2 setSize:?];
  [*(a1 + 56) _setLayoutAttributes:v2];
}

- (id)_attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:(id)a3 attributesForNewModel:(id)a4
{
  v33 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  v8 = objc_alloc_init(MEMORY[0x1E695DF90]);
  subviewManager = self->_subviewManager;
  v28[0] = MEMORY[0x1E69E9820];
  v28[1] = 3221225472;
  v28[2] = __107__UICollectionView__attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews_attributesForNewModel___block_invoke;
  v28[3] = &unk_1E70FF678;
  v22 = v6;
  v29 = v22;
  v30 = self;
  v23 = v8;
  v31 = v23;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v28];
  }

  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v10 = v7;
  v11 = [v10 countByEnumeratingWithState:&v24 objects:v32 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v25;
    do
    {
      for (i = 0; i != v12; ++i)
      {
        if (*v25 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v24 + 1) + 8 * i);
        v16 = [v15 indexPath];
        if (v15)
        {
          if (v15[288])
          {
            v17 = v16;
            v18 = [(UICollectionViewData *)self->_currentUpdate->_newModel validatedGlobalIndexForItemAtIndexPath:v16];
            if (v18 != 0x7FFFFFFFFFFFFFFFLL && [(UICollectionViewUpdate *)self->_currentUpdate initialGlobalIndexForFinalGlobalIndex:v18]!= 0x7FFFFFFFFFFFFFFFLL)
            {
              [v23 setObject:v15 forKeyedSubscript:v17];
            }
          }
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v24 objects:v32 count:16];
    }

    while (v12);
  }

  v19 = v31;
  v20 = v23;

  return v23;
}

void __107__UICollectionView__attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews_attributesForNewModel___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v18 = a3;
  v4 = [*(a1 + 32) containsObject:v18];
  v5 = v18;
  if (v4)
  {
    v6 = [v18 _layoutAttributes];
    v7 = *(*(*(a1 + 40) + 2280) + 16);
    v8 = [v6 indexPath];
    v9 = [(UICollectionViewData *)v7 validatedGlobalIndexForItemAtIndexPath:v8];

    if (v9 != 0x7FFFFFFFFFFFFFFFLL)
    {
      v10 = [*(*(a1 + 40) + 2280) finalGlobalIndexForInitialGlobalIndex:v9];
      if (v10 != 0x7FFFFFFFFFFFFFFFLL)
      {
        v11 = [(UICollectionViewData *)*(*(*(a1 + 40) + 2280) + 24) layoutAttributesForGlobalItemIndex:v10];
        v12 = v11;
        if (v11)
        {
          v13 = *(a1 + 48);
          v14 = [v11 indexPath];
          v15 = [v13 objectForKeyedSubscript:v14];

          if (!v15)
          {
            v16 = *(a1 + 48);
            v17 = [v12 indexPath];
            [v16 setObject:v12 forKeyedSubscript:v17];
          }
        }
      }
    }

    v5 = v18;
  }
}

- (void)_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate:(id)a3 animationsForOnScreenViews:(id)a4 newSubviewCollection:(id)a5 oldVisibleViews:(id)a6 attributesForNewModel:(id)a7
{
  v115 = *MEMORY[0x1E69E9840];
  v12 = a3;
  v13 = a4;
  v14 = self;
  v92 = v13;
  v89 = a5;
  v15 = [(UICollectionView *)self _attributesForItemsVisibleDuringCurrentUpdateWithOldVisibleViews:a6 attributesForNewModel:a7];
  [(UICollectionView *)self _visibleBounds];
  v17 = v16;
  v19 = v18;
  v21 = v20;
  v23 = v22;
  v88 = [(UICollectionViewLayout *)self->_layout _estimatesSizes];
  v24 = objc_alloc_init(MEMORY[0x1E696AD50]);
  v107 = 0u;
  v108 = 0u;
  v109 = 0u;
  v110 = 0u;
  v86 = v15;
  obj = [v15 objectEnumerator];
  v25 = [obj countByEnumeratingWithState:&v107 objects:v114 count:16];
  if (v25)
  {
    v26 = v25;
    p_responderFlags = &self->super.super.super._responderFlags;
    v97 = *v108;
    v90 = v12;
    v91 = v24;
    do
    {
      v27 = 0;
      v94 = v26;
      do
      {
        if (*v108 != v97)
        {
          objc_enumerationMutation(obj);
        }

        v99 = v27;
        v28 = *(*(&v107 + 1) + 8 * v27);
        v100 = [v28 indexPath];
        v98 = [(UICollectionViewData *)v14->_currentUpdate->_newModel globalIndexForItemAtIndexPath:v100];
        v29 = [(UICollectionViewUpdate *)v14->_currentUpdate initialGlobalIndexForFinalGlobalIndex:?];
        v30 = [(UICollectionViewData *)v14->_currentUpdate->_oldModel layoutAttributesForGlobalItemIndex:v29];
        v31 = [(UICollectionViewData *)v14->_currentUpdate->_oldModel indexPathForItemAtGlobalIndex:v29];
        v32 = [(_UICollectionViewSubviewManager *)v14->_subviewManager visibleCellAtIndexPath:v31];
        v33 = v32;
        v101 = v30;
        if (v30 || ([v32 _layoutAttributes], (v101 = objc_claimAutoreleasedReturnValue()) != 0))
        {
          v34 = v100;
        }

        else
        {
          v34 = v100;
          v101 = [(UICollectionViewLayout *)v14->_layout initialLayoutAttributesForAppearingItemAtIndexPath:v100];
          if (!v101)
          {
            v101 = [v28 copy];
            [v101 setAlpha:0.0];
          }
        }

        [v101 frame];
        v36 = v35;
        v38 = v37;
        v40 = v39;
        v42 = v41;
        [v28 frame];
        v119.origin.x = v43;
        v119.origin.y = v44;
        v119.size.width = v45;
        v119.size.height = v46;
        v116.origin.x = v36;
        v116.origin.y = v38;
        v116.size.width = v40;
        v116.size.height = v42;
        v117 = CGRectUnion(v116, v119);
        [(UICollectionViewLayout *)v14->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v28 frame:v117.origin.x, v117.origin.y, v117.size.width, v117.size.height];
        v120.origin.x = v47;
        v120.origin.y = v48;
        v120.size.width = v49;
        v120.size.height = v50;
        v118.origin.x = v17;
        v118.origin.y = v19;
        v118.size.width = v21;
        v118.size.height = v23;
        if (CGRectIntersectsRect(v118, v120))
        {
          v102 = v28;
          if (v33)
          {
            goto LABEL_11;
          }

          if ([v101 isHidden] && (objc_msgSend(v102, "isHidden") & 1) != 0 || (-[_UICollectionViewDragAndDropController isCellPerformingLegacyReorderingAtIndexPath:](v14->_dragAndDropController, v34) & 1) != 0 || (-[NSIndexPath isEqual:](v14->_cancellingToIndexPath, "isEqual:", v34) & 1) != 0)
          {
            v33 = 0;
          }

          else
          {
            v71 = [v101 copy];
            if (dyld_program_sdk_at_least())
            {
              [v71 indexPath];
              v73 = v72 = v31;
              v74 = [v73 isEqual:v34];

              v31 = v72;
              if ((v74 & 1) == 0)
              {
                [v71 setIndexPath:v34];
              }
            }

            v33 = [(UICollectionView *)v14 _preparedCellForItemAtIndexPath:v34 withLayoutAttributes:v71 applyAttributes:1 isFocused:0 notify:1];
            if (v88 && (*(&p_responderFlags[680] + 1) & 4) != 0)
            {
              v75 = v31;
              [(UICollectionViewData *)v14->_collectionViewData invalidate:?];
              v76 = [(UICollectionViewData *)v14->_collectionViewData layoutAttributesForItemAtIndexPath:v34];
              v77 = [v76 copy];

              v31 = v75;
              [v101 frame];
              v79 = v78;
              v81 = v80;
              [v77 frame];
              [v101 setFrame:{v79, v81}];
              [(UICollectionView *)v14 _applyLayoutAttributes:v101 toView:v33];
              v102 = v77;
            }

            v26 = v94;
            [(_UICollectionViewSubviewCollection *)v89 setCell:v33 atIndexPath:v34];

            if (v33)
            {
LABEL_11:
              v96 = v31;
              LOBYTE(v85) = 1;
              v51 = [(UICollectionView *)v14 _viewAnimationsForView:v33 startingLayoutAttributes:v101 endingLayoutAttributes:v102 startingLayout:v14->_layout endingLayout:v14->_layout animationSetup:0 animationCompletion:0 enableCustomAnimations:v85 customAnimationsType:2];
              orthogonalScrollerController = v14->_orthogonalScrollerController;
              v53 = [v33 _layoutAttributes];
              LOBYTE(orthogonalScrollerController) = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:v53];

              if ((orthogonalScrollerController & 1) == 0)
              {
                v105 = 0u;
                v106 = 0u;
                v103 = 0u;
                v104 = 0u;
                v93 = v51;
                v54 = v51;
                v55 = [v54 countByEnumeratingWithState:&v103 objects:v113 count:16];
                if (v55)
                {
                  v56 = v55;
                  v57 = *v104;
                  do
                  {
                    v58 = 0;
                    do
                    {
                      if (*v104 != v57)
                      {
                        objc_enumerationMutation(v54);
                      }

                      v59 = *(*(&v103 + 1) + 8 * v58);
                      v60 = [v33 superview];
                      v61 = v14;
                      v62 = [(UICollectionView *)v14 _subviewRouterForView:v33 attributes:v102 createIfNecessary:0];
                      v63 = v62;
                      if (v62)
                      {
                        v64 = *(v62 + 40);
                      }

                      else
                      {
                        v64 = 0;
                      }

                      v65 = v64;

                      if (v60 != v65)
                      {
                        [v59 setParentInCollectionViewDuringAnimation:1];
                      }

                      ++v58;
                      v14 = v61;
                    }

                    while (v56 != v58);
                    v66 = [v54 countByEnumeratingWithState:&v103 objects:v113 count:16];
                    v56 = v66;
                  }

                  while (v66);
                }

                v12 = v90;
                v24 = v91;
                v34 = v100;
                v51 = v93;
              }

              [v12 addObjectsFromArray:v51];
              if ([v51 count] == 1)
              {
                v67 = [_UICollectionViewItemKey collectionItemKeyForCellWithIndexPath:v34];
                v68 = [v51 objectAtIndexedSubscript:0];
                [v92 setObject:v68 forKeyedSubscript:v67];
              }

              has_internal_diagnostics = os_variant_has_internal_diagnostics();
              v70 = [v24 containsIndex:v98];
              v26 = v94;
              if (has_internal_diagnostics)
              {
                if (v70)
                {
                  v82 = __UIFaultDebugAssertLog();
                  if (os_log_type_enabled(v82, OS_LOG_TYPE_FAULT))
                  {
                    *buf = 134217984;
                    v112 = v98;
                    _os_log_fault_impl(&dword_188A29000, v82, OS_LOG_TYPE_FAULT, "attempt to create two animations for new global item index %ld", buf, 0xCu);
                  }

                  v24 = v91;
                  v26 = v94;
                  v34 = v100;
                }
              }

              else if (v70)
              {
                v83 = *(__UILogGetCategoryCachedImpl("Assert", &_createAndAppendViewAnimationsForExistingAndNewlyVisibleItemsInCurrentUpdate_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews_attributesForNewModel____s_category) + 8);
                if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
                {
                  *buf = 134217984;
                  v112 = v98;
                  _os_log_impl(&dword_188A29000, v83, OS_LOG_TYPE_ERROR, "attempt to create two animations for new global item index %ld", buf, 0xCu);
                }
              }

              [v24 addIndex:v98];

              v31 = v96;
            }
          }
        }

        v27 = v99 + 1;
      }

      while (v99 + 1 != v26);
      v84 = [obj countByEnumeratingWithState:&v107 objects:v114 count:16];
      v26 = v84;
    }

    while (v84);
  }
}

- (void)_createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate:(id)a3 disappearingAnimations:(id)a4 animationsForOnScreenViews:(id)a5 newSubviewCollection:(id)a6 oldVisibleViews:(id)a7
{
  v133 = *MEMORY[0x1E69E9840];
  v114 = a3;
  v111 = a4;
  v110 = a5;
  v108 = a6;
  v12 = a7;
  v13 = objc_opt_new();
  subviewManager = self->_subviewManager;
  v128[0] = MEMORY[0x1E69E9820];
  v128[1] = 3221225472;
  v128[2] = __185__UICollectionView__createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate_disappearingAnimations_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews___block_invoke;
  v128[3] = &unk_1E70FF6A0;
  v107 = v12;
  v129 = v107;
  v15 = v13;
  v130 = v15;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAuxillariesWithEnumerator:v128];
  }

  v16 = [(UICollectionViewData *)self->_currentUpdate->_oldModel existingSupplementaryLayoutAttributes];
  if (v16)
  {
    [v15 addObjectsFromArray:v16];
  }

  v106 = v16;
  [(UICollectionView *)self _visibleBounds];
  v18 = v17;
  v20 = v19;
  v22 = v21;
  v24 = v23;
  v124 = 0u;
  v125 = 0u;
  v126 = 0u;
  v127 = 0u;
  v25 = v15;
  v116 = [v25 countByEnumeratingWithState:&v124 objects:v132 count:16];
  if (v116)
  {
    v115 = *v125;
    v109 = v25;
    do
    {
      v26 = 0;
      do
      {
        if (*v125 != v115)
        {
          objc_enumerationMutation(v25);
        }

        v27 = *(*(&v124 + 1) + 8 * v26);
        v28 = [v27 indexPath];
        if ([v28 length] < 2)
        {
          v29 = 0x7FFFFFFFFFFFFFFFLL;
        }

        else
        {
          v29 = [v28 section];
        }

        [v28 item];
        v118 = [(_UILabelConfiguration *)v27 _content];
        if (v27)
        {
          v30 = (v27[288] >> 1) & 1;
        }

        else
        {
          v30 = 0;
        }

        v117 = v26;
        currentUpdate = self->_currentUpdate;
        if (v29 == 0x7FFFFFFFFFFFFFFFLL)
        {
          v32 = v118;
          v33 = [(NSMutableDictionary *)currentUpdate->_deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:v118];
          v34 = [v33 containsIndex:{objc_msgSend(v28, "indexAtPosition:", 0)}];

          if ((v34 & 1) == 0)
          {
            goto LABEL_21;
          }
        }

        else
        {
          v32 = v118;
          v45 = [(UICollectionViewUpdate *)currentUpdate validatedNewIndexPathForSupplementaryElementOfKind:v118 oldIndexPath:v28];

          if (v45)
          {
LABEL_21:
            v46 = [(UICollectionViewUpdate *)self->_currentUpdate newIndexPathForSupplementaryElementOfKind:v32 oldIndexPath:v28];
            [v27 frame];
            v48 = v47;
            v50 = v49;
            v52 = v51;
            v54 = v53;
            v55 = v32;
            if (v27)
            {
              newModel = self->_currentUpdate->_newModel;
              if ((v27[288] & 2) == 0)
              {
                goto LABEL_23;
              }

              v57 = [(UICollectionViewData *)newModel layoutAttributesForDecorationViewOfKind:v32 atIndexPath:v46];
              v58 = 1;
            }

            else
            {
              newModel = self->_currentUpdate->_newModel;
LABEL_23:
              v57 = [(UICollectionViewData *)newModel layoutAttributesForSupplementaryElementOfKind:v32 atIndexPath:v46];
              v58 = 0;
            }

            v59 = [(UICollectionView *)self _visibleSupplementaryViewOfKind:v55 atIndexPath:v28 isDecorationView:v58];
            v60 = v59;
            if (v57)
            {
              [v57 frame];
              v140.origin.x = v61;
              v140.origin.y = v62;
              v140.size.width = v63;
              v140.size.height = v64;
              v134.origin.x = v48;
              v134.origin.y = v50;
              v134.size.width = v52;
              v134.size.height = v54;
              v135 = CGRectUnion(v134, v140);
              [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v27 frame:v135.origin.x, v135.origin.y, v135.size.width, v135.size.height];
              v141.origin.x = v65;
              v141.origin.y = v66;
              v141.size.width = v67;
              v141.size.height = v68;
              v136.origin.x = v18;
              v136.origin.y = v20;
              v136.size.width = v22;
              v136.size.height = v24;
              if (CGRectIntersectsRect(v136, v141) && v27 && !v60)
              {
                if (![v27 isHidden] || (objc_msgSend(v57, "isHidden") & 1) == 0)
                {
                  v69 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v55 atIndexPath:v46 layout:self->_layout withLayoutAttributes:v27 applyAttributes:1];
                  if (v69)
                  {
                    v60 = v69;
                    v70 = *(v27 + 72);
                    v71 = 1;
                    if ((v70 & 2) != 0)
                    {
                      v71 = 2;
                    }

                    if (v70)
                    {
                      v72 = 0;
                    }

                    else
                    {
                      v72 = v71;
                    }

                    [(_UICollectionViewSubviewCollection *)v108 setView:v69 ofKind:v55 inCategory:v72 atIndexPath:v46];
LABEL_39:
                    LOBYTE(v105) = 1;
                    v73 = [(UICollectionView *)self _viewAnimationsForView:v60 startingLayoutAttributes:v27 endingLayoutAttributes:v57 startingLayout:self->_layout endingLayout:self->_layout animationSetup:0 animationCompletion:0 enableCustomAnimations:v105 customAnimationsType:2];
                    orthogonalScrollerController = self->_orthogonalScrollerController;
                    v75 = [v60 _layoutAttributes];
                    LOBYTE(orthogonalScrollerController) = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isElementInOrthogonalScrollingSectionWithLayoutAttributes:v75];

                    if ((orthogonalScrollerController & 1) == 0)
                    {
                      v76 = v57;
                      v112 = v73;
                      v113 = v46;
                      v77 = self;
                      v122 = 0u;
                      v123 = 0u;
                      v120 = 0u;
                      v121 = 0u;
                      obj = v73;
                      v78 = [(UICollectionViewAnimation *)obj countByEnumeratingWithState:&v120 objects:v131 count:16];
                      if (v78)
                      {
                        v79 = v78;
                        v80 = *v121;
                        do
                        {
                          v81 = 0;
                          do
                          {
                            if (*v121 != v80)
                            {
                              objc_enumerationMutation(obj);
                            }

                            v82 = *(*(&v120 + 1) + 8 * v81);
                            v83 = [v60 superview];
                            v84 = [(UICollectionView *)v77 _subviewRouterForView:v60 attributes:v76 createIfNecessary:0];
                            v85 = v84;
                            if (v84)
                            {
                              v86 = *(v84 + 40);
                            }

                            else
                            {
                              v86 = 0;
                            }

                            v87 = v86;

                            if (v83 != v87)
                            {
                              [v82 setParentInCollectionViewDuringAnimation:1];
                            }

                            ++v81;
                          }

                          while (v79 != v81);
                          v88 = [(UICollectionViewAnimation *)obj countByEnumeratingWithState:&v120 objects:v131 count:16];
                          v79 = v88;
                        }

                        while (v88);
                      }

                      self = v77;
                      v25 = v109;
                      v73 = v112;
                      v46 = v113;
                      v57 = v76;
                    }

                    if ([(UICollectionViewAnimation *)v73 count]== 1)
                    {
                      v89 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v57];
                      v90 = [(UICollectionViewAnimation *)v73 objectAtIndexedSubscript:0];
                      [v110 setObject:v90 forKey:v89];
                    }

                    [v114 addObjectsFromArray:v73];
LABEL_59:
                    v35 = v117;
                    goto LABEL_60;
                  }
                }
              }

              else if (v60)
              {
                goto LABEL_39;
              }
            }

            else
            {
              if (v59)
              {
                v91 = [v59 _layoutAttributes];
                v57 = [v91 copy];

                [v57 setAlpha:0.0];
                v73 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v60 toLayoutAttributes:v57 type:2];
                v92 = [[UICollectionViewAnimation alloc] initWithView:v60 viewType:2 finalLayoutAttributes:v57 startFraction:0 endFraction:1 animateFromCurrentPostion:v73 deleteAfterAnimation:0.0 customAnimations:1.0];
                v93 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v57];
                [v114 addObject:v92];
                [v111 setObject:v92 forKey:v93];

                goto LABEL_59;
              }

              v57 = 0;
            }

            v35 = v117;
            goto LABEL_67;
          }
        }

        v35 = v117;
        if ([(NSIndexSet *)self->_currentUpdate->_deletedSections containsIndex:v29])
        {
          goto LABEL_69;
        }

        [v27 frame];
        v37 = v36;
        v39 = v38;
        v41 = v40;
        v43 = v42;
        layout = self->_layout;
        if (v30)
        {
          [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingDecorationElementOfKind:v118 atIndexPath:v28];
        }

        else
        {
          [(UICollectionViewLayout *)layout finalLayoutAttributesForDisappearingSupplementaryElementOfKind:v118 atIndexPath:v28];
        }
        v94 = ;
        [v94 frame];
        v142.origin.x = v95;
        v142.origin.y = v96;
        v142.size.width = v97;
        v142.size.height = v98;
        v137.origin.x = v37;
        v137.origin.y = v39;
        v137.size.width = v41;
        v137.size.height = v43;
        v138 = CGRectUnion(v137, v142);
        v46 = v94;
        [(UICollectionViewLayout *)self->_layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v94 frame:v138.origin.x, v138.origin.y, v138.size.width, v138.size.height];
        v143.origin.x = v99;
        v143.origin.y = v100;
        v143.size.width = v101;
        v143.size.height = v102;
        v139.origin.x = v18;
        v139.origin.y = v20;
        v139.size.width = v22;
        v139.size.height = v24;
        if (CGRectIntersectsRect(v139, v143))
        {
          v57 = [(UICollectionView *)self _visibleSupplementaryViewOfKind:v118 atIndexPath:v28 isDecorationView:v30];
          if (v57)
          {
            v60 = [(UICollectionViewLayout *)self->_layout _animationForReusableView:v57 toLayoutAttributes:v94 type:2];
            v73 = [[UICollectionViewAnimation alloc] initWithView:v57 viewType:2 finalLayoutAttributes:v94 startFraction:1 endFraction:1 animateFromCurrentPostion:v60 deleteAfterAnimation:0.0 customAnimations:1.0];
            [v114 addObject:v73];
            v103 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v46];
            [v111 setObject:v73 forKey:v103];

LABEL_60:
          }

LABEL_67:
        }

LABEL_69:
        v26 = v35 + 1;
      }

      while (v26 != v116);
      v104 = [v25 countByEnumeratingWithState:&v124 objects:v132 count:16];
      v116 = v104;
    }

    while (v104);
  }
}

void __185__UICollectionView__createAndAppendViewAnimationsForExistingAndDeletedAuxiliariesInCurrentUpdate_disappearingAnimations_animationsForOnScreenViews_newSubviewCollection_oldVisibleViews___block_invoke(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  v7 = a5;
  if (([v7 _isInUpdateAnimation] & 1) == 0 && objc_msgSend(*(a1 + 32), "containsObject:", v7))
  {
    v6 = [v7 _layoutAttributes];
    [*(a1 + 40) addObject:v6];
  }
}

- (void)_createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 newSubviewCollection:(id)a5
{
  v56 = *MEMORY[0x1E69E9840];
  v35 = a3;
  v34 = a4;
  v8 = a5;
  [(UICollectionView *)self _visibleBounds];
  v46[0] = MEMORY[0x1E69E9820];
  v46[1] = 3221225472;
  v47 = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke;
  v48 = &unk_1E70FF6C8;
  v49 = self;
  v51 = v9;
  v52 = v10;
  v53 = v11;
  v54 = v12;
  v32 = v8;
  v50 = v32;
  v37 = self;
  v13 = [(UICollectionViewData *)self->_currentUpdate->_newModel numberOfSections];
  if (v13 >= 1)
  {
    v14 = v13;
    v15 = 0;
    v33 = v13;
    do
    {
      if (![(NSIndexSet *)v37->_currentUpdate->_insertedSections containsIndex:v15, v32])
      {
        v16 = [(UICollectionViewData *)v37->_currentUpdate->_newModel existingSupplementaryLayoutAttributesInSection:v15];
        v42 = 0u;
        v43 = 0u;
        v44 = 0u;
        v45 = 0u;
        obj = v16;
        v17 = [v16 countByEnumeratingWithState:&v42 objects:v55 count:16];
        if (v17)
        {
          v18 = v17;
          v19 = *v43;
          do
          {
            for (i = 0; i != v18; ++i)
            {
              if (*v43 != v19)
              {
                objc_enumerationMutation(obj);
              }

              v21 = *(*(&v42 + 1) + 8 * i);
              v22 = [v21 indexPath];
              v23 = [(_UILabelConfiguration *)v21 _content];
              v24 = [(NSMutableArray *)v37->_currentUpdate->_insertedSupplementaryIndexesSectionArray objectAtIndexedSubscript:v15];
              v25 = [v24 objectForKey:v23];
              v26 = [v25 containsIndex:{objc_msgSend(v22, "item")}];

              if (v26)
              {
                v27 = v47(v46, v21);
                if (v27)
                {
                  [v35 addObject:v27];
                  v28 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v21];
                  [v34 setObject:v27 forKey:v28];
                }
              }
            }

            v18 = [obj countByEnumeratingWithState:&v42 objects:v55 count:16];
          }

          while (v18);
        }

        v14 = v33;
      }

      ++v15;
    }

    while (v15 != v14);
  }

  insertedSupplementaryTopLevelIndexesDict = v37->_currentUpdate->_insertedSupplementaryTopLevelIndexesDict;
  v38[0] = MEMORY[0x1E69E9820];
  v38[1] = 3221225472;
  v38[2] = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2;
  v38[3] = &unk_1E70FF718;
  v38[4] = v37;
  v39 = v35;
  v41 = v46;
  v40 = v34;
  v30 = v34;
  v31 = v35;
  [(NSMutableDictionary *)insertedSupplementaryTopLevelIndexesDict enumerateKeysAndObjectsUsingBlock:v38];
}

UICollectionViewAnimation *__129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke(uint64_t a1, void *a2)
{
  v3 = a2;
  v4 = v3;
  if (v3)
  {
    v5 = (v3[288] >> 1) & 1;
  }

  else
  {
    v5 = 0;
  }

  v6 = [(_UILabelConfiguration *)v3 _content];
  v7 = [v4 indexPath];
  v8 = *(*(a1 + 32) + 2152);
  if (v5)
  {
    [v8 initialLayoutAttributesForAppearingDecorationElementOfKind:v6 atIndexPath:v7];
  }

  else
  {
    [v8 initialLayoutAttributesForAppearingSupplementaryElementOfKind:v6 atIndexPath:v7];
  }
  v9 = ;
  if (!v9)
  {
    v9 = [v4 copy];
    [v9 setAlpha:0.0];
  }

  [v9 frame];
  v11 = v10;
  v13 = v12;
  v15 = v14;
  v17 = v16;
  [v4 frame];
  v40.origin.x = v18;
  v40.origin.y = v19;
  v40.size.width = v20;
  v40.size.height = v21;
  v38.origin.x = v11;
  v38.origin.y = v13;
  v38.size.width = v15;
  v38.size.height = v17;
  v39 = CGRectUnion(v38, v40);
  [*(*(a1 + 32) + 2152) _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v4 frame:{v39.origin.x, v39.origin.y, v39.size.width, v39.size.height}];
  v23 = v22;
  v25 = v24;
  v27 = v26;
  v29 = v28;
  if ([v9 isHidden] && objc_msgSend(v4, "isHidden"))
  {
    v30 = dyld_program_sdk_at_least();
  }

  else
  {
    v30 = 0;
  }

  v41.origin.x = v23;
  v41.origin.y = v25;
  v41.size.width = v27;
  v41.size.height = v29;
  v31 = 0;
  if (CGRectIntersectsRect(*(a1 + 48), v41) && (v30 & 1) == 0)
  {
    v32 = [*(a1 + 32) _createPreparedSupplementaryViewForElementOfKind:v6 atIndexPath:v7 layout:*(*(a1 + 32) + 2152) withLayoutAttributes:v9 applyAttributes:1];
    if (v32)
    {
      v33 = v32;
      v34 = *(a1 + 40);
      if (v5)
      {
        [(_UICollectionViewSubviewCollection *)v34 setView:v33 forDecorationOfKind:v6 atIndexPath:v7];
      }

      else
      {
        [(_UICollectionViewSubviewCollection *)v34 setView:v33 forSupplementaryOfKind:v6 atIndexPath:v7];
      }

      [*(a1 + 32) _addControlledSubview:v33 atZIndex:objc_msgSend(v4 forced:"zIndex") initialAttributes:{0, 0}];
      v35 = [*(*(a1 + 32) + 2152) _animationForReusableView:v33 toLayoutAttributes:v4 type:2];
      v31 = [[UICollectionViewAnimation alloc] initWithView:v33 viewType:2 finalLayoutAttributes:v4 startFraction:0 endFraction:0 animateFromCurrentPostion:v35 deleteAfterAnimation:0.0 customAnimations:1.0];
    }

    else
    {
      v31 = 0;
    }
  }

  return v31;
}

void __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_3;
  v7[3] = &unk_1E70FF6F0;
  v5 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v6 = *(a1 + 56);
  v10 = a2;
  v11 = v6;
  v8 = v5;
  v9 = *(a1 + 48);
  [a3 enumerateIndexesUsingBlock:v7];
}

void __129__UICollectionView__createAndAppendViewAnimationsForInsertedAuxiliariesInCurrentUpdate_appearingAnimations_newSubviewCollection___block_invoke_3(uint64_t a1, uint64_t a2)
{
  v11 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 24) knownDecorationElementKinds];
  v4 = [v11 containsObject:*(a1 + 56)];
  v5 = [MEMORY[0x1E696AC88] indexPathWithIndex:a2];
  v6 = *(*(*(a1 + 32) + 2280) + 24);
  v7 = *(a1 + 56);
  if (v4)
  {
    [(UICollectionViewData *)v6 layoutAttributesForDecorationViewOfKind:v7 atIndexPath:v5];
  }

  else
  {
    [(UICollectionViewData *)v6 layoutAttributesForSupplementaryElementOfKind:v7 atIndexPath:v5];
  }
  v8 = ;
  v9 = (*(*(a1 + 64) + 16))();
  if (v9)
  {
    [*(a1 + 40) addObject:v9];
    v10 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:v8];
    [*(a1 + 48) setObject:v9 forKey:v10];
  }
}

- (void)_createAndAppendViewAnimationsForNewlyVisibleAuxiliariesInCurrentUpdate:(id)a3 appearingAnimations:(id)a4 animationsForOnScreenViews:(id)a5 newSubviewCollection:(id)a6 attributesForNewModel:(id)a7
{
  v53 = *MEMORY[0x1E69E9840];
  v40 = a3;
  v12 = a4;
  v13 = a5;
  v14 = a6;
  v15 = v12;
  v39 = v14;
  v16 = a7;
  if (dyld_program_sdk_at_least() && [(UICollectionViewLayout *)self->_layout _wantsAnimationsForOffscreenAuxillaries])
  {
    v45 = self;
    v50 = 0u;
    v51 = 0u;
    v48 = 0u;
    v49 = 0u;
    v38 = v16;
    obj = v16;
    v17 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
    if (!v17)
    {
      goto LABEL_40;
    }

    v18 = v17;
    v19 = *v49;
    v42 = v15;
    v43 = v13;
    while (1)
    {
      v20 = 0;
      do
      {
        if (*v49 != v19)
        {
          objc_enumerationMutation(obj);
        }

        v21 = *(*(&v48 + 1) + 8 * v20);
        if (v21)
        {
          v22 = *(v21 + 288);
          if ((v22 & 3) != 1)
          {
            v23 = [_UICollectionViewItemKey collectionItemKeyForLayoutAttributes:?];
            v24 = [v13 objectForKey:v23];
            if (v24)
            {
              goto LABEL_11;
            }

            v25 = [v15 objectForKey:v23];

            if (!v25)
            {
              v24 = [(_UILabelConfiguration *)v21 _content];
              v44 = [v21 indexPath];
              v26 = [(UICollectionViewUpdate *)v45->_currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:v24 newIndexPath:v44];
              v46 = [UICollectionView _visibleSupplementaryViewOfKind:v45 atIndexPath:"_visibleSupplementaryViewOfKind:atIndexPath:isDecorationView:" isDecorationView:v24];
              if (!v26)
              {
                goto LABEL_44;
              }

              v27 = v26;
              v28 = [v26 section];
              v29 = v28 < [(UICollectionViewData *)v45->_currentUpdate->_oldModel numberOfSections];
              v26 = v27;
              if (!v29 && [v27 item] != 0x7FFFFFFFFFFFFFFFLL)
              {
                goto LABEL_44;
              }

              oldModel = v45->_currentUpdate->_oldModel;
              if ((v22 & 2) != 0)
              {
                [(UICollectionViewData *)oldModel layoutAttributesForDecorationViewOfKind:v24 atIndexPath:v27];
              }

              else
              {
                [(UICollectionViewData *)oldModel layoutAttributesForSupplementaryElementOfKind:v24 atIndexPath:v27];
              }
              v31 = ;
              if (!v31)
              {
LABEL_44:
                v31 = [v46 _layoutAttributes];
                if (!v31)
                {
                  layout = v45->_layout;
                  if ((v22 & 2) != 0)
                  {
                    [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingDecorationElementOfKind:v24 atIndexPath:v44];
                  }

                  else
                  {
                    [(UICollectionViewLayout *)layout initialLayoutAttributesForAppearingSupplementaryElementOfKind:v24 atIndexPath:v44];
                  }
                  v31 = ;
                  if (!v31)
                  {
                    v31 = [v21 copy];
                    [v31 setAlpha:0.0];
                  }
                }
              }

              v33 = [v21 isHidden];
              if (v26 && (v33 & 1) == 0 && !v46)
              {
                v41 = v26;
                v34 = [(UICollectionView *)v45 _createPreparedSupplementaryViewForElementOfKind:v24 atIndexPath:v44 layout:v45->_layout withLayoutAttributes:v31 applyAttributes:1];
                if (v34)
                {
                  if ((v22 & 2) != 0)
                  {
                    [(_UICollectionViewSubviewCollection *)v39 setView:v34 forDecorationOfKind:v24 atIndexPath:v44];
                  }

                  else
                  {
                    [(_UICollectionViewSubviewCollection *)v39 setView:v34 forSupplementaryOfKind:v24 atIndexPath:v44];
                  }

                  v35 = [(UICollectionViewLayout *)v45->_layout _animationForReusableView:v34 toLayoutAttributes:v21 type:2];
                  v36 = [[UICollectionViewAnimation alloc] initWithView:v34 viewType:2 finalLayoutAttributes:v21 startFraction:0 endFraction:0 animateFromCurrentPostion:v35 deleteAfterAnimation:0.0 customAnimations:1.0];
                  [v43 setObject:v36 forKey:v23];
                  [v40 addObject:v36];
                }

                v26 = v41;
              }

              v15 = v42;
              v13 = v43;
LABEL_11:
            }
          }
        }

        ++v20;
      }

      while (v18 != v20);
      v37 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
      v18 = v37;
      if (!v37)
      {
LABEL_40:

        v16 = v38;
        break;
      }
    }
  }
}

- (void)_updateOrderingOfViewsInDisappearingViewAnimations:(id)a3 onScreenViewAnimations:(id)a4
{
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke;
  v9[3] = &unk_1E70FF740;
  v9[4] = self;
  v8[0] = MEMORY[0x1E69E9820];
  v8[1] = 3221225472;
  v8[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_2;
  v8[3] = &unk_1E70FF768;
  v8[4] = self;
  v8[5] = v9;
  v6 = a4;
  [a3 enumerateKeysAndObjectsUsingBlock:v8];
  v7[0] = MEMORY[0x1E69E9820];
  v7[1] = 3221225472;
  v7[2] = __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_908;
  v7[3] = &unk_1E70FF768;
  v7[4] = self;
  v7[5] = v9;
  [v6 enumerateKeysAndObjectsUsingBlock:v7];
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke(uint64_t a1, void *a2, void *a3, void *a4)
{
  v11 = a2;
  v7 = a4;
  if (v11)
  {
    if (a3)
    {
      v8 = a3;
      v9 = [v11 zIndex];
      v10 = [v8 zIndex];

      if (v9 == v10)
      {
        [*(a1 + 32) _addControlledSubview:v7 atZIndex:objc_msgSend(v11 forced:{"zIndex"), 1}];
      }
    }
  }
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_2(uint64_t a1, uint64_t a2, void *a3)
{
  v19 = *MEMORY[0x1E69E9840];
  v4 = a3;
  has_internal_diagnostics = os_variant_has_internal_diagnostics();
  v6 = [v4 deleteAfterAnimation];
  if (has_internal_diagnostics)
  {
    if ((v6 & 1) == 0)
    {
      v11 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v11, OS_LOG_TYPE_FAULT))
      {
        v14 = *(a1 + 32);
        v15 = 138412546;
        v16 = v14;
        v17 = 2112;
        v18 = v4;
        _os_log_fault_impl(&dword_188A29000, v11, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: expected disappearing view to be deleted after its animation completes. Collection view: %@; Animation: %@", &v15, 0x16u);
      }
    }
  }

  else if ((v6 & 1) == 0)
  {
    v12 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_9___s_category) + 8);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      v13 = *(a1 + 32);
      v15 = 138412546;
      v16 = v13;
      v17 = 2112;
      v18 = v4;
      _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: expected disappearing view to be deleted after its animation completes. Collection view: %@; Animation: %@", &v15, 0x16u);
    }
  }

  v7 = [v4 view];
  v8 = *(a1 + 40);
  v9 = [v7 _layoutAttributes];
  v10 = [v4 finalLayoutAttributes];
  (*(v8 + 16))(v8, v9, v10, v7);
}

void __94__UICollectionView__updateOrderingOfViewsInDisappearingViewAnimations_onScreenViewAnimations___block_invoke_908(uint64_t a1, uint64_t a2, void *a3)
{
  v30 = *MEMORY[0x1E69E9840];
  v4 = a3;
  has_internal_diagnostics = os_variant_has_internal_diagnostics();
  v6 = [v4 deleteAfterAnimation];
  if (has_internal_diagnostics)
  {
    if (v6)
    {
      v22 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
      {
        v25 = *(a1 + 32);
        v26 = 138412546;
        v27 = v25;
        v28 = 2112;
        v29 = v4;
        _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "UICollectionView internal inconsistency: on-screen view is unexpectedly scheduled to delete after its animation completes. Collection view: %@; Animation: %@", &v26, 0x16u);
      }
    }
  }

  else if (v6)
  {
    v23 = *(__UILogGetCategoryCachedImpl("Assert", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_10___s_category) + 8);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      v24 = *(a1 + 32);
      v26 = 138412546;
      v27 = v24;
      v28 = 2112;
      v29 = v4;
      _os_log_impl(&dword_188A29000, v23, OS_LOG_TYPE_ERROR, "UICollectionView internal inconsistency: on-screen view is unexpectedly scheduled to delete after its animation completes. Collection view: %@; Animation: %@", &v26, 0x16u);
    }
  }

  v7 = [v4 view];
  v8 = [v7 _layoutAttributes];
  [v8 frame];
  v10 = v9;
  v12 = v11;
  v13 = [v4 finalLayoutAttributes];
  [v13 frame];
  v15 = vabdd_f64(v10, v14);
  v17 = vabdd_f64(v12, v16);

  if (v15 >= 0.00000011920929 || v17 >= 0.00000011920929)
  {
    v19 = *(a1 + 40);
    v20 = [v7 _layoutAttributes];
    v21 = [v4 finalLayoutAttributes];
    (*(v19 + 16))(v19, v20, v21, v7);
  }
}

- (void)_removeUntrackedAuxillaryViewsForBeforeVisibleViews:(id)a3 afterVisibleViews:(id)a4 withTrackingViewAnimations:(id)a5
{
  v36 = *MEMORY[0x1E69E9840];
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:{objc_msgSend(v9, "count")}];
  v33[0] = MEMORY[0x1E69E9820];
  v33[1] = 3221225472;
  v33[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke;
  v33[3] = &unk_1E70FFC70;
  v11 = v10;
  v34 = v11;
  [(_UICollectionViewSubviewCollection *)v8 enumerateSupplementariesWithEnumerator:v33];
  v31[0] = MEMORY[0x1E69E9820];
  v31[1] = 3221225472;
  v31[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_2;
  v31[3] = &unk_1E70FFC70;
  v12 = v11;
  v32 = v12;
  [(_UICollectionViewSubviewCollection *)v8 enumerateDecorationsWithEnumerator:v31];
  v13 = [objc_alloc(MEMORY[0x1E696AC70]) initWithOptions:512 capacity:{objc_msgSend(v9, "count")}];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v14 = v9;
  v15 = [v14 countByEnumeratingWithState:&v27 objects:v35 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v28;
    do
    {
      v18 = 0;
      do
      {
        if (*v28 != v17)
        {
          objc_enumerationMutation(v14);
        }

        v19 = [*(*(&v27 + 1) + 8 * v18) view];
        [v13 addObject:v19];

        ++v18;
      }

      while (v16 != v18);
      v16 = [v14 countByEnumeratingWithState:&v27 objects:v35 count:16];
    }

    while (v16);
  }

  v23[4] = v24;
  v24[0] = MEMORY[0x1E69E9820];
  v24[1] = 3221225472;
  v24[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_3;
  v24[3] = &unk_1E70FF2F8;
  v25 = v12;
  v26 = v13;
  v23[0] = MEMORY[0x1E69E9820];
  v23[1] = 3221225472;
  v23[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_4;
  v23[3] = &__block_descriptor_40_e67_v40__0__NSIndexPath_8__NSString_16__UICollectionReusableView_24_B32lu32l8;
  v20 = v13;
  v21 = v12;
  if (v7)
  {
    [(_UICollectionViewSubviewCollection *)v7[1] enumerateSupplementariesWithEnumerator:v23];
  }

  v22[0] = MEMORY[0x1E69E9820];
  v22[1] = 3221225472;
  v22[2] = __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_5;
  v22[3] = &__block_descriptor_40_e67_v40__0__NSIndexPath_8__NSString_16__UICollectionReusableView_24_B32lu32l8;
  v22[4] = v24;
  if (v7)
  {
    [(_UICollectionViewSubviewCollection *)v7[1] enumerateDecorationsWithEnumerator:v22];
  }
}

void __117__UICollectionView__removeUntrackedAuxillaryViewsForBeforeVisibleViews_afterVisibleViews_withTrackingViewAnimations___block_invoke_3(uint64_t a1, void *a2)
{
  v3 = a2;
  if (([*(a1 + 32) containsObject:?] & 1) == 0 && (objc_msgSend(*(a1 + 40), "containsObject:", v3) & 1) == 0)
  {
    [v3 removeFromSuperview];
  }
}

- (void)_setupExpandCollapseAnimationsIfNeededWithContext:(id)a3
{
  v8 = a3;
  v4 = [(UICollectionView *)self dataSource];
  v5 = objc_opt_respondsToSelector();

  if (v5)
  {
    v6 = [(UICollectionView *)self _dataSourceProxy];
    v7 = [v6 _expandCollapseAnimationContextForCollectionView:self];
    if (v7)
    {
      _UICollectionViewSetupExpandCollapseAnimations(self, v8, v7);
    }
  }
}

- (void)_updatePreferredAttributesForCurrentUpdate:(unint64_t)a3
{
  v64 = *MEMORY[0x1E69E9840];
  if (a3 >= 0x65)
  {
    if (os_variant_has_internal_diagnostics())
    {
      v45 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v45, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        v63 = self;
        _os_log_fault_impl(&dword_188A29000, v45, OS_LOG_TYPE_FAULT, "UICollectionView exceeded the maximum allowed number of preferred attribute update passes while preparing update animations. This likely indicates a bug in the sizing implementation of self-sizing views, which prevents the layout from converging on a stable solution. Views may animate incorrectly as a result. %@", buf, 0xCu);
      }
    }

    else
    {
      v4 = *(__UILogGetCategoryCachedImpl("Assert", &_updatePreferredAttributesForCurrentUpdate____s_category) + 8);
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v63 = self;
        _os_log_impl(&dword_188A29000, v4, OS_LOG_TYPE_ERROR, "UICollectionView exceeded the maximum allowed number of preferred attribute update passes while preparing update animations. This likely indicates a bug in the sizing implementation of self-sizing views, which prevents the layout from converging on a stable solution. Views may animate incorrectly as a result. %@", buf, 0xCu);
      }
    }

    return;
  }

  v5 = a3;
  v6 = dyld_program_sdk_at_least();
  p_collectionViewFlags = &self->_collectionViewFlags;
  v8 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v8 & 0xFFFFFFFFFFFFFBFFLL;
  [(UICollectionView *)self _visibleBounds];
  x = v9;
  y = v10;
  width = v11;
  height = v12;
  if ((v6 & 1) == 0)
  {
    v17 = CGRectGetWidth(*&v9) * -0.5;
    v65.origin.x = x;
    v65.origin.y = y;
    v65.size.width = width;
    v65.size.height = height;
    v18 = CGRectGetHeight(v65) * -0.5;
    v66.origin.x = x;
    v66.origin.y = y;
    v66.size.width = width;
    v66.size.height = height;
    v67 = CGRectInset(v66, v17, v18);
    x = v67.origin.x;
    y = v67.origin.y;
    width = v67.size.width;
    height = v67.size.height;
  }

  v19 = [(UICollectionViewLayout *)self->_layout _estimatesSupplementaryItems];
  [(UICollectionViewLayout *)self->_layout _willPerformUpdateVisibleCellsPass];
  v20 = _UISetCurrentFallbackEnvironment(self);
  v53 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v21 = v19;
  v52 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  v22 = dyld_program_sdk_at_least();
  if (v19)
  {
    v23 = dyld_program_sdk_at_least();
  }

  else
  {
    v23 = 0;
  }

  v55 = v23;
  if ((v22 | v23))
  {
    v46 = v19;
    v47 = v20;
    v48 = v8;
    v49 = &self->_collectionViewFlags;
    v50 = v6;
    v51 = v5;
    [(UICollectionViewLayout *)self->_layout _extendedAttributesQueryIncludingOrthogonalScrollingRegions:x, y, width, height];
    v57 = 0u;
    v58 = 0u;
    v59 = 0u;
    obj = v60 = 0u;
    v24 = [obj countByEnumeratingWithState:&v57 objects:v61 count:16];
    v25 = v55;
    if (!v24)
    {
      goto LABEL_41;
    }

    v26 = v24;
    v27 = *v58;
    v54 = self;
    while (1)
    {
      v28 = 0;
      do
      {
        if (*v58 != v27)
        {
          objc_enumerationMutation(obj);
        }

        v29 = *(*(&v57 + 1) + 8 * v28);
        if (v29)
        {
          v30 = *(v29 + 288) & 1;
          v31 = (*(v29 + 288) & 3) == 0;
        }

        else
        {
          v30 = 0;
          v31 = 0;
        }

        if (v22 & 1 | ((v30 & 1) == 0) && ((!v31 | v25) & 1) != 0)
        {
          v32 = [*(*(&v57 + 1) + 8 * v28) indexPath];
          if (!v32)
          {
LABEL_36:

            goto LABEL_37;
          }

          if (v30)
          {
            v33 = [(UICollectionViewUpdate *)self->_currentUpdate initialIndexPathForFinalIndexPath:v32];
            if (!v33)
            {
              goto LABEL_35;
            }

            v34 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v33];

            if (v34)
            {
              self = v54;
              if (!v31)
              {
LABEL_35:

                v25 = v55;
                goto LABEL_36;
              }

LABEL_29:
              subviewManager = self->_subviewManager;
              v38 = [(_UILabelConfiguration *)v29 _content];
              v39 = [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementaryOfKind:v38 atIndexPath:v33];

              if (!v39)
              {
                v40 = v52;
                v41 = v29;
                goto LABEL_33;
              }
            }

            else
            {
              v40 = v53;
              v41 = v32;
LABEL_33:
              [v40 addObject:v41];
            }
          }

          else
          {
            if (!v31)
            {
              v33 = 0;
              goto LABEL_35;
            }

            currentUpdate = self->_currentUpdate;
            v36 = [(_UILabelConfiguration *)v29 _content];
            v33 = [(UICollectionViewUpdate *)currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:v36 newIndexPath:v32];

            if (v33)
            {
              self = v54;
              goto LABEL_29;
            }
          }

          self = v54;
          goto LABEL_35;
        }

LABEL_37:
        ++v28;
      }

      while (v26 != v28);
      v42 = [obj countByEnumeratingWithState:&v57 objects:v61 count:16];
      v26 = v42;
      if (!v42)
      {
LABEL_41:

        v5 = v51;
        v6 = v50;
        LOWORD(v8) = v48;
        p_collectionViewFlags = v49;
        v20 = v47;
        v21 = v46;
        break;
      }
    }
  }

  v43 = [(UICollectionView *)self _updatePreferredAttributesForItemsInCurrentUpdateWithRect:v53 newlyVisible:v5 == 0 includeInserts:x, y, width, height];
  if (v21)
  {
    v43 |= [(UICollectionView *)self _updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:v52 newlyVisible:v5 == 0 includeInserts:x, y, width, height];
  }

  _UIRestorePreviousFallbackEnvironment(v20);
  [(UICollectionViewLayout *)self->_layout _didPerformUpdateVisibleCellsPassWithLayoutOffset:*MEMORY[0x1E695EFF8], *(MEMORY[0x1E695EFF8] + 8)];
  v44 = *(p_collectionViewFlags + 1);
  *(p_collectionViewFlags + 1) = v44 | v8 & 0x400;
  if ((v6 & v43) == 1 && (v44 & 0x400) != 0)
  {
    [(UICollectionView *)self _updatePreferredAttributesForCurrentUpdate:v5 + 1];
  }
}

- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdateWithRect:(CGRect)a3 newlyVisible:(id)a4 includeInserts:(BOOL)a5
{
  v5 = a5;
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v56 = *MEMORY[0x1E69E9840];
  v40 = a4;
  v11 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  if (v5)
  {
    v47 = 0u;
    v48 = 0u;
    v45 = 0u;
    v46 = 0u;
    v12 = self->_insertItems;
    v13 = [(NSMutableArray *)v12 countByEnumeratingWithState:&v45 objects:v55 count:16];
    if (v13)
    {
      v14 = v13;
      v15 = *v46;
      v41 = v12;
      v42 = self;
      do
      {
        for (i = 0; i != v14; ++i)
        {
          if (*v46 != v15)
          {
            objc_enumerationMutation(v12);
          }

          v17 = *(*(&v45 + 1) + 8 * i);
          if (v17 && v17[6] == 0x7FFFFFFFFFFFFFFFLL)
          {
            v18 = v17[3];
            v19 = self->_currentUpdate->_newModel;
            if (v18 < [(UICollectionViewData *)v19 numberOfSections])
            {
              v20 = [(UICollectionViewData *)v19 numberOfItemsInSection:v18];
              if (v20 >= 1)
              {
                v21 = v20;
                for (j = 0; j != v21; ++j)
                {
                  v23 = [MEMORY[0x1E696AC88] indexPathForItem:j inSection:v18];
                  [v11 addObject:v23];
                }

                v12 = v41;
                self = v42;
              }
            }
          }

          else
          {
            v19 = [v17 indexPathAfterUpdate];
            [v11 addObject:v19];
          }
        }

        v14 = [(NSMutableArray *)v12 countByEnumeratingWithState:&v45 objects:v55 count:16];
      }

      while (v14);
    }
  }

  subviewManager = self->_subviewManager;
  v43[0] = MEMORY[0x1E69E9820];
  v43[1] = 3221225472;
  v43[2] = __106__UICollectionView__updatePreferredAttributesForItemsInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke;
  v43[3] = &unk_1E70FF7B0;
  v43[4] = self;
  v25 = v11;
  v44 = v25;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v43];
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED492598);
  if (*CategoryCachedImpl)
  {
    v32 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      v33 = v32;
      v34 = [v40 valueForKey:@"_ui_shortDescription"];
      v35 = [v25 valueForKey:@"_ui_shortDescription"];
      *buf = 134218498;
      v50 = self;
      v51 = 2112;
      v52 = v34;
      v53 = 2112;
      v54 = v35;
      _os_log_impl(&dword_188A29000, v33, OS_LOG_TYPE_ERROR, "_updatePreferredAttributesForCurrentUpdate: cv == %p; indexPathsBecomingVisible == %@; indexPathsToRecompute == %@", buf, 0x20u);
    }
  }

  v27 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925A0);
  if (*v27)
  {
    v36 = *(v27 + 8);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
    {
      v37 = v36;
      v38 = [v40 valueForKey:@"_ui_shortDescription"];
      v39 = [v25 valueForKey:@"_ui_shortDescription"];
      *buf = 134218498;
      v50 = self;
      v51 = 2112;
      v52 = v38;
      v53 = 2112;
      v54 = v39;
      _os_log_impl(&dword_188A29000, v37, OS_LOG_TYPE_ERROR, "[UICV %p] _updatePreferredAttributesForCurrentUpdate indexPathsBecomingVisible = %@; indexPathsToRecompute = %@", buf, 0x20u);
    }
  }

  if ([v40 count])
  {
    [v25 unionSet:v40];
  }

  if ([(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes count])
  {
    v28 = [(NSMutableOrderedSet *)self->_indexPathsRequiringPreferredAttributes set];
    [v25 unionSet:v28];

    indexPathsRequiringPreferredAttributes = self->_indexPathsRequiringPreferredAttributes;
    self->_indexPathsRequiringPreferredAttributes = 0;
  }

  v30 = [(UICollectionView *)self _updatePreferredAttributesForItemsInCurrentUpdate:v25 rect:x, y, width, height];

  return v30;
}

void __106__UICollectionView__updatePreferredAttributesForItemsInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v8 = a2;
  v5 = [a3 _arePreferredAttributesValid];
  v6 = v8;
  if ((v5 & 1) == 0)
  {
    v7 = [*(*(a1 + 32) + 2280) finalIndexPathForInitialIndexPath:v8];
    if (v7)
    {
      [*(a1 + 40) addObject:v7];
    }

    v6 = v8;
  }
}

- (BOOL)_updatePreferredAttributesForItemsInCurrentUpdate:(id)a3 rect:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  v42 = *MEMORY[0x1E69E9840];
  v9 = a3;
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  v10 = [v9 countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (!v10)
  {
    LOBYTE(v12) = 0;
    goto LABEL_34;
  }

  v11 = v10;
  v12 = 0;
  v13 = *v38;
  v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
  v36 = v9;
  do
  {
    v15 = 0;
    do
    {
      if (*v38 != v13)
      {
        objc_enumerationMutation(v9);
      }

      v16 = *(*(&v37 + 1) + 8 * v15);
      v17 = v14[167];
      v18 = [*(&self->super.super.super.super.isa + v17) layoutAttributesForItemAtIndexPath:{v16, v36}];
      v19 = v18;
      if (v18)
      {
        v20 = *(&self->super.super.super.super.isa + v17);
        [v18 frame];
        [v20 _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v19 frame:?];
        v44.origin.x = v21;
        v44.origin.y = v22;
        v44.size.width = v23;
        v44.size.height = v24;
        v43.origin.x = x;
        v43.origin.y = y;
        v43.size.width = width;
        v43.size.height = height;
        if (CGRectIntersectsRect(v43, v44))
        {
          if (dyld_program_sdk_at_least())
          {
            v25 = [(UICollectionViewUpdate *)self->_currentUpdate initialIndexPathForFinalIndexPath:v16];
            if (v25)
            {
              v26 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v25];
              if (v26)
              {
                v27 = v26;
                v12 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v26 withOriginalAttributes:v19 isExistingView:1];

                goto LABEL_17;
              }
            }

            v28 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v16];
            v29 = v28;
            if (v28)
            {
              v30 = *(v28 + 24);
            }

            else
            {
              v30 = 0;
            }

            v31 = v30;

            if (v31)
            {
              if ([(UICollectionView *)self _updatePrefetchItemIfNeeded:v29 forIndexPath:v16 withLayoutAttributes:0 willDisplay:0])
              {

                v9 = v36;
LABEL_17:
                v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
LABEL_26:

                goto LABEL_27;
              }

              [(NSMutableDictionary *)self->_prefetchCacheItems removeObjectForKey:v16];
              if (v29)
              {
                v32 = v29[3];
              }

              else
              {
                v32 = 0;
              }

              v33 = v32;
              [(UICollectionView *)self _reusePrefetchedCell:v33];
            }

            v9 = v36;
            v14 = &OBJC_IVAR____UISystemBackgroundView__strokeView;
          }

          v25 = [(UICollectionView *)self _createPreparedCellForItemAtIndexPath:v16 withLayoutAttributes:v19 applyAttributes:1 isFocused:0 notify:0];
          v12 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v25 withOriginalAttributes:v19 isExistingView:0];
          if (([v25 _isInUpdateAnimation] & 1) == 0)
          {
            if (dyld_program_sdk_at_least())
            {
              [(UICollectionView *)self _cacheOrReuseCell:v25 forIndexPath:v16 invalidatePreferredAttributes:0 notifyDidEndDisplaying:0];
            }

            else
            {
              [(UICollectionView *)self _reuseCell:v25 notifyDidEndDisplaying:0];
            }
          }

          goto LABEL_26;
        }
      }

LABEL_27:

      ++v15;
    }

    while (v11 != v15);
    v34 = [v9 countByEnumeratingWithState:&v37 objects:v41 count:16];
    v11 = v34;
  }

  while (v34);
LABEL_34:

  return v12 & 1;
}

- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect:(CGRect)a3 newlyVisible:(id)a4 includeInserts:(BOOL)a5
{
  v5 = a5;
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v50 = *MEMORY[0x1E69E9840];
  v11 = a4;
  v12 = objc_alloc_init(MEMORY[0x1E695DFA8]);
  if (v5)
  {
    v33 = v11;
    v13 = self->_currentUpdate->_newModel;
    [(UICollectionViewData *)v13 validateLayoutInRect:y, width, height];
    v32 = v13;
    [(UICollectionViewData *)&v13->super.isa knownSupplementaryElementKinds];
    v44 = 0u;
    v45 = 0u;
    v46 = 0u;
    obj = v47 = 0u;
    v36 = [obj countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v36)
    {
      v35 = *v45;
      do
      {
        v14 = 0;
        do
        {
          if (*v45 != v35)
          {
            objc_enumerationMutation(obj);
          }

          v37 = v14;
          v15 = *(*(&v44 + 1) + 8 * v14);
          v16 = [(UICollectionViewLayout *)self->_layout indexPathsToInsertForSupplementaryViewOfKind:v15, v32];
          v40 = 0u;
          v41 = 0u;
          v42 = 0u;
          v43 = 0u;
          v17 = [v16 countByEnumeratingWithState:&v40 objects:v48 count:16];
          if (v17)
          {
            v18 = v17;
            v19 = *v41;
            do
            {
              for (i = 0; i != v18; ++i)
              {
                if (*v41 != v19)
                {
                  objc_enumerationMutation(v16);
                }

                v21 = [(UICollectionViewLayout *)self->_layout layoutAttributesForSupplementaryViewOfKind:v15 atIndexPath:*(*(&v40 + 1) + 8 * i)];
                v22 = v21;
                if (v21)
                {
                  layout = self->_layout;
                  [v21 frame];
                  [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v22 frame:?];
                  v52.origin.x = v24;
                  v52.origin.y = v25;
                  v52.size.width = v26;
                  v52.size.height = v27;
                  v51.origin.x = x;
                  v51.origin.y = y;
                  v51.size.width = width;
                  v51.size.height = height;
                  if (CGRectIntersectsRect(v51, v52))
                  {
                    [v12 addObject:v22];
                  }
                }
              }

              v18 = [v16 countByEnumeratingWithState:&v40 objects:v48 count:16];
            }

            while (v18);
          }

          ++v14;
        }

        while (v37 + 1 != v36);
        v36 = [obj countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v36);
    }

    v11 = v33;
  }

  if (dyld_program_sdk_at_least())
  {
    subviewManager = self->_subviewManager;
    v38[0] = MEMORY[0x1E69E9820];
    v38[1] = 3221225472;
    v38[2] = __116__UICollectionView__updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke;
    v38[3] = &unk_1E70FF7D8;
    v38[4] = self;
    v29 = v12;
    v39 = v29;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateSupplementariesWithEnumerator:v38];
      v29 = v39;
    }
  }

  if ([v11 count])
  {
    [v12 unionSet:v11];
  }

  v30 = [(UICollectionView *)self _updatePreferredAttributesForSupplementariesInCurrentUpdate:v12];

  return v30;
}

void __116__UICollectionView__updatePreferredAttributesForSupplementariesInCurrentUpdateWithRect_newlyVisible_includeInserts___block_invoke(uint64_t a1, void *a2, void *a3, void *a4)
{
  v10 = a2;
  v7 = a3;
  if (([a4 _arePreferredAttributesValid] & 1) == 0)
  {
    v8 = [(UICollectionViewUpdate *)*(*(a1 + 32) + 2280) validatedNewIndexPathForSupplementaryElementOfKind:v7 oldIndexPath:v10];
    if (v8)
    {
      v9 = [*(*(a1 + 32) + 2152) layoutAttributesForSupplementaryViewOfKind:v7 atIndexPath:v8];
      if (v9)
      {
        [*(a1 + 40) addObject:v9];
      }
    }
  }
}

- (BOOL)_updatePreferredAttributesForSupplementariesInCurrentUpdate:(id)a3
{
  v26 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v5 = [v4 countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = 0;
    v8 = *v22;
    while (1)
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v22 != v8)
        {
          objc_enumerationMutation(v4);
        }

        v10 = *(*(&v21 + 1) + 8 * i);
        if (dyld_program_sdk_at_least())
        {
          currentUpdate = self->_currentUpdate;
          v12 = [(_UILabelConfiguration *)v10 _content];
          v13 = [v10 indexPath];
          v14 = [(UICollectionViewUpdate *)currentUpdate validatedOldIndexPathForSupplementaryElementOfKind:v12 newIndexPath:v13];

          if (v14)
          {
            subviewManager = self->_subviewManager;
            v16 = [(_UILabelConfiguration *)v10 _content];
            v17 = [(_UICollectionViewSubviewManager *)subviewManager visibleSupplementaryOfKind:v16 atIndexPath:v14];

            if (v17)
            {
              v7 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v17 withOriginalAttributes:v10 isExistingView:1];

              goto LABEL_14;
            }
          }
        }

        v18 = [(_UILabelConfiguration *)v10 _content];
        v19 = [v10 indexPath];
        v14 = [(UICollectionView *)self _createPreparedSupplementaryViewForElementOfKind:v18 atIndexPath:v19 layout:self->_layout withLayoutAttributes:v10 applyAttributes:1];

        if (v14)
        {
          v7 |= [(UICollectionView *)self _updatePreferredAttributesForReusableViewInCurrentUpdate:v14 withOriginalAttributes:v10 isExistingView:0];
          if (([v14 _isInUpdateAnimation] & 1) == 0)
          {
            [(UICollectionView *)self _reuseSupplementaryView:v14];
          }
        }

LABEL_14:
      }

      v6 = [v4 countByEnumeratingWithState:&v21 objects:v25 count:16];
      if (!v6)
      {
        goto LABEL_18;
      }
    }
  }

  LOBYTE(v7) = 0;
LABEL_18:

  return v7 & 1;
}

- (BOOL)_updatePreferredAttributesForReusableViewInCurrentUpdate:(id)a3 withOriginalAttributes:(id)a4 isExistingView:(BOOL)a5
{
  v5 = a5;
  v9 = a3;
  v10 = a4;
  if (dyld_program_sdk_at_least() && ([v9 _arePreferredAttributesValid] & 1) != 0)
  {
    v11 = 0;
  }

  else
  {
    if (!v9)
    {
      v16 = [MEMORY[0x1E696AAA8] currentHandler];
      [v16 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12388 description:{@"UICollectionView internal inconsistency. Attempting to update preferred attributes for nil view. Collection view: %@; Original attributes: %@", self, v10}];
    }

    v12 = [v10 copy];
    if (!v12)
    {
      v17 = [MEMORY[0x1E696AAA8] currentHandler];
      [v17 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12391 description:{@"UICollectionView internal inconsistency: missing original layout attributes necessary to update preferred attributes for view: %@", v9}];
    }

    [(UICollectionViewLayout *)self->_layout _prepareForPreferredAttributesQueryForView:v9 withLayoutAttributes:v12];
    currentUpdate = self->_currentUpdate;
    if ((!currentUpdate || (*&currentUpdate->_flags & 2) == 0) && !+[UIView _isInAnimationBlockWithAnimationsEnabled])
    {
      v5 = 0;
    }

    v14 = [v9 _preferredLayoutAttributesFittingAttributes:v12 isAnimatingExistingView:v5];
    if (!v14)
    {
      v18 = [MEMORY[0x1E696AAA8] currentHandler];
      [v18 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12400 description:{@"UICollectionView internal inconsistency: reusable view %@ returning nil preferred layout attributes for fitting attributes: %@", v9, 0}];
    }

    [(UICollectionViewLayout *)self->_layout _postProcessPreferredAttributes:v14 forView:v9];
    [(UICollectionViewLayout *)self->_layout shouldInvalidateLayoutForPreferredLayoutAttributes:v14 withOriginalAttributes:v10];

    v11 = 1;
  }

  return v11;
}

- (void)_computeVisibleContentOffsetForUpdate:(id)a3 usingData:(id)a4
{
  v39 = a3;
  v6 = a4;
  [(UIView *)self bounds];
  v8 = v7;
  v10 = v9;
  v12 = v11;
  v14 = v13;
  v15 = [(UICollectionViewData *)v6 collectionViewContentRect];
  v17 = v16;
  v19 = v18;
  v21 = v20;

  [(UIScrollView *)self _effectiveContentInset];
  v24 = v15 - v23;
  v26 = v19 - (-v23 - v25);
  v28 = v17 - v27;
  v29 = v21 - (-v22 - v27);
  v43.origin.x = v24;
  v43.origin.y = v28;
  v43.size.width = v26;
  v43.size.height = v29;
  v56.origin.x = v8;
  v56.origin.y = v10;
  v40 = v14;
  v41 = v12;
  v56.size.width = v12;
  v56.size.height = v14;
  v30 = CGRectContainsRect(v43, v56);
  v31 = v8;
  v32 = v10;
  if (!v30)
  {
    v44.origin.x = v8;
    v44.origin.y = v10;
    v44.size.height = v40;
    v44.size.width = v12;
    MaxY = CGRectGetMaxY(v44);
    v45.origin.x = v24;
    v45.origin.y = v28;
    v45.size.width = v26;
    v45.size.height = v29;
    v32 = v10;
    if (MaxY > CGRectGetMaxY(v45))
    {
      v46.origin.x = v24;
      v46.origin.y = v28;
      v46.size.width = v26;
      v46.size.height = v29;
      Height = CGRectGetHeight(v46);
      v47.origin.x = v8;
      v47.origin.y = v10;
      v47.size.height = v40;
      v47.size.width = v41;
      v32 = v10;
      if (Height > CGRectGetHeight(v47))
      {
        v48.origin.x = v8;
        v48.origin.y = v10;
        v48.size.height = v40;
        v48.size.width = v41;
        v35 = CGRectGetMaxY(v48);
        v49.origin.x = v24;
        v49.origin.y = v28;
        v49.size.width = v26;
        v49.size.height = v29;
        v32 = v10 - (v35 - CGRectGetMaxY(v49));
      }
    }

    v50.origin.x = v8;
    v50.origin.y = v10;
    v50.size.height = v40;
    v50.size.width = v41;
    MaxX = CGRectGetMaxX(v50);
    v51.origin.x = v24;
    v51.origin.y = v28;
    v51.size.width = v26;
    v51.size.height = v29;
    if (MaxX <= CGRectGetMaxX(v51) || (v52.origin.x = v24, v52.origin.y = v28, v52.size.width = v26, v52.size.height = v29, Width = CGRectGetWidth(v52), v53.origin.x = v8, v53.origin.y = v10, v53.size.height = v40, v53.size.width = v41, Width <= CGRectGetWidth(v53)))
    {
      v31 = v8;
    }

    else
    {
      v54.origin.x = v8;
      v54.origin.y = v10;
      v54.size.height = v40;
      v54.size.width = v41;
      v38 = CGRectGetMaxX(v54);
      v55.origin.x = v24;
      v55.origin.y = v28;
      v55.size.width = v26;
      v55.size.height = v29;
      v31 = v8 - (v38 - CGRectGetMaxX(v55));
    }
  }

  v39[4] = v8;
  v39[5] = v10;
  v39[6] = v31;
  v39[7] = v32;
}

- (BOOL)_updateWithItems:(id)a3 tentativelyForReordering:(BOOL)a4 propertyAnimator:(id)a5 collectionViewAnimator:(id)a6
{
  v223 = *MEMORY[0x1E69E9840];
  v160 = a3;
  v157 = a5;
  v158 = a6;
  v8 = +[UIView areAnimationsEnabled];
  v9 = dyld_program_sdk_at_least() ^ 1;
  v10 = v9 & v8;
  if (v9)
  {
    v11 = self;
  }

  else
  {
    v11 = self;
    if (v8)
    {
      v12 = [(UIView *)self window];
      v10 = v12 != 0;
    }
  }

  [(UICollectionView *)v11 _prepareLayoutForUpdates:v10];
  currentUpdate = v11->_currentUpdate;
  if (currentUpdate)
  {
    *&currentUpdate->_flags |= 1u;
  }

  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke;
  aBlock[3] = &unk_1E70FFBD8;
  aBlock[4] = v11;
  v14 = _Block_copy(aBlock);
  subviewManager = v11->_subviewManager;
  if (subviewManager)
  {
    visibleViews = subviewManager->_visibleViews;
    if (visibleViews)
    {
      visibleViews->_indexPathValidationEnabled = 0;
    }
  }

  v161 = v10;
  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925A8);
  if (*CategoryCachedImpl)
  {
    v142 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v142, OS_LOG_TYPE_ERROR))
    {
      v143 = v11->_currentUpdate;
      *v219 = 134218242;
      v220 = v11;
      v221 = 2112;
      v222 = v143;
      _os_log_impl(&dword_188A29000, v142, OS_LOG_TYPE_ERROR, "[UICV %p] _updateWithItems: Processing update %@", v219, 0x16u);
    }
  }

  [(UICollectionView *)v11 _rebasePrefetchedCellIndexPathsWithMapping:v14];
  [(UICollectionView *)v11 _resignOrRebaseFirstResponderViewWithIndexPathMapping:v14];
  [(UICollectionView *)v11 _resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:v14];
  v18 = [(UICollectionView *)v11 _identityTracker:0];
  if (v18)
  {
    v19 = [(UICollectionView *)v11 contextMenuInteraction];
    v20 = [v19 _internalIdentifiersForDismissingMenu];

    v199 = 0u;
    v200 = 0u;
    v197 = 0u;
    v198 = 0u;
    v21 = v20;
    v22 = [v21 countByEnumeratingWithState:&v197 objects:v210 count:16];
    if (v22)
    {
      v23 = v22;
      v24 = *v198;
      while (2)
      {
        for (i = 0; i != v23; ++i)
        {
          if (*v198 != v24)
          {
            objc_enumerationMutation(v21);
          }

          v26 = *(*(&v197 + 1) + 8 * i);
          v27 = [(_UIIndexPathIdentityTracker *)v18 currentIndexPathForIdentifier:v26];
          if (v27)
          {
            v28 = [(UICollectionViewUpdate *)self->_currentUpdate finalIndexPathForInitialIndexPath:v27];

            if (!v28)
            {
              v29 = [(UICollectionView *)self contextMenuInteraction];
              [v29 _retargetDismissingMenuWithInternalIdentifier:v26 toPreview:0 force:0];

              goto LABEL_23;
            }
          }
        }

        v23 = [v21 countByEnumeratingWithState:&v197 objects:v210 count:16];
        if (v23)
        {
          continue;
        }

        break;
      }
    }

LABEL_23:

    [(_UIIndexPathIdentityTracker *)v18 updateWithUpdateItems:v160];
    v11 = self;
  }

  v30 = (v14)[2](v14, v11->_pendingSelectionIndexPath);
  pendingSelectionIndexPath = v11->_pendingSelectionIndexPath;
  v11->_pendingSelectionIndexPath = v30;

  v32 = v11->_selectionController;
  v33 = v11;
  v34 = v32;
  if (v32)
  {
    v159 = [(NSMutableSet *)v32->_selectedIndexPaths copy];
  }

  else
  {
    v159 = 0;
  }

  if ([(UICollectionView *)v33 _isConnectedToDiffableDataSource])
  {
    v35 = [(UICollectionView *)v33 _diffableDataSourceImpl];
    v36 = [v35 currentTransaction];
    v37 = v36;
    if (v35 && v36)
    {
      v38 = [(_UICollectionViewSelectionController *)v34 rebaseItemsWithDiffableTransaction:v36];

      v33 = self;
      if (v38)
      {
        goto LABEL_33;
      }
    }

    else
    {

      v33 = self;
    }
  }

  [(_UICollectionViewSelectionController *)v34 rebaseItemsWithTranslator:?];
LABEL_33:
  if (!v34 || ([*(v34 + 8) isEqualToSet:v159] & 1) == 0)
  {
    [(_UICollectionViewMultiSelectController *)v33->_multiSelectController clearSelectionState];
  }

  v155 = v34;
  v156 = v18;
  if (v33->_pendingDeselectionIndexPaths)
  {
    v39 = [objc_alloc(MEMORY[0x1E695DFA8]) initWithCapacity:{-[NSMutableSet count](v33->_pendingDeselectionIndexPaths, "count")}];
    v193 = 0u;
    v194 = 0u;
    v195 = 0u;
    v196 = 0u;
    v40 = v33->_pendingDeselectionIndexPaths;
    v41 = [(NSMutableSet *)v40 countByEnumeratingWithState:&v193 objects:v209 count:16];
    if (v41)
    {
      v42 = v41;
      v43 = *v194;
      do
      {
        for (j = 0; j != v42; ++j)
        {
          if (*v194 != v43)
          {
            objc_enumerationMutation(v40);
          }

          v45 = v14[2](v14, *(*(&v193 + 1) + 8 * j));
          if (v45)
          {
            [(NSMutableSet *)v39 addObject:v45];
          }
        }

        v42 = [(NSMutableSet *)v40 countByEnumeratingWithState:&v193 objects:v209 count:16];
      }

      while (v42);
    }

    v33 = self;
    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = v39;
  }

  [(UICollectionView *)v33 _reloadSectionIndexTitles];
  [(UICollectionView *)v33 _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
  collectionViewData = self->_collectionViewData;
  [(UIScrollView *)self visibleBounds];
  [(UICollectionViewData *)collectionViewData validateLayoutInRect:v48, v49, v50, v51];
  [(UICollectionView *)self _computeVisibleContentOffsetForUpdate:self->_currentUpdate usingData:self->_collectionViewData];
  [(UICollectionView *)self _clearSpecificInvalidationLists];
  v52 = self;
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectResult = typeSelectController->_typeSelectResult;
    typeSelectController->_typeSelectResult = 0;
  }

  if ((*(&self->_collectionViewFlags + 17) & 0x40) != 0 || +[UIView areAnimationsEnabled])
  {
    v55 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925B0);
    if (*v55)
    {
      v144 = *(v55 + 8);
      if (os_log_type_enabled(v144, OS_LOG_TYPE_ERROR))
      {
        contentOffsetRestorationAnchor = self->_contentOffsetRestorationAnchor;
        *v219 = 134218242;
        v220 = self;
        v221 = 2112;
        v222 = contentOffsetRestorationAnchor;
        _os_log_impl(&dword_188A29000, v144, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p; Attempting to rebase anchor for %@", v219, 0x16u);
      }
    }

    [(UICollectionView *)self _rebaseContentOffsetAnchorOrScrollTargetForUpdate:self->_currentUpdate];
  }

  v154 = [(UICollectionView *)self _reviseNewContentOffsetForUpdate:self->_currentUpdate];
  didScrollNotificationSuspensionCount = self->_didScrollNotificationSuspensionCount;
  if (!didScrollNotificationSuspensionCount)
  {
    [(UIScrollView *)self contentOffset];
    self->_contentOffsetWhenScrollNotificationsSuspended.x = v57;
    self->_contentOffsetWhenScrollNotificationsSuspended.y = v58;
    v52 = self;
  }

  v52->_didScrollNotificationSuspensionCount = didScrollNotificationSuspensionCount + 1;
  if (v161)
  {
    v59 = [[UIViewAnimationContext alloc] initWithCompletionHandler:?];
    updateCompletionHandler = self->_updateCompletionHandler;
    self->_updateCompletionHandler = 0;

    v61 = self->_currentUpdate;
    if (v61)
    {
      *&v61->_flags |= 2u;
    }

    v189[0] = MEMORY[0x1E69E9820];
    v189[1] = 3221225472;
    v189[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_929;
    v189[3] = &unk_1E70F6B40;
    v189[4] = self;
    v190 = v158;
    v62 = v160;
    v191 = v62;
    v63 = v59;
    v192 = v63;
    [UIView performWithoutAnimation:v189];
    v64 = [(UICollectionViewLayout *)self->_layout _propertyAnimatorForCollectionViewUpdates:v62 withCustomAnimator:v157];

    if (v64)
    {
      v65 = dispatch_group_create();
    }

    else
    {
      v65 = 0;
    }

    v115 = [v64 copy];
    v116 = [v64 copy];
    v185 = 0u;
    v186 = 0u;
    v187 = 0u;
    v188 = 0u;
    v162 = v64;
    v117 = [v64 _animations];
    v118 = [v117 countByEnumeratingWithState:&v185 objects:v208 count:16];
    if (v118)
    {
      v119 = v118;
      v120 = *v186;
      do
      {
        for (k = 0; k != v119; ++k)
        {
          if (*v186 != v120)
          {
            objc_enumerationMutation(v117);
          }

          v122 = [*(*(&v185 + 1) + 8 * k) copy];
          [v116 addAnimations:v122];
        }

        v119 = [v117 countByEnumeratingWithState:&v185 objects:v208 count:16];
      }

      while (v119);
    }

    v183 = 0u;
    v184 = 0u;
    v181 = 0u;
    v182 = 0u;
    v123 = [v162 _completions];
    v124 = [v123 countByEnumeratingWithState:&v181 objects:v207 count:16];
    if (v124)
    {
      v125 = v124;
      v126 = *v182;
      do
      {
        for (m = 0; m != v125; ++m)
        {
          if (*v182 != v126)
          {
            objc_enumerationMutation(v123);
          }

          v128 = [*(*(&v181 + 1) + 8 * m) copy];
          [v116 addCompletion:v128];
        }

        v125 = [v123 countByEnumeratingWithState:&v181 objects:v207 count:16];
      }

      while (v125);
    }

    v176[0] = MEMORY[0x1E69E9820];
    v176[1] = 3221225472;
    v176[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2;
    v176[3] = &unk_1E70FF800;
    v176[4] = self;
    v129 = v63;
    v177 = v129;
    v130 = v115;
    v178 = v130;
    v131 = v65;
    v179 = v131;
    v180 = v154;
    v132 = _Block_copy(v176);
    v174[0] = MEMORY[0x1E69E9820];
    v174[1] = 3221225472;
    v174[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_931;
    v174[3] = &unk_1E70F3C60;
    v174[4] = self;
    v109 = v129;
    v175 = v109;
    v133 = _Block_copy(v174);
    v97 = v116;
    if (v116)
    {
      [v116 addAnimations:v132];
      [v116 startAnimation];
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2_932;
      block[3] = &unk_1E70F0F78;
      v173 = v133;
      dispatch_group_notify(v131, MEMORY[0x1E69E96A0], block);
    }

    else
    {
      if (dyld_program_sdk_at_least())
      {
        v134 = 6;
      }

      else
      {
        v134 = 4;
      }

      [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v134 options:v132 animations:v133 completion:?];
    }

    v103 = v155;

    LOBYTE(v111) = 0;
    p_collectionViewFlags = &self->_collectionViewFlags;
    goto LABEL_140;
  }

  v66 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925B8);
  if (*v66)
  {
    v146 = *(v66 + 8);
    if (os_log_type_enabled(v146, OS_LOG_TYPE_ERROR))
    {
      v147 = v52->_currentUpdate;
      *v219 = 134218242;
      v220 = v52;
      v221 = 2112;
      v222 = v147;
      _os_log_impl(&dword_188A29000, v146, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p; performing update without animations. Update: %@", v219, 0x16u);
    }
  }

  indexPathsRequiringPreferredAttributes = v52->_indexPathsRequiringPreferredAttributes;
  v52->_indexPathsRequiringPreferredAttributes = 0;

  v68 = v52->_currentUpdate;
  v153 = v68;
  if (!v68)
  {
    v148 = [MEMORY[0x1E696AAA8] currentHandler];
    [v148 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:v52 file:@"UICollectionView.m" lineNumber:12742 description:{@"Invalid parameter not satisfying: %@", @"currentUpdate != nil"}];
LABEL_156:

    goto LABEL_63;
  }

  if ((*&v68->_flags & 2) != 0)
  {
    v148 = [MEMORY[0x1E696AAA8] currentHandler];
    [v148 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:v52 file:@"UICollectionView.m" lineNumber:12743 description:{@"UICollectionView internal inconsistency: attempted to reuse deleted views for an update which is not animated. Collection view: %@", v52}];
    goto LABEL_156;
  }

LABEL_63:
  v69 = objc_alloc_init(_UICollectionViewSubviewCollection);
  v70 = objc_opt_new();
  p_isa = &v69->super.isa;
  [(UICollectionView *)v52 _populateSubviewCollectionWithExistingVisibleViewsForCurrentUpdate:v69 addingDeletedViewsToSet:v70 updateLayoutAttributesIndexPaths:1];
  v71 = self->_focusedItemState;
  v72 = self;
  v73 = self->_firstResponderView;
  v202 = 0u;
  v203 = 0u;
  v204 = 0u;
  v205 = 0u;
  v74 = v70;
  v75 = [v74 countByEnumeratingWithState:&v202 objects:v219 count:16];
  if (!v75)
  {
    goto LABEL_98;
  }

  v76 = v75;
  v77 = *v203;
  do
  {
    v78 = 0;
    do
    {
      if (*v203 != v77)
      {
        objc_enumerationMutation(v74);
      }

      v79 = *(*(&v202 + 1) + 8 * v78);
      if (![(UICollectionView *)v72 _viewIsReorderedCell:v79])
      {
        if ([(UICollectionReusableView *)v79 _isInUpdateAnimation])
        {
          [(UICollectionReusableView *)v79 _setHiddenForReuse:1];
          goto LABEL_88;
        }

        if (v71 && (v80 = v71->_reusableView, v80, v79 == v80))
        {
          v88 = [MEMORY[0x1E696AAA8] currentHandler];
          v89 = [(UICollectionReusableView *)v79 _layoutAttributes];
          [v88 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:self file:v79 lineNumber:v89 description:v71];

          if (v73)
          {
            goto LABEL_74;
          }
        }

        else if (v73)
        {
LABEL_74:
          if (v79 == v73)
          {
            v90 = [MEMORY[0x1E696AAA8] currentHandler];
            v91 = [(UICollectionReusableView *)v79 _layoutAttributes];
            [v90 handleFailureInMethod:sel__updateSubviewManagerForCurrentUpdateWithoutAnimationsReusingDeletedViews object:self file:v79 lineNumber:v91 description:?];
          }
        }

        v81 = [(UICollectionReusableView *)v79 _layoutAttributes];
        v82 = v81;
        if (v81)
        {
          v72 = self;
          if ((*(v81 + 288) & 1) == 0)
          {
            if ([(UICollectionView *)self _reuseSupplementaryView:v79])
            {
              goto LABEL_87;
            }

LABEL_85:
            v87 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925D0);
            if (*v87)
            {
              v93 = *(v87 + 8);
              if (os_log_type_enabled(v93, OS_LOG_TYPE_ERROR))
              {
                *buf = 134218754;
                v212 = self;
                v213 = 2112;
                v214 = v79;
                v215 = 2112;
                v216 = v82;
                v217 = 2112;
                v218 = v153;
                v84 = v93;
                v85 = "_createNewSubviewManagerForUpdateWithoutAnimations: cv == %p; forcibly removing view: %@; with attributes: %@; for update: %@";
                v86 = 42;
LABEL_83:
                _os_log_impl(&dword_188A29000, v84, OS_LOG_TYPE_ERROR, v85, buf, v86);
              }
            }

            goto LABEL_86;
          }

          if (![(UICollectionView *)self _reuseCell:v79 notifyDidEndDisplaying:1])
          {
            goto LABEL_85;
          }
        }

        else
        {
          if (os_variant_has_internal_diagnostics())
          {
            v92 = __UIFaultDebugAssertLog();
            if (os_log_type_enabled(v92, OS_LOG_TYPE_FAULT))
            {
              *buf = 138412546;
              v212 = self;
              v213 = 2112;
              v214 = v79;
              _os_log_fault_impl(&dword_188A29000, v92, OS_LOG_TYPE_FAULT, "UICollectionView internal bug: non-animated batch update forcibly removing deleted view without layout attributes. Collection view:  %@; view: %@", buf, 0x16u);
            }
          }

          else
          {
            v83 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED4925C8) + 8);
            if (os_log_type_enabled(v83, OS_LOG_TYPE_ERROR))
            {
              *buf = 138412546;
              v212 = self;
              v213 = 2112;
              v214 = v79;
              v84 = v83;
              v85 = "UICollectionView internal bug: non-animated batch update forcibly removing deleted view without layout attributes. Collection view:  %@; view: %@";
              v86 = 22;
              goto LABEL_83;
            }
          }

LABEL_86:
          [(UIView *)v79 removeFromSuperview];
          v72 = self;
        }

LABEL_87:
      }

LABEL_88:
      ++v78;
    }

    while (v76 != v78);
    v94 = [v74 countByEnumeratingWithState:&v202 objects:v219 count:16];
    v76 = v94;
  }

  while (v94);
LABEL_98:

  [(_UICollectionViewSubviewManager *)v72->_subviewManager replaceVisibleViewsWithoutCopyingWithContentsOfSubviewCollection:?];
  v168 = 0u;
  v169 = 0u;
  v170 = 0u;
  v171 = 0u;
  v95 = v72->_skippedBatchUpdatePropertyAnimators;
  v96 = [(NSMutableArray *)v95 countByEnumeratingWithState:&v168 objects:v206 count:16];
  v97 = v157;
  p_collectionViewFlags = &self->_collectionViewFlags;
  if (v96)
  {
    v99 = v96;
    v100 = *v169;
    do
    {
      for (n = 0; n != v99; ++n)
      {
        if (*v169 != v100)
        {
          objc_enumerationMutation(v95);
        }

        [*(*(&v168 + 1) + 8 * n) startAnimation];
      }

      v99 = [(NSMutableArray *)v95 countByEnumeratingWithState:&v168 objects:v206 count:16];
    }

    while (v99);
  }

  v102 = self;
  v103 = v155;
  if (v154)
  {
    v104 = self->_currentUpdate;
    x = v104->_newContentOffset.x;
    y = v104->_newContentOffset.y;
    v107 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v107 | 0x80000;
    [(UICollectionView *)self setContentOffset:x, y];
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v107 >> 19) & 1) << 19);
    if ([(UIScrollView *)self isDecelerating])
    {
      v108 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925C0);
      if (*v108)
      {
        v149 = *(v108 + 8);
        if (os_log_type_enabled(v149, OS_LOG_TYPE_ERROR))
        {
          v150 = v149;
          [(UIScrollView *)self contentOffset];
          v151 = NSStringFromCGPoint(v224);
          *v219 = 134218242;
          v220 = self;
          v221 = 2112;
          v222 = v151;
          _os_log_impl(&dword_188A29000, v150, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p updating decel last offset to %@", v219, 0x16u);

          v102 = self;
        }
      }

      [(UIScrollView *)v102 contentOffset];
      [(UIScrollView *)v102 _updateDecelerationLastOffset:?];
    }
  }

  [(UICollectionView *)v102 _resumeDidScrollNotifications];
  [(UICollectionViewData *)v102->_collectionViewData finalizeCollectionViewUpdates];
  [(UICollectionViewLayout *)v102->_layout _finalizeCollectionViewUpdate:v102->_currentUpdate];
  [(UICollectionView *)v102 _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v109 = _Block_copy(v102->_updateCompletionHandler);
  v110 = v102->_updateCompletionHandler;
  v102->_updateCompletionHandler = 0;

  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    v114 = [(UIView *)v102 window];
    if (v114)
    {
      LOBYTE(v111) = 1;
    }

    else
    {
      v111 = dyld_program_sdk_at_least() ^ 1;
    }

    if (!v157)
    {
      goto LABEL_138;
    }

LABEL_111:
    v164[0] = MEMORY[0x1E69E9820];
    v164[1] = 3221225472;
    v164[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2_936;
    v164[3] = &unk_1E70FFB68;
    v112 = &v165;
    v165 = v109;
    v113 = v109;
    [v157 addCompletion:v164];
    [v157 startAnimation];
  }

  else
  {
    v111 = dyld_program_sdk_at_least() ^ 1;
    if (v157)
    {
      goto LABEL_111;
    }

LABEL_138:
    v166[0] = MEMORY[0x1E69E9820];
    v166[1] = 3221225472;
    v166[2] = __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_935;
    v166[3] = &unk_1E70F0F78;
    v112 = &v167;
    v167 = v109;
    v135 = v109;
    dispatch_async(MEMORY[0x1E69E96A0], v166);
  }

LABEL_140:
  *(p_collectionViewFlags + 1) &= ~0x10000000uLL;
  v136 = self->_currentUpdate;
  self->_currentUpdate = 0;

  [(UICollectionViewLayout *)self->_layout _setCollectionViewAnimationContext:0];
  v137 = self->_subviewManager;
  if (v137)
  {
    v138 = v137->_visibleViews;
    if (v138)
    {
      v138->_indexPathValidationEnabled = 1;
    }
  }

  v139 = self->_typeSelectController;
  if (v139)
  {
    typeSelectInteraction = v139->_typeSelectInteraction;
    if (!typeSelectInteraction || (*(typeSelectInteraction + 101) & 1) == 0)
    {
      [(_UITypeSelectInteraction *)typeSelectInteraction _updateResultsAnimated:?];
    }
  }

  return v111;
}

id __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke(uint64_t a1, void *a2)
{
  if (a2)
  {
    v4 = [(UICollectionViewData *)*(*(*(a1 + 32) + 2280) + 16) validatedGlobalIndexForItemAtIndexPath:a2];
    if (v4 == 0x7FFFFFFFFFFFFFFFLL || (v5 = [*(*(a1 + 32) + 2280) finalGlobalIndexForInitialGlobalIndex:v4], v5 == 0x7FFFFFFFFFFFFFFFLL))
    {
      v6 = 0;
    }

    else
    {
      v6 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:v5];
    }
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

uint64_t __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_929(uint64_t a1)
{
  [*(a1 + 32) contentOffset];
  v3 = v2;
  v5 = v4;
  v6 = *(a1 + 32);
  v7 = *(v6 + 2280);
  v8 = *(v7 + 48);
  v9 = *(v7 + 56);
  v10 = *(v6 + 2736);
  *(v6 + 2736) = v10 | 0x80000;
  [v6 setContentOffset:{v8, v9}];
  *(v6 + 2736) = *(v6 + 2736) & 0xFFF7FFFF | (((v10 >> 19) & 1) << 19);
  v11 = _UISetCurrentFallbackEnvironment(*(a1 + 32));
  v12 = [[_UICollectionViewAnimationContext alloc] initWithDataSourceTranslator:*(a1 + 48) updates:*(*(a1 + 32) + 2152) layout:?];
  [(_UICollectionViewAnimator *)*(a1 + 40) setAnimationContext:v12];

  v13 = *(a1 + 32);
  v14 = *(a1 + 40);
  if (v14)
  {
    [v13 _viewAnimationsForCurrentUpdateWithCollectionViewAnimator:v14 updatingContentOffsetForRestorationAnchor:1];
  }

  else
  {
    [v13 _viewAnimationsForCurrentUpdate];
  }
  v15 = ;
  [(UIViewAnimationContext *)*(a1 + 56) setViewAnimations:v15];

  v16 = [(_UILabelConfiguration *)*(a1 + 40) _content];
  [*(*(a1 + 32) + 2152) _setCollectionViewAnimationContext:v16];

  result = _UIRestorePreviousFallbackEnvironment(v11);
  v18 = *(a1 + 32);
  if (v18)
  {
    v19 = v18[684];
    v18[684] = v19 | 0x80000;
    result = [v18 setContentOffset:{v3, v5}];
    v18[684] = v18[684] & 0xFFF7FFFF | (((v19 >> 19) & 1) << 19);
  }

  return result;
}

void __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_2(uint64_t a1)
{
  v29 = *MEMORY[0x1E69E9840];
  [*(a1 + 32) _incrementUpdateAnimationCountWithContext:*(a1 + 40)];
  v2 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) allVisibleViewsHashTable];
  [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) removeAllVisibleViews];
  [*(a1 + 32) _startViewAnimationsWithContext:*(a1 + 40) oldVisibleViews:v2 viewAnimator:*(a1 + 48) viewAnimationsCompletedDispatchGroup:*(a1 + 56)];
  [(_UICollectionViewOrthogonalScrollerSectionController *)*(*(a1 + 32) + 2952) layoutScrollViews];
  [*(a1 + 32) _layoutSectionContainerViews];
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v3 = *(*(a1 + 32) + 3216);
  v4 = [v3 countByEnumeratingWithState:&v20 objects:v28 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v21;
    do
    {
      for (i = 0; i != v5; ++i)
      {
        if (*v21 != v6)
        {
          objc_enumerationMutation(v3);
        }

        [*(*(&v20 + 1) + 8 * i) startAnimation];
      }

      v5 = [v3 countByEnumeratingWithState:&v20 objects:v28 count:16];
    }

    while (v5);
  }

  if ((*(a1 + 64) & 1) != 0 || ([*(a1 + 32) isScrollAnimating] & 1) == 0 && (objc_msgSend(*(a1 + 32), "isDragging") & 1) == 0)
  {
    v8 = *(a1 + 32);
    v9 = *(v8 + 2280);
    v10 = *(v9 + 48);
    v11 = *(v9 + 56);
    v12 = *(v8 + 2736);
    *(v8 + 2736) = v12 | 0x80000;
    [v8 setContentOffset:{v10, v11, v20}];
    *(v8 + 2736) = *(v8 + 2736) & 0xFFF7FFFF | (((v12 >> 19) & 1) << 19);
    if ([*(a1 + 32) isDecelerating])
    {
      CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_UIInternalPreference_CollectionViewShouldComputeVisibleBoundsForCurrentUpdateAfterPreparingLayout_block_invoke_11___s_category);
      if (*CategoryCachedImpl)
      {
        v16 = *(CategoryCachedImpl + 8);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          v17 = *(a1 + 32);
          v18 = v16;
          [v17 contentOffset];
          v19 = NSStringFromCGPoint(v30);
          *buf = 134218242;
          v25 = v17;
          v26 = 2112;
          v27 = v19;
          _os_log_impl(&dword_188A29000, v18, OS_LOG_TYPE_ERROR, "_updateWithItems: cv == %p updating decel last offset to %@", buf, 0x16u);
        }
      }

      v14 = *(a1 + 32);
      [v14 contentOffset];
      [v14 _updateDecelerationLastOffset:?];
    }
  }

  [(UICollectionView *)*(a1 + 32) _resumeDidScrollNotifications];
  [(UICollectionViewData *)*(*(a1 + 32) + 2272) finalizeCollectionViewUpdates];
  [*(*(a1 + 32) + 2152) _finalizeCollectionViewUpdate:*(*(a1 + 32) + 2280)];
  if (_UIBarsApplyChromelessEverywhere())
  {
    v15 = *(a1 + 32);
    [v15[269] collectionViewContentSize];
    [v15 _setContentSizeFromLayout:0 isRecursivelyUpdatingVisibleCells:?];
  }
}

uint64_t __102__UICollectionView__updateWithItems_tentativelyForReordering_propertyAnimator_collectionViewAnimator___block_invoke_935(uint64_t a1)
{
  result = *(a1 + 32);
  if (result)
  {
    return (*(result + 16))(result, 1);
  }

  return result;
}

- (void)_resignOrRebaseFirstResponderViewWithIndexPathMapping:(id)a3
{
  v24 = a3;
  if ([(UICollectionView *)self _isFirstResponderInDeletedSectionOrItem])
  {
    v5 = 0;
    do
    {
      v6 = [(UIView *)self window];
      v7 = [v6 firstResponder];

      v8 = self->_firstResponderView;
      v9 = self->_firstResponderIndexPath;
      v10 = [v7 resignFirstResponder];
      v11 = [(UIView *)self window];
      v12 = [v11 firstResponder];

      if (!v10 || v7 == v12)
      {
        v16 = [MEMORY[0x1E696AAA8] currentHandler];
        v17 = v16;
        v18 = @"NO";
        if (v10)
        {
          v18 = @"YES";
        }

        [v16 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12827 description:{@"The first responder contained inside of a deleted section or item refused to resign.\nFirst responder that was asked to resign (returned %@ from -resignFirstResponder): %@ inside containing view: %@ at index path: %@\nCurrent first responder: %@ inside containing view: %@ at index path: %@", v18, v7, v8, v9, v12, self->_firstResponderView, self->_firstResponderIndexPath}];
      }

      if (v5 >= 0x64)
      {
        v13 = [MEMORY[0x1E696AAA8] currentHandler];
        v14 = v13;
        v15 = @"NO";
        if (v10)
        {
          v15 = @"YES";
        }

        [v13 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12828 description:{@"Attempted to delete a section or item containing the first responder, but after repeatedly telling the first responder to resign, the first responder remained inside a deleted section or item. This may be caused by a cycle where the first responder is moving back and forth between the same views.\nFirst responder that was asked to resign (returned %@ from -resignFirstResponder): %@ inside containing view: %@ at index path: %@\nCurrent first responder: %@ inside containing view: %@ at index path: %@", v15, v7, v8, v9, v12, self->_firstResponderView, self->_firstResponderIndexPath}];
      }

      ++v5;
    }

    while ([(UICollectionView *)self _isFirstResponderInDeletedSectionOrItem]);
  }

  if (self->_firstResponderView)
  {
    firstResponderViewType = self->_firstResponderViewType;
    if (firstResponderViewType == 2)
    {
      v22 = [(UICollectionViewUpdate *)self->_currentUpdate finalSectionIndexForInitialSectionIndex:[(NSIndexPath *)self->_firstResponderIndexPath section]];
      v23 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:v22];
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = v23;
    }

    else if (firstResponderViewType == 1)
    {
      v20 = v24[2](v24, self->_firstResponderIndexPath);
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = v20;
    }

    else
    {
      firstResponderIndexPath = self->_firstResponderIndexPath;
      self->_firstResponderIndexPath = 0;
    }
  }
}

- (BOOL)_isFocusedViewInDeletedSectionOrItem
{
  v3 = [(UICollectionView *)self _focusedItemState];
  v4 = v3;
  if (v3)
  {
    currentUpdate = self->_currentUpdate;
    if (currentUpdate)
    {
      v6 = *(v3 + 32);
      v7 = *(v3 + 16);
      v8 = v7;
      if (v6)
      {
        v9 = [v7 length];

        v10 = self->_currentUpdate;
        if (v9 == 1)
        {
          deletedSupplementaryTopLevelIndexesDict = v10->_deletedSupplementaryTopLevelIndexesDict;
          v12 = v4[3];
          v13 = [(NSMutableDictionary *)deletedSupplementaryTopLevelIndexesDict objectForKeyedSubscript:v12];

          v14 = v4[2];
          v15 = [v13 containsIndex:{objc_msgSend(v14, "indexAtPosition:", 0)}];

LABEL_10:
          goto LABEL_11;
        }

        v8 = v4[3];
        v16 = v4[2];
        v13 = [(UICollectionViewUpdate *)v10 validatedNewIndexPathForSupplementaryElementOfKind:v8 oldIndexPath:v16];
      }

      else
      {
        v13 = [(UICollectionViewUpdate *)currentUpdate finalIndexPathForInitialIndexPath:v7];
      }

      v15 = v13 == 0;
      goto LABEL_10;
    }
  }

  v15 = 0;
LABEL_11:

  return v15;
}

- (void)_resetOrRebaseFocusedItemForCurrentUpdateWithIndexPathMapping:(id)a3
{
  v36 = a3;
  if (!self->_currentUpdate)
  {
    v35 = [MEMORY[0x1E696AAA8] currentHandler];
    [v35 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:12871 description:{@"UICollectionView internal inconsistency: attempted to rebase the focused item state outside of an update. Collection view: %@", self}];
  }

  *(&self->_collectionViewFlags + 1) &= ~0x20000000000uLL;
  v5 = [(UICollectionView *)self _focusedItemState];
  v6 = v5;
  if (v5)
  {
    v7 = *(v5 + 16);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;

  if (v8)
  {
    v9 = [(UICollectionView *)self _focusedItemState];
    v10 = v9;
    if (v9)
    {
      v11 = *(v9 + 8);
      v12 = v10[2];
    }

    else
    {
      v11 = 0;
      v12 = 0;
    }

    v13 = v12;
    if (-[UICollectionView _isFocusedViewInDeletedSectionOrItem](self, "_isFocusedViewInDeletedSectionOrItem") || [v11 _isHiddenForReordering])
    {
      *(&self->_collectionViewFlags + 1) |= 0x20000000000uLL;
      [(UICollectionView *)self _setFocusedItemState:0];
    }

    if (v11)
    {
      v14 = [(UICollectionView *)self _focusedItemState];
      v15 = v14;
      v16 = v14 ? *(v14 + 8) : 0;
      v17 = v16;

      if (!v17)
      {
        [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v11];
      }
    }

    if ((*(&self->_collectionViewFlags + 13) & 2) == 0)
    {
      if (v10 && v10[4])
      {
        v18 = -[UICollectionViewUpdate finalSectionIndexForInitialSectionIndex:](self->_currentUpdate, "finalSectionIndexForInitialSectionIndex:", [v13 section]);
        v19 = [(UICollectionView *)self _focusedItemState];
        v20 = [MEMORY[0x1E696AC88] indexPathForRow:0x7FFFFFFFFFFFFFFFLL inSection:v18];
        v21 = [(_UICollectionViewFocusedItemState *)v19 copyWithIndexPath:v20 preservingReusableView:1];
        [(UICollectionView *)self _setFocusedItemState:v21];

        objc_storeStrong(&self->_currentUpdate->_oldFocusedItemState, v10);
        v22 = [(UICollectionView *)self _focusedItemState];
        currentUpdate = self->_currentUpdate;
        newFocusedItemState = currentUpdate->_newFocusedItemState;
        currentUpdate->_newFocusedItemState = v22;
      }

      else
      {
        newFocusedItemState = v36[2](v36, v13);
        v25 = [(UICollectionView *)self _focusedItemState];
        v26 = [(_UICollectionViewFocusedItemState *)v25 copyWithIndexPath:1 preservingReusableView:?];
        [(UICollectionView *)self _setFocusedItemState:v26];

        objc_storeStrong(&self->_currentUpdate->_oldFocusedItemState, v10);
        v27 = [(UICollectionView *)self _focusedItemState];
        v28 = self->_currentUpdate;
        v29 = v28->_newFocusedItemState;
        v28->_newFocusedItemState = v27;
      }
    }

    v30 = [(UICollectionView *)self _focusedItemState];
    v31 = v30;
    if (v30)
    {
      v32 = *(v30 + 16);
    }

    else
    {
      v32 = 0;
    }

    v33 = v32;
    v34 = [(UICollectionView *)self _indexPathIsValid:v33 allowSectionItemSentinel:1];

    if (!v34)
    {
      [(UICollectionView *)self _setFocusedItemState:0];
    }
  }
}

- (void)_startViewAnimationsWithContext:(id)a3 oldVisibleViews:(id)a4 viewAnimator:(id)a5 viewAnimationsCompletedDispatchGroup:(id)a6
{
  v51 = *MEMORY[0x1E69E9840];
  v10 = a3;
  v35 = a4;
  v37 = a5;
  v11 = a6;
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  if (v10)
  {
    v12 = v10[1];
  }

  else
  {
    v12 = 0;
  }

  obj = v12;
  v13 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v46;
    do
    {
      for (i = 0; i != v14; ++i)
      {
        if (*v46 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v45 + 1) + 8 * i);
        v18 = [v17 view];
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) == 0)
        {
          [v18 _addUpdateAnimation];
          [v35 removeObject:v18];
          if (([v17 deleteAfterAnimation] & 1) == 0)
          {
            v19 = [v17 finalLayoutAttributes];

            if (v19)
            {
              v20 = [v17 finalLayoutAttributes];
              [(UICollectionView *)self _setVisibleView:v18 forLayoutAttributes:v20];
            }
          }
        }

        [(UICollectionView *)self _incrementUpdateAnimationCountWithContext:v10];
        if (v11)
        {
          dispatch_group_enter(v11);
        }

        v42[0] = MEMORY[0x1E69E9820];
        v42[1] = 3221225472;
        v42[2] = __118__UICollectionView__startViewAnimationsWithContext_oldVisibleViews_viewAnimator_viewAnimationsCompletedDispatchGroup___block_invoke;
        v42[3] = &unk_1E70F4638;
        v42[4] = self;
        v43 = v10;
        v44 = v11;
        [v17 addCompletionHandler:v42];
        v21 = [v37 copy];
        [v17 startWithAnimator:v21];
      }

      v14 = [obj countByEnumeratingWithState:&v45 objects:v50 count:16];
    }

    while (v14);
  }

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  v22 = v35;
  v23 = [v22 countByEnumeratingWithState:&v38 objects:v49 count:16];
  if (v23)
  {
    v24 = v23;
    v25 = *v39;
    do
    {
      v26 = 0;
      do
      {
        if (*v39 != v25)
        {
          objc_enumerationMutation(v22);
        }

        v27 = *(*(&v38 + 1) + 8 * v26);
        v28 = [v27 _isInUpdateAnimation];
        v29 = [v27 _layoutAttributes];
        v30 = v29;
        if (v28)
        {

          if (!v30)
          {
            goto LABEL_31;
          }

          v31 = [v27 _layoutAttributes];
          [(UICollectionView *)self _setVisibleView:v27 forLayoutAttributes:v31];
          goto LABEL_29;
        }

        if (!v29 || (v32 = v29[72], v29, (v32 & 1) == 0))
        {
          [(UICollectionView *)self _reuseSupplementaryView:v27];
          goto LABEL_31;
        }

        if (dyld_program_sdk_at_least())
        {
          v31 = [v27 _layoutAttributes];
          v33 = [v31 indexPath];
          [(UICollectionView *)self _cacheOrReuseCell:v27 forIndexPath:v33 invalidatePreferredAttributes:1 notifyDidEndDisplaying:1];

LABEL_29:
          goto LABEL_31;
        }

        [(UICollectionView *)self _reuseCell:v27];
LABEL_31:
        ++v26;
      }

      while (v24 != v26);
      v34 = [v22 countByEnumeratingWithState:&v38 objects:v49 count:16];
      v24 = v34;
    }

    while (v34);
  }
}

void __118__UICollectionView__startViewAnimationsWithContext_oldVisibleViews_viewAnimator_viewAnimationsCompletedDispatchGroup___block_invoke(uint64_t a1, uint64_t a2)
{
  [*(a1 + 32) _updateAnimationDidStop:*(a1 + 40) finished:a2];
  v3 = *(a1 + 48);
  if (v3)
  {

    dispatch_group_leave(v3);
  }
}

- (BOOL)_reviseNewContentOffsetForUpdate:(id)a3
{
  v68 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v6 = *(v4 + 6);
  v5 = *(v4 + 7);
  v7 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
  v8 = [v7 scrollManager];
  v9 = [v8 isScrollingScrollableContainer:self];
  v10 = v5;
  v11 = v6;
  if (v9)
  {
    [v8 targetContentOffsetForScrollableContainer:self];
    v11 = v12;
    v10 = v13;
  }

  [(UICollectionViewLayout *)self->_layout targetContentOffsetForProposedContentOffset:v11, v10];
  [(UICollectionView *)self _delegateTargetOffsetForProposedContentOffset:?];
  v15 = v14;
  v17 = v16;
  v18 = vabdd_f64(v6, v14) >= 0.0001;
  v19 = vabdd_f64(v5, v16) >= 0.0001 || v18;
  if (dyld_program_sdk_at_least() && v19 && ![(UIScrollView *)self isScrollAnimating])
  {
    v20 = [(UICollectionViewData *)v4[3] collectionViewContentRect];
    v57 = v5;
    v21 = v6;
    v23 = v22;
    v25 = v24;
    v26 = [(UIScrollView *)self _isAutomaticContentOffsetAdjustmentEnabled];
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:1];
    v27 = v23;
    v6 = v21;
    v5 = v57;
    [(UIScrollView *)self _adjustedContentOffsetForContentOffset:0 contentSize:v15 skipsAdjustmentIfScrolling:v17, v27, v25];
    v15 = v28;
    v17 = v29;
    [(UIScrollView *)self _setAutomaticContentOffsetAdjustmentEnabled:v26];
  }

  if (!v9)
  {
    goto LABEL_16;
  }

  if (vabdd_f64(v11, v15) >= 0.0001 || vabdd_f64(v10, v17) >= 0.0001)
  {
    [v8 cancelScrollingForScrollableContainer:self];
LABEL_16:
    v31 = 1;
    goto LABEL_17;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925D8);
  if (*CategoryCachedImpl)
  {
    v51 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
    {
      *buf = 134217984;
      v61 = self;
      _os_log_impl(&dword_188A29000, v51, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; clearing restoration anchor", buf, 0xCu);
    }
  }

  [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
  v31 = 0;
  v15 = v6;
  v17 = v5;
LABEL_17:
  v32 = vabdd_f64(v15, v6);
  v33 = vabdd_f64(v17, v5);
  v34 = v33 >= 0.0001 || v32 >= 0.0001;
  if (v34)
  {
    v35 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925E0);
    if (*v35)
    {
      v46 = *(v35 + 8);
      if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
      {
        v47 = v46;
        [(UIScrollView *)self contentOffset];
        NSStringFromCGPoint(v69);
        v48 = v58 = v31;
        v70.x = v6;
        v70.y = v5;
        v49 = NSStringFromCGPoint(v70);
        v71.x = v15;
        v71.y = v17;
        v50 = NSStringFromCGPoint(v71);
        *buf = 134218754;
        v61 = self;
        v62 = 2112;
        v63 = v48;
        v64 = 2112;
        v65 = v49;
        v66 = 2112;
        v67 = v50;
        _os_log_impl(&dword_188A29000, v47, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; proposed origin modified by layout, delegate, or focus. Current: %@; original: %@; new: %@", buf, 0x2Au);

        v34 = 1;
        v31 = v58;
      }
    }
  }

  if ((v31 & dyld_program_sdk_at_least()) == 1 && ((v34 | [(UICollectionView *)self _isReordering]) & 1) == 0 && self->_contentOffsetRestorationAnchor)
  {
    v59 = 0;
    [(UIScrollView *)self _contentInsetIncludingDecorations];
    v38 = [(UICollectionView *)self _contentOffsetForRestoringPositionToCurrentRestorationAnchorWithContentInsets:v36 shouldApply:v37];
    if (v59 == 1)
    {
      v40 = v38;
      v41 = v39;
      v42 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925E8);
      if (*v42)
      {
        v52 = *(v42 + 8);
        if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
        {
          v53 = v52;
          v72.x = v6;
          v72.y = v5;
          v54 = NSStringFromCGPoint(v72);
          v73.x = v40;
          v73.y = v41;
          v55 = NSStringFromCGPoint(v73);
          *buf = 134218498;
          v61 = self;
          v62 = 2112;
          v63 = v54;
          v64 = 2112;
          v65 = v55;
          _os_log_impl(&dword_188A29000, v53, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; changing new visible origin from %@ to %@", buf, 0x20u);
        }
      }

      v17 = v41;
      v15 = v40;
    }

    else
    {
      v43 = __UILogGetCategoryCachedImpl("UICollectionView", &qword_1ED4925F0);
      if (*v43)
      {
        v56 = *(v43 + 8);
        if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
        {
          *buf = 134217984;
          v61 = self;
          _os_log_impl(&dword_188A29000, v56, OS_LOG_TYPE_ERROR, "_reviseNewContentOffsetForUpdate: cv == %p; clearing restoration anchor", buf, 0xCu);
        }
      }

      [(UICollectionView *)self _clearContentOffsetRestorationAnchor];
    }

    v32 = vabdd_f64(v15, v6);
    v33 = vabdd_f64(v17, v5);
  }

  v44 = v33 >= 0.0001 || v32 >= 0.0001;
  *(v4 + 6) = v15;
  *(v4 + 7) = v17;

  return v44;
}

- (void)_updateAnimationDidStop:(id)a3 finished:(BOOL)a4
{
  v4 = a4;
  v82 = *MEMORY[0x1E69E9840];
  v6 = a3;
  [(UICollectionView *)self _decrementUpdateAnimationCountWithContext:v6];
  if (v6)
  {
    if (v6[2])
    {
      goto LABEL_63;
    }

    v70 = v4;
    v79 = 0u;
    v80 = 0u;
    v77 = 0u;
    v78 = 0u;
    v71 = v6;
    v7 = v6[1];
  }

  else
  {
    v70 = v4;
    v71 = 0;
    v7 = 0;
    v79 = 0u;
    v80 = 0u;
    v77 = 0u;
    v78 = 0u;
  }

  obj = v7;
  v8 = [obj countByEnumeratingWithState:&v77 objects:v81 count:16];
  if (!v8)
  {
    goto LABEL_52;
  }

  v9 = v8;
  p_responderFlags = &self->super.super.super._responderFlags;
  v10 = *v78;
  do
  {
    v11 = 0;
    v75 = v9;
    do
    {
      if (*v78 != v10)
      {
        objc_enumerationMutation(obj);
      }

      v12 = *(*(&v77 + 1) + 8 * v11);
      v13 = [v12 view];
      objc_opt_class();
      if ((objc_opt_isKindOfClass() & 1) == 0)
      {
        [v13 _clearUpdateAnimation];
        if ([v12 resetRasterizationAfterAnimation])
        {
          v14 = [v12 rasterizeAfterAnimation];
          v15 = [v13 layer];
          [v15 setShouldRasterize:v14];
        }

        [(UICollectionView *)self _visibleBounds];
        v17 = v16;
        v19 = v18;
        v21 = v20;
        v23 = v22;
        v24 = self;
        layout = self->_layout;
        v26 = [v13 _layoutAttributes];
        [v13 frame];
        [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v26 frame:?];
        v28 = v27;
        v30 = v29;
        v32 = v31;
        v34 = v33;

        v35 = [v13 _layoutAttributes];
        v36 = v35;
        if (v35)
        {
          v37 = 1;
          if ((v35[36] & 2) != 0)
          {
            v37 = 2;
          }

          v38 = v35[36] & 1;
          if (v38)
          {
            v39 = 0;
          }

          else
          {
            v39 = v37;
          }

          v40 = *&p_responderFlags[680];
          v41 = (v40 >> 30) & 1;
          if ((v40 & 0x40000000) == 0 && v38)
          {
LABEL_20:
            v42 = [v35 indexPath];
            LOBYTE(v41) = ![(UICollectionView *)v24 _indexPathIsValid:v42];

            v39 = 0;
          }
        }

        else
        {
          if ((*(&p_responderFlags[680] + 3) & 0x40) == 0)
          {
            goto LABEL_20;
          }

          v39 = 0;
          LOBYTE(v41) = 1;
        }

        if (([v13 _isInUpdateAnimation] & 1) == 0 && (objc_msgSend(v12, "deleteAfterAnimation") & 1) == 0)
        {
          if ((v41 & 1) != 0 || (v83.origin.x = v28, v83.origin.y = v30, v83.size.width = v32, v83.size.height = v34, v84.origin.x = v17, v84.origin.y = v19, v84.size.width = v21, v84.size.height = v23, !CGRectIntersectsRect(v83, v84)))
          {
            v43 = [(_UILabelConfiguration *)v36 _content];
            subviewManager = v24->_subviewManager;
            v45 = [v36 indexPath];
            v73 = v43;
            v46 = [(_UICollectionViewSubviewManager *)subviewManager visibleViewOfKind:v43 inCategory:v39 atIndexPath:v45];

            v47 = 0;
            if (dyld_program_sdk_at_least() && !v39)
            {
              v48 = [v36 indexPath];
              v47 = [(UICollectionView *)v24 _isReorderingItemAtIndexPath:v48];
            }

            if (v46 == v13 && !v47)
            {
              v49 = v24->_subviewManager;
              v50 = [v36 indexPath];
              if (v49)
              {
                [(_UICollectionViewSubviewCollection *)&v49->_visibleViews->super.isa removeViewOfKind:v73 inCategory:v39 atIndexPath:v50];
              }
            }
          }
        }

        self = v24;
        v51 = v24->_subviewManager;
        if (v51 && [(_UICollectionViewSubviewCollection *)v51->_visibleViews containsView:v13])
        {
          if (dyld_program_sdk_at_least() && [v12 updateZIndexAfterAnimation])
          {
            v52 = [v13 _layoutAttributes];
            -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](v24, "_addControlledSubview:atZIndex:forced:initialAttributes:", v13, [v52 zIndex], 1, 0);
            goto LABEL_45;
          }
        }

        else if (([v13 _isInUpdateAnimation] & 1) == 0)
        {
          if ([v12 viewType] == 1)
          {
            [(UICollectionView *)v24 _reuseCell:v13];
          }

          else if ([v12 viewType] == 2)
          {
            [(UICollectionView *)v24 _reuseSupplementaryView:v13];
          }

          else
          {
            v52 = [MEMORY[0x1E696AAA8] currentHandler];
            [v52 handleFailureInMethod:a2 object:v24 file:@"UICollectionView.m" lineNumber:13099 description:{@"UICollectionView finished animating a view of unknown type: %@", v13}];
LABEL_45:
          }
        }

        v9 = v75;
      }

      ++v11;
    }

    while (v9 != v11);
    v53 = [obj countByEnumeratingWithState:&v77 objects:v81 count:16];
    v9 = v53;
  }

  while (v53);
LABEL_52:

  [(UICollectionViewLayout *)self->_layout collectionViewContentSize];
  [(UICollectionView *)self setContentSize:?];
  v6 = v71;
  if (v71)
  {
    v54 = v71[3];
    v55 = v54;
    if (v54)
    {
      (*(v54 + 2))(v54, v70);
    }
  }

  else
  {
    v55 = 0;
  }

  [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  v56 = [(UICollectionView *)self _focusedItemState];
  v57 = v56;
  if (v56 && (v58 = *(v56 + 8)) != 0)
  {
    v59 = v58;
    v60 = [(UIView *)self traitCollection];
    v61 = [v60 userInterfaceIdiom];

    if (v61 == 3)
    {
      v57 = [_UIFocusSystemSceneComponent sceneComponentForEnvironment:self];
      v62 = [v57 scrollManager];
      v63 = [(UIScrollView *)self _focusTuple];
      v64 = [(UICollectionView *)self _focusedItemState];
      v65 = v64;
      v66 = self;
      if (v64)
      {
        v67 = *(v64 + 8);
      }

      else
      {
        v67 = 0;
      }

      v68 = v67;
      [v62 animateOffsetOfScrollableContainersInParentEnvironmentContainer:v63 toShowFocusItem:v68];

      self = v66;
      goto LABEL_61;
    }
  }

  else
  {
LABEL_61:
  }

LABEL_63:
  v69 = [(UIView *)self _focusSystem];

  if (v69)
  {
    [(UICollectionView *)self _highlightFirstVisibleItemIfAppropriate];
  }
}

- (void)_endUpdatesWithInvalidationContext:(id)a3 tentativelyForReordering:(BOOL)a4 animator:(id)a5 collectionViewAnimator:(id)a6
{
  v8 = a4;
  v17 = a3;
  v10 = a5;
  v11 = a6;
  v12 = self->_updateCount - 1;
  self->_updateCount = v12;
  if (v12)
  {
    if (v10)
    {
      skippedBatchUpdatePropertyAnimators = self->_skippedBatchUpdatePropertyAnimators;
      if (skippedBatchUpdatePropertyAnimators)
      {
        [(NSMutableArray *)skippedBatchUpdatePropertyAnimators addObject:v10];
      }

      else
      {
        v15 = [MEMORY[0x1E695DF70] arrayWithObject:v10];
        v16 = self->_skippedBatchUpdatePropertyAnimators;
        self->_skippedBatchUpdatePropertyAnimators = v15;
      }
    }
  }

  else
  {
    [(UICollectionView *)self _endItemAnimationsWithInvalidationContext:v17 tentativelyForReordering:v8 animator:v10 collectionViewAnimator:v11];
    v14 = self->_skippedBatchUpdatePropertyAnimators;
    self->_skippedBatchUpdatePropertyAnimators = 0;
  }
}

- (void)_performBatchUpdates:(id)a3 completion:(id)a4 invalidationContext:(id)a5 tentativelyForReordering:(BOOL)a6 animator:(id)a7 animationHandler:(id)a8
{
  v26 = a6;
  v13 = a3;
  v14 = a4;
  v27 = a7;
  updateCompletionHandler = self->_updateCompletionHandler;
  v16 = a8;
  v17 = a5;
  v18 = _Block_copy(updateCompletionHandler);
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __123__UICollectionView__performBatchUpdates_completion_invalidationContext_tentativelyForReordering_animator_animationHandler___block_invoke;
  aBlock[3] = &unk_1E70FE248;
  v19 = v18;
  v29 = v19;
  v20 = v14;
  v30 = v20;
  v21 = _Block_copy(aBlock);
  v22 = self->_updateCompletionHandler;
  self->_updateCompletionHandler = v21;

  if (((*(&self->_collectionViewFlags + 8) & 0x10) == 0 || (dyld_program_sdk_at_least() & 1) == 0) && ![(UICollectionView *)self _shouldSkipForcedLayoutBeforeBatchUpdates])
  {
    [(UIView *)self layoutBelowIfNeeded];
  }

  [(UICollectionView *)self _beginUpdates];
  if (v13)
  {
    v23 = self->_reconfigureAnimator;
    objc_storeStrong(&self->_reconfigureAnimator, a7);
    v13[2](v13);
    reconfigureAnimator = self->_reconfigureAnimator;
    self->_reconfigureAnimator = v23;
  }

  v25 = [[_UICollectionViewAnimator alloc] initWithHandler:v16];

  [(UICollectionView *)self _endUpdatesWithInvalidationContext:v17 tentativelyForReordering:v26 animator:v27 collectionViewAnimator:v25];
}

uint64_t __123__UICollectionView__performBatchUpdates_completion_invalidationContext_tentativelyForReordering_animator_animationHandler___block_invoke(uint64_t a1, uint64_t a2)
{
  v3 = *(a1 + 32);
  if (v3)
  {
    (*(v3 + 16))(v3, a2);
  }

  result = *(a1 + 40);
  if (result)
  {
    v5 = *(result + 16);

    return v5();
  }

  return result;
}

- (void)setBackgroundView:(UIView *)backgroundView
{
  v5 = backgroundView;
  v6 = self->_backgroundView;
  if (v6 != v5)
  {
    v14 = v5;
    [(UIView *)v6 removeFromSuperview];
    objc_storeStrong(&self->_backgroundView, backgroundView);
    [(UIView *)self bounds];
    [(UIView *)self->_backgroundView setFrame:?];
    v7 = self->_backgroundView;
    v8 = self->_layout;
    v9 = v7;
    v10 = v9;
    if (v8)
    {
      v11 = v9 == 0;
    }

    else
    {
      v11 = 1;
    }

    if (v11)
    {
      goto LABEL_11;
    }

    v12 = [(UIView *)v9 effectiveUserInterfaceLayoutDirection];
    if (v12 == [(UICollectionViewLayout *)v8 developmentLayoutDirection])
    {
      if (![(UIView *)v10 _flipsHorizontalAxis])
      {
LABEL_11:

        [(UIScrollView *)self _addContentSubview:self->_backgroundView atBack:1];
        v5 = v14;
        goto LABEL_12;
      }

      v13 = 0;
    }

    else
    {
      v13 = [(UICollectionViewLayout *)v8 _wantsRightToLeftHorizontalMirroringIfNeeded];
    }

    [(UIView *)v10 _setFlipsHorizontalAxis:v13];
    goto LABEL_11;
  }

LABEL_12:
}

- (void)setBackgroundColor:(id)a3
{
  *(&self->_collectionViewFlags + 1) |= 0x8000000000uLL;
  v3.receiver = self;
  v3.super_class = UICollectionView;
  [(UIScrollView *)&v3 setBackgroundColor:a3];
}

- (void)_invalidateWithBlock:(id)a3
{
  v4 = a3;
  v5 = v4;
  if (v4)
  {
    if ((*(&self->_collectionViewFlags + 12) & 0x40) != 0)
    {
      v6 = _Block_copy(self->_invalidationBlock);
      v10[0] = MEMORY[0x1E69E9820];
      v10[1] = 3221225472;
      v10[2] = __41__UICollectionView__invalidateWithBlock___block_invoke;
      v10[3] = &unk_1E70F77D0;
      v11 = v6;
      v12 = v5;
      v7 = v6;
      v8 = _Block_copy(v10);
      invalidationBlock = self->_invalidationBlock;
      self->_invalidationBlock = v8;
    }

    else
    {
      (*(v4 + 2))(v4);
    }
  }
}

uint64_t __41__UICollectionView__invalidateWithBlock___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  if (v2)
  {
    (*(v2 + 16))();
  }

  v3 = *(*(a1 + 40) + 16);

  return v3();
}

- (void)_invalidateLayoutWithContext:(id)a3
{
  v81 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [v4 _intent];
  if (v5 > 0xF || ((1 << v5) & 0x9762) == 0)
  {
    [(UICollectionView *)self _resetPrefetchState];
  }

  v7 = v4;
  if (self && -[UICollectionViewLayout _estimatesSizes](self->_layout, "_estimatesSizes") && (v8 = [v7 _intent], v8 <= 0xD) && ((1 << v8) & 0x2005) != 0)
  {

    [(UICollectionView *)self _saveContentOffsetRestorationAnchorIfNecessaryUsingModel:?];
  }

  else
  {
  }

  v9 = self->_collectionViewData;
  currentUpdate = self->_currentUpdate;
  if (currentUpdate && (*&currentUpdate->_flags & 1) == 0)
  {
    v11 = currentUpdate->_oldModel;

    v9 = v11;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_invalidateLayoutWithContext____s_category);
  if (*CategoryCachedImpl)
  {
    v53 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
    {
      v54 = v53;
      v55 = _UICollectionViewLayoutInvalidationContextIntentDescription([v7 _intent]);
      *buf = 134218242;
      v78 = self;
      v79 = 2112;
      v80 = v55;
      _os_log_impl(&dword_188A29000, v54, OS_LOG_TYPE_ERROR, "_invalidateLayoutWithContext: cv == %p; intent: %@", buf, 0x16u);
    }
  }

  if (v7)
  {
    v60 = (v7[112] >> 3) & 1;
  }

  else
  {
    LOBYTE(v60) = 0;
  }

  v13 = [v7 _intent];
  v14 = self->_debugger;
  if (v14 && v13 != 15)
  {
    [(_UICollectionViewFeedbackLoopDebugger *)self->_debugger recordInvalidationWithContext:v7];
  }

  v61 = v13;
  if (self->_isInInteractiveTransition)
  {
    layout = self->_layout;
    self->_previousInteractiveTransitionProgress = self->_currentInteractiveTransitionProgress;
    v16 = layout;
    [(UICollectionViewLayout *)v16 transitionProgress];
    self->_currentInteractiveTransitionProgress = v17;
    self->_previousInteractiveTransitionTimeStamp = self->_currentInteractiveTransitionTimeStamp;
    v18 = [MEMORY[0x1E695DF00] date];
    [v18 timeIntervalSince1970];
    self->_currentInteractiveTransitionTimeStamp = v19;

    v75[0] = MEMORY[0x1E69E9820];
    v75[1] = 3221225472;
    v75[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke;
    v75[3] = &unk_1E70F3590;
    v76 = v9;
    [(UICollectionView *)self _invalidateWithBlock:v75];
    [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    v20 = v76;
  }

  else
  {
    v59 = v14;
    if (+[UIView _isInAnimationBlockWithAnimationsEnabled]&& [(UICollectionView *)self _shouldFadeCellsForBoundChangeWhileRotating])
    {
      *(&self->_collectionViewFlags + 1) |= 0x10000000uLL;
    }

    shouldInvalidatePreferred = [(UICollectionViewLayoutInvalidationContext *)v7 _shouldInvalidatePreferredAttributes];
    v22 = [(UICollectionViewLayoutInvalidationContext *)v7 _requiresFullCacheInvalidation];
    v16 = [v7 invalidatedItemIndexPaths];
    v20 = [v7 invalidatedSupplementaryIndexPaths];
    v23 = [v7 invalidatedDecorationIndexPaths];
    v24 = [(UICollectionViewLayout *)v16 count];
    v58 = [v20 count];
    v57 = [v23 count];
    v56 = !v22;
    if (v22 && shouldInvalidatePreferred)
    {
      subviewManager = self->_subviewManager;
      if (subviewManager)
      {
        [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateAllViewsWithEnumerator:?];
      }

      [(NSMutableDictionary *)self->_prefetchCacheItems enumerateKeysAndObjectsUsingBlock:&__block_literal_global_971];
    }

    if (v22)
    {
      v72[0] = MEMORY[0x1E69E9820];
      v72[1] = 3221225472;
      v72[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_4;
      v72[3] = &unk_1E70F35B8;
      v26 = &v73;
      v73 = v9;
      v27 = &v74;
      v74 = v7;
      [(UICollectionView *)self _invalidateWithBlock:v72];
    }

    else
    {
      v67[0] = MEMORY[0x1E69E9820];
      v67[1] = 3221225472;
      v67[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_5;
      v67[3] = &unk_1E70F6B40;
      v26 = &v68;
      v68 = v9;
      v27 = &v69;
      v69 = v16;
      v70 = v20;
      v71 = v23;
      [(UICollectionView *)self _invalidateWithBlock:v67];
    }

    if (v24 || v58 || v57)
    {
      aBlock[0] = MEMORY[0x1E69E9820];
      aBlock[1] = 3221225472;
      aBlock[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_6;
      aBlock[3] = &unk_1E70F6B40;
      v63 = v16;
      v64 = self;
      v65 = v20;
      v66 = v23;
      v28 = _Block_copy(aBlock);
      if (dyld_program_sdk_at_least())
      {
        [(UICollectionView *)self _invalidateWithBlock:v28];
      }

      else
      {
        v28[2](v28);
      }
    }

    if (v61 != 15)
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:v56];
      *(&self->_collectionViewFlags + 1) |= 0x200000000uLL;
    }

    v14 = v59;
  }

  if (v7)
  {
    v29 = *(v7 + 16);
  }

  else
  {
    v29 = 0;
  }

  v30 = v29;
  if ([v30 count])
  {
    [(UICollectionView *)self _addIndexPathsRequiringPreferredAttributes:v30];
  }

  [v7 contentOffsetAdjustment];
  v33 = v32;
  v34 = v31;
  if (v32 != *MEMORY[0x1E695EFF8] || v31 != *(MEMORY[0x1E695EFF8] + 8))
  {
    [(UIScrollView *)self contentOffset];
    v37 = *(&self->_collectionViewFlags + 4);
    *(&self->_collectionViewFlags + 4) = v37 | 0x80000;
    [(UICollectionView *)self setContentOffset:v33 + v35, v34 + v36];
    *(&self->_collectionViewFlags + 4) = *(&self->_collectionViewFlags + 4) & 0xFFF7FFFF | (((v37 >> 19) & 1) << 19);
  }

  [v7 contentSizeAdjustment];
  if (v38 != *MEMORY[0x1E695F060] || v39 != *(MEMORY[0x1E695F060] + 8))
  {
    if (v9)
    {
      width = v9->_contentSize.width;
      height = v9->_contentSize.height;
    }

    else
    {
      height = 0.0;
      width = 0.0;
    }

    v42 = v38 + width;
    v43 = v39 + height;
    [(UICollectionView *)self setContentSize:v38 + width, v39 + height];
    collectionViewData = self->_collectionViewData;
    if (collectionViewData)
    {
      collectionViewData->_contentSize.width = v42;
      collectionViewData->_contentSize.height = v43;
    }
  }

  if ([v7 _shouldInvalidateCollectionViewContentSize])
  {
    [(UICollectionViewLayout *)self->_layout collectionViewContentSize];
    v46 = v45;
    v48 = v47;
    [(UICollectionView *)self _setContentSizeFromLayout:self->_updateVisibleCellsRecursionCount > 0 isRecursivelyUpdatingVisibleCells:?];
    v49 = self->_collectionViewData;
    if (v49)
    {
      v49->_contentSize.width = v46;
      v49->_contentSize.height = v48;
    }
  }

  if (([v7 invalidateEverything] & 1) != 0 || objc_msgSend(v7, "_intent") == 3)
  {
    v50 = [(UICollectionView *)self _identityTracker:0];
    [(_UIIndexPathIdentityTracker *)v50 reset];

    v51 = [(UICollectionView *)self contextMenuInteraction];
    [v51 _retargetDismissingMenuWithInternalIdentifier:0 toPreview:0 force:1];
  }

  v52 = [(UICollectionView *)self _dataSourceActual];

  if (v52)
  {
    if (v61 != 6 && v61 != 15)
    {
      [(UICollectionView *)self _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
    }

    if ((v60 & 1) == 0)
    {
      [(UICollectionView *)self _reconfigureSectionContainersForUpdate:self->_currentUpdate];
      [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
      if ([v7 _intent] != 6)
      {
        [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController reconfigureScrollViewsForUpdate:?];
      }

      [(UIScrollView *)self _notifyAlignedContentMarginChanged];
    }
  }
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    *(a3 + 8) |= 3u;
  }
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_4(uint64_t a1)
{
  v1 = *(a1 + 32);
  v2 = [*(a1 + 40) invalidateEverything] ^ 1;

  [(UICollectionViewData *)v1 invalidate:v2];
}

uint64_t __49__UICollectionView__invalidateLayoutWithContext___block_invoke_5(uint64_t a1)
{
  [(UICollectionViewData *)*(a1 + 32) invalidateItemsAtIndexPaths:?];
  [(UICollectionViewData *)*(a1 + 32) invalidateSupplementaryIndexPaths:?];
  v2 = *(a1 + 32);
  v3 = *(a1 + 56);

  return [(UICollectionViewData *)v2 invalidateDecorationIndexPaths:v3];
}

uint64_t __49__UICollectionView__invalidateLayoutWithContext___block_invoke_6(uint64_t a1)
{
  if ([*(a1 + 32) count])
  {
    v2 = *(*(a1 + 40) + 2656);
    if (!v2)
    {
      v3 = objc_alloc_init(MEMORY[0x1E695DFA8]);
      v4 = *(a1 + 40);
      v5 = *(v4 + 2656);
      *(v4 + 2656) = v3;

      v2 = *(*(a1 + 40) + 2656);
    }

    [v2 addObjectsFromArray:*(a1 + 32)];
  }

  if ([*(a1 + 48) count])
  {
    v6 = *(a1 + 40);
    if (!*(v6 + 2664))
    {
      v7 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v8 = *(a1 + 40);
      v9 = *(v8 + 2664);
      *(v8 + 2664) = v7;

      v6 = *(a1 + 40);
    }

    v10 = *(a1 + 48);
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_7;
    v18[3] = &unk_1E70FA680;
    v18[4] = v6;
    [v10 enumerateKeysAndObjectsUsingBlock:v18];
  }

  result = [*(a1 + 56) count];
  if (result)
  {
    v12 = *(a1 + 40);
    if (!*(v12 + 2672))
    {
      v13 = objc_alloc_init(MEMORY[0x1E695DF90]);
      v14 = *(a1 + 40);
      v15 = *(v14 + 2672);
      *(v14 + 2672) = v13;

      v12 = *(a1 + 40);
    }

    v16 = *(a1 + 56);
    v17[0] = MEMORY[0x1E69E9820];
    v17[1] = 3221225472;
    v17[2] = __49__UICollectionView__invalidateLayoutWithContext___block_invoke_8;
    v17[3] = &unk_1E70FA680;
    v17[4] = v12;
    return [v16 enumerateKeysAndObjectsUsingBlock:v17];
  }

  return result;
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_7(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(*(a1 + 32) + 2664) objectForKeyedSubscript:a2];
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    [*(*(a1 + 32) + 2664) setObject:v7 forKeyedSubscript:a2];
    v6 = v7;
  }

  v8 = v6;
  [v6 addObjectsFromArray:a3];
}

void __49__UICollectionView__invalidateLayoutWithContext___block_invoke_8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(*(a1 + 32) + 2672) objectForKeyedSubscript:a2];
  if (!v6)
  {
    v7 = objc_alloc_init(MEMORY[0x1E695DFA8]);
    [*(*(a1 + 32) + 2672) setObject:v7 forKeyedSubscript:a2];
    v6 = v7;
  }

  v8 = v6;
  [v6 addObjectsFromArray:a3];
}

- (void)setSelfSizingInvalidation:(UICollectionViewSelfSizingInvalidation)selfSizingInvalidation
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 & 0xFFFFFF9F | (32 * (selfSizingInvalidation & 3));
  if (((v4 >> 5) & 3) != selfSizingInvalidation)
  {
    if ((selfSizingInvalidation & 3) != 0)
    {
      v6 = 32 * (selfSizingInvalidation & 3);
    }

    else
    {
      [(UICollectionView *)self _clearNeedsRecomputePreferredAttributesForInvalidatedElements];
      v6 = *(p_collectionViewFlags + 4) & 0x60;
    }

    v7[0] = MEMORY[0x1E69E9820];
    v7[1] = 3221225472;
    v7[2] = __46__UICollectionView_setSelfSizingInvalidation___block_invoke;
    v7[3] = &__block_descriptor_33_e34_v16__0__UICollectionReusableView_8l;
    v8 = v6 == 64;
    [(UICollectionView *)self _applyBlockToAllReusableViews:v7];
  }
}

- (void)_reusableViewDidInvalidateIntrinsicContentSize:(id)a3
{
  v17[1] = *MEMORY[0x1E69E9840];
  v4 = a3;
  if (self)
  {
    if (_UISupportsIntrinsicContentSizeInvalidation())
    {
      v5 = *(&self->_collectionViewFlags + 4);
      if ((v5 & 0x60) != 0 && _UIMaximumIntrinsicContentSizeInvalidationUpdatesPerCommit() > ((v5 >> 9) & 3) && (*(&self->_collectionViewFlags + 11) & 0x40) == 0 && (*(&self->_collectionViewFlags + 16) & 4) == 0 && !self->_cellBeingReconfigured)
      {
        v6 = [v4 _layoutAttributes];
        v7 = v6;
        if (!v6)
        {
          [v4 _isHiddenForReuse];
          goto LABEL_23;
        }

        if (v6[288])
        {
          v8 = [v6 indexPath];
          if (!v8)
          {
LABEL_22:

LABEL_23:
            goto LABEL_24;
          }

          v13 = [(NSMutableDictionary *)self->_prefetchCacheItems objectForKeyedSubscript:v8];
          if (v13)
          {
            v10 = v13;
            *(v13 + 8) |= 3u;
          }

          else
          {
            if (([v4 _isHiddenForReuse] & 1) == 0)
            {
              [(UICollectionView *)self _setNeedsRecomputePreferredAttributesForInvalidatedElements];
              intrinsicContentSizeInvalidationContext = self->_intrinsicContentSizeInvalidationContext;
              v17[0] = v8;
              v15 = [MEMORY[0x1E695DEC8] arrayWithObjects:v17 count:1];
              [(UICollectionViewLayoutInvalidationContext *)intrinsicContentSizeInvalidationContext invalidateItemsAtIndexPaths:v15];
            }

            v10 = 0;
          }
        }

        else
        {
          if (([v4 _isHiddenForReuse] & 1) != 0 || (v7[288] & 3) != 0)
          {
            goto LABEL_23;
          }

          v8 = [v7 indexPath];
          v9 = [(_UILabelConfiguration *)v7 _content];
          v10 = v9;
          if (v8 && v9)
          {
            [(UICollectionView *)self _setNeedsRecomputePreferredAttributesForInvalidatedElements];
            v11 = self->_intrinsicContentSizeInvalidationContext;
            v16 = v8;
            v12 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v16 count:1];
            [(UICollectionViewLayoutInvalidationContext *)v11 invalidateSupplementaryElementsOfKind:v10 atIndexPaths:v12];
          }
        }

        goto LABEL_22;
      }
    }
  }

LABEL_24:
}

void __79__UICollectionView__recomputePreferredAttributesForInvalidatedElementsIfNeeded__block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v19 = *MEMORY[0x1E69E9840];
  v5 = a2;
  v6 = a3;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  v7 = [v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v15;
    do
    {
      for (i = 0; i != v8; ++i)
      {
        if (*v15 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = *(*(&v14 + 1) + 8 * i);
        if ([*(a1 + 32) _isSectionValidInIndexPath:v11])
        {
          v12 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleSupplementaryOfKind:v5 atIndexPath:v11];
          v13 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForSupplementaryElementOfKind:v5 atIndexPath:v11];
          [*(a1 + 32) _recomputePreferredAttributesForInvalidatedView:v12 originalAttributes:v13];
        }
      }

      v8 = [v6 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v8);
  }
}

- (id)_setupAnimationsForResizedViewsWithOldModel:(id)a3
{
  collectionViewData = self->_collectionViewData;
  v5 = a3;
  [(UICollectionView *)self _visibleBounds];
  [(UICollectionViewData *)collectionViewData validateLayoutInRect:v6, v7, v8, v9];
  v10 = [UICollectionViewUpdate alloc];
  v11 = self->_collectionViewData;
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v15 = v14;
  [(UIScrollView *)self contentOffset];
  v18 = [(UICollectionViewUpdate *)&v10->super.isa initWithCollectionView:MEMORY[0x1E695E0F0] updateItems:0 moveItemSourceIndexPaths:0 moveItemDestinationIndexPaths:v5 oldModel:v11 newModel:v13 oldContentOffset:v15 newContentOffset:v16, v17];

  currentUpdate = self->_currentUpdate;
  self->_currentUpdate = v18;

  v20 = self->_currentUpdate;
  if (v20)
  {
    *&v20->_flags |= 2u;
    v21 = self->_currentUpdate;
  }

  else
  {
    v21 = 0;
  }

  v22 = MEMORY[0x1E695E0F0];
  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:MEMORY[0x1E695E0F0] withDataSourceTranslator:v21];
  [(UICollectionViewLayout *)self->_layout _prepareForCollectionViewUpdates:v22 animated:1];
  v23 = self->_currentUpdate;
  if (v23)
  {
    *&v23->_flags |= 1u;
  }

  v24 = [[UIViewAnimationContext alloc] initWithCompletionHandler:?];
  v30 = MEMORY[0x1E69E9820];
  v31 = 3221225472;
  v32 = __64__UICollectionView__setupAnimationsForResizedViewsWithOldModel___block_invoke;
  v33 = &unk_1E70F35B8;
  v25 = v24;
  v34 = v25;
  v35 = self;
  [UIView performWithoutAnimation:&v30];
  [(UICollectionView *)self _incrementUpdateAnimationCountWithContext:v25, v30, v31, v32, v33];
  v26 = [(_UICollectionViewSubviewManager *)self->_subviewManager allVisibleViewsHashTable];
  [(_UICollectionViewSubviewManager *)self->_subviewManager removeAllVisibleViews];
  [(UICollectionView *)self _startViewAnimationsWithContext:v25 oldVisibleViews:v26 viewAnimator:0 viewAnimationsCompletedDispatchGroup:0];
  [(UICollectionViewData *)self->_collectionViewData finalizeCollectionViewUpdates];
  [(UICollectionViewLayout *)self->_layout _finalizeCollectionViewUpdate:self->_currentUpdate];
  v27 = self->_currentUpdate;
  self->_currentUpdate = 0;

  v28 = v25;
  return v25;
}

void __64__UICollectionView__setupAnimationsForResizedViewsWithOldModel___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 40) _viewAnimationsForCurrentUpdateWithCollectionViewAnimator:0 updatingContentOffsetForRestorationAnchor:0];
  [(UIViewAnimationContext *)*(a1 + 32) setViewAnimations:v2];
}

- (BOOL)_recomputePreferredAttributesForInvalidatedView:(id)a3 originalAttributes:(id)a4
{
  if (!a3)
  {
    return 0;
  }

  v7 = [a3 _isHiddenForReuse];
  if (!a4 || (v7 & 1) != 0)
  {
    return 0;
  }

  [a3 _invalidatePreferredAttributes];

  return [(UICollectionView *)self _checkForPreferredAttributesInView:a3 originalAttributes:a4];
}

- (void)_accessibilitySetInterfaceStyleIntent:(unint64_t)a3
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIView *)&v5 _accessibilitySetInterfaceStyleIntent:a3];
  v4 = [(UICollectionView *)self collectionViewLayout];
  [v4 invalidateLayout];
}

- (void)_unhighlightAllItems
{
  v14 = *MEMORY[0x1E69E9840];
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_highlightedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  v11 = 0u;
  v12 = 0u;
  v9 = 0u;
  v10 = 0u;
  v5 = [v4 countByEnumeratingWithState:&v9 objects:v13 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v10;
    do
    {
      v8 = 0;
      do
      {
        if (*v10 != v7)
        {
          objc_enumerationMutation(v4);
        }

        [(UICollectionView *)self _unhighlightItemAtIndexPath:*(*(&v9 + 1) + 8 * v8++) animated:0 notifyDelegate:1];
      }

      while (v6 != v8);
      v6 = [v4 countByEnumeratingWithState:&v9 objects:v13 count:16];
    }

    while (v6);
  }
}

- (id)_selectableIndexPathForItemContainingHitView:(id)a3
{
  v4 = a3;
  if (!v4)
  {
    goto LABEL_9;
  }

  do
  {
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      break;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      break;
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass() & 1) != 0 && ([v4 isTracking])
    {
      goto LABEL_9;
    }

    v5 = [v4 superview];

    v4 = v5;
  }

  while (v5);
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v6 = [(UICollectionView *)self _indexPathForCell:v4];
  }

  else
  {
LABEL_9:
    v6 = 0;
  }

  return v6;
}

- (void)touchesBegan:(id)a3 withEvent:(id)a4
{
  v43 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  v8 = [(UICollectionView *)self _currentTouch];
  if (v8)
  {
    v9 = v8;
    if ([v8 phase] != 4 && objc_msgSend(v9, "phase") != 3)
    {
      goto LABEL_9;
    }

    [(UICollectionView *)self _cancelTouches];
  }

  if (_UITouchesContainsTouchFromExternalTouchpad(v6))
  {
LABEL_8:
    v9 = 0;
LABEL_9:
    v41 = self;
    v12 = &v41;
    goto LABEL_25;
  }

  v10 = v7;
  if ([v10 _buttonMask])
  {
    v11 = [v10 _buttonMask];

    if ((v11 & 1) == 0)
    {
      goto LABEL_8;
    }
  }

  else
  {
  }

  v9 = [v6 anyObject];
  [(UICollectionView *)self _setCurrentTouch:v9];
  if (v9)
  {
    v13 = 2256;
    if (!self->_pendingSelectionIndexPath)
    {
      v14 = [v9 view];
      v15 = [(UICollectionView *)self _selectableIndexPathForItemContainingHitView:v14];
      if (v15)
      {
        if ([(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:v15])
        {
          objc_storeStrong(&self->_pendingSelectionIndexPath, v15);
          v16 = [(UIView *)self traitCollection];
          v17 = _UIShouldAnimateDefaultCellHighlightAndSelection(v16);

          if ([(UIScrollView *)self isDragging]|| ![(UICollectionView *)self _highlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v17 scrollPosition:0 notifyDelegate:1 playFeedback:1])
          {
            pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
            self->_pendingSelectionIndexPath = 0;
          }

          else if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
          {
            pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
            if (pendingDeselectionIndexPaths)
            {
              [(NSMutableSet *)pendingDeselectionIndexPaths removeAllObjects];
            }

            else
            {
              v20 = objc_alloc_init(MEMORY[0x1E695DFA8]);
              v21 = self->_pendingDeselectionIndexPaths;
              self->_pendingDeselectionIndexPaths = v20;
            }

            if (![(UICollectionView *)self _allowsEffectiveMultipleSelection])
            {
              v39 = 0u;
              v40 = 0u;
              v37 = 0u;
              v38 = 0u;
              selectionController = self->_selectionController;
              v33 = v15;
              v34 = v14;
              v35 = v17;
              v32 = v7;
              if (selectionController)
              {
                v23 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
              }

              else
              {
                v23 = 0;
              }

              v24 = [v23 countByEnumeratingWithState:&v37 objects:v42 count:16];
              if (v24)
              {
                v25 = v24;
                v26 = *v38;
                do
                {
                  for (i = 0; i != v25; ++i)
                  {
                    if (*v38 != v26)
                    {
                      objc_enumerationMutation(v23);
                    }

                    v28 = *(*(&v37 + 1) + 8 * i);
                    if (([v28 isEqual:*(&self->super.super.super.super.isa + v13)] & 1) == 0)
                    {
                      [(UICollectionView *)self _cellForItemAtIndexPath:v28];
                      v29 = v13;
                      v31 = v30 = v23;
                      [v31 _setSelected:0 animated:v35];

                      v23 = v30;
                      v13 = v29;
                      [(NSMutableSet *)self->_pendingDeselectionIndexPaths addObject:v28];
                    }
                  }

                  v25 = [v23 countByEnumeratingWithState:&v37 objects:v42 count:16];
                }

                while (v25);
              }

              v15 = v33;
              v14 = v34;
              v7 = v32;
            }
          }
        }
      }

      else if (![(UICollectionView *)self _allowsEffectiveMultipleSelection])
      {
        [(UICollectionView *)self _unhighlightAllItems];
      }
    }
  }

  v36.receiver = self;
  v12 = &v36;
LABEL_25:
  v12->super_class = UICollectionView;
  [(objc_super *)v12 touchesBegan:v6 withEvent:v7];
}

- (void)touchesMoved:(id)a3 withEvent:(id)a4
{
  v5 = a3;
  v23 = [(UICollectionView *)self _currentTouch];
  v6 = [v5 containsObject:?];

  if (v6)
  {
    v7 = [(UIView *)self traitCollection];
    v8 = _UIShouldAnimateDefaultCellHighlightAndSelection(v7);

    if (self->_pendingSelectionIndexPath)
    {
      v9 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
      v10 = v9;
      if (v9)
      {
        [v9 bounds];
        v12 = v11;
        v14 = v13;
        v16 = v15;
        v18 = v17;
        [v23 locationInView:v10];
        v25.x = v19;
        v25.y = v20;
        v26.origin.x = v12;
        v26.origin.y = v14;
        v26.size.width = v16;
        v26.size.height = v18;
        v21 = CGRectContainsPoint(v26, v25);
        v22 = [v10 isHighlighted];
        if (v21)
        {
          if ((v22 & 1) == 0)
          {
            [(UICollectionView *)self _highlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v8 scrollPosition:0 notifyDelegate:1 playFeedback:1];
          }
        }

        else if (v22)
        {
          [(UICollectionView *)self _unhighlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v8 notifyDelegate:1];
        }
      }
    }

    else
    {
      v10 = 0;
    }
  }
}

- (void)_userSelectItemAtIndexPath:(id)a3
{
  v5 = [(UIView *)self traitCollection];
  v6 = _UIShouldAnimateDefaultCellHighlightAndSelection(v5);

  if (v6)
  {
    v7 = [(UICollectionView *)self _cellForItemAtIndexPath:a3];
    v8 = v7;
    if (v7)
    {
      v9[0] = MEMORY[0x1E69E9820];
      v9[1] = 3221225472;
      v9[2] = __47__UICollectionView__userSelectItemAtIndexPath___block_invoke;
      v9[3] = &unk_1E70FF8B8;
      v9[4] = self;
      v9[5] = a3;
      [v7 _performConfigurationStateModifications:v9];
    }

    else
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:a3 animatedSelection:0];
    }
  }

  else
  {

    [(UICollectionView *)self _userSelectItemAtIndexPath:a3 animatedSelection:0];
  }
}

- (void)_userSelectItemAtIndexPath:(id)a3 animatedSelection:(BOOL)a4
{
  v4 = a4;
  v12 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
  v7 = [v12 isSelected];
  if (v12 && [v12 _hasCustomSelectionAction])
  {
    v8 = 1;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:a3 animated:0 notifyDelegate:1];
  }

  else
  {
    v9 = [(UICollectionView *)self _canPerformPrimaryActionForItemAtIndexPath:a3];
    v10 = 1;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:a3 animated:v9 notifyDelegate:1];
    v8 = 0;
    if (v9)
    {
      goto LABEL_8;
    }
  }

  if (([(UICollectionView *)self _allowsEffectiveMultipleSelection]& v7) == 1)
  {
    [(UICollectionView *)self _deselectItemAtIndexPath:a3 animated:v4 notifyDelegate:1 isUserInitiated:1];
    goto LABEL_9;
  }

  v10 = 0;
LABEL_8:
  BYTE1(v11) = 1;
  LOBYTE(v11) = v8;
  [(UICollectionView *)self _selectItemAtIndexPath:a3 animated:v4 scrollPosition:0 notifyDelegate:1 deselectPrevious:v10 performPrimaryAction:v10 performCustomSelectionAction:v11 isUserInitiated:?];
LABEL_9:
}

- (void)_springLoadedInteractionSelectItemAtIndexPath:(id)a3
{
  v5 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
  v9 = v5;
  if (v5 && ([v5 _hasCustomSelectionAction] & 1) != 0)
  {
    v6 = 0;
    v7 = 1;
  }

  else
  {
    v6 = [(UICollectionView *)self _canPerformPrimaryActionForItemAtIndexPath:a3];
    v7 = 0;
  }

  BYTE1(v8) = 1;
  LOBYTE(v8) = v7;
  [(UICollectionView *)self _selectItemAtIndexPath:a3 animated:0 scrollPosition:0 notifyDelegate:1 deselectPrevious:0 performPrimaryAction:v6 performCustomSelectionAction:v8 isUserInitiated:?];
}

- (void)touchesEnded:(id)a3 withEvent:(id)a4
{
  v63 = *MEMORY[0x1E69E9840];
  v6 = a3;
  v7 = a4;
  v8 = [(UICollectionView *)self _currentTouch];
  if (![v6 containsObject:v8])
  {
    goto LABEL_48;
  }

  [(UICollectionView *)self _setCurrentTouch:0];
  v60.receiver = self;
  v60.super_class = UICollectionView;
  [(UIScrollView *)&v60 touchesEnded:v6 withEvent:v7];
  v9 = [(UIScrollView *)self isDragging];
  if (v8 && !v9)
  {
    v10 = [v8 view];
    if (self->_pendingSelectionIndexPath)
    {
      v11 = [(UICollectionView *)self _cellForItemAtIndexPath:?];
      v12 = v11;
      if (v11)
      {
        [v11 bounds];
        v14 = v13;
        v16 = v15;
        v18 = v17;
        v20 = v19;
        [v8 locationInView:v12];
        v64.x = v21;
        v64.y = v22;
        v65.origin.x = v14;
        v65.origin.y = v16;
        v65.size.width = v18;
        v65.size.height = v20;
        if (!CGRectContainsPoint(v65, v64))
        {
          [(NSMutableSet *)self->_pendingDeselectionIndexPaths removeAllObjects];
LABEL_23:

          goto LABEL_24;
        }
      }
    }

    else
    {
      v12 = 0;
    }

    if (v10)
    {
      v23 = [(UICollectionView *)self _selectableIndexPathForItemContainingHitView:v10];
      if (!v23)
      {
        goto LABEL_23;
      }

      v24 = v23;
      v25 = [(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:self->_pendingSelectionIndexPath];

      if (!v25)
      {
        goto LABEL_23;
      }
    }

    else if (![(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:self->_pendingSelectionIndexPath])
    {
      goto LABEL_23;
    }

    pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    if (!pendingSelectionIndexPath)
    {
      if ((dyld_program_sdk_at_least() & 1) != 0 || [(UICollectionView *)self _allowsEffectiveMultipleSelection])
      {
LABEL_22:
        v30 = self->_pendingSelectionIndexPath;
        self->_pendingSelectionIndexPath = 0;

        goto LABEL_23;
      }

      pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
    }

    v27 = pendingSelectionIndexPath;
    v28 = v27;
    if ((*(&self->_collectionViewFlags + 17) & 8) != 0)
    {
      v29 = UIApp;
      v58[0] = MEMORY[0x1E69E9820];
      v58[1] = 3221225472;
      v58[2] = __43__UICollectionView_touchesEnded_withEvent___block_invoke;
      v58[3] = &unk_1E70F35B8;
      v58[4] = self;
      v59 = v27;
      [v29 _performBlockAfterCATransactionCommits:v58];
    }

    else
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:v27];
    }

    goto LABEL_22;
  }

LABEL_24:
  v31 = [(UIView *)self traitCollection];
  v32 = _UIShouldAnimateDefaultCellHighlightAndSelection(v31);

  v33 = self->_pendingSelectionIndexPath;
  if (v33)
  {
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v33 animated:0 notifyDelegate:1];
    v34 = self->_pendingSelectionIndexPath;
    self->_pendingSelectionIndexPath = 0;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v36 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v36 = 0;
  }

  v37 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v37)
  {
    v38 = v37;
    v39 = *v55;
    do
    {
      for (i = 0; i != v38; ++i)
      {
        if (*v55 != v39)
        {
          objc_enumerationMutation(v36);
        }

        v41 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v54 + 1) + 8 * i)];
        if (([v41 isSelected] & 1) == 0)
        {
          [v41 _setSelected:1 animated:v32];
        }
      }

      v38 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v38);
  }

  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    v49 = v7;
    v52 = 0u;
    v53 = 0u;
    v50 = 0u;
    v51 = 0u;
    v42 = self->_pendingDeselectionIndexPaths;
    v43 = [(NSMutableSet *)v42 countByEnumeratingWithState:&v50 objects:v61 count:16];
    if (v43)
    {
      v44 = v43;
      v45 = *v51;
      do
      {
        for (j = 0; j != v44; ++j)
        {
          if (*v51 != v45)
          {
            objc_enumerationMutation(v42);
          }

          v47 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v50 + 1) + 8 * j)];
          if ([v47 isSelected])
          {
            [v47 _setSelected:0 animated:v32];
          }
        }

        v44 = [(NSMutableSet *)v42 countByEnumeratingWithState:&v50 objects:v61 count:16];
      }

      while (v44);
    }

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;

    v7 = v49;
  }

LABEL_48:
}

- (void)_selectAllSelectedItems
{
  v15 = *MEMORY[0x1E69E9840];
  v10 = 0u;
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v4 = [(NSMutableSet *)selectionController->_selectedIndexPaths copy];
  }

  else
  {
    v4 = 0;
  }

  v5 = [v4 countByEnumeratingWithState:&v10 objects:v14 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v11;
    do
    {
      for (i = 0; i != v6; ++i)
      {
        if (*v11 != v7)
        {
          objc_enumerationMutation(v4);
        }

        v9 = [(UICollectionView *)self _cellForItemAtIndexPath:*(*(&v10 + 1) + 8 * i), v10];
        [v9 _setSelected:1 animated:0];
      }

      v6 = [v4 countByEnumeratingWithState:&v10 objects:v14 count:16];
    }

    while (v6);
  }
}

- (void)_cancelTouches
{
  [(UICollectionView *)self _setCurrentTouch:0];
  v3 = [(UIView *)self traitCollection];
  v4 = _UIShouldAnimateDefaultCellHighlightAndSelection(v3);

  [(UICollectionView *)self _unhighlightItemAtIndexPath:self->_pendingSelectionIndexPath animated:v4 notifyDelegate:1];
  pendingSelectionIndexPath = self->_pendingSelectionIndexPath;
  self->_pendingSelectionIndexPath = 0;

  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    if (![(UIScrollView *)self isTracking])
    {
      [(UICollectionView *)self _selectAllSelectedItems];
    }

    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
  }
}

- (void)touchesCancelled:(id)a3 withEvent:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(UICollectionView *)self _currentTouch];
  v9 = [v6 containsObject:v8];

  if (v9)
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    [(UIScrollView *)&v10 touchesCancelled:v6 withEvent:v7];
    [(UICollectionView *)self _cancelTouches];
  }
}

- (void)_scrollViewDidEndDraggingWithDeceleration:(BOOL)a3
{
  v5.receiver = self;
  v5.super_class = UICollectionView;
  [(UIScrollView *)&v5 _scrollViewDidEndDraggingWithDeceleration:a3];
  if ([(UICollectionView *)self _shouldDeselectItemsOnTouchesBegan])
  {
    [(UICollectionView *)self _selectAllSelectedItems];
    pendingDeselectionIndexPaths = self->_pendingDeselectionIndexPaths;
    self->_pendingDeselectionIndexPaths = 0;
  }
}

- (CGPoint)_contentOffsetForNewFrame:(CGRect)a3 oldFrame:(CGRect)a4 newContentSize:(CGSize)a5 andOldContentSize:(CGSize)a6
{
  rect = a4.size.height;
  width = a4.size.width;
  height = a3.size.height;
  v8 = a3.size.width;
  [(UIScrollView *)self _effectiveContentInset:*&a5.width];
  v33 = v10;
  v12 = v11;
  v29 = v14;
  v30 = v13;
  [(UIView *)self bounds];
  v17 = v15;
  v34 = v16;
  v32 = 0.0;
  v18 = 0.0;
  if (v37 > 0.0)
  {
    v19 = width;
    v20 = rect;
    v18 = CGRectGetMidX(*&v15) / v37;
  }

  if (v38 > 0.0)
  {
    v40.origin.x = v17;
    v40.origin.y = v34;
    v40.size.width = width;
    v40.size.height = rect;
    v32 = CGRectGetMidY(v40) / v38;
  }

  v21 = -v12;
  if (v8 < v35 && v17 > v21)
  {
    v41.origin.x = 0.0;
    v41.origin.y = 0.0;
    v41.size.width = v8;
    v41.size.height = height;
    v23 = round(v35 * v18 + CGRectGetWidth(v41) * -0.5);
    v42.origin.y = 0.0;
    v42.origin.x = v23;
    v42.size.width = v8;
    v42.size.height = height;
    if (CGRectGetMinX(v42) >= v21)
    {
      v21 = v23;
    }

    if (v8 + v21 > v35 + v29)
    {
      v21 = v35 + v29 - v8;
    }
  }

  v24 = -v33;
  if (height < v36 && v34 > v24)
  {
    v43.origin.y = 0.0;
    v43.origin.x = v21;
    v43.size.width = v8;
    v43.size.height = height;
    v26 = round(v36 * v32 + CGRectGetHeight(v43) * -0.5);
    v44.origin.x = v21;
    v44.origin.y = v26;
    v44.size.width = v8;
    v44.size.height = height;
    if (CGRectGetMinY(v44) >= v24)
    {
      v24 = v26;
    }

    if (height + v24 > v36 + v30)
    {
      v24 = v36 + v30 - height;
    }
  }

  v27 = v21;
  v28 = v24;
  result.y = v28;
  result.x = v27;
  return result;
}

- (BOOL)_shouldShowMenuForCell:(id)a3
{
  v4 = a3;
  if ([(UICollectionView *)self _delegateSupportsMenuInteraction])
  {
    v5 = 0;
  }

  else
  {
    v6 = [(UICollectionView *)self _indexPathForCell:v4];
    if (v6 && (*&self->_collectionViewFlags & 0x80) != 0)
    {
      v7 = [(UICollectionView *)self _delegateProxy];
      v5 = [v7 collectionView:self shouldShowMenuForItemAtIndexPath:v6];
    }

    else
    {
      v5 = 0;
    }
  }

  return v5;
}

- (BOOL)_canPerformAction:(SEL)a3 forCell:(id)a4 sender:(id)a5
{
  v8 = a4;
  v9 = a5;
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]&& (*&self->_collectionViewFlags & 0x80) != 0 && ([(UICollectionView *)self _indexPathForCell:v8], (v10 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v11 = v10;
    v12 = [(UICollectionView *)self _delegateProxy];
    v13 = [v12 collectionView:self canPerformAction:a3 forItemAtIndexPath:v11 withSender:v9];
  }

  else
  {
    v13 = 0;
  }

  return v13;
}

- (void)_performAction:(SEL)a3 forCell:(id)a4 sender:(id)a5
{
  v11 = a4;
  v8 = a5;
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]&& (*&self->_collectionViewFlags & 0x80) != 0)
  {
    v9 = [(UICollectionView *)self _delegateProxy];
    v10 = [(UICollectionView *)self _indexPathForCell:v11];
    [v9 collectionView:self performAction:a3 forItemAtIndexPath:v10 withSender:v8];
  }
}

- (void)_cellPreferredSeparatorInsetsChanged:(id)a3
{
  v4 = [(UICollectionView *)self _indexPathForCell:a3];
  if (v4)
  {
    v6 = v4;
    v5 = [(UICollectionView *)self collectionViewLayout];
    [v5 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v6 separatorOnly:1];

    v4 = v6;
  }
}

- (void)_cellBackgroundChangedForSelectionOrHighlight:(id)a3
{
  v4 = [(UICollectionView *)self _indexPathForCell:a3];
  if (v4)
  {
    v6 = v4;
    v5 = [(UICollectionView *)self collectionViewLayout];
    [v5 _cellBackgroundOrBottomSeparatorChangedAtIndexPath:v6 separatorOnly:0];

    v4 = v6;
  }
}

- (void)_unhighlightAllItemsAndHighlightGlobalItem:(int64_t)a3
{
  v5 = [(UICollectionViewData *)self->_collectionViewData indexPathForItemAtGlobalIndex:a3];
  v4 = [MEMORY[0x1E696AC88] indexPathForItem:0x7FFFFFFFFFFFFFFFLL inSection:0x7FFFFFFFFFFFFFFFLL];
  [(UICollectionView *)self _highlightItemAtIndexPath:v4 animated:0 scrollPosition:0 notifyDelegate:1];

  [(UICollectionView *)self _highlightItemAtIndexPath:v5 animated:0 scrollPosition:0 notifyDelegate:1];
}

- (void)_handlePresses:(id)a3 keyHandler:(id)a4 defaultHandler:(id)a5
{
  v32 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(UIView *)self _focusSystem];
  v12 = [v11 focusedItem];
  v13 = _UIFocusEnvironmentContainingView(v12);
  if (!v12 || (-[UICollectionView visibleCells](self, "visibleCells"), v14 = objc_claimAutoreleasedReturnValue(), v15 = [v14 containsObject:v13], v14, !v15))
  {
    v16 = 0;
    v23 = 0;
    if (!v10)
    {
      goto LABEL_16;
    }

LABEL_15:
    v10[2](v10);
    goto LABEL_16;
  }

  v25 = v9;
  v16 = v13;
  v24 = [(UICollectionView *)self _indexPathForCell:v16];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v26 = v8;
  v17 = v8;
  v18 = [v17 countByEnumeratingWithState:&v27 objects:v31 count:16];
  if (v18)
  {
    v19 = v18;
    v20 = *v28;
    while (2)
    {
      v21 = 0;
      do
      {
        if (*v28 != v20)
        {
          objc_enumerationMutation(v17);
        }

        v22 = [*(*(&v27 + 1) + 8 * v21) key];
        if (v22 && ([v16 _canPerformActionForKey:v22] & 1) != 0)
        {

          v9 = v25;
          if (v25)
          {
            v25[2](v25, v16, v22);
          }

          v8 = v26;
          v23 = v24;
          goto LABEL_17;
        }

        ++v21;
      }

      while (v19 != v21);
      v19 = [v17 countByEnumeratingWithState:&v27 objects:v31 count:16];
      if (v19)
      {
        continue;
      }

      break;
    }
  }

  v9 = v25;
  v8 = v26;
  v23 = v24;
  if (v10)
  {
    goto LABEL_15;
  }

LABEL_16:
  v22 = 0;
LABEL_17:
}

- (void)pressesBegan:(id)a3 withEvent:(id)a4
{
  v6 = a3;
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView_pressesBegan_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = v6;
  v12 = v7;
  v13 = self;
  v8 = v7;
  v9 = v6;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __43__UICollectionView_pressesBegan_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesBegan_withEvent_, v2, v1);
}

- (void)pressesChanged:(id)a3 withEvent:(id)a4
{
  v6 = a3;
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __45__UICollectionView_pressesChanged_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = v6;
  v12 = v7;
  v13 = self;
  v8 = v7;
  v9 = v6;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __45__UICollectionView_pressesChanged_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesChanged_withEvent_, v2, v1);
}

- (void)pressesEnded:(id)a3 withEvent:(id)a4
{
  v6 = a3;
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __43__UICollectionView_pressesEnded_withEvent___block_invoke_2;
  v10[3] = &unk_1E70F6228;
  v11 = v6;
  v12 = v7;
  v13 = self;
  v8 = v7;
  v9 = v6;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:&__block_literal_global_998 defaultHandler:v10];
}

id __43__UICollectionView_pressesEnded_withEvent___block_invoke_2(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesEnded_withEvent_, v2, v1);
}

- (void)pressesCancelled:(id)a3 withEvent:(id)a4
{
  v6 = a3;
  v7 = a4;
  v10[0] = MEMORY[0x1E69E9820];
  v10[1] = 3221225472;
  v10[2] = __47__UICollectionView_pressesCancelled_withEvent___block_invoke;
  v10[3] = &unk_1E70F6228;
  v11 = v6;
  v12 = v7;
  v13 = self;
  v8 = v7;
  v9 = v6;
  [(UICollectionView *)self _handlePresses:v9 keyHandler:0 defaultHandler:v10];
}

id __47__UICollectionView_pressesCancelled_withEvent___block_invoke(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(a1 + 32);
  v4.receiver = *(a1 + 48);
  v4.super_class = UICollectionView;
  return objc_msgSendSuper2(&v4, sel_pressesCancelled_withEvent_, v2, v1);
}

- (BOOL)_selectionInteractionShouldBegin:(id)a3
{
  v4 = _indexPathForSelectionInteraction(self);
  v5 = v4 && [(UICollectionView *)self _allowsEffectiveSelectionOrCustomActionAtIndexPath:v4]&& [(UICollectionView *)self _delegateAllowsHighlightingItemAtIndexPath:v4];

  return v5;
}

- (void)_selectionInteractionDidBeginHinting:(id)a3
{
  v4 = _indexPathForSelectionInteraction(self);
  if (v4)
  {
    v5 = v4;
    [(UICollectionView *)self _highlightItemAtIndexPath:v4 animated:0 scrollPosition:0 notifyDelegate:1];
    v4 = v5;
  }
}

- (void)_selectionInteractionDidCancelHinting:(id)a3
{
  v4 = _indexPathForSelectionInteraction(self);
  if (v4)
  {
    v5 = v4;
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v4 animated:0 notifyDelegate:1];
    v4 = v5;
  }
}

- (void)_selectionInteractionDidSelect:(id)a3
{
  selectionController = self->_selectionController;
  if (selectionController)
  {
    v5 = [(NSMutableSet *)selectionController->_highlightedIndexPaths copy];
  }

  else
  {
    v5 = 0;
  }

  v7 = [v5 anyObject];

  if ([(UICollectionView *)self _indexPathIsValid:v7])
  {
    [(UICollectionView *)self _userSelectItemAtIndexPath:v7];
  }

  else
  {
    v6 = _indexPathForSelectionInteraction(self);
    if (v6)
    {
      [(UICollectionView *)self _userSelectItemAtIndexPath:v6];
    }
  }
}

- (int64_t)highlightedGlobalItem
{
  selectionController = self->_selectionController;
  if (!selectionController || [(NSMutableSet *)selectionController->_highlightedIndexPaths count]< 1)
  {
    return -1;
  }

  v4 = self->_selectionController;
  if (v4)
  {
    v5 = [(NSMutableSet *)v4->_highlightedIndexPaths copy];
  }

  else
  {
    v5 = 0;
  }

  v6 = [v5 anyObject];

  v7 = [(UICollectionViewData *)self->_collectionViewData globalIndexForItemAtIndexPath:v6];
  return v7;
}

- (int64_t)maximumGlobalItemIndex
{
  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    return 0;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  return collectionViewData->_totalItemCount;
}

- (void)_trackLayoutValue:(double)a3 forKey:(id)a4
{
  v6 = a4;
  v7 = v6;
  if (self->_shouldAccumulateTrackedLayoutValues)
  {
    v13 = v6;
    if (!self->_interactiveTransitionValueTrackingDict)
    {
      v8 = [objc_alloc(MEMORY[0x1E695DF90]) initWithCapacity:2];
      interactiveTransitionValueTrackingDict = self->_interactiveTransitionValueTrackingDict;
      self->_interactiveTransitionValueTrackingDict = v8;

      v7 = v13;
    }

    if (!self->_trackedValuesKeys)
    {
      v10 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:2];
      trackedValuesKeys = self->_trackedValuesKeys;
      self->_trackedValuesKeys = v10;

      v7 = v13;
    }

    v12 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:v7];
    if (!v12)
    {
      v12 = objc_alloc_init(_UICollectionViewTrackedValue);
      [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict setValue:v12 forKey:v13];
      [(NSMutableArray *)self->_trackedValuesKeys addObject:v13];
    }

    [(_UICollectionViewTrackedValue *)v12 addValue:a3];

    v7 = v13;
  }
}

- (double)_trackedLayoutValueForKey:(id)a3
{
  v3 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:a3];
  v4 = v3;
  if (v3)
  {
    [v3 trackedValue];
    v6 = v5;
  }

  else
  {
    v6 = 0.0;
  }

  return v6;
}

- (void)_updateTrackedLayoutValuesWith:(id)a3
{
  v12 = a3;
  v4 = [v12 count];
  if (v4 >= 1)
  {
    v5 = v4;
    for (i = 0; i != v5; ++i)
    {
      v7 = [v12 objectAtIndex:i];
      [v7 value];
      v9 = v8;

      v10 = [(NSMutableArray *)self->_trackedValuesKeys objectAtIndex:i];
      v11 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:v10];
      [v11 setTrackedValue:v9];
    }
  }
}

- (id)_dynamicAnimationsForTrackValues
{
  v22 = *MEMORY[0x1E69E9840];
  if ([(NSMutableArray *)self->_trackedValuesKeys count])
  {
    v3 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{-[NSMutableArray count](self->_trackedValuesKeys, "count")}];
    v17 = 0u;
    v18 = 0u;
    v19 = 0u;
    v20 = 0u;
    obj = self->_trackedValuesKeys;
    v4 = [(NSMutableArray *)obj countByEnumeratingWithState:&v17 objects:v21 count:16];
    if (v4)
    {
      v5 = v4;
      v6 = *v18;
      do
      {
        for (i = 0; i != v5; ++i)
        {
          if (*v18 != v6)
          {
            objc_enumerationMutation(obj);
          }

          v8 = [(NSMutableDictionary *)self->_interactiveTransitionValueTrackingDict objectForKey:*(*(&v17 + 1) + 8 * i)];
          [v8 speed];
          v10 = v9;
          [v8 trackedValue];
          v12 = [[_UIDynamicValueAnimation alloc] initWithValue:v11 velocity:v10 unitSize:0.05];
          v13 = [_UIDynamicAnimationActiveValue upperBoundary:1 ofType:0.0];
          v14 = [_UIDynamicAnimationActiveValue lowerBoundary:1 ofType:0.0];
          [(_UIDynamicValueAnimation *)v12 addActiveValue:v13];
          [(_UIDynamicValueAnimation *)v12 addActiveValue:v14];
          [v3 addObject:v12];
        }

        v5 = [(NSMutableArray *)obj countByEnumeratingWithState:&v17 objects:v21 count:16];
      }

      while (v5);
    }
  }

  else
  {
    v3 = 0;
  }

  return v3;
}

- (void)encodeRestorableStateWithCoder:(id)a3
{
  v22 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(UICollectionView *)self dataSource];
  v6 = [objc_opt_class() conformsToProtocol:&unk_1F00BCFA8];

  v20.receiver = self;
  v20.super_class = UICollectionView;
  [(UIScrollView *)&v20 encodeRestorableStateWithCoder:v4];
  v7 = [(UICollectionView *)self _indexPathsForSelectedItems];
  if ([v7 count])
  {
    [v4 encodeObject:v7 forKey:@"CollectionViewSelectedCellIndexPaths"];
    if (v6)
    {
      v8 = [(UICollectionView *)self dataSource];
      if ([v7 count])
      {
        v9 = [MEMORY[0x1E695DF70] array];
        v16 = 0u;
        v17 = 0u;
        v18 = 0u;
        v19 = 0u;
        v10 = v7;
        v11 = [v10 countByEnumeratingWithState:&v16 objects:v21 count:16];
        if (v11)
        {
          v12 = v11;
          v13 = *v17;
          do
          {
            v14 = 0;
            do
            {
              if (*v17 != v13)
              {
                objc_enumerationMutation(v10);
              }

              v15 = [v8 modelIdentifierForElementAtIndexPath:*(*(&v16 + 1) + 8 * v14) inView:{self, v16}];
              if (v15)
              {
                [v9 addObject:v15];
              }

              ++v14;
            }

            while (v12 != v14);
            v12 = [v10 countByEnumeratingWithState:&v16 objects:v21 count:16];
          }

          while (v12);
        }

        if ([v9 count])
        {
          [v4 encodeObject:v9 forKey:@"CollectionViewSelectedCellModelIdentifiers"];
        }
      }
    }
  }
}

- (BOOL)_indexPathIsValid:(id)a3 allowSectionItemSentinel:(BOOL)a4
{
  if (!a3)
  {
    return 0;
  }

  v7 = [a3 section];
  v8 = [a3 item];
  if ([(UICollectionView *)self numberOfSections]<= v7)
  {
    return 0;
  }

  v9 = [(UICollectionView *)self numberOfItemsInSection:v7];
  v10 = v8 == 0x7FFFFFFFFFFFFFFFLL && a4;
  return v9 > v8 || v10;
}

- (BOOL)_isSectionValidInIndexPath:(id)a3
{
  if (!a3)
  {
    return 0;
  }

  v4 = [a3 section];
  return [(UICollectionView *)self numberOfSections]> v4;
}

- (void)_orthogonalScrollView:(id)a3 didScrollToOffset:(CGPoint)a4 inSection:(int64_t)a5
{
  y = a4.y;
  x = a4.x;
  v22 = a3;
  WeakRetained = objc_loadWeakRetained(&self->_dataSource);

  if (WeakRetained)
  {
    v10 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:a5];
    v11 = [(_UICollectionLayoutSectionDescriptor *)v10 scrollingUnitVector];
    v13 = v12;
    [(UICollectionViewLayout *)self->_layout _setOffset:a5 forOrthogonalScrollingSection:x, y];
    collectionViewData = self->_collectionViewData;
    [(UICollectionView *)self _visibleBounds];
    [(UICollectionViewData *)collectionViewData validateLayoutInRect:v15, v16, v17, v18];
    v19 = [(UICollectionView *)self _updateVisibleCellsNow:1];
    if ([(UICollectionView *)self _prefetchingAllowed])
    {
      if (v19)
      {
        v20 = 0;
      }

      else
      {
        v20 = *(&self->_collectionViewFlags + 1) >= 0;
      }

      [(UICollectionView *)self _updatePrefetchedCellsForOrthogonalScrollingSection:a5 withOriginalPrefetchingVector:v19 == 0 canCompute:v20 canPrefetch:v11, v13];
    }

    if ((*(&self->_collectionViewFlags + 6) & 2) != 0)
    {
      v21 = [(UICollectionView *)self _delegateProxy];
      [v21 _collectionView:self orthogonalScrollViewDidScroll:v22 section:a5];
    }
  }
}

- (void)_updatePrefetchedCellsForOrthogonalScrollingSection:(int64_t)a3 withOriginalPrefetchingVector:(CGVector)a4 canCompute:(BOOL)a5 canPrefetch:(BOOL)a6
{
  v6 = a6;
  v7 = a5;
  dy = a4.dy;
  dx = a4.dx;
  v57 = [(UICollectionViewLayout *)self->_layout _sectionDescriptorForSectionIndex:?];
  v13 = [(_UICollectionLayoutSectionDescriptor *)v57 scrollingUnitVector];
  v14 = v12;
  if (v13 == 0.0 && v12 == 0.0)
  {
    [(_UIVelocityIntegrator *)self->_prefetchVelocityIntegrator velocity];
  }

  [(UICollectionView *)self _pruneCachedPrefetchViewsForVelocity:?];
  v15 = [(UICollectionView *)self _prefetchingContextForOrthogonalScrollingSection:a3];
  v16 = v15;
  if (!v15)
  {
    if (!v7)
    {
      goto LABEL_23;
    }

    v56 = v14;
LABEL_16:
    v17 = 1;
    goto LABEL_17;
  }

  if (vabdd_f64(v13, dx) > 0.1 || vabdd_f64(v14, dy) > 0.1)
  {
    [(UICollectionView *)self _resetPrefetchingContext:v15];

    if (!v7)
    {
      [(UICollectionView *)self _setPrefetchingContext:0 forOrthogonalScrollingSection:a3];
      v16 = 0;
      goto LABEL_23;
    }

    v56 = v14;
    v16 = 0;
    goto LABEL_16;
  }

  if (!v7 || [*(v15 + 16) count])
  {
    if (v6 && [*(v16 + 16) count])
    {
      [(UICollectionView *)self _prefetchItemsForPrefetchingContext:v16];
    }

    goto LABEL_23;
  }

  v56 = v14;
  v17 = 0;
LABEL_17:
  [(UICollectionView *)self _visibleBounds];
  v19 = v18;
  v21 = v20;
  v23 = v22;
  v25 = v24;
  [(UICollectionViewLayout *)self->_layout _contentFrameForSection:a3];
  v54 = v27;
  v55 = v26;
  v52 = v29;
  v53 = v28;
  [(UICollectionViewLayout *)self->_layout _offsetForOrthogonalScrollingSection:a3];
  v31 = v19 + v30;
  v33 = v21 + v32;
  v59.origin.x = v19;
  v59.origin.y = v21;
  v59.size.width = v23;
  v59.size.height = v25;
  Width = CGRectGetWidth(v59);
  v50 = v21;
  v51 = v19;
  v60.origin.x = v19;
  v60.origin.y = v21;
  v49 = v23;
  v60.size.width = v23;
  v60.size.height = v25;
  v61.size.height = CGRectGetHeight(v60);
  v61.origin.x = v31;
  v61.origin.y = v33;
  v61.size.width = Width;
  v63.origin.y = v54;
  v63.origin.x = v55;
  v63.size.height = v52;
  v63.size.width = v53;
  v62 = CGRectIntersection(v61, v63);
  v35 = _UIRectExpandByFactorAndUnitVector(v62.origin.x, v62.origin.y, v62.size.width, v62.size.height, 0.75, v13, v56);
  v37 = v36;
  v39 = v38;
  v41 = v40;
  if (v17 || (!v16 ? (v43 = 0, v44 = 0, v45 = 0, v42 = 0) : (v42 = *(v16 + 32), v43 = *(v16 + 40), v44 = *(v16 + 48), v45 = *(v16 + 56)), v64.origin.x = v35, v64.origin.y = v37, v64.size.width = v39, v64.size.height = v41, !CGRectEqualToRect(*&v42, v64)))
  {
    v46 = [(UICollectionViewLayout *)self->_layout layoutAttributesForElementsInRect:v35, v37, v39, v41];
    v47 = [(UICollectionView *)self _prefetchingContextForVisibleBounds:v46 prefetchVector:v51 prefetchRect:v50 attributes:v49, v25, v13, v56, *&v35, *&v37, *&v39, *&v41];

    [(UICollectionView *)self _setPrefetchingContext:v47 forOrthogonalScrollingSection:a3];
    v16 = v47;
  }

LABEL_23:
  activeOrthogonalPrefetchingContext = self->_activeOrthogonalPrefetchingContext;
  self->_activeOrthogonalPrefetchingContext = v16;
}

- (void)decodeRestorableStateWithCoder:(id)a3
{
  v51 = *MEMORY[0x1E69E9840];
  v4 = a3;
  [(UIView *)self layoutIfNeeded];
  [(UIScrollView *)self contentOffset];
  v6 = v5;
  v8 = v7;
  v9 = [(UICollectionView *)self dataSource];
  v10 = [objc_opt_class() conformsToProtocol:&unk_1F00BCFA8];

  v48.receiver = self;
  v48.super_class = UICollectionView;
  [(UIScrollView *)&v48 decodeRestorableStateWithCoder:v4];
  [(UICollectionView *)self _reloadDataIfNeeded];
  [(UIScrollView *)self contentOffset];
  v13 = v12;
  v14 = v11;
  if (v6 == v12 && v8 == v11)
  {
LABEL_6:
    if (v10)
    {
      goto LABEL_7;
    }

    goto LABEL_20;
  }

  [(UIScrollView *)self contentSize];
  v16 = v15;
  [(UIView *)self frame];
  if (v13 > v16 - v17 || ([(UIScrollView *)self contentSize], v19 = v18, [(UIView *)self frame], v14 > v19 - v20))
  {
    [(UICollectionView *)self setContentOffset:v6, v8];
    goto LABEL_6;
  }

  [(UICollectionView *)self _updateVisibleCellsNow:1];
  if (v10)
  {
LABEL_7:
    v21 = [(UICollectionView *)self dataSource];
    v22 = MEMORY[0x1E695DFD8];
    v23 = objc_opt_class();
    v24 = [v22 setWithObjects:{v23, objc_opt_class(), 0}];
    v25 = [v4 decodeObjectOfClasses:v24 forKey:@"CollectionViewSelectedCellModelIdentifiers"];

    if (v25)
    {
      v46 = 0u;
      v47 = 0u;
      v44 = 0u;
      v45 = 0u;
      v25 = v25;
      v26 = [v25 countByEnumeratingWithState:&v44 objects:v50 count:16];
      if (v26)
      {
        v27 = v26;
        v28 = *v45;
        do
        {
          for (i = 0; i != v27; ++i)
          {
            if (*v45 != v28)
            {
              objc_enumerationMutation(v25);
            }

            v30 = [v21 indexPathForElementWithModelIdentifier:*(*(&v44 + 1) + 8 * i) inView:self];
            if (v30 && [(UICollectionView *)self _indexPathIsValid:v30])
            {
              LOWORD(v39) = 0;
              [(UICollectionView *)self _selectItemAtIndexPath:v30 animated:0 scrollPosition:0 notifyDelegate:0 deselectPrevious:0 performPrimaryAction:0 performCustomSelectionAction:v39 isUserInitiated:?];
            }
          }

          v27 = [v25 countByEnumeratingWithState:&v44 objects:v50 count:16];
        }

        while (v27);
      }
    }

LABEL_31:

    goto LABEL_32;
  }

LABEL_20:
  v31 = MEMORY[0x1E695DFD8];
  v32 = objc_opt_class();
  v33 = [v31 setWithObjects:{v32, objc_opt_class(), 0}];
  v21 = [v4 decodeObjectOfClasses:v33 forKey:@"CollectionViewSelectedCellIndexPaths"];

  if ([v21 count])
  {
    v42 = 0u;
    v43 = 0u;
    v40 = 0u;
    v41 = 0u;
    v25 = v21;
    v34 = [v25 countByEnumeratingWithState:&v40 objects:v49 count:16];
    if (v34)
    {
      v35 = v34;
      v36 = *v41;
      do
      {
        for (j = 0; j != v35; ++j)
        {
          if (*v41 != v36)
          {
            objc_enumerationMutation(v25);
          }

          v38 = *(*(&v40 + 1) + 8 * j);
          if ([(UICollectionView *)self _indexPathIsValid:v38])
          {
            [(UICollectionView *)self selectItemAtIndexPath:v38 animated:0 scrollPosition:0];
          }
        }

        v35 = [v25 countByEnumeratingWithState:&v40 objects:v49 count:16];
      }

      while (v35);
    }

    v21 = v25;
    goto LABEL_31;
  }

LABEL_32:
}

- (void)setRemembersLastFocusedIndexPath:(BOOL)remembersLastFocusedIndexPath
{
  v3 = 0x40000000000;
  if (!remembersLastFocusedIndexPath)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFBFFFFFFFFFFLL | v3;
}

- (void)_setFocusedItemState:(id)a3
{
  v39 = *MEMORY[0x1E69E9840];
  v5 = a3;
  v6 = [(UICollectionView *)self _focusedItemState];
  objc_storeStrong(&self->_focusedItemState, a3);
  if (v6)
  {
    v7 = *(v6 + 8);
    if (v7)
    {
      v8 = v7;
      v9 = *(v6 + 8);
      v10 = v5 ? v5[1] : 0;
      v11 = v10;

      if (v9 != v11)
      {
        v12 = *(v6 + 8);
        [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v12];
        CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED4925F8);
        if (*CategoryCachedImpl)
        {
          v23 = *(CategoryCachedImpl + 8);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
          {
            v24 = v23;
            if (v5)
            {
              v25 = v5[2];
              v26 = v5[1];
              v27 = v25;
            }

            else
            {
              v25 = 0;
              v27 = 0;
              v26 = 0;
            }

            v28 = v26;
            v29 = *(v6 + 8);
            v31 = 134218754;
            v32 = self;
            v33 = 2112;
            v34 = v25;
            v35 = 2112;
            v36 = v28;
            v37 = 2112;
            v38 = v29;
            _os_log_impl(&dword_188A29000, v24, OS_LOG_TYPE_ERROR, "[UICV %p] _setFocusedItemState: Asked to update focus at %@ to cell %@ while cell %@ is already focused", &v31, 0x2Au);
          }
        }
      }
    }
  }

  if (v5)
  {
    v14 = v5[1];
    if (os_variant_has_internal_diagnostics())
    {
      if (v14)
      {
        if ([(UIView *)v14 isHidden]|| ([(UIView *)v14 alpha], v30 <= 0.0))
        {
          v22 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v22, OS_LOG_TYPE_FAULT))
          {
            v31 = 138412290;
            v32 = v14;
            _os_log_fault_impl(&dword_188A29000, v22, OS_LOG_TYPE_FAULT, "Attempting store a hidden view as focused: %@", &v31, 0xCu);
          }
        }
      }
    }

    else if (v14)
    {
      if ([(UIView *)v14 isHidden]|| ([(UIView *)v14 alpha], v17 <= 0.0))
      {
        v15 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492600) + 8);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          v31 = 138412290;
          v32 = v14;
          _os_log_impl(&dword_188A29000, v15, OS_LOG_TYPE_ERROR, "Attempting store a hidden view as focused: %@", &v31, 0xCu);
        }
      }
    }

    v16 = 0;
  }

  else
  {
    v16 = [(_UICollectionViewFocusedItemState *)v6 copyWithReusableView:?];
    v14 = v16;
  }

  [(UICollectionView *)self _setRememberedFocusedItemState:v16];

  currentUpdate = self->_currentUpdate;
  if (currentUpdate)
  {
    oldFocusedItemState = currentUpdate->_oldFocusedItemState;
    currentUpdate->_oldFocusedItemState = 0;

    v20 = self->_currentUpdate;
    newFocusedItemState = v20->_newFocusedItemState;
    v20->_newFocusedItemState = 0;
  }
}

- (void)_setDisplaysHorizontalIndexTitleBar:(BOOL)a3
{
  if (((((*(&self->_collectionViewFlags + 1) & 0x8000000) == 0) ^ a3) & 1) == 0)
  {
    v4 = 0x8000000;
    if (!a3)
    {
      v4 = 0;
    }

    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFF7FFFFFFLL | v4;
    if (a3 && ![(UIScrollView *)self _canScrollY])
    {

      [(UICollectionView *)self setupHorizontalIndexTitleBar];
    }

    else
    {

      [(UICollectionView *)self teardownHorizontalIndexTitleBar];
    }
  }
}

- (CGPoint)_horizontalIndexTitleBarOffset
{
  x = self->_horizontalIndexTitleBarOffset.x;
  y = self->_horizontalIndexTitleBarOffset.y;
  result.y = y;
  result.x = x;
  return result;
}

- (void)_setHorizontalIndexTitleBarOffset:(CGPoint)a3
{
  if (self->_horizontalIndexTitleBarOffset.x != a3.x || self->_horizontalIndexTitleBarOffset.y != a3.y)
  {
    self->_horizontalIndexTitleBarOffset = a3;
    [(UICollectionView *)self layoutHorizontalIndexTitleBar];
  }
}

- (id)_primaryFocusItemForFocusGroup:(id)a3
{
  v4 = [(UICollectionView *)self indexPathsForSelectedItems];
  if ([v4 count] == 1)
  {
    v5 = [v4 firstObject];
    v6 = [(UICollectionView *)self cellForItemAtIndexPath:v5];
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (void)_requestFocusOnItemAtIndexPath:(id)a3
{
  v4 = [_UICollectionViewFocusedItemState stateWithIndexPath:a3 elementKind:@"UICollectionElementKindCell" viewType:0];
  targetFocusedItemState = self->_targetFocusedItemState;
  self->_targetFocusedItemState = v4;

  [(UIView *)self _setNeedsNonDeferredFocusUpdate];
}

- (id)_layoutAttributesForFailedMovementWithHeading:(unint64_t)a3
{
  if ((a3 & 0x300) != 0)
  {
    v4 = MEMORY[0x1E695E0F0];
  }

  else
  {
    v6 = a3;
    [(UIScrollView *)self visibleBounds];
    v9 = v8;
    v11 = v10;
    v13 = v12;
    v15 = v14;
    v16 = _UIVectorForFocusHeading(v6);
    v18 = v17;
    v19 = fabs(v17);
    if (fabs(v16) > 2.22044605e-16 || v19 > 2.22044605e-16)
    {
      v23.origin.x = v9;
      v23.origin.y = v11;
      v23.size.width = v13;
      v23.size.height = v15;
      v21 = v9 + v16 * CGRectGetWidth(v23);
      v24.origin.x = v9;
      v24.origin.y = v11;
      v24.size.width = v13;
      v24.size.height = v15;
      Height = CGRectGetHeight(v24);
      v4 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForElementsInRect:v21, v11 + v18 * Height, v13, v15];
    }

    else
    {
      v4 = MEMORY[0x1E695E0F0];
    }
  }

  return v4;
}

- (void)_focusMovementDidFailNotification:(id)a3
{
  v48 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if (self->_searchFullPageOnFocusUpdate)
  {
    v5 = [(UIView *)self _focusSystem];
    v6 = [v4 object];

    if (v5 == v6)
    {
      v7 = [v4 userInfo];
      v8 = [v7 objectForKeyedSubscript:@"UIFocusUpdateContextKey"];

      v9 = [v8 previouslyFocusedItem];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v10 = v9;
        v11 = [v10 _collectionView];

        if (v11 == self)
        {
          v12 = [(UICollectionView *)self _focusedItemState];
          v13 = v12;
          v14 = v12 ? *(v12 + 16) : 0;
          v15 = v14;
          v16 = [(UICollectionView *)self indexPathForCell:v10];
          v17 = [v15 isEqual:v16];

          if (v17)
          {
            [v10 frame];
            v19 = v18;
            v21 = v20;
            v23 = v22;
            v25 = v24;
            v26 = -[UICollectionView _layoutAttributesForFailedMovementWithHeading:](self, "_layoutAttributesForFailedMovementWithHeading:", [v8 focusHeading]);
            v43 = 0u;
            v44 = 0u;
            v45 = 0u;
            v46 = 0u;
            v27 = [v26 countByEnumeratingWithState:&v43 objects:v47 count:16];
            if (v27)
            {
              v28 = v27;
              v42 = v10;
              v29 = 0;
              v30 = *v44;
              v31 = 1.79769313e308;
              do
              {
                for (i = 0; i != v28; ++i)
                {
                  if (*v44 != v30)
                  {
                    objc_enumerationMutation(v26);
                  }

                  v33 = *(*(&v43 + 1) + 8 * i);
                  if (v33)
                  {
                    if (v33[288])
                    {
                      [*(*(&v43 + 1) + 8 * i) frame];
                      v38 = UIDistanceBetweenRects(v34, v35, v36, v37, v19, v21, v23, v25);
                      if (v38 < v31)
                      {
                        v39 = v38;
                        v40 = v33;

                        v31 = v39;
                        v29 = v40;
                      }
                    }
                  }
                }

                v28 = [v26 countByEnumeratingWithState:&v43 objects:v47 count:16];
              }

              while (v28);
              v10 = v42;
              if (v29)
              {
                v41 = [_UICollectionViewFocusedItemState stateWithLayoutAttributes:v29];
                [(UICollectionView *)self _setFocusedItemState:v41];

                [(UIView *)self setNeedsFocusUpdate];
              }
            }
          }
        }
      }
    }
  }
}

- (BOOL)_cellCanBecomeFocused:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _indexPathForCell:v4];
  v6 = v5;
  if (!v5 || [v5 length] != 2 || objc_msgSend(v6, "row") == 0x7FFFFFFFFFFFFFFFLL || objc_msgSend(v6, "section") == 0x7FFFFFFFFFFFFFFFLL || (p_collectionViewFlags = &self->_collectionViewFlags, (*(&self->_collectionViewFlags + 18) & 2) != 0) || objc_msgSend(v4, "_typeSelectState") == 1)
  {
    v8 = 0;
  }

  else
  {
    v10 = [(UICollectionView *)self _allowsEffectiveFocus];
    v8 = v10;
    v11 = *p_collectionViewFlags;
    if ((*p_collectionViewFlags & 0x280000) != 0)
    {
      if ((v11 & 0x80000) != 0)
      {
        v12 = [(UICollectionView *)self _delegateProxy];
        v8 = [v12 _collectionView:self canFocusItemAtIndexPath:v6];

        v11 = *p_collectionViewFlags;
      }

      if ((v11 & 0x200000) != 0)
      {
        v13 = [(UICollectionView *)self _delegateProxy];
        v8 = [v13 collectionView:self canFocusItemAtIndexPath:v6];
      }
    }

    else if (v10)
    {
      v14 = [(UIView *)self _focusBehavior];
      v15 = [v14 cellFocusability];

      if (v15 == 1)
      {
        v8 = [(UICollectionView *)self _inferFocusabilityForCell:v4 atIndexPath:v6];
      }

      else
      {
        v8 = 1;
      }
    }
  }

  return v8;
}

- (void)_cellBecameFocused:(id)a3
{
  v4 = [(UICollectionView *)self _indexPathForCell:a3];
  if ((*(&self->_collectionViewFlags + 2) & 0x40) != 0)
  {
    v6 = v4;
    v5 = [(UICollectionView *)self _delegateProxy];
    [v5 _collectionView:self didFocusItemAtIndexPath:v6];

    v4 = v6;
  }
}

- (int64_t)_cellFocusItemDeferral:(id)a3
{
  v4 = a3;
  if (-[UICollectionView _shouldBecomeFocusedOnSelection](self, "_shouldBecomeFocusedOnSelection") && -[UICollectionView selectionFollowsFocus](self, "selectionFollowsFocus") && (-[UICollectionView _indexPathForCell:](self, "_indexPathForCell:", v4), (v5 = objc_claimAutoreleasedReturnValue()) != 0) && (v6 = v5, -[UICollectionView indexPathsForSelectedItems](self, "indexPathsForSelectedItems"), v7 = objc_claimAutoreleasedReturnValue(), v8 = [v7 containsObject:v6], v7, v6, (v8 & 1) != 0))
  {
    v9 = 2;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)_containsFocusedItem
{
  v2 = [(UICollectionView *)self _focusedItemState];
  v3 = v2;
  if (v2)
  {
    v4 = *(v2 + 8);
  }

  else
  {
    v4 = 0;
  }

  v5 = v4;
  v6 = v5 != 0;

  return v6;
}

- (BOOL)_isMovingFocusFromHorizontalIndexBarToCellContent:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (v5)
  {
    v6 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v7 = [v4 previouslyFocusedView];
    if ([v6 _isViewEntryCell:v7])
    {
      v8 = [v4 nextFocusedView];
      v9 = [v8 superview];
      v10 = v9 == self;
    }

    else
    {
      v10 = 0;
    }
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (void)_performWhileSuppressingPromiseRegionGeneration:(id)a3
{
  v5 = a3;
  v9 = v5;
  if (!v5)
  {
    v8 = [MEMORY[0x1E696AAA8] currentHandler];
    [v8 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:15356 description:{@"Invalid parameter not satisfying: %@", @"block"}];

    v5 = 0;
  }

  p_collectionViewFlags = &self->_collectionViewFlags;
  v7 = *(p_collectionViewFlags + 4);
  *(p_collectionViewFlags + 4) = v7 | 0x40000;
  (*(v5 + 2))();
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFBFFFF | (((v7 >> 18) & 1) << 18);
}

- (id)_existingFocusItemsInRect:(CGRect)a3
{
  v6.receiver = self;
  v6.super_class = UICollectionView;
  v3 = [(UIView *)&v6 focusItemsInRect:a3.origin.x, a3.origin.y, a3.size.width, a3.size.height];
  v4 = [v3 bs_filter:&__block_literal_global_1041];

  return v4;
}

uint64_t __46__UICollectionView__existingFocusItemsInRect___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  if (_IsKindOfUIView(v2))
  {
    v3 = [v2 _isHiddenForReuse] ^ 1;
  }

  else
  {
    v3 = 1;
  }

  return v3;
}

- (id)focusItemsInRect:(CGRect)a3
{
  height = a3.size.height;
  width = a3.size.width;
  y = a3.origin.y;
  x = a3.origin.x;
  v8 = [(UICollectionView *)self _existingFocusItemsInRect:?];
  v9 = [(UIView *)self coordinateSpace];
  v10 = [(UICollectionView *)self _focusPromiseItemsInRect:v9 inCoordinateSpace:0x7FFFFFFFFFFFFFFFLL inSection:x, y, width, height];

  v11 = [v8 arrayByAddingObjectsFromArray:v10];

  return v11;
}

- (id)_focusPromiseItemsInRect:(CGRect)a3 inCoordinateSpace:(id)a4 inSection:(int64_t)a5
{
  v53 = *MEMORY[0x1E69E9840];
  if ((*(&self->_collectionViewFlags + 18) & 4) != 0)
  {
    v43 = MEMORY[0x1E695E0F0];
  }

  else
  {
    [(UIView *)self convertRect:a4 fromCoordinateSpace:a3.origin.x, a3.origin.y, a3.size.width, a3.size.height];
    v8 = v7;
    v10 = v9;
    v12 = v11;
    v14 = v13;
    v43 = objc_opt_new();
    [(UICollectionViewData *)self->_collectionViewData layoutAttributesForElementsInRect:v8, v10, v12, v14];
    v48 = 0u;
    v49 = 0u;
    v50 = 0u;
    obj = v51 = 0u;
    v15 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
    if (v15)
    {
      v16 = v15;
      v45 = *v49;
      v42 = v47;
      do
      {
        for (i = 0; i != v16; ++i)
        {
          if (*v49 != v45)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v48 + 1) + 8 * i);
          orthogonalScrollerController = self->_orthogonalScrollerController;
          v20 = [v18 indexPath];
          v21 = [(_UICollectionViewOrthogonalScrollerSectionController *)orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:v20];

          if (a5 == 0x7FFFFFFFFFFFFFFFLL)
          {
            v22 = self->_orthogonalScrollerController;
            v23 = [v18 indexPath];
            LOBYTE(v22) = [(_UICollectionViewOrthogonalScrollerSectionController *)v22 isIndexPathInExtantOrthogonalScroller:v23];

            v24 = v21 & v22;
          }

          else
          {
            v25 = [v18 indexPath];
            if ([v25 section] == a5)
            {
              v26 = [v18 indexPath];
              v24 = [v26 item] == 0x7FFFFFFFFFFFFFFFLL;
            }

            else
            {
              v24 = 1;
            }
          }

          v27 = [v18 isHidden];
          if (v18 && (v27 & 1) == 0 && (v24 & 1) == 0 && (v18[288] & 1) != 0)
          {
            subviewManager = self->_subviewManager;
            v29 = [v18 indexPath];
            v30 = [(_UICollectionViewSubviewManager *)subviewManager visibleCellAtIndexPath:v29];

            if (!v30)
            {
              newContentView = self->_newContentView;
              if (!newContentView || (-[UICollectionReusableView _layoutAttributes](newContentView, "_layoutAttributes"), v32 = objc_claimAutoreleasedReturnValue(), v33 = [v32 isEqual:v18], v32, (v33 & 1) == 0))
              {
                v34 = self;
                v35 = v34;
                if (v21)
                {
                  v36 = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa promiseItemParentScrollViewForLayoutAttributes:v18];
                  v37 = v36;
                  if (v36)
                  {
                    v38 = v36;
                  }

                  else
                  {
                    v38 = v34;
                  }

                  v35 = v38;
                }

                v39 = [_UIFocusPromiseItem alloc];
                [v18 frame];
                v46[0] = MEMORY[0x1E69E9820];
                v46[1] = 3221225472;
                v47[0] = __73__UICollectionView__focusPromiseItemsInRect_inCoordinateSpace_inSection___block_invoke;
                v47[1] = &unk_1E70FF928;
                v47[2] = v34;
                v47[3] = v18;
                v40 = [(_UIFocusPromiseItem *)v39 initWithParentEnvironment:v35 frame:v46 fullfillmentHandler:?];
                [v43 addObject:v40];
              }
            }
          }
        }

        v16 = [obj countByEnumeratingWithState:&v48 objects:v52 count:16];
      }

      while (v16);
    }
  }

  return v43;
}

- (id)_fulfillPromisedFocusRegionForLayoutAttributes:(id)a3
{
  v22 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [v4 indexPath];
  v6 = [(_UICollectionViewSubviewManager *)self->_subviewManager visibleCellAtIndexPath:v5];
  if (v6)
  {
    v7 = v6;
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492610);
    if (*CategoryCachedImpl)
    {
      v9 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        v10 = v9;
        v11 = [v5 _ui_shortDescription];
        v16 = 134218498;
        v17 = self;
        v18 = 2112;
        v19 = v11;
        v20 = 2112;
        v21 = v7;
        v12 = "[UICV %p] Returning existing cell to fulfill focus promise at %@: %@";
LABEL_11:
        _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, v12, &v16, 0x20u);
      }
    }
  }

  else
  {
    v7 = [(UICollectionView *)self _preparedCellForItemAtIndexPath:v5 withLayoutAttributes:v4 applyAttributes:1 isFocused:0 notify:0];
    [(UICollectionView *)self _setCurrentPromiseFulfillmentCell:v7];
    [(_UICollectionViewSubviewManager *)self->_subviewManager setVisibleCell:v7 atIndexPath:v5];
    [v7 layoutIfNeeded];
    v13 = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &qword_1ED492608);
    if (*v13)
    {
      v15 = *(v13 + 8);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        v10 = v15;
        v11 = [v5 _ui_shortDescription];
        v16 = 134218498;
        v17 = self;
        v18 = 2112;
        v19 = v11;
        v20 = 2112;
        v21 = v7;
        v12 = "[UICV %p] Creating (or unhiding prefetched) cell to fulfill focus promise at %@: %@";
        goto LABEL_11;
      }
    }
  }

  return v7;
}

- (id)_focusScrollBoundaryMetricsForItem:(id)a3
{
  v4 = a3;
  v5 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:v4 scrollView:self];
  [(UICollectionView *)self _updateFocusScrollBoundaryMetrics:v5 forItem:v4 inSection:0x7FFFFFFFFFFFFFFFLL];

  return v5;
}

- (void)_updateFocusScrollBoundaryMetrics:(id)a3 forItem:(id)a4 inSection:(int64_t)a5
{
  v8 = a3;
  v9 = a4;
  if ([v8 hasDisprovedAllRelevantAssumptions])
  {
    goto LABEL_55;
  }

  if (a5 != 0x7FFFFFFFFFFFFFFFLL)
  {
    v10 = [(UICollectionView *)self _collectionViewData];
    v11 = [(UICollectionViewData *)v10 numberOfSections];

    if (a5 < 0 || v11 <= a5)
    {
      goto LABEL_55;
    }
  }

  v12 = [(UICollectionView *)self _collectionViewData];
  if (!v12)
  {
    v14 = 0;
    if (a5 != 0x7FFFFFFFFFFFFFFFLL)
    {
      goto LABEL_9;
    }

LABEL_54:
    v54.receiver = self;
    v54.super_class = UICollectionView;
    v47 = [(UIScrollView *)&v54 _focusScrollBoundaryMetricsForItem:v9, v48];
    [v8 consumeOtherMetrics:v47];

    goto LABEL_55;
  }

  v13 = v12;
  if ((*(v12 + 96) & 2) == 0)
  {
    [(UICollectionViewData *)v12 _updateItemCounts];
  }

  v14 = v13[21];

  if (a5 == 0x7FFFFFFFFFFFFFFFLL)
  {
    if (v14 > 0)
    {
      v16 = 0;
      goto LABEL_13;
    }

    goto LABEL_54;
  }

LABEL_9:
  v15 = [(UICollectionView *)self _collectionViewData];
  v16 = [(UICollectionViewData *)v15 numberOfItemsInSection:a5];

  if (v16 < 1)
  {
    goto LABEL_55;
  }

LABEL_13:
  v48 = v16;
  v53 = a5;
  objc_opt_class();
  v52 = v9;
  v17 = _UIFocusEnvironmentContainingView(v9);
  v18 = v8;
  v19 = v18;
  v20 = 0;
  v49 = v14;
  v51 = v8;
  if (v17 && v17 != self)
  {
    v20 = 0;
    while (1)
    {
      if (objc_opt_isKindOfClass())
      {
        v21 = [(UICollectionView *)v17 _collectionView];
        v22 = v21;
        if (v21 == self)
        {
          v25 = v17;

          v26 = [(UICollectionView *)self _indexPathForCell:v25];
          if (v26)
          {
            v27 = [(UICollectionView *)self _collectionViewData];
            v28 = [(UICollectionViewData *)v27 validatedGlobalIndexForItemAtIndexPath:v26];

            if (v28 != 0x7FFFFFFFFFFFFFFFLL)
            {
              v30 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:v25 scrollView:self];

              v17 = v25;
              v20 = v25;
              goto LABEL_32;
            }
          }
        }

        else if (v53 == 0x7FFFFFFFFFFFFFFFLL && v21 && [(UICollectionView *)v21 _canDeriveVisibleBoundsFromContainingScrollView])
        {
          v23 = [[_UIFocusScrollBoundaryMetrics alloc] initWithFocusItem:v52 scrollView:v22];
          [(_UIFocusScrollBoundaryMetrics *)v23 consumeOtherMetrics:v19];
          [(UICollectionView *)v22 _updateFocusScrollBoundaryMetrics:v23 forItem:v52 inSection:0x7FFFFFFFFFFFFFFFLL];
          v24 = [(_UIFocusScrollBoundaryMetrics *)v19 consumeOtherMetrics:v23];

          if (v24)
          {

            LOBYTE(v22) = 1;
            v30 = v19;
            goto LABEL_52;
          }

          v25 = v20;
        }

        else
        {
          v25 = v20;
        }

        v20 = v25;
      }

      v29 = [(UIView *)v17 superview];

      v28 = 0x7FFFFFFFFFFFFFFFLL;
      if (v29)
      {
        v17 = v29;
        if (v29 != self)
        {
          continue;
        }
      }

      v17 = v29;
      v30 = v19;
      goto LABEL_32;
    }
  }

  v30 = v18;
  v28 = 0x7FFFFFFFFFFFFFFFLL;
LABEL_32:
  if (v53 == 0x7FFFFFFFFFFFFFFFLL)
  {
    v33 = 0;
    v34 = v49;
  }

  else
  {
    v31 = [(UICollectionView *)self _collectionViewData];
    v32 = [MEMORY[0x1E696AC88] indexPathForItem:0 inSection:v53];
    v33 = [(UICollectionViewData *)v31 globalIndexForItemAtIndexPath:v32];

    v34 = v33 + v48;
  }

  v35 = objc_opt_new();
  v36 = v35;
  v37 = v33 + 5;
  if (v33 + 5 >= v34 - 1)
  {
    v37 = v34 - 1;
  }

  [v35 addIndexesInRange:{v33, v37 - v33 + 1, v48}];
  if (v34 - 6 <= v33)
  {
    v38 = v33;
  }

  else
  {
    v38 = v34 - 6;
  }

  [v36 addIndexesInRange:{v38, v34 - v38}];
  if (v28 != 0x7FFFFFFFFFFFFFFFLL)
  {
    [v36 addIndexesInRange:?];
    [v36 removeIndex:v28];
  }

  v39 = objc_opt_new();
  v55[0] = MEMORY[0x1E69E9820];
  v55[1] = 3221225472;
  v55[2] = __72__UICollectionView__updateFocusScrollBoundaryMetrics_forItem_inSection___block_invoke;
  v55[3] = &unk_1E70F3B48;
  v40 = v39;
  v56 = v40;
  v50 = v36;
  [v36 enumerateIndexesUsingBlock:v55];
  if ([v40 count])
  {
    v41 = 0;
    do
    {
      if (v41)
      {
        v42 = [v40 count] + ~(v41 >> 1);
      }

      else
      {
        v42 = v41 >> 1;
      }

      v43 = [v40 objectAtIndexedSubscript:v42];
      v44 = [v43 integerValue];

      v45 = [(UICollectionView *)self _collectionViewData];
      v46 = [(UICollectionViewData *)v45 layoutAttributesForGlobalItemIndex:v44];

      [v46 frame];
      [(_UIFocusScrollBoundaryMetrics *)v30 checkOtherRect:?];
      LODWORD(v22) = [(_UIFocusScrollBoundaryMetrics *)v19 consumeOtherMetrics:v30];

      if (v22)
      {
        break;
      }

      ++v41;
    }

    while (v41 < [v40 count]);
  }

  else
  {
    LOBYTE(v22) = 0;
  }

LABEL_52:
  v9 = v52;
  v8 = v51;
  if (v53 == 0x7FFFFFFFFFFFFFFFLL && (v22 & 1) == 0)
  {
    goto LABEL_54;
  }

LABEL_55:
}

void __72__UICollectionView__updateFocusScrollBoundaryMetrics_forItem_inSection___block_invoke(uint64_t a1, uint64_t a2)
{
  v2 = *(a1 + 32);
  v3 = [MEMORY[0x1E696AD98] numberWithUnsignedInteger:a2];
  [v2 addObject:v3];
}

- (id)targetForAction:(SEL)a3 withSender:(id)a4
{
  v6 = a4;
  v7 = [(_UICollectionViewMultiSelectController *)self->_multiSelectController targetForKeyCommands];
  v8 = objc_opt_respondsToSelector();

  if (v8)
  {
    v9 = [(_UICollectionViewMultiSelectController *)self->_multiSelectController targetForKeyCommands];
  }

  else
  {
    v12.receiver = self;
    v12.super_class = UICollectionView;
    v9 = [(UIResponder *)&v12 targetForAction:a3 withSender:v6];
  }

  v10 = v9;

  return v10;
}

- (id)_targetIndexPathForMoveOfItemFromOriginalIndexPath:(id)a3 atCurrentIndexPath:(id)a4 toProposedIndexPath:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x40000) != 0)
  {
    v12 = [(UICollectionView *)self _delegateProxy];
    v13 = [v12 collectionView:self targetIndexPathForMoveOfItemFromOriginalIndexPath:v8 atCurrentIndexPath:v9 toProposedIndexPath:v10];
  }

  else if ((collectionViewFlags & 0x20000) != 0)
  {
    v12 = [(UICollectionView *)self _delegateProxy];
    v13 = [v12 collectionView:self targetIndexPathForMoveFromItemAtIndexPath:v9 toProposedIndexPath:v10];
  }

  else
  {
    if ((collectionViewFlags & 0x10000) == 0)
    {
      goto LABEL_8;
    }

    v12 = [(UICollectionView *)self _delegateProxy];
    v13 = [v12 _collectionView:self targetIndexPathForMoveFromItemAtIndexPath:v9 toProposedIndexPath:v10];
  }

  v14 = v13;

  v10 = v14;
LABEL_8:

  return v10;
}

- (BOOL)_canReorderItemAtIndexPath:(id)a3
{
  v4 = a3;
  if (!v4 || ![(UICollectionView *)self _dataSourceSupportsReordering])
  {
    goto LABEL_13;
  }

  if (![(UICollectionView *)self _dataSourceImplementsReorderingHandlers])
  {
    collectionViewFlags = self->_collectionViewFlags;
    v5 = *(&self->_collectionViewFlags + 1);
    if ((v5 & 1) == 0 || (collectionViewFlags & 0x8000000000000000) == 0)
    {
      if ((~collectionViewFlags & 0xC00000000000000) == 0)
      {
        v7 = [(UICollectionView *)self _dataSourceProxy];
        v8 = [v7 _collectionView:self canMoveItemAtIndexPath:v4];
        goto LABEL_7;
      }

      if ((v5 & 0x10) == 0 || dyld_program_sdk_at_least())
      {
        v9 = (collectionViewFlags & 0x800000000000000 | v5 & 1) != 0;
        goto LABEL_14;
      }

LABEL_13:
      v9 = 0;
      goto LABEL_14;
    }
  }

  v7 = [(UICollectionView *)self _dataSourceProxy];
  v8 = [v7 collectionView:self canMoveItemAtIndexPath:v4];
LABEL_7:
  v9 = v8;

LABEL_14:
  return v9;
}

- (BOOL)_canBeginReorderingItem
{
  v3 = [(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin];
  if (v3)
  {
    dragAndDropController = self->_dragAndDropController;

    LOBYTE(v3) = [(_UICollectionViewDragAndDropController *)dragAndDropController canBeginReorderingSession];
  }

  return v3;
}

- (BOOL)_beginReorderingItemAtIndexPath:(id)a3 isLegacyMovement:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  if ((!v4 || [(UICollectionView *)self _canBeginReorderingItem]) && ((dragAndDropController = self->_dragAndDropController) == 0 ? (sessionKind = 0) : (sessionKind = dragAndDropController->_sessionKind), [(UICollectionView *)self _canReorderItemAtIndexPath:v6]|| (sessionKind & 0xFFFFFFFFFFFFFFFELL) == 2))
  {
    [(UICollectionView *)self _resetPrefetchState];
    v10 = [(UICollectionView *)self _cellForItemAtIndexPath:v6];
    v11 = [v10 _layoutAttributes];
    [v11 center];
    v13 = v12;
    v15 = v14;

    [(_UIDragFeedbackGenerator *)self->_reorderFeedbackGenerator userInteractionStartedAtLocation:v13, v15];
    if (sessionKind == 1)
    {
      [(_UIDragSnappingFeedbackGenerator *)self->_reorderFeedbackGenerator draggedObjectLiftedAtLocation:v13, v15];
    }

    [(_UICollectionViewDragAndDropController *)self->_dragAndDropController beginReorderingForItemAtIndexPath:v6 cell:v10];
    v16 = [(UICollectionView *)self _cellForItemAtIndexPath:v6];

    self->_reorderingTargetPosition.x = v13;
    self->_reorderingTargetPosition.y = v15;
    [(UICollectionView *)self _reparentViewIntoSelf:v16];
    v17 = [(UICollectionViewData *)self->_collectionViewData layoutAttributesForItemAtIndexPath:v6];
    if (dyld_program_sdk_at_least())
    {
      v18 = [(UIView *)self traitCollection];
      v19 = [v18 userInterfaceIdiom];

      if (v19 == 6)
      {
        if (dyld_program_sdk_at_least())
        {
          v20 = 6;
        }

        else
        {
          v20 = 4;
        }

        v22[0] = MEMORY[0x1E69E9820];
        v22[1] = 3221225472;
        v22[2] = __69__UICollectionView__beginReorderingItemAtIndexPath_isLegacyMovement___block_invoke;
        v22[3] = &unk_1E70F6228;
        v22[4] = self;
        v23 = v17;
        v24 = v16;
        [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v20 options:v22 animations:0 completion:?];
      }

      else
      {
        [(UICollectionView *)self _applyLayoutAttributes:v17 toView:v16];
      }
    }

    else
    {
      -[UICollectionView _addControlledSubview:atZIndex:forced:initialAttributes:](self, "_addControlledSubview:atZIndex:forced:initialAttributes:", v16, [v17 zIndex], 1, 0);
    }

    v9 = 1;
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (void)updateInteractiveMovementTargetPosition:(CGPoint)targetPosition
{
  y = targetPosition.y;
  x = targetPosition.x;
  [(UICollectionView *)self _updateReorderingTargetPosition:?];
  reorderFeedbackGenerator = self->_reorderFeedbackGenerator;

  [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator positionUpdatedAtLocation:x, y];
}

- (void)_updateReorderingTargetPosition:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  if ([(UICollectionView *)self _isReordering])
  {
    v6 = self->_reorderingTargetPosition.x;
    v7 = self->_reorderingTargetPosition.y;
    if (v6 != x || v7 != y)
    {
      self->_reorderingTargetPosition.x = x;
      self->_reorderingTargetPosition.y = y;
      v9 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController updateReorderingForTargetPosition:y];
      v10 = [v9 count];
      layout = self->_layout;
      v12 = [v9 allValues];
      v13 = [v9 allKeys];
      v14 = [(UICollectionViewLayout *)layout _invalidationContextForReorderingTargetPosition:v12 targetIndexPaths:v13 withPreviousPosition:x previousIndexPaths:y, v6, v7];

      v22[0] = MEMORY[0x1E69E9820];
      v22[1] = 3221225472;
      v22[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke;
      v22[3] = &unk_1E70F5B18;
      v22[4] = self;
      v25 = v10 != 0;
      v15 = v9;
      v23 = v15;
      v16 = v14;
      v24 = v16;
      v17 = [(UICollectionView *)self _performShadowUpdates:v22];
      if (v10)
      {
        reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
        v21[0] = MEMORY[0x1E69E9820];
        v21[1] = 3221225472;
        v21[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_4;
        v21[3] = &unk_1E70F6848;
        v21[4] = self;
        *&v21[5] = x;
        *&v21[6] = y;
        [(UIFeedbackGenerator *)reorderFeedbackGenerator performFeedbackWithDelay:v21 insideBlock:0.05];
      }

      dragAndDropController = self->_dragAndDropController;
      if (!dragAndDropController || dragAndDropController->_sessionKind != 2)
      {
        v20 = [(UIScrollView *)self _autoScrollAssistant];
        [v20 autoScrollFromPoint:{x, y}];
      }
    }
  }
}

void __52__UICollectionView__updateReorderingTargetPosition___block_invoke(uint64_t a1)
{
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_2;
  v5[3] = &unk_1E70F5AF0;
  v8 = *(a1 + 56);
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v4 = *(a1 + 32);
  v6 = v3;
  v7 = v4;
  [v2 _performBatchUpdates:v5 completion:0 invalidationContext:*(a1 + 48) tentativelyForReordering:1];
}

uint64_t __52__UICollectionView__updateReorderingTargetPosition___block_invoke_2(uint64_t result)
{
  if (*(result + 48) == 1)
  {
    v4[5] = v1;
    v4[6] = v2;
    v4[0] = MEMORY[0x1E69E9820];
    v4[1] = 3221225472;
    v4[2] = __52__UICollectionView__updateReorderingTargetPosition___block_invoke_3;
    v4[3] = &unk_1E70FF950;
    v3 = *(result + 32);
    v4[4] = *(result + 40);
    return [v3 enumerateKeysAndObjectsUsingBlock:v4];
  }

  return result;
}

void __52__UICollectionView__updateReorderingTargetPosition___block_invoke_3(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v6 = [*(a1 + 32) _indexPathBeforeShadowUpdatesForIndexPath:?];
  [*(a1 + 32) _accessibilityPostReorderingAnnouncementForCurrentIndexPath:v6 targetIndexPath:a3 previousIndexPath:a2];
  [*(a1 + 32) _moveItemAtIndexPath:a2 toIndexPath:a3];
}

- (id)_autoScrollAssistantForIndexPath:(id)a3
{
  v4 = a3;
  if (v4 && [(_UICollectionViewOrthogonalScrollerSectionController *)self->_orthogonalScrollerController isIndexPathInOrthogonalScrollingSection:v4])
  {
    v5 = [(_UICollectionViewOrthogonalScrollerSectionController *)&self->_orthogonalScrollerController->super.isa autoScrollAssistantForOrthogonalScrollingSectionAtIndexPath:v4];
  }

  else
  {
    v5 = [(UIScrollView *)self _autoScrollAssistant];
  }

  v6 = v5;

  return v6;
}

- (void)_autoScrollAssistantUpdateContentOffset:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  [(UIScrollView *)self contentOffset];
  v7 = v6;
  v9 = v8;
  v10 = [(UICollectionViewLayout *)self->_layout _layoutAxis];
  if (v10 - 1 > 1 || ((v11 = v10, [(UIView *)self bounds], v33 = v13, v34 = v12, [(UIScrollView *)self contentSize], v32 = v14, v16 = v15, [(UIScrollView *)self adjustedContentInset], v35 = v7, v18 = v17, v20 = v19, v22 = v21, v24 = v23, v25 = [(UIView *)self effectiveUserInterfaceLayoutDirection], v25 != UIUserInterfaceLayoutDirectionRightToLeft) ? (v26 = v24) : (v26 = v20), v25 != UIUserInterfaceLayoutDirectionRightToLeft ? (v27 = v20) : (v27 = v24), v28 = _UITotalEdgeDimensionsForLayoutAxis(v11, v18, v27, v22, v26), v29 = v28 + _UISizeValueForAxis(v11, v32, v16), v30 = v29 - _UISizeValueForAxis(v11, v34, v33), v31 = _UIPointValueForAxis(v11, x, y) > v30, v7 = v35, !v31))
  {
    v36.receiver = self;
    v36.super_class = UICollectionView;
    [(UIScrollView *)&v36 _autoScrollAssistantUpdateContentOffset:x, y];
    if (![(UIScrollView *)self isPagingEnabled])
    {
      [(UICollectionView *)self _updateReorderingTargetPosition:x - v7 + self->_reorderingTargetPosition.x, y - v9 + self->_reorderingTargetPosition.y];
    }
  }
}

- (void)_completeInteractiveMovementWithDisposition:(int64_t)a3
{
  v82 = *MEMORY[0x1E69E9840];
  if (self)
  {
    dragAndDropController = self->_dragAndDropController;
    if (dragAndDropController)
    {
      if ([(NSMutableArray *)dragAndDropController->__reorderedItems count])
      {
        p_collectionViewFlags = &self->_collectionViewFlags;
        v7 = *(&self->_collectionViewFlags + 1);
        if ((v7 & 0x2000000000000000) == 0)
        {
          *(&self->_collectionViewFlags + 1) = v7 | 0x2000000000000000;
          [(UICollectionView *)self _removeReorderDestinationView];
          v8 = a3 - 1;
          x = self->_reorderingTargetPosition.x;
          y = self->_reorderingTargetPosition.y;
          if ((a3 - 1) > 1)
          {
            v77 = 0;
            [(UICollectionView *)self _getOriginalReorderingIndexPaths:0 targetIndexPaths:&v77];
            v11 = v77;
            v12 = v11;
          }

          else if (a3 == 2)
          {
            v11 = 0;
            v12 = 0;
          }

          else
          {
            v79 = 0;
            v78 = 0;
            [(UICollectionView *)self _getOriginalReorderingIndexPaths:&v79 targetIndexPaths:&v78];
            v12 = v79;
            v11 = v78;
          }

          v13 = [(UIScrollView *)self _autoScrollAssistant];
          [v13 stop];

          reorderFeedbackGenerator = self->_reorderFeedbackGenerator;
          if (v8 >= 2)
          {
            [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator userInteractionEndedAtLocation:x, y];
          }

          else
          {
            [(_UIDragFeedbackGenerator *)reorderFeedbackGenerator userInteractionCancelledAtLocation:x, y];
            if (a3 == 2)
            {
LABEL_15:
              v15 = [(UICollectionView *)self _reorderedItems];
              v16 = self->_dragAndDropController;
              if (v16)
              {
                sessionKind = v16->_sessionKind;
              }

              else
              {
                sessionKind = 0;
              }

              v53 = [(UICollectionView *)self _dataSourceImplementsReorderingHandlers];
              v76 = 1;
              v18 = self->_dragAndDropController;
              if (v8 >= 2)
              {
                v49 = (a3 - 1) < 2;
                v50 = v11;
                v51 = v12;
                v48 = [(_UICollectionViewDragAndDropController *)v18 endReordering];
              }

              else
              {
                v19 = [(_UICollectionViewDragAndDropController *)v18 cancelReorderingForced:&v76 shouldCancelUsingBatchUpdate:?];
                v20 = v19;
                if (a3 == 2 && (v76 & 1) == 0)
                {
                  if (!v19)
                  {
                    goto LABEL_75;
                  }

                  [(UICollectionView *)self _addReloadDataCompletionBlock:v19];
LABEL_74:

LABEL_75:
                  *(p_collectionViewFlags + 1) &= ~0x2000000000000000uLL;

                  return;
                }

                v48 = v19;
                v49 = (a3 - 1) < 2;
                v50 = v11;
                v51 = v12;
              }

              v74 = 0u;
              v75 = 0u;
              v72 = 0u;
              v73 = 0u;
              v52 = v15;
              v21 = v15;
              v22 = [v21 countByEnumeratingWithState:&v72 objects:v81 count:16];
              if (v22)
              {
                v23 = v22;
                v24 = *v73;
                do
                {
                  v25 = 0;
                  do
                  {
                    if (*v73 != v24)
                    {
                      objc_enumerationMutation(v21);
                    }

                    v26 = *(*(&v72 + 1) + 8 * v25);
                    v27 = [v26 originalIndexPath];
                    v28 = [v26 targetIndexPath];
                    if (([v27 isEqual:v28] & 1) == 0)
                    {
                      if (sessionKind == 1)
                      {
                        if ((*(p_collectionViewFlags + 8) & 1) != 0 || [(UICollectionView *)self _dataSourceImplementsReorderingHandlers])
                        {
                          if (v8 > 1)
                          {
                            [(UICollectionView *)self _notifyDataSourceForMoveOfItemFromIndexPath:v27 toIndexPath:v28];
                          }

                          else if (!dyld_program_sdk_at_least() || (v29 = self->_dragAndDropController) != 0 && v29->_sessionKind != 3)
                          {
                            objc_storeStrong(&self->_cancellingToIndexPath, v27);
                            v71[0] = MEMORY[0x1E69E9820];
                            v71[1] = 3221225472;
                            v71[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke;
                            v71[3] = &unk_1E70FEEC8;
                            v71[4] = self;
                            v71[5] = v28;
                            v71[6] = v27;
                            [(UICollectionView *)self _performInternalBatchUpdates:v71];
                            cancellingToIndexPath = self->_cancellingToIndexPath;
                            self->_cancellingToIndexPath = 0;
                            p_collectionViewFlags = &self->_collectionViewFlags;
                          }
                        }

                        else if (v8 >= 2 && (*p_collectionViewFlags & 0x800000000000000) != 0)
                        {
                          v33 = [(UICollectionView *)self _dataSourceProxy];
                          [v33 _collectionView:self moveItemAtIndexPath:v27 toIndexPath:v28];

                          p_collectionViewFlags = &self->_collectionViewFlags;
                        }
                      }

                      else if (v8 > 1)
                      {
                        if ((sessionKind & 0xFFFFFFFFFFFFFFFELL) != 2 || !v53 && [(UICollectionView *)self _supportsAutomaticCatalystDragAndDropReordering])
                        {
                          v69[0] = MEMORY[0x1E69E9820];
                          v69[1] = 3221225472;
                          v69[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_3;
                          v69[3] = &unk_1E70FEEC8;
                          v69[4] = self;
                          v69[5] = v27;
                          v69[6] = v28;
                          [(UICollectionView *)self _performInternalBatchUpdates:v69];
                        }
                      }

                      else
                      {
                        v31 = self->_dragAndDropController;
                        if (v31 && v31->_sessionKind != 3)
                        {
                          v70[0] = MEMORY[0x1E69E9820];
                          v70[1] = 3221225472;
                          v70[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_2;
                          v70[3] = &unk_1E70FEEC8;
                          v70[4] = self;
                          v70[5] = v28;
                          v70[6] = v27;
                          v32 = [(UICollectionView *)self _performShadowUpdates:v70];
                        }
                      }
                    }

                    ++v25;
                  }

                  while (v23 != v25);
                  v34 = [v21 countByEnumeratingWithState:&v72 objects:v81 count:16];
                  v23 = v34;
                }

                while (v34);
              }

              v67 = 0u;
              v68 = 0u;
              v65 = 0u;
              v66 = 0u;
              v35 = v21;
              v36 = [v35 countByEnumeratingWithState:&v65 objects:v80 count:16];
              if (v36)
              {
                v37 = v36;
                v38 = *v66;
                v39 = 1;
                do
                {
                  for (i = 0; i != v37; ++i)
                  {
                    if (*v66 != v38)
                    {
                      objc_enumerationMutation(v35);
                    }

                    v41 = [*(*(&v65 + 1) + 8 * i) cell];
                    subviewManager = self->_subviewManager;
                    if (subviewManager && [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:v41])
                    {
                      if ((dyld_program_sdk_at_least() & 1) == 0)
                      {
                        [v41 _invalidatePreferredAttributes];
                      }
                    }

                    else
                    {
                      v39 = 0;
                    }
                  }

                  v37 = [v35 countByEnumeratingWithState:&v65 objects:v80 count:16];
                }

                while (v37);
              }

              else
              {
                v39 = 1;
              }

              aBlock[0] = MEMORY[0x1E69E9820];
              aBlock[1] = 3221225472;
              aBlock[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_5;
              aBlock[3] = &unk_1E70FF978;
              v63 = sessionKind == 1;
              aBlock[4] = self;
              v12 = v51;
              v60 = v51;
              v11 = v50;
              v61 = v50;
              v64 = v49;
              v43 = v35;
              v62 = v43;
              v44 = _Block_copy(aBlock);
              v55[0] = MEMORY[0x1E69E9820];
              v55[1] = 3221225472;
              v55[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_6;
              v55[3] = &unk_1E70F8A38;
              v57 = v39 & 1;
              v58 = sessionKind == 1;
              v55[4] = self;
              v56 = v43;
              v45 = _Block_copy(v55);
              if (dyld_program_sdk_at_least())
              {
                v46 = 6;
              }

              else
              {
                v46 = 4;
              }

              [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v46 options:v44 animations:v45 completion:?];
              v20 = v48;
              if (v48)
              {
                (*(v48 + 16))(v48);
              }

              p_collectionViewFlags = &self->_collectionViewFlags;
              v15 = v52;
              if (v8 >= 2 && sessionKind == 1)
              {
                v47 = self->_reorderFeedbackGenerator;
                v54[0] = MEMORY[0x1E69E9820];
                v54[1] = 3221225472;
                v54[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_8;
                v54[3] = &unk_1E70F6848;
                v54[4] = self;
                *&v54[5] = x;
                *&v54[6] = y;
                [(UIFeedbackGenerator *)v47 performFeedbackWithDelay:v54 insideBlock:0.3];
              }

              goto LABEL_74;
            }
          }

          [(UIView *)self layoutBelowIfNeeded];
          goto LABEL_15;
        }
      }
    }
  }
}

uint64_t __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_3(uint64_t a1)
{
  v2[0] = MEMORY[0x1E69E9820];
  v2[1] = 3221225472;
  v2[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_4;
  v2[3] = &unk_1E70FEEC8;
  v3 = *(a1 + 32);
  v4 = *(a1 + 48);
  return [v3 performBatchUpdates:v2 completion:0];
}

void __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_5(uint64_t a1)
{
  v35 = *MEMORY[0x1E69E9840];
  if (*(a1 + 64) == 1)
  {
    v2 = *(*(a1 + 32) + 2152);
    v3 = [v2 _invalidationContextForEndingReorderingItemToFinalIndexPaths:*(a1 + 40) previousIndexPaths:*(a1 + 48) reorderingCancelled:*(a1 + 65)];
    [v2 invalidateLayoutWithContext:v3];

    v4 = *(a1 + 32);
    v5 = v4[284];
    [v4 visibleBounds];
    [(UICollectionViewData *)v5 validateLayoutInRect:v6, v7, v8, v9];
  }

  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  obj = *(a1 + 56);
  v10 = [obj countByEnumeratingWithState:&v30 objects:v34 count:16];
  if (v10)
  {
    v11 = v10;
    v29 = *v31;
    do
    {
      for (i = 0; i != v11; ++i)
      {
        if (*v31 != v29)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v30 + 1) + 8 * i);
        v14 = [v13 cell];
        if (*(a1 + 65))
        {
          [v13 originalIndexPath];
        }

        else
        {
          [v13 targetIndexPath];
        }
        v15 = ;
        v16 = [(_UICollectionViewSubviewManager *)*(*(a1 + 32) + 2984) visibleCellAtIndexPath:v15];
        if (v16)
        {
          v17 = v16 == v14;
        }

        else
        {
          v17 = 1;
        }

        v18 = !v17;

        if ((dyld_program_sdk_at_least() & 1) == 0)
        {
          v19 = *(*(a1 + 32) + 2984);
          v20 = [v13 cell];
          if (v19)
          {
            v18 |= [(_UICollectionViewSubviewCollection *)*(v19 + 8) containsView:v20];
          }
        }

        if ((v18 & 1) == 0)
        {
          v21 = *(*(a1 + 32) + 2272);
          if (v21)
          {
            if ([(UICollectionViewData *)v21 _isIndexPathValid:v15 validateItemCounts:1])
            {
              v22 = [v14 _layoutAttributes];
              v23 = [v22 indexPath];
              v24 = v15;
              v25 = v24;
              if (v23 == v24)
              {

LABEL_30:
                v22 = [*(*(a1 + 32) + 2152) layoutAttributesForItemAtIndexPath:v25];
                v27 = *(a1 + 32);
                v23 = [v13 cell];
                [v27 _applyLayoutAttributes:v22 toView:v23];
LABEL_32:

                goto LABEL_33;
              }

              if (!v24 || !v23)
              {

                goto LABEL_32;
              }

              v26 = [v23 isEqual:v24];

              if (v26)
              {
                goto LABEL_30;
              }
            }
          }
        }

LABEL_33:
      }

      v11 = [obj countByEnumeratingWithState:&v30 objects:v34 count:16];
    }

    while (v11);
  }
}

void __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_6(uint64_t a1)
{
  v38 = *MEMORY[0x1E69E9840];
  if ((*(a1 + 48) & 1) == 0)
  {
    if (*(a1 + 49) == 1)
    {
      if (*(*(a1 + 32) + 2184) <= 0)
      {
        v2 = 0;
      }

      else
      {
        v2 = 300000000;
      }

      v3 = dispatch_time(0, v2);
      block[0] = MEMORY[0x1E69E9820];
      block[1] = 3221225472;
      block[2] = __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_7;
      block[3] = &unk_1E70F3590;
      block[4] = *(a1 + 32);
      dispatch_after(v3, MEMORY[0x1E69E96A0], block);
    }

    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    v4 = *(a1 + 40);
    v5 = [v4 countByEnumeratingWithState:&v31 objects:v37 count:16];
    if (v5)
    {
      v6 = v5;
      v7 = *v32;
      do
      {
        v8 = 0;
        do
        {
          if (*v32 != v7)
          {
            objc_enumerationMutation(v4);
          }

          v9 = [*(*(&v31 + 1) + 8 * v8) cell];
          v10 = [v9 superview];
          if (v10)
          {
            v11 = v10;
            v12 = *(*(a1 + 32) + 2984);
            if (v12)
            {
              v13 = [(_UICollectionViewSubviewCollection *)*(v12 + 8) containsView:v9];

              if (v13)
              {
                goto LABEL_16;
              }
            }

            else
            {
            }

            [v9 removeFromSuperview];
          }

LABEL_16:

          ++v8;
        }

        while (v6 != v8);
        v14 = [v4 countByEnumeratingWithState:&v31 objects:v37 count:16];
        v6 = v14;
      }

      while (v14);
    }
  }

  v29 = 0u;
  v30 = 0u;
  v27 = 0u;
  v28 = 0u;
  v15 = *(a1 + 40);
  v16 = [v15 countByEnumeratingWithState:&v27 objects:v36 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v28;
    do
    {
      for (i = 0; i != v17; ++i)
      {
        if (*v28 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v27 + 1) + 8 * i);
        v21 = [v20 cell];
        v22 = [v21 superview];
        if (v22)
        {
          v23 = v22;
          v24 = [v20 cell];
          v25 = [v24 _isHiddenForReuse];

          if (v25)
          {
            continue;
          }

          v26 = *(a1 + 32);
          v21 = [v20 cell];
          [v26 _reparentViewIntoCorrectContainer:v21];
        }
      }

      v17 = [v15 countByEnumeratingWithState:&v27 objects:v36 count:16];
    }

    while (v17);
  }
}

uint64_t __64__UICollectionView__completeInteractiveMovementWithDisposition___block_invoke_7(uint64_t a1)
{
  result = [*(*(a1 + 32) + 2152) _estimatesSizes];
  if (result)
  {
    v3 = *(a1 + 32);

    return [v3 _setNeedsVisibleCellsUpdate:1 withLayoutAttributes:1];
  }

  return result;
}

- (void)_notifyDataSourceForMoveOfItemFromIndexPath:(id)a3 toIndexPath:(id)a4
{
  if ((*(&self->_collectionViewFlags + 8) & 0x10) != 0)
  {
    v9 = a4;
    v10 = a3;
    v11 = [[UICollectionViewUpdateItem alloc] initWithInitialIndexPath:v10 finalIndexPath:v9 updateAction:3];
    expectedDiffableUpdateItem = self->_expectedDiffableUpdateItem;
    self->_expectedDiffableUpdateItem = v11;

    v13 = [(UICollectionView *)self _dataSourceProxy];
    [v13 collectionView:self moveItemAtIndexPath:v10 toIndexPath:v9];

    v8 = self->_expectedDiffableUpdateItem;
    self->_expectedDiffableUpdateItem = 0;
  }

  else
  {
    v6 = a4;
    v7 = a3;
    v14 = [(UICollectionView *)self _dataSourceProxy];
    [(UICollectionViewUpdateItem *)v14 collectionView:self moveItemAtIndexPath:v7 toIndexPath:v6];

    v8 = v14;
  }
}

- (void)_getOriginalReorderingIndexPaths:(id *)a3 targetIndexPaths:(id *)a4
{
  v26 = *MEMORY[0x1E69E9840];
  if (self && (dragAndDropController = self->_dragAndDropController) != 0)
  {
    v8 = [(NSMutableArray *)dragAndDropController->__reorderedItems count];
  }

  else
  {
    v8 = 0;
  }

  if (a3)
  {
    v9 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v8];
    if (a4)
    {
LABEL_6:
      v10 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:v8];
      goto LABEL_9;
    }
  }

  else
  {
    v9 = 0;
    if (a4)
    {
      goto LABEL_6;
    }
  }

  v10 = 0;
LABEL_9:
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v11 = [(UICollectionView *)self _reorderedItems];
  v12 = [v11 countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v22;
    do
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v22 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v21 + 1) + 8 * i);
        v17 = [v16 originalIndexPath];
        [v9 addObject:v17];

        v18 = [v16 targetIndexPath];
        [v10 addObject:v18];
      }

      v13 = [v11 countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v13);
  }

  if (a3)
  {
    v19 = v9;
    *a3 = v9;
  }

  if (a4)
  {
    v20 = v10;
    *a4 = v10;
  }
}

- (void)_removeReorderDestinationView
{
  reorderDestinationView = self->_reorderDestinationView;
  if (reorderDestinationView)
  {
    [(UIView *)reorderDestinationView removeFromSuperview];
    v4 = self->_reorderDestinationView;
    self->_reorderDestinationView = 0;
  }
}

- (void)_updateReorderDestinationViewWithLayoutAttributes:(id)a3
{
  v4 = a3;
  v16 = v4;
  if (!self->_reorderDestinationView)
  {
    v5 = [(UIView *)self traitCollection];
    v6 = v5;
    if (v5)
    {
      _UIRecordTraitUsage(v5, 0x13uLL);
      v7 = v6[16] == 2;
    }

    else
    {
      v7 = 0;
    }

    v8 = [[_UIDragDestinationIndicatorView alloc] initWithSourceListStyle:v7];
    reorderDestinationView = self->_reorderDestinationView;
    self->_reorderDestinationView = v8;

    [(UIView *)self addSubview:self->_reorderDestinationView];
    v4 = v16;
  }

  [v4 size];
  v11 = v10;
  v13 = v12;
  v14 = self->_reorderDestinationView;
  [v16 frame];
  if (v11 <= v13)
  {
    [(_UIDragDestinationIndicatorView *)v14 positionHorizontallyCenteredInFrame:?];
  }

  else
  {
    [(_UIDragDestinationIndicatorView *)v14 positionVerticallyCenteredInFrame:?];
  }

  v15 = [v16 indexPath];
  [(_UIDragDestinationIndicatorView *)self->_reorderDestinationView setCurrentIndexPath:v15];
}

- (void)_cellDidBecomeFocused:(id)a3
{
  v7 = [(UICollectionView *)self _indexPathForCell:a3];
  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x100000) != 0)
  {
    v5 = [(UICollectionView *)self _delegateProxy];
    [v5 _collectionView:self didFocusItemAtIndexPath:v7];

    collectionViewFlags = self->_collectionViewFlags;
  }

  if ((collectionViewFlags & 0x400000) != 0)
  {
    v6 = [(UICollectionView *)self _delegateProxy];
    [v6 collectionView:self didFocusItemAtIndexPath:v7];
  }
}

- (void)_cellDidBecomeUnfocused:(id)a3
{
  v4 = [(UICollectionView *)self _indexPathForCell:a3];
  if ((*(&self->_collectionViewFlags + 2) & 0x80) != 0)
  {
    v6 = v4;
    v5 = [(UICollectionView *)self _delegateProxy];
    [v5 collectionView:self didUnfocusItemAtIndexPath:v6];

    v4 = v6;
  }
}

- (BOOL)_shouldUpdateFocusInContext:(id)a3
{
  v4 = a3;
  v12.receiver = self;
  v12.super_class = UICollectionView;
  v5 = [(UIScrollView *)&v12 _shouldUpdateFocusInContext:v4];
  if (![(UICollectionView *)self _isMovingFocusFromHorizontalIndexBarToCellContent:v4])
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x8000000) != 0)
    {
      v7 = [UICollectionViewFocusUpdateContext _contextWithContext:v4 collectionView:self];
      v8 = [(UICollectionView *)self _delegateProxy];
      v5 = [v8 collectionView:self shouldUpdateFocusInContext:v7];
    }

    else
    {
      if ((collectionViewFlags & 0x2000000) == 0)
      {
        goto LABEL_10;
      }

      v7 = [UICollectionViewFocusUpdateContext _contextWithContext:v4 collectionView:self];
      v8 = [(UICollectionView *)self _delegateProxy];
      v9 = [v7 previouslyFocusedIndexPath];
      v10 = [v7 nextFocusedView];
      v5 = [v8 collectionView:self shouldUpdateFocusFromItemAtIndexPath:v9 toView:v10 heading:{objc_msgSend(v7, "focusHeading")}];
    }

    goto LABEL_10;
  }

  if (![(UIScrollView *)self isScrollAnimating])
  {
    [(UICollectionView *)self setIsMovingFocusFromHorizontalIndexTitleBarToContent:1];
    [(UIView *)self setNeedsFocusUpdate];
  }

  v5 = 0;
LABEL_10:

  return v5;
}

- (id)_managedSubviewForView:(id)a3
{
  v4 = a3;
  v5 = v4;
  v6 = 0;
  v7 = v4;
  if (v4 && v4 != self)
  {
    v8 = v4;
    while (1)
    {
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v9 = v8;
        v10 = [(UICollectionView *)v9 _layoutAttributes];

        if (v10)
        {
          v10 = [(UICollectionView *)v9 _collectionView];
        }
      }

      else
      {
        v10 = 0;
      }

      if (v10 == self)
      {
        break;
      }

      v7 = [(UIView *)v8 superview];

      v6 = 0;
      if (v7)
      {
        v8 = v7;
        if (v7 != self)
        {
          continue;
        }
      }

      goto LABEL_14;
    }

    v7 = v8;

    v6 = v7;
  }

LABEL_14:

  return v6;
}

- (BOOL)_canReusePreviouslyFocusedManagedSubview:(id)a3
{
  v25 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if (!v4)
  {
    goto LABEL_22;
  }

  v5 = [(UICollectionView *)self _focusedItemState];
  v6 = v5;
  if (v5)
  {
    v7 = *(v5 + 8);
  }

  else
  {
    v7 = 0;
  }

  v8 = v7;
  if (v8 == v4)
  {

LABEL_22:
    v18 = 0;
    goto LABEL_23;
  }

  firstResponderView = self->_firstResponderView;

  if (firstResponderView == v4)
  {
    goto LABEL_22;
  }

  if ([(UICollectionReusableView *)v4 _isInUpdateAnimation])
  {
    goto LABEL_22;
  }

  if (([(_UICollectionViewSubviewManager *)self->_subviewManager isViewInReuseQueue:v4]& 1) != 0)
  {
    goto LABEL_22;
  }

  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    if (([(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews containsView:v4]& 1) != 0)
    {
      goto LABEL_22;
    }
  }

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v11 = [(NSMutableDictionary *)self->_prefetchCacheItems objectEnumerator];
  v12 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v21;
    while (2)
    {
      for (i = 0; i != v13; ++i)
      {
        if (*v21 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v20 + 1) + 8 * i);
        if (v16)
        {
          v16 = v16[3];
        }

        v17 = v16;

        if (v17 == v4)
        {
          v18 = 0;
          goto LABEL_25;
        }
      }

      v13 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
      if (v13)
      {
        continue;
      }

      break;
    }
  }

  v18 = 1;
LABEL_25:

LABEL_23:
  return v18;
}

- (void)_reusePreviouslyFocusedManagedSubviewIfNeeded:(id)a3
{
  v13 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if ([(UICollectionView *)self _canReusePreviouslyFocusedManagedSubview:v4])
  {
    CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionViewCellLifeCycle", &_reusePreviouslyFocusedManagedSubviewIfNeeded____s_category);
    if (*CategoryCachedImpl)
    {
      v8 = *(CategoryCachedImpl + 8);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
      {
        v9 = 134218242;
        v10 = self;
        v11 = 2112;
        v12 = v4;
        _os_log_impl(&dword_188A29000, v8, OS_LOG_TYPE_ERROR, "[UICV %p] Reusing previously focused managed subview %@", &v9, 0x16u);
      }
    }

    v6 = [v4 _layoutAttributes];
    if (v6 && (v7 = v6[72], v6, (v7 & 1) != 0))
    {
      [(UICollectionView *)self _reuseCell:v4];
    }

    else
    {
      [(UICollectionView *)self _reuseSupplementaryView:v4];
    }
  }
}

- (BOOL)_shouldSelectionFollowFocusForIndexPath:(id)a3 initiatedBySelection:(BOOL)a4 focusItemStateCandidate:(id)a5
{
  v6 = a4;
  v8 = a3;
  v9 = a5;
  if (_AXSFullKeyboardAccessEnabled())
  {
    goto LABEL_2;
  }

  if (!dyld_program_sdk_at_least() || !v6 || ![(_UICollectionViewMultiSelectController *)self->_multiSelectController isInMultiselectInteraction])
  {
    goto LABEL_11;
  }

  if (v9)
  {
    v12 = v9;
  }

  else
  {
    v12 = [(UICollectionView *)self _focusedItemState];
    if (!v12)
    {
      goto LABEL_11;
    }
  }

  v13 = [(UICollectionView *)self _indexPathsForSelectedItems];
  v14 = v12[2];
  v15 = [v13 containsObject:v14];

  if ((v15 & 1) == 0)
  {
LABEL_11:
    if (!v6)
    {
      v16 = [(UICollectionView *)self _cellForItemAtIndexPath:v8];
      v17 = v16;
      if (v16 && ([v16 _hasCustomSelectionAction] & 1) != 0)
      {
        v10 = 0;
        goto LABEL_20;
      }
    }

    v18 = !v6;
    v19 = [(UICollectionView *)self selectionFollowsFocus];
    v10 = v19;
    if ((v18 & v19 & (v8 != 0)) != 1)
    {
      goto LABEL_3;
    }

    if ((*(&self->_collectionViewFlags + 6) & 4) == 0)
    {
      v10 = 1;
      goto LABEL_3;
    }

    v17 = [(UICollectionView *)self _delegateProxy];
    v10 = [v17 collectionView:self selectionFollowsFocusForItemAtIndexPath:v8];
LABEL_20:

    goto LABEL_3;
  }

LABEL_2:
  v10 = 0;
LABEL_3:

  return v10 & 1;
}

- (void)_willUpdateFocusInContext:(id)a3
{
  v4 = [a3 nextFocusedItem];
  v5 = _UIFocusEnvironmentFirstCommonAncestor(v4, self);

  if ((v5 == self) == ((*(&self->_collectionViewFlags + 1) & 0x4000000) == 0))
  {
    *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFFFFFFFBFFFFFFLL | ((v5 == self) << 26);

    [(UICollectionView *)self _updateSelectionIsKey];
  }
}

- (void)_didUpdateFocusInContext:(id)a3
{
  v106 = *MEMORY[0x1E69E9840];
  v5 = a3;
  if ([(UICollectionView *)self _isMovingFocusFromHorizontalIndexBarToCellContent:v5])
  {
    [(UICollectionView *)self setSelectedIndexTitleEntry:0];
    [(UICollectionView *)self setIsMovingFocusFromHorizontalIndexTitleBarToContent:0];
    [(UICollectionView *)self setIndexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar:0];
  }

  v6 = [(UICollectionView *)self _focusedItemState];
  v7 = [v5 previouslyFocusedView];
  v8 = [(UICollectionView *)self _managedSubviewForView:v7];

  if (v6)
  {
    v9 = *(v6 + 16);
    [(UICollectionView *)self _unhighlightItemAtIndexPath:v9 animated:0 notifyDelegate:1];
  }

  targetFocusedItemState = self->_targetFocusedItemState;
  self->_targetFocusedItemState = 0;

  v11 = [v5 nextFocusedView];
  v12 = v11;
  if (v11 == self)
  {

    goto LABEL_16;
  }

  v13 = [v5 nextFocusedView];
  v14 = [v13 isDescendantOfView:self];

  if (!v14)
  {
LABEL_16:
    [(UICollectionView *)self _setFocusedItemState:0];
    goto LABEL_30;
  }

  v15 = [v5 nextFocusedView];
  v16 = [(UICollectionView *)self _managedSubviewForView:v15];

  if (v16 && v16 != self->_viewBeingPreparedForReuse)
  {
    has_internal_diagnostics = os_variant_has_internal_diagnostics();
    v18 = [(UIView *)v16 isHidden];
    if (has_internal_diagnostics)
    {
      if (!v18)
      {
        [(UIView *)v16 alpha];
        if (v90 > 0.0)
        {
LABEL_12:
          v20 = [(UICollectionReusableView *)v16 _layoutAttributes];
          v21 = v20;
          if (v20 && (*(v20 + 288) & 1) != 0)
          {
            v22 = [(UICollectionView *)self _indexPathForCell:v16];
          }

          else
          {
            v22 = [(UICollectionView *)self indexPathForSupplementaryView:v16];
          }

          v23 = v22;
          if (!v22)
          {
            v23 = [v21 indexPath];
          }

          v94 = a2;
          if ([(UICollectionView *)self _indexPathIsValid:v23 allowSectionItemSentinel:1])
          {
            v24 = [_UICollectionViewFocusedItemState stateWithReusableView:v16 overrideIndexPath:v23];
            [(UICollectionView *)self _setFocusedItemState:v24];

            [(UICollectionView *)self _updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:v23];
LABEL_28:

            a2 = v94;
            goto LABEL_29;
          }

          if (os_variant_has_internal_diagnostics())
          {
            v26 = __UIFaultDebugAssertLog();
            if (os_log_type_enabled(v26, OS_LOG_TYPE_FAULT))
            {
              v91 = [v5 nextFocusedView];
              v92 = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
              *buf = 138413314;
              v97 = v16;
              v98 = 2112;
              v99 = v21;
              v100 = 2112;
              v101 = v91;
              v102 = 2112;
              v103 = self;
              v104 = 2112;
              v105 = v92;
              _os_log_fault_impl(&dword_188A29000, v26, OS_LOG_TYPE_FAULT, "Attempted to move focus into a view with an invalid index path: %@; Layout attributes: %@; Focused view: %@; Collection view: %@; Data source counts: %@", buf, 0x34u);
            }
          }

          else
          {
            v25 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492620) + 8);
            if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
LABEL_27:
              [(UICollectionView *)self _setFocusedItemState:0];
              goto LABEL_28;
            }

            v26 = v25;
            v27 = [v5 nextFocusedView];
            v28 = [(UICollectionViewData *)self->_collectionViewData dataSourceCountsDescription];
            *buf = 138413314;
            v97 = v16;
            v98 = 2112;
            v99 = v21;
            v100 = 2112;
            v101 = v27;
            v102 = 2112;
            v103 = self;
            v104 = 2112;
            v105 = v28;
            _os_log_impl(&dword_188A29000, v26, OS_LOG_TYPE_ERROR, "Attempted to move focus into a view with an invalid index path: %@; Layout attributes: %@; Focused view: %@; Collection view: %@; Data source counts: %@", buf, 0x34u);
          }

          goto LABEL_27;
        }
      }

      v88 = __UIFaultDebugAssertLog();
      if (!os_log_type_enabled(v88, OS_LOG_TYPE_FAULT))
      {
LABEL_85:

        goto LABEL_12;
      }

      v89 = [v5 nextFocusedView];
      *buf = 138412546;
      v97 = v16;
      v98 = 2112;
      v99 = v89;
      _os_log_fault_impl(&dword_188A29000, v88, OS_LOG_TYPE_FAULT, "Attempting to move focus into a hidden view: %@; Focused view: %@", buf, 0x16u);
    }

    else
    {
      if (!v18)
      {
        [(UIView *)v16 alpha];
        if (v19 > 0.0)
        {
          goto LABEL_12;
        }
      }

      v87 = *(__UILogGetCategoryCachedImpl("Assert", &qword_1ED492618) + 8);
      if (!os_log_type_enabled(v87, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_12;
      }

      v88 = v87;
      v89 = [v5 nextFocusedView];
      *buf = 138412546;
      v97 = v16;
      v98 = 2112;
      v99 = v89;
      _os_log_impl(&dword_188A29000, v88, OS_LOG_TYPE_ERROR, "Attempting to move focus into a hidden view: %@; Focused view: %@", buf, 0x16u);
    }

    goto LABEL_85;
  }

  [(UICollectionView *)self _setFocusedItemState:0];
LABEL_29:

LABEL_30:
  v29 = [(UICollectionView *)self _focusedItemState];
  [(_UISelectionInteraction *)self->_selectionInteraction setEnabled:v29 != 0];

  [(UICollectionView *)self _setCurrentPromiseFulfillmentCell:0];
  v95.receiver = self;
  v95.super_class = UICollectionView;
  [(UIScrollView *)&v95 _didUpdateFocusInContext:v5];
  if (v6)
  {
    v30 = *(v6 + 8);
  }

  else
  {
    v30 = 0;
  }

  v31 = v30;
  [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v31];

  if ((dyld_program_sdk_at_least() & 1) == 0 && v8)
  {
    v32 = v6 ? *(v6 + 8) : 0;
    v33 = v32;

    if (v8 != v33)
    {
      [(UICollectionView *)self _reusePreviouslyFocusedManagedSubviewIfNeeded:v8];
    }
  }

  v34 = [(UICollectionView *)self _endOfContentFocusContainerGuide];

  if (v34)
  {
    v35 = [(UICollectionView *)self _focusedItemState];
    v36 = v35;
    if (v35)
    {
      v37 = *(v35 + 8);
    }

    else
    {
      v37 = 0;
    }

    v38 = v37;
    v39 = [(UICollectionView *)self _endOfContentFocusContainerGuide];
    [v39 setEnabled:v38 != 0];
  }

  sectionFocusGuideController = self->_sectionFocusGuideController;
  v41 = [(UICollectionView *)self _focusedItemState];
  v42 = v41;
  if (v41)
  {
    v43 = *(v41 + 16);
  }

  else
  {
    v43 = 0;
  }

  v44 = v43;
  [(_UICollectionViewSectionFocusGuideController *)sectionFocusGuideController updateFocusedIndexPath:v44];

  [(_UICollectionViewSectionFocusGuideController *)self->_sectionFocusGuideController performLayout];
  v45 = [(UICollectionView *)self _horizontalIndexTitleBar];
  if (v45)
  {
    v46 = v45;
    v47 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v48 = [v5 nextFocusedView];
    v49 = [v47 _isViewEntryCell:v48];

    if (v49)
    {
      if (v6)
      {
        v50 = *(v6 + 16);
      }

      else
      {
        v50 = 0;
      }

      v51 = v50;
      [(UICollectionView *)self setIndexPathOfFocusedCellBeforeFocusingOnHorizontalIndexTitleBar:v51];
    }
  }

  if ((*(&self->_collectionViewFlags + 3) & 0x10) != 0)
  {
    if (v6)
    {
      v52 = *(v6 + 8);
    }

    else
    {
      v52 = 0;
    }

    v53 = v52;
    v54 = [v5 previouslyFocusedView];
    v55 = [(UICollectionView *)self _managedSubviewForView:v54];

    if (v53 == v55)
    {
      if (v6)
      {
        v57 = *(v6 + 16);
      }

      else
      {
        v57 = 0;
      }

      v56 = v57;
    }

    else
    {
      v56 = 0;
    }

    v58 = [_UIFocusAnimationCoordinatorManager animationCoordinatorForContext:v5];
    if (!v58)
    {
      v86 = [MEMORY[0x1E696AAA8] currentHandler];
      [v86 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:16546 description:@"Received call to _didUpdateFocusInContext: outside of a focus update."];
    }

    v59 = [UICollectionViewFocusUpdateContext _contextWithContext:v5 collectionView:self cachedPreviouslyFocusedIndexPath:v56];
    v60 = [(UICollectionView *)self _delegateProxy];
    [v60 collectionView:self didUpdateFocusInContext:v59 withAnimationCoordinator:v58];
  }

  if ((*(&self->_collectionViewFlags + 18) & 0x10) == 0)
  {
    v61 = [(UICollectionView *)self _focusedItemState];
    if (v61)
    {
      v62 = v61;
      v63 = [(UICollectionView *)self _focusedItemState];
      v64 = v63;
      if (v63 && *(v63 + 32))
      {
LABEL_64:

        goto LABEL_81;
      }

      v65 = [(UICollectionView *)self _focusedItemState];
      v66 = v65;
      if (v65)
      {
        v67 = *(v65 + 8);
      }

      else
      {
        v67 = 0;
      }

      v68 = v67;
      v69 = [v5 nextFocusedItem];

      if (v68 == v69)
      {
        if (dyld_program_sdk_at_least() && (*(&self->_collectionViewFlags + 18) & 0x10) == 0 && ([v5 _focusMovement], (v70 = objc_claimAutoreleasedReturnValue()) != 0) && (v71 = v70, v72 = -[UICollectionView _delegateSupportsPrimaryAction](self, "_delegateSupportsPrimaryAction"), v71, v72) || ((-[UICollectionView indexPathsForSelectedItems](self, "indexPathsForSelectedItems"), v73 = objc_claimAutoreleasedReturnValue(), -[UICollectionView _focusedItemState](self, "_focusedItemState"), v74 = objc_claimAutoreleasedReturnValue(), (v75 = v74) == 0) ? (v76 = 0) : (v76 = *(v74 + 16)), v77 = v76, v78 = objc_msgSend(v73, "containsObject:", v77), v77, v75, v73, (v78 & 1) == 0))
        {
          v79 = [(UICollectionView *)self _focusedItemState];
          v80 = v79;
          v81 = v79 ? *(v79 + 16) : 0;
          v82 = v81;
          v83 = [(UICollectionView *)self _shouldSelectionFollowFocusForIndexPath:v82 initiatedBySelection:0];

          if (v83)
          {
            v84 = [(UICollectionView *)self _focusedItemState];
            v62 = v84;
            if (v84)
            {
              v85 = *(v84 + 16);
            }

            else
            {
              v85 = 0;
            }

            v64 = v85;
            LOWORD(v93) = 0;
            [(UICollectionView *)self _selectItemAtIndexPath:v64 animated:0 scrollPosition:0 notifyDelegate:1 deselectPrevious:1 performPrimaryAction:0 performCustomSelectionAction:v93 isUserInitiated:?];
            goto LABEL_64;
          }
        }
      }
    }
  }

LABEL_81:
}

- (id)_systemDefaultFocusGroupIdentifier
{
  v3 = [(UIView *)self _focusBehavior];
  v4 = [v3 focusGroupContainmentBehavior];

  if ((v4 & 0x40) != 0)
  {
    v6 = _UIFocusGroupIdentifierOfAssociatedSearchTextFieldForView(self);
    v7 = v6;
    if (v6)
    {
      v8 = v6;
    }

    else
    {
      v11.receiver = self;
      v11.super_class = UICollectionView;
      v8 = [(UIView *)&v11 _systemDefaultFocusGroupIdentifier];
    }

    v5 = v8;
  }

  else
  {
    v10.receiver = self;
    v10.super_class = UICollectionView;
    v5 = [(UIView *)&v10 _systemDefaultFocusGroupIdentifier];
  }

  return v5;
}

- (void)_updateHorizontalIndexTitleBarSelectionForFocusedIndexPath:(id)a3
{
  v29 = a3;
  v4 = [(UICollectionView *)self _horizontalIndexTitleBar];

  if (v29 && v4)
  {
    v5 = *(&self->_collectionViewFlags + 1);
    v6 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v7 = v6;
    if ((v5 & 4) == 0)
    {
      [v6 _selectEntryForTitleIndex:{objc_msgSend(v29, "section")}];
      v8 = v7;
LABEL_35:

      goto LABEL_36;
    }

    v8 = [v6 entries];

    v9 = [(UICollectionView *)self _horizontalIndexTitleBar];
    v10 = [v9 selectedEntry];

    if (v10)
    {
      if ([v8 count] == 1)
      {
LABEL_34:

        goto LABEL_35;
      }

      v11 = [v10 targetFocusedIndexPath];
      v12 = [v29 compare:v11];
      switch(v12)
      {
        case 1:
          v13 = [v8 indexOfObject:v10];
          if (v13 < [v8 count])
          {
            while (1)
            {
              v14 = [v8 objectAtIndexedSubscript:v13];
              if (v13 == [v8 count] - 1)
              {
                goto LABEL_31;
              }

              v17 = v13 + 1;
              v18 = [v8 objectAtIndexedSubscript:v13 + 1];
              v19 = [v18 targetFocusedIndexPath];
              v20 = [v29 compare:v19];

              if (v20 == -1)
              {
                v28 = [(UICollectionView *)self _horizontalIndexTitleBar];
                [v28 _selectEntryForTitleIndex:v13];

                goto LABEL_32;
              }

              ++v13;
              if (v17 >= [v8 count])
              {
                goto LABEL_18;
              }
            }
          }

          break;
        case 0:
LABEL_33:

          goto LABEL_34;
        case -1:
          v13 = [v8 indexOfObject:v10] - 1;
          if (v13 >= 0)
          {
            while (1)
            {
              v14 = [v8 objectAtIndexedSubscript:v13];
              v15 = [v14 targetFocusedIndexPath];
              v16 = [v29 compare:v15];

              if (!v13 || v16 == 1)
              {
                break;
              }

              --v13;
            }

LABEL_31:
            v18 = [(UICollectionView *)self _horizontalIndexTitleBar];
            [v18 _selectEntryForTitleIndex:v13];
LABEL_32:

            goto LABEL_33;
          }

          break;
      }

LABEL_18:
    }

    if ([v8 count])
    {
      v21 = 0;
      while (1)
      {
        v22 = [v8 objectAtIndexedSubscript:v21];
        v23 = [v22 targetFocusedIndexPath];
        v24 = [v29 compare:v23];

        if (!v24 || v21 == [v8 count] - 1 && v24 == 1)
        {
          v25 = [(UICollectionView *)self _horizontalIndexTitleBar];
          v26 = v25;
          v27 = v21;
          goto LABEL_30;
        }

        if (v21 && v24 == -1)
        {
          break;
        }

        if (++v21 >= [v8 count])
        {
          goto LABEL_34;
        }
      }

      v25 = [(UICollectionView *)self _horizontalIndexTitleBar];
      v26 = v25;
      v27 = v21 - 1;
LABEL_30:
      [v25 _selectEntryForTitleIndex:v27];
    }

    goto LABEL_34;
  }

LABEL_36:
}

- (void)_setKeepsFirstResponderVisibleOnBoundsChange:(BOOL)a3
{
  v3 = 0x800000000000;
  if (!a3)
  {
    v3 = 0;
  }

  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFFFF7FFFFFFFFFFFLL | v3;
}

- (void)_adjustForAutomaticKeyboardInfo:(id)a3 animated:(BOOL)a4 lastAdjustment:(double *)a5
{
  v6 = a4;
  v8 = a3;
  if ([(UIScrollView *)self _isFirstResponderKeyboardAvoidanceEnabled])
  {
    v9.receiver = self;
    v9.super_class = UICollectionView;
    [(UIScrollView *)&v9 _adjustForAutomaticKeyboardInfo:v8 animated:v6 lastAdjustment:a5];
    if (*a5 != 0.0)
    {
      [(UICollectionView *)self _scrollFirstResponderCellToVisible:1, *a5];
    }
  }
}

- (void)_scrollFirstResponderCellToVisible:(BOOL)a3
{
  subviewManager = self->_subviewManager;
  v4[0] = MEMORY[0x1E69E9820];
  v4[1] = 3221225472;
  v4[2] = __55__UICollectionView__scrollFirstResponderCellToVisible___block_invoke;
  v4[3] = &unk_1E70FF9A0;
  v4[4] = self;
  v5 = a3;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v4];
  }
}

void __55__UICollectionView__scrollFirstResponderCellToVisible___block_invoke(uint64_t a1, void *a2, void *a3, _BYTE *a4)
{
  v7 = a2;
  if ([a3 _isAncestorOfFirstResponder] && objc_msgSend(*(a1 + 32), "_indexPathIsValid:", v7))
  {
    [*(a1 + 32) _scrollToItemAtPresentationIndexPath:v7 atScrollPosition:0 additionalInsets:*(a1 + 40) animated:{0.0, 0.0, 0.0, 0.0}];
    *a4 = 1;
  }
}

- (BOOL)_supportsAutomaticCatalystDragAndDropReordering
{
  if (![(UICollectionView *)self _dragAndDropNeededForReordering])
  {
    return 0;
  }

  v3 = [(UICollectionView *)self _dragDelegateActual];
  if (v3)
  {
    v4 = 0;
  }

  else
  {
    v5 = [(UICollectionView *)self _dropDelegateActual];
    v4 = v5 == 0;
  }

  return v4;
}

- (id)_indexPathOfItemNearestToPoint:(CGPoint)a3 intersectingRect:(CGRect)a4
{
  height = a4.size.height;
  width = a4.size.width;
  y = a4.origin.y;
  x = a4.origin.x;
  v7 = a3.y;
  v8 = a3.x;
  v50 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v15 = [(UICollectionViewData *)collectionViewData layoutAttributesForCellsInRect:v11 validateLayout:v12, v13, v14];
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v16 = [v15 countByEnumeratingWithState:&v45 objects:v49 count:16];
  if (!v16)
  {
    goto LABEL_14;
  }

  v17 = v16;
  v40 = y;
  v41 = width;
  v42 = height;
  v18 = 0;
  v19 = 1.79769313e308;
  v20 = *v46;
  v36 = *(MEMORY[0x1E695F058] + 24);
  v37 = *(MEMORY[0x1E695F058] + 16);
  v44.size.width = v37;
  v44.size.height = v36;
  v38 = *(MEMORY[0x1E695F058] + 8);
  v39 = *MEMORY[0x1E695F058];
  v44.origin.x = *MEMORY[0x1E695F058];
  v44.origin.y = v38;
  do
  {
    for (i = 0; i != v17; ++i)
    {
      if (*v46 != v20)
      {
        objc_enumerationMutation(v15);
      }

      v22 = *(*(&v45 + 1) + 8 * i);
      layout = self->_layout;
      [v22 frame];
      [(UICollectionViewLayout *)layout _orthogonalFrameWithOffsetElidedForItemWithLayoutAttributes:v22 frame:?];
      v25 = v24;
      v27 = v26;
      v29 = v28;
      v31 = v30;
      UIDistanceBetweenPointAndRect(v8, v7, v24, v26, v28, v30);
      v33 = fabs(v32);
      if (v33 < v19)
      {
        v34 = [v22 indexPath];

        v44.size.width = v29;
        v44.size.height = v31;
        v44.origin.x = v25;
        v44.origin.y = v27;
        v19 = v33;
        v18 = v34;
      }
    }

    v17 = [v15 countByEnumeratingWithState:&v45 objects:v49 count:16];
  }

  while (v17);
  if (v18)
  {
    v52.origin.y = v38;
    v52.origin.x = v39;
    v52.size.height = v36;
    v52.size.width = v37;
    v54.origin.x = x;
    v54.origin.y = v40;
    v54.size.width = v41;
    v54.size.height = v42;
    if (!CGRectEqualToRect(v52, v54))
    {
      v53.origin.x = x;
      v53.origin.y = v40;
      v53.size.width = v41;
      v53.size.height = v42;
      if (!CGRectIntersectsRect(v53, v44))
      {

LABEL_14:
        v18 = 0;
      }
    }
  }

  return v18;
}

- (id)_sectionIndexesAfterShadowUpdatesForSectionIndexes:(id)a3 allowingAppendingInserts:(BOOL)a4
{
  v6 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v11 = 0;
    v12 = &v11;
    v13 = 0x3032000000;
    v14 = __Block_byref_object_copy__39;
    v15 = __Block_byref_object_dispose__39;
    v16 = objc_alloc_init(MEMORY[0x1E696AD50]);
    v9[0] = MEMORY[0x1E69E9820];
    v9[1] = 3221225472;
    v9[2] = __96__UICollectionView__sectionIndexesAfterShadowUpdatesForSectionIndexes_allowingAppendingInserts___block_invoke;
    v9[3] = &unk_1E70FF9C8;
    v10 = a4;
    v9[4] = self;
    v9[5] = &v11;
    [v6 enumerateIndexesUsingBlock:v9];
    v7 = v12[5];
    _Block_object_dispose(&v11, 8);
  }

  else
  {
    v7 = v6;
  }

  return v7;
}

uint64_t __96__UICollectionView__sectionIndexesAfterShadowUpdatesForSectionIndexes_allowingAppendingInserts___block_invoke(uint64_t a1, uint64_t a2)
{
  result = [*(*(a1 + 32) + 2856) sectionIndexAfterShadowUpdates:a2 allowingAppendingInserts:*(a1 + 48)];
  if (result != 0x7FFFFFFFFFFFFFFFLL)
  {
    v4 = result;
    v5 = *(*(*(a1 + 40) + 8) + 40);

    return [v5 addIndex:v4];
  }

  return result;
}

- (id)_indexPathsBeforeShadowUpdatesForIndexPaths:(id)a3
{
  v18 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v4, "count")}];
    v13 = 0u;
    v14 = 0u;
    v15 = 0u;
    v16 = 0u;
    v6 = v4;
    v7 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
    if (v7)
    {
      v8 = v7;
      v9 = *v14;
      do
      {
        for (i = 0; i != v8; ++i)
        {
          if (*v14 != v9)
          {
            objc_enumerationMutation(v6);
          }

          v11 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:*(*(&v13 + 1) + 8 * i), v13];
          if (v11)
          {
            [v5 addObject:v11];
          }
        }

        v8 = [v6 countByEnumeratingWithState:&v13 objects:v17 count:16];
      }

      while (v8);
    }
  }

  else
  {
    v5 = v4;
  }

  return v5;
}

- (id)_indexPathsAfterShadowUpdatesForIndexPaths:(id)a3 allowingAppendingInserts:(BOOL)a4
{
  v4 = a4;
  v20 = *MEMORY[0x1E69E9840];
  v6 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v7 = [objc_alloc(MEMORY[0x1E695DF70]) initWithCapacity:{objc_msgSend(v6, "count")}];
    v15 = 0u;
    v16 = 0u;
    v17 = 0u;
    v18 = 0u;
    v8 = v6;
    v9 = [v8 countByEnumeratingWithState:&v15 objects:v19 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v16;
      do
      {
        for (i = 0; i != v10; ++i)
        {
          if (*v16 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v13 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:*(*(&v15 + 1) + 8 * i) allowingAppendingInserts:v4, v15];
          if (v13)
          {
            [v7 addObject:v13];
          }
        }

        v10 = [v8 countByEnumeratingWithState:&v15 objects:v19 count:16];
      }

      while (v10);
    }
  }

  else
  {
    v7 = v6;
  }

  return v7;
}

- (id)_indexPathAfterShadowUpdatesForIndexPath:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (id)_indexPathBeforeShadowUpdatesForIndexPath:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (BOOL)isDragSessionActive
{
  dragAndDropController = self->_dragAndDropController;
  if (!dragAndDropController)
  {
    return 0;
  }

  if ([(_UICollectionViewDragSourceController *)&dragAndDropController->_sourceController->super.isa isActive])
  {
    return 1;
  }

  v5 = self->_dragAndDropController;
  if (!v5)
  {
    return 0;
  }

  destinationController = v5->_destinationController;

  return [(_UICollectionViewDragDestinationController *)destinationController isActive];
}

- (id)_indexPathForInsertionAtPoint:(CGPoint)a3 dropIntent:(int64_t)a4 sourceIndexPath:(id)a5 indicatorLayoutAttributes:(id *)a6
{
  y = a3.y;
  x = a3.x;
  v11 = a5;
  v12 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController effectiveDragDestinationVisualStyle];
  v13 = v12;
  v14 = a4 == 1 && v12 == 2;
  v15 = v14;
  if (v14)
  {
    v16 = [(UICollectionViewLayout *)self->_layout _layoutAttributesForInsertionIndicatorAtTargetPosition:v11 sourceIndexPath:x, y];
    v17 = [v16 indexPath];
    if (!v11)
    {
      goto LABEL_19;
    }
  }

  else
  {
    v17 = [(UICollectionView *)self _indexPathForItemAtPoint:x, y];
    v16 = 0;
    if (!v11)
    {
      goto LABEL_19;
    }
  }

  if (v13 != 2)
  {
LABEL_19:
    v22 = v17;
    goto LABEL_20;
  }

  v18 = [(_UIDragDestinationIndicatorView *)self->_reorderDestinationView currentIndexPath];
  v19 = v18;
  if (v18)
  {
    v20 = v18;
  }

  else
  {
    v20 = v11;
  }

  v21 = v20;

  v22 = [(UICollectionView *)self _targetIndexPathForMoveOfItemFromOriginalIndexPath:v11 atCurrentIndexPath:v21 toProposedIndexPath:v17];

  if (v15 && ([v22 isEqual:v17] & 1) == 0)
  {
    v23 = [(UICollectionViewLayout *)self->_layout _layoutAttributesForInsertionIndicatorAtTargetIndexPath:v22];

    v16 = v23;
  }

LABEL_20:
  if (a6 && v16)
  {
    v24 = v16;
    *a6 = v16;
  }

  return v22;
}

- (void)_updateDropTargetAppearanceWithTargetIndexPath:(id)a3 intent:(int64_t)a4 indicatorLayoutAttributes:(id)a5
{
  v8 = a3;
  v9 = a5;
  if (dyld_program_sdk_at_least())
  {
    v10 = 6;
  }

  else
  {
    v10 = 4;
  }

  v13[0] = MEMORY[0x1E69E9820];
  v13[1] = 3221225472;
  v13[2] = __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke;
  v13[3] = &unk_1E70F36D0;
  v13[4] = self;
  v11 = v8;
  v14 = v11;
  v15 = a4;
  [(UIView *)0.3 _animateCollectionTableAnimationWithDuration:UIView delay:v10 options:v13 animations:0 completion:?];
  v12 = [(_UICollectionViewDragAndDropController *)self->_dragAndDropController indexPathForOriginalReorderedItem];
  if (v11 && a4 == 1 && v9 && ([v11 isEqual:v12] & 1) == 0)
  {
    [(UICollectionView *)self _updateReorderDestinationViewWithLayoutAttributes:v9];
  }

  else
  {
    [(UICollectionView *)self _removeReorderDestinationView];
  }
}

void __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke(uint64_t a1)
{
  v2 = *(*(a1 + 32) + 2984);
  v5[0] = MEMORY[0x1E69E9820];
  v5[1] = 3221225472;
  v5[2] = __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke_2;
  v5[3] = &unk_1E70FF9F0;
  v3 = *(a1 + 40);
  v4 = *(a1 + 48);
  v6 = v3;
  v7 = v4;
  if (v2)
  {
    [(_UICollectionViewSubviewCollection *)*(v2 + 8) enumerateCellsWithEnumerator:v5];
    v3 = v6;
  }
}

void __100__UICollectionView__updateDropTargetAppearanceWithTargetIndexPath_intent_indicatorLayoutAttributes___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v7 = a2;
  v5 = a3;
  if (*(a1 + 32) && *(a1 + 40) == 2 && ([v7 isEqual:?] & 1) != 0)
  {
    v6 = 2;
  }

  else
  {
    v6 = 1;
  }

  [v5 _setDropState:v6];
}

- (void)_resetDropTargetAppearance
{
  subviewManager = self->_subviewManager;
  if (subviewManager)
  {
    [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:?];
  }
}

- (void)horizontalIndexBar:(id)a3 selectedEntry:(id)a4
{
  v10 = a3;
  v6 = a4;
  [(UICollectionView *)self setSelectedIndexTitleEntry:v6];
  if ((*(&self->_collectionViewFlags + 3) & 0x20) != 0)
  {
    v9 = [(UICollectionView *)self _delegateProxy];
    [v9 _collectionView:self horizontalIndexTitleBar:v10 selectedEntry:v6];
  }

  else
  {
    v7 = [(UIView *)self traitCollection];
    if ([v7 layoutDirection] == 1)
    {
      v8 = 32;
    }

    else
    {
      v8 = 8;
    }

    v9 = [v6 targetFocusedIndexPath];

    [(UICollectionView *)self scrollToItemAtIndexPath:v9 atScrollPosition:v8 animated:1];
  }
}

- (id)_performShadowUpdates:(id)a3
{
  v5 = a3;
  if (!v5)
  {
    v18 = [MEMORY[0x1E696AAA8] currentHandler];
    [v18 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17022 description:{@"Invalid parameter not satisfying: %@", @"updates != NULL"}];
  }

  v6 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
  v7 = [v6 count];

  v8 = *(&self->_collectionViewFlags + 1);
  *(&self->_collectionViewFlags + 1) = v8 | 0x400000000000000;
  v19[0] = MEMORY[0x1E69E9820];
  v19[1] = 3221225472;
  v19[2] = __42__UICollectionView__performShadowUpdates___block_invoke;
  v19[3] = &unk_1E70F0F78;
  v9 = v5;
  v20 = v9;
  [(UICollectionView *)self _performInternalBatchUpdates:v19];
  *(&self->_collectionViewFlags + 1) = *(&self->_collectionViewFlags + 1) & 0xFBFFFFFFFFFFFFFFLL | (((v8 >> 58) & 1) << 58);
  v10 = MEMORY[0x1E696AD50];
  v11 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
  v12 = [v10 indexSetWithIndexesInRange:{0, objc_msgSend(v11, "count")}];

  [v12 removeIndexesInRange:{0, v7}];
  if ([v12 firstIndex] == 0x7FFFFFFFFFFFFFFFLL)
  {
    v13 = MEMORY[0x1E695E0F0];
  }

  else
  {
    v14 = [v12 firstIndex];
    v15 = [v12 count];
    v16 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController shadowUpdates];
    v13 = [v16 subarrayWithRange:{v14, v15}];
  }

  return v13;
}

- (id)_diffableIdentifierForIndexPath:(id)a3
{
  v4 = a3;
  if (v4 && [(UICollectionView *)self _isConnectedToDiffableDataSource])
  {
    v5 = [(UICollectionView *)self _diffableDataSourceImpl];
    v6 = v5;
    if (v5)
    {
      v7 = [v5 itemIdentifierForIndexPath:v4];
    }

    else
    {
      v7 = 0;
    }
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

- (void)performUsingPresentationValues:(id)a3
{
  ++self->_performUsingPresentationValuesRefCount;
  (*(a3 + 2))(a3, a2);
  --self->_performUsingPresentationValuesRefCount;
}

- (id)_identityTracker:(BOOL)a3
{
  identityTracker = self->_identityTracker;
  if (identityTracker)
  {
    v5 = 1;
  }

  else
  {
    v5 = !a3;
  }

  if (!v5)
  {
    v6 = [[_UIIndexPathIdentityTracker alloc] initWithCollectionView:?];
    v7 = self->_identityTracker;
    self->_identityTracker = v6;

    identityTracker = self->_identityTracker;
  }

  return identityTracker;
}

- (id)_translateDataSourceIndexPathsToPresentationIndexPathsAsNeeded:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _indexPathsAfterShadowUpdatesForIndexPaths:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (id)_translateDataSourceIndexPathToPresentationIndexPathAsNeeded:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathAfterShadowUpdates:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (id)_translatePresentationIndexPathsToDataSourceIndexPathsAsNeeded:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(UICollectionView *)self _indexPathsBeforeShadowUpdatesForIndexPaths:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (id)_translatePresentationIndexPathToDataSourceIndexPathAsNeeded:(id)a3
{
  v4 = a3;
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates]&& ![(UICollectionView *)self _isOperatingWithPresentationValues])
  {
    v5 = [(_UICollectionViewShadowUpdatesController *)self->_dragAndDropController indexPathBeforeShadowUpdates:v4];
  }

  else
  {
    v5 = v4;
  }

  v6 = v5;

  return v6;
}

- (id)_dragDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);
  }

  return WeakRetained;
}

- (id)_dropDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);
  }

  return WeakRetained;
}

- (id)_dragDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDelegate);

  return WeakRetained;
}

- (id)_dropDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dropDelegate);

  return WeakRetained;
}

- (id)_dragSourceDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);
  }

  return WeakRetained;
}

- (id)_dragDestinationDelegateProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);
  }

  return WeakRetained;
}

- (id)_dragSourceDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragSourceDelegate);

  return WeakRetained;
}

- (id)_dragDestinationDelegateActual
{
  WeakRetained = objc_loadWeakRetained(&self->_dragDestinationDelegate);

  return WeakRetained;
}

- (BOOL)_shouldSpringLoadItemAtIndexPath:(id)a3 withContext:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(UICollectionView *)self _delegateActual];
  v9 = objc_opt_respondsToSelector();

  if (v9)
  {
    v10 = [(UICollectionView *)self _delegateProxy];
    v11 = [v10 collectionView:self shouldSpringLoadItemAtIndexPath:v6 withContext:v7];
  }

  else
  {
    v12 = [(UICollectionView *)self _delegateActual];
    v13 = objc_opt_respondsToSelector();

    if ((v13 & 1) == 0)
    {
      v14 = 1;
      goto LABEL_7;
    }

    v10 = [(UICollectionView *)self _delegateProxy];
    v11 = [v10 _collectionView:self shouldSpringLoadItemAtIndexPath:v6 withContext:v7];
  }

  v14 = v11;

LABEL_7:
  return v14;
}

- (void)_unhighlightSpringLoadedItem
{
  highlightedSpringLoadedItem = self->_highlightedSpringLoadedItem;
  if (highlightedSpringLoadedItem)
  {
    [(UICollectionView *)self _unhighlightItemAtIndexPath:highlightedSpringLoadedItem animated:0];
    v4 = self->_highlightedSpringLoadedItem;
    self->_highlightedSpringLoadedItem = 0;
  }
}

- (void)_highlightSpringLoadedItemAtIndexPath:(id)a3
{
  v5 = a3;
  if (v5)
  {
    v6 = v5;
    [(UICollectionView *)self _highlightItemAtIndexPath:v5 animated:0 scrollPosition:0];
    objc_storeStrong(&self->_highlightedSpringLoadedItem, a3);
    v5 = v6;
  }
}

- (BOOL)_addUpdateToShadowControllerIfNeeded:(id)a3
{
  v18 = *MEMORY[0x1E69E9840];
  v4 = a3;
  v5 = [(UICollectionView *)self _isPerformingShadowUpdates];
  dragAndDropController = self->_dragAndDropController;
  if (v5)
  {
    [(_UICollectionViewShadowUpdatesController *)dragAndDropController appendShadowUpdate:v4];
LABEL_6:
    v8 = 1;
    goto LABEL_7;
  }

  if (![(_UICollectionViewDragAndDropController *)dragAndDropController updateWillCauseInternalInconsistency:v4])
  {
    goto LABEL_6;
  }

  CategoryCachedImpl = __UILogGetCategoryCachedImpl("UICollectionView", &_addUpdateToShadowControllerIfNeeded____s_category);
  if (*CategoryCachedImpl)
  {
    v10 = *(CategoryCachedImpl + 8);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = self->_dragAndDropController;
      *buf = 134218498;
      v13 = self;
      v14 = 2112;
      v15 = v4;
      v16 = 2112;
      v17 = v11;
      _os_log_impl(&dword_188A29000, v10, OS_LOG_TYPE_ERROR, "_addUpdateToShadowControllerIfNeeded: cv == %p; unable to add update to shadow updates controller. Update item: %@; drag and drop controller: %@", buf, 0x20u);
    }
  }

  v8 = 0;
LABEL_7:

  return v8;
}

- (void)_performUpdate:(id)a3
{
  v22[1] = *MEMORY[0x1E69E9840];
  v5 = a3;
  v6 = v5;
  if (v5 && v5[6] == 0x7FFFFFFFFFFFFFFFLL)
  {
    v16 = [MEMORY[0x1E696AAA8] currentHandler];
    [v16 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17265 description:@"Section operations are not supported for this IPI"];
  }

  v7 = [(UICollectionViewUpdateItem *)v6 _indexPath];
  v8 = [v6 indexPathBeforeUpdate];
  v9 = [v6 indexPathAfterUpdate];
  if (![v6 updateAction])
  {
    if (!v7)
    {
      v17 = [MEMORY[0x1E696AAA8] currentHandler];
      [v17 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17272 description:@"Original indexPath is nil. This is bad."];
    }

    v10 = [(UICollectionViewUpdateItem *)v6 _indexPath];
    v22[0] = v10;
    v11 = [MEMORY[0x1E695DEC8] arrayWithObjects:v22 count:1];
    v12 = self;
    v13 = v11;
    v14 = 0;
    goto LABEL_12;
  }

  if ([v6 updateAction] != 1)
  {
    if ([v6 updateAction] != 3)
    {
      v15 = [MEMORY[0x1E696AAA8] currentHandler];
      [v15 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17285 description:{@"%s: Unhandled update item action for update: %@", "-[UICollectionView _performUpdate:]", v6}];

      goto LABEL_13;
    }

    if (v8)
    {
      if (v9)
      {
LABEL_17:
        [(UICollectionView *)self _moveItemAtIndexPath:v8 toIndexPath:v9];
        goto LABEL_13;
      }
    }

    else
    {
      v19 = [MEMORY[0x1E696AAA8] currentHandler];
      [v19 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17280 description:@"indexPathBeforeUpdate is nil. This is bad."];

      if (v9)
      {
        goto LABEL_17;
      }
    }

    v20 = [MEMORY[0x1E696AAA8] currentHandler];
    [v20 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17281 description:@"indexPathAfterUpdate is nil. This is bad."];

    goto LABEL_17;
  }

  if (!v7)
  {
    v18 = [MEMORY[0x1E696AAA8] currentHandler];
    [v18 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17276 description:@"Original indexPath is nil. This is bad."];
  }

  v10 = [(UICollectionViewUpdateItem *)v6 _indexPath];
  v21 = v10;
  v11 = [MEMORY[0x1E695DEC8] arrayWithObjects:&v21 count:1];
  v12 = self;
  v13 = v11;
  v14 = 1;
LABEL_12:
  [(UICollectionView *)v12 _updateRowsAtIndexPaths:v13 updateAction:v14];

LABEL_13:
}

- (id)_prefetchDataSourceProxy
{
  if ([(_UICollectionViewDragAndDropController *)self->_dragAndDropController hasShadowUpdates])
  {
    WeakRetained = self->_dragAndDropController;
  }

  else
  {
    WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);
  }

  return WeakRetained;
}

- (id)_prefetchDataSourceActual
{
  WeakRetained = objc_loadWeakRetained(&self->_prefetchDataSource);

  return WeakRetained;
}

- (void)_managedSubviewAdded:(id)a3
{
  v4 = a3;
  v5 = self->_layout;
  v6 = v4;
  v11 = v6;
  if (v6 && v5)
  {
    v7 = [v6 effectiveUserInterfaceLayoutDirection];
    if (v7 == [(UICollectionViewLayout *)v5 developmentLayoutDirection])
    {
      v8 = [v11 _flipsHorizontalAxis];
      v9 = v11;
      if (!v8)
      {
        goto LABEL_8;
      }

      v10 = 0;
    }

    else
    {
      v10 = [(UICollectionViewLayout *)v5 _wantsRightToLeftHorizontalMirroringIfNeeded];
      v9 = v11;
    }

    [v9 _setFlipsHorizontalAxis:v10];
  }

LABEL_8:
}

- (void)_performDiffableUpdate:(id)a3
{
  v11 = *MEMORY[0x1E69E9840];
  v5 = a3;
  if ((*(&self->_collectionViewFlags + 8) & 0x10) == 0)
  {
    _UIIsPrivateMainBundle();
    if (dyld_program_sdk_at_least())
    {
      v6 = [MEMORY[0x1E696AAA8] currentHandler];
      [v6 handleFailureInMethod:a2 object:self file:@"UICollectionView.m" lineNumber:17339 description:{@"Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@", self}];
    }

    else if (os_variant_has_internal_diagnostics())
    {
      v8 = __UIFaultDebugAssertLog();
      if (os_log_type_enabled(v8, OS_LOG_TYPE_FAULT))
      {
        *buf = 138412290;
        v10 = self;
        _os_log_fault_impl(&dword_188A29000, v8, OS_LOG_TYPE_FAULT, "Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@ This will become an assert in a future version.", buf, 0xCu);
      }
    }

    else
    {
      v7 = *(__UILogGetCategoryCachedImpl("Assert", &_performDiffableUpdate____s_category) + 8);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v10 = self;
        _os_log_impl(&dword_188A29000, v7, OS_LOG_TYPE_ERROR, "Attempted to apply updates to a collection view from a UICollectionViewDiffableDataSource, but the collection view's dataSource is not the UICollectionViewDiffableDataSource. Collection view: %@ This will become an assert in a future version.", buf, 0xCu);
      }
    }
  }

  [(UICollectionView *)self _performInternalBatchUpdates:v5];
}

- (void)_performInternalBatchUpdates:(id)a3
{
  p_collectionViewFlags = &self->_collectionViewFlags;
  v4 = *(&self->_collectionViewFlags + 4);
  *(&self->_collectionViewFlags + 4) = v4 | 0x10;
  (*(a3 + 2))(a3, a2);
  *(p_collectionViewFlags + 4) = *(p_collectionViewFlags + 4) & 0xFFFFFFEF | (16 * ((v4 >> 4) & 1));
}

- (id)_indexPathForGlobalIndex:(int64_t)a3
{
  if (a3 == 0x7FFFFFFFFFFFFFFFLL)
  {
    v4 = 0;
  }

  else
  {
    v4 = [(UICollectionViewData *)self->_collectionViewData validatedIndexPathForItemAtGlobalIndex:a3];
  }

  return v4;
}

- (int64_t)_totalItemCount
{
  collectionViewData = self->_collectionViewData;
  if (!collectionViewData)
  {
    return 0;
  }

  if ((*&collectionViewData->_collectionViewDataFlags & 2) == 0)
  {
    [(UICollectionViewData *)self->_collectionViewData _updateItemCounts];
  }

  return collectionViewData->_totalItemCount;
}

- (BOOL)_indexPathIsSectionAppendingIndexPath:(id)a3
{
  v4 = a3;
  v5 = v4;
  if (!v4 || [v4 length] < 2 || (v6 = objc_msgSend(v5, "section"), v6 == 0x7FFFFFFFFFFFFFFFLL) || (v7 = v6, v6 >= -[UICollectionViewData numberOfSections](self->_collectionViewData)))
  {
    v9 = 0;
  }

  else
  {
    v8 = [v5 item];
    v9 = v8 == [(UICollectionViewData *)self->_collectionViewData numberOfItemsInSection:v7];
  }

  return v9;
}

- (id)contextMenuInteraction:(id)a3 configurationForMenuAtLocation:(CGPoint)a4
{
  y = a4.y;
  x = a4.x;
  v38[1] = *MEMORY[0x1E69E9840];
  if (![(UICollectionView *)self _delegateSupportsMenuInteraction]|| ![(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin])
  {
    v13 = 0;
    goto LABEL_38;
  }

  v7 = *&self->_collectionViewFlags & 0x80100000000;
  v8 = [(UICollectionView *)self indexPathForItemAtPoint:x, y];
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __74__UICollectionView_contextMenuInteraction_configurationForMenuAtLocation___block_invoke;
  aBlock[3] = &unk_1E70FFA38;
  aBlock[4] = self;
  *&aBlock[5] = x;
  *&aBlock[6] = y;
  v9 = _Block_copy(aBlock);
  v10 = v9;
  if (v8)
  {
    if (![(UICollectionView *)self _cellAtIndexPath:v8 containsInteractiveControlAtPoint:x, y])
    {
      if (v7)
      {
        v11 = [(UICollectionView *)self indexPathsForSelectedItems];
        if ([v11 containsObject:v8])
        {
          v12 = v11;
        }

        else
        {
          v38[0] = v8;
          v12 = [MEMORY[0x1E695DEC8] arrayWithObjects:v38 count:1];
        }

        v15 = v12;
        v17 = (v10)[2](v10, v12);
        goto LABEL_23;
      }

      if ((*(&self->_collectionViewFlags + 5) & 0x10) != 0)
      {
        v14 = [(UICollectionView *)self indexPathsForSelectedItems];
        if ([v14 containsObject:v8])
        {
          v15 = v14;
          v16 = [(UICollectionView *)self _delegateProxy];
          v13 = [v16 _dci_collectionView:self contextMenuConfigurationForSelectedItemsAtIndexPaths:v15 point:{x, y}];

          if (v13)
          {
LABEL_24:
            if ([v15 count])
            {
              v31 = v10;
              v18 = [MEMORY[0x1E695DFA8] set];
              v32 = 0u;
              v33 = 0u;
              v34 = 0u;
              v35 = 0u;
              v30 = v15;
              v19 = v15;
              v20 = [v19 countByEnumeratingWithState:&v32 objects:v37 count:16];
              if (v20)
              {
                v21 = v20;
                v22 = *v33;
                do
                {
                  for (i = 0; i != v21; ++i)
                  {
                    if (*v33 != v22)
                    {
                      objc_enumerationMutation(v19);
                    }

                    v24 = *(*(&v32 + 1) + 8 * i);
                    if (([v24 isEqual:{v8, v30}] & 1) == 0)
                    {
                      v25 = [(UICollectionView *)self _identityTracker:1];
                      v26 = [(_UIIndexPathIdentityTracker *)v25 identifierForIndexPath:v24];
                      [v18 addObject:v26];
                    }
                  }

                  v21 = [v19 countByEnumeratingWithState:&v32 objects:v37 count:16];
                }

                while (v21);
              }

              [v13 set_internalSecondaryItemIdentifiers:v18];
              v15 = v30;
              v10 = v31;
            }

            v27 = [(UICollectionView *)self _identityTracker:1, v30];
            v28 = [(_UIIndexPathIdentityTracker *)v27 identifierForIndexPath:v8];
            [v13 set_internalIdentifier:v28];

            goto LABEL_36;
          }

          goto LABEL_20;
        }
      }

      v15 = 0;
LABEL_20:
      if ((*(&self->_collectionViewFlags + 4) & 8) == 0)
      {
        v13 = 0;
        goto LABEL_36;
      }

      v11 = [(UICollectionView *)self _delegateProxy];
      v17 = [v11 collectionView:self contextMenuConfigurationForItemAtIndexPath:v8 point:{x, y}];
LABEL_23:
      v13 = v17;

      if (v13)
      {
        goto LABEL_24;
      }

LABEL_36:

      goto LABEL_37;
    }

    goto LABEL_11;
  }

  if (!v7)
  {
LABEL_11:
    v13 = 0;
    goto LABEL_37;
  }

  v13 = (*(v9 + 2))(v9, MEMORY[0x1E695E0F0]);
  [v13 set_internalIdentifier:@"com.apple.UIKit.UICollectionView.backgroundMenu"];
LABEL_37:

LABEL_38:

  return v13;
}

id __74__UICollectionView_contextMenuInteraction_configurationForMenuAtLocation___block_invoke(double *a1, void *a2)
{
  v3 = *(a1 + 4);
  v4 = v3[340];
  v5 = a2;
  v6 = [v3 _delegateProxy];
  v7 = v6;
  v8 = *(a1 + 4);
  v9 = a1[5];
  v10 = a1[6];
  if ((v4 & 0x100000000) != 0)
  {
    [v6 collectionView:v8 contextMenuConfigurationForItemsAtIndexPaths:v5 point:{v9, v10}];
  }

  else
  {
    [v6 _dci_collectionView:v8 contextMenuConfigurationForItemsAtIndexPaths:v5 point:{v9, v10}];
  }
  v11 = ;

  return v11;
}

- (BOOL)_cellAtIndexPath:(id)a3 containsInteractiveControlAtPoint:(CGPoint)a4
{
  y = a4.y;
  x = a4.x;
  v7 = [(UICollectionView *)self cellForItemAtIndexPath:a3];
  [(UIView *)self convertPoint:v7 toView:x, y];
  v8 = [v7 hitTest:0 withEvent:?];
  objc_opt_class();
  v9 = 0;
  if (v8 && v8 != v7)
  {
    while (![v8 isUserInteractionEnabled] || (objc_opt_isKindOfClass() & 1) == 0)
    {
      v10 = [v8 superview];

      v9 = 0;
      if (v10)
      {
        v8 = v10;
        if (v10 != v7)
        {
          continue;
        }
      }

      goto LABEL_10;
    }

    v9 = 1;
  }

  v10 = v8;
LABEL_10:

  return v9;
}

- (id)_defaultTargetedPreviewForIdentifier:(id)a3
{
  v23 = *MEMORY[0x1E69E9840];
  v4 = a3;
  if (!v4)
  {
    v11 = 0;
    goto LABEL_15;
  }

  v5 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:v4];
  if (v5)
  {
    v6 = [(UICollectionView *)self indexPathsForVisibleItems];
    v7 = [v6 containsObject:v5];

    if (v7)
    {
      v8 = [(UICollectionView *)self cellForItemAtIndexPath:v5];
      v9 = v8;
      if (v8)
      {
        v10 = [v8 window];

        if (v10)
        {
          v11 = _UITargetedPreviewForContextMenuFromCell(v9);
LABEL_13:

          goto LABEL_14;
        }

        if (os_variant_has_internal_diagnostics())
        {
          v16 = __UIFaultDebugAssertLog();
          if (os_log_type_enabled(v16, OS_LOG_TYPE_FAULT))
          {
            v17 = 138412802;
            v18 = v9;
            v19 = 2112;
            v20 = v5;
            v21 = 2112;
            v22 = v4;
            _os_log_fault_impl(&dword_188A29000, v16, OS_LOG_TYPE_FAULT, "Cell (%@) at indexPath (%@) with identifier (%@) is not in a window. Was the collection view removed from its window?", &v17, 0x20u);
          }
        }

        else
        {
          v12 = *(__UILogGetCategoryCachedImpl("Assert", &_defaultTargetedPreviewForIdentifier____s_category) + 8);
          if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
          {
            v17 = 138412802;
            v18 = v9;
            v19 = 2112;
            v20 = v5;
            v21 = 2112;
            v22 = v4;
            _os_log_impl(&dword_188A29000, v12, OS_LOG_TYPE_ERROR, "Cell (%@) at indexPath (%@) with identifier (%@) is not in a window. Was the collection view removed from its window?", &v17, 0x20u);
          }
        }
      }

      v11 = 0;
      goto LABEL_13;
    }
  }

  v11 = 0;
LABEL_14:

LABEL_15:
  v13 = +[UIColor clearColor];
  v14 = [v11 parameters];
  [v14 setBackgroundColor:v13];

  [v11 set_captureHierarchyBelowSourceView:1];

  return v11;
}

- (id)_targetedPreviewForBackgroundMenuAtPoint:(CGPoint)a3
{
  v3 = [[UIPreviewTarget alloc] initWithContainer:self center:a3.x, a3.y];
  v4 = [UITargetedPreview alloc];
  v5 = objc_opt_new();
  v6 = objc_opt_new();
  v7 = [(UITargetedPreview *)v4 initWithView:v5 parameters:v6 target:v3];

  return v7;
}

- (id)contextMenuInteraction:(id)a3 configuration:(id)a4 highlightPreviewForItemWithIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  if ([v9 _isCollectionViewBackgroundMenu])
  {
    [v8 locationInView:self];
    v11 = [(UICollectionView *)self _targetedPreviewForBackgroundMenuAtPoint:?];
    goto LABEL_14;
  }

  v12 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:v10];
  if (v12)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x200000000) != 0)
    {
      v14 = [(UICollectionView *)self _delegateProxy];
      v15 = [v14 collectionView:self contextMenuConfiguration:v9 highlightPreviewForItemAtIndexPath:v12];
    }

    else if ((collectionViewFlags & 0x200000000000) != 0)
    {
      v14 = [(UICollectionView *)self _delegateProxy];
      v15 = [v14 _dci_collectionView:self contextMenuConfiguration:v9 previewForHighlightingItemAtIndexPath:v12];
    }

    else
    {
      if ((collectionViewFlags & 0x1000000000) == 0)
      {
LABEL_12:
        v11 = [(UICollectionView *)self _defaultTargetedPreviewForIdentifier:v10];
        goto LABEL_13;
      }

      v14 = [(UICollectionView *)self _delegateProxy];
      v15 = [v14 collectionView:self previewForHighlightingContextMenuWithConfiguration:v9];
    }

    v11 = v15;

    if (!v11)
    {
      goto LABEL_12;
    }
  }

  else
  {
    v11 = 0;
  }

LABEL_13:

LABEL_14:

  return v11;
}

- (id)contextMenuInteraction:(id)a3 configuration:(id)a4 dismissalPreviewForItemWithIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  if ([v9 _isCollectionViewBackgroundMenu])
  {
    [v8 locationInView:self];
    v11 = [(UICollectionView *)self _targetedPreviewForBackgroundMenuAtPoint:?];
    goto LABEL_15;
  }

  v12 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:v10];
  if (!v12 || (-[UICollectionView indexPathsForVisibleItems](self, "indexPathsForVisibleItems"), v13 = objc_claimAutoreleasedReturnValue(), v14 = [v13 containsObject:v12], v13, !v14))
  {
LABEL_13:
    v11 = 0;
    goto LABEL_14;
  }

  collectionViewFlags = self->_collectionViewFlags;
  if ((collectionViewFlags & 0x400000000) != 0)
  {
    v16 = [(UICollectionView *)self _delegateProxy];
    v17 = [v16 collectionView:self contextMenuConfiguration:v9 dismissalPreviewForItemAtIndexPath:v12];
  }

  else if ((collectionViewFlags & 0x400000000000) != 0)
  {
    v16 = [(UICollectionView *)self _delegateProxy];
    v17 = [v16 _dci_collectionView:self contextMenuConfiguration:v9 previewForDismissingToItemAtIndexPath:v12];
  }

  else
  {
    if ((collectionViewFlags & 0x2000000000) == 0)
    {
      goto LABEL_12;
    }

    v16 = [(UICollectionView *)self _delegateProxy];
    v17 = [v16 collectionView:self previewForDismissingContextMenuWithConfiguration:v9];
  }

  v11 = v17;

  if (!v11)
  {
LABEL_12:
    if (![(UICollectionView *)self _isReordering])
    {
      v11 = [(UICollectionView *)self _defaultTargetedPreviewForIdentifier:v10];
      goto LABEL_14;
    }

    goto LABEL_13;
  }

LABEL_14:

LABEL_15:

  return v11;
}

- (void)contextMenuInteraction:(id)a3 willPerformPreviewActionForMenuWithConfiguration:(id)a4 animator:(id)a5
{
  if ((*(&self->_collectionViewFlags + 4) & 0x40) != 0)
  {
    v8 = a5;
    v9 = a4;
    v10 = [(UICollectionView *)self _delegateProxy];
    [v10 collectionView:self willPerformPreviewActionForMenuWithConfiguration:v9 animator:v8];
  }
}

- (void)contextMenuInteraction:(id)a3 willDisplayMenuForConfiguration:(id)a4 animator:(id)a5
{
  v34 = *MEMORY[0x1E69E9840];
  v8 = a3;
  v9 = a4;
  v10 = a5;
  if ((*(&self->_collectionViewFlags + 4) & 0x80) != 0)
  {
    v11 = [(UICollectionView *)self _delegateProxy];
    [v11 collectionView:self willDisplayContextMenuWithConfiguration:v9 animator:v10];
  }

  v12 = [v9 _internalSecondaryItemIdentifiers];
  v13 = [v12 count];

  if (v13)
  {
    v26 = v8;
    v14 = objc_opt_new();
    v15 = [v9 _internalIdentifier];
    v16 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:v15];

    if (v16)
    {
      [v14 addObject:v16];
    }

    v31 = 0u;
    v32 = 0u;
    v29 = 0u;
    v30 = 0u;
    v17 = [v9 _internalSecondaryItemIdentifiers];
    v18 = [v17 countByEnumeratingWithState:&v29 objects:v33 count:16];
    if (v18)
    {
      v19 = v18;
      v20 = *v30;
      do
      {
        for (i = 0; i != v19; ++i)
        {
          if (*v30 != v20)
          {
            objc_enumerationMutation(v17);
          }

          v22 = [(UICollectionView *)self _existingIndexPathForIdentityTrackerIdentifier:*(*(&v29 + 1) + 8 * i)];
          if (v22)
          {
            [v14 addObject:v22];
          }
        }

        v19 = [v17 countByEnumeratingWithState:&v29 objects:v33 count:16];
      }

      while (v19);
    }

    aBlock[0] = MEMORY[0x1E69E9820];
    aBlock[1] = 3221225472;
    aBlock[2] = __84__UICollectionView_contextMenuInteraction_willDisplayMenuForConfiguration_animator___block_invoke;
    aBlock[3] = &unk_1E70F35B8;
    aBlock[4] = self;
    v28 = v14;
    v23 = v14;
    v24 = _Block_copy(aBlock);
    v25 = v24;
    if (v10)
    {
      [v10 addAnimations:v24];
    }

    else
    {
      (*(v24 + 2))(v24);
    }

    v8 = v26;
  }
}

void __84__UICollectionView_contextMenuInteraction_willDisplayMenuForConfiguration_animator___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusSystem];
  [v2 setNeedsFocusUpdate];
  [v2 updateFocusIfNeeded];
  [*(a1 + 32) _updateContextMenuStateForVisibleCells:*(a1 + 40)];
}

- (void)contextMenuInteraction:(id)a3 willEndForConfiguration:(id)a4 animator:(id)a5
{
  v7 = a4;
  v8 = a5;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __76__UICollectionView_contextMenuInteraction_willEndForConfiguration_animator___block_invoke;
  aBlock[3] = &unk_1E70F3590;
  aBlock[4] = self;
  v9 = _Block_copy(aBlock);
  v10 = v9;
  if (v8)
  {
    [v8 addAnimations:v9];
  }

  else
  {
    (*(v9 + 2))(v9);
  }

  if (*(&self->_collectionViewFlags + 5))
  {
    v11 = [(UICollectionView *)self _delegateProxy];
    [v11 collectionView:self willEndContextMenuInteractionWithConfiguration:v7 animator:v8];
  }
}

void __76__UICollectionView_contextMenuInteraction_willEndForConfiguration_animator___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) _focusSystem];
  [v2 setNeedsFocusUpdate];
  [v2 updateFocusIfNeeded];
  [*(a1 + 32) _updateContextMenuStateForVisibleCells:0];
}

- (void)_updateContextMenuStateForVisibleCells:(id)a3
{
  v29 = *MEMORY[0x1E69E9840];
  v4 = a3;
  aBlock[0] = MEMORY[0x1E69E9820];
  aBlock[1] = 3221225472;
  aBlock[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke;
  aBlock[3] = &unk_1E70FFA60;
  aBlock[4] = self;
  v5 = _Block_copy(aBlock);
  if ([v4 count])
  {
    v6 = objc_opt_new();
    v21 = 0u;
    v22 = 0u;
    v23 = 0u;
    v24 = 0u;
    v7 = v4;
    v8 = [v7 countByEnumeratingWithState:&v21 objects:v28 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v22;
      do
      {
        v11 = 0;
        do
        {
          if (*v22 != v10)
          {
            objc_enumerationMutation(v7);
          }

          [v6 addIndex:{-[UICollectionViewData globalIndexForItemAtIndexPath:](self->_collectionViewData, *(*(&v21 + 1) + 8 * v11++))}];
        }

        while (v9 != v11);
        v9 = [v7 countByEnumeratingWithState:&v21 objects:v28 count:16];
      }

      while (v9);
    }

    subviewManager = self->_subviewManager;
    v18[0] = MEMORY[0x1E69E9820];
    v18[1] = 3221225472;
    v18[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_3;
    v18[3] = &unk_1E70FFA88;
    v18[4] = self;
    v19 = v6;
    v20 = v5;
    v13 = v5;
    v14 = v6;
    v15 = v13;
    if (subviewManager)
    {
      [(_UICollectionViewSubviewCollection *)subviewManager->_visibleViews enumerateCellsWithEnumerator:v18];
      v15 = v20;
    }
  }

  else
  {
    v16 = self->_subviewManager;
    v25[0] = MEMORY[0x1E69E9820];
    v25[1] = 3221225472;
    v25[2] = __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_2;
    v25[3] = &unk_1E70FFC48;
    v26 = v5;
    v17 = v5;
    v14 = v17;
    if (v16)
    {
      [(_UICollectionViewSubviewCollection *)v16->_visibleViews enumerateCellsWithEnumerator:v25];
      v13 = v26;
    }

    else
    {
      v13 = v17;
    }
  }
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke(uint64_t a1, void *a2, void *a3)
{
  v8 = a2;
  v5 = a3;
  if (_UICollectionViewCellContextMenuSuppressesSelectionState())
  {
    v6 = *(*(a1 + 32) + 2976);
    if (v6)
    {
      v7 = [*(v6 + 8) containsObject:v8];
    }

    else
    {
      v7 = 0;
    }

    [v5 _setSelected:v7 animated:0];
  }
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_2(uint64_t a1, void *a2, void *a3)
{
  v5 = a3;
  v6 = a2;
  [v5 _setContextMenuGroupLocation:0];
  (*(*(a1 + 32) + 16))();
}

void __59__UICollectionView__updateContextMenuStateForVisibleCells___block_invoke_3(uint64_t a1, void *a2, void *a3)
{
  v23 = a3;
  v5 = *(*(a1 + 32) + 2272);
  v6 = a2;
  v7 = [(UICollectionViewData *)v5 globalIndexForItemAtIndexPath:v6];
  if ([*(a1 + 40) containsIndex:v7])
  {
    v8 = [v23 _layoutAttributes];
    v9 = [(UICollectionViewLayoutAttributes *)v8 _existingListAttributes];

    if (v9)
    {
      if (v7 >= 1 && [*(a1 + 40) containsIndex:v7 - 1])
      {
        v10 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:?];
        v11 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v10];
        v12 = [(UICollectionViewLayoutAttributes *)v11 _existingListAttributes];
        if (v12)
        {
          [v11 frame];
          MaxY = CGRectGetMaxY(v25);
          [v8 frame];
          v14 = MaxY - CGRectGetMinY(v26) + 0.0001 >= 0.0;
        }

        else
        {
          v14 = 0;
        }
      }

      else
      {
        v14 = 0;
      }

      if ([*(a1 + 40) containsIndex:v7 + 1])
      {
        v16 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) indexPathForItemAtGlobalIndex:?];
        v17 = [(UICollectionViewData *)*(*(a1 + 32) + 2272) layoutAttributesForItemAtIndexPath:v16];
        v18 = [(UICollectionViewLayoutAttributes *)v17 _existingListAttributes];
        if (v18)
        {
          [v8 frame];
          v19 = CGRectGetMaxY(v27);
          [v17 frame];
          v20 = v19 - CGRectGetMinY(v28) + 0.0001 >= 0.0;
        }

        else
        {
          v20 = 0;
        }

        v22 = 3;
        if (v20 && v14)
        {
          v22 = 1;
        }

        v21 = 4;
        if (v20)
        {
          v21 = 2;
        }
      }

      else
      {
        v21 = 4;
        v22 = 3;
      }

      if (v14)
      {
        v15 = v22;
      }

      else
      {
        v15 = v21;
      }
    }

    else
    {
      v15 = 4;
    }

    [v23 _setContextMenuGroupLocation:v15];
  }

  else
  {
    [v23 _setContextMenuGroupLocation:0];
  }

  (*(*(a1 + 48) + 16))();
}

- (id)_contextMenuInteraction:(id)a3 styleForMenuWithConfiguration:(id)a4
{
  collectionViewFlags = self->_collectionViewFlags;
  v6 = a4;
  v7 = v6;
  if ((collectionViewFlags & 0x20000000000) != 0)
  {
    v10 = [(UICollectionView *)self _delegateProxy];
    v9 = [v10 _collectionView:self styleForContextMenuWithConfiguration:v7];
  }

  else
  {
    v8 = [v6 _isCollectionViewBackgroundMenu];

    if (v8)
    {
      v9 = +[_UIContextMenuStyle defaultStyle];
      [v9 setPreferredLayout:3];
    }

    else
    {
      v9 = 0;
    }
  }

  return v9;
}

- (id)_contextMenuInteraction:(id)a3 accessoriesForMenuWithConfiguration:(id)a4
{
  if ((*(&self->_collectionViewFlags + 5) & 4) != 0)
  {
    v6 = a4;
    v7 = [(UICollectionView *)self _delegateProxy];
    v10 = 0;
    memset(v9, 0, sizeof(v9));
    v4 = [v7 _collectionView:self accessoriesForContextMenuWithConfiguration:v6 layoutAnchor:v9];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (id)_existingIndexPathForIdentityTrackerIdentifier:(id)a3
{
  v4 = a3;
  v5 = [(UICollectionView *)self _identityTracker:0];
  v6 = [(_UIIndexPathIdentityTracker *)v5 currentIndexPathForIdentifier:v4];

  return v6;
}

- (_NSRange)_globalIndexRangeOfVisibleItems
{
  v32 = *MEMORY[0x1E69E9840];
  collectionViewData = self->_collectionViewData;
  [(UICollectionView *)self _visibleBounds];
  v9 = [(UICollectionViewData *)collectionViewData layoutAttributesForCellsInRect:v5 validateLayout:v6, v7, v8];
  v10 = [(UICollectionView *)self _collectionViewData];
  v11 = v10;
  if (v10)
  {
    if ((*(v10 + 96) & 2) == 0)
    {
      [(UICollectionViewData *)v10 _updateItemCounts];
    }

    v12 = v11[21];
  }

  else
  {
    v12 = 0;
  }

  v29 = 0u;
  v30 = 0u;
  v27 = 0u;
  v28 = 0u;
  v13 = v9;
  v14 = [v13 countByEnumeratingWithState:&v27 objects:v31 count:16];
  if (v14)
  {
    v15 = v14;
    v26 = a2;
    v16 = 0;
    v17 = *v28;
    v18 = 0x1E696A000uLL;
    do
    {
      v19 = 0;
      do
      {
        if (*v28 != v17)
        {
          objc_enumerationMutation(v13);
        }

        v20 = [*(*(&v27 + 1) + 8 * v19) indexPath];
        v21 = [(UICollectionView *)self _globalIndexPathForItemAtIndexPath:v20];
        if (v21 == 0x7FFFFFFFFFFFFFFFLL)
        {
          v22 = [*(v18 + 2728) currentHandler];
          [v22 handleFailureInMethod:v26 object:self file:@"UICollectionView.m" lineNumber:17944 description:@"Should always have a global index for an index path retrieved from layout attributes that came from _collectionViewData"];

          v18 = 0x1E696A000;
        }

        else
        {
          if (v12 >= v21)
          {
            v12 = v21;
          }

          ++v16;
        }

        ++v19;
      }

      while (v15 != v19);
      v23 = [v13 countByEnumeratingWithState:&v27 objects:v31 count:16];
      v15 = v23;
    }

    while (v23);
  }

  else
  {
    v16 = 0;
  }

  v24 = v12;
  v25 = v16;
  result.length = v25;
  result.location = v24;
  return result;
}

- (void)_beginTypeSelectWithInput:(id)a3
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    if (typeSelectController->_enabled)
    {
      [(_UITypeSelectInteraction *)&typeSelectController->_typeSelectInteraction->super.isa _beginTypeSelectWithInput:a3];
    }
  }
}

- (BOOL)_typeSelectShouldAvoidBecomingFirstResponder
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectController = typeSelectController->_typeSelectInteraction;
    if (typeSelectController)
    {
      LOBYTE(typeSelectController) = BYTE6(typeSelectController[1]._typeSelectInteraction);
    }
  }

  return typeSelectController & 1;
}

- (void)_setTypeSelectShouldAvoidBecomingFirstResponder:(BOOL)a3
{
  typeSelectController = self->_typeSelectController;
  if (typeSelectController)
  {
    typeSelectInteraction = typeSelectController->_typeSelectInteraction;
    if (typeSelectInteraction)
    {
      typeSelectInteraction->_shouldAvoidBecomingFirstResponder = a3;
    }
  }
}

id __64__UICollectionView__configureSceneActivationInteractionIfNeeded__block_invoke(uint64_t a1, double a2, double a3)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v6 = [WeakRetained _sceneActivationConfigurationForLocation:{a2, a3}];

  return v6;
}

- (id)_sceneActivationConfigurationForLocation:(CGPoint)a3
{
  y = a3.y;
  x = a3.x;
  if (![(UICollectionViewLayout *)self->_layout _allowsItemInteractionsToBegin])
  {
    v9 = 0;
    goto LABEL_17;
  }

  v6 = [(UICollectionView *)self indexPathForItemAtPoint:x, y];
  if (v6)
  {
    collectionViewFlags = self->_collectionViewFlags;
    if ((collectionViewFlags & 0x800000000000) != 0)
    {
      v10 = [(UICollectionView *)self _delegateProxy];
      v11 = [v10 collectionView:self sceneActivationConfigurationForItemAtIndexPath:v6 point:{x, y}];
    }

    else
    {
      if ((collectionViewFlags & 0x1000000000000) == 0)
      {
        v8 = 0;
        goto LABEL_14;
      }

      v10 = [(UICollectionView *)self _delegateProxy];
      v11 = [v10 _collectionView:self sceneActivationConfigurationForItemAtIndexPath:v6 point:{x, y}];
    }

    v8 = v11;

    if (v8)
    {
      v12 = [v8 preview];

      if (!v12)
      {
        v13 = [(UICollectionView *)self cellForItemAtIndexPath:v6];
        v14 = [v13 window];

        if (!v14)
        {

          v9 = 0;
          goto LABEL_15;
        }

        v15 = _UITargetedPreviewForContextMenuFromCell(v13);
        [v8 setPreview:v15];
      }
    }

LABEL_14:
    v8 = v8;
    v9 = v8;
LABEL_15:

    goto LABEL_16;
  }

  v9 = 0;
LABEL_16:

LABEL_17:

  return v9;
}

- (id)valueForUndefinedKey:(id)a3
{
  v4 = a3;
  if ([v4 isEqualToString:@"_cellReuseQueues"])
  {
    UIKVCAccessProhibited(v4, @"UICollectionView");

    v5 = MEMORY[0x1E695E0F8];
  }

  else
  {
    v7.receiver = self;
    v7.super_class = UICollectionView;
    v5 = [(UICollectionView *)&v7 valueForUndefinedKey:v4];
  }

  return v5;
}

- (UIEdgeInsets)_defaultLayoutMargins
{
  top = self->_defaultLayoutMargins.top;
  left = self->_defaultLayoutMargins.left;
  bottom = self->_defaultLayoutMargins.bottom;
  right = self->_defaultLayoutMargins.right;
  result.right = right;
  result.bottom = bottom;
  result.left = left;
  result.top = top;
  return result;
}

- (id)_visibleCellForIndexPath:(id)a3
{
  v4 = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];

  return [(_UICollectionViewSubviewManager *)v4 visibleCellAtIndexPath:a3];
}

- (id)_visibleViewForLayoutAttributes:(id)a3
{
  if (a3)
  {
    v4 = *(a3 + 72);
    v5 = 1;
    if ((v4 & 2) != 0)
    {
      v5 = 2;
    }

    if (v4)
    {
      v6 = 0;
    }

    else
    {
      v6 = v5;
    }

    v7 = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];
    v8 = *(a3 + 1);
  }

  else
  {
    v7 = [(UICollectionView *)&self->super.super.super.super.isa _subviewManager];
    v6 = 0;
    v8 = 0;
  }

  v9 = [(UICollectionViewLayoutAttributes *)a3 __indexPath];

  return [(_UICollectionViewSubviewManager *)v7 visibleViewOfKind:v8 inCategory:v6 atIndexPath:v9];
}

@end