@interface UIKBAutofillController
+ (id)preferredInsertionOrder;
+ (int64_t)translateToUIAutofillMode:(unint64_t)mode;
+ (unint64_t)translateToTextInputAutofillMode:(int64_t)mode;
- (BOOL)_prohibitAutofill:(id)autofill needASPKeyboard:(BOOL)keyboard;
- (BOOL)containsUsernamePasswordPairsInAutofillGroup:(id)group;
- (BOOL)preferFallbackAutofillGroup;
- (BOOL)shouldLoadASPForResponder:(id)responder;
- (BOOL)signupHintForUsername:(id)username password:(id)password responder:(id)responder;
- (NSMutableDictionary)autofillGroup;
- (NSMutableDictionary)fallbackAutofillGroup;
- (UIKBAutofillController)init;
- (id)accessibilityLoginKeywordList;
- (id)accessibilitySignupKeywordList;
- (id)addressKeywordSet;
- (id)autofillContextForInputDelegate:(id)delegate;
- (id)contactAutoFillKeywordsForKey:(id)key value:(id)value localizedKeywords:(id)keywords;
- (id)emailKeywordSet;
- (id)loginKeywordList;
- (id)phoneKeywordSet;
- (id)processLocalizedString:(id)string;
- (id)searchKeywordSet;
- (id)signupKeywordList;
- (id)textContentTypeForInputDelegate:(id)delegate;
- (id)textSignalsForResponder:(id)responder;
- (int64_t)_needAutofillCandidate:(id)candidate delegateAsResponder:(id)responder;
- (int64_t)contactAutofillModeWithAutofillGroup:(id)group responders:(id)responders;
- (int64_t)containsIndicationInText:(id)text withAccessibilityHints:(BOOL)hints;
- (int64_t)delegateNeedsAutofillMode;
- (int64_t)doTraits:(id)traits matchTextContentType:(id)type;
- (int64_t)needAutofillCandidate:(id)candidate delegateAsResponder:(id)responder keyboardState:(id)state;
- (int64_t)signUpSignalFromButton:(id)button;
- (int64_t)signUpSignalFromNavBarItem:(id)item;
- (int64_t)signUpSignalFromViewControllerHierarchy:(id)hierarchy;
- (void)_clearASPInTextField:(id)field;
- (void)addTemporaryTextColorToTextField:(id)field;
- (void)clearASPInPasswordFields;
- (void)clearASPVisualEffectsInTextField:(id)field;
- (void)clearAutofillGroup;
- (void)didOptOutOfAutofillSignup;
- (void)enumeratePasswordFieldsUsingBlock:(id)block;
- (void)handleAutofillCredentialSaveIfNeeded:(id)needed fromASP:(BOOL)p;
- (void)handleWebviewCredentialsSaveForResponder:(id)responder WebsiteURL:(id)l user:(id)user password:(id)password passwordIsAutoGenerated:(BOOL)generated;
- (void)optOutASPInTextField;
- (void)removeTemporaryTextColorFromTextField:(id)field;
- (void)setDelegateNeedsAutofillMode:(int64_t)mode;
- (void)setFallbackAutofillGroup:(id)group;
- (void)showASPInTextField:(id)field isRightToLeft:(BOOL)left;
- (void)trackResponderForAutofillIfNeeded:(id)needed;
- (void)updateAutofillContextForInputDelegate:(id)delegate;
@end

@implementation UIKBAutofillController

- (int64_t)delegateNeedsAutofillMode
{
  targetDetectionController = self->_targetDetectionController;
  if (!targetDetectionController)
  {
    return self->_delegateNeedsAutofillMode;
  }

  delegateNeedsAutofillMode = [(AFUITargetDetectionController_Staging *)targetDetectionController delegateNeedsAutofillMode];

  return _uiAutofillModeForAFAutoFillMode(delegateNeedsAutofillMode);
}

- (NSMutableDictionary)autofillGroup
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    autoFillGroup = [(AFUITargetDetectionController_Staging *)targetDetectionController autoFillGroup];
  }

  else
  {
    autoFillGroup = self->_autofillGroup;
  }

  return autoFillGroup;
}

- (NSMutableDictionary)fallbackAutofillGroup
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    fallbackAutoFillGroup = [(AFUITargetDetectionController_Staging *)targetDetectionController fallbackAutoFillGroup];
  }

  else
  {
    fallbackAutoFillGroup = self->_fallbackAutofillGroup;
  }

  return fallbackAutoFillGroup;
}

- (UIKBAutofillController)init
{
  v11.receiver = self;
  v11.super_class = UIKBAutofillController;
  v2 = [(UIKBAutofillController *)&v11 init];
  if (v2)
  {
    if ((_os_feature_enabled_impl() & 1) != 0 || (_os_feature_enabled_impl() & 1) != 0 || _os_feature_enabled_impl())
    {
      v13 = 0;
      v14 = &v13;
      v15 = 0x2050000000;
      v3 = qword_1ED49F978;
      v16 = qword_1ED49F978;
      if (!qword_1ED49F978)
      {
        v12[0] = MEMORY[0x1E69E9820];
        v12[1] = 3221225472;
        v12[2] = __getAFUITargetDetectionControllerClass_block_invoke;
        v12[3] = &unk_1E70F2F20;
        v12[4] = &v13;
        __getAFUITargetDetectionControllerClass_block_invoke(v12);
        v3 = v14[3];
      }

      v4 = v3;
      _Block_object_dispose(&v13, 8);
      v5 = objc_alloc_init(v3);
      targetDetectionController = v2->_targetDetectionController;
      v2->_targetDetectionController = v5;
    }

    v2->_delegateNeedsAutofillMode = 0;
    v2->_shouldSaveAutofill = 0;
    dictionary = [MEMORY[0x1E695DF90] dictionary];
    autofillGroup = v2->_autofillGroup;
    v2->_autofillGroup = dictionary;

    fallbackAutofillGroup = v2->_fallbackAutofillGroup;
    v2->_fallbackAutofillGroup = 0;
  }

  return v2;
}

- (void)setDelegateNeedsAutofillMode:(int64_t)mode
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    if ((mode - 1) >= 0xA)
    {
      mode = 0;
    }

    [(AFUITargetDetectionController_Staging *)targetDetectionController setDelegateNeedsAutofillMode:mode];
  }

  else
  {
    self->_delegateNeedsAutofillMode = mode;
  }
}

- (void)setFallbackAutofillGroup:(id)group
{
  groupCopy = group;
  targetDetectionController = self->_targetDetectionController;
  v7 = groupCopy;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController setFallbackAutoFillGroup:?];
  }

  else
  {
    objc_storeStrong(&self->_fallbackAutofillGroup, group);
  }
}

+ (id)preferredInsertionOrder
{
  v4[31] = *MEMORY[0x1E69E9840];
  v4[0] = @"username";
  v4[1] = @"password";
  v4[2] = @"new-password";
  v4[3] = @"email";
  v4[4] = @"name";
  v4[5] = @"given-name";
  v4[6] = @"additional-name";
  v4[7] = @"family-name";
  v4[8] = @"street-address";
  v4[9] = @"address-line1";
  v4[10] = @"address-line2";
  v4[11] = @"address-level2";
  v4[12] = @"address-level1";
  v4[13] = @"address-level1+2";
  v4[14] = @"address-level3";
  v4[15] = @"country-name";
  v4[16] = @"postal-code";
  v4[17] = @"tel";
  v4[18] = @"bday";
  v4[19] = @"bday-day";
  v4[20] = @"bday-month";
  v4[21] = @"bday-year";
  v4[22] = @"cc-name";
  v4[23] = @"cc-given-name";
  v4[24] = @"cc-additional-name";
  v4[25] = @"cc-family-name";
  v4[26] = @"cc-number";
  v4[27] = @"cc-csc";
  v4[28] = @"cc-exp";
  v4[29] = @"cc-exp-month";
  v4[30] = @"cc-exp-year";
  v2 = [MEMORY[0x1E695DEC8] arrayWithObjects:v4 count:31];

  return v2;
}

+ (unint64_t)translateToTextInputAutofillMode:(int64_t)mode
{
  if ((mode - 1) > 9)
  {
    return 0;
  }

  else
  {
    return qword_18A680760[mode - 1];
  }
}

+ (int64_t)translateToUIAutofillMode:(unint64_t)mode
{
  if (mode - 1 > 7)
  {
    return 0;
  }

  else
  {
    return qword_18A6807B0[mode - 1];
  }
}

- (int64_t)doTraits:(id)traits matchTextContentType:(id)type
{
  traitsCopy = traits;
  typeCopy = type;
  v7 = typeCopy;
  if (!traitsCopy)
  {
    goto LABEL_38;
  }

  if (@"username" == typeCopy)
  {
    textContentType = [traitsCopy textContentType];
    v14 = [textContentType isEqualToString:v7];

    if (v14)
    {
      goto LABEL_36;
    }

    if ([traitsCopy keyboardType] && objc_msgSend(traitsCopy, "keyboardType") != 7 && objc_msgSend(traitsCopy, "keyboardType") != 1)
    {
      goto LABEL_38;
    }

    textContentType2 = [traitsCopy textContentType];
    if (textContentType2 == @"password" || [traitsCopy autocorrectionType] != 1)
    {
      goto LABEL_37;
    }

    isSecureTextEntry = [traitsCopy isSecureTextEntry];

    if (isSecureTextEntry)
    {
      goto LABEL_38;
    }

LABEL_42:
    v19 = 1;
    goto LABEL_39;
  }

  if (@"password" == typeCopy)
  {
    goto LABEL_28;
  }

  if (@"one-time-code" == typeCopy)
  {
    textContentType3 = [traitsCopy textContentType];
    v21 = [textContentType3 isEqualToString:v7];

    if (v21)
    {
      goto LABEL_36;
    }

    if ([traitsCopy keyboardType] && (objc_msgSend(traitsCopy, "isSecureTextEntry") & 1) == 0)
    {
      keyboardType = [traitsCopy keyboardType];
      v19 = 1;
      if (keyboardType <= 0xB && ((1 << keyboardType) & 0x930) != 0 || keyboardType == 127)
      {
        goto LABEL_39;
      }

      if ([traitsCopy keyboardType] != 1)
      {
        goto LABEL_38;
      }
    }

    goto LABEL_42;
  }

  if (@"new-password" != typeCopy)
  {
    if (@"email" != typeCopy && @"tel" != typeCopy && @"street-address" != typeCopy)
    {
      goto LABEL_38;
    }

    textContentType4 = [traitsCopy textContentType];
    v11 = [textContentType4 isEqualToString:v7];

    if ((v11 & 1) == 0)
    {
      if (([traitsCopy isSecureTextEntry] & 1) == 0)
      {
        textContentType2 = [traitsCopy textContentType];
        if (textContentType2)
        {
LABEL_37:

          goto LABEL_38;
        }

        if ([traitsCopy autocorrectionType] != 1 || (_UIIsPrivateMainBundle() & 1) != 0)
        {
          textContentType2 = 0;
          goto LABEL_37;
        }

        goto LABEL_31;
      }

LABEL_38:
      v19 = 0;
      goto LABEL_39;
    }

LABEL_36:
    v19 = 2;
    goto LABEL_39;
  }

LABEL_28:
  textContentType5 = [traitsCopy textContentType];
  v17 = [textContentType5 isEqualToString:v7];

  if (v17)
  {
    goto LABEL_36;
  }

  if (![traitsCopy isSecureTextEntry] || (objc_msgSend(traitsCopy, "displaySecureTextUsingPlainText") & 1) != 0)
  {
    goto LABEL_38;
  }

LABEL_31:
  keyboardType2 = [traitsCopy keyboardType];
  v19 = 1;
  if (keyboardType2 <= 0xB && ((1 << keyboardType2) & 0x930) != 0 || keyboardType2 == 127)
  {
    goto LABEL_38;
  }

LABEL_39:

  return v19;
}

- (id)textContentTypeForInputDelegate:(id)delegate
{
  delegateCopy = delegate;
  v12 = 0;
  v13 = &v12;
  v14 = 0x3032000000;
  v15 = __Block_byref_object_copy__144;
  v16 = __Block_byref_object_dispose__144;
  v17 = 0;
  autofillGroup = [(UIKBAutofillController *)self autofillGroup];
  v9[0] = MEMORY[0x1E69E9820];
  v9[1] = 3221225472;
  v9[2] = __58__UIKBAutofillController_textContentTypeForInputDelegate___block_invoke;
  v9[3] = &unk_1E70FD1E0;
  v6 = delegateCopy;
  v10 = v6;
  v11 = &v12;
  [autofillGroup enumerateKeysAndObjectsUsingBlock:v9];

  v7 = v13[5];
  _Block_object_dispose(&v12, 8);

  return v7;
}

void __58__UIKBAutofillController_textContentTypeForInputDelegate___block_invoke(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v8 = a2;
  if (*(a1 + 32) == a3)
  {
    v9 = v8;
    objc_storeStrong((*(*(a1 + 40) + 8) + 40), a2);
    v8 = v9;
    *a4 = 1;
  }
}

- (id)autofillContextForInputDelegate:(id)delegate
{
  delegateCopy = delegate;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    v6 = [(AFUITargetDetectionController_Staging *)targetDetectionController autoFillContextForResponder:delegateCopy];
  }

  else if (objc_opt_respondsToSelector())
  {
    _autofillContext = [delegateCopy _autofillContext];
    v6 = [_autofillContext copy];
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (void)updateAutofillContextForInputDelegate:(id)delegate
{
  delegateCopy = delegate;
  targetDetectionController = self->_targetDetectionController;
  v10 = delegateCopy;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController updateAutofillContextForResponder:delegateCopy];
  }

  else
  {
    v6 = [(UIKBAutofillController *)self autofillContextForInputDelegate:delegateCopy];
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v8 = autofillGroup;
    if (v6)
    {
      [autofillGroup setObject:v6 forKey:@"UIAutofillContextKey"];

      autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
      [autofillGroup2 setObject:v10 forKey:@"UIAutofillContextDelegateKey"];
    }

    else
    {
      [autofillGroup removeObjectForKey:@"UIAutofillContextDelegateKey"];

      autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
      [autofillGroup2 removeObjectForKey:@"UIAutofillContextKey"];
    }
  }
}

- (int64_t)needAutofillCandidate:(id)candidate delegateAsResponder:(id)responder keyboardState:(id)state
{
  candidateCopy = candidate;
  responderCopy = responder;
  stateCopy = state;
  v11 = [(UIKBAutofillController *)self autofillContextForInputDelegate:candidateCopy];
  [stateCopy setAutofillContext:v11];
  v12 = [v11 objectForKey:@"_automaticPasswordKeyboard"];
  bOOLValue = [v12 BOOLValue];

  v14 = [v11 objectForKey:@"_acceptsLoginCredentials"];
  bOOLValue2 = [v14 BOOLValue];

  if ([(UIKBAutofillController *)self _prohibitAutofill:candidateCopy needASPKeyboard:bOOLValue])
  {
    v16 = 0;
    goto LABEL_17;
  }

  if (!v11 || (-[UIKBAutofillController autofillGroup](self, "autofillGroup"), v17 = objc_claimAutoreleasedReturnValue(), [v17 setObject:v11 forKey:@"UIAutofillContextKey"], v17, ((bOOLValue | bOOLValue2) & 1) == 0))
  {
    targetDetectionController = self->_targetDetectionController;
    if (targetDetectionController)
    {
      v25 = _uiAutofillModeForAFAutoFillMode([(AFUITargetDetectionController_Staging *)targetDetectionController autoFillModeForResponder:candidateCopy]);
    }

    else
    {
      v25 = [(UIKBAutofillController *)self _needAutofillCandidate:candidateCopy delegateAsResponder:responderCopy];
    }

    v16 = v25;
LABEL_13:
    if (!v16)
    {
      goto LABEL_17;
    }

    goto LABEL_14;
  }

  autofillGroup = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup removeObjectForKey:@"username"];

  autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup2 removeObjectForKey:@"password"];

  autofillGroup3 = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup3 removeObjectForKey:@"one-time-code"];

  v21 = candidateCopy;
  if (([v21 __isKindOfUIResponder] & 1) == 0)
  {
    v22 = responderCopy;

    v21 = v22;
  }

  autofillGroup4 = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup4 setObject:v21 forKey:@"UIAutofillContextDelegateKey"];

  if ((bOOLValue & 1) == 0)
  {
    v16 = bOOLValue2;
    goto LABEL_13;
  }

  v16 = 2;
LABEL_14:
  v26 = [(UIKBAutofillController *)self autofillContextForInputDelegate:candidateCopy];

  [stateCopy setAutofillContext:v26];
  documentIdentifier = [stateCopy documentIdentifier];

  if (documentIdentifier)
  {
    autofillGroup5 = [(UIKBAutofillController *)self autofillGroup];
    documentIdentifier2 = [stateCopy documentIdentifier];
    [autofillGroup5 setObject:documentIdentifier2 forKey:@"UIAutofillUUIDKey"];
  }

  v11 = v26;
LABEL_17:

  return v16;
}

- (BOOL)_prohibitAutofill:(id)autofill needASPKeyboard:(BOOL)keyboard
{
  keyboardCopy = keyboard;
  autofillCopy = autofill;
  v6 = +[UIKeyboard keyboardBundleIdentifier];
  if ([v6 isEqualToString:@"com.apple.purplebuddy"] & 1) != 0 || (objc_msgSend(v6, "isEqualToString:", @"com.apple.PassbookUIService"))
  {
    v7 = 1;
  }

  else
  {
    v7 = [v6 isEqualToString:@"com.apple.Spotlight"];
  }

  _isSpringBoard = [UIApp _isSpringBoard];
  IsPasswordManagerExtension = _UIApplicationIsPasswordManagerExtension();
  v9 = [v6 isEqualToString:@"com.apple.SafariViewService"];
  if ([v6 isEqualToString:@"com.apple.mobilesafari"] & 1) != 0 || (objc_msgSend(v6, "isEqualToString:", @"com.apple.DataActivation"))
  {
    v10 = 1;
  }

  else
  {
    v10 = [v6 isEqualToString:@"com.apple.WebSheet"];
  }

  v11 = +[UIKeyboardPreferencesController sharedPreferencesController];
  preferencesActions = [v11 preferencesActions];
  isPasswordAutoFillAllowed = [preferencesActions isPasswordAutoFillAllowed];

  if (isPasswordAutoFillAllowed)
  {
    if (keyboardCopy && ((v9 | v10) & 1) != 0)
    {
      v14 = 0;
    }

    else
    {
      objc_opt_class();
      isKindOfClass = objc_opt_isKindOfClass();
      _conformsToProtocolBETextInput = [autofillCopy conformsToProtocol:&unk_1F016CC30];
      if ((_conformsToProtocolBETextInput & 1) == 0 && (isKindOfClass & 1) == 0)
      {
        _conformsToProtocolBETextInput = [autofillCopy _conformsToProtocolBETextInput];
      }

      if (((v7 | _isSpringBoard) | (IsPasswordManagerExtension | v9)))
      {
        v14 = 1;
      }

      else
      {
        v14 = v10 & _conformsToProtocolBETextInput;
      }
    }
  }

  else
  {
    v14 = 1;
  }

  return v14;
}

- (id)signupKeywordList
{
  if (qword_1ED49F900 != -1)
  {
    dispatch_once(&qword_1ED49F900, &__block_literal_global_426);
  }

  v3 = qword_1ED49F8F8;

  return v3;
}

void __43__UIKBAutofillController_signupKeywordList__block_invoke()
{
  v0 = qword_1ED49F8F8;
  qword_1ED49F8F8 = &unk_1EFE2CF58;
}

- (id)loginKeywordList
{
  if (qword_1ED49F910 != -1)
  {
    dispatch_once(&qword_1ED49F910, &__block_literal_global_236);
  }

  v3 = qword_1ED49F908;

  return v3;
}

void __42__UIKBAutofillController_loginKeywordList__block_invoke()
{
  v0 = qword_1ED49F908;
  qword_1ED49F908 = &unk_1EFE2CF70;
}

- (id)accessibilitySignupKeywordList
{
  if (qword_1ED49F920 != -1)
  {
    dispatch_once(&qword_1ED49F920, &__block_literal_global_253_1);
  }

  v3 = qword_1ED49F918;

  return v3;
}

void __56__UIKBAutofillController_accessibilitySignupKeywordList__block_invoke()
{
  v0 = qword_1ED49F918;
  qword_1ED49F918 = &unk_1EFE2CF88;
}

- (id)accessibilityLoginKeywordList
{
  if (qword_1ED49F930 != -1)
  {
    dispatch_once(&qword_1ED49F930, &__block_literal_global_258_1);
  }

  v3 = qword_1ED49F928;

  return v3;
}

void __55__UIKBAutofillController_accessibilityLoginKeywordList__block_invoke()
{
  v0 = qword_1ED49F928;
  qword_1ED49F928 = &unk_1EFE2CFA0;
}

- (id)contactAutoFillKeywordsForKey:(id)key value:(id)value localizedKeywords:(id)keywords
{
  valueCopy = value;
  keyCopy = key;
  v9 = [keywords componentsSeparatedByString:@"|"];
  v10 = _UIKitBundle();
  _preferredEnglishLocalizationBundle = [v10 _preferredEnglishLocalizationBundle];

  v12 = [_preferredEnglishLocalizationBundle localizedStringForKey:keyCopy value:valueCopy table:@"Localizable"];

  v13 = [v12 componentsSeparatedByString:@"|"];

  v14 = [objc_alloc(MEMORY[0x1E695DFA8]) initWithArray:v9];
  [v14 addObjectsFromArray:v13];
  v15 = [v14 copy];

  return v15;
}

- (id)searchKeywordSet
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __42__UIKBAutofillController_searchKeywordSet__block_invoke;
  block[3] = &unk_1E70F3590;
  block[4] = self;
  if (qword_1ED49F940 != -1)
  {
    dispatch_once(&qword_1ED49F940, block);
  }

  return qword_1ED49F938;
}

void __42__UIKBAutofillController_searchKeywordSet__block_invoke(uint64_t a1)
{
  v1 = *(a1 + 32);
  v4 = _UINSLocalizedStringWithDefaultValue(@"SEARCH_FIELD_SEARCH_TERMS", @"search|query");
  v2 = [v1 contactAutoFillKeywordsForKey:@"SEARCH_FIELD_SEARCH_TERMS" value:@"search|query" localizedKeywords:v4];
  v3 = qword_1ED49F938;
  qword_1ED49F938 = v2;
}

- (id)addressKeywordSet
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __43__UIKBAutofillController_addressKeywordSet__block_invoke;
  block[3] = &unk_1E70F3590;
  block[4] = self;
  if (qword_1ED49F950 != -1)
  {
    dispatch_once(&qword_1ED49F950, block);
  }

  return qword_1ED49F948;
}

void __43__UIKBAutofillController_addressKeywordSet__block_invoke(uint64_t a1)
{
  v1 = *(a1 + 32);
  v4 = _UINSLocalizedStringWithDefaultValue(@"Address_FIELD_SEARCH_TERMS", @"address|where|destination|location");
  v2 = [v1 contactAutoFillKeywordsForKey:@"Address_FIELD_SEARCH_TERMS" value:@"address|where|destination|location" localizedKeywords:v4];
  v3 = qword_1ED49F948;
  qword_1ED49F948 = v2;
}

- (id)phoneKeywordSet
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __41__UIKBAutofillController_phoneKeywordSet__block_invoke;
  block[3] = &unk_1E70F3590;
  block[4] = self;
  if (qword_1ED49F960 != -1)
  {
    dispatch_once(&qword_1ED49F960, block);
  }

  return qword_1ED49F958;
}

void __41__UIKBAutofillController_phoneKeywordSet__block_invoke(uint64_t a1)
{
  v1 = *(a1 + 32);
  v4 = _UINSLocalizedStringWithDefaultValue(@"PHONE_FIELD_SEARCH_TERMS", @"phone|mobile|telephone");
  v2 = [v1 contactAutoFillKeywordsForKey:@"PHONE_FIELD_SEARCH_TERMS" value:@"phone|mobile|telephone" localizedKeywords:v4];
  v3 = qword_1ED49F958;
  qword_1ED49F958 = v2;
}

- (id)emailKeywordSet
{
  block[0] = MEMORY[0x1E69E9820];
  block[1] = 3221225472;
  block[2] = __41__UIKBAutofillController_emailKeywordSet__block_invoke;
  block[3] = &unk_1E70F3590;
  block[4] = self;
  if (qword_1ED49F970 != -1)
  {
    dispatch_once(&qword_1ED49F970, block);
  }

  return qword_1ED49F968;
}

void __41__UIKBAutofillController_emailKeywordSet__block_invoke(uint64_t a1)
{
  v1 = *(a1 + 32);
  v4 = _UINSLocalizedStringWithDefaultValue(@"EMAIL_FIELD_SEARCH_TERMS", @"email|e-mail");
  v2 = [v1 contactAutoFillKeywordsForKey:@"EMAIL_FIELD_SEARCH_TERMS" value:@"email|e-mail" localizedKeywords:v4];
  v3 = qword_1ED49F968;
  qword_1ED49F968 = v2;
}

- (id)processLocalizedString:(id)string
{
  stringCopy = string;
  array = [MEMORY[0x1E695DF70] array];
  if (stringCopy)
  {
    mainBundle = [MEMORY[0x1E696AAE8] mainBundle];
    v17 = 0;
    v18 = 0;
    [mainBundle _searchForLocalizedString:stringCopy foundKey:&v18 foundTable:&v17];
    v6 = v18;
    v7 = v17;

    if (!v6 || !v7 || ([MEMORY[0x1E696AAE8] mainBundle], v8 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v8, "_preferredEnglishLocalizationBundle"), v9 = objc_claimAutoreleasedReturnValue(), v8, objc_msgSend(v9, "localizedStringForKey:value:table:", v6, stringCopy, v7), v10 = objc_claimAutoreleasedReturnValue(), v9, !v10))
    {
      v10 = stringCopy;
    }

    v11 = [v10 length];
    v15[0] = MEMORY[0x1E69E9820];
    v15[1] = 3221225472;
    v15[2] = __49__UIKBAutofillController_processLocalizedString___block_invoke;
    v15[3] = &unk_1E7115940;
    v12 = array;
    v16 = v12;
    [v10 enumerateSubstringsInRange:0 options:v11 usingBlock:{3, v15}];
    lowercaseString = [v10 lowercaseString];
    [v12 addObject:lowercaseString];
  }

  return array;
}

void __49__UIKBAutofillController_processLocalizedString___block_invoke(uint64_t a1, void *a2)
{
  v2 = *(a1 + 32);
  v3 = [a2 lowercaseString];
  [v2 addObject:v3];
}

- (id)textSignalsForResponder:(id)responder
{
  responderCopy = responder;
  v5 = [MEMORY[0x1E695DFA8] set];
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    _viewControllerForAncestor = [responderCopy _viewControllerForAncestor];
    if (objc_opt_respondsToSelector())
    {
      v7 = [_viewControllerForAncestor performSelector:sel_textField];
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        placeholder = [v7 placeholder];
        v9 = [(UIKBAutofillController *)self processLocalizedString:placeholder];
        [v5 addObjectsFromArray:v9];
      }
    }
  }

  accessibilityHint = [responderCopy accessibilityHint];
  v11 = [(UIKBAutofillController *)self processLocalizedString:accessibilityHint];
  [v5 addObjectsFromArray:v11];

  accessibilityLabel = [responderCopy accessibilityLabel];
  v13 = [(UIKBAutofillController *)self processLocalizedString:accessibilityLabel];
  [v5 addObjectsFromArray:v13];

  if (objc_opt_respondsToSelector())
  {
    v14 = [responderCopy performSelector:sel_placeholder];
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v15 = [(UIKBAutofillController *)self processLocalizedString:v14];
      [v5 addObjectsFromArray:v15];
    }
  }

  v16 = [v5 copy];

  return v16;
}

- (int64_t)containsIndicationInText:(id)text withAccessibilityHints:(BOOL)hints
{
  v30 = *MEMORY[0x1E69E9840];
  textCopy = text;
  v7 = textCopy;
  if (textCopy && [textCopy length])
  {
    if (hints)
    {
      [(UIKBAutofillController *)self accessibilityLoginKeywordList];
    }

    else
    {
      [(UIKBAutofillController *)self loginKeywordList];
    }

    v26 = 0u;
    v27 = 0u;
    v24 = 0u;
    v9 = v25 = 0u;
    v10 = [v9 countByEnumeratingWithState:&v24 objects:v29 count:16];
    if (v10)
    {
      v11 = v10;
      v12 = *v25;
      v8 = 1;
      while (2)
      {
        for (i = 0; i != v11; ++i)
        {
          if (*v25 != v12)
          {
            objc_enumerationMutation(v9);
          }

          if ([v7 localizedCaseInsensitiveContainsString:*(*(&v24 + 1) + 8 * i)])
          {
            v14 = v9;
            goto LABEL_29;
          }
        }

        v11 = [v9 countByEnumeratingWithState:&v24 objects:v29 count:16];
        if (v11)
        {
          continue;
        }

        break;
      }
    }

    if (hints)
    {
      [(UIKBAutofillController *)self accessibilitySignupKeywordList];
    }

    else
    {
      [(UIKBAutofillController *)self signupKeywordList];
    }

    v22 = 0u;
    v23 = 0u;
    v20 = 0u;
    v14 = v21 = 0u;
    v15 = [v14 countByEnumeratingWithState:&v20 objects:v28 count:16];
    if (v15)
    {
      v16 = v15;
      v17 = *v21;
      v8 = 2;
LABEL_21:
      v18 = 0;
      while (1)
      {
        if (*v21 != v17)
        {
          objc_enumerationMutation(v14);
        }

        if ([v7 localizedCaseInsensitiveContainsString:{*(*(&v20 + 1) + 8 * v18), v20}])
        {
          break;
        }

        if (v16 == ++v18)
        {
          v16 = [v14 countByEnumeratingWithState:&v20 objects:v28 count:16];
          if (v16)
          {
            goto LABEL_21;
          }

          goto LABEL_27;
        }
      }
    }

    else
    {
LABEL_27:
      v8 = 0;
    }

LABEL_29:
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (int64_t)signUpSignalFromButton:(id)button
{
  v33 = *MEMORY[0x1E69E9840];
  buttonCopy = button;
  text = [buttonCopy titleForState:{objc_msgSend(buttonCopy, "state")}];
  if (!text)
  {
    titleLabel = [buttonCopy titleLabel];
    text = [titleLabel text];
  }

  v7 = [(UIKBAutofillController *)self containsIndicationInText:text withAccessibilityHints:0];
  if (!v7)
  {
    [buttonCopy allTargets];
    v27 = 0u;
    v28 = 0u;
    v29 = 0u;
    v8 = v30 = 0u;
    v21 = [v8 countByEnumeratingWithState:&v27 objects:v32 count:16];
    if (v21)
    {
      v9 = *v28;
      v20 = *v28;
      do
      {
        for (i = 0; i != v21; ++i)
        {
          if (*v28 != v9)
          {
            objc_enumerationMutation(v8);
          }

          v11 = [buttonCopy actionsForTarget:*(*(&v27 + 1) + 8 * i) forControlEvent:64];
          v23 = 0u;
          v24 = 0u;
          v25 = 0u;
          v26 = 0u;
          v12 = v11;
          v13 = [v12 countByEnumeratingWithState:&v23 objects:v31 count:16];
          if (v13)
          {
            v14 = v13;
            v15 = *v24;
            while (2)
            {
              for (j = 0; j != v14; ++j)
              {
                if (*v24 != v15)
                {
                  objc_enumerationMutation(v12);
                }

                v17 = [(UIKBAutofillController *)self containsIndicationInText:*(*(&v23 + 1) + 8 * j) withAccessibilityHints:0];
                if (v17)
                {
                  v7 = v17;

                  goto LABEL_23;
                }
              }

              v14 = [v12 countByEnumeratingWithState:&v23 objects:v31 count:16];
              if (v14)
              {
                continue;
              }

              break;
            }
          }

          v9 = v20;
        }

        v21 = [v8 countByEnumeratingWithState:&v27 objects:v32 count:16];
      }

      while (v21);
    }

    if ([text length])
    {
      mainBundle = [MEMORY[0x1E696AAE8] mainBundle];
      v22 = 0;
      [mainBundle _searchForLocalizedString:text foundKey:&v22 foundTable:0];
      v8 = v22;

      if (v8)
      {
        v7 = [(UIKBAutofillController *)self containsIndicationInText:v8 withAccessibilityHints:0];
      }

      else
      {
        v7 = 0;
      }

LABEL_23:
    }

    else
    {
      v7 = 0;
    }
  }

  return v7;
}

- (int64_t)signUpSignalFromViewControllerHierarchy:(id)hierarchy
{
  v23 = *MEMORY[0x1E69E9840];
  hierarchyCopy = hierarchy;
  v5 = objc_opt_class();
  v6 = NSStringFromClass(v5);
  v7 = [(UIKBAutofillController *)self containsIndicationInText:v6 withAccessibilityHints:0];

  if (!v7)
  {
    [hierarchyCopy childViewControllers];
    v18 = 0u;
    v19 = 0u;
    v20 = 0u;
    v8 = v21 = 0u;
    v9 = [v8 countByEnumeratingWithState:&v18 objects:v22 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v19;
      do
      {
        v12 = 0;
        do
        {
          if (*v19 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v13 = *(*(&v18 + 1) + 8 * v12);
          if (([v13 isBeingPresented] & 1) != 0 || (objc_msgSend(v13, "isMovingToParentViewController") & 1) != 0 || v13 && (v13[94] & 3u) - 1 <= 1)
          {
            v14 = objc_opt_class();
            v15 = NSStringFromClass(v14);
            v7 = [(UIKBAutofillController *)self containsIndicationInText:v15 withAccessibilityHints:0];

            if (v7)
            {
              goto LABEL_18;
            }
          }

          else
          {
            v7 = [(UIKBAutofillController *)self signUpSignalFromViewControllerHierarchy:v13];
          }

          ++v12;
        }

        while (v10 != v12);
        v16 = [v8 countByEnumeratingWithState:&v18 objects:v22 count:16];
        v10 = v16;
      }

      while (v16);
    }

    else
    {
      v7 = 0;
    }

LABEL_18:
  }

  return v7;
}

- (int64_t)signUpSignalFromNavBarItem:(id)item
{
  itemCopy = item;
  navigationBar = [itemCopy navigationBar];
  topItem = [navigationBar topItem];
  rightBarButtonItem = [topItem rightBarButtonItem];

  customView = [rightBarButtonItem customView];
  if (!customView || (v9 = customView, [rightBarButtonItem customView], v10 = objc_claimAutoreleasedReturnValue(), objc_opt_class(), isKindOfClass = objc_opt_isKindOfClass(), v10, v9, (isKindOfClass & 1) == 0) || (objc_msgSend(rightBarButtonItem, "customView"), v12 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v12, "titleForState:", 0), title = objc_claimAutoreleasedReturnValue(), v12, !title))
  {
    title = [rightBarButtonItem title];

    if (!title)
    {
      goto LABEL_13;
    }

    title = [rightBarButtonItem title];
    if (!title)
    {
      goto LABEL_13;
    }
  }

  if (([itemCopy isNavigationBarHidden] & 1) == 0)
  {
    if ([title length])
    {
      v14 = [(UIKBAutofillController *)self containsIndicationInText:title withAccessibilityHints:0];
      if (v14)
      {
        v15 = v14;
        goto LABEL_16;
      }
    }
  }

  if (![title length])
  {
LABEL_13:
    v15 = 0;
    goto LABEL_16;
  }

  mainBundle = [MEMORY[0x1E696AAE8] mainBundle];
  v19 = 0;
  [mainBundle _searchForLocalizedString:title foundKey:&v19 foundTable:0];
  v17 = v19;

  if (v17)
  {
    v15 = [(UIKBAutofillController *)self containsIndicationInText:v17 withAccessibilityHints:0];
  }

  else
  {
    v15 = 0;
  }

LABEL_16:
  return v15;
}

- (int64_t)contactAutofillModeWithAutofillGroup:(id)group responders:(id)responders
{
  v40 = *MEMORY[0x1E69E9840];
  groupCopy = group;
  v6 = [groupCopy objectForKey:@"email"];

  if (v6)
  {
    v7 = 5;
  }

  else
  {
    v8 = [groupCopy objectForKey:@"tel"];

    if (v8)
    {
      v7 = 6;
    }

    else
    {
      v9 = [groupCopy objectForKey:@"street-address"];

      if (v9)
      {
        v7 = 7;
      }

      else
      {
        v10 = [groupCopy objectForKey:@"UIAutofillContactHeuristicsKey"];

        if (v10)
        {
          v11 = [groupCopy objectForKey:@"UIAutofillContactHeuristicsKey"];
          v12 = [UITextInputTraits traitsByAdoptingTraits:v11 lightweight:1];
          v13 = [(UIKBAutofillController *)self textSignalsForResponder:v11];
          emailKeywordSet = [(UIKBAutofillController *)self emailKeywordSet];
          v15 = _UIKBTextSignalsFoundInKeywordsList(v13, emailKeywordSet);

          if (v15)
          {
            [v12 keyboardType];
            v7 = 5;
          }

          else
          {
            v33 = v13;
            selfCopy = self;
            v37 = 0u;
            v38 = 0u;
            v35 = 0u;
            v36 = 0u;
            v16 = v13;
            v17 = [v16 countByEnumeratingWithState:&v35 objects:v39 count:16];
            v34 = v11;
            if (v17)
            {
              v18 = v17;
              v19 = 0;
              v20 = *v36;
              do
              {
                v21 = 0;
                do
                {
                  if (*v36 != v20)
                  {
                    objc_enumerationMutation(v16);
                  }

                  v22 = *(*(&v35 + 1) + 8 * v21);
                  if (qword_1ED49F990 != -1)
                  {
                    dispatch_once(&qword_1ED49F990, &__block_literal_global_859);
                  }

                  v23 = qword_1ED49F988;
                  v24 = [v23 numberOfMatchesInString:v22 options:0 range:{0, objc_msgSend(v22, "length")}];

                  v19 |= v24 != 0;
                  ++v21;
                }

                while (v18 != v21);
                v18 = [v16 countByEnumeratingWithState:&v35 objects:v39 count:16];
              }

              while (v18);
            }

            else
            {
              v19 = 0;
            }

            v7 = 5;
            v11 = v34;
            if ([v12 keyboardType] == 7)
            {
              v13 = v33;
            }

            else
            {
              v13 = v33;
              if ((v19 & 1) == 0)
              {
                searchKeywordSet = [(UIKBAutofillController *)selfCopy searchKeywordSet];
                v26 = (_UIKBTextSignalsFoundInKeywordsList(v16, searchKeywordSet) & 1) == 0 && [v12 returnKeyType] != 6;

                addressKeywordSet = [(UIKBAutofillController *)selfCopy addressKeywordSet];
                v28 = _UIKBTextSignalsFoundInKeywordsList(v16, addressKeywordSet);

                if (qword_1ED49F998 != -1)
                {
                  dispatch_once(&qword_1ED49F998, &__block_literal_global_865);
                }

                if ((v26 || (_MergedGlobals_1217 & 1) == 0) && (!v28 || [v12 keyboardType] == 10))
                {
                  phoneKeywordSet = [(UIKBAutofillController *)selfCopy phoneKeywordSet];
                  v30 = _UIKBTextSignalsFoundInKeywordsList(v16, phoneKeywordSet);

                  if (v30 && [v12 keyboardType] != 3)
                  {
                    v7 = 6;
                  }

                  else
                  {
                    v7 = 0;
                  }
                }

                else
                {
                  v7 = 7;
                }
              }
            }
          }
        }

        else
        {
          v7 = 0;
        }
      }
    }
  }

  return v7;
}

- (BOOL)signupHintForUsername:(id)username password:(id)password responder:(id)responder
{
  usernameCopy = username;
  passwordCopy = password;
  responderCopy = responder;
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v11 = usernameCopy;
  }

  else
  {
    v11 = 0;
  }

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v12 = passwordCopy;
  }

  else
  {
    v12 = 0;
  }

  accessibilityHint = [v11 accessibilityHint];
  v14 = [(UIKBAutofillController *)self containsIndicationInText:accessibilityHint withAccessibilityHints:1];

  if (v14 || ([v11 accessibilityLabel], v15 = objc_claimAutoreleasedReturnValue(), v14 = -[UIKBAutofillController containsIndicationInText:withAccessibilityHints:](self, "containsIndicationInText:withAccessibilityHints:", v15, 1), v15, v14) || (objc_msgSend(v11, "accessibilityIdentifier"), v16 = objc_claimAutoreleasedReturnValue(), v14 = -[UIKBAutofillController containsIndicationInText:withAccessibilityHints:](self, "containsIndicationInText:withAccessibilityHints:", v16, 1), v16, v14) || (objc_msgSend(v12, "accessibilityHint"), v17 = objc_claimAutoreleasedReturnValue(), v14 = -[UIKBAutofillController containsIndicationInText:withAccessibilityHints:](self, "containsIndicationInText:withAccessibilityHints:", v17, 1), v17, v14) || (objc_msgSend(v12, "accessibilityLabel"), v18 = objc_claimAutoreleasedReturnValue(), v14 = -[UIKBAutofillController containsIndicationInText:withAccessibilityHints:](self, "containsIndicationInText:withAccessibilityHints:", v18, 1), v18, v14) || (objc_msgSend(v12, "accessibilityIdentifier"), v19 = objc_claimAutoreleasedReturnValue(), v14 = -[UIKBAutofillController containsIndicationInText:withAccessibilityHints:](self, "containsIndicationInText:withAccessibilityHints:", v19, 1), v19, v14))
  {
    v49 = 0;
    v50 = &v49;
    v51 = 0x2020000000;
    v52 = 0;
  }

  else
  {
    if ([usernameCopy isFirstResponder] && (objc_opt_class(), isKindOfClass = objc_opt_isKindOfClass(), v22 = usernameCopy, (isKindOfClass & 1) != 0) || objc_msgSend(passwordCopy, "isFirstResponder") && (objc_opt_class(), v23 = objc_opt_isKindOfClass(), v22 = passwordCopy, (v23 & 1) != 0))
    {
      _viewControllerForAncestor = [v22 _viewControllerForAncestor];
      v14 = [(UIKBAutofillController *)self signUpSignalFromViewControllerHierarchy:_viewControllerForAncestor];
    }

    else
    {
      v14 = 0;
      _viewControllerForAncestor = 0;
    }

    parentViewController = [_viewControllerForAncestor parentViewController];
    objc_opt_class();
    v26 = objc_opt_isKindOfClass();

    if (v26)
    {
      parentViewController2 = [_viewControllerForAncestor parentViewController];
      v28 = [(UIKBAutofillController *)self signUpSignalFromNavBarItem:parentViewController2];
    }

    else
    {
      v28 = 0;
    }

    objc_opt_class();
    v29 = objc_opt_isKindOfClass();
    v31 = v28 == v14 && v28 != 0;
    v32 = v29 | v31;
    if (!v14)
    {
      v33 = +[UIWindow _applicationKeyWindow];
      [v33 rootViewController];
      v34 = v44 = v32;
      presentedViewController = [v34 presentedViewController];

      v32 = v44;
      v14 = [(UIKBAutofillController *)self signUpSignalFromViewControllerHierarchy:presentedViewController];
    }

    v49 = 0;
    v50 = &v49;
    v51 = 0x2020000000;
    v52 = 0;
    if ((v32 & 1) == 0 || !v14)
    {
      autofillGroup = [(UIKBAutofillController *)self autofillGroup];
      allValues = [autofillGroup allValues];

      v38 = [MEMORY[0x1E695DF70] arrayWithCapacity:3];
      v46[0] = MEMORY[0x1E69E9820];
      v46[1] = 3221225472;
      v46[2] = __67__UIKBAutofillController_signupHintForUsername_password_responder___block_invoke;
      v46[3] = &unk_1E7119558;
      v39 = allValues;
      v47 = v39;
      v40 = v38;
      v48 = v40;
      [responderCopy enumerateObjectsWithOptions:2 usingBlock:v46];
      v41 = [v40 count];
      v45[0] = MEMORY[0x1E69E9820];
      v45[1] = 3221225472;
      v45[2] = __67__UIKBAutofillController_signupHintForUsername_password_responder___block_invoke_2;
      v45[3] = &unk_1E7119580;
      v45[4] = self;
      v45[5] = &v49;
      [v40 enumerateObjectsUsingBlock:v45];

      v42 = v50[3];
      if (v14)
      {
        if (v42)
        {
          if (v41 >= 3)
          {
            v43 = v14;
          }

          else
          {
            v43 = v50[3];
          }

          if (v14 != v42)
          {
            v14 = v43;
          }
        }
      }

      else
      {
        v14 = v50[3];
      }
    }
  }

  _Block_object_dispose(&v49, 8);

  return v14 == 2;
}

void __67__UIKBAutofillController_signupHintForUsername_password_responder___block_invoke(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v6 = a2;
  if ([*(a1 + 32) containsObject:?])
  {
    *a4 = 1;
  }

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    [*(a1 + 40) insertObject:v6 atIndex:0];
  }
}

uint64_t __67__UIKBAutofillController_signupHintForUsername_password_responder___block_invoke_2(uint64_t result, uint64_t a2, unint64_t a3, _BYTE *a4)
{
  if (a3 > 2 || (v4 = result, *(*(*(result + 40) + 8) + 24)))
  {
    *a4 = 1;
  }

  else
  {
    result = [*(result + 32) signUpSignalFromButton:a2];
    *(*(*(v4 + 40) + 8) + 24) = result;
  }

  return result;
}

- (int64_t)_needAutofillCandidate:(id)candidate delegateAsResponder:(id)responder
{
  v155 = *MEMORY[0x1E69E9840];
  candidateCopy = candidate;
  responderCopy = responder;
  if ([candidateCopy __isKindOfUIResponder])
  {
    v6 = [candidateCopy conformsToProtocol:&unk_1EFE8A8A0];
  }

  else
  {
    v6 = 0;
  }

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v7 = [candidateCopy conformsToProtocol:&unk_1EFE3B1B0];
  }

  else
  {
    v7 = 0;
  }

  if (v6)
  {
    v8 = candidateCopy;
  }

  else
  {
    v8 = 0;
  }

  v135 = candidateCopy;
  if ((v6 | v7))
  {
    [(UIKBAutofillController *)self clearAutofillGroup];
    v136 = candidateCopy;
    v133 = v8;
    v150 = 0;
    v151 = &v150;
    v152 = 0x2020000000;
    v153 = 0x7FFFFFFFFFFFFFFFLL;
    array = [MEMORY[0x1E695DF70] array];
    [v133 _gatherKeyResponders:array indexOfSelf:v151 + 3 visibilityTest:&__block_literal_global_586_0 passingTest:&__block_literal_global_588 subviewsTest:&__block_literal_global_725];
    v137 = array;
    if ([array count] >= 3)
    {
      array2 = [MEMORY[0x1E695DF70] array];
      v148 = 0u;
      v149 = 0u;
      v146 = 0u;
      v147 = 0u;
      v10 = array;
      v11 = [v10 countByEnumeratingWithState:&v146 objects:v154 count:16];
      if (v11)
      {
        v12 = *v147;
        do
        {
          for (i = 0; i != v11; ++i)
          {
            if (*v147 != v12)
            {
              objc_enumerationMutation(v10);
            }

            v14 = *(*(&v146 + 1) + 8 * i);
            objc_opt_class();
            if (objc_opt_isKindOfClass())
            {
              v15 = v14;
              [v15 frame];
              if (!CGRectIsEmpty(v156))
              {
                [v15 bounds];
                [v15 convertRect:0 toView:?];
                v17 = v16;
                v19 = v18;
                v21 = v20;
                v23 = v22;
                window = [v15 window];
                window2 = [v15 window];
                windowScene = [window2 windowScene];
                _coordinateSpace = [windowScene _coordinateSpace];
                [window convertRect:_coordinateSpace toCoordinateSpace:{v17, v19, v21, v23}];
                v29 = v28;
                v31 = v30;
                v33 = v32;
                v35 = v34;

                window3 = [v15 window];
                windowScene2 = [window3 windowScene];
                _coordinateSpace2 = [windowScene2 _coordinateSpace];
                [_coordinateSpace2 bounds];
                v160.origin.x = v39;
                v160.origin.y = v40;
                v160.size.width = v41;
                v160.size.height = v42;
                v157.origin.x = v29;
                v157.origin.y = v31;
                v157.size.width = v33;
                v157.size.height = v35;
                v158 = CGRectIntersection(v157, v160);
                x = v158.origin.x;
                y = v158.origin.y;
                width = v158.size.width;
                height = v158.size.height;

                v159.origin.x = x;
                v159.origin.y = y;
                v159.size.width = width;
                v159.size.height = height;
                if (CGRectIsEmpty(v159))
                {
                  [array2 addObject:v15];
                }
              }
            }
          }

          v11 = [v10 countByEnumeratingWithState:&v146 objects:v154 count:16];
        }

        while (v11);
      }

      v47 = [v10 count];
      if ((v47 - [array2 count]) >= 4)
      {
        [v10 removeObjectsInArray:array2];
      }

      array = v137;
    }

    v151[3] = 0x7FFFFFFFFFFFFFFFLL;
    v48 = [MEMORY[0x1E695DF70] arrayWithCapacity:{objc_msgSend(array, "count")}];
    v142[0] = MEMORY[0x1E69E9820];
    v142[1] = 3221225472;
    v142[2] = __69__UIKBAutofillController__needAutofillCandidate_delegateAsResponder___block_invoke_4;
    v142[3] = &unk_1E71195C8;
    v120 = v133;
    v143 = v120;
    v145 = &v150;
    v141 = v48;
    v144 = v141;
    [array enumerateObjectsUsingBlock:v142];
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    [autofillGroup setObject:v141 forKey:@"UIAutofillPossibleRespondersKey"];

    if (v151[3] == 0x7FFFFFFFFFFFFFFFLL)
    {
      v50 = 0;
      v51 = 0;
      v132 = 0;
      v52 = 0;
      v53 = v137;
    }

    else
    {
      v53 = v137;
      if ([v141 count])
      {
        v56 = [v141 count];
        v57 = v151[3];
        if (v57)
        {
          v52 = [v141 objectAtIndex:v57 - 1];
          v58 = 0;
          v57 = v151[3];
          if (v57 >= 2 && v56 >= 3)
          {
            v58 = [v141 objectAtIndex:v57 - 2];
            v57 = v151[3];
          }
        }

        else
        {
          v52 = 0;
          v58 = 0;
        }

        v51 = 0;
        if (v56 >= 1 && v57 < v56 - 1)
        {
          v51 = [v141 objectAtIndex:v57 + 1];
          v57 = v151[3];
        }

        v50 = 0;
        v132 = v58;
        if (v56 >= 2 && v57 < v56 - 2)
        {
          v50 = [v141 objectAtIndex:v57 + 2];
        }
      }

      else
      {
        v50 = 0;
        v51 = 0;
        v132 = 0;
        v52 = 0;
      }
    }

    v59 = [UITextInputTraits traitsByAdoptingTraits:v136 lightweight:1];
    if (v52)
    {
      v126 = [UITextInputTraits traitsByAdoptingTraits:v52 lightweight:1];
    }

    else
    {
      v126 = 0;
    }

    if (v132)
    {
      v124 = [UITextInputTraits traitsByAdoptingTraits:v132 lightweight:1];
      if (v51)
      {
        goto LABEL_51;
      }
    }

    else
    {
      v124 = 0;
      if (v51)
      {
LABEL_51:
        v128 = [UITextInputTraits traitsByAdoptingTraits:v51 lightweight:1];
        if (v50)
        {
LABEL_52:
          v122 = [UITextInputTraits traitsByAdoptingTraits:v50 lightweight:1];
LABEL_56:
          v134 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v125 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v60 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v61 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v127 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v119 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v123 = [(UIKBAutofillController *)self doTraits:v59 matchTextContentType:?];
          v131 = 0;
          v129 = v51;
          v130 = v52;
          v121 = v50;
          if (v61 && v61 > v134 && v61 > v125)
          {
            objc_opt_class();
            if (objc_opt_isKindOfClass())
            {
              v131 = 0;
            }

            else
            {
              v131 = v61 == 2;
              autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup2 setObject:v136 forKey:@"one-time-code"];

              v53 = v137;
            }
          }

          v63 = dyld_program_sdk_at_least();
          if (v131)
          {
            goto LABEL_63;
          }

          v66 = v63;
          if (v134)
          {
            autofillGroup3 = [(UIKBAutofillController *)self autofillGroup];
            [autofillGroup3 setObject:v136 forKey:@"username"];

            v64 = v59;
            v53 = v137;
            if ([(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"new-password"]== 2)
            {
              autofillGroup4 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup4 setObject:v51 forKey:@"new-password"];

LABEL_77:
              v65 = 0;
              v118 = 1;
LABEL_78:
              v53 = v137;
              goto LABEL_79;
            }

            if ([(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"password"])
            {
              autofillGroup5 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup5 setObject:v51 forKey:@"password"];

              v53 = v137;
              v73 = v50;
              if ([(UIKBAutofillController *)self doTraits:v122 matchTextContentType:@"new-password"])
              {
LABEL_76:
                autofillGroup6 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup6 setObject:v73 forKey:@"new-password"];

                goto LABEL_77;
              }

              if (v134 == 2)
              {
                v99 = v66;
              }

              else
              {
                v99 = 0;
              }

              if (v99 != 1)
              {
                goto LABEL_64;
              }

              v100 = [(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"password"];
              v118 = 0;
LABEL_165:
              v65 = v100 == 2;
              goto LABEL_79;
            }

            if ([(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"password"]&& !v124)
            {
              autofillGroup7 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup7 setObject:v52 forKey:@"password"];

              v65 = 0;
              v118 = 0;
              goto LABEL_78;
            }

            v65 = 0;
            v103 = v126 != 0;
LABEL_152:
            v118 = v103;
            goto LABEL_79;
          }

          if (v52 && v60 == 2)
          {
            if ([(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"new-password"]|| [(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"password"])
            {
              if ([(UIKBAutofillController *)self doTraits:v124 matchTextContentType:@"username"])
              {
                autofillGroup8 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup8 setObject:v132 forKey:@"username"];

                v64 = v124;
                autofillGroup9 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup9 setObject:v52 forKey:@"password"];

                autofillGroup10 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup10 setObject:v136 forKey:@"new-password"];

                goto LABEL_77;
              }
            }

            else
            {
              if (![(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"new-password"]&& ![(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"password"])
              {
                autofillGroup11 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup11 setObject:v52 forKey:@"username"];

                v64 = v126;
                autofillGroup12 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup12 setObject:v136 forKey:@"new-password"];

                goto LABEL_77;
              }

              if ([(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"username"])
              {
                autofillGroup13 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup13 setObject:v52 forKey:@"username"];

                v64 = v126;
                autofillGroup14 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup14 setObject:v136 forKey:@"password"];

                autofillGroup15 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup15 setObject:v51 forKey:@"new-password"];

                goto LABEL_77;
              }
            }

            goto LABEL_63;
          }

          if (!v125)
          {
            if (([v59 isSecureTextEntry] & 1) == 0 && -[UIKBAutofillController doTraits:matchTextContentType:](self, "doTraits:matchTextContentType:", v128, @"password"))
            {
              autofillGroup16 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup16 setObject:v136 forKey:@"username"];

              v64 = v59;
              autofillGroup17 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup17 setObject:v51 forKey:@"password"];

              v53 = v137;
              v73 = v50;
              if (![(UIKBAutofillController *)self doTraits:v122 matchTextContentType:@"new-password"])
              {
                goto LABEL_64;
              }

              goto LABEL_76;
            }

LABEL_63:
            v64 = 0;
LABEL_64:
            v65 = 0;
            v118 = 0;
LABEL_79:
            if (v127 || v123 || v119)
            {
              if (v127 == 2)
              {
                autofillGroup18 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup18 setObject:v136 forKey:@"email"];
              }

              else if (v123 == 2)
              {
                autofillGroup18 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup18 setObject:v136 forKey:@"tel"];
              }

              else
              {
                autofillGroup18 = [(UIKBAutofillController *)self autofillGroup];
                if (v119 == 2)
                {
                  [autofillGroup18 setObject:v136 forKey:@"street-address"];
                }

                else
                {
                  [autofillGroup18 setObject:v136 forKey:@"UIAutofillContactHeuristicsKey"];
                }
              }

              v53 = v137;
            }

            autofillGroup19 = [(UIKBAutofillController *)self autofillGroup];
            v79 = [(UIKBAutofillController *)self contactAutofillModeWithAutofillGroup:autofillGroup19 responders:v53];

            autofillGroup20 = [(UIKBAutofillController *)self autofillGroup];
            v81 = [autofillGroup20 objectForKey:@"one-time-code"];

            autofillGroup21 = [(UIKBAutofillController *)self autofillGroup];
            v83 = [autofillGroup21 objectForKey:@"username"];

            autofillGroup22 = [(UIKBAutofillController *)self autofillGroup];
            v85 = [autofillGroup22 objectForKey:@"password"];

            if (v64)
            {
              if ((v86 = [v64 keyboardType], v86 <= 0xB) && ((1 << v86) & 0x930) != 0 || v86 == 127)
              {
                if (v83 == v136)
                {
                  autofillGroup23 = [(UIKBAutofillController *)self autofillGroup];
                  [autofillGroup23 removeObjectForKey:@"username"];

                  autofillGroup24 = [(UIKBAutofillController *)self autofillGroup];
                  [autofillGroup24 removeObjectForKey:@"password"];

                  v83 = 0;
                  v85 = 0;
                }

                v65 = 1;
              }
            }

            autofillGroup25 = [(UIKBAutofillController *)self autofillGroup];
            v90 = [autofillGroup25 objectForKey:@"new-password"];

            if (v83)
            {
              v91 = (v85 | v90) != 0;
            }

            else
            {
              v91 = 0;
            }

            if (v83)
            {
              v92 = v134 == 2;
            }

            else
            {
              v92 = 0;
            }

            v93 = v92;
            if (v91 || (v93 & 1) != 0 || v85 && (v125 - 1) <= 1)
            {
              v94 = !v65 && [(UIKBAutofillController *)self signupHintForUsername:v83 password:v85 responder:v137];
              if ((v91 & (v118 | v94 | (v90 != 0))) == 1)
              {
                if (self->_didOptOutOfAutofillSignup)
                {
                  v95 = 0;
                  v55 = 4;
                }

                else
                {
                  v95 = 0;
                  if (v83 == responderCopy || v83 == v136)
                  {
                    v55 = 3;
                  }

                  else
                  {
                    v55 = 2;
                  }
                }
              }

              else
              {
                v95 = 0;
                v55 = 1;
              }
            }

            else if (v131)
            {
              v95 = 0;
              v55 = 8;
            }

            else
            {
              v95 = 0;
              if (v79)
              {
                v55 = v79;
              }

              else
              {
                v55 = 8;
              }

              if (!v79 && !v81)
              {
                [(UIKBAutofillController *)self clearAutofillGroup];
                v95 = 1;
              }
            }

            _Block_object_dispose(&v150, 8);
            if (v95)
            {
              goto LABEL_137;
            }

            goto LABEL_138;
          }

          if (v51 && ![(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"new-password"])
          {
            if (v52 && [(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"password"])
            {
              autofillGroup26 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup26 setObject:v136 forKey:@"new-password"];

              autofillGroup27 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup27 setObject:v52 forKey:@"password"];

              if (!v132)
              {
                v64 = 0;
                goto LABEL_77;
              }

              v53 = v137;
              if ([(UIKBAutofillController *)self doTraits:v124 matchTextContentType:@"username"])
              {
                autofillGroup28 = [(UIKBAutofillController *)self autofillGroup];
                [autofillGroup28 setObject:v132 forKey:@"username"];

                v64 = v124;
                goto LABEL_77;
              }

              v64 = 0;
              v65 = 0;
              v103 = 1;
              goto LABEL_152;
            }
          }

          else
          {
            autofillGroup29 = [(UIKBAutofillController *)self autofillGroup];
            [autofillGroup29 setObject:v136 forKey:@"password"];

            if (v51)
            {
              autofillGroup30 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup30 setObject:v51 forKey:@"new-password"];

              v118 = 1;
              goto LABEL_159;
            }
          }

          v118 = 0;
LABEL_159:
          autofillGroup31 = [(UIKBAutofillController *)self autofillGroup];
          [autofillGroup31 setObject:v136 forKey:@"password"];

          v53 = v137;
          v64 = v52;
          if ([(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"username"])
          {
            autofillGroup32 = [(UIKBAutofillController *)self autofillGroup];
            [autofillGroup32 setObject:v52 forKey:@"username"];

            v64 = v126;
            if (v125 == 2)
            {
              v109 = v66;
            }

            else
            {
              v109 = 0;
            }

            if (v109 == 1)
            {
              v100 = [(UIKBAutofillController *)self doTraits:v64 matchTextContentType:@"username"];
              v53 = v137;
              goto LABEL_165;
            }

LABEL_169:
            v65 = 0;
            goto LABEL_78;
          }

          if ([(UIKBAutofillController *)self doTraits:v128 matchTextContentType:@"username"])
          {
            autofillGroup33 = [(UIKBAutofillController *)self autofillGroup];
            [autofillGroup33 setObject:v51 forKey:@"username"];

            v111 = v128;
LABEL_168:
            v64 = v111;
            goto LABEL_169;
          }

          if (v52)
          {
            if (![(UIKBAutofillController *)self doTraits:v126 matchTextContentType:@"password"])
            {
              autofillGroup34 = [(UIKBAutofillController *)self autofillGroup];
              [autofillGroup34 setObject:v52 forKey:@"username"];

              v111 = v126;
              goto LABEL_168;
            }

            v64 = 0;
          }

          v65 = 0;
          goto LABEL_79;
        }

LABEL_55:
        v122 = 0;
        goto LABEL_56;
      }
    }

    v128 = 0;
    if (v50)
    {
      goto LABEL_52;
    }

    goto LABEL_55;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) != 0 || (objc_opt_respondsToSelector() & 1) == 0 && (objc_opt_respondsToSelector() & 1) == 0)
  {
LABEL_137:
    v55 = 0;
    goto LABEL_138;
  }

  autofillGroup35 = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup35 setObject:responderCopy forKey:@"one-time-code"];

  v55 = 8;
LABEL_138:

  return v55;
}

BOOL __69__UIKBAutofillController__needAutofillCandidate_delegateAsResponder___block_invoke(uint64_t a1, void *a2)
{
  v2 = a2;
  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    v3 = v2;
    v5 = 0;
    if (([v3 isHidden] & 1) == 0)
    {
      [v3 alpha];
      if (v4 != 0.0)
      {
        v5 = 1;
      }
    }
  }

  else
  {
    v5 = 1;
  }

  return v5;
}

BOOL __69__UIKBAutofillController__needAutofillCandidate_delegateAsResponder___block_invoke_2(uint64_t a1, void *a2)
{
  v2 = a2;
  if ([v2 _requiresKeyboardWhenFirstResponder] && ((objc_msgSend(v2, "conformsToProtocol:", &unk_1EFE8B2D0) & 1) != 0 || (objc_opt_respondsToSelector() & 1) != 0))
  {
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) == 0 || ([v2 frame], !CGRectIsEmpty(v7)))
    {
      v3 = 1;
      goto LABEL_13;
    }

LABEL_10:
    v3 = 0;
    goto LABEL_13;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    goto LABEL_10;
  }

  v4 = v2;
  v5 = [v4 allTargets];
  if ([v5 count])
  {
    [v4 frame];
    v3 = !CGRectIsEmpty(v8);
  }

  else
  {
    v3 = 0;
  }

LABEL_13:
  return v3;
}

BOOL __69__UIKBAutofillController__needAutofillCandidate_delegateAsResponder___block_invoke_3(uint64_t a1, void *a2)
{
  v2 = a2;
  if ([v2 _requiresKeyboardWhenFirstResponder])
  {
    v3 = 0;
  }

  else
  {
    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v4 = [v2 allTargets];
      v3 = [v4 count] == 0;
    }

    else
    {
      v3 = 1;
    }
  }

  return v3;
}

void __69__UIKBAutofillController__needAutofillCandidate_delegateAsResponder___block_invoke_4(uint64_t a1, void *a2)
{
  v5 = a2;
  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    v3 = v5;
    if (*(a1 + 32) == v5)
    {
      v4 = [*(a1 + 40) count];
      v3 = v5;
      *(*(*(a1 + 48) + 8) + 24) = v4;
    }

    [*(a1 + 40) addObject:v3];
  }
}

- (void)clearAutofillGroup
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {

    [(AFUITargetDetectionController_Staging *)targetDetectionController clearAutoFillGroup];
  }

  else
  {
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    [autofillGroup removeAllObjects];

    self->_didOptOutOfAutofillSignup = 0;
  }
}

- (BOOL)containsUsernamePasswordPairsInAutofillGroup:(id)group
{
  groupCopy = group;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    v6 = [(AFUITargetDetectionController_Staging *)targetDetectionController containsUsernamePasswordPairsInAutoFillGroup:groupCopy];
  }

  else if (groupCopy)
  {
    v7 = [groupCopy objectForKey:@"username"];
    if (v7)
    {
      v8 = [groupCopy objectForKey:@"password"];
      if (v8)
      {
        v6 = 1;
      }

      else
      {
        v9 = [groupCopy objectForKey:@"new-password"];
        v6 = v9 != 0;
      }
    }

    else
    {
      v6 = 0;
    }
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (BOOL)preferFallbackAutofillGroup
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {

    LOBYTE(fallbackAutofillGroup) = [(AFUITargetDetectionController_Staging *)targetDetectionController shouldPreferFallbackAutoFillGroup];
  }

  else
  {
    fallbackAutofillGroup = [(UIKBAutofillController *)self fallbackAutofillGroup];
    if (fallbackAutofillGroup)
    {
      v5 = fallbackAutofillGroup;
      fallbackAutofillGroup2 = [(UIKBAutofillController *)self fallbackAutofillGroup];
      v7 = [fallbackAutofillGroup2 count];

      if (v7)
      {
        autofillGroup = [(UIKBAutofillController *)self autofillGroup];
        v9 = ![(UIKBAutofillController *)self containsUsernamePasswordPairsInAutofillGroup:autofillGroup];

        fallbackAutofillGroup3 = [(UIKBAutofillController *)self fallbackAutofillGroup];
        v11 = [(UIKBAutofillController *)self containsUsernamePasswordPairsInAutofillGroup:fallbackAutofillGroup3];

        LOBYTE(fallbackAutofillGroup) = v9 & v11;
      }

      else
      {
        LOBYTE(fallbackAutofillGroup) = 0;
      }
    }
  }

  return fallbackAutofillGroup;
}

- (void)handleAutofillCredentialSaveIfNeeded:(id)needed fromASP:(BOOL)p
{
  pCopy = p;
  neededCopy = needed;
  targetDetectionController = self->_targetDetectionController;
  if (!targetDetectionController)
  {
    if ([(UIKBAutofillController *)self preferFallbackAutofillGroup])
    {
      [(UIKBAutofillController *)self fallbackAutofillGroup];
    }

    else
    {
      [(UIKBAutofillController *)self autofillGroup];
    }
    v8 = ;
    v9 = v8;
    if (!v8)
    {
LABEL_26:
      [(UIKBAutofillController *)self clearFallbackAutofillGroup];

      goto LABEL_27;
    }

    v10 = [v8 objectForKey:@"username"];
    objc_opt_class();
    if (objc_opt_isKindOfClass() & 1) != 0 || (objc_opt_class(), (objc_opt_isKindOfClass()))
    {
      text = [v10 text];
    }

    else
    {
      text = 0;
    }

    v12 = [v9 objectForKey:@"new-password"];
    if (!v12)
    {
      v12 = [v9 objectForKey:@"password"];
    }

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      text2 = [v12 text];
      if (!text)
      {
        goto LABEL_23;
      }
    }

    else
    {
      text2 = 0;
      if (!text)
      {
        goto LABEL_23;
      }
    }

    whitespaceCharacterSet = [MEMORY[0x1E696AB08] whitespaceCharacterSet];
    v23 = text;
    v14 = [text stringByTrimmingCharactersInSet:whitespaceCharacterSet];
    if (![v14 length] || !text2)
    {
LABEL_22:

      text = v23;
      goto LABEL_23;
    }

    [MEMORY[0x1E696AB08] whitespaceCharacterSet];
    v15 = v22 = v10;
    v16 = [text2 stringByTrimmingCharactersInSet:v15];
    v17 = [v16 length];

    v10 = v22;
    text = v23;
    if (v17)
    {
      v18 = [v9 objectForKeyedSubscript:@"UIAutofillContextKey"];
      whitespaceCharacterSet = [v18 objectForKeyedSubscript:@"_WebViewURL"];

      v14 = objc_alloc_init(get_SFAppPasswordSavingViewControllerClass());
      if (objc_opt_respondsToSelector())
      {
        v25[0] = MEMORY[0x1E69E9820];
        v25[1] = 3221225472;
        v25[2] = __71__UIKBAutofillController_handleAutofillCredentialSaveIfNeeded_fromASP___block_invoke_2;
        v25[3] = &unk_1E70F5AC0;
        v26 = v14;
        [v26 credentialsSubmittedForWebsiteURL:whitespaceCharacterSet user:v23 password:text2 passwordIsAutoGenerated:pCopy completionHandler:v25];
      }

      goto LABEL_22;
    }

LABEL_23:
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v20 = [autofillGroup allKeysForObject:neededCopy];
    v21 = [v20 count];

    if (v21)
    {
      [(UIKBAutofillController *)self clearAutofillGroup];
    }

    goto LABEL_26;
  }

  [(AFUITargetDetectionController_Staging *)targetDetectionController saveAutoFillCredentialIfNeeded:neededCopy passwordIsAutoGenerated:pCopy block:&__block_literal_global_730];
LABEL_27:
}

void __71__UIKBAutofillController_handleAutofillCredentialSaveIfNeeded_fromASP___block_invoke_2(uint64_t a1, int a2)
{
  if (a2)
  {
    UIKeyboardSafariPresentCredentialPickerVC(*(a1 + 32));
  }
}

- (void)handleWebviewCredentialsSaveForResponder:(id)responder WebsiteURL:(id)l user:(id)user password:(id)password passwordIsAutoGenerated:(BOOL)generated
{
  generatedCopy = generated;
  lCopy = l;
  userCopy = user;
  passwordCopy = password;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController saveWebviewCredentialsForResponder:responder WebsiteURL:lCopy user:userCopy password:passwordCopy passwordIsAutoGenerated:generatedCopy block:&__block_literal_global_739];
  }

  else
  {
    v16 = objc_alloc_init(get_SFAppPasswordSavingViewControllerClass());
    if (objc_opt_respondsToSelector())
    {
      v17[0] = MEMORY[0x1E69E9820];
      v17[1] = 3221225472;
      v17[2] = __116__UIKBAutofillController_handleWebviewCredentialsSaveForResponder_WebsiteURL_user_password_passwordIsAutoGenerated___block_invoke_2;
      v17[3] = &unk_1E70F5AC0;
      v18 = v16;
      [v18 credentialsSubmittedForWebsiteURL:lCopy user:userCopy password:passwordCopy passwordIsAutoGenerated:generatedCopy completionHandler:v17];
    }
  }
}

void __116__UIKBAutofillController_handleWebviewCredentialsSaveForResponder_WebsiteURL_user_password_passwordIsAutoGenerated___block_invoke_2(uint64_t a1, int a2)
{
  if (a2)
  {
    UIKeyboardSafariPresentCredentialPickerVC(*(a1 + 32));
  }
}

- (void)trackResponderForAutofillIfNeeded:(id)needed
{
  neededCopy = needed;
  delegateNeedsAutofillMode = [(UIKBAutofillController *)self delegateNeedsAutofillMode];
  v5 = neededCopy;
  if (!delegateNeedsAutofillMode)
  {
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v7 = [autofillGroup objectForKey:@"password"];

    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0 && v7)
    {
      v8 = v7;
      objc_opt_class();
      if (objc_opt_isKindOfClass())
      {
        v9 = neededCopy;
      }

      else
      {
        v9 = 0;
      }

      v10 = v9;
      [v10 frame];
      [v10 convertRect:0 toView:?];
      v12 = v11;
      v14 = v13;
      v16 = v15;
      v18 = v17;

      [v8 frame];
      [v8 convertRect:0 toView:?];
      v20 = v19;
      v22 = v21;
      v24 = v23;
      v26 = v25;

      v27 = v14 + v18 * 0.5 > v22 + v26 * 0.5 || v12 + v16 * 0.5 > v20 + v24 * 0.5;
      [(UIKBAutofillController *)self setShouldSaveAutofill:v27];
    }

    v5 = neededCopy;
  }
}

- (BOOL)shouldLoadASPForResponder:(id)responder
{
  responderCopy = responder;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    v6 = [(AFUITargetDetectionController_Staging *)targetDetectionController shouldLoadASPForResponder:responderCopy];
  }

  else
  {
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v8 = [autofillGroup objectForKey:@"username"];

    autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
    v10 = [autofillGroup2 objectForKey:@"password"];
    if (v10 == responderCopy)
    {
      v13 = 1;
    }

    else
    {
      autofillGroup3 = [(UIKBAutofillController *)self autofillGroup];
      v12 = [autofillGroup3 objectForKey:@"new-password"];
      v13 = v12 == responderCopy;
    }

    v6 = v8 != 0 && v13;
  }

  return v6;
}

- (void)didOptOutOfAutofillSignup
{
  if (self->_targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)self->_targetDetectionController didOptOutOfAutoFillSignup];
  }

  else
  {
    self->_didOptOutOfAutofillSignup = 1;
  }
}

- (void)showASPInTextField:(id)field isRightToLeft:(BOOL)left
{
  leftCopy = left;
  v41[1] = *MEMORY[0x1E69E9840];
  fieldCopy = field;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController showASPInTextField:fieldCopy isRightToLeft:leftCopy];
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    [autofillGroup setObject:MEMORY[0x1E695E118] forKey:@"UIAutofillASPOptInKey"];
  }

  else
  {
    [fieldCopy frame];
    v10 = v9;
    v12 = v11;
    v14 = v13;
    v16 = v15;
    rightView = [fieldCopy rightView];
    [rightView frame];
    v19 = v18;
    leftView = [fieldCopy leftView];
    [leftView frame];
    v22 = v10 + v21;
    v23 = v14 - (v19 + v21);
    v24 = v12 + 0.0;

    v25 = leftCopy || [fieldCopy textAlignment] == 2;
    v40 = *off_1E70EC918;
    font = [fieldCopy font];
    v41[0] = font;
    v27 = [MEMORY[0x1E695DF20] dictionaryWithObjects:v41 forKeys:&v40 count:1];

    text = [fieldCopy text];
    [text sizeWithAttributes:v27];
    v30 = v29;

    v31 = [UIKBASPCoverView ASPCoverView:1 withFrame:v25 isRightToLeft:v22 withTextWidth:v24, v23, v16, v30];
    [fieldCopy frame];
    v32 = [UIKBASPCoverView ASPCoverView:"ASPCoverView:withFrame:isRightToLeft:withTextWidth:" withFrame:0 isRightToLeft:v25 withTextWidth:?];
    autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
    v34 = [autofillGroup2 objectForKey:@"UIAutofillASPOptInKey"];
    bOOLValue = [v34 BOOLValue];

    if ((bOOLValue & 1) == 0)
    {
      backgroundColor = [fieldCopy backgroundColor];
      [(UIKBAutofillController *)self setTextFieldOrigColor:backgroundColor];

      autofillGroup3 = [(UIKBAutofillController *)self autofillGroup];
      v38 = [MEMORY[0x1E696AD98] numberWithBool:1];
      [autofillGroup3 setObject:v38 forKey:@"UIAutofillASPOptInKey"];
    }

    if (dyld_program_sdk_at_least())
    {
      v39 = 3;
    }

    else
    {
      v39 = 1;
    }

    [fieldCopy _setContentCoverViewMode:v39];
    [fieldCopy _setContentCoverView:v31];
    [fieldCopy _setBackgroundCoverViewMode:v39];
    [fieldCopy _setBackgroundCoverView:v32];
  }
}

- (void)clearASPVisualEffectsInTextField:(id)field
{
  targetDetectionController = self->_targetDetectionController;
  fieldCopy = field;
  v6 = fieldCopy;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController clearASPVisualEffectsInTextField:fieldCopy];
  }

  else
  {
    [fieldCopy _setContentCoverViewMode:0];
    [v6 _setContentCoverView:0];
    _backgroundCoverView = [v6 _backgroundCoverView];
    [_backgroundCoverView removeFromSuperview];

    [v6 _setBackgroundCoverView:0];
  }
}

- (void)_clearASPInTextField:(id)field
{
  fieldCopy = field;
  autofillGroup = [(UIKBAutofillController *)self autofillGroup];
  [autofillGroup removeObjectForKey:@"UIAutofillASPOptInKey"];

  [(UIKBAutofillController *)self removeTemporaryTextColorFromTextField:fieldCopy];
  [(UIKBAutofillController *)self clearASPVisualEffectsInTextField:fieldCopy];
  [fieldCopy setText:&stru_1EFB14550];
}

- (void)clearASPInPasswordFields
{
  autofillGroup = [(UIKBAutofillController *)self autofillGroup];
  v6 = [autofillGroup objectForKey:@"password"];

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    [(UIKBAutofillController *)self _clearASPInTextField:v6];
  }

  autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
  v5 = [autofillGroup2 objectForKey:@"new-password"];

  objc_opt_class();
  if (objc_opt_isKindOfClass())
  {
    [(UIKBAutofillController *)self _clearASPInTextField:v5];
  }
}

- (void)optOutASPInTextField
{
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {

    [(AFUITargetDetectionController_Staging *)targetDetectionController optOutASPInPasswordFields];
  }

  else
  {
    [(UIKBAutofillController *)self clearASPInPasswordFields];
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v4 = [MEMORY[0x1E696AD98] numberWithBool:0];
    [autofillGroup setObject:v4 forKey:@"UIAutofillASPOptInKey"];
  }
}

- (void)enumeratePasswordFieldsUsingBlock:(id)block
{
  blockCopy = block;
  targetDetectionController = self->_targetDetectionController;
  if (targetDetectionController)
  {
    v10 = blockCopy;
    [(AFUITargetDetectionController_Staging *)targetDetectionController enumeratePasswordFieldsUsingBlock:blockCopy];
  }

  else
  {
    if (!blockCopy)
    {
      goto LABEL_10;
    }

    v10 = blockCopy;
    autofillGroup = [(UIKBAutofillController *)self autofillGroup];
    v7 = [autofillGroup objectForKey:@"password"];

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v10[2](v10, v7);
    }

    autofillGroup2 = [(UIKBAutofillController *)self autofillGroup];
    v9 = [autofillGroup2 objectForKey:@"new-password"];

    objc_opt_class();
    if (objc_opt_isKindOfClass())
    {
      v10[2](v10, v9);
    }
  }

  blockCopy = v10;
LABEL_10:
}

- (void)addTemporaryTextColorToTextField:(id)field
{
  v12[2] = *MEMORY[0x1E69E9840];
  targetDetectionController = self->_targetDetectionController;
  fieldCopy = field;
  v5 = fieldCopy;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController addTemporaryTextColorToTextField:fieldCopy];
  }

  else
  {
    textLayoutController = [fieldCopy textLayoutController];
    documentRange = [textLayoutController documentRange];
    v11[0] = *off_1E70EC920;
    v8 = +[UIColor blackColor];
    v12[0] = v8;
    v11[1] = *off_1E70EC8D0;
    v9 = +[UIColor clearColor];
    v12[1] = v9;
    v10 = [MEMORY[0x1E695DF20] dictionaryWithObjects:v12 forKeys:v11 count:2];
    [textLayoutController addRenderingAttributes:v10 forRange:documentRange];

    [v5 setNeedsDisplay];
    v5 = textLayoutController;
  }
}

- (void)removeTemporaryTextColorFromTextField:(id)field
{
  v10[2] = *MEMORY[0x1E69E9840];
  targetDetectionController = self->_targetDetectionController;
  fieldCopy = field;
  v5 = fieldCopy;
  if (targetDetectionController)
  {
    [(AFUITargetDetectionController_Staging *)targetDetectionController removeTemporaryTextColorFromTextField:fieldCopy];
  }

  else
  {
    textLayoutController = [fieldCopy textLayoutController];
    documentRange = [textLayoutController documentRange];
    v8 = *off_1E70EC8D0;
    v10[0] = *off_1E70EC920;
    v10[1] = v8;
    v9 = [MEMORY[0x1E695DEC8] arrayWithObjects:v10 count:2];
    [textLayoutController removeRenderingAttributes:v9 forRange:documentRange];

    [v5 setNeedsDisplay];
    v5 = textLayoutController;
  }
}

@end