@interface CHXTitle
+ (id)chdTitleFromXmlTitleElement:(_xmlNode *)element isChartTitle:(BOOL)title state:(id)state;
@end

@implementation CHXTitle

+ (id)chdTitleFromXmlTitleElement:(_xmlNode *)element isChartTitle:(BOOL)title state:(id)state
{
  titleCopy = title;
  stateCopy = state;
  v8 = [CHDTitle alloc];
  chart = [stateCopy chart];
  v10 = [(CHDTitle *)v8 initWithChart:chart];

  drawingState = [stateCopy drawingState];
  oAXChartNamespace = [drawingState OAXChartNamespace];
  v13 = OCXFindChild(element, oAXChartNamespace, "tx");

  if (v13)
  {
    [stateCopy pushTitleTextProperties:titleCopy];
    v45 = 0;
    v46 = 0;
    [CHXString readFromXmlTxElement:v13 formula:&v46 lastCached:&v45 state:stateCopy];
    v14 = v46;
    v15 = v45;
    [stateCopy popTitleTextProperties];
    [(CHDTitle *)v10 setName:v14];
    [(CHDTitle *)v10 setLastCachedName:v15];
  }

  else
  {
    [(CHDTitle *)v10 setIsAutoGenerated:1];
  }

  drawingState2 = [stateCopy drawingState];
  oAXChartNamespace2 = [drawingState2 OAXChartNamespace];
  v18 = OCXFindChild(element, oAXChartNamespace2, "txPr");

  if (v18)
  {
    if (!v13)
    {
      v19 = [CHXFont edRunCollectionFromXmlTextPropertiesElement:v18 state:stateCopy];
      if (v19)
      {
        v20 = +[EDString string];
        [v20 setRuns:v19];
        [(CHDTitle *)v10 setLastCachedName:v20];
      }
    }

    drawingState3 = [stateCopy drawingState];
    oAXMainNamespace = [drawingState3 OAXMainNamespace];
    v23 = OCXFindChild(v18, oAXMainNamespace, "bodyPr");

    if (v23)
    {
      [OAXBaseTypes readOptionalAngleFromXmlNode:v23 name:"rot"];
      [(CHDTitle *)v10 setTitleRotationAngle:?];
    }
  }

  v24 = objc_alloc_init(OADGraphicProperties);
  [CHXGraphicProperties setGraphicPropertiesFromXmlElementWithGraphicProperties:v24 element:element state:stateCopy];
  drawingState4 = [stateCopy drawingState];
  oAXChartNamespace3 = [drawingState4 OAXChartNamespace];
  v27 = OCXFindChild(element, oAXChartNamespace3, "layout");

  if (!v27)
  {
    if (element->children)
    {
      goto LABEL_20;
    }

    goto LABEL_18;
  }

  drawingState5 = [stateCopy drawingState];
  oAXChartNamespace4 = [drawingState5 OAXChartNamespace];
  v30 = OCXFindChild(v27, oAXChartNamespace4, "manualLayout");

  if (!v30)
  {
LABEL_18:
    [(CHDTitle *)v10 setIsPositionAutoGenerated:1];
LABEL_19:
    [(CHDTitle *)v10 setIsSizeAutoGenerated:1];
    goto LABEL_20;
  }

  orientedBounds = [(OADDrawableProperties *)v24 orientedBounds];
  [orientedBounds bounds];
  v33 = v32;
  v35 = v34;

  if (v33 == 0.0 && v35 == 0.0)
  {
    drawingState6 = [stateCopy drawingState];
    oAXChartNamespace5 = [drawingState6 OAXChartNamespace];
    if (OCXFindChild(v30, oAXChartNamespace5, "w"))
    {

      goto LABEL_20;
    }

    drawingState7 = [stateCopy drawingState];
    oAXChartNamespace6 = [drawingState7 OAXChartNamespace];
    v44 = OCXFindChild(v30, oAXChartNamespace6, "h");

    if (!v44)
    {
      goto LABEL_19;
    }
  }

LABEL_20:
  [(CHDTitle *)v10 setGraphicProperties:v24];
  drawingState8 = [stateCopy drawingState];
  oAXChartNamespace7 = [drawingState8 OAXChartNamespace];
  v40 = OCXFindChild(element, oAXChartNamespace7, "overlay");

  if (v40)
  {
    [(CHDTitle *)v10 setIsOverlay:CXRequiredBoolAttribute(v40, CXNoNamespace, "val")];
  }

  return v10;
}

@end