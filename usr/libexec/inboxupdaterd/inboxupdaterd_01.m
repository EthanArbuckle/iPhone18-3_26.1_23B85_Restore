void sub_10002AE0C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002AE74(void *a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = *(a1[4] + 8);
  v11 = *(v10 + 40);
  *(v10 + 40) = v7;
  v17 = v7;

  v12 = *(a1[5] + 8);
  v13 = *(v12 + 40);
  *(v12 + 40) = v8;
  v14 = v8;

  v15 = *(a1[6] + 8);
  v16 = *(v15 + 40);
  *(v15 + 40) = v9;
}

void sub_10002AF30(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002AF98(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002B000(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002B4E8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002B5EC(id a1)
{
  qword_1000B83F8 = objc_alloc_init(MIBUDeviceController);

  _objc_release_x1();
}

void sub_10002B7F4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002BA90(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002BAF8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002BCAC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002BEE4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002BF4C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C0A8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C1D8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C380(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C3E8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C450(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C4B8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C5F0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C658(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C6C0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C820(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C888(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002C8F0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002CA30(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002CB64(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002CD6C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002D150(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002D1B8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002D220(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

uint64_t sub_10002DEF4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

void sub_10002DF0C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002DF74(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002DFDC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E044(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E0AC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E114(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E17C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E1E4(uint64_t a1, void *a2)
{
  v3 = a2;
  if (qword_1000B84A8[0] != -1)
  {
    sub_10005DDF8();
  }

  v4 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v8 = 138543362;
    v9 = v3;
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "Set LPM returned error: %{public}@", &v8, 0xCu);
  }

  v5 = *(*(a1 + 40) + 8);
  v6 = *(v5 + 40);
  *(v5 + 40) = v3;
  v7 = v3;

  dispatch_semaphore_signal(*(a1 + 32));
}

void sub_10002E2DC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E344(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E5D4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E63C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E6A4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E70C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002E8D4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EA6C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EAD4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EB3C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EBA4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EC0C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EC74(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002ECDC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002ED44(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002EE24(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F058(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F4BC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F524(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F58C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F5F4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F74C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F7B4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F934(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002F99C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002FCD0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10002FD60(float a1)
{
  *(v2 - 144) = a1;
  *(v2 - 140) = v1;
  *(v2 - 132) = 2114;
}

void sub_10002FD74(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, v9, OS_LOG_TYPE_ERROR, a4, &a9, 0x12u);
}

BOOL sub_10002FDB4()
{
  v2 = *v0;

  return os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT);
}

__n128 sub_10002FDD0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, __n128 a15)
{
  result = a15;
  *(v16 - 144) = a15.n128_u32[0];
  *(v16 - 140) = v15;
  return result;
}

void sub_10002FFA8(id a1)
{
  qword_1000B8420 = objc_alloc_init(MIBUShipUpdateMainController);

  _objc_release_x1();
}

void sub_10003006C(uint64_t a1)
{
  obj = *(a1 + 32);
  objc_sync_enter(obj);
  [*(a1 + 32) _start:*(a1 + 40)];
  objc_sync_exit(obj);
}

void sub_1000301B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003036C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003062C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100030694(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000306FC(uint64_t a1)
{
  if (qword_1000B84A8[0] != -1)
  {
    sub_10005E48C();
  }

  v2 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = v2;
    v17[0] = 67109120;
    v17[1] = [v3 intValue];
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "Timed out in state %d, putting device to low power mode.", v17, 8u);
  }

  v5 = [*(a1 + 40) deviceDelegate];
  v6 = [v5 shutdownInLPM];

  if ((v6 & 1) == 0)
  {
    if (qword_1000B84A8[0] != -1)
    {
      sub_10005E4A0();
    }

    v7 = qword_1000B84A0;
    if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_ERROR))
    {
      sub_10005E4C8(v7, v8, v9, v10, v11, v12, v13, v14);
    }

    v15 = [*(a1 + 40) deviceDelegate];
    [v15 setShelfLifeMode];

    v16 = [*(a1 + 40) deviceDelegate];
    [v16 shutdown];
  }
}

void sub_100030868(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000308D0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100030E3C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003165C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000316C4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003172C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100031FA8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032010(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032078(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000320E0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032148(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000321B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032218(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032280(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000322E8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032350(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032500(uint64_t a1)
{
  [*(a1 + 32) _stopIdleTimer];
  v2 = *(a1 + 40);
  if (v2 == 1)
  {
    v3 = [*(a1 + 32) deviceDelegate];
    v4 = [v3 wakedUpFromLPM];

    if (v4)
    {
      if (os_variant_has_internal_content() && (+[MIBUTestPreferences sharedInstance](MIBUTestPreferences, "sharedInstance"), v5 = objc_claimAutoreleasedReturnValue(), v6 = [v5 standbyIdleTimeout], v5, v6))
      {
        v7 = v6;
      }

      else
      {
        v7 = 300.0;
      }

      goto LABEL_10;
    }

    v2 = *(a1 + 40);
  }

  if (v2 != 3)
  {
    return;
  }

  v7 = 180.0;
LABEL_10:
  if (qword_1000B84A8[0] != -1)
  {
    sub_10005E9C8();
  }

  v8 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v18 = 134217984;
    v19 = v7;
    _os_log_impl(&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, "Starting Idle timer with %lfs timeout...", &v18, 0xCu);
  }

  v9 = +[NSDate date];
  v10 = [NSDate dateWithTimeInterval:v9 sinceDate:v7];

  v11 = [PCPersistentTimer alloc];
  v12 = *(a1 + 32);
  v13 = [NSNumber numberWithUnsignedInteger:*(a1 + 40)];
  v14 = [v11 initWithFireDate:v10 serviceIdentifier:@"com.apple.mobileinboxupdater.inactivitytimer" target:v12 selector:"handleIdleTimer:" userInfo:v13];
  [*(a1 + 32) setIdleTimer:v14];

  v15 = [*(a1 + 32) idleTimer];
  [v15 setMinimumEarlyFireProportion:1.0];

  v16 = [*(a1 + 32) idleTimer];
  v17 = +[NSRunLoop mainRunLoop];
  [v16 scheduleInRunLoop:v17];
}

void sub_10003275C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032884(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000329A8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032AA4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032C80(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032CE8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032D50(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032EC0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100032F28(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000330E4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003314C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000334C0(id a1)
{
  qword_1000B8438 = objc_alloc_init(MIBUWiFiHelper);

  _objc_release_x1();
}

void sub_100033794(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, char a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, char a21)
{
  objc_sync_exit(v21);
  _Block_object_dispose(&a15, 8);
  _Block_object_dispose(&a21, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_1000337D4(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

void sub_1000337EC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100033854(uint64_t a1)
{
  v1 = *(a1 + 40);
  v2 = *(*(*(a1 + 32) + 8) + 40);
  v3 = *(v1 + 8);
  obj = *(v3 + 40);
  [v2 _retryWiFiConnection:&obj];
  objc_storeStrong((v3 + 40), obj);
}

void sub_10003394C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100033AA0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100033C80(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100033DE0(uint64_t a1, nw_path_t path)
{
  status = nw_path_get_status(path);
  if ([*(a1 + 32) collectMetrics])
  {
    v4 = status == nw_path_status_satisfied;
  }

  else
  {
    v4 = 1;
  }

  if (!v4)
  {
    v5 = +[MIBUDataCollector sharedInstance];
    [v5 addKeyEvent:@"SSUWiFiInfraConnEnd"];
  }

  v6 = [*(a1 + 32) connectionSem];

  if (qword_1000B84A8[0] != -1)
  {
    sub_10005ED70();
  }

  v7 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v10[0] = 67109376;
    v10[1] = status == nw_path_status_satisfied;
    v11 = 1024;
    v12 = v6 != 0;
    _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, "Got Network update event: Network Available = %{BOOL}d; isConnecting = %{BOOL}d", v10, 0xEu);
  }

  if (v6)
  {
    if (status == nw_path_status_satisfied)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_10005ED84();
      }

      v8 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        LOWORD(v10[0]) = 0;
        _os_log_impl(&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, "Connected to internet!", v10, 2u);
      }

      v9 = [*(a1 + 32) connectionSem];
      dispatch_semaphore_signal(v9);
    }
  }

  else if (status != nw_path_status_satisfied)
  {
    [*(a1 + 32) _dispatchRetryOperation];
  }
}

void sub_100033FAC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034014(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000341C8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  objc_sync_exit(v7);
  _Unwind_Resume(a1);
}

void sub_1000341E8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034250(uint64_t a1)
{
  v2 = [*(*(*(a1 + 32) + 8) + 40) networkMonitor];

  if (v2)
  {
    v4 = 0;
    *&v3 = 134217984;
    v14 = v3;
    while (1)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_10005EE40();
      }

      v5 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&_mh_execute_header, v5, OS_LOG_TYPE_DEFAULT, "Starting wifi connection retry...", buf, 2u);
      }

      v6 = *(*(*(a1 + 32) + 8) + 40);
      v15 = v4;
      [v6 _retryWiFiConnection:{&v15, v14}];
      v7 = v15;

      if (!v7)
      {
        break;
      }

      if (qword_1000B84A8[0] != -1)
      {
        sub_10005EE68();
      }

      v8 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        v9 = *(*(*(a1 + 32) + 8) + 40);
        v10 = v8;
        [v9 globalRetryInterval];
        *buf = v14;
        v17 = v11;
        _os_log_impl(&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, "Waiting for %lfs to try wifi connection again...", buf, 0xCu);
      }

      [*(*(*(a1 + 32) + 8) + 40) globalRetryInterval];
      sleep(v12);
      v13 = [*(*(*(a1 + 32) + 8) + 40) networkMonitor];

      v4 = v7;
      if (!v13)
      {
        goto LABEL_15;
      }
    }
  }

  else
  {
    v7 = 0;
LABEL_15:
    sub_10005EE90(v7);
  }
}

void sub_10003444C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000344B4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003451C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034968(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000349D0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034A38(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034AA0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034BF8(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, ...)
{
  va_start(va, a7);
  _Block_object_dispose(va, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_100034C18(uint64_t a1, void *a2)
{
  v3 = a2;
  if (nw_path_get_status(*(a1 + 32)) == nw_path_status_satisfied)
  {
    type = nw_interface_get_type(v3);
    subtype = nw_interface_get_subtype();
    if (type == nw_interface_type_wifi && subtype == 1001)
    {
      *(*(*(a1 + 40) + 8) + 24) = 1;
    }
  }

  return 1;
}

void sub_100034DAC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034E14(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100034E7C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000352B4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003531C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100035384(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000353EC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100035454(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

id sub_100035784(uint64_t a1, void *a2)
{
  result = [a2 type];
  if (result == 10)
  {
    if (qword_1000B84A8[0] != -1)
    {
      sub_10005F54C();
    }

    v4 = qword_1000B84A0;
    if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
    {
      *v5 = 0;
      _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "Wifi interface is now initialized. Should be safe to proceed..", v5, 2u);
    }

    [*(a1 + 32) lock];
    [*(a1 + 32) signal];
    return [*(a1 + 32) unlock];
  }

  return result;
}

void sub_100035834(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003589C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100035904(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003596C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000359D4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100035BA8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100035C10(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036288(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000362F0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036358(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000363C0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036428(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036490(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036A54(_Unwind_Exception *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, char a23, uint64_t a24, uint64_t a25, uint64_t a26, uint64_t a27, uint64_t a28, char a29)
{
  _Block_object_dispose(&a23, 8);
  _Block_object_dispose(&a29, 8);
  _Block_object_dispose((v29 - 192), 8);
  _Unwind_Resume(a1);
}

void sub_100036AA0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036B08(void *a1, void *a2, void *a3, void *a4)
{
  v7 = a2;
  v8 = a3;
  objc_storeStrong((*(a1[4] + 8) + 40), a4);
  v14 = a4;
  v9 = *(a1[5] + 8);
  v10 = *(v9 + 40);
  *(v9 + 40) = v7;
  v11 = v7;

  v12 = *(a1[6] + 8);
  v13 = *(v12 + 40);
  *(v12 + 40) = v8;
}

void sub_100036BBC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036C24(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100036DF0(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_impl(a1, v9, OS_LOG_TYPE_DEFAULT, a4, &a9, 2u);
}

void sub_100037058(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000370C0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000372C8(id a1)
{
  qword_1000B8440 = objc_alloc_init(MIBUXPCListener);

  _objc_release_x1();
}

void sub_100037408(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037664(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000376CC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037734(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037A84(_Unwind_Exception *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, id location, char a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21, uint64_t a22, char a23)
{
  objc_destroyWeak(&location);
  _Block_object_dispose(&a17, 8);
  _Block_object_dispose(&a23, 8);
  _Unwind_Resume(a1);
}

uint64_t sub_100037ACC(uint64_t result, uint64_t a2)
{
  *(result + 40) = *(a2 + 40);
  *(a2 + 40) = 0;
  return result;
}

void sub_100037AE4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037B4C(uint64_t a1, void *a2, uint64_t a3, _BYTE *a4)
{
  v7 = a2;
  v8 = objc_autoreleasePoolPush();
  WeakRetained = objc_loadWeakRetained((a1 + 48));
  v10 = [*(*(*(a1 + 32) + 8) + 40) objectAtIndex:a3];
  if (v10)
  {
    if (WeakRetained)
    {
      v11 = [WeakRetained _serializeValue:v10 forTag:v7];
      if (v11)
      {
        v12 = v11;
        [*(*(*(a1 + 40) + 8) + 40) appendData:v11];
LABEL_5:

        goto LABEL_6;
      }

      sub_100060294(v7, v10);
    }

    else
    {
      sub_100060394();
    }

    *a4 = 1;
    v13 = *(*(a1 + 40) + 8);
    v12 = *(v13 + 40);
    *(v13 + 40) = 0;
    goto LABEL_5;
  }

LABEL_6:

  objc_autoreleasePoolPop(v8);
}

void sub_100037C44(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037CAC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037D7C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037DE4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037E4C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037EB4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037F1C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037F84(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100037FEC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003820C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038748(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000387B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038818(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

id sub_1000388A0(id a1)
{

  return a1;
}

void sub_1000388CC(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, &a9, 0xCu);
}

uint64_t sub_1000388E8()
{

  return objc_opt_class();
}

uint64_t sub_100038900()
{

  return objc_opt_class();
}

uint64_t sub_100038918()
{

  return objc_opt_isKindOfClass();
}

id sub_100038930()
{

  return [v0 charValue];
}

void sub_100038ABC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038BF4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038C5C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038CF4(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{

  _os_log_error_impl(a1, v9, OS_LOG_TYPE_ERROR, a4, &a9, 2u);
}

void sub_100038D6C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038DD4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038E3C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038EA4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100038F0C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000395E0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039648(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039B00(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039B68(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039BD0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039C38(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039CA0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039D08(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039D70(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039DD8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039E40(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039EA8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039F10(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039F78(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100039FE0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A10C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A298(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A300(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A50C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A574(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A5DC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A768(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A7D0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003A8FC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003AB04(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003AB6C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003ABD4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003AC3C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003ADC8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003AE30(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003AF5C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BB48(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BBB0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BC18(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BC80(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BCE8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BD50(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BDB8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BE20(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BE88(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BEF0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BF58(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003BFC0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C028(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C090(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C0F8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C160(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C1C8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C230(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C298(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C300(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C368(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C3D0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C438(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C4A0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C508(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C570(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C5D8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C640(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C738(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C8A0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C908(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003C970(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CB64(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CBCC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CC34(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CC9C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CD04(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CE54(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CEBC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003CF24(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D01C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D1AC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D214(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D27C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D3B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D418(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003D510(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003DFB0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E018(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E080(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E0E8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E150(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E1B8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E220(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E288(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E2F0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003E47C(id a1)
{
  v3[0] = &off_1000A8880;
  v3[1] = &off_1000A88B0;
  v4[0] = &off_1000A8898;
  v4[1] = &off_1000A8898;
  v3[2] = &off_1000A88C8;
  v3[3] = &off_1000A88E0;
  v4[2] = &off_1000A8898;
  v4[3] = &off_1000A88F8;
  v3[4] = &off_1000A88F8;
  v4[4] = &off_1000A8880;
  v1 = [NSDictionary dictionaryWithObjects:v4 forKeys:v3 count:5];
  v2 = qword_1000B8450;
  qword_1000B8450 = v1;
}

void sub_10003E57C(id a1)
{
  v3[0] = &off_1000A8880;
  v3[1] = &off_1000A88B0;
  v4[0] = &off_1000A8910;
  v4[1] = &off_1000A8880;
  v3[2] = &off_1000A88E0;
  v3[3] = &off_1000A88F8;
  v4[2] = &off_1000A8880;
  v4[3] = &off_1000A8880;
  v3[4] = &off_1000A8910;
  v3[5] = &off_1000A8928;
  v4[4] = &off_1000A8880;
  v4[5] = &off_1000A8928;
  v3[6] = &off_1000A88C8;
  v3[7] = &off_1000A8898;
  v4[6] = &off_1000A88F8;
  v4[7] = &off_1000A88F8;
  v3[8] = &off_1000A8940;
  v3[9] = &off_1000A8958;
  v4[8] = &off_1000A8928;
  v4[9] = &off_1000A88B0;
  v3[10] = &off_1000A8970;
  v3[11] = &off_1000A8988;
  v4[10] = &off_1000A8880;
  v4[11] = &off_1000A8910;
  v3[12] = &off_1000A89A0;
  v3[13] = &off_1000A89B8;
  v4[12] = &off_1000A8910;
  v4[13] = &off_1000A88E0;
  v3[14] = &off_1000A89D0;
  v3[15] = &off_1000A89E8;
  v4[14] = &off_1000A8910;
  v4[15] = &off_1000A88B0;
  v3[16] = &off_1000A8A00;
  v3[17] = &off_1000A8A18;
  v4[16] = &off_1000A88B0;
  v4[17] = &off_1000A88E0;
  v3[18] = &off_1000A8A30;
  v3[19] = &off_1000A8A48;
  v4[18] = &off_1000A88B0;
  v4[19] = &off_1000A88B0;
  v3[20] = &off_1000A8A60;
  v3[21] = &off_1000A8A78;
  v4[20] = &off_1000A8928;
  v4[21] = &off_1000A88E0;
  v3[22] = &off_1000A8A90;
  v3[23] = &off_1000A8AA8;
  v4[22] = &off_1000A88B0;
  v4[23] = &off_1000A88B0;
  v3[24] = &off_1000A8AC0;
  v3[25] = &off_1000A8AD8;
  v4[24] = &off_1000A8910;
  v4[25] = &off_1000A8910;
  v3[26] = &off_1000A8AF0;
  v3[27] = &off_1000A8B08;
  v4[26] = &off_1000A8910;
  v4[27] = &off_1000A88E0;
  v3[28] = &off_1000A8B20;
  v3[29] = &off_1000A8B38;
  v4[28] = &off_1000A8880;
  v4[29] = &off_1000A8910;
  v3[30] = &off_1000A8B50;
  v3[31] = &off_1000A8B68;
  v4[30] = &off_1000A8910;
  v4[31] = &off_1000A88F8;
  v3[32] = &off_1000A8B80;
  v3[33] = &off_1000A8B98;
  v4[32] = &off_1000A8928;
  v4[33] = &off_1000A8928;
  v3[34] = &off_1000A8BB0;
  v3[35] = &off_1000A8BC8;
  v4[34] = &off_1000A8928;
  v4[35] = &off_1000A8928;
  v3[36] = &off_1000A8BE0;
  v3[37] = &off_1000A8BF8;
  v4[36] = &off_1000A8928;
  v4[37] = &off_1000A8928;
  v3[38] = &off_1000A8C10;
  v3[39] = &off_1000A8C28;
  v4[38] = &off_1000A8928;
  v4[39] = &off_1000A8928;
  v3[40] = &off_1000A8C40;
  v3[41] = &off_1000A8C58;
  v4[40] = &off_1000A88F8;
  v4[41] = &off_1000A8928;
  v3[42] = &off_1000A8C70;
  v3[43] = &off_1000A8C88;
  v4[42] = &off_1000A8928;
  v4[43] = &off_1000A88C8;
  v3[44] = &off_1000A8CA0;
  v3[45] = &off_1000A8CB8;
  v4[44] = &off_1000A8910;
  v4[45] = &off_1000A88C8;
  v3[46] = &off_1000A8CD0;
  v3[47] = &off_1000A8CE8;
  v4[46] = &off_1000A88C8;
  v4[47] = &off_1000A88C8;
  v3[48] = &off_1000A8D00;
  v3[49] = &off_1000A8D18;
  v4[48] = &off_1000A8880;
  v4[49] = &off_1000A8880;
  v3[50] = &off_1000A8D30;
  v3[51] = &off_1000A8D48;
  v4[50] = &off_1000A8880;
  v4[51] = &off_1000A88C8;
  v3[52] = &off_1000A8D60;
  v3[53] = &off_1000A8D78;
  v4[52] = &off_1000A88C8;
  v4[53] = &off_1000A8910;
  v3[54] = &off_1000A8D90;
  v3[55] = &off_1000A8DA8;
  v4[54] = &off_1000A8910;
  v4[55] = &off_1000A8910;
  v3[56] = &off_1000A8DC0;
  v3[57] = &off_1000A8DD8;
  v4[56] = &off_1000A8910;
  v4[57] = &off_1000A8880;
  v3[58] = &off_1000A8DF0;
  v3[59] = &off_1000A8E08;
  v4[58] = &off_1000A88F8;
  v4[59] = &off_1000A88B0;
  v3[60] = &off_1000A8E20;
  v3[61] = &off_1000A8E38;
  v4[60] = &off_1000A8910;
  v4[61] = &off_1000A8910;
  v3[62] = &off_1000A8E50;
  v3[63] = &off_1000A8E68;
  v4[62] = &off_1000A8910;
  v4[63] = &off_1000A8910;
  v3[64] = &off_1000A8E80;
  v4[64] = &off_1000A8910;
  v3[65] = &off_1000A8E98;
  v4[65] = &off_1000A88C8;
  v3[66] = &off_1000A8EB0;
  v4[66] = &off_1000A88C8;
  v3[67] = &off_1000A8EC8;
  v4[67] = &off_1000A8880;
  v3[68] = &off_1000A8EE0;
  v4[68] = &off_1000A8910;
  v3[69] = &off_1000A8EF8;
  v4[69] = &off_1000A8910;
  v3[70] = &off_1000A8F10;
  v4[70] = &off_1000A88B0;
  v3[71] = &off_1000A8F28;
  v4[71] = &off_1000A8910;
  v3[72] = &off_1000A8F40;
  v4[72] = &off_1000A88C8;
  v3[73] = &off_1000A8F58;
  v4[73] = &off_1000A88C8;
  v3[74] = &off_1000A8F70;
  v4[74] = &off_1000A88C8;
  v3[75] = &off_1000A8F88;
  v4[75] = &off_1000A8910;
  v3[76] = &off_1000A8FA0;
  v4[76] = &off_1000A88C8;
  v3[77] = &off_1000A8FB8;
  v4[77] = &off_1000A88F8;
  v3[78] = &off_1000A8FD0;
  v4[78] = &off_1000A8928;
  v3[79] = &off_1000A8FE8;
  v4[79] = &off_1000A8928;
  v3[80] = &off_1000A9000;
  v4[80] = &off_1000A8928;
  v3[81] = &off_1000A9018;
  v4[81] = &off_1000A88C8;
  v3[82] = &off_1000A9030;
  v4[82] = &off_1000A8928;
  v3[83] = &off_1000A9048;
  v4[83] = &off_1000A8928;
  v1 = [NSDictionary dictionaryWithObjects:v4 forKeys:v3 count:84];
  v2 = qword_1000B8460;
  qword_1000B8460 = v1;
}

void sub_10003EAFC(id a1)
{
  v3[0] = &off_1000A8880;
  v3[1] = &off_1000A8928;
  v4[0] = &off_1000A8988;
  v4[1] = &off_1000A8AD8;
  v3[2] = &off_1000A8940;
  v3[3] = &off_1000A8988;
  v4[2] = &off_1000A9060;
  v4[3] = &off_1000A9078;
  v3[4] = &off_1000A89A0;
  v3[5] = &off_1000A89D0;
  v4[4] = &off_1000A9090;
  v4[5] = &off_1000A89E8;
  v3[6] = &off_1000A8A60;
  v3[7] = &off_1000A8AC0;
  v4[6] = &off_1000A8A48;
  v4[7] = &off_1000A89E8;
  v3[8] = &off_1000A8AD8;
  v3[9] = &off_1000A8AF0;
  v4[8] = &off_1000A89E8;
  v4[9] = &off_1000A89E8;
  v3[10] = &off_1000A8B38;
  v3[11] = &off_1000A8B50;
  v4[10] = &off_1000A9078;
  v4[11] = &off_1000A9090;
  v3[12] = &off_1000A8B80;
  v3[13] = &off_1000A8B98;
  v4[12] = &off_1000A8898;
  v4[13] = &off_1000A8898;
  v3[14] = &off_1000A8BB0;
  v3[15] = &off_1000A8BC8;
  v4[14] = &off_1000A8898;
  v4[15] = &off_1000A8898;
  v3[16] = &off_1000A8BE0;
  v3[17] = &off_1000A8BF8;
  v4[16] = &off_1000A8898;
  v4[17] = &off_1000A8898;
  v3[18] = &off_1000A8C10;
  v3[19] = &off_1000A8C28;
  v4[18] = &off_1000A8898;
  v4[19] = &off_1000A8898;
  v3[20] = &off_1000A8C58;
  v3[21] = &off_1000A8C70;
  v4[20] = &off_1000A8898;
  v4[21] = &off_1000A8898;
  v3[22] = &off_1000A8CA0;
  v3[23] = &off_1000A8D78;
  v4[22] = &off_1000A8CA0;
  v4[23] = &off_1000A8CA0;
  v3[24] = &off_1000A8D90;
  v3[25] = &off_1000A8DA8;
  v4[24] = &off_1000A8AD8;
  v4[25] = &off_1000A8CA0;
  v3[26] = &off_1000A8DC0;
  v3[27] = &off_1000A8E20;
  v4[26] = &off_1000A8CA0;
  v4[27] = &off_1000A8898;
  v3[28] = &off_1000A8E38;
  v3[29] = &off_1000A8E50;
  v4[28] = &off_1000A8DA8;
  v4[29] = &off_1000A8898;
  v3[30] = &off_1000A8E68;
  v3[31] = &off_1000A8E80;
  v4[30] = &off_1000A8898;
  v4[31] = &off_1000A8AD8;
  v3[32] = &off_1000A8EE0;
  v3[33] = &off_1000A8EF8;
  v4[32] = &off_1000A8CA0;
  v4[33] = &off_1000A8898;
  v3[34] = &off_1000A8F28;
  v3[35] = &off_1000A8F88;
  v4[34] = &off_1000A8AD8;
  v4[35] = &off_1000A8CA0;
  v3[36] = &off_1000A8FD0;
  v3[37] = &off_1000A8FE8;
  v4[36] = &off_1000A90A8;
  v4[37] = &off_1000A90A8;
  v3[38] = &off_1000A9000;
  v4[38] = &off_1000A9060;
  v1 = [NSDictionary dictionaryWithObjects:v4 forKeys:v3 count:39];
  v2 = qword_1000B8470;
  qword_1000B8470 = v1;
}

uint64_t start()
{
  v0 = objc_autoreleasePoolPush();
  if (qword_1000B84A8[0] != -1)
  {
    sub_100064668();
  }

  v1 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&_mh_execute_header, v1, OS_LOG_TYPE_DEFAULT, "inboxupdaterd started", buf, 2u);
  }

  if (qword_1000B84A8[0] != -1)
  {
    sub_10006467C();
  }

  v2 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&_mh_execute_header, v2, OS_LOG_TYPE_DEFAULT, "Running Daemon...", v11, 2u);
  }

  dispatch_async(&_dispatch_main_q, &stru_10009EDD8);
  if (qword_1000B84A8[0] != -1)
  {
    sub_1000646A4();
  }

  v3 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *v10 = 0;
    _os_log_impl(&_mh_execute_header, v3, OS_LOG_TYPE_DEFAULT, "Registering notifications...", v10, 2u);
  }

  DarwinNotifyCenter = CFNotificationCenterGetDarwinNotifyCenter();
  CFNotificationCenterAddObserver(DarwinNotifyCenter, 0, sub_10003F180, @"com.apple.mobile.lockdown.activation_state", 0, CFNotificationSuspensionBehaviorCoalesce);
  CFNotificationCenterAddObserver(DarwinNotifyCenter, 0, sub_10003F180, @"com.apple.springboard.lockstate", 0, CFNotificationSuspensionBehaviorDeliverImmediately);
  if (qword_1000B84A8[0] != -1)
  {
    sub_1000646CC();
  }

  v5 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *v9 = 0;
    _os_log_impl(&_mh_execute_header, v5, OS_LOG_TYPE_DEFAULT, "Starting XPC listener...", v9, 2u);
  }

  v6 = +[MIBUXPCListener sharedInstance];
  [v6 start];

  v7 = +[NSRunLoop currentRunLoop];
  [v7 run];

  objc_autoreleasePoolPop(v0);
  return 0;
}

void sub_10003F048(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003F0B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003F118(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003F180(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (qword_1000B84A8[0] != -1)
  {
    sub_1000646F4();
  }

  v4 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v5 = 138543362;
    v6 = a3;
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "Received notification: %{public}@", &v5, 0xCu);
  }

  dispatch_async(&_dispatch_main_q, &stru_10009EDD8);
}

void sub_10003F254(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003F2BC(id a1)
{
  if (!+[MIBUCertHelper SUCertPresent])
  {
    if (qword_1000B84A8[0] != -1)
    {
      sub_100064708();
    }

    v6 = qword_1000B84A0;
    if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&_mh_execute_header, v6, OS_LOG_TYPE_DEFAULT, "Factory SU certificate does not exist, disable daemon", buf, 2u);
    }

    v3 = 0;
    goto LABEL_18;
  }

  v1 = +[MIBUDeviceController sharedInstance];
  v51 = 0;
  v2 = [v1 isActivated:&v51];
  v3 = v51;

  if (!v2)
  {
    v7 = +[MIBUDeviceController sharedInstance];
    v8 = [v7 isInitialBuddySetupComplete];

    if (v8)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_10006485C();
      }

      v4 = qword_1000B84A0;
      if (!os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        goto LABEL_18;
      }

      *buf = 0;
      v5 = "Initial Setup completed, deleting factory SU certificate & disable daemon";
      goto LABEL_17;
    }

    v23 = +[MIBUDeviceController sharedInstance];
    v24 = [v23 isOnLockScreen];

    if (v24)
    {
      v25 = +[MIBUDeviceController sharedInstance];
      v26 = [v25 supportsSeaShip];

      if (v26)
      {
        v27 = +[MIBUShipUpdateMainController sharedInstance];
        v28 = [v27 running];

        if ((v28 & 1) == 0)
        {
          if (qword_1000B84A8[0] != -1)
          {
            sub_100064794();
          }

          v29 = qword_1000B84A0;
          if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 0;
            _os_log_impl(&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, "Starting shipping update main controller ...", buf, 2u);
          }

          v30 = +[MIBUShipUpdateMainController sharedInstance];
          v31 = v30;
          v49 = v3;
          v32 = &v49;
          v33 = &v49;
LABEL_71:
          [v30 start:v33];
          goto LABEL_79;
        }
      }

      else
      {
        v39 = +[MIBUMainController sharedInstance];
        v40 = [v39 running];

        if ((v40 & 1) == 0)
        {
          if (qword_1000B84A8[0] != -1)
          {
            sub_10006476C();
          }

          v41 = qword_1000B84A0;
          if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 0;
            _os_log_impl(&_mh_execute_header, v41, OS_LOG_TYPE_DEFAULT, "Starting in-box update main controller ...", buf, 2u);
          }

          v30 = +[MIBUMainController sharedInstance];
          v31 = v30;
          v50 = v3;
          v32 = &v50;
          v33 = &v50;
          goto LABEL_71;
        }
      }

LABEL_81:
      v15 = v3;
      if (!v3)
      {
        goto LABEL_86;
      }

      goto LABEL_82;
    }

    v34 = +[MIBUMainController sharedInstance];
    v35 = [v34 running];

    if (v35)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_100064744();
      }

      v36 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, "Cleaning up in-box update main controller...", buf, 2u);
      }

      v37 = +[MIBUMainController sharedInstance];
      v31 = v37;
      v48 = v3;
      v32 = &v48;
      v38 = &v48;
    }

    else
    {
      v42 = +[MIBUShipUpdateMainController sharedInstance];
      v43 = [v42 running];

      if (!v43)
      {
        goto LABEL_81;
      }

      if (qword_1000B84A8[0] != -1)
      {
        sub_10006471C();
      }

      v44 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&_mh_execute_header, v44, OS_LOG_TYPE_DEFAULT, "Cleaning up shipping update main controller...", buf, 2u);
      }

      v37 = +[MIBUShipUpdateMainController sharedInstance];
      v31 = v37;
      v47 = v3;
      v32 = &v47;
      v38 = &v47;
    }

    [v37 cleanup:v38];
LABEL_79:
    v15 = *v32;

    if (!v15)
    {
      goto LABEL_86;
    }

LABEL_82:
    if (qword_1000B84A8[0] != -1)
    {
      sub_1000647BC();
    }

    v45 = qword_1000B84A0;
    if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_ERROR))
    {
      sub_1000647E4(v15, v45);
    }

    goto LABEL_86;
  }

  if (qword_1000B84A8[0] != -1)
  {
    sub_100064884();
  }

  v4 = qword_1000B84A0;
  if (!os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    goto LABEL_18;
  }

  *buf = 0;
  v5 = "Device activated; deleting factory SU certificate & disable daemon";
LABEL_17:
  _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, v5, buf, 2u);
LABEL_18:
  if (os_variant_has_internal_content())
  {
    v9 = +[MIBUTestPreferences sharedInstance];
    v10 = [v9 skipDaemonDisable];

    if (v10)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_1000648AC();
      }

      v11 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, "Skipping daemon disable", buf, 2u);
      }
    }

    v12 = +[MIBUTestPreferences sharedInstance];
    v13 = [v12 skipCertDeletion];

    if (v13)
    {
      if (qword_1000B84A8[0] != -1)
      {
        sub_100064924();
      }

      v14 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&_mh_execute_header, v14, OS_LOG_TYPE_DEFAULT, "Skipping cert deletion", buf, 2u);
      }

      v15 = v3;
      if (v10)
      {
        goto LABEL_86;
      }

LABEL_42:
      if (qword_1000B84A8[0] != -1)
      {
        sub_10006494C();
      }

      v19 = qword_1000B84A0;
      if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 136315138;
        v53 = "com.apple.inboxupdaterd";
        _os_log_impl(&_mh_execute_header, v19, OS_LOG_TYPE_DEFAULT, "Disabling daemon %s", buf, 0xCu);
      }

      v20 = launch_set_service_enabled();
      if (v20)
      {
        v21 = v20;
        if (qword_1000B84A8[0] != -1)
        {
          sub_100064974();
        }

        v22 = qword_1000B84A0;
        if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 67109120;
          LODWORD(v53) = v21;
          _os_log_impl(&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, "Failed to disable daemon, err: %d", buf, 8u);
        }
      }

      goto LABEL_86;
    }

    v16 = v10 ^ 1;
  }

  else
  {
    v16 = 1;
  }

  if (qword_1000B84A8[0] != -1)
  {
    sub_1000648D4();
  }

  v17 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, "Deleting Factory SU certificate...", buf, 2u);
  }

  v46 = v3;
  [MIBUCertHelper deleteSUCert:&v46];
  v15 = v46;

  if (qword_1000B84A8[0] != -1)
  {
    sub_1000648FC();
  }

  v18 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v53 = v15;
    _os_log_impl(&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, "Factory SU certificate deletion done with error: %{public}@", buf, 0xCu);
  }

  if (v16)
  {
    goto LABEL_42;
  }

LABEL_86:
}

void sub_10003FA2C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FA94(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FAFC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FB64(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FBCC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FC34(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FC9C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FD04(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FD6C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FDD4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FE3C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FEA4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FF0C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FF74(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10003FFDC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004023C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000402A4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004030C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040374(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000403DC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040444(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040548(void *a1, NSObject *a2, uint64_t a3, const char *a4, uint8_t *a5)
{

  _os_log_error_impl(a1, a2, OS_LOG_TYPE_ERROR, a4, a5, 2u);
}

void sub_10004063C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000406A4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004070C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040774(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000407DC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040844(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000408AC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040914(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004097C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000409E4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040A4C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040AB4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040B1C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040B84(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100040E5C(void *a1, int a2, int a3, const char *a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18, uint64_t a19, uint64_t a20, uint8_t buf)
{

  _os_log_error_impl(a1, v21, OS_LOG_TYPE_ERROR, a4, &buf, 2u);
}

void sub_1000415A8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100041610(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100041678(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000416E0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100041748(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000417B0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000419D8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100041A40(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100041E30(uint64_t a1)
{
  v6 = [*(a1 + 32) latestUpdate];
  v2 = [v6 productBuildVersion];
  [*(a1 + 40) setTargetBuildVersion:v2];

  v3 = [v6 productVersion];
  [*(a1 + 40) setTargetOSVersion:v3];

  v4 = +[NSNumber numberWithUnsignedLongLong:](NSNumber, "numberWithUnsignedLongLong:", [v6 downloadSize]);
  [*(a1 + 40) setTargetSUBundleSize:v4];

  v5 = [*(a1 + 40) suController];
  [v5 download:v6];
}

void sub_100042054(uint64_t a1)
{
  v2 = [*(a1 + 40) productBuildVersion];
  [*(a1 + 32) setTargetBuildVersion:v2];

  v3 = [*(a1 + 32) currentBuildVersion];
  [MIBUDefaultPreferences setObject:v3 forKey:@"PreviousOSVersion"];

  v4 = [*(a1 + 32) targetBuildVersion];
  [MIBUDefaultPreferences setObject:v4 forKey:@"TargetOSVersion"];

  if (qword_1000B84A8[0] != -1)
  {
    sub_100065F40();
  }

  v5 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v6 = *(a1 + 32);
    v7 = v5;
    v8 = +[MIBUDefaultPreferences dictionaryRepresentation];
    v9 = [NSString stringWithFormat:@"Saved defaults %@", v8];
    *buf = 138543618;
    v11 = v6;
    v12 = 2114;
    v13 = v9;
    _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }
}

void sub_1000421FC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

id sub_100042318(uint64_t a1)
{
  objc_storeStrong((*(a1 + 32) + 40), *(a1 + 40));
  if (qword_1000B84A8[0] != -1)
  {
    sub_100065F54();
  }

  v2 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = v2;
    v5 = [v3 error];
    v6 = [NSString stringWithFormat:@"Software update finished with error: %@", v5];
    *buf = 138543618;
    v9 = v3;
    v10 = 2114;
    v11 = v6;
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }

  return [*(a1 + 32) _transitionToState:4 error:0];
}

void sub_100042464(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000425A4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004260C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000426FC(uint64_t a1)
{
  if (qword_1000B84A8[0] != -1)
  {
    sub_100065F68();
  }

  v2 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = v2;
    v5 = [NSString stringWithFormat:@"Install timer fired!"];
    *buf = 138543618;
    v20 = v3;
    v21 = 2114;
    v22 = v5;
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }

  v7 = *(a1 + 32);
  v6 = (a1 + 32);
  if ([v7 state] == 2)
  {
    v18 = 0;
    sub_100016130(&v18, 67108870, 0, @"Software update pending install timed out", v8, v9, v10, v11, v17);
    v12 = v18;
    v13 = [*v6 delegate];
    v14 = [v13 nfcController];
    [v14 terminate:0];

    v15 = *(*v6 + 5);
    *(*v6 + 5) = v12;
    v16 = v12;

    [*v6 _transitionToState:4 error:0];
  }

  else
  {
    sub_100065F7C(v6);
  }
}

void sub_1000428AC(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100042914(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100042FA8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043010(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043078(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000430E0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043148(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v1 = [WeakRetained suController];
  [v1 start];
}

void sub_1000431A0(uint64_t a1)
{
  v2 = dispatch_get_global_queue(33, 0);
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = sub_10004324C;
  block[3] = &unk_100099458;
  objc_copyWeak(&v4, (a1 + 32));
  dispatch_async(v2, block);

  objc_destroyWeak(&v4);
}

void sub_10004324C(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 32));
  v1 = [WeakRetained suController];
  [v1 install];
}

void sub_1000432A4(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_10004330C(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000434C4(uint64_t a1)
{
  [*(a1 + 32) _stopInstallTimer];
  if (qword_1000B84A8[0] != -1)
  {
    sub_10006628C();
  }

  v2 = qword_1000B84A0;
  if (os_log_type_enabled(qword_1000B84A0, OS_LOG_TYPE_DEFAULT))
  {
    v3 = *(a1 + 32);
    v4 = v2;
    [v3 idleTimeInterval];
    v6 = [NSString stringWithFormat:@"Starting install timer with %lfs timeout...", v5];
    *buf = 138543618;
    v16 = v3;
    v17 = 2114;
    v18 = v6;
    _os_log_impl(&_mh_execute_header, v4, OS_LOG_TYPE_DEFAULT, "%{public}@: %{public}@", buf, 0x16u);
  }

  [*(a1 + 32) idleTimeInterval];
  v8 = v7;
  v9 = +[NSDate date];
  v10 = [NSDate dateWithTimeInterval:v9 sinceDate:v8];

  v11 = [[PCPersistentTimer alloc] initWithFireDate:v10 serviceIdentifier:@"com.apple.mobileinboxupdater.postsutimer" target:*(a1 + 32) selector:"handleInstallTimer:" userInfo:0];
  [*(a1 + 32) setInstallTimer:v11];

  v12 = [*(a1 + 32) installTimer];
  [v12 setMinimumEarlyFireProportion:1.0];

  v13 = [*(a1 + 32) installTimer];
  v14 = +[NSRunLoop mainRunLoop];
  [v13 scheduleInRunLoop:v14];
}

void sub_1000436C0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043864(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043B78(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043BE0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100043C48(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

uint64_t sub_100043EC8(uint64_t result, uint64_t a2, uint64_t a3, float a4)
{
  *a2 = a4;
  *(a2 + 4) = a3;
  *(a2 + 12) = 2114;
  *(a2 + 14) = result;
  return result;
}

void sub_100043F08(void *a1@<X0>, const char *a2@<X3>, uint8_t *a3@<X4>, NSObject *a4@<X8>)
{

  _os_log_error_impl(a1, a4, OS_LOG_TYPE_ERROR, a2, a3, 0x16u);
}

void sub_100043FA0(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044008(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044070(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044690(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000446F8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044760(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000447C8(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044830(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044898(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_100044900(id a1)
{
  v1 = os_log_create("com.apple.mobileinboxupdater", "device");
  v2 = qword_1000B84A0;
  qword_1000B84A0 = v1;

  if (!qword_1000B84A0)
  {
    v3 = os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR);
    if (v3)
    {
      sub_1000524D0(v3, v4, v5, v6, v7, v8, v9, v10);
    }
  }
}

void sub_1000459C4(void *a1, int a2, int a3, const char *a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint8_t buf)
{

  _os_log_error_impl(a1, v13, OS_LOG_TYPE_ERROR, a4, &buf, 0xCu);
}

void *sub_1000459E4(int a1, int a2)
{
  switch(a1)
  {
    case 1:
      v2 = &off_1000B7CF8;
      goto LABEL_29;
    case 2:
      v2 = &off_1000B7CD0;
      goto LABEL_29;
    case 3:
      v2 = &off_1000B7CF0;
      goto LABEL_29;
    case 4:
      v2 = &off_1000B7D08;
      goto LABEL_29;
    case 5:
      v2 = &off_1000B7CB0;
      goto LABEL_29;
    case 6:
      v2 = &off_1000B8070;
      goto LABEL_29;
    case 7:
      v2 = &off_1000B8068;
      goto LABEL_29;
    case 8:
      v3 = &off_1000B8080;
      goto LABEL_27;
    case 9:
      v3 = &off_1000B8088;
      goto LABEL_27;
    case 10:
      v2 = &off_1000B80D8;
      goto LABEL_29;
    case 11:
      v2 = &off_1000B80E0;
      goto LABEL_29;
    case 12:
      v2 = &off_1000B80E8;
      goto LABEL_29;
    case 13:
      v2 = &off_1000B80F0;
      goto LABEL_29;
    case 14:
      v2 = &off_1000B80F8;
      goto LABEL_29;
    case 15:
      v2 = &off_1000B8078;
      goto LABEL_29;
    case 16:
      v3 = &off_1000B7ED8;
      goto LABEL_27;
    case 17:
      v2 = &off_1000B7EE8;
      goto LABEL_29;
    case 18:
      v3 = &off_1000B7F00;
      goto LABEL_27;
    case 19:
      v4 = off_1000B7F10;
      v5 = a2 == 3;
      goto LABEL_30;
    case 20:
      v3 = &off_1000B7F18;
      goto LABEL_27;
    case 21:
      v2 = &off_1000B7F20;
      goto LABEL_29;
    case 22:
      v3 = &off_1000B7F08;
      goto LABEL_27;
    case 23:
      v3 = &off_1000B7EE0;
      goto LABEL_27;
    case 24:
      v2 = &off_1000B8240;
      goto LABEL_29;
    case 25:
      v2 = &off_1000B82B8;
LABEL_29:
      v4 = *v2;
      v5 = a2 == 2;
      goto LABEL_30;
    case 26:
      v3 = &off_1000B8090;
LABEL_27:
      v4 = *v3;
      v5 = a2 == 1;
LABEL_30:
      if (v5)
      {
        result = v4;
      }

      else
      {
        result = 0;
      }

      break;
    default:
      result = 0;
      break;
  }

  return result;
}

uint64_t sub_100045BD8(uint64_t a1, void *a2, rsize_t a3, uint64_t a4, uint64_t a5)
{
  v5 = 3758097122;
  v12 = 0;
  v6 = 3758097090;
  if (!a2 || !a3 || sub_10006BAB0(a2) != a3)
  {
    return v6;
  }

  v6 = sub_100067524();
  if (!v6)
  {
    v6 = sub_1000675D0(v12, a4, a5, a2, a3);
    sub_100067494(&v12);
  }

  if (v6 <= -536870175)
  {
    if (v6 != -536870212)
    {
      if (v6 == -536870194)
      {
        return v5;
      }

      return v6;
    }

    return 3758097084;
  }

  if (v6 != -536870174 && v6 != -536363000)
  {
    if (v6 != -536362999)
    {
      return v6;
    }

    return 3758097084;
  }

  return v5;
}

uint64_t sub_100045D2C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v3 = 3758097122;
  v6 = 0;
  v4 = 3758097090;
  if (!a2 || !a3 || sub_10006BAB0(a2) != a3)
  {
    return v4;
  }

  v4 = sub_100067524();
  if (!v4)
  {
    v4 = sub_100067804(v6);
    sub_100067494(&v6);
  }

  if (v4 <= -536870175)
  {
    if (v4 != -536870212)
    {
      if (v4 == -536870194)
      {
        return v3;
      }

      return v4;
    }

    return 3758097084;
  }

  if (v4 != -536870174 && v4 != -536363000)
  {
    if (v4 != -536362999)
    {
      return v4;
    }

    return 3758097084;
  }

  return v3;
}

uint64_t sub_100045E60(uint64_t a1, uint64_t a2, void *a3, void *a4, void **a5, void *a6)
{
  v16[0] = a1;
  v16[1] = a1 + a2;
  v15 = 0;
  __n_4 = 0;
  __n = 0;
  __s = 0;
  if (a1 && a3 && a4 && a5 && a6 && ccder_blob_decode_range() && sub_10006E404(v16, 4, &__s, &__n))
  {
    if (sub_10006E404(v16, 4, &__n_4, &v15))
    {
      v10 = 0;
      *a3 = __n_4;
      *a4 = v15;
      *a5 = __s;
      *a6 = __n;
      return v10;
    }

    sub_100069C00(__n_4, &v15, &__n_4);
  }

  v10 = 3758097084;
  if (__s)
  {
    memset_s(__s, __n, 0, __n);
    free(__s);
  }

  return v10;
}

uint64_t sub_100045F7C(uint64_t a1)
{
  if (!*(a1 + 32))
  {
    return 0;
  }

  v3 = 0;
  v4 = 0;
  v1 = *(a1 + 16);
  result = sub_10006BBE8(off_1000B7D38, &v3, &v4);
  if (result)
  {
    return sub_10006BCCC();
  }

  return result;
}

uint64_t sub_100045FE0(void *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  v7 = a7;
  v22[0] = a6;
  v22[1] = a6 + a7;
  v21 = 0;
  v20 = 0;
  sub_10006BDC4(v22, 4, &v21, &v20);
  if ((v10 & 1) == 0)
  {
    v20 = a6;
    v21 = v7;
  }

  v11 = 3758097090;
  v12 = sub_1000461EC(a1);
  if ((v12 - 4) < 2)
  {
    v18 = 0;
    goto LABEL_8;
  }

  if ((v12 - 7) < 2)
  {
    v13 = ccec_cp_384();
    v18 = 0;
    if (v13)
    {
LABEL_9:
      v14 = 24 * *v13 + 31;
      __chkstk_darwin();
      bzero(&v17 - v15, v15);
      v19 = 0;
      if (sub_100046250(a1, &v19) && !ccec_import_pub() && !ccec_verify())
      {
        if ((v18 & 1) == 0)
        {
          return 3758604294;
        }

        return 0;
      }

      return v11;
    }

LABEL_8:
    v13 = ccec_cp_256();
    goto LABEL_9;
  }

  if (v12 == 3)
  {
    v19 = 0;
    if (sub_100046250(a1, &v19))
    {
      if (v19 == 32 && v20 && v21 == 64)
      {
        ccsha512_di();
        if (cced25519_verify())
        {
          return 3758604294;
        }

        return 0;
      }
    }
  }

  return v11;
}

uint64_t sub_1000461EC(uint64_t a1)
{
  if (!*(a1 + 32))
  {
    return 0;
  }

  v3 = 0;
  v4 = 0;
  v1 = *(a1 + 16);
  result = sub_10006BBE8(off_1000B7D30, &v3, &v4);
  if (result)
  {
    return sub_10006BCCC();
  }

  return result;
}

uint64_t sub_100046250(void *a1, void *a2)
{
  v20 = 0;
  v19 = 0;
  if (!a1[4])
  {
    return 0;
  }

  v17 = 0;
  v18 = 0;
  v4 = a1[2];
  if (sub_10006BBE8(off_1000B7D28, &v17, &v18))
  {
    v16[0] = v17;
    v16[1] = v17 + v18;
    sub_10006BDC4(v16, 4, &v20, &v19);
  }

  v5 = sub_1000461EC(a1);
  if ((v5 - 7) < 2)
  {
    v6 = ccec_cp_384();
    goto LABEL_9;
  }

  if ((v5 - 4) <= 1)
  {
    v6 = ccec_cp_256();
LABEL_9:
    v8 = v6;
    if (v6 && v20 == (j__cczp_bitlen() + 7) >> 3)
    {
      if (v19 && !a1[8])
      {
        v9 = 24 * *v8 + 31;
        __chkstk_darwin();
        bzero(&v16[-1] - v10, v10);
        ccec_compact_import_pub();
        v11 = (2 * sub_100047B94()) | 1;
        v12 = calloc(v11, 1uLL);
        a1[8] = v12;
        a1[9] = v11;
        if (v12)
        {
          ccec_export_pub();
        }

        v13 = *v8;
        cc_clear();
      }

      v14 = a1[9];
      v19 = a1[8];
      v20 = v14;
    }
  }

  *a2 = v20;
  return v19;
}

uint64_t sub_100046428(uint64_t *a1, void *a2)
{
  result = *a1;
  *a2 = a1[1];
  return result;
}

uint64_t sub_100046434(uint64_t a1, uint64_t *a2)
{
  v4 = *(a1 + 16);
  *a2 = sub_10006BAB0(*(a1 + 24));
  return *(a1 + 24);
}

uint64_t sub_10004646C(uint64_t a1, void *a2)
{
  v10 = 0;
  v9 = 0;
  if (!*(a1 + 32))
  {
    return 0;
  }

  v7 = 0;
  v8 = 0;
  v3 = *(a1 + 16);
  v4 = sub_10006BBE8(off_1000B7D40, &v7, &v8);
  result = 0;
  if (v4)
  {
    v6[0] = v7;
    v6[1] = v7 + v8;
    sub_10006BDC4(v6, 4, &v10, &v9);
    *a2 = v10;
    return v9;
  }

  return result;
}

uint64_t sub_10004652C(uint64_t a1)
{
  if (!*(a1 + 32))
  {
    return 0;
  }

  v3 = 0;
  v4 = 0;
  v1 = *(a1 + 16);
  result = sub_10006BBE8(off_1000B7CA8, &v3, &v4);
  if (result)
  {
    return sub_10006BCCC();
  }

  return result;
}

uint64_t sub_100046590(uint64_t a1)
{
  if (!*(a1 + 32))
  {
    return 0;
  }

  v4 = 0;
  v5 = 0;
  v1 = *(a1 + 16);
  v2 = sub_10006BBE8(off_1000B8088, &v4, &v5);
  result = 0;
  if (v2)
  {
    return sub_10006BCCC();
  }

  return result;
}

void sub_10004661C(void *a1, rsize_t __n)
{
  memset_s(a1, __n, 0, __n);

  free(a1);
}

uint64_t sub_100046684()
{

  return memset_s(v0, 8uLL, 0, 8uLL);
}

uint64_t sub_1000466C4()
{
  v3 = *v1;
  v4 = *v0;
  v5 = v0[2];

  return sub_10006C318();
}

uint64_t sub_1000466E4()
{

  return sub_100068070();
}

uint64_t sub_100046704(void *a1)
{

  return memset_s(a1, 8uLL, 0, 8uLL);
}

uint64_t sub_100046748()
{
  v2 = *(v0 + 40);

  return sub_100067904();
}

uint64_t sub_100046768(uint64_t a1, uint64_t a2, ...)
{
  va_start(va1, a2);
  va_start(va, a2);
  v5 = va_arg(va1, void);

  return sub_10006C148(v2, va, va1);
}

uint64_t sub_100046784(void *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, uint64_t a10, uint64_t a11, rsize_t __n)
{

  return memset_s(a1, __n, 0, __n);
}

uint64_t sub_1000467A0(void *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, rsize_t __n)
{

  return memset_s(a1, __n, 0, __n);
}

uint64_t sub_1000467BC()
{
  v2 = *v0;
  v3 = v0[2];

  return sub_10006C318();
}

void sub_100046808(uint64_t a1@<X3>, uint64_t a2@<X8>)
{
  *v2 = a1;
  *(v2 + 8) = a2;
  *(v2 + 40) = v3;
  *(v2 + 16) = a1 + a2;
}

uint64_t sub_100046840(void *a1, rsize_t __n)
{

  return memset_s(a1, __n, 0, __n);
}

void sub_100046858(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, void *a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, uint64_t a17, uint64_t a18)
{
  *a10 = v18;
  *v20 = a17;
  *v19 = a18;
}

void *sub_1000468CC()
{

  return calloc(8uLL, 1uLL);
}

uint64_t sub_1000468E4(void *a1)
{

  return memset_s(a1, 0x50uLL, 0, 0x50uLL);
}

uint64_t sub_100046944()
{
  v2 = *v0;
  v3 = v0[2];

  return sub_10006C318();
}

uint64_t sub_100046984(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, ...)
{
  va_start(va1, a4);
  va_start(va, a4);
  v7 = va_arg(va1, void);

  return sub_10006C148(v4, va, va1);
}

uint64_t sub_1000469B0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13, uint64_t a14, uint64_t a15, uint64_t a16, void *a17, uint64_t a18, uint64_t a19, uint64_t a20, uint64_t a21)
{
  v23 = a21;
  v24 = *(v21 - 88);

  return sub_100045E60(v23, v24, &a19, &a20, &a17, &a18);
}

uint64_t sub_1000469D8()
{
  v3 = *v1;

  return sub_100047ED4(v0, v3);
}

void sub_100046A28(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, void *a10, uint64_t a11, uint64_t a12)
{
  v13 = *(v12 + 16);
  *a10 = a11;
  *v13 = a12;
}

uint64_t sub_100046A7C()
{

  return sub_100068070();
}

uint64_t sub_100046A98()
{

  return sub_10006C100(v0);
}

uint64_t sub_100046B14()
{
  v3 = *v0;
  v4 = *v1;
  v5 = v1[2];

  return sub_10006C318();
}

uint64_t sub_100046B34()
{

  return sub_100067904();
}

uint64_t sub_100046B54(int a1, void *__s, int a3, int a4, int a5, int a6, int a7, int a8, uint64_t a9, rsize_t __smax)
{

  return memset_s(__s, __smax, 0, __smax);
}

uint64_t sub_100046B74(uint64_t a1, uint64_t a2)
{

  return sub_10006C6E0(v2, a2, v3);
}

void *sub_100046B8C()
{

  return calloc(0x50uLL, 1uLL);
}

uint64_t sub_100046BA4()
{
  if (qword_1000B8490 != -1)
  {
    sub_10006B734();
  }

  dispatch_sync(qword_1000B8498, &stru_1000A0BF0);
  return dword_1000B8480;
}

uint64_t sub_100046BEC(unsigned int a1, const void *a2)
{
  input = a1;
  v3 = sub_100046BA4();
  if (v3)
  {
    return IOConnectCallMethod(v3, 0x6Cu, &input, 1u, a2, 0x10uLL, 0, 0, 0, 0);
  }

  sub_10006B748();
  return 3758097084;
}

char *sub_100046C84(char *result, uint64_t a2, uint64_t a3)
{
  if (result)
  {
    v5[0] = result;
    v5[1] = 0;
    result = fts_open(v5, 84, 0);
    if (result)
    {
      return sub_10006B7B0(result, a2, a3);
    }
  }

  return result;
}

char *sub_100046D04(char *result, int a2)
{
  if (result)
  {
    v3 = result;
    bzero(v8, 0x400uLL);
    result = realpath_DARWIN_EXTSN(v3, v8);
    if (result)
    {
      v6[0] = _NSConcreteStackBlock;
      v6[1] = 0x40000000;
      v6[2] = sub_100046E1C;
      v6[3] = &unk_1000A0B30;
      v7 = a2;
      v4[0] = _NSConcreteStackBlock;
      v4[1] = 0x40000000;
      v4[2] = sub_10006A068;
      v4[3] = &unk_1000A0B50;
      v5 = a2;
      return sub_100046C84(v8, v6, v4);
    }
  }

  return result;
}

uint64_t sub_100046E1C(uint64_t a1, uint64_t a2)
{
  v4 = sub_10006A00C(*(a2 + 48));
  v5 = *(a1 + 32);
  if (v5 == -1 || v4 == v5)
  {
    printf(" dir: %s %i\n", *(a2 + 48), v4);
  }

  return 1;
}

uint64_t sub_100046E78()
{
  v0 = IORegistryEntryFromPath(kIOMasterPortDefault, "IODeviceTree:/filesystems");
  if (v0)
  {
    v1 = v0;
    CFProperty = IORegistryEntryCreateCFProperty(v0, @"e-apfs", kCFAllocatorDefault, 0);
    v3 = CFProperty != 0;
    if (CFProperty)
    {
      CFRelease(CFProperty);
    }

    IOObjectRelease(v1);
  }

  else
  {
    v3 = 0;
  }

  __len = 1023;
  bzero(__big, 0x400uLL);
  if ((byte_1000B8488 & 1) == 0)
  {
    if (!sysctlbyname("kern.bootargs", __big, &__len, 0, 0) && strnstr(__big, "-apfs_shared_datavolume", __len))
    {
      byte_1000B8489 = 1;
    }

    byte_1000B8488 = 1;
  }

  v4 = byte_1000B8489;
  fprintf(__stdoutp, "%s:%spid:%d,%s:%s%s%s%s%s%u:%s ioreg: %d, boot_arg: %d%s\n", "aks", "", -1, "", "", "", "", "aks_fs_supports_enhanced_apfs", ":", 438, "", v3, byte_1000B8489, "");
  return v3 | v4;
}

void sub_100046FFC(const char *a1, uint64_t a2, uint64_t a3)
{
  bzero(__str, 0x400uLL);
  memset(&v7, 0, sizeof(v7));
  if (a3)
  {
    v6 = (a2 + 16);
    do
    {
      snprintf(__str, 0x400uLL, "%s%s", a1, *(v6 - 2));
      if (stat(__str, &v7))
      {
        printf("stat failed: %s\n");
      }

      else
      {
        sub_10006A00C(__str);
        *v6;
        printf("%s: mode=%o, u/g=%i:%i class=%i%s\n");
      }

      v6 += 6;
      --a3;
    }

    while (a3);
  }
}

uint64_t sub_100047144()
{
  puts("shared allow list:");
  v0 = &byte_10009F6F0;
  v1 = 36;
  do
  {
    if (*v0)
    {
      printf("%s%s\n", "<var>", *(v0 - 2));
    }

    v0 += 48;
    --v1;
  }

  while (v1);
  result = puts("user allow list:");
  v3 = &byte_10009FDB0;
  v4 = 72;
  do
  {
    if (*v3)
    {
      result = printf("%s%s\n", "<user>", *(v3 - 2));
    }

    v3 += 48;
    --v4;
  }

  while (v4);
  return result;
}

void sub_100047208(const char *a1, char a2)
{
  if (a1)
  {
    bzero(&v13, 0x878uLL);
    bzero(v12, 0x400uLL);
    if (realpath_DARWIN_EXTSN(a1, v12))
    {
      v4 = malloc(0x818uLL);
      memset_s(v4, 0x818uLL, 0, 0x818uLL);
      v11[0] = _NSConcreteStackBlock;
      v11[1] = 0x40000000;
      v11[2] = sub_10006AC14;
      v11[3] = &unk_1000A0BB0;
      v11[4] = v4;
      sub_100046C84(v12, &stru_1000A0B90, v11);
      if (!statfs(v12, &v13))
      {
        if (a2)
        {
          printf("Free Blocks:%lld blocks of size:%d\n");
        }

        else
        {
          printf("%lld,%d\n");
        }
      }

      v5 = v4 + 340;
      for (i = 1; i != 5; ++i)
      {
        if (a2)
        {
          v9 = &v4[296 * i];
          printf("%s:\n\tNum files:\t%u,\n\tNum hardlinks:\t%u,\n\tNum compressed:\t%u,\n\tTotal Size:\t%lld,\n\tMin File Size:\t%lld,\n\tMax File Size:\t%lld,\n", off_1000B7C70[i], *v9, *(v9 + 2), *(v9 + 1), *(v9 + 2), *(v9 + 3), *(v9 + 4));
          printf("\tSize Distribution:");
          printf("%i", *(v9 + 10));
          for (j = 0; j != 252; j += 4)
          {
            putchar(44);
            printf("%i", *&v5[j]);
          }
        }

        else
        {
          v7 = &v4[296 * i];
          printf("%i,%u,%u,%u,%lld,%lld,%lld,", i, *v7, *(v7 + 2), *(v7 + 1), *(v7 + 2), *(v7 + 3), *(v7 + 4));
          printf("%i", *(v7 + 10));
          for (k = 0; k != 252; k += 4)
          {
            putchar(44);
            printf("%i", *&v5[k]);
          }
        }

        putchar(10);
        v5 += 296;
      }

      free(v4);
    }
  }
}

uint64_t sub_100047490(unsigned int a1, uint64_t a2)
{
  input[0] = 1;
  input[1] = a1;
  input[2] = a2;
  output = 0;
  outputCnt = 1;
  v2 = sub_100046BA4();
  if (v2)
  {
    return IOConnectCallMethod(v2, 0x56u, input, 3u, 0, 0, &output, &outputCnt, 0, 0);
  }

  sub_10006B86C();
  return 3758097084;
}

uint64_t sub_10004752C()
{
  v0 = sub_100046BA4();
  if (v0)
  {
    return IOConnectCallMethod(v0, 0x10u, 0, 0, 0, 0, 0, 0, 0, 0);
  }

  sub_10006B8D4();
  return 3758097084;
}

uint64_t sub_100047584(unsigned int a1)
{
  v2 = sub_100046BA4();
  if (v2)
  {
    input = a1;
    return IOConnectCallMethod(v2, 0x86u, &input, 1u, 0, 0, 0, 0, 0, 0);
  }

  else
  {
    sub_10006B93C();
    return 3758097084;
  }
}

void sub_10004761C(id a1)
{
  if (!dword_1000B8480)
  {
    dword_1000B8480 = sub_1000478F4("IOService:/IOResources/AppleKeyStore", "AppleKeyStore");
  }
}

uint64_t sub_10004765C()
{
  if (qword_1000B8490 != -1)
  {
    sub_10006B734();
  }

  dispatch_sync(qword_1000B8498, &stru_1000A0C30);
  return dword_1000B8484;
}

void sub_1000476A4(id a1)
{
  if (!dword_1000B8484)
  {
    dword_1000B8484 = sub_1000478F4("IOService:/IOResources/AppleKeyStoreTest", "AppleKeyStoreTest");
  }
}

uint64_t sub_1000476E4(mach_port_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, void *a7, size_t *a8)
{
  input = a3;
  memset(inputStructCnt, 0, sizeof(inputStructCnt));
  sub_100048804(&inputStructCnt[1], inputStructCnt, 2, a4, a5, a6, a7, a8, a2);
  v11 = IOConnectCallMethod(a1, 0x14u, &input, 1u, *&inputStructCnt[1], inputStructCnt[0], 0, 0, a7, a8);
  free(*&inputStructCnt[1]);
  return v11;
}

uint64_t sub_100047818(mach_port_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  input = a2;
  memset(inputStructCnt, 0, sizeof(inputStructCnt));
  sub_100048804(&inputStructCnt[1], inputStructCnt, 1, a4, a5, a6, a7, a8, a3);
  v9 = IOConnectCallMethod(a1, 0x12u, &input, 1u, *&inputStructCnt[1], inputStructCnt[0], 0, 0, 0, 0);
  free(*&inputStructCnt[1]);
  return v9;
}

uint64_t sub_1000478F4(char *path, const char *a2)
{
  connect = 0;
  v3 = IORegistryEntryFromPath(kIOMasterPortDefault, path);
  if (!v3 || (v4 = v3, v5 = IOServiceOpen(v3, mach_task_self_, 0, &connect), IOObjectRelease(v4), v5))
  {
    v6 = IOServiceMatching(a2);
    MatchingService = IOServiceGetMatchingService(kIOMasterPortDefault, v6);
    if (MatchingService)
    {
      v8 = MatchingService;
      IOServiceOpen(MatchingService, mach_task_self_, 0, &connect);
      IOObjectRelease(v8);
    }
  }

  if (connect)
  {
    if (IOConnectCallMethod(connect, 0, 0, 0, 0, 0, 0, 0, 0, 0))
    {
      IOServiceClose(connect);
      connect = 0;
      syslog(3, "failed to open userclient via %s: %d\n");
    }
  }

  else
  {
    syslog(3, "failed to open connection to %s: %d\n");
  }

  return connect;
}

uint64_t sub_100047A3C(mach_port_t a1, uint32_t a2, const uint64_t *a3, uint32_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, void *a9, size_t *a10)
{

  return IOConnectCallMethod(a1, a2, a3, a4, 0, 0, 0, 0, a9, a10);
}

uint64_t sub_100047A68(void *a1)
{

  return memset_s(a1, 0x1000uLL, 0, 0x1000uLL);
}

uint64_t sub_100047AD0(mach_port_t a1, uint32_t a2, const uint64_t *a3, uint32_t a4, const void *a5, size_t a6, uint64_t a7, uint64_t a8, void *a9, size_t *a10)
{

  return IOConnectCallMethod(a1, a2, a3, a4, a5, a6, 0, 0, a9, a10);
}

uint64_t sub_100047C44(uint64_t *a1, void **a2)
{
  v2 = *a1;
  v3 = &a2[3 * **a2];
  ccn_write_uint_padded();
  return 1;
}

uint64_t sub_100047C7C(const void *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (*(a5 + 8) >= *a5)
  {
    v13 = 0;
  }

  else
  {
    v9 = 0;
    v10 = 0;
    while (1)
    {
      v11 = sub_100047D80(*(*(a5 + 24) + v9), *(*(a5 + 24) + v9) + *(*(*(a5 + 24) + v9) + 1) + 2, a1);
      if (v11)
      {
        break;
      }

      ++v10;
      v9 += 40;
      if (v10 >= *a5)
      {
        goto LABEL_10;
      }
    }

    v14 = (*(a5 + 24) + v9);
    if (v14[1])
    {
      v12 = 0;
      *(a5 + 16) = 1;
    }

    else
    {
      ++*(a5 + 8);
      v14[1] = a3;
      v14[2] = a3 + a4;
      v14[3] = a3;
      v14[4] = a3 + a4;
      v12 = 1;
    }

LABEL_10:
    v13 = v12 | !v11;
  }

  return v13 & 1;
}

BOOL sub_100047DEC(const void *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  v8 = sub_100047D80(*a5, *a5 + *(*a5 + 1) + 2, a1);
  if (v8)
  {
    *(a5 + 24) = 1;
    *(a5 + 8) = a3;
    *(a5 + 16) = a3 + a4;
  }

  return !v8;
}

uint64_t sub_100047E54(void **a1)
{
  if (!a1)
  {
    return 0xFFFFFFFFLL;
  }

  while (1)
  {
    v2 = *a1;
    if (!*a1)
    {
      break;
    }

    v3 = *(v2 + 1);
    *a1 = *v2;
    if (v3)
    {
      memset_s(v3, *(v2 + 2), 0, *(v2 + 2));
      free(*(v2 + 1));
    }

    memset_s(v2, 0x18uLL, 0, 0x18uLL);
    free(v2);
  }

  return 0;
}

uint64_t sub_100047ED4(void *a1, unsigned __int8 *a2)
{
  if (!a1)
  {
    return 0xFFFFFFFFLL;
  }

  v2 = a1;
  result = sub_100047F70(a1, a2);
  if (result)
  {
    v4 = result;
    for (i = *v2; i != result; i = *i)
    {
      v2 = i;
    }

    *v2 = *i;
    v6 = *(result + 8);
    if (v6)
    {
      memset_s(v6, *(v4 + 16), 0, *(v4 + 16));
      free(*(v4 + 8));
    }

    memset_s(v4, 0x18uLL, 0, 0x18uLL);
    free(v4);
    return 0;
  }

  return result;
}

void *sub_100047F70(void *a1, unsigned __int8 *a2)
{
  if (!a1)
  {
    return 0;
  }

  v2 = *a1;
  if (*a1)
  {
    v4 = a2 + 2;
    do
    {
      v6 = v2[1];
      if (ccder_blob_decode_sequence_tl() && sub_100047D80(a2, &v4[a2[1]], v6))
      {
        break;
      }

      v2 = *v2;
    }

    while (v2);
  }

  return v2;
}

uint64_t sub_100047FFC(void *a1, unsigned __int8 *a2, int a3, void *a4, void *a5)
{
  v8 = sub_100047F70(a1, a2);
  if (!v8)
  {
    return 0;
  }

  v9 = 1;
  if (a4)
  {
    if (a5)
    {
      v10 = v8[1] + v8[2];
      v15[0] = v8[1];
      v15[1] = v10;
      v9 = ccder_blob_decode_sequence_tl();
      if (v9)
      {
        if (sub_10006BF98(v15, 12, 0, 0))
        {
          v11 = v15[0];
          if (ccder_blob_decode_tag())
          {
            if (ccder_blob_decode_len())
            {
              v13 = 0;
              v12 = v15[0];
              if (a3)
              {
                v13 = (LODWORD(v15[0]) - v11);
                v12 = v11;
              }

              *a4 = v12;
              *a5 = v13;
            }
          }
        }
      }
    }
  }

  return v9;
}

uint64_t sub_1000480DC(void *a1, unsigned __int8 *a2, uint64_t *a3)
{
  v7 = 0;
  v8 = 0;
  v4 = sub_100047FFC(a1, a2, 1, &v7, &v8);
  v5 = v4;
  if (a3 && v4)
  {
    *a3 = sub_10006BCCC();
  }

  return v5;
}

uint64_t sub_10004813C(void *a1, unsigned __int8 *a2, BOOL *a3)
{
  v7 = 0;
  v8 = 0;
  v4 = sub_100047FFC(a1, a2, 1, &v7, &v8);
  v5 = v4;
  if (a3 && v4)
  {
    *a3 = sub_10006BF48();
  }

  return v5;
}

uint64_t sub_10004819C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  if (ccder_blob_decode_tl())
  {
    v8 = 0;
    v9 = 0;
    v7[0] = 12;
    v7[1] = 0;
    __memcpy_chk();
    if (!sub_100047ED4(a5, v7) && !sub_10006C318())
    {
      return 1;
    }
  }

  else
  {
    sub_10006E824();
  }

  sub_10006E88C();
  return 0;
}

uint64_t sub_10004829C(uint64_t a1)
{
  if (a1)
  {
    v1 = *(a1 + 8);
  }

  return ccder_sizeof();
}

uint64_t sub_1000482B4(uint64_t a1)
{
  if (a1)
  {
    v1 = *(a1 + 8);
  }

  v2 = ccder_sizeof();
  return ccder_sizeof() + v2;
}

uint64_t sub_1000482FC(__int128 *a1, int a2, uint64_t a3)
{
  v6 = *a3;
  v5 = *(a3 + 8);
  v9 = *a1;
  if (a2)
  {
    v12 = *a1;
    v10 = 0;
    v11 = 0;
    result = ccder_blob_decode_range();
    if (!result)
    {
      return result;
    }

    v6 = v10;
    v8 = (v11 - v10);
    v9 = v12;
    goto LABEL_4;
  }

  LODWORD(v12) = v5;
  result = sub_10006CCE4(&v9, 4, v6, &v12);
  if (result)
  {
    v8 = v12;
LABEL_4:
    *a3 = v6;
    *(a3 + 8) = v8;
    *a1 = v9;
    return 1;
  }

  return result;
}

uint64_t sub_1000483A8(__int128 *a1)
{
  v4 = *a1;
  v2 = ccder_blob_decode_range();
  if (v2)
  {
    *a1 = v4;
  }

  return v2;
}

uint64_t sub_100048430()
{
  ccder_sizeof_implicit_raw_octet_string();
  ccder_sizeof_implicit_uint64();
  ccder_sizeof_implicit_uint64();
  ccder_sizeof_implicit_uint64();

  return ccder_sizeof();
}

uint64_t sub_100048500(void *a1)
{
  result = 0;
  a1[1] = v3;
  a1[2] = v2;
  *a1 = *v1;
  *v1 = a1;
  return result;
}

uint64_t sub_100048550()
{
  v3 = v1 + *(v0 + 1) - v0;

  return ccder_blob_encode_body();
}

uint64_t sub_1000485C4()
{

  return memset_s(v1, v0, 0, v0);
}

uint64_t sub_1000485E4()
{

  return ccder_blob_encode_tl();
}

uint64_t sub_100048644(uint64_t a1, ...)
{
  va_start(va2, a1);
  va_start(va1, a1);
  va_start(va, a1);
  va_arg(va1, void);
  va_copy(va2, va1);
  va_arg(va2, void);
  v3 = 0;
  v5 = 0;

  return sub_10006C148(va2, va, va1);
}

uint64_t sub_100048664(void *a1)
{

  return memset_s(a1, 0x10uLL, 0, 0x10uLL);
}

uint64_t sub_1000486B4()
{

  return ccder_sizeof();
}

void *sub_1000486D0()
{

  return calloc(0x18uLL, 1uLL);
}

void *sub_1000486E8(size_t a1)
{

  return calloc(a1, 1uLL);
}

uint64_t sub_100048738()
{

  return ccder_blob_decode_range();
}

uint64_t sub_100048758()
{

  return sub_10006BB18();
}

char *sub_10004877C(_DWORD *a1, const void *a2, int a3)
{
  v3 = (a1 + 1);
  if (a2)
  {
    *a1 = a3;
    memcpy(a1 + 1, a2, a3);
    v3 += a3;
    v5 = -a3;
    v6 = -a3 & 3;
    if ((v5 & 3) != 0)
    {
      __s = 0;
      memset_s(&__s, 4uLL, 0, 4uLL);
      memcpy(v3, &__s, v6);
      v3 += v6;
    }
  }

  else
  {
    *a1 = 0;
  }

  return v3;
}

char *sub_100048804(char **a1, unsigned int *a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  v21 = &a9;
  v12 = 4;
  if (a3)
  {
    v13 = a3;
    do
    {
      v14 = v21;
      v21 += 2;
      v12 += *(v14 + 2) + (-*(v14 + 2) & 3) + 4;
      --v13;
    }

    while (v13);
  }

  result = calloc(1uLL, v12);
  v16 = result;
  v22 = &a9;
  v17 = 0;
  if (a3)
  {
    v18 = 4;
    do
    {
      v19 = v22;
      v20 = *v22;
      v22 += 2;
      result = sub_10004877C(&v16[v18], v20, *(v19 + 2));
      v18 = result - v16;
      ++v17;
    }

    while (a3 != v17);
  }

  *v16 = v17;
  *a1 = v16;
  *a2 = v12;
  return result;
}

uint64_t X509PolicySetFlagsForCommonNames(uint64_t a1)
{
  v2 = (a1 + 104);
  v5[0] = 0xAAAAAAAAAAAAAAAALL;
  v5[1] = 0xAAAAAAAAAAAAAAAALL;
  if (v2 > a1 + 120)
  {
    __break(0x5519u);
  }

  result = X509CertificateSubjectNameGetCommonName(v2, v5);
  if (!result)
  {
    result = compare_octet_string(&iPhoneCAName, v5);
    if (result)
    {
      result = compare_octet_string(&CodeSigningCAName, v5);
      if (result)
      {
        result = compare_octet_string_partial(&MFi4AccessoryCAName, v5);
        if (result)
        {
          result = compare_octet_string_partial(&MFi4AttestationCAName, v5);
          if (result)
          {
            result = compare_octet_string_partial(&MFi4ProvisioningCAName, v5);
            if (result)
            {
              return result;
            }

            v4 = 0x1000000000;
          }

          else
          {
            v4 = 0x800000000;
          }
        }

        else
        {
          v4 = 0x400000000;
        }
      }

      else
      {
        v4 = 0x800000000008;
      }
    }

    else
    {
      v4 = 3840;
    }

    *(a1 + 240) |= v4;
  }

  return result;
}

double X509PolicySetFlagsForMFI(uint64_t a1)
{
  v2 = (a1 + 104);
  v7[0] = 0xAAAAAAAAAAAAAAAALL;
  v7[1] = 0xAAAAAAAAAAAAAAAALL;
  if (v2 > a1 + 120)
  {
    __break(0x5519u);
  }

  if (!X509CertificateSubjectNameGetCommonName(v2, v7))
  {
    if (compare_octet_string_partial(&MFICommonNamePrefix, v7))
    {
      goto LABEL_4;
    }

    v6 = 0;
    if (!X509CertificateGetNotBefore(a1, &v6))
    {
      memset(&v5, 0, sizeof(v5));
      strptime("2006-05-31", "%F", &v5);
      v4 = timegm(&v5);
      result = difftime(v4, v6);
      if (result < 0.0)
      {
        *(a1 + 240) |= 0x8000000uLL;
LABEL_4:
        if (!compare_octet_string_partial(&MFi4ProvisioningHostNamePrefix, v7))
        {
          *(a1 + 240) |= 0x1000000000uLL;
        }
      }
    }
  }

  return result;
}

uint64_t X509PolicySetFlagsForRoots(uint64_t result, uint64_t a2)
{
  if (!result)
  {
    return result;
  }

  v3 = result;
  if (*(result + 16) == 1)
  {
    v4 = numAppleProdRoots;
    if (numAppleProdRoots)
    {
      if (a2 + 88 <= (a2 + 104))
      {
        v5 = AppleRootSPKIs;
        while (1)
        {
          v6 = v5 + 1;
          v7 = v5 < AppleRootSPKIs || v6 > dword_1000A4078;
          if (v7 || v5 >= v6)
          {
            break;
          }

          result = compare_octet_string(a2 + 88, *v5);
          if (!result)
          {
            *(a2 + 240) |= 0xD8E30653FFF8uLL;
            goto LABEL_17;
          }

          ++v5;
          if (!--v4)
          {
            goto LABEL_17;
          }
        }
      }

      goto LABEL_50;
    }
  }

LABEL_17:
  v9 = *(v3 + 8);
  if ((v9 & 0x1000000) != 0)
  {
    result = a2 + 88;
    if (a2 + 88 > (a2 + 104))
    {
      goto LABEL_50;
    }

    result = compare_octet_string(result, &UcrtRootSPKI);
    if (!result)
    {
      v10 = *(a2 + 240) | 0x1000000;
      goto LABEL_27;
    }
  }

  else
  {
    if ((v9 & 0x1C00000000) == 0)
    {
      goto LABEL_28;
    }

    result = a2 + 88;
    if (a2 + 88 > (a2 + 104))
    {
      goto LABEL_50;
    }

    result = compare_octet_string(result, &MFi4RootSPKI);
    if (!result)
    {
      v10 = *(a2 + 240) | 0x1C00000000;
LABEL_27:
      *(a2 + 240) = v10;
      goto LABEL_28;
    }
  }

  if (*(v3 + 17) == 1)
  {
    result = sub_100048D48(v3, a2);
  }

LABEL_28:
  if (*(v3 + 16) == 1 && *(v3 + 17) == 1 && numAppleProdRoots < numAppleRoots)
  {
    if (a2 + 88 <= (a2 + 104))
    {
      v11 = &AppleRootSPKIs[numAppleProdRoots];
      v12 = numAppleRoots - numAppleProdRoots;
      while (1)
      {
        v13 = v11 + 1;
        v14 = v11 < AppleRootSPKIs || v13 > dword_1000A4078;
        if (v14 || v11 >= v13)
        {
          break;
        }

        result = compare_octet_string(a2 + 88, *v11);
        if (!result)
        {
          *(a2 + 240) |= 0xD8E30653FFF8uLL;
          goto LABEL_44;
        }

        ++v11;
        if (!--v12)
        {
          goto LABEL_44;
        }
      }
    }

    goto LABEL_50;
  }

LABEL_44:
  if (*(v3 + 16) == 1 && *(v3 + 17) == 1)
  {
    result = a2 + 88;
    if (a2 + 88 <= (a2 + 104))
    {
      result = compare_octet_string(result, &TestAppleRootECCSPKI);
      if (!result)
      {
        *(a2 + 240) |= 0x6400000uLL;
      }

      return result;
    }

LABEL_50:
    __break(0x5519u);
  }

  return result;
}

uint64_t sub_100048D48(void *a1, uint64_t a2)
{
  v6[0] = 0;
  v6[1] = 0;
  v5[0] = 0;
  v5[1] = 0;
  if (a2 + 88 > (a2 + 104))
  {
    __break(0x5519u);
  }

  result = X509CertificateParseSPKI((a2 + 88), v6, 0, v5);
  if (!result)
  {
    result = compare_octet_string(a1[4], v6);
    if (!result)
    {
      result = compare_octet_string(a1[3], v5);
      if (!result)
      {
        *(a2 + 240) |= a1[1];
      }
    }
  }

  return result;
}

unint64_t X509PolicyCheckForBlockedKeys(uint64_t a1)
{
  result = a1 + 88;
  if (result > a1 + 104)
  {
    __break(0x5519u);
  }

  else
  {
    result = compare_octet_string(result, &BlockedYonkersSPKI);
    if (!result)
    {
      *(a1 + 240) &= 0xFFFFFFFFFFF3FFFFLL;
    }
  }

  return result;
}

int *find_digest(uint64_t a1)
{
  v2 = 0;
  while (1)
  {
    result = &dword_1000A4078[v2 / 4 + 2];
    if (result > &dword_1000A4078[v2 / 4 + 6])
    {
      __break(0x5519u);
      goto LABEL_9;
    }

    result = compare_octet_string_raw(result, *a1, *(a1 + 8));
    if (!result)
    {
      break;
    }

    v2 += 32;
    if (v2 == 160)
    {
      return 0;
    }
  }

  if (v2 <= ~dword_1000A4078)
  {
    return &dword_1000A4078[v2 / 4];
  }

LABEL_9:
  __break(0x5513u);
  return result;
}

int *find_digest_by_type(int *result)
{
  v1 = 0;
  while (dword_1000A4078[v1 / 4] != result)
  {
    v1 += 32;
    if (v1 == 160)
    {
      return 0;
    }
  }

  if (v1 <= ~dword_1000A4078)
  {
    return &dword_1000A4078[v1 / 4];
  }

  __break(0x5513u);
  return result;
}

uint64_t find_digestOID_for_signingOID(uint64_t a1, void *a2)
{
  if (!compare_octet_string_raw(a1, &sha1WithRSA_oid, 9uLL) || !compare_octet_string_raw(a1, &sha1WithECDSA_oid, 7uLL))
  {
    v6 = &CTOidSha1;
    v4 = 5;
    goto LABEL_11;
  }

  v4 = 9;
  if (!compare_octet_string_raw(a1, &sha256WithRSA_oid, 9uLL))
  {
    v6 = &CTOidSha256;
    goto LABEL_11;
  }

  if (!compare_octet_string_raw(a1, &sha256WithECDSA_oid, 8uLL))
  {
    v6 = &CTOidSha256;
LABEL_18:
    v4 = 9;
    goto LABEL_11;
  }

  v4 = 9;
  if (!compare_octet_string_raw(a1, &sha384WithRSA_oid, 9uLL))
  {
    v6 = &CTOidSha384;
    goto LABEL_11;
  }

  if (!compare_octet_string_raw(a1, &sha384WithECDSA_oid, 8uLL))
  {
    v6 = &CTOidSha384;
    goto LABEL_18;
  }

  v4 = 9;
  if (compare_octet_string_raw(a1, &sha512WithRSA_oid, 9uLL))
  {
    if (compare_octet_string_raw(a1, &sha512WithECDSA_oid, 8uLL))
    {
      return 0;
    }

    v6 = &CTOidSha512;
    goto LABEL_18;
  }

  v6 = &CTOidSha512;
LABEL_11:
  *a2 = v6;
  a2[1] = v4;
  return 1;
}

unint64_t validateSignatureRSA(unint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  v5 = 0;
  v26 = 0;
  if (!result)
  {
    return v5 & 1;
  }

  if (!a2)
  {
    return v5 & 1;
  }

  v5 = 0;
  if (!a3 || !a4 || !a5)
  {
    return v5 & 1;
  }

  if (a5 + 7 > a5 + 9)
  {
    goto LABEL_34;
  }

  v8 = result;
  result = compare_octet_string(&rsaEncryption, (a5 + 7));
  if (result)
  {
    result = sub_1000492F0(&off_1000A4168, (a5 + 3), (a5 + 7));
    if (!result)
    {
      goto LABEL_23;
    }
  }

  v24 = 0xAAAAAAAAAAAAAAAALL;
  v25 = 0xAAAAAAAAAAAAAAAALL;
  v10 = a5[9];
  v9 = a5[10];
  if (__CFADD__(v10, v9))
  {
    goto LABEL_35;
  }

  if (v10 > v10 + v9)
  {
    goto LABEL_34;
  }

  v24 = a5[9];
  v25 = v10 + v9;
  if (v9)
  {
    result = ccder_blob_check_null();
    if (!result)
    {
      goto LABEL_23;
    }
  }

  if (__CFADD__(v8, a2))
  {
    goto LABEL_35;
  }

  if (v8 + a2 < v8)
  {
    goto LABEL_34;
  }

  result = ccder_decode_rsa_pub_n();
  if (!result)
  {
LABEL_23:
    v5 = 0;
    return v5 & 1;
  }

  v11 = result;
  if (!(result >> 58))
  {
    v12 = result << 6;
    if (result << 6 >= 0x400)
    {
      v28 = 0xAAAAAAAAAAAAAAAALL;
      v29 = -21846;
      v27 = 6;
      if (&vars0 == 82)
      {
        goto LABEL_35;
      }

      v13 = a5[4];
      LOBYTE(v28) = v13;
      if (&v27 > 0xFFFFFFFFFFFFFFFDLL)
      {
        goto LABEL_35;
      }

      if (v13 < 0xA)
      {
        v14 = a5[3];
        result = __memcpy_chk();
        if (result <= result + v13)
        {
          if (v12 > 0x1068)
          {
            goto LABEL_23;
          }

          result = __chkstk_darwin();
          v17 = (&v23 - 4 * v16);
          v18 = 0;
          *&v19 = 0xAAAAAAAAAAAAAAAALL;
          *(&v19 + 1) = 0xAAAAAAAAAAAAAAAALL;
          do
          {
            v20 = &v17[v18 / 8];
            *v20 = v19;
            *(v20 + 1) = v19;
            v18 += 32;
          }

          while ((v15 & 0x7FFFFFFFFFFFFFE0) != v18);
          if (v17 + 4 <= &v23 && v17 <= v17 + 4)
          {
            *v17 = v11;
            if (ccrsa_import_pub())
            {
              v5 = 0;
            }

            else
            {
              v22 = a5[11];
              v21 = a5[12];
              if (ccrsa_verify_pkcs1v15_allowshortsigs())
              {
                v5 = 0;
                v26 = 0;
              }

              else
              {
                v5 = v26;
              }
            }

            return v5 & 1;
          }
        }
      }

LABEL_34:
      __break(0x5519u);
LABEL_35:
      __break(0x5513u);
      goto LABEL_36;
    }

    goto LABEL_23;
  }

LABEL_36:
  __break(0x550Cu);
  return result;
}

uint64_t sub_1000492F0(uint64_t result, uint64_t a2, uint64_t a3)
{
  v5 = result;
  v6 = 0;
  v7 = 1;
  while (v5 < v5 + 16)
  {
    result = compare_octet_string(v5, a2);
    if (result)
    {
      goto LABEL_11;
    }

    if (v5 + 16 > v5 + 32)
    {
      break;
    }

    result = compare_octet_string(v5 + 16, a3);
    if (result)
    {
LABEL_11:
      v7 = v6 < 3;
      v5 += 32;
      if (++v6 != 4)
      {
        continue;
      }
    }

    return v7;
  }

  __break(0x5519u);
  return result;
}

_UNKNOWN **oidForPubKeyLength()
{
  v0 = ccec_x963_import_pub_size();
  is_supported = ccec_keysize_is_supported();
  v2 = &CTOidSECP256r1;
  v3 = &CTOidSECP521r1;
  v4 = &CTOidSECP384r1;
  if (v0 != 384)
  {
    v4 = 0;
  }

  if (v0 != 521)
  {
    v3 = v4;
  }

  if (v0 != 256)
  {
    v2 = v3;
  }

  if (is_supported)
  {
    return v2;
  }

  else
  {
    return 0;
  }
}

uint64_t *validateSignatureEC(uint64_t *result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  v5 = 0;
  v20 = 0;
  if (!result)
  {
    return (v5 & 1);
  }

  if (!a2)
  {
    return (v5 & 1);
  }

  v5 = 0;
  if (!a3 || !a4 || !a5)
  {
    return (v5 & 1);
  }

  v7 = a5 + 72;
  if (a5 + 56 > (a5 + 72))
  {
    goto LABEL_32;
  }

  result = compare_octet_string(&ecPublicKey, a5 + 56);
  if (result)
  {
    result = sub_1000492F0(&off_1000A41E8, a5 + 24, a5 + 56);
    if (!result)
    {
      goto LABEL_27;
    }
  }

  if (v7 > a5 + 88)
  {
    goto LABEL_32;
  }

  result = sub_100049630((a5 + 72));
  if (!result)
  {
LABEL_27:
    v5 = 0;
    return (v5 & 1);
  }

  if (result >= result + 4)
  {
    goto LABEL_32;
  }

  v8 = *result;
  if (*result >> 61 || !is_mul_ok(8 * v8, 3uLL))
  {
    goto LABEL_33;
  }

  v9 = 24 * v8;
  v10 = __CFADD__(v9, 16);
  v11 = v9 + 16;
  if (v10 || v11 >= 0xFFFFFFFFFFFFFFF0)
  {
    goto LABEL_34;
  }

  result = __chkstk_darwin();
  v14 = &v19[-16 * v13];
  v15 = 0;
  do
  {
    v16 = &v14[v15 / 8];
    *v16 = 0xAAAAAAAAAAAAAAAALL;
    v16[1] = 0xAAAAAAAAAAAAAAAALL;
    v15 += 16;
  }

  while ((v12 & 0xFFFFFFFFFFFFFFF0) != v15);
  if (v12 < 0x10)
  {
    goto LABEL_35;
  }

  *v14 = result;
  if (v14 + 2 > v19 || v14 > v14 + 2)
  {
LABEL_32:
    __break(0x5519u);
LABEL_33:
    __break(0x550Cu);
LABEL_34:
    __break(0x5500u);
LABEL_35:
    __break(1u);
    goto LABEL_36;
  }

  if (ccec_import_pub())
  {
    goto LABEL_30;
  }

  result = ccec_x963_import_pub_size();
  if (result != 256 || *(a5 + 96) != 64)
  {
    v18 = *(a5 + 88);
    if (ccec_verify())
    {
LABEL_29:
      v20 = 0;
    }

LABEL_30:
    v5 = v20;
    return (v5 & 1);
  }

  if (*(a5 + 88) < 0xFFFFFFFFFFFFFFE0)
  {
    v17 = *(a5 + 88);
    if (!ccec_verify_composite())
    {
      goto LABEL_30;
    }

    goto LABEL_29;
  }

LABEL_36:
  __break(0x5513u);
  return result;
}

uint64_t sub_100049630(int **a1)
{
  if (!a1)
  {
    return 0;
  }

  v1 = a1[1];
  if (v1 != 7)
  {
    if (v1 == 10 && **a1 == 0x33DCE48862A0806 && *(*a1 + 4) == 1793)
    {
      return ccec_cp_256();
    }

    return 0;
  }

  v4 = *a1;
  if (**a1 == -2127887098 && *(*a1 + 3) == 570426497)
  {
    return ccec_cp_384();
  }

  v6 = *v4;
  v7 = *(v4 + 3);
  if (v6 != -2127887098 || v7 != 587203713)
  {
    return 0;
  }

  return _ccec_cp_521();
}

uint64_t compressECPublicKey(uint64_t *a1, int **a2, uint64_t a3, uint64_t a4)
{
  v7 = sub_100049630(a2);
  if (!v7)
  {
    return 655366;
  }

  v8 = v7;
  if (v7 >= v7 + 4)
  {
    goto LABEL_20;
  }

  v9 = *v7;
  if (*v7 >> 61 || !is_mul_ok(8 * v9, 3uLL))
  {
    goto LABEL_21;
  }

  v10 = 24 * v9;
  v11 = __CFADD__(v10, 16);
  v12 = v10 + 16;
  if (v11 || v12 >= 0xFFFFFFFFFFFFFFF0)
  {
LABEL_22:
    __break(0x5500u);
  }

  result = __chkstk_darwin();
  v16 = &v21 - 2 * v15;
  v17 = 0;
  do
  {
    v18 = &v16[v17 / 8];
    *v18 = 0xAAAAAAAAAAAAAAAALL;
    v18[1] = 0xAAAAAAAAAAAAAAAALL;
    v17 += 16;
  }

  while ((v14 & 0xFFFFFFFFFFFFFFF0) != v17);
  if (v14 < 0x10)
  {
    __break(1u);
    return result;
  }

  *v16 = v8;
  if (v16 + 2 > &v21 || v16 > v16 + 2)
  {
LABEL_20:
    __break(0x5519u);
LABEL_21:
    __break(0x550Cu);
    goto LABEL_22;
  }

  v20 = *a1;
  v19 = a1[1];
  result = ccec_import_pub();
  if (!result)
  {
    if (ccec_compressed_x962_export_pub_size() == a4)
    {
      if (!a3 || a4)
      {
        return ccec_compressed_x962_export_pub();
      }

      goto LABEL_20;
    }

    return 393220;
  }

  return result;
}

uint64_t decompressECPublicKey(uint64_t *a1, int **a2, uint64_t a3, uint64_t a4)
{
  v7 = sub_100049630(a2);
  if (!v7)
  {
    return 655366;
  }

  if (v7 >= v7 + 4)
  {
LABEL_23:
    __break(0x5519u);
    goto LABEL_24;
  }

  v8 = *v7;
  if (*v7 >> 61 || !is_mul_ok(8 * v8, 3uLL))
  {
LABEL_25:
    __break(0x550Cu);
  }

  v9 = 24 * v8;
  v10 = __CFADD__(v9, 16);
  v11 = v9 + 16;
  if (v10 || v11 >= 0xFFFFFFFFFFFFFFF0)
  {
    goto LABEL_24;
  }

  result = __chkstk_darwin();
  v15 = &v23 - 2 * v14;
  v16 = 0;
  do
  {
    v17 = &v15[v16 / 8];
    *v17 = 0xAAAAAAAAAAAAAAAALL;
    v17[1] = 0xAAAAAAAAAAAAAAAALL;
    v16 += 16;
  }

  while ((v13 & 0xFFFFFFFFFFFFFFF0) != v16);
  if (v13 >= 0x10)
  {
    *v15 = result;
    if (v15 + 2 <= &v23 && v15 <= v15 + 2)
    {
      v19 = *a1;
      v18 = a1[1];
      v20 = ccec_compressed_x962_import_pub();
      if (!v20)
      {
        v21 = *v15;
        v22 = cczp_bitlen();
        if (v22 < 0xFFFFFFFFFFFFFFF9)
        {
          if (!a3 || a4)
          {
            if ((((v22 + 7) >> 2) | 1) == a4)
            {
              v20 = 0;
            }

            else
            {
              v20 = 393220;
            }

            ccec_export_pub();
            return v20;
          }

          goto LABEL_23;
        }

LABEL_24:
        __break(0x5500u);
        goto LABEL_25;
      }

      return v20;
    }

    goto LABEL_23;
  }

  __break(1u);
  return result;
}

uint64_t CMSParseContentInfoSignedDataWithOptions(char *a1, uint64_t a2, unint64_t *a3, char a4)
{
  v27 = 0xAAAAAAAAAAAAAAAALL;
  v28 = 0xAAAAAAAAAAAAAAAALL;
  if (__CFADD__(a1, a2))
  {
    goto LABEL_110;
  }

  if (&a1[a2] < a1)
  {
    goto LABEL_108;
  }

  v4 = 65537;
  v27 = a1;
  v28 = &a1[a2];
  v26 = 0;
  v25 = 0xAAAAAAAAAAAAAAAALL;
  v7 = sub_10004A0A8(&v27, 0x2000000000000010, &v26 + 1, &v25);
  result = 65537;
  if (v7)
  {
    v23 = 0xAAAAAAAAAAAAAAAALL;
    v24 = 0xAAAAAAAAAAAAAAAALL;
    if (__CFADD__(v27, v25))
    {
      goto LABEL_110;
    }

    if (v27 > &v27[v25] || &v27[v25] > v28)
    {
      goto LABEL_108;
    }

    v23 = v27;
    v24 = &v27[v25];
    if (ccder_blob_decode_tl())
    {
      if (v24 < v23 || v25 > v24 - v23)
      {
        goto LABEL_108;
      }

      if (compare_octet_string_raw(&off_1000A4268, v23, v25))
      {
        return 65539;
      }

      if (__CFADD__(v23, v25))
      {
        goto LABEL_110;
      }

      if (v23 > &v23[v25] || &v23[v25] > v24)
      {
        goto LABEL_108;
      }

      v23 += v25;
      if (!sub_10004A0A8(&v23, 0xA000000000000000, &v26, &v25))
      {
        return 65540;
      }

      v21 = 0xAAAAAAAAAAAAAAAALL;
      v22 = 0xAAAAAAAAAAAAAAAALL;
      if (__CFADD__(v23, v25))
      {
        goto LABEL_110;
      }

      if (v23 > &v23[v25] || &v23[v25] > v24)
      {
        goto LABEL_108;
      }

      v21 = v23;
      v22 = &v23[v25];
      v30 = 0;
      memset(v29, 170, sizeof(v29));
      if ((sub_10004A0A8(&v21, 0x2000000000000010, &v30 + 1, v29) & 1) == 0)
      {
        return 131073;
      }

      if (__CFADD__(v21, v29[0]))
      {
        goto LABEL_110;
      }

      v9 = 131080;
      if (&v21[v29[0]] != v22)
      {
        return 131082;
      }

      if (!ccder_blob_decode_uint64())
      {
        return 131074;
      }

      v10 = a3[11];
      result = 131092;
      if (v10 <= 4 && ((1 << v10) & 0x1A) != 0)
      {
        if (!sub_10004BD60(&v21, 0x2000000000000011, 0, 125))
        {
          return 131075;
        }

        v34 = 0;
        v33 = 0;
        if ((sub_10004A0A8(&v21, 0x2000000000000010, &v34, &v33) & 1) == 0)
        {
          return 131076;
        }

        v31 = 0xAAAAAAAAAAAAAAAALL;
        v32 = 0xAAAAAAAAAAAAAAAALL;
        if (__CFADD__(v21, v33))
        {
          goto LABEL_110;
        }

        if (v21 > &v21[v33] || &v21[v33] > v22)
        {
          goto LABEL_108;
        }

        v31 = v21;
        v32 = &v21[v33];
        if (!ccder_blob_decode_tl())
        {
          return 131077;
        }

        if (v32 < v31 || v33 > v32 - v31)
        {
          goto LABEL_108;
        }

        if (compare_octet_string_raw(&off_1000A4278, v31, v33))
        {
          return 131078;
        }

        if (__CFADD__(v31, v33))
        {
          goto LABEL_110;
        }

        v11 = &v31[v33];
        if (v31 > &v31[v33] || v11 > v32)
        {
          goto LABEL_108;
        }

        v31 += v33;
        v12 = v34;
        if (v11 != v32 || (v34 & 1) != 0)
        {
          v39 = 0;
          v37 = v32;
          v38 = 0;
          v36 = v11;
          if (sub_10004A0A8(&v36, 0xA000000000000000, &v39, &v38))
          {
            if ((v12 & 1) == 0)
            {
              if (__CFADD__(v36, v38))
              {
                goto LABEL_110;
              }

              if (&v36[v38] != v32)
              {
                return v9;
              }
            }

            if (v36 > v37)
            {
              goto LABEL_108;
            }

            v31 = v36;
            v32 = v37;
            v35 = 0;
            v15 = v39;
            if (v39 == 1 && !sub_10004A0A8(&v31, 0x2000000000000004, &v35, &v38))
            {
              return 131079;
            }

            v40 = 0;
            if (!ccder_blob_decode_tl())
            {
              return 131090;
            }

            v16 = v31;
            v17 = v32;
            if (v32 < v31)
            {
              goto LABEL_108;
            }

            v18 = v40;
            if (v40 > v32 - v31)
            {
              goto LABEL_108;
            }

            a3[9] = v31;
            a3[10] = v18;
            if (__CFADD__(v16, v18))
            {
LABEL_110:
              __break(0x5513u);
              return 0;
            }

            v19 = &v16[v18];
            if (v19 > v17 || v16 > v19)
            {
              goto LABEL_108;
            }

            v31 = v19;
            if ((sub_10004A148(&v31, v35) & 1) == 0)
            {
              return 131089;
            }
          }

          else
          {
            if (!v12)
            {
              return v9;
            }

            v15 = v39;
          }

          if ((sub_10004A148(&v31, v15 & 1) & 1) == 0)
          {
            return 131088;
          }

          v11 = v31;
        }

        if (v11 > v22 || v21 > v11)
        {
          goto LABEL_108;
        }

        v21 = v11;
        if ((sub_10004A148(&v21, v12) & 1) == 0)
        {
          return 131081;
        }

        v36 = 0xAAAAAAAAAAAAAAAALL;
        v37 = 0xAAAAAAAAAAAAAAAALL;
        if (v21 > v22)
        {
          goto LABEL_108;
        }

        v36 = v21;
        v37 = v22;
        if ((sub_10004A0A8(&v36, 0xA000000000000000, &v30, v29) & 1) == 0)
        {
          v13 = v21;
          v14 = v22;
          goto LABEL_85;
        }

        v31 = 0xAAAAAAAAAAAAAAAALL;
        v32 = 0xAAAAAAAAAAAAAAAALL;
        if (!__CFADD__(v36, v29[0]))
        {
          if (v36 > &v36[v29[0]] || &v36[v29[0]] > v37)
          {
            goto LABEL_108;
          }

          v31 = v36;
          v32 = &v36[v29[0]];
          if (!sub_10004BA90(&v31, a3[1], *a3, a3 + 3, a3 + 2))
          {
            return 131085;
          }

          if (!sub_10004A148(&v31, v30))
          {
            return 131086;
          }

          v13 = v31;
          if (v31 >= v36 != v31 - v36 < 0)
          {
            if (v36 > v31)
            {
              goto LABEL_108;
            }

            v14 = v37;
            if (v31 > v37)
            {
              goto LABEL_108;
            }

            v21 = v31;
            v22 = v37;
LABEL_85:
            if (v13 <= v14)
            {
              v36 = v13;
              v37 = v14;
              if (sub_10004BD60(&v36, 0xA000000000000001, 0, 125))
              {
                if (v36 > v37)
                {
                  goto LABEL_108;
                }

                v21 = v36;
                v22 = v37;
              }

              if (!sub_10004BD60(&v21, 0x2000000000000011, &v29[1], 125))
              {
                return 131083;
              }

              if (v29[2] >= v29[1])
              {
                v20 = &v21[-v29[1]];
                if (&v21[-v29[1]] <= v29[2] - v29[1])
                {
                  a3[5] = v29[1];
                  a3[6] = v20;
                  if ((sub_10004A148(&v21, HIBYTE(v30)) & 1) == 0)
                  {
                    return 131084;
                  }

                  if (!sub_10004A148(&v21, v26))
                  {
                    return 65541;
                  }

                  if (v21 <= v24 && v23 <= v21)
                  {
                    v23 = v21;
                    if (sub_10004A148(&v23, HIBYTE(v26)))
                    {
                      if ((a4 & 1) == 0 && v23 != v28)
                      {
                        return 65543;
                      }

                      return 0;
                    }

                    return (v4 + 5);
                  }
                }
              }
            }

LABEL_108:
            __break(0x5519u);
            return (v4 + 5);
          }
        }

        goto LABEL_110;
      }
    }

    else
    {
      return 65538;
    }
  }

  return result;
}