@interface MADAutoAssetControlManager
+ (BOOL)assetBeingGarbageCollected:(id)a3 atEmergencyUrgency:(BOOL)a4;
+ (BOOL)assetSetToBeIncluded:(id)a3 consideredClientDomain:(id)a4 basedOnControl:(id)a5;
+ (BOOL)autoSetJobAvailableAtomicInstanceForSetDescriptor:(id)a3;
+ (BOOL)descriptorToBeIncluded:(id)a3 basedOnControl:(id)a4;
+ (BOOL)isMessageNameForSetMessage:(id)a3;
+ (BOOL)jobDescriptorOnFilesystemConfirmed:(id)a3;
+ (BOOL)persistSetJobDescriptor:(id)a3 withCurrentSetStatus:(id)a4 withFirstClientName:(id)a5 fromLocation:(id)a6;
+ (BOOL)preferenceAlwaysPromoteStagedAssets;
+ (BOOL)preferenceAsIfBackgroundOrUse:(BOOL)a3;
+ (BOOL)preferenceAsIfRampOrUse:(BOOL)a3;
+ (BOOL)preferenceAutoAssetLogSetCompare;
+ (BOOL)preferenceAutoAssetNoPersistedOverflowLimit;
+ (BOOL)preferenceAutoAssetObserverIgnoreNetworkStatus;
+ (BOOL)preferenceForceStartupHealthReport;
+ (BOOL)preferencePerformanceLoggingEnabled;
+ (BOOL)preferencePersistedTableLoggingEnabled;
+ (BOOL)preferenceScheduledAlwaysNonDiscretionary;
+ (BOOL)preferenceScheduledAsIfNotInternal;
+ (BOOL)preferenceScheduledBackupTriggersDisabled;
+ (BOOL)preferenceSecureSimulateFailureAll;
+ (BOOL)preferenceSecureSimulateGraftFailure;
+ (BOOL)preferenceSecureSimulateRequireAll;
+ (BOOL)preferenceStagerDetermineLastRequiredTimesOut;
+ (BOOL)preferenceStagerDownloadFirstNotInCatalog;
+ (BOOL)preferenceStagerInjectAvailableDups;
+ (BOOL)preferenceStagerInjectAvailableOlderVersions;
+ (BOOL)preferenceStagingLookupFlipRequiredOptional;
+ (BOOL)preferenceStartupSimulateFirstBoot;
+ (BOOL)selectorToBeIncluded:(id)a3 basedOnControl:(id)a4;
+ (id)_getAutoControlManagerStateTable;
+ (id)allocIntervalString:(int64_t)a3;
+ (id)assetTypeForClientDomainName:(id)a3 forSetIdentifier:(id)a4 alreadyOnStateQueue:(BOOL)a5;
+ (id)autoControlManager;
+ (id)buildDirectivesSummary;
+ (id)createSeverMessageWithName:(id)a3 sender:(id)a4 clientID:(id)a5 response:(id)a6 error:(id)a7;
+ (id)fileManagerFailureErrorString;
+ (id)getHealthReportForSets:(id)a3;
+ (id)loadDescriptorsForJobSelector:(id)a3 promotingIfCurrentlyStaged:(id)a4 immediatelyPromotedDescriptor:(id *)a5;
+ (id)localAssetURLForAtomicEntry:(id)a3;
+ (id)localAssetURLForDescriptor:(id)a3 fromLocation:(id)a4;
+ (id)newAtomicInstancesDownloadedForSetIdentifier:(id)a3;
+ (id)newSummaryForRequestMessage:(id)a3 includingSelector:(BOOL)a4;
+ (id)newSummaryForSetRequestMessage:(id)a3 includingSetAtomicInstance:(BOOL)a4;
+ (id)newestDownloadedForSetDescriptor:(id)a3;
+ (id)preferenceActivityAggressiveAssetType;
+ (id)preferenceActivityHeightenedAssetType;
+ (id)preferenceAsIfBootedOSIsBuildVersion;
+ (id)preferenceAsIfBootedOSIsOSVersion;
+ (id)preferenceConnectorBackoffRetryTimes;
+ (id)preferenceHealthReportAdditionalSetNames;
+ (id)preferenceScheduledOnlyForAssetTypes;
+ (id)preferenceSessionIDBase;
+ (id)replyMessageNameForRequest:(id)a3;
+ (id)restoreVersionFromOSVersion:(id)a3;
+ (id)selectDispatchQueue:(id)a3;
+ (id)stagerSetPolicy;
+ (int64_t)preferenceActivityAggressiveIntervalSecs;
+ (int64_t)preferenceActivityHeightenedIntervalSecs;
+ (int64_t)preferenceActivityIntervalSecs;
+ (int64_t)preferenceActivityTickerSecs;
+ (int64_t)preferenceBeforeFirstDefaultTimeoutSecs;
+ (int64_t)preferenceBeforeFirstPollSecs;
+ (int64_t)preferenceConnectorInitialWaitSecs;
+ (int64_t)preferenceConnectorWaitBeforeRetrySecs;
+ (int64_t)preferenceLookupCacheAssetSelectorValidSecs;
+ (int64_t)preferenceLookupCacheSetConfigurationValidSecs;
+ (int64_t)preferenceMaxStagerDeterminingSecs;
+ (int64_t)preferenceMaxStagerFilesystemMegabytes;
+ (int64_t)preferencePushActivityIntervalSecs;
+ (int64_t)preferenceSimulatedDownloadFailureResult;
+ (int64_t)preferenceSimulatedStagingLookupFailureResult;
+ (int64_t)preferenceStagerDeterminePallasResponseFewer;
+ (int64_t)previousOTASituation;
+ (void)analyticsReportSecureOperationResults:(id)a3 clientName:(id)a4 secureReason:(id)a5 operation:(int64_t)a6 fromLocation:(id)a7 mountError:(id)a8 graftError:(id)a9 personalizeError:(id)a10 mapToExclaveError:(id)a11;
+ (void)assetConfigJobFinished:(id)a3 withDownloadInfo:(id)a4 error:(id)a5;
+ (void)assetDownloadJob:(id)a3 progressReport:(id)a4;
+ (void)assetDownloadJobFinished:(id)a3 error:(id)a4;
+ (void)autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger:(id)a3;
+ (void)autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger:(id)a3;
+ (void)autoAssetJobFinished:(id)a3 withAutoAssetUUID:(id)a4 schedulerInvolved:(BOOL)a5 potentialNetworkFailure:(BOOL)a6;
+ (void)autoAssetJobIssueProgress:(id)a3 forAutoAssetSelector:(id)a4 withAutoAssetUUID:(id)a5 withJobInformation:(id)a6 withResponseError:(id)a7;
+ (void)autoAssetJobIssueReply:(id)a3 forAutoAssetSelector:(id)a4 withAutoAssetUUID:(id)a5 fromAutoAssetJob:(id)a6 withOriginalSelector:(id)a7 withJobInformation:(id)a8 withResponseError:(id)a9;
+ (void)autoAssetJobObtainLookupGrant:(id)a3 forAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5;
+ (void)autoAssetJobReadyToDownload:(id)a3 withAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5 withOriginalSelector:(id)a6 downloadingDescriptor:(id)a7 baseForPatchDescriptor:(id)a8;
+ (void)autoAssetJobReleaseLookupGrant:(id)a3 forAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5;
+ (void)autoAssetJobSetLookupResponseReceived:(id)a3 forAssignedSetDescriptor:(id)a4 withCatalogLookupResponse:(id)a5;
+ (void)autoAssetStagerJobDownloadDone:(id)a3 withDownloadedDescriptor:(id)a4 withDownloadError:(id)a5;
+ (void)autoAssetStagerSetJobDetermineDone:(id)a3 withBaseForStagingDescriptors:(id)a4 withDetermineError:(id)a5;
+ (void)autoJobAssetSetIDsForJob:(id)a3 mostRecentlyReceived:(id *)a4 latestToVend:(id *)a5;
+ (void)autoSetJobFinished:(id)a3 forAssetSetIdentifier:(id)a4 withAutoAssetUUID:(id)a5 fromAutoAssetJob:(id)a6 withSetJobInformation:(id)a7 schedulerInvolved:(BOOL)a8 potentialNetworkFailure:(BOOL)a9;
+ (void)autoSetJobIssueProgress:(id)a3 forAssetSetIdentifier:(id)a4 withAutoAssetUUID:(id)a5 withSetJobInformation:(id)a6 withResponseError:(id)a7;
+ (void)autoSetJobIssueReply:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9;
+ (void)autoSetJobSchedulerNoClientDownloaded:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9;
+ (void)autoSetJobSchedulerNoClientFoundSame:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9;
+ (void)catalogDownloadJobFinished:(id)a3 withCatalog:(id)a4 error:(id)a5;
+ (void)considerPerfomingCrosscheckTrim;
+ (void)copyCurrentDownloadedDescriptors:(BOOL)a3 unlockedUnreferencedDescriptors:(id *)a4 unlockedReferencedDescriptors:(id *)a5 lockedOverridableDescriptors:(id *)a6 lockedNeverRemoveDescriptors:(id *)a7 stagedDescriptors:(id *)a8;
+ (void)daemonProcessStartupBegun;
+ (void)downloadManagerStateSyncDetermined:(id)a3;
+ (void)downloadManagerStateSyncSkipped;
+ (void)garbageCollectionOperationComplete:(BOOL)a3 originalUnlockedUnreferencedDescriptors:(id)a4 originalUnlockedReferencedDescriptors:(id)a5 originalLockedOverridableDescriptors:(id)a6 originalLockedNeverRemoveDescriptors:(id)a7 originalStagedDescriptors:(id)a8 totalReclaimedSpace:(int64_t)a9 results:(id)a10;
+ (void)handleReceivedPushNotifications:(id)a3;
+ (void)installAutoAssetWithDescriptor:(id)a3;
+ (void)lockerResumed;
+ (void)persistForJobSelector:(id)a3 persistingJobDescriptor:(id)a4 justDownloaded:(BOOL)a5 justPatched:(BOOL)a6 withJobInformation:(id)a7 withFirstClientName:(id)a8;
+ (void)postNotificationName:(id)a3 forAssetType:(id)a4 forAssetSpecifier:(id)a5 fromModule:(id)a6 fromLocation:(id)a7;
+ (void)postSetNotificationName:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 forAtomicInstanceUUID:(id)a6 fromModule:(id)a7 fromLocation:(id)a8;
+ (void)schedulerEliminatedSelector:(id)a3;
+ (void)schedulerEliminatedSetDomainName:(id)a3 forAssetSetIdentifier:(id)a4;
+ (void)schedulerResumed:(id)a3;
+ (void)schedulerTickOccurred;
+ (void)schedulerTriggeredNoActivity;
+ (void)schedulerTriggeredSelectors:(id)a3;
+ (void)schedulerTriggeredSets:(id)a3;
+ (void)secureOperationsFinished:(id)a3 forSetDescriptor:(id)a4 forAutoAssetDescriptors:(id)a5;
+ (void)shutdown;
+ (void)stagerCancelCurrentJob;
+ (void)stagerEliminatedSelector:(id)a3;
+ (void)stagerEliminatedSetConfiguration:(id)a3;
+ (void)stagerPurgeStagedContent:(id)a3;
+ (void)stagerRequestAlreadyDownloadedDescriptors;
+ (void)stagerResumed:(id)a3 withSetLookupResults:(id)a4 performingNewOSPromotion:(BOOL)a5 requiringLoadPriorToUse:(BOOL)a6;
+ (void)stagerStartJobDownloadForStaging:(id)a3 withStagerSetConfiguration:(id)a4 usingCachedAutoAssetCatalog:(id)a5 usingBaseForPatching:(id)a6 withAssetTargetOSVersion:(id)a7 withAssetTargetBuildVersion:(id)a8;
+ (void)stagerStartSetJobDetermineIfAvailable:(id)a3 withAssetTargetOSVersion:(id)a4 withAssetTargetBuildVersion:(id)a5 withAssetTargetTrainName:(id)a6 withAssetTargetRestoreVersion:(id)a7;
- (BOOL)_acceptPersonalizationFromPSUSToBecomeLatestToVend:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6;
- (BOOL)_acceptPersonalizationToAttempt:(id)a3 forSetDescriptor:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6;
- (BOOL)_acceptPersonalizationToAttempt:(id)a3 forSetLookupResult:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6;
- (BOOL)_acceptPersonalizationToProvideLatestToVend:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6;
- (BOOL)_acceptPersonalizationToProvidePreinstalled:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6;
- (BOOL)_decideRemoveDescriptorWithNewerDownloaded:(id)a3 maintainingRemoveDescriptors:(id)a4 allowRemovalWithoutNewerDescriptor:(BOOL)a5 fromLocation:(id)a6;
- (BOOL)_doesClientRequestInvolveSetConfiguration:(id)a3;
- (BOOL)_doesEliminateSelector:(id)a3 matchAssetType:(id)a4 withAssetSpecifier:(id)a5 withAssetVersion:(id)a6 fromLocation:(id)a7;
- (BOOL)_doesSetDescriptorDownloadedMatchLatestToVend:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)_doesSetDescriptorRequirePersonalization:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)_handleResumeFromSoftwareUpdateRequest;
- (BOOL)_handleSuspendForSoftwareUpdateRequestWithNeededBytes:(unint64_t)a3 bytesBySetIdentifier:(id)a4 completionBlock:(id)a5;
- (BOOL)_haveSetAssetEntriesForSchedulerTriggered:(id)a3;
- (BOOL)_inDownloadsInFlight:(id)a3;
- (BOOL)_inMatchedTaskDescriptors:(id)a3 addingMatchingJobUUID:(id)a4;
- (BOOL)_isClientRequestForSetJob:(id)a3;
- (BOOL)_isClientRequestSubjectToElimination:(id)a3;
- (BOOL)_isDownloadedDescriptorPartOfLatestToVend:(id)a3 fromLocation:(id)a4;
- (BOOL)_isDownloadedSetDescriptorLatestToVend:(id)a3 fromLocation:(id)a4;
- (BOOL)_isSetDescriptorAvailableToClient:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)_messageAssetPolicyDownloadUserInitiated:(id)a3 forClientRequest:(id)a4;
- (BOOL)_messageBlockedUntilDownloadManagerSync:(id)a3;
- (BOOL)_messageBlockedUntilFirstUnlock:(id)a3 forAssetSelector:(id)a4;
- (BOOL)_messageBlockedUntilFirstUnlock:(id)a3 forSetInstance:(id)a4;
- (BOOL)_messageShouldBeScheduled:(id)a3 forAssetSelector:(id)a4;
- (BOOL)_removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:(id)a3 setDescriptor:(id)a4 allowRemovalWithoutNewerDescriptor:(BOOL)a5;
- (BOOL)_selectorBeingEliminated:(id)a3 fromLocation:(id)a4;
- (BOOL)_setInstanceBeingEliminated:(id)a3 fromLocation:(id)a4;
- (BOOL)_setMessageCanCreateSetConfiguration:(id)a3;
- (BOOL)_setMessageInvolvesSchedulerPolicy:(id)a3;
- (BOOL)_setMessageShouldBeScheduled:(id)a3 forSetConfiguration:(id)a4 forLatestEventInfo:(id)a5;
- (BOOL)_taskDescriptorEncountered:(id)a3 inMatchedDescriptors:(id)a4;
- (BOOL)_updateTrackedDescriptor:(id)a3 fromLatestDescriptor:(id)a4;
- (BOOL)addToTryPersonalize:(id)a3 forDescriptor:(id)a4;
- (BOOL)atomicInstanceFromPSUSLookupResultOncePersonalized:(id)a3 forSetConfiguration:(id)a4;
- (BOOL)atomicInstanceHasDownloadedSetDescriptor:(id)a3 verboseLogging:(BOOL)a4;
- (BOOL)atomicInstanceIsCurrentlyLocked:(id)a3;
- (BOOL)cancelActiveSetJob:(id)a3 activeSetJob:(id)a4;
- (BOOL)clientRequestIndicatesNoWait:(id)a3;
- (BOOL)doSetAtomicEntries:(id)a3 matchOtherAtomicEntries:(id)a4;
- (BOOL)doesSelectorArray:(id)a3 coverAssetDescriptor:(id)a4;
- (BOOL)doesSetConfiguration:(id)a3 coverAssetDescriptor:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 alignWithSetConfiguration:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 coverAllForAtomicInstanceEntries:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 coverAllForAutoAssetEntries:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 coverRequestedAutoAssetEntries:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 matchSetConfiguration:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 referenceAssetDescriptor:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 referenceSetConfiguration:(id)a4;
- (BOOL)doesSetDescriptor:(id)a3 satisfySetConfiguration:(id)a4 allowingMoreDownloaded:(BOOL)a5;
- (BOOL)doesSetDescriptorReferenceAllPreInstalledContent:(id)a3;
- (BOOL)doesSetDescriptorReferenceDropped:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)doesSetDescriptorWithoutVersion:(id)a3 referenceAssetDescriptor:(id)a4;
- (BOOL)doesSetJobDescriptor:(id)a3 representSameContentAs:(id)a4;
- (BOOL)filesystemDoesDirectoryExist:(id)a3 atPath:(id)a4 isDirectory:(BOOL *)a5;
- (BOOL)filesystemDoesFileExist:(id)a3 atPath:(id)a4;
- (BOOL)handleClientCheckForNewer:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7;
- (BOOL)handleClientLockContent:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7;
- (BOOL)handleClientPotentialJob:(id)a3 alreadyScheduledSelector:(BOOL)a4 forAutoJob:(id)a5 fromLocation:(id)a6;
- (BOOL)handleClientPotentialSetJob:(id)a3 forAutoJob:(id)a4 fromLocation:(id)a5;
- (BOOL)handleSetClientCheckAtomic:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7;
- (BOOL)handleSetClientLockAtomic:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7;
- (BOOL)isAnyAssetEntryOnFilesystemForSetDescriptor:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)isAtomicEntry:(id)a3 desiredForAutoAssetSetEntries:(id)a4;
- (BOOL)isAtomicInstanceForCurrentSetJob:(id)a3;
- (BOOL)isAtomicInstanceLatestToVendForSet:(id)a3;
- (BOOL)isAtomicInstancePartOfPSUS:(id)a3;
- (BOOL)isAutoAssetBeingEliminated:(id)a3;
- (BOOL)isConnectionAuthorized:(id)a3;
- (BOOL)isDescriptorCurrentlyLocked:(id)a3 forDescriptor:(id)a4;
- (BOOL)isEveryAssetEntryOnFilesystemForSetDescriptor:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)isNoWaitRequestInvolvingSecureAsset:(id)a3;
- (BOOL)isSetDescriptor:(id)a3 coveredBySetDescriptorStatus:(id)a4;
- (BOOL)isSetDescriptorCurrentlyLocked:(id)a3 forSetDescriptor:(id)a4;
- (BOOL)isSetIdentifierBeingEliminated:(id)a3 forClientDomainName:(id)a4 ofSetIdentifier:(id)a5;
- (BOOL)isSetIdentifierCurrentlyLocked:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (BOOL)isShortTermLockableSetDescriptor:(id)a3;
- (BOOL)isSuspendedForSoftwareUpdate:(id)a3 forAssetSetIdentifier:(id)a4;
- (BOOL)jobDescriptorInFlightNowOnFilesystem:(id)a3;
- (BOOL)jobDescriptorOnFilesystemValidated:(id)a3 forOSBuild:(id)a4;
- (BOOL)jobToBeIncluded:(id)a3 basedOnControl:(id)a4;
- (BOOL)newAtomicInstanceAndSetDescriptor:(id)a3 fromSetLookupResult:(id)a4 vendingLatestForConfiguration:(id)a5 inStartup:(BOOL)a6 allowEmpty:(BOOL)a7 notifyClients:(BOOL)a8 forCreationReason:(id)a9 recordingHistoryOperation:(int64_t)a10;
- (BOOL)removeShortTermLockingOfSetDescriptor:(id)a3 forSetDescriptor:(id)a4 endingAll:(BOOL)a5 performingHardEliminate:(BOOL)a6 error:(id *)a7;
- (BOOL)schedulerReferencesDescriptor:(id)a3;
- (BOOL)setConfiguration:(id)a3 matchesAssetEntriesFromInfoInstance:(id)a4;
- (BOOL)setConfigurationAdoptLatestToVend:(id)a3 fromSetDescriptor:(id)a4 toSetConfiguration:(id)a5 fromPreSUStaging:(BOOL)a6 allowEmpty:(BOOL)a7;
- (BOOL)setConfigurationAllPreviouslyVendedForceUnlock:(id)a3 forSetConfiguration:(id)a4;
- (BOOL)setConfigurationClearAvailableForUseError:(id)a3 forSetConfiguration:(id)a4 appendingToPersistReason:(id)a5 withReason:(id)a6 maintainingHistoryOperation:(int64_t *)a7;
- (BOOL)setConfigurationForgetIfTrackedAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 removingAtomicInstance:(id)a5;
- (BOOL)setConfigurationIsTrackedAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 forAtomicInstanceUUID:(id)a5;
- (BOOL)setConfigurationPotentialLatestToVend:(id)a3 forSetDescriptor:(id)a4 forSetConfiguration:(id)a5;
- (BOOL)setConfigurationReferencesDescriptor:(id)a3;
- (BOOL)setConfigurationTrackAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 addingAtomicInstance:(id)a5;
- (BOOL)setConfigurationTrackLatestToVend:(id)a3 forSetConfiguration:(id)a4 becomingLatestToVend:(id)a5 historyOperation:(int64_t)a6 fromPreSUStaging:(BOOL)a7;
- (BOOL)setDescriptorAllDiscoveredEntriesDownloaded:(id)a3 forSetDescriptor:(id)a4 loggingEntryExists:(BOOL)a5;
- (BOOL)setDescriptorAllEntriesDownloaded:(id)a3 forSetDescriptor:(id)a4 loggingEntryExists:(BOOL)a5;
- (BOOL)setDescriptorLocked:(id)a3;
- (BOOL)setDescriptorVerifyNoDuplicates:(id)a3;
- (BOOL)setJobFoundAllContent:(id)a3 forJobAtomicInstance:(id)a4 withCurrentSetStatus:(id)a5;
- (BOOL)setPolicyValidate:(id)a3 fromLocation:(id)a4;
- (BOOL)setTargetEntries:(id)a3 match:(id)a4;
- (BOOL)setTargetEntries:(id)a3 matchSetConfiguration:(id)a4;
- (BOOL)setTargetPersistedMatchesClientSpecified:(id)a3;
- (BOOL)shouldAdoptJobFoundAllContent:(id)a3 forJobAtomicInstance:(id)a4 withCurrentSetStatus:(id)a5;
- (BOOL)startupActivationIsFirstExecutionSinceBoot:(id)a3;
- (BOOL)statusErrorConsideredMatch:(id)a3 to:(id)a4;
- (BOOL)timerStartForRequest:(id)a3 fromLocation:(id)a4;
- (BOOL)trackSetDescriptor:(id)a3 fromLocation:(id)a4 forLatestDownloaded:(BOOL)a5 forSpecificAtomicInstance:(id)a6 withCurrentSetStatus:(id)a7 changedWhileTerminated:(BOOL)a8 changedNeverBeenLocked:(BOOL)a9 notifyingIfJustDownloaded:(BOOL)a10 latestToVend:(BOOL)a11 historyOperation:(int64_t)a12 firstClientName:(id)a13 fromPreSUStaging:(BOOL)a14;
- (BOOL)verifySetDescriptorIsLockable:(id)a3 fromLocation:(id)a4 notLocakableError:(id *)a5 corruptedAtomicEntries:(id *)a6;
- (BOOL)wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:(id)a3;
- (MADAutoAssetControlManager)init;
- (const)osTransactionNameAutoJob:(id)a3 forJobUUID:(id)a4;
- (id)_acceptPersonalizationToAttempt:(id)a3 forAtomicEntry:(id)a4;
- (id)_allPreInstalledDescriptor:(id)a3 forAssetType:(id)a4;
- (id)_alreadyDownloadedDescriptorsArray:(id)a3 limitingToSupportingStaging:(BOOL)a4;
- (id)_autoAssetJobProgressNewValidatedCurrentStatus:(id)a3 requiringProgress:(BOOL)a4;
- (id)_autoAssetSetJobProgressNewValidatedCurrentStatus:(id)a3;
- (id)_combinedStatisticsWithStagerClientRepliesSuccess:(id)a3 withStagerClientRepliesFailure:(id)a4 withStagerTotalStaged:(id)a5 withStagerTotalUnstaged:(id)a6;
- (id)_constructSetInfoSameFoundFrom:(id)a3 forSetConfiguration:(id)a4 fromSetStatus:(id)a5;
- (id)_currentSetStatusClearDownloadProgress:(id)a3 clearingSetStatus:(id)a4 forClearingReason:(id)a5;
- (id)_errorUnlessSameVersionFound:(id)a3 changedReportedError:(BOOL *)a4;
- (id)_getHealthReportForSets:(id)a3;
- (id)_handleClientAlterLockOperationForDescriptor:(id)a3 forEventInfo:(id)a4 error:(id *)a5;
- (id)_latestDownloadedDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5;
- (id)_latestDownloadedDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5 matchingAssetVersion:(id)a6;
- (id)_limitSetAtomicEntries:(id)a3 fromSetDescriptor:(id)a4 requestedAutoAssetEntries:(id)a5;
- (id)_limitToCheckAtomicEntries:(id)a3;
- (id)_newAtomicInstancesDownloadedForSetIdentifier:(id)a3;
- (id)_newTrimmedToAutoAssetsInFlight:(id)a3;
- (id)_newestVersionDownloaded:(id)a3;
- (id)_persistedKnownDescriptorForFullAssetSelector:(id)a3;
- (id)_persistedKnownDescriptorForPersistedEntryID:(id)a3;
- (id)_preInstalledDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5;
- (id)_preInstalledRelocateAutoAssets;
- (id)_preInstalledSetAtomicEntriesFromInstanceEntries:(id)a3;
- (id)_shortNameForSelector:(id)a3;
- (id)_shortTermCreateSymbolicLink:(id)a3 symbolicLinkFilename:(id)a4 linkedToFilename:(id)a5 forSetDescriptor:(id)a6 usingFileManager:(id)a7;
- (id)_shortTermPersistSetStatus:(id)a3 forSetDescriptor:(id)a4 persistingSetStatus:(id)a5 toFilename:(id)a6;
- (id)_shortTermSharedLockOpenExclusive:(id)a3 forSetDescriptor:(id)a4 atomicInstanceFilename:(id)a5 error:(id *)a6;
- (id)_shortTermSharedLockRemove:(id)a3 removingSharedLockFilename:(id)a4 usingFileManager:(id)a5 removingDescription:(id)a6;
- (id)_softwareUpdateSuspendResumeEligibleSetEntryIDs;
- (id)_specifierVersionNamesForAtomicInstance:(id)a3;
- (id)_specifierVersionNamesForSetConfiguration:(id)a3;
- (id)_specifierVersionNamesForSetDescriptor:(id)a3;
- (id)_specifierVersionNamesForSetEntries:(id)a3;
- (id)_startupActivationProcessIdentifier;
- (id)_statsCombinedCopy:(BOOL)a3;
- (id)_summary;
- (id)_updateLatestSummary;
- (id)_updatePolicyForSelector:(id)a3;
- (id)_updateSandboxExtensionForResponse:(id)a3 responseError:(id)a4 clientRequest:(id)a5 alreadyOnStateQueue:(BOOL)a6;
- (id)alreadyHaveSetDescriptorMatching:(id)a3;
- (id)atomicInstanceForSetDescriptor:(id)a3;
- (id)atomicInstanceMatchingInfoInstance:(id)a3 withSetInfoInstance:(id)a4;
- (id)atomicInstanceNewEntryIDForSetAtomicInstance:(id)a3;
- (id)atomicInstanceNewIdentifierForSetAtomicInstance:(id)a3;
- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 forClientDomainName:(id)a6 forSetClientName:(id)a7 forAssetSetIdentifier:(id)a8 representingInstanceEntries:(id)a9 recoveringAtomicInstanceUUID:(id)a10 asSubAtomicFrom:(id)a11;
- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 forSetInfoInstance:(id)a6 asSubAtomicFrom:(id)a7;
- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 recoveringForSetDescriptor:(id)a6 usingAsSetClient:(id)a7;
- (id)atomicInstanceNewSubAtomicFromAtomic:(id)a3 forSubsetInfoInstance:(id)a4 error:(id *)a5;
- (id)atomicInstanceOverflowRemove:(id)a3;
- (id)atomicInstanceUUIDArrayForSetDescriptor:(id)a3;
- (id)atomicInstanceUUIDForNewSetJob:(id)a3 forReason:(id)a4;
- (id)atomicInstanceUUIDFromCurrentStatus:(id)a3;
- (id)autoAssetDescriptorsForSet:(id)a3;
- (id)buildFoundResponseMessage:(id)a3 forClientRequest:(id)a4 withFoundDescriptor:(id)a5 withInstance:(id)a6 withDesire:(id)a7 fromLocation:(id)a8 error:(id *)a9;
- (id)buildReportedSetStatus:(id)a3 forClientDomainName:(id)a4 forSetIdentifier:(id)a5 forAtomicInstance:(id)a6 withFoundSetDescriptor:(id)a7 withSubAtomicInstance:(id)a8 reportingLocalContentURLs:(BOOL)a9;
- (id)buildSetFoundResponseMessage:(id)a3 forClientRequest:(id)a4 withFoundSetDescriptor:(id)a5 withSubAtomicInstance:(id)a6 forLatestDownloaded:(BOOL)a7 withInstance:(id)a8 withDesire:(id)a9 fromLocation:(id)a10;
- (id)buildShortTermLockError:(id)a3 code:(int64_t)a4 description:(id)a5 forSetDescriptor:(id)a6 underlyingError:(id)a7;
- (id)clientRequestMessageDesire:(id)a3;
- (id)clientRequestMessageInstance:(id)a3;
- (id)clientRequestMessageName:(id)a3;
- (id)clientRequestMessageSetDesire:(id)a3;
- (id)clientRequestMessageSetEnd:(id)a3;
- (id)clientRequestMessageSetInstance:(id)a3 withEventInfo:(id)a4;
- (id)clientRequestMessageSetPolicy:(id)a3;
- (id)currentJobBySelector:(id)a3;
- (id)currentJobByUUID:(id)a3 fromLocation:(id)a4 notFoundCode:(int64_t)a5 notFoundReason:(id)a6;
- (id)currentJobByUUID:(id)a3 potentiallyResumingJob:(id)a4 withOriginalSelector:(id)a5 fromLocation:(id)a6 notFoundCode:(int64_t)a7 notFoundReason:(id)a8 downloadingDescriptor:(id)a9 baseForPatchDescriptor:(id)a10;
- (id)currentSetStatusFromJobInformation:(id)a3;
- (id)eliminateTrackerForSelector:(id)a3;
- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByDescriptor:(id)a5;
- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByLookupResult:(id)a5;
- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByStatus:(id)a5;
- (id)findSetEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByConfiguration:(id)a5;
- (id)firstAssetTypeForSetEntries:(id)a3;
- (id)getCorruptedEntryInfo:(id)a3;
- (id)jobControlInformationForSelector:(id)a3;
- (id)jobControlInformationForSetConfiguration:(id)a3;
- (id)jobControlInformationForSetJobKey:(id)a3;
- (id)jobToBeGivenGrant:(id)a3;
- (id)latestShortTermLockableAtomicInstanceForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)locateActiveAutoJobForSetDescriptor:(id)a3;
- (id)locateActiveJobDescriptorBySelector:(id)a3;
- (id)locateCancelingSetJobForClientDomain:(id)a3 byIdentifier:(id)a4;
- (id)locateDownloadedByFullSelector:(id)a3;
- (id)locateDownloadedNewBySelectorForAssetType:(id)a3;
- (id)locateDownloadedNewBySelectorLimitedToStaging:(BOOL)a3;
- (id)locateDownloadedNewForSelector:(id)a3 assetSelector:(id)a4 limitedToStaging:(BOOL)a5;
- (id)locateNewAllSetConfigurations;
- (id)locateNewAllSetTargets;
- (id)locatePersistedKnownDescriptorEntryIDs:(id)a3 forAssetType:(id)a4;
- (id)locateSetAtomicInstanceByInstanceUUID:(id)a3;
- (id)locateSetConfigurationByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)locateSetDescriptor:(id)a3 forAtomicInstanceUUID:(id)a4 requireExists:(BOOL)a5;
- (id)locateSetDescriptorActiveJobByAtomicInstanceUUID:(id)a3;
- (id)locateSetDescriptorActiveJobByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)locateSetDescriptorActiveJobPreferringByAtomicInstance:(id)a3 elseByClientDomain:(id)a4 forAssetSetIdentifier:(id)a5;
- (id)locateSetDescriptorForAssetDescriptor:(id)a3;
- (id)locateSetDescriptorForSelector:(id)a3;
- (id)locateSetDescriptorsDownloaded;
- (id)locateSetJobForClientDomain:(id)a3 byIdentifier:(id)a4;
- (id)locateSetLookupResultSatisfying:(id)a3;
- (id)locateSetStatusByInstance:(id)a3;
- (id)locateSetStatusForDomainName:(id)a3 byIdentifier:(id)a4;
- (id)locateSetStatusPreferringByInstance:(id)a3 elseByClientDomain:(id)a4 forAssetSetIdentifier:(id)a5 fromLocation:(id)a6;
- (id)newAssetSetStatus:(id)a3 forReason:(id)a4 forClientDomain:(id)a5 forAssetSetIdentifier:(id)a6 withAtomicInstancesDownloaded:(id)a7 withNewerAtomicInstanceDiscovered:(id)a8 withNewerDiscoveredAtomicEntries:(id)a9 withLatestDownloadedAtomicInstance:(id)a10 withLatestDownloadedAtomicInstanceFromPreSUStaging:(BOOL)a11 withLatestDowloadedAtomicInstanceEntries:(id)a12 withCurrentNotifications:(id)a13 withCurrentNeedPolicy:(id)a14 withSchedulerPolicy:(id)a15 withStagerPolicy:(id)a16 withDownloadUserInitiated:(BOOL)a17 withDownloadProgress:(id)a18 withDownloadedNetworkBytes:(int64_t)a19 withDownloadedFilesystemBytes:(int64_t)a20 extendingWithCurrentLockUsage:(BOOL)a21 withSelectorsForStaging:(id)a22 withAvailableForUseError:(id)a23 withNewerVersionError:(id)a24;
- (id)newAssetStatusForSelector:(id)a3 withNotifications:(id)a4 withAvailableForUseAttributes:(id)a5 withNewerVersionAttributes:(id)a6 withNeverBeenLocked:(BOOL)a7 withDownloadUserInitiated:(BOOL)a8 withDownloadProgress:(id)a9 withDownloadedNetworkBytes:(int64_t)a10 withDownloadedFilesystemBytes:(int64_t)a11 withDownloadedAsPatch:(BOOL)a12 withPatchedFromBaseSelector:(id)a13 withPatchedFromBaseFilesystemBytes:(int64_t)a14 withPatchingAttempted:(BOOL)a15 withStagedPriorToAvailable:(BOOL)a16 withStagedFromOSVersion:(id)a17 withStagedFromBuildVersion:(id)a18 extendingWithCurrentLockUsage:(BOOL)a19 withAvailableForUseError:(id)a20 withPatchingAttemptError:(id)a21 withNewerVersionError:(id)a22;
- (id)newAtomicInstancesDownloadedForDescriptor:(id)a3;
- (id)newSetDescriptorFromAlreadyDownloaded:(id)a3 forSetInfoInstance:(id)a4 fromDownloadedSetDescriptor:(id)a5 forAtomicInstance:(id)a6;
- (id)newSetDescriptorLimitedToCheckInformation:(id)a3;
- (id)newSetEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)newSetEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4 ofAtomicInstance:(id)a5;
- (id)newSetEntryIDForClientDomainName:(id)a3 forAssetSetIdentifier:(id)a4 forMinTargetOS:(id)a5 forMaxTargetOS:(id)a6;
- (id)newSetInfoLimitedToCheckInformation:(id)a3 forAssetSetIdentifier:(id)a4 fromSetInfoFound:(id)a5;
- (id)newSetLockUsageMapKeyForClientDomain:(id)a3 forSetIdentifier:(id)a4;
- (id)newSetTargetFromClientProvidedSetTarget:(id)a3 forClientDomainName:(id)a4 forSetIdentifier:(id)a5;
- (id)notifyLockerAsIndicatedByJob:(id)a3;
- (id)notifyLockerAsIndicatedBySetJob:(id)a3 withSetInstance:(id)a4 withSetDesire:(id)a5 forSetDescriptor:(id)a6 withClientReplyCompletion:(id)a7;
- (id)notifyLockerJustLockedDescriptor:(id)a3 forClientInstance:(id)a4 withClientDesire:(id)a5 respondingToClientRequest:(id)a6 withClientCompletion:(id)a7;
- (id)persistedKnownDescriptorForSetAtomicEntry:(id)a3;
- (id)preInstalledSetDescriptor:(id)a3 forClientDomainName:(id)a4 forSetClientName:(id)a5 forAssetSetIdentifier:(id)a6 forAssetType:(id)a7;
- (id)setAtomicEntriesRemoveDuplicates:(id)a3 dedupingAtomicEntries:(id)a4;
- (id)setConfigurationAssetEntries:(id)a3;
- (id)setConfigurationAssetEntries:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)setConfigurationCopy:(id)a3;
- (id)setConfigurationForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)setConfigurationForDescriptorIfManagedAsSet:(id)a3;
- (id)setConfigurationFromMessageName:(id)a3 withInfoInstance:(id)a4 errorCode:(int64_t *)a5 errorDescription:(id *)a6;
- (id)setConfigurationNewEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4;
- (id)setConfigurationNewEntryIDForInfoInstance:(id)a3;
- (id)setConfigurationNewEntryIDForSetConfiguration:(id)a3;
- (id)setConfigurationPreviouslyVendedLockedAtomicInstances:(id)a3;
- (id)setConfigurationVendingDescriptor:(id)a3 managedAsSet:(BOOL *)a4;
- (id)setDescriptorDedupDownloadedEntries:(id)a3 forSetDescriptor:(id)a4;
- (id)setDescriptorNewEntryIDForDownloaded:(id)a3;
- (id)setDescriptorWalkKeys;
- (id)setDescriptorWalkKeysForClientDomainName:(id)a3 assetSetIdentifier:(id)a4;
- (id)setDescriptorWalkLocate:(id)a3 forKey:(id)a4;
- (id)setJobInstanceKeyForSetInstance:(id)a3;
- (id)setJobInstanceKeyFromSetDescriptor:(id)a3 forLatestDownloaded:(BOOL)a4;
- (id)setJobInstanceKeyFromSetStatus:(id)a3 forLatestDownloaded:(BOOL)a4;
- (id)setLockUsageMapForClientDomain:(id)a3 forSetIdentifier:(id)a4;
- (id)setLockUsageMapForSetDescriptor:(id)a3;
- (id)setTargetNewEntryIDForClientDomainName:(id)a3 forAssetSetIdentifier:(id)a4 forClientProvidedSetTarget:(id)a5;
- (id)shortTermLockSetDescriptor:(id)a3 forSetDescriptor:(id)a4 forSpecificAtomicInstance:(id)a5;
- (id)startupActivationResourceSummary;
- (id)updateAutoAssetSetStatus:(id)a3 forClientDomain:(id)a4 forAssetSetIdentifier:(id)a5 forJobResponse:(id)a6 withResponseError:(id)a7 clearingDownloadProgressReason:(id)a8 withAssetSetStatus:(id)a9;
- (id)updateAutoAssetStatus:(id)a3 forActiveJobUUID:(id)a4 forJobResponse:(id)a5 withResponseError:(id)a6;
- (int)setLockUsageMapForAtomicInstance:(id)a3 clientLockUsageMap:(id)a4 lockReason:(id)a5;
- (int64_t)_bytesDownloadedForDescriptor:(id)a3;
- (int64_t)_filesystemCachedInfo:(id)a3 forPath:(id)a4;
- (int64_t)_scheduleAndCreateSetConfiguration:(id)a3 fromLocation:(id)a4 errorString:(id *)a5;
- (int64_t)actionUnknownAction:(id)a3 error:(id *)a4;
- (int64_t)action_AdditionalSynced:(id)a3 error:(id *)a4;
- (int64_t)action_AttemptNextGraft:(id)a3 error:(id *)a4;
- (int64_t)action_AttemptNextPersonalize:(id)a3 error:(id *)a4;
- (int64_t)action_Before1stAssetFinished:(id)a3 error:(id *)a4;
- (int64_t)action_Before1stCatalogFinished:(id)a3 error:(id *)a4;
- (int64_t)action_Before1stConfigFinished:(id)a3 error:(id *)a4;
- (int64_t)action_CancelActivityAck:(id)a3 error:(id *)a4;
- (int64_t)action_ClearInProgressSecure:(id)a3 error:(id *)a4;
- (int64_t)action_CoalesceLateJobScheduled:(id)a3 error:(id *)a4;
- (int64_t)action_CoalesceLateJobSetScheduled:(id)a3 error:(id *)a4;
- (int64_t)action_DecideNeedGraft:(id)a3 error:(id *)a4;
- (int64_t)action_DecideNeedPersonalize:(id)a3 error:(id *)a4;
- (int64_t)action_DecrementTickDriven:(id)a3 error:(id *)a4;
- (int64_t)action_EliminateSchedulerDone:(id)a3 error:(id *)a4;
- (int64_t)action_EliminateStagerDone:(id)a3 error:(id *)a4;
- (int64_t)action_EliminateStagerSetDone:(id)a3 error:(id *)a4;
- (int64_t)action_FailClientTimedOut:(id)a3 error:(id *)a4;
- (int64_t)action_GraftFailureDecideMore:(id)a3 error:(id *)a4;
- (int64_t)action_GraftSuccessDecideMore:(id)a3 error:(id *)a4;
- (int64_t)action_HandlePushNotifications:(id)a3 error:(id *)a4;
- (int64_t)action_IgnorePushNotifications:(id)a3 error:(id *)a4;
- (int64_t)action_InstallAssets:(id)a3 error:(id *)a4;
- (int64_t)action_IssueClientReplyJobResponse:(id)a3 error:(id *)a4;
- (int64_t)action_IssueClientReplySetJob:(id)a3 error:(id *)a4;
- (int64_t)action_LoadPersistedResumeLocker:(id)a3 error:(id *)a4;
- (int64_t)action_ObtainLookupGrant:(id)a3 error:(id *)a4;
- (int64_t)action_PersonalizeFailureDecideMore:(id)a3 error:(id *)a4;
- (int64_t)action_PersonalizeSuccessDecideMore:(id)a3 error:(id *)a4;
- (int64_t)action_PollDecideBefore1stUnlock:(id)a3 error:(id *)a4;
- (int64_t)action_PromoteStagedMigrate:(id)a3 error:(id *)a4;
- (int64_t)action_ProvidePersistedForJob:(id)a3 error:(id *)a4;
- (int64_t)action_QueueClientRequest:(id)a3 error:(id *)a4;
- (int64_t)action_QueueClientRequestBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_QueueDownloadManager:(id)a3 error:(id *)a4;
- (int64_t)action_ReleaseLookupGrant:(id)a3 error:(id *)a4;
- (int64_t)action_RemoveFinishedJob:(id)a3 error:(id *)a4;
- (int64_t)action_RemoveQueuedClient:(id)a3 error:(id *)a4;
- (int64_t)action_ResumeJobs:(id)a3 error:(id *)a4;
- (int64_t)action_ResumeJobsBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_ResumeScheduler:(id)a3 error:(id *)a4;
- (int64_t)action_ResumeStager:(id)a3 error:(id *)a4;
- (int64_t)action_RouteAssetFinished:(id)a3 error:(id *)a4;
- (int64_t)action_RouteCatalogFinished:(id)a3 error:(id *)a4;
- (int64_t)action_RouteClientClosed:(id)a3 error:(id *)a4;
- (int64_t)action_RouteClientRequest:(id)a3 error:(id *)a4;
- (int64_t)action_RouteConfigFinished:(id)a3 error:(id *)a4;
- (int64_t)action_ScheduleJobs:(id)a3 error:(id *)a4;
- (int64_t)action_ScheduleJobsBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_ScheduleSetJobs:(id)a3 error:(id *)a4;
- (int64_t)action_SchedulerJobDownloaded:(id)a3 error:(id *)a4;
- (int64_t)action_SchedulerJobFoundSame:(id)a3 error:(id *)a4;
- (int64_t)action_SetJobLookupResponseRcvd:(id)a3 error:(id *)a4;
- (int64_t)action_StagerAlreadyDownloaded:(id)a3 error:(id *)a4;
- (int64_t)action_StagerJobCancel:(id)a3 error:(id *)a4;
- (int64_t)action_StagerJobDoneDetermine:(id)a3 error:(id *)a4;
- (int64_t)action_StagerJobDoneDownload:(id)a3 error:(id *)a4;
- (int64_t)action_StagerJobStartDetermine:(id)a3 error:(id *)a4;
- (int64_t)action_StagerJobStartDownload:(id)a3 error:(id *)a4;
- (int64_t)action_StagerRemoveAllNotPromoted:(id)a3 error:(id *)a4;
- (int64_t)action_StartUnlockPollingTimer:(id)a3 error:(id *)a4;
- (int64_t)action_SyncDecideBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_SyncInFlightDownloads:(id)a3 error:(id *)a4;
- (int64_t)action_SyncSkippedDecideBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_Synced:(id)a3 error:(id *)a4;
- (int64_t)action_SyncedResumeStager:(id)a3 error:(id *)a4;
- (int64_t)action_SyncedReviewBefore1st:(id)a3 error:(id *)a4;
- (int64_t)action_SyncedReviewUnlocked:(id)a3 error:(id *)a4;
- (int64_t)atomicInstanceNextCreationIndex:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (int64_t)clientRequestTimeoutSecs:(id)a3 timeoutWasSpecified:(BOOL *)a4;
- (int64_t)locateDownloadedCurrentDownloadedCount;
- (int64_t)performAction:(id)a3 onEvent:(id)a4 inState:(id)a5 withInfo:(id)a6 nextState:(id)a7 error:(id *)a8;
- (int64_t)setConfigurationNewSetConfiguration:(id)a3 forSetInfoInstance:(id)a4 dueToMessageName:(id)a5 selectedConfig:(id *)a6;
- (int64_t)setConfigurationSelectUsingInfoInstance:(id)a3 dueToMessageName:(id)a4 selectedConfig:(id *)a5;
- (int64_t)setLockUsageMapLockCount;
- (unint64_t)_handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:(id *)a3;
- (unsigned)isLocalContentValidForSetAtomicEntry:(id)a3 fromLocation:(id)a4;
- (void)_addCompletionCallbackForSetJobKey:(id)a3 completionCallback:(id)a4;
- (void)_addEvictedCallbackForAtomicInstanceUUID:(id)a3 completionCallback:(id)a4;
- (void)_awaitingResumeReduceToLatest;
- (void)_awaitingResumeRemoveType:(int64_t)a3;
- (void)_clearAtomicInstanceFromAllSetConfigurations:(id)a3 fromLocation:(id)a4;
- (void)_clearAtomicInstanceFromSetConfiguration:(id)a3 forSetDesriptor:(id)a4 forSetAtomicInstance:(id)a5 fromLocation:(id)a6;
- (void)_eliminateAtomicTriggeredByClient:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 awaitingUnlocked:(BOOL)a6;
- (void)_eliminateAtomicTriggeredWhileLoading:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)_eliminateBegin:(id)a3 forAssetSelector:(id)a4 limitingToActivity:(BOOL)a5 fromLocation:(id)a6;
- (void)_eliminateCompleteIfAllDone:(id)a3;
- (void)_eliminateForgetAtomicLostToVend:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)_eliminatePromotedNeverLocked:(id)a3 forAssetSelector:(id)a4;
- (void)_eliminateSecureOperationFinished:(id)a3 forEliminateDescriptor:(id)a4;
- (void)_eliminateSecureOperationFinished:(id)a3 forEliminateSetDescriptor:(id)a4;
- (void)_forceSetUngraftAndEliminateAllSetLocks:(id)a3 forSetDescriptor:(id)a4;
- (void)_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:(id)a3 sortedKeys:(id)a4 setConfigurationsToEvict:(id)a5 completionBlock:(id)a6;
- (void)_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:(id)a3 sortedKeys:(id)a4 setConfigurationsToEvict:(id)a5 completionBlock:(id)a6;
- (void)_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:(id)a3 setConfigurationsToEvict:(id)a4 completionBlock:(id)a5;
- (void)_initializeAutoControl;
- (void)_initializeCachedPreferences;
- (void)_initializeConnectionServer;
- (void)_initializeSUCore;
- (void)_initializeServerConnectionPolicy;
- (void)_logAtomicInstanceEntries:(id)a3 forAtomicInstance:(id)a4;
- (void)_logLookupGrantAwaiting:(id)a3 ofLookupGrant:(id)a4 message:(id)a5;
- (void)_logLookupGrantObtained:(id)a3 ofLookupGrant:(id)a4 message:(id)a5;
- (void)_logLookupGrantReleased:(id)a3 ofLookupGrant:(id)a4 message:(id)a5;
- (void)_logPersistedEntry:(id)a3 forComponentType:(id)a4 operation:(id)a5 forPersistedEntryID:(id)a6 forClientRequest:(id)a7 withJobUUID:(id)a8 withAssetDescriptor:(id)a9 baseForPatchDescriptor:(id)a10 message:(id)a11;
- (void)_logPersistedRemovedEntry:(id)a3 forComponentType:(id)a4 removedPersistedEntryID:(id)a5 removedDescriptor:(id)a6 message:(id)a7;
- (void)_logPersistedSetAtomicInstance:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetAtomicInstance:(id)a6 message:(id)a7;
- (void)_logPersistedSetAtomicInstanceRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetAtomicInstance:(id)a5 message:(id)a6;
- (void)_logPersistedSetAtomicInstanceTableOfContents:(id)a3;
- (void)_logPersistedSetConfiguration:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetConfiguration:(id)a6 historyOperation:(int64_t)a7 recordingSpecifiers:(BOOL)a8 message:(id)a9;
- (void)_logPersistedSetConfigurationRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetConfiguration:(id)a5 message:(id)a6;
- (void)_logPersistedSetConfigurationTableOfContents:(id)a3;
- (void)_logPersistedSetDescriptor:(id)a3 forComponentType:(id)a4 operation:(id)a5 forPersistedEntryID:(id)a6 forClientRequest:(id)a7 withJobUUID:(id)a8 withSetDescriptor:(id)a9 message:(id)a10;
- (void)_logPersistedSetDescriptorRemoved:(id)a3 forComponentType:(id)a4 removedPersistedEntryID:(id)a5 removedSetDescriptor:(id)a6 message:(id)a7;
- (void)_logPersistedSetDescriptorTableOfContents:(id)a3 forComponentType:(id)a4;
- (void)_logPersistedSetLookupResult:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetLookupResult:(id)a6 message:(id)a7;
- (void)_logPersistedSetLookupResultRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetLookupResult:(id)a5 message:(id)a6;
- (void)_logPersistedSetTarget:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetTarget:(id)a6 message:(id)a7;
- (void)_logPersistedSetTargetRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetTarget:(id)a5 message:(id)a6;
- (void)_logPersistedSetTargetTableOfContents:(id)a3;
- (void)_logPersistedTableOfContents:(id)a3 forComponentType:(id)a4;
- (void)_logSetConfigurationEntries:(id)a3 forSetConfiguration:(id)a4;
- (void)_logSetDescriptorEntries:(id)a3 forSetDescriptor:(id)a4;
- (void)_logTrackedDescriptors:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5 matchingAssetVersion:(id)a6;
- (void)_logTrackedSetDescriptors:(id)a3 forSetJobDescriptor:(id)a4;
- (void)_moveFromAwaitingResumedInto:(id)a3 forSelector:(id)a4;
- (void)_preInstalledMakeDescriptorAvailable:(id)a3 fromLocation:(id)a4;
- (void)_preInstalledMigrateAssets;
- (void)_preinstalledTrackBySelector:(id)a3;
- (void)_promotePreviouslyStagedNowDownloaded:(id)a3 forHistoryOperation:(int64_t)a4;
- (void)_reclaimDownloadedDescriptorsWhenJustDownloaded:(id)a3 fromLocation:(id)a4;
- (void)_removeAllContentForEliminateTracker:(id)a3 unlessCurrentlyLocked:(id)a4;
- (void)_removeAllUnlockedForOtherAtomicInstances:(id)a3 fromLocation:(id)a4;
- (void)_removeDescriptorFromFilesystem:(id)a3 droppingDescriptor:(id)a4 forHistoryOperation:(int64_t)a5 firstClientName:(id)a6;
- (void)_removeDownloadedDescriptorsWithNewerDownloaded:(id)a3;
- (void)_removeFromPersistedActiveJobs:(id)a3;
- (void)_removeIncompleteSetDescriptorFromLocation:(id)a3 incompleteSetDescriptor:(id)a4 historyOperationAI:(int64_t)a5 historyOperationSD:(int64_t)a6;
- (void)_removeJobFromDownloadsInFlight:(id)a3;
- (void)_removeNextDownloadedDescriptorIfNewerDownloaded:(id)a3;
- (void)_removeSetDeterminedToBeIncomplete:(id)a3;
- (void)_removeUnlockedForOlderSelectorsWithoutVersion:(id)a3;
- (void)_requestDownloadManagerSync;
- (void)_routeAssetFinished:(id)a3 withEventInfo:(id)a4;
- (void)_routeAssetProgress:(id)a3 toCurrentJobByUUID:(id)a4 withDownloadProgress:(id)a5;
- (void)_routeCatalogFinished:(id)a3 withEventInfo:(id)a4;
- (void)_routeClientRequest:(id)a3 alreadyScheduledSelector:(BOOL)a4 fromLocation:(id)a5;
- (void)_routeConfigFinished:(id)a3 withEventInfo:(id)a4;
- (void)_schedulePushNotifications:(id)a3;
- (void)_scheduleSelector:(id)a3;
- (void)_scheduleSetConfiguration:(id)a3 withClientSetPolicy:(id)a4;
- (void)_scheduledAndRouteClientRequest:(id)a3 fromLocation:(id)a4;
- (void)_schedulerTickOccurred;
- (void)_shortTermChangeAtomicInstance:(id)a3 forAtomicInstance:(id)a4 toShortTermSupported:(BOOL)a5;
- (void)_shortTermForceForget:(id)a3 forSetDescriptor:(id)a4;
- (void)_shortTermSharedLockClose:(id)a3 forSetDescriptor:(id)a4 atomicInstanceFileDescriptor:(id)a5;
- (void)_stagedNewOSPromoteAdoptSetTargets;
- (void)_statsClearingAfterReporting;
- (void)_statsIncrement:(id)a3 forClientRequest:(id)a4;
- (void)_statsIncrementAutoAssetJobsStarted;
- (void)_statsIncrementAutoJobsFinished;
- (void)_statsIncrementDownloadedForDescriptor:(id)a3;
- (void)_statsIncrementFailuresToStartJobs;
- (void)_statsIncrementPreviouslyDownloadedForDescriptor:(id)a3;
- (void)_statsIncrementPromotedForDescriptor:(id)a3;
- (void)_statsIncrementRemovedForDescriptor:(id)a3;
- (void)_statsIncrementResumedInFlightJobs;
- (void)_statsIncrementSchedulerTriggeredJobs;
- (void)_statsIncrementStagerDetermineJobsFinished;
- (void)_statsIncrementStagerDetermineJobsStarted;
- (void)_statsIncrementStagerDownloadJobsFinished;
- (void)_statsIncrementStagerDownloadJobsStarted;
- (void)_statsMaintainReporting;
- (void)_statsRestartNextMaintentanceReport;
- (void)_trackActiveDescriptor:(id)a3 operation:(id)a4 usingSelector:(id)a5 withJobUUID:(id)a6 triggeredByClientMessage:(id)a7 downloadingDescriptor:(id)a8 baseForPatchDescriptor:(id)a9 message:(id)a10;
- (void)_trackPerformanceStartupBegin;
- (void)_updateCurrentSetStatus:(id)a3 forSetIdentifier:(id)a4 withSetStatus:(id)a5;
- (void)addActiveJobs:(id)a3 basedOnControl:(id)a4;
- (void)addSuccessfullyDownloadedJobs:(id)a3 basedOnControl:(id)a4;
- (void)addToCurrentJobs:(id)a3 usingSelector:(id)a4 withJobUUID:(id)a5 triggeredByClientMessage:(id)a6 downloadingDescriptor:(id)a7 baseForPatchDescriptor:(id)a8 usingSetDescriptor:(id)a9 fromLocation:(id)a10;
- (void)assetPersonalizatonAttemptCompletePostEvent:(id)a3 withControlParam:(id)a4;
- (void)atomicInstanceDropOncePersonalized:(id)a3 forSetConfiguration:(id)a4;
- (void)atomicInstanceEliminate:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)atomicInstanceForceUnlock:(id)a3 dueToError:(id)a4 forgettingAtomicInstance:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7;
- (void)atomicInstanceLoadedFromPersisted:(id)a3 persistedEntryID:(id)a4;
- (void)atomicInstanceRemove:(id)a3 setAtomicInstanceUUID:(id)a4 removingForReason:(id)a5 historyOperation:(int64_t)a6;
- (void)atomicInstanceRemovedSetJob:(id)a3 removingForReason:(id)a4 historyOperation:(int64_t)a5;
- (void)atomicInstanceTrackSetDescriptor:(id)a3 fromLocation:(id)a4 forSpecificAtomicInstance:(id)a5;
- (void)atomicInstanceTrimOverflowAfterPersisting:(id)a3;
- (void)atomicInstanceUpdateUsageStatus:(id)a3 toNewStatus:(id)a4 forAtomicInstance:(id)a5;
- (void)clearDownloadedFromSetStatus:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)clientRequestsAwaitingDispatchAll:(id)a3;
- (void)clientRequestsAwaitingSyncToAwaitingFirstUnlock:(id)a3;
- (void)connectionClosedForClientID:(id)a3;
- (void)considerDownloadedWithPSUSLookupResultsForLatestToVend;
- (void)decrementClientRequestCount:(id)a3 forEventInfo:(id)a4;
- (void)eliminateUngraftDescriptor:(id)a3 forAutoAssetDescriptor:(id)a4 failingClientRequestForEventInfo:(id)a5;
- (void)eliminateUngraftSetDescriptor:(id)a3 failingClientRequestForEventInfo:(id)a4;
- (void)ensureStagerFullyResumed;
- (void)finishSetEliminateIfAwaitingUnlocked:(id)a3 forClientDomain:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)firstSchedulerCrosscheckTrim;
- (void)firstSchedulerCrosscheckTrimAtomicInstances;
- (void)firstSchedulerCrosscheckTrimSetDescriptors;
- (void)firstSchedulerShortTermLockContentChecks:(id)a3;
- (void)forceGlobalSetUnlock:(id)a3 dueToError:(id)a4 ofSetDescriptor:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7;
- (void)forceGlobalUnlockFromLocation:(id)a3 dueToError:(id)a4 fullAssetSelector:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7;
- (void)handleClientAlterLockOperation:(id)a3 forAutoJob:(id)a4;
- (void)handleClientCancelActivityForSelectorRequest:(id)a3;
- (void)handleClientCurrentStatusRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleClientEliminateAllForAssetTypeRequest:(id)a3;
- (void)handleClientEliminateAllForSelectorRequest:(id)a3;
- (void)handleClientEliminatePromotedNeverLockedForSelectorRequest:(id)a3;
- (void)handleClientMapLockedToExclaveRequest:(id)a3 fromLocation:(id)a4;
- (void)handleControlClientActiveJobSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientAvailableForStagingSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientControlStatisticsRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientForceGlobalAbandonRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientForceGlobalForgetRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientForceGlobalPurgeRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientForceGlobalUnlockRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientKnownAssetSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientLockedAssetSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientScheduledJobSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientSimulateSetJobOperation:(id)a3;
- (void)handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:(id)a3;
- (void)handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:(id)a3;
- (void)handleControlClientStagedAssetSummaryRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleControlClientStagerOverviewRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleEstimateEvictableBytesForSoftwareUpdateRequest:(id)a3;
- (void)handleMessage:(id)a3 proxyObject:(id)a4 reply:(id)a5;
- (void)handleResumeFromSoftwareUpdateRequest:(id)a3;
- (void)handleSetClientAlterEntriesRepresentingAtomicRequest:(id)a3 forAutoJob:(id)a4 whenCancelingSetJob:(id)a5 alteringFromSetConfiguration:(id)a6;
- (void)handleSetClientAssetSetForStagingRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientContinueAtomicLockRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientCurrentStatusRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientEliminateAtomicRequest:(id)a3 whenCancelingSetJob:(id)a4 forAutoJob:(id)a5;
- (void)handleSetClientEndAtomicLockRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientEndAtomicLocksForClientRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientFormSubAtomicRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetClientMapLockedAtomicEntryRequest:(id)a3 forAutoJob:(id)a4 fromLocation:(id)a5;
- (void)handleSetClientNeedForAtomicRequest:(id)a3 fromLocation:(id)a4;
- (void)handleSetControlClientAssetSetsOverviewRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleSetControlClientInstanceInfoRequest:(id)a3 forAutoJob:(id)a4;
- (void)handleStagingClientCancelOperation:(id)a3;
- (void)handleStagingClientDetermineAllAvailableForUpdateRequest:(id)a3;
- (void)handleStagingClientDetermineAllAvailableRequest:(id)a3;
- (void)handleStagingClientDetermineGroupsAvailableForUpdateRequest:(id)a3;
- (void)handleStagingClientDownloadAllRequest:(id)a3;
- (void)handleStagingClientDownloadGroupsRequest:(id)a3;
- (void)handleStagingClientEraseAllRequest:(id)a3;
- (void)handleStagingClientPurgeAllRequest:(id)a3;
- (void)handleStatusForSoftwareUpdateRequest:(id)a3;
- (void)handleSuspendForSoftwareUpdateRequest:(id)a3;
- (void)handleSuspendResumeForSoftwareUpdateDaemonStartup;
- (void)initialStatusForJob:(id)a3 usingSelector:(id)a4 withJobUUID:(id)a5 downloadingDescriptor:(id)a6 baseForPatchDescriptor:(id)a7 withClientAssetPolicy:(id)a8;
- (void)initialStatusForSetJob:(id)a3 withJobUUID:(id)a4 usingSetDescriptor:(id)a5 usingSetPolicy:(id)a6;
- (void)issueBuiltResponseForEventInfo:(id)a3 issuingResponseMessage:(id)a4 withResponseError:(id)a5 fromLocation:(id)a6;
- (void)issueResponseForEventInfo:(id)a3 withAutoAssetError:(id)a4 fromAction:(id)a5 withDescription:(id)a6;
- (void)issueResponseForEventInfo:(id)a3 withErrorCode:(int64_t)a4 fromAction:(id)a5 withDescription:(id)a6;
- (void)issueResponseToClientRequest:(id)a3 issuingResponseMessage:(id)a4 withResponseError:(id)a5;
- (void)issueResponseToFailedAutoAssetLockRequest:(id)a3 forEventInfo:(id)a4 withResponseError:(id)a5 forAttemptedDescriptor:(id)a6;
- (void)issueResponseToFailedSetLockRequest:(id)a3 forEventInfo:(id)a4 forAtomicInstance:(id)a5 withResponseError:(id)a6;
- (void)loadPersistedActiveJobs;
- (void)loadPersistedAtomicInstancesSupportingShortTermLocking;
- (void)loadPersistedCrosscheckStaleForceUnlock;
- (void)loadPersistedDescriptors;
- (void)loadPersistedSetActiveJobDescriptors;
- (void)loadPersistedSetAtomicInstances;
- (void)loadPersistedSetConfigurations;
- (void)loadPersistedSetDownloadedDescriptors;
- (void)loadPersistedSetTargets;
- (void)lockAutoAssetReplyJobResponse:(id)a3 forEventInfo:(id)a4 lockingChosenDescriptor:(id)a5;
- (void)modifySetConfiguration:(id)a3 toEntriesFromSetTarget:(id)a4;
- (void)notifyCompletionCallbacksForSetJobKey:(id)a3;
- (void)notifyEvictedCallbacksForSetDescriptor:(id)a3;
- (void)persistSetDescriptorActiveJob:(id)a3 fromLocation:(id)a4;
- (void)persistSetDescriptorDownloadedJob:(id)a3 fromLocation:(id)a4;
- (void)promoteAnyPreviouslyStagedNowDownloaded:(id)a3;
- (void)removeActiveJobForFullSelector:(id)a3 removingFullSelector:(id)a4 alsoRemovingNoVersionSelector:(id)a5;
- (void)removeClientRequest:(id)a3 fromLocation:(id)a4;
- (void)removeCurrentJob:(id)a3 schedulerInvolved:(BOOL)a4 potentialNetworkFailure:(BOOL)a5 fromLocation:(id)a6;
- (void)removeCurrentSetJob:(id)a3 schedulerInvolved:(BOOL)a4 potentialNetworkFailure:(BOOL)a5 fromLocation:(id)a6 historyOperation:(int64_t)a7;
- (void)removePreviouslyStagedSetDescriptors;
- (void)removeSetDescriptorActiveJobByAtomicInstanceUUID:(id)a3;
- (void)removeSetDescriptorActiveJobByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4 fromLocation:(id)a5;
- (void)removeSetDescriptorDownloaded:(id)a3 fromLocation:(id)a4 checkingByInstance:(BOOL)a5 regardlessOfLatest:(BOOL)a6 historyOperationAI:(int64_t)a7 historyOperationSD:(int64_t)a8;
- (void)removeSetTargetsForClientDomain:(id)a3 forSetIdentifier:(id)a4 fromLocation:(id)a5;
- (void)resumeJobsWhenBeforeFirstUnlock:(BOOL)a3;
- (void)resumeSetJobsWhenBeforeFirstUnlock:(BOOL)a3;
- (void)scheduledJobsResumed:(id)a3;
- (void)secureCheckUngraft:(id)a3 forDescriptorNoLongerLocked:(id)a4;
- (void)secureCheckUngraftAll:(id)a3 forSetDescriptorNoLongerLocked:(id)a4;
- (void)secureClearInsecureLatestAtomicInstances;
- (void)secureForceUngraft:(id)a3 forDescriptorBeingRemoved:(id)a4;
- (void)securePersonalizeGraftLockSet:(id)a3 lockingSetDescriptor:(id)a4 forEventInfo:(id)a5 fallingBackToSetDescriptor:(id)a6 fromPreSUStaging:(BOOL)a7;
- (void)securePersonalizeGraftLockSet:(id)a3 lockingSetDescriptor:(id)a4 forEventInfo:(id)a5 replyingOnError:(BOOL)a6 fromPreSUStaging:(BOOL)a7 completion:(id)a8;
- (void)secureStartupEstablishOperationSequence:(id)a3 forRequiringPersonalization:(id)a4 forRequiringGrafting:(id)a5;
- (void)setConfigurationAssetSetIDLatestToVend:(id)a3 fromSetDescriptor:(id)a4 forSetConfiguration:(id)a5 buildingPersistReason:(id)a6;
- (void)setConfigurationAssetSetIDMostRecentlyReceived:(id)a3 fromSetDescriptor:(id)a4 forSetConfiguration:(id)a5 buildingPersistReason:(id)a6;
- (void)setConfigurationEliminate:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5;
- (void)setConfigurationForceUnlocked:(id)a3 forSetConfiguration:(id)a4;
- (void)setConfigurationLoadedFromPersisted:(id)a3 persistedEntryID:(id)a4;
- (void)setConfigurationPersist:(id)a3 fromLocation:(id)a4 forReason:(id)a5 dueToAlter:(BOOL)a6 forHistoryOperation:(int64_t)a7;
- (void)setConfigurationRemovedAtomicInstance:(id)a3 fromLocation:(id)a4;
- (void)setConfigurationTickForPreviouslyVended;
- (void)setConfigurationsPrePersonalizedJustCommitted:(id)a3;
- (void)setConfigurationsRefreshStaleIndications;
- (void)setDescriptorAddedPreInstalled:(id)a3;
- (void)setDescriptorEliminate:(id)a3 triggeredByClient:(id)a4 forClientDomainName:(id)a5 forAssetSetIdentifier:(id)a6 awaitingUnlocked:(BOOL)a7;
- (void)setDescriptorEliminateMatching:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 eliminatingSetIdentifer:(BOOL)a6;
- (void)setIdentifierEliminate:(id)a3 usingEliminateTracker:(id)a4 whenCurrentlyLocked:(BOOL)a5 beginningToEliminate:(BOOL)a6 removingContent:(BOOL)a7;
- (void)setJobIndicationOfPotentialLatestToVend:(id)a3 forEventInfo:(id)a4 issuingClientReply:(BOOL)a5;
- (void)setLockUsageMapEliminateForClientDomain:(id)a3 forSetIdentifier:(id)a4;
- (void)setLockUsageMapEndedLockForSetDescriptor:(id)a3 forLockReason:(id)a4 endedLockCount:(int64_t)a5;
- (void)setLockUsageMapLockedSetDescriptor:(id)a3 forLockReason:(id)a4;
- (void)shortTermLockFilesHealthCheck;
- (void)startupActivationCompleted:(id)a3;
- (void)timerStopForClientRequest:(id)a3 fromLocation:(id)a4;
- (void)trackClientRequest:(id)a3;
- (void)trackDescriptor:(id)a3 persisting:(BOOL)a4 fromLocation:(id)a5 changedWhileTerminated:(BOOL)a6 changedNeverBeenLocked:(BOOL)a7 historyOperation:(int64_t)a8 firstClientName:(id)a9 isPromoted:(BOOL)a10;
- (void)trackDescriptorForgetAssetSelector:(id)a3 forHistoryOperation:(int64_t)a4 firstClientName:(id)a5;
- (void)trackDescriptorForgetAssetType:(id)a3 firstClientName:(id)a4;
- (void)trackDescriptorForgetAssetType:(id)a3 forAssetSpecifier:(id)a4 firstClientName:(id)a5;
- (void)trackPerformanceFilesystemExistCheck:(id)a3 atPath:(id)a4 withFilesystemInfo:(int64_t)a5 justUpdatedCache:(BOOL)a6;
- (void)trackPerformanceIteration:(id)a3 ofContainer:(id)a4;
- (void)trackPerformancePhaseBegin:(id)a3;
- (void)trackPerformancePhaseEnd:(id)a3;
- (void)trackPerformanceStartupEnd:(id)a3;
- (void)trackPerformanceStartupStep:(id)a3 beginningStep:(id)a4;
- (void)trackShortTermLockedSetDescriptor:(id)a3 forSpecificAtomicInstance:(id)a4 isReadOnlyForResumeFromPersisted:(BOOL)a5;
- (void)updateAssociatedNoVersionStatus:(id)a3 currentStatus:(id)a4 forAssetSelector:(id)a5;
- (void)updateAutoAssetSetStatus:(id)a3 forSetDescriptor:(id)a4;
- (void)updateAutoAssetStatus:(id)a3 forActiveJobUUID:(id)a4 withLatestJobStatus:(id)a5 matchingAssetVersion:(id)a6 fromLocation:(id)a7;
- (void)updateAutoAssetStatusForChosenDownloadedDescriptor:(id)a3 matchingAssetVersion:(id)a4 fromLocation:(id)a5;
- (void)updateCurrentAssetStatus:(id)a3 currentStatus:(id)a4 forAssetSelector:(id)a5 forActiveJobUUID:(id)a6 matchingAssetVersion:(id)a7 downloadingDescriptor:(id)a8 baseForPatchDescriptor:(id)a9;
- (void)validateShortTermLockURL:(id)a3 normalizedClientDomainNameURL:(id)a4 normalizedAssetSetIdentifierURL:(id)a5 fileManager:(id)a6 isLatestLocker:(BOOL *)a7 isSpecificLocker:(BOOL *)a8;
- (void)verifyLockerLatestSymlink;
@end

@implementation MADAutoAssetControlManager

- (id)_softwareUpdateSuspendResumeEligibleSetEntryIDs
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = objc_opt_new();
  if (!v5)
  {
    v27 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} unable to alloc NSMutableSet", buf, 2u);
    }

    goto LABEL_69;
  }

  if (!_MAPreferencesIsInternalAllowed())
  {
    v26 = &off_4F8318;
    goto LABEL_49;
  }

  v6 = _MAPreferencesCopyNSDictionaryValue(@"AutoAssetSuspendResumeForSUSetsOverride");
  v7 = v6;
  if (!v6)
  {
    v8 = _MADLog(@"AutoControl-SuspendResume");
    v26 = &off_4F8318;
    if (!os_log_type_enabled(v8, OS_LOG_TYPE_DEBUG))
    {
LABEL_47:

      goto LABEL_48;
    }

    *buf = 138412290;
    v86 = &off_4F8318;
    v28 = "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} override not set | value:\n%@";
    v29 = v8;
    v30 = OS_LOG_TYPE_DEBUG;
LABEL_39:
    _os_log_impl(&dword_0, v29, v30, v28, buf, 0xCu);
    goto LABEL_47;
  }

  v80 = 0u;
  v81 = 0u;
  v78 = 0u;
  v79 = 0u;
  v8 = v6;
  v63 = [v8 countByEnumeratingWithState:&v78 objects:v89 count:16];
  if (!v63)
  {

LABEL_37:
    v26 = v8;
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_47;
    }

    *buf = 138412290;
    v86 = v26;
    v28 = "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} override set | value:\n%@";
    v29 = v8;
    v30 = OS_LOG_TYPE_DEFAULT;
    goto LABEL_39;
  }

  v56 = v7;
  v65 = *v79;
  v61 = 1;
  v57 = v5;
  v59 = v8;
  while (2)
  {
    for (i = 0; i != v63; i = i + 1)
    {
      if (*v79 != v65)
      {
        objc_enumerationMutation(v8);
      }

      v10 = *(*(&v78 + 1) + 8 * i);
      v11 = objc_autoreleasePoolPush();
      objc_opt_class();
      if ((objc_opt_isKindOfClass() & 1) == 0)
      {
        v37 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
        {
          v38 = v8;
          v39 = objc_opt_class();
          v40 = v39;
          v41 = objc_opt_class();
          *buf = 138412546;
          v86 = v39;
          v87 = 2112;
          v88 = v41;
          v42 = v41;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for key | expected:%@ found:%@", buf, 0x16u);

          v8 = v38;
        }

        goto LABEL_46;
      }

      v12 = v10;
      v13 = [v8 objectForKeyedSubscript:v12];
      if (!v13 || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
      {
        v31 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
        {
          v32 = v8;
          v33 = objc_opt_class();
          v34 = v33;
          v35 = objc_opt_class();
          *buf = 138412546;
          v86 = v33;
          v87 = 2112;
          v88 = v35;
          v36 = v35;
          _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for value | expected:%@ found:%@", buf, 0x16u);

          v8 = v32;
        }

LABEL_46:
        objc_autoreleasePoolPop(v11);
        v26 = &off_4F8318;
        v7 = v56;
        goto LABEL_47;
      }

      v14 = v13;
      v74 = 0u;
      v75 = 0u;
      v76 = 0u;
      v77 = 0u;
      v15 = v14;
      v16 = [v15 countByEnumeratingWithState:&v74 objects:v84 count:16];
      if (v16)
      {
        v17 = v16;
        v18 = *v75;
        while (2)
        {
          for (j = 0; j != v17; ++j)
          {
            if (*v75 != v18)
            {
              objc_enumerationMutation(v15);
            }

            objc_opt_class();
            if ((objc_opt_isKindOfClass() & 1) == 0)
            {
              v21 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
              {
                v22 = objc_opt_class();
                v23 = v22;
                v24 = objc_opt_class();
                *buf = 138412546;
                v86 = v22;
                v87 = 2112;
                v88 = v24;
                v25 = v24;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for array member | expected:%@ found:%@", buf, 0x16u);
              }

              v61 = 0;
              v20 = 0;
              goto LABEL_24;
            }
          }

          v17 = [v15 countByEnumeratingWithState:&v74 objects:v84 count:16];
          if (v17)
          {
            continue;
          }

          break;
        }

        v20 = 1;
LABEL_24:
        v5 = v57;
        v8 = v59;
      }

      else
      {
        v20 = 1;
      }

      objc_autoreleasePoolPop(v11);
      if (!v20)
      {
        goto LABEL_29;
      }
    }

    v63 = [v8 countByEnumeratingWithState:&v78 objects:v89 count:16];
    if (v63)
    {
      continue;
    }

    break;
  }

LABEL_29:

  v7 = v56;
  if (v61)
  {
    goto LABEL_37;
  }

  v26 = &off_4F8318;
LABEL_48:

LABEL_49:
  v72 = 0u;
  v73 = 0u;
  v70 = 0u;
  v71 = 0u;
  v27 = v26;
  v62 = [v27 countByEnumeratingWithState:&v70 objects:v83 count:16];
  if (v62)
  {
    v58 = *v71;
    v60 = v27;
    do
    {
      v43 = 0;
      do
      {
        if (*v71 != v58)
        {
          objc_enumerationMutation(v27);
        }

        v64 = v43;
        v44 = *(*(&v70 + 1) + 8 * v43);
        v45 = [v27 objectForKeyedSubscript:v44, v56];
        v66 = 0u;
        v67 = 0u;
        v68 = 0u;
        v69 = 0u;
        v46 = [v45 countByEnumeratingWithState:&v66 objects:v82 count:16];
        if (v46)
        {
          v47 = v46;
          v48 = *v67;
          do
          {
            for (k = 0; k != v47; k = k + 1)
            {
              if (*v67 != v48)
              {
                objc_enumerationMutation(v45);
              }

              v50 = *(*(&v66 + 1) + 8 * k);
              v51 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v44 forAssetSetIdentifier:v50];
              if (v51)
              {
                [v5 addObject:v51];
              }

              else
              {
                v52 = v5;
                v53 = _MADLog(@"AutoControl-SuspendResume");
                if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138543618;
                  v86 = v44;
                  v87 = 2114;
                  v88 = v50;
                  _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} unexpected nil for setEntryID | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", buf, 0x16u);
                }

                v5 = v52;
              }
            }

            v47 = [v45 countByEnumeratingWithState:&v66 objects:v82 count:16];
          }

          while (v47);
        }

        v43 = v64 + 1;
        v27 = v60;
      }

      while ((v64 + 1) != v62);
      v62 = [v60 countByEnumeratingWithState:&v70 objects:v83 count:16];
    }

    while (v62);
  }

  v54 = v5;
LABEL_69:

  return v5;
}

- (BOOL)isSuspendedForSoftwareUpdate:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (!v6 || !v7)
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      v15 = 138543618;
      v16 = v6;
      v17 = 2114;
      v18 = v7;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} missing required parameter | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v15, 0x16u);
    }

    v10 = 0;
    goto LABEL_18;
  }

  if (([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]& 0xFFFFFFFFFFFFFFFELL) != 0x64)
  {
    v11 = [(MADAutoAssetControlManager *)self _softwareUpdateSuspendResumeEligibleSetEntryIDs];
    if (v11)
    {
      v12 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v6 forAssetSetIdentifier:v7];
      if (v12)
      {
        v10 = [v11 containsObject:v12];
LABEL_17:

LABEL_18:
        goto LABEL_19;
      }

      v13 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        v15 = 138543618;
        v16 = v6;
        v17 = 2114;
        v18 = v7;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} isSuspendedForSoftwareUpdate:forAssetSetIdentifier observing nil setEntryID | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v15, 0x16u);
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        LOWORD(v15) = 0;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} isSuspendedForSoftwareUpdate:forAssetSetIdentifier observing nil softwareUpdateSuspendResumeEligibleSetEntryIDs", &v15, 2u);
      }
    }

    v10 = 0;
    goto LABEL_17;
  }

  v10 = 0;
LABEL_19:

  return v10;
}

- (void)_addCompletionCallbackForSetJobKey:(id)a3 completionCallback:(id)a4
{
  v12 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
  if (!v9)
  {
    v9 = objc_opt_new();
    [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:v9];
  }

  v10 = [v9 objectForKeyedSubscript:v12];
  if (!v10)
  {
    v10 = objc_opt_new();
    [v9 setObject:v10 forKeyedSubscript:v12];
  }

  v11 = objc_retainBlock(v6);
  [v10 addObject:v11];
}

- (void)notifyCompletionCallbacksForSetJobKey:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
  if (v7)
  {
    if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_B8.segname[1])
    {
      if (v4)
      {
        v8 = [v7 objectForKeyedSubscript:v4];
        v9 = v8;
        if (v8)
        {
          v20 = 0u;
          v21 = 0u;
          v18 = 0u;
          v19 = 0u;
          v10 = [v8 countByEnumeratingWithState:&v18 objects:v23 count:16];
          if (v10)
          {
            v11 = v10;
            v12 = *v19;
            do
            {
              for (i = 0; i != v11; i = i + 1)
              {
                if (*v19 != v12)
                {
                  objc_enumerationMutation(v9);
                }

                (*(*(*(&v18 + 1) + 8 * i) + 16))();
              }

              v11 = [v9 countByEnumeratingWithState:&v18 objects:v23 count:16];
            }

            while (v11);
          }

          v14 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
          [v14 setObject:0 forKeyedSubscript:v4];

          v15 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
          v16 = [v15 count];

          if (!v16)
          {
            [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:0];
          }
        }

        goto LABEL_19;
      }

      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        v17 = "{notifyCompletionCallbacksForSetJobKey} basic invariant violated";
        goto LABEL_18;
      }
    }

    else
    {
      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        v17 = "{notifyCompletionCallbacksForSetJobKey} infeasible path. If callbacks are registered we must be .Suspending";
LABEL_18:
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, v17, buf, 2u);
      }
    }

LABEL_19:
  }
}

- (void)_addEvictedCallbackForAtomicInstanceUUID:(id)a3 completionCallback:(id)a4
{
  v12 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];
  if (!v9)
  {
    v9 = objc_opt_new();
    [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:v9];
  }

  v10 = [v9 objectForKeyedSubscript:v12];
  if (!v10)
  {
    v10 = objc_opt_new();
    [v9 setObject:v10 forKeyedSubscript:v12];
  }

  v11 = objc_retainBlock(v6);
  [v10 addObject:v11];
}

- (void)notifyEvictedCallbacksForSetDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];
  if (v7)
  {
    if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_B8.segname[1])
    {
      if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"notifyEvictedCallbacksForSetDescriptor" forSetDescriptor:v4])
      {
        v8 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
        {
          v9 = [v4 summary];
          *buf = 138543362;
          v24 = v9;
          _os_log_impl(&dword_0, v8, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} notifyEvictedCallbacksForSetDescriptor invoked for locked set descriptor | setDescriptor:%{public}@", buf, 0xCu);
        }
      }

      else
      {
        v8 = [v4 latestDownloadedAtomicInstance];
        if (v8)
        {
          v10 = [v7 objectForKeyedSubscript:v8];
          if (v10)
          {
            if ([(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"evictSetDescriptorIfAwaitingUnlocked" setDescriptor:v4 allowRemovalWithoutNewerDescriptor:1])
            {
              v20 = 0u;
              v21 = 0u;
              v18 = 0u;
              v19 = 0u;
              v11 = v10;
              v12 = [v11 countByEnumeratingWithState:&v18 objects:v22 count:16];
              if (v12)
              {
                v13 = v12;
                v14 = *v19;
                do
                {
                  v15 = 0;
                  do
                  {
                    if (*v19 != v14)
                    {
                      objc_enumerationMutation(v11);
                    }

                    (*(*(*(&v18 + 1) + 8 * v15) + 16))(*(*(&v18 + 1) + 8 * v15));
                    v15 = v15 + 1;
                  }

                  while (v13 != v15);
                  v13 = [v11 countByEnumeratingWithState:&v18 objects:v22 count:16];
                }

                while (v13);
              }

              [v7 setObject:0 forKeyedSubscript:{v8, v18}];
              if (![v7 count])
              {
                [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:0];
              }
            }

            else
            {
              v16 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
              {
                v17 = [v4 summary];
                *buf = 138543362;
                v24 = v17;
                _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "{notifyEvictedCallbacksForSetDescriptor} unable to remove downloaded set descriptor | setDescriptor:%{public}@", buf, 0xCu);
              }
            }
          }
        }
      }
    }

    else
    {
      v8 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v8, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} infeasible path. If callbacks are registered we must be .Suspending", buf, 2u);
      }
    }
  }
}

- (void)handleEstimateEvictableBytesForSoftwareUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  mach_absolute_time();
  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_20.flags)
  {
    if (_MAPreferencesIsInternalAllowed())
    {
      HIBYTE(v25) = 0;
      if (_MAPreferencesGetAppBooleanValue(@"AutoAssetSuspendResumeForSUEnabled", &v25 + 7))
      {
        v7 = 1;
      }

      else
      {
        v7 = HIBYTE(v25) == 0;
      }
    }

    else
    {
      v7 = 1;
    }

    LODWORD(v25) = v7;
    v8 = [(MADAutoAssetControlManager *)self _handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:0, v25];
    mach_absolute_time();
    v9 = +[MADAnalyticsManager getAnalyticsManager];
    v26[0] = @"totalFileSystemBytes";
    v10 = [NSNumber numberWithUnsignedLongLong:v8];
    v27[0] = v10;
    v26[1] = @"suspendResumeEnabled";
    v11 = [NSNumber numberWithBool:v7];
    v27[1] = v11;
    v26[2] = @"durationSeconds";
    MAConvertTicksToSeconds();
    v12 = [NSNumber numberWithDouble:?];
    v27[2] = v12;
    v26[3] = @"duringStartup";
    v13 = [(MADAutoAssetControlManager *)self startupTransaction];
    v14 = [NSNumber numberWithInt:v13 != 0];
    v27[3] = v14;
    v15 = [NSDictionary dictionaryWithObjects:v27 forKeys:v26 count:4];
    v16 = [v9 recordEventWithName:@"com.apple.mobileassetd.handleEstimateEvictableBytesForSoftwareUpdateRequest" assetType:0 payload:v15];

    if (!v25)
    {
      v8 = 0;
    }

    v17 = [v4 clientRequestMessage];
    v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];

    v19 = [[MAAutoAssetSuspendResumeForSoftwareUpdateEstimateEvictableBytesResponseInfo alloc] initWithEstimatedEvictableBytes:v8];
    v20 = objc_alloc_init(NSMutableDictionary);
    [v20 setSafeObject:v19 forKey:@"suspendResumeForSU"];
    v21 = [SUCoreConnectMessage alloc];
    v22 = [v4 clientRequestMessage];
    v23 = [v22 clientID];
    v24 = [v21 initWithType:2 messageName:v18 clientID:v23 version:0 message:v20];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v4 issuingResponseMessage:v24 withResponseError:0 fromLocation:@"handleEstimateEvictableBytesForSoftwareUpdateRequest"];
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleEstimateEvictableBytesForSoftwareUpdateRequest" withDescription:@"handleEstimateEvictableBytesForSoftwareUpdateRequest - not in state .Running, unable to estimate."];
  }
}

- (unint64_t)_handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:(id *)a3
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = objc_opt_new();
  v55 = 0u;
  v56 = 0u;
  v57 = 0u;
  v58 = 0u;
  v7 = [(MADAutoAssetControlManager *)self _softwareUpdateSuspendResumeEligibleSetEntryIDs];
  v8 = [v7 countByEnumeratingWithState:&v55 objects:v64 count:16];
  if (v8)
  {
    v9 = v8;
    v46 = 0;
    v10 = *v56;
    v42 = v7;
    v43 = v6;
    v41 = *v56;
    do
    {
      v11 = 0;
      v44 = v9;
      do
      {
        if (*v56 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v55 + 1) + 8 * v11);
        v13 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v14 = [v13 objectForKeyedSubscript:v12];

        v50 = v12;
        if (v12)
        {
          v49 = [v14 latestAtomicInstanceToVend];
          if (v49)
          {
            v47 = v14;
            v48 = v11;
            v15 = [v14 previouslyVendedLockedAtomicInstances];
            v16 = [v15 count];

            if (v16)
            {
              v17 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v61 = v12;
                v62 = 2048;
                v63 = v16;
                _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} has non-zero previously vended locked atomic instances | assetSetIdentifier:%{public}@ previouslyVendedLockedAtomicInstancesCount:%llu", buf, 0x16u);
              }

              [v6 setObject:&off_4F7EC8 forKeyedSubscript:v12];
            }

            else
            {
              v20 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"_handleStatusForSoftwareUpdateRequest" forAtomicInstanceUUID:v49 requireExists:0];
              v51 = 0u;
              v52 = 0u;
              v53 = 0u;
              v54 = 0u;
              v45 = v20;
              v21 = [v20 latestDowloadedAtomicInstanceEntries];
              v22 = [v21 countByEnumeratingWithState:&v51 objects:v59 count:16];
              if (v22)
              {
                v23 = v22;
                v24 = 0;
                v25 = *v52;
                do
                {
                  for (i = 0; i != v23; i = i + 1)
                  {
                    if (*v52 != v25)
                    {
                      objc_enumerationMutation(v21);
                    }

                    v27 = *(*(&v51 + 1) + 8 * i);
                    v28 = objc_autoreleasePoolPush();
                    v29 = [(MADAutoAssetControlManager *)self persistedKnownDescriptorForSetAtomicEntry:v27];
                    v30 = v29;
                    if (v29)
                    {
                      v31 = [v29 metadata];
                      v32 = [v31 safeIntegerForKey:@"_UnarchivedSize"];

                      v24 = v24 + (v32 & ~(v32 >> 63));
                    }

                    else
                    {
                      v33 = _MADLog(@"AutoControl-SuspendResume");
                      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
                      {
                        v34 = [v27 summary];
                        *buf = 138543618;
                        v61 = v50;
                        v62 = 2114;
                        v63 = v34;
                        _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} missing download descriptor | assetSetIdentifier:%{public}@ setAtomicEntry:%{public}@", buf, 0x16u);
                      }
                    }

                    objc_autoreleasePoolPop(v28);
                  }

                  v23 = [v21 countByEnumeratingWithState:&v51 objects:v59 count:16];
                }

                while (v23);
              }

              else
              {
                v24 = 0;
              }

              v35 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138543618;
                v61 = v50;
                v62 = 2048;
                v63 = v24;
                _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} done calculating latest atomic instance to vend size | assetSetIdentifier:%{public}@ setFileSystemBytes:%llu", buf, 0x16u);
              }

              v46 += v24;
              v36 = [NSNumber numberWithUnsignedLongLong:v24];
              v6 = v43;
              [v43 setObject:v36 forKeyedSubscript:v50];

              v10 = v41;
              v7 = v42;
              v9 = v44;
            }

            v14 = v47;
            v11 = v48;
          }

          else
          {
            v19 = _MADLog(@"AutoControl-SuspendResume");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v61 = v12;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} has no latest instance to vend | assetSetIdentifier:%{public}@", buf, 0xCu);
            }

            [v6 setObject:&off_4F7EC8 forKeyedSubscript:v12];
          }

          v18 = v49;
        }

        else
        {
          v18 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v61 = 0;
            _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} no known set configuration | assetSetIdentifier:%{public}@", buf, 0xCu);
          }
        }

        v11 = v11 + 1;
      }

      while (v11 != v9);
      v9 = [v7 countByEnumeratingWithState:&v55 objects:v64 count:16];
    }

    while (v9);
  }

  else
  {
    v46 = 0;
  }

  v37 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 134217984;
    v61 = v46;
    _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "_handleEstimateEvictableBytesForSoftwareUpdateRequest done | totalSystemFileSystemSpace:%llu", buf, 0xCu);
  }

  if (a3)
  {
    v38 = v6;
    *a3 = v6;
  }

  return v46;
}

- (void)handleSuspendForSoftwareUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = mach_absolute_time();
  v8 = [v4 clientRequestMessage];
  v9 = [v8 message];
  v10 = [v9 safeObjectForKey:@"suspendResumeForSU" ofClass:objc_opt_class()];

  if (!v10)
  {
    v12 = @"handleSuspendForSoftwareUpdateRequest - missing request info";
    v13 = self;
    v14 = v4;
    v15 = 6102;
LABEL_7:
    [(MADAutoAssetControlManager *)v13 issueResponseForEventInfo:v14 withErrorCode:v15 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:v12];
    goto LABEL_22;
  }

  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== stru_B8.segname)
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - already suspended!", buf, 2u);
    }

    v12 = @"handleSuspendForSoftwareUpdateRequest - already suspended";
    v13 = self;
    v14 = v4;
    v15 = 6703;
    goto LABEL_7;
  }

  v35 = v10;
  v33 = [v10 neededBytes];
  v39 = 0;
  v16 = [(MADAutoAssetControlManager *)self _handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:&v39];
  v34 = v39;
  mach_absolute_time();
  v17 = +[MADAnalyticsManager getAnalyticsManager];
  v44[0] = @"availableBytes";
  v18 = [NSNumber numberWithUnsignedLongLong:v16];
  v45[0] = v18;
  v44[1] = @"neededBytes";
  v19 = [NSNumber numberWithUnsignedLongLong:v33];
  v45[1] = v19;
  v44[2] = @"durationSeconds";
  v32 = v7;
  MAConvertTicksToSeconds();
  v20 = [NSNumber numberWithDouble:?];
  v45[2] = v20;
  v44[3] = @"duringStartup";
  v21 = [(MADAutoAssetControlManager *)self startupTransaction];
  v22 = [NSNumber numberWithInt:v21 != 0];
  v45[3] = v22;
  v23 = [NSDictionary dictionaryWithObjects:v45 forKeys:v44 count:4];
  v24 = [v17 recordEventWithName:@"com.apple.mobileassetd.handleSuspendForSoftwareUpdateRequest-spaceCheck" assetType:0 payload:v23];

  if (v33 <= v16)
  {
    v25 = v34;
    v10 = v35;
    if (!v34)
    {
      v27 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "handleSuspendForSoftwareUpdateRequest | unexpectedly empty bytesBySetIdentifier!", buf, 2u);
      }

      v25 = objc_opt_new();
    }

    v36[0] = _NSConcreteStackBlock;
    v36[1] = 3221225472;
    v36[2] = __97__MADAutoAssetControlManager_SoftwareUpdateSuspendResume__handleSuspendForSoftwareUpdateRequest___block_invoke;
    v36[3] = &unk_4B3D88;
    v38 = v32;
    v36[4] = self;
    v28 = v4;
    v37 = v28;
    v29 = objc_retainBlock(v36);
    v30 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
    {
      v31 = [v28 description];
      *buf = 138412290;
      v41 = v31;
      _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - transition to suspended. | eventInfo=%@", buf, 0xCu);
    }

    if (![(MADAutoAssetControlManager *)self _handleSuspendForSoftwareUpdateRequestWithNeededBytes:v33 bytesBySetIdentifier:v25 completionBlock:v29])
    {
      (v29[2])(v29, 100);
    }
  }

  else
  {
    v25 = v34;
    v26 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
    {
      *buf = 134218240;
      v41 = v33;
      v42 = 2048;
      v43 = v16;
      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{handleSuspendForSoftwareUpdateRequest} bytes needed unavailable | neededBytes:%llu availableBytes:%llu", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6108 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:@"handleSuspendForSoftwareUpdateRequest - bytes needed are unavailable"];
    v10 = v35;
  }

LABEL_22:
}

void __97__MADAutoAssetControlManager_SoftwareUpdateSuspendResume__handleSuspendForSoftwareUpdateRequest___block_invoke(uint64_t a1, uint64_t a2)
{
  mach_absolute_time();
  v4 = +[MADAnalyticsManager getAnalyticsManager];
  v22[0] = @"suspended";
  v5 = [NSNumber numberWithInt:a2 == 1];
  v23[0] = v5;
  v22[1] = @"result";
  if (a2 > 102)
  {
    if (a2 <= 200)
    {
      if (a2 == 103)
      {
        v6 = @"EvictionTimerFired";
        goto LABEL_24;
      }

      if (a2 == 200)
      {
        v6 = @"StatusUnknownState";
        goto LABEL_24;
      }
    }

    else
    {
      switch(a2)
      {
        case 201:
          v6 = @"StatusUnexpectedNonce";
          goto LABEL_24;
        case 202:
          v6 = @"StatusUnepxectedState";
          goto LABEL_24;
        case 203:
          v6 = @"StatusWriteError";
          goto LABEL_24;
      }
    }

    goto LABEL_23;
  }

  if (a2 <= 99)
  {
    if (!a2)
    {
      v6 = @"Unknown";
      goto LABEL_24;
    }

    if (a2 == 1)
    {
      v6 = @"Success";
      goto LABEL_24;
    }

LABEL_23:
    v6 = @"Unexpected";
    goto LABEL_24;
  }

  if (a2 == 100)
  {
    v6 = @"FailedToStart";
  }

  else if (a2 == 101)
  {
    v6 = @"AutoJobCancellationTimerFired:";
  }

  else
  {
    v6 = @"CannotSetEmptyAtomicInstance";
  }

LABEL_24:
  v23[1] = v6;
  v22[2] = @"durationSeconds";
  MAConvertTicksToSeconds();
  v7 = [NSNumber numberWithDouble:?];
  v23[2] = v7;
  v22[3] = @"duringStartup";
  v8 = [*(a1 + 32) startupTransaction];
  v9 = [NSNumber numberWithInt:v8 != 0];
  v23[3] = v9;
  v10 = [NSDictionary dictionaryWithObjects:v23 forKeys:v22 count:4];
  v11 = [v4 recordEventWithName:@"com.apple.mobileassetd.handleSuspendForSoftwareUpdateRequest-suspendComplete" assetType:0 payload:v10];

  if (a2 == 1)
  {
    v12 = [*(a1 + 40) clientRequestMessage];
    v13 = [MADAutoAssetControlManager replyMessageNameForRequest:v12];

    v14 = objc_alloc_init(MAAutoAssetSuspendResumeForSoftwareUpdateResponseInfo);
    v15 = objc_alloc_init(NSMutableDictionary);
    [v15 setSafeObject:v14 forKey:@"suspendResumeForSU"];
    v16 = [SUCoreConnectMessage alloc];
    v17 = [*(a1 + 40) clientRequestMessage];
    v18 = [v17 clientID];
    v19 = [v16 initWithType:2 messageName:v13 clientID:v18 version:0 message:v15];

    [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 40) issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleSuspendForSoftwareUpdateRequest"];
  }

  else
  {
    if (([*(a1 + 32) _handleResumeFromSoftwareUpdateRequest] & 1) == 0)
    {
      v20 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        *v21 = 0;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{handleSuspendForSoftwareUpdateRequest} error transitioning to resume!", v21, 2u);
      }
    }

    [*(a1 + 32) issueResponseForEventInfo:*(a1 + 40) withErrorCode:6102 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:@"handleSuspendForSoftwareUpdateRequest - failed to transition to suspended"];
  }
}

- (BOOL)_handleSuspendForSoftwareUpdateRequestWithNeededBytes:(unint64_t)a3 bytesBySetIdentifier:(id)a4 completionBlock:(id)a5
{
  v8 = a4;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  if (!v8 || !v9)
  {
    v13 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v32 = objc_retainBlock(v9);
      *buf = 138543618;
      v57 = v8;
      v58 = 2114;
      v59 = v32;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} missing required parameter | bytesByAssetSetIdentifier:%{public}@ completionBlock:%{public}@", buf, 0x16u);
    }

    goto LABEL_30;
  }

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]!= &stru_20.flags)
  {
    v13 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unexpected status!", buf, 2u);
    }

LABEL_30:
    v33 = 0;
    goto LABEL_59;
  }

  v13 = +[NSUUID UUID];
  if (!v13)
  {
    v14 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to alloc/init NSUUID!", buf, 2u);
    }

    v33 = 0;
    goto LABEL_58;
  }

  v14 = objc_opt_new();
  if (!v14)
  {
    v16 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to alloc/init NSMutableArray!", buf, 2u);
    }

    goto LABEL_56;
  }

  v15 = [v8 keysSortedByValueUsingComparator:&__block_literal_global_17];
  v16 = v15;
  if (!v15)
  {
    v34 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
    {
LABEL_55:

LABEL_56:
      v33 = 0;
      goto LABEL_57;
    }

    *buf = 0;
    v35 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to resolve sorted bytesBySetIdentifier";
    v36 = v34;
    v37 = OS_LOG_TYPE_DEFAULT;
LABEL_54:
    _os_log_impl(&dword_0, v36, v37, v35, buf, 2u);
    goto LABEL_55;
  }

  if (!a3)
  {
LABEL_48:
    if ([p_weak_ivar_lyt[387] writeNewSuspendingStateWithNonce:v13 setConfigurationsToEvict:v14])
    {
      [(MADAutoAssetControlManager *)self _handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:v13 sortedKeys:v16 setConfigurationsToEvict:v14 completionBlock:v9];
      v33 = 1;
      goto LABEL_57;
    }

    v43 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to write suspend file, resuming...", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
    v34 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_55;
    }

    *buf = 0;
    v35 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to write suspend file, resumed";
    v36 = v34;
    v37 = OS_LOG_TYPE_ERROR;
    goto LABEL_54;
  }

  v48 = a3;
  v49 = v14;
  v46 = v13;
  v47 = v9;
  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  v45 = v15;
  obj = v15;
  v17 = [obj countByEnumeratingWithState:&v51 objects:v55 count:16];
  if (!v17)
  {
    v19 = 0;
    goto LABEL_42;
  }

  v18 = v17;
  v19 = 0;
  v20 = *v52;
  while (2)
  {
    for (i = 0; i != v18; i = i + 1)
    {
      if (*v52 != v20)
      {
        objc_enumerationMutation(obj);
      }

      v22 = *(*(&v51 + 1) + 8 * i);
      v23 = [v8 objectForKeyedSubscript:v22];
      v24 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      v25 = [v24 objectForKeyedSubscript:v22];

      if (!v25)
      {
        v27 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v57 = v22;
          v28 = v27;
          v29 = OS_LOG_TYPE_ERROR;
          v30 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} missing set configuration | assetSetIdentifier:%{public}@";
          v31 = 12;
LABEL_21:
          _os_log_impl(&dword_0, v28, v29, v30, buf, v31);
        }

LABEL_22:

        goto LABEL_23;
      }

      v26 = [v23 unsignedLongLongValue];
      if (!v26)
      {
        v27 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          v28 = v27;
          v29 = OS_LOG_TYPE_DEFAULT;
          v30 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} latest instance to vend already the empty set!";
          v31 = 2;
          goto LABEL_21;
        }

        goto LABEL_22;
      }

      v19 += v26;
      [v49 addObject:v25];
      if (v19 >= v48)
      {
        v38 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} found sufficient bytes to evict!", buf, 2u);
        }

        goto LABEL_42;
      }

LABEL_23:
    }

    v18 = [obj countByEnumeratingWithState:&v51 objects:v55 count:16];
    if (v18)
    {
      continue;
    }

    break;
  }

LABEL_42:

  v14 = v49;
  v40 = v19 >= v48;
  v13 = v46;
  v9 = v47;
  v16 = v45;
  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
  if (v40)
  {
    goto LABEL_48;
  }

  v41 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unable to evict expected bytes, resuming...", buf, 2u);
  }

  [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
  v42 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unable to evict expected bytes, resumed", buf, 2u);
  }

  v33 = 0;
  v16 = obj;
LABEL_57:

LABEL_58:
LABEL_59:

  return v33;
}

- (void)_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:(id)a3 sortedKeys:(id)a4 setConfigurationsToEvict:(id)a5 completionBlock:(id)a6
{
  v47 = a3;
  v10 = a4;
  v46 = a5;
  v48 = a6;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  objc_initWeak(&location, self);
  group = dispatch_group_create();
  v74 = 0u;
  v75 = 0u;
  v76 = 0u;
  v77 = 0u;
  obj = v10;
  v13 = [obj countByEnumeratingWithState:&v74 objects:v83 count:16];
  if (v13)
  {
    v14 = *v75;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v75 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v16 = *(*(&v74 + 1) + 8 * i);
        v17 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v18 = [v17 objectForKeyedSubscript:v16];

        v19 = [v18 clientDomainName];
        v20 = [v18 assetSetIdentifier];
        v21 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v19 byIdentifier:v20];

        if (v21)
        {
          v22 = [v18 clientDomainName];
          v23 = [v21 autoAssetSetIdentifier];
          v24 = v23;
          if (v22 && v23)
          {
            v25 = [v18 clientDomainName];
            v26 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v25 forAssetSetIdentifier:v24];

            if (v26)
            {
              if ([(MADAutoAssetControlManager *)self cancelActiveSetJob:@"_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce" activeSetJob:v21])
              {
                v27 = _MADLog(@"AutoControl-SuspendResume");
                if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
                {
                  *buf = 138543874;
                  *&buf[4] = v22;
                  *&buf[12] = 2114;
                  *&buf[14] = v24;
                  *&buf[22] = 2114;
                  v80 = group;
                  _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} found active auto-asset-job, waiting for cancellation. | clientDomainName:%{public}@ setJobIdentifier:%{public}@ suspendingDispatchGroup:%{public}@", buf, 0x20u);
                }

                *buf = 0;
                *&buf[8] = buf;
                *&buf[16] = 0x2020000000;
                LOBYTE(v80) = 0;
                dispatch_group_enter(group);
                v68[0] = _NSConcreteStackBlock;
                v68[1] = 3221225472;
                v68[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke;
                v68[3] = &unk_4B3DF0;
                objc_copyWeak(&v73, &location);
                v72 = buf;
                v69 = v22;
                v70 = v24;
                v71 = group;
                [(MADAutoAssetControlManager *)self _addCompletionCallbackForSetJobKey:v26 completionCallback:v68];

                objc_destroyWeak(&v73);
                _Block_object_dispose(buf, 8);
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                *&buf[4] = v22;
                *&buf[12] = 2114;
                *&buf[14] = v24;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} unable to compute setJobKey | clientDomainName:%{public}@ setJobIdentifier:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v26 = _MADLog(@"AutoControl-SuspendResume");
            if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              *&buf[4] = v22;
              *&buf[12] = 2114;
              *&buf[14] = v24;
              _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} missing required parameter | clientDomainName:%{public}@ setJobIdentifier:%{public}@", buf, 0x16u);
            }
          }
        }
      }

      v13 = [obj countByEnumeratingWithState:&v74 objects:v83 count:16];
    }

    while (v13);
  }

  if (_MAPreferencesIsInternalAllowed() && (buf[0] = 0, AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetSuspendResumeTimeoutCancelOverride", buf), buf[0]))
  {
    v30 = AppIntegerValue;
    if (!AppIntegerValue)
    {
      dispatch_group_enter(group);
    }
  }

  else
  {
    v30 = 30;
  }

  v66[0] = 0;
  v66[1] = v66;
  v66[2] = 0x2020000000;
  v67 = 0;
  v31 = voucher_copy();
  *buf = 0;
  *&buf[8] = buf;
  *&buf[16] = 0x3032000000;
  v80 = __Block_byref_object_copy__10;
  v81 = __Block_byref_object_dispose__10;
  v32 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v33 = [v32 extendedStateQueue];
  v82 = dispatch_source_create(&_dispatch_source_type_timer, 0, 0, v33);

  v34 = *(*&buf[8] + 40);
  v35 = dispatch_time(0, (1000000000 * v30) | 1);
  dispatch_source_set_timer(v34, v35, 0xFFFFFFFFFFFFFFFFLL, 0);
  v36 = *(*&buf[8] + 40);
  handler[0] = _NSConcreteStackBlock;
  handler[1] = 3221225472;
  handler[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1206;
  handler[3] = &unk_4B3E18;
  objc_copyWeak(&v65, &location);
  v63 = v66;
  v64 = buf;
  v37 = v31;
  v61 = v37;
  v38 = v48;
  v62 = v38;
  dispatch_source_set_event_handler(v36, handler);
  v39 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
  {
    *v59 = 0;
    _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job cancellation timer scheduled", v59, 2u);
  }

  dispatch_activate(*(*&buf[8] + 40));
  v40 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v41 = [v40 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1207;
  block[3] = &unk_4B3E40;
  objc_copyWeak(&v58, &location);
  v56 = v66;
  v57 = buf;
  v52 = v47;
  v53 = obj;
  v54 = v46;
  v55 = v38;
  v42 = v38;
  v43 = v46;
  v44 = obj;
  v45 = v47;
  dispatch_group_notify(group, v41, block);

  objc_destroyWeak(&v58);
  objc_destroyWeak(&v65);
  _Block_object_dispose(buf, 8);

  _Block_object_dispose(v66, 8);
  objc_destroyWeak(&location);
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 64));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 56) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
      {
        v8 = *(a1 + 32);
        v9 = *(a1 + 40);
        v10 = *(a1 + 48);
        v12 = 138543874;
        v13 = v8;
        v14 = 2114;
        v15 = v9;
        v16 = 2114;
        v17 = v10;
        _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} found active auto-asset-job, finished cancellation. | clientDomainName:%{public}@ setJobIdentifier:%{public}@ suspendingDispatchGroup:%{public}@", &v12, 0x20u);
      }

      dispatch_group_leave(*(a1 + 48));
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      LOWORD(v12) = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} _addCompletionCallbackForSetJobKey:completionCallback self not found", &v12, 2u);
    }
  }
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1206(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 64));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 48) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = *(*(a1 + 56) + 8);
      v8 = *(v7 + 40);
      *(v7 + 40) = 0;

      v9 = *(a1 + 32);
      v10 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *v12 = 0;
        _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job cancellation timer fired", v12, 2u);
      }

      (*(*(a1 + 40) + 16))();
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} dispatch_source_set_event_handler self not found", buf, 2u);
    }
  }
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1207(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 80));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 64) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = *(*(a1 + 72) + 8);
      v8 = *(v7 + 40);
      *(v7 + 40) = 0;

      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
      {
        *v11 = 0;
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job canellations finished", v11, 2u);
      }

      [v3 _handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:*(a1 + 32) sortedKeys:*(a1 + 40) setConfigurationsToEvict:*(a1 + 48) completionBlock:*(a1 + 56)];
    }
  }

  else
  {
    v10 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} dispatch_group_notify self not found", buf, 2u);
    }
  }
}

- (void)_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:(id)a3 sortedKeys:(id)a4 setConfigurationsToEvict:(id)a5 completionBlock:(id)a6
{
  v69 = a3;
  v68 = a4;
  v10 = a5;
  v70 = a6;
  v80 = self;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v71 = objc_opt_new();
  v107 = 0u;
  v108 = 0u;
  v109 = 0u;
  v110 = 0u;
  obj = v10;
  group = [obj countByEnumeratingWithState:&v107 objects:v117 count:16];
  if (!group)
  {

LABEL_44:
    groupa = dispatch_group_create();
    v103 = 0u;
    v104 = 0u;
    v105 = 0u;
    v106 = 0u;
    v74 = v71;
    v73 = [v74 countByEnumeratingWithState:&v103 objects:v116 count:16];
    if (!v73)
    {
LABEL_72:

      v55 = 300000000000;
      if (_MAPreferencesIsInternalAllowed())
      {
        buf[0] = 0;
        AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetSuspendResumeTimeoutEvictOverride", buf);
        if (buf[0])
        {
          v55 = 1000000000 * AppIntegerValue;
        }
      }

      v93[0] = 0;
      v93[1] = v93;
      v93[2] = 0x2020000000;
      v94 = 0;
      v57 = voucher_copy();
      *buf = 0;
      *&buf[8] = buf;
      *&buf[16] = 0x3032000000;
      v112 = __Block_byref_object_copy__10;
      v113 = __Block_byref_object_dispose__10;
      v58 = [(MADAutoAssetControlManager *)v80 autoControlManagerFSM];
      v59 = [v58 extendedStateQueue];
      v114 = dispatch_source_create(&_dispatch_source_type_timer, 0, 0, v59);

      v60 = *(*&buf[8] + 40);
      v61 = dispatch_time(0, v55);
      dispatch_source_set_timer(v60, v61, 0xFFFFFFFFFFFFFFFFLL, 0);
      v62 = *(*&buf[8] + 40);
      handler[0] = _NSConcreteStackBlock;
      handler[1] = 3221225472;
      handler[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1215;
      handler[3] = &unk_4B3E90;
      handler[4] = v80;
      v91 = v93;
      v92 = buf;
      v63 = v57;
      v89 = v63;
      v64 = v70;
      v90 = v64;
      dispatch_source_set_event_handler(v62, handler);
      v65 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
      {
        *v87 = 0;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job eviction timer scheduled", v87, 2u);
      }

      dispatch_activate(*(*&buf[8] + 40));
      v66 = [(MADAutoAssetControlManager *)v80 autoControlManagerFSM];
      v67 = [v66 extendedStateQueue];
      block[0] = _NSConcreteStackBlock;
      block[1] = 3221225472;
      block[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1216;
      block[3] = &unk_4B3EB8;
      block[4] = v80;
      v85 = v93;
      v86 = buf;
      v82 = v69;
      v83 = obj;
      v84 = v64;
      dispatch_group_notify(groupa, v67, block);

      _Block_object_dispose(buf, 8);
      _Block_object_dispose(v93, 8);

      goto LABEL_78;
    }

    v72 = *v104;
LABEL_46:
    v39 = 0;
    while (1)
    {
      if (*v104 != v72)
      {
        v40 = v39;
        objc_enumerationMutation(v74);
        v39 = v40;
      }

      v75 = v39;
      v41 = *(*(&v103 + 1) + 8 * v39);
      v42 = [v74 objectForKeyedSubscript:v41];
      v101 = 0u;
      v102 = 0u;
      v99 = 0u;
      v100 = 0u;
      v43 = v42;
      v44 = [v43 countByEnumeratingWithState:&v99 objects:v115 count:16];
      if (v44)
      {
        break;
      }

LABEL_70:

      v39 = v75 + 1;
      if ((v75 + 1) == v73)
      {
        v73 = [v74 countByEnumeratingWithState:&v103 objects:v116 count:16];
        if (!v73)
        {
          goto LABEL_72;
        }

        goto LABEL_46;
      }
    }

    v45 = *v100;
LABEL_51:
    v46 = 0;
    while (1)
    {
      if (*v100 != v45)
      {
        objc_enumerationMutation(v43);
      }

      v47 = *(*(&v99 + 1) + 8 * v46);
      v48 = [v43 objectForKeyedSubscript:v47];
      v49 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543874;
        *&buf[4] = v41;
        *&buf[12] = 2114;
        *&buf[14] = v47;
        *&buf[22] = 2114;
        v112 = v48;
        _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} found latestAtomicInstanceToVend, scheduling eviction. | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ latestAtomicInstanceToVend:%{public}@", buf, 0x20u);
      }

      if ([(MADAutoAssetControlManager *)v80 isSetIdentifierCurrentlyLocked:@"notifyEvictedCallbacksForSetDescriptor" forClientDomainName:v41 forAssetSetIdentifier:v47])
      {
        *buf = 0;
        *&buf[8] = buf;
        *&buf[16] = 0x2020000000;
        LOBYTE(v112) = 0;
        dispatch_group_enter(groupa);
        v95[0] = _NSConcreteStackBlock;
        v95[1] = 3221225472;
        v95[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke;
        v95[3] = &unk_4B3E68;
        v98 = buf;
        v95[4] = v41;
        v95[5] = v47;
        v50 = v48;
        v96 = v50;
        v97 = groupa;
        [(MADAutoAssetControlManager *)v80 _addEvictedCallbackForAtomicInstanceUUID:v50 completionCallback:v95];

        _Block_object_dispose(buf, 8);
      }

      else
      {
        v51 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          *&buf[4] = v47;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} already unlocked! | assetSetIdentifier:%{public}@", buf, 0xCu);
        }

        v52 = [(MADAutoAssetControlManager *)v80 locateSetDescriptor:@"_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce" forAtomicInstanceUUID:v48 requireExists:0];
        if (!v52)
        {
          v53 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            *&buf[4] = v48;
            _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} unable to locate set descriptor | latestAtomicInstanceToVend:%{public}@", buf, 0xCu);
          }

          goto LABEL_67;
        }

        if (![(MADAutoAssetControlManager *)v80 _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"notifyEvictedCallbacksForSetDescriptor" setDescriptor:v52 allowRemovalWithoutNewerDescriptor:1])
        {
          v53 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
          {
            v54 = [v52 summary];
            *buf = 138543362;
            *&buf[4] = v54;
            _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} unable to remove downloaded set descriptor | setDescriptor:%{public}@", buf, 0xCu);
          }

LABEL_67:

          goto LABEL_68;
        }
      }

LABEL_68:

      if (v44 == ++v46)
      {
        v44 = [v43 countByEnumeratingWithState:&v99 objects:v115 count:16];
        if (!v44)
        {
          goto LABEL_70;
        }

        goto LABEL_51;
      }
    }
  }

  v13 = 1;
  v77 = *v108;
LABEL_3:
  v14 = 0;
  while (1)
  {
    if (*v108 != v77)
    {
      objc_enumerationMutation(obj);
    }

    v15 = *(*(&v107 + 1) + 8 * v14);
    v16 = [v15 clientDomainName];
    v17 = [v15 assetSetIdentifier];
    v18 = v17;
    if (v16 && v17 != 0)
    {
      break;
    }

    v20 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543618;
      *&buf[4] = v16;
      *&buf[12] = 2114;
      *&buf[14] = v18;
      v21 = v20;
      v22 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} setConfiguration missing clientDomainName or assetSetIdentifier| clientDomainName:%{public}@ assetSetIdentifier:%{public}@";
      v23 = 22;
LABEL_20:
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, v22, buf, v23);
    }

LABEL_25:
    v13 = 0;
LABEL_26:

    if (group == ++v14)
    {
      v35 = [obj countByEnumeratingWithState:&v107 objects:v117 count:16];
      group = v35;
      if (!v35)
      {

        if ((v13 & 1) == 0)
        {
          goto LABEL_40;
        }

        goto LABEL_44;
      }

      goto LABEL_3;
    }
  }

  v24 = [v15 firstEntryAssetType];
  v20 = v24;
  if (!v24)
  {
    v20 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      *&buf[4] = v18;
      v21 = v20;
      v22 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} missing asset type | assetSetIdentifier:%{public}@";
      v23 = 12;
      goto LABEL_20;
    }

    goto LABEL_25;
  }

  v25 = [v15 latestAtomicInstanceToVend];
  if (!v25)
  {
    v28 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      *&buf[4] = v18;
      v29 = v28;
      v30 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} missing latestAtomicInstanceToVend | assetSetIdentifier:%{public}@";
      v31 = 12;
LABEL_23:
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, v30, buf, v31);
    }

LABEL_24:

    goto LABEL_25;
  }

  v26 = [v15 previouslyVendedLockedAtomicInstances];
  v27 = [v26 count];

  if (v27)
  {
    v28 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543618;
      *&buf[4] = v18;
      *&buf[12] = 2048;
      *&buf[14] = v27;
      v29 = v28;
      v30 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} has non-zero previously vended locked atomic instances | assetSetIdentifier:%{public}@ previouslyVendedLockedAtomicInstancesCount:%llu";
      v31 = 22;
      goto LABEL_23;
    }

    goto LABEL_24;
  }

  v32 = [v71 objectForKeyedSubscript:v16];
  if (!v32)
  {
    v32 = objc_opt_new();
    [v71 setObject:v32 forKeyedSubscript:v16];
  }

  [v32 setObject:v25 forKeyedSubscript:v18];
  v33 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    *&buf[4] = v18;
    _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} evicting  | assetSetIdentifier:%{public}@", buf, 0xCu);
  }

  v34 = [[MADAutoSetLookupResult alloc] initForAssetType:v20 withCatalogCachedAssetSetID:0 withCatalogDownloadedFromLive:0 withCatalogLastTimeChecked:0 withCatalogPostedDate:0 withRequestedAutoAssetEntries:0 withDiscoveredAtomicEntries:0 withCatalogFromPallasResponse:0];
  if ([(MADAutoAssetControlManager *)v80 newAtomicInstanceAndSetDescriptor:@"_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce" fromSetLookupResult:v34 vendingLatestForConfiguration:v15 inStartup:0 allowEmpty:1 notifyClients:1 forCreationReason:@"FROM_SU_SUSPEND" recordingHistoryOperation:229])
  {

    goto LABEL_26;
  }

  v36 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
  {
    v37 = [v15 assetSetIdentifier];
    *buf = 138543362;
    *&buf[4] = v37;
    _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} failed to mark latest to vend | assetSetIdentifier:%{public}@", buf, 0xCu);
  }

LABEL_40:
  v38 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} failed setup empty atomic instances, failing suspend.", buf, 2u);
  }

  (*(v70 + 2))(v70, 102);
LABEL_78:
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke(uint64_t a1)
{
  v1 = *(*(a1 + 64) + 8);
  if ((*(v1 + 24) & 1) == 0)
  {
    *(v1 + 24) = 1;
    v3 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = *(a1 + 32);
      v5 = *(a1 + 40);
      v6 = *(a1 + 48);
      v7 = 138543874;
      v8 = v4;
      v9 = 2114;
      v10 = v5;
      v11 = 2114;
      v12 = v6;
      _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} found latestAtomicInstanceToVend, evicted! | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ latestAtomicInstanceToVend:%{public}@", &v7, 0x20u);
    }

    dispatch_group_leave(*(a1 + 56));
  }
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1215(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v4 = *(*(a1 + 56) + 8);
  if ((*(v4 + 24) & 1) == 0)
  {
    *(v4 + 24) = 1;
    v5 = *(*(a1 + 64) + 8);
    v6 = *(v5 + 40);
    *(v5 + 40) = 0;

    v7 = *(a1 + 40);
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      *v9 = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} eviction cancellation timer fired", v9, 2u);
    }

    (*(*(a1 + 48) + 16))();
  }
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1216(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v4 = *(*(a1 + 64) + 8);
  if ((*(v4 + 24) & 1) == 0)
  {
    *(v4 + 24) = 1;
    v5 = *(*(a1 + 72) + 8);
    v6 = *(v5 + 40);
    *(v5 + 40) = 0;

    v7 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v8 = 0;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} evictions finished", v8, 2u);
    }

    [*(a1 + 32) _handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:*(a1 + 40) setConfigurationsToEvict:*(a1 + 48) completionBlock:*(a1 + 56)];
  }
}

- (void)_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:(id)a3 setConfigurationsToEvict:(id)a4 completionBlock:(id)a5
{
  v7 = a3;
  v8 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v20 = 0;
  v11 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:&v20];
  v12 = v20;
  v13 = v12;
  if (!v12)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} current nonce now nil, do not attempt to update.", v19, 2u);
    }

    v16 = 200;
    goto LABEL_20;
  }

  v14 = [v12 nonce];
  v15 = [SUCore objectIsEqual:v7 to:v14];

  if ((v15 & 1) == 0)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} nonce has changed, do not attempt to update.", v19, 2u);
    }

    v16 = 201;
    goto LABEL_20;
  }

  if (v11 != 201)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} unexpected state, must be suspending.", v19, 2u);
    }

    v16 = 202;
    goto LABEL_20;
  }

  [v13 setStatus:200];
  if (([v13 write] & 1) == 0)
  {
    v18 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} failed to write suspend file, resuming...", v19, 2u);
    }

    [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} failed to write suspend file, resumed", v19, 2u);
    }

    v16 = 203;
LABEL_20:

    goto LABEL_21;
  }

  v16 = 1;
LABEL_21:
  v8[2](v8, v16);
}

- (void)handleResumeFromSoftwareUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if ([(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest])
  {
    v7 = [v4 clientRequestMessage];
    v8 = [MADAutoAssetControlManager replyMessageNameForRequest:v7];

    v9 = objc_alloc_init(MAAutoAssetSuspendResumeForSoftwareUpdateResponseInfo);
    v10 = objc_alloc_init(NSMutableDictionary);
    [v10 setSafeObject:v9 forKey:@"suspendResumeForSU"];
    v11 = [SUCoreConnectMessage alloc];
    v12 = [v4 clientRequestMessage];
    v13 = [v12 clientID];
    v14 = [v11 initWithType:2 messageName:v8 clientID:v13 version:0 message:v10];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v4 issuingResponseMessage:v14 withResponseError:0 fromLocation:@"handleEstimateEvictableBytesForSoftwareUpdateRequest"];
    v4 = v8;
  }

  else
  {
    v15 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *v16 = 0;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - Issue encountered transitioning to running!", v16, 2u);
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6108 fromAction:@"handleResumeFromSoftwareUpdateRequest" withDescription:@"handleResumeFromSoftwareUpdateRequest - already running"];
  }
}

- (BOOL)_handleResumeFromSoftwareUpdateRequest
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];

  if (v5)
  {
    v6 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} clearing outstanding completionCallbacksBySetJobKey.", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:0];
  }

  v7 = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];

  if (v7)
  {
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} clearing outstanding evictedCallbacksByAtomicInstanceUUID.", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:0];
  }

  v30 = 0;
  v9 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:&v30];
  v10 = v30;
  v11 = v10;
  if (v9 != 100)
  {
    if (v10)
    {
      v28 = 0u;
      v29 = 0u;
      v26 = 0u;
      v27 = 0u;
      v13 = [v10 setConfigurationsToEvict];
      v14 = [v13 countByEnumeratingWithState:&v26 objects:v31 count:16];
      if (v14)
      {
        v15 = v14;
        v16 = *v27;
        do
        {
          for (i = 0; i != v15; i = i + 1)
          {
            if (*v27 != v16)
            {
              objc_enumerationMutation(v13);
            }

            v18 = *(*(&v26 + 1) + 8 * i);
            v19 = [v18 clientDomainName];
            v20 = [v18 assetSetIdentifier];
            [MADAutoAssetScheduler triggerWithRetrySetDomainName:v19 forAssetSetIdentifier:v20 usingSetUpdatePolicy:0];
          }

          v15 = [v13 countByEnumeratingWithState:&v26 objects:v31 count:16];
        }

        while (v15);
      }

      if (+[MADAutoAssetSoftwareUpdateSuspendResumeState clear])
      {
        goto LABEL_22;
      }

      v24 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "{_handleResumeFromSoftwareUpdateRequest} failed to clear resuming file.", buf, 2u);
      }
    }

    else
    {
      v22 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        v23 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        *buf = 138412290;
        v33 = v23;
        _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{_handleResumeFromSoftwareUpdateRequest} expected a state file but none was returned | currentStatus:%@", buf, 0xCu);
      }

      +[MADAutoAssetSoftwareUpdateSuspendResumeState clear];
    }

    v21 = 0;
    goto LABEL_30;
  }

  v12 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} already running, nothing to do.", buf, 2u);
  }

LABEL_22:
  v21 = 1;
LABEL_30:

  return v21;
}

- (void)handleSuspendResumeForSoftwareUpdateDaemonStartup
{
  v3 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
  if (v3 != 100)
  {
    if (v3 != 101)
    {
      if (v3 == 200)
      {
        return;
      }

      v4 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        v5 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        v8 = 138412290;
        v9 = v5;
        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} daemon found anomalous status on startup, resuming | status:%@", &v8, 0xCu);
      }
    }

    if ([(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest])
    {
      [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
      v6 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        v7 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        v8 = 138412290;
        v9 = v7;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} resumed! | status:%@", &v8, 0xCu);
      }
    }

    else
    {
      v6 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        LOWORD(v8) = 0;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} failed to resume", &v8, 2u);
      }
    }
  }
}

- (void)handleStatusForSoftwareUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
  v8 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
    v18 = 138412290;
    v19 = v9;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} status checked...! | status:%@", &v18, 0xCu);
  }

  v10 = [v4 clientRequestMessage];
  v11 = [MADAutoAssetControlManager replyMessageNameForRequest:v10];

  v12 = [[MAAutoAssetSuspendResumeForSoftwareUpdateStatusResponseInfo alloc] initWithStatus:v7];
  v13 = objc_alloc_init(NSMutableDictionary);
  [v13 setSafeObject:v12 forKey:@"suspendResumeForSU"];
  v14 = [SUCoreConnectMessage alloc];
  v15 = [v4 clientRequestMessage];
  v16 = [v15 clientID];
  v17 = [v14 initWithType:2 messageName:v11 clientID:v16 version:0 message:v13];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v4 issuingResponseMessage:v17 withResponseError:0 fromLocation:@"handleStatusForSoftwareUpdateRequest"];
}

+ (id)_getAutoControlManagerStateTable
{
  v776[0] = @"Startup";
  v774[0] = @"StartupBefore1st";
  v2 = kSUCoreNextStateKey;
  v3 = kSUCoreActionKey;
  v772[0] = kSUCoreNextStateKey;
  v772[1] = kSUCoreActionKey;
  v773[0] = @"Before1stBeforeResumeSync";
  v773[1] = @"StartUnlockPollingTimer";
  v263 = [NSDictionary dictionaryWithObjects:v773 forKeys:v772 count:2];
  v775[0] = v263;
  v774[1] = @"StartupUnlocked";
  v770[0] = v2;
  v770[1] = v3;
  v771[0] = @"ResumingLockerSync";
  v771[1] = @"LoadPersistedResumeLocker";
  v262 = [NSDictionary dictionaryWithObjects:v771 forKeys:v770 count:2];
  v775[1] = v262;
  v261 = [NSDictionary dictionaryWithObjects:v775 forKeys:v774 count:2];
  v777[0] = v261;
  v776[1] = @"Before1stBeforeResumeSync";
  v768[0] = @"PollForDeviceUnlocked";
  v766 = v3;
  v767 = @"PollDecideBefore1stUnlock";
  v260 = [NSDictionary dictionaryWithObjects:&v767 forKeys:&v766 count:1];
  v769[0] = v260;
  v768[1] = @"DownloadManagerSyncSkipped";
  v764 = v3;
  v765 = @"SyncSkippedDecideBefore1st";
  v259 = [NSDictionary dictionaryWithObjects:&v765 forKeys:&v764 count:1];
  v769[1] = v259;
  v768[2] = @"DownloadManagerSynced";
  v762 = v3;
  v763 = @"SyncDecideBefore1st";
  v258 = [NSDictionary dictionaryWithObjects:&v763 forKeys:&v762 count:1];
  v769[2] = v258;
  v768[3] = @"DownloadCatalogFinished";
  v760 = v3;
  v761 = @"Before1stCatalogFinished";
  v257 = [NSDictionary dictionaryWithObjects:&v761 forKeys:&v760 count:1];
  v769[3] = v257;
  v768[4] = @"DownloadConfigFinished";
  v758 = v3;
  v759 = @"Before1stConfigFinished";
  v256 = [NSDictionary dictionaryWithObjects:&v759 forKeys:&v758 count:1];
  v769[4] = v256;
  v768[5] = @"DownloadAssetFinished";
  v756 = v3;
  v757 = @"Before1stAssetFinished";
  v255 = [NSDictionary dictionaryWithObjects:&v757 forKeys:&v756 count:1];
  v769[5] = v255;
  v768[6] = @"TimeoutAwaitingSynced";
  v754 = v3;
  v4 = kSUCoreFSMActionNoOp;
  v755 = kSUCoreFSMActionNoOp;
  v254 = [NSDictionary dictionaryWithObjects:&v755 forKeys:&v754 count:1];
  v769[6] = v254;
  v768[7] = @"TimeoutClientQueued";
  v752 = v3;
  v753 = @"FailClientTimedOut";
  v253 = [NSDictionary dictionaryWithObjects:&v753 forKeys:&v752 count:1];
  v769[7] = v253;
  v768[8] = @"ClientRequest";
  v750 = v3;
  v751 = @"QueueClientRequestBefore1st";
  v252 = [NSDictionary dictionaryWithObjects:&v751 forKeys:&v750 count:1];
  v769[8] = v252;
  v768[9] = @"ClientClosed";
  v748 = v3;
  v749 = @"RemoveQueuedClient";
  v251 = [NSDictionary dictionaryWithObjects:&v749 forKeys:&v748 count:1];
  v769[9] = v251;
  v768[10] = @"PushNotificationReceived";
  v746 = v3;
  v747 = @"IgnorePushNotifications";
  v250 = [NSDictionary dictionaryWithObjects:&v747 forKeys:&v746 count:1];
  v769[10] = v250;
  v768[11] = @"SecureOperationsFinished";
  v744 = v3;
  v745 = @"ClearInProgressSecure";
  v249 = [NSDictionary dictionaryWithObjects:&v745 forKeys:&v744 count:1];
  v769[11] = v249;
  v768[12] = @"SyncedStillBefore1st";
  v742 = v2;
  v743 = @"Before1stBeforeResume";
  v248 = [NSDictionary dictionaryWithObjects:&v743 forKeys:&v742 count:1];
  v769[12] = v248;
  v768[13] = @"SyncedNowUnlocked";
  v740[0] = v2;
  v740[1] = v3;
  v741[0] = @"ResumingLocker";
  v741[1] = @"LoadPersistedResumeLocker";
  v247 = [NSDictionary dictionaryWithObjects:v741 forKeys:v740 count:2];
  v769[13] = v247;
  v768[14] = @"PolledNowUnlocked";
  v738[0] = v2;
  v738[1] = v3;
  v739[0] = @"ResumingLockerSync";
  v739[1] = @"LoadPersistedResumeLocker";
  v246 = [NSDictionary dictionaryWithObjects:v739 forKeys:v738 count:2];
  v769[14] = v246;
  v245 = [NSDictionary dictionaryWithObjects:v769 forKeys:v768 count:15];
  v777[1] = v245;
  v776[2] = @"Before1stBeforeResume";
  v736[0] = @"PollForDeviceUnlocked";
  v734 = v3;
  v735 = @"PollDecideBefore1stUnlock";
  v244 = [NSDictionary dictionaryWithObjects:&v735 forKeys:&v734 count:1];
  v737[0] = v244;
  v736[1] = @"DownloadManagerSyncSkipped";
  v732 = v3;
  v733 = v4;
  v243 = [NSDictionary dictionaryWithObjects:&v733 forKeys:&v732 count:1];
  v737[1] = v243;
  v736[2] = @"DownloadManagerSynced";
  v730 = v3;
  v731 = @"SyncDecideBefore1st";
  v242 = [NSDictionary dictionaryWithObjects:&v731 forKeys:&v730 count:1];
  v737[2] = v242;
  v736[3] = @"DownloadCatalogFinished";
  v728 = v3;
  v729 = @"Before1stCatalogFinished";
  v241 = [NSDictionary dictionaryWithObjects:&v729 forKeys:&v728 count:1];
  v737[3] = v241;
  v736[4] = @"DownloadConfigFinished";
  v726 = v3;
  v727 = @"Before1stConfigFinished";
  v240 = [NSDictionary dictionaryWithObjects:&v727 forKeys:&v726 count:1];
  v737[4] = v240;
  v736[5] = @"DownloadAssetFinished";
  v724 = v3;
  v725 = @"Before1stAssetFinished";
  v239 = [NSDictionary dictionaryWithObjects:&v725 forKeys:&v724 count:1];
  v737[5] = v239;
  v736[6] = @"TimeoutAwaitingSynced";
  v722 = v3;
  v723 = v4;
  v238 = [NSDictionary dictionaryWithObjects:&v723 forKeys:&v722 count:1];
  v737[6] = v238;
  v736[7] = @"TimeoutClientQueued";
  v720 = v3;
  v721 = @"FailClientTimedOut";
  v237 = [NSDictionary dictionaryWithObjects:&v721 forKeys:&v720 count:1];
  v737[7] = v237;
  v736[8] = @"ClientRequest";
  v718 = v3;
  v719 = @"QueueClientRequestBefore1st";
  v236 = [NSDictionary dictionaryWithObjects:&v719 forKeys:&v718 count:1];
  v737[8] = v236;
  v736[9] = @"ClientClosed";
  v716 = v3;
  v717 = @"RemoveQueuedClient";
  v235 = [NSDictionary dictionaryWithObjects:&v717 forKeys:&v716 count:1];
  v737[9] = v235;
  v736[10] = @"PushNotificationReceived";
  v714 = v3;
  v715 = @"IgnorePushNotifications";
  v234 = [NSDictionary dictionaryWithObjects:&v715 forKeys:&v714 count:1];
  v737[10] = v234;
  v736[11] = @"SecureOperationsFinished";
  v712 = v3;
  v713 = @"ClearInProgressSecure";
  v233 = [NSDictionary dictionaryWithObjects:&v713 forKeys:&v712 count:1];
  v737[11] = v233;
  v736[12] = @"SyncedStillBefore1st";
  v710 = v3;
  v711 = v4;
  v232 = [NSDictionary dictionaryWithObjects:&v711 forKeys:&v710 count:1];
  v737[12] = v232;
  v736[13] = @"SyncedNowUnlocked";
  v708[0] = v2;
  v708[1] = v3;
  v709[0] = @"ResumingLocker";
  v709[1] = @"LoadPersistedResumeLocker";
  v231 = [NSDictionary dictionaryWithObjects:v709 forKeys:v708 count:2];
  v737[13] = v231;
  v736[14] = @"PolledNowUnlocked";
  v706[0] = v2;
  v706[1] = v3;
  v707[0] = @"ResumingLocker";
  v707[1] = @"LoadPersistedResumeLocker";
  v230 = [NSDictionary dictionaryWithObjects:v707 forKeys:v706 count:2];
  v737[14] = v230;
  v229 = [NSDictionary dictionaryWithObjects:v737 forKeys:v736 count:15];
  v777[2] = v229;
  v776[3] = @"ResumingLockerSync";
  v704[0] = @"PollForDeviceUnlocked";
  v702 = v3;
  v703 = v4;
  v228 = [NSDictionary dictionaryWithObjects:&v703 forKeys:&v702 count:1];
  v705[0] = v228;
  v704[1] = @"LockerResumed";
  v700 = v2;
  v701 = @"AwaitingSync";
  v227 = [NSDictionary dictionaryWithObjects:&v701 forKeys:&v700 count:1];
  v705[1] = v227;
  v704[2] = @"DownloadManagerSyncSkipped";
  v698 = v2;
  v699 = @"ResumingLocker";
  v226 = [NSDictionary dictionaryWithObjects:&v699 forKeys:&v698 count:1];
  v705[2] = v226;
  v704[3] = @"DownloadManagerSynced";
  v696[0] = v2;
  v696[1] = v3;
  v697[0] = @"ResumingLocker";
  v697[1] = @"Synced";
  v225 = [NSDictionary dictionaryWithObjects:v697 forKeys:v696 count:2];
  v705[3] = v225;
  v704[4] = @"DownloadCatalogFinished";
  v694 = v3;
  v695 = @"QueueDownloadManager";
  v224 = [NSDictionary dictionaryWithObjects:&v695 forKeys:&v694 count:1];
  v705[4] = v224;
  v704[5] = @"DownloadConfigFinished";
  v692 = v3;
  v693 = @"QueueDownloadManager";
  v223 = [NSDictionary dictionaryWithObjects:&v693 forKeys:&v692 count:1];
  v705[5] = v223;
  v704[6] = @"DownloadAssetFinished";
  v690 = v3;
  v691 = @"QueueDownloadManager";
  v222 = [NSDictionary dictionaryWithObjects:&v691 forKeys:&v690 count:1];
  v705[6] = v222;
  v704[7] = @"TimeoutAwaitingSynced";
  v688[0] = v2;
  v688[1] = v3;
  v689[0] = @"ResumingLocker";
  v689[1] = @"SyncInFlightDownloads";
  v221 = [NSDictionary dictionaryWithObjects:v689 forKeys:v688 count:2];
  v705[7] = v221;
  v704[8] = @"TimeoutClientQueued";
  v686 = v3;
  v687 = @"FailClientTimedOut";
  v220 = [NSDictionary dictionaryWithObjects:&v687 forKeys:&v686 count:1];
  v705[8] = v220;
  v704[9] = @"ClientRequest";
  v684 = v3;
  v685 = @"QueueClientRequest";
  v219 = [NSDictionary dictionaryWithObjects:&v685 forKeys:&v684 count:1];
  v705[9] = v219;
  v704[10] = @"ClientClosed";
  v682 = v3;
  v683 = @"RemoveQueuedClient";
  v218 = [NSDictionary dictionaryWithObjects:&v683 forKeys:&v682 count:1];
  v705[10] = v218;
  v704[11] = @"PushNotificationReceived";
  v680 = v3;
  v681 = @"IgnorePushNotifications";
  v217 = [NSDictionary dictionaryWithObjects:&v681 forKeys:&v680 count:1];
  v705[11] = v217;
  v704[12] = @"SecureOperationsFinished";
  v678 = v3;
  v679 = @"ClearInProgressSecure";
  v216 = [NSDictionary dictionaryWithObjects:&v679 forKeys:&v678 count:1];
  v705[12] = v216;
  v215 = [NSDictionary dictionaryWithObjects:v705 forKeys:v704 count:13];
  v777[3] = v215;
  v776[4] = @"ResumingLocker";
  v676[0] = @"PollForDeviceUnlocked";
  v674 = v3;
  v675 = v4;
  v214 = [NSDictionary dictionaryWithObjects:&v675 forKeys:&v674 count:1];
  v677[0] = v214;
  v676[1] = @"LockerResumed";
  v672[0] = v2;
  v672[1] = v3;
  v673[0] = @"ResumingStager";
  v673[1] = @"ResumeStager";
  v213 = [NSDictionary dictionaryWithObjects:v673 forKeys:v672 count:2];
  v677[1] = v213;
  v676[2] = @"DownloadManagerSyncSkipped";
  v670 = v3;
  v671 = v4;
  v212 = [NSDictionary dictionaryWithObjects:&v671 forKeys:&v670 count:1];
  v677[2] = v212;
  v676[3] = @"DownloadManagerSynced";
  v668 = v3;
  v669 = @"AdditionalSynced";
  v211 = [NSDictionary dictionaryWithObjects:&v669 forKeys:&v668 count:1];
  v677[3] = v211;
  v676[4] = @"DownloadCatalogFinished";
  v666 = v3;
  v667 = @"QueueDownloadManager";
  v210 = [NSDictionary dictionaryWithObjects:&v667 forKeys:&v666 count:1];
  v677[4] = v210;
  v676[5] = @"DownloadConfigFinished";
  v664 = v3;
  v665 = @"QueueDownloadManager";
  v209 = [NSDictionary dictionaryWithObjects:&v665 forKeys:&v664 count:1];
  v677[5] = v209;
  v676[6] = @"DownloadAssetFinished";
  v662 = v3;
  v663 = @"QueueDownloadManager";
  v208 = [NSDictionary dictionaryWithObjects:&v663 forKeys:&v662 count:1];
  v677[6] = v208;
  v676[7] = @"TimeoutAwaitingSynced";
  v660 = v3;
  v661 = v4;
  v207 = [NSDictionary dictionaryWithObjects:&v661 forKeys:&v660 count:1];
  v677[7] = v207;
  v676[8] = @"TimeoutClientQueued";
  v658 = v3;
  v659 = @"FailClientTimedOut";
  v206 = [NSDictionary dictionaryWithObjects:&v659 forKeys:&v658 count:1];
  v677[8] = v206;
  v676[9] = @"ClientRequest";
  v656 = v3;
  v657 = @"QueueClientRequest";
  v205 = [NSDictionary dictionaryWithObjects:&v657 forKeys:&v656 count:1];
  v677[9] = v205;
  v676[10] = @"ClientClosed";
  v654 = v3;
  v655 = @"RemoveQueuedClient";
  v204 = [NSDictionary dictionaryWithObjects:&v655 forKeys:&v654 count:1];
  v677[10] = v204;
  v676[11] = @"PushNotificationReceived";
  v652 = v3;
  v653 = @"IgnorePushNotifications";
  v203 = [NSDictionary dictionaryWithObjects:&v653 forKeys:&v652 count:1];
  v677[11] = v203;
  v676[12] = @"SecureOperationsFinished";
  v650 = v3;
  v651 = @"ClearInProgressSecure";
  v202 = [NSDictionary dictionaryWithObjects:&v651 forKeys:&v650 count:1];
  v677[12] = v202;
  v201 = [NSDictionary dictionaryWithObjects:v677 forKeys:v676 count:13];
  v777[4] = v201;
  v776[5] = @"AwaitingSync";
  v648[0] = @"PollForDeviceUnlocked";
  v646 = v3;
  v647 = v4;
  v200 = [NSDictionary dictionaryWithObjects:&v647 forKeys:&v646 count:1];
  v649[0] = v200;
  v648[1] = @"DownloadManagerSyncSkipped";
  v644[0] = v2;
  v644[1] = v3;
  v645[0] = @"ResumingStager";
  v645[1] = @"ResumeStager";
  v199 = [NSDictionary dictionaryWithObjects:v645 forKeys:v644 count:2];
  v649[1] = v199;
  v648[2] = @"DownloadManagerSynced";
  v642[0] = v2;
  v642[1] = v3;
  v643[0] = @"ResumingStager";
  v643[1] = @"SyncedResumeStager";
  v198 = [NSDictionary dictionaryWithObjects:v643 forKeys:v642 count:2];
  v649[2] = v198;
  v648[3] = @"DownloadCatalogFinished";
  v640 = v3;
  v641 = @"QueueDownloadManager";
  v197 = [NSDictionary dictionaryWithObjects:&v641 forKeys:&v640 count:1];
  v649[3] = v197;
  v648[4] = @"DownloadConfigFinished";
  v638 = v3;
  v639 = @"QueueDownloadManager";
  v196 = [NSDictionary dictionaryWithObjects:&v639 forKeys:&v638 count:1];
  v649[4] = v196;
  v648[5] = @"DownloadAssetFinished";
  v636 = v3;
  v637 = @"QueueDownloadManager";
  v195 = [NSDictionary dictionaryWithObjects:&v637 forKeys:&v636 count:1];
  v649[5] = v195;
  v648[6] = @"TimeoutAwaitingSynced";
  v634[0] = v2;
  v634[1] = v3;
  v635[0] = @"ResumingStager";
  v635[1] = @"ResumeStager";
  v194 = [NSDictionary dictionaryWithObjects:v635 forKeys:v634 count:2];
  v649[6] = v194;
  v648[7] = @"TimeoutClientQueued";
  v632 = v3;
  v633 = @"FailClientTimedOut";
  v193 = [NSDictionary dictionaryWithObjects:&v633 forKeys:&v632 count:1];
  v649[7] = v193;
  v648[8] = @"ClientRequest";
  v630 = v3;
  v631 = @"QueueClientRequest";
  v192 = [NSDictionary dictionaryWithObjects:&v631 forKeys:&v630 count:1];
  v649[8] = v192;
  v648[9] = @"ClientClosed";
  v628 = v3;
  v629 = @"RemoveQueuedClient";
  v191 = [NSDictionary dictionaryWithObjects:&v629 forKeys:&v628 count:1];
  v649[9] = v191;
  v648[10] = @"PushNotificationReceived";
  v626 = v3;
  v627 = @"IgnorePushNotifications";
  v190 = [NSDictionary dictionaryWithObjects:&v627 forKeys:&v626 count:1];
  v649[10] = v190;
  v648[11] = @"SecureOperationsFinished";
  v624 = v3;
  v625 = @"ClearInProgressSecure";
  v189 = [NSDictionary dictionaryWithObjects:&v625 forKeys:&v624 count:1];
  v649[11] = v189;
  v188 = [NSDictionary dictionaryWithObjects:v649 forKeys:v648 count:12];
  v777[5] = v188;
  v776[6] = @"ResumingStager";
  v622[0] = @"PollForDeviceUnlocked";
  v620 = v3;
  v621 = v4;
  v187 = [NSDictionary dictionaryWithObjects:&v621 forKeys:&v620 count:1];
  v623[0] = v187;
  v622[1] = @"StagerResumed";
  v618[0] = v2;
  v618[1] = v3;
  v619[0] = @"MigratingAssets";
  v619[1] = @"PromoteStagedMigrate";
  v186 = [NSDictionary dictionaryWithObjects:v619 forKeys:v618 count:2];
  v623[1] = v186;
  v622[2] = @"DownloadManagerSyncSkipped";
  v616 = v3;
  v617 = v4;
  v185 = [NSDictionary dictionaryWithObjects:&v617 forKeys:&v616 count:1];
  v623[2] = v185;
  v622[3] = @"DownloadManagerSynced";
  v614 = v3;
  v615 = @"AdditionalSynced";
  v184 = [NSDictionary dictionaryWithObjects:&v615 forKeys:&v614 count:1];
  v623[3] = v184;
  v622[4] = @"DownloadCatalogFinished";
  v612 = v3;
  v613 = @"QueueDownloadManager";
  v183 = [NSDictionary dictionaryWithObjects:&v613 forKeys:&v612 count:1];
  v623[4] = v183;
  v622[5] = @"DownloadConfigFinished";
  v610 = v3;
  v611 = @"QueueDownloadManager";
  v182 = [NSDictionary dictionaryWithObjects:&v611 forKeys:&v610 count:1];
  v623[5] = v182;
  v622[6] = @"DownloadAssetFinished";
  v608 = v3;
  v609 = @"QueueDownloadManager";
  v181 = [NSDictionary dictionaryWithObjects:&v609 forKeys:&v608 count:1];
  v623[6] = v181;
  v622[7] = @"TimeoutAwaitingSynced";
  v606 = v3;
  v607 = v4;
  v180 = [NSDictionary dictionaryWithObjects:&v607 forKeys:&v606 count:1];
  v623[7] = v180;
  v622[8] = @"TimeoutClientQueued";
  v604 = v3;
  v605 = @"FailClientTimedOut";
  v179 = [NSDictionary dictionaryWithObjects:&v605 forKeys:&v604 count:1];
  v623[8] = v179;
  v622[9] = @"ClientRequest";
  v602 = v3;
  v603 = @"QueueClientRequest";
  v178 = [NSDictionary dictionaryWithObjects:&v603 forKeys:&v602 count:1];
  v623[9] = v178;
  v622[10] = @"ClientClosed";
  v600 = v3;
  v601 = @"RemoveQueuedClient";
  v177 = [NSDictionary dictionaryWithObjects:&v601 forKeys:&v600 count:1];
  v623[10] = v177;
  v622[11] = @"PushNotificationReceived";
  v598 = v3;
  v599 = @"IgnorePushNotifications";
  v176 = [NSDictionary dictionaryWithObjects:&v599 forKeys:&v598 count:1];
  v623[11] = v176;
  v622[12] = @"SecureOperationsFinished";
  v596 = v3;
  v597 = @"ClearInProgressSecure";
  v175 = [NSDictionary dictionaryWithObjects:&v597 forKeys:&v596 count:1];
  v623[12] = v175;
  v174 = [NSDictionary dictionaryWithObjects:v623 forKeys:v622 count:13];
  v777[6] = v174;
  v776[7] = @"MigratingAssets";
  v594[0] = @"PollForDeviceUnlocked";
  v592 = v3;
  v593 = v4;
  v173 = [NSDictionary dictionaryWithObjects:&v593 forKeys:&v592 count:1];
  v595[0] = v173;
  v594[1] = @"MigratedAssets";
  v590 = v3;
  v591 = @"DecideNeedPersonalize";
  v172 = [NSDictionary dictionaryWithObjects:&v591 forKeys:&v590 count:1];
  v595[1] = v172;
  v594[2] = @"DownloadManagerSyncSkipped";
  v588 = v3;
  v589 = v4;
  v171 = [NSDictionary dictionaryWithObjects:&v589 forKeys:&v588 count:1];
  v595[2] = v171;
  v594[3] = @"DownloadManagerSynced";
  v586 = v3;
  v587 = @"AdditionalSynced";
  v170 = [NSDictionary dictionaryWithObjects:&v587 forKeys:&v586 count:1];
  v595[3] = v170;
  v594[4] = @"DownloadCatalogFinished";
  v584 = v3;
  v585 = @"QueueDownloadManager";
  v169 = [NSDictionary dictionaryWithObjects:&v585 forKeys:&v584 count:1];
  v595[4] = v169;
  v594[5] = @"DownloadConfigFinished";
  v582 = v3;
  v583 = @"QueueDownloadManager";
  v168 = [NSDictionary dictionaryWithObjects:&v583 forKeys:&v582 count:1];
  v595[5] = v168;
  v594[6] = @"DownloadAssetFinished";
  v580 = v3;
  v581 = @"QueueDownloadManager";
  v167 = [NSDictionary dictionaryWithObjects:&v581 forKeys:&v580 count:1];
  v595[6] = v167;
  v594[7] = @"TimeoutAwaitingSynced";
  v578 = v3;
  v579 = v4;
  v166 = [NSDictionary dictionaryWithObjects:&v579 forKeys:&v578 count:1];
  v595[7] = v166;
  v594[8] = @"TimeoutClientQueued";
  v576 = v3;
  v577 = @"FailClientTimedOut";
  v165 = [NSDictionary dictionaryWithObjects:&v577 forKeys:&v576 count:1];
  v595[8] = v165;
  v594[9] = @"ClientRequest";
  v574 = v3;
  v575 = @"QueueClientRequest";
  v164 = [NSDictionary dictionaryWithObjects:&v575 forKeys:&v574 count:1];
  v595[9] = v164;
  v594[10] = @"ClientClosed";
  v572 = v3;
  v573 = @"RemoveQueuedClient";
  v163 = [NSDictionary dictionaryWithObjects:&v573 forKeys:&v572 count:1];
  v595[10] = v163;
  v594[11] = @"JobObtainLookupGrant";
  v570 = v3;
  v571 = @"ObtainLookupGrant";
  v162 = [NSDictionary dictionaryWithObjects:&v571 forKeys:&v570 count:1];
  v595[11] = v162;
  v594[12] = @"JobReleaseLookupGrant";
  v568 = v3;
  v569 = @"ReleaseLookupGrant";
  v161 = [NSDictionary dictionaryWithObjects:&v569 forKeys:&v568 count:1];
  v595[12] = v161;
  v594[13] = @"JobAssignPersistedState";
  v566 = v3;
  v567 = @"ProvidePersistedForJob";
  v160 = [NSDictionary dictionaryWithObjects:&v567 forKeys:&v566 count:1];
  v595[13] = v160;
  v594[14] = @"JobSetLookupResponseReceived";
  v564 = v3;
  v565 = @"SetJobLookupResponseRcvd";
  v159 = [NSDictionary dictionaryWithObjects:&v565 forKeys:&v564 count:1];
  v595[14] = v159;
  v594[15] = @"JobIssueClientReply";
  v562 = v3;
  v563 = @"IssueClientReplyJobResponse";
  v158 = [NSDictionary dictionaryWithObjects:&v563 forKeys:&v562 count:1];
  v595[15] = v158;
  v594[16] = @"JobFinished";
  v560 = v3;
  v561 = @"RemoveFinishedJob";
  v157 = [NSDictionary dictionaryWithObjects:&v561 forKeys:&v560 count:1];
  v595[16] = v157;
  v594[17] = @"SetJobIssueClientReply";
  v558 = v3;
  v559 = @"IssueClientReplySetJob";
  v156 = [NSDictionary dictionaryWithObjects:&v559 forKeys:&v558 count:1];
  v595[17] = v156;
  v594[18] = @"SetJobSchedulerFoundSame";
  v556 = v3;
  v557 = v4;
  v155 = [NSDictionary dictionaryWithObjects:&v557 forKeys:&v556 count:1];
  v595[18] = v155;
  v594[19] = @"SetJobSchedulerDownloaded";
  v554 = v3;
  v555 = v4;
  v154 = [NSDictionary dictionaryWithObjects:&v555 forKeys:&v554 count:1];
  v595[19] = v154;
  v594[20] = @"PushNotificationReceived";
  v552 = v3;
  v553 = @"IgnorePushNotifications";
  v153 = [NSDictionary dictionaryWithObjects:&v553 forKeys:&v552 count:1];
  v595[20] = v153;
  v594[21] = @"SecureOperationsFinished";
  v550 = v3;
  v551 = @"ClearInProgressSecure";
  v152 = [NSDictionary dictionaryWithObjects:&v551 forKeys:&v550 count:1];
  v595[21] = v152;
  v594[22] = @"StagerAlreadyDownloaded";
  v548 = v3;
  v549 = @"StagerAlreadyDownloaded";
  v151 = [NSDictionary dictionaryWithObjects:&v549 forKeys:&v548 count:1];
  v595[22] = v151;
  v594[23] = @"StagerStartDetermine";
  v546 = v3;
  v547 = @"StagerJobStartDetermine";
  v150 = [NSDictionary dictionaryWithObjects:&v547 forKeys:&v546 count:1];
  v595[23] = v150;
  v594[24] = @"StagerStartDownload";
  v544 = v3;
  v545 = @"StagerJobStartDownload";
  v149 = [NSDictionary dictionaryWithObjects:&v545 forKeys:&v544 count:1];
  v595[24] = v149;
  v594[25] = @"StagerDetermineDone";
  v542 = v3;
  v543 = @"StagerJobDoneDetermine";
  v148 = [NSDictionary dictionaryWithObjects:&v543 forKeys:&v542 count:1];
  v595[25] = v148;
  v594[26] = @"StagerDownloadDone";
  v540 = v3;
  v541 = @"StagerJobDoneDownload";
  v147 = [NSDictionary dictionaryWithObjects:&v541 forKeys:&v540 count:1];
  v595[26] = v147;
  v594[27] = @"StagerPurgeStagedContent";
  v538 = v3;
  v539 = @"StagerRemoveAllNotPromoted";
  v146 = [NSDictionary dictionaryWithObjects:&v539 forKeys:&v538 count:1];
  v595[27] = v146;
  v594[28] = @"HaveNeedingPersonalize";
  v536[0] = v2;
  v536[1] = v3;
  v537[0] = @"ResumingPersonalizing";
  v537[1] = @"AttemptNextPersonalize";
  v145 = [NSDictionary dictionaryWithObjects:v537 forKeys:v536 count:2];
  v595[28] = v145;
  v594[29] = @"HaveNeedingGraft";
  v534[0] = v2;
  v534[1] = v3;
  v535[0] = @"ResumingGrafting";
  v535[1] = @"AttemptNextGraft";
  v144 = [NSDictionary dictionaryWithObjects:v535 forKeys:v534 count:2];
  v595[29] = v144;
  v594[30] = @"NoneNeedingPersonalize";
  v532[0] = v2;
  v532[1] = v3;
  v533[0] = @"ResumingScheduler";
  v533[1] = @"ResumeScheduler";
  v143 = [NSDictionary dictionaryWithObjects:v533 forKeys:v532 count:2];
  v595[30] = v143;
  v142 = [NSDictionary dictionaryWithObjects:v595 forKeys:v594 count:31];
  v777[7] = v142;
  v776[8] = @"ResumingPersonalizing";
  v530[0] = @"PollForDeviceUnlocked";
  v528 = v3;
  v529 = v4;
  v141 = [NSDictionary dictionaryWithObjects:&v529 forKeys:&v528 count:1];
  v531[0] = v141;
  v530[1] = @"DownloadManagerSyncSkipped";
  v526 = v3;
  v527 = v4;
  v140 = [NSDictionary dictionaryWithObjects:&v527 forKeys:&v526 count:1];
  v531[1] = v140;
  v530[2] = @"DownloadManagerSynced";
  v524 = v3;
  v525 = @"AdditionalSynced";
  v139 = [NSDictionary dictionaryWithObjects:&v525 forKeys:&v524 count:1];
  v531[2] = v139;
  v530[3] = @"DownloadCatalogFinished";
  v522 = v3;
  v523 = @"QueueDownloadManager";
  v138 = [NSDictionary dictionaryWithObjects:&v523 forKeys:&v522 count:1];
  v531[3] = v138;
  v530[4] = @"DownloadConfigFinished";
  v520 = v3;
  v521 = @"QueueDownloadManager";
  v137 = [NSDictionary dictionaryWithObjects:&v521 forKeys:&v520 count:1];
  v531[4] = v137;
  v530[5] = @"DownloadAssetFinished";
  v518 = v3;
  v519 = @"QueueDownloadManager";
  v136 = [NSDictionary dictionaryWithObjects:&v519 forKeys:&v518 count:1];
  v531[5] = v136;
  v530[6] = @"TimeoutAwaitingSynced";
  v516 = v3;
  v517 = v4;
  v135 = [NSDictionary dictionaryWithObjects:&v517 forKeys:&v516 count:1];
  v531[6] = v135;
  v530[7] = @"TimeoutClientQueued";
  v514 = v3;
  v515 = @"FailClientTimedOut";
  v134 = [NSDictionary dictionaryWithObjects:&v515 forKeys:&v514 count:1];
  v531[7] = v134;
  v530[8] = @"ClientRequest";
  v512 = v3;
  v513 = @"QueueClientRequest";
  v133 = [NSDictionary dictionaryWithObjects:&v513 forKeys:&v512 count:1];
  v531[8] = v133;
  v530[9] = @"ClientClosed";
  v510 = v3;
  v511 = @"RemoveQueuedClient";
  v132 = [NSDictionary dictionaryWithObjects:&v511 forKeys:&v510 count:1];
  v531[9] = v132;
  v530[10] = @"JobObtainLookupGrant";
  v508 = v3;
  v509 = @"ObtainLookupGrant";
  v131 = [NSDictionary dictionaryWithObjects:&v509 forKeys:&v508 count:1];
  v531[10] = v131;
  v530[11] = @"JobReleaseLookupGrant";
  v506 = v3;
  v507 = @"ReleaseLookupGrant";
  v130 = [NSDictionary dictionaryWithObjects:&v507 forKeys:&v506 count:1];
  v531[11] = v130;
  v530[12] = @"JobAssignPersistedState";
  v504 = v3;
  v505 = @"ProvidePersistedForJob";
  v129 = [NSDictionary dictionaryWithObjects:&v505 forKeys:&v504 count:1];
  v531[12] = v129;
  v530[13] = @"JobSetLookupResponseReceived";
  v502 = v3;
  v503 = @"SetJobLookupResponseRcvd";
  v128 = [NSDictionary dictionaryWithObjects:&v503 forKeys:&v502 count:1];
  v531[13] = v128;
  v530[14] = @"JobIssueClientReply";
  v500 = v3;
  v501 = @"IssueClientReplyJobResponse";
  v127 = [NSDictionary dictionaryWithObjects:&v501 forKeys:&v500 count:1];
  v531[14] = v127;
  v530[15] = @"JobFinished";
  v498 = v3;
  v499 = @"RemoveFinishedJob";
  v126 = [NSDictionary dictionaryWithObjects:&v499 forKeys:&v498 count:1];
  v531[15] = v126;
  v530[16] = @"SetJobIssueClientReply";
  v496 = v3;
  v497 = @"IssueClientReplySetJob";
  v125 = [NSDictionary dictionaryWithObjects:&v497 forKeys:&v496 count:1];
  v531[16] = v125;
  v530[17] = @"SetJobSchedulerFoundSame";
  v494 = v3;
  v495 = v4;
  v124 = [NSDictionary dictionaryWithObjects:&v495 forKeys:&v494 count:1];
  v531[17] = v124;
  v530[18] = @"SetJobSchedulerDownloaded";
  v492 = v3;
  v493 = v4;
  v123 = [NSDictionary dictionaryWithObjects:&v493 forKeys:&v492 count:1];
  v531[18] = v123;
  v530[19] = @"PushNotificationReceived";
  v490 = v3;
  v491 = @"IgnorePushNotifications";
  v122 = [NSDictionary dictionaryWithObjects:&v491 forKeys:&v490 count:1];
  v531[19] = v122;
  v530[20] = @"SecureOperationsFinished";
  v488 = v3;
  v489 = @"ClearInProgressSecure";
  v121 = [NSDictionary dictionaryWithObjects:&v489 forKeys:&v488 count:1];
  v531[20] = v121;
  v530[21] = @"StartupPersonalizeSuccess";
  v486 = v3;
  v487 = @"PersonalizeSuccessDecideMore";
  v120 = [NSDictionary dictionaryWithObjects:&v487 forKeys:&v486 count:1];
  v531[21] = v120;
  v530[22] = @"StartupPersonalizeFailed";
  v484 = v3;
  v485 = @"PersonalizeFailureDecideMore";
  v119 = [NSDictionary dictionaryWithObjects:&v485 forKeys:&v484 count:1];
  v531[22] = v119;
  v530[23] = @"StagerAlreadyDownloaded";
  v482 = v3;
  v483 = @"StagerAlreadyDownloaded";
  v118 = [NSDictionary dictionaryWithObjects:&v483 forKeys:&v482 count:1];
  v531[23] = v118;
  v530[24] = @"StagerStartDetermine";
  v480 = v3;
  v481 = @"StagerJobStartDetermine";
  v117 = [NSDictionary dictionaryWithObjects:&v481 forKeys:&v480 count:1];
  v531[24] = v117;
  v530[25] = @"StagerStartDownload";
  v478 = v3;
  v479 = @"StagerJobStartDownload";
  v116 = [NSDictionary dictionaryWithObjects:&v479 forKeys:&v478 count:1];
  v531[25] = v116;
  v530[26] = @"StagerDetermineDone";
  v476 = v3;
  v477 = @"StagerJobDoneDetermine";
  v115 = [NSDictionary dictionaryWithObjects:&v477 forKeys:&v476 count:1];
  v531[26] = v115;
  v530[27] = @"StagerDownloadDone";
  v474 = v3;
  v475 = @"StagerJobDoneDownload";
  v114 = [NSDictionary dictionaryWithObjects:&v475 forKeys:&v474 count:1];
  v531[27] = v114;
  v530[28] = @"StagerPurgeStagedContent";
  v472 = v3;
  v473 = @"StagerRemoveAllNotPromoted";
  v113 = [NSDictionary dictionaryWithObjects:&v473 forKeys:&v472 count:1];
  v531[28] = v113;
  v530[29] = @"HaveNeedingPersonalize";
  v470 = v3;
  v471 = @"AttemptNextPersonalize";
  v112 = [NSDictionary dictionaryWithObjects:&v471 forKeys:&v470 count:1];
  v531[29] = v112;
  v530[30] = @"NoneNeedingPersonalize";
  v468 = v3;
  v469 = @"DecideNeedGraft";
  v111 = [NSDictionary dictionaryWithObjects:&v469 forKeys:&v468 count:1];
  v531[30] = v111;
  v530[31] = @"HaveNeedingGraft";
  v466[0] = v2;
  v466[1] = v3;
  v467[0] = @"ResumingGrafting";
  v467[1] = @"AttemptNextGraft";
  v110 = [NSDictionary dictionaryWithObjects:v467 forKeys:v466 count:2];
  v531[31] = v110;
  v530[32] = @"NoneNeedingGraft";
  v464[0] = v2;
  v464[1] = v3;
  v465[0] = @"ResumingScheduler";
  v465[1] = @"ResumeScheduler";
  v109 = [NSDictionary dictionaryWithObjects:v465 forKeys:v464 count:2];
  v531[32] = v109;
  v108 = [NSDictionary dictionaryWithObjects:v531 forKeys:v530 count:33];
  v777[8] = v108;
  v776[9] = @"ResumingGrafting";
  v462[0] = @"PollForDeviceUnlocked";
  v460 = v3;
  v461 = v4;
  v107 = [NSDictionary dictionaryWithObjects:&v461 forKeys:&v460 count:1];
  v463[0] = v107;
  v462[1] = @"DownloadManagerSyncSkipped";
  v458 = v3;
  v459 = v4;
  v106 = [NSDictionary dictionaryWithObjects:&v459 forKeys:&v458 count:1];
  v463[1] = v106;
  v462[2] = @"DownloadManagerSynced";
  v456 = v3;
  v457 = @"AdditionalSynced";
  v105 = [NSDictionary dictionaryWithObjects:&v457 forKeys:&v456 count:1];
  v463[2] = v105;
  v462[3] = @"DownloadCatalogFinished";
  v454 = v3;
  v455 = @"QueueDownloadManager";
  v104 = [NSDictionary dictionaryWithObjects:&v455 forKeys:&v454 count:1];
  v463[3] = v104;
  v462[4] = @"DownloadConfigFinished";
  v452 = v3;
  v453 = @"QueueDownloadManager";
  v103 = [NSDictionary dictionaryWithObjects:&v453 forKeys:&v452 count:1];
  v463[4] = v103;
  v462[5] = @"DownloadAssetFinished";
  v450 = v3;
  v451 = @"QueueDownloadManager";
  v102 = [NSDictionary dictionaryWithObjects:&v451 forKeys:&v450 count:1];
  v463[5] = v102;
  v462[6] = @"TimeoutAwaitingSynced";
  v448 = v3;
  v449 = v4;
  v101 = [NSDictionary dictionaryWithObjects:&v449 forKeys:&v448 count:1];
  v463[6] = v101;
  v462[7] = @"TimeoutClientQueued";
  v446 = v3;
  v447 = @"FailClientTimedOut";
  v100 = [NSDictionary dictionaryWithObjects:&v447 forKeys:&v446 count:1];
  v463[7] = v100;
  v462[8] = @"ClientRequest";
  v444 = v3;
  v445 = @"QueueClientRequest";
  v99 = [NSDictionary dictionaryWithObjects:&v445 forKeys:&v444 count:1];
  v463[8] = v99;
  v462[9] = @"ClientClosed";
  v442 = v3;
  v443 = @"RemoveQueuedClient";
  v98 = [NSDictionary dictionaryWithObjects:&v443 forKeys:&v442 count:1];
  v463[9] = v98;
  v462[10] = @"JobObtainLookupGrant";
  v440 = v3;
  v441 = @"ObtainLookupGrant";
  v97 = [NSDictionary dictionaryWithObjects:&v441 forKeys:&v440 count:1];
  v463[10] = v97;
  v462[11] = @"JobReleaseLookupGrant";
  v438 = v3;
  v439 = @"ReleaseLookupGrant";
  v96 = [NSDictionary dictionaryWithObjects:&v439 forKeys:&v438 count:1];
  v463[11] = v96;
  v462[12] = @"JobAssignPersistedState";
  v436 = v3;
  v437 = @"ProvidePersistedForJob";
  v95 = [NSDictionary dictionaryWithObjects:&v437 forKeys:&v436 count:1];
  v463[12] = v95;
  v462[13] = @"JobSetLookupResponseReceived";
  v434 = v3;
  v435 = @"SetJobLookupResponseRcvd";
  v94 = [NSDictionary dictionaryWithObjects:&v435 forKeys:&v434 count:1];
  v463[13] = v94;
  v462[14] = @"JobIssueClientReply";
  v432 = v3;
  v433 = @"IssueClientReplyJobResponse";
  v93 = [NSDictionary dictionaryWithObjects:&v433 forKeys:&v432 count:1];
  v463[14] = v93;
  v462[15] = @"JobFinished";
  v430 = v3;
  v431 = @"RemoveFinishedJob";
  v92 = [NSDictionary dictionaryWithObjects:&v431 forKeys:&v430 count:1];
  v463[15] = v92;
  v462[16] = @"SetJobIssueClientReply";
  v428 = v3;
  v429 = @"IssueClientReplySetJob";
  v91 = [NSDictionary dictionaryWithObjects:&v429 forKeys:&v428 count:1];
  v463[16] = v91;
  v462[17] = @"SetJobSchedulerFoundSame";
  v426 = v3;
  v427 = v4;
  v90 = [NSDictionary dictionaryWithObjects:&v427 forKeys:&v426 count:1];
  v463[17] = v90;
  v462[18] = @"SetJobSchedulerDownloaded";
  v424 = v3;
  v425 = v4;
  v89 = [NSDictionary dictionaryWithObjects:&v425 forKeys:&v424 count:1];
  v463[18] = v89;
  v462[19] = @"PushNotificationReceived";
  v422 = v3;
  v423 = @"IgnorePushNotifications";
  v88 = [NSDictionary dictionaryWithObjects:&v423 forKeys:&v422 count:1];
  v463[19] = v88;
  v462[20] = @"SecureOperationsFinished";
  v420 = v3;
  v421 = @"ClearInProgressSecure";
  v87 = [NSDictionary dictionaryWithObjects:&v421 forKeys:&v420 count:1];
  v463[20] = v87;
  v462[21] = @"StartupGraftSuccess";
  v418 = v3;
  v419 = @"GraftSuccessDecideMore";
  v86 = [NSDictionary dictionaryWithObjects:&v419 forKeys:&v418 count:1];
  v463[21] = v86;
  v462[22] = @"StartupGraftFailed";
  v416 = v3;
  v417 = @"GraftFailureDecideMore";
  v85 = [NSDictionary dictionaryWithObjects:&v417 forKeys:&v416 count:1];
  v463[22] = v85;
  v462[23] = @"StagerAlreadyDownloaded";
  v414 = v3;
  v415 = @"StagerAlreadyDownloaded";
  v84 = [NSDictionary dictionaryWithObjects:&v415 forKeys:&v414 count:1];
  v463[23] = v84;
  v462[24] = @"StagerStartDetermine";
  v412 = v3;
  v413 = @"StagerJobStartDetermine";
  v83 = [NSDictionary dictionaryWithObjects:&v413 forKeys:&v412 count:1];
  v463[24] = v83;
  v462[25] = @"StagerStartDownload";
  v410 = v3;
  v411 = @"StagerJobStartDownload";
  v82 = [NSDictionary dictionaryWithObjects:&v411 forKeys:&v410 count:1];
  v463[25] = v82;
  v462[26] = @"StagerDetermineDone";
  v408 = v3;
  v409 = @"StagerJobDoneDetermine";
  v81 = [NSDictionary dictionaryWithObjects:&v409 forKeys:&v408 count:1];
  v463[26] = v81;
  v462[27] = @"StagerDownloadDone";
  v406 = v3;
  v407 = @"StagerJobDoneDownload";
  v80 = [NSDictionary dictionaryWithObjects:&v407 forKeys:&v406 count:1];
  v463[27] = v80;
  v462[28] = @"StagerPurgeStagedContent";
  v404 = v3;
  v405 = @"StagerRemoveAllNotPromoted";
  v79 = [NSDictionary dictionaryWithObjects:&v405 forKeys:&v404 count:1];
  v463[28] = v79;
  v462[29] = @"HaveNeedingGraft";
  v402 = v3;
  v403 = @"AttemptNextGraft";
  v78 = [NSDictionary dictionaryWithObjects:&v403 forKeys:&v402 count:1];
  v463[29] = v78;
  v462[30] = @"NoneNeedingGraft";
  v400[0] = v2;
  v400[1] = v3;
  v401[0] = @"ResumingScheduler";
  v401[1] = @"ResumeScheduler";
  v77 = [NSDictionary dictionaryWithObjects:v401 forKeys:v400 count:2];
  v463[30] = v77;
  v76 = [NSDictionary dictionaryWithObjects:v463 forKeys:v462 count:31];
  v777[9] = v76;
  v776[10] = @"ResumingScheduler";
  v398[0] = @"PollForDeviceUnlocked";
  v396 = v3;
  v397 = v4;
  v75 = [NSDictionary dictionaryWithObjects:&v397 forKeys:&v396 count:1];
  v399[0] = v75;
  v398[1] = @"SchedulerResumed";
  v394[0] = v2;
  v394[1] = v3;
  v395[0] = @"Active";
  v395[1] = @"ResumeJobs";
  v74 = [NSDictionary dictionaryWithObjects:v395 forKeys:v394 count:2];
  v399[1] = v74;
  v398[2] = @"DownloadManagerSyncSkipped";
  v392 = v3;
  v393 = v4;
  v73 = [NSDictionary dictionaryWithObjects:&v393 forKeys:&v392 count:1];
  v399[2] = v73;
  v398[3] = @"DownloadManagerSynced";
  v390 = v3;
  v391 = v4;
  v72 = [NSDictionary dictionaryWithObjects:&v391 forKeys:&v390 count:1];
  v399[3] = v72;
  v398[4] = @"DownloadCatalogFinished";
  v388 = v3;
  v389 = @"QueueDownloadManager";
  v71 = [NSDictionary dictionaryWithObjects:&v389 forKeys:&v388 count:1];
  v399[4] = v71;
  v398[5] = @"DownloadConfigFinished";
  v386 = v3;
  v387 = @"QueueDownloadManager";
  v70 = [NSDictionary dictionaryWithObjects:&v387 forKeys:&v386 count:1];
  v399[5] = v70;
  v398[6] = @"DownloadAssetFinished";
  v384 = v3;
  v385 = @"QueueDownloadManager";
  v69 = [NSDictionary dictionaryWithObjects:&v385 forKeys:&v384 count:1];
  v399[6] = v69;
  v398[7] = @"TimeoutAwaitingSynced";
  v382 = v3;
  v383 = v4;
  v68 = [NSDictionary dictionaryWithObjects:&v383 forKeys:&v382 count:1];
  v399[7] = v68;
  v398[8] = @"TimeoutClientQueued";
  v380 = v3;
  v381 = @"FailClientTimedOut";
  v67 = [NSDictionary dictionaryWithObjects:&v381 forKeys:&v380 count:1];
  v399[8] = v67;
  v398[9] = @"ClientRequest";
  v378 = v3;
  v379 = @"QueueClientRequest";
  v66 = [NSDictionary dictionaryWithObjects:&v379 forKeys:&v378 count:1];
  v399[9] = v66;
  v398[10] = @"ClientClosed";
  v376 = v3;
  v377 = @"RemoveQueuedClient";
  v65 = [NSDictionary dictionaryWithObjects:&v377 forKeys:&v376 count:1];
  v399[10] = v65;
  v398[11] = @"JobObtainLookupGrant";
  v374 = v3;
  v375 = @"ObtainLookupGrant";
  v64 = [NSDictionary dictionaryWithObjects:&v375 forKeys:&v374 count:1];
  v399[11] = v64;
  v398[12] = @"JobReleaseLookupGrant";
  v372 = v3;
  v373 = @"ReleaseLookupGrant";
  v63 = [NSDictionary dictionaryWithObjects:&v373 forKeys:&v372 count:1];
  v399[12] = v63;
  v398[13] = @"JobAssignPersistedState";
  v370 = v3;
  v371 = @"ProvidePersistedForJob";
  v62 = [NSDictionary dictionaryWithObjects:&v371 forKeys:&v370 count:1];
  v399[13] = v62;
  v398[14] = @"JobSetLookupResponseReceived";
  v368 = v3;
  v369 = @"SetJobLookupResponseRcvd";
  v61 = [NSDictionary dictionaryWithObjects:&v369 forKeys:&v368 count:1];
  v399[14] = v61;
  v398[15] = @"JobIssueClientReply";
  v366 = v3;
  v367 = @"IssueClientReplyJobResponse";
  v60 = [NSDictionary dictionaryWithObjects:&v367 forKeys:&v366 count:1];
  v399[15] = v60;
  v398[16] = @"JobFinished";
  v364 = v3;
  v365 = @"RemoveFinishedJob";
  v59 = [NSDictionary dictionaryWithObjects:&v365 forKeys:&v364 count:1];
  v399[16] = v59;
  v398[17] = @"SetJobIssueClientReply";
  v362 = v3;
  v363 = @"IssueClientReplySetJob";
  v58 = [NSDictionary dictionaryWithObjects:&v363 forKeys:&v362 count:1];
  v399[17] = v58;
  v398[18] = @"SetJobSchedulerFoundSame";
  v360 = v3;
  v361 = v4;
  v56 = [NSDictionary dictionaryWithObjects:&v361 forKeys:&v360 count:1];
  v399[18] = v56;
  v398[19] = @"SetJobSchedulerDownloaded";
  v358 = v3;
  v359 = v4;
  v55 = [NSDictionary dictionaryWithObjects:&v359 forKeys:&v358 count:1];
  v399[19] = v55;
  v398[20] = @"PushNotificationReceived";
  v356 = v3;
  v357 = @"IgnorePushNotifications";
  v54 = [NSDictionary dictionaryWithObjects:&v357 forKeys:&v356 count:1];
  v399[20] = v54;
  v398[21] = @"SecureOperationsFinished";
  v354 = v3;
  v355 = @"ClearInProgressSecure";
  v53 = [NSDictionary dictionaryWithObjects:&v355 forKeys:&v354 count:1];
  v399[21] = v53;
  v398[22] = @"StagerAlreadyDownloaded";
  v352 = v3;
  v353 = @"StagerAlreadyDownloaded";
  v52 = [NSDictionary dictionaryWithObjects:&v353 forKeys:&v352 count:1];
  v399[22] = v52;
  v398[23] = @"StagerStartDetermine";
  v350 = v3;
  v351 = @"StagerJobStartDetermine";
  v51 = [NSDictionary dictionaryWithObjects:&v351 forKeys:&v350 count:1];
  v399[23] = v51;
  v398[24] = @"StagerStartDownload";
  v348 = v3;
  v349 = @"StagerJobStartDownload";
  v50 = [NSDictionary dictionaryWithObjects:&v349 forKeys:&v348 count:1];
  v399[24] = v50;
  v398[25] = @"StagerDetermineDone";
  v346 = v3;
  v347 = @"StagerJobDoneDetermine";
  v49 = [NSDictionary dictionaryWithObjects:&v347 forKeys:&v346 count:1];
  v399[25] = v49;
  v398[26] = @"StagerDownloadDone";
  v344 = v3;
  v345 = @"StagerJobDoneDownload";
  v48 = [NSDictionary dictionaryWithObjects:&v345 forKeys:&v344 count:1];
  v399[26] = v48;
  v398[27] = @"StagerPurgeStagedContent";
  v342 = v3;
  v343 = @"StagerRemoveAllNotPromoted";
  v47 = [NSDictionary dictionaryWithObjects:&v343 forKeys:&v342 count:1];
  v399[27] = v47;
  v46 = [NSDictionary dictionaryWithObjects:v399 forKeys:v398 count:28];
  v777[10] = v46;
  v776[11] = @"Active";
  v340[0] = @"PollForDeviceUnlocked";
  v338 = v3;
  v339 = v4;
  v45 = [NSDictionary dictionaryWithObjects:&v339 forKeys:&v338 count:1];
  v341[0] = v45;
  v340[1] = @"DownloadManagerSyncSkipped";
  v336 = v3;
  v337 = v4;
  v44 = [NSDictionary dictionaryWithObjects:&v337 forKeys:&v336 count:1];
  v341[1] = v44;
  v340[2] = @"DownloadManagerSynced";
  v334 = v3;
  v335 = @"AdditionalSynced";
  v43 = [NSDictionary dictionaryWithObjects:&v335 forKeys:&v334 count:1];
  v341[2] = v43;
  v340[3] = @"DownloadCatalogFinished";
  v332 = v3;
  v333 = @"RouteCatalogFinished";
  v42 = [NSDictionary dictionaryWithObjects:&v333 forKeys:&v332 count:1];
  v341[3] = v42;
  v340[4] = @"DownloadConfigFinished";
  v330 = v3;
  v331 = @"RouteConfigFinished";
  v41 = [NSDictionary dictionaryWithObjects:&v331 forKeys:&v330 count:1];
  v341[4] = v41;
  v340[5] = @"DownloadAssetFinished";
  v328 = v3;
  v329 = @"RouteAssetFinished";
  v40 = [NSDictionary dictionaryWithObjects:&v329 forKeys:&v328 count:1];
  v341[5] = v40;
  v340[6] = @"TimeoutAwaitingSynced";
  v326 = v3;
  v327 = v4;
  v39 = [NSDictionary dictionaryWithObjects:&v327 forKeys:&v326 count:1];
  v341[6] = v39;
  v340[7] = @"ClientRequest";
  v324 = v3;
  v325 = @"RouteClientRequest";
  v38 = [NSDictionary dictionaryWithObjects:&v325 forKeys:&v324 count:1];
  v341[7] = v38;
  v340[8] = @"ClientClosed";
  v322 = v3;
  v323 = @"RouteClientClosed";
  v37 = [NSDictionary dictionaryWithObjects:&v323 forKeys:&v322 count:1];
  v341[8] = v37;
  v340[9] = @"JobObtainLookupGrant";
  v320 = v3;
  v321 = @"ObtainLookupGrant";
  v36 = [NSDictionary dictionaryWithObjects:&v321 forKeys:&v320 count:1];
  v341[9] = v36;
  v340[10] = @"JobReleaseLookupGrant";
  v318 = v3;
  v319 = @"ReleaseLookupGrant";
  v35 = [NSDictionary dictionaryWithObjects:&v319 forKeys:&v318 count:1];
  v341[10] = v35;
  v340[11] = @"JobAssignPersistedState";
  v316 = v3;
  v317 = @"ProvidePersistedForJob";
  v34 = [NSDictionary dictionaryWithObjects:&v317 forKeys:&v316 count:1];
  v341[11] = v34;
  v340[12] = @"JobSetLookupResponseReceived";
  v314 = v3;
  v315 = @"SetJobLookupResponseRcvd";
  v33 = [NSDictionary dictionaryWithObjects:&v315 forKeys:&v314 count:1];
  v341[12] = v33;
  v340[13] = @"JobIssueClientReply";
  v312 = v3;
  v313 = @"IssueClientReplyJobResponse";
  v32 = [NSDictionary dictionaryWithObjects:&v313 forKeys:&v312 count:1];
  v341[13] = v32;
  v340[14] = @"JobFinished";
  v310 = v3;
  v311 = @"RemoveFinishedJob";
  v31 = [NSDictionary dictionaryWithObjects:&v311 forKeys:&v310 count:1];
  v341[14] = v31;
  v340[15] = @"JobFinishedRerouteScheduled";
  v308 = v3;
  v309 = @"CoalesceLateJobScheduled";
  v30 = [NSDictionary dictionaryWithObjects:&v309 forKeys:&v308 count:1];
  v341[15] = v30;
  v340[16] = @"SetJobIssueClientReply";
  v306 = v3;
  v307 = @"IssueClientReplySetJob";
  v29 = [NSDictionary dictionaryWithObjects:&v307 forKeys:&v306 count:1];
  v341[16] = v29;
  v340[17] = @"SetJobSchedulerFoundSame";
  v304 = v3;
  v305 = @"SchedulerJobFoundSame";
  v28 = [NSDictionary dictionaryWithObjects:&v305 forKeys:&v304 count:1];
  v341[17] = v28;
  v340[18] = @"SetJobSchedulerDownloaded";
  v302 = v3;
  v303 = @"SchedulerJobDownloaded";
  v27 = [NSDictionary dictionaryWithObjects:&v303 forKeys:&v302 count:1];
  v341[18] = v27;
  v340[19] = @"SetJobFinishedRerouteScheduled";
  v300 = v3;
  v301 = @"CoalesceLateJobSetScheduled";
  v26 = [NSDictionary dictionaryWithObjects:&v301 forKeys:&v300 count:1];
  v341[19] = v26;
  v340[20] = @"SchedulerTriggered";
  v298 = v3;
  v299 = @"ScheduleJobs";
  v25 = [NSDictionary dictionaryWithObjects:&v299 forKeys:&v298 count:1];
  v341[20] = v25;
  v340[21] = @"SchedulerSetsTriggered";
  v296 = v3;
  v297 = @"ScheduleSetJobs";
  v24 = [NSDictionary dictionaryWithObjects:&v297 forKeys:&v296 count:1];
  v341[21] = v24;
  v340[22] = @"SchedulerNoActivity";
  v294 = v3;
  v295 = v4;
  v23 = [NSDictionary dictionaryWithObjects:&v295 forKeys:&v294 count:1];
  v341[22] = v23;
  v340[23] = @"SchedulerTickOccurred";
  v292 = v3;
  v293 = @"DecrementTickDriven";
  v22 = [NSDictionary dictionaryWithObjects:&v293 forKeys:&v292 count:1];
  v341[23] = v22;
  v340[24] = @"SchedulerEliminatedSelector";
  v290 = v3;
  v291 = @"EliminateSchedulerDone";
  v21 = [NSDictionary dictionaryWithObjects:&v291 forKeys:&v290 count:1];
  v341[24] = v21;
  v340[25] = @"PushNotificationReceived";
  v288 = v3;
  v289 = @"HandlePushNotifications";
  v20 = [NSDictionary dictionaryWithObjects:&v289 forKeys:&v288 count:1];
  v341[25] = v20;
  v340[26] = @"SecureOperationsFinished";
  v286 = v3;
  v287 = @"ClearInProgressSecure";
  v19 = [NSDictionary dictionaryWithObjects:&v287 forKeys:&v286 count:1];
  v341[26] = v19;
  v340[27] = @"StagerAlreadyDownloaded";
  v284 = v3;
  v285 = @"StagerAlreadyDownloaded";
  v18 = [NSDictionary dictionaryWithObjects:&v285 forKeys:&v284 count:1];
  v341[27] = v18;
  v340[28] = @"StagerStartDetermine";
  v282 = v3;
  v283 = @"StagerJobStartDetermine";
  v17 = [NSDictionary dictionaryWithObjects:&v283 forKeys:&v282 count:1];
  v341[28] = v17;
  v340[29] = @"StagerStartDownload";
  v280 = v3;
  v281 = @"StagerJobStartDownload";
  v16 = [NSDictionary dictionaryWithObjects:&v281 forKeys:&v280 count:1];
  v341[29] = v16;
  v340[30] = @"StagerDetermineDone";
  v278 = v3;
  v279 = @"StagerJobDoneDetermine";
  v5 = [NSDictionary dictionaryWithObjects:&v279 forKeys:&v278 count:1];
  v341[30] = v5;
  v340[31] = @"StagerDownloadDone";
  v276 = v3;
  v277 = @"StagerJobDoneDownload";
  v6 = [NSDictionary dictionaryWithObjects:&v277 forKeys:&v276 count:1];
  v341[31] = v6;
  v340[32] = @"StagerCancelCurrentJob";
  v274 = v3;
  v275 = @"StagerJobCancel";
  v7 = [NSDictionary dictionaryWithObjects:&v275 forKeys:&v274 count:1];
  v341[32] = v7;
  v340[33] = @"StagerEliminatedSelector";
  v272 = v3;
  v273 = @"EliminateStagerDone";
  v8 = [NSDictionary dictionaryWithObjects:&v273 forKeys:&v272 count:1];
  v341[33] = v8;
  v340[34] = @"StagerEliminatedConfiguration";
  v270 = v3;
  v271 = @"EliminateStagerSetDone";
  v9 = [NSDictionary dictionaryWithObjects:&v271 forKeys:&v270 count:1];
  v341[34] = v9;
  v340[35] = @"StagerPurgeStagedContent";
  v268 = v3;
  v269 = @"StagerRemoveAllNotPromoted";
  v10 = [NSDictionary dictionaryWithObjects:&v269 forKeys:&v268 count:1];
  v341[35] = v10;
  v340[36] = @"CancelActivityAck";
  v266 = v3;
  v267 = @"CancelActivityAck";
  v11 = [NSDictionary dictionaryWithObjects:&v267 forKeys:&v266 count:1];
  v341[36] = v11;
  v340[37] = @"InstallAssetsEvent";
  v264 = v3;
  v265 = @"InstallAssets";
  v12 = [NSDictionary dictionaryWithObjects:&v265 forKeys:&v264 count:1];
  v341[37] = v12;
  v13 = [NSDictionary dictionaryWithObjects:v341 forKeys:v340 count:38];
  v777[11] = v13;
  v57 = [NSDictionary dictionaryWithObjects:v777 forKeys:v776 count:12];

  v14 = [[NSDictionary alloc] initWithDictionary:v57 copyItems:1];

  return v14;
}

- (int64_t)performAction:(id)a3 onEvent:(id)a4 inState:(id)a5 withInfo:(id)a6 nextState:(id)a7 error:(id *)a8
{
  v11 = a3;
  v12 = a6;
  if ([v11 isEqualToString:kSUCoreFSMActionNoOp])
  {
    v13 = 0;
  }

  else
  {
    if ([v11 isEqualToString:@"StartUnlockPollingTimer"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StartUnlockPollingTimer:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"PollDecideBefore1stUnlock"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PollDecideBefore1stUnlock:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncSkippedDecideBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncSkippedDecideBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncDecideBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncDecideBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"LoadPersistedResumeLocker"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_LoadPersistedResumeLocker:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ResumeStager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeStager:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncedResumeStager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedResumeStager:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"PromoteStagedMigrate"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PromoteStagedMigrate:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ResumeScheduler"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeScheduler:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncInFlightDownloads"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncInFlightDownloads:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"Synced"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Synced:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"AdditionalSynced"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AdditionalSynced:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ResumeJobsBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeJobsBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ResumeJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeJobs:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"FailClientTimedOut"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_FailClientTimedOut:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"QueueClientRequest"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueClientRequest:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"QueueClientRequestBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueClientRequestBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RemoveQueuedClient"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RemoveQueuedClient:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RouteClientRequest"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteClientRequest:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RouteClientClosed"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteClientClosed:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"QueueDownloadManager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueDownloadManager:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RouteCatalogFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteCatalogFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RouteConfigFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteConfigFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RouteAssetFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteAssetFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"Before1stCatalogFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stCatalogFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"Before1stConfigFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stConfigFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"Before1stAssetFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stAssetFinished:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncedReviewUnlocked"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedReviewUnlocked:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SyncedReviewBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedReviewBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ObtainLookupGrant"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ObtainLookupGrant:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ReleaseLookupGrant"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ReleaseLookupGrant:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ProvidePersistedForJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ProvidePersistedForJob:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SetJobLookupResponseRcvd"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SetJobLookupResponseRcvd:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"IssueClientReplyJobResponse"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IssueClientReplyJobResponse:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"RemoveFinishedJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RemoveFinishedJob:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"CoalesceLateJobScheduled"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CoalesceLateJobScheduled:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"CoalesceLateJobSetScheduled"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CoalesceLateJobSetScheduled:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"IssueClientReplySetJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IssueClientReplySetJob:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SchedulerJobFoundSame"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SchedulerJobFoundSame:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"SchedulerJobDownloaded"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SchedulerJobDownloaded:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ScheduleJobsBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleJobsBefore1st:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ScheduleJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleJobs:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ScheduleSetJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleSetJobs:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"DecrementTickDriven"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecrementTickDriven:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"IgnorePushNotifications"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IgnorePushNotifications:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"HandlePushNotifications"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_HandlePushNotifications:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"ClearInProgressSecure"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ClearInProgressSecure:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"DecideNeedPersonalize"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecideNeedPersonalize:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"DecideNeedGraft"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecideNeedGraft:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"AttemptNextPersonalize"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AttemptNextPersonalize:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"AttemptNextGraft"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AttemptNextGraft:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"PersonalizeSuccessDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PersonalizeSuccessDecideMore:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"PersonalizeFailureDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PersonalizeFailureDecideMore:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"GraftSuccessDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_GraftSuccessDecideMore:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"GraftFailureDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_GraftFailureDecideMore:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerAlreadyDownloaded"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerAlreadyDownloaded:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerJobStartDetermine"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobStartDetermine:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerJobStartDownload"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobStartDownload:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerJobDoneDetermine"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobDoneDetermine:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerJobDoneDownload"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobDoneDownload:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerJobCancel"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobCancel:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"StagerRemoveAllNotPromoted"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerRemoveAllNotPromoted:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"EliminateSchedulerDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateSchedulerDone:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"EliminateStagerDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateStagerDone:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"EliminateStagerSetDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateStagerSetDone:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"CancelActivityAck"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CancelActivityAck:v12 error:a8];
    }

    else if ([v11 isEqualToString:@"InstallAssets"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_InstallAssets:v12 error:a8];
    }

    else
    {
      v14 = [(MADAutoAssetControlManager *)self actionUnknownAction:v11 error:a8];
    }

    v13 = v14;
  }

  return v13;
}

+ (id)autoControlManager
{
  if (autoControlManager_dispatchOnceAutoControlManager != -1)
  {
    +[MADAutoAssetControlManager autoControlManager];
  }

  v3 = autoControlManager___autoControlManager;

  return v3;
}

void __48__MADAutoAssetControlManager_autoControlManager__block_invoke(id a1)
{
  v1 = _MADLog(@"Auto");
  if (os_log_type_enabled(v1, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v1, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initializing the shared auto-control-manager | init...", buf, 2u);
  }

  v2 = objc_alloc_init(MADAutoAssetControlManager);
  v3 = autoControlManager___autoControlManager;
  autoControlManager___autoControlManager = v2;

  v4 = _MADLog(@"Auto");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initializing the shared auto-control-manager | ...init", v5, 2u);
  }
}

+ (void)shutdown
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = [v2 autoControlManagerFSM];

  v4 = _MADLog(@"AutoControl");
  v5 = os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT);
  if (v3)
  {
    if (v5)
    {
      *buf = 0;
      _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Beginning shutdown sequence for AutoAssetControlManager", buf, 2u);
    }

    v6 = [v2 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __38__MADAutoAssetControlManager_shutdown__block_invoke;
    block[3] = &unk_4B2AA0;
    v10 = v2;
    dispatch_sync(v7, block);

    v8 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown}: Shutdown sequence for AutoAssetControlManager complete", buf, 2u);
    }

    v4 = v10;
  }

  else if (v5)
  {
    *buf = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Skipping shutdown sequence since FSM not initialized", buf, 2u);
  }
}

void __38__MADAutoAssetControlManager_shutdown__block_invoke(uint64_t a1)
{
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    v2 = [*(a1 + 32) connectionServer];

    if (v2)
    {
      v3 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Suspending SUCoreConnectServer", buf, 2u);
      }

      v4 = [*(a1 + 32) connectionServer];
      [v4 suspendListenerAndInvalidate];

      [*(a1 + 32) setConnectionServer:0];
    }
  }

  v5 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    *v12 = 0;
    _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down MADAutoAssetScheduler", v12, 2u);
  }

  +[MADAutoAssetScheduler shutdown];
  v6 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down MADAutoAssetStager", v11, 2u);
  }

  +[MADAutoAssetStager shutdown];
  v7 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    *v10 = 0;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down myself. Goodbye!!", v10, 2u);
  }

  v8 = [*(a1 + 32) autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_suspend(v9);
}

- (MADAutoAssetControlManager)init
{
  v110.receiver = self;
  v110.super_class = MADAutoAssetControlManager;
  v2 = [(MADAutoAssetControlManager *)&v110 init];
  v3 = v2;
  if (v2)
  {
    [(MADAutoAssetControlManager *)v2 _initializeSUCore];
    if (__isPlatformVersionAtLeast(2, 26, 0, 0) && (objc_opt_respondsToSelector() & 1) != 0)
    {
      +[MAAutoAssetError mapAutoAssetErrorIndications];
    }

    v4 = +[NSDate date];
    [v4 timeIntervalSince1970];
    v3->_startupTimeBeginSeconds = v5;

    v3->_startupTimeDurationSeconds = -1.0;
    latestSafeSummary = v3->_latestSafeSummary;
    v3->_latestSafeSummary = @"INIT";

    persistedActiveJobs = v3->_persistedActiveJobs;
    v3->_persistedActiveJobs = 0;

    persistedKnownDescriptors = v3->_persistedKnownDescriptors;
    v3->_persistedKnownDescriptors = 0;

    v9 = [@"com.apple.MobileAsset.daemon.autoassetdispatch" UTF8String];
    v10 = dispatch_queue_attr_make_with_autorelease_frequency(0, DISPATCH_AUTORELEASE_FREQUENCY_WORK_ITEM);
    v11 = dispatch_queue_create(v9, v10);
    sharedDispatchQueue = v3->_sharedDispatchQueue;
    v3->_sharedDispatchQueue = v11;

    connectionServer = v3->_connectionServer;
    v3->_connectionServer = 0;

    serverConnectionPolicy = v3->_serverConnectionPolicy;
    v3->_serverConnectionPolicy = 0;

    v15 = objc_alloc_init(NSMutableDictionary);
    currentStatusBySelector = v3->_currentStatusBySelector;
    v3->_currentStatusBySelector = v15;

    v17 = objc_alloc_init(NSMutableDictionary);
    currentJobsBySelector = v3->_currentJobsBySelector;
    v3->_currentJobsBySelector = v17;

    v19 = objc_alloc_init(NSMutableDictionary);
    currentJobsByUUID = v3->_currentJobsByUUID;
    v3->_currentJobsByUUID = v19;

    stagedSetLookupResults = v3->_stagedSetLookupResults;
    v3->_stagedSetLookupResults = 0;

    *&v3->_stagerResumed = 0;
    stagerCurrentJob = v3->_stagerCurrentJob;
    v3->_stagerCurrentJob = 0;

    stagerBondedToAutoJob = v3->_stagerBondedToAutoJob;
    v3->_stagerBondedToAutoJob = 0;

    stagerCurrentJobUUID = v3->_stagerCurrentJobUUID;
    v3->_stagerCurrentJobUUID = 0;

    stagerFormedSetConfiguration = v3->_stagerFormedSetConfiguration;
    v3->_stagerFormedSetConfiguration = 0;

    stagerDownloadingSelector = v3->_stagerDownloadingSelector;
    v3->_stagerDownloadingSelector = 0;

    v27 = objc_alloc_init(NSMutableDictionary);
    lookupGrantsByAssetType = v3->_lookupGrantsByAssetType;
    v3->_lookupGrantsByAssetType = v27;

    v29 = [[MAAutoAssetUpdatePolicy alloc] initUpdatePolicy:@"defaultUpdatePolicy" forAssetType:0];
    defaultUpdatePolicy = v3->_defaultUpdatePolicy;
    v3->_defaultUpdatePolicy = v29;

    v31 = objc_alloc_init(NSMutableDictionary);
    alreadyScheduledSelectors = v3->_alreadyScheduledSelectors;
    v3->_alreadyScheduledSelectors = v31;

    v33 = objc_alloc_init(NSMutableDictionary);
    timedOperations = v3->_timedOperations;
    v3->_timedOperations = v33;

    v35 = objc_alloc_init(NSMutableDictionary);
    clientRequestsBeingTracked = v3->_clientRequestsBeingTracked;
    v3->_clientRequestsBeingTracked = v35;

    v37 = objc_alloc_init(NSMutableArray);
    clientRequestsAwaitingSync = v3->_clientRequestsAwaitingSync;
    v3->_clientRequestsAwaitingSync = v37;

    v39 = objc_alloc_init(NSMutableArray);
    clientRequestsAwaitingFirstUnlock = v3->_clientRequestsAwaitingFirstUnlock;
    v3->_clientRequestsAwaitingFirstUnlock = v39;

    v41 = objc_alloc_init(NSMutableArray);
    downloadManagerEventsAwaitingResumed = v3->_downloadManagerEventsAwaitingResumed;
    v3->_downloadManagerEventsAwaitingResumed = v41;

    downloadManagerInFlightTasks = v3->_downloadManagerInFlightTasks;
    v3->_downloadManagerInFlightTasks = 0;

    beyondFirstUnlockPollTimer = v3->_beyondFirstUnlockPollTimer;
    v3->_beyondFirstUnlockPollTimer = 0;

    awaitDownloadManagerSyncTimer = v3->_awaitDownloadManagerSyncTimer;
    v3->_awaitDownloadManagerSyncTimer = 0;

    *&v3->_receivedDownloadManagerSync = 0;
    v46 = objc_alloc_init(NSMutableDictionary);
    activelyEliminatingSelectors = v3->_activelyEliminatingSelectors;
    v3->_activelyEliminatingSelectors = v46;

    v48 = objc_alloc_init(MANAutoAssetControlStatistics);
    statistics = v3->_statistics;
    v3->_statistics = v48;

    v3->_statisticsNextMaintenanceReport = 0.0;
    v50 = objc_alloc_init(NSMutableDictionary);
    filesystemFileExistAtPathCache = v3->_filesystemFileExistAtPathCache;
    v3->_filesystemFileExistAtPathCache = v50;

    locksPriorToSecureHealing = v3->_locksPriorToSecureHealing;
    v3->_filesystemStartupLookupCount = 0;
    v3->_locksPriorToSecureHealing = 0;

    v53 = objc_alloc_init(NSMutableArray);
    descriptorsRequiringPersonalization = v3->_descriptorsRequiringPersonalization;
    v3->_descriptorsRequiringPersonalization = v53;

    v55 = objc_alloc_init(NSMutableArray);
    descriptorsRequiringGrafting = v3->_descriptorsRequiringGrafting;
    v3->_descriptorsRequiringGrafting = v55;

    v57 = objc_alloc_init(NSMutableArray);
    prePersonalizedSelectors = v3->_prePersonalizedSelectors;
    v3->_prePersonalizedSelectors = v57;

    *&v3->_secureHealingPersonalizationAttempted = 0;
    [@"com.apple.MobileAsset.startupTransaction" UTF8String];
    v59 = os_transaction_create();
    startupTransaction = v3->_startupTransaction;
    v3->_startupTransaction = v59;

    v3->_startupSignpost = 0;
    v61 = objc_alloc_init(MAPerfResults);
    startupPerfResults = v3->_startupPerfResults;
    v3->_startupPerfResults = v61;

    v63 = objc_alloc_init(NSMutableDictionary);
    currentSetJobsByIdentifier = v3->_currentSetJobsByIdentifier;
    v3->_currentSetJobsByIdentifier = v63;

    v65 = objc_alloc_init(NSMutableDictionary);
    cancelingSetJobsByIdentifier = v3->_cancelingSetJobsByIdentifier;
    v3->_cancelingSetJobsByIdentifier = v65;

    v67 = objc_alloc_init(NSMutableDictionary);
    currentSetStatusByInstance = v3->_currentSetStatusByInstance;
    v3->_currentSetStatusByInstance = v67;

    v69 = objc_alloc_init(NSMutableDictionary);
    knownSetConfigurationsByIdentifier = v3->_knownSetConfigurationsByIdentifier;
    v3->_knownSetConfigurationsByIdentifier = v69;

    v71 = objc_alloc_init(NSMutableDictionary);
    knownSetAtomicInstancesByInstance = v3->_knownSetAtomicInstancesByInstance;
    v3->_knownSetAtomicInstancesByInstance = v71;

    v73 = objc_alloc_init(NSMutableDictionary);
    preinstalledAssetDescriptorsBySelector = v3->_preinstalledAssetDescriptorsBySelector;
    v3->_preinstalledAssetDescriptorsBySelector = v73;

    v75 = objc_alloc_init(NSMutableDictionary);
    activeSetDescriptorsByIdentifier = v3->_activeSetDescriptorsByIdentifier;
    v3->_activeSetDescriptorsByIdentifier = v75;

    v77 = objc_alloc_init(NSMutableDictionary);
    activeSetDescriptorsByInstance = v3->_activeSetDescriptorsByInstance;
    v3->_activeSetDescriptorsByInstance = v77;

    v79 = objc_alloc_init(NSMutableDictionary);
    shortTermLockedLatestByIdentifier = v3->_shortTermLockedLatestByIdentifier;
    v3->_shortTermLockedLatestByIdentifier = v79;

    v81 = objc_alloc_init(NSMutableDictionary);
    shortTermLockedByAtomicInstance = v3->_shortTermLockedByAtomicInstance;
    v3->_shortTermLockedByAtomicInstance = v81;

    v83 = objc_alloc_init(NSMutableArray);
    descriptorsDroppedOnStartup = v3->_descriptorsDroppedOnStartup;
    v3->_descriptorsDroppedOnStartup = v83;

    v3->_persistedActiveSetJobsLoaded = 0;
    persistedKnownSetConfigurations = v3->_persistedKnownSetConfigurations;
    v3->_persistedKnownSetConfigurations = 0;

    persistedKnownSetAtomicInstances = v3->_persistedKnownSetAtomicInstances;
    v3->_persistedKnownSetAtomicInstances = 0;

    persistedActiveJobSetDescriptors = v3->_persistedActiveJobSetDescriptors;
    v3->_persistedActiveJobSetDescriptors = 0;

    persistedDownloadedSetDescriptors = v3->_persistedDownloadedSetDescriptors;
    v3->_persistedDownloadedSetDescriptors = 0;

    persistedSetTargets = v3->_persistedSetTargets;
    v3->_persistedSetTargets = 0;

    persistedSetLookupResults = v3->_persistedSetLookupResults;
    v3->_persistedSetLookupResults = 0;

    setLockUsageMap = v3->_setLockUsageMap;
    v3->_setLockUsageMap = 0;

    v3->_simulateOperationRequested = 0;
    v92 = objc_alloc_init(NSMutableDictionary);
    simulateOperationsBySelector = v3->_simulateOperationsBySelector;
    v3->_simulateOperationsBySelector = v92;

    v94 = objc_alloc_init(NSMutableDictionary);
    simulateOperationsBySetJobKey = v3->_simulateOperationsBySetJobKey;
    v3->_simulateOperationsBySetJobKey = v94;

    v96 = +[MADAnalyticsManager getAnalyticsManager];
    analyticsManager = v3->_analyticsManager;
    v3->_analyticsManager = v96;

    [(MADAutoAssetControlManager *)v3 _initializeCachedPreferences];
    p_bootedOSVersion = &v3->_bootedOSVersion;
    objc_storeStrong(&v3->_bootedOSVersion, v3->_preferenceAsIfBootedOSIsOSVersion);
    p_bootedOSBuildVersion = &v3->_bootedOSBuildVersion;
    objc_storeStrong(&v3->_bootedOSBuildVersion, v3->_preferenceAsIfBootedOSIsBuildVersion);
    if (!v3->_bootedOSVersion)
    {
      v100 = +[SUCoreDevice sharedDevice];
      v101 = [v100 productVersion];
      v102 = *p_bootedOSVersion;
      *p_bootedOSVersion = v101;
    }

    if (!*p_bootedOSBuildVersion)
    {
      v103 = deviceOSBuildVersion();
      v104 = *p_bootedOSBuildVersion;
      *p_bootedOSBuildVersion = v103;
    }

    if (runningInDeviceRecoveryEnvironment())
    {
      v105 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v105, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v105, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-MANAGER : Not initializing autoControl in DeviceRecovery mode", buf, 2u);
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)v3 _initializeAutoControl];
    }

    [(MADAutoAssetControlManager *)v3 _initializeServerConnectionPolicy];
    [(MADAutoAssetControlManager *)v3 _initializeConnectionServer];
    v106 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v106, OS_LOG_TYPE_DEFAULT))
    {
      v107 = *p_bootedOSVersion;
      v108 = *p_bootedOSBuildVersion;
      *buf = 138543874;
      v112 = @"3.0.4";
      v113 = 2114;
      v114 = v107;
      v115 = 2114;
      v116 = v108;
      _os_log_impl(&dword_0, v106, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-MANAGER [AutoAssetVersion:%{public}@] | Initialized | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
    }
  }

  return v3;
}

- (void)_initializeSUCore
{
  v2 = +[SUCore sharedCore];
  [v2 useDomain:@"com.apple.MAAuto"];
}

- (void)_initializeServerConnectionPolicy
{
  serverConnectionPolicy = self->_serverConnectionPolicy;
  v4 = _MADLog(@"AutoControl");
  v5 = v4;
  if (serverConnectionPolicy)
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "{_initializeServerConnectionPolicy} SUCoreConnectServerPolicy has already been initialized", buf, 2u);
    }
  }

  else
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Initializing SUCoreConnectServerPolicy", buf, 2u);
    }

    if (runningInDeviceRecoveryEnvironment())
    {
      v6 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} AutoControlManager no supported in DeviceRecovery mode. Setting policy to reject all incoming connections.", buf, 2u);
      }

      v7 = +[NSUUID UUID];
      v8 = [v7 UUIDString];
      v9 = [NSSet setWithObject:v8];
    }

    else
    {
      v9 = [NSSet setWithObject:@"com.apple.private.assets.bypass-asset-types-check"];
    }

    v49 = v9;
    v10 = [[SUCoreConnectServerPolicy alloc] initWithServiceName:@"com.apple.mobileasset.autoasset" entitlements:v9 serverDelegate:self];
    v11 = self->_serverConnectionPolicy;
    self->_serverConnectionPolicy = v10;

    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      v13 = self->_serverConnectionPolicy;
      *buf = 138543362;
      v51 = v13;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Created the ServerConnectionPolicy:%{public}@", buf, 0xCu);
    }

    v48 = objc_alloc_init(NSSet);
    v47 = objc_opt_class();
    v46 = objc_opt_class();
    v45 = objc_opt_class();
    v44 = objc_opt_class();
    v43 = objc_opt_class();
    v14 = objc_opt_class();
    v15 = objc_opt_class();
    v16 = objc_opt_class();
    v17 = objc_opt_class();
    v18 = objc_opt_class();
    v19 = objc_opt_class();
    v20 = objc_opt_class();
    v21 = objc_opt_class();
    v22 = objc_opt_class();
    v23 = [NSSet setWithObjects:v47, v46, v45, v44, v43, v14, v15, v16, v17, v18, v19, v20, v21, v22, objc_opt_class(), 0];
    v24 = [v48 setByAddingObjectsFromSet:v23];

    v25 = [MASAutoAssetStatus newServerMessageClasses:v24];
    v26 = [MASAutoAssetSummary newServerMessageClasses:v25];

    v27 = [MASAutoAssetInfoControl newServerMessageClasses:v26];
    v28 = [MASAutoAssetControlStatistics newServerMessageClasses:v27];

    v29 = [MASAutoAssetSetInfoInstance newServerMessageClasses:v28];
    v30 = [MASAutoAssetSetInfoDesire newServerMessageClasses:v29];

    v31 = [MASAutoAssetSetInfoFound newServerMessageClasses:v30];
    v32 = [MASAutoAssetSetInfoEnd newServerMessageClasses:v31];

    v33 = [MASAutoAssetSetInfoControl newServerMessageClasses:v32];
    v34 = [MASAutoAssetSetAtomicEntry newServerMessageClasses:v33];

    v35 = [MASAutoAssetSetEntry newServerMessageClasses:v34];
    v36 = [MASAutoAssetSetPolicy newServerMessageClasses:v35];

    v37 = [MASAutoAssetSetStatus newServerMessageClasses:v36];
    v38 = [MASAutoAssetSetLockTracker newServerMessageClasses:v37];

    v39 = [MASAutoAssetSetNotifications newServerMessageClasses:v38];
    if (__isPlatformVersionAtLeast(2, 18, 4, 0) && objc_opt_class())
    {
      v40 = [MAAutoAssetSuspendResumeForSoftwareUpdateInfo newServerMessageClasses:v39];

      v39 = v40;
    }

    v5 = v49;
    v41 = [MASAutoAssetControlStagerInformation newServerMessageClasses:v39];

    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:INTEREST_IN_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CHECK_FOR_NEWER"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:DETERMINE_IF_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CURRENT_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:LOCK_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CONTINUE_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DOWNLOAD_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:CANCEL_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:PURGE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:ERASE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):INTEREST_IN_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CHECK_FOR_NEWER"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):DETERMINE_IF_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CURRENT_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):LOCK_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):MAP_LOCKED_CONTENT_TO_EXCLAVE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_ALL_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CANCEL_ACTIVITY_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_ASSET_TYPE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DOWNLOAD_GROUPS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DOWNLOAD_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):CANCEL_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):PURGE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):ERASE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):EVICTABLE_BYTES"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):SUSPEND"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):RESUME"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):CONTROL_STATISTICS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):KNOWN_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):ACTIVE_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SCHEDULED_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):LOCKED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):STAGED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):STAGER_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_UNLOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_FORGET"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_PURGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_ABANDON"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_RECLAIM_SPACE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_SET_JOB_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CHECK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:LOCK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:FORM_SUB_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:END_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CURRENT_SET_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ELIMINATE_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC"];
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Set all the allowlisted classes for the server policy for all auto-asset[-set] commands and replies", buf, 2u);
    }
  }
}

- (void)_initializeConnectionServer
{
  connectionServer = self->_connectionServer;
  v4 = _MADLog(@"AutoControl");
  v5 = v4;
  if (connectionServer)
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *v8 = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "{_initializeConnectionServer} SUCoreConnectServer has already been initialized", v8, 2u);
    }
  }

  else
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "{_initializeConnectionServer} Initializing SUCoreConnectServer", buf, 2u);
    }

    v6 = [[SUCoreConnectServer alloc] initWithServerPolicy:self->_serverConnectionPolicy];
    v7 = self->_connectionServer;
    self->_connectionServer = v6;

    [(SUCoreConnectServer *)self->_connectionServer setupListenerAndResumeConnection];
  }
}

- (void)_initializeCachedPreferences
{
  v67 = 0;
  *&self->_preferenceScheduledAlwaysNonDiscretionary = 0;
  preferenceScheduledOnlyForAssetTypes = self->_preferenceScheduledOnlyForAssetTypes;
  self->_preferenceScheduledOnlyForAssetTypes = 0;

  preferenceSessionIDBase = self->_preferenceSessionIDBase;
  self->_preferenceSessionIDBase = 0;

  self->_preferenceConnectorInitialWaitSecs = -1;
  preferenceConnectorBackoffRetryTimes = self->_preferenceConnectorBackoffRetryTimes;
  self->_preferenceConnectorBackoffRetryTimes = 0;

  self->_preferenceConnectorWaitBeforeRetrySecs = -1;
  self->_preferenceMaxStagerDeterminingSecs = -1;
  self->_preferenceMaxStagerFilesystemMegabytes = -1;
  *&self->_preferenceAutoAssetObserverIgnoreNetworkStatus = 0;
  self->_preferenceStagerInjectAvailableOlderVersions = 0;
  self->_preferenceStagerDeterminePallasResponseFewer = -1;
  *&self->_preferenceStagerDownloadFirstNotInCatalog = 0;
  preferenceAsIfBootedOSIsOSVersion = self->_preferenceAsIfBootedOSIsOSVersion;
  self->_preferenceAsIfBootedOSIsOSVersion = 0;

  preferenceAsIfBootedOSIsBuildVersion = self->_preferenceAsIfBootedOSIsBuildVersion;
  self->_preferenceAsIfBootedOSIsBuildVersion = 0;

  *&self->_preferenceAlwaysPromoteStagedAssets = 0;
  *&self->_preferenceAsIfBackgroundSpecified = 0;
  *&v8 = -1;
  *(&v8 + 1) = -1;
  *&self->_preferenceActivityTickerSecs = v8;
  *&self->_preferencePushActivityIntervalSecs = v8;
  self->_preferenceActivityAggressiveIntervalSecs = -1;
  preferenceActivityHeightenedAssetType = self->_preferenceActivityHeightenedAssetType;
  self->_preferenceActivityHeightenedAssetType = 0;

  preferenceActivityAggressiveAssetType = self->_preferenceActivityAggressiveAssetType;
  self->_preferenceActivityAggressiveAssetType = 0;

  *&self->_preferencePersistedTableLoggingEnabled = 0;
  *&v11 = -1;
  *(&v11 + 1) = -1;
  *&self->_preferenceBeforeFirstPollSecs = v11;
  *&self->_preferenceLookupCacheAssetSelectorValidSecs = v11;
  *&self->_preferenceSecureSimulateRequireAll = 0;
  self->_preferenceSecureSimulateGraftFailure = 0;
  p_preferenceSimulatedDownloadFailureResult = &self->_preferenceSimulatedDownloadFailureResult;
  self->_preferenceSimulatedDownloadFailureResult = -1;
  self->_preferenceSimulatedStagingLookupFailureResult = -1;
  self->_preferenceForceStartupHealthReport = 0;
  preferenceHealthReportAdditionalSetNames = self->_preferenceHealthReportAdditionalSetNames;
  self->_preferenceHealthReportAdditionalSetNames = 0;

  self->_migratedFromPreinstalled = 0;
  AppBooleanValue = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledAlwaysNonDiscretionary", &v67);
  if (v67)
  {
    self->_preferenceScheduledAlwaysNonDiscretionary = AppBooleanValue != 0;
  }

  AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetConnectorInitialWaitSecs", &v67);
  if (v67)
  {
    self->_preferenceConnectorInitialWaitSecs = AppIntegerValue;
  }

  v16 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityTickerSecs", &v67);
  if (v67)
  {
    self->_preferenceActivityTickerSecs = v16;
  }

  v17 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityIntervalSecs", &v67);
  if (v67)
  {
    self->_preferenceActivityIntervalSecs = v17;
  }

  if (_MAPreferencesIsInternalAllowed())
  {
    v18 = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledBackupTriggersDisabled", &v67);
    if (v67)
    {
      self->_preferenceScheduledBackupTriggersDisabled = v18 != 0;
    }

    v19 = _MAPreferencesCopyNSStringValue(@"AutoAssetScheduledOnlyForAssetTypes");
    if (v19)
    {
      objc_storeStrong(&self->_preferenceScheduledOnlyForAssetTypes, v19);
    }

    v20 = _MAPreferencesCopyNSStringValue(@"AutoAssetSessionIDBase");

    if (v20 && [v20 length] == &dword_0 + 3)
    {
      objc_storeStrong(&self->_preferenceSessionIDBase, v20);
    }

    v21 = _MAPreferencesCopyNSArrayOfNumbersValue(@"AutoAssetConnectorBackoffRetryTimes");
    if (v21)
    {
      v22 = +[MADAutoAssetConnector backoffRetryLevelDefaultTimes];
      v23 = objc_alloc_init(NSMutableArray);
      if (v23 && [v22 count] >= 8)
      {
        [v23 addObject:&off_4F7F70];
        for (i = 0; i != 8; ++i)
        {
          if ([v21 count] <= i)
          {
            v25 = v22;
          }

          else
          {
            v25 = v21;
          }

          v26 = [v25 objectAtIndex:i];
          [v23 addObject:v26];
        }

        objc_storeStrong(&self->_preferenceConnectorBackoffRetryTimes, v23);
        p_preferenceSimulatedDownloadFailureResult = &self->_preferenceSimulatedDownloadFailureResult;
      }
    }

    v27 = _MAPreferencesGetAppIntegerValue(@"AutoAssetConnectorWaitBeforeRetrySecs", &v67);
    if (v67)
    {
      self->_preferenceConnectorWaitBeforeRetrySecs = v27;
    }

    v28 = _MAPreferencesGetAppBooleanValue(@"AutoAssetObserverIgnoreNetworkStatus", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetObserverIgnoreNetworkStatus = v28 != 0;
    }

    v29 = _MAPreferencesGetAppBooleanValue(@"AutoAssetLogSetCompare", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetLogSetCompare = v29 != 0;
    }

    v30 = _MAPreferencesGetAppBooleanValue(@"AutoAssetNoPersistedOverflowLimit", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetNoPersistedOverflowLimit = v30 != 0;
    }

    v31 = _MAPreferencesGetAppIntegerValue(@"AutoAssetMaxStagerDeterminingSecs", &v67);
    if (v67)
    {
      self->_preferenceMaxStagerDeterminingSecs = v31;
    }

    v32 = _MAPreferencesGetAppIntegerValue(@"AutoAssetStagerFilesystemMaxMegabytes", &v67);
    if (v67)
    {
      self->_preferenceMaxStagerFilesystemMegabytes = v32;
    }

    v33 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerInjectAvailableDups", &v67);
    if (v67)
    {
      self->_preferenceStagerInjectAvailableDups = v33 != 0;
    }

    v34 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerInjectAvailableOlderVersions", &v67);
    if (v67)
    {
      self->_preferenceStagerInjectAvailableOlderVersions = v34 != 0;
    }

    v35 = _MAPreferencesGetAppIntegerValue(@"AutoAssetStagerDeterminePallasResponseFewer", &v67);
    if (v67)
    {
      self->_preferenceStagerDeterminePallasResponseFewer = v35;
    }

    v36 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerDownloadFirstNotInCatalog", &v67);
    if (v67)
    {
      self->_preferenceStagerDownloadFirstNotInCatalog = v36 != 0;
    }

    v37 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerDetermineLastRequiredTimesOut", &v67);
    if (v67)
    {
      self->_preferenceStagerDetermineLastRequiredTimesOut = v37 != 0;
    }

    v38 = _MAPreferencesCopyNSStringValue(@"AutoAssetAsIfBootedOSIsOSVersion");
    v39 = self->_preferenceAsIfBootedOSIsOSVersion;
    self->_preferenceAsIfBootedOSIsOSVersion = v38;

    v40 = _MAPreferencesCopyNSStringValue(@"AutoAssetAsIfBootedOSIsBuildVersion");
    v41 = self->_preferenceAsIfBootedOSIsBuildVersion;
    self->_preferenceAsIfBootedOSIsBuildVersion = v40;

    v42 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAsIfBackground", &v67);
    if (v67)
    {
      self->_preferenceAsIfBackground = v42 != 0;
      self->_preferenceAsIfBackgroundSpecified = 1;
    }

    v43 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAsIfRamp", &v67);
    if (v67)
    {
      self->_preferenceAsIfRamp = v43 != 0;
      self->_preferenceAsIfRampSpecified = 1;
    }

    v44 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAlwaysPromoteStagedAssets", &v67);
    if (v67)
    {
      self->_preferenceAlwaysPromoteStagedAssets = v44 != 0;
    }

    v45 = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledAsIfNotInternal", &v67);
    if (v67)
    {
      self->_preferenceScheduledAsIfNotInternal = v45 != 0;
    }

    v46 = _MAPreferencesGetAppBooleanValue(@"AutoAssetPersistedTableLoggingEnabled", &v67);
    if (v67)
    {
      self->_preferencePersistedTableLoggingEnabled = v46 != 0;
    }

    v47 = _MAPreferencesGetAppBooleanValue(@"AutoAssetPerformanceLoggingEnabled", &v67);
    if (v67)
    {
      self->_preferencePerformanceLoggingEnabled = v47 != 0;
    }

    v48 = _MAPreferencesGetAppIntegerValue(@"AutoAssetPushActivityIntervalSecs", &v67);
    if (v67)
    {
      self->_preferencePushActivityIntervalSecs = v48;
    }

    v49 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityHeightenedIntervalSecs", &v67);
    if (v67)
    {
      self->_preferenceActivityHeightenedIntervalSecs = v49;
    }

    v50 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityAggressiveIntervalSecs", &v67);
    if (v67)
    {
      self->_preferenceActivityAggressiveIntervalSecs = v50;
    }

    v51 = _MAPreferencesCopyNSStringValue(@"AutoAssetActivityHeightenedAssetType");

    if (v51)
    {
      objc_storeStrong(&self->_preferenceActivityHeightenedAssetType, v51);
    }

    v52 = _MAPreferencesCopyNSStringValue(@"AutoAssetActivityAggressiveAssetType");

    if (v52)
    {
      objc_storeStrong(&self->_preferenceActivityAggressiveAssetType, v52);
    }

    v53 = _MAPreferencesGetAppIntegerValue(@"AutoAssetLookupCacheAssetSelectorValidSecs", &v67);
    if (v67)
    {
      self->_preferenceLookupCacheAssetSelectorValidSecs = v53;
    }

    v54 = _MAPreferencesGetAppIntegerValue(@"AutoAssetLookupCacheSetConfigurationValidSecs", &v67);
    if (v67)
    {
      self->_preferenceLookupCacheSetConfigurationValidSecs = v54;
    }

    v55 = _MAPreferencesGetAppIntegerValue(@"AutoAssetBeforeFirstPollSecs", &v67);
    if (v67)
    {
      self->_preferenceBeforeFirstPollSecs = v55;
    }

    v56 = _MAPreferencesGetAppIntegerValue(@"AutoAssetBeforeFirstDefaultTimeoutSecs", &v67);
    if (v67)
    {
      self->_preferenceBeforeFirstDefaultTimeoutSecs = v56;
    }

    v57 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateRequireAll", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateRequireAll = v57 != 0;
    }

    v58 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateFailureAll", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateFailureAll = v58 != 0;
    }

    v59 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateGraftFailure", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateGraftFailure = v59 != 0;
    }

    v60 = _MAPreferencesGetAppIntegerValue(@"AutoAssetSimulatedDownloadFailureResult", &v67);
    if (v67)
    {
      *p_preferenceSimulatedDownloadFailureResult = v60;
    }

    v61 = _MAPreferencesGetAppIntegerValue(@"AutoAssetSimulatedStagingLookupFailureResult", &v67);
    if (v67)
    {
      self->_preferenceSimulatedStagingLookupFailureResult = v61;
    }

    v62 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagingLookupFlipRequiredOptional", &v67);
    if (v67)
    {
      self->_preferenceStagingLookupFlipRequiredOptional = v62 != 0;
    }

    v63 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStartupSimulateFirstBoot", &v67);
    if (v67)
    {
      self->_preferenceStartupSimulateFirstBoot = v63 != 0;
    }

    v64 = _MAPreferencesGetAppBooleanValue(@"AutoStartupHealthReport", &v67);
    if (v67)
    {
      self->_preferenceForceStartupHealthReport = v64 != 0;
    }

    v65 = _MAPreferencesCopyNSArrayOfStringsValue(@"AutoHealthReportSets");
    if (v65)
    {
      v66 = v65;
      objc_storeStrong(&self->_preferenceHealthReportAdditionalSetNames, v65);
    }
  }

  else
  {
    v52 = 0;
    v21 = 0;
  }

  *&self->_operatingBeforeFirstUnlock = 0;
  self->_initialHealthReportPerformedCrosscheck = 0;
}

- (void)_initializeAutoControl
{
  if (self->_autoControlManagerFSM)
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(&v2->super, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      v3 = "{_initializeAutoControl} AutoControlManager FSM has already been initialized | MA_MILESTONE";
LABEL_4:
      _os_log_impl(&dword_0, &v2->super, OS_LOG_TYPE_ERROR, v3, buf, 2u);
    }
  }

  else
  {
    v5 = [objc_opt_class() _getAutoControlManagerStateTable];
    stateTable = self->_stateTable;
    self->_stateTable = v5;

    latestSafeSummary = self->_latestSafeSummary;
    self->_latestSafeSummary = @"INIT";

    v8 = [SUCoreFSM alloc];
    v9 = [[NSString alloc] initWithFormat:@"[%@]AutoControlManager", @"3.0.4"];
    v10 = [v8 initMachine:v9 withTable:self->_stateTable startingIn:@"Startup" usingDelegate:self registeringAllInfoClass:objc_opt_class()];
    autoControlManagerFSM = self->_autoControlManagerFSM;
    self->_autoControlManagerFSM = v10;

    if (!self->_autoControlManagerFSM)
    {
      v2 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(&v2->super, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_21;
      }

      *buf = 0;
      v3 = "{_initializeAutoControl} failed to initialize AutoControlManager FSM | MA_MILESTONE";
      goto LABEL_4;
    }

    v2 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"_initializeAutoControl"];
    v12 = [(MADAutoAssetControlManager *)self _startupActivationProcessIdentifier];
    v13 = [[MAAutoAssetSelector alloc] initForAssetType:v12 withAssetSpecifier:@"RESOURCE_USAGE_NONE" matchingAssetVersion:@"3.0.4"];
    +[MADAutoAssetHistory loadPersistedState];
    [MADAutoAssetHistory recordOperation:621 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v13];
    v14 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
    v15 = _MADLog(@"AutoControl");
    v16 = v15;
    if (v14)
    {
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v23 = v12;
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_initializeAutoControl}%@ successfully initialized AutoControlManager FSM (device is before first-unlock) | MA_MILESTONE", buf, 0xCu);
      }

      v17 = @"StartupBefore1st";
    }

    else
    {
      [(MADAutoAssetControlManager *)self setStartupSignpost:os_signpost_id_generate(v15)];

      if ([(MADAutoAssetControlManager *)self startupSignpost])
      {
        v18 = [(MADAutoAssetControlManager *)self startupPerfResults];
        [v18 getPerfResults:1];

        v19 = _MADLog(@"AutoControl");
        v20 = [(MADAutoAssetControlManager *)self startupSignpost];
        if (v20 - 1 <= 0xFFFFFFFFFFFFFFFDLL)
        {
          v21 = v20;
          if (os_signpost_enabled(v19))
          {
            *buf = 134349056;
            v23 = mach_continuous_time();
            _os_signpost_emit_with_name_impl(&dword_0, v19, OS_SIGNPOST_INTERVAL_BEGIN, v21, "Startup", "%{public, signpost.description:begin_time}llu  enableTelemetry=YES ", buf, 0xCu);
          }
        }
      }

      v16 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v23 = v12;
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_initializeAutoControl}%@ successfully initialized AutoControlManager FSM (device is not before first-unlock) | MA_MILESTONE", buf, 0xCu);
      }

      v17 = @"StartupUnlocked";
    }

    [(SUCoreFSM *)self->_autoControlManagerFSM postEvent:v17 withInfo:v2];
  }

LABEL_21:
}

+ (void)daemonProcessStartupBegun
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  [v2 _trackPerformanceStartupBegin];
}

+ (void)lockerResumed
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:lockerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  v4 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"lockerResumed"];
  v5 = [v3 autoControlManagerFSM];
  [v5 postEvent:@"LockerResumed" withInfo:v4];

  os_activity_scope_leave(&v6);
}

+ (void)stagerResumed:(id)a3 withSetLookupResults:(id)a4 performingNewOSPromotion:(BOOL)a5 requiringLoadPriorToUse:(BOOL)a6
{
  v6 = a6;
  v7 = a5;
  v9 = a3;
  v10 = a4;
  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:stagerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &v15);

  v12 = [MADAutoAssetControlManager autoControlManager:v15.opaque[0]];
  v13 = [[MADAutoAssetControlManagerParam alloc] initWithPromoted:v9 withSetLookupResults:v10 withNewOSPromotion:v7 withRequiringLoadPriorToUse:v6];
  v14 = [v12 autoControlManagerFSM];
  [v14 postEvent:@"StagerResumed" withInfo:v13];

  os_activity_scope_leave(&v15);
}

+ (void)schedulerResumed:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initWithScheduledJobs:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"SchedulerResumed" withInfo:v6];

  os_activity_scope_leave(&v8);
}

- (void)connectionClosedForClientID:(id)a3
{
  v4 = a3;
  v6 = [[MADAutoAssetControlManagerParam alloc] initWithClientID:v4];

  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [v5 postEvent:@"ClientClosed" withInfo:v6];
}

- (void)handleMessage:(id)a3 proxyObject:(id)a4 reply:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = v10;
  if (v8 && v10)
  {
    v12 = [[MADAutoAssetControlManagerParam alloc] initWithClientRequest:v8 reportingProgressThroughProxy:v9 withReplyCompletion:v10];
    v13 = [MADAutoAssetClientRequest alloc];
    v14 = [v8 clientID];
    v15 = [(MADAutoAssetClientRequest *)v13 initForClientID:v14 withClientRequestMessage:v8 withClientProgressProxy:v9 withClientReplyCompletion:v11];

    [(MADAutoAssetControlManagerParam *)v12 setClientRequest:v15];
    [(MADAutoAssetControlManagerParam *)v12 updateSafeSummary];
    v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v16 postEvent:@"ClientRequest" withInfo:v12];
  }

  else
  {
    v17 = _MADLog(@"Auto");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      v18 = @"Y";
      if (v8)
      {
        v19 = @"Y";
      }

      else
      {
        v19 = @"N";
      }

      if (!v11)
      {
        v18 = @"N";
      }

      v20 = 138543618;
      v21 = v19;
      v22 = 2114;
      v23 = v18;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "AUTO-CONTROL:{handleMessage} received message indication missing required fields | message:%{public}@, reply:%{public}@", &v20, 0x16u);
    }
  }
}

- (BOOL)isConnectionAuthorized:(id)a3
{
  v3 = a3;
  if (runningInDeviceRecoveryEnvironment())
  {
    v4 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *v7 = 0;
      _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "{isConnectionAuthorized} AutoControlManager not supported here. Connection not authorized", v7, 2u);
    }

    v5 = 0;
  }

  else
  {
    v5 = [MADAutoAssetAuthorizationPolicy isConnectionAuthorized:v3];
  }

  return v5;
}

+ (void)downloadManagerStateSyncSkipped
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v2 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"downloadManagerStateSyncSkipped"];
  v3 = [v4 autoControlManagerFSM];
  [v3 postEvent:@"DownloadManagerSyncSkipped" withInfo:v2];
}

+ (void)downloadManagerStateSyncDetermined:(id)a3
{
  v3 = a3;
  v6 = +[MADAutoAssetControlManager autoControlManager];
  v4 = [[MADAutoAssetControlManagerParam alloc] initWithDownloadsInFlight:v3];

  v5 = [v6 autoControlManagerFSM];
  [v5 postEvent:@"DownloadManagerSynced" withInfo:v4];
}

+ (void)catalogDownloadJobFinished:(id)a3 withCatalog:(id)a4 error:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobID:v9 withCatalog:v8 withError:v7];

  v11 = [v12 autoControlManagerFSM];
  [v11 postEvent:@"DownloadCatalogFinished" withInfo:v10];
}

+ (void)assetConfigJobFinished:(id)a3 withDownloadInfo:(id)a4 error:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v14 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [MADAutoAssetControlManagerParam alloc];
  v11 = [v8 options];

  v12 = [(MADAutoAssetControlManagerParam *)v10 initForConfigFinishedJobID:v9 andDownloadOptions:v11 withError:v7];
  v13 = [v14 autoControlManagerFSM];
  [v13 postEvent:@"DownloadConfigFinished" withInfo:v12];
}

+ (void)assetDownloadJob:(id)a3 progressReport:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = +[MADAutoAssetControlManager autoControlManager];
  v8 = [v7 autoControlManagerFSM];

  if (v8)
  {
    v9 = [v7 autoControlManagerFSM];
    v10 = [v9 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __62__MADAutoAssetControlManager_assetDownloadJob_progressReport___block_invoke;
    block[3] = &unk_4B2AF0;
    v13 = v7;
    v14 = v5;
    v15 = v6;
    dispatch_async(v10, block);

    v11 = v13;
  }

  else
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v17 = v5;
      v18 = 2112;
      v19 = v6;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{assetDownloadJob} Not routing progress for job since FSM not initialized | jobID:%@ | progressReport:%@", buf, 0x16u);
    }
  }
}

void __62__MADAutoAssetControlManager_assetDownloadJob_progressReport___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v3 = *(a1 + 32);
  if (v2)
  {
    v12 = [v3 autoControlManagerFSM];
    v4 = [v12 diag];
    v5 = [NSString alloc];
    v6 = *(a1 + 40);
    v7 = [*(a1 + 48) summary];
    v8 = [v5 initWithFormat:@"{assetDownloadJob} DownloadManager indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v6, v7];
    [v4 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from DownloadManager):BEFORE-FIRST" forReason:v8 withResult:6101 withError:0];
  }

  else if (([v3 operatingBeforeResumed] & 1) == 0)
  {
    v9 = *(a1 + 32);
    v10 = *(a1 + 40);
    v11 = *(a1 + 48);

    [v9 _routeAssetProgress:@"assetDownloadJob" toCurrentJobByUUID:v10 withDownloadProgress:v11];
  }
}

+ (void)assetDownloadJobFinished:(id)a3 error:(id)a4
{
  v5 = a4;
  v6 = a3;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v7 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobID:v6 withError:v5];

  v8 = [v9 autoControlManagerFSM];
  [v8 postEvent:@"DownloadAssetFinished" withInfo:v7];
}

+ (void)autoAssetJobObtainLookupGrant:(id)a3 forAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:v9 withAutoAssetUUID:v8];

  [v10 setFromAutoAssetJob:v7];
  [v10 setOriginalSelector:v9];

  [v10 updateSafeSummary];
  v11 = [v12 autoControlManagerFSM];
  [v11 postEvent:@"JobObtainLookupGrant" withInfo:v10];
}

+ (void)autoAssetJobReleaseLookupGrant:(id)a3 forAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:v9 withAutoAssetUUID:v8];

  [v10 setFromAutoAssetJob:v7];
  [v10 setOriginalSelector:v9];

  [v10 updateSafeSummary];
  v11 = [v12 autoControlManagerFSM];
  [v11 postEvent:@"JobReleaseLookupGrant" withInfo:v10];
}

+ (void)autoAssetJobReadyToDownload:(id)a3 withAutoAssetUUID:(id)a4 fromAutoAssetJob:(id)a5 withOriginalSelector:(id)a6 downloadingDescriptor:(id)a7 baseForPatchDescriptor:(id)a8
{
  v13 = a8;
  v14 = a7;
  v15 = a6;
  v16 = a5;
  v17 = a4;
  v18 = a3;
  v21 = +[MADAutoAssetControlManager autoControlManager];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:v18 withAutoAssetUUID:v17];

  [v19 setFromAutoAssetJob:v16];
  [v19 setOriginalSelector:v15];

  [v19 setDownloadingDescriptor:v14];
  [v19 setBaseForPatchDescriptor:v13];

  [v19 updateSafeSummary];
  v20 = [v21 autoControlManagerFSM];
  [v20 postEvent:@"JobAssignPersistedState" withInfo:v19];
}

+ (void)autoAssetJobSetLookupResponseReceived:(id)a3 forAssignedSetDescriptor:(id)a4 withCatalogLookupResponse:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:v9 withSetDescriptor:v8 withCatalogLookupResponse:v7];

  [v10 updateSafeSummary];
  v11 = [v12 autoControlManagerFSM];
  [v11 postEvent:@"JobSetLookupResponseReceived" withInfo:v10];
}

+ (void)autoAssetJobIssueProgress:(id)a3 forAutoAssetSelector:(id)a4 withAutoAssetUUID:(id)a5 withJobInformation:(id)a6 withResponseError:(id)a7
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = +[MADAutoAssetControlManager autoControlManager];
  v15 = [v14 autoControlManagerFSM];

  if (v15)
  {
    v16 = [v14 autoControlManagerFSM];
    v17 = [v16 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __132__MADAutoAssetControlManager_autoAssetJobIssueProgress_forAutoAssetSelector_withAutoAssetUUID_withJobInformation_withResponseError___block_invoke;
    block[3] = &unk_4B42C0;
    v20 = v14;
    v21 = v12;
    v22 = v13;
    v23 = v10;
    v24 = v11;
    dispatch_async(v17, block);

    v18 = v20;
  }

  else
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{autoAssetJobIssueProgress}: Not issuing auto-asset download progress indication since FSM not initialized", buf, 2u);
    }
  }
}

void __132__MADAutoAssetControlManager_autoAssetJobIssueProgress_forAutoAssetSelector_withAutoAssetUUID_withJobInformation_withResponseError___block_invoke(uint64_t a1)
{
  v2 = a1;
  v3 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v4 = *(v2 + 32);
  if (v3)
  {
    v42 = [v4 autoControlManagerFSM];
    v5 = [v42 diag];
    v6 = [NSString alloc];
    v7 = *(v2 + 40);
    v8 = [*(v2 + 48) currentStatus];
    v9 = [v8 downloadProgress];
    if (v9)
    {
      v2 = [*(v2 + 48) currentStatus];
      v1 = [v2 downloadProgress];
      v10 = [v1 summary];
    }

    else
    {
      v10 = @"N";
    }

    v24 = [v6 initWithFormat:@"{autoAssetJobIssueProgress} auto-asset-job indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v7, v10];
    [v5 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):BEFORE-FIRST" forReason:v24 withResult:6101 withError:0];

    if (v9)
    {
    }

    goto LABEL_17;
  }

  if (([v4 operatingBeforeResumed] & 1) != 0 || !*(v2 + 56))
  {
    return;
  }

  if (!*(v2 + 64))
  {
    v42 = [*(v2 + 32) autoControlManagerFSM];
    v25 = [v42 diag];
    v5 = v25;
    v26 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-AUTO-ASSET-SELECTOR";
    v27 = @"{autoAssetJobIssueProgress} auto-asset-job indication of download progress without autoAssetSelector";
LABEL_22:
    [v25 trackAnomaly:v26 forReason:v27 withResult:6102 withError:0];
LABEL_17:

    return;
  }

  v11 = *(v2 + 32);
  if (!*(v2 + 40))
  {
    v42 = [v11 autoControlManagerFSM];
    v25 = [v42 diag];
    v5 = v25;
    v26 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-AUTO-ASSET-UUID";
    v27 = @"{autoAssetJobIssueProgress} auto-asset-job indication of download progress without autoAssetUUID";
    goto LABEL_22;
  }

  v12 = [v11 _autoAssetJobProgressNewValidatedCurrentStatus:*(v2 + 48) requiringProgress:1];
  v13 = v12;
  if (v12)
  {
    v14 = [v12 downloadProgress];
    v15 = [*(v2 + 56) count];
    v16 = [*(v2 + 48) initialAssetSelector];

    if (v16)
    {
      v17 = [*(v2 + 48) initialAssetSelector];
      v16 = [v17 assetVersion];
    }

    v18 = [*(v2 + 48) fullAssetSelector];

    v19 = *(v2 + 32);
    v20 = *(v2 + 48);
    if (v18)
    {
      v21 = [v20 fullAssetSelector];
      v22 = *(v2 + 40);
      v23 = @"autoAssetJobIssueProgress(full-selector)";
    }

    else
    {
      v21 = [v20 initialAssetSelector];
      v22 = *(v2 + 40);
      v23 = @"autoAssetJobIssueProgress(initial-selector)";
    }

    [v19 updateAutoAssetStatus:v21 forActiveJobUUID:v22 withLatestJobStatus:v13 matchingAssetVersion:v16 fromLocation:v23];

    if (v15 >= 1 && [v14 totalExpectedBytes] >= 1)
    {
      v41 = v16;
      v43 = v14;
      v46 = 0u;
      v47 = 0u;
      v44 = 0u;
      v45 = 0u;
      v28 = *(v2 + 56);
      v29 = [v28 countByEnumeratingWithState:&v44 objects:v48 count:16];
      if (v29)
      {
        v30 = v29;
        v31 = *v45;
        do
        {
          for (i = 0; i != v30; i = i + 1)
          {
            if (*v45 != v31)
            {
              objc_enumerationMutation(v28);
            }

            v33 = *(*(&v44 + 1) + 8 * i);
            v34 = objc_autoreleasePoolPush();
            v35 = [v33 clientReplyCompletion];
            if (v35)
            {
              v36 = v35;
              v37 = [v33 clientProgressProxy];

              if (v37)
              {
                v38 = [v33 clientProgressProxy];
                v39 = objc_opt_respondsToSelector();

                if (v39)
                {
                  v40 = [v33 clientProgressProxy];
                  [v40 executeGenericBlock:v13];
                }
              }
            }

            objc_autoreleasePoolPop(v34);
          }

          v30 = [v28 countByEnumeratingWithState:&v44 objects:v48 count:16];
        }

        while (v30);
      }

      v16 = v41;
      v14 = v43;
    }
  }
}

- (id)_autoAssetJobProgressNewValidatedCurrentStatus:(id)a3 requiringProgress:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  if (!v6)
  {
    v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v29 = [v28 diag];
    [v29 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-JOB-INFORMATION" forReason:@"{_autoAssetJobProgressNewValidatedCurrentStatus} required jobInformation not provided" withResult:6102 withError:0];
LABEL_20:

    goto LABEL_21;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v29 = [v28 diag];
    v30 = [NSString alloc];
    v31 = objc_opt_class();
    v32 = NSStringFromClass(v31);
    v33 = [v30 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation of class:%@", v32];
    v34 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-WRONG-CLASS";
    v35 = v29;
    v36 = v33;
    v37 = 6103;
LABEL_14:
    [v35 trackAnomaly:v34 forReason:v36 withResult:v37 withError:0];

LABEL_19:
    goto LABEL_20;
  }

  v7 = [v6 initialAssetSelector];

  if (!v7)
  {
LABEL_21:
    v46 = 0;
    goto LABEL_22;
  }

  v8 = [v6 initialAssetSelector];
  objc_opt_class();
  isKindOfClass = objc_opt_isKindOfClass();

  if ((isKindOfClass & 1) == 0)
  {
    v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v29 = [v28 diag];
    v38 = [NSString alloc];
    v32 = [v6 initialAssetSelector];
    v39 = objc_opt_class();
    v40 = NSStringFromClass(v39);
    v41 = [v6 summary];
    v42 = [v38 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.initialAssetSelector of class:%@ | jobInformation:%@", v40, v41];
    v43 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-INITIAL-ASSET-SELECTOR-WRONG-CLASS";
LABEL_17:
    [v29 trackAnomaly:v43 forReason:v42 withResult:6103 withError:0];

LABEL_18:
    goto LABEL_19;
  }

  v10 = [v6 fullAssetSelector];
  if (v10)
  {
    v11 = v10;
    v12 = [v6 fullAssetSelector];
    objc_opt_class();
    v13 = objc_opt_isKindOfClass();

    if ((v13 & 1) == 0)
    {
      v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v29 = [v28 diag];
      v44 = [NSString alloc];
      v32 = [v6 fullAssetSelector];
      v45 = objc_opt_class();
      v40 = NSStringFromClass(v45);
      v41 = [v6 summary];
      v42 = [v44 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} optional jobInformation.fullAssetSelector of class:%@ | jobInformation:%@", v40, v41];
      v43 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-FULL-ASSET-SELECTOR-WRONG-CLASS";
      goto LABEL_17;
    }
  }

  v14 = [v6 currentStatus];

  if (!v14)
  {
    v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v29 = [v28 diag];
    v48 = [NSString alloc];
    v32 = [v6 summary];
    v33 = [v48 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} required jobInformation.currentStatus not provided | jobInformation:%@", v32];
    v34 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-NIL-CURRENT-STATUS";
    v35 = v29;
    v36 = v33;
    v37 = 6102;
    goto LABEL_14;
  }

  v15 = [v6 currentStatus];
  objc_opt_class();
  v16 = objc_opt_isKindOfClass();

  if ((v16 & 1) == 0)
  {
    v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v29 = [v28 diag];
    v49 = [NSString alloc];
    v32 = [v6 currentStatus];
    v50 = objc_opt_class();
    v40 = NSStringFromClass(v50);
    v51 = [v49 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.currentStatus of class:%@", v40];
    [v29 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-CURRENT-STATUS-WRONG-CLASS" forReason:v51 withResult:6103 withError:0];

    goto LABEL_18;
  }

  v17 = [v6 currentStatus];
  v18 = [v17 downloadProgress];

  if (!v18)
  {
    if (v4)
    {
      v21 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{_autoAssetJobProgressNewValidatedCurrentStatus} | no jobInformation.currentStatus.downloadProgress", buf, 2u);
      }

      goto LABEL_30;
    }

LABEL_31:
    if (objc_opt_respondsToSelector())
    {
      v52 = [v17 copy];
    }

    else
    {
      v52 = v17;
    }

    v46 = v52;
    goto LABEL_35;
  }

  v19 = [v17 downloadProgress];
  objc_opt_class();
  v20 = objc_opt_isKindOfClass();

  if (v20)
  {
    goto LABEL_31;
  }

  v21 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v22 = [v21 diag];
  v23 = [NSString alloc];
  v24 = [v17 downloadProgress];
  v25 = objc_opt_class();
  v26 = NSStringFromClass(v25);
  v27 = [v23 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.currentStatus.downloadProgress of class:%@", v26];
  [v22 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-CURRENT-STATUS-DOWNLOAD-PROGRESS-WRONG-CLASS" forReason:v27 withResult:6103 withError:0];

LABEL_30:
  v46 = 0;
LABEL_35:

LABEL_22:

  return v46;
}

+ (void)autoSetJobIssueProgress:(id)a3 forAssetSetIdentifier:(id)a4 withAutoAssetUUID:(id)a5 withSetJobInformation:(id)a6 withResponseError:(id)a7
{
  v9 = a3;
  v10 = a5;
  v11 = a6;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v13 = [v12 autoControlManagerFSM];

  if (v13)
  {
    v14 = [v12 autoControlManagerFSM];
    v15 = [v14 extendedStateQueue];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __134__MADAutoAssetControlManager_autoSetJobIssueProgress_forAssetSetIdentifier_withAutoAssetUUID_withSetJobInformation_withResponseError___block_invoke;
    v17[3] = &unk_4B3350;
    v18 = v12;
    v19 = v10;
    v20 = v11;
    v21 = v9;
    dispatch_async(v15, v17);

    v16 = v18;
  }

  else
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{autoSetJobIssueProgress}: Not issuing set-job download progress indication since FSM not initialized", buf, 2u);
    }
  }
}

void __134__MADAutoAssetControlManager_autoSetJobIssueProgress_forAssetSetIdentifier_withAutoAssetUUID_withSetJobInformation_withResponseError___block_invoke(uint64_t a1)
{
  v2 = a1;
  v3 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v4 = *(v2 + 32);
  if (v3)
  {
    v35 = [v4 autoControlManagerFSM];
    v5 = [v35 diag];
    v6 = [NSString alloc];
    v7 = *(v2 + 40);
    v8 = [*(v2 + 48) currentSetStatus];
    v9 = [v8 downloadProgress];
    if (v9)
    {
      v2 = [*(v2 + 48) currentSetStatus];
      v1 = [v2 downloadProgress];
      v10 = [v1 summary];
    }

    else
    {
      v10 = @"N";
    }

    v34 = [v6 initWithFormat:@"{autoSetJobIssueProgress} set-job indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v7, v10];
    [v5 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):BEFORE-FIRST" forReason:v34 withResult:6101 withError:0];

    if (v9)
    {
    }
  }

  else if (([v4 operatingBeforeResumed] & 1) == 0)
  {
    v11 = [*(v2 + 32) _autoAssetSetJobProgressNewValidatedCurrentStatus:*(v2 + 48)];
    v12 = [*(v2 + 56) count];
    if (v11)
    {
      v13 = v12;
      v14 = *(v2 + 32);
      v15 = [v11 clientDomainName];
      v16 = [v11 assetSetIdentifier];
      v17 = [v14 updateAutoAssetSetStatus:@"autoSetJobIssueProgress" forClientDomain:v15 forAssetSetIdentifier:v16 forJobResponse:0 withResponseError:0 clearingDownloadProgressReason:0 withAssetSetStatus:0];

      if (v13 >= 1)
      {
        v18 = [v11 downloadProgress];
        v19 = [v18 totalExpectedBytes];

        if (v19 >= 1)
        {
          v38 = 0u;
          v39 = 0u;
          v36 = 0u;
          v37 = 0u;
          v20 = *(v2 + 56);
          v21 = [v20 countByEnumeratingWithState:&v36 objects:v40 count:16];
          if (v21)
          {
            v22 = v21;
            v23 = *v37;
            do
            {
              for (i = 0; i != v22; i = i + 1)
              {
                if (*v37 != v23)
                {
                  objc_enumerationMutation(v20);
                }

                v25 = *(*(&v36 + 1) + 8 * i);
                v26 = objc_autoreleasePoolPush();
                v27 = [v25 clientReplyCompletion];
                if (v27)
                {
                  v28 = v27;
                  v29 = [v25 clientProgressProxy];

                  if (v29)
                  {
                    v30 = [v25 clientProgressProxy];
                    v31 = objc_opt_respondsToSelector();

                    if (v31)
                    {
                      v32 = [v25 clientProgressProxy];
                      v33 = [MASAutoAssetSetStatus newShimmedToFramework:v11];
                      [v32 executeGenericBlock:v33];
                    }
                  }
                }

                objc_autoreleasePoolPop(v26);
              }

              v22 = [v20 countByEnumeratingWithState:&v36 objects:v40 count:16];
            }

            while (v22);
          }
        }
      }
    }
  }
}

- (id)_autoAssetSetJobProgressNewValidatedCurrentStatus:(id)a3
{
  v4 = a3;
  if (!v4)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v18 diag];
    [v24 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):NO-SET-JOB-INFORMATION" forReason:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} required setJobInformation not provided" withResult:6102 withError:0];
LABEL_17:
    v32 = 0;
    goto LABEL_18;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v18 diag];
    v34 = [NSString alloc];
    v35 = objc_opt_class();
    v36 = NSStringFromClass(v35);
    v37 = [v34 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation of class:%@", v36];
    v38 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-WRONG-CLASS";
    v39 = v24;
    v40 = v37;
    v41 = 6103;
LABEL_15:
    [v39 trackAnomaly:v38 forReason:v40 withResult:v41 withError:0];

LABEL_16:
    goto LABEL_17;
  }

  v5 = [v4 currentSetStatus];

  if (!v5)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v18 diag];
    v42 = [NSString alloc];
    v36 = [v4 summary];
    v37 = [v42 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} required setJobInformation.currentSetStatus not provided | setJobInformation:%@", v36];
    v38 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-NIL-CURRENT-STATUS";
    v39 = v24;
    v40 = v37;
    v41 = 6102;
    goto LABEL_15;
  }

  v6 = [v4 currentSetStatus];
  objc_opt_class();
  isKindOfClass = objc_opt_isKindOfClass();

  if ((isKindOfClass & 1) == 0)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v18 diag];
    v44 = [NSString alloc];
    v36 = [v4 currentSetStatus];
    v45 = objc_opt_class();
    v46 = NSStringFromClass(v45);
    v47 = [v44 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.currentSetStatus of class:%@", v46];
    [v24 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CURRENT-STATUS-WRONG-CLASS" forReason:v47 withResult:6103 withError:0];

    goto LABEL_16;
  }

  v8 = [v4 currentSetStatus];
  v9 = [v8 clientDomainName];

  if (v9)
  {
    v10 = [v4 currentSetStatus];
    v11 = [v10 clientDomainName];
    objc_opt_class();
    v12 = objc_opt_isKindOfClass();

    if ((v12 & 1) == 0)
    {
      v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v24 = [v18 diag];
      v48 = [NSString alloc];
      v49 = [v4 currentSetStatus];
      v50 = [v49 clientDomainName];
      v51 = objc_opt_class();
      v52 = NSStringFromClass(v51);
      v53 = [v4 summary];
      v54 = [v48 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.clientDomainName of class:%@ | setJobInformation:%@", v52, v53];
      v55 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CLIENT-DOMAIN-NAME-WRONG-CLASS";
LABEL_27:
      [v24 trackAnomaly:v55 forReason:v54 withResult:6103 withError:0];

      goto LABEL_17;
    }

    v13 = [v4 currentSetStatus];
    v14 = [v13 assetSetIdentifier];

    if (v14)
    {
      v15 = [v4 currentSetStatus];
      v16 = [v15 assetSetIdentifier];
      objc_opt_class();
      v17 = objc_opt_isKindOfClass();

      if (v17)
      {
        v18 = [v4 currentSetStatus];
        v19 = [v18 downloadProgress];

        if (!v19)
        {
          v32 = 0;
          goto LABEL_19;
        }

        v20 = [v18 downloadProgress];
        objc_opt_class();
        v21 = objc_opt_isKindOfClass();

        if (v21)
        {
          v22 = [v18 clientDomainName];
          v23 = [v18 assetSetIdentifier];
          v24 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v22 forAssetSetIdentifier:v23];

          v75 = [MANAutoAssetSetStatus alloc];
          v76 = [v18 clientDomainName];
          v98 = [v18 assetSetIdentifier];
          v78 = [v18 configuredAssetEntries];
          v74 = [v78 copy];
          v81 = [v18 atomicInstancesDownloaded];
          v97 = [v81 copy];
          v96 = [v24 mostRecentlyReceivedCachedAssetSetID];
          v95 = [v24 mostRecentlyReceivedDownloadedFromLive];
          v94 = [v24 mostRecentlyReceivedLastTimeChecked];
          v93 = [v24 mostRecentlyReceivedPostedDate];
          v92 = [v18 newerAtomicInstanceDiscovered];
          v80 = [v18 newerDiscoveredAtomicEntries];
          v91 = [v80 copy];
          v79 = [v18 latestDownloadedAtomicInstance];
          v90 = [v79 copy];
          v71 = [v24 latestAtomicInstanceToVendFromPreSUStaging];
          v77 = [v18 latestDowloadedAtomicInstanceEntries];
          v89 = [v77 copy];
          v88 = [v24 latestToVendCachedAssetSetID];
          v87 = [v24 latestToVendDownloadedFromLive];
          v86 = [v24 latestToVendLastTimeChecked];
          v85 = [v24 latestToVendPostedDate];
          v73 = [v18 currentNotifications];
          v84 = [v73 copy];
          v72 = [v18 currentNeedPolicy];
          v83 = [v72 copy];
          v70 = [v18 clientDomainName];
          v69 = [v18 assetSetIdentifier];
          v82 = [MADAutoAssetScheduler newSetPolicyForDomainName:v70 forAssetSetIdentifier:v69];
          v67 = +[MADAutoAssetControlManager stagerSetPolicy];
          v66 = [v24 haveReceivedLookupResponse];
          v65 = [v24 vendingAtomicInstanceForConfiguredEntries];
          v64 = [v18 downloadUserInitiated];
          v68 = [v18 downloadProgress];
          v63 = [v68 copy];
          v25 = [v18 downloadedNetworkBytes];
          v26 = [v18 downloadedFilesystemBytes];
          v62 = [v18 currentLockUsage];
          v27 = [v18 selectorsForStaging];
          v28 = [v24 availableForUseError];
          v29 = [v24 newerVersionError];
          BYTE2(v61) = v64;
          BYTE1(v61) = v65;
          LOBYTE(v61) = v66;
          LOBYTE(v60) = v71;
          v30 = v76;
          v31 = v74;
          v32 = [MANAutoAssetSetStatus initStatusForClientDomain:v75 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v76 withAtomicInstancesDownloaded:v98 withCatalogCachedAssetSetID:v74 withCatalogDownloadedFromLive:v97 withCatalogLastTimeChecked:v96 withCatalogPostedDate:v95 withNewerAtomicInstanceDiscovered:v94 withNewerDiscoveredAtomicEntries:v93 withLatestDownloadedAtomicInstance:v92 withLatestDownloadedAtomicInstanceFromPreSUStaging:v91 withLatestDowloadedAtomicInstanceEntries:v90 withDownloadedCatalogCachedAssetSetID:v60 withDownloadedCatalogDownloadedFromLive:v89 withDownloadedCatalogLastTimeChecked:v88 withDownloadedCatalogPostedDate:v87 withCurrentNotifications:v86 withCurrentNeedPolicy:v85 withSchedulerPolicy:v84 withStagerPolicy:v83 havingReceivedLookupResponse:v82 vendingAtomicInstanceForConfiguredEntries:v67 withDownloadUserInitiated:v61 withDownloadProgress:v63 withDownloadedNetworkBytes:v25 withDownloadedFilesystemBytes:v26 withCurrentLockUsage:v62 withSelectorsForStaging:v27 withAvailableForUseError:v28 withNewerVersionError:v29];

          v33 = v78;
        }

        else
        {
          v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v30 = [v24 diag];
          v58 = [NSString alloc];
          v98 = [v18 downloadProgress];
          v59 = objc_opt_class();
          v33 = NSStringFromClass(v59);
          v31 = [v58 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.currentSetStatus.downloadProgress of class:%@", v33];
          [v30 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CURRENT-STATUS-DOWNLOAD-PROGRESS-WRONG-CLASS" forReason:v31 withResult:6103 withError:0];
          v32 = 0;
        }

LABEL_18:
LABEL_19:

        goto LABEL_20;
      }

      v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v24 = [v18 diag];
      v56 = [NSString alloc];
      v49 = [v4 currentSetStatus];
      v50 = [v49 assetSetIdentifier];
      v57 = objc_opt_class();
      v52 = NSStringFromClass(v57);
      v53 = [v4 summary];
      v54 = [v56 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.assetSetIdentifier of class:%@ | setJobInformation:%@", v52, v53];
      v55 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-ASSET-SET-IDENTIFIER-WRONG-CLASS";
      goto LABEL_27;
    }
  }

  v32 = 0;
LABEL_20:

  return v32;
}

+ (BOOL)autoSetJobAvailableAtomicInstanceForSetDescriptor:(id)a3
{
  v3 = a3;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  v5 = [v4 autoControlManagerFSM];

  if (v5)
  {
    v6 = [v4 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __80__MADAutoAssetControlManager_autoSetJobAvailableAtomicInstanceForSetDescriptor___block_invoke;
    block[3] = &unk_4B4478;
    v12 = v4;
    v13 = v3;
    v14 = &v16;
    dispatch_sync(v7, block);

    v8 = *(v17 + 24);
  }

  else
  {
    v9 = _MADLog(@"AutoSet");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoSetJobAvailableAtomicInstanceForSetDescriptor}: Returning no for atomicInstanceAvailable since FSM is not initialized", buf, 2u);
    }

    v8 = *(v17 + 24);
  }

  _Block_object_dispose(&v16, 8);

  return v8 & 1;
}

void __80__MADAutoAssetControlManager_autoSetJobAvailableAtomicInstanceForSetDescriptor___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = [*(a1 + 40) clientDomainName];
  v4 = [*(a1 + 40) assetSetIdentifier];
  v7 = [v2 locateSetConfigurationByClientDomain:v3 forAssetSetIdentifier:v4];

  v5 = v7;
  if (v7)
  {
    v6 = [v7 latestAtomicInstanceToVend];
    *(*(*(a1 + 48) + 8) + 24) = v6 != 0;

    v5 = v7;
  }
}

+ (void)autoAssetJobIssueReply:(id)a3 forAutoAssetSelector:(id)a4 withAutoAssetUUID:(id)a5 fromAutoAssetJob:(id)a6 withOriginalSelector:(id)a7 withJobInformation:(id)a8 withResponseError:(id)a9
{
  v14 = a3;
  v15 = a8;
  v16 = a9;
  v35 = a7;
  v34 = a6;
  v17 = a5;
  v18 = a4;
  v36 = +[MADAutoAssetControlManager autoControlManager];
  v19 = objc_alloc_init(NSMutableDictionary);
  if (!v16)
  {
    v20 = [v15 clientInstance];
    [v19 setSafeObject:v20 forKey:@"instance"];

    v21 = [v15 foundContent];
    [v19 setSafeObject:v21 forKey:@"found"];

    v22 = [v15 clientDesire];
    [v19 setSafeObject:v22 forKey:@"desire"];
  }

  v37 = v15;
  v23 = [SUCoreConnectMessage alloc];
  v24 = [v14 clientRequestMessage];
  v25 = [MADAutoAssetControlManager replyMessageNameForRequest:v24];
  v26 = [v14 clientID];
  v27 = [v23 initWithType:2 messageName:v25 clientID:v26 version:0 message:v19];

  if (v27)
  {
    [v14 setResponseMessage:v27];
  }

  else
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      v29 = [MADAutoAssetClientRequest responseErrorSummary:v16];
      *buf = 138543362;
      v39 = v29;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{autoAssetJobIssueReply} | unable to build response message | error:%{public}@", buf, 0xCu);
    }
  }

  v30 = [MADAutoAssetControlManagerParam alloc];
  v31 = [v14 clientReplyCompletion];
  v32 = [(MADAutoAssetControlManagerParam *)v30 initForJobIssueReply:v31 forAutoAssetSelector:v18 withAutoAssetUUID:v17 withResponseMessage:v27 withResponseError:v16];

  [v32 setClientRequest:v14];
  [v32 setFromAutoAssetJob:v34];

  [v32 setOriginalSelector:v35];
  [v32 setJobInformation:v37];
  [v32 updateSafeSummary];
  v33 = [v36 autoControlManagerFSM];
  [v33 postEvent:@"JobIssueClientReply" withInfo:v32];
}

+ (void)autoSetJobIssueReply:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9
{
  v14 = a3;
  v15 = a4;
  v16 = a5;
  v17 = a6;
  v18 = a7;
  v19 = a8;
  v20 = a9;
  v27.opaque[0] = 0;
  v27.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobIssueReply", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v27);

  v22 = [MADAutoAssetControlManager autoControlManager:v27.opaque[0]];
  v23 = [MADAutoAssetControlManagerParam alloc];
  v24 = [v14 clientReplyCompletion];
  v25 = [(MADAutoAssetControlManagerParam *)v23 initForSetJobIssueReply:v24 forDomainName:v15 forAssetSetIdentifier:v16 withAutoAssetUUID:v17 withSetJobInformation:v19 withResponseError:v20];

  [v25 setClientRequest:v14];
  [v25 setFromAutoAssetJob:v18];
  v26 = [v22 autoControlManagerFSM];
  [v26 postEvent:@"SetJobIssueClientReply" withInfo:v25];

  os_activity_scope_leave(&v27);
}

+ (void)autoSetJobSchedulerNoClientFoundSame:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9
{
  v14 = a3;
  v15 = a4;
  v16 = a5;
  v17 = a6;
  v18 = a7;
  v19 = a8;
  v20 = a9;
  v25.opaque[0] = 0;
  v25.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobSchedulerNoClientFoundSame", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v25);

  v22 = [MADAutoAssetControlManager autoControlManager:v25.opaque[0]];
  v23 = [[MADAutoAssetControlManagerParam alloc] initForSetJobSchedulerNoClientFoundSame:v14 forDomainName:v15 forAssetSetIdentifier:v16 withAutoAssetUUID:v17 withSetJobInformation:v19 withResponseError:v20];
  [v23 setFromAutoAssetJob:v18];
  v24 = [v22 autoControlManagerFSM];
  [v24 postEvent:@"SetJobSchedulerFoundSame" withInfo:v23];

  os_activity_scope_leave(&v25);
}

+ (void)autoSetJobSchedulerNoClientDownloaded:(id)a3 forDomainName:(id)a4 forAssetSetIdentifier:(id)a5 withAutoAssetUUID:(id)a6 fromAutoAssetJob:(id)a7 withSetJobInformation:(id)a8 withResponseError:(id)a9
{
  v14 = a3;
  v15 = a4;
  v16 = a5;
  v17 = a6;
  v18 = a7;
  v19 = a8;
  v20 = a9;
  v25.opaque[0] = 0;
  v25.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobSchedulerNoClientDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v25);

  v22 = [MADAutoAssetControlManager autoControlManager:v25.opaque[0]];
  v23 = [[MADAutoAssetControlManagerParam alloc] initForSetJobSchedulerNoClientDownloaded:v14 forDomainName:v15 forAssetSetIdentifier:v16 withAutoAssetUUID:v17 withSetJobInformation:v19 withResponseError:v20];
  [v23 setFromAutoAssetJob:v18];
  v24 = [v22 autoControlManagerFSM];
  [v24 postEvent:@"SetJobSchedulerDownloaded" withInfo:v23];

  os_activity_scope_leave(&v25);
}

+ (void)autoJobAssetSetIDsForJob:(id)a3 mostRecentlyReceived:(id *)a4 latestToVend:(id *)a5
{
  v7 = a3;
  v8 = +[MADAutoAssetControlManager autoControlManager];
  v22 = 0;
  v23 = &v22;
  v24 = 0x3032000000;
  v25 = __Block_byref_object_copy__12;
  v26 = __Block_byref_object_dispose__12;
  v27 = 0;
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  v9 = [v8 autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __89__MADAutoAssetControlManager_autoJobAssetSetIDsForJob_mostRecentlyReceived_latestToVend___block_invoke;
  block[3] = &unk_4B44A0;
  v14 = &v22;
  v11 = v7;
  v13 = v11;
  v15 = &v16;
  dispatch_sync(v10, block);

  if (a4)
  {
    *a4 = v23[5];
  }

  if (a5)
  {
    *a5 = v17[5];
  }

  _Block_object_dispose(&v16, 8);
  _Block_object_dispose(&v22, 8);
}

uint64_t __89__MADAutoAssetControlManager_autoJobAssetSetIDsForJob_mostRecentlyReceived_latestToVend___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) mostRecentlyReceivedCachedAssetSetID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) latestToVendCachedAssetSetID];

  return _objc_release_x1();
}

+ (void)autoAssetStagerSetJobDetermineDone:(id)a3 withBaseForStagingDescriptors:(id)a4 withDetermineError:(id)a5
{
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetStagerSetJobDetermineDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobLookupResults:v7 withBaseForStagingDescriptors:v8 withDetermineError:v9];
  [v12 updateSafeSummary];
  v13 = [v11 autoControlManagerFSM];
  [v13 postEvent:@"StagerDetermineDone" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)autoAssetStagerJobDownloadDone:(id)a3 withDownloadedDescriptor:(id)a4 withDownloadError:(id)a5
{
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetStagerJobDownloadDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobInformation:v9];
  [v12 setJobInformation:v7];
  [v12 setDownloadingDescriptor:v8];
  [v12 updateSafeSummary];
  v13 = [v11 autoControlManagerFSM];
  [v13 postEvent:@"StagerDownloadDone" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)autoAssetJobFinished:(id)a3 withAutoAssetUUID:(id)a4 schedulerInvolved:(BOOL)a5 potentialNetworkFailure:(BOOL)a6
{
  v6 = a6;
  v7 = a5;
  v9 = a3;
  v10 = a4;
  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &v15);

  v12 = [MADAutoAssetControlManager autoControlManager:v15.opaque[0]];
  v13 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobSelector:v9 withAutoAssetUUID:v10 withSchedulerInvolved:v7 withPotentialNetworkFailure:v6];
  v14 = [v12 autoControlManagerFSM];
  [v14 postEvent:@"JobFinished" withInfo:v13];

  os_activity_scope_leave(&v15);
}

+ (void)autoSetJobFinished:(id)a3 forAssetSetIdentifier:(id)a4 withAutoAssetUUID:(id)a5 fromAutoAssetJob:(id)a6 withSetJobInformation:(id)a7 schedulerInvolved:(BOOL)a8 potentialNetworkFailure:(BOOL)a9
{
  v9 = a8;
  v14 = a3;
  v15 = a4;
  v16 = a5;
  v17 = a6;
  v18 = a7;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v19 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v19, &state);

  v20 = +[MADAutoAssetControlManager autoControlManager];
  LOBYTE(v23) = a9;
  v21 = [[MADAutoAssetControlManagerParam alloc] initForFinishedSetJob:v14 forAssetSetIdentifier:v15 withSetAtomicInstance:v16 withAutoAssetUUID:v16 withSetJobInformation:v18 withSchedulerInvolved:v9 withPotentialNetworkFailure:v23];
  [v21 setFromAutoAssetJob:v17];
  v22 = [v20 autoControlManagerFSM];
  [v22 postEvent:@"JobFinished" withInfo:v21];

  os_activity_scope_leave(&state);
}

+ (void)autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"SetJobFinishedRerouteScheduled" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"JobFinishedRerouteScheduled" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerRequestAlreadyDownloadedDescriptors
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:stagerRequestAlreadyDownloadedDescriptors", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  v4 = [v3 autoControlManagerFSM];
  v5 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"stagerRequestAlreadyDownloadedDescriptors"];
  [v4 postEvent:@"StagerAlreadyDownloaded" withInfo:v5];

  os_activity_scope_leave(&v6);
}

+ (void)stagerStartSetJobDetermineIfAvailable:(id)a3 withAssetTargetOSVersion:(id)a4 withAssetTargetBuildVersion:(id)a5 withAssetTargetTrainName:(id)a6 withAssetTargetRestoreVersion:(id)a7
{
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = a6;
  v15 = a7;
  v20.opaque[0] = 0;
  v20.opaque[1] = 0;
  v16 = _os_activity_create(&dword_0, "MADAutoControl:stagerStartSetJobDetermineIfAvailable", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v16, &v20);

  v17 = [MADAutoAssetControlManager autoControlManager:v20.opaque[0]];
  v18 = [[MADAutoAssetControlManagerParam alloc] initForStagerSetJobStart:v11 withAssetTargetOSVersion:v12 withAssetTargetBuildVersion:v13 withAssetTargetTrainName:v14 withAssetTargetRestoreVersion:v15];
  v19 = [v17 autoControlManagerFSM];
  [v19 postEvent:@"StagerStartDetermine" withInfo:v18];

  os_activity_scope_leave(&v20);
}

+ (void)stagerStartJobDownloadForStaging:(id)a3 withStagerSetConfiguration:(id)a4 usingCachedAutoAssetCatalog:(id)a5 usingBaseForPatching:(id)a6 withAssetTargetOSVersion:(id)a7 withAssetTargetBuildVersion:(id)a8
{
  v13 = a3;
  v14 = a4;
  v15 = a5;
  v16 = a6;
  v17 = a7;
  v18 = a8;
  v23.opaque[0] = 0;
  v23.opaque[1] = 0;
  v19 = _os_activity_create(&dword_0, "MADAutoControl:stagerStartJobDownloadForStaging", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v19, &v23);

  v20 = [MADAutoAssetControlManager autoControlManager:v23.opaque[0]];
  v21 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobStart:v13 withStagerSetConfiguration:v14 usingCachedAutoAssetCatalog:v15 usingBaseForPatching:v16 withAssetTargetOSVersion:v17 withAssetTargetBuildVersion:v18];
  v22 = [v20 autoControlManagerFSM];
  [v22 postEvent:@"StagerStartDownload" withInfo:v21];

  os_activity_scope_leave(&v23);
}

+ (void)stagerCancelCurrentJob
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:stagerCancelCurrentJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  v4 = [v3 autoControlManagerFSM];
  v5 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"stagerCancelCurrentJob"];
  [v4 postEvent:@"StagerCancelCurrentJob" withInfo:v5];

  os_activity_scope_leave(&v6);
}

+ (void)stagerEliminatedSelector:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerEliminatedSelector", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"StagerEliminatedSelector" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerEliminatedSetConfiguration:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerEliminatedSetConfiguration", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"StagerEliminatedConfiguration" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerPurgeStagedContent:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerPurgeStagedContent", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAutoAssetDescriptors:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"StagerPurgeStagedContent" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)schedulerTriggeredSelectors:(id)a3
{
  v3 = a3;
  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredSelectors", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v9);

  v5 = [MADAutoAssetControlManager autoControlManager:v9.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredSelectors" UTF8String];
  v6 = os_transaction_create();
  v7 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredSelectors:v3 withEventOSTransaction:v6];
  v8 = [v5 autoControlManagerFSM];
  [v8 postEvent:@"SchedulerTriggered" withInfo:v7];

  os_activity_scope_leave(&v9);
}

+ (void)schedulerTriggeredSets:(id)a3
{
  v3 = a3;
  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredSets", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v9);

  v5 = [MADAutoAssetControlManager autoControlManager:v9.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredSets" UTF8String];
  v6 = os_transaction_create();
  v7 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredSets:v3 withEventOSTransaction:v6];
  v8 = [v5 autoControlManagerFSM];
  [v8 postEvent:@"SchedulerSetsTriggered" withInfo:v7];

  os_activity_scope_leave(&v9);
}

+ (void)schedulerTriggeredNoActivity
{
  v7.opaque[0] = 0;
  v7.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredNoActivity", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v7);

  v3 = [MADAutoAssetControlManager autoControlManager:v7.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredNoActivity" UTF8String];
  v4 = os_transaction_create();
  v5 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredNoActivity:v4];
  v6 = [v3 autoControlManagerFSM];
  [v6 postEvent:@"SchedulerNoActivity" withInfo:v5];

  os_activity_scope_leave(&v7);
}

+ (void)schedulerTickOccurred
{
  v7.opaque[0] = 0;
  v7.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTickOccurred", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v7);

  v3 = [MADAutoAssetControlManager autoControlManager:v7.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTickOccurred" UTF8String];
  v4 = os_transaction_create();
  v5 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredNoActivity:v4];
  v6 = [v3 autoControlManagerFSM];
  [v6 postEvent:@"SchedulerTickOccurred" withInfo:v5];

  os_activity_scope_leave(&v7);
}

+ (void)schedulerEliminatedSelector:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerEliminatedSelector", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"SchedulerEliminatedSelector" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)schedulerEliminatedSetDomainName:(id)a3 forAssetSetIdentifier:(id)a4
{
  v5 = a3;
  v6 = a4;
  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:schedulerEliminatedSetDomainName", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v13);

  v8 = [MAAutoAssetSelector alloc];
  v9 = [v8 initForAssetType:v5 withAssetSpecifier:{v6, v13.opaque[0], v13.opaque[1]}];
  v10 = +[MADAutoAssetControlManager autoControlManager];
  v11 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v9];
  v12 = [v10 autoControlManagerFSM];
  [v12 postEvent:@"SchedulerEliminatedSelector" withInfo:v11];

  os_activity_scope_leave(&v13);
}

- (BOOL)schedulerReferencesDescriptor:(id)a3
{
  v3 = a3;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerReferencesDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v20 = 0u;
  v21 = 0u;
  v18 = 0u;
  obj = v19 = 0u;
  v5 = [obj countByEnumeratingWithState:&v18 objects:v23 count:16];
  if (v5)
  {
    v17 = *v19;
    do
    {
      for (i = 0; i != v5; i = i + 1)
      {
        if (*v19 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v7 = *(*(&v18 + 1) + 8 * i);
        v8 = [v7 assetSelector];
        v9 = [v8 assetType];
        v10 = [v3 assetType];
        if (([SUCore stringIsEqual:v9 to:v10]& 1) != 0)
        {
          v11 = [v7 assetSelector];
          v12 = [v11 assetSpecifier];
          v13 = [v3 assetSpecifier];
          v14 = [SUCore stringIsEqual:v12 to:v13];

          if (v14)
          {
            LOBYTE(v5) = 1;
            goto LABEL_12;
          }
        }

        else
        {
        }
      }

      v5 = [obj countByEnumeratingWithState:&v18 objects:v23 count:16];
    }

    while (v5);
  }

LABEL_12:

  os_activity_scope_leave(&state);
  return v5;
}

+ (void)secureOperationsFinished:(id)a3 forSetDescriptor:(id)a4 forAutoAssetDescriptors:(id)a5
{
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureOperationsFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:v7 forSetDescriptor:v8 forAutoAssetDescriptors:v9];
  v13 = [v11 autoControlManagerFSM];
  [v13 postEvent:@"SecureOperationsFinished" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)handleReceivedPushNotifications:(id)a3
{
  v3 = a3;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:handleReceivedPushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForReceivedPushNotifications:v3];
  v7 = [v5 autoControlManagerFSM];
  [v7 postEvent:@"PushNotificationReceived" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)postNotificationName:(id)a3 forAssetType:(id)a4 forAssetSpecifier:(id)a5 fromModule:(id)a6 fromLocation:(id)a7
{
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = a6;
  v15 = a7;
  if (v13)
  {
    v16 = [[NSString alloc] initWithFormat:@" | assetSpecifier:%@", v13];
  }

  else
  {
    v16 = &stru_4BD3F0;
  }

  if (objc_opt_respondsToSelector() & 1) != 0 && (objc_opt_respondsToSelector())
  {
    v17 = [MAAutoAssetNotifications notifyRegistrationName:v11 forAssetType:v12];
    v18 = notify_post([v17 UTF8String]);
    v19 = v18;
    if (v13)
    {
      v20 = [MAAutoAssetNotifications notifyRegistrationName:v11 forAssetType:v12 forAssetSpecifier:v13];

      v17 = v20;
      v21 = notify_post([v20 UTF8String]);
      if (v19 | v21)
      {
        v22 = v21;
        v23 = _MADLog(@"Auto");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          *buf = 138545666;
          v29 = @">----->";
          v30 = 2114;
          v31 = v15;
          v32 = 2114;
          v33 = @"P_ERR";
          v34 = 2114;
          v35 = v11;
          v36 = 2114;
          v37 = @"P_ERR";
          v38 = 2114;
          v39 = v12;
          v40 = 2114;
          v41 = v16;
          v42 = 2048;
          v43 = v19;
          v44 = 2048;
          v45 = v22;
          v46 = 2114;
          v47 = @"<-----<";
          v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@%{public}@ | result:%lu specifierResult:%lu\n#_NOTIF:%{public}@";
          v25 = v23;
          v26 = OS_LOG_TYPE_ERROR;
          v27 = 102;
LABEL_18:
          _os_log_impl(&dword_0, v25, v26, v24, buf, v27);
        }

LABEL_19:

        goto LABEL_20;
      }
    }

    else if (v18)
    {
      v23 = _MADLog(@"Auto");
      if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_19;
      }

      *buf = 138545154;
      v29 = @">----->";
      v30 = 2114;
      v31 = v15;
      v32 = 2114;
      v33 = @"P_ERR";
      v34 = 2114;
      v35 = v11;
      v36 = 2114;
      v37 = @"P_ERR";
      v38 = 2114;
      v39 = v12;
      v40 = 2048;
      v41 = v19;
      v42 = 2114;
      v43 = @"<-----<";
      v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@ | result:%lu\n#_NOTIF:%{public}@";
      v25 = v23;
      v26 = OS_LOG_TYPE_ERROR;
LABEL_17:
      v27 = 82;
      goto LABEL_18;
    }

    v23 = _MADLog(@"Auto");
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_19;
    }

    *buf = 138545154;
    v29 = @">----->";
    v30 = 2114;
    v31 = v15;
    v32 = 2114;
    v33 = @"EVENT";
    v34 = 2114;
    v35 = v11;
    v36 = 2114;
    v37 = @"EVENT";
    v38 = 2114;
    v39 = v12;
    v40 = 2114;
    v41 = v16;
    v42 = 2114;
    v43 = @"<-----<";
    v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@%{public}@\n#_NOTIF:%{public}@";
    v25 = v23;
    v26 = OS_LOG_TYPE_DEFAULT;
    goto LABEL_17;
  }

  v17 = _MADLog(@"Auto");
  if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545154;
    v29 = @">----->";
    v30 = 2114;
    v31 = v15;
    v32 = 2114;
    v33 = @"EVENT";
    v34 = 2114;
    v35 = v11;
    v36 = 2114;
    v37 = @"EVENT";
    v38 = 2114;
    v39 = v12;
    v40 = 2114;
    v41 = v16;
    v42 = 2114;
    v43 = @"<-----<";
    _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL\n!_NOTIF:%{public}@ {%{public}@:postNotificationName}\n!_NOTIF:(%{public}@) un-posted notification:%{public}@\n!_NOTIF:(%{public}@) assetType:%{public}@%{public}@\n!_NOTIF:%{public}@", buf, 0x52u);
  }

LABEL_20:
}

+ (void)postSetNotificationName:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 forAtomicInstanceUUID:(id)a6 fromModule:(id)a7 fromLocation:(id)a8
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a8;
  v17 = +[MADAutoAssetControlManager autoControlManager];
  v18 = [v17 autoControlManagerFSM];

  if (!v18)
  {
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v30 = v12;
      v31 = 2112;
      v32 = v13;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "AUTO-SET-CONTROL: Not posting notification %@ for clientDomain %@ since FSM is not initialized", buf, 0x16u);
    }

    goto LABEL_6;
  }

  if (v17)
  {
    v19 = [v17 autoControlManagerFSM];
    v20 = [v19 extendedStateQueue];
    v22[0] = _NSConcreteStackBlock;
    v22[1] = 3221225472;
    v22[2] = __142__MADAutoAssetControlManager_postSetNotificationName_forClientDomainName_forAssetSetIdentifier_forAtomicInstanceUUID_fromModule_fromLocation___block_invoke;
    v22[3] = &unk_4B3818;
    v23 = v12;
    v24 = v17;
    v25 = v13;
    v26 = v14;
    v27 = v15;
    v28 = v16;
    dispatch_async(v20, v22);

    v21 = v23;
LABEL_6:
  }
}

void __142__MADAutoAssetControlManager_postSetNotificationName_forClientDomainName_forAssetSetIdentifier_forAtomicInstanceUUID_fromModule_fromLocation___block_invoke(uint64_t a1)
{
  v2 = [MANAutoAssetSetNotifications notifyRegistrationName:*(a1 + 32)];
  v3 = [*(a1 + 40) locateSetConfigurationByClientDomain:*(a1 + 48) forAssetSetIdentifier:*(a1 + 56)];
  v4 = [NSString alloc];
  v5 = v4;
  if (v3)
  {
    if (*(a1 + 64))
    {
      v6 = *(a1 + 64);
    }

    else
    {
      v6 = @"N";
    }

    v7 = [v3 summary];
    v8 = [v5 initWithFormat:@" atomicInstanceUUID:%@ | setConfiguration:%@", v6, v7];
  }

  else
  {
    v9 = @"N";
    v10 = *(a1 + 48);
    if (!v10)
    {
      v10 = @"N";
    }

    if (*(a1 + 56))
    {
      v9 = *(a1 + 56);
    }

    v8 = [v4 initWithFormat:@" clientDomainName:%@ | assetSetIdentifier:%@", v10, v9];
  }

  v11 = notify_post([v2 UTF8String]);
  if (*(a1 + 56))
  {
    v12 = [MANAutoAssetSetNotifications notifyRegistrationName:*(a1 + 32) forAssetSetIdentifier:?];

    v13 = notify_post([v12 UTF8String]);
    v2 = v12;
  }

  else
  {
    v13 = 0;
  }

  if (v11 | v13)
  {
    v20 = *(a1 + 56);
    v14 = _MADLog(@"Auto");
    v21 = os_log_type_enabled(v14, OS_LOG_TYPE_ERROR);
    if (v20)
    {
      if (v21)
      {
        v22 = *(a1 + 72);
        v23 = *(a1 + 32);
        *buf = 138545410;
        v28 = @">----->";
        v29 = 2114;
        v30 = v22;
        v31 = 2114;
        v32 = @"P_ERR";
        v33 = 2114;
        v34 = v23;
        v35 = 2114;
        v36 = v8;
        v37 = 2114;
        v38 = @"P_ERR";
        v39 = 2048;
        v40 = v11;
        v41 = 2048;
        v42 = v13;
        v43 = 2114;
        v44 = @"<-----<";
        v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@)%{public}@ | result:%lu specifierResult:%lu\n#_NOTIF:%{public}@";
        v18 = v14;
        v19 = OS_LOG_TYPE_ERROR;
        v24 = 92;
LABEL_23:
        _os_log_impl(&dword_0, v18, v19, v17, buf, v24);
      }
    }

    else if (v21)
    {
      v25 = *(a1 + 72);
      v26 = *(a1 + 32);
      *buf = 138544898;
      v28 = @">----->";
      v29 = 2114;
      v30 = v25;
      v31 = 2114;
      v32 = @"P_ERR";
      v33 = 2114;
      v34 = v26;
      v35 = 2114;
      v36 = @"P_ERR";
      v37 = 2048;
      v38 = v11;
      v39 = 2114;
      v40 = @"<-----<";
      v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) | result:%lu\n#_NOTIF:%{public}@";
      v18 = v14;
      v19 = OS_LOG_TYPE_ERROR;
      goto LABEL_22;
    }
  }

  else
  {
    v14 = _MADLog(@"Auto");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      v15 = *(a1 + 72);
      v16 = *(a1 + 32);
      *buf = 138544898;
      v28 = @">----->";
      v29 = 2114;
      v30 = v15;
      v31 = 2114;
      v32 = @"EVENT";
      v33 = 2114;
      v34 = v16;
      v35 = 2114;
      v36 = @"EVENT";
      v37 = 2114;
      v38 = v8;
      v39 = 2114;
      v40 = @"<-----<";
      v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@)%{public}@\n#_NOTIF:%{public}@";
      v18 = v14;
      v19 = OS_LOG_TYPE_DEFAULT;
LABEL_22:
      v24 = 72;
      goto LABEL_23;
    }
  }
}

+ (void)copyCurrentDownloadedDescriptors:(BOOL)a3 unlockedUnreferencedDescriptors:(id *)a4 unlockedReferencedDescriptors:(id *)a5 lockedOverridableDescriptors:(id *)a6 lockedNeverRemoveDescriptors:(id *)a7 stagedDescriptors:(id *)a8
{
  v13 = +[MADAutoAssetControlManager autoControlManager];
  v50 = 0;
  v51 = &v50;
  v52 = 0x3032000000;
  v53 = __Block_byref_object_copy__12;
  v54 = __Block_byref_object_dispose__12;
  v55 = objc_alloc_init(NSMutableDictionary);
  v44 = 0;
  v45 = &v44;
  v46 = 0x3032000000;
  v47 = __Block_byref_object_copy__12;
  v48 = __Block_byref_object_dispose__12;
  v49 = objc_alloc_init(NSMutableDictionary);
  v38 = 0;
  v39 = &v38;
  v40 = 0x3032000000;
  v41 = __Block_byref_object_copy__12;
  v42 = __Block_byref_object_dispose__12;
  v43 = objc_alloc_init(NSMutableDictionary);
  v32 = 0;
  v33 = &v32;
  v34 = 0x3032000000;
  v35 = __Block_byref_object_copy__12;
  v36 = __Block_byref_object_dispose__12;
  v37 = objc_alloc_init(NSMutableDictionary);
  v26 = 0;
  v27 = &v26;
  v28 = 0x3032000000;
  v29 = __Block_byref_object_copy__12;
  v30 = __Block_byref_object_dispose__12;
  v31 = objc_alloc_init(NSMutableDictionary);
  v14 = [v13 autoControlManagerFSM];

  if (v14)
  {
    v15 = [v13 autoControlManagerFSM];
    v16 = [v15 extendedStateQueue];
    v18[0] = _NSConcreteStackBlock;
    v18[1] = 3221225472;
    v18[2] = __201__MADAutoAssetControlManager_copyCurrentDownloadedDescriptors_unlockedUnreferencedDescriptors_unlockedReferencedDescriptors_lockedOverridableDescriptors_lockedNeverRemoveDescriptors_stagedDescriptors___block_invoke;
    v18[3] = &unk_4B44C8;
    v19 = v13;
    v20 = &v44;
    v21 = &v50;
    v22 = &v32;
    v23 = &v38;
    v24 = &v26;
    dispatch_sync(v16, v18);

    if (a4)
    {
      *a4 = v51[5];
    }

    if (a5)
    {
      *a5 = v45[5];
    }

    if (a6)
    {
      *a6 = v39[5];
    }

    if (a7)
    {
      *a7 = v33[5];
    }

    if (a8)
    {
      *a8 = v27[5];
    }

    v17 = v19;
  }

  else
  {
    v17 = _MADLog(@"Auto");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{copyCurrentDownloadedDescriptors} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }

  _Block_object_dispose(&v26, 8);
  _Block_object_dispose(&v32, 8);

  _Block_object_dispose(&v38, 8);
  _Block_object_dispose(&v44, 8);

  _Block_object_dispose(&v50, 8);
}

void __201__MADAutoAssetControlManager_copyCurrentDownloadedDescriptors_unlockedUnreferencedDescriptors_unlockedReferencedDescriptors_lockedOverridableDescriptors_lockedNeverRemoveDescriptors_stagedDescriptors___block_invoke(uint64_t a1)
{
  v31 = +[MADAutoAssetLocker copyOfLocksBySelector];
  v2 = objc_alloc_init(NSMutableArray);
  [*(a1 + 32) ensureStagerFullyResumed];
  v28 = v2;
  [MADAutoAssetStager extendSummaryWithStagedAssets:v2 basedOnControl:0];
  v32 = a1;
  [*(a1 + 32) locateDownloadedNewAllBySelector];
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  v3 = v36 = 0u;
  v4 = [v3 countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (v4)
  {
    v5 = v4;
    v29 = a1 + 48;
    v30 = a1 + 40;
    v6 = *v34;
    do
    {
      for (i = 0; i != v5; i = i + 1)
      {
        if (*v34 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v8 = *(*(&v33 + 1) + 8 * i);
        v9 = objc_autoreleasePoolPush();
        v10 = [v3 safeObjectForKey:v8 ofClass:objc_opt_class()];
        if (v10)
        {
          v11 = [MAAutoAssetSelector alloc];
          v12 = [v10 assetType];
          v13 = [v10 assetSpecifier];
          v14 = [v10 assetVersion];
          v15 = [v11 initForAssetType:v12 withAssetSpecifier:v13 matchingAssetVersion:v14];

          v16 = [v15 persistedEntryID];
          v17 = [v31 safeObjectForKey:v16 ofClass:objc_opt_class()];
          v18 = v17;
          if (v17)
          {
            v19 = [v17 inhibitedFromEmergencyRemoval];
            v20 = 64;
            if (v19)
            {
              v20 = 56;
            }

            v21 = v32 + v20;
          }

          else
          {
            v22 = [*(v32 + 32) setConfigurationReferencesDescriptor:v10];
            v21 = v30;
            if ((v22 & 1) == 0)
            {
              v23 = [*(v32 + 32) schedulerReferencesDescriptor:v10];
              v21 = v30;
              if ((v23 & 1) == 0)
              {
                v24 = [v10 foundByLookupWithoutAssetVersion];
                v21 = v29;
                if (!v24)
                {
                  v21 = v30;
                }
              }
            }
          }

          [*(*(*v21 + 8) + 40) setSafeObject:v10 forKey:v16];
        }

        objc_autoreleasePoolPop(v9);
      }

      v5 = [v3 countByEnumeratingWithState:&v33 objects:v37 count:16];
    }

    while (v5);
  }

  [*(v32 + 32) ensureStagerFullyResumed];
  v25 = +[MADAutoAssetStager controlCopyCurrentStagedDescriptors];
  v26 = *(*(v32 + 72) + 8);
  v27 = *(v26 + 40);
  *(v26 + 40) = v25;
}

+ (BOOL)assetBeingGarbageCollected:(id)a3 atEmergencyUrgency:(BOOL)a4
{
  v5 = a3;
  v6 = +[MADAutoAssetControlManager autoControlManager];
  v36 = 0;
  v37 = &v36;
  v38 = 0x3032000000;
  v39 = __Block_byref_object_copy__12;
  v40 = __Block_byref_object_dispose__12;
  v41 = 0;
  v32 = 0;
  v33 = &v32;
  v34 = 0x2020000000;
  v35 = 0;
  v7 = [MAAutoAssetSelector alloc];
  v8 = [v5 assetType];
  v9 = [v5 assetSpecifier];
  v10 = [v5 assetVersion];
  v11 = [v7 initForAssetType:v8 withAssetSpecifier:v9 matchingAssetVersion:v10];

  v12 = [v6 autoControlManagerFSM];

  if (v12)
  {
    v13 = [v6 autoControlManagerFSM];
    v14 = [v13 extendedStateQueue];
    v21 = _NSConcreteStackBlock;
    v22 = 3221225472;
    v23 = __76__MADAutoAssetControlManager_assetBeingGarbageCollected_atEmergencyUrgency___block_invoke;
    v24 = &unk_4B44F0;
    v25 = v6;
    v30 = a4;
    v26 = v11;
    v28 = &v36;
    v29 = &v32;
    v15 = v5;
    v27 = v15;
    dispatch_sync(v14, &v21);

    if (v37[5])
    {
      if (*(v33 + 24) != 1)
      {
LABEL_10:
        v19 = v37[5];

        goto LABEL_11;
      }

      v16 = [v15 assetType];
      v17 = [v15 assetSpecifier];
      [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_RECLAIM_DESIRED" forAssetType:v16 forAssetSpecifier:v17 fromModule:@"CACHE-DELETE" fromLocation:@"assetBeingGarbageCollected"];
    }

    else
    {
      v16 = [v15 assetType];
      v17 = [v15 assetSpecifier];
      [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_RECLAIMED" forAssetType:v16 forAssetSpecifier:v17 fromModule:@"CACHE-DELETE" fromLocation:@"assetBeingGarbageCollected"];
    }

    goto LABEL_10;
  }

  v18 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{assetBeingGarbageCollected} Skipping operation since FSM is not initialized", buf, 2u);
  }

  v19 = v37[5];
LABEL_11:

  _Block_object_dispose(&v32, 8);
  _Block_object_dispose(&v36, 8);

  return v19 == 0;
}

void __76__MADAutoAssetControlManager_assetBeingGarbageCollected_atEmergencyUrgency___block_invoke(uint64_t a1)
{
  v2 = +[MADAutoAssetLocker copyOfLocksBySelector];
  [*(a1 + 32) locateDownloadedNewForSelector:@"assetBeingGarbageCollected" assetSelector:*(a1 + 40) limitedToStaging:0];
  v3 = memset(v42, 0, sizeof(v42));
  if (![v3 countByEnumeratingWithState:v42 objects:v49 count:16])
  {

    v9 = 0;
    goto LABEL_12;
  }

  v4 = **(&v42[0] + 1);
  v5 = objc_autoreleasePoolPush();
  v6 = [v3 safeObjectForKey:v4 ofClass:{objc_opt_class(), *&v42[0]}];
  v7 = [*(a1 + 40) persistedEntryID];
  v8 = [v2 safeObjectForKey:v7 ofClass:objc_opt_class()];

  v9 = v8 != 0;
  if (v8)
  {
    v10 = @"locked(blocked unless emergency)";
    if (*(a1 + 72) != 1)
    {
LABEL_7:
      objc_storeStrong((*(*(a1 + 56) + 8) + 40), v10);
      v9 = 0;
      v11 = 0;
      *(*(*(a1 + 64) + 8) + 24) = 1;
      goto LABEL_10;
    }

    if ([v8 inhibitedFromEmergencyRemoval])
    {
      if (*(a1 + 72))
      {
        v10 = @"locked(inhibited from emergency removal)";
      }

      goto LABEL_7;
    }
  }

  v11 = v6;
LABEL_10:

  objc_autoreleasePoolPop(v5);
  if (v11)
  {
    v12 = 0;
    goto LABEL_28;
  }

LABEL_12:
  if (!*(*(*(a1 + 56) + 8) + 40))
  {
    v13 = [*(a1 + 32) stagerCurrentJob];
    if (v13 && (v14 = v13, v15 = *(a1 + 40), [*(a1 + 32) stagerCurrentJob], v16 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v16, "autoAssetSelector"), v17 = objc_claimAutoreleasedReturnValue(), LOBYTE(v15) = objc_msgSend(v15, "isEqual:", v17), v17, v16, v14, (v15 & 1) != 0))
    {
      v18 = @"stager-job(currently being staged)";
    }

    else
    {
      v19 = [*(a1 + 32) stagerBondedToAutoJob];
      if (!v19)
      {
        goto LABEL_20;
      }

      v20 = v19;
      v21 = *(a1 + 40);
      v22 = [*(a1 + 32) stagerBondedToAutoJob];
      v23 = [v22 autoAssetSelector];
      LODWORD(v21) = [v21 isEqual:v23];

      if (!v21)
      {
        goto LABEL_20;
      }

      v18 = @"stager-job(bonded to auto-job)";
    }

    v24 = *(*(a1 + 56) + 8);
    v25 = *(v24 + 40);
    *(v24 + 40) = v18;
  }

LABEL_20:
  v26 = *(a1 + 56);
  if (!*(*(v26 + 8) + 40))
  {
    v27 = [*(a1 + 32) isAutoAssetBeingEliminated:*(a1 + 40)];
    v26 = *(a1 + 56);
    if (v27)
    {
      v28 = *(v26 + 8);
      v29 = *(v28 + 40);
      *(v28 + 40) = @"eliminating(client-requested eliminate in progress)";

      v26 = *(a1 + 56);
    }
  }

  if (!*(*(v26 + 8) + 40))
  {
    v30 = [*(a1 + 32) currentJobBySelector:*(a1 + 40)];
    if (v30)
    {
      v31 = *(*(a1 + 56) + 8);
      v32 = *(v31 + 40);
      *(v31 + 40) = @"active(auto-asset-job in progress)";
    }
  }

  v11 = 0;
  v12 = 1;
LABEL_28:
  if (*(*(*(a1 + 56) + 8) + 40))
  {
    if (v12)
    {
      goto LABEL_45;
    }
  }

  else
  {
    [*(a1 + 32) ensureStagerFullyResumed];
    [MADAutoAssetStager garbageCollectEliminateSelector:*(a1 + 40)];
    if (v12)
    {
      goto LABEL_45;
    }
  }

  if (!*(*(*(a1 + 56) + 8) + 40))
  {
    if ([v11 secureOperationEliminating])
    {
      v33 = *(*(a1 + 56) + 8);
      v34 = *(v33 + 40);
      *(v33 + 40) = @"elimination triggered while ungrafting";

      [*(a1 + 32) eliminateUngraftDescriptor:*(*(*(a1 + 56) + 8) + 40) forAutoAssetDescriptor:v11 failingClientRequestForEventInfo:0];
    }

    else
    {
      if (v9)
      {
        v35 = 349;
      }

      else
      {
        v35 = 348;
      }

      if (v9)
      {
        v36 = 391;
      }

      else
      {
        v36 = 390;
      }

      if (v9)
      {
        v37 = 406;
      }

      else
      {
        v37 = 405;
      }

      [*(a1 + 32) forceGlobalUnlockFromLocation:@"assetBeingGarbageCollected" dueToError:0 fullAssetSelector:*(a1 + 40) historyOperationAI:v35 historyOperationSD:{v36, *&v42[0]}];
      [*(a1 + 32) _removeDescriptorFromFilesystem:@"assetBeingGarbageCollected" droppingDescriptor:v11 forHistoryOperation:v37 firstClientName:0];
    }
  }

LABEL_45:
  v38 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    v39 = @"N";
    if (v12)
    {
      v40 = @"N";
    }

    else
    {
      v40 = [v11 summary];
    }

    if (*(*(*(a1 + 56) + 8) + 40))
    {
      v39 = *(*(*(a1 + 56) + 8) + 40);
    }

    v41 = [*(a1 + 48) summary];
    *buf = 138543874;
    v44 = v40;
    v45 = 2114;
    v46 = v39;
    v47 = 2114;
    v48 = v41;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{assetBeingGarbageCollected} | downloadedDescriptor:%{public}@ | blockGarbageCollectionReason:%{public}@ | descriptorToBeRemoved:%{public}@", buf, 0x20u);
    if ((v12 & 1) == 0)
    {
    }
  }
}

+ (void)garbageCollectionOperationComplete:(BOOL)a3 originalUnlockedUnreferencedDescriptors:(id)a4 originalUnlockedReferencedDescriptors:(id)a5 originalLockedOverridableDescriptors:(id)a6 originalLockedNeverRemoveDescriptors:(id)a7 originalStagedDescriptors:(id)a8 totalReclaimedSpace:(int64_t)a9 results:(id)a10
{
  v11 = a10;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v13 = [v12 autoControlManagerFSM];

  if (v13)
  {
    v14 = [v12 autoControlManagerFSM];
    v15 = [v14 extendedStateQueue];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __271__MADAutoAssetControlManager_garbageCollectionOperationComplete_originalUnlockedUnreferencedDescriptors_originalUnlockedReferencedDescriptors_originalLockedOverridableDescriptors_originalLockedNeverRemoveDescriptors_originalStagedDescriptors_totalReclaimedSpace_results___block_invoke;
    v17[3] = &unk_4B4518;
    v18 = v11;
    v21 = a3;
    v19 = v12;
    v20 = a9;
    dispatch_sync(v15, v17);

    v16 = v18;
  }

  else
  {
    v16 = _MADLog(@"Auto");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{garbageCollectionOperationComplete} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }
}

id __271__MADAutoAssetControlManager_garbageCollectionOperationComplete_originalUnlockedUnreferencedDescriptors_originalUnlockedReferencedDescriptors_originalLockedOverridableDescriptors_originalLockedNeverRemoveDescriptors_originalStagedDescriptors_totalReclaimedSpace_results___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) reclaimUnlockedUnreferencedAutoAssetCount];
  v3 = [*(a1 + 32) reclaimUnlockedReferencedAutoAssetCount];
  v4 = [*(a1 + 32) reclaimUnlockedUnreferencedAutoAssetSpace];
  v5 = [*(a1 + 32) reclaimUnlockedReferencedAutoAssetSpace];
  v6 = [*(a1 + 40) statistics];
  [v6 setGarbageCollectionPerformed:1];

  v7 = *(a1 + 56);
  v8 = [*(a1 + 40) statistics];
  [v8 setGarbageCollectionReclaimSpace:v7];

  v9 = *(a1 + 48);
  v10 = [*(a1 + 40) statistics];
  [v10 setGarbageCollectionTotalReclaimedSpace:v9];

  v11 = [*(a1 + 32) reclaimV2AssetCount];
  v12 = [*(a1 + 40) statistics];
  [v12 setGarbageCollectionReclaimedV2AssetCount:v11];

  v13 = [*(a1 + 32) reclaimV2AssetSpace];
  v14 = [*(a1 + 40) statistics];
  [v14 setGarbageCollectionReclaimedV2AssetSpace:v13];

  v15 = [*(a1 + 40) statistics];
  [v15 setGarbageCollectionReclaimedUnlockedCount:&v2[v3]];

  v16 = [*(a1 + 40) statistics];
  [v16 setGarbageCollectionReclaimedUnlockedSpace:&v4[v5]];

  v17 = [*(a1 + 32) reclaimLockedOverridableAutoAssetCount];
  v18 = [*(a1 + 40) statistics];
  [v18 setGarbageCollectionReclaimedLockedOverridableCount:v17];

  v19 = [*(a1 + 32) reclaimLockedOverridableAutoAssetSpace];
  v20 = [*(a1 + 40) statistics];
  [v20 setGarbageCollectionReclaimedLockedOverridableSpace:v19];

  v21 = [*(a1 + 32) reclaimLockedNeverRemoveAutoAssetCount];
  v22 = [*(a1 + 40) statistics];
  [v22 setGarbageCollectionReclaimedLockedNeverRemoveCount:v21];

  v23 = [*(a1 + 32) reclaimLockedNeverRemoveAutoAssetSpace];
  v24 = [*(a1 + 40) statistics];
  [v24 setGarbageCollectionReclaimedLockedNeverRemoveSpace:v23];

  v25 = [*(a1 + 32) reclaimStagedAutoAssetCount];
  v26 = [*(a1 + 40) statistics];
  [v26 setGarbageCollectionReclaimedStagedCount:v25];

  v27 = [*(a1 + 32) reclaimStagedAutoAssetSpace];
  v28 = [*(a1 + 40) statistics];
  [v28 setGarbageCollectionReclaimedStagedSpace:v27];

  v29 = [*(a1 + 32) reclaimMetadataBlockedSpace];
  v30 = [*(a1 + 40) statistics];
  [v30 setGarbageCollectionReclaimedMetadataBlockedCount:v29];

  v31 = [*(a1 + 32) reclaimMetadataBlockedSpace];
  v32 = [*(a1 + 40) statistics];
  [v32 setGarbageCollectionReclaimedMetadataBlockedSpace:v31];

  v33 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
  {
    v34 = [*(a1 + 40) _updateLatestSummary];
    v35 = [*(a1 + 40) statistics];
    v36 = [v35 summary];
    v38 = 138543618;
    v39 = v34;
    v40 = 2114;
    v41 = v36;
    _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | garbage collection | statistics:%{public}@", &v38, 0x16u);
  }

  return [*(a1 + 40) _statsMaintainReporting];
}

- (BOOL)isAutoAssetBeingEliminated:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:v4];

  return v7 != 0;
}

- (id)eliminateTrackerForSelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v8 = [v4 persistedEntryID];
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v10 = [v7 safeObjectForKey:v8 ofClass:objc_opt_class()];

  if (!v10)
  {
    v11 = [MAAutoAssetSelector alloc];
    v12 = [v4 assetType];
    v13 = [v4 assetSpecifier];
    v14 = [v11 initForAssetType:v12 withAssetSpecifier:v13];

    v15 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    v16 = [v14 persistedEntryID];
    v10 = [v15 safeObjectForKey:v16 ofClass:objc_opt_class()];

    if (!v10)
    {
      v17 = [MAAutoAssetSelector alloc];
      v18 = [v4 assetType];
      v19 = [v17 initForAssetType:v18];

      v20 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      v21 = [v19 persistedEntryID];
      v10 = [v20 safeObjectForKey:v21 ofClass:objc_opt_class()];

      if (!v10)
      {
        v40 = 0u;
        v41 = 0u;
        v38 = 0u;
        v39 = 0u;
        obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
        v22 = [obj countByEnumeratingWithState:&v38 objects:v42 count:16];
        if (v22)
        {
          v23 = v22;
          v34 = v19;
          v35 = v14;
          v36 = v4;
          v24 = *v39;
          while (2)
          {
            for (i = 0; i != v23; i = i + 1)
            {
              if (*v39 != v24)
              {
                objc_enumerationMutation(obj);
              }

              v26 = *(*(&v38 + 1) + 8 * i);
              v27 = objc_autoreleasePoolPush();
              v28 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
              v10 = [v28 safeObjectForKey:v26 ofClass:objc_opt_class()];

              if (v10 && [v10 eliminatingSet])
              {
                v29 = p_weak_ivar_lyt;
                v30 = [v10 clientDomainName];
                v31 = [v10 assetSetIdentifier];
                v32 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v30 forAssetSetIdentifier:v31];

                if (v32 && ([v32 managesAssetSelector:v36] & 1) != 0)
                {

                  objc_autoreleasePoolPop(v27);
                  goto LABEL_18;
                }

                p_weak_ivar_lyt = v29;
              }

              objc_autoreleasePoolPop(v27);
            }

            v23 = [obj countByEnumeratingWithState:&v38 objects:v42 count:16];
            if (v23)
            {
              continue;
            }

            break;
          }

          v10 = 0;
LABEL_18:
          v14 = v35;
          v4 = v36;
          v19 = v34;
        }

        else
        {
          v10 = 0;
        }
      }
    }
  }

  return v10;
}

- (BOOL)isSetIdentifierBeingEliminated:(id)a3 forClientDomainName:(id)a4 ofSetIdentifier:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [[MAAutoAssetSelector alloc] initForAssetType:v8 withAssetSpecifier:v7];
  v12 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v13 = [v11 persistedEntryID];
  v14 = [v12 safeObjectForKey:v13 ofClass:objc_opt_class()];

  return v14 != 0;
}

- (BOOL)isSetIdentifierCurrentlyLocked:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:isSetIdentifierCurrentlyLocked", v8];
  v14 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v9 assetSetIdentifier:v10];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v13 ofContainer:@"setDescriptorKeysForAssetSet"];
  v31 = 0u;
  v32 = 0u;
  v29 = 0u;
  v30 = 0u;
  v15 = v14;
  v16 = [v15 countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v16)
  {
    v17 = v16;
    v27 = v9;
    v28 = v8;
    v18 = *v30;
    while (2)
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v30 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v29 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        v22 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:v13 forKey:v20];
        if (v22)
        {
          v23 = v22;
          v24 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v22];

          if (v24)
          {
            objc_autoreleasePoolPop(v21);
            v25 = 1;
            goto LABEL_12;
          }
        }

        objc_autoreleasePoolPop(v21);
      }

      v17 = [v15 countByEnumeratingWithState:&v29 objects:v33 count:16];
      if (v17)
      {
        continue;
      }

      break;
    }

    v25 = 0;
LABEL_12:
    v9 = v27;
    v8 = v28;
  }

  else
  {
    v25 = 0;
  }

  return v25;
}

- (BOOL)isSetDescriptorCurrentlyLocked:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v7];
  if (v10)
  {
    v33 = v6;
    v31 = [[NSString alloc] initWithFormat:@"%@:isSetDescriptorCurrentlyLocked", v6];
    [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v32 = v10;
    v11 = v10;
    v12 = [v11 countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v12)
    {
      v13 = v12;
      v34 = 0;
      v14 = *v45;
      v35 = *v45;
      v36 = v11;
      do
      {
        v15 = 0;
        v37 = v13;
        do
        {
          if (*v45 != v14)
          {
            objc_enumerationMutation(v11);
          }

          v16 = *(*(&v44 + 1) + 8 * v15);
          v17 = objc_autoreleasePoolPush();
          v18 = [v11 safeObjectForKey:v16 ofClass:objc_opt_class()];
          v19 = v18;
          if (v18)
          {
            v39 = v17;
            v42 = 0u;
            v43 = 0u;
            v40 = 0u;
            v41 = 0u;
            v20 = v18;
            v21 = [v20 countByEnumeratingWithState:&v40 objects:v48 count:16];
            if (v21)
            {
              v22 = v21;
              v38 = v19;
              v23 = *v41;
              while (2)
              {
                for (i = 0; i != v22; i = i + 1)
                {
                  if (*v41 != v23)
                  {
                    objc_enumerationMutation(v20);
                  }

                  v25 = *(*(&v40 + 1) + 8 * i);
                  v26 = objc_autoreleasePoolPush();
                  v27 = [v7 latestDownloadedAtomicInstance];
                  v28 = [SUCore stringIsEqual:v25 to:v27];

                  objc_autoreleasePoolPop(v26);
                  if (v28)
                  {
                    v34 = 1;
                    goto LABEL_18;
                  }
                }

                v22 = [v20 countByEnumeratingWithState:&v40 objects:v48 count:16];
                if (v22)
                {
                  continue;
                }

                break;
              }

LABEL_18:
              v14 = v35;
              v11 = v36;
              v13 = v37;
              v19 = v38;
            }

            v17 = v39;
          }

          objc_autoreleasePoolPop(v17);
          v15 = v15 + 1;
        }

        while (v15 != v13);
        v13 = [v11 countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v13);
    }

    else
    {
      v34 = 0;
    }

    v10 = v32;
    v6 = v33;
    v29 = v34;
  }

  else
  {
    v29 = 0;
  }

  return v29 & 1;
}

- (void)validateShortTermLockURL:(id)a3 normalizedClientDomainNameURL:(id)a4 normalizedAssetSetIdentifierURL:(id)a5 fileManager:(id)a6 isLatestLocker:(BOOL *)a7 isSpecificLocker:(BOOL *)a8
{
  v13 = a3;
  v14 = a4;
  v15 = a5;
  v16 = a6;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v19 = v13;
  v20 = objc_autoreleasePoolPush();
  v21 = [(__CFString *)v13 lastPathComponent];
  v22 = [NSString stringWithFormat:@"%@_", @"atomic_instance"];
  if (([v21 hasPrefix:v22]& 1) != 0)
  {
    v63 = v19;
    v23 = [v22 length];
    if (v23 > [v21 length])
    {
      v24 = _MADLog(@"AutoLocker");
      v19 = v63;
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v25 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, prefix A | shortTermLockURL:%@";
LABEL_7:
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, v25, buf, 0xCu);
        goto LABEL_8;
      }

      goto LABEL_8;
    }

    v29 = [v21 substringFromIndex:v23];

    if (!v29)
    {
      v21 = _MADLog(@"AutoLocker");
      v19 = v63;
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} unexpected error extracting atomic instance from path, prefix B | shortTermLockURL:%@", buf, 0xCu);
      }

      goto LABEL_9;
    }

    v30 = [NSString stringWithFormat:@".%@", @"locker"];
    if (([v29 hasSuffix:v30]& 1) != 0)
    {
      v31 = v29;
      v32 = [v29 length];
      if (v32 - [v30 length] > 0)
      {
        v33 = [v31 substringToIndex:?];

        v26 = v14;
        if (v33)
        {
          v27 = v15;
          v62 = v33;
          if ([v33 isEqualToString:@"latest"])
          {
            v65 = v30;
            v34 = _MADLog(@"AutoLocker");
            v28 = v16;
            if (os_log_type_enabled(v34, OS_LOG_TYPE_DEBUG))
            {
              v35 = [v26 lastPathComponent];
              v36 = [v27 lastPathComponent];
              *buf = 138543874;
              v68 = v35;
              v69 = 2114;
              v70 = v36;
              v71 = 2114;
              v72 = v62;
              _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEBUG, "{validateShortTermLockURL} latest | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x20u);
            }

            if (a7)
            {
              *a7 = 1;
            }

            v19 = v63;
            v30 = v65;
            goto LABEL_30;
          }

          v28 = v16;
          if ([v33 isEqualToString:@"specific"])
          {
            v40 = _MADLog(@"AutoLocker");
            if (os_log_type_enabled(v40, OS_LOG_TYPE_DEBUG))
            {
              v41 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              v43 = v42 = v30;
              *buf = 138543874;
              v68 = v41;
              v69 = 2114;
              v70 = v43;
              v71 = 2114;
              v72 = v62;
              _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEBUG, "{validateShortTermLockURL} specific | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x20u);

              v30 = v42;
            }

            if (a8)
            {
              *a8 = 1;
            }

            v19 = v63;
            goto LABEL_30;
          }

          v44 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
          v45 = v33;
          v46 = v44;
          v47 = [v44 objectForKeyedSubscript:v45];

          if (v47)
          {
            if ([(MADAutoAssetControlManager *)self atomicInstanceIsCurrentlyLocked:v47])
            {
              v48 = [v47 lockedSupportingShortTermLocking];
              v49 = _MADLog(@"AutoLocker");
              v50 = v49;
              if (v48)
              {
                if (os_log_type_enabled(v49, OS_LOG_TYPE_DEBUG))
                {
                  v51 = [v26 lastPathComponent];
                  [v27 lastPathComponent];
                  v53 = v52 = v30;
                  *buf = 138543874;
                  v68 = v51;
                  v69 = 2114;
                  v70 = v53;
                  v71 = 2114;
                  v72 = v62;
                  v54 = "{validateShortTermLockURL} found atomic instance for short-term lock file | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@";
                  v55 = v50;
                  v56 = OS_LOG_TYPE_DEBUG;
LABEL_53:
                  _os_log_impl(&dword_0, v55, v56, v54, buf, 0x20u);

                  v30 = v52;
                }
              }

              else if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR))
              {
                v51 = [v26 lastPathComponent];
                [v27 lastPathComponent];
                v53 = v52 = v30;
                *buf = 138543874;
                v68 = v51;
                v69 = 2114;
                v70 = v53;
                v71 = 2114;
                v72 = v62;
                v54 = "{validateShortTermLockURL} found atomic instance but not considered to support short-term locks | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@";
                v55 = v50;
                v56 = OS_LOG_TYPE_ERROR;
                goto LABEL_53;
              }

              v19 = v63;
              goto LABEL_55;
            }

            v66 = v30;
            v57 = _MADLog(@"AutoLocker");
            v58 = @"found atomic instance but not considered locked";
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
            {
              v61 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              *buf = 138544130;
              v68 = @"found atomic instance but not considered locked";
              v69 = 2114;
              v70 = v61;
              v72 = v71 = 2114;
              v59 = v72;
              v73 = 2114;
              v74 = v62;
              goto LABEL_49;
            }
          }

          else
          {
            v66 = v30;
            v57 = _MADLog(@"AutoLocker");
            v58 = @"short-term lock file exists for an atomic instance that does not exist";
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
            {
              v61 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              *buf = 138544130;
              v68 = @"short-term lock file exists for an atomic instance that does not exist";
              v69 = 2114;
              v70 = v61;
              v72 = v71 = 2114;
              v59 = v72;
              v73 = 2114;
              v74 = v62;
LABEL_49:
              _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} %{public}@ | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x2Au);
            }
          }

          v19 = v63;

          v50 = [(__CFString *)v63 path];
          v60 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:@"setDescriptorEliminateMatching" removingSharedLockFilename:v50 usingFileManager:v28 removingDescription:v58];
          v30 = v66;
LABEL_55:

          goto LABEL_30;
        }

        v39 = _MADLog(@"AutoLocker");
        v27 = v15;
        v19 = v63;
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
        {
          *buf = 138412290;
          v68 = v63;
          _os_log_impl(&dword_0, v39, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} unexpected error extracting atomic instance from path, suffix B | shortTermLockURL:%@", buf, 0xCu);
        }

        v62 = 0;
LABEL_29:
        v28 = v16;
LABEL_30:

        v21 = v62;
        goto LABEL_10;
      }

      v62 = v31;
      v37 = _MADLog(@"AutoLocker");
      v26 = v14;
      v19 = v63;
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v38 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, suffix A | shortTermLockURL:%@";
        goto LABEL_27;
      }
    }

    else
    {
      v62 = v29;
      v37 = _MADLog(@"AutoLocker");
      v26 = v14;
      v19 = v63;
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v38 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, missing suffix | shortTermLockURL:%@";
LABEL_27:
        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, v38, buf, 0xCu);
      }
    }

    v27 = v15;
    goto LABEL_29;
  }

  v24 = _MADLog(@"AutoLocker");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
  {
    *buf = 138412290;
    v68 = v19;
    v25 = "{validateShortTermLockURL} error extracting atomic instance from path, missing prefix | shortTermLockURL:%@";
    goto LABEL_7;
  }

LABEL_8:

LABEL_9:
  v26 = v14;
  v27 = v15;
  v28 = v16;
LABEL_10:

  objc_autoreleasePoolPop(v20);
}

- (void)shortTermLockFilesHealthCheck
{
  v2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v32 = objc_autoreleasePoolPush();
  v4 = [NSURL alloc];
  v5 = getRepositoryPath(@"/private/var/MobileAsset/AssetsV2/locks");
  v6 = [v4 initWithString:v5];

  +[NSFileManager defaultManager];
  v57 = 0u;
  v58 = 0u;
  v59 = 0u;
  v46 = v60 = 0u;
  v31 = v6;
  obj = [v46 enumeratorAtURL:v6 includingPropertiesForKeys:0 options:0 errorHandler:0];
  v35 = [obj countByEnumeratingWithState:&v57 objects:v67 count:16];
  if (v35)
  {
    v34 = *v58;
    do
    {
      v7 = 0;
      do
      {
        if (*v58 != v34)
        {
          objc_enumerationMutation(obj);
        }

        v37 = v7;
        v8 = *(*(&v57 + 1) + 8 * v7);
        context = objc_autoreleasePoolPush();
        v53 = 0u;
        v54 = 0u;
        v55 = 0u;
        v56 = 0u;
        v38 = [v46 enumeratorAtURL:v8 includingPropertiesForKeys:0 options:0 errorHandler:0];
        v40 = [v38 countByEnumeratingWithState:&v53 objects:v66 count:16];
        if (v40)
        {
          v39 = *v54;
          do
          {
            for (i = 0; i != v40; i = i + 1)
            {
              if (*v54 != v39)
              {
                objc_enumerationMutation(v38);
              }

              v10 = *(*(&v53 + 1) + 8 * i);
              v11 = objc_autoreleasePoolPush();
              v12 = [v10 URLByAppendingPathComponent:@"shared_locks"];
              v49 = 0u;
              v50 = 0u;
              v51 = 0u;
              v52 = 0u;
              v44 = [v46 enumeratorAtURL:v12 includingPropertiesForKeys:0 options:0 errorHandler:0];
              v13 = [v44 countByEnumeratingWithState:&v49 objects:v65 count:16];
              if (!v13)
              {
                v15 = 0;
                v16 = 0;
                goto LABEL_37;
              }

              v14 = v13;
              v41 = v12;
              v42 = v11;
              v43 = i;
              v15 = 0;
              v16 = 0;
              v17 = *v50;
              do
              {
                for (j = 0; j != v14; j = j + 1)
                {
                  if (*v50 != v17)
                  {
                    objc_enumerationMutation(v44);
                  }

                  v19 = *(*(&v49 + 1) + 8 * j);
                  buf[0] = 0;
                  v48 = 0;
                  [(MADAutoAssetControlManager *)self validateShortTermLockURL:v19 normalizedClientDomainNameURL:v8 normalizedAssetSetIdentifierURL:v10 fileManager:v46 isLatestLocker:buf isSpecificLocker:&v48];
                  if (buf[0])
                  {
                    v20 = v16;
                    v21 = v15;
                    v16 = v19;
                  }

                  else
                  {
                    v20 = v15;
                    v21 = v19;
                    if (v48 != 1)
                    {
                      continue;
                    }
                  }

                  v22 = v19;

                  v15 = v21;
                }

                v14 = [v44 countByEnumeratingWithState:&v49 objects:v65 count:16];
              }

              while (v14);

              v12 = v41;
              v11 = v42;
              if (v15)
              {
                v23 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                {
                  v24 = [v15 path];
                  *buf = 138543362;
                  v62 = v24;
                  _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} %{public}@ is no longer used - will be removed", buf, 0xCu);
                }

                [v46 removeItemAtURL:v15 error:0];
              }

              i = v43;
              if (v16)
              {
                v25 = [v16 path];
                v26 = isValidSymlink(v25);

                v44 = _MADLog(@"AutoControl");
                v27 = os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT);
                if (v26)
                {
                  if (v27)
                  {
                    v28 = [v16 path];
                    *buf = 138543362;
                    v62 = v28;
                    _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} Latest symlink %{public}@ points to a valid target", buf, 0xCu);
                    goto LABEL_36;
                  }
                }

                else
                {
                  if (v27)
                  {
                    v29 = [v16 path];
                    *buf = 138543362;
                    v62 = v29;
                    _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} Latest symlink %{public}@ is not pointing to a valid target - will be removed", buf, 0xCu);
                  }

                  v47 = 0;
                  [v46 removeItemAtURL:v16 error:&v47];
                  v44 = v47;
                  if (v44)
                  {
                    v28 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
                    {
                      v30 = [v16 path];
                      *buf = 138543618;
                      v62 = v30;
                      v63 = 2114;
                      v64 = v44;
                      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{shortTermLockFilesHealthCheck} Failed to remove invalid symlink %{public}@.  Error: %{public}@", buf, 0x16u);
                    }

LABEL_36:
                  }
                }

LABEL_37:
              }

              objc_autoreleasePoolPop(v11);
            }

            v40 = [v38 countByEnumeratingWithState:&v53 objects:v66 count:16];
          }

          while (v40);
        }

        objc_autoreleasePoolPop(context);
        v7 = v37 + 1;
      }

      while ((v37 + 1) != v35);
      v35 = [obj countByEnumeratingWithState:&v57 objects:v67 count:16];
    }

    while (v35);
  }

  objc_autoreleasePoolPop(v32);
}

+ (int64_t)previousOTASituation
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v11 = 0;
  v12 = &v11;
  v13 = 0x2020000000;
  v14 = 0;
  v3 = [v2 autoControlManagerFSM];

  if (v3)
  {
    v4 = [v2 autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    v8[0] = _NSConcreteStackBlock;
    v8[1] = 3221225472;
    v8[2] = __50__MADAutoAssetControlManager_previousOTASituation__block_invoke;
    v8[3] = &unk_4B2EA8;
    v9 = v2;
    v10 = &v11;
    dispatch_sync(v5, v8);
  }

  v6 = v12[3];
  _Block_object_dispose(&v11, 8);

  return v6;
}

int64_t __50__MADAutoAssetControlManager_previousOTASituation__block_invoke(uint64_t a1)
{
  [*(a1 + 32) ensureStagerFullyResumed];
  result = +[MADAutoAssetStager previousOTASituation];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

+ (void)considerPerfomingCrosscheckTrim
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = [v2 autoControlManagerFSM];

  if (v3)
  {
    v4 = [v2 autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __61__MADAutoAssetControlManager_considerPerfomingCrosscheckTrim__block_invoke;
    block[3] = &unk_4B2AA0;
    v7 = v2;
    dispatch_async(v5, block);
  }
}

id __61__MADAutoAssetControlManager_considerPerfomingCrosscheckTrim__block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) initialHealthReportPerformedCrosscheck];
  if ((result & 1) == 0)
  {
    [*(a1 + 32) setInitialHealthReportPerformedCrosscheck:1];
    v3 = *(a1 + 32);

    return [v3 firstSchedulerCrosscheckTrim];
  }

  return result;
}

- (void)_trackPerformanceStartupBegin
{
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v2 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      *v3 = 0;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE] {AUTO-SET-CONTROL:trackPerformanceStartupBegin} | STARTUP_BEGIN", v3, 2u);
    }
  }
}

- (void)trackPerformanceIteration:(id)a3 ofContainer:(id)a4
{
  v6 = a3;
  v7 = a4;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v8 = +[NSDate date];
    [v8 timeIntervalSince1970];
    v10 = v9;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v12 = v11;

    v13 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 134218498;
      v15 = (v10 - v12);
      v16 = 2114;
      v17 = v6;
      v18 = 2114;
      v19 = v7;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceIteration} | containerName:%{public}@", &v14, 0x20u);
    }
  }
}

- (void)trackPerformanceFilesystemExistCheck:(id)a3 atPath:(id)a4 withFilesystemInfo:(int64_t)a5 justUpdatedCache:(BOOL)a6
{
  v6 = a6;
  v10 = a3;
  v11 = a4;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled]|| v6)
  {
    v12 = +[NSDate date];
    [v12 timeIntervalSince1970];
    v14 = v13;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v16 = v15;

    v17 = @"INVALID";
    if (a5 > 199)
    {
      if (a5 == 200)
      {
        v17 = @"FileExists";
      }

      else if (a5 == 300)
      {
        v17 = @"DirectoryExists";
      }
    }

    else if (a5)
    {
      if (a5 == 100)
      {
        v17 = @"DoesNotExist";
      }
    }

    else
    {
      v17 = @"Unknown";
    }

    v18 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      v19 = @"HIT";
      v20 = 134219010;
      v21 = (v14 - v16);
      v22 = 2114;
      if (v6)
      {
        v19 = @"MISS";
      }

      v23 = v10;
      v24 = 2114;
      v25 = v19;
      v26 = 2114;
      v27 = v17;
      v28 = 2114;
      v29 = v11;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] [FILESYSTEM-CACHE] {%{public}@:trackPerformanceFilesystemExistCheck} [%{public}@] | cachedInfo:%{public}@ | filePath:%{public}@", &v20, 0x34u);
    }
  }
}

- (void)trackPerformancePhaseBegin:(id)a3
{
  v4 = a3;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = v4;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformancePhaseBegin} | PHASE_BEGIN", &v11, 0x16u);
    }
  }
}

- (void)trackPerformancePhaseEnd:(id)a3
{
  v4 = a3;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = v4;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformancePhaseEnd} | PHASE_END", &v11, 0x16u);
    }
  }
}

- (void)trackPerformanceStartupStep:(id)a3 beginningStep:(id)a4
{
  v6 = a3;
  v7 = a4;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v8 = +[NSDate date];
    [v8 timeIntervalSince1970];
    v10 = v9;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v12 = v11;

    v13 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 134218498;
      v15 = (v10 - v12);
      v16 = 2114;
      v17 = v6;
      v18 = 2114;
      v19 = v7;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceStartupStep} | startupStepName:%{public}@", &v14, 0x20u);
    }
  }
}

- (void)trackPerformanceStartupEnd:(id)a3
{
  v4 = a3;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = v4;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceStartupEnd} | STARTUP_END", &v11, 0x16u);
    }
  }
}

+ (void)analyticsReportSecureOperationResults:(id)a3 clientName:(id)a4 secureReason:(id)a5 operation:(int64_t)a6 fromLocation:(id)a7 mountError:(id)a8 graftError:(id)a9 personalizeError:(id)a10 mapToExclaveError:(id)a11
{
  v51 = a4;
  v15 = a5;
  v16 = a7;
  v17 = a8;
  v18 = a9;
  v19 = a10;
  v20 = a11;
  v21 = a3;
  v22 = +[MADAutoAssetControlManager autoControlManager];
  v45 = [v22 analyticsManager];

  v44 = [v21 assetSpecifier];
  v43 = [v21 assetType];
  v50 = [v21 assetVersion];

  if (v15)
  {
    v23 = v15;
  }

  else
  {
    v23 = @"N/A";
  }

  if (v19)
  {
    v49 = [v19 checkedDescription];
    if (v17)
    {
      goto LABEL_6;
    }

LABEL_9:
    v48 = 0;
    if (v18)
    {
      goto LABEL_7;
    }

    goto LABEL_10;
  }

  v49 = 0;
  if (!v17)
  {
    goto LABEL_9;
  }

LABEL_6:
  v48 = [v17 checkedDescription];
  if (v18)
  {
LABEL_7:
    v24 = [v18 checkedDescription];
    goto LABEL_11;
  }

LABEL_10:
  v24 = 0;
LABEL_11:
  v47 = v17;
  if (v20)
  {
    v25 = v17 == 0;
    v26 = v16;
    v27 = v25;
    v28 = v20;
    v29 = [v20 checkedDescription];
    v30 = v23;
    v31 = v15;
    v32 = v29;
    LOBYTE(v42) = 0;
    LOBYTE(v41) = v18 == 0;
    LOBYTE(v40) = v27;
    v16 = v26;
    LOBYTE(v39) = v19 == 0;
    v38 = v26;
    v34 = v44;
    v33 = v45;
    v35 = v43;
    v36 = [v45 recordMobileAssetSecureAttempt:v44 assetType:v43 assetVersion:v50 clientName:v51 operation:a6 secureReason:v30 fromLocation:v38 sucessfullyPersonalized:v39 personalizeFailureReason:v49 sucessfullyMounted:v40 mountingFailureReason:v48 successfullyGrafted:v41 graftingFailureReason:v24 successfullyMappedToExclave:v42 mapToExclaveFailureReason:v29];

    v15 = v31;
    if (v18)
    {
      goto LABEL_16;
    }
  }

  else
  {
    v28 = 0;
    LOBYTE(v42) = 1;
    LOBYTE(v41) = v18 == 0;
    LOBYTE(v40) = v17 == 0;
    LOBYTE(v39) = v19 == 0;
    v34 = v44;
    v33 = v45;
    v35 = v43;
    v37 = [v45 recordMobileAssetSecureAttempt:v44 assetType:v43 assetVersion:v50 clientName:v51 operation:a6 secureReason:v23 fromLocation:v16 sucessfullyPersonalized:v39 personalizeFailureReason:v49 sucessfullyMounted:v40 mountingFailureReason:v48 successfullyGrafted:v41 graftingFailureReason:v24 successfullyMappedToExclave:v42 mapToExclaveFailureReason:0];
    if (v18)
    {
LABEL_16:
    }
  }

  if (v47)
  {
  }

  if (v19)
  {
  }
}

+ (id)createSeverMessageWithName:(id)a3 sender:(id)a4 clientID:(id)a5 response:(id)a6 error:(id)a7
{
  v8 = a5;
  v9 = a3;
  v10 = objc_alloc_init(NSMutableDictionary);
  v11 = [[SUCoreConnectMessage alloc] initWithType:2 messageName:v9 clientID:v8 version:0 message:v10];

  return v11;
}

+ (void)installAutoAssetWithDescriptor:(id)a3
{
  v6 = a3;
  if (_MAPreferencesIsInternalAllowed())
  {
    v3 = +[MADAutoAssetControlManager autoControlManager];
    v4 = [[MADAutoAssetControlManagerParam alloc] initForTimerFired];
    [v4 setDownloadingDescriptor:v6];
    v5 = [v3 autoControlManagerFSM];
    [v5 postEvent:@"InstallAssetsEvent" withInfo:v4];
  }
}

- (id)_summary
{
  v3 = [NSString alloc];
  v4 = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  v5 = [v4 count];
  v6 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
  v7 = [v3 initWithFormat:@"clientReqs:%ld|setJobs:%ld", v5, objc_msgSend(v6, "count")];

  return v7;
}

- (id)_updateLatestSummary
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self _summary];
  [(MADAutoAssetControlManager *)self setLatestSafeSummary:v5];

  return [(MADAutoAssetControlManager *)self latestSafeSummary];
}

- (int64_t)action_StartUnlockPollingTimer:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v19.opaque[0] = 0;
  v19.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StartUnlockPollingTimer", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v19);

  [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:1, v19.opaque[0], v19.opaque[1]];
  [(MADAutoAssetControlManager *)self setOperatingBeforeResumed:1];
  v9 = [(MADAutoAssetControlManager *)self preferenceBeforeFirstPollSecs];
  v10 = 600;
  if (v9 != -1)
  {
    v10 = v9;
  }

  v11 = [NSTimer timerWithTimeInterval:1 repeats:&__block_literal_global_2309 block:v10];
  [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:v11];

  v12 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
  LODWORD(v11) = v12 == 0;

  if (v11)
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
    {
      v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v21 = v17;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@] {StartUnlockPollingTimer} | Unable to create first-unlock polling timer", buf, 0xCu);
    }
  }

  else
  {
    v13 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v21 = v14;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[%{public}@] {StartUnlockPollingTimer} | entered first-unlock polling period", buf, 0xCu);
    }

    v15 = +[NSRunLoop mainRunLoop];
    v16 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [v15 addTimer:v16 forMode:NSDefaultRunLoopMode];
  }

  os_activity_scope_leave(&v19);
  return 0;
}

void __67__MADAutoAssetControlManager_action_StartUnlockPollingTimer_error___block_invoke(id a1, NSTimer *a2)
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v2 = [[MADAutoAssetControlManagerParam alloc] initForTimerFired];
  v3 = [v4 autoControlManagerFSM];
  [v3 postEvent:@"PollForDeviceUnlocked" withInfo:v2];
}

- (int64_t)action_PollDecideBefore1stUnlock:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PollDecideBefore1stUnlock", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v15);

  if (![MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock:v15.opaque[0]])
  {
    v9 = [MADAutoAssetControlManagerParam alloc];
    v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:v10];

    v12 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [v12 invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v13 postEvent:@"PolledNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v15);

  return 0;
}

- (int64_t)action_SyncSkippedDecideBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncSkippedDecideBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v15);

  v9 = [MADAutoAssetControlManagerParam alloc];
  v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary:v15.opaque[0]];
  v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:v10];

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v12 postEvent:@"SyncedStillBefore1st" withInfo:v11];
  }

  else
  {
    v13 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [v13 invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v12 postEvent:@"SyncedNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v15);
  return 0;
}

- (int64_t)action_SyncDecideBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v17.opaque[0] = 0;
  v17.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncDecideBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v17);

  v9 = [MADAutoAssetControlManagerParam alloc];
  v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary:v17.opaque[0]];
  v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:v10];

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  v12 = [v5 downloadsInFlight];
  v13 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:v12];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v13];

  if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v14 postEvent:@"SyncedStillBefore1st" withInfo:v11];
  }

  else
  {
    v15 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [v15 invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v14 postEvent:@"SyncedNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v17);
  return 0;
}

- (int64_t)action_LoadPersistedResumeLocker:(id)a3 error:(id *)a4
{
  v77 = a3;
  v78 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:LoadPersistedResumeLocker", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"LoadPersistedResumeLocker"];
  [(MADAutoAssetControlManager *)self setOperatingBeforeResumed:1];
  v8 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  LODWORD(self) = v8 == 0;

  if (self)
  {
    v9 = [MADAutoAssetPersisted alloc];
    v10 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v11 = [v10 extendedStateQueue];
    v12 = [(MADAutoAssetPersisted *)v9 initForModule:@"AutoControlManager" ofModuleVersion:@"1.1" usingDispatchQueue:v11 loggingByName:@"ACTIVE-JOBS" withVersionMigrator:&__block_literal_global_2320];
    [(MADAutoAssetControlManager *)v78 setPersistedActiveJobs:v12];

    v13 = [MADAutoAssetPersisted alloc];
    v14 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v15 = [v14 extendedStateQueue];
    v16 = [(MADAutoAssetPersisted *)v13 initForModule:@"AutoAssetDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:v15 loggingByName:@"KNOWN-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2328];
    [(MADAutoAssetControlManager *)v78 setPersistedKnownDescriptors:v16];

    v17 = [MADAutoAssetPersisted alloc];
    v18 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v19 = [v18 extendedStateQueue];
    v20 = [(MADAutoAssetPersisted *)v17 initForModule:@"AutoSetConfigurations" ofModuleVersion:@"1.0" usingDispatchQueue:v19 loggingByName:@"KNOWN-SET-CONFIGURATIONS" withVersionMigrator:&__block_literal_global_2336];
    [(MADAutoAssetControlManager *)v78 setPersistedKnownSetConfigurations:v20];

    v21 = [MADAutoAssetPersisted alloc];
    v22 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v23 = [v22 extendedStateQueue];
    v24 = [(MADAutoAssetPersisted *)v21 initForModule:@"AutoSetAtomicInstances" ofModuleVersion:@"1.0" usingDispatchQueue:v23 loggingByName:@"KNOWN-SET-ATOMIC-INSTANCES" withVersionMigrator:&__block_literal_global_2344];
    [(MADAutoAssetControlManager *)v78 setPersistedKnownSetAtomicInstances:v24];

    v25 = [MADAutoAssetPersisted alloc];
    v26 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v27 = [v26 extendedStateQueue];
    v28 = [(MADAutoAssetPersisted *)v25 initForModule:@"AutoSetActiveJobDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:v27 loggingByName:@"ACTIVE-JOB-SET-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2352];
    [(MADAutoAssetControlManager *)v78 setPersistedActiveJobSetDescriptors:v28];

    v29 = [MADAutoAssetPersisted alloc];
    v30 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v31 = [v30 extendedStateQueue];
    v32 = [(MADAutoAssetPersisted *)v29 initForModule:@"AutoSetDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:v31 loggingByName:@"DOWNLOADED-SET-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2360];
    [(MADAutoAssetControlManager *)v78 setPersistedDownloadedSetDescriptors:v32];

    v33 = [MADAutoAssetPersisted alloc];
    v34 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v35 = [v34 extendedStateQueue];
    v36 = [(MADAutoAssetPersisted *)v33 initForModule:@"AutoSetTargets" ofModuleVersion:@"1.0" usingDispatchQueue:v35 loggingByName:@"KNOWN-SET-TARGETS" withVersionMigrator:&__block_literal_global_2368];
    [(MADAutoAssetControlManager *)v78 setPersistedSetTargets:v36];

    v37 = [MADAutoAssetPersisted alloc];
    v38 = [(MADAutoAssetControlManager *)v78 autoControlManagerFSM];
    v39 = [v38 extendedStateQueue];
    v40 = [(MADAutoAssetPersisted *)v37 initForModule:@"AutoSetLookupResults" ofModuleVersion:@"1.0" usingDispatchQueue:v39 loggingByName:@"STAGED-SET-CONFIGURATIONS" withVersionMigrator:&__block_literal_global_2376];
    [(MADAutoAssetControlManager *)v78 setPersistedSetLookupResults:v40];
  }

  v41 = _MAPreferencesCopyValue(@"persistedStateLoadingInProgress");

  if (v41)
  {
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      v43 = [(MADAutoAssetControlManager *)v78 summary];
      *buf = 138543362;
      v88 = v43;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | Not using in memory caching for persisted state objects", buf, 0xCu);
    }
  }

  else
  {
    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      v45 = [(MADAutoAssetControlManager *)v78 summary];
      *buf = 138543362;
      v88 = v45;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | Enabling in memory caching for persisted state objects", buf, 0xCu);
    }

    _MAPreferencesSetStringValue(@"persistedStateLoadingInProgress", @"YES", @"LoadPersistedResumeLocker", @"Indicating that loading of persisted state is starting");
  }

  v46 = [(MADAutoAssetControlManager *)v78 persistedSetLookupResults];
  v47 = [v46 persistedConfig];
  [v47 removePersistedState];

  v48 = [(MADAutoAssetControlManager *)v78 persistedSetLookupResults];
  [v48 removeAllPersistedEntries:@"removing any set-lookup-results stored when earlier pre-SU-staging new-OS promotion"];

  [(MADAutoAssetControlManager *)v78 removePreviouslyStagedSetDescriptors];
  v49 = [(MADAutoAssetControlManager *)v78 persistedActiveJobs];
  [v49 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v50 = [(MADAutoAssetControlManager *)v78 persistedKnownDescriptors];
  [v50 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v51 = [(MADAutoAssetControlManager *)v78 persistedKnownSetConfigurations];
  [v51 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v52 = [(MADAutoAssetControlManager *)v78 persistedKnownSetAtomicInstances];
  [v52 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v53 = [(MADAutoAssetControlManager *)v78 persistedActiveJobSetDescriptors];
  [v53 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v54 = [(MADAutoAssetControlManager *)v78 persistedDownloadedSetDescriptors];
  [v54 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v55 = [(MADAutoAssetControlManager *)v78 persistedSetTargets];
  [v55 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  v56 = [(MADAutoAssetControlManager *)v78 persistedSetLookupResults];
  [v56 flushPersistedStateCacheAndSetCachingBehaviour:0];

  [MADAutoAssetLocker setPersistedStateCaching:0];
  [MADAutoAssetScheduler setPersistedStateCaching:v41 == 0];
  [MADAutoAssetStager setPersistedStateCaching:v41 == 0];
  [(MADAutoAssetControlManager *)v78 loadPersistedDescriptors];
  [(MADAutoAssetControlManager *)v78 loadPersistedActiveJobs];
  v79 = objc_alloc_init(NSMutableArray);
  v57 = [(MADAutoAssetControlManager *)v78 locateDownloadedNewAllBySelector];
  [(MADAutoAssetControlManager *)v78 trackPerformanceIteration:@"LoadPersistedResumeLocker" ofContainer:@"locateDownloadedNewAllBySelector"];
  v84 = 0u;
  v85 = 0u;
  v82 = 0u;
  v83 = 0u;
  v58 = v57;
  v59 = [v58 countByEnumeratingWithState:&v82 objects:v91 count:16];
  if (v59)
  {
    v60 = *v83;
    do
    {
      v61 = 0;
      do
      {
        if (*v83 != v60)
        {
          objc_enumerationMutation(v58);
        }

        v62 = *(*(&v82 + 1) + 8 * v61);
        v63 = objc_autoreleasePoolPush();
        v64 = [v58 safeObjectForKey:v62 ofClass:objc_opt_class()];
        v65 = [MAAutoAssetSelector alloc];
        v66 = [v64 assetType];
        v67 = [v64 assetSpecifier];
        v68 = [v64 assetVersion];
        v69 = [v65 initForAssetType:v66 withAssetSpecifier:v67 matchingAssetVersion:v68];

        if (v69)
        {
          [v79 addObject:v69];
        }

        objc_autoreleasePoolPop(v63);
        v61 = v61 + 1;
      }

      while (v59 != v61);
      v59 = [v58 countByEnumeratingWithState:&v82 objects:v91 count:16];
    }

    while (v59);
  }

  [MADAutoAssetLocker resumeFromPersistedWithDownloadedSelectors:v79];
  [(MADAutoAssetControlManager *)v78 loadPersistedSetConfigurations];
  [(MADAutoAssetControlManager *)v78 loadPersistedSetAtomicInstances];
  [(MADAutoAssetControlManager *)v78 loadPersistedSetDownloadedDescriptors];
  [(MADAutoAssetControlManager *)v78 loadPersistedCrosscheckStaleForceUnlock];
  [(MADAutoAssetControlManager *)v78 verifyLockerLatestSymlink];
  [(MADAutoAssetControlManager *)v78 loadPersistedSetActiveJobDescriptors];
  [(MADAutoAssetControlManager *)v78 loadPersistedSetTargets];
  [(MADAutoAssetControlManager *)v78 _removeSetDeterminedToBeIncomplete:@"LoadPersistedResumeLocker"];
  [(MADAutoAssetControlManager *)v78 loadPersistedAtomicInstancesSupportingShortTermLocking];
  +[MADAutoAssetSecure removeAllPersisted];
  v70 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v70, OS_LOG_TYPE_DEFAULT))
  {
    v71 = [(MADAutoAssetControlManager *)v78 summary];
    *buf = 138543618;
    v88 = v71;
    v89 = 1024;
    v90 = 600;
    _os_log_impl(&dword_0, v70, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | creating timer for %d seconds for sync to complete", buf, 0x12u);
  }

  v80[0] = _NSConcreteStackBlock;
  v80[1] = 3221225472;
  v80[2] = __69__MADAutoAssetControlManager_action_LoadPersistedResumeLocker_error___block_invoke_2390;
  v80[3] = &unk_4B2B88;
  v80[4] = v78;
  v72 = v77;
  v81 = v72;
  v73 = [NSTimer timerWithTimeInterval:0 repeats:v80 block:600.0];
  [(MADAutoAssetControlManager *)v78 setAwaitDownloadManagerSyncTimer:v73];

  v74 = +[NSRunLoop mainRunLoop];
  v75 = [(MADAutoAssetControlManager *)v78 awaitDownloadManagerSyncTimer];
  [v74 addTimer:v75 forMode:NSDefaultRunLoopMode];

  [(MADAutoAssetControlManager *)v78 trackPerformancePhaseEnd:@"LoadPersistedResumeLocker"];
  os_activity_scope_leave(&state);

  return 0;
}

void __69__MADAutoAssetControlManager_action_LoadPersistedResumeLocker_error___block_invoke_2390(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  [v2 postEvent:@"TimeoutAwaitingSynced" withInfo:*(a1 + 40)];
}

- (int64_t)action_ResumeStager:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeStager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeStager", v10.opaque[0], v10.opaque[1]];
  +[MADAutoAssetStager resumeFromPersisted];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SyncedResumeStager:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedResumeStager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"SyncedResumeStager", v12.opaque[0], v12.opaque[1]];
  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  v9 = [v5 downloadsInFlight];
  v10 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:v9];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v10];

  +[MADAutoAssetStager resumeFromPersisted];
  os_activity_scope_leave(&v12);

  return 0;
}

- (int64_t)action_PromoteStagedMigrate:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v16.opaque[0] = 0;
  v16.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PromoteStagedMigrate", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v16);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"ResumeStager", v16.opaque[0], v16.opaque[1]];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"PromoteStagedMigrate"];
  v9 = [v5 stagedSetLookupResults];
  [(MADAutoAssetControlManager *)self setStagedSetLookupResults:v9];

  [(MADAutoAssetControlManager *)self setStagerResumed:1];
  -[MADAutoAssetControlManager setStagerResumePostponed:](self, "setStagerResumePostponed:", [v5 requiringLoadPriorToUse]);
  if ([v5 newOSPromotion])
  {
    [(MADAutoAssetControlManager *)self _stagedNewOSPromoteAdoptSetTargets];
  }

  v10 = [v5 stagedToDownloaded];
  [(MADAutoAssetControlManager *)self promoteAnyPreviouslyStagedNowDownloaded:v10];

  [(MADAutoAssetControlManager *)self _preInstalledMigrateAssets];
  v11 = [MADAutoAssetControlManagerParam alloc];
  v12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
  v13 = [(MADAutoAssetControlManagerParam *)v11 initWithSafeSummary:v12];

  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [v14 postEvent:@"MigratedAssets" withInfo:v13];

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"PromoteStagedMigrate"];
  os_activity_scope_leave(&v16);

  return 0;
}

- (int64_t)action_ResumeScheduler:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeScheduler", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeScheduler", v11.opaque[0], v11.opaque[1]];
  v9 = [(MADAutoAssetControlManager *)self setConfigurationCopy:@"ResumeScheduler"];
  [MADAutoAssetScheduler resumeFromPersisted:v9];

  os_activity_scope_leave(&v11);
  return 0;
}

- (int64_t)action_SyncInFlightDownloads:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncInFlightDownloads", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _requestDownloadManagerSync:v10.opaque[0]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_Synced:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Synced", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1, v12.opaque[0], v12.opaque[1]];
  v9 = [v5 downloadsInFlight];
  v10 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:v9];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v10];

  os_activity_scope_leave(&v12);
  return 0;
}

- (int64_t)action_AdditionalSynced:(id)a3 error:(id *)a4
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:a3];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:AdditionalSynced", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &v8);

  os_activity_scope_leave(&v8);
  return 0;
}

- (int64_t)action_ResumeJobsBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeJobsBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeJobsBefore1st", v10.opaque[0], v10.opaque[1]];
  [(MADAutoAssetControlManager *)self resumeJobsWhenBeforeFirstUnlock:1];
  [(MADAutoAssetControlManager *)self resumeSetJobsWhenBeforeFirstUnlock:1];
  [(MADAutoAssetControlManager *)self clientRequestsAwaitingSyncToAwaitingFirstUnlock:@"ResumeJobsBefore1st"];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"ResumeJobsBefore1st"];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_ResumeJobs:(id)a3 error:(id *)a4
{
  v84 = a3;
  v88 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ResumeJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)v88 trackPerformancePhaseEnd:@"ResumeScheduler"];
  [(MADAutoAssetControlManager *)v88 trackPerformancePhaseBegin:@"ResumeJobs"];
  v8 = [v84 scheduledJobs];
  [(MADAutoAssetControlManager *)v88 scheduledJobsResumed:v8];

  v9 = v88;
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"setConfigurationsRefreshStaleIndications"];
  [(MADAutoAssetControlManager *)v88 setConfigurationsRefreshStaleIndications];
  [(MADAutoAssetControlManager *)v88 setLocksPriorToSecureHealing:0];
  [(MADAutoAssetControlManager *)v88 setOperatingBeforeResumed:0];
  [(MADAutoAssetControlManager *)v88 setMaintainingActiveJobStatus:1];
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"secureClearInsecureLatestAtomicInstances"];
  [(MADAutoAssetControlManager *)v88 secureClearInsecureLatestAtomicInstances];
  if ([(MADAutoAssetControlManager *)v88 migratedFromPreinstalled])
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
      *buf = 138543362;
      v96 = v11;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[DEVICE-BOOT] {ResumeJobs} migrated pre-installed assets", buf, 0xCu);
    }

    v9 = v88;
  }

  [(MADAutoAssetControlManager *)v9 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"persistedSetLookupResults-removeAllPersistedEntries"];
  v12 = [(MADAutoAssetControlManager *)v9 persistedSetLookupResults];
  [v12 removeAllPersistedEntries:@"removing any set-lookup-results just reported by pre-SU-staging new-OS promotion"];

  v82 = [NSString alloc];
  v86 = [(MADAutoAssetControlManager *)v88 persistedActiveJobs];
  v80 = [v86 persistedEntryCount:@"ResumeJobs"];
  v85 = [(MADAutoAssetControlManager *)v88 persistedKnownDescriptors];
  v78 = [v85 persistedEntryCount:@"ResumeJobs"];
  v76 = +[MADAutoAssetLocker persistedLocksCount];
  v74 = +[MADAutoAssetScheduler persistedScheduledCount];
  v13 = [(MADAutoAssetControlManager *)v88 persistedKnownSetConfigurations];
  v72 = [v13 persistedEntryCount:@"ResumeJobs"];
  v14 = [(MADAutoAssetControlManager *)v88 persistedKnownSetAtomicInstances];
  v15 = [v14 persistedEntryCount:@"ResumeJobs"];
  v16 = [(MADAutoAssetControlManager *)v88 persistedActiveJobSetDescriptors];
  v17 = [v16 persistedEntryCount:@"ResumeJobs"];
  v18 = [(MADAutoAssetControlManager *)v88 persistedDownloadedSetDescriptors];
  v19 = [v18 persistedEntryCount:@"ResumeJobs"];
  v20 = [(MADAutoAssetControlManager *)v88 persistedSetTargets];
  v21 = [v20 persistedEntryCount:@"ResumeJobs"];
  v22 = [(MADAutoAssetControlManager *)v88 persistedSetLookupResults];
  v81 = [v82 initWithFormat:@"ActiveJobs:%ld | KnownDescriptors:%ld | Locks:%ld | Scheduled:%ld | SetConfigurations:%ld | AtomicInstances:%ld | ActiveSetDescriptors:%ld | DownloadedSetDescriptors:%ld | SetTargets:%ld | SetLookupResults:%ld", v80, v78, v76, v74, v72, v15, v17, v19, v21, objc_msgSend(v22, "persistedEntryCount:", @"ResumeJobs"];

  v23 = [NSString alloc];
  v24 = [(MADAutoAssetControlManager *)v88 currentSetJobsByIdentifier];
  v25 = [v24 count];
  v26 = [(MADAutoAssetControlManager *)v88 cancelingSetJobsByIdentifier];
  v27 = [v26 count];
  v28 = [(MADAutoAssetControlManager *)v88 currentSetStatusByInstance];
  v79 = [v23 initWithFormat:@"SetJobsByIdentifier:%ld(canceling:%ld) | SetStatusByInstance:%ld", v25, v27, objc_msgSend(v28, "count")];

  v29 = [NSString alloc];
  v30 = [(MADAutoAssetControlManager *)v88 knownSetConfigurationsByIdentifier];
  v31 = [v30 count];
  v32 = [(MADAutoAssetControlManager *)v88 knownSetAtomicInstancesByInstance];
  v77 = [v29 initWithFormat:@"SetConfigurationsByIdentifier:%ld | SetAtomicInstancesByInstance:%ld", v31, objc_msgSend(v32, "count")];

  v33 = [NSString alloc];
  v34 = [(MADAutoAssetControlManager *)v88 activeSetDescriptorsByIdentifier];
  v35 = [v34 count];
  v36 = [(MADAutoAssetControlManager *)v88 activeSetDescriptorsByInstance];
  v75 = [v33 initWithFormat:@"SetDescriptorsByIdentifier:%ld | SetDescriptorsByInstance:%ld", v35, objc_msgSend(v36, "count")];

  v37 = [NSString alloc];
  v38 = [(MADAutoAssetControlManager *)v88 filesystemFileExistAtPathCache];
  v73 = [v37 initWithFormat:@"filesystemFileExistAtPathCache:%ld | filesystemStartupLookupCount:%ld", objc_msgSend(v38, "count"), -[MADAutoAssetControlManager filesystemStartupLookupCount](v88, "filesystemStartupLookupCount")];

  v39 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138544130;
    v96 = v81;
    v97 = 2114;
    v98 = v79;
    v99 = 2114;
    v100 = v77;
    v101 = 2114;
    v102 = v75;
    _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [PERSISTED] %{public}@\n[STARTUP-STATE] [CURRENT] %{public}@\n[STARTUP-STATE] [KNOWN] %{public}@\n[STARTUP-STATE] [ACTIVE] %{public}@", buf, 0x2Au);
  }

  v40 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v96 = v73;
    _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [FILESYSTEM-CACHE] %{public}@", buf, 0xCu);
  }

  v41 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
  {
    v42 = +[MADAutoAssetControlManager buildDirectivesSummary];
    *buf = 138543618;
    v96 = @"3.0.4";
    v97 = 2114;
    v98 = v42;
    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [AUTO-ASSET-VERSION:%{public}@] | build environment:%{public}@", buf, 0x16u);
  }

  v43 = [(MADAutoAssetControlManager *)v88 knownSetAtomicInstancesByInstance];
  v83 = [MADAutoAssetLocker currentSetLockUsageEliminatingOtherThanSetAtomicInstances:v43];

  if (v83)
  {
    [(MADAutoAssetControlManager *)v88 setSetLockUsageMap:?];
    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      v45 = [(MADAutoAssetControlManager *)v88 setLockUsageMap];
      *buf = 138543362;
      v96 = v45;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} | Set LockUsageMap | initialUsageMapFromLocker:\n%{public}@", buf, 0xCu);
    }
  }

  else
  {
    v46 = objc_alloc_init(NSMutableDictionary);
    [(MADAutoAssetControlManager *)v88 setSetLockUsageMap:v46];

    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} | Set LockUsageMap | no current set-locks reported by auto-asset-locker", buf, 2u);
    }
  }

  if ([(MADAutoAssetControlManager *)v88 startupActivationIsFirstExecutionSinceBoot:@"action_ResumeJobs"])
  {
    [(MADAutoAssetControlManager *)v88 shortTermLockFilesHealthCheck];
  }

  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    [(MADAutoAssetControlManager *)v88 handleSuspendResumeForSoftwareUpdateDaemonStartup];
  }

  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"resumeJobsWhenBeforeFirstUnlock:NO"];
  [(MADAutoAssetControlManager *)v88 resumeJobsWhenBeforeFirstUnlock:0];
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"clientRequestsAwaitingDispatchAll"];
  [(MADAutoAssetControlManager *)v88 clientRequestsAwaitingDispatchAll:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"downloadManagerInFlightTasks-cancel"];
  v87 = getDownloadManager();
  v91 = 0u;
  v92 = 0u;
  v89 = 0u;
  v90 = 0u;
  v47 = [(MADAutoAssetControlManager *)v88 downloadManagerInFlightTasks];
  v48 = [v47 countByEnumeratingWithState:&v89 objects:v94 count:16];
  if (v48)
  {
    v49 = *v90;
    do
    {
      for (i = 0; i != v48; i = i + 1)
      {
        if (*v90 != v49)
        {
          objc_enumerationMutation(v47);
        }

        v51 = *(*(&v89 + 1) + 8 * i);
        v52 = objc_autoreleasePoolPush();
        if (v51)
        {
          [v87 cancelAssetDownloadTask:v51];
          v53 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
          {
            v54 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
            *buf = 138543618;
            v96 = v54;
            v97 = 2114;
            v98 = v51;
            _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ResumeJobs} canceled stale auto-asset taskDescriptor:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v53 = [(MADAutoAssetControlManager *)v88 autoControlManagerFSM];
          v55 = [v53 diag];
          v56 = [NSString alloc];
          v57 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
          v58 = [v56 initWithFormat:@"{ResumeJobs} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", v57];
          [v55 trackAnomaly:@"AUTO-CONTROL" forReason:v58 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v52);
      }

      v48 = [v47 countByEnumeratingWithState:&v89 objects:v94 count:16];
    }

    while (v48);
  }

  [(MADAutoAssetControlManager *)v88 setDescriptorsRequiringPersonalization:0];
  [(MADAutoAssetControlManager *)v88 setDescriptorsRequiringGrafting:0];
  [(MADAutoAssetControlManager *)v88 setPrePersonalizedSelectors:0];
  [(MADAutoAssetControlManager *)v88 setFilesystemFileExistAtPathCache:0];
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"flushPersistedStateCacheAndSetCachingBehaviour:NO"];
  v59 = [(MADAutoAssetControlManager *)v88 persistedActiveJobs];
  [v59 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v60 = [(MADAutoAssetControlManager *)v88 persistedKnownDescriptors];
  [v60 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v61 = [(MADAutoAssetControlManager *)v88 persistedSetTargets];
  [v61 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v62 = [(MADAutoAssetControlManager *)v88 persistedSetLookupResults];
  [v62 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v63 = [(MADAutoAssetControlManager *)v88 persistedKnownSetConfigurations];
  [v63 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v64 = [(MADAutoAssetControlManager *)v88 persistedDownloadedSetDescriptors];
  [v64 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v65 = [(MADAutoAssetControlManager *)v88 persistedActiveJobSetDescriptors];
  [v65 flushPersistedStateCacheAndSetCachingBehaviour:0];

  v66 = [(MADAutoAssetControlManager *)v88 persistedKnownSetAtomicInstances];
  [v66 flushPersistedStateCacheAndSetCachingBehaviour:0];

  [MADAutoAssetLocker setPersistedStateCaching:0];
  [MADAutoAssetScheduler setPersistedStateCaching:0];
  [MADAutoAssetStager setPersistedStateCaching:0];
  [(MADAutoAssetControlManager *)v88 setStagedSetLookupResults:0];
  v67 = +[NSDate date];
  [v67 timeIntervalSince1970];
  v69 = v68;
  [(MADAutoAssetControlManager *)v88 startupTimeBeginSeconds];
  [(MADAutoAssetControlManager *)v88 setStartupTimeDurationSeconds:v69 - v70];

  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"startupActivationCompleted"];
  [(MADAutoAssetControlManager *)v88 startupActivationCompleted:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)v88 trackPerformancePhaseEnd:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)v88 trackPerformanceStartupEnd:@"ResumeJobs"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_FailClientTimedOut:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:FailClientTimedOut", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:v12.opaque[0]];
  v10 = [v9 diag];
  [v10 trackAnomaly:@"AUTO-CONTROL" forReason:@"action not yet implemented" withResult:6801 withError:0];

  os_activity_scope_leave(&v12);
  return 0;
}

- (int64_t)action_QueueClientRequest:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"QueueClientRequest"];
  if (!v5)
  {
    v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v16 = [v11 diag];
    v20 = [NSString alloc];
    v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v17 = [v20 initWithFormat:@"{QueueClientRequest} nil eventInfo provided | %@", v18];
    [v16 trackAnomaly:@"AUTO-CONTROL" forReason:v17 withResult:6102 withError:0];
LABEL_9:

    goto LABEL_10;
  }

  v8 = [v5 clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:v8];

  v9 = [v5 clientRequest];
  v10 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v9];

  if (!v10)
  {
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v5];
    if (!v11)
    {
      v41 = [NSString alloc];
      v39 = [v5 summary];
      v40 = [v41 initWithFormat:@"invalid eventInfo (instance:MISSING) | eventInfo:%@", v39];
      goto LABEL_27;
    }

    if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5])
    {
      v21 = [v11 clientAssetSelector];
      v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:v21 fromLocation:@"QueueClientRequest"];

      if (v22)
      {
        v23 = [NSString alloc];
        v24 = [v5 clientRequest];
        v25 = [v24 summary];
        v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", v25];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"QueueClientRequest" withDescription:v26];

        v16 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_10;
        }

        v17 = [v5 clientRequest];
        v18 = [v17 summary];
        *buf = 138543362;
        v56 = v18;
        v19 = "\n[ELIMINATE]{QueueClientRequest} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
        goto LABEL_16;
      }
    }

    v30 = [v5 clientRequest];
    v31 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v30];
    v32 = [(MADAutoAssetControlManager *)self _messageBlockedUntilDownloadManagerSync:v31];

    if ((v32 & 1) == 0)
    {

      goto LABEL_31;
    }

    v33 = [v5 clientRequest];
    v16 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v33];

    if (([SUCore stringIsEqual:v16 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) == 0 && ![SUCore stringIsEqual:v16 to:@"MA-AUTO:LOCK_CONTENT"])
    {
      if ([SUCore stringIsEqual:v16 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"])
      {
        [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:v5 fromLocation:@"QueueClientRequest"];
        goto LABEL_10;
      }

      goto LABEL_37;
    }

    if ([(MADAutoAssetControlManager *)self isNoWaitRequestInvolvingSecureAsset:v5])
    {
      v34 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
      {
LABEL_36:

LABEL_37:
LABEL_38:
        v46 = [v5 clientRequest];
        v47 = [(MADAutoAssetControlManager *)self timerStartForRequest:v46 fromLocation:@"QueueClientRequest"];

        if (!v47)
        {
          v49 = [NSString alloc];
          v50 = [v5 clientRequest];
          v51 = [v50 summary];
          v52 = [v49 initWithFormat:@"immediate timeout (unable to start timer) | clientRequest:%@", v51];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6105 fromAction:@"QueueClientRequest" withDescription:v52];

          goto LABEL_29;
        }

        v48 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
        [v48 addObject:v5];

        v11 = [(MADAutoAssetControlManager *)self statistics];
        v16 = [v11 totalQueuedClientRequests];
        v34 = [v5 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:v16 forClientRequest:v34];
        goto LABEL_40;
      }

      v35 = [v5 clientRequest];
      v36 = [v35 summary];
      *buf = 138543362;
      v56 = v36;
      v37 = "\n{QueueClientRequest} queueing singleton check|lock client-request involving secure content until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    else
    {
      v44 = [(MADAutoAssetControlManager *)self handleClientPotentialJob:v5 alreadyScheduledSelector:0 forAutoJob:0 fromLocation:@"QueueClientRequest"];
      v34 = _MADLog(@"AutoControl");
      v45 = os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT);
      if (!v44)
      {
        if (v45)
        {
          v53 = [v5 clientRequest];
          v54 = [v53 summary];
          *buf = 138543362;
          v56 = v54;
          _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, "\n{QueueClientRequest} responded to singleton check|lock client-request (NOT involving secure content) | clientRequest:%{public}@", buf, 0xCu);
        }

LABEL_40:

        goto LABEL_10;
      }

      if (!v45)
      {
        goto LABEL_36;
      }

      v35 = [v5 clientRequest];
      v36 = [v35 summary];
      *buf = 138543362;
      v56 = v36;
      v37 = "\n{QueueClientRequest} queueing singleton check|lock client-request (NOT involving secure content) until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, v37, buf, 0xCu);

    goto LABEL_36;
  }

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"QueueClientRequest" withEventInfo:v5];
  if (!v11)
  {
    v38 = [NSString alloc];
    v39 = [v5 summary];
    v40 = [v38 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v39];
LABEL_27:
    v42 = v40;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6102 fromAction:@"QueueClientRequest" withDescription:v40];

    goto LABEL_28;
  }

  if (![(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5]|| ![(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:v11 fromLocation:@"QueueClientRequest"])
  {
    v27 = [v5 clientRequest];
    v28 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v27];
    v29 = [(MADAutoAssetControlManager *)self _messageBlockedUntilDownloadManagerSync:v28];

    if (v29)
    {
      goto LABEL_38;
    }

LABEL_31:
    [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v5 fromLocation:@"QueueClientRequest"];
    goto LABEL_29;
  }

  v12 = [NSString alloc];
  v13 = [v5 clientRequest];
  v14 = [v13 summary];
  v15 = [v12 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", v14];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"QueueClientRequest" withDescription:v15];

  v16 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
  {
    v17 = [v5 clientRequest];
    v18 = [v17 summary];
    *buf = 138543362;
    v56 = v18;
    v19 = "\n[SET-ELIMINATE]{QueueClientRequest} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
LABEL_16:
    _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, v19, buf, 0xCu);
    goto LABEL_9;
  }

LABEL_10:

LABEL_28:
LABEL_29:
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"QueueClientRequest"];

  return 0;
}

- (int64_t)action_QueueClientRequestBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"QueueClientRequestBefore1st"];
  if (!v5)
  {
    v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v16 = [v11 diag];
    v20 = [NSString alloc];
    v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v17 = [v20 initWithFormat:@"{QueueClientRequestBefore1st} nil eventInfo provided | %@", v18];
    [v16 trackAnomaly:@"AUTO-CONTROL" forReason:v17 withResult:6102 withError:0];
LABEL_9:

LABEL_10:
    goto LABEL_11;
  }

  v8 = [v5 clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:v8];

  v9 = [v5 clientRequest];
  v10 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v9];

  if (!v10)
  {
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v5];
    if (!v11)
    {
      v45 = [NSString alloc];
      v43 = [v5 summary];
      v44 = [v45 initWithFormat:@"invalid eventInfo (instance:MISSING)| eventInfo:%@", v43];
      goto LABEL_32;
    }

    if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5])
    {
      v21 = [v11 clientAssetSelector];
      v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:v21 fromLocation:@"QueueClientRequestBefore1st"];

      if (v22)
      {
        v23 = [NSString alloc];
        v24 = [v5 clientRequest];
        v25 = [v24 summary];
        v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", v25];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"QueueClientRequestBefore1st" withDescription:v26];

        v16 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_11;
        }

        v17 = [v5 clientRequest];
        v18 = [v17 summary];
        *buf = 138543362;
        v62 = v18;
        v19 = "\n[ELIMINATE]{QueueClientRequestBefore1st} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
LABEL_17:
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, v19, buf, 0xCu);
        goto LABEL_9;
      }
    }

    v33 = [v5 clientRequest];
    v34 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v33];
    v35 = [v11 clientAssetSelector];
    v36 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v34 forAssetSelector:v35];

    if (!v36)
    {
      goto LABEL_29;
    }

    v37 = [v5 clientRequest];
    v16 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v37];

    if (([SUCore stringIsEqual:v16 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) == 0 && ![SUCore stringIsEqual:v16 to:@"MA-AUTO:LOCK_CONTENT"])
    {
      goto LABEL_40;
    }

    if ([(MADAutoAssetControlManager *)self isNoWaitRequestInvolvingSecureAsset:v5])
    {
      v38 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
      {
LABEL_39:

        goto LABEL_40;
      }

      v39 = [v5 clientRequest];
      v40 = [v39 summary];
      *buf = 138543362;
      v62 = v40;
      v41 = "\n{QueueClientRequestBefore1st} queueing singleton check|lock client-request involving secure content until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    else
    {
      v48 = [(MADAutoAssetControlManager *)self handleClientPotentialJob:v5 alreadyScheduledSelector:0 forAutoJob:0 fromLocation:@"QueueClientRequest"];
      v38 = _MADLog(@"AutoControl");
      v49 = os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT);
      if (!v48)
      {
        if (v49)
        {
          v58 = [v5 clientRequest];
          v59 = [v58 summary];
          *buf = 138543362;
          v62 = v59;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "\n{QueueClientRequestBefore1st} responded to singleton check|lock client-request (NOT involving secure content) | clientRequest:%{public}@", buf, 0xCu);
        }

LABEL_43:

        goto LABEL_11;
      }

      if (!v49)
      {
        goto LABEL_39;
      }

      v39 = [v5 clientRequest];
      v40 = [v39 summary];
      *buf = 138543362;
      v62 = v40;
      v41 = "\n{QueueClientRequestBefore1st} queueing singleton check|lock client-request (NOT involving secure content) until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, v41, buf, 0xCu);

    goto LABEL_39;
  }

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"QueueClientRequestBefore1st" withEventInfo:v5];
  if (!v11)
  {
    v42 = [NSString alloc];
    v43 = [v5 summary];
    v44 = [v42 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v43];
LABEL_32:
    v46 = v44;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6102 fromAction:@"QueueClientRequestBefore1st" withDescription:v44];

    goto LABEL_33;
  }

  if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5]&& [(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:v11 fromLocation:@"QueueClientRequestBefore1st"])
  {
    v12 = [NSString alloc];
    v13 = [v5 clientRequest];
    v14 = [v13 summary];
    v15 = [v12 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", v14];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"QueueClientRequestBefore1st" withDescription:v15];

    v16 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
LABEL_11:

LABEL_33:
      goto LABEL_34;
    }

    v17 = [v5 clientRequest];
    v18 = [v17 summary];
    *buf = 138543362;
    v62 = v18;
    v19 = "\n[SET-ELIMINATE]{QueueClientRequestBefore1st} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
    goto LABEL_17;
  }

  v27 = [v5 clientRequest];
  v28 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v27];
  v29 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v28 forSetInstance:v11];

  if (v29)
  {
    v30 = [v5 clientRequest];
    v16 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v30];

    if (([SUCore stringIsEqual:v16 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v16 to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      v60 = 0;
      v31 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:v11 dueToMessageName:v16 selectedConfig:&v60];
      if (v31)
      {
        v32 = v31;
        v18 = [[NSString alloc] initWithFormat:@"unable to determine valid set-configuration when REQUIRED for operation [%@]", v16];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:v32 fromAction:@"QueueClientRequestBefore1st" withDescription:v18];
        goto LABEL_10;
      }

      v57 = [(MADAutoAssetControlManager *)self handleClientPotentialSetJob:v5 forAutoJob:0 fromLocation:@"QueueClientRequestBefore1st"];

      if ((v57 & 1) == 0)
      {
        goto LABEL_34;
      }

      goto LABEL_41;
    }

    if (([SUCore stringIsEqual:v16 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0)
    {
      [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:v5 fromLocation:@"QueueClientRequestBefore1st"];
      goto LABEL_11;
    }

LABEL_40:

LABEL_41:
    v50 = [v5 clientRequest];
    v51 = [(MADAutoAssetControlManager *)self timerStartForRequest:v50 fromLocation:@"QueueClientRequestBefore1st"];

    if (!v51)
    {
      v53 = [NSString alloc];
      v54 = [v5 clientRequest];
      v55 = [v54 summary];
      v56 = [v53 initWithFormat:@"immediate timeout (unable to start timer) | clientRequest:%@", v55];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6105 fromAction:@"QueueClientRequestBefore1st" withDescription:v56];

      goto LABEL_34;
    }

    v52 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
    [v52 addObject:v5];

    v11 = [(MADAutoAssetControlManager *)self statistics];
    v16 = [v11 totalQueuedClientRequests];
    v38 = [v5 clientRequest];
    [(MADAutoAssetControlManager *)self _statsIncrement:v16 forClientRequest:v38];
    goto LABEL_43;
  }

LABEL_29:

  [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v5 fromLocation:@"QueueClientRequestBefore1st"];
LABEL_34:
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"QueueClientRequestBefore1st"];

  return 0;
}

- (int64_t)action_RemoveQueuedClient:(id)a3 error:(id *)a4
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:a3];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  return 0;
}

- (int64_t)action_RouteClientRequest:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v8 = [v5 clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:v8];

  v9 = [v5 clientRequest];
  LODWORD(v7) = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v9];

  if (v7)
  {
    v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"RouteClientRequest" withEventInfo:v5];
    if (v10)
    {
      if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5]&& [(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:v10 fromLocation:@"RouteClientRequest"])
      {
        v11 = [NSString alloc];
        v12 = [v5 clientRequest];
        v13 = [v12 summary];
        v14 = [v11 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", v13];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"RouteClientRequest" withDescription:v14];

        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          v16 = [v5 clientRequest];
          v17 = [v16 summary];
          *buf = 138543362;
          v34 = v17;
          v18 = "\n[SET-ELIMINATE]{RouteClientRequest} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
LABEL_13:
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, v18, buf, 0xCu);

          goto LABEL_14;
        }

        goto LABEL_14;
      }

      goto LABEL_16;
    }

    v27 = [NSString alloc];
    v28 = [v5 summary];
    v29 = [v27 initWithFormat:@"{RouteClientRequest} invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v28];
LABEL_19:
    v31 = v29;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v29];

    goto LABEL_20;
  }

  v19 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v5];
  v10 = v19;
  if (!v19)
  {
    v30 = [NSString alloc];
    v28 = [v5 summary];
    v29 = [v30 initWithFormat:@"{RouteClientRequest} invalid eventInfo (instance:MISSING) | eventInfo:%@", v28];
    goto LABEL_19;
  }

  v20 = [v19 clientAssetSelector];
  if (!v20 || ![(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:v5])
  {

    goto LABEL_16;
  }

  v21 = [v10 clientAssetSelector];
  v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:v21 fromLocation:@"RouteClientRequest"];

  if (!v22)
  {
LABEL_16:
    [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v5 fromLocation:@"RouteClientRequest"];
    goto LABEL_20;
  }

  v23 = [NSString alloc];
  v24 = [v5 clientRequest];
  v25 = [v24 summary];
  v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", v25];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v5 withErrorCode:6114 fromAction:@"RouteClientRequest" withDescription:v26];

  v15 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
  {
    v16 = [v5 clientRequest];
    v17 = [v16 summary];
    *buf = 138543362;
    v34 = v17;
    v18 = "\n[ELIMINATE]{RouteClientRequest} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
    goto LABEL_13;
  }

LABEL_14:

LABEL_20:
  return 0;
}

- (int64_t)action_RouteClientClosed:(id)a3 error:(id *)a4
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:a3];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  return 0;
}

- (int64_t)action_QueueDownloadManager:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:QueueDownloadManager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  if (!v5)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v22 = [v18 diag];
    v23 = [NSString alloc];
    v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v25 = [v23 initWithFormat:@"{QueueDownloadManager} nil eventInfo provided | %@", v24];
    [v22 trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6111 withError:0];

LABEL_12:
    goto LABEL_13;
  }

  v9 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  [v9 addObject:v5];

  v10 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v11 = [v10 count] > 0x400;

  if (v11)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeRemoveType:8];
  }

  v12 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v13 = [v12 count] > 0x400;

  if (v13)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeRemoveType:8];
  }

  v14 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v15 = [v14 count] > 0x400;

  if (v15)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeReduceToLatest];
  }

  v16 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v17 = [v16 count] > 0x400;

  if (v17)
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      v19 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v20 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
      v21 = [v20 count];
      *buf = 138543618;
      v29 = v19;
      v30 = 2048;
      v31 = v21;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "[%{public}@] {QueueDownloadManager} | unable to reduce downloadManagerEventsAwaitingResumed (excessive auto-asset-jobs in-flight) | awaitingCount:%ld", buf, 0x16u);
    }

    goto LABEL_12;
  }

LABEL_13:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_RouteCatalogFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteCatalogFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeCatalogFinished:@"RouteCatalogFinished" withEventInfo:v5, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RouteConfigFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteConfigFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeConfigFinished:@"RouteConfigFinished" withEventInfo:v5, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RouteAssetFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteAssetFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeAssetFinished:@"RouteAssetFinished" withEventInfo:v5, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_Before1stCatalogFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stCatalogFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 diag];
  v11 = [NSString alloc];
  v12 = [v5 summary];
  v13 = [v11 initWithFormat:@"{Before1stCatalogFinished} DownloadManager indication of catalog lookup finished when device is before first-unlock | eventInfo:%@", v12];
  [v10 trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_Before1stConfigFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stConfigFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 diag];
  v11 = [NSString alloc];
  v12 = [v5 summary];
  v13 = [v11 initWithFormat:@"{Before1stConfigFinished} DownloadManager indication of download configuration change finished when device is before first-unlock | eventInfo:%@", v12];
  [v10 trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_Before1stAssetFinished:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stAssetFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 diag];
  v11 = [NSString alloc];
  v12 = [v5 summary];
  v13 = [v11 initWithFormat:@"{Before1stAssetFinished} DownloadManager indication of asset download finished when device is before first-unlock | eventInfo:%@", v12];
  [v10 trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_SyncedReviewUnlocked:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedReviewUnlocked", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self clientRequestsAwaitingDispatchAll:@"SyncedReviewUnlocked", v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SyncedReviewBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedReviewBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self clientRequestsAwaitingSyncToAwaitingFirstUnlock:@"SyncedReviewBefore1st", v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_ObtainLookupGrant:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ObtainLookupGrant", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v5 autoAssetSelector];
  LODWORD(v8) = v9 == 0;

  if (v8)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v27 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v28 = [v5 summary];
      *buf = 138543618;
      v63 = v27;
      v64 = 2114;
      v65 = v28;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ObtainLookupGrant} | job obtain-lookup-grant without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    v10 = [v5 autoAssetSelector];
    v11 = [v10 assetType];
    v12 = v11 == 0;

    if (!v12)
    {
      v13 = [v5 autoAssetUUID];
      v14 = [v5 fromAutoAssetJob];
      v15 = [v5 originalSelector];
      v16 = [(MADAutoAssetControlManager *)self currentJobByUUID:v13 potentiallyResumingJob:v14 withOriginalSelector:v15 fromLocation:@"ObtainLookupGrant" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job obtain-lookup-grant" downloadingDescriptor:0 baseForPatchDescriptor:0, state.opaque[0], state.opaque[1]];

      if (v16)
      {
        v17 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
        v18 = [v5 autoAssetSelector];
        v19 = [v18 assetType];
        v20 = [v17 safeObjectForKey:v19 ofClass:objc_opt_class()];

        if (!v20)
        {
          v35 = [MADAutoAssetLookupGrant alloc];
          v36 = [v5 autoAssetSelector];
          v37 = [v36 assetType];
          v20 = [(MADAutoAssetLookupGrant *)v35 initForAssetType:v37];

          v38 = [v5 autoAssetUUID];
          [v20 setHolderJobUUID:v38];

          v39 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
          v40 = [v5 autoAssetSelector];
          v41 = [v40 assetType];
          [v39 setSafeObject:v20 forKey:v41];

          [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:v20 message:@"first job requesting exclusive lookup grant for asset-type"];
          v31 = [v20 holderJobUUID];
          [v16 exclusiveLookupForAssetTypeGranted:v31];
LABEL_25:

          goto LABEL_26;
        }

        v21 = [v20 holderJobUUID];
        v22 = v21 == 0;

        if (v22)
        {
          v42 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v43 = [v42 diag];
          v44 = [NSString alloc];
          v45 = [v20 summary];
          v46 = [v44 initWithFormat:@"{ObtainLookupGrant} pre-existing lookup-grant with no current holder of the grant | lookupGrant:%@", v45];
          [v43 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v46 withResult:6111 withError:0];

          do
          {
            v47 = [v20 awaitingExclusiveGrant];
            v48 = [v47 count] == 0;

            if (v48)
            {
              v56 = [v5 autoAssetUUID];
              [v20 setHolderJobUUID:v56];

              v57 = objc_alloc_init(NSMutableArray);
              [v20 setAwaitingExclusiveGrant:v57];

              [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:v20 message:@"one-and-only job that has just requested the grant"];
              v31 = [v20 holderJobUUID];
              [v16 exclusiveLookupForAssetTypeGranted:v31];
              goto LABEL_25;
            }

            v31 = [(MADAutoAssetControlManager *)self jobToBeGivenGrant:v20];
          }

          while (!v31);
          v49 = [v5 autoAssetUUID];
          v50 = v49 == 0;

          if (!v50)
          {
            v51 = [v20 awaitingExclusiveGrant];
            v52 = [v5 autoAssetUUID];
            [v51 addObject:v52];

            [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:v20 message:@"grant given to the next in line (after detection of pre-existing lookup-grant with no current holder)"];
            v33 = [v20 holderJobUUID];
            [v31 exclusiveLookupForAssetTypeGranted:v33];
            goto LABEL_24;
          }

          v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v34 = [v33 diag];
          v58 = [NSString alloc];
          v54 = [v20 summary];
          v55 = [v5 summary];
          v59 = [v58 initWithFormat:@"{ObtainLookupGrant} about to give grant yet nil eventInfo.autoAssetUUID | lookupGrant:%@ | eventInfo:%@", v54, v55];
          [v34 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v59 withResult:6111 withError:0];
        }

        else
        {
          v23 = [v5 autoAssetUUID];
          v24 = v23 == 0;

          if (!v24)
          {
            v25 = [v20 awaitingExclusiveGrant];
            v26 = [v5 autoAssetUUID];
            [v25 addObject:v26];

            [(MADAutoAssetControlManager *)self _logLookupGrantAwaiting:@"ObtainLookupGrant" ofLookupGrant:v20 message:@"job awaiting obtain-lookup-grant"];
LABEL_26:

            goto LABEL_27;
          }

          v31 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v33 = [v31 diag];
          v53 = [NSString alloc];
          v34 = [v20 summary];
          v54 = [v5 summary];
          v55 = [v53 initWithFormat:@"{ObtainLookupGrant} about to put at back of the line yet nil eventInfo.autoAssetUUID | lookupGrant:%@ | eventInfo:%@", v34, v54];
          [v33 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v55 withResult:6111 withError:0];
        }
      }

      else
      {
        v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v31 = [v20 diag];
        v32 = [NSString alloc];
        v33 = [v5 summary];
        v34 = [v32 initWithFormat:@"{ObtainLookupGrant} job requesting lookup-grant not a current job | eventInfo:%@", v33];
        [v31 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v34 withResult:6111 withError:0];
      }

LABEL_24:
      goto LABEL_25;
    }

    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v29 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v30 = [v5 summary];
      *buf = 138543618;
      v63 = v29;
      v64 = 2114;
      v65 = v30;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ObtainLookupGrant} | job obtain-lookup-grant without asset-type | event:%{public}@", buf, 0x16u);
    }
  }

LABEL_27:

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ReleaseLookupGrant:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ReleaseLookupGrant", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v5 autoAssetSelector];
  LODWORD(v8) = v9 == 0;

  if (v8)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v39 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v40 = [v5 summary];
      *buf = 138543618;
      v58 = v39;
      v59 = 2114;
      v60 = v40;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ReleaseLookupGrant} | job release-lookup-grant without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    v10 = [v5 autoAssetSelector];
    v11 = [v10 assetType];
    v12 = v11 == 0;

    if (!v12)
    {
      v13 = [v5 autoAssetUUID];
      v14 = [v5 fromAutoAssetJob];
      v15 = [v5 originalSelector];
      v16 = [(MADAutoAssetControlManager *)self currentJobByUUID:v13 potentiallyResumingJob:v14 withOriginalSelector:v15 fromLocation:@"ReleaseLookupGrant" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job release-lookup-grant" downloadingDescriptor:0 baseForPatchDescriptor:0, state.opaque[0], state.opaque[1]];

      v17 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
      v18 = [v5 autoAssetSelector];
      v19 = [v18 assetType];
      v20 = [v17 safeObjectForKey:v19 ofClass:objc_opt_class()];

      if (v20)
      {
        v21 = [v20 assetType];
        v22 = v21 == 0;

        if (!v22)
        {
          if (!v16)
          {
            v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v24 = [v23 diag];
            v25 = [NSString alloc];
            v26 = [v20 summary];
            v27 = [v25 initWithFormat:@"{ReleaseLookupGrant} failed job lookup for lookupGrant:%@", v26];
            [v24 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v27 withResult:6111 withError:0];
          }

          v28 = [v20 holderJobUUID];
          v29 = v28 == 0;

          if (v29)
          {
            v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v34 = [v33 diag];
            v50 = [NSString alloc];
            v36 = [v20 summary];
            v37 = [v50 initWithFormat:@"{ReleaseLookupGrant} pre-existing lookup-grant with no current holder of the grant | lookupGrant:%@", v36];
            [v34 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v37 withResult:6111 withError:0];
          }

          else
          {
            v30 = [v5 autoAssetUUID];
            v31 = [v20 holderJobUUID];
            v32 = [SUCore stringIsEqual:v30 to:v31];

            if (v32)
            {
              goto LABEL_19;
            }

            v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v34 = [v33 diag];
            v35 = [NSString alloc];
            v36 = [v5 autoAssetUUID];
            v37 = [v20 summary];
            v38 = [v35 initWithFormat:@"{ReleaseLookupGrant} pre-existing lookup-grant with different grant holder | releasingJobUUID:%@, lookupGrant:%@", v36, v37];
            [v34 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v38 withResult:6111 withError:0];
          }

LABEL_19:
          while (1)
          {
            v51 = [v20 awaitingExclusiveGrant];
            v52 = [v51 count] == 0;

            if (v52)
            {
              break;
            }

            v43 = [(MADAutoAssetControlManager *)self jobToBeGivenGrant:v20];
            if (v43)
            {
              [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ReleaseLookupGrant" ofLookupGrant:v20 message:@"post-release when other job awaiting obtain-lookup-grant"];
              v44 = [v20 holderJobUUID];
              [v43 exclusiveLookupForAssetTypeGranted:v44];
              goto LABEL_22;
            }
          }

          v54 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
          v55 = [v20 assetType];
          [v54 removeObjectForKey:v55];

          [(MADAutoAssetControlManager *)self _logLookupGrantReleased:@"ReleaseLookupGrant" ofLookupGrant:v20 message:@"no jobs awaiting obtain-lookup-grant"];
LABEL_23:

          goto LABEL_24;
        }

        v43 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v44 = [v43 diag];
        v49 = [NSString alloc];
        v46 = [v20 summary];
        v47 = [v49 initWithFormat:@"{ReleaseLookupGrant} lookup-grant without assetType:%@", v46];
        [v44 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v47 withResult:6111 withError:0];
      }

      else
      {
        v43 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v44 = [v43 diag];
        v45 = [NSString alloc];
        v46 = [v5 autoAssetSelector];
        v47 = [v46 assetType];
        v48 = [v45 initWithFormat:@"{ReleaseLookupGrant} no lookup-grant for assetType:%@", v47];
        [v44 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v48 withResult:6111 withError:0];
      }

LABEL_22:
      goto LABEL_23;
    }

    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v41 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v42 = [v5 summary];
      *buf = 138543618;
      v58 = v41;
      v59 = 2114;
      v60 = v42;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ReleaseLookupGrant} | job release-lookup-grant without asset-type | event:%{public}@", buf, 0x16u);
    }
  }

LABEL_24:

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ProvidePersistedForJob:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ProvidePersistedForJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v5 autoAssetSelector];
  LODWORD(v8) = v9 == 0;

  if (v8)
  {
    v20 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      v22 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v23 = [v5 summary];
      *buf = 138543618;
      v31 = v22;
      v32 = 2114;
      v33 = v23;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    v10 = [v5 autoAssetSelector];
    v11 = [v10 assetVersion];
    v12 = v11 == 0;

    if (v12)
    {
      v20 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v25 = [v5 summary];
        *buf = 138543618;
        v31 = v24;
        v32 = 2114;
        v33 = v25;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without asset-version | event:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v13 = [v5 downloadingDescriptor];
      v14 = v13 == 0;

      if (v14)
      {
        v20 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
        {
          v26 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v27 = [v5 summary];
          *buf = 138543618;
          v31 = v26;
          v32 = 2114;
          v33 = v27;
          _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without downloading-descriptor | event:%{public}@", buf, 0x16u);
        }
      }

      else
      {
        v15 = [v5 autoAssetUUID];
        v16 = [v5 fromAutoAssetJob];
        v17 = [v5 originalSelector];
        v18 = [v5 downloadingDescriptor];
        v19 = [v5 baseForPatchDescriptor];
        v20 = [(MADAutoAssetControlManager *)self currentJobByUUID:v15 potentiallyResumingJob:v16 withOriginalSelector:v17 fromLocation:@"ProvidePersistedForJob" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job requesting persisted-state" downloadingDescriptor:v18 baseForPatchDescriptor:v19, state.opaque[0], state.opaque[1]];

        if (v20)
        {
          v21 = [v5 autoAssetJobID];
          [v20 persistedStateForDownloadJob:v21];
        }
      }
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_SetJobLookupResponseRcvd:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v31.opaque[0] = 0;
  v31.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SetJobLookupResponseRcvd", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v31);

  v9 = [v5 setConfiguration];
  LODWORD(v8) = v9 == 0;

  if (!v8)
  {
    v10 = [v5 setConfiguration];
    v11 = [v10 clientDomainName];
    v12 = [v5 setConfiguration];
    v13 = [v12 assetSetIdentifier];
    v14 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v11 forAssetSetIdentifier:v13];

    v15 = [[NSMutableString alloc] initWithString:@"lookup-response"];
    if (v14)
    {
      v16 = [v5 autoAssetCatalog];
      v17 = v16 == 0;

      if (!v17)
      {
        v18 = [v5 autoAssetCatalog];
        v19 = [v18 safeStringForKey:@"CachedAssetSetId"];

        if (v19)
        {
          v20 = [v5 autoAssetCatalog];
          v21 = [v20 safeStringForKey:@"DownloadedFromLive"];

          if (v21)
          {
            v22 = [[NSURL alloc] initWithString:v21];
          }

          else
          {
            v22 = objc_opt_new();
          }

          v25 = v22;
          [v14 setMostRecentlyReceivedCachedAssetSetID:v19];
          [v14 setMostRecentlyReceivedDownloadedFromLive:v25];
          v26 = [v5 autoAssetCatalog];
          v27 = [v26 safeDateForKey:@"lastTimeChecked"];
          [v14 setMostRecentlyReceivedLastTimeChecked:v27];

          v28 = [v5 autoAssetCatalog];
          v29 = [v28 safeDateForKey:@"postedDate"];
          [v14 setMostRecentlyReceivedPostedDate:v29];

          [v15 appendString:{@", refreshed most-recently-received"}];
        }

        else
        {
          v21 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v25 = [v21 diag];
          [v25 trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{SetJobLookupResponseRcvd} auto-asset-catalog provided by set-job MISSING MA_CACHED_ASSET_ID_KEY" withResult:6103 withError:0];
        }

        if (([v14 haveReceivedLookupResponse]& 1) != 0)
        {

          if (!v19)
          {
            goto LABEL_19;
          }
        }

        else
        {
          [v14 setHaveReceivedLookupResponse:1];
          [v15 appendString:{@", set have-received-lookup-response"}];
        }

        goto LABEL_18;
      }

      if (([v14 haveReceivedLookupResponse]& 1) == 0)
      {
        [v14 setHaveReceivedLookupResponse:1];
        [v15 appendString:{@", set have-received-lookup-response"}];
LABEL_18:
        [(MADAutoAssetControlManager *)self setConfigurationPersist:v14 fromLocation:@"SetJobLookupResponseRcvd" forReason:v15 dueToAlter:0 forHistoryOperation:448];
      }
    }

LABEL_19:

    goto LABEL_20;
  }

  v14 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
  {
    v23 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v24 = [v5 summary];
    *buf = 138543618;
    v33 = v23;
    v34 = 2114;
    v35 = v24;
    _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "[%{public}@] {SetJobLookupResponseRcvd} | job indicating lookup response received yet no set-configuation | event:%{public}@", buf, 0x16u);
  }

LABEL_20:

  os_activity_scope_leave(&v31);
  return 0;
}

- (int64_t)action_IssueClientReplyJobResponse:(id)a3 error:(id *)a4
{
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:IssueClientReplyJobResponse", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [v6 autoAssetUUID];
  v11 = [(MADAutoAssetControlManager *)self currentJobByUUID:v10 fromLocation:@"IssueClientReplyJobResponse" notFoundCode:0 notFoundReason:0];

  v12 = [v6 fromAutoAssetJob];
  if (v12)
  {
    v4 = [v6 fromAutoAssetJob];
    if ([v4 autoAssetSetJob])
    {

LABEL_11:
      v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v16 = [v15 diag];
      [v16 trackAnomaly:@"AUTO-CONTROL" forReason:@"{IssueClientReplyJobRespons} should never be called for set-job" withResult:6103 withError:0];
      goto LABEL_48;
    }

    if (!v11)
    {

      goto LABEL_13;
    }
  }

  else if (!v11)
  {
    goto LABEL_13;
  }

  v13 = [v11 autoAssetSetJob];
  v14 = v13;
  if (v12)
  {

    if (v14)
    {
      goto LABEL_11;
    }
  }

  else if (v13)
  {
    goto LABEL_11;
  }

LABEL_13:
  v17 = [v6 autoAssetUUID];
  v18 = [v6 fromAutoAssetJob];
  v19 = [v6 originalSelector];
  v20 = [(MADAutoAssetControlManager *)self currentJobByUUID:v17 potentiallyResumingJob:v18 withOriginalSelector:v19 fromLocation:@"IssueClientReplyJobResponse" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job requesting reply with job response (and unable to resume)" downloadingDescriptor:0 baseForPatchDescriptor:0];

  v15 = [v6 jobInformation];
  v16 = [v15 initialAssetSelector];
  v58 = [v15 fullAssetSelector];
  v55 = [v15 currentStatus];
  v21 = [v6 responseError];
  v22 = [v6 clientRequest];
  v23 = [v22 clientRequestMessage];
  v56 = [MADAutoAssetControlManager replyMessageNameForRequest:v23];

  if (!v21)
  {
    if (v16)
    {
      v24 = [v16 assetVersion];
    }

    else
    {
      v24 = 0;
    }

    v25 = [v6 autoAssetUUID];
    if (v58)
    {
      [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v58 forActiveJobUUID:v25 withLatestJobStatus:v55 matchingAssetVersion:v24 fromLocation:@"IssueClientReplyJobResponse(full-selector)"];
    }

    else
    {
      [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v16 forActiveJobUUID:v25 withLatestJobStatus:v55 matchingAssetVersion:v24 fromLocation:@"IssueClientReplyJobResponse(initial-selector)"];
    }

    v26 = [v6 clientRequest];
    v27 = [v26 clientReplyCompletion];
    if (v27)
    {
      v28 = [SUCore stringIsEqual:v56 to:@"MA-AUTO(REPLY):LOCK_CONTENT"];

      if (v28)
      {
        v29 = [v58 assetType];
        v30 = [v58 assetSpecifier];
        v31 = [v58 assetVersion];
        v57 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"IssueClientReplyJobResponse" forAssetType:v29 withAssetSpecifier:v30 matchingAssetVersion:v31];

        if (v57)
        {
          v32 = [MAAutoAssetSelector alloc];
          v33 = [v57 assetType];
          v34 = [v57 assetSpecifier];
          v35 = [v57 assetVersion];
          v26 = [v32 initForAssetType:v33 withAssetSpecifier:v34 matchingAssetVersion:v35];

          if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"IssueClientReplyJobResponse" forDescriptor:v57]&& [MADAutoAssetSecure isPersonalizationRequired:@"IssueClientReplyJobResponse" forDescriptor:v57])
          {
            [v57 setSecureOperationInProgress:1];
            v36 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v57];
            v37 = v60;
            v60[0] = _NSConcreteStackBlock;
            v60[1] = 3221225472;
            v60[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke;
            v60[3] = &unk_4B4680;
            v60[4] = self;
            v38 = v57;
            v60[5] = v38;
            v60[6] = v26;
            v60[7] = v6;
            [MADAutoAssetSecure personalizeGraftDownloaded:@"IssueClientReplyJobResponse" forDescriptor:v38 setDescriptor:v36 allowingNetwork:1 completion:v60];
LABEL_34:

            goto LABEL_40;
          }

          if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:@"IssueClientReplyJobResponse" forDescriptor:v57]&& ![MADAutoAssetSecure isGraftedOrMounted:@"IssueClientReplyJobResponse" forDescriptor:v57])
          {
            v39 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
            {
              v40 = [v57 summary];
              *buf = 138543362;
              v63 = v40;
              _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | triggering graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
            }

            [v57 setSecureOperationInProgress:1];
            v36 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v57];
            v37 = v59;
            v59[0] = _NSConcreteStackBlock;
            v59[1] = 3221225472;
            v59[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2589;
            v59[3] = &unk_4B4680;
            v59[4] = self;
            v41 = v57;
            v59[5] = v41;
            v59[6] = v26;
            v59[7] = v6;
            [MADAutoAssetSecure graftDownloaded:@"IssueClientReplyJobResponse" graftingDescriptor:v41 setDescriptor:v36 completion:v59];
            goto LABEL_34;
          }

          goto LABEL_28;
        }

        v21 = [MAAutoAssetError buildError:6504 fromOperation:@"IssueClientReplyJobResponse" underlyingError:0 withDescription:@"job successfully downloaded asset yet asset not present on the filesystem"];
        if (v21)
        {
          goto LABEL_14;
        }
      }

      v57 = 0;
      goto LABEL_37;
    }

    v57 = 0;
LABEL_28:

LABEL_37:
    if ([SUCore stringIsEqual:v56 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
      [(MADAutoAssetControlManager *)self lockAutoAssetReplyJobResponse:@"not awaiting personalization/grafting [or mounting]" forEventInfo:v6 lockingChosenDescriptor:v57];
LABEL_41:
      v21 = 0;
      goto LABEL_42;
    }

    v42 = [v6 autoAssetSelector];
    v43 = [v6 autoAssetUUID];
    v44 = [v6 clientRequest];
    v45 = [v44 responseMessage];
    v26 = [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v42 forActiveJobUUID:v43 forJobResponse:v45 withResponseError:0];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v26 withResponseError:0 fromLocation:@"IssueClientReplyJobResponse"];
LABEL_40:

    goto LABEL_41;
  }

LABEL_14:
  [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:@"IssueClientReplyJobResponse" forEventInfo:v6 withResponseError:v21 forAttemptedDescriptor:0];
  v57 = 0;
LABEL_42:
  v46 = [v6 fromAutoAssetJob];
  v47 = v46 == 0;

  if (!v47)
  {
    v48 = [v6 fromAutoAssetJob];
    if ([v48 clientRequestCount] < 1)
    {
      v49 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v50 = [v49 diag];
      v51 = [NSString alloc];
      v52 = [v6 summary];
      v53 = [v51 initWithFormat:@"auto-job indicating issue-reply when no tracked client-requests | eventInfo:%@", v52];
      [v50 trackAnomaly:@"AUTO-CONTROL" forReason:v53 withResult:6110 withError:0];
    }

    else
    {
      [v48 setClientRequestCount:{objc_msgSend(v48, "clientRequestCount") - 1}];
    }
  }

LABEL_48:
  os_activity_scope_leave(&state);

  return 0;
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = [*(a1 + 32) summary];
      *buf = 138543362;
      v9 = v3;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-GRAFT][SINGLETON-CONTROL][ELIMINATE] {IssueClientReplyJobResponse} | eliminate triggered while performing personalize+graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:@"IssueClientReplyJobResponse" forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v7 = [[NSString alloc] initWithFormat:@"%@[PERSONALIZING/GRAFTING]", @"IssueClientReplyJobResponse"];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:? forEventInfo:? withResponseError:? forAttemptedDescriptor:?];
  }

  else
  {
    v4 = *(a1 + 56);
    v6 = *(a1 + 32);
    v5 = *(a1 + 40);

    [v5 lockAutoAssetReplyJobResponse:@"any personalization/grafting [or mounting] successful" forEventInfo:v4 lockingChosenDescriptor:v6];
  }
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2589(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2_2590;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2_2590(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = [*(a1 + 32) summary];
      *buf = 138543362;
      v11 = v3;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL][ELIMINATE] {IssueClientReplyJobResponse} | eliminate triggered while grafting|mounting | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:@"IssueClientReplyJobResponse" forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v4 = [[NSString alloc] initWithFormat:@"%@[GRAFTING]", @"IssueClientReplyJobResponse"];
    v5 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      v6 = [*(a1 + 64) checkedDescription];
      v7 = [*(a1 + 32) summary];
      *buf = 138543618;
      v11 = v6;
      v12 = 2114;
      v13 = v7;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | graft|mount ERROR | error: %{public}@ | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:v4 forEventInfo:*(a1 + 56) withResponseError:*(a1 + 64) forAttemptedDescriptor:*(a1 + 32)];
  }

  else
  {
    v8 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      v9 = [*(a1 + 32) summary];
      *buf = 138543362;
      v11 = v9;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | graft|mount SUCCESS | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) lockAutoAssetReplyJobResponse:@"grafting [or mounting] successful" forEventInfo:*(a1 + 56) lockingChosenDescriptor:*(a1 + 32)];
  }
}

- (void)lockAutoAssetReplyJobResponse:(id)a3 forEventInfo:(id)a4 lockingChosenDescriptor:(id)a5
{
  v38 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v12 = _os_activity_create(&dword_0, "MADAutoControl:lockAutoAssetReplyJobResponse", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v12, &state);

  v35 = [v8 jobInformation];
  v13 = [v9 assetType];
  if (v13)
  {
    v14 = [MAAutoAssetSelector alloc];
    v15 = [v9 assetType];
    v16 = [v9 assetSpecifier];
    v17 = [v9 assetVersion];
    v36 = [v14 initForAssetType:v15 withAssetSpecifier:v16 matchingAssetVersion:v17];
  }

  else
  {
    v36 = 0;
  }

  v18 = [v35 clientInstance];
  v19 = [v35 clientDesire];
  v20 = v19;
  if (v18)
  {
    if (v19)
    {
      goto LABEL_9;
    }
  }

  else
  {
    v18 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v8];
    if (v20)
    {
      goto LABEL_9;
    }
  }

  v21 = [v8 clientRequestMessage];
  v20 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v21];

LABEL_9:
  v37 = v20;
  v22 = [v8 clientRequest];
  v23 = [v8 clientReplyCompletion];
  v24 = [(MADAutoAssetControlManager *)self notifyLockerJustLockedDescriptor:v9 forClientInstance:v18 withClientDesire:v37 respondingToClientRequest:v22 withClientCompletion:v23];

  if (v24)
  {
    v25 = [v8 autoAssetSelector];
    v26 = [v8 autoAssetUUID];
    v27 = [v8 clientRequest];
    v28 = [v27 responseMessage];
    v29 = [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v25 forActiveJobUUID:v26 forJobResponse:v28 withResponseError:v24];
  }

  else
  {
    if ([v9 neverBeenLocked])
    {
      [v9 setNeverBeenLocked:0];
      v30 = [v18 autoAssetClientName];
      if (v30)
      {
        [v18 autoAssetClientName];
      }

      else
      {
        [v18 clientProcessName];
      }
      v31 = ;

      LOBYTE(v34) = 0;
      [(MADAutoAssetControlManager *)self trackDescriptor:v9 persisting:1 fromLocation:v38 changedWhileTerminated:0 changedNeverBeenLocked:1 historyOperation:0 firstClientName:v31 isPromoted:v34];
    }

    v25 = [v8 clientRequest];
    v39 = 0;
    v29 = [(MADAutoAssetControlManager *)self buildFoundResponseMessage:@"lockContent(job complete)" forClientRequest:v25 withFoundDescriptor:v9 withInstance:v18 withDesire:v37 fromLocation:v38 error:&v39];
    v24 = v39;
  }

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v8 issuingResponseMessage:v29 withResponseError:v24 fromLocation:v38];
  if (v24)
  {
    if (v36)
    {
      v32 = [v18 autoAssetClientName];
      if (v32)
      {
        [v18 autoAssetClientName];
      }

      else
      {
        [v18 clientProcessName];
      }
      v33 = ;
      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v33 forAssetID:@"UNKNOWN" withSelector:v36 failingWithError:v24];
    }

    else
    {
      v32 = [v18 autoAssetClientName];
      if (v32)
      {
        [v18 clientProcessName];
      }

      else
      {
        [v18 autoAssetClientName];
      }
      v33 = ;
      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v33 forAssetID:@"UNKNOWN" failingWithError:v24];
    }
  }

  os_activity_scope_leave(&state);
}

- (int64_t)action_IssueClientReplySetJob:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:IssueClientReplySetJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"IssueClientReplySetJob" forEventInfo:v5 issuingClientReply:1, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SchedulerJobFoundSame:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SchedulerJobFoundSame", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"SchedulerJobFoundSame" forEventInfo:v5 issuingClientReply:0, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SchedulerJobDownloaded:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SchedulerJobDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"SchedulerJobDownloaded" forEventInfo:v5 issuingClientReply:0, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RemoveFinishedJob:(id)a3 error:(id *)a4
{
  v55 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:RemoveFinishedJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v53 = objc_alloc_init(NSMutableDictionary);
  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = [v55 summary];
    *buf = 138543362;
    v68 = v9;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{RemoveFinishedJob} job has FINISHED | eventInfo:%{public}@", buf, 0xCu);
  }

  v62 = 0u;
  v63 = 0u;
  v60 = 0u;
  v61 = 0u;
  v10 = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  v11 = [v10 countByEnumeratingWithState:&v60 objects:v66 count:16];
  obj = v10;
  if (v11)
  {
    v12 = *v61;
    do
    {
      v13 = 0;
      do
      {
        if (*v61 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v60 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
        v17 = [v16 safeObjectForKey:v14 ofClass:objc_opt_class()];

        v18 = [v17 clientReplyCompletion];
        v19 = v18 == 0;

        if (v19)
        {
          v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v29 = [v28 diag];
          v30 = [NSString alloc];
          v31 = [v17 summary];
          v32 = [v30 initWithFormat:@"encountered client-request being tracked without reply completion | clientRequest:%@", v31];
          [v29 trackAnomaly:@"AUTO-CONTROL" forReason:v32 withResult:6101 withError:0];

          v25 = [v17 clientRequestUUID];
          [v53 setSafeObject:v17 forKey:v25];
        }

        else
        {
          v20 = [v17 autoAssetJobUUID];
          v21 = [v55 autoAssetUUID];
          v22 = [SUCore stringIsEqual:v20 to:v21];

          if (!v22)
          {
            goto LABEL_17;
          }

          v23 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
          v24 = [v55 autoAssetUUID];
          v25 = [v23 safeObjectForKey:v24 ofClass:objc_opt_class()];

          if (v25 && [v25 clientRequestCount] <= 0)
          {
            v33 = [v17 clientRequestUUID];
            [v53 setSafeObject:v17 forKey:v33];

            [v25 setClientRequestCount:{objc_msgSend(v25, "clientRequestCount") - 1}];
          }

          else
          {
            v26 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
            {
              v27 = [v55 summary];
              *buf = 138543362;
              v68 = v27;
              _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {RemoveFinishedJob} auto-asset-job indicated removal but has more to do | eventInfo:%{public}@", buf, 0xCu);
            }
          }
        }

LABEL_17:
        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v11 != v13);
      v34 = [obj countByEnumeratingWithState:&v60 objects:v66 count:16];
      v11 = v34;
    }

    while (v34);
  }

  v58 = 0u;
  v59 = 0u;
  v56 = 0u;
  v57 = 0u;
  v35 = v53;
  v36 = [v35 countByEnumeratingWithState:&v56 objects:v65 count:16];
  if (v36)
  {
    v37 = *v57;
    do
    {
      for (i = 0; i != v36; i = i + 1)
      {
        if (*v57 != v37)
        {
          objc_enumerationMutation(v35);
        }

        v39 = *(*(&v56 + 1) + 8 * i);
        v40 = objc_autoreleasePoolPush();
        v41 = [v35 safeObjectForKey:v39 ofClass:objc_opt_class()];
        [(MADAutoAssetControlManager *)self removeClientRequest:v41 fromLocation:@"RemoveFinishedJob"];

        objc_autoreleasePoolPop(v40);
      }

      v36 = [v35 countByEnumeratingWithState:&v56 objects:v65 count:16];
    }

    while (v36);
  }

  v42 = [v55 autoAssetUUID];
  v43 = [(MADAutoAssetControlManager *)self currentJobByUUID:v42 fromLocation:@"RemoveFinishedJob" notFoundCode:0 notFoundReason:0];

  if (v43)
  {
    v44 = [v43 lifetimeOSTransaction];
    v45 = v44 == 0;

    if (!v45)
    {
      [v43 setLifetimeOSTransaction:0];
      v46 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[OS-TRANSACTION-JOB] [END]", buf, 2u);
      }
    }

    [v43 finishedAcknowledgeAutoAssetJob];
  }

  else
  {
    v47 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v48 = [v47 diag];
    v49 = [NSString alloc];
    v50 = [v55 summary];
    v51 = [v49 initWithFormat:@"encountered job indicating finished when not a current job | eventInfo:%@", v50];
    [v48 trackAnomaly:@"AUTO-CONTROL" forReason:v51 withResult:6103 withError:0];
  }

  [(MADAutoAssetControlManager *)self _statsIncrementAutoJobsFinished];
  -[MADAutoAssetControlManager removeCurrentJob:schedulerInvolved:potentialNetworkFailure:fromLocation:](self, "removeCurrentJob:schedulerInvolved:potentialNetworkFailure:fromLocation:", v55, [v55 schedulerInvolved], objc_msgSend(v55, "potentialNetworkFailure"), @"RemoveFinishedJob");

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_CoalesceLateJobScheduled:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CoalesceLateJobScheduled", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  v9 = [v5 autoAssetSelector];
  [MADAutoAssetScheduler jobFinishedForSelector:v9 withPotentialNetworkFailure:0];

  os_activity_scope_leave(&v11);
  return 0;
}

- (int64_t)action_CoalesceLateJobSetScheduled:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CoalesceLateJobSetScheduled", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  v9 = [v5 setConfiguration];
  v10 = v9;
  if (v9)
  {
    v11 = [v9 clientDomainName];
    v12 = [v10 assetSetIdentifier];
    [MADAutoAssetScheduler jobFinishedForSetDomainName:v11 forAssetSetIdentifier:v12 withPotentialNetworkFailure:0];
  }

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_ScheduleJobsBefore1st:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleJobsBefore1s", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "{ScheduleJobsBefore1st}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no operations performed since device is before first-unlock", v11, 2u);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ScheduleJobs:(id)a3 error:(id *)a4
{
  v30 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  v8 = [v30 setOfAutoAssetSelectors];
  v9 = [v8 countByEnumeratingWithState:&v35 objects:v44 count:16];
  if (v9)
  {
    v31 = 0;
    v33 = *v36;
    obj = v8;
    do
    {
      v34 = v9;
      for (i = 0; i != v34; i = i + 1)
      {
        if (*v36 != v33)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v35 + 1) + 8 * i);
        if ([(MADAutoAssetControlManager *)self isAutoAssetBeingEliminated:v11])
        {
          v12 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            v13 = [v11 summary];
            *buf = 138543362;
            v41 = v13;
            _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{ScheduleJobs} [IGNORED] auto-asset being eliminated - scheduler trigger ignored | selector:%{public}@", buf, 0xCu);
          }
        }

        else
        {
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self currentJobBySelector:v11];
          if (v15)
          {
            v16 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
            {
              v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v18 = [v11 summary];
              *buf = 138543618;
              v41 = v17;
              v42 = 2114;
              v43 = v18;
              _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleJobs} auto-asset-job already running | selector:%{public}@", buf, 0x16u);
            }
          }

          else
          {
            v19 = +[NSUUID UUID];
            v16 = [v19 UUIDString];

            [(MADAutoAssetControlManager *)self osTransactionNameScheduledSingletonJob:v16];
            v20 = os_transaction_create();
            v15 = [[MADAutoAssetJob alloc] initForSelector:v11 withLifetimeOSTransaction:v20 withAutoAssetUUID:v16];
            if (v15)
            {
              [(MADAutoAssetControlManager *)self addToCurrentJobs:v15 usingSelector:v11 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:0 fromLocation:@"kMA_A_ScheduleJobs"];
              [(MADAutoAssetControlManager *)self _trackActiveDescriptor:@"ScheduleJobs" operation:@"ENTRY_ADD" usingSelector:v11 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 message:@"scheduled auto-asset-job started"];
              [(MADAutoAssetControlManager *)self _statsIncrementSchedulerTriggeredJobs];
              v21 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v11];
              [v15 startScheduleTriggeredSelector:v11 withControlInformation:v21];

              ++v31;
            }

            else
            {
              v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v23 = [v22 diag];
              v24 = [NSString alloc];
              v25 = [v11 summary];
              v26 = [v24 initWithFormat:@"unable to allocate scheduler-triggered autoAssetJob for selector:%@", v25];
              [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6101 withError:0];

              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            }
          }

          objc_autoreleasePoolPop(v14);
        }
      }

      v9 = [obj countByEnumeratingWithState:&v35 objects:v44 count:16];
    }

    while (v9);

    if (v31 > 0)
    {
      v27 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 134217984;
        v41 = v31;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "{ScheduleJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] singleton job(s) started | singletonScheduledJobsTriggered:%ld", buf, 0xCu);
      }

      [MADAutoAssetHistory recordOperation:1400 toHistoryType:5 fromLayer:1 usageCount:v31];
      goto LABEL_28;
    }
  }

  else
  {
  }

  v28 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "{ScheduleJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no singleton jobs started", buf, 2u);
  }

LABEL_28:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_ScheduleSetJobs:(id)a3 error:(id *)a4
{
  v91 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleSetJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v93 = +[NSMutableArray array];
  v105 = 0u;
  v106 = 0u;
  v103 = 0u;
  v104 = 0u;
  v8 = [v91 triggeredSets];
  v9 = [v8 countByEnumeratingWithState:&v103 objects:v112 count:16];
  if (!v9)
  {

    goto LABEL_46;
  }

  v94 = 0;
  v102 = *v104;
  obj = v8;
  do
  {
    for (i = 0; i != v9; i = i + 1)
    {
      if (*v104 != v102)
      {
        objc_enumerationMutation(obj);
      }

      v11 = *(*(&v103 + 1) + 8 * i);
      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        v12 = [v11 clientDomainName];
        v13 = [v11 assetSetIdentifier];
        v14 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:v12 forAssetSetIdentifier:v13];

        if (v14)
        {
          v15 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
          {
            v16 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v17 = [v11 summary];
            *buf = 138543618;
            v109 = v16;
            v110 = 2114;
            v111 = v17;
            _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} suspended for software update (so not scheduling set-job) | schedulerTriggered:%{public}@", buf, 0x16u);
          }

LABEL_13:

          continue;
        }
      }

      v18 = [v11 clientDomainName];
      v19 = [v11 assetSetIdentifier];
      v20 = [(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:@"ScheduleSetJobs" forClientDomainName:v18 ofSetIdentifier:v19];

      if (v20)
      {
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
        {
          v21 = [v11 summary];
          *buf = 138543362;
          v109 = v21;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{ScheduleSetJobs} [IGNORED] set-identifier being eliminated - scheduler trigger ignored | schedulerTriggered:%{public}@", buf, 0xCu);
        }

        goto LABEL_13;
      }

      v22 = objc_autoreleasePoolPush();
      v23 = [v11 clientDomainName];
      if (!v23 || ([v11 assetSetIdentifier], v24 = objc_claimAutoreleasedReturnValue(), v25 = v24 == 0, v24, v23, v25))
      {
        v28 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
        {
          v33 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v34 = [v11 summary];
          *buf = 138543618;
          v109 = v33;
          v110 = 2114;
          v111 = v34;
          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "[%{public}@] {ScheduleSetJobs} MISSING required field(s) | schedulerTriggered:%{public}@", buf, 0x16u);
        }
      }

      else if ([(MADAutoAssetControlManager *)self _haveSetAssetEntriesForSchedulerTriggered:v11])
      {
        v26 = [v11 clientDomainName];
        v27 = [v11 assetSetIdentifier];
        v28 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v26 byIdentifier:v27];

        v29 = [v11 clientDomainName];
        v30 = [v11 assetSetIdentifier];
        v100 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v29 byIdentifier:v30];

        if (v100)
        {
          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
          {
            v32 = [v11 summary];
            *buf = 138543362;
            v109 = v32;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | scheduled job triggered for set-job that is being canceled - not scheduling | schedulerTriggered:%{public}@", buf, 0xCu);
          }
        }

        else if (v28)
        {
          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
          {
            v37 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v38 = [v11 summary];
            *buf = 138543618;
            v109 = v37;
            v110 = 2114;
            v111 = v38;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} set-job already running | schedulerTriggered:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v39 = [v11 clientDomainName];
          v40 = [v11 assetSetIdentifier];
          v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v39 forAssetSetIdentifier:v40];

          if (v31)
          {
            v41 = [MANAutoAssetSetInfoInstance alloc];
            v42 = [v11 clientDomainName];
            v43 = [v11 assetSetIdentifier];
            v44 = [v31 autoAssetEntries];
            v98 = [(MANAutoAssetSetInfoInstance *)v41 initUsingClientDomain:v42 forClientName:@"com.apple.MobileAsset.daemon.internal" withProcessName:@"ScheduleSetJobs" withProcessID:0 forAssetSetIdentifier:v43 forAtomicInstance:0 comprisedOfEntries:v44 asEntriesWhenTargeting:0 associatingFrameworkUUID:0];

            v97 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:@"ScheduleSetJobs" forCreationReason:@"SCHEDULED_IN_FLIGHT" recordingHistoryOperation:221 forSetInfoInstance:v98 asSubAtomicFrom:0];
            v45 = [v97 atomicInstanceUUID];
            [v31 setDiscoveredInFlightAtomicInstance:v45];

            [(MADAutoAssetControlManager *)self setConfigurationPersist:v31 fromLocation:@"ScheduleSetJobs" forReason:@"set discoveredInFlight" dueToAlter:0 forHistoryOperation:9999];
            v46 = [v97 atomicInstanceUUID];
            [v98 setAtomicInstance:v46];

            v47 = [MADAutoSetDescriptor alloc];
            v48 = [v11 clientDomainName];
            v49 = [v11 assetSetIdentifier];
            v50 = [v98 atomicInstance];
            v96 = [(MADAutoSetDescriptor *)v47 initForClientDomainName:v48 forAssetSetIdentifier:v49 withDiscoveredAtomicInstance:v50 withDiscoveredAtomicEntries:0];

            v51 = [v31 autoAssetEntries];
            [v96 setRequestedAutoAssetEntries:v51];

            v52 = [v97 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self osTransactionNameScheduledSetJob:v52];
            v95 = os_transaction_create();

            v53 = [v11 schedulerPolicy];
            LOBYTE(v52) = v53 == 0;

            if (v52)
            {
              v99 = 0;
            }

            else
            {
              v99 = objc_alloc_init(MANAutoAssetSetPolicy);
              v54 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setUserInitiated:](v99, "setUserInitiated:", [v54 userInitiated]);

              v55 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setLockInhibitsEmergencyRemoval:](v99, "setLockInhibitsEmergencyRemoval:", [v55 lockInhibitsEmergencyRemoval]);

              v56 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOnBattery:](v99, "setAllowCheckDownloadOnBattery:", [v56 allowCheckDownloadOnBattery]);

              v57 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadWhenBatteryLow:](v99, "setAllowCheckDownloadWhenBatteryLow:", [v57 allowCheckDownloadWhenBatteryLow]);

              v58 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadWhenCPUHigh:](v99, "setAllowCheckDownloadWhenCPUHigh:", [v58 allowCheckDownloadWhenCPUHigh]);

              v59 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOverExpensive:](v99, "setAllowCheckDownloadOverExpensive:", [v59 allowCheckDownloadOverExpensive]);

              v60 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOverCellular:](v99, "setAllowCheckDownloadOverCellular:", [v60 allowCheckDownloadOverCellular]);

              v61 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setBlockCheckDownload:](v99, "setBlockCheckDownload:", [v61 blockCheckDownload]);
            }

            v67 = [MADAutoAssetJob alloc];
            v68 = [v31 copy];
            v69 = [v98 atomicInstance];
            v28 = [(MADAutoAssetJob *)v67 initForSetInstance:v98 withLifetimeOSTransaction:v95 withSchedulerSetPolicy:v99 usingSetConfiguration:v68 usingSetDescriptor:v96 withAutoAssetUUID:v69];

            if (v28)
            {
              v70 = [v31 clientDomainName];
              v71 = [v31 assetSetIdentifier];
              v72 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v70 forAssetSetIdentifier:v71];

              v73 = [v97 atomicInstanceUUID];
              [(MADAutoAssetControlManager *)self addToCurrentJobs:v28 usingSelector:0 withJobUUID:v73 triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:v96 fromLocation:@"action_ScheduleSetJobs"];

              v74 = [v97 atomicInstanceUUID];
              LOBYTE(v90) = 0;
              BYTE2(v89) = 0;
              LOWORD(v89) = 0;
              [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v96 forLatestDownloaded:@"ScheduleSetJobs" forSpecificAtomicInstance:0 withCurrentSetStatus:v74 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v89 latestToVend:353 historyOperation:@"com.apple.MobileAsset.daemon.internal" firstClientName:v90 fromPreSUStaging:?];

              [(MADAutoAssetControlManager *)self _statsIncrementSchedulerTriggeredJobs];
              v75 = [(MADAutoAssetControlManager *)self jobControlInformationForSetJobKey:v72];
              [v28 startScheduleTriggeredSetJob:v75];

              v76 = [v96 assetSetIdentifier];
              [v93 addObject:v76];

              ++v94;
            }

            else
            {
              v77 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v92 = [v77 diag];
              v78 = [NSString alloc];
              v79 = [v11 summary];
              v80 = [v78 initWithFormat:@"unable to allocate scheduler-triggered autoAssetJob | schedulerTriggered:%@", v79];
              [v92 trackAnomaly:@"AUTO-CONTROL" forReason:v80 withResult:6101 withError:0];

              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            }
          }

          else
          {
            v62 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v63 = [v62 diag];
            v64 = [NSString alloc];
            v65 = [v11 summary];
            v66 = [v64 initWithFormat:@"unable to locate set-configuration for scheduler-triggered autoAssetJob | schedulerTriggered:%@", v65];
            [v63 trackAnomaly:@"AUTO-CONTROL" forReason:v66 withResult:6101 withError:0];

            [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            v28 = 0;
          }
        }
      }

      else
      {
        v28 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
        {
          v35 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v36 = [v11 summary];
          *buf = 138543618;
          v109 = v35;
          v110 = 2114;
          v111 = v36;
          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} no auto-asset-entries (so not scheuling set-job) | schedulerTriggered:%{public}@", buf, 0x16u);
        }
      }

      objc_autoreleasePoolPop(v22);
    }

    v9 = [obj countByEnumeratingWithState:&v103 objects:v112 count:16];
  }

  while (v9);

  if (v94 > 0)
  {
    v81 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v81, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 134217984;
      v109 = v94;
      _os_log_impl(&dword_0, v81, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] set job(s) started | setScheduledJobsTriggered:%ld", buf, 0xCu);
    }

    [MADAutoAssetHistory recordOperation:1401 toHistoryType:5 fromLayer:1 usageCount:v94];
    if (+[MAAIRBEventReporter isAvailable])
    {
      v82 = [MAAIRBMobileAssetOperationMetadata alloc];
      v83 = [MADAutoAssetHistoryTracker operationName:1401];
      v84 = [(MAAIRBMobileAssetOperationMetadata *)v82 initWithCode:1401 name:v83];

      v85 = [MAAIRBUtilities createMAAIRBAssetSets:v93];
      v86 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeScheduler:v84 numJobsTriggered:v94 assetSets:v85];
      v87 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v86];
      [MAAIRBEventReporter emitAppleIntelligenceEvent:v87];

      goto LABEL_48;
    }

    goto LABEL_49;
  }

LABEL_46:
  v84 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v84, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no set jobs started", buf, 2u);
  }

LABEL_48:

LABEL_49:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_DecrementTickDriven:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecrementTickDriven", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _schedulerTickOccurred:v10.opaque[0]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_IgnorePushNotifications:(id)a3 error:(id *)a4
{
  v32 = a3;
  v33 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:IgnorePushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  v8 = [v32 pushNotifications];
  v9 = [v8 countByEnumeratingWithState:&v35 objects:v46 count:16];
  if (v9)
  {
    v10 = *v36;
    obj = v8;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v36 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v35 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        v14 = [v12 assetType];
        if (!v14 || ([v12 assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = v15 == 0, v15, v14, v16))
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v22 = [(MADAutoAssetControlManager *)v33 _updateLatestSummary];
            v23 = [v12 summary];
            *buf = 138543618;
            v41 = v22;
            v42 = 2114;
            v43 = v23;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} missing required asset-selector information (ignored) | pushNotification:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v17 = [v12 assetVersion];
          v18 = v17 == 0;

          if (v18)
          {
            v24 = [MAAutoAssetSelector alloc];
            v25 = [v12 assetType];
            v26 = [v12 assetSpecifier];
            v19 = [v24 initForAssetType:v25 withAssetSpecifier:v26];

            v27 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
            {
              v28 = [(MADAutoAssetControlManager *)v33 _updateLatestSummary];
              v29 = [v19 summary];
              v30 = [v12 summary];
              *buf = 138543874;
              v41 = v28;
              v42 = 2114;
              v43 = v29;
              v44 = 2114;
              v45 = v30;
              _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} ignoring too-early push | autoAssetSelector:%{public}@ | pushNotification:%{public}@", buf, 0x20u);
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              v20 = [(MADAutoAssetControlManager *)v33 _updateLatestSummary];
              v21 = [v12 summary];
              *buf = 138543618;
              v41 = v20;
              v42 = 2114;
              v43 = v21;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} asset-version specified (not applicable to scheduling - ignored) | pushNotification:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v13);
      }

      v8 = obj;
      v9 = [obj countByEnumeratingWithState:&v35 objects:v46 count:16];
    }

    while (v9);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_HandlePushNotifications:(id)a3 error:(id *)a4
{
  v41 = a3;
  v43 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:HandlePushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v42 = objc_alloc_init(NSMutableDictionary);
  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v8 = [v41 pushNotifications];
  v9 = [v8 countByEnumeratingWithState:&v46 objects:v57 count:16];
  if (v9)
  {
    v45 = *v47;
    obj = v8;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v47 != v45)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v46 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        v13 = [v11 autoUpdatePolicy];
        v14 = [v11 assetType];
        if (!v14 || ([v11 assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = v15 == 0, v15, v14, v16))
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v22 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
            v23 = [v11 summary];
            *buf = 138543618;
            v52 = v22;
            v53 = 2114;
            v54 = v23;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} missing required asset-selector information (ignored) | pushNotification:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v17 = [v11 assetVersion];
          v18 = v17 == 0;

          if (v18)
          {
            v24 = [MAAutoAssetSelector alloc];
            v25 = [v11 assetType];
            v26 = [v11 assetSpecifier];
            v19 = [v24 initForAssetType:v25 withAssetSpecifier:v26];

            v27 = [v19 persistedEntryID];
            v28 = [v42 safeObjectForKey:v27 ofClass:objc_opt_class()];
            LOBYTE(v25) = v28 == 0;

            if (v25)
            {
              [v42 setSafeObject:v13 forKey:v27];
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
              {
                v32 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
                v33 = [v19 summary];
                v34 = [v11 summary];
                *buf = 138543874;
                v52 = v32;
                v53 = 2114;
                v54 = v33;
                v55 = 2114;
                v56 = v34;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} requesting push | autoAssetSelector:%{public}@ | pushNotification:%{public}@", buf, 0x20u);
              }
            }

            else
            {
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
              {
                v30 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
                v31 = [v11 summary];
                *buf = 138543618;
                v52 = v30;
                v53 = 2114;
                v54 = v31;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} asset-selector repeated (ignoring additional entry) | pushNotification:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              v20 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
              v21 = [v11 summary];
              *buf = 138543618;
              v52 = v20;
              v53 = 2114;
              v54 = v21;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} asset-version specified (not applicable to scheduling - ignored) | pushNotification:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v12);
      }

      v8 = obj;
      v9 = [obj countByEnumeratingWithState:&v46 objects:v57 count:16];
    }

    while (v9);
  }

  if ([v42 count])
  {
    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      v36 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
      v37 = [v42 count];
      *buf = 138543618;
      v52 = v36;
      v53 = 2048;
      v54 = v37;
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} scheduling push jobs | pushNotificationsBySelector:%ld", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)v43 _schedulePushNotifications:v42];
  }

  else
  {
    v38 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
    {
      v39 = [(MADAutoAssetControlManager *)v43 _updateLatestSummary];
      *buf = 138543362;
      v52 = v39;
      _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} push-notification resulted in 0 push jobs", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ClearInProgressSecure:(id)a3 error:(id *)a4
{
  v35 = a3;
  v38 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ClearInProgressSecure", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v37 = [v35 setDescriptor];
  v36 = [v35 autoAssetDescriptors];
  if (v36)
  {
    v41 = 0u;
    v42 = 0u;
    v39 = 0u;
    v40 = 0u;
    v8 = v36;
    v9 = [v8 countByEnumeratingWithState:&v39 objects:v44 count:16];
    if (v9)
    {
      v10 = *v40;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v40 != v10)
          {
            objc_enumerationMutation(v8);
          }

          v12 = *(*(&v39 + 1) + 8 * i);
          if ([v12 secureOperationInProgress])
          {
            [v12 setSecureOperationInProgress:0];
            if ([v12 secureOperationEliminating])
            {
              v13 = [MAAutoAssetSelector alloc];
              v14 = [v12 assetType];
              v15 = [v12 assetSpecifier];
              v16 = [v12 assetVersion];
              v17 = [v13 initForAssetType:v14 withAssetSpecifier:v15 matchingAssetVersion:v16];

              v18 = [(MADAutoAssetControlManager *)v38 eliminateTrackerForSelector:v17];
              if (v18)
              {
                [(MADAutoAssetControlManager *)v38 _eliminateSecureOperationFinished:v18 forEliminateDescriptor:v12];
              }

              else
              {
                v19 = [(MADAutoAssetControlManager *)v38 autoControlManagerFSM];
                v20 = [v19 diag];
                v21 = [NSString alloc];
                v22 = [v12 summary];
                v23 = [v21 initWithFormat:@"{ClearInProgressSecure} no eliminateTracker | nextAssetDescriptor:%@", v22];
                [v20 trackAnomaly:@"ELIMINATE|AUTO-SECURE" forReason:v23 withResult:6111 withError:0];
              }
            }
          }
        }

        v9 = [v8 countByEnumeratingWithState:&v39 objects:v44 count:16];
      }

      while (v9);
    }
  }

  if (v37)
  {
    if ([v37 secureOperationInProgress])
    {
      [v37 setSecureOperationInProgress:0];
      if ([v37 secureOperationEliminating])
      {
        v24 = [MAAutoAssetSelector alloc];
        v25 = [v37 clientDomainName];
        v26 = [v37 assetSetIdentifier];
        v27 = [v24 initForAssetType:v25 withAssetSpecifier:v26];

        v28 = [(MADAutoAssetControlManager *)v38 eliminateTrackerForSelector:v27];
        if (v28)
        {
          [(MADAutoAssetControlManager *)v38 _eliminateSecureOperationFinished:v28 forEliminateSetDescriptor:v37];
        }

        else
        {
          v29 = [(MADAutoAssetControlManager *)v38 autoControlManagerFSM];
          v30 = [v29 diag];
          v31 = [NSString alloc];
          v32 = [v37 summary];
          v33 = [v31 initWithFormat:@"{ClearInProgressSecure} no eliminateTracker | setDescriptor:%@", v32];
          [v30 trackAnomaly:@"SET-ELIMINATE|AUTO-SECURE" forReason:v33 withResult:6111 withError:0];
        }
      }
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_DecideNeedPersonalize:(id)a3 error:(id *)a4
{
  v99 = a3;
  v112 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecideNeedPersonalize", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)v112 trackPerformancePhaseBegin:@"DecideNeedPersonalize"];
  v9 = [(MADAutoAssetControlManager *)v112 persistedKnownDescriptors];
  v96 = [v9 persistedEntryIDs:@"DecideNeedPersonalize"];

  v98 = objc_alloc_init(NSMutableDictionary);
  v100 = objc_alloc_init(NSMutableDictionary);
  v111 = objc_alloc_init(NSMutableDictionary);
  v97 = objc_alloc_init(NSMutableDictionary);
  if ([v96 count])
  {
    v10 = +[MADAutoAssetLocker copyOfLockCountsBySelector];
    [(MADAutoAssetControlManager *)v112 setLocksPriorToSecureHealing:v10];

    [(MADAutoAssetControlManager *)v112 trackPerformanceIteration:@"DecideNeedPersonalize" ofContainer:@"copyOfLockCountsBySelector"];
    v127 = 0u;
    v128 = 0u;
    v125 = 0u;
    v126 = 0u;
    obj = v96;
    v11 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
    if (v11)
    {
      v104 = *v126;
      do
      {
        v12 = 0;
        v107 = v11;
        do
        {
          if (*v126 != v104)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v125 + 1) + 8 * v12);
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)v112 persistedKnownDescriptors];
          v16 = [v15 persistedEntry:v13 fromLocation:@"DecideNeedPersonalize"];

          if (v16)
          {
            v17 = [(MADAutoAssetControlManager *)v112 persistedKnownDescriptors];
            v18 = [v17 decodeFromLocation:@"DecideNeedPersonalize" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              if ([v18 foundAsPreInstalled])
              {
                [(MADAutoAssetControlManager *)v112 _preinstalledTrackBySelector:v18];
              }

              if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"DecideNeedPersonalize" forDescriptor:v18])
              {
                v19 = [(MADAutoAssetControlManager *)v112 setConfigurationForDescriptorIfManagedAsSet:v18];

                v4 = [MADAutoAssetSecure isPersonalizationRequired:@"DecideNeedPersonalize" forDescriptor:v18];
                v20 = [MAAutoAssetSelector alloc];
                v21 = [v18 assetType];
                v22 = [v18 assetSpecifier];
                v23 = [v18 assetVersion];
                v24 = [v20 initForAssetType:v21 withAssetSpecifier:v22 matchingAssetVersion:v23];

                v25 = [v24 persistedEntryID];
                if (v4)
                {
                  if (v19)
                  {
                    [v100 setSafeObject:v18 forKey:v25];
                    v26 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                    {
                      v27 = [v18 summary];
                      *buf = 138543362;
                      v133 = v27;
                      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} candidate for personalization [managed as set] | downloadedDescriptor:%{public}@", buf, 0xCu);
                    }
                  }

                  else
                  {
                    [v98 setSafeObject:v18 forKey:v25];
                    v26 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                    {
                      v29 = [v18 summary];
                      *buf = 138543362;
                      v133 = v29;
                      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} candidate for personalization [singleton] | downloadedDescriptor:%{public}@", buf, 0xCu);
                    }
                  }

                  goto LABEL_24;
                }

                if ([(MADAutoAssetControlManager *)v112 isDescriptorCurrentlyLocked:@"DecideNeedPersonalize" forDescriptor:v18]&& ![MADAutoAssetSecure isGraftedOrMounted:@"DecideNeedPersonalize" forDescriptor:v18])
                {
                  [v97 setSafeObject:v18 forKey:v25];
                  v26 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                  {
                    v28 = [v18 summary];
                    *buf = 138543362;
                    v133 = v28;
                    _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-GRAFT][STARTUP] {DecideNeedPersonalize} will graft|mount (once startup personalization completes) | downloadedDescriptor:%{public}@", buf, 0xCu);
                  }

LABEL_24:
                }
              }
            }
          }

          else
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v133 = v13;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} unable to determine previous status | entryID:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v14);
          v12 = v12 + 1;
        }

        while (v107 != v12);
        v11 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
      }

      while (v11);
    }

    if (![v98 count] && !objc_msgSend(v100, "count"))
    {
      goto LABEL_75;
    }

    v123 = 0u;
    v124 = 0u;
    v121 = 0u;
    v122 = 0u;
    v108 = v98;
    v30 = [v108 countByEnumeratingWithState:&v121 objects:v136 count:16];
    if (!v30)
    {
      goto LABEL_50;
    }

    obja = *v122;
LABEL_32:
    v105 = v30;
    v31 = 0;
    while (1)
    {
      if (*v122 != obja)
      {
        objc_enumerationMutation(v108);
      }

      v32 = [v108 safeObjectForKey:*(*(&v121 + 1) + 8 * v31) ofClass:objc_opt_class()];
      if (!v32)
      {
        goto LABEL_48;
      }

      v33 = [MAAutoAssetSelector alloc];
      v34 = [v32 assetType];
      v35 = [v32 assetSpecifier];
      v36 = [v33 initForAssetType:v34 withAssetSpecifier:v35];

      v37 = [v36 persistedEntryID];
      v4 = [v111 safeObjectForKey:v37 ofClass:objc_opt_class()];
      if (!v4)
      {
        [v111 setSafeObject:v32 forKey:v37];
        v40 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
        {
          v46 = [v32 summary];
          *buf = 138543362;
          v133 = v46;
          _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] first candidate for selector | nextAssetDescriptor:%{public}@", buf, 0xCu);
        }

        goto LABEL_47;
      }

      v38 = [SUCoreRestoreVersion alloc];
      v39 = [v32 assetVersion];
      v40 = [v38 initWithRestoreVersion:v39];

      v41 = [SUCoreRestoreVersion alloc];
      v42 = [v4 assetVersion];
      v43 = [v41 initWithRestoreVersion:v42];

      if (![v40 isComparable:v43])
      {
        break;
      }

      if ([v40 compare:v43]== &dword_0 + 1)
      {
        [v111 setSafeObject:v32 forKey:v37];
        v44 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
        {
          v45 = [v32 summary];
          *buf = 138543362;
          v133 = v45;
          _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] better candidate for selector | nextAssetDescriptor:%{public}@", buf, 0xCu);
        }

LABEL_45:
      }

LABEL_47:
LABEL_48:

      if (v105 == ++v31)
      {
        v30 = [v108 countByEnumeratingWithState:&v121 objects:v136 count:16];
        if (!v30)
        {
LABEL_50:

          if ([v100 count])
          {
            v119 = 0u;
            v120 = 0u;
            v117 = 0u;
            v118 = 0u;
            v49 = [(MADAutoAssetControlManager *)v112 knownSetConfigurationsByIdentifier];
            v50 = [v49 allKeys];
            v109 = [v50 copy];

            v51 = [v109 countByEnumeratingWithState:&v117 objects:v131 count:16];
            if (v51)
            {
              v52 = *v118;
              do
              {
                for (i = 0; i != v51; i = i + 1)
                {
                  if (*v118 != v52)
                  {
                    objc_enumerationMutation(v109);
                  }

                  v54 = *(*(&v117 + 1) + 8 * i);
                  v55 = objc_autoreleasePoolPush();
                  v56 = [(MADAutoAssetControlManager *)v112 knownSetConfigurationsByIdentifier];
                  v57 = [v56 safeObjectForKey:v54 ofClass:objc_opt_class()];

                  if (v57)
                  {
                    if ([(MADAutoAssetControlManager *)v112 _acceptPersonalizationFromPSUSToBecomeLatestToVend:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      v4 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
                      {
                        v58 = [v57 summary];
                        *buf = 138543362;
                        v133 = v58;
                        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide newer set atomic-instance | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else if ([(MADAutoAssetControlManager *)v112 _acceptPersonalizationToProvideLatestToVend:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      v4 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
                      {
                        v59 = [v57 summary];
                        *buf = 138543362;
                        v133 = v59;
                        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide latest-to-vend | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else if ([(MADAutoAssetControlManager *)v112 _acceptPersonalizationToProvidePreinstalled:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      v4 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
                      {
                        v60 = [v57 summary];
                        *buf = 138543362;
                        v133 = v60;
                        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide pre-installed | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else
                    {
                      v4 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
                      {
                        v61 = [v57 summary];
                        *buf = 138543362;
                        v133 = v61;
                        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] no startup personalization to be performed | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }
                  }

                  objc_autoreleasePoolPop(v55);
                }

                v51 = [v109 countByEnumeratingWithState:&v117 objects:v131 count:16];
              }

              while (v51);
            }

            goto LABEL_74;
          }

          goto LABEL_75;
        }

        goto LABEL_32;
      }
    }

    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
    {
      v47 = [v32 summary];
      v48 = [v4 summary];
      *buf = 138543618;
      v133 = v47;
      v134 = 2114;
      v135 = v48;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] asset-versions not comparable | left(nextAssetDescriptor):%{public}@ | right(latestAssetDesctiptor):%{public}@", buf, 0x16u);
    }

    goto LABEL_45;
  }

  v62 = _MADLog(@"AutoControl");
  v109 = v62;
  if (os_log_type_enabled(v62, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v62, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} no persisted known-descriptors", buf, 2u);
  }

LABEL_74:

LABEL_75:
  if ([v111 count] || objc_msgSend(v97, "count"))
  {
    [(MADAutoAssetControlManager *)v112 secureStartupEstablishOperationSequence:@"DecideNeedPersonalize" forRequiringPersonalization:v111 forRequiringGrafting:v97];
    if ([v111 count])
    {
      [(MADAutoAssetControlManager *)v112 setSecureHealingPersonalizationAttempted:1];
      v63 = @"HaveNeedingPersonalize";
    }

    else
    {
      v64 = [(MADAutoAssetControlManager *)v112 prePersonalizedSelectors];
      v65 = [v64 count] == 0;

      if (!v65)
      {
        v66 = [(MADAutoAssetControlManager *)v112 prePersonalizedSelectors];
        v67 = [MADAutoAssetSecure commitPrePersonalizedSync:@"DecideNeedPersonalize" committingSelectors:v66];

        if (v67)
        {
          v68 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v68, OS_LOG_TYPE_ERROR))
          {
            v69 = [v67 checkedDescription];
            v70 = [(MADAutoAssetControlManager *)v112 prePersonalizedSelectors];
            v71 = [v70 count];
            *buf = 138543618;
            v133 = v69;
            v134 = 2048;
            v135 = v71;
            _os_log_impl(&dword_0, v68, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedPersonalize} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x16u);
          }
        }

        else
        {
          v68 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
          {
            v72 = [(MADAutoAssetControlManager *)v112 prePersonalizedSelectors];
            v73 = [v72 count];
            *buf = 134217984;
            v133 = v73;
            _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedPersonalize} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0xCu);
          }
        }

        v74 = objc_alloc_init(NSMutableArray);
        [(MADAutoAssetControlManager *)v112 setPrePersonalizedSelectors:v74];

        v115 = 0u;
        v116 = 0u;
        v113 = 0u;
        v114 = 0u;
        v75 = [(MADAutoAssetControlManager *)v112 prePersonalizedSelectors];
        v76 = [v75 countByEnumeratingWithState:&v113 objects:v130 count:16];
        if (v76)
        {
          objb = v75;
          v106 = *v114;
          do
          {
            v110 = v76;
            for (j = 0; j != v110; j = j + 1)
            {
              if (*v114 != v106)
              {
                objc_enumerationMutation(objb);
              }

              v78 = *(*(&v113 + 1) + 8 * j);
              v79 = getControlManager();
              v80 = [v79 analytics];
              v81 = [v78 assetSpecifier];
              v82 = [v78 assetType];
              v83 = [v78 assetVersion];
              v84 = [v99 clientID];
              if (v67)
              {
                v4 = [v67 checkedDescription];
                v85 = v4;
              }

              else
              {
                v85 = 0;
              }

              LOBYTE(v95) = 0;
              LOBYTE(v94) = 0;
              LOBYTE(v93) = 0;
              LOBYTE(v92) = v67 == 0;
              v86 = [v80 recordMobileAssetSecureAttempt:v81 assetType:v82 assetVersion:v83 clientName:v84 operation:9 secureReason:@"attempting to commit pre personalized descriptors" fromLocation:@"DecideNeedPersonalize" sucessfullyPersonalized:v92 personalizeFailureReason:v85 sucessfullyMounted:v93 mountingFailureReason:0 successfullyGrafted:v94 graftingFailureReason:0 successfullyMappedToExclave:v95 mapToExclaveFailureReason:0];
              if (v67)
              {
              }
            }

            v75 = objb;
            v76 = [objb countByEnumeratingWithState:&v113 objects:v130 count:16];
          }

          while (v76);
        }
      }

      [(MADAutoAssetControlManager *)v112 considerDownloadedWithPSUSLookupResultsForLatestToVend];
      v87 = [(MADAutoAssetControlManager *)v112 descriptorsRequiringGrafting];
      v88 = [v87 count] == 0;

      if (v88)
      {
        v63 = @"NoneNeedingPersonalize";
      }

      else
      {
        v63 = @"HaveNeedingGraft";
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)v112 considerDownloadedWithPSUSLookupResultsForLatestToVend];
    v63 = @"NoneNeedingPersonalize";
  }

  v89 = [(MADAutoAssetControlManager *)v112 autoControlManagerFSM];
  v90 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"DecideNeedPersonalize"];
  [v89 followupEvent:v63 withInfo:v90];

  [(MADAutoAssetControlManager *)v112 trackPerformancePhaseEnd:@"DecideNeedPersonalize"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_DecideNeedGraft:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v26.opaque[0] = 0;
  v26.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecideNeedGraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v26);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"DecideNeedGraft", v26.opaque[0], v26.opaque[1]];
  v9 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"DecideNeedGraft" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v10 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v11 = [v10 count] == 0;

  if (!v11)
  {
    v12 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
    v13 = [MADAutoAssetSecure commitPrePersonalizedSync:@"DecideNeedGraft" committingSelectors:v12];

    if (v13)
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [v13 checkedDescription];
        v16 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
        v17 = [v16 count];
        *buf = 138543618;
        v28 = v15;
        v29 = 2048;
        v30 = v17;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedGraft} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x16u);
      }
    }

    else
    {
      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        v19 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
        v20 = [v19 count];
        *buf = 134217984;
        v28 = v20;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedGraft} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0xCu);
      }

      [(MADAutoAssetControlManager *)self setConfigurationsPrePersonalizedJustCommitted:@"DecideNeedGraft"];
    }

    v21 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self setPrePersonalizedSelectors:v21];
  }

  [(MADAutoAssetControlManager *)self considerDownloadedWithPSUSLookupResultsForLatestToVend];
  v22 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v23 = [v22 count] == 0;

  v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  if (v23)
  {
    [v24 followupEvent:@"NoneNeedingGraft" withInfo:v9];
  }

  else
  {
    [v24 followupEvent:@"HaveNeedingGraft" withInfo:v9];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"DecideNeedGraft"];
  os_activity_scope_leave(&v26);

  return 0;
}

- (int64_t)action_AttemptNextPersonalize:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:AttemptNextPersonalize", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"AttemptNextPersonalize"];
  v9 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v10 = [v9 count];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    v12 = [v11 objectAtIndex:0];

    v13 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    [v13 removeObjectAtIndex:0];

    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __66__MADAutoAssetControlManager_action_AttemptNextPersonalize_error___block_invoke;
    v17[3] = &unk_4B46A8;
    v14 = v12;
    v18 = v14;
    v19 = self;
    [MADAutoAssetSecure personalizeDownloaded:@"AttemptNextPersonalize" personalizingDescriptor:v14 allowingNetwork:1 committingPersonalization:0 completion:v17];
    v15 = v18;
  }

  else
  {
    v14 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:0];
    v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v15 postEvent:@"NoneNeedingPersonalize" withInfo:v14];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"AttemptNextPersonalize"];
  os_activity_scope_leave(&state);

  return 0;
}

void __66__MADAutoAssetControlManager_action_AttemptNextPersonalize_error___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v9 = objc_alloc_init(NSMutableArray);
  if (*(a1 + 32))
  {
    [v9 addObject:?];
  }

  v5 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:v9 withError:v4];

  v6 = [*(a1 + 40) autoControlManagerFSM];
  v7 = v6;
  if (v4)
  {
    v8 = @"StartupPersonalizeFailed";
  }

  else
  {
    v8 = @"StartupPersonalizeSuccess";
  }

  [v6 postEvent:v8 withInfo:v5];
}

- (int64_t)action_AttemptNextGraft:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:AttemptNextGraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"AttemptNextGraft"];
  v9 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v10 = [v9 count];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v12 = [v11 objectAtIndex:0];

    v13 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    [v13 removeObjectAtIndex:0];

    v14 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v12];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __60__MADAutoAssetControlManager_action_AttemptNextGraft_error___block_invoke;
    v17[3] = &unk_4B46A8;
    v15 = v12;
    v18 = v15;
    v19 = self;
    [MADAutoAssetSecure graftDownloaded:@"AttemptNextGraft" graftingDescriptor:v15 setDescriptor:v14 completion:v17];
  }

  else
  {
    v15 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:0];
    v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v14 postEvent:@"NoneNeedingGraft" withInfo:v15];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"AttemptNextGraft"];
  os_activity_scope_leave(&state);

  return 0;
}

void __60__MADAutoAssetControlManager_action_AttemptNextGraft_error___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v9 = objc_alloc_init(NSMutableArray);
  if (*(a1 + 32))
  {
    [v9 addObject:?];
  }

  v5 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextGraft" forSetDescriptor:0 forAutoAssetDescriptors:v9 withError:v4];

  v6 = [*(a1 + 40) autoControlManagerFSM];
  v7 = v6;
  if (v4)
  {
    v8 = @"StartupGraftFailed";
  }

  else
  {
    v8 = @"StartupGraftSuccess";
  }

  [v6 postEvent:v8 withInfo:v5];
}

- (int64_t)action_PersonalizeSuccessDecideMore:(id)a3 error:(id *)a4
{
  v30 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:PersonalizeSuccessDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"PersonalizeSuccessDecideMore"];
  v29 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"PersonalizeSuccessDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  v8 = [v30 autoAssetDescriptors];
  v9 = [v8 countByEnumeratingWithState:&v32 objects:v39 count:16];
  if (v9)
  {
    v10 = *v33;
    obj = v8;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v33 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v32 + 1) + 8 * i);
        if (v12)
        {
          v13 = [MAAutoAssetSelector alloc];
          v14 = [v12 assetType];
          v15 = [v12 assetSpecifier];
          v16 = [v12 assetVersion];
          v17 = [v13 initForAssetType:v14 withAssetSpecifier:v15 matchingAssetVersion:v16];

          if (v17)
          {
            v18 = [v17 persistedEntryID];
            v19 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
            v20 = [v19 safeObjectForKey:v18 ofClass:objc_opt_class()];

            v21 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
            [v21 addObject:v17];

            if (v20 && [v20 longValue] > 0)
            {
              v22 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
              [v22 addObject:v12];

              v23 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
              {
                v24 = [v12 summary];
                *buf = 138543362;
                v38 = v24;
                _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeSuccessDecideMore} pre-personalization SUCCESS (will graft|mount) | nextPrePersonalizedDescriptor:%{public}@", buf, 0xCu);
              }
            }

            else
            {
              v23 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
              {
                v25 = [v12 summary];
                *buf = 138543362;
                v38 = v25;
                _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeSuccessDecideMore} pre-personalization SUCCESS (not locked) | nextPrePersonalizedDescriptor:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v20 = [v18 diag];
            v26 = [NSString alloc];
            v23 = [v12 summary];
            v27 = [v26 initWithFormat:@"{PersonalizeSuccessDecideMore} | unable to initialize asset-selector | nextPrePersonalizedDescriptor:%@", v23];
            [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];
          }
        }
      }

      v8 = obj;
      v9 = [obj countByEnumeratingWithState:&v32 objects:v39 count:16];
    }

    while (v9);
  }

  [(MADAutoAssetControlManager *)self assetPersonalizatonAttemptCompletePostEvent:@"PersonalizeSuccessDecideMore" withControlParam:v29];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"PersonalizeSuccessDecideMore"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_PersonalizeFailureDecideMore:(id)a3 error:(id *)a4
{
  v5 = a3;
  v20 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PersonalizeFailureDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)v20 trackPerformancePhaseBegin:@"PersonalizeFailureDecideMore"];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"PersonalizeFailureDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v9 = [v5 autoAssetDescriptors];
  v10 = [v9 countByEnumeratingWithState:&v21 objects:v30 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(v9);
        }

        v13 = *(*(&v21 + 1) + 8 * i);
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          v15 = [v5 finishedError];
          v16 = [v15 checkedDescription];
          v17 = [v13 summary];
          *buf = 138543618;
          v27 = v16;
          v28 = 2114;
          v29 = v17;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeFailureDecideMore} pre-personalization ERROR | error:%{public}@ | failedPrePersonalizeDescriptor:%{public}@", buf, 0x16u);
        }
      }

      v10 = [v9 countByEnumeratingWithState:&v21 objects:v30 count:16];
    }

    while (v10);
  }

  [(MADAutoAssetControlManager *)v20 assetPersonalizatonAttemptCompletePostEvent:@"PersonalizeSuccessDecideMore" withControlParam:v19];
  [(MADAutoAssetControlManager *)v20 trackPerformancePhaseEnd:@"PersonalizeFailureDecideMore"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_GraftSuccessDecideMore:(id)a3 error:(id *)a4
{
  v20 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:GraftSuccessDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"GraftSuccessDecideMore"];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"GraftSuccessDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v8 = [v20 autoAssetDescriptors];
  v9 = [v8 countByEnumeratingWithState:&v21 objects:v28 count:16];
  if (v9)
  {
    v10 = *v22;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v22 != v10)
        {
          objc_enumerationMutation(v8);
        }

        v12 = *(*(&v21 + 1) + 8 * i);
        v13 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
        {
          v14 = [v12 summary];
          *buf = 138543362;
          v27 = v14;
          _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][STARTUP] {GraftSuccessDecideMore} graft|mount SUCCESS | nextGraftedDescriptor:%{public}@", buf, 0xCu);
        }
      }

      v9 = [v8 countByEnumeratingWithState:&v21 objects:v28 count:16];
    }

    while (v9);
  }

  v15 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v16 = [v15 count] == 0;

  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  if (v16)
  {
    [v17 postEvent:@"NoneNeedingGraft" withInfo:v19];
  }

  else
  {
    [v17 postEvent:@"HaveNeedingGraft" withInfo:v19];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"GraftSuccessDecideMore"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_GraftFailureDecideMore:(id)a3 error:(id *)a4
{
  v5 = a3;
  v29 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:GraftFailureDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"GraftFailureDecideMore"];
  v28 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"GraftFailureDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  v9 = [v5 autoAssetDescriptors];
  v10 = [v9 countByEnumeratingWithState:&v30 objects:v39 count:16];
  if (v10)
  {
    v11 = *v31;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v31 != v11)
        {
          objc_enumerationMutation(v9);
        }

        v13 = *(*(&v30 + 1) + 8 * i);
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          v15 = [v5 finishedError];
          v16 = [v15 checkedDescription];
          v17 = [v13 summary];
          *buf = 138543618;
          v36 = v16;
          v37 = 2114;
          v38 = v17;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT][STARTUP] {GraftFailureDecideMore} graft|mount ERROR | error:%{public}@ | failedGraftDescriptor:%{public}@", buf, 0x16u);
        }

        v18 = [MAAutoAssetSelector alloc];
        v19 = [v13 assetType];
        v20 = [v13 assetSpecifier];
        v21 = [v13 assetVersion];
        v22 = [v18 initForAssetType:v19 withAssetSpecifier:v20 matchingAssetVersion:v21];

        v23 = [v5 finishedError];
        [(MADAutoAssetControlManager *)v29 forceGlobalUnlockFromLocation:@"GraftFailureDecideMore" dueToError:v23 fullAssetSelector:v22 historyOperationAI:1503 historyOperationSD:394];
      }

      v10 = [v9 countByEnumeratingWithState:&v30 objects:v39 count:16];
    }

    while (v10);
  }

  v24 = [(MADAutoAssetControlManager *)v29 descriptorsRequiringGrafting];
  v25 = [v24 count] == 0;

  v26 = [(MADAutoAssetControlManager *)v29 autoControlManagerFSM];
  if (v25)
  {
    [v26 postEvent:@"NoneNeedingGraft" withInfo:v28];
  }

  else
  {
    [v26 postEvent:@"HaveNeedingGraft" withInfo:v28];
  }

  [(MADAutoAssetControlManager *)v29 trackPerformancePhaseEnd:@"GraftFailureDecideMore"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_StagerAlreadyDownloaded:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerAlreadyDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  v9 = [(MADAutoAssetControlManager *)self _alreadyDownloadedDescriptorsArray:@"StagerAlreadyDownloaded" limitingToSupportingStaging:1, v14.opaque[0], v14.opaque[1]];
  v10 = [(MADAutoAssetControlManager *)self locateNewAllSetConfigurations];
  v11 = [(MADAutoAssetControlManager *)self locateNewAllSetTargets];
  v12 = +[MADAutoAssetScheduler jobsAwaitingTrigger];
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  [MADAutoAssetStager controlAlreadyDownloadedDescriptors:v9 withSetConfigurations:v10 withSetTargets:v11 withScheduledJobs:v12];

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_StagerJobStartDetermine:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobStartDetermine", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self stagerCurrentJob];

  if (v9)
  {
    v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v11 = [v10 diag];
    v12 = [NSString alloc];
    v13 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    if (v13)
    {
      v14 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    }

    else
    {
      v14 = @"N";
    }

    v15 = [v12 initWithFormat:@"{StagerStartJobDetermine} stager-job when already have a current stager-job - abandoning older stager-job with jobUUID:%@", v14];
    [v11 trackAnomaly:@"AUTO-CONTROL" forReason:v15 withResult:6109 withError:0];

    if (v13)
    {
    }

    [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
    [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
    [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  }

  v16 = +[NSUUID UUID];
  v17 = [v16 UUIDString];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:v17];

  v18 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  [(MADAutoAssetControlManager *)self osTransactionNameStagerDetermineJob:v18];
  v19 = os_transaction_create();

  v20 = [MADAutoAssetJob alloc];
  v21 = [v5 setConfiguration];
  v22 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  v23 = +[MADAutoAssetControlManager stagerSetPolicy];
  v24 = [(MADAutoAssetJob *)v20 initForSetConfiguration:v21 withLifetimeOSTransaction:v19 withAutoAssetUUID:v22 asStagerJob:1 withStagerSetPolicy:v23];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:v24];

  v25 = [(MADAutoAssetControlManager *)self stagerCurrentJob];

  if (v25)
  {
    [(MADAutoAssetControlManager *)self _statsIncrementStagerDetermineJobsStarted];
    v26 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    v27 = [v5 assetTargetOSVersion];
    v28 = [v5 assetTargetBuildVersion];
    v29 = [v5 assetTargetTrainName];
    v30 = [v5 assetTargetRestoreVersion];
    v31 = [v5 setConfiguration];
    v32 = [(MADAutoAssetControlManager *)self jobControlInformationForSetConfiguration:v31];
    [v26 startStagerDetermineIfAvailable:v27 withAssetTargetBuildVersion:v28 withAssetTargetTrainName:v29 withAssetTargetRestoreVersion:v30 withControlInformation:v32];
  }

  else
  {
    v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v34 = [v33 diag];
    v35 = [NSString alloc];
    v36 = [v5 autoAssetSelector];
    v37 = [v36 summary];
    v38 = [v35 initWithFormat:@"{StagerStartJobDetermine} unable to allocate stager-job for selector:%@", v37];
    [v34 trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6101 withError:0];

    v26 = [MAAutoAssetError buildError:6101 fromOperation:@"StagerJobStartDetermine" underlyingError:0 withDescription:@"unable to allocate stager-job"];
    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:v26];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_StagerJobStartDownload:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobStartDownload", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v5 autoAssetSelector];
  LODWORD(v7) = [(MADAutoAssetControlManager *)self isAutoAssetBeingEliminated:v9];

  if (v7)
  {
    v10 = [MAAutoAssetError buildError:6114 fromOperation:@"StagerJobStartDownload" underlyingError:0 withDescription:@"stager-job for auto-asset being eliminated"];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v12 = [v5 autoAssetSelector];
      v13 = [v12 summary];
      *buf = 138543362;
      v50 = v13;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{StagerJobStartDownload} [EliminationInProgress] stager-job for auto-asset being eliminated | selector:%{public}@", buf, 0xCu);
    }

    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:v10];
  }

  v14 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  v15 = v14 == 0;

  if (!v15)
  {
    v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v17 = [v16 diag];
    v18 = [NSString alloc];
    v19 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    if (v19)
    {
      v20 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    }

    else
    {
      v20 = @"N";
    }

    v21 = [v18 initWithFormat:@"{StagerStartJobDownload} stager-job when already have a current stager-job - abandoning older stager-job with jobUUID:%@", v20];
    [v17 trackAnomaly:@"AUTO-CONTROL" forReason:v21 withResult:6109 withError:0];

    if (v19)
    {
    }

    [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
    [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
    [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  }

  v22 = +[NSUUID UUID];
  v23 = [v22 UUIDString];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:v23];

  v24 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  [(MADAutoAssetControlManager *)self osTransactionNameStagerDownloadJob:v24];
  v25 = os_transaction_create();

  v26 = [MADAutoAssetJob alloc];
  v27 = [v5 autoAssetSelector];
  v28 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  v29 = +[MADAutoAssetControlManager stagerSetPolicy];
  v30 = [v5 autoAssetCatalog];
  v31 = [v5 baseForPatchDescriptor];
  v32 = [(MADAutoAssetJob *)v26 initForSelector:v27 withLifetimeOSTransaction:v25 withAutoAssetUUID:v28 asStagerJob:1 withStagerSetPolicy:v29 usingCachedAutoAssetCatalog:v30 usingBaseForPatching:v31];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:v32];

  v33 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  LODWORD(v27) = v33 == 0;

  if (v27)
  {
    v41 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v42 = [v41 diag];
    v43 = [NSString alloc];
    v44 = [v5 autoAssetSelector];
    v45 = [v44 summary];
    v46 = [v43 initWithFormat:@"{StagerStartJobDownload} unable to allocate stager-job for selector:%@", v45];
    [v42 trackAnomaly:@"AUTO-CONTROL" forReason:v46 withResult:6101 withError:0];

    v35 = [MAAutoAssetError buildError:6101 fromOperation:@"StagerJobStartDownload" underlyingError:0 withDescription:@"unable to allocate stager-job"];
    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:v35];
  }

  else
  {
    v34 = [v5 autoAssetSelector];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:v34];

    [(MADAutoAssetControlManager *)self _statsIncrementStagerDownloadJobsStarted];
    v35 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    v36 = [v5 assetTargetOSVersion];
    v37 = [v5 assetTargetBuildVersion];
    v38 = [v5 autoAssetCatalog];
    v39 = [v5 autoAssetSelector];
    v40 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v39];
    [v35 startStagerDownloadForStaging:v36 withAssetTargetBuildVersion:v37 usingCachedAutoAssetCatalog:v38 withControlInformation:v40];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_StagerJobDoneDetermine:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobDoneDetermine", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v13);

  [(MADAutoAssetControlManager *)self _statsIncrementStagerDetermineJobsFinished:v13.opaque[0]];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:0];
  [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
  [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
  [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  v9 = [v5 autoAssetCatalog];
  v10 = [v5 baseForStagingDescriptors];
  v11 = [v5 finishedError];
  [MADAutoAssetStager autoAssetStagerJobDetermineDone:v9 withBaseForStagingDescriptors:v10 withDetermineError:v11];

  os_activity_scope_leave(&v13);
  return 0;
}

- (int64_t)action_StagerJobDoneDownload:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobDoneDownload", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v13);

  [(MADAutoAssetControlManager *)self _statsIncrementStagerDownloadJobsFinished:v13.opaque[0]];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:0];
  [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
  [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
  [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  v9 = [v5 jobInformation];
  v10 = [v5 downloadingDescriptor];
  v11 = [v5 finishedError];
  [MADAutoAssetStager autoAssetStagerJobDownloadDone:v9 withDownloadedDescriptor:v10 withDownloadError:v11];

  os_activity_scope_leave(&v13);
  return 0;
}

- (int64_t)action_StagerJobCancel:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobCancel", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  v9 = [(MADAutoAssetControlManager *)self stagerCurrentJob:v14.opaque[0]];
  LODWORD(v8) = v9 == 0;

  if (v8)
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v16 = v12;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {StagerJobCancel} no stager-job - stale trigger to cancel from auto-asset-stager", buf, 0xCu);
    }
  }

  else
  {
    v10 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    [v10 setBeingCanceled:1];

    v11 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    [v11 cancelAutoAssetJob];
  }

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_StagerRemoveAllNotPromoted:(id)a3 error:(id *)a4
{
  v18 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:StagerRemoveAllNotPromoted", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v8 = [v18 autoAssetDescriptors];
  v9 = [v8 countByEnumeratingWithState:&v20 objects:v25 count:16];
  if (v9)
  {
    v10 = *v21;
    obj = v8;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v21 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v20 + 1) + 8 * i);
        v13 = [v12 assetType];
        v14 = [v12 assetSpecifier];
        v15 = [v12 assetVersion];
        v16 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"StagerRemoveAllNotPromoted" forAssetType:v13 withAssetSpecifier:v14 matchingAssetVersion:v15];

        if (!v16)
        {
          [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"StagerRemoveAllNotPromoted" droppingDescriptor:v12 forHistoryOperation:407 firstClientName:0];
        }
      }

      v8 = obj;
      v9 = [obj countByEnumeratingWithState:&v20 objects:v25 count:16];
    }

    while (v9);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateSchedulerDone:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateSchedulerDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v10 = [v5 autoAssetSelector];
  v11 = [v10 persistedEntryID];
  v12 = [v9 safeObjectForKey:v11 ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingSchedulerAck])
    {
      [v12 setAwaitingSchedulerAck:0];
    }

    else
    {
      v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v20 = [v19 diag];
      v21 = [NSString alloc];
      v22 = [v12 summary];
      v23 = [v21 initWithFormat:@"{EliminateSchedulerDone} duplicate scheduler indication for eliminateTracker:%@", v22];
      [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = [v13 diag];
    v15 = [NSString alloc];
    v16 = [v5 autoAssetSelector];
    v17 = [v16 summary];
    v18 = [v15 initWithFormat:@"{EliminateSchedulerDone} not tracking eliminate for autoAssetSelector:%@", v17];
    [v14 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateStagerDone:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateStagerDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v10 = [v5 autoAssetSelector];
  v11 = [v10 persistedEntryID];
  v12 = [v9 safeObjectForKey:v11 ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingStagerAck])
    {
      [v12 setAwaitingStagerAck:0];
    }

    else
    {
      v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v20 = [v19 diag];
      v21 = [NSString alloc];
      v22 = [v12 summary];
      v23 = [v21 initWithFormat:@"{EliminateStagerDone} duplicate stager indication for eliminateTracker:%@", v22];
      [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = [v13 diag];
    v15 = [NSString alloc];
    v16 = [v5 autoAssetSelector];
    v17 = [v16 summary];
    v18 = [v15 initWithFormat:@"{EliminateStagerDone} not tracking eliminate for autoAssetSelector:%@", v17];
    [v14 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateStagerSetDone:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateStagerSetDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [MAAutoAssetSelector alloc];
  v10 = [v5 setConfiguration];
  v11 = [v10 clientDomainName];
  v12 = [v5 setConfiguration];
  v13 = [v12 assetSetIdentifier];
  v14 = [v9 initForAssetType:v11 withAssetSpecifier:v13];

  v15 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v16 = [v14 persistedEntryID];
  v17 = [v15 safeObjectForKey:v16 ofClass:objc_opt_class()];

  if (v17)
  {
    if ([v17 awaitingStagerAck])
    {
      [v17 setAwaitingStagerAck:0];
    }

    else
    {
      v27 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v28 = [v27 diag];
      v29 = [NSString alloc];
      v30 = [v17 summary];
      v31 = [v29 initWithFormat:@"{EliminateStagerSetDone} duplicate stager indication for eliminateTracker:%@", v30];
      [v28 trackAnomaly:@"AUTO-CONTROL" forReason:v31 withResult:6109 withError:0];

      v32 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
      {
        v33 = [v17 summary];
        *buf = 138543362;
        v37 = v33;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{EliminateStagerSetDone} [TooManyEntries] duplicate stager indication for eliminateTracker:%{public}@", buf, 0xCu);
      }
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v17];
  }

  else
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v19 = [v18 diag];
    v20 = [NSString alloc];
    v21 = [v5 setConfiguration];
    v22 = [v21 summary];
    v23 = [v20 initWithFormat:@"{EliminateStagerSetDone} not tracking eliminate for setConfiguration:%@", v22];
    [v19 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6103 withError:0];

    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      v25 = [v5 setConfiguration];
      v26 = [v25 summary];
      *buf = 138543362;
      v37 = v26;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{EliminateStagerSetDone} [InvalidInstance] not tracking eliminate for setConfiguration:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_CancelActivityAck:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CancelActivityAck", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v10 = [v5 autoAssetSelector];
  v11 = [v10 persistedEntryID];
  v12 = [v9 safeObjectForKey:v11 ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingCancelActivityAck])
    {
      [v12 setAwaitingCancelActivityAck:0];
    }

    else
    {
      v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v20 = [v19 diag];
      v21 = [NSString alloc];
      v22 = [v12 summary];
      v23 = [v21 initWithFormat:@"{CancelActivityAck} duplicate cancel-activity-ack indication for eliminateTracker:%@", v22];
      [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = [v13 diag];
    v15 = [NSString alloc];
    v16 = [v5 autoAssetSelector];
    v17 = [v16 summary];
    v18 = [v15 initWithFormat:@"{CancelActivityAck} not tracking eliminate for autoAssetSelector:%@", v17];
    [v14 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)actionUnknownAction:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [[NSString alloc] initWithFormat:@"unknown action(%@)", v5];

  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 diag];
  [v8 dumpTracked:v6 dumpingTo:5 usingFilename:0 clearingStatistics:0 clearingHistory:0];

  return 0;
}

- (int64_t)action_InstallAssets:(id)a3 error:(id *)a4
{
  v5 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:InstallAssets", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  if (_MAPreferencesIsInternalAllowed())
  {
    v9 = [v5 downloadingDescriptor];
    [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v9 fromLocation:@"InstallAssets"];
  }

  os_activity_scope_leave(&v11);

  return 0;
}

- (BOOL)startupActivationIsFirstExecutionSinceBoot:(id)a3
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = +[NSFileManager defaultManager];
  if ([v5 fileExistsAtPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"])
  {
    v6 = +[MADAutoAssetControlManager preferenceStartupSimulateFirstBoot];
  }

  else
  {
    v6 = 1;
  }

  return v6;
}

- (void)startupActivationCompleted:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:startupActivationCompleted", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v8 = [(MADAutoAssetControlManager *)self _startupActivationProcessIdentifier];
  v9 = [(MADAutoAssetControlManager *)self startupActivationResourceSummary];
  v42 = [[NSString alloc] initWithFormat:@"{%@}%@%@", v4, v8, v9];
  v43 = [[MAAutoAssetSelector alloc] initForAssetType:v8 withAssetSpecifier:v9 matchingAssetVersion:@"3.0.4"];
  _MAPreferencesSetStringValue(@"persistedStateLoadingInProgress", 0, v4, @"Indicating that loading of persisted state is done");
  v41 = +[NSFileManager defaultManager];
  if ([(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:v4])
  {
    v10 = objc_alloc_init(NSMutableDictionary);
    [v10 setObject:&__kCFBooleanTrue forKeyedSubscript:@"ActivationStatus"];
    [(MADAutoAssetControlManager *)self setFirstDaemonStartupSinceDeviceBoot:1];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543618;
      v47 = v42;
      v48 = 2114;
      v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] Writing STARTUP_ACTIVATED cookie file [%{public}@]", buf, 0x16u);
    }

    v12 = [NSURL fileURLWithPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"];
    v44 = 0;
    [v10 writeToURL:v12 error:&v44];
    v13 = v44;

    if (v13)
    {
      [MADAutoAssetHistory recordFailedOperation:623 fromLayer:1 failingWithError:v13];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [v13 checkedDescription];
        *buf = 138543874;
        v47 = v42;
        v48 = 2114;
        v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
        v50 = 2112;
        v51 = v15;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "%{public}@\n[STARTUP-COMPLETED] Failed to write STARTUP_ACTIVATED cookie file [%{public}@] | stashError:%@", buf, 0x20u);
      }
    }

    else
    {
      if ([v41 fileExistsAtPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"])
      {
        [MADAutoAssetHistory recordOperation:622 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
        v13 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          v47 = v42;
          _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] Successfully wrote STARTUP_ACTIVATED cookie file", buf, 0xCu);
        }

        goto LABEL_16;
      }

      v13 = [MAAutoAssetError buildError:6101 fromOperation:v4 underlyingError:0 withDescription:@"failed post-write existence check after writing STARTUP_ACTIVATED cookie file (even though call to writeToURL was successful)"];
      [MADAutoAssetHistory recordFailedOperation:623 fromLayer:1 failingWithError:v13];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v16 = [v13 checkedDescription];
        *buf = 138543874;
        v47 = v42;
        v48 = 2114;
        v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
        v50 = 2112;
        v51 = v16;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "%{public}@\n[STARTUP-COMPLETED] Failed post-write existence check after writing STARTUP_ACTIVATED cookie file [%{public}@] | stashError:%@", buf, 0x20u);
      }
    }

LABEL_16:
    goto LABEL_17;
  }

  [MADAutoAssetHistory recordOperation:624 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v47 = v42;
    v48 = 2114;
    v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] STARTUP_ACTIVATED cookie file exists [%{public}@]", buf, 0x16u);
  }

LABEL_17:

  [MADAutoAssetHistory recordOperation:620 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
  [MADAutoAssetControlManager postNotificationName:@"STARTUP_ACTIVATED" forAssetType:@"com.apple.MobileAsset.MAAutoAsset" forAssetSpecifier:0 fromModule:@"AUTO-CONTROL" fromLocation:v4];
  if ([(MADAutoAssetControlManager *)self bootedSoftwareUpdate])
  {
    v17 = @"Psus";
  }

  else
  {
    v18 = isReboot();
    v17 = @"Restart";
    if (v18)
    {
      v17 = @"Reboot";
    }
  }

  v19 = v17;
  v20 = [(MADAutoAssetControlManager *)self startupPerfResults];
  v21 = v20 == 0;

  if (!v21)
  {
    v22 = [(MADAutoAssetControlManager *)self startupPerfResults];
    v23 = [v22 getPerfResults:0];

    if (v23)
    {
      v24 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        v25 = *__error();
        *buf = 67109120;
        LODWORD(v47) = v25;
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} startup libproc method failed for perf analysis, errno:%d", buf, 8u);
      }

      v26 = _MADLog(@"AutoControl");
      v27 = [(MADAutoAssetControlManager *)self startupSignpost];
      if (v27 - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v26))
      {
        v28 = mach_continuous_time();
        *buf = 134349056;
        v47 = v28;
        _os_signpost_emit_with_name_impl(&dword_0, v26, OS_SIGNPOST_INTERVAL_END, v27, "Startup", "%{public, signpost.description:end_time}llu  enableTelemetry=YES ", buf, 0xCu);
      }
    }

    else
    {
      v26 = _MADLog(@"AutoControl");
      v29 = [(MADAutoAssetControlManager *)self startupSignpost];
      if (v29 - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v26))
      {
        v40 = mach_continuous_time();
        v30 = [(MADAutoAssetControlManager *)self startupPerfResults];
        v39 = [v30 instructionsCount];
        v31 = [(MADAutoAssetControlManager *)self startupPerfResults];
        v32 = [v31 cyclesCount];
        v33 = v19;
        v34 = [(__CFString *)v19 UTF8String];
        *buf = 134349826;
        v47 = v40;
        v48 = 2050;
        v49 = v39;
        v50 = 2050;
        v51 = v32;
        v52 = 2082;
        v53 = v34;
        _os_signpost_emit_with_name_impl(&dword_0, v26, OS_SIGNPOST_INTERVAL_END, v29, "Startup", "%{public, signpost.description:end_time}llu instructions=%{public, signpost.telemetry:number1,name=instructions}lld cycles=%{public, signpost.telemetry:number2,name=cycles}lldstate=%{public, signpost.telemetry:string1,name=state}s enableTelemetry=YES ", buf, 0x2Au);
      }
    }

    [(MADAutoAssetControlManager *)self setStartupSignpost:0];
  }

  v35 = [(MADAutoAssetControlManager *)self startupTransaction];

  if (v35)
  {
    v36 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      v37 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v47 = v37;
      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ResumeJobs} ending startup transaction.", buf, 0xCu);
    }

    [(MADAutoAssetControlManager *)self setStartupTransaction:0];
  }

  v38 = +[MobileAssetHealthReport sharedInstance];
  [v38 scheduleReport];

  os_activity_scope_leave(&state);
}

- (id)_startupActivationProcessIdentifier
{
  v2 = [[NSString alloc] initWithFormat:@"(OS:%@[%@], pid:%ld)", self->_bootedOSVersion, self->_bootedOSBuildVersion, getpid()];
  if (!v2)
  {
    v2 = @"MA-PROCESS-IDENTIFIER";
  }

  return v2;
}

- (id)startupActivationResourceSummary
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v24 = [NSString alloc];
  [(MADAutoAssetControlManager *)self startupTimeDurationSeconds];
  v23 = v5;
  v26 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v21 = [v26 persistedEntryCount:@"startupActivationResourceSummary"];
  v25 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v20 = [v25 persistedEntryCount:@"startupActivationResourceSummary"];
  v22 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v19 = [v22 persistedEntryCount:@"startupActivationResourceSummary"];
  v18 = [(MADAutoAssetControlManager *)self setLockUsageMapLockCount];
  v6 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v7 = [v6 persistedEntryCount:@"startupActivationResourceSummary"];
  v8 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v9 = [v8 persistedEntryCount:@"startupActivationResourceSummary"];
  v10 = [(MADAutoAssetControlManager *)self persistedSetLookupResults];
  v11 = [v10 persistedEntryCount:@"startupActivationResourceSummary"];
  v12 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v13 = [v12 persistedEntryCount:@"startupActivationResourceSummary"];
  v14 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v15 = [v24 initWithFormat:@"[STARTUP][DURATION:%ldsecs](assets:%ld, configs:%ld, atomic:%ld[locks:%ld], sdesc:%ld, targets:%ld, lookups:%ld, jobs:[single:%ld, set:%ld])", v23, v21, v20, v19, v18, v7, v9, v11, v13, objc_msgSend(v14, "persistedEntryCount:", @"startupActivationResourceSummary"];

  if (v15)
  {
    v16 = v15;
  }

  else
  {
    v16 = @"MA-RESOURCE-SUMMARY";
  }

  return v16;
}

- (void)trackClientRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  v8 = [v4 clientRequestUUID];
  [v7 setSafeObject:v4 forKey:v8];

  v10 = [(MADAutoAssetControlManager *)self statistics];
  v9 = [v10 totalClientRequests];
  [(MADAutoAssetControlManager *)self _statsIncrement:v9 forClientRequest:v4];
}

- (void)removeClientRequest:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v80 = v7;
  v11 = [[NSString alloc] initWithFormat:@"%@:removeClientRequest", v7];
  if (v6)
  {
    v12 = [v6 clientReplyCompletion];

    if (v12)
    {
      v13 = [NSString alloc];
      v14 = [v6 summary];
      v15 = [v13 initWithFormat:@"{%@:removeClientRequest} | removing client request that has not been replied to - replying with error | clientRequest:%@", v11, v14];

      v16 = [MAAutoAssetError buildError:6103 fromOperation:v11 underlyingError:0 withDescription:v15];
      v17 = [v6 clientRequestMessage];
      v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
      v19 = [v6 clientID];
      v20 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:v19 response:0 error:v16];

      v21 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v22 = [v21 diag];
      [v22 trackAnomaly:@"AUTO-CONTROL" forReason:v15 withResult:6103 withError:v16];

      v23 = [(MADAutoAssetControlManager *)self statistics];
      v24 = [v23 totalClientRepliesFailure];
      [(MADAutoAssetControlManager *)self _statsIncrement:v24 forClientRequest:v6];

      v25 = [v6 clientReplyCompletion];
      (v25)[2](v25, v20, v16);

      [v6 setClientReplyCompletion:0];
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    }

    [(MADAutoAssetControlManager *)self timerStopForClientRequest:v6 fromLocation:v11];
    v26 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v81 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v11 ofContainer:@"clientRequestsAwaitingSync"];
    v95 = 0u;
    v96 = 0u;
    v93 = 0u;
    v94 = 0u;
    v27 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
    v28 = [v27 countByEnumeratingWithState:&v93 objects:v104 count:16];
    v88 = self;
    v85 = v11;
    if (v28)
    {
      v29 = v28;
      obj = v6;
      v83 = 0;
      v30 = *v94;
      do
      {
        for (i = 0; i != v29; i = i + 1)
        {
          if (*v94 != v30)
          {
            objc_enumerationMutation(v27);
          }

          v32 = v27;
          v33 = *(*(&v93 + 1) + 8 * i);
          v34 = objc_autoreleasePoolPush();
          v35 = [v33 clientRequest];
          v36 = [v35 clientRequestUUID];
          v37 = [obj clientRequestUUID];
          v38 = [SUCore stringIsEqual:v36 to:v37];

          if (v38)
          {
            v39 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
            {
              v40 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
              v41 = [v33 summary];
              *buf = 138543874;
              v99 = v40;
              v100 = 2114;
              v101 = v85;
              v102 = 2114;
              v103 = v41;
              _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:removeClientRequest} [CLIENT_REQUESTS_AWAITING_SYNC] | trimmed client-request | jobParam:%{public}@", buf, 0x20u);
            }

            v42 = [(MADAutoAssetControlManager *)v88 statistics];
            v43 = [v42 totalDequeuedClientRequests];
            v44 = [v33 clientRequest];
            [(MADAutoAssetControlManager *)v88 _statsIncrement:v43 forClientRequest:v44];

            v83 = 1;
          }

          else if (v33)
          {
            [v81 addObject:v33];
          }

          else
          {
            v45 = [(MADAutoAssetControlManager *)v88 autoControlManagerFSM];
            v46 = [v45 diag];
            v47 = [NSString alloc];
            v48 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
            v49 = [v47 initWithFormat:@"{%@:removeClientRequest} | nil jobParam on clientRequestsAwaitingSync | %@", v85, v48];
            [v46 trackAnomaly:@"AUTO-CONTROL" forReason:v49 withResult:6102 withError:0];
          }

          objc_autoreleasePoolPop(v34);
          v27 = v32;
        }

        v29 = [v32 countByEnumeratingWithState:&v93 objects:v104 count:16];
      }

      while (v29);

      v6 = obj;
      self = v88;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      v26 = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      v11 = v85;
      if (v83)
      {
        [(MADAutoAssetControlManager *)v88 setClientRequestsAwaitingSync:v81];
      }
    }

    else
    {
    }

    v82 = objc_alloc_init(v26[228]);

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v11 ofContainer:@"clientRequestsAwaitingFirstUnlock"];
    v91 = 0u;
    v92 = 0u;
    v89 = 0u;
    v90 = 0u;
    v54 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
    v55 = [v54 countByEnumeratingWithState:&v89 objects:v97 count:16];
    if (v55)
    {
      v56 = v55;
      v57 = v6;
      v84 = 0;
      v58 = *v90;
      obja = v54;
      do
      {
        for (j = 0; j != v56; j = j + 1)
        {
          if (*v90 != v58)
          {
            objc_enumerationMutation(obja);
          }

          v60 = *(*(&v89 + 1) + 8 * j);
          v61 = objc_autoreleasePoolPush();
          v62 = [v60 clientRequest];
          v63 = [v62 clientRequestUUID];
          v64 = [v57 clientRequestUUID];
          v65 = [SUCore stringIsEqual:v63 to:v64];

          if (v65)
          {
            v66 = [(MADAutoAssetControlManager *)v88 statistics];
            v67 = [v66 totalDequeuedClientRequests];
            v68 = [v60 clientRequest];
            [(MADAutoAssetControlManager *)v88 _statsIncrement:v67 forClientRequest:v68];

            v84 = 1;
          }

          else if (v60)
          {
            [v82 addObject:v60];
          }

          else
          {
            v69 = [(MADAutoAssetControlManager *)v88 autoControlManagerFSM];
            v70 = [v69 diag];
            v71 = [NSString alloc];
            v72 = [(MADAutoAssetControlManager *)v88 _updateLatestSummary];
            v73 = [v71 initWithFormat:@"{%@:removeClientRequest} | nil jobParam on clientRequestsAwaitingFirstUnlock | %@", v85, v72];
            [v70 trackAnomaly:@"AUTO-CONTROL" forReason:v73 withResult:6102 withError:0];
          }

          objc_autoreleasePoolPop(v61);
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        }

        v56 = [obja countByEnumeratingWithState:&v89 objects:v97 count:16];
      }

      while (v56);

      v6 = v57;
      if (v84)
      {
        [(MADAutoAssetControlManager *)v88 setClientRequestsAwaitingFirstUnlock:v82];
      }
    }

    else
    {
    }

    v74 = [v6 clientRequestUUID];

    if (v74)
    {
      v75 = [(MADAutoAssetControlManager *)v88 clientRequestsBeingTracked];
      v76 = [v6 clientRequestUUID];
      [v75 removeObjectForKey:v76];
    }

    else
    {
      v75 = [(MADAutoAssetControlManager *)v88 autoControlManagerFSM];
      v76 = [v75 diag];
      v77 = objc_alloc(p_weak_ivar_lyt[226]);
      v78 = [v6 summary];
      v79 = [v77 initWithFormat:@"{removeClientRequest} client-request without clientRequestUUID | clientRequest:%@", v78];
      [v76 trackAnomaly:@"AUTO-CONTROL" forReason:v79 withResult:6109 withError:0];
    }

    v51 = v85;
  }

  else
  {
    v50 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v50 diag];
    v52 = v51 = v11;
    v53 = [[NSString alloc] initWithFormat:@"{%@:removeClientRequest} | nil clientRequest provided", v51];
    [v52 trackAnomaly:@"AUTO-CONTROL" forReason:v53 withResult:6102 withError:0];
  }
}

- (void)clientRequestsAwaitingSyncToAwaitingFirstUnlock:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v42 = v4;
  v7 = [[NSString alloc] initWithFormat:@"%@:clientRequestsAwaitingSyncToAwaitingFirstUnlock", v4];
  v44 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v7 ofContainer:@"clientRequestsAwaitingSync"];
  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v8 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
  v47 = [v8 countByEnumeratingWithState:&v54 objects:v65 count:16];
  if (v47)
  {
    obj = *v55;
    v43 = v8;
    do
    {
      for (i = 0; i != v47; i = i + 1)
      {
        if (*v55 != obj)
        {
          objc_enumerationMutation(v8);
        }

        v10 = *(*(&v54 + 1) + 8 * i);
        v11 = objc_autoreleasePoolPush();
        if (!v10)
        {
          v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v15 = [v14 diag];
          v18 = [[NSString alloc] initWithFormat:@"{%@} | nil jobParam on clientRequestsAwaitingSync", v7];
          [v15 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6102 withError:0];

          goto LABEL_21;
        }

        v12 = [v10 clientRequest];
        v13 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v12];

        if (v13)
        {
          v14 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v7 withEventInfo:v10];
          if (v14)
          {
            [v44 addObject:v10];
            v15 = [(MADAutoAssetControlManager *)self statistics];
            v16 = [v15 totalDequeuedClientRequests];
            v17 = [v10 clientRequest];
            [(MADAutoAssetControlManager *)self _statsIncrement:v16 forClientRequest:v17];
          }

          else
          {
            v26 = [NSString alloc];
            v15 = [v10 summary];
            v16 = [v26 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v7, v15];
            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:v7 withDescription:v16];
          }

          goto LABEL_17;
        }

        v14 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v10];
        if (!v14)
        {
          v27 = [NSString alloc];
          v15 = [v10 summary];
          v16 = [v27 initWithFormat:@"{%@} | invalid eventInfo (instance:MISSING) | eventInfo:%@", v7, v15];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:v7 withDescription:v16];
LABEL_17:

          goto LABEL_21;
        }

        v19 = [v10 clientRequest];
        v20 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v19];
        v21 = [v14 clientAssetSelector];
        v22 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v20 forAssetSelector:v21];

        if (!v22)
        {
          [v44 addObject:v10];
          v15 = [(MADAutoAssetControlManager *)self statistics];
          v24 = [v15 totalDequeuedClientRequests];
          v25 = [v10 clientRequest];
          [(MADAutoAssetControlManager *)self _statsIncrement:v24 forClientRequest:v25];
          goto LABEL_19;
        }

        v23 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
        [v23 addObject:v10];

        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
        {
          v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v25 = [v10 summary];
          *buf = 138543874;
          v60 = v24;
          v61 = 2114;
          v62 = v7;
          v63 = 2114;
          v64 = v25;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | moved client-request to awaiting first-unlock | jobParam:%{public}@", buf, 0x20u);
LABEL_19:
        }

        v8 = v43;
LABEL_21:

        objc_autoreleasePoolPop(v11);
      }

      v47 = [v8 countByEnumeratingWithState:&v54 objects:v65 count:16];
    }

    while (v47);
  }

  v49 = v7;

  v28 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingSync:v28];

  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  obja = v44;
  v29 = [obja countByEnumeratingWithState:&v50 objects:v58 count:16];
  if (v29)
  {
    v30 = v29;
    v31 = *v51;
    v32 = @"AutoControl";
    do
    {
      for (j = 0; j != v30; j = j + 1)
      {
        if (*v51 != v31)
        {
          objc_enumerationMutation(obja);
        }

        v34 = *(*(&v50 + 1) + 8 * j);
        v35 = objc_autoreleasePoolPush();
        [v34 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v36 = _MADLog(v32);
        if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
        {
          [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v37 = v48 = v35;
          [v34 summary];
          v38 = v32;
          v39 = self;
          v41 = v40 = v31;
          *buf = 138543874;
          v60 = v37;
          v61 = 2114;
          v62 = v49;
          v63 = 2114;
          v64 = v41;
          _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request | jobParam:%{public}@", buf, 0x20u);

          v31 = v40;
          self = v39;
          v32 = v38;

          v35 = v48;
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v34 fromLocation:v49];
        objc_autoreleasePoolPop(v35);
      }

      v30 = [obja countByEnumeratingWithState:&v50 objects:v58 count:16];
    }

    while (v30);
  }
}

- (void)clientRequestsAwaitingDispatchAll:(id)a3
{
  v37 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:clientRequestsAwaitingDispatchAll", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &state);

  v7 = [[NSString alloc] initWithFormat:@"%@:clientRequestsAwaitingDispatchAll", v37];
  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    buf = 138543618;
    v54 = v9;
    v55 = 2114;
    v56 = v7;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | scheduling all queued client requests", &buf, 0x16u);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v7 ofContainer:@"clientRequestsAwaitingSync"];
  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  v10 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
  v11 = [v10 countByEnumeratingWithState:&v47 objects:v59 count:16];
  if (v11)
  {
    v40 = *v48;
    obj = v10;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v48 != v40)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v47 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        [v13 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
        {
          v16 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v17 = [v13 summary];
          buf = 138543874;
          v54 = v16;
          v55 = 2114;
          v56 = v7;
          v57 = 2114;
          v58 = v17;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request | jobParam:%{public}@", &buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v13 fromLocation:v7];
        v18 = [(MADAutoAssetControlManager *)self statistics];
        v19 = [v18 totalDequeuedClientRequests];
        v20 = [v13 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:v19 forClientRequest:v20];

        objc_autoreleasePoolPop(v14);
      }

      v10 = obj;
      v11 = [obj countByEnumeratingWithState:&v47 objects:v59 count:16];
    }

    while (v11);
  }

  v21 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingSync:v21];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v7 ofContainer:@"clientRequestsAwaitingFirstUnlock"];
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v22 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
  v23 = [v22 countByEnumeratingWithState:&v43 objects:v52 count:16];
  if (v23)
  {
    v41 = *v44;
    obja = v22;
    do
    {
      for (j = 0; j != v23; j = j + 1)
      {
        if (*v44 != v41)
        {
          objc_enumerationMutation(obja);
        }

        v25 = *(*(&v43 + 1) + 8 * j);
        v26 = objc_autoreleasePoolPush();
        [v25 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v42 = 0;
        v27 = [v25 clientRequest];
        v28 = [(MADAutoAssetControlManager *)self clientRequestTimeoutSecs:v27 timeoutWasSpecified:&v42];

        if (v28 == -2 || (v42 & 1) == 0)
        {
          v29 = [v25 clientRequest];
          [(MADAutoAssetControlManager *)self timerStopForClientRequest:v29 fromLocation:v7];
        }

        v30 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
        {
          v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v32 = [v25 summary];
          buf = 138543874;
          v54 = v31;
          v55 = 2114;
          v56 = v7;
          v57 = 2114;
          v58 = v32;
          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request that had been awaiting first-unlock | jobParam:%{public}@", &buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v25 fromLocation:v7];
        v33 = [(MADAutoAssetControlManager *)self statistics];
        v34 = [v33 totalDequeuedClientRequests];
        v35 = [v25 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:v34 forClientRequest:v35];

        objc_autoreleasePoolPop(v26);
      }

      v22 = obja;
      v23 = [obja countByEnumeratingWithState:&v43 objects:v52 count:16];
    }

    while (v23);
  }

  v36 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingFirstUnlock:v36];

  os_activity_scope_leave(&state);
}

- (const)osTransactionNameAutoJob:(id)a3 forJobUUID:(id)a4
{
  v5 = a4;
  v6 = a3;
  v7 = [[NSString alloc] initWithFormat:@"%@-%@", v6, v5];

  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v12 = v7;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "[OS-TRANSACTION-JOB] [BEGIN] %{public}@", buf, 0xCu);
  }

  v9 = [v7 UTF8String];
  return v9;
}

- (void)addToCurrentJobs:(id)a3 usingSelector:(id)a4 withJobUUID:(id)a5 triggeredByClientMessage:(id)a6 downloadingDescriptor:(id)a7 baseForPatchDescriptor:(id)a8 usingSetDescriptor:(id)a9 fromLocation:(id)a10
{
  v16 = a3;
  v17 = a4;
  v18 = a5;
  v19 = a6;
  v20 = a7;
  v21 = a8;
  v50 = a9;
  v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v23 = [v22 extendedStateQueue];
  dispatch_assert_queue_V2(v23);

  if (![v16 autoAssetSetJob])
  {
    v32 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v19];
    v33 = [v32 clientAssetPolicy];
    [(MADAutoAssetControlManager *)self initialStatusForJob:v16 usingSelector:v17 withJobUUID:v18 downloadingDescriptor:v20 baseForPatchDescriptor:v21 withClientAssetPolicy:v33];

    v34 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
    v49 = v17;
    v35 = [(MADAutoAssetControlManager *)self jobSelectorKey:v17];
    [v34 setSafeObject:v16 forKey:v35];

    v36 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    [v36 setSafeObject:v16 forKey:v18];

    v37 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
LABEL_25:

      v17 = v49;
LABEL_37:
      v42 = v50;
      goto LABEL_38;
    }

    v47 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v45 = [v49 summary];
    v38 = [v16 summary];
    if (v19)
    {
      v43 = [v19 messageName];
      if (v20)
      {
        goto LABEL_12;
      }
    }

    else
    {
      v43 = @"SCHEDULED | RESUMED";
      if (v20)
      {
LABEL_12:
        v39 = [v20 summary];
        if (v21)
        {
LABEL_13:
          v40 = [v21 summary];
LABEL_18:
          *buf = 138544898;
          v52 = v47;
          v53 = 2114;
          v54 = v45;
          v55 = 2114;
          v56 = v38;
          v57 = 2114;
          v58 = v18;
          v59 = 2114;
          v60 = v43;
          v61 = 2114;
          v62 = v39;
          v63 = 2114;
          v64 = v40;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@] {addToCurrentJobs} currentJobsBySelector[%{public}@] | autoJob:%{public}@ | JobUUID:%{public}@ | message:%{public}@ | downloadingDescriptor:%{public}@ | baseForPatchDescriptor:%{public}@", buf, 0x48u);
          if (v21)
          {
          }

          if (v20)
          {
          }

          if (v19)
          {
          }

          goto LABEL_25;
        }

LABEL_17:
        v40 = @"N";
        goto LABEL_18;
      }
    }

    v39 = @"N";
    if (v21)
    {
      goto LABEL_13;
    }

    goto LABEL_17;
  }

  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    v24 = [v16 clientDomainName];
    v25 = [v16 autoAssetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:v24 forAssetSetIdentifier:v25];

    if (v26)
    {
      v27 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
LABEL_36:

        goto LABEL_37;
      }

      v46 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v48 = v17;
      v44 = [v17 summary];
      v28 = [v16 summary];
      if (v19)
      {
        v29 = [v19 messageName];
        if (v20)
        {
          goto LABEL_7;
        }
      }

      else
      {
        v29 = @"SCHEDULED | RESUMED";
        if (v20)
        {
LABEL_7:
          v30 = [v20 summary];
          if (v21)
          {
LABEL_8:
            v31 = [v21 summary];
LABEL_29:
            *buf = 138544898;
            v52 = v46;
            v53 = 2114;
            v54 = v44;
            v55 = 2114;
            v56 = v28;
            v57 = 2114;
            v58 = v18;
            v59 = 2114;
            v60 = v29;
            v61 = 2114;
            v62 = v30;
            v63 = 2114;
            v64 = v31;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {addToCurrentJobs} Invariant violation, suspended sets should be handled before this point | selector:%{public}@ | autoJob:%{public}@ | JobUUID:%{public}@ | message:%{public}@ | downloadingDescriptor:%{public}@ | baseForPatchDescriptor:%{public}@", buf, 0x48u);
            if (v21)
            {
            }

            if (v20)
            {
            }

            if (v19)
            {
            }

            v17 = v48;
            goto LABEL_36;
          }

LABEL_28:
          v31 = @"N";
          goto LABEL_29;
        }
      }

      v30 = @"N";
      if (v21)
      {
        goto LABEL_8;
      }

      goto LABEL_28;
    }
  }

  v41 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:v19];
  v42 = v50;
  [(MADAutoAssetControlManager *)self initialStatusForSetJob:v16 withJobUUID:v18 usingSetDescriptor:v50 usingSetPolicy:v41];

LABEL_38:
}

- (void)removeCurrentJob:(id)a3 schedulerInvolved:(BOOL)a4 potentialNetworkFailure:(BOOL)a5 fromLocation:(id)a6
{
  v185 = a5;
  v7 = a4;
  v9 = a3;
  v10 = a6;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:removeCurrentJob", v10];
  v14 = [v9 autoAssetJobID];
  v15 = [v9 autoAssetSelector];
  v16 = [v15 assetVersion];
  if (v16)
  {
    v17 = [v9 autoAssetSelector];
  }

  else
  {
    v17 = 0;
  }

  v18 = [v9 autoAssetSelector];
  v19 = [v18 assetVersion];
  v188 = v10;
  v186 = v7;
  if (v19)
  {
    v20 = 0;
  }

  else
  {
    v20 = [v9 autoAssetSelector];
  }

  v21 = [v9 autoAssetUUID];
  v22 = [v9 fromAutoAssetJob];
  v193 = [v22 clientDomainName];

  v23 = [v9 fromAutoAssetJob];
  v195 = [v23 autoAssetSetIdentifier];

  if (!v20 && v17)
  {
    v24 = [MAAutoAssetSelector alloc];
    v25 = [v17 assetType];
    v26 = [v17 assetSpecifier];
    v20 = [v24 initForAssetType:v25 withAssetSpecifier:v26];
  }

  v27 = [v9 fromAutoAssetJob];
  v194 = self;
  v187 = v9;
  if (v27)
  {
    v28 = v27;
    v29 = [v9 fromAutoAssetJob];
    v30 = [v29 autoAssetSetJob];

    if (v30)
    {
      [(MADAutoAssetControlManager *)self removeCurrentSetJob:v9 schedulerInvolved:v186 potentialNetworkFailure:v185 fromLocation:v13 historyOperation:332];
      goto LABEL_50;
    }
  }

  if (!v14)
  {
    v14 = [v9 autoAssetUUID];
  }

  v184 = v13;
  v31 = [(MADAutoAssetControlManager *)self currentJobByUUID:v14 fromLocation:v13 notFoundCode:0 notFoundReason:0];
  v32 = [(MADAutoAssetControlManager *)self currentJobBySelector:v17];
  if (v32)
  {
    v33 = v21;
LABEL_18:
    v35 = v14;
    v36 = v32;
    v37 = [v9 autoAssetSelector];
    v38 = [v37 assetVersion];

    v39 = [v9 autoAssetSelector];
    if (v38)
    {
      v40 = v17;
    }

    else
    {
      v40 = v20;
    }

    if (!v38)
    {
      v20 = v39;
    }

    v189 = v20;
    if (v38)
    {
      v17 = v39;
    }

    v41 = 0;
    v42 = v31;
    v43 = v31 == 0;
    v44 = v36;
    v14 = v35;
    goto LABEL_26;
  }

  v34 = self;
  v33 = v21;
  v32 = [(MADAutoAssetControlManager *)v34 currentJobBySelector:v20];
  if (v32)
  {
    goto LABEL_18;
  }

  v189 = v20;
  v42 = v31;
  if (!v31)
  {
    v93 = [(MADAutoAssetControlManager *)v194 autoControlManagerFSM];
    v94 = [v93 diag];
    v95 = [NSString alloc];
    v96 = [v9 summary];
    v97 = [v95 initWithFormat:@"{%@} | job finished that was not tracked by UUID or by selector from eventInfo:%@", v184, v96];
    [v94 trackAnomaly:@"AUTO-CONTROL" forReason:v97 withResult:6110 withError:0];

    v45 = 0;
    v21 = v33;
    self = v194;
    v13 = v184;

    goto LABEL_48;
  }

  v43 = 0;
  v44 = 0;
  v41 = 1;
LABEL_26:
  if ([v42 clientRequestCount] > 0 || objc_msgSend(v44, "clientRequestCount") >= 1)
  {
    v21 = v33;
    v45 = v31;
    self = v194;
    v13 = v184;
    if (v186)
    {
      if (v43)
      {
        if (v41)
        {
          goto LABEL_44;
        }

        [v44 setEarlierSchedulerInvolved:1];
        if (!v185)
        {
          goto LABEL_44;
        }

        goto LABEL_36;
      }

      [v45 setEarlierSchedulerInvolved:1];
      if (!v185)
      {
        if ((v41 & 1) == 0)
        {
          [v44 setEarlierSchedulerInvolved:1];
        }

        goto LABEL_44;
      }

      [v45 setEarlierPotentialNetworkFailure:1];
      if ((v41 & 1) == 0)
      {
        [v44 setEarlierSchedulerInvolved:1];
LABEL_36:
        [v44 setEarlierPotentialNetworkFailure:1];
      }
    }

LABEL_44:
    v46 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
    {
      [v9 summary];
      v48 = v47 = v44;
      *buf = 138543618;
      v201 = v184;
      v202 = 2114;
      v203 = v48;
      _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {%{public}@} auto-asset-job indicated removal but has more to do | eventInfo:%{public}@", buf, 0x16u);

      v44 = v47;
    }

    goto LABEL_47;
  }

  v21 = v33;
  v45 = v31;
  if (!v31 || ![v31 autoAssetSetJob])
  {
    v92 = [v9 autoAssetSelector];
    v177 = objc_alloc_init(NSMutableString);
    self = v194;
    if (v92)
    {
      v175 = v92;
    }

    else
    {
      v98 = [v31 autoAssetSelector];
      v99 = [(MADAutoAssetControlManager *)v194 currentJobBySelector:v98];

      if (v99)
      {
        v100 = [v98 assetVersion];

        v101 = v98;
        v102 = v189;
        if (v100)
        {
          v103 = v17;
        }

        else
        {
          v103 = v189;
        }

        if (!v100)
        {
          v102 = v101;
        }

        v189 = v102;
        v175 = v101;
        if (v100)
        {
          v17 = v101;
        }

        v44 = v99;
      }

      else
      {
        v175 = v98;
        v44 = 0;
      }

      v45 = v31;
    }

    v104 = [v9 autoAssetStatus];

    v178 = v44;
    v105 = v184;
    v176 = v45;
    if (v104)
    {
      v106 = [v9 autoAssetStatus];
      if (v17)
      {
        v107 = [v17 assetVersion];
        v108 = [[NSString alloc] initWithFormat:@"%@(with-version)", v184];
        [(MADAutoAssetControlManager *)v194 updateAutoAssetStatus:v17 forActiveJobUUID:v14 withLatestJobStatus:v106 matchingAssetVersion:v107 fromLocation:v108];

        v44 = v178;
      }

      else
      {
        v107 = [[NSString alloc] initWithFormat:@"%@(without-version)", v184];
        [(MADAutoAssetControlManager *)v194 updateAutoAssetStatus:v189 forActiveJobUUID:v14 withLatestJobStatus:v106 matchingAssetVersion:0 fromLocation:v107];
      }

      v45 = v176;
    }

    if (v43)
    {
      [v177 appendString:@" | bySelector"];
    }

    else
    {
      v109 = [(MADAutoAssetControlManager *)v194 stagerCurrentJob];
      if (v109 && (v110 = v109, [(MADAutoAssetControlManager *)v194 stagerCurrentJobUUID], v111 = objc_claimAutoreleasedReturnValue(), v112 = [SUCore stringIsEqual:v14 to:v111], v111, v45 = v176, v110, v112))
      {
        [v177 appendString:@" | stager-current-job"];
      }

      else
      {
        v113 = [(MADAutoAssetControlManager *)v194 currentJobsByUUID];
        [v113 removeObjectForKey:v14];

        [v177 appendFormat:@" | autoAssetJobUUID:%@", v14];
      }

      v44 = v178;
    }

    if (v44)
    {
      v114 = [(MADAutoAssetControlManager *)v194 jobSelectorKey:v175];
      if (v114)
      {
        v115 = [(MADAutoAssetControlManager *)v194 currentJobsBySelector];
        [v115 removeObjectForKey:v114];

        if (v43)
        {
          v116 = [v178 summary];
          [v177 appendFormat:@" | autoJobBySelector:%@ | job:%@", v114, v116];
        }

        else
        {
          [v177 appendFormat:@" | autoJobBySelector:%@", v114];
        }

        v44 = v178;
      }

      else
      {
        [v177 appendString:@" | nil-jobSelectorKey"];
      }

      v117 = v189;
      if (v45)
      {
        v118 = [v44 summary];
        [v177 appendFormat:@"job:%@", v118];
      }
    }

    else
    {
      [v177 appendString:@" | byUUID"];
      v117 = v189;
    }

    if (!v17)
    {
      v119 = [v45 autoAssetSelector];
      v120 = [v119 assetVersion];

      if (v120)
      {
        v17 = [v45 autoAssetSelector];
      }

      else
      {
        v17 = 0;
      }

      v44 = v178;
    }

    if (!v117)
    {
      v121 = [v45 autoAssetSelector];

      if (v121)
      {
        v122 = [v45 autoAssetSelector];
        v123 = [v122 assetVersion];

        if (v123)
        {
          v124 = [MAAutoAssetSelector alloc];
          v191 = [v45 autoAssetSelector];
          [v191 assetType];
          v126 = v125 = v45;
          [v125 autoAssetSelector];
          v128 = v127 = v21;
          [v128 assetSpecifier];
          v130 = v129 = v14;
          v117 = [v124 initForAssetType:v126 withAssetSpecifier:v130];

          v14 = v129;
          v21 = v127;
          v105 = v184;
          self = v194;

          v45 = v125;
        }

        else
        {
          v117 = [v45 autoAssetSelector];
        }

        v44 = v178;
      }

      else
      {
        v117 = 0;
      }
    }

    v192 = v117;
    [(MADAutoAssetControlManager *)self removeActiveJobForFullSelector:v105 removingFullSelector:v17 alsoRemovingNoVersionSelector:v117];
    if (v17)
    {
      v131 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      v132 = [v17 persistedEntryID];
      v133 = [v131 safeObjectForKey:v132 ofClass:objc_opt_class()];

      v134 = 0;
      if (v14 && v133)
      {
        v135 = [v133 activeJobsByUUID];
        v136 = [v135 safeObjectForKey:v14 ofClass:objc_opt_class()];

        v44 = v178;
        if (v136)
        {
          if ([SUCore stringIsEqual:v136 to:v14])
          {
            v137 = [v133 activeJobsByUUID];
            [v137 removeObjectForKey:v136];

            v134 = 1;
LABEL_144:

            v45 = v176;
            goto LABEL_145;
          }
        }

        else
        {
          v138 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v138, OS_LOG_TYPE_DEFAULT))
          {
            [v17 summary];
            v140 = v139 = v21;
            v141 = [v133 summary];
            *buf = 138544130;
            v201 = v184;
            v202 = 2114;
            v203 = v140;
            v204 = 2114;
            v205 = v14;
            v206 = 2114;
            v207 = v141;
            _os_log_impl(&dword_0, v138, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{%{public}@} no active job withVersionSelector:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x2Au);

            v44 = v178;
            v21 = v139;
            self = v194;
          }
        }

        v134 = 0;
        goto LABEL_144;
      }

      v44 = v178;
    }

    else
    {
      v133 = 0;
      v134 = 0;
    }

LABEL_145:
    if (!v192 || v134)
    {
LABEL_159:
      if (!v14 || v134)
      {
        if (v134)
        {
LABEL_178:
          [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v133];
          v20 = v192;
          goto LABEL_187;
        }

LABEL_172:
        v162 = v185;
        v163 = v186;
        if (v45)
        {
          v163 = [v45 earlierSchedulerInvolved] | v186;
          v162 = [v45 earlierPotentialNetworkFailure] | v185;
        }

        v44 = v178;
        if (v178)
        {
          obja = v162;
          v164 = v163 | [v178 earlierSchedulerInvolved];
          v165 = [v178 earlierPotentialNetworkFailure];
          v20 = v192;
          if (v164)
          {
            v162 = obja | v165;
            v44 = v178;
LABEL_180:
            if (v162)
            {
              v167 = v162;
              v168 = [MAAutoAssetError buildError:6401 fromOperation:v184 underlyingError:0 withDescription:@"auto-asset-scheduler involved job finished with potential network-connectivity failure"];
              v169 = [v9 autoAssetSelector];
              v20 = v192;
              [MADAutoAssetHistory recordFailedOperation:504 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v169 failingWithError:v168];

              v45 = v176;
              v162 = v167;
              v44 = v178;
            }

            if (v20)
            {
              v170 = v20;
            }

            else
            {
              v170 = v17;
            }

            [MADAutoAssetScheduler jobFinishedForSelector:v170 withPotentialNetworkFailure:v162];
            goto LABEL_187;
          }

          v44 = v178;
        }

        else
        {
          v20 = v192;
          if (v163)
          {
            goto LABEL_180;
          }
        }

LABEL_187:
        v171 = [(MADAutoAssetControlManager *)self statistics];
        v172 = v171;
        if (v186)
        {
          if (v185)
          {
            [v171 setFinishedJobSchedulerNetworkFailure:{objc_msgSend(v171, "finishedJobSchedulerNetworkFailure") + 1}];
          }

          else
          {
            [v171 setFinishedJobSchedulerNotNetworkRelated:{objc_msgSend(v171, "finishedJobSchedulerNotNetworkRelated") + 1}];
          }
        }

        else if (v185)
        {
          [v171 setFinishedJobClientNetworkFailure:{objc_msgSend(v171, "finishedJobClientNetworkFailure") + 1}];
        }

        else
        {
          [v171 setFinishedJobClientNotNetworkRelated:{objc_msgSend(v171, "finishedJobClientNotNetworkRelated") + 1}];
        }

        v173 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v173, OS_LOG_TYPE_DEFAULT))
        {
          v174 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543874;
          v201 = v174;
          v202 = 2114;
          v203 = v184;
          v204 = 2114;
          v205 = v177;
          _os_log_impl(&dword_0, v173, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} removed auto-asset-job from tracking | removals:%{public}@", buf, 0x20u);

          v44 = v178;
        }

        v13 = v184;
        goto LABEL_49;
      }

LABEL_161:
      v180 = v21;
      v183 = v14;
      v198 = 0u;
      v199 = 0u;
      v196 = 0u;
      v197 = 0u;
      obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      v152 = [obj countByEnumeratingWithState:&v196 objects:v210 count:16];
      if (v152)
      {
        v153 = v152;
        v154 = *v197;
        while (2)
        {
          v155 = 0;
          v156 = v133;
          do
          {
            if (*v197 != v154)
            {
              objc_enumerationMutation(obj);
            }

            v157 = *(*(&v196 + 1) + 8 * v155);
            v158 = objc_autoreleasePoolPush();
            v159 = [(MADAutoAssetControlManager *)v194 activelyEliminatingSelectors];
            v133 = [v159 safeObjectForKey:v157 ofClass:objc_opt_class()];

            if (v133)
            {
              v160 = [v133 activeJobsByUUID];
              v161 = [v160 safeObjectForKey:v183 ofClass:objc_opt_class()];

              if (v161)
              {
                v166 = [v133 activeJobsByUUID];
                [v166 removeObjectForKey:v161];

                objc_autoreleasePoolPop(v158);
                v14 = v183;
                v21 = v180;
                v45 = v176;
                v44 = v178;
                self = v194;
                goto LABEL_178;
              }
            }

            objc_autoreleasePoolPop(v158);
            v155 = v155 + 1;
            v156 = v133;
          }

          while (v153 != v155);
          v153 = [obj countByEnumeratingWithState:&v196 objects:v210 count:16];
          if (v153)
          {
            continue;
          }

          break;
        }
      }

      v14 = v183;
      v21 = v180;
      v45 = v176;
      self = v194;
      goto LABEL_172;
    }

    v142 = v133;
    v143 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    v144 = [v192 persistedEntryID];
    v133 = [v143 safeObjectForKey:v144 ofClass:objc_opt_class()];

    if (!v14 || !v133)
    {
      if (!v14)
      {
        goto LABEL_172;
      }

      goto LABEL_161;
    }

    v145 = [v133 activeJobsByUUID];
    v146 = [v145 safeObjectForKey:v14 ofClass:objc_opt_class()];

    v134 = v146 != 0;
    v44 = v178;
    if (v146)
    {
      if (![SUCore stringIsEqual:v146 to:v14])
      {
        v134 = 0;
        goto LABEL_158;
      }

      v147 = [v133 activeJobsByUUID];
      [v147 removeObjectForKey:v146];
    }

    else
    {
      v147 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v147, OS_LOG_TYPE_DEFAULT))
      {
        [v192 summary];
        v148 = v21;
        v150 = v149 = v14;
        v151 = [v133 summary];
        *buf = 138544130;
        v201 = v184;
        v202 = 2114;
        v203 = v150;
        v204 = 2114;
        v205 = v149;
        v206 = 2114;
        v207 = v151;
        _os_log_impl(&dword_0, v147, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{%{public}@} no active job withoutVersionSelector:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x2Au);

        v44 = v178;
        v14 = v149;
        v21 = v148;
        self = v194;
      }
    }

LABEL_158:
    v45 = v176;
    goto LABEL_159;
  }

  self = v194;
  v13 = v184;
  [(MADAutoAssetControlManager *)v194 removeCurrentSetJob:v9 schedulerInvolved:v186 potentialNetworkFailure:v185 fromLocation:v184 historyOperation:333];
LABEL_47:

LABEL_48:
  v20 = v189;
LABEL_49:

LABEL_50:
  v49 = v13;
  if (v14)
  {
    v50 = [(MADAutoAssetControlManager *)self currentJobByUUID:v14 fromLocation:v13 notFoundCode:0 notFoundReason:0];
    if (v50)
    {
      v51 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
      [v51 removeObjectForKey:v14];

      v52 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v53 = v20;
        v55 = v54 = v21;
        v56 = [v50 summary];
        *buf = 138544130;
        v201 = v55;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v14;
        v206 = 2114;
        v207 = v56;
        _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsByUUID | autoAssetJobUUID:%{public}@ | autoJobByUUID:%{public}@", buf, 0x2Au);

        v21 = v54;
        v20 = v53;
        v13 = v49;
        self = v194;
      }
    }
  }

  if (v21)
  {
    v57 = [(MADAutoAssetControlManager *)self currentJobByUUID:v21 fromLocation:v13 notFoundCode:0 notFoundReason:0];
    if (v57)
    {
      v58 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
      [v58 removeObjectForKey:v21];

      v59 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v60 = v20;
        v62 = v61 = v21;
        v63 = [v57 summary];
        *buf = 138544130;
        v201 = v62;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v61;
        v206 = 2114;
        v207 = v63;
        _os_log_impl(&dword_0, v59, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsByUUID | secondaryAutoAssetUUID:%{public}@ | autoJobByUUID:%{public}@", buf, 0x2Au);

        v21 = v61;
        v20 = v60;
        v13 = v49;
        self = v194;
      }
    }
  }

  if (v17)
  {
    v64 = [(MADAutoAssetControlManager *)self currentJobBySelector:v17];
    if (v64)
    {
      v65 = v20;
      v66 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      v67 = [(MADAutoAssetControlManager *)self jobSelectorKey:v17];
      [v66 removeObjectForKey:v67];

      v68 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v69 = v179 = v21;
        [v17 summary];
        v71 = v70 = v14;
        v72 = [v64 summary];
        *buf = 138544130;
        v201 = v69;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v71;
        v206 = 2114;
        v207 = v72;
        _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsBySelector | withVersionSelector:%{public}@ | autoJobBySelector:%{public}@", buf, 0x2Au);

        v14 = v70;
        v21 = v179;
        self = v194;
      }

      v20 = v65;
      v13 = v49;
    }
  }

  if (v20)
  {
    v73 = [(MADAutoAssetControlManager *)self currentJobBySelector:v20];
    if (v73)
    {
      v74 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      v75 = v20;
      v76 = [(MADAutoAssetControlManager *)self jobSelectorKey:v20];
      [v74 removeObjectForKey:v76];

      v77 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v77, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v79 = v78 = v21;
        [v75 summary];
        v81 = v80 = v14;
        v82 = [v73 summary];
        *buf = 138544130;
        v201 = v79;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v81;
        v206 = 2114;
        v207 = v82;
        _os_log_impl(&dword_0, v77, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsBySelector | withoutVersionSelector:%{public}@ | autoJobBySelector:%{public}@", buf, 0x2Au);

        v14 = v80;
        v21 = v78;
        self = v194;
      }

      v20 = v75;
      v13 = v49;
    }
  }

  v83 = v193;
  if (v193 && v195)
  {
    v84 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v193 byIdentifier:v195];
    if (v84)
    {
      v85 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v193 forAssetSetIdentifier:v195];
      if (v85)
      {
        v190 = v20;
        v86 = v21;
        v87 = v17;
        v88 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
        [v88 removeObjectForKey:v85];

        v89 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v89, OS_LOG_TYPE_DEFAULT))
        {
          v90 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v91 = [v84 summary];
          *buf = 138544386;
          v201 = v90;
          v202 = 2114;
          v203 = v49;
          v204 = 2114;
          v205 = v193;
          v206 = 2114;
          v207 = v195;
          v208 = 2114;
          v209 = v91;
          _os_log_impl(&dword_0, v89, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentSetJobsByIdentifier | clientDomainName:%{public}@ | setJobIdentifier:%{public}@ | autoSetJob:%{public}@", buf, 0x34u);
        }

        v17 = v87;
        v21 = v86;
        v20 = v190;
        v13 = v49;
      }
    }

    v83 = v193;
  }
}

- (void)removeCurrentSetJob:(id)a3 schedulerInvolved:(BOOL)a4 potentialNetworkFailure:(BOOL)a5 fromLocation:(id)a6 historyOperation:(int64_t)a7
{
  v132 = a5;
  v8 = a4;
  v10 = a3;
  v11 = a6;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [v10 autoAssetJobID];
  v15 = [[NSString alloc] initWithFormat:@"%@:removeCurrentSetJob", v11];
  v16 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if (!v14)
  {
    v14 = [v10 autoAssetUUID];
    if (v14)
    {
      v17 = [v10 autoAssetUUID];
      [v16 appendFormat:@"alternate eventInfo.autoAssetUUID:%@|", v17];
    }

    else
    {
      [v16 appendString:@"eventInfo.autoAssetUUID:N|"];
    }
  }

  v136 = v8;
  v18 = [v10 fromAutoAssetJob];
  v19 = [v18 clientDomainName];

  v20 = [v10 fromAutoAssetJob];
  v21 = [v20 autoAssetSetIdentifier];

  v137 = [v10 setJobInformation];
  v139 = [v137 setDescriptor];
  v22 = [(MADAutoAssetControlManager *)self currentJobByUUID:v14 fromLocation:v15 notFoundCode:0 notFoundReason:0];
  v23 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v19 byIdentifier:v21];
  v138 = v19;
  v24 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v19 byIdentifier:v21];
  v141 = v22;
  if (v22)
  {
    v25 = [v22 summary];
    [v16 appendFormat:@"autoJobByUUID:%@|", v25];

    if (v23)
    {
LABEL_7:
      v26 = [v23 summary];
      [v16 appendFormat:@"autoJobByIdentifier:%@|", v26];

      goto LABEL_10;
    }
  }

  else
  {
    [v16 appendFormat:@"autoJobByUUID:%@|", @"N"];
    if (v23)
    {
      goto LABEL_7;
    }
  }

  [v16 appendFormat:@"autoJobByIdentifier:%@|", @"N"];
LABEL_10:
  if (v24)
  {
    v27 = [v24 summary];
    [v16 appendFormat:@"cancelingSetJob:%@|", v27];
  }

  else
  {
    [v16 appendFormat:@"cancelingSetJob:%@|", @"N"];
    if (!(v141 | v23))
    {
      v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v29 = [v28 diag];
      v30 = v21;
      v31 = [NSString alloc];
      [v10 summary];
      v33 = v32 = v16;
      v34 = [v31 initWithFormat:@"{%@} | job finished that was not tracked by UUID or by set-identifier | removalFlow:%@ | eventInfo:%@", v15, v32, v33];
      [v29 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v34 withResult:6110 withError:0];

      v21 = v30;
      v16 = v32;

      v35 = v138;
      goto LABEL_30;
    }
  }

  v36 = v141;
  if ([v141 clientRequestCount] > 0 || objc_msgSend(v23, "clientRequestCount") > 0 || objc_msgSend(v24, "clientRequestCount") >= 1)
  {
    v37 = v21;
    [v16 appendFormat:@"clientRequestCount(autoJobByUUID:%ld, autoJobByIdentifier:%ld, cancelingSetJob:%ld)|", objc_msgSend(v141, "clientRequestCount"), objc_msgSend(v23, "clientRequestCount"), objc_msgSend(v24, "clientRequestCount")];
    if (v136)
    {
      [v16 appendString:@"schedulerInvolved|"];
      if (!v141)
      {
        if (!v23)
        {
          goto LABEL_27;
        }

        [v23 setEarlierSchedulerInvolved:1];
        if (!v132)
        {
          goto LABEL_27;
        }

        goto LABEL_24;
      }

      [v141 setEarlierSchedulerInvolved:1];
      if (!v132)
      {
        if (v23)
        {
          [v23 setEarlierSchedulerInvolved:1];
        }

        goto LABEL_27;
      }

      [v141 setEarlierPotentialNetworkFailure:1];
      if (v23)
      {
        [v23 setEarlierSchedulerInvolved:1];
LABEL_24:
        [v23 setEarlierPotentialNetworkFailure:1];
      }
    }

LABEL_27:
    v38 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
    {
      v39 = [v10 summary];
      *buf = 138543874;
      v148 = v15;
      v149 = 2114;
      v150 = v16;
      v151 = 2114;
      v152 = v39;
      _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {%{public}@:removeCurrentSetJob} set-job indicated removal but has more to do | removalFlow:%{public}@ | eventInfo:%{public}@", buf, 0x20u);
    }

    v35 = v138;
    v21 = v37;
    goto LABEL_30;
  }

  v140 = self;
  if (v21)
  {
    *&v131 = v24;
    *(&v131 + 1) = v23;
    v35 = v138;
LABEL_43:
    v44 = v36;
    if (v36)
    {
LABEL_44:
      v45 = @"byUUID autoSetJob(%@)|";
LABEL_51:
      v130 = v44;
      v46 = [v44 summary];
      [v16 appendFormat:v45, v46];

      if (v21)
      {
        v47 = [v10 setJobInformation];
        v48 = [v47 currentSetStatus];

        if (v48)
        {
          v49 = [v10 clientRequest];
          v50 = [v49 responseMessage];
          v51 = [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v15 forClientDomain:v35 forAssetSetIdentifier:v21 forJobResponse:v50 withResponseError:0 clearingDownloadProgressReason:@"removing current set-job" withAssetSetStatus:0];

          [v16 appendString:@"updateAutoAssetSetStatus|"];
        }
      }

      [(MADAutoAssetControlManager *)self atomicInstanceRemovedSetJob:v130 removingForReason:v15 historyOperation:a7];
      if (v14 && v141)
      {
        v52 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
        [v52 removeObjectForKey:v14];

        [v16 appendFormat:@"removed from currentJobsByUUID(%@)|", v14];
      }

      v53 = v139;
      v129 = v21;
      if (v21 && v131 != 0)
      {
        v54 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v35 forAssetSetIdentifier:v21];
        if (v54)
        {
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            [(MADAutoAssetControlManager *)self notifyCompletionCallbacksForSetJobKey:v54];
            [v16 appendFormat:@"SUSPEND_RESUME callbacks(%@)|", v54];
          }

          v125 = v54;
          if (*(&v131 + 1))
          {
            v55 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
            [v55 removeObjectForKey:v125];

            v54 = v125;
            [v16 appendFormat:@"removed from currentSetJobsByIdentifier(%@)|", v125];
          }

          if (v131)
          {
            v122 = v10;
            v56 = v15;
            v120 = v14;
            v121 = v11;
            v57 = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
            v58 = v54;
            v59 = v57;
            [v57 removeObjectForKey:v58];

            v144 = 0u;
            v145 = 0u;
            v142 = 0u;
            v143 = 0u;
            v60 = [v131 queuedRequestsForNewJobOnceCanceled];
            v61 = [v60 countByEnumeratingWithState:&v142 objects:v157 count:16];
            if (v61)
            {
              v62 = v61;
              v63 = *v143;
              do
              {
                for (i = 0; i != v62; i = i + 1)
                {
                  if (*v143 != v63)
                  {
                    objc_enumerationMutation(v60);
                  }

                  v65 = *(*(&v142 + 1) + 8 * i);
                  v66 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v66, OS_LOG_TYPE_DEFAULT))
                  {
                    v67 = [v65 summary];
                    *buf = 138543618;
                    v148 = v56;
                    v149 = 2114;
                    v150 = v67;
                    _os_log_impl(&dword_0, v66, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] triggering client-request that had been waiting for set-job canceled | nextHadBeenQueued:%{public}@", buf, 0x16u);
                  }

                  v68 = [(MADAutoAssetControlManager *)v140 autoControlManagerFSM];
                  [v68 postEvent:@"ClientRequest" withInfo:v65];
                }

                v62 = [v60 countByEnumeratingWithState:&v142 objects:v157 count:16];
              }

              while (v62);
            }

            [v131 setQueuedRequestsForNewJobOnceCanceled:0];
            v54 = v125;
            [v16 appendFormat:@"removed from cancelingSetJobsByIdentifier(%@)|", v125];
            v11 = v121;
            v10 = v122;
            v14 = v120;
            v15 = v56;
            v35 = v138;
            v53 = v139;
            v21 = v129;
            self = v140;
          }
        }

        else
        {
          [v16 appendString:@"nil setJobKey|"];
        }
      }

      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByClientDomain:v35 forAssetSetIdentifier:v21 fromLocation:v15];
      v69 = [v53 discoveredAtomicInstance];

      if (v69)
      {
        v70 = [v53 discoveredAtomicInstance];
        [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:v70];

        v71 = [v53 discoveredAtomicInstance];
        [v16 appendFormat:@"removed discovered(%@)|", v71];
      }

      v72 = [v53 latestDownloadedAtomicInstance];
      if (v72)
      {
        v73 = v72;
        v74 = [v53 latestDownloadedAtomicInstance];
        [v53 discoveredAtomicInstance];
        v76 = v75 = v16;
        v134 = [SUCore stringIsEqual:v74 to:v76];

        v16 = v75;
        v21 = v129;

        if ((v134 & 1) == 0)
        {
          v77 = [v53 latestDownloadedAtomicInstance];
          [(MADAutoAssetControlManager *)v140 removeSetDescriptorActiveJobByAtomicInstanceUUID:v77];

          v78 = [v53 latestDownloadedAtomicInstance];
          [v75 appendFormat:@"removed latest(%@)|", v78];
        }
      }

      v135 = 0;
      if (v21 && v35)
      {
        v79 = [[MAAutoAssetSelector alloc] initForAssetType:v35 withAssetSpecifier:v21];
        if (!v79)
        {
          v135 = 0;
          goto LABEL_100;
        }

        v80 = v79;
        v81 = v21;
        v82 = [(MADAutoAssetControlManager *)v140 activelyEliminatingSelectors];
        v135 = v80;
        v83 = [v80 persistedEntryID];
        v84 = [v82 safeObjectForKey:v83 ofClass:objc_opt_class()];

        if (v14 && v84)
        {
          v85 = [v84 activeJobsByUUID];
          v86 = [v85 safeObjectForKey:v14 ofClass:objc_opt_class()];

          if (v86)
          {
            v21 = v81;
            if ([SUCore stringIsEqual:v86 to:v14])
            {
              v87 = [v84 activeJobsByUUID];
              [v87 removeObjectForKey:v86];

              [v16 appendFormat:@"removed eliminatorTrackedJobUUID(%@)|", v86, v119];
            }

            else
            {
              [v16 appendFormat:@"eliminatorTrackedJobUUID(%@) != autoAssetJobUUID(%@)|", v86, v14];
            }
          }

          else
          {
            v89 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v89, OS_LOG_TYPE_DEFAULT))
            {
              v90 = [v84 summary];
              *buf = 138544386;
              v148 = v15;
              v149 = 2114;
              v150 = v138;
              v151 = 2114;
              v152 = v81;
              v153 = 2114;
              v154 = v14;
              v155 = 2114;
              v156 = v90;
              _os_log_impl(&dword_0, v89, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@:removeCurrentSetJob} no active job for clientDomainName:%{public}@ | setJobIdentifier:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x34u);
            }

            [v16 appendString:@"nil eliminatorTrackedJobUUID|"];
            v21 = v81;
          }

          v88 = v140;

          v35 = v138;
          goto LABEL_99;
        }

        v21 = v81;
        v88 = v140;
        if (v84)
        {
LABEL_99:
          [(MADAutoAssetControlManager *)v88 _eliminateCompleteIfAllDone:v84];
          v91 = [v84 summary];
          [v16 appendFormat:@"eliminateTracker(%@)|", v91];
        }
      }

LABEL_100:
      v92 = v136;
      v93 = v132;
      if (v141)
      {
        v92 = [v141 earlierSchedulerInvolved] | v136;
        v93 = [v141 earlierPotentialNetworkFailure] | v132;
      }

      if (*(&v131 + 1))
      {
        v126 = v93;
        v94 = v92 | [*(&v131 + 1) earlierSchedulerInvolved];
        v95 = [*(&v131 + 1) earlierPotentialNetworkFailure];
        self = v140;
        if (v94)
        {
          v93 = v126 | v95;
LABEL_106:
          v127 = v93;
          [v16 appendString:@"overallInvolvedScheduler|"];
          if (v127)
          {
            v124 = v16;
            v96 = [MAAutoAssetError buildError:6401 fromOperation:v15 underlyingError:0 withDescription:@"auto-asset-scheduler involved set-job finished with potential network-connectivity failure"];
            v97 = [v139 clientDomainName];
            v98 = [v139 assetSetIdentifier];
            v99 = [v139 discoveredAtomicInstance];
            v123 = v96;
            [MADAutoAssetHistory recordFailedOperation:504 fromLayer:1 forClientDomainName:v97 forAssetSetIdentifier:v98 forAtomicInstance:v99 failingWithError:v96];

            if (+[MAAIRBEventReporter isAvailable])
            {
              v100 = [MAAIRBMobileAssetOperationMetadata alloc];
              v101 = [MADAutoAssetHistoryTracker operationName:504];
              v102 = [(MAAIRBMobileAssetOperationMetadata *)v100 initWithCode:504 name:v101];

              v103 = [MAAIRBMobileAssetAtomicInstance alloc];
              v104 = [MAAIRBMobileAssetAssetSet alloc];
              v105 = [v139 assetSetIdentifier];
              v106 = [(MAAIRBMobileAssetAssetSet *)v104 initWithAssetSetIdentifier:v105];
              [v139 discoveredAtomicInstance];
              v107 = v15;
              v109 = v108 = v14;
              v110 = [(MAAIRBMobileAssetAtomicInstance *)v103 initWithAssetSet:v106 atomicInstanceId:v109];

              v14 = v108;
              v15 = v107;
              v35 = v138;

              v111 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v102 atomicInstance:v110 assetCount:0];
              v112 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
              v146 = v123;
              v113 = [NSArray arrayWithObjects:&v146 count:1];
              v114 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v112 initWithErrors:v113 type:v111];

              [MAAIRBEventReporter emitAppleIntelligenceEvent:v114];
            }

            v16 = v124;
            [v124 appendString:@"overallPotentialNetworkFailure|"];

            v21 = v129;
            self = v140;
          }

          if (v35 && v21)
          {
            [MADAutoAssetScheduler jobFinishedForSetDomainName:v35 forAssetSetIdentifier:v21 withPotentialNetworkFailure:?];
            [v16 appendString:@"jobFinished|"];
          }
        }
      }

      else
      {
        self = v140;
        if (v92)
        {
          goto LABEL_106;
        }
      }

      v115 = [(MADAutoAssetControlManager *)self statistics];
      v116 = v115;
      if (v136)
      {
        if (v132)
        {
          [v115 setFinishedJobSchedulerNetworkFailure:{objc_msgSend(v115, "finishedJobSchedulerNetworkFailure") + 1}];
        }

        else
        {
          [v115 setFinishedJobSchedulerNotNetworkRelated:{objc_msgSend(v115, "finishedJobSchedulerNotNetworkRelated") + 1}];
        }
      }

      else if (v132)
      {
        [v115 setFinishedJobClientNetworkFailure:{objc_msgSend(v115, "finishedJobClientNetworkFailure") + 1}];
      }

      else
      {
        [v115 setFinishedJobClientNotNetworkRelated:{objc_msgSend(v115, "finishedJobClientNotNetworkRelated") + 1}];
      }

      goto LABEL_121;
    }

    if (*(&v131 + 1))
    {
      v44 = *(&v131 + 1);
      v45 = @"byIdentifier autoSetJob from autoJobByIdentifier(%@)|";
      *(&v131 + 1) = v44;
      goto LABEL_51;
    }

    goto LABEL_49;
  }

  v40 = [v141 autoAssetSetIdentifier];
  *(&v131 + 1) = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v138 byIdentifier:v40];

  v35 = v138;
  *&v131 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v138 byIdentifier:v40];

  v128 = v40;
  if (!v40)
  {
    v40 = @"N";
  }

  if (*(&v131 + 1))
  {
    v41 = *(&v131 + 1);
    v42 = [*(&v131 + 1) summary];
  }

  else
  {
    v41 = 0;
    v42 = @"N";
  }

  if (v131)
  {
    v43 = [v131 summary];
    [v16 appendFormat:@"from autoJobByUUID(setJobIdentifier:%@, autoJobByIdentifier:%@, cancelingSetJob:%@)|", v40, v42, v43];
  }

  else
  {
    [v16 appendFormat:@"from autoJobByUUID(setJobIdentifier:%@, autoJobByIdentifier:%@, cancelingSetJob:%@)|", v40, v42, @"N"];
  }

  v21 = v128;
  if (v41)
  {

    self = v140;
    v36 = v141;
    goto LABEL_43;
  }

  v44 = v141;
  self = v140;
  if (v141)
  {
    *(&v131 + 1) = 0;
    goto LABEL_44;
  }

LABEL_49:
  v44 = v131;
  if (v44)
  {
    v131 = v44;
    v45 = @"byIdentifier autoSetJob from cancelingSetJob(%@)|";
    goto LABEL_51;
  }

  [v16 appendFormat:@"byIdentifier autoSetJob from cancelingSetJob(%@)|", @"N"];
  [v16 appendString:@"NO_JOB_FOUND|"];
LABEL_121:
  v117 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v117, OS_LOG_TYPE_DEFAULT))
  {
    v118 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543618;
    v148 = v118;
    v149 = 2114;
    v150 = v16;
    _os_log_impl(&dword_0, v117, OS_LOG_TYPE_DEFAULT, "[%{public}@] {removeCurrentSetJob} | removalFlow:%{public}@", buf, 0x16u);
  }

LABEL_30:
}

- (void)decrementClientRequestCount:(id)a3 forEventInfo:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:decrementClientRequestCount", v7];
  v11 = [v6 fromAutoAssetJob];

  if (v11)
  {
    v12 = [v6 fromAutoAssetJob];
    if ([v12 clientRequestCount] < 1)
    {
      goto LABEL_18;
    }

    [v12 setClientRequestCount:{objc_msgSend(v12, "clientRequestCount") - 1}];
    if ([v12 clientRequestCount] > 0)
    {
      goto LABEL_18;
    }

    v13 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    v14 = [v6 autoAssetUUID];
    v15 = [v13 safeObjectForKey:v14 ofClass:objc_opt_class()];

    if (v15)
    {
      v16 = [v15 clientDomainName];
      [v15 autoAssetSetIdentifier];
    }

    else
    {
      v16 = [v6 clientDomainName];
      [v6 assetSetIdentifier];
    }
    v17 = ;
    v18 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v16 forAssetSetIdentifier:v17];
    if (!v18)
    {
LABEL_17:

LABEL_18:
      goto LABEL_19;
    }

    v19 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v16 byIdentifier:v17];
    v20 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v16 byIdentifier:v17];
    if (v19)
    {
      v21 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
      [v21 removeObjectForKey:v18];
LABEL_16:

      goto LABEL_17;
    }

    v21 = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
    if (v20)
    {
      if (!v22)
      {
        goto LABEL_16;
      }

      v24 = [v20 summary];
      *buf = 138543618;
      v26 = v10;
      v27 = 2114;
      v28 = v24;
      v23 = "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | last client-request has completed for set-job that is being canceled - still awaiting job finished | cancelingSetJob:%{public}@";
    }

    else
    {
      if (!v22)
      {
        goto LABEL_16;
      }

      v24 = [v6 summary];
      *buf = 138543618;
      v26 = v10;
      v27 = 2114;
      v28 = v24;
      v23 = "{%{public}@}\n[SET_CLIENT_REQUESTS_LATE_COALESCE] | last client-request has completed for set-job that is not active and not being canceled - late-coalesce | eventInfo:%{public}@";
    }

    _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, v23, buf, 0x16u);

    goto LABEL_16;
  }

LABEL_19:
}

- (id)currentJobBySelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v8 = [(MADAutoAssetControlManager *)self jobSelectorKey:v4];

  v9 = [v7 safeObjectForKey:v8 ofClass:objc_opt_class()];

  return v9;
}

- (id)currentJobByUUID:(id)a3 fromLocation:(id)a4 notFoundCode:(int64_t)a5 notFoundReason:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a6;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  if (v15 && (v16 = v15, [(MADAutoAssetControlManager *)self stagerCurrentJobUUID], v17 = objc_claimAutoreleasedReturnValue(), v18 = [SUCore stringIsEqual:v10 to:v17], v17, v16, v18))
  {
    v19 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  }

  else
  {
    v20 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    v19 = [v20 safeObjectForKey:v10 ofClass:objc_opt_class()];

    if (a5 && !v19)
    {
      v21 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v22 = [v21 diag];
      v23 = [[NSString alloc] initWithFormat:@"AUTO-CONTROL{%@} | %@", v11, v12];
      [v22 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:a5 withError:0];

      v19 = 0;
    }
  }

  return v19;
}

- (id)currentJobByUUID:(id)a3 potentiallyResumingJob:(id)a4 withOriginalSelector:(id)a5 fromLocation:(id)a6 notFoundCode:(int64_t)a7 notFoundReason:(id)a8 downloadingDescriptor:(id)a9 baseForPatchDescriptor:(id)a10
{
  v14 = a3;
  v15 = a4;
  v16 = v14;
  v17 = v15;
  v18 = a5;
  v19 = a6;
  v20 = a9;
  v21 = a10;
  v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v23 = [v22 extendedStateQueue];
  dispatch_assert_queue_V2(v23);

  v24 = [(MADAutoAssetControlManager *)self currentJobByUUID:v16 fromLocation:v19 notFoundCode:0 notFoundReason:0];
  if (v24)
  {
    v25 = v24;
    if ([v24 autoAssetSetJob])
    {
      goto LABEL_50;
    }

    v66 = v21;
    v26 = v17 != 0;
    if (v18)
    {
LABEL_27:
      v65 = v17;
      v35 = 0;
      v36 = 1;
      goto LABEL_28;
    }

    v18 = [v25 autoAssetSelector];
    if (!v17)
    {
LABEL_26:
      if (!v18)
      {
        v55 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v56 = [v55 diag];
        v57 = [NSString alloc];
        v58 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v59 = [v57 initWithFormat:@"{%@:currentJobByUUID} unable to determine originalSelector | %@", v19, v58];
        [v56 trackAnomaly:@"AUTO-CONTROL" forReason:v59 withResult:6101 withError:0];

        v18 = 0;
        v35 = 0;
        v21 = v66;
LABEL_49:

        goto LABEL_50;
      }

      goto LABEL_27;
    }

LABEL_24:
    if (!v18)
    {
      v18 = [v17 autoAssetSelector];
    }

    goto LABEL_26;
  }

  v66 = v21;
  v26 = v17 != 0;
  if (!v17 || ![v17 autoAssetSetJob])
  {
    if (!v18)
    {
      v25 = 0;
      if (!v17)
      {
        goto LABEL_26;
      }

      goto LABEL_24;
    }

    v34 = [(MADAutoAssetControlManager *)self currentJobBySelector:v18];
    v25 = v34;
    v35 = 0;
    v36 = 1;
    v65 = v17;
    if (!v17 || !v34)
    {
LABEL_28:
      v45 = [v18 assetVersion];
      v46 = v45;
      if (v20 && !v45)
      {
        v47 = [v20 assetType];
        if (!v47)
        {
LABEL_36:
          v53 = !v26;
          if (v25)
          {
            v53 = 1;
          }

          v17 = v65;
          if (v53)
          {
            if (v25)
            {
              v54 = v36;
            }

            else
            {
              v54 = 0;
            }

            v21 = v66;
            if (v20)
            {
              if (v54)
              {
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:@"currentJobByUUID"];
                [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_MODIFY" usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"originalSelector for auto-asset-job refreshed"];
                if (v35)
                {
                  [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_MODIFY" usingSelector:v35 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"fullAssetSelector for auto-asset-job refreshed"];
                }
              }
            }
          }

          else
          {
            v25 = v65;
            v21 = v66;
            [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:v19];
            [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_ADD" usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"originalSelector for auto-asset-job resumed"];
            if (v35)
            {
              [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_ADD" usingSelector:v35 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"fullAssetSelector for auto-asset-job resumed"];
            }
          }

          goto LABEL_49;
        }

        v46 = v47;
        v64 = v36;
        v48 = [v20 assetSpecifier];
        if (v48)
        {
          v49 = v48;
          v63 = v16;
          v50 = [v20 assetVersion];

          if (!v50)
          {
            v16 = v63;
            v36 = v64;
            goto LABEL_36;
          }

          v61 = [MAAutoAssetSelector alloc];
          v46 = [v20 assetType];
          v51 = [v20 assetSpecifier];
          v52 = [v20 assetVersion];
          v62 = [v61 initForAssetType:v46 withAssetSpecifier:v51 matchingAssetVersion:v52];

          v35 = v62;
          v16 = v63;
        }

        v36 = v64;
      }

      goto LABEL_36;
    }

    v37 = [v18 assetVersion];
    if (!v20 || v37)
    {
    }

    else
    {
      v35 = [v20 assetType];
      if (!v35)
      {
LABEL_55:
        [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:v19];
        [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_MODIFY" usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"originalSelector reachable by UUID as well as by selector"];
        [(MADAutoAssetControlManager *)self _refreshEliminate:v18 withJobUUID:v16];
        v36 = 0;
        v26 = 1;
        goto LABEL_28;
      }

      v38 = [v20 assetSpecifier];
      if (v38)
      {
        v39 = v38;
        v40 = [v20 assetVersion];

        if (v40)
        {
          v41 = [MAAutoAssetSelector alloc];
          v42 = [v20 assetType];
          v43 = [v20 assetSpecifier];
          v44 = [v20 assetVersion];
          v35 = [v41 initForAssetType:v42 withAssetSpecifier:v43 matchingAssetVersion:v44];

          [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_MODIFY" usingSelector:v35 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 message:@"fullAssetSelector reachable by UUID as well as by selector"];
          goto LABEL_55;
        }
      }

      else
      {
      }
    }

    v35 = 0;
    goto LABEL_55;
  }

  v27 = v17;
  v25 = v17;
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    v28 = [v25 clientDomainName];
    v29 = [v25 autoAssetSetIdentifier];
    v30 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:v28 forAssetSetIdentifier:v29];

    if (v30)
    {
      v31 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
      {
        v32 = [v25 clientDomainName];
        v33 = [v25 autoAssetSetIdentifier];
        *buf = 138543618;
        v68 = v32;
        v69 = 2114;
        v70 = v33;
        _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "{currentJobByUUID} unexpected resume of suspended set. | clientDomainName:%{public}@ forAssetSetIdentifier:%{public}@", buf, 0x16u);
      }
    }
  }

  [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:v18 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:v20 baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:v19];
  v17 = v27;
  v21 = v66;
LABEL_50:

  return v25;
}

- (void)setJobIndicationOfPotentialLatestToVend:(id)a3 forEventInfo:(id)a4 issuingClientReply:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = a4;
  v232 = v8;
  v10 = [[NSString alloc] initWithFormat:@"%@:setJobIndicationOfPotentialLatestToVend", v8];
  v11 = [v9 setJobInformation];
  v12 = [v11 clientInstance];
  v241 = [v11 clientDesire];
  v251 = v9;
  v13 = [v9 responseError];
  v247 = v10;
  v230 = v5;
  if (v5)
  {
    v14 = [v9 clientRequest];
    v15 = [v14 clientRequestMessage];
    v243 = [MADAutoAssetControlManager replyMessageNameForRequest:v15];

    v10 = v247;
    v244 = objc_alloc_init(NSMutableDictionary);
  }

  else
  {
    v243 = 0;
    v244 = 0;
  }

  v16 = [v11 assignedAutoAssetUUID];
  v17 = [v11 setDescriptor];
  v18 = [v9 clientDomainName];
  v19 = [v251 assetSetIdentifier];
  v242 = [[NSMutableString alloc] initWithString:@"modified"];
  v253 = 9999;
  v252 = 0;
  if (!v13)
  {
LABEL_8:
    v246 = [(MADAutoAssetControlManager *)self currentSetStatusFromJobInformation:v11];
    goto LABEL_10;
  }

  v20 = v17;
  v21 = v11;
  v22 = self;
  v23 = v16;
  v24 = v19;
  v25 = v18;
  v26 = [v13 domain];
  if (([SUCore stringIsEqual:v26 to:@"com.apple.MobileAssetError.AutoAsset"]& 1) != 0)
  {
    v27 = [v13 code];

    v28 = v27 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect";
    v18 = v25;
    v19 = v24;
    v16 = v23;
    v10 = v247;
    self = v22;
    v11 = v21;
    v17 = v20;
    if (!v28)
    {
      v246 = 0;
      goto LABEL_10;
    }

    goto LABEL_8;
  }

  v246 = 0;
  v18 = v25;
  v19 = v24;
  v16 = v23;
  v10 = v247;
  self = v22;
  v11 = v21;
  v17 = v20;
LABEL_10:
  v29 = [(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:v10 forSetDescriptor:v17];
  if (!v18)
  {
    v30 = v12;
    if (v12 || (v30 = v246) != 0)
    {
      v18 = [v30 clientDomainName];
    }

    else
    {
      v18 = @"Unknown";
    }
  }

  v235 = v12;
  v248 = self;
  v240 = v17;
  v245 = v18;
  if (!v19)
  {
    v31 = v12;
    if (!v12)
    {
      v31 = v246;
      if (!v246)
      {
        v19 = 0;
        v32 = 0;
        v238 = v18 != 0;
        if (!v13)
        {
          goto LABEL_30;
        }

LABEL_27:
        v37 = [v13 domain];
        if (([SUCore stringIsEqual:v37 to:@"com.apple.MobileAssetError.AutoAsset"]& 1) == 0)
        {
          v250 = v13;

          v224 = 0;
          LOBYTE(v229) = 0;
          v51 = 0;
          v52 = 1;
          v10 = v247;
LABEL_44:
          p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
          if (!v16)
          {
            goto LABEL_47;
          }

          goto LABEL_45;
        }

        v38 = [v13 code];

        v28 = v38 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect";
        v10 = v247;
        if (!v28)
        {
          v250 = v13;
          v224 = 0;
          LOBYTE(v229) = 0;
          v51 = 0;
          v52 = 1;
          goto LABEL_44;
        }

LABEL_30:
        v39 = [MAAutoAssetError buildError:6103 fromOperation:v10 underlyingError:0 withDescription:@"set-configuration has been eliminated"];

        v224 = 0;
        LOBYTE(v229) = 0;
        v51 = 0;
        v52 = 1;
        v250 = v39;
        goto LABEL_44;
      }
    }

    v19 = [v31 assetSetIdentifier];
  }

  v228 = v29;
  v238 = v18 != 0;
  v32 = v19 != 0;
  if (!v18 || !v19)
  {
LABEL_26:
    if (!v13)
    {
      goto LABEL_30;
    }

    goto LABEL_27;
  }

  v33 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v18 forAssetSetIdentifier:v19];
  if (!v33)
  {
    v238 = 1;
    v32 = 1;
    goto LABEL_26;
  }

  v233 = v19;
  v236 = v33;
  if (v13)
  {
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v18 = [v13 domain];
    if (!+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v18, @"com.apple.MobileAssetError.AutoAsset") || [v13 code] != "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
    {

      goto LABEL_37;
    }

    v35 = v10;
    v36 = v16;
  }

  else
  {
    v35 = v10;
    v36 = v16;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  }

  v40 = v11;
  v41 = [v11 foundContent];
  v42 = [v41 currentSetStatus];
  v43 = [v42 latestDowloadedAtomicInstanceEntries];
  v44 = [v43 count];

  if (v13)
  {
  }

  v11 = v40;
  v16 = v36;
  v10 = v35;
  v51 = v236;
  if (!v44)
  {
    v93 = [MAAutoAssetError buildError:6110 fromOperation:v35 underlyingError:0 withDescription:@"set-job completed with 0 entries"];

    v224 = 0;
    LOBYTE(v229) = 0;
    v52 = 0;
    v32 = 1;
    v250 = v93;
    v238 = 1;
    v19 = v233;
    if (!v16)
    {
      goto LABEL_47;
    }

    goto LABEL_45;
  }

LABEL_37:
  v45 = [v13 domain];
  v249 = v13;
  if (![SUCore stringIsEqual:v45 to:@"com.apple.MobileAssetError.AutoAsset"])
  {
    v47 = v11;

    goto LABEL_76;
  }

  v46 = [v13 code];

  if (v46 != "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
  {
    v47 = v11;
LABEL_76:
    v48 = 0;
    v49 = 0;
    v50 = 0;
    if (!v16)
    {
      goto LABEL_120;
    }

    goto LABEL_77;
  }

  if (!v243)
  {
    v47 = v11;
LABEL_119:
    v48 = 0;
    v49 = 1;
    v50 = 1;
    if (!v16)
    {
      goto LABEL_120;
    }

LABEL_77:
    v19 = v233;
    goto LABEL_125;
  }

  v47 = v11;
  if (([SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"]& 1) != 0)
  {
    goto LABEL_119;
  }

  v48 = [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
  v49 = 0;
  v50 = v48;
  if (v16)
  {
    goto LABEL_77;
  }

LABEL_120:
  v122 = [v251 autoAssetUUID];

  v19 = v233;
  if (v122)
  {
    v16 = [v251 autoAssetUUID];
    v123 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v123, OS_LOG_TYPE_DEFAULT))
    {
      v124 = [v251 summary];
      *buf = 138543618;
      v256 = v10;
      v257 = 2114;
      v258 = v124;
      _os_log_impl(&dword_0, v123, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with no assigned UUID - using event information | eventInfo:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    v125 = [(MADAutoAssetControlManager *)v248 autoControlManagerFSM];
    v126 = [v125 diag];
    v127 = [NSString alloc];
    v128 = [v251 summary];
    v129 = [v127 initWithFormat:@"{%@} set-job with no assigned UUID and no eventInfo.autoAssetUUID | eventInfo:%@", v10, v128];
    [v126 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v129 withResult:6108 withError:0];

    v19 = v233;
    v130 = [MAAutoAssetError buildError:6103 fromOperation:v10 underlyingError:0 withDescription:@"unable to service finished set-job [set-job with no assigned UUID and no eventInfo.autoAssetUUID]"];

    v50 = 0;
    v16 = 0;
    v249 = v130;
  }

LABEL_125:
  if (v249)
  {
    LOBYTE(v131) = v48 | v49;
  }

  else
  {
    v131 = v48 | v49 | [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
  }

  if (v228 & 1 | ((v131 & 1) == 0))
  {
    v229 = 0;
  }

  else
  {
    v229 = [(MADAutoAssetControlManager *)v248 setJobFoundAllContent:v10 forJobAtomicInstance:v16 withCurrentSetStatus:v246];
  }

  v11 = v47;
  v132 = [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"];
  v133 = 0;
  v51 = v236;
  if (v132 && v241)
  {
    if ([v241 awaitDownloadingOfDiscovered])
    {
      v133 = @"replying to check-atomic awaiting download of discovered";
    }

    else
    {
      v133 = 0;
    }
  }

  v224 = v133;
  v223 = v49;
  if (!v249)
  {
    v239 = 0;
    v144 = 0;
    v249 = 0;
LABEL_148:
    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    goto LABEL_189;
  }

  if (!v50)
  {
    v239 = 0;
    v144 = 0;
    goto LABEL_148;
  }

  v134 = [(MADAutoAssetControlManager *)v248 locateSetDescriptor:v10 forAtomicInstanceUUID:v16 requireExists:0];
  [v236 setDiscoveredInFlightAtomicInstance:0];
  [v242 appendString:{@", cleared discovered-in-flight"}];
  v135 = [v236 autoAssetEntries];
  v136 = [(MADAutoAssetControlManager *)v248 doesSetDescriptor:v240 coverRequestedAutoAssetEntries:v135];

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  if (!v136)
  {
    v239 = 0;
    v144 = 1;
    goto LABEL_150;
  }

  v137 = [v236 latestAtomicInstanceToVend];
  v138 = [(MADAutoAssetControlManager *)v248 locateSetAtomicInstanceByInstanceUUID:v137];

  v220 = v138;
  if (!v138)
  {
    if (!v134)
    {
      if (((v240 != 0) & v229) != 0)
      {
        v226 = v16;
        v159 = v240;

        [(MADAutoAssetControlManager *)v248 setConfigurationPersist:v236 fromLocation:v10 forReason:v242 dueToAlter:0 forHistoryOperation:v253];
        v160 = v10;
        v161 = [[NSMutableString alloc] initWithString:@"modified"];

        v253 = 9999;
        v162 = [v159 isDiscoveredFullyDownloaded];
        v163 = [v159 discoveredAtomicInstance];
        v164 = [v159 isDiscoveredFullyDownloaded];
        LOBYTE(v218) = 0;
        BYTE2(v217) = [v159 isDiscoveredFullyDownloaded];
        BYTE1(v217) = v164;
        LOBYTE(v217) = 0;
        v221 = v159;
        v165 = v160;
        LODWORD(v162) = [MADAutoAssetControlManager trackSetDescriptor:v248 fromLocation:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" forLatestDownloaded:v159 forSpecificAtomicInstance:v160 withCurrentSetStatus:v162 changedWhileTerminated:v163 changedNeverBeenLocked:v246 notifyingIfJustDownloaded:0 latestToVend:v217 historyOperation:357 firstClientName:@"com.apple.MobileAsset.daemon.internal" fromPreSUStaging:v218];

        if (v162)
        {
          v166 = v161;
          v167 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v167, OS_LOG_TYPE_DEFAULT))
          {
            v168 = [v236 summary];
            *buf = 138543618;
            v256 = v165;
            v257 = 2114;
            v258 = v168;
            _os_log_impl(&dword_0, v167, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[FROM-TRACKED-LATEST-TO-VEND] same version found first-tracked as downloaded set-descriptor | setConfiguration:%{public}@", buf, 0x16u);
          }

          v249 = 0;
          v144 = 1;
          v158 = v159;
          v239 = 1;
          v242 = v166;
          v19 = v233;
          v16 = v226;
          goto LABEL_188;
        }

        v239 = 1;
        v242 = v161;
        v144 = 1;
        v16 = v226;
        v147 = v221;
        goto LABEL_178;
      }

      v239 = 0;
      v144 = 1;
LABEL_166:
      v158 = v220;
LABEL_188:

      goto LABEL_189;
    }

    v147 = v134;
    if (!v240)
    {
      v151 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v151, OS_LOG_TYPE_DEFAULT))
      {
        v169 = [v134 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v169;
        _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with no set-job descriptor yet jobAtomicInstance is already downloaded set-descriptor | setDescriptor:%{public}@", buf, 0x16u);
      }

      goto LABEL_177;
    }

    v148 = [v240 latestDownloadedAtomicInstance];
    v149 = [v134 latestDownloadedAtomicInstance];
    v150 = [SUCore stringIsEqual:v148 to:v149];

    v151 = _MADLog(@"AutoControl");
    v152 = os_log_type_enabled(v151, OS_LOG_TYPE_DEFAULT);
    if (v150)
    {
      if (v152)
      {
        v147 = v134;
        v153 = [v134 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v153;
        _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with set-job descriptor that is already a downloaded set-descriptor | setDescriptor:%{public}@", buf, 0x16u);

LABEL_177:
        v239 = 0;
        v144 = 1;
        goto LABEL_178;
      }
    }

    else if (v152)
    {
      v170 = [v240 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = v170;
      _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with set-job descriptor that is different from already downloaded set-descriptor (using already downloaded) | setJobDescriptor:%{public}@", buf, 0x16u);
    }

    v147 = v134;
    goto LABEL_177;
  }

  [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDMostRecentlyReceived:v10 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
  [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDLatestToVend:v10 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
  v139 = [v240 latestDownloadedAtomicInstance];
  v140 = [v236 latestAtomicInstanceToVend];
  v141 = [SUCore stringIsEqual:v139 to:v140];

  if (!v141)
  {
    if ([v236 vendingAtomicInstanceForConfiguredEntries])
    {
      [v236 setNewerVersionError:0];
      v144 = [(MADAutoAssetControlManager *)v248 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (already latest-to-vend)" maintainingHistoryOperation:&v253];
      v154 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v154, OS_LOG_TYPE_DEFAULT))
      {
        v155 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v155;
        _os_log_impl(&dword_0, v154, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (already latest-to-vend) | setConfiguration:%{public}@", buf, 0x16u);
      }

      v156 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v156, OS_LOG_TYPE_DEFAULT))
      {
        v157 = [v240 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v157;
        _os_log_impl(&dword_0, v156, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job found same content already latest-to-vend | setJobDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v144 = 1;
      [v236 setVendingAtomicInstanceForConfiguredEntries:1];
      [v242 appendString:{@", set vending-configured-entries"}];
      v253 = 455;
    }

    v239 = 0;
    goto LABEL_166;
  }

  v142 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v142, OS_LOG_TYPE_DEFAULT))
  {
    v143 = [v240 summary];
    *buf = 138543618;
    v256 = v247;
    v257 = 2114;
    v258 = v143;
    _os_log_impl(&dword_0, v142, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job matches latest-to-vend | setJobDescriptor:%{public}@", buf, 0x16u);
  }

  [v236 setNewerVersionError:0];
  v144 = [(MADAutoAssetControlManager *)v248 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (matches latest-to-vend)" maintainingHistoryOperation:&v253];
  v145 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v145, OS_LOG_TYPE_DEFAULT))
  {
    v146 = [v236 summary];
    *buf = 138543618;
    v256 = v247;
    v257 = 2114;
    v258 = v146;
    _os_log_impl(&dword_0, v145, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (matches latest-to-vend) | setConfiguration:%{public}@", buf, 0x16u);
  }

  v239 = 0;
  v249 = 0;
LABEL_150:
  v147 = v134;
  if (v134)
  {
LABEL_178:
    v171 = [v147 latestDownloadedAtomicInstance];
    v172 = [v236 latestAtomicInstanceToVend];
    v173 = [SUCore stringIsEqual:v171 to:v172];

    if (v173)
    {
      v158 = v147;
      v174 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v174, OS_LOG_TYPE_DEFAULT))
      {
        v175 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v175;
        _os_log_impl(&dword_0, v174, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] same version found already tracked as latest-to-vend | setConfiguration:%{public}@", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDMostRecentlyReceived:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
      [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDLatestToVend:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
    }

    else if ([(MADAutoAssetControlManager *)v248 setConfigurationAdoptLatestToVend:v247 fromSetDescriptor:v147 toSetConfiguration:v236 fromPreSUStaging:0 allowEmpty:0])
    {
      v176 = [[NSMutableString alloc] initWithString:@"modified"];

      v253 = 9999;
      v177 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v177, OS_LOG_TYPE_DEFAULT))
      {
        v178 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v178;
        _os_log_impl(&dword_0, v177, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] same version found is always latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x16u);
      }

      v249 = 0;
      v239 = 1;
      v158 = v147;
      v242 = v176;
    }

    else
    {
      [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDMostRecentlyReceived:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
      v158 = v147;
    }

    v19 = v233;
    goto LABEL_188;
  }

LABEL_189:
  v179 = [v236 availableForUseError];
  v180 = [v236 newerVersionError];
  if (v249)
  {
    v181 = v11;
    v182 = [(MADAutoAssetControlManager *)v248 _errorUnlessSameVersionFound:v249 changedReportedError:&v252];

    v183 = [v236 latestAtomicInstanceToVend];

    if (!v183)
    {
      [v236 setNewerVersionError:0];
      v190 = [NSError buildCheckedError:v182];
      [v236 setAvailableForUseError:v190];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        v191 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v191;
        v192 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job and no latest-to-vend | setConfiguration:%{public}@";
LABEL_215:
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, v192, buf, 0x16u);
      }

LABEL_216:
      v196 = v223;
LABEL_217:

      v144 = 1;
      v250 = v182;
      v11 = v181;
      v51 = v236;
      goto LABEL_218;
    }

    if (v182)
    {
      if (v179)
      {
        if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v179])
        {
          v184 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v184, OS_LOG_TYPE_DEFAULT))
          {
            v185 = [v236 summary];
            *buf = 138543618;
            v256 = v247;
            v257 = 2114;
            v258 = v185;
            _os_log_impl(&dword_0, v184, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS] latest-to-vend not accessible due to secure SMAC requiring grafting yet device locked | setConfiguration:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v197 = [(MADAutoAssetControlManager *)v248 autoControlManagerFSM];
          v198 = [v197 diag];
          v199 = [NSString alloc];
          v200 = [v179 checkedDescription];
          v201 = [v199 initWithFormat:@"set-job completed with error yet have latest-to-vend when availableForUseError | beforeAvailableForUseError:%@", v200];
          [v198 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v201 withResult:6108 withError:v179];

          v19 = v233;
          [v236 setAvailableForUseError:0];
        }
      }

      v202 = [NSError buildCheckedError:v182];
      [v236 setNewerVersionError:v202];

      v187 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_216;
      }

      v191 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = v191;
      v192 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job but have latest-to-vend | setConfiguration:%{public}@";
      goto LABEL_215;
    }

    [(MADAutoAssetControlManager *)v248 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (have latest-to-vend)" maintainingHistoryOperation:&v253];
    [v236 setNewerVersionError:0];
    v187 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v187, OS_LOG_TYPE_DEFAULT))
    {
      v188 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = v188;
      v189 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (have latest-to-vend) | setConfiguration:%{public}@";
      goto LABEL_205;
    }

    goto LABEL_206;
  }

  v186 = [v236 latestAtomicInstanceToVend];

  if (!v186)
  {
    [v236 setNewerVersionError:0];
    v193 = [v236 newerAtomicInstanceOncePersonalized];

    if (v193)
    {
      v181 = v11;
      v194 = [MAAutoAssetError buildError:6560 fromOperation:v247 underlyingError:0 withDescription:@"set-job completed successfully yet did not result in latest-to-vend (newer-once-personalized)"];
      [v236 setAvailableForUseError:v194];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        v195 = [v236 summary];
        *buf = 138543874;
        v256 = v247;
        v257 = 2114;
        v258 = @"set-job completed successfully yet did not result in latest-to-vend (newer-once-personalized)";
        v259 = 2114;
        v260 = v195;
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] %{public}@ | setConfiguration:%{public}@", buf, 0x20u);
      }

      v182 = 0;
    }

    else
    {
      v227 = v16;
      v181 = v11;
      v210 = [(MADAutoAssetControlManager *)v248 autoControlManagerFSM];
      v211 = [v210 diag];
      v212 = [NSString alloc];
      v213 = [v251 summary];
      v214 = [v212 initWithFormat:@"%@ | eventInfo:%@", @"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized", v213];
      [v211 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v214 withResult:6559 withError:0];

      v215 = [MAAutoAssetError buildError:6559 fromOperation:v247 underlyingError:0 withDescription:@"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized"];
      [v236 setAvailableForUseError:v215];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        v216 = [v236 summary];
        *buf = 138543874;
        v256 = v247;
        v257 = 2114;
        v258 = @"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized";
        v259 = 2114;
        v260 = v216;
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] %{public}@ | setConfiguration:%{public}@", buf, 0x20u);
      }

      v182 = 0;
      v19 = v233;
      v16 = v227;
    }

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    v196 = v223;
    goto LABEL_217;
  }

  if (v179 | v180)
  {
    v181 = v11;
    [(MADAutoAssetControlManager *)v248 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"successful set-job and have latest-to-vend" maintainingHistoryOperation:&v253];
    [v236 setNewerVersionError:0];
    v187 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v187, OS_LOG_TYPE_DEFAULT))
    {
      v188 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = v188;
      v189 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] successful set-job and have latest-to-vend | setConfiguration:%{public}@";
LABEL_205:
      _os_log_impl(&dword_0, v187, OS_LOG_TYPE_DEFAULT, v189, buf, 0x16u);
    }

LABEL_206:
    v182 = 0;
    goto LABEL_216;
  }

  v250 = 0;
  v196 = v223;
LABEL_218:
  if ((v196 & v229) == 1)
  {
    v203 = [v51 latestAtomicInstanceToVend];

    if (v203)
    {
      if (([v51 vendingAtomicInstanceForConfiguredEntries] & 1) == 0)
      {
        v144 = 1;
        [v51 setVendingAtomicInstanceForConfiguredEntries:1];
        [v242 appendString:{@", fixed vending-configured-entries"}];
        v253 = 456;
        v204 = [(MADAutoAssetControlManager *)v248 autoControlManagerFSM];
        v205 = [v204 diag];
        v206 = [NSString alloc];
        [v251 summary];
        v208 = v207 = v16;
        v209 = [v206 initWithFormat:@"set-job indicating same-version-found when set-configuration required fix to vendingAtomicInstanceForConfiguredEntries | eventInfo:%@", v208];
        [v205 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v209 withResult:6108 withError:0];

        v19 = v233;
        v16 = v207;
        v51 = v236;
      }
    }
  }

  if ((v239 | v144 ^ 1))
  {
    v52 = 0;
    v32 = 1;
    v238 = 1;
    v10 = v247;
    if (!v16)
    {
      goto LABEL_47;
    }
  }

  else
  {
    v10 = v247;
    [(MADAutoAssetControlManager *)v248 setConfigurationPersist:v51 fromLocation:v247 forReason:v242 dueToAlter:0 forHistoryOperation:v253];
    v52 = 0;
    v32 = 1;
    v238 = 1;
    if (!v16)
    {
      goto LABEL_47;
    }
  }

LABEL_45:
  v53 = [(MADAutoAssetControlManager *)v248 currentJobsByUUID];
  v54 = [v53 safeObjectForKey:v16 ofClass:objc_opt_class()];

  if (v54)
  {
    v55 = [v51 mostRecentlyReceivedCachedAssetSetID];
    [v54 setMostRecentlyReceivedCachedAssetSetID:v55];

    v56 = [v51 latestToVendCachedAssetSetID];
    [v54 setLatestToVendCachedAssetSetID:v56];
  }

LABEL_47:
  if (v230)
  {
    v225 = v16;
    v234 = v19;
    if (!v250)
    {
      v57 = [v11 foundContent];
      if (v252 == 1)
      {
        v58 = [(MADAutoAssetControlManager *)v248 _constructSetInfoSameFoundFrom:v57 forSetConfiguration:v51 fromSetStatus:v246];

        v57 = v58;
      }

      v64 = [v251 clientRequest];
      v65 = [(MADAutoAssetControlManager *)v248 clientRequestMessageName:v64];

      if (([p_weak_ivar_lyt[223] stringIsEqual:v65 to:@"MA-AUTO-SET:LOCK_ATOMIC"] & 1) == 0)
      {
        v66 = [v251 clientDomainName];
        v67 = [v251 assetSetIdentifier];
        v68 = [(MADAutoAssetControlManager *)v248 newSetInfoLimitedToCheckInformation:v66 forAssetSetIdentifier:v67 fromSetInfoFound:v57];

        v57 = v68;
      }

      v69 = [v11 clientInstance];
      v70 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v69];
      [v244 setSafeObject:v70 forKey:@"setInstance"];

      v71 = [MASAutoAssetSetInfoFound newShimmedToFramework:v57];
      [v244 setSafeObject:v71 forKey:@"setFound"];

      v72 = [v11 clientDesire];
      v73 = [MASAutoAssetSetInfoDesire newShimmedToFramework:v72];
      [v244 setSafeObject:v73 forKey:@"setDesire"];
    }

    v237 = v51;
    v231 = v11;
    v74 = [SUCoreConnectMessage alloc];
    v75 = [v251 clientRequest];
    v76 = [v75 clientRequestMessage];
    v77 = [MADAutoAssetControlManager replyMessageNameForRequest:v76];
    v78 = [v251 clientRequest];
    v79 = [v78 clientID];
    v80 = [v74 initWithType:2 messageName:v77 clientID:v79 version:0 message:v244];

    v222 = v32;
    v219 = v80;
    if (v80)
    {
      v81 = [v251 clientRequest];
      [v81 setResponseMessage:v80];
      v10 = v247;
    }

    else
    {
      v81 = _MADLog(@"AutoControl");
      v10 = v247;
      if (os_log_type_enabled(v81, OS_LOG_TYPE_ERROR))
      {
        v82 = [v251 clientRequest];
        v83 = [v82 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = v83;
        _os_log_impl(&dword_0, v81, OS_LOG_TYPE_ERROR, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] unable to allocate basis for response message | clientRequest:%{public}@", buf, 0x16u);
      }
    }

    v19 = v234;
    v16 = v225;

    v84 = v238;
    if (v250)
    {
      v84 = 0;
    }

    if (v84 && v32)
    {
      if ([(MADAutoAssetControlManager *)v248 isSetIdentifierBeingEliminated:v10 forClientDomainName:v245 ofSetIdentifier:v234])
      {
        v85 = v52;
        v250 = [MAAutoAssetError buildError:6114 fromOperation:v10 underlyingError:0 withDescription:@"set-identifier is being eliminated"];
        v86 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v86, OS_LOG_TYPE_ERROR))
        {
          v87 = [v251 clientRequest];
          v88 = [v87 summary];
          *buf = 138543618;
          v256 = v10;
          v257 = 2114;
          v258 = v88;
          _os_log_impl(&dword_0, v86, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [EliminationInProgress] set-identifier is being eliminated | clientRequest:%{public}@", buf, 0x16u);
        }

        v224 = @"set-identifier being eliminated";
        goto LABEL_91;
      }
    }

    else if (v250)
    {
      v85 = v52;
      goto LABEL_92;
    }

    v86 = [v251 clientRequest];
    v89 = [v86 clientReplyCompletion];
    if (!v89)
    {
      v85 = v52;
      v250 = 0;
LABEL_91:

      goto LABEL_92;
    }

    v90 = v89;
    v91 = [p_weak_ivar_lyt[223] stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];

    if (v91)
    {
      v61 = v235;
      v92 = [v235 atomicInstance];
      if (v92)
      {
        [v235 atomicInstance];
      }

      else
      {
        [v237 latestAtomicInstanceToVend];
      }
      v94 = ;
      v86 = [(MADAutoAssetControlManager *)v248 locateSetDescriptor:v10 forAtomicInstanceUUID:v94 requireExists:1];

      if (v86)
      {
        v19 = v234;
        if (![v86 secureOperationInProgress])
        {
          [(MADAutoAssetControlManager *)v248 setConfigurationAssetSetIDMostRecentlyReceived:v10 fromSetDescriptor:v86 forSetConfiguration:v237 buildingPersistReason:v242];
          v59 = v237;
          [(MADAutoAssetControlManager *)v248 setConfigurationPersist:v237 fromLocation:v10 forReason:v242 dueToAlter:0 forHistoryOperation:458];
          [(MADAutoAssetControlManager *)v248 securePersonalizeGraftLockSet:v10 lockingSetDescriptor:v86 forEventInfo:v251 fallingBackToSetDescriptor:0 fromPreSUStaging:0];
          v250 = 0;
          v60 = 0;
          v63 = v240;
          goto LABEL_112;
        }

        v95 = [MAAutoAssetError buildError:6532 fromOperation:v10 underlyingError:0 withDescription:@"set-identifier already performing a secure-operation"];

        v96 = _MADLog(@"AutoControl");
        v250 = v96;
        v85 = v52;
        if (os_log_type_enabled(v96, OS_LOG_TYPE_ERROR))
        {
          v97 = [v251 clientRequest];
          v98 = [v97 summary];
          *buf = 138543618;
          v256 = v10;
          v257 = 2114;
          v258 = v98;
          _os_log_impl(&dword_0, v96, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [SecureOperationInProgress] set-identifier already performing a secure-operation | clientRequest:%{public}@", buf, 0x16u);
        }

        v224 = @"downloaded when secure operation in progress";
      }

      else
      {
        v85 = v52;
        v95 = [MAAutoAssetError buildError:6504 fromOperation:v10 underlyingError:0 withDescription:@"set-job successfully downloaded atomic-instance yet atomic-instance not present on the filesystem"];
        v224 = @"downloaded yet atomic-instance not present on the filesystem";
        v19 = v234;
      }

      v250 = v95;
      v10 = v247;
      v16 = v225;
      goto LABEL_91;
    }

    v85 = v52;
    v250 = 0;
LABEL_92:
    v59 = v237;
    v99 = [v251 clientRequest];
    v86 = [v99 responseMessage];

    if (v85)
    {
      v61 = v235;
      v63 = v240;
      v100 = v248;
      v101 = v250;
    }

    else
    {
      v102 = [v251 clientRequest];
      v103 = [v102 responseMessage];
      v100 = v248;
      v101 = v250;
      v104 = [(MADAutoAssetControlManager *)v248 updateAutoAssetSetStatus:v10 forClientDomain:v245 forAssetSetIdentifier:v19 forJobResponse:v103 withResponseError:v250 clearingDownloadProgressReason:v224 withAssetSetStatus:v246];

      v86 = v104;
      v19 = v234;
      v61 = v235;
      v63 = v240;
    }

    [(MADAutoAssetControlManager *)v100 issueBuiltResponseForEventInfo:v251 issuingResponseMessage:v86 withResponseError:v101 fromLocation:v10];
    v105 = (v101 == 0) | v229;
    if ((v105 & 1) == 0)
    {
      v106 = [v61 autoAssetSetClientName];
      if (v106)
      {
        [v61 autoAssetSetClientName];
      }

      else
      {
        [v61 clientProcessName];
      }
      v107 = ;

      if (v107)
      {
        v108 = v107;
      }

      else
      {
        v108 = @"Unknown Client";
      }

      if (v238)
      {
        v109 = v245;
      }

      else
      {
        v109 = @"Unknown Client Domain Name";
      }

      if (v222)
      {
        v110 = v19;
      }

      else
      {
        v110 = @"Unknown Asset Set Identifier";
      }

      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v108 forClientDomainName:v109 forAssetSetIdentifier:v110 forAtomicInstance:v225 failingWithError:v250];
      if (+[MAAIRBEventReporter isAvailable])
      {
        v111 = [MAAIRBMobileAssetOperationMetadata alloc];
        v112 = [MADAutoAssetHistoryTracker operationName:504];
        v113 = [(MAAIRBMobileAssetOperationMetadata *)v111 initWithCode:504 name:v112];

        v114 = [MAAIRBMobileAssetAtomicInstance alloc];
        v115 = [[MAAIRBMobileAssetAssetSet alloc] initWithAssetSetIdentifier:v19];
        v116 = [(MAAIRBMobileAssetAtomicInstance *)v114 initWithAssetSet:v115 atomicInstanceId:v225];

        v117 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v113 atomicInstance:v116 assetCount:0];
        v118 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
        v254 = v250;
        v119 = [NSArray arrayWithObjects:&v254 count:1];
        v120 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v118 initWithErrors:v119 type:v117];

        [MAAIRBEventReporter emitAppleIntelligenceEvent:v120];
        v59 = v237;

        v61 = v235;
        v19 = v234;
        v63 = v240;
      }

      v10 = v247;
      v16 = v225;
    }

    v60 = v105 ^ 1;
    [(MADAutoAssetControlManager *)v248 decrementClientRequestCount:v10 forEventInfo:v251];
LABEL_112:

    v11 = v231;
    v62 = v243;
    if (!v16)
    {
      goto LABEL_117;
    }

    goto LABEL_113;
  }

  v59 = v51;
  v60 = 1;
  v61 = v235;
  v62 = v243;
  v63 = v240;
  if (!v16)
  {
    goto LABEL_117;
  }

LABEL_113:
  if (v60)
  {
    v121 = [(MADAutoAssetControlManager *)v248 locateSetDescriptor:v10 forAtomicInstanceUUID:v16 requireExists:0];
    if (!v121)
    {
      [(MADAutoAssetControlManager *)v248 atomicInstanceRemove:v10 setAtomicInstanceUUID:v16 removingForReason:@"failure where atomic-instance never reached downloaded stage" historyOperation:321];
    }
  }

LABEL_117:
}

- (BOOL)setConfigurationClearAvailableForUseError:(id)a3 forSetConfiguration:(id)a4 appendingToPersistReason:(id)a5 withReason:(id)a6 maintainingHistoryOperation:(int64_t *)a7
{
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [v11 availableForUseError];

  if (v16)
  {
    v17 = [v11 availableForUseError];
    v18 = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v17];

    if (v18)
    {
      v19 = [[NSString alloc] initWithFormat:@", (%@) had been unavailable due to device being locked", v13];
      [v12 appendString:v19];

      if (a7)
      {
        *a7 = 461;
      }
    }

    else
    {
      [v12 appendString:v13];
    }

    [v11 setAvailableForUseError:0];
  }

  return 0;
}

- (void)scheduledJobsResumed:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self setAlreadyScheduledSelectors:v7];

  v21 = 0u;
  v22 = 0u;
  v19 = 0u;
  v20 = 0u;
  v8 = v4;
  v9 = [v8 countByEnumeratingWithState:&v19 objects:v23 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v20;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v20 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v19 + 1) + 8 * i);
        if (([v13 setJob] & 1) == 0)
        {
          v14 = [v13 assetSelector];
          v15 = [v14 persistedEntryID];

          v16 = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
          v17 = [v13 assetSelector];
          v18 = [v17 copy];
          [v16 setSafeObject:v18 forKey:v15];
        }
      }

      v10 = [v8 countByEnumeratingWithState:&v19 objects:v23 count:16];
    }

    while (v10);
  }
}

- (id)locateSetJobForClientDomain:(id)a3 byIdentifier:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (v6 && v7)
  {
    v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v6 forAssetSetIdentifier:v7];
    v11 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
    v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];
  }

  else
  {
    v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v11 = [v10 diag];
    v13 = [NSString alloc];
    v14 = @"N";
    if (v6)
    {
      v15 = v6;
    }

    else
    {
      v15 = @"N";
    }

    if (v7)
    {
      v14 = v7;
    }

    v16 = [v13 initWithFormat:@"{locateSetJobForClientDomain} missing required | clientDomainName:%@ | assetSetIdentifier:%@", v15, v14];
    [v11 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6102 withError:0];

    v12 = 0;
  }

  return v12;
}

- (id)locateCancelingSetJobForClientDomain:(id)a3 byIdentifier:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (v6 && v7)
  {
    v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v6 forAssetSetIdentifier:v7];
    v11 = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
    v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];
  }

  else
  {
    v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v11 = [v10 diag];
    v13 = [NSString alloc];
    v14 = @"N";
    if (v6)
    {
      v15 = v6;
    }

    else
    {
      v15 = @"N";
    }

    if (v7)
    {
      v14 = v7;
    }

    v16 = [v13 initWithFormat:@"{locateCancelingSetJobForClientDomain} missing required | clientDomainName:%@ | assetSetIdentifier:%@", v15, v14];
    [v11 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6102 withError:0];

    v12 = 0;
  }

  return v12;
}

- (id)locateSetStatusByInstance:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v8 = [v7 safeObjectForKey:v4 ofClass:objc_opt_class()];

  if (v8)
  {
    v9 = [v8 clientDomainName];
    v10 = [v8 assetSetIdentifier];
    v11 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v9 forAssetSetIdentifier:v10];

    if (v11)
    {
      v12 = [v11 newerVersionError];
      [v8 setNewerVersionError:v12];

      v13 = [v11 availableForUseError];
      [v8 setAvailableForUseError:v13];
    }

    else
    {
      v13 = v8;
      v8 = 0;
    }
  }

  return v8;
}

- (id)locateSetStatusForDomainName:(id)a3 byIdentifier:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = v6;
  v9 = v7;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v33 = v9;
  v12 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v8 forAssetSetIdentifier:v9];
  v13 = v12;
  if (v12)
  {
    v14 = [v12 latestAtomicInstanceToVend];

    v32 = v8;
    if (v14)
    {
      v15 = [v13 latestAtomicInstanceToVend];
      v31 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v15];

      v8 = v32;
    }

    else
    {
      v30 = v13;
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetStatusForDomainName" ofContainer:@"currentSetStatusByInstance"];
      v37 = 0u;
      v38 = 0u;
      v35 = 0u;
      v36 = 0u;
      obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      v16 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
      if (v16)
      {
        v17 = v16;
        v31 = 0;
        v18 = *v36;
        do
        {
          for (i = 0; i != v17; i = i + 1)
          {
            if (*v36 != v18)
            {
              objc_enumerationMutation(obj);
            }

            v20 = *(*(&v35 + 1) + 8 * i);
            v21 = objc_autoreleasePoolPush();
            v22 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v20];
            v23 = [v22 clientDomainName];
            if (([SUCore stringIsEqual:v23 to:v8]& 1) != 0)
            {
              v24 = [v22 assetSetIdentifier];
              v25 = [SUCore stringIsEqual:v24 to:v33];

              if (v25)
              {
                if (v31)
                {
                  v26 = [v31 latestDownloadedAtomicInstance];

                  if (!v26)
                  {
                    v27 = [v22 latestDownloadedAtomicInstance];

                    if (v27)
                    {
                      v28 = v22;

                      v31 = v28;
                    }
                  }
                }

                else
                {
                  v31 = v22;
                }
              }

              v8 = v32;
            }

            else
            {
            }

            objc_autoreleasePoolPop(v21);
          }

          v17 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
        }

        while (v17);
      }

      else
      {
        v31 = 0;
      }

      v13 = v30;
    }
  }

  else
  {
    v31 = 0;
  }

  return v31;
}

- (id)locateSetStatusPreferringByInstance:(id)a3 elseByClientDomain:(id)a4 forAssetSetIdentifier:(id)a5 fromLocation:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:locateSetStatusPreferringByInstance", v13];
  v17 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v10];
  v18 = v17;
  if (v12 && v11 && !v17)
  {
    v18 = [(MADAutoAssetControlManager *)self locateSetStatusForDomainName:v11 byIdentifier:v12];
  }

  if (!v18)
  {
    if (v10)
    {
      v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:v10 requireExists:0];
      goto LABEL_29;
    }

    v20 = 0;
    v19 = 0;
    if (v11 && v12)
    {
      v21 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v11 forAssetSetIdentifier:v12];
      v20 = v21;
      if (v21)
      {
        v22 = [v21 latestAtomicInstanceToVend];

        if (v22)
        {
          v23 = [v20 latestAtomicInstanceToVend];
          v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:v23 requireExists:1];

          goto LABEL_28;
        }

        v24 = [v20 previouslyVendedLockedAtomicInstances];

        if (v24)
        {
          v86 = 0u;
          v87 = 0u;
          v84 = 0u;
          v85 = 0u;
          v25 = [v20 previouslyVendedLockedAtomicInstances];
          v26 = [v25 copy];

          v27 = [v26 countByEnumeratingWithState:&v84 objects:v88 count:16];
          if (v27)
          {
            v28 = v27;
            v68 = v13;
            v29 = v11;
            v30 = *v85;
            while (2)
            {
              for (i = 0; i != v28; i = i + 1)
              {
                if (*v85 != v30)
                {
                  objc_enumerationMutation(v26);
                }

                v32 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:*(*(&v84 + 1) + 8 * i) requireExists:1];
                if (v32)
                {
                  v19 = v32;
                  goto LABEL_25;
                }
              }

              v28 = [v26 countByEnumeratingWithState:&v84 objects:v88 count:16];
              if (v28)
              {
                continue;
              }

              break;
            }

            v19 = 0;
LABEL_25:
            v10 = 0;
            v11 = v29;
            v13 = v68;
          }

          else
          {
            v19 = 0;
          }

          goto LABEL_28;
        }
      }

      v19 = 0;
    }

LABEL_28:

LABEL_29:
    v18 = 0;
    if (v12 && v11 && v19)
    {
      v73 = v16;
      v33 = [v19 clientDomainName];
      v34 = [v19 assetSetIdentifier];
      v35 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v33 forAssetSetIdentifier:v34];

      v36 = objc_alloc_init(MANAutoAssetSetNotifications);
      [(MANAutoAssetSetNotifications *)v36 setAtomicInstanceDiscovered:1];
      v83 = v36;
      [(MANAutoAssetSetNotifications *)v36 setAtomicInstanceAvailableForUse:1];
      v37 = [v35 latestAtomicInstanceToVend];

      v69 = v13;
      if (v37)
      {
        v38 = [v35 latestAtomicInstanceToVend];
        v39 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v73 forAtomicInstanceUUID:v38 requireExists:1];

        if (v39)
        {
          v40 = [v19 latestDownloadedAtomicInstance];
          v41 = [v39 latestDownloadedAtomicInstance];
          v42 = [SUCore stringIsEqual:v40 to:v41];

          v43 = v42;
        }

        else
        {
          v43 = 0;
        }
      }

      else
      {
        v43 = 0;
      }

      v64 = [MANAutoAssetSetStatus alloc];
      v44 = [v19 clientDomainName];
      v45 = [v19 assetSetIdentifier];
      v80 = [(MADAutoAssetControlManager *)self newAtomicInstancesDownloadedForDescriptor:v19];
      v79 = [v35 mostRecentlyReceivedCachedAssetSetID];
      v78 = [v35 mostRecentlyReceivedDownloadedFromLive];
      v77 = [v35 mostRecentlyReceivedLastTimeChecked];
      v76 = [v35 mostRecentlyReceivedPostedDate];
      v75 = [v19 discoveredAtomicInstance];
      v74 = [v19 discoveredAtomicEntries];
      v67 = v10;
      v81 = v45;
      v82 = v44;
      v65 = v43;
      if (v43)
      {
        v72 = [v19 latestDownloadedAtomicInstance];
        v63 = [v35 latestAtomicInstanceToVendFromPreSUStaging];
        v71 = [v19 latestDowloadedAtomicInstanceEntries];
      }

      else
      {
        v63 = [v35 latestAtomicInstanceToVendFromPreSUStaging];
        v71 = 0;
        v72 = 0;
      }

      v62 = [v35 latestToVendCachedAssetSetID];
      v61 = [v35 latestToVendDownloadedFromLive];
      v60 = [v35 latestToVendLastTimeChecked];
      v59 = [v35 latestToVendPostedDate];
      v66 = v11;
      v70 = v12;
      v58 = [MADAutoAssetScheduler newSetPolicyForDomainName:v11 forAssetSetIdentifier:v12];
      v55 = +[MADAutoAssetControlManager stagerSetPolicy];
      v57 = [v35 haveReceivedLookupResponse];
      v46 = [v35 vendingAtomicInstanceForConfiguredEntries];
      v47 = [v19 downloadUserInitiated];
      v48 = [v19 downloadedNetworkBytes];
      v49 = [v19 downloadedFilesystemBytes];
      v56 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v19];
      v50 = [v35 availableForUseError];
      v51 = [v35 newerVersionError];
      BYTE2(v54) = v47;
      BYTE1(v54) = v46;
      LOBYTE(v54) = v57;
      LOBYTE(v53) = v63;
      v18 = [MANAutoAssetSetStatus initStatusForClientDomain:v64 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v82 withAtomicInstancesDownloaded:v81 withCatalogCachedAssetSetID:0 withCatalogDownloadedFromLive:v80 withCatalogLastTimeChecked:v79 withCatalogPostedDate:v78 withNewerAtomicInstanceDiscovered:v77 withNewerDiscoveredAtomicEntries:v76 withLatestDownloadedAtomicInstance:v75 withLatestDownloadedAtomicInstanceFromPreSUStaging:v74 withLatestDowloadedAtomicInstanceEntries:v72 withDownloadedCatalogCachedAssetSetID:v53 withDownloadedCatalogDownloadedFromLive:v71 withDownloadedCatalogLastTimeChecked:v62 withDownloadedCatalogPostedDate:v61 withCurrentNotifications:v60 withCurrentNeedPolicy:v59 withSchedulerPolicy:v83 withStagerPolicy:0 havingReceivedLookupResponse:v58 vendingAtomicInstanceForConfiguredEntries:v55 withDownloadUserInitiated:v54 withDownloadProgress:0 withDownloadedNetworkBytes:v48 withDownloadedFilesystemBytes:v49 withCurrentLockUsage:v56 withSelectorsForStaging:0 withAvailableForUseError:v50 withNewerVersionError:v51];

      if (v65)
      {
      }

      v11 = v66;
      v10 = v67;
      v13 = v69;
      v12 = v70;
      v16 = v73;
    }
  }

  return v18;
}

- (void)clearDownloadedFromSetStatus:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v25 = a4;
  v23 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v22 = v8;
  v21 = [[NSString alloc] initWithFormat:@"%@:clearDownloadedFromSetStatus", v8];
  [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v11 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v27;
    do
    {
      v14 = 0;
      do
      {
        if (*v27 != v13)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v26 + 1) + 8 * v14);
        v16 = objc_autoreleasePoolPush();
        v17 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v15];
        v18 = [v17 clientDomainName];
        if (([SUCore stringIsEqual:v18 to:v25]& 1) != 0)
        {
          v19 = [v17 assetSetIdentifier];
          v20 = [SUCore stringIsEqual:v19 to:v23];

          if (v20)
          {
            [v17 setAtomicInstancesDownloaded:0];
            [v17 setLatestDownloadedAtomicInstance:0];
            [v17 setLatestDowloadedAtomicInstanceEntries:0];
            [v17 setCurrentLockUsage:0];
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v16);
        v14 = v14 + 1;
      }

      while (v12 != v14);
      v12 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v12);
  }
}

- (id)newAtomicInstancesDownloadedForDescriptor:(id)a3
{
  v3 = a3;
  v4 = [v3 latestDownloadedAtomicInstance];

  if (v4)
  {
    v4 = objc_alloc_init(NSMutableArray);
    v5 = [v3 latestDownloadedAtomicInstance];
    [v4 addObject:v5];
  }

  return v4;
}

- (id)locateSetConfigurationByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v6];
  v11 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)locateSetLookupResultSatisfying:(id)a3
{
  v28 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetLookupResultSatisfying" ofContainer:@"stagedSetLookupResults"];
  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  obj = [(MADAutoAssetControlManager *)self stagedSetLookupResults];
  v30 = [obj countByEnumeratingWithState:&v50 objects:v56 count:16];
  if (!v30)
  {
LABEL_30:
    v25 = 0;
    goto LABEL_32;
  }

  v29 = *v51;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
LABEL_3:
  v7 = 0;
  while (1)
  {
    if (*v51 != v29)
    {
      objc_enumerationMutation(obj);
    }

    v8 = *(*(&v50 + 1) + 8 * v7);
    v9 = objc_autoreleasePoolPush();
    v36 = v8;
    if (!v8)
    {
      goto LABEL_28;
    }

    v31 = v7;
    context = v9;
    v48 = 0u;
    v49 = 0u;
    v46 = 0u;
    v47 = 0u;
    v33 = v28;
    v34 = [v33 countByEnumeratingWithState:&v46 objects:v55 count:16];
    if (!v34)
    {
      goto LABEL_31;
    }

    v35 = *v47;
LABEL_9:
    v10 = 0;
LABEL_10:
    if (*v47 != v35)
    {
      objc_enumerationMutation(v33);
    }

    v37 = v10;
    v11 = *(*(&v46 + 1) + 8 * v10);
    v42 = 0u;
    v43 = 0u;
    v44 = 0u;
    v45 = 0u;
    v39 = [v36 requestedAutoAssetEntries];
    v41 = [v39 countByEnumeratingWithState:&v42 objects:v54 count:16];
    if (v41)
    {
      break;
    }

LABEL_27:

    v7 = v31;
    v9 = context;
LABEL_28:
    objc_autoreleasePoolPop(v9);
    if (++v7 == v30)
    {
      v30 = [obj countByEnumeratingWithState:&v50 objects:v56 count:16];
      if (!v30)
      {
        goto LABEL_30;
      }

      goto LABEL_3;
    }
  }

  v12 = *v43;
  v38 = v11;
LABEL_14:
  v13 = 0;
  while (1)
  {
    if (*v43 != v12)
    {
      objc_enumerationMutation(v39);
    }

    v14 = *(*(&v42 + 1) + 8 * v13);
    v15 = p_weak_ivar_lyt[223];
    v16 = [v14 assetSelector];
    v17 = [v16 assetType];
    v18 = [v11 assetSelector];
    v19 = [v18 assetType];
    if (![v15 stringIsEqual:v17 to:v19])
    {

      goto LABEL_21;
    }

    v40 = p_weak_ivar_lyt[223];
    v20 = [v14 assetSelector];
    v21 = [v20 assetSpecifier];
    v22 = [v11 assetSelector];
    [v22 assetSpecifier];
    v24 = v23 = v12;
    LOBYTE(v40) = [v40 stringIsEqual:v21 to:v24];

    v12 = v23;
    v11 = v38;

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    if (v40)
    {
      break;
    }

LABEL_21:
    if (v41 == ++v13)
    {
      v41 = [v39 countByEnumeratingWithState:&v42 objects:v54 count:16];
      if (v41)
      {
        goto LABEL_14;
      }

      goto LABEL_27;
    }
  }

  v10 = v37 + 1;
  if ((v37 + 1) != v34)
  {
    goto LABEL_10;
  }

  v34 = [v33 countByEnumeratingWithState:&v46 objects:v55 count:16];
  if (v34)
  {
    goto LABEL_9;
  }

LABEL_31:

  v25 = v36;
  objc_autoreleasePoolPop(context);
LABEL_32:

  return v25;
}

- (id)locateNewAllSetConfigurations
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v6 = [v5 persistedEntryIDs:@"locateNewAllSetConfigurations"];

  v7 = objc_alloc_init(NSMutableArray);
  if ([v6 count])
  {
    v21 = v7;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateNewAllSetConfigurations" ofContainer:@"persistedKnownSetConfigurations"];
    v25 = 0u;
    v26 = 0u;
    v23 = 0u;
    v24 = 0u;
    v20 = v6;
    obj = v6;
    v8 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v24;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v24 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v23 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          v14 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v15 = [v14 persistedEntry:v12 fromLocation:@"locateNewAllSetConfigurations"];

          if (v15)
          {
            v16 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            v17 = [v16 decodeFromLocation:@"locateNewAllSetConfigurations" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              [v21 addObject:v17];
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v28 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateNewAllSetConfigurations} | no set-configuration entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v28 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateNewAllSetConfigurations} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
      }

      while (v9);
    }

    v6 = v20;
    v7 = v21;
  }

  if (![v7 count])
  {

    v7 = 0;
  }

  return v7;
}

- (BOOL)isAtomicEntry:(id)a3 desiredForAutoAssetSetEntries:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (!v6)
  {
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = v24;
    v26 = @"{isAtomicEntry:desiredForAutoAssetSetEntries} nil atomic-entry provided";
LABEL_18:
    [v24 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6102 withError:0];

    v27 = 0;
    goto LABEL_22;
  }

  if (!v7)
  {
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = v24;
    v26 = @"{isAtomicEntry:desiredForAutoAssetSetEntries} nil auto-asset-set-entries provided";
    goto LABEL_18;
  }

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  obj = v7;
  v10 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
  if (v10)
  {
    v11 = v10;
    v29 = v7;
    v12 = *v36;
    v30 = *v36;
    do
    {
      v13 = 0;
      v31 = v11;
      do
      {
        if (*v36 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v35 + 1) + 8 * v13);
        if (v14)
        {
          v34 = [*(*(&v35 + 1) + 8 * v13) assetSelector];
          v15 = [v34 assetType];
          v16 = [v6 fullAssetSelector];
          v17 = [v16 assetType];
          if ([SUCore stringIsEqual:v15 to:v17])
          {
            v18 = [v14 assetSelector];
            v19 = [v18 assetSpecifier];
            v20 = [v6 fullAssetSelector];
            [v20 assetSpecifier];
            v22 = v21 = v6;
            v33 = [SUCore stringIsEqual:v19 to:v22];

            v6 = v21;
            v11 = v31;

            v12 = v30;
            if (v33)
            {
              v27 = 1;
              goto LABEL_19;
            }
          }

          else
          {
          }
        }

        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
    }

    while (v11);
    v27 = 0;
LABEL_19:
    v7 = v29;
  }

  else
  {
    v27 = 0;
  }

LABEL_22:
  return v27;
}

- (id)newSetTargetFromClientProvidedSetTarget:(id)a3 forClientDomainName:(id)a4 forSetIdentifier:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v10 = [MADAutoSetTarget alloc];
  v11 = [v9 minTargetOSVersion];
  v12 = [v9 maxTargetOSVersion];
  v13 = [v9 autoAssetEntries];

  v14 = [(MADAutoSetTarget *)v10 initForClientDomainName:v8 forAssetSetIdentifier:v7 fromMinTargetOSVersion:v11 toMaxTargetOSVersion:v12 asEntriesWhenTargeting:v13];
  return v14;
}

- (id)locateNewAllSetTargets
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v6 = [v5 persistedEntryIDs:@"locateNewAllSetTargets"];

  v7 = objc_alloc_init(NSMutableArray);
  if ([v6 count])
  {
    v21 = v7;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateNewAllSetTargets" ofContainer:@"persistedSetTargets"];
    v25 = 0u;
    v26 = 0u;
    v23 = 0u;
    v24 = 0u;
    v20 = v6;
    obj = v6;
    v8 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v24;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v24 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v23 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          v14 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v15 = [v14 persistedEntry:v12 fromLocation:@"locateNewAllSetTargets"];

          if (v15)
          {
            v16 = [(MADAutoAssetControlManager *)self persistedSetTargets];
            v17 = [v16 decodeFromLocation:@"locateNewAllSetTargets" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              [v21 addObject:v17];
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v28 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateNewAllSetTargets} | no set-target entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v28 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateNewAllSetTargets} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
      }

      while (v9);
    }

    v6 = v20;
    v7 = v21;
  }

  if (![v7 count])
  {

    v7 = 0;
  }

  return v7;
}

- (BOOL)setTargetEntries:(id)a3 matchSetConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 autoAssetEntries];
  v11 = [v10 count];
  v40 = v7;
  v12 = [v7 autoAssetEntries];
  v13 = [v12 count];

  if (v11 == v13)
  {
    v38 = objc_alloc_init(NSMutableDictionary);
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v54 = 0u;
    v36 = v6;
    obj = [v6 autoAssetEntries];
    v41 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
    if (v41)
    {
      v39 = *v52;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      do
      {
        v15 = 0;
        do
        {
          if (*v52 != v39)
          {
            objc_enumerationMutation(obj);
          }

          v42 = v15;
          v16 = *(*(&v51 + 1) + 8 * v15);
          v47 = 0u;
          v48 = 0u;
          v49 = 0u;
          v50 = 0u;
          v44 = [v40 autoAssetEntries];
          v46 = [v44 countByEnumeratingWithState:&v47 objects:v55 count:16];
          if (v46)
          {
            v17 = *v48;
            v43 = v16;
            do
            {
              for (i = 0; i != v46; i = i + 1)
              {
                if (*v48 != v17)
                {
                  objc_enumerationMutation(v44);
                }

                v19 = *(*(&v47 + 1) + 8 * i);
                v20 = p_weak_ivar_lyt[223];
                v21 = [v19 assetSelector];
                v22 = [v21 assetType];
                v23 = [v16 assetSelector];
                v24 = [v23 assetType];
                if ([v20 stringIsEqual:v22 to:v24])
                {
                  v45 = p_weak_ivar_lyt[223];
                  v25 = [v19 assetSelector];
                  v26 = [v25 assetSpecifier];
                  v27 = [v16 assetSelector];
                  [v27 assetSpecifier];
                  v29 = v28 = v17;
                  LODWORD(v45) = [v45 stringIsEqual:v26 to:v29];

                  v17 = v28;
                  v16 = v43;

                  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                  if (v45)
                  {
                    v30 = [v43 assetSelector];
                    v31 = [v30 persistedEntryID];
                    [v38 setSafeObject:v43 forKey:v31];

                    goto LABEL_18;
                  }
                }

                else
                {
                }
              }

              v46 = [v44 countByEnumeratingWithState:&v47 objects:v55 count:16];
            }

            while (v46);
          }

LABEL_18:

          v15 = v42 + 1;
        }

        while ((v42 + 1) != v41);
        v41 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
      }

      while (v41);
    }

    v32 = [v38 count];
    v6 = v36;
    v33 = [v36 autoAssetEntries];
    v34 = v32 == [v33 count];
  }

  else
  {
    v34 = 0;
  }

  return v34;
}

- (void)removeSetTargetsForClientDomain:(id)a3 forSetIdentifier:(id)a4 fromLocation:(id)a5
{
  v50 = a3;
  v47 = a4;
  v8 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v48 = v8;
  v11 = [[NSString alloc] initWithFormat:@"%@:removeSetTargetsForClientDomain", v8];
  v54 = self;
  v12 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v55 = v11;
  v13 = [v12 persistedEntryIDs:v11];

  if ([v13 count])
  {
    v46 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v55 ofContainer:@"persistedSetTargets"];
    v62 = 0u;
    v63 = 0u;
    v60 = 0u;
    v61 = 0u;
    v45 = v13;
    obj = v13;
    v14 = [obj countByEnumeratingWithState:&v60 objects:v69 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = *v61;
      v49 = *v61;
      do
      {
        v17 = 0;
        v51 = v15;
        do
        {
          if (*v61 != v16)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v60 + 1) + 8 * v17);
          v19 = objc_autoreleasePoolPush();
          v20 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v21 = [v20 persistedEntry:v18 fromLocation:v55];

          if (v18)
          {
            v22 = v21 == 0;
          }

          else
          {
            v22 = 1;
          }

          if (v22)
          {
            v25 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              v23 = @"N";
              if (v18)
              {
                v23 = v18;
              }

              v66 = v55;
              v67 = 2114;
              v68 = v23;
              _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to determine previous set-target for entry:%{public}@", buf, 0x16u);
            }
          }

          else
          {
            v24 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v25 = [v24 decodeFromLocation:v55 ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v25)
            {
              v26 = [v25 clientDomainName];
              if (([SUCore stringIsEqual:v50 to:v26]& 1) != 0)
              {
                v27 = [v25 assetSetIdentifier];
                v28 = [SUCore stringIsEqual:v47 to:v27];

                if (v28)
                {
                  [v46 addObject:v18];
                }

                v15 = v51;
                v16 = v49;
              }

              else
              {

                v15 = v51;
                v16 = v49;
              }
            }

            else
            {
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v66 = v55;
                v67 = 2114;
                v68 = v18;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "{%{public}@} | no set-target entry found for entry:%{public}@", buf, 0x16u);
              }
            }
          }

          objc_autoreleasePoolPop(v19);
          v17 = v17 + 1;
        }

        while (v15 != v17);
        v15 = [obj countByEnumeratingWithState:&v60 objects:v69 count:16];
      }

      while (v15);
    }

    v58 = 0u;
    v59 = 0u;
    v56 = 0u;
    v57 = 0u;
    v30 = v46;
    v31 = [v30 countByEnumeratingWithState:&v56 objects:v64 count:16];
    if (v31)
    {
      v32 = v31;
      v33 = *v57;
      do
      {
        v34 = 0;
        obja = v32;
        do
        {
          if (*v57 != v33)
          {
            objc_enumerationMutation(v30);
          }

          v35 = *(*(&v56 + 1) + 8 * v34);
          v36 = objc_autoreleasePoolPush();
          if (v35)
          {
            v37 = [(MADAutoAssetControlManager *)v54 persistedSetTargets];
            v38 = [v37 persistedEntry:v35 fromLocation:v55];

            if (v38)
            {
              v39 = [(MADAutoAssetControlManager *)v54 persistedSetTargets];
              v40 = [v39 decodeFromLocation:v55 ofEntryName:v35 fromPersistedEntry:v38 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

              if (v40)
              {
                v41 = [(MADAutoAssetControlManager *)v54 persistedSetTargets];
                [v41 removePersistedEntry:v35 fromLocation:v55];

                v42 = [NSString alloc];
                v43 = [v40 summary];
                v44 = [v42 initWithFormat:@"removed previously defined set-target | setTarget:%@", v43];
                v32 = obja;
                [(MADAutoAssetControlManager *)v54 _logPersistedSetTargetRemoved:v48 removedPersistedEntryID:v35 removedSetTarget:v40 message:v44];
              }
            }

            else
            {
              v40 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v66 = v55;
                v67 = 2114;
                v68 = v35;
                _os_log_impl(&dword_0, v40, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to re-load set-target for entry:%{public}@", buf, 0x16u);
              }
            }
          }

          objc_autoreleasePoolPop(v36);
          v34 = v34 + 1;
        }

        while (v32 != v34);
        v32 = [v30 countByEnumeratingWithState:&v56 objects:v64 count:16];
      }

      while (v32);
    }

    v13 = v45;
  }
}

- (id)locateSetAtomicInstanceByInstanceUUID:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4)
  {
    v7 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    v8 = [v7 safeObjectForKey:v4 ofClass:objc_opt_class()];
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)isAtomicInstanceForCurrentSetJob:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  v8 = [v4 assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v7 forAssetSetIdentifier:v8];

  v10 = [v9 discoveredInFlightAtomicInstance];
  v11 = [v4 atomicInstanceUUID];

  LOBYTE(v4) = [SUCore stringIsEqual:v10 to:v11];
  return v4;
}

- (BOOL)isAtomicInstanceLatestToVendForSet:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  v8 = [v4 assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v7 forAssetSetIdentifier:v8];

  v10 = [v9 latestAtomicInstanceToVend];
  v11 = [v4 atomicInstanceUUID];

  LOBYTE(v4) = [SUCore stringIsEqual:v10 to:v11];
  return v4;
}

- (id)setDescriptorWalkKeys
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v6 = [v5 allKeys];
  v7 = [v6 copy];

  return v7;
}

- (id)setDescriptorWalkKeysForClientDomainName:(id)a3 assetSetIdentifier:(id)a4
{
  v30 = a3;
  v27 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v26 = objc_alloc_init(NSMutableArray);
  v31 = 0u;
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v8 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v32;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v12 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v13 = 0;
      v28 = v9;
      do
      {
        if (*v32 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v31 + 1) + 8 * v13);
        v15 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v16)
        {
          v17 = v12[223];
          v18 = [v16 clientDomainName];
          if ([v17 stringIsEqual:v18 to:v30])
          {
            v19 = v12[223];
            [v16 assetSetIdentifier];
            v20 = v10;
            v21 = self;
            v22 = p_weak_ivar_lyt;
            v24 = v23 = v12;
            LODWORD(v19) = [v19 stringIsEqual:v24 to:v27];

            v12 = v23;
            p_weak_ivar_lyt = v22;
            self = v21;
            v10 = v20;
            v9 = v28;

            if (v19)
            {
              [v26 addObject:v14];
            }
          }

          else
          {
          }
        }

        v13 = v13 + 1;
      }

      while (v9 != v13);
      v9 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    }

    while (v9);
  }

  return v26;
}

- (id)setDescriptorWalkLocate:(id)a3 forKey:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v11 = [v10 safeObjectForKey:v7 ofClass:objc_opt_class()];

  if (!v11)
  {
    v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v17 = [v16 diag];
    v19 = [[NSString alloc] initWithFormat:@"{%@} corrupted known-set-atomic-instances container - unable to load key | setDescriptorWalkKey:%@", v6, v7];
    [v17 trackAnomaly:@"KNOWN-ATOMIC-INSTANCES" forReason:v19 withResult:6103 withError:0];
    goto LABEL_6;
  }

  v12 = [v11 atomicInstanceUUID];
  v13 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v6 forAtomicInstanceUUID:v12 requireExists:0];

  if (v13)
  {
    goto LABEL_8;
  }

  v14 = [v11 usageStatus];
  v15 = [SUCore stringIsEqual:v14 to:@"UNTRACKED"];

  if ((v15 & 1) == 0)
  {
    v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v17 = [v16 diag];
    v18 = [NSString alloc];
    v19 = [v11 summary];
    v20 = [v18 initWithFormat:@"{%@} set-atomic-instance without set-descriptor | setAtomicInstance:%@", v6, v19];
    [v17 trackAnomaly:@"KNOWN-ATOMIC-INSTANCES" forReason:v20 withResult:6111 withError:0];

LABEL_6:
  }

  v13 = 0;
LABEL_8:

  return v13;
}

- (void)persistSetDescriptorActiveJob:(id)a3 fromLocation:(id)a4
{
  v18 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v18 clientDomainName];
  v10 = [v18 assetSetIdentifier];
  v11 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v9 forAssetSetIdentifier:v10];

  v12 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  LODWORD(v10) = [v12 persistedEntryAlreadyExists:v11 fromLocation:v6];

  v13 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v14 = [v13 persistedEntry:v11 fromLocation:v6];

  if (v10)
  {
    v15 = @"ENTRY_MODIFY";
  }

  else
  {
    v15 = @"ENTRY_ADD";
  }

  [v14 persistSecureCodedObject:v18 forKey:@"assetSetDescriptor"];
  v16 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v17 = [v18 summary];
  [v16 storePersistedEntry:v11 withEntrySummary:v17 fromLocation:v6];

  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:v6 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" operation:v15 forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withSetDescriptor:v18 message:@"maintaining active set-job status"];
}

- (void)persistSetDescriptorDownloadedJob:(id)a3 fromLocation:(id)a4
{
  v18 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSString alloc] initWithFormat:@"%@:persistSetDescriptorDownloadedJob", v6];
  v10 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:v18];
  v11 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v12 = [v11 persistedEntryAlreadyExists:v10 fromLocation:v9];

  v13 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v14 = [v13 persistedEntry:v10 fromLocation:v9];

  if (v12)
  {
    v15 = @"ENTRY_MODIFY";
  }

  else
  {
    v15 = @"ENTRY_ADD";
  }

  [v14 persistSecureCodedObject:v18 forKey:@"assetSetDescriptor"];
  v16 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v17 = [v18 summary];
  [v16 storePersistedEntry:v10 withEntrySummary:v17 fromLocation:v9];

  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:v6 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:v15 forPersistedEntryID:v10 forClientRequest:0 withJobUUID:0 withSetDescriptor:v18 message:@"maintaining downloaded set-descriptors"];
}

- (id)newSetDescriptorFromAlreadyDownloaded:(id)a3 forSetInfoInstance:(id)a4 fromDownloadedSetDescriptor:(id)a5 forAtomicInstance:(id)a6
{
  v9 = a3;
  v10 = a4;
  v11 = a5;
  v12 = a6;
  v13 = [v10 autoAssetEntries];
  v14 = objc_alloc_init(NSMutableDictionary);
  v67 = objc_alloc_init(NSMutableArray);
  v68 = v14;
  if (v13 && [v13 count])
  {
    v65 = v12;
    v66 = v10;
    v71 = v9;
    v77 = 0u;
    v78 = 0u;
    v75 = 0u;
    v76 = 0u;
    v64 = v13;
    obj = v13;
    v15 = self;
    v74 = [obj countByEnumeratingWithState:&v75 objects:v85 count:16];
    if (v74)
    {
      v73 = *v76;
      do
      {
        for (i = 0; i != v74; i = i + 1)
        {
          if (*v76 != v73)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v75 + 1) + 8 * i);
          v18 = [v17 assetSelector];
          v19 = [v18 assetType];
          v20 = [v17 assetSelector];
          v21 = [v20 assetSpecifier];
          v22 = [(MADAutoAssetControlManager *)v15 findAtomicEntryForAssetType:v19 forAssetSpecifier:v21 representedByDescriptor:v11];

          if (v22)
          {
            v23 = [v22 fullAssetSelector];
            v24 = [v23 persistedEntryID];

            v25 = [v14 safeObjectForKey:v24 ofClass:objc_opt_class()];
            if (v25)
            {
              v72 = [(MADAutoAssetControlManager *)v15 autoControlManagerFSM];
              v26 = [v72 diag];
              v27 = [NSString alloc];
              v28 = [v22 summary];
              v29 = [v17 summary];
              [v11 summary];
              v31 = v30 = v11;
              v32 = [v27 initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} duplicate nextAtomicEntry ignored | nextAtomicEntry:%@ | setInfoInstance:%@, newSetDescriptor:%@", v71, v28, v29, v31];
              [v26 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v32 withResult:6109 withError:0];

              v15 = self;
              v11 = v30;

              v14 = v68;
            }

            else
            {
              [v14 setSafeObject:v22 forKey:v24];
              [v67 addObject:v22];
            }
          }

          else
          {
            v24 = [(MADAutoAssetControlManager *)v15 autoControlManagerFSM];
            v25 = [v24 diag];
            v33 = [NSString alloc];
            v34 = [v17 summary];
            v35 = [v11 summary];
            v36 = [v33 initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} no nextAtomicEntry | nextSetEntry:%@ | alreadyDownloadedSetDescriptor:%@", v71, v34, v35];
            [v25 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v36 withResult:6101 withError:0];
          }
        }

        v74 = [obj countByEnumeratingWithState:&v75 objects:v85 count:16];
      }

      while (v74);
    }

    v37 = [MADAutoSetDescriptor alloc];
    v10 = v66;
    v38 = [v66 clientDomainName];
    v39 = [v66 assetSetIdentifier];
    v12 = v65;
    v40 = [v65 atomicInstanceUUID];
    v41 = [(MADAutoSetDescriptor *)v37 initForClientDomainName:v38 forAssetSetIdentifier:v39 withDiscoveredAtomicInstance:v40 withDiscoveredAtomicEntries:v67];

    v42 = [v11 catalogCachedAssetSetID];
    [v41 setCatalogCachedAssetSetID:v42];

    v43 = [v11 catalogDownloadedFromLive];
    [v41 setCatalogDownloadedFromLive:v43];

    v44 = [v11 catalogLastTimeChecked];
    [v41 setCatalogLastTimeChecked:v44];

    v45 = [v11 catalogPostedDate];
    [v41 setCatalogPostedDate:v45];

    v46 = [v11 downloadedCatalogCachedAssetSetID];
    [v41 setDownloadedCatalogCachedAssetSetID:v46];

    v47 = [v11 downloadedCatalogDownloadedFromLive];
    [v41 setDownloadedCatalogDownloadedFromLive:v47];

    v48 = [v11 downloadedCatalogLastTimeChecked];
    [v41 setDownloadedCatalogLastTimeChecked:v48];

    v49 = [v11 downloadedCatalogPostedDate];
    [v41 setDownloadedCatalogPostedDate:v49];

    [v41 setRequestedAutoAssetEntries:obj];
    v50 = [v65 atomicInstanceUUID];
    [v41 setLatestDownloadedAtomicInstance:v50];

    [v41 setLatestDowloadedAtomicInstanceEntries:v67];
    [v41 setIsOnFilesystem:1];
    [v41 setIsDiscoveredFullyDownloaded:1];
    [v41 setAtomicInstanceDownloadedNotified:1];
    [v41 setNeverBeenLocked:1];
    v51 = [v41 latestDownloadedAtomicInstance];
    v52 = [v66 autoAssetSetClientName];
    LOBYTE(v63) = 0;
    BYTE2(v62) = 1;
    LOWORD(v62) = 0;
    v9 = v71;
    [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v41 forLatestDownloaded:v71 forSpecificAtomicInstance:1 withCurrentSetStatus:v51 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v62 latestToVend:355 historyOperation:v52 firstClientName:v63 fromPreSUStaging:?];

    [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v71 forSetDescriptor:v41];
    v53 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
    {
      v54 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v55 = [v66 summary];
      v56 = [v41 summary];
      *buf = 138543874;
      v80 = v54;
      v81 = 2114;
      v82 = v55;
      v83 = 2114;
      v84 = v56;
      _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {newSetDescriptorFromAlreadyDownloaded}\n[VEND] new set-descriptor from already downloaded | setInfoInstance:%{public}@, newSetDescriptor:%{public}@", buf, 0x20u);
    }

    v57 = v64;
  }

  else
  {
    v58 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [v58 diag];
    v59 = v57 = v13;
    v60 = [[NSString alloc] initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} no autoAssetEntries provided by client when required | setInfoInstance:%@", v9, v10];
    [v59 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v60 withResult:6102 withError:0];

    v41 = 0;
  }

  return v41;
}

- (BOOL)doesSetDescriptor:(id)a3 coverRequestedAutoAssetEntries:(id)a4
{
  v6 = a3;
  v7 = a4;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v10 = [v6 firstAssetType];
  v39 = self;
  v11 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:v7];
  LODWORD(v12) = [SUCore stringIsEqual:v10 to:v11];

  if (!v12)
  {
    goto LABEL_27;
  }

  v44 = objc_alloc_init(NSMutableDictionary);
  v13 = [v6 requestedAutoAssetEntries];

  if (!v13)
  {
    goto LABEL_26;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v37 = v7;
  obj = v7;
  v42 = [obj countByEnumeratingWithState:&v54 objects:v59 count:16];
  if (!v42)
  {
    goto LABEL_25;
  }

  v40 = *v55;
  v41 = v6;
  do
  {
    v14 = 0;
    do
    {
      if (*v55 != v40)
      {
        objc_enumerationMutation(obj);
      }

      v43 = v14;
      v15 = *(*(&v54 + 1) + 8 * v14);
      v50 = 0u;
      v51 = 0u;
      v52 = 0u;
      v53 = 0u;
      v46 = [v6 requestedAutoAssetEntries];
      v49 = [v46 countByEnumeratingWithState:&v50 objects:v58 count:16];
      if (!v49)
      {
        goto LABEL_23;
      }

      v16 = *v51;
      v45 = *v51;
      while (2)
      {
        for (i = 0; i != v49; i = i + 1)
        {
          if (*v51 != v16)
          {
            objc_enumerationMutation(v46);
          }

          v18 = *(*(&v50 + 1) + 8 * i);
          v19 = p_weak_ivar_lyt[223];
          v20 = [v15 assetSelector];
          v21 = [v20 assetType];
          v22 = [v18 assetSelector];
          v23 = [v22 assetType];
          if ([v19 stringIsEqual:v21 to:v23])
          {
            v48 = p_weak_ivar_lyt[223];
            v24 = [v15 assetSelector];
            v25 = [v24 assetSpecifier];
            v47 = v18;
            [v18 assetSelector];
            v27 = v26 = v15;
            v28 = [v27 assetSpecifier];
            LODWORD(v48) = [v48 stringIsEqual:v25 to:v28];

            v15 = v26;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

            v16 = v45;
            if (!v48)
            {
              continue;
            }

            v29 = [v47 assetSelector];
            v20 = [v29 persistedEntryID];

            if (!v20)
            {
              v30 = [(MADAutoAssetControlManager *)v39 autoControlManagerFSM];
              v31 = [v30 diag];
              v32 = [NSString alloc];
              v33 = [v47 assetSelector];
              v34 = [v33 summary];
              v35 = [v32 initWithFormat:@"{doesSetDescriptor:coverRequestedAutoAssetEntries:} unable to form foundSelectorKey | fullAssetSelector:%@", v34];
              [v31 trackAnomaly:@"AUTO-CONTROL" forReason:v35 withResult:6101 withError:0];

              goto LABEL_23;
            }

            [v44 setSafeObject:v20 forKey:v20];
          }

          else
          {
          }
        }

        v49 = [v46 countByEnumeratingWithState:&v50 objects:v58 count:16];
        if (v49)
        {
          continue;
        }

        break;
      }

LABEL_23:

      v14 = v43 + 1;
      v6 = v41;
    }

    while ((v43 + 1) != v42);
    v42 = [obj countByEnumeratingWithState:&v54 objects:v59 count:16];
  }

  while (v42);
LABEL_25:

  v7 = v37;
LABEL_26:
  v12 = [v44 count];
  LOBYTE(v12) = v12 == [v7 count];

LABEL_27:
  return v12;
}

- (BOOL)doesSetDescriptor:(id)a3 referenceAssetDescriptor:(id)a4
{
  v6 = a3;
  v31 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptor:referenceAssetDescriptor:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  v26 = v6;
  obj = [v6 latestDowloadedAtomicInstanceEntries];
  v9 = [obj countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (!v9)
  {
    v24 = 0;
    v12 = v31;
    goto LABEL_16;
  }

  v10 = v9;
  v11 = *v34;
  v12 = v31;
  v28 = *v34;
  do
  {
    v13 = 0;
    v29 = v10;
    do
    {
      if (*v34 != v11)
      {
        objc_enumerationMutation(obj);
      }

      v14 = *(*(&v33 + 1) + 8 * v13);
      v15 = [v12 assetType];
      v16 = [v14 fullAssetSelector];
      v17 = [v16 assetType];
      if (![SUCore stringIsEqual:v15 to:v17])
      {
        goto LABEL_11;
      }

      v18 = [v12 assetSpecifier];
      v19 = [v14 fullAssetSelector];
      v20 = [v19 assetSpecifier];
      v32 = v18;
      if (![SUCore stringIsEqual:v18 to:v20])
      {

        v11 = v28;
        v10 = v29;
        v12 = v31;
LABEL_11:

        goto LABEL_12;
      }

      v21 = [v31 assetVersion];
      v22 = [v14 fullAssetSelector];
      v23 = [v22 assetVersion];
      v27 = [SUCore stringIsEqual:v21 to:v23];

      v12 = v31;
      v11 = v28;
      v10 = v29;
      if (v27)
      {
        v24 = 1;
        goto LABEL_16;
      }

LABEL_12:
      v13 = v13 + 1;
    }

    while (v10 != v13);
    v10 = [obj countByEnumeratingWithState:&v33 objects:v37 count:16];
  }

  while (v10);
  v24 = 0;
LABEL_16:

  return v24;
}

- (BOOL)doesSetDescriptorWithoutVersion:(id)a3 referenceAssetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorWithoutVersion:referenceAssetDescriptor:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  obj = [v6 latestDowloadedAtomicInstanceEntries];
  v10 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = v6;
    v12 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v14 = 0;
      v29 = v11;
      do
      {
        if (*v33 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        v17 = [v7 assetType];
        v18 = [v15 fullAssetSelector];
        v19 = [v18 assetType];
        if ([v16 stringIsEqual:v17 to:v19])
        {
          v31 = p_weak_ivar_lyt[223];
          v20 = [v7 assetSpecifier];
          v21 = [v15 fullAssetSelector];
          [v21 assetSpecifier];
          v22 = p_weak_ivar_lyt;
          v23 = v7;
          v25 = v24 = v12;
          LOBYTE(v31) = [v31 stringIsEqual:v20 to:v25];

          v12 = v24;
          v7 = v23;
          p_weak_ivar_lyt = v22;

          v11 = v29;
          if (v31)
          {
            v26 = 1;
            goto LABEL_13;
          }
        }

        else
        {
        }

        v14 = v14 + 1;
      }

      while (v11 != v14);
      v11 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v11);
    v26 = 0;
LABEL_13:
    v6 = v28;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (BOOL)doesSetDescriptor:(id)a3 referenceSetConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptor:referenceSetConfiguration:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  obj = [v6 latestDowloadedAtomicInstanceEntries];
  v10 = [obj countByEnumeratingWithState:&v23 objects:v27 count:16];
  if (v10)
  {
    v11 = v10;
    v21 = v6;
    v12 = *v24;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v24 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = [*(*(&v23 + 1) + 8 * i) fullAssetSelector];
        v15 = [v14 assetType];
        v16 = [v7 autoAssetEntries];
        v17 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:v16];
        v18 = [SUCore stringIsEqual:v15 to:v17];

        if (v18)
        {
          v19 = 1;
          goto LABEL_11;
        }
      }

      v11 = [obj countByEnumeratingWithState:&v23 objects:v27 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }

    v19 = 0;
LABEL_11:
    v6 = v21;
  }

  else
  {
    v19 = 0;
  }

  return v19;
}

- (BOOL)doesSetDescriptorReferenceDropped:(id)a3 forSetDescriptor:(id)a4
{
  v31 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
  v10 = [v9 count];

  if (v10)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorReferenceDropped" ofContainer:@"descriptorsDroppedOnStartup"];
    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    v30 = v6;
    obj = [v6 latestDowloadedAtomicInstanceEntries];
    v11 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    if (v11)
    {
      v12 = v11;
      v32 = 0;
      v13 = *v39;
      do
      {
        for (i = 0; i != v12; i = i + 1)
        {
          if (*v39 != v13)
          {
            objc_enumerationMutation(obj);
          }

          v15 = *(*(&v38 + 1) + 8 * i);
          v16 = [v15 fullAssetSelector];
          v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v16];

          if (v17)
          {
            v36 = 0u;
            v37 = 0u;
            v34 = 0u;
            v35 = 0u;
            v18 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            v19 = [v18 countByEnumeratingWithState:&v34 objects:v42 count:16];
            if (v19)
            {
              v20 = v19;
              v21 = *v35;
              while (2)
              {
                for (j = 0; j != v20; j = j + 1)
                {
                  if (*v35 != v21)
                  {
                    objc_enumerationMutation(v18);
                  }

                  if ([v17 isEqualSelector:*(*(&v34 + 1) + 8 * j)])
                  {
                    v32 = 1;
                    goto LABEL_19;
                  }
                }

                v20 = [v18 countByEnumeratingWithState:&v34 objects:v42 count:16];
                if (v20)
                {
                  continue;
                }

                break;
              }
            }
          }

          else
          {
            v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v23 = [v18 diag];
            v24 = [NSString alloc];
            v25 = [v30 summary];
            v26 = [v15 summary];
            v27 = [v24 initWithFormat:@"{%@:doesSetDescriptorReferenceDropped:} downloaded set-descriptor missing asset-descriptor | setDescriptor:%@ | nextDownloadedEntry:%@", v31, v25, v26];
            [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6101 withError:0];
          }

LABEL_19:
        }

        v12 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
      }

      while (v12);
    }

    else
    {
      v32 = 0;
    }

    v6 = v30;
    v28 = v32;
  }

  else
  {
    v28 = 0;
  }

  return v28 & 1;
}

- (BOOL)doesSetDescriptorReferenceAllPreInstalledContent:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 latestDowloadedAtomicInstanceEntries];
  v8 = [v7 count];

  if (v8)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorReferenceAllPreInstalledContent" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
    v30 = 0u;
    v31 = 0u;
    v28 = 0u;
    v29 = 0u;
    obj = [v4 latestDowloadedAtomicInstanceEntries];
    v9 = [obj countByEnumeratingWithState:&v28 objects:v32 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v29;
      v26 = self;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v29 != v11)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v28 + 1) + 8 * i);
          v14 = [v13 fullAssetSelector];
          v15 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v14];

          if (v15)
          {
            if (([v15 foundAsPreInstalled] & 1) == 0)
            {

              v24 = 0;
              goto LABEL_15;
            }
          }

          else
          {
            v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v17 = [v16 diag];
            v18 = [NSString alloc];
            [v4 summary];
            v19 = v11;
            v21 = v20 = v4;
            v22 = [v13 summary];
            v23 = [v18 initWithFormat:@"{doesSetDescriptor:doesSetDescriptorReferenceAllPreInstalledContent:} downloaded set-descriptor missing asset-descriptor | setDescriptor:%@ | nextDownloadedEntry:%@", v21, v22];
            [v17 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6101 withError:0];

            v4 = v20;
            v11 = v19;
            self = v26;
          }
        }

        v10 = [obj countByEnumeratingWithState:&v28 objects:v32 count:16];
      }

      while (v10);
    }

    v24 = 1;
LABEL_15:
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (BOOL)isAnyAssetEntryOnFilesystemForSetDescriptor:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:isAnyAssetEntryOnFilesystemForSetDescriptor:forSetDescriptor:", v6];
  v41 = 0;
  v11 = [v7 latestDowloadedAtomicInstanceEntries];
  v12 = [v11 count];

  v36 = v10;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  obj = [v7 latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v37 objects:v54 count:16];
  if (!v13)
  {
    v17 = 0;
    goto LABEL_21;
  }

  v14 = v13;
  v31 = v12;
  v32 = v6;
  v34 = v7;
  v15 = 0;
  v16 = 0;
  v17 = 0;
  v18 = *v38;
  while (2)
  {
    v19 = 0;
    v20 = v15 + 1;
    v33 = &v14[v15];
    v21 = v16;
    do
    {
      if (*v38 != v18)
      {
        objc_enumerationMutation(obj);
      }

      v22 = *(*(&v37 + 1) + 8 * v19);
      v23 = [v22 localContentURL];

      if (!v23)
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          v26 = [v22 summary];
          v27 = [v34 summary];
          *buf = 138544386;
          v43 = v36;
          v44 = 2048;
          v45 = v20;
          v46 = 2048;
          v47 = v31;
          v48 = 2114;
          v49 = v26;
          v50 = 2114;
          v51 = v27;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);
        }

        goto LABEL_19;
      }

      v24 = [v22 localContentURL];
      v16 = [v24 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:v36 atPath:v16 isDirectory:&v41])
      {
        goto LABEL_10;
      }

      if ((v41 & 1) == 0)
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          v28 = [v22 summary];
          v29 = [v34 summary];
          *buf = 138544642;
          v43 = v36;
          v44 = 2048;
          v45 = v20;
          v46 = 2048;
          v47 = v31;
          v48 = 2114;
          v49 = v28;
          v50 = 2114;
          v51 = v16;
          v52 = 2114;
          v53 = v29;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@", buf, 0x3Eu);
        }

        v21 = v16;
LABEL_19:

        v17 = 0;
        v16 = v21;
        goto LABEL_20;
      }

      v17 = 1;
LABEL_10:
      ++v19;
      ++v20;
      v21 = v16;
    }

    while (v14 != v19);
    v14 = [obj countByEnumeratingWithState:&v37 objects:v54 count:16];
    v15 = v33;
    if (v14)
    {
      continue;
    }

    break;
  }

LABEL_20:

  v6 = v32;
  v7 = v34;
LABEL_21:

  return v17 & 1;
}

- (BOOL)isEveryAssetEntryOnFilesystemForSetDescriptor:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:isEveryAssetEntryOnFilesystemForSetDescriptor:forSetDescriptor:", v6];
  v40 = 0;
  v11 = [v7 latestDowloadedAtomicInstanceEntries];
  v12 = [v11 count];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [v7 latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v36 objects:v53 count:16];
  if (v13)
  {
    v14 = v13;
    v31 = v12;
    v32 = v7;
    v33 = v6;
    v15 = 0;
    v16 = 0;
    v17 = *v37;
    while (2)
    {
      v18 = 0;
      v19 = v15 + 1;
      v34 = &v14[v15];
      v20 = v16;
      do
      {
        if (*v37 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v21 = *(*(&v36 + 1) + 8 * v18);
        v22 = [v21 localContentURL];

        if (!v22)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            v26 = [v21 summary];
            v7 = v32;
            v27 = [v32 summary];
            *buf = 138544386;
            v42 = v10;
            v43 = 2048;
            v44 = v19;
            v45 = 2048;
            v46 = v31;
            v47 = 2114;
            v48 = v26;
            v49 = 2114;
            v50 = v27;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);

            goto LABEL_17;
          }

          goto LABEL_19;
        }

        v23 = [v21 localContentURL];
        v16 = [v23 path];

        if ([(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:v10 atPath:v16 isDirectory:&v40]&& (v40 & 1) == 0)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            v28 = [v21 summary];
            v7 = v32;
            v29 = [v32 summary];
            *buf = 138544642;
            v42 = v10;
            v43 = 2048;
            v44 = v19;
            v45 = 2048;
            v46 = v31;
            v47 = 2114;
            v48 = v28;
            v49 = 2114;
            v50 = v16;
            v51 = 2114;
            v52 = v29;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@", buf, 0x3Eu);

            v20 = v16;
LABEL_17:
            v6 = v33;
LABEL_20:

            v24 = 0;
            v16 = v20;
            goto LABEL_21;
          }

          v20 = v16;
LABEL_19:
          v7 = v32;
          v6 = v33;
          goto LABEL_20;
        }

        ++v18;
        ++v19;
        v20 = v16;
      }

      while (v14 != v18);
      v14 = [obj countByEnumeratingWithState:&v36 objects:v53 count:16];
      v15 = v34;
      if (v14)
      {
        continue;
      }

      break;
    }

    v24 = 1;
    v7 = v32;
    v6 = v33;
LABEL_21:
  }

  else
  {
    v24 = 1;
  }

  return v24;
}

- (BOOL)doesSetDescriptor:(id)a3 coverAllForAutoAssetEntries:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v40 = v6;
  v11 = [v6 firstAssetType];
  v39 = self;
  v12 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:v7];
  v13 = [SUCore stringIsEqual:v11 to:v12];

  if (!v13)
  {
    goto LABEL_27;
  }

  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  obj = v7;
  v37 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
  if (!v37)
  {
    LOBYTE(v13) = 1;
    goto LABEL_26;
  }

  v38 = *v52;
  v35 = v7;
LABEL_4:
  v14 = 0;
LABEL_5:
  if (*v52 != v38)
  {
    objc_enumerationMutation(obj);
  }

  v41 = v14;
  v15 = *(*(&v51 + 1) + 8 * v14);
  v47 = 0u;
  v48 = 0u;
  v49 = 0u;
  v50 = 0u;
  v44 = [v40 latestDowloadedAtomicInstanceEntries];
  v16 = [v44 countByEnumeratingWithState:&v47 objects:v55 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v48;
    v42 = v15;
LABEL_9:
    v19 = 0;
    v43 = v17;
    while (1)
    {
      if (*v48 != v18)
      {
        objc_enumerationMutation(v44);
      }

      v20 = *(*(&v47 + 1) + 8 * v19);
      v21 = p_weak_ivar_lyt[223];
      v22 = [v15 assetSelector];
      v23 = [v22 assetType];
      v46 = v20;
      v24 = [v20 fullAssetSelector];
      v25 = [v24 assetType];
      if ([v21 stringIsEqual:v23 to:v25])
      {
        v45 = p_weak_ivar_lyt[223];
        v26 = [v15 assetSelector];
        v27 = [v26 assetSpecifier];
        v28 = [v46 fullAssetSelector];
        [v28 assetSpecifier];
        v30 = v29 = v18;
        LOBYTE(v45) = [v45 stringIsEqual:v27 to:v30];

        v18 = v29;
        v17 = v43;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v15 = v42;

        if (v45)
        {
          v31 = [v46 fullAssetSelector];
          v32 = [(MADAutoAssetControlManager *)v39 locateDownloadedByFullSelector:v31];

          v33 = [v32 isOnFilesystem];
          if (!v33)
          {
            goto LABEL_24;
          }

          v14 = v41 + 1;
          if ((v41 + 1) != v37)
          {
            goto LABEL_5;
          }

          LOBYTE(v13) = 1;
          v7 = v35;
          v37 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
          if (!v37)
          {
            goto LABEL_26;
          }

          goto LABEL_4;
        }
      }

      else
      {
      }

      if (v17 == ++v19)
      {
        v17 = [v44 countByEnumeratingWithState:&v47 objects:v55 count:16];
        if (v17)
        {
          goto LABEL_9;
        }

        break;
      }
    }
  }

LABEL_24:
  LOBYTE(v13) = 0;
  v7 = v35;
LABEL_26:

LABEL_27:
  return v13;
}

- (BOOL)doesSetJobDescriptor:(id)a3 representSameContentAs:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 latestDowloadedAtomicInstanceEntries];
  v11 = [v10 count];
  v32 = v7;
  v12 = [v7 latestDowloadedAtomicInstanceEntries];
  v13 = [v12 count];

  if (v11 == v13)
  {
    v39 = 0u;
    v40 = 0u;
    v37 = 0u;
    v38 = 0u;
    obj = [v6 latestDowloadedAtomicInstanceEntries];
    v14 = [obj countByEnumeratingWithState:&v37 objects:v42 count:16];
    if (v14)
    {
      v15 = v14;
      v31 = *v38;
      v29 = v6;
      while (1)
      {
        v16 = 0;
LABEL_5:
        if (*v38 != v31)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v37 + 1) + 8 * v16);
        v33 = 0u;
        v34 = 0u;
        v35 = 0u;
        v36 = 0u;
        v18 = [v32 latestDowloadedAtomicInstanceEntries];
        v19 = [v18 countByEnumeratingWithState:&v33 objects:v41 count:16];
        if (!v19)
        {
          break;
        }

        v20 = v19;
        v21 = *v34;
LABEL_9:
        v22 = 0;
        while (1)
        {
          if (*v34 != v21)
          {
            objc_enumerationMutation(v18);
          }

          v23 = *(*(&v33 + 1) + 8 * v22);
          v24 = [v17 fullAssetSelector];
          v25 = [v23 fullAssetSelector];
          v26 = [v24 isEqual:v25];

          if (v26)
          {
            break;
          }

          if (v20 == ++v22)
          {
            v20 = [v18 countByEnumeratingWithState:&v33 objects:v41 count:16];
            if (v20)
            {
              goto LABEL_9;
            }

            goto LABEL_20;
          }
        }

        if (++v16 != v15)
        {
          goto LABEL_5;
        }

        v15 = [obj countByEnumeratingWithState:&v37 objects:v42 count:16];
        v27 = 1;
        v6 = v29;
        if (!v15)
        {
          goto LABEL_22;
        }
      }

LABEL_20:

      v27 = 0;
      v6 = v29;
    }

    else
    {
      v27 = 1;
    }

LABEL_22:
  }

  else
  {
    v27 = 0;
  }

  return v27;
}

- (BOOL)doesSetDescriptor:(id)a3 coverAllForAtomicInstanceEntries:(id)a4
{
  v31 = a3;
  v6 = a4;
  v29 = self;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  obj = v6;
  v28 = [obj countByEnumeratingWithState:&v46 objects:v51 count:16];
  if (!v28)
  {
    LOBYTE(v25) = 1;
    goto LABEL_26;
  }

  v30 = *v47;
  do
  {
    v9 = 0;
LABEL_4:
    if (*v47 != v30)
    {
      objc_enumerationMutation(obj);
    }

    v32 = v9;
    v10 = *(*(&v46 + 1) + 8 * v9);
    v42 = 0u;
    v43 = 0u;
    v44 = 0u;
    v45 = 0u;
    v37 = [v31 latestDowloadedAtomicInstanceEntries];
    v41 = [v37 countByEnumeratingWithState:&v42 objects:v50 count:16];
    if (!v41)
    {
LABEL_24:

      LOBYTE(v25) = 0;
      break;
    }

    v11 = *v43;
    v36 = *v43;
    v33 = v10;
LABEL_8:
    v12 = 0;
    while (1)
    {
      if (*v43 != v11)
      {
        objc_enumerationMutation(v37);
      }

      v13 = *(*(&v42 + 1) + 8 * v12);
      v14 = [v10 fullAssetSelector];
      v15 = [v14 assetType];
      v16 = [v13 fullAssetSelector];
      v17 = [v16 assetType];
      if (![SUCore stringIsEqual:v15 to:v17])
      {
        goto LABEL_16;
      }

      v40 = [v10 fullAssetSelector];
      v18 = [v40 assetSpecifier];
      v38 = [v13 fullAssetSelector];
      v19 = [v38 assetSpecifier];
      v39 = v18;
      if (![SUCore stringIsEqual:v18 to:v19])
      {

        v11 = v36;
LABEL_16:

        goto LABEL_17;
      }

      v34 = [v10 fullAssetSelector];
      v20 = [v34 assetVersion];
      v21 = [v13 fullAssetSelector];
      v22 = [v21 assetVersion];
      v35 = [SUCore stringIsEqual:v20 to:v22];

      v10 = v33;
      v11 = v36;
      if (v35)
      {
        break;
      }

LABEL_17:
      if (v41 == ++v12)
      {
        v41 = [v37 countByEnumeratingWithState:&v42 objects:v50 count:16];
        if (v41)
        {
          goto LABEL_8;
        }

        goto LABEL_24;
      }
    }

    v23 = [v13 fullAssetSelector];
    v24 = [(MADAutoAssetControlManager *)v29 locateDownloadedByFullSelector:v23];

    v25 = [v24 isOnFilesystem];
    if (!v25)
    {
      break;
    }

    v9 = v32 + 1;
    if ((v32 + 1) != v28)
    {
      goto LABEL_4;
    }

    LOBYTE(v25) = 1;
    v28 = [obj countByEnumeratingWithState:&v46 objects:v51 count:16];
  }

  while (v28);
LABEL_26:

  return v25;
}

- (id)locateSetDescriptor:(id)a3 forAtomicInstanceUUID:(id)a4 requireExists:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = v9;
  v40 = [[NSString alloc] initWithFormat:@"%@:locateSetDescriptor", v8];
  if (!v9)
  {
    v26 = 0;
    goto LABEL_33;
  }

  v13 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v14 = [v13 persistedEntryIDs:v8];

  if (![v14 count])
  {
    v26 = 0;
    goto LABEL_32;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v40 ofContainer:@"persistedDownloadedSetDescriptors"];
  v44 = 0u;
  v45 = 0u;
  v42 = 0u;
  v43 = 0u;
  obj = v14;
  v41 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
  if (!v41)
  {
    v26 = 0;
    goto LABEL_31;
  }

  v36 = v14;
  v37 = v5;
  v15 = *v43;
  v16 = obj;
  v39 = *v43;
  while (2)
  {
    for (i = 0; i != v41; i = i + 1)
    {
      if (*v43 != v15)
      {
        objc_enumerationMutation(v16);
      }

      v18 = *(*(&v42 + 1) + 8 * i);
      v19 = objc_autoreleasePoolPush();
      if (!v18)
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v47 = v40;
          v48 = 2114;
          v49 = v12;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[KNOWN-SET-DESCRIPTORS]{%{public}@} no entryID | atomicInstanceUUID:%{public}@", buf, 0x16u);
        }

        goto LABEL_21;
      }

      if (![v18 containsString:v12])
      {
        goto LABEL_22;
      }

      v20 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v21 = [v20 persistedEntry:v18 fromLocation:v8];

      if (v21)
      {
        v22 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        v23 = [v22 decodeFromLocation:v40 ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v23)
        {
          v24 = v8;
          v25 = [v23 latestDownloadedAtomicInstance];
          if ([SUCore stringIsEqual:v25 to:v12])
          {
            v26 = v23;

LABEL_29:
            objc_autoreleasePoolPop(v19);
            v8 = v24;
            goto LABEL_30;
          }

          v26 = v23;
          [v23 discoveredAtomicInstance];
          v27 = self;
          v29 = v28 = v12;
          v30 = [SUCore stringIsEqual:v29 to:v28];

          v12 = v28;
          self = v27;

          if (v30)
          {
            goto LABEL_29;
          }

          v8 = v24;
          v16 = obj;
          v15 = v39;
          v23 = v26;
          goto LABEL_20;
        }
      }

      else
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v47 = v40;
          v48 = 2114;
          v49 = v12;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "\n[KNOWN-SET-DESCRIPTORS]{%{public}@} unable to load persisted entry | atomicInstanceUUID:%{public}@", buf, 0x16u);
        }
      }

      v15 = v39;
LABEL_20:

LABEL_21:
LABEL_22:
      objc_autoreleasePoolPop(v19);
    }

    v41 = [v16 countByEnumeratingWithState:&v42 objects:v50 count:16];
    if (v41)
    {
      continue;
    }

    break;
  }

  v26 = 0;
LABEL_30:
  v5 = v37;
  v14 = v36;
LABEL_31:

LABEL_32:
  if (!v26)
  {
LABEL_33:
    if (v5)
    {
      v31 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v32 = [v31 diag];
      v33 = v12;
      v34 = [[NSString alloc] initWithFormat:@"{%@} unable to locate atomic-instance UUID | atomicInstanceUUID:%@", v40, v12];
      [v32 trackAnomaly:@"KNOWN-SET-DESCRIPTORS" forReason:v34 withResult:6103 withError:0];

      v12 = v33;
    }
  }

  return v26;
}

- (BOOL)wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 autoAssetEntries];
  v8 = [(MADAutoAssetControlManager *)self locateSetLookupResultSatisfying:v7];

  if (!v8)
  {
    v31 = 0;
    goto LABEL_32;
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v9 = [v8 discoveredAtomicEntries];
  v38 = [v9 countByEnumeratingWithState:&v46 objects:v51 count:16];
  if (!v38)
  {
    v31 = 1;
    goto LABEL_31;
  }

  v10 = *v47;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v33 = v8;
  v34 = v4;
  v36 = self;
  v37 = v9;
  v35 = *v47;
LABEL_4:
  v12 = 0;
  v13 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  while (1)
  {
    if (*v47 != v10)
    {
      objc_enumerationMutation(v9);
    }

    v39 = v12;
    v14 = [*(*(&v46 + 1) + 8 * v12) fullAssetSelector];
    v15 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v14];

    if (!v15)
    {
      break;
    }

    if ([p_weak_ivar_lyt[287] doesDescriptorInvolvePersonalization:@"wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance" forDescriptor:v15] && objc_msgSend(p_weak_ivar_lyt[287], "isPersonalizationRequired:forDescriptor:", @"wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance", v15))
    {
      v44 = 0u;
      v45 = 0u;
      v42 = 0u;
      v43 = 0u;
      obj = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
      v16 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
      if (!v16)
      {
        goto LABEL_29;
      }

      v17 = v16;
      v18 = *v43;
      while (1)
      {
        v19 = 0;
        v40 = v17;
        do
        {
          if (*v43 != v18)
          {
            objc_enumerationMutation(obj);
          }

          v20 = *(*(&v42 + 1) + 8 * v19);
          v21 = v13[223];
          v22 = [v20 assetType];
          v23 = [v15 assetType];
          if (![v21 stringIsEqual:v22 to:v23])
          {
            goto LABEL_20;
          }

          v24 = v18;
          v25 = v13[223];
          v26 = [v20 assetSpecifier];
          v27 = [v15 assetSpecifier];
          if (![v25 stringIsEqual:v26 to:v27])
          {

            v18 = v24;
            v17 = v40;
LABEL_20:

            goto LABEL_21;
          }

          v28 = v13[223];
          v29 = [v20 assetVersion];
          v30 = [v15 assetVersion];
          LOBYTE(v28) = [v28 stringIsEqual:v29 to:v30];

          v13 = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v18 = v24;
          v17 = v40;
          if (v28)
          {

            self = v36;
            v9 = v37;
            v10 = v35;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            goto LABEL_24;
          }

LABEL_21:
          v19 = v19 + 1;
        }

        while (v17 != v19);
        v17 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
        if (!v17)
        {
LABEL_29:

          v9 = v37;
          goto LABEL_30;
        }
      }
    }

LABEL_24:

    v12 = v39 + 1;
    if ((v39 + 1) == v38)
    {
      v31 = 1;
      v8 = v33;
      v4 = v34;
      v38 = [v9 countByEnumeratingWithState:&v46 objects:v51 count:16];
      if (!v38)
      {
        goto LABEL_31;
      }

      goto LABEL_4;
    }
  }

LABEL_30:

  v31 = 0;
  v8 = v33;
  v4 = v34;
LABEL_31:

LABEL_32:
  return v31;
}

- (id)preInstalledSetDescriptor:(id)a3 forClientDomainName:(id)a4 forSetClientName:(id)a5 forAssetSetIdentifier:(id)a6 forAssetType:(id)a7
{
  v12 = a3;
  v61 = a4;
  v59 = a5;
  v60 = a6;
  v13 = a7;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v66 = self;
  v67 = [[NSString alloc] initWithFormat:@"%@:preInstalledSetDescriptor", v12];
  v62 = v13;
  v16 = [MADAutoAssetControlManager _allPreInstalledDescriptor:"_allPreInstalledDescriptor:forAssetType:" forAssetType:?];
  v17 = objc_opt_new();
  v63 = v12;
  if ([v16 count])
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v79 = v67;
      v80 = 2048;
      v81 = [v16 count];
      v82 = 2114;
      v83 = v13;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "{%{public}@} Found %lu preinstalled asset descriptor(s) matching assetType: %{public}@", buf, 0x20u);
    }

    v74 = 0u;
    v75 = 0u;
    v72 = 0u;
    v73 = 0u;
    v19 = v16;
    v20 = v16;
    v21 = [v20 countByEnumeratingWithState:&v72 objects:v77 count:16];
    if (v21)
    {
      v22 = v21;
      v23 = *v73;
      do
      {
        for (i = 0; i != v22; i = i + 1)
        {
          if (*v73 != v23)
          {
            objc_enumerationMutation(v20);
          }

          v25 = *(*(&v72 + 1) + 8 * i);
          v26 = [MANAutoAssetSetEntry alloc];
          v27 = [v25 assetType];
          v28 = [v25 assetSpecifier];
          v29 = [(MANAutoAssetSetEntry *)v26 initForAssetType:v27 withAssetSpecifier:v28];

          [v17 addObject:v29];
        }

        v22 = [v20 countByEnumeratingWithState:&v72 objects:v77 count:16];
      }

      while (v22);
    }

    v16 = v19;
    v12 = v63;
  }

  v70 = 0u;
  v71 = 0u;
  v68 = 0u;
  v69 = 0u;
  v30 = v17;
  v31 = [v30 countByEnumeratingWithState:&v68 objects:v76 count:16];
  obj = v30;
  if (v31)
  {
    v32 = v31;
    v58 = v16;
    v33 = 0;
    v65 = *v69;
    v34 = 1;
    do
    {
      for (j = 0; j != v32; j = j + 1)
      {
        if (*v69 != v65)
        {
          objc_enumerationMutation(obj);
        }

        v36 = *(*(&v68 + 1) + 8 * j);
        v37 = objc_autoreleasePoolPush();
        v38 = [v36 assetSelector];
        v39 = [v38 assetType];
        v40 = [v36 assetSelector];
        v41 = [v40 assetSpecifier];
        v42 = [(MADAutoAssetControlManager *)v66 _preInstalledDescriptor:v67 forAssetType:v39 withAssetSpecifier:v41];

        v43 = v42 != 0;
        v34 &= v43;
        v33 |= v43;

        objc_autoreleasePoolPop(v37);
      }

      v30 = obj;
      v32 = [obj countByEnumeratingWithState:&v68 objects:v76 count:16];
    }

    while (v32);

    v12 = v63;
    v16 = v58;
    if (!(v34 & 1 | ((v33 & 1) == 0)))
    {
      v44 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543874;
        v79 = v67;
        v80 = 2114;
        v81 = v61;
        v82 = 2114;
        v83 = v60;
        _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {%{public}@} found some asset-specifiers as pre-installed - returning found subset | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
      }
    }

    if (((v34 | v33) & 1) == 0)
    {
      v45 = 0;
      v47 = v60;
      v46 = v61;
      v48 = v59;
      goto LABEL_38;
    }
  }

  else
  {
  }

  v49 = [(MADAutoAssetControlManager *)v66 _preInstalledSetAtomicEntriesFromInstanceEntries:v30];
  v47 = v60;
  v46 = v61;
  v48 = v59;
  if (v49)
  {
    v50 = [(MADAutoAssetControlManager *)v66 atomicInstanceNewSetAtomicInstance:v67 forCreationReason:@"FROM_PREINSTALLED" recordingHistoryOperation:224 forClientDomainName:v61 forSetClientName:v59 forAssetSetIdentifier:v60 representingInstanceEntries:v30 recoveringAtomicInstanceUUID:0 asSubAtomicFrom:0];
    v51 = v50;
    if (v50)
    {
      v52 = [v50 atomicInstanceUUID];
      v53 = [[MADAutoSetDescriptor alloc] initForClientDomainName:v61 forAssetSetIdentifier:v60 withDiscoveredAtomicInstance:v52 withDiscoveredAtomicEntries:v49];
      v45 = v53;
      if (v53)
      {
        [v53 setRequestedAutoAssetEntries:obj];
        [v45 setLatestDownloadedAtomicInstance:v52];
        [v45 setLatestDowloadedAtomicInstanceEntries:v49];
        [v45 setIsOnFilesystem:1];
        [v45 setIsDiscoveredFullyDownloaded:1];
        [v45 setAtomicInstanceDownloadedNotified:1];
        [v45 setNeverBeenLocked:1];
        [(MADAutoAssetControlManager *)v66 setDescriptorAddedPreInstalled:v45];
        v54 = v45;
      }

      else
      {
        v55 = v16;
        v56 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543874;
          v79 = v67;
          v80 = 2114;
          v81 = v61;
          v82 = 2114;
          v83 = v60;
          _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {%{public}@} unable to allocate set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)v66 atomicInstanceRemove:v67 setAtomicInstanceUUID:v52 removingForReason:@"unable to allocate set-descriptor" historyOperation:337];
        v16 = v55;
        v12 = v63;
      }
    }

    else
    {
      v45 = 0;
    }
  }

  else
  {
    v45 = 0;
  }

LABEL_38:

  return v45;
}

- (id)locateSetDescriptorsDownloaded
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = objc_alloc_init(NSMutableArray);
  v6 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetDescriptorsDownloaded" ofContainer:@"setDescriptorWalkKeys"];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v7 = v6;
  v8 = [v7 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v18;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v18 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v17 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        v14 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"locateSetDescriptorsDownloaded" forKey:v12, v17];
        if (v14)
        {
          [v5 addObject:v14];
        }

        objc_autoreleasePoolPop(v13);
      }

      v9 = [v7 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v9);
  }

  if ([v5 count])
  {
    v15 = v5;
  }

  else
  {
    v15 = 0;
  }

  return v15;
}

- (id)locateSetDescriptorActiveJobByAtomicInstanceUUID:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v8 = [v7 safeObjectForKey:v4 ofClass:objc_opt_class()];

  return v8;
}

- (id)locateSetDescriptorActiveJobByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v6];
  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (id)locateSetDescriptorActiveJobPreferringByAtomicInstance:(id)a3 elseByClientDomain:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  if (v8)
  {
    [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:v8];
  }

  else
  {
    [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByClientDomain:v9 forAssetSetIdentifier:v10];
  }
  v13 = ;

  return v13;
}

- (id)locateSetDescriptorForSelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v4];

  v8 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v7];

  return v8;
}

- (id)locateSetDescriptorForAssetDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4)
  {
    v7 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetDescriptorForAssetDescriptor" ofContainer:@"setDescriptorWalkKeys"];
    v19 = 0u;
    v20 = 0u;
    v17 = 0u;
    v18 = 0u;
    v8 = v7;
    v9 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v18;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v18 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v13 = *(*(&v17 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"locateSetDescriptorForAssetDescriptor" forKey:v13, v17];
          if (v15 && [(MADAutoAssetControlManager *)self doesSetDescriptor:v15 referenceAssetDescriptor:v4])
          {
            objc_autoreleasePoolPop(v14);
            goto LABEL_14;
          }

          objc_autoreleasePoolPop(v14);
        }

        v10 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

    v15 = 0;
LABEL_14:
  }

  else
  {
    v15 = 0;
  }

  return v15;
}

- (id)locateActiveAutoJobForSetDescriptor:(id)a3
{
  v23 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  obj = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v6 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v27;
    v9 = v23;
    v22 = *v27;
    do
    {
      v10 = 0;
      v24 = v7;
      do
      {
        if (*v27 != v8)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v26 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        v13 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
        v14 = [v13 safeObjectForKey:v11 ofClass:objc_opt_class()];

        if ([v14 autoAssetSetJob])
        {
          v15 = [v14 clientDomainName];
          v16 = [v9 clientDomainName];
          if (([SUCore stringIsEqual:v15 to:v16]& 1) != 0)
          {
            [v14 autoAssetSetIdentifier];
            v18 = v17 = self;
            v19 = [v9 assetSetIdentifier];
            v20 = [SUCore stringIsEqual:v18 to:v19];

            v9 = v23;
            self = v17;
            v8 = v22;

            v7 = v24;
            if (v20)
            {
              objc_autoreleasePoolPop(v12);
              goto LABEL_15;
            }
          }

          else
          {

            v7 = v24;
          }
        }

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v7 != v10);
      v7 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v7);
    v14 = 0;
  }

  else
  {
    v14 = 0;
    v9 = v23;
  }

LABEL_15:

  return v14;
}

- (BOOL)verifySetDescriptorIsLockable:(id)a3 fromLocation:(id)a4 notLocakableError:(id *)a5 corruptedAtomicEntries:(id *)a6
{
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v73 = v9;
  v12 = [[NSString alloc] initWithFormat:@"%@:verifySetDescriptorIsLockable", v9];
  v13 = objc_alloc_init(NSMutableArray);
  v14 = [v8 latestDowloadedAtomicInstanceEntries];
  v15 = [v14 count];

  if (!v15)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEBUG))
    {
      v17 = [v8 summary];
      *buf = 138412546;
      v87 = v73;
      v88 = 2112;
      v89 = v17;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEBUG, "{%@:verifySetDescriptorIsLockable} zero atomic-instance entries | setJobDescriptor:%@", buf, 0x16u);
    }
  }

  v69 = v13;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v12 ofContainer:@"setDescriptor.latestDowloadedAtomicInstanceEntries"];
  v82 = 0u;
  v83 = 0u;
  v80 = 0u;
  v81 = 0u;
  obj = [v8 latestDowloadedAtomicInstanceEntries];
  v70 = v8;
  v71 = v12;
  v75 = [obj countByEnumeratingWithState:&v80 objects:v85 count:16];
  v18 = 0;
  if (v75)
  {
    v74 = *v81;
    do
    {
      v19 = 0;
      do
      {
        if (*v81 != v74)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v80 + 1) + 8 * v19);
        v21 = [v20 fullAssetSelector];
        v22 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v21];

        if (!v22)
        {
          v33 = [NSString alloc];
          v34 = [v8 summary];
          v35 = [v20 summary];
          v36 = [v33 initWithFormat:@"{%@:verifySetDescriptorIsLockable} no downloaded descriptor | setJobDescriptor:%@ | nextDownloadedAtomicEntry:%@", v73, v34, v35];
          v37 = 6108;
LABEL_22:
          v39 = [MAAutoAssetError buildError:v37 fromOperation:v12 underlyingError:0 withDescription:v36];

          v18 = v39;
          goto LABEL_28;
        }

        if (([v22 isMAAutoAsset] & 1) == 0)
        {
          v38 = [NSString alloc];
          v34 = [v8 summary];
          v35 = [v22 summary];
          v36 = [v38 initWithFormat:@"{%@:verifySetDescriptorIsLockable} not MAAutoAsset | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, v34, v35];
          v37 = 6103;
          goto LABEL_22;
        }

        v23 = self;
        v24 = [v22 assetType];
        if (!v24)
        {
          goto LABEL_26;
        }

        v25 = v24;
        v26 = [v22 assetSpecifier];
        if (!v26)
        {
          goto LABEL_25;
        }

        v27 = v26;
        v28 = [v22 assetVersion];
        if (!v28)
        {
          goto LABEL_24;
        }

        v29 = v28;
        v30 = [v22 assetId];
        if (!v30)
        {

          v8 = v70;
LABEL_24:

LABEL_25:
LABEL_26:
          v40 = [NSString alloc];
          v41 = [v8 summary];
          v42 = [v22 summary];
          v43 = [v40 initWithFormat:@"{%@:verifySetDescriptorIsLockable} MISSING required | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, v41, v42];
          v44 = 6111;
LABEL_27:
          v45 = [MAAutoAssetError buildError:v44 fromOperation:v71 underlyingError:0 withDescription:v43];

          v18 = v45;
          self = v23;
          v12 = v71;
          goto LABEL_28;
        }

        v31 = [v22 metadata];

        v8 = v70;
        if (!v31)
        {
          goto LABEL_26;
        }

        if (([v22 isOnFilesystem] & 1) == 0)
        {
          v46 = [NSString alloc];
          v41 = [v70 summary];
          v42 = [v22 summary];
          v43 = [v46 initWithFormat:@"{%@:verifySetDescriptorIsLockable} not on filesystem | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, v41, v42];
          v44 = 6113;
          goto LABEL_27;
        }

        self = v23;
        v32 = v23;
        v12 = v71;
        if (![(MADAutoAssetControlManager *)v32 isLocalContentValidForSetAtomicEntry:v20 fromLocation:v71])
        {
          [v69 addObject:v20];
        }

LABEL_28:

        v19 = v19 + 1;
      }

      while (v75 != v19);
      v47 = [obj countByEnumeratingWithState:&v80 objects:v85 count:16];
      v75 = v47;
    }

    while (v47);
  }

  v48 = v69;
  if ([v69 count])
  {
    v49 = self;
    v50 = [[NSString alloc] initWithFormat:@"{%@:verifySetDescriptorIsLockable} corrupted assets: ", v12];
    v76 = 0u;
    v77 = 0u;
    v78 = 0u;
    v79 = 0u;
    v51 = v69;
    v52 = [v51 countByEnumeratingWithState:&v76 objects:v84 count:16];
    if (v52)
    {
      v53 = v52;
      v54 = 0;
      v55 = *v77;
      do
      {
        v56 = 0;
        v57 = v50;
        do
        {
          if (*v77 != v55)
          {
            objc_enumerationMutation(v51);
          }

          v58 = [(MADAutoAssetControlManager *)v49 getCorruptedEntryInfo:*(*(&v76 + 1) + 8 * v56)];
          v59 = v58;
          if (v54)
          {
            [v57 stringByAppendingFormat:@", %@", v58];
          }

          else
          {
            [v57 stringByAppendingString:v58];
          }
          v50 = ;

          v56 = v56 + 1;
          v54 = 1;
          v57 = v50;
        }

        while (v53 != v56);
        v53 = [v51 countByEnumeratingWithState:&v76 objects:v84 count:16];
      }

      while (v53);
    }

    v8 = v70;
    v12 = v71;
    self = v49;
    if (v18)
    {
      v60 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        v87 = v73;
        v88 = 2112;
        v89 = v18;
        _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "{%@:verifySetDescriptorIsLockable} Set is not lockable because corrupted asset as well as other not lockable reason is found. Asset corruption error will be returned. The other error is: %@", buf, 0x16u);
      }
    }

    v61 = [MAAutoAssetError buildError:6116 fromOperation:v71 underlyingError:0 withDescription:v50];

    if (a6)
    {
      v62 = v51;
      *a6 = v51;
    }

    v18 = v61;
    v48 = v69;
  }

  if (v18)
  {
    v63 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v64 = [v63 diag];
    [v64 trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"set-descriptor not lockable" withResult:objc_msgSend(v18 withError:{"code"), v18}];
  }

  if (a5)
  {
    v65 = v18;
    *a5 = v18;
  }

  return v18 == 0;
}

- (void)removeSetDescriptorActiveJobByAtomicInstanceUUID:(id)a3
{
  v9 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v7 = [v6 safeObjectForKey:v9 ofClass:objc_opt_class()];

  if (v7)
  {
    v8 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
    [v8 removeObjectForKey:v9];
  }
}

- (void)removeSetDescriptorActiveJobByClientDomain:(id)a3 forAssetSetIdentifier:(id)a4 fromLocation:(id)a5
{
  v8 = a5;
  v9 = a4;
  v10 = a3;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v10 forAssetSetIdentifier:v9];
  if (v13)
  {
    v14 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    v15 = [v14 safeObjectForKey:v13 ofClass:objc_opt_class()];

    if (v15)
    {
      v16 = v13;
      v17 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
      v18 = [v17 persistedEntry:v16 fromLocation:v8];

      v19 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
      [v19 removeObjectForKey:v16];

      if (v18)
      {
        v20 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        [v20 removePersistedEntry:v16 fromLocation:v8];

        v21 = [NSString alloc];
        v22 = [v15 summary];
        v23 = [v21 initWithFormat:@"removed previously active set-descriptor | setDescriptor:%@", v22];
        [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:v8 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v16 removedSetDescriptor:v15 message:v23];
      }

      else
      {
        v24 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
        {
          v25 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v26 = [v15 summary];
          *buf = 138543874;
          v28 = v25;
          v29 = 2114;
          v30 = v8;
          v31 = 2114;
          v32 = v26;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:removeSetDescriptorActiveJobByClientDomain} unable to load persisted-set-descriptor file | locatedActiveJobSetDescriptor:%{public}@", buf, 0x20u);
        }
      }
    }
  }
}

- (void)removeSetDescriptorDownloaded:(id)a3 fromLocation:(id)a4 checkingByInstance:(BOOL)a5 regardlessOfLatest:(BOOL)a6 historyOperationAI:(int64_t)a7 historyOperationSD:(int64_t)a8
{
  v9 = a5;
  v12 = a3;
  v13 = a4;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v63 = v13;
  v16 = [[NSString alloc] initWithFormat:@"%@:removeSetDescriptorDownloaded", v13];
  v17 = objc_alloc_init(NSMutableArray);
  v18 = v17;
  v64 = v12;
  v65 = v16;
  v59 = a7;
  if (v9)
  {
    v61 = v17;
    v19 = [v12 clientDomainName];
    v20 = [v12 assetSetIdentifier];
    v21 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v19 assetSetIdentifier:v20];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v16 ofContainer:@"setDescriptorKeysForAssetSet"];
    v76 = 0u;
    v77 = 0u;
    v74 = 0u;
    v75 = 0u;
    obj = v21;
    v22 = [obj countByEnumeratingWithState:&v74 objects:v85 count:16];
    if (v22)
    {
      v23 = v22;
      v24 = *v75;
      do
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v75 != v24)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v74 + 1) + 8 * i);
          v27 = objc_autoreleasePoolPush();
          v28 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:v16 forKey:v26];
          v29 = v28;
          if (v28)
          {
            v30 = [v28 latestDownloadedAtomicInstance];
            v31 = [v64 latestDownloadedAtomicInstance];
            v32 = [SUCore stringIsEqual:v30 to:v31];

            if (v32)
            {
              if (a6 || ([v64 latestDownloadedAtomicInstance], (v33 = objc_claimAutoreleasedReturnValue()) == 0) || (v34 = v33, objc_msgSend(v29, "latestDownloadedAtomicInstance"), v35 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v64, "latestDownloadedAtomicInstance"), v36 = objc_claimAutoreleasedReturnValue(), v37 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v35, v36), v36, v16 = v65, v35, v34, v37))
              {
                [v61 addObject:v29];
              }
            }
          }

          objc_autoreleasePoolPop(v27);
        }

        v23 = [obj countByEnumeratingWithState:&v74 objects:v85 count:16];
      }

      while (v23);
    }

    v12 = v64;
    a7 = v59;
    v18 = v61;
  }

  else
  {
    [v17 addObject:v12];
  }

  v72 = 0u;
  v73 = 0u;
  v70 = 0u;
  v71 = 0u;
  v62 = v18;
  v38 = v63;
  obja = [v62 countByEnumeratingWithState:&v70 objects:v84 count:16];
  if (obja)
  {
    v67 = *v71;
    do
    {
      for (j = 0; j != obja; j = j + 1)
      {
        if (*v71 != v67)
        {
          objc_enumerationMutation(v62);
        }

        v40 = *(*(&v70 + 1) + 8 * j);
        if (v40)
        {
          [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:*(*(&v70 + 1) + 8 * j)];
          [(MADAutoAssetControlManager *)self secureCheckUngraftAll:v16 forSetDescriptorNoLongerLocked:v40];
          v41 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:v40];
          v42 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          v43 = [v42 persistedEntryAlreadyExists:v41 fromLocation:v38];

          if (v43)
          {
            v44 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v45 = [v44 persistedEntry:v41 fromLocation:v38];

            if (v45)
            {
              v46 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
              [v46 removePersistedEntry:v41 fromLocation:v38];

              v47 = [v40 latestDowloadedAtomicInstanceEntries];
              v48 = [v47 count];
              [v40 clientDomainName];
              v49 = v60 = v45;
              v50 = [v40 assetSetIdentifier];
              v51 = [v40 discoveredAtomicInstance];
              [MADAutoAssetHistory recordOperation:a8 toHistoryType:2 fromLayer:1 usageCount:v48 forClientDomainName:v49 forAssetSetIdentifier:v50 forAtomicInstance:v51];

              a7 = v59;
              v12 = v64;

              v52 = [NSString alloc];
              v53 = [v40 summary];
              v54 = [v52 initWithFormat:@"removed previously downloaded set-descriptor | toBeRemovedSeteDescriptor:%@", v53];
              [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:v63 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v41 removedSetDescriptor:v40 message:v54];

              v45 = v60;
            }

            else
            {
              v53 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
              {
                v55 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v56 = [v40 summary];
                *buf = 138543874;
                v79 = v55;
                v80 = 2114;
                v81 = v63;
                v82 = 2114;
                v83 = v56;
                _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:removeSetDescriptorDownloaded} unable to load persisted-set-descriptor file | toBeRemovedSeteDescriptor:%{public}@", buf, 0x20u);
              }
            }

            v38 = v63;
          }

          v16 = v65;
        }

        v57 = [v12 latestDownloadedAtomicInstance];
        [(MADAutoAssetControlManager *)self atomicInstanceRemove:v38 setAtomicInstanceUUID:v57 removingForReason:v38 historyOperation:a7];
      }

      obja = [v62 countByEnumeratingWithState:&v70 objects:v84 count:16];
    }

    while (obja);
  }
}

- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByDescriptor:(id)a5
{
  v7 = a3;
  v24 = a4;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [a5 latestDowloadedAtomicInstanceEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        v14 = [v12 fullAssetSelector];
        v15 = [v14 assetType];
        if ([v13 stringIsEqual:v15 to:v7])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = v7;
          v21 = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:v21 to:v24];

          v7 = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByLookupResult:(id)a5
{
  v7 = a3;
  v24 = a4;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [a5 discoveredAtomicEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        v14 = [v12 fullAssetSelector];
        v15 = [v14 assetType];
        if ([v13 stringIsEqual:v15 to:v7])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = v7;
          v21 = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:v21 to:v24];

          v7 = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findSetEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByConfiguration:(id)a5
{
  v7 = a3;
  v24 = a4;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [a5 autoAssetEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        v14 = [v12 assetSelector];
        v15 = [v14 assetType];
        if ([v13 stringIsEqual:v15 to:v7])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 assetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = v7;
          v21 = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:v21 to:v24];

          v7 = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findAtomicEntryForAssetType:(id)a3 forAssetSpecifier:(id)a4 representedByStatus:(id)a5
{
  v7 = a3;
  v24 = a4;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [a5 latestDowloadedAtomicInstanceEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        v14 = [v12 fullAssetSelector];
        v15 = [v14 assetType];
        if ([v13 stringIsEqual:v15 to:v7])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = v7;
          v21 = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:v21 to:v24];

          v7 = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (void)initialStatusForJob:(id)a3 usingSelector:(id)a4 withJobUUID:(id)a5 downloadingDescriptor:(id)a6 baseForPatchDescriptor:(id)a7 withClientAssetPolicy:(id)a8
{
  v39 = a4;
  v13 = a6;
  v14 = a8;
  v38 = a7;
  v37 = a5;
  v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v16 = [v15 extendedStateQueue];
  dispatch_assert_queue_V2(v16);

  if (v13)
  {
    v17 = [v13 downloadUserInitiated];
    if (!v14)
    {
      goto LABEL_4;
    }

    goto LABEL_3;
  }

  v17 = 0;
  if (v14)
  {
LABEL_3:
    v17 |= [v14 userInitiated];
  }

LABEL_4:
  v18 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  v19 = [(MADAutoAssetControlManager *)self jobSelectorKey:v39];
  v20 = [v18 safeObjectForKey:v19 ofClass:objc_opt_class()];

  v21 = objc_alloc_init(MAAutoAssetNotifications);
  v22 = [v13 metadata];
  if (v13)
  {
    v34 = [v13 neverBeenLocked];
    v23 = [v13 patchingAttempted];
    v24 = [v13 stagedPriorToAvailable];
    [v13 stagedFromOSVersion];
    v25 = v36 = v14;
    [v13 stagedFromBuildVersion];
    v26 = v35 = v20;
    v27 = [v13 patchingAttemptError];
    LOBYTE(v33) = 0;
    BYTE1(v32) = v24;
    LOBYTE(v32) = v23;
    LOBYTE(v31) = 0;
    v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v39 withNotifications:v21 withAvailableForUseAttributes:v22 withNewerVersionAttributes:0 withNeverBeenLocked:v34 withDownloadUserInitiated:v17 & 1 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v31 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v32 withStagedPriorToAvailable:v25 withStagedFromOSVersion:v26 withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:0 withAvailableForUseError:v27 withPatchingAttemptError:0 withNewerVersionError:?];

    v20 = v35;
    v14 = v36;
  }

  else
  {
    LOBYTE(v33) = 0;
    LOWORD(v32) = 0;
    LOBYTE(v31) = 0;
    v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v39 withNotifications:v21 withAvailableForUseAttributes:v22 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:v17 & 1 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v31 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v32 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];
  }

  if (v20)
  {
    v29 = @"INITIAL(again)";
  }

  else
  {
    v29 = @"INITIAL(first)";
  }

  v30 = [v39 assetVersion];
  [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:v29 currentStatus:v28 forAssetSelector:v39 forActiveJobUUID:v37 matchingAssetVersion:v30 downloadingDescriptor:v13 baseForPatchDescriptor:v38];
}

- (void)initialStatusForSetJob:(id)a3 withJobUUID:(id)a4 usingSetDescriptor:(id)a5 usingSetPolicy:(id)a6
{
  v22 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  if (v10)
  {
    v13 = [v10 clientDomainName];
    v14 = [v10 assetSetIdentifier];
    v15 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v13 forAssetSetIdentifier:v14];

    v16 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
    [v16 setSafeObject:v22 forKey:v15];

    v17 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    [v17 setSafeObject:v22 forKey:v9];

    v18 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    [v18 setSafeObject:v10 forKey:v15];
  }

  else
  {
    v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v18 = [v15 diag];
    [v18 trackAnomaly:@"{initialStatusForSetJob}" forReason:@"Unable to generate initial set status due to nil assignedSetDescriptor" withResult:6108 withError:0];
  }

  v19 = [v10 discoveredAtomicInstance];

  if (v19)
  {
    v20 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
    v21 = [v10 discoveredAtomicInstance];
    [v20 setSafeObject:v10 forKey:v21];
  }
}

- (void)updateAutoAssetStatus:(id)a3 forActiveJobUUID:(id)a4 withLatestJobStatus:(id)a5 matchingAssetVersion:(id)a6 fromLocation:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v19 = [[NSString alloc] initWithFormat:@"%@:updateAutoAssetStatus", v16];
  if (v14)
  {
    v49 = v15;
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) == 0)
    {
      v20 = _MADLog(@"Auto");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{MADAutoAssetControlManager-updateAutoAssetStatus} WARNING: wrong class provided as autoAssetStatus", buf, 2u);
      }
    }

    v21 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
    v22 = [(MADAutoAssetControlManager *)self jobSelectorKey:v12];
    v23 = [v21 safeObjectForKey:v22 ofClass:objc_opt_class()];

    v15 = v49;
    [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:@"UPDATE" currentStatus:v14 forAssetSelector:v12 forActiveJobUUID:v13 matchingAssetVersion:v49 downloadingDescriptor:0 baseForPatchDescriptor:0];
    if (!v13)
    {
      goto LABEL_24;
    }

    if (!v23)
    {
      goto LABEL_24;
    }

    v24 = [v12 assetVersion];

    if (!v24)
    {
      goto LABEL_24;
    }

    v25 = [v12 persistedEntryID];
    v26 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v27 = [v26 persistedEntryAlreadyExists:v25 fromLocation:v19];

    if (!v27)
    {
      v29 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
      {
        v39 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v40 = [v14 summary];
        *buf = 138544130;
        v51 = v39;
        v52 = 2114;
        v53 = v19;
        v54 = 2114;
        v55 = v40;
        v56 = 2114;
        v57 = v13;
        _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] UPDATE_STATUS | %{public}@ | currentStatus:%{public}@ | jobUUID:%{public}@ | no currently persisted active-job descriptor (presumed stale)", buf, 0x2Au);
      }

      goto LABEL_23;
    }

    v28 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v29 = [v28 persistedEntry:v25 fromLocation:v19];

    if (v29)
    {
      v30 = [v14 downloadUserInitiated];
      if (v30 == [v23 downloadUserInitiated])
      {
        v31 = [v14 patchingAttempted];
        if (v31 == [v23 patchingAttempted])
        {
          goto LABEL_23;
        }
      }

      v32 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v33 = [v32 decodeFromLocation:v19 ofEntryName:v25 fromPersistedEntry:v29 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v33)
      {
LABEL_22:

LABEL_23:
        v15 = v49;
LABEL_24:

        goto LABEL_25;
      }

      v34 = [v33 patchedFromBaseSelector];

      if (v34)
      {
        v46 = [v33 patchedFromBaseSelector];
        v48 = [v46 assetType];
        v45 = [v33 patchedFromBaseSelector];
        v47 = [v45 assetSpecifier];
        v44 = [v33 patchedFromBaseSelector];
        v35 = [v44 assetVersion];
        v43 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:v19 forAssetType:v48 withAssetSpecifier:v47 matchingAssetVersion:v35];

        v34 = v43;
      }

      [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v19 operation:@"ENTRY_MODIFY" usingSelector:v12 withJobUUID:v13 triggeredByClientMessage:0 downloadingDescriptor:v33 baseForPatchDescriptor:v34 message:@"update the current status of the auto-asset-job"];
    }

    else
    {
      v41 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v34 = [v41 diag];
      v33 = v41;
      v42 = [[NSString alloc] initWithFormat:@"{%@} no jobPersistedState | persistedEntryID:%@", v19, v25];
      [v34 trackAnomaly:@"AUTO-CONTROL" forReason:v42 withResult:6101 withError:0];
    }

    goto LABEL_22;
  }

  v36 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v37 = [v36 diag];
  v38 = [[NSString alloc] initWithFormat:@"{%@} no progress status", v19];
  [v37 trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6101 withError:0];

LABEL_25:
}

- (void)updateAutoAssetStatusForChosenDownloadedDescriptor:(id)a3 matchingAssetVersion:(id)a4 fromLocation:(id)a5
{
  v7 = self;
  v34 = a5;
  v33 = a4;
  v8 = a3;
  v9 = [(MADAutoAssetControlManager *)v7 autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [MAAutoAssetSelector alloc];
  v12 = [v8 assetType];
  v13 = [v8 assetSpecifier];
  v14 = [v8 assetVersion];
  v35 = [v11 initForAssetType:v12 withAssetSpecifier:v13 matchingAssetVersion:v14];

  v15 = objc_alloc_init(MAAutoAssetNotifications);
  [v15 setContentAvailableForUse:1];
  v31 = [v8 metadata];
  v30 = [v8 neverBeenLocked];
  v29 = [v8 downloadUserInitiated];
  v28 = [v8 downloadedNetworkBytes];
  v27 = [v8 downloadedFilesystemBytes];
  LOBYTE(v7) = [v8 isPatch];
  v16 = [v8 patchedFromBaseSelector];
  v17 = [v8 patchedFromBaseFilesystemBytes];
  v18 = [v8 patchingAttempted];
  v19 = [v8 stagedPriorToAvailable];
  v20 = [v8 stagedFromOSVersion];
  v21 = [v8 stagedFromBuildVersion];
  v22 = [v8 patchingAttemptError];

  LOBYTE(v26) = 0;
  BYTE1(v25) = v19;
  LOBYTE(v25) = v18;
  LOBYTE(v24) = v7;
  v23 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v35 withNotifications:v15 withAvailableForUseAttributes:v31 withNewerVersionAttributes:0 withNeverBeenLocked:v30 withDownloadUserInitiated:v29 withDownloadProgress:0 withDownloadedNetworkBytes:v28 withDownloadedFilesystemBytes:v27 withDownloadedAsPatch:v24 withPatchedFromBaseSelector:v16 withPatchedFromBaseFilesystemBytes:v17 withPatchingAttempted:v25 withStagedPriorToAvailable:v20 withStagedFromOSVersion:v21 withStagedFromBuildVersion:v26 extendingWithCurrentLockUsage:0 withAvailableForUseError:v22 withPatchingAttemptError:0 withNewerVersionError:?];

  [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v35 forActiveJobUUID:0 withLatestJobStatus:v23 matchingAssetVersion:v33 fromLocation:v34];
}

- (id)updateAutoAssetStatus:(id)a3 forActiveJobUUID:(id)a4 forJobResponse:(id)a5 withResponseError:(id)a6
{
  v10 = a3;
  v78 = a4;
  v11 = a5;
  v74 = a6;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [v11 message];
  v15 = [v14 safeObjectForKey:@"found" ofClass:objc_opt_class()];

  v16 = [v15 currentStatus];
  v80 = v11;
  if (v16 || ((v17 = objc_alloc_init(MAAutoAssetNotifications), !v74) ? (v53 = 0, v52 = 0u, LOBYTE(v51) = 0, v50 = 0u) : (v50 = 0uLL, v53 = v74, v52 = v74, LOBYTE(v51) = 0), LOWORD(v49) = 0, LOBYTE(v48) = 0, v16 = [MADAutoAssetControlManager newAssetStatusForSelector:"newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:" withNotifications:v10 withAvailableForUseAttributes:v17 withNewerVersionAttributes:0 withNeverBeenLocked:0 withDownloadUserInitiated:1 withDownloadProgress:0 withDownloadedNetworkBytes:0 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:-1 withPatchedFromBaseSelector:v48 withPatchedFromBaseFilesystemBytes:0 withPatchingAttempted:-1 withStagedPriorToAvailable:v49 withStagedFromOSVersion:v50 withStagedFromBuildVersion:v51 extendingWithCurrentLockUsage:v52 withAvailableForUseError:v53 withPatchingAttemptError:? withNewerVersionError:?], v17, v16))
  {
    v18 = [v10 assetVersion];
    v69 = self;
    [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:@"FINAL" currentStatus:v16 forAssetSelector:v10 forActiveJobUUID:v78 matchingAssetVersion:v18 downloadingDescriptor:0 baseForPatchDescriptor:0];

    v19 = [v80 message];
    v20 = [v19 safeObjectForKey:@"instance" ofClass:objc_opt_class()];
    v21 = [v19 safeObjectForKey:@"found" ofClass:objc_opt_class()];
    v71 = [v19 safeObjectForKey:@"desire" ofClass:objc_opt_class()];
    v73 = [v19 safeObjectForKey:@"end" ofClass:objc_opt_class()];
    v70 = v19;
    v72 = [v19 safeObjectForKey:@"listen" ofClass:objc_opt_class()];
    v22 = objc_alloc_init(NSMutableDictionary);
    v23 = v16;
    if (v20)
    {
      [v22 setSafeObject:v20 forKey:@"instance"];
    }

    v75 = v20;
    v76 = v23;
    v79 = v22;
    v68 = v21;
    if (v80)
    {
      v62 = [v23 assetSelector];
      v65 = [v23 notifications];
      v64 = [v23 availableForUseAttributes];
      v63 = [v23 newerVersionAttributes];
      v77 = [v23 neverBeenLocked];
      v61 = [v23 downloadUserInitiated];
      v57 = [v23 downloadProgress];
      v60 = [v23 downloadedNetworkBytes];
      v59 = [v23 downloadedFilesystemBytes];
      v58 = [v23 downloadedAsPatch];
      v56 = [v23 patchedFromBaseSelector];
      v24 = [v23 patchedFromBaseFilesystemBytes];
      v54 = [v23 patchingAttempted];
      v25 = [v23 stagedPriorToAvailable];
      v55 = [v23 stagedFromOSVersion];
      [v23 stagedFromBuildVersion];
      v26 = v66 = v15;
      [v23 availableForUseError];
      v27 = v67 = v10;
      v28 = [v23 patchingAttemptError];
      v29 = [v23 newerVersionError];
      LOBYTE(v51) = 1;
      BYTE1(v49) = v25;
      LOBYTE(v49) = v54;
      LOBYTE(v48) = v58;
      v76 = [(MADAutoAssetControlManager *)v69 newAssetStatusForSelector:v62 withNotifications:v65 withAvailableForUseAttributes:v64 withNewerVersionAttributes:v63 withNeverBeenLocked:v77 withDownloadUserInitiated:v61 withDownloadProgress:v57 withDownloadedNetworkBytes:v60 withDownloadedFilesystemBytes:v59 withDownloadedAsPatch:v48 withPatchedFromBaseSelector:v56 withPatchedFromBaseFilesystemBytes:v24 withPatchingAttempted:v49 withStagedPriorToAvailable:v55 withStagedFromOSVersion:v26 withStagedFromBuildVersion:v51 extendingWithCurrentLockUsage:v27 withAvailableForUseError:v28 withPatchingAttemptError:v29 withNewerVersionError:?];

      v10 = v67;
      v15 = v66;

      v22 = v79;
    }

    if (!v20)
    {
      goto LABEL_18;
    }

    v30 = [MAAutoAssetInfoFound alloc];
    v31 = [v20 clientAssetSelector];
    if (v21)
    {
      v32 = [v21 localContentURL];
      v33 = [v21 assetAttributes];
    }

    else
    {
      v32 = 0;
      v33 = 0;
    }

    v34 = [v30 initForSelector:v31 withLocalContentURL:v32 withAssetAttributes:v33 reportingStatus:v76];
    if (v21)
    {
    }

    v20 = v75;
    v22 = v79;
    if (v34)
    {
      [v79 setSafeObject:v34 forKey:@"found"];
    }

    else
    {
LABEL_18:
      v34 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
      {
        v35 = [(MADAutoAssetControlManager *)v69 _updateLatestSummary];
        v36 = [v10 summary];
        if (v20)
        {
          [v20 summary];
          v38 = v37 = v20;
        }

        else
        {
          v37 = 0;
          v38 = @"N";
        }

        *buf = 138543874;
        v82 = v35;
        v83 = 2114;
        v84 = v36;
        v85 = 2114;
        v86 = v38;
        _os_log_impl(&dword_0, v34, OS_LOG_TYPE_ERROR, "[%{public}@] {updateAutoAssetStatus[%{public}@]} final status reported without found information | instance:%{public}@", buf, 0x20u);
        if (v37)
        {
        }

        v20 = v75;
        v21 = v68;
        v22 = v79;
      }
    }

    v42 = v71;
    if (v71)
    {
      [v22 setSafeObject:v71 forKey:@"desire"];
    }

    if (v73)
    {
      [v22 setSafeObject:v73 forKey:@"end"];
    }

    if (v72)
    {
      [v22 setSafeObject:v72 forKey:@"listen"];
    }

    if (v80)
    {
      v43 = [SUCoreConnectMessage alloc];
      v44 = [v80 messageName];
      v45 = [v80 clientID];
      v46 = v43;
      v42 = v71;
      v41 = [v46 initWithType:2 messageName:v44 clientID:v45 version:0 message:v79];

      v20 = v75;
      v22 = v79;
    }

    else
    {
      v41 = 0;
    }
  }

  else
  {
    v39 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v40 = [v39 diag];
    [v40 trackAnomaly:@"AUTO-CONTROL" forReason:@"{updateAutoAssetStatus} no final status" withResult:6101 withError:0];

    v41 = v80;
  }

  return v41;
}

- (id)updateAutoAssetSetStatus:(id)a3 forClientDomain:(id)a4 forAssetSetIdentifier:(id)a5 forJobResponse:(id)a6 withResponseError:(id)a7 clearingDownloadProgressReason:(id)a8 withAssetSetStatus:(id)a9
{
  v15 = a3;
  v16 = a4;
  v17 = a5;
  v18 = a6;
  v19 = a8;
  v20 = self;
  v21 = a9;
  v22 = [(MADAutoAssetControlManager *)v20 autoControlManagerFSM];
  v23 = [v22 extendedStateQueue];
  dispatch_assert_queue_V2(v23);

  v24 = v18;
  v25 = v19;
  v26 = v25;
  v106 = v21;
  if (v24)
  {
    v107 = v15;
    v27 = [v24 message];
    v28 = v16;
    v29 = [MASAutoAssetSetInfoFound newShimmedFromFrameworkMessage:v27 forKey:@"setFound"];

    v96 = v28;
    v105 = v17;
    v108 = [(MADAutoAssetControlManager *)v20 setConfigurationForClientDomain:v28 forAssetSetIdentifier:v17];
    v30 = [v29 currentSetStatus];
    v31 = v30;
    v104 = v20;
    v94 = v26;
    v95 = v24;
    if (!v21 || v30)
    {
      v32 = v26;
      if (!v30)
      {
        v36 = objc_alloc_init(MANAutoAssetSetNotifications);
        v37 = [MADAutoAssetScheduler newSetPolicyForDomainName:v96 forAssetSetIdentifier:v105];
        v38 = +[MADAutoAssetControlManager stagerSetPolicy];
        v39 = [v108 availableForUseError];
        v40 = [v108 newerVersionError];
        v41 = v40;
        if (a7)
        {
          v42 = @"set-job failed (generating current-status)";
        }

        else
        {
          v42 = @"set-job success (generating current-status)";
        }

        v43 = @"set-job failed";
        if (!a7)
        {
          v43 = @"generic final successful set-job status";
        }

        v109 = v43;
        LOBYTE(v80) = 0;
        LOBYTE(v79) = 0;
        LOBYTE(v78) = 0;
        v31 = [(MADAutoAssetControlManager *)v20 newAssetSetStatus:v15 forReason:v42 forClientDomain:v96 forAssetSetIdentifier:v105 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v78 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:v36 withCurrentNeedPolicy:0 withSchedulerPolicy:v37 withStagerPolicy:v38 withDownloadUserInitiated:v79 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v80 withSelectorsForStaging:0 withAvailableForUseError:v39 withNewerVersionError:v40];

        v26 = v94;
        if (!v31)
        {
          v73 = [(MADAutoAssetControlManager *)v20 autoControlManagerFSM];
          v74 = [v73 diag];
          [v74 trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{updateAutoAssetSetStatus} no final status" withResult:6101 withError:0];
          v33 = 0;
          v34 = 0;
          v24 = v95;
          v35 = v95;
          v17 = v105;
LABEL_35:

          v16 = v96;
          v15 = v107;
          v20 = v104;
          goto LABEL_36;
        }

        v24 = v95;
        v32 = v109;
      }
    }

    else
    {
      v31 = v21;
      v32 = v26;
    }

    v44 = [v31 atomicInstancesDownloaded];
    if (!v44)
    {
      v45 = [v31 latestDownloadedAtomicInstance];

      if (!v45)
      {
LABEL_18:
        if (v26)
        {
          v47 = [(MADAutoAssetControlManager *)v20 _currentSetStatusClearDownloadProgress:v15 clearingSetStatus:v31 forClearingReason:v26];

          v31 = v47;
        }

        v93 = v29;
        [(MADAutoAssetControlManager *)v20 _updateCurrentSetStatus:@"FINAL_SET_STATUS" forSetIdentifier:v105 withSetStatus:v31];
        v48 = [v24 message];
        v49 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:v48 forKey:@"setInstance"];
        v98 = [MASAutoAssetSetInfoFound newShimmedFromFrameworkMessage:v48 forKey:@"setFound"];
        v103 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:v48 forKey:@"setDesire"];
        v92 = v48;
        v90 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:v48 forKey:@"setEnd"];
        v50 = objc_alloc_init(NSMutableDictionary);
        v51 = v31;
        if (v49)
        {
          v52 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v49];
          [v50 setSafeObject:v52 forKey:@"setInstance"];
        }

        v89 = v50;
        v102 = [v51 clientDomainName];
        v53 = [v51 assetSetIdentifier];
        v101 = [v51 atomicInstancesDownloaded];
        v54 = [v51 newerAtomicInstanceDiscovered];
        v100 = [v51 newerDiscoveredAtomicEntries];
        v99 = [v51 latestDownloadedAtomicInstance];
        v81 = [v108 latestAtomicInstanceToVendFromPreSUStaging];
        v88 = [v51 latestDowloadedAtomicInstanceEntries];
        v87 = [v51 currentNotifications];
        v86 = [v51 currentNeedPolicy];
        v55 = [v51 clientDomainName];
        v83 = [v51 assetSetIdentifier];
        v84 = v55;
        v56 = [MADAutoAssetScheduler newSetPolicyForDomainName:v55 forAssetSetIdentifier:?];
        v57 = +[MADAutoAssetControlManager stagerSetPolicy];
        v58 = [v51 downloadUserInitiated];
        v109 = v32;
        v91 = v49;
        v85 = v54;
        if (v32)
        {
          v59 = v53;
          v97 = 0;
        }

        else
        {
          v59 = v53;
          v97 = [v51 downloadProgress];
        }

        v60 = [v51 downloadedNetworkBytes];
        v61 = [v51 downloadedFilesystemBytes];
        v62 = [v51 selectorsForStaging];
        v63 = [v108 availableForUseError];
        v64 = [v108 newerVersionError];
        LOBYTE(v80) = 1;
        LOBYTE(v79) = v58;
        LOBYTE(v78) = v81;
        v82 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:v107 forReason:@"issuing response to client" forClientDomain:v102 forAssetSetIdentifier:v59 withAtomicInstancesDownloaded:v101 withNewerAtomicInstanceDiscovered:v85 withNewerDiscoveredAtomicEntries:v100 withLatestDownloadedAtomicInstance:v99 withLatestDownloadedAtomicInstanceFromPreSUStaging:v78 withLatestDowloadedAtomicInstanceEntries:v88 withCurrentNotifications:v87 withCurrentNeedPolicy:v86 withSchedulerPolicy:v56 withStagerPolicy:v57 withDownloadUserInitiated:v79 withDownloadProgress:v97 withDownloadedNetworkBytes:v60 withDownloadedFilesystemBytes:v61 extendingWithCurrentLockUsage:v80 withSelectorsForStaging:v62 withAvailableForUseError:v63 withNewerVersionError:v64];

        if (!v109)
        {
        }

        v34 = v82;
        v17 = v105;
        v65 = [[MANAutoAssetSetInfoFound alloc] initForAssetSetIdentifier:v105 reportingStatus:v34];
        if (v65)
        {
          v66 = v65;
        }

        else
        {
          v66 = v98;
        }

        v67 = [MASAutoAssetSetInfoFound newShimmedToFramework:v66];
        v24 = v95;
        [v89 setSafeObject:v67 forKey:@"setFound"];

        if (v103)
        {
          v68 = [MASAutoAssetSetInfoDesire newShimmedToFramework:v103];
          [v89 setSafeObject:v68 forKey:@"setDesire"];
        }

        if (v90)
        {
          v69 = [MASAutoAssetSetInfoEnd newShimmedToFramework:v90];
          [v89 setSafeObject:v69 forKey:@"setEnd"];
        }

        v70 = [SUCoreConnectMessage alloc];
        v71 = [v95 messageName];
        v72 = [v95 clientID];
        v35 = [v70 initWithType:2 messageName:v71 clientID:v72 version:0 message:v89];

        v33 = 1;
        v73 = v92;
        v74 = v91;
        v29 = v93;
        v26 = v94;
        goto LABEL_35;
      }

      v44 = objc_alloc_init(NSMutableArray);
      v46 = [v31 latestDownloadedAtomicInstance];
      [v44 addObject:v46];

      [v31 setAtomicInstancesDownloaded:v44];
    }

    goto LABEL_18;
  }

  v33 = 0;
  v34 = 0;
  v35 = 0;
  v109 = v25;
LABEL_36:
  v75 = v34;
  if ((v33 & 1) == 0)
  {
    v75 = v34;
    if (v109)
    {
      v76 = v34;
      if (v17)
      {
        v76 = v34;
        if (v16)
        {
          v76 = v34;
          if (!v34)
          {
            v76 = [(MADAutoAssetControlManager *)v20 locateSetStatusForDomainName:v16 byIdentifier:v17];
          }
        }
      }

      v75 = [(MADAutoAssetControlManager *)v20 _currentSetStatusClearDownloadProgress:v15 clearingSetStatus:v76 forClearingReason:v109];

      if (v75)
      {
        [(MADAutoAssetControlManager *)v20 _updateCurrentSetStatus:v109 forSetIdentifier:v17 withSetStatus:v75];
      }
    }
  }

  return v35;
}

- (void)updateAutoAssetSetStatus:(id)a3 forSetDescriptor:(id)a4
{
  v96 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 latestDownloadedAtomicInstance];
  v10 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v9];

  v11 = [v6 clientDomainName];
  v12 = [v6 assetSetIdentifier];
  v95 = self;
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v11 forAssetSetIdentifier:v12];

  v91 = v13;
  v86 = v6;
  if (v10 || ([v6 discoveredAtomicInstance], v14 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusByInstance:](self, "locateSetStatusByInstance:", v14), v10 = objc_claimAutoreleasedReturnValue(), v14, v10))
  {
    v15 = [(MANAutoAssetSetNotifications *)v10 currentNotifications];
    v16 = [v6 discoveredAtomicInstance];
    [v15 setAtomicInstanceDiscovered:v16 != 0];

    if ([v6 isOnFilesystem])
    {
      v17 = [v6 onFilesystemIncomplete] ^ 1;
    }

    else
    {
      v17 = 0;
    }

    [v15 setAtomicInstanceAvailableForUse:v17];
    [v15 setDownloadedBecameIncomplete:{objc_msgSend(v6, "onFilesystemIncomplete")}];
    v83 = [v6 clientDomainName];
    v74 = [v6 assetSetIdentifier];
    v76 = [(MADAutoAssetControlManager *)self _newAtomicInstancesDownloadedForSetIdentifier:v6];
    v75 = [v6 discoveredAtomicInstance];
    v80 = [v6 discoveredAtomicEntries];
    v78 = [v6 latestDownloadedAtomicInstance];
    v73 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v94 = [v6 latestDowloadedAtomicInstanceEntries];
    v93 = [(MANAutoAssetSetNotifications *)v10 currentNeedPolicy];
    v18 = [v6 clientDomainName];
    v87 = [v6 assetSetIdentifier];
    v89 = v18;
    v19 = [MADAutoAssetScheduler newSetPolicyForDomainName:v18 forAssetSetIdentifier:?];
    v20 = +[MADAutoAssetControlManager stagerSetPolicy];
    v85 = v10;
    v21 = v13;
    v22 = [v6 downloadUserInitiated];
    v23 = [v6 downloadedNetworkBytes];
    v24 = [v6 downloadedFilesystemBytes];
    v25 = [v21 availableForUseError];
    v26 = [v21 newerVersionError];
    LOBYTE(v71) = 0;
    v68 = v23;
    v70 = v24;
    LOBYTE(v67) = v22;
    v27 = v20;
    v64 = v19;
    v65 = v20;
    v82 = v19;
    v92 = v15;
    LOBYTE(v62) = v73;
    v28 = v80;
    v29 = v78;
    v30 = v83;
    v31 = v74;
    v32 = v75;
    v33 = v76;
    v34 = [MADAutoAssetControlManager newAssetSetStatus:v95 forReason:"newAssetSetStatus:forReason:forClientDomain:forAssetSetIdentifier:withAtomicInstancesDownloaded:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:extendingWithCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" forClientDomain:v96 forAssetSetIdentifier:@"previous set-status found" withAtomicInstancesDownloaded:v80 withNewerAtomicInstanceDiscovered:v78 withNewerDiscoveredAtomicEntries:v62 withLatestDownloadedAtomicInstance:v94 withLatestDownloadedAtomicInstanceFromPreSUStaging:v15 withLatestDowloadedAtomicInstanceEntries:v93 withCurrentNotifications:v64 withCurrentNeedPolicy:v65 withSchedulerPolicy:v67 withStagerPolicy:0 withDownloadUserInitiated:v68 withDownloadProgress:v70 withDownloadedNetworkBytes:v71 withDownloadedFilesystemBytes:0 extendingWithCurrentLockUsage:v25 withSelectorsForStaging:v26 withAvailableForUseError:? withNewerVersionError:?];
  }

  else
  {
    v48 = objc_alloc_init(MANAutoAssetSetNotifications);
    v49 = [v6 discoveredAtomicInstance];
    [(MANAutoAssetSetNotifications *)v48 setAtomicInstanceDiscovered:v49 != 0];

    if ([v6 isOnFilesystem])
    {
      v50 = [v6 onFilesystemIncomplete] ^ 1;
    }

    else
    {
      v50 = 0;
    }

    [(MANAutoAssetSetNotifications *)v48 setAtomicInstanceAvailableForUse:v50];
    -[MANAutoAssetSetNotifications setDownloadedBecameIncomplete:](v48, "setDownloadedBecameIncomplete:", [v6 onFilesystemIncomplete]);
    v92 = [v6 clientDomainName];
    v84 = [v6 assetSetIdentifier];
    v51 = [(MADAutoAssetControlManager *)self _newAtomicInstancesDownloadedForSetIdentifier:v6];
    [v6 discoveredAtomicInstance];
    v33 = v52 = v6;
    v53 = [v52 discoveredAtomicEntries];
    v81 = [v52 latestDownloadedAtomicInstance];
    v77 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v79 = [v52 latestDowloadedAtomicInstanceEntries];
    v54 = [v52 clientDomainName];
    [v52 assetSetIdentifier];
    v93 = v55 = v51;
    v94 = v54;
    v56 = [MADAutoAssetScheduler newSetPolicyForDomainName:v54 forAssetSetIdentifier:?];
    v57 = +[MADAutoAssetControlManager stagerSetPolicy];
    v90 = [v52 downloadUserInitiated];
    v88 = [v52 downloadedNetworkBytes];
    v58 = [v52 downloadedFilesystemBytes];
    [v13 availableForUseError];
    v59 = v48;
    v60 = v85 = v48;
    v61 = v13;
    v28 = v81;
    v32 = v53;
    v27 = [v61 newerVersionError];
    v72 = v60;
    v82 = v60;
    LOBYTE(v71) = 0;
    v69 = v88;
    LOBYTE(v67) = v90;
    v87 = v57;
    v66 = v57;
    v89 = v56;
    v29 = v79;
    v63 = v59;
    LOBYTE(v62) = v77;
    v30 = v84;
    v31 = v55;
    v34 = [MADAutoAssetControlManager newAssetSetStatus:v95 forReason:"newAssetSetStatus:forReason:forClientDomain:forAssetSetIdentifier:withAtomicInstancesDownloaded:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:extendingWithCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" forClientDomain:v96 forAssetSetIdentifier:@"no previous set-status" withAtomicInstancesDownloaded:v92 withNewerAtomicInstanceDiscovered:v32 withNewerDiscoveredAtomicEntries:v81 withLatestDownloadedAtomicInstance:v62 withLatestDownloadedAtomicInstanceFromPreSUStaging:v79 withLatestDowloadedAtomicInstanceEntries:v63 withCurrentNotifications:0 withCurrentNeedPolicy:v56 withSchedulerPolicy:v66 withStagerPolicy:v67 withDownloadUserInitiated:0 withDownloadProgress:v69 withDownloadedNetworkBytes:v58 withDownloadedFilesystemBytes:v71 extendingWithCurrentLockUsage:0 withSelectorsForStaging:v72 withAvailableForUseError:v27 withNewerVersionError:?];
  }

  if (!v34)
  {
    v46 = [(MADAutoAssetControlManager *)v95 autoControlManagerFSM];
    v47 = [v46 diag];
    [v47 trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{updateAutoAssetSetStatus:forSetDescriptor:} no update status" withResult:6101 withError:0];

    v36 = v91;
    v37 = v86;
    goto LABEL_18;
  }

  v35 = [v34 atomicInstancesDownloaded];
  v36 = v91;
  v37 = v86;
  if (v35)
  {
    goto LABEL_11;
  }

  v38 = [v86 latestDownloadedAtomicInstance];

  if (v38)
  {
    v35 = objc_alloc_init(NSMutableArray);
    v39 = [v86 latestDownloadedAtomicInstance];
    [v35 addObject:v39];

    [v34 setAtomicInstancesDownloaded:v35];
LABEL_11:
  }

  v40 = [v34 newerAtomicInstanceDiscovered];

  if (!v40)
  {
    v41 = [v86 discoveredAtomicInstance];
    [v34 setNewerAtomicInstanceDiscovered:v41];

    v42 = [v86 discoveredAtomicEntries];
    [v34 setNewerDiscoveredAtomicEntries:v42];
  }

  v43 = [v34 latestDownloadedAtomicInstance];

  if (!v43)
  {
    v44 = [v86 latestDownloadedAtomicInstance];
    [v34 setLatestDownloadedAtomicInstance:v44];

    v45 = [v86 latestDowloadedAtomicInstanceEntries];
    [v34 setLatestDowloadedAtomicInstanceEntries:v45];
  }

  v46 = [v86 assetSetIdentifier];
  [(MADAutoAssetControlManager *)v95 _updateCurrentSetStatus:v96 forSetIdentifier:v46 withSetStatus:v34];
LABEL_18:
}

- (void)updateCurrentAssetStatus:(id)a3 currentStatus:(id)a4 forAssetSelector:(id)a5 forActiveJobUUID:(id)a6 matchingAssetVersion:(id)a7 downloadingDescriptor:(id)a8 baseForPatchDescriptor:(id)a9
{
  v13 = a3;
  v14 = a4;
  v15 = a5;
  v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v17 = [v16 extendedStateQueue];
  dispatch_assert_queue_V2(v17);

  v18 = [(MADAutoAssetControlManager *)self jobSelectorKey:v15];
  v19 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  [v19 setSafeObject:v14 forKey:v18];

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    v20 = _MADLog(@"Auto");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *v22 = 0;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{MADAutoAssetControlManager-updateCurrentAssetStatus} WARNING: wrong class provided as jobStatus", v22, 2u);
    }
  }

  v21 = [v15 assetVersion];

  if (!a7 && v21)
  {
    [(MADAutoAssetControlManager *)self updateAssociatedNoVersionStatus:v13 currentStatus:v14 forAssetSelector:v15];
  }
}

- (void)updateAssociatedNoVersionStatus:(id)a3 currentStatus:(id)a4 forAssetSelector:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [MAAutoAssetSelector alloc];
  v12 = [v7 assetType];
  v13 = [v7 assetSpecifier];

  v44 = [v11 initForAssetType:v12 withAssetSpecifier:v13];
  v14 = objc_alloc_init(MAAutoAssetNotifications);
  v15 = [v8 newerVersionAttributes];
  [v14 setNewerVersionDiscovered:v15 != 0];

  v16 = [v8 newerVersionError];
  [v14 setCheckForNewerFailure:v16 != 0];

  v17 = [v8 availableForUseAttributes];
  [v14 setContentAvailableForUse:v17 != 0];

  v18 = [v8 downloadProgress];
  v43 = v14;
  [v14 setDownloadPending:v18 != 0];

  v19 = [v8 downloadProgress];
  [v14 setDownloadProgress:v19 != 0];

  v41 = [v8 availableForUseAttributes];
  v40 = [v8 newerVersionAttributes];
  v39 = [v8 downloadUserInitiated];
  v38 = [v8 downloadProgress];
  v37 = [v8 downloadedNetworkBytes];
  v36 = [v8 downloadedFilesystemBytes];
  v35 = [v8 downloadedAsPatch];
  v20 = [v8 patchedFromBaseSelector];
  v21 = [v8 patchedFromBaseFilesystemBytes];
  v22 = [v8 patchingAttempted];
  v23 = [v8 stagedPriorToAvailable];
  v34 = [v8 stagedFromOSVersion];
  v24 = [v8 stagedFromBuildVersion];
  v25 = [v8 availableForUseError];
  v26 = [v8 patchingAttemptError];
  v27 = [v8 newerVersionError];

  LOBYTE(v33) = 0;
  BYTE1(v32) = v23;
  LOBYTE(v32) = v22;
  LOBYTE(v31) = v35;
  v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v44 withNotifications:v43 withAvailableForUseAttributes:v41 withNewerVersionAttributes:v40 withNeverBeenLocked:1 withDownloadUserInitiated:v39 withDownloadProgress:v38 withDownloadedNetworkBytes:v37 withDownloadedFilesystemBytes:v36 withDownloadedAsPatch:v31 withPatchedFromBaseSelector:v20 withPatchedFromBaseFilesystemBytes:v21 withPatchingAttempted:v32 withStagedPriorToAvailable:v34 withStagedFromOSVersion:v24 withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:v25 withAvailableForUseError:v26 withPatchingAttemptError:v27 withNewerVersionError:?];

  v29 = [(MADAutoAssetControlManager *)self jobSelectorKey:v44];
  v30 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  [v30 setSafeObject:v28 forKey:v29];
}

- (id)_currentSetStatusClearDownloadProgress:(id)a3 clearingSetStatus:(id)a4 forClearingReason:(id)a5
{
  v42 = a3;
  v8 = a4;
  v41 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = v8;
  v12 = v11;
  if (v11)
  {
    v13 = [v11 clientDomainName];
    v14 = [v12 assetSetIdentifier];
    v15 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v13 forAssetSetIdentifier:v14];

    v16 = [v12 downloadProgress];

    v17 = v12;
    if (v16)
    {
      v40 = [v12 clientDomainName];
      v38 = [v12 assetSetIdentifier];
      v36 = [v12 atomicInstancesDownloaded];
      v35 = [v12 newerAtomicInstanceDiscovered];
      v34 = [v12 newerDiscoveredAtomicEntries];
      v39 = [v12 latestDownloadedAtomicInstance];
      v33 = [v15 latestAtomicInstanceToVendFromPreSUStaging];
      v31 = [v12 latestDowloadedAtomicInstanceEntries];
      v32 = [v12 currentNotifications];
      v29 = [v12 currentNeedPolicy];
      v30 = [v12 schedulerPolicy];
      v28 = [v12 stagerPolicy];
      v18 = [v12 downloadUserInitiated];
      v19 = [v12 downloadedNetworkBytes];
      v20 = [v12 downloadedFilesystemBytes];
      v21 = [v12 selectorsForStaging];
      v22 = [v15 availableForUseError];
      [v15 newerVersionError];
      v23 = v37 = v15;
      LOBYTE(v27) = 1;
      LOBYTE(v26) = v18;
      LOBYTE(v25) = v33;
      v17 = [(MADAutoAssetControlManager *)self newAssetSetStatus:v42 forReason:v41 forClientDomain:v40 forAssetSetIdentifier:v38 withAtomicInstancesDownloaded:v36 withNewerAtomicInstanceDiscovered:v35 withNewerDiscoveredAtomicEntries:v34 withLatestDownloadedAtomicInstance:v39 withLatestDownloadedAtomicInstanceFromPreSUStaging:v25 withLatestDowloadedAtomicInstanceEntries:v31 withCurrentNotifications:v32 withCurrentNeedPolicy:v29 withSchedulerPolicy:v30 withStagerPolicy:v28 withDownloadUserInitiated:v26 withDownloadProgress:0 withDownloadedNetworkBytes:v19 withDownloadedFilesystemBytes:v20 extendingWithCurrentLockUsage:v27 withSelectorsForStaging:v21 withAvailableForUseError:v22 withNewerVersionError:v23];

      v15 = v37;
    }
  }

  else
  {
    v17 = 0;
  }

  return v17;
}

- (void)_updateCurrentSetStatus:(id)a3 forSetIdentifier:(id)a4 withSetStatus:(id)a5
{
  v20 = a4;
  v7 = a5;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (v20 && v7)
  {
    v10 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
    [v10 setSafeObject:v7 forKey:v20];

    v11 = [v7 newerAtomicInstanceDiscovered];

    if (v11)
    {
      v12 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      v13 = [v7 newerAtomicInstanceDiscovered];
      [v12 setSafeObject:v7 forKey:v13];
    }

    v14 = [v7 latestDownloadedAtomicInstance];

    if (v14)
    {
      v15 = [v7 latestDownloadedAtomicInstance];
      v16 = [v7 newerAtomicInstanceDiscovered];
      v17 = [SUCore stringIsEqual:v15 to:v16];

      if ((v17 & 1) == 0)
      {
        v18 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
        v19 = [v7 latestDownloadedAtomicInstance];
        [v18 setSafeObject:v7 forKey:v19];
      }
    }
  }
}

- (BOOL)statusErrorConsideredMatch:(id)a3 to:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = v6;
  if (v5 | v6)
  {
    v8 = 0;
    if (v5 && v6)
    {
      v9 = [v5 domain];
      v10 = [v7 domain];
      if ([SUCore stringIsEqual:v9 to:v10])
      {
        v11 = [v5 code];
        v12 = [v7 code];

        if (v11 != v12)
        {
          v8 = 0;
          goto LABEL_12;
        }

        v13 = [v5 userInfo];
        v9 = [v13 objectForKeyedSubscript:NSUnderlyingErrorKey];

        v14 = [v7 userInfo];
        v10 = [v14 objectForKeyedSubscript:NSUnderlyingErrorKey];

        if (v9 | v10)
        {
          v8 = 0;
          if (v9 && v10)
          {
            v16 = [v9 domain];
            v17 = [v10 domain];
            if ([SUCore stringIsEqual:v16 to:v17])
            {
              v18 = [v9 code];
              v8 = v18 == [v10 code];
            }

            else
            {
              v8 = 0;
            }
          }
        }

        else
        {
          v8 = 1;
        }
      }

      else
      {
        v8 = 0;
      }
    }
  }

  else
  {
    v8 = 1;
  }

LABEL_12:

  return v8;
}

- (id)notifyLockerJustLockedDescriptor:(id)a3 forClientInstance:(id)a4 withClientDesire:(id)a5 respondingToClientRequest:(id)a6 withClientCompletion:(id)a7
{
  v12 = a3;
  v46 = a4;
  v13 = a5;
  v14 = a6;
  v15 = [MAAutoAssetSelector alloc];
  v16 = [v12 assetType];
  v17 = [v12 assetSpecifier];
  v18 = [v12 assetVersion];
  v19 = [v15 initForAssetType:v16 withAssetSpecifier:v17 matchingAssetVersion:v18];

  v20 = [v14 clientRequestMessage];
  v21 = [MADAutoAssetControlManager replyMessageNameForRequest:v20];

  v22 = [v12 assetType];
  v23 = [v12 assetId];
  v24 = getAutoLocalUrlFromTypeAndIdWithPurpose(v22, v23, 2, @"auto");

  if (v24)
  {
    if (![SUCore stringIsEqual:v21 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
LABEL_7:
      v28 = 0;
      goto LABEL_14;
    }

    if (v13)
    {
      if (a7)
      {
        v25 = [v14 clientRequestMessage];
        v26 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v25];

        v45 = v26;
        if (v26)
        {
          v27 = v13;
          v13 = v26;
        }

        else
        {
          v27 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v33 = [v27 diag];
          v34 = [NSString alloc];
          v35 = [v14 summary];
          v36 = [v34 initWithFormat:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] client lock request without desire for clientRequest:%@", v35];
          [v33 trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6111 withError:0];
        }

        v44 = [v46 autoAssetClientName];
        v43 = [v46 clientProcessName];
        v42 = [v46 clientProcessID];
        v41 = [v13 desireReason];
        v37 = [v13 clientAssetPolicy];
        v38 = [v12 metadata];
        v47 = 0;
        v39 = v37;
        [MADAutoAssetLocker lockedByClient:v44 forClientProcessName:v43 withClientProcessID:v42 forAssetSelector:v19 forLockReason:v41 withUsagePolicy:v37 withLocalContentURL:v24 withAssetAttributes:v38 lockError:&v47];
        v28 = v47;

        goto LABEL_14;
      }

      goto LABEL_7;
    }

    v28 = [MAAutoAssetError buildError:6102 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:@"[NOTIFY-LOCKER] no auto-asset-desire provided in client request"];
  }

  else
  {
    v29 = [NSString alloc];
    v30 = [v12 summary];
    v31 = [v29 initWithFormat:@"unable to get local content URL | lockingDescriptor:%@", v30];

    v28 = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:v31];
    v32 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v49 = v31;
      _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {notifyLockerJustLockedDescriptor} %{public}@", buf, 0xCu);
    }
  }

LABEL_14:

  return v28;
}

- (id)notifyLockerAsIndicatedByJob:(id)a3
{
  v4 = a3;
  v5 = [v4 responseError];
  v6 = [v4 setJobInformation];

  if (v6)
  {
    v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v8 = [v7 diag];
    [v8 trackAnomaly:@"AUTO-CONTROL" forReason:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] should never be called for set-job" withResult:6103 withError:0];

    v9 = [MAAutoAssetError buildError:6103 fromOperation:@"IssueClientReplyJobResponse" underlyingError:0 withDescription:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] should never be called for set-job"];

    v5 = v9;
    goto LABEL_18;
  }

  v10 = [v4 jobInformation];
  v11 = [v4 clientRequest];
  v12 = [v11 clientRequestMessage];
  v13 = [MADAutoAssetControlManager replyMessageNameForRequest:v12];

  v14 = [v10 clientInstance];
  v15 = [v10 clientDesire];
  v16 = [v10 foundContent];
  v17 = [v10 fullAssetSelector];
  if (!v5)
  {
    if ([SUCore stringIsEqual:v13 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
      if (v15)
      {
        if (v16)
        {
          v18 = [v16 localContentURL];
          if (v18)
          {
            v19 = v18;
            v20 = [v16 assetAttributes];

            if (v20)
            {
              v21 = [v4 clientReplyCompletion];

              if (v21)
              {
                v22 = [v4 clientRequest];
                v23 = [v22 clientRequestMessage];
                v43 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v23];

                if (v43)
                {
                  v24 = v15;
                  v15 = v43;
                }

                else
                {
                  v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                  v27 = [v24 diag];
                  v28 = [NSString alloc];
                  v41 = [v4 summary];
                  v29 = [v28 initWithFormat:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] client lock request without desire for eventInfo:%@", v41];
                  [v27 trackAnomaly:@"AUTO-CONTROL" forReason:v29 withResult:6111 withError:0];
                }

                v30 = [v16 localContentURL];

                if (v30)
                {
                  v42 = [v14 autoAssetClientName];
                  v40 = [v14 clientProcessName];
                  v39 = [v14 clientProcessID];
                  v37 = [v15 desireReason];
                  v38 = [v15 clientAssetPolicy];
                  v36 = [v16 localContentURL];
                  v31 = [v16 assetAttributes];
                  v44 = 0;
                  [MADAutoAssetLocker lockedByClient:v42 forClientProcessName:v40 withClientProcessID:v39 forAssetSelector:v17 forLockReason:v37 withUsagePolicy:v38 withLocalContentURL:v36 withAssetAttributes:v31 lockError:&v44];
                  v5 = v44;

                  v32 = v40;
                }

                else
                {
                  v33 = [NSString alloc];
                  v34 = [v16 summary];
                  v35 = [v33 initWithFormat:@"found by job yet no local content URL | found:%@", v34];

                  v42 = v35;
                  v5 = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerAsIndicatedByJob" underlyingError:0 withDescription:v35];
                  v32 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
                  {
                    *buf = 138543362;
                    v46 = v42;
                    _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {notifyLockerAsIndicatedByJob} %{public}@", buf, 0xCu);
                  }
                }

                goto LABEL_17;
              }

              goto LABEL_12;
            }
          }

          v25 = @"[NOTIFY-LOCKER] found auto-asset without localContentURL and/or assetAttributes in response message";
        }

        else
        {
          v25 = @"[NOTIFY-LOCKER] no indication of found auto-asset in response message";
        }
      }

      else
      {
        v25 = @"[NOTIFY-LOCKER] no auto-asset-desire provided in client request";
      }

      v5 = [MAAutoAssetError buildError:6102 fromOperation:@"notifyLockerAsIndicatedByJob" underlyingError:0 withDescription:v25];
      goto LABEL_17;
    }

LABEL_12:
    v5 = 0;
  }

LABEL_17:

LABEL_18:

  return v5;
}

- (id)notifyLockerAsIndicatedBySetJob:(id)a3 withSetInstance:(id)a4 withSetDesire:(id)a5 forSetDescriptor:(id)a6 withClientReplyCompletion:(id)a7
{
  v12 = a4;
  v13 = a5;
  v14 = a6;
  v15 = a3;
  v16 = [[NSString alloc] initWithFormat:@"%@:notifyLockerAsIndicatedBySetJob", v15];

  if (!v13)
  {
    v28 = @"[SET-NOTIFY-LOCKER] no auto-asset-set-desire provided in client request";
LABEL_10:
    a7 = [MAAutoAssetError buildError:6102 fromOperation:v16 underlyingError:0 withDescription:v28];
    goto LABEL_11;
  }

  if (!v14)
  {
    v28 = @"[SET-NOTIFY-LOCKER] no indication of set-descriptor from set-job";
    goto LABEL_10;
  }

  if (!a7)
  {
    goto LABEL_15;
  }

  v38 = 0;
  v17 = [(MADAutoAssetControlManager *)self verifySetDescriptorIsLockable:v14 fromLocation:@"notifyLockerAsIndicatedBySetJob" notLocakableError:&v38 corruptedAtomicEntries:0];
  v18 = v38;
  v19 = v18;
  if (v17)
  {
    v33 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"notifyLockerAsIndicatedBySetJob" forSetDescriptor:v14];
    v36 = [v12 autoAssetSetClientName];
    v35 = [v12 clientProcessName];
    v34 = [v12 clientProcessID];
    v20 = [v13 desireReason];
    v21 = [v13 clientAssetSetPolicy];
    v37 = v19;
    v22 = [MADAutoAssetLocker lockedSetByClient:v36 forClientProcessName:v35 withClientProcessID:v34 lockingSetDescriptor:v14 forLockReason:v20 withSetUsagePolicy:v21 lockError:&v37];
    a7 = v37;

    if (v22)
    {
      v23 = [v13 desireReason];
      [(MADAutoAssetControlManager *)self setLockUsageMapLockedSetDescriptor:v14 forLockReason:v23];

      v24 = [v13 clientAssetSetPolicy];
      v25 = [v24 supportingShortTermLocks];

      if (v25)
      {
        v26 = [v12 atomicInstance];
        v27 = [(MADAutoAssetControlManager *)self shortTermLockSetDescriptor:@"notifyLockerAsIndicatedBySetJob" forSetDescriptor:v14 forSpecificAtomicInstance:v26];
      }
    }

    else if ((v33 & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraftAll:v16 forSetDescriptorNoLongerLocked:v14];
    }
  }

  else
  {
    a7 = v18;
  }

LABEL_11:
  if (a7)
  {
    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
    {
      v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v31 = [a7 checkedDescription];
      *buf = 138543618;
      v40 = v30;
      v41 = 2114;
      v42 = v31;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {notifyLockerAsIndicatedBySetJob} [SET-NOTIFY-LOCKER] final response error:%{public}@", buf, 0x16u);
    }
  }

LABEL_15:

  return a7;
}

- (void)_statsIncrement:(id)a3 forClientRequest:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 clientRequestMessage];

  v11 = [v10 messageName];

  [v7 incrementForClientRequestMessage:v11];
  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementAutoAssetJobsStarted
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalAutoAssetJobsStarted:{objc_msgSend(v5, "totalAutoAssetJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementAutoJobsFinished
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalAutoJobsFinished:{objc_msgSend(v5, "totalAutoJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDetermineJobsStarted
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalStagerDetermineJobsStarted:{objc_msgSend(v5, "totalStagerDetermineJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDetermineJobsFinished
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalStagerDetermineJobsFinished:{objc_msgSend(v5, "totalStagerDetermineJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDownloadJobsStarted
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalStagerDownloadJobsStarted:{objc_msgSend(v5, "totalStagerDownloadJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDownloadJobsFinished
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalStagerDownloadJobsFinished:{objc_msgSend(v5, "totalStagerDownloadJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementResumedInFlightJobs
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalResumedInFlightJobs:{objc_msgSend(v5, "totalResumedInFlightJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementSchedulerTriggeredJobs
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalSchedulerTriggeredJobs:{objc_msgSend(v5, "totalSchedulerTriggeredJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementFailuresToStartJobs
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self statistics];
  [v5 setTotalFailuresToStartJobs:{objc_msgSend(v5, "totalFailuresToStartJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementPreviouslyDownloadedForDescriptor:(id)a3
{
  v12 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [v12 isPatch];
  v7 = [(MADAutoAssetControlManager *)self statistics];
  v8 = [v7 previouslyDownloaded];
  v9 = v8;
  if (v6)
  {
    [v8 setPatchedAssets:{objc_msgSend(v8, "patchedAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 previouslyDownloaded];
    [v11 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "patchedBytes")}];
  }

  else
  {
    [v8 setFullAssets:{objc_msgSend(v8, "fullAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 previouslyDownloaded];
    [v11 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementDownloadedForDescriptor:(id)a3
{
  v12 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [v12 isPatch];
  v7 = [(MADAutoAssetControlManager *)self statistics];
  v8 = [v7 totalDownloaded];
  v9 = v8;
  if (v6)
  {
    [v8 setPatchedAssets:{objc_msgSend(v8, "patchedAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalDownloaded];
    [v11 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "patchedBytes")}];
  }

  else
  {
    [v8 setFullAssets:{objc_msgSend(v8, "fullAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalDownloaded];
    [v11 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementPromotedForDescriptor:(id)a3
{
  v12 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [v12 isPatch];
  v7 = [(MADAutoAssetControlManager *)self statistics];
  v8 = [v7 totalPromoted];
  v9 = v8;
  if (v6)
  {
    [v8 setPatchedAssets:{objc_msgSend(v8, "patchedAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalPromoted];
    [v11 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "patchedBytes")}];
  }

  else
  {
    [v8 setFullAssets:{objc_msgSend(v8, "fullAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalPromoted];
    [v11 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementRemovedForDescriptor:(id)a3
{
  v12 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [v12 isPatch];
  v7 = [(MADAutoAssetControlManager *)self statistics];
  v8 = [v7 totalRemoved];
  v9 = v8;
  if (v6)
  {
    [v8 setPatchedAssets:{objc_msgSend(v8, "patchedAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalRemoved];
    [v11 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "patchedBytes")}];
  }

  else
  {
    [v8 setFullAssets:{objc_msgSend(v8, "fullAssets") + 1}];

    v10 = [(MADAutoAssetControlManager *)self statistics];
    v11 = [v10 totalRemoved];
    [v11 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", v12) + objc_msgSend(v11, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (id)_statsCombinedCopy:(BOOL)a3
{
  v3 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if ([(MADAutoAssetControlManager *)self stagerResumed]&& ![(MADAutoAssetControlManager *)self stagerResumePostponed])
  {
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    v16 = 0;
    v17 = 0;
    v14 = 0;
    v15 = 0;
    [MADAutoAssetStager controlStatisticsClientRepliesSuccess:&v17 clientRepliesFailure:&v16 totalStaged:&v15 totalUnstaged:&v14 clearingAfter:v3];
    v7 = v17;
    v9 = v16;
    v10 = v15;
    v11 = v14;
    v8 = [(MADAutoAssetControlManager *)self _combinedStatisticsWithStagerClientRepliesSuccess:v7 withStagerClientRepliesFailure:v9 withStagerTotalStaged:v10 withStagerTotalUnstaged:v11];
  }

  else
  {
    v7 = [(MADAutoAssetControlManager *)self statistics];
    v8 = [v7 copy];
  }

  if (v3)
  {
    [(MADAutoAssetControlManager *)self _statsClearingAfterReporting];
    v12 = objc_alloc_init(MANAutoAssetControlStatistics);
    [(MADAutoAssetControlManager *)self setStatistics:v12];
  }

  return v8;
}

- (void)_statsMaintainReporting
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  [(MADAutoAssetControlManager *)self statisticsNextMaintenanceReport];
  if (v5 == 0.0)
  {

    [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
  }

  else
  {
    v6 = +[NSDate date];
    [v6 timeIntervalSince1970];
    v8 = v7;

    [(MADAutoAssetControlManager *)self statisticsNextMaintenanceReport];
    if (v8 >= v9)
    {
      v10 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v12 = [(MADAutoAssetControlManager *)self statistics];
        v13 = [v12 summary];
        v14 = 138543618;
        v15 = v11;
        v16 = 2114;
        v17 = v13;
        _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | maintenance report | statistics:%{public}@", &v14, 0x16u);
      }

      [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
    }
  }
}

- (void)_statsClearingAfterReporting
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    v6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v7 = [(MADAutoAssetControlManager *)self statistics];
    v8 = [v7 summary];
    v9 = 138543618;
    v10 = v6;
    v11 = 2114;
    v12 = v8;
    _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | clearing after | statistics:%{public}@", &v9, 0x16u);
  }

  [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
}

- (void)_statsRestartNextMaintentanceReport
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = +[NSDate date];
  [v5 timeIntervalSince1970];
  v7 = v6;

  [(MADAutoAssetControlManager *)self setStatisticsNextMaintenanceReport:v7 + 900.0];
}

- (void)_scheduledAndRouteClientRequest:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:_scheduledAndRouteClientRequest", v7];
  v11 = [v6 clientRequestMessage];
  v12 = [v11 messageName];

  v13 = [v6 clientRequestMessage];
  v14 = [v13 message];

  v15 = [v6 clientRequest];
  v16 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v15];

  if (!v16)
  {
    v24 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v6];
    v17 = v24;
    if (v12 && v14 && v24)
    {
      v37 = v14;
      v25 = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
      v26 = [v17 clientAssetSelector];
      v27 = [v26 persistedEntryID];
      v20 = [v25 safeObjectForKey:v27 ofClass:objc_opt_class()];

      v28 = [v17 clientAssetSelector];
      LODWORD(v25) = [(MADAutoAssetControlManager *)self _messageShouldBeScheduled:v12 forAssetSelector:v28];

      if (v25)
      {
        v29 = [v17 clientAssetSelector];
        [(MADAutoAssetControlManager *)self _scheduleSelector:v29];
      }

      [(MADAutoAssetControlManager *)self _routeClientRequest:v6 alreadyScheduledSelector:v20 != 0 fromLocation:v7];
      v14 = v37;
      goto LABEL_31;
    }

    v30 = [NSString alloc];
    v31 = @"MISSING";
    if (v12)
    {
      v32 = v12;
    }

    else
    {
      v32 = @"MISSING";
    }

    if (v14)
    {
      v33 = @"provided";
    }

    else
    {
      v33 = @"MISSING";
    }

    if (v17)
    {
      v31 = @"provided";
    }

    v20 = [v30 initWithFormat:@"{%@} | invalid eventInfo |messageName:%@|message:%@|instance:%@", v10, v32, v33, v31];
    v21 = self;
    v22 = v6;
    v23 = 6102;
LABEL_30:
    [(MADAutoAssetControlManager *)v21 issueResponseForEventInfo:v22 withErrorCode:v23 fromAction:v10 withDescription:v20];
LABEL_31:

    goto LABEL_33;
  }

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v10 withEventInfo:v6];
  if (!v17)
  {
    v34 = [NSString alloc];
    v35 = [v6 summary];
    v36 = [v34 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v10, v35];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:v10 withDescription:v36];

    goto LABEL_33;
  }

  if (([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v12 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) == 0)
  {
    v38 = 0;
    v18 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:v6 fromLocation:v10 errorString:&v38];
    v19 = v38;
    if (v19)
    {
      v20 = v19;
      v21 = self;
      v22 = v6;
      v23 = v18;
      goto LABEL_30;
    }
  }

  [(MADAutoAssetControlManager *)self _routeClientRequest:v6 alreadyScheduledSelector:0 fromLocation:v7];
LABEL_33:
}

- (int64_t)_scheduleAndCreateSetConfiguration:(id)a3 fromLocation:(id)a4 errorString:(id *)a5
{
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:_scheduleAndCreateSetConfiguration", v9];
  v13 = [v8 clientRequestMessage];
  v14 = [v13 messageName];

  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v12 withEventInfo:v8];
  v39 = 0;
  v16 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:v15 dueToMessageName:v14 selectedConfig:&v39];
  v17 = v39;
  v18 = v17;
  v19 = 6555;
  if (v16 == 6555)
  {
    v20 = @"An empty configuration for a set is not allowed";
    goto LABEL_13;
  }

  if (v17)
  {
    v20 = 0;
LABEL_12:
    v19 = v16;
    goto LABEL_13;
  }

  v21 = [v15 autoAssetEntries];

  if (!v21)
  {
    goto LABEL_11;
  }

  if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
  {
    v38 = 0;
    v19 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:v12 forSetInfoInstance:v15 dueToMessageName:v14 selectedConfig:&v38];
    v18 = v38;
    if (v19)
    {
      v20 = @"Failed to modify asset configuration with the provided asset configuration";
    }

    else
    {
      v20 = 0;
    }

    goto LABEL_13;
  }

  if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0)
  {
LABEL_11:
    v20 = 0;
    v18 = 0;
    goto LABEL_12;
  }

  v33 = [v15 autoAssetEntries];
  v34 = a5;
  v35 = [v33 count];

  v18 = 0;
  v36 = v35 == 0;
  a5 = v34;
  if (v36)
  {
    v20 = 0;
  }

  else
  {
    v20 = @"A set configuration different than the currently defined set configuration is provided";
  }

  if (v36)
  {
    v19 = v16;
  }

  else
  {
    v19 = 6554;
  }

LABEL_13:
  if ([(MADAutoAssetControlManager *)self _setMessageInvolvesSchedulerPolicy:v14])
  {
    v22 = [v8 clientRequest];
    [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v22];
    v37 = v19;
    v23 = self;
    v24 = v14;
    v25 = v8;
    v26 = v20;
    v27 = v15;
    v28 = v12;
    v30 = v29 = a5;

    v31 = [v30 clientAssetSetPolicy];

    a5 = v29;
    v12 = v28;
    v15 = v27;
    v20 = v26;
    v8 = v25;
    v14 = v24;
    self = v23;
    v19 = v37;
    if (!v18)
    {
      goto LABEL_19;
    }
  }

  else
  {
    v31 = 0;
    if (!v18)
    {
      goto LABEL_19;
    }
  }

  if ([(MADAutoAssetControlManager *)self _setMessageShouldBeScheduled:v14 forSetConfiguration:v18 forLatestEventInfo:v8])
  {
    [(MADAutoAssetControlManager *)self _scheduleSetConfiguration:v18 withClientSetPolicy:v31];
  }

LABEL_19:
  if (a5)
  {
    *a5 = v20;
  }

  return v19;
}

- (BOOL)_messageShouldBeScheduled:(id)a3 forAssetSelector:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = v6;
  if (!v6)
  {
    goto LABEL_58;
  }

  v8 = [v6 assetType];
  if (v8)
  {
    v9 = [v7 assetSpecifier];
    if (v9)
    {
      v10 = v9;
      v11 = [v7 assetVersion];

      if (!v11
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:CURRENT_STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:END_LOCK_USAGE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:CANCEL_OPERATION"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:PURGE_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-STAGE:ERASE_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& 1) == 0
        && ([SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& 1) == 0
        && ![SUCore stringIsEqual:v5 to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"])
      {
        LOBYTE(v8) = 1;
        goto LABEL_59;
      }
    }

    else
    {
    }

LABEL_58:
    LOBYTE(v8) = 0;
  }

LABEL_59:

  return v8;
}

- (BOOL)_setMessageShouldBeScheduled:(id)a3 forSetConfiguration:(id)a4 forLatestEventInfo:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  if (([SUCore stringIsEqual:v8 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v8 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v8 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0 && ![SUCore stringIsEqual:v8 to:@"MA-AUTO-SET:LOCK_ATOMIC"])
  {
    goto LABEL_12;
  }

  if (![(MADAutoAssetControlManager *)self _setMessageInvolvesSchedulerPolicy:v8])
  {
    goto LABEL_14;
  }

  v13 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"_setMessageShouldBeScheduled" withEventInfo:v10];
  v14 = [v10 clientRequest];
  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v14];

  if (![v9 inhibitImpliedScheduling] || (objc_msgSend(v15, "clientAssetSetPolicy"), v16 = objc_claimAutoreleasedReturnValue(), v17 = objc_msgSend(v16, "blockCheckDownload"), v16, !v17))
  {
    if (([v9 inhibitImpliedScheduling] & 1) != 0 && (objc_msgSend(v13, "autoAssetEntries"), (v18 = objc_claimAutoreleasedReturnValue()) != 0))
    {
      v19 = v18;
      v20 = [v13 autoAssetEntries];
      v21 = [v20 count];

      if (!v21)
      {
        goto LABEL_12;
      }
    }

    else
    {
    }

LABEL_14:
    v22 = 1;
    goto LABEL_15;
  }

LABEL_12:
  v22 = 0;
LABEL_15:

  return v22;
}

- (BOOL)_setMessageInvolvesSchedulerPolicy:(id)a3
{
  v3 = a3;
  v4 = ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];

  return v4;
}

- (BOOL)_setMessageCanCreateSetConfiguration:(id)a3
{
  v3 = a3;
  v4 = ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];

  return v4;
}

- (BOOL)_messageBlockedUntilDownloadManagerSync:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (([SUCore stringIsEqual:v4 to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:LOCK_CONTENT"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:END_LOCK_USAGE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:CANCEL_OPERATION"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:PURGE_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-STAGE:ERASE_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& 1) != 0
    || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& 1) != 0)
  {
    v7 = 1;
  }

  else
  {
    if (([SUCore stringIsEqual:v4 to:@"MA-AUTO:CURRENT_STATUS"]& 1) == 0 && ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"]& 1) == 0 && ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& 1) == 0 && ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& 1) == 0 && ([SUCore stringIsEqual:v4 to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"]& 1) == 0)
    {
      v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v10 = [v9 diag];
      v11 = [[NSString alloc] initWithFormat:@"{_messageBlockedUntilDownloadManagerSync} unknown messageName:%@", v4];
      [v10 trackAnomaly:@"AUTO-CONTROL" forReason:v11 withResult:6106 withError:0];
    }

    v7 = 0;
  }

  return v7;
}

- (BOOL)_messageBlockedUntilFirstUnlock:(id)a3 forAssetSelector:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (v7)
  {
    if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
    {
      v10 = 1;
    }

    else
    {
      v11 = [(MADAutoAssetControlManager *)self _updatePolicyForSelector:v7];
      v10 = [v11 blockIfBeforeFirstUnlock] && ((+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v6, @"MA-AUTO:INTEREST_IN_CONTENT") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v6, @"MA-AUTO:CHECK_FOR_NEWER") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v6, @"MA-AUTO:DETERMINE_IF_AVAILABLE") & 1) != 0 || +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v6, @"MA-AUTO:LOCK_CONTENT"));
    }
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_messageBlockedUntilFirstUnlock:(id)a3 forSetInstance:(id)a4
{
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (!a4)
  {
    return 0;
  }

  return +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
}

- (BOOL)_messageAssetPolicyDownloadUserInitiated:(id)a3 forClientRequest:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (([SUCore stringIsEqual:v6 to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:v6 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || [SUCore stringIsEqual:v6 to:@"MA-AUTO:LOCK_CONTENT"])
  {
    v10 = [v7 clientRequestMessage];
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v10];

    v12 = [v11 clientAssetPolicy];
  }

  else
  {
    if (([SUCore stringIsEqual:v6 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:v6 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0 && ![SUCore stringIsEqual:v6 to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      v14 = 0;
      goto LABEL_6;
    }

    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v7];
    v12 = [v11 clientAssetSetPolicy];
  }

  v13 = v12;
  v14 = [v12 userInitiated];

LABEL_6:
  return v14;
}

- (void)_routeClientRequest:(id)a3 alreadyScheduledSelector:(BOOL)a4 fromLocation:(id)a5
{
  v6 = a4;
  v8 = a3;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:_routeClientReuest", v9];
  v13 = [v8 clientRequestMessage];
  v14 = [v13 messageName];

  IsInternalAllowed = _MAPreferencesIsInternalAllowed();
  v16 = [v8 clientRequest];
  v17 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v16];

  v119 = v14;
  v120 = v9;
  if (!v17)
  {
    v28 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v8];
    v27 = v28;
    if (!v28)
    {
      v33 = [NSString alloc];
      v34 = [v8 summary];
      v35 = [v33 initWithFormat:@"{%@} | invalid eventInfo (instance:MISSING) | eventInfo:%@", v12, v34];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6102 fromAction:v12 withDescription:v35];

      v18 = 0;
      goto LABEL_15;
    }

    v115 = IsInternalAllowed;
    v117 = v8;
    v29 = [v28 clientAssetSelector];
    v26 = [(MADAutoAssetControlManager *)self currentJobBySelector:v29];

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:CURRENT_STATUS"])
    {
      v8 = v117;
      [(MADAutoAssetControlManager *)self handleClientCurrentStatusRequest:v117 forAutoJob:v26];
LABEL_76:
      v18 = 0;
      v23 = 0;
      v20 = 0;
      goto LABEL_77;
    }

    v113 = v26;
    v8 = v117;
    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientControlStatisticsRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientKnownAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientAvailableForStagingSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientActiveJobSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientScheduledJobSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientLockedAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientStagedAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientStagerOverviewRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalUnlockRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalForgetRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalPurgeRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    v112 = v12;
    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& IsInternalAllowed) == 1)
    {
      v8 = v117;
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalAbandonRequest:v117 forAutoJob:v26];
LABEL_90:
      v18 = 0;
      v23 = 0;
      v20 = 0;
      goto LABEL_77;
    }

    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:v14 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || ([SUCore stringIsEqual:v14 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0 || [SUCore stringIsEqual:v14 to:@"MA-AUTO:LOCK_CONTENT"])
    {
      if (![(MADAutoAssetControlManager *)self handleClientPotentialJob:v117 alreadyScheduledSelector:v6 forAutoJob:v26 fromLocation:v9])
      {
        v18 = 0;
        v23 = 0;
        v20 = 0;
        v8 = v117;
        goto LABEL_77;
      }

      if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
      {
        v18 = 0;
        v111 = 0;
        v8 = v117;
        if (!v26)
        {
          goto LABEL_84;
        }

        goto LABEL_81;
      }

      v73 = [v117 clientRequest];
      [(MADAutoAssetControlManager *)self timerStartForRequest:v73 fromLocation:v9];

      v74 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
      [v74 addObject:v117];

      v75 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v75, OS_LOG_TYPE_DEFAULT))
      {
        v76 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v77 = [v117 summary];
        *buf = 138543874;
        *&buf[4] = v76;
        v124 = 2114;
        v125 = v112;
        v126 = 2114;
        v127 = v77;
        _os_log_impl(&dword_0, v75, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | job queued since device before first-unlock | eventInfo:%{public}@", buf, 0x20u);
      }

      v78 = [(MADAutoAssetControlManager *)self statistics];
      v79 = [v78 totalQueuedClientRequests];
      v8 = v117;
      v80 = [v117 clientRequest];
      [(MADAutoAssetControlManager *)self _statsIncrement:v79 forClientRequest:v80];
    }

    else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"])
    {
      v8 = v117;
      [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:v117 fromLocation:v9];
    }

    else
    {
      if (([SUCore stringIsEqual:v14 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) != 0 || ([SUCore stringIsEqual:v14 to:@"MA-AUTO:END_LOCK_USAGE"]& 1) != 0 || ([SUCore stringIsEqual:v14 to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) != 0 || [SUCore stringIsEqual:v14 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleClientAlterLockOperation:v117 forAutoJob:v26];
        goto LABEL_90;
      }

      if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleClientCancelActivityForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminateAllForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminateAllForAssetTypeRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminatePromotedNeverLockedForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineGroupsAvailableForUpdateRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineAllAvailableForUpdateRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineAllAvailableRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDownloadGroupsRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDownloadAllRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:CANCEL_OPERATION"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientCancelOperation:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:PURGE_ALL"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientPurgeAllRequest:v117];
      }

      else if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-STAGE:ERASE_ALL"])
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientEraseAllRequest:v117];
      }

      else if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& IsInternalAllowed) == 1)
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:v117];
      }

      else if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& IsInternalAllowed) == 1)
      {
        v8 = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:v117];
      }

      else
      {
        if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"]& IsInternalAllowed) != 1)
        {
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"])
            {
              v8 = v117;
              [(MADAutoAssetControlManager *)self handleEstimateEvictableBytesForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"])
            {
              v8 = v117;
              [(MADAutoAssetControlManager *)self handleSuspendForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"])
            {
              v8 = v117;
              [(MADAutoAssetControlManager *)self handleResumeFromSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"])
            {
              v8 = v117;
              [(MADAutoAssetControlManager *)self handleStatusForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }
          }

          v18 = 0;
          v23 = 0;
          v111 = 0;
          goto LABEL_133;
        }

        v8 = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulateSetJobOperation:v117];
      }
    }

LABEL_105:
    v18 = 0;
    v23 = 0;
    v20 = 0;
    v12 = v112;
    goto LABEL_77;
  }

  v18 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v9 withEventInfo:v8];
  if (!v18)
  {
    v30 = [NSString alloc];
    v31 = [v8 summary];
    v32 = [v30 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v12, v31];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6102 fromAction:v9 withDescription:v32];

    v27 = 0;
LABEL_15:
    v23 = 0;
    v20 = 0;
    goto LABEL_24;
  }

  v115 = IsInternalAllowed;
  *buf = 0;
  v19 = 0;
  v20 = 0;
  if ([(MADAutoAssetControlManager *)self _doesClientRequestInvolveSetConfiguration:v8]&& (v122 = 0, [(MADAutoAssetControlManager *)self setConfigurationFromMessageName:v14 withInfoInstance:v18 errorCode:buf errorDescription:&v122], v20 = objc_claimAutoreleasedReturnValue(), v19 = v122, !v20))
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:*buf fromAction:v9 withDescription:v19];
  }

  else if (![(MADAutoAssetControlManager *)self setPolicyValidate:v8 fromLocation:v12])
  {
    v111 = v20;
    v112 = v12;
    v117 = v8;
    v21 = [v18 clientDomainName];
    v22 = [v18 assetSetIdentifier];
    v23 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v21 byIdentifier:v22];

    v24 = [v18 clientDomainName];
    v25 = [v18 assetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v24 byIdentifier:v25];

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientCurrentStatusRequest:v8 forAutoJob:v26];
LABEL_8:
      v27 = 0;
LABEL_9:
      v12 = v112;
LABEL_30:
      v20 = v111;
      goto LABEL_77;
    }

    v113 = v26;
    v12 = v112;
    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"])
    {
      [(MADAutoAssetControlManager *)self handleSetControlClientAssetSetsOverviewRequest:v8 forAutoJob:v26];
LABEL_29:
      v27 = 0;
      goto LABEL_30;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"])
    {
      [(MADAutoAssetControlManager *)self handleSetControlClientInstanceInfoRequest:v8 forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientNeedForAtomicRequest:v8 fromLocation:v120];
      v27 = 0;
LABEL_35:
      v26 = v113;
      goto LABEL_30;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
    {
      v20 = v111;
      [(MADAutoAssetControlManager *)self handleSetClientAlterEntriesRepresentingAtomicRequest:v8 forAutoJob:v26 whenCancelingSetJob:v23 alteringFromSetConfiguration:v111];
      v27 = 0;
      goto LABEL_77;
    }

    if (([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      if (![(MADAutoAssetControlManager *)self handleClientPotentialSetJob:v8 forAutoJob:v26 fromLocation:v120])
      {
        goto LABEL_29;
      }

      if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
      {
        v36 = [v8 clientRequest];
        [(MADAutoAssetControlManager *)self timerStartForRequest:v36 fromLocation:v112];

        v37 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
        [v37 addObject:v8];

        v38 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          v39 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v40 = [v8 summary];
          *buf = 138543874;
          *&buf[4] = v39;
          v124 = 2114;
          v125 = v112;
          v126 = 2114;
          v127 = v40;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_SYNC] | job queued since device before first-unlock | eventInfo:%{public}@", buf, 0x20u);
        }

        v41 = [(MADAutoAssetControlManager *)self statistics];
        v42 = [v41 totalQueuedClientRequests];
        v43 = [v8 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:v42 forClientRequest:v43];

        goto LABEL_8;
      }

      if (v23)
      {
        v44 = [v23 queuedRequestsForNewJobOnceCanceled];

        if (!v44)
        {
          v45 = objc_alloc_init(NSMutableArray);
          [v23 setQueuedRequestsForNewJobOnceCanceled:v45];
        }

        v46 = [v23 queuedRequestsForNewJobOnceCanceled];

        if (v46)
        {
          v47 = [v23 queuedRequestsForNewJobOnceCanceled];
          [v47 addObject:v8];

          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
          {
            v49 = [v23 queuedRequestsForNewJobOnceCanceled];
            v50 = [v49 count];
            v51 = [v8 summary];
            *buf = 138543874;
            *&buf[4] = v112;
            v124 = 2048;
            v125 = v50;
            v126 = 2114;
            v127 = v51;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | job queued since set-job is being canceled | queued-count:%ld | eventInfo:%{public}@", buf, 0x20u);

            v12 = v112;
          }
        }

        else
        {
          v55 = [NSString alloc];
          v56 = [v8 summary];
          v57 = [v55 initWithFormat:@"{%@} | unable to create canceling-set-job queue | eventInfo:%@", v112, v56];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6101 fromAction:v112 withDescription:v57];

          v12 = v112;
        }

        goto LABEL_29;
      }

      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        v52 = [v18 clientDomainName];
        v53 = [v18 assetSetIdentifier];
        v54 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:v52 forAssetSetIdentifier:v53];

        if (v54)
        {
          v12 = v112;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6703 fromAction:v112 withDescription:@"suspended for software update"];
          v27 = 0;
LABEL_93:
          v23 = 0;
          goto LABEL_30;
        }

        v27 = 0;
        v12 = v112;
        if (!v26)
        {
LABEL_84:
          v112 = v12;
          v60 = +[NSUUID UUID];
          v116 = [v60 UUIDString];

          v118 = v8;
          if (v17)
          {
            v61 = [v8 clientRequest];
            v62 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v61];

            v121 = 0;
            v110 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:v18 dueToMessageName:v14 selectedConfig:&v121];
            v111 = v121;
            if (v111)
            {
              v63 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDForNewSetJob:v18 forReason:v14];

              v64 = [MADAutoSetDescriptor alloc];
              v65 = [v18 clientDomainName];
              v66 = [v18 assetSetIdentifier];
              v116 = v63;
              v114 = [(MADAutoSetDescriptor *)v64 initForClientDomainName:v65 forAssetSetIdentifier:v66 withDiscoveredAtomicInstance:v63 withDiscoveredAtomicEntries:0];

              v67 = [v18 autoAssetEntries];

              if (v67)
              {
                v68 = v18;
              }

              else
              {
                v68 = v111;
              }

              v87 = [v68 autoAssetEntries];
              [v114 setRequestedAutoAssetEntries:v87];

              [(MADAutoAssetControlManager *)self osTransactionNameClientRequestedSetJob:v63];
              v88 = os_transaction_create();
              v89 = [MADAutoAssetJob alloc];
              v90 = [v111 copy];
              v84 = [(MADAutoAssetJob *)v89 initForSetInstance:v18 withLifetimeOSTransaction:v88 withSetDesire:v62 usingSetConfiguration:v90 usingSetDescriptor:v114 withAutoAssetUUID:v63];

              if (v84)
              {
                goto LABEL_122;
              }

              if (v110)
              {
                v85 = v110;
              }

              else
              {
                v85 = 6101;
              }
            }

            else
            {
              v86 = [[NSString alloc] initWithFormat:@"unable to determine valid set-configuration when REQUIRED for operation [%@]", v14];

              v111 = 0;
              v114 = 0;
              if (v110)
              {
                v85 = v110;
              }

              else
              {
                v85 = 6101;
              }

              if (v86)
              {
                goto LABEL_130;
              }
            }
          }

          else
          {
            [(MADAutoAssetControlManager *)self osTransactionNameClientRequestedSingletonJob:v116];
            v81 = os_transaction_create();
            v82 = [MADAutoAssetJob alloc];
            v83 = [v8 clientRequest];
            v84 = [(MADAutoAssetJob *)v82 initForInstance:v27 withLifetimeOSTransaction:v81 withAutoAssetUUID:v116 downloadingUserInitiated:[(MADAutoAssetControlManager *)self _messageAssetPolicyDownloadUserInitiated:v14 forClientRequest:v83]];

            v114 = 0;
            if (v84)
            {
LABEL_122:
              v26 = v84;
              [v84 setClientRequestCount:{objc_msgSend(v84, "clientRequestCount") + 1}];
              if (v17)
              {
                v8 = v118;
                v91 = [v118 clientRequestMessage];
                v92 = v116;
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v84 usingSelector:0 withJobUUID:v116 triggeredByClientMessage:v91 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:v114 fromLocation:v112];

                v93 = [v114 clientDomainName];
                v94 = [v114 assetSetIdentifier];
                v86 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v93 forAssetSetIdentifier:v94];

                v95 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
                [v95 setSafeObject:v114 forKey:v86];

                v96 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
                v97 = [v114 discoveredAtomicInstance];
                [v96 setSafeObject:v114 forKey:v97];

                v98 = [v118 clientRequest];
                [(MADAutoAssetControlManager *)self timerStartForRequest:v98 fromLocation:v112];

                [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                v99 = [v118 clientRequest];
                v100 = [(MADAutoAssetControlManager *)self jobControlInformationForSetJobKey:v86];
                v101 = v84;
                v102 = v99;
              }

              else
              {
                v103 = [v27 clientAssetSelector];
                v8 = v118;
                v104 = [v118 clientRequestMessage];
                v92 = v116;
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v84 usingSelector:v103 withJobUUID:v116 triggeredByClientMessage:v104 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:0 fromLocation:v112];

                v105 = [v27 clientAssetSelector];
                v106 = [v118 clientRequestMessage];
                [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v120 operation:@"ENTRY_ADD" usingSelector:v105 withJobUUID:v116 triggeredByClientMessage:v106 downloadingDescriptor:0 baseForPatchDescriptor:0 message:@"auto-asset-job started"];

                v107 = [v118 clientRequest];
                [(MADAutoAssetControlManager *)self timerStartForRequest:v107 fromLocation:v112];

                [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                v86 = [v118 clientRequest];
                v99 = [v27 clientAssetSelector];
                v100 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v99];
                v101 = v84;
                v102 = v86;
              }

              [v101 startHandlingClientRequest:v102 withControlInformation:v100];

              goto LABEL_131;
            }

            v85 = 6101;
          }

          v86 = @"unable to allocate auto-asset-job";
LABEL_130:
          v8 = v118;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v118 withErrorCode:v85 fromAction:v112 withDescription:v86];
          [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
          v26 = 0;
          v92 = v116;
LABEL_131:

          v23 = 0;
          goto LABEL_9;
        }
      }

      else
      {
        v27 = 0;
        if (!v26)
        {
          goto LABEL_84;
        }
      }

LABEL_81:
      [v26 setClientRequestCount:{objc_msgSend(v26, "clientRequestCount") + 1}];
      v58 = [v8 clientRequest];
      [(MADAutoAssetControlManager *)self timerStartForRequest:v58 fromLocation:v12];

      v59 = [v8 clientRequest];
      if (v17)
      {
        [v26 startHandlingClientRequest:v59 withControlInformation:0];
      }

      else
      {
        [v27 clientAssetSelector];
        v69 = v26;
        v71 = v70 = v12;
        v72 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v71];
        [v69 startHandlingClientRequest:v59 withControlInformation:v72];

        v12 = v70;
        v26 = v69;
      }

      goto LABEL_93;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientMapLockedAtomicEntryRequest:v8 forAutoJob:v26 fromLocation:v120];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientFormSubAtomicRequest:v8 forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientContinueAtomicLockRequest:v8 forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEndAtomicLockRequest:v8 forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEndAtomicLocksForClientRequest:v8 forAutoJob:v26];
      goto LABEL_8;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEliminateAtomicRequest:v8 whenCancelingSetJob:v23 forAutoJob:v26];
      goto LABEL_8;
    }

    if ([SUCore stringIsEqual:v14 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientAssetSetForStagingRequest:v8 forAutoJob:v26];
      goto LABEL_8;
    }

    __isPlatformVersionAtLeast(2, 18, 4, 0);
    v27 = 0;
LABEL_133:
    v108 = @"customer";
    if (v115)
    {
      v108 = @"internal";
    }

    v109 = [NSString stringWithFormat:@"unknown auto-asset command request received (%@)", v108];
    v8 = v117;
    v12 = v112;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v117 withErrorCode:6106 fromAction:v112 withDescription:v109];

    goto LABEL_35;
  }

  v27 = 0;
  v23 = 0;
LABEL_24:
  v26 = 0;
LABEL_77:
}

- (BOOL)handleClientPotentialJob:(id)a3 alreadyScheduledSelector:(BOOL)a4 forAutoJob:(id)a5 fromLocation:(id)a6
{
  v8 = a4;
  v10 = a3;
  v30 = a5;
  v31 = a6;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleClientPotentialJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  v14 = [v10 clientRequest];
  v15 = [v14 clientRequestMessage];
  v16 = [v15 messageName];

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v10];
  if (v17)
  {
    if ([SUCore stringIsEqual:v16 to:@"MA-AUTO:INTEREST_IN_CONTENT"])
    {
      if (v8)
      {
        v29 = [v10 clientRequest];
        v28 = [v29 clientRequestMessage];
        v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v28];
        v19 = [v10 clientRequest];
        v20 = [v19 clientRequestMessage];
        v21 = [v20 clientID];
        v22 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:v21 response:0 error:0];

        v23 = [v10 clientRequest];
        [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v23 issuingResponseMessage:v22 withResponseError:0];
LABEL_5:

LABEL_14:
        v24 = 0;
LABEL_18:

        goto LABEL_19;
      }
    }

    else if (([SUCore stringIsEqual:v16 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || [SUCore stringIsEqual:v16 to:@"MA-AUTO:LOCK_CONTENT"])
    {
      v25 = [v14 clientRequestMessage];
      v22 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v25];

      if (!v22)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:@"handleClientPotentialJob" withDescription:@"no auto-asset-desire provided in client request"];
        goto LABEL_14;
      }

      if ([SUCore stringIsEqual:v16 to:@"MA-AUTO:CHECK_FOR_NEWER"])
      {
        v26 = [(MADAutoAssetControlManager *)self handleClientCheckForNewer:v10 forAutoJob:v30 instance:v17 desire:v22 fromLocation:v31];
      }

      else
      {
        if (![SUCore stringIsEqual:v16 to:@"MA-AUTO:LOCK_CONTENT"])
        {
          v23 = [[NSString alloc] initWithFormat:@"unexpected messageName:%@", v16];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6108 fromAction:@"handleClientPotentialJob" withDescription:v23];
          goto LABEL_5;
        }

        v26 = [(MADAutoAssetControlManager *)self handleClientLockContent:v10 forAutoJob:v30 instance:v17 desire:v22 fromLocation:v31];
      }

      v24 = v26;
      goto LABEL_18;
    }

    v24 = 1;
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:v31 withDescription:@"no auto-asset-instance provided in client request"];
    v24 = 0;
  }

LABEL_19:

  os_activity_scope_leave(&state);
  return v24;
}

- (BOOL)handleClientCheckForNewer:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7
{
  v11 = a3;
  v12 = a5;
  v13 = a6;
  v14 = a7;
  v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v16 = [v15 extendedStateQueue];
  dispatch_assert_queue_V2(v16);

  v17 = [v11 clientRequest];
  v18 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  v19 = [v13 checkWaitTimeoutSecs];
  if (!v19)
  {
    if (v18)
    {
      v20 = @"check (NO_WAIT) requested when device before first-unlock";
LABEL_11:
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v11 withErrorCode:6206 fromAction:v14 withDescription:v20];
      goto LABEL_12;
    }

    v21 = [v12 clientAssetSelector];
    v22 = [v21 assetVersion];

    v23 = [v12 clientAssetSelector];
    v36 = [v23 assetType];
    v33 = [v12 clientAssetSelector];
    v34 = [v33 assetSpecifier];
    if (v22)
    {
      v32 = [v12 clientAssetSelector];
      v24 = [v32 assetVersion];
      [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:v14 forAssetType:v36 withAssetSpecifier:v34 matchingAssetVersion:v24];
      v26 = v25 = v23;

      v27 = v26;
      v23 = v25;

      v20 = @"check (NO_WAIT) requested when specific asset-version not already downloaded";
    }

    else
    {
      v27 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:v14 forAssetType:v36 withAssetSpecifier:v34];
      v20 = @"check (NO_WAIT) requested when no already downloaded asset-version available";
    }

    if (!v27)
    {
      goto LABEL_11;
    }

    v37 = v27;
    v38 = 0;
    v28 = [(MADAutoAssetControlManager *)self buildFoundResponseMessage:@"checkForNewer" forClientRequest:v17 withFoundDescriptor:v27 withInstance:v12 withDesire:v13 fromLocation:v14 error:&v38];
    v29 = v38;
    if (!v29)
    {
      v35 = [v12 clientAssetSelector];
      v30 = [v35 assetVersion];
      [(MADAutoAssetControlManager *)self updateAutoAssetStatusForChosenDownloadedDescriptor:v37 matchingAssetVersion:v30 fromLocation:v14];
    }

    [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v17 issuingResponseMessage:v28 withResponseError:v29];
  }

LABEL_12:

  return v19 != 0;
}

- (BOOL)doesSetDescriptor:(id)a3 satisfySetConfiguration:(id)a4 allowingMoreDownloaded:(BOOL)a5
{
  v7 = a3;
  v8 = [a4 autoAssetEntries];
  v35 = [v7 requestedAutoAssetEntries];
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v9 = v8;
  v32 = [v9 countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (!v32)
  {
    goto LABEL_20;
  }

  v33 = *v46;
  v34 = v9;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v31 = v7;
  v30 = a5;
  while (2)
  {
    v11 = 0;
    while (2)
    {
      if (*v46 != v33)
      {
        objc_enumerationMutation(v9);
      }

      v36 = v11;
      v12 = *(*(&v45 + 1) + 8 * v11);
      v41 = 0u;
      v42 = 0u;
      v43 = 0u;
      v44 = 0u;
      obj = v35;
      v40 = [obj countByEnumeratingWithState:&v41 objects:v49 count:16];
      if (!v40)
      {
LABEL_22:

        v26 = 0;
        v9 = v34;
        v27 = v34;
        v7 = v31;
LABEL_24:

        goto LABEL_25;
      }

      v13 = *v42;
      v37 = v12;
LABEL_8:
      v14 = 0;
      while (1)
      {
        if (*v42 != v13)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v41 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        v17 = [v12 assetSelector];
        v18 = [v17 assetType];
        v19 = [v15 assetSelector];
        v20 = [v19 assetType];
        if (![v16 stringIsEqual:v18 to:v20])
        {

          goto LABEL_15;
        }

        v39 = p_weak_ivar_lyt[223];
        v21 = [v12 assetSelector];
        v22 = [v21 assetSpecifier];
        v23 = [v15 assetSelector];
        [v23 assetSpecifier];
        v25 = v24 = v13;
        LOBYTE(v39) = [v39 stringIsEqual:v22 to:v25];

        v13 = v24;
        v12 = v37;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v39)
        {
          break;
        }

LABEL_15:
        if (v40 == ++v14)
        {
          v40 = [obj countByEnumeratingWithState:&v41 objects:v49 count:16];
          if (v40)
          {
            goto LABEL_8;
          }

          goto LABEL_22;
        }
      }

      v11 = v36 + 1;
      v9 = v34;
      if ((v36 + 1) != v32)
      {
        continue;
      }

      break;
    }

    v7 = v31;
    a5 = v30;
    v32 = [v34 countByEnumeratingWithState:&v45 objects:v50 count:16];
    if (v32)
    {
      continue;
    }

    break;
  }

LABEL_20:

  if (!a5)
  {
    v27 = [v7 latestDowloadedAtomicInstanceEntries];
    v28 = [v27 count];
    v26 = v28 <= [v9 count];
    goto LABEL_24;
  }

  v26 = 1;
LABEL_25:

  return v26;
}

- (BOOL)handleClientLockContent:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7
{
  v11 = a3;
  v12 = a5;
  v13 = a6;
  v14 = a7;
  v81 = self;
  v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v16 = [v15 extendedStateQueue];
  dispatch_assert_queue_V2(v16);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v18 = [[NSString alloc] initWithFormat:@"%@:handleClientLockContent", v14];

  v19 = [v11 clientRequest];
  v20 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  if ((v20 & 1) == 0)
  {
    v78 = v19;
    v79 = v13;
    v80 = v11;
    v21 = [v12 clientAssetSelector];
    v22 = [v21 assetVersion];

    v23 = [v12 clientAssetSelector];
    v24 = [v23 assetType];
    v25 = [v12 clientAssetSelector];
    v26 = [v25 assetSpecifier];
    if (v22)
    {
      [v12 clientAssetSelector];
      v28 = v27 = v18;
      [v28 assetVersion];
      v30 = v29 = v12;
      v31 = [(MADAutoAssetControlManager *)v81 _latestDownloadedDescriptor:v27 forAssetType:v24 withAssetSpecifier:v26 matchingAssetVersion:v30];

      v12 = v29;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

      v18 = v27;
    }

    else
    {
      v31 = [(MADAutoAssetControlManager *)v81 _latestDownloadedDescriptor:v18 forAssetType:v24 withAssetSpecifier:v26];
    }

    v13 = v79;
    v11 = v80;
    v19 = v78;
    if (v31)
    {
      v77 = v12;
      v32 = [v31 assetType];
      if (v32)
      {
        v33 = v32;
        v34 = [v31 assetId];
        if (v34)
        {
          v35 = v34;
          v36 = [v31 metadata];

          if (v36)
          {
            v37 = p_weak_ivar_lyt;
            v38 = [MAAutoAssetSelector alloc];
            v39 = [v31 assetType];
            [v31 assetSpecifier];
            v40 = v76 = v18;
            v41 = [v31 assetVersion];
            v42 = [v38 initForAssetType:v39 withAssetSpecifier:v40 matchingAssetVersion:v41];

            v75 = v31;
            if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v76 forDescriptor:v31]&& [MADAutoAssetSecure isPersonalizationOrGraftingRequired:v76 forDescriptor:v31])
            {
              if ([MADAutoAssetSecure isPersonalizationRequired:v76 forDescriptor:v31])
              {
                [v31 setSecureOperationInProgress:1];
                v43 = [(MADAutoAssetControlManager *)v81 locateSetDescriptorForAssetDescriptor:v31];
                v88[0] = _NSConcreteStackBlock;
                v88[1] = 3221225472;
                v88[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke;
                v88[3] = &unk_4B46D0;
                v88[4] = v81;
                v89 = v31;
                v90 = v42;
                v91 = v76;
                v92 = v80;
                [MADAutoAssetSecure personalizeGraftDownloaded:v91 forDescriptor:v89 setDescriptor:v43 allowingNetwork:1 completion:v88];

                v44 = v89;
LABEL_23:

                v45 = 0;
LABEL_42:

                v18 = v76;
                goto LABEL_43;
              }

              if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:v76 forDescriptor:v31])
              {
                [v31 setSecureOperationInProgress:1];
                v43 = [(MADAutoAssetControlManager *)v81 locateSetDescriptorForAssetDescriptor:v31];
                v84[0] = _NSConcreteStackBlock;
                v84[1] = 3221225472;
                v84[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_3484;
                v84[3] = &unk_4B4680;
                v84[4] = v81;
                v85 = v31;
                v86 = v76;
                v87 = v80;
                [MADAutoAssetSecure graftDownloaded:v86 graftingDescriptor:v85 setDescriptor:v43 completion:v84];

                v44 = v85;
                goto LABEL_23;
              }
            }

            v50 = [v31 assetType];
            v51 = [v31 assetId];
            v52 = getAutoLocalUrlFromTypeAndIdWithPurpose(v50, v51, 2, @"auto");

            if (v52)
            {
              v74 = v42;
              v53 = [v77 autoAssetClientName];
              v54 = [v77 clientProcessName];
              v55 = [v77 clientProcessID];
              v56 = [v79 desireReason];
              v57 = [v79 clientAssetPolicy];
              v58 = [v31 metadata];
              v83 = 0;
              v73 = v52;
              LODWORD(v55) = [MADAutoAssetLocker lockedByClient:v53 forClientProcessName:v54 withClientProcessID:v55 forAssetSelector:v42 forLockReason:v56 withUsagePolicy:v57 withLocalContentURL:v52 withAssetAttributes:v58 lockError:&v83];
              v59 = v83;

              if (v55)
              {
                v11 = v80;
                if (usingCentralizedCachedelete())
                {
                  v60 = [v52 path];
                  markLockedAssetPurgeable(v60);
                }

                v13 = v79;
                v43 = v59;
                if ([v31 neverBeenLocked])
                {
                  v61 = [v77 autoAssetClientName];
                  if (v61)
                  {
                    [v77 autoAssetClientName];
                  }

                  else
                  {
                    [v77 clientProcessName];
                  }
                  v66 = ;

                  [v31 setNeverBeenLocked:0];
                  LOBYTE(v72) = 0;
                  [(MADAutoAssetControlManager *)v81 trackDescriptor:v31 persisting:1 fromLocation:v76 changedWhileTerminated:0 changedNeverBeenLocked:1 historyOperation:0 firstClientName:v66 isPromoted:v72];
                }

                v67 = [v77 clientAssetSelector];
                v68 = [v67 assetVersion];
                [(MADAutoAssetControlManager *)v81 updateAutoAssetStatusForChosenDownloadedDescriptor:v31 matchingAssetVersion:v68 fromLocation:v76];

                v82 = 0;
                v69 = [(MADAutoAssetControlManager *)v81 buildFoundResponseMessage:@"lockContent" forClientRequest:v78 withFoundDescriptor:v31 withInstance:v77 withDesire:v79 fromLocation:v76 error:&v82];
                v70 = v82;
                [(MADAutoAssetControlManager *)v81 issueResponseToClientRequest:v78 issuingResponseMessage:v69 withResponseError:v70];

                v45 = 0;
                v52 = v73;
                v42 = v74;
              }

              else
              {
                v13 = v79;
                v11 = v80;
                if ([v79 lockWaitTimeoutSecs])
                {
                  v45 = 1;
                  v43 = v59;
                }

                else
                {
                  v43 = v59;
                  [(MADAutoAssetControlManager *)v81 issueResponseForEventInfo:v80 withAutoAssetError:v59 fromAction:v76 withDescription:@"unable to lock auto-asset"];
                  v45 = 0;
                }

                v42 = v74;
              }
            }

            else
            {
              v62 = objc_alloc(v37[226]);
              v63 = [v31 summary];
              v64 = [v62 initWithFormat:@"unable to get local content URL | chosenDownloadedDescriptor:%@", v63];

              v43 = [MAAutoAssetError buildError:6101 fromOperation:v76 underlyingError:0 withDescription:v64];
              v65 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v94 = v76;
                v95 = 2114;
                v96 = v64;
                _os_log_impl(&dword_0, v65, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {%{public}@} failure to lock content - %{public}@", buf, 0x16u);
              }

              [(MADAutoAssetControlManager *)v81 issueResponseForEventInfo:v80 withAutoAssetError:v43 fromAction:v76 withDescription:@"failure to lock content"];
              v45 = 0;
            }

            goto LABEL_42;
          }
        }

        else
        {
        }
      }

      v47 = objc_alloc(p_weak_ivar_lyt[226]);
      v48 = [v31 summary];
      v49 = [v47 initWithFormat:@"lock found descriptor MISSING required element(s) | chosenDownloadedDescriptor:%@", v48];
      [(MADAutoAssetControlManager *)v81 issueResponseForEventInfo:v80 withErrorCode:6111 fromAction:v18 withDescription:v49];

      v45 = 0;
LABEL_43:
      v12 = v77;
      goto LABEL_44;
    }
  }

  if ([v13 lockWaitTimeoutSecs])
  {
    v45 = 1;
  }

  else
  {
    if (v20)
    {
      v46 = @"lock (NO_WAIT) requested when device before first-unlock";
    }

    else
    {
      v46 = @"lock (NO_WAIT) requested when specific asset-version not already downloaded";
    }

    [(MADAutoAssetControlManager *)v81 issueResponseForEventInfo:v11 withErrorCode:6503 fromAction:v18 withDescription:v46];
    v45 = 0;
  }

LABEL_44:

  return v45;
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2;
  block[3] = &unk_4B3818;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      *buf = 138543618;
      v10 = v3;
      v11 = 2114;
      v12 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-GRAFT][SINGLETON-CONTROL][ELIMINATE] {%{public}@} | eliminate triggered while performing personalize+graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else if (*(a1 + 72))
  {
    v8 = [[NSString alloc] initWithFormat:@"%@[PERSONALIZING/GRAFTING]", *(a1 + 56)];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:? forEventInfo:? withResponseError:? forAttemptedDescriptor:?];
  }

  else
  {
    v5 = *(a1 + 64);
    v7 = *(a1 + 32);
    v6 = *(a1 + 40);

    [v6 lockAutoAssetReplyJobResponse:@"any personalization/grafting [or mounting] successful" forEventInfo:v5 lockingChosenDescriptor:v7];
  }
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_3484(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2_3485;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2_3485(uint64_t a1)
{
  v2 = [MAAutoAssetSelector alloc];
  v3 = [*(a1 + 32) assetType];
  v4 = [*(a1 + 32) assetSpecifier];
  v5 = [*(a1 + 32) assetVersion];
  v6 = [v2 initForAssetType:v3 withAssetSpecifier:v4 matchingAssetVersion:v5];

  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:v6])
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = *(a1 + 48);
      v9 = [*(a1 + 32) summary];
      *buf = 138543618;
      v12 = v8;
      v13 = 2114;
      v14 = v9;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL][ELIMINATE] {%{public}@} | eliminate triggered while grafting|mounting | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 48) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v10 = [[NSString alloc] initWithFormat:@"%@[GRAFTING]", *(a1 + 48)];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:v10 forEventInfo:*(a1 + 56) withResponseError:*(a1 + 64) forAttemptedDescriptor:*(a1 + 32)];
  }

  else
  {
    [*(a1 + 40) lockAutoAssetReplyJobResponse:@"grafting [or mounting] successful" forEventInfo:*(a1 + 56) lockingChosenDescriptor:*(a1 + 32)];
  }
}

- (id)buildFoundResponseMessage:(id)a3 forClientRequest:(id)a4 withFoundDescriptor:(id)a5 withInstance:(id)a6 withDesire:(id)a7 fromLocation:(id)a8 error:(id *)a9
{
  v86 = a3;
  v15 = a4;
  v16 = a5;
  v87 = a6;
  v94 = a7;
  v96 = a8;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v85 = v15;
  v19 = [v15 clientRequestMessage];
  v97 = [MADAutoAssetControlManager replyMessageNameForRequest:v19];

  v93 = objc_alloc_init(NSMutableDictionary);
  v20 = [MAAutoAssetSelector alloc];
  v21 = [v16 assetType];
  v22 = [v16 assetSpecifier];
  v23 = [v16 assetVersion];
  v95 = [v20 initForAssetType:v21 withAssetSpecifier:v22 matchingAssetVersion:v23];

  v24 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  v25 = [(MADAutoAssetControlManager *)self jobSelectorKey:v95];
  v26 = [v24 safeObjectForKey:v25 ofClass:objc_opt_class()];

  v88 = v16;
  if (v26 || (v27 = objc_alloc_init(MAAutoAssetNotifications), [v27 setContentAvailableForUse:1], objc_msgSend(v16, "metadata"), v90 = objc_claimAutoreleasedReturnValue(), v83 = objc_msgSend(v16, "neverBeenLocked"), v81 = objc_msgSend(v16, "downloadUserInitiated"), v79 = objc_msgSend(v16, "downloadedNetworkBytes"), v28 = objc_msgSend(v16, "downloadedFilesystemBytes"), v29 = objc_msgSend(v16, "isPatch"), objc_msgSend(v16, "patchedFromBaseSelector"), v30 = v16, v31 = objc_claimAutoreleasedReturnValue(), v32 = objc_msgSend(v30, "patchedFromBaseFilesystemBytes"), v33 = objc_msgSend(v30, "patchingAttempted"), v34 = objc_msgSend(v30, "stagedPriorToAvailable"), objc_msgSend(v30, "stagedFromOSVersion"), v35 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v30, "stagedFromBuildVersion"), v36 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v30, "patchingAttemptError"), v37 = objc_claimAutoreleasedReturnValue(), LOBYTE(v70) = 0, BYTE1(v69) = v34, LOBYTE(v69) = v33, LOBYTE(v68) = v29, v26 = -[MADAutoAssetControlManager newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:](self, "newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:", v95, v27, v90, 0, v83, v81, 0, v79, v28, v68, v31, v32, v69, v35, v36, v70, 0, v37, 0), v37, v36, v35, v31, v90, v27, v26))
  {
    v84 = [v26 assetSelector];
    v82 = [v26 notifications];
    v80 = [v26 availableForUseAttributes];
    v78 = [v26 newerVersionAttributes];
    v91 = [v26 neverBeenLocked];
    v77 = [v26 downloadUserInitiated];
    v72 = [v26 downloadProgress];
    v76 = [v26 downloadedNetworkBytes];
    v75 = [v26 downloadedFilesystemBytes];
    v74 = [v26 downloadedAsPatch];
    v71 = [v26 patchedFromBaseSelector];
    v73 = [v26 patchedFromBaseFilesystemBytes];
    v38 = [v26 patchingAttempted];
    v39 = [v26 stagedPriorToAvailable];
    v40 = [v26 stagedFromOSVersion];
    v41 = [v26 stagedFromBuildVersion];
    v42 = [v26 availableForUseError];
    v43 = [v26 patchingAttemptError];
    v44 = [v26 newerVersionError];
    LOBYTE(v70) = 1;
    BYTE1(v69) = v39;
    LOBYTE(v69) = v38;
    LOBYTE(v68) = v74;
    v92 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v84 withNotifications:v82 withAvailableForUseAttributes:v80 withNewerVersionAttributes:v78 withNeverBeenLocked:v91 withDownloadUserInitiated:v77 withDownloadProgress:v72 withDownloadedNetworkBytes:v76 withDownloadedFilesystemBytes:v75 withDownloadedAsPatch:v68 withPatchedFromBaseSelector:v71 withPatchedFromBaseFilesystemBytes:v73 withPatchingAttempted:v69 withStagedPriorToAvailable:v40 withStagedFromOSVersion:v41 withStagedFromBuildVersion:v70 extendingWithCurrentLockUsage:v42 withAvailableForUseError:v43 withPatchingAttemptError:v44 withNewerVersionError:?];
  }

  else
  {
    v92 = 0;
  }

  v45 = v88;
  if (![SUCore stringIsEqual:v97 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
  {
    v46 = 0;
    v48 = v85;
    v47 = v86;
    v49 = v87;
LABEL_11:
    v56 = v92;
    if (v92)
    {
      v57 = [MAAutoAssetInfoFound alloc];
      v58 = [v88 metadata];
      v56 = [v57 initForSelector:v95 withLocalContentURL:v46 withAssetAttributes:v58 reportingStatus:v92];
    }

    if (v49)
    {
      [v93 setSafeObject:v49 forKey:@"instance"];
    }

    if (v56)
    {
      [v93 setSafeObject:v56 forKey:@"found"];
    }

    if (v94)
    {
      [v93 setSafeObject:v94 forKey:@"desire"];
    }

    v59 = [SUCoreConnectMessage alloc];
    v60 = [v48 clientID];
    v55 = [v59 initWithType:2 messageName:v97 clientID:v60 version:0 message:v93];

    if (v55)
    {
      v53 = 0;
    }

    else
    {
      v61 = [[NSString alloc] initWithFormat:@"unable to build response for %@ request", v47];
      v62 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
      {
        v63 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v64 = [v48 summary];
        v65 = [v56 summary];
        *buf = 138544386;
        v99 = v63;
        v100 = 2114;
        v101 = v96;
        v102 = 2114;
        v103 = v61;
        v104 = 2114;
        v105 = v64;
        v106 = 2114;
        v107 = v65;
        _os_log_impl(&dword_0, v62, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:buildFoundResponseMessage} failed to create response message - %{public}@ | clientRequest:%{public}@ | found:%{public}@", buf, 0x34u);

        v49 = v87;
        v45 = v88;
      }

      v53 = [MAAutoAssetError buildError:6101 fromOperation:v96 underlyingError:0 withDescription:v61];

      v55 = 0;
    }

    goto LABEL_24;
  }

  v46 = [MADAutoAssetSecure localContentURL:v96 forDescriptor:v88];
  v48 = v85;
  v47 = v86;
  v49 = v87;
  if (v46)
  {
    goto LABEL_11;
  }

  v50 = [NSString alloc];
  v51 = [v88 summary];
  v52 = [v50 initWithFormat:@"unable to get local content URL | foundDescriptor:%@", v51];

  v53 = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:v52];
  v54 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
  {
    *buf = 138543618;
    v99 = v96;
    v100 = 2114;
    v101 = v52;
    _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {%{public}@} failure to build found response - %{public}@", buf, 0x16u);
  }

  v46 = 0;
  v55 = 0;
  v56 = 0;
  if (!v53)
  {
    goto LABEL_11;
  }

LABEL_24:
  if (a9)
  {
    v66 = v53;
    *a9 = v53;
  }

  return v55;
}

- (void)handleClientAlterLockOperation:(id)a3 forAutoJob:(id)a4
{
  v53 = a3;
  v48 = a4;
  v60 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientAlterLockOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v53 clientRequestMessage];
  v49 = [v9 messageName];

  v10 = [(MADAutoAssetControlManager *)v60 clientRequestMessageInstance:v53];
  v56 = v10;
  if (!v10)
  {
    v13 = @"no auto-asset-instance provided in client request related to pre-existing lock";
    goto LABEL_7;
  }

  v11 = [v10 clientAssetSelector];
  v12 = [v11 assetVersion];
  if (!v12)
  {
    v14 = [SUCore stringIsEqual:v49 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"];

    if (!v14)
    {
      goto LABEL_8;
    }

    v13 = @"asset-selector missing indication of asset-version when required to identify pre-existing lock";
LABEL_7:
    [(MADAutoAssetControlManager *)v60 issueResponseForEventInfo:v53 withErrorCode:6102 fromAction:@"handleClientAlterLockOperation" withDescription:v13];
    goto LABEL_45;
  }

LABEL_8:
  v15 = [v56 clientAssetSelector];
  v16 = [v15 assetVersion];
  v17 = v16 == 0;

  if (!v17)
  {
    v18 = [v56 clientAssetSelector];
    v19 = [v18 assetType];
    v20 = [v56 clientAssetSelector];
    v21 = [v20 assetSpecifier];
    v22 = [v56 clientAssetSelector];
    v23 = [v22 assetVersion];
    v24 = [(MADAutoAssetControlManager *)v60 _latestDownloadedDescriptor:@"handleClientAlterLockOperation" forAssetType:v19 withAssetSpecifier:v21 matchingAssetVersion:v23];

    if (v24)
    {
      v61 = 0;
      v50 = [(MADAutoAssetControlManager *)v60 _handleClientAlterLockOperationForDescriptor:v24 forEventInfo:v53 error:&v61];
      v25 = v61;
    }

    else
    {
      v25 = [MAAutoAssetError buildError:6110 fromOperation:@"handleClientAlterLockOperation" underlyingError:0 withDescription:@"auto-asset-descriptor (for provided full-asset-selector) is not currently downloaded"];
      v50 = @"auto-asset-descriptor (for provided full-asset-selector) is not currently downloaded";
      v24 = 0;
    }

    v44 = v25;
    if (!v25)
    {
      goto LABEL_43;
    }

    goto LABEL_38;
  }

  v26 = [(MADAutoAssetControlManager *)v60 persistedKnownDescriptors];
  v27 = [v56 clientAssetSelector];
  v47 = [v26 persistedEntryIDs:@"handleClientAlterLockOperation" assetSelector:v27];

  if (![v47 count])
  {
    v50 = @"no auto-asset-descriptors currently downloaded";
    v51 = [MAAutoAssetError buildError:6110 fromOperation:@"_handleClientAlterLockOperation" underlyingError:0 withDescription:?];
    goto LABEL_42;
  }

  v65 = 0u;
  v66 = 0u;
  v63 = 0u;
  v64 = 0u;
  obj = v47;
  v28 = [obj countByEnumeratingWithState:&v63 objects:v70 count:16];
  if (!v28)
  {
    v51 = 0;
    v52 = 0;
    v54 = 0;
    v50 = 0;
    goto LABEL_41;
  }

  v51 = 0;
  v52 = 0;
  v54 = 0;
  v50 = 0;
  v58 = *v64;
  do
  {
    v29 = 0;
    v59 = v28;
    do
    {
      if (*v64 != v58)
      {
        objc_enumerationMutation(obj);
      }

      v30 = *(*(&v63 + 1) + 8 * v29);
      v31 = objc_autoreleasePoolPush();
      v32 = [(MADAutoAssetControlManager *)v60 persistedKnownDescriptors];
      v33 = [v32 persistedEntry:v30 fromLocation:@"handleClientAlterLockOperation"];

      if (v33)
      {
        v34 = [v33 secureCodedObjectForKey:@"assetDescriptor" ofClass:objc_opt_class()];
        v35 = v34;
        if (!v34)
        {
          v36 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v69 = v30;
            _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, "{handleClientAlterLockOperation} unable to secure-decode persistedKnownDescriptors entry | entryID:%{public}@", buf, 0xCu);
          }

          goto LABEL_30;
        }

        if (![v34 isOnFilesystem])
        {
          goto LABEL_31;
        }

        v36 = [v35 assetType];
        v37 = [v56 clientAssetSelector];
        v38 = [v37 assetType];
        if (([SUCore stringIsEqual:v36 to:v38]& 1) == 0)
        {

          goto LABEL_30;
        }

        v55 = [v35 assetSpecifier];
        v39 = [v56 clientAssetSelector];
        v40 = [v39 assetSpecifier];
        v41 = [SUCore stringIsEqual:v55 to:v40];

        if (!v41)
        {
          goto LABEL_31;
        }

        v62 = v54;
        v42 = [(MADAutoAssetControlManager *)v60 _handleClientAlterLockOperationForDescriptor:v35 forEventInfo:v53 error:&v62];
        v43 = v62;

        if (v43 && !v51)
        {
          v36 = v50;
          v51 = v43;
          v52 = v42;
          v50 = v52;
          v54 = v51;
LABEL_30:

          goto LABEL_31;
        }

        v52 = v42;
        v54 = v43;
      }

      else
      {
        v35 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v69 = v30;
          _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "{handleClientAlterLockOperation} unable to load persistedKnownDescriptors entry | entryID:%{public}@", buf, 0xCu);
        }
      }

LABEL_31:

      objc_autoreleasePoolPop(v31);
      v29 = v29 + 1;
    }

    while (v59 != v29);
    v28 = [obj countByEnumeratingWithState:&v63 objects:v70 count:16];
  }

  while (v28);
LABEL_41:

LABEL_42:
  v24 = 0;
  v44 = v51;
  if (v51)
  {
LABEL_38:
    v45 = v44;
    v46 = v50;
    [(MADAutoAssetControlManager *)v60 issueResponseForEventInfo:v53 withAutoAssetError:v44 fromAction:@"handleClientAlterLockOperation" withDescription:v50];
    goto LABEL_44;
  }

LABEL_43:
  v45 = v44;
  v46 = v50;
  [MADAutoAssetControlManager issueResponseForEventInfo:v60 withErrorCode:"issueResponseForEventInfo:withErrorCode:fromAction:withDescription:" fromAction:v53 withDescription:?];
LABEL_44:

LABEL_45:
  os_activity_scope_leave(&state);
}

- (id)_handleClientAlterLockOperationForDescriptor:(id)a3 forEventInfo:(id)a4 error:(id *)a5
{
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [v9 clientRequestMessage];
  v13 = [v12 message];

  v14 = [v9 clientRequestMessage];
  v15 = [v14 messageName];

  v68 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v9];

  v16 = [MAAutoAssetSelector alloc];
  v17 = [v8 assetType];
  v18 = [v8 assetSpecifier];
  v19 = [v8 assetVersion];
  v20 = [v16 initForAssetType:v17 withAssetSpecifier:v18 matchingAssetVersion:v19];

  v21 = [v8 assetType];
  v22 = [v8 assetId];
  v23 = getAutoLocalUrlFromTypeAndIdWithPurpose(v21, v22, 2, @"auto");

  if (!v23)
  {
    v35 = [NSString alloc];
    v36 = [v8 summary];
    v34 = [v35 initWithFormat:@"unable to get local content URL | descriptor:%@", v36];

    v32 = [MAAutoAssetError buildError:6101 fromOperation:@"_handleClientAlterLockOperation" underlyingError:0 withDescription:v34];
    v27 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v74 = v34;
      _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {_handleClientAlterLockOperation} failure to perform alter lock operation - %{public}@", buf, 0xCu);
    }

    goto LABEL_44;
  }

  if (![SUCore stringIsEqual:v15 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"])
  {
    if ([SUCore stringIsEqual:v15 to:@"MA-AUTO:END_LOCK_USAGE"])
    {
      v60 = a5;
      v66 = v13;
      v27 = [v13 safeObjectForKey:@"end" ofClass:objc_opt_class()];
      v37 = [v68 autoAssetClientName];
      v38 = [v27 endLockReason];
      v71 = 0;
      v39 = [MADAutoAssetLocker endedLockByClient:v37 forAssetSelector:v20 forLockReason:v38 endError:&v71];
      v32 = v71;

      if (!v39)
      {
        v44 = [NSString alloc];
        v45 = [v8 summary];
        v34 = [v44 initWithFormat:@"unable to end lock | descriptor:%@", v45];
        v13 = v66;
        a5 = v60;
LABEL_29:

        goto LABEL_44;
      }

      a5 = v60;
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:v8])
      {
        v34 = 0;
        v13 = v66;
        goto LABEL_44;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_LOCK_USAGE)" forDescriptorNoLongerLocked:v8];
      if ([v8 secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation" forAutoAssetDescriptor:v8 failingClientRequestForEventInfo:0];
      }

      v13 = v66;
      if (usingCentralizedCachedelete())
      {
LABEL_27:
        v45 = [v23 path];
        markAssetPurgeable(v45);
        v34 = 0;
        goto LABEL_29;
      }

LABEL_34:
      v34 = 0;
      goto LABEL_44;
    }

    v64 = v23;
    if ([SUCore stringIsEqual:v15 to:@"MA-AUTO:END_PREVIOUS_LOCKS"])
    {
      v61 = a5;
      v67 = v13;
      v27 = [v13 safeObjectForKey:@"end" ofClass:objc_opt_class()];
      v41 = [v68 autoAssetClientName];
      v42 = [v27 endLockReason];
      v70 = 0;
      v43 = [MADAutoAssetLocker endedPreviousLocksByClient:v41 forAssetSelector:v20 forLockReason:v42 removingLockCount:[v27 endLockCount] endError:&v70];
      v32 = v70;

      if (!v43)
      {
        v51 = [NSString alloc];
        v45 = [v8 summary];
        v34 = [v51 initWithFormat:@"unable to end previous locks | descriptor:%@", v45];
        a5 = v61;
        v13 = v67;
        goto LABEL_29;
      }

      a5 = v61;
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:v8])
      {
        v34 = 0;
        v13 = v67;
        goto LABEL_44;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_PREVIOUS_LOCKS)" forDescriptorNoLongerLocked:v8];
      if ([v8 secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation(END_PREVIOUS_LOCKS)" forAutoAssetDescriptor:v8 failingClientRequestForEventInfo:0];
      }

      v13 = v67;
      if (usingCentralizedCachedelete())
      {
        goto LABEL_27;
      }

      goto LABEL_34;
    }

    v46 = v20;
    if (![SUCore stringIsEqual:v15 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"])
    {
      v52 = [NSString alloc];
      [v8 summary];
      v53 = v15;
      v55 = v54 = v13;
      v34 = [v52 initWithFormat:@"unknown auto-asset lock manipulation command request received | descriptor:%@", v55];

      v13 = v54;
      v15 = v53;
      v32 = [MAAutoAssetError buildError:6106 fromOperation:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" underlyingError:0 withDescription:v34];
      v20 = v46;
      v23 = v64;
      goto LABEL_45;
    }

    v62 = a5;
    v47 = v13;
    v27 = [v13 safeObjectForKey:@"end" ofClass:objc_opt_class()];
    v48 = [v68 autoAssetClientName];
    v49 = [v27 endLockReason];
    v69 = 0;
    v50 = [MADAutoAssetLocker endedAllPreviousLocksByClient:v48 forAssetSelector:v46 forLockReason:v49 endError:&v69];
    v32 = v69;

    if (v50)
    {
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:v8])
      {
        v34 = 0;
        a5 = v62;
        v13 = v47;
LABEL_42:
        v20 = v46;
        goto LABEL_43;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" forDescriptorNoLongerLocked:v8];
      if ([v8 secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" forAutoAssetDescriptor:v8 failingClientRequestForEventInfo:0];
      }

      a5 = v62;
      v13 = v47;
      if (!usingCentralizedCachedelete())
      {
        v34 = 0;
        goto LABEL_42;
      }

      v57 = [v64 path];
      markAssetPurgeable(v57);
      v34 = 0;
    }

    else
    {
      v56 = [NSString alloc];
      v57 = [v8 summary];
      v34 = [v56 initWithFormat:@"unable to end all previous locks | descriptor:%@", v57];
      a5 = v62;
      v13 = v47;
    }

    v20 = v46;

LABEL_43:
    v23 = v64;
    goto LABEL_44;
  }

  v24 = v15;
  v25 = v23;
  v63 = v24;
  v26 = a5;
  v65 = v13;
  v27 = [v13 safeObjectForKey:@"desire" ofClass:objc_opt_class()];
  v28 = [v68 autoAssetClientName];
  v29 = [v27 desireReason];
  v30 = [v27 clientAssetPolicy];
  v72 = 0;
  v31 = [MADAutoAssetLocker continuedLockByClient:v28 forAssetSelector:v20 forLockReason:v29 withUsagePolicy:v30 continueError:&v72];
  v32 = v72;

  if (v31)
  {
    a5 = v26;
    if (!usingCentralizedCachedelete())
    {
      v34 = 0;
      v13 = v65;
      v23 = v25;
      v15 = v63;
      goto LABEL_44;
    }

    v23 = v25;
    v33 = [v25 path];
    markLockedAssetPurgeable(v33);
    v34 = 0;
    v13 = v65;
  }

  else
  {
    v40 = [NSString alloc];
    v33 = [v8 summary];
    v34 = [v40 initWithFormat:@"unable to continue lock | descriptor:%@", v33];
    a5 = v26;
    v13 = v65;
    v23 = v25;
  }

  v15 = v63;
LABEL_44:

LABEL_45:
  if (a5)
  {
    v58 = v32;
    *a5 = v32;
  }

  return v34;
}

- (void)handleClientCurrentStatusRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientCurrentStatusRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __74__MADAutoAssetControlManager_handleClientCurrentStatusRequest_forAutoJob___block_invoke;
  block[3] = &unk_4B2AF0;
  block[4] = self;
  v14 = v6;
  v15 = v7;
  v11 = v7;
  v12 = v6;
  dispatch_async(v10, block);

  os_activity_scope_leave(&state);
}

void __74__MADAutoAssetControlManager_handleClientCurrentStatusRequest_forAutoJob___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) clientRequestMessageInstance:*(a1 + 40)];
  v3 = [*(a1 + 32) currentStatusBySelector];
  v4 = *(a1 + 32);
  v5 = [v2 clientAssetSelector];
  v6 = [v4 jobSelectorKey:v5];
  v7 = [v3 safeObjectForKey:v6 ofClass:objc_opt_class()];

  v137 = v2;
  v138 = a1;
  v136 = *(a1 + 48);
  if (v7)
  {
    v139 = *(a1 + 32);
    v132 = [v2 clientAssetSelector];
    v128 = [v7 notifications];
    v124 = [v7 availableForUseAttributes];
    v121 = [v7 newerVersionAttributes];
    v118 = [v7 neverBeenLocked];
    v115 = [v7 downloadUserInitiated];
    v109 = [v7 downloadProgress];
    v114 = [v7 downloadedNetworkBytes];
    v112 = [v7 downloadedFilesystemBytes];
    v111 = [v7 downloadedAsPatch];
    v108 = [v7 patchedFromBaseSelector];
    v110 = [v7 patchedFromBaseFilesystemBytes];
    v8 = [v7 patchingAttempted];
    v9 = [v7 stagedPriorToAvailable];
    v10 = [v7 stagedFromOSVersion];
    v11 = [v7 stagedFromBuildVersion];
    v12 = [v7 availableForUseError];
    v13 = [v7 patchingAttemptError];
    v14 = [v7 newerVersionError];
    LOBYTE(v107) = 1;
    BYTE1(v106) = v9;
    LOBYTE(v106) = v8;
    LOBYTE(v105) = v111;
    v15 = v132;
    v140 = [v139 newAssetStatusForSelector:v132 withNotifications:v128 withAvailableForUseAttributes:v124 withNewerVersionAttributes:v121 withNeverBeenLocked:v118 withDownloadUserInitiated:v115 withDownloadProgress:v109 withDownloadedNetworkBytes:v114 withDownloadedFilesystemBytes:v112 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:v108 withPatchedFromBaseFilesystemBytes:v110 withPatchingAttempted:v106 withStagedPriorToAvailable:v10 withStagedFromOSVersion:v11 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:v12 withAvailableForUseError:v13 withPatchingAttemptError:v14 withNewerVersionError:?];

LABEL_7:
    goto LABEL_8;
  }

  v16 = [v2 clientAssetSelector];
  v17 = [v16 assetVersion];

  v18 = *(a1 + 32);
  if (v17)
  {
    v19 = [v2 clientAssetSelector];
    v15 = [v18 locateDownloadedByFullSelector:v19];

    v20 = *(a1 + 32);
    if (v15)
    {
      v133 = [v2 clientAssetSelector];
      v129 = objc_alloc_init(MAAutoAssetNotifications);
      v125 = [v15 metadata];
      v141 = [v15 neverBeenLocked];
      v122 = [v15 downloadUserInitiated];
      v119 = [v15 downloadedNetworkBytes];
      v116 = [v15 downloadedFilesystemBytes];
      v21 = [v15 isPatch];
      v22 = [v15 patchedFromBaseSelector];
      v23 = [v15 patchedFromBaseFilesystemBytes];
      v24 = [v15 patchingAttempted];
      v25 = [v15 stagedPriorToAvailable];
      v26 = [v15 stagedFromOSVersion];
      v27 = [v15 stagedFromBuildVersion];
      v28 = [v15 patchingAttemptError];
      LOBYTE(v107) = 1;
      BYTE1(v106) = v25;
      LOBYTE(v106) = v24;
      v29 = v133;
      LOBYTE(v105) = v21;
      v140 = [v20 newAssetStatusForSelector:v133 withNotifications:v129 withAvailableForUseAttributes:v125 withNewerVersionAttributes:0 withNeverBeenLocked:v141 withDownloadUserInitiated:v122 withDownloadProgress:0 withDownloadedNetworkBytes:v119 withDownloadedFilesystemBytes:v116 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:v22 withPatchedFromBaseFilesystemBytes:v23 withPatchingAttempted:v106 withStagedPriorToAvailable:v26 withStagedFromOSVersion:v27 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:v28 withPatchingAttemptError:0 withNewerVersionError:?];

LABEL_6:
      goto LABEL_7;
    }

    v61 = [*(a1 + 32) stagerCurrentJob];
    if (v61)
    {
      v29 = v61;
      v62 = [v2 clientAssetSelector];
      v63 = [v62 assetType];
      v64 = [*(a1 + 32) stagerCurrentJob];
      v65 = [v64 autoAssetSelector];
      [v65 assetType];
      v67 = v66 = v2;
      if (![SUCore stringIsEqual:v63 to:v67])
      {

LABEL_53:
        v140 = 0;
        goto LABEL_6;
      }

      v142 = v62;
      v134 = v29;
      v68 = [v66 clientAssetSelector];
      v69 = [v68 assetSpecifier];
      v126 = [*(a1 + 32) stagerCurrentJob];
      v123 = [v126 autoAssetSelector];
      v70 = [v123 assetSpecifier];
      v130 = v69;
      v71 = v69;
      v72 = v70;
      if ([SUCore stringIsEqual:v71 to:v70])
      {
        v117 = [v66 clientAssetSelector];
        v113 = [v117 assetVersion];
        v73 = [*(a1 + 32) stagerCurrentJob];
        [v73 autoAssetSelector];
        v74 = v120 = v68;
        [v74 assetVersion];
        v76 = v75 = v63;
        v77 = [SUCore stringIsEqual:v113 to:v76];

        v63 = v75;
        v68 = v120;
      }

      else
      {
        v77 = 0;
      }

      if (v77)
      {
        v100 = *(v138 + 32);
        if (!*(v138 + 48))
        {
          v102 = [v137 clientAssetSelector];
          v103 = objc_alloc_init(MAAutoAssetNotifications);
          LOBYTE(v107) = 1;
          LOWORD(v106) = 0;
          LOBYTE(v105) = 0;
          v140 = [v100 newAssetStatusForSelector:v102 withNotifications:v103 withAvailableForUseAttributes:0 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v106 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

          [*(v138 + 32) stagerCurrentJob];
          v136 = v29 = v136;
          goto LABEL_6;
        }

        v29 = [*(v138 + 32) autoControlManagerFSM];
        v101 = [v29 diag];
        [v101 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleClientCurrentStatusRequest} downloading-stager-job matching provided auto-job" withResult:6101 withError:0];

        goto LABEL_53;
      }
    }

    v140 = 0;
    goto LABEL_7;
  }

  v56 = [*(a1 + 32) stagerCurrentJob];
  if (v56)
  {
    v57 = v56;
    v58 = [*(a1 + 32) stagerCurrentJob];
    v59 = [v58 autoAssetSelector];
    v60 = [v59 assetVersion];
    if (v60)
    {
    }

    else
    {
      v143 = [v2 clientAssetSelector];
      v78 = [v143 assetType];
      v79 = [*(a1 + 32) stagerCurrentJob];
      v80 = [v79 autoAssetSelector];
      v81 = [v80 assetType];
      v135 = v78;
      if ([SUCore stringIsEqual:v78 to:v81])
      {
        v127 = [v2 clientAssetSelector];
        v82 = [v127 assetSpecifier];
        v83 = [*(a1 + 32) stagerCurrentJob];
        v84 = [v83 autoAssetSelector];
        v85 = [v84 assetSpecifier];
        v131 = [SUCore stringIsEqual:v82 to:v85];

        v86 = v138;
        v2 = v137;

        if (!v131)
        {
          goto LABEL_34;
        }

        v87 = *(v138 + 32);
        if (!*(v138 + 48))
        {
          v104 = [v87 stagerCurrentJob];

          v97 = 0;
          v136 = v104;
LABEL_46:
          v98 = *(v86 + 32);
          v88 = [v2 clientAssetSelector];
          v99 = objc_alloc_init(MAAutoAssetNotifications);
          LOBYTE(v107) = 1;
          LOWORD(v106) = 0;
          LOBYTE(v105) = 0;
          v140 = [v98 newAssetStatusForSelector:v88 withNotifications:v99 withAvailableForUseAttributes:0 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v106 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

          goto LABEL_47;
        }

        v57 = [v87 autoControlManagerFSM];
        v58 = [v57 diag];
        [v58 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleClientCurrentStatusRequest} determining-stager-job matching provided auto-job" withResult:6101 withError:0];
        goto LABEL_33;
      }
    }

LABEL_33:
  }

LABEL_34:
  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v144 = 0u;
  v145 = 0u;
  v146 = 0u;
  v88 = v147 = 0u;
  v89 = [v88 countByEnumeratingWithState:&v144 objects:v156 count:16];
  if (!v89)
  {
LABEL_43:
    v140 = 0;
    v97 = v88;
LABEL_47:

    goto LABEL_8;
  }

  v90 = v89;
  v91 = *v145;
LABEL_36:
  v92 = 0;
  while (1)
  {
    if (*v145 != v91)
    {
      objc_enumerationMutation(v88);
    }

    v93 = *(*(&v144 + 1) + 8 * v92);
    if (([v93 setJob] & 1) == 0)
    {
      v94 = [v93 assetSelector];
      v95 = [v2 clientAssetSelector];
      v96 = [MADAutoAssetScheduler isSelector:v94 consideredEqualTo:v95];

      if (v96)
      {
        break;
      }
    }

    if (v90 == ++v92)
    {
      v90 = [v88 countByEnumeratingWithState:&v144 objects:v156 count:16];
      if (v90)
      {
        goto LABEL_36;
      }

      goto LABEL_43;
    }
  }

  v97 = v93;

  if (v97)
  {
    v86 = v138;
    goto LABEL_46;
  }

  v140 = 0;
LABEL_8:
  if (v140)
  {
    v30 = objc_alloc_init(NSMutableDictionary);
    v31 = [MAAutoAssetInfoFound alloc];
    v32 = v137;
    v33 = [v137 clientAssetSelector];
    v34 = [v31 initForSelector:v33 withLocalContentURL:0 withAssetAttributes:0 reportingStatus:v140];

    [v30 setSafeObject:v137 forKey:@"instance"];
    [v30 setSafeObject:v34 forKey:@"found"];
    v35 = [SUCoreConnectMessage alloc];
    v36 = v138;
    v37 = [*(v138 + 40) clientRequestMessage];
    v38 = [MADAutoAssetControlManager replyMessageNameForRequest:v37];
    v39 = [*(v138 + 40) clientRequestMessage];
    v40 = [v39 clientID];
    v41 = [v35 initWithType:2 messageName:v38 clientID:v40 version:0 message:v30];

    [*(v36 + 32) issueBuiltResponseForEventInfo:*(v36 + 40) issuingResponseMessage:v41 withResponseError:0 fromLocation:@"handleClientCurrentStatusRequest"];
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      v43 = [*(v138 + 32) _updateLatestSummary];
      v44 = [v137 clientAssetSelector];
      v45 = [v140 summary];
      v46 = [*(v138 + 40) summary];
      *buf = 138544130;
      v149 = v43;
      v150 = 2114;
      v151 = v44;
      v152 = 2114;
      v153 = v45;
      v154 = 2114;
      v155 = v46;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleClientCurrentStatusRequest} current status request | selector:%{public}@, lastJobStatus:%{public}@, event:%{public}@", buf, 0x2Au);

      v36 = v138;
    }

    if ([*(v36 + 32) simulateOperationRequested])
    {
      v47 = v136;
      if (v136 || (v48 = *(v36 + 32), [v137 clientAssetSelector], v49 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v48, "currentJobBySelector:", v49), v47 = objc_claimAutoreleasedReturnValue(), v49, v47))
      {
        v50 = *(v36 + 32);
        v51 = [v137 clientAssetSelector];
        v52 = [v50 jobControlInformationForSelector:v51];
        [v47 clientRequestedStatus:v52];
      }
    }

    else
    {
      v47 = v136;
    }
  }

  else
  {
    v53 = *(v138 + 32);
    v54 = *(v138 + 40);
    v55 = [NSString alloc];
    v32 = v137;
    v30 = [v137 summary];
    v34 = [v55 initWithFormat:@"current status requested for unknown asset-selector (no status available for instance:%@)", v30];
    [v53 issueResponseForEventInfo:v54 withErrorCode:6301 fromAction:@"RouteClientRequest" withDescription:v34];
    v47 = v136;
  }
}

- (void)handleClientMapLockedToExclaveRequest:(id)a3 fromLocation:(id)a4
{
  v32 = a3;
  v29 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientMapLockedToExclaveRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v30 = [[NSString alloc] initWithFormat:@"%@:handleClientMapLockedToExclaveRequest", v29];
  v9 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v32];
  v31 = v9;
  if (!v9)
  {
    v27 = @"no auto-asset-instance provided in client map-locked-to-exclave request";
LABEL_19:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v32 withErrorCode:6102 fromAction:v30 withDescription:v27];
    goto LABEL_23;
  }

  v10 = [v9 clientAssetSelector];
  v11 = [v10 assetSpecifier];
  v12 = v11 == 0;

  if (v12)
  {
    v27 = @"asset-selector missing asset-specifier to be mapped";
    goto LABEL_19;
  }

  v13 = [v31 clientAssetSelector];
  v14 = [v13 assetVersion];
  v15 = v14 == 0;

  if (v15)
  {
    v27 = @"asset-selector missing asset-version to be mapped";
    goto LABEL_19;
  }

  v16 = [v31 clientAssetSelector];
  v28 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v16];
  v17 = +[MADAutoAssetLocker copyOfLocksBySelector];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v30 ofContainer:@"copyOfLocksBySelector"];
  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  v18 = v17;
  v19 = [v18 countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (v19)
  {
    v20 = *v39;
LABEL_6:
    v21 = 0;
    while (1)
    {
      if (*v39 != v20)
      {
        objc_enumerationMutation(v18);
      }

      v22 = [v18 safeObjectForKey:*(*(&v38 + 1) + 8 * v21) ofClass:objc_opt_class()];
      v23 = [v22 fullAssetSelector];
      v24 = [v23 isEqual:v16];

      if (v24)
      {
        break;
      }

      if (v19 == ++v21)
      {
        v19 = [v18 countByEnumeratingWithState:&v38 objects:v43 count:16];
        if (v19)
        {
          goto LABEL_6;
        }

        goto LABEL_12;
      }
    }

    if (![MADAutoAssetSecure doesDescriptorInvolveGrafting:v30 forDescriptor:v28])
    {
      v25 = @"asset-selector is not a cyptex file (must be a cryptex to map to exclave environment)";
      v26 = 6531;
      goto LABEL_21;
    }

    if ([v28 secureOperationInProgress])
    {
      v25 = @"secure operation already in-progress for set-descriptor - mapping blocked until current secure operation has completed";
      v26 = 6532;
      goto LABEL_21;
    }

    [v28 setSecureOperationInProgress:1];
    v33[0] = _NSConcreteStackBlock;
    v33[1] = 3221225472;
    v33[2] = __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke;
    v33[3] = &unk_4B46D0;
    v33[4] = self;
    v34 = v28;
    v35 = v16;
    v36 = v30;
    v37 = v32;
    [MADAutoAssetSecure mapToExclave:v36 forDescriptor:v34 completion:v33];
  }

  else
  {
LABEL_12:

    v25 = @"asset-selector is not currently locked (must be locked to map to exclave environment)";
    v26 = 6501;
LABEL_21:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v32 withErrorCode:v26 fromAction:v30 withDescription:v25];
  }

LABEL_23:
  os_activity_scope_leave(&state);
}

void __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke_2;
  block[3] = &unk_4B3818;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

id __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      v10 = 138543618;
      v11 = v3;
      v12 = 2114;
      v13 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-MAP][ELIMINATE] {%{public}@} | eliminate triggered while mapping-to-exclave | mapDescriptor:%{public}@", &v10, 0x16u);
    }

    return [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else
  {
    v6 = *(a1 + 40);
    if (*(a1 + 72))
    {
      v7 = *(a1 + 64);

      return [v6 issueResponseForEventInfo:v7 withAutoAssetError:? fromAction:? withDescription:?];
    }

    else
    {
      v8 = *(a1 + 32);
      v9 = *(a1 + 64);

      return [v6 lockAutoAssetReplyJobResponse:@"mapping successful" forEventInfo:v9 lockingChosenDescriptor:v8];
    }
  }
}

- (void)handleClientCancelActivityForSelectorRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientCancelActivityForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v14);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v4, v14.opaque[0], v14.opaque[1]];
  v9 = v8;
  if (!v8)
  {
    v13 = @"no auto-asset-instance provided in client cancel-activity request";
LABEL_6:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientCancelActivityForSelectorRequest" withDescription:v13];
    goto LABEL_7;
  }

  v10 = [v8 clientAssetSelector];
  v11 = [v10 assetSpecifier];

  if (!v11)
  {
    v13 = @"asset-selector missing asset-specifier when required for cancel-activity request";
    goto LABEL_6;
  }

  v12 = [v9 clientAssetSelector];
  [(MADAutoAssetControlManager *)self _eliminateBegin:v4 forAssetSelector:v12 limitingToActivity:1 fromLocation:@"handleClientCancelActivityForSelectorRequest"];

LABEL_7:
  os_activity_scope_leave(&v14);
}

- (void)handleClientEliminateAllForSelectorRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v16.opaque[0] = 0;
  v16.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminateAllForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v16);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v4, v16.opaque[0], v16.opaque[1]];
  v9 = v8;
  if (v8)
  {
    v10 = [v8 clientAssetSelector];
    v11 = [v10 assetSpecifier];
    v12 = v11 == 0;

    if (v12)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminateAllForSelectorRequest" withDescription:@"asset-selector missing asset-specifier when required for eliminate request"];
      v13 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        v15 = [v4 summary];
        *buf = 138543362;
        v18 = v15;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForSelectorRequest} asset-selector missing asset-specifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      v13 = [v9 clientAssetSelector];
      [(MADAutoAssetControlManager *)self _eliminateBegin:v4 forAssetSelector:v13 limitingToActivity:0 fromLocation:@"handleClientEliminateAllForSelectorRequest"];
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminateAllForSelectorRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    v13 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      v14 = [v4 summary];
      *buf = 138543362;
      v18 = v14;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForSelectorRequest} no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v16);
}

- (void)handleClientEliminateAllForAssetTypeRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminateAllForAssetTypeRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v14);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v4, v14.opaque[0], v14.opaque[1]];
  if (v8)
  {
    v9 = [MAAutoAssetSelector alloc];
    v10 = [v8 clientAssetSelector];
    v11 = [v10 assetType];
    v12 = [v9 initForAssetType:v11];

    [(MADAutoAssetControlManager *)self _eliminateBegin:v4 forAssetSelector:v12 limitingToActivity:0 fromLocation:@"handleClientEliminateAllForAssetTypeRequest"];
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminateAllForAssetTypeRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      v13 = [v4 summary];
      *buf = 138543362;
      v16 = v13;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForAssetTypeRequest} no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v14);
}

- (void)handleClientEliminatePromotedNeverLockedForSelectorRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v20.opaque[0] = 0;
  v20.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminatePromotedNeverLockedForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v20);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v4, v20.opaque[0], v20.opaque[1]];
  v9 = v8;
  if (v8)
  {
    v10 = [v8 clientAssetSelector];
    v11 = [v10 assetSpecifier];
    v12 = v11 == 0;

    if (v12)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"asset-selector missing asset-specifier when required for eliminate request"];
      v16 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        v19 = [v4 summary];
        *buf = 138543362;
        v22 = v19;
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] asset-selector missing asset-specifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      v13 = [v9 clientAssetSelector];
      v14 = [v13 assetVersion];
      v15 = v14 == 0;

      if (v15)
      {
        v16 = [v9 clientAssetSelector];
        [(MADAutoAssetControlManager *)self _eliminatePromotedNeverLocked:v4 forAssetSelector:v16];
      }

      else
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"asset-selector with asset-version not supported for eliminate request"];
        v16 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          v17 = [v4 summary];
          *buf = 138543362;
          v22 = v17;
          _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] asset-selector with asset-version not supported for eliminate request | eventInfo:%{public}@", buf, 0xCu);
        }
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v4 withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      v18 = [v4 summary];
      *buf = 138543362;
      v22 = v18;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v20);
}

- (void)handleControlClientControlStatisticsRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientControlStatisticsRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v12 forKey:@"control"];
  v14 = -[MADAutoAssetControlManager _statsCombinedCopy:](self, "_statsCombinedCopy:", [v13 clearingAfter]);
  v23 = v12;
  v24 = v7;
  v15 = objc_alloc_init(NSMutableDictionary);
  v16 = [MASAutoAssetControlStatistics newShimmedToFramework:v14];
  [v15 setSafeObject:v16 forKey:@"controlStatistics"];

  v17 = [SUCoreConnectMessage alloc];
  v18 = [v6 clientRequestMessage];
  v19 = [MADAutoAssetControlManager replyMessageNameForRequest:v18];
  v20 = [v6 clientRequestMessage];
  v21 = [v20 clientID];
  v22 = [v17 initWithType:2 messageName:v19 clientID:v21 version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v22 withResponseError:0 fromLocation:@"handleControlClientControlStatisticsRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientAvailableForStagingSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v17.opaque[0] = 0;
  v17.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientAvailableForStagingSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v17);

  v9 = objc_alloc_init(NSMutableArray);
  v10 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v17.opaque[0]];
  [MADAutoAssetStager extendSummaryWithAvailableForStagingAssets:v9];
  [v10 setSafeObject:v9 forKey:@"jobSummary"];
  v11 = [SUCoreConnectMessage alloc];
  v12 = [v6 clientRequestMessage];
  v13 = [MADAutoAssetControlManager replyMessageNameForRequest:v12];
  v14 = [v6 clientRequestMessage];
  v15 = [v14 clientID];
  v16 = [v11 initWithType:2 messageName:v13 clientID:v15 version:0 message:v10];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v16 withResponseError:0 fromLocation:@"handleControlClientAvailableForStagingSummaryRequest"];
  os_activity_scope_leave(&v17);
}

- (void)handleControlClientKnownAssetSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v51 = a3;
  v49 = a4;
  v52 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientKnownAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v51 clientRequestMessage];
  v50 = [v9 message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v50 forKey:@"control"];
  v11 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)v52 addActiveJobs:v11 basedOnControl:v10];
  [(MADAutoAssetControlManager *)v52 addSuccessfullyDownloadedJobs:v11 basedOnControl:v10];
  [(MADAutoAssetControlManager *)v52 ensureStagerFullyResumed];
  [MADAutoAssetStager extendSummaryWithDeterminedAssets:v11 basedOnControl:v10];
  [MADAutoAssetStager extendSummaryWithStagingAssets:v11 basedOnControl:v10];
  [MADAutoAssetStager extendSummaryWithStagedAssets:v11 basedOnControl:v10];
  [MADAutoAssetScheduler addScheduledJobs:v11 basedOnControl:v10];
  v53 = v11;
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v12 = [(MADAutoAssetControlManager *)v52 clientRequestsAwaitingSync];
  v13 = [v12 countByEnumeratingWithState:&v58 objects:v64 count:16];
  if (v13)
  {
    v14 = *v59;
    do
    {
      v15 = 0;
      do
      {
        if (*v59 != v14)
        {
          objc_enumerationMutation(v12);
        }

        v16 = *(*(&v58 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        v18 = [v16 autoAssetSelector];
        v19 = [MADAutoAssetControlManager selectorToBeIncluded:v18 basedOnControl:v10];

        if (v19)
        {
          v20 = [v16 autoAssetStatus];
          v21 = [v20 copy];

          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v21 setCurrentLockUsage:0];
          }

          v22 = [MAAutoAssetSummary alloc];
          v23 = [v16 autoAssetSelector];
          v24 = [v22 initWithAssetSelector:v23 withAssetRepresentation:200 withAssetWasPatched:0 withAssetIsStaged:0 withJobStatus:v21 withScheduledIntervalSecs:0 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

          if (v24)
          {
            [v53 addObject:v24];
          }

          else
          {
            v25 = [(MADAutoAssetControlManager *)v52 autoControlManagerFSM];
            v26 = [v25 diag];
            [v26 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleControlClientKnownAssetSummaryRequest} unable to allocate summaryEntry for clientRequestsAwaitingSync" withResult:6101 withError:0];
          }
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v13 != v15);
      v13 = [v12 countByEnumeratingWithState:&v58 objects:v64 count:16];
    }

    while (v13);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v27 = [(MADAutoAssetControlManager *)v52 clientRequestsAwaitingFirstUnlock];
  v28 = [v27 countByEnumeratingWithState:&v54 objects:v63 count:16];
  if (v28)
  {
    v29 = *v55;
    do
    {
      v30 = 0;
      do
      {
        if (*v55 != v29)
        {
          objc_enumerationMutation(v27);
        }

        v31 = *(*(&v54 + 1) + 8 * v30);
        v32 = objc_autoreleasePoolPush();
        v33 = [v31 autoAssetSelector];
        v34 = [MADAutoAssetControlManager selectorToBeIncluded:v33 basedOnControl:v10];

        if (v34)
        {
          v35 = [v31 autoAssetStatus];
          v36 = [v35 copy];

          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v36 setCurrentLockUsage:0];
          }

          v37 = [MAAutoAssetSummary alloc];
          v38 = [v31 autoAssetSelector];
          v39 = [v37 initWithAssetSelector:v38 withAssetRepresentation:201 withAssetWasPatched:0 withAssetIsStaged:0 withJobStatus:v36 withScheduledIntervalSecs:0 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

          if (v39)
          {
            [v53 addObject:v39];
          }

          else
          {
            v40 = [(MADAutoAssetControlManager *)v52 autoControlManagerFSM];
            v41 = [v40 diag];
            [v41 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleControlClientKnownAssetSummaryRequest} unable to allocate summaryEntry for clientRequestsAwaitingFirstUnlock" withResult:6101 withError:0];
          }
        }

        objc_autoreleasePoolPop(v32);
        v30 = v30 + 1;
      }

      while (v28 != v30);
      v28 = [v27 countByEnumeratingWithState:&v54 objects:v63 count:16];
    }

    while (v28);
  }

  v42 = objc_alloc_init(NSMutableDictionary);
  [v42 setSafeObject:v53 forKey:@"jobSummary"];
  v43 = [SUCoreConnectMessage alloc];
  v44 = [v51 clientRequestMessage];
  v45 = [MADAutoAssetControlManager replyMessageNameForRequest:v44];
  v46 = [v51 clientRequestMessage];
  v47 = [v46 clientID];
  v48 = [v43 initWithType:2 messageName:v45 clientID:v47 version:0 message:v42];

  [(MADAutoAssetControlManager *)v52 issueBuiltResponseForEventInfo:v51 issuingResponseMessage:v48 withResponseError:0 fromLocation:@"handleControlClientKnownAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientLockedAssetSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientLockedAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v12 forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [MADAutoAssetLocker addClientLockReasons:v14 basedOnControl:v13];
  v22 = v12;
  v23 = v7;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"lockSummary"];
  v16 = [SUCoreConnectMessage alloc];
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:v20 version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientKnownAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientStagedAssetSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientStagedAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v12 forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  [MADAutoAssetStager extendSummaryWithStagedAssets:v14 basedOnControl:v13];
  v22 = v12;
  v23 = v7;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:v20 version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientStagedAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientActiveJobSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientActiveJobSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v12 forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self addActiveJobs:v14 basedOnControl:v13];
  v22 = v12;
  v23 = v7;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:v20 version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientActiveJobSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientScheduledJobSummaryRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientScheduledJobSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v12 forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [MADAutoAssetScheduler addScheduledJobs:v14 basedOnControl:v13];
  v22 = v12;
  v23 = v7;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:v20 version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientScheduledJobSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientStagerOverviewRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v22.opaque[0] = 0;
  v22.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientStagerOverviewRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v22);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v22.opaque[0]];
  v11 = +[MADAutoAssetStager collectOverviewInformation];
  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    v13 = [v11 summary];
    *buf = 138543362;
    v24 = v13;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{handleControlClientStagerOverviewRequest} stagerInformation:%{public}@", buf, 0xCu);
  }

  v14 = objc_alloc_init(NSMutableDictionary);
  v15 = [MASAutoAssetControlStagerInformation newShimmedToFramework:v11];
  [v14 setSafeObject:v15 forKey:@"stagerInformation"];

  v16 = [SUCoreConnectMessage alloc];
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:v20 version:0 message:v14];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientStagerOverviewRequest"];
  os_activity_scope_leave(&v22);
}

- (void)forceGlobalUnlockFromLocation:(id)a3 dueToError:(id)a4 fullAssetSelector:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7
{
  v10 = a3;
  v42 = a4;
  v11 = a5;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v15 = [[NSString alloc] initWithFormat:@"%@:forceGlobalUnlockFromLocation", v10];
  v48 = 0;
  [MADAutoAssetLocker forceGlobalUnlock:v11 atomicInstancesHandle:&v48];
  v16 = v48;
  v17 = v16;
  if (v16)
  {
    v37 = v11;
    v38 = v10;
    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v36 = v16;
    v18 = v16;
    v43 = [v18 countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v43)
    {
      v19 = *v45;
      v39 = self;
      do
      {
        for (i = 0; i != v43; i = i + 1)
        {
          if (*v45 != v19)
          {
            objc_enumerationMutation(v18);
          }

          v21 = *(*(&v44 + 1) + 8 * i);
          v22 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v15 forAtomicInstanceUUID:v21 requireExists:1];
          if (v22)
          {
            v23 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v22];
            if (v23)
            {
              v24 = v23;
              [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v15 dueToError:v42 forgettingAtomicInstance:v23 historyOperationAI:a6 historyOperationSD:a7];
            }

            else
            {
              v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v27 = [v24 diag];
              v28 = objc_alloc(p_weak_ivar_lyt[226]);
              [v22 summary];
              v29 = v19;
              v30 = v18;
              v32 = v31 = p_weak_ivar_lyt;
              v33 = [v28 initWithFormat:@"{%@} unable to locate atomic-instance for set-descriptor | downloadedSetDescriptor:%@", v15, v32];
              [v27 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v33 withResult:6101 withError:0];

              p_weak_ivar_lyt = v31;
              v18 = v30;
              v19 = v29;
              self = v39;
            }
          }

          else
          {
            v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v25 = [v24 diag];
            v26 = [objc_alloc(p_weak_ivar_lyt[226]) initWithFormat:@"{%@} unable to locate set-descriptor for locked atomic-instance | setAtomicInstanceUUID:%@", v15, v21];
            [v25 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6101 withError:0];
          }
        }

        v43 = [v18 countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v43);
    }

    v11 = v37;
    v10 = v38;
    v17 = v36;
  }

  v34 = [v11 assetVersion];

  if (v34)
  {
    v35 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v11];
    if (v35)
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraft:v15 forDescriptorNoLongerLocked:v35];
    }
  }
}

- (void)forceGlobalSetUnlock:(id)a3 dueToError:(id)a4 ofSetDescriptor:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7
{
  v10 = a3;
  v36 = a4;
  v11 = a5;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v37 = v10;
  v14 = [[NSString alloc] initWithFormat:@"%@:forceGlobalSetUnlock", v10];
  v38 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v11];
  v43 = 0u;
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  v15 = [v11 latestDowloadedAtomicInstanceEntries];
  v16 = [v15 countByEnumeratingWithState:&v43 objects:v48 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v44;
    do
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v44 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = [*(*(&v43 + 1) + 8 * i) fullAssetSelector];
        [MADAutoAssetLocker forceGlobalUnlock:v20 atomicInstancesHandle:0];
      }

      v17 = [v15 countByEnumeratingWithState:&v43 objects:v48 count:16];
    }

    while (v17);
  }

  if (v38)
  {
    v21 = v36;
    [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v14 dueToError:v36 forgettingAtomicInstance:v38 historyOperationAI:a6 historyOperationSD:a7];
  }

  else
  {
    v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v23 = [v22 diag];
    v24 = [NSString alloc];
    v25 = [v11 summary];
    v26 = [v24 initWithFormat:@"{%@} unable to locate atomic-instance for set-descriptor | setDescriptor:%@", v14, v25];
    [v23 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6101 withError:0];

    v21 = v36;
  }

  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  v27 = [v11 latestDowloadedAtomicInstanceEntries];
  v28 = [v27 countByEnumeratingWithState:&v39 objects:v47 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v40;
    do
    {
      for (j = 0; j != v29; j = j + 1)
      {
        if (*v40 != v30)
        {
          objc_enumerationMutation(v27);
        }

        v32 = [*(*(&v39 + 1) + 8 * j) fullAssetSelector];
        v33 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v32];

        [(MADAutoAssetControlManager *)self secureCheckUngraft:v14 forDescriptorNoLongerLocked:v33];
      }

      v29 = [v27 countByEnumeratingWithState:&v39 objects:v47 count:16];
    }

    while (v29);
  }
}

- (void)handleControlClientForceGlobalUnlockRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v21.opaque[0] = 0;
  v21.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalUnlockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v21);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v6, v21.opaque[0], v21.opaque[1]];
  v12 = [v11 clientAssetSelector];
  v13 = v12;
  if (!v12)
  {
    v20 = @"no clientAssetSelector in request";
LABEL_6:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v20];
    goto LABEL_7;
  }

  v14 = [v12 assetType];

  if (!v14)
  {
    v20 = @"clientAssetSelector is missing assetType";
    goto LABEL_6;
  }

  [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:@"handleControlClientForceGlobalUnlockRequest" dueToError:0 fullAssetSelector:v13 historyOperationAI:342 historyOperationSD:386];
  v15 = [v6 clientRequestMessage];
  v16 = [MADAutoAssetControlManager replyMessageNameForRequest:v15];
  v17 = [v6 clientRequestMessage];
  v18 = [v17 clientID];
  v19 = [MADAutoAssetControlManager createSeverMessageWithName:v16 sender:@"com.apple.MAAutoControl" clientID:v18 response:0 error:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleControlClientForceGlobalUnlockRequest"];
LABEL_7:

  os_activity_scope_leave(&v21);
}

- (void)handleControlClientForceGlobalForgetRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalForgetRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v6];
  v12 = [v11 clientAssetSelector];
  v13 = v12;
  if (!v12)
  {
    v22 = @"no clientAssetSelector in request";
LABEL_8:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v22];
    goto LABEL_9;
  }

  v14 = [v12 assetType];

  if (!v14)
  {
    v22 = @"clientAssetSelector is missing assetType";
    goto LABEL_8;
  }

  v15 = [v13 persistedEntryID];
  [MADAutoAssetScheduler forceGlobalForget:v13];
  if (v15)
  {
    v16 = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
    [v16 removeObjectForKey:v15];
  }

  v23 = v7;
  v17 = [v6 clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:v17];
  v19 = [v6 clientRequestMessage];
  v20 = [v19 clientID];
  v21 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:v20 response:0 error:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientForceGlobalForgetRequest"];
  v7 = v23;
LABEL_9:

  os_activity_scope_leave(&state);
}

- (void)handleControlClientForceGlobalPurgeRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v40 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalPurgeRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v6];
  v11 = [v10 clientAssetSelector];
  v12 = v11;
  if (v11)
  {
    v13 = [v11 assetType];

    if (v13)
    {
      v14 = [v12 assetType];
      v15 = getAutoLocalUrlFromTypeWithPurpose(v14, 2, @"auto");

      v37 = v15;
      v39 = [v15 path];
      v38 = +[NSFileManager defaultManager];
      if (!v39)
      {
        v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v25 = [v24 diag];
        v26 = [NSString alloc];
        v27 = [v12 summary];
        v28 = [v26 initWithFormat:@"{handleControlClientForceGlobalPurgeRequest} unable to determine local repository path for selector:%@", v27];
        [v25 trackAnomaly:@"AUTO-CONTROL" forReason:v28 withResult:6101 withError:0];

        v29 = [NSString alloc];
        v16 = [v12 summary];
        v18 = [v29 initWithFormat:@"unable to determine local repository path for selector:%@", v16];
        v22 = [MAAutoAssetError buildError:6107 fromOperation:@"handleControlClientForceGlobalPurgeRequest" underlyingError:0 withDescription:v18];
LABEL_17:

        v32 = [v6 clientRequestMessage];
        v33 = [MADAutoAssetControlManager replyMessageNameForRequest:v32];
        v34 = [v6 clientRequestMessage];
        v35 = [v34 clientID];
        v36 = [MADAutoAssetControlManager createSeverMessageWithName:v33 sender:@"com.apple.MAAutoControl" clientID:v35 response:0 error:v22];

        [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v36 withResponseError:v22 fromLocation:@"handleControlClientForceGlobalPurgeRequest"];
        goto LABEL_18;
      }

      v16 = [[NSURL alloc] initFileURLWithPath:v39];
      if ([v38 fileExistsAtPath:v39])
      {
        v17 = getControlManager();
        v18 = [v17 getSAFRegistrationBundleID:v16];

        v41 = 0;
        renameWithExtThenRemoveExposeError(v39, @".purged", &v41);
        v19 = v41;
        if (v19)
        {
          v20 = v19;
          v21 = [[NSString alloc] initWithFormat:@"error while attempting to remove auto-asset repository directory:%@", v39];
          v22 = [MAAutoAssetError buildError:6107 fromOperation:@"handleControlClientForceGlobalPurgeRequest" underlyingError:v20 withDescription:v21];
LABEL_16:

          goto LABEL_17;
        }
      }

      else
      {
        v18 = 0;
      }

      v30 = getControlManager();
      [v30 updateSpaceAttributionForBundleID:v18 assetPath:v16 doRegistration:0];

      v31 = [v10 autoAssetClientName];
      if (v31)
      {
        [v10 autoAssetClientName];
      }

      else
      {
        [v10 clientProcessName];
      }
      v21 = ;

      v20 = [v12 assetType];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:v20 firstClientName:v21];
      v22 = 0;
      goto LABEL_16;
    }

    v23 = @"clientAssetSelector is missing assetType";
  }

  else
  {
    v23 = @"no clientAssetSelector in request";
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v23];
LABEL_18:

  os_activity_scope_leave(&state);
}

- (void)handleControlClientForceGlobalAbandonRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v18.opaque[0] = 0;
  v18.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalAbandonRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v18);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v6, v18.opaque[0], v18.opaque[1]];
  v12 = [v11 clientAssetSelector];
  v13 = v12;
  if (!v12)
  {
    v17 = @"no clientAssetSelector in request";
LABEL_6:
    v16 = 6102;
    goto LABEL_7;
  }

  v14 = [v12 assetType];

  if (!v14)
  {
    v17 = @"clientAssetSelector is missing assetType";
    goto LABEL_6;
  }

  v15 = [v13 assetType];
  [(MADAutoAssetControlManager *)self _removeFromPersistedActiveJobs:v15];

  v16 = 0;
  v17 = @"active jobs for provided asset-type have been removed from tracking (auto-asset-jobs may remain)";
LABEL_7:
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:v16 fromAction:@"RouteClientRequest" withDescription:v17];

  os_activity_scope_leave(&v18);
}

- (void)handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v8 = [v4 clientRequestMessage];
  v9 = [v8 message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v9 forKey:@"control"];
  v11 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    v12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v13 = [v10 cacheDeleteUrgency];
    v14 = [v10 volumeToReclaim];
    if (v14)
    {
      v15 = [v10 volumeToReclaim];
    }

    else
    {
      v15 = @"N";
    }

    *buf = 138543874;
    v25 = v12;
    v26 = 1024;
    v27 = v13;
    v28 = 2114;
    v29 = v15;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest} simulating trigger from cache-delete to determine reclaimable space | urgency:%d, volume:%{public}@ | respondToCacheDelete...", buf, 0x1Cu);
    if (v14)
    {
    }
  }

  v16 = [(MADAutoAssetControlManager *)self sharedDispatchQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke;
  block[3] = &unk_4B2AF0;
  v20 = v10;
  v21 = self;
  v22 = v4;
  v17 = v4;
  v18 = v10;
  dispatch_async(v16, block);

  os_activity_scope_leave(&state);
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke(uint64_t a1)
{
  v2 = getControlManager();
  v3 = objc_alloc_init(MADAnalyticsCacheDeleteResults);
  v4 = [*(a1 + 32) cacheDeleteUrgency];
  v5 = [*(a1 + 32) volumeToReclaim];
  v8[0] = _NSConcreteStackBlock;
  v8[1] = 3221225472;
  v8[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_2;
  v8[3] = &unk_4B4720;
  v7 = *(a1 + 32);
  v6 = v7.i64[0];
  v9 = vextq_s8(v7, v7, 8uLL);
  v10 = *(a1 + 48);
  [v2 respondToCacheDelete:0 targetingPurgeAmount:0 cacheDeleteResults:v3 withUrgency:v4 forVolume:v5 then:v8];
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_2(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  v7[0] = _NSConcreteStackBlock;
  v7[1] = 3221225472;
  v7[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_3;
  v7[3] = &unk_4B46F8;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  dispatch_async(v5, v7);
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_3(uint64_t a1)
{
  v2 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [*(a1 + 32) _updateLatestSummary];
    v4 = [*(a1 + 40) cacheDeleteUrgency];
    v5 = [*(a1 + 40) volumeToReclaim];
    if (v5)
    {
      v6 = [*(a1 + 40) volumeToReclaim];
    }

    else
    {
      v6 = @"N";
    }

    v7 = allocStringForBytes(*(a1 + 56));
    v19 = 138544130;
    v20 = v3;
    v21 = 1024;
    v22 = v4;
    v23 = 2114;
    v24 = v6;
    v25 = 2114;
    v26 = v7;
    _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest} simulating trigger from cache-delete to determine reclaimable space | urgency:%d, volume:%{public}@ | reclaimableSpace:%{public}@ | ...respondToCacheDelete", &v19, 0x26u);
    if (v5)
    {
    }
  }

  v8 = objc_alloc_init(NSMutableDictionary);
  v9 = [MANAutoAssetInfoControl alloc];
  v10 = [*(a1 + 40) volumeToReclaim];
  v11 = -[MANAutoAssetInfoControl initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:](v9, "initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:", v10, [*(a1 + 40) cacheDeleteUrgency], *(a1 + 56));

  v12 = [MASAutoAssetInfoControl newShimmedToFramework:v11];
  [v8 setSafeObject:v12 forKey:@"control"];

  v13 = [SUCoreConnectMessage alloc];
  v14 = [*(a1 + 48) clientRequestMessage];
  v15 = [MADAutoAssetControlManager replyMessageNameForRequest:v14];
  v16 = [*(a1 + 48) clientRequestMessage];
  v17 = [v16 clientID];
  v18 = [v13 initWithType:2 messageName:v15 clientID:v17 version:0 message:v8];

  [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 48) issuingResponseMessage:v18 withResponseError:0 fromLocation:@"handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest"];
}

- (void)handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulatedCacheDeleteReclaimSpaceRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v8 = [v4 clientRequestMessage];
  v9 = [v8 message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v9 forKey:@"control"];
  v11 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    v12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v13 = [v10 cacheDeleteUrgency];
    v14 = [v10 volumeToReclaim];
    if (v14)
    {
      v15 = [v10 volumeToReclaim];
    }

    else
    {
      v15 = @"N";
    }

    v16 = allocStringForBytes([v10 targetingPurgeAmount]);
    *buf = 138544130;
    v26 = v12;
    v27 = 1024;
    v28 = v13;
    v29 = 2114;
    v30 = v15;
    v31 = 2114;
    v32 = v16;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteReclaimSpaceRequest} simulating trigger from cache-delete to reclaim space | urgency:%d, volume:%{public}@, targetingPurgeAmount:%{public}@ | respondToCacheDelete...", buf, 0x26u);
    if (v14)
    {
    }
  }

  v17 = [(MADAutoAssetControlManager *)self sharedDispatchQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke;
  block[3] = &unk_4B2AF0;
  v21 = v10;
  v22 = self;
  v23 = v4;
  v18 = v4;
  v19 = v10;
  dispatch_async(v17, block);

  os_activity_scope_leave(&state);
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke(uint64_t a1)
{
  v2 = getControlManager();
  v3 = [*(a1 + 32) targetingPurgeAmount];
  v4 = objc_alloc_init(MADAnalyticsCacheDeleteResults);
  v5 = [*(a1 + 32) cacheDeleteUrgency];
  v6 = [*(a1 + 32) volumeToReclaim];
  v9[0] = _NSConcreteStackBlock;
  v9[1] = 3221225472;
  v9[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_2;
  v9[3] = &unk_4B4720;
  v8 = *(a1 + 32);
  v7 = v8.i64[0];
  v10 = vextq_s8(v8, v8, 8uLL);
  v11 = *(a1 + 48);
  [v2 respondToCacheDelete:1 targetingPurgeAmount:v3 cacheDeleteResults:v4 withUrgency:v5 forVolume:v6 then:v9];
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_2(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  v7[0] = _NSConcreteStackBlock;
  v7[1] = 3221225472;
  v7[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_3;
  v7[3] = &unk_4B46F8;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  dispatch_async(v5, v7);
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_3(uint64_t a1)
{
  v2 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [*(a1 + 32) _updateLatestSummary];
    v4 = [*(a1 + 40) cacheDeleteUrgency];
    v5 = [*(a1 + 40) volumeToReclaim];
    if (v5)
    {
      v6 = [*(a1 + 40) volumeToReclaim];
    }

    else
    {
      v6 = @"N";
    }

    v7 = allocStringForBytes([*(a1 + 40) targetingPurgeAmount]);
    v8 = allocStringForBytes(*(a1 + 56));
    v20 = 138544386;
    v21 = v3;
    v22 = 1024;
    v23 = v4;
    v24 = 2114;
    v25 = v6;
    v26 = 2114;
    v27 = v7;
    v28 = 2114;
    v29 = v8;
    _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteReclaimSpaceRequest} simulating trigger from cache-delete to reclaim space | urgency:%d, volume:%{public}@, targetingPurgeAmount:%{public}@ | reclaimedSpace:%{public}@ | ...respondToCacheDelete", &v20, 0x30u);
    if (v5)
    {
    }
  }

  v9 = objc_alloc_init(NSMutableDictionary);
  v10 = [MANAutoAssetInfoControl alloc];
  v11 = [*(a1 + 40) volumeToReclaim];
  v12 = -[MANAutoAssetInfoControl initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:](v10, "initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:", v11, [*(a1 + 40) cacheDeleteUrgency], *(a1 + 56));

  v13 = [MASAutoAssetInfoControl newShimmedToFramework:v12];
  [v9 setSafeObject:v13 forKey:@"control"];

  v14 = [SUCoreConnectMessage alloc];
  v15 = [*(a1 + 48) clientRequestMessage];
  v16 = [MADAutoAssetControlManager replyMessageNameForRequest:v15];
  v17 = [*(a1 + 48) clientRequestMessage];
  v18 = [v17 clientID];
  v19 = [v14 initWithType:2 messageName:v16 clientID:v18 version:0 message:v9];

  [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 48) issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleControlClientSimulatedCacheDeleteReclaimSpaceRequest"];
}

- (void)handleControlClientSimulateSetJobOperation:(id)a3
{
  v86 = a3;
  v84 = self;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulateSetJobOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &state);

  v85 = [(MADAutoAssetControlManager *)v84 clientRequestMessageInstance:v86];
  v7 = [v86 clientRequestMessage];
  v82 = [v7 message];

  v8 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v82 forKey:@"control"];
  v9 = v8;
  if (v85)
  {
    if (v8)
    {
      v81 = v8;
      v10 = [v8 simulateOperation];
      v79 = [v81 simulateOperation];
      v11 = [v81 simulateOperation];
      v12 = [MADMarker alloc];
      v13 = [v85 clientAssetSelector];
      v14 = [v13 assetType];
      v15 = [v85 clientAssetSelector];
      if (v11 == &dword_8 + 2)
      {
        v16 = [v15 assetType];
        v17 = [v85 clientAssetSelector];
        v18 = [v17 assetSpecifier];
        v19 = [v85 clientAssetSelector];
        v83 = [(MADMarker *)v12 initForAssetType:v14 forClientDomainName:v16 forAssetSetIdentifier:v18 forAssetSelector:v19 forSetJob:1 withSetPolicy:0 withPushedPolicy:0];
      }

      else
      {
        v83 = [(MADMarker *)v12 initForAssetType:v14 forClientDomainName:0 forAssetSetIdentifier:0 forAssetSelector:v15 forSetJob:0 withSetPolicy:0 withPushedPolicy:0];
      }

      if (v10 == &dword_4 + 3)
      {
        [MADAutoAssetConnector simulateNetworkPathUp:v83];
LABEL_30:
        v21 = objc_alloc_init(NSMutableDictionary);
        v63 = [SUCoreConnectMessage alloc];
        v64 = [v86 clientRequestMessage];
        v65 = [MADAutoAssetControlManager replyMessageNameForRequest:v64];
        v66 = [v86 clientRequestMessage];
        v67 = [v66 clientID];
        v68 = [v63 initWithType:2 messageName:v65 clientID:v67 version:0 message:v21];

        [(MADAutoAssetControlManager *)v84 issueBuiltResponseForEventInfo:v86 issuingResponseMessage:v68 withResponseError:0 fromLocation:@"handleControlClientSimulateSetJobOperation"];
        v9 = v81;
        goto LABEL_31;
      }

      if (v79 == &dword_8)
      {
        [MADAutoAssetConnector simulateNetworkPathDown:v83];
        goto LABEL_30;
      }

      if (v11 == &dword_8 + 2)
      {
        v23 = [v85 clientAssetSelector];
        v24 = [v23 assetType];
        v25 = [v85 clientAssetSelector];
        v26 = [v25 assetSpecifier];
        v27 = [(MADAutoAssetControlManager *)v84 newSetEntryIDForClientDomain:v24 forAssetSetIdentifier:v26];

        v28 = [(MADAutoAssetControlManager *)v84 currentSetJobsByIdentifier];
        v29 = [v28 safeObjectForKey:v27 ofClass:objc_opt_class()];

        v30 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
        {
          v31 = [(MADAutoAssetControlManager *)v84 _updateLatestSummary];
          v32 = [v83 summary];
          v33 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v34 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544130;
          v89 = v31;
          v90 = 2114;
          v91 = v32;
          v92 = 2114;
          v93 = v33;
          v94 = 2114;
          v95 = v34;
          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | setting set-job simulate operation | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x2Au);
        }

        [(MADAutoAssetControlManager *)v84 setSimulateOperationRequested:1];
        v35 = [(MADAutoAssetControlManager *)v84 simulateOperationsBySetJobKey];
        [v35 setSafeObject:v81 forKey:v27];

        if (v29)
        {
          [v29 handleSimulateOperation:v81];
        }

        goto LABEL_29;
      }

      v36 = [v83 assetSelector];
      v27 = [(MADAutoAssetControlManager *)v84 currentJobBySelector:v36];

      v37 = [v85 clientAssetSelector];
      v38 = [v37 assetType];
      v39 = [v85 clientAssetSelector];
      v40 = [v39 assetSpecifier];
      v29 = [(MADAutoAssetControlManager *)v84 newSetEntryIDForClientDomain:v38 forAssetSetIdentifier:v40];

      v41 = [(MADAutoAssetControlManager *)v84 currentSetJobsByIdentifier];
      v80 = [v41 safeObjectForKey:v29 ofClass:objc_opt_class()];

      v42 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
      {
        v43 = [(MADAutoAssetControlManager *)v84 _updateLatestSummary];
        v44 = [v83 summary];
        v45 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
        v46 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
        *buf = 138544130;
        v89 = v43;
        v90 = 2114;
        v91 = v44;
        v92 = 2114;
        v93 = v45;
        v94 = 2114;
        v95 = v46;
        _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | setting set-job simulate operation | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x2Au);
      }

      [(MADAutoAssetControlManager *)v84 setSimulateOperationRequested:1];
      v47 = [(MADAutoAssetControlManager *)v84 simulateOperationsBySelector];
      v48 = [v83 assetSelector];
      v49 = [v48 persistedEntryID];
      [v47 setSafeObject:v81 forKey:v49];

      v50 = [(MADAutoAssetControlManager *)v84 simulateOperationsBySetJobKey];
      [v50 setSafeObject:v81 forKey:v29];

      if (v27)
      {
        v51 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          v52 = [(MADAutoAssetControlManager *)v84 _updateLatestSummary];
          v53 = [v27 summary];
          v54 = [v83 summary];
          v55 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v56 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544386;
          v89 = v52;
          v90 = 2114;
          v91 = v53;
          v92 = 2114;
          v93 = v54;
          v94 = 2114;
          v95 = v55;
          v96 = 2114;
          v97 = v56;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to job | autoJobBySelector:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
        }

        v57 = v27;
      }

      else
      {
        if (!v80)
        {
          if ([v81 simulateOperation] == &dword_8 + 3)
          {
            v69 = [(MADAutoAssetControlManager *)v84 stagerCurrentJob];
            v70 = v69 == 0;

            if (!v70)
            {
              v71 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT))
              {
                v72 = [(MADAutoAssetControlManager *)v84 _updateLatestSummary];
                v78 = [(MADAutoAssetControlManager *)v84 stagerCurrentJob];
                v73 = [v78 summary];
                v74 = [v83 summary];
                v75 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
                v76 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
                *buf = 138544386;
                v89 = v72;
                v90 = 2114;
                v91 = v73;
                v92 = 2114;
                v93 = v74;
                v94 = 2114;
                v95 = v75;
                v96 = 2114;
                v97 = v76;
                _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to stager-job | stagerCurrentJob:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
              }

              v77 = [(MADAutoAssetControlManager *)v84 stagerCurrentJob];
              [v77 handleSimulateOperation:v81];
            }
          }

          goto LABEL_28;
        }

        v51 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          v58 = [(MADAutoAssetControlManager *)v84 _updateLatestSummary];
          v59 = [v80 summary];
          v60 = [v83 summary];
          v61 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v62 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544386;
          v89 = v58;
          v90 = 2114;
          v91 = v59;
          v92 = 2114;
          v93 = v60;
          v94 = 2114;
          v95 = v61;
          v96 = 2114;
          v97 = v62;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to job | autoJobByIdentifier:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
        }

        v57 = v80;
      }

      [v57 handleSimulateOperation:v81];
LABEL_28:

LABEL_29:
      goto LABEL_30;
    }

    v22 = [NSString alloc];
    v83 = [v86 summary];
    v21 = [v22 initWithFormat:@"SIMULATE | invalid eventInfo (control:MISSING) | eventInfo:%@", v83];
    [(MADAutoAssetControlManager *)v84 issueResponseForEventInfo:v86 withErrorCode:6102 fromAction:@"handleControlClientSimulateSetJobOperation" withDescription:v21];
  }

  else
  {
    v20 = [NSString alloc];
    v83 = [v86 summary];
    v21 = [v20 initWithFormat:@"SIMULATE | invalid eventInfo (instance:MISSING) | eventInfo:%@", v83];
    [(MADAutoAssetControlManager *)v84 issueResponseForEventInfo:v86 withErrorCode:6102 fromAction:@"handleControlClientSimulateSetJobOperation" withDescription:v21];
  }

LABEL_31:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientNeedForAtomicRequest:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientNeedForAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequest];
  v12 = [v11 clientRequestMessage];
  v13 = [v12 messageName];

  v14 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v7 withEventInfo:v6];
  v15 = [NSString stringWithFormat:@"%@:handleSetClientNeedForAtomicRequest", v7];
  if (v14)
  {
    v16 = [v14 atomicInstance];
    v17 = v16 == 0;

    if (!v17)
    {
      v18 = [[NSString alloc] initWithFormat:@"atomicInstance specified when not valid for messageName:%@", v13];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6108 fromAction:v15 withDescription:v18];
LABEL_37:

      goto LABEL_38;
    }

    v55 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:v14];
    v19 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    v56 = [v19 safeObjectForKey:v55 ofClass:objc_opt_class()];

    if (v56)
    {
      if ([v56 inhibitImpliedScheduling])
      {
LABEL_36:
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:0 fromAction:v15 withDescription:@"successful need-for-atomic (no immediate set-job required)"];

        v18 = v55;
        goto LABEL_37;
      }

      v20 = [v6 clientRequest];
      v54 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v20];

      v21 = [v54 clientAssetSetPolicy];
      v22 = [v21 blockCheckDownload];

      if (v22)
      {
        v23 = 1;
      }

      else
      {
        v23 = [v14 autoAssetEntries];
        if (v23)
        {
          v26 = [v14 autoAssetEntries];
          v27 = [v26 count];
          v28 = v26;
          v29 = v23;
          v23 = v27 == 0;
        }

        else
        {
          v29 = 0;
        }
      }

      if (v23 != [v56 inhibitImpliedScheduling])
      {
        v30 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v52 = [v30 persistedEntry:v55 fromLocation:v7];

        if (v52)
        {
          [v56 setInhibitImpliedScheduling:v23];
          [v52 persistSecureCodedObject:v56 forKey:@"setConfiguration"];
          v31 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v32 = [v56 summary];
          [v31 storePersistedEntry:v55 withEntrySummary:v32 fromLocation:v15];

          v33 = [NSString alloc];
          v34 = [v56 summary];
          v35 = [v33 initWithFormat:@"modified inhibitImpliedScheduling | setConfiguration:%@", v34];
          [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:v15 operation:@"ENTRY_MODIFY" forPersistedEntryID:v55 withSetConfiguration:v56 historyOperation:443 message:v35];

          v36 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
          [v36 setSafeObject:v56 forKey:v55];
        }

        else
        {
          v37 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
          {
            v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v39 = [v6 summary];
            *buf = 138543874;
            v59 = v38;
            v60 = 2114;
            v61 = v15;
            v62 = 2114;
            v50 = v39;
            v63 = v39;
            _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to load persisted-set-configuration file | set-eventInfo:%{public}@", buf, 0x20u);
          }

          v40 = [NSString alloc];
          v36 = [v6 summary];
          v41 = [v40 initWithFormat:@"unable to load persisted-set-configuration file | set-eventInfo:%@", v36];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6101 fromAction:v15 withDescription:v41];
        }
      }

      if ([v56 everProvidedLatestToVend])
      {
LABEL_35:

        goto LABEL_36;
      }

      v42 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543362;
        v59 = v15;
        _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "{%{public}@} Received need for atomic request where latest-to-vend has never been set. Attempting to set latest-to-vend via preinstalled assets.", buf, 0xCu);
      }

      v53 = [v14 clientDomainName];
      v51 = [v14 autoAssetSetClientName];
      v43 = [v14 assetSetIdentifier];
      v44 = [v56 firstEntryAssetType];
      v25 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:v15 forClientDomainName:v53 forSetClientName:v51 forAssetSetIdentifier:v43 forAssetType:v44];

      if (v25)
      {
        v45 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          v59 = v15;
          _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "{%{public}@} Created valid set descriptor from preinstalled set, will adopt as latest to vend.", buf, 0xCu);
        }

        v46 = [v25 latestDownloadedAtomicInstance];
        v47 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v46];

        if (v47 && ![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v15 fromSetDescriptor:v25 toSetConfiguration:v56 fromPreSUStaging:0 allowEmpty:0]&& [MADAutoAssetSecure isPersonalizationRequired:v15 forSetDescriptor:v25])
        {
          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543362;
            v59 = v15;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "{%{public}@} Personalization is required to adopt set descriptor.", buf, 0xCu);
          }

          v49 = [v47 atomicInstanceUUID];
          [v56 setNewerAtomicInstanceOncePersonalized:v49];

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v56 fromLocation:v15 forReason:@"pre-installed is available as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
        }
      }
    }

    else
    {
      v24 = [NSString alloc];
      v54 = [v6 summary];
      v25 = [v24 initWithFormat:@"invalid set-configuration (no set-configuration found) | set-eventInfo:%@", v54];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6554 fromAction:v15 withDescription:v25];
    }

    goto LABEL_35;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:v15 withDescription:@"no auto-asset-set-instance provided in client request"];
LABEL_38:

  os_activity_scope_leave(&state);
}

- (BOOL)handleClientPotentialSetJob:(id)a3 forAutoJob:(id)a4 fromLocation:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleClientPotentialSetJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  v14 = [v8 clientRequest];
  v15 = [v14 clientRequestMessage];
  v16 = [v15 messageName];

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v10 withEventInfo:v8];
  if (v17)
  {
    v18 = [v8 clientRequest];
    v19 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v18];

    if (v19)
    {
      if ([SUCore stringIsEqual:v16 to:@"MA-AUTO-SET:CHECK_ATOMIC"])
      {
        v20 = [(MADAutoAssetControlManager *)self handleSetClientCheckAtomic:v8 forAutoJob:v9 instance:v17 desire:v19 fromLocation:v10];
LABEL_9:
        v21 = v20;
LABEL_12:

        goto LABEL_13;
      }

      if ([SUCore stringIsEqual:v16 to:@"MA-AUTO-SET:LOCK_ATOMIC"])
      {
        v20 = [(MADAutoAssetControlManager *)self handleSetClientLockAtomic:v8 forAutoJob:v9 instance:v17 desire:v19 fromLocation:v10];
        goto LABEL_9;
      }

      v22 = [[NSString alloc] initWithFormat:@"unexpected messageName:%@", v16];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6108 fromAction:@"handleClientPotentialSetJob" withDescription:v22];
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6102 fromAction:@"handleClientPotentialSetJob" withDescription:@"no auto-asset-set-desire provided in client request"];
    }

    v21 = 0;
    goto LABEL_12;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6102 fromAction:v10 withDescription:@"no auto-asset-set-instance provided in client request"];
  v21 = 0;
LABEL_13:

  os_activity_scope_leave(&state);
  return v21;
}

- (BOOL)handleSetClientCheckAtomic:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7
{
  v72 = a3;
  v67 = a4;
  v12 = a5;
  v71 = a6;
  v70 = a7;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v15 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientCheckAtomic", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v15, &state);

  v16 = [[NSString alloc] initWithFormat:@"%@:handleSetClientCheckAtomic", v70];
  v68 = [v72 clientRequest];
  v17 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  v18 = [v12 clientDomainName];
  v19 = [v12 assetSetIdentifier];
  v69 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v18 forAssetSetIdentifier:v19];

  v20 = [v71 checkWaitTimeoutSecs];
  if (v20)
  {
    goto LABEL_49;
  }

  v65 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if (!v17)
  {
    if (!v69)
    {
      [v65 appendString:@"ERROR(no set-configuration)|"];
      v21 = @"checkAtomic (NO_WAIT) unable to load set-configuration";
      goto LABEL_45;
    }

    v22 = [v12 atomicInstance];
    v23 = v22 == 0;

    if (!v23)
    {
      v24 = [v12 atomicInstance];
      v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:v24 requireExists:0];

      if (!v66)
      {
        [v65 appendString:@"ERROR(no downloaded atomic-instance [later])|"];
        v21 = @"checkAtomic (NO_WAIT) requested when no already downloaded asset-version available";
        goto LABEL_45;
      }

      v25 = [v66 clientDomainName];
      v26 = [v12 clientDomainName];
      if (([SUCore stringIsEqual:v25 to:v26]& 1) != 0)
      {
        v27 = [v66 assetSetIdentifier];
        v28 = [v12 assetSetIdentifier];
        v29 = [SUCore stringIsEqual:v27 to:v28];

        if (v29)
        {
          LOBYTE(v30) = 0;
          goto LABEL_23;
        }
      }

      else
      {
      }

      [v65 appendString:@"ERROR(specific atomic-instance not downloaded)|"];

      v21 = @"checkAtomic (NO_WAIT) requested specific atomic-instance not valid for given set-identifier";
      goto LABEL_45;
    }

    v31 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
    {
      v32 = [v69 summary];
      *buf = 138543618;
      v88 = v16;
      v89 = 2114;
      v90 = v32;
      _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{%{public}@} determining atomic-instance to use for checkAtomic (NO_WAIT) | setConfiguration:%{public}@", buf, 0x16u);
    }

    v33 = [v69 latestAtomicInstanceToVend];
    v30 = v33 != 0;

    if (!v30 || ([v65 appendString:@"using latestToVend|"], objc_msgSend(v69, "latestAtomicInstanceToVend"), v34 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetDescriptor:forAtomicInstanceUUID:requireExists:](self, "locateSetDescriptor:forAtomicInstanceUUID:requireExists:", v16, v34, 1), v66 = objc_claimAutoreleasedReturnValue(), v34, !v66))
    {
      v35 = [v69 newerAtomicInstanceOncePersonalized];
      v36 = v35 == 0;

      if (!v36)
      {
        [v65 appendString:@"using newer-once-personalized|"];
        v37 = [v69 newerAtomicInstanceOncePersonalized];
        v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:v37 requireExists:1];

        if (v66)
        {
          goto LABEL_23;
        }
      }

      if (([v69 everProvidedLatestToVend] & 1) == 0)
      {
        v38 = [v69 clientDomainName];
        v39 = [v12 autoAssetSetClientName];
        v40 = [v69 assetSetIdentifier];
        v41 = [v69 firstEntryAssetType];
        v66 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:v16 forClientDomainName:v38 forSetClientName:v39 forAssetSetIdentifier:v40 forAssetType:v41];

        if (v66)
        {
          v42 = [v66 latestDownloadedAtomicInstance];
          v43 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v42];

          if (v43)
          {
            [v65 appendString:@"using pre-installed|"];

            goto LABEL_23;
          }

          v55 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v56 = [v55 diag];
          v57 = [NSString alloc];
          v58 = [v66 summary];
          v59 = [v57 initWithFormat:@"{%@} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", v16, v58];
          [v56 trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v59 withResult:6103 withError:0];
        }
      }

      [v65 appendString:@"ERROR(no downloaded atomic-instance)|"];
      v21 = @"checkAtomic (NO_WAIT) requested when no latest atomic-instance to vend and no newer-once-personalized";
      goto LABEL_45;
    }

    LOBYTE(v30) = 1;
LABEL_23:
    v85 = 0;
    v44 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:v72 fromLocation:v16 errorString:&v85];
    v64 = v85;
    if (v64)
    {
      [v65 appendString:@"ERROR(failed to schedule)|"];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v72 withErrorCode:v44 fromAction:v16 withDescription:v64];
    }

    else if ([(MADAutoAssetControlManager *)self _doesSetDescriptorRequirePersonalization:v16 forSetDescriptor:v66])
    {
      [v65 appendString:@"awaiting secure|"];
      v83 = 0u;
      v84 = 0u;
      v81 = 0u;
      v82 = 0u;
      v45 = [v66 latestDowloadedAtomicInstanceEntries];
      v46 = [v45 countByEnumeratingWithState:&v81 objects:v93 count:16];
      if (v46)
      {
        v47 = *v82;
        do
        {
          for (i = 0; i != v46; i = i + 1)
          {
            if (*v82 != v47)
            {
              objc_enumerationMutation(v45);
            }

            v49 = [*(*(&v81 + 1) + 8 * i) fullAssetSelector];
            v50 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v49];

            if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v16 forDescriptor:v50]&& [MADAutoAssetSecure isPersonalizationRequired:v16 forDescriptor:v50])
            {
              [v50 setSecureOperationInProgress:1];
              [v66 setSecureOperationInProgress:1];
            }
          }

          v46 = [v45 countByEnumeratingWithState:&v81 objects:v93 count:16];
        }

        while (v46);
      }

      v51 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v66];
      v73[0] = _NSConcreteStackBlock;
      v73[1] = 3221225472;
      v73[2] = __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke;
      v73[3] = &unk_4B4770;
      v73[4] = self;
      v74 = v66;
      v75 = v16;
      v76 = v12;
      v77 = v69;
      v78 = v68;
      v79 = v71;
      v80 = v72;
      [MADAutoAssetSecure personalizeSetDownloaded:v75 forSetDescriptor:v74 allowingNetwork:1 withAutoAssetDescriptors:v51 completion:v73];
    }

    else
    {
      if (!v30)
      {
        [v65 appendString:@"now latest-to-vend|"];
        [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v16 fromSetDescriptor:v66 toSetConfiguration:v69 fromPreSUStaging:0 allowEmpty:0];
      }

      v52 = [(MADAutoAssetControlManager *)self newSetDescriptorLimitedToCheckInformation:v66];
      v53 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"checkAtomic" forClientRequest:v68 withFoundSetDescriptor:v52 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v12 withDesire:v71 fromLocation:v16];
      [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v68 issuingResponseMessage:v53 withResponseError:0];
    }

    v54 = v66;
    goto LABEL_46;
  }

  [v65 appendString:@"ERROR(before first-unlock)|"];
  v21 = @"checkAtomic (NO_WAIT) requested when device before first-unlock";
LABEL_45:
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v72 withErrorCode:6251 fromAction:v16 withDescription:v21];
  v54 = 0;
LABEL_46:
  v60 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v60, OS_LOG_TYPE_DEFAULT))
  {
    v61 = [v69 summary];
    *buf = 138543874;
    v88 = v16;
    v89 = 2114;
    v90 = v65;
    v91 = 2114;
    v92 = v61;
    _os_log_impl(&dword_0, v60, OS_LOG_TYPE_DEFAULT, "{%{public}@} CHECK-NO-WAIT-FLOW[%{public}@] set-configuration:%{public}@", buf, 0x20u);
  }

  v20 = 0;
LABEL_49:
  v62 = v20 != 0;

  os_activity_scope_leave(&state);
  return v62;
}

void __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke_2;
  block[3] = &unk_4B4748;
  v20 = v4;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v18 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v21 = v18;
  v22 = v10;
  v11 = a1[8];
  v12 = a1[9];
  v13 = a1[10];
  v14 = a1[11];
  *&v15 = v13;
  *(&v15 + 1) = v14;
  *&v16 = v11;
  *(&v16 + 1) = v12;
  v23 = v16;
  v24 = v15;
  v17 = v4;
  dispatch_async(v6, block);
}

void __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke_2(uint64_t a1)
{
  v1 = a1;
  v2 = *(a1 + 32);
  [*(v1 + 40) setSecureOperationInProgress:0];
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v3 = [*(v1 + 40) latestDowloadedAtomicInstanceEntries];
  v4 = [v3 countByEnumeratingWithState:&v43 objects:v55 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v44;
    v7 = @"AutoControl";
    v42 = v1;
    do
    {
      v8 = 0;
      v41 = v5;
      do
      {
        if (*v44 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v9 = *(v1 + 48);
        v10 = [*(*(&v43 + 1) + 8 * v8) fullAssetSelector];
        v11 = [v9 locateDownloadedByFullSelector:v10];

        [v11 setSecureOperationInProgress:0];
        if ([v11 secureOperationEliminating])
        {
          v12 = _MADLog(v7);
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            v13 = v7;
            v14 = v6;
            v15 = v3;
            v16 = v2;
            v17 = *(v1 + 56);
            v18 = [*(v1 + 40) summary];
            v19 = [v11 summary];
            *buf = 138544130;
            v48 = @"AUTO-PERSONALIZATION";
            v49 = 2114;
            v50 = v17;
            v2 = v16;
            v3 = v15;
            v6 = v14;
            v7 = v13;
            v5 = v41;
            v51 = 2114;
            v52 = v18;
            v53 = 2114;
            v54 = v19;
            _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} auto-asset of set-descriptor eliminate while performing secure operation(s) | setDescriptor:%{public}@ | nextDownloadedDescriptor:%{public}@", buf, 0x2Au);

            v1 = v42;
          }

          [*(v1 + 48) eliminateUngraftDescriptor:*(v1 + 56) forAutoAssetDescriptor:v11 failingClientRequestForEventInfo:0];
          if (!v2)
          {
            v20 = *(v1 + 56);
            v21 = [NSString alloc];
            v22 = [v11 summary];
            v23 = [v21 initWithFormat:@"encountered set-descriptor with auto-asset being eliminated | nextDownloadedDescriptor:%@", v22];
            v2 = [MAAutoAssetError buildError:6114 fromOperation:v20 underlyingError:0 withDescription:v23];

            v1 = v42;
          }
        }

        v8 = v8 + 1;
      }

      while (v5 != v8);
      v5 = [v3 countByEnumeratingWithState:&v43 objects:v55 count:16];
    }

    while (v5);
  }

  v24 = *(v1 + 48);
  v25 = *(v1 + 56);
  v26 = [*(v1 + 64) clientDomainName];
  v27 = [*(v1 + 64) assetSetIdentifier];
  LODWORD(v24) = [v24 isSetIdentifierBeingEliminated:v25 forClientDomainName:v26 ofSetIdentifier:v27];

  if (v24)
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
    {
      v29 = v2;
      v30 = *(v1 + 56);
      v31 = [*(v1 + 40) summary];
      *buf = 138543874;
      v48 = @"AUTO-PERSONALIZATION";
      v49 = 2114;
      v50 = v30;
      v2 = v29;
      v51 = 2114;
      v52 = v31;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} set-identifier eliminate while performing secure operation(s) | nextDownloadedDescriptor:%{public}@", buf, 0x20u);
    }

    [*(v1 + 48) eliminateUngraftSetDescriptor:*(v1 + 40) failingClientRequestForEventInfo:0];
    if (v2)
    {
      goto LABEL_19;
    }

    v32 = *(v1 + 56);
    v33 = [NSString alloc];
    v34 = [*(v1 + 40) summary];
    v35 = [v33 initWithFormat:@"encountered set-descriptor being eliminated | setDescriptor:%@", v34];
    v2 = [MAAutoAssetError buildError:6114 fromOperation:v32 underlyingError:0 withDescription:v35];
  }

  if (!v2)
  {
    [*(v1 + 48) setConfigurationAdoptLatestToVend:*(v1 + 56) fromSetDescriptor:*(v1 + 40) toSetConfiguration:*(v1 + 72) fromPreSUStaging:0 allowEmpty:0];
    v40 = [*(v1 + 48) newSetDescriptorLimitedToCheckInformation:*(v1 + 40)];
    v2 = [*(v1 + 48) buildSetFoundResponseMessage:@"checkAtomic" forClientRequest:*(v1 + 80) withFoundSetDescriptor:v40 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(v1 + 64) withDesire:*(v1 + 88) fromLocation:*(v1 + 56)];
    [*(v1 + 48) issueResponseToClientRequest:*(v1 + 80) issuingResponseMessage:v2 withResponseError:0];
    goto LABEL_21;
  }

LABEL_19:
  v36 = *(v1 + 48);
  v37 = *(v1 + 96);
  v38 = [v2 checkedCode];
  v39 = *(v1 + 56);
  v40 = [v2 checkedDescription];
  [v36 issueResponseForEventInfo:v37 withErrorCode:v38 fromAction:v39 withDescription:v40];
LABEL_21:
}

- (BOOL)doesSetDescriptor:(id)a3 alignWithSetConfiguration:(id)a4
{
  v5 = a3;
  v28 = [a4 autoAssetEntries];
  [v5 latestDowloadedAtomicInstanceEntries];
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  obj = v41 = 0u;
  v26 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (!v26)
  {
    v22 = 1;
    goto LABEL_23;
  }

  v27 = *v39;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v24 = v5;
  while (2)
  {
    v7 = 0;
    while (2)
    {
      if (*v39 != v27)
      {
        objc_enumerationMutation(obj);
      }

      v29 = v7;
      v8 = *(*(&v38 + 1) + 8 * v7);
      v34 = 0u;
      v35 = 0u;
      v36 = 0u;
      v37 = 0u;
      v31 = v28;
      v33 = [v31 countByEnumeratingWithState:&v34 objects:v42 count:16];
      if (!v33)
      {
LABEL_21:

        v22 = 0;
        v5 = v24;
        goto LABEL_23;
      }

      v9 = *v35;
      v30 = v8;
LABEL_8:
      v10 = 0;
      while (1)
      {
        if (*v35 != v9)
        {
          objc_enumerationMutation(v31);
        }

        v11 = *(*(&v34 + 1) + 8 * v10);
        v12 = p_weak_ivar_lyt[223];
        v13 = [v11 assetSelector];
        v14 = [v13 assetType];
        v15 = [v8 fullAssetSelector];
        v16 = [v15 assetType];
        if (![v12 stringIsEqual:v14 to:v16])
        {

          goto LABEL_15;
        }

        v32 = p_weak_ivar_lyt[223];
        v17 = [v11 assetSelector];
        v18 = [v17 assetSpecifier];
        v19 = [v8 fullAssetSelector];
        [v19 assetSpecifier];
        v21 = v20 = v9;
        LOBYTE(v32) = [v32 stringIsEqual:v18 to:v21];

        v9 = v20;
        v8 = v30;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v32)
        {
          break;
        }

LABEL_15:
        if (v33 == ++v10)
        {
          v33 = [v31 countByEnumeratingWithState:&v34 objects:v42 count:16];
          if (v33)
          {
            goto LABEL_8;
          }

          goto LABEL_21;
        }
      }

      v7 = v29 + 1;
      if ((v29 + 1) != v26)
      {
        continue;
      }

      break;
    }

    v22 = 1;
    v5 = v24;
    v26 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    if (v26)
    {
      continue;
    }

    break;
  }

LABEL_23:

  return v22;
}

- (BOOL)doesSetDescriptor:(id)a3 matchSetConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [v7 autoAssetEntries];
  v9 = [v6 latestDowloadedAtomicInstanceEntries];
  v10 = [v8 count];
  if (v10 == [v9 count])
  {
    v11 = [(MADAutoAssetControlManager *)self doesSetDescriptor:v6 alignWithSetConfiguration:v7];
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (BOOL)handleSetClientLockAtomic:(id)a3 forAutoJob:(id)a4 instance:(id)a5 desire:(id)a6 fromLocation:(id)a7
{
  v124 = a3;
  v118 = a4;
  v126 = a5;
  v125 = a6;
  v121 = a7;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v14 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientLockAtomic", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v14, &state);

  v129 = [[NSString alloc] initWithFormat:@"%@:handleSetClientLockAtomic", v121];
  v119 = [v124 clientRequest];
  v15 = [v126 clientDomainName];
  v16 = [v126 assetSetIdentifier];
  v122 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v15 forAssetSetIdentifier:v16];

  v17 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  v123 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if ([v125 lockWaitTimeoutSecs])
  {
    if ([v125 lockWaitTimeoutSecs] != -3)
    {
      v27 = [v125 clientAssetSetPolicy];
      v28 = [v27 supportingShortTermLocks];

      v21 = 0;
      v25 = 0;
      v29 = @"lockAtomic";
      if (v28)
      {
        v29 = @"lockAtomic[SUPPORTING-SHORT-TERM]";
      }

      v117 = v29;
      if (v17)
      {
        goto LABEL_10;
      }

LABEL_14:
      if (!v122)
      {
        [v123 appendString:@"ERROR(no set-configuration)|"];
        v26 = [[NSString alloc] initWithFormat:@"%@ requested when unable to load set-configuration", v117];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withErrorCode:6111 fromAction:v129 withDescription:v26];
        goto LABEL_38;
      }

      v30 = [v126 atomicInstance];
      v31 = v30 == 0;

      if (v31)
      {
        v38 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          v39 = [v122 summary];
          *buf = 138543618;
          v140 = v129;
          v141 = 2114;
          v142 = v39;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{%{public}@} determining atomic-instance to use | setConfiguration:%{public}@", buf, 0x16u);
        }

        v40 = [v122 latestAtomicInstanceToVend];
        v127 = v40 != 0;

        if (v127)
        {
          [v123 appendString:@"using latestToVend|"];
          v41 = [v122 latestAtomicInstanceToVend];
          v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v129 forAtomicInstanceUUID:v41 requireExists:1];

          if (v120)
          {
            LOBYTE(v127) = 1;
            goto LABEL_40;
          }
        }

        v42 = [v122 newerAtomicInstanceOncePersonalized];
        v43 = v42 == 0;

        if (!v43)
        {
          [v123 appendString:@"using newer-once-personalized|"];
          v44 = [v122 newerAtomicInstanceOncePersonalized];
          v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v129 forAtomicInstanceUUID:v44 requireExists:1];

          if (v120)
          {
LABEL_40:
            v136 = 0;
            v137 = 0;
            v54 = [(MADAutoAssetControlManager *)self verifySetDescriptorIsLockable:v120 fromLocation:v129 notLocakableError:&v137 corruptedAtomicEntries:&v136];
            v128 = v137;
            v26 = v136;
            if ((v54 & 1) == 0)
            {
              [v123 appendString:@"ERROR(not lockable)|"];
              if ([v128 code] == "reUpdateCoreSupport")
              {
                [v123 appendString:@"corrupted assets found | "];
                v134 = 0u;
                v135 = 0u;
                v132 = 0u;
                v133 = 0u;
                v116 = v26;
                v62 = v26;
                v63 = [v62 countByEnumeratingWithState:&v132 objects:v145 count:16];
                if (v63)
                {
                  v64 = *v133;
                  do
                  {
                    for (i = 0; i != v63; i = i + 1)
                    {
                      if (*v133 != v64)
                      {
                        objc_enumerationMutation(v62);
                      }

                      v66 = *(*(&v132 + 1) + 8 * i);
                      v67 = [(MADAutoAssetControlManager *)self getCorruptedEntryInfo:v66];
                      v68 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
                      {
                        *buf = 138543618;
                        v140 = v129;
                        v141 = 2114;
                        v142 = v67;
                        _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "{%{public}@} Removing corrupted asset %{public}@", buf, 0x16u);
                      }

                      v69 = [v66 fullAssetSelector];
                      [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:v129 dueToError:v128 fullAssetSelector:v69 historyOperationAI:1502 historyOperationSD:393];

                      v70 = [v66 fullAssetSelector];
                      v71 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v70];
                      [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:v129 droppingDescriptor:v71 forHistoryOperation:409 firstClientName:0];
                    }

                    v63 = [v62 countByEnumeratingWithState:&v132 objects:v145 count:16];
                  }

                  while (v63);
                }

                v26 = v116;
              }

              v61 = [[NSString alloc] initWithFormat:@"%@ requested when chosen downloaded descriptor not lockable", v117];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withAutoAssetError:v128 fromAction:v129 withDescription:v61];
              goto LABEL_60;
            }

            v55 = [v120 latestDowloadedAtomicInstanceEntries];
            v56 = [v55 count] == 0;

            if (v56)
            {
              v57 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
              {
                v58 = [v122 summary];
                *buf = 138543618;
                v140 = v129;
                v141 = 2114;
                v142 = v58;
                _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "{%{public}@} processing zero-entries set | setConfiguration:%{public}@", buf, 0x16u);
              }
            }

            v131 = 0;
            v59 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:v124 fromLocation:v129 errorString:&v131];
            v60 = v131;
            v61 = v60;
            if (v59)
            {
              [v123 appendString:@"ERROR(failed to schedule)|"];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withErrorCode:v59 fromAction:v129 withDescription:v61];
LABEL_60:
              v53 = 0;
LABEL_94:

              goto LABEL_95;
            }

            v115 = v60;
            v72 = [v126 atomicInstance];
            v73 = [v126 clientDomainName];
            v74 = [v126 assetSetIdentifier];
            v114 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:v72 elseByClientDomain:v73 forAssetSetIdentifier:v74 fromLocation:v129];

            if (v21)
            {
              v52 = 0;
LABEL_76:
              v85 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:v117 forClientRequest:v119 withFoundSetDescriptor:v120 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v126 withDesire:v125 fromLocation:v129];
              v99 = [v126 atomicInstance];
              if (v99)
              {
                v100 = 1;
              }

              else
              {
                v100 = v127;
              }

              if ((v100 & 1) == 0)
              {
                [v123 appendString:@"now latest-to-vend|"];
                [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v129 fromSetDescriptor:v120 toSetConfiguration:v122 fromPreSUStaging:0 allowEmpty:0];
              }

              [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v119 issuingResponseMessage:v85 withResponseError:0];
              if (v21)
              {
                v101 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v101, OS_LOG_TYPE_DEFAULT))
                {
                  v102 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  v103 = [v120 summary];
                  *buf = 138543874;
                  v140 = v102;
                  v141 = 2114;
                  v142 = v129;
                  v143 = 2114;
                  v144 = v103;
                  _os_log_impl(&dword_0, v101, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} NO_WAIT_NOT_PERSISTED | successful lock | chosenDownloadedSetDescriptor:%{public}@", buf, 0x20u);
                }
              }

              goto LABEL_91;
            }

            v82 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v120];
            v83 = [MADAutoAssetSecure doesSetDescriptorInvolveSecureOperations:@"handleSetClientLockAtomic" forSetDescriptor:v120 withAutoAssetDescriptors:v82];

            if (v83 && (v84 = [MADAutoAssetSecure isPersonalizationOrGraftingRequired:@"handleSetClientLockAtomic" forSetDescriptor:v120], v84 & 1 | ![(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:v129 forSetDescriptor:v120]))
            {
              v85 = [[NSMutableString alloc] initWithString:@"secure operations pending"];
              [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDMostRecentlyReceived:v129 fromSetDescriptor:v120 forSetConfiguration:v122 buildingPersistReason:v85];
              [(MADAutoAssetControlManager *)self setConfigurationPersist:v122 fromLocation:v129 forReason:v85 dueToAlter:0 forHistoryOperation:459];
              [v123 appendString:@"awaiting secure|"];
              [(MADAutoAssetControlManager *)self securePersonalizeGraftLockSet:v129 lockingSetDescriptor:v120 forEventInfo:v124 fallingBackToSetDescriptor:0 fromPreSUStaging:0];
              v52 = 0;
            }

            else
            {
              [v123 appendString:@"no grafting required|"];
              v86 = [v126 autoAssetSetClientName];
              v87 = [v126 clientProcessName];
              v88 = [v126 clientProcessID];
              v89 = [v125 desireReason];
              v90 = [v114 currentNeedPolicy];
              v130 = 0;
              v91 = [MADAutoAssetLocker lockedSetByClient:v86 forClientProcessName:v87 withClientProcessID:v88 lockingSetDescriptor:v120 forLockReason:v89 withSetUsagePolicy:v90 lockError:&v130];
              v52 = v130;

              if (v91)
              {
                [v123 appendString:@"asset locked|"];
                v92 = [v125 desireReason];
                [(MADAutoAssetControlManager *)self setLockUsageMapLockedSetDescriptor:v120 forLockReason:v92];

                if ([v120 neverBeenLocked])
                {
                  [v120 setNeverBeenLocked:0];
                  v93 = [v126 atomicInstance];
                  v94 = [v126 autoAssetSetClientName];
                  LOBYTE(v113) = 0;
                  BYTE2(v112) = 0;
                  LOWORD(v112) = 1;
                  [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v120 forLatestDownloaded:v129 forSpecificAtomicInstance:1 withCurrentSetStatus:v93 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v112 latestToVend:0 historyOperation:v94 firstClientName:v113 fromPreSUStaging:?];
                }

                v95 = [v124 clientRequestMessage];
                v96 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:v95];

                if ([v96 supportingShortTermLocks])
                {
                  [v123 appendString:@"supporting SHORT-TERM|"];
                  v97 = [v126 atomicInstance];
                  v98 = [(MADAutoAssetControlManager *)self shortTermLockSetDescriptor:@"handleSetClientLockAtomic" forSetDescriptor:v120 forSpecificAtomicInstance:v97];
                }

                goto LABEL_76;
              }

              if (!v25)
              {
                [v123 appendString:@"may be stale - routing to set-job|"];
                v53 = 1;
                goto LABEL_92;
              }

              [v123 appendString:@"ERROR(unable to lock)|"];
              v85 = [[NSString alloc] initWithFormat:@"unable to lock auto-asset-set (failed to persist [additional] set-lock) for %@", v117];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withAutoAssetError:v52 fromAction:v129 withDescription:v85];
            }

LABEL_91:

            v53 = 0;
LABEL_92:

            goto LABEL_93;
          }
        }

        if (([v122 everProvidedLatestToVend] & 1) == 0)
        {
          v75 = [v122 clientDomainName];
          v76 = [v126 autoAssetSetClientName];
          v77 = [v122 assetSetIdentifier];
          v78 = [v122 firstEntryAssetType];
          v79 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:v129 forClientDomainName:v75 forSetClientName:v76 forAssetSetIdentifier:v77 forAssetType:v78];

          if (v79)
          {
            v80 = [v79 latestDownloadedAtomicInstance];
            v81 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v80];

            if (v81)
            {
              [v123 appendString:@"using pre-installed|"];
              v45 = v79;
            }

            else
            {
              v104 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v105 = [v104 diag];
              v106 = [NSString alloc];
              v107 = [v79 summary];
              v108 = [v106 initWithFormat:@"{%@} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", v129, v107];
              [v105 trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v108 withResult:6103 withError:0];

              v45 = 0;
            }
          }

          else
          {
            v45 = 0;
          }

          goto LABEL_31;
        }
      }

      else
      {
        v32 = [v126 atomicInstance];
        v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v129 forAtomicInstanceUUID:v32 requireExists:0];

        if (v120)
        {
          v33 = [v120 clientDomainName];
          v34 = [v126 clientDomainName];
          if (([SUCore stringIsEqual:v33 to:v34]& 1) != 0)
          {
            v35 = [v120 assetSetIdentifier];
            v36 = [v126 assetSetIdentifier];
            v37 = [SUCore stringIsEqual:v35 to:v36];

            if (v37)
            {
              LOBYTE(v127) = 0;
              goto LABEL_40;
            }
          }

          else
          {
          }

          [v123 appendString:@"ERROR(specific atomic-instance not downloaded)|"];

          v26 = [[NSString alloc] initWithFormat:@"%@ requested when specific atomic-instance not already downloaded", v117];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withErrorCode:6103 fromAction:v129 withDescription:v26];
          goto LABEL_38;
        }

        LOBYTE(v127) = 0;
      }

      v45 = 0;
LABEL_31:
      v46 = v25 ^ 1;
      if (v45)
      {
        v46 = 1;
      }

      if ((v46 & 1) == 0)
      {
        v47 = [v126 atomicInstance];
        v48 = [v126 clientDomainName];
        v49 = [v126 assetSetIdentifier];
        v26 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:v47 elseByClientDomain:v48 forAssetSetIdentifier:v49 fromLocation:v129];

        v50 = [v26 availableForUseError];
        LODWORD(v48) = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v50];

        if (!v48)
        {
          [v123 appendString:@"ERROR(no downloaded atomic-instance)|"];
          v61 = [[NSString alloc] initWithFormat:@"%@ requested when unable to locate already downloaded content", v117];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withErrorCode:6503 fromAction:v129 withDescription:v61];
          v120 = 0;
          v128 = 0;
          goto LABEL_60;
        }

        [v123 appendString:@"ERROR(unable to graft - device locked)|"];
        v51 = [v26 availableForUseError];
        v52 = [[NSString alloc] initWithFormat:@"%@ requested when unable to graft - device locked", v117];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withAutoAssetError:v51 fromAction:v129 withDescription:v52];
        v115 = v51;
        v120 = 0;
        v128 = 0;
        v53 = 0;
LABEL_93:

        v61 = v115;
        goto LABEL_94;
      }

      v120 = v45;
      if (!v45)
      {
        [v123 appendString:@"routing to set-job|"];
        v120 = 0;
        v128 = 0;
        v53 = 1;
        goto LABEL_96;
      }

      goto LABEL_40;
    }

    v18 = [v125 clientAssetSetPolicy];
    v19 = [v18 supportingShortTermLocks];

    v20 = @"lockAtomic[NO_WAIT_NOT_PERSISTED][SUPPORTING-SHORT-TERM]";
    if (v19)
    {
      v20 = @"lockAtomic[NO_WAIT][SUPPORTING-SHORT-TERM]";
    }

    v117 = v20;
    v21 = 1;
  }

  else
  {
    v22 = [v125 clientAssetSetPolicy];
    v23 = [v22 supportingShortTermLocks];

    v21 = 0;
    v24 = @"lockAtomic[NO_WAIT]";
    if (v23)
    {
      v24 = @"lockAtomic[NO_WAIT][SUPPORTING-SHORT-TERM]";
    }

    v117 = v24;
  }

  v25 = 1;
  if (!v17)
  {
    goto LABEL_14;
  }

LABEL_10:
  [v123 appendString:@"ERROR(before first-unlock)|"];
  v26 = [[NSString alloc] initWithFormat:@"%@ requested when device is before first-unlock", v117];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v124 withErrorCode:6101 fromAction:v129 withDescription:v26];
LABEL_38:
  v120 = 0;
  v128 = 0;
  v53 = 0;
LABEL_95:

LABEL_96:
  v109 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v109, OS_LOG_TYPE_DEFAULT))
  {
    v110 = [v122 summary];
    *buf = 138543874;
    v140 = v129;
    v141 = 2114;
    v142 = v123;
    v143 = 2114;
    v144 = v110;
    _os_log_impl(&dword_0, v109, OS_LOG_TYPE_DEFAULT, "{%{public}@} LOCK-FLOW[%{public}@] set-configuration:%{public}@", buf, 0x20u);
  }

  os_activity_scope_leave(&state);
  return v53;
}

- (void)handleSetClientMapLockedAtomicEntryRequest:(id)a3 forAutoJob:(id)a4 fromLocation:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientMapLockedAtomicEntryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  v14 = [[NSString alloc] initWithFormat:@"%@:handleSetClientMapLockedAtomicEntryRequest", v10];
  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientMapLockedAtomicEntryRequest" withEventInfo:v8];
  v16 = v15;
  if (v15)
  {
    v17 = [v15 atomicInstance];

    if (v17)
    {
      v18 = [v16 atomicInstance];
      v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v14 forAtomicInstanceUUID:v18 requireExists:0];
    }

    else
    {
      v32 = [v16 clientDomainName];
      v33 = [v16 assetSetIdentifier];
      v18 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v32 forAssetSetIdentifier:v33];

      if (v18)
      {
        v19 = [v18 latestAtomicInstanceToVend];

        if (v19)
        {
          v34 = [v18 latestAtomicInstanceToVend];
          v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v14 forAtomicInstanceUUID:v34 requireExists:1];
        }
      }

      else
      {
        v19 = 0;
      }
    }

    if (v19)
    {
      if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientMapLockedAtomicEntryRequest" forSetDescriptor:v19])
      {
        v20 = [v16 autoAssetEntries];

        if (v20)
        {
          v21 = [v16 autoAssetEntries];
          v22 = [v21 count];

          if (v22 == &dword_0 + 1)
          {
            v23 = [v16 autoAssetEntries];
            v24 = [v23 objectAtIndex:0];

            v44 = [v24 assetSelector];
            v25 = [v44 assetType];
            v26 = [v44 assetSpecifier];
            v43 = [v19 downloadedEntryForAssetType:v25 forAssetSpecifier:v26];

            v27 = [v44 assetVersion];

            if (v27)
            {
              v42 = [v44 assetVersion];
              v28 = [v43 fullAssetSelector];
              v29 = [v28 assetVersion];
              v41 = [SUCore stringIsEqual:v42 to:v29];

              if (v41)
              {
                v30 = v44;
LABEL_25:
                v37 = v43;
                if (!v30)
                {
LABEL_34:

                  goto LABEL_12;
                }

                v38 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v30];
                v39 = v38;
                if (v38)
                {
                  [v38 setSecureOperationInProgress:1];
                  v45[0] = _NSConcreteStackBlock;
                  v45[1] = 3221225472;
                  v45[2] = __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke;
                  v45[3] = &unk_4B47C0;
                  v45[4] = self;
                  v46 = v39;
                  v47 = v30;
                  v48 = v14;
                  v49 = v8;
                  v50 = v19;
                  v51 = v16;
                  [MADAutoAssetSecure mapToExclave:v48 forDescriptor:v46 completion:v45];
                }

                else
                {
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6111 fromAction:v14 withDescription:@"atomic-instance lock to be mapped to exclave environment with auto-asset asset-selector that is not currently downloaded"];
                }

                v44 = v30;

LABEL_33:
                v37 = v43;
                goto LABEL_34;
              }

              v40 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries value for different asset-version than entry associated with atomic-instance";
            }

            else
            {
              if (v43)
              {
                v30 = [v43 fullAssetSelector];

                goto LABEL_25;
              }

              v40 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries value (without asset-version) that is not found in the associated atomic-instance";
            }

            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6108 fromAction:v14 withDescription:v40];
            goto LABEL_33;
          }

          v35 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries count other than 1 (limited to mapping a single asset-selector per set-identifier)";
          v36 = 6108;
        }

        else
        {
          v35 = @"atomic-instance lock to be mapped to exclave environment MISSING autoAssetEntries";
          v36 = 6102;
        }
      }

      else
      {
        v35 = @"atomic-instance lock to be mapped to exclave environment is not currently locked";
        v36 = 6501;
      }
    }

    else
    {
      v35 = @"atomic-instance lock to be mapped to exclave environment is not downloaded";
      v36 = 6551;
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:v36 fromAction:v14 withDescription:v35];
    goto LABEL_22;
  }

  v31 = [NSString alloc];
  v19 = [v8 summary];
  v24 = [v31 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v19];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v8 withErrorCode:6102 fromAction:v14 withDescription:v24];
LABEL_12:

LABEL_22:
  os_activity_scope_leave(&state);
}

void __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke_2;
  block[3] = &unk_4B4798;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v18 = a1[9];
  v19 = a1[10];
  v11 = v4;
  dispatch_async(v6, block);
}

void __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      *buf = 138543618;
      v13 = v3;
      v14 = 2114;
      v15 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-MAP][ELIMINATE] {%{public}@} | eliminate triggered while mapping-to-exclave | mapDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else
  {
    v5 = *(a1 + 40);
    v6 = *(a1 + 64);
    if (*(a1 + 72))
    {
      v7 = *(a1 + 40);

      [v7 issueResponseForEventInfo:v6 withAutoAssetError:? fromAction:? withDescription:?];
    }

    else
    {
      v8 = [*(a1 + 64) clientRequest];
      v11 = [v5 buildSetFoundResponseMessage:@"mapToExclave" forClientRequest:v8 withFoundSetDescriptor:*(a1 + 80) withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(a1 + 88) withDesire:0 fromLocation:*(a1 + 56)];

      v9 = *(a1 + 40);
      v10 = [*(a1 + 64) clientRequest];
      [v9 issueResponseToClientRequest:v10 issuingResponseMessage:v11 withResponseError:0];
    }
  }
}

- (void)handleSetClientCurrentStatusRequest:(id)a3 forAutoJob:(id)a4
{
  v101 = a3;
  v91 = a4;
  v104 = self;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientCurrentStatusRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v109 = [(MADAutoAssetControlManager *)v104 clientRequestMessageSetInstance:@"handleSetClientCurrentStatusRequest" withEventInfo:v101];
  v9 = [v109 atomicInstance];
  v10 = [v109 clientDomainName];
  v11 = [v109 assetSetIdentifier];
  v12 = [(MADAutoAssetControlManager *)v104 locateSetStatusPreferringByInstance:v9 elseByClientDomain:v10 forAssetSetIdentifier:v11 fromLocation:@"lockSetAlreadyCompletedToClient"];

  v13 = [v109 clientDomainName];
  v14 = [v109 assetSetIdentifier];
  v102 = [(MADAutoAssetControlManager *)v104 setConfigurationForClientDomain:v13 forAssetSetIdentifier:v14];

  if (v12)
  {
    v15 = [v102 latestAtomicInstanceToVend];
    v16 = v15 == 0;

    if (v16)
    {
      obj = 0;
    }

    else
    {
      obj = [v102 latestAtomicInstanceToVend];
      v17 = [v102 latestAtomicInstanceToVend];
      v100 = [(MADAutoAssetControlManager *)v104 locateSetDescriptor:@"handleSetClientCurrentStatusRequest" forAtomicInstanceUUID:v17 requireExists:1];

      if (v100)
      {
        v18 = [(MANAutoAssetSetNotifications *)v100 latestDowloadedAtomicInstanceEntries];
        v103 = [(MADAutoAssetControlManager *)v104 _limitToCheckAtomicEntries:v18];

LABEL_11:
        v27 = [v12 clientDomainName];
        v28 = [v12 assetSetIdentifier];
        v106 = [v12 atomicInstancesDownloaded];
        v98 = [v12 newerAtomicInstanceDiscovered];
        v97 = [v12 newerDiscoveredAtomicEntries];
        v90 = [v102 latestAtomicInstanceToVendFromPreSUStaging];
        v99 = [v12 currentNotifications];
        v95 = [v12 currentNeedPolicy];
        v96 = [v109 clientDomainName];
        v94 = [v109 assetSetIdentifier];
        v93 = [MADAutoAssetScheduler newSetPolicyForDomainName:v96 forAssetSetIdentifier:v94];
        v92 = +[MADAutoAssetControlManager stagerSetPolicy];
        v29 = [v12 downloadUserInitiated];
        v30 = [v12 downloadProgress];
        v31 = [v12 downloadedNetworkBytes];
        v32 = [v12 downloadedFilesystemBytes];
        v33 = [v12 selectorsForStaging];
        v34 = [v102 availableForUseError];
        v35 = [v102 newerVersionError];
        LOBYTE(v89) = 1;
        LOBYTE(v88) = v29;
        LOBYTE(v87) = v90;
        v36 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"extended set-job to include lock-usage" forClientDomain:v27 forAssetSetIdentifier:v28 withAtomicInstancesDownloaded:v106 withNewerAtomicInstanceDiscovered:v98 withNewerDiscoveredAtomicEntries:v97 withLatestDownloadedAtomicInstance:obj withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:v103 withCurrentNotifications:v99 withCurrentNeedPolicy:v95 withSchedulerPolicy:v93 withStagerPolicy:v92 withDownloadUserInitiated:v88 withDownloadProgress:v30 withDownloadedNetworkBytes:v31 withDownloadedFilesystemBytes:v32 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:v33 withAvailableForUseError:v34 withNewerVersionError:v35];

        v26 = v27;
        goto LABEL_12;
      }
    }

    v103 = 0;
    v100 = 0;
    goto LABEL_11;
  }

  v19 = [v109 atomicInstance];
  v20 = v19 == 0;

  if (v20)
  {
    +[MADAutoAssetScheduler jobsAwaitingTrigger];
    v116 = 0u;
    v117 = 0u;
    v114 = 0u;
    obj = v115 = 0u;
    v57 = [obj countByEnumeratingWithState:&v114 objects:v128 count:16];
    if (!v57)
    {
      goto LABEL_36;
    }

    v107 = *v115;
    while (1)
    {
      for (i = 0; i != v57; i = i + 1)
      {
        if (*v115 != v107)
        {
          objc_enumerationMutation(obj);
        }

        v59 = *(*(&v114 + 1) + 8 * i);
        if ([v59 setJob])
        {
          v60 = [v59 assetSelector];
          v61 = [v60 assetType];
          v62 = [v109 clientDomainName];
          if (([SUCore stringIsEqual:v61 to:v62]& 1) != 0)
          {
            v63 = [v59 assetSelector];
            v64 = [v63 assetSpecifier];
            v65 = [v109 assetSetIdentifier];
            v66 = [SUCore stringIsEqual:v64 to:v65];

            if (v66)
            {
              v37 = v59;

              if (v37)
              {
                v100 = 0;
                v76 = 0;
              }

              else
              {
LABEL_52:
                v77 = [v101 clientRequest];
                v78 = [(MADAutoAssetControlManager *)v104 clientRequestMessageName:v77];
                v100 = [(MADAutoAssetControlManager *)v104 setConfigurationFromMessageName:v78 withInfoInstance:v109 errorCode:0 errorDescription:0];

                v37 = 0;
                if (!v100)
                {
                  v36 = 0;
                  goto LABEL_18;
                }

                v76 = 1;
              }

              v26 = [v109 clientDomainName];
              v28 = [v109 assetSetIdentifier];
              v106 = objc_alloc_init(MANAutoAssetSetNotifications);
              if (v76)
              {
                v99 = 0;
              }

              else
              {
                v98 = [v109 clientDomainName];
                v97 = [v109 assetSetIdentifier];
                v99 = [MADAutoAssetScheduler newSetPolicyForDomainName:v98 forAssetSetIdentifier:v97];
              }

              v83 = +[MADAutoAssetControlManager stagerSetPolicy];
              v84 = [v102 availableForUseError];
              v85 = [v102 newerVersionError];
              LOBYTE(v89) = 1;
              LOBYTE(v88) = 0;
              LOBYTE(v87) = 0;
              v36 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"scheduled set-job" forClientDomain:v26 forAssetSetIdentifier:v28 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:v106 withCurrentNeedPolicy:0 withSchedulerPolicy:v99 withStagerPolicy:v83 withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:v84 withNewerVersionError:v85];

              if (v76)
              {
LABEL_15:

                v38 = v100;
LABEL_16:

                goto LABEL_17;
              }

LABEL_14:

              goto LABEL_15;
            }
          }

          else
          {
          }
        }
      }

      v57 = [obj countByEnumeratingWithState:&v114 objects:v128 count:16];
      if (!v57)
      {
LABEL_36:

        goto LABEL_52;
      }
    }
  }

  v21 = [v109 atomicInstance];
  obj = [(MADAutoAssetControlManager *)v104 locateSetDescriptor:@"handleSetClientCurrentStatusRequest" forAtomicInstanceUUID:v21 requireExists:0];

  if (obj)
  {
    v103 = objc_alloc_init(MANAutoAssetSetNotifications);
    v22 = [obj latestDownloadedAtomicInstance];
    v23 = [v102 latestAtomicInstanceToVend];
    v24 = [SUCore stringIsEqual:v22 to:v23];

    if (v24)
    {
      v100 = [obj latestDownloadedAtomicInstance];
      v25 = [obj latestDowloadedAtomicInstanceEntries];
      v26 = [(MADAutoAssetControlManager *)v104 _limitToCheckAtomicEntries:v25];
    }

    else
    {
      v100 = 0;
      v26 = 0;
    }

    [(MANAutoAssetSetNotifications *)v103 setAtomicInstanceDiscovered:1];
    [(MANAutoAssetSetNotifications *)v103 setAtomicInstanceAvailableForUse:1];
    v28 = [obj clientDomainName];
    v106 = [obj assetSetIdentifier];
    v98 = [(MADAutoAssetControlManager *)v104 _newAtomicInstancesDownloadedForSetIdentifier:obj];
    v97 = [obj discoveredAtomicInstance];
    v99 = [obj discoveredAtomicEntries];
    v79 = [v102 latestAtomicInstanceToVendFromPreSUStaging];
    v95 = [obj clientDomainName];
    v96 = [obj assetSetIdentifier];
    v94 = [MADAutoAssetScheduler newSetPolicyForDomainName:v95 forAssetSetIdentifier:v96];
    v93 = +[MADAutoAssetControlManager stagerSetPolicy];
    v80 = [obj downloadUserInitiated];
    v81 = [obj downloadedNetworkBytes];
    v82 = [obj downloadedFilesystemBytes];
    v92 = [v102 availableForUseError];
    v30 = [v102 newerVersionError];
    LOBYTE(v89) = 1;
    LOBYTE(v88) = v80;
    LOBYTE(v87) = v79;
    v36 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"downloaded auto-asset-set" forClientDomain:v28 forAssetSetIdentifier:v106 withAtomicInstancesDownloaded:v98 withNewerAtomicInstanceDiscovered:v97 withNewerDiscoveredAtomicEntries:v99 withLatestDownloadedAtomicInstance:v100 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:v26 withCurrentNotifications:v103 withCurrentNeedPolicy:0 withSchedulerPolicy:v94 withStagerPolicy:v93 withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:v81 withDownloadedFilesystemBytes:v82 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:v92 withNewerVersionError:v30];
LABEL_12:

LABEL_13:
    v37 = v103;
    goto LABEL_14;
  }

  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v112 = 0u;
  v113 = 0u;
  v110 = 0u;
  v103 = v111 = 0u;
  v36 = [(MANAutoAssetSetNotifications *)v103 countByEnumeratingWithState:&v110 objects:v127 count:16];
  if (!v36)
  {
LABEL_49:
    v38 = v103;
    v37 = v103;
    goto LABEL_16;
  }

  v108 = *v111;
LABEL_39:
  v67 = 0;
  while (1)
  {
    if (*v111 != v108)
    {
      objc_enumerationMutation(v103);
    }

    v68 = *(*(&v110 + 1) + 8 * v67);
    if (![v68 setJob])
    {
      goto LABEL_47;
    }

    v69 = [v68 assetSelector];
    v70 = [v69 assetType];
    v71 = [v109 clientDomainName];
    if (([SUCore stringIsEqual:v70 to:v71]& 1) == 0)
    {

      goto LABEL_47;
    }

    v72 = [v68 assetSelector];
    v73 = [v72 assetSpecifier];
    v74 = [v109 assetSetIdentifier];
    v75 = [SUCore stringIsEqual:v73 to:v74];

    if (v75)
    {
      break;
    }

LABEL_47:
    if (v36 == ++v67)
    {
      v36 = [(MANAutoAssetSetNotifications *)v103 countByEnumeratingWithState:&v110 objects:v127 count:16];
      if (v36)
      {
        goto LABEL_39;
      }

      goto LABEL_49;
    }
  }

  v100 = v68;

  if (v100)
  {
    v26 = [v109 clientDomainName];
    v28 = [v109 assetSetIdentifier];
    v106 = objc_alloc_init(MANAutoAssetSetNotifications);
    v98 = [v109 clientDomainName];
    v97 = [v109 assetSetIdentifier];
    v99 = [MADAutoAssetScheduler newSetPolicyForDomainName:v98 forAssetSetIdentifier:v97];
    v95 = +[MADAutoAssetControlManager stagerSetPolicy];
    v96 = [v102 availableForUseError];
    v86 = [v102 newerVersionError];
    LOBYTE(v89) = 1;
    LOBYTE(v88) = 0;
    LOBYTE(v87) = 0;
    v36 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"scheduled set-job" forClientDomain:v26 forAssetSetIdentifier:v28 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:v106 withCurrentNeedPolicy:0 withSchedulerPolicy:v99 withStagerPolicy:v95 withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:v96 withNewerVersionError:v86];

    goto LABEL_13;
  }

  v36 = 0;
  v37 = v103;
LABEL_17:

LABEL_18:
  if (v36)
  {
    v39 = objc_alloc_init(NSMutableDictionary);
    v40 = [MANAutoAssetSetInfoFound alloc];
    v41 = [v36 assetSetIdentifier];
    v42 = [(MANAutoAssetSetInfoFound *)v40 initForAssetSetIdentifier:v41 reportingStatus:v36];

    v43 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v109];
    [v39 setSafeObject:v43 forKey:@"setInstance"];

    v44 = [MASAutoAssetSetInfoFound newShimmedToFramework:v42];
    [v39 setSafeObject:v44 forKey:@"setFound"];

    v45 = [SUCoreConnectMessage alloc];
    v46 = [v101 clientRequestMessage];
    v47 = [MADAutoAssetControlManager replyMessageNameForRequest:v46];
    v48 = [v101 clientRequestMessage];
    v49 = [v48 clientID];
    v50 = [v45 initWithType:2 messageName:v47 clientID:v49 version:0 message:v39];

    [(MADAutoAssetControlManager *)v104 issueBuiltResponseForEventInfo:v101 issuingResponseMessage:v50 withResponseError:0 fromLocation:@"handleSetClientCurrentStatusRequest"];
    v51 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v51, OS_LOG_TYPE_DEBUG))
    {
      v52 = [(MADAutoAssetControlManager *)v104 _updateLatestSummary];
      v53 = [v109 summary];
      v54 = [v36 summary];
      v55 = [v101 summary];
      *buf = 138544130;
      v120 = v52;
      v121 = 2114;
      v122 = v53;
      v123 = 2114;
      v124 = v54;
      v125 = 2114;
      v126 = v55;
      _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEBUG, "[%{public}@] {handleSetClientCurrentStatusRequest} current set-status request | setInstance:%{public}@, lastSetJobStatus:%{public}@, event:%{public}@", buf, 0x2Au);
    }
  }

  else
  {
    v56 = [NSString alloc];
    v39 = [v109 summary];
    v42 = [v56 initWithFormat:@"current status requested for unknown auto-asset-set (no status available for setInstance:%@)", v39];
    [(MADAutoAssetControlManager *)v104 issueResponseForEventInfo:v101 withErrorCode:6301 fromAction:@"handleSetClientCurrentStatusRequest" withDescription:v42];
  }

  os_activity_scope_leave(&state);
}

- (void)handleSetControlClientAssetSetsOverviewRequest:(id)a3 forAutoJob:(id)a4
{
  v74 = a3;
  v72 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetControlClientAssetSetsOverviewRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [v74 clientRequestMessage];
  v73 = [v9 message];

  v78 = [MASAutoAssetSetInfoControl newShimmedFromFrameworkMessage:v73 forKey:@"setControl"];
  v75 = objc_alloc_init(NSMutableArray);
  v82 = objc_alloc_init(NSMutableDictionary);
  v93 = 0u;
  v94 = 0u;
  v91 = 0u;
  v92 = 0u;
  v10 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v11 = [v10 allKeys];
  obj = [v11 copy];

  v12 = [obj countByEnumeratingWithState:&v91 objects:v98 count:16];
  if (v12)
  {
    v79 = *v92;
    do
    {
      v13 = 0;
      do
      {
        if (*v92 != v79)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v91 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v17 = [v16 safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v17)
        {
          v18 = [v17 assetSetIdentifier];
          v19 = [v17 clientDomainName];
          v20 = [MADAutoAssetControlManager assetSetToBeIncluded:v18 consideredClientDomain:v19 basedOnControl:v78];

          if (v20)
          {
            v21 = [MANAutoAssetSetOverview alloc];
            v22 = [v17 clientDomainName];
            v23 = [v17 assetSetIdentifier];
            v24 = [v17 autoAssetEntries];
            v25 = [(MANAutoAssetSetOverview *)v21 initWithDomainName:v22 forAssetSetIdentifier:v23 withConfiguredAssetEntries:v24 withLatestDownloadedAtomicInstance:0 withDownloadedAtomicInstances:0 withDiscoveredAtomicInstance:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

            if (v25)
            {
              [v75 addObject:v25];
            }

            v26 = [v17 clientDomainName];
            v27 = [v17 assetSetIdentifier];
            v28 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v26 forAssetSetIdentifier:v27];

            if (v25)
            {
              [v82 setSafeObject:v25 forKey:v28];
            }
          }
        }

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v12 != v13);
      v12 = [obj countByEnumeratingWithState:&v91 objects:v98 count:16];
    }

    while (v12);
  }

  [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  v89 = 0u;
  v90 = 0u;
  v87 = 0u;
  obja = v88 = 0u;
  v29 = [obja countByEnumeratingWithState:&v87 objects:v97 count:16];
  if (v29)
  {
    v80 = *v88;
    do
    {
      v30 = 0;
      do
      {
        if (*v88 != v80)
        {
          objc_enumerationMutation(obja);
        }

        v31 = *(*(&v87 + 1) + 8 * v30);
        v32 = objc_autoreleasePoolPush();
        v33 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetControlClientAssetSetsOverviewRequest" forKey:v31];
        v34 = v33;
        if (v33)
        {
          v35 = [v33 clientDomainName];
          v36 = [v34 assetSetIdentifier];
          v37 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v35 forAssetSetIdentifier:v36];

          v38 = [v82 safeObjectForKey:v37 ofClass:objc_opt_class()];
          v39 = v38;
          if (v38)
          {
            v40 = [v38 downloadedAtomicInstances];
            v41 = v40 == 0;

            if (v41)
            {
              v42 = objc_alloc_init(NSMutableArray);
              [v39 setDownloadedAtomicInstances:v42];
            }

            v43 = [v34 latestDownloadedAtomicInstance];
            v44 = v43 == 0;

            if (!v44)
            {
              v45 = [v39 downloadedAtomicInstances];
              v46 = [v34 latestDownloadedAtomicInstance];
              [v45 addObject:v46];
            }

            v47 = [v34 clientDomainName];
            v48 = [v34 assetSetIdentifier];
            v49 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v47 forAssetSetIdentifier:v48];

            v50 = [v49 latestAtomicInstanceToVend];
            [v39 setLatestDownloadedAtomicInstance:v50];
          }
        }

        objc_autoreleasePoolPop(v32);
        v30 = v30 + 1;
      }

      while (v29 != v30);
      v29 = [obja countByEnumeratingWithState:&v87 objects:v97 count:16];
    }

    while (v29);
  }

  v85 = 0u;
  v86 = 0u;
  v83 = 0u;
  v84 = 0u;
  v51 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v52 = [v51 countByEnumeratingWithState:&v83 objects:v96 count:16];
  if (v52)
  {
    v53 = *v84;
    v81 = v51;
    do
    {
      v54 = 0;
      do
      {
        if (*v84 != v53)
        {
          objc_enumerationMutation(v81);
        }

        v55 = *(*(&v83 + 1) + 8 * v54);
        v56 = objc_autoreleasePoolPush();
        v57 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
        v58 = [v57 safeObjectForKey:v55 ofClass:objc_opt_class()];

        if (v58)
        {
          v59 = [v58 clientDomainName];
          v60 = [v58 assetSetIdentifier];
          v61 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v59 forAssetSetIdentifier:v60];

          v62 = [v82 safeObjectForKey:v61 ofClass:objc_opt_class()];
          v63 = v62;
          if (v62)
          {
            [v62 setDiscoveredAtomicInstance:v55];
          }
        }

        objc_autoreleasePoolPop(v56);
        v54 = v54 + 1;
      }

      while (v52 != v54);
      v51 = v81;
      v52 = [v81 countByEnumeratingWithState:&v83 objects:v96 count:16];
    }

    while (v52);
  }

  v64 = objc_alloc_init(NSMutableDictionary);
  v65 = [MASAutoAssetSetOverview newShimmedArrayToFramework:v75];
  [v64 setSafeObject:v65 forKey:@"setOverview"];

  v66 = [SUCoreConnectMessage alloc];
  v67 = [v74 clientRequestMessage];
  v68 = [MADAutoAssetControlManager replyMessageNameForRequest:v67];
  v69 = [v74 clientRequestMessage];
  v70 = [v69 clientID];
  v71 = [v66 initWithType:2 messageName:v68 clientID:v70 version:0 message:v64];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v74 issuingResponseMessage:v71 withResponseError:0 fromLocation:@"handleSetControlClientAssetSetsOverviewRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleSetControlClientInstanceInfoRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v7 = a4;
  v39 = self;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetControlClientInstanceInfoRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [v6 clientRequestMessage];
  v12 = [v11 message];

  v37 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:v12 forKey:@"setInstance"];
  v13 = [v37 atomicInstance];
  v38 = v13;
  if (v13 && ((-[MADAutoAssetControlManager setDescriptorWalkLocate:forKey:](v39, "setDescriptorWalkLocate:forKey:", @"handleSetControlClientInstanceInfoRequest", v13), (v14 = objc_claimAutoreleasedReturnValue()) != 0) || (-[MADAutoAssetControlManager activeSetDescriptorsByInstance](v39, "activeSetDescriptorsByInstance"), v15 = objc_claimAutoreleasedReturnValue(), [v15 safeObjectForKey:v38 ofClass:objc_opt_class()], v14 = objc_claimAutoreleasedReturnValue(), v15, v14)))
  {
    v35 = v12;
    v36 = v7;
    if ([v14 isDiscoveredFullyDownloaded])
    {
      [v14 latestDowloadedAtomicInstanceEntries];
    }

    else
    {
      [v14 discoveredAtomicEntries];
    }
    v17 = ;
    v34 = [MANAutoAssetSetInstanceDescriptor alloc];
    v18 = [v14 clientDomainName];
    v19 = [v14 assetSetIdentifier];
    v20 = [v14 isDiscoveredFullyDownloaded];
    v21 = [v14 neverBeenLocked];
    v22 = [v14 downloadUserInitiated];
    v23 = [v14 downloadedNetworkBytes];
    v24 = [v14 downloadedFilesystemBytes];
    LOBYTE(v33) = [v14 stagedPriorToAvailable];
    v16 = [(MANAutoAssetSetInstanceDescriptor *)v34 initForClientDomainName:v18 forAssetSetIdentifier:v19 withAtomicInstanceEntries:v17 withFullyDownloaded:v20 withNeverBeenLocked:v21 withDownloadUserInitiated:v22 withDownloadedNetworkBytes:v23 withDownloadedFilesystemBytes:v24 withStagedPriorToAvailable:v33];

    v12 = v35;
    v7 = v36;
  }

  else
  {
    v16 = 0;
  }

  v25 = objc_alloc_init(NSMutableDictionary);
  if (v16)
  {
    v26 = [MASAutoAssetSetInstanceDescriptor newShimmedToFramework:v16];
    [v25 setSafeObject:v26 forKey:@"setInstanceInfo"];
  }

  v27 = [SUCoreConnectMessage alloc];
  v28 = [v6 clientRequestMessage];
  v29 = [MADAutoAssetControlManager replyMessageNameForRequest:v28];
  v30 = [v6 clientRequestMessage];
  v31 = [v30 clientID];
  v32 = [v27 initWithType:2 messageName:v29 clientID:v31 version:0 message:v25];

  [(MADAutoAssetControlManager *)v39 issueBuiltResponseForEventInfo:v6 issuingResponseMessage:v32 withResponseError:0 fromLocation:@"handleSetControlClientInstanceInfoRequest"];
  os_activity_scope_leave(&state);
}

+ (BOOL)assetSetToBeIncluded:(id)a3 consideredClientDomain:(id)a4 basedOnControl:(id)a5
{
  v7 = a3;
  v8 = a4;
  v9 = a5;
  v10 = v9;
  if (v9)
  {
    v11 = [v9 limitedToSetIdentifiers];

    if (v11)
    {
      v26 = 0u;
      v27 = 0u;
      v24 = 0u;
      v25 = 0u;
      v12 = [v10 limitedToSetIdentifiers];
      v13 = [v12 countByEnumeratingWithState:&v24 objects:v29 count:16];
      if (v13)
      {
        v14 = *v25;
        while (2)
        {
          for (i = 0; i != v13; i = i + 1)
          {
            if (*v25 != v14)
            {
              objc_enumerationMutation(v12);
            }

            if (([SUCore stringIsEqual:v7 to:*(*(&v24 + 1) + 8 * i)]& 1) != 0)
            {

              goto LABEL_13;
            }
          }

          v13 = [v12 countByEnumeratingWithState:&v24 objects:v29 count:16];
          if (v13)
          {
            continue;
          }

          break;
        }
      }

      goto LABEL_25;
    }

LABEL_13:
    v16 = [v10 limitedToClientDomains];

    if (v16)
    {
      v22 = 0u;
      v23 = 0u;
      v20 = 0u;
      v21 = 0u;
      v12 = [v10 limitedToClientDomains];
      v13 = [v12 countByEnumeratingWithState:&v20 objects:v28 count:16];
      if (v13)
      {
        v17 = *v21;
        while (2)
        {
          for (j = 0; j != v13; j = j + 1)
          {
            if (*v21 != v17)
            {
              objc_enumerationMutation(v12);
            }

            if (([SUCore stringIsEqual:v8 to:*(*(&v20 + 1) + 8 * j)]& 1) != 0)
            {
              LOBYTE(v13) = 1;
              goto LABEL_25;
            }
          }

          v13 = [v12 countByEnumeratingWithState:&v20 objects:v28 count:16];
          if (v13)
          {
            continue;
          }

          break;
        }
      }

LABEL_25:

      goto LABEL_26;
    }
  }

  LOBYTE(v13) = 1;
LABEL_26:

  return v13;
}

- (void)handleSetClientAlterEntriesRepresentingAtomicRequest:(id)a3 forAutoJob:(id)a4 whenCancelingSetJob:(id)a5 alteringFromSetConfiguration:(id)a6
{
  v10 = a3;
  v113 = a4;
  v114 = a5;
  v11 = a6;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v14 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientAlterEntriesRepresentingAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v14, &state);

  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withEventInfo:v10];
  v16 = [v10 clientRequest];
  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v16];

  if (v15)
  {
    v18 = [v15 clientDomainName];
    if (v18)
    {
      v19 = [v15 autoAssetSetClientName];
      if (v19)
      {
        v20 = [v15 assetSetIdentifier];
        if (v20)
        {
          v21 = [v15 autoAssetEntries];
          v22 = v21 == 0;

          if (!v22)
          {
            v23 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:v15];
            v24 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
            v25 = [v24 safeObjectForKey:v23 ofClass:objc_opt_class()];

            if (!v25)
            {
              v34 = [NSString alloc];
              v110 = [v10 summary];
              v35 = [v34 initWithFormat:@"[ALTER] invalid set-eventInfo (no set-identifier to be altered) | set-eventInfo:%@", v110];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6554 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v35];
LABEL_53:

              goto LABEL_16;
            }

            v26 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            v110 = [v26 persistedEntry:v23 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest"];

            if (v110)
            {
              v111 = v11;
              v27 = [v15 autoAssetEntries];
              if (!v27 || ([v15 autoAssetEntries], v28 = objc_claimAutoreleasedReturnValue(), v29 = objc_msgSend(v28, "count") == 0, v28, v27, v29))
              {
                v36 = [NSString alloc];
                v37 = [v10 summary];
                v38 = [v36 initWithFormat:@"[ALTER] no valid asset-entries to alter to | set-eventInfo:%@", v37];
                [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6555 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v38];
              }

              else
              {
                v106 = [(MADAutoAssetControlManager *)self setConfiguration:v111 matchesAssetEntriesFromInfoInstance:v15];
                v30 = [v17 clientAssetSetPolicy];
                v31 = [v30 blockCheckDownload];

                if (v31)
                {
                  v108 = 1;
                }

                else
                {
                  v44 = [v15 autoAssetEntries];
                  v108 = [v44 count] == 0;
                }

                if (v106)
                {
                  v45 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                  {
                    v46 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    v47 = [v15 summary];
                    *buf = 138543618;
                    v117 = v46;
                    v118 = 2114;
                    v119 = v47;
                    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[ALTER] altered without change to auto-asset-entries | setInfoInstance:%{public}@", buf, 0x16u);
                  }
                }

                else if (v114)
                {
                  v45 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                  {
                    v48 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    v49 = [v15 summary];
                    *buf = 138543618;
                    v117 = v48;
                    v118 = 2114;
                    v119 = v49;
                    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[ALTER] altered when canceling set-job | setInfoInstance:%{public}@", buf, 0x16u);
                  }
                }

                else
                {
                  v50 = [v15 clientDomainName];
                  v51 = [v15 assetSetIdentifier];
                  v45 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v50 byIdentifier:v51];

                  if (v45)
                  {
                    if ([v45 beingCanceled])
                    {
                      v52 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
                      {
                        v53 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        v54 = [v10 summary];
                        *buf = 138543618;
                        v117 = v53;
                        v118 = 2114;
                        v102 = v54;
                        v119 = v54;
                        _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[CANCEL-SET-JOB][ALTER] already canceling set-job | set-eventInfo:%{public}@", buf, 0x16u);
                      }
                    }

                    else
                    {
                      v55 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
                      {
                        v56 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        v57 = [v10 summary];
                        *buf = 138543618;
                        v117 = v56;
                        v118 = 2114;
                        v103 = v57;
                        v119 = v57;
                        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[CANCEL-SET-JOB][ALTER] canceling active set-job | set-eventInfo:%{public}@", buf, 0x16u);
                      }

                      [(MADAutoAssetControlManager *)self cancelActiveSetJob:@"handleSetClientAlterEntriesRepresentingAtomicRequest" activeSetJob:v45];
                    }
                  }
                }

                v58 = [v111 newerAtomicInstanceOncePersonalized];
                v59 = v58 == 0;

                if (!v59)
                {
                  [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forSetConfiguration:v111];
                }

                v60 = [MADAutoSetConfiguration alloc];
                v61 = [v15 clientDomainName];
                v100 = [v15 autoAssetSetClientName];
                v98 = [v15 assetSetIdentifier];
                v96 = [v15 autoAssetEntries];
                v104 = objc_opt_self();
                v94 = [v104 discoveredInFlightAtomicInstance];
                v92 = [v111 newerAtomicInstanceOncePersonalized];
                v90 = [v111 latestAtomicInstanceToVend];
                v78 = [v111 latestAtomicInstanceToVendFromPreSUStaging];
                v89 = [v111 previouslyVendedLockedAtomicInstances];
                v77 = [v111 ticksUntilPreviousForceUnlocked];
                v87 = [v111 mostRecentlyReceivedCachedAssetSetID];
                v86 = [v111 mostRecentlyReceivedDownloadedFromLive];
                v85 = [v111 mostRecentlyReceivedLastTimeChecked];
                v84 = [v111 mostRecentlyReceivedPostedDate];
                v83 = [v111 latestToVendCachedAssetSetID];
                v82 = [v111 latestToVendDownloadedFromLive];
                v81 = [v111 latestToVendLastTimeChecked];
                v88 = [v111 latestToVendPostedDate];
                v80 = [v111 availableForUseError];
                v79 = [v111 newerVersionError];
                v62 = [v111 everProvidedLatestToVend];
                BYTE3(v76) = v106;
                BYTE2(v76) = [v111 haveReceivedLookupResponse];
                BYTE1(v76) = v108;
                LOBYTE(v76) = v62;
                LOBYTE(v75) = v78;
                v109 = [MADAutoSetConfiguration initForClientDomainName:v60 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:v61 withAutoAssetEntries:v100 withDiscoveredInFlightAtomicInstance:v98 withNewerAtomicInstanceOncePersonalized:v96 withLatestAtomicInstanceToVend:v94 withLatestAtomicInstanceToVendFromPreSUStaging:v92 withPreviouslyVendedLockedAtomicInstances:v90 withTicksUntilPreviousForceUnlocked:v75 withMostRecentlyReceivedCachedAssetSetID:v89 withMostRecentlyReceivedDownloadedFromLive:v77 withMostRecentlyReceivedLastTimeChecked:v87 withMostRecentlyReceivedPostedDate:v86 withLatestToVendCachedAssetSetID:v85 withLatestToVendDownloadedFromLive:v84 withLatestToVendLastTimeChecked:v83 withLatestToVendPostedDate:v82 withAavailableForUseError:v81 withNewerVersionError:v88 havingEverProvidedLatestToVend:v80 inhibitingImpliedScheduling:v79 havingReceivedLookupResponse:v76 vendingAtomicInstanceForConfiguredEntries:?];

                if (v109)
                {
                  v63 = [v109 latestAtomicInstanceToVend];
                  v64 = v63 == 0;

                  if (!v64)
                  {
                    v65 = [v109 latestAtomicInstanceToVend];
                    v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forAtomicInstanceUUID:v65 requireExists:1];

                    if (v66 && [(MADAutoAssetControlManager *)self doesSetDescriptor:v66 satisfySetConfiguration:v109 allowingMoreDownloaded:0])
                    {
                      [v109 setVendingAtomicInstanceForConfiguredEntries:1];
                    }
                  }

                  [(MADAutoAssetControlManager *)self setConfigurationPersist:v109 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forReason:@"altered autoAssetEntries" dueToAlter:1 forHistoryOperation:449];
                  [MADAutoAssetLookupCache clearLookupResultsForSetConfiguration:v109];
                  if ((v106 & 1) == 0)
                  {
                    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
                    [MADAutoAssetStager controlAlteredSetConfiguration:v109];
                  }

                  v93 = [MANAutoAssetSetInfoInstance alloc];
                  v112 = [v15 clientDomainName];
                  v107 = [v15 autoAssetSetClientName];
                  v105 = [v15 clientProcessName];
                  v91 = [v15 clientProcessID];
                  v101 = [v15 assetSetIdentifier];
                  v95 = [v109 latestAtomicInstanceToVend];
                  v97 = [v15 autoAssetEntries];
                  v99 = [v15 entriesWhenTargeting];
                  v67 = [v15 frameworkInstanceUUID];
                  v37 = [(MANAutoAssetSetInfoInstance *)v93 initUsingClientDomain:v112 forClientName:v107 withProcessName:v105 withProcessID:v91 forAssetSetIdentifier:v101 forAtomicInstance:v95 comprisedOfEntries:v97 asEntriesWhenTargeting:v99 associatingFrameworkUUID:v67];

                  v68 = [v10 clientRequest];
                  v69 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"alterEntriesRepresentingAtomic" forClientRequest:v68 withFoundSetDescriptor:0 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v37 withDesire:v17 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest"];
                  v70 = v68;
                  v38 = v69;

                  v71 = [v10 clientRequest];
                  [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v71 issuingResponseMessage:v38 withResponseError:0];

                  v111 = v109;
                }

                else
                {
                  v72 = [NSString alloc];
                  v37 = [v10 summary];
                  v38 = [v72 initWithFormat:@"[ALTER] unable to allocate set-configuration | set-eventInfo:%@", v37];
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6101 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v38];
                  v111 = 0;
                }
              }

              v73 = [v17 clientAssetSetPolicy];
              v74 = v73 == 0;

              if (v74)
              {
                goto LABEL_52;
              }

              v43 = [v17 clientAssetSetPolicy];
              [(MADAutoAssetControlManager *)self _scheduleSetConfiguration:v111 withClientSetPolicy:v43];
            }

            else
            {
              v39 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
              {
                v40 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v41 = [v10 summary];
                *buf = 138543618;
                v117 = v40;
                v118 = 2114;
                v119 = v41;
                _os_log_impl(&dword_0, v39, OS_LOG_TYPE_ERROR, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest} [ALTER] unable to load persisted-set-configuration file | set-eventInfo:%{public}@", buf, 0x16u);
              }

              v42 = [NSString alloc];
              v111 = [v10 summary];
              v43 = [v42 initWithFormat:@"[ALTER] unable to load persisted-set-configuration file | set-eventInfo:%@", v111];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6101 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v43];
            }

LABEL_52:
            v35 = v111;
            goto LABEL_53;
          }

          goto LABEL_15;
        }
      }
    }

LABEL_15:
    v33 = [NSString alloc];
    v23 = [v10 summary];
    v25 = [v33 initWithFormat:@"[ALTER] incomplete set-eventInfo | set-eventInfo:%@", v23];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v25];
    goto LABEL_16;
  }

  v32 = [NSString alloc];
  v23 = [v10 summary];
  v25 = [v32 initWithFormat:@"[ALTER] invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v23];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v25];
LABEL_16:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientFormSubAtomicRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v43 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientFormSubAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientFormSubAtomicRequest" withEventInfo:v6];
  v11 = [v6 clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v11];

  if (!v10)
  {
    v30 = [NSString alloc];
    v14 = [v6 summary];
    v16 = [v30 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v14];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:v16];
LABEL_20:

    goto LABEL_21;
  }

  v13 = [(MADAutoAssetControlManager *)self atomicInstanceMatchingInfoInstance:@"handleSetClientFormSubAtomicRequest" withSetInfoInstance:v10];
  v14 = v13;
  if (v13)
  {
    v15 = [v13 atomicInstanceUUID];
    v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientFormSubAtomicRequest" forAtomicInstanceUUID:v15 requireExists:0];

    if (v16)
    {
      v44 = 0;
      v42 = [(MADAutoAssetControlManager *)self atomicInstanceNewSubAtomicFromAtomic:v14 forSubsetInfoInstance:v10 error:&v44];
      v17 = v44;
      v41 = v17;
      if (!v42 || v17)
      {
        if (v17)
        {
          v33 = [v17 code];
          v25 = [v41 localizedDescription];
        }

        else
        {
          v25 = @"unable to form sub-atomic-instance is to be formed from is not a known atomic-instance";
          v33 = "/System/Library/PrivateFrameworks/PowerLog.framework/PowerLog" + 56;
        }

        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:v33 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:v25];
        if (!v41)
        {
          goto LABEL_19;
        }
      }

      else
      {
        v18 = [v42 instanceEntries];
        v19 = [v18 count];

        if (v19)
        {
          v20 = [(MADAutoAssetControlManager *)self newSetDescriptorFromAlreadyDownloaded:@"handleSetClientFormSubAtomicRequest" forSetInfoInstance:v10 fromDownloadedSetDescriptor:v16 forAtomicInstance:v42];
          if (!v20)
          {
            v34 = [v42 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"handleSetClientFormSubAtomicRequest" setAtomicInstanceUUID:v34 removingForReason:@"unable to create new set-descriptor" historyOperation:323];

            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6101 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:@"unable to create new set-descriptor associated with the new sub-atomic-instance"];
            goto LABEL_19;
          }
        }

        v35 = [MANAutoAssetSetInfoInstance alloc];
        v40 = [v10 clientDomainName];
        v39 = [v10 autoAssetSetClientName];
        v38 = [v10 clientProcessName];
        v21 = [v10 clientProcessID];
        v37 = [v10 assetSetIdentifier];
        v36 = [v42 atomicInstanceUUID];
        v22 = [v10 autoAssetEntries];
        v23 = [v10 entriesWhenTargeting];
        v24 = [v10 frameworkInstanceUUID];
        v25 = [(MANAutoAssetSetInfoInstance *)v35 initUsingClientDomain:v40 forClientName:v39 withProcessName:v38 withProcessID:v21 forAssetSetIdentifier:v37 forAtomicInstance:v36 comprisedOfEntries:v22 asEntriesWhenTargeting:v23 associatingFrameworkUUID:v24];

        v26 = [v6 clientRequest];
        v27 = [v42 atomicInstanceUUID];
        v28 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"formSubAtomicInstance" forClientRequest:v26 withFoundSetDescriptor:0 withSubAtomicInstance:v27 forLatestDownloaded:1 withInstance:v25 withDesire:v12 fromLocation:@"handleSetClientFormSubAtomicRequest"];

        v29 = [v6 clientRequest];
        [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v29 issuingResponseMessage:v28 withResponseError:0];
      }

LABEL_19:
      goto LABEL_20;
    }

    v31 = @"atomic-instance that sub-atomic-instance is to be formed from has no associated set-descriptor (orphaned atomic-instance)";
    v32 = 6557;
  }

  else
  {
    v31 = @"atomic-instance that sub-atomic-instance is to be formed from is not a known atomic-instance";
    v32 = 6551;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:v32 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:v31];
LABEL_21:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientContinueAtomicLockRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v24 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientContinueAtomicLockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientContinueAtomicLockRequest" withEventInfo:v6];
  v11 = [v6 clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v11];

  if (!v10)
  {
    v23 = [NSString alloc];
    v14 = [v6 summary];
    v19 = [v23 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v14];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:v19];
LABEL_8:

    goto LABEL_9;
  }

  v13 = [v10 atomicInstance];
  v14 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientContinueAtomicLockRequest" forAtomicInstanceUUID:v13 requireExists:0];

  if (v14)
  {
    v15 = [v10 autoAssetSetClientName];
    v16 = [v12 desireReason];
    v17 = [v12 clientAssetSetPolicy];
    v25 = 0;
    v18 = [MADAutoAssetLocker continuedSetLockByClient:v15 forSetDescriptor:v14 forLockReason:v16 withSetUsagePolicy:v17 continueError:&v25];
    v19 = v25;

    if (v18)
    {
      v20 = [v6 clientRequest];
      v21 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"continueAtomicLock" forClientRequest:v20 withFoundSetDescriptor:v14 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v10 withDesire:v12 fromLocation:@"handleSetClientContinueAtomicLockRequest"];

      v22 = [v6 clientRequest];
      [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v22 issuingResponseMessage:v21 withResponseError:0];
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withAutoAssetError:v19 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:@"failed lock continuation of auto-asset-set"];
    }

    goto LABEL_8;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6551 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:@"atomic-instance lock to be continued for unknown atomic-instance [presumed retired]"];
LABEL_9:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEndAtomicLockRequest:(id)a3 forAutoJob:(id)a4
{
  v6 = a3;
  v38 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEndAtomicLockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEndAtomicLockRequest" withEventInfo:v6];
  v11 = [v6 clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v11];

  if (!v10)
  {
    v19 = [NSString alloc];
    v14 = [v6 summary];
    v17 = [v19 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v14];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:v17];
    goto LABEL_23;
  }

  v13 = [v10 atomicInstance];
  v14 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientEndAtomicLockRequest" forAtomicInstanceUUID:v13 requireExists:0];

  if (v14)
  {
    if (![(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:v14])
    {
      v18 = 0;
LABEL_9:
      v20 = [v10 autoAssetSetClientName];
      v21 = [v12 desireReason];
      v39 = v18;
      v22 = [MADAutoAssetLocker endedPreviousSetLocksByClient:v20 forSetDescriptor:v14 forLockReason:v21 removingLockCount:1 endError:&v39];
      v17 = v39;

      if (v22)
      {
        v23 = [v12 desireReason];
        [(MADAutoAssetControlManager *)self setLockUsageMapEndedLockForSetDescriptor:v14 forLockReason:v23 endedLockCount:1];

        if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientEndAtomicLockRequest" forSetDescriptor:v14])
        {
          v24 = 0;
        }

        else
        {
          v25 = [v14 clientDomainName];
          v26 = [v14 assetSetIdentifier];
          v37 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v25 forAssetSetIdentifier:v26];

          [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLockRequest" forSetDescriptorNoLongerLocked:v14];
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:v14];
          }

          v27 = [v37 latestAtomicInstanceToVend];
          v28 = [v14 latestDownloadedAtomicInstance];
          if (([SUCore stringIsEqual:v27 to:v28]& 1) != 0)
          {
            v29 = v37;
            v24 = 0;
          }

          else
          {
            v30 = [v14 clientDomainName];
            v31 = [v14 assetSetIdentifier];
            v32 = [(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:@"handleSetClientEndAtomicLockRequest" forClientDomainName:v30 ofSetIdentifier:v31];
            v33 = v31;
            v36 = v30;
            v29 = v37;
            v24 = v32 ^ 1;
          }
        }

        [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLockRequest" setDescriptor:v14 allowRemovalWithoutNewerDescriptor:0];
        if (v24)
        {
          [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v14 fromLocation:@"handleSetClientEndAtomicLockRequest" checkingByInstance:1 regardlessOfLatest:0 historyOperationAI:322 historyOperationSD:376];
        }

        v34 = [v14 clientDomainName];
        v35 = [v14 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLockRequest" forClientDomain:v34 forAssetSetIdentifier:v35];

        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:0 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"successful end of atomic-lock of auto-asset-set (for client-specified criteria)"];
      }

      else
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withAutoAssetError:v17 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"failed to end previous atomic-lock of auto-asset-set (for client-specified criteria)"];
      }

      goto LABEL_23;
    }

    v40 = 0;
    v15 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLockRequest" forSetDescriptor:v14 endingAll:0 performingHardEliminate:0 error:&v40];
    v16 = v40;
    v17 = v16;
    if (v15)
    {
      v18 = v16;
      goto LABEL_9;
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withAutoAssetError:v16 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"failed to end SHORT-TERM locking of set-descriptor"];
LABEL_23:

    goto LABEL_24;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6551 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"atomic-instance lock to be ended for unknown atomic-instance [presumed retired]"];
LABEL_24:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEndAtomicLocksForClientRequest:(id)a3 forAutoJob:(id)a4
{
  v60 = a3;
  v57 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEndAtomicLocksForClientRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v64 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEndAtomicLocksForClientRequest" withEventInfo:v60];
  v9 = [v60 clientRequest];
  v58 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v9];

  v10 = [v60 clientRequest];
  v59 = [(MADAutoAssetControlManager *)self clientRequestMessageSetEnd:v10];

  if (!v64)
  {
    v34 = [NSString alloc];
    v63 = [v60 summary];
    v35 = [v34 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", v63];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:v35];
    goto LABEL_55;
  }

  if (!v59)
  {
    v36 = [NSString alloc];
    v63 = [v60 summary];
    v35 = [v36 initWithFormat:@"invalid set-eventInfo (end:MISSING) | set-eventInfo:%@", v63];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:v35];
    goto LABEL_55;
  }

  v11 = [v64 atomicInstance];
  v12 = [v11 isEqualToString:@"ALL_INSTANCES"];

  if (v12)
  {
    v13 = [v64 clientDomainName];
    v14 = [v64 assetSetIdentifier];
    v63 = [(MADAutoAssetControlManager *)self setLockUsageMapForClientDomain:v13 forSetIdentifier:v14];

    if (!v63)
    {
      v41 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
      {
        v42 = [v64 clientDomainName];
        v43 = [v64 assetSetIdentifier];
        *buf = 138543618;
        v80 = v42;
        v81 = 2114;
        v82 = v43;
        _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "{handleSetClientEndAtomicLocksForClientRequest} No lock is held when requesting to end all locks in all atomic and sub-atomic instances for domain: %{public}@, setID: %{public}@", buf, 0x16u);
      }

      goto LABEL_53;
    }

    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      v16 = [v64 clientDomainName];
      v17 = [v64 assetSetIdentifier];
      *buf = 138543618;
      v80 = v16;
      v81 = 2114;
      v82 = v17;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "{handleSetClientEndAtomicLocksForClientRequest} Ending all locks in all atomic and sub-atomic instances for domain: %{public}@, setID: %{public}@", buf, 0x16u);
    }

    v18 = objc_alloc_init(NSMutableArray);
    v19 = [v64 clientDomainName];
    v20 = [v64 assetSetIdentifier];
    v21 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v19 assetSetIdentifier:v20];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"handleSetClientEndAtomicLocksForClientRequest" ofContainer:@"setDescriptorKeysForAssetSet"];
    v74 = 0u;
    v75 = 0u;
    v72 = 0u;
    v73 = 0u;
    obj = v21;
    v22 = [obj countByEnumeratingWithState:&v72 objects:v78 count:16];
    if (!v22)
    {
      v61 = 0;
      goto LABEL_41;
    }

    v61 = 0;
    v23 = *v73;
    while (1)
    {
      for (i = 0; i != v22; i = i + 1)
      {
        if (*v73 != v23)
        {
          objc_enumerationMutation(obj);
        }

        v25 = *(*(&v72 + 1) + 8 * i);
        v26 = objc_autoreleasePoolPush();
        v27 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v25];
        v28 = v27;
        if (v27)
        {
          v29 = [v27 latestDownloadedAtomicInstance];
          v30 = [(MADAutoAssetControlManager *)self setLockUsageMapForAtomicInstance:v29 clientLockUsageMap:v63 lockReason:0]> 0;

          if (v30)
          {
            if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:v28])
            {
              v71 = 0;
              v31 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest(ALL)" forSetDescriptor:v28 endingAll:1 performingHardEliminate:0 error:&v71];
              v32 = v71;
              v33 = v32;
              if ((v31 & 1) == 0)
              {
                if (!v61)
                {
                  v33 = v32;
                  v61 = v33;
                }

                goto LABEL_20;
              }
            }

            else
            {
              v33 = 0;
            }

            [v18 addObject:v28];
LABEL_20:
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v22 = [obj countByEnumeratingWithState:&v72 objects:v78 count:16];
      if (!v22)
      {
LABEL_41:

        v69 = 0u;
        v70 = 0u;
        v67 = 0u;
        v68 = 0u;
        v41 = v18;
        v50 = [v41 countByEnumeratingWithState:&v67 objects:v77 count:16];
        if (v50)
        {
          v51 = *v68;
          do
          {
            for (j = 0; j != v50; j = j + 1)
            {
              if (*v68 != v51)
              {
                objc_enumerationMutation(v41);
              }

              v53 = *(*(&v67 + 1) + 8 * j);
              [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptorNoLongerLocked:v53];
              if (__isPlatformVersionAtLeast(2, 18, 4, 0))
              {
                [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:v53];
              }

              v54 = [v64 autoAssetSetClientName];
              [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:v54 forSetDescriptor:v53];

              [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLocksForClientRequest" setDescriptor:v53 allowRemovalWithoutNewerDescriptor:0];
            }

            v50 = [v41 countByEnumeratingWithState:&v67 objects:v77 count:16];
          }

          while (v50);
        }

        if (v61)
        {

          v35 = v61;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withAutoAssetError:v61 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end all locks due to SHORT-TERM locks"];
          goto LABEL_55;
        }

        v55 = [v64 clientDomainName];
        v56 = [v64 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:v55 forSetIdentifier:v56];

LABEL_53:
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withErrorCode:0 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"Completed end of all atomic-locks of auto-asset-set for MA_END_ATOMIC_LOCKS_ALL_INSTANCES request"];
        v48 = [v64 clientDomainName];
        v49 = [v64 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLocksForClientRequest" forClientDomain:v48 forAssetSetIdentifier:v49];
        v35 = 0;
LABEL_54:

LABEL_55:
        goto LABEL_56;
      }
    }
  }

  v37 = [v64 atomicInstance];
  v63 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest" forAtomicInstanceUUID:v37 requireExists:0];

  if (v63)
  {
    if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:?])
    {
      v66 = 0;
      v38 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest(specific)" forSetDescriptor:v63 endingAll:0 performingHardEliminate:0 error:&v66];
      v39 = v66;
      v35 = v39;
      if ((v38 & 1) == 0)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withAutoAssetError:v39 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end standard-lock due to SHORT-TERM locks"];
        goto LABEL_55;
      }

      v40 = v39;
    }

    else
    {
      v40 = 0;
    }

    v44 = [v64 autoAssetSetClientName];
    v45 = [v58 desireReason];
    v65 = v40;
    v46 = +[MADAutoAssetLocker endedPreviousSetLocksByClient:forSetDescriptor:forLockReason:removingLockCount:endError:](MADAutoAssetLocker, "endedPreviousSetLocksByClient:forSetDescriptor:forLockReason:removingLockCount:endError:", v44, v63, v45, [v59 endLockCount], &v65);
    v35 = v65;

    if (!v46)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withAutoAssetError:v35 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end previous atomic-locks of auto-asset-set (for client-specified criteria)"];
      goto LABEL_55;
    }

    v47 = [v58 desireReason];
    -[MADAutoAssetControlManager setLockUsageMapEndedLockForSetDescriptor:forLockReason:endedLockCount:](self, "setLockUsageMapEndedLockForSetDescriptor:forLockReason:endedLockCount:", v63, v47, [v59 endLockCount]);

    if (![(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptor:v63])
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptorNoLongerLocked:v63];
      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:v63];
      }
    }

    [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLocksForClientRequest" setDescriptor:v63 allowRemovalWithoutNewerDescriptor:0];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withErrorCode:0 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"successful end of atomic-locks of auto-asset-set (for client-specified criteria)"];
    v48 = [v63 clientDomainName];
    v49 = [v63 assetSetIdentifier];
    [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLocksForClientRequest" forClientDomain:v48 forAssetSetIdentifier:v49];
    goto LABEL_54;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v60 withErrorCode:6551 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"atomic-instance locks to be ended for unknown atomic-instance [presumed retired]"];
LABEL_56:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientAssetSetForStagingRequest:(id)a3 forAutoJob:(id)a4
{
  v53 = a3;
  v52 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientAssetSetForStagingRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientAssetSetForStagingRequest" withEventInfo:v53];
  v57 = v9;
  if (!v9)
  {
    v17 = @"setInfoInstance is not provided in request | MISSING REQUIRED FIELD";
LABEL_9:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v53 withErrorCode:6103 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:v17];
    v18 = v57;
    goto LABEL_30;
  }

  v10 = [v9 entriesWhenTargeting];
  v11 = v10 == 0;

  if (v11)
  {
    v17 = @"no set-target entries provided in request | MISSING REQUIRED FIELD";
    goto LABEL_9;
  }

  v12 = [v57 clientDomainName];
  v13 = [v57 assetSetIdentifier];
  v51 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v12 forAssetSetIdentifier:v13];

  if (v51)
  {
    if ([(MADAutoAssetControlManager *)self setTargetPersistedMatchesClientSpecified:v57])
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v16 = [v57 summary];
        *buf = 138543618;
        v65 = v15;
        v66 = 2114;
        v67 = v16;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAssetSetForStagingRequest}\n[SET-TARGETS] client-specified set-target matches already-persisted | setInfoInstance:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v23 = [v57 clientDomainName];
      v24 = [v57 assetSetIdentifier];
      [(MADAutoAssetControlManager *)self removeSetTargetsForClientDomain:v23 forSetIdentifier:v24 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

      [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
      v25 = [v57 entriesWhenTargeting];
      [MADAutoAssetStager controlSetTargetsSpecified:v25];

      v60 = 0u;
      v61 = 0u;
      v58 = 0u;
      v59 = 0u;
      obj = [v57 entriesWhenTargeting];
      v26 = [obj countByEnumeratingWithState:&v58 objects:v63 count:16];
      v14 = obj;
      if (v26)
      {
        v55 = *v59;
        do
        {
          v56 = v26;
          for (i = 0; i != v56; i = i + 1)
          {
            if (*v59 != v55)
            {
              objc_enumerationMutation(obj);
            }

            v28 = *(*(&v58 + 1) + 8 * i);
            v29 = objc_autoreleasePoolPush();
            if (v28)
            {
              v30 = [v57 clientDomainName];
              v31 = [v57 assetSetIdentifier];
              v32 = [(MADAutoAssetControlManager *)self newSetTargetFromClientProvidedSetTarget:v28 forClientDomainName:v30 forSetIdentifier:v31];

              v33 = [v32 clientDomainName];
              v34 = [v32 assetSetIdentifier];
              v35 = [(MADAutoAssetControlManager *)self setTargetNewEntryIDForClientDomainName:v33 forAssetSetIdentifier:v34 forClientProvidedSetTarget:v28];

              v36 = [(MADAutoAssetControlManager *)self persistedSetTargets];
              LODWORD(v33) = [v36 persistedEntryAlreadyExists:v35 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

              v37 = @"ENTRY_ADD";
              if (v33)
              {
                v38 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                v39 = [v38 diag];
                v40 = [NSString alloc];
                v41 = [v32 summary];
                v42 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v43 = [v40 initWithFormat:@"{handleSetClientAssetSetForStagingRequest} persisted-entry already exists when should have just been removed | setTarget:%@ | %@", v41, v42];
                [v39 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v43 withResult:6109 withError:0];

                v37 = @"ENTRY_MODIFY";
              }

              v44 = [(MADAutoAssetControlManager *)self persistedSetTargets];
              v45 = [v44 persistedEntry:v35 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

              if (v45)
              {
                [v45 persistSecureCodedObject:v32 forKey:@"setTarget"];
                v46 = [(MADAutoAssetControlManager *)self persistedSetTargets];
                v47 = [v32 summary];
                [v46 storePersistedEntry:v35 withEntrySummary:v47 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

                [(MADAutoAssetControlManager *)self _logPersistedSetTarget:@"handleSetClientAssetSetForStagingRequest" operation:v37 forPersistedEntryID:v35 withSetTarget:v32 message:@"new set-target"];
              }

              else
              {
                v48 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
                {
                  v49 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  v50 = [v32 summary];
                  *buf = 138543618;
                  v65 = v49;
                  v66 = 2114;
                  v67 = v50;
                  _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "[%{public}@] {handleSetClientAssetSetForStagingRequest} unable to load persisted-set-target file | setTarget:%{public}@", buf, 0x16u);
                }
              }
            }

            objc_autoreleasePoolPop(v29);
          }

          v26 = [obj countByEnumeratingWithState:&v58 objects:v63 count:16];
        }

        while (v26);
        v14 = obj;
      }
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v53 withErrorCode:0 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:@"successfully defined asset-set-for-staging"];
  }

  else
  {
    v19 = [NSString alloc];
    v20 = [v57 clientDomainName];
    v21 = [v57 assetSetIdentifier];
    v22 = [v19 initWithFormat:@"set-identifier (for given client-domain-name) is not currently defined | clientDomainName:%@ | assetSetIdentifier:%@", v20, v21];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v53 withErrorCode:6558 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:v22];
  }

  v18 = v57;
LABEL_30:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEliminateAtomicRequest:(id)a3 whenCancelingSetJob:(id)a4 forAutoJob:(id)a5
{
  v34 = a3;
  v32 = a4;
  v30 = a5;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEliminateAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v33 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEliminateAtomicRequest" withEventInfo:v34];
  v11 = [v34 clientRequest];
  v31 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v11];

  if (v33)
  {
    v12 = [v33 clientDomainName];
    v13 = v12 == 0;

    if (v13)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v34 withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"instance missing client-domain-name when required for eliminate request"];
      v25 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
      {
        v28 = [v34 summary];
        *buf = 138543362;
        v42 = v28;
        _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] instance missing client-domain-name when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      v14 = [v33 assetSetIdentifier];
      v15 = v14 == 0;

      if (v15)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v34 withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"instance missing asset-set-identifier when required for eliminate request"];
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          v29 = [v34 summary];
          *buf = 138543362;
          v42 = v29;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] instance missing asset-set-identifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
        }
      }

      else
      {
        if (v32)
        {
          v16 = [v32 queuedRequestsForNewJobOnceCanceled];
          v17 = v16 == 0;

          if (!v17)
          {
            v37 = 0u;
            v38 = 0u;
            v35 = 0u;
            v36 = 0u;
            v18 = [v32 queuedRequestsForNewJobOnceCanceled];
            v19 = [v18 countByEnumeratingWithState:&v35 objects:v40 count:16];
            if (v19)
            {
              v20 = *v36;
              do
              {
                for (i = 0; i != v19; i = i + 1)
                {
                  if (*v36 != v20)
                  {
                    objc_enumerationMutation(v18);
                  }

                  v22 = *(*(&v35 + 1) + 8 * i);
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v22 withErrorCode:6115 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"client-request that had been waiting for set-job to be canceled when set was eliminated"];
                  v23 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                  {
                    v24 = [v22 summary];
                    *buf = 138543362;
                    v42 = v24;
                    _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} failed client-request that had been waiting for cancel to complete when eliminated | dropEventInfo:%{public}@", buf, 0xCu);
                  }
                }

                v19 = [v18 countByEnumeratingWithState:&v35 objects:v40 count:16];
              }

              while (v19);
            }

            [v32 setQueuedRequestsForNewJobOnceCanceled:0];
          }
        }

        v25 = [v33 clientDomainName];
        v26 = [v33 assetSetIdentifier];
        -[MADAutoAssetControlManager _eliminateAtomicTriggeredByClient:forClientDomainName:forAssetSetIdentifier:awaitingUnlocked:](self, "_eliminateAtomicTriggeredByClient:forClientDomainName:forAssetSetIdentifier:awaitingUnlocked:", v34, v25, v26, [v31 awaitDownloadingOfDiscovered]);
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v34 withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"no instance provided in client eliminate request"];
    v25 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
    {
      v27 = [v34 summary];
      *buf = 138543362;
      v42 = v27;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] no instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
}

- (void)_eliminateAtomicTriggeredWhileLoading:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a5;
  v9 = a4;
  v12 = a3;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  [(MADAutoAssetControlManager *)self _eliminateForgetAtomicLostToVend:v12 forClientDomainName:v9 forAssetSetIdentifier:v8];
  [(MADAutoAssetControlManager *)self setConfigurationEliminate:v12 forClientDomainName:v9 forAssetSetIdentifier:v8];
}

- (void)_eliminateForgetAtomicLostToVend:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v56 = v8;
  v13 = [[NSString alloc] initWithFormat:@"%@:_eliminateForgetAtomicLostToVend", v8];
  v14 = objc_alloc_init(NSMutableArray);
  v64 = v9;
  v59 = v10;
  v15 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v9 assetSetIdentifier:v10];
  v60 = v13;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v13 ofContainer:@"setDescriptorKeysForAssetSet"];
  v79 = 0u;
  v80 = 0u;
  v77 = 0u;
  v78 = 0u;
  obj = v15;
  v16 = [obj countByEnumeratingWithState:&v77 objects:v84 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v78;
    do
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v78 != v18)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v77 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        v22 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v20];
        if (v22)
        {
          v23 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v22];

          if (v23)
          {
            [(MADAutoAssetControlManager *)self _forceSetUngraftAndEliminateAllSetLocks:v60 forSetDescriptor:v22];
            [(MADAutoAssetControlManager *)self _shortTermForceForget:v60 forSetDescriptor:v22];
          }

          [v14 addObject:v22];
        }

        objc_autoreleasePoolPop(v21);
      }

      v17 = [obj countByEnumeratingWithState:&v77 objects:v84 count:16];
    }

    while (v17);
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  v62 = v14;
  v24 = [v62 countByEnumeratingWithState:&v73 objects:v83 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v74;
    do
    {
      for (j = 0; j != v25; j = j + 1)
      {
        if (*v74 != v26)
        {
          objc_enumerationMutation(v62);
        }

        v28 = *(*(&v73 + 1) + 8 * j);
        v29 = objc_autoreleasePoolPush();
        v30 = [v28 latestDownloadedAtomicInstance];
        v31 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v30];

        if (v31)
        {
          [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v60 dueToError:0 forgettingAtomicInstance:v31];
        }

        else
        {
          [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v28 fromLocation:v60 checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:326 historyOperationSD:370];
          [(MADAutoAssetControlManager *)self _forceSetUngraftAndEliminateAllSetLocks:v60 forSetDescriptor:v28];
          [(MADAutoAssetControlManager *)self _shortTermForceForget:v60 forSetDescriptor:v28];
        }

        objc_autoreleasePoolPop(v29);
      }

      v25 = [v62 countByEnumeratingWithState:&v73 objects:v83 count:16];
    }

    while (v25);
  }

  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:v64 forSetIdentifier:v59];
  [(MADAutoAssetControlManager *)self atomicInstanceEliminate:v60 forClientDomainName:v64 forAssetSetIdentifier:v59];
  v57 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v60 ofContainer:@"currentSetStatusByInstance"];
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  v61 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v32 = [v61 countByEnumeratingWithState:&v69 objects:v82 count:16];
  if (v32)
  {
    v33 = v32;
    v34 = *v70;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v58 = self;
    do
    {
      for (k = 0; k != v33; k = k + 1)
      {
        if (*v70 != v34)
        {
          objc_enumerationMutation(v61);
        }

        v37 = *(*(&v69 + 1) + 8 * k);
        v38 = objc_autoreleasePoolPush();
        v39 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v37];
        v40 = v39;
        if (v37)
        {
          v41 = p_weak_ivar_lyt[223];
          v42 = [v39 clientDomainName];
          if ([v41 stringIsEqual:v42 to:v64])
          {
            v43 = p_weak_ivar_lyt[223];
            [v40 assetSetIdentifier];
            v44 = v33;
            v45 = v34;
            v47 = v46 = p_weak_ivar_lyt;
            LODWORD(v43) = [v43 stringIsEqual:v47 to:v59];

            p_weak_ivar_lyt = v46;
            v34 = v45;
            v33 = v44;
            self = v58;

            if (v43)
            {
              [v57 addObject:v37];
            }
          }

          else
          {
          }
        }

        objc_autoreleasePoolPop(v38);
      }

      v33 = [v61 countByEnumeratingWithState:&v69 objects:v82 count:16];
    }

    while (v33);
  }

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v48 = v57;
  v49 = [v48 countByEnumeratingWithState:&v65 objects:v81 count:16];
  if (v49)
  {
    v50 = v49;
    v51 = *v66;
    do
    {
      for (m = 0; m != v50; m = m + 1)
      {
        if (*v66 != v51)
        {
          objc_enumerationMutation(v48);
        }

        v53 = *(*(&v65 + 1) + 8 * m);
        v54 = objc_autoreleasePoolPush();
        v55 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
        [v55 removeObjectForKey:v53];

        objc_autoreleasePoolPop(v54);
      }

      v50 = [v48 countByEnumeratingWithState:&v65 objects:v81 count:16];
    }

    while (v50);
  }
}

- (void)_eliminateAtomicTriggeredByClient:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 awaitingUnlocked:(BOOL)a6
{
  v6 = a6;
  v24 = a3;
  v10 = a4;
  v11 = a5;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [[MAAutoAssetSelector alloc] initForAssetType:v10 withAssetSpecifier:v11];
  v15 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v16 = [v14 persistedEntryID];
  v17 = [v15 safeObjectForKey:v16 ofClass:objc_opt_class()];

  if (v17)
  {
    if (![v17 awaitingUnlocked] || v6)
    {
      v18 = [NSString alloc];
      v19 = [v14 summary];
      v20 = [v18 initWithFormat:@"eliminate-atomic when already eliminating (and not changing from soft to hard eliminate) | eliminateSelector:%@", v19];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v24 withErrorCode:6114 fromAction:@"_eliminateAtomicTriggeredByClient" withDescription:v20];

      goto LABEL_9;
    }
  }

  else
  {
    v21 = [NSString alloc];
    v22 = @"N";
    if (v6)
    {
      v22 = @"Y";
    }

    v23 = [v21 initWithFormat:@"_eliminateAtomicTriggeredByClient(awaitUnlocked:%@)", v22];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_ELIMINATED" forClientDomainName:v10 forAssetSetIdentifier:v11 forAtomicInstanceUUID:0 fromModule:@"AUTO-CONTROL" fromLocation:v23];
  }

  [(MADAutoAssetControlManager *)self setDescriptorEliminate:@"_eliminateAtomicTriggeredByClient" triggeredByClient:v24 forClientDomainName:v10 forAssetSetIdentifier:v11 awaitingUnlocked:v6];
LABEL_9:
}

- (id)buildSetFoundResponseMessage:(id)a3 forClientRequest:(id)a4 withFoundSetDescriptor:(id)a5 withSubAtomicInstance:(id)a6 forLatestDownloaded:(BOOL)a7 withInstance:(id)a8 withDesire:(id)a9 fromLocation:(id)a10
{
  v48 = a3;
  v15 = a4;
  v16 = a8;
  v49 = a9;
  v52 = a10;
  v17 = a6;
  v18 = a5;
  v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v20 = [v19 extendedStateQueue];
  dispatch_assert_queue_V2(v20);

  v51 = objc_alloc_init(NSMutableDictionary);
  v21 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v15];
  v50 = v15;
  if (([SUCore stringIsEqual:v21 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0)
  {
    v22 = 1;
  }

  else
  {
    v23 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v15];
    v22 = [SUCore stringIsEqual:v23 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];
  }

  v24 = [v16 clientDomainName];
  v25 = [v16 assetSetIdentifier];
  v26 = [v16 atomicInstance];
  LOBYTE(v47) = v22;
  v27 = [(MADAutoAssetControlManager *)self buildReportedSetStatus:v52 forClientDomainName:v24 forSetIdentifier:v25 forAtomicInstance:v26 withFoundSetDescriptor:v18 withSubAtomicInstance:v17 reportingLocalContentURLs:v47];

  if (!v27)
  {
    v30 = 0;
    v41 = v48;
    v40 = v50;
LABEL_10:
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
      v43 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v44 = [v40 summary];
      if (v30)
      {
        v45 = [v30 summary];
      }

      else
      {
        v45 = @"N";
      }

      *buf = 138544386;
      v54 = v43;
      v55 = 2114;
      v56 = v52;
      v57 = 2114;
      v58 = v41;
      v59 = 2114;
      v60 = v44;
      v61 = 2114;
      v62 = v45;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:buildSetFoundResponseMessage} unable to build response for %{public}@ request | clientRequest:%{public}@ | found:%{public}@", buf, 0x34u);
      if (v30)
      {
      }
    }

    v39 = 0;
    v33 = v49;
    goto LABEL_18;
  }

  v28 = [MANAutoAssetSetInfoFound alloc];
  v29 = [v27 assetSetIdentifier];
  v30 = [(MANAutoAssetSetInfoFound *)v28 initForAssetSetIdentifier:v29 reportingStatus:v27];

  v31 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v16];
  [v51 setSafeObject:v31 forKey:@"setInstance"];

  v32 = [MASAutoAssetSetInfoFound newShimmedToFramework:v30];
  [v51 setSafeObject:v32 forKey:@"setFound"];

  v33 = v49;
  if (v49)
  {
    v34 = [MASAutoAssetSetInfoDesire newShimmedToFramework:v49];
    [v51 setSafeObject:v34 forKey:@"setDesire"];
  }

  v35 = [SUCoreConnectMessage alloc];
  v36 = [v50 clientRequestMessage];
  v37 = [MADAutoAssetControlManager replyMessageNameForRequest:v36];
  v38 = [v50 clientID];
  v39 = [v35 initWithType:2 messageName:v37 clientID:v38 version:0 message:v51];

  v40 = v50;
  v41 = v48;
  if (!v39)
  {
    goto LABEL_10;
  }

LABEL_18:

  return v39;
}

- (id)buildReportedSetStatus:(id)a3 forClientDomainName:(id)a4 forSetIdentifier:(id)a5 forAtomicInstance:(id)a6 withFoundSetDescriptor:(id)a7 withSubAtomicInstance:(id)a8 reportingLocalContentURLs:(BOOL)a9
{
  v15 = a3;
  v16 = a4;
  v17 = a5;
  v18 = a7;
  v107 = a8;
  v19 = a6;
  v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v21 = [v20 extendedStateQueue];
  dispatch_assert_queue_V2(v21);

  v22 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:v19 elseByClientDomain:0 forAssetSetIdentifier:0 fromLocation:v15];

  v23 = [v18 latestDowloadedAtomicInstanceEntries];
  v131 = v16;
  v24 = v16;
  v25 = v17;
  v132 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v24 forAssetSetIdentifier:v17];
  v26 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v18];
  LODWORD(v19) = [MADAutoAssetSecure doesSetDescriptorInvolveSecureOperations:v15 forSetDescriptor:v18 withAutoAssetDescriptors:v26];

  if (v19)
  {
    v133[0] = 0;
    v27 = [MADAutoAssetSecure latestDownloadedAtomicInstanceEntries:v15 forSetDescriptor:v18 withAvailableForUseError:v133];
    v28 = v133[0];

    v23 = v27;
  }

  else
  {
    v28 = 0;
  }

  v29 = [v132 availableForUseError];
  v30 = [(MADAutoAssetControlManager *)self statusErrorConsideredMatch:v28 to:v29];

  if ((v30 & 1) == 0)
  {
    if (v28)
    {
      if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v28])
      {
        [(MADAutoAssetControlManager *)self forceGlobalSetUnlock:v15 dueToError:v28 ofSetDescriptor:v18 historyOperationAI:1503 historyOperationSD:394];
      }

      v31 = [v132 availableForUseError];

      if (v31)
      {
        v32 = 9999;
      }

      else
      {
        v32 = 460;
      }

      [v132 setAvailableForUseError:v28];
      v33 = @"reporting set-status when attempt to form all localConentURLs failed to access all secure asset-versions";
      v34 = self;
      v35 = v132;
      v36 = v15;
      v37 = v32;
    }

    else
    {
      [v132 setAvailableForUseError:0];
      v33 = @"reporting set-status when attempt to form all localConentURLs gained access all secure asset-versions";
      v34 = self;
      v35 = v132;
      v36 = v15;
      v37 = 461;
    }

    [(MADAutoAssetControlManager *)v34 setConfigurationPersist:v35 fromLocation:v36 forReason:v33 dueToAlter:0 forHistoryOperation:v37];
  }

  v106 = v28;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v39 = v25;
  v109 = v18;
  v108 = v23;
  v110 = v25;
  if (v22 || ([v18 latestDownloadedAtomicInstance], v40 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:](self, "locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:", v40, 0, 0, v15), v22 = objc_claimAutoreleasedReturnValue(), v40, v22) || (objc_msgSend(v18, "discoveredAtomicInstance"), v41 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:](self, "locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:", v41, 0, 0, v15), v22 = objc_claimAutoreleasedReturnValue(), v41, v22))
  {
    if (v18)
    {
      v42 = [v22 currentNotifications];
      [v42 setAtomicInstanceDiscovered:1];

      v43 = [v22 currentNotifications];
      [v43 setAtomicInstanceAvailableForUse:1];

      v44 = [v22 atomicInstancesDownloaded];

      if (!v44)
      {
        v45 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDArrayForSetDescriptor:v18];
        [v22 setAtomicInstancesDownloaded:v45];
      }

      v46 = [v18 latestDownloadedAtomicInstance];
      [v22 setLatestDownloadedAtomicInstance:v46];

      [v22 setLatestDowloadedAtomicInstanceEntries:v23];
    }

    v47 = [v132 availableForUseError];
    [v22 setAvailableForUseError:v47];

    v48 = [v132 newerVersionError];
    [v22 setNewerVersionError:v48];

    v49 = [v22 catalogCachedAssetSetID];

    if (!v49)
    {
      v50 = [v18 catalogCachedAssetSetID];
      [v22 setCatalogCachedAssetSetID:v50];

      v51 = [v18 catalogDownloadedFromLive];
      [v22 setCatalogDownloadedFromLive:v51];

      v52 = [v18 catalogLastTimeChecked];
      [v22 setCatalogLastTimeChecked:v52];

      v53 = [v18 catalogPostedDate];
      [v22 setCatalogPostedDate:v53];
    }

    v54 = [v22 downloadedCatalogCachedAssetSetID];

    if (!v54)
    {
      v55 = [v18 downloadedCatalogCachedAssetSetID];
      [v22 setDownloadedCatalogCachedAssetSetID:v55];

      v56 = [v18 downloadedCatalogDownloadedFromLive];
      [v22 setDownloadedCatalogDownloadedFromLive:v56];

      v57 = [v18 downloadedCatalogLastTimeChecked];
      [v22 setDownloadedCatalogLastTimeChecked:v57];

      v58 = [v18 downloadedCatalogPostedDate];
      [v22 setDownloadedCatalogPostedDate:v58];
    }

    [(MADAutoAssetControlManager *)self _updateCurrentSetStatus:@"FOUND_SET_STATUS" forSetIdentifier:v25 withSetStatus:v22];
  }

  else
  {
    v71 = [v18 discoveredAtomicInstance];
    v72 = objc_alloc_init(MANAutoAssetSetNotifications);
    if (!v71)
    {
      v71 = v107;
    }

    v130 = v71;
    [(MANAutoAssetSetNotifications *)v72 setAtomicInstanceDiscovered:1];
    [(MANAutoAssetSetNotifications *)v72 setAtomicInstanceAvailableForUse:1];
    v105 = [MANAutoAssetSetStatus alloc];
    v128 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:v18];
    v126 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDArrayForSetDescriptor:v18];
    v124 = [v132 mostRecentlyReceivedCachedAssetSetID];
    v116 = [v132 mostRecentlyReceivedDownloadedFromLive];
    v122 = [v132 mostRecentlyReceivedLastTimeChecked];
    v120 = [v132 mostRecentlyReceivedPostedDate];
    v118 = [v18 discoveredAtomicEntries];
    v112 = [v18 latestDownloadedAtomicInstance];
    v98 = [v132 latestAtomicInstanceToVendFromPreSUStaging];
    v114 = [v132 latestToVendCachedAssetSetID];
    v97 = [v132 latestToVendDownloadedFromLive];
    v95 = [v132 latestToVendLastTimeChecked];
    v91 = [v132 latestToVendPostedDate];
    v101 = v72;
    v93 = [MADAutoAssetScheduler newSetPolicyForDomainName:v131 forAssetSetIdentifier:v25];
    v73 = +[MADAutoAssetControlManager stagerSetPolicy];
    v74 = [v132 haveReceivedLookupResponse];
    v75 = [v132 vendingAtomicInstanceForConfiguredEntries];
    [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v18];
    v76 = v103 = self;
    v77 = [v132 availableForUseError];
    v78 = [v132 newerVersionError];
    BYTE2(v80) = 0;
    BYTE1(v80) = v75;
    LOBYTE(v80) = v74;
    LOBYTE(v79) = v98;
    v22 = [MANAutoAssetSetStatus initStatusForClientDomain:v105 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v131 withAtomicInstancesDownloaded:v25 withCatalogCachedAssetSetID:v128 withCatalogDownloadedFromLive:v126 withCatalogLastTimeChecked:v124 withCatalogPostedDate:v116 withNewerAtomicInstanceDiscovered:v122 withNewerDiscoveredAtomicEntries:v120 withLatestDownloadedAtomicInstance:v130 withLatestDownloadedAtomicInstanceFromPreSUStaging:v118 withLatestDowloadedAtomicInstanceEntries:v112 withDownloadedCatalogCachedAssetSetID:v79 withDownloadedCatalogDownloadedFromLive:v108 withDownloadedCatalogLastTimeChecked:v114 withDownloadedCatalogPostedDate:v97 withCurrentNotifications:v95 withCurrentNeedPolicy:v91 withSchedulerPolicy:v72 withStagerPolicy:0 havingReceivedLookupResponse:v93 vendingAtomicInstanceForConfiguredEntries:v73 withDownloadUserInitiated:v80 withDownloadProgress:0 withDownloadedNetworkBytes:0 withDownloadedFilesystemBytes:0 withCurrentLockUsage:v76 withSelectorsForStaging:0 withAvailableForUseError:v77 withNewerVersionError:v78];

    self = v103;
    v18 = v109;

    v39 = v25;
    v23 = v108;

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    if (!v22)
    {
      v68 = 0;
      v69 = 0;
      v67 = v106;
      goto LABEL_34;
    }
  }

  if (a9)
  {
    v59 = v23;
  }

  else
  {
    v59 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:v23];
  }

  v129 = v59;
  v99 = objc_alloc(p_weak_ivar_lyt[344]);
  v127 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:v18];
  v125 = [v22 atomicInstancesDownloaded];
  v104 = [v132 mostRecentlyReceivedCachedAssetSetID];
  v123 = [v132 mostRecentlyReceivedDownloadedFromLive];
  v121 = [v132 mostRecentlyReceivedLastTimeChecked];
  v119 = [v132 mostRecentlyReceivedPostedDate];
  v117 = [v22 newerAtomicInstanceDiscovered];
  v60 = [v22 newerDiscoveredAtomicEntries];
  v115 = v60;
  if (!a9)
  {
    v115 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:v60];
  }

  v102 = v60;
  v113 = [v22 latestDownloadedAtomicInstance];
  v96 = [v132 latestAtomicInstanceToVendFromPreSUStaging];
  v111 = [v132 latestToVendCachedAssetSetID];
  v94 = [v132 latestToVendDownloadedFromLive];
  v92 = [v132 latestToVendLastTimeChecked];
  v90 = [v132 latestToVendPostedDate];
  v89 = [v22 currentNotifications];
  v88 = [v22 currentNeedPolicy];
  v87 = [MADAutoAssetScheduler newSetPolicyForDomainName:v131 forAssetSetIdentifier:v39];
  v84 = +[MADAutoAssetControlManager stagerSetPolicy];
  v86 = [v132 haveReceivedLookupResponse];
  v85 = [v132 vendingAtomicInstanceForConfiguredEntries];
  v82 = [v22 downloadUserInitiated];
  v83 = [v22 downloadProgress];
  v61 = [v22 downloadedNetworkBytes];
  v62 = [v22 downloadedFilesystemBytes];
  v81 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v18];
  [v22 selectorsForStaging];
  v64 = v63 = v39;
  v65 = [v132 availableForUseError];
  v66 = [v132 newerVersionError];
  BYTE2(v80) = v82;
  BYTE1(v80) = v85;
  LOBYTE(v80) = v86;
  LOBYTE(v79) = v96;
  v100 = [v99 initStatusForClientDomain:v131 forAssetSetIdentifier:v63 withConfiguredAssetEntries:v127 withAtomicInstancesDownloaded:v125 withCatalogCachedAssetSetID:v104 withCatalogDownloadedFromLive:v123 withCatalogLastTimeChecked:v121 withCatalogPostedDate:v119 withNewerAtomicInstanceDiscovered:v117 withNewerDiscoveredAtomicEntries:v115 withLatestDownloadedAtomicInstance:v113 withLatestDownloadedAtomicInstanceFromPreSUStaging:v79 withLatestDowloadedAtomicInstanceEntries:v129 withDownloadedCatalogCachedAssetSetID:v111 withDownloadedCatalogDownloadedFromLive:v94 withDownloadedCatalogLastTimeChecked:v92 withDownloadedCatalogPostedDate:v90 withCurrentNotifications:v89 withCurrentNeedPolicy:v88 withSchedulerPolicy:v87 withStagerPolicy:v84 havingReceivedLookupResponse:v80 vendingAtomicInstanceForConfiguredEntries:v83 withDownloadUserInitiated:v61 withDownloadProgress:v62 withDownloadedNetworkBytes:v81 withDownloadedFilesystemBytes:v64 withCurrentLockUsage:v65 withSelectorsForStaging:v66 withAvailableForUseError:? withNewerVersionError:?];

  if (!a9)
  {
  }

  v39 = v110;
  v23 = v108;
  v18 = v109;
  v67 = v106;
  v68 = v22;
  v69 = v100;
LABEL_34:

  return v69;
}

- (id)setJobInstanceKeyFromSetDescriptor:(id)a3 forLatestDownloaded:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 assetSetIdentifier];

  if (v9)
  {
    if (v4)
    {
      v10 = [v6 latestDownloadedAtomicInstance];

      if (v10)
      {
        v11 = [NSString alloc];
        v12 = [v6 assetSetIdentifier];
        v13 = [v6 latestDownloadedAtomicInstance];
LABEL_9:
        v19 = v13;
        v20 = [v11 initWithFormat:@"%@_%@", v12, v13];

        goto LABEL_16;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v16 = [v6 summary];
        *buf = 138543618;
        v23 = v15;
        v24 = 2114;
        v25 = v16;
        v17 = "[%{public}@] {setJobInstanceKey} no latestDownloadedAtomicInstance | autoSetDescriptor:%{public}@";
        goto LABEL_14;
      }
    }

    else
    {
      v18 = [v6 discoveredAtomicInstance];

      if (v18)
      {
        v11 = [NSString alloc];
        v12 = [v6 assetSetIdentifier];
        v13 = [v6 discoveredAtomicInstance];
        goto LABEL_9;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v16 = [v6 summary];
        *buf = 138543618;
        v23 = v15;
        v24 = 2114;
        v25 = v16;
        v17 = "[%{public}@] {setJobInstanceKey} no newerAtomicInstanceDiscovered | autoSetDescriptor:%{public}@";
        goto LABEL_14;
      }
    }
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v16 = [v6 summary];
      *buf = 138543618;
      v23 = v15;
      v24 = 2114;
      v25 = v16;
      v17 = "[%{public}@] {setJobInstanceKey} no assetSetIdentifier | autoSetDescriptor:%{public}@";
LABEL_14:
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, v17, buf, 0x16u);
    }
  }

  v20 = 0;
LABEL_16:

  return v20;
}

- (id)setJobInstanceKeyFromSetStatus:(id)a3 forLatestDownloaded:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 assetSetIdentifier];

  if (v9)
  {
    if (v4)
    {
      v10 = [v6 latestDownloadedAtomicInstance];

      if (v10)
      {
        v11 = [NSString alloc];
        v12 = [v6 assetSetIdentifier];
        v13 = [v6 latestDownloadedAtomicInstance];
LABEL_9:
        v19 = v13;
        v20 = [v11 initWithFormat:@"%@_%@", v12, v13];

        goto LABEL_16;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v16 = [v6 summary];
        *buf = 138543618;
        v23 = v15;
        v24 = 2114;
        v25 = v16;
        v17 = "[%{public}@] {setJobInstanceKey} no latestDownloadedAtomicInstance | autoSetStatus:%{public}@";
        goto LABEL_14;
      }
    }

    else
    {
      v18 = [v6 newerAtomicInstanceDiscovered];

      if (v18)
      {
        v11 = [NSString alloc];
        v12 = [v6 assetSetIdentifier];
        v13 = [v6 newerAtomicInstanceDiscovered];
        goto LABEL_9;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v16 = [v6 summary];
        *buf = 138543618;
        v23 = v15;
        v24 = 2114;
        v25 = v16;
        v17 = "[%{public}@] {setJobInstanceKey} no newerAtomicInstanceDiscovered | autoSetStatus:%{public}@";
        goto LABEL_14;
      }
    }
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v16 = [v6 summary];
      *buf = 138543618;
      v23 = v15;
      v24 = 2114;
      v25 = v16;
      v17 = "[%{public}@] {setJobInstanceKey} no assetSetIdentifier | autoSetStatus:%{public}@";
LABEL_14:
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, v17, buf, 0x16u);
    }
  }

  v20 = 0;
LABEL_16:

  return v20;
}

- (id)setJobInstanceKeyForSetInstance:(id)a3
{
  v4 = a3;
  v5 = [v4 assetSetIdentifier];

  if (v5)
  {
    v6 = [v4 atomicInstance];

    if (v6)
    {
      v7 = [NSString alloc];
      v8 = [v4 assetSetIdentifier];
      v9 = [v4 atomicInstance];
      v10 = [v7 initWithFormat:@"%@_%@", v8, v9];
    }

    else
    {
      v10 = [v4 assetSetIdentifier];
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      v12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v13 = [v4 summary];
      *buf = 138543618;
      v16 = v12;
      v17 = 2114;
      v18 = v13;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[%{public}@] {setJobInstanceKeyForSetInstance} no assetSetIdentifier | setInstance:%{public}@", buf, 0x16u);
    }

    v10 = 0;
  }

  return v10;
}

- (id)_alreadyDownloadedDescriptorsArray:(id)a3 limitingToSupportingStaging:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = objc_alloc_init(NSMutableArray);
  v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorLimitedToStaging:v4];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v6 ofContainer:@"downloadedDescriptorsBySelector"];
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v11 = v10;
  v12 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v21;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v21 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v20 + 1) + 8 * i);
        v17 = objc_autoreleasePoolPush();
        v18 = [v11 safeObjectForKey:v16 ofClass:{objc_opt_class(), v20}];
        if (v18)
        {
          [v9 addObject:v18];
        }

        objc_autoreleasePoolPop(v17);
      }

      v13 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
    }

    while (v13);
  }

  return v9;
}

- (void)ensureStagerFullyResumed
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  if ([(MADAutoAssetControlManager *)self stagerResumePostponed])
  {
    [(MADAutoAssetControlManager *)self setStagerResumePostponed:0];

    +[MADAutoAssetStager finishSuspendedResumeFromPersisted];
  }
}

- (BOOL)isNoWaitRequestInvolvingSecureAsset:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v4];
  v8 = [v4 clientRequest];

  v9 = [v8 clientRequestMessage];
  v10 = [v9 messageName];

  if (v7 && ([v7 clientAssetSelector], (v11 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v12 = v11;
    if ([SUCore stringIsEqual:v10 to:@"MA-AUTO:CHECK_FOR_NEWER"])
    {

      goto LABEL_7;
    }

    v13 = [SUCore stringIsEqual:v10 to:@"MA-AUTO:LOCK_CONTENT"];

    if (v13)
    {
LABEL_7:
      v14 = [v8 clientRequestMessage];
      v15 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v14];

      if (v15)
      {
        if ([SUCore stringIsEqual:v10 to:@"MA-AUTO:CHECK_FOR_NEWER"])
        {
          if (![v15 checkWaitTimeoutSecs])
          {
            goto LABEL_15;
          }
        }

        else if (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v10, @"MA-AUTO:LOCK_CONTENT") && (![v15 checkWaitTimeoutSecs] || !objc_msgSend(v15, "lockWaitTimeoutSecs")))
        {
LABEL_15:
          v16 = [v7 clientAssetSelector];
          v17 = [v16 assetVersion];

          v18 = [v7 clientAssetSelector];
          v19 = v18;
          if (v17)
          {
            v20 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v18];
          }

          else
          {
            v21 = [v18 assetType];
            v22 = [v7 clientAssetSelector];
            v23 = [v22 assetSpecifier];
            v20 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"isNoWaitRequestInvolvingSecureAsset" forAssetType:v21 withAssetSpecifier:v23];
          }

          if (v20 && [MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"isNoWaitRequestInvolvingSecureAsset" forDescriptor:v20])
          {
            LOBYTE(v13) = [MADAutoAssetSecure isSecureAsset:@"isNoWaitRequestInvolvingSecureAsset" forDescriptor:v20];
          }

          else
          {
            LOBYTE(v13) = 0;
          }

          goto LABEL_23;
        }
      }

      LOBYTE(v13) = 0;
LABEL_23:
    }
  }

  else
  {
    LOBYTE(v13) = 0;
  }

  return v13;
}

- (void)securePersonalizeGraftLockSet:(id)a3 lockingSetDescriptor:(id)a4 forEventInfo:(id)a5 fallingBackToSetDescriptor:(id)a6 fromPreSUStaging:(BOOL)a7
{
  v7 = a7;
  v12 = a3;
  v13 = a5;
  v14 = a6;
  v15 = a4;
  v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v17 = [v16 extendedStateQueue];
  dispatch_assert_queue_V2(v17);

  v22[0] = _NSConcreteStackBlock;
  v22[1] = 3221225472;
  v22[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_fallingBackToSetDescriptor_fromPreSUStaging___block_invoke;
  v22[3] = &unk_4B4828;
  v18 = v14 == 0;
  v23 = v14;
  v24 = self;
  v25 = v12;
  v26 = v13;
  v27 = v7;
  v19 = v13;
  v20 = v12;
  v21 = v14;
  [(MADAutoAssetControlManager *)self securePersonalizeGraftLockSet:v20 lockingSetDescriptor:v15 forEventInfo:v19 replyingOnError:v18 fromPreSUStaging:v7 completion:v22];
}

unsigned __int8 *__138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_fallingBackToSetDescriptor_fromPreSUStaging___block_invoke(unsigned __int8 *result, uint64_t a2)
{
  if (a2)
  {
    v2 = *(result + 4);
    if (v2)
    {
      return [*(result + 5) securePersonalizeGraftLockSet:*(result + 6) lockingSetDescriptor:v2 forEventInfo:*(result + 7) replyingOnError:1 fromPreSUStaging:result[64] completion:&__block_literal_global_4144];
    }
  }

  return result;
}

- (void)securePersonalizeGraftLockSet:(id)a3 lockingSetDescriptor:(id)a4 forEventInfo:(id)a5 replyingOnError:(BOOL)a6 fromPreSUStaging:(BOOL)a7 completion:(id)a8
{
  v78 = a7;
  v81 = a6;
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a8;
  v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v17 = [v16 extendedStateQueue];
  dispatch_assert_queue_V2(v17);

  v88 = [[NSString alloc] initWithFormat:@"%@:securePersonalizeGraftLockSet", v12];
  v18 = [v14 setJobInformation];
  v19 = [v18 clientInstance];
  v20 = [v18 clientDesire];
  v21 = v20;
  if (v19)
  {
    if (v20)
    {
      goto LABEL_3;
    }
  }

  else
  {
    v19 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v88 withEventInfo:v14];
    if (v21)
    {
      goto LABEL_3;
    }
  }

  v51 = [v14 clientRequest];
  v21 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:v51];

LABEL_3:
  v85 = v21;
  v86 = v19;
  v83 = v12;
  v84 = v15;
  v87 = v13;
  if ([v13 secureOperationInProgress])
  {
    v22 = [NSString alloc];
    v23 = [v13 summary];
    v24 = [v22 initWithFormat:@"encountered set-descriptor with already in-progress secure-operation | setDescriptor:%@", v23];
    [MAAutoAssetError buildError:6532 fromOperation:v88 underlyingError:0 withDescription:v24];
    v26 = v25 = v13;

    v27 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v28 = [v27 diag];
    v29 = [NSString alloc];
    v30 = [v25 summary];
    v31 = [v29 initWithFormat:@"{%@:securePersonalizeGraftLockSet} already in-progress secure-operation | setDescriptor:%@", v12, v30];
    [v28 trackAnomaly:@"AUTO-SECURE" forReason:v31 withResult:6532 withError:v26];

    if (v81)
    {
      v32 = [v86 clientDomainName];
      v33 = [v14 assetSetIdentifier];
      v34 = [v14 clientRequest];
      v35 = [v34 responseMessage];
      [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v88 forClientDomain:v32 forAssetSetIdentifier:v33 forJobResponse:v35 withResponseError:0 clearingDownloadProgressReason:@"reached [secure operation] lock phase" withAssetSetStatus:0];
      v36 = v79 = v18;

      [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v14 issuingResponseMessage:v36 withResponseError:v26 fromLocation:v88];
      v37 = [[NSString alloc] initWithFormat:@"%@ (secure operation already in progress)", v88];
      [(MADAutoAssetControlManager *)self decrementClientRequestCount:v37 forEventInfo:v14];

      v18 = v79;
    }

    v38 = v84;
    (v84)[2](v84, v26);

    v40 = v86;
    v39 = v87;
    v41 = v88;
    goto LABEL_39;
  }

  v80 = v18;
  v77 = v14;
  v101 = 0u;
  v102 = 0u;
  v99 = 0u;
  v100 = 0u;
  v42 = [v13 latestDowloadedAtomicInstanceEntries];
  v43 = [v42 countByEnumeratingWithState:&v99 objects:v103 count:16];
  if (v43)
  {
    v44 = v43;
    v45 = 0;
    v46 = 0;
    v47 = *v100;
    do
    {
      for (i = 0; i != v44; i = i + 1)
      {
        if (*v100 != v47)
        {
          objc_enumerationMutation(v42);
        }

        v49 = [*(*(&v99 + 1) + 8 * i) fullAssetSelector];
        v50 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v49];

        v41 = v88;
        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v88 forDescriptor:v50])
        {
          if ([MADAutoAssetSecure isPersonalizationRequired:v88 forDescriptor:v50])
          {
            [v50 setSecureOperationInProgress:1];
            [v87 setSecureOperationInProgress:1];
            ++v46;
          }

          if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:v88 forDescriptor:v50])
          {
            [v50 setSecureOperationInProgress:1];
            [v87 setSecureOperationInProgress:1];
            ++v45;
          }
        }
      }

      v44 = [v42 countByEnumeratingWithState:&v99 objects:v103 count:16];
    }

    while (v44);
  }

  else
  {
    v45 = 0;
    v46 = 0;
    v41 = v88;
  }

  if (v46 <= 0 && v45 < 1)
  {
    v14 = v77;
    v52 = [v77 clientReplyCompletion];
    v53 = self;
    v39 = v87;
    v54 = [(MADAutoAssetControlManager *)self notifyLockerAsIndicatedBySetJob:v41 withSetInstance:v86 withSetDesire:v85 forSetDescriptor:v87 withClientReplyCompletion:v52];

    if (v54)
    {
      v38 = v84;
      if (!v81)
      {
LABEL_38:
        (v38)[2](v38, v54);

        v40 = v86;
        goto LABEL_39;
      }

      v55 = [v77 clientRequest];
      v82 = [v55 clientRequestMessage];
      v56 = [MADAutoAssetControlManager replyMessageNameForRequest:v82];
      v57 = [v77 clientRequest];
      v58 = [v57 clientRequestMessage];
      [v58 clientID];
      v60 = v59 = v54;
      v61 = [MADAutoAssetControlManager createSeverMessageWithName:v56 sender:@"com.apple.MAAutoControl" clientID:v60 response:0 error:v59];

      v38 = v84;
      v18 = v80;

      v41 = v88;
      v62 = [v77 clientRequest];
      v53 = self;
      v63 = self;
      v64 = v59;
      v65 = v59;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      [(MADAutoAssetControlManager *)v63 issueResponseToClientRequest:v62 issuingResponseMessage:v61 withResponseError:v65];

      v67 = @"%@ (no secure operation required [reply-on-error])";
    }

    else
    {
      v64 = 0;
      v71 = [v77 clientRequest];
      v61 = [(MADAutoAssetControlManager *)v53 buildSetFoundResponseMessage:@"[AUTO-PERSONALIZATION] lockAtomic(SUCCESS)" forClientRequest:v71 withFoundSetDescriptor:v87 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v86 withDesire:v85 fromLocation:v41];

      v72 = [v86 atomicInstance];

      v38 = v84;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      if (!v72)
      {
        v73 = [v87 clientDomainName];
        v74 = [v87 assetSetIdentifier];
        v75 = [(MADAutoAssetControlManager *)v53 locateSetConfigurationByClientDomain:v73 forAssetSetIdentifier:v74];

        [(MADAutoAssetControlManager *)v53 setConfigurationAdoptLatestToVend:v88 fromSetDescriptor:v87 toSetConfiguration:v75 fromPreSUStaging:v78 allowEmpty:0];
        v18 = v80;
      }

      v41 = v88;
      [(MADAutoAssetControlManager *)v53 issueBuiltResponseForEventInfo:v77 issuingResponseMessage:v61 withResponseError:0 fromLocation:v88];
      v67 = @"%@ (no secure operation required [SUCCESS])";
    }

    v76 = [objc_alloc(p_weak_ivar_lyt[226]) initWithFormat:v67, v41];
    [(MADAutoAssetControlManager *)v53 decrementClientRequestCount:v76 forEventInfo:v77];

    v54 = v64;
    goto LABEL_38;
  }

  v68 = @"AUTO-PERSONALIZATION-GRAFT";
  if (v45 < 1)
  {
    v68 = @"AUTO-PERSONALIZATION";
  }

  if (v46 >= 1)
  {
    v69 = v68;
  }

  else
  {
    v69 = @"AUTO-GRAFT";
  }

  v70 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v87];
  v89[0] = _NSConcreteStackBlock;
  v89[1] = 3221225472;
  v89[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke;
  v89[3] = &unk_4B4878;
  v89[4] = self;
  v90 = v87;
  v91 = v88;
  v92 = v69;
  v39 = v87;
  v40 = v86;
  v93 = v86;
  v94 = v85;
  v14 = v77;
  v95 = v77;
  v97 = v78;
  v98 = v81;
  v38 = v84;
  v96 = v84;
  v41 = v88;
  [MADAutoAssetSecure personalizeGraftSetDownloaded:v91 forSetDescriptor:v90 allowingNetwork:1 withAutoAssetDescriptors:v70 completion:v89];

LABEL_39:
}

void __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [*(a1 + 32) autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke_2;
  block[3] = &unk_4B4850;
  v20 = v4;
  *&v7 = *(a1 + 40);
  *(&v7 + 1) = *(a1 + 32);
  v18 = v7;
  v8 = *(a1 + 48);
  v9 = *(a1 + 56);
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v21 = v18;
  v22 = v10;
  v11 = *(a1 + 64);
  v12 = *(a1 + 72);
  v13 = *(a1 + 80);
  v25 = *(a1 + 96);
  v14 = *(a1 + 88);
  *&v15 = v13;
  *(&v15 + 1) = v14;
  *&v16 = v11;
  *(&v16 + 1) = v12;
  v23 = v16;
  v24 = v15;
  v17 = v4;
  dispatch_async(v6, block);
}

void __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke_2(uint64_t a1)
{
  v1 = a1;
  v2 = *(a1 + 32);
  [*(v1 + 40) setSecureOperationInProgress:0];
  v90 = v1;
  if (v2)
  {
    v3 = v1;
    v4 = *(v1 + 48);
    v5 = [*(v3 + 40) clientDomainName];
    v6 = [*(v3 + 40) assetSetIdentifier];
    v7 = [v4 setConfigurationForClientDomain:v5 forAssetSetIdentifier:v6];

    if (v7)
    {
      v8 = [v7 latestAtomicInstanceToVend];

      if (v8)
      {
        if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v2])
        {
          [*(v90 + 48) forceGlobalSetUnlock:*(v90 + 56) dueToError:v2 ofSetDescriptor:*(v90 + 40) historyOperationAI:1503 historyOperationSD:394];
          goto LABEL_9;
        }

        v9 = [NSError buildCheckedError:v2];
        [v7 setNewerVersionError:v9];
      }

      else
      {
        v9 = [NSError buildCheckedError:v2];
        [v7 setAvailableForUseError:v9];
      }
    }

LABEL_9:

    v1 = v90;
  }

  v93 = 0u;
  v94 = 0u;
  v91 = 0u;
  v92 = 0u;
  v10 = [*(v1 + 40) latestDowloadedAtomicInstanceEntries];
  v11 = [v10 countByEnumeratingWithState:&v91 objects:v104 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v92;
    do
    {
      v14 = 0;
      v89 = v12;
      do
      {
        if (*v92 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(v1 + 48);
        v16 = [*(*(&v91 + 1) + 8 * v14) fullAssetSelector];
        v17 = [v15 locateDownloadedByFullSelector:v16];

        [v17 setSecureOperationInProgress:0];
        if ([v17 secureOperationEliminating])
        {
          v18 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
          {
            v19 = v13;
            v20 = v10;
            v21 = v2;
            v22 = *(v1 + 64);
            v23 = *(v90 + 56);
            v24 = [*(v90 + 40) summary];
            v25 = [v17 summary];
            *buf = 138544130;
            v97 = v22;
            v2 = v21;
            v10 = v20;
            v13 = v19;
            v98 = 2114;
            v99 = v23;
            v1 = v90;
            v100 = 2114;
            v101 = v24;
            v102 = 2114;
            v103 = v25;
            _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} auto-asset of set-descriptor eliminate while performing secure operation(s) | setDescriptor:%{public}@ | nextDownloadedDescriptor:%{public}@", buf, 0x2Au);

            v12 = v89;
          }

          [*(v1 + 48) eliminateUngraftDescriptor:*(v1 + 56) forAutoAssetDescriptor:v17 failingClientRequestForEventInfo:0];
          if (!v2)
          {
            v26 = *(v1 + 56);
            v27 = [NSString alloc];
            v28 = [v17 summary];
            v29 = [v27 initWithFormat:@"encountered set-descriptor with auto-asset being eliminated | nextDownloadedDescriptor:%@", v28];
            v30 = v26;
            v12 = v89;
            v2 = [MAAutoAssetError buildError:6114 fromOperation:v30 underlyingError:0 withDescription:v29];
          }
        }

        v14 = v14 + 1;
      }

      while (v12 != v14);
      v12 = [v10 countByEnumeratingWithState:&v91 objects:v104 count:16];
    }

    while (v12);
  }

  v31 = v1;
  v32 = *(v1 + 48);
  v33 = *(v31 + 56);
  v34 = [*(v31 + 72) clientDomainName];
  v35 = [*(v31 + 72) assetSetIdentifier];
  LODWORD(v32) = [v32 isSetIdentifierBeingEliminated:v33 forClientDomainName:v34 ofSetIdentifier:v35];

  if (v32)
  {
    v36 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      v37 = v2;
      v39 = *(v90 + 56);
      v38 = *(v90 + 64);
      v40 = [*(v90 + 40) summary];
      *buf = 138543874;
      v97 = v38;
      v2 = v37;
      v98 = 2114;
      v99 = v39;
      v100 = 2114;
      v101 = v40;
      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} set-identifier eliminate while performing secure operation(s) | nextDownloadedDescriptor:%{public}@", buf, 0x20u);
    }

    v41 = v90;
    [*(v90 + 48) eliminateUngraftSetDescriptor:*(v90 + 40) failingClientRequestForEventInfo:0];
    if (v2)
    {
      goto LABEL_29;
    }

    v42 = *(v90 + 56);
    v43 = [NSString alloc];
    v44 = [*(v90 + 40) summary];
    v45 = [v43 initWithFormat:@"encountered set-descriptor being eliminated | setDescriptor:%@", v44];
    v2 = [MAAutoAssetError buildError:6114 fromOperation:v42 underlyingError:0 withDescription:v45];
  }

  v41 = v90;
  if (!v2)
  {
    v46 = *(v90 + 56);
    v47 = *(v90 + 72);
    v48 = *(v90 + 80);
    v49 = *(v90 + 48);
    v50 = *(v90 + 40);
    v51 = [*(v90 + 88) clientReplyCompletion];
    v41 = v90;
    v2 = [v49 notifyLockerAsIndicatedBySetJob:v46 withSetInstance:v47 withSetDesire:v48 forSetDescriptor:v50 withClientReplyCompletion:v51];

    if (!v2)
    {
      v82 = *(v90 + 48);
      v83 = [*(v90 + 88) clientRequest];
      v60 = [v82 buildSetFoundResponseMessage:@"[AUTO-PERSONALIZATION] lockAtomic(SUCCESS)" forClientRequest:v83 withFoundSetDescriptor:*(v90 + 40) withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(v90 + 72) withDesire:*(v90 + 80) fromLocation:*(v90 + 56)];

      v84 = [*(v90 + 72) atomicInstance];

      if (!v84)
      {
        v85 = *(v90 + 48);
        v86 = [*(v90 + 40) clientDomainName];
        v87 = [*(v90 + 40) assetSetIdentifier];
        v88 = [v85 locateSetConfigurationByClientDomain:v86 forAssetSetIdentifier:v87];

        [*(v90 + 48) setConfigurationAdoptLatestToVend:*(v90 + 56) fromSetDescriptor:*(v90 + 40) toSetConfiguration:v88 fromPreSUStaging:*(v90 + 104) allowEmpty:0];
      }

      v2 = 0;
      v52 = 1;
      v53 = v90;
      if (v60)
      {
        goto LABEL_32;
      }

      goto LABEL_31;
    }
  }

LABEL_29:
  if ((*(v41 + 105) & 1) == 0)
  {
    v60 = 0;
    goto LABEL_39;
  }

  v52 = 0;
  v53 = v90;
LABEL_31:
  v54 = *(v53 + 48);
  v55 = *(v53 + 56);
  v56 = [*(v53 + 72) clientDomainName];
  v57 = [*(v53 + 88) assetSetIdentifier];
  v58 = [*(v53 + 88) clientRequest];
  v59 = [v58 responseMessage];
  v60 = [v54 updateAutoAssetSetStatus:v55 forClientDomain:v56 forAssetSetIdentifier:v57 forJobResponse:v59 withResponseError:v2 clearingDownloadProgressReason:@"reached [secure operation] lock phase" withAssetSetStatus:0];

LABEL_32:
  [*(v53 + 48) issueBuiltResponseForEventInfo:*(v53 + 88) issuingResponseMessage:v60 withResponseError:v2 fromLocation:*(v53 + 56)];
  v61 = *(v53 + 48);
  v62 = [[NSString alloc] initWithFormat:@"%@ (after secure operation attempt)", *(v53 + 56)];
  [v61 decrementClientRequestCount:v62 forEventInfo:*(v53 + 88)];

  if ((v52 & 1) == 0)
  {
    v63 = [*(v53 + 72) autoAssetSetClientName];
    v64 = *(v53 + 72);
    if (v63)
    {
      [v64 autoAssetSetClientName];
    }

    else
    {
      [v64 clientProcessName];
    }
    v65 = ;
    v66 = [*(v90 + 72) clientDomainName];
    v67 = [*(v90 + 72) assetSetIdentifier];
    v68 = [*(v90 + 40) latestDownloadedAtomicInstance];
    [MADAutoAssetHistory recordFailedOperation:504 fromClient:v65 forClientDomainName:v66 forAssetSetIdentifier:v67 forAtomicInstance:v68 failingWithError:v2];

    if (+[MAAIRBEventReporter isAvailable])
    {
      v69 = [MAAIRBMobileAssetOperationMetadata alloc];
      v70 = [MADAutoAssetHistoryTracker operationName:504];
      v71 = [(MAAIRBMobileAssetOperationMetadata *)v69 initWithCode:504 name:v70];

      v72 = [MAAIRBMobileAssetAtomicInstance alloc];
      v73 = [MAAIRBMobileAssetAssetSet alloc];
      v74 = [*(v90 + 72) assetSetIdentifier];
      v75 = [(MAAIRBMobileAssetAssetSet *)v73 initWithAssetSetIdentifier:v74];
      v76 = [*(v90 + 40) latestDownloadedAtomicInstance];
      v77 = [(MAAIRBMobileAssetAtomicInstance *)v72 initWithAssetSet:v75 atomicInstanceId:v76];

      v78 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v71 atomicInstance:v77 assetCount:0];
      v79 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
      v95 = v2;
      v80 = [NSArray arrayWithObjects:&v95 count:1];
      v81 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v79 initWithErrors:v80 type:v78];

      [MAAIRBEventReporter emitAppleIntelligenceEvent:v81];
    }
  }

LABEL_39:
  (*(*(v90 + 96) + 16))();
}

- (void)secureStartupEstablishOperationSequence:(id)a3 forRequiringPersonalization:(id)a4 forRequiringGrafting:(id)a5
{
  v8 = a3;
  v9 = a4;
  v43 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v42 = v8;
  v45 = [[NSString alloc] initWithFormat:@"%@:secureStartupEstablishOperationSequence", v8];
  v12 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setDescriptorsRequiringPersonalization:v12];

  v13 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setDescriptorsRequiringGrafting:v13];

  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  v14 = v9;
  v15 = [v14 countByEnumeratingWithState:&v50 objects:v61 count:16];
  v44 = v14;
  if (v15)
  {
    v16 = v15;
    v17 = 0;
    v18 = *v51;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v51 != v18)
        {
          objc_enumerationMutation(v14);
        }

        v20 = *(*(&v50 + 1) + 8 * i);
        v21 = [v14 safeObjectForKey:v20 ofClass:objc_opt_class()];
        if (v21)
        {
          v17 += [(MADAutoAssetControlManager *)self addToTryPersonalize:v45 forDescriptor:v21];
        }

        else
        {
          v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v23 = [v22 diag];
          v24 = [[NSString alloc] initWithFormat:@"{%@} unable to load secure descriptor to be personalized | descriptorKey:%@", v45, v20];
          [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6111 withError:0];

          v14 = v44;
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v50 objects:v61 count:16];
    }

    while (v16);
  }

  else
  {
    v17 = 0;
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v25 = v43;
  v26 = [v25 countByEnumeratingWithState:&v46 objects:v60 count:16];
  if (v26)
  {
    v27 = v26;
    v28 = *v47;
    do
    {
      for (j = 0; j != v27; j = j + 1)
      {
        if (*v47 != v28)
        {
          objc_enumerationMutation(v25);
        }

        v30 = *(*(&v46 + 1) + 8 * j);
        v31 = [v25 safeObjectForKey:v30 ofClass:objc_opt_class()];
        if (v31)
        {
          ++v17;
          v32 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
          [v32 addObject:v31];

          v33 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
          {
            v34 = [v31 summary];
            *buf = 138543874;
            v55 = v45;
            v56 = 2048;
            v57 = v17;
            v58 = 2114;
            v59 = v34;
            _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-GRAFT][STARTUP] {%{public}@} heal operation #%ld (graft|mount) | secureDescriptor:%{public}@", buf, 0x20u);
          }
        }

        else
        {
          v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v35 = [v33 diag];
          v36 = [[NSString alloc] initWithFormat:@"{%@} unable to load secure descriptor to be grafted | descriptorKey:%@", v45, v30];
          [v35 trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6111 withError:0];
        }
      }

      v27 = [v25 countByEnumeratingWithState:&v46 objects:v60 count:16];
    }

    while (v27);
  }

  v37 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
  {
    v38 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    v39 = [v38 count];
    v40 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v41 = [v40 count];
    *buf = 138543874;
    v55 = v45;
    v56 = 2048;
    v57 = v39;
    v58 = 2048;
    v59 = v41;
    _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION-GRAFT][STARTUP] {%{public}@} ready to begin secure operations | requiringPersonalized:%ld | requiringGrafting:%ld", buf, 0x20u);
  }
}

- (BOOL)addToTryPersonalize:(id)a3 forDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v38 = v6;
  v36 = self;
  v37 = [[NSString alloc] initWithFormat:@"%@:addToTryPersonalize", v6];
  v40 = 0u;
  v41 = 0u;
  v42 = 0u;
  v43 = 0u;
  v10 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v11 = [v10 countByEnumeratingWithState:&v40 objects:v50 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v41;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v15 = 0;
      v39 = v12;
      do
      {
        if (*v41 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v16 = *(*(&v40 + 1) + 8 * v15);
        v17 = p_weak_ivar_lyt[223];
        v18 = [v7 assetType];
        v19 = [v16 assetType];
        if ([v17 stringIsEqual:v18 to:v19])
        {
          v20 = p_weak_ivar_lyt[223];
          [v7 assetSpecifier];
          v21 = v13;
          v22 = p_weak_ivar_lyt;
          v23 = v7;
          v25 = v24 = v10;
          v26 = [v16 assetSpecifier];
          LOBYTE(v20) = [v20 stringIsEqual:v25 to:v26];

          v10 = v24;
          v7 = v23;
          p_weak_ivar_lyt = v22;
          v13 = v21;
          v12 = v39;

          if (v20)
          {
            v34 = 0;
            goto LABEL_15;
          }
        }

        else
        {
        }

        v15 = v15 + 1;
      }

      while (v12 != v15);
      v12 = [v10 countByEnumeratingWithState:&v40 objects:v50 count:16];
    }

    while (v12);
  }

  v27 = [(MADAutoAssetControlManager *)v36 descriptorsRequiringPersonalization];
  [v27 addObject:v7];

  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    [(MADAutoAssetControlManager *)v36 descriptorsRequiringPersonalization];
    v29 = v28 = v10;
    v30 = [v29 count];
    v31 = [v7 summary];
    *buf = 138543874;
    v32 = v37;
    v45 = v37;
    v46 = 2048;
    v47 = v30;
    v48 = 2114;
    v49 = v31;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} will attempt personalization count:%ld | secureDescriptor:%{public}@", buf, 0x20u);

    v10 = v28;
    v34 = 1;
    v33 = v38;
  }

  else
  {
    v34 = 1;
LABEL_15:
    v32 = v37;
    v33 = v38;
  }

  return v34;
}

- (BOOL)_acceptPersonalizationFromPSUSToBecomeLatestToVend:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6
{
  v10 = a3;
  v32 = a4;
  v11 = a5;
  v12 = a6;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationFromPSUSToBecomeLatestToVend", v10];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v15 ofContainer:@"stagedSetLookupResults"];
  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  v16 = [(MADAutoAssetControlManager *)self stagedSetLookupResults];
  v17 = [v16 countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (v17)
  {
    v18 = v17;
    v28 = v15;
    v29 = v12;
    v30 = v11;
    v31 = v10;
    v19 = *v34;
    while (2)
    {
      for (i = 0; i != v18; i = i + 1)
      {
        if (*v34 != v19)
        {
          objc_enumerationMutation(v16);
        }

        v21 = *(*(&v33 + 1) + 8 * i);
        v22 = objc_autoreleasePoolPush();
        if (v21)
        {
          v23 = [v21 assetType];
          v24 = [v32 firstEntryAssetType];
          v25 = [SUCore stringIsEqual:v23 to:v24];

          if (v25)
          {
            v15 = v28;
            v12 = v29;
            v11 = v30;
            v26 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:v28 forSetLookupResult:v21 withCandidates:v30 extendingToBePersonalized:v29];
            objc_autoreleasePoolPop(v22);
            v10 = v31;
            goto LABEL_13;
          }
        }

        objc_autoreleasePoolPop(v22);
      }

      v18 = [v16 countByEnumeratingWithState:&v33 objects:v37 count:16];
      if (v18)
      {
        continue;
      }

      break;
    }

    v26 = 0;
    v11 = v30;
    v10 = v31;
    v15 = v28;
    v12 = v29;
  }

  else
  {
    v26 = 0;
  }

LABEL_13:

  return v26;
}

- (BOOL)_acceptPersonalizationToProvideLatestToVend:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6
{
  v10 = a4;
  v11 = a5;
  v12 = a6;
  v13 = a3;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToProvideLatestToVend", v13];
  v17 = [v10 latestAtomicInstanceToVend];

  if (v17)
  {
    v18 = [v10 latestAtomicInstanceToVend];
    v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v16 forAtomicInstanceUUID:v18 requireExists:1];

    v20 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:v16 forSetDescriptor:v19 withCandidates:v11 extendingToBePersonalized:v12];
  }

  else
  {
    v20 = 0;
  }

  return v20;
}

- (BOOL)_acceptPersonalizationToProvidePreinstalled:(id)a3 forSetConfiguration:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToProvidePreinstalled", v10];
  v17 = [v11 clientDomainName];
  v36 = v11;
  v18 = [v11 assetSetIdentifier];
  v19 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v17 assetSetIdentifier:v18];

  v35 = v16;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v16 ofContainer:@"setDescriptorKeysForAssetSet"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  v20 = v19;
  v21 = [v20 countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (v21)
  {
    v22 = v21;
    v33 = v12;
    v34 = v10;
    v23 = *v38;
    do
    {
      for (i = 0; i != v22; i = i + 1)
      {
        if (*v38 != v23)
        {
          objc_enumerationMutation(v20);
        }

        v25 = *(*(&v37 + 1) + 8 * i);
        v26 = objc_autoreleasePoolPush();
        v27 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v25];
        if (v27)
        {
          v28 = [v36 autoAssetEntries];
          if ([(MADAutoAssetControlManager *)self doesSetDescriptor:v27 coverRequestedAutoAssetEntries:v28])
          {
            v29 = [(MADAutoAssetControlManager *)self doesSetDescriptorReferenceAllPreInstalledContent:v27];

            if (v29)
            {
              v30 = v35;
              v12 = v33;
              v31 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:v35 forSetDescriptor:v27 withCandidates:v33 extendingToBePersonalized:v13];

              objc_autoreleasePoolPop(v26);
              v10 = v34;
              goto LABEL_16;
            }
          }

          else
          {
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v22 = [v20 countByEnumeratingWithState:&v37 objects:v41 count:16];
    }

    while (v22);
    v31 = 0;
    v12 = v33;
    v10 = v34;
  }

  else
  {
    v31 = 0;
  }

  v30 = v35;
LABEL_16:

  return v31;
}

- (BOOL)_acceptPersonalizationToAttempt:(id)a3 forSetDescriptor:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v49 = self;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v50 = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToAttempt(forSetDescriptor)", v10];
  v47 = v12;
  if (v11)
  {
    v44 = v13;
    v46 = v10;
    v16 = objc_alloc_init(NSMutableDictionary);
    v59 = 0u;
    v60 = 0u;
    v61 = 0u;
    v62 = 0u;
    v45 = v11;
    v17 = [v11 latestDowloadedAtomicInstanceEntries];
    v18 = [v17 countByEnumeratingWithState:&v59 objects:v69 count:16];
    if (v18)
    {
      v19 = v18;
      v48 = *v60;
      while (2)
      {
        for (i = 0; i != v19; i = i + 1)
        {
          v21 = v16;
          if (*v60 != v48)
          {
            objc_enumerationMutation(v17);
          }

          v22 = *(*(&v59 + 1) + 8 * i);
          v23 = objc_autoreleasePoolPush();
          v24 = [(MADAutoAssetControlManager *)v49 _acceptPersonalizationToAttempt:v50 forAtomicEntry:v22];
          if (!v24)
          {
            objc_autoreleasePoolPop(v23);
            v11 = v45;
            v10 = v46;
            v13 = v44;
            goto LABEL_28;
          }

          v25 = [MAAutoAssetSelector alloc];
          v26 = [v24 assetType];
          v27 = [v24 assetSpecifier];
          v28 = [v24 assetVersion];
          v29 = [v25 initForAssetType:v26 withAssetSpecifier:v27 matchingAssetVersion:v28];

          v30 = [v29 persistedEntryID];
          v16 = v21;
          [v21 setSafeObject:v24 forKey:v30];

          objc_autoreleasePoolPop(v23);
        }

        v19 = [v17 countByEnumeratingWithState:&v59 objects:v69 count:16];
        if (v19)
        {
          continue;
        }

        break;
      }
    }

    if ([v16 count])
    {
      v57 = 0u;
      v58 = 0u;
      v55 = 0u;
      v56 = 0u;
      v17 = v16;
      v31 = [v17 countByEnumeratingWithState:&v55 objects:v68 count:16];
      v13 = v44;
      if (v31)
      {
        v32 = v31;
        v33 = *v56;
        while (2)
        {
          for (j = 0; j != v32; j = j + 1)
          {
            if (*v56 != v33)
            {
              objc_enumerationMutation(v17);
            }

            v35 = *(*(&v55 + 1) + 8 * j);
            v36 = [v47 safeObjectForKey:v35 ofClass:objc_opt_class()];
            if (!v36)
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138543618;
                v65 = v50;
                v66 = 2114;
                v67 = v35;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} candidate unavailable for attempting personalization | nextSelectorKey:%{public}@", buf, 0x16u);
              }

              LOBYTE(v24) = 0;
              goto LABEL_33;
            }
          }

          v32 = [v17 countByEnumeratingWithState:&v55 objects:v68 count:16];
          if (v32)
          {
            continue;
          }

          break;
        }
      }

      v53 = 0u;
      v54 = 0u;
      v51 = 0u;
      v52 = 0u;
      v17 = v17;
      v37 = [v17 countByEnumeratingWithState:&v51 objects:v63 count:16];
      if (v37)
      {
        v38 = v37;
        v21 = v16;
        v39 = *v52;
        v11 = v45;
        do
        {
          for (k = 0; k != v38; k = k + 1)
          {
            if (*v52 != v39)
            {
              objc_enumerationMutation(v17);
            }

            v41 = *(*(&v51 + 1) + 8 * k);
            v42 = [v17 safeObjectForKey:v41 ofClass:objc_opt_class()];
            [v44 setSafeObject:v42 forKey:v41];
          }

          v38 = [v17 countByEnumeratingWithState:&v51 objects:v63 count:16];
        }

        while (v38);
        LOBYTE(v24) = 1;
        v10 = v46;
LABEL_28:
        v16 = v21;
      }

      else
      {
        LOBYTE(v24) = 1;
LABEL_33:
        v11 = v45;
        v10 = v46;
      }
    }

    else
    {
      LOBYTE(v24) = 0;
      v11 = v45;
      v10 = v46;
      v13 = v44;
    }
  }

  else
  {
    LOBYTE(v24) = 0;
  }

  return v24;
}

- (BOOL)_acceptPersonalizationToAttempt:(id)a3 forSetLookupResult:(id)a4 withCandidates:(id)a5 extendingToBePersonalized:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v60 = a6;
  v57 = self;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToAttempt(forSetLookupResult)", v10];
  v58 = objc_alloc_init(NSMutableDictionary);
  if (!v11)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v76 = v15;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} received nil set lookup result", buf, 0xCu);
    }

LABEL_40:
    v48 = 0;
    goto LABEL_41;
  }

  v53 = v12;
  v54 = v11;
  v55 = v10;
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  v16 = [v11 discoveredAtomicEntries];
  v17 = v57;
  v59 = [v16 countByEnumeratingWithState:&v69 objects:v79 count:16];
  v56 = v15;
  if (!v59)
  {
    goto LABEL_16;
  }

  v18 = *v70;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  while (2)
  {
    for (i = 0; i != v59; i = i + 1)
    {
      if (*v70 != v18)
      {
        objc_enumerationMutation(v16);
      }

      v21 = *(*(&v69 + 1) + 8 * i);
      v22 = objc_autoreleasePoolPush();
      v23 = [v21 fullAssetSelector];
      v24 = [(MADAutoAssetControlManager *)v17 locateDownloadedByFullSelector:v23];

      if ([p_weak_ivar_lyt[287] doesDescriptorInvolvePersonalization:v15 forDescriptor:v24] && (objc_msgSend(p_weak_ivar_lyt[287], "isPersonalizationRequired:forDescriptor:", v15, v24) & 1) != 0)
      {
        v25 = [(MADAutoAssetControlManager *)v17 _acceptPersonalizationToAttempt:v15 forAtomicEntry:v21];
        if (!v25)
        {
          v49 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
          {
            v50 = [v21 summary];
            *buf = 138543618;
            v76 = v15;
            v77 = 2114;
            v78 = v50;
            _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} received nil descriptor for entry requiring personalization | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

          objc_autoreleasePoolPop(v22);
          v48 = 0;
          v11 = v54;
          v10 = v55;
          v12 = v53;
          goto LABEL_41;
        }

        v26 = v25;
        v27 = [MAAutoAssetSelector alloc];
        v28 = [v26 assetType];
        v29 = [v26 assetSpecifier];
        [v26 assetVersion];
        v30 = v22;
        v31 = v16;
        v33 = v32 = v18;
        v34 = [v27 initForAssetType:v28 withAssetSpecifier:v29 matchingAssetVersion:v33];

        v18 = v32;
        v16 = v31;
        v22 = v30;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        v15 = v56;
        v35 = [v34 persistedEntryID];
        [v58 setSafeObject:v26 forKey:v35];

        v17 = v57;
      }

      else
      {
        v26 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
        {
          goto LABEL_14;
        }

        v34 = [v21 summary];
        *buf = 138543618;
        v76 = v15;
        v77 = 2114;
        v78 = v34;
        _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} skipping set configuration atomic entry, does not involve personalization or does not require personalization | nextAtomicEntry:%{public}@", buf, 0x16u);
      }

LABEL_14:
      objc_autoreleasePoolPop(v22);
    }

    v59 = [v16 countByEnumeratingWithState:&v69 objects:v79 count:16];
    if (v59)
    {
      continue;
    }

    break;
  }

LABEL_16:

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v16 = v58;
  v36 = [v16 countByEnumeratingWithState:&v65 objects:v74 count:16];
  v11 = v54;
  v10 = v55;
  v12 = v53;
  if (v36)
  {
    v37 = v36;
    v38 = *v66;
    while (2)
    {
      for (j = 0; j != v37; j = j + 1)
      {
        if (*v66 != v38)
        {
          objc_enumerationMutation(v16);
        }

        v40 = *(*(&v65 + 1) + 8 * j);
        v41 = [v53 safeObjectForKey:v40 ofClass:objc_opt_class()];
        if (!v41)
        {
          v51 = _MADLog(@"AutoControl");
          v15 = v56;
          if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543618;
            v76 = v56;
            v77 = 2114;
            v78 = v40;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} candidate unavailable for attempting personalization | nextSelectorKey:%{public}@", buf, 0x16u);
          }

          goto LABEL_40;
        }
      }

      v37 = [v16 countByEnumeratingWithState:&v65 objects:v74 count:16];
      if (v37)
      {
        continue;
      }

      break;
    }
  }

  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v16 = v16;
  v42 = [v16 countByEnumeratingWithState:&v61 objects:v73 count:16];
  if (v42)
  {
    v43 = v42;
    v44 = *v62;
    do
    {
      for (k = 0; k != v43; k = k + 1)
      {
        if (*v62 != v44)
        {
          objc_enumerationMutation(v16);
        }

        v46 = *(*(&v61 + 1) + 8 * k);
        v47 = [v16 safeObjectForKey:v46 ofClass:objc_opt_class()];
        [v60 setSafeObject:v47 forKey:v46];
      }

      v43 = [v16 countByEnumeratingWithState:&v61 objects:v73 count:16];
    }

    while (v43);
  }

  v48 = 1;
  v15 = v56;
LABEL_41:

  return v48;
}

- (id)_acceptPersonalizationToAttempt:(id)a3 forAtomicEntry:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (!v7)
  {
    v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v13 = [v11 diag];
    v14 = [[NSString alloc] initWithFormat:@"{%@} nil atomic-instance entry", v6];
    [v13 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v14 withResult:6108 withError:0];
LABEL_11:

    goto LABEL_12;
  }

  v10 = [v7 fullAssetSelector];
  v11 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v10];

  if (!v11)
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = [v13 diag];
    v15 = [NSString alloc];
    v16 = [v7 summary];
    v17 = [v15 initWithFormat:@"{%@} unable to locate asset-descriptor for atomic-instance entry | atomicEntry:%@", v6, v16];
    [v14 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v17 withResult:6108 withError:0];

LABEL_10:
    goto LABEL_11;
  }

  if (![v11 isOnFilesystem])
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = [v13 diag];
    v18 = [NSString alloc];
    v16 = [v7 summary];
    v19 = [v11 summary];
    v20 = [v18 initWithFormat:@"{%@} atomic-instance entry no longer on the filesystem | atomicEntry:%@ | assetDescriptor:%@", v6, v16, v19];
    [v14 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6108 withError:0];

    goto LABEL_10;
  }

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v11]&& [MADAutoAssetSecure isPersonalizationRequired:v6 forDescriptor:v11])
  {
    v11 = v11;
    v12 = v11;
    goto LABEL_13;
  }

LABEL_12:
  v12 = 0;
LABEL_13:

  return v12;
}

- (void)assetPersonalizatonAttemptCompletePostEvent:(id)a3 withControlParam:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v77 = v6;
  v10 = [[NSString alloc] initWithFormat:@"%@:assetPersonalizatonAttemptCompletePostEvent", v6];
  v11 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v12 = [v11 count];

  if (v12)
  {
    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = v13;
    v15 = @"HaveNeedingPersonalize";
LABEL_3:
    [v13 postEvent:v15 withInfo:v7];

    goto LABEL_54;
  }

  v76 = v7;
  v16 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v17 = [v16 count];

  if (!v17)
  {
    [(MADAutoAssetControlManager *)self considerDownloadedWithPSUSLookupResultsForLatestToVend];
    v68 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v69 = [v68 count];

    v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = v13;
    if (v69)
    {
      v15 = @"HaveNeedingGraft";
    }

    else
    {
      v15 = @"NoneNeedingPersonalize";
    }

    goto LABEL_3;
  }

  v18 = objc_alloc_init(NSMutableArray);
  v96 = 0u;
  v97 = 0u;
  v98 = 0u;
  v99 = 0u;
  obj = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v19 = self;
  v79 = self;
  v87 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
  if (!v87)
  {
    goto LABEL_39;
  }

  v86 = *v97;
  v78 = v10;
  v80 = v18;
  do
  {
    v20 = 0;
    do
    {
      if (*v97 != v86)
      {
        objc_enumerationMutation(obj);
      }

      v21 = *(*(&v96 + 1) + 8 * v20);
      v22 = objc_autoreleasePoolPush();
      v23 = [(MADAutoAssetControlManager *)v19 locateDownloadedByFullSelector:v21];
      v88 = v23;
      if (!v23)
      {
        v25 = [(MADAutoAssetControlManager *)v19 autoControlManagerFSM];
        v43 = [v25 diag];
        v44 = v22;
        v45 = [NSString alloc];
        v46 = [v21 summary];
        v47 = [v45 initWithFormat:@"{%@} pre-personalized selector yet no downloaded asset descriptor | prePersonalizedSelector:%@", v10, v46];
        [v43 trackAnomaly:@"AUTO-CONTROL" forReason:v47 withResult:6111 withError:0];

        v22 = v44;
        goto LABEL_34;
      }

      v24 = [(MADAutoAssetControlManager *)v19 setConfigurationForDescriptorIfManagedAsSet:v23];
      v25 = v24;
      if (!v24 || ([v24 latestAtomicInstanceToVend], v26 = objc_claimAutoreleasedReturnValue(), v26, !v26))
      {
        [v18 addObject:v21];
        goto LABEL_34;
      }

      v82 = v22;
      v83 = v20;
      v27 = [v25 latestAtomicInstanceToVend];
      v28 = [(MADAutoAssetControlManager *)v19 locateSetDescriptor:v10 forAtomicInstanceUUID:v27 requireExists:1];

      v84 = v25;
      v81 = v28;
      if (!v28)
      {
        v48 = [(MADAutoAssetControlManager *)v19 autoControlManagerFSM];
        v49 = [v48 diag];
        v50 = v21;
        v51 = [NSString alloc];
        v52 = [v50 summary];
        v53 = [v25 summary];
        v54 = [v51 initWithFormat:@"{%@} pre-personalized selector managed as set with latest-to-vend yet unable to locate being-vended set-descriptor | prePersonalizedSelector:%@ | managingSetConfiguration:%@", v10, v52, v53];
        [v49 trackAnomaly:@"AUTO-CONTROL" forReason:v54 withResult:6111 withError:0];

        v18 = v80;
        [v80 addObject:v50];
LABEL_32:
        v22 = v82;
        v20 = v83;
        goto LABEL_33;
      }

      v94 = 0u;
      v95 = 0u;
      v92 = 0u;
      v93 = 0u;
      v91 = [v28 latestDowloadedAtomicInstanceEntries];
      v29 = [v91 countByEnumeratingWithState:&v92 objects:v106 count:16];
      if (!v29)
      {
LABEL_25:

        v18 = v80;
        [v80 addObject:v21];
LABEL_31:
        v10 = v78;
        v19 = v79;
        goto LABEL_32;
      }

      v30 = v29;
      v31 = *v93;
      v90 = *v93;
LABEL_16:
      v32 = 0;
      while (1)
      {
        if (*v93 != v31)
        {
          objc_enumerationMutation(v91);
        }

        v33 = *(*(&v92 + 1) + 8 * v32);
        v34 = [v21 assetType];
        v35 = [v33 fullAssetSelector];
        v36 = [v35 assetType];
        if (([SUCore stringIsEqual:v34 to:v36]& 1) == 0)
        {

          goto LABEL_23;
        }

        v37 = [v21 assetSpecifier];
        v89 = v33;
        v38 = [v33 fullAssetSelector];
        [v38 assetSpecifier];
        v39 = v30;
        v41 = v40 = v21;
        v42 = [SUCore stringIsEqual:v37 to:v41];

        v21 = v40;
        v30 = v39;

        v31 = v90;
        if (v42)
        {
          break;
        }

LABEL_23:
        if (v30 == ++v32)
        {
          v30 = [v91 countByEnumeratingWithState:&v92 objects:v106 count:16];
          if (v30)
          {
            goto LABEL_16;
          }

          goto LABEL_25;
        }
      }

      v55 = [v21 assetVersion];
      v56 = [v89 fullAssetSelector];
      v57 = [v56 assetVersion];
      v58 = [SUCore stringIsEqual:v55 to:v57];

      if (v58)
      {
        v18 = v80;
        [v80 addObject:v21];

        goto LABEL_31;
      }

      v19 = v79;
      v10 = v78;
      v18 = v80;
      v22 = v82;
      v20 = v83;
      if ([(MADAutoAssetControlManager *)v79 wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:v84])
      {
        [v80 addObject:v21];
      }

LABEL_33:

      v25 = v84;
LABEL_34:

      objc_autoreleasePoolPop(v22);
      v20 = v20 + 1;
    }

    while (v20 != v87);
    v59 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
    v87 = v59;
  }

  while (v59);
LABEL_39:

  v60 = objc_alloc_init(NSMutableArray);
  v61 = v19;
  v62 = v60;
  [(MADAutoAssetControlManager *)v61 setPrePersonalizedSelectors:v60];

  if ([v18 count])
  {
    v63 = [MADAutoAssetSecure commitPrePersonalizedSync:v10 committingSelectors:v18];
    v64 = _MADLog(@"AutoControl");
    v65 = v64;
    if (v63)
    {
      if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR))
      {
        v66 = [v63 checkedDescription];
        v67 = [v18 count];
        *buf = 138543874;
        v101 = v10;
        v102 = 2114;
        v103 = v66;
        v104 = 2048;
        v105 = v67;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {%{public}@} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x20u);
      }
    }

    else
    {
      if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
      {
        v70 = [v18 count];
        *buf = 138543618;
        v101 = v10;
        v102 = 2048;
        v103 = v70;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {%{public}@} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)v79 setConfigurationsPrePersonalizedJustCommitted:@"PersonalizeSuccessDecideMore[NO-GRAFTING]"];
    }
  }

  [(MADAutoAssetControlManager *)v79 considerDownloadedWithPSUSLookupResultsForLatestToVend];
  v71 = [(MADAutoAssetControlManager *)v79 descriptorsRequiringGrafting];
  v72 = [v71 count];

  v73 = [(MADAutoAssetControlManager *)v79 autoControlManagerFSM];
  v74 = v73;
  if (v72)
  {
    v75 = @"HaveNeedingGraft";
  }

  else
  {
    v75 = @"NoneNeedingPersonalize";
  }

  v7 = v76;
  [v73 postEvent:v75 withInfo:v76];

LABEL_54:
}

- (void)addActiveJobs:(id)a3 basedOnControl:(id)a4
{
  v28 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"addActiveJobs" ofContainer:@"currentJobsBySelector"];
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  v9 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v10 = [v9 countByEnumeratingWithState:&v30 objects:v34 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v31;
    v26 = v9;
    v27 = v6;
    v25 = *v31;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v31 != v12)
        {
          objc_enumerationMutation(v9);
        }

        v14 = *(*(&v30 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
        v17 = [v16 safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v17 && [(MADAutoAssetControlManager *)self jobToBeIncluded:v17 basedOnControl:v6])
        {
          v18 = [v17 summaryOfJob];
          v19 = v18;
          if (v18)
          {
            [v18 setAssetRepresentation:300];
            [v28 addObject:v19];
          }

          else
          {
            v29 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v20 = [v29 diag];
            v21 = [NSString alloc];
            v22 = [v17 summary];
            v23 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v24 = [v21 initWithFormat:@"{addActiveJobs} unable to form job summaryEntry | job:%@ | %@", v22, v23];
            [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6111 withError:0];

            v6 = v27;
            v12 = v25;

            v9 = v26;
          }
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [v9 countByEnumeratingWithState:&v30 objects:v34 count:16];
    }

    while (v11);
  }
}

- (void)addSuccessfullyDownloadedJobs:(id)a3 basedOnControl:(id)a4
{
  v50 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v54 = objc_alloc_init(MAAutoAssetNotifications);
  [v54 setContentAvailableForUse:1];
  v9 = [(MADAutoAssetControlManager *)self locateDownloadedNewAllBySelector];
  v56 = self;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"addSuccessfullyDownloadedJobs" ofContainer:@"locateDownloadedNewAllBySelector"];
  v66 = 0u;
  v67 = 0u;
  v64 = 0u;
  v65 = 0u;
  v10 = v9;
  v11 = [v10 countByEnumeratingWithState:&v64 objects:v68 count:16];
  if (v11)
  {
    v12 = v11;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v14 = *v65;
    v52 = v10;
    v53 = v6;
    v51 = *v65;
    do
    {
      v15 = 0;
      v55 = v12;
      do
      {
        if (*v65 != v14)
        {
          objc_enumerationMutation(v10);
        }

        v16 = *(*(&v64 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        v18 = [v10 safeObjectForKey:v16 ofClass:objc_opt_class()];
        if (v18 && [p_weak_ivar_lyt[266] descriptorToBeIncluded:v18 basedOnControl:v6])
        {
          v62 = v17;
          v19 = [MAAutoAssetSelector alloc];
          v20 = [v18 assetType];
          v21 = [v18 assetSpecifier];
          v22 = [v18 assetVersion];
          v63 = [v19 initForAssetType:v20 withAssetSpecifier:v21 matchingAssetVersion:v22];

          v61 = [v18 metadata];
          v60 = [v18 neverBeenLocked];
          v59 = [v18 downloadUserInitiated];
          v58 = [v18 downloadedNetworkBytes];
          v57 = [v18 downloadedFilesystemBytes];
          v23 = [v18 isPatch];
          v24 = [v18 patchedFromBaseSelector];
          v25 = [v18 patchedFromBaseFilesystemBytes];
          v26 = [v18 patchingAttempted];
          LOBYTE(v22) = [v18 stagedPriorToAvailable];
          v27 = [v18 stagedFromOSVersion];
          v28 = [v18 stagedFromBuildVersion];
          v29 = [v18 patchingAttemptError];
          LOBYTE(v49) = 1;
          BYTE1(v48) = v22;
          LOBYTE(v48) = v26;
          LOBYTE(v47) = v23;
          v30 = [(MADAutoAssetControlManager *)v56 newAssetStatusForSelector:v63 withNotifications:v54 withAvailableForUseAttributes:v61 withNewerVersionAttributes:0 withNeverBeenLocked:v60 withDownloadUserInitiated:v59 withDownloadProgress:0 withDownloadedNetworkBytes:v58 withDownloadedFilesystemBytes:v57 withDownloadedAsPatch:v47 withPatchedFromBaseSelector:v24 withPatchedFromBaseFilesystemBytes:v25 withPatchingAttempted:v48 withStagedPriorToAvailable:v27 withStagedFromOSVersion:v28 withStagedFromBuildVersion:v49 extendingWithCurrentLockUsage:0 withAvailableForUseError:v29 withPatchingAttemptError:0 withNewerVersionError:?];

          v31 = [v30 copy];
          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v31 setCurrentLockUsage:0];
          }

          v32 = [MAAutoAssetSummary alloc];
          v33 = objc_opt_respondsToSelector();

          if (v33)
          {
            v34 = [MADAutoAssetSecure isSecureAsset:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v35 = [MADAutoAssetSecure isPersonalizationRequired:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v36 = [MADAutoAssetSecure isPrePersonalized:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v37 = [MADAutoAssetSecure isGraftedOrMounted:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v38 = v37;
            if (v37)
            {
              v39 = [MADAutoAssetSecure getGraftPath:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            }

            else
            {
              v39 = 0;
            }

            BYTE3(v48) = v38;
            BYTE2(v48) = v36;
            BYTE1(v48) = v35 ^ 1;
            LOBYTE(v48) = v34;
            v40 = v63;
            v41 = [[MAAutoAssetSummary alloc] initWithAssetSelector:v63 withAssetRepresentation:500 withAssetWasPatched:objc_msgSend(v18 withAssetIsStaged:"isPatch") withJobStatus:0 withScheduledIntervalSecs:v31 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0 withIsSecureMobileAsset:0 withPersonalizationStatus:v48 withPrePersonalizationStatus:v39 withGraftStatus:0 withGraftPoint:0 withStageGroupType:? withTargetOS:?];
          }

          else
          {
            v40 = v63;
            v41 = [[MAAutoAssetSummary alloc] initWithAssetSelector:v63 withAssetRepresentation:500 withAssetWasPatched:objc_msgSend(v18 withAssetIsStaged:"isPatch") withJobStatus:objc_msgSend(v18 withScheduledIntervalSecs:"isPatch") withScheduledRemainingSecs:v31 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:{0, 0, 0}];
          }

          v14 = v51;
          if (v41)
          {
            [v50 addObject:v41];
          }

          else
          {
            v42 = [(MADAutoAssetControlManager *)v56 autoControlManagerFSM];
            v43 = [v42 diag];
            v44 = [NSString alloc];
            v45 = [(MADAutoAssetControlManager *)v56 _updateLatestSummary];
            v46 = [v44 initWithFormat:@"{addSuccessfullyDownloadedJobs} unable to form job jobSummary | %@", v45];
            [v43 trackAnomaly:@"AUTO-CONTROL" forReason:v46 withResult:6111 withError:0];

            v40 = v63;
          }

          v10 = v52;
          v6 = v53;
          v12 = v55;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v17 = v62;
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v12 != v15);
      v12 = [v10 countByEnumeratingWithState:&v64 objects:v68 count:16];
    }

    while (v12);
  }
}

- (id)_updateSandboxExtensionForResponse:(id)a3 responseError:(id)a4 clientRequest:(id)a5 alreadyOnStateQueue:(BOOL)a6
{
  v6 = a6;
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = v10;
  v14 = v13;
  if (__isPlatformVersionAtLeast(2, 17, 4, 0))
  {
    v15 = [v12 clientRequestMessage];
    v16 = objc_opt_respondsToSelector();

    v14 = v13;
    if (v16)
    {
      v17 = [v13 messageName];
      if (([v17 isEqualToString:@"MA-AUTO(REPLY):LOCK_CONTENT"] & 1) == 0)
      {
        v18 = [v13 messageName];
        if (([v18 isEqualToString:@"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE"] & 1) == 0)
        {
          v19 = [v13 messageName];
          if (![v19 isEqualToString:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"])
          {
            v46 = [v13 messageName];
            v47 = [v46 isEqualToString:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"];

            if ((v47 & 1) == 0)
            {
              v14 = v13;
              if (!_MAPreferencesIsVerboseLoggingEnabled())
              {
                goto LABEL_36;
              }

              v22 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
              {
                v48 = v22;
                v49 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                if (v13)
                {
                  v50 = [v13 summary];
                }

                else
                {
                  v50 = @"N";
                }

                v54 = [MADAutoAssetClientRequest responseErrorSummary:v11];
                v55 = [v12 summary];
                *buf = 138544130;
                *&buf[4] = v49;
                *&buf[12] = 2114;
                *&buf[14] = v50;
                *&buf[22] = 2114;
                *&buf[24] = v54;
                v63 = 2114;
                v64 = v55;
                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy not applicable for this message | responseMessage:%{public}@, responseError:%{public}@, clientRequest:%{public}@", buf, 0x2Au);
                if (v13)
                {
                }

                v14 = v13;
                v22 = v48;
              }

              else
              {
                v14 = v13;
              }

              goto LABEL_35;
            }

LABEL_9:
            v59 = self;
            v20 = [v12 clientRequestMessage];
            v21 = [MADAutoAssetAuthorizationPolicy authorizationAssetTypeFromMessage:v20 alreadyOnStateQueue:v6];

            v22 = v21;
            v23 = repositoryPath(v21);
            v24 = getAutoLocalUrlFromTypeGivenDefaultRepoWithPurpose(v22, 1, v23, @"auto");
            v25 = [v24 path];

            v60 = 0u;
            v61 = 0u;
            v26 = [v12 clientRequestMessage];
            v27 = v26;
            if (v26)
            {
              [v26 clientConnectionAuditToken];
            }

            else
            {
              v60 = 0u;
              v61 = 0u;
            }

            *buf = v60;
            *&buf[16] = v61;
            v28 = [MADAutoAssetAuthorizationPolicy issueSandboxExtensionForAuditToken:buf path:v25];
            if (v28)
            {
              log = v11;
              v29 = [v13 message];
              v30 = [v29 mutableCopy];

              v56 = v28;
              [v30 setSafeObject:v28 forKey:@"sandboxExtensionKey"];
              [v30 setSafeObject:v25 forKey:@"sandboxExtensionPathKey"];
              v31 = [SUCoreConnectMessage alloc];
              v32 = [v13 messageType];
              v33 = [v13 messageName];
              v34 = [v13 clientIDRaw];
              [v13 version];
              v35 = v25;
              v37 = v36 = v22;
              v38 = v31;
              v39 = v30;
              v14 = [v38 initWithType:v32 messageName:v33 clientID:v34 version:v37 message:v30];

              v22 = v36;
              v25 = v35;

              v40 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
              {
                v41 = [(MADAutoAssetControlManager *)v59 _updateLatestSummary];
                v42 = v39;
                if (v13)
                {
                  v43 = [v13 summary];
                }

                else
                {
                  v43 = @"N";
                }

                v51 = [v12 summary];
                *buf = 138544386;
                *&buf[4] = v41;
                *&buf[12] = 2114;
                *&buf[14] = v22;
                *&buf[22] = 2114;
                *&buf[24] = v25;
                v63 = 2114;
                v64 = v43;
                v65 = 2114;
                v66 = v51;
                _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy successfully set sandbox extension for response message | assetType=%{public}@, path=%{public}@, responseMessage:%{public}@, clientRequest:%{public}@", buf, 0x34u);
                if (v13)
                {
                }

                v39 = v42;
              }

              v28 = v56;
              v11 = log;
            }

            else
            {
              v39 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
              {
                v44 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                loga = v39;
                if (v13)
                {
                  v45 = [v13 summary];
                }

                else
                {
                  v45 = @"N";
                }

                v52 = [v12 summary];
                *buf = 138544386;
                *&buf[4] = v44;
                *&buf[12] = 2114;
                *&buf[14] = v22;
                *&buf[22] = 2114;
                *&buf[24] = v25;
                v63 = 2114;
                v64 = v45;
                v65 = 2114;
                v66 = v52;
                _os_log_impl(&dword_0, loga, OS_LOG_TYPE_ERROR, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy failed set sandbox extension for response message | assetType=%{public}@, path=%{public}@, responseMessage:%{public}@, clientRequest:%{public}@", buf, 0x34u);
                if (v13)
                {
                }

                v14 = v13;
                v39 = loga;
              }

              else
              {
                v14 = v13;
              }
            }

LABEL_35:
            goto LABEL_36;
          }
        }
      }

      goto LABEL_9;
    }
  }

LABEL_36:

  return v14;
}

- (void)issueResponseToClientRequest:(id)a3 issuingResponseMessage:(id)a4 withResponseError:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [v8 clientReplyCompletion];

  if (v13)
  {
    if (!v9 && v10)
    {
      v14 = [v8 clientRequestMessage];
      v15 = [MADAutoAssetControlManager replyMessageNameForRequest:v14];
      v16 = [v8 clientID];
      v9 = [MADAutoAssetControlManager createSeverMessageWithName:v15 sender:@"com.apple.MAAutoControl" clientID:v16 response:0 error:v10];

LABEL_15:
      v29 = [(MADAutoAssetControlManager *)self statistics];
      v30 = [v29 totalClientRepliesFailure];
LABEL_17:
      [(MADAutoAssetControlManager *)self _statsIncrement:v30 forClientRequest:v8];

      v31 = [v8 clientReplyCompletion];
      v31[2](v31, v9, v10);

      [v8 setClientReplyCompletion:0];
      [(MADAutoAssetControlManager *)self removeClientRequest:v8 fromLocation:@"issueResponseToClientRequest"];
      goto LABEL_18;
    }

    if (!(v9 | v10))
    {
      v10 = [MAAutoAssetError buildError:6111 fromOperation:@"issueResponseToClientRequest" underlyingError:0 withDescription:@"no response message or response error at point where reply is to be issued to client"];
      v20 = [v8 clientRequestMessage];
      v21 = [MADAutoAssetControlManager replyMessageNameForRequest:v20];
      v22 = [v8 clientID];
      v9 = [MADAutoAssetControlManager createSeverMessageWithName:v21 sender:@"com.apple.MAAutoControl" clientID:v22 response:0 error:v10];

      v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v24 = [v23 diag];
      v25 = [NSString alloc];
      v26 = [v8 summary];
      v27 = [v25 initWithFormat:@"%@ | clientRequest:%@", @"no response message or response error at point where reply is to be issued to client", v26];
      [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6111 withError:v10];
    }

    if (v8 && v9 && !v10)
    {
      v28 = [(MADAutoAssetControlManager *)self _updateSandboxExtensionForResponse:v9 responseError:0 clientRequest:v8 alreadyOnStateQueue:1];

      v9 = v28;
    }

    else if (v10)
    {
      goto LABEL_15;
    }

    v29 = [(MADAutoAssetControlManager *)self statistics];
    v30 = [v29 totalClientRepliesSuccess];
    v10 = 0;
    goto LABEL_17;
  }

  v17 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
  {
    v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v19 = [v8 summary];
    *buf = 138543618;
    v33 = v18;
    v34 = 2114;
    v35 = v19;
    _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "[%{public}@] {issueResponseToClientRequest} no response issued (already replied to client) | clientRequest:%{public}@", buf, 0x16u);
  }

LABEL_18:
}

- (void)issueBuiltResponseForEventInfo:(id)a3 issuingResponseMessage:(id)a4 withResponseError:(id)a5 fromLocation:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:issueBuiltResponseForEventInfo", v13];
  v17 = [v10 clientRequest];
  v18 = [v17 clientReplyCompletion];

  if (v18)
  {
    if (!v11 && v12)
    {
      v19 = [v10 clientRequest];
      v20 = [v19 clientRequestMessage];
      v21 = [MADAutoAssetControlManager replyMessageNameForRequest:v20];
      v22 = [v10 clientRequest];
      v23 = [v22 clientID];
      v11 = [MADAutoAssetControlManager createSeverMessageWithName:v21 sender:@"com.apple.MAAutoControl" clientID:v23 response:0 error:v12];

LABEL_22:
      v33 = [(MADAutoAssetControlManager *)self statistics];
      v34 = [v33 totalClientRepliesFailure];
      v35 = [v10 clientRequest];
      [(MADAutoAssetControlManager *)self _statsIncrement:v34 forClientRequest:v35];

      v36 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        v37 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        if (v11)
        {
          v38 = [v11 summary];
        }

        else
        {
          v38 = @"N";
        }

        v42 = [MADAutoAssetClientRequest responseErrorSummary:v12];
        *buf = 138544130;
        v48 = v37;
        v49 = 2114;
        v50 = v16;
        v51 = 2114;
        v52 = v38;
        v53 = 2114;
        v54 = v42;
        _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} responding to client with error | responseMessage:%{public}@, responseError:%{public}@", buf, 0x2Au);
        if (v11)
        {
        }
      }

      goto LABEL_31;
    }

    if (v11 | v12)
    {
      if (!v11 || v12)
      {
        if (v12)
        {
          goto LABEL_22;
        }
      }

      else
      {
        v30 = [v10 clientRequest];

        if (v30)
        {
          v31 = [v10 clientRequest];
          v32 = [(MADAutoAssetControlManager *)self _updateSandboxExtensionForResponse:v11 responseError:0 clientRequest:v31 alreadyOnStateQueue:1];

          v11 = v32;
        }
      }
    }

    else
    {
      v12 = [MAAutoAssetError buildError:6111 fromOperation:v16 underlyingError:0 withDescription:@"about to issue successful response when no response message"];
      v11 = 0;
      if (v12)
      {
        goto LABEL_22;
      }
    }

    v39 = [(MADAutoAssetControlManager *)self statistics];
    v40 = [v39 totalClientRepliesSuccess];
    v41 = [v10 clientRequest];
    [(MADAutoAssetControlManager *)self _statsIncrement:v40 forClientRequest:v41];

    v12 = 0;
LABEL_31:
    v43 = [v10 clientRequest];
    v44 = [v43 clientReplyCompletion];
    v44[2](v44, v11, v12);

    v45 = [v10 clientRequest];
    [v45 setClientReplyCompletion:0];

    v24 = [v10 clientRequest];
    [(MADAutoAssetControlManager *)self removeClientRequest:v24 fromLocation:v16];
    goto LABEL_32;
  }

  v24 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
  {
    v46 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v25 = [v10 clientRequest];
    v26 = [v25 clientReplyCompletion];
    v27 = @"N";
    if (v26)
    {
      v28 = @"Y";
    }

    else
    {
      v28 = @"N";
    }

    if (v11)
    {
      v27 = [v11 summary];
    }

    v29 = [MADAutoAssetClientRequest responseErrorSummary:v12];
    *buf = 138544386;
    v48 = v46;
    v49 = 2114;
    v50 = v16;
    v51 = 2114;
    v52 = v28;
    v53 = 2114;
    v54 = v27;
    v55 = 2114;
    v56 = v29;
    _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no response issued (already completed or scheduled event) | clientReplyCompletion:%{public}@, responseMessage:%{public}@, responseError:%{public}@", buf, 0x34u);
    if (v11)
    {
    }
  }

LABEL_32:
}

- (void)issueResponseForEventInfo:(id)a3 withErrorCode:(int64_t)a4 fromAction:(id)a5 withDescription:(id)a6
{
  v15 = a3;
  v10 = a5;
  v11 = a6;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  if (a4)
  {
    v14 = [[NSString alloc] initWithFormat:@"AUTO-CONTROL(%@)", v10];
    a4 = [MAAutoAssetError buildError:a4 fromOperation:v14 underlyingError:0 withDescription:v11];
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v15 withAutoAssetError:a4 fromAction:v10 withDescription:v11];
}

- (void)issueResponseForEventInfo:(id)a3 withAutoAssetError:(id)a4 fromAction:(id)a5 withDescription:(id)a6
{
  v9 = a5;
  v10 = a4;
  v11 = a3;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [v11 clientRequestMessage];
  v15 = [MADAutoAssetControlManager replyMessageNameForRequest:v14];
  v16 = [v11 clientRequestMessage];
  v17 = [v16 clientID];
  v18 = [MADAutoAssetControlManager createSeverMessageWithName:v15 sender:@"com.apple.MAAutoControl" clientID:v17 response:0 error:v10];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v11 issuingResponseMessage:v18 withResponseError:v10 fromLocation:v9];
}

- (void)issueResponseToFailedAutoAssetLockRequest:(id)a3 forEventInfo:(id)a4 withResponseError:(id)a5 forAttemptedDescriptor:(id)a6
{
  v45 = a3;
  v10 = a4;
  v11 = a5;
  v12 = a6;
  v42 = self;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [v10 jobInformation];
  v43 = [v15 fullAssetSelector];
  v16 = [v10 originalSelector];
  if (v16)
  {
    [v10 originalSelector];
  }

  else
  {
    [v10 autoAssetSelector];
  }
  v17 = ;

  v41 = v15;
  v18 = [v15 clientInstance];
  if (!v12)
  {
    v19 = v42;
    if (v17)
    {
      goto LABEL_8;
    }

LABEL_20:
    v17 = v43;
    if (v18)
    {
      goto LABEL_9;
    }

    goto LABEL_21;
  }

  v19 = v42;
  if (!v17)
  {
    v20 = [MAAutoAssetSelector alloc];
    v21 = [v12 assetType];
    v22 = [v12 assetSpecifier];
    v23 = [v12 assetVersion];
    v17 = [v20 initForAssetType:v21 withAssetSpecifier:v22 matchingAssetVersion:v23];
  }

  if (!v17)
  {
    goto LABEL_20;
  }

LABEL_8:
  if (v18)
  {
    goto LABEL_9;
  }

LABEL_21:
  v18 = [(MADAutoAssetControlManager *)v19 clientRequestMessageInstance:v10];
LABEL_9:
  v24 = [v10 autoAssetUUID];
  v25 = [v10 clientRequest];
  v26 = [v25 responseMessage];
  v27 = [(MADAutoAssetControlManager *)v19 updateAutoAssetStatus:v17 forActiveJobUUID:v24 forJobResponse:v26 withResponseError:v11];

  v44 = v11;
  v40 = v12;
  if (!v27)
  {
    v28 = objc_alloc_init(NSMutableDictionary);
    v39 = [SUCoreConnectMessage alloc];
    v29 = [v10 clientRequest];
    v30 = [v29 clientRequestMessage];
    v31 = [MADAutoAssetControlManager replyMessageNameForRequest:v30];
    v32 = [v10 clientRequest];
    v33 = [v32 clientID];
    v27 = [v39 initWithType:2 messageName:v31 clientID:v33 version:0 message:v28];

    if (!v27)
    {
      v34 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
      {
        v35 = [v10 summary];
        *buf = 138543618;
        v47 = v45;
        v48 = 2114;
        v49 = v35;
        _os_log_impl(&dword_0, v34, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to build response message | eventInfo:%{public}@", buf, 0x16u);
      }
    }

    v11 = v44;
    v19 = v42;
  }

  [(MADAutoAssetControlManager *)v19 issueBuiltResponseForEventInfo:v10 issuingResponseMessage:v27 withResponseError:v11 fromLocation:v45];
  v36 = [v18 autoAssetClientName];
  if (v36)
  {
    [v18 autoAssetClientName];
  }

  else
  {
    [v18 clientProcessName];
  }
  v37 = ;
  v38 = [v40 assetId];
  [MADAutoAssetHistory recordFailedOperation:500 fromClient:v37 forAssetID:v38 withSelector:v17 failingWithError:v44];
}

- (void)issueResponseToFailedSetLockRequest:(id)a3 forEventInfo:(id)a4 forAtomicInstance:(id)a5 withResponseError:(id)a6
{
  v31 = a4;
  v10 = a6;
  v30 = a5;
  v11 = a3;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v29 = [v31 setJobInformation];
  v14 = [v29 clientInstance];
  v15 = [v14 autoAssetSetClientName];
  if (v15)
  {
    [v14 autoAssetSetClientName];
  }

  else
  {
    [v14 clientProcessName];
  }
  v16 = ;

  if (v16)
  {
    v17 = v16;
  }

  else
  {
    v17 = @"UNKNOWN";
  }

  v18 = [v14 clientDomainName];
  v19 = [v31 assetSetIdentifier];
  v20 = [v31 clientRequest];
  v21 = [v20 responseMessage];
  v22 = [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v11 forClientDomain:v18 forAssetSetIdentifier:v19 forJobResponse:v21 withResponseError:v10 clearingDownloadProgressReason:@"failed attempt to lock set" withAssetSetStatus:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:v31 issuingResponseMessage:v22 withResponseError:v10 fromLocation:v11];
  v23 = [v14 clientDomainName];
  v24 = v23;
  if (v23)
  {
    v25 = v23;
  }

  else
  {
    v25 = @"UNKNOWN";
  }

  v26 = [v14 assetSetIdentifier];
  v27 = v26;
  if (v26)
  {
    v28 = v26;
  }

  else
  {
    v28 = @"UNKNOWN";
  }

  [MADAutoAssetHistory recordFailedOperation:500 fromClient:v17 forClientDomainName:v25 forAssetSetIdentifier:v28 forAtomicInstance:v30 failingWithError:v10];
}

- (id)clientRequestMessageName:(id)a3
{
  v3 = [a3 clientRequestMessage];
  v4 = [v3 messageName];

  return v4;
}

- (id)clientRequestMessageInstance:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientRequestMessage];

  v8 = [v7 message];

  v9 = [v8 objectForKey:@"instance"];
  if (!v9)
  {
    goto LABEL_31;
  }

  v10 = [v8 safeObjectForKey:@"instance" ofClass:objc_opt_class()];
  if (!v10)
  {
    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v47 = v24;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageInstance} MAAutoAssetInfoInstance of unexpected class", buf, 0xCu);
    }

    goto LABEL_30;
  }

  v11 = v10;
  v12 = [v10 autoAssetClientName];
  if (v12)
  {
    v13 = v12;
    v14 = [v11 clientProcessName];
    if (v14)
    {
      v15 = v14;
      v16 = [v11 clientAssetSelector];
      if (v16)
      {
        v17 = v16;
        v18 = [v11 clientAssetSelector];
        v19 = [v18 assetType];
        if (v19)
        {
          v20 = v19;
          v21 = [v11 clientAssetSelector];
          [v21 assetSpecifier];
          v22 = v44 = v18;

          if (v22)
          {
            goto LABEL_32;
          }

          goto LABEL_14;
        }
      }
    }
  }

LABEL_14:
  v38 = self;
  v43 = v9;
  v45 = v8;
  v40 = [NSMutableString alloc];
  v42 = [v11 autoAssetClientName];
  v25 = @"autoAssetClientName";
  if (v42)
  {
    v25 = &stru_4BD3F0;
  }

  v39 = v25;
  v41 = [v11 clientProcessName];
  if (v41)
  {
    v26 = &stru_4BD3F0;
  }

  else
  {
    v26 = @"clientProcessName";
  }

  v27 = [v11 clientAssetSelector];
  if (v27)
  {
    v28 = &stru_4BD3F0;
  }

  else
  {
    v28 = @"clientAssetSelector";
  }

  v29 = [v11 clientAssetSelector];
  v30 = [v29 assetType];
  if (v30)
  {
    v31 = &stru_4BD3F0;
  }

  else
  {
    v31 = @"assetType";
  }

  v32 = [v11 clientAssetSelector];
  v33 = [v32 assetSpecifier];
  v34 = @"assetSpecifier";
  if (v33)
  {
    v34 = &stru_4BD3F0;
  }

  v23 = [v40 initWithFormat:@"(%@, %@, %@, %@, %@, %@)", &stru_4BD3F0, v39, v26, v28, v31, v34];

  v35 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
  {
    v36 = [(MADAutoAssetControlManager *)v38 _updateLatestSummary];
    *buf = 138543618;
    v47 = v36;
    v48 = 2114;
    v49 = v23;
    _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageInstance} invalid MAAutoAssetInfoInstance | missing:%{public}@", buf, 0x16u);
  }

  v9 = v43;
  v8 = v45;
LABEL_30:

LABEL_31:
  v11 = 0;
LABEL_32:

  return v11;
}

- (id)clientRequestMessageDesire:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 message];

  v8 = [v7 objectForKey:@"desire"];
  if (v8)
  {
    v9 = [v7 safeObjectForKey:@"desire" ofClass:objc_opt_class()];
    if (v9)
    {
      goto LABEL_7;
    }

    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v13 = 138543362;
      v14 = v11;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageDesire} MAAutoAssetInfoDesire of unexpected class", &v13, 0xCu);
    }
  }

  v9 = 0;
LABEL_7:

  return v9;
}

- (BOOL)clientRequestIndicatesNoWait:(id)a3
{
  v4 = a3;
  v5 = [v4 clientRequestMessage];
  v6 = [v5 message];

  v7 = [v6 safeObjectForKey:@"desire" ofClass:objc_opt_class()];
  v8 = [v4 clientReplyCompletion];

  v9 = 0;
  if (v8 && v7)
  {
    v10 = [v4 clientRequest];
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v10];

    if ([SUCore stringIsEqual:v11 to:@"MA-AUTO:CHECK_FOR_NEWER"])
    {
      v9 = [v7 checkWaitTimeoutSecs] == 0;
    }

    else
    {
      v9 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO:LOCK_CONTENT") && (![v7 checkWaitTimeoutSecs] || !objc_msgSend(v7, "lockWaitTimeoutSecs"));
    }
  }

  return v9;
}

- (id)clientRequestMessageSetInstance:(id)a3 withEventInfo:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v7 clientRequestMessage];

  v11 = [v10 message];

  v12 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:v11 forKey:@"setInstance"];
  v13 = v12;
  if (v12)
  {
    v14 = [v12 autoAssetSetClientName];
    if (v14)
    {
      v15 = v14;
      v16 = [v13 clientProcessName];
      if (!v16)
      {
        v32 = self;
        v33 = v11;
        v19 = v6;

        goto LABEL_8;
      }

      v17 = v16;
      v18 = [v13 assetSetIdentifier];

      if (v18)
      {
        goto LABEL_20;
      }
    }

    v32 = self;
    v33 = v11;
    v19 = v6;
LABEL_8:
    v20 = &stru_4BD3F0;
    goto LABEL_9;
  }

  v32 = self;
  v33 = v11;
  v19 = v6;
  v20 = @"instance";
LABEL_9:
  v21 = [NSMutableString alloc];
  v22 = [v13 autoAssetSetClientName];
  if (v22)
  {
    v23 = &stru_4BD3F0;
  }

  else
  {
    v23 = @"autoAssetSetClientName";
  }

  v24 = [v13 clientProcessName];
  if (v24)
  {
    v25 = &stru_4BD3F0;
  }

  else
  {
    v25 = @"clientProcessName";
  }

  v26 = [v13 assetSetIdentifier];
  v27 = @"assetSetIdentifier";
  if (v26)
  {
    v27 = &stru_4BD3F0;
  }

  v28 = [v21 initWithFormat:@"(%@, %@, %@, %@)", v20, v23, v25, v27];

  v29 = _MADLog(@"AutoControl");
  v6 = v19;
  if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
  {
    v30 = [(MADAutoAssetControlManager *)v32 _updateLatestSummary];
    *buf = 138543874;
    v35 = v19;
    v36 = 2114;
    v37 = v30;
    v38 = 2114;
    v39 = v28;
    _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:clientRequestMessageSetInstance} invalid MANAutoAssetSetInfoInstance | missing:%{public}@", buf, 0x20u);
  }

  v13 = 0;
  v11 = v33;
LABEL_20:

  return v13;
}

- (id)clientRequestMessageSetDesire:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientRequestMessage];
  v8 = [v7 message];

  v9 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:v8 forKey:@"setDesire"];
  if (!v9)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v12 = [v4 summary];
      v14 = 138543618;
      v15 = v11;
      v16 = 2114;
      v17 = v12;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetDesire} MISSING:desire | clientRequest:%{public}@", &v14, 0x16u);
    }
  }

  return v9;
}

- (id)clientRequestMessageSetPolicy:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 messageName];
  v8 = [v4 message];
  v9 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:v8 forKey:@"setDesire"];
  v10 = v9;
  if (v9)
  {
    v11 = [v9 clientAssetSetPolicy];
  }

  else
  {
    if (([SUCore stringIsEqual:v7 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v7 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v7 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v7 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v7 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"])
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v14 = [v4 summary];
        v16 = 138543618;
        v17 = v13;
        v18 = 2114;
        v19 = v14;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetPolicy} MISSING:desire | clientRequestMessage:%{public}@", &v16, 0x16u);
      }
    }

    v11 = 0;
  }

  return v11;
}

- (id)clientRequestMessageSetEnd:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientRequestMessage];
  v8 = [v7 message];

  v9 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:v8 forKey:@"setEnd"];
  if (!v9)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v12 = [v4 summary];
      v14 = 138543618;
      v15 = v11;
      v16 = 2114;
      v17 = v12;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetEnd} MISSING:end | clientRequest:%{public}@", &v14, 0x16u);
    }
  }

  return v9;
}

+ (BOOL)isMessageNameForSetMessage:(id)a3
{
  v3 = a3;
  v4 = ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL(REPLY):ASSET_SETS_OVERVIEW"]& 1) != 0
    || [SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL(REPLY):SET_INSTANCE_INFO"];

  return v4;
}

+ (id)replyMessageNameForRequest:(id)a3
{
  v3 = a3;
  v4 = [v3 messageName];
  v5 = [SUCore stringIsEqual:v4 to:@"MA-AUTO:INTEREST_IN_CONTENT"];

  if (v5)
  {
    v6 = @"MA-AUTO(REPLY):INTEREST_IN_CONTENT";
  }

  else
  {
    v7 = [v3 messageName];
    v8 = [SUCore stringIsEqual:v7 to:@"MA-AUTO:CHECK_FOR_NEWER"];

    if (v8)
    {
      v6 = @"MA-AUTO(REPLY):CHECK_FOR_NEWER";
    }

    else
    {
      v9 = [v3 messageName];
      v10 = [SUCore stringIsEqual:v9 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"];

      if (v10)
      {
        v6 = @"MA-AUTO(REPLY):DETERMINE_IF_AVAILABLE";
      }

      else
      {
        v11 = [v3 messageName];
        v12 = [SUCore stringIsEqual:v11 to:@"MA-AUTO:CURRENT_STATUS"];

        if (v12)
        {
          v6 = @"MA-AUTO(REPLY):CURRENT_STATUS";
        }

        else
        {
          v13 = [v3 messageName];
          v14 = [SUCore stringIsEqual:v13 to:@"MA-AUTO:LOCK_CONTENT"];

          if (v14)
          {
            v6 = @"MA-AUTO(REPLY):LOCK_CONTENT";
          }

          else
          {
            v15 = [v3 messageName];
            v16 = [SUCore stringIsEqual:v15 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"];

            if (v16)
            {
              v6 = @"MA-AUTO(REPLY):MAP_LOCKED_CONTENT_TO_EXCLAVE";
            }

            else
            {
              v17 = [v3 messageName];
              v18 = [SUCore stringIsEqual:v17 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"];

              if (v18)
              {
                v6 = @"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE";
              }

              else
              {
                v19 = [v3 messageName];
                v20 = [SUCore stringIsEqual:v19 to:@"MA-AUTO:END_LOCK_USAGE"];

                if (v20)
                {
                  v6 = @"MA-AUTO(REPLY):END_LOCK_USAGE";
                }

                else
                {
                  v21 = [v3 messageName];
                  v22 = [SUCore stringIsEqual:v21 to:@"MA-AUTO:END_PREVIOUS_LOCKS"];

                  if (v22)
                  {
                    v6 = @"MA-AUTO(REPLY):END_PREVIOUS_LOCKS";
                  }

                  else
                  {
                    v23 = [v3 messageName];
                    v24 = [SUCore stringIsEqual:v23 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"];

                    if (v24)
                    {
                      v6 = @"MA-AUTO(REPLY):END_ALL_PREVIOUS_LOCKS";
                    }

                    else
                    {
                      v25 = [v3 messageName];
                      v26 = [SUCore stringIsEqual:v25 to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"];

                      if (v26)
                      {
                        v6 = @"MA-AUTO(REPLY):CANCEL_ACTIVITY_FOR_SELECTOR";
                      }

                      else
                      {
                        v27 = [v3 messageName];
                        v28 = [SUCore stringIsEqual:v27 to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"];

                        if (v28)
                        {
                          v6 = @"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_SELECTOR";
                        }

                        else
                        {
                          v29 = [v3 messageName];
                          v30 = [SUCore stringIsEqual:v29 to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"];

                          if (v30)
                          {
                            v6 = @"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_ASSET_TYPE";
                          }

                          else
                          {
                            v31 = [v3 messageName];
                            v32 = [SUCore stringIsEqual:v31 to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];

                            if (v32)
                            {
                              v6 = @"MA-AUTO(REPLY):ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR";
                            }

                            else
                            {
                              v33 = [v3 messageName];
                              v34 = [SUCore stringIsEqual:v33 to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];

                              if (v34)
                              {
                                v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE";
                              }

                              else
                              {
                                v35 = [v3 messageName];
                                v36 = [SUCore stringIsEqual:v35 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];

                                if (v36)
                                {
                                  v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE_FOR_UPDATE";
                                }

                                else
                                {
                                  v37 = [v3 messageName];
                                  v38 = [SUCore stringIsEqual:v37 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"];

                                  if (v38)
                                  {
                                    v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE";
                                  }

                                  else
                                  {
                                    v39 = [v3 messageName];
                                    v40 = [SUCore stringIsEqual:v39 to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"];

                                    if (v40)
                                    {
                                      v6 = @"MA-AUTO-STAGE(REPLY):DOWNLOAD_GROUPS";
                                    }

                                    else
                                    {
                                      v41 = [v3 messageName];
                                      v42 = [SUCore stringIsEqual:v41 to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"];

                                      if (v42)
                                      {
                                        v6 = @"MA-AUTO-STAGE(REPLY):DOWNLOAD_ALL";
                                      }

                                      else
                                      {
                                        v43 = [v3 messageName];
                                        v44 = [SUCore stringIsEqual:v43 to:@"MA-AUTO-STAGE:CANCEL_OPERATION"];

                                        if (v44)
                                        {
                                          v6 = @"MA-AUTO-STAGE(REPLY):CANCEL_OPERATION";
                                        }

                                        else
                                        {
                                          v45 = [v3 messageName];
                                          v46 = [SUCore stringIsEqual:v45 to:@"MA-AUTO-STAGE:PURGE_ALL"];

                                          if (v46)
                                          {
                                            v6 = @"MA-AUTO-STAGE(REPLY):PURGE_ALL";
                                          }

                                          else
                                          {
                                            v47 = [v3 messageName];
                                            v48 = [SUCore stringIsEqual:v47 to:@"MA-AUTO-STAGE:ERASE_ALL"];

                                            if (v48)
                                            {
                                              v6 = @"MA-AUTO-STAGE(REPLY):ERASE_ALL";
                                            }

                                            else
                                            {
                                              v49 = [v3 messageName];
                                              v50 = [SUCore stringIsEqual:v49 to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"];

                                              if (v50)
                                              {
                                                v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):EVICTABLE_BYTES";
                                              }

                                              else
                                              {
                                                v51 = [v3 messageName];
                                                v52 = [SUCore stringIsEqual:v51 to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"];

                                                if (v52)
                                                {
                                                  v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):SUSPEND";
                                                }

                                                else
                                                {
                                                  v53 = [v3 messageName];
                                                  v54 = [SUCore stringIsEqual:v53 to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"];

                                                  if (v54)
                                                  {
                                                    v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):RESUME";
                                                  }

                                                  else
                                                  {
                                                    v55 = [v3 messageName];
                                                    v56 = [SUCore stringIsEqual:v55 to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"];

                                                    if (v56)
                                                    {
                                                      v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):STATUS";
                                                    }

                                                    else
                                                    {
                                                      v57 = [v3 messageName];
                                                      v58 = [SUCore stringIsEqual:v57 to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"];

                                                      if (v58)
                                                      {
                                                        v6 = @"MA-AUTO-CONTROL(REPLY):CONTROL_STATISTICS";
                                                      }

                                                      else
                                                      {
                                                        v59 = [v3 messageName];
                                                        v60 = [SUCore stringIsEqual:v59 to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"];

                                                        if (v60)
                                                        {
                                                          v6 = @"MA-AUTO-CONTROL(REPLY):KNOWN_ASSET_SUMMARY";
                                                        }

                                                        else
                                                        {
                                                          v61 = [v3 messageName];
                                                          v62 = [SUCore stringIsEqual:v61 to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];

                                                          if (v62)
                                                          {
                                                            v6 = @"MA-AUTO-CONTROL(REPLY):AVAILABLE_FOR_STAGING_ASSET_SUMMARY";
                                                          }

                                                          else
                                                          {
                                                            v63 = [v3 messageName];
                                                            v64 = [SUCore stringIsEqual:v63 to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"];

                                                            if (v64)
                                                            {
                                                              v6 = @"MA-AUTO-CONTROL(REPLY):ACTIVE_JOB_SUMMARY";
                                                            }

                                                            else
                                                            {
                                                              v65 = [v3 messageName];
                                                              v66 = [SUCore stringIsEqual:v65 to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"];

                                                              if (v66)
                                                              {
                                                                v6 = @"MA-AUTO-CONTROL(REPLY):SCHEDULED_JOB_SUMMARY";
                                                              }

                                                              else
                                                              {
                                                                v67 = [v3 messageName];
                                                                v68 = [SUCore stringIsEqual:v67 to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"];

                                                                if (v68)
                                                                {
                                                                  v6 = @"MA-AUTO-CONTROL(REPLY):LOCKED_ASSET_SUMMARY";
                                                                }

                                                                else
                                                                {
                                                                  v69 = [v3 messageName];
                                                                  v70 = [SUCore stringIsEqual:v69 to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"];

                                                                  if (v70)
                                                                  {
                                                                    v6 = @"MA-AUTO-CONTROL(REPLY):STAGED_ASSET_SUMMARY";
                                                                  }

                                                                  else
                                                                  {
                                                                    v71 = [v3 messageName];
                                                                    v72 = [SUCore stringIsEqual:v71 to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"];

                                                                    if (v72)
                                                                    {
                                                                      v6 = @"MA-AUTO-CONTROL(REPLY):STAGER_OVERVIEW";
                                                                    }

                                                                    else
                                                                    {
                                                                      v73 = [v3 messageName];
                                                                      v74 = [SUCore stringIsEqual:v73 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"];

                                                                      if (v74)
                                                                      {
                                                                        v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_UNLOCK";
                                                                      }

                                                                      else
                                                                      {
                                                                        v75 = [v3 messageName];
                                                                        v76 = [SUCore stringIsEqual:v75 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"];

                                                                        if (v76)
                                                                        {
                                                                          v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_FORGET";
                                                                        }

                                                                        else
                                                                        {
                                                                          v77 = [v3 messageName];
                                                                          v78 = [SUCore stringIsEqual:v77 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"];

                                                                          if (v78)
                                                                          {
                                                                            v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_PURGE";
                                                                          }

                                                                          else
                                                                          {
                                                                            v79 = [v3 messageName];
                                                                            v80 = [SUCore stringIsEqual:v79 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"];

                                                                            if (v80)
                                                                            {
                                                                              v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_ABANDON";
                                                                            }

                                                                            else
                                                                            {
                                                                              v81 = [v3 messageName];
                                                                              v82 = [SUCore stringIsEqual:v81 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];

                                                                              if (v82)
                                                                              {
                                                                                v6 = @"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE";
                                                                              }

                                                                              else
                                                                              {
                                                                                v83 = [v3 messageName];
                                                                                v84 = [SUCore stringIsEqual:v83 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"];

                                                                                if (v84)
                                                                                {
                                                                                  v6 = @"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_RECLAIM_SPACE";
                                                                                }

                                                                                else
                                                                                {
                                                                                  v85 = [v3 messageName];
                                                                                  v86 = [SUCore stringIsEqual:v85 to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"];

                                                                                  if (v86)
                                                                                  {
                                                                                    v6 = @"MA-AUTO-CONTROL(REPLY):SIM_SET_JOB_OPERATION";
                                                                                  }

                                                                                  else
                                                                                  {
                                                                                    v87 = [v3 messageName];
                                                                                    v88 = [SUCore stringIsEqual:v87 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];

                                                                                    if (v88)
                                                                                    {
                                                                                      v6 = @"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC";
                                                                                    }

                                                                                    else
                                                                                    {
                                                                                      v89 = [v3 messageName];
                                                                                      v90 = [SUCore stringIsEqual:v89 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];

                                                                                      if (v90)
                                                                                      {
                                                                                        v6 = @"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC";
                                                                                      }

                                                                                      else
                                                                                      {
                                                                                        v91 = [v3 messageName];
                                                                                        v92 = [SUCore stringIsEqual:v91 to:@"MA-AUTO-SET:CHECK_ATOMIC"];

                                                                                        if (v92)
                                                                                        {
                                                                                          v6 = @"MA-AUTO-SET(REPLY):CHECK_ATOMIC";
                                                                                        }

                                                                                        else
                                                                                        {
                                                                                          v93 = [v3 messageName];
                                                                                          v94 = [SUCore stringIsEqual:v93 to:@"MA-AUTO-SET:LOCK_ATOMIC"];

                                                                                          if (v94)
                                                                                          {
                                                                                            v6 = @"MA-AUTO-SET(REPLY):LOCK_ATOMIC";
                                                                                          }

                                                                                          else
                                                                                          {
                                                                                            v95 = [v3 messageName];
                                                                                            v96 = [SUCore stringIsEqual:v95 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];

                                                                                            if (v96)
                                                                                            {
                                                                                              v6 = @"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY";
                                                                                            }

                                                                                            else
                                                                                            {
                                                                                              v97 = [v3 messageName];
                                                                                              v98 = [SUCore stringIsEqual:v97 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"];

                                                                                              if (v98)
                                                                                              {
                                                                                                v6 = @"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC";
                                                                                              }

                                                                                              else
                                                                                              {
                                                                                                v99 = [v3 messageName];
                                                                                                v100 = [SUCore stringIsEqual:v99 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];

                                                                                                if (v100)
                                                                                                {
                                                                                                  v6 = @"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK";
                                                                                                }

                                                                                                else
                                                                                                {
                                                                                                  v101 = [v3 messageName];
                                                                                                  v102 = [SUCore stringIsEqual:v101 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"];

                                                                                                  if (v102)
                                                                                                  {
                                                                                                    v6 = @"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK";
                                                                                                  }

                                                                                                  else
                                                                                                  {
                                                                                                    v103 = [v3 messageName];
                                                                                                    v104 = [SUCore stringIsEqual:v103 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"];

                                                                                                    if (v104)
                                                                                                    {
                                                                                                      v6 = @"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT";
                                                                                                    }

                                                                                                    else
                                                                                                    {
                                                                                                      v105 = [v3 messageName];
                                                                                                      v106 = [SUCore stringIsEqual:v105 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];

                                                                                                      if (v106)
                                                                                                      {
                                                                                                        v6 = @"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING";
                                                                                                      }

                                                                                                      else
                                                                                                      {
                                                                                                        v107 = [v3 messageName];
                                                                                                        v108 = [SUCore stringIsEqual:v107 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"];

                                                                                                        if (v108)
                                                                                                        {
                                                                                                          v6 = @"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS";
                                                                                                        }

                                                                                                        else
                                                                                                        {
                                                                                                          v109 = [v3 messageName];
                                                                                                          v110 = [SUCore stringIsEqual:v109 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"];

                                                                                                          if (v110)
                                                                                                          {
                                                                                                            v6 = @"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC";
                                                                                                          }

                                                                                                          else
                                                                                                          {
                                                                                                            v111 = [v3 messageName];
                                                                                                            v112 = [SUCore stringIsEqual:v111 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"];

                                                                                                            if (v112)
                                                                                                            {
                                                                                                              v6 = @"MA-AUTO-SET-CONTROL(REPLY):ASSET_SETS_OVERVIEW";
                                                                                                            }

                                                                                                            else
                                                                                                            {
                                                                                                              v113 = [v3 messageName];
                                                                                                              v114 = [SUCore stringIsEqual:v113 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];

                                                                                                              if (v114)
                                                                                                              {
                                                                                                                v6 = @"MA-AUTO-SET-CONTROL(REPLY):SET_INSTANCE_INFO";
                                                                                                              }

                                                                                                              else
                                                                                                              {
                                                                                                                v6 = @"UNKNOWN_REQUEST_NAME";
                                                                                                              }
                                                                                                            }
                                                                                                          }
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }

  return v6;
}

+ (id)newSummaryForRequestMessage:(id)a3 includingSelector:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v6 = [NSMutableString alloc];
  v7 = [v5 messageName];
  v8 = [v6 initWithFormat:@"%@", v7];

  v9 = [v5 message];

  if (v9)
  {
    v10 = [v5 messageName];
    v11 = [MADAutoAssetControlManager isMessageNameForSetMessage:v10];

    if (v11)
    {
      v12 = [v5 message];
      v13 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:v12 forKey:@"setInstance"];

      v14 = [v5 message];
      v15 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:v14 forKey:@"setDesire"];

      v16 = [v5 message];
      v17 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:v16 forKey:@"setEnd"];

      v18 = [v5 message];
      v19 = [MASAutoAssetSetInfoControl newShimmedFromFrameworkMessage:v18 forKey:@"setControl"];

      if (v13)
      {
        if (v4)
        {
          v20 = [v13 summary];
        }

        else
        {
          v48 = [NSString alloc];
          v52 = [v13 autoAssetSetClientName];
          v51 = [v13 clientProcessName];
          v46 = [v13 clientProcessID];
          v28 = [v13 atomicInstance];
          if (v28)
          {
            v50 = [v13 atomicInstance];
          }

          else
          {
            v50 = @"N";
          }

          v47 = [v13 autoAssetEntries];
          if (v47)
          {
            v36 = [NSString alloc];
            v44 = [v13 autoAssetEntries];
            v49 = [v36 initWithFormat:@"%ld", objc_msgSend(v44, "count")];
          }

          else
          {
            v49 = @"N";
          }

          v37 = [v13 entriesWhenTargeting];
          if (v37)
          {
            v38 = [NSString alloc];
            [v13 entriesWhenTargeting];
            v39 = v45 = v28;
            v40 = [v38 initWithFormat:@"%ld", objc_msgSend(v39, "count")];
            v20 = [v48 initWithFormat:@"clientName:%@|processName:%@|pid:%ld|atomicInstance:%@|entries:%@(WhenTargeting:%@)", v52, v51, v46, v50, v49, v40];

            v28 = v45;
          }

          else
          {
            v20 = [v48 initWithFormat:@"clientName:%@|processName:%@|pid:%ld|atomicInstance:%@|entries:%@(WhenTargeting:%@)", v52, v51, v46, v50, v49, @"N"];
          }

          if (v47)
          {
          }

          if (v28)
          {
          }
        }

        [v8 appendFormat:@"[instance:%@]", v20];
      }

      if (v15)
      {
        v41 = [v15 summary];
        [v8 appendFormat:@"[desire:%@]", v41];
      }

      if (v17)
      {
        v42 = [v17 summary];
        [v8 appendFormat:@"[end:%@]", v42];
      }

      if (!v19)
      {
        goto LABEL_41;
      }

      v26 = [v19 summary];
      [v8 appendFormat:@"[control:%@]", v26];
    }

    else
    {
      v21 = [v5 message];
      v13 = [v21 safeObjectForKey:@"instance" ofClass:objc_opt_class()];

      v22 = [v5 message];
      v15 = [v22 safeObjectForKey:@"desire" ofClass:objc_opt_class()];

      v23 = [v5 message];
      v17 = [v23 safeObjectForKey:@"listen" ofClass:objc_opt_class()];

      v24 = [v5 message];
      v19 = [v24 safeObjectForKey:@"end" ofClass:objc_opt_class()];

      v25 = [v5 message];
      v26 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:v25 forKey:@"control"];

      if (v13)
      {
        if (v4)
        {
          v27 = [v13 summary];
        }

        else
        {
          v29 = [NSString alloc];
          v30 = [v13 autoAssetClientName];
          v31 = [v13 clientProcessName];
          v27 = [v29 initWithFormat:@"%@(%@:%ld)", v30, v31, objc_msgSend(v13, "clientProcessID")];
        }

        [v8 appendFormat:@"[instance:%@]", v27];
      }

      if (v15)
      {
        v32 = [v15 summary];
        [v8 appendFormat:@"[desire:%@]", v32];
      }

      if (v17)
      {
        v33 = [v17 summary];
        [v8 appendFormat:@"[listen:%@]", v33];
      }

      if (v19)
      {
        v34 = [v19 summary];
        [v8 appendFormat:@"[end:%@]", v34];
      }

      if (v26)
      {
        v35 = [v26 summary];
        [v8 appendFormat:@"[control:%@]", v35];
      }
    }

LABEL_41:
  }

  return v8;
}

+ (id)assetTypeForClientDomainName:(id)a3 forSetIdentifier:(id)a4 alreadyOnStateQueue:(BOOL)a5
{
  v5 = a5;
  v7 = a3;
  v8 = a4;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v10 = v9;
  v27 = 0;
  v28 = &v27;
  v29 = 0x3032000000;
  v30 = __Block_byref_object_copy__12;
  v31 = __Block_byref_object_dispose__12;
  v32 = 0;
  if (v5)
  {
    v11 = [v9 autoControlManagerFSM];
    v12 = [v11 extendedStateQueue];
    dispatch_assert_queue_V2(v12);

    v13 = [v10 setConfigurationForClientDomain:v7 forAssetSetIdentifier:v8];
    v14 = [v13 firstEntryAssetType];
    v15 = v28[5];
    v28[5] = v14;
  }

  else
  {
    v16 = [v9 autoControlManagerFSM];

    if (v16)
    {
      v17 = [v10 autoControlManagerFSM];
      v18 = [v17 extendedStateQueue];
      v21[0] = _NSConcreteStackBlock;
      v21[1] = 3221225472;
      v21[2] = __96__MADAutoAssetControlManager_assetTypeForClientDomainName_forSetIdentifier_alreadyOnStateQueue___block_invoke;
      v21[3] = &unk_4B48A0;
      v22 = v10;
      v23 = v7;
      v24 = v8;
      v25 = &v27;
      dispatch_sync(v18, v21);

      v13 = v22;
    }

    else
    {
      v13 = _MADLog(@"Auto");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "AUTO:{assetTypeForClientDomainName} Returning nil for asset type since FSM is not initialized", buf, 2u);
      }
    }
  }

  v19 = v28[5];
  _Block_object_dispose(&v27, 8);

  return v19;
}

void __96__MADAutoAssetControlManager_assetTypeForClientDomainName_forSetIdentifier_alreadyOnStateQueue___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) setConfigurationForClientDomain:*(a1 + 40) forAssetSetIdentifier:*(a1 + 48)];
  v2 = [v5 firstEntryAssetType];
  v3 = *(*(a1 + 56) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

+ (id)newSummaryForSetRequestMessage:(id)a3 includingSetAtomicInstance:(BOOL)a4
{
  v4 = a4;
  v5 = a3;
  v6 = [NSMutableString alloc];
  v7 = [v5 messageName];
  v8 = [v6 initWithFormat:@"%@", v7];

  v9 = [v5 message];

  if (v9)
  {
    v10 = [v5 message];
    v11 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:v10 forKey:@"setInstance"];

    v12 = [v5 message];
    v13 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:v12 forKey:@"desire"];

    v14 = [v5 message];
    v15 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:v14 forKey:@"end"];

    if (v11)
    {
      if (v4)
      {
        v16 = [v11 summary];
      }

      else
      {
        v30 = [NSString alloc];
        v36 = [v11 clientDomainName];
        v35 = [v11 autoAssetSetClientName];
        v34 = [v11 clientProcessName];
        v29 = [v11 clientProcessID];
        v33 = [v11 assetSetIdentifier];
        v17 = [v11 atomicInstance];
        if (v17)
        {
          v32 = [v11 atomicInstance];
        }

        else
        {
          v32 = @"N";
        }

        v18 = [v11 autoAssetEntries];
        if (v18)
        {
          v19 = [NSString alloc];
          v27 = [v11 autoAssetEntries];
          v31 = [v19 initWithFormat:@"%ld", objc_msgSend(v27, "count")];
        }

        else
        {
          v31 = @"N";
        }

        v20 = [v11 entriesWhenTargeting];
        if (v20)
        {
          v21 = [NSString alloc];
          [v11 entriesWhenTargeting];
          v22 = v28 = v17;
          v23 = [v21 initWithFormat:@"%ld", objc_msgSend(v22, "count")];
          v16 = [v30 initWithFormat:@"domainName:%@|clientName:%@|processName:%@|pid:%ld|setIdentifier:%@|atomicInstance:%@|entries:%@(WhenTargeting:%@)", v36, v35, v34, v29, v33, v32, v31, v23];

          v17 = v28;
        }

        else
        {
          v16 = [v30 initWithFormat:@"domainName:%@|clientName:%@|processName:%@|pid:%ld|setIdentifier:%@|atomicInstance:%@|entries:%@(WhenTargeting:%@)", v36, v35, v34, v29, v33, v32, v31, @"N"];
        }

        if (v18)
        {
        }

        if (v17)
        {
        }
      }

      [v8 appendFormat:@"[instance:%@]", v16];
    }

    if (v13)
    {
      v24 = [v13 summary];
      [v8 appendFormat:@"[desire:%@]", v24];
    }

    if (v15)
    {
      v25 = [v15 summary];
      [v8 appendFormat:@"[end:%@]", v25];
    }
  }

  return v8;
}

- (void)eliminateUngraftDescriptor:(id)a3 forAutoAssetDescriptor:(id)a4 failingClientRequestForEventInfo:(id)a5
{
  v25 = a4;
  v8 = a5;
  v9 = a3;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:eliminateUngraftDescriptor", v9];
  v13 = [MAAutoAssetError buildError:6114 fromOperation:v12 underlyingError:0 withDescription:@"auto-asset eliminate occurred when had been personalizing / grafting [or mounting]"];
  v14 = [MAAutoAssetSelector alloc];
  v15 = [v25 assetType];
  v16 = [v25 assetSpecifier];
  v17 = [v25 assetVersion];
  v18 = [v14 initForAssetType:v15 withAssetSpecifier:v16 matchingAssetVersion:v17];

  v19 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:v18];
  [(MADAutoAssetControlManager *)self secureForceUngraft:v12 forDescriptorBeingRemoved:v25];
  if (v8)
  {
    [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:v12 forEventInfo:v8 withResponseError:v13 forAttemptedDescriptor:v25];
  }

  if ([v25 secureOperationEliminating])
  {
    if (v19)
    {
      [(MADAutoAssetControlManager *)self _eliminateSecureOperationFinished:v19 forEliminateDescriptor:v25];
    }

    else
    {
      v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v21 = [v20 diag];
      v22 = [NSString alloc];
      v23 = [v25 summary];
      v24 = [v22 initWithFormat:@"{%@} no eliminateTracker | beingEliminatedDescriptor:%@", v12, v23];
      [v21 trackAnomaly:@"ELIMINATE|AUTO-SECURE" forReason:v24 withResult:6111 withError:0];
    }
  }
}

- (void)eliminateUngraftSetDescriptor:(id)a3 failingClientRequestForEventInfo:(id)a4
{
  v22 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [MAAutoAssetError buildError:6114 fromOperation:@"eliminateUngraftSetDescriptor" underlyingError:0 withDescription:@"auto-asset-set eliminate occurred when had been personalizing / grafting [or mounting]"];
  v10 = [MAAutoAssetSelector alloc];
  v11 = [v22 clientDomainName];
  v12 = [v22 assetSetIdentifier];
  v13 = [v10 initForAssetType:v11 withAssetSpecifier:v12];

  v14 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:v13];
  if (v14)
  {
    if (v6)
    {
      [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:@"eliminateUngraftSetDescriptor" forEventInfo:v6 withResponseError:v9 forAttemptedDescriptor:0];
    }

    if ([v22 secureOperationEliminating])
    {
      [(MADAutoAssetControlManager *)self _eliminateSecureOperationFinished:v14 forEliminateSetDescriptor:v22];
    }
  }

  else
  {
    v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v16 = [v15 diag];
    v17 = [NSString alloc];
    v18 = [v22 summary];
    if (v6)
    {
      v19 = [v6 summary];
    }

    else
    {
      v19 = @"N";
    }

    v20 = [v17 initWithFormat:@"{eliminateUngraftSetDescriptor} no eliminateTracker | setDescriptor:%@ | eventInfo:%@", v18, v19];
    [v16 trackAnomaly:@"SET-ELIMINATE|AUTO-SECURE" forReason:v20 withResult:6111 withError:0];

    if (v6)
    {
    }
  }

  v21 = [v22 latestDownloadedAtomicInstance];
  [(MADAutoAssetControlManager *)self issueResponseToFailedSetLockRequest:@"eliminateUngraftSetDescriptor" forEventInfo:v6 forAtomicInstance:v21 withResponseError:v9];
}

- (id)jobToBeGivenGrant:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4 && ([v4 awaitingExclusiveGrant], v7 = objc_claimAutoreleasedReturnValue(), v8 = objc_msgSend(v7, "count"), v7, v8))
  {
    v9 = [v4 awaitingExclusiveGrant];
    v10 = [v9 objectAtIndex:0];

    v11 = [v4 awaitingExclusiveGrant];
    [v11 removeObjectAtIndex:0];

    v12 = [(MADAutoAssetControlManager *)self currentJobByUUID:v10 potentiallyResumingJob:0 withOriginalSelector:0 fromLocation:@"jobToBeGivenGrant" notFoundCode:6111 notFoundReason:@"next auto-asset-job for obtain-lookup-grant not found" downloadingDescriptor:0 baseForPatchDescriptor:0];
    if (v12)
    {
      [v4 setHolderJobUUID:v10];
    }
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (void)handleStagingClientDetermineGroupsAvailableForUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineGroupsAvailableForUpdateRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientDetermineGroupsAvailable:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDetermineAllAvailableForUpdateRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineGroupsAvailableForUpdateRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientDetermineAllAvailable:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDetermineAllAvailableRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineAllAvailableRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientDetermineAllAvailable:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDownloadGroupsRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDownloadGroupsRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v10);

  v8 = [(MADAutoAssetControlManager *)self _alreadyDownloadedDescriptorsArray:@"handleStagingClientDownloadGroupsRequest" limitingToSupportingStaging:0, v10.opaque[0], v10.opaque[1]];
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  v9 = [v4 clientRequest];
  [MADAutoAssetStager clientDownloadGroups:v9 withAlreadyDownloadedDescriptors:v8];

  os_activity_scope_leave(&v10);
}

- (void)handleStagingClientDownloadAllRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDownloadAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientDownloadAll:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientCancelOperation:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientCancelOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientCancelOperation:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientPurgeAllRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientPurgeAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientPurgeAll:v8];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientEraseAllRequest:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientEraseAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  v8 = [v4 clientRequest];
  [MADAutoAssetStager clientEraseAll:v8];

  os_activity_scope_leave(&v9);
}

- (id)_combinedStatisticsWithStagerClientRepliesSuccess:(id)a3 withStagerClientRepliesFailure:(id)a4 withStagerTotalStaged:(id)a5 withStagerTotalUnstaged:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self statistics];
  v15 = [v14 copy];

  if (v10)
  {
    v16 = [v15 totalClientRepliesSuccess];
    [v16 setStageDetermineAllAvailable:{objc_msgSend(v10, "stageDetermineAllAvailable") + objc_msgSend(v16, "stageDetermineAllAvailable")}];

    v17 = [v15 totalClientRepliesSuccess];
    [v17 setStageDownloadAll:{objc_msgSend(v10, "stageDownloadAll") + objc_msgSend(v17, "stageDownloadAll")}];

    v18 = [v15 totalClientRepliesSuccess];
    [v18 setStagePurgeAll:{objc_msgSend(v10, "stagePurgeAll") + objc_msgSend(v18, "stagePurgeAll")}];

    v19 = [v15 totalClientRepliesSuccess];
    [v19 setStageEraseAll:{objc_msgSend(v10, "stageEraseAll") + objc_msgSend(v19, "stageEraseAll")}];
  }

  if (v11)
  {
    v20 = [v15 totalClientRepliesFailure];
    [v20 setStageDetermineAllAvailable:{objc_msgSend(v11, "stageDetermineAllAvailable") + objc_msgSend(v20, "stageDetermineAllAvailable")}];

    v21 = [v15 totalClientRepliesFailure];
    [v21 setStageDownloadAll:{objc_msgSend(v11, "stageDownloadAll") + objc_msgSend(v21, "stageDownloadAll")}];

    v22 = [v15 totalClientRepliesFailure];
    [v22 setStagePurgeAll:{objc_msgSend(v11, "stagePurgeAll") + objc_msgSend(v22, "stagePurgeAll")}];

    v23 = [v15 totalClientRepliesFailure];
    [v23 setStageEraseAll:{objc_msgSend(v11, "stageEraseAll") + objc_msgSend(v23, "stageEraseAll")}];
  }

  if (v12)
  {
    v24 = [v15 totalStaged];
    [v24 setPatchedAssets:{objc_msgSend(v12, "patchedAssets") + objc_msgSend(v24, "patchedAssets")}];

    v25 = [v15 totalStaged];
    [v25 setPatchedBytes:{objc_msgSend(v12, "patchedBytes") + objc_msgSend(v25, "patchedBytes")}];

    v26 = [v15 totalStaged];
    [v26 setFullAssets:{objc_msgSend(v12, "fullAssets") + objc_msgSend(v26, "fullAssets")}];

    v27 = [v15 totalStaged];
    [v27 setFullBytes:{objc_msgSend(v12, "fullBytes") + objc_msgSend(v27, "fullBytes")}];
  }

  if (v13)
  {
    v28 = [v15 totalUnstaged];
    [v28 setPatchedAssets:{objc_msgSend(v13, "patchedAssets") + objc_msgSend(v28, "patchedAssets")}];

    v29 = [v15 totalUnstaged];
    [v29 setPatchedBytes:{objc_msgSend(v13, "patchedBytes") + objc_msgSend(v29, "patchedBytes")}];

    v30 = [v15 totalUnstaged];
    [v30 setFullAssets:{objc_msgSend(v13, "fullAssets") + objc_msgSend(v30, "fullAssets")}];

    v31 = [v15 totalUnstaged];
    [v31 setFullBytes:{objc_msgSend(v13, "fullBytes") + objc_msgSend(v31, "fullBytes")}];
  }

  return v15;
}

- (id)_latestDownloadedDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:_latestDownloadedDescriptor", v8];
  v45 = v10;
  v44 = [[MAAutoAssetSelector alloc] initForAssetType:v9 withAssetSpecifier:v10];
  v14 = [MADAutoAssetControlManager locateDownloadedNewForSelector:"locateDownloadedNewForSelector:assetSelector:limitedToStaging:" assetSelector:v13 limitedToStaging:?];
  v46 = self;
  v48 = v13;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v13 ofContainer:@"locateDownloadedNewAllBySelector"];
  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  v15 = v14;
  v16 = [v15 countByEnumeratingWithState:&v50 objects:v62 count:16];
  v47 = v15;
  if (!v16)
  {

    v18 = 0;
    goto LABEL_21;
  }

  v17 = v16;
  v42 = v9;
  v43 = v8;
  v18 = 0;
  v19 = 0;
  v49 = *v51;
  do
  {
    for (i = 0; i != v17; i = i + 1)
    {
      if (*v51 != v49)
      {
        objc_enumerationMutation(v15);
      }

      v21 = *(*(&v50 + 1) + 8 * i);
      v22 = objc_autoreleasePoolPush();
      v23 = [v15 safeObjectForKey:v21 ofClass:objc_opt_class()];
      v24 = v23;
      if (v19)
      {
        v25 = [SUCoreRestoreVersion alloc];
        v26 = [v24 assetVersion];
        v27 = [v25 initWithRestoreVersion:v26];

        if ([v27 isComparable:v18])
        {
          if ([v27 compare:v18]!= &dword_0 + 1)
          {
            goto LABEL_14;
          }

          v28 = v24;

          v27 = v27;
          v29 = v18;
          v18 = v27;
          v19 = v28;
        }

        else
        {
          v29 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
          {
            v32 = [(MADAutoAssetControlManager *)v46 _updateLatestSummary];
            v33 = [v24 summary];
            *buf = 138543874;
            v55 = v32;
            v56 = 2114;
            v57 = v48;
            v58 = 2114;
            v59 = v33;
            _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} ignoring (invalid restore version) | descriptor:%{public}@", buf, 0x20u);

            v15 = v47;
          }
        }
      }

      else
      {
        v19 = v23;
        v30 = [SUCoreRestoreVersion alloc];
        v27 = [v19 assetVersion];
        v31 = [v30 initWithRestoreVersion:v27];
        v29 = v18;
        v18 = v31;
      }

LABEL_14:
      objc_autoreleasePoolPop(v22);
    }

    v17 = [v15 countByEnumeratingWithState:&v50 objects:v62 count:16];
  }

  while (v17);

  if (v19)
  {
    v34 = _MADLog(@"AutoControl");
    v9 = v42;
    v8 = v43;
    v35 = v45;
    v36 = v48;
    if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
    {
      v37 = [(MADAutoAssetControlManager *)v46 _updateLatestSummary];
      v38 = [v19 summary];
      *buf = 138543874;
      v55 = v37;
      v56 = 2114;
      v57 = v48;
      v58 = 2114;
      v59 = v38;
      _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} matched on downloaded | descriptor:%{public}@", buf, 0x20u);
    }

    goto LABEL_24;
  }

  v9 = v42;
  v8 = v43;
LABEL_21:
  v35 = v45;
  v36 = v48;
  v34 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
  {
    v39 = [(MADAutoAssetControlManager *)v46 _updateLatestSummary];
    *buf = 138544130;
    v55 = v39;
    v56 = 2114;
    v57 = v48;
    v58 = 2114;
    v59 = v9;
    v60 = 2114;
    v61 = v45;
    _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no match on downloaded descriptor | assetType:%{public}@, assetSpecifier:%{public}@", buf, 0x2Au);
  }

  v19 = 0;
LABEL_24:

  v40 = v19;
  return v19;
}

- (id)_latestDownloadedDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5 matchingAssetVersion:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:_latestDownloadedDescriptor", v10];
  v17 = [[MAAutoAssetSelector alloc] initForAssetType:v11 withAssetSpecifier:v12 matchingAssetVersion:v13];
  v18 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_latestDownloadedDescriptor" assetSelector:v17 limitedToStaging:0];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v16 ofContainer:@"locateDownloadedNewAllBySelector"];
  memset(v29, 0, sizeof(v29));
  v19 = v18;
  if (![v19 countByEnumeratingWithState:v29 objects:v38 count:16])
  {

LABEL_7:
    v25 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544130;
      v31 = v16;
      v32 = 2114;
      v33 = v11;
      v34 = 2114;
      v35 = v12;
      v36 = 2114;
      v37 = v13;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "{%{public}@} no downloaded asset-descriptor | assetType:%{public}@, assetSpecifier:%{public}@, assetVersion:%{public}@", buf, 0x2Au);
    }

    goto LABEL_12;
  }

  v20 = **(&v29[0] + 1);
  v21 = objc_autoreleasePoolPush();
  v22 = [v19 safeObjectForKey:v20 ofClass:objc_opt_class()];
  objc_autoreleasePoolPop(v21);

  if (!v22)
  {
    goto LABEL_7;
  }

  v23 = [v22 existsOnFilesystem];
  v24 = _MADLog(@"AutoControl");
  v25 = v24;
  if (!v23)
  {
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      v27 = [v22 summary];
      *buf = 138543618;
      v31 = v16;
      v32 = 2114;
      v33 = v27;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} tracked as downloaded yet not on filesystem | descriptor:%{public}@", buf, 0x16u);
    }

    v25 = v22;
LABEL_12:
    v22 = 0;
    goto LABEL_13;
  }

  if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
  {
    v26 = [v22 summary];
    *buf = 138543618;
    v31 = v16;
    v32 = 2114;
    v33 = v26;
    _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "{%{public}@} downloaded (on filesystem) asset-descriptor | descriptor:%{public}@", buf, 0x16u);
  }

LABEL_13:

  return v22;
}

- (id)_preInstalledDescriptor:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [MADAutoAssetDescriptor typeAndSpecifierKeyForAssetType:v8 andAssetSpecifier:v7];

  v12 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
  v13 = [v12 safeObjectForKey:v11 ofClass:objc_opt_class()];

  return v13;
}

- (id)_allPreInstalledDescriptor:(id)a3 forAssetType:(id)a4
{
  v5 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v24 = v5;
  v25 = objc_opt_new();
  v8 = normalizedAssetType(v5);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v9 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
  v10 = [v9 allKeys];

  v11 = [v10 countByEnumeratingWithState:&v26 objects:v34 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v27;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v27 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v26 + 1) + 8 * i);
        v16 = normalizedAssetType(v15);
        if ([v16 containsString:v8])
        {
          v17 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
          v18 = [v17 safeObjectForKey:v15 ofClass:objc_opt_class()];

          v19 = [v18 assetType];
          v20 = normalizedAssetType(v19);

          if (v20 && [v8 isEqualToString:v20])
          {
            [v25 addObject:v18];
          }
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v26 objects:v34 count:16];
    }

    while (v12);
  }

  v21 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
  {
    v22 = [v25 count];
    *buf = 134218242;
    v31 = v22;
    v32 = 2114;
    v33 = v24;
    _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{_allPreinstalledDescriptor} returned %llu descriptor(s) for type:%{public}@", buf, 0x16u);
  }

  return v25;
}

- (int64_t)_bytesDownloadedForDescriptor:(id)a3
{
  v3 = [a3 metadata];
  v4 = [v3 safeIntegerForKey:@"_UnarchivedSize"];

  return v4;
}

- (id)setConfigurationForDescriptorIfManagedAsSet:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationForDescriptorIfManagedAsSet" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v7 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v8 = [v7 allKeys];
  v9 = [v8 copy];

  obj = v9;
  v10 = [v9 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v23;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v23 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v22 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v17 = [v16 safeObjectForKey:v14 ofClass:objc_opt_class()];

        v18 = [v17 firstEntryAssetType];
        v19 = [v4 assetType];
        LODWORD(v16) = [SUCore stringIsEqual:v18 to:v19];

        if (v16)
        {
          objc_autoreleasePoolPop(v15);
          goto LABEL_11;
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [obj countByEnumeratingWithState:&v22 objects:v26 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }
  }

  v17 = 0;
LABEL_11:

  return v17;
}

- (BOOL)isDescriptorCurrentlyLocked:(id)a3 forDescriptor:(id)a4
{
  v5 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v8 = [MAAutoAssetSelector alloc];
  v9 = [v5 assetType];
  v10 = [v5 assetSpecifier];
  v11 = [v5 assetVersion];

  v12 = [v8 initForAssetType:v9 withAssetSpecifier:v10 matchingAssetVersion:v11];
  v13 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];

  if (v13)
  {
    v14 = [v12 persistedEntryID];
    v15 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
    v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

    v17 = v16 != 0;
  }

  else
  {
    v18 = [MADAutoAssetLocker lockedSelectorsForEliminate:v12];
    v14 = v18;
    if (v18)
    {
      v17 = [v18 count] != 0;
    }

    else
    {
      v17 = 0;
    }
  }

  return v17;
}

- (BOOL)filesystemDoesFileExist:(id)a3 atPath:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self _filesystemCachedInfo:v6 forPath:v7];
    v13 = v11 == 300 || v11 == 200;
  }

  else
  {
    v14 = +[NSFileManager defaultManager];
    v13 = [v14 fileExistsAtPath:v7];
  }

  return v13;
}

- (BOOL)filesystemDoesDirectoryExist:(id)a3 atPath:(id)a4 isDirectory:(BOOL *)a5
{
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v17 = 0;
  v12 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (!v12)
  {
    v15 = +[NSFileManager defaultManager];
    v14 = [v15 fileExistsAtPath:v9 isDirectory:&v17];

    if (!a5)
    {
      goto LABEL_10;
    }

    goto LABEL_9;
  }

  v13 = [(MADAutoAssetControlManager *)self _filesystemCachedInfo:v8 forPath:v9];
  if (v13 != 200)
  {
    if (v13 == 300)
    {
      v14 = 1;
      v17 = 1;
      if (!a5)
      {
        goto LABEL_10;
      }
    }

    else
    {
      v14 = 0;
      if (!a5)
      {
        goto LABEL_10;
      }
    }

    goto LABEL_9;
  }

  v14 = 1;
  if (a5)
  {
LABEL_9:
    *a5 = v17;
  }

LABEL_10:

  return v14;
}

- (int64_t)_filesystemCachedInfo:(id)a3 forPath:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];
    v12 = [v11 safeObjectForKey:v7 ofClass:objc_opt_class()];

    v10 = v12 == 0;
    if (v12)
    {
      v13 = [v12 integerValue];
    }

    else
    {
      v20 = 0;
      v14 = +[NSFileManager defaultManager];
      v15 = [v14 fileExistsAtPath:v7 isDirectory:&v20];

      v16 = 200;
      if (v20)
      {
        v16 = 300;
      }

      if (v15)
      {
        v13 = v16;
      }

      else
      {
        v13 = &stru_20 + 68;
      }

      v17 = [[NSNumber alloc] initWithInteger:v13];
      v18 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];
      [v18 setSafeObject:v17 forKey:v7];
    }

    [(MADAutoAssetControlManager *)self setFilesystemStartupLookupCount:[(MADAutoAssetControlManager *)self filesystemStartupLookupCount]+ 1];
  }

  else
  {
    v13 = 0;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceFilesystemExistCheck:v6 atPath:v7 withFilesystemInfo:v13 justUpdatedCache:v10];

  return v13;
}

- (BOOL)_updateTrackedDescriptor:(id)a3 fromLatestDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 assetType];
  if (!v10)
  {
    goto LABEL_40;
  }

  v11 = v10;
  v12 = [v7 assetType];
  if (!v12)
  {
    goto LABEL_39;
  }

  v13 = v12;
  v14 = [v6 assetSpecifier];
  if (!v14)
  {
LABEL_38:

LABEL_39:
    goto LABEL_40;
  }

  v15 = v14;
  v16 = [v7 assetSpecifier];
  if (!v16)
  {
LABEL_37:

    goto LABEL_38;
  }

  v17 = v16;
  v18 = [v6 assetId];
  if (!v18)
  {
LABEL_36:

    goto LABEL_37;
  }

  v19 = v18;
  v20 = [v7 assetId];
  if (!v20 || ![v6 isMAAutoAsset])
  {

    goto LABEL_36;
  }

  v21 = [v7 isMAAutoAsset];

  if ((v21 & 1) == 0)
  {
LABEL_40:
    v42 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
LABEL_43:

      LOBYTE(v26) = 0;
      goto LABEL_44;
    }

    v43 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v44 = [v6 summary];
    v45 = [v7 summary];
    v60 = 138543874;
    v61 = v43;
    v62 = 2114;
    v63 = v44;
    v64 = 2114;
    v65 = v45;
    v46 = "[%{public}@] {_updateTrackedDescriptor} missing base-level information | updateDescriptor:%{public}@ | recentDescriptor:%{public}@";
LABEL_42:
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, v46, &v60, 0x20u);

    goto LABEL_43;
  }

  v22 = [v6 assetVersion];
  if (v22)
  {
    v23 = v22;
    v24 = [v7 assetVersion];

    if (!v24)
    {
      v42 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_43;
      }

      v43 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v44 = [v6 summary];
      v45 = [v7 summary];
      v60 = 138543874;
      v61 = v43;
      v62 = 2114;
      v63 = v44;
      v64 = 2114;
      v65 = v45;
      v46 = "[%{public}@] {_updateTrackedDescriptor} update full-asset-selector when recent not full | updateDescriptor:%{public}@ | recentDescriptor:%{public}@";
      goto LABEL_42;
    }
  }

  v25 = [v6 foundByLookupWithoutAssetVersion];
  LODWORD(v26) = v25 ^ [v7 foundByLookupWithoutAssetVersion];
  if (v26 == 1)
  {
    [v6 setFoundByLookupWithoutAssetVersion:{objc_msgSend(v7, "foundByLookupWithoutAssetVersion")}];
  }

  v27 = [v6 preSoftwareUpdateAssetStaging];
  if (v27 != [v7 preSoftwareUpdateAssetStaging])
  {
    [v6 setPreSoftwareUpdateAssetStaging:{objc_msgSend(v7, "preSoftwareUpdateAssetStaging")}];
    LOBYTE(v26) = 1;
  }

  v28 = [v6 isPatch];
  if (v28 != [v7 isPatch])
  {
    [v6 setIsPatch:{objc_msgSend(v7, "isPatch")}];
    LOBYTE(v26) = 1;
  }

  v29 = [v6 isOnFilesystem];
  if (v29 != [v7 isOnFilesystem])
  {
    [v6 setIsOnFilesystem:{objc_msgSend(v7, "isOnFilesystem")}];
    LOBYTE(v26) = 1;
  }

  v30 = [v6 neverBeenLocked];
  if (v30 != [v7 neverBeenLocked] && objc_msgSend(v6, "neverBeenLocked"))
  {
    [v6 setNeverBeenLocked:{objc_msgSend(v7, "neverBeenLocked")}];
    LOBYTE(v26) = 1;
  }

  v31 = [v6 downloadUserInitiated];
  if (v31 != [v7 downloadUserInitiated])
  {
    [v6 setDownloadUserInitiated:{objc_msgSend(v7, "downloadUserInitiated")}];
    LOBYTE(v26) = 1;
  }

  v32 = [v6 downloadedNetworkBytes];
  if (v32 != [v7 downloadedNetworkBytes])
  {
    [v6 setDownloadedNetworkBytes:{objc_msgSend(v7, "downloadedNetworkBytes")}];
    LOBYTE(v26) = 1;
  }

  v33 = [v6 downloadedFilesystemBytes];
  if (v33 != [v7 downloadedFilesystemBytes])
  {
    [v6 setDownloadedFilesystemBytes:{objc_msgSend(v7, "downloadedFilesystemBytes")}];
    LOBYTE(v26) = 1;
  }

  v34 = [v6 patchedFromBaseSelector];
  if (!v34)
  {
    v48 = [v7 patchedFromBaseSelector];
    if (v48)
    {

LABEL_47:
      v34 = [v7 patchedFromBaseSelector];
      [v6 setPatchedFromBaseSelector:v34];
      LOBYTE(v26) = 1;
      goto LABEL_51;
    }
  }

  v35 = [v6 patchedFromBaseSelector];
  if (v35)
  {
    v36 = v35;
    v37 = [v7 patchedFromBaseSelector];
    if (!v37)
    {

      goto LABEL_51;
    }

    v38 = v37;
    v39 = [v6 patchedFromBaseSelector];
    v40 = [v7 patchedFromBaseSelector];
    v41 = [v39 isEqual:v40];

    if (v34)
    {
    }

    if (v41)
    {
      goto LABEL_52;
    }

    goto LABEL_47;
  }

LABEL_51:

LABEL_52:
  v49 = [v6 patchedFromBaseFilesystemBytes];
  if (v49 != [v7 patchedFromBaseFilesystemBytes])
  {
    [v6 setPatchedFromBaseFilesystemBytes:{objc_msgSend(v7, "patchedFromBaseFilesystemBytes")}];
    LOBYTE(v26) = 1;
  }

  v50 = [v6 patchingAttempted];
  if (v50 != [v7 patchingAttempted])
  {
    [v6 setPatchingAttempted:{objc_msgSend(v7, "patchingAttempted")}];
    LOBYTE(v26) = 1;
  }

  v51 = [v6 stagedPriorToAvailable];
  if (v51 != [v7 stagedPriorToAvailable])
  {
    [v6 setStagedPriorToAvailable:{objc_msgSend(v7, "stagedPriorToAvailable")}];
    LOBYTE(v26) = 1;
  }

  v52 = [v6 stagedFromOSVersion];
  v53 = [v7 stagedFromOSVersion];
  v54 = [SUCore stringIsEqual:v52 to:v53];

  if ((v54 & 1) == 0)
  {
    v26 = [v7 stagedFromOSVersion];
    [v6 setStagedFromOSVersion:v26];

    LOBYTE(v26) = 1;
  }

  v55 = [v6 stagedFromBuildVersion];
  v56 = [v7 stagedFromBuildVersion];
  v57 = [SUCore stringIsEqual:v55 to:v56];

  if ((v57 & 1) == 0)
  {
    v26 = [v7 stagedFromBuildVersion];
    [v6 setStagedFromBuildVersion:v26];

    LOBYTE(v26) = 1;
  }

  v58 = [v6 patchingAttemptError];
  if (v58)
  {
  }

  else
  {
    v59 = [v7 patchingAttemptError];

    if (v59)
    {
      v26 = [v7 patchingAttemptError];
      [v6 setPatchingAttemptError:v26];

      LOBYTE(v26) = 1;
    }
  }

LABEL_44:

  return v26;
}

- (BOOL)doesSelectorArray:(id)a3 coverAssetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  obj = v6;
  v10 = [obj countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v21 + 1) + 8 * i);
        v14 = [v13 assetType];
        v15 = [v7 assetType];
        if (([SUCore stringIsEqual:v14 to:v15]& 1) != 0)
        {
          v16 = [v13 assetSpecifier];
          v17 = [v7 assetSpecifier];
          v18 = [SUCore stringIsEqual:v16 to:v17];

          if (v18)
          {
            LOBYTE(v10) = 1;
            goto LABEL_12;
          }
        }

        else
        {
        }
      }

      v10 = [obj countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v10);
  }

LABEL_12:

  return v10;
}

- (void)setConfigurationLoadedFromPersisted:(id)a3 persistedEntryID:(id)a4
{
  v16 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v16];
  v8 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v9 = [v8 safeObjectForKey:v7 ofClass:objc_opt_class()];

  if (v9)
  {
    v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v11 = [v10 diag];
    v12 = [NSString alloc];
    v13 = [v16 summary];
    v14 = [v12 initWithFormat:@"{setConfigurationLoadedFromPersisted} already tracking setConfiguration:%@", v13];
    [v11 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v14 withResult:6109 withError:0];
  }

  else
  {
    v15 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    [v15 setSafeObject:v16 forKey:v7];

    [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:@"setConfigurationLoadedFromPersisted" operation:@"ENTRY_LOAD" forPersistedEntryID:v7 withSetConfiguration:v16 historyOperation:444 message:@"set-configuration validated"];
  }
}

- (void)setConfigurationsRefreshStaleIndications
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationsRefreshStaleIndications" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  v5 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v6 = [v5 allKeys];
  v7 = [v6 copy];

  obj = v7;
  v8 = [v7 countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v27;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v27 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        v14 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v15 = [v14 safeObjectForKey:v12 ofClass:objc_opt_class()];

        if (v15)
        {
          v16 = [v15 previouslyVendedLockedAtomicInstances];
          if (v16)
          {
            v17 = [v15 previouslyVendedLockedAtomicInstances];
            v18 = [v17 count] != 0;
          }

          else
          {
            v18 = 0;
          }

          v19 = [v15 latestAtomicInstanceToVend];
          if (v19)
          {
            v20 = [v15 haveReceivedLookupResponse];

            if (v20)
            {
              v19 = 0;
              goto LABEL_13;
            }

            [v15 setHaveReceivedLookupResponse:1];
            v21 = 0;
            v19 = @"set haveReceivedLookupResponse";
          }

          else
          {
LABEL_13:
            v21 = 1;
          }

          if ([v15 everProvidedLatestToVend] & 1) != 0 || (objc_msgSend(v15, "latestAtomicInstanceToVend"), v22 = objc_claimAutoreleasedReturnValue(), v23 = v22 == 0, v22, (v23 & ~v18))
          {
LABEL_19:
            v24 = v19;
            if (!v19)
            {
              goto LABEL_21;
            }
          }

          else
          {
            [v15 setEverProvidedLatestToVend:1];
            v24 = @"set everProvidedLatestToVend";
            if ((v21 & 1) == 0)
            {
              v19 = [[NSString alloc] initWithFormat:@"%@, set everProvidedLatestToVend", v19];
              goto LABEL_19;
            }
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v15 fromLocation:@"setConfigurationsRefreshStaleIndications" forReason:v24 dueToAlter:0 forHistoryOperation:450];
        }

LABEL_21:

        objc_autoreleasePoolPop(v13);
      }

      v9 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v9);
  }
}

- (int64_t)setConfigurationSelectUsingInfoInstance:(id)a3 dueToMessageName:(id)a4 selectedConfig:(id *)a5
{
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [v8 autoAssetEntries];

  v13 = [v8 clientDomainName];
  v14 = [v8 assetSetIdentifier];
  v15 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v13 forAssetSetIdentifier:v14];

  if (!v12)
  {
    v20 = 0;
    v22 = v15;
    if (a5)
    {
      goto LABEL_35;
    }

    goto LABEL_36;
  }

  v45 = v9;
  if (!v15)
  {
    v60 = 0;
    v20 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:@"setConfigurationSelectUsingInfoInstance" forSetInfoInstance:v8 dueToMessageName:v9 selectedConfig:&v60];
    v15 = v60;
    if (v20)
    {
      v21 = 0;
      goto LABEL_34;
    }
  }

  v16 = [v8 autoAssetEntries];
  v17 = [v16 count];

  v47 = v15;
  v18 = [v15 autoAssetEntries];
  v19 = [v18 count];

  if (v17 <= 0 && v19 <= 0)
  {
    goto LABEL_5;
  }

  if (v17 != v19)
  {
    v20 = 0;
    v21 = 0;
LABEL_33:
    v15 = v47;
    goto LABEL_34;
  }

  v58 = 0u;
  v59 = 0u;
  v56 = 0u;
  v57 = 0u;
  obj = [v8 autoAssetEntries];
  v43 = [obj countByEnumeratingWithState:&v56 objects:v62 count:16];
  if (!v43)
  {
    goto LABEL_28;
  }

  v44 = *v57;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v40 = a5;
  v41 = v8;
  while (2)
  {
    v24 = 0;
    while (2)
    {
      if (*v57 != v44)
      {
        objc_enumerationMutation(obj);
      }

      v46 = v24;
      v25 = *(*(&v56 + 1) + 8 * v24);
      v52 = 0u;
      v53 = 0u;
      v54 = 0u;
      v55 = 0u;
      v49 = [v47 autoAssetEntries];
      v51 = [v49 countByEnumeratingWithState:&v52 objects:v61 count:16];
      if (!v51)
      {
LABEL_32:

        v20 = 0;
        v21 = 0;
        a5 = v40;
        v8 = v41;
        goto LABEL_33;
      }

      v26 = *v53;
      v48 = *v53;
LABEL_16:
      v27 = 0;
      while (1)
      {
        if (*v53 != v26)
        {
          objc_enumerationMutation(v49);
        }

        v28 = *(*(&v52 + 1) + 8 * v27);
        v29 = p_weak_ivar_lyt[223];
        v30 = [v28 assetSelector];
        v31 = [v30 assetType];
        v32 = [v25 assetSelector];
        v33 = [v32 assetType];
        if (![v29 stringIsEqual:v31 to:v33])
        {

          goto LABEL_23;
        }

        v50 = p_weak_ivar_lyt[223];
        v34 = [v28 assetSelector];
        v35 = [v34 assetSpecifier];
        v36 = [v25 assetSelector];
        [v36 assetSpecifier];
        v38 = v37 = v25;
        LOBYTE(v50) = [v50 stringIsEqual:v35 to:v38];

        v25 = v37;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        v26 = v48;
        if (v50)
        {
          break;
        }

LABEL_23:
        if (v51 == ++v27)
        {
          v51 = [v49 countByEnumeratingWithState:&v52 objects:v61 count:16];
          if (v51)
          {
            goto LABEL_16;
          }

          goto LABEL_32;
        }
      }

      v24 = v46 + 1;
      if ((v46 + 1) != v43)
      {
        continue;
      }

      break;
    }

    a5 = v40;
    v8 = v41;
    v43 = [obj countByEnumeratingWithState:&v56 objects:v62 count:16];
    if (v43)
    {
      continue;
    }

    break;
  }

LABEL_28:

LABEL_5:
  v15 = v47;
  v20 = 0;
  v21 = v15;
LABEL_34:

  v22 = v21;
  v9 = v45;
  if (a5)
  {
LABEL_35:
    v22 = v22;
    *a5 = v22;
  }

LABEL_36:

  return v20;
}

- (int64_t)setConfigurationNewSetConfiguration:(id)a3 forSetInfoInstance:(id)a4 dueToMessageName:(id)a5 selectedConfig:(id *)a6
{
  v9 = a3;
  v10 = a4;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [v10 autoAssetEntries];

  if (v13)
  {
    v14 = [v10 autoAssetEntries];
    v15 = [v14 count];

    if (v15)
    {
      v16 = [MADAutoSetConfiguration alloc];
      v17 = [v10 clientDomainName];
      v18 = [v10 autoAssetSetClientName];
      v19 = [v10 assetSetIdentifier];
      v20 = [v10 autoAssetEntries];
      LODWORD(v28) = 0;
      LOBYTE(v27) = 0;
      v15 = [MADAutoSetConfiguration initForClientDomainName:v16 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:v17 withAutoAssetEntries:v18 withDiscoveredInFlightAtomicInstance:v19 withNewerAtomicInstanceOncePersonalized:v20 withLatestAtomicInstanceToVend:0 withLatestAtomicInstanceToVendFromPreSUStaging:0 withPreviouslyVendedLockedAtomicInstances:0 withTicksUntilPreviousForceUnlocked:v27 withMostRecentlyReceivedCachedAssetSetID:0 withMostRecentlyReceivedDownloadedFromLive:-1 withMostRecentlyReceivedLastTimeChecked:0 withMostRecentlyReceivedPostedDate:0 withLatestToVendCachedAssetSetID:0 withLatestToVendDownloadedFromLive:0 withLatestToVendLastTimeChecked:0 withLatestToVendPostedDate:0 withAavailableForUseError:0 withNewerVersionError:0 havingEverProvidedLatestToVend:0 inhibitingImpliedScheduling:0 havingReceivedLookupResponse:v28 vendingAtomicInstanceForConfiguredEntries:?];

      [(MADAutoAssetControlManager *)self setConfigurationPersist:v15 fromLocation:v9 forReason:@"created from setInfoInstance" dueToAlter:0 forHistoryOperation:451];
      v21 = 0;
      if (!a6)
      {
        goto LABEL_9;
      }
    }

    else
    {
      v21 = 6555;
      if (!a6)
      {
        goto LABEL_9;
      }
    }

    goto LABEL_8;
  }

  v22 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
  {
    v23 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v24 = [v10 summary];
    *buf = 138543874;
    v30 = v23;
    v31 = 2114;
    v32 = v9;
    v33 = 2114;
    v34 = v24;
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:setConfigurationNewSetConfiguration} MISSING asset-entries from set-information | setInfoInstance:%{public}@", buf, 0x20u);
  }

  v21 = 0;
  v15 = 0;
  if (a6)
  {
LABEL_8:
    v25 = v15;
    *a6 = v15;
  }

LABEL_9:

  return v21;
}

- (BOOL)setConfigurationTrackLatestToVend:(id)a3 forSetConfiguration:(id)a4 becomingLatestToVend:(id)a5 historyOperation:(int64_t)a6 fromPreSUStaging:(BOOL)a7
{
  v56 = a7;
  v11 = a4;
  v12 = a5;
  v13 = a3;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [[NSString alloc] initWithFormat:@"%@:setConfigurationTrackLatestToVend", v13];
  v17 = [NSMutableString alloc];
  v18 = @"cleared";
  if (v12)
  {
    v18 = @"set";
  }

  v19 = [v17 initWithFormat:@"%@ latestToVend", v18];
  [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDMostRecentlyReceived:v16 fromSetDescriptor:v12 forSetConfiguration:v11 buildingPersistReason:v19];
  [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDLatestToVend:v16 fromSetDescriptor:v12 forSetConfiguration:v11 buildingPersistReason:v19];
  if (v12)
  {
    v20 = [v12 latestDownloadedAtomicInstance];
    v58 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v20];
  }

  else
  {
    v58 = 0;
  }

  v21 = [v11 newerAtomicInstanceOncePersonalized];

  if (v21)
  {
    v22 = [v11 newerAtomicInstanceOncePersonalized];
    v23 = [v12 latestDownloadedAtomicInstance];
    v24 = [SUCore stringIsEqual:v22 to:v23];

    if ((v24 & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:v16 forSetConfiguration:v11];
    }
  }

  v25 = [v11 latestAtomicInstanceToVend];

  if (v25)
  {
    v26 = [v11 latestAtomicInstanceToVend];
    v27 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v26];
  }

  else
  {
    v27 = 0;
  }

  v28 = [(MADAutoAssetControlManager *)self setConfigurationPreviouslyVendedLockedAtomicInstances:v11];
  v57 = v28;
  if (v27 && (v29 = v28, [(MADAutoAssetControlManager *)self atomicInstanceIsCurrentlyLocked:v27]))
  {
    v30 = _MADLog(@"AutoControl");
    v31 = os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT);
    if (v29)
    {
      if (v31)
      {
        *buf = 138543618;
        v60 = v16;
        v61 = 2114;
        v62 = v27;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] additional latest-to-vend moved to previously-vended-still-locked | hadBeenLatestAtomicInstance:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      if (v31)
      {
        *buf = 138543618;
        v60 = v16;
        v61 = 2114;
        v62 = v27;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] first latest-to-vend moved to previously-vended-still-locked | hadBeenLatestAtomicInstance:%{public}@", buf, 0x16u);
      }

      v30 = objc_alloc_init(NSMutableArray);
      [v11 setPreviouslyVendedLockedAtomicInstances:v30];
    }

    v33 = [v27 atomicInstanceUUID];

    if (v33)
    {
      v34 = [v11 previouslyVendedLockedAtomicInstances];
      v35 = [v27 atomicInstanceUUID];
      [v34 addObject:v35];

      [v11 setTicksUntilPreviousForceUnlocked:2];
    }

    else
    {
      v55 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      [v55 diag];
      v37 = v36 = a6;
      v38 = [NSString alloc];
      v39 = [v27 summary];
      v40 = [v38 initWithFormat:@"{%@} set-atomic-instance without atomicInstanceUUID | hadBeenLatestAtomicInstance:%@", v16, v39];
      [v37 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v40 withResult:6108 withError:0];

      a6 = v36;
    }

    [v19 appendString:{@", new previouslyVendedLocked"}];
    v32 = 1;
  }

  else
  {
    v32 = 0;
  }

  if (!v12)
  {
    [v11 setLatestAtomicInstanceToVend:0];
    [v11 setVendingAtomicInstanceForConfiguredEntries:0];
    [v11 setLatestAtomicInstanceToVendFromPreSUStaging:0];
    goto LABEL_36;
  }

  v41 = [v11 availableForUseError];
  if (v41)
  {

    v42 = [v12 latestDownloadedAtomicInstance];
    [v11 setLatestAtomicInstanceToVend:v42];

    [v11 setEverProvidedLatestToVend:1];
    [v11 setLatestAtomicInstanceToVendFromPreSUStaging:v56];
    [(MADAutoAssetControlManager *)self setConfigurationClearAvailableForUseError:v16 forSetConfiguration:v11 appendingToPersistReason:0 withReason:@"cleared set-configuration error tracking" maintainingHistoryOperation:0];
    [v11 setNewerVersionError:0];
LABEL_30:
    v45 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
    {
      v46 = [v11 summary];
      *buf = 138543618;
      v60 = v16;
      v61 = 2114;
      v62 = v46;
      _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] cleared set-configuration error tracking | setConfiguration:%{public}@", buf, 0x16u);
    }

    goto LABEL_33;
  }

  v43 = [v11 newerVersionError];

  v44 = [v12 latestDownloadedAtomicInstance];
  [v11 setLatestAtomicInstanceToVend:v44];

  [v11 setEverProvidedLatestToVend:1];
  [v11 setLatestAtomicInstanceToVendFromPreSUStaging:v56];
  [(MADAutoAssetControlManager *)self setConfigurationClearAvailableForUseError:v16 forSetConfiguration:v11 appendingToPersistReason:0 withReason:@"cleared set-configuration error tracking" maintainingHistoryOperation:0];
  [v11 setNewerVersionError:0];
  if (v43)
  {
    goto LABEL_30;
  }

LABEL_33:
  v47 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
  {
    v48 = [v12 summary];
    *buf = 138543874;
    v60 = v16;
    v61 = 2114;
    v62 = v19;
    v63 = 2114;
    v64 = v48;
    _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[BECAME-LATEST-TO-VEND] adopted set-descriptor as latest-to-vend\n| persistReason:%{public}@\n| setDescriptor:%{public}@", buf, 0x20u);
  }

LABEL_36:
  [(MADAutoAssetControlManager *)self setConfigurationPersist:v11 fromLocation:v16 forReason:v19 dueToAlter:0 forHistoryOperation:a6];
  v49 = v58;
  if (v58)
  {
    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:v16 toNewStatus:@"LATEST_TO_VEND" forAtomicInstance:v58];
  }

  if (v27)
  {
    if (v32)
    {
      v50 = [v27 clientDomainName];
      v51 = [v27 assetSetIdentifier];
      v52 = [v27 atomicInstanceUUID];
      [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_UNLOCK_DESIRED" forClientDomainName:v50 forAssetSetIdentifier:v51 forAtomicInstanceUUID:v52 fromModule:@"AUTO-CONTROL" fromLocation:v16];

      v49 = v58;
      v53 = @"PREVIOUS_VEND_LOCKED";
    }

    else
    {
      v53 = @"FORGOTTEN";
    }

    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:v16 toNewStatus:v53 forAtomicInstance:v27];
  }

  return v12 != 0;
}

- (id)setConfigurationPreviouslyVendedLockedAtomicInstances:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 previouslyVendedLockedAtomicInstances];

  if (!v7)
  {
    goto LABEL_17;
  }

  v8 = [v4 previouslyVendedLockedAtomicInstances];
  v9 = [v8 count];

  if (!v9)
  {
    v26 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v27 = [v26 diag];
    v28 = [NSString alloc];
    v29 = [v4 summary];
    v30 = [v28 initWithFormat:@"{setConfigurationPreviouslyVendedLockedAtomicInstances} set-configuration with invalid previouslyVendedLockedAtomicInstances | setConfiguration:%@", v29];
    [v27 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v30 withResult:6108 withError:0];

LABEL_17:
    v10 = 0;
    goto LABEL_18;
  }

  v10 = objc_alloc_init(NSMutableArray);
  v36 = 0u;
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v33 = v4;
  v11 = [v4 previouslyVendedLockedAtomicInstances];
  v12 = [v11 copy];

  obj = v12;
  v13 = [v12 countByEnumeratingWithState:&v36 objects:v40 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v37;
    v32 = *v37;
    do
    {
      v16 = 0;
      v34 = v14;
      do
      {
        if (*v37 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v36 + 1) + 8 * v16);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v17];
        if (v19)
        {
          [v10 addObject:v19];
        }

        else
        {
          v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v21 = [v20 diag];
          v22 = self;
          v23 = [NSString alloc];
          v24 = [v33 summary];
          v25 = [v23 initWithFormat:@"{setConfigurationPreviouslyVendedLockedAtomicInstances} set-configuration previouslyVendedLockedAtomicInstances references orphan atomic-instance | nextPreviouslyVendedStillLockedUUID:%@ | setConfiguration:%@", v17, v24];
          [v21 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v25 withResult:6108 withError:0];

          self = v22;
          v14 = v34;

          v15 = v32;
        }

        objc_autoreleasePoolPop(v18);
        v16 = v16 + 1;
      }

      while (v14 != v16);
      v14 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
    }

    while (v14);
  }

  if (![v10 count])
  {

    v10 = 0;
  }

  v4 = v33;
LABEL_18:

  return v10;
}

- (void)setConfigurationPersist:(id)a3 fromLocation:(id)a4 forReason:(id)a5 dueToAlter:(BOOL)a6 forHistoryOperation:(int64_t)a7
{
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  if (v11)
  {
    v35 = v13;
    v16 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v11];
    v17 = objc_opt_self();
    v18 = [v17 persistedKnownSetConfigurations];
    v19 = [v18 persistedEntryAlreadyExists:v16 fromLocation:v12];

    v20 = @"ENTRY_ADD";
    if (v19)
    {
      v20 = @"ENTRY_MODIFY";
    }

    v21 = v20;
    v22 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
    v23 = [v22 persistedEntry:v16 fromLocation:v12];

    if (v23)
    {
      [v23 persistSecureCodedObject:v11 forKey:@"setConfiguration"];
      v24 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      [v11 summary];
      v26 = v25 = a7;
      [v24 storePersistedEntry:v16 withEntrySummary:v26 fromLocation:v12];

      v27 = [NSString alloc];
      if (v19)
      {
        v28 = @"altered";
      }

      else
      {
        v28 = @"new";
      }

      v29 = [v11 summary];
      v30 = [v27 initWithFormat:@"%@ set-configuration - %@ | setConfiguration:%@", v28, v35, v29];
      [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:v12 operation:v21 forPersistedEntryID:v16 withSetConfiguration:v11 historyOperation:v25 message:v30];

      v31 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      [v31 setSafeObject:v11 forKey:v16];
    }

    else
    {
      v32 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
      {
        v33 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v34 = [v11 summary];
        *buf = 138543874;
        v37 = v33;
        v38 = 2114;
        v39 = v12;
        v40 = 2114;
        v41 = v34;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:setConfigurationPersist} unable to load persisted-set-configuration file | setConfiguration:%{public}@", buf, 0x20u);
      }
    }

    v13 = v35;
  }
}

- (id)setConfigurationFromMessageName:(id)a3 withInfoInstance:(id)a4 errorCode:(int64_t *)a5 errorDescription:(id *)a6
{
  v10 = a3;
  v11 = a4;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:v11];
  v15 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

  v17 = [SUCore stringIsEqual:v10 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
  if (v16)
  {
    if (v17)
    {
      goto LABEL_20;
    }

    v18 = [v11 autoAssetEntries];

    if (!v18)
    {
      goto LABEL_20;
    }

    if ([SUCore stringIsEqual:v10 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"])
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v21 = [v11 summary];
        v22 = [v16 summary];
        *buf = 138544130;
        v51 = v20;
        v52 = 2114;
        v53 = v10;
        v54 = 2114;
        v55 = v21;
        v56 = 2114;
        v57 = v22;
        v23 = "[%{public}@] {setConfigurationFromMessageName} pre-existing set-configuration potentially valid for forming sub-atomic-instance | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@";
LABEL_18:
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, v23, buf, 0x2Au);

        goto LABEL_19;
      }

      goto LABEL_19;
    }

    if ([SUCore stringIsEqual:v10 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v21 = [v11 summary];
        v22 = [v16 summary];
        *buf = 138544130;
        v51 = v20;
        v52 = 2114;
        v53 = v10;
        v54 = 2114;
        v55 = v21;
        v56 = 2114;
        v57 = v22;
        v23 = "[%{public}@] {setConfigurationFromMessageName} pre-existing set-configuration potentially being altered | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@";
        goto LABEL_18;
      }

LABEL_19:

      goto LABEL_20;
    }

    v36 = [v16 autoAssetEntries];

    if (!v36)
    {
      v44 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
      {
        v45 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v46 = [v11 summary];
        v47 = [v16 summary];
        *buf = 138544130;
        v51 = v45;
        v52 = 2114;
        v53 = v10;
        v54 = 2114;
        v55 = v46;
        v56 = 2114;
        v57 = v47;
        _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setConfigurationFromMessageName} auto-asset-entries learned for pre-existing set-configuration | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@", buf, 0x2Au);
      }

      v48 = [v11 autoAssetEntries];
      [v16 setAutoAssetEntries:v48];

      goto LABEL_20;
    }

    if ([(MADAutoAssetControlManager *)self setConfiguration:v16 matchesAssetEntriesFromInfoInstance:v11])
    {
LABEL_20:
      v27 = 0;
      v28 = 0;
      goto LABEL_21;
    }

    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
    {
      v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v39 = [v11 summary];
      v40 = [v16 summary];
      *buf = 138544130;
      v51 = v38;
      v52 = 2114;
      v53 = v10;
      v54 = 2114;
      v55 = v39;
      v56 = 2114;
      v57 = v40;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} different auto-asset-entries than are currently defined | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@", buf, 0x2Au);
    }

    v27 = 0;
    v28 = 0;
    v16 = 0;
  }

  else if (v17 & 1 | ![(MADAutoAssetControlManager *)self _setMessageCanCreateSetConfiguration:v10])
  {
    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      v25 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v26 = [v11 summary];
      *buf = 138543874;
      v51 = v25;
      v52 = 2114;
      v53 = v10;
      v54 = 2114;
      v55 = v26;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no set-configuration found for command requiring pre-defined set-configuration | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
    }

    v16 = 0;
    v27 = @"no known set-configuration for command requiring pre-defined set-configuration";
    v28 = 6558;
  }

  else
  {
    v29 = [v11 autoAssetEntries];

    if (v29)
    {
      v30 = [v11 autoAssetEntries];
      v31 = [v30 count];

      if (v31)
      {
        v49 = 0;
        v28 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:@"setConfigurationFromMessageName" forSetInfoInstance:v11 dueToMessageName:v10 selectedConfig:&v49];
        v16 = v49;
        if (v16)
        {
          v27 = 0;
        }

        else
        {
          v27 = @"unable to create set-configuration from provided asset-entries";
          v28 = 6101;
        }
      }

      else
      {
        v41 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR))
        {
          v42 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v43 = [v11 summary];
          *buf = 138543874;
          v51 = v42;
          v52 = 2114;
          v53 = v10;
          v54 = 2114;
          v55 = v43;
          _os_log_impl(&dword_0, v41, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no known set-configuration and empty provided asset-entries | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
        }

        v16 = 0;
        v27 = @"no known set-configuration and empty provided asset-entries";
        v28 = 6555;
      }
    }

    else
    {
      v33 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
      {
        v34 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v35 = [v11 summary];
        *buf = 138543874;
        v51 = v34;
        v52 = 2114;
        v53 = v10;
        v54 = 2114;
        v55 = v35;
        _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no known set-configuration and no asset-entries provided | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
      }

      v16 = 0;
      v27 = @"no known set-configuration and no asset-entries provided";
      v28 = 6551;
    }
  }

LABEL_21:
  if (a5)
  {
    *a5 = v28;
  }

  if (a6)
  {
    *a6 = v27;
  }

  return v16;
}

- (id)setConfigurationForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForClientDomain:v7 forAssetSetIdentifier:v6];

  v11 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)setConfigurationVendingDescriptor:(id)a3 managedAsSet:(BOOL *)a4
{
  v59 = a3;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v8 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v9 = [v8 persistedEntryIDs:@"{setConfigurationVendingDescriptor}"];

  if ([v9 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationVendingDescriptor" ofContainer:@"persistedKnownSetConfigurations"];
    v70 = 0u;
    v71 = 0u;
    v68 = 0u;
    v69 = 0u;
    v10 = v9;
    v56 = [v10 countByEnumeratingWithState:&v68 objects:v75 count:16];
    if (v56)
    {
      v50 = a4;
      v11 = 0;
      v12 = *v69;
      v51 = v10;
      v52 = v9;
      v48 = *v69;
      v49 = self;
      while (1)
      {
        for (i = 0; i != v56; i = v42 + 1)
        {
          if (*v69 != v12)
          {
            objc_enumerationMutation(v10);
          }

          v57 = i;
          v14 = *(*(&v68 + 1) + 8 * i);
          context = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v16 = [v15 persistedEntry:v14 fromLocation:@"{setConfigurationVendingDescriptor}"];

          if (v16)
          {
            v17 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            v18 = [v17 decodeFromLocation:@"{setConfigurationVendingDescriptor}" ofEntryName:v14 fromPersistedEntry:v16 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              v55 = v16;
              [v18 firstEntryAssetType];
              v20 = v19 = v18;
              v21 = [v59 assetType];
              v22 = [SUCore stringIsEqual:v20 to:v21];

              if (!v22)
              {
                v42 = v57;
                v18 = v19;
LABEL_34:
                v16 = v55;
                goto LABEL_40;
              }

              v23 = [v19 latestAtomicInstanceToVend];

              v18 = v19;
              if (!v23)
              {
                v11 = 1;
                v42 = v57;
                goto LABEL_34;
              }

              v24 = [v19 latestAtomicInstanceToVend];
              v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setConfigurationVendingDescriptor" forAtomicInstanceUUID:v24 requireExists:1];

              v16 = v55;
              v54 = v25;
              if (v25)
              {
                v66 = 0u;
                v67 = 0u;
                v64 = 0u;
                v65 = 0u;
                v26 = [v25 latestDowloadedAtomicInstanceEntries];
                p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
                v63 = [v26 countByEnumeratingWithState:&v64 objects:v72 count:16];
                if (v63)
                {
                  v53 = v18;
                  v62 = *v65;
                  v28 = v59;
                  v60 = v26;
                  while (1)
                  {
                    for (j = 0; j != v63; j = j + 1)
                    {
                      if (*v65 != v62)
                      {
                        objc_enumerationMutation(v26);
                      }

                      v30 = *(*(&v64 + 1) + 8 * j);
                      v31 = p_weak_ivar_lyt[223];
                      v32 = [v30 fullAssetSelector];
                      v33 = [v32 assetType];
                      v34 = [v28 assetType];
                      if (![v31 stringIsEqual:v33 to:v34])
                      {
                        goto LABEL_22;
                      }

                      v35 = p_weak_ivar_lyt[223];
                      v61 = [v30 fullAssetSelector];
                      v36 = [v61 assetSpecifier];
                      v37 = [v28 assetSpecifier];
                      if (![v35 stringIsEqual:v36 to:v37])
                      {

                        v26 = v60;
LABEL_22:

                        continue;
                      }

                      v38 = p_weak_ivar_lyt[223];
                      v39 = [v30 fullAssetSelector];
                      v40 = [v39 assetVersion];
                      v41 = [v28 assetVersion];
                      LOBYTE(v38) = [v38 stringIsEqual:v40 to:v41];

                      v28 = v59;
                      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

                      v26 = v60;
                      if (v38)
                      {

                        objc_autoreleasePoolPop(context);
                        v11 = 1;
                        a4 = v50;
                        v10 = v51;
                        v9 = v52;
                        v46 = v53;
                        goto LABEL_46;
                      }
                    }

                    v63 = [v26 countByEnumeratingWithState:&v64 objects:v72 count:16];
                    if (!v63)
                    {
                      v10 = v51;
                      v9 = v52;
                      v12 = v48;
                      self = v49;
                      v42 = v57;
                      v18 = v53;
                      v16 = v55;
                      goto LABEL_38;
                    }
                  }
                }
              }

              else
              {
                v26 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
                {
                  v45 = [v18 summary];
                  *buf = 138543362;
                  v74 = v45;
                  _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load set descriptor for latest-to-vend | setConfiguration:%{public}@", buf, 0xCu);
                }
              }

              v42 = v57;
LABEL_38:

              v11 = 1;
              v44 = v54;
            }

            else
            {
              v44 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v74 = v16;
                _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load secure-coded set-configuration | entryID:%{public}@", buf, 0xCu);
              }

              v42 = v57;
            }
          }

          else
          {
            v43 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v74 = v14;
              _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load set-configuration from persisted-state | entryID:%{public}@", buf, 0xCu);
            }

            v42 = v57;
            v18 = v43;
            v16 = 0;
          }

LABEL_40:

          objc_autoreleasePoolPop(context);
        }

        v56 = [v10 countByEnumeratingWithState:&v68 objects:v75 count:16];
        if (!v56)
        {
          v46 = 0;
          a4 = v50;
          goto LABEL_46;
        }
      }
    }

    v11 = 0;
    v46 = 0;
LABEL_46:

    if (a4)
    {
      goto LABEL_47;
    }
  }

  else
  {
    v11 = 0;
    v46 = 0;
    if (a4)
    {
LABEL_47:
      *a4 = v11 & 1;
    }
  }

  return v46;
}

- (BOOL)setConfigurationReferencesDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v8 = [v7 persistedEntryIDs:@"{setConfigurationReferencesDescriptor}"];

  if (![v8 count])
  {
    v9 = 0;
    goto LABEL_59;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationReferencesDescriptor" ofContainer:@"persistedKnownSetConfigurations"];
  v82 = 0u;
  v83 = 0u;
  v80 = 0u;
  v81 = 0u;
  obj = v8;
  v60 = [obj countByEnumeratingWithState:&v80 objects:v88 count:16];
  v9 = 0;
  if (!v60)
  {
    goto LABEL_57;
  }

  v59 = *v81;
  v54 = self;
  v66 = v4;
  v61 = v8;
  do
  {
    v10 = 0;
    do
    {
      if (*v81 != v59)
      {
        v11 = v10;
        objc_enumerationMutation(obj);
        v10 = v11;
      }

      v63 = v10;
      v12 = *(*(&v80 + 1) + 8 * v10);
      context = objc_autoreleasePoolPush();
      v13 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v14 = [v13 persistedEntry:v12 fromLocation:@"{setConfigurationReferencesDescriptor}"];

      v64 = v14;
      if (!v14)
      {
        v16 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v87 = v12;
          _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load set-configuration from persisted-state | entryID:%{public}@", buf, 0xCu);
        }

        goto LABEL_33;
      }

      v15 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v16 = [v15 decodeFromLocation:@"{setConfigurationReferencesDescriptor}" ofEntryName:v12 fromPersistedEntry:v14 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v16)
      {
        v36 = _MADLog(@"AutoControl");
        v8 = v61;
        if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v87 = v64;
          _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load secure-coded set-configuration | entryID:%{public}@", buf, 0xCu);
        }

        goto LABEL_34;
      }

      v17 = [v16 firstEntryAssetType];
      v18 = [v4 assetType];
      v19 = [SUCore stringIsEqual:v17 to:v18];

      if (!v19)
      {
        v4 = v66;
LABEL_33:
        v8 = v61;
        goto LABEL_34;
      }

      v20 = [v16 latestAtomicInstanceToVend];

      v8 = v61;
      if (!v20)
      {
        v4 = v66;
        if ((v9 & 1) == 0)
        {
          goto LABEL_41;
        }

        goto LABEL_37;
      }

      v21 = [v16 latestAtomicInstanceToVend];
      v22 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setConfigurationReferencesDescriptor" forAtomicInstanceUUID:v21 requireExists:1];

      v23 = v22;
      v4 = v66;
      if (!v23)
      {
        v37 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
        {
          v38 = [v16 summary];
          *buf = 138543362;
          v87 = v38;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load set descriptor for latest-to-vend | setConfiguration:%{public}@", buf, 0xCu);

          v8 = v61;
        }

        if (v9)
        {
          goto LABEL_37;
        }

LABEL_41:
        v74 = 0u;
        v75 = 0u;
        v72 = 0u;
        v73 = 0u;
        v57 = v16;
        v71 = [v16 autoAssetEntries];
        v39 = [v71 countByEnumeratingWithState:&v72 objects:v84 count:16];
        if (v39)
        {
          v40 = v39;
          v41 = *v73;
          do
          {
            v42 = 0;
            v69 = v40;
            do
            {
              if (*v73 != v41)
              {
                objc_enumerationMutation(v71);
              }

              v43 = *(*(&v72 + 1) + 8 * v42);
              v44 = [v43 assetSelector];
              v45 = [v44 assetType];
              v46 = [v66 assetType];
              if (([SUCore stringIsEqual:v45 to:v46]& 1) != 0)
              {
                v47 = [v43 assetSelector];
                v48 = [v47 assetSpecifier];
                v49 = [v66 assetSpecifier];
                v50 = [SUCore stringIsEqual:v48 to:v49];

                v40 = v69;
                if (v50)
                {
                  v9 = 1;
                  goto LABEL_53;
                }
              }

              else
              {
              }

              v42 = v42 + 1;
            }

            while (v40 != v42);
            v40 = [v71 countByEnumeratingWithState:&v72 objects:v84 count:16];
          }

          while (v40);
          v9 = 0;
LABEL_53:
          v4 = v66;
          self = v54;
          v8 = v61;
        }

        else
        {
          v9 = 0;
        }

        v16 = v57;
        goto LABEL_34;
      }

      v53 = v9;
      v55 = v23;
      v56 = v16;
      v78 = 0u;
      v79 = 0u;
      v76 = 0u;
      v77 = 0u;
      v65 = [v23 latestDowloadedAtomicInstanceEntries];
      v70 = [v65 countByEnumeratingWithState:&v76 objects:v85 count:16];
      if (!v70)
      {
        goto LABEL_25;
      }

      v68 = *v77;
      do
      {
        for (i = 0; i != v70; i = i + 1)
        {
          if (*v77 != v68)
          {
            objc_enumerationMutation(v65);
          }

          v25 = *(*(&v76 + 1) + 8 * i);
          v26 = [v25 fullAssetSelector];
          v27 = [v26 assetType];
          v28 = [v4 assetType];
          if (![SUCore stringIsEqual:v27 to:v28])
          {
            goto LABEL_22;
          }

          v67 = [v25 fullAssetSelector];
          v29 = [v67 assetSpecifier];
          v30 = [v4 assetSpecifier];
          v31 = v29;
          if (![SUCore stringIsEqual:v29 to:v30])
          {

LABEL_22:
            continue;
          }

          v32 = [v25 fullAssetSelector];
          v33 = [v32 assetVersion];
          v34 = [v4 assetVersion];
          v35 = [SUCore stringIsEqual:v33 to:v34];

          v4 = v66;
          if (v35)
          {

            v9 = 1;
            v8 = v61;
            v16 = v56;
            self = v54;
            goto LABEL_34;
          }
        }

        v70 = [v65 countByEnumeratingWithState:&v76 objects:v85 count:16];
      }

      while (v70);
LABEL_25:

      v8 = v61;
      v16 = v56;
      self = v54;
      if ((v53 & 1) == 0)
      {
        goto LABEL_41;
      }

LABEL_37:
      v9 = 1;
LABEL_34:

      objc_autoreleasePoolPop(context);
      v10 = v63 + 1;
    }

    while ((v63 + 1) != v60);
    v51 = [obj countByEnumeratingWithState:&v80 objects:v88 count:16];
    v60 = v51;
  }

  while (v51);
LABEL_57:

LABEL_59:
  return v9 & 1;
}

- (id)setConfigurationAssetEntries:(id)a3
{
  v4 = a3;
  v5 = [v4 clientDomainName];
  v6 = [v4 assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:v5 forAssetSetIdentifier:v6];

  return v7;
}

- (id)setConfigurationAssetEntries:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v6];
  v11 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];

  v13 = [v12 autoAssetEntries];

  return v13;
}

- (id)setConfigurationNewEntryIDForSetConfiguration:(id)a3
{
  v4 = a3;
  v5 = [v4 clientDomainName];
  v6 = [v4 assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v5 forAssetSetIdentifier:v6];

  return v7;
}

- (id)setConfigurationNewEntryIDForInfoInstance:(id)a3
{
  v4 = a3;
  v5 = [v4 clientDomainName];
  v6 = [v4 assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForClientDomain:v5 forAssetSetIdentifier:v6];

  return v7;
}

- (id)setConfigurationNewEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v4 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:a3 forAssetSetIdentifier:a4];

  return v4;
}

- (BOOL)setConfiguration:(id)a3 matchesAssetEntriesFromInfoInstance:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = v7;
  if (!v6 || !v7 || ([v6 autoAssetEntries], (v9 = objc_claimAutoreleasedReturnValue()) == 0) || (v10 = v9, objc_msgSend(v8, "autoAssetEntries"), v11 = objc_claimAutoreleasedReturnValue(), v11, v10, !v11))
  {
    v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v34 = [v33 diag];
    v35 = [NSString alloc];
    if (v6)
    {
      v36 = [v6 summary];
      if (v8)
      {
LABEL_40:
        v37 = [v8 summary];
LABEL_43:
        v38 = [v35 initWithFormat:@"{setConfiguration:matchesAssetEntriesFromInfoInstance:} missing required | setConfiguration:%@, setInfoInstance:%@", v36, v37];
        [v34 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v38 withResult:6111 withError:0];

        if (v8)
        {
        }

        if (v6)
        {
        }

LABEL_48:
        v32 = 0;
        goto LABEL_49;
      }
    }

    else
    {
      v36 = @"N";
      if (v8)
      {
        goto LABEL_40;
      }
    }

    v37 = @"N";
    goto LABEL_43;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  obj = [v6 autoAssetEntries];
  v12 = [obj countByEnumeratingWithState:&v54 objects:v61 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v55;
    while (1)
    {
      v15 = 0;
LABEL_8:
      if (*v55 != v14)
      {
        objc_enumerationMutation(obj);
      }

      v16 = *(*(&v54 + 1) + 8 * v15);
      v50 = 0u;
      v51 = 0u;
      v52 = 0u;
      v53 = 0u;
      v17 = [v8 autoAssetEntries];
      v18 = [v17 countByEnumeratingWithState:&v50 objects:v60 count:16];
      if (!v18)
      {
        break;
      }

      v19 = v18;
      v20 = *v51;
LABEL_12:
      v21 = 0;
      while (1)
      {
        if (*v51 != v20)
        {
          objc_enumerationMutation(v17);
        }

        if ([v16 isEqual:*(*(&v50 + 1) + 8 * v21)])
        {
          break;
        }

        if (v19 == ++v21)
        {
          v19 = [v17 countByEnumeratingWithState:&v50 objects:v60 count:16];
          if (v19)
          {
            goto LABEL_12;
          }

          goto LABEL_50;
        }
      }

      if (++v15 != v13)
      {
        goto LABEL_8;
      }

      v13 = [obj countByEnumeratingWithState:&v54 objects:v61 count:16];
      if (!v13)
      {
        goto LABEL_21;
      }
    }

LABEL_50:

    goto LABEL_48;
  }

LABEL_21:

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  obja = [v8 autoAssetEntries];
  v22 = [obja countByEnumeratingWithState:&v46 objects:v59 count:16];
  if (v22)
  {
    v23 = v22;
    v24 = *v47;
    while (1)
    {
      v25 = 0;
LABEL_24:
      if (*v47 != v24)
      {
        objc_enumerationMutation(obja);
      }

      v26 = *(*(&v46 + 1) + 8 * v25);
      v42 = 0u;
      v43 = 0u;
      v44 = 0u;
      v45 = 0u;
      v27 = [v6 autoAssetEntries];
      v28 = [v27 countByEnumeratingWithState:&v42 objects:v58 count:16];
      if (!v28)
      {
        break;
      }

      v29 = v28;
      v30 = *v43;
LABEL_28:
      v31 = 0;
      while (1)
      {
        if (*v43 != v30)
        {
          objc_enumerationMutation(v27);
        }

        if ([v26 isEqual:*(*(&v42 + 1) + 8 * v31)])
        {
          break;
        }

        if (v29 == ++v31)
        {
          v29 = [v27 countByEnumeratingWithState:&v42 objects:v58 count:16];
          if (v29)
          {
            goto LABEL_28;
          }

          goto LABEL_51;
        }
      }

      if (++v25 != v23)
      {
        goto LABEL_24;
      }

      v23 = [obja countByEnumeratingWithState:&v46 objects:v59 count:16];
      v32 = 1;
      if (!v23)
      {
        goto LABEL_53;
      }
    }

LABEL_51:

    v32 = 0;
  }

  else
  {
    v32 = 1;
  }

LABEL_53:

LABEL_49:
  return v32;
}

- (BOOL)setConfigurationPotentialLatestToVend:(id)a3 forSetDescriptor:(id)a4 forSetConfiguration:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:setConfigurationPotentialLatestToVend", v8];
  v14 = [v9 latestDownloadedAtomicInstance];

  if (v14 && ([v9 latestDowloadedAtomicInstanceEntries], v15 = objc_claimAutoreleasedReturnValue(), v16 = objc_msgSend(v15, "count"), v15, v16))
  {
    v34 = 0u;
    v35 = 0u;
    v32 = 0u;
    v33 = 0u;
    obj = [v9 latestDowloadedAtomicInstanceEntries];
    v17 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    if (v17)
    {
      v18 = v17;
      v19 = 0;
      v20 = *v33;
      v29 = v10;
      v30 = v8;
      while (2)
      {
        for (i = 0; i != v18; i = i + 1)
        {
          if (*v33 != v20)
          {
            objc_enumerationMutation(obj);
          }

          v22 = *(*(&v32 + 1) + 8 * i);
          v23 = objc_autoreleasePoolPush();
          if (!v22)
          {
            goto LABEL_18;
          }

          v24 = [v22 fullAssetSelector];
          v25 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v24];

          if (!v25 || ![v25 isOnFilesystem] || +[MADAutoAssetSecure doesDescriptorInvolvePersonalization:forDescriptor:](MADAutoAssetSecure, "doesDescriptorInvolvePersonalization:forDescriptor:", v13, v25) && +[MADAutoAssetSecure isPersonalizationRequired:forDescriptor:](MADAutoAssetSecure, "isPersonalizationRequired:forDescriptor:", v13, v25))
          {

LABEL_18:
            objc_autoreleasePoolPop(v23);
            v26 = 0;
            v10 = v29;
            v8 = v30;
            goto LABEL_20;
          }

          objc_autoreleasePoolPop(v23);
          v19 = 1;
        }

        v18 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
        v26 = 1;
        v10 = v29;
        v8 = v30;
        if (v18)
        {
          continue;
        }

        break;
      }
    }

    else
    {
      v19 = 0;
      v26 = 1;
    }

LABEL_20:

    v27 = v19 & v26;
  }

  else
  {
    v27 = 0;
  }

  return v27;
}

- (BOOL)setConfigurationAdoptLatestToVend:(id)a3 fromSetDescriptor:(id)a4 toSetConfiguration:(id)a5 fromPreSUStaging:(BOOL)a6 allowEmpty:(BOOL)a7
{
  v146 = a6;
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v151 = v11;
  v16 = [[NSString alloc] initWithFormat:@"%@:setConfigurationAdoptLatestToVend", v11];
  v17 = [v12 latestDownloadedAtomicInstance];
  v18 = [v13 latestAtomicInstanceToVend];
  v19 = [SUCore stringIsEqual:v17 to:v18];

  v20 = [v12 latestDownloadedAtomicInstance];

  if (!v20)
  {
    v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v34 = [v33 diag];
    v35 = [NSString alloc];
    if (v12)
    {
      v36 = [v12 summary];
    }

    else
    {
      v36 = @"N";
    }

    v38 = v151;
    v39 = [v35 initWithFormat:@"{%@} set-descriptor without latest-to-vend | setDescriptor:%@", v16, v36];
    goto LABEL_41;
  }

  v152 = self;
  v21 = a7 | v19;
  v22 = [v12 latestDowloadedAtomicInstanceEntries];
  v23 = ([v22 count] != 0) | v21;

  if ((v23 & 1) == 0)
  {
    v33 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
    v34 = [v33 diag];
    v37 = [NSString alloc];
    if (v12)
    {
      v36 = [v12 summary];
    }

    else
    {
      v36 = @"N";
    }

    v38 = v151;
    v39 = [v37 initWithFormat:@"{%@} empty set-descriptor | setDescriptor:%@", v16, v36];
LABEL_41:
    v61 = v39;
    [v34 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v39 withResult:6108 withError:0];

    if (v12)
    {
    }

LABEL_44:
    v62 = 0;
    goto LABEL_45;
  }

  v156 = 0u;
  v157 = 0u;
  v154 = 0u;
  v155 = 0u;
  v24 = [v12 latestDowloadedAtomicInstanceEntries];
  v25 = [v24 countByEnumeratingWithState:&v154 objects:v164 count:16];
  v153 = v16;
  if (v25)
  {
    v26 = v25;
    v142 = v13;
    v144 = v12;
    v27 = *v155;
    obj = v24;
LABEL_5:
    v28 = 0;
    while (1)
    {
      if (*v155 != v27)
      {
        objc_enumerationMutation(obj);
      }

      v29 = *(*(&v154 + 1) + 8 * v28);
      v30 = objc_autoreleasePoolPush();
      if (!v29)
      {
        break;
      }

      v31 = [v29 fullAssetSelector];
      v32 = [(MADAutoAssetControlManager *)v152 locateDownloadedByFullSelector:v31];

      if (!v32)
      {
        v147 = @"{%@} unable to locate asset-descriptor for atomic-instance entry | nextAtomicEntry:%@ | setDescriptor:%@";
        goto LABEL_50;
      }

      if (![v32 isOnFilesystem])
      {
        v147 = @"{%@} atomic-instance entry no longer on the filesystem | nextAtomicEntry:%@ | setDescriptor:%@";
LABEL_50:
        v71 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
        v72 = [v71 diag];
        v73 = [NSString alloc];
        v74 = [v29 summary];
        v68 = v144;
        v75 = [v144 summary];
        v16 = v153;
        v76 = [v73 initWithFormat:v147, v153, v74, v75];
        [v72 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v76 withResult:6108 withError:0];

LABEL_51:
        v77 = v30;
        v12 = v68;
        objc_autoreleasePoolPop(v77);

        v62 = 0;
        v38 = v151;
        v13 = v142;
        p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
        if (v21)
        {
          goto LABEL_45;
        }

        goto LABEL_52;
      }

      if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v153 forDescriptor:v32]&& [MADAutoAssetSecure isPersonalizationRequired:v153 forDescriptor:v32])
      {
        v95 = _MADLog(@"AutoControl");
        v38 = v151;
        if (os_log_type_enabled(v95, OS_LOG_TYPE_DEFAULT))
        {
          v96 = [v29 summary];
          v97 = [v144 summary];
          *buf = 138543874;
          v159 = v151;
          v160 = 2114;
          v161 = v96;
          v162 = 2114;
          v163 = v97;
          _os_log_impl(&dword_0, v95, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] [NO_CHANGE] atomic-instance entry requiring personalization | nextAtomicEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
        }

        objc_autoreleasePoolPop(v30);
        v13 = v142;
        v12 = v144;
        v16 = v153;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if ((v21 & 1) == 0)
        {
          v62 = 1;
          goto LABEL_52;
        }

        goto LABEL_55;
      }

      objc_autoreleasePoolPop(v30);
      v28 = v28 + 1;
      v21 = 1;
      if (v26 == v28)
      {
        v26 = [obj countByEnumeratingWithState:&v154 objects:v164 count:16];
        if (v26)
        {
          goto LABEL_5;
        }

        v13 = v142;
        v12 = v144;
        v16 = v153;
        goto LABEL_23;
      }
    }

    v65 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
    v66 = [v65 diag];
    v67 = [NSString alloc];
    v68 = v144;
    v69 = [v144 summary];
    v16 = v153;
    v70 = [v67 initWithFormat:@"{%@} unable to access latest downloaded atomic-instance entry | setDescriptor:%@", v153, v69];
    [v66 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v70 withResult:6108 withError:0];

    goto LABEL_51;
  }

  if ((v21 & 1) == 0)
  {
    v62 = 1;
    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    v38 = v151;
LABEL_52:
    v78 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v78, OS_LOG_TYPE_DEFAULT))
    {
      v79 = [v12 summary];
      *buf = 138543618;
      v159 = v16;
      v160 = 2114;
      v161 = v79;
      _os_log_impl(&dword_0, v78, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] [NO_CHANGE] no asset-versions are available to the client | setDescriptor:%{public}@", buf, 0x16u);
    }

    if (v62)
    {
LABEL_55:
      v80 = [v13 newerAtomicInstanceOncePersonalized];
      if (v80)
      {
        v81 = v80;
        v82 = p_weak_ivar_lyt[223];
        v83 = [v12 latestDownloadedAtomicInstance];
        v84 = [v13 newerAtomicInstanceOncePersonalized];
        LOBYTE(v82) = [v82 stringIsEqual:v83 to:v84];

        if (v82)
        {
          v62 = 0;
          v16 = v153;
          goto LABEL_45;
        }

        v85 = p_weak_ivar_lyt[223];
        v86 = [v13 newerAtomicInstanceOncePersonalized];
        v87 = [v12 latestDownloadedAtomicInstance];
        LODWORD(v85) = [v85 stringIsEqual:v86 to:v87];

        if (v85)
        {
          v88 = v152;
          v89 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
          v90 = [v89 diag];
          v91 = [NSString alloc];
          v92 = [v13 summary];
          v93 = [v12 summary];
          v94 = [v91 initWithFormat:@"{%@} set-configuration newer-once-personalized matches not-fully-personalized set-descriptor to become newer-once-personalized | setConfiguration:%@ | setDescriptor:%@", v153, v92, v93];
          [v90 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v94 withResult:6108 withError:0];

          v16 = v153;
        }

        else
        {
          v89 = [v13 newerAtomicInstanceOncePersonalized];
          v88 = v152;
          v16 = v153;
          [(MADAutoAssetControlManager *)v152 atomicInstanceRemove:v153 setAtomicInstanceUUID:v89 removingForReason:@"dropping set-configuration older newer-once-personalized" historyOperation:343];
        }

        v104 = [v12 latestDownloadedAtomicInstance];
        [v13 setNewerAtomicInstanceOncePersonalized:v104];

        [(MADAutoAssetControlManager *)v88 setConfigurationPersist:v13 fromLocation:v16 forReason:@"unable to make latest-to-vend since not fully personalized so tracked as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
      }
    }

    goto LABEL_44;
  }

LABEL_23:
  if (v19)
  {
    if ([v13 vendingAtomicInstanceForConfiguredEntries])
    {
LABEL_65:
      v62 = 0;
      v38 = v151;
      goto LABEL_45;
    }

    if (([v13 vendingAtomicInstanceForConfiguredEntries] & 1) == 0)
    {
      v40 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
      {
        v41 = [v12 summary];
        *buf = 138543618;
        v159 = v16;
        v160 = 2114;
        v161 = v41;
        _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-descriptor matches latest-to-vend when vendingAtomicInstanceForConfiguredEntries=NO | setDescriptor:%{public}@", buf, 0x16u);
      }
    }
  }

  if (![(MADAutoAssetControlManager *)v152 setDescriptorVerifyNoDuplicates:v12])
  {
    v42 = [(MADAutoAssetControlManager *)v152 setDescriptorDedupDownloadedEntries:v16 forSetDescriptor:v12];
    if (v42)
    {
      [(MADAutoAssetControlManager *)v152 persistSetDescriptorDownloadedJob:v42 fromLocation:v16];
      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
      {
        v44 = [v42 summary];
        *buf = 138543618;
        v159 = v153;
        v160 = 2114;
        v161 = v44;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND][SELF-HEAL] deduped setDescriptor:%{public}@", buf, 0x16u);
      }

      v45 = v42;
      v12 = v45;
    }
  }

  if (![(MADAutoAssetControlManager *)v152 setDescriptorVerifyNoDuplicates:v12])
  {
    v98 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
    v99 = [v98 diag];
    v100 = [NSString alloc];
    v101 = [v12 summary];
    v102 = [v13 summary];
    v103 = [v100 initWithFormat:@"{%@} all entries available yet set-descriptor contains duplicate selectors | setDescriptor:%@| setConfiguration:%@", v153, v101, v102];
    [v99 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v103 withResult:6108 withError:0];

    v16 = v153;
    goto LABEL_65;
  }

  v141 = v19;
  v46 = [v12 latestDownloadedAtomicInstance];
  v47 = [(MADAutoAssetControlManager *)v152 locateSetAtomicInstanceByInstanceUUID:v46];

  v48 = [[NSMutableString alloc] initWithString:{@"have-received-lookup-response, vending-for-configured"}];
  [v13 setHaveReceivedLookupResponse:1];
  [v13 setVendingAtomicInstanceForConfiguredEntries:1];
  v49 = [v13 newerAtomicInstanceOncePersonalized];

  if (v49)
  {
    v50 = [v13 newerAtomicInstanceOncePersonalized];
    v51 = [v12 latestDownloadedAtomicInstance];
    v52 = [SUCore stringIsEqual:v50 to:v51];

    if (v52)
    {
      v53 = [(MADAutoAssetControlManager *)v152 autoControlManagerFSM];
      v54 = [v53 diag];
      v55 = [NSString alloc];
      v56 = [v13 summary];
      [v12 summary];
      v57 = v47;
      v59 = v58 = v48;
      v60 = [v55 initWithFormat:@"{%@} set-configuration newer-once-personalized matches set-descriptor to become latest-to-vend | setConfiguration:%@ | setDescriptor:%@", v153, v56, v59];
      [v54 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v60 withResult:6108 withError:0];

      v48 = v58;
      v47 = v57;
    }

    else
    {
      v53 = [v13 newerAtomicInstanceOncePersonalized];
      [(MADAutoAssetControlManager *)v152 atomicInstanceRemove:v153 setAtomicInstanceUUID:v53 removingForReason:@"dropping set-configuration newer-once-personalized" historyOperation:343];
    }

    [v13 setNewerAtomicInstanceOncePersonalized:0];
    [v48 appendString:{@", cleared newer-once-personalized"}];
  }

  v105 = [v13 discoveredInFlightAtomicInstance];
  v106 = [v12 latestDownloadedAtomicInstance];
  v107 = [SUCore stringIsEqual:v105 to:v106];

  if (v107)
  {
    [v13 setDiscoveredInFlightAtomicInstance:0];
    [v48 appendString:{@", cleared discovered-in-flight"}];
  }

  [v13 setHaveReceivedLookupResponse:1];
  [v13 setVendingAtomicInstanceForConfiguredEntries:1];
  v108 = [v13 latestAtomicInstanceToVend];
  if (v108)
  {
    v109 = [v13 latestAtomicInstanceToVend];
    v110 = [(MADAutoAssetControlManager *)v152 locateSetDescriptor:v153 forAtomicInstanceUUID:v109 requireExists:1];

    if (v110)
    {
      LODWORD(v108) = [(MADAutoAssetControlManager *)v152 doesSetJobDescriptor:v12 representSameContentAs:v110];
    }

    else
    {
      LODWORD(v108) = 0;
    }
  }

  v16 = v153;
  if ((v141 | v108))
  {
    [(MADAutoAssetControlManager *)v152 setConfigurationAssetSetIDMostRecentlyReceived:v153 fromSetDescriptor:v12 forSetConfiguration:v13 buildingPersistReason:v48];
    [(MADAutoAssetControlManager *)v152 setConfigurationAssetSetIDLatestToVend:v153 fromSetDescriptor:v12 forSetConfiguration:v13 buildingPersistReason:v48];
    [(MADAutoAssetControlManager *)v152 setConfigurationPersist:v13 fromLocation:v153 forReason:v48 dueToAlter:0 forHistoryOperation:457];
    v62 = 0;
    v38 = v151;
  }

  else
  {
    v143 = v48;
    v62 = [(MADAutoAssetControlManager *)v152 setConfigurationTrackLatestToVend:v153 forSetConfiguration:v13 becomingLatestToVend:v12 historyOperation:441 fromPreSUStaging:v146];
    v111 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v111, OS_LOG_TYPE_DEFAULT))
    {
      v112 = [v13 summary];
      *buf = 138543618;
      v159 = v153;
      v160 = 2114;
      v161 = v112;
      _os_log_impl(&dword_0, v111, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[FROM-TRACKED-LATEST-TO-VEND] update to set-configuration latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x16u);
    }

    v148 = [v13 autoAssetEntries];
    v140 = [v148 count];
    v113 = [v12 requestedAutoAssetEntries];
    v139 = [v113 count];
    v114 = [v12 discoveredAtomicEntries];
    v138 = [v114 count];
    obja = v47;
    [v47 instanceEntries];
    v116 = v115 = v12;
    v117 = [v116 count];
    v118 = [v13 clientDomainName];
    [v13 assetSetIdentifier];
    v120 = v119 = v13;
    v121 = [v119 latestAtomicInstanceToVend];
    v145 = v115;
    v122 = [(MADAutoAssetControlManager *)v152 _specifierVersionNamesForSetDescriptor:v115];
    [MADAutoAssetHistory recordOperation:441 toHistoryType:2 fromLayer:1 configuredCount:v140 requestedCount:v139 fromPallasCount:v138 vendingCount:v117 forClientDomainName:v118 forAssetSetIdentifier:v120 forAtomicInstance:v121 withAddendumMessage:v122];

    v13 = v119;
    if (+[MAAIRBEventReporter isAvailable])
    {
      v123 = [MAAIRBMobileAssetOperationMetadata alloc];
      v124 = [MADAutoAssetHistoryTracker operationName:441];
      v125 = [(MAAIRBMobileAssetOperationMetadata *)v123 initWithCode:441 name:v124];

      v126 = [MAAIRBMobileAssetAtomicInstance alloc];
      v127 = [MAAIRBMobileAssetAssetSet alloc];
      v128 = [v119 assetSetIdentifier];
      v129 = [(MAAIRBMobileAssetAssetSet *)v127 initWithAssetSetIdentifier:v128];
      v130 = [v119 latestAtomicInstanceToVend];
      v131 = [(MAAIRBMobileAssetAtomicInstance *)v126 initWithAssetSet:v129 atomicInstanceId:v130];

      v132 = [obja instanceEntries];
      v133 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v125, v131, [v132 count]);

      v134 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v133];
      [MAAIRBEventReporter emitAppleIntelligenceEvent:v134];
    }

    v12 = v145;
    [(MADAutoAssetControlManager *)v152 _reclaimDownloadedDescriptorsWhenJustDownloaded:v145 fromLocation:v153];
    v38 = v151;
    v48 = v143;
    if (([v145 atomicInstanceDownloadedNotified] & 1) == 0)
    {
      [v145 setAtomicInstanceDownloadedNotified:1];
      [(MADAutoAssetControlManager *)v152 persistSetDescriptorDownloadedJob:v145 fromLocation:v153];
    }

    v135 = [v119 clientDomainName];
    v136 = [v119 assetSetIdentifier];
    v137 = [v119 latestAtomicInstanceToVend];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_DOWNLOADED" forClientDomainName:v135 forAssetSetIdentifier:v136 forAtomicInstanceUUID:v137 fromModule:@"AUTO-CONTROL" fromLocation:v153];

    v16 = v153;
    v47 = obja;
  }

LABEL_45:
  return v62;
}

- (void)setConfigurationAssetSetIDMostRecentlyReceived:(id)a3 fromSetDescriptor:(id)a4 forSetConfiguration:(id)a5 buildingPersistReason:(id)a6
{
  v21 = a4;
  v9 = a5;
  v10 = a6;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [v21 catalogCachedAssetSetID];

  if (v13)
  {
    v14 = [v21 catalogCachedAssetSetID];
    [v9 setMostRecentlyReceivedCachedAssetSetID:v14];
  }

  v15 = [v21 catalogDownloadedFromLive];

  if (v15)
  {
    v16 = [v21 catalogDownloadedFromLive];
    [v9 setMostRecentlyReceivedDownloadedFromLive:v16];
  }

  v17 = [v21 catalogLastTimeChecked];

  if (v17)
  {
    v18 = [v21 catalogLastTimeChecked];
    [v9 setMostRecentlyReceivedLastTimeChecked:v18];
  }

  v19 = [v21 catalogPostedDate];

  if (v19)
  {
    v20 = [v21 catalogPostedDate];
    [v9 setMostRecentlyReceivedPostedDate:v20];
  }

  [v10 appendString:{@", updated asset-set-ID (most-recenty-received)"}];
}

- (void)setConfigurationAssetSetIDLatestToVend:(id)a3 fromSetDescriptor:(id)a4 forSetConfiguration:(id)a5 buildingPersistReason:(id)a6
{
  v21 = a4;
  v9 = a5;
  v10 = a6;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [v21 catalogCachedAssetSetID];

  if (v13)
  {
    v14 = [v21 downloadedCatalogCachedAssetSetID];
    [v9 setLatestToVendCachedAssetSetID:v14];
  }

  v15 = [v21 catalogDownloadedFromLive];

  if (v15)
  {
    v16 = [v21 downloadedCatalogDownloadedFromLive];
    [v9 setLatestToVendDownloadedFromLive:v16];
  }

  v17 = [v21 catalogLastTimeChecked];

  if (v17)
  {
    v18 = [v21 downloadedCatalogLastTimeChecked];
    [v9 setLatestToVendLastTimeChecked:v18];
  }

  v19 = [v21 catalogPostedDate];

  if (v19)
  {
    v20 = [v21 downloadedCatalogPostedDate];
    [v9 setLatestToVendPostedDate:v20];
  }

  [v10 appendString:{@", updated asset-set-ID (latest-to-vend)"}];
}

- (BOOL)setConfigurationTrackAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 addingAtomicInstance:(id)a5
{
  v8 = a4;
  v9 = a5;
  v10 = a3;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:setConfigurationTrackAsPreviouslyVended", v10];
  if (v9)
  {
    v14 = [v8 previouslyVendedLockedAtomicInstances];

    if (!v14)
    {
      v15 = objc_alloc_init(NSMutableArray);
      [v8 setPreviouslyVendedLockedAtomicInstances:v15];
    }

    v16 = [v8 previouslyVendedLockedAtomicInstances];
    [v16 count];

    v17 = [v8 previouslyVendedLockedAtomicInstances];
    [v17 addObject:v9];

    [v8 setTicksUntilPreviousForceUnlocked:2];
  }

  else
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v19 = [v18 diag];
    v20 = [NSString alloc];
    v21 = [v8 summary];
    v22 = [v20 initWithFormat:@"{%@} setConfigurationTrackAsPreviouslyVended nil atomic-instance-UUID | setConfiguration:%@", v13, v21];
    [v19 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v22 withResult:6111 withError:0];
  }

  return v9 != 0;
}

- (void)setConfigurationTickForPreviouslyVended
{
  v2 = self;
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  [(MADAutoAssetControlManager *)v2 trackPerformanceIteration:@"setConfigurationTickForPreviouslyVended" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  v5 = [(MADAutoAssetControlManager *)v2 knownSetConfigurationsByIdentifier];
  v6 = [v5 allKeys];
  v7 = [v6 copy];

  v8 = [v7 countByEnumeratingWithState:&v32 objects:v38 count:16];
  if (v8)
  {
    v10 = v8;
    v11 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v13 = @"setConfigurationTickForPreviouslyVended";
    *&v9 = 138543362;
    v30 = v9;
    v31 = v2;
    do
    {
      v14 = 0;
      do
      {
        if (*v33 != v11)
        {
          objc_enumerationMutation(v7);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = objc_autoreleasePoolPush();
        v17 = [(MADAutoAssetControlManager *)v2 knownSetConfigurationsByIdentifier];
        v18 = [v17 safeObjectForKey:v15 ofClass:objc_opt_class()];

        if (([v18 ticksUntilPreviousForceUnlocked] & 0x8000000000000000) == 0)
        {
          v19 = [v18 ticksUntilPreviousForceUnlocked];
          v20 = [v18 ticksUntilPreviousForceUnlocked];
          if (v19 < 1)
          {
            if (v20 >= 1)
            {
              goto LABEL_15;
            }

LABEL_13:
            [(MADAutoAssetControlManager *)v2 setConfigurationAllPreviouslyVendedForceUnlock:v13 forSetConfiguration:v18, v21, v30];
            v21 = @"ticksUntilPreviousForceUnlocked FIRED - force-unlocked";
          }

          else
          {
            [v18 setTicksUntilPreviousForceUnlocked:v20 - 1];
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
            {
              [v18 summary];
              v23 = v10;
              v24 = v11;
              v25 = p_weak_ivar_lyt;
              v26 = v7;
              v28 = v27 = v13;
              *buf = v30;
              v37 = v28;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "{setConfigurationTickForPreviouslyVended}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] decremented countdown to force-unlocked | nextSetConfiguration:%{public}@", buf, 0xCu);

              v13 = v27;
              v7 = v26;
              p_weak_ivar_lyt = v25;
              v11 = v24;
              v10 = v23;
              v2 = v31;
            }

            v29 = [v18 ticksUntilPreviousForceUnlocked];
            v21 = @"decremented ticksUntilPreviousForceUnlocked";
            if (v29 <= 0)
            {
              goto LABEL_13;
            }
          }

          [(MADAutoAssetControlManager *)v2 setConfigurationPersist:v18 fromLocation:v13 forReason:v21 dueToAlter:0 forHistoryOperation:9999, v30];
        }

LABEL_15:

        objc_autoreleasePoolPop(v16);
        v14 = v14 + 1;
      }

      while (v10 != v14);
      v10 = [v7 countByEnumeratingWithState:&v32 objects:v38 count:16];
    }

    while (v10);
  }
}

- (void)setConfigurationForceUnlocked:(id)a3 forSetConfiguration:(id)a4
{
  v17 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSString alloc] initWithFormat:@"%@:setConfigurationForceUnlocked", v6];
  v10 = [v17 latestAtomicInstanceToVend];
  v11 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v9 forAtomicInstanceUUID:v10 requireExists:0];

  v12 = [v17 latestAtomicInstanceToVend];
  v13 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v12];

  [(MADAutoAssetControlManager *)self setConfigurationAllPreviouslyVendedForceUnlock:v9 forSetConfiguration:v17];
  if (v11)
  {
    v14 = [v17 availableForUseError];
    [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v9 dueToError:v14 forgettingAtomicInstance:v13];
  }

  v15 = [v17 clientDomainName];
  v16 = [v17 assetSetIdentifier];
  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:v15 forSetIdentifier:v16];

  [v17 setVendingAtomicInstanceForConfiguredEntries:0];
  [(MADAutoAssetControlManager *)self setConfigurationTrackLatestToVend:v9 forSetConfiguration:v17 becomingLatestToVend:0 historyOperation:442 fromPreSUStaging:0];
  [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:v9 toNewStatus:@"FORGOTTEN" forAtomicInstance:v13];
}

- (BOOL)setConfigurationIsTrackedAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 forAtomicInstanceUUID:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:setConfigurationIsTrackedAsPreviouslyVended", v8];
  v14 = [v9 previouslyVendedLockedAtomicInstances];

  if (v14)
  {
    v15 = [v9 previouslyVendedLockedAtomicInstances];
    v16 = [v15 count];

    v17 = v16 - 1;
    if (v16 < 1)
    {
      v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v14 = [v22 diag];
      v23 = [NSString alloc];
      v24 = [v9 summary];
      v25 = [v23 initWithFormat:@"{%@} previouslyVendedLockedAtomicInstances count of 0 yet present | setConfiguration:%@", v13, v24];
      [v14 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6111 withError:0];

      LOBYTE(v14) = 0;
    }

    else
    {
      v18 = 0;
      do
      {
        v19 = objc_autoreleasePoolPush();
        v14 = [v9 previouslyVendedLockedAtomicInstances];
        v20 = [v14 objectAtIndex:v18];

        LOBYTE(v14) = [SUCore stringIsEqual:v20 to:v10];
        objc_autoreleasePoolPop(v19);
        if (v14)
        {
          break;
        }
      }

      while (v17 != v18++);
    }
  }

  return v14;
}

- (BOOL)setConfigurationAllPreviouslyVendedForceUnlock:(id)a3 forSetConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:setConfigurationAllPreviouslyVendedForceUnlock", v6];
  v11 = [v7 previouslyVendedLockedAtomicInstances];
  v12 = v11 != 0;

  if (v11)
  {
    v13 = [v7 previouslyVendedLockedAtomicInstances];
    v14 = [v13 count];

    if (v14)
    {
      v49 = v12;
      v51 = v6;
      v15 = [v7 previouslyVendedLockedAtomicInstances];
      v16 = [v15 count];

      v17 = [NSMutableString alloc];
      if (v16 == &dword_0 + 1)
      {
        v18 = @":";
      }

      else
      {
        v18 = @"s:\n";
      }

      v19 = [v17 initWithString:v18];
      v53 = objc_alloc_init(NSMutableArray);
      v59 = 0u;
      v60 = 0u;
      v61 = 0u;
      v62 = 0u;
      v50 = v7;
      v20 = [v7 previouslyVendedLockedAtomicInstances];
      v21 = [v20 copy];

      obj = v21;
      v22 = [v21 countByEnumeratingWithState:&v59 objects:v68 count:16];
      if (v22)
      {
        v23 = v22;
        v24 = *v60;
        v25 = 1;
        v52 = self;
        do
        {
          for (i = 0; i != v23; i = i + 1)
          {
            if (*v60 != v24)
            {
              objc_enumerationMutation(obj);
            }

            v27 = *(*(&v59 + 1) + 8 * i);
            v28 = objc_autoreleasePoolPush();
            v29 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v10 forAtomicInstanceUUID:v27 requireExists:1];
            if (v25)
            {
              [v19 appendString:v27];
              if (!v29)
              {
                goto LABEL_20;
              }
            }

            else
            {
              [v19 appendFormat:@", %@", v27];
              if (!v29)
              {
                goto LABEL_20;
              }
            }

            v30 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v27];
            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
            {
              [v29 summary];
              v32 = v23;
              v33 = v24;
              v35 = v34 = v19;
              *buf = 138543618;
              v65 = v10;
              v66 = 2114;
              v67 = v35;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] all previously vended force-unlocked | previouslyVendedSetDescriptor:%{public}@", buf, 0x16u);

              v19 = v34;
              v24 = v33;
              v23 = v32;
              self = v52;
            }

            if (v30)
            {
              [v53 addObject:v30];
            }

LABEL_20:
            objc_autoreleasePoolPop(v28);
            v25 = 0;
          }

          v23 = [obj countByEnumeratingWithState:&v59 objects:v68 count:16];
          v25 = 0;
        }

        while (v23);
      }

      v57 = 0u;
      v58 = 0u;
      v55 = 0u;
      v56 = 0u;
      v36 = v53;
      v37 = [v36 countByEnumeratingWithState:&v55 objects:v63 count:16];
      v12 = v49;
      if (v37)
      {
        v38 = v37;
        v39 = *v56;
        do
        {
          for (j = 0; j != v38; j = j + 1)
          {
            if (*v56 != v39)
            {
              objc_enumerationMutation(v36);
            }

            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v10 dueToError:0 forgettingAtomicInstance:*(*(&v55 + 1) + 8 * j)];
          }

          v38 = [v36 countByEnumeratingWithState:&v55 objects:v63 count:16];
        }

        while (v38);
      }

      v41 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v65 = v10;
        v66 = 2114;
        v67 = v19;
        _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] all previously vended force-unlocked | dropped atomic-instance%{public}@", buf, 0x16u);
      }

      v7 = v50;
      v6 = v51;
    }

    else
    {
      v42 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v43 = [v42 diag];
      v44 = [NSString alloc];
      v45 = [v7 summary];
      v46 = [v44 initWithFormat:@"{%@} ticksUntilPreviousForceUnlocked at 0 yet no previouslyVendedLockedAtomicInstances | setConfiguration:%@", v10, v45];
      [v43 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v46 withResult:6111 withError:0];
    }
  }

  v47 = [v7 previouslyVendedLockedAtomicInstances];

  if (v47)
  {
    [v7 setPreviouslyVendedLockedAtomicInstances:0];
    v12 = 1;
  }

  if ([v7 ticksUntilPreviousForceUnlocked] != -1)
  {
    [v7 setTicksUntilPreviousForceUnlocked:-1];
    v12 = 1;
  }

  return v12;
}

- (BOOL)setConfigurationForgetIfTrackedAsPreviouslyVended:(id)a3 forSetConfiguration:(id)a4 removingAtomicInstance:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:setConfigurationForgetIfTrackedAsPreviouslyVended", v8];
  v14 = [v9 previouslyVendedLockedAtomicInstances];

  if (v14)
  {
    v15 = [v9 previouslyVendedLockedAtomicInstances];
    v16 = [v15 count];

    if (v16 <= 0)
    {
      v28 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v29 = [v28 diag];
      v30 = [NSString alloc];
      v31 = [v9 summary];
      v32 = [v30 initWithFormat:@"{%@} previouslyVendedLockedAtomicInstances count of 0 yet present | setConfiguration:%@", v13, v31];
      [v29 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v32 withResult:6111 withError:0];

      [v9 setPreviouslyVendedLockedAtomicInstances:0];
      [v9 setTicksUntilPreviousForceUnlocked:-1];
      v24 = 1;
    }

    else
    {
      v34 = self;
      v35 = v13;
      v36 = v8;
      v17 = objc_alloc_init(NSMutableArray);
      v18 = 0;
      v19 = -1;
      do
      {
        v20 = objc_autoreleasePoolPush();
        v21 = [v9 previouslyVendedLockedAtomicInstances];
        v22 = [v21 objectAtIndex:v18];

        v23 = v18;
        if (([SUCore stringIsEqual:v22 to:v10]& 1) == 0)
        {
          [v17 addObject:v22];
          v23 = v19;
        }

        objc_autoreleasePoolPop(v20);
        ++v18;
        v19 = v23;
      }

      while (v16 != v18);
      v24 = v23 >= 0;
      v13 = v35;
      if ((v23 & 0x8000000000000000) == 0)
      {
        v25 = [(MADAutoAssetControlManager *)v34 locateSetAtomicInstanceByInstanceUUID:v10];
        [v9 setPreviouslyVendedLockedAtomicInstances:v17];
        v26 = [v9 previouslyVendedLockedAtomicInstances];
        v27 = [v26 count];

        if (!v27)
        {
          [v9 setPreviouslyVendedLockedAtomicInstances:0];
          [v9 setTicksUntilPreviousForceUnlocked:-1];
        }

        if (v25)
        {
          [(MADAutoAssetControlManager *)v34 atomicInstanceForceUnlock:v35 dueToError:0 forgettingAtomicInstance:v25];
        }
      }

      v8 = v36;
    }
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (void)setConfigurationRemovedAtomicInstance:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:setConfigurationRemovedAtomicInstance", v7];
  if (v6)
  {
    v29 = v7;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"knownSetConfigurationsByIdentifier"];
    v34 = 0u;
    v35 = 0u;
    v32 = 0u;
    v33 = 0u;
    v11 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    [v11 allKeys];
    v12 = v31 = v10;
    v13 = [v12 copy];

    v10 = v31;
    obj = v13;
    v14 = [v13 countByEnumeratingWithState:&v32 objects:v36 count:16];
    if (!v14)
    {
      goto LABEL_18;
    }

    v15 = v14;
    v16 = *v33;
    while (1)
    {
      v17 = 0;
      do
      {
        if (*v33 != v16)
        {
          objc_enumerationMutation(obj);
        }

        v18 = *(*(&v32 + 1) + 8 * v17);
        v19 = objc_autoreleasePoolPush();
        v20 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v21 = [v20 safeObjectForKey:v18 ofClass:objc_opt_class()];

        if (v21)
        {
          v22 = [v21 discoveredInFlightAtomicInstance];
          v23 = [SUCore stringIsEqual:v22 to:v6];

          if (v23)
          {
            [v21 setDiscoveredInFlightAtomicInstance:0];
          }

          v24 = [v21 newerAtomicInstanceOncePersonalized];
          v25 = [SUCore stringIsEqual:v24 to:v6];

          if (v25)
          {
            [v21 setNewerAtomicInstanceOncePersonalized:0];
            v23 = 1;
          }

          v26 = [v21 latestAtomicInstanceToVend];
          v27 = [SUCore stringIsEqual:v26 to:v6];

          if (v27)
          {
            [v21 setLatestAtomicInstanceToVend:0];
            [v21 setLatestAtomicInstanceToVendFromPreSUStaging:0];
            v10 = v31;
            [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:v31 forSetConfiguration:v21 removingAtomicInstance:v6];
          }

          else
          {
            v10 = v31;
            if ((([(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:v31 forSetConfiguration:v21 removingAtomicInstance:v6]| v23) & 1) == 0)
            {
              goto LABEL_16;
            }
          }

          v28 = [[NSString alloc] initWithFormat:@"cleared UUID[%@] (removed across all atomic-instances)", v6];
          [(MADAutoAssetControlManager *)self setConfigurationPersist:v21 fromLocation:v10 forReason:v28 dueToAlter:0 forHistoryOperation:9999];
        }

LABEL_16:

        objc_autoreleasePoolPop(v19);
        v17 = v17 + 1;
      }

      while (v15 != v17);
      v15 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
      if (!v15)
      {
LABEL_18:

        v7 = v29;
        break;
      }
    }
  }
}

- (void)setConfigurationEliminate:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v47 = v8;
  v13 = [[NSString alloc] initWithFormat:@"%@:setConfigurationEliminate", v8];
  v48 = v9;
  v49 = objc_alloc_init(NSMutableArray);
  v14 = v9;
  v46 = v10;
  v15 = v13;
  [(MADAutoAssetControlManager *)self removeSetTargetsForClientDomain:v14 forSetIdentifier:v10 fromLocation:v13];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v13 ofContainer:@"knownSetConfigurationsByIdentifier"];
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  v16 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v17 = [v16 allKeys];
  v18 = [v17 copy];

  obj = v18;
  v19 = [v18 countByEnumeratingWithState:&v58 objects:v67 count:16];
  v53 = v15;
  if (v19)
  {
    v20 = v19;
    v21 = *v59;
    do
    {
      for (i = 0; i != v20; i = i + 1)
      {
        if (*v59 != v21)
        {
          objc_enumerationMutation(obj);
        }

        v23 = *(*(&v58 + 1) + 8 * i);
        v24 = objc_autoreleasePoolPush();
        v25 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v26 = [v25 safeObjectForKey:v23 ofClass:objc_opt_class()];

        if (v23)
        {
          v27 = v26 == 0;
        }

        else
        {
          v27 = 1;
        }

        if (!v27)
        {
          v28 = [v26 clientDomainName];
          if ([SUCore stringIsEqual:v48 to:v28])
          {
            v29 = [v26 assetSetIdentifier];
            v30 = [SUCore stringIsEqual:v46 to:v29];

            if (!v30)
            {
              goto LABEL_15;
            }

            [v49 addObject:v23];
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              v31 = [v26 summary];
              *buf = 138543618;
              v64 = v53;
              v65 = 2114;
              v66 = v31;
              _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@:} eliminating | nextSetConfiguration:%{public}@", buf, 0x16u);
            }
          }
        }

LABEL_15:

        objc_autoreleasePoolPop(v24);
      }

      v20 = [obj countByEnumeratingWithState:&v58 objects:v67 count:16];
    }

    while (v20);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v50 = v49;
  v32 = [v50 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v32)
  {
    v33 = v32;
    obja = *v55;
    do
    {
      for (j = 0; j != v33; j = j + 1)
      {
        if (*v55 != obja)
        {
          objc_enumerationMutation(v50);
        }

        v35 = *(*(&v54 + 1) + 8 * j);
        v36 = objc_autoreleasePoolPush();
        v37 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v38 = [v37 safeObjectForKey:v35 ofClass:objc_opt_class()];

        if (v38)
        {
          v39 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v38];
          v40 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v41 = [v40 persistedEntry:v39 fromLocation:v53];

          if (v41)
          {
            v42 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            [v42 removePersistedEntry:v39 fromLocation:v47];

            [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationRemoved:v53 removedPersistedEntryID:v39 removedSetConfiguration:v38 message:@"eliminated by client"];
          }

          else
          {
            v43 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
            {
              v44 = [v38 summary];
              *buf = 138543618;
              v64 = v53;
              v65 = 2114;
              v66 = v44;
              _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} unable to load persisted-set-configuration file | nextRemoveSetConfiguration:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v36);
        if (v35)
        {
          v45 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
          [v45 removeObjectForKey:v35];
        }
      }

      v33 = [v50 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v33);
  }
}

- (id)setConfigurationCopy:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v28 = v4;
  v7 = [[NSString alloc] initWithFormat:@"%@:setConfigurationEliminate", v4];
  v8 = objc_alloc_init(NSMutableArray);
  v30 = v7;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v7 ofContainer:@"knownSetConfigurationsByIdentifier"];
  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  v9 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v10 = [v9 allKeys];
  v11 = [v10 copy];

  v12 = v11;
  v13 = [v11 countByEnumeratingWithState:&v31 objects:v39 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v32;
    v29 = *v32;
    do
    {
      for (i = 0; i != v14; i = i + 1)
      {
        if (*v32 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v31 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [v19 safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v20)
        {
          v21 = [v20 copy];
          if (v21)
          {
            [v8 addObject:v21];
          }

          else
          {
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
            {
              [v20 summary];
              v23 = self;
              v24 = v12;
              v26 = v25 = v8;
              *buf = 138543618;
              v36 = v30;
              v37 = 2114;
              v38 = v26;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "\n[SET-CONFIGURATION]{%{public}@} unable to copy set-configuration | nextSetConfiguration:%{public}@", buf, 0x16u);

              v8 = v25;
              v12 = v24;
              self = v23;
              v15 = v29;
            }
          }
        }

        else
        {
          v21 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v36 = v30;
            v37 = 2114;
            v38 = v17;
            _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[SET-CONFIGURATION]{%{public}@} unable to load set-configuration | setConfigurationKey:%{public}@", buf, 0x16u);
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      v14 = [v12 countByEnumeratingWithState:&v31 objects:v39 count:16];
    }

    while (v14);
  }

  return v8;
}

- (void)setConfigurationsPrePersonalizedJustCommitted:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = objc_alloc_init(NSMutableDictionary);
  v37 = v4;
  v38 = [[NSString alloc] initWithFormat:@"%@:setConfigurationsPrePersonalizedJustCommitted", v4];
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v8 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v9 = [v8 countByEnumeratingWithState:&v44 objects:v53 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v45;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v45 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v44 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        v15 = [(MADAutoAssetControlManager *)self locateSetDescriptorForSelector:v13];
        v16 = v15;
        if (v15)
        {
          v17 = [v15 latestDownloadedAtomicInstance];
          v18 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v17];

          if (v18)
          {
            v19 = [v18 atomicInstanceUUID];
            [v7 setSafeObject:v18 forKey:v19];
          }
        }

        objc_autoreleasePoolPop(v14);
      }

      v10 = [v8 countByEnumeratingWithState:&v44 objects:v53 count:16];
    }

    while (v10);
  }

  v42 = 0u;
  v43 = 0u;
  v40 = 0u;
  v41 = 0u;
  v20 = v7;
  v21 = [v20 countByEnumeratingWithState:&v40 objects:v52 count:16];
  v22 = v38;
  if (v21)
  {
    v23 = v21;
    v39 = *v41;
    do
    {
      for (j = 0; j != v23; j = j + 1)
      {
        if (*v41 != v39)
        {
          objc_enumerationMutation(v20);
        }

        v25 = *(*(&v40 + 1) + 8 * j);
        v26 = objc_autoreleasePoolPush();
        v27 = [v20 safeObjectForKey:v25 ofClass:objc_opt_class()];
        v28 = v27;
        if (v27)
        {
          v29 = [v27 clientDomainName];
          v30 = [v28 assetSetIdentifier];
          v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v29 forAssetSetIdentifier:v30];

          v32 = [v28 atomicInstanceUUID];
          v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v22 forAtomicInstanceUUID:v32 requireExists:0];

          if (v31)
          {
            v34 = v33 == 0;
          }

          else
          {
            v34 = 1;
          }

          if (!v34)
          {
            [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v22 fromSetDescriptor:v33 toSetConfiguration:v31 fromPreSUStaging:[(MADAutoAssetControlManager *)self isAtomicInstancePartOfPSUS:v28] allowEmpty:0];
            v35 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
            {
              v36 = [v33 summary];
              *buf = 138543618;
              v49 = v38;
              v50 = 2114;
              v51 = v36;
              _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SECURE-COMMITTED-LATEST-TO-VEND] just committed all pre-personalized secure | setDescriptor:%{public}@", buf, 0x16u);

              v22 = v38;
            }
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v23 = [v20 countByEnumeratingWithState:&v40 objects:v52 count:16];
    }

    while (v23);
  }
}

- (BOOL)isAtomicInstancePartOfPSUS:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4 && ([v4 creationReason], v7 = objc_claimAutoreleasedReturnValue(), v7, v7))
  {
    v8 = [v4 creationReason];
    if (([SUCore stringIsEqual:v8 to:@"STAGED_LOOKUP_NEWOS_PROMOTE"]& 1) != 0)
    {
      v9 = 1;
    }

    else
    {
      v10 = [v4 creationReason];
      if (([SUCore stringIsEqual:v10 to:@"FROM_STAGED_PROMOTED_LOOKUP"]& 1) != 0)
      {
        v9 = 1;
      }

      else
      {
        v11 = [v4 creationReason];
        v9 = [SUCore stringIsEqual:v11 to:@"PSUS_NEEDS_PERSONALIZATION"];
      }
    }
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)doesSetConfiguration:(id)a3 coverAssetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  obj = [v6 autoAssetEntries];
  v10 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = v6;
    v12 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v14 = 0;
      v29 = v11;
      do
      {
        if (*v33 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        v17 = [v15 assetSelector];
        v18 = [v17 assetType];
        v19 = [v7 assetType];
        if ([v16 stringIsEqual:v18 to:v19])
        {
          v31 = p_weak_ivar_lyt[223];
          v20 = [v15 assetSelector];
          v21 = [v20 assetSpecifier];
          [v7 assetSpecifier];
          v22 = p_weak_ivar_lyt;
          v23 = v7;
          v25 = v24 = v12;
          LOBYTE(v31) = [v31 stringIsEqual:v21 to:v25];

          v12 = v24;
          v7 = v23;
          p_weak_ivar_lyt = v22;

          v11 = v29;
          if (v31)
          {
            v26 = 1;
            goto LABEL_13;
          }
        }

        else
        {
        }

        v14 = v14 + 1;
      }

      while (v11 != v14);
      v11 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v11);
    v26 = 0;
LABEL_13:
    v6 = v28;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (BOOL)_isSetDescriptorAvailableToClient:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  v10 = [v7 latestDowloadedAtomicInstanceEntries];
  v11 = [v10 countByEnumeratingWithState:&v23 objects:v31 count:16];
  if (v11)
  {
    v12 = v11;
    v22 = v7;
    v13 = *v24;
    while (2)
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v24 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v23 + 1) + 8 * i);
        v16 = [v15 fullAssetSelector];
        v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v16];

        if (!v17)
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v20 = [v15 summary];
            *buf = 138543618;
            v28 = v6;
            v29 = 2114;
            v30 = v20;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_isSetDescriptorAvailableToClient} unable to locate asset-descriptor | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

LABEL_15:
          v18 = 0;
          goto LABEL_16;
        }

        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v17]&& [MADAutoAssetSecure isPersonalizationOrGraftingRequired:v6 forDescriptor:v17])
        {
          goto LABEL_15;
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v23 objects:v31 count:16];
      if (v12)
      {
        continue;
      }

      break;
    }

    v18 = 1;
LABEL_16:
    v7 = v22;
  }

  else
  {
    v18 = 1;
  }

  return v18;
}

- (BOOL)_doesSetDescriptorRequirePersonalization:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  v10 = [v7 latestDowloadedAtomicInstanceEntries];
  v11 = [v10 countByEnumeratingWithState:&v23 objects:v31 count:16];
  if (v11)
  {
    v12 = v11;
    v22 = v7;
    v13 = *v24;
    while (2)
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v24 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v23 + 1) + 8 * i);
        v16 = [v15 fullAssetSelector];
        v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v16];

        if (!v17)
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v20 = [v15 summary];
            *buf = 138543618;
            v28 = v6;
            v29 = 2114;
            v30 = v20;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_doesSetDescriptorRequirePersonalization} unable to locate asset-descriptor | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

LABEL_15:
          v18 = 1;
          goto LABEL_16;
        }

        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v17]&& [MADAutoAssetSecure isPersonalizationRequired:v6 forDescriptor:v17])
        {
          goto LABEL_15;
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v23 objects:v31 count:16];
      if (v12)
      {
        continue;
      }

      break;
    }

    v18 = 0;
LABEL_16:
    v7 = v22;
  }

  else
  {
    v18 = 0;
  }

  return v18;
}

- (BOOL)_doesSetDescriptorDownloadedMatchLatestToVend:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v7 clientDomainName];
  v11 = [v7 assetSetIdentifier];
  v12 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v10 forAssetSetIdentifier:v11];

  if (v12 && ([v12 latestAtomicInstanceToVend], v13 = objc_claimAutoreleasedReturnValue(), v13, v13))
  {
    v14 = [v12 latestAtomicInstanceToVend];
    v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v6 forAtomicInstanceUUID:v14 requireExists:1];

    if (v15)
    {
      v16 = [(MADAutoAssetControlManager *)self doesSetJobDescriptor:v15 representSameContentAs:v7];
    }

    else
    {
      v16 = 0;
    }
  }

  else
  {
    v16 = 0;
  }

  return v16;
}

- (BOOL)_isDownloadedDescriptorPartOfLatestToVend:(id)a3 fromLocation:(id)a4
{
  v53 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v49 = v6;
  v9 = [[NSString alloc] initWithFormat:@"%@:_isDownloadedDescriptorPartOfLatestToVend", v6];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v9 ofContainer:@"knownSetConfigurationsByIdentifier"];
  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  v10 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v11 = [v10 allKeys];
  v12 = [v11 copy];

  v13 = [v12 countByEnumeratingWithState:&v62 objects:v67 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v63;
    v43 = *v63;
    v44 = self;
    v47 = v12;
    v48 = v9;
    while (1)
    {
      v16 = 0;
      v45 = v14;
      do
      {
        if (*v63 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v62 + 1) + 8 * v16);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [v19 safeObjectForKey:v17 ofClass:objc_opt_class()];

        v21 = v20;
        if (!v20)
        {
          goto LABEL_24;
        }

        v52 = v20;
        v22 = [v20 latestAtomicInstanceToVend];

        v21 = v52;
        if (!v22)
        {
          goto LABEL_24;
        }

        v23 = [v52 latestAtomicInstanceToVend];
        v24 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v9 forAtomicInstanceUUID:v23 requireExists:1];

        if (!v24)
        {
          goto LABEL_23;
        }

        v50 = v24;
        context = v18;
        v46 = v16;
        v60 = 0u;
        v61 = 0u;
        v58 = 0u;
        v59 = 0u;
        obj = [v24 latestDowloadedAtomicInstanceEntries];
        v25 = v53;
        p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
        v57 = [obj countByEnumeratingWithState:&v58 objects:v66 count:16];
        if (!v57)
        {
          goto LABEL_22;
        }

        v27 = *v59;
        v54 = *v59;
        do
        {
          for (i = 0; i != v57; i = i + 1)
          {
            if (*v59 != v27)
            {
              objc_enumerationMutation(obj);
            }

            v29 = *(*(&v58 + 1) + 8 * i);
            v30 = p_weak_ivar_lyt[223];
            v31 = [v29 fullAssetSelector];
            v32 = [v31 assetType];
            v33 = [v25 assetType];
            if (![v30 stringIsEqual:v32 to:v33])
            {
              goto LABEL_19;
            }

            v34 = p_weak_ivar_lyt[223];
            v56 = [v29 fullAssetSelector];
            v35 = [v56 assetSpecifier];
            v36 = [v25 assetSpecifier];
            if (![v34 stringIsEqual:v35 to:v36])
            {

              v27 = v54;
LABEL_19:

              continue;
            }

            v37 = p_weak_ivar_lyt[223];
            v38 = [v29 fullAssetSelector];
            v39 = [v38 assetVersion];
            v40 = [v25 assetVersion];
            LOBYTE(v37) = [v37 stringIsEqual:v39 to:v40];

            v25 = v53;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

            v27 = v54;
            if (v37)
            {

              objc_autoreleasePoolPop(context);
              v41 = 1;
              v12 = v47;
              v9 = v48;
              goto LABEL_28;
            }
          }

          v57 = [obj countByEnumeratingWithState:&v58 objects:v66 count:16];
        }

        while (v57);
LABEL_22:

        v15 = v43;
        self = v44;
        v12 = v47;
        v9 = v48;
        v14 = v45;
        v16 = v46;
        v24 = v50;
        v18 = context;
LABEL_23:

        v21 = v52;
LABEL_24:

        objc_autoreleasePoolPop(v18);
        v16 = v16 + 1;
      }

      while (v16 != v14);
      v14 = [v12 countByEnumeratingWithState:&v62 objects:v67 count:16];
      v41 = 0;
      if (!v14)
      {
        goto LABEL_28;
      }
    }
  }

  v41 = 0;
LABEL_28:

  return v41;
}

- (BOOL)_isDownloadedSetDescriptorLatestToVend:(id)a3 fromLocation:(id)a4
{
  v28 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSString alloc] initWithFormat:@"%@:_isDownloadedSetDescriptorLatestToVend", v6];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v9 ofContainer:@"knownSetConfigurationsByIdentifier"];
  v31 = 0u;
  v32 = 0u;
  v29 = 0u;
  v30 = 0u;
  v10 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v11 = [v10 allKeys];
  v12 = [v11 copy];

  obj = v12;
  v13 = [v12 countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v13)
  {
    v14 = v13;
    v26 = v9;
    v15 = *v30;
    while (2)
    {
      for (i = 0; i != v14; i = i + 1)
      {
        if (*v30 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v29 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [v19 safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v20)
        {
          v21 = [v20 latestAtomicInstanceToVend];
          v22 = [v28 latestDownloadedAtomicInstance];
          v23 = [SUCore stringIsEqual:v21 to:v22];

          if (v23)
          {

            objc_autoreleasePoolPop(v18);
            v24 = 1;
            goto LABEL_12;
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      v14 = [obj countByEnumeratingWithState:&v29 objects:v33 count:16];
      if (v14)
      {
        continue;
      }

      break;
    }

    v24 = 0;
LABEL_12:
    v9 = v26;
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (void)_clearAtomicInstanceFromAllSetConfigurations:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v27 = v7;
  v10 = [[NSString alloc] initWithFormat:@"%@:_clearAtomicInstanceFromAllSetConfigurations", v7];
  v31 = v6;
  v11 = [v6 atomicInstanceUUID];
  v28 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v10 forAtomicInstanceUUID:v11 requireExists:0];

  v30 = v10;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"knownSetConfigurationsByIdentifier"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  v12 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v13 = [v12 allKeys];
  v14 = [v13 copy];

  obj = v14;
  v15 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v33;
    while (2)
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v33 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v19 = *(*(&v32 + 1) + 8 * i);
        v20 = objc_autoreleasePoolPush();
        v21 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v22 = [v21 safeObjectForKey:v19 ofClass:objc_opt_class()];

        if (v22)
        {
          v23 = [v22 latestAtomicInstanceToVend];
          v24 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v30 forAtomicInstanceUUID:v23 requireExists:0];

          v25 = [v22 latestAtomicInstanceToVend];
          v26 = [v31 atomicInstanceUUID];
          LODWORD(v23) = [SUCore stringIsEqual:v25 to:v26];

          if (v23)
          {
            [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromSetConfiguration:v22 forSetDesriptor:v24 forSetAtomicInstance:v31 fromLocation:v30];
            if (v28)
            {
              [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:v27 setDescriptor:v28 allowRemovalWithoutNewerDescriptor:0];
            }

            objc_autoreleasePoolPop(v20);
            goto LABEL_15;
          }
        }

        objc_autoreleasePoolPop(v20);
      }

      v16 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
      if (v16)
      {
        continue;
      }

      break;
    }
  }

LABEL_15:
}

- (void)_clearAtomicInstanceFromSetConfiguration:(id)a3 forSetDesriptor:(id)a4 forSetAtomicInstance:(id)a5 fromLocation:(id)a6
{
  v10 = a3;
  v11 = a4;
  v44 = a5;
  v12 = a6;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = self;
  v16 = [[NSString alloc] initWithFormat:@"%@:_clearAtomicInstanceFromSetConfiguration", v12];
  if (v10 && ([v10 latestAtomicInstanceToVend], v17 = objc_claimAutoreleasedReturnValue(), v17, v17) && (objc_msgSend(v10, "latestAtomicInstanceToVend"), v18 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetAtomicInstanceByInstanceUUID:](self, "locateSetAtomicInstanceByInstanceUUID:", v18), v19 = objc_claimAutoreleasedReturnValue(), v18, v19))
  {
    if ([(MADAutoAssetControlManager *)v15 atomicInstanceIsCurrentlyLocked:v19])
    {
      v20 = @"Y";
    }

    else
    {
      v20 = @"N";
    }

    [(MADAutoAssetControlManager *)v15 setConfigurationTrackLatestToVend:v12 forSetConfiguration:v10 becomingLatestToVend:0 historyOperation:442 fromPreSUStaging:0];
  }

  else
  {
    v21 = [v10 previouslyVendedLockedAtomicInstances];

    if (v21)
    {
      v41 = v16;
      v42 = v12;
      v22 = v15;
      v43 = v11;
      v47 = 0u;
      v48 = 0u;
      v45 = 0u;
      v46 = 0u;
      v23 = [v10 previouslyVendedLockedAtomicInstances];
      v24 = [v23 copy];

      v25 = [v24 countByEnumeratingWithState:&v45 objects:v57 count:16];
      if (v25)
      {
        v26 = v25;
        v27 = *v46;
        while (2)
        {
          for (i = 0; i != v26; i = i + 1)
          {
            if (*v46 != v27)
            {
              objc_enumerationMutation(v24);
            }

            v29 = *(*(&v45 + 1) + 8 * i);
            v30 = objc_autoreleasePoolPush();
            v31 = [v44 atomicInstanceUUID];
            v32 = [SUCore stringIsEqual:v29 to:v31];

            if (v32)
            {
              v33 = [(MADAutoAssetControlManager *)v22 locateSetAtomicInstanceByInstanceUUID:v29];
              if (v33)
              {
                v19 = v33;
                objc_autoreleasePoolPop(v30);

                v36 = [v19 atomicInstanceUUID];
                v15 = v22;
                v37 = v22;
                v16 = v41;
                [(MADAutoAssetControlManager *)v37 setConfigurationForgetIfTrackedAsPreviouslyVended:v41 forSetConfiguration:v10 removingAtomicInstance:v36];

                v20 = @"N";
                v12 = v42;
                v11 = v43;
                goto LABEL_24;
              }
            }

            objc_autoreleasePoolPop(v30);
          }

          v26 = [v24 countByEnumeratingWithState:&v45 objects:v57 count:16];
          if (v26)
          {
            continue;
          }

          break;
        }
      }

      v11 = v43;
      v15 = v22;
      v16 = v41;
      v12 = v42;
    }

    v34 = [v10 newerAtomicInstanceOncePersonalized];

    if (!v34 || ([v10 newerAtomicInstanceOncePersonalized], v35 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetAtomicInstanceByInstanceUUID:](v15, "locateSetAtomicInstanceByInstanceUUID:", v35), v19 = objc_claimAutoreleasedReturnValue(), v35, !v19))
    {
      v20 = @"N";
      goto LABEL_25;
    }

    [v10 setNewerAtomicInstanceOncePersonalized:0];
    v20 = @"N";
  }

LABEL_24:

LABEL_25:
  [(MADAutoAssetControlManager *)v15 atomicInstanceUpdateUsageStatus:v16 toNewStatus:@"FORGOTTEN" forAtomicInstance:v44];
  v38 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    v39 = [(MADAutoAssetControlManager *)v15 _updateLatestSummary];
    v40 = [v10 summary];
    *buf = 138544130;
    v50 = v39;
    v51 = 2114;
    v52 = v16;
    v53 = 2114;
    v54 = v20;
    v55 = 2114;
    v56 = v40;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[CLEARER-LATEST-TO-VEND] clearing set-configuration latestAtomicInstanceToVend | hadBeenLatestIsLocked:%{public}@ | setConfiguration:%{public}@", buf, 0x2Au);
  }
}

- (BOOL)setTargetPersistedMatchesClientSpecified:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v8 = [v7 persistedEntryIDs:@"setTargetPersistedMatchesClientSpecified"];

  if (![v8 count])
  {
    LOBYTE(v9) = 0;
    goto LABEL_49;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setTargetPersistedMatchesClientSpecified" ofContainer:@"persistedSetTargets"];
  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  obj = v8;
  v48 = [obj countByEnumeratingWithState:&v65 objects:v72 count:16];
  if (!v48)
  {
    LOBYTE(v9) = 1;
    goto LABEL_48;
  }

  v49 = v8;
  v50 = *v66;
  LODWORD(v9) = 1;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v57 = self;
  v55 = v4;
  while (2)
  {
    v47 = v9;
    v11 = 0;
    do
    {
      if (*v66 != v50)
      {
        objc_enumerationMutation(obj);
      }

      v51 = v11;
      v12 = *(*(&v65 + 1) + 8 * v11);
      v13 = objc_autoreleasePoolPush();
      v14 = [(MADAutoAssetControlManager *)self persistedSetTargets];
      v15 = [v14 persistedEntry:v12 fromLocation:@"setTargetPersistedMatchesClientSpecified"];

      if (v12)
      {
        v16 = v15 == 0;
      }

      else
      {
        v16 = 1;
      }

      if (v16)
      {
        v18 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
        {
          v45 = @"N";
          if (v12)
          {
            v45 = v12;
          }

          *buf = 138543362;
          v71 = v45;
          _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | unable to load persisted set-target | entryID:%{public}@", buf, 0xCu);
        }

        LOBYTE(v9) = 0;
LABEL_46:

        objc_autoreleasePoolPop(v13);
        goto LABEL_48;
      }

      v17 = [(MADAutoAssetControlManager *)self persistedSetTargets];
      v18 = [v17 decodeFromLocation:@"setTargetPersistedMatchesClientSpecified" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v18)
      {
        v46 = _MADLog(@"AutoControl");
        v58 = v46;
        if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v71 = v12;
          _os_log_impl(&dword_0, v46, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | unable to decode persisted set-target | entryID:%{public}@", buf, 0xCu);
        }

        LOBYTE(v9) = 0;
LABEL_45:

        goto LABEL_46;
      }

      v53 = v15;
      v54 = v13;
      v63 = 0u;
      v64 = 0u;
      v61 = 0u;
      v62 = 0u;
      v19 = [v4 entriesWhenTargeting];
      v60 = [v19 countByEnumeratingWithState:&v61 objects:v69 count:16];
      if (v60)
      {
        v56 = 0;
        v58 = v19;
        v59 = *v62;
        while (2)
        {
          for (i = 0; i != v60; i = i + 1)
          {
            if (*v62 != v59)
            {
              objc_enumerationMutation(v58);
            }

            v21 = *(*(&v61 + 1) + 8 * i);
            if (!v21)
            {
              v9 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
              {
                v43 = [v4 summary];
                *buf = 138543362;
                v71 = v43;
                _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | nil entry provided by client - treating as same set-target to preserve persisted | setInfoInstance:%{public}@", buf, 0xCu);
              }

              v8 = v49;
              v15 = v53;
              v13 = v54;
              LOBYTE(v9) = v47;
              goto LABEL_45;
            }

            v22 = p_weak_ivar_lyt[223];
            v23 = [v18 clientDomainName];
            v24 = [v4 clientDomainName];
            if ([v22 stringIsEqual:v23 to:v24])
            {
              v25 = p_weak_ivar_lyt[223];
              v26 = [v18 assetSetIdentifier];
              v27 = [v4 assetSetIdentifier];
              LODWORD(v25) = [v25 stringIsEqual:v26 to:v27];

              if (v25)
              {
                v28 = p_weak_ivar_lyt[223];
                v29 = [v18 minTargetOSVersion];
                v30 = [v21 minTargetOSVersion];
                if (([v28 stringIsEqual:v29 to:v30] & 1) == 0)
                {

                  v47 = 0;
                  v8 = v49;
                  v42 = v53;
                  v41 = v54;
                  self = v57;
LABEL_35:
                  v40 = 1;
                  goto LABEL_37;
                }

                v31 = p_weak_ivar_lyt[223];
                v32 = [v18 maxTargetOSVersion];
                v33 = [v21 maxTargetOSVersion];
                if (![v31 stringIsEqual:v32 to:v33])
                {
                  v34 = v18;

                  v47 = 0;
                  v38 = 1;
LABEL_32:
                  v39 = v58;
                  goto LABEL_33;
                }

                v34 = v18;
                v35 = [v18 autoAssetEntries];
                v36 = [v21 autoAssetEntries];
                v37 = [(MADAutoAssetControlManager *)v57 setTargetEntries:v35 match:v36];

                v38 = 1;
                if (!v37)
                {
                  v47 = 0;
                  goto LABEL_32;
                }

                v56 = 1;
                v4 = v55;
                p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              }
            }

            else
            {
            }
          }

          v39 = v58;
          v60 = [v58 countByEnumeratingWithState:&v61 objects:v69 count:16];
          if (v60)
          {
            continue;
          }

          break;
        }

        v34 = v18;
        v38 = v56;
LABEL_33:

        v8 = v49;
        v42 = v53;
        v41 = v54;
        self = v57;
        if (v38)
        {
          v4 = v55;
          v18 = v34;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          goto LABEL_35;
        }

        v40 = 0;
        v4 = v55;
        v18 = v34;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      }

      else
      {

        v40 = 0;
        v8 = v49;
        v42 = v15;
        v41 = v54;
        self = v57;
      }

LABEL_37:

      objc_autoreleasePoolPop(v41);
      if (!v40)
      {
        LOBYTE(v9) = 0;
        goto LABEL_48;
      }

      v11 = v51 + 1;
    }

    while ((v51 + 1) != v48);
    LODWORD(v9) = v47;
    v48 = [obj countByEnumeratingWithState:&v65 objects:v72 count:16];
    if (v48)
    {
      continue;
    }

    break;
  }

LABEL_48:

LABEL_49:
  return v9 & 1;
}

- (BOOL)setTargetEntries:(id)a3 match:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = [v5 count];
  v30 = v6;
  if (v7 != [v6 count])
  {
    v24 = 0;
    goto LABEL_26;
  }

  v42 = 0u;
  v43 = 0u;
  v40 = 0u;
  v41 = 0u;
  obj = v5;
  v28 = [obj countByEnumeratingWithState:&v40 objects:v45 count:16];
  if (!v28)
  {
    v24 = 1;
    goto LABEL_25;
  }

  v29 = *v41;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v26 = v5;
  while (2)
  {
    v9 = 0;
    while (2)
    {
      if (*v41 != v29)
      {
        objc_enumerationMutation(obj);
      }

      v31 = v9;
      v10 = *(*(&v40 + 1) + 8 * v9);
      v36 = 0u;
      v37 = 0u;
      v38 = 0u;
      v39 = 0u;
      v33 = v30;
      v35 = [v33 countByEnumeratingWithState:&v36 objects:v44 count:16];
      if (!v35)
      {
LABEL_23:

        v24 = 0;
        v5 = v26;
        goto LABEL_25;
      }

      v11 = *v37;
      v32 = v10;
LABEL_9:
      v12 = 0;
      while (1)
      {
        if (*v37 != v11)
        {
          objc_enumerationMutation(v33);
        }

        v13 = *(*(&v36 + 1) + 8 * v12);
        v14 = p_weak_ivar_lyt[223];
        v15 = [v10 assetSelector];
        v16 = [v15 assetType];
        v17 = [v13 assetSelector];
        v18 = [v17 assetType];
        if (![v14 stringIsEqual:v16 to:v18])
        {

          goto LABEL_16;
        }

        v34 = p_weak_ivar_lyt[223];
        v19 = [v10 assetSelector];
        v20 = [v19 assetSpecifier];
        v21 = [v13 assetSelector];
        [v21 assetSpecifier];
        v23 = v22 = v11;
        LOBYTE(v34) = [v34 stringIsEqual:v20 to:v23];

        v11 = v22;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        v10 = v32;
        if (v34)
        {
          break;
        }

LABEL_16:
        if (v35 == ++v12)
        {
          v35 = [v33 countByEnumeratingWithState:&v36 objects:v44 count:16];
          if (v35)
          {
            goto LABEL_9;
          }

          goto LABEL_23;
        }
      }

      v9 = v31 + 1;
      if ((v31 + 1) != v28)
      {
        continue;
      }

      break;
    }

    v24 = 1;
    v5 = v26;
    v28 = [obj countByEnumeratingWithState:&v40 objects:v45 count:16];
    if (v28)
    {
      continue;
    }

    break;
  }

LABEL_25:

LABEL_26:
  return v24;
}

- (void)atomicInstanceLoadedFromPersisted:(id)a3 persistedEntryID:(id)a4
{
  v19 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v10 = [v19 atomicInstanceUUID];
  v11 = [v9 safeObjectForKey:v10 ofClass:objc_opt_class()];

  if (v11)
  {
    v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v13 = [v12 diag];
    v14 = [NSString alloc];
    v15 = [v19 summary];
    v16 = [v14 initWithFormat:@"{atomicInstanceLoadedFromPersisted} already tracking setAtomicInstance:%@", v15];
    [v13 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6109 withError:0];
  }

  else
  {
    v17 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    v18 = [v19 atomicInstanceUUID];
    [v17 setSafeObject:v19 forKey:v18];

    [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstance:@"atomicInstanceLoadedFromPersisted" operation:@"ENTRY_LOAD" forPersistedEntryID:v6 withSetAtomicInstance:v19 message:@"set-atomic-instance validated"];
  }
}

- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 forSetInfoInstance:(id)a6 asSubAtomicFrom:(id)a7
{
  v12 = a7;
  v13 = a6;
  v14 = a4;
  v15 = a3;
  v16 = [v13 clientDomainName];
  v17 = [v13 autoAssetSetClientName];
  v18 = [v13 assetSetIdentifier];
  v19 = [v13 autoAssetEntries];

  v20 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:v15 forCreationReason:v14 recordingHistoryOperation:a5 forClientDomainName:v16 forSetClientName:v17 forAssetSetIdentifier:v18 representingInstanceEntries:v19 recoveringAtomicInstanceUUID:0 asSubAtomicFrom:v12];

  return v20;
}

- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 recoveringForSetDescriptor:(id)a6 usingAsSetClient:(id)a7
{
  v33 = a3;
  v32 = a4;
  v10 = a6;
  v29 = a7;
  v35 = objc_alloc_init(NSMutableArray);
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  v31 = v10;
  obj = [v10 latestDowloadedAtomicInstanceEntries];
  v11 = [obj countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (v11)
  {
    v12 = v11;
    v36 = *v38;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v38 != v36)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v37 + 1) + 8 * i);
        v15 = [MANAutoAssetSetEntry alloc];
        v16 = [v14 fullAssetSelector];
        v17 = [v16 assetType];
        v18 = [v14 fullAssetSelector];
        v19 = [v18 assetSpecifier];
        v20 = [v14 fullAssetSelector];
        v21 = [v20 downloadDecryptionKey];
        v22 = -[MANAutoAssetSetEntry initForAssetType:withAssetSpecifier:usingDecryptionKey:assetLockedInhibitsRemoval:](v15, "initForAssetType:withAssetSpecifier:usingDecryptionKey:assetLockedInhibitsRemoval:", v17, v19, v21, [v14 inhibitedFromEmergencyRemoval]);

        if (v22)
        {
          [v35 addObject:v22];
        }
      }

      v12 = [obj countByEnumeratingWithState:&v37 objects:v41 count:16];
    }

    while (v12);
  }

  v23 = [v31 clientDomainName];
  v24 = [v31 assetSetIdentifier];
  v25 = [v31 latestDownloadedAtomicInstance];
  v26 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:v33 forCreationReason:v32 recordingHistoryOperation:a5 forClientDomainName:v23 forSetClientName:v29 forAssetSetIdentifier:v24 representingInstanceEntries:v35 recoveringAtomicInstanceUUID:v25 asSubAtomicFrom:0];

  return v26;
}

- (id)atomicInstanceNewSetAtomicInstance:(id)a3 forCreationReason:(id)a4 recordingHistoryOperation:(int64_t)a5 forClientDomainName:(id)a6 forSetClientName:(id)a7 forAssetSetIdentifier:(id)a8 representingInstanceEntries:(id)a9 recoveringAtomicInstanceUUID:(id)a10 asSubAtomicFrom:(id)a11
{
  v60 = a3;
  v61 = a6;
  v62 = a8;
  v16 = a10;
  v17 = a11;
  v18 = a9;
  v19 = a7;
  v20 = a4;
  v21 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v22 = [v21 extendedStateQueue];
  dispatch_assert_queue_V2(v22);

  if (v16)
  {
    v23 = v16;
  }

  else
  {
    v24 = objc_alloc_init(NSUUID);
    v23 = [v24 UUIDString];
  }

  v25 = [MADAutoSetAtomicInstance alloc];
  v26 = objc_alloc_init(NSDate);
  v58 = self;
  v27 = v60;
  v28 = [(MADAutoSetAtomicInstance *)v25 initForClientDomainName:v61 forSetClientName:v19 forAssetSetIdentifier:v62 withAtomicInstanceUUID:v23 asSubAtomicFrom:v17 forCreationReason:v20 originallyCreatedOnDate:v26 withCreationIndex:[(MADAutoAssetControlManager *)self atomicInstanceNextCreationIndex:v60 forClientDomainName:v61 forAssetSetIdentifier:v62] representingInstanceEntries:v18 inUseBySetJob:0];

  if (!v28)
  {
    goto LABEL_21;
  }

  if (a5 == 226)
  {
    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      v30 = [v28 summary];
      *buf = 138543618;
      v64 = v60;
      v65 = 2114;
      v66 = v30;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} not persisting sub-atomic-instance of 0 entries | setAtomicInstance:%{public}@", buf, 0x16u);
    }

    goto LABEL_18;
  }

  v29 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v28];
  v31 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v32 = [v31 persistedEntry:v29 fromLocation:v60];

  if (v32)
  {
    [v32 persistSecureCodedObject:v28 forKey:@"setAtomicInstance"];
    v33 = [(MADAutoAssetControlManager *)v58 persistedKnownSetAtomicInstances];
    v34 = [v28 summary];
    [v33 storePersistedEntry:v29 withEntrySummary:v34 fromLocation:v60];

    v35 = [v28 instanceEntries];
    v36 = [v35 count];
    v37 = [(MADAutoAssetControlManager *)v58 _specifierVersionNamesForAtomicInstance:v28];
    [MADAutoAssetHistory recordOperation:a5 toHistoryType:2 fromLayer:1 usageCount:v36 forClientDomainName:v61 forAssetSetIdentifier:v62 forAtomicInstance:v23 withAddendumMessage:v37];

    v38 = [NSString alloc];
    v39 = [v28 subAtomicFromAtomicInstanceUUID];
    if (v39)
    {
      v40 = @"sub-";
    }

    else
    {
      v40 = &stru_4BD3F0;
    }

    v41 = [v28 summary];
    v57 = v40;
    v27 = v60;
    v42 = [v38 initWithFormat:@"new set %@atomic-instance added | setAtomicInstance:%@", v57, v41];
    [(MADAutoAssetControlManager *)v58 _logPersistedSetAtomicInstance:v60 operation:@"ENTRY_ADD" forPersistedEntryID:v29 withSetAtomicInstance:v28 message:v42];

    if (!+[MAAIRBEventReporter isAvailable])
    {
      goto LABEL_17;
    }

    v43 = [MAAIRBMobileAssetOperationMetadata alloc];
    v44 = [MADAutoAssetHistoryTracker operationName:a5];
    v45 = [(MAAIRBMobileAssetOperationMetadata *)v43 initWithCode:a5 name:v44];

    v46 = [MAAIRBMobileAssetAtomicInstance alloc];
    v47 = [[MAAIRBMobileAssetAssetSet alloc] initWithAssetSetIdentifier:v62];
    v48 = [(MAAIRBMobileAssetAtomicInstance *)v46 initWithAssetSet:v47 atomicInstanceId:v23];

    v49 = [v28 instanceEntries];
    v50 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v45, v48, [v49 count]);

    v51 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v50];
    [MAAIRBEventReporter emitAppleIntelligenceStartEvent:v51];

    v27 = v60;
  }

  else
  {
    v45 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
    {
      v52 = [v28 summary];
      *buf = 138543618;
      v64 = v60;
      v65 = 2114;
      v66 = v52;
      _os_log_impl(&dword_0, v45, OS_LOG_TYPE_ERROR, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} unable to load persisted-set-atomic-instance file | setAtomicInstance:%{public}@", buf, 0x16u);
    }
  }

LABEL_17:
  v53 = [(MADAutoAssetControlManager *)v58 knownSetAtomicInstancesByInstance];
  [v53 setSafeObject:v28 forKey:v23];

  [(MADAutoAssetControlManager *)v58 atomicInstanceTrimOverflowAfterPersisting:v28];
LABEL_18:

  v54 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v54, OS_LOG_TYPE_DEFAULT))
  {
    v55 = [v28 summary];
    *buf = 138543618;
    v64 = v27;
    v65 = 2114;
    v66 = v55;
    _os_log_impl(&dword_0, v54, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} created | setAtomicInstance:%{public}@", buf, 0x16u);
  }

LABEL_21:

  return v28;
}

- (void)atomicInstanceUpdateUsageStatus:(id)a3 toNewStatus:(id)a4 forAtomicInstance:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = v10;
  if (v10)
  {
    v12 = [v10 usageStatus];
    v13 = [SUCore stringIsEqual:v12 to:v9];

    if ((v13 & 1) == 0)
    {
      v14 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v11];
      v15 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [v15 persistedEntry:v14 fromLocation:v8];

      if (v16)
      {
        [v11 setUsageStatus:v9];
        [v16 persistSecureCodedObject:v11 forKey:@"setAtomicInstance"];
        v17 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v18 = [v11 summary];
        [v17 storePersistedEntry:v14 withEntrySummary:v18 fromLocation:v8];

        v19 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v20 = [v11 atomicInstanceUUID];
        [v19 setSafeObject:v11 forKey:v20];

        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          v22 = [v11 summary];
          v26 = 138543618;
          v27 = v8;
          v28 = 2114;
          v29 = v22;
          v23 = "\n[ATOMIC-INSTANCE] {%{public}@} updated usage-status | setAtomicInstance:%{public}@";
          v24 = v21;
          v25 = OS_LOG_TYPE_DEFAULT;
LABEL_8:
          _os_log_impl(&dword_0, v24, v25, v23, &v26, 0x16u);
        }
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          v22 = [v11 summary];
          v26 = 138543618;
          v27 = v8;
          v28 = 2114;
          v29 = v22;
          v23 = "\n[ATOMIC-INSTANCE] {%{public}@} unable to update atomic-instance usage-status - failed to load persisted-set-atomic-instance file | setAtomicInstance:%{public}@";
          v24 = v21;
          v25 = OS_LOG_TYPE_ERROR;
          goto LABEL_8;
        }
      }
    }
  }
}

- (id)atomicInstanceUUIDForNewSetJob:(id)a3 forReason:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 atomicInstance];

  if (!v10 || (-[MADAutoAssetControlManager knownSetAtomicInstancesByInstance](self, "knownSetAtomicInstancesByInstance"), v11 = objc_claimAutoreleasedReturnValue(), [v6 atomicInstance], v12 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v11, "safeObjectForKey:ofClass:", v12, objc_opt_class()), v13 = objc_claimAutoreleasedReturnValue(), v12, v11, !v13))
  {
    v14 = [[NSString alloc] initWithFormat:@"atomicInstanceUUIDForNewSetJob(%@)", v7];
    v13 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:v14 forCreationReason:@"FROM_CLIENT_IN_FLIGHT" recordingHistoryOperation:225 forSetInfoInstance:v6 asSubAtomicFrom:0];

    v15 = [v6 clientDomainName];
    v16 = [v6 assetSetIdentifier];
    v17 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v15 forAssetSetIdentifier:v16];

    if (v17)
    {
      v18 = [v13 atomicInstanceUUID];
      [v17 setDiscoveredInFlightAtomicInstance:v18];

      [(MADAutoAssetControlManager *)self setConfigurationPersist:v17 fromLocation:@"atomicInstanceUUIDForNewSetJob" forReason:@"set discoveredInFlight" dueToAlter:0 forHistoryOperation:9999];
    }
  }

  v19 = [v13 atomicInstanceUUID];

  return v19;
}

- (id)atomicInstanceNewIdentifierForSetAtomicInstance:(id)a3
{
  v3 = a3;
  v4 = [NSString alloc];
  v5 = [v3 clientDomainName];
  v6 = [v3 assetSetIdentifier];

  v7 = [v4 initWithFormat:@"%@_%@", v5, v6];

  return v7;
}

- (id)atomicInstanceNewEntryIDForSetAtomicInstance:(id)a3
{
  v3 = a3;
  v4 = [NSString alloc];
  v5 = [v3 clientDomainName];
  v6 = [v3 assetSetIdentifier];
  v7 = [v3 atomicInstanceUUID];

  v8 = [v4 initWithFormat:@"%@_%@_%@", v5, v6, v7];

  return v8;
}

- (id)atomicInstanceUUIDArrayForSetDescriptor:(id)a3
{
  v3 = a3;
  v4 = objc_alloc_init(NSMutableArray);
  v5 = [v3 latestDownloadedAtomicInstance];

  if (v5)
  {
    v6 = [v3 latestDownloadedAtomicInstance];
    [v4 addObject:v6];
  }

  if (![v4 count])
  {

    v4 = 0;
  }

  return v4;
}

- (id)atomicInstanceNewSubAtomicFromAtomic:(id)a3 forSubsetInfoInstance:(id)a4 error:(id *)a5
{
  v7 = a3;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [v7 atomicInstanceUUID];

  if (!v11)
  {
    v36 = [NSString alloc];
    v37 = [v7 summary];
    v38 = [v36 initWithFormat:@"auto-asset-set to create sub-atomic-instance from has no atomic-instance | fromSetAtomicInstance:%@", v37];
    v39 = [MAAutoAssetError buildError:6551 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v38];

    v40 = 0;
    if (v39)
    {
      goto LABEL_36;
    }

    goto LABEL_39;
  }

  v12 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v13 = [v7 atomicInstanceUUID];
  v14 = [v12 safeObjectForKey:v13 ofClass:objc_opt_class()];

  v55 = v14;
  if (!v14)
  {
    v41 = [NSString alloc];
    v42 = [v7 summary];
    v43 = [v41 initWithFormat:@"auto-asset-set to create sub-atomic-instance from is not currenty known [presumed retired] | fromSetAtomicInstance:%@", v42];
    v44 = 6551;
LABEL_31:
    v39 = [MAAutoAssetError buildError:v44 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v43];

    v40 = 0;
    goto LABEL_35;
  }

  v15 = [v8 autoAssetEntries];

  if (!v15)
  {
    v45 = [NSString alloc];
    v42 = [v8 summary];
    v43 = [v45 initWithFormat:@"entries to make up sub-atomic-instance must be specified [use empty array to indicate empty sub-atomic-instance | subsetAtomicInfoInstance:%@", v42];
    v44 = 6102;
    goto LABEL_31;
  }

  v16 = [v8 autoAssetEntries];
  v17 = [v16 count];

  if (!v17)
  {
    v32 = [v7 atomicInstanceUUID];
    v33 = @"SUB_ATOMIC_0_ENTRIES";
    v34 = self;
    v35 = 226;
    goto LABEL_34;
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  obj = [v8 autoAssetEntries];
  v52 = [obj countByEnumeratingWithState:&v73 objects:v78 count:16];
  if (!v52)
  {
    goto LABEL_26;
  }

  v53 = v7;
  v54 = *v74;
  v60 = v8;
  v58 = self;
  while (2)
  {
    v18 = 0;
    while (2)
    {
      if (*v74 != v54)
      {
        v19 = v18;
        objc_enumerationMutation(obj);
        v18 = v19;
      }

      v56 = v18;
      v68 = *(*(&v73 + 1) + 8 * v18);
      v69 = 0u;
      v70 = 0u;
      v71 = 0u;
      v72 = 0u;
      v61 = [v7 instanceEntries];
      v67 = [v61 countByEnumeratingWithState:&v69 objects:v77 count:16];
      if (!v67)
      {
LABEL_32:

        v46 = [NSString alloc];
        v47 = [v8 summary];
        v48 = [v46 initWithFormat:@"auto-asset-set to create sub-atomic-instance from does not represent selector(s) to be a sub-atomic-instance | subsetAtomicInfoInstance:%@", v47];
        v39 = [MAAutoAssetError buildError:6553 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v48];

        v40 = 0;
        v7 = v53;
        goto LABEL_35;
      }

      v66 = *v70;
LABEL_12:
      v20 = 0;
      while (1)
      {
        if (*v70 != v66)
        {
          objc_enumerationMutation(v61);
        }

        v21 = *(*(&v69 + 1) + 8 * v20);
        v22 = [v68 assetSelector];
        v23 = [v22 assetType];
        v24 = [v21 assetSelector];
        v25 = [v24 assetType];
        if (![SUCore stringIsEqual:v23 to:v25])
        {
          goto LABEL_20;
        }

        v63 = v22;
        v65 = [v68 assetSelector];
        v26 = [v65 assetSpecifier];
        v62 = [v21 assetSelector];
        v27 = [v62 assetSpecifier];
        v64 = v26;
        if (![SUCore stringIsEqual:v26 to:v27])
        {

          v8 = v60;
          v22 = v63;
LABEL_20:

          goto LABEL_21;
        }

        v28 = [v68 assetSelector];
        v29 = [v28 assetVersion];
        v30 = [v21 assetSelector];
        v31 = [v30 assetVersion];
        v59 = [SUCore stringIsEqual:v29 to:v31];

        v8 = v60;
        self = v58;
        if (v59)
        {
          break;
        }

LABEL_21:
        if (v67 == ++v20)
        {
          v67 = [v61 countByEnumeratingWithState:&v69 objects:v77 count:16];
          if (v67)
          {
            goto LABEL_12;
          }

          goto LABEL_32;
        }
      }

      v18 = v56 + 1;
      v7 = v53;
      if ((v56 + 1) != v52)
      {
        continue;
      }

      break;
    }

    v52 = [obj countByEnumeratingWithState:&v73 objects:v78 count:16];
    if (v52)
    {
      continue;
    }

    break;
  }

LABEL_26:

  v32 = [v7 atomicInstanceUUID];
  v33 = @"SUB_ATOMIC_WITH_ENTRIES";
  v34 = self;
  v35 = 227;
LABEL_34:
  v40 = [(MADAutoAssetControlManager *)v34 atomicInstanceNewSetAtomicInstance:@"atomicInstanceNewSubAtomicFromAtomic" forCreationReason:v33 recordingHistoryOperation:v35 forSetInfoInstance:v8 asSubAtomicFrom:v32];

  v39 = 0;
LABEL_35:

  if (v39)
  {
LABEL_36:

    if (a5)
    {
      v49 = v39;
      v40 = 0;
      *a5 = v39;
    }

    else
    {
      v40 = 0;
    }
  }

LABEL_39:

  return v40;
}

- (id)atomicInstanceMatchingInfoInstance:(id)a3 withSetInfoInstance:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v7 atomicInstance];

  if (!v10)
  {
    v19 = 0;
    goto LABEL_11;
  }

  v11 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [v7 atomicInstance];
  v13 = [v11 safeObjectForKey:v12 ofClass:objc_opt_class()];

  if (!v13)
  {
    goto LABEL_9;
  }

  v14 = [v13 clientDomainName];
  v15 = [v7 clientDomainName];
  if (([SUCore stringIsEqual:v14 to:v15]& 1) == 0)
  {

    goto LABEL_8;
  }

  v16 = [v13 assetSetIdentifier];
  v17 = [v7 assetSetIdentifier];
  v18 = [SUCore stringIsEqual:v16 to:v17];

  if (!v18)
  {
LABEL_8:
    v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v21 = [v20 diag];
    v22 = [NSString alloc];
    v23 = [v7 summary];
    v24 = [v13 summary];
    v25 = [v22 initWithFormat:@"{%@:atomicInstanceMatchingInfoInstance} setInfoInstance is tracking a different auto-asset-set | setInfoInstance:%@ | setAtomicInstance:%@", v6, v23, v24];
    [v21 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6108 withError:0];

LABEL_9:
    v19 = 0;
    goto LABEL_10;
  }

  v19 = v13;
LABEL_10:

LABEL_11:

  return v19;
}

- (id)atomicInstanceForSetDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 latestDownloadedAtomicInstance];

  if (v7)
  {
    v8 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    v9 = [v4 latestDownloadedAtomicInstance];
LABEL_5:
    v11 = v9;
    v12 = [v8 safeObjectForKey:v9 ofClass:objc_opt_class()];

    goto LABEL_6;
  }

  v10 = [v4 discoveredAtomicInstance];

  if (v10)
  {
    v8 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    v9 = [v4 discoveredAtomicInstance];
    goto LABEL_5;
  }

  v12 = 0;
LABEL_6:

  return v12;
}

- (int64_t)atomicInstanceNextCreationIndex:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v35 = a4;
  v32 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [[NSString alloc] initWithFormat:@"%@:atomicInstanceNextCreationIndex", v8];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v11 ofContainer:@"knownSetAtomicInstancesByInstance"];
  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
  if (v12)
  {
    v13 = v12;
    v29 = v11;
    v30 = v8;
    v31 = 0;
    v14 = *v37;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v37 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v36 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v20 = [v19 safeObjectForKey:v17 ofClass:objc_opt_class()];

        v21 = [v20 clientDomainName];
        if (([SUCore stringIsEqual:v21 to:v35]& 1) != 0)
        {
          v34 = v18;
          v22 = v14;
          v23 = self;
          v24 = p_weak_ivar_lyt;
          v25 = [v20 assetSetIdentifier];
          v26 = [SUCore stringIsEqual:v25 to:v32];

          if (v26)
          {
            p_weak_ivar_lyt = v24;
            self = v23;
            v14 = v22;
            v18 = v34;
            if ([v20 instanceCreationIndex] > v31)
            {
              v31 = [v20 instanceCreationIndex];
            }
          }

          else
          {
            p_weak_ivar_lyt = v24;
            self = v23;
            v14 = v22;
            v18 = v34;
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v18);
      }

      v13 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
    }

    while (v13);
    v8 = v30;
    v27 = v31 + 1;
    v11 = v29;
  }

  else
  {
    v27 = 1;
  }

  return v27;
}

- (void)atomicInstanceTrackSetDescriptor:(id)a3 fromLocation:(id)a4 forSpecificAtomicInstance:(id)a5
{
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:a3];
  v5 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v5);
}

- (void)atomicInstanceForceUnlock:(id)a3 dueToError:(id)a4 forgettingAtomicInstance:(id)a5 historyOperationAI:(int64_t)a6 historyOperationSD:(int64_t)a7
{
  v12 = a4;
  v13 = a5;
  v14 = a3;
  v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v16 = [v15 extendedStateQueue];
  dispatch_assert_queue_V2(v16);

  v17 = [[NSString alloc] initWithFormat:@"%@:atomicInstanceForceUnlock", v14];
  v18 = [v13 atomicInstanceUUID];

  v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v17 forAtomicInstanceUUID:v18 requireExists:0];

  if (v19)
  {
    [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v19];
    if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:v19])
    {
      [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:v17 forSetDescriptor:v19 endingAll:0 performingHardEliminate:1 error:0];
    }

    [(MADAutoAssetControlManager *)self secureCheckUngraftAll:v17 forSetDescriptorNoLongerLocked:v19];
    [(MADAutoAssetControlManager *)self setLockUsageMapEndedLockForSetDescriptor:v19 forLockReason:0 endedLockCount:-1];
    v20 = [v19 clientDomainName];
    v21 = [v19 assetSetIdentifier];
    v22 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v20 forAssetSetIdentifier:v21];

    if (v22)
    {
      v23 = [v22 latestAtomicInstanceToVend];

      if (v23)
      {
        v35 = a7;
        v24 = [v22 latestAtomicInstanceToVend];
        v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v17 forAtomicInstanceUUID:v24 requireExists:1];

        v26 = [v25 latestDownloadedAtomicInstance];
        v27 = [v19 latestDownloadedAtomicInstance];
        LODWORD(v24) = [SUCore stringIsEqual:v26 to:v27];

        if (v24)
        {
          if (v12)
          {
            v28 = [v22 availableForUseError];
            v29 = [(MADAutoAssetControlManager *)self statusErrorConsideredMatch:v12 to:v28];

            if ((v29 & 1) == 0)
            {
              [v22 setAvailableForUseError:v12];
              [(MADAutoAssetControlManager *)self setConfigurationPersist:v22 fromLocation:v17 forReason:@"latest-to-vend atomic-instance force-unlocked" dueToAlter:0 forHistoryOperation:460];
            }
          }
        }

        else
        {
          [(MADAutoAssetControlManager *)self _removeAllUnlockedForOtherAtomicInstances:v25 fromLocation:v17];
        }

        a7 = v35;
      }
    }

    if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v12])
    {
      v30 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
      {
        v31 = [v22 summary];
        *buf = 138543618;
        v37 = v17;
        v38 = 2114;
        v39 = v31;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@} force-unlock due to failure to graft (due to device being locked) | setConfiguration:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v19 fromLocation:v17 checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:a6 historyOperationSD:a7];
    }

    v32 = [v19 clientDomainName];
    v33 = [v19 assetSetIdentifier];
    v34 = [v19 latestDownloadedAtomicInstance];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_FORCE_UNLOCKED" forClientDomainName:v32 forAssetSetIdentifier:v33 forAtomicInstanceUUID:v34 fromModule:@"AUTO-CONTROL" fromLocation:v17];
  }
}

- (BOOL)atomicInstanceIsCurrentlyLocked:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4)
  {
    v7 = [v4 atomicInstanceUUID];
    v8 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"atomicInstanceIsCurrentlyLocked" forAtomicInstanceUUID:v7 requireExists:0];

    if (v8)
    {
      v9 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"atomicInstanceIsCurrentlyLocked" forSetDescriptor:v8];
    }

    else
    {
      v9 = 0;
    }
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (id)atomicInstanceUUIDFromCurrentStatus:(id)a3
{
  v3 = a3;
  v4 = [v3 newerAtomicInstanceDiscovered];
  if (!v4)
  {
    v4 = [v3 latestDownloadedAtomicInstance];
  }

  return v4;
}

- (void)atomicInstanceRemovedSetJob:(id)a3 removingForReason:(id)a4 historyOperation:(int64_t)a5
{
  v7 = a3;
  v8 = a4;
  v9 = v7;
  v40 = v8;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v42 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceRemovedSetJob" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v54 = 0u;
  v55 = 0u;
  v52 = 0u;
  v53 = 0u;
  v47 = self;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v43 = v7;
  v46 = [obj countByEnumeratingWithState:&v52 objects:v57 count:16];
  if (v46)
  {
    v45 = *v53;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v13 = 0;
      do
      {
        if (*v53 != v45)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v52 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)v47 knownSetAtomicInstancesByInstance];
        v17 = [v16 safeObjectForKey:v14 ofClass:objc_opt_class()];

        v18 = [v17 atomicInstanceUUID];
        if (v18)
        {
          v19 = v18;
          v20 = p_weak_ivar_lyt[223];
          v21 = [v17 clientDomainName];
          v22 = [v9 clientDomainName];
          if ([v20 stringIsEqual:v21 to:v22])
          {
            v23 = p_weak_ivar_lyt[223];
            v24 = [v17 assetSetIdentifier];
            v25 = [v9 autoAssetSetIdentifier];
            LODWORD(v23) = [v23 stringIsEqual:v24 to:v25];

            v9 = v43;
            if (!v23)
            {
              goto LABEL_15;
            }

            v26 = [v17 atomicInstanceUUID];
            v19 = [(MADAutoAssetControlManager *)v47 locateSetDescriptor:@"atomicInstanceRemovedSetJob" forAtomicInstanceUUID:v26 requireExists:0];

            if (!v19)
            {
              v27 = [v17 atomicInstanceUUID];

              if (v27)
              {
                v21 = [v17 atomicInstanceUUID];
                [v42 addObject:v21];
              }

              else
              {
                v21 = [(MADAutoAssetControlManager *)v47 autoControlManagerFSM];
                v28 = [v21 diag];
                v29 = [NSString alloc];
                v30 = [v17 summary];
                v31 = [v29 initWithFormat:@"{atomicInstanceRemovedSetJob} MISSING atomicInstanceUUID | nextSetAtomicInstance:%@", v30];
                [v28 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v31 withResult:6108 withError:0];

                v9 = v43;
              }

LABEL_13:

              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            }

            goto LABEL_15;
          }

          goto LABEL_13;
        }

LABEL_15:

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v46 != v13);
      v32 = [obj countByEnumeratingWithState:&v52 objects:v57 count:16];
      v46 = v32;
    }

    while (v32);
  }

  v50 = 0u;
  v51 = 0u;
  v48 = 0u;
  v49 = 0u;
  v33 = v42;
  v34 = [v33 countByEnumeratingWithState:&v48 objects:v56 count:16];
  if (v34)
  {
    v35 = v34;
    v36 = *v49;
    do
    {
      for (i = 0; i != v35; i = i + 1)
      {
        if (*v49 != v36)
        {
          objc_enumerationMutation(v33);
        }

        v38 = *(*(&v48 + 1) + 8 * i);
        v39 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)v47 atomicInstanceRemove:@"atomicInstanceRemovedSetJob" setAtomicInstanceUUID:v38 removingForReason:v40 historyOperation:a5];
        objc_autoreleasePoolPop(v39);
      }

      v35 = [v33 countByEnumeratingWithState:&v48 objects:v56 count:16];
    }

    while (v35);
  }
}

- (void)atomicInstanceEliminate:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5
{
  v8 = a3;
  v58 = a4;
  v55 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v54 = v8;
  v11 = [[NSString alloc] initWithFormat:@"%@:atomicInstanceEliminate", v8];
  v61 = objc_alloc_init(NSMutableArray);
  v57 = v11;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v11 ofContainer:@"knownSetAtomicInstancesByInstance"];
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  v66 = self;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v71 objects:v82 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v72;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v72 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v71 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)v66 knownSetAtomicInstancesByInstance];
        v20 = [v19 safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v17)
        {
          v21 = v20 == 0;
        }

        else
        {
          v21 = 1;
        }

        if (!v21)
        {
          v22 = p_weak_ivar_lyt[223];
          v23 = [v20 clientDomainName];
          if ([v22 stringIsEqual:v58 to:v23])
          {
            v24 = p_weak_ivar_lyt[223];
            [v20 assetSetIdentifier];
            v26 = v25 = p_weak_ivar_lyt;
            LODWORD(v24) = [v24 stringIsEqual:v55 to:v26];

            p_weak_ivar_lyt = v25;
            if (!v24)
            {
              goto LABEL_15;
            }

            [v61 addObject:v17];
            v23 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
            {
              v27 = [(MADAutoAssetControlManager *)v66 summary];
              v28 = [v20 summary];
              *buf = 138543874;
              v77 = v27;
              v78 = 2114;
              v79 = v57;
              v80 = 2114;
              v81 = v28;
              _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} | eliminating nextSetAtomicInstance:%{public}@", buf, 0x20u);

              p_weak_ivar_lyt = v25;
            }
          }
        }

LABEL_15:

        objc_autoreleasePoolPop(v18);
      }

      v13 = [obj countByEnumeratingWithState:&v71 objects:v82 count:16];
    }

    while (v13);
  }

  v69 = 0u;
  v70 = 0u;
  v67 = 0u;
  v68 = 0u;
  v59 = v61;
  v29 = [v59 countByEnumeratingWithState:&v67 objects:v75 count:16];
  v30 = v66;
  v31 = v57;
  if (v29)
  {
    v32 = v29;
    v60 = *v68;
    do
    {
      v33 = 0;
      v56 = v32;
      do
      {
        if (*v68 != v60)
        {
          objc_enumerationMutation(v59);
        }

        v34 = *(*(&v67 + 1) + 8 * v33);
        v35 = objc_autoreleasePoolPush();
        v36 = [(MADAutoAssetControlManager *)v30 knownSetAtomicInstancesByInstance];
        v37 = [v36 safeObjectForKey:v34 ofClass:objc_opt_class()];

        if (v37)
        {
          v38 = [(MADAutoAssetControlManager *)v30 atomicInstanceNewEntryIDForSetAtomicInstance:v37];
          v39 = [(MADAutoAssetControlManager *)v30 persistedKnownSetAtomicInstances];
          v40 = [v39 persistedEntry:v38 fromLocation:v31];

          if (v40)
          {
            v62 = v40;
            obja = v35;
            [v37 setUsageStatus:@"FORGOTTEN"];
            v41 = [(MADAutoAssetControlManager *)v30 persistedKnownSetAtomicInstances];
            [v41 removePersistedEntry:v38 fromLocation:v31];

            v42 = [v37 instanceEntries];
            v43 = [v42 count];
            v44 = [v37 clientDomainName];
            v45 = [v37 assetSetIdentifier];
            v46 = [v37 atomicInstanceUUID];
            [MADAutoAssetHistory recordOperation:300 toHistoryType:2 fromLayer:1 usageCount:v43 forClientDomainName:v44 forAssetSetIdentifier:v45 forAtomicInstance:v46];

            v31 = v57;
            v30 = v66;

            [(MADAutoAssetControlManager *)v66 _logPersistedSetAtomicInstanceRemoved:v57 removedPersistedEntryID:v38 removedSetAtomicInstance:v37 message:@"eliminated by client"];
            v47 = [v37 atomicInstanceUUID];

            if (v47)
            {
              v48 = [(MADAutoAssetControlManager *)v66 knownSetAtomicInstancesByInstance];
              v49 = [v37 atomicInstanceUUID];
              [v48 removeObjectForKey:v49];
            }

            [(MADAutoAssetControlManager *)v66 _clearAtomicInstanceFromAllSetConfigurations:v37 fromLocation:v57];
            v32 = v56;
            v40 = v62;
            v35 = obja;
          }

          else
          {
            v50 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR))
            {
              v51 = [(MADAutoAssetControlManager *)v30 _updateLatestSummary];
              [v37 summary];
              v52 = objb = v35;
              *buf = 138543874;
              v77 = v51;
              v78 = 2114;
              v79 = v31;
              v80 = 2114;
              v81 = v52;
              _os_log_impl(&dword_0, v50, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to load persisted-set-atomic-instance file | nextRemoveSetInstance:%{public}@", buf, 0x20u);

              v35 = objb;
              v40 = 0;
            }
          }
        }

        if (v34)
        {
          v53 = [(MADAutoAssetControlManager *)v30 knownSetAtomicInstancesByInstance];
          [v53 removeObjectForKey:v34];
        }

        objc_autoreleasePoolPop(v35);
        v33 = v33 + 1;
      }

      while (v32 != v33);
      v32 = [v59 countByEnumeratingWithState:&v67 objects:v75 count:16];
    }

    while (v32);
  }
}

- (void)atomicInstanceRemove:(id)a3 setAtomicInstanceUUID:(id)a4 removingForReason:(id)a5 historyOperation:(int64_t)a6
{
  v9 = a3;
  v74 = a4;
  v64 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v67 = objc_alloc_init(NSMutableArray);
  v61 = v9;
  v65 = [[NSString alloc] initWithFormat:@"%@:atomicInstanceRemove", v9];
  [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
  v81 = 0u;
  v82 = 0u;
  v79 = 0u;
  v80 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v79 objects:v94 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v80;
    v69 = *v80;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v80 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v16 = *(*(&v79 + 1) + 8 * i);
        v17 = objc_autoreleasePoolPush();
        v18 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v19 = [v18 safeObjectForKey:v16 ofClass:objc_opt_class()];

        if (v16)
        {
          v20 = v19 == 0;
        }

        else
        {
          v20 = 1;
        }

        if (!v20)
        {
          v21 = [v19 atomicInstanceUUID];
          if ([SUCore stringIsEqual:v21 to:v74])
          {
          }

          else
          {
            v22 = [v19 subAtomicFromAtomicInstanceUUID];
            v23 = [SUCore stringIsEqual:v22 to:v74];

            v14 = v69;
            if (!v23)
            {
              goto LABEL_16;
            }
          }

          [v67 addObject:v16];
          v24 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
          {
            v25 = [(MADAutoAssetControlManager *)self summary];
            v26 = [v19 summary];
            *buf = 138544386;
            v85 = v25;
            v86 = 2114;
            v87 = v65;
            v88 = 2114;
            v89 = v64;
            v90 = 2114;
            v91 = v74;
            v92 = 2114;
            v93 = v26;
            _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} (%{public}@) removing by UUID | setAtomicInstanceUUID:%{public}@ | nextSetAtomicInstance:%{public}@", buf, 0x34u);

            v14 = v69;
          }
        }

LABEL_16:

        objc_autoreleasePoolPop(v17);
      }

      v13 = [obj countByEnumeratingWithState:&v79 objects:v94 count:16];
    }

    while (v13);
  }

  v77 = 0u;
  v78 = 0u;
  v75 = 0u;
  v76 = 0u;
  v62 = v67;
  v27 = v74;
  v28 = v65;
  v73 = [v62 countByEnumeratingWithState:&v75 objects:v83 count:16];
  if (v73)
  {
    obja = *v76;
    do
    {
      for (j = 0; j != v73; j = j + 1)
      {
        if (*v76 != obja)
        {
          objc_enumerationMutation(v62);
        }

        v30 = *(*(&v75 + 1) + 8 * j);
        v31 = objc_autoreleasePoolPush();
        v32 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v33 = [v32 safeObjectForKey:v30 ofClass:objc_opt_class()];

        if (v33)
        {
          [(MADAutoAssetControlManager *)self setConfigurationRemovedAtomicInstance:v27 fromLocation:v28];
          v34 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v33];
          v35 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v36 = [v35 persistedEntry:v34 fromLocation:v28];

          if (v36)
          {
            v66 = v36;
            v70 = v31;
            [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromAllSetConfigurations:v33 fromLocation:v28];
            [(MADAutoAssetControlManager *)self setConfigurationRemovedAtomicInstance:v27 fromLocation:v28];
            [v33 setUsageStatus:@"FORGOTTEN"];
            v37 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
            [v37 removePersistedEntry:v34 fromLocation:v28];

            v38 = [v33 instanceEntries];
            v68 = v34;
            v39 = [v38 count];
            v40 = [v33 clientDomainName];
            v41 = [v33 assetSetIdentifier];
            v42 = [v33 atomicInstanceUUID];
            v43 = v39;
            v34 = v68;
            [MADAutoAssetHistory recordOperation:a6 toHistoryType:2 fromLayer:1 usageCount:v43 forClientDomainName:v40 forAssetSetIdentifier:v41 forAtomicInstance:v42];

            v28 = v65;
            v44 = [[NSString alloc] initWithFormat:@"removed set-atomic-instance | removalReason:%@", v64];
            [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstanceRemoved:v65 removedPersistedEntryID:v68 removedSetAtomicInstance:v33 message:v44];

            if (v30)
            {
              v45 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
              [v45 removeObjectForKey:v30];
            }

            v46 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
            {
              v47 = [v33 summary];
              *buf = 138543618;
              v85 = v65;
              v86 = 2114;
              v87 = v47;
              _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@} removed | nextRemoveSetInstance:%{public}@", buf, 0x16u);
            }

            v27 = v74;
            v31 = v70;
            v36 = v66;
            if (+[MAAIRBEventReporter isAvailable])
            {
              v48 = [MAAIRBMobileAssetOperationMetadata alloc];
              v49 = [MADAutoAssetHistoryTracker operationName:a6];
              v50 = [(MAAIRBMobileAssetOperationMetadata *)v48 initWithCode:a6 name:v49];

              v51 = [MAAIRBMobileAssetAtomicInstance alloc];
              v52 = [MAAIRBMobileAssetAssetSet alloc];
              v53 = [v33 assetSetIdentifier];
              v54 = [(MAAIRBMobileAssetAssetSet *)v52 initWithAssetSetIdentifier:v53];
              v55 = [v33 atomicInstanceUUID];
              v56 = [(MAAIRBMobileAssetAtomicInstance *)v51 initWithAssetSet:v54 atomicInstanceId:v55];

              v28 = v65;
              v36 = v66;
              v57 = [v33 instanceEntries];
              v58 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v50, v56, [v57 count]);

              v59 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v58];
              [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v59];

              v34 = v68;
              v31 = v70;
              goto LABEL_33;
            }
          }

          else
          {
            v50 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR))
            {
              v56 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v60 = [v33 summary];
              *buf = 138544130;
              v85 = v56;
              v86 = 2114;
              v87 = v28;
              v88 = 2114;
              v89 = v64;
              v90 = 2114;
              v91 = v60;
              _os_log_impl(&dword_0, v50, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] (%{public}@) {%{public}@} unable to load persisted-set-atomic-instance file | nextRemoveSetInstance:%{public}@", buf, 0x2Au);

              v27 = v74;
LABEL_33:
            }
          }
        }

        objc_autoreleasePoolPop(v31);
      }

      v73 = [v62 countByEnumeratingWithState:&v75 objects:v83 count:16];
    }

    while (v73);
  }
}

- (id)newSetLockUsageMapKeyForClientDomain:(id)a3 forSetIdentifier:(id)a4
{
  v5 = a4;
  v6 = a3;
  v7 = [[NSString alloc] initWithFormat:@"%@_%@", v6, v5];

  return v7;
}

- (id)setLockUsageMapForSetDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  v8 = [v4 assetSetIdentifier];

  v9 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:v7 forSetIdentifier:v8];
  v10 = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v11 = [v10 safeObjectForKey:v9 ofClass:objc_opt_class()];

  return v11;
}

- (id)setLockUsageMapForClientDomain:(id)a3 forSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:v7 forSetIdentifier:v6];
  v11 = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (void)setLockUsageMapLockedSetDescriptor:(id)a3 forLockReason:(id)a4
{
  v26 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSNumber alloc] initWithLong:1];
  if (v9)
  {
    v10 = [v26 clientDomainName];
    v11 = [v26 assetSetIdentifier];
    v12 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:v10 forSetIdentifier:v11];

    v13 = [(MADAutoAssetControlManager *)self setLockUsageMap];
    v14 = [v13 safeObjectForKey:v12 ofClass:objc_opt_class()];

    if (!v14)
    {
      v20 = objc_alloc_init(NSMutableDictionary);
      if (!v20)
      {
LABEL_16:

        goto LABEL_17;
      }

      v14 = v20;
      v16 = objc_alloc_init(NSMutableDictionary);
      if (v16)
      {
        v21 = [v26 latestDownloadedAtomicInstance];
        [v16 setSafeObject:v9 forKey:v21];

        [v14 setSafeObject:v16 forKey:v6];
        v22 = [(MADAutoAssetControlManager *)self setLockUsageMap];
        [v22 setSafeObject:v14 forKey:v12];
      }

      goto LABEL_14;
    }

    v15 = [v14 safeObjectForKey:v6 ofClass:objc_opt_class()];
    if (v15)
    {
      v16 = v15;
      v17 = [v26 latestDownloadedAtomicInstance];
      v18 = [v16 safeObjectForKey:v17 ofClass:objc_opt_class()];

      if (v18)
      {
        v19 = [[NSNumber alloc] initWithLong:{objc_msgSend(v18, "longValue") + objc_msgSend(v9, "longValue")}];

        if (!v19)
        {
          goto LABEL_14;
        }
      }

      else
      {
        v19 = v9;
      }

      v25 = [v26 latestDownloadedAtomicInstance];
      [v16 setSafeObject:v19 forKey:v25];
    }

    else
    {
      v23 = objc_alloc_init(NSMutableDictionary);
      if (!v23)
      {
LABEL_15:

        goto LABEL_16;
      }

      v16 = v23;
      v24 = [v26 latestDownloadedAtomicInstance];
      [v16 setSafeObject:v9 forKey:v24];

      [v14 setSafeObject:v16 forKey:v6];
    }

LABEL_14:

    goto LABEL_15;
  }

LABEL_17:
}

- (void)setLockUsageMapEndedLockForSetDescriptor:(id)a3 forLockReason:(id)a4 endedLockCount:(int64_t)a5
{
  v7 = a3;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [v7 clientDomainName];
  v12 = [v7 assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:v11 forSetIdentifier:v12];

  v14 = self;
  v15 = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v16 = [v15 safeObjectForKey:v13 ofClass:objc_opt_class()];

  v55 = v13;
  v58 = v16;
  if (v16)
  {
    if (v8)
    {
      v67 = v8;
      v17 = [NSArray arrayWithObjects:&v67 count:1];
      v18 = v16;
    }

    else
    {
      v18 = v16;
      v17 = [v16 allKeys];
    }

    v64 = 0u;
    v65 = 0u;
    v62 = 0u;
    v63 = 0u;
    v19 = v17;
    v60 = [v19 countByEnumeratingWithState:&v62 objects:v66 count:16];
    if (v60)
    {
      v59 = *v63;
      obj = v19;
      do
      {
        v22 = 0;
        do
        {
          if (*v63 != v59)
          {
            objc_enumerationMutation(obj);
          }

          v23 = [v18 safeObjectForKey:*(*(&v62 + 1) + 8 * v22) ofClass:objc_opt_class()];
          if (!v23)
          {
            v36 = [(MADAutoAssetControlManager *)v14 autoControlManagerFSM];
            v37 = [v36 diag];
            v38 = [NSString alloc];
            v39 = [v7 summary];
            v40 = [v38 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when no lockReasonByAtomicInstanceUUID in lock-usage-map | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | setIdentifierByLockReason:%@", v8, a5, v39, v18];
            [v37 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v40 withResult:6108 withError:0];

            goto LABEL_18;
          }

          v24 = [v7 latestDownloadedAtomicInstance];
          v25 = [v23 safeObjectForKey:v24 ofClass:objc_opt_class()];

          if (!v25)
          {
            if (v8)
            {
              v25 = [(MADAutoAssetControlManager *)v14 autoControlManagerFSM];
              v41 = [v25 diag];
              v42 = [NSString alloc];
              v43 = [v7 summary];
              v44 = [v42 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when no autoAssetLockCount in lock-usage-map | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | lockReasonByAtomicInstanceUUID:%@", v8, a5, v43, v23];
              [v41 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v44 withResult:6108 withError:0];
            }

            else
            {
              v25 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
              {
                goto LABEL_27;
              }

              v41 = [v7 summary];
              v45 = [(MADAutoAssetControlManager *)v14 setLockUsageMap];
              *buf = 138543618;
              v69 = v41;
              v70 = 2114;
              v71 = v45;
              _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "{setLockUsageMapEndedLockForSetDescriptor} no set-locks in set-lock-usage-map for set-descriptor | setDescriptor:%{public}@ | setLockUsageMap:\n%{public}@", buf, 0x16u);
            }

            goto LABEL_27;
          }

          v26 = [v25 intValue];
          if (a5 == -1)
          {
            goto LABEL_27;
          }

          v27 = v7;
          v28 = v14;
          v29 = v8;
          v30 = v26;
          if (v26 < a5)
          {
            v31 = v28;
            v56 = [(MADAutoAssetControlManager *)v28 autoControlManagerFSM];
            v32 = [v56 diag];
            v33 = [NSString alloc];
            v7 = v27;
            v34 = [v27 summary];
            v54 = v29;
            v53 = v30;
            v8 = v29;
            v14 = v31;
            v35 = [v33 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when previousLockCount(%ld) too small | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | lockReasonByAtomicInstanceUUID:%@", v53, v54, a5, v34, v23];
            [v32 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v35 withResult:6108 withError:0];

LABEL_27:
            goto LABEL_28;
          }

          if (v26 == a5)
          {
            v8 = v29;
            v14 = v28;
            v7 = v27;
            goto LABEL_27;
          }

          v36 = [[NSNumber alloc] initWithLong:v26 - a5];

          v8 = v29;
          v14 = v28;
          v7 = v27;
          if (v36)
          {
            v51 = [v27 latestDownloadedAtomicInstance];
            [v23 setSafeObject:v36 forKey:v51];
            goto LABEL_43;
          }

LABEL_28:
          v46 = [v7 latestDownloadedAtomicInstance];

          if (v46)
          {
            v47 = [v7 latestDownloadedAtomicInstance];
            [v23 removeObjectForKey:v47];
          }

          v18 = v58;
          if (![v23 count])
          {
            if (v8)
            {
              [v58 removeObjectForKey:v8];
            }

            if (![v58 count])
            {
              if (v55)
              {
                v48 = [(MADAutoAssetControlManager *)v14 setLockUsageMap];
                [v48 removeObjectForKey:v55];
              }

              v49 = [(MADAutoAssetControlManager *)v14 setLockUsageMap];
              v50 = [v49 count];

              v18 = v58;
              if (!v50)
              {
                v36 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
                {
                  v51 = [(MADAutoAssetControlManager *)v14 _updateLatestSummary];
                  *buf = 138543362;
                  v69 = v51;
                  _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setLockUsageMapEndedLockForSetDescriptor} no remaining set-locks in set-lock-usage-map", buf, 0xCu);
LABEL_43:

                  v18 = v58;
                }

LABEL_18:
              }
            }
          }

          v22 = v22 + 1;
        }

        while (v60 != v22);
        v19 = obj;
        v52 = [obj countByEnumeratingWithState:&v62 objects:v66 count:16];
        v60 = v52;
      }

      while (v52);
    }

    v13 = v55;
  }

  else
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      v20 = [(MADAutoAssetControlManager *)v14 _updateLatestSummary];
      v21 = [v7 summary];
      *buf = 138543618;
      v69 = v20;
      v70 = 2114;
      v71 = v21;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setLockUsageMapEndedLockForSetDescriptor} set-descriptor not in lock-usage-map | setDescriptor:%{public}@", buf, 0x16u);
    }
  }
}

- (void)setLockUsageMapEliminateForClientDomain:(id)a3 forSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v11 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:v7 forSetIdentifier:v6];
  if (v11)
  {
    v10 = [(MADAutoAssetControlManager *)self setLockUsageMap];
    [v10 removeObjectForKey:v11];
  }
}

- (int)setLockUsageMapForAtomicInstance:(id)a3 clientLockUsageMap:(id)a4 lockReason:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  if (v10)
  {
    v30 = v10;
    v13 = [NSArray arrayWithObjects:&v30 count:1];
  }

  else
  {
    v13 = [v9 allKeys];
  }

  v24 = v10;
  v27 = 0u;
  v28 = 0u;
  v25 = 0u;
  v26 = 0u;
  v14 = v13;
  v15 = [v14 countByEnumeratingWithState:&v25 objects:v29 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = 0;
    v18 = *v26;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v26 != v18)
        {
          objc_enumerationMutation(v14);
        }

        v20 = [v9 safeObjectForKey:*(*(&v25 + 1) + 8 * i) ofClass:objc_opt_class()];
        if (v20)
        {
          v21 = [v20 safeObjectForKey:v8 ofClass:objc_opt_class()];
          v22 = v21;
          if (v21)
          {
            v17 += [v21 intValue];
          }
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v25 objects:v29 count:16];
    }

    while (v16);
  }

  else
  {
    v17 = 0;
  }

  return v17;
}

- (int64_t)setLockUsageMapLockCount
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setLockUsageMapLockCount" ofContainer:@"setLockUsageMap"];
  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v29 = self;
  obj = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v30 = [obj countByEnumeratingWithState:&v46 objects:v52 count:16];
  v5 = 0;
  if (v30)
  {
    v28 = *v47;
    do
    {
      v6 = 0;
      do
      {
        if (*v47 != v28)
        {
          objc_enumerationMutation(obj);
        }

        v7 = *(*(&v46 + 1) + 8 * v6);
        v8 = objc_autoreleasePoolPush();
        v9 = [(MADAutoAssetControlManager *)v29 setLockUsageMap];
        v10 = [v9 safeObjectForKey:v7 ofClass:objc_opt_class()];

        if (v10)
        {
          v32 = v8;
          v33 = v6;
          v44 = 0u;
          v45 = 0u;
          v42 = 0u;
          v43 = 0u;
          v31 = v10;
          v11 = v10;
          v36 = [v11 countByEnumeratingWithState:&v42 objects:v51 count:16];
          if (v36)
          {
            v34 = v11;
            v35 = *v43;
            do
            {
              v12 = 0;
              do
              {
                if (*v43 != v35)
                {
                  objc_enumerationMutation(v11);
                }

                v13 = *(*(&v42 + 1) + 8 * v12);
                v14 = objc_autoreleasePoolPush();
                v15 = [v11 safeObjectForKey:v13 ofClass:objc_opt_class()];
                v16 = v15;
                if (v15)
                {
                  v37 = v14;
                  v40 = 0u;
                  v41 = 0u;
                  v38 = 0u;
                  v39 = 0u;
                  v17 = v15;
                  v18 = [v17 countByEnumeratingWithState:&v38 objects:v50 count:16];
                  if (v18)
                  {
                    v19 = v18;
                    v20 = *v39;
                    do
                    {
                      v21 = 0;
                      do
                      {
                        if (*v39 != v20)
                        {
                          objc_enumerationMutation(v17);
                        }

                        v22 = *(*(&v38 + 1) + 8 * v21);
                        v23 = objc_autoreleasePoolPush();
                        v24 = [v17 safeObjectForKey:v22 ofClass:objc_opt_class()];
                        v25 = v24;
                        if (v24)
                        {
                          v5 += [v24 longValue];
                        }

                        objc_autoreleasePoolPop(v23);
                        v21 = v21 + 1;
                      }

                      while (v19 != v21);
                      v19 = [v17 countByEnumeratingWithState:&v38 objects:v50 count:16];
                    }

                    while (v19);
                  }

                  v11 = v34;
                  v14 = v37;
                }

                objc_autoreleasePoolPop(v14);
                v12 = v12 + 1;
              }

              while (v12 != v36);
              v36 = [v11 countByEnumeratingWithState:&v42 objects:v51 count:16];
            }

            while (v36);
          }

          v8 = v32;
          v6 = v33;
          v10 = v31;
        }

        objc_autoreleasePoolPop(v8);
        v6 = v6 + 1;
      }

      while (v6 != v30);
      v30 = [obj countByEnumeratingWithState:&v46 objects:v52 count:16];
    }

    while (v30);
  }

  return v5;
}

- (id)shortTermLockSetDescriptor:(id)a3 forSetDescriptor:(id)a4 forSpecificAtomicInstance:(id)a5
{
  v51 = a3;
  v8 = a4;
  v48 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:shortTermLockSetDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &state);

  v50 = +[NSFileManager defaultManager];
  v12 = [[NSString alloc] initWithFormat:@"%@:shortTermLockSetDescriptor", v51];
  v13 = [v8 clientDomainName];
  v14 = [v8 assetSetIdentifier];
  v49 = [(MADAutoAssetControlManager *)self latestShortTermLockableAtomicInstanceForClientDomain:v13 forAssetSetIdentifier:v14];

  v15 = [v8 clientDomainName];
  v16 = [v8 assetSetIdentifier];
  v17 = [MANAutoAssetSetStatus shortTermLockFilename:v15 forAssetSetIdentifier:v16 forSetAtomicInstance:0];

  v18 = [v8 clientDomainName];
  v19 = [v8 assetSetIdentifier];
  v20 = [v8 latestDownloadedAtomicInstance];
  v21 = [MANAutoAssetSetStatus shortTermLockFilename:v18 forAssetSetIdentifier:v19 forSetAtomicInstance:v20];

  if (v17 && v21)
  {
    v22 = [v8 clientDomainName];
    v23 = [v8 assetSetIdentifier];
    v24 = [v8 latestDownloadedAtomicInstance];
    LOBYTE(v45) = 1;
    v25 = [(MADAutoAssetControlManager *)self buildReportedSetStatus:v51 forClientDomainName:v22 forSetIdentifier:v23 forAtomicInstance:v24 withFoundSetDescriptor:v8 withSubAtomicInstance:0 reportingLocalContentURLs:v45];

    v26 = [v8 clientDomainName];
    v27 = [v8 assetSetIdentifier];
    v28 = [MANAutoAssetSetStatus shortTermLockDirectory:v26 forAssetSetIdentifier:v27];

    v60 = NSFilePosixPermissions;
    v61 = &off_4F7F88;
    v29 = [NSDictionary dictionaryWithObjects:&v61 forKeys:&v60 count:1];
    v52 = 0;
    LOBYTE(v23) = [v50 createDirectoryAtPath:v28 withIntermediateDirectories:1 attributes:v29 error:&v52];
    v30 = v52;

    v31 = __error();
    if (v23)
    {
      if (!v49)
      {
        v32 = [(MADAutoAssetControlManager *)self _shortTermPersistSetStatus:v12 forSetDescriptor:v8 persistingSetStatus:v25 toFilename:v21];
        if (!v32)
        {
          v42 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
          {
            v43 = [v8 summary];
            *buf = 138543874;
            v55 = v12;
            v56 = 2114;
            v57 = v21;
            v58 = 2114;
            v59 = v43;
            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][FILE]{%{public}@} created SHORT-TERM atomic-instance file | filename:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
          }

          v32 = [(MADAutoAssetControlManager *)self _shortTermCreateSymbolicLink:v12 symbolicLinkFilename:v17 linkedToFilename:v21 forSetDescriptor:v8 usingFileManager:v50];
          if (!v32)
          {
            [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:v8 forSpecificAtomicInstance:v48 isReadOnlyForResumeFromPersisted:0];
            v32 = 0;
          }
        }

        goto LABEL_17;
      }

      v32 = [(MADAutoAssetControlManager *)self _shortTermPersistSetStatus:v12 forSetDescriptor:v8 persistingSetStatus:v25 toFilename:v21];
      if (v32)
      {
LABEL_17:

        goto LABEL_18;
      }

      v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v12 forAtomicInstanceUUID:v49 requireExists:1];
      if (v33)
      {
        if (v48)
        {
LABEL_34:
          v32 = 0;
          goto LABEL_16;
        }
      }

      else
      {
        v47 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v46 = [v47 diag];
        v44 = [[NSString alloc] initWithFormat:@"{%@} unable to determine set-descriptor for atomic-instance that should be currently symlinked | atomic-instance:%@", v12, v49];
        [v46 trackAnomaly:@"AUTO-CONTROL" forReason:v44 withResult:6103 withError:0];
      }

      v32 = [(MADAutoAssetControlManager *)self _shortTermCreateSymbolicLink:v12 symbolicLinkFilename:v17 linkedToFilename:v21 forSetDescriptor:v8 usingFileManager:v50];
      if (!v32)
      {
        [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:v8 forSpecificAtomicInstance:v48 isReadOnlyForResumeFromPersisted:0];
        goto LABEL_34;
      }
    }

    else
    {
      v33 = [[NSString alloc] initWithFormat:@"unable to create directory for SHORT-TERM lock atomic-instance file | filename:%@ | setDescriptor:%@ | errno:%i", v21, v28, *v31];
      v32 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v12 code:6583 description:v33 forSetDescriptor:v8 underlyingError:v30];
    }

LABEL_16:

    goto LABEL_17;
  }

  v34 = [NSString alloc];
  v35 = @"N";
  if (v17)
  {
    v36 = v17;
  }

  else
  {
    v36 = @"N";
  }

  if (v21)
  {
    v35 = v21;
  }

  v25 = [v34 initWithFormat:@"unable to prepare for SHORT-TERM locking [MISSING-REQUIRED] | atomic-instance filenames (latest:%@, base:%@)", v36, v35];
  v32 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v12 code:6101 description:v25 forSetDescriptor:v8 underlyingError:0];
  v30 = 0;
LABEL_18:

  if (v32)
  {
    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
    {
      v38 = [v32 checkedDescription];
      v39 = [v8 summary];
      *buf = 138543874;
      v55 = v12;
      v56 = 2114;
      v57 = v38;
      v58 = 2114;
      v59 = v39;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} ERROR preparing for SHORT-TERM locking | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
    }
  }

  else
  {
    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
      v40 = [v8 summary];
      *buf = 138543618;
      v55 = v12;
      v56 = 2114;
      v57 = v40;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} SUCCESS preparing for SHORT-TERM locking | setDescriptor:%{public}@", buf, 0x16u);
    }
  }

  os_activity_scope_leave(&state);

  return v32;
}

- (void)trackShortTermLockedSetDescriptor:(id)a3 forSpecificAtomicInstance:(id)a4 isReadOnlyForResumeFromPersisted:(BOOL)a5
{
  v8 = a3;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [v8 clientDomainName];
  v12 = [v8 assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v11 forAssetSetIdentifier:v12];

  v14 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
  v15 = [v14 safeObjectForKey:v13 ofClass:objc_opt_class()];

  v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"trackShortTermLockedSetDescriptor" forAtomicInstanceUUID:v15 requireExists:0];
  v17 = v16;
  if (a4)
  {
    v18 = v16 == 0;
  }

  else
  {
    v18 = 1;
  }

  v19 = v18;
  if (!a5)
  {
    v20 = [v8 latestDownloadedAtomicInstance];
    [(MADAutoAssetControlManager *)self _shortTermChangeAtomicInstance:@"trackShortTermLockedSetDescriptor" forAtomicInstance:v20 toShortTermSupported:1];
  }

  if (v19)
  {
    v21 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
    v22 = [v8 latestDownloadedAtomicInstance];
    [v21 setSafeObject:v22 forKey:v13];

    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      if (v17)
      {
        v24 = @"Replacing";
      }

      else
      {
        v24 = @"Setting";
      }

      v25 = [v8 latestDownloadedAtomicInstance];
      v26 = [v8 summary];
      v35 = 138543874;
      v36 = v24;
      v37 = 2114;
      v38 = v25;
      v39 = 2114;
      v40 = v26;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{trackShortTermLockedSetDescriptor} %{public}@ latest supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", &v35, 0x20u);
    }
  }

  v27 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
  v28 = [v8 latestDownloadedAtomicInstance];
  [v27 setSafeObject:v13 forKey:v28];

  v29 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
  {
    v30 = [v8 latestDownloadedAtomicInstance];
    v31 = [v8 summary];
    v35 = 138543618;
    v36 = v30;
    v37 = 2114;
    v38 = v31;
    _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{trackShortTermLockedSetDescriptor} now supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", &v35, 0x16u);
  }

  v32 = [v8 clientDomainName];
  v33 = [v8 assetSetIdentifier];
  v34 = [v8 latestDownloadedAtomicInstance];
  [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_FIRST_LOCKED" forClientDomainName:v32 forAssetSetIdentifier:v33 forAtomicInstanceUUID:v34 fromModule:@"AUTO-CONTROL" fromLocation:@"trackShortTermLockedSetDescriptor"];
}

- (BOOL)removeShortTermLockingOfSetDescriptor:(id)a3 forSetDescriptor:(id)a4 endingAll:(BOOL)a5 performingHardEliminate:(BOOL)a6 error:(id *)a7
{
  v94 = a3;
  v106 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:removeShortTermLockingOfSetDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &state);

  v107 = [[NSString alloc] initWithFormat:@"%@:removeShortTermLockingOfSetDescriptor", v94];
  v12 = [v106 clientDomainName];
  v13 = [v106 assetSetIdentifier];
  v95 = [(MADAutoAssetControlManager *)self latestShortTermLockableAtomicInstanceForClientDomain:v12 forAssetSetIdentifier:v13];

  if (!v95)
  {
    v22 = 0;
    v24 = 1;
    goto LABEL_77;
  }

  v104 = +[NSFileManager defaultManager];
  v97 = objc_alloc_init(NSMutableArray);
  v96 = objc_alloc_init(NSMutableArray);
  v14 = [v106 clientDomainName];
  v15 = [v106 assetSetIdentifier];
  v92 = [(MADAutoAssetControlManager *)self setLockUsageMapForClientDomain:v14 forSetIdentifier:v15];

  v16 = [v106 clientDomainName];
  v17 = [v106 assetSetIdentifier];
  v105 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v16 forAssetSetIdentifier:v17];

  if (!v92)
  {
    v23 = 0;
    v22 = 0;
    v24 = 1;
LABEL_40:
    v35 = v106;
    goto LABEL_41;
  }

  v18 = [v106 latestDownloadedAtomicInstance];
  v19 = [(MADAutoAssetControlManager *)self setLockUsageMapForAtomicInstance:v18 clientLockUsageMap:v92 lockReason:0];

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    v21 = [v106 summary];
    *buf = 138544130;
    v129 = v107;
    v130 = 1024;
    *v131 = v19;
    *&v131[4] = 2114;
    *&v131[6] = v95;
    *&v131[14] = 2114;
    *&v131[16] = v21;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} from clientLockUsageMap, currently held standard locks:%d | latestShortTermLockableAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x26u);
  }

  if (v19 > 1)
  {
    v22 = 0;
    v91 = 0;
    v23 = 0;
    v24 = 1;
LABEL_65:
    v35 = v106;
    goto LABEL_67;
  }

  v123 = 0u;
  v124 = 0u;
  v121 = 0u;
  v122 = 0u;
  v25 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
  v26 = [v25 countByEnumeratingWithState:&v121 objects:v133 count:16];
  if (v26)
  {
    v27 = *v122;
    do
    {
      for (i = 0; i != v26; i = i + 1)
      {
        if (*v122 != v27)
        {
          objc_enumerationMutation(v25);
        }

        v29 = *(*(&v121 + 1) + 8 * i);
        v30 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
        v31 = [v30 safeObjectForKey:v29 ofClass:objc_opt_class()];

        if (v29)
        {
          if ([SUCore stringIsEqual:v31 to:v105])
          {
            v32 = [v106 latestDownloadedAtomicInstance];
            v33 = [SUCore stringIsEqual:v29 to:v32];

            if (v33)
            {
              [v97 addObject:v29];
            }
          }
        }
      }

      v26 = [v25 countByEnumeratingWithState:&v121 objects:v133 count:16];
    }

    while (v26);
  }

  v34 = [v97 count];
  v23 = 0;
  v24 = v34 == 0;
  v35 = v106;
  v22 = 0;
  if (v34 && !a6)
  {
    v119 = 0u;
    v120 = 0u;
    v117 = 0u;
    v118 = 0u;
    obj = v97;
    v36 = [obj countByEnumeratingWithState:&v117 objects:v132 count:16];
    v23 = 0;
    if (v36)
    {
      v102 = *v118;
      while (2)
      {
        v37 = v36;
        for (j = 0; j != v37; j = j + 1)
        {
          if (*v118 != v102)
          {
            objc_enumerationMutation(obj);
          }

          v39 = *(*(&v117 + 1) + 8 * j);
          v40 = [v106 clientDomainName];
          v41 = [v106 assetSetIdentifier];
          v42 = [MANAutoAssetSetStatus shortTermLockFilename:v40 forAssetSetIdentifier:v41 forSetAtomicInstance:v39];

          v116 = v23;
          v43 = [(MADAutoAssetControlManager *)self _shortTermSharedLockOpenExclusive:v107 forSetDescriptor:v106 atomicInstanceFilename:v42 error:&v116];
          v44 = v116;

          v23 = v44;
          if (v43)
          {
            [v96 addObject:v43];
          }

          else
          {
            if ([v44 code] == "/System/Library/PrivateFrameworks/MobileInBoxUpdate.framework/MobileInBoxUpdate")
            {
              v48 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
              {
                v49 = [v106 summary];
                *buf = 138543874;
                v129 = v107;
                v130 = 2114;
                *v131 = v39;
                *&v131[8] = 2114;
                *&v131[10] = v49;
                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} unable to end SHORT-TERM locking (shared lock held) | nextAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
              }

              v23 = v44;
              v22 = v23;
              goto LABEL_39;
            }

            v45 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
            {
              v46 = [v106 summary];
              v47 = [v23 checkedDescription];
              *buf = 138544130;
              v129 = v107;
              v130 = 2114;
              *v131 = v39;
              *&v131[8] = 2114;
              *&v131[10] = v46;
              *&v131[18] = 2114;
              *&v131[20] = v47;
              _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} unable to end SHORT-TERM locking (considering as no shared locks) | nextAtomicInstance:%{public}@ | setDescriptor:%{public}@ | underlyingError:%{public}@", buf, 0x2Au);
            }
          }
        }

        v36 = [obj countByEnumeratingWithState:&v117 objects:v132 count:16];
        if (v36)
        {
          continue;
        }

        break;
      }
    }

    v22 = 0;
LABEL_39:

    v24 = 0;
    goto LABEL_40;
  }

LABEL_41:
  if (!v22)
  {
    v50 = [v35 clientDomainName];
    v51 = [v35 assetSetIdentifier];
    v52 = [MANAutoAssetSetStatus shortTermLockFilename:v50 forAssetSetIdentifier:v51 forSetAtomicInstance:0];

    v53 = [v106 latestDownloadedAtomicInstance];
    v91 = [SUCore stringIsEqual:v53 to:v95];

    if (v91)
    {
      v90 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:v107 removingSharedLockFilename:v52 usingFileManager:v104 removingDescription:@"atomic-instance shared lock file (no other atomic-instance supporting SHORT-TERM locking)"];

      if (v105)
      {
        v54 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
        [v54 removeObjectForKey:v105];

        v55 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
        {
          v56 = [v106 summary];
          *buf = 138543874;
          v129 = v107;
          v130 = 2114;
          *v131 = v105;
          *&v131[8] = 2114;
          *&v131[10] = v56;
          _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{%{public}@} no longer supporting SHORT-TERM locking | shortTermLockedKey:%{public}@ | otherSetDescriptor:%{public}@", buf, 0x20u);
        }
      }
    }

    else
    {
      v90 = v23;
    }

    v22 = 0;
    v24 = 1;
    v35 = v106;
    if (!v106 || !v105)
    {
      v23 = v90;
      goto LABEL_67;
    }

    v114 = 0u;
    v115 = 0u;
    v112 = 0u;
    v113 = 0u;
    v98 = v97;
    v57 = [v98 countByEnumeratingWithState:&v112 objects:v127 count:16];
    if (v57)
    {
      obja = *v113;
      do
      {
        v103 = v57;
        for (k = 0; k != v103; k = k + 1)
        {
          if (*v113 != obja)
          {
            objc_enumerationMutation(v98);
          }

          v59 = *(*(&v112 + 1) + 8 * k);
          v60 = [v35 clientDomainName];
          v61 = [v35 assetSetIdentifier];
          v62 = [MANAutoAssetSetStatus shortTermLockFilename:v60 forAssetSetIdentifier:v61 forSetAtomicInstance:v59];

          v63 = [v106 clientDomainName];
          v64 = [v106 assetSetIdentifier];
          v65 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v63 forAssetSetIdentifier:v64];

          v66 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
          v67 = [v66 safeObjectForKey:v105 ofClass:objc_opt_class()];

          v68 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:v107 removingSharedLockFilename:v62 usingFileManager:v104 removingDescription:@"atomic-instance shared lock file (just removed from supporting SHORT-TERM locking)"];
          [(MADAutoAssetControlManager *)self _shortTermChangeAtomicInstance:v107 forAtomicInstance:v59 toShortTermSupported:0];
          v69 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
          [v69 removeObjectForKey:v59];

          if ([SUCore stringIsEqual:v59 to:v67])
          {
            v70 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
            [v70 removeObjectForKey:v65];

            v71 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543618;
              v129 = v107;
              v130 = 2114;
              *v131 = v65;
              _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{%{public}@} removed latest | shortTermLatestLockedKey:%{public}@", buf, 0x16u);
            }
          }

          v72 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v72, OS_LOG_TYPE_DEFAULT))
          {
            v73 = [v106 summary];
            *buf = 138543874;
            v129 = v107;
            v130 = 2114;
            *v131 = v59;
            *&v131[8] = 2114;
            *&v131[10] = v73;
            _os_log_impl(&dword_0, v72, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} no longer supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
          }

          v35 = v106;
        }

        v57 = [v98 countByEnumeratingWithState:&v112 objects:v127 count:16];
      }

      while (v57);
    }

    v22 = 0;
    v24 = 1;
    v23 = v90;
    goto LABEL_65;
  }

  v91 = 0;
LABEL_67:
  v74 = v23;
  v110 = 0u;
  v111 = 0u;
  v108 = 0u;
  v109 = 0u;
  v75 = v96;
  v76 = [v75 countByEnumeratingWithState:&v108 objects:v126 count:16];
  if (v76)
  {
    v77 = *v109;
    do
    {
      for (m = 0; m != v76; m = m + 1)
      {
        if (*v109 != v77)
        {
          objc_enumerationMutation(v75);
        }

        [(MADAutoAssetControlManager *)self _shortTermSharedLockClose:v107 forSetDescriptor:v35 atomicInstanceFileDescriptor:*(*(&v108 + 1) + 8 * m)];
      }

      v76 = [v75 countByEnumeratingWithState:&v108 objects:v126 count:16];
    }

    while (v76);
  }

  v79 = v74;
  if (v91)
  {
    v80 = [v106 clientDomainName];
    v81 = [v106 assetSetIdentifier];
    v82 = [MANAutoAssetSetStatus shortTermLockDirectory:v80 forAssetSetIdentifier:v81];

    v83 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:v107 removingSharedLockFilename:v82 usingFileManager:v104 removingDescription:@"atomic-instance shared lock directory (no more SHORT-TERM locking support for the set-identifier)"];

    v79 = v83;
  }

LABEL_77:
  if (a7)
  {
    v84 = v22;
    *a7 = v22;
  }

  if (v22)
  {
    v85 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v85, OS_LOG_TYPE_ERROR))
    {
      v86 = [v22 checkedDescription];
      v87 = [v106 summary];
      *buf = 138543874;
      v129 = v107;
      v130 = 2114;
      *v131 = v86;
      *&v131[8] = 2114;
      *&v131[10] = v87;
      _os_log_impl(&dword_0, v85, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} ERROR removing SHORT-TERM locking | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
    }
  }

  else
  {
    v85 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v85, OS_LOG_TYPE_DEFAULT))
    {
      v88 = [v106 summary];
      *buf = 138543618;
      v129 = v107;
      v130 = 2114;
      *v131 = v88;
      _os_log_impl(&dword_0, v85, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} SUCCESS removing SHORT-TERM locking | setDescriptor:%{public}@", buf, 0x16u);
    }
  }

  os_activity_scope_leave(&state);
  return v24;
}

- (id)_shortTermSharedLockOpenExclusive:(id)a3 forSetDescriptor:(id)a4 atomicInstanceFilename:(id)a5 error:(id *)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [[NSString alloc] initWithFormat:@"%@:_shortTermSharedLockOpenExclusive", v10];
  v16 = open([v12 UTF8String], 36);
  if ((v16 & 0x80000000) != 0)
  {
    v21 = [[NSString alloc] initWithFormat:@"{%@} unable to obtain exclusive lock | errno:%d | atomicInstanceFilename:%@", v15, *__error(), v12];
    v18 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v15 code:6584 description:v21 forSetDescriptor:v11 underlyingError:0];

    if (!v18)
    {
      goto LABEL_4;
    }
  }

  else
  {
    v17 = [[NSNumber alloc] initWithInteger:v16];
    if (v17)
    {
LABEL_5:
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        v20 = [v11 summary];
        *buf = 138544130;
        v27 = v15;
        v28 = 1024;
        v29 = v16;
        v30 = 2114;
        v31 = v12;
        v32 = 2114;
        v33 = v20;
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@} SUCCESS(%d) | atomicInstanceFilename:%{public}@ | setDescriptor:%{public}@", buf, 0x26u);
      }

      v18 = 0;
      goto LABEL_12;
    }

    [(MADAutoAssetControlManager *)self _shortTermSharedLockClose:v10 forSetDescriptor:v11 atomicInstanceFileDescriptor:0];
    v18 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v15 code:6584 description:@"insufficient memory to perform removal" forSetDescriptor:v11 underlyingError:0];
    if (!v18)
    {
LABEL_4:
      v17 = 0;
      goto LABEL_5;
    }
  }

  v19 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
  {
    v22 = [v18 checkedDescription];
    v23 = [v11 summary];
    *buf = 138544386;
    v27 = v15;
    v28 = 1024;
    v29 = v16;
    v30 = 2114;
    v31 = v12;
    v32 = 2114;
    v33 = v22;
    v34 = 2114;
    v35 = v23;
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@} ERROR(%d) | atomicInstanceFilename:%{public}@ | returnedError:%{public}@ | setDescriptor:%{public}@", buf, 0x30u);
  }

  v17 = 0;
LABEL_12:

  if (a6)
  {
    v24 = v18;
    *a6 = v18;
  }

  return v17;
}

- (void)_shortTermSharedLockClose:(id)a3 forSetDescriptor:(id)a4 atomicInstanceFileDescriptor:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [v10 intValue];
  if (close(v13))
  {
    v14 = *__error();
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
    {
      v16 = [v9 summary];
      v21 = 138544130;
      v22 = v8;
      v23 = 1024;
      v24 = v13;
      v25 = 1024;
      LODWORD(v26[0]) = v14;
      WORD2(v26[0]) = 2114;
      *(v26 + 6) = v16;
      v17 = "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@:_shortTermSharedLockClose} ERROR(%d) | errno:%d | setDescriptor:%{public}@";
      v18 = v15;
      v19 = OS_LOG_TYPE_ERROR;
      v20 = 34;
LABEL_6:
      _os_log_impl(&dword_0, v18, v19, v17, &v21, v20);
    }
  }

  else
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      v16 = [v9 summary];
      v21 = 138543874;
      v22 = v8;
      v23 = 1024;
      v24 = v13;
      v25 = 2114;
      v26[0] = v16;
      v17 = "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@:_shortTermSharedLockClose} SUCCESS(%d) | setDescriptor:%{public}@";
      v18 = v15;
      v19 = OS_LOG_TYPE_DEFAULT;
      v20 = 28;
      goto LABEL_6;
    }
  }
}

- (id)_shortTermCreateSymbolicLink:(id)a3 symbolicLinkFilename:(id)a4 linkedToFilename:(id)a5 forSetDescriptor:(id)a6 usingFileManager:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v51 = self;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v55 = 0;
  v19 = [v16 destinationOfSymbolicLinkAtPath:v13 error:&v55];
  v20 = v55;
  v21 = v20;
  if (!v19)
  {
    if (v20 && [v20 code] != &stru_B8.reserved3)
    {
      v19 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
      v22 = [[NSString alloc] initWithFormat:@"Failed to get information about current symbolic link for SHORT-TERM locking latest %@", v13];
      v23 = [(MADAutoAssetControlManager *)v51 buildShortTermLockError:v19 code:6583 description:v22 forSetDescriptor:v15 underlyingError:v21];
      goto LABEL_33;
    }

    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v57 = v12;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} No SHORT-TERM locking latest symlink exists yet. Creating", buf, 0xCu);
    }

    v54 = 0;
    v25 = [v16 createSymbolicLinkAtPath:v13 withDestinationPath:v14 error:&v54];
    v21 = v54;
    if (v25)
    {
      goto LABEL_21;
    }

    v26 = v12;
    v27 = v15;
    v28 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
    v29 = [[NSString alloc] initWithFormat:@"Unable to create symbolic link for SHORT-TERM locking latest | %@ >=> %@", v13, v14];
    v50 = v27;
    v30 = [(MADAutoAssetControlManager *)v51 buildShortTermLockError:v28 code:6583 description:v29 forSetDescriptor:v27 underlyingError:v21];
    goto LABEL_19;
  }

  if (![SUCore stringIsEqual:v19 to:v14])
  {
    v50 = v15;

    v31 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v57 = v12;
      v58 = 2114;
      v59 = v19;
      v60 = 2114;
      v61 = v14;
      _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} latest symlink currently pointed to target: %{public}@, but it is not the requested target: %{public}@.  Updating symlink.", buf, 0x20u);
    }

    v32 = [v13 stringByDeletingLastPathComponent];
    v28 = [v32 stringByAppendingPathComponent:@"tmpSymlink"];

    v53 = 0;
    LOBYTE(v32) = [v16 createSymbolicLinkAtPath:v28 withDestinationPath:v14 error:&v53];
    v21 = v53;
    if (v32)
    {
      v33 = [v28 UTF8String];
      v34 = [v13 UTF8String];
      rename(v33, v34, v35);
      if (!v36)
      {
        v30 = 0;
LABEL_20:

        v15 = v50;
        if (v30)
        {
LABEL_32:
          v23 = v30;
          v22 = v19;
          v19 = v23;
          goto LABEL_33;
        }

LABEL_21:

        v52 = 0;
        v19 = [v16 destinationOfSymbolicLinkAtPath:v13 error:&v52];
        v21 = v52;
        if (v21 || !v19)
        {
          v46 = v15;
          v44 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
          v47 = [[NSString alloc] initWithFormat:@"After SHORT-TERM locking latest symlink is created, failed to get the destination. %@ >=> %@", v13, v14];
          v43 = v46;
          v30 = [(MADAutoAssetControlManager *)v51 buildShortTermLockError:v44 code:6583 description:v47 forSetDescriptor:v46 underlyingError:v21];
        }

        else
        {
          v43 = v15;
          if ([SUCore stringIsEqual:v19 to:v14])
          {
            v44 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
            {
              v45 = [v43 summary];
              *buf = 138544130;
              v57 = v12;
              v58 = 2114;
              v59 = v13;
              v60 = 2114;
              v61 = v14;
              v62 = 2114;
              v63 = v45;
              _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} created SHORT-TERM locking symlink | %{public}@ >=> %{public}@ | setDescriptor:%{public}@", buf, 0x2Au);
            }

            v30 = 0;
          }

          else
          {
            v44 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
            v48 = [[NSString alloc] initWithFormat:@"After SHORT-TERM locking latest symlink is created, target is not the expected destination. Expected destination: %@. Current destination: %@", v14, v19];
            v30 = [(MADAutoAssetControlManager *)v51 buildShortTermLockError:v44 code:6583 description:v48 forSetDescriptor:v43 underlyingError:0];
          }

          v21 = 0;
        }

        v15 = v43;
        goto LABEL_32;
      }

      v26 = v12;
      v29 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
      v37 = [[NSString alloc] initWithFormat:@"Failed to rename temporary symbolic link for SHORT-TERM locking to final name %@ >=> %@.  Errno: %d", v28, v13, *__error()];
      v39 = v50;
      v38 = v51;
      v40 = v29;
      v41 = v37;
      v42 = 0;
    }

    else
    {
      v26 = v12;
      v29 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", v12];
      v37 = [[NSString alloc] initWithFormat:@"Unable to create temporary symbolic link for SHORT-TERM locking latest %@", v28];
      v39 = v50;
      v38 = v51;
      v40 = v29;
      v41 = v37;
      v42 = v21;
    }

    v30 = [(MADAutoAssetControlManager *)v38 buildShortTermLockError:v40 code:6583 description:v41 forSetDescriptor:v39 underlyingError:v42];

LABEL_19:
    v12 = v26;
    goto LABEL_20;
  }

  v22 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v57 = v12;
    v58 = 2114;
    v59 = v14;
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} latest symlink already pointed to requested target file: %{public}@.  No change needed", buf, 0x16u);
  }

  v23 = 0;
LABEL_33:

  return v23;
}

- (id)_shortTermPersistSetStatus:(id)a3 forSetDescriptor:(id)a4 persistingSetStatus:(id)a5 toFilename:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MASAutoAssetSetStatus newShimmedToFramework:v12];
  if (!v16)
  {
    v23 = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", v10];
    v24 = [NSString alloc];
    v25 = [v12 summary];
    v26 = [v24 initWithFormat:@"unable to create shimmed set-status to write to shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", v13, v25];
    v27 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v23 code:6583 description:v26 forSetDescriptor:v11 underlyingError:0];

    goto LABEL_14;
  }

  v17 = [SUCorePersistedState alloc];
  v18 = objc_opt_respondsToSelector();

  v19 = [SUCorePersistedState alloc];
  v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v21 = [v20 extendedStateQueue];
  if (v18)
  {
    v22 = [v19 initWithDispatchQueue:v21 withPersistencePath:v13 forPolicyVersion:@"1.0" issuingDefaultLevelLogging:0];
  }

  else
  {
    v22 = [v19 initWithDispatchQueue:v21 withPersistencePath:v13 forPolicyVersion:@"1.0"];
  }

  v23 = v22;

  if (!v23)
  {
    v31 = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", v10];
    v32 = [NSString alloc];
    v33 = [v12 summary];
    v34 = [v32 initWithFormat:@"unable to create persisted-state for shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", v13, v33];
LABEL_13:
    v36 = v34;
    v27 = [(MADAutoAssetControlManager *)self buildShortTermLockError:v31 code:6583 description:v34 forSetDescriptor:v11 underlyingError:0];

    goto LABEL_14;
  }

  if (![v23 loadPersistedState])
  {
    v31 = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", v10];
    v35 = [NSString alloc];
    v33 = [v12 summary];
    v34 = [v35 initWithFormat:@"unable to load persisted-state for shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", v13, v33];
    goto LABEL_13;
  }

  [v23 persistString:@"SHORT-TERM" forKey:@"lockerType" shouldPersist:0];
  [v23 persistSecureCodedObject:v16 forKey:@"sharedLockSetStatus" shouldPersist:1];
  v28 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
  {
    v29 = [v11 summary];
    v30 = [v12 summary];
    *buf = 138544130;
    v39 = v10;
    v40 = 2114;
    v41 = v13;
    v42 = 2114;
    v43 = v29;
    v44 = 2114;
    v45 = v30;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][FILE]{%{public}@} attempted to persist SHORT-TERM atomic-instance file | filename:%{public}@ | setDescriptor:%{public}@ | setStatus:%{public}@ ", buf, 0x2Au);
  }

  v27 = 0;
LABEL_14:

  return v27;
}

- (id)_shortTermSharedLockRemove:(id)a3 removingSharedLockFilename:(id)a4 usingFileManager:(id)a5 removingDescription:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a6;
  v13 = a5;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v24 = 0;
  [v13 removeItemAtPath:v11 error:&v24];

  v16 = v24;
  v17 = v16;
  if (!v16)
  {
    v19 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_10;
    }

    *buf = 138543874;
    v26 = v10;
    v27 = 2114;
    v28 = v12;
    v29 = 2114;
    v30 = v11;
    v21 = "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} removed %{public}@ | sharedLockFilename:%{public}@";
    goto LABEL_7;
  }

  v18 = [v16 code];
  v19 = _MADLog(@"AutoControl");
  v20 = os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT);
  if (v18 == &dword_0 + 2)
  {
    if (!v20)
    {
      goto LABEL_10;
    }

    *buf = 138543874;
    v26 = v10;
    v27 = 2114;
    v28 = v12;
    v29 = 2114;
    v30 = v11;
    v21 = "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} attempted to remove %{public}@ [did not exist] | sharedLockFilename:%{public}@";
LABEL_7:
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, v21, buf, 0x20u);
    goto LABEL_10;
  }

  if (v20)
  {
    v22 = [v17 checkedDescription];
    *buf = 138544130;
    v26 = v10;
    v27 = 2114;
    v28 = v12;
    v29 = 2114;
    v30 = v11;
    v31 = 2114;
    v32 = v22;
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} WARNING unable to remove %{public}@ | sharedLockFilename:%{public}@ | removeError:%{public}@", buf, 0x2Au);
  }

LABEL_10:

  return v17;
}

- (void)_shortTermChangeAtomicInstance:(id)a3 forAtomicInstance:(id)a4 toShortTermSupported:(BOOL)a5
{
  v5 = a5;
  v8 = a4;
  v9 = a3;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:_shortTermChangeAtomicInstance", v9];
  if (v8)
  {
    v13 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v8];
    if (v13)
    {
      v14 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v13];
      v15 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [v15 persistedEntry:v14 fromLocation:v12];

      if (v16)
      {
        [v13 setLockedSupportingShortTermLocking:v5];
        v17 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v18 = [v13 atomicInstanceUUID];
        [v17 setSafeObject:v13 forKey:v18];

        [v16 persistSecureCodedObject:v13 forKey:@"setAtomicInstance"];
        v19 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v20 = [v13 summary];
        [v19 storePersistedEntry:v14 withEntrySummary:v20 fromLocation:v12];

        v21 = [NSString alloc];
        if (v5)
        {
          v22 = @"Y";
        }

        else
        {
          v22 = @"N";
        }

        v23 = [v13 summary];
        v24 = [v21 initWithFormat:@"SHORT-TERM behavior change | supportingShortTermLocking:%@ | setAtomicInstance:%@", v22, v23];
        [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstance:v12 operation:@"ENTRY_MODIFY" forPersistedEntryID:v14 withSetAtomicInstance:v13 message:v24];
      }

      else
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v27 = v12;
          v28 = 2114;
          v29 = v8;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} WARNING unable to load atomic-instance persisted-state entry | atomicInstance:%{public}@", buf, 0x16u);
        }
      }
    }

    else
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543618;
        v27 = v12;
        v28 = 2114;
        v29 = v8;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} no atomic-instance tracked | atomicInstance:%{public}@", buf, 0x16u);
      }
    }
  }

  else
  {
    v13 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v27 = v12;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} no atomic-instance provided", buf, 0xCu);
    }
  }
}

- (void)_shortTermForceForget:(id)a3 forSetDescriptor:(id)a4
{
  v14 = a4;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v14 clientDomainName];
  v8 = [v14 assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v8];

  v10 = [v14 latestDownloadedAtomicInstance];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
    v12 = [v14 latestDownloadedAtomicInstance];
    [v11 removeObjectForKey:v12];
  }

  if (v9)
  {
    v13 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
    [v13 removeObjectForKey:v9];
  }
}

- (id)buildShortTermLockError:(id)a3 code:(int64_t)a4 description:(id)a5 forSetDescriptor:(id)a6 underlyingError:(id)a7
{
  v33 = a5;
  v32 = a7;
  v11 = a6;
  v30 = a3;
  v12 = [v11 clientDomainName];
  v13 = [v11 assetSetIdentifier];
  v14 = [MANAutoAssetSetStatus shortTermLockFilename:v12 forAssetSetIdentifier:v13 forSetAtomicInstance:0];

  v15 = [v11 clientDomainName];
  v16 = [v11 assetSetIdentifier];
  v17 = [v11 latestDownloadedAtomicInstance];
  v18 = [MANAutoAssetSetStatus shortTermLockFilename:v15 forAssetSetIdentifier:v16 forSetAtomicInstance:v17];

  v19 = [v11 latestDownloadedAtomicInstance];
  v20 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v19];

  v21 = [NSString alloc];
  v22 = [v11 summary];

  v23 = @"N";
  if (v18)
  {
    v24 = v18;
  }

  else
  {
    v24 = @"N";
  }

  if (v14)
  {
    v25 = @"Y";
  }

  else
  {
    v25 = @"N";
  }

  if (v20)
  {
    v23 = [v20 summary];
  }

  if (v32)
  {
    v26 = [v32 checkedDescription];
  }

  else
  {
    v26 = @"N";
  }

  v27 = [v21 initWithFormat:@"%@ | setDescriptor:%@ | atomicInstanceFilename:%@ | latest:%@ | setDescriptorCurrentStatus:%@ | error:%@", v33, v22, v24, v25, v23, v26];
  v28 = [MAAutoAssetError buildError:a4 fromOperation:v30 underlyingError:v32 withDescription:v27];

  if (v32)
  {
  }

  if (v20)
  {
  }

  return v28;
}

- (BOOL)isShortTermLockableSetDescriptor:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 latestDownloadedAtomicInstance];

  if (v7)
  {
    v8 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
    v9 = [v4 latestDownloadedAtomicInstance];
    v10 = [v8 safeObjectForKey:v9 ofClass:objc_opt_class()];

    v11 = v10 != 0;
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (id)latestShortTermLockableAtomicInstanceForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v6];
  v11 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
  v12 = [v11 safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)newSetInfoLimitedToCheckInformation:(id)a3 forAssetSetIdentifier:(id)a4 fromSetInfoFound:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v67 = v9;
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v8 forAssetSetIdentifier:v9];
  v14 = [v13 latestAtomicInstanceToVend];

  if (v14)
  {
    v15 = [v13 latestAtomicInstanceToVend];
    v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"newSetInfoLimitedToCheckInformation" forAtomicInstanceUUID:v15 requireExists:1];

    v17 = v16 != 0;
  }

  else
  {
    v17 = 0;
  }

  v49 = [MANAutoAssetSetStatus alloc];
  v54 = [v10 currentSetStatus];
  v18 = [v54 configuredAssetEntries];
  v53 = [v10 currentSetStatus];
  v65 = [v53 atomicInstancesDownloaded];
  v64 = [v13 mostRecentlyReceivedCachedAssetSetID];
  v63 = [v13 mostRecentlyReceivedDownloadedFromLive];
  v62 = [v13 mostRecentlyReceivedLastTimeChecked];
  v61 = [v13 mostRecentlyReceivedPostedDate];
  v52 = [v10 currentSetStatus];
  v60 = [v52 newerAtomicInstanceDiscovered];
  v51 = [v10 currentSetStatus];
  v50 = [v51 newerDiscoveredAtomicEntries];
  v59 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:?];
  v66 = v18;
  if (v17)
  {
    v31 = [v10 currentSetStatus];
    v57 = [v31 latestDownloadedAtomicInstance];
    v47 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v30 = [v10 currentSetStatus];
    v29 = [v30 latestDowloadedAtomicInstanceEntries];
    v56 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:?];
  }

  else
  {
    v47 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v56 = 0;
    v57 = 0;
  }

  v58 = [v13 latestToVendCachedAssetSetID];
  v44 = [v13 latestToVendDownloadedFromLive];
  v43 = [v13 latestToVendLastTimeChecked];
  v42 = [v13 latestToVendPostedDate];
  v46 = [v10 currentSetStatus];
  v34 = [v46 currentNotifications];
  v39 = [MADAutoAssetScheduler newSetPolicyForDomainName:v8 forAssetSetIdentifier:v67];
  v38 = +[MADAutoAssetControlManager stagerSetPolicy];
  v36 = [v13 haveReceivedLookupResponse];
  v35 = [v13 vendingAtomicInstanceForConfiguredEntries];
  v45 = [v10 currentSetStatus];
  v33 = [v45 downloadUserInitiated];
  v41 = [v10 currentSetStatus];
  v32 = [v41 downloadProgress];
  v40 = [v10 currentSetStatus];
  v19 = [v40 downloadedNetworkBytes];
  v37 = [v10 currentSetStatus];
  v20 = [v37 downloadedFilesystemBytes];
  v55 = v10;
  v21 = [v10 currentSetStatus];
  v22 = [v21 currentLockUsage];
  v23 = [v13 availableForUseError];
  v24 = [v13 newerVersionError];
  BYTE2(v28) = v33;
  BYTE1(v28) = v35;
  LOBYTE(v28) = v36;
  LOBYTE(v27) = v47;
  v48 = [MANAutoAssetSetStatus initStatusForClientDomain:v49 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v62 withAtomicInstancesDownloaded:v61 withCatalogCachedAssetSetID:v60 withCatalogDownloadedFromLive:v59 withCatalogLastTimeChecked:v57 withCatalogPostedDate:v27 withNewerAtomicInstanceDiscovered:v56 withNewerDiscoveredAtomicEntries:v58 withLatestDownloadedAtomicInstance:v44 withLatestDownloadedAtomicInstanceFromPreSUStaging:v43 withLatestDowloadedAtomicInstanceEntries:v42 withDownloadedCatalogCachedAssetSetID:v34 withDownloadedCatalogDownloadedFromLive:0 withDownloadedCatalogLastTimeChecked:v39 withDownloadedCatalogPostedDate:v38 withCurrentNotifications:v28 withCurrentNeedPolicy:v32 withSchedulerPolicy:v19 withStagerPolicy:v20 havingReceivedLookupResponse:v22 vendingAtomicInstanceForConfiguredEntries:0 withDownloadUserInitiated:v23 withDownloadProgress:v24 withDownloadedNetworkBytes:? withDownloadedFilesystemBytes:? withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];

  if (v17)
  {
  }

  v25 = [[MANAutoAssetSetInfoFound alloc] initForAssetSetIdentifier:v67 reportingStatus:v48];
  return v25;
}

- (id)setDescriptorNewEntryIDForDownloaded:(id)a3
{
  v4 = a3;
  v5 = [v4 clientDomainName];
  v6 = [v4 assetSetIdentifier];
  v7 = [v4 latestDownloadedAtomicInstance];

  v8 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v5 forAssetSetIdentifier:v6 ofAtomicInstance:v7];

  return v8;
}

- (id)newSetDescriptorLimitedToCheckInformation:(id)a3
{
  if (!a3)
  {
    return 0;
  }

  v4 = a3;
  v5 = [v4 copy];
  v6 = [v4 discoveredAtomicEntries];
  v7 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:v6];
  [v5 setDiscoveredAtomicEntries:v7];

  v8 = [v4 latestDowloadedAtomicInstanceEntries];

  v9 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:v8];
  [v5 setLatestDowloadedAtomicInstanceEntries:v9];

  return v5;
}

- (void)setDescriptorEliminateMatching:(id)a3 forClientDomainName:(id)a4 forAssetSetIdentifier:(id)a5 eliminatingSetIdentifer:(BOOL)a6
{
  context = a6;
  v9 = a3;
  v10 = a4;
  v11 = a5;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v95 = v9;
  v14 = [[NSString alloc] initWithFormat:@"%@:setDescriptorEliminateMatching", v9];
  v15 = objc_alloc_init(NSMutableArray);
  v94 = +[NSFileManager defaultManager];
  v83 = v11;
  v84 = v10;
  v16 = v11;
  v17 = v14;
  v18 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v10 assetSetIdentifier:v16];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v14 ofContainer:@"setDescriptorKeysForAssetSet"];
  v111 = 0u;
  v112 = 0u;
  v109 = 0u;
  v110 = 0u;
  obj = v18;
  v19 = [obj countByEnumeratingWithState:&v109 objects:v122 count:16];
  if (v19)
  {
    v20 = v19;
    v21 = *v110;
    do
    {
      for (i = 0; i != v20; i = i + 1)
      {
        if (*v110 != v21)
        {
          objc_enumerationMutation(obj);
        }

        v23 = *(*(&v109 + 1) + 8 * i);
        v24 = objc_autoreleasePoolPush();
        v25 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:v17 forKey:v23];
        if (v25)
        {
          [v15 addObject:v25];
        }

        objc_autoreleasePoolPop(v24);
      }

      v20 = [obj countByEnumeratingWithState:&v109 objects:v122 count:16];
    }

    while (v20);
  }

  v93 = v17;

  v107 = 0u;
  v108 = 0u;
  v105 = 0u;
  v106 = 0u;
  v86 = v15;
  v26 = [v86 countByEnumeratingWithState:&v105 objects:v121 count:16];
  v96 = self;
  if (v26)
  {
    v27 = v26;
    v28 = *v106;
    do
    {
      for (j = 0; j != v27; j = j + 1)
      {
        if (*v106 != v28)
        {
          objc_enumerationMutation(v86);
        }

        v30 = *(*(&v105 + 1) + 8 * j);
        v31 = [v30 latestDownloadedAtomicInstance];
        if (v31)
        {
          [v30 latestDownloadedAtomicInstance];
        }

        else
        {
          [v30 discoveredAtomicInstance];
        }
        v32 = ;

        v33 = [v30 clientDomainName];
        v34 = [v30 assetSetIdentifier];
        v35 = [MANAutoAssetSetStatus shortTermLockFilename:v33 forAssetSetIdentifier:v34 forSetAtomicInstance:v32];

        self = v96;
        [(MADAutoAssetControlManager *)v96 removeSetDescriptorDownloaded:v30 fromLocation:v95 checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:327 historyOperationSD:371];
        v36 = [(MADAutoAssetControlManager *)v96 _shortTermSharedLockRemove:@"setDescriptorEliminateMatching" removingSharedLockFilename:v35 usingFileManager:v94 removingDescription:@"atomic-instance shared lock removed (eliminated set-identifier)"];
      }

      v27 = [v86 countByEnumeratingWithState:&v105 objects:v121 count:16];
    }

    while (v27);
  }

  v37 = v93;
  if (!context)
  {
    goto LABEL_62;
  }

  v38 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v39 = [v38 persistedEntryIDs:@"setDescriptorEliminate"];

  if (![v39 count])
  {
    goto LABEL_61;
  }

  v88 = objc_alloc_init(NSMutableArray);
  v101 = 0u;
  v102 = 0u;
  v103 = 0u;
  v104 = 0u;
  v80 = v39;
  contexta = v39;
  v40 = [contexta countByEnumeratingWithState:&v101 objects:v120 count:16];
  if (v40)
  {
    v41 = v40;
    v42 = *v102;
    v81 = *v102;
    do
    {
      v43 = 0;
      v85 = v41;
      do
      {
        if (*v102 != v42)
        {
          objc_enumerationMutation(contexta);
        }

        v44 = *(*(&v101 + 1) + 8 * v43);
        v45 = objc_autoreleasePoolPush();
        if (v44)
        {
          v46 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          v47 = [v46 persistedEntry:v44 fromLocation:v93];

          if (v47)
          {
            v48 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v49 = [v48 decodeFromLocation:v93 ofEntryName:v44 fromPersistedEntry:v47 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v49)
            {
              v50 = [v49 clientDomainName];
              if (([SUCore stringIsEqual:v50 to:v84]& 1) != 0)
              {
                v51 = [v49 assetSetIdentifier];
                v52 = [SUCore stringIsEqual:v51 to:v83];

                self = v96;
                if (v52)
                {
                  v53 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                  {
                    *buf = 138543874;
                    v115 = v93;
                    v116 = 2114;
                    v117 = v84;
                    v118 = 2114;
                    v119 = v83;
                    v54 = v53;
                    v55 = OS_LOG_TYPE_DEFAULT;
                    v56 = "\n[SET-ELIMINATE]{%{public}@} matched set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@";
                    goto LABEL_41;
                  }

                  goto LABEL_42;
                }
              }

              else
              {
              }
            }

            else
            {
              v53 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543874;
                v115 = v93;
                v116 = 2114;
                v117 = v84;
                v118 = 2114;
                v119 = v83;
                v54 = v53;
                v55 = OS_LOG_TYPE_ERROR;
                v56 = "\n[SET-ELIMINATE]{%{public}@} unable to load set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@";
LABEL_41:
                _os_log_impl(&dword_0, v54, v55, v56, buf, 0x20u);
              }

LABEL_42:

              [v88 addObject:v44];
            }

            v42 = v81;
            v41 = v85;
            goto LABEL_45;
          }

          v57 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543874;
            v115 = v93;
            v116 = 2114;
            v117 = v84;
            v118 = 2114;
            v119 = v83;
            _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} unable to load persisted entry | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
          }

          [v88 addObject:v44];
        }

        else
        {
          v47 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543874;
            v115 = v93;
            v116 = 2114;
            v117 = v84;
            v118 = 2114;
            v119 = v83;
            _os_log_impl(&dword_0, v47, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@:} no entryID | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
          }
        }

LABEL_45:

        objc_autoreleasePoolPop(v45);
        v43 = v43 + 1;
      }

      while (v41 != v43);
      v41 = [contexta countByEnumeratingWithState:&v101 objects:v120 count:16];
    }

    while (v41);
  }

  v99 = 0u;
  v100 = 0u;
  v97 = 0u;
  v98 = 0u;
  v82 = v88;
  v58 = [v82 countByEnumeratingWithState:&v97 objects:v113 count:16];
  v37 = v93;
  if (!v58)
  {
    goto LABEL_60;
  }

  v59 = v58;
  v60 = *v98;
  do
  {
    for (k = 0; k != v59; k = k + 1)
    {
      if (*v98 != v60)
      {
        objc_enumerationMutation(v82);
      }

      v62 = *(*(&v97 + 1) + 8 * k);
      contextb = objc_autoreleasePoolPush();
      v63 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v64 = [v63 persistedEntry:v62 fromLocation:v37];

      v65 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v89 = v64;
      v66 = [v65 decodeFromLocation:v37 ofEntryName:v62 fromPersistedEntry:v64 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (v66)
      {
        v67 = [v66 latestDownloadedAtomicInstance];

        if (v67)
        {
          v68 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          [v68 removePersistedEntry:v62 fromLocation:v37];

          v69 = [v66 latestDowloadedAtomicInstanceEntries];
          v70 = [v69 count];
          v71 = [v66 clientDomainName];
          v72 = [v66 assetSetIdentifier];
          [v66 discoveredAtomicInstance];
          v73 = v60;
          v75 = v74 = v59;
          [MADAutoAssetHistory recordOperation:377 toHistoryType:2 fromLayer:1 usageCount:v70 forClientDomainName:v71 forAssetSetIdentifier:v72 forAtomicInstance:v75];

          v59 = v74;
          v60 = v73;

          v37 = v93;
          self = v96;
          [(MADAutoAssetControlManager *)v96 _logPersistedSetDescriptorRemoved:v93 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v62 removedSetDescriptor:v66 message:@"removing previously persisted downloaded-set-descriptor that has been eliminated"];
          goto LABEL_58;
        }

        v76 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
      }

      else
      {
        v76 = @"EntryID: %@. descriptor to be dropped is nil";
      }

      v77 = [[NSString alloc] initWithFormat:v76, v62];
      v78 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v79 = [v78 diag];
      [v79 trackAnomaly:@"setDescriptorEliminateMatching" forReason:v77 withResult:6101 withError:0];

      v37 = v93;
LABEL_58:

      objc_autoreleasePoolPop(contextb);
    }

    v59 = [v82 countByEnumeratingWithState:&v97 objects:v113 count:16];
  }

  while (v59);
LABEL_60:

  v39 = v80;
LABEL_61:

LABEL_62:
}

- (id)_limitSetAtomicEntries:(id)a3 fromSetDescriptor:(id)a4 requestedAutoAssetEntries:(id)a5
{
  v7 = a4;
  v8 = a5;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v39 = v8;
  v34 = v39;
  if (v39 || ([v7 clientDomainName], v11 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v7, "assetSetIdentifier"), v12 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetConfigurationByClientDomain:forAssetSetIdentifier:](self, "locateSetConfigurationByClientDomain:forAssetSetIdentifier:", v11, v12), v13 = objc_claimAutoreleasedReturnValue(), v12, v11, objc_msgSend(v13, "autoAssetEntries"), v14 = objc_claimAutoreleasedReturnValue(), v13, (v39 = v14) != 0))
  {
    v15 = objc_alloc_init(NSMutableArray);
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    obj = [v7 latestDowloadedAtomicInstanceEntries];
    v40 = [obj countByEnumeratingWithState:&v50 objects:v55 count:16];
    if (v40)
    {
      v36 = *v51;
      v37 = v15;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      v38 = v7;
      do
      {
        v17 = 0;
        do
        {
          if (*v51 != v36)
          {
            objc_enumerationMutation(obj);
          }

          v41 = v17;
          v18 = *(*(&v50 + 1) + 8 * v17);
          v46 = 0u;
          v47 = 0u;
          v48 = 0u;
          v49 = 0u;
          v43 = v39;
          v45 = [v43 countByEnumeratingWithState:&v46 objects:v54 count:16];
          if (v45)
          {
            v19 = *v47;
            v42 = v18;
            while (2)
            {
              for (i = 0; i != v45; i = i + 1)
              {
                if (*v47 != v19)
                {
                  objc_enumerationMutation(v43);
                }

                v21 = *(*(&v46 + 1) + 8 * i);
                v22 = p_weak_ivar_lyt[223];
                v23 = [v21 assetSelector];
                v24 = [v23 assetType];
                v25 = [v18 fullAssetSelector];
                v26 = [v25 assetType];
                if ([v22 stringIsEqual:v24 to:v26])
                {
                  v44 = p_weak_ivar_lyt[223];
                  v27 = [v21 assetSelector];
                  v28 = [v27 assetSpecifier];
                  v29 = [v18 fullAssetSelector];
                  [v29 assetSpecifier];
                  v31 = v30 = v19;
                  LOBYTE(v44) = [v44 stringIsEqual:v28 to:v31];

                  v19 = v30;
                  v18 = v42;

                  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                  if (v44)
                  {

                    v15 = v37;
                    if (v42)
                    {
                      [v37 addObject:v42];
                    }

                    goto LABEL_22;
                  }
                }

                else
                {
                }
              }

              v45 = [v43 countByEnumeratingWithState:&v46 objects:v54 count:16];
              if (v45)
              {
                continue;
              }

              break;
            }
          }

          v15 = v37;
LABEL_22:
          v17 = v41 + 1;
          v7 = v38;
        }

        while ((v41 + 1) != v40);
        v40 = [obj countByEnumeratingWithState:&v50 objects:v55 count:16];
      }

      while (v40);
    }

    if ([v15 count])
    {
      v32 = v15;
    }

    else
    {
      v32 = 0;
    }
  }

  else
  {
    v32 = 0;
  }

  return v32;
}

- (id)_limitToCheckAtomicEntries:(id)a3
{
  v3 = a3;
  v16 = objc_alloc_init(NSMutableArray);
  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v4 = v3;
  v5 = [v4 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v18;
    do
    {
      for (i = 0; i != v6; i = i + 1)
      {
        if (*v18 != v7)
        {
          objc_enumerationMutation(v4);
        }

        v9 = *(*(&v17 + 1) + 8 * i);
        v10 = [MANAutoAssetSetAtomicEntry alloc];
        v11 = [v9 fullAssetSelector];
        v12 = [v9 assetID];
        v13 = [v9 assetAttributes];
        v14 = -[MANAutoAssetSetAtomicEntry initWithFullAssetSelector:withAssetID:withLocalContentURL:withAssetAttributes:inhibitedFromEmergencyRemoval:](v10, "initWithFullAssetSelector:withAssetID:withLocalContentURL:withAssetAttributes:inhibitedFromEmergencyRemoval:", v11, v12, 0, v13, [v9 inhibitedFromEmergencyRemoval]);

        if (v14)
        {
          [v16 addObject:v14];
        }
      }

      v6 = [v4 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v6);
  }

  return v16;
}

- (void)setDescriptorAddedPreInstalled:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 latestDownloadedAtomicInstance];
  if (v7)
  {
    v8 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setDescriptorAddedPreInstalled" forAtomicInstanceUUID:v7 requireExists:0];
    if (v8)
    {
      v9 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v11 = [v4 summary];
        *buf = 138543618;
        v29 = v10;
        v30 = 2114;
        v31 = v11;
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, "[%{public}@] {setDescriptorAddedPreInstalled} downloaded-by-instance set-descriptor already known | setDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v16 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:v4];
      v17 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v26 = v16;
      v27 = [v17 persistedEntry:v16 fromLocation:@"setDescriptorAddedPreInstalled"];

      [v27 persistSecureCodedObject:v4 forKey:@"assetSetDescriptor"];
      v18 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v19 = [v4 summary];
      [v18 storePersistedEntry:v16 withEntrySummary:v19 fromLocation:@"setDescriptorAddedPreInstalled"];

      v20 = [v4 latestDowloadedAtomicInstanceEntries];
      v21 = [v20 count];
      v22 = [v4 clientDomainName];
      v23 = [v4 assetSetIdentifier];
      v24 = [v4 discoveredAtomicInstance];
      v25 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetDescriptor:v4];
      [MADAutoAssetHistory recordOperation:352 toHistoryType:2 fromLayer:1 usageCount:v21 forClientDomainName:v22 forAssetSetIdentifier:v23 forAtomicInstance:v24 withAddendumMessage:v25];

      v9 = v26;
      [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:@"setDescriptorAddedPreInstalled" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_ADD" forPersistedEntryID:v26 forClientRequest:0 withJobUUID:0 withSetDescriptor:v4 message:@"new descriptor representing pre-installed auto-asset entries"];
      [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:@"setDescriptorAddedPreInstalled" forSetDescriptor:v4];
    }
  }

  else
  {
    v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v12 = [v8 diag];
    v13 = [NSString alloc];
    v14 = [v4 summary];
    v15 = [v13 initWithFormat:@"{setDescriptorAddedPreInstalled} already no latestDownloadedAtomicInstance | setDescriptor:%@", v14];
    [v12 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v15 withResult:6108 withError:0];
  }
}

- (BOOL)setDescriptorAllEntriesDownloaded:(id)a3 forSetDescriptor:(id)a4 loggingEntryExists:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v37 = [[NSString alloc] initWithFormat:@"%@:setDescriptorAllEntriesDownloaded", v8];
  v42 = 0;
  v12 = [v9 latestDowloadedAtomicInstanceEntries];
  v35 = [v12 count];

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  obj = [v9 latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v38 objects:v55 count:16];
  if (!v13)
  {
    v25 = 1;
    goto LABEL_29;
  }

  v14 = v13;
  v33 = v9;
  v34 = v8;
  v15 = 0;
  v16 = 0;
  v17 = *v39;
  while (2)
  {
    v18 = 0;
    v19 = v16;
    do
    {
      if (*v39 != v17)
      {
        objc_enumerationMutation(obj);
      }

      v20 = *(*(&v38 + 1) + 8 * v18);
      ++v15;
      v21 = [v20 localContentURL];

      if (!v21)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v27 = [v20 summary];
          v9 = v33;
          v28 = [v33 summary];
          *buf = 138544386;
          v44 = v37;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = v27;
          v51 = 2114;
          v52 = v28;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);

LABEL_24:
          v8 = v34;
LABEL_27:

          v25 = 0;
          v16 = v19;
          goto LABEL_28;
        }

LABEL_26:
        v9 = v33;
        v8 = v34;
        goto LABEL_27;
      }

      v22 = [v20 localContentURL];
      v16 = [v22 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:v37 atPath:v16 isDirectory:&v42])
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v29 = [v20 summary];
          v9 = v33;
          v30 = [v33 summary];
          *buf = 138544642;
          v44 = v37;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = v29;
          v51 = 2114;
          v52 = v16;
          v53 = 2114;
          v54 = v30;
          v31 = "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing from filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@";
LABEL_23:
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, v31, buf, 0x3Eu);

          v19 = v16;
          goto LABEL_24;
        }

        goto LABEL_25;
      }

      if ((v42 & 1) == 0)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v29 = [v20 summary];
          v9 = v33;
          v30 = [v33 summary];
          *buf = 138544642;
          v44 = v37;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = v29;
          v51 = 2114;
          v52 = v16;
          v53 = 2114;
          v54 = v30;
          v31 = "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@";
          goto LABEL_23;
        }

LABEL_25:
        v19 = v16;
        goto LABEL_26;
      }

      if (v5)
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
        {
          v24 = [v20 summary];
          *buf = 138544386;
          v44 = v37;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = v24;
          v51 = 2114;
          v52 = v16;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} [KEEP-SET-DESCRIPTOR] set-descriptor with downloaded entry on filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@", buf, 0x34u);
        }
      }

      v18 = v18 + 1;
      v19 = v16;
    }

    while (v14 != v18);
    v14 = [obj countByEnumeratingWithState:&v38 objects:v55 count:16];
    if (v14)
    {
      continue;
    }

    break;
  }

  v25 = 1;
  v9 = v33;
  v8 = v34;
LABEL_28:

LABEL_29:
  return v25;
}

- (BOOL)setDescriptorAllDiscoveredEntriesDownloaded:(id)a3 forSetDescriptor:(id)a4 loggingEntryExists:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v35 = [[NSString alloc] initWithFormat:@"%@:setDescriptorAllDiscoveredEntriesDownloaded", v8];
  v40 = 0;
  v12 = [v9 discoveredAtomicEntries];
  v33 = [v12 count];

  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [v9 discoveredAtomicEntries];
  v13 = [obj countByEnumeratingWithState:&v36 objects:v51 count:16];
  if (!v13)
  {
    v25 = 1;
    goto LABEL_27;
  }

  v14 = v13;
  v31 = v9;
  v32 = v8;
  v15 = 0;
  v16 = 0;
  v17 = *v37;
  while (2)
  {
    v18 = 0;
    v19 = v16;
    do
    {
      if (*v37 != v17)
      {
        objc_enumerationMutation(obj);
      }

      v20 = *(*(&v36 + 1) + 8 * v18);
      ++v15;
      v21 = [v20 localContentURL];

      if (!v21)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v27 = [v20 summary];
          *buf = 138544130;
          v42 = v35;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = v27;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@", buf, 0x2Au);
        }

        goto LABEL_25;
      }

      v22 = [v20 localContentURL];
      v16 = [v22 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:v35 atPath:v16 isDirectory:&v40])
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v28 = [v20 summary];
          *buf = 138544386;
          v42 = v35;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = v28;
          v49 = 2114;
          v50 = v16;
          v29 = "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry missing from filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@";
LABEL_23:
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, v29, buf, 0x34u);
        }

LABEL_24:
        v19 = v16;
LABEL_25:
        v9 = v31;
        v8 = v32;

        v25 = 0;
        v16 = v19;
        goto LABEL_26;
      }

      if ((v40 & 1) == 0)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          v28 = [v20 summary];
          *buf = 138544386;
          v42 = v35;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = v28;
          v49 = 2114;
          v50 = v16;
          v29 = "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@";
          goto LABEL_23;
        }

        goto LABEL_24;
      }

      if (v5)
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
        {
          v24 = [v20 summary];
          *buf = 138544386;
          v42 = v35;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = v24;
          v49 = 2114;
          v50 = v16;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-descriptor with downloaded entry on filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@", buf, 0x34u);
        }
      }

      v18 = v18 + 1;
      v19 = v16;
    }

    while (v14 != v18);
    v14 = [obj countByEnumeratingWithState:&v36 objects:v51 count:16];
    if (v14)
    {
      continue;
    }

    break;
  }

  v25 = 1;
  v9 = v31;
  v8 = v32;
LABEL_26:

LABEL_27:
  return v25;
}

- (BOOL)setDescriptorLocked:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [MADAutoAssetLocker newCurrentSetLockUsageForDescriptor:v4];
  if (v7)
  {
    v8 = [v7 count] != 0;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)setDescriptorVerifyNoDuplicates:(id)a3
{
  v4 = a3;
  v27 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = objc_alloc_init(NSMutableDictionary);
  v29 = 0u;
  v30 = 0u;
  v31 = 0u;
  v32 = 0u;
  v28 = v4;
  v8 = [v4 latestDowloadedAtomicInstanceEntries];
  v9 = [v8 countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v30;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v30 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v29 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        v15 = [v13 fullAssetSelector];
        v16 = [v15 persistedEntryID];

        v17 = [v7 safeObjectForKey:v16 ofClass:objc_opt_class()];
        if (!v17)
        {
          [v7 setSafeObject:v13 forKey:v16];
        }

        objc_autoreleasePoolPop(v14);
      }

      v10 = [v8 countByEnumeratingWithState:&v29 objects:v33 count:16];
    }

    while (v10);
  }

  v18 = [v28 latestDowloadedAtomicInstanceEntries];
  v19 = [v18 count];
  v20 = [v7 count];

  if (v19 != v20)
  {
    v21 = [(MADAutoAssetControlManager *)v27 autoControlManagerFSM];
    v22 = [v21 diag];
    v23 = [NSString alloc];
    v24 = [v28 summary];
    v25 = [v23 initWithFormat:@"{setDescriptorVerifyNoDuplicates} set-descriptor has not yet been deduped | setDescriptor:%@", v24];
    [v22 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6109 withError:0];
  }

  return v19 == v20;
}

- (id)setDescriptorDedupDownloadedEntries:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 copy];
  v11 = [v6 latestDowloadedAtomicInstanceEntries];

  v12 = [(MADAutoAssetControlManager *)self setAtomicEntriesRemoveDuplicates:v7 dedupingAtomicEntries:v11];

  [v10 setLatestDowloadedAtomicInstanceEntries:v12];

  return v10;
}

- (id)setAtomicEntriesRemoveDuplicates:(id)a3 dedupingAtomicEntries:(id)a4
{
  v25 = a3;
  v5 = a4;
  v6 = objc_alloc_init(NSMutableDictionary);
  v22 = objc_alloc_init(NSMutableArray);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = v5;
  v7 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v27;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v26 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        v13 = [v11 fullAssetSelector];
        v14 = [v13 persistedEntryID];

        v15 = [v6 safeObjectForKey:v14 ofClass:objc_opt_class()];
        if (v15)
        {
          v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v17 = [v16 diag];
          v18 = [[NSString alloc] initWithFormat:@"{%@:setAtomicEntriesRemoveDuplicates} atomic-entries needed dedup | dropped selectorKey:%@", v25, v14];
          [v17 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v18 withResult:6109 withError:0];
        }

        else
        {
          [v6 setSafeObject:v11 forKey:v14];
          [v22 addObject:v11];
        }

        objc_autoreleasePoolPop(v12);
      }

      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

  if ([v22 count])
  {
    v19 = v22;
  }

  else
  {
    v19 = obj;
  }

  v20 = v19;

  return v19;
}

- (id)newSetEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4
{
  v5 = a4;
  v6 = a3;
  v7 = [[NSString alloc] initWithFormat:@"%@_%@", v6, v5];

  return v7;
}

- (id)newSetEntryIDForClientDomain:(id)a3 forAssetSetIdentifier:(id)a4 ofAtomicInstance:(id)a5
{
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v10 = [[NSString alloc] initWithFormat:@"%@_%@_%@", v9, v8, v7];

  return v10;
}

- (BOOL)isSetDescriptor:(id)a3 coveredBySetDescriptorStatus:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v7 latestDowloadedAtomicInstanceEntries];
  v11 = [v10 count];

  if (v11)
  {
    v29 = v6;
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    obj = [v7 latestDowloadedAtomicInstanceEntries];
    v12 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    if (v12)
    {
      v13 = v12;
      v28 = v7;
      v14 = *v32;
      while (2)
      {
        for (i = 0; i != v13; i = i + 1)
        {
          if (*v32 != v14)
          {
            objc_enumerationMutation(obj);
          }

          v16 = *(*(&v31 + 1) + 8 * i);
          v17 = objc_autoreleasePoolPush();
          v18 = [MAAutoAssetSelector alloc];
          v19 = [v16 fullAssetSelector];
          v20 = [v19 assetType];
          v21 = [v16 fullAssetSelector];
          v22 = [v21 assetSpecifier];
          v23 = [v18 initForAssetType:v20 withAssetSpecifier:v22];

          v24 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"isSetDescriptor:coveredBySetDescriptorStatus" assetSelector:v23 limitedToStaging:0];
          v25 = [v24 count];

          objc_autoreleasePoolPop(v17);
          if (!v25)
          {
            v26 = 0;
            goto LABEL_12;
          }
        }

        v13 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
        if (v13)
        {
          continue;
        }

        break;
      }

      v26 = 1;
LABEL_12:
      v7 = v28;
    }

    else
    {
      v26 = 1;
    }

    v6 = v29;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (void)setDescriptorEliminate:(id)a3 triggeredByClient:(id)a4 forClientDomainName:(id)a5 forAssetSetIdentifier:(id)a6 awaitingUnlocked:(BOOL)a7
{
  v7 = a7;
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v17 = [v16 extendedStateQueue];
  dispatch_assert_queue_V2(v17);

  v18 = [[NSString alloc] initWithFormat:@"%@:setDescriptorEliminate", v12];
  v48 = v15;
  v19 = [[MAAutoAssetSelector alloc] initForAssetType:v14 withAssetSpecifier:v15];
  v20 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v21 = [v19 persistedEntryID];
  v22 = [v20 safeObjectForKey:v21 ofClass:objc_opt_class()];

  if (v22)
  {
    if (![(MADAutoAssetEliminate *)v22 awaitingUnlocked]|| v7)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v13 withErrorCode:6113 fromAction:v18 withDescription:@"already performing eliminate operation for the specified auto-asset-set identifier"];
      v23 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
      {
        v24 = [(MADAutoAssetEliminate *)v22 summary];
        *buf = 138543618;
        v54 = v18;
        v55 = 2114;
        v56 = v24;
        v25 = "\n[SET-ELIMINATE]{%{public}@} [BusyPerformingOperation] hard-eliminate (pending soft-eliminate should also have completed) | eliminateTracker:%{public}@";
        v26 = v23;
        v27 = OS_LOG_TYPE_ERROR;
        goto LABEL_19;
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:v18 usingEliminateTracker:v22 whenCurrentlyLocked:1 beginningToEliminate:0 removingContent:1];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v13 withErrorCode:0 fromAction:v12 withDescription:@"hard-eliminate completed (pending soft-eliminate should also have completed)"];
      v23 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
      {
        v24 = [(MADAutoAssetEliminate *)v22 summary];
        *buf = 138543618;
        v54 = v18;
        v55 = 2114;
        v56 = v24;
        v25 = "\n[SET-ELIMINATE]{%{public}@} [SUCCESS] hard-eliminate (pending soft-eliminate should also have completed) | eliminateTracker:%{public}@";
        v26 = v23;
        v27 = OS_LOG_TYPE_DEFAULT;
LABEL_19:
        _os_log_impl(&dword_0, v26, v27, v25, buf, 0x16u);
      }
    }
  }

  else
  {
    v46 = v14;
    v47 = v19;
    v28 = v7;
    v44 = v13;
    v45 = v12;
    v23 = objc_alloc_init(NSMutableArray);
    v29 = [0 clientDomainName];
    v30 = [0 assetSetIdentifier];
    v31 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v29 assetSetIdentifier:v30];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v18 ofContainer:@"setDescriptorKeysForAssetSet"];
    v51 = 0u;
    v52 = 0u;
    v49 = 0u;
    v50 = 0u;
    v32 = v31;
    v33 = [v32 countByEnumeratingWithState:&v49 objects:v57 count:16];
    if (v33)
    {
      v34 = v33;
      v35 = *v50;
      do
      {
        for (i = 0; i != v34; i = i + 1)
        {
          if (*v50 != v35)
          {
            objc_enumerationMutation(v32);
          }

          v37 = *(*(&v49 + 1) + 8 * i);
          v38 = objc_autoreleasePoolPush();
          v39 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:v18 forKey:v37];
          if (v39)
          {
            [v23 addObject:v39];
          }

          objc_autoreleasePoolPop(v38);
        }

        v34 = [v32 countByEnumeratingWithState:&v49 objects:v57 count:16];
      }

      while (v34);
    }

    v40 = [MADAutoAssetEliminate alloc];
    v13 = v44;
    v41 = [v44 clientRequest];
    v22 = [(MADAutoAssetEliminate *)v40 initWithClientRequest:v41 withAssetSelector:v47 forClientDomain:v46 forSetIdentifier:v48 withDownloadedSetDescriptors:v23 awaitingUnlocked:v28];

    if (v22)
    {
      v42 = [(MADAutoAssetControlManager *)self isSetIdentifierCurrentlyLocked:v18 forClientDomainName:v46 forAssetSetIdentifier:v48];
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:v18 usingEliminateTracker:v22 whenCurrentlyLocked:v42 beginningToEliminate:1 removingContent:!v42 || !v28];
      v12 = v45;
      v14 = v46;
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v44 withErrorCode:6101 fromAction:v18 withDescription:@"unable to allocate eliminate operation tracking entry"];
      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543362;
        v54 = v18;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [ResourceUnavailable] unable to allocate eliminate operation tracking entry", buf, 0xCu);
      }

      v12 = v45;
      v14 = v46;
    }

    v19 = v47;
  }
}

- (void)setIdentifierEliminate:(id)a3 usingEliminateTracker:(id)a4 whenCurrentlyLocked:(BOOL)a5 beginningToEliminate:(BOOL)a6 removingContent:(BOOL)a7
{
  v7 = a7;
  v8 = a6;
  v9 = a5;
  v12 = a3;
  v118 = a4;
  v123 = self;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v114 = v12;
  v15 = [[NSString alloc] initWithFormat:@"%@:setIdentifierEliminate", v12];
  v16 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
  {
    v17 = [v118 summary];
    v18 = v17;
    v19 = @"N";
    *buf = 138544386;
    v150 = v15;
    if (v9)
    {
      v20 = @"Y";
    }

    else
    {
      v20 = @"N";
    }

    if (v8)
    {
      v21 = @"Y";
    }

    else
    {
      v21 = @"N";
    }

    if (v7)
    {
      v19 = @"Y";
    }

    v151 = 2114;
    *v152 = v17;
    *&v152[8] = 2114;
    *&v152[10] = v20;
    v153 = 2114;
    v154 = v21;
    v155 = 2114;
    v156 = v19;
    _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} eliminateTracker:%{public}@ | currentlyLocked:%{public}@ | beginEliminate:%{public}@ | removeContent:%{public}@", buf, 0x34u);
  }

  v117 = v15;
  if (v8)
  {
    v110 = v7;
    v112 = v8;
    [v118 setAwaitingSchedulerAck:1];
    v22 = [v118 clientDomainName];
    v23 = [v118 assetSetIdentifier];
    [MADAutoAssetScheduler controlEliminateSetDomainName:v22 forAssetSetIdentifier:v23 indicatingWhenEliminated:1];

    v24 = v118;
    [(MADAutoAssetControlManager *)v123 trackPerformanceIteration:v15 ofContainer:@"currentJobsBySelector"];
    v142 = 0u;
    v143 = 0u;
    v140 = 0u;
    v141 = 0u;
    v25 = [(MADAutoAssetControlManager *)v123 currentSetJobsByIdentifier];
    v26 = [v25 allKeys];
    v27 = [v26 copy];

    v121 = [v27 countByEnumeratingWithState:&v140 objects:v148 count:16];
    if (v121)
    {
      v119 = *v141;
      obj = v27;
      do
      {
        for (i = 0; i != v121; i = i + 1)
        {
          if (*v141 != v119)
          {
            objc_enumerationMutation(v27);
          }

          v29 = *(*(&v140 + 1) + 8 * i);
          v30 = objc_autoreleasePoolPush();
          v31 = [(MADAutoAssetControlManager *)v123 currentSetJobsByIdentifier];
          v32 = [v31 safeObjectForKey:v29 ofClass:objc_opt_class()];

          if (v32 && [v32 autoAssetSetJob])
          {
            v33 = [v32 clientDomainName];
            v34 = [v24 clientDomainName];
            if (([SUCore stringIsEqual:v33 to:v34]& 1) != 0)
            {
              v35 = [v32 autoAssetSetIdentifier];
              v36 = [v24 assetSetIdentifier];
              v37 = [SUCore stringIsEqual:v35 to:v36];

              v24 = v118;
              v27 = obj;

              if (v37)
              {
                v38 = [v118 activeJobsByUUID];
                v39 = [v32 autoAssetUUID];
                v40 = [v32 autoAssetUUID];
                [v38 setSafeObject:v39 forKey:v40];

                v27 = obj;
                [(MADAutoAssetControlManager *)v123 cancelActiveSetJob:v117 activeSetJob:v32];
              }
            }

            else
            {
            }
          }

          objc_autoreleasePoolPop(v30);
        }

        v121 = [v27 countByEnumeratingWithState:&v140 objects:v148 count:16];
      }

      while (v121);
    }

    if ([v24 eliminatingSet])
    {
      v41 = [v24 clientDomainName];
      v42 = [v24 assetSetIdentifier];
      v43 = [(MADAutoAssetControlManager *)v123 setConfigurationForClientDomain:v41 forAssetSetIdentifier:v42];

      v15 = v117;
      v8 = v112;
      if (v43)
      {
        [v24 setAwaitingStagerAck:1];
        [(MADAutoAssetControlManager *)v123 ensureStagerFullyResumed];
        [MADAutoAssetStager controlEliminateSetConfiguration:v43];
      }
    }

    else
    {
      [v24 setAwaitingStagerAck:1];
      [(MADAutoAssetControlManager *)v123 ensureStagerFullyResumed];
      v43 = [v24 assetSelector];
      [MADAutoAssetStager controlEliminateSelector:v43];
      v15 = v117;
      v8 = v112;
    }

    v44 = [(MADAutoAssetControlManager *)v123 activelyEliminatingSelectors];
    v45 = [v24 assetSelector];
    v46 = [v45 persistedEntryID];
    [v44 setSafeObject:v24 forKey:v46];

    v47 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
    {
      v48 = [v118 summary];
      *buf = 138543618;
      v150 = v15;
      v151 = 2114;
      *v152 = v48;
      _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [BEGIN] elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
    }

    v7 = v110;
  }

  if (v7)
  {
    v49 = [v118 awaitingSecureOperations];
    v50 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v50, OS_LOG_TYPE_DEFAULT))
    {
      v51 = @"s";
      *buf = 138543874;
      v150 = v15;
      if (v49 == 1)
      {
        v51 = &stru_4BD3F0;
      }

      v151 = 1024;
      *v152 = v49;
      *&v152[4] = 2114;
      *&v152[6] = v51;
      _os_log_impl(&dword_0, v50, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [AUTO-SECURE] waiting for %d in-progress secure operation%{public}@", buf, 0x1Cu);
    }

    v52 = v49 > 0 || v8;
    v111 = v52;
    v120 = objc_alloc_init(NSMutableArray);
    v113 = objc_alloc_init(NSMutableArray);
    v136 = 0u;
    v137 = 0u;
    v138 = 0u;
    v139 = 0u;
    v53 = [(MADAutoAssetControlManager *)v123 shortTermLockedByAtomicInstance];
    v54 = [v53 allKeys];
    v55 = [v54 copy];

    obja = v55;
    v122 = [v55 countByEnumeratingWithState:&v136 objects:v147 count:16];
    if (v122)
    {
      v56 = *v137;
      do
      {
        for (j = 0; j != v122; j = j + 1)
        {
          if (*v137 != v56)
          {
            objc_enumerationMutation(obja);
          }

          v58 = *(*(&v136 + 1) + 8 * j);
          v59 = [(MADAutoAssetControlManager *)v123 knownSetAtomicInstancesByInstance];
          v60 = [v59 safeObjectForKey:v58 ofClass:objc_opt_class()];

          if (!v60)
          {
            goto LABEL_48;
          }

          v61 = [v60 clientDomainName];
          v62 = [v118 clientDomainName];
          if (([SUCore stringIsEqual:v61 to:v62]& 1) != 0)
          {
            [v60 assetSetIdentifier];
            v64 = v63 = v56;
            v65 = [v118 assetSetIdentifier];
            v66 = [SUCore stringIsEqual:v64 to:v65];

            v56 = v63;
            if (!v66)
            {
              goto LABEL_55;
            }

LABEL_48:
            v61 = [(MADAutoAssetControlManager *)v123 locateSetDescriptor:v117 forAtomicInstanceUUID:v58 requireExists:0];
            if (v61)
            {
              if (v60 && [v60 lockedSupportingShortTermLocking])
              {
                [v113 addObject:v61];
              }

              [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v61];
              [(MADAutoAssetControlManager *)v123 _forceSetUngraftAndEliminateAllSetLocks:v114 forSetDescriptor:v61];
            }

            goto LABEL_54;
          }

LABEL_54:
LABEL_55:
        }

        v122 = [obja countByEnumeratingWithState:&v136 objects:v147 count:16];
      }

      while (v122);
    }

    v67 = [v118 clientDomainName];
    v68 = [v118 assetSetIdentifier];
    v15 = v117;
    [(MADAutoAssetControlManager *)v123 setDescriptorEliminateMatching:v117 forClientDomainName:v67 forAssetSetIdentifier:v68 eliminatingSetIdentifer:1];

    v69 = [v118 clientDomainName];
    v70 = [v118 assetSetIdentifier];
    [(MADAutoAssetControlManager *)v123 atomicInstanceEliminate:v117 forClientDomainName:v69 forAssetSetIdentifier:v70];

    v71 = [v118 clientDomainName];
    v72 = [v118 assetSetIdentifier];
    [(MADAutoAssetControlManager *)v123 setConfigurationEliminate:v117 forClientDomainName:v71 forAssetSetIdentifier:v72];

    v73 = [v118 clientDomainName];
    v74 = [v118 assetSetIdentifier];
    [(MADAutoAssetControlManager *)v123 clearDownloadedFromSetStatus:v117 forClientDomainName:v73 forAssetSetIdentifier:v74];

    v134 = 0u;
    v135 = 0u;
    v132 = 0u;
    v133 = 0u;
    v75 = v113;
    v76 = [v75 countByEnumeratingWithState:&v132 objects:v146 count:16];
    if (v76)
    {
      v77 = v76;
      v78 = *v133;
      do
      {
        for (k = 0; k != v77; k = k + 1)
        {
          if (*v133 != v78)
          {
            objc_enumerationMutation(v75);
          }

          v80 = *(*(&v132 + 1) + 8 * k);
          [(MADAutoAssetControlManager *)v123 removeShortTermLockingOfSetDescriptor:v117 forSetDescriptor:v80 endingAll:0 performingHardEliminate:1 error:0];
          [(MADAutoAssetControlManager *)v123 _shortTermForceForget:v117 forSetDescriptor:v80];
        }

        v77 = [v75 countByEnumeratingWithState:&v132 objects:v146 count:16];
      }

      while (v77);
    }

    v81 = [v118 clientDomainName];
    v82 = [v118 assetSetIdentifier];
    v83 = [(MADAutoAssetControlManager *)v123 setDescriptorWalkKeysForClientDomainName:v81 assetSetIdentifier:v82];

    v130 = 0u;
    v131 = 0u;
    v128 = 0u;
    v129 = 0u;
    v84 = v83;
    v85 = [v84 countByEnumeratingWithState:&v128 objects:v145 count:16];
    if (v85)
    {
      v86 = v85;
      v87 = *v129;
      do
      {
        for (m = 0; m != v86; m = m + 1)
        {
          if (*v129 != v87)
          {
            objc_enumerationMutation(v84);
          }

          v89 = *(*(&v128 + 1) + 8 * m);
          v90 = objc_autoreleasePoolPush();
          v91 = [(MADAutoAssetControlManager *)v123 setDescriptorWalkLocate:v117 forKey:v89];
          if (v91)
          {
            v92 = [(MADAutoAssetControlManager *)v123 setLockUsageMapForSetDescriptor:v91];

            if (v92)
            {
              [(MADAutoAssetControlManager *)v123 _forceSetUngraftAndEliminateAllSetLocks:v117 forSetDescriptor:v91];
              [(MADAutoAssetControlManager *)v123 _shortTermForceForget:v117 forSetDescriptor:v91];
            }

            [v120 addObject:v91];
          }

          objc_autoreleasePoolPop(v90);
        }

        v86 = [v84 countByEnumeratingWithState:&v128 objects:v145 count:16];
      }

      while (v86);
    }

    v126 = 0u;
    v127 = 0u;
    v124 = 0u;
    v125 = 0u;
    v93 = v120;
    v94 = [v93 countByEnumeratingWithState:&v124 objects:v144 count:16];
    if (v94)
    {
      v95 = v94;
      v96 = *v125;
      do
      {
        for (n = 0; n != v95; n = n + 1)
        {
          if (*v125 != v96)
          {
            objc_enumerationMutation(v93);
          }

          v98 = *(*(&v124 + 1) + 8 * n);
          v99 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)v123 _forceSetUngraftAndEliminateAllSetLocks:v117 forSetDescriptor:v98];
          [(MADAutoAssetControlManager *)v123 _shortTermForceForget:v117 forSetDescriptor:v98];
          [(MADAutoAssetControlManager *)v123 removeSetDescriptorDownloaded:v98 fromLocation:v117 checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:328 historyOperationSD:372];
          objc_autoreleasePoolPop(v99);
        }

        v95 = [v93 countByEnumeratingWithState:&v124 objects:v144 count:16];
      }

      while (v95);
    }

    v100 = [v118 clientDomainName];
    v101 = [v118 assetSetIdentifier];
    [MADAutoAssetLocker eliminateSetEndAllLocks:v114 forClientDomainName:v100 forAssetSetIdentifier:v101];

    v102 = [v118 clientDomainName];
    v103 = [v118 assetSetIdentifier];
    [(MADAutoAssetControlManager *)v123 setLockUsageMapEliminateForClientDomain:v102 forSetIdentifier:v103];

    [v118 setAwaitingUnlocked:0];
    v104 = _MADLog(@"AutoControl");
    v105 = os_log_type_enabled(v104, OS_LOG_TYPE_DEFAULT);
    if (v111)
    {
      if (v105)
      {
        v106 = [v118 summary];
        *buf = 138543618;
        v150 = v117;
        v151 = 2114;
        *v152 = v106;
        _os_log_impl(&dword_0, v104, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [REMOVE-CONTENT] elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      if (v105)
      {
        v109 = [v118 summary];
        *buf = 138543618;
        v150 = v117;
        v151 = 2114;
        *v152 = v109;
        _os_log_impl(&dword_0, v104, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [REMOVE-CONTENT] no elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)v123 _eliminateCompleteIfAllDone:v118];
    }

    v107 = v118;
  }

  else
  {
    v107 = v118;
    [v118 setAwaitingUnlocked:1];
    v93 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v93, OS_LOG_TYPE_DEFAULT))
    {
      v108 = [v118 summary];
      *buf = 138543618;
      v150 = v15;
      v151 = 2114;
      *v152 = v108;
      _os_log_impl(&dword_0, v93, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} AWAIT-UNLOCKED elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
    }
  }
}

- (void)finishSetEliminateIfAwaitingUnlocked:(id)a3 forClientDomain:(id)a4 forAssetSetIdentifier:(id)a5
{
  v21 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  if ([(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:v21 forClientDomainName:v8 ofSetIdentifier:v9]&& ![(MADAutoAssetControlManager *)self isSetIdentifierCurrentlyLocked:v21 forClientDomainName:v8 forAssetSetIdentifier:v9])
  {
    v12 = [[MAAutoAssetSelector alloc] initForAssetType:v8 withAssetSpecifier:v9];
    v13 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    v14 = [v12 persistedEntryID];
    v15 = [v13 safeObjectForKey:v14 ofClass:objc_opt_class()];

    if (v15)
    {
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:v21 usingEliminateTracker:v15 whenCurrentlyLocked:0 beginningToEliminate:0 removingContent:1];
    }

    else
    {
      v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v17 = [v16 diag];
      v18 = [NSString alloc];
      v19 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v20 = [v18 initWithFormat:@"{%@:finishSetEliminateIfAwaitingUnlocked} set-identifier being eliminated yet no eliminateTracker | clientDomainName:%@ | assetSetIdentifier:%@ | %@", v21, v8, v9, v19];
      [v17 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6111 withError:0];
    }
  }
}

- (void)_forceSetUngraftAndEliminateAllSetLocks:(id)a3 forSetDescriptor:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v23 = [[NSString alloc] initWithFormat:@"%@:_forceSetUngraftAndEliminateAllSetLocks", v7];
  v10 = +[NSFileManager defaultManager];
  v11 = [v6 clientDomainName];
  v12 = [v6 assetSetIdentifier];
  v13 = [v6 latestDownloadedAtomicInstance];
  v14 = [MANAutoAssetSetStatus shortTermLockFilename:v11 forAssetSetIdentifier:v12 forSetAtomicInstance:v13];

  v15 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v6];
  v16 = [NSString alloc];
  v17 = [v6 summary];
  v18 = [v16 initWithFormat:@"forcing atomic-instance unlocked due to set-eliminate | setDescriptor:%@", v17];
  v19 = [MAAutoAssetError buildError:6564 fromOperation:v23 underlyingError:0 withDescription:v18];

  [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v23 dueToError:v19 forgettingAtomicInstance:v15 historyOperationAI:1504 historyOperationSD:395];
  [(MADAutoAssetControlManager *)self secureCheckUngraftAll:v23 forSetDescriptorNoLongerLocked:v6];
  [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v6];
  v20 = [v6 clientDomainName];
  v21 = [v6 assetSetIdentifier];
  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:v20 forSetIdentifier:v21];

  [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:v23 forSetDescriptor:v6 endingAll:1 performingHardEliminate:1 error:0];
  v22 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:v23 removingSharedLockFilename:v14 usingFileManager:v10 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
}

- (BOOL)setJobFoundAllContent:(id)a3 forJobAtomicInstance:(id)a4 withCurrentSetStatus:(id)a5
{
  v8 = a4;
  v9 = a5;
  v10 = a3;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:setJobFoundAllContent", v10];
  v14 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v8];
  if (!v14)
  {
    v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v17 = [v15 diag];
    v18 = [NSString alloc];
    v19 = [v9 summary];
    v20 = [v18 initWithFormat:@"{%@} set-job current-set-status did not include active atomic-instance | jobAtomicInstance:%@ | currentSetStatus:%@", v13, v8, v19];
    [v17 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6111 withError:0];
    goto LABEL_12;
  }

  v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v13 forAtomicInstanceUUID:v8 requireExists:0];
  if (!v15)
  {
    if (v9 && ([v9 clientDomainName], v21 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v9, "assetSetIdentifier"), v22 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager setConfigurationForClientDomain:forAssetSetIdentifier:](self, "setConfigurationForClientDomain:forAssetSetIdentifier:", v21, v22), v17 = objc_claimAutoreleasedReturnValue(), v22, v21, v17))
    {
      v23 = [v9 latestDowloadedAtomicInstanceEntries];
      if (v23 || ([v9 newerDiscoveredAtomicEntries], (v23 = objc_claimAutoreleasedReturnValue()) != 0))
      {
        v19 = v23;
        v16 = 1;
LABEL_13:

        goto LABEL_14;
      }

      v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v25 = [v20 diag];
      v27 = [NSString alloc];
      v28 = [v9 summary];
      v29 = [v27 initWithFormat:@"{%@} set-job current-set-status does not include latestDowloadedEntries | jobAtomicInstance:%@ | currentSetStatus:%@", v13, v8, v28];
      [v25 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v29 withResult:6111 withError:0];

      v19 = 0;
    }

    else
    {
      v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v19 = [v17 diag];
      v24 = [NSString alloc];
      v20 = [v9 summary];
      v25 = [v24 initWithFormat:@"{%@} set-job current-set-status has no set-configuration | jobAtomicInstance:%@ | currentSetStatus:%@", v13, v8, v20];
      [v19 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6111 withError:0];
    }

LABEL_12:
    v16 = 0;
    goto LABEL_13;
  }

  v16 = 0;
LABEL_14:

  return v16;
}

- (BOOL)shouldAdoptJobFoundAllContent:(id)a3 forJobAtomicInstance:(id)a4 withCurrentSetStatus:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = [[NSString alloc] initWithFormat:@"%@:shouldAdoptJobFoundAllContent", v8];
  v14 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v9];
  if (!v14)
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      v34 = [0 summary];
      *buf = 138543618;
      v78 = v13;
      v79 = 2114;
      v80 = v34;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "{%{public}@}: atomic-instance no longer valid - never adopt | setAtomicInstance:%{public}@", buf, 0x16u);
    }

    LOBYTE(v16) = 0;
    goto LABEL_43;
  }

  v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v13 forAtomicInstanceUUID:v9 requireExists:0];
  v16 = 0;
  if (v15)
  {
    goto LABEL_37;
  }

  v17 = [v10 clientDomainName];
  v18 = [v10 assetSetIdentifier];
  v19 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v17 forAssetSetIdentifier:v18];

  v20 = v19;
  if (!v19)
  {
    v35 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v36 = [v35 diag];
    v37 = [NSString alloc];
    v38 = [v10 summary];
    v39 = [v37 initWithFormat:@"{%@} set-job current-set-status has no set-configuration | jobAtomicInstance:%@ | currentSetStatus:%@", v13, v9, v38];
    [v36 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v39 withResult:6111 withError:0];

    v20 = 0;
    v16 = 0;
    goto LABEL_36;
  }

  v21 = [v19 latestAtomicInstanceToVend];

  if (!v21)
  {
LABEL_32:
    v46 = [v10 latestDowloadedAtomicInstanceEntries];
    if (v46 || ([v10 newerDiscoveredAtomicEntries], (v46 = objc_claimAutoreleasedReturnValue()) != 0))
    {
      v16 = 1;
    }

    else
    {
      v52 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v53 = [v52 diag];
      v54 = [NSString alloc];
      [v10 summary];
      v55 = v72 = v20;
      v56 = [v54 initWithFormat:@"{%@} set-job current-set-status does not include latestDowloadedEntries | jobAtomicInstance:%@ | currentSetStatus:%@", v13, v9, v55];
      [v53 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v56 withResult:6111 withError:0];

      v20 = v72;
      v46 = 0;
      v16 = 0;
    }

    goto LABEL_36;
  }

  v71 = v20;
  v22 = [v20 latestAtomicInstanceToVend];
  v23 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v13 forAtomicInstanceUUID:v22 requireExists:1];

  if (!v23 || ([v10 latestDowloadedAtomicInstanceEntries], v24 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v23, "latestDowloadedAtomicInstanceEntries"), v25 = objc_claimAutoreleasedReturnValue(), v67 = -[MADAutoAssetControlManager doSetAtomicEntries:matchOtherAtomicEntries:](self, "doSetAtomicEntries:matchOtherAtomicEntries:", v24, v25), v25, v24, !v67))
  {

    v20 = v71;
    goto LABEL_32;
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  v26 = [v23 latestDowloadedAtomicInstanceEntries];
  v68 = [v26 countByEnumeratingWithState:&v73 objects:v83 count:16];
  if (!v68)
  {

    v16 = 0;
    goto LABEL_23;
  }

  v60 = v8;
  v61 = v10;
  v63 = v23;
  v64 = *v74;
  while (2)
  {
    for (i = 0; i != v68; i = i + 1)
    {
      if (*v74 != v64)
      {
        objc_enumerationMutation(v26);
      }

      v28 = v26;
      v29 = *(*(&v73 + 1) + 8 * i);
      v30 = [v29 localContentURL];
      v31 = [v30 fileSystemRepresentation];

      if (!v31)
      {
        v58 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v69 = [v58 diag];
        v57 = [NSString alloc];
        v40 = [0 assetSetIdentifier];
        v65 = [v63 latestDownloadedAtomicInstance];
        if (v29)
        {
          v41 = [v29 summary];
        }

        else
        {
          v41 = @"NIL";
        }

        v10 = v61;
        v62 = v40;
        v45 = [v57 initWithFormat:@"{%@} An entry in latest-to-vend for set %@, %@, has latestDownloadedAtomicInstanceEntries that contain nil value. Entry: %@", v13, v40, v65, v41];
        [v69 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v45 withResult:6111 withError:0];

        if (v29)
        {
        }

        goto LABEL_31;
      }

      v32 = [v29 localContentURL];
      v33 = +[NSString stringWithUTF8String:](NSString, "stringWithUTF8String:", [v32 fileSystemRepresentation]);

      if (![(MADAutoAssetControlManager *)self filesystemDoesFileExist:v13 atPath:v33])
      {
        v70 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v42 = [v70 diag];
        v59 = [NSString alloc];
        v66 = [0 assetSetIdentifier];
        v43 = [v63 latestDownloadedAtomicInstance];
        v44 = [v59 initWithFormat:@"{%@} Latest-to-vend for set %@, %@, has atomic entries that are missing from filesystem.  Missing atomic entry: %@. ", v13, v66, v43, v33];
        [v42 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v44 withResult:6111 withError:0];

        v10 = v61;
LABEL_31:
        v20 = v71;
        v8 = v60;
        goto LABEL_32;
      }

      v26 = v28;
    }

    v68 = [v28 countByEnumeratingWithState:&v73 objects:v83 count:16];
    if (v68)
    {
      continue;
    }

    break;
  }

  v16 = 0;
  v8 = v60;
  v10 = v61;
LABEL_23:
  v20 = v71;
LABEL_36:

LABEL_37:
  v47 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
  {
    v48 = v10;
    if (v16)
    {
      v49 = @"Y";
    }

    else
    {
      v49 = @"N";
    }

    v50 = [v14 summary];
    *buf = 138543874;
    v78 = v13;
    v79 = 2114;
    v80 = v49;
    v10 = v48;
    v81 = 2114;
    v82 = v50;
    _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "{%{public}@}: atomic-instance considered for adoption | shouldAdoptAsDownloaded:%{public}@ | setAtomicInstance:%{public}@", buf, 0x20u);
  }

LABEL_43:
  return v16;
}

- (BOOL)doSetAtomicEntries:(id)a3 matchOtherAtomicEntries:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = [v5 count];
  v34 = v6;
  if (v7 != [v6 count])
  {
    v27 = 0;
    goto LABEL_28;
  }

  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  obj = v5;
  v31 = [obj countByEnumeratingWithState:&v47 objects:v52 count:16];
  if (!v31)
  {
    v27 = 1;
    goto LABEL_27;
  }

  v32 = *v48;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v29 = v5;
  while (2)
  {
    v9 = 0;
    while (2)
    {
      if (*v48 != v32)
      {
        objc_enumerationMutation(obj);
      }

      v33 = v9;
      v10 = *(*(&v47 + 1) + 8 * v9);
      v43 = 0u;
      v44 = 0u;
      v45 = 0u;
      v46 = 0u;
      v37 = v34;
      v42 = [v37 countByEnumeratingWithState:&v43 objects:v51 count:16];
      if (!v42)
      {
LABEL_25:

        v27 = 0;
        v5 = v29;
        goto LABEL_27;
      }

      v11 = *v44;
      v36 = *v44;
LABEL_9:
      v12 = 0;
      while (1)
      {
        if (*v44 != v11)
        {
          objc_enumerationMutation(v37);
        }

        v13 = *(*(&v43 + 1) + 8 * v12);
        v14 = p_weak_ivar_lyt[223];
        v15 = [v10 fullAssetSelector];
        v16 = [v15 assetType];
        v17 = [v13 fullAssetSelector];
        v18 = [v17 assetType];
        if (![v14 stringIsEqual:v16 to:v18])
        {
          goto LABEL_17;
        }

        v39 = v15;
        v19 = p_weak_ivar_lyt;
        v20 = p_weak_ivar_lyt[223];
        v41 = [v10 fullAssetSelector];
        v21 = [v41 assetSpecifier];
        v38 = [v13 fullAssetSelector];
        v22 = [v38 assetSpecifier];
        v40 = v21;
        if (![v20 stringIsEqual:v21 to:v22])
        {

          p_weak_ivar_lyt = v19;
          v11 = v36;
          v15 = v39;
LABEL_17:

          goto LABEL_18;
        }

        v35 = v19[223];
        v23 = [v10 fullAssetSelector];
        v24 = [v23 assetVersion];
        v25 = [v13 fullAssetSelector];
        v26 = [v25 assetVersion];
        LOBYTE(v35) = [v35 stringIsEqual:v24 to:v26];

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v11 = v36;
        if (v35)
        {
          break;
        }

LABEL_18:
        if (v42 == ++v12)
        {
          v42 = [v37 countByEnumeratingWithState:&v43 objects:v51 count:16];
          if (v42)
          {
            goto LABEL_9;
          }

          goto LABEL_25;
        }
      }

      v9 = v33 + 1;
      if ((v33 + 1) != v31)
      {
        continue;
      }

      break;
    }

    v27 = 1;
    v5 = v29;
    v31 = [obj countByEnumeratingWithState:&v47 objects:v52 count:16];
    if (v31)
    {
      continue;
    }

    break;
  }

LABEL_27:

LABEL_28:
  return v27;
}

- (BOOL)setPolicyValidate:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 clientRequestMessage];
  v11 = [v10 messageName];

  v12 = [v6 clientRequest];
  v13 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:v12];

  if (v13)
  {
    v14 = [v6 clientRequestMessage];
    v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:v14];

    if (!v15)
    {
      v20 = 0;
LABEL_23:

      goto LABEL_24;
    }

    v16 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
    v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:v7 withEventInfo:v6];
    if ([v15 lockInhibitsEmergencyRemoval] && ((+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:NEED_FOR_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:CHECK_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK") & 1) != 0))
    {
      v18 = @"lockInhibitsEmergencyRemoval|";
      v19 = 6572;
    }

    else
    {
      if (![v15 blockCheckDownload] || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:CHECK_ATOMIC") & 1) == 0 && (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:LOCK_ATOMIC") & 1) == 0 && (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK") & 1) == 0)
      {
        v24 = _MADLog(@"Auto");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
        {
          v25 = [v17 summary];
          v26 = [v15 summary];
          *buf = 138544130;
          v30 = v7;
          v31 = 2114;
          v32 = v25;
          v33 = 2114;
          v34 = v11;
          v35 = 2114;
          v36 = v26;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "{%{public}@:setPolicyValidate} setInstance:%{public}@\n[SET-POLICY](%{public}@) accepted | setPolicy:%{public}@", buf, 0x2Au);
        }

        v20 = 0;
        goto LABEL_22;
      }

      v18 = @"blockCheckDownload|";
      v19 = 6573;
    }

    [v16 appendString:v18];
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
    {
      [v17 summary];
      v22 = v28 = v17;
      v23 = [v15 summary];
      *buf = 138544642;
      v30 = v7;
      v31 = 2114;
      v32 = v22;
      v33 = 2114;
      v34 = v11;
      v35 = 2048;
      v36 = v19;
      v37 = 2114;
      v38 = v16;
      v39 = 2114;
      v40 = v23;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{%{public}@:setPolicyValidate} setInstance:%{public}@\n[SET-POLICY](%{public}@) cannot accept set-policy | errorCode:%ld(%{public}@) | setPolicy:%{public}@", buf, 0x3Eu);

      v17 = v28;
    }

    v24 = [[NSString alloc] initWithFormat:@"set-policy invalid: setPolicy|%@ must be NO for request:%@", v16, v11];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:v19 fromAction:v7 withDescription:v24];
    v20 = 1;
LABEL_22:

    goto LABEL_23;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v6 withErrorCode:6570 fromAction:v7 withDescription:@"set-policy invalid: client-request is not for a set-job"];
  v20 = 1;
LABEL_24:

  return v20;
}

- (id)setTargetNewEntryIDForClientDomainName:(id)a3 forAssetSetIdentifier:(id)a4 forClientProvidedSetTarget:(id)a5
{
  v8 = a5;
  v9 = a4;
  v10 = a3;
  v11 = [v8 minTargetOSVersion];
  v12 = [v8 maxTargetOSVersion];

  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomainName:v10 forAssetSetIdentifier:v9 forMinTargetOS:v11 forMaxTargetOS:v12];

  return v13;
}

- (id)newSetEntryIDForClientDomainName:(id)a3 forAssetSetIdentifier:(id)a4 forMinTargetOS:(id)a5 forMaxTargetOS:(id)a6
{
  v9 = a6;
  v10 = a5;
  v11 = a4;
  v12 = a3;
  v13 = [[NSString alloc] initWithFormat:@"%@_%@_%@_%@", v12, v11, v10, v9];

  return v13;
}

- (void)_routeCatalogFinished:(id)a3 withEventInfo:(id)a4
{
  v14 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v14 autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:v9 fromLocation:v6 notFoundCode:6103 notFoundReason:@"catalog-download-finished when no active auto-asset-job"];

  if (v10)
  {
    v11 = [v14 autoAssetJobID];
    v12 = [v14 autoAssetCatalog];
    v13 = [v14 finishedError];
    [v10 handleDownloadCatalogJobFinished:v11 withCatalog:v12 downloadError:v13];
  }
}

- (void)_routeConfigFinished:(id)a3 withEventInfo:(id)a4
{
  v14 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v14 autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:v9 fromLocation:v6 notFoundCode:6103 notFoundReason:@"download-config when no active auto-asset-job"];

  if (v10)
  {
    v11 = [v14 autoAssetJobID];
    v12 = [v14 downloadOptions];
    v13 = [v14 finishedError];
    [v10 handleDownloadConfigJobFinished:v11 withDownloadOptions:v12 configError:v13];
  }
}

- (void)_routeAssetProgress:(id)a3 toCurrentJobByUUID:(id)a4 withDownloadProgress:(id)a5
{
  v13 = a4;
  v8 = a5;
  v9 = a3;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [(MADAutoAssetControlManager *)self currentJobByUUID:v13 fromLocation:v9 notFoundCode:6103 notFoundReason:@"download-progress when no active auto-asset-job"];

  if (v12)
  {
    [v12 handleDownloadAssetProgressForJob:v13 withProgress:v8];
  }
}

- (void)_routeAssetFinished:(id)a3 withEventInfo:(id)a4
{
  v13 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v13 autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:v9 fromLocation:v6 notFoundCode:6103 notFoundReason:@"asset-download-finished when no active auto-asset-job"];

  if (v10)
  {
    v11 = [v13 autoAssetJobID];
    v12 = [v13 finishedError];
    [v10 handleDownloadAssetJobFinished:v11 downloadError:v12];
  }
}

- (void)_awaitingResumeRemoveType:(int64_t)a3
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = objc_alloc_init(NSMutableArray);
  v13 = 0u;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v7 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v8 = [v7 countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v14;
    do
    {
      v11 = 0;
      do
      {
        if (*v14 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v13 + 1) + 8 * v11);
        if (v12 && [*(*(&v13 + 1) + 8 * v11) paramType] != &dword_8)
        {
          [v6 addObject:v12];
        }

        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [v7 countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v9);
  }

  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v6];
}

- (void)_awaitingResumeReduceToLatest
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = objc_alloc_init(NSMutableArray);
  v6 = objc_alloc_init(NSMutableDictionary);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v7 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v8 = [v7 countByEnumeratingWithState:&v26 objects:v31 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v27;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v27 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v26 + 1) + 8 * i);
        v13 = [v12 autoAssetJobID];
        [v6 setSafeObject:v12 forKey:v13];
      }

      v9 = [v7 countByEnumeratingWithState:&v26 objects:v31 count:16];
    }

    while (v9);
  }

  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v14 = v6;
  v15 = [v14 countByEnumeratingWithState:&v22 objects:v30 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v23;
    do
    {
      for (j = 0; j != v16; j = j + 1)
      {
        if (*v23 != v17)
        {
          objc_enumerationMutation(v14);
        }

        v19 = *(*(&v22 + 1) + 8 * j);
        v20 = objc_autoreleasePoolPush();
        v21 = [v14 safeObjectForKey:v19 ofClass:{objc_opt_class(), v22}];
        if (v21)
        {
          [v5 addObject:v21];
        }

        objc_autoreleasePoolPop(v20);
      }

      v16 = [v14 countByEnumeratingWithState:&v22 objects:v30 count:16];
    }

    while (v16);
  }

  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v5];
}

- (void)_requestDownloadManagerSync
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  if ([(MADAutoAssetControlManager *)self receivedDownloadManagerSync])
  {
    v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v5 = [v14 diag];
    v6 = [NSString alloc];
    v7 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v8 = [v6 initWithFormat:@"{_requestDownloadManagerSync} already received DownloadManager sync | %@", v7];
    [v5 trackAnomaly:@"AUTO-CONTROL" forReason:v8 withResult:6108 withError:0];
  }

  else
  {
    v9 = getDownloadManager();
    v10 = _MADLog(@"AutoControl");
    v11 = v10;
    if (v9)
    {
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        v12 = [(MADAutoAssetControlManager *)self summary];
        *buf = 138543362;
        v16 = v12;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_requestDownloadManagerSync} | Triggering DownloadManager sync (under assumption sync attempt never occurred)", buf, 0xCu);
      }

      [v9 queryNSUrlSessiondAndUpdateState];
    }

    else
    {
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        v13 = [(MADAutoAssetControlManager *)self summary];
        *buf = 138543362;
        v16 = v13;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[%{public}@] {_requestDownloadManagerSync} | No download manager available; unable to attempt sync as mitigation for potential lost sync", buf, 0xCu);
      }
    }
  }
}

- (id)_updatePolicyForSelector:(id)a3
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [(MADAutoAssetControlManager *)self defaultUpdatePolicy];
  v7 = [(MADAutoAssetControlManager *)self preferenceActivityIntervalSecs];
  if (v7 >= 1)
  {
    [v6 setCheckForNewerIntervalSecs:v7];
  }

  v8 = [(MADAutoAssetControlManager *)self defaultUpdatePolicy];

  return v8;
}

- (void)loadPersistedDescriptors
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  [v5 loadPersistedState:@"loadPersistedDescriptors"];

  v6 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [v6 persistedEntryIDs:@"loadPersistedDescriptors"];

  if ([v7 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedDescriptors" ofContainer:@"persistedKnownDescriptors"];
    v46 = deviceOSBuildVersion();
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v45 = v7;
    v8 = v7;
    v49 = [v8 countByEnumeratingWithState:&v50 objects:v60 count:16];
    if (!v49)
    {
      goto LABEL_41;
    }

    v9 = *v51;
    v47 = v8;
    v48 = *v51;
    while (1)
    {
      v10 = 0;
      do
      {
        if (*v51 != v9)
        {
          objc_enumerationMutation(v8);
        }

        v11 = *(*(&v50 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        v13 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v14 = [v13 persistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

        if (!v14)
        {
          v16 = _MADLog(@"AutoControl");
          if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_18;
          }

          v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v55 = v17;
          v56 = 2114;
          v57 = v11;
          _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          goto LABEL_17;
        }

        v15 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v16 = [v15 decodeFromLocation:@"loadPersistedDescriptors" ofEntryName:v11 fromPersistedEntry:v14 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v16)
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = v18;
            v56 = 2114;
            v57 = v11;
            v19 = v17;
            v20 = OS_LOG_TYPE_ERROR;
            v21 = "[%{public}@] {loadPersistedDescriptors} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
            _os_log_impl(&dword_0, v19, v20, v21, buf, 0x16u);

            v9 = v48;
          }

LABEL_17:

          goto LABEL_18;
        }

        if ([v16 isBlankEntry])
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
          {
            v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = v18;
            v56 = 2114;
            v57 = v11;
            v19 = v17;
            v20 = OS_LOG_TYPE_DEFAULT;
            v21 = "[%{public}@] {loadPersistedDescriptors} encountered blank auto-asset-descriptor | entryID:%{public}@";
            goto LABEL_16;
          }

          goto LABEL_17;
        }

        v22 = [v16 metadata];

        if (!v22)
        {
          v28 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
          {
            v29 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = v29;
            v56 = 2114;
            v57 = v11;
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} encountered auto-asset-descriptor with metadata=nil | entryID:%{public}@", buf, 0x16u);
          }

          goto LABEL_35;
        }

        if ([v16 isOnFilesystem])
        {
          v23 = [MAAutoAssetSelector alloc];
          v24 = [v16 assetType];
          v25 = [v16 assetSpecifier];
          v26 = [v16 assetVersion];
          v27 = [v23 initForAssetType:v24 withAssetSpecifier:v25 matchingAssetVersion:v26];

          if ([(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:v16 forOSBuild:v46])
          {
            [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v16];
            LOBYTE(v44) = 0;
            [(MADAutoAssetControlManager *)self trackDescriptor:v16 persisting:0 fromLocation:@"loadPersistedDescriptors" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v44];
            [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"content on filesystem validated"];
          }

          else
          {
            v35 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            [v35 addObject:v16];

            v36 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [v36 removePersistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v11 removedDescriptor:v16 message:@"stale descriptor (filesystem content did not validate)"];
            v37 = [v16 assetId];
            [MADAutoAssetHistory recordOperation:401 toHistoryType:0 fromLayer:1 forAssetID:v37 withSelector:v27];
          }

          v8 = v47;

LABEL_35:
          v9 = v48;
          goto LABEL_18;
        }

        if ([(MADAutoAssetControlManager *)self jobDescriptorInFlightNowOnFilesystem:v16])
        {
          v30 = _MADLog(@"AutoControl");
          v9 = v48;
          if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
          {
            v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v32 = [v16 summary];
            *buf = 138543874;
            v55 = v31;
            v56 = 2114;
            v57 = v11;
            v58 = 2114;
            v59 = v32;
            _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} previously in-flight now on filesystem validated | entryID:%{public}@, adoptedDescriptor:%{public}@", buf, 0x20u);

            v8 = v47;
          }

          [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v16];
          [v16 setIsOnFilesystem:1];
          v33 = [v16 metadata];
          v34 = [v33 safeIntegerForKey:@"_UnarchivedSize"];

          if (v34 >= 1)
          {
            [v16 setDownloadedNetworkBytes:v34];
            [v16 setDownloadedFilesystemBytes:v34];
          }

          LOBYTE(v44) = 0;
          [(MADAutoAssetControlManager *)self trackDescriptor:v16 persisting:1 fromLocation:@"loadPersistedDescriptors" changedWhileTerminated:1 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v44];
          [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"previously in-flight now on filesystem validated"];
        }

        else
        {
          v38 = [v16 assetId];

          v9 = v48;
          if (v38)
          {
            [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"JOB_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"previously in-flight not on filesystem (will resume once active)"];
          }

          else
          {
            v39 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [v39 removePersistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

            v40 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            [v40 addObject:v16];

            v9 = v48;
            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedDescriptors" forComponentType:@"JOB_DESCRIPTORS" removedPersistedEntryID:v11 removedDescriptor:v16 message:@"not adopting previous job (since not representing dowloaded or downloading content)"];
          }
        }

LABEL_18:

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v49 != v10);
      v41 = [v8 countByEnumeratingWithState:&v50 objects:v60 count:16];
      v49 = v41;
      if (!v41)
      {
LABEL_41:

        v7 = v45;
        v42 = v46;
        goto LABEL_44;
      }
    }
  }

  v42 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
  {
    v43 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v55 = v43;
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} no persisted auto-asset-jobs to be resumed", buf, 0xCu);
  }

LABEL_44:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedDescriptors" forComponentType:@"KNOWN_DESCRIPTORS"];
}

- (void)loadPersistedSetConfigurations
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  [v5 loadPersistedState:@"loadPersistedSetConfigurations"];

  v6 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v7 = [v6 persistedEntryIDs:@"loadPersistedSetConfigurations"];

  if ([v7 count])
  {
    v48 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetConfigurations" ofContainer:@"persistedKnownSetConfigurations"];
    v59 = 0u;
    v60 = 0u;
    v57 = 0u;
    v58 = 0u;
    v47 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v57 objects:v66 count:16];
    if (!v8)
    {
      goto LABEL_29;
    }

    v9 = v8;
    v10 = @"AutoControl";
    v51 = *v58;
    while (1)
    {
      v11 = 0;
      v49 = v9;
      do
      {
        if (*v58 != v51)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v57 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        v14 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v15 = [v14 persistedEntry:v12 fromLocation:@"loadPersistedSetConfigurations"];

        if (v12)
        {
          v16 = v15 == 0;
        }

        else
        {
          v16 = 1;
        }

        if (v16)
        {
          v21 = _MADLog(v10);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
          {
            v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v18 = v17;
            *buf = 138543618;
            v19 = @"N";
            if (v12)
            {
              v19 = v12;
            }

            v63 = v17;
            v64 = 2114;
            v65 = v19;
            _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetConfigurations} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          v20 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v21 = [v20 decodeFromLocation:@"loadPersistedSetConfigurations" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

          if (v21)
          {
            v22 = v10;
            v23 = [v21 newerVersionError];
            v24 = [v23 code];

            if (v24 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
              [v21 setNewerVersionError:0];
            }

            v25 = [v21 availableForUseError];
            v26 = [v25 code];

            if (v26 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
              [v21 setAvailableForUseError:0];
              goto LABEL_25;
            }

            if (v24 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
LABEL_25:
              [v15 persistSecureCodedObject:v21 forKey:@"setConfiguration"];
              v29 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              v30 = [v21 summary];
              [v29 storePersistedEntry:v12 withEntrySummary:v30 fromLocation:@"loadPersistedSetConfigurations"];

              v31 = [NSString alloc];
              v32 = [v21 summary];
              v33 = [v31 initWithFormat:@"altered set-configuration converted same-version-found error(s) to SUCCESS | setConfiguration:%@ ", v32];
              [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:@"loadPersistedSetConfigurations" operation:@"ENTRY_MODIFY" forPersistedEntryID:v12 withSetConfiguration:v21 historyOperation:447 message:v33];
            }

            [(MADAutoAssetControlManager *)self setConfigurationLoadedFromPersisted:v21 persistedEntryID:v12];
            v10 = v22;
            v9 = v49;
            goto LABEL_27;
          }

          v27 = _MADLog(v10);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
          {
            v28 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v63 = v28;
            v64 = 2114;
            v65 = v12;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetConfigurations} unable to load set-configuration | entryID:%{public}@", buf, 0x16u);
          }

          [v48 addObject:v12];
        }

LABEL_27:

        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [obj countByEnumeratingWithState:&v57 objects:v66 count:16];
      if (!v9)
      {
LABEL_29:

        v55 = 0u;
        v56 = 0u;
        v53 = 0u;
        v54 = 0u;
        v52 = v48;
        v34 = [v52 countByEnumeratingWithState:&v53 objects:v61 count:16];
        if (v34)
        {
          v35 = v34;
          v36 = *v54;
          do
          {
            for (i = 0; i != v35; i = i + 1)
            {
              if (*v54 != v36)
              {
                objc_enumerationMutation(v52);
              }

              v38 = *(*(&v53 + 1) + 8 * i);
              v39 = objc_autoreleasePoolPush();
              v40 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              v41 = [v40 persistedEntry:v38 fromLocation:@"loadPersistedSetConfigurations"];

              v42 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              v43 = [v42 decodeFromLocation:@"loadPersistedSetConfigurations" ofEntryName:v38 fromPersistedEntry:v41 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

              if (v43)
              {
                v44 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
                [v44 removePersistedEntry:v38 fromLocation:@"loadPersistedSetConfigurations"];

                [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationRemoved:@"loadPersistedSetConfigurations" removedPersistedEntryID:v38 removedSetConfiguration:v43 message:@"dropped while loading persisted-state"];
              }

              objc_autoreleasePoolPop(v39);
            }

            v35 = [v52 countByEnumeratingWithState:&v53 objects:v61 count:16];
          }

          while (v35);
        }

        v45 = v52;

        v7 = v47;
        goto LABEL_41;
      }
    }
  }

  v45 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
  {
    v46 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v63 = v46;
    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetConfigurations} no persisted set-configurations to be resumed", buf, 0xCu);
  }

LABEL_41:

  [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationTableOfContents:@"loadPersistedSetConfigurations"];
}

- (void)loadPersistedSetAtomicInstances
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  [v5 loadPersistedState:@"loadPersistedSetAtomicInstances"];

  v6 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v7 = [v6 persistedEntryIDs:@"loadPersistedSetAtomicInstances"];

  v44 = self;
  if ([v7 count])
  {
    v46 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetAtomicInstances" ofContainer:@"persistedKnownSetAtomicInstances"];
    v55 = 0u;
    v56 = 0u;
    v53 = 0u;
    v54 = 0u;
    v42 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v53 objects:v62 count:16];
    v9 = self;
    if (v8)
    {
      v10 = v8;
      v11 = *v54;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v54 != v11)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v53 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)v9 persistedKnownSetAtomicInstances];
          v16 = [v15 persistedEntry:v13 fromLocation:@"loadPersistedSetAtomicInstances"];

          if (v13)
          {
            v17 = v16 == 0;
          }

          else
          {
            v17 = 1;
          }

          if (v17)
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              v19 = [(MADAutoAssetControlManager *)v9 _updateLatestSummary];
              v20 = v19;
              *buf = 138543618;
              v21 = @"N";
              if (v13)
              {
                v21 = v13;
              }

              v59 = v19;
              v60 = 2114;
              v61 = v21;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetAtomicInstances} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
            }

            if (v13)
            {
              [v46 addObject:v13];
            }
          }

          else
          {
            v22 = [(MADAutoAssetControlManager *)v9 persistedKnownSetAtomicInstances];
            v23 = [v22 decodeFromLocation:@"loadPersistedSetAtomicInstances" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

            if (v23)
            {
              [(MADAutoAssetControlManager *)v9 atomicInstanceLoadedFromPersisted:v23 persistedEntryID:v13];
            }

            else
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
              {
                v25 = [(MADAutoAssetControlManager *)v9 _updateLatestSummary];
                *buf = 138543618;
                v59 = v25;
                v60 = 2114;
                v61 = v13;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetAtomicInstances} unable to load set-atomic-instance | entryID:%{public}@", buf, 0x16u);

                v9 = v44;
              }

              [v46 addObject:v13];
            }
          }

          objc_autoreleasePoolPop(v14);
        }

        v10 = [obj countByEnumeratingWithState:&v53 objects:v62 count:16];
      }

      while (v10);
    }

    v51 = 0u;
    v52 = 0u;
    v49 = 0u;
    v50 = 0u;
    v26 = v46;
    v47 = [v26 countByEnumeratingWithState:&v49 objects:v57 count:16];
    if (v47)
    {
      v45 = *v50;
      v43 = v26;
      do
      {
        for (j = 0; j != v47; j = j + 1)
        {
          if (*v50 != v45)
          {
            objc_enumerationMutation(v43);
          }

          v28 = *(*(&v49 + 1) + 8 * j);
          v29 = objc_autoreleasePoolPush();
          v30 = [(MADAutoAssetControlManager *)v9 persistedKnownSetAtomicInstances];
          v31 = [v30 persistedEntry:v28 fromLocation:@"loadPersistedSetAtomicInstances"];

          v32 = [(MADAutoAssetControlManager *)v9 persistedKnownSetAtomicInstances];
          v33 = [v32 decodeFromLocation:@"loadPersistedSetAtomicInstances" ofEntryName:v28 fromPersistedEntry:v31 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

          if (v33)
          {
            v34 = [(MADAutoAssetControlManager *)v9 persistedKnownSetAtomicInstances];
            [v34 removePersistedEntry:v28 fromLocation:@"loadPersistedSetAtomicInstances"];

            v35 = [v33 instanceEntries];
            v36 = [v35 count];
            v37 = [v33 clientDomainName];
            v38 = [v33 assetSetIdentifier];
            [v33 atomicInstanceUUID];
            v40 = v39 = v29;
            [MADAutoAssetHistory recordOperation:320 toHistoryType:2 fromLayer:1 usageCount:v36 forClientDomainName:v37 forAssetSetIdentifier:v38 forAtomicInstance:v40];

            v29 = v39;
            v9 = v44;
            [(MADAutoAssetControlManager *)v44 _logPersistedSetAtomicInstanceRemoved:@"loadPersistedSetAtomicInstances" removedPersistedEntryID:v28 removedSetAtomicInstance:v33 message:@"dropped while loading persisted-state"];
          }

          objc_autoreleasePoolPop(v29);
        }

        v26 = v43;
        v47 = [v43 countByEnumeratingWithState:&v49 objects:v57 count:16];
      }

      while (v47);
    }

    v7 = v42;
  }

  else
  {
    v26 = _MADLog(@"AutoControl");
    v9 = v44;
    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
    {
      v41 = [(MADAutoAssetControlManager *)v44 _updateLatestSummary];
      *buf = 138543362;
      v59 = v41;
      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetAtomicInstances} no persisted set-atomic-instances to be resumed", buf, 0xCu);
    }
  }

  [(MADAutoAssetControlManager *)v9 _logPersistedSetAtomicInstanceTableOfContents:@"loadPersistedSetAtomicInstances"];
}

- (void)loadPersistedSetDownloadedDescriptors
{
  v2 = self;
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
  [v5 loadPersistedState:@"loadPersistedSetDownloadedDescriptors"];

  v6 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
  v7 = [v6 persistedEntryIDs:@"loadPersistedSetDownloadedDescriptors"];

  v88 = +[NSFileManager defaultManager];
  if ([v7 count])
  {
    v8 = objc_alloc_init(NSMutableArray);
    v78 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)v2 trackPerformanceIteration:@"loadPersistedSetDownloadedDescriptors" ofContainer:@"persistedDownloadedSetDescriptors"];
    v102 = 0u;
    v103 = 0u;
    v100 = 0u;
    v101 = 0u;
    v77 = v7;
    v9 = v7;
    v10 = [v9 countByEnumeratingWithState:&v100 objects:v110 count:16];
    v79 = v8;
    if (!v10)
    {
      goto LABEL_37;
    }

    v11 = v10;
    v86 = *v101;
    v80 = v9;
    while (1)
    {
      v12 = 0;
      v83 = v11;
      do
      {
        if (*v101 != v86)
        {
          objc_enumerationMutation(v9);
        }

        v13 = *(*(&v100 + 1) + 8 * v12);
        v14 = objc_autoreleasePoolPush();
        v15 = v14;
        if (v13)
        {
          v89 = v14;
          v16 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
          v17 = [v16 persistedEntry:v13 fromLocation:@"loadPersistedSetDownloadedDescriptors"];

          if (!v17)
          {
            v29 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
            {
              v30 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
              *buf = 138543618;
              v107 = v30;
              v108 = 2114;
              v109 = v13;
              _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
            }

            [v8 addObject:v13];
            goto LABEL_34;
          }

          v18 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
          v19 = [v18 decodeFromLocation:@"loadPersistedSetDownloadedDescriptors" ofEntryName:v13 fromPersistedEntry:v17 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (v19)
          {
            v20 = [v19 latestDownloadedAtomicInstance];

            if (v20)
            {
              if ([(MADAutoAssetControlManager *)v2 setDescriptorAllEntriesDownloaded:@"loadPersistedSetDownloadedDescriptors" forSetDescriptor:v19 loggingEntryExists:1])
              {
                if (![(MADAutoAssetControlManager *)v2 setDescriptorVerifyNoDuplicates:v19])
                {
                  [v78 addObject:v13];
                }

                [(MADAutoAssetControlManager *)v2 updateAutoAssetSetStatus:@"loadPersistedSetDownloadedDescriptors(validated)" forSetDescriptor:v19];
                [(MADAutoAssetControlManager *)v2 _logPersistedSetDescriptor:@"loadPersistedSetDownloadedDescriptors(validated)" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v13 forClientRequest:0 withJobUUID:0 withSetDescriptor:v19 message:@"downloaded-by-instance set-descriptor validated"];
                v21 = [v19 latestDowloadedAtomicInstanceEntries];
                v22 = [v21 count];
                v23 = [v19 clientDomainName];
                v24 = [v19 assetSetIdentifier];
                v25 = [v19 discoveredAtomicInstance];
                v26 = [(MADAutoAssetControlManager *)v2 _specifierVersionNamesForSetDescriptor:v19];
                [MADAutoAssetHistory recordOperation:420 toHistoryType:0 fromLayer:1 usageCount:v22 forClientDomainName:v23 forAssetSetIdentifier:v24 forAtomicInstance:v25 withAddendumMessage:v26];

                v8 = v79;
                v9 = v80;
                v11 = v83;
LABEL_33:

LABEL_34:
                v15 = v89;
                goto LABEL_35;
              }

              v34 = [(MADAutoAssetControlManager *)v2 setDescriptorLocked:v19];
              v35 = _MADLog(@"AutoControl");
              v36 = os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT);
              if (v34)
              {
                if (v36)
                {
                  v37 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
                  v38 = [v19 summary];
                  *buf = 138543618;
                  v107 = v37;
                  v108 = 2114;
                  v109 = v38;
                  v39 = v35;
                  v40 = "[%{public}@] {loadPersistedSetDownloadedDescriptors} incomplete set-descriptor currently locked - dropped | setDescriptor:%{public}@";
                  goto LABEL_31;
                }
              }

              else if (v36)
              {
                v37 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
                v38 = [v19 summary];
                *buf = 138543618;
                v107 = v37;
                v108 = 2114;
                v109 = v38;
                v39 = v35;
                v40 = "[%{public}@] {loadPersistedSetDownloadedDescriptors} incomplete set-descriptor not currently locked - dropped | setDescriptor:%{public}@";
LABEL_31:
                _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, v40, buf, 0x16u);
              }

              [v8 addObject:v13];
              v9 = v80;
              goto LABEL_33;
            }

            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
            {
              v32 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
              v33 = [v19 summary];
              *buf = 138543618;
              v107 = v32;
              v108 = 2114;
              v109 = v33;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} set-descriptor without latestDownloadedAtomicInstance - dropped | setDescriptor:%{public}@", buf, 0x16u);

LABEL_24:
              v11 = v83;
            }
          }

          else
          {
            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
            {
              v32 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
              *buf = 138543618;
              v107 = v32;
              v108 = 2114;
              v109 = v13;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
              goto LABEL_24;
            }
          }

          [v8 addObject:v13];
          goto LABEL_33;
        }

        v17 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
        {
          [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
          v28 = v27 = v15;
          *buf = 138543362;
          v107 = v28;
          _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no entryID", buf, 0xCu);

          v15 = v27;
        }

LABEL_35:

        objc_autoreleasePoolPop(v15);
        v12 = v12 + 1;
      }

      while (v11 != v12);
      v11 = [v9 countByEnumeratingWithState:&v100 objects:v110 count:16];
      if (!v11)
      {
LABEL_37:

        v98 = 0u;
        v99 = 0u;
        v96 = 0u;
        v97 = 0u;
        v41 = v78;
        v84 = v41;
        v90 = [v41 countByEnumeratingWithState:&v96 objects:v105 count:16];
        if (v90)
        {
          v42 = *v97;
          v43 = @"loadPersistedSetDownloadedDescriptors";
          v82 = v2;
          do
          {
            for (i = 0; i != v90; i = i + 1)
            {
              if (*v97 != v42)
              {
                objc_enumerationMutation(v41);
              }

              v45 = *(*(&v96 + 1) + 8 * i);
              v46 = objc_autoreleasePoolPush();
              v47 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
              v48 = [v47 persistedEntry:v45 fromLocation:v43];

              v49 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
              v50 = [v49 decodeFromLocation:v43 ofEntryName:v45 fromPersistedEntry:v48 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              if (v50)
              {
                v51 = [(MADAutoAssetControlManager *)v2 setDescriptorDedupDownloadedEntries:v43 forSetDescriptor:v50];
                if (v51)
                {
                  [(MADAutoAssetControlManager *)v2 persistSetDescriptorDownloadedJob:v51 fromLocation:v43];
                  v52 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
                  {
                    v53 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
                    [v51 summary];
                    v54 = v43;
                    v56 = v55 = v42;
                    *buf = 138543618;
                    v107 = v53;
                    v108 = 2114;
                    v109 = v56;
                    _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors}\n[SELF-HEAL] deduped setDescriptor:%{public}@", buf, 0x16u);

                    v42 = v55;
                    v43 = v54;
                    v2 = v82;

                    v41 = v84;
                  }
                }
              }

              objc_autoreleasePoolPop(v46);
            }

            v90 = [v41 countByEnumeratingWithState:&v96 objects:v105 count:16];
          }

          while (v90);
        }

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        v57 = v79;
        v91 = [v57 countByEnumeratingWithState:&v92 objects:v104 count:16];
        if (v91)
        {
          v87 = *v93;
          obj = v57;
          do
          {
            for (j = 0; j != v91; j = j + 1)
            {
              if (*v93 != v87)
              {
                objc_enumerationMutation(obj);
              }

              v59 = *(*(&v92 + 1) + 8 * j);
              v60 = objc_autoreleasePoolPush();
              v61 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
              v62 = [v61 persistedEntry:v59 fromLocation:@"loadPersistedSetDownloadedDescriptors"];

              v63 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
              v64 = [v63 decodeFromLocation:@"loadPersistedSetDownloadedDescriptors" ofEntryName:v59 fromPersistedEntry:v62 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              v65 = [v64 clientDomainName];
              v66 = [v64 assetSetIdentifier];
              v67 = [v64 latestDownloadedAtomicInstance];
              v68 = [MANAutoAssetSetStatus shortTermLockFilename:v65 forAssetSetIdentifier:v66 forSetAtomicInstance:v67];

              if (v64)
              {
                if ([(MADAutoAssetControlManager *)v2 setDescriptorLocked:v64])
                {
                  v69 = objc_alloc_init(NSMutableArray);
                  [v69 addObject:v64];
                  v70 = [MADAutoAssetLocker eliminateAllPreviousSetLocksNoLongerTracked:v69];
                  v71 = _MADLog(@"AutoControl");
                  v72 = os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT);
                  if (v70)
                  {
                    if (v72)
                    {
                      v73 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
                      v74 = [v70 count];
                      *buf = 138543618;
                      v107 = v73;
                      v108 = 2048;
                      v109 = v74;
                      _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} just unlocked selectors:%ld", buf, 0x16u);
                    }
                  }

                  else if (v72)
                  {
                    v81 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
                    *buf = 138543362;
                    v107 = v81;
                    _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no selectors just unlocked", buf, 0xCu);
                  }
                }

                [(MADAutoAssetControlManager *)v2 secureCheckUngraftAll:@"loadPersistedSetDownloadedDescriptors" forSetDescriptorNoLongerLocked:v64];
                if (__isPlatformVersionAtLeast(2, 18, 4, 0))
                {
                  [(MADAutoAssetControlManager *)v2 notifyEvictedCallbacksForSetDescriptor:v64];
                }

                [(MADAutoAssetControlManager *)v2 removeSetDescriptorDownloaded:v64 fromLocation:@"loadPersistedSetDownloadedDescriptors" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:329 historyOperationSD:373];
              }

              v75 = [(MADAutoAssetControlManager *)v2 _shortTermSharedLockRemove:@"loadPersistedSetDownloadedDescriptors" removingSharedLockFilename:v68 usingFileManager:v88 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];

              objc_autoreleasePoolPop(v60);
            }

            v57 = obj;
            v91 = [obj countByEnumeratingWithState:&v92 objects:v104 count:16];
          }

          while (v91);
        }

        v7 = v77;
        goto LABEL_71;
      }
    }
  }

  v57 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
  {
    v76 = [(MADAutoAssetControlManager *)v2 _updateLatestSummary];
    *buf = 138543362;
    v107 = v76;
    _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no persisted set-descriptors to be resumed", buf, 0xCu);
  }

LABEL_71:

  [(MADAutoAssetControlManager *)v2 _logPersistedSetDescriptorTableOfContents:@"loadPersistedSetDownloadedDescriptors" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS"];
}

- (void)loadPersistedSetActiveJobDescriptors
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  [v5 loadPersistedState:@"loadPersistedSetActiveJobDescriptors"];

  v6 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v7 = [v6 persistedEntryIDs:@"loadPersistedSetActiveJobDescriptors"];

  if ([v7 count])
  {
    v90 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetActiveJobDescriptors" ofContainer:@"persistedActiveJobSetDescriptors"];
    v98 = 0u;
    v99 = 0u;
    v96 = 0u;
    v97 = 0u;
    v78 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
    if (!v8)
    {
      v79 = 0;
      goto LABEL_63;
    }

    v9 = v8;
    v79 = 0;
    v10 = *v97;
    v83 = *v97;
    while (1)
    {
      v11 = 0;
      v84 = v9;
      do
      {
        if (*v97 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v96 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        if (v12)
        {
          v14 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
          v15 = [v14 persistedEntry:v12 fromLocation:@"loadPersistedSetActiveJobDescriptors"];

          if (v15)
          {
            v16 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
            v17 = [v16 decodeFromLocation:@"loadPersistedSetActiveJobDescriptors" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              v18 = [v17 assetSetIdentifier];

              if (v18)
              {
                v19 = [v17 discoveredAtomicInstance];

                if (v19)
                {
                  v20 = [v17 discoveredAtomicEntries];

                  if (v20)
                  {
                    if (![v17 isOnFilesystem] || objc_msgSend(v17, "onFilesystemIncomplete"))
                    {
                      v21 = [v17 clientDomainName];
                      v22 = [v17 assetSetIdentifier];
                      v87 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v21 forAssetSetIdentifier:v22];

                      v23 = [v17 discoveredAtomicInstance];
                      v24 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v23];

                      v25 = [v17 discoveredAtomicInstance];
                      v26 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedSetActiveJobDescriptors" forAtomicInstanceUUID:v25 requireExists:0];

                      v27 = [v17 discoveredAtomicInstance];
                      v28 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:v27];

                      v88 = v26;
                      v85 = v24;
                      v86 = v28;
                      if (!v26)
                      {
                        if (v28)
                        {
                          v42 = _MADLog(@"AutoControl");
                          v10 = v83;
                          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
                          {
                            v80 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            v43 = [v17 summary];
                            v44 = [v86 summary];
                            *buf = 138543874;
                            v102 = v80;
                            v103 = 2114;
                            v104 = v43;
                            v105 = 2114;
                            v106 = v44;
                            v45 = v44;
                            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor repeated (already adopted set-job) | dropping repeated setJobDescriptor:%{public}@ | already tracking active setJobDescriptor:%{public}@", buf, 0x20u);
                          }
                        }

                        else
                        {
                          v10 = v83;
                          if (v87)
                          {
                            if (v24)
                            {
                              [(MADAutoAssetControlManager *)self locateActiveAutoJobForSetDescriptor:v17];
                              v81 = v9 = v84;
                              if (v81)
                              {
                                ++v79;
                                [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:@"resumeSetJobsWhenBeforeFirstUnlock" forSetDescriptor:v17];
                              }

                              else
                              {
                                v51 = _MADLog(@"AutoControl");
                                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                                {
                                  v77 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                  v52 = [v17 summary];
                                  *buf = 138543618;
                                  v102 = v77;
                                  v103 = 2114;
                                  v104 = v52;
                                  v53 = v52;
                                  _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no active active auto-asset-job | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                                }

                                [v90 addObject:v12];
                                v24 = v85;
                              }
                            }

                            else
                            {
                              v48 = _MADLog(@"AutoControl");
                              v9 = v84;
                              if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
                              {
                                v82 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v49 = [v17 summary];
                                *buf = 138543618;
                                v102 = v82;
                                v103 = 2114;
                                v104 = v49;
                                v50 = v49;
                                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no set-atomic-instance | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                              }

                              [v90 addObject:v12];
                              v24 = v85;
                            }

                            goto LABEL_43;
                          }

                          v42 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
                          {
                            v46 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            v47 = [v17 summary];
                            *buf = 138543618;
                            v102 = v46;
                            v103 = 2114;
                            v104 = v47;
                            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no set-configuration | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                          }
                        }

                        [v90 addObject:v12];
                        v24 = v85;
                        goto LABEL_42;
                      }

                      v29 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
                      {
                        v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        v31 = [v17 summary];
                        v32 = [v88 summary];
                        *buf = 138543874;
                        v102 = v30;
                        v103 = 2114;
                        v104 = v31;
                        v105 = 2114;
                        v106 = v32;
                        _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetActiveJobDescriptors} not considering resuming active-set-job since have already downloaded set-descriptor | setJobDescriptor:%{public}@ | downloadedSetDescriptor:%{public}@", buf, 0x20u);
                      }

                      [v90 addObject:v12];
                      v24 = v85;
                      v10 = v83;
LABEL_42:
                      v9 = v84;
LABEL_43:
                    }

LABEL_35:

                    goto LABEL_36;
                  }

                  v37 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                  {
                    v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v102 = v38;
                    v103 = 2114;
                    v104 = v12;
                    v39 = v37;
                    v40 = OS_LOG_TYPE_DEFAULT;
                    v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without discoveredAtomicEntries | entryID:%{public}@";
LABEL_33:
                    _os_log_impl(&dword_0, v39, v40, v41, buf, 0x16u);
                  }
                }

                else
                {
                  v37 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                  {
                    v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v102 = v38;
                    v103 = 2114;
                    v104 = v12;
                    v39 = v37;
                    v40 = OS_LOG_TYPE_DEFAULT;
                    v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without discoveredAtomicInstance | entryID:%{public}@";
                    goto LABEL_33;
                  }
                }
              }

              else
              {
                v37 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                {
                  v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v102 = v38;
                  v103 = 2114;
                  v104 = v12;
                  v39 = v37;
                  v40 = OS_LOG_TYPE_DEFAULT;
                  v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without assetSetIdentifier | entryID:%{public}@";
                  goto LABEL_33;
                }
              }
            }

            else
            {
              v37 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
              {
                v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543618;
                v102 = v38;
                v103 = 2114;
                v104 = v12;
                v39 = v37;
                v40 = OS_LOG_TYPE_ERROR;
                v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} unable to load auto-asset-set-descriptor | entryID:%{public}@";
                goto LABEL_33;
              }
            }

            [v90 addObject:v12];
            goto LABEL_35;
          }
        }

        v33 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
        {
          v34 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v35 = v34;
          *buf = 138543618;
          v36 = @"N";
          if (v12)
          {
            v36 = v12;
          }

          v102 = v34;
          v103 = 2114;
          v104 = v36;
          _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
        }

        if (v12)
        {
          [v90 addObject:v12];
        }

LABEL_36:
        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v54 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
      v9 = v54;
      if (!v54)
      {
LABEL_63:

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        v55 = v90;
        v57 = [v55 countByEnumeratingWithState:&v92 objects:v100 count:16];
        if (v57)
        {
          v58 = v57;
          v59 = *v93;
          v91 = v55;
          do
          {
            for (i = 0; i != v58; i = i + 1)
            {
              if (*v93 != v59)
              {
                objc_enumerationMutation(v91);
              }

              v61 = *(*(&v92 + 1) + 8 * i);
              v62 = objc_autoreleasePoolPush();
              if (v61)
              {
                v63 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                v64 = [v63 persistedEntry:v61 fromLocation:@"loadPersistedSetActiveJobDescriptors"];

                v65 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                v66 = [v65 decodeFromLocation:@"loadPersistedSetActiveJobDescriptors" ofEntryName:v61 fromPersistedEntry:v64 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                if (v66)
                {
                  v67 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                  [v67 removePersistedEntry:v61 fromLocation:@"resumeSetJobsWhenBeforeFirstUnlock"];

                  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:@"loadPersistedSetActiveJobDescriptors" forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v61 removedSetDescriptor:v66 message:@"removing stale active-persisted set-job"];
                }
              }

              else
              {
                v64 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                v66 = [v64 diag];
                v68 = [NSString alloc];
                v69 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v70 = [v68 initWithFormat:@"{loadPersistedSetActiveJobDescriptors} nil entryID encountered on staleActivePersistedEntryIDs | %@", v69];
                [v66 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v70 withResult:6108 withError:0];
              }

              objc_autoreleasePoolPop(v62);
            }

            v55 = v91;
            v58 = [v91 countByEnumeratingWithState:&v92 objects:v100 count:16];
          }

          while (v58);
        }

        v56 = _MADLog(@"AutoControl");
        v71 = os_log_type_enabled(v56, OS_LOG_TYPE_DEFAULT);
        if (v79 < 1)
        {
          v7 = v78;
          if (v71)
          {
            v72 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543362;
            v102 = v72;
            v74 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} no set-jobs resumed | MA_MILESTONE";
            v75 = v56;
            v76 = 12;
            goto LABEL_81;
          }
        }

        else
        {
          v7 = v78;
          if (v71)
          {
            v72 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v73 = @"s";
            *buf = 138543874;
            v102 = v72;
            if (v79 == 1)
            {
              v73 = &stru_4BD3F0;
            }

            v103 = 2048;
            v104 = v79;
            v105 = 2114;
            v106 = v73;
            v74 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} resumed %ld set-job%{public}@ | MA_MILESTONE";
            v75 = v56;
            v76 = 32;
LABEL_81:
            _os_log_impl(&dword_0, v75, OS_LOG_TYPE_DEFAULT, v74, buf, v76);
          }
        }

LABEL_82:

        goto LABEL_83;
      }
    }
  }

  v55 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
  {
    v56 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v102 = v56;
    _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetActiveJobDescriptors} no persisted auto-asset-set-jobs to be resumed | MA_MILESTONE", buf, 0xCu);
    goto LABEL_82;
  }

LABEL_83:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedSetActiveJobDescriptors" forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS"];
}

- (void)loadPersistedSetTargets
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [v5 loadPersistedState:@"loadPersistedSetTargets"];

  v6 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v7 = [v6 persistedConfig];
  v8 = [v7 stringForKey:@"bootedOSVersion"];

  v9 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v10 = [v9 persistedConfig];
  v11 = [v10 stringForKey:@"bootedBuildVersion"];

  v12 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v13 = [v12 persistedEntryIDs:@"loadPersistedSetTargets"];

  if (v8)
  {
    v14 = v11 == 0;
  }

  else
  {
    v14 = 1;
  }

  v15 = !v14;
  if (v14)
  {
    v40 = @"previous MA daemon execution was running version prior to having support for set-targets";
  }

  else
  {
    v16 = [(MADAutoAssetControlManager *)self bootedOSVersion];
    if (([SUCore stringIsEqual:v8 to:v16]& 1) != 0)
    {
      v17 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
      v18 = [SUCore stringIsEqual:v11 to:v17];

      if (v18)
      {
        v19 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
        {
          v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v21 = [(MADAutoAssetControlManager *)self bootedOSVersion];
          v22 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
          *buf = 138543874;
          v83 = v20;
          v84 = 2114;
          v85 = v21;
          v86 = 2114;
          v87 = v22;
          _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetTargets} keeping set-targets (and not adjusting set-configurations) since last-OS version matches current OS version | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
        }

        if ([v13 count])
        {
          v68 = v11;
          v70 = v8;
          [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetTargets" ofContainer:@"persistedSetTargets"];
          v80 = 0u;
          v81 = 0u;
          v78 = 0u;
          v79 = 0u;
          v66 = v13;
          v23 = v13;
          obj = [v23 countByEnumeratingWithState:&v78 objects:v91 count:16];
          if (!obj)
          {
            goto LABEL_28;
          }

          v24 = *v79;
          while (1)
          {
            for (i = 0; i != obj; i = i + 1)
            {
              if (*v79 != v24)
              {
                objc_enumerationMutation(v23);
              }

              v26 = *(*(&v78 + 1) + 8 * i);
              v27 = objc_autoreleasePoolPush();
              v28 = [(MADAutoAssetControlManager *)self persistedSetTargets];
              v29 = [v28 persistedEntry:v26 fromLocation:@"loadPersistedSetTargets"];

              if (v29)
              {
                v30 = [(MADAutoAssetControlManager *)self persistedSetTargets];
                v31 = [v30 decodeFromLocation:@"loadPersistedSetTargets" ofEntryName:v26 fromPersistedEntry:v29 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

                if (v31)
                {
                  [(MADAutoAssetControlManager *)self _logPersistedSetTarget:@"loadPersistedSetTargets" operation:@"ENTRY_LOAD" forPersistedEntryID:v26 withSetTarget:v31 message:@"set-target validated"];
                  goto LABEL_26;
                }

                v32 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
                {
                  [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  v33 = v24;
                  v35 = v34 = v23;
                  *buf = 138543618;
                  v83 = v35;
                  v84 = 2114;
                  v85 = v26;
                  _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetTargets} unable to load set-target | entryID:%{public}@", buf, 0x16u);

                  v23 = v34;
                  v24 = v33;
                }
              }

              else
              {
                v31 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
                {
                  goto LABEL_26;
                }

                v32 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543618;
                v83 = v32;
                v84 = 2114;
                v85 = v26;
                _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetTargets} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
              }

LABEL_26:
              objc_autoreleasePoolPop(v27);
            }

            obj = [v23 countByEnumeratingWithState:&v78 objects:v91 count:16];
            if (!obj)
            {
LABEL_28:

              v36 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
              {
                v37 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v38 = [(MADAutoAssetControlManager *)self bootedOSVersion];
                v39 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
                *buf = 138543874;
                v83 = v37;
                v84 = 2114;
                v85 = v38;
                v86 = 2114;
                v87 = v39;
                _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetConfigurations} set-targets preserved | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
              }

              v11 = v68;
              v8 = v70;
              v13 = v66;
              goto LABEL_55;
            }
          }
        }

        v36 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
        {
          goto LABEL_55;
        }

        v59 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v60 = [(MADAutoAssetControlManager *)self bootedOSVersion];
        v61 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
        *buf = 138543874;
        v83 = v59;
        v84 = 2114;
        v85 = v60;
        v86 = 2114;
        v87 = v61;
        v62 = "[%{public}@] {loadPersistedSetConfigurations} no persisted set-targets to be resumed | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@";
        v63 = v36;
        v64 = 32;
LABEL_54:
        _os_log_impl(&dword_0, v63, OS_LOG_TYPE_DEFAULT, v62, buf, v64);

        goto LABEL_55;
      }
    }

    else
    {
    }

    [(MADAutoAssetControlManager *)self setBootedSoftwareUpdate:1];
    v40 = @"previous MA daemon execution was running from different OS version than booted OS version";
  }

  v41 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v42 = [v41 persistedConfig];
  v43 = [(MADAutoAssetControlManager *)self bootedOSVersion];
  [v42 persistString:v43 forKey:@"bootedOSVersion"];

  v44 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v45 = [v44 persistedConfig];
  v46 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
  [v45 persistString:v46 forKey:@"bootedBuildVersion"];

  if (v15 && [v13 count])
  {
    v65 = v40;
    v67 = v13;
    v69 = v11;
    v71 = v8;
    v76 = 0u;
    v77 = 0u;
    v74 = 0u;
    v75 = 0u;
    obja = v13;
    v47 = [obja countByEnumeratingWithState:&v74 objects:v90 count:16];
    if (v47)
    {
      v48 = v47;
      v49 = *v75;
      do
      {
        for (j = 0; j != v48; j = j + 1)
        {
          if (*v75 != v49)
          {
            objc_enumerationMutation(obja);
          }

          v51 = *(*(&v74 + 1) + 8 * j);
          v52 = objc_autoreleasePoolPush();
          v53 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v54 = [v53 persistedEntry:v51 fromLocation:@"loadPersistedSetTargets"];

          if (v54)
          {
            v55 = [(MADAutoAssetControlManager *)self persistedSetTargets];
            v56 = [v55 decodeFromLocation:@"loadPersistedSetTargets" ofEntryName:v51 fromPersistedEntry:v54 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v56)
            {
              [(MADAutoAssetControlManager *)self modifySetConfiguration:@"loadPersistedSetTargets" toEntriesFromSetTarget:v56];
            }

            else
            {
              v57 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v83 = v51;
                _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "{loadPersistedSetTargets} | no set-target entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v56 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v83 = v51;
              _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "{loadPersistedSetTargets} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v52);
        }

        v48 = [obja countByEnumeratingWithState:&v74 objects:v90 count:16];
      }

      while (v48);
    }

    v11 = v69;
    v8 = v71;
    v40 = v65;
    v13 = v67;
  }

  v58 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [v58 removeAllPersistedEntries:v40];

  v36 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
  {
    v59 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v60 = [(MADAutoAssetControlManager *)self bootedOSVersion];
    v61 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
    *buf = 138544130;
    v83 = v59;
    v84 = 2114;
    v85 = v40;
    v86 = 2114;
    v87 = v60;
    v88 = 2114;
    v89 = v61;
    v62 = "[%{public}@] {loadPersistedSetConfigurations} all set-targets removed | reason:%{public}@ | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@";
    v63 = v36;
    v64 = 42;
    goto LABEL_54;
  }

LABEL_55:

  [(MADAutoAssetControlManager *)self _logPersistedSetTargetTableOfContents:@"loadPersistedSetTargets"];
}

- (void)loadPersistedActiveJobs
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  [v5 loadPersistedState:@"loadPersistedActiveJobs"];

  v6 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v7 = [v6 persistedEntryIDs:@"loadPersistedActiveJobs"];

  v8 = objc_alloc_init(NSMutableArray);
  v56 = v7;
  if ([v7 count])
  {
    v57 = v8;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedActiveJobs" ofContainer:@"persistedActiveJobs"];
    v70 = 0u;
    v71 = 0u;
    v68 = 0u;
    v69 = 0u;
    obj = v7;
    v62 = [obj countByEnumeratingWithState:&v68 objects:v79 count:16];
    if (v62)
    {
      v61 = *v69;
      do
      {
        v9 = 0;
        do
        {
          if (*v69 != v61)
          {
            objc_enumerationMutation(obj);
          }

          v10 = *(*(&v68 + 1) + 8 * v9);
          v11 = objc_autoreleasePoolPush();
          v12 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          v13 = [v12 persistedEntry:v10 fromLocation:@"loadPersistedActiveJobs"];

          if (v10)
          {
            v14 = v13 == 0;
          }

          else
          {
            v14 = 1;
          }

          if (!v14)
          {
            v18 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v19 = [v18 decodeFromLocation:@"loadPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v19)
            {
              if ([v19 isBlankEntry])
              {
                v20 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
                {
                  v21 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v74 = v21;
                  v75 = 2114;
                  v76 = v10;
                  v22 = v20;
                  v23 = OS_LOG_TYPE_DEFAULT;
                  v24 = "[%{public}@] {loadPersistedActiveJobs} encountered blank previously active-job | entryID:%{public}@";
                  goto LABEL_32;
                }

                goto LABEL_33;
              }

              v25 = [v19 assetVersion];

              if (v25)
              {
                if (![(MADAutoAssetControlManager *)self jobDescriptorInFlightNowOnFilesystem:v19])
                {
                  goto LABEL_34;
                }

                v26 = [MAAutoAssetSelector alloc];
                v27 = [v19 assetType];
                v28 = [v19 assetSpecifier];
                v29 = [v19 assetVersion];
                v20 = [v26 initForAssetType:v27 withAssetSpecifier:v28 matchingAssetVersion:v29];

                v58 = [(MADAutoAssetControlManager *)self jobSelectorKey:v20];
                if (v58)
                {
                  v30 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
                  {
                    v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    v32 = [v19 summary];
                    *buf = 138543874;
                    v74 = v31;
                    v75 = 2114;
                    v76 = v10;
                    v77 = 2114;
                    v78 = v32;
                    _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedActiveJobs} previously in-flight now on filesystem validated | entryID:%{public}@, adoptedDescriptor:%{public}@", buf, 0x20u);
                  }

                  [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v19];
                  [v19 setIsOnFilesystem:1];
                  v33 = [v19 metadata];
                  v34 = [v33 safeIntegerForKey:@"_UnarchivedSize"];

                  if (v34 >= 1)
                  {
                    [v19 setDownloadedNetworkBytes:v34];
                    [v19 setDownloadedFilesystemBytes:v34];
                  }

                  LOBYTE(v55) = 0;
                  [(MADAutoAssetControlManager *)self trackDescriptor:v19 persisting:1 fromLocation:@"loadPersistedActiveJobs" changedWhileTerminated:1 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v55];
                  [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedActiveJobs" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v10 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v19 baseForPatchDescriptor:0 message:@"previously in-flight now on filesystem validated", v56];
                  [v57 addObject:v10];
                }

                else
                {
                  v35 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                  v36 = [v35 diag];
                  v37 = [NSString alloc];
                  v38 = [v20 summary];
                  v39 = [v37 initWithFormat:@"{loadPersistedActiveJobs} nil jobSelectorKey | assetSelector:%@", v38];
                  [v36 trackAnomaly:@"AUTO-CONTROL" forReason:v39 withResult:6103 withError:0];
                }

                goto LABEL_33;
              }

              v20 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
              {
LABEL_33:

                goto LABEL_34;
              }

              v21 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v74 = v21;
              v75 = 2114;
              v76 = v10;
              v22 = v20;
              v23 = OS_LOG_TYPE_DEFAULT;
              v24 = "[%{public}@] {loadPersistedActiveJobs} encountered active-job descriptor without asset-version - not reloaded | entryID:%{public}@";
            }

            else
            {
              v20 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
              {
                goto LABEL_33;
              }

              v21 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v74 = v21;
              v75 = 2114;
              v76 = v10;
              v22 = v20;
              v23 = OS_LOG_TYPE_ERROR;
              v24 = "[%{public}@] {loadPersistedActiveJobs} unable to previously active-job | entryID:%{public}@";
            }

LABEL_32:
            _os_log_impl(&dword_0, v22, v23, v24, buf, 0x16u);

            goto LABEL_33;
          }

          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v16 = v15;
            *buf = 138543618;
            v17 = @"N";
            if (v10)
            {
              v17 = v10;
            }

            v74 = v15;
            v75 = 2114;
            v76 = v17;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedActiveJobs} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }

LABEL_34:

          objc_autoreleasePoolPop(v11);
          v9 = v9 + 1;
        }

        while (v62 != v9);
        v40 = [obj countByEnumeratingWithState:&v68 objects:v79 count:16];
        v62 = v40;
      }

      while (v40);
    }

    v8 = v57;
    if ([v57 count])
    {
      obja = objc_autoreleasePoolPush();
      v64 = 0u;
      v65 = 0u;
      v66 = 0u;
      v67 = 0u;
      v63 = v57;
      v41 = [v63 countByEnumeratingWithState:&v64 objects:v72 count:16];
      if (v41)
      {
        v42 = v41;
        v43 = *v65;
        do
        {
          for (i = 0; i != v42; i = i + 1)
          {
            if (*v65 != v43)
            {
              objc_enumerationMutation(v63);
            }

            v45 = *(*(&v64 + 1) + 8 * i);
            v46 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v47 = [v46 persistedEntry:v45 fromLocation:@"loadPersistedActiveJobs"];

            if (v47)
            {
              v48 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v49 = [v48 decodeFromLocation:@"loadPersistedActiveJobs" ofEntryName:v45 fromPersistedEntry:v47 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              if (v49)
              {
                v50 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                [v50 removePersistedEntry:v45 fromLocation:@"loadPersistedActiveJobs"];

                [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v45 removedDescriptor:v49 message:@"removing stale active-persisted job encountered while loading persisted state"];
              }

              else
              {
                v51 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                {
                  v52 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v74 = v52;
                  v75 = 2114;
                  v76 = v45;
                  _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedActiveJobs} no persisted job descriptor for previously active-job | entryID:%{public}@", buf, 0x16u);
                }
              }
            }
          }

          v42 = [v63 countByEnumeratingWithState:&v64 objects:v72 count:16];
        }

        while (v42);
      }

      objc_autoreleasePoolPop(obja);
      v8 = v57;
    }
  }

  else
  {
    v53 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
    {
      v54 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v74 = v54;
      _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedActiveJobs} no persisted auto-asset active-jobs to be resumed", buf, 0xCu);
    }
  }

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS"];
}

- (void)loadPersistedCrosscheckStaleForceUnlock
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v101 = [(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:@"loadPersistedCrosscheckStaleForceUnlock"];
  v102 = objc_alloc_init(NSMutableArray);
  v106 = objc_alloc_init(NSMutableArray);
  v100 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedCrosscheckStaleForceUnlock" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v131 = 0u;
  v132 = 0u;
  v129 = 0u;
  v130 = 0u;
  v5 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v6 = [v5 countByEnumeratingWithState:&v129 objects:v139 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v130;
    v103 = v5;
    v104 = *v130;
    do
    {
      v9 = 0;
      obj = v7;
      do
      {
        if (*v130 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v129 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        v12 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v13 = [v12 safeObjectForKey:v10 ofClass:objc_opt_class()];

        if (!v13)
        {
          v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v24 = [v15 diag];
          v25 = [[NSString alloc] initWithFormat:@"{loadPersistedCrosscheckStaleForceUnlock} unable to access knownSetAtomicInstancesByInstance | atomicInstanceKey:%@", v10];
          [v24 trackAnomaly:@"STARTUP-CROSSCHECK" forReason:v25 withResult:6103 withError:0];

          goto LABEL_31;
        }

        v110 = v11;
        v14 = [v13 atomicInstanceUUID];
        v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedCrosscheckStaleForceUnlock" forAtomicInstanceUUID:v14 requireExists:0];

        if (v15)
        {
          v16 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"loadPersistedCrosscheckStaleForceUnlock" forSetDescriptor:v15];
          v17 = [v13 clientDomainName];
          v18 = [v13 assetSetIdentifier];
          v19 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v17 forAssetSetIdentifier:v18];

          v20 = [v13 atomicInstanceUUID];
          v21 = [(MADAutoAssetControlManager *)self setConfigurationIsTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v19 forAtomicInstanceUUID:v20];

          if (v19)
          {
            if ([(MADAutoAssetControlManager *)self doesSetDescriptorReferenceDropped:@"loadPersistedCrosscheckStaleForceUnlock" forSetDescriptor:v15])
            {
              [v106 addObject:v13];
              v22 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
              {
                v23 = [v13 summary];
                *buf = 138543362;
                v138 = v23;
                _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping atomic-instance (referenced asset dropped) | setAtomicInstance:%{public}@", buf, 0xCu);
              }

              goto LABEL_13;
            }

            v32 = [v13 atomicInstanceUUID];
            v33 = [v19 latestAtomicInstanceToVend];
            v34 = [SUCore stringIsEqual:v32 to:v33];

            v5 = v103;
            v11 = v110;
            if (v34)
            {
LABEL_30:

              v7 = obj;
              v8 = v104;
              goto LABEL_31;
            }

            v35 = [v13 atomicInstanceUUID];
            v36 = [v19 newerAtomicInstanceOncePersonalized];
            v37 = [SUCore stringIsEqual:v35 to:v36];

            if (v37)
            {
              v38 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
              {
                v39 = [v13 summary];
                *buf = 138543362;
                v138 = v39;
                _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} preserving atomic-instance (newer-once-personalized) | setAtomicInstance:%{public}@", buf, 0xCu);
              }

              v5 = v103;
LABEL_13:
              v11 = v110;
              goto LABEL_30;
            }

            if (v101 & 1 | ((v21 & 1) == 0))
            {
              v5 = v103;
              v11 = v110;
              if ((v16 | v21))
              {
                if (v21)
                {
                  [v100 addObject:v13];
                  goto LABEL_30;
                }

                [v102 addObject:v13];
                v28 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
                {
                  v29 = [v13 summary];
                  *buf = 138543362;
                  v138 = v29;
                  v30 = v28;
                  v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping locked atomic-instance (not latest-to-vend) (not previously-latest-still-locked) | setAtomicInstance:%{public}@";
LABEL_28:
                  _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, v31, buf, 0xCu);
                }
              }

              else
              {
                [v106 addObject:v13];
                v28 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
                {
                  v29 = [v13 summary];
                  *buf = 138543362;
                  v138 = v29;
                  v30 = v28;
                  v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping unlocked atomic-instance (not latest-to-vend) | setAtomicInstance:%{public}@";
                  goto LABEL_28;
                }
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              v5 = v103;
              v11 = v110;
              if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
              {
                v29 = [v13 summary];
                *buf = 138543362;
                v138 = v29;
                v30 = v28;
                v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} preserving locked atomic-instance (previously-vended-locked) | setAtomicInstance:%{public}@";
                goto LABEL_28;
              }
            }
          }

          else if ((v16 | v21))
          {
            [v102 addObject:v13];
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              v29 = [v13 summary];
              *buf = 138543362;
              v138 = v29;
              v30 = v28;
              v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping locked atomic-instance without set-configuration | setAtomicInstance:%{public}@";
              goto LABEL_28;
            }
          }

          else
          {
            [v106 addObject:v13];
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              v29 = [v13 summary];
              *buf = 138543362;
              v138 = v29;
              v30 = v28;
              v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping unlocked atomic-instance without set-configuration | setAtomicInstance:%{public}@";
              goto LABEL_28;
            }
          }

          goto LABEL_30;
        }

        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
        {
          v27 = [v13 summary];
          *buf = 138543362;
          v138 = v27;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping atomic-instance without set-descriptor | setAtomicInstance:%{public}@", buf, 0xCu);
        }

        [v106 addObject:v13];
LABEL_31:

        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v7 != v9);
      v40 = [v5 countByEnumeratingWithState:&v129 objects:v139 count:16];
      v7 = v40;
    }

    while (v40);
  }

  v127 = 0u;
  v128 = 0u;
  v125 = 0u;
  v126 = 0u;
  obja = v102;
  v41 = [obja countByEnumeratingWithState:&v125 objects:v136 count:16];
  if (v41)
  {
    v42 = v41;
    v43 = *v126;
    do
    {
      for (i = 0; i != v42; i = i + 1)
      {
        if (*v126 != v43)
        {
          objc_enumerationMutation(obja);
        }

        v45 = *(*(&v125 + 1) + 8 * i);
        v46 = objc_autoreleasePoolPush();
        if (v45)
        {
          v47 = [v45 clientDomainName];
          v48 = [v45 assetSetIdentifier];
          v49 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v47 forAssetSetIdentifier:v48];

          v50 = [v45 atomicInstanceUUID];
          LOBYTE(v48) = [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v49 removingAtomicInstance:v50];

          if ((v48 & 1) == 0)
          {
            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"loadPersistedCrosscheckStaleForceUnlock" dueToError:0 forgettingAtomicInstance:v45];
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v49 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (forceUnlockAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        }

        objc_autoreleasePoolPop(v46);
      }

      v42 = [obja countByEnumeratingWithState:&v125 objects:v136 count:16];
    }

    while (v42);
  }

  v123 = 0u;
  v124 = 0u;
  v121 = 0u;
  v122 = 0u;
  v107 = v106;
  v51 = [v107 countByEnumeratingWithState:&v121 objects:v135 count:16];
  if (v51)
  {
    v52 = v51;
    v111 = *v122;
    do
    {
      for (j = 0; j != v52; j = j + 1)
      {
        if (*v122 != v111)
        {
          objc_enumerationMutation(v107);
        }

        v54 = *(*(&v121 + 1) + 8 * j);
        v55 = objc_autoreleasePoolPush();
        if (v54)
        {
          v56 = [v54 atomicInstanceUUID];
          v57 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedCrosscheckStaleForceUnlock" forAtomicInstanceUUID:v56 requireExists:0];

          v58 = [v54 clientDomainName];
          v59 = [v54 assetSetIdentifier];
          v60 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v58 forAssetSetIdentifier:v59];

          if (v57)
          {
            [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v57 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:343 historyOperationSD:387];
          }

          else
          {
            v61 = [v54 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"loadPersistedCrosscheckStaleForceUnlock" setAtomicInstanceUUID:v61 removingForReason:@"atomic-instance without associated set-descriptor" historyOperation:345];
          }

          v62 = [v54 atomicInstanceUUID];
          v63 = [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v60 removingAtomicInstance:v62];

          if ((v63 & 1) == 0)
          {
            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"loadPersistedCrosscheckStaleForceUnlock" dueToError:0 forgettingAtomicInstance:v54];
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v60 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (dropAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        }

        objc_autoreleasePoolPop(v55);
      }

      v52 = [v107 countByEnumeratingWithState:&v121 objects:v135 count:16];
    }

    while (v52);
  }

  v119 = 0u;
  v120 = 0u;
  v117 = 0u;
  v118 = 0u;
  v112 = v100;
  v64 = [v112 countByEnumeratingWithState:&v117 objects:v134 count:16];
  if (v64)
  {
    v65 = v64;
    v66 = *v118;
    do
    {
      for (k = 0; k != v65; k = k + 1)
      {
        if (*v118 != v66)
        {
          objc_enumerationMutation(v112);
        }

        v68 = *(*(&v117 + 1) + 8 * k);
        v69 = objc_autoreleasePoolPush();
        v70 = [v68 clientDomainName];
        v71 = [v68 assetSetIdentifier];
        v72 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v70 forAssetSetIdentifier:v71];

        v73 = [v68 atomicInstanceUUID];
        [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v72 removingAtomicInstance:v73];

        [(MADAutoAssetControlManager *)self setConfigurationPersist:v72 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (nextForgetPreviouslyVendedAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        objc_autoreleasePoolPop(v69);
      }

      v65 = [v112 countByEnumeratingWithState:&v117 objects:v134 count:16];
    }

    while (v65);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedCrosscheckStaleForceUnlock" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v115 = 0u;
  v116 = 0u;
  v113 = 0u;
  v114 = 0u;
  v74 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v75 = [v74 allKeys];
  v76 = [v75 copy];

  v105 = v76;
  v77 = [v76 countByEnumeratingWithState:&v113 objects:v133 count:16];
  if (v77)
  {
    v78 = v77;
    v79 = *v114;
    do
    {
      for (m = 0; m != v78; m = m + 1)
      {
        if (*v114 != v79)
        {
          objc_enumerationMutation(v105);
        }

        v81 = *(*(&v113 + 1) + 8 * m);
        v82 = objc_autoreleasePoolPush();
        v83 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v84 = [v83 safeObjectForKey:v81 ofClass:objc_opt_class()];

        if (!v84)
        {
          v89 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v90 = [v89 diag];
          v91 = [[NSString alloc] initWithFormat:@"{loadPersistedCrosscheckStaleForceUnlock} unable to access knownSetConfigurationsByIdentifier | setConfigurationKey:%@", v81];
          [v90 trackAnomaly:@"STARTUP-CROSSCHECK" forReason:v91 withResult:6103 withError:0];

          goto LABEL_95;
        }

        v85 = [v84 newerAtomicInstanceOncePersonalized];
        if (v85)
        {
          v86 = [v84 newerAtomicInstanceOncePersonalized];
          v87 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v86];

          v88 = v87 == 0;
        }

        else
        {
          v88 = 1;
        }

        v92 = [v84 latestAtomicInstanceToVend];
        if (v92)
        {
          v93 = [v84 latestAtomicInstanceToVend];
          v94 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v93];

          v95 = v94 == 0;
        }

        else
        {
          v95 = 1;
        }

        v96 = [v84 newerAtomicInstanceOncePersonalized];
        v97 = v96 != 0 && v88;

        if (v97 == 1)
        {
          [v84 setNewerAtomicInstanceOncePersonalized:0];
        }

        v98 = [v84 latestAtomicInstanceToVend];
        v99 = v98 != 0 && v95;

        if (v99 == 1)
        {
          [v84 setLatestAtomicInstanceToVend:0];
          [v84 setLatestAtomicInstanceToVendFromPreSUStaging:0];
        }

        else if (!v97)
        {
          goto LABEL_95;
        }

        [(MADAutoAssetControlManager *)self setConfigurationPersist:v84 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared stale references from set-configuration" dueToAlter:0 forHistoryOperation:9999];
LABEL_95:

        objc_autoreleasePoolPop(v82);
      }

      v78 = [v105 countByEnumeratingWithState:&v113 objects:v133 count:16];
    }

    while (v78);
  }
}

- (void)verifyLockerLatestSymlink
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  if ([(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:@"verifyLatestLockerSymlink"])
  {
    context = objc_autoreleasePoolPush();
    v5 = +[NSFileManager defaultManager];
    v6 = [NSURL URLWithString:@"/private/var/MobileAsset/AssetsV2/locks"];
    v42 = v5;
    v7 = [v5 enumeratorAtURL:v6 includingPropertiesForKeys:&__NSArray0__struct options:4 errorHandler:0];

    v39 = objc_alloc_init(NSMutableArray);
    v41 = [[NSString alloc] initWithFormat:@"%@_%@.%@", @"atomic_instance", @"latest", @"locker"];
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v8 = v7;
    v9 = [v8 countByEnumeratingWithState:&v50 objects:v59 count:16];
    v40 = v8;
    if (v9)
    {
      v10 = v9;
      v11 = *v51;
      v12 = NSURLNameKey;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v51 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v15 = *(*(&v50 + 1) + 8 * i);
          v49 = 0;
          [v15 getResourceValue:&v49 forKey:NSURLIsSymbolicLinkKey error:0];
          v16 = v49;
          if ([v16 BOOLValue])
          {
            v48 = 0;
            [v15 getResourceValue:&v48 forKey:v12 error:0];
            v17 = v48;
            if ([p_weak_ivar_lyt[223] stringIsEqual:v17 to:v41])
            {
              v18 = p_weak_ivar_lyt;
              v19 = [v15 path];
              v20 = isValidSymlink(v19);

              v21 = _MADLog(@"AutoControl");
              v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
              if (v20)
              {
                if (v22)
                {
                  v23 = [v15 path];
                  *buf = 138543362;
                  v55 = v23;
                  _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{verifyLockerLatestSymlink} Symlink %{public}@ confirmed to have valid target", buf, 0xCu);
                }
              }

              else
              {
                if (v22)
                {
                  v24 = [v15 path];
                  *buf = 138543362;
                  v55 = v24;
                  _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{verifyLockerLatestSymlink} Symlink %{public}@ does not have a valid target, it will be removed", buf, 0xCu);
                }

                [v39 addObject:v15];
              }

              p_weak_ivar_lyt = v18;
              v8 = v40;
              v12 = NSURLNameKey;
            }
          }
        }

        v10 = [v8 countByEnumeratingWithState:&v50 objects:v59 count:16];
      }

      while (v10);
    }

    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v25 = v39;
    v26 = [v25 countByEnumeratingWithState:&v44 objects:v58 count:16];
    if (v26)
    {
      v27 = v26;
      v28 = *v45;
      do
      {
        for (j = 0; j != v27; j = j + 1)
        {
          if (*v45 != v28)
          {
            objc_enumerationMutation(v25);
          }

          v30 = *(*(&v44 + 1) + 8 * j);
          v43 = 0;
          [v42 removeItemAtURL:v30 error:&v43];
          v31 = v43;
          v32 = _MADLog(@"AutoControl");
          v33 = os_log_type_enabled(v32, OS_LOG_TYPE_ERROR);
          if (v31)
          {
            if (!v33)
            {
              goto LABEL_31;
            }

            v34 = [v30 path];
            *buf = 138543618;
            v55 = v34;
            v56 = 2114;
            v57 = v31;
            v35 = v32;
            v36 = "{verifyLockerLatestSymlink} Tried to remove invalid symlink %{public}@, but failed with error: %{public}@";
            v37 = 22;
          }

          else
          {
            if (!v33)
            {
              goto LABEL_31;
            }

            v34 = [v30 path];
            *buf = 138543362;
            v55 = v34;
            v35 = v32;
            v36 = "{verifyLockerLatestSymlink} Successfully removed invalid symlink %{public}@";
            v37 = 12;
          }

          _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, v36, buf, v37);

LABEL_31:
        }

        v27 = [v25 countByEnumeratingWithState:&v44 objects:v58 count:16];
      }

      while (v27);
    }

    objc_autoreleasePoolPop(context);
  }
}

- (void)firstSchedulerCrosscheckTrim
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self locateSetDescriptorsDownloaded];
  if (!v5)
  {
    v5 = objc_alloc_init(NSArray);
  }

  v6 = [MADAutoAssetLocker eliminateAllPreviousSetLocksNoLongerTracked:v5];
  v7 = _MADLog(@"AutoControl");
  v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
  if (v6)
  {
    if (v8)
    {
      v9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543618;
      v25 = v9;
      v26 = 2048;
      v27 = [v6 count];
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {firstSchedulerCrosscheckTrim} just unlocked selectors:%ld", buf, 0x16u);
    }

    v21 = 0u;
    v22 = 0u;
    v19 = 0u;
    v20 = 0u;
    v7 = v6;
    v10 = [v7 countByEnumeratingWithState:&v19 objects:v23 count:16];
    if (v10)
    {
      v11 = v10;
      v12 = *v20;
      do
      {
        for (i = 0; i != v11; i = i + 1)
        {
          if (*v20 != v12)
          {
            objc_enumerationMutation(v7);
          }

          v14 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v19 + 1) + 8 * i)];
          if (v14)
          {
            [(MADAutoAssetControlManager *)self secureCheckUngraft:@"firstSchedulerCrosscheckTrim" forDescriptorNoLongerLocked:v14];
          }
        }

        v11 = [v7 countByEnumeratingWithState:&v19 objects:v23 count:16];
      }

      while (v11);
    }
  }

  else if (v8)
  {
    v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v25 = v15;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {firstSchedulerCrosscheckTrim} no selectors just unlocked", buf, 0xCu);
  }

  v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v17 = [v16 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke;
  block[3] = &unk_4B2AA0;
  block[4] = self;
  dispatch_async(v17, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerCrosscheckTrimSetDescriptors];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_2;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerCrosscheckTrimAtomicInstances];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_3;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_3(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerShortTermLockContentChecks:@"firstSchedulerCrosscheckTrim"];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_4;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

id __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_4(uint64_t a1)
{
  [*(a1 + 32) trackPerformanceStartupStep:@"firstSchedulerCrosscheckTrim" beginningStep:@"_removeDownloadedDescriptorsWithNewerDownloaded"];
  v2 = *(a1 + 32);

  return [v2 _removeDownloadedDescriptorsWithNewerDownloaded:@"firstSchedulerCrosscheckTrim"];
}

- (void)firstSchedulerCrosscheckTrimAtomicInstances
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v6 = [v5 persistedEntryIDs:@"firstSchedulerCrosscheckTrimAtomicInstances"];

  if (![v6 count])
  {
    goto LABEL_101;
  }

  v7 = objc_alloc_init(NSMutableArray);
  v88 = objc_alloc_init(NSMutableArray);
  v100 = objc_alloc_init(NSMutableDictionary);
  v104 = +[NSFileManager defaultManager];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"firstSchedulerCrosscheckTrimAtomicInstances" ofContainer:@"persistedKnownSetAtomicInstances"];
  v119 = 0u;
  v120 = 0u;
  v117 = 0u;
  v118 = 0u;
  v87 = v6;
  v8 = v6;
  v9 = [v8 countByEnumeratingWithState:&v117 objects:v129 count:16];
  if (!v9)
  {
    goto LABEL_82;
  }

  v11 = v9;
  v107 = *v118;
  *&v10 = 138543618;
  v86 = v10;
  v97 = v8;
  v98 = v7;
  do
  {
    v12 = 0;
    v105 = v11;
    do
    {
      if (*v118 != v107)
      {
        objc_enumerationMutation(v8);
      }

      v13 = *(*(&v117 + 1) + 8 * v12);
      v14 = objc_autoreleasePoolPush();
      v15 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [v15 persistedEntry:v13 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances"];

      if (v13)
      {
        v17 = v16 == 0;
      }

      else
      {
        v17 = 1;
      }

      if (!v17)
      {
        v20 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v21 = [v20 decodeFromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

        v22 = [(MADAutoAssetControlManager *)self atomicInstanceNewIdentifierForSetAtomicInstance:v21];
        v23 = v22;
        if (v21)
        {
          v24 = v22 == 0;
        }

        else
        {
          v24 = 1;
        }

        if (v24)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            if (v21)
            {
              v99 = [v21 summary];
              v26 = v99;
              v27 = @"N";
            }

            else
            {
              v27 = @"N";
              v26 = @"N";
            }

            *buf = 138543874;
            if (v23)
            {
              v27 = v23;
            }

            v124 = v13;
            v125 = 2114;
            v126 = v26;
            v127 = 2114;
            v128 = v27;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to load set-atomic-instance | entryID:%{public}@ | setAtomicInstance:%{public}@ | fullSetIdentifier:%{public}@", buf, 0x20u);
            if (v21)
            {
            }
          }
        }

        else
        {
          if ([(MADAutoAssetControlManager *)self atomicInstanceHasDownloadedSetDescriptor:v21 verboseLogging:0])
          {
            v29 = [v21 clientDomainName];
            v30 = [v21 assetSetIdentifier];
            v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v29 forAssetSetIdentifier:v30];

            v32 = [v21 atomicInstanceUUID];
            obj = v31;
            v33 = [v31 discoveredInFlightAtomicInstance];
            if (([SUCore stringIsEqual:v32 to:v33]& 1) != 0)
            {
              goto LABEL_32;
            }

            v95 = v14;
            v34 = [v21 atomicInstanceUUID];
            v35 = [obj newerAtomicInstanceOncePersonalized];
            if (([SUCore stringIsEqual:v34 to:v35]& 1) != 0)
            {
              goto LABEL_31;
            }

            v91 = v35;
            v93 = v34;
            v36 = [v21 atomicInstanceUUID];
            v37 = [obj latestAtomicInstanceToVend];
            v90 = v36;
            v38 = v36;
            v39 = v37;
            if (([SUCore stringIsEqual:v38 to:v37]& 1) == 0)
            {
              v51 = [v21 atomicInstanceUUID];
              v89 = [(MADAutoAssetControlManager *)self setConfigurationIsTrackedAsPreviouslyVended:@"firstSchedulerCrosscheckTrimAtomicInstances" forSetConfiguration:obj forAtomicInstanceUUID:?];

              v14 = v95;
              if (v89)
              {
                goto LABEL_33;
              }

              v52 = _MADLog(@"AutoControl");
              v7 = v98;
              if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v124 = v13;
                _os_log_impl(&dword_0, v52, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance not tracked by set-configuration | entryID:%{public}@", buf, 0xCu);
              }

              [v98 addObject:v13];
              v8 = v97;
              v50 = obj;
              goto LABEL_78;
            }

            v34 = v93;
LABEL_31:

            v14 = v95;
LABEL_32:

LABEL_33:
            v40 = [v100 safeObjectForKey:v23 ofClass:objc_opt_class()];
            v7 = v98;
            if (v40)
            {
              v41 = v40;
LABEL_48:
              v8 = v97;
              [v41 addObject:{v21, v86}];
              [v100 setSafeObject:v41 forKey:v23];
              if ([v41 count] >= 7 && !+[MADAutoAssetControlManager preferenceAutoAssetNoPersistedOverflowLimit](MADAutoAssetControlManager, "preferenceAutoAssetNoPersistedOverflowLimit"))
              {
                v43 = [(MADAutoAssetControlManager *)self atomicInstanceOverflowRemove:v41];
                v96 = v43;
                if (v43)
                {
                  v44 = v43;
                  v94 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v43];
                  if (v94)
                  {
                    if ([(MADAutoAssetControlManager *)self isAtomicInstanceForCurrentSetJob:v44])
                    {
                      v45 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                      {
                        v46 = [v96 summary];
                        *buf = 138543362;
                        v124 = v46;
                        v47 = v45;
                        v48 = OS_LOG_TYPE_DEFAULT;
                        v49 = "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} not subject to verflow trim - atomic-instance for currently active set-job (keeping) | setAtomicInstance:%{public}@";
                        goto LABEL_66;
                      }

                      goto LABEL_67;
                    }

                    v56 = [v44 atomicInstanceUUID];
                    v57 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"firstSchedulerCrosscheckTrimAtomicInstances" forAtomicInstanceUUID:v56 requireExists:0];

                    v58 = _MADLog(@"AutoControl");
                    v59 = os_log_type_enabled(v58, OS_LOG_TYPE_ERROR);
                    v92 = v57;
                    if (v57)
                    {
                      v7 = v98;
                      if (v59)
                      {
                        v60 = [v96 summary];
                        v61 = [v92 summary];
                        *buf = v86;
                        v124 = v60;
                        v125 = 2114;
                        v126 = v61;
                        _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} [WARNING] over threshold for atomic-instances by set-identifier (trimming) | setAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x16u);

                        v7 = v98;
                      }

                      [v7 addObject:v94];
                      v62 = [v92 latestDownloadedAtomicInstance];
                      [v88 addObject:v62];

                      v55 = v92;
                      v8 = v97;
                      v50 = obj;
                    }

                    else
                    {
                      v7 = v98;
                      if (v59)
                      {
                        v63 = [v96 summary];
                        *buf = 138543362;
                        v124 = v63;
                        _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance without backing set-descriptor | removedOverflowAtomicInstance:%{public}@", buf, 0xCu);

                        v7 = v98;
                      }

                      [v7 addObject:v13];
                      v8 = v97;
                      v50 = obj;
                      v55 = 0;
                    }
                  }

                  else
                  {
                    v45 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
                    {
                      v46 = [v96 summary];
                      *buf = 138543362;
                      v124 = v46;
                      v47 = v45;
                      v48 = OS_LOG_TYPE_ERROR;
                      v49 = "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to determine persisted-set-atomic-instance file | setAtomicInstance:%{public}@";
LABEL_66:
                      _os_log_impl(&dword_0, v47, v48, v49, buf, 0xCu);
                    }

LABEL_67:
                    v50 = obj;
                    v55 = v45;
                    v7 = v98;
                  }
                }

                else
                {
                  v53 = _MADLog(@"AutoControl");
                  v94 = v53;
                  if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
                  {
                    v54 = [v21 summary];
                    *buf = 138543362;
                    v124 = v54;
                    _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} over threshold for atomic-instances by set-identifier (unable to reduce) | setAtomicInstance:%{public}@", buf, 0xCu);
                  }

                  v50 = obj;
                  v7 = v98;
                }

LABEL_77:
LABEL_78:

LABEL_79:
                v11 = v105;

                goto LABEL_80;
              }
            }

            else
            {
              v41 = objc_alloc_init(NSMutableArray);
              if (v41)
              {
                goto LABEL_48;
              }

              v8 = v97;
            }

            v50 = obj;
            goto LABEL_77;
          }

          if ([(MADAutoAssetControlManager *)self isAtomicInstanceForCurrentSetJob:v21])
          {
            v42 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543362;
              v124 = v13;
              _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance for currently active set-job (keeping) | entryID:%{public}@", buf, 0xCu);
            }

            goto LABEL_79;
          }

          [(MADAutoAssetControlManager *)self atomicInstanceHasDownloadedSetDescriptor:v21 verboseLogging:1];
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v124 = v13;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance without backing set-descriptor | entryID:%{public}@", buf, 0xCu);
          }
        }

        [v7 addObject:v13];
        goto LABEL_79;
      }

      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
      {
        v19 = @"N";
        if (v13)
        {
          v19 = v13;
        }

        *buf = 138543362;
        v124 = v19;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to determine previous status | entryID:%{public}@", buf, 0xCu);
      }

      if (v13)
      {
        [v7 addObject:v13];
      }

LABEL_80:

      objc_autoreleasePoolPop(v14);
      v12 = v12 + 1;
    }

    while (v11 != v12);
    v11 = [v8 countByEnumeratingWithState:&v117 objects:v129 count:16];
  }

  while (v11);
LABEL_82:

  v115 = 0u;
  v116 = 0u;
  v113 = 0u;
  v114 = 0u;
  obja = v7;
  v64 = [obja countByEnumeratingWithState:&v113 objects:v122 count:16];
  if (v64)
  {
    v65 = v64;
    v66 = *v114;
    do
    {
      for (i = 0; i != v65; i = i + 1)
      {
        if (*v114 != v66)
        {
          objc_enumerationMutation(obja);
        }

        v68 = *(*(&v113 + 1) + 8 * i);
        v69 = objc_autoreleasePoolPush();
        v70 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v71 = [v70 persistedEntry:v68 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances"];

        v72 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v73 = [v72 decodeFromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" ofEntryName:v68 fromPersistedEntry:v71 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

        if (v73)
        {
          v74 = [v73 atomicInstanceUUID];
          [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"firstSchedulerCrosscheckTrimAtomicInstances" setAtomicInstanceUUID:v74 removingForReason:@"dropping to avoid overflow" historyOperation:334];
        }

        objc_autoreleasePoolPop(v69);
      }

      v65 = [obja countByEnumeratingWithState:&v113 objects:v122 count:16];
    }

    while (v65);
  }

  v108 = self;

  v111 = 0u;
  v112 = 0u;
  v109 = 0u;
  v110 = 0u;
  v101 = v88;
  v75 = [v101 countByEnumeratingWithState:&v109 objects:v121 count:16];
  if (v75)
  {
    v76 = v75;
    v106 = *v110;
    do
    {
      for (j = 0; j != v76; j = j + 1)
      {
        if (*v110 != v106)
        {
          objc_enumerationMutation(v101);
        }

        v78 = *(*(&v109 + 1) + 8 * j);
        v79 = objc_autoreleasePoolPush();
        v80 = [(MADAutoAssetControlManager *)v108 locateSetDescriptor:@"firstSchedulerCrosscheckTrimAtomicInstances" forAtomicInstanceUUID:v78 requireExists:0];
        v81 = v80;
        if (v80)
        {
          v82 = [v80 clientDomainName];
          v83 = [v81 assetSetIdentifier];
          v84 = [MANAutoAssetSetStatus shortTermLockFilename:v82 forAssetSetIdentifier:v83 forSetAtomicInstance:v78];

          [(MADAutoAssetControlManager *)v108 removeSetDescriptorDownloaded:v81 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:330 historyOperationSD:374];
          v85 = [(MADAutoAssetControlManager *)v108 _shortTermSharedLockRemove:@"firstSchedulerCrosscheckTrimAtomicInstances" removingSharedLockFilename:v84 usingFileManager:v104 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
        }

        objc_autoreleasePoolPop(v79);
      }

      v76 = [v101 countByEnumeratingWithState:&v109 objects:v121 count:16];
    }

    while (v76);
  }

  v6 = v87;
LABEL_101:
}

- (void)firstSchedulerCrosscheckTrimSetDescriptors
{
  v2 = self;
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
  v6 = [v5 persistedEntryIDs:@"firstSchedulerCrosscheckTrimSetDescriptors"];

  if ([v6 count])
  {
    v59 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)v2 trackPerformanceIteration:@"firstSchedulerCrosscheckTrimSetDescriptors" ofContainer:@"persistedDownloadedSetDescriptors"];
    v69 = 0u;
    v70 = 0u;
    v67 = 0u;
    v68 = 0u;
    v52 = v6;
    v7 = v6;
    v8 = [v7 countByEnumeratingWithState:&v67 objects:v74 count:16];
    v54 = v2;
    if (!v8)
    {
      goto LABEL_36;
    }

    v9 = v8;
    context = *v68;
    v55 = v7;
    while (1)
    {
      v10 = 0;
      v57 = v9;
      do
      {
        if (*v68 != context)
        {
          objc_enumerationMutation(v7);
        }

        v11 = *(*(&v67 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        if (v11)
        {
          v13 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
          v14 = [v13 persistedEntry:v11 fromLocation:@"firstSchedulerCrosscheckTrimSetDescriptors"];

          if (v14)
          {
            v15 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
            v16 = [v15 decodeFromLocation:@"firstSchedulerCrosscheckTrimSetDescriptors" ofEntryName:v11 fromPersistedEntry:v14 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v16)
            {
              v17 = [v16 latestDownloadedAtomicInstance];

              if (v17)
              {
                v18 = [v16 latestDownloadedAtomicInstance];
                v19 = [(MADAutoAssetControlManager *)v2 locateSetAtomicInstanceByInstanceUUID:v18];

                v20 = [v16 clientDomainName];
                v21 = [v16 assetSetIdentifier];
                v22 = [(MADAutoAssetControlManager *)v2 locateSetConfigurationByClientDomain:v20 forAssetSetIdentifier:v21];

                if (v19)
                {
                  if (v22)
                  {
                    if (![(MADAutoAssetControlManager *)v54 isEveryAssetEntryOnFilesystemForSetDescriptor:@"firstSchedulerCrosscheckTrimSetDescriptors" forSetDescriptor:v16])
                    {
                      v23 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                      {
                        v24 = [v16 summary];
                        *buf = 138543362;
                        v73 = v24;
                        v25 = v23;
                        v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor referencing content not on the filesystem | setDescriptor:%{public}@";
                        goto LABEL_30;
                      }

LABEL_31:

                      [v59 addObject:v11];
                    }

                    v2 = v54;
                    v7 = v55;
LABEL_33:

                    v9 = v57;
                    goto LABEL_34;
                  }

                  v23 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                  {
                    goto LABEL_31;
                  }

                  v24 = [v16 summary];
                  *buf = 138543362;
                  v73 = v24;
                  v25 = v23;
                  v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor without set-configuration | setDescriptor:%{public}@";
                }

                else
                {
                  v23 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                  {
                    goto LABEL_31;
                  }

                  v24 = [v16 summary];
                  *buf = 138543362;
                  v73 = v24;
                  v25 = v23;
                  v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor without atomic-instance | setDescriptor:%{public}@";
                }

LABEL_30:
                _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, v26, buf, 0xCu);

                goto LABEL_31;
              }

              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                v29 = [v16 summary];
                *buf = 138543362;
                v73 = v29;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor with no latestDownloadedAtomicInstance | setDescriptor:%{public}@", buf, 0xCu);

                v2 = v54;
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v73 = v11;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] unable to load set-descriptor | entryID:%{public}@", buf, 0xCu);
              }
            }

            [v59 addObject:v11];
            goto LABEL_33;
          }

          v27 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v73 = v11;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] unable to load persisted entry | entryID:%{public}@", buf, 0xCu);
          }

          [v59 addObject:v11];
        }

        else
        {
          v14 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
          {
            *buf = 0;
            _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} no entryID", buf, 2u);
          }
        }

LABEL_34:

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v9 != v10);
      v9 = [v7 countByEnumeratingWithState:&v67 objects:v74 count:16];
      if (!v9)
      {
LABEL_36:

        v65 = 0u;
        v66 = 0u;
        v63 = 0u;
        v64 = 0u;
        obj = v59;
        v58 = [obj countByEnumeratingWithState:&v63 objects:v71 count:16];
        if (!v58)
        {
          goto LABEL_49;
        }

        v30 = @"firstSchedulerCrosscheckTrimSetDescriptors";
        v31 = @"assetSetDescriptor";
        v56 = *v64;
        while (1)
        {
          for (i = 0; i != v58; i = i + 1)
          {
            if (*v64 != v56)
            {
              objc_enumerationMutation(obj);
            }

            v33 = *(*(&v63 + 1) + 8 * i);
            contexta = objc_autoreleasePoolPush();
            v34 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
            v35 = [v34 persistedEntry:v33 fromLocation:v30];

            v36 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
            v60 = v35;
            v37 = [v36 decodeFromLocation:v30 ofEntryName:v33 fromPersistedEntry:v35 decodingObjectForKey:v31 ofClass:objc_opt_class() allowingNilObject:0];

            if (v37)
            {
              v38 = [v37 latestDownloadedAtomicInstance];

              if (v38)
              {
                v39 = [(MADAutoAssetControlManager *)v2 persistedDownloadedSetDescriptors];
                [v39 removePersistedEntry:v33 fromLocation:v30];

                v40 = [v37 latestDowloadedAtomicInstanceEntries];
                v41 = v31;
                v42 = v30;
                v43 = [v40 count];
                v44 = [v37 clientDomainName];
                v45 = [v37 assetSetIdentifier];
                v46 = [v37 discoveredAtomicInstance];
                v47 = v43;
                v30 = v42;
                v31 = v41;
                [MADAutoAssetHistory recordOperation:382 toHistoryType:2 fromLayer:1 usageCount:v47 forClientDomainName:v44 forAssetSetIdentifier:v45 forAtomicInstance:v46];

                v2 = v54;
                [(MADAutoAssetControlManager *)v54 _logPersistedSetDescriptorRemoved:v30 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v33 removedSetDescriptor:v37 message:@"removing previously persisted downloaded-set-descriptor that no longer had backing latest downloaded atomic-instance"];
                goto LABEL_47;
              }

              v48 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
            }

            else
            {
              v48 = @"EntryID: %@. descriptor to be dropped is nil";
            }

            v49 = [[NSString alloc] initWithFormat:v48, v33];
            v50 = [(MADAutoAssetControlManager *)v2 autoControlManagerFSM];
            v51 = [v50 diag];
            [v51 trackAnomaly:v30 forReason:v49 withResult:6101 withError:0];

LABEL_47:
            objc_autoreleasePoolPop(contexta);
          }

          v58 = [obj countByEnumeratingWithState:&v63 objects:v71 count:16];
          if (!v58)
          {
LABEL_49:

            v6 = v52;
            goto LABEL_50;
          }
        }
      }
    }
  }

LABEL_50:
}

- (void)firstSchedulerShortTermLockContentChecks:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v49 = v4;
  v7 = [[NSString alloc] initWithFormat:@"%@:firstSchedulerShortTermLockContentChecks", v4];
  v58 = objc_alloc_init(NSMutableArray);
  v50 = objc_alloc_init(NSMutableArray);
  v73 = 0u;
  v74 = 0u;
  v75 = 0u;
  v76 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v8 = [obj countByEnumeratingWithState:&v73 objects:v84 count:16];
  v60 = v7;
  if (v8)
  {
    v9 = v8;
    v10 = *v74;
    v51 = *v74;
    do
    {
      v11 = 0;
      v52 = v9;
      do
      {
        if (*v74 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v73 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        v14 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v15 = [v14 safeObjectForKey:v12 ofClass:objc_opt_class()];

        v16 = v15;
        if ([v15 lockedSupportingShortTermLocking])
        {
          v17 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v7 forAtomicInstanceUUID:v12 requireExists:1];
          v18 = v17;
          if (v17)
          {
            v55 = v16;
            v56 = v13;
            v57 = v11;
            v19 = [v17 clientDomainName];
            v20 = [v18 assetSetIdentifier];
            v21 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v19 forAssetSetIdentifier:v20];

            v71 = 0u;
            v72 = 0u;
            v69 = 0u;
            v70 = 0u;
            v22 = [v18 latestDowloadedAtomicInstanceEntries];
            v23 = [v22 countByEnumeratingWithState:&v69 objects:v83 count:16];
            if (v23)
            {
              v24 = v23;
              v53 = v18;
              v25 = 0;
              v26 = *v70;
              do
              {
                for (i = 0; i != v24; i = i + 1)
                {
                  if (*v70 != v26)
                  {
                    objc_enumerationMutation(v22);
                  }

                  v28 = *(*(&v69 + 1) + 8 * i);
                  if (![(MADAutoAssetControlManager *)self isLocalContentValidForSetAtomicEntry:v28 fromLocation:v7])
                  {
                    v29 = [v21 availableForUseError];
                    v30 = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v29];

                    v7 = v60;
                    if ((v30 & 1) == 0)
                    {
                      [v58 addObject:v28];
                      v25 = 1;
                    }
                  }
                }

                v24 = [v22 countByEnumeratingWithState:&v69 objects:v83 count:16];
              }

              while (v24);

              v10 = v51;
              v9 = v52;
              v18 = v53;
              if (v25)
              {
                [v50 addObject:v53];
              }
            }

            else
            {
            }

            v13 = v56;
            v11 = v57;
            v16 = v55;
          }
        }

        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v11 != v9);
      v9 = [obj countByEnumeratingWithState:&v73 objects:v84 count:16];
    }

    while (v9);
  }

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v59 = v58;
  v31 = [v59 countByEnumeratingWithState:&v65 objects:v82 count:16];
  if (v31)
  {
    v32 = v31;
    v33 = *v66;
    do
    {
      for (j = 0; j != v32; j = j + 1)
      {
        if (*v66 != v33)
        {
          objc_enumerationMutation(v59);
        }

        v35 = *(*(&v65 + 1) + 8 * j);
        v36 = [(MADAutoAssetControlManager *)self getCorruptedEntryInfo:v35];
        v37 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543618;
          v79 = v60;
          v80 = 2114;
          v81 = v36;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "{%{public}@} Removing corrupted asset %{public}@", buf, 0x16u);
        }

        v38 = [v35 fullAssetSelector];
        [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:v60 dueToError:0 fullAssetSelector:v38 historyOperationAI:1502 historyOperationSD:393];

        v39 = [v35 fullAssetSelector];
        v40 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v39];
        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:v60 droppingDescriptor:v40 forHistoryOperation:409 firstClientName:0];
      }

      v32 = [v59 countByEnumeratingWithState:&v65 objects:v82 count:16];
    }

    while (v32);
  }

  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v41 = v50;
  v42 = [v41 countByEnumeratingWithState:&v61 objects:v77 count:16];
  if (v42)
  {
    v43 = v42;
    v44 = *v62;
    do
    {
      for (k = 0; k != v43; k = k + 1)
      {
        if (*v62 != v44)
        {
          objc_enumerationMutation(v41);
        }

        v46 = *(*(&v61 + 1) + 8 * k);
        v47 = [v46 clientDomainName];
        v48 = [v46 assetSetIdentifier];
        [MADAutoAssetScheduler triggerWithRetrySetDomainName:v47 forAssetSetIdentifier:v48 usingSetUpdatePolicy:0];
      }

      v43 = [v41 countByEnumeratingWithState:&v61 objects:v77 count:16];
    }

    while (v43);
  }
}

- (void)considerDownloadedWithPSUSLookupResultsForLatestToVend
{
  v2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:considerDownloadedWithPSUSLookupResultsForLatestToVend", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v102 = 0u;
  v103 = 0u;
  v100 = 0u;
  v101 = 0u;
  v5 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v6 = [v5 allKeys];
  obj = [v6 copy];

  v7 = [obj countByEnumeratingWithState:&v100 objects:v113 count:16];
  if (v7)
  {
    v79 = *v101;
    do
    {
      v8 = 0;
      v80 = v7;
      do
      {
        if (*v101 != v79)
        {
          objc_enumerationMutation(obj);
        }

        v82 = v8;
        v9 = *(*(&v100 + 1) + 8 * v8);
        context = objc_autoreleasePoolPush();
        v10 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v90 = [v10 safeObjectForKey:v9 ofClass:objc_opt_class()];

        v11 = v90;
        if (!v90)
        {
          goto LABEL_80;
        }

        v12 = [v90 autoAssetEntries];
        v83 = [(MADAutoAssetControlManager *)self locateSetLookupResultSatisfying:v12];

        if (!v83)
        {
          goto LABEL_68;
        }

        v13 = [v83 discoveredAtomicEntries];
        v14 = [v13 count] == 0;

        if (v14)
        {
          goto LABEL_68;
        }

        v98 = 0u;
        v99 = 0u;
        v96 = 0u;
        v97 = 0u;
        v15 = [v83 discoveredAtomicEntries];
        v16 = [v15 countByEnumeratingWithState:&v96 objects:v112 count:16];
        if (!v16)
        {

          goto LABEL_38;
        }

        v86 = v15;
        v88 = *v97;
        v84 = 0x100000000;
        do
        {
          for (i = 0; i != v16; i = i + 1)
          {
            if (*v97 != v88)
            {
              objc_enumerationMutation(v86);
            }

            v18 = *(*(&v96 + 1) + 8 * i);
            v19 = objc_autoreleasePoolPush();
            v20 = [v90 autoAssetEntries];
            v21 = [(MADAutoAssetControlManager *)self isAtomicEntry:v18 desiredForAutoAssetSetEntries:v20];

            if (v21)
            {
              if (v18)
              {
                v22 = [v18 fullAssetSelector];
                v23 = [v22 assetType];
                v24 = [v18 fullAssetSelector];
                v25 = [v24 assetSpecifier];
                v26 = [v18 fullAssetSelector];
                v27 = [v26 assetVersion];
                v28 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forAssetType:v23 withAssetSpecifier:v25 matchingAssetVersion:v27];

                if (v28)
                {
                  if (![MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forDescriptor:v28])
                  {
                    goto LABEL_20;
                  }

                  if (![MADAutoAssetSecure isPersonalizationRequired:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forDescriptor:v28])
                  {
                    LOBYTE(v84) = 1;
LABEL_20:
                    v29 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
                    {
                      v30 = [v90 summary];
                      v31 = [v28 summary];
                      *buf = 138543874;
                      v107 = @"considerDownloadedWithPSUSLookupResultsForLatestToVend";
                      v108 = 2114;
                      v109 = v30;
                      v110 = 2114;
                      v111 = v31;
                      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-descriptor discovered by PSUS lookup is currently downloaded [and if secure: is personalized] | nextSetConfiguration:%{public}@ | downloadedAssetDescriptor:%{public}@", buf, 0x20u);
                    }

                    v32 = 0;
LABEL_27:

                    goto LABEL_28;
                  }
                }

                else
                {
                  LOBYTE(v84) = 0;
                }

                BYTE4(v84) = 0;
                v32 = 4;
                goto LABEL_27;
              }

              v84 = 0;
              v32 = 4;
            }

            else
            {
              v32 = 5;
            }

LABEL_28:
            objc_autoreleasePoolPop(v19);
            if (v32 != 5 && v32)
            {
              goto LABEL_32;
            }
          }

          v16 = [v86 countByEnumeratingWithState:&v96 objects:v112 count:16];
        }

        while (v16);
LABEL_32:

        if ((v84 & 0x100000000) == 0)
        {
          v33 = v90;
          if (v84)
          {
            v34 = [v90 newerAtomicInstanceOncePersonalized];
            v35 = v34 == 0;

            v33 = v90;
            if (!v35)
            {
              [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forSetConfiguration:v90];
            }

            v36 = [(MADAutoAssetControlManager *)self atomicInstanceFromPSUSLookupResultOncePersonalized:v83 forSetConfiguration:v90];
          }

          else
          {
            v36 = 0;
          }

          goto LABEL_69;
        }

LABEL_38:
        v37 = [v90 latestAtomicInstanceToVend];
        v38 = v37 == 0;

        if (v38)
        {
          if ([(MADAutoAssetControlManager *)self newAtomicInstanceAndSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetLookupResult:v83 vendingLatestForConfiguration:v90 inStartup:1 allowEmpty:0 notifyClients:0 forCreationReason:@"FROM_STAGED_PROMOTED_LOOKUP" recordingHistoryOperation:220])
          {
            goto LABEL_79;
          }

          goto LABEL_68;
        }

        v39 = [v90 latestAtomicInstanceToVend];
        v89 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forAtomicInstanceUUID:v39 requireExists:1];

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        v40 = [v83 discoveredAtomicEntries];
        v41 = [v40 countByEnumeratingWithState:&v92 objects:v105 count:16];
        if (!v41)
        {
          v78 = 0;
          v85 = 0;
          goto LABEL_63;
        }

        v78 = 0;
        v85 = 0;
        v87 = v40;
        v42 = *v93;
        while (2)
        {
          v43 = 0;
          while (2)
          {
            if (*v93 != v42)
            {
              objc_enumerationMutation(v87);
            }

            v44 = *(*(&v92 + 1) + 8 * v43);
            v45 = objc_autoreleasePoolPush();
            v46 = [v44 fullAssetSelector];
            v47 = [v46 assetType];
            v48 = [v44 fullAssetSelector];
            v49 = [v48 assetSpecifier];
            v50 = [v89 downloadedEntryForAssetType:v47 forAssetSpecifier:v49];

            if (!v50)
            {
              LODWORD(v85) = 1;
              v61 = 1;
              goto LABEL_55;
            }

            v51 = [SUCoreRestoreVersion alloc];
            v52 = [v44 fullAssetSelector];
            v53 = [v52 assetVersion];
            v54 = [v51 initWithRestoreVersion:v53];

            v55 = [SUCoreRestoreVersion alloc];
            v56 = [v50 fullAssetSelector];
            v57 = [v56 assetVersion];
            v58 = [v55 initWithRestoreVersion:v57];

            if (![v54 isComparable:v58])
            {
              v61 = 0;
LABEL_53:
              BYTE4(v85) = 1;
              goto LABEL_54;
            }

            v59 = [v54 compare:v58];
            v60 = 1;
            if (v59 == -1)
            {
              v61 = 0;
              goto LABEL_53;
            }

            if (v59 != &dword_0 + 1)
            {
              v60 = v78;
            }

            v61 = 1;
            v78 = v60;
LABEL_54:

LABEL_55:
            objc_autoreleasePoolPop(v45);
            if (!v61)
            {
              v40 = v87;
              goto LABEL_63;
            }

            if (v41 != ++v43)
            {
              continue;
            }

            break;
          }

          v40 = v87;
          v41 = [v87 countByEnumeratingWithState:&v92 objects:v105 count:16];
          if (v41)
          {
            continue;
          }

          break;
        }

LABEL_63:

        if ((v85 & 0x100000000) != 0 || ((v78 | v85) & 1) == 0)
        {
        }

        else
        {
          v62 = [(MADAutoAssetControlManager *)self newAtomicInstanceAndSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetLookupResult:v83 vendingLatestForConfiguration:v90 inStartup:1 allowEmpty:0 notifyClients:0 forCreationReason:@"FROM_STAGED_PROMOTED_LOOKUP" recordingHistoryOperation:220];

          if (v62)
          {
            goto LABEL_79;
          }
        }

LABEL_68:
        v36 = 0;
        v33 = v90;
LABEL_69:
        v63 = [v33 latestAtomicInstanceToVend];
        v64 = v63 == 0;

        if (v64 && (([v90 everProvidedLatestToVend] | v36) & 1) == 0)
        {
          v65 = [v90 clientDomainName];
          v66 = [v90 assetSetIdentifier];
          v67 = [v90 firstEntryAssetType];
          v68 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forClientDomainName:v65 forSetClientName:@"AutoControlManagerActingAsClient" forAssetSetIdentifier:v66 forAssetType:v67];

          if (v68)
          {
            v69 = [v68 latestDownloadedAtomicInstance];
            v70 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v69];

            if (v70)
            {
              if (![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetDescriptor:v68 toSetConfiguration:v90 fromPreSUStaging:0 allowEmpty:0])
              {
                v71 = [v70 atomicInstanceUUID];
                [v90 setNewerAtomicInstanceOncePersonalized:v71];

                [(MADAutoAssetControlManager *)self setConfigurationPersist:v90 fromLocation:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forReason:@"pre-installed set as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
              }
            }

            else
            {
              v72 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v73 = [v72 diag];
              v74 = [NSString alloc];
              v75 = [v68 summary];
              v76 = [v74 initWithFormat:@"{considerDownloadedWithPSUSLookupResultsForLatestToVend} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", v75];
              [v73 trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v76 withResult:6103 withError:0];
            }
          }
        }

LABEL_79:

        v11 = v90;
LABEL_80:

        objc_autoreleasePoolPop(context);
        v8 = v82 + 1;
      }

      while ((v82 + 1) != v80);
      v7 = [obj countByEnumeratingWithState:&v100 objects:v113 count:16];
    }

    while (v7);
  }

  os_activity_scope_leave(&state);
}

- (void)loadPersistedAtomicInstancesSupportingShortTermLocking
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  obj = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedAtomicInstancesSupportingShortTermLocking" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v36 = 0u;
  v37 = 0u;
  v34 = 0u;
  v35 = 0u;
  v5 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v6 = [v5 countByEnumeratingWithState:&v34 objects:v39 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v35;
    do
    {
      v9 = 0;
      do
      {
        if (*v35 != v8)
        {
          objc_enumerationMutation(v5);
        }

        v10 = *(*(&v34 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        v12 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v13 = [v12 safeObjectForKey:v10 ofClass:objc_opt_class()];

        if ([v13 lockedSupportingShortTermLocking])
        {
          v14 = [v13 atomicInstanceUUID];
          v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedAtomicInstancesSupportingShortTermLocking" forAtomicInstanceUUID:v14 requireExists:0];

          if (v15)
          {
            [obj addObject:v15];
          }
        }

        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v7 != v9);
      v7 = [v5 countByEnumeratingWithState:&v34 objects:v39 count:16];
    }

    while (v7);
  }

  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  obja = obj;
  v16 = [obja countByEnumeratingWithState:&v30 objects:v38 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v31;
    do
    {
      v19 = 0;
      do
      {
        if (*v31 != v18)
        {
          objc_enumerationMutation(obja);
        }

        v20 = *(*(&v30 + 1) + 8 * v19);
        if (v20)
        {
          v21 = [*(*(&v30 + 1) + 8 * v19) latestDownloadedAtomicInstance];
          v22 = [v20 clientDomainName];
          v23 = [v20 assetSetIdentifier];
          v24 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v22 forAssetSetIdentifier:v23];

          if (v24)
          {
            v25 = [v24 latestAtomicInstanceToVend];
            v26 = [v20 latestDownloadedAtomicInstance];
            v27 = [SUCore stringIsEqual:v25 to:v26];

            if (v27)
            {

              v21 = 0;
            }
          }

          [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:v20 forSpecificAtomicInstance:v21 isReadOnlyForResumeFromPersisted:1];
        }

        v19 = v19 + 1;
      }

      while (v17 != v19);
      v17 = [obja countByEnumeratingWithState:&v30 objects:v38 count:16];
    }

    while (v17);
  }
}

- (id)atomicInstanceOverflowRemove:(id)a3
{
  v4 = a3;
  v5 = [v4 count];
  if (v5 < 1)
  {
    v7 = 0;
    goto LABEL_8;
  }

  v6 = v5;
  v7 = [v4 objectAtIndex:0];
  if (v6 != &dword_0 + 1)
  {
    v8 = 0;
    v10 = 1;
    while (1)
    {
      v11 = [v4 objectAtIndex:v10];
      v12 = [v7 instanceEntries];
      v13 = [v12 count];
      if (v13)
      {
        v3 = [v11 instanceEntries];
        if (![v3 count])
        {
          goto LABEL_25;
        }
      }

      if ([v7 allContentDownloaded] && !objc_msgSend(v11, "allContentDownloaded") || objc_msgSend(v7, "lockedSupportingShortTermLocking") && !objc_msgSend(v11, "lockedSupportingShortTermLocking") || objc_msgSend(v7, "lockedSupportingShortTermLocking") && !objc_msgSend(v11, "lockedSupportingShortTermLocking") || (objc_msgSend(v7, "awaitingLastReferenceNewerFound") & 1) == 0 && (objc_msgSend(v11, "awaitingLastReferenceNewerFound") & 1) != 0 || (objc_msgSend(v7, "awaitingLastReferenceAltered") & 1) == 0 && (objc_msgSend(v11, "awaitingLastReferenceAltered") & 1) != 0)
      {
        break;
      }

      v17 = v8;
      v15 = [v7 instanceCreationIndex];
      v16 = [v11 instanceCreationIndex];
      if (v13)
      {
      }

      if (v15 <= v16)
      {
        v8 = v17;
        goto LABEL_28;
      }

LABEL_27:
      v14 = v11;

      v7 = v14;
      v8 = v10;
LABEL_28:

      if (v6 == ++v10)
      {
        goto LABEL_4;
      }
    }

    if (v13)
    {
LABEL_25:
    }

    goto LABEL_27;
  }

  v8 = 0;
LABEL_4:
  if (v7 && (v8 & 0x8000000000000000) == 0)
  {
    [v4 removeObjectAtIndex:v8];
  }

LABEL_8:

  return v7;
}

- (BOOL)atomicInstanceFromPSUSLookupResultOncePersonalized:(id)a3 forSetConfiguration:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = +[NSUUID UUID];
  v11 = [v10 UUIDString];

  v12 = [MADAutoSetDescriptor alloc];
  v13 = [v7 clientDomainName];
  v14 = [v7 assetSetIdentifier];
  v15 = [v6 discoveredAtomicEntries];
  v16 = [(MADAutoSetDescriptor *)v12 initForClientDomainName:v13 forAssetSetIdentifier:v14 withDiscoveredAtomicInstance:v11 withDiscoveredAtomicEntries:v15];

  v17 = [v7 newerAtomicInstanceOncePersonalized];

  if (v17)
  {
    [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forSetConfiguration:v7];
    if (!v16)
    {
      [(MADAutoAssetControlManager *)self setConfigurationPersist:v7 fromLocation:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forReason:@"just cleared newer-once-personalized and unable to create from-staged set-descriptor" dueToAlter:0 forHistoryOperation:9999];
LABEL_7:
      v28 = 0;
      goto LABEL_8;
    }
  }

  else if (!v16)
  {
    goto LABEL_7;
  }

  v18 = [v6 catalogCachedAssetSetID];
  [v16 setCatalogCachedAssetSetID:v18];

  v19 = [v6 catalogDownloadedFromLive];
  [v16 setCatalogDownloadedFromLive:v19];

  v20 = [v6 catalogLastTimeChecked];
  [v16 setCatalogLastTimeChecked:v20];

  v21 = [v6 catalogPostedDate];
  [v16 setCatalogPostedDate:v21];

  v22 = [v6 catalogCachedAssetSetID];
  [v16 setDownloadedCatalogCachedAssetSetID:v22];

  v23 = [v6 catalogDownloadedFromLive];
  [v16 setDownloadedCatalogDownloadedFromLive:v23];

  v24 = [v6 catalogLastTimeChecked];
  [v16 setDownloadedCatalogLastTimeChecked:v24];

  v25 = [v6 catalogPostedDate];
  [v16 setDownloadedCatalogPostedDate:v25];

  v26 = [v6 requestedAutoAssetEntries];
  [v16 setRequestedAutoAssetEntries:v26];

  [v16 setLatestDownloadedAtomicInstance:v11];
  v27 = [v6 discoveredAtomicEntries];
  [v16 setLatestDowloadedAtomicInstanceEntries:v27];

  v28 = 1;
  [v16 setIsOnFilesystem:1];
  [v16 setIsDiscoveredFullyDownloaded:1];
  [v16 setAtomicInstanceDownloadedNotified:1];
  [v16 setNeverBeenLocked:1];
  v29 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forCreationReason:@"PSUS_NEEDS_PERSONALIZATION" recordingHistoryOperation:220 recoveringForSetDescriptor:v16 usingAsSetClient:@"PROMOTED-NEEDS-PERSONALIZATION"];
  if (!v29)
  {
    goto LABEL_7;
  }

  v30 = v29;
  LOBYTE(v34) = 1;
  BYTE2(v33) = 0;
  LOWORD(v33) = 0;
  [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v16 forLatestDownloaded:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forSpecificAtomicInstance:1 withCurrentSetStatus:v11 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v33 latestToVend:350 historyOperation:@"PROMOTED-NEEDS-PERSONALIZATION" firstClientName:v34 fromPreSUStaging:?];
  v31 = [v30 atomicInstanceUUID];
  [v7 setNewerAtomicInstanceOncePersonalized:v31];

LABEL_8:
  return v28;
}

- (void)atomicInstanceDropOncePersonalized:(id)a3 forSetConfiguration:(id)a4
{
  v13 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 newerAtomicInstanceOncePersonalized];

  if (v9)
  {
    v10 = [v6 newerAtomicInstanceOncePersonalized];
    v11 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v13 forAtomicInstanceUUID:v10 requireExists:1];

    if (v11)
    {
      [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v11 fromLocation:v13 checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:344 historyOperationSD:388];
    }

    else
    {
      v12 = [v6 newerAtomicInstanceOncePersonalized];
      [(MADAutoAssetControlManager *)self atomicInstanceRemove:v13 setAtomicInstanceUUID:v12 removingForReason:@"{atomicInstanceDropOncePersonalized} (atomic-instance without set-descriptor)" historyOperation:344];
    }

    [v6 setNewerAtomicInstanceOncePersonalized:0];
  }
}

- (void)atomicInstanceTrimOverflowAfterPersisting:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  v8 = [v4 assetSetIdentifier];
  v104 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v7 forAssetSetIdentifier:v8];

  v9 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v10 = [v9 persistedEntryIDs:@"atomicInstanceTrimOverflowAfterPersisting"];

  if ([v10 count])
  {
    v11 = objc_alloc_init(NSMutableArray);
    v106 = objc_alloc_init(NSMutableArray);
    v12 = objc_alloc_init(NSMutableArray);
    v13 = v12;
    v96 = v11;
    if (v11 && v106 && v12)
    {
      v105 = v4;
      v95 = v12;
      v112 = +[NSFileManager defaultManager];
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceTrimOverflowAfterPersisting" ofContainer:@"persistedKnownSetAtomicInstances"];
      v127 = 0u;
      v128 = 0u;
      v125 = 0u;
      v126 = 0u;
      v94 = v10;
      obj = v10;
      v14 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
      v116 = self;
      if (!v14)
      {
        goto LABEL_68;
      }

      v15 = v14;
      v16 = *v126;
      v108 = *v126;
      while (1)
      {
        v17 = 0;
        v107 = v15;
        do
        {
          if (*v126 != v16)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v125 + 1) + 8 * v17);
          v19 = objc_autoreleasePoolPush();
          v20 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v21 = [v20 persistedEntry:v18 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting"];

          if (v18)
          {
            v22 = v21 == 0;
          }

          else
          {
            v22 = 1;
          }

          if (!v22)
          {
            v113 = v19;
            v27 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
            v28 = [v27 decodeFromLocation:@"atomicInstanceTrimOverflowAfterPersisting" ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

            if (!v28)
            {
              goto LABEL_27;
            }

            v110 = v21;
            [v28 atomicInstanceUUID];
            v30 = v29 = v28;
            v31 = [v105 atomicInstanceUUID];
            if ([SUCore stringIsEqual:v30 to:v31])
            {

              v15 = v107;
              v32 = v30;
              v28 = v29;
              goto LABEL_26;
            }

            v33 = [v29 atomicInstanceUUID];
            v34 = [v104 latestAtomicInstanceToVend];
            if (([SUCore stringIsEqual:v33 to:v34]& 1) != 0)
            {

              self = v116;
              v15 = v107;
              v32 = v30;
              v28 = v29;
              goto LABEL_26;
            }

            v35 = [v29 atomicInstanceUUID];
            v36 = [v105 atomicInstanceUUID];
            if (v35 == v36)
            {

              self = v116;
              v15 = v107;
              v32 = v30;
            }

            else
            {
              v99 = v36;
              log = v35;
              v37 = [v29 clientDomainName];
              [v105 clientDomainName];
              v38 = v100 = v37;
              v39 = [SUCore stringIsEqual:v37 to:?];
              v21 = v110;
              if (v39)
              {
                v97 = v29;
                v40 = [v29 assetSetIdentifier];
                v41 = [v105 assetSetIdentifier];
                v98 = [SUCore stringIsEqual:v40 to:v41];

                self = v116;
                v15 = v107;
                v28 = v97;
                if (v98)
                {
                  v32 = [(MADAutoAssetControlManager *)v116 atomicInstanceNewIdentifierForSetAtomicInstance:v97];
                  if (v32)
                  {
                    [v96 addObject:v97];
                    if ([v96 count] >= 7 && !+[MADAutoAssetControlManager preferenceAutoAssetNoPersistedOverflowLimit](MADAutoAssetControlManager, "preferenceAutoAssetNoPersistedOverflowLimit"))
                    {
                      v42 = [(MADAutoAssetControlManager *)v116 atomicInstanceOverflowRemove:v96];
                      if (v42)
                      {
                        v43 = [(MADAutoAssetControlManager *)v116 atomicInstanceNewEntryIDForSetAtomicInstance:v42];
                        if (v43)
                        {
                          v101 = v43;
                          v111 = v42;
                          v44 = [v42 atomicInstanceUUID];
                          v45 = [(MADAutoAssetControlManager *)v116 locateSetDescriptor:@"atomicInstanceTrimOverflowAfterPersisting" forAtomicInstanceUUID:v44 requireExists:0];

                          if (!v45)
                          {
                            v58 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
                            {
                              v59 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                              v60 = [v111 summary];
                              *buf = 138543618;
                              v132 = v59;
                              v133 = 2114;
                              v134 = v60;
                              _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance without backing set-descriptor | removedOverflowAtomicInstance:%{public}@", buf, 0x16u);

                              v15 = v107;
                            }

                            [v106 addObject:v18];
                            goto LABEL_60;
                          }

                          if ([(MADAutoAssetControlManager *)v116 isAtomicInstanceLatestToVendForSet:v97])
                          {
                            v46 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                            {
                              v47 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                              v48 = [v111 summary];
                              *buf = 138543618;
                              v132 = v47;
                              v133 = 2114;
                              v134 = v48;
                              v49 = v46;
                              v50 = "[%{public}@]\n[CONSIDER-OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance is latest-to-vend to set (keeping) | setAtomicInstance:%{public}@";
                              goto LABEL_58;
                            }

                            goto LABEL_59;
                          }

                          v61 = [(MADAutoAssetControlManager *)v116 isAtomicInstanceForCurrentSetJob:v97];
                          v62 = _MADLog(@"AutoControl");
                          v46 = v62;
                          if (v61)
                          {
                            if (os_log_type_enabled(v62, OS_LOG_TYPE_DEFAULT))
                            {
                              v47 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                              v48 = [v111 summary];
                              *buf = 138543618;
                              v132 = v47;
                              v133 = 2114;
                              v134 = v48;
                              v49 = v46;
                              v50 = "[%{public}@]\n[CONSIDER-OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance for currently active set-job (keeping) | setAtomicInstance:%{public}@";
LABEL_58:
                              _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, v50, buf, 0x16u);
                            }

LABEL_59:

LABEL_60:
                            v43 = v101;
                            v53 = v45;
                          }

                          else
                          {
                            if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
                            {
                              v63 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                              v64 = [v111 summary];
                              v65 = [v45 summary];
                              *buf = 138543874;
                              v132 = v63;
                              v133 = 2114;
                              v134 = v64;
                              v135 = 2114;
                              v136 = v65;
                              _os_log_impl(&dword_0, v46, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} [WARNING] over threshold for atomic-instances by set-identifier (trimming) | setAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);

                              v15 = v107;
                            }

                            v43 = v101;
                            [v106 addObject:v101];
                            v66 = [v45 latestDownloadedAtomicInstance];
                            [v95 addObject:v66];

                            v53 = v45;
                          }

LABEL_61:
                          v42 = v111;
                        }

                        else
                        {
                          v53 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
                          {
                            [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                            v56 = loga = v53;
                            v57 = [v42 summary];
                            *buf = 138543618;
                            v132 = v56;
                            v133 = 2114;
                            v134 = v57;
                            _os_log_impl(&dword_0, loga, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to determine persisted-set-atomic-instance file | setAtomicInstance:%{public}@", buf, 0x16u);

                            v43 = 0;
                            v53 = loga;
                          }
                        }
                      }

                      else
                      {
                        v43 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
                        {
                          v53 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                          [v97 summary];
                          v111 = 0;
                          v55 = v54 = v43;
                          *buf = 138543618;
                          v132 = v53;
                          v133 = 2114;
                          v134 = v55;
                          _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} over threshold for atomic-instances by set-identifier (unable to reduce) | setAtomicInstance:%{public}@", buf, 0x16u);

                          v43 = v54;
                          goto LABEL_61;
                        }
                      }
                    }
                  }

                  else
                  {
                    v51 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                    {
                      v52 = [(MADAutoAssetControlManager *)v116 _updateLatestSummary];
                      *buf = 138543618;
                      v132 = v52;
                      v133 = 2114;
                      v134 = v18;
                      _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to load set-atomic-instance | entryID:%{public}@", buf, 0x16u);
                    }

                    [v106 addObject:v18];
                  }

LABEL_26:
                }

LABEL_27:

                v16 = v108;
                v19 = v113;
                goto LABEL_28;
              }

              self = v116;
              v15 = v107;
              v32 = v30;
            }

            v28 = v29;
            goto LABEL_26;
          }

          v23 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
          {
            v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v25 = v24;
            *buf = 138543618;
            v26 = @"N";
            if (v18)
            {
              v26 = v18;
            }

            v132 = v24;
            v133 = 2114;
            v134 = v26;
            _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }

          if (v18)
          {
            [v106 addObject:v18];
          }

LABEL_28:

          objc_autoreleasePoolPop(v19);
          v17 = v17 + 1;
        }

        while (v15 != v17);
        v67 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
        v15 = v67;
        if (!v67)
        {
LABEL_68:

          v123 = 0u;
          v124 = 0u;
          v121 = 0u;
          v122 = 0u;
          v114 = v106;
          v68 = [v114 countByEnumeratingWithState:&v121 objects:v130 count:16];
          if (v68)
          {
            v69 = v68;
            v70 = *v122;
            do
            {
              for (i = 0; i != v69; i = i + 1)
              {
                if (*v122 != v70)
                {
                  objc_enumerationMutation(v114);
                }

                v72 = *(*(&v121 + 1) + 8 * i);
                v73 = objc_autoreleasePoolPush();
                v74 = [(MADAutoAssetControlManager *)v116 persistedKnownSetAtomicInstances];
                v75 = [v74 persistedEntry:v72 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting"];

                v76 = [(MADAutoAssetControlManager *)v116 persistedKnownSetAtomicInstances];
                v77 = [v76 decodeFromLocation:@"atomicInstanceTrimOverflowAfterPersisting" ofEntryName:v72 fromPersistedEntry:v75 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

                if (v77)
                {
                  v78 = [v77 atomicInstanceUUID];
                  [(MADAutoAssetControlManager *)v116 atomicInstanceRemove:@"atomicInstanceTrimOverflowAfterPersisting" setAtomicInstanceUUID:v78 removingForReason:@"dropping to avoid overflow" historyOperation:335];
                }

                objc_autoreleasePoolPop(v73);
              }

              v69 = [v114 countByEnumeratingWithState:&v121 objects:v130 count:16];
            }

            while (v69);
          }

          v119 = 0u;
          v120 = 0u;
          v117 = 0u;
          v118 = 0u;
          v115 = v95;
          v79 = [v115 countByEnumeratingWithState:&v117 objects:v129 count:16];
          v80 = v116;
          if (v79)
          {
            v81 = v79;
            v82 = *v118;
            do
            {
              for (j = 0; j != v81; j = j + 1)
              {
                if (*v118 != v82)
                {
                  objc_enumerationMutation(v115);
                }

                v84 = *(*(&v117 + 1) + 8 * j);
                v85 = objc_autoreleasePoolPush();
                v86 = [(MADAutoAssetControlManager *)v80 locateSetDescriptor:@"atomicInstanceTrimOverflowAfterPersisting" forAtomicInstanceUUID:v84 requireExists:0];
                v87 = v86;
                if (v86)
                {
                  v88 = [v86 clientDomainName];
                  v89 = [v87 assetSetIdentifier];
                  v80 = v116;
                  v90 = [MANAutoAssetSetStatus shortTermLockFilename:v88 forAssetSetIdentifier:v89 forSetAtomicInstance:v84];

                  [(MADAutoAssetControlManager *)v116 removeSetDescriptorDownloaded:v87 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:336 historyOperationSD:380];
                  v91 = [(MADAutoAssetControlManager *)v116 _shortTermSharedLockRemove:@"atomicInstanceTrimOverflowAfterPersisting" removingSharedLockFilename:v90 usingFileManager:v112 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
                }

                objc_autoreleasePoolPop(v85);
              }

              v81 = [v115 countByEnumeratingWithState:&v117 objects:v129 count:16];
            }

            while (v81);
          }

          v4 = v105;
          v10 = v94;
          v13 = v95;
          v92 = v112;
          goto LABEL_89;
        }
      }
    }

    v92 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v92, OS_LOG_TYPE_ERROR))
    {
      v93 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v132 = v93;
      _os_log_impl(&dword_0, v92, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to allocate required resources", buf, 0xCu);
    }

LABEL_89:
  }
}

- (BOOL)atomicInstanceHasDownloadedSetDescriptor:(id)a3 verboseLogging:(BOOL)a4
{
  v4 = a4;
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v10 = [v9 persistedEntryIDs:@"atomicInstanceHasDownloadedSetDescriptor"];

  v76 = v6;
  if ([v10 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceHasDownloadedSetDescriptor" ofContainer:@"persistedDownloadedSetDescriptors"];
    v87 = 0u;
    v88 = 0u;
    v85 = 0u;
    v86 = 0u;
    v11 = v10;
    v12 = [v11 countByEnumeratingWithState:&v85 objects:v98 count:16];
    if (!v12)
    {
      goto LABEL_27;
    }

    v13 = v12;
    v70 = v10;
    v74 = v4;
    v14 = @"atomicInstanceHasDownloadedSetDescriptor";
    v79 = *v86;
    v71 = self;
LABEL_4:
    v15 = 0;
    obj = v13;
    while (1)
    {
      if (*v86 != v79)
      {
        objc_enumerationMutation(v11);
      }

      v16 = *(*(&v85 + 1) + 8 * v15);
      v17 = objc_autoreleasePoolPush();
      v18 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v19 = [v18 persistedEntry:v16 fromLocation:v14];

      if (v19)
      {
        v20 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        v21 = [v20 decodeFromLocation:v14 ofEntryName:v16 fromPersistedEntry:v19 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v21)
        {
          v30 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR))
          {
            v34 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = v34;
            v92 = 2114;
            v93 = v16;
            _os_log_impl(&dword_0, v30, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to load set-descriptor (downloaded) | entryID:%{public}@", buf, 0x16u);

LABEL_17:
            v13 = obj;
          }

LABEL_20:

          goto LABEL_21;
        }

        v22 = v21;
        v23 = v19;
        v24 = v14;
        v25 = v17;
        v26 = v11;
        v77 = v22;
        v27 = [v22 latestDownloadedAtomicInstance];
        v28 = [v76 atomicInstanceUUID];
        v29 = [SUCore stringIsEqual:v27 to:v28];

        if (v29)
        {
          v38 = v26;
          v58 = v25;
          if (v74)
          {
            v59 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
            {
              v60 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v61 = [v76 summary];
              v62 = [v77 summary];
              *buf = 138544130;
              v91 = v60;
              v92 = 2114;
              v93 = v61;
              v94 = 2114;
              v95 = v16;
              v96 = 2114;
              v97 = v62;
              _os_log_impl(&dword_0, v59, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors matched | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);
            }
          }

          objc_autoreleasePoolPop(v58);
          v57 = 1;
          v37 = v38;
          v6 = v76;
          goto LABEL_66;
        }

        v11 = v26;
        if (v74)
        {
          v30 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
          {
            v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v32 = [v76 summary];
            v33 = [v77 summary];
            *buf = 138544130;
            v91 = v31;
            v92 = 2114;
            v93 = v32;
            v94 = 2114;
            v95 = v16;
            v96 = 2114;
            v97 = v33;
            _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors no match | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

            v11 = v26;
            self = v71;

            v17 = v25;
            v14 = v24;
            v19 = v23;
            v21 = v77;
            goto LABEL_17;
          }

          v17 = v25;
          v14 = v24;
          v19 = v23;
          v13 = obj;
          v21 = v77;
          goto LABEL_20;
        }

        v17 = v25;
        v14 = v24;
        v19 = v23;
        v13 = obj;
        v21 = v77;
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v91 = v30;
          v92 = 2114;
          v93 = v16;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to determine previous status (downloaded set-descriptors) | entryID:%{public}@", buf, 0x16u);
          goto LABEL_20;
        }
      }

LABEL_21:

      objc_autoreleasePoolPop(v17);
      if (v13 == ++v15)
      {
        v13 = [v11 countByEnumeratingWithState:&v85 objects:v98 count:16];
        if (!v13)
        {
          v4 = v74;
          v10 = v70;
          v6 = v76;
          goto LABEL_27;
        }

        goto LABEL_4;
      }
    }
  }

  if (v4)
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v35 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v91 = v35;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors no persistedEntryIDs", buf, 0xCu);
    }

LABEL_27:
  }

  v36 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v37 = [v36 persistedEntryIDs:@"atomicInstanceHasDownloadedSetDescriptor"];

  if ([v37 count])
  {
    v83 = 0u;
    v84 = 0u;
    v81 = 0u;
    v82 = 0u;
    v38 = v37;
    v80 = [v38 countByEnumeratingWithState:&v81 objects:v89 count:16];
    if (v80)
    {
      v75 = v4;
      v39 = @"atomicInstanceHasDownloadedSetDescriptor";
      v78 = *v82;
      obja = v38;
LABEL_31:
      v40 = 0;
      while (1)
      {
        if (*v82 != v78)
        {
          objc_enumerationMutation(obja);
        }

        v41 = *(*(&v81 + 1) + 8 * v40);
        v42 = objc_autoreleasePoolPush();
        v43 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        v44 = [v43 persistedEntry:v41 fromLocation:v39];

        if (!v44)
        {
          v47 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
          {
            v56 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = v56;
            v92 = 2114;
            v93 = v41;
            _os_log_impl(&dword_0, v47, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to determine previous status (active-job set-descriptors) | entryID:%{public}@", buf, 0x16u);
          }

          goto LABEL_48;
        }

        v45 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        v46 = v39;
        v47 = [v45 decodeFromLocation:v39 ofEntryName:v41 fromPersistedEntry:v44 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v47)
        {
          v48 = [v47 latestDownloadedAtomicInstance];
          v49 = [v6 atomicInstanceUUID];
          v50 = [SUCore stringIsEqual:v48 to:v49];

          if (v50)
          {
            v6 = v76;
            v38 = obja;
            v64 = v42;
            if (v75)
            {
              v65 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
              {
                v66 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v67 = [v76 summary];
                v68 = [v47 summary];
                *buf = 138544130;
                v91 = v66;
                v92 = 2114;
                v93 = v67;
                v94 = 2114;
                v95 = v41;
                v96 = 2114;
                v97 = v68;
                _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors matched | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

                v6 = v76;
              }
            }

            objc_autoreleasePoolPop(v64);
            v57 = 1;
            goto LABEL_65;
          }

          if (!v75)
          {
            v6 = v76;
            goto LABEL_47;
          }

          v51 = _MADLog(@"AutoControl");
          v6 = v76;
          if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
          {
            v52 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v53 = [v76 summary];
            v54 = [v47 summary];
            *buf = 138544130;
            v91 = v52;
            v92 = 2114;
            v93 = v53;
            v94 = 2114;
            v95 = v41;
            v96 = 2114;
            v97 = v54;
            v55 = v54;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors no match | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

            v6 = v76;
LABEL_44:
          }
        }

        else
        {
          v51 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
          {
            v52 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = v52;
            v92 = 2114;
            v93 = v41;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to load set-descriptor (active-job) | entryID:%{public}@", buf, 0x16u);
            goto LABEL_44;
          }
        }

LABEL_47:
        v39 = v46;
LABEL_48:

        objc_autoreleasePoolPop(v42);
        if (v80 == ++v40)
        {
          v38 = obja;
          v80 = [obja countByEnumeratingWithState:&v81 objects:v89 count:16];
          if (v80)
          {
            goto LABEL_31;
          }

          break;
        }
      }
    }

    v57 = 0;
LABEL_65:
    v37 = v38;
LABEL_66:
  }

  else
  {
    if (v4)
    {
      v38 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
      {
        v63 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v91 = v63;
        _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors no persistedEntryIDs", buf, 0xCu);
      }

      v57 = 0;
      goto LABEL_66;
    }

    v57 = 0;
  }

  return v57;
}

- (void)resumeJobsWhenBeforeFirstUnlock:(BOOL)a3
{
  v3 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [NSString alloc];
  v8 = @"Y";
  if (!v3)
  {
    v8 = @"N";
  }

  v9 = [v7 initWithFormat:@"resumeJobsWhenBeforeFirstUnlock:%@", v8];
  v10 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v11 = [v10 persistedEntryIDs:v9];

  v138 = objc_alloc_init(NSMutableArray);
  if ([v11 count])
  {
    v134 = v3;
    v136 = objc_alloc_init(NSMutableArray);
    v12 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"resumeJobsWhenBeforeFirstUnlock" ofContainer:@"persistedActiveJobs"];
    v180 = 0u;
    v181 = 0u;
    v178 = 0u;
    v179 = 0u;
    v135 = v11;
    obj = v11;
    v13 = [obj countByEnumeratingWithState:&v178 objects:v194 count:16];
    v169 = v9;
    if (v13)
    {
      v14 = v13;
      v137 = 0;
      v15 = *v179;
      v163 = v12;
      v164 = *v179;
      while (1)
      {
        v16 = 0;
        do
        {
          if (*v179 != v15)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v178 + 1) + 8 * v16);
          v18 = objc_autoreleasePoolPush();
          if (v17)
          {
            v19 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v20 = [v19 persistedEntry:v17 fromLocation:v9];

            if (v20)
            {
              v21 = v14;
              v22 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v23 = [v22 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              v24 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v25 = [v24 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetSelector" ofClass:objc_opt_class() allowingNilObject:0];

              v167 = v23;
              if (v23)
              {
                if ([v23 isBlankEntry])
                {
                  v26 = _MADLog(@"AutoControl");
                  v14 = v21;
                  if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                  {
                    v27 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543874;
                    v185 = v27;
                    v186 = 2114;
                    v187 = v169;
                    v188 = 2114;
                    v189 = v17;
                    v28 = v26;
                    v29 = OS_LOG_TYPE_DEFAULT;
                    v30 = "[%{public}@] {%{public}@} encountered blank auto-asset-descriptor | entryID:%{public}@";
                    goto LABEL_23;
                  }

                  goto LABEL_24;
                }

                v35 = [v23 assetVersion];

                v14 = v21;
                if (v35)
                {
                  v15 = v164;
                  if (v25)
                  {
                    v36 = [v25 assetVersion];

                    if (v36)
                    {
                      v156 = v25;
                      if (([v167 isOnFilesystem] & 1) == 0 && !-[MADAutoAssetControlManager jobDescriptorInFlightNowOnFilesystem:](self, "jobDescriptorInFlightNowOnFilesystem:", v167))
                      {
                        v37 = [v167 assetVersion];
                        if (v37)
                        {
                          v38 = v37;
                          v39 = [v167 assetId];

                          if (v39)
                          {
                            v40 = [v20 stringForKey:@"autoAssetUUID"];
                            v41 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                            v139 = [v41 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"clientRequestMessage" ofClass:objc_opt_class() allowingNilObject:1];

                            v42 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                            v43 = [v42 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"baseForPatchDescriptor" ofClass:objc_opt_class() allowingNilObject:1];

                            v141 = v40;
                            if (!v40)
                            {
                              v140 = v43;
                              v80 = _MADLog(@"AutoControl");
                              v25 = v156;
                              if (os_log_type_enabled(v80, OS_LOG_TYPE_ERROR))
                              {
                                contextd = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v81 = [v156 summary];
                                *buf = 138544386;
                                v185 = contextd;
                                v186 = 2114;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v17;
                                v190 = 2114;
                                v191 = v81;
                                v82 = v81;
                                v192 = 2114;
                                v193 = @"MISSING";
                                _os_log_impl(&dword_0, v80, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous information | entryID:%{public}@, selector:%{public}@, UUID:%{public}@", buf, 0x34u);
                              }

                              v12 = v163;
                              [v163 addObject:v17];
                              v9 = v169;
                              v83 = 0;
                              goto LABEL_88;
                            }

                            v25 = v156;
                            v146 = [(MADAutoAssetControlManager *)self currentJobBySelector:v156];
                            v44 = v43;
                            v12 = v163;
                            if (v44)
                            {
                              v45 = [v44 isBlankEntry];
                              v46 = v44;
                              v9 = v169;
                              if (v45)
                              {

                                v140 = 0;
                              }

                              else
                              {
                                v140 = v46;
                              }
                            }

                            else
                            {
                              v140 = 0;
                              v9 = v169;
                            }

                            if (v146)
                            {
                              v86 = _MADLog(@"AutoControl");
                              if (os_log_type_enabled(v86, OS_LOG_TYPE_DEFAULT))
                              {
                                v87 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                *buf = 138543874;
                                v185 = v87;
                                v186 = 2114;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v17;
                                _os_log_impl(&dword_0, v86, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} auto-asset-job already resumed | entry:%{public}@", buf, 0x20u);

                                v12 = v163;
                              }

                              [v12 addObject:v17];
                              v9 = v169;
LABEL_86:
                              v83 = v141;
LABEL_87:

LABEL_88:
LABEL_43:

                              goto LABEL_44;
                            }

                            if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock]|| ([(MADAutoAssetControlManager *)self _updatePolicyForSelector:v156], (v88 = objc_claimAutoreleasedReturnValue()) == 0))
                            {
                              [(MADAutoAssetControlManager *)self _moveFromAwaitingResumedInto:v138 forSelector:v156];
                              v146 = 0;
                              goto LABEL_86;
                            }

                            v133 = v88;
                            if (v134 && ([v88 blockIfBeforeFirstUnlock] & 1) != 0)
                            {
                              [(MADAutoAssetControlManager *)self _moveFromAwaitingResumedInto:v138 forSelector:v156];
                              v89 = v17;
                              v83 = v141;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v9 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v89 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"auto-asset-job resume postponed (awaiting first-unlock)"];

                              goto LABEL_88;
                            }

                            v132 = objc_alloc_init(NSMutableArray);
                            [MADAutoAssetControlManager _moveFromAwaitingResumedInto:"_moveFromAwaitingResumedInto:forSelector:" forSelector:?];
                            v146 = [[MADAutoAssetJob alloc] initForDescriptor:v167 withLifetimeOSTransaction:0 baseForPatchDescriptor:v140 withAutoAssetUUID:v141];
                            if (!v146)
                            {
                              v154 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                              contexte = [v154 diag];
                              v93 = [NSString alloc];
                              v94 = [v156 summary];
                              v95 = [v93 initWithFormat:@"{%@} unable to allocate autoAssetJob | selector:%@", v169, v94];
                              [contexte trackAnomaly:@"AUTO-CONTROL" forReason:v95 withResult:6101 withError:0];

                              v9 = v169;
                              v25 = v156;

                              v12 = v163;
                              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
                              v96 = v17;
                              v83 = v141;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v169 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v96 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"unable to create auto-asset-job (not removing from active jobs persisted-state since may be able to recover on next MA daemon startup)"];
                              goto LABEL_128;
                            }

                            if ([(MADAutoAssetControlManager *)self _inMatchedTaskDescriptors:v136 addingMatchingJobUUID:v141])
                            {
                              v9 = v169;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v169 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v17 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"in-flight taskDescriptor repeated (already mapped to additional job)"];
                              v90 = _MADLog(@"AutoControl");
                              if (os_log_type_enabled(v90, OS_LOG_TYPE_ERROR))
                              {
                                v91 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v92 = [v156 summary];
                                *buf = 138544130;
                                v185 = v91;
                                v186 = 2112;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v92;
                                v190 = 2114;
                                v191 = v141;
                                _os_log_impl(&dword_0, v90, OS_LOG_TYPE_ERROR, "[%{public}@] {resumeJobsWhenBeforeFirstUnlock:%@} in-flight taskDescriptor repeated (already mapped to additional job) | selector:%{public}@, UUID:%{public}@", buf, 0x2Au);

                                v12 = v163;
                                v9 = v169;
                              }

LABEL_127:
                              v83 = v141;
LABEL_128:

                              goto LABEL_87;
                            }

                            v97 = [v139 messageName];
                            v98 = [(MADAutoAssetControlManager *)self _messageShouldBeScheduled:v97 forAssetSelector:v156];

                            if (v98)
                            {
                              [(MADAutoAssetControlManager *)self _scheduleSelector:v156];
                            }

                            [(MADAutoAssetControlManager *)self _removeJobFromDownloadsInFlight:v141];
                            [(MADAutoAssetControlManager *)self addToCurrentJobs:v146 usingSelector:v156 withJobUUID:v141 triggeredByClientMessage:v139 downloadingDescriptor:v167 baseForPatchDescriptor:v140 usingSetDescriptor:0 fromLocation:@"resumeJobsWhenBeforeFirstUnlock"];
                            [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v169 operation:@"ENTRY_LOAD" usingSelector:v156 withJobUUID:v141 triggeredByClientMessage:v139 downloadingDescriptor:v167 baseForPatchDescriptor:v140 message:@"auto-asset-job resumed"];
                            [(MADAutoAssetControlManager *)self _statsIncrementResumedInFlightJobs];
                            [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                            v99 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v156];
                            [v146 startResumingInFlightDownload:v167 withControlInformation:v99];

                            v176 = 0u;
                            v177 = 0u;
                            v174 = 0u;
                            v175 = 0u;
                            v145 = v132;
                            v155 = [v145 countByEnumeratingWithState:&v174 objects:v183 count:16];
                            if (!v155)
                            {
LABEL_126:
                              ++v137;

                              v9 = v169;
                              v15 = v164;
                              v25 = v156;
                              goto LABEL_127;
                            }

                            v152 = *v175;
                            while (2)
                            {
                              v100 = 0;
LABEL_111:
                              if (*v175 != v152)
                              {
                                objc_enumerationMutation(v145);
                              }

                              v101 = *(*(&v174 + 1) + 8 * v100);
                              contexta = objc_autoreleasePoolPush();
                              v102 = [v101 paramType];
                              if (v102 > 6)
                              {
                                if (v102 == (&dword_4 + 3))
                                {
                                  v103 = [v101 autoAssetJobID];
                                  v104 = [v101 downloadOptions];
                                  v105 = [v101 finishedError];
                                  [v146 handleDownloadConfigJobFinished:v103 withDownloadOptions:v104 configError:v105];
LABEL_123:
                                }

                                else
                                {
                                  if (v102 != &dword_8)
                                  {
                                    goto LABEL_120;
                                  }

                                  v103 = [v101 autoAssetJobID];
                                  v104 = [v101 downloadProgress];
                                  [v146 handleDownloadAssetProgressForJob:v103 withProgress:v104];
                                }
                              }

                              else if (v102 == (&dword_4 + 1))
                              {
                                v103 = [v101 autoAssetJobID];
                                v104 = [v101 finishedError];
                                [v146 handleDownloadAssetJobFinished:v103 downloadError:v104];
                              }

                              else
                              {
                                if (v102 == (&dword_4 + 2))
                                {
                                  v103 = [v101 autoAssetJobID];
                                  v104 = [v101 autoAssetCatalog];
                                  v105 = [v101 finishedError];
                                  [v146 handleDownloadCatalogJobFinished:v103 withCatalog:v104 downloadError:v105];
                                  goto LABEL_123;
                                }

LABEL_120:
                                v103 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                                v104 = [v103 diag];
                                v142 = [NSString alloc];
                                v106 = [v101 paramType];
                                v107 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v108 = [v142 initWithFormat:@"{%@} unknown paramType(%ld) on earlyDownloadManagerEvents | %@", v169, v106, v107];
                                [v104 trackAnomaly:@"AUTO-CONTROL" forReason:v108 withResult:6108 withError:0];
                              }

                              objc_autoreleasePoolPop(contexta);
                              v100 = v100 + 1;
                              v12 = v163;
                              if (v155 == v100)
                              {
                                v155 = [v145 countByEnumeratingWithState:&v174 objects:v183 count:16];
                                if (!v155)
                                {
                                  goto LABEL_126;
                                }

                                continue;
                              }

                              goto LABEL_111;
                            }
                          }
                        }
                      }

                      if (!-[MADAutoAssetControlManager jobDescriptorInFlightNowOnFilesystem:](self, "jobDescriptorInFlightNowOnFilesystem:", v167) || ([v167 assetVersion], (v51 = objc_claimAutoreleasedReturnValue()) == 0) || (v52 = v51, objc_msgSend(v167, "assetId"), v53 = objc_claimAutoreleasedReturnValue(), v53, v52, !v53))
                      {
                        v70 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v70, OS_LOG_TYPE_DEFAULT))
                        {
                          v71 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                          v72 = [v167 summary];
                          *buf = 138543874;
                          v185 = v71;
                          v186 = 2114;
                          v187 = v169;
                          v188 = 2114;
                          v189 = v72;
                          _os_log_impl(&dword_0, v70, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} not considering resuming | jobDescriptor:%{public}@", buf, 0x20u);

                          v15 = v164;
                        }

                        v12 = v163;
                        [v163 addObject:v17];
                        v9 = v169;
                        v25 = v156;
                        goto LABEL_43;
                      }

                      contextb = [MAAutoAssetSelector alloc];
                      v149 = [v167 assetType];
                      v54 = [v167 assetSpecifier];
                      v55 = [v167 assetVersion];
                      v56 = [contextb initForAssetType:v149 withAssetSpecifier:v54 matchingAssetVersion:v55];

                      v153 = v56;
                      if (v56)
                      {
                        v57 = [v56 persistedEntryID];
                        v58 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                        context = v57;
                        v59 = [v58 persistedEntryAlreadyExists:v57 fromLocation:v169];

                        if (v59)
                        {
                          v60 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                          v61 = [v60 persistedEntry:v57 fromLocation:v169];

                          v150 = v61;
                          if (v61)
                          {
                            v62 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                            v63 = [v62 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:context fromPersistedEntry:v61 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                            v64 = v63;
                            v12 = v163;
                            v25 = v156;
                            v147 = v64;
                            if (v64)
                            {
                              if ([v64 isOnFilesystem])
                              {
                                v65 = _MADLog(@"AutoControl");
                                if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
                                {
                                  v143 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                  v66 = [v64 summary];
                                  *buf = 138543874;
                                  v185 = v143;
                                  v186 = 2114;
                                  v67 = v169;
                                  v187 = v169;
                                  v188 = 2114;
                                  v189 = v66;
                                  v68 = v65;
                                  v69 = "[%{public}@] {%{public}@} previously in-flight already downloaded | nowDownloadedDescriptor:%{public}@";
                                  goto LABEL_92;
                                }

LABEL_93:
                                v9 = v169;
                              }

                              else
                              {
                                [v64 setIsOnFilesystem:1];
                                [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v64 fromLocation:@"resumeJobsWhenBeforeFirstUnlock(nowDownloadedDescriptor)"];
                                v65 = _MADLog(@"AutoControl");
                                if (!os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
                                {
                                  goto LABEL_93;
                                }

                                v143 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v66 = [v64 summary];
                                *buf = 138543874;
                                v185 = v143;
                                v186 = 2114;
                                v67 = v169;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v66;
                                v68 = v65;
                                v69 = "[%{public}@] {%{public}@} previously in-flight already downloaded (known descriptor) | nowDownloadedDescriptor:%{public}@";
LABEL_92:
                                _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, v69, buf, 0x20u);

                                v9 = v67;
                                v25 = v156;
                              }

                              v12 = v163;
                            }

                            else
                            {
                              v9 = v169;
                            }
                          }

                          else
                          {
                            v84 = _MADLog(@"AutoControl");
                            v147 = v84;
                            if (os_log_type_enabled(v84, OS_LOG_TYPE_ERROR))
                            {
                              v144 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                              v85 = [v167 summary];
                              *buf = 138543874;
                              v185 = v144;
                              v186 = 2114;
                              v187 = v169;
                              v188 = 2114;
                              v189 = v85;
                              _os_log_impl(&dword_0, v84, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} no persisted descriptor entry yet entry already exists | jobDescriptor:%{public}@", buf, 0x20u);

                              v9 = v169;
                              v12 = v163;
                            }

                            else
                            {
                              v12 = v163;
                              v9 = v169;
                            }

                            v25 = v156;
                          }
                        }

                        else
                        {
                          [v167 setIsOnFilesystem:1];
                          [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v167 fromLocation:@"resumeJobsWhenBeforeFirstUnlock(new jobDescriptor)"];
                          v77 = _MADLog(@"AutoControl");
                          v150 = v77;
                          if (os_log_type_enabled(v77, OS_LOG_TYPE_DEFAULT))
                          {
                            v148 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            v78 = [v167 summary];
                            *buf = 138543874;
                            v185 = v148;
                            v186 = 2114;
                            v187 = v169;
                            v188 = 2114;
                            v189 = v78;
                            v79 = v78;
                            _os_log_impl(&dword_0, v77, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} previously in-flight already downloaded (now downloaded descriptor) | jobDescriptor:%{public}@", buf, 0x20u);

                            v9 = v169;
                            v12 = v163;
                          }

                          else
                          {
                            v12 = v163;
                            v9 = v169;
                          }

                          v25 = v156;
                        }
                      }

                      else
                      {
                        v75 = _MADLog(@"AutoControl");
                        context = v75;
                        if (os_log_type_enabled(v75, OS_LOG_TYPE_ERROR))
                        {
                          v151 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                          v76 = [v167 summary];
                          *buf = 138543874;
                          v185 = v151;
                          v186 = 2114;
                          v187 = v169;
                          v188 = 2114;
                          v189 = v76;
                          _os_log_impl(&dword_0, v75, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to record downloaded-when-in-flight | jobDescriptor:%{public}@", buf, 0x20u);

                          v9 = v169;
                          v12 = v163;
                        }

                        else
                        {
                          v12 = v163;
                          v9 = v169;
                        }

                        v25 = v156;
                      }

                      [v12 addObject:v17];
                      goto LABEL_43;
                    }

                    v47 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                    {
                      contextc = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                      v73 = [v25 summary];
                      *buf = 138544130;
                      v185 = contextc;
                      v186 = 2114;
                      v187 = v169;
                      v188 = 2114;
                      v189 = v17;
                      v190 = 2114;
                      v191 = v73;
                      v74 = v73;
                      _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} encountered auto-asset-descriptor with persisted asset-selector without asset-version | entryID:%{public}@ | jobSelector:%{public}@", buf, 0x2Au);

                      v12 = v163;
                    }

LABEL_41:

                    [v12 addObject:v17];
LABEL_42:
                    v9 = v169;
                    goto LABEL_43;
                  }

                  v47 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                  {
                    goto LABEL_41;
                  }

                  v48 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v185 = v48;
                  v186 = 2114;
                  v187 = v169;
                  v188 = 2114;
                  v189 = v17;
                  v49 = v47;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-descriptor without persisted asset-selector | entryID:%{public}@";
                }

                else
                {
                  v47 = _MADLog(@"AutoControl");
                  v15 = v164;
                  if (!os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                  {
                    goto LABEL_41;
                  }

                  v48 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v185 = v48;
                  v186 = 2114;
                  v187 = v169;
                  v188 = 2114;
                  v189 = v17;
                  v49 = v47;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-descriptor without asset-version | entryID:%{public}@";
                }

                _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, v50, buf, 0x20u);

                v12 = v163;
                goto LABEL_41;
              }

              v26 = _MADLog(@"AutoControl");
              v14 = v21;
              if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
              {
                v27 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543874;
                v185 = v27;
                v186 = 2114;
                v187 = v169;
                v188 = 2114;
                v189 = v17;
                v28 = v26;
                v29 = OS_LOG_TYPE_ERROR;
                v30 = "[%{public}@] {%{public}@} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_23:
                _os_log_impl(&dword_0, v28, v29, v30, buf, 0x20u);

                v12 = v163;
              }

LABEL_24:

              [v12 addObject:v17];
              v15 = v164;
              goto LABEL_42;
            }
          }

          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
          {
            v32 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v33 = v32;
            *buf = 138543874;
            v34 = @"N";
            if (v17)
            {
              v34 = v17;
            }

            v185 = v32;
            v186 = 2114;
            v187 = v9;
            v188 = 2114;
            v189 = v34;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
          }

          if (v17)
          {
            [v12 addObject:v17];
          }

LABEL_44:
          objc_autoreleasePoolPop(v18);
          v16 = v16 + 1;
        }

        while (v16 != v14);
        v109 = [obj countByEnumeratingWithState:&v178 objects:v194 count:16];
        v14 = v109;
        if (!v109)
        {
          goto LABEL_134;
        }
      }
    }

    v137 = 0;
LABEL_134:

    v172 = 0u;
    v173 = 0u;
    v170 = 0u;
    v171 = 0u;
    obja = v12;
    v112 = [obja countByEnumeratingWithState:&v170 objects:v182 count:16];
    if (v112)
    {
      v113 = v112;
      v168 = *v171;
      do
      {
        for (i = 0; i != v113; i = i + 1)
        {
          if (*v171 != v168)
          {
            objc_enumerationMutation(obja);
          }

          v115 = *(*(&v170 + 1) + 8 * i);
          v116 = objc_autoreleasePoolPush();
          if (v115)
          {
            v117 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v118 = [v117 persistedEntry:v115 fromLocation:v169];

            v119 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v120 = [v119 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v115 fromPersistedEntry:v118 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v120)
            {
              v121 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              [v121 removePersistedEntry:v115 fromLocation:@"resumeJobsWhenBeforeFirstUnlock"];

              [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:v169 forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v115 removedDescriptor:v120 message:@"removing stale active-persisted job"];
            }
          }

          else
          {
            v118 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v120 = [v118 diag];
            v122 = [NSString alloc];
            v123 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v124 = [v122 initWithFormat:@"{%@} nil entryID encountered on staleActivePersistedEntryIDs | %@", v169, v123];
            [v120 trackAnomaly:@"AUTO-CONTROL" forReason:v124 withResult:6108 withError:0];
          }

          objc_autoreleasePoolPop(v116);
        }

        v113 = [obja countByEnumeratingWithState:&v170 objects:v182 count:16];
      }

      while (v113);
    }

    v125 = _MADLog(@"AutoControl");
    v126 = os_log_type_enabled(v125, OS_LOG_TYPE_DEFAULT);
    if (v137 < 1)
    {
      v9 = v169;
      if (v126)
      {
        v127 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v185 = v127;
        v186 = 2114;
        v187 = v169;
        v129 = "[%{public}@] {%{public}@} no jobs resumed (now active) | MA_MILESTONE";
        v130 = v125;
        v131 = 22;
LABEL_152:
        _os_log_impl(&dword_0, v130, OS_LOG_TYPE_DEFAULT, v129, buf, v131);
      }
    }

    else
    {
      v9 = v169;
      if (v126)
      {
        v127 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v128 = @"s";
        *buf = 138544130;
        v185 = v127;
        v186 = 2114;
        if (v137 == 1)
        {
          v128 = &stru_4BD3F0;
        }

        v187 = v169;
        v188 = 2048;
        v189 = v137;
        v190 = 2114;
        v191 = v128;
        v129 = "[%{public}@] {%{public}@} resumed %ld job%{public}@ (now active) | MA_MILESTONE";
        v130 = v125;
        v131 = 42;
        goto LABEL_152;
      }
    }

    v11 = v135;
    v110 = v136;
    goto LABEL_154;
  }

  v110 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v110, OS_LOG_TYPE_DEFAULT))
  {
    v111 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543618;
    v185 = v111;
    v186 = 2114;
    v187 = v9;
    _os_log_impl(&dword_0, v110, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no persisted auto-asset-jobs to be resumed | MA_MILESTONE", buf, 0x16u);
  }

LABEL_154:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:v9 forComponentType:@"ACTIVE-JOBS"];
  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v138];
}

- (void)resumeSetJobsWhenBeforeFirstUnlock:(BOOL)a3
{
  v3 = a3;
  v4 = self;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if ([(MADAutoAssetControlManager *)v4 persistedActiveSetJobsLoaded])
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
      v9 = v8;
      v10 = @"N";
      if (v3)
      {
        v10 = @"Y";
      }

      *buf = 138543618;
      v116 = v8;
      v117 = 2112;
      v118 = v10;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {resumeSetJobsWhenBeforeFirstUnlock:%@} called when persisted active set-jobs loaded earlier", buf, 0x16u);
    }

    goto LABEL_101;
  }

  [(MADAutoAssetControlManager *)v4 setPersistedActiveSetJobsLoaded:1];
  v11 = [NSString alloc];
  v12 = @"Y";
  if (!v3)
  {
    v12 = @"N";
  }

  v7 = [v11 initWithFormat:@"resumeSetJobsWhenBeforeFirstUnlock:%@", v12];
  v13 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
  v14 = [v13 persistedEntryIDs:v7];

  if ([v14 count])
  {
    v15 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)v4 trackPerformanceIteration:@"resumeSetJobsWhenBeforeFirstUnlock" ofContainer:@"persistedActiveJobSetDescriptors"];
    v113 = 0u;
    v114 = 0u;
    v111 = 0u;
    v112 = 0u;
    v87 = v14;
    obj = v14;
    v16 = [obj countByEnumeratingWithState:&v111 objects:v126 count:16];
    v99 = v15;
    v106 = v7;
    v88 = v3;
    if (!v16)
    {
      v89 = 0;
      goto LABEL_67;
    }

    v17 = v16;
    v89 = 0;
    v18 = *v112;
    while (1)
    {
      v19 = 0;
      v102 = v17;
      do
      {
        if (*v112 != v18)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v111 + 1) + 8 * v19);
        v21 = objc_autoreleasePoolPush();
        if (v20)
        {
          v22 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
          v23 = [v22 persistedEntry:v20 fromLocation:v7];

          if (v23)
          {
            v24 = v4;
            v25 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
            v26 = [v25 decodeFromLocation:@"resumeSetJobsWhenBeforeFirstUnlock" ofEntryName:v20 fromPersistedEntry:v23 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v26)
            {
              v27 = [v26 assetSetIdentifier];

              if (v27)
              {
                v28 = [v26 discoveredAtomicInstance];

                if (v28)
                {
                  v29 = [v26 discoveredAtomicEntries];

                  if (v29)
                  {
                    if ([v26 isOnFilesystem])
                    {
                      goto LABEL_41;
                    }

                    v30 = [v26 clientDomainName];
                    v31 = [v26 assetSetIdentifier];
                    v98 = [(MADAutoAssetControlManager *)v4 locateSetConfigurationByClientDomain:v30 forAssetSetIdentifier:v31];

                    v32 = [v26 discoveredAtomicInstance];
                    v96 = [(MADAutoAssetControlManager *)v4 locateSetAtomicInstanceByInstanceUUID:v32];

                    v33 = [v26 discoveredAtomicInstance];
                    v34 = [(MADAutoAssetControlManager *)v4 locateSetDescriptor:@"resumeSetJobsWhenBeforeFirstUnlock" forAtomicInstanceUUID:v33 requireExists:0];

                    v35 = [v26 discoveredAtomicInstance];
                    v36 = [(MADAutoAssetControlManager *)v4 locateSetDescriptorActiveJobByAtomicInstanceUUID:v35];

                    v100 = v34;
                    v97 = v36;
                    if (v34)
                    {
                      v37 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                      {
                        v92 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        v38 = [v26 summary];
                        v39 = [v34 summary];
                        *buf = 138544130;
                        v116 = v92;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = v38;
                        v121 = 2114;
                        v122 = v39;
                        v40 = v39;
                        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} not considering resuming active-set-job since have already downloaded set-descriptor | setJobDescriptor:%{public}@ | downloadedSetDescriptor:%{public}@", buf, 0x2Au);
                      }

                      v15 = v99;
                      [v99 addObject:v20];
                      v41 = v98;
                      goto LABEL_57;
                    }

                    v15 = v99;
                    if (v36)
                    {
                      v51 = _MADLog(@"AutoControl");
                      v41 = v98;
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        v93 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        v90 = [v26 summary];
                        v52 = [v97 summary];
                        *buf = 138544130;
                        v116 = v93;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = v90;
                        v121 = 2114;
                        v122 = v52;
                        _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} active-set-job set-descriptor repeated (already adopted set-job) | dropping repeated setJobDescriptor:%{public}@ | already tracking active setJobDescriptor:%{public}@", buf, 0x2Au);

                        v15 = v99;
                        v41 = v98;
                      }

                      goto LABEL_56;
                    }

                    v41 = v98;
                    if (v98)
                    {
                      if (v96)
                      {
                        v94 = [(MADAutoAssetControlManager *)v24 locateActiveAutoJobForSetDescriptor:v26];
                        if (v94)
                        {
                          ++v89;
                          [(MADAutoAssetControlManager *)v24 updateAutoAssetSetStatus:@"resumeSetJobsWhenBeforeFirstUnlock" forSetDescriptor:v26];
                        }

                        else
                        {
                          v58 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
                          {
                            v91 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                            v59 = [v26 summary];
                            *buf = 138543874;
                            v116 = v91;
                            v117 = 2114;
                            v118 = v106;
                            v119 = 2114;
                            v120 = v59;
                            v60 = v59;
                            _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} active-set-job set-descriptor yet no active active auto-asset-job | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x20u);

                            v15 = v99;
                          }

                          [v15 addObject:v20];
                        }

LABEL_57:
LABEL_41:

                        v7 = v106;
                        v4 = v24;
                        v17 = v102;
                        goto LABEL_42;
                      }

                      v51 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        v95 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        v57 = [v26 summary];
                        *buf = 138543874;
                        v116 = v95;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = v57;
                        v54 = v57;
                        v55 = v51;
                        v56 = "[%{public}@] {%{public}@} active-set-job set-descriptor yet no set-atomic-instance | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@";
LABEL_55:
                        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, v56, buf, 0x20u);

                        v15 = v99;
                      }
                    }

                    else
                    {
                      v51 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        v95 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        v53 = [v26 summary];
                        *buf = 138543874;
                        v116 = v95;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = v53;
                        v54 = v53;
                        v55 = v51;
                        v56 = "[%{public}@] {%{public}@} active-set-job set-descriptor yet no set-configuration | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@";
                        goto LABEL_55;
                      }
                    }

LABEL_56:

                    [v15 addObject:v20];
                    goto LABEL_57;
                  }

                  v46 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                  {
                    v47 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
                    *buf = 138543874;
                    v116 = v47;
                    v117 = 2114;
                    v118 = v106;
                    v119 = 2114;
                    v120 = v20;
                    v48 = v46;
                    v49 = OS_LOG_TYPE_DEFAULT;
                    v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without discoveredAtomicEntries | entryID:%{public}@";
LABEL_39:
                    _os_log_impl(&dword_0, v48, v49, v50, buf, 0x20u);

                    v15 = v99;
                  }
                }

                else
                {
                  v46 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                  {
                    v47 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
                    *buf = 138543874;
                    v116 = v47;
                    v117 = 2114;
                    v118 = v106;
                    v119 = 2114;
                    v120 = v20;
                    v48 = v46;
                    v49 = OS_LOG_TYPE_DEFAULT;
                    v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without discoveredAtomicInstance | entryID:%{public}@";
                    goto LABEL_39;
                  }
                }
              }

              else
              {
                v46 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                {
                  v47 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
                  *buf = 138543874;
                  v116 = v47;
                  v117 = 2114;
                  v118 = v106;
                  v119 = 2114;
                  v120 = v20;
                  v48 = v46;
                  v49 = OS_LOG_TYPE_DEFAULT;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without assetSetIdentifier | entryID:%{public}@";
                  goto LABEL_39;
                }
              }
            }

            else
            {
              v46 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
              {
                v47 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
                *buf = 138543874;
                v116 = v47;
                v117 = 2114;
                v118 = v106;
                v119 = 2114;
                v120 = v20;
                v48 = v46;
                v49 = OS_LOG_TYPE_ERROR;
                v50 = "[%{public}@] {%{public}@} unable to load auto-asset-set-descriptor | entryID:%{public}@";
                goto LABEL_39;
              }
            }

            [v15 addObject:v20];
            goto LABEL_41;
          }
        }

        v42 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
        {
          v43 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
          v44 = v43;
          *buf = 138543874;
          v45 = @"N";
          if (v20)
          {
            v45 = v20;
          }

          v116 = v43;
          v117 = 2114;
          v118 = v7;
          v119 = 2114;
          v120 = v45;
          _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
        }

        if (v20)
        {
          [v15 addObject:v20];
        }

LABEL_42:
        objc_autoreleasePoolPop(v21);
        v19 = v19 + 1;
      }

      while (v17 != v19);
      v61 = [obj countByEnumeratingWithState:&v111 objects:v126 count:16];
      v17 = v61;
      if (!v61)
      {
LABEL_67:

        v63 = [v15 count];
        if (v88)
        {
          v64 = v63;
          v14 = v87;
          if (v63 >= 1)
          {
            v65 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
            {
              v66 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
              v67 = @"s";
              *buf = 138544130;
              v116 = v66;
              v117 = 2114;
              if (v64 == &dword_0 + 1)
              {
                v67 = &stru_4BD3F0;
              }

              v118 = v7;
              v119 = 2048;
              v120 = v64;
              v121 = 2114;
              v122 = v67;
              _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} discovered %ld potentially stale active-set-job%{public}@ (when before first unlock) | waiting to be beyond first-unlock before clearing", buf, 0x2Au);
            }

            goto LABEL_86;
          }
        }

        else
        {
          v109 = 0u;
          v110 = 0u;
          v107 = 0u;
          v108 = 0u;
          v65 = v15;
          obja = [v65 countByEnumeratingWithState:&v107 objects:v125 count:16];
          if (obja)
          {
            v103 = *v108;
            v101 = v65;
            do
            {
              for (i = 0; i != obja; i = i + 1)
              {
                if (*v108 != v103)
                {
                  objc_enumerationMutation(v101);
                }

                v69 = *(*(&v107 + 1) + 8 * i);
                v70 = objc_autoreleasePoolPush();
                if (v69)
                {
                  v71 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
                  v72 = [v71 persistedEntry:v69 fromLocation:v106];

                  v73 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
                  v74 = [v73 decodeFromLocation:@"resumeSetJobsWhenBeforeFirstUnlock" ofEntryName:v69 fromPersistedEntry:v72 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                  if (v74)
                  {
                    v75 = [(MADAutoAssetControlManager *)v4 persistedActiveJobSetDescriptors];
                    [v75 removePersistedEntry:v69 fromLocation:@"resumeSetJobsWhenBeforeFirstUnlock"];

                    [(MADAutoAssetControlManager *)v4 _logPersistedSetDescriptorRemoved:v106 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v69 removedSetDescriptor:v74 message:@"removing stale active-persisted set-job"];
                  }
                }

                else
                {
                  v72 = [(MADAutoAssetControlManager *)v4 autoControlManagerFSM];
                  v74 = [v72 diag];
                  v76 = [NSString alloc];
                  v77 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
                  v78 = [v76 initWithFormat:@"{%@} nil entryID encountered on staleActivePersistedEntryIDs | %@", v106, v77];
                  [v74 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v78 withResult:6108 withError:0];
                }

                objc_autoreleasePoolPop(v70);
              }

              v65 = v101;
              obja = [v101 countByEnumeratingWithState:&v107 objects:v125 count:16];
            }

            while (obja);
            v7 = v106;
          }

          v14 = v87;
          v15 = v99;
LABEL_86:
        }

        v62 = _MADLog(@"AutoControl");
        v79 = os_log_type_enabled(v62, OS_LOG_TYPE_DEFAULT);
        if (v89 < 1)
        {
          if (v79)
          {
            v80 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
            v86 = @"now active";
            *buf = 138543874;
            v116 = v80;
            v117 = 2114;
            if (v88)
            {
              v86 = @"before first-unlock";
            }

            v118 = v7;
            v119 = 2114;
            v120 = v86;
            v83 = "[%{public}@] {%{public}@} no set-jobs resumed (%{public}@) | MA_MILESTONE";
            v84 = v62;
            v85 = 32;
LABEL_98:
            _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, v83, buf, v85);
          }
        }

        else if (v79)
        {
          v80 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
          v81 = @"s";
          *buf = 138544386;
          v116 = v80;
          if (v89 == 1)
          {
            v81 = &stru_4BD3F0;
          }

          v82 = @"now active";
          v119 = 2048;
          v120 = v89;
          v117 = 2114;
          v118 = v7;
          v121 = 2114;
          if (v88)
          {
            v82 = @"before first-unlock";
          }

          v122 = v81;
          v123 = 2114;
          v124 = v82;
          v83 = "[%{public}@] {%{public}@} resumed %ld set-job%{public}@ (%{public}@) | MA_MILESTONE";
          v84 = v62;
          v85 = 52;
          goto LABEL_98;
        }

LABEL_99:

        goto LABEL_100;
      }
    }
  }

  v15 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
  {
    v62 = [(MADAutoAssetControlManager *)v4 _updateLatestSummary];
    *buf = 138543618;
    v116 = v62;
    v117 = 2114;
    v118 = v7;
    _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no persisted auto-asset-set-jobs to be resumed | MA_MILESTONE", buf, 0x16u);
    goto LABEL_99;
  }

LABEL_100:

  [(MADAutoAssetControlManager *)v4 _logPersistedTableOfContents:v7 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS"];
LABEL_101:
}

- (void)_moveFromAwaitingResumedInto:(id)a3 forSelector:(id)a4
{
  v22 = a3;
  v21 = a4;
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v7 = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(v7);

  v8 = objc_alloc_init(NSMutableArray);
  v24 = 0u;
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v9 = self;
  obj = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v10 = [obj countByEnumeratingWithState:&v24 objects:v28 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v25;
    do
    {
      v13 = 0;
      do
      {
        if (*v25 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v24 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        if (v14)
        {
          v16 = [v14 autoAssetJobID];
          v17 = [(MADAutoAssetControlManager *)v9 currentJobByUUID:v16 fromLocation:@"_moveFromAwaitingResumedInto" notFoundCode:0 notFoundReason:0];

          v18 = v8;
          if (v17)
          {
            v19 = [v17 autoAssetSelector];
            v20 = [v19 isEqual:v21];

            if (v20)
            {
              v18 = v22;
            }

            else
            {
              v18 = v8;
            }
          }

          [v18 addObject:v14];
        }

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v24 objects:v28 count:16];
    }

    while (v11);
  }

  [(MADAutoAssetControlManager *)v9 setDownloadManagerEventsAwaitingResumed:v8];
}

- (BOOL)_inDownloadsInFlight:(id)a3
{
  v20 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v6 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v7 = [v6 countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v22;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v22 != v9)
        {
          objc_enumerationMutation(v6);
        }

        v11 = *(*(&v21 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        if (v11)
        {
          if ([v11 containsString:v20])
          {
            objc_autoreleasePoolPop(v12);
            v18 = 1;
            goto LABEL_13;
          }
        }

        else
        {
          v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v14 = [v13 diag];
          v15 = [NSString alloc];
          v16 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v17 = [v15 initWithFormat:@"{_inDownloadsInFlight} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", v16];
          [v14 trackAnomaly:@"AUTO-CONTROL" forReason:v17 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v12);
      }

      v8 = [v6 countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v8);
  }

  v18 = 0;
LABEL_13:

  return v18;
}

- (BOOL)_inMatchedTaskDescriptors:(id)a3 addingMatchingJobUUID:(id)a4
{
  v6 = a3;
  v25 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  v9 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v10 = [v9 countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v10)
  {
    v11 = v10;
    v24 = v6;
    v12 = *v27;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v27 != v12)
        {
          objc_enumerationMutation(v9);
        }

        v14 = *(*(&v26 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        if (v14)
        {
          if ([v14 containsString:v25])
          {
            v6 = v24;
            v22 = [(MADAutoAssetControlManager *)self _taskDescriptorEncountered:v14 inMatchedDescriptors:v24];
            v21 = v22;
            if ((v22 & 1) == 0)
            {
              [v24 addObject:v14];
            }

            objc_autoreleasePoolPop(v15);
            goto LABEL_17;
          }
        }

        else
        {
          v16 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v17 = [v16 diag];
          v18 = [NSString alloc];
          v19 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v20 = [v18 initWithFormat:@"{_inMatchedTaskDescriptors} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", v19];
          [v17 trackAnomaly:@"AUTO-CONTROL" forReason:v20 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [v9 countByEnumeratingWithState:&v26 objects:v30 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }

    v21 = 0;
    v6 = v24;
  }

  else
  {
    v21 = 0;
  }

LABEL_17:

  return v21;
}

- (BOOL)_taskDescriptorEncountered:(id)a3 inMatchedDescriptors:(id)a4
{
  v5 = a3;
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  v6 = a4;
  v7 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v7)
  {
    v8 = *v12;
    while (2)
    {
      for (i = 0; i != v7; i = i + 1)
      {
        if (*v12 != v8)
        {
          objc_enumerationMutation(v6);
        }

        if (([SUCore stringIsEqual:v5 to:*(*(&v11 + 1) + 8 * i), v11]& 1) != 0)
        {
          LOBYTE(v7) = 1;
          goto LABEL_11;
        }
      }

      v7 = [v6 countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v7)
      {
        continue;
      }

      break;
    }
  }

LABEL_11:

  return v7;
}

- (id)_newTrimmedToAutoAssetsInFlight:(id)a3
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = objc_alloc_init(NSMutableArray);
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  v7 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    do
    {
      v11 = 0;
      do
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v14 + 1) + 8 * v11);
        if (v12 && [*(*(&v14 + 1) + 8 * v11) containsString:@".auto."])
        {
          [v6 addObject:v12];
        }

        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v9);
  }

  if (![v6 count])
  {

    return 0;
  }

  return v6;
}

- (void)_removeJobFromDownloadsInFlight:(id)a3
{
  v12 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v7 = [v6 count];

  if (v7 >= 1)
  {
    v8 = 0;
    while (1)
    {
      v9 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
      v10 = [v9 objectAtIndex:v8];

      if (v10)
      {
        if ([v10 containsString:v12])
        {
          break;
        }
      }

      if (v7 == ++v8)
      {
        goto LABEL_8;
      }
    }

    v11 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
    [v11 removeObjectAtIndex:v8];
  }

LABEL_8:
}

- (id)jobControlInformationForSelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self simulateOperationsBySelector];
  v8 = [v4 persistedEntryID];
  v9 = [v7 safeObjectForKey:v8 ofClass:objc_opt_class()];

  if (v9)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v12 = [v4 summary];
      v13 = [v9 summary];
      v24 = 138543874;
      v25 = v11;
      v26 = 2114;
      v27 = v12;
      v28 = 2114;
      v29 = v13;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSelector} SIMULATE | found control information | assetSelector:%{public}@ | associatedControlInfo:%{public}@", &v24, 0x20u);
    }
  }

  else
  {
    v9 = [v4 assetVersion];

    if (!v9)
    {
      goto LABEL_10;
    }

    v14 = [MAAutoAssetSelector alloc];
    v15 = [v4 assetType];
    v16 = [v4 assetSpecifier];
    v10 = [v14 initForAssetType:v15 withAssetSpecifier:v16];

    v17 = [(MADAutoAssetControlManager *)self simulateOperationsBySelector];
    v18 = [v10 persistedEntryID];
    v9 = [v17 safeObjectForKey:v18 ofClass:objc_opt_class()];

    if (v9)
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v21 = [v10 summary];
        v22 = [v9 summary];
        v24 = 138543874;
        v25 = v20;
        v26 = 2114;
        v27 = v21;
        v28 = 2114;
        v29 = v22;
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSelector} SIMULATE(wildcarded) | found control information | assetSelector:%{public}@ | associatedControlInfo:%{public}@", &v24, 0x20u);
      }
    }
  }

LABEL_10:

  return v9;
}

- (id)jobControlInformationForSetJobKey:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self simulateOperationsBySetJobKey];
  v8 = [v7 safeObjectForKey:v4 ofClass:objc_opt_class()];

  if (v8)
  {
    v9 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v11 = [v8 summary];
      v13 = 138543874;
      v14 = v10;
      v15 = 2114;
      v16 = v4;
      v17 = 2114;
      v18 = v11;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSetJobKey} SIMULATE | found control information | setJobKey:%{public}@ | associatedControlInfo:%{public}@", &v13, 0x20u);
    }
  }

  return v8;
}

- (id)jobControlInformationForSetConfiguration:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  v8 = [v4 assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v7 forAssetSetIdentifier:v8];

  v10 = [(MADAutoAssetControlManager *)self simulateOperationsBySetJobKey];
  v11 = [v10 safeObjectForKey:v9 ofClass:objc_opt_class()];

  if (v11)
  {
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v14 = [v4 summary];
      v15 = [v11 summary];
      v17 = 138543874;
      v18 = v13;
      v19 = 2114;
      v20 = v14;
      v21 = 2114;
      v22 = v15;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSetJobKey} SIMULATE | found control information | setConfiguration:%{public}@ | associatedControlInfo:%{public}@", &v17, 0x20u);
    }
  }

  return v11;
}

- (void)_removeFromPersistedActiveJobs:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v8 = [v7 persistedEntryIDs:@"_removeFromPersistedActiveJobs"];

  if ([v8 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeFromPersistedActiveJobs" ofContainer:@"persistedActiveJobs"];
    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    v33 = v8;
    obj = v8;
    v37 = [obj countByEnumeratingWithState:&v38 objects:v46 count:16];
    if (!v37)
    {
      goto LABEL_30;
    }

    v36 = *v39;
    v34 = v4;
    while (1)
    {
      v9 = 0;
      do
      {
        if (*v39 != v36)
        {
          objc_enumerationMutation(obj);
        }

        v10 = *(*(&v38 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        v12 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
        v13 = [v12 persistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

        if (v13)
        {
          v14 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          v15 = [v14 decodeFromLocation:@"_removeFromPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          v16 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          v17 = [v16 decodeFromLocation:@"_removeFromPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetSelector" ofClass:objc_opt_class() allowingNilObject:0];

          if (v15)
          {
            if (![v15 isBlankEntry])
            {
              v24 = [v15 assetType];
              v25 = [SUCore stringIsEqual:v24 to:v4];

              if (v25)
              {
                if (v17)
                {
                  v26 = [v17 persistedEntryID];
                  v27 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
                  v28 = [v27 safeObjectForKey:v26 ofClass:objc_opt_class()];

                  if (v28)
                  {
                    v29 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
                    [v29 removeObjectForKey:v26];
                  }

                  v4 = v34;
                }

                else
                {
                  v26 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
                  {
                    v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v43 = v30;
                    v44 = 2114;
                    v45 = v10;
                    _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeFromPersistedActiveJobs} unable to load auto-asset-selector | entryID:%{public}@", buf, 0x16u);
                  }
                }

                v31 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                [v31 removePersistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

                [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_removeFromPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v10 removedDescriptor:v15 message:@"removed auto-asset-descriptor for previously active job"];
              }

              goto LABEL_18;
            }

            v18 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            [v18 removePersistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_removeFromPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v10 removedDescriptor:v15 message:@"removed blank auto-asset-descriptor"];
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
            {
              v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v43 = v20;
              v44 = 2114;
              v45 = v10;
              v21 = v19;
              v22 = OS_LOG_TYPE_DEFAULT;
              v23 = "[%{public}@] {_removeFromPersistedActiveJobs} removed blank auto-asset-descriptor | entryID:%{public}@";
              goto LABEL_16;
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v43 = v20;
              v44 = 2114;
              v45 = v10;
              v21 = v19;
              v22 = OS_LOG_TYPE_ERROR;
              v23 = "[%{public}@] {_removeFromPersistedActiveJobs} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
              _os_log_impl(&dword_0, v21, v22, v23, buf, 0x16u);
            }
          }

          goto LABEL_18;
        }

        v15 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_19;
        }

        v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v43 = v17;
        v44 = 2114;
        v45 = v10;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeFromPersistedActiveJobs} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
LABEL_18:

LABEL_19:
        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v37 != v9);
      v32 = [obj countByEnumeratingWithState:&v38 objects:v46 count:16];
      v37 = v32;
      if (!v32)
      {
LABEL_30:

        v8 = v33;
        break;
      }
    }
  }
}

- (void)_scheduleSelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    v7 = [(MADAutoAssetControlManager *)self _updatePolicyForSelector:v4];
    v8 = [v4 persistedEntryID];
    v9 = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
    [v9 setSafeObject:v4 forKey:v8];

    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v12 = [v4 summary];
      v13 = [v7 summary];
      v14 = 138543874;
      v15 = v11;
      v16 = 2114;
      v17 = v12;
      v18 = 2114;
      v19 = v13;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSelector} scheduling selector | autoAssetSelector:%{public}@, autoUpdatePolicy:%{public}@", &v14, 0x20u);
    }

    +[MADAutoAssetScheduler scheduleSelector:triggeringAtIntervalSecs:](MADAutoAssetScheduler, "scheduleSelector:triggeringAtIntervalSecs:", v4, [v7 checkForNewerIntervalSecs]);
  }
}

- (void)_scheduleSetConfiguration:(id)a3 withClientSetPolicy:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    v10 = [v6 autoAssetEntries];
    v11 = [v10 count];

    v12 = _MADLog(@"AutoControl");
    v13 = os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT);
    if (v11)
    {
      if (v13)
      {
        v14 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v15 = [v6 summary];
        if (v7)
        {
          v16 = [v7 summary];
        }

        else
        {
          v16 = @"N";
        }

        v26 = 138543874;
        v27 = v14;
        v28 = 2114;
        v29 = v15;
        v30 = 2114;
        v31 = v16;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSetConfiguration} scheduling set-configuration | setConfiguration:%{public}@ | setUpdatePolicy:%{public}@", &v26, 0x20u);
        if (v7)
        {
        }
      }

      v22 = [v6 clientDomainName];
      v23 = [v6 assetSetIdentifier];
      [MADAutoAssetScheduler scheduleSetDomainName:v22 forAssetSetIdentifier:v23 usingSetUpdatePolicy:v7 forSetConfiguration:v6];
    }

    else
    {
      if (v13)
      {
        v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v18 = [v6 summary];
        v26 = 138543618;
        v27 = v17;
        v28 = 2114;
        v29 = v18;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSetConfiguration} removing any scheduling of set-identifier (no auto-asset-entries) | setConfiguration:%{public}@", &v26, 0x16u);
      }

      v19 = [v6 clientDomainName];
      if (!v19 || (v20 = v19, [v6 assetSetIdentifier], v21 = objc_claimAutoreleasedReturnValue(), v21, v20, !v21))
      {
        v22 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
        {
          v24 = [v6 clientDomainName];
          v25 = [v6 assetSetIdentifier];
          v26 = 138543618;
          v27 = v24;
          v28 = 2114;
          v29 = v25;
          _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{_scheduleSetConfiguration} nil client domain name or asset set identifier, will not proceed with eliminate! | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v26, 0x16u);
        }

        goto LABEL_19;
      }

      v22 = [v6 clientDomainName];
      v23 = [v6 assetSetIdentifier];
      [MADAutoAssetScheduler controlEliminateSetDomainName:v22 forAssetSetIdentifier:v23 indicatingWhenEliminated:0];
    }

LABEL_19:
  }
}

- (void)_schedulePushNotifications:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    v8 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v9 = [v4 safeSummary];
    v10 = 138543618;
    v11 = v8;
    v12 = 2114;
    v13 = v9;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:_schedulePushNotifications} scheduling pushes | pushNotificationsBySelector:%{public}@", &v10, 0x16u);
  }

  [MADAutoAssetScheduler schedulePushNotifications:v4];
}

- (BOOL)_haveSetAssetEntriesForSchedulerTriggered:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 clientDomainName];
  if (v7)
  {
    v8 = v7;
    v9 = [v4 assetSetIdentifier];

    if (v9)
    {
      v10 = [v4 clientDomainName];
      v11 = [v4 assetSetIdentifier];
      v12 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v10 forAssetSetIdentifier:v11];

      if (v12)
      {
        v13 = [v12 autoAssetEntries];
        v14 = [v13 count];

        if (v14)
        {
          LOBYTE(v9) = 1;
LABEL_13:

          goto LABEL_14;
        }

        v9 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v16 = [v4 summary];
          v17 = [v12 summary];
          v19 = 138543874;
          v20 = v15;
          v21 = 2114;
          v22 = v16;
          v23 = 2112;
          v24 = v17;
          _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_haveSetAssetEntriesForSchedulerTriggered} empty set-configuration | schedulerTriggered:%{public}@ | setConfiguration:%@", &v19, 0x20u);

          goto LABEL_11;
        }
      }

      else
      {
        v9 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
        {
          v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v16 = [v4 summary];
          v19 = 138543618;
          v20 = v15;
          v21 = 2114;
          v22 = v16;
          _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_haveSetAssetEntriesForSchedulerTriggered} no set-configuration | schedulerTriggered:%{public}@", &v19, 0x16u);
LABEL_11:
        }
      }

      LOBYTE(v9) = 0;
      goto LABEL_13;
    }
  }

  else
  {
    LOBYTE(v9) = 0;
  }

LABEL_14:

  return v9;
}

- (void)_schedulerTickOccurred
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  [(MADAutoAssetControlManager *)self setConfigurationTickForPreviouslyVended];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

+ (id)stagerSetPolicy
{
  if (stagerSetPolicy_dispatchOnceStagerSetPolicy != -1)
  {
    +[MADAutoAssetControlManager stagerSetPolicy];
  }

  v3 = stagerSetPolicy___stagerSetPolicy;

  return v3;
}

void __45__MADAutoAssetControlManager_stagerSetPolicy__block_invoke(id a1)
{
  v1 = objc_alloc_init(MANAutoAssetSetPolicy);
  v2 = stagerSetPolicy___stagerSetPolicy;
  stagerSetPolicy___stagerSetPolicy = v1;

  [stagerSetPolicy___stagerSetPolicy setUserInitiated:1];
  [stagerSetPolicy___stagerSetPolicy setLockInhibitsEmergencyRemoval:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOnBattery:1];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadWhenBatteryLow:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadWhenCPUHigh:1];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOverExpensive:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOverCellular:1];
  [stagerSetPolicy___stagerSetPolicy setBlockCheckDownload:0];
  v3 = _MADLog(@"Auto");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    v4 = [stagerSetPolicy___stagerSetPolicy summary];
    v5 = 138543362;
    v6 = v4;
    _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initialized the fixed stager-set-policy | stagerSetPolicy:%{public}@", &v5, 0xCu);
  }
}

- (void)removePreviouslyStagedSetDescriptors
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v31 = objc_alloc_init(NSMutableArray);
  v5 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"removePreviouslyStagedSetDescriptors" ofContainer:@"setDescriptorWalkKeys"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  obj = v5;
  v6 = [obj countByEnumeratingWithState:&v37 objects:v46 count:16];
  if (v6)
  {
    v8 = v6;
    v9 = *v38;
    *&v7 = 138412546;
    v30 = v7;
    do
    {
      v10 = 0;
      do
      {
        if (*v38 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v37 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        v13 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v14 = [v13 safeObjectForKey:v11 ofClass:objc_opt_class()];

        if (!v14 || ([v14 clientDomainName], v15 = objc_claimAutoreleasedReturnValue(), v16 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v15, @"FROM_STAGED_FOR_ALL"), v15, v16))
        {
          v17 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"removePreviouslyStagedSetDescriptors" forKey:v11, v30];
          v18 = v17;
          if (v17)
          {
            v19 = [v17 clientDomainName];
            v20 = [SUCore stringIsEqual:v19 to:@"FROM_STAGED_FOR_ALL"];

            if ((v20 & 1) == 0)
            {
              v21 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_FAULT))
              {
                v22 = [v18 summary];
                *buf = v30;
                v43 = @"removePreviouslyStagedSetDescriptors";
                v44 = 2112;
                v45 = v22;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_FAULT, "{%@} unexpected inconsistency for nextDownloadedSetDescriptor expected in staging | nextDownloadedSetDescriptor:%@", buf, 0x16u);
              }
            }

            [v31 addObject:v18];
          }
        }

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v8 != v10);
      v8 = [obj countByEnumeratingWithState:&v37 objects:v46 count:16];
    }

    while (v8);
  }

  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  v23 = v31;
  v24 = [v23 countByEnumeratingWithState:&v33 objects:v41 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v34;
    do
    {
      v27 = 0;
      do
      {
        if (*v34 != v26)
        {
          objc_enumerationMutation(v23);
        }

        v28 = *(*(&v33 + 1) + 8 * v27);
        v29 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v28 fromLocation:@"removePreviouslyStagedSetDescriptors" checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:331 historyOperationSD:375];
        objc_autoreleasePoolPop(v29);
        v27 = v27 + 1;
      }

      while (v25 != v27);
      v25 = [v23 countByEnumeratingWithState:&v33 objects:v41 count:16];
    }

    while (v25);
  }
}

- (void)_stagedNewOSPromoteAdoptSetTargets
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self locateNewAllSetTargets];
  v6 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [v6 removeAllPersistedEntries:@"auto-asset-stager has indicated new-OS-promotion - all set-targets were from previous OS viewpoint so no longer applicable"];

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v7 = v5;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    do
    {
      v11 = 0;
      do
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v14 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self modifySetConfiguration:@"_stagedNewOSPromoteAdoptSetTargets" toEntriesFromSetTarget:v12, v14];
        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v9);
  }
}

- (void)modifySetConfiguration:(id)a3 toEntriesFromSetTarget:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:modifySetConfiguration", v7];
  v11 = [v6 clientDomainName];
  v12 = [v6 assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v11 forAssetSetIdentifier:v12];

  if (!v13)
  {
    v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v17 = [v15 diag];
    v31 = [NSString alloc];
    v32 = [v6 summary];
    v33 = [v31 initWithFormat:@"{%@} no set-configuration for set-target | setTarget:%@", v10, v32];
    [v17 trackAnomaly:@"AUTO-CONTROL" forReason:v33 withResult:6103 withError:0];

    goto LABEL_15;
  }

  v14 = [(MADAutoAssetControlManager *)self bootedOSVersion];
  v15 = [MADAutoAssetControlManager restoreVersionFromOSVersion:v14];

  v16 = [v6 minTargetOSVersion];
  v17 = [MADAutoAssetControlManager restoreVersionFromOSVersion:v16];

  v18 = [v6 maxTargetOSVersion];
  v19 = [MADAutoAssetControlManager restoreVersionFromOSVersion:v18];

  if (![v17 isComparable:v15] || !objc_msgSend(v19, "isComparable:", v15))
  {
    v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v25 = [v24 diag];
    v28 = [NSString alloc];
    v29 = [v6 summary];
    v30 = [v28 initWithFormat:@"{%@} set-target versions not comparable (ignoring) | setTarget:%@", v10, v29];
    [v25 trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6103 withError:0];

LABEL_11:
    goto LABEL_12;
  }

  v20 = [v17 compare:v15];
  v21 = [v19 compare:v15];
  if (v20 == &dword_0 + 1 || v21 == -1)
  {
    v24 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_12;
    }

    v25 = [v6 summary];
    v26 = [v13 summary];
    *buf = 138543874;
    v79 = v10;
    v80 = 2114;
    v81 = v25;
    v82 = 2114;
    v83 = v26;
    v27 = "{%{public}@} | set-target out-of-range | setTarget:%{public}@ | setConfiguration:%{public}@";
    goto LABEL_18;
  }

  v22 = [v6 autoAssetEntries];
  v23 = [v22 count];

  if (!v23)
  {
    v34 = [v13 clientDomainName];
    v35 = [v13 assetSetIdentifier];
    [(MADAutoAssetControlManager *)self _eliminateAtomicTriggeredWhileLoading:v10 forClientDomainName:v34 forAssetSetIdentifier:v35];

    goto LABEL_13;
  }

  if (![(MADAutoAssetControlManager *)self setTargetEntries:v6 matchSetConfiguration:v13])
  {
    v76 = [MADAutoSetConfiguration alloc];
    v74 = [v13 clientDomainName];
    v72 = [v13 autoAssetSetClientName];
    v70 = [v13 assetSetIdentifier];
    v69 = [v6 autoAssetEntries];
    v67 = [v13 discoveredInFlightAtomicInstance];
    v64 = [v13 newerAtomicInstanceOncePersonalized];
    v68 = [v13 latestAtomicInstanceToVend];
    v57 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v65 = [v13 previouslyVendedLockedAtomicInstances];
    v56 = [v13 ticksUntilPreviousForceUnlocked];
    v66 = [v13 mostRecentlyReceivedCachedAssetSetID];
    v63 = [v13 mostRecentlyReceivedDownloadedFromLive];
    v62 = [v13 mostRecentlyReceivedLastTimeChecked];
    v61 = [v13 mostRecentlyReceivedPostedDate];
    v60 = [v13 latestToVendCachedAssetSetID];
    v59 = [v13 latestToVendDownloadedFromLive];
    v58 = [v13 latestToVendLastTimeChecked];
    v55 = [v13 latestToVendPostedDate];
    v54 = [v13 availableForUseError];
    v53 = [v13 newerVersionError];
    v52 = [v13 everProvidedLatestToVend];
    v51 = [v13 inhibitImpliedScheduling];
    v36 = [v13 haveReceivedLookupResponse];
    BYTE3(v50) = [v13 vendingAtomicInstanceForConfiguredEntries];
    BYTE2(v50) = v36;
    BYTE1(v50) = v51;
    LOBYTE(v50) = v52;
    LOBYTE(v49) = v57;
    v77 = [MADAutoSetConfiguration initForClientDomainName:v76 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:v74 withAutoAssetEntries:v72 withDiscoveredInFlightAtomicInstance:v70 withNewerAtomicInstanceOncePersonalized:v69 withLatestAtomicInstanceToVend:v67 withLatestAtomicInstanceToVendFromPreSUStaging:v64 withPreviouslyVendedLockedAtomicInstances:v68 withTicksUntilPreviousForceUnlocked:v49 withMostRecentlyReceivedCachedAssetSetID:v65 withMostRecentlyReceivedDownloadedFromLive:v56 withMostRecentlyReceivedLastTimeChecked:v66 withMostRecentlyReceivedPostedDate:v63 withLatestToVendCachedAssetSetID:v62 withLatestToVendDownloadedFromLive:v61 withLatestToVendLastTimeChecked:v60 withLatestToVendPostedDate:v59 withAavailableForUseError:v58 withNewerVersionError:v55 havingEverProvidedLatestToVend:v54 inhibitingImpliedScheduling:v53 havingReceivedLookupResponse:v50 vendingAtomicInstanceForConfiguredEntries:?];

    v37 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v77];
    v38 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
    v75 = v37;
    v39 = [v38 persistedEntry:v37 fromLocation:v10];

    v40 = v39;
    if (v39)
    {
      [v39 persistSecureCodedObject:v77 forKey:@"setConfiguration"];
      [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v41 = v73 = v39;
      v42 = [v77 summary];
      [v41 storePersistedEntry:v75 withEntrySummary:v42 fromLocation:v10];

      v43 = [NSString alloc];
      v71 = [v13 summary];
      v44 = [v6 summary];
      v45 = [v43 initWithFormat:@"{%@} altered set-configuration auto-asset-entries to align with set-target | setConfiguration:%@ | setTarget:%@", v10, v71, v44];
      v46 = v75;
      [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:v10 operation:@"ENTRY_MODIFY" forPersistedEntryID:v75 withSetConfiguration:v77 historyOperation:447 message:v45];

      v47 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      v40 = v73;
      [v47 setSafeObject:v77 forKey:v75];
    }

    else
    {
      v46 = v75;
      v47 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
      {
        v48 = [v6 summary];
        *buf = 138543618;
        v79 = v10;
        v80 = 2114;
        v81 = v48;
        _os_log_impl(&dword_0, v47, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to load persisted-set-configuration file | set-target:%{public}@", buf, 0x16u);

        v40 = 0;
      }
    }

    goto LABEL_13;
  }

  v24 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
  {
    v25 = [v6 summary];
    v26 = [v13 summary];
    *buf = 138543874;
    v79 = v10;
    v80 = 2114;
    v81 = v25;
    v82 = 2114;
    v83 = v26;
    v27 = "{%{public}@} | set-target entry matches set-configuration | setTarget:%{public}@ | setConfiguration:%{public}@";
LABEL_18:
    _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, v27, buf, 0x20u);

    goto LABEL_11;
  }

LABEL_12:

LABEL_13:
LABEL_15:
}

- (void)promoteAnyPreviouslyStagedNowDownloaded:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"promoteAnyPreviouslyStagedNowDownloaded" ofContainer:@"promotedFromStagedToDownloaded"];
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v7 = v4;
    v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v15;
      do
      {
        v11 = 0;
        do
        {
          if (*v15 != v10)
          {
            objc_enumerationMutation(v7);
          }

          v12 = *(*(&v14 + 1) + 8 * v11);
          v13 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)self _promotePreviouslyStagedNowDownloaded:v12 forHistoryOperation:205, v14];
          objc_autoreleasePoolPop(v13);
          v11 = v11 + 1;
        }

        while (v9 != v11);
        v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      }

      while (v9);
    }
  }
}

- (void)_promotePreviouslyStagedNowDownloaded:(id)a3 forHistoryOperation:(int64_t)a4
{
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  [v6 setIsOnFilesystem:1];
  v9 = [(MADAutoAssetControlManager *)self setConfigurationForDescriptorIfManagedAsSet:v6];

  if (v9)
  {
    [v6 setFoundByLookupWithoutAssetVersion:1];
  }

  if ([(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:v6])
  {
    if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"PROMOTE-PREVIOUSLY-STAGED" forDescriptor:v6])
    {
      [MADAutoAssetSecure isPersonalizationRequired:@"PROMOTE-PREVIOUSLY-STAGED" forDescriptor:v6];
    }

    v10 = [MAAutoAssetSelector alloc];
    v11 = [v6 assetType];
    v12 = [v6 assetSpecifier];
    v13 = [v6 assetVersion];
    v48 = [v10 initForAssetType:v11 withAssetSpecifier:v12 matchingAssetVersion:v13];

    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      v15 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v16 = [v6 summary];
      *buf = 138543618;
      v50 = v15;
      v51 = 2114;
      v52 = v16;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_promotePreviouslyStagedNowDownloaded} content on filesystem validated for promoted | descriptor:%{public}@", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)self _statsIncrementPromotedForDescriptor:v6];
    LOBYTE(v36) = 1;
    [(MADAutoAssetControlManager *)self trackDescriptor:v6 persisting:1 fromLocation:@"_promotePreviouslyStagedNowDownloaded" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:a4 firstClientName:0 isPromoted:v36];
    v17 = objc_alloc_init(MAAutoAssetNotifications);
    [v17 setContentAvailableForUse:1];
    v45 = [v6 metadata];
    v44 = [v6 neverBeenLocked];
    v43 = [v6 downloadUserInitiated];
    v46 = [v6 downloadedNetworkBytes];
    v42 = [v6 downloadedFilesystemBytes];
    v41 = [v6 isPatch];
    v18 = [v6 patchedFromBaseSelector];
    v19 = [v6 patchedFromBaseFilesystemBytes];
    v20 = [v6 patchingAttempted];
    v21 = [v6 stagedPriorToAvailable];
    v22 = [v6 stagedFromOSVersion];
    v23 = [v6 stagedFromBuildVersion];
    v24 = [v6 patchingAttemptError];
    LOBYTE(v40) = 0;
    BYTE1(v39) = v21;
    LOBYTE(v39) = v20;
    LOBYTE(v38) = v41;
    v37 = v46;
    v25 = v48;
    v47 = v17;
    v26 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v48 withNotifications:v17 withAvailableForUseAttributes:v45 withNewerVersionAttributes:0 withNeverBeenLocked:v44 withDownloadUserInitiated:v43 withDownloadProgress:0 withDownloadedNetworkBytes:v37 withDownloadedFilesystemBytes:v42 withDownloadedAsPatch:v38 withPatchedFromBaseSelector:v18 withPatchedFromBaseFilesystemBytes:v19 withPatchingAttempted:v39 withStagedPriorToAvailable:v22 withStagedFromOSVersion:v23 withStagedFromBuildVersion:v40 extendingWithCurrentLockUsage:0 withAvailableForUseError:v24 withPatchingAttemptError:0 withNewerVersionError:?];

    v27 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
    v28 = [(MADAutoAssetControlManager *)self jobSelectorKey:v48];
    [v27 setSafeObject:v26 forKey:v28];

    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v31 = [v26 summary];
      *buf = 138543618;
      v50 = v30;
      v51 = 2114;
      v52 = v31;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][PROMOTED] | currentStatus:%{public}@ | jobUUID:N", buf, 0x16u);
    }

    v32 = [v6 assetType];
    v33 = [v6 assetSpecifier];
    [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_DOWNLOADED" forAssetType:v32 forAssetSpecifier:v33 fromModule:@"STAGER" fromLocation:@"_promotePreviouslyStagedNowDownloaded"];
  }

  else
  {
    [v6 setIsOnFilesystem:0];
    v25 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
    {
      v34 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v35 = [v6 summary];
      *buf = 138543618;
      v50 = v34;
      v51 = 2114;
      v52 = v35;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[%{public}@] {_promotePreviouslyStagedNowDownloaded} attempted to promote but not on filesystem | descriptor:%{public}@", buf, 0x16u);
    }
  }
}

+ (id)selectDispatchQueue:(id)a3
{
  v3 = a3;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = v3;
  v6 = v5;
  if (!v5)
  {
    v6 = [v4 sharedDispatchQueue];
  }

  return v6;
}

+ (id)allocIntervalString:(int64_t)a3
{
  if (a3 < 1)
  {
    return @"DISABLED";
  }

  v4 = a3 / 0x15180uLL;
  v5 = (a3 % 0x15180uLL) / 3600;
  v6 = (a3 % 0x15180uLL) % 3600;
  v7 = v6 / 60;
  v8 = v6 % 60;
  v9 = [NSString alloc];
  if (a3 >> 7 < 0x2A3)
  {
    return [v9 initWithFormat:@"%02ld:%02ld:%02ld", v5, v7, v8, v12, v13];
  }

  if ((a3 - 86400) >= 0x15180)
  {
    v11 = @"s";
  }

  else
  {
    v11 = &stru_4BD3F0;
  }

  return [v9 initWithFormat:@"%ld day%@ %02ld:%02ld:%02ld", v4, v11, v5, v7, v8];
}

+ (void)persistForJobSelector:(id)a3 persistingJobDescriptor:(id)a4 justDownloaded:(BOOL)a5 justPatched:(BOOL)a6 withJobInformation:(id)a7 withFirstClientName:(id)a8
{
  v13 = a3;
  v14 = a4;
  v15 = a7;
  v16 = a8;
  v17 = +[MADAutoAssetControlManager autoControlManager];
  v18 = [v17 autoControlManagerFSM];

  if (v18)
  {
    v19 = [v17 autoControlManagerFSM];
    v20 = [v19 extendedStateQueue];
    v22[0] = _NSConcreteStackBlock;
    v22[1] = 3221225472;
    v22[2] = __142__MADAutoAssetControlManager_persistForJobSelector_persistingJobDescriptor_justDownloaded_justPatched_withJobInformation_withFirstClientName___block_invoke;
    v22[3] = &unk_4B48E8;
    v28 = a5;
    v23 = v14;
    v29 = a6;
    v24 = v17;
    v25 = v16;
    v26 = v13;
    v27 = v15;
    dispatch_sync(v20, v22);

    v21 = v23;
  }

  else
  {
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{persistForJobSelector} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }
}

void __142__MADAutoAssetControlManager_persistForJobSelector_persistingJobDescriptor_justDownloaded_justPatched_withJobInformation_withFirstClientName___block_invoke(uint64_t a1)
{
  if (*(a1 + 72) == 1)
  {
    v2 = [*(a1 + 32) assetType];
    v3 = [*(a1 + 32) assetId];
    v4 = getAutoLocalUrlFromTypeAndIdWithPurpose(v2, v3, 2, @"auto");
    v5 = [v4 path];

    if (*(a1 + 73) == 1)
    {
      [*(a1 + 32) setIsPatch:1];
    }

    [*(a1 + 40) _statsIncrementDownloadedForDescriptor:*(a1 + 32)];
    if (v5)
    {
      v6 = [[NSURL alloc] initFileURLWithPath:v5];
      v7 = [v6 URLByDeletingLastPathComponent];
      updateClientUsageDate(v7);
    }

    else
    {
      v6 = [*(a1 + 40) autoControlManagerFSM];
      v7 = [v6 diag];
      v8 = [NSString alloc];
      v9 = [*(a1 + 32) summary];
      v10 = [v8 initWithFormat:@"{persistForJobSelector} unable to determine local repository path for jobDescriptor:%@", v9];
      [v7 trackAnomaly:@"AUTO-CONTROL" forReason:v10 withResult:6101 withError:0];
    }

    v11 = *(a1 + 48);
    v12 = [*(a1 + 32) assetId];
    v13 = *(a1 + 56);
    if (v11)
    {
      [MADAutoAssetHistory recordOperation:100 toHistoryType:0 fromClient:v11 forAssetID:v12 withSelector:v13];
    }

    else
    {
      [MADAutoAssetHistory recordOperation:201 toHistoryType:0 fromLayer:1 forAssetID:v12 withSelector:v13];
    }

    [*(a1 + 40) _removeUnlockedForOlderSelectorsWithoutVersion:*(a1 + 32)];
  }

  LOBYTE(v21) = 0;
  [*(a1 + 40) trackDescriptor:*(a1 + 32) persisting:1 fromLocation:@"persistForJobSelector" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:*(a1 + 48) isPromoted:v21];
  v14 = *(a1 + 64);
  if (v14)
  {
    v22 = [*(a1 + 40) _autoAssetJobProgressNewValidatedCurrentStatus:v14 requiringProgress:0];
    v15 = [MAAutoAssetSelector alloc];
    v16 = [*(a1 + 32) assetType];
    v17 = [*(a1 + 32) assetSpecifier];
    v18 = [*(a1 + 32) assetVersion];
    v19 = [v15 initForAssetType:v16 withAssetSpecifier:v17 matchingAssetVersion:v18];

    if ([*(a1 + 32) foundByLookupWithoutAssetVersion])
    {
      v20 = 0;
    }

    else
    {
      v20 = [v19 assetVersion];
    }

    [*(a1 + 40) updateAutoAssetStatus:v19 forActiveJobUUID:0 withLatestJobStatus:v22 matchingAssetVersion:v20 fromLocation:@"persistForJobSelector"];
  }
}

+ (BOOL)persistSetJobDescriptor:(id)a3 withCurrentSetStatus:(id)a4 withFirstClientName:(id)a5 fromLocation:(id)a6
{
  v9 = a3;
  v10 = a4;
  v11 = a5;
  v12 = a6;
  v13 = +[MADAutoAssetControlManager autoControlManager];
  v14 = [[NSString alloc] initWithFormat:@"%@:persistSetJobDescriptor", v12];
  v29 = 0;
  v30 = &v29;
  v31 = 0x2020000000;
  v32 = 0;
  v15 = [v13 autoControlManagerFSM];
  v16 = v15 == 0;

  if (v16)
  {
    v20 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v34 = v14;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "AUTO-SET-CONTROL:{%{public}@} Skipping operation since FSM is not initialized", buf, 0xCu);
    }

    v19 = *(v30 + 24);
  }

  else
  {
    v17 = [v13 autoControlManagerFSM];
    v18 = [v17 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __108__MADAutoAssetControlManager_persistSetJobDescriptor_withCurrentSetStatus_withFirstClientName_fromLocation___block_invoke;
    block[3] = &unk_4B3F60;
    v23 = v13;
    v24 = v14;
    v25 = v10;
    v26 = v9;
    v28 = &v29;
    v27 = v11;
    dispatch_sync(v18, block);

    v19 = *(v30 + 24);
  }

  _Block_object_dispose(&v29, 8);

  return v19 & 1;
}

void __108__MADAutoAssetControlManager_persistSetJobDescriptor_withCurrentSetStatus_withFirstClientName_fromLocation___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v4 = [*(a1 + 48) assetSetIdentifier];
  [v2 _updateCurrentSetStatus:v3 forSetIdentifier:v4 withSetStatus:*(a1 + 48)];

  v5 = *(a1 + 32);
  v6 = [v5 atomicInstanceForSetDescriptor:*(a1 + 56)];
  LOBYTE(v5) = [v5 isAtomicInstancePartOfPSUS:v6];

  v7 = *(a1 + 56);
  v8 = *(a1 + 32);
  v9 = *(a1 + 40);
  v10 = [v7 isDiscoveredFullyDownloaded];
  v11 = [*(a1 + 56) discoveredAtomicInstance];
  v12 = *(a1 + 48);
  v13 = [*(a1 + 56) isDiscoveredFullyDownloaded];
  LOBYTE(v38) = v5;
  BYTE2(v36) = [*(a1 + 56) isDiscoveredFullyDownloaded];
  BYTE1(v36) = v13;
  LOBYTE(v36) = 0;
  *(*(*(a1 + 72) + 8) + 24) = [v8 trackSetDescriptor:v7 fromLocation:v9 forLatestDownloaded:v10 forSpecificAtomicInstance:v11 withCurrentSetStatus:v12 changedWhileTerminated:0 changedNeverBeenLocked:v36 notifyingIfJustDownloaded:0 latestToVend:*(a1 + 64) historyOperation:v38 firstClientName:? fromPreSUStaging:?];

  v14 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    v15 = *(a1 + 40);
    if (*(*(*(a1 + 72) + 8) + 24))
    {
      v16 = @"Y";
    }

    else
    {
      v16 = @"N";
    }

    v17 = [*(a1 + 56) summary];
    *buf = 138543874;
    v48 = v15;
    v49 = 2114;
    v50 = v16;
    v51 = 2114;
    v52 = v17;
    _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-DESCRIPTOR][VEND] update to set-descriptor provided by set-job | justBecameLatestToVend:%{public}@ | setJobDescriptor:%{public}@", buf, 0x20u);
  }

  if ([*(a1 + 56) isDiscoveredFullyDownloaded])
  {
    v44 = 0u;
    v45 = 0u;
    v42 = 0u;
    v43 = 0u;
    v40 = a1;
    v18 = [*(a1 + 56) latestDowloadedAtomicInstanceEntries];
    v41 = [v18 countByEnumeratingWithState:&v42 objects:v46 count:16];
    if (v41)
    {
      v19 = *v43;
      v39 = *v43;
      do
      {
        for (i = 0; i != v41; i = i + 1)
        {
          if (*v43 != v19)
          {
            objc_enumerationMutation(v18);
          }

          v21 = *(*(&v42 + 1) + 8 * i);
          v22 = objc_autoreleasePoolPush();
          v23 = [v21 assetID];

          if (v23)
          {
            v24 = [v21 fullAssetSelector];
            v25 = [v24 assetType];
            v26 = [v21 assetID];
            v27 = getAutoLocalUrlFromTypeAndIdWithPurpose(v25, v26, 2, @"auto");
            v28 = [v27 path];

            if (v28)
            {
              v29 = [[NSURL alloc] initFileURLWithPath:v28];
              v30 = [v29 URLByDeletingLastPathComponent];
              updateClientUsageDate(v30);
            }

            else
            {
              v31 = v18;
              v29 = [*(v40 + 32) autoControlManagerFSM];
              v30 = [v29 diag];
              v32 = [NSString alloc];
              v33 = *(v40 + 40);
              v34 = [v21 summary];
              v37 = v33;
              v18 = v31;
              v19 = v39;
              v35 = [v32 initWithFormat:@"{%@} unable to determine local repository path for nextDownloadedAtomicEntry:%@", v37, v34];
              [v30 trackAnomaly:@"AUTO-CONTROL" forReason:v35 withResult:6101 withError:0];
            }
          }

          objc_autoreleasePoolPop(v22);
        }

        v41 = [v18 countByEnumeratingWithState:&v42 objects:v46 count:16];
      }

      while (v41);
    }
  }
}

+ (id)loadDescriptorsForJobSelector:(id)a3 promotingIfCurrentlyStaged:(id)a4 immediatelyPromotedDescriptor:(id *)a5
{
  v7 = a3;
  v8 = a4;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v29 = 0;
  v30 = &v29;
  v31 = 0x3032000000;
  v32 = __Block_byref_object_copy__12;
  v33 = __Block_byref_object_dispose__12;
  v34 = 0;
  v23 = 0;
  v24 = &v23;
  v25 = 0x3032000000;
  v26 = __Block_byref_object_copy__12;
  v27 = __Block_byref_object_dispose__12;
  v28 = 0;
  v10 = [v9 autoControlManagerFSM];

  if (v10)
  {
    v11 = [v9 autoControlManagerFSM];
    v12 = [v11 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __117__MADAutoAssetControlManager_loadDescriptorsForJobSelector_promotingIfCurrentlyStaged_immediatelyPromotedDescriptor___block_invoke;
    block[3] = &unk_4B4910;
    v17 = v8;
    v18 = v9;
    v20 = &v23;
    v19 = v7;
    v21 = &v29;
    dispatch_sync(v12, block);

    if (a5)
    {
      *a5 = v24[5];
    }

    v13 = v30[5];
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{loadDescriptorsForJobSelector} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v13 = v30[5];
  }

  _Block_object_dispose(&v23, 8);

  _Block_object_dispose(&v29, 8);

  return v13;
}

void __117__MADAutoAssetControlManager_loadDescriptorsForJobSelector_promotingIfCurrentlyStaged_immediatelyPromotedDescriptor___block_invoke(uint64_t a1)
{
  if (*(a1 + 32))
  {
    [*(a1 + 40) ensureStagerFullyResumed];
    v2 = [MADAutoAssetStager controlConvertStagedToDownloaded:*(a1 + 32)];
    v3 = *(*(a1 + 56) + 8);
    v4 = *(v3 + 40);
    *(v3 + 40) = v2;

    v5 = *(*(*(a1 + 56) + 8) + 40);
    if (v5)
    {
      [*(a1 + 40) _promotePreviouslyStagedNowDownloaded:v5 forHistoryOperation:204];
    }
  }

  v6 = objc_alloc_init(NSMutableDictionary);
  v7 = [*(a1 + 40) locateDownloadedNewForSelector:@"loadDescriptorsForJobSelector" assetSelector:*(a1 + 48) limitedToStaging:0];
  [*(a1 + 40) trackPerformanceIteration:@"loadDescriptorsForJobSelector" ofContainer:@"locateDownloadedNewForSelector"];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v8 = v7;
  v9 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v18;
    do
    {
      v12 = 0;
      do
      {
        if (*v18 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v17 + 1) + 8 * v12);
        v14 = objc_autoreleasePoolPush();
        v15 = [v8 safeObjectForKey:v13 ofClass:{objc_opt_class(), v17}];
        v16 = [v15 assetVersion];
        [v6 setSafeObject:v15 forKey:v16];

        objc_autoreleasePoolPop(v14);
        v12 = v12 + 1;
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v10);
  }

  if ([v6 count])
  {
    objc_storeStrong((*(*(a1 + 64) + 8) + 40), v6);
  }
}

- (void)removeActiveJobForFullSelector:(id)a3 removingFullSelector:(id)a4 alsoRemovingNoVersionSelector:(id)a5
{
  v45 = a3;
  v8 = a4;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:removeActiveJobForFullSelector", v45];
  if (v8)
  {
    v13 = [v8 persistedEntryID];
    v14 = [(MADAutoAssetControlManager *)self jobSelectorKey:v8];
    v15 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v16 = [v15 persistedEntryAlreadyExists:v13 fromLocation:v12];

    if (!v16)
    {
LABEL_9:
      v27 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      [v27 removeObjectForKey:v14];

      goto LABEL_10;
    }

    v17 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v18 = [v17 persistedEntry:v13 fromLocation:v12];

    if (v18)
    {
      v19 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v20 = [v19 decodeFromLocation:v12 ofEntryName:v13 fromPersistedEntry:v18 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v20)
      {
LABEL_8:

        goto LABEL_9;
      }

      v43 = v18;
      v21 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      [v21 removePersistedEntry:v13 fromLocation:v45];

      v22 = [NSString alloc];
      v23 = [v8 summary];
      v24 = [v22 initWithFormat:@"removed descriptor for fullSelector:%@ from previously active jobs", v23];
      [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:v12 forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v13 removedDescriptor:v20 message:v24];
    }

    else
    {
      v43 = 0;
      v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v23 = [v20 diag];
      v25 = [NSString alloc];
      v24 = [v8 summary];
      v26 = [v25 initWithFormat:@"{%@} | no persistedEntryID for fullSelector:%@", v12, v24];
      [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6110 withError:0];
    }

    v18 = v43;
    goto LABEL_8;
  }

LABEL_10:
  if (!v9)
  {
    goto LABEL_19;
  }

  v28 = [v9 persistedEntryID];
  v29 = [(MADAutoAssetControlManager *)self jobSelectorKey:v9];
  v30 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v31 = [v30 persistedEntryAlreadyExists:v28 fromLocation:v12];

  if (v31)
  {
    v32 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v33 = [v32 persistedEntry:v28 fromLocation:v12];

    if (v33)
    {
      v34 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v35 = [v34 decodeFromLocation:v12 ofEntryName:v28 fromPersistedEntry:v33 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v35)
      {
LABEL_17:

        goto LABEL_18;
      }

      v44 = v33;
      v36 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      [v36 removePersistedEntry:v28 fromLocation:v45];

      v37 = [NSString alloc];
      v38 = [v9 summary];
      v39 = [v37 initWithFormat:@"removed descriptor for noVersionSelector:%@ from previously active jobs", v38];
      [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:v12 forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v28 removedDescriptor:v35 message:v39];
    }

    else
    {
      v44 = 0;
      v35 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v38 = [v35 diag];
      v40 = [NSString alloc];
      v39 = [v9 summary];
      v41 = [v40 initWithFormat:@"{%@} | no persistedEntryID for noVersionSelector:%@", v12, v39];
      [v38 trackAnomaly:@"AUTO-CONTROL" forReason:v41 withResult:6110 withError:0];
    }

    v33 = v44;
    goto LABEL_17;
  }

LABEL_18:
  v42 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  [v42 removeObjectForKey:v29];

LABEL_19:
}

- (id)persistedKnownDescriptorForSetAtomicEntry:(id)a3
{
  v4 = [a3 fullAssetSelector];
  if (v4)
  {
    v5 = [(MADAutoAssetControlManager *)self _persistedKnownDescriptorForFullAssetSelector:v4];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (id)_persistedKnownDescriptorForFullAssetSelector:(id)a3
{
  v4 = [a3 persistedEntryID];
  if (v4)
  {
    v5 = [(MADAutoAssetControlManager *)self _persistedKnownDescriptorForPersistedEntryID:v4];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (id)_persistedKnownDescriptorForPersistedEntryID:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v6 = [v5 persistedEntry:v4 fromLocation:@"persistedKnownDescriptorForSelector"];

  if (v6)
  {
    v7 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v8 = [v7 decodeFromLocation:@"persistedKnownDescriptorForSelector" ofEntryName:v4 fromPersistedEntry:v6 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    if (v8)
    {
      v9 = v8;
    }
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

+ (id)newestDownloadedForSetDescriptor:(id)a3
{
  v3 = a3;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  v5 = [v4 autoControlManagerFSM];

  if (v5)
  {
    v6 = [v4 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __63__MADAutoAssetControlManager_newestDownloadedForSetDescriptor___block_invoke;
    block[3] = &unk_4B4478;
    v12 = v4;
    v13 = v3;
    v14 = &v16;
    dispatch_sync(v7, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{newestDownloadedForSetDescriptor} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

void __63__MADAutoAssetControlManager_newestDownloadedForSetDescriptor___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = [*(a1 + 40) clientDomainName];
  v4 = [*(a1 + 40) assetSetIdentifier];
  v5 = [v2 locateSetConfigurationByClientDomain:v3 forAssetSetIdentifier:v4];

  if (v5)
  {
    v6 = [v5 latestAtomicInstanceToVend];

    v7 = *(a1 + 32);
    if (v6)
    {
      v8 = [v5 latestAtomicInstanceToVend];
      v9 = [v7 locateSetStatusByInstance:v8];
      v10 = *(*(a1 + 48) + 8);
      v11 = *(v10 + 40);
      *(v10 + 40) = v9;

      goto LABEL_21;
    }

    [v7 trackPerformanceIteration:@"newestDownloadedForSetDescriptor" ofContainer:@"currentSetStatusByInstance"];
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    obj = [*(a1 + 32) currentSetStatusByInstance];
    v29 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    if (!v29)
    {
      goto LABEL_20;
    }

    v12 = *v32;
LABEL_6:
    v13 = 0;
    while (1)
    {
      if (*v32 != v12)
      {
        objc_enumerationMutation(obj);
      }

      v14 = *(*(&v31 + 1) + 8 * v13);
      context = objc_autoreleasePoolPush();
      v15 = [*(a1 + 32) currentSetStatusByInstance];
      v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

      v17 = [v16 clientDomainName];
      v18 = [*(a1 + 40) clientDomainName];
      if (([SUCore stringIsEqual:v17 to:v18]& 1) == 0)
      {
        break;
      }

      [v16 assetSetIdentifier];
      v20 = v19 = v12;
      v21 = [*(a1 + 40) assetSetIdentifier];
      v22 = [SUCore stringIsEqual:v20 to:v21];

      v12 = v19;
      if (v22)
      {
        v23 = *(*(a1 + 48) + 8);
        v24 = *(v23 + 40);
        if (v24)
        {
          v25 = [v24 latestDownloadedAtomicInstance];

          if (v25)
          {
            goto LABEL_18;
          }

          v26 = [v16 latestDownloadedAtomicInstance];

          if (!v26)
          {
            goto LABEL_18;
          }

          v23 = *(*(a1 + 48) + 8);
        }

        v27 = v16;
        v17 = *(v23 + 40);
        *(v23 + 40) = v27;
        goto LABEL_17;
      }

LABEL_18:

      objc_autoreleasePoolPop(context);
      if (v29 == ++v13)
      {
        v29 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
        if (!v29)
        {
LABEL_20:

          goto LABEL_21;
        }

        goto LABEL_6;
      }
    }

LABEL_17:
    goto LABEL_18;
  }

LABEL_21:
}

+ (id)newAtomicInstancesDownloadedForSetIdentifier:(id)a3
{
  v3 = a3;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  v5 = [v4 autoControlManagerFSM];

  if (v5)
  {
    v6 = [v4 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __75__MADAutoAssetControlManager_newAtomicInstancesDownloadedForSetIdentifier___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = v3;
    dispatch_sync(v7, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{newAtomicInstancesDownloadedForSetIdentifier} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

uint64_t __75__MADAutoAssetControlManager_newAtomicInstancesDownloadedForSetIdentifier___block_invoke(uint64_t a1)
{
  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) _newAtomicInstancesDownloadedForSetIdentifier:*(a1 + 40)];

  return _objc_release_x1();
}

+ (id)localAssetURLForDescriptor:(id)a3 fromLocation:(id)a4
{
  v5 = a3;
  v6 = a4;
  if ([v5 isMAAutoAsset] && (objc_msgSend(v5, "assetType"), (v7 = objc_claimAutoreleasedReturnValue()) != 0) && (v8 = v7, objc_msgSend(v5, "assetId"), v9 = objc_claimAutoreleasedReturnValue(), v9, v8, v9))
  {
    v10 = [v5 assetType];
    v11 = [v5 assetId];
    v12 = getAutoLocalUrlFromTypeAndIdWithPurpose(v10, v11, 2, @"auto");
    v13 = [v12 path];

    v14 = [[NSString alloc] initWithFormat:@"/%@", @"AssetData"];
    v15 = [v14 length];
    v16 = [v13 length];
    v17 = 0;
    if ([v13 hasSuffix:v14] && v16 > v15)
    {
      v17 = [v13 substringWithRange:{0, v16 - v15}];
    }
  }

  else
  {
    v13 = +[MADAutoAssetControlManager autoControlManager];
    v14 = [v13 autoControlManagerFSM];
    v18 = [v14 diag];
    v19 = [NSString alloc];
    v20 = [v5 summary];
    v21 = [v19 initWithFormat:@"{%@} unable to construct local URL from descriptor:%@", v6, v20];
    [v18 trackAnomaly:@"AUTO-CONTROL" forReason:v21 withResult:6111 withError:0];

    v17 = 0;
  }

  return v17;
}

+ (id)localAssetURLForAtomicEntry:(id)a3
{
  v3 = a3;
  v4 = [v3 fullAssetSelector];
  v5 = [v4 assetType];
  if (!v5)
  {

    goto LABEL_7;
  }

  v6 = v5;
  v7 = [v3 assetID];

  if (!v7)
  {
LABEL_7:
    v12 = +[MADAutoAssetControlManager autoControlManager];
    v13 = [v12 autoControlManagerFSM];
    v17 = [v13 diag];
    v18 = [NSString alloc];
    v19 = [v3 summary];
    v20 = [v18 initWithFormat:@"unable to construct local URL from atomicEntry:%@", v19];
    [v17 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6111 withError:0];

    v16 = 0;
    goto LABEL_8;
  }

  v8 = [v3 fullAssetSelector];
  v9 = [v8 assetType];
  v10 = [v3 assetID];
  v11 = getAutoLocalUrlFromTypeAndIdWithPurpose(v9, v10, 2, @"auto");
  v12 = [v11 path];

  v13 = [[NSString alloc] initWithFormat:@"/%@", @"AssetData"];
  v14 = [v13 length];
  v15 = [v12 length];
  v16 = 0;
  if ([v12 hasSuffix:v13] && v15 > v14)
  {
    v16 = [v12 substringWithRange:{0, v15 - v14}];
  }

LABEL_8:

  return v16;
}

+ (id)restoreVersionFromOSVersion:(id)a3
{
  v3 = a3;
  v4 = [v3 componentsSeparatedByString:@"."];
  v5 = [v4 count];
  if (v5 <= 0)
  {
    v13 = [[NSString alloc] initWithFormat:@"%@.0.0.0.0, 0", v3];
    if (!v13)
    {
LABEL_13:
      v14 = 0;
      goto LABEL_18;
    }
  }

  else
  {
    v6 = v5;
    if (v5 > 4)
    {
      v15 = _MADLog(@"Auto");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543362;
        v18 = v3;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "AUTO-CONTROL:{restoreVersionFromOSVersion} too many elements | osVersion:%{public}@", buf, 0xCu);
      }

      v13 = @"0.0.0.0.0,0";
    }

    else
    {
      v7 = [NSMutableString alloc];
      v8 = [v4 objectAtIndexedSubscript:0];
      v9 = [v7 initWithString:v8];

      if (v6 != &dword_0 + 1)
      {
        for (i = 1; i != v6; ++i)
        {
          v11 = [v4 objectAtIndexedSubscript:i];
          [v9 appendFormat:@".%@", v11];
        }
      }

      if (v6 != 4 && v6 != &dword_4 + 1)
      {
        v12 = 5 - v6;
      }

      else
      {
        v12 = 1;
      }

      do
      {
        [v9 appendString:@".0"];
        --v12;
      }

      while (v12);
      v13 = [[NSString alloc] initWithFormat:@"%@, 0", v9];

      if (!v13)
      {
        goto LABEL_13;
      }
    }
  }

  v14 = [[SUCoreRestoreVersion alloc] initWithRestoreVersion:v13];
LABEL_18:

  return v14;
}

- (unsigned)isLocalContentValidForSetAtomicEntry:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:isLocalContentValidForSetAtomicEntry", v7];
  if (v6 && ([v6 localContentURL], (v11 = objc_claimAutoreleasedReturnValue()) != 0) && (v12 = v11, objc_msgSend(v6, "localContentURL"), v13 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v13, "URLByDeletingLastPathComponent"), v14 = objc_claimAutoreleasedReturnValue(), v14, v13, v12, v14))
  {
    v15 = [v6 localContentURL];
    v16 = [v15 URLByDeletingLastPathComponent];
    v17 = [v16 URLByAppendingPathComponent:@"Info.plist"];
    v18 = [v17 path];

    v19 = [(MADAutoAssetControlManager *)self filesystemDoesFileExist:v10 atPath:v18];
  }

  else
  {
    v19 = 0;
  }

  return v19;
}

- (id)getCorruptedEntryInfo:(id)a3
{
  v3 = a3;
  v4 = v3;
  if (!v3 || ([v3 localContentURL], (v5 = objc_claimAutoreleasedReturnValue()) == 0) || (v6 = v5, objc_msgSend(v4, "localContentURL"), v7 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v7, "URLByDeletingLastPathComponent"), v8 = objc_claimAutoreleasedReturnValue(), v8, v7, v6, !v8) || (objc_msgSend(v4, "localContentURL"), v9 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v9, "URLByDeletingLastPathComponent"), v10 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v10, "path"), v11 = objc_claimAutoreleasedReturnValue(), v10, v9, !v11))
  {
    v12 = [v4 fullAssetSelector];
    v13 = [v12 summary];

    if (v13)
    {
      v11 = v13;
    }

    else
    {
      v11 = @" ";
    }
  }

  return v11;
}

- (void)trackDescriptor:(id)a3 persisting:(BOOL)a4 fromLocation:(id)a5 changedWhileTerminated:(BOOL)a6 changedNeverBeenLocked:(BOOL)a7 historyOperation:(int64_t)a8 firstClientName:(id)a9 isPromoted:(BOOL)a10
{
  v91 = a7;
  v11 = a6;
  v13 = a4;
  v15 = a3;
  v16 = a5;
  v17 = a9;
  v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v19 = [v18 extendedStateQueue];
  dispatch_assert_queue_V2(v19);

  if (v15 && ![v15 isBlankEntry])
  {
    v89 = v17;
    v90 = v16;
    v25 = [MAAutoAssetSelector alloc];
    v26 = [v15 assetType];
    v27 = [v15 assetSpecifier];
    v28 = [v15 assetVersion];
    v29 = [v25 initForAssetType:v26 withAssetSpecifier:v27 matchingAssetVersion:v28];

    if (![v15 isOnFilesystem])
    {
      v31 = 0;
      v86 = 0;
      v37 = 1;
      v38 = @"job has just updated status";
      v32 = v29;
      v17 = v89;
      v16 = v90;
      goto LABEL_40;
    }

    v30 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v29];
    v31 = v30;
    v32 = v29;
    if (v13)
    {
      v85 = v29;
      v33 = v30;
      v34 = [NSString alloc];
      if (v11)
      {
        v35 = @"previously in-flight";
      }

      else
      {
        v35 = @"just";
      }

      v17 = v89;
      v16 = v90;
      if (v91)
      {
        v36 = @"first-locked";
      }

      else if ([v15 foundAsPreInstalled])
      {
        v36 = @"migrated-preinstalled";
      }

      else
      {
        v39 = [v15 isPatch];
        v36 = @"downloaded(full)";
        if (v39)
        {
          v36 = @"patched";
        }
      }

      v87 = [v34 initWithFormat:@"%@ %@ auto-asset-descriptor status update", v35, v36];
      v40 = _MADLog(@"AutoControl");
      v31 = v33;
      v32 = v85;
      if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
      {
        v41 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        if (v31)
        {
          v83 = [v31 summary];
        }

        else
        {
          v83 = @"N";
        }

        v42 = [v15 summary];
        *buf = 138544386;
        v93 = v41;
        v94 = 2114;
        v95 = v90;
        v96 = 2114;
        v97 = v87;
        v98 = 2114;
        v99 = v83;
        v100 = 2114;
        v101 = v42;
        _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:trackDescriptor} %{public}@ | previousDescriptor:%{public}@ | recentDescriptor:%{public}@", buf, 0x34u);
        if (v31)
        {
        }

        v32 = v85;
        v16 = v90;
      }

      v86 = @"DOWNLOADED_DESCRIPTORS";
      v38 = v87;
      if (!a8)
      {
LABEL_30:
        if (v31)
        {
          if ([v31 isOnFilesystem] & 1) != 0 || (objc_msgSend(v15, "isOnFilesystem"))
          {
            v44 = 0;
          }

          else
          {
            v44 = [(MADAutoAssetControlManager *)self _updateTrackedDescriptor:v31 fromLatestDescriptor:v15];
          }

          v37 = 0;
          if ((v44 & 1) == 0 && !v13)
          {
            v45 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v45, OS_LOG_TYPE_DEBUG))
            {
              [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v46 = v32;
              v48 = v47 = v31;
              v49 = [v46 summary];
              *buf = 138543874;
              v93 = v48;
              v94 = 2114;
              v95 = v16;
              v96 = 2114;
              v97 = v49;
              _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEBUG, "[%{public}@] {%{public}@:trackDescriptor} update to descriptor not performed (nothing changed) | selector:%{public}@", buf, 0x20u);

              v31 = v47;
              v32 = v46;
            }

LABEL_78:

            goto LABEL_79;
          }
        }

        else
        {
          v37 = 1;
        }

LABEL_40:
        if (!v13)
        {
LABEL_79:

          goto LABEL_80;
        }

        v45 = [v32 persistedEntryID];
        v88 = v31;
        if (([v15 isOnFilesystem] & 1) == 0 && !objc_msgSend(v31, "isOnFilesystem"))
        {
          v53 = 0;
LABEL_64:
          if ([v15 isOnFilesystem])
          {
            v65 = v53;
          }

          else
          {
            v66 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v67 = [v66 persistedEntryAlreadyExists:v45 fromLocation:v16];

            v68 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v65 = [v68 persistedEntry:v45 fromLocation:v16];

            if (v65)
            {
              if (v67)
              {
                v69 = @"ENTRY_MODIFY";
              }

              else
              {
                v69 = @"ENTRY_ADD";
              }

              [v65 persistSecureCodedObject:v15 forKey:@"assetDescriptor"];
              v70 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              [v15 summary];
              v72 = v71 = v32;
              [v70 storePersistedEntry:v45 withEntrySummary:v72 fromLocation:v90];

              v32 = v71;
              v16 = v90;

              [(MADAutoAssetControlManager *)self _logPersistedEntry:v90 forComponentType:@"JOB_DESCRIPTORS" operation:v69 forPersistedEntryID:v45 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v15 baseForPatchDescriptor:0 message:v38];
            }

            else
            {
              v73 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v73, OS_LOG_TYPE_ERROR))
              {
                v74 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                [v32 summary];
                v76 = v75 = v32;
                *buf = 138543874;
                v93 = v74;
                v94 = 2114;
                v95 = v90;
                v96 = 2114;
                v97 = v76;
                _os_log_impl(&dword_0, v73, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:trackDescriptor} unable to load active-job persisted-descriptor file | selector:%{public}@", buf, 0x20u);

                v32 = v75;
              }

              if (a10)
              {
                v77 = [(MADAutoAssetControlManager *)self analyticsManager];
                v78 = [v32 assetSpecifier];
                [v32 assetType];
                v80 = v79 = v32;
                v81 = [v79 assetVersion];
                v82 = [v77 recordMobileAssetPromotionAttempt:v78 assetType:v80 assetVersion:v81 osPromotion:1 successfullyPromoted:0 withReason:5];

                v32 = v79;
              }

              v16 = v90;
            }

            v31 = v88;
          }

          v17 = v89;
          goto LABEL_78;
        }

        v50 = v32;
        v51 = v38;
        v52 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v53 = [v52 persistedEntry:v45 fromLocation:v16];

        if (!v53)
        {
          v55 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
          {
            v57 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v58 = [v50 summary];
            *buf = 138543874;
            v93 = v57;
            v94 = 2114;
            v95 = v16;
            v96 = 2114;
            v97 = v58;
            _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:trackDescriptor} unable to load persisted-descriptor file | selector:%{public}@", buf, 0x20u);
          }

          v53 = 0;
          goto LABEL_62;
        }

        v31 = v88;
        v54 = v88;
        if (v37)
        {
          v55 = v15;
          v56 = @"ENTRY_ADD";
        }

        else
        {
          v55 = v54;
          if (([v54 isOnFilesystem]& 1) == 0)
          {
            v59 = v15;

            v84 = @"ENTRY_MODIFY";
            v55 = v59;
            v31 = v88;
            goto LABEL_54;
          }

          v56 = @"ENTRY_MODIFY";
        }

        v84 = v56;
LABEL_54:
        if ([v15 isOnFilesystem])
        {
          v60 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v61 = [v60 decodeFromLocation:v16 ofEntryName:v45 fromPersistedEntry:v53 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:1];

          if (v61)
          {
            [v61 setNeverBeenLocked:{-[NSObject neverBeenLocked](v55, "neverBeenLocked")}];
            [v61 setIsOnFilesystem:{-[NSObject isOnFilesystem](v55, "isOnFilesystem")}];
            v62 = v61;

            v55 = v62;
          }

          v31 = v88;
        }

        if (![v55 isOnFilesystem])
        {
          goto LABEL_63;
        }

        if (v91)
        {
          [v55 setNeverBeenLocked:0];
        }

        [v53 persistSecureCodedObject:v55 forKey:@"assetDescriptor"];
        v63 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v64 = [v55 summary];
        [v63 storePersistedEntry:v45 withEntrySummary:v64 fromLocation:v16];

        [(MADAutoAssetControlManager *)self _logPersistedEntry:v16 forComponentType:v86 operation:v84 forPersistedEntryID:v45 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v55 baseForPatchDescriptor:0 message:v51];
LABEL_62:
        v31 = v88;
LABEL_63:

        v38 = v51;
        v32 = v50;
        goto LABEL_64;
      }
    }

    else
    {
      v86 = 0;
      v38 = @"job has just updated status";
      v17 = v89;
      v16 = v90;
      if (!a8)
      {
        goto LABEL_30;
      }
    }

    v43 = [v15 assetId];
    if (v17)
    {
      [MADAutoAssetHistory recordOperation:a8 toHistoryType:0 fromClient:v17 forAssetID:v43 withSelector:v32];
    }

    else
    {
      [MADAutoAssetHistory recordOperation:a8 toHistoryType:0 fromLayer:1 forAssetID:v43 withSelector:v32];
    }

    v16 = v90;
    goto LABEL_30;
  }

  v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v21 = [v20 diag];
  v22 = [NSString alloc];
  v23 = [v15 summary];
  v24 = [v22 initWithFormat:@"{trackDescriptor} nil or blank-entry jobDescriptor:%@", v23];
  [v21 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6103 withError:0];

LABEL_80:
}

- (BOOL)trackSetDescriptor:(id)a3 fromLocation:(id)a4 forLatestDownloaded:(BOOL)a5 forSpecificAtomicInstance:(id)a6 withCurrentSetStatus:(id)a7 changedWhileTerminated:(BOOL)a8 changedNeverBeenLocked:(BOOL)a9 notifyingIfJustDownloaded:(BOOL)a10 latestToVend:(BOOL)a11 historyOperation:(int64_t)a12 firstClientName:(id)a13 fromPreSUStaging:(BOOL)a14
{
  v17 = a3;
  v18 = a7;
  v19 = a4;
  v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v21 = [v20 extendedStateQueue];
  dispatch_assert_queue_V2(v21);

  v22 = [[NSString alloc] initWithFormat:@"%@:trackSetDescriptor", v19];
  if (v17)
  {
    v23 = a11;
    v24 = [v17 clientDomainName];
    v25 = [v17 assetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v24 forAssetSetIdentifier:v25];

    v27 = [v17 clientDomainName];
    v28 = [v17 assetSetIdentifier];
    v29 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByClientDomain:v27 forAssetSetIdentifier:v28];

    v30 = [v17 discoveredAtomicInstance];
    v134 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:v30];

    v31 = [v17 latestDownloadedAtomicInstance];
    v133 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:v31];

    v32 = [v17 latestDownloadedAtomicInstance];
    v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v22 forAtomicInstanceUUID:v32 requireExists:0];

    v132 = v33;
    if (v33)
    {
      v131 = v29;
      v34 = v26;
      v35 = [v17 clientDomainName];
      v36 = [v17 assetSetIdentifier];
      v37 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v35 forAssetSetIdentifier:v36];

      [(MADAutoAssetControlManager *)self persistSetDescriptorDownloadedJob:v17 fromLocation:v22];
      v38 = [v37 latestAtomicInstanceToVend];

      if (!v38)
      {
        v23 = 1;
      }

      v39 = 0;
LABEL_6:
      v40 = 0;
      if (v39)
      {
        v26 = v34;
        v29 = v131;
      }

      else
      {
        v26 = v34;
        v29 = v131;
        if (v23)
        {
          v41 = [v17 clientDomainName];
          v42 = [v17 assetSetIdentifier];
          v43 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v41 forAssetSetIdentifier:v42];

          if (v43)
          {
            v44 = [v43 latestAtomicInstanceToVend];
            v45 = [v17 latestDownloadedAtomicInstance];
            v46 = [SUCore stringIsEqual:v44 to:v45];

            if (v46)
            {
LABEL_10:
              v40 = 0;
LABEL_24:

              goto LABEL_25;
            }

            if ([v17 isOnFilesystem] && (objc_msgSend(v17, "onFilesystemIncomplete") & 1) == 0)
            {
              if ([(MADAutoAssetControlManager *)self _doesSetDescriptorRequirePersonalization:v22 forSetDescriptor:v17])
              {
                v53 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                {
                  goto LABEL_22;
                }

                v54 = [v17 summary];
                *buf = 138543618;
                v136 = v22;
                v137 = 2114;
                v138 = v54;
                v90 = "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] not setting latestAtomicInstanceToVend (requiresPersonalization) | setJobDescriptor:%{public}@";
              }

              else
              {
                if (![(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:v22 forSetDescriptor:v17])
                {
                  v91 = [v43 latestAtomicInstanceToVend];

                  if (![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v22 fromSetDescriptor:v17 toSetConfiguration:v43 fromPreSUStaging:a14 allowEmpty:0])
                  {
                    goto LABEL_10;
                  }

                  v53 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                  {
                    v92 = v26;
                    if (v91)
                    {
                      v93 = @"replaced what had been";
                    }

                    else
                    {
                      v93 = @"now have";
                    }

                    v94 = [v43 summary];
                    *buf = 138543874;
                    v136 = v22;
                    v137 = 2114;
                    v138 = v93;
                    v26 = v92;
                    v139 = 2114;
                    v140 = v94;
                    _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[LATEST-TO-VEND] %{public}@ latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x20u);
                  }

                  v40 = 1;
LABEL_23:

                  goto LABEL_24;
                }

                v53 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                {
LABEL_22:
                  v40 = 0;
                  goto LABEL_23;
                }

                v54 = [v17 summary];
                *buf = 138543618;
                v136 = v22;
                v137 = 2114;
                v138 = v54;
                v90 = "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] not setting latestAtomicInstanceToVend (same as already latest-to-vend) | setJobDescriptor:%{public}@";
              }

              _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, v90, buf, 0x16u);
LABEL_21:

              goto LABEL_22;
            }

            v53 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v54 = [v53 diag];
            v58 = [NSString alloc];
            v56 = [v17 summary];
            v57 = [v58 initWithFormat:@"{%@} about to adopt as latest-to-vend yet not on filesystem | setJobDescriptor:%@", v22, v56];
          }

          else
          {
            v53 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v54 = [v53 diag];
            v55 = [NSString alloc];
            v56 = [v17 summary];
            v57 = [v55 initWithFormat:@"{%@} no setConfiguration | setJobDescriptor:%@", v22, v56];
          }

          v59 = v57;
          [(__CFString *)v54 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v57 withResult:6103 withError:0];

          goto LABEL_21;
        }
      }

LABEL_25:

      goto LABEL_26;
    }

    if (![v17 isOnFilesystem] || (objc_msgSend(v17, "onFilesystemIncomplete") & 1) != 0)
    {
      v50 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
      [v50 setSafeObject:v17 forKey:v26];

      v51 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
      v52 = [v17 discoveredAtomicInstance];
      [v51 setSafeObject:v17 forKey:v52];

      [(MADAutoAssetControlManager *)self persistSetDescriptorActiveJob:v17 fromLocation:v22];
      v40 = 0;
      goto LABEL_25;
    }

    v61 = 0;
    v130 = 0;
    if (v18 && a10)
    {
      v62 = [v18 clientDomainName];
      v63 = [v18 assetSetIdentifier];
      v130 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v62 forAssetSetIdentifier:v63];

      v64 = [v17 latestDownloadedAtomicInstance];
      v61 = [(MADAutoAssetControlManager *)self shouldAdoptJobFoundAllContent:v22 forJobAtomicInstance:v64 withCurrentSetStatus:v18];
    }

    if (v29)
    {
      v65 = [v17 clientDomainName];
      v66 = [v17 assetSetIdentifier];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByClientDomain:v65 forAssetSetIdentifier:v66 fromLocation:v22];
    }

    if (v134)
    {
      v67 = [v17 discoveredAtomicInstance];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:v67];
    }

    v68 = a12;
    if (v133)
    {
      v69 = [v17 latestDownloadedAtomicInstance];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:v69];
    }

    v131 = v29;
    if (v61)
    {
      v126 = a12;
      v70 = [v18 latestDownloadedAtomicInstance];
      v71 = [v18 latestDowloadedAtomicInstanceEntries];
      v72 = v71;
      if (v70 && v71 && [v71 count])
      {
        v73 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v17];
        v74 = [(MADAutoAssetControlManager *)self setAtomicEntriesRemoveDuplicates:v22 dedupingAtomicEntries:v72];

        v72 = v74;
        v75 = [v130 autoAssetEntries];
        [v17 setRequestedAutoAssetEntries:v75];

        v76 = [v18 catalogCachedAssetSetID];
        [v17 setCatalogCachedAssetSetID:v76];

        v77 = [v18 catalogDownloadedFromLive];
        [v17 setCatalogDownloadedFromLive:v77];

        v78 = [v18 catalogLastTimeChecked];
        [v17 setCatalogLastTimeChecked:v78];

        v79 = [v18 catalogPostedDate];
        [v17 setCatalogPostedDate:v79];

        v80 = [v18 downloadedCatalogCachedAssetSetID];
        [v17 setDownloadedCatalogCachedAssetSetID:v80];

        v81 = [v18 downloadedCatalogDownloadedFromLive];
        [v17 setDownloadedCatalogDownloadedFromLive:v81];

        v82 = [v18 downloadedCatalogLastTimeChecked];
        [v17 setDownloadedCatalogLastTimeChecked:v82];

        v83 = [v18 downloadedCatalogPostedDate];
        [v17 setDownloadedCatalogPostedDate:v83];

        v84 = [v18 newerDiscoveredAtomicEntries];
        [v17 setDiscoveredAtomicEntries:v84];

        [v17 setLatestDownloadedAtomicInstance:v70];
        [v17 setLatestDowloadedAtomicInstanceEntries:v72];
        [v17 setIsOnFilesystem:1];
        [v17 setIsDiscoveredFullyDownloaded:1];
        [v17 setAtomicInstanceDownloadedNotified:0];
        [v17 setNeverBeenLocked:1];
        v85 = [v18 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self _updateCurrentSetStatus:v22 forSetIdentifier:v85 withSetStatus:v18];

        v86 = v73;
        [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v22 forSetDescriptor:v17];
        if (v73)
        {
          v34 = v26;
          [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:v22 toNewStatus:@"UNTRACKED" forAtomicInstance:v86];
        }

        else
        {
          v34 = v26;
          v121 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          [v121 diag];
          v95 = v124 = v70;
          v127 = v72;
          v96 = [NSString alloc];
          v97 = [v17 summary];
          v98 = [v96 initWithFormat:@"{%@} no setAtomicInstance | setJobDescriptor:%@", v22, v97];
          [v95 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v98 withResult:6103 withError:0];

          v72 = v127;
          v86 = 0;

          v70 = v124;
        }

        [(MADAutoAssetControlManager *)self _removeAllUnlockedForOtherAtomicInstances:v17 fromLocation:v22];

        v39 = 0;
        v126 = 356;
      }

      else
      {
        v34 = v26;
        v87 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v87, OS_LOG_TYPE_DEFAULT))
        {
          if (v70)
          {
            v88 = v70;
          }

          else
          {
            v88 = @"N";
          }

          v120 = [v72 count];
          [v17 summary];
          v89 = v123 = v70;
          *buf = 138544130;
          v136 = v22;
          v137 = 2114;
          v138 = v88;
          v139 = 2048;
          v140 = v120;
          v141 = 2114;
          v142 = v89;
          _os_log_impl(&dword_0, v87, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-job current-set-status incomplete | downloadedAtomicInstance:%{public}@ | latestDownloadedEntries:%ld | setJobDescriptor:%{public}@", buf, 0x2Au);

          v70 = v123;
        }

        v39 = 1;
      }

      v68 = v126;
    }

    else
    {
      v34 = v26;
      v39 = 1;
    }

    if ([(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:v22 forSetDescriptor:v17])
    {
      v99 = [v17 discoveredAtomicInstance];
      v100 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v99];

      v101 = [v17 latestDownloadedAtomicInstance];
      v102 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v101];

      v128 = v102;
      if (!v130)
      {
        v103 = [v17 clientDomainName];
        v104 = [v17 assetSetIdentifier];
        v130 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v103 forAssetSetIdentifier:v104];

        v102 = v128;
      }

      v125 = v100;
      if (v100)
      {
        if (!v130 || ([v100 atomicInstanceUUID], v105 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v130, "latestAtomicInstanceToVend"), v106 = objc_claimAutoreleasedReturnValue(), v107 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v105, v106), v106, v100 = v125, v105, v102 = v128, (v107 & 1) == 0))
        {
          v108 = [v100 atomicInstanceUUID];
          [(MADAutoAssetControlManager *)self atomicInstanceRemove:v22 setAtomicInstanceUUID:v108 removingForReason:@"set-descriptor (to be adopted as just-downloaded) discoveredAtomicInstance matches latest-to-vend [nothing new]" historyOperation:1501];
        }
      }

      if (!v102)
      {
        v113 = v130;
LABEL_88:

        goto LABEL_89;
      }

      v109 = [v102 atomicInstanceUUID];
      v110 = v100;
      v111 = v109;
      v112 = [v110 atomicInstanceUUID];
      if (([SUCore stringIsEqual:v111 to:v112]& 1) != 0)
      {

        v102 = v128;
        v113 = v130;
LABEL_86:

        goto LABEL_87;
      }

      if (v130)
      {
        v122 = [v128 atomicInstanceUUID];
        v117 = [v130 latestAtomicInstanceToVend];
        v119 = [SUCore stringIsEqual:v122 to:v117];

        if (v119)
        {
          v102 = v128;
          v113 = v130;
LABEL_87:
          v100 = v125;
          goto LABEL_88;
        }
      }

      else
      {
      }

      v102 = v128;
      v111 = [v128 atomicInstanceUUID];
      [(MADAutoAssetControlManager *)self atomicInstanceRemove:v22 setAtomicInstanceUUID:v111 removingForReason:@"set-descriptor (to be adopted as just-downloaded) downloadedAtomicInstance matches latest-to-vend [nothing new]" historyOperation:1501];
    }

    else
    {
      [(MADAutoAssetControlManager *)self persistSetDescriptorDownloadedJob:v17 fromLocation:v22];
      if (!v68)
      {
        v113 = v130;
LABEL_89:

        goto LABEL_6;
      }

      v125 = [v17 latestDowloadedAtomicInstanceEntries];
      v118 = [v125 count];
      v129 = [v17 clientDomainName];
      [v17 assetSetIdentifier];
      v111 = v114 = v68;
      v115 = [v17 discoveredAtomicInstance];
      v116 = v114;
      v102 = v129;
      [MADAutoAssetHistory recordOperation:v116 toHistoryType:2 fromLayer:1 usageCount:v118 forClientDomainName:v129 forAssetSetIdentifier:v111 forAtomicInstance:v115];
    }

    v113 = v130;
    goto LABEL_86;
  }

  v47 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v48 = [v47 diag];
  v49 = [[NSString alloc] initWithFormat:@"{%@} nil setJobDescriptor", v22];
  [v48 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v49 withResult:6103 withError:0];

  v40 = 0;
LABEL_26:

  return v40;
}

- (void)_logTrackedSetDescriptors:(id)a3 forSetJobDescriptor:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v12 = [v7 summary];
    v13 = 138543874;
    v14 = v11;
    v15 = 2114;
    v16 = v6;
    v17 = 2114;
    v18 = v12;
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_logTrackedSetDescriptors} setJobDesciptor:%{public}@", &v13, 0x20u);
  }
}

- (void)trackDescriptorForgetAssetSelector:(id)a3 forHistoryOperation:(int64_t)a4 firstClientName:(id)a5
{
  v8 = a3;
  v9 = a5;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v14 = [v8 summary];
    *buf = 138543618;
    v55 = v13;
    v56 = 2114;
    v57 = v14;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetSelector} forgetting | assetSelector:%{public}@", buf, 0x16u);
  }

  v15 = [v8 assetType];

  if (v15)
  {
    v16 = [v8 assetSpecifier];

    if (v16)
    {
      v17 = [v8 assetVersion];

      if (v17)
      {
        v18 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v8];
        if (v18)
        {
          v19 = v18;
          if ((a4 - 405) >= 2)
          {
            v20 = 1;
          }

          else
          {
            v20 = 5;
          }
        }

        else
        {
          v26 = [(MADAutoAssetControlManager *)self locateActiveJobDescriptorBySelector:v8];
          if ((a4 - 405) >= 2)
          {
            v20 = 1;
          }

          else
          {
            v20 = 5;
          }

          if (!v26)
          {
            v27 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
            {
              v40 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v41 = [v8 summary];
              *buf = 138543618;
              v55 = v40;
              v56 = 2114;
              v57 = v41;
              _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetSelector} no descriptor for asset-version | assetSelector:%{public}@", buf, 0x16u);
            }

            v19 = 0;
            LOBYTE(v30) = 0;
LABEL_30:

            v42 = [(MADAutoAssetControlManager *)self jobSelectorKey:v8];
            if (v42)
            {
              if ((v30 & 1) != 0 || ![v19 isOnFilesystem])
              {
                goto LABEL_37;
              }

              v43 = [v19 assetId];
              if (v9)
              {
                [MADAutoAssetHistory recordOperation:a4 toHistoryType:0 fromClient:v9 forAssetID:v43 withSelector:v8];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:a4 toHistoryType:0 fromLayer:v20 forAssetID:v43 withSelector:v8];
              }
            }

            else
            {
              v43 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              v44 = [v43 diag];
              v45 = [NSString alloc];
              v46 = [v8 summary];
              v47 = [v45 initWithFormat:@"{trackDescriptorForgetAssetSelector} nil jobSelectorKey | assetSelector:%@", v46];
              [v44 trackAnomaly:@"AUTO-CONTROL" forReason:v47 withResult:6103 withError:0];
            }

LABEL_37:
            v48 = [v8 assetType];
            v49 = [v8 assetSpecifier];
            v50 = [v8 assetVersion];
            [(MADAutoAssetControlManager *)self _logTrackedDescriptors:@"trackDescriptorForgetAssetSelector" forAssetType:v48 withAssetSpecifier:v49 matchingAssetVersion:v50];

            goto LABEL_38;
          }

          v19 = v26;
        }

        v27 = [v8 persistedEntryID];
        v28 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        [v28 removePersistedEntry:v27 fromLocation:@"trackDescriptorForgetAssetSelector"];

        if ([v19 isOnFilesystem])
        {
          v29 = @"DOWNLOADED_DESCRIPTORS";
        }

        else
        {
          v29 = @"JOB_DESCRIPTORS";
        }

        [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"trackDescriptorForgetAssetSelector" forComponentType:v29 removedPersistedEntryID:v27 removedDescriptor:v19 message:@"forget all auto-specific-assets associated with the given asset-selector"];
        LODWORD(v30) = [v19 isOnFilesystem];
        if (v30)
        {
          v31 = [v19 assetId];
          if (v9)
          {
            [MADAutoAssetHistory recordOperation:a4 toHistoryType:0 fromClient:v9 forAssetID:v31 withSelector:v8];
          }

          else
          {
            [MADAutoAssetHistory recordOperation:a4 toHistoryType:0 fromLayer:v20 forAssetID:v31 withSelector:v8];
          }

          if (+[MAAIRBEventReporter isAvailable])
          {
            v32 = [MAAIRBMobileAssetOperationMetadata alloc];
            v33 = [MADAutoAssetHistoryTracker operationName:a4];
            v51 = [(MAAIRBMobileAssetOperationMetadata *)v32 initWithCode:a4 name:v33];

            v52 = [MAAIRBMobileAssetAssetSelector alloc];
            [v8 assetType];
            v34 = v53 = v20;
            v35 = [v8 assetSpecifier];
            v36 = [v8 assetVersion];
            v37 = [(MAAIRBMobileAssetAssetSelector *)v52 initWithAssetType:v34 assetSpecifier:v35 assetVersion:v36];
            LOBYTE(v52) = v30;
            v30 = v37;

            v38 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v51 assetSelector:v30];
            v39 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v38];
            [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v39];

            v20 = v53;
            LOBYTE(v30) = v52;
          }
        }

        goto LABEL_30;
      }

      v19 = [v8 assetType];
      v25 = [v8 assetSpecifier];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:v19 forAssetSpecifier:v25 firstClientName:v9];
    }

    else
    {
      v19 = [v8 assetType];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:v19 firstClientName:v9];
    }
  }

  else
  {
    v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v21 = [v19 diag];
    v22 = [NSString alloc];
    v23 = [v8 summary];
    v24 = [v22 initWithFormat:@"{trackDescriptorForgetAssetSelector} nil assetType | assetSelector:%@", v23];
    [v21 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6103 withError:0];
  }

LABEL_38:
}

- (void)trackDescriptorForgetAssetType:(id)a3 forAssetSpecifier:(id)a4 firstClientName:(id)a5
{
  v8 = a3;
  v9 = a4;
  v82 = a5;
  v92 = self;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543874;
    v109 = v13;
    v110 = 2114;
    v111 = v8;
    v112 = 2114;
    v113 = v9;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} | assetType:%{public}@, assetSpecifier:%{public}@", buf, 0x20u);
  }

  if (!v8 || !v9)
  {
    v57 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v80 = [v57 diag];
    v56 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType:forAssetSpecifier:} missing parameter assetType:%@ assetSpecifier:%@", v8, v9];
    [v80 trackAnomaly:@"AUTO-CONTROL" forReason:v56 withResult:6102 withError:0];
    goto LABEL_60;
  }

  v81 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorForAssetType:v8];
  v101 = 0u;
  v102 = 0u;
  v103 = 0u;
  v14 = v104 = 0u;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v83 = v8;
  v88 = [v14 countByEnumeratingWithState:&v101 objects:v107 count:16];
  v91 = v9;
  if (!v88)
  {
    goto LABEL_27;
  }

  v86 = *v102;
  do
  {
    for (i = 0; i != v88; i = i + 1)
    {
      if (*v102 != v86)
      {
        objc_enumerationMutation(v14);
      }

      v17 = *(*(&v101 + 1) + 8 * i);
      v18 = objc_autoreleasePoolPush();
      v19 = [v14 safeObjectForKey:v17 ofClass:objc_opt_class()];
      v20 = v19;
      if (v19)
      {
        v21 = p_weak_ivar_lyt[223];
        v22 = [v19 assetSpecifier];
        LODWORD(v21) = [v21 stringIsEqual:v22 to:v9];

        if (!v21)
        {
          goto LABEL_25;
        }

        v23 = [MAAutoAssetSelector alloc];
        v24 = [v20 assetType];
        v25 = [v20 assetSpecifier];
        v26 = [v20 assetVersion];
        v27 = [v23 initForAssetType:v24 withAssetSpecifier:v25 matchingAssetVersion:v26];

        v28 = [v27 persistedEntryID];
        v29 = [(MADAutoAssetControlManager *)v92 persistedKnownDescriptors];
        [v29 removePersistedEntry:v28 fromLocation:@"trackDescriptorForgetAssetType"];

        if ([v20 isOnFilesystem])
        {
          v30 = @"DOWNLOADED_DESCRIPTORS";
        }

        else
        {
          v30 = @"JOB_DESCRIPTORS";
        }

        [(MADAutoAssetControlManager *)v92 _logPersistedRemovedEntry:@"trackDescriptorForgetAssetType" forComponentType:v30 removedPersistedEntryID:v28 removedDescriptor:v20 message:@"forget all descriptors for the asset-type + asset-specifier"];
        if ([v20 isOnFilesystem])
        {
          v31 = [v20 assetId];
          if (v82)
          {
            [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v82 forAssetID:v31 withSelector:v27];
          }

          else
          {
            [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:v31 withSelector:v27];
          }

          if (+[MAAIRBEventReporter isAvailable])
          {
            v33 = [MAAIRBMobileAssetOperationMetadata alloc];
            v34 = [MADAutoAssetHistoryTracker operationName:300];
            v84 = [(MAAIRBMobileAssetOperationMetadata *)v33 initWithCode:300 name:v34];

            v35 = [MAAIRBMobileAssetAssetSelector alloc];
            v36 = [v27 assetType];
            v37 = [v27 assetSpecifier];
            v38 = [v27 assetVersion];
            v39 = [(MAAIRBMobileAssetAssetSelector *)v35 initWithAssetType:v36 assetSpecifier:v37 assetVersion:v38];

            v40 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v84 assetSelector:v39];
            v41 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v40];
            [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v41];

            v8 = v83;
          }

          [v81 setSafeObject:v20 forKey:v28];
        }

        v9 = v91;
      }

      else
      {
        v27 = [(MADAutoAssetControlManager *)v92 autoControlManagerFSM];
        v28 = [v27 diag];
        v32 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType:forAssetSpecifier:} unable to load descriptor | assetType:%@, assetSpecifier:%@", v8, v9];
        [v28 trackAnomaly:@"AUTO-CONTROL" forReason:v32 withResult:6103 withError:0];
      }

      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
LABEL_25:

      objc_autoreleasePoolPop(v18);
    }

    v88 = [v14 countByEnumeratingWithState:&v101 objects:v107 count:16];
  }

  while (v88);
LABEL_27:

  v89 = objc_alloc_init(NSMutableDictionary);
  v97 = 0u;
  v98 = 0u;
  v99 = 0u;
  v100 = 0u;
  v42 = v14;
  v43 = [v42 countByEnumeratingWithState:&v97 objects:v106 count:16];
  v87 = v42;
  if (v43)
  {
    v44 = v43;
    v45 = *v98;
    do
    {
      for (j = 0; j != v44; j = j + 1)
      {
        if (*v98 != v45)
        {
          objc_enumerationMutation(v42);
        }

        v47 = *(*(&v97 + 1) + 8 * j);
        v48 = objc_autoreleasePoolPush();
        v49 = [v42 safeObjectForKey:v47 ofClass:objc_opt_class()];
        v50 = [v49 assetType];
        if (([SUCore stringIsEqual:v50 to:v8]& 1) != 0)
        {
          v51 = [v49 assetSpecifier];
          v52 = [SUCore stringIsEqual:v51 to:v91];

          v8 = v83;
          if (v52)
          {
            v53 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
            {
              v54 = [(MADAutoAssetControlManager *)v92 _updateLatestSummary];
              v55 = [v49 summary];
              *buf = 138543618;
              v109 = v54;
              v110 = 2114;
              v111 = v55;
              _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} removing from downloadedDescriptorsBySelector | forgetDescriptor:%{public}@", buf, 0x16u);

              v8 = v83;
            }

            [(MADAutoAssetControlManager *)v92 _statsIncrementRemovedForDescriptor:v49];
            [v89 setSafeObject:v49 forKey:v47];
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v48);
        v42 = v87;
      }

      v44 = [v87 countByEnumeratingWithState:&v97 objects:v106 count:16];
    }

    while (v44);
  }

  v95 = 0u;
  v96 = 0u;
  v93 = 0u;
  v94 = 0u;
  v56 = v89;
  v9 = v91;
  v57 = v81;
  v90 = [v56 countByEnumeratingWithState:&v93 objects:v105 count:16];
  if (v90)
  {
    v85 = *v94;
    do
    {
      for (k = 0; k != v90; k = k + 1)
      {
        if (*v94 != v85)
        {
          objc_enumerationMutation(v56);
        }

        v59 = *(*(&v93 + 1) + 8 * k);
        v60 = [v56 safeObjectForKey:v59 ofClass:objc_opt_class()];
        v61 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v61, OS_LOG_TYPE_DEFAULT))
        {
          v62 = [(MADAutoAssetControlManager *)v92 _updateLatestSummary];
          *buf = 138543618;
          v109 = v62;
          v110 = 2114;
          v111 = v59;
          _os_log_impl(&dword_0, v61, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} removed from downloadedDescriptorsBySelector | jobSelectorKey:%{public}@", buf, 0x16u);
        }

        if ([v60 isOnFilesystem])
        {
          v63 = [v57 safeObjectForKey:v59 ofClass:objc_opt_class()];
          if (!v63)
          {
            v64 = [MAAutoAssetSelector alloc];
            v65 = [v60 assetType];
            v66 = [v60 assetSpecifier];
            v67 = [v60 assetVersion];
            v68 = [v64 initForAssetType:v65 withAssetSpecifier:v66 matchingAssetVersion:v67];

            v69 = [v60 assetId];
            if (v82)
            {
              [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v82 forAssetID:v69 withSelector:v68];
            }

            else
            {
              [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:v69 withSelector:v68];
            }

            if (+[MAAIRBEventReporter isAvailable])
            {
              v70 = [MAAIRBMobileAssetOperationMetadata alloc];
              v71 = [MADAutoAssetHistoryTracker operationName:300];
              v72 = [(MAAIRBMobileAssetOperationMetadata *)v70 initWithCode:300 name:v71];

              v73 = [MAAIRBMobileAssetAssetSelector alloc];
              v74 = [v68 assetType];
              v75 = [v68 assetSpecifier];
              v76 = [v68 assetVersion];
              v77 = [(MAAIRBMobileAssetAssetSelector *)v73 initWithAssetType:v74 assetSpecifier:v75 assetVersion:v76];

              v78 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v72 assetSelector:v77];
              v79 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v78];
              [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v79];
            }

            v8 = v83;
            v57 = v81;
          }

          v9 = v91;
        }
      }

      v90 = [v56 countByEnumeratingWithState:&v93 objects:v105 count:16];
    }

    while (v90);
  }

  [(MADAutoAssetControlManager *)v92 _logTrackedDescriptors:@"trackDescriptorForgetAssetType" forAssetType:v8 withAssetSpecifier:v9 matchingAssetVersion:0];
  v80 = v87;
LABEL_60:
}

- (void)trackDescriptorForgetAssetType:(id)a3 firstClientName:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if (v6)
  {
    v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorForAssetType:v6];
    v74 = objc_alloc_init(NSMutableDictionary);
    v92 = 0u;
    v93 = 0u;
    v94 = 0u;
    v95 = 0u;
    obj = v10;
    v77 = [obj countByEnumeratingWithState:&v92 objects:v102 count:16];
    v80 = v6;
    v73 = v7;
    v83 = self;
    if (v77)
    {
      v75 = *v93;
      do
      {
        for (i = 0; i != v77; i = i + 1)
        {
          if (*v93 != v75)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v92 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          v14 = [obj safeObjectForKey:v12 ofClass:objc_opt_class()];
          if (v14)
          {
            v15 = [MAAutoAssetSelector alloc];
            v16 = [v14 assetType];
            v17 = [v14 assetSpecifier];
            v18 = [v14 assetVersion];
            v19 = [v15 initForAssetType:v16 withAssetSpecifier:v17 matchingAssetVersion:v18];

            v20 = [v19 persistedEntryID];
            v21 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [v21 removePersistedEntry:v20 fromLocation:@"trackDescriptorForgetAssetType"];

            if ([v14 isOnFilesystem])
            {
              v22 = @"DOWNLOADED_DESCRIPTORS";
            }

            else
            {
              v22 = @"JOB_DESCRIPTORS";
            }

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"trackDescriptorForgetAssetType" forComponentType:v22 removedPersistedEntryID:v20 removedDescriptor:v14 message:@"forget all descriptors for the asset-type"];
            if ([v14 isOnFilesystem])
            {
              v23 = [v14 assetId];
              if (v7)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v7 forAssetID:v23 withSelector:v19];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:v23 withSelector:v19];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v25 = [MAAIRBMobileAssetOperationMetadata alloc];
                v26 = [MADAutoAssetHistoryTracker operationName:300];
                v27 = [(MAAIRBMobileAssetOperationMetadata *)v25 initWithCode:300 name:v26];

                v28 = [MAAIRBMobileAssetAssetSelector alloc];
                v29 = [v19 assetType];
                v30 = [v19 assetSpecifier];
                v31 = [v19 assetVersion];
                v32 = [(MAAIRBMobileAssetAssetSelector *)v28 initWithAssetType:v29 assetSpecifier:v30 assetVersion:v31];

                v33 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v27 assetSelector:v32];
                v34 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v33];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v34];

                v7 = v73;
                self = v83;
              }

              [v74 setSafeObject:v14 forKey:v20];
            }

            v6 = v80;
          }

          else
          {
            v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v20 = [v19 diag];
            v24 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType} unable to load descriptor | assetType:%@", v6];
            [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6103 withError:0];
          }

          objc_autoreleasePoolPop(v13);
        }

        v77 = [obj countByEnumeratingWithState:&v92 objects:v102 count:16];
      }

      while (v77);
    }

    v78 = objc_alloc_init(NSMutableDictionary);
    v88 = 0u;
    v89 = 0u;
    v90 = 0u;
    v91 = 0u;
    obja = obj;
    v35 = [obja countByEnumeratingWithState:&v88 objects:v101 count:16];
    if (v35)
    {
      v36 = v35;
      v37 = *v89;
      do
      {
        for (j = 0; j != v36; j = j + 1)
        {
          if (*v89 != v37)
          {
            objc_enumerationMutation(obja);
          }

          v39 = *(*(&v88 + 1) + 8 * j);
          v40 = objc_autoreleasePoolPush();
          v41 = [obja safeObjectForKey:v39 ofClass:objc_opt_class()];
          v42 = [v41 assetType];
          v43 = [SUCore stringIsEqual:v42 to:v6];

          self = v83;
          if (v43)
          {
            v44 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
            {
              v45 = [(MADAutoAssetControlManager *)v83 _updateLatestSummary];
              v46 = [v41 summary];
              *buf = 138543618;
              v98 = v45;
              v99 = 2114;
              v100 = v46;
              _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:} removing from downloadedDescriptorsBySelector | forgetDescriptor:%{public}@", buf, 0x16u);

              self = v83;
            }

            [(MADAutoAssetControlManager *)self _statsIncrementRemovedForDescriptor:v41];
            [v78 setSafeObject:v41 forKey:v39];
            v6 = v80;
          }

          objc_autoreleasePoolPop(v40);
        }

        v36 = [obja countByEnumeratingWithState:&v88 objects:v101 count:16];
      }

      while (v36);
    }

    v86 = 0u;
    v87 = 0u;
    v84 = 0u;
    v85 = 0u;
    v47 = v78;
    v48 = [v47 countByEnumeratingWithState:&v84 objects:v96 count:16];
    if (v48)
    {
      v49 = v48;
      v50 = *v85;
      v79 = *v85;
      do
      {
        for (k = 0; k != v49; k = k + 1)
        {
          if (*v85 != v50)
          {
            objc_enumerationMutation(v47);
          }

          v52 = *(*(&v84 + 1) + 8 * k);
          v53 = [v47 safeObjectForKey:v52 ofClass:objc_opt_class()];
          if ([v53 isOnFilesystem])
          {
            v54 = [v74 safeObjectForKey:v52 ofClass:objc_opt_class()];
            if (!v54)
            {
              v55 = [MAAutoAssetSelector alloc];
              v56 = [v53 assetType];
              v57 = [v53 assetSpecifier];
              v58 = [v53 assetVersion];
              v59 = [v55 initForAssetType:v56 withAssetSpecifier:v57 matchingAssetVersion:v58];

              v60 = [v53 assetId];
              if (v73)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v73 forAssetID:v60 withSelector:v59];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:v60 withSelector:v59];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v61 = [MAAIRBMobileAssetOperationMetadata alloc];
                v62 = [MADAutoAssetHistoryTracker operationName:300];
                v76 = [(MAAIRBMobileAssetOperationMetadata *)v61 initWithCode:300 name:v62];

                v63 = [MAAIRBMobileAssetAssetSelector alloc];
                v64 = [v59 assetType];
                v65 = [v59 assetSpecifier];
                v66 = [v59 assetVersion];
                v67 = [(MAAIRBMobileAssetAssetSelector *)v63 initWithAssetType:v64 assetSpecifier:v65 assetVersion:v66];

                v68 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v76 assetSelector:v67];
                v69 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v68];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v69];
              }

              self = v83;
              v50 = v79;
            }
          }
        }

        v49 = [v47 countByEnumeratingWithState:&v84 objects:v96 count:16];
      }

      while (v49);
    }

    v6 = v80;
    [(MADAutoAssetControlManager *)self _logTrackedDescriptors:@"trackDescriptorForgetAssetType(done)" forAssetType:v80 withAssetSpecifier:0 matchingAssetVersion:0];

    v7 = v73;
  }

  else
  {
    v70 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v71 = [v70 diag];
    v72 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType} nil assetType"];
    [v71 trackAnomaly:@"AUTO-CONTROL" forReason:v72 withResult:6103 withError:0];
  }
}

- (void)_trackActiveDescriptor:(id)a3 operation:(id)a4 usingSelector:(id)a5 withJobUUID:(id)a6 triggeredByClientMessage:(id)a7 downloadingDescriptor:(id)a8 baseForPatchDescriptor:(id)a9 message:(id)a10
{
  v49 = a3;
  v16 = a4;
  v17 = a5;
  v18 = a6;
  v19 = a7;
  v20 = a8;
  v21 = a9;
  v22 = a10;
  v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v24 = [v23 extendedStateQueue];
  dispatch_assert_queue_V2(v24);

  v48 = v16;
  v25 = [v16 isEqualToString:@"ENTRY_ADD"];
  if (v20 || (v25 & 1) != 0)
  {
    v28 = [v17 persistedEntryID];
    v29 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v30 = [v29 persistedEntry:v28 fromLocation:v49];

    if (v30)
    {
      if (v19)
      {
        [v30 persistSecureCodedObject:v19 forKey:@"clientRequestMessage"];
      }

      if (v17)
      {
        [v30 persistSecureCodedObject:v17 forKey:@"assetSelector"];
      }

      if (v18)
      {
        [v30 persistString:v18 forKey:@"autoAssetUUID"];
      }

      if (!v20)
      {
        v20 = [[MADAutoAssetDescriptor alloc] initBlankEntry];
      }

      v44 = v17;
      v46 = v18;
      [v30 persistSecureCodedObject:v20 forKey:@"assetDescriptor"];
      v31 = v19;
      if (v21)
      {
        [v30 persistSecureCodedObject:v21 forKey:@"baseForPatchDescriptor"];
      }

      else
      {
        v34 = [[MADAutoAssetDescriptor alloc] initBlankEntry];
        [v30 persistSecureCodedObject:v34 forKey:@"baseForPatchDescriptor"];
      }

      v35 = v21;
      v36 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v37 = [v20 summary];
      v38 = v28;
      [v36 storePersistedEntry:v28 withEntrySummary:v37 fromLocation:v49];

      v39 = v35;
      v16 = v48;
      v19 = v31;
      v40 = v31;
      v18 = v46;
      [(MADAutoAssetControlManager *)self _logPersistedEntry:v49 forComponentType:@"ACTIVE-JOBS" operation:v48 forPersistedEntryID:v38 forClientRequest:v40 withJobUUID:v46 withAssetDescriptor:v20 baseForPatchDescriptor:v35 message:v22];
      v17 = v44;
      goto LABEL_35;
    }

    v32 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
LABEL_34:
      v41 = v32;
      v39 = v21;

      v38 = v28;
      v16 = v48;
LABEL_35:

      v21 = v39;
      goto LABEL_36;
    }

    v47 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v45 = [v17 summary];
    if (v19)
    {
      v43 = [v19 messageName];
      if (v20)
      {
        goto LABEL_20;
      }
    }

    else
    {
      v43 = @"N";
      if (v20)
      {
LABEL_20:
        v42 = [v20 summary];
        if (v21)
        {
LABEL_21:
          v33 = [v21 summary];
LABEL_27:
          *buf = 138544898;
          v51 = v47;
          v52 = 2114;
          v53 = v49;
          v54 = 2114;
          v55 = v45;
          v56 = 2114;
          v57 = v18;
          v58 = 2114;
          v59 = v43;
          v60 = 2114;
          v61 = v42;
          v62 = 2114;
          v63 = v33;
          _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:_trackActiveDescriptor} unable to create active persisted-state for selector:%{public}@ JobUUID:%{public}@ message:%{public}@ downloadingDescriptor:%{public}@ baseForPatchDescriptor:%{public}@", buf, 0x48u);
          if (v21)
          {
          }

          if (v20)
          {
          }

          if (v19)
          {
          }

          goto LABEL_34;
        }

LABEL_26:
        v33 = @"N";
        goto LABEL_27;
      }
    }

    v42 = @"N";
    if (v21)
    {
      goto LABEL_21;
    }

    goto LABEL_26;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    v26 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v27 = [v17 summary];
    *buf = 138544130;
    v51 = v26;
    v52 = 2114;
    v53 = v49;
    v54 = 2114;
    v55 = v27;
    v56 = 2114;
    v57 = v18;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_trackActiveDescriptor} early active-descriptor non-add tracking [before downloading] - not recording to active-job persisted-state for selector:%{public}@ JobUUID:%{public}@", buf, 0x2Au);
  }

LABEL_36:
}

- (void)_logTrackedDescriptors:(id)a3 forAssetType:(id)a4 withAssetSpecifier:(id)a5 matchingAssetVersion:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MAAutoAssetSelector alloc];
  if (v12 && v13)
  {
    v17 = [v16 initForAssetType:v11 withAssetSpecifier:v12 matchingAssetVersion:v13];
  }

  else if (v12)
  {
    v17 = [v16 initForAssetType:v11 withAssetSpecifier:v12];
  }

  else
  {
    v17 = [v16 initForAssetType:v11];
  }

  v18 = v17;
  v19 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:v10 assetSelector:v17 limitedToStaging:0];
  v20 = v19;
  v61 = v19;
  v62 = v18;
  if (v13)
  {
    v65 = 0u;
    v66 = 0u;
    v63 = 0u;
    v64 = 0u;
    v21 = v19;
    v22 = [v21 countByEnumeratingWithState:&v63 objects:v87 count:16];
    if (v22)
    {
      v23 = v22;
      v58 = self;
      v59 = v13;
      v60 = v12;
      v24 = *v64;
      v25 = @"missing";
      while (2)
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v64 != v24)
          {
            objc_enumerationMutation(v21);
          }

          v27 = *(*(&v63 + 1) + 8 * i);
          v28 = objc_autoreleasePoolPush();
          v29 = [v21 safeObjectForKey:v27 ofClass:objc_opt_class()];
          if (v29)
          {

            objc_autoreleasePoolPop(v28);
            v25 = @"present";
            goto LABEL_47;
          }

          objc_autoreleasePoolPop(v28);
        }

        v23 = [v21 countByEnumeratingWithState:&v63 objects:v87 count:16];
        if (v23)
        {
          continue;
        }

        goto LABEL_47;
      }
    }

    v25 = @"missing";
    goto LABEL_48;
  }

  if (v12)
  {
    v55 = v10;
    v21 = [[NSMutableString alloc] initWithString:@"versionsOfSpecifier:"];
    v67 = 0u;
    v68 = 0u;
    v69 = 0u;
    v70 = 0u;
    v30 = v20;
    v31 = [v30 countByEnumeratingWithState:&v67 objects:v88 count:16];
    if (v31)
    {
      v32 = v31;
      v58 = self;
      v59 = 0;
      v60 = v12;
      v56 = v11;
      v33 = 0;
      v34 = *v68;
      do
      {
        for (j = 0; j != v32; j = j + 1)
        {
          if (*v68 != v34)
          {
            objc_enumerationMutation(v30);
          }

          v36 = *(*(&v67 + 1) + 8 * j);
          v37 = objc_autoreleasePoolPush();
          v38 = [v30 safeObjectForKey:v36 ofClass:objc_opt_class()];
          v39 = v38;
          if (v38)
          {
            v40 = [v38 assetVersion];
            v41 = v40;
            if (v33)
            {
              [v21 appendFormat:@", %@", v40];
            }

            else
            {
              [v21 appendString:v40];
            }

            v33 = 1;
          }

          objc_autoreleasePoolPop(v37);
        }

        v32 = [v30 countByEnumeratingWithState:&v67 objects:v88 count:16];
      }

      while (v32);

      if (v33)
      {
        v25 = v21;
      }

      else
      {
        v25 = @"descriptorsOfAssetType(missing)";
      }

      v10 = v55;
      v11 = v56;
LABEL_47:
      v13 = v59;
      v12 = v60;
      self = v58;
      goto LABEL_48;
    }

    v25 = @"descriptorsOfAssetType(missing)";
LABEL_48:

    goto LABEL_49;
  }

  v57 = v11;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"locateDownloadedNewAllBySelector"];
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  v42 = v20;
  v43 = [v42 countByEnumeratingWithState:&v71 objects:v89 count:16];
  if (v43)
  {
    v44 = v43;
    v45 = 0;
    v46 = *v72;
    do
    {
      for (k = 0; k != v44; k = k + 1)
      {
        if (*v72 != v46)
        {
          objc_enumerationMutation(v42);
        }

        v48 = *(*(&v71 + 1) + 8 * k);
        v49 = objc_autoreleasePoolPush();
        v50 = [v42 safeObjectForKey:v48 ofClass:objc_opt_class()];
        if (v50)
        {
          ++v45;
        }

        objc_autoreleasePoolPop(v49);
      }

      v44 = [v42 countByEnumeratingWithState:&v71 objects:v89 count:16];
    }

    while (v44);
  }

  else
  {
    v45 = 0;
  }

  v25 = [[NSString alloc] initWithFormat:@"descriptorsOfAssetType:%ld", v45];
  v11 = v57;
  v13 = 0;
  v12 = 0;
LABEL_49:
  v51 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
  {
    v52 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138544642;
    v53 = @"N";
    v76 = v52;
    if (v12)
    {
      v54 = v12;
    }

    else
    {
      v54 = @"N";
    }

    v77 = 2114;
    if (v13)
    {
      v53 = v13;
    }

    v78 = v10;
    v79 = 2114;
    v80 = v11;
    v81 = 2114;
    v82 = v54;
    v83 = 2114;
    v84 = v53;
    v85 = 2114;
    v86 = v25;
    _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_logTrackedDescriptors} assetType:%{public}@, assetSpecifier:%{public}@, assetVersion:%{public}@ | downloadedBySelector:%{public}@", buf, 0x3Eu);
  }
}

- (BOOL)jobDescriptorOnFilesystemValidated:(id)a3 forOSBuild:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  if ([v6 isOnFilesystem])
  {
    v10 = [MADAutoAssetControlManager localAssetURLForDescriptor:v6 fromLocation:@"jobDescriptorOnFilesystemValidated"];
    if (v10 && [(MADAutoAssetControlManager *)self filesystemDoesFileExist:@"jobDescriptorOnFilesystemValidated" atPath:v10])
    {
      if (!v7 || !+[MADAutoAssetSecure isCodeAsset:forDescriptor:](MADAutoAssetSecure, "isCodeAsset:forDescriptor:", @"jobDescriptorOnFilesystemValidated", v6) || ([v6 wasBuiltForOSBuild:v7] & 1) != 0)
      {
        v11 = 1;
LABEL_13:

        goto LABEL_14;
      }

      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v14 = [v6 assetBuild];
        v16 = [v6 summary];
        v17 = 138544386;
        v18 = v13;
        v19 = 2114;
        v20 = v7;
        v21 = 2114;
        v22 = v14;
        v23 = 2114;
        v24 = v16;
        v25 = 2114;
        v26 = v10;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {jobDescriptorOnFilesystemValidated} SMAC for different OS-build | osBuild:%{public}@ | assetBuild:%{public}@ | jobDescriptor:%{public}@ | localURLForDescriptor:%{public}@", &v17, 0x34u);

        goto LABEL_11;
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        v13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v14 = [v6 summary];
        v17 = 138543874;
        v18 = v13;
        v19 = 2114;
        v20 = v14;
        v21 = 2114;
        v22 = v10;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {jobDescriptorOnFilesystemValidated} asset file does not exist | jobDescriptor:%{public}@ | localURLForDescriptor:%{public}@", &v17, 0x20u);
LABEL_11:
      }
    }

    v11 = 0;
    goto LABEL_13;
  }

  v11 = 0;
LABEL_14:

  return v11;
}

+ (BOOL)jobDescriptorOnFilesystemConfirmed:(id)a3
{
  v3 = a3;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  v5 = [v4 autoControlManagerFSM];

  if (v5)
  {
    v6 = [v4 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __65__MADAutoAssetControlManager_jobDescriptorOnFilesystemConfirmed___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = v3;
    dispatch_sync(v7, block);

    v8 = *(v17 + 24);
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{jobDescriptorOnFilesystemConfirmed} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = *(v17 + 24);
  }

  _Block_object_dispose(&v16, 8);

  return v8 & 1;
}

id __65__MADAutoAssetControlManager_jobDescriptorOnFilesystemConfirmed___block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) jobDescriptorOnFilesystemValidated:*(a1 + 40)];
  *(*(*(a1 + 48) + 8) + 24) = result;
  return result;
}

- (BOOL)jobDescriptorInFlightNowOnFilesystem:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if ([v4 isOnFilesystem])
  {
    v7 = [(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:v4];
  }

  else if (([v4 isBlankEntry] & 1) != 0 || (objc_msgSend(v4, "assetId"), v8 = objc_claimAutoreleasedReturnValue(), v8, !v8))
  {
    v7 = 0;
  }

  else
  {
    v9 = [MADAutoAssetControlManager localAssetURLForDescriptor:v4 fromLocation:@"jobDescriptorInFlightNowOnFilesystem"];
    if (v9 && [(MADAutoAssetControlManager *)self filesystemDoesFileExist:@"jobDescriptorInFlightNowOnFilesystem" atPath:v9])
    {
      v7 = 1;
      [v4 setIsOnFilesystem:1];
    }

    else
    {
      v7 = 0;
    }
  }

  return v7;
}

+ (id)fileManagerFailureErrorString
{
  v2 = __error();
  v3 = *v2;
  v4 = strerror(*v2);
  v5 = @"errno[0](no errror information from fileManager)";
  if (v3)
  {
    v6 = v4;
    v7 = [NSString alloc];
    if (v6)
    {
      v8 = [v7 initWithFormat:@"errno[%d](%@)", v3, @"errno[0](no errror information from fileManager)"];
    }

    else
    {
      v8 = [v7 initWithFormat:@"errno[%d](unknown to strerror)", v3, v10];
    }

    v5 = v8;
  }

  return v5;
}

- (void)_eliminatePromotedNeverLocked:(id)a3 forAssetSelector:(id)a4
{
  v67 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v62 = objc_alloc_init(NSMutableArray);
  v9 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_eliminatePromotedNeverLocked" assetSelector:v6 limitedToStaging:0];
  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    v11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v12 = [v9 count];
    v13 = [v6 summary];
    *buf = 138543874;
    v79 = v11;
    v80 = 2048;
    v81 = v12;
    v82 = 2114;
    v83 = v13;
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} reviewing all downloadedDescriptorsBySelector(%ld) | eliminateSelector:%{public}@", buf, 0x20u);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_eliminatePromotedNeverLocked" ofContainer:@"locateDownloadedNewAllBySelector"];
  v74 = 0u;
  v75 = 0u;
  v72 = 0u;
  v73 = 0u;
  v14 = v9;
  v15 = [v14 countByEnumeratingWithState:&v72 objects:v77 count:16];
  v63 = v6;
  v64 = v14;
  if (v15)
  {
    v16 = v15;
    obj = *v73;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v73 != obj)
        {
          objc_enumerationMutation(v14);
        }

        v18 = *(*(&v72 + 1) + 8 * i);
        v19 = objc_autoreleasePoolPush();
        v20 = [v14 safeObjectForKey:v18 ofClass:objc_opt_class()];
        v21 = v20;
        if (v20)
        {
          v22 = [v20 assetType];
          v23 = [v21 assetSpecifier];
          v24 = [(MADAutoAssetControlManager *)self _doesEliminateSelector:v6 matchAssetType:v22 withAssetSpecifier:v23 withAssetVersion:0 fromLocation:@"_eliminatePromotedNeverLocked"];

          if (v24 && [v21 stagedPriorToAvailable] && objc_msgSend(v21, "neverBeenLocked"))
          {
            v25 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
            {
              v26 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v27 = [v6 summary];
              v28 = [v21 summary];
              *buf = 138543874;
              v79 = v26;
              v80 = 2114;
              v81 = v27;
              v82 = 2114;
              v83 = v28;
              _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} will eliminate | eliminateSelector:%{public}@, downloadedDescriptor:%{public}@", buf, 0x20u);

              v14 = v64;
            }

            [v62 addObject:v21];
          }

          else
          {
            v29 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
            {
              v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v31 = [v6 summary];
              v32 = [v21 summary];
              *buf = 138543874;
              v79 = v30;
              v80 = 2114;
              v81 = v31;
              v82 = 2114;
              v83 = v32;
              _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} will not eliminate | eliminateSelector:%{public}@, downloadedDescriptor:%{public}@", buf, 0x20u);

              v14 = v64;
            }
          }
        }

        else
        {
          v33 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v34 = [v33 diag];
          v35 = [NSString alloc];
          v36 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v37 = v35;
          v14 = v64;
          v38 = [v37 initWithFormat:@"{_eliminatePromotedNeverLocked} nil downloadedDescriptor on downloadedDescriptorsBySelector for jobSelectorKey:%@ | %@", v18, v36];
          [v34 trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6103 withError:0];

          v6 = v63;
        }

        objc_autoreleasePoolPop(v19);
      }

      v16 = [v14 countByEnumeratingWithState:&v72 objects:v77 count:16];
    }

    while (v16);
  }

  v70 = 0u;
  v71 = 0u;
  v68 = 0u;
  v69 = 0u;
  obja = v62;
  v39 = [obja countByEnumeratingWithState:&v68 objects:v76 count:16];
  if (v39)
  {
    v40 = v39;
    v41 = *v69;
    do
    {
      for (j = 0; j != v40; j = j + 1)
      {
        if (*v69 != v41)
        {
          objc_enumerationMutation(obja);
        }

        v43 = *(*(&v68 + 1) + 8 * j);
        v44 = objc_autoreleasePoolPush();
        v45 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v67];
        v46 = [v45 autoAssetClientName];
        if (v46)
        {
          [v45 autoAssetClientName];
        }

        else
        {
          [v45 clientProcessName];
        }
        v47 = ;

        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"_eliminatePromotedNeverLocked" droppingDescriptor:v43 forHistoryOperation:301 firstClientName:v47];
        objc_autoreleasePoolPop(v44);
      }

      v40 = [obja countByEnumeratingWithState:&v68 objects:v76 count:16];
    }

    while (v40);
  }

  v48 = [v67 clientRequest];
  v49 = [v48 clientReplyCompletion];

  if (v49)
  {
    v50 = [v67 clientRequest];
    v51 = [v50 clientRequestMessage];
    v52 = [MADAutoAssetControlManager replyMessageNameForRequest:v51];
    v53 = [v67 clientRequest];
    v54 = [v53 clientRequestMessage];
    v55 = [v54 clientID];
    v56 = [MADAutoAssetControlManager createSeverMessageWithName:v52 sender:@"com.apple.MAAutoControl" clientID:v55 response:0 error:0];

    v57 = [v67 clientRequest];
    [(MADAutoAssetControlManager *)self issueResponseToClientRequest:v57 issuingResponseMessage:v56 withResponseError:0];
    v58 = v63;
  }

  else
  {
    v56 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v57 = [v56 diag];
    v59 = [NSString alloc];
    v58 = v63;
    v60 = [v63 summary];
    v61 = [v59 initWithFormat:@"{_eliminatePromotedNeverLocked} no client reply completion | eliminateSelector:%@", v60];
    [v57 trackAnomaly:@"AUTO-CONTROL" forReason:v61 withResult:6111 withError:0];
  }
}

- (void)_eliminateBegin:(id)a3 forAssetSelector:(id)a4 limitingToActivity:(BOOL)a5 fromLocation:(id)a6
{
  v7 = a5;
  v10 = a3;
  v11 = a4;
  v12 = a6;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [[NSString alloc] initWithFormat:@"%@:_eliminateBegin", v12];
  v16 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v128 = v11;
  v17 = [v11 persistedEntryID];
  v18 = [v16 safeObjectForKey:v17 ofClass:objc_opt_class()];

  if (v18)
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6113 fromAction:@"_eliminateBegin" withDescription:@"already performing eliminate operation for the specified asset-selector"];

LABEL_3:
    v19 = v128;
    goto LABEL_100;
  }

  v20 = [MADAutoAssetEliminate alloc];
  v21 = [v10 clientRequest];
  v22 = [(MADAutoAssetEliminate *)v20 initWithClientRequest:v21];

  if (!v22)
  {
    if (v7)
    {
      v43 = @"handleClientCancelActivityForSelectorRequest";
    }

    else
    {
      v43 = @"handleClientEliminateAllForSelectorRequest";
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6101 fromAction:v43 withDescription:@"unable to allocate eliminate operation tracking entry"];
    goto LABEL_3;
  }

  v19 = v128;
  v131 = v15;
  v127 = self;
  v121 = v22;
  v119 = v12;
  v120 = v10;
  v118 = v7;
  if (v7)
  {
    goto LABEL_68;
  }

  v23 = [MADAutoAssetLocker lockedSelectorsForEliminate:v128];
  v24 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
  {
    v25 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v26 = [(MADAutoAssetEliminate *)v22 summary];
    *buf = 138543874;
    v154 = v25;
    v155 = 2114;
    v156 = v26;
    v157 = 2048;
    v158 = [v23 count];
    _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminateBegin} | eliminateTracker:%{public}@, lockedEliminateSelectors:%ld", buf, 0x20u);
  }

  v147 = 0u;
  v148 = 0u;
  v145 = 0u;
  v146 = 0u;
  v27 = v23;
  v28 = [v27 countByEnumeratingWithState:&v145 objects:v152 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v146;
    do
    {
      for (i = 0; i != v29; i = i + 1)
      {
        if (*v146 != v30)
        {
          objc_enumerationMutation(v27);
        }

        v32 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v145 + 1) + 8 * i)];
        if ([v32 secureOperationInProgress])
        {
          [v32 setSecureOperationEliminating:1];
          [(MADAutoAssetEliminate *)v22 setAwaitingSecureOperations:[(MADAutoAssetEliminate *)v22 awaitingSecureOperations]+ 1];
        }

        else
        {
          [(MADAutoAssetControlManager *)self secureForceUngraft:v15 forDescriptorBeingRemoved:v32];
          if ([v32 secureOperationEliminating])
          {
            [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:v15 forAutoAssetDescriptor:v32 failingClientRequestForEventInfo:0];
          }
        }
      }

      v29 = [v27 countByEnumeratingWithState:&v145 objects:v152 count:16];
    }

    while (v29);
  }

  v143 = 0u;
  v144 = 0u;
  v141 = 0u;
  v142 = 0u;
  obj = v27;
  v33 = [obj countByEnumeratingWithState:&v141 objects:v151 count:16];
  if (v33)
  {
    v34 = v33;
    v35 = *v142;
    do
    {
      for (j = 0; j != v34; j = j + 1)
      {
        if (*v142 != v35)
        {
          objc_enumerationMutation(obj);
        }

        v37 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v141 + 1) + 8 * j)];
        if ([v37 secureOperationInProgress])
        {
          [v37 setSecureOperationEliminating:1];
          [(MADAutoAssetEliminate *)v22 setAwaitingSecureOperations:[(MADAutoAssetEliminate *)v22 awaitingSecureOperations]+ 1];
        }

        else
        {
          [(MADAutoAssetControlManager *)self secureForceUngraft:v15 forDescriptorBeingRemoved:v37];
          if ([v37 secureOperationEliminating])
          {
            [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:v15 forAutoAssetDescriptor:v37 failingClientRequestForEventInfo:0];
          }
        }
      }

      v34 = [obj countByEnumeratingWithState:&v141 objects:v151 count:16];
    }

    while (v34);
  }

  v19 = v128;
  v38 = [v128 assetType];

  if (v38)
  {
    v39 = [v128 assetSpecifier];

    v40 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v41 = v40;
    if (!v39)
    {
      v45 = [v128 assetType];
      v44 = [v41 persistedEntryIDs:@"_eliminateBegin" assetType:v45];

      goto LABEL_40;
    }

    v42 = [v40 persistedEntryIDs:@"_eliminateBegin" assetSelector:v128];
  }

  else
  {
    v41 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v42 = [v41 persistedEntryIDs:@"_eliminateBegin"];
  }

  v44 = v42;
LABEL_40:

  if (![v44 count])
  {
    goto LABEL_63;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v15 ofContainer:@"persistedKnownDescriptors"];
  v139 = 0u;
  v140 = 0u;
  v137 = 0u;
  v138 = 0u;
  v117 = v44;
  v125 = v44;
  v46 = [v125 countByEnumeratingWithState:&v137 objects:v150 count:16];
  if (!v46)
  {
    goto LABEL_62;
  }

  v47 = v46;
  v48 = *v138;
  v122 = *v138;
  do
  {
    v49 = 0;
    v123 = v47;
    do
    {
      if (*v138 != v48)
      {
        objc_enumerationMutation(v125);
      }

      v50 = *(*(&v137 + 1) + 8 * v49);
      v51 = objc_autoreleasePoolPush();
      v52 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v53 = [v52 persistedEntry:v50 fromLocation:v15];

      if (v53)
      {
        v54 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v55 = [v54 decodeFromLocation:v15 ofEntryName:v50 fromPersistedEntry:v53 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v55)
        {
          goto LABEL_60;
        }

        v56 = [v55 assetType];
        [v55 assetSpecifier];
        v58 = v57 = self;
        v59 = [v55 assetVersion];
        if ([(MADAutoAssetControlManager *)v57 _doesEliminateSelector:v128 matchAssetType:v56 withAssetSpecifier:v58 withAssetVersion:v59 fromLocation:v15])
        {
          v60 = [MADAutoAssetSecure isGraftedOrMounted:v15 forDescriptor:v55];

          if (!v60)
          {
            self = v127;
            v48 = v122;
            v47 = v123;
            goto LABEL_60;
          }

          [v55 setSecureOperationInProgress:1];
          v136 = 0;
          [MADAutoAssetSecure ungraft:v15 forDescriptor:v55 ungraftingError:&v136];
          v56 = v136;
          [v55 setSecureOperationInProgress:0];
          v61 = _MADLog(@"AutoControl");
          v58 = v61;
          if (v56)
          {
            if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
            {
              v59 = [v55 summary];
              v62 = [v56 checkedDescription];
              *buf = 138543874;
              v154 = v131;
              v155 = 2114;
              v156 = v59;
              v157 = 2114;
              v158 = v62;
              _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[ELIMINATE] {%{public}@} ungraft|unmount failure | downloadedDescriptor:%{public}@ | ungraftError:%{public}@", buf, 0x20u);

              goto LABEL_58;
            }

LABEL_59:
            v48 = v122;
            v47 = v123;

            v15 = v131;
            self = v127;
            goto LABEL_60;
          }

          if (!os_log_type_enabled(v61, OS_LOG_TYPE_DEFAULT))
          {
            goto LABEL_59;
          }

          v59 = [v55 summary];
          *buf = 138543618;
          v154 = v131;
          v155 = 2114;
          v156 = v59;
          _os_log_impl(&dword_0, v58, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {%{public}@} ungrafted|unmounted | downloadedDescriptor:%{public}@", buf, 0x16u);
        }

LABEL_58:

        goto LABEL_59;
      }

      v55 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543618;
        v154 = v15;
        v155 = 2114;
        v156 = v50;
        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, "\n[CONSIDER-ELIMINATE] {%{public}@} unable to access asset-descriptor | entryID:%{public}@", buf, 0x16u);
      }

LABEL_60:

      objc_autoreleasePoolPop(v51);
      v49 = v49 + 1;
    }

    while (v47 != v49);
    v47 = [v125 countByEnumeratingWithState:&v137 objects:v150 count:16];
  }

  while (v47);
LABEL_62:

  v19 = v128;
  v22 = v121;
  v44 = v117;
LABEL_63:
  [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:v15 dueToError:0 fullAssetSelector:v19 historyOperationAI:1500 historyOperationSD:392];
  [(MADAutoAssetControlManager *)self _removeAllContentForEliminateTracker:v22 unlessCurrentlyLocked:0];
  v63 = [v19 assetVersion];

  if (!v63)
  {
    [(MADAutoAssetEliminate *)v22 setAwaitingSchedulerAck:1];
    v64 = [v19 persistedEntryID];
    [MADAutoAssetScheduler controlEliminateSelector:v19];
    if (v64)
    {
      v65 = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
      [v65 removeObjectForKey:v64];
    }
  }

LABEL_68:
  v66 = [MAAutoAssetSelector alloc];
  v67 = [v19 assetType];
  v68 = [v19 assetSpecifier];
  v126 = [v66 initForAssetType:v67 withAssetSpecifier:v68];

  v69 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v70 = [v69 copy];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v15 ofContainer:@"currentJobsBySelector"];
  v134 = 0u;
  v135 = 0u;
  v132 = 0u;
  v133 = 0u;
  v71 = v70;
  v72 = [v71 countByEnumeratingWithState:&v132 objects:v149 count:16];
  obja = v71;
  if (!v72)
  {
    goto LABEL_86;
  }

  v73 = v72;
  v74 = *v133;
  while (2)
  {
    v75 = 0;
    while (2)
    {
      if (*v133 != v74)
      {
        objc_enumerationMutation(v71);
      }

      v76 = *(*(&v132 + 1) + 8 * v75);
      v77 = objc_autoreleasePoolPush();
      v78 = [v71 safeObjectForKey:v76 ofClass:objc_opt_class()];
      v79 = v78;
      if (v78 && ([v78 autoAssetSetJob] & 1) == 0)
      {
        v80 = [v79 autoAssetSelector];
        v81 = [v80 assetType];
        v82 = [v19 assetType];
        v83 = [SUCore stringIsEqual:v81 to:v82];

        if (v83)
        {
          v84 = [v19 assetSpecifier];
          if (!v84 || (v85 = v84, [v79 autoAssetSelector], v86 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v86, "assetSpecifier"), v87 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v19, "assetSpecifier"), v88 = objc_claimAutoreleasedReturnValue(), v89 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v87, v88), v88, v19 = v128, v87, v86, v85, v89))
          {
            v90 = [v19 assetVersion];
            v91 = v19;
            if (!v90 || (v92 = v90, [v79 autoAssetSelector], v93 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v93, "assetVersion"), v94 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v91, "assetVersion"), v95 = v74, v96 = v91, v97 = objc_claimAutoreleasedReturnValue(), v124 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v94, v97), v97, v91 = v96, v74 = v95, v94, v93, v92, v124))
            {
              v98 = [(MADAutoAssetEliminate *)v121 activeJobsByUUID];
              v99 = [v79 autoAssetUUID];
              v100 = [v79 autoAssetUUID];
              [v98 setSafeObject:v99 forKey:v100];

              v15 = v131;
              [(MADAutoAssetControlManager *)v127 removeActiveJobForFullSelector:v131 removingFullSelector:v91 alsoRemovingNoVersionSelector:v126];

              [v79 setBeingCanceled:1];
              [v79 cancelAutoAssetJob];
              v126 = 0;
              v19 = v91;
              goto LABEL_83;
            }

            v19 = v91;
          }
        }

        v15 = v131;
LABEL_83:
        v71 = obja;
      }

      objc_autoreleasePoolPop(v77);
      if (v73 != ++v75)
      {
        continue;
      }

      break;
    }

    v73 = [v71 countByEnumeratingWithState:&v132 objects:v149 count:16];
    if (v73)
    {
      continue;
    }

    break;
  }

LABEL_86:

  if (v126)
  {
    [(MADAutoAssetControlManager *)v127 removeActiveJobForFullSelector:v15 removingFullSelector:0 alsoRemovingNoVersionSelector:?];
  }

  if (v118)
  {
    v101 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v19];
    [(MADAutoAssetEliminate *)v121 setAwaitingCancelActivityAck:1];
    [(MADAutoAssetEliminate *)v121 setLimitedToCancelActivity:1];
    v102 = [(MADAutoAssetControlManager *)v127 autoControlManagerFSM];
    [v102 postEvent:@"CancelActivityAck" withInfo:v101];
  }

  else
  {
    [(MADAutoAssetEliminate *)v121 setAwaitingStagerAck:1];
    [(MADAutoAssetControlManager *)v127 ensureStagerFullyResumed];
    [MADAutoAssetStager controlEliminateSelector:v19];
  }

  v12 = v119;
  if ([(MADAutoAssetEliminate *)v121 eliminatingSet])
  {
    v103 = [(MADAutoAssetControlManager *)v127 autoControlManagerFSM];
    v104 = [v103 diag];
    v105 = [NSString alloc];
    v106 = [(MADAutoAssetEliminate *)v121 summary];
    v107 = [v105 initWithFormat:@"{_eliminateBegin} called for set eliminateTracker:%@", v106];
    [v104 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v107 withResult:6103 withError:0];

    v19 = v128;
    v108 = obja;
    goto LABEL_96;
  }

  v109 = [(MADAutoAssetEliminate *)v121 assetSelector];
  v103 = [(MADAutoAssetControlManager *)v127 jobSelectorKey:v109];

  v108 = obja;
  if (v103)
  {
    v110 = [(MADAutoAssetControlManager *)v127 currentStatusBySelector];
    [v110 removeObjectForKey:v103];

    v104 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v104, OS_LOG_TYPE_DEFAULT))
    {
      v111 = [(MADAutoAssetControlManager *)v127 _updateLatestSummary];
      *buf = 138543618;
      v154 = v111;
      v155 = 2114;
      v156 = v103;
      _os_log_impl(&dword_0, v104, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][REMOVED] | eliminateSelectorKey:%{public}@", buf, 0x16u);
    }

LABEL_96:
  }

  v112 = [(MADAutoAssetControlManager *)v127 activelyEliminatingSelectors];
  v113 = [v19 persistedEntryID];
  [v112 setSafeObject:v121 forKey:v113];

  v114 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v114, OS_LOG_TYPE_DEFAULT))
  {
    v115 = [(MADAutoAssetControlManager *)v127 _updateLatestSummary];
    v116 = [(MADAutoAssetEliminate *)v121 summary];
    *buf = 138543618;
    v154 = v115;
    v155 = 2114;
    v156 = v116;
    _os_log_impl(&dword_0, v114, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminateBegin} all elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
  }

  v10 = v120;
LABEL_100:
}

- (void)_removeAllContentForEliminateTracker:(id)a3 unlessCurrentlyLocked:(id)a4
{
  v6 = a3;
  v102 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v98 = objc_alloc_init(NSMutableArray);
  v103 = v6;
  v9 = [v6 assetSelector];
  v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_removeAllContentForEliminateTracker" assetSelector:v9 limitedToStaging:0];
  v113 = self;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeAllContentForEliminateTracker" ofContainer:@"locateDownloadedNewAllBySelector"];
  v134 = 0u;
  v135 = 0u;
  v132 = 0u;
  v133 = 0u;
  obj = v10;
  v109 = v9;
  v104 = [obj countByEnumeratingWithState:&v132 objects:v151 count:16];
  if (v104)
  {
    v101 = 0;
    v11 = *v133;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v99 = *v133;
    while (1)
    {
      v13 = 0;
      do
      {
        if (*v133 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v108 = v13;
        v14 = *(*(&v132 + 1) + 8 * v13);
        context = objc_autoreleasePoolPush();
        v15 = [obj safeObjectForKey:v14 ofClass:objc_opt_class()];
        v16 = v15;
        if (v15)
        {
          v17 = [v15 assetType];
          v18 = [v16 assetSpecifier];
          v19 = [v16 assetVersion];
          v20 = [(MADAutoAssetControlManager *)v113 _doesEliminateSelector:v9 matchAssetType:v17 withAssetSpecifier:v18 withAssetVersion:v19 fromLocation:@"_removeAllContentForEliminateTracker"];

          if (v102 && v20)
          {
            v130 = 0u;
            v131 = 0u;
            v128 = 0u;
            v129 = 0u;
            v111 = v102;
            v116 = [v111 countByEnumeratingWithState:&v128 objects:v150 count:16];
            if (!v116)
            {
              goto LABEL_24;
            }

            v114 = *v129;
            while (1)
            {
              for (i = 0; i != v116; i = i + 1)
              {
                if (*v129 != v114)
                {
                  objc_enumerationMutation(v111);
                }

                v22 = *(*(&v128 + 1) + 8 * i);
                v23 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                {
                  v24 = [(MADAutoAssetControlManager *)v113 _updateLatestSummary];
                  v25 = [v16 summary];
                  [v9 summary];
                  v27 = v26 = p_weak_ivar_lyt;
                  v28 = [v22 summary];
                  *buf = 138544130;
                  v138 = v24;
                  v139 = 2112;
                  v140 = v25;
                  v141 = 2114;
                  v142 = v27;
                  v143 = 2114;
                  v144 = v28;
                  _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} considering whether elimination blocked by lock | downloadedDescriptor:%{oublic}@, eliminateSelector:%{public}@, lockedSelector:%{public}@", buf, 0x2Au);

                  p_weak_ivar_lyt = v26;
                }

                v29 = p_weak_ivar_lyt[223];
                v30 = [v16 assetType];
                v31 = [v22 assetType];
                if (![v29 stringIsEqual:v30 to:v31])
                {
                  goto LABEL_21;
                }

                v32 = p_weak_ivar_lyt[223];
                v33 = [v16 assetSpecifier];
                [v22 assetSpecifier];
                v35 = v34 = p_weak_ivar_lyt;
                if (![v32 stringIsEqual:v33 to:v35])
                {

                  p_weak_ivar_lyt = v34;
LABEL_21:

                  continue;
                }

                v36 = v34[223];
                v37 = [v16 assetVersion];
                v38 = [v22 assetVersion];
                LODWORD(v36) = [v36 stringIsEqual:v37 to:v38];

                v9 = v109;
                p_weak_ivar_lyt = v34;
                if (v36)
                {
                  ++v101;

                  v11 = v99;
                  goto LABEL_28;
                }
              }

              v116 = [v111 countByEnumeratingWithState:&v128 objects:v150 count:16];
              if (!v116)
              {
LABEL_24:

                v11 = v99;
                goto LABEL_27;
              }
            }
          }

          if (v20)
          {
LABEL_27:
            [v98 addObject:v16];
          }
        }

        else
        {
          v39 = [(MADAutoAssetControlManager *)v113 autoControlManagerFSM];
          v40 = [v39 diag];
          v41 = [NSString alloc];
          v42 = [(MADAutoAssetControlManager *)v113 _updateLatestSummary];
          v43 = [v41 initWithFormat:@"{_removeAllContentForEliminateTracker} nil downloadedDescriptor on downloadedDescriptorsBySelector for jobSelectorKey:%@ | %@", v14, v42];
          [v40 trackAnomaly:@"AUTO-CONTROL" forReason:v43 withResult:6103 withError:0];
        }

LABEL_28:

        objc_autoreleasePoolPop(context);
        v13 = v108 + 1;
      }

      while ((v108 + 1) != v104);
      v104 = [obj countByEnumeratingWithState:&v132 objects:v151 count:16];
      if (!v104)
      {
        goto LABEL_32;
      }
    }
  }

  v101 = 0;
LABEL_32:

  v127 = 0u;
  v125 = 0u;
  v126 = 0u;
  v124 = 0u;
  v117 = v98;
  v44 = [v117 countByEnumeratingWithState:&v124 objects:v149 count:16];
  v45 = v103;
  if (v44)
  {
    v46 = v44;
    v47 = *v125;
    do
    {
      for (j = 0; j != v46; j = j + 1)
      {
        if (*v125 != v47)
        {
          objc_enumerationMutation(v117);
        }

        v49 = *(*(&v124 + 1) + 8 * j);
        v50 = objc_autoreleasePoolPush();
        v51 = [v45 clientRequest];
        v52 = [v51 clientRequestMessage];

        v53 = [v52 message];
        v54 = [v53 safeObjectForKey:@"instance" ofClass:objc_opt_class()];
        v55 = [v54 autoAssetClientName];
        if (v55)
        {
          [v54 autoAssetClientName];
        }

        else
        {
          [v54 clientProcessName];
        }
        v56 = ;

        [(MADAutoAssetControlManager *)v113 _removeDescriptorFromFilesystem:@"_removeAllContentForEliminateTracker" droppingDescriptor:v49 forHistoryOperation:300 firstClientName:v56];
        objc_autoreleasePoolPop(v50);
        v45 = v103;
      }

      v46 = [v117 countByEnumeratingWithState:&v124 objects:v149 count:16];
    }

    while (v46);
  }

  v57 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
  {
    v58 = [(MADAutoAssetControlManager *)v113 _updateLatestSummary];
    v59 = [obj count];
    v60 = [v117 count];
    v61 = [v45 summary];
    v62 = [v102 count];
    *buf = 138544642;
    v138 = v58;
    v139 = 2048;
    v140 = v59;
    v141 = 2048;
    v142 = v60;
    v143 = 2048;
    v144 = v101;
    v145 = 2114;
    v146 = v61;
    v147 = 2048;
    v148 = v62;
    _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} reviewed all downloadedDescriptorsBySelector(%ld) | removeDescriptors:%ld | notRemovedStillLocked:%ld | eliminateTracker:%{public}@, lockedEliminateSelectors:%ld", buf, 0x3Eu);
  }

  v63 = [v45 assetSelector];
  v64 = [v63 assetSpecifier];

  v65 = v109;
  if (!v64)
  {
    if ([v102 count])
    {
      v66 = [(MADAutoAssetControlManager *)v113 autoControlManagerFSM];
      v67 = [v66 diag];
      v68 = [[NSString alloc] initWithFormat:@"{_removeAllContentForEliminateTracker} still have locked selectors | lockedEliminateSelectors:%ld", objc_msgSend(v102, "count")];
      [v67 trackAnomaly:@"AUTO-CONTROL" forReason:v68 withResult:6109 withError:0];
LABEL_76:

      goto LABEL_77;
    }

    v69 = [v109 assetType];
    v66 = getAutoLocalUrlFromTypeWithPurpose(v69, 2, @"auto");

    if (v66)
    {
      v67 = +[NSFileManager defaultManager];
      v68 = [v66 path];
      v70 = +[NSFileManager defaultManager];
      v71 = [v70 fileExistsAtPath:v68];

      if (!v71)
      {
        goto LABEL_76;
      }

      v123 = 0;
      v110 = v67;
      v72 = [v67 contentsOfDirectoryAtPath:v68 error:&v123];
      v73 = v123;
      v74 = v68;
      v115 = v68;
      if (v73)
      {
        v75 = [(MADAutoAssetControlManager *)v113 autoControlManagerFSM];
        v76 = [v75 diag];
        v77 = [NSString alloc];
        v78 = [v45 summary];
        v79 = [v77 initWithFormat:@"{_removeAllContentForEliminateTracker} unable to get repo directory | eliminateTracker:%@ | assetDirectory:%@", v78, v68];
        [v76 trackAnomaly:@"AUTO-CONTROL" forReason:v79 withResult:6101 withError:v73];

        goto LABEL_74;
      }

      v121 = 0u;
      v122 = 0u;
      v119 = 0u;
      v120 = 0u;
      v75 = v72;
      v82 = [v75 countByEnumeratingWithState:&v119 objects:v136 count:16];
      if (v82)
      {
        v83 = v82;
        v100 = v72;
        v105 = v66;
        v84 = *v120;
        v85 = v110;
        v112 = v75;
        while (1)
        {
          for (k = 0; k != v83; k = k + 1)
          {
            if (*v120 != v84)
            {
              objc_enumerationMutation(v112);
            }

            v87 = [v74 stringByAppendingPathComponent:*(*(&v119 + 1) + 8 * k)];
            if (!v87)
            {
              v91 = [(MADAutoAssetControlManager *)v113 autoControlManagerFSM];
              v88 = [v91 diag];
              v90 = [[NSString alloc] initWithFormat:@"{_removeAllContentForEliminateTracker} unable to determine local repository path for assetDirectory:%@", v74];
              [v88 trackAnomaly:@"AUTO-CONTROL" forReason:v90 withResult:6101 withError:0];
              goto LABEL_71;
            }

            v88 = [[NSURL alloc] initFileURLWithPath:v87];
            if ([v88 hasDirectoryPath])
            {
              v89 = getControlManager();
              v90 = [v89 getSAFRegistrationBundleID:v88];

              v74 = v115;
            }

            else
            {
              v90 = 0;
            }

            v118 = 0;
            [v85 removeItemAtPath:v87 error:&v118];
            v91 = v118;
            v92 = _MADLog(@"AutoControl");
            v93 = v92;
            if (v91)
            {
              if (os_log_type_enabled(v92, OS_LOG_TYPE_ERROR))
              {
                v94 = [(MADAutoAssetControlManager *)v113 _updateLatestSummary];
                v95 = [v103 summary];
                *buf = 138544130;
                v138 = v94;
                v139 = 2114;
                v140 = v95;
                v141 = 2114;
                v142 = v87;
                v143 = 2114;
                v144 = v91;
                _os_log_impl(&dword_0, v93, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeAllContentForEliminateTracker} unable to remove repo entry (after eliminate-all-for-asset-type) | eliminateTracker:%{public}@ | filename:%{public}@ | error:%{public}@", buf, 0x2Au);

                v85 = v110;
                v74 = v115;
              }
            }

            else
            {
              if (os_log_type_enabled(v92, OS_LOG_TYPE_DEFAULT))
              {
                v96 = [(MADAutoAssetControlManager *)v113 _updateLatestSummary];
                v97 = [v103 summary];
                *buf = 138543874;
                v138 = v96;
                v139 = 2114;
                v140 = v97;
                v141 = 2114;
                v142 = v87;
                _os_log_impl(&dword_0, v93, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} removed repo entry (after eliminate-all-for-asset-type) | eliminateTracker:%{public}@ | removed:%{public}@", buf, 0x20u);

                v85 = v110;
                v74 = v115;
              }

              if (!v90)
              {
                goto LABEL_70;
              }

              v93 = getControlManager();
              [v93 updateSpaceAttributionForBundleID:v90 assetPath:v88 doRegistration:0];
            }

LABEL_70:
            v45 = v103;
LABEL_71:

            v65 = v109;
          }

          v75 = v112;
          v83 = [v112 countByEnumeratingWithState:&v119 objects:v136 count:16];
          if (!v83)
          {
            v66 = v105;
            v72 = v100;
            v73 = 0;
            break;
          }
        }
      }

LABEL_74:
    }

    else
    {
      v110 = [(MADAutoAssetControlManager *)v113 autoControlManagerFSM];
      v80 = [v110 diag];
      v81 = [NSString alloc];
      v73 = [v45 summary];
      v72 = [v81 initWithFormat:@"{_removeAllContentForEliminateTracker} no assetTypeRepoLocation | eliminateTracker:%@", v73];
      v115 = v80;
      [v80 trackAnomaly:@"AUTO-CONTROL" forReason:v72 withResult:6101 withError:0];
    }

    v67 = v110;
    v68 = v115;
    goto LABEL_76;
  }

LABEL_77:
}

- (void)_removeUnlockedForOlderSelectorsWithoutVersion:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if ([v4 foundByLookupWithoutAssetVersion])
  {
    v44 = +[MADAutoAssetLocker copyOfLocksBySelector];
    v7 = [SUCoreRestoreVersion alloc];
    v8 = [v4 assetVersion];
    v48 = [v7 initWithRestoreVersion:v8];

    v43 = objc_alloc_init(NSMutableArray);
    v9 = [MAAutoAssetSelector alloc];
    v10 = [v4 assetType];
    v11 = [v4 assetSpecifier];
    v12 = [v9 initForAssetType:v10 withAssetSpecifier:v11];

    v42 = v12;
    v13 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_removeUnlockedForOlderSelectorsWithoutVersion" assetSelector:v12 limitedToStaging:0];
    v49 = self;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeUnlockedForOlderSelectorsWithoutVersion" ofContainer:@"locateDownloadedNewAllBySelector"];
    v56 = 0u;
    v57 = 0u;
    v54 = 0u;
    v55 = 0u;
    v14 = v13;
    v15 = [v14 countByEnumeratingWithState:&v54 objects:v59 count:16];
    v45 = v4;
    if (v15)
    {
      v16 = v15;
      v17 = *v55;
      do
      {
        for (i = 0; i != v16; i = i + 1)
        {
          if (*v55 != v17)
          {
            objc_enumerationMutation(v14);
          }

          v19 = *(*(&v54 + 1) + 8 * i);
          v20 = objc_autoreleasePoolPush();
          v21 = [v14 safeObjectForKey:v19 ofClass:objc_opt_class()];
          v22 = v21;
          if (v21)
          {
            v23 = [v21 assetVersion];
            v24 = [v4 assetVersion];
            v25 = [SUCore stringIsEqual:v23 to:v24];

            if ((v25 & 1) == 0 && ![(MADAutoAssetControlManager *)v49 _isDownloadedDescriptorPartOfLatestToVend:v22 fromLocation:@"_removeUnlockedForOlderSelectorsWithoutVersion"])
            {
              v26 = [SUCoreRestoreVersion alloc];
              v27 = [v22 assetVersion];
              v28 = [v26 initWithRestoreVersion:v27];

              if ([v28 isComparable:v48] && objc_msgSend(v48, "compare:", v28) == &dword_0 + 1)
              {
                v47 = [MAAutoAssetSelector alloc];
                v46 = [v22 assetType];
                v29 = [v22 assetSpecifier];
                v30 = [v22 assetVersion];
                v31 = [v47 initForAssetType:v46 withAssetSpecifier:v29 matchingAssetVersion:v30];

                v32 = v31;
                v33 = [v31 persistedEntryID];
                v34 = [v44 safeObjectForKey:v33 ofClass:objc_opt_class()];

                if (!v34)
                {
                  [v43 addObject:v22];
                }

                v4 = v45;
              }
            }
          }

          objc_autoreleasePoolPop(v20);
        }

        v16 = [v14 countByEnumeratingWithState:&v54 objects:v59 count:16];
      }

      while (v16);
    }

    v52 = 0u;
    v53 = 0u;
    v50 = 0u;
    v51 = 0u;
    v35 = v43;
    v36 = [v35 countByEnumeratingWithState:&v50 objects:v58 count:16];
    if (v36)
    {
      v37 = v36;
      v38 = *v51;
      do
      {
        for (j = 0; j != v37; j = j + 1)
        {
          if (*v51 != v38)
          {
            objc_enumerationMutation(v35);
          }

          v40 = *(*(&v50 + 1) + 8 * j);
          v41 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)v49 _removeDescriptorFromFilesystem:@"_removeUnlockedForOlderSelectorsWithoutVersion" droppingDescriptor:v40 forHistoryOperation:402 firstClientName:0];
          objc_autoreleasePoolPop(v41);
        }

        v37 = [v35 countByEnumeratingWithState:&v50 objects:v58 count:16];
      }

      while (v37);
    }

    v4 = v45;
  }
}

- (void)_removeDescriptorFromFilesystem:(id)a3 droppingDescriptor:(id)a4 forHistoryOperation:(int64_t)a5 firstClientName:(id)a6
{
  v9 = a4;
  v10 = a6;
  v11 = a3;
  v12 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v13 = [v12 extendedStateQueue];
  dispatch_assert_queue_V2(v13);

  v14 = [[NSString alloc] initWithFormat:@"%@:_removeDescriptorFromFilesystem", v11];
  v15 = [MAAutoAssetSelector alloc];
  v16 = [v9 assetType];
  v17 = [v9 assetSpecifier];
  v18 = [v9 assetVersion];
  v19 = [v15 initForAssetType:v16 withAssetSpecifier:v17 matchingAssetVersion:v18];

  v20 = [MADAutoAssetControlManager localAssetURLForDescriptor:v9 fromLocation:v14];
  if ([MADAutoAssetSecure isSecureAsset:v14 forDescriptor:v9])
  {
    [(MADAutoAssetControlManager *)self secureForceUngraft:v14 forDescriptorBeingRemoved:v9];
    [MADAutoAssetSecure depersonalizeIfSecure:v14 forDescriptor:v9];
  }

  if (v20)
  {
    v39 = v19;
    v40 = v10;
    v21 = [[NSURL alloc] initFileURLWithPath:v20];
    v22 = [v21 path];
    v23 = [(MADAutoAssetControlManager *)self filesystemDoesFileExist:v14 atPath:v22];

    if (v23)
    {
      v24 = getControlManager();
      v25 = [v24 getSAFRegistrationBundleID:v21];

      v41 = 0;
      renameWithExtThenRemoveExposeError(v20, @".purged", &v41);
      v26 = v41;
    }

    else
    {
      v30 = [[NSString alloc] initWithFormat:@"dropping descriptor when no item exists at path:%@", v20];
      v26 = [MAAutoAssetError buildError:6110 fromOperation:v14 underlyingError:0 withDescription:v30];

      v25 = 0;
    }

    v31 = _MADLog(@"AutoControl");
    v32 = v31;
    if (v26)
    {
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
      {
        v33 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v34 = [v9 summary];
        v35 = [MADAutoAssetClientRequest responseErrorSummary:v26];
        *buf = 138544130;
        v43 = v33;
        v44 = 2114;
        v45 = v14;
        v46 = 2114;
        v47 = v34;
        v48 = 2114;
        v49 = v35;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to remove from filesystem | dropDescriptor:%{public}@, error:%{public}@", buf, 0x2Au);
      }
    }

    else
    {
      if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
      {
        v36 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v37 = [v9 summary];
        *buf = 138543874;
        v43 = v36;
        v44 = 2114;
        v45 = v14;
        v46 = 2114;
        v47 = v37;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} removed from filesystem | dropDescriptor:%{public}@ ", buf, 0x20u);
      }

      [(MADAutoAssetControlManager *)self _statsIncrementRemovedForDescriptor:v9];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetSelector:v39 forHistoryOperation:a5 firstClientName:v40];
      v32 = getControlManager();
      [v32 updateSpaceAttributionForBundleID:v25 assetPath:v21 doRegistration:0];
    }

    v19 = v39;
    v10 = v40;
  }

  else
  {
    v27 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v28 = [v27 diag];
    v29 = [[NSString alloc] initWithFormat:@"{%@} unable to determine local URL for descriptor:%@", v14, v9];
    [v28 trackAnomaly:@"AUTO-CONTROL" forReason:v29 withResult:6101 withError:0];
  }
}

- (void)_removeAllUnlockedForOtherAtomicInstances:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v74 = v7;
  v10 = [[NSString alloc] initWithFormat:@"%@:_removeAllUnlockedForOtherAtomicInstances", v7];
  [(MADAutoAssetControlManager *)self _reclaimDownloadedDescriptorsWhenJustDownloaded:v6 fromLocation:v10];
  v11 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v12 = [v11 persistedEntryIDs:v10];

  if ([v12 count])
  {
    v79 = v6;
    v80 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"persistedDownloadedSetDescriptors"];
    v96 = 0u;
    v97 = 0u;
    v94 = 0u;
    v95 = 0u;
    v73 = v12;
    obj = v12;
    v13 = [obj countByEnumeratingWithState:&v94 objects:v107 count:16];
    v84 = v10;
    v85 = self;
    if (!v13)
    {
      goto LABEL_35;
    }

    v14 = v13;
    v15 = *v95;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v77 = *v95;
    while (1)
    {
      v17 = 0;
      v82 = v14;
      do
      {
        if (*v95 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v18 = *(*(&v94 + 1) + 8 * v17);
        v19 = objc_autoreleasePoolPush();
        v20 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        [v20 persistedEntry:v18 fromLocation:v10];
        v22 = v21 = self;

        if (v18)
        {
          v23 = v22 == 0;
        }

        else
        {
          v23 = 1;
        }

        if (!v23)
        {
          v28 = [(MADAutoAssetControlManager *)v21 persistedDownloadedSetDescriptors];
          v29 = [v28 decodeFromLocation:v10 ofEntryName:v18 fromPersistedEntry:v22 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (!v29)
          {
            v44 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
            {
              v45 = [(MADAutoAssetControlManager *)v85 _updateLatestSummary];
              *buf = 138543874;
              v100 = v45;
              v101 = 2114;
              v102 = v10;
              v103 = 2114;
              v104 = v18;
              _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "[%{public}@]\n[REMOVAL] {%{public}@} unable to load set-descriptor | entryID:%{public}@", buf, 0x20u);

              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            }

            [v80 addObject:v18];
            goto LABEL_32;
          }

          context = v19;
          v30 = p_weak_ivar_lyt[223];
          [v29 clientDomainName];
          v32 = v31 = p_weak_ivar_lyt;
          v33 = [v79 clientDomainName];
          if ([v30 stringIsEqual:v32 to:v33])
          {
            v34 = v31[223];
            v35 = [v29 assetSetIdentifier];
            v36 = [v79 assetSetIdentifier];
            v76 = v35;
            if ([v34 stringIsEqual:v35 to:v36])
            {
              v37 = [v29 latestDownloadedAtomicInstance];
              v38 = [v79 latestDownloadedAtomicInstance];
              v75 = [SUCore stringIsEqual:v37 to:v38];

              v10 = v84;
              v15 = v77;
              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              v19 = context;
              if ((v75 & 1) == 0 && ![(MADAutoAssetControlManager *)v85 setDescriptorLocked:v29])
              {
                v39 = [NSString alloc];
                v40 = [v79 summary];
                v41 = [v39 initWithFormat:@"older set-descriptor found - dropped setDescriptor:%@", v40];

                v42 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
                {
                  v43 = [(MADAutoAssetControlManager *)v85 _updateLatestSummary];
                  *buf = 138544130;
                  v100 = v43;
                  v101 = 2114;
                  v102 = v84;
                  v103 = 2114;
                  v104 = v41;
                  v105 = 2114;
                  v106 = v18;
                  _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} %{public}@ | entryID:%{public}@", buf, 0x2Au);
                }

                [v80 addObject:v18];
                v15 = v77;
                p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              }

              goto LABEL_32;
            }

            v10 = v84;
            v15 = v77;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          }

          else
          {

            v10 = v84;
            v15 = v77;
            p_weak_ivar_lyt = v31;
          }

          v19 = context;
LABEL_32:

          v14 = v82;
          goto LABEL_33;
        }

        v24 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
        {
          v25 = [(MADAutoAssetControlManager *)v85 _updateLatestSummary];
          v26 = v25;
          *buf = 138543874;
          v27 = @"N";
          if (v18)
          {
            v27 = v18;
          }

          v100 = v25;
          v101 = 2114;
          v102 = v10;
          v103 = 2114;
          v104 = v27;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@]\n[REMOVAL] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
        }

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v18)
        {
          [v80 addObject:v18];
        }

LABEL_33:

        objc_autoreleasePoolPop(v19);
        v17 = v17 + 1;
        self = v85;
      }

      while (v14 != v17);
      v14 = [obj countByEnumeratingWithState:&v94 objects:v107 count:16];
      if (!v14)
      {
LABEL_35:

        v92 = 0u;
        v93 = 0u;
        v90 = 0u;
        v91 = 0u;
        v46 = v80;
        v6 = v79;
        v83 = [v46 countByEnumeratingWithState:&v90 objects:v98 count:16];
        if (!v83)
        {
          goto LABEL_52;
        }

        v81 = *v91;
        v78 = v46;
        while (1)
        {
          for (i = 0; i != v83; i = i + 1)
          {
            if (*v91 != v81)
            {
              objc_enumerationMutation(v78);
            }

            v48 = *(*(&v90 + 1) + 8 * i);
            contexta = objc_autoreleasePoolPush();
            v49 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v50 = [v49 persistedEntry:v48 fromLocation:v10];

            v51 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            obja = v50;
            v52 = [v51 decodeFromLocation:v10 ofEntryName:v48 fromPersistedEntry:v50 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            v53 = [v6 clientDomainName];
            v54 = [v6 assetSetIdentifier];
            v55 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:v53 forAssetSetIdentifier:v54];

            v56 = [v55 latestAtomicInstanceToVend];

            if (v56)
            {
              v57 = [v55 latestAtomicInstanceToVend];
              v58 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v10 forAtomicInstanceUUID:v57 requireExists:1];

              if (v58)
              {
                [(MADAutoAssetControlManager *)self _reclaimDownloadedDescriptorsWhenJustDownloaded:v58 fromLocation:v10];
              }
            }

            if (v52)
            {
              v59 = [v52 latestDownloadedAtomicInstance];

              if (v59)
              {
                v60 = [v52 latestDownloadedAtomicInstance];
                [(MADAutoAssetControlManager *)self atomicInstanceRemove:v10 setAtomicInstanceUUID:v60 removingForReason:@"dropped older set-descriptor" historyOperation:325];

                v61 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                [v61 removePersistedEntry:v48 fromLocation:v10];

                v62 = [v52 latestDowloadedAtomicInstanceEntries];
                v63 = [v62 count];
                v64 = [v52 clientDomainName];
                v65 = [v52 assetSetIdentifier];
                v66 = [v52 discoveredAtomicInstance];
                [MADAutoAssetHistory recordOperation:378 toHistoryType:2 fromLayer:1 usageCount:v63 forClientDomainName:v64 forAssetSetIdentifier:v65 forAtomicInstance:v66];

                v10 = v84;
                self = v85;
                v6 = v79;

                [(MADAutoAssetControlManager *)v85 _logPersistedSetDescriptorRemoved:v84 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v48 removedSetDescriptor:v52 message:@"removing stale previously persisted downloaded-set-descriptor"];
                goto LABEL_50;
              }

              v67 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
            }

            else
            {
              v67 = @"EntryID: %@. descriptor to be dropped is nil";
            }

            v68 = [[NSString alloc] initWithFormat:v67, v48];
            v69 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            v70 = [v69 diag];
            [v70 trackAnomaly:v84 forReason:v68 withResult:6101 withError:0];

            v10 = v84;
LABEL_50:

            objc_autoreleasePoolPop(contexta);
          }

          v46 = v78;
          v83 = [v78 countByEnumeratingWithState:&v90 objects:v98 count:16];
          if (!v83)
          {
LABEL_52:

            v12 = v73;
            goto LABEL_55;
          }
        }
      }
    }
  }

  v46 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
  {
    v71 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v72 = [v6 summary];
    *buf = 138543874;
    v100 = v71;
    v101 = 2114;
    v102 = v10;
    v103 = 2114;
    v104 = v72;
    _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} no persisted set-descriptors when removing other than setJobDescriptor:%{public}@", buf, 0x20u);
  }

LABEL_55:
}

- (void)_removeIncompleteSetDescriptorFromLocation:(id)a3 incompleteSetDescriptor:(id)a4 historyOperationAI:(int64_t)a5 historyOperationSD:(int64_t)a6
{
  v23 = a3;
  v10 = a4;
  v11 = +[NSFileManager defaultManager];
  v12 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v10];
  v13 = [v10 clientDomainName];
  v14 = [v10 assetSetIdentifier];
  v15 = [v10 latestDownloadedAtomicInstance];
  v16 = [MANAutoAssetSetStatus shortTermLockFilename:v13 forAssetSetIdentifier:v14 forSetAtomicInstance:v15];

  v17 = [NSString alloc];
  v18 = [v10 summary];
  v19 = [v17 initWithFormat:@"forcing atomic-instance unlocked due to incomplete set-descriptor | setDescriptor:%@", v18];
  v20 = [MAAutoAssetError buildError:6563 fromOperation:v23 underlyingError:0 withDescription:v19];

  [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v23 dueToError:v20 forgettingAtomicInstance:v12 historyOperationAI:338 historyOperationSD:381];
  v21 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:v23 removingSharedLockFilename:v16 usingFileManager:v11 removingDescription:@"atomic-instance shared lock directory (incomplete set-descriptor atomic-instance)"];
  [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v10];
  [(MADAutoAssetControlManager *)self secureCheckUngraftAll:v23 forSetDescriptorNoLongerLocked:v10];
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:v10];
  }

  v22 = [v10 latestDownloadedAtomicInstance];
  [(MADAutoAssetControlManager *)self atomicInstanceRemove:v23 setAtomicInstanceUUID:v22 removingForReason:@"incomplete set-descriptor atomic-instance" historyOperation:a5];

  [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v10 fromLocation:v23 checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:a5 historyOperationSD:a6];
}

- (void)_removeSetDeterminedToBeIncomplete:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [[NSString alloc] initWithFormat:@"%@:_removeSetDeterminedToBeIncomplete", v4];
  v8 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
  if (v8)
  {
    v9 = v8;
    v10 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
    v11 = [v10 count];

    if (v11)
    {
      v45 = objc_alloc_init(NSMutableDictionary);
      v47 = deviceOSBuildVersion();
      v12 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v13 = [v12 persistedEntryIDs:@"setDescriptorEliminate"];

      v44 = v13;
      v48 = v7;
      v43 = v4;
      if ([v13 count])
      {
        [(MADAutoAssetControlManager *)self trackPerformanceIteration:v7 ofContainer:@"persistedDownloadedSetDescriptors"];
        v64 = 0u;
        v65 = 0u;
        v62 = 0u;
        v63 = 0u;
        v14 = v13;
        v49 = [v14 countByEnumeratingWithState:&v62 objects:v73 count:16];
        if (v49)
        {
          v15 = *v63;
          v46 = *v63;
          do
          {
            for (i = 0; i != v49; i = i + 1)
            {
              if (*v63 != v15)
              {
                objc_enumerationMutation(v14);
              }

              v17 = *(*(&v62 + 1) + 8 * i);
              v18 = objc_autoreleasePoolPush();
              if (v17)
              {
                v19 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                v20 = [v19 persistedEntry:v17 fromLocation:v7];

                if (v20)
                {
                  v21 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                  v22 = [v21 decodeFromLocation:v7 ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                  if (v22)
                  {
                    v60 = 0u;
                    v61 = 0u;
                    v58 = 0u;
                    v59 = 0u;
                    v23 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
                    v24 = [v23 countByEnumeratingWithState:&v58 objects:v68 count:16];
                    if (v24)
                    {
                      v25 = v24;
                      v26 = v14;
                      v27 = *v59;
                      while (2)
                      {
                        for (j = 0; j != v25; j = j + 1)
                        {
                          if (*v59 != v27)
                          {
                            objc_enumerationMutation(v23);
                          }

                          if ([(MADAutoAssetControlManager *)self doesSetDescriptor:v22 referenceAssetDescriptor:*(*(&v58 + 1) + 8 * j)])
                          {
                            v29 = [v22 latestDownloadedAtomicInstance];
                            [v45 setSafeObject:v22 forKey:v29];

                            goto LABEL_26;
                          }
                        }

                        v25 = [v23 countByEnumeratingWithState:&v58 objects:v68 count:16];
                        if (v25)
                        {
                          continue;
                        }

                        break;
                      }

LABEL_26:
                      v14 = v26;
                      v15 = v46;
                    }
                  }

                  else
                  {
                    v23 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                    {
                      *buf = 138543618;
                      v70 = v48;
                      v71 = 2114;
                      v72 = v17;
                      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
                    }
                  }
                }

                else
                {
                  v22 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
                  {
                    *buf = 138543618;
                    v70 = v48;
                    v71 = 2114;
                    v72 = v17;
                    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load persisted entry | entryID:%{public}@", buf, 0x16u);
                  }
                }

                v7 = v48;
              }

              else
              {
                v20 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138543362;
                  v70 = v7;
                  _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{%{public}@} no entryID", buf, 0xCu);
                }
              }

              objc_autoreleasePoolPop(v18);
            }

            v49 = [v14 countByEnumeratingWithState:&v62 objects:v73 count:16];
          }

          while (v49);
        }
      }

      v56 = 0u;
      v57 = 0u;
      v54 = 0u;
      v55 = 0u;
      v30 = v45;
      v31 = [v30 countByEnumeratingWithState:&v54 objects:v67 count:16];
      if (v31)
      {
        v32 = v31;
        v33 = *v55;
        do
        {
          for (k = 0; k != v32; k = k + 1)
          {
            if (*v55 != v33)
            {
              objc_enumerationMutation(v30);
            }

            v35 = [v30 safeObjectForKey:*(*(&v54 + 1) + 8 * k) ofClass:objc_opt_class()];
            if (v35)
            {
              [(MADAutoAssetControlManager *)self _removeIncompleteSetDescriptorFromLocation:v7 incompleteSetDescriptor:v35 historyOperationAI:338 historyOperationSD:381];
            }
          }

          v32 = [v30 countByEnumeratingWithState:&v54 objects:v67 count:16];
        }

        while (v32);
      }

      v52 = 0u;
      v53 = 0u;
      v50 = 0u;
      v51 = 0u;
      v36 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
      v37 = [v36 countByEnumeratingWithState:&v50 objects:v66 count:16];
      if (v37)
      {
        v38 = v37;
        v39 = *v51;
        do
        {
          for (m = 0; m != v38; m = m + 1)
          {
            if (*v51 != v39)
            {
              objc_enumerationMutation(v36);
            }

            v41 = *(*(&v50 + 1) + 8 * m);
            if ([MADAutoAssetSecure isCodeAsset:@"jobDescriptorOnFilesystemValidated" forDescriptor:v41])
            {
              if ([v41 wasBuiltForOSBuild:v47])
              {
                v42 = 410;
              }

              else
              {
                v42 = 411;
              }
            }

            else
            {
              v42 = 410;
            }

            [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"assetBeingGarbageCollected" droppingDescriptor:v41 forHistoryOperation:v42 firstClientName:0];
          }

          v38 = [v36 countByEnumeratingWithState:&v50 objects:v66 count:16];
        }

        while (v38);
      }

      v4 = v43;
      v7 = v48;
    }
  }

  [(MADAutoAssetControlManager *)self setDescriptorsDroppedOnStartup:0];
}

- (void)_removeDownloadedDescriptorsWithNewerDownloaded:(id)a3
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [v6 persistedEntryIDs:@"_removeDownloadedDescriptorsWithNewerDownloaded"];

  if ([v7 count])
  {
    v8 = [[NSMutableArray alloc] initWithArray:v7];
    v9 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v11 = 138543362;
      v12 = v10;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} crosscheck[BEGIN]", &v11, 0xCu);
    }

    [(MADAutoAssetControlManager *)self _removeNextDownloadedDescriptorIfNewerDownloaded:v8];
  }
}

- (void)_removeNextDownloadedDescriptorIfNewerDownloaded:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 count];
  if (v7 >= 1)
  {
    v8 = v7;
    v9 = [v4 objectAtIndex:0];
    [v4 removeObjectAtIndex:0];
    v10 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v11 = [v10 persistedEntry:v9 fromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded"];

    if (v11)
    {
      v12 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v13 = [v12 decodeFromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded" ofEntryName:v9 fromPersistedEntry:v11 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (v13)
      {
        v42 = v8;
        v43 = v11;
        v44 = v9;
        v45 = v4;
        v14 = objc_alloc_init(NSMutableArray);
        v41 = v13;
        [(MADAutoAssetControlManager *)self _decideRemoveDescriptorWithNewerDownloaded:v13 maintainingRemoveDescriptors:v14 allowRemovalWithoutNewerDescriptor:0 fromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded"];
        v49 = 0u;
        v50 = 0u;
        v51 = 0u;
        v52 = 0u;
        v15 = v14;
        v16 = [v15 countByEnumeratingWithState:&v49 objects:v53 count:16];
        if (v16)
        {
          v17 = v16;
          v18 = *v50;
          v19 = @"AutoControl";
          do
          {
            v20 = 0;
            v46 = v17;
            do
            {
              if (*v50 != v18)
              {
                objc_enumerationMutation(v15);
              }

              v21 = *(*(&v49 + 1) + 8 * v20);
              v22 = objc_autoreleasePoolPush();
              v23 = _MADLog(v19);
              if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
              {
                v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                [v21 summary];
                v25 = v18;
                v26 = v19;
                v27 = v15;
                v29 = v28 = self;
                *buf = 138543618;
                v55 = v24;
                v56 = 2114;
                v57 = v29;
                _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} removing | removeDescriptor:%{public}@", buf, 0x16u);

                self = v28;
                v15 = v27;
                v19 = v26;
                v18 = v25;
                v17 = v46;
              }

              [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"_removeNextDownloadedDescriptorIfNewerDownloaded" droppingDescriptor:v21 forHistoryOperation:402 firstClientName:0];
              objc_autoreleasePoolPop(v22);
              v20 = v20 + 1;
            }

            while (v17 != v20);
            v17 = [v15 countByEnumeratingWithState:&v49 objects:v53 count:16];
          }

          while (v17);
        }

        v9 = v44;
        v4 = v45;
        v8 = v42;
        v11 = v43;
        v13 = v41;
      }

      else
      {
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v55 = v31;
          v56 = 2114;
          v57 = v9;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} unable to decode asset-descriptor | entryID:%{public}@", buf, 0x16u);
        }
      }
    }

    else
    {
      v13 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        v30 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v55 = v30;
        v56 = 2114;
        v57 = v9;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} unable to load persisted-entry | entryID:%{public}@", buf, 0x16u);
      }
    }

    v32 = [v4 count];
    if (v32 < 1)
    {
      v37 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
      {
        v38 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v55 = v38;
        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} crosscheck[END]", buf, 0xCu);
      }
    }

    else
    {
      v33 = v32;
      v34 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v35 = v34;
      if (v33 >= v8)
      {
        v39 = [v34 diag];
        v40 = [[NSString alloc] initWithFormat:@"{_removeNextDownloadedDescriptorIfNewerDownloaded} recursion problem - abandoning crosscheck | remainingEntryIDCount:%ld | beginEntryIDCount:%ld", v33, v8];
        [v39 trackAnomaly:@"AUTO-CONTROL" forReason:v40 withResult:6109 withError:0];
      }

      else
      {
        v36 = [v34 extendedStateQueue];
        block[0] = _NSConcreteStackBlock;
        block[1] = 3221225472;
        block[2] = __79__MADAutoAssetControlManager__removeNextDownloadedDescriptorIfNewerDownloaded___block_invoke;
        block[3] = &unk_4B2B18;
        block[4] = self;
        v48 = v4;
        dispatch_async(v36, block);
      }
    }
  }
}

- (BOOL)_removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:(id)a3 setDescriptor:(id)a4 allowRemovalWithoutNewerDescriptor:(BOOL)a5
{
  v5 = a5;
  v8 = a3;
  v9 = a4;
  v10 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v11 = [v10 extendedStateQueue];
  dispatch_assert_queue_V2(v11);

  v12 = [[NSString alloc] initWithFormat:@"%@:_removeDownloadedSetDescriptorWithNewerDownloaded", v8];
  v35 = objc_alloc_init(NSMutableArray);
  if ([(MADAutoAssetControlManager *)self _isDownloadedSetDescriptorLatestToVend:v9 fromLocation:v12])
  {
    v13 = 0;
  }

  else
  {
    v34 = v8;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v12 ofContainer:@"latestDowloadedAtomicInstanceEntries"];
    v44 = 0u;
    v45 = 0u;
    v42 = 0u;
    v43 = 0u;
    v33 = v9;
    v14 = [v9 latestDowloadedAtomicInstanceEntries];
    v15 = [v14 countByEnumeratingWithState:&v42 objects:v53 count:16];
    if (v15)
    {
      v16 = v15;
      v17 = *v43;
      while (2)
      {
        for (i = 0; i != v16; i = i + 1)
        {
          if (*v43 != v17)
          {
            objc_enumerationMutation(v14);
          }

          v19 = [*(*(&v42 + 1) + 8 * i) fullAssetSelector];
          v20 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v19];

          LOBYTE(v19) = [(MADAutoAssetControlManager *)self _decideRemoveDescriptorWithNewerDownloaded:v20 maintainingRemoveDescriptors:v35 allowRemovalWithoutNewerDescriptor:v5 fromLocation:v12];
          if (v19)
          {

            v13 = 0;
            v9 = v33;
            v8 = v34;
            goto LABEL_22;
          }
        }

        v16 = [v14 countByEnumeratingWithState:&v42 objects:v53 count:16];
        if (v16)
        {
          continue;
        }

        break;
      }
    }

    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    obj = v35;
    v21 = [obj countByEnumeratingWithState:&v38 objects:v52 count:16];
    if (v21)
    {
      v22 = v21;
      v23 = *v39;
      v24 = @"AutoControl";
      v36 = self;
      do
      {
        for (j = 0; j != v22; j = j + 1)
        {
          if (*v39 != v23)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v38 + 1) + 8 * j);
          v27 = objc_autoreleasePoolPush();
          v28 = _MADLog(v24);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
          {
            [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v30 = v29 = v24;
            v31 = [v26 summary];
            *buf = 138543874;
            v47 = v30;
            v48 = 2114;
            v49 = v12;
            v50 = 2114;
            v51 = v31;
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing | removeDescriptor:%{public}@", buf, 0x20u);

            v24 = v29;
            self = v36;
          }

          [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:v12 droppingDescriptor:v26 forHistoryOperation:402 firstClientName:0];
          objc_autoreleasePoolPop(v27);
        }

        v22 = [obj countByEnumeratingWithState:&v38 objects:v52 count:16];
      }

      while (v22);
    }

    v13 = 1;
    v9 = v33;
    v8 = v34;
    [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v33 fromLocation:v34 checkingByInstance:1 regardlessOfLatest:0 historyOperationAI:322 historyOperationSD:376];
  }

LABEL_22:

  return v13;
}

- (BOOL)_decideRemoveDescriptorWithNewerDownloaded:(id)a3 maintainingRemoveDescriptors:(id)a4 allowRemovalWithoutNewerDescriptor:(BOOL)a5 fromLocation:(id)a6
{
  v7 = a5;
  v10 = a3;
  v11 = a4;
  v12 = a6;
  v13 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v14 = [v13 extendedStateQueue];
  dispatch_assert_queue_V2(v14);

  v15 = [[NSString alloc] initWithFormat:@"%@:%@", v12, @"_decideRemoveDescriptorWithNewerDownloaded"];
  if (!v10)
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543618;
      v30 = v20;
      v31 = 2114;
      v32 = v15;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} nil downloadedAssetDescriptor", buf, 0x16u);
LABEL_14:
    }

LABEL_15:

    goto LABEL_16;
  }

  if ([v10 isBlankEntry])
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      v17 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v18 = [v10 summary];
      *buf = 138543874;
      v30 = v17;
      v31 = 2114;
      v32 = v15;
      v33 = 2114;
      v34 = v18;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} encountered blank auto-asset-descriptor - removing | downloadedAssetDescriptor:%{public}@", buf, 0x20u);
    }

    [v11 addObject:v10];
    goto LABEL_16;
  }

  if (![v10 isOnFilesystem])
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      v20 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v22 = [v10 summary];
      *buf = 138543874;
      v30 = v20;
      v31 = 2114;
      v32 = v15;
      v33 = 2114;
      v34 = v22;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} encountered downloaded descriptor not on the filesystem - ignored | downloadedAssetDescriptor:%{public}@", buf, 0x20u);

      goto LABEL_14;
    }

    goto LABEL_15;
  }

  if (![v10 foundByLookupWithoutAssetVersion])
  {
LABEL_16:
    v21 = 0;
    goto LABEL_17;
  }

  if (![(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v15 forDescriptor:v10])
  {
    v24 = [(MADAutoAssetControlManager *)self _newestVersionDownloaded:v10];
    if ((v24 || v7) && ![(MADAutoAssetControlManager *)self _isDownloadedDescriptorPartOfLatestToVend:v10 fromLocation:v15])
    {
      v25 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
      {
        v26 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v27 = [v10 summary];
        v28 = [v24 summary];
        *buf = 138544130;
        v30 = v26;
        v31 = 2114;
        v32 = v15;
        v33 = 2114;
        v34 = v27;
        v35 = 2114;
        v36 = v28;
        _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing older downloaded descriptor | removingDescriptor:%{public}@, keepingDescriptor:%{public}@", buf, 0x2Au);
      }

      [v11 addObject:v10];
    }

    goto LABEL_16;
  }

  v21 = 1;
LABEL_17:

  return v21;
}

- (void)_reclaimDownloadedDescriptorsWhenJustDownloaded:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:_reclaimDownloadedDescriptorsWhenJustDownloaded", v7];
  v11 = [v6 clientDomainName];
  v12 = [v6 assetSetIdentifier];
  v50 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v11 forAssetSetIdentifier:v12];

  v13 = [v6 firstAssetType];
  v14 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v48 = v13;
  v15 = [v14 persistedEntryIDs:@"_reclaimDownloadedDescriptorsWhenJustDownloaded" assetType:v13];

  v52 = objc_alloc_init(NSMutableArray);
  v49 = v15;
  if ([v15 count])
  {
    v45 = v7;
    v46 = v6;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"persistedKnownDescriptors"];
    v60 = 0u;
    v61 = 0u;
    v58 = 0u;
    v59 = 0u;
    v16 = v15;
    v17 = [v16 countByEnumeratingWithState:&v58 objects:v71 count:16];
    if (!v17)
    {
      goto LABEL_35;
    }

    v18 = v17;
    v53 = *v59;
    v51 = v16;
    while (1)
    {
      for (i = 0; i != v18; i = i + 1)
      {
        if (*v59 != v53)
        {
          objc_enumerationMutation(v16);
        }

        v20 = *(*(&v58 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        if (v20)
        {
          v22 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v23 = [v22 persistedEntry:v20 fromLocation:v10];

          if (v23)
          {
            v24 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v25 = [v24 decodeFromLocation:v10 ofEntryName:v20 fromPersistedEntry:v23 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v25)
            {
              if ([v25 isBlankEntry])
              {
                v26 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                {
                  v27 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v64 = v27;
                  v65 = 2114;
                  v66 = v10;
                  v67 = 2114;
                  v68 = v20;
                  v28 = v26;
                  v29 = OS_LOG_TYPE_DEFAULT;
                  v30 = "[%{public}@]\n[REMOVAL] {%{public}@} encountered blank auto-asset-descriptor - removing | entryID:%{public}@";
                  goto LABEL_30;
                }

                goto LABEL_31;
              }

              if ([v25 isOnFilesystem])
              {
                if ([v25 foundByLookupWithoutAssetVersion]&& [(MADAutoAssetControlManager *)self doesSetConfiguration:v50 coverAssetDescriptor:v25]&& ![(MADAutoAssetControlManager *)self _isDownloadedDescriptorPartOfLatestToVend:v25 fromLocation:v10]&& ![(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v10 forDescriptor:v25])
                {
                  v33 = [(MADAutoAssetControlManager *)self _newestVersionDownloaded:v25];
                  if (v33)
                  {
                    v34 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
                    {
                      v44 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                      v43 = [v25 summary];
                      [v33 summary];
                      v35 = log = v34;
                      *buf = 138544130;
                      v64 = v44;
                      v65 = 2114;
                      v66 = v10;
                      v67 = 2114;
                      v68 = v43;
                      v69 = 2114;
                      v70 = v35;
                      _os_log_impl(&dword_0, log, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing older downloaded descriptor | removingDescriptor:%{public}@, keepingDescriptor:%{public}@", buf, 0x2Au);

                      v34 = log;
                      v16 = v51;
                    }

                    [v52 addObject:v25];
                  }
                }
              }

              else
              {
                v26 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
                {
                  v27 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v64 = v27;
                  v65 = 2114;
                  v66 = v10;
                  v67 = 2114;
                  v68 = v20;
                  v28 = v26;
                  v29 = OS_LOG_TYPE_ERROR;
                  v30 = "[%{public}@]\n[REMOVAL] {%{public}@} encountered downloaded descriptor not on the filesystem - removing | entryID:%{public}@";
LABEL_30:
                  _os_log_impl(&dword_0, v28, v29, v30, buf, 0x20u);

                  v16 = v51;
                }

LABEL_31:

                [v52 addObject:v25];
              }

LABEL_32:

              goto LABEL_33;
            }

            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
            {
              v32 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543874;
              v64 = v32;
              v65 = 2114;
              v66 = v10;
              v67 = 2114;
              v68 = v20;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} unable to load auto-asset-descriptor | entryID:%{public}@", buf, 0x20u);

              v16 = v51;
            }
          }

          else
          {
            v25 = _MADLog(@"AutoControl");
            if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
              goto LABEL_32;
            }

            v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543874;
            v64 = v31;
            v65 = 2114;
            v66 = v10;
            v67 = 2114;
            v68 = v20;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
          }

          goto LABEL_32;
        }

LABEL_33:
        objc_autoreleasePoolPop(v21);
      }

      v18 = [v16 countByEnumeratingWithState:&v58 objects:v71 count:16];
      if (!v18)
      {
LABEL_35:

        v7 = v45;
        v6 = v46;
        break;
      }
    }
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v36 = v52;
  v37 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v37)
  {
    v38 = v37;
    v39 = *v55;
    do
    {
      for (j = 0; j != v38; j = j + 1)
      {
        if (*v55 != v39)
        {
          objc_enumerationMutation(v36);
        }

        v41 = *(*(&v54 + 1) + 8 * j);
        v42 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:v10 droppingDescriptor:v41 forHistoryOperation:402 firstClientName:0];
        objc_autoreleasePoolPop(v42);
      }

      v38 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v38);
  }
}

- (id)_newestVersionDownloaded:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v8 = [MAAutoAssetSelector alloc];
  v9 = [v4 assetType];
  v10 = [v4 assetSpecifier];
  v11 = [v8 initForAssetType:v9 withAssetSpecifier:v10];

  v12 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v13 = [v12 persistedEntryIDs:@"_newestVersionDownloaded" assetSelector:v11];

  if (![v13 count])
  {
    v50 = 0;
    goto LABEL_40;
  }

  v53 = v11;
  v14 = [MAAutoAssetSelector alloc];
  v15 = [v4 assetType];
  v16 = [v4 assetSpecifier];
  v17 = [v4 assetVersion];
  v61 = [v14 initForAssetType:v15 withAssetSpecifier:v16 matchingAssetVersion:v17];

  v18 = [SUCoreRestoreVersion alloc];
  v54 = v4;
  v19 = [v4 assetVersion];
  v56 = [v18 initWithRestoreVersion:v19];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_newestVersionDownloaded" ofContainer:@"persistedKnownDescriptors"];
  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v52 = v13;
  v20 = v13;
  v64 = [v20 countByEnumeratingWithState:&v65 objects:v73 count:16];
  if (!v64)
  {
    v57 = 0;
    v55 = 0;
    goto LABEL_39;
  }

  v57 = 0;
  v55 = 0;
  v63 = *v66;
  v60 = v20;
  do
  {
    v21 = 0;
    do
    {
      if (*v66 != v63)
      {
        objc_enumerationMutation(v20);
      }

      v22 = *(*(&v65 + 1) + 8 * v21);
      v23 = objc_autoreleasePoolPush();
      v24 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v25 = [v24 persistedEntry:v22 fromLocation:@"_newestVersionDownloaded"];

      if (v25)
      {
        v26 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v27 = [v26 decodeFromLocation:@"_newestVersionDownloaded" ofEntryName:v22 fromPersistedEntry:v25 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v27)
        {
          if ([v27 isBlankEntry])
          {
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              v29 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v70 = v29;
              v71 = 2114;
              v72 = v22;
              v30 = v28;
              v31 = OS_LOG_TYPE_DEFAULT;
              v32 = "[%{public}@] {_newestVersionDownloaded} encountered blank auto-asset-descriptor | entryID:%{public}@";
              goto LABEL_16;
            }

LABEL_27:

            goto LABEL_28;
          }

          if (![v27 isOnFilesystem])
          {
            goto LABEL_28;
          }

          v34 = objc_alloc(p_weak_ivar_lyt[267]);
          v35 = [v27 assetType];
          v36 = [v27 assetSpecifier];
          v37 = [v27 assetVersion];
          v28 = [v34 initForAssetType:v35 withAssetSpecifier:v36 matchingAssetVersion:v37];

          v29 = [v28 assetType];
          v62 = [v61 assetType];
          if (![SUCore stringIsEqual:v29 to:?])
          {
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            v43 = v62;
            goto LABEL_25;
          }

          v59 = v29;
          v38 = [v28 assetSpecifier];
          v39 = [v61 assetSpecifier];
          v58 = v38;
          if (![SUCore stringIsEqual:v38 to:v39])
          {

            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            v43 = v62;
            v44 = v58;
            goto LABEL_24;
          }

          v40 = [v28 assetVersion];
          v41 = [v61 assetVersion];
          v42 = [SUCore stringIsEqual:v40 to:v41];

          if (v42)
          {
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            goto LABEL_27;
          }

          v45 = [SUCoreRestoreVersion alloc];
          v46 = [v27 assetVersion];
          v47 = [v45 initWithRestoreVersion:v46];

          v29 = v47;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v20 = v60;
          if ([v47 isComparable:v56])
          {
            v43 = v57;
            v57 = v43;
            if (!v43)
            {
              v43 = v56;
            }

            if ([v29 compare:{v43, v52}] == &dword_0 + 1)
            {
              v29 = v29;

              v48 = v27;
              v44 = v55;
              v57 = v29;
              v55 = v48;
LABEL_24:
            }

LABEL_25:
          }
        }

        else
        {
          v28 = _MADLog(@"AutoControl");
          if (!os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_27;
          }

          v29 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v70 = v29;
          v71 = 2114;
          v72 = v22;
          v30 = v28;
          v31 = OS_LOG_TYPE_ERROR;
          v32 = "[%{public}@] {_newestVersionDownloaded} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
          _os_log_impl(&dword_0, v30, v31, v32, buf, 0x16u);
        }

        goto LABEL_27;
      }

      v27 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        v33 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v70 = v33;
        v71 = 2114;
        v72 = v22;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {_newestVersionDownloaded} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
      }

LABEL_28:

      objc_autoreleasePoolPop(v23);
      v21 = v21 + 1;
    }

    while (v64 != v21);
    v49 = [v20 countByEnumeratingWithState:&v65 objects:v73 count:16];
    v64 = v49;
  }

  while (v49);
LABEL_39:

  v11 = v53;
  v4 = v54;
  v13 = v52;
  v50 = v55;
LABEL_40:

  return v50;
}

- (BOOL)_selectorBeingEliminated:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v24 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v27 = 0u;
  v28 = 0u;
  v25 = 0u;
  v26 = 0u;
  obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v23 = [obj countByEnumeratingWithState:&v25 objects:v29 count:16];
  if (v23)
  {
    v22 = *v26;
    while (2)
    {
      for (i = 0; i != v23; i = i + 1)
      {
        if (*v26 != v22)
        {
          objc_enumerationMutation(obj);
        }

        v10 = *(*(&v25 + 1) + 8 * i);
        v11 = objc_autoreleasePoolPush();
        v12 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
        v13 = [v12 safeObjectForKey:v10 ofClass:objc_opt_class()];

        v14 = [v13 assetSelector];
        v15 = [v6 assetType];
        v16 = [v6 assetSpecifier];
        v17 = [v6 assetVersion];
        v18 = [(MADAutoAssetControlManager *)self _doesEliminateSelector:v14 matchAssetType:v15 withAssetSpecifier:v16 withAssetVersion:v17 fromLocation:v24];

        objc_autoreleasePoolPop(v11);
        if (v18)
        {
          v19 = 1;
          goto LABEL_11;
        }
      }

      v23 = [obj countByEnumeratingWithState:&v25 objects:v29 count:16];
      if (v23)
      {
        continue;
      }

      break;
    }
  }

  v19 = 0;
LABEL_11:

  return v19;
}

- (BOOL)_setInstanceBeingEliminated:(id)a3 fromLocation:(id)a4
{
  v26 = a3;
  v6 = a4;
  v7 = self;
  v25 = v6;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v10 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = 0;
    v12 = *v32;
    v13 = v26;
    v27 = *v32;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v32 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v31 + 1) + 8 * i);
        context = objc_autoreleasePoolPush();
        v16 = [(MADAutoAssetControlManager *)v7 activelyEliminatingSelectors];
        v17 = [v16 safeObjectForKey:v15 ofClass:objc_opt_class()];

        if ([v17 eliminatingSet])
        {
          v18 = v11;
          v19 = [v17 clientDomainName];
          v20 = [v13 clientDomainName];
          if ([SUCore stringIsEqual:v19 to:v20])
          {
            v21 = [v17 assetSetIdentifier];
            v22 = [v13 assetSetIdentifier];
            v23 = [SUCore stringIsEqual:v21 to:v22];

            v13 = v26;
            v7 = self;
            v28 |= v23;
          }

          v11 = v18;

          v12 = v27;
        }

        objc_autoreleasePoolPop(context);
      }

      v11 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    }

    while (v11);
  }

  else
  {
    v28 = 0;
    v13 = v26;
  }

  return v28 & 1;
}

- (BOOL)_isClientRequestSubjectToElimination:(id)a3
{
  v3 = [a3 clientRequestMessage];
  v4 = [v3 messageName];

  v5 = ([SUCore stringIsEqual:v4 to:@"MA-AUTO:CURRENT_STATUS"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:LOCK_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];
  return v5;
}

- (BOOL)_doesClientRequestInvolveSetConfiguration:(id)a3
{
  v3 = [a3 clientRequestMessage];
  v4 = [v3 messageName];

  v5 = ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:v4 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
  return v5;
}

- (void)_eliminateSecureOperationFinished:(id)a3 forEliminateDescriptor:(id)a4
{
  v9 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  if ([v9 awaitingSecureOperations] >= 1 && objc_msgSend(v6, "secureOperationEliminating"))
  {
    [v9 setAwaitingSecureOperations:{objc_msgSend(v9, "awaitingSecureOperations") - 1}];
    [v6 setSecureOperationEliminating:0];
  }

  [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v9];
}

- (void)_eliminateSecureOperationFinished:(id)a3 forEliminateSetDescriptor:(id)a4
{
  v9 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  if ([v9 awaitingSecureOperations] >= 1 && objc_msgSend(v6, "secureOperationEliminating"))
  {
    [v9 setAwaitingSecureOperations:{objc_msgSend(v9, "awaitingSecureOperations") - 1}];
    [v6 setSecureOperationEliminating:0];
  }

  [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v9];
}

- (void)_eliminateCompleteIfAllDone:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (v4)
  {
    v7 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    v8 = [v4 assetSelector];
    v9 = [v8 persistedEntryID];
    v10 = [v7 safeObjectForKey:v9 ofClass:objc_opt_class()];

    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      v12 = [v4 summary];
      *buf = 138543362;
      v153 = v12;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} checking whether done with elimination | eliminateTracker:%{public}@", buf, 0xCu);
    }

    if (!v10)
    {
      v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v15 = [v14 diag];
      v16 = [NSString alloc];
      v17 = [v4 summary];
      v18 = [v16 initWithFormat:@"{_eliminateCompleteIfAllDone} untracked eliminateTracker:%@", v17];
      [v15 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];

LABEL_15:
      goto LABEL_16;
    }

    if ([v4 awaitingSchedulerAck] & 1) != 0 || (objc_msgSend(v4, "awaitingCancelActivityAck") & 1) != 0 || (objc_msgSend(v4, "awaitingStagerAck") & 1) != 0 || (objc_msgSend(v4, "awaitingUnlocked"))
    {
      goto LABEL_13;
    }

    v13 = [v4 activeJobsByUUID];
    if ([v13 count])
    {

      goto LABEL_13;
    }

    v19 = [v4 awaitingSecureOperations];

    if (v19 > 0)
    {
LABEL_13:
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        v20 = [v4 summary];
        *buf = 138543362;
        v153 = v20;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} not yet complete | eliminateTracker:%{public}@", buf, 0xCu);
      }

      goto LABEL_15;
    }

    v21 = [v4 assetSelector];
    v14 = [v21 persistedEntryID];

    v138 = v4;
    v139 = self;
    if ([v4 eliminatingSet])
    {
      v125 = v10;
      v127 = v14;
      v130 = objc_alloc_init(NSMutableArray);
      v132 = +[NSFileManager defaultManager];
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_eliminateCompleteIfAllDone" ofContainer:@"currentSetStatusByInstance"];
      v150 = 0u;
      v151 = 0u;
      v148 = 0u;
      v149 = 0u;
      obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      v22 = [obj countByEnumeratingWithState:&v148 objects:v158 count:16];
      if (!v22)
      {
        goto LABEL_30;
      }

      v23 = v22;
      v136 = *v149;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      while (1)
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v149 != v136)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v148 + 1) + 8 * i);
          v27 = objc_autoreleasePoolPush();
          v28 = [(MADAutoAssetControlManager *)v139 locateSetStatusByInstance:v26];
          v29 = p_weak_ivar_lyt[223];
          v30 = [v28 clientDomainName];
          v31 = [v4 clientDomainName];
          if ([v29 stringIsEqual:v30 to:v31])
          {
            v32 = p_weak_ivar_lyt[223];
            v33 = [v28 assetSetIdentifier];
            v34 = [v138 assetSetIdentifier];
            LODWORD(v32) = [v32 stringIsEqual:v33 to:v34];

            v4 = v138;
            if (!v32)
            {
              goto LABEL_28;
            }

            v35 = [v28 clientDomainName];
            v36 = [v28 assetSetIdentifier];
            v37 = [v28 latestDownloadedAtomicInstance];
            v30 = [MANAutoAssetSetStatus shortTermLockFilename:v35 forAssetSetIdentifier:v36 forSetAtomicInstance:v37];

            v4 = v138;
            [v130 addObject:v26];
            v38 = [(MADAutoAssetControlManager *)v139 _shortTermSharedLockRemove:@"_eliminateCompleteIfAllDone" removingSharedLockFilename:v30 usingFileManager:v132 removingDescription:@"atomic-instance shared lock file removed (eliminated set-identifier)"];
          }

          else
          {
          }

LABEL_28:
          objc_autoreleasePoolPop(v27);
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        }

        v23 = [obj countByEnumeratingWithState:&v148 objects:v158 count:16];
        if (!v23)
        {
LABEL_30:

          v146 = 0u;
          v147 = 0u;
          v144 = 0u;
          v145 = 0u;
          v39 = v130;
          v40 = [v39 countByEnumeratingWithState:&v144 objects:v157 count:16];
          v10 = v125;
          if (v40)
          {
            v41 = v40;
            v42 = *v145;
            do
            {
              for (j = 0; j != v41; j = j + 1)
              {
                if (*v145 != v42)
                {
                  objc_enumerationMutation(v39);
                }

                v44 = *(*(&v144 + 1) + 8 * j);
                if (v44)
                {
                  v45 = [(MADAutoAssetControlManager *)v139 currentSetStatusByInstance];
                  [v45 removeObjectForKey:v44];
                }
              }

              v41 = [v39 countByEnumeratingWithState:&v144 objects:v157 count:16];
            }

            while (v41);
          }

          v142 = 0u;
          v143 = 0u;
          v140 = 0u;
          v141 = 0u;
          v46 = [v4 downloadedSetDescriptors];
          v47 = [v46 countByEnumeratingWithState:&v140 objects:v156 count:16];
          if (v47)
          {
            v48 = v47;
            v49 = *v141;
            do
            {
              for (k = 0; k != v48; k = k + 1)
              {
                if (*v141 != v49)
                {
                  objc_enumerationMutation(v46);
                }

                v51 = *(*(&v140 + 1) + 8 * k);
                [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v51];
                [(MADAutoAssetControlManager *)v139 secureCheckUngraftAll:@"_eliminateCompleteIfAllDone" forSetDescriptorNoLongerLocked:v51];
              }

              v48 = [v46 countByEnumeratingWithState:&v140 objects:v156 count:16];
            }

            while (v48);
          }

          v4 = v138;
          self = v139;
          v14 = v127;
          goto LABEL_77;
        }
      }
    }

    if (([v4 limitedToCancelActivity] & 1) == 0)
    {
      v52 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v53 = [v52 persistedEntryAlreadyExists:v14 fromLocation:@"_eliminateCompleteIfAllDone"];

      if (v53)
      {
        v54 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v55 = [v54 persistedEntry:v14 fromLocation:@"_eliminateCompleteIfAllDone"];

        if (v55)
        {
          v56 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v57 = [v56 decodeFromLocation:@"_eliminateCompleteIfAllDone" ofEntryName:v14 fromPersistedEntry:v55 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (v57)
          {
            v58 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [v58 removePersistedEntry:v14 fromLocation:@"_eliminateCompleteIfAllDone"];

            v59 = [v57 isOnFilesystem]? @"DOWNLOADED_DESCRIPTORS" : @"JOB_DESCRIPTORS";
            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_eliminateCompleteIfAllDone" forComponentType:v59 removedPersistedEntryID:v14 removedDescriptor:v57 message:@"removed persisted descriptor entry (no remaining pending operations)"];
            if ([v57 isOnFilesystem])
            {
              v126 = v10;
              v128 = v14;
              v60 = [v4 clientRequest];
              v61 = [v60 clientRequestMessage];

              v137 = v61;
              obja = [v61 message];
              v62 = [obja safeObjectForKey:@"instance" ofClass:objc_opt_class()];
              v63 = [v62 autoAssetClientName];
              v133 = v62;
              if (v63)
              {
                [v62 autoAssetClientName];
              }

              else
              {
                [v62 clientProcessName];
              }
              v65 = ;

              v66 = [v57 assetId];
              v67 = [v4 assetSelector];
              v131 = v65;
              if (v65)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v65 forAssetID:v66 withSelector:v67];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:v66 withSelector:v67];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v68 = [MAAIRBMobileAssetOperationMetadata alloc];
                v69 = [MADAutoAssetHistoryTracker operationName:300];
                v70 = [(MAAIRBMobileAssetOperationMetadata *)v68 initWithCode:300 name:v69];

                v71 = [MAAIRBMobileAssetAssetSelector alloc];
                v72 = [v138 assetSelector];
                v73 = [v72 assetType];
                v74 = [v138 assetSelector];
                v75 = [v74 assetSpecifier];
                v76 = [v138 assetSelector];
                v77 = [v76 assetVersion];
                v78 = [(MAAIRBMobileAssetAssetSelector *)v71 initWithAssetType:v73 assetSpecifier:v75 assetVersion:v77];

                v79 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v70 assetSelector:v78];
                v80 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v79];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v80];
              }

              v4 = v138;
              self = v139;
              v10 = v126;
              v14 = v128;
            }
          }
        }

        else
        {
          v57 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
          {
            v64 = [v4 summary];
            *buf = 138543362;
            v153 = v64;
            _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} no persisted descriptor entry yet entry already exists | eliminateTracker:%{public}@", buf, 0xCu);
          }
        }

        v81 = [v4 assetSelector];
        v82 = [(MADAutoAssetControlManager *)self jobSelectorKey:v81];

        if (v82)
        {
          v83 = [(MADAutoAssetControlManager *)self currentStatusBySelector];
          [v83 removeObjectForKey:v82];

          v84 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v84, OS_LOG_TYPE_DEFAULT))
          {
            v85 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v153 = v85;
            v154 = 2114;
            v155 = v82;
            _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][REMOVED] | statusKey:%{public}@ | jobUUID:N", buf, 0x16u);
          }
        }
      }
    }

    v86 = [v4 assetSelector];
    v39 = [(MADAutoAssetControlManager *)self currentJobBySelector:v86];

    if (v39)
    {
      v129 = v14;
      v87 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v88 = [v87 diag];
      v89 = [NSString alloc];
      v90 = [v39 summary];
      [v4 summary];
      v92 = v91 = v4;
      v93 = [v89 initWithFormat:@"{_eliminateCompleteIfAllDone} unexpected current job by-selector | autoJob:%@ eliminateTracker:%@", v90, v92];
      [v88 trackAnomaly:@"AUTO-CONTROL" forReason:v93 withResult:6103 withError:0];

      v94 = [v39 autoAssetUUID];
      v95 = [(MADAutoAssetControlManager *)self currentJobByUUID:v94 fromLocation:@"_eliminateCompleteIfAllDone" notFoundCode:0 notFoundReason:0];

      if (v95)
      {
        v96 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        v97 = [v96 diag];
        v98 = [NSString alloc];
        v99 = [v95 summary];
        v100 = [v91 summary];
        v101 = [v98 initWithFormat:@"{_eliminateCompleteIfAllDone} unexpected current job by-UUID | activeJob:%@ eliminateTracker:%@", v99, v100];
        [v97 trackAnomaly:@"AUTO-CONTROL" forReason:v101 withResult:6103 withError:0];
      }

      v4 = v91;
      v14 = v129;
    }

    if (([v4 limitedToCancelActivity] & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self _removeAllContentForEliminateTracker:v4 unlessCurrentlyLocked:0];
    }

LABEL_77:

    v102 = [v4 clientRequest];
    v103 = [v102 clientReplyCompletion];

    if (!v103)
    {
      v111 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v117 = [v111 diag];
      v118 = [NSString alloc];
      v119 = [v4 summary];
      v120 = [v118 initWithFormat:@"{_eliminateCompleteIfAllDone} no client reply completion | eliminateTracker:%@", v119];
      [v117 trackAnomaly:@"AUTO-CONTROL" forReason:v120 withResult:6111 withError:0];
      goto LABEL_88;
    }

    v104 = v14;
    v105 = [v4 clientRequest];
    v106 = [v105 clientRequestMessage];
    v107 = [MADAutoAssetControlManager replyMessageNameForRequest:v106];
    v108 = [v4 clientRequest];
    v109 = [v108 clientRequestMessage];
    v110 = [v109 clientID];
    v111 = [MADAutoAssetControlManager createSeverMessageWithName:v107 sender:@"com.apple.MAAutoControl" clientID:v110 response:0 error:0];

    v4 = v138;
    v112 = [v138 clientRequest];
    [(MADAutoAssetControlManager *)v139 issueResponseToClientRequest:v112 issuingResponseMessage:v111 withResponseError:0];

    LODWORD(v112) = [v138 eliminatingSet];
    v113 = _MADLog(@"AutoControl");
    v114 = os_log_type_enabled(v113, OS_LOG_TYPE_DEFAULT);
    if (v112)
    {
      if (v114)
      {
        v115 = [v138 summary];
        *buf = 138543362;
        v153 = v115;
        v116 = "\n[SET-ELIMINATE] {_eliminateCompleteIfAllDone} [SUCCESS] done with set-identifier elimination | eliminateTracker:%{public}@";
LABEL_84:
        _os_log_impl(&dword_0, v113, OS_LOG_TYPE_DEFAULT, v116, buf, 0xCu);
      }
    }

    else if (v114)
    {
      v115 = [v138 summary];
      *buf = 138543362;
      v153 = v115;
      v116 = "\n[ELIMINATE] {_eliminateCompleteIfAllDone} [SUCCESS] done with asset-selector elimination | eliminateTracker:%{public}@ | MA_MILESTONE";
      goto LABEL_84;
    }

    v121 = [v138 assetSelector];
    v117 = [v121 persistedEntryID];

    v14 = v104;
    if (v117)
    {
      v119 = [(MADAutoAssetControlManager *)v139 activelyEliminatingSelectors];
      [v119 removeObjectForKey:v117];
LABEL_89:

      goto LABEL_15;
    }

    v119 = [(MADAutoAssetControlManager *)v139 autoControlManagerFSM];
    v120 = [v119 diag];
    v122 = [NSString alloc];
    v123 = [v138 summary];
    v124 = [v122 initWithFormat:@"{_eliminateCompleteIfAllDone} nil persistedEntryID | eliminateTracker:%@", v123];
    [v120 trackAnomaly:@"AUTO-CONTROL" forReason:v124 withResult:6111 withError:0];

LABEL_88:
    goto LABEL_89;
  }

LABEL_16:
}

- (BOOL)_doesEliminateSelector:(id)a3 matchAssetType:(id)a4 withAssetSpecifier:(id)a5 withAssetVersion:(id)a6 fromLocation:(id)a7
{
  v11 = a3;
  v12 = a4;
  v13 = a5;
  v14 = a6;
  v15 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v16 = [v15 extendedStateQueue];
  dispatch_assert_queue_V2(v16);

  v17 = [v11 assetVersion];

  if (v17)
  {
    v18 = [v11 assetType];
    if ([SUCore stringIsEqual:v12 to:v18])
    {
      v19 = [v11 assetSpecifier];
      if ([SUCore stringIsEqual:v13 to:v19])
      {
        v20 = [v11 assetVersion];
        v21 = [SUCore stringIsEqual:v14 to:v20];
      }

      else
      {
        v21 = 0;
      }

      goto LABEL_10;
    }

    v21 = 0;
  }

  else
  {
    v22 = [v11 assetSpecifier];

    v18 = [v11 assetType];
    v23 = [SUCore stringIsEqual:v12 to:v18];
    v21 = (v22 == 0) & v23;
    if (v22 && (v23 & 1) != 0)
    {
      v19 = [v11 assetSpecifier];
      v21 = [SUCore stringIsEqual:v13 to:v19];
LABEL_10:
    }
  }

  return v21;
}

- (BOOL)timerStartForRequest:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:timerStartForRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v43 = 0;
  v11 = [(MADAutoAssetControlManager *)self clientRequestTimeoutSecs:v6 timeoutWasSpecified:&v43];
  if (v11 == -2 || (v43 & 1) == 0)
  {
    if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
    {
      v11 = +[MADAutoAssetControlManager preferenceBeforeFirstDefaultTimeoutSecs];
      if (v11 < 0)
      {
        v11 = 600;
LABEL_8:
        v13 = [[MADAutoAssetTimed alloc] initForRequest:v6 withTimeout:v11];
        if (!v13)
        {
          v28 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
          {
            v29 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v30 = [v6 summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = v29;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = v7;
            v51 = 2114;
            v52 = @"AFAIL";
            v53 = 2114;
            v54 = @"AFAIL";
            v55 = 2114;
            v56 = v30;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) failed to create timedOperation\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }

          v12 = 1;
          goto LABEL_23;
        }

        v14 = [(MADAutoAssetControlManager *)self timedOperations];
        v15 = [v13 timerUUID];
        [v14 setSafeObject:v13 forKey:v15];

        v16 = v11;
        v36 = _NSConcreteStackBlock;
        v37 = 3221225472;
        v38 = __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke;
        v39 = &unk_4B4938;
        v40 = self;
        v17 = v13;
        v41 = v17;
        v18 = v7;
        v42 = v18;
        v19 = [NSTimer timerWithTimeInterval:0 repeats:&v36 block:v16];
        [v17 setTimerInstance:{v19, v36, v37, v38, v39, v40}];

        v20 = [v17 timerInstance];
        LODWORD(v19) = v20 == 0;

        if (v19)
        {
          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            v31 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v32 = [v6 summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = v31;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = v18;
            v51 = 2114;
            v52 = @"CFAIL";
            v53 = 2114;
            v54 = @"CFAIL";
            v55 = 2114;
            v56 = v32;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) unable to create timer\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }
        }

        else
        {
          v21 = +[NSRunLoop mainRunLoop];
          v22 = v21 == 0;

          if (!v22)
          {
            [v6 setTimedTracker:v17];
            v23 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
            {
              v24 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v25 = [v6 summaryWithResponseMessage:0];
              *buf = 138544642;
              v46 = v24;
              v47 = 2114;
              v48 = @">----->";
              v49 = 2114;
              v50 = v18;
              v51 = 2114;
              v52 = @"START";
              v53 = 2114;
              v54 = v25;
              v55 = 2114;
              v56 = @"<-----<";
              _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
            }

            v26 = +[NSRunLoop mainRunLoop];
            v27 = [v17 timerInstance];
            [v26 addTimer:v27 forMode:NSDefaultRunLoopMode];

            v12 = 1;
            goto LABEL_22;
          }

          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            v33 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v34 = [v6 summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = v33;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = v18;
            v51 = 2114;
            v52 = @"CFAIL";
            v53 = 2114;
            v54 = @"CFAIL";
            v55 = 2114;
            v56 = v34;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) unable to add timer to run loop\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }
        }

        v12 = 0;
LABEL_22:

LABEL_23:
        goto LABEL_24;
      }
    }
  }

  if (v11 >= 1)
  {
    goto LABEL_8;
  }

  v12 = 1;
LABEL_24:
  os_activity_scope_leave(&state);

  return v12;
}

void __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke_2;
  block[3] = &unk_4B2AF0;
  v4 = *(a1 + 40);
  block[4] = *(a1 + 32);
  v6 = v4;
  v7 = *(a1 + 48);
  dispatch_async(v3, block);
}

void __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke_2(uint64_t a1)
{
  v2 = [*(a1 + 32) timedOperations];
  v3 = [*(a1 + 40) timerUUID];
  v4 = [v2 safeObjectForKey:v3 ofClass:objc_opt_class()];

  v5 = [v4 requestBeingTimed];
  if (([*(a1 + 40) timerInvalidated] & 1) == 0 && v4 && (objc_msgSend(v5, "clientReplyCompletion"), v6 = objc_claimAutoreleasedReturnValue(), v6, v6))
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = [*(a1 + 32) _updateLatestSummary];
      v9 = *(a1 + 48);
      v10 = [v5 summaryWithResponseMessage:0];
      *buf = 138544642;
      v43 = v8;
      v44 = 2114;
      v45 = @">----->";
      v46 = 2114;
      v47 = v9;
      v48 = 2114;
      v49 = @"FIRED";
      v50 = 2114;
      v51 = v10;
      v52 = 2114;
      v53 = @"<-----<";
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
    }

    v11 = [v5 responseError];

    if (!v11)
    {
      v12 = [v5 clientRequestMessage];
      v13 = [v12 messageName];

      v14 = +[MADAutoAssetControlManager allocIntervalString:](MADAutoAssetControlManager, "allocIntervalString:", [*(a1 + 40) timeoutSecs]);
      if (([SUCore stringIsEqual:v13 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0)
      {
        v15 = @"checkForNewer";
        v16 = 6208;
        v17 = @"check job (in the background)";
      }

      else
      {
        v27 = [SUCore stringIsEqual:v13 to:@"MA-AUTO:LOCK_CONTENT"];
        if (v27)
        {
          v17 = @"reduced job (attempting download but will not lock)";
        }

        else
        {
          v17 = @"decoupled job";
        }

        if (v27)
        {
          v15 = @"lockContent";
        }

        else
        {
          v15 = @"operation";
        }

        if (v27)
        {
          v16 = 6505;
        }

        else
        {
          v16 = 6105;
        }
      }

      v28 = [[NSString alloc] initWithFormat:@"requested %@ unable to complete after waiting %@ | (TIMEOUT) continuing %@", v15, v14, v17];
      v29 = [MAAutoAssetError buildError:v16 fromOperation:*(a1 + 48) underlyingError:0 withDescription:v28];
      [v5 setResponseError:v29];
    }

    v30 = [v5 clientRequestMessage];
    v31 = [MADAutoAssetControlManager replyMessageNameForRequest:v30];
    v32 = [v5 clientID];
    v33 = [v5 responseError];
    v34 = [MADAutoAssetControlManager createSeverMessageWithName:v31 sender:@"com.apple.MAAutoControl" clientID:v32 response:0 error:v33];
    [v5 setResponseMessage:v34];

    v35 = *(a1 + 32);
    v36 = [v5 responseMessage];
    v37 = [v5 responseError];
    [v35 issueResponseToClientRequest:v5 issuingResponseMessage:v36 withResponseError:v37];

    [*(a1 + 40) setTimerInvalidated:1];
  }

  else
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      v19 = [*(a1 + 32) _updateLatestSummary];
      v20 = *(a1 + 48);
      v21 = [v5 summaryWithResponseMessage:0];
      *buf = 138544642;
      v43 = v19;
      v44 = 2114;
      v45 = @">----->";
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = @"INVAL";
      v50 = 2114;
      v51 = v21;
      v52 = 2114;
      v53 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
    }

    [*(a1 + 40) setTimerInvalidated:1];
    if (!v4)
    {
      v22 = [*(a1 + 32) autoControlManagerFSM];
      v23 = [v22 diag];
      v24 = [NSString alloc];
      v25 = [*(a1 + 40) summary];
      v26 = [v24 initWithFormat:@"{timerStartForRequest} untracked timer fired | timedOperation:%@", v25];
LABEL_27:
      v41 = v26;
      [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6111 withError:0];

      goto LABEL_28;
    }
  }

  v38 = [*(a1 + 40) timerUUID];

  v39 = *(a1 + 32);
  if (!v38)
  {
    v22 = [v39 autoControlManagerFSM];
    v23 = [v22 diag];
    v40 = [NSString alloc];
    v25 = [*(a1 + 40) summary];
    v26 = [v40 initWithFormat:@"{timerStartForRequest} nil timerUUID | timedOperation:%@", v25];
    goto LABEL_27;
  }

  v22 = [v39 timedOperations];
  v23 = [*(a1 + 40) timerUUID];
  [v22 removeObjectForKey:v23];
LABEL_28:
}

- (void)timerStopForClientRequest:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 timedTracker];
  v11 = [(MADAutoAssetControlManager *)self timedOperations];
  v12 = [v10 timerUUID];
  v13 = [v11 safeObjectForKey:v12 ofClass:objc_opt_class()];

  if (v13)
  {
    v14 = [v13 timerInstance];
    if (v14)
    {
      v15 = v14;
      v16 = [v13 timerInvalidated];

      if ((v16 & 1) == 0)
      {
        [v13 setTimerInvalidated:1];
        v17 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          v18 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v19 = [v6 summaryWithResponseMessage:0];
          v21 = 138544642;
          v22 = v18;
          v23 = 2114;
          v24 = @">----->";
          v25 = 2114;
          v26 = v7;
          v27 = 2114;
          v28 = @"STOPD";
          v29 = 2114;
          v30 = v19;
          v31 = 2114;
          v32 = @"<-----<";
          _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", &v21, 0x3Eu);
        }

        v20 = [v13 timerInstance];
        [v20 fire];
      }
    }
  }
}

- (int64_t)clientRequestTimeoutSecs:(id)a3 timeoutWasSpecified:(BOOL *)a4
{
  v6 = a3;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 clientRequestMessage];
  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:v9];

  if (!v10)
  {
    v11 = 0;
    goto LABEL_14;
  }

  v11 = [v6 clientReplyCompletion];

  if (!v11)
  {
    v14 = 0;
    if (!a4)
    {
      goto LABEL_14;
    }

    goto LABEL_13;
  }

  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageName:v6];
  if ([SUCore stringIsEqual:v12 to:@"MA-AUTO:CHECK_FOR_NEWER"])
  {
    v13 = [v10 checkWaitTimeoutSecs];
LABEL_10:
    v11 = v13;
    v14 = 1;
    goto LABEL_12;
  }

  if ([SUCore stringIsEqual:v12 to:@"MA-AUTO:LOCK_CONTENT"])
  {
    v13 = [v10 lockWaitTimeoutSecs];
    goto LABEL_10;
  }

  v14 = 0;
  v11 = 0;
LABEL_12:

  if (a4)
  {
LABEL_13:
    *a4 = v14;
  }

LABEL_14:

  return v11;
}

+ (BOOL)preferenceScheduledAlwaysNonDiscretionary
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceScheduledAlwaysNonDiscretionary];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceScheduledBackupTriggersDisabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceScheduledBackupTriggersDisabled];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (id)preferenceScheduledOnlyForAssetTypes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = [v2 preferenceScheduledOnlyForAssetTypes];

  if (v3)
  {
    v4 = [v2 preferenceScheduledOnlyForAssetTypes];
    v5 = [v4 componentsSeparatedByString:{@", "}];

    if ([v5 count])
    {
      v6 = v5;
    }

    else
    {
      v6 = objc_alloc_init(NSArray);
    }

    v7 = v6;
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

+ (id)preferenceSessionIDBase
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSessionIDBase];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceConnectorInitialWaitSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceConnectorInitialWaitSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (id)preferenceConnectorBackoffRetryTimes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceConnectorBackoffRetryTimes];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceConnectorWaitBeforeRetrySecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceConnectorWaitBeforeRetrySecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (BOOL)preferenceAutoAssetObserverIgnoreNetworkStatus
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAutoAssetObserverIgnoreNetworkStatus];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceAutoAssetLogSetCompare
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAutoAssetLogSetCompare];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceAutoAssetNoPersistedOverflowLimit
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAutoAssetNoPersistedOverflowLimit];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceMaxStagerDeterminingSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceMaxStagerDeterminingSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceMaxStagerFilesystemMegabytes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceMaxStagerFilesystemMegabytes];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (BOOL)preferenceStagerInjectAvailableDups
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagerInjectAvailableDups];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceStagerInjectAvailableOlderVersions
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagerInjectAvailableOlderVersions];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceStagerDeterminePallasResponseFewer
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagerDeterminePallasResponseFewer];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (BOOL)preferenceStagerDownloadFirstNotInCatalog
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagerDownloadFirstNotInCatalog];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceStagerDetermineLastRequiredTimesOut
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagerDetermineLastRequiredTimesOut];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (id)preferenceAsIfBootedOSIsOSVersion
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAsIfBootedOSIsOSVersion];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (id)preferenceAsIfBootedOSIsBuildVersion
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAsIfBootedOSIsBuildVersion];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceAsIfBackgroundOrUse:(BOOL)a3
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = v4;
  if (v4 && [v4 preferenceAsIfBackgroundSpecified])
  {
    a3 = [v5 preferenceAsIfBackground];
  }

  return a3;
}

+ (BOOL)preferenceAsIfRampOrUse:(BOOL)a3
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = v4;
  if (v4 && [v4 preferenceAsIfRampSpecified])
  {
    a3 = [v5 preferenceAsIfRamp];
  }

  return a3;
}

+ (BOOL)preferenceAlwaysPromoteStagedAssets
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceAlwaysPromoteStagedAssets];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceScheduledAsIfNotInternal
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceScheduledAsIfNotInternal];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceActivityTickerSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityTickerSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceActivityIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityIntervalSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferencePushActivityIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferencePushActivityIntervalSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceActivityHeightenedIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityHeightenedIntervalSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceActivityAggressiveIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityAggressiveIntervalSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (id)preferenceActivityHeightenedAssetType
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityHeightenedAssetType];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (id)preferenceActivityAggressiveAssetType
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceActivityAggressiveAssetType];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceLookupCacheAssetSelectorValidSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceLookupCacheAssetSelectorValidSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceLookupCacheSetConfigurationValidSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceLookupCacheSetConfigurationValidSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceBeforeFirstPollSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceBeforeFirstPollSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceBeforeFirstDefaultTimeoutSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceBeforeFirstDefaultTimeoutSecs];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (BOOL)preferenceSecureSimulateRequireAll
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSecureSimulateRequireAll];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceSecureSimulateFailureAll
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSecureSimulateFailureAll];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceSecureSimulateGraftFailure
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSecureSimulateGraftFailure];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (int64_t)preferenceSimulatedDownloadFailureResult
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSimulatedDownloadFailureResult];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (int64_t)preferenceSimulatedStagingLookupFailureResult
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceSimulatedStagingLookupFailureResult];
  }

  else
  {
    v4 = -1;
  }

  return v4;
}

+ (BOOL)preferencePersistedTableLoggingEnabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferencePersistedTableLoggingEnabled];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferencePerformanceLoggingEnabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferencePerformanceLoggingEnabled];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceStagingLookupFlipRequiredOptional
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStagingLookupFlipRequiredOptional];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceStartupSimulateFirstBoot
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceStartupSimulateFirstBoot];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (BOOL)preferenceForceStartupHealthReport
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceForceStartupHealthReport];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

+ (id)preferenceHealthReportAdditionalSetNames
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    v4 = [v2 preferenceHealthReportAdditionalSetNames];
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (void)_logPersistedEntry:(id)a3 forComponentType:(id)a4 operation:(id)a5 forPersistedEntryID:(id)a6 forClientRequest:(id)a7 withJobUUID:(id)a8 withAssetDescriptor:(id)a9 baseForPatchDescriptor:(id)a10 message:(id)a11
{
  v55 = a3;
  v17 = a4;
  v18 = a5;
  v19 = a6;
  v56 = a7;
  v20 = a8;
  v21 = a9;
  v22 = a10;
  v23 = a11;
  v24 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v25 = [v24 extendedStateQueue];
  dispatch_assert_queue_V2(v25);

  v26 = v19;
  if (v19)
  {
    v52 = v23;
    v53 = v21;
    v27 = v55;
    v51 = [MADAutoAssetPersisted persistedOperationSymbol:v18];
    v28 = [MADAutoAssetPersisted persistedComponentSymbol:v17];
    v29 = _MADLog(@"AutoControl");
    v30 = os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT);
    if (v22)
    {
      if (v56)
      {
        if (v20)
        {
          if (v30)
          {
            v50 = [v53 newSummaryWithoutSelector];
            v31 = [MADAutoAssetControlManager newSummaryForRequestMessage:v56 includingSelector:0];
            [v22 summary];
            *buf = 138548738;
            v58 = @"PERSISTED";
            v59 = 2114;
            v60 = v17;
            v61 = 2114;
            v62 = v18;
            v63 = 2114;
            v64 = v28;
            v65 = 2114;
            v66 = @">----->";
            v67 = 2114;
            v68 = v55;
            v69 = 2114;
            v70 = v52;
            v71 = 2114;
            v72 = v28;
            v73 = 2114;
            v74 = v51;
            v75 = 2114;
            v76 = v26;
            v77 = 2114;
            v78 = v50;
            v79 = 2114;
            v80 = v28;
            v81 = 2114;
            v82 = v51;
            v83 = 2114;
            v84 = v31;
            v85 = 2114;
            v86 = v28;
            v87 = 2114;
            v88 = v51;
            v89 = 2114;
            v90 = v20;
            v91 = 2114;
            v92 = v28;
            v93 = 2114;
            v94 = v51;
            v96 = v95 = 2114;
            v32 = v96;
            v97 = 2114;
            v98 = v28;
            v99 = 2114;
            v100 = @"<-----<";
            v33 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
            v34 = v29;
            v35 = 222;
LABEL_18:
            _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, v33, buf, v35);
          }
        }

        else if (v30)
        {
          v50 = [v53 newSummaryWithoutSelector];
          v31 = [MADAutoAssetControlManager newSummaryForRequestMessage:v56 includingSelector:0];
          [v22 summary];
          *buf = 138547970;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = v17;
          v61 = 2114;
          v62 = v18;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = v55;
          v69 = 2114;
          v70 = v52;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = v50;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = v51;
          v83 = 2114;
          v84 = v31;
          v85 = 2114;
          v86 = v28;
          v87 = 2114;
          v88 = v51;
          v90 = v89 = 2114;
          v32 = v90;
          v91 = 2114;
          v92 = v28;
          v93 = 2114;
          v94 = @"<-----<";
          v33 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
          v34 = v29;
          v35 = 192;
          goto LABEL_18;
        }

LABEL_32:

        v23 = v52;
        v39 = v53;
        goto LABEL_33;
      }

      if (v20)
      {
        if (!v30)
        {
          goto LABEL_32;
        }

        v42 = [v53 newSummaryWithoutSelector];
        v43 = [v22 summary];
        *buf = 138547970;
        v58 = @"PERSISTED";
        v59 = 2114;
        v60 = v17;
        v61 = 2114;
        v62 = v18;
        v63 = 2114;
        v64 = v28;
        v65 = 2114;
        v66 = @">----->";
        v67 = 2114;
        v68 = v55;
        v69 = 2114;
        v70 = v52;
        v71 = 2114;
        v72 = v28;
        v73 = 2114;
        v74 = v51;
        v75 = 2114;
        v76 = v26;
        v77 = 2114;
        v78 = v42;
        v79 = 2114;
        v80 = v28;
        v81 = 2114;
        v82 = v51;
        v83 = 2114;
        v84 = v20;
        v85 = 2114;
        v86 = v28;
        v87 = 2114;
        v88 = v51;
        v89 = 2114;
        v90 = v43;
        v91 = 2114;
        v92 = v28;
        v93 = 2114;
        v94 = @"<-----<";
        v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:(%{public}@) baePatch:%{public}@\n#_%{public}@:%{public}@";
LABEL_15:
        v45 = v29;
        v46 = 192;
LABEL_27:
        _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, v44, buf, v46);

        goto LABEL_31;
      }

      if (!v30)
      {
        goto LABEL_32;
      }

      v42 = [v53 newSummaryWithoutSelector];
      v43 = [v22 summary];
      *buf = 138547202;
      v58 = @"PERSISTED";
      v59 = 2114;
      v60 = v17;
      v61 = 2114;
      v62 = v18;
      v63 = 2114;
      v64 = v28;
      v65 = 2114;
      v66 = @">----->";
      v67 = 2114;
      v68 = v55;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = v28;
      v73 = 2114;
      v74 = v51;
      v75 = 2114;
      v76 = v26;
      v77 = 2114;
      v78 = v42;
      v79 = 2114;
      v80 = v28;
      v81 = 2114;
      v82 = v51;
      v83 = 2114;
      v84 = v43;
      v85 = 2114;
      v86 = v28;
      v87 = 2114;
      v88 = @"<-----<";
      v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
    }

    else
    {
      if (!v56)
      {
        if (v20)
        {
          if (!v30)
          {
            goto LABEL_32;
          }

          v42 = [v53 newSummaryWithoutSelector];
          *buf = 138547202;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = v17;
          v61 = 2114;
          v62 = v18;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = v55;
          v69 = 2114;
          v70 = v23;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = v42;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = v51;
          v83 = 2114;
          v84 = v20;
          v85 = 2114;
          v86 = v28;
          v87 = 2114;
          v88 = @"<-----<";
          v47 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
          v48 = v29;
          v49 = 162;
        }

        else
        {
          if (!v30)
          {
            goto LABEL_32;
          }

          v42 = [v53 newSummaryWithoutSelector];
          *buf = 138546434;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = v17;
          v61 = 2114;
          v62 = v18;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = v55;
          v69 = 2114;
          v70 = v23;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = v42;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = @"<-----<";
          v47 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@";
          v48 = v29;
          v49 = 132;
        }

        _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, v47, buf, v49);
LABEL_31:

        goto LABEL_32;
      }

      if (v20)
      {
        if (!v30)
        {
          goto LABEL_32;
        }

        v42 = [v53 newSummaryWithoutSelector];
        v43 = [MADAutoAssetControlManager newSummaryForRequestMessage:v56 includingSelector:0];
        *buf = 138547970;
        v58 = @"PERSISTED";
        v59 = 2114;
        v60 = v17;
        v61 = 2114;
        v62 = v18;
        v63 = 2114;
        v64 = v28;
        v65 = 2114;
        v66 = @">----->";
        v67 = 2114;
        v68 = v55;
        v69 = 2114;
        v70 = v52;
        v71 = 2114;
        v72 = v28;
        v73 = 2114;
        v74 = v51;
        v75 = 2114;
        v76 = v26;
        v77 = 2114;
        v78 = v42;
        v79 = 2114;
        v80 = v28;
        v81 = 2114;
        v82 = v51;
        v83 = 2114;
        v84 = v43;
        v85 = 2114;
        v86 = v28;
        v87 = 2114;
        v88 = v51;
        v89 = 2114;
        v90 = v20;
        v91 = 2114;
        v92 = v28;
        v93 = 2114;
        v94 = @"<-----<";
        v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
        goto LABEL_15;
      }

      if (!v30)
      {
        goto LABEL_32;
      }

      v42 = [v53 newSummaryWithoutSelector];
      v43 = [MADAutoAssetControlManager newSummaryForRequestMessage:v56 includingSelector:0];
      *buf = 138547202;
      v58 = @"PERSISTED";
      v59 = 2114;
      v60 = v17;
      v61 = 2114;
      v62 = v18;
      v63 = 2114;
      v64 = v28;
      v65 = 2114;
      v66 = @">----->";
      v67 = 2114;
      v68 = v55;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = v28;
      v73 = 2114;
      v74 = v51;
      v75 = 2114;
      v76 = v26;
      v77 = 2114;
      v78 = v42;
      v79 = 2114;
      v80 = v28;
      v81 = 2114;
      v82 = v51;
      v83 = 2114;
      v84 = v43;
      v85 = 2114;
      v86 = v28;
      v87 = 2114;
      v88 = @"<-----<";
      v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:%{public}@";
    }

    v45 = v29;
    v46 = 162;
    goto LABEL_27;
  }

  v36 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [v36 diag];
  v37 = v54 = v22;
  v38 = [NSString alloc];
  [v21 summary];
  v40 = v39 = v21;
  v41 = [v38 initWithFormat:@"{%@:_logPersistedEntry} %@:%@ | no persistedEntryID | %@ | jobUUID:%@ | assetDescriptor:%@", v55, v17, v18, v23, v20, v40];
  [v37 trackAnomaly:@"AUTO-CONTROL" forReason:v41 withResult:6110 withError:0];

  v26 = 0;
  v22 = v54;

  v27 = v55;
LABEL_33:
}

- (void)_logPersistedRemovedEntry:(id)a3 forComponentType:(id)a4 removedPersistedEntryID:(id)a5 removedDescriptor:(id)a6 message:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v19 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v20 = [MADAutoAssetPersisted persistedComponentSymbol:v13];
  if (v14)
  {
    v21 = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
    if (v15)
    {
      if (v22)
      {
        v23 = v12;
        v24 = [v15 newSummaryWithoutSelector];
        *buf = 138546434;
        v33 = @"PERSISTED";
        v34 = 2114;
        v35 = v13;
        v36 = 2114;
        v37 = @"ENTRY_REMOVE";
        v38 = 2114;
        v39 = v20;
        v40 = 2114;
        v41 = @">----->";
        v42 = 2114;
        v43 = v23;
        v44 = 2114;
        v45 = v16;
        v46 = 2114;
        v47 = v20;
        v48 = 2114;
        v49 = v19;
        v50 = 2114;
        v51 = v14;
        v52 = 2114;
        v53 = v24;
        v54 = 2114;
        v55 = v20;
        v56 = 2114;
        v57 = @"<-----<";
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v12 = v23;
      }
    }

    else if (v22)
    {
      *buf = 138546178;
      v33 = @"PERSISTED";
      v34 = 2114;
      v35 = v13;
      v36 = 2114;
      v37 = @"ENTRY_REMOVE";
      v38 = 2114;
      v39 = v20;
      v40 = 2114;
      v41 = @">----->";
      v42 = 2114;
      v43 = v12;
      v44 = 2114;
      v45 = v16;
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = v19;
      v50 = 2114;
      v51 = v14;
      v52 = 2114;
      v53 = v20;
      v54 = 2114;
      v55 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v31 = v19;
    v25 = v12;
    v26 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v27 = [v26 diag];
    v28 = [NSString alloc];
    if (v15)
    {
      v29 = [v15 summary];
    }

    else
    {
      v29 = @"N";
    }

    v30 = [v28 initWithFormat:@"{%@:_logPersistedRemovedEntry} %@ | no persistedEntryID to remove | %@ | removedDescriptor:%@", v25, v13, v16, v29];
    [v27 trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6110 withError:0];

    if (v15)
    {
    }

    v12 = v25;
    v19 = v31;
  }
}

- (void)_logPersistedTableOfContents:(id)a3 forComponentType:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:_logPersistedTableOfContents", v6];
  v11 = [MADAutoAssetPersisted persistedComponentSymbol:v7];
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v41 = self;
  if ([SUCore stringIsEqual:v7 to:@"ACTIVE-JOBS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
LABEL_13:
    v14 = v13;
    v15 = [v13 persistedEntryIDs:v6];
    goto LABEL_14;
  }

  if ([SUCore stringIsEqual:v7 to:@"KNOWN_DESCRIPTORS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:v7 to:@"SET_ACTIVE_JOB_DESCRIPTORS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:v7 to:@"SET_DOWNLOADED_DESCRIPTORS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:v7 to:@"SET_TARGETS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedSetTargets];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:v7 to:@"SET_LOOKUP_RESULTS"])
  {
    v13 = [(MADAutoAssetControlManager *)self persistedSetLookupResults];
    goto LABEL_13;
  }

  v36 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v37 = [v36 diag];
  v38 = [[NSString alloc] initWithFormat:@"{%@} unknown componentType:%@", v10, v7];
  [v37 trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6110 withError:0];

  v15 = 0;
  v14 = 0;
LABEL_14:
  if ([v15 count])
  {
    v40 = v6;
    v44 = [v15 count];
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = v7;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @">----->";
      v56 = 2114;
      v57 = v10;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v17 = v41;
    if (v44 >= 1)
    {
      v18 = 0;
      v42 = v14;
      v43 = v15;
      do
      {
        context = objc_autoreleasePoolPush();
        v19 = [v15 objectAtIndexedSubscript:v18];
        if ([p_weak_ivar_lyt[223] stringIsEqual:v7 to:@"ACTIVE-JOBS"] & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", v7, @"KNOWN_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", v7, @"SET_ACTIVE_JOB_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", v7, @"SET_DOWNLOADED_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", v7, @"SET_TARGETS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", v7, @"SET_LOOKUP_RESULTS"))
        {
          v20 = [v14 persistedEntry:v19 fromLocation:v10];
          if (v20)
          {
            v21 = v20;
            v22 = [v14 decodeFromLocation:v10 ofEntryName:v19 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
            v23 = v22;
            if (v22)
            {
              v24 = [v22 newSummaryWithoutSelector];
              v25 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138544642;
                v26 = @"NO SUMMARY";
                if (v24)
                {
                  v26 = v24;
                }

                v47 = v11;
                v48 = 2114;
                v49 = @"E_LOD";
                v50 = 2048;
                v51 = (v18 + 1);
                v52 = 2048;
                v53 = v44;
                v54 = 2114;
                v55 = v19;
                v56 = 2114;
                v57 = v26;
                _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
              }
            }

            else
            {
              v24 = [(MADAutoAssetControlManager *)v17 autoControlManagerFSM];
              v25 = [(__CFString *)v24 diag];
              v27 = v7;
              v28 = v11;
              v29 = v10;
              v30 = [[NSString alloc] initWithFormat:@"{%@} unable to decode persisted auto-asset-descriptor entryID:%@", v10, v19];
              [v25 trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6110 withError:0];

              v10 = v29;
              v11 = v28;
              v7 = v27;
              v17 = v41;
            }

            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v14 = v42;
            goto LABEL_36;
          }
        }

        else
        {
          v39 = [(MADAutoAssetControlManager *)v17 autoControlManagerFSM];
          v31 = [v39 diag];
          v32 = v14;
          v33 = [[NSString alloc] initWithFormat:@"{%@} second component type check - unknown componentType:%@", v10, v7];
          [v31 trackAnomaly:@"AUTO-CONTROL" forReason:v33 withResult:6110 withError:0];

          v14 = v32;
          v15 = v43;
        }

        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          v34 = [(MADAutoAssetControlManager *)v17 summary];
          *buf = 138544130;
          v47 = v10;
          v48 = 2114;
          v49 = v7;
          v50 = 2114;
          v51 = v34;
          v52 = 2114;
          v53 = v19;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);

LABEL_36:
          v15 = v43;
        }

        objc_autoreleasePoolPop(context);
        ++v18;
      }

      while (v44 != v18);
    }

    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = v7;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @"<-----<";
      v56 = 2114;
      v57 = v10;
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents", buf, 0x3Eu);
    }

    v6 = v40;
  }

  else
  {
    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138545410;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = v7;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @">----->";
      v56 = 2114;
      v57 = v10;
      v58 = 2114;
      v59 = @"empty table-of-contents";
      v60 = 2114;
      v61 = v11;
      v62 = 2114;
      v63 = @"<-----<";
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@", buf, 0x5Cu);
    }
  }
}

- (void)_logPersistedSetConfiguration:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetConfiguration:(id)a6 historyOperation:(int64_t)a7 recordingSpecifiers:(BOOL)a8 message:(id)a9
{
  v15 = a3;
  v16 = a4;
  v17 = a5;
  v18 = a6;
  v19 = a9;
  v20 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v21 = [v20 extendedStateQueue];
  dispatch_assert_queue_V2(v21);

  if (v17)
  {
    v50 = a8;
    v52 = [MADAutoAssetPersisted persistedOperationSymbol:v16];
    v51 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
    v22 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      v23 = [v18 newSummaryWithoutEntryID];
      *buf = 138546434;
      v54 = @"PERSISTED";
      v55 = 2114;
      v56 = @"SET_CONFIGURATIONS";
      v57 = 2114;
      v58 = v16;
      v59 = 2114;
      v60 = v51;
      v61 = 2114;
      v62 = @">----->";
      v63 = 2114;
      v64 = v15;
      v65 = 2114;
      v66 = v19;
      v67 = 2114;
      v68 = v51;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = v17;
      v73 = 2114;
      v74 = v23;
      v75 = 2114;
      v76 = v51;
      v77 = 2114;
      v78 = @"<-----<";
      _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }

    [(MADAutoAssetControlManager *)self _logSetConfigurationEntries:v15 forSetConfiguration:v18];
    if (a7 != 9999)
    {
      v48 = a7;
      v49 = v19;
      v24 = [v18 latestAtomicInstanceToVend];
      v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v15 forAtomicInstanceUUID:v24 requireExists:0];

      v26 = [v18 latestAtomicInstanceToVend];
      v27 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v26];

      v45 = [v18 autoAssetEntries];
      v42 = [v45 count];
      v44 = [v25 requestedAutoAssetEntries];
      v41 = [v44 count];
      v47 = v25;
      v43 = [v25 discoveredAtomicEntries];
      v40 = [v43 count];
      v46 = v27;
      v28 = [v27 instanceEntries];
      v29 = [v28 count];
      v30 = [v18 clientDomainName];
      v31 = [v18 assetSetIdentifier];
      v32 = [v18 latestAtomicInstanceToVend];
      v33 = v32;
      if (v50)
      {
        v34 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetConfiguration:v18];
        [MADAutoAssetHistory recordOperation:v48 toHistoryType:2 fromLayer:1 configuredCount:v42 requestedCount:v41 fromPallasCount:v40 vendingCount:v29 forClientDomainName:v30 forAssetSetIdentifier:v31 forAtomicInstance:v33 withAddendumMessage:v34];
      }

      else
      {
        [MADAutoAssetHistory recordOperation:v48 toHistoryType:2 fromLayer:1 configuredCount:v42 requestedCount:v41 fromPallasCount:v40 vendingCount:v29 forClientDomainName:v30 forAssetSetIdentifier:v31 forAtomicInstance:v32 withAddendumMessage:v15];
      }

      v19 = v49;
    }
  }

  else
  {
    v35 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v36 = [v35 diag];
    v37 = [NSString alloc];
    v38 = [v18 summary];
    v39 = [v37 initWithFormat:@"{%@:_logPersistedSetConfiguration} %@:%@ | no persistedEntryID | %@ | setConfiguration:%@", v15, @"SET_CONFIGURATIONS", v16, v19, v38];
    [v36 trackAnomaly:@"AUTO-CONTROL" forReason:v39 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetConfigurationRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetConfiguration:(id)a5 message:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
  if (v11)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (v12)
    {
      if (v19)
      {
        v20 = v10;
        v21 = [v12 newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_CONFIGURATIONS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = v13;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = v11;
        v49 = 2114;
        v50 = v21;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v10 = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_CONFIGURATIONS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = v10;
      v41 = 2114;
      v42 = v13;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = v11;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = v10;
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = [NSString alloc];
    if (v12)
    {
      v26 = [v12 summary];
    }

    else
    {
      v26 = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetConfigurationRemoved} %@ | no persistedEntryID to remove | %@ | removedSetConfiguration:%@", v22, @"SET_CONFIGURATIONS", v13, v26];
    [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (v12)
    {
    }

    v10 = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetConfigurationTableOfContents:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
  v8 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v9 = [v8 persistedEntryIDs:v4];

  if ([v9 count])
  {
    v10 = [v9 count];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v28 = @"PERSISTED";
      v29 = 2114;
      v30 = @"SET_CONFIGURATIONS";
      v31 = 2114;
      v32 = @"ENTRY_LOAD";
      v33 = 2114;
      v34 = v7;
      v35 = 2114;
      v36 = @">----->";
      v37 = 2114;
      v38 = v4;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v25 = v7;

    if (v10 >= 1)
    {
      v12 = 0;
      v24 = v10;
      do
      {
        context = objc_autoreleasePoolPush();
        v13 = [v9 objectAtIndexedSubscript:v12];
        v14 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v15 = [v14 persistedEntry:v13 fromLocation:v4];

        if (v15)
        {
          v16 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v17 = [v16 decodeFromLocation:v4 ofEntryName:v13 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

          if (v17)
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
            {
              v19 = [v17 newSummaryWithoutEntryID];
              *buf = 138544642;
              v28 = v25;
              v29 = 2114;
              v30 = @"E_LOD";
              v31 = 2048;
              v32 = (v12 + 1);
              v10 = v24;
              v33 = 2048;
              v34 = v24;
              v35 = 2114;
              v36 = v13;
              v37 = 2114;
              v38 = v19;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
            }

            goto LABEL_12;
          }
        }

        else
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            v18 = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v28 = v4;
            v29 = 2114;
            v30 = @"SET_CONFIGURATIONS";
            v31 = 2114;
            v32 = v18;
            v33 = 2114;
            v34 = v13;
            _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetConfigurationTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
LABEL_12:
          }
        }

        objc_autoreleasePoolPop(context);
        ++v12;
      }

      while (v10 != v12);
    }

    v20 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v7 = v25;
      goto LABEL_20;
    }

    *buf = 138544642;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_CONFIGURATIONS";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v7 = v25;
    v34 = v25;
    v35 = 2114;
    v36 = @"<-----<";
    v37 = 2114;
    v38 = v4;
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
    v22 = v20;
    v23 = 62;
    goto LABEL_18;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545410;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_CONFIGURATIONS";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v34 = v7;
    v35 = 2114;
    v36 = @">----->";
    v37 = 2114;
    v38 = v4;
    v39 = 2114;
    v40 = @"empty table-of-contents";
    v41 = 2114;
    v42 = v7;
    v43 = 2114;
    v44 = @"<-----<";
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
    v22 = v20;
    v23 = 92;
LABEL_18:
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, v21, buf, v23);
  }

LABEL_20:
}

- (void)_logPersistedSetAtomicInstance:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetAtomicInstance:(id)a6 message:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  if (v14)
  {
    v19 = [MADAutoAssetPersisted persistedOperationSymbol:v13];
    v20 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v28 = v16;
      v22 = [v15 newSummaryWithoutEntryID];
      *buf = 138546434;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_ATOMIC_INSTANCES";
      v33 = 2114;
      v34 = v13;
      v35 = 2114;
      v36 = v20;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = v12;
      v41 = 2114;
      v42 = v28;
      v43 = 2114;
      v44 = v20;
      v45 = 2114;
      v46 = v19;
      v47 = 2114;
      v48 = v14;
      v49 = 2114;
      v50 = v22;
      v51 = 2114;
      v52 = v20;
      v53 = 2114;
      v54 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

      v16 = v28;
    }

    [(MADAutoAssetControlManager *)self _logAtomicInstanceEntries:v12 forAtomicInstance:v15];
  }

  else
  {
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = [NSString alloc];
    v26 = [v15 summary];
    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetAtomicInstance} %@:%@ | no persistedEntryID | %@ | setAtomicInstance:%@", v12, @"SET_ATOMIC_INSTANCES", v13, v16, v26];
    [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetAtomicInstanceRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetAtomicInstance:(id)a5 message:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
  if (v11)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (v12)
    {
      if (v19)
      {
        v20 = v10;
        v21 = [v12 newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_ATOMIC_INSTANCES";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = v13;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = v11;
        v49 = 2114;
        v50 = v21;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v10 = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_ATOMIC_INSTANCES";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = v10;
      v41 = 2114;
      v42 = v13;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = v11;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = v10;
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = [NSString alloc];
    if (v12)
    {
      v26 = [v12 summary];
    }

    else
    {
      v26 = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetAtomicInstanceRemoved} %@ | no persistedEntryID to remove | %@ | removedSetAtomicInstance:%@", v22, @"SET_ATOMIC_INSTANCES", v13, v26];
    [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (v12)
    {
    }

    v10 = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetAtomicInstanceTableOfContents:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
  v8 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v9 = [v8 persistedEntryIDs:v4];

  if ([v9 count])
  {
    v10 = [v9 count];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v28 = @"PERSISTED";
      v29 = 2114;
      v30 = @"SET_ATOMIC_INSTANCES";
      v31 = 2114;
      v32 = @"ENTRY_LOAD";
      v33 = 2114;
      v34 = v7;
      v35 = 2114;
      v36 = @">----->";
      v37 = 2114;
      v38 = v4;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v25 = v7;

    if (v10 >= 1)
    {
      v12 = 0;
      v24 = v10;
      do
      {
        context = objc_autoreleasePoolPush();
        v13 = [v9 objectAtIndexedSubscript:v12];
        v14 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v15 = [v14 persistedEntry:v13 fromLocation:v4];

        if (v15)
        {
          v16 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v17 = [v16 decodeFromLocation:v4 ofEntryName:v13 fromPersistedEntry:v15 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

          if (v17)
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
            {
              v19 = [v17 newSummaryWithoutEntryID];
              *buf = 138544642;
              v28 = v25;
              v29 = 2114;
              v30 = @"E_LOD";
              v31 = 2048;
              v32 = (v12 + 1);
              v10 = v24;
              v33 = 2048;
              v34 = v24;
              v35 = 2114;
              v36 = v13;
              v37 = 2114;
              v38 = v19;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
            }

            goto LABEL_12;
          }
        }

        else
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            v18 = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v28 = v4;
            v29 = 2114;
            v30 = @"SET_ATOMIC_INSTANCES";
            v31 = 2114;
            v32 = v18;
            v33 = 2114;
            v34 = v13;
            _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetAtomicInstanceTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
LABEL_12:
          }
        }

        objc_autoreleasePoolPop(context);
        ++v12;
      }

      while (v10 != v12);
    }

    v20 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v7 = v25;
      goto LABEL_20;
    }

    *buf = 138544642;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_ATOMIC_INSTANCES";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v7 = v25;
    v34 = v25;
    v35 = 2114;
    v36 = @"<-----<";
    v37 = 2114;
    v38 = v4;
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
    v22 = v20;
    v23 = 62;
    goto LABEL_18;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545410;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_ATOMIC_INSTANCES";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v34 = v7;
    v35 = 2114;
    v36 = @">----->";
    v37 = 2114;
    v38 = v4;
    v39 = 2114;
    v40 = @"empty table-of-contents";
    v41 = 2114;
    v42 = v7;
    v43 = 2114;
    v44 = @"<-----<";
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
    v22 = v20;
    v23 = 92;
LABEL_18:
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, v21, buf, v23);
  }

LABEL_20:
}

- (void)_logPersistedSetDescriptor:(id)a3 forComponentType:(id)a4 operation:(id)a5 forPersistedEntryID:(id)a6 forClientRequest:(id)a7 withJobUUID:(id)a8 withSetDescriptor:(id)a9 message:(id)a10
{
  v46 = a3;
  v47 = a4;
  v16 = a5;
  v17 = a6;
  v18 = a7;
  v19 = a8;
  v20 = a9;
  v21 = a10;
  v22 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v23 = [v22 extendedStateQueue];
  dispatch_assert_queue_V2(v23);

  v48 = v18;
  if (v17)
  {
    v44 = self;
    v45 = v16;
    v24 = [MADAutoAssetPersisted persistedOperationSymbol:v16];
    v25 = v47;
    v26 = [MADAutoAssetPersisted persistedComponentSymbol:?];
    v27 = _MADLog(@"AutoControl");
    v28 = os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT);
    if (v18)
    {
      v29 = v46;
      if (v19)
      {
        if (v28)
        {
          v43 = [v20 summary];
          *buf = 138547970;
          v50 = @"PERSISTED";
          v51 = 2114;
          v52 = v47;
          v53 = 2114;
          v54 = v45;
          v55 = 2114;
          v56 = v26;
          v57 = 2114;
          v58 = @">----->";
          v59 = 2114;
          v60 = v46;
          v61 = 2114;
          v62 = v21;
          v63 = 2114;
          v64 = v26;
          v65 = 2114;
          v66 = v24;
          v67 = 2114;
          v68 = v17;
          v69 = 2114;
          v70 = v43;
          v71 = 2114;
          v72 = v26;
          v73 = 2114;
          v74 = v24;
          v75 = 2114;
          v76 = [MADAutoAssetControlManager newSummaryForSetRequestMessage:v48 includingSetAtomicInstance:0];
          v30 = v76;
          v77 = 2114;
          v78 = v26;
          v79 = 2114;
          v80 = v24;
          v81 = 2114;
          v82 = v19;
          v83 = 2114;
          v84 = v26;
          v85 = 2114;
          v86 = @"<-----<";
          v31 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
          v32 = v27;
          v33 = 192;
LABEL_12:
          _os_log_impl(&dword_0, v32, OS_LOG_TYPE_DEFAULT, v31, buf, v33);
        }
      }

      else if (v28)
      {
        v43 = [v20 summary];
        *buf = 138547202;
        v50 = @"PERSISTED";
        v51 = 2114;
        v52 = v47;
        v53 = 2114;
        v54 = v45;
        v55 = 2114;
        v56 = v26;
        v57 = 2114;
        v58 = @">----->";
        v59 = 2114;
        v60 = v46;
        v61 = 2114;
        v62 = v21;
        v63 = 2114;
        v64 = v26;
        v65 = 2114;
        v66 = v24;
        v67 = 2114;
        v68 = v17;
        v69 = 2114;
        v70 = v43;
        v71 = 2114;
        v72 = v26;
        v73 = 2114;
        v74 = v24;
        v75 = 2114;
        v76 = [MADAutoAssetControlManager newSummaryForSetRequestMessage:v48 includingSetAtomicInstance:0];
        v30 = v76;
        v77 = 2114;
        v78 = v26;
        v79 = 2114;
        v80 = @"<-----<";
        v31 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:%{public}@";
        v32 = v27;
        v33 = 162;
        goto LABEL_12;
      }

LABEL_16:

      [(MADAutoAssetControlManager *)v44 _logSetDescriptorEntries:v29 forSetDescriptor:v20];
      v16 = v45;
      goto LABEL_17;
    }

    v29 = v46;
    if (v19)
    {
      if (!v28)
      {
        goto LABEL_16;
      }

      v39 = [v20 summary];
      *buf = 138547202;
      v50 = @"PERSISTED";
      v51 = 2114;
      v52 = v47;
      v53 = 2114;
      v54 = v45;
      v55 = 2114;
      v56 = v26;
      v57 = 2114;
      v58 = @">----->";
      v59 = 2114;
      v60 = v46;
      v61 = 2114;
      v62 = v21;
      v63 = 2114;
      v64 = v26;
      v65 = 2114;
      v66 = v24;
      v67 = 2114;
      v68 = v17;
      v69 = 2114;
      v70 = v39;
      v71 = 2114;
      v72 = v26;
      v73 = 2114;
      v74 = v24;
      v75 = 2114;
      v76 = v19;
      v77 = 2114;
      v78 = v26;
      v79 = 2114;
      v80 = @"<-----<";
      v40 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
      v41 = v27;
      v42 = 162;
    }

    else
    {
      if (!v28)
      {
        goto LABEL_16;
      }

      v39 = [v20 summary];
      *buf = 138546434;
      v50 = @"PERSISTED";
      v51 = 2114;
      v52 = v47;
      v53 = 2114;
      v54 = v45;
      v55 = 2114;
      v56 = v26;
      v57 = 2114;
      v58 = @">----->";
      v59 = 2114;
      v60 = v46;
      v61 = 2114;
      v62 = v21;
      v63 = 2114;
      v64 = v26;
      v65 = 2114;
      v66 = v24;
      v67 = 2114;
      v68 = v17;
      v69 = 2114;
      v70 = v39;
      v71 = 2114;
      v72 = v26;
      v73 = 2114;
      v74 = @"<-----<";
      v40 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@";
      v41 = v27;
      v42 = 132;
    }

    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, v40, buf, v42);

    goto LABEL_16;
  }

  v34 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v35 = [v34 diag];
  v36 = [NSString alloc];
  v37 = [v20 summary];
  v29 = v46;
  v25 = v47;
  v38 = [v36 initWithFormat:@"{%@:_logPersistedSetDescriptor} %@:%@ | no persistedEntryID | %@ | jobUUID:%@ | setDescriptor:%@", v46, v47, v16, v21, v19, v37];
  [v35 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v38 withResult:6110 withError:0];

  v17 = 0;
LABEL_17:
}

- (void)_logPersistedSetDescriptorRemoved:(id)a3 forComponentType:(id)a4 removedPersistedEntryID:(id)a5 removedSetDescriptor:(id)a6 message:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  v19 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v20 = [MADAutoAssetPersisted persistedComponentSymbol:v13];
  if (v14)
  {
    v21 = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
    if (v15)
    {
      if (v22)
      {
        v23 = v12;
        v24 = [v15 newSummaryWithoutEntryID];
        *buf = 138546434;
        v33 = @"PERSISTED";
        v34 = 2114;
        v35 = v13;
        v36 = 2114;
        v37 = @"ENTRY_REMOVE";
        v38 = 2114;
        v39 = v20;
        v40 = 2114;
        v41 = @">----->";
        v42 = 2114;
        v43 = v23;
        v44 = 2114;
        v45 = v16;
        v46 = 2114;
        v47 = v20;
        v48 = 2114;
        v49 = v19;
        v50 = 2114;
        v51 = v14;
        v52 = 2114;
        v53 = v24;
        v54 = 2114;
        v55 = v20;
        v56 = 2114;
        v57 = @"<-----<";
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v12 = v23;
      }
    }

    else if (v22)
    {
      *buf = 138546178;
      v33 = @"PERSISTED";
      v34 = 2114;
      v35 = v13;
      v36 = 2114;
      v37 = @"ENTRY_REMOVE";
      v38 = 2114;
      v39 = v20;
      v40 = 2114;
      v41 = @">----->";
      v42 = 2114;
      v43 = v12;
      v44 = 2114;
      v45 = v16;
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = v19;
      v50 = 2114;
      v51 = v14;
      v52 = 2114;
      v53 = v20;
      v54 = 2114;
      v55 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v31 = v19;
    v25 = v12;
    v26 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v27 = [v26 diag];
    v28 = [NSString alloc];
    if (v15)
    {
      v29 = [v15 summary];
    }

    else
    {
      v29 = @"N";
    }

    v30 = [v28 initWithFormat:@"{%@:_logPersistedSetDescriptorRemoved} %@ | no persistedEntryID to remove | %@ | removedSetDescriptor:%@", v25, v13, v16, v29];
    [v27 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v30 withResult:6110 withError:0];

    if (v15)
    {
    }

    v12 = v25;
    v19 = v31;
  }
}

- (void)_logPersistedSetDescriptorTableOfContents:(id)a3 forComponentType:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [MADAutoAssetPersisted persistedComponentSymbol:v7];
  v34 = v7;
  v35 = [SUCore stringIsEqual:v7 to:@"SET_ACTIVE_JOB_DESCRIPTORS"];
  if (v35)
  {
    v11 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
    v12 = self;
  }

  else
  {
    v12 = self;
    if (![SUCore stringIsEqual:v7 to:@"SET_DOWNLOADED_DESCRIPTORS"])
    {
      goto LABEL_24;
    }

    v11 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  }

  v13 = [v11 persistedEntryIDs:v6];

  if (v13)
  {
    if ([v13 count])
    {
      v36 = [v13 count];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138544642;
        v38 = @"PERSISTED";
        v39 = 2114;
        v40 = v7;
        v41 = 2114;
        v42 = @"ENTRY_LOAD";
        v43 = 2114;
        v44 = v10;
        v45 = 2114;
        v46 = @">----->";
        v47 = 2114;
        v48 = v6;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
      }

      v33 = v10;

      if (v36 >= 1)
      {
        v15 = 0;
        v31 = v12;
        v32 = v13;
        do
        {
          v16 = objc_autoreleasePoolPush();
          v17 = [v13 objectAtIndexedSubscript:v15];
          if (v35)
          {
            [(MADAutoAssetControlManager *)v12 persistedActiveJobSetDescriptors];
          }

          else
          {
            [(MADAutoAssetControlManager *)v12 persistedDownloadedSetDescriptors];
          }
          v18 = ;
          v19 = [v18 persistedEntry:v17 fromLocation:v6];
          if (v19)
          {
            v20 = [v18 decodeFromLocation:v6 ofEntryName:v17 fromPersistedEntry:v19 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
            if (v20)
            {
              v21 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
              {
                v22 = [v20 newSummaryWithoutEntryID];
                *buf = 138544642;
                v38 = v33;
                v39 = 2114;
                v40 = @"E_LOD";
                v41 = 2048;
                v42 = (v15 + 1);
                v12 = v31;
                v43 = 2048;
                v44 = v36;
                v45 = 2114;
                v46 = v17;
                v47 = 2114;
                v48 = v22;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);

                v13 = v32;
              }
            }
          }

          else
          {
            v20 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
            {
              v23 = [(MADAutoAssetControlManager *)v12 summary];
              *buf = 138544130;
              v38 = v6;
              v39 = 2114;
              v40 = v34;
              v41 = 2114;
              v42 = v23;
              v43 = 2114;
              v44 = v17;
              _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetDescriptorTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
            }
          }

          objc_autoreleasePoolPop(v16);
          ++v15;
        }

        while (v36 != v15);
      }

      v24 = _MADLog(@"AutoControl");
      v10 = v33;
      if (!os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        goto LABEL_28;
      }

      *buf = 138544642;
      v38 = @"PERSISTED";
      v39 = 2114;
      v40 = v34;
      v41 = 2114;
      v42 = @"ENTRY_LOAD";
      v43 = 2114;
      v44 = v33;
      v45 = 2114;
      v46 = @"<-----<";
      v47 = 2114;
      v48 = v6;
      v25 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
      v26 = v24;
      v27 = 62;
    }

    else
    {
      v24 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
LABEL_28:

        goto LABEL_29;
      }

      *buf = 138545410;
      v38 = @"PERSISTED";
      v39 = 2114;
      v40 = v7;
      v41 = 2114;
      v42 = @"ENTRY_LOAD";
      v43 = 2114;
      v44 = v10;
      v45 = 2114;
      v46 = @">----->";
      v47 = 2114;
      v48 = v6;
      v49 = 2114;
      v50 = @"empty table-of-contents";
      v51 = 2114;
      v52 = v10;
      v53 = 2114;
      v54 = @"<-----<";
      v25 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
      v26 = v24;
      v27 = 92;
    }

    _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, v25, buf, v27);
    goto LABEL_28;
  }

LABEL_24:
  v28 = [(MADAutoAssetControlManager *)v12 autoControlManagerFSM];
  v29 = [v28 diag];
  v30 = [[NSString alloc] initWithFormat:@"{%@:_logPersistedSetDescriptorTableOfContents} | no persisted-state for componentType:%@", v6, v7];
  [v29 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v30 withResult:6110 withError:0];

LABEL_29:
}

- (id)locateDownloadedByFullSelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 persistedEntryID];

  v8 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  LODWORD(v6) = [v8 persistedEntryAlreadyExists:v7 fromLocation:@"locateDownloadedByFullSelector"];

  if (!v6)
  {
    v13 = 0;
    goto LABEL_14;
  }

  v9 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v10 = [v9 persistedEntry:v7 fromLocation:@"locateDownloadedByFullSelector"];

  if (v10)
  {
    v11 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v12 = [v11 decodeFromLocation:@"locateDownloadedByFullSelector" ofEntryName:v7 fromPersistedEntry:v10 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    if (v12)
    {
      if ([v12 isOnFilesystem])
      {
        v13 = v12;
LABEL_12:

        goto LABEL_13;
      }
    }

    else
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v16 = 138543362;
        v17 = v7;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "{locateDownloadedByFullSelector} | no auto-asset-descriptor entry found for entry:%{public}@", &v16, 0xCu);
      }
    }

    v13 = 0;
    goto LABEL_12;
  }

  v13 = 0;
LABEL_13:

LABEL_14:

  return v13;
}

- (id)locateDownloadedNewForSelector:(id)a3 assetSelector:(id)a4 limitedToStaging:(BOOL)a5
{
  v59 = a5;
  v7 = a3;
  v8 = a4;
  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v10 = [v9 extendedStateQueue];
  dispatch_assert_queue_V2(v10);

  v11 = [[NSString alloc] initWithFormat:@"%@:locateDownloadedNewForSelector", v7];
  v12 = objc_alloc_init(NSMutableDictionary);
  v13 = [v8 assetSpecifier];
  if (v13 && (v14 = v13, [v8 assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v15, @"MAAutoAsset-all-asset-specifiers"), v15, v14, !v16))
  {
    v17 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v18 = [v17 persistedEntryIDs:v11 assetSelector:v8];
  }

  else
  {
    v17 = [v8 assetType];
    v18 = [(MADAutoAssetControlManager *)self locatePersistedKnownDescriptorEntryIDs:v7 forAssetType:v17];
  }

  v19 = v18;

  if (!v19 || ![v19 count])
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEBUG))
    {
      v29 = [v8 summary];
      *buf = 138543618;
      v67 = v11;
      v68 = 2114;
      v69 = v29;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEBUG, "{%{public}@} no persisted-entry found | assetSelector:%{public}@", buf, 0x16u);
    }

    v30 = &__NSDictionary0__struct;
    goto LABEL_52;
  }

  v20 = [v8 assetSpecifier];
  if (v20)
  {
    v21 = v20;
    v22 = [v8 assetVersion];

    if (v22)
    {
      v23 = [v8 persistedEntryID];
      v24 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v25 = [v24 persistedEntry:v23 fromLocation:v11];

      v57 = v23;
      if (v25)
      {
        v26 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v27 = [v26 decodeFromLocation:v11 ofEntryName:v23 fromPersistedEntry:v25 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v27)
        {
          if ([v27 isOnFilesystem]&& (!v59 || [v27 preSoftwareUpdateAssetStaging]))
          {
            [v12 setSafeObject:v27 forKey:v23];
          }
        }

        else
        {
          v49 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v67 = v11;
            v68 = 2114;
            v69 = v57;
            _os_log_impl(&dword_0, v49, OS_LOG_TYPE_ERROR, "{%{public}@} no auto-asset-descriptor entry found | entry:%{public}@", buf, 0x16u);
          }
        }
      }

      else
      {
        v27 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v67 = v11;
          v68 = 2114;
          v69 = v23;
          _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{%{public}@} no persisted-entry found | entry:%{public}@", buf, 0x16u);
        }
      }

      goto LABEL_51;
    }
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v11 ofContainer:@"persistedKnownDescriptors"];
  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v52 = v19;
  v31 = v19;
  v32 = [v31 countByEnumeratingWithState:&v61 objects:v65 count:16];
  v57 = v31;
  if (!v32)
  {
    goto LABEL_44;
  }

  v33 = v32;
  v53 = v12;
  v58 = v8;
  v51 = v7;
  v60 = *v62;
  v55 = self;
  v56 = v11;
  do
  {
    for (i = 0; i != v33; i = i + 1)
    {
      if (*v62 != v60)
      {
        objc_enumerationMutation(v31);
      }

      v35 = *(*(&v61 + 1) + 8 * i);
      v36 = objc_autoreleasePoolPush();
      v37 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v38 = [v37 persistedEntry:v35 fromLocation:v11];

      if (v38)
      {
        v39 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v40 = [v39 decodeFromLocation:v11 ofEntryName:v35 fromPersistedEntry:v38 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v40)
        {
          if ([v40 isOnFilesystem]&& (!v59 || [v40 preSoftwareUpdateAssetStaging]))
          {
            v41 = [v58 assetSpecifier];

            v42 = [v40 assetType];
            v43 = [v58 assetType];
            v44 = [SUCore stringIsEqual:v42 to:v43];
            v45 = v44;
            if (v41)
            {
              if (v44)
              {
                v46 = [v40 assetSpecifier];
                v47 = [v58 assetSpecifier];
                v54 = [SUCore stringIsEqual:v46 to:v47];

                if (!v54)
                {
                  goto LABEL_40;
                }

LABEL_38:
                [v53 setSafeObject:v40 forKey:v35];
              }

              else
              {
              }
            }

            else
            {

              if (v45)
              {
                goto LABEL_38;
              }
            }

LABEL_40:
            self = v55;
            v11 = v56;
            v31 = v57;
          }
        }

        else
        {
          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v67 = v11;
            v68 = 2114;
            v69 = v35;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "{%{public}@} no auto-asset-descriptor entry found | entry:%{public}@", buf, 0x16u);
          }
        }
      }

      else
      {
        v40 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v67 = v11;
          v68 = 2114;
          v69 = v35;
          _os_log_impl(&dword_0, v40, OS_LOG_TYPE_ERROR, "{%{public}@} no persisted-entry found | entry:%{public}@", buf, 0x16u);
        }
      }

      objc_autoreleasePoolPop(v36);
    }

    v33 = [v31 countByEnumeratingWithState:&v61 objects:v65 count:16];
  }

  while (v33);
  v7 = v51;
  v8 = v58;
  v12 = v53;
LABEL_44:
  v19 = v52;
LABEL_51:

  v30 = v12;
LABEL_52:

  return v30;
}

- (id)locatePersistedKnownDescriptorEntryIDs:(id)a3 forAssetType:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:locatePersistedKnownDescriptorEntryIDs", v6];
  v11 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v34 = v7;
  v12 = [v11 persistedEntryIDs:v10 assetType:v7];

  v32 = objc_alloc_init(NSMutableArray);
  if ([v12 count])
  {
    v31 = v6;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v10 ofContainer:@"persistedKnownDescriptors"];
    v38 = 0u;
    v39 = 0u;
    v36 = 0u;
    v37 = 0u;
    v30 = v12;
    obj = v12;
    v13 = [obj countByEnumeratingWithState:&v36 objects:v44 count:16];
    if (v13)
    {
      v14 = v13;
      v15 = *v37;
      v33 = v10;
      do
      {
        for (i = 0; i != v14; i = i + 1)
        {
          if (*v37 != v15)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v36 + 1) + 8 * i);
          v18 = objc_autoreleasePoolPush();
          v19 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v20 = [v19 persistedEntry:v17 fromLocation:v10];

          if (v20)
          {
            v21 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v22 = [v21 decodeFromLocation:v10 ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v22)
            {
              v23 = v14;
              v24 = self;
              v25 = v15;
              v26 = [v22 assetType];
              v27 = [SUCore stringIsEqual:v26 to:v34];

              if (v27)
              {
                [v32 addObject:v17];
              }

              v15 = v25;
              self = v24;
              v14 = v23;
              v10 = v33;
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v41 = v10;
                v42 = 2114;
                v43 = v17;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load known descriptor | entry:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              v41 = v10;
              v42 = 2114;
              v43 = v17;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load persisted-state entry | entry:%{public}@", buf, 0x16u);
            }
          }

          objc_autoreleasePoolPop(v18);
        }

        v14 = [obj countByEnumeratingWithState:&v36 objects:v44 count:16];
      }

      while (v14);
    }

    v12 = v30;
    v6 = v31;
  }

  return v32;
}

- (id)locateDownloadedNewBySelectorForAssetType:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v29 = v4;
  v8 = [v7 persistedEntryIDs:@"locateDownloadedNewAllBySelector" assetType:v4];

  v27 = objc_alloc_init(NSMutableDictionary);
  if ([v8 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateDownloadedNewBySelectorForAssetType" ofContainer:@"persistedKnownDescriptors"];
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    v26 = v8;
    v9 = v8;
    v30 = [v9 countByEnumeratingWithState:&v31 objects:v37 count:16];
    if (v30)
    {
      v10 = *v32;
      v11 = @"locateDownloadedNewBySelectorForAssetType";
      v28 = self;
      do
      {
        for (i = 0; i != v30; i = i + 1)
        {
          if (*v32 != v10)
          {
            objc_enumerationMutation(v9);
          }

          v13 = *(*(&v31 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v16 = [v15 persistedEntry:v13 fromLocation:v11];

          if (v16)
          {
            v17 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v18 = [v17 decodeFromLocation:@"locateDownloadedNewAllBySelector" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              if ([v18 isOnFilesystem])
              {
                v19 = v11;
                v20 = v10;
                v21 = v9;
                v22 = [v18 assetType];
                v23 = [SUCore stringIsEqual:v22 to:v29];

                if (v23)
                {
                  [v27 setSafeObject:v18 forKey:v13];
                }

                v9 = v21;
                v10 = v20;
                v11 = v19;
                self = v28;
              }
            }

            else
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v36 = v13;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "{locateDownloadedNewBySelectorForAssetType} | no auto-asset-descriptor entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v36 = v13;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateDownloadedNewBySelectorForAssetType} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v14);
        }

        v30 = [v9 countByEnumeratingWithState:&v31 objects:v37 count:16];
      }

      while (v30);
    }

    v8 = v26;
  }

  return v27;
}

- (id)locateDownloadedNewBySelectorLimitedToStaging:(BOOL)a3
{
  v22 = a3;
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(v5);

  v6 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [v6 persistedEntryIDs:@"locateDownloadedNewAllBySelector"];

  v21 = objc_alloc_init(NSMutableDictionary);
  if ([v7 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateDownloadedNewBySelectorLimitedToStaging" ofContainer:@"persistedKnownDescriptors"];
    v26 = 0u;
    v27 = 0u;
    v24 = 0u;
    v25 = 0u;
    v20 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v24 objects:v30 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v25;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v25 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v24 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          v14 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v15 = [v14 persistedEntry:v12 fromLocation:@"locateDownloadedNewAllBySelector"];

          if (v15)
          {
            v16 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v17 = [v16 decodeFromLocation:@"locateDownloadedNewAllBySelector" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              if ([v17 isOnFilesystem]&& (!v22 || [v17 preSoftwareUpdateAssetStaging]))
              {
                [v21 setSafeObject:v17 forKey:v12];
              }
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v29 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateDownloadedNewAllBySelector} | no auto-asset-descriptor entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v29 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateDownloadedNewAllBySelector} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v24 objects:v30 count:16];
      }

      while (v9);
    }

    v7 = v20;
  }

  return v21;
}

- (int64_t)locateDownloadedCurrentDownloadedCount
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v6 = [v5 persistedEntryIDs:@"locateDownloadedCurrentDownloadedCount"];

  v7 = [v6 count];
  return v7;
}

- (id)locateActiveJobDescriptorBySelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [v4 persistedEntryID];

  v8 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  LODWORD(v6) = [v8 persistedEntryAlreadyExists:v7 fromLocation:@"locateActiveJobDescriptorBySelector"];

  if (v6)
  {
    v9 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v10 = [v9 persistedEntry:v7 fromLocation:@"locateActiveJobDescriptorBySelector"];

    if (v10)
    {
      v11 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v12 = [v11 decodeFromLocation:@"locateActiveJobDescriptorBySelector" ofEntryName:v7 fromPersistedEntry:v10 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
    }

    else
    {
      v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v13 = [v11 diag];
      v14 = [[NSString alloc] initWithFormat:@"{locateActiveJobDescriptorBySelector} no jobPersistedState | persistedEntryID:%@", v7];
      [v13 trackAnomaly:@"AUTO-CONTROL" forReason:v14 withResult:6101 withError:0];

      v12 = 0;
    }
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (id)_specifierVersionNamesForSetDescriptor:(id)a3
{
  v3 = a3;
  v4 = [v3 latestDowloadedAtomicInstanceEntries];
  if (v4)
  {
    v5 = v4;
  }

  else
  {
    v5 = [v3 discoveredAtomicEntries];
    if (!v5)
    {
      v6 = 0;
      goto LABEL_19;
    }
  }

  v20 = v3;
  v6 = objc_msgSend([NSMutableString alloc], "initWithString:", @"(");
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  v5 = v5;
  v7 = [v5 countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v22;
    v10 = 1;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v22 != v9)
        {
          objc_enumerationMutation(v5);
        }

        v12 = *(*(&v21 + 1) + 8 * i);
        if (v12)
        {
          if ((v10 & 1) == 0)
          {
            [v6 appendString:{@", "}];
          }

          v13 = [v12 fullAssetSelector];
          v14 = [v13 assetVersion];

          v15 = [v12 fullAssetSelector];
          v16 = [v15 assetSpecifier];
          if (v14)
          {
            v17 = [v12 fullAssetSelector];
            v18 = [v17 assetVersion];
            [v6 appendFormat:@"%@<%@>", v16, v18];
          }

          else
          {
            [v6 appendString:v16];
          }

          v10 = 0;
        }
      }

      v8 = [v5 countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v8);
  }

  [v6 appendString:@""]);
  v3 = v20;
LABEL_19:

  return v6;
}

- (id)_specifierVersionNamesForAtomicInstance:(id)a3
{
  v4 = [a3 instanceEntries];
  v5 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetEntries:v4];

  return v5;
}

- (id)_specifierVersionNamesForSetConfiguration:(id)a3
{
  v4 = [a3 autoAssetEntries];
  v5 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetEntries:v4];

  return v5;
}

- (id)_specifierVersionNamesForSetEntries:(id)a3
{
  v3 = a3;
  if (v3)
  {
    v4 = objc_msgSend([NSMutableString alloc], "initWithString:", @"(");
    v20 = 0u;
    v21 = 0u;
    v22 = 0u;
    v23 = 0u;
    v19 = v3;
    v5 = v3;
    v6 = [v5 countByEnumeratingWithState:&v20 objects:v24 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v21;
      v9 = 1;
      do
      {
        for (i = 0; i != v7; i = i + 1)
        {
          if (*v21 != v8)
          {
            objc_enumerationMutation(v5);
          }

          v11 = *(*(&v20 + 1) + 8 * i);
          if (v11)
          {
            if ((v9 & 1) == 0)
            {
              [v4 appendString:{@", "}];
            }

            v12 = [v11 assetSelector];
            v13 = [v12 assetVersion];

            v14 = [v11 assetSelector];
            v15 = [v14 assetSpecifier];
            if (v13)
            {
              v16 = [v11 assetSelector];
              v17 = [v16 assetVersion];
              [v4 appendFormat:@"%@(%@)", v15, v17];
            }

            else
            {
              [v4 appendString:v15];
            }

            v9 = 0;
          }
        }

        v7 = [v5 countByEnumeratingWithState:&v20 objects:v24 count:16];
      }

      while (v7);
    }

    [v4 appendString:@""]);
    v3 = v19;
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (void)_logPersistedSetTarget:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetTarget:(id)a6 message:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  if (v14)
  {
    v19 = [MADAutoAssetPersisted persistedOperationSymbol:v13];
    v20 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v22 = [v15 newSummaryWithoutEntryID];
      *buf = 138546434;
      v27 = @"PERSISTED";
      v28 = 2114;
      v29 = @"SET_TARGETS";
      v30 = 2114;
      v31 = v13;
      v32 = 2114;
      v33 = v20;
      v34 = 2114;
      v35 = @">----->";
      v36 = 2114;
      v37 = v12;
      v38 = 2114;
      v39 = v16;
      v40 = 2114;
      v41 = v20;
      v42 = 2114;
      v43 = v19;
      v44 = 2114;
      v45 = v14;
      v46 = 2114;
      v47 = v22;
      v48 = 2114;
      v49 = v20;
      v50 = 2114;
      v51 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }
  }

  else
  {
    v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v20 = [v19 diag];
    v23 = [NSString alloc];
    v24 = [v15 summary];
    v25 = [v23 initWithFormat:@"{%@:_logPersistedSetTarget} %@:%@ | no persistedEntryID | %@ | setTarget:%@", v12, @"SET_TARGETS", v13, v16, v24];
    [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetTargetRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetTarget:(id)a5 message:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
  if (v11)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (v12)
    {
      if (v19)
      {
        v20 = v10;
        v21 = [v12 newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_TARGETS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = v13;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = v11;
        v49 = 2114;
        v50 = v21;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v10 = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_TARGETS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = v10;
      v41 = 2114;
      v42 = v13;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = v11;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = v10;
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = [NSString alloc];
    if (v12)
    {
      v26 = [v12 summary];
    }

    else
    {
      v26 = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetConfigurationRemoved} %@ | no persistedEntryID to remove | %@ | removedSetTarget:%@", v22, @"SET_TARGETS", v13, v26];
    [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (v12)
    {
    }

    v10 = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetTargetTableOfContents:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = [[NSString alloc] initWithFormat:@"%@:_logPersistedSetTargetTableOfContents", v4];
  v8 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
  v9 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v10 = [v9 persistedEntryIDs:v7];

  v27 = v10;
  if ([v10 count])
  {
    v24 = v4;
    v11 = [v10 count];
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v35 = v8;
      v36 = 2114;
      v37 = @">----->";
      v38 = 2114;
      v39 = v7;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v26 = v8;

    if (v11 >= 1)
    {
      v13 = 0;
      v25 = v11;
      do
      {
        v14 = objc_autoreleasePoolPush();
        v15 = [v27 objectAtIndexedSubscript:v13];
        v16 = [(MADAutoAssetControlManager *)self persistedSetTargets];
        v17 = [v16 persistedEntry:v15 fromLocation:v7];

        if (v17)
        {
          v18 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v19 = [v18 decodeFromLocation:v7 ofEntryName:v15 fromPersistedEntry:v17 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

          v20 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
          {
            v21 = [v19 newSummaryWithoutEntryID];
            *buf = 138544642;
            v11 = v25;
            v29 = v26;
            v30 = 2114;
            v31 = @"E_LOD";
            v32 = 2048;
            v33 = (v13 + 1);
            v34 = 2048;
            v35 = v25;
            v36 = 2114;
            v37 = v15;
            v38 = 2114;
            v39 = v21;
            _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
          }
        }

        else
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            v22 = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v29 = v7;
            v30 = 2114;
            v31 = @"SET_TARGETS";
            v32 = 2114;
            v33 = v22;
            v34 = 2114;
            v35 = v15;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetTargetTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
          }
        }

        objc_autoreleasePoolPop(v14);
        ++v13;
      }

      while (v11 != v13);
    }

    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v8 = v26;
      v35 = v26;
      v36 = 2114;
      v37 = @"<-----<";
      v38 = 2114;
      v39 = v7;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents", buf, 0x3Eu);
      v4 = v24;
    }

    else
    {
      v4 = v24;
      v8 = v26;
    }
  }

  else
  {
    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138545410;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v35 = v8;
      v36 = 2114;
      v37 = @">----->";
      v38 = 2114;
      v39 = v7;
      v40 = 2114;
      v41 = @"empty table-of-contents";
      v42 = 2114;
      v43 = v8;
      v44 = 2114;
      v45 = @"<-----<";
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@", buf, 0x5Cu);
    }
  }
}

- (void)_logPersistedSetLookupResult:(id)a3 operation:(id)a4 forPersistedEntryID:(id)a5 withSetLookupResult:(id)a6 message:(id)a7
{
  v12 = a3;
  v13 = a4;
  v14 = a5;
  v15 = a6;
  v16 = a7;
  v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v18 = [v17 extendedStateQueue];
  dispatch_assert_queue_V2(v18);

  if (v14)
  {
    v19 = [MADAutoAssetPersisted persistedOperationSymbol:v13];
    v20 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_LOOKUP_RESULTS"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v22 = [v15 newSummaryWithoutEntryID];
      *buf = 138546434;
      v27 = @"PERSISTED";
      v28 = 2114;
      v29 = @"SET_LOOKUP_RESULTS";
      v30 = 2114;
      v31 = v13;
      v32 = 2114;
      v33 = v20;
      v34 = 2114;
      v35 = @">----->";
      v36 = 2114;
      v37 = v12;
      v38 = 2114;
      v39 = v16;
      v40 = 2114;
      v41 = v20;
      v42 = 2114;
      v43 = v19;
      v44 = 2114;
      v45 = v14;
      v46 = 2114;
      v47 = v22;
      v48 = 2114;
      v49 = v20;
      v50 = 2114;
      v51 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }
  }

  else
  {
    v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v20 = [v19 diag];
    v23 = [NSString alloc];
    v24 = [v15 summary];
    v25 = [v23 initWithFormat:@"{%@:_logPersistedSetLookupResult} %@:%@ | no persistedEntryID | %@ | setLookupResult:%@", v12, @"SET_LOOKUP_RESULTS", v13, v16, v24];
    [v20 trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetLookupResultRemoved:(id)a3 removedPersistedEntryID:(id)a4 removedSetLookupResult:(id)a5 message:(id)a6
{
  v10 = a3;
  v11 = a4;
  v12 = a5;
  v13 = a6;
  v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v15 = [v14 extendedStateQueue];
  dispatch_assert_queue_V2(v15);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_LOOKUP_RESULTS"];
  if (v11)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (v12)
    {
      if (v19)
      {
        v20 = v10;
        v21 = [v12 newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_LOOKUP_RESULTS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = v13;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = v11;
        v49 = 2114;
        v50 = v21;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        v10 = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_LOOKUP_RESULTS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = v10;
      v41 = 2114;
      v42 = v13;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = v11;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = v10;
    v23 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v23 diag];
    v25 = [NSString alloc];
    if (v12)
    {
      v26 = [v12 summary];
    }

    else
    {
      v26 = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetLookupResultRemoved} %@ | no persistedEntryID to remove | %@ | removedSetLookupResult:%@", v22, @"SET_LOOKUP_RESULTS", v13, v26];
    [v24 trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (v12)
    {
    }

    v10 = v22;
    v16 = v28;
  }
}

- (void)_logSetConfigurationEntries:(id)a3 forSetConfiguration:(id)a4
{
  v23 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSMutableString alloc] initWithString:@"{\n"];
  v24 = 0u;
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  v10 = [v6 autoAssetEntries];
  v11 = [v10 countByEnumeratingWithState:&v24 objects:v38 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v25;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v25 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(*(&v24 + 1) + 8 * i);
        if (v15)
        {
          v16 = [v15 assetSelector];
          v17 = [(MADAutoAssetControlManager *)self _shortNameForSelector:v16];
          [v9 appendFormat:@"  %@\n", v17];
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v24 objects:v38 count:16];
    }

    while (v12);
  }

  [v9 appendString:@"}"];
  v18 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
  {
    v19 = [v6 latestAtomicInstanceToVend];
    if (v19)
    {
      v20 = [v6 latestAtomicInstanceToVend];
    }

    else
    {
      v20 = @"N";
    }

    v21 = [v6 assetSetIdentifier];
    v22 = [v6 firstEntryAssetType];
    *buf = 138544386;
    v29 = v23;
    v30 = 2114;
    v31 = v20;
    v32 = 2114;
    v33 = v21;
    v34 = 2114;
    v35 = v22;
    v36 = 2114;
    v37 = v9;
    _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@] assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x34u);

    if (v19)
    {
    }
  }
}

- (void)_logAtomicInstanceEntries:(id)a3 forAtomicInstance:(id)a4
{
  v26 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [[NSMutableString alloc] initWithString:@"{\n"];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v25 = v6;
  v10 = [v6 instanceEntries];
  v11 = [v10 countByEnumeratingWithState:&v27 objects:v41 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = 0;
    v14 = *v28;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v28 != v14)
        {
          objc_enumerationMutation(v10);
        }

        v16 = *(*(&v27 + 1) + 8 * i);
        if (v16)
        {
          if (!v13)
          {
            v17 = [*(*(&v27 + 1) + 8 * i) assetSelector];
            v13 = [v17 assetType];
          }

          v18 = [v16 assetSelector];
          v19 = [(MADAutoAssetControlManager *)self _shortNameForSelector:v18];
          [v9 appendFormat:@"  %@\n", v19];
        }
      }

      v12 = [v10 countByEnumeratingWithState:&v27 objects:v41 count:16];
    }

    while (v12);
  }

  else
  {
    v13 = 0;
  }

  [v9 appendString:@"}"];
  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    v21 = [v25 atomicInstanceUUID];
    v22 = [v25 assetSetIdentifier];
    v23 = v22;
    *buf = 138544386;
    v24 = @"N";
    v32 = v26;
    if (v13)
    {
      v24 = v13;
    }

    v33 = 2114;
    v34 = v21;
    v35 = 2114;
    v36 = v22;
    v37 = 2114;
    v38 = v24;
    v39 = 2114;
    v40 = v9;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@] assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x34u);
  }
}

- (void)_logSetDescriptorEntries:(id)a3 forSetDescriptor:(id)a4
{
  v30 = a3;
  v6 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  v9 = [v6 latestDownloadedAtomicInstance];
  v10 = [v6 latestDowloadedAtomicInstanceEntries];
  v11 = [[NSMutableString alloc] initWithString:@"{\n"];
  v29 = v6;
  if (v10)
  {
    v27 = @"latestDowloaded";
    v28 = v9;
  }

  else
  {
    v12 = [v6 discoveredAtomicInstance];

    v10 = [v6 discoveredAtomicEntries];
    v27 = @"discovered";
    v28 = v12;
  }

  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  v13 = v10;
  v14 = [v13 countByEnumeratingWithState:&v31 objects:v47 count:16];
  if (v14)
  {
    v15 = v14;
    v16 = 0;
    v17 = *v32;
    do
    {
      for (i = 0; i != v15; i = i + 1)
      {
        if (*v32 != v17)
        {
          objc_enumerationMutation(v13);
        }

        v19 = *(*(&v31 + 1) + 8 * i);
        if (v19)
        {
          if (!v16)
          {
            v20 = [*(*(&v31 + 1) + 8 * i) fullAssetSelector];
            v16 = [v20 assetType];
          }

          v21 = [v19 fullAssetSelector];
          v22 = [(MADAutoAssetControlManager *)self _shortNameForSelector:v21];
          [v11 appendFormat:@"  %@\n", v22];
        }
      }

      v15 = [v13 countByEnumeratingWithState:&v31 objects:v47 count:16];
    }

    while (v15);
  }

  else
  {
    v16 = 0;
  }

  [v11 appendString:@"}"];
  v23 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
  {
    v24 = [v29 assetSetIdentifier];
    v25 = v24;
    *buf = 138544642;
    v26 = @"N";
    v36 = v30;
    if (v16)
    {
      v26 = v16;
    }

    v37 = 2114;
    v38 = v28;
    v39 = 2114;
    v40 = v27;
    v41 = 2114;
    v42 = v24;
    v43 = 2114;
    v44 = v26;
    v45 = 2114;
    v46 = v11;
    _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@](%{public}@) assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x3Eu);
  }
}

- (id)_shortNameForSelector:(id)a3
{
  v3 = a3;
  if (!__isPlatformVersionAtLeast(2, 18, 0, 0) || (objc_opt_respondsToSelector() & 1) == 0 || ([v3 shortName], (v4 = objc_claimAutoreleasedReturnValue()) == 0))
  {
    v4 = [v3 persistedEntryID];
  }

  return v4;
}

- (void)_logLookupGrantObtained:(id)a3 ofLookupGrant:(id)a4 message:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    v14 = [v9 summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = v8;
    v19 = 2114;
    v20 = v10;
    v21 = 2114;
    v22 = v14;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][OBTAINED]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(OBTAN) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (void)_logLookupGrantAwaiting:(id)a3 ofLookupGrant:(id)a4 message:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    v14 = [v9 summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = v8;
    v19 = 2114;
    v20 = v10;
    v21 = 2114;
    v22 = v14;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][AWAITING]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(AWAIT) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (void)_logLookupGrantReleased:(id)a3 ofLookupGrant:(id)a4 message:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    v14 = [v9 summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = v8;
    v19 = 2114;
    v20 = v10;
    v21 = 2114;
    v22 = v14;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][RELEASED]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(RELES) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (id)newAssetStatusForSelector:(id)a3 withNotifications:(id)a4 withAvailableForUseAttributes:(id)a5 withNewerVersionAttributes:(id)a6 withNeverBeenLocked:(BOOL)a7 withDownloadUserInitiated:(BOOL)a8 withDownloadProgress:(id)a9 withDownloadedNetworkBytes:(int64_t)a10 withDownloadedFilesystemBytes:(int64_t)a11 withDownloadedAsPatch:(BOOL)a12 withPatchedFromBaseSelector:(id)a13 withPatchedFromBaseFilesystemBytes:(int64_t)a14 withPatchingAttempted:(BOOL)a15 withStagedPriorToAvailable:(BOOL)a16 withStagedFromOSVersion:(id)a17 withStagedFromBuildVersion:(id)a18 extendingWithCurrentLockUsage:(BOOL)a19 withAvailableForUseError:(id)a20 withPatchingAttemptError:(id)a21 withNewerVersionError:(id)a22
{
  v40 = a7;
  v41 = a8;
  v46 = a3;
  v25 = a4;
  v45 = a5;
  v44 = a6;
  v43 = a9;
  v39 = a13;
  v38 = a17;
  v26 = a18;
  v27 = a20;
  v36 = a21;
  v28 = a22;
  v29 = v25;
  v37 = v29;
  if (!v29)
  {
    v29 = objc_alloc_init(MAAutoAssetNotifications);
  }

  v35 = v29;
  if (a19)
  {
    v30 = [MADAutoAssetLocker newCurrentLockUsageForSelector:v46];
  }

  else
  {
    v30 = 0;
  }

  if (__isPlatformVersionAtLeast(2, 16, 4, 0))
  {
    v31 = v30;
  }

  else
  {
    v31 = 0;
  }

  LOWORD(v34) = __PAIR16__(a16, a15);
  LOBYTE(v33) = a12;
  v42 = [[MAAutoAssetStatus alloc] initWithAssetSelector:v46 withNotifications:v35 withAvailableForUseAttributes:v45 withNewerVersionAttributes:v44 withNeverBeenLocked:v40 withDownloadUserInitiated:v41 withDownloadProgress:v43 withDownloadedNetworkBytes:a10 withDownloadedFilesystemBytes:a11 withDownloadedAsPatch:v33 withPatchedFromBaseSelector:v39 withPatchedFromBaseFilesystemBytes:a14 withPatchingAttempted:v34 withStagedPriorToAvailable:v38 withStagedFromOSVersion:v26 withStagedFromBuildVersion:v31 withCurrentLockUsage:v27 withAvailableForUseError:v36 withPatchingAttemptError:v28 withNewerVersionError:?];

  return v42;
}

- (id)_newAtomicInstancesDownloadedForSetIdentifier:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = objc_alloc_init(NSMutableArray);
  v8 = [v4 clientDomainName];
  v23 = v4;
  v9 = [v4 assetSetIdentifier];
  v10 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:v8 assetSetIdentifier:v9];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_newAtomicInstancesDownloadedForSetIdentifier" ofContainer:@"setDescriptorKeysForAssetSet"];
  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v11 = v10;
  v12 = [v11 countByEnumeratingWithState:&v24 objects:v28 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v25;
    do
    {
      v15 = 0;
      do
      {
        if (*v25 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v24 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        v18 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"_newAtomicInstancesDownloadedForSetIdentifier" forKey:v16];
        v19 = [v18 latestDownloadedAtomicInstance];

        if (v19)
        {
          v20 = [v18 latestDownloadedAtomicInstance];
          [v7 addObject:v20];
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v13 != v15);
      v13 = [v11 countByEnumeratingWithState:&v24 objects:v28 count:16];
    }

    while (v13);
  }

  if ([v7 count])
  {
    v21 = v7;
  }

  else
  {
    v21 = 0;
  }

  return v21;
}

- (BOOL)_isClientRequestForSetJob:(id)a3
{
  v3 = [(MADAutoAssetControlManager *)self clientRequestMessageName:a3];
  v4 = ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0 || [SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];

  return v4;
}

- (id)firstAssetTypeForSetEntries:(id)a3
{
  v3 = a3;
  if ([v3 count])
  {
    v4 = [v3 objectAtIndex:0];
    v5 = [v4 assetSelector];
    v6 = [v5 assetType];
  }

  else
  {
    v6 = 0;
  }

  return v6;
}

- (id)currentSetStatusFromJobInformation:(id)a3
{
  v3 = a3;
  v4 = [v3 foundContent];
  v5 = [v4 currentSetStatus];

  if (!v5)
  {
    v5 = [v3 currentSetStatus];
  }

  return v5;
}

- (id)newAssetSetStatus:(id)a3 forReason:(id)a4 forClientDomain:(id)a5 forAssetSetIdentifier:(id)a6 withAtomicInstancesDownloaded:(id)a7 withNewerAtomicInstanceDiscovered:(id)a8 withNewerDiscoveredAtomicEntries:(id)a9 withLatestDownloadedAtomicInstance:(id)a10 withLatestDownloadedAtomicInstanceFromPreSUStaging:(BOOL)a11 withLatestDowloadedAtomicInstanceEntries:(id)a12 withCurrentNotifications:(id)a13 withCurrentNeedPolicy:(id)a14 withSchedulerPolicy:(id)a15 withStagerPolicy:(id)a16 withDownloadUserInitiated:(BOOL)a17 withDownloadProgress:(id)a18 withDownloadedNetworkBytes:(int64_t)a19 withDownloadedFilesystemBytes:(int64_t)a20 extendingWithCurrentLockUsage:(BOOL)a21 withSelectorsForStaging:(id)a22 withAvailableForUseError:(id)a23 withNewerVersionError:(id)a24
{
  v94 = a3;
  v28 = a5;
  v29 = a6;
  v102 = a7;
  v101 = a8;
  v100 = a9;
  v103 = a10;
  v30 = a12;
  v31 = v28;
  v32 = a13;
  v33 = v29;
  v99 = a14;
  v34 = self;
  v98 = a15;
  v97 = a16;
  v96 = a18;
  v95 = a22;
  v35 = a23;
  v36 = a24;
  v37 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v38 = [v37 extendedStateQueue];
  dispatch_assert_queue_V2(v38);

  v104 = v31;
  v39 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v31 forAssetSetIdentifier:v33];
  v93 = v32;
  if (v39)
  {
    v89 = v30;
    v40 = v32;
    if (!v40)
    {
      v40 = objc_alloc_init(MANAutoAssetSetNotifications);
    }

    v88 = v40;
    v41 = [v39 latestAtomicInstanceToVend];

    if (v41)
    {
      v42 = [v39 latestAtomicInstanceToVend];
      v43 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v94 forAtomicInstanceUUID:v42 requireExists:1];

      if (v43)
      {
        v44 = [v43 latestDownloadedAtomicInstance];
        LOBYTE(v41) = [SUCore stringIsEqual:v103 to:v44];

        v34 = self;
      }

      else
      {
        LOBYTE(v41) = 0;
      }
    }

    v53 = [(MADAutoAssetControlManager *)v34 _errorUnlessSameVersionFound:v35 changedReportedError:0];

    v54 = [(MADAutoAssetControlManager *)v34 _errorUnlessSameVersionFound:v36 changedReportedError:0];

    v81 = [MANAutoAssetSetStatus alloc];
    v80 = [(MADAutoAssetControlManager *)v34 setConfigurationAssetEntries:v104 forAssetSetIdentifier:v33];
    [v39 mostRecentlyReceivedCachedAssetSetID];
    v79 = v55 = v34;
    v83 = [v39 mostRecentlyReceivedDownloadedFromLive];
    v82 = [v39 mostRecentlyReceivedLastTimeChecked];
    v91 = [v39 mostRecentlyReceivedPostedDate];
    v56 = v103;
    if ((v41 & 1) == 0)
    {
      v56 = 0;
    }

    v78 = v56;
    v57 = v89;
    if ((v41 & 1) == 0)
    {
      v57 = 0;
    }

    v77 = v57;
    v87 = [v39 latestToVendCachedAssetSetID];
    v58 = [v39 latestToVendDownloadedFromLive];
    v86 = [v39 latestToVendLastTimeChecked];
    v59 = [v39 latestToVendPostedDate];
    v60 = [v39 haveReceivedLookupResponse];
    v61 = [v39 vendingAtomicInstanceForConfiguredEntries];
    v62 = v61;
    v84 = v54;
    v85 = v53;
    if (a21)
    {
      [(MADAutoAssetControlManager *)v55 setLockUsageMapForClientDomain:v104 forSetIdentifier:v33];
      v64 = v63 = v58;
      v73 = v53;
      v75 = v54;
      BYTE2(v72) = a17;
      BYTE1(v72) = v62;
      LOBYTE(v72) = v60;
      LOBYTE(v71) = a11;
      v65 = v82;
      v66 = v33;
      v67 = v33;
      v46 = v80;
      v49 = v79;
      v68 = v83;
      v92 = [MANAutoAssetSetStatus initStatusForClientDomain:v81 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v104 withAtomicInstancesDownloaded:v67 withCatalogCachedAssetSetID:v82 withCatalogDownloadedFromLive:v91 withCatalogLastTimeChecked:v101 withCatalogPostedDate:v100 withNewerAtomicInstanceDiscovered:v78 withNewerDiscoveredAtomicEntries:v71 withLatestDownloadedAtomicInstance:v77 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:v63 withDownloadedCatalogCachedAssetSetID:v86 withDownloadedCatalogDownloadedFromLive:v59 withDownloadedCatalogLastTimeChecked:v88 withDownloadedCatalogPostedDate:v99 withCurrentNotifications:v98 withCurrentNeedPolicy:v97 withSchedulerPolicy:v72 withStagerPolicy:v96 havingReceivedLookupResponse:a19 vendingAtomicInstanceForConfiguredEntries:a20 withDownloadUserInitiated:v64 withDownloadProgress:v95 withDownloadedNetworkBytes:v73 withDownloadedFilesystemBytes:v75 withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];

      v58 = v63;
    }

    else
    {
      v74 = v53;
      v76 = v54;
      BYTE2(v72) = a17;
      BYTE1(v72) = v61;
      LOBYTE(v72) = v60;
      LOBYTE(v71) = a11;
      v65 = v82;
      v66 = v33;
      v69 = v33;
      v46 = v80;
      v49 = v79;
      v68 = v83;
      v92 = [MANAutoAssetSetStatus initStatusForClientDomain:v81 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v104 withAtomicInstancesDownloaded:v69 withCatalogCachedAssetSetID:v82 withCatalogDownloadedFromLive:v91 withCatalogLastTimeChecked:v101 withCatalogPostedDate:v100 withNewerAtomicInstanceDiscovered:v78 withNewerDiscoveredAtomicEntries:v71 withLatestDownloadedAtomicInstance:v77 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:v58 withDownloadedCatalogCachedAssetSetID:v86 withDownloadedCatalogDownloadedFromLive:v59 withDownloadedCatalogLastTimeChecked:v88 withDownloadedCatalogPostedDate:v99 withCurrentNotifications:v98 withCurrentNeedPolicy:v97 withSchedulerPolicy:v72 withStagerPolicy:v96 havingReceivedLookupResponse:a19 vendingAtomicInstanceForConfiguredEntries:a20 withDownloadUserInitiated:0 withDownloadProgress:v95 withDownloadedNetworkBytes:v74 withDownloadedFilesystemBytes:v76 withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];
    }

    v47 = v94;
    v48 = v66;
    v52 = v100;
    v45 = v88;
    v30 = v89;
    v50 = v84;
    v51 = v85;
  }

  else
  {
    v45 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v46 = [v45 diag];
    v47 = v94;
    v48 = v33;
    v49 = [[NSString alloc] initWithFormat:@"{%@:newAssetSetStatus} no set-configuration | clientDomainName:%@ | assetSetIdentifier:%@", v94, v104, v33];
    [v46 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v49 withResult:6108 withError:0];
    v92 = 0;
    v50 = v36;
    v51 = v35;
    v52 = v100;
  }

  return v92;
}

- (id)autoAssetDescriptorsForSet:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v7 = objc_alloc_init(NSMutableArray);
  v16 = 0u;
  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v8 = [v4 latestDowloadedAtomicInstanceEntries];
  v9 = [v8 countByEnumeratingWithState:&v16 objects:v20 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v17;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v17 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = [*(*(&v16 + 1) + 8 * i) fullAssetSelector];
        v14 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v13];

        if (v14)
        {
          [v7 addObject:v14];
        }
      }

      v10 = [v8 countByEnumeratingWithState:&v16 objects:v20 count:16];
    }

    while (v10);
  }

  return v7;
}

- (id)alreadyHaveSetDescriptorMatching:(id)a3
{
  v62 = a3;
  v4 = [v62 latestDowloadedAtomicInstanceEntries];
  v5 = [v4 count];

  if (v5 < 1)
  {
    v20 = 0;
    goto LABEL_58;
  }

  v6 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v7 = [v6 persistedEntryIDs:@"alreadyHaveSetDescriptorMatching"];

  if (![v7 count])
  {
    v20 = 0;
    goto LABEL_57;
  }

  v94 = 0u;
  v95 = 0u;
  v92 = 0u;
  v93 = 0u;
  v8 = v7;
  v68 = [v8 countByEnumeratingWithState:&v92 objects:v102 count:16];
  if (!v68)
  {
LABEL_52:
    v20 = 0;
    goto LABEL_56;
  }

  v67 = *v93;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v60 = v8;
  v61 = v7;
  v73 = self;
  v59 = v5;
LABEL_5:
  v10 = 0;
  while (1)
  {
    if (*v93 != v67)
    {
      objc_enumerationMutation(v8);
    }

    v71 = v10;
    v11 = *(*(&v92 + 1) + 8 * v10);
    v12 = objc_autoreleasePoolPush();
    v13 = v12;
    if (!v11)
    {
      v51 = _MADLog(@"AutoControl");
      v72 = v51;
      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
      {
        v52 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v99 = v52;
        _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} no entryID", buf, 0xCu);
      }

      v53 = v71;
      goto LABEL_50;
    }

    context = v12;
    v14 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    v15 = [v14 persistedEntry:v11 fromLocation:@"alreadyHaveSetDescriptorMatching"];

    v72 = v15;
    if (!v15)
    {
      v54 = _MADLog(@"AutoControl");
      v70 = v54;
      if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
      {
        v55 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v99 = v55;
        v100 = 2114;
        v101 = v11;
        _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
      }

      goto LABEL_43;
    }

    v16 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    v17 = [v16 decodeFromLocation:@"alreadyHaveSetDescriptorMatching" ofEntryName:v11 fromPersistedEntry:v15 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    v70 = v17;
    if (!v17)
    {
      v56 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
      {
        v57 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v99 = v57;
        v100 = 2114;
        v101 = v11;
        _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
      }

      v13 = context;
LABEL_48:

      v53 = v71;
      goto LABEL_49;
    }

    v18 = [v17 latestDowloadedAtomicInstanceEntries];
    v19 = [v18 count];

    if (v19 == v5)
    {
      break;
    }

LABEL_43:
    v53 = v71;
    v13 = context;
LABEL_49:

LABEL_50:
    objc_autoreleasePoolPop(v13);
    v10 = v53 + 1;
    if (v10 == v68)
    {
      v68 = [v8 countByEnumeratingWithState:&v92 objects:v102 count:16];
      if (!v68)
      {
        goto LABEL_52;
      }

      goto LABEL_5;
    }
  }

  v90 = 0u;
  v91 = 0u;
  v88 = 0u;
  v89 = 0u;
  obj = [v62 latestDowloadedAtomicInstanceEntries];
  v20 = v17;
  v64 = [obj countByEnumeratingWithState:&v88 objects:v97 count:16];
  if (!v64)
  {
    goto LABEL_55;
  }

  v65 = *v89;
  while (2)
  {
    v21 = 0;
    while (2)
    {
      if (*v89 != v65)
      {
        objc_enumerationMutation(obj);
      }

      v66 = v21;
      v22 = *(*(&v88 + 1) + 8 * v21);
      v84 = 0u;
      v85 = 0u;
      v86 = 0u;
      v87 = 0u;
      v80 = [v20 latestDowloadedAtomicInstanceEntries];
      v23 = [v80 countByEnumeratingWithState:&v84 objects:v96 count:16];
      if (!v23)
      {
LABEL_47:

        v8 = v60;
        v7 = v61;
        self = v73;
        v5 = v59;
        v13 = context;
        v56 = obj;
        goto LABEL_48;
      }

      v24 = v23;
      v25 = *v85;
      v78 = *v85;
      while (2)
      {
        v26 = 0;
        v79 = v24;
LABEL_20:
        if (*v85 != v25)
        {
          objc_enumerationMutation(v80);
        }

        v27 = *(*(&v84 + 1) + 8 * v26);
        v28 = p_weak_ivar_lyt[223];
        v83 = [v27 fullAssetSelector];
        v29 = [v83 assetType];
        v30 = [v22 fullAssetSelector];
        v31 = [v30 assetType];
        if (![v28 stringIsEqual:v29 to:v31])
        {
LABEL_31:

LABEL_32:
          if (v24 == ++v26)
          {
            v24 = [v80 countByEnumeratingWithState:&v84 objects:v96 count:16];
            if (v24)
            {
              continue;
            }

            goto LABEL_47;
          }

          goto LABEL_20;
        }

        break;
      }

      v81 = v29;
      v82 = v30;
      v32 = p_weak_ivar_lyt[223];
      v33 = [v27 fullAssetSelector];
      v34 = [v33 assetSpecifier];
      [v22 fullAssetSelector];
      v36 = v35 = v27;
      v37 = [v36 assetSpecifier];
      if (![v32 stringIsEqual:v34 to:v37])
      {

        v25 = v78;
        v24 = v79;
        v29 = v81;
LABEL_30:

        v30 = v82;
        goto LABEL_31;
      }

      v77 = p_weak_ivar_lyt[223];
      v74 = v35;
      v75 = [v35 fullAssetSelector];
      [v75 assetVersion];
      v76 = v33;
      v39 = v38 = v22;
      v40 = [v38 fullAssetSelector];
      [v40 assetVersion];
      v42 = v41 = p_weak_ivar_lyt;
      LODWORD(v77) = [v77 stringIsEqual:v39 to:v42];

      p_weak_ivar_lyt = v41;
      v22 = v38;

      v25 = v78;
      v24 = v79;
      if (!v77)
      {
        goto LABEL_32;
      }

      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
      {
        v44 = [v74 localContentURL];
        v45 = [v38 localContentURL];
        *buf = 138412546;
        v99 = v44;
        v100 = 2112;
        v101 = v45;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_DEFAULT, "{alreadyHaveSetDescriptorMatching} nextEntry localContent URL: %@, checkEntry localContent URL: %@", buf, 0x16u);
      }

      v46 = [v74 localContentURL];
      v47 = [v38 localContentURL];
      v48 = [v46 isEqual:v47];

      if ((v48 & 1) == 0)
      {
        v83 = [(MADAutoAssetControlManager *)v73 autoControlManagerFSM];
        v49 = [v83 diag];
        v50 = [NSString alloc];
        v82 = [v22 localContentURL];
        v31 = [v82 absoluteURL];
        v29 = v49;
        v33 = [v74 localContentURL];
        v34 = [v33 absoluteURL];
        v36 = [v50 initWithFormat:@"{alreadyHaveSetDescriptorMatching} Set atomic entries with identical asset type, specifier and version has different paths on the filesystem. foundEntry: %@, persistedEntry:%@", v31, v34];
        [v29 trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6108 withError:0];
        goto LABEL_30;
      }

      v21 = v66 + 1;
      v20 = v70;
      if ((v66 + 1) != v64)
      {
        continue;
      }

      break;
    }

    v64 = [obj countByEnumeratingWithState:&v88 objects:v97 count:16];
    if (v64)
    {
      continue;
    }

    break;
  }

LABEL_55:

  objc_autoreleasePoolPop(context);
  v8 = v60;
  v7 = v61;
LABEL_56:

LABEL_57:
LABEL_58:

  return v20;
}

- (BOOL)newAtomicInstanceAndSetDescriptor:(id)a3 fromSetLookupResult:(id)a4 vendingLatestForConfiguration:(id)a5 inStartup:(BOOL)a6 allowEmpty:(BOOL)a7 notifyClients:(BOOL)a8 forCreationReason:(id)a9 recordingHistoryOperation:(int64_t)a10
{
  v10 = a8;
  v94 = a7;
  v11 = a6;
  v15 = a3;
  v16 = a4;
  v17 = a5;
  v18 = a9;
  v100 = self;
  v19 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v20 = [v19 extendedStateQueue];
  dispatch_assert_queue_V2(v20);

  v21 = [[NSString alloc] initWithFormat:@"%@:newAtomicInstanceAndSetDescriptorFromStaged", v15];
  v22 = 0;
  if (v16 && v17)
  {
    v23 = [v16 discoveredAtomicEntries];
    v24 = [v23 count];

    if (v24 || v94)
    {
      v90 = v11;
      v91 = v10;
      v96 = v21;
      v97 = v17;
      v92 = v18;
      v95 = [v17 firstEntryAssetType];
      v106 = 0u;
      v107 = 0u;
      v108 = 0u;
      v109 = 0u;
      v93 = v16;
      v25 = [v16 discoveredAtomicEntries];
      v26 = [v25 countByEnumeratingWithState:&v106 objects:v119 count:16];
      if (v26)
      {
        v27 = v26;
        v28 = *v107;
        while (2)
        {
          for (i = 0; i != v27; i = i + 1)
          {
            if (*v107 != v28)
            {
              objc_enumerationMutation(v25);
            }

            v30 = *(*(&v106 + 1) + 8 * i);
            v31 = objc_autoreleasePoolPush();
            if (!v30 || ([v97 autoAssetEntries], v32 = objc_claimAutoreleasedReturnValue(), v33 = -[MADAutoAssetControlManager isAtomicEntry:desiredForAutoAssetSetEntries:](v100, "isAtomicEntry:desiredForAutoAssetSetEntries:", v30, v32), v32, v33) && (objc_msgSend(v30, "fullAssetSelector"), v34 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v34, "assetType"), v35 = objc_claimAutoreleasedReturnValue(), v36 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v35, v95), v35, v34, (v36 & 1) == 0))
            {
              objc_autoreleasePoolPop(v31);
              v22 = 0;
              v18 = v92;
              v21 = v96;
              v17 = v97;
              goto LABEL_44;
            }

            objc_autoreleasePoolPop(v31);
          }

          v27 = [v25 countByEnumeratingWithState:&v106 objects:v119 count:16];
          if (v27)
          {
            continue;
          }

          break;
        }
      }

      v88 = v15;

      v37 = +[NSUUID UUID];
      v89 = [v37 UUIDString];

      v99 = objc_alloc_init(NSMutableArray);
      v102 = 0u;
      v103 = 0u;
      v104 = 0u;
      v105 = 0u;
      obj = [v16 discoveredAtomicEntries];
      v38 = [obj countByEnumeratingWithState:&v102 objects:v118 count:16];
      v17 = v97;
      v39 = v100;
      if (v38)
      {
        v40 = v38;
        v41 = *v103;
        v98 = *v103;
        do
        {
          for (j = 0; j != v40; j = j + 1)
          {
            if (*v103 != v41)
            {
              objc_enumerationMutation(obj);
            }

            v43 = *(*(&v102 + 1) + 8 * j);
            v44 = objc_autoreleasePoolPush();
            v45 = [v17 autoAssetEntries];
            v46 = [(MADAutoAssetControlManager *)v39 isAtomicEntry:v43 desiredForAutoAssetSetEntries:v45];

            if (v46)
            {
              v47 = [v43 fullAssetSelector];
              v48 = [(MADAutoAssetControlManager *)v39 locateDownloadedByFullSelector:v47];

              if (v48)
              {
                v49 = [v48 assetType];
                v50 = [v48 assetId];
                v51 = getAutoLocalUrlFromTypeAndIdWithPurpose(v49, v50, 2, @"auto");

                if (v51)
                {
                  v52 = [MANAutoAssetSetAtomicEntry alloc];
                  v53 = [v43 fullAssetSelector];
                  v54 = [v48 assetId];
                  v55 = [v48 metadata];
                  v56 = [(MANAutoAssetSetAtomicEntry *)v52 initWithFullAssetSelector:v53 withAssetID:v54 withLocalContentURL:v51 withAssetAttributes:v55 inhibitedFromEmergencyRemoval:0];

                  if (v56)
                  {
                    [v99 addObject:v56];
                  }

                  else
                  {
                    v61 = [(MADAutoAssetControlManager *)v100 autoControlManagerFSM];
                    v62 = [v61 diag];
                    v63 = [NSString alloc];
                    v64 = [v48 summary];
                    v65 = [v63 initWithFormat:@"{%@:newAtomicInstanceAndSetDescriptorFromStaged} unable to allocate already-downloaded-atomic-entry | alreadyDownloadedDescriptor:%@", v96, v64];
                    [v62 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v65 withResult:6111 withError:0];
                  }

                  v17 = v97;
                }

                else
                {
                  v56 = [(MADAutoAssetControlManager *)v39 autoControlManagerFSM];
                  v57 = [(MANAutoAssetSetAtomicEntry *)v56 diag];
                  v58 = [NSString alloc];
                  v59 = [v48 summary];
                  v60 = [v58 initWithFormat:@"{%@} unable to determine localContentURL of already-downloaded-descriptor | alreadyDownloadedDescriptor:%@", v96, v59];
                  [v57 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v60 withResult:6111 withError:0];
                }

                v39 = v100;
                v41 = v98;
              }

              else
              {
                [v99 addObject:v43];
              }
            }

            objc_autoreleasePoolPop(v44);
          }

          v40 = [obj countByEnumeratingWithState:&v102 objects:v118 count:16];
        }

        while (v40);
      }

      v66 = [MADAutoSetDescriptor alloc];
      v67 = [v17 clientDomainName];
      [v17 assetSetIdentifier];
      v69 = v68 = v39;
      v70 = [(MADAutoSetDescriptor *)v66 initForClientDomainName:v67 forAssetSetIdentifier:v69 withDiscoveredAtomicInstance:v89 withDiscoveredAtomicEntries:v99];

      v16 = v93;
      v71 = [v93 catalogCachedAssetSetID];
      [v70 setCatalogCachedAssetSetID:v71];

      v72 = [v93 catalogDownloadedFromLive];
      [v70 setCatalogDownloadedFromLive:v72];

      v73 = [v93 catalogLastTimeChecked];
      [v70 setCatalogLastTimeChecked:v73];

      v74 = [v93 catalogPostedDate];
      [v70 setCatalogPostedDate:v74];

      v75 = [v93 catalogCachedAssetSetID];
      [v70 setDownloadedCatalogCachedAssetSetID:v75];

      v76 = [v93 catalogDownloadedFromLive];
      [v70 setDownloadedCatalogDownloadedFromLive:v76];

      v77 = [v93 catalogLastTimeChecked];
      [v70 setDownloadedCatalogLastTimeChecked:v77];

      v78 = [v93 catalogPostedDate];
      [v70 setDownloadedCatalogPostedDate:v78];

      v79 = [v93 requestedAutoAssetEntries];
      [v70 setRequestedAutoAssetEntries:v79];

      [v70 setLatestDownloadedAtomicInstance:v89];
      [v70 setLatestDowloadedAtomicInstanceEntries:v99];
      [v70 setIsOnFilesystem:1];
      [v70 setIsDiscoveredFullyDownloaded:1];
      [v70 setAtomicInstanceDownloadedNotified:!v91];
      [v70 setNeverBeenLocked:1];
      v21 = v96;
      if ([(MADAutoAssetControlManager *)v68 isEveryAssetEntryOnFilesystemForSetDescriptor:v96 forSetDescriptor:v70])
      {
        v18 = v92;
        v80 = [(MADAutoAssetControlManager *)v68 atomicInstanceNewSetAtomicInstance:v96 forCreationReason:v92 recordingHistoryOperation:a10 recoveringForSetDescriptor:v70 usingAsSetClient:@"AutoControlManagerActingAsClient"];
        v15 = v88;
        v81 = v90 && [(MADAutoAssetControlManager *)v68 isAtomicInstancePartOfPSUS:v80];
        LOBYTE(v87) = v81;
        BYTE2(v86) = 0;
        LOWORD(v86) = 0;
        v82 = v68;
        v25 = v89;
        [MADAutoAssetControlManager trackSetDescriptor:v82 fromLocation:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" forLatestDownloaded:v70 forSpecificAtomicInstance:v96 withCurrentSetStatus:1 changedWhileTerminated:v89 changedNeverBeenLocked:0 notifyingIfJustDownloaded:0 latestToVend:v86 historyOperation:a10 firstClientName:@"AutoControlManagerActingAsClient" fromPreSUStaging:v87];
        v83 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v83, OS_LOG_TYPE_DEFAULT))
        {
          v84 = [v70 summary];
          *buf = 138544130;
          v111 = v96;
          v112 = 2114;
          v113 = v92;
          v114 = 2114;
          v115 = v84;
          v116 = 2114;
          v117 = v99;
          _os_log_impl(&dword_0, v83, OS_LOG_TYPE_DEFAULT, "{%{public}@} [%{public}@] | fromLookupResultSetDescriptor:%{public}@ | reportedDiscoveredEntries:\n%{public}@", buf, 0x2Au);

          v21 = v96;
        }

        v17 = v97;
        v22 = [(MADAutoAssetControlManager *)v100 setConfigurationAdoptLatestToVend:v21 fromSetDescriptor:v70 toSetConfiguration:v97 fromPreSUStaging:v81 allowEmpty:v94];
      }

      else
      {
        v22 = 0;
        v15 = v88;
        v25 = v89;
        v18 = v92;
      }

LABEL_44:
    }

    else
    {
      v22 = 0;
    }
  }

  return v22;
}

- (BOOL)cancelActiveSetJob:(id)a3 activeSetJob:(id)a4
{
  v6 = a4;
  v7 = a3;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [[NSString alloc] initWithFormat:@"%@:cancelActiveSetJob", v7];
  v11 = [v6 clientDomainName];
  v12 = [v6 autoAssetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v11 byIdentifier:v12];

  v14 = [v6 clientDomainName];
  v15 = [v6 autoAssetSetIdentifier];
  v16 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v14 byIdentifier:v15];

  if (!v13)
  {
    v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v18 = [v17 diag];
    v22 = [NSString alloc];
    v23 = [v6 summary];
    v24 = v23;
    if (v16)
    {
      v25 = [v22 initWithFormat:@"{%@} canceling active set-job that is already in canceling table | currentSetJob:%@", v10, v23];
      v26 = v18;
      v27 = v25;
      v28 = 6110;
    }

    else
    {
      v25 = [v22 initWithFormat:@"{%@} canceling active set-job that is not in routing table | currentSetJob:%@", v10, v23];
      v26 = v18;
      v27 = v25;
      v28 = 6111;
    }

    [v26 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v27 withResult:v28 withError:0];

    goto LABEL_10;
  }

  if (v16)
  {
    v17 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v18 = [v17 diag];
    v19 = [NSString alloc];
    v20 = [v6 summary];
    v21 = [v19 initWithFormat:@"{%@} canceling active set-job that is also already in canceling table | currentSetJob:%@", v10, v20];
    [v18 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v21 withResult:6111 withError:0];

LABEL_11:
    v33 = 0;
    goto LABEL_12;
  }

  v29 = [v6 clientDomainName];
  v30 = [v6 autoAssetSetIdentifier];
  v17 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v29 forAssetSetIdentifier:v30];

  if (!v17)
  {
    v18 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v24 = [v18 diag];
    v35 = [NSString alloc];
    v36 = [v6 summary];
    v37 = [v35 initWithFormat:@"{%@} canceling active set-job but unable to form set-job-key | currentSetJob:%@", v10, v36];
    [v24 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v37 withResult:6101 withError:0];

LABEL_10:
    goto LABEL_11;
  }

  v31 = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
  [v31 removeObjectForKey:v17];

  v32 = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
  [v32 setSafeObject:v6 forKey:v17];

  v33 = 1;
  [v6 setBeingCanceled:1];
  [v6 cancelAutoAssetJob];
LABEL_12:

  return v33;
}

- (id)_errorUnlessSameVersionFound:(id)a3 changedReportedError:(BOOL *)a4
{
  v5 = a3;
  v6 = v5;
  if (!v5)
  {
    v9 = 0;
    v10 = 0;
    if (!a4)
    {
      goto LABEL_10;
    }

LABEL_9:
    *a4 = v10;
    goto LABEL_10;
  }

  v7 = [v5 domain];
  if (![SUCore stringIsEqual:v7 to:@"com.apple.MobileAssetError.AutoAsset"])
  {
    v10 = 0;
    v9 = v6;
LABEL_8:

    if (!a4)
    {
      goto LABEL_10;
    }

    goto LABEL_9;
  }

  v8 = [v6 code];

  if (v8 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
  {
    v9 = 0;
    v10 = 1;
    v7 = v6;
    goto LABEL_8;
  }

  v10 = 0;
  v9 = v6;
  if (a4)
  {
    goto LABEL_9;
  }

LABEL_10:

  return v9;
}

- (id)_constructSetInfoSameFoundFrom:(id)a3 forSetConfiguration:(id)a4 fromSetStatus:(id)a5
{
  v8 = a3;
  v9 = a4;
  v10 = a5;
  v11 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v12 = [v11 extendedStateQueue];
  dispatch_assert_queue_V2(v12);

  v13 = v8;
  v14 = v13;
  v15 = v13;
  if (v13)
  {
    v15 = v13;
    if (v9)
    {
      v16 = [v9 latestAtomicInstanceToVend];
      v17 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"_constructSetInfoSameFoundFrom" forAtomicInstanceUUID:v16 requireExists:1];

      v15 = v14;
      if (v17)
      {
        v49 = [MANAutoAssetSetStatus alloc];
        v76 = [v9 clientDomainName];
        v75 = [v9 assetSetIdentifier];
        v59 = [v9 autoAssetEntries];
        v74 = [v59 copy];
        v58 = [v10 atomicInstancesDownloaded];
        v73 = [v58 copy];
        v57 = [v10 catalogCachedAssetSetID];
        v72 = [v57 copy];
        v56 = [v10 catalogDownloadedFromLive];
        v71 = [v56 copy];
        v55 = [v10 catalogLastTimeChecked];
        v70 = [v55 copy];
        v54 = [v10 catalogPostedDate];
        v69 = [v54 copy];
        v53 = [v9 latestAtomicInstanceToVend];
        v68 = [v53 copy];
        v52 = [v17 latestDowloadedAtomicInstanceEntries];
        v67 = [v52 copy];
        v51 = [v9 latestAtomicInstanceToVend];
        v66 = [v51 copy];
        v42 = [v9 latestAtomicInstanceToVendFromPreSUStaging];
        v48 = [v17 latestDowloadedAtomicInstanceEntries];
        v65 = [v48 copy];
        v47 = [v9 latestToVendCachedAssetSetID];
        v64 = [v47 copy];
        v46 = [v9 latestToVendDownloadedFromLive];
        v63 = [v46 copy];
        v45 = [v9 latestToVendLastTimeChecked];
        v62 = [v45 copy];
        v44 = [v9 latestToVendPostedDate];
        v61 = [v44 copy];
        v43 = [v10 currentNotifications];
        v37 = [v43 copy];
        v41 = [v10 currentNeedPolicy];
        v35 = [v41 copy];
        v40 = [v10 schedulerPolicy];
        v34 = [v40 copy];
        v39 = [v10 stagerPolicy];
        v33 = [v39 copy];
        v38 = [v9 haveReceivedLookupResponse];
        v32 = [v9 vendingAtomicInstanceForConfiguredEntries];
        v31 = [v10 downloadUserInitiated];
        v36 = [v10 downloadProgress];
        v60 = v17;
        v30 = [v36 copy];
        v18 = [v10 downloadedNetworkBytes];
        v19 = [v10 downloadedFilesystemBytes];
        v20 = [v10 currentLockUsage];
        v21 = [v10 selectorsForStaging];
        v22 = [v9 availableForUseError];
        v23 = [v9 newerVersionError];
        BYTE2(v29) = v31;
        BYTE1(v29) = v32;
        LOBYTE(v29) = v38;
        LOBYTE(v28) = v42;
        v50 = [MANAutoAssetSetStatus initStatusForClientDomain:v49 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v76 withAtomicInstancesDownloaded:v75 withCatalogCachedAssetSetID:v74 withCatalogDownloadedFromLive:v73 withCatalogLastTimeChecked:v72 withCatalogPostedDate:v71 withNewerAtomicInstanceDiscovered:v70 withNewerDiscoveredAtomicEntries:v69 withLatestDownloadedAtomicInstance:v68 withLatestDownloadedAtomicInstanceFromPreSUStaging:v67 withLatestDowloadedAtomicInstanceEntries:v66 withDownloadedCatalogCachedAssetSetID:v28 withDownloadedCatalogDownloadedFromLive:v65 withDownloadedCatalogLastTimeChecked:v64 withDownloadedCatalogPostedDate:v63 withCurrentNotifications:v62 withCurrentNeedPolicy:v61 withSchedulerPolicy:v37 withStagerPolicy:v35 havingReceivedLookupResponse:v34 vendingAtomicInstanceForConfiguredEntries:v33 withDownloadUserInitiated:v29 withDownloadProgress:v30 withDownloadedNetworkBytes:v18 withDownloadedFilesystemBytes:v19 withCurrentLockUsage:v20 withSelectorsForStaging:v21 withAvailableForUseError:v22 withNewerVersionError:v23];

        v24 = [MANAutoAssetSetInfoFound alloc];
        v25 = [v9 assetSetIdentifier];
        v26 = v24;
        v17 = v60;
        v15 = [(MANAutoAssetSetInfoFound *)v26 initForAssetSetIdentifier:v25 reportingStatus:v50];
      }
    }
  }

  return v15;
}

- (BOOL)jobToBeIncluded:(id)a3 basedOnControl:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = v6;
  if (v6 && ([v6 limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v20 = 0u;
    v21 = 0u;
    v18 = 0u;
    v19 = 0u;
    v9 = [v7 limitedToAssetTypes];
    v10 = [v9 countByEnumeratingWithState:&v18 objects:v22 count:16];
    if (v10)
    {
      v17 = v7;
      v11 = *v19;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v19 != v11)
          {
            objc_enumerationMutation(v9);
          }

          v13 = *(*(&v18 + 1) + 8 * i);
          v14 = [v5 autoAssetSelector];
          v15 = [v14 assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:v15 to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [v9 countByEnumeratingWithState:&v18 objects:v22 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }

LABEL_14:
      v7 = v17;
    }
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

+ (BOOL)selectorToBeIncluded:(id)a3 basedOnControl:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = v6;
  if (v6 && ([v6 limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v18 = 0u;
    v19 = 0u;
    v16 = 0u;
    v17 = 0u;
    v9 = [v7 limitedToAssetTypes];
    v10 = [v9 countByEnumeratingWithState:&v16 objects:v20 count:16];
    if (v10)
    {
      v11 = *v17;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v17 != v11)
          {
            objc_enumerationMutation(v9);
          }

          v13 = *(*(&v16 + 1) + 8 * i);
          v14 = [v5 assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:v14 to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [v9 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

LABEL_14:
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

+ (BOOL)descriptorToBeIncluded:(id)a3 basedOnControl:(id)a4
{
  v5 = a3;
  v6 = a4;
  v7 = v6;
  if (v6 && ([v6 limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v18 = 0u;
    v19 = 0u;
    v16 = 0u;
    v17 = 0u;
    v9 = [v7 limitedToAssetTypes];
    v10 = [v9 countByEnumeratingWithState:&v16 objects:v20 count:16];
    if (v10)
    {
      v11 = *v17;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v17 != v11)
          {
            objc_enumerationMutation(v9);
          }

          v13 = *(*(&v16 + 1) + 8 * i);
          v14 = [v5 assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:v14 to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [v9 countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

LABEL_14:
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

- (id)_preInstalledSetAtomicEntriesFromInstanceEntries:(id)a3
{
  v4 = a3;
  v38 = objc_alloc_init(NSMutableArray);
  v43 = 0u;
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  v5 = v4;
  v6 = [v5 countByEnumeratingWithState:&v43 objects:v51 count:16];
  obj = v5;
  if (!v6)
  {
LABEL_25:

    goto LABEL_26;
  }

  v8 = v6;
  v9 = *v44;
  v42 = 1;
  *&v7 = 138543362;
  v37 = v7;
  v39 = *v44;
  do
  {
    v10 = 0;
    v40 = v8;
    do
    {
      if (*v44 != v9)
      {
        objc_enumerationMutation(obj);
      }

      v11 = *(*(&v43 + 1) + 8 * v10);
      v12 = objc_autoreleasePoolPush();
      v13 = [v11 assetSelector];
      v14 = [v13 assetType];
      v15 = [v11 assetSelector];
      v16 = [v15 assetSpecifier];
      v17 = [(MADAutoAssetControlManager *)self _preInstalledDescriptor:@"_preInstalledSetAtomicEntriesFromInstanceEntries" forAssetType:v14 withAssetSpecifier:v16];

      if (v17)
      {
        v18 = [v17 assetType];
        v19 = [v17 assetId];
        v20 = getAutoLocalUrlFromTypeAndIdWithPurpose(v18, v19, 2, @"auto");

        if (v20)
        {
          v21 = self;
          v22 = [MAAutoAssetSelector alloc];
          v23 = [v17 assetType];
          v24 = [v17 assetSpecifier];
          v25 = [v17 assetVersion];
          v26 = [v22 initForAssetType:v23 withAssetSpecifier:v24 matchingAssetVersion:v25];

          v27 = [MANAutoAssetSetAtomicEntry alloc];
          v28 = [v17 assetId];
          v29 = [v17 metadata];
          v30 = [(MANAutoAssetSetAtomicEntry *)v27 initWithFullAssetSelector:v26 withAssetID:v28 withLocalContentURL:v20 withAssetAttributes:v29 inhibitedFromEmergencyRemoval:0];

          if (v30)
          {
            [v38 addObject:v30];
          }

          else
          {
            v32 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
            {
              v33 = [v17 summary];
              *buf = v37;
              v48 = v33;
              _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledSetAtomicEntriesFromInstanceEntries} unable to allocate set-atomic-entry | nextDescriptor:%{public}@", buf, 0xCu);
            }

            v42 = 0;
          }

          self = v21;
          v8 = v40;

          v9 = v39;
        }

        else
        {
          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            v31 = [v17 summary];
            *buf = v37;
            v48 = v31;
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] [LOCAL-CONTENT-URL] {_preInstalledSetAtomicEntriesFromInstanceEntries} unable to get local content URL | nextDescriptor:%{public}@", buf, 0xCu);
          }

          v42 = 0;
        }
      }

      else
      {
        v42 = 0;
      }

      objc_autoreleasePoolPop(v12);
      v10 = v10 + 1;
    }

    while (v8 != v10);
    v8 = [obj countByEnumeratingWithState:&v43 objects:v51 count:16];
  }

  while (v8);

  if ((v42 & 1) == 0 && [v38 count])
  {
    v5 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543618;
      v48 = obj;
      v49 = 2114;
      v50 = v38;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledSetAtomicEntriesFromInstanceEntries} found some of desired instance-entries (valid when providing pre-installed)\ninstanceEntries:\n%{public}@\npreInstalledAtomicEntries:\n%{public}@", buf, 0x16u);
    }

    goto LABEL_25;
  }

LABEL_26:
  if ([v38 count])
  {
    v34 = v38;
  }

  else
  {
    v34 = 0;
  }

  v35 = v34;

  return v34;
}

- (void)_preInstalledMakeDescriptorAvailable:(id)a3 fromLocation:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  v10 = [v6 assetType];
  v11 = [v6 assetSpecifier];
  v12 = [v6 assetVersion];
  v13 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"IssueClientReplyJobResponse" forAssetType:v10 withAssetSpecifier:v11 matchingAssetVersion:v12];

  if (v13)
  {
    v14 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v15 = [v14 diag];
    v16 = [NSString alloc];
    v17 = [v6 summary];
    v18 = [v13 summary];
    v19 = [v16 initWithFormat:@"{%@:_preInstalledMakeDescriptorAvailable} already migrated | availableToMigrate:%@, alreadyAvailable:%@", v7, v17, v18];
    [v15 trackAnomaly:@"AUTO-CONTROL" forReason:v19 withResult:6109 withError:0];

    goto LABEL_3;
  }

  [v6 setIsOnFilesystem:1];
  if (![(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:v6])
  {
    [v6 setIsOnFilesystem:0];
    v14 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_4;
    }

    v15 = [v6 summary];
    *buf = 138543618;
    v38 = v7;
    v39 = 2114;
    v40 = v15;
    _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {%{public}@:_preInstalledMakeDescriptorAvailable} attempted to migrate asset but not on filesystem | descriptor:%{public}@", buf, 0x16u);
LABEL_3:

LABEL_4:
    goto LABEL_5;
  }

  v20 = [MAAutoAssetSelector alloc];
  v21 = [v6 assetType];
  v22 = [v6 assetSpecifier];
  v23 = [v6 assetVersion];
  v24 = [v20 initForAssetType:v21 withAssetSpecifier:v22 matchingAssetVersion:v23];

  v25 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
  {
    v26 = [v6 summary];
    *buf = 138543618;
    v38 = v7;
    v39 = 2114;
    v40 = v26;
    _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {%{public}@:_preInstalledMakeDescriptorAvailable} content on filesystem validated for migration | descriptor:%{public}@", buf, 0x16u);
  }

  LOBYTE(v33) = 0;
  [(MADAutoAssetControlManager *)self trackDescriptor:v6 persisting:1 fromLocation:@"_preInstalledMakeDescriptorAvailable" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v33];
  v27 = objc_opt_new();
  [v27 setContentAvailableForUse:1];
  v28 = [v6 metadata];
  LOBYTE(v36) = 0;
  LOWORD(v35) = 0;
  LOBYTE(v34) = 0;
  v29 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v24 withNotifications:v27 withAvailableForUseAttributes:v28 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v34 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v35 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v36 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

  v30 = [v24 assetVersion];
  [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v24 forActiveJobUUID:0 withLatestJobStatus:v29 matchingAssetVersion:v30 fromLocation:@"_preInstalledMakeDescriptorAvailable"];

  v31 = [v6 assetType];
  v32 = [v6 assetSpecifier];
  [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_DOWNLOADED" forAssetType:v31 forAssetSpecifier:v32 fromModule:@"PRE-INSTALLED" fromLocation:@"_preInstalledMakeDescriptorAvailable"];

LABEL_5:
}

- (id)_preInstalledRelocateAutoAssets
{
  v3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v4 = [v3 extendedStateQueue];
  dispatch_assert_queue_V2(v4);

  v5 = getRepositoryPath(@"/private/var/MobileAsset/PreinstalledAssetsV2/InstallWithOs");
  v6 = +[NSFileManager defaultManager];
  v114 = 0;
  v7 = [v6 contentsOfDirectoryAtPath:v5 error:&v114];
  v8 = v114;

  if (v7)
  {
    v9 = v8 == 0;
  }

  else
  {
    v9 = 0;
  }

  if (v9)
  {
    v98 = objc_opt_new();
    v89 = self;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_preInstalledRelocateAutoAssets" ofContainer:@"dirs(MA_PATH_TO_INSTALL_WITH_OS)"];
    v112 = 0u;
    v113 = 0u;
    v110 = 0u;
    v111 = 0u;
    v13 = v7;
    v14 = [v13 countByEnumeratingWithState:&v110 objects:v127 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = *v111;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      v92 = v5;
      v85 = v13;
      v86 = v7;
      v84 = *v111;
      do
      {
        v18 = 0;
        v87 = v15;
        do
        {
          if (*v111 != v16)
          {
            objc_enumerationMutation(v13);
          }

          v19 = *(*(&v110 + 1) + 8 * v18);
          if (isWellFormedNormalizedAssetType(v19))
          {
            v103 = assetTypeFromNormalized(v19);
            v20 = getPreInstalledAssets(v5, v103, 0, 0);
            v21 = v20;
            if (v20 && [v20 count])
            {
              v108 = 0u;
              v109 = 0u;
              v106 = 0u;
              v107 = 0u;
              v22 = [v21 allKeys];
              v102 = [v22 countByEnumeratingWithState:&v106 objects:v126 count:16];
              if (!v102)
              {
                goto LABEL_68;
              }

              v88 = v18;
              v100 = *v107;
              v101 = v21;
              v23 = v103;
              obj = v22;
              while (1)
              {
                for (i = 0; i != v102; i = i + 1)
                {
                  if (*v107 != v100)
                  {
                    objc_enumerationMutation(obj);
                  }

                  v25 = *(*(&v106 + 1) + 8 * i);
                  v26 = objc_autoreleasePoolPush();
                  v27 = [v101 objectForKeyedSubscript:v25];
                  v28 = getPathToAssetWithPurpose(v5, v23, v25, 0);
                  v29 = [v28 lastPathComponent];
                  if ([p_weak_ivar_lyt[316] isAutoAssetMetadata:v27])
                  {
                    v30 = objc_alloc(p_weak_ivar_lyt[316]);
                    v105 = 0;
                    v31 = [v30 initForAssetType:v23 fromMetadata:v27 invalidReasons:&v105];
                    v32 = v105;
                    if (v31)
                    {
                      if (([v31 isMAAutoAsset]& 1) != 0)
                      {
                        if ([v28 isFileURL])
                        {
                          v33 = v28;
                        }

                        else
                        {
                          v40 = [v28 absoluteURL];
                          v41 = [v40 path];
                          v42 = [NSURL fileURLWithPath:v41 isDirectory:1];

                          v33 = v42;
                        }

                        v34 = [v28 path];
                        v43 = getDownloadManager();
                        v97 = v33;
                        v44 = [v43 decryptContentEncryptedAssetAtPathIfRequired:v33];

                        v96 = v26;
                        if (v44)
                        {
                          v45 = repositoryPath(v103);
                          v46 = getAutoLocalUrlFromTypeGivenDefaultRepoWithPurpose(v103, 1, v45, @"auto");

                          v47 = [v46 path];
                          v48 = ensureDirectory(v47);

                          v49 = [v46 URLByAppendingPathComponent:v29];

                          v94 = v49;
                          v50 = [v49 path];
                          v51 = [v28 path];

                          v52 = +[NSFileManager defaultManager];
                          v104 = 0;
                          v93 = v51;
                          v95 = v50;
                          [v52 moveItemAtPath:v51 toPath:v50 error:&v104];
                          v53 = v104;

                          if (v53)
                          {
                            v54 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
                            {
                              v90 = [v31 summary];
                              v55 = [v53 checkedDescription];
                              *buf = 138544130;
                              v118 = v90;
                              v119 = 2114;
                              v120 = v51;
                              v121 = 2114;
                              v122 = v95;
                              v123 = 2114;
                              v124 = v55;
                              v56 = v55;
                              _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Attempted to move auto-asset but failed | descriptor:%{public}@ | fromPath:%{public}@ | toPath:%{public}@ | error:%{public}@", buf, 0x2Au);
                            }

                            v57 = +[NSFileManager defaultManager];
                            [v57 removeItemAtPath:v95 error:0];

                            v58 = +[NSFileManager defaultManager];
                            v34 = v93;
                            [v58 removeItemAtPath:v93 error:0];

                            v59 = [v98 objectForKeyedSubscript:@"Failure"];
                            v60 = v59;
                            if (v59)
                            {
                              [v59 arrayByAddingObject:v31];
                            }

                            else
                            {
                              v116 = v31;
                              [NSArray arrayWithObjects:&v116 count:1];
                            }
                            v69 = ;
                            v68 = v92;
                            [v98 setObject:v69 forKeyedSubscript:@"Failure"];
                          }

                          else
                          {
                            [v31 setFoundAsPreInstalled:1];
                            [(MADAutoAssetControlManager *)v89 _preinstalledTrackBySelector:v31];
                            v66 = [v98 objectForKeyedSubscript:@"Success"];
                            v91 = v66;
                            if (v66)
                            {
                              [v66 arrayByAddingObject:v31];
                            }

                            else
                            {
                              v115 = v31;
                              [NSArray arrayWithObjects:&v115 count:1];
                            }
                            v70 = ;
                            [v98 setObject:v70 forKeyedSubscript:@"Success"];

                            v71 = getControlManager();
                            v69 = [v71 getSAFRegistrationBundleID:v94];

                            v72 = getControlManager();
                            [v72 updateSpaceAttributionForBundleID:v69 assetPath:v28 doRegistration:0];

                            v73 = getControlManager();
                            [v73 updateSpaceAttributionForBundleID:v69 assetPath:v94 doRegistration:1];

                            v74 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
                            {
                              v75 = [v31 summary];
                              *buf = 138543618;
                              v118 = v95;
                              v119 = 2114;
                              v120 = v75;
                              _os_log_impl(&dword_0, v74, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Added descriptor for pre-installed asset | path:%{public}@ | descriptor:%{public}@ ", buf, 0x16u);
                            }

                            v68 = v92;
                            v34 = v93;
                            v60 = v91;
                          }

                          v65 = v94;
                          v67 = v95;
                        }

                        else
                        {
                          v61 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
                          {
                            v62 = [v31 summary];
                            *buf = 138543874;
                            v118 = v28;
                            v119 = 2114;
                            v120 = v103;
                            v121 = 2114;
                            v122 = v62;
                            _os_log_impl(&dword_0, v61, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Failed to decrypt contentEncrypted asset at | path:%{public}@ | assetType:%{public}@ | descriptor:%{public}@", buf, 0x20u);
                          }

                          v63 = +[NSFileManager defaultManager];
                          [v63 removeItemAtPath:v34 error:0];

                          v64 = [v98 objectForKeyedSubscript:@"Failure"];
                          v65 = v64;
                          if (v64)
                          {
                            [v64 arrayByAddingObject:v31];
                          }

                          else
                          {
                            v125 = v31;
                            [NSArray arrayWithObjects:&v125 count:1];
                          }
                          v67 = ;
                          v68 = v92;
                          [v98 setObject:v67 forKeyedSubscript:@"Failure"];
                        }

                        v5 = v68;
                        v26 = v96;
                      }

                      else
                      {
                        v34 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
                        {
                          v39 = [v31 summary];
                          *buf = 138543874;
                          v118 = v5;
                          v119 = 2114;
                          v120 = v103;
                          v121 = 2114;
                          v122 = v39;
                          _os_log_impl(&dword_0, v34, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Descriptor created for auto-asset metadata does not describe an auto-asset | path:%{public}@ | assetType:%{public}@ | descriptor:%{public}@", buf, 0x20u);
                        }
                      }

                      goto LABEL_60;
                    }

                    v34 = _MADLog(@"AutoControl");
                    v35 = os_log_type_enabled(v34, OS_LOG_TYPE_ERROR);
                    if (v32)
                    {
                      if (v35)
                      {
                        *buf = 138543874;
                        v118 = v5;
                        v119 = 2114;
                        v120 = v103;
                        v121 = 2114;
                        v122 = v32;
                        v36 = v34;
                        v37 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Unable to create descriptor | path:%{public}@ | assetType:%{public}@ | reasons:%{public}@";
                        v38 = 32;
                        goto LABEL_47;
                      }
                    }

                    else if (v35)
                    {
                      *buf = 138543618;
                      v118 = v5;
                      v119 = 2114;
                      v120 = v103;
                      v36 = v34;
                      v37 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Unable to create descriptor | path:%{public}@ | assetType:%{public}@";
                      v38 = 22;
LABEL_47:
                      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, v37, buf, v38);
                    }

LABEL_60:

                    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                    goto LABEL_61;
                  }

                  v31 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
                  {
                    *buf = 138543874;
                    v118 = v5;
                    v119 = 2114;
                    v120 = v23;
                    v121 = 2114;
                    v122 = v25;
                    _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Not migrating since not an auto-asset | path:%{public}@ | assetType:%{public}@ | assetID:%{public}@", buf, 0x20u);
                  }

                  v32 = 0;
LABEL_61:

                  objc_autoreleasePoolPop(v26);
                  v23 = v103;
                }

                v22 = obj;
                v102 = [obj countByEnumeratingWithState:&v106 objects:v126 count:16];
                if (!v102)
                {
                  v13 = v85;
                  v7 = v86;
                  v15 = v87;
                  v18 = v88;
                  v16 = v84;
                  v21 = v101;
                  goto LABEL_68;
                }
              }
            }

            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543618;
              v118 = v5;
              v119 = 2114;
              v120 = v103;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No pre-installed assets for asset-type | path:%{public}@ | assetType:%{public}@", buf, 0x16u);
            }

LABEL_68:
          }

          else
          {
            v76 = _MADLog(@"AutoControl");
            v103 = v76;
            if (os_log_type_enabled(v76, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v118 = v19;
              _os_log_impl(&dword_0, v76, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Skipping malformed asset directory | assetDir:%{public}@ ", buf, 0xCu);
            }
          }

          v18 = v18 + 1;
        }

        while (v18 != v15);
        v15 = [v13 countByEnumeratingWithState:&v110 objects:v127 count:16];
      }

      while (v15);
    }

    v77 = [v98 count];
    v11 = _MADLog(@"AutoControl");
    v78 = os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT);
    if (v77 <= 0)
    {
      if (v78)
      {
        *buf = 138543362;
        v118 = v5;
        v80 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No pre-installed auto-assets were relocated | path:%{public}@";
        v81 = v11;
        v82 = 12;
LABEL_81:
        _os_log_impl(&dword_0, v81, OS_LOG_TYPE_DEFAULT, v80, buf, v82);
      }
    }

    else if (v78)
    {
      v79 = @"s";
      *buf = 134218498;
      v118 = v77;
      v119 = 2114;
      if (v77 == &dword_0 + 1)
      {
        v79 = &stru_4BD3F0;
      }

      v120 = v79;
      v121 = 2114;
      v122 = v5;
      v80 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} %ld pre-installed auto-asset%{public}@ successfully relocated | path:%{public}@";
      v81 = v11;
      v82 = 32;
      goto LABEL_81;
    }

    v8 = 0;
    goto LABEL_83;
  }

  v10 = _MADLog(@"AutoControl");
  v11 = v10;
  if (v8)
  {
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      v12 = [v8 checkedDescription];
      *buf = 138543618;
      v118 = v5;
      v119 = 2114;
      v120 = v12;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Failed to read directories at path to pre-installed assets | path:%{public}@ | error:%{public}@", buf, 0x16u);
    }
  }

  else if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v118 = v5;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No directories found at path to pre-installed assets | path:%{public}@", buf, 0xCu);
  }

  v98 = 0;
LABEL_83:

  return v98;
}

- (void)_preInstalledMigrateAssets
{
  v2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v4 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} Starting pre-installed asset migration...", buf, 2u);
  }

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v6 = +[NSFileManager defaultManager];
  v7 = [v6 fileExistsAtPath:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist"];

  if (v7)
  {
    v8 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} Already migrated assets, no need to run again", buf, 2u);
    }
  }

  else
  {
    v8 = [(MADAutoAssetControlManager *)self _preInstalledRelocateAutoAssets];
    v9 = [v8 objectForKeyedSubscript:@"Success"];
    v10 = [v8 objectForKeyedSubscript:@"Failure"];
    v47 = objc_opt_new();
    if (v9 && [v9 count])
    {
      [(MADAutoAssetControlManager *)self setMigratedFromPreinstalled:1];
      v54 = 0u;
      v55 = 0u;
      v52 = 0u;
      v53 = 0u;
      v11 = v9;
      v12 = [v11 countByEnumeratingWithState:&v52 objects:v58 count:16];
      if (v12)
      {
        v13 = v12;
        v42 = v8;
        obj = v11;
        v38 = v10;
        v40 = v9;
        v14 = *v53;
        do
        {
          for (i = 0; i != v13; i = i + 1)
          {
            if (*v53 != v14)
            {
              objc_enumerationMutation(obj);
            }

            v16 = *(*(&v52 + 1) + 8 * i);
            v17 = objc_autoreleasePoolPush();
            v18 = [v16 assetType];
            v19 = [v16 assetSpecifier];
            v20 = [v16 assetVersion];
            v21 = [NSString stringWithFormat:@"%@|%@|%@", v18, v19, v20];

            [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v16 fromLocation:@"_preInstalledMigrateAssets"];
            [v47 setSafeObject:@"Success" forKey:v21];

            objc_autoreleasePoolPop(v17);
          }

          v13 = [obj countByEnumeratingWithState:&v52 objects:v58 count:16];
        }

        while (v13);
        v9 = v40;
        v8 = v42;
        v10 = v38;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v11 = obj;
      }
    }

    else
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} no descriptors found to migrate", buf, 2u);
      }
    }

    if (v10 && [v10 count])
    {
      v50 = 0u;
      v51 = 0u;
      v48 = 0u;
      v49 = 0u;
      v22 = v10;
      v23 = [v22 countByEnumeratingWithState:&v48 objects:v57 count:16];
      if (v23)
      {
        v24 = v23;
        v43 = v8;
        obja = v22;
        v39 = v10;
        v41 = v9;
        v25 = *v49;
        do
        {
          for (j = 0; j != v24; j = j + 1)
          {
            if (*v49 != v25)
            {
              objc_enumerationMutation(obja);
            }

            v27 = *(*(&v48 + 1) + 8 * j);
            v28 = objc_autoreleasePoolPush();
            v29 = [v27 assetType];
            v30 = [v27 assetSpecifier];
            v31 = [v27 assetVersion];
            v32 = [NSString stringWithFormat:@"%@|%@|%@", v29, v30, v31];

            [v47 setSafeObject:@"Failure" forKey:v32];
            objc_autoreleasePoolPop(v28);
          }

          v24 = [obja countByEnumeratingWithState:&v48 objects:v57 count:16];
        }

        while (v24);
        v9 = v41;
        v8 = v43;
        v10 = v39;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v22 = obja;
      }
    }

    else
    {
      v22 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} no descriptors failed migration", buf, 2u);
      }
    }

    v33 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} ...Finishing pre-installed asset migration", buf, 2u);
    }

    [v47 writeToFile:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist" atomically:1];
    v34 = [p_weak_ivar_lyt[278] defaultManager];
    v35 = [v34 fileExistsAtPath:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist"];

    if ((v35 & 1) == 0)
    {
      v36 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v37 = [v36 diag];
      [v37 trackAnomaly:@"[AUTO-PRE-INSTALLED]" forReason:@"Failed to write cookie file" withResult:*__error() withError:0];
    }
  }
}

- (void)_preinstalledTrackBySelector:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  if (![v4 foundAsPreInstalled])
  {
    v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v9 = [v8 diag];
    v26 = [NSString alloc];
    v27 = [v4 summary];
    v28 = [v26 initWithFormat:@"{_preinstalledTrackBySelector} not a pre-installed asset-descriptor | downloadedDescriptor:%@", v27];
    [v9 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v28 withResult:6103 withError:0];

LABEL_18:
    goto LABEL_19;
  }

  v7 = [(MADAutoAssetControlManager *)self setConfigurationForDescriptorIfManagedAsSet:v4];
  v8 = v7;
  if (!v7 || ([v7 everProvidedLatestToVend] & 1) == 0)
  {
    v9 = [v4 typeAndSpecifierKey];
    v10 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
    v11 = [v10 safeObjectForKey:v9 ofClass:objc_opt_class()];

    if (v11)
    {
      v12 = [v4 assetVersion];
      v13 = [v11 assetVersion];
      v14 = [SUCore stringIsEqual:v12 to:v13];

      if ((v14 & 1) == 0)
      {
        v15 = [SUCoreRestoreVersion alloc];
        v16 = [v4 assetVersion];
        v17 = [v15 initWithRestoreVersion:v16];

        v18 = [SUCoreRestoreVersion alloc];
        v19 = [v11 assetVersion];
        v20 = [v18 initWithRestoreVersion:v19];

        if ([v17 isComparable:v20])
        {
          v21 = [v17 compare:v20];
          v22 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
          {
            v23 = [v4 summary];
            [v11 summary];
            v24 = v32 = v21;
            *buf = 138543618;
            v34 = v23;
            v35 = 2114;
            v36 = v24;
            _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {_preinstalledTrackBySelector} [PRE-INSTALLED] multiple for same specifier | left(downloadedDescriptor):%{public}@ | right(preinstalledDescriptor):%{public}@", buf, 0x16u);

            v21 = v32;
          }

          if (v21 != &dword_0 + 1)
          {
            goto LABEL_16;
          }

          v25 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
          [v25 setSafeObject:v4 forKey:v9];
        }

        else
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            v30 = [v4 summary];
            v31 = [v11 summary];
            *buf = 138543618;
            v34 = v30;
            v35 = 2114;
            v36 = v31;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {_preinstalledTrackBySelector} [PRE-INSTALLED] asset-versions not comparable | left(downloadedDescriptor):%{public}@ | right(preinstalledDescriptor):%{public}@", buf, 0x16u);
          }
        }

LABEL_16:
      }
    }

    else
    {
      v29 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
      [v29 setSafeObject:v4 forKey:v9];
    }

    goto LABEL_18;
  }

LABEL_19:
}

- (void)secureCheckUngraft:(id)a3 forDescriptorNoLongerLocked:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureCheckUngraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v7]&& [MADAutoAssetSecure isSecureAsset:v6 forDescriptor:v7])
  {
    if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v6 forDescriptor:v7])
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543362;
        v21 = v6;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n{%{public}@:secureCheckUngraft} [AUTO-SECURE] NOT ungrafting (currently locked)", buf, 0xCu);
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
      {
        v13 = [v7 summary];
        *buf = 138543618;
        v21 = v6;
        v22 = 2114;
        v23 = v13;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungrafting|unmounting (NOT currently locked) | downloadedDescriptor:%{public}@", buf, 0x16u);
      }

      [v7 setSecureOperationInProgress:1];
      v18 = 0;
      [MADAutoAssetSecure ungraft:v6 forDescriptor:v7 ungraftingError:&v18];
      v11 = v18;
      [v7 setSecureOperationInProgress:0];
      if (v11)
      {
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          v15 = [v11 checkedDescription];
          v16 = [v7 summary];
          *buf = 138543874;
          v21 = v6;
          v22 = 2114;
          v23 = v15;
          v24 = 2114;
          v25 = v16;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungraft|unmount ERROR | error:%{public}@ | downloadedDescriptor:%{public}@", buf, 0x20u);
        }
      }

      else
      {
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
        {
          v17 = [v7 summary];
          *buf = 138543618;
          v21 = v6;
          v22 = 2114;
          v23 = v17;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungraft|unmount SUCCESS | downloadedDescriptor:%{public}@", buf, 0x16u);
        }
      }
    }
  }

  os_activity_scope_leave(&state);
}

- (void)secureForceUngraft:(id)a3 forDescriptorBeingRemoved:(id)a4
{
  v6 = a3;
  v7 = a4;
  v8 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_assert_queue_V2(v9);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureForceUngraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v7]&& [MADAutoAssetSecure isSecureAsset:v6 forDescriptor:v7])
  {
    if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v6 forDescriptor:v7])
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        v12 = [v7 summary];
        *buf = 138543618;
        v22 = v6;
        v23 = 2114;
        v24 = v12;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | forcing ungraft of asset-descriptor that is currently locked | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        v13 = [v7 summary];
        *buf = 138543618;
        v22 = v6;
        v23 = 2114;
        v24 = v13;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungrafting|unmounting (NOT currently locked) | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }

    [v7 setSecureOperationInProgress:1];
    v19 = 0;
    [MADAutoAssetSecure ungraft:v6 forDescriptor:v7 ungraftingError:&v19];
    v14 = v19;
    [v7 setSecureOperationInProgress:0];
    if (v14)
    {
      v15 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        v16 = [v14 checkedDescription];
        v17 = [v7 summary];
        *buf = 138543874;
        v22 = v6;
        v23 = 2114;
        v24 = v16;
        v25 = 2114;
        v26 = v17;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungraft|unmount ERROR | error:%{public}@ | downloadedDescriptor:%{public}@", buf, 0x20u);
      }
    }

    else
    {
      v15 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        v18 = [v7 summary];
        *buf = 138543618;
        v22 = v6;
        v23 = 2114;
        v24 = v18;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungraft|unmount SUCCESS | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }
  }

  os_activity_scope_leave(&state);
}

- (void)secureCheckUngraftAll:(id)a3 forSetDescriptorNoLongerLocked:(id)a4
{
  v6 = a3;
  v28 = a4;
  v7 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v8 = [v7 extendedStateQueue];
  dispatch_assert_queue_V2(v8);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:secureCheckUngraftAll", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v27 = [[NSString alloc] initWithFormat:@"%@:secureCheckUngraftAll", v6];
  [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v28];
  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  obj = v32 = 0u;
  v10 = [obj countByEnumeratingWithState:&v31 objects:v42 count:16];
  if (v10)
  {
    v11 = 0;
    v12 = *v32;
    v13 = 1;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v32 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v31 + 1) + 8 * i);
        v16 = objc_autoreleasePoolPush();
        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v6 forDescriptor:v15])
        {
          v11 |= [MADAutoAssetSecure isSecureAsset:v6 forDescriptor:v15];
        }

        v17 = [(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v6 forDescriptor:v15];
        objc_autoreleasePoolPop(v16);
        v13 &= v17 ^ 1;
      }

      v10 = [obj countByEnumeratingWithState:&v31 objects:v42 count:16];
    }

    while (v10);

    if (v11 & v13)
    {
      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        v19 = [v28 summary];
        *buf = 138543618;
        v37 = v27;
        v38 = 2114;
        v39 = v19;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungrafting ALL | containsSecureAssets:Y | allAssetsOfSetUnlocked:Y | setDescriptor:%{public}@", buf, 0x16u);
      }

      v30 = 0;
      [MADAutoAssetSecure ungraftAll:v27 forSetDescriptor:v28 withAutoAssetDescriptors:obj ungraftingError:&v30];
      v20 = v30;
      if (v20)
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          v22 = [v20 checkedDescription];
          v23 = [v28 summary];
          *buf = 138543874;
          v37 = v27;
          v38 = 2114;
          v39 = v22;
          v40 = 2114;
          v41 = v23;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungraft|unmount ERROR | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
        }
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          v26 = [v28 summary];
          *buf = 138543618;
          v37 = v27;
          v38 = 2114;
          v39 = v26;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungraft|unmount SUCCESS | setDescriptor:%{public}@", buf, 0x16u);
        }
      }

      goto LABEL_27;
    }
  }

  else
  {

    LOBYTE(v11) = 0;
    v13 = 1;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    v24 = @"N";
    if (v11)
    {
      v25 = @"Y";
    }

    else
    {
      v25 = @"N";
    }

    *buf = 138543874;
    v37 = v27;
    v38 = 2114;
    v39 = v25;
    if (v13)
    {
      v24 = @"Y";
    }

    v40 = 2114;
    v41 = v24;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "\n{%{public}@:secureCheckUngraftAll} [AUTO-SECURE] NOT ungrafting | containsSecureAssets:%{public}@ | allAssetsOfSetUnlocked:%{public}@", buf, 0x20u);
  }

LABEL_27:

  os_activity_scope_leave(&state);
}

- (void)secureClearInsecureLatestAtomicInstances
{
  v2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:secureClearInsecureLatestAtomicInstances", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"secureClearInsecureLatestAtomicInstances" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v101 = 0u;
  v102 = 0u;
  v99 = 0u;
  v100 = 0u;
  v5 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v6 = [v5 allKeys];
  obj = [v6 copy];

  v7 = [obj countByEnumeratingWithState:&v99 objects:v111 count:16];
  if (v7)
  {
    v70 = *v100;
    do
    {
      v8 = 0;
      v69 = v7;
      do
      {
        if (*v100 != v70)
        {
          objc_enumerationMutation(obj);
        }

        v72 = v8;
        v9 = *(*(&v99 + 1) + 8 * v8);
        v71 = objc_autoreleasePoolPush();
        v10 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v75 = [v10 safeObjectForKey:v9 ofClass:objc_opt_class()];

        if (v75)
        {
          v11 = [v75 latestAtomicInstanceToVend];
          v73 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"secureClearInsecureLatestAtomicInstances" forAtomicInstanceUUID:v11 requireExists:0];

          if (v73)
          {
            v97 = 0u;
            v98 = 0u;
            v95 = 0u;
            v96 = 0u;
            v12 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:?];
            v13 = [v12 countByEnumeratingWithState:&v95 objects:v106 count:16];
            if (v13)
            {
              v83 = 0;
              v84 = 0;
              v14 = *v96;
LABEL_10:
              v15 = 0;
              while (1)
              {
                if (*v96 != v14)
                {
                  objc_enumerationMutation(v12);
                }

                v16 = *(*(&v95 + 1) + 8 * v15);
                v17 = objc_autoreleasePoolPush();
                if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                {
                  v18 = [MAAutoAssetSelector alloc];
                  v19 = [v16 assetType];
                  v20 = [v16 assetSpecifier];
                  v21 = [v16 assetVersion];
                  v22 = [v18 initForAssetType:v19 withAssetSpecifier:v20 matchingAssetVersion:v21];

                  if ([MADAutoAssetSecure isGraftedOrMounted:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                  {
                    v23 = 1;
                  }

                  else
                  {
                    if ([MADAutoAssetSecure isPersonalizationRequired:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                    {
                      v24 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
                      {
                        v25 = [v22 summary];
                        *buf = 138543618;
                        v108 = @"secureClearInsecureLatestAtomicInstances";
                        v109 = 2114;
                        v110 = v25;
                        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalization required after startup secure-healing | downloadedSelector:%{public}@", buf, 0x16u);
                      }

                      v23 = 0;
                      v84 = 1;
                    }

                    else
                    {
                      v26 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
                      v27 = [v22 persistedEntryID];
                      v24 = [v26 safeObjectForKey:v27 ofClass:objc_opt_class()];

                      if (v24 && [v24 longValue]> 0)
                      {
                        v28 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
                        {
                          v29 = [v22 summary];
                          *buf = 138543618;
                          v108 = @"secureClearInsecureLatestAtomicInstances";
                          v109 = 2114;
                          v110 = v29;
                          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to re-graft during startup secure-healing | downloadedSelector:%{public}@", buf, 0x16u);
                        }

                        v23 = 0;
                        v83 = 1;
                      }

                      else
                      {
                        v30 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
                        {
                          v31 = [v22 summary];
                          *buf = 138543618;
                          v108 = @"secureClearInsecureLatestAtomicInstances";
                          v109 = 2114;
                          v110 = v31;
                          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | latest-to-vend includes personalized-not-grafted|mounted (acceptable since not currently locked) | downloadedSelector:%{public}@", buf, 0x16u);
                        }

                        v23 = 1;
                      }
                    }
                  }
                }

                else
                {
                  v23 = 1;
                }

                objc_autoreleasePoolPop(v17);
                if (!v23)
                {
                  break;
                }

                if (v13 == ++v15)
                {
                  v13 = [v12 countByEnumeratingWithState:&v95 objects:v106 count:16];
                  if (v13)
                  {
                    goto LABEL_10;
                  }

                  break;
                }
              }
            }

            else
            {
              v83 = 0;
              v84 = 0;
            }

            if ((v84 | v83))
            {
              v33 = [v75 latestAtomicInstanceToVend];
              v34 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v33];

              v35 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
              {
                v36 = [v75 summary];
                *buf = 138543618;
                v108 = @"secureClearInsecureLatestAtomicInstances";
                v109 = 2114;
                v110 = v36;
                _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} unable to self-heal, clearing latest-to-vend | setConfiguration:%{public}@", buf, 0x16u);
              }

              [(MADAutoAssetControlManager *)self setConfigurationForceUnlocked:@"secureClearInsecureLatestAtomicInstances" forSetConfiguration:v75];
              if (v34)
              {
                [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromSetConfiguration:v75 forSetDesriptor:v73 forSetAtomicInstance:v34 fromLocation:@"secureClearInsecureLatestAtomicInstances"];
                v37 = v73;
                v73 = 0;
              }

              else
              {
                v37 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                v38 = [v37 diag];
                v39 = [NSString alloc];
                v40 = [v75 summary];
                v41 = [v39 initWithFormat:@"{%@} no set-atomic-instance for set-configuration latest-to-vend | setConfiguration:%@", @"secureClearInsecureLatestAtomicInstances", v40];
                [v38 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v41 withResult:6111 withError:0];
              }

              v74 = 1;
            }

            else
            {
              v74 = 0;
            }
          }

          else
          {
            v74 = 0;
            v73 = 0;
          }

          v93 = 0u;
          v94 = 0u;
          v91 = 0u;
          v92 = 0u;
          v42 = [v75 previouslyVendedLockedAtomicInstances];
          v76 = [v42 copy];

          v78 = [v76 countByEnumeratingWithState:&v91 objects:v105 count:16];
          if (v78)
          {
            v77 = *v92;
            do
            {
              for (i = 0; i != v78; i = i + 1)
              {
                if (*v92 != v77)
                {
                  objc_enumerationMutation(v76);
                }

                v81 = *(*(&v91 + 1) + 8 * i);
                context = objc_autoreleasePoolPush();
                v43 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"secureClearInsecureLatestAtomicInstances" forAtomicInstanceUUID:v81 requireExists:0];
                v79 = v43;
                if (v43)
                {
                  v89 = 0u;
                  v90 = 0u;
                  v87 = 0u;
                  v88 = 0u;
                  v44 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v43];
                  v45 = [v44 countByEnumeratingWithState:&v87 objects:v104 count:16];
                  if (v45)
                  {
                    v82 = 0;
                    v46 = *v88;
LABEL_55:
                    v47 = 0;
                    while (1)
                    {
                      if (*v88 != v46)
                      {
                        objc_enumerationMutation(v44);
                      }

                      v48 = *(*(&v87 + 1) + 8 * v47);
                      v49 = objc_autoreleasePoolPush();
                      v50 = [MAAutoAssetSelector alloc];
                      v51 = [v48 assetType];
                      v52 = [v48 assetSpecifier];
                      v53 = [v48 assetVersion];
                      v54 = [v50 initForAssetType:v51 withAssetSpecifier:v52 matchingAssetVersion:v53];

                      if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48]&& ![MADAutoAssetSecure isGraftedOrMounted:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48])
                      {
                        if ([MADAutoAssetSecure isPersonalizationRequired:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48])
                        {
                          v56 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
                          {
                            v57 = [v54 summary];
                            *buf = 138543618;
                            v108 = @"secureClearInsecureLatestAtomicInstances";
                            v109 = 2114;
                            v110 = v57;
                            _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalization required after startup secure-healing (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                          }

                          HIDWORD(v82) = 1;
                        }

                        else
                        {
                          v58 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
                          v59 = [v54 persistedEntryID];
                          v56 = [v58 safeObjectForKey:v59 ofClass:objc_opt_class()];

                          if (v56 && [v56 longValue]> 0)
                          {
                            v60 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
                            {
                              v61 = [v54 summary];
                              *buf = 138543618;
                              v108 = @"secureClearInsecureLatestAtomicInstances";
                              v109 = 2114;
                              v110 = v61;
                              _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to re-graft during startup secure-healing (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                            }
                          }

                          else
                          {
                            v60 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
                            {
                              v62 = [v54 summary];
                              *buf = 138543618;
                              v108 = @"secureClearInsecureLatestAtomicInstances";
                              v109 = 2114;
                              v110 = v62;
                              _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalized-not-grafted|mounted (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                            }
                          }

                          LODWORD(v82) = 1;
                        }

                        v55 = 0;
                      }

                      else
                      {
                        v55 = 1;
                      }

                      objc_autoreleasePoolPop(v49);
                      if (!v55)
                      {
                        break;
                      }

                      if (v45 == ++v47)
                      {
                        v45 = [v44 countByEnumeratingWithState:&v87 objects:v104 count:16];
                        if (v45)
                        {
                          goto LABEL_55;
                        }

                        break;
                      }
                    }
                  }

                  else
                  {
                    v82 = 0;
                  }

                  if ((HIDWORD(v82) | v82))
                  {
                    v63 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v81];
                    v64 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR))
                    {
                      v65 = [v75 summary];
                      *buf = 138543618;
                      v108 = @"secureClearInsecureLatestAtomicInstances";
                      v109 = 2114;
                      v110 = v65;
                      _os_log_impl(&dword_0, v64, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} unable to self-heal, clearing previously vended locked | setConfiguration:%{public}@", buf, 0x16u);
                    }

                    if (![(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"secureClearInsecureLatestAtomicInstances" forSetConfiguration:v75 removingAtomicInstance:v81])
                    {
                      [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"secureClearInsecureLatestAtomicInstances" dueToError:0 forgettingAtomicInstance:v63];
                    }

                    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:@"secureClearInsecureLatestAtomicInstances" toNewStatus:@"FORGOTTEN" forAtomicInstance:v63];

                    v74 = 1;
                  }
                }

                objc_autoreleasePoolPop(context);
              }

              v78 = [v76 countByEnumeratingWithState:&v91 objects:v105 count:16];
            }

            while (v78);
          }

          if (v74)
          {
            v66 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR))
            {
              v67 = [v75 summary];
              *buf = 138543618;
              v108 = @"secureClearInsecureLatestAtomicInstances";
              v109 = 2114;
              v110 = v67;
              _os_log_impl(&dword_0, v66, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} altered set-configuration previouslyVendedLockedAtomicInstance | setConfiguration:%{public}@", buf, 0x16u);
            }

            [(MADAutoAssetControlManager *)self setConfigurationPersist:v75 fromLocation:@"secureClearInsecureLatestAtomicInstances" forReason:@"altered previouslyVendedLocked (not accessible on startup)" dueToAlter:0 forHistoryOperation:9999];
          }
        }

        else
        {
          v32 = _MADLog(@"AutoControl");
          v73 = v32;
          if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v108 = @"secureClearInsecureLatestAtomicInstances";
            v109 = 2114;
            v110 = v9;
            _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to load set-configuration | setConfigurationKey:%{public}@", buf, 0x16u);
          }
        }

        objc_autoreleasePoolPop(v71);
        v8 = v72 + 1;
      }

      while ((v72 + 1) != v69);
      v7 = [obj countByEnumeratingWithState:&v99 objects:v111 count:16];
    }

    while (v7);
  }

  os_activity_scope_leave(&state);
}

+ (id)buildDirectivesSummary
{
  v2 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  [v2 appendString:@"|BUILDING_DAEMON"];
  [v2 appendString:@"|TARGET_OS_MAC"];
  [v2 appendString:@"|TARGET_OS_IPHONE"];
  [v2 appendString:@"|MA_SUPPORTS_SPACE_ATTRIBUTION"];
  if ([SUCore stringIsEqual:v2 to:&stru_4BD3F0])
  {
    v3 = [[NSMutableString alloc] initWithString:@"(NO_TARGETS_DEFINED)"];

    v2 = v3;
  }

  else
  {
    [v2 appendString:@"|"];
  }

  return v2;
}

+ (id)getHealthReportForSets:(id)a3
{
  v3 = a3;
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = [v4 autoControlManagerFSM];

  if (v5)
  {
    v6 = [v4 autoControlManagerFSM];
    v7 = [v6 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __53__MADAutoAssetControlManager_getHealthReportForSets___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = v3;
    dispatch_sync(v7, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{getHealthReportForSets} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

uint64_t __53__MADAutoAssetControlManager_getHealthReportForSets___block_invoke(uint64_t a1)
{
  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) _getHealthReportForSets:*(a1 + 40)];

  return _objc_release_x1();
}

- (id)_getHealthReportForSets:(id)a3
{
  v4 = a3;
  v5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  dispatch_assert_queue_V2(v6);

  v31 = +[NSMutableArray array];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_getHealthReportForSets" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v36 = 0u;
  v37 = 0u;
  v34 = 0u;
  v35 = 0u;
  v7 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v8 = [v7 allKeys];
  v9 = [v8 copy];

  obj = v9;
  v10 = [v9 countByEnumeratingWithState:&v34 objects:v38 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v35;
    v30 = self;
    do
    {
      v13 = 0;
      v32 = v11;
      do
      {
        if (*v35 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v34 + 1) + 8 * v13);
        v15 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

        v17 = [v16 assetSetIdentifier];
        if (v16 && (!v4 || [v4 containsObject:v17]))
        {
          v18 = v4;
          v19 = [v16 latestAtomicInstanceToVend];
          if (v19)
          {
            v20 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"MAHealthReport" forAtomicInstanceUUID:v19 requireExists:1];
            if (v20)
            {
              v21 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"MAHealthReport" forSetDescriptor:v20];
              v22 = [v16 latestToVendCachedAssetSetID];
            }

            else
            {
              v22 = 0;
              v21 = 0;
            }
          }

          else
          {
            v22 = 0;
            v21 = 0;
          }

          v23 = objc_opt_new();
          [v23 setSetIdentifier:v17];
          v24 = [v16 mostRecentlyReceivedCachedAssetSetID];
          [v23 setLatestDiscoveredAssetSetUUID:v24];

          [v23 setLatestToVendAssetSetUUID:v22];
          v25 = [v16 mostRecentlyReceivedLastTimeChecked];
          [v23 setLastCheckedDate:v25];

          [v23 setLastestToVendIsLocked:v21];
          [v23 setLastestToVendMatchesSetConfig:{objc_msgSend(v16, "vendingAtomicInstanceForConfiguredEntries")}];
          v26 = [v16 availableForUseError];
          [v23 setAvailableForUseError:v26];

          v27 = [v16 newerVersionError];
          [v23 setNewerVersionError:v27];

          [v23 setLatestInstanceFromPreSUStaging:{objc_msgSend(v16, "latestAtomicInstanceToVendFromPreSUStaging")}];
          v28 = [v16 configurationChangedDate];
          [v23 setConfigurationChangedDate:v28];

          [v31 addObject:v23];
          v4 = v18;
          self = v30;
          v11 = v32;
        }

        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v34 objects:v38 count:16];
    }

    while (v11);
  }

  return v31;
}

@end